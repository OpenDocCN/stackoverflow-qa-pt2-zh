# StackOverflow 问答 16194000-16194999

# windows - 重新启动时无法启动服务

> ID：16194000
> 
> 赞同：3
> 
> 时间：2013-04-24T14:00:18.620
> 
> 标签：windows, wcf, service, reboot

我编写了一个作为 Windows 服务运行的小型服务。在大多数计算机上这工作得很好，但是有一些计算机，当计算机重新启动时，服务有时不会启动。

开机后启动服务是没有问题的。只是开机时自动启动不起作用。

我已经尝试将服务延迟启动，但这并没有改变任何东西。该服务有时仍无法在重新启动时启动。

该服务在本地服务帐户上运行，并且只打开一些 WFC 服务并等待连接。

# jquery - 在带有 PhoneGap 的 Windows Phone 上使用 jQuery .find()

> ID：16194003
> 
> 赞同：2
> 
> 时间：2013-04-24T14:00:27.510
> 
> 标签：jquery, windows-phone-7, cordova, windows-phone-8

我在 Windows Phone 上遇到了 Cordova 2.6.0 和 jQuery 1.8.1 的问题！

当我制作一个`$(xmlHttpRequest.responseXML).find("Item")`（适用于 iOS / Android 和浏览器）时，它会在 Windows 手机上返回一个空元素...我需要制作一个`xmlHttpRequest.responseXML.documentElement`并在子项中导航以找到我的元素...

所以问题似乎是 jQuery 但为什么呢？有任何想法吗 ？

谢谢 ！

编辑：我得到的 SOAP 信封是这样的（在 WP8 上用 Fiddler 看到）

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">
  <s:Body>
    <MethodName xmlns="http://url.com/services/contract">
      <MethodNameResult xmlns:a="http://schemas.datacontract.org/2004/07/xxx.yyy.aaa.bb.cc.Result" xmlns:i="http://www.w3.org/2001/XMLSchema-instance">
        <a:Item xmlns:b="http://schemas.datacontract.org/2004/07/xxx.yyy.aaa.bb.cc"> 
          <b:Active>Active</b:Active>
          <b:Comment i:nil="true"/>
          <b:Company>My company</b:Company>
          <b:DisplayName>The best company ever</b:DisplayName>
          <b:Email>contact@url.com</b:Email>
          <b:Fax i:nil="true"/>
          <b:FirstName>Alx</b:FirstName>
          <b:GenderTypeId>Male</b:GenderTypeId>
          ... 
```

编辑：`.find("a:Item")`不起作用！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T09:37:35.597

另一种解决方案是制作这样的新功能：

```
 $.fn.filterNode = function(name) {
    return this.find('*').filter(function() {
       return this.nodeName === name;
    });
 }; 
```

并将名称设置为 "a:Item" ！

我不知道为什么，但这个解决方案适用于 WindowsPhone Web App ！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:08:26.147

您不应该那样解析 XML，而应使用 jQuery 和 DataType xml 的 ajax 方法。我不知道这是否会导致问题，但它可能是。

检查这篇文章： [可以使用 jQuery 的 $(responseXML) 语法可靠地解析 XML 吗？](https://stackoverflow.com/questions/2124924/can-xml-be-parsed-reliably-using-jquerys-responsexml-syntax)

# java - 如何在不调度更改事件的情况下更新 JSlider 的最大值

> ID：16194007
> 
> 赞同：1
> 
> 时间：2013-04-24T14:00:45.163
> 
> 标签：java, swing, jslider

我有一小段代码可以更新 a `JSlider`; 在另一个时间点，`JSlider`的最大值需要更新。问题是当我调用`setMaximum()`滑块时，它也会发送一个`ChangeEvent`. 为避免这种情况，我正在这样做：

```
slider.removeChangeListener(this);
slider.setMaximum(newMax);
slider.addChangeListener(this); 
```

有没有更清洁/更优雅的方式来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:23:56.333

一个干净的方法可能是（取决于你实际需要什么）来实现一个自定义的 BoundedRangeModel ，它触发一个可以携带实际更改的属性的自定义 ChangeEvent ：

```
/**
 * Extended model that passes the list of actually changed properties
 * in an extended changeEvent.
 */
public static class MyBoundedRangeModel extends DefaultBoundedRangeModel {

    public MyBoundedRangeModel() {
    }

    public MyBoundedRangeModel(int value, int extent, int min, int max) {
        super(value, extent, min, max);
    }

    @Override
    public void setRangeProperties(int newValue, int newExtent, int newMin,
            int newMax, boolean adjusting) {
        int oldMax = getMaximum();
        int oldMin = getMinimum();
        int oldValue = getValue();
        int oldExtent = getExtent();
        boolean oldAdjusting = getValueIsAdjusting();
        // todo: enforce constraints of new values for all
        List<String> changedProperties = new ArrayList<>();
        if (oldMax != newMax) {
           changedProperties.add("maximum"); 
        }
        if (oldValue != newValue) {
            changedProperties.add("value");
        }
        // todo: check and add other properties 
        changeEvent = changedProperties.size() > 0 ? 
                new MyChangeEvent(this, changedProperties) : null;
        super.setRangeProperties(newValue, newExtent, newMin, newMax, adjusting);
    }

}

/**
 * Extended ChangeEvent that provides a list of actually 
 * changed properties. 
 */
public static class MyChangeEvent extends ChangeEvent {

    private List<String> changedProperties;

    /**
     * @param source
     */
    public MyChangeEvent(Object source, List<String> changedProperties) {
        super(source);
        this.changedProperties = changedProperties;
    }

    public List<String> getChangedProperties() {
        return changedProperties;
    }

} 
```

它的用法类似于：

```
final JSlider slider = new JSlider();
slider.setModel(new MyBoundedRangeModel(0, 0, -100, 100));
ChangeListener l = new ChangeListener() {

    @Override
    public void stateChanged(ChangeEvent e) {
        if (e instanceof MyChangeEvent) {
            MyChangeEvent me = (MyChangeEvent) e;
            if (me.getChangedProperties().contains("value")) {
               System.out.println("new value: " + 
                    ((BoundedRangeModel) e.getSource()).getValue()); 
            }
            if (me.getChangedProperties().contains("maximum")) {
                System.out.println("new max: " + 
                    ((BoundedRangeModel) e.getSource()).getMaximum()); 
            }
        } else {
            // do something else or nothing
        }
    }
};
slider.getModel().addChangeListener(l); 
```

请注意，您必须将侦听器注册到模型，而不是滑块（原因是滑块创建了普通类型的新 changeEvent）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:06:32.213

您可以检查谁触发了侦听器的更改。它仍然很脏，但是您不必删除更改侦听器。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:07:16.683

从本质上讲，它看起来与[这个问题相同。](https://stackoverflow.com/questions/4716072/is-there-something-wrong-with-swings-mvc-implementation-for-jlist) 在这种情况下，我担心答案是否定的

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-10-27T11:45:47.197

如果您只需要滑块在值发生变化时触发事件，您可以通过以下方式简化 kleopatra 的答案：

```
// make sure slider only fires changEvents when value changes
slider.setModel(new DefaultBoundedRangeModel() {
        final ChangeEvent theOne=new ChangeEvent(this);         
        @Override
        public void setRangeProperties(int newValue, int newExtent, int newMin,int newMax, boolean adjusting) 
            changeEvent= (getValue() != newValue ? theOne:null);
            super.setRangeProperties(newValue, newExtent, newMin, newMax, adjusting);
        }
        @Override
        protected void fireStateChanged()
        {
            if(changeEvent==null) return;
            super.fireStateChanged();
        }
    }); 
```

然后，您需要做的就是在模型上注册一个“标准”ChangeListener，它只会在值发生变化时被调用，而不是在最大值或最小值发生变化时被调用。

```
slider.getModel().addChangeListener(new ChangeListener() {
    public void stateChanged(ChangeEvent e) { 
        // do something here when value changes 
    }); 
```

});

# javascript - 在事件冒泡中找到点击的来源

> ID：16194008
> 
> 赞同：1
> 
> 时间：2013-04-24T14:00:46.220
> 
> 标签：javascript, event-bubbling

我有以下代码：

```
<div id="buttons">
    <button id="btn1">1</button>
    <button id="btn2">2</button>
</div> 
```

我将一个事件处理程序附加`<div>`到处理点击。

当我单击一个按钮时，该事件被 div 捕获。有没有办法获取事件的来源？

例如，如果事件在每个按钮上，则`this`关键字将引用按钮。当它出现时，`<div>`它指的是那个。

当点击被div捕获时，有没有办法定位到点击的来源？即点击了哪个实际按钮？

谢谢大家

戴夫

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T14:04:34.820

您可以使用对象的`originalTarget`属性`event`来找出事件的来源。

[JSFiddle](http://jsfiddle.net/wwZwL/1/)

HTML

```
<div id="buttons">
    <button id="btn1">1</button>
    <button id="btn2">2</button>
</div> 
```

JavaScript

```
document.getElementById('buttons').onclick = function (evt) {
    var source = evt.srcElement || evt.originalTarget
    alert(source.id);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:11:18.327

如果您使用 jQuery，这应该会有所帮助：

```
$("#buttons").click(function(evt){
       alert($(evt.target).attr("id"));
}); 
```

# spring - Spring MVC - 发生 http 404 时的 RestTemplate 启动异常

> ID：16194014
> 
> 赞同：42
> 
> 时间：2013-04-24T14:01:10.290
> 
> 标签：spring, rest, resttemplate

我有一个休息服务，当找不到资源时会发送 404 错误。这里是我的控制器的来源和发送 Http 404 的异常。

```
@Controller
@RequestMapping("/site")
public class SiteController
{

    @Autowired
    private IStoreManager storeManager;

    @RequestMapping(value = "/stores/{pkStore}", method = RequestMethod.GET, produces = "application/json")
    @ResponseBody
    public StoreDto getStoreByPk(@PathVariable long pkStore) {       
        Store s = storeManager.getStore(pkStore);
        if (null == s) {
            throw new ResourceNotFoundException("no store with pkStore : " + pkStore);
        }
        return StoreDto.entityToDto(s);       

    }
}

@ResponseStatus(value = HttpStatus.NOT_FOUND)
public class ResourceNotFoundException extends RuntimeException
{       
    private static final long serialVersionUID = -6252766749487342137L;    
    public ResourceNotFoundException(String message) {
        super(message);
    }    
} 
```

当我尝试使用以下代码使用 RestTemplate 调用它时：

```
ResponseEntity<StoreDto> r = restTemplate.getForEntity(url, StoreDto.class, m);
 System.out.println(r.getStatusCode());
 System.out.println(r.getBody()); 
```

我收到此异常：

```
org.springframework.web.client.RestTemplate handleResponseError
ATTENTION: GET request for "http://........./stores/99" resulted in 404 (Introuvable); invoking error handler
org.springframework.web.client.HttpClientErrorException: 404 Introuvable 
```

我在想我可以探索我的 responseEntity 对象并使用 statusCode 做一些事情。但例外是启动，我的应用程序出现故障。

restTemplate 是否有特定配置不发送异常但填充我的 ResponseEntity。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2014-04-13T04:26:50.280

据我所知，您无法获得实际的 ResponseEntity，但可以从异常中获得状态代码和正文（如果有）：

```
try {
    ResponseEntity<StoreDto> r = restTemplate.getForEntity(url, StoreDto.class, m);
}
catch (final HttpClientErrorException e) {
    System.out.println(e.getStatusCode());
    System.out.println(e.getResponseBodyAsString());
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-11-06T18:52:04.323

RESTTemplate 在这方面 IMO 是相当不足的。这里有一篇很好的博客文章，介绍了在收到错误时如何提取响应正文：

[http://springinpractice.com/2013/10/07/handling-json-error-object-responses-with-springs-resttemplate](http://springinpractice.com/2013/10/07/handling-json-error-object-responses-with-springs-resttemplate)

截至今天，有一个未完成的 JIRA 请求，该模板提供了提取响应正文的可能性：

[https://jira.spring.io/browse/SPR-10961](https://jira.spring.io/browse/SPR-10961)

Squatting Bear 的答案的问题在于，如果您只想处理 404，则必须询问 catch 块内的状态代码

这是我在上一个项目中解决这个问题的方法。可能有更好的方法，我的解决方案根本没有提取 ResponseBody。

```
public class ClientErrorHandler implements ResponseErrorHandler
{
   @Override
   public void handleError(ClientHttpResponse response) throws IOException 
   {
       if (response.getStatusCode() == HttpStatus.NOT_FOUND)
       {
           throw new ResourceNotFoundException();
       }

       // handle other possibilities, then use the catch all... 

       throw new UnexpectedHttpException(response.getStatusCode());
   }

   @Override
   public boolean hasError(ClientHttpResponse response) throws IOException 
   {
       return response.getStatusCode().series() == HttpStatus.Series.CLIENT_ERROR
         || response.getStatusCode().series() == HttpStatus.Series.SERVER_ERROR;
   } 
```

ResourceNotFoundException 和 UnexpectedHttpException 是我自己的未经检查的异常。

创建其余模板时：

```
 RestTemplate template = new RestTemplate();
    template.setErrorHandler(new ClientErrorHandler()); 
```

现在我们在发出请求时得到了稍微整洁的结构：

```
 try
    {
        HttpEntity response = template.exchange("http://localhost:8080/mywebapp/customer/100029",
                                        HttpMethod.GET, requestEntity, String.class);
        System.out.println(response.getBody());
    }
    catch (ResourceNotFoundException e)
    {
        System.out.println("Customer not found");
    } 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2018-05-06T18:31:46.830

由于现在是 2018 年，我希望当人们说“Spring”时，他们实际上至少是指“Spring Boot”，我想用一种不那么尘土飞扬的方法来扩展给定的答案。

前面的答案中提到的所有内容都是正确的 - 您需要使用自定义`ResponseErrorHandler`. 现在，在 Spring Boot 世界中，配置它的方式比以前简单了一些。有一个方便的类叫做`RestTemplateBuilder`. 如果您阅读其 java 文档的第一行，它会说：

> 可用于配置和创建 RestTemplate 的生成器。提供方便的方法来注册转换器、**错误处理程序** 和 UriTemplateHandlers。

它实际上有一个方法：

```
new RestTemplateBuilder().errorHandler(new DefaultResponseErrorHandler()).build(); 
```

`RestTemplate`最重要的是，Spring 的人很久以前就意识到了传统的缺点，以及它在测试中是如何特别痛苦的。他们创建了一个方便的类，`TestRestTemplate`作为包装器`RestTemplate`，并将其 errorHandler 设置为空实现：

```
private static class NoOpResponseErrorHandler extends 
       DefaultResponseErrorHandler {

    @Override
    public void handleError(ClientHttpResponse response) throws IOException {
    }

} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-11-28T13:04:01.520

您可以创建自己的 RestTemplate 包装器，它不会抛出异常，而是返回带有接收到的状态代码的响应。（您也可以返回正文，但这将不再是类型安全的，因此在正文下面的代码中仍然是简单的`null`。）

```
/**
 * A Rest Template that doesn't throw exceptions if a method returns something other than 2xx
 */
public class GracefulRestTemplate extends RestTemplate {
    private final RestTemplate restTemplate;

    public GracefulRestTemplate(RestTemplate restTemplate) {
        super(restTemplate.getMessageConverters());
        this.restTemplate = restTemplate;
    }

    @Override
    public <T> ResponseEntity<T> getForEntity(URI url, Class<T> responseType) throws RestClientException {
        return withExceptionHandling(() -> restTemplate.getForEntity(url, responseType));
    }

    @Override
    public <T> ResponseEntity<T> postForEntity(URI url, Object request, Class<T> responseType) throws RestClientException {
        return withExceptionHandling(() -> restTemplate.postForEntity(url, request, responseType));
    }

    private <T> ResponseEntity<T> withExceptionHandling(Supplier<ResponseEntity<T>> action) {
        try {
            return action.get();
        } catch (HttpClientErrorException ex) {
            return new ResponseEntity<>(ex.getStatusCode());
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-26T12:22:23.470

最近有一个用例。我的解决方案：

```
public class MyErrorHandler implements ResponseErrorHandler {

@Override
public boolean hasError(ClientHttpResponse clientHttpResponse) throws IOException {
    return hasError(clientHttpResponse.getStatusCode());
}

@Override
public void handleError(ClientHttpResponse clientHttpResponse) throws IOException {
    HttpStatus statusCode = clientHttpResponse.getStatusCode();
    MediaType contentType = clientHttpResponse
        .getHeaders()
        .getContentType();
    Charset charset = contentType != null ? contentType.getCharset() : null;
    byte[] body = FileCopyUtils.copyToByteArray(clientHttpResponse.getBody());

    switch (statusCode.series()) {
        case CLIENT_ERROR:
            throw new HttpClientErrorException(statusCode, clientHttpResponse.getStatusText(), body, charset);
        case SERVER_ERROR:
            throw new HttpServerErrorException(statusCode, clientHttpResponse.getStatusText(), body, charset);
        default:
            throw new RestClientException("Unknown status code [" + statusCode + "]");
    }

}

private boolean hasError(HttpStatus statusCode) {
    return (statusCode.series() == HttpStatus.Series.CLIENT_ERROR ||
        statusCode.series() == HttpStatus.Series.SERVER_ERROR);
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-02-03T09:35:26.950

Spring框架中没有实现ResponseErrorHandler这样的类，所以我只是声明了一个bean：

```
@Bean
    public RestTemplate getRestTemplate() {
        return new RestTemplateBuilder()
                .errorHandler(new DefaultResponseErrorHandler() {
                    @Override
                    public void handleError(ClientHttpResponse response) throws IOException {
                        //do nothing
                    }
                })
                .build();
    } 
```

# node.js - 停止下载nodejs请求中的数据

> ID：16194017
> 
> 赞同：6
> 
> 时间：2013-04-24T14:01:21.503
> 
> 标签：node.js, httprequest, httpresponse

我们如何停止来自服务器的剩余响应 - 例如。

```
http.get(requestOptions, function(response){

//Log the file size;
console.log('File Size:', response.headers['content-length']);

// Some code to download the remaining part of the response?

}).on('error', onError); 
```

我只想记录文件大小，而不是浪费我的带宽下载剩余的文件。nodejs 会自动处理这个问题还是我必须为它编写一些特殊的代码？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-24T14:33:40.093

如果您只想获取文件的大小，最好使用[HTTP HEAD](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)，它只返回来自服务器的响应标头而不返回正文。

您可以像这样在 Node.js 中发出 HEAD 请求：

```
var http = require("http"),
    // make the request over HTTP HEAD
    // which will only return the headers
    requestOpts = {
    host: "www.google.com",
    port: 80,
    path: "/images/srpr/logo4w.png",
    method: "HEAD"
};

var request = http.request(requestOpts, function (response) {
    console.log("Response headers:", response.headers);
    console.log("File size:", response.headers["content-length"]);
});

request.on("error", function (err) {
    console.log(err);
});

// send the request
request.end(); 
```

编辑：

我意识到我并没有*真正*回答您的问题，本质上是“如何在 Node.js 中尽早终止请求？”。您可以通过调用 response.destroy() 来终止处理过程中的任何请求：

```
var request = http.get("http://www.google.com/images/srpr/logo4w.png", function (response) {
    console.log("Response headers:", response.headers);

    // terminate request early by calling destroy()
    // this should only fire the data event only once before terminating
    response.destroy();

    response.on("data", function (chunk) {
        console.log("received data chunk:", chunk); 
    });
}); 
```

您可以通过注释掉 destroy() 调用并观察在完整请求中返回两个块来测试这一点。然而，就像其他地方提到的那样，简单地使用 HTTP HEAD 更有效。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T14:33:27.270

您需要执行**HEAD**请求而不是 get

取自[这个答案](https://stackoverflow.com/a/6001507/1095114)

```
var http = require('http');
var options = {
    method: 'HEAD', 
    host: 'stackoverflow.com', 
    port: 80, 
    path: '/'
};
var req = http.request(options, function(res) {
    console.log(JSON.stringify(res.headers));
    var fileSize = res.headers['content-length']
    console.log(fileSize)
  }
);
req.end(); 
```

# android - OpenGL ES 2.0 - 可以在典型的 Android 设备上一次创建和链接 100 个着色器程序吗？

> ID：16194018
> 
> 赞同：0
> 
> 时间：2013-04-24T14:01:22.707
> 
> 标签：android, opengl-es, shader

我想尝试通过`glCreateProgram`and一次创建和链接多达 100 个着色器程序（可能是 40 个）（如果需要，可以`glLinkProgram`在它们之间切换）。`onDrawFrame`

每个都有简单的制服，比如一个或 2 个 vec4，或者一个浮点数等。简单的问题：在典型的 Android 设备上，我可以一次创建和链接的此类着色器程序的数量的大致限制是多少？40-100可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:40:17.680

GLES2 文档没有提到您可以在内存中保留多少程序的任何具体限制。我猜你可以编译和链接上万个程序。唯一的限制应该是可用的内存量。这一切都取决于程序，ascii 源代码和编译后的二进制文件都将由 GLES 上下文存储。

对于其他限制，请查看 glGet* 函数可以返回什么。

[glGet[Booleanv|Floatv|Integerv]，gles2 文档](http://www.khronos.org/opengles/sdk/docs/man/xhtml/glGet.xml)

# android - 如何将 logcat 文本导入 Android Eclipse

> ID：16194019
> 
> 赞同：2
> 
> 时间：2013-04-24T14:01:24.120
> 
> 标签：android, android-anr-dialog, blackberry-android

如何在我以编程方式获得的 logcat 工具 Android/Eclipse 中打开 logcat 文本。要将其作为普通文本文件读取，很难阅读。我试图找出 ANR 问题的性质，如果我在 logcat 工具中看到它Android Eclipse的，很容易识别。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T15:21:25.073

你搜到了吗？[http://code.google.com/p/androidlogcatviewer/wiki/KeyFeature](http://code.google.com/p/androidlogcatviewer/wiki/KeyFeature)

它描述了一个用于显示 logcat 文件的桌面软件...

# c++ - C++ 中的矩阵向 量乘法

> ID：16194023
> 
> 赞同：-2
> 
> 时间：2013-04-24T14:01:26.577
> 
> 标签：c++, vector, matrix

我有一个将矩阵和向量相乘的代码。但是，它不会**进入** `for`朋友函数的循环内部`calc()`。你能发现错误吗？

```
#include<iostream>
using namespace std;

class vector;
class matrix
{
public:
    int r,c,ma[10][10];
    void get(int r, int c=3)
    {
        int i,j;
        cout<<"Enter the matrix elements\n";
        for(i=0; i<r; i++)
            for(j=0; j<c; j++)
            {
                cin>>ma[i][j];
            }
        cout<<"Your input: ";
        for(i=0; i<r; i++)
        {
            cout<<"\n";
            for(j=0; j<c; j++)
            {
                cout<<ma[i][j]<<"\t";
            }
        }
    }
    friend void calc(matrix m,vector v);
};

class vector
{
public:
    int val,va[10];
    void get(int v=3)
    {
        int i;
        cout<<"\nEnter the vector values\n";
        for(i=0; i<v; i++)
        {
            cin>>va[i];
        }
        cout<<"\nYour input:\n";
        for(i=0; i<v; i++)
        {
            cout<<va[i]<<"\t";
        }
    }
    friend void calc(matrix m,vector v);
};

void calc(matrix m,vector v)
{
    int c[10],i,j;
    if(m.c == v.val)
    {
        for(i=0; i<v.val; i++)
        {
            cout<<"Entered 1st loop";
            c[i] = 0;
            for(j=0; j<m.r; j++)
            {
                c[i] = c[i]+(m.ma[i][j] * v.va[j]);
            }
        }
    }
    cout<<"\nThe result is :\n";
    for(i=0; i<m.r; i++)
    {
        cout<<"Entered for";
        cout<<"\n"<<c[i];
    }
}

int main()
{
    int r;
    matrix m1;
    vector v1;
    cout<<"Enter the number of rows = ";
    cin>>r;
    m1.get(r);
    v1.get();
    calc(m1,v1);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:06:55.417

你永远不会`val`在`vector`课堂上初始化，你`r`也不会`c`在课堂上初始化`matrix`。因此，检查`if(m.c == v.val)`永远不会通过，因为这些成员的值是**未定义**的（包含随机垃圾）。

我建议你看看**[The Definitive C++ Book Guide and List](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)**；一本好书将帮助您掌握基础知识。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-07-21T20:18:25.883

```
#include<iostream>
#include<math.h>
#include<windows.h>
using namespace std;
class vecter;
class matrix
{
    int matrex[3][3];
public:

    friend void multiply(matrix &,vecter &);
    void setmatrix()
    {
       cout<<"Enter the elements into the matrix array "<<endl;
        for(int i=0;i<3;i++)
            {
                for(int j=0;j<3;j++)
                {
                    cout<<"Enter the element in to the "<<i+1<<" row and "<<j+1<<" coloumn "<<endl;
                    cin>>matrex[i][j];
                }
            }
    }
    void dismatrix()
    {
       cout<<" The elements into the matrix array are "<<endl;
        for(int i=0;i<3;i++)
            {
                cout<<"|";
                for(int j=0;j<3;j++)
                {
                    cout<<":"<<matrex[i][j]<<" : ";
                }
                cout<<"|";
                cout<<endl;
            }
    }
};
class vecter
{
    int vector[3];
public:

    friend void multiply(matrix &,vecter &);
    void setvector()
    {
        for(int i=0;i<3;i++)
        {   cout<<"Enter the "<<i+1<<" element in to the vector Array "<<endl;
            cin>>vector[i];
        }
    }

    void disvector()
    {
        cout<<"The elements in the index of the vector array are "<<endl;
        for (int i=0;i<3;i++)
        {
            cout<<"|"<<vector[i]<<"|"<<endl;
        }

    }
};
void multiply (matrix &m,vecter &v)
{
    int solution[3];
    //initilization.
    for(int i=0;i<3;i++)
    {
        solution[i]=0;
    }
    //multiplication.
    for(int i=0;i<3;i++)
    {
        for(int j=0;j<3;j++)
        {

             solution[i]+=( m.matrex[i][j]*v.vector[j]);
        }

    }
    cout<<"\t\t\t\t\t processing..... ";
        for(int i=0;i<20;i++)
        {
            cout<<char(219);
            Sleep(200);    
        }
        cout<<endl;
        for(int i=0;i<3;i++)
        {
            cout<<"|"<<solution[i]<<"|"<<endl;
        }

}
int main()
{
    matrix m;
    vecter v;
    v.setvector();
    m.setmatrix();
    m.dismatrix();
    cout<<endl;
    v.disvector();
    multiply(m,v);
    system ("pause>0");

} 
```

# javascript - .html('') 在 Safari 中不起作用

> ID：16194026
> 
> 赞同：0
> 
> 时间：2013-04-24T14:01:42.403
> 
> 标签：javascript, jquery, safari

我正在尝试`.html('')`在我的组件中使用 jquery 删除一个对象。它几乎可以在浏览器中使用，但在 Safari 中不起作用。为什么会这样？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:05:08.670

如果你想从 DOM 中取出一个元素，使用[`remove()`](http://api.jquery.com/remove/)，不要使用`.html("")`.

如果要使元素为空，请使用[`empty()`](http://api.jquery.com/empty/).

另外，要回答您的问题，您的代码中可能存在一些错误，因为`.html('')`它可以在我的 Safari 上运行，并在此[jsfiddle](http://jsfiddle.net/zYfUm/)上进行了测试。

# html - HTML5 Canvas 俄罗斯方块绕轴旋转

> ID：16194029
> 
> 赞同：1
> 
> 时间：2013-04-24T14:01:51.177
> 
> 标签：html, canvas, axis

我有我正在做的这个项目。如果您尝试按住 UP 键，您会明白我的意思：

[http://harlem-shake-it.com/tetris/](http://harlem-shake-it.com/tetris/)

我需要让它绕着它的轴转动，而不是它在那里做的事情。

看看这里的代码：http: [//harlem-shake-it.com/tetris/js/tetris.js](http://harlem-shake-it.com/tetris/js/tetris.js)

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-13T21:33:55.713

我不确定，但我认为您正在使用 4 x 4 矩阵来绘制形状..

改用 5 乘 5。[0,0] 到 [4,4] 并以 [2,2] 为中心旋转物体..

这将解决问题。保持 [2,2] 作为所有形状的中心块，[2,2] 将始终着色。要掌握这一点，请尝试/使用笔纸理解它或去这里：-

来源/链接 - [http://javilop.com/gamedev/tetris-tutorial-in-c-platform-independent-focused-in-game-logic-for-beginners/](http://javilop.com/gamedev/tetris-tutorial-in-c-platform-independent-focused-in-game-logic-for-beginners/)

或者您可以像我一样使用 3x3 网格.. [https://github.com/ashtt/TetrisOnCanvas](https://github.com/ashtt/TetrisOnCanvas)

# json - 发送 JSON 并使用动态数据参数

> ID：16194034
> 
> 赞同：0
> 
> 时间：2013-04-24T14:02:07.340
> 
> 标签：json, jquery

我在尝试将 JSON 发送到我的服务器时遇到了一些错误，我只是想确保这部分是正确的。

我担心的部分是数据参数。数据参数是动态的，我只想确保我下面的方法是形成它的有效方法。

我这样形成它：**dataObj[itemName] = itemValue;**

这是我的实现方式：

```
var itemName = "";
var itemValue = "";
var dataObj = {};

if (divId == "CustomerDiv") {
   itemName = "CustomerId";
   itemValue = id;
} else {
   itemName = "OwnerId";
   itemValue = id;
}
var ajaxMethod = "http://localhost:50151/api/webmethod/";
dataObj[itemName] = itemValue;
$.ajax({
   type: "PATCH",
   url: ajaxMethod,
   dataType: "json",
   data: dataObj
}); 
```

这会是形成数据参数的有效方式吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:19:48.643

您确实正在使用正确的合成器来生成数据对象。您的 dataObj 的结果将是`{CustomerId: XX}`（例如）。

请注意，这`type: "PATCH"`是不正确的，因为`type`它需要正确的 HTTP 方法（如 GET、POST ...）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:10:33.143

我认为您构建动态参数的方式没有任何问题。您是否尝试过调试以确保在调用 ajax 之前对象看起来正确？它应该是一个简单的对象，形式为`{'CustomerId': val}`or `{ 'OwnerId': val }`。

我注意到[一个可能相关的帖子](https://stackoverflow.com/questions/11461414/ajax-json-doesnt-get-sent-in-patch-only)。它说“PATCH”并非在所有版本的`jQuery`. 它还说并非所有浏览器都支持补丁。

你用的是什么版本的`jQuery`？你的浏览器和版本是什么？你收到什么错误？

# javascript - 如何将值从 MVC 发送到 Javascript

> ID：16194035
> 
> 赞同：1
> 
> 时间：2013-04-24T14:02:19.057
> 
> 标签：javascript, model-view-controller

我有一个包含几张图片的目录，我想按下其中一张图片，并且在不离开我所在的页面的情况下更改我的一个 DIv 中的完整图像。

在网上搜索后，我发现了这个：

```
<a href="imagem(@picture.FullSizeImageUrl" ... >
<img src="@picture.ImageUrl" ... />
</a> 
```

应该与这个 javascript 函数连接：

```
function imagem(txt) {
    document.getElementById("imagemgrande").innerHTML = "<img src='" + txt + "' alt=''/>" 
```

用 ID 将我想要的图像发送到我的 div `imagemgrande`。

当我运行代码并将图像悬停时，浏览器底部显示的链接为我提供了我想要显示的图像的正确路径（这意味着 java 函数应该接收正确的路径）但是当我单击时，它不做任何事情。我认为图像标签可能被错误地创建，并`alert(txt)`在`document.getElementByID`. 它甚至没有注册。

我忘记了什么，我没有声明 javascript 变量`txt`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:15:08.243

为什么要调用 js 函数`href`？你应该这样做`onclick`

```
 <a href="#" onclick="return imagem(@picture.FullSizeImageUrl)" ... > 
```

不要忘记`return false;`

```
function imagem(txt) {
    document.getElementById("imagemgrande").innerHTML = "<img src='" + txt + "' alt=''/>" 
return false;
} 
```

**编辑**

您必须发送一个字符串作为参数才能`showImage`运行。我已经检查过了，它奏效了。

```
<a href="#" onclick="return showImage('/big_image.jpg')">
    <img src="/some_image.jpg"/>
</a>

<div id="imagemgrande"></div>

<script type="text/javascript">
function showImage(imgUrl) {
    try {
        document.getElementById("imagemgrande").innerHTML = "<img src='" + imgUrl + "' alt=''/>" 
    } catch(error) {
        alert(error);
    }
    return false;
}

window.onerror = function(errorMessage, url, line) {
    var errorText = 'message: ' + errorMessage + '\nurl: ' + url + '\nline: ' + line;
    alert(errorText);
}
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:07:40.637

使用 firefox 并查看错误控制台 -> 菜单工具 / 错误控制台

1.  你检查图像路径是否正确 - 相对于页面？

2.  测试它 - 通过浏览器中的路径以及页面文件夹是否显示？

3.  仔细检查 - imagemgrande 是图像还是 div？如果它的图像：更改 src

    ```
    function imagem(txt) {

        alert(document.getElementById("imagemgrande"))//what does this say

        document.getElementById("imagemgrande").src = txt + "?d=" + new Date();//force webserver request, optional 
    ```

你也可以像这样使用href

```
 <a href="javascript:imagem('img/i1.jpg', 'imagemgrande')" > image 1 </a> 
```

查看[图像更改](http://sel2in.com/pages/prog/html/js/imageChange.html)

# ios - 初始化超级初始化和其他

> ID：16194039
> 
> 赞同：0
> 
> 时间：2013-04-24T14:02:37.533
> 
> 标签：ios, objective-c, xcode

我收到以下错误：

```
on the line self = [super init]; 
```

无法在方法初始化系列之外分配自我

在所有 self.whatever = 上也有黄色三角形；

“whatever”的本地声明隐藏了实例变量

```
@synthesize firstName, lastName, emailAdress, password, admin;

//current course funkade med nil men inte @"" vrf ;P
-(id) init
{
    return [self initwithName:@"" lastName:@"" password:@"" admin:@"" currentCourse:nil];
}

-(id) initwithName:(NSString *) firstName
          lastName:(NSString *) lastName
          password:(NSString *) password
             admin:(NSString *) admin
     currentCourse:(NSDictionary *) course
{
    self = [super init];
    if (self) {
        self.firstName = firstName;
        self.lastName = lastName;
        self.password = password;
        self.admin = admin;

    }
    return self;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:08:31.413

你已经合成了`@synthesize firstName, lastName, emailAdress, password, admin;`

在您的方法中，您使用的是相同的名称

```
-(id) initwithName:(NSString *) firstName
          lastName:(NSString *) lastName
          password:(NSString *) password
             admin:(NSString *) admin
     currentCourse:(NSDictionary *) course 
```

如果您的编译器支持自动合成，请将这些更改为其他内容或删除合成

```
-(id) initWithName:(NSString *) aFirstName
          lastName:(NSString *) aLastName
          password:(NSString *) aPassword
             admin:(NSString *) aAdmin
     currentCourse:(NSDictionary *) aCourse
{
    self = [super init];
    if (self) {
        self.firstName = aFirstName;
        self.lastName = aLastName;
        self.password = aPassword;
        self.admin = aAdmin;

    }
    return self;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:18:30.350

Anoop 已经确定了属性，但您的第一个问题仍未得到解答。

我的第一篇文章是“我认为你不能分配给 self 的原因是你的 init 方法签名不正确。

我不是 100% 确定这一点，但我认为对于 X 的实现，init 应该返回 (X*) " 这是虚假的 - (id) init; 是完全有效的。

错误消息对于以下内容并不完全准确，但您的问题之一是在 - (id) init 中，您调用 [self initWith....]，但此时尚未设置 self。如果您想编写一次该代码，则必须进行重构，但恕我直言，更好的解决方案是

```
- (id) init {
    self = [super init];
    if ( self) {
        self.firstName = @"";
        self.lastName = @"";
        self.password = @"";
        self.admin = @"";
    }
    return self;
} 
```

作为奖励点，我还想指出您不使用/设置课程:)

# php - PHP网站域名

> ID：16194041
> 
> 赞同：0
> 
> 时间：2013-04-24T14:02:44.947
> 
> 标签：php, dns, header, http-host, server-name

我看过一些类似[这样](https://stackoverflow.com/questions/2327777/parsing-domainname-from-url-in-php)的帖子，显示当前网站域可以从 $_SERVER['HTTP_HOST'] 和 $_SERVER['SERVER_NAME'] 访问。HTTP_HOST 是一个 HTTP 标头，因此用户可以自由更改它。没有理由相信它是准确的。在我的情况下，SERVER_NAME 没有改变，因为我使用的域别名确实改变了域，但没有改变 SERVER_NAME。在这种情况下最好做什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:07:46.497

尽管用户可以自由更改`HTTP_HOST`，但在这种情况下，他们很难访问您的网站。

无论如何，我认为这种改变能力没有问题。好的，即使我将此标头设置为`some.bad.bad.words`- 它会伤害谁？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:19:11.727

您可以信任您的主机名。尝试：

```
$hostname = exec('echo $HOSTNAME'); 
```

# .net - 假设：在 SQL Server for .NET MVC 应用程序中存储具有不同特异性的日期时间数据

> ID：16194044
> 
> 赞同：1
> 
> 时间：2013-04-24T14:02:49.550
> 
> 标签：.net, sql-server, nhibernate, date

我有五个 .NET 类和相应的 SQL Server 表，每个表都有一个开始和结束日期，我可能必须存储具有不同程度特异性的日期，例如 2005、04/2005 或 04/01/ 2005 年。也就是说，我可能必须存储日、月和年；月份和年份；或者只是一年。

最好的方法是什么？我将要使用的方式（由于时间限制）是为我的应用程序添加一个枚举以获取特定性，为每个类/表添加一个列/属性以获取特定性，并将值存储为最早的日期值，例如，如果用户提供 04/2005，则为 04/01/2005。我正在使用 NHibernate，但我的问题主要是关于数据库的。

我想知道，因为我确信我必须再次这样做，并且我想要一个更好的解决方案，也许是使用 CLR 用户定义类型的东西？

谢谢！

编辑：我最终做了一些更像在所选答案中的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:14:26.157

拥有三个数据类型为 SMALLINT 的可空列用于年份和 TINYINT 用于月份和日期似乎是最简单的解决方案。如果你需要一个索引，你可以把它放在 Year ASC、Month ASC、Day ASC 上。您可以使用 SQL Server 的 DATEPART 函数将日期值转换为您的值。

您可以通过如下查询获得此特殊日期的类型：

```
SELECT CASE WHEN Month IS NULL THEN 'YearOnly'
            WHEN Day IS NULL THEN 'YearMonth'
            ELSE 'FullDate'
       END AS SpecialDateType
  FROM dbo.yourtable; 
```

您可以将这一切包装在 CLR 数据类型中，但我不确定这是否值得。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:57:27.090

我认为将值存储为日期是有意义的，因为它会使查询变得简单。我认为不需要枚举来声明特异性。我将使用支持字段对属性进行建模，并通过公共 getter/setter 控制分辨率：

```
private DateTime _theDate;

public DateTime TheDate
{
    get { return _theDate; }
    set { _theDate = new DateTime(value.Year, value.Month, 1); }
    // or use a utility class _theDate = DateUtils.MonthResolution(value);
} 
```

# matlab - Matlab中的数组

> ID：16194045
> 
> 赞同：-2
> 
> 时间：2013-04-24T14:02:53.143
> 
> 标签：matlab

我需要找到数组中 1 位的位置和 1 之前的 0 位的数量。这意味着在下面的数组中我需要实现`placeOfOne=3` `numberOfZeros=2`：

```
a = [0 0 1 0] 
```

我们对此有什么功能吗？最好的，埃尔纳兹

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:20:40.053

按照您的示例，我假设您的输入向量仅包含“1”和“0”的二进制值。

如果您正在寻找“1”的位置，请按照`find`每个人的建议使用。零的数量应该总是“1”的位置减去前面“1”的数量：

```
placeOfOne = find(a);
numberOfZeros = placeOfOne - (1:numel(placeOfOne)); 
```

如果您只寻找第一个“1”，请添加第二个参数。这减少到：

```
placeOfOne = find(a, 1);
numberOfZeros = placeOfOne - 1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:05:12.060

使用[find](http://www.mathworks.com/help/matlab/ref/find.html)获得 1 的位置

```
placeOfOne = find(a) 
```

然后在此之前总结零：

```
numberOfZeros = sum(a(1:placeOfOne)  == 0) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:05:41.923

[`isMember`](http://www.mathworks.com/help/matlab/ref/ismember.html)如果存在 0 和 1 以外的元素，则可以使用该函数。

另外，如果只有 0 和 1，那么零的数量应该是`(position of 1) - 1`，不是吗？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:12:27.743

略有不同的做法

```
a = [0 0 1 0];
placeOfOne = find(a==1);
digitsBeforeOne = a(1:placeOfOne);
numberOfZeros= length(find(digitsBeforeOne ==0)); 
```

# javascript - 从 HTML Canvas 中分离 Javascript 代码

> ID：16194047
> 
> 赞同：1
> 
> 时间：2013-04-24T14:02:56.827
> 
> 标签：javascript, html, canvas

我正在尝试学习从 javascript 代码中提取的 HTML5 Canvas。

似乎我无法将 Javascript 代码与原始 html 分开。一直在寻找一些解决方案：

*   [HTML5 Canvas 在外部 JavaScript 文件中不起作用](https://stackoverflow.com/questions/11349613/html5-canvas-not-working-in-external-javascript-file)
*   [画布html标签](https://stackoverflow.com/questions/11032138/canvas-html-tag)

这些对我来说并不是一个解决方案，因为在我实现了这两个解决方案之后，在我看来是空白画布。

这是我的代码。

```
<!DOCTYPE html>
<html>
<head>
    <title>Christoper Hans' Paint HTML5 Project</title>
    <link rel="stylesheet" type="text/css" href="paint.css">
    <script type="text/javascript"><!--
        window.addEventListener('load', function () {
            var ctx = document.getElementById("paint").getContext("2d");
            ctx.canvas.width  = window.innerWidth;
            ctx.canvas.height = window.innerHeight;

            function drawRect(ctx, x1, y1, x2, y2, fill) {

            ctx.fillStyle=fill;
            ctx.fillRect(x1, y1, x2, y2);
            }

            drawRect(ctx, 100, 100, 200, 250, "FF0000");
        }, false);
// --></script>

</head>
<body>
    <canvas id="paint" width="500" height="500" style="border:1px solid #c3c3c3;">
    Your browser does not support the HTML5 canvas tag.
    </canvas>
</body> 
```

我不知道为什么，但只有*我从该网站的帖子中获得的这种*代码有效，我无法将 javascript 与外部文件分开。

TL;DR ：想要将 javascript 与 html 分开以使用画布。

有帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:05:22.980

我不得不猜测您也在将`<!--`and复制`// -->`到您的外部文件中。如果是这样，请不要这样做。你甚至不应该再使用它们，除非你正在迎合上个千年的浏览器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-02T03:30:08.810

对不起大家。是我的错字导致任何外部 javascript 无法加载。@CBroe 指出了这一点，现在似乎一切正常。

# vba - VBA在If / Then语句之前计算单元格值

> ID：16194048
> 
> 赞同：1
> 
> 时间：2013-04-24T14:02:56.630
> 
> 标签：vba, if-statement

我正在运行代码`VBA`以测试右侧的单元格是否小于 0，如果是，则将活动单元格设为 0。这应该在输入单元格时运行。这是我到目前为止所拥有的：

```
Private Sub worksheet_change(ByVal target As Range)  
If Not Intersect(target, Range("c7:c27")) Is Nothing Then isNegative  
End Sub 
```

接着

```
Sub isNegative()  
Dim cell As Range  
If ActiveCell.Offset(1, 0).Value < 0 Then  
ActiveCell.Value = 0  
End If  
End Sub 
```

但是，我假设正在发生的是它在计算之前检查数据。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:07:04.837

> 这应该在输入单元格时运行。

像这样？

```
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    Dim aCell As Range

    If Not Intersect(Target, Range("C7:C27")) Is Nothing Then
        For Each aCell In Range("C7:C27")
            If aCell.Offset(1, 0).Value < 0 Then aCell.Value = 0
        Next
    End If
End Sub 
```

# java - 如何调用 HSQLDB 函数 MONTHS_BETWEEN？

> ID：16194049
> 
> 赞同：0
> 
> 时间：2013-04-24T14:02:57.197
> 
> 标签：java, sql, function, hsqldb

我正在尝试执行以下 SQL：

`select months_between(sc.dat_initial_period, hp.dat_signup) + 1 as months from harvest_partner hp inner join sales_commission sc on hp.idt_harvest_partner = sc.idt_harvest_partner;`

针对 HSQLDB 版本：`2.2.9`并且我收到以下错误：

`Error code -5501, SQL state 42501: user lacks privilege or object not found: MONTHS_BETWEEN`

我正在通过这个 URL 创建数据库：`jdbc:hsqldb:/hsql/testdb`

SQL 正在由 Netbeans SQL 客户端、HSQLDB 数据库管理器甚至是纯 JDBC Java 代码执行，所有错误都发生了。

HSQLDB 文档说它有这样的功能（`MONTHS_BETWEEN`）： http: [//hsqldb.org/doc/2.0/guide/builtinfunctions-chapt.html#bfc_datetime_arithmetic](http://hsqldb.org/doc/2.0/guide/builtinfunctions-chapt.html#bfc_datetime_arithmetic)

在下面的链接中说它是在 2012 年 11 月发布的一些快照：http: [//comments.gmane.org/gmane.comp.java.hsqldb.user/6201](http://comments.gmane.org/gmane.comp.java.hsqldb.user/6201)

我的代码有问题，或者我缺少任何能够调用此类函数的配置？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:21:56.187

HSQLDB 2.3.0 支持此功能。您可以在此处获取最新快照：

[http://www.hsqldb.org/repos/org/hsqldb/hsqldb/SNAPSHOT/](http://www.hsqldb.org/repos/org/hsqldb/hsqldb/SNAPSHOT/)

# c - 使用客户端 hello 消息进行 TLS 协议检测

> ID：16194050
> 
> 赞同：2
> 
> 时间：2013-04-24T14:02:57.160
> 
> 标签：c, ssl

我需要检测网络流量中的 https 数据包。到目前为止，我将所有“443”标记为 https，但我不想再在这种情况下使用端口信息。

检查客户端问候消息是否足够：

```
//Check 22 and version info 0300 0301 or 0302
if (packet->payload[0] == 0x16 && packet->payload[1] == 0x03
  && (packet->payload[2] == 0x00 || packet->payload[2] == 0x01 || packet->payload[2] == 0x02)

{
    int temp = ntohs(get_u16(packet->payload, 3)) + 5;//Get lenght 
    //Check lenght is valid and 6th byte is client hello(which is 1)
    if (temp < packet->payload_length && temp > 50 && packet->payload[5]) == 1) 
        MARK AS HTTPS 
} 
```

由于我的项目设计，我不能检查多个数据包。你能告诉我像上面这样检查客户你好是否可以？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:06:15.323

> 由于我的项目设计，我不能检查多个包。你能告诉我像上面这样检查客户你好是否可以？

我假设您的意思是“包”而不是“包”。鉴于我们在这里使用 TCP，能够重新组装分段消息是必不可少的。只要您有一个仅对单个数据包进行操作的工具，您就不能期望可靠地（如 100% 的时间）检测长于单个字节的消息内容。那是因为 TCP 发送方将字节一个接一个地传送给你是完全合法的……所以你需要准备好重新组装它们，否则你会错过一些信息。

# tomcat - 加密tomcat密钥库密码

> ID：16194052
> 
> 赞同：13
> 
> 时间：2013-04-24T14:03:00.987
> 
> 标签：tomcat, server.xml

是否有加密tomcat *server.xml中的**keystorePass*值的选项？我不希望它是纯文本

 *```
 <Connector port="8403" //...
        keystorePass="myPassword" /> 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2016-04-12T04:50:18.877

除了使用 XML 编码之外，还有一种更好的方法。

创建一个加密类来加密和解密您的密码。

并覆盖**Http11Nio2Protocol**类，类似于下面的代码。

```
 public class Http11Nio2Protocol extends org.apache.coyote.http11.Http11Nio2Protocol {

@Override
public void setKeystorePass(String s) {
    try {
        super.setKeystorePass(new EncryptService().decrypt(s));
    } catch (final Exception e){
        super.setKeystorePass("");
    }
} 
```

}

注意：**EncryptService**是我们自己的加密类。

**并在server.xml**的协议属性中配置被覆盖的类，如下所示。

```
<Connector port="8443" protocol="<com.mypackage.overridden_Http11Nio2Protocol_class>"
           maxThreads="150" SSLEnabled="true" scheme="https" secure="true"
           clientAuth="false" sslProtocol="TLS" 
          keystoreFile="conf/.ssl/keystore.jks"        
           keystorePass="<encrypted_password>"/> 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-24T14:26:00.590

如果有人可以访问您的 server.xml，那么出现的 keystorePass 的纯文本值只是您的担忧之一。

如果有人可以从那里访问，他们可能会造成更大的伤害。在这里加密密码实际上只是将问题转移到其他地方，因为然后有人可以找到此加密密钥的加密密钥（有点像俄罗斯娃娃）。

如果你想加密密码，你必须重写连接器实现来解密加密的密码，以便tomcat可以访问或使用真正的密码。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-06-17T08:26:04.943

面临同样的问题。客户要求“隐藏”所有密码。

因此，通过审核的最简单方法 - 来自[Tomcat Wiki](http://wiki.apache.org/tomcat/FAQ/Password)。

转到页面[http://coderstoolbox.net/string/#!encoding=xml&action=encode&charset=none](http://coderstoolbox.net/string/#!encoding=xml&action=encode&charset=none)并编码您传递给 XML-view。

因此 -`<Connector>`元素看起来像：

```
<Connector
  port="8443"
  protocol="HTTP/1.1"
  SSLEnabled="true"
  enableLookups="false"
  disableUploadTimeout="true"
  scheme="https"
  secure="true"
  clientAuth="want"
  sslProtocol="TLS"
  keystoreFile="conf/.ssl/keystore.jks"
  keyAlias="tomcat"
  keystorePass="&#99;&#104;&#105;&#107;&#115;"
  truststoreFile="conf/.ssl/trustedstore.jks"
  truststorePass="&#99;&#104;&#105;&#107;&#115;"
/> 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-12-27T09:16:54.123

我们也面临类似的问题，但我们创建了自己的加密和解密逻辑来解决这个问题。这是代码

```
/* class is used to generate encrypted password */

public class ClientForPasswordGeneration {

    public static void main(String[] args) {
        //final String secretKey = "ssshhhhhhhhhhh!!!!";
        final String secretKey = PasswordKey.getEncryptionKey();
        GenerateLogic object = new GenerateLogic();

        String password = PasswordField.readPassword("Enter password: ");

        String encryptPassword = object.encrypt(password, secretKey);
        System.out.println("Encrypted Password:");
        System.out.println(encryptPassword);

    }

} 
```

另一个班级

```
class EraserThread implements Runnable {
    private boolean stop;

    /**
     * @param The
     *            prompt displayed to the user
     */
    public EraserThread(String prompt) {
        System.out.print(prompt);
    }

    /**
     * Begin masking...display asterisks (*)
     */
    public void run() {
        stop = true;
        while (stop) {

            System.out.print("\010*");

            try {

                Thread.currentThread().sleep(1);
                // System.out.println("current thread::" + Thread.currentThread());
            } catch (InterruptedException ie) {
                ie.printStackTrace();
            }
        }
    }

    /**
     * Instruct the thread to stop masking
     */
    public void stopMasking() {
        this.stop = false;
    }

} 
```

生成哈希码的逻辑

```
import java.io.UnsupportedEncodingException;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Arrays;
import java.util.Base64;

import javax.crypto.Cipher;
import javax.crypto.spec.SecretKeySpec;

public class GenerateLogic {
    private static SecretKeySpec secretKey;
    private static byte[] key;

    public static void setKey(String myKey) {
        MessageDigest sha = null;
        try {
            key = myKey.getBytes("UTF-8");
            sha = MessageDigest.getInstance("SHA-1");
            key = sha.digest(key);
            key = Arrays.copyOf(key, 16);
            secretKey = new SecretKeySpec(key, "AES");
        } catch (NoSuchAlgorithmException e) {
            e.printStackTrace();
        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        }
    }

    public static String encrypt(String strToEncrypt, String secret) {
        try {
            setKey(secret);
            Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5Padding");
            cipher.init(Cipher.ENCRYPT_MODE, secretKey);
            return Base64.getEncoder().encodeToString(cipher.doFinal(strToEncrypt.getBytes("UTF-8")));
        } catch (Exception e) {
            System.out.println("Error while encrypting: " + e.toString());
        }
        return null;
    }

    public static String decrypt(String strToDecrypt) {
        try {
            //System.out.println("decryptedString methods");
            //String secret = "ssshhhhhhhhhhh!!!!";
            String secret = PasswordKey.getEncryptionKey();
            setKey(secret);
            Cipher cipher = Cipher.getInstance("AES/ECB/PKCS5PADDING");
            cipher.init(Cipher.DECRYPT_MODE, secretKey);
            //System.out.println("testing string values::" + new String(cipher.doFinal(Base64.getDecoder().decode(strToDecrypt))));
            return new String(cipher.doFinal(Base64.getDecoder().decode(strToDecrypt)));
        } catch (Exception e) {
            System.out.println("Error while decrypting: " + e.toString());
        }
        return null;
    }

    public static void main(String[] args) {
        final String secretKey = "ssshhhhhhhhhhh!!!!";

        String originalString = "changeit";
        String encryptedString = GenerateLogic.encrypt(originalString, secretKey);
        String decryptedString = GenerateLogic.decrypt(encryptedString);

        System.out.println(originalString);
        System.out.println(encryptedString);
        System.out.println(decryptedString);
    }

} 
```

这是我们扩展类 org.apache.coyote.http11.Http11Nio2Protocol 的地方，该类存在于 tomcat 8 的 lib 文件夹中的 tomcat-coyote-8.0.29.jar 中。因此，在编译这些类时，tomcat-coyote-8.0。 29.jar 应该存在。

```
public class Http11Nio2Protocol extends org.apache.coyote.http11.Http11Nio2Protocol {

    @Override
    public void setKeystorePass(String s) {
        try {
            super.setKeystorePass(new GenerateLogic().decrypt(s));
        } catch (final Exception e) {
            super.setKeystorePass("");
        }
    }

} 
```

这是用户必须在 cmd 中输入密码的地方，该密码应该被散列

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class PasswordField {

    /**
     * @param prompt
     *            The prompt to display to the user
     * @return The password as entered by the user
     */
    public static String readPassword(String prompt) {
        EraserThread et = new EraserThread(prompt);
        Thread mask = new Thread(et);
        mask.start();

        BufferedReader in = new BufferedReader(new InputStreamReader(System.in));
        String password = "";

        try {
            password = in.readLine();

        } catch (IOException ioe) {
            ioe.printStackTrace();
        }
        // stop masking
        et.stopMasking();
        // return the password entered by the user
        return password;
    }
} 
```

这是您保存密码密钥的地方。你应该改变它。

```
public class PasswordKey {

    private static String ENCRYPTION_KEY = "myKeysecretkey";

    protected static String getEncryptionKey()
    {
        return ENCRYPTION_KEY;
    }

} 
```

编译上面的类以在 cmd 中使用以下命令生成类文件。请记住，tomcat-coyote-8.0.29.jar 应该存在于所有 java 文件所在的同一文件夹中。

```
javac  -cp ".;tomcat-coyote-8.0.29.jar" *.java 
```

在 cmd 中使用此命令使用生成的类文件制作一个 jar

```
jar -cvf  PasswordEncryptor.jar  *.class 
```

这将创建一个 jar 文件 PasswordEncryptor.jar

将生成的 PasswordEncryptor.jar 粘贴到 Tomcat8 的 lib 文件夹中。即 apache-tomcat-8.5.9\lib

现在转到此位置并键入以下命令以生成散列密码。

```
java -cp ".;PasswordEncryptor.jar" ClientForPasswordGeneration 
```

[![输入密码，它将显示哈希密码](https://i.stack.imgur.com/ZfWrp.png)](https://i.stack.imgur.com/ZfWrp.png)

现在转到 apache-tomcat-8.5.9\conf 并编辑 server.xml

在证书的 keytorpasss 中使用散列密码

```
<Connector port="9443" protocol="Http11Nio2Protocol" SSLEnabled="true"
               maxThreads="150" scheme="https" secure="true"
               clientAuth="false" sslProtocol="TLS" 
        keystoreFile="C:\Certificates\SSLCert.cert" keystorePass="nOS74yuWW4s18TsL2UJ51A=="/> 
```

注意协议是自定义类名。

希望这会帮助你。

谢谢

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-10-25T18:58:37.703

1）创建`CustomEncryptService`加密和解密您的密码。

2）覆盖`Http11Nio2Protocol`类，类似于下面的代码。（如上面 user3675974 所述）

```
public class CustomHttp11Nio2Protocol extends org.apache.coyote.http11.Http11Nio2Protocol {

  @Override
  public void setKeystorePass(String s) {
    try {
      super.setKeystorePass(new CustomEncryptService().decrypt(s));
    } catch (final Exception e){
      super.setKeystorePass("");
    }
  }
} 
```

3) 在 server.xml 的协议属性中配置被覆盖的类，如下所示。

```
<Connector port="8443" 
  protocol="<com.mypackage.xyz....CustomHttp11Nio2Protocol>"
  maxThreads="150" 
  SSLEnabled="true" 
  scheme="https" 
  secure="true"
  clientAuth="false" 
  sslProtocol="TLS" 
  keystoreFile="conf/.ssl/keystore.jks"        
  keystorePass="<encrypted_password>"/> 
```

4）由于这个`CustomHttp11Nio2Protocol`类应该在启动时可用，创建具有`CustomHttp11Nio2Protocol`and`CustomEncryptService`类的 Jar，并将其放入您的`tomcat/lib`.

希望这可以帮助。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-06-24T22:02:25.680

我们需要创建 jar 文件来解密放置在 keyStorePass 中的密码。以下是使用 Eclipse IDE 创建 jar 文件的步骤。：

第 1 步：在 Eclipse IDE 中，转到**New->Other->Java Project。单击 Next。输入项目名称。单击下一步并完成。**

第 2 步：展开新创建的项目。**右键单击src->新建->包。创建包名称为“com.apache”**

第三步：在 com.apache 包中创建一个类来解密密码：

```
package com.apache;
 public class DecryptPassword {

    public static synchronized String decrypt(String str) throws Exception {
            /* Decryption Logic*/
     }
} 
```

第 4 步：在 com.apache 包中创建一个名为 CustomHttp11Nio2Protocol 的新类，以扩展 org.apache.coyote.http11.Http11Nio2Protocol 类

```
package com.apache;
public class CustomHttp11Nio2Protocol extends org.apache.coyote.http11.Http11Nio2Protocol {

 @Override
 public void setKeystorePass(String s) {
   try {
      super.setKeystorePass(DecryptPassword.decrypt(s));
   } catch (final Exception e){
     super.setKeystorePass("");
   }
 }
} 
```

第 5 步：您将在上述课程中收到一些错误。通过**右键单击项目名称然后属性->构建路径->在库选项卡中->单击添加外部 jar 来解决它们。在tomcat的bin文件夹中选择tomcat-coyote.jar和tomcat-util.jar。还要选择tomcat的bin文件夹中的tomcat-juli.jar。现在两个类中的错误不应该是可见的。**

第 6 步：将项目导出为 JAR 文件。**右键单击项目名称->导出->在 Java 下选择 JAR 文件->单击下一步-> 选择导出目标作为 Tomcat 的 lib 文件夹。单击完成。**

第 7 步：将以下连接器粘贴到 tomcat 的 server.xml 中。**观察协议值包含我们在步骤 2 中定义的包名以及在步骤 4 中使用的类名。加密密码必须放在连接器的 keystorePass 中。**

```
<Connector
  protocol="com.apache.CustomHttp11Nio2Protocol"
  port="8443" maxThreads="200"
  scheme="https" secure="true" SSLEnabled="true"
  keystoreFile="serverCert.p12"
  keystorePass="<encrypted_password>"
  clientAuth="false" sslProtocol="TLS"/> 
```

第 8 步：重新启动 Tomcat。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-03-14T23:31:45.960

这是一个方便的 Perl 单线 XML 编码密码：

```
$ perl -pe 's/(.)/"&#".ord($1).";"/eg;' <<< 'secret'
# &#115;&#101;&#99;&#114;&#101;&#116; 
```*

# c# - .Net 4.5 中的异步 HttpClient 对于密集负载应用程序来说是一个糟糕的选择吗？

> ID：16194054
> 
> 赞同：132
> 
> 时间：2013-04-24T14:03:04.927
> 
> 标签：c#, asynchronous, .net-4.5, async-await, dotnet-httpclient

我最近创建了一个简单的应用程序来测试可以以异步方式生成的 HTTP 调用吞吐量与经典的多线程方法。

该应用程序能够执行预定义数量的 HTTP 调用，并在最后显示执行它们所需的总时间。在我的测试过程中，所有 HTTP 调用都是对我的本地 IIS 服务器进行的，它们检索到一个小文本文件（大小为 12 字节）。

下面列出了异步实现代码中最重要的部分：

```
public async void TestAsync()
{
    this.TestInit();
    HttpClient httpClient = new HttpClient();

    for (int i = 0; i < NUMBER_OF_REQUESTS; i++)
    {
        ProcessUrlAsync(httpClient);
    }
}

private async void ProcessUrlAsync(HttpClient httpClient)
{
    HttpResponseMessage httpResponse = null;

    try
    {
        Task<HttpResponseMessage> getTask = httpClient.GetAsync(URL);
        httpResponse = await getTask;

        Interlocked.Increment(ref _successfulCalls);
    }
    catch (Exception ex)
    {
        Interlocked.Increment(ref _failedCalls);
    }
    finally
    { 
        if(httpResponse != null) httpResponse.Dispose();
    }

    lock (_syncLock)
    {
        _itemsLeft--;
        if (_itemsLeft == 0)
        {
            _utcEndTime = DateTime.UtcNow;
            this.DisplayTestResults();
        }
    }
} 
```

下面列出了多线程实现中最重要的部分：

```
public void TestParallel2()
{
    this.TestInit();
    ServicePointManager.DefaultConnectionLimit = 100;

    for (int i = 0; i < NUMBER_OF_REQUESTS; i++)
    {
        Task.Run(() =>
        {
            try
            {
                this.PerformWebRequestGet();
                Interlocked.Increment(ref _successfulCalls);
            }
            catch (Exception ex)
            {
                Interlocked.Increment(ref _failedCalls);
            }

            lock (_syncLock)
            {
                _itemsLeft--;
                if (_itemsLeft == 0)
                {
                    _utcEndTime = DateTime.UtcNow;
                    this.DisplayTestResults();
                }
            }
        });
    }
}

private void PerformWebRequestGet()
{ 
    HttpWebRequest request = null;
    HttpWebResponse response = null;

    try
    {
        request = (HttpWebRequest)WebRequest.Create(URL);
        request.Method = "GET";
        request.KeepAlive = true;
        response = (HttpWebResponse)request.GetResponse();
    }
    finally
    {
        if (response != null) response.Close();
    }
} 
```

运行测试显示多线程版本更快。完成 10k 个请求大约需要 0.6 秒，而对于相同的负载量，异步请求大约需要 2 秒。这有点令人惊讶，因为我希望异步更快。也许是因为我的 HTTP 调用非常快。在现实世界的场景中，服务器应该执行更有意义的操作并且还应该存在一些网络延迟，结果可能会相反。

但是，我真正关心的是负载增加时 HttpClient 的行为方式。由于传送 10k 条消息大约需要 2 秒，我认为传送 10 倍的消息需要大约 20 秒，但运行测试表明传送 100k 条消息需要大约 50 秒。此外，传送 200k 条消息通常需要超过 2 分钟的时间，而且通常有几千条（3-4k）条消息会失败，但以下情况除外：

> 由于系统缺少足够的缓冲区空间或队列已满，因此无法对套接字执行操作。

我检查了 IIS 日志和失败的操作从未到达服务器。他们在客户内部失败了。我在 Windows 7 机器上运行测试，临时端口的默认范围为 49152 到 65535。运行 netstat 显示测试期间使用了大约 5-6k 端口，因此理论上应该有更多可用端口。如果缺少端口确实是异常的原因，则意味着 netstat 没有正确报告情况，或者 HttClient 仅使用了最大数量的端口，之后它开始抛出异常。

相比之下，生成 HTTP 调用的多线程方法表现得非常可预测。我花了大约 0.6 秒处理 10k 条消息，大约 5.5 秒处理 100k 条消息，正如预期的那样，处理 100 万条消息大约需要 55 秒。没有一条消息失败。此外，在运行时，它从未使用超过 55 MB 的 RAM（根据 Windows 任务管理器）。异步发送消息时使用的内存与负载成比例增长。在 200k 消息测试期间，它使用了大约 500 MB 的 RAM。

我认为造成上述结果的主要原因有两个。第一个是 HttpClient 在与服务器创建新连接时似乎非常贪婪。netstat 报告的大量使用端口意味着它可能不会从 HTTP 保持活动中受益。

二是HttpClient似乎没有节流机制。事实上，这似乎是与异步操作相关的普遍问题。如果您需要执行大量操作，它们将立即启动，然后它们的延续将在可用时执行。理论上这应该没问题，因为在异步操作中，负载在外部系统上，但正如上面所证明的，情况并非完全如此。一次启动大量请求会增加内存使用量并减慢整个执行速度。

通过使用简单但原始的延迟机制限制异步请求的最大数量，我设法在内存和执行时间方面获得了更好的结果：

```
public async void TestAsyncWithDelay()
{
    this.TestInit();
    HttpClient httpClient = new HttpClient();

    for (int i = 0; i < NUMBER_OF_REQUESTS; i++)
    {
        if (_activeRequestsCount >= MAX_CONCURENT_REQUESTS)
            await Task.Delay(DELAY_TIME);

        ProcessUrlAsyncWithReqCount(httpClient);
    }
} 
```

如果 HttpClient 包含一个限制并发请求数量的机制，那将非常有用。使用 Task 类（基于 .Net 线程池）时，通过限制并发线程数自动实现节流。

为了获得完整的概述，我还创建了一个基于 HttpWebRequest 而不是 HttpClient 的异步测试版本，并设法获得了更好的结果。首先，它允许设置并发连接数的限制（使用 ServicePointManager.DefaultConnectionLimit 或通过配置），这意味着它永远不会耗尽端口，也永远不会在任何请求上失败（HttpClient，默认情况下，基于 HttpWebRequest ，但似乎忽略了连接限制设置）。

异步 HttpWebRequest 方法仍然比多线程方法慢 50% - 60%，但它是可预测且可靠的。唯一的缺点是它在大负载下使用了大量内存。例如，它需要大约 1.6 GB 来发送 100 万个请求。通过限制并发请求的数量（就像我在上面对 HttpClient 所做的那样），我设法将使用的内存减少到仅 20 MB，并获得比多线程方法慢 10% 的执行时间。

在这个冗长的介绍之后，我的问题是：.Net 4.5 中的 HttpClient 类对于密集负载应用程序来说是不是一个糟糕的选择？有什么方法可以限制它，这应该可以解决我提到的问题吗？HttpWebRequest 的异步风格怎么样？

**更新（感谢@Stephen Cleary）**

事实证明，HttpClient 就像 HttpWebRequest（默认基于它）一样，可以通过 ServicePointManager.DefaultConnectionLimit 限制同一主机上的并发连接数。奇怪的是，根据[MSDN](http://msdn.microsoft.com/en-us/library/system.net.servicepointmanager.defaultconnectionlimit.aspx)，连接限制的默认值为 2。我还使用调试器检查了这一点，它指出确实 2 是默认值。但是，似乎除非显式为 ServicePointManager.DefaultConnectionLimit 设置一个值，否则默认值将被忽略。由于我在 HttpClient 测试期间没有明确地为它设置一个值，我认为它被忽略了。

在将 ServicePointManager.DefaultConnectionLimit 设置为 100 之后，HttpClient 变得可靠且可预测（netstat 确认仅使用了 100 个端口）。它仍然比异步 HttpWebRequest 慢（大约 40%），但奇怪的是，它使用的内存更少。对于涉及 100 万个请求的测试，它使用了最大 550 MB，而异步 HttpWebRequest 中使用了 1.6 GB。

因此，虽然 HttpClient 与 ServicePointManager.DefaultConnectionLimit 组合似乎确保了可靠性（至少对于所有调用都针对同一主机进行的情况），但它的性能似乎仍因缺乏适当的节流机制而受到负面影响。将并发请求数限制为可配置值并将其余请求放入队列的东西将使其更适合高可伸缩性场景。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-05-13T17:53:54.180

除了问题中提到的测试之外，我最近还创建了一些新的测试，这些测试涉及更少的 HTTP 调用（5000 个，而之前的 100 万个），但请求的执行时间要长得多（500 毫秒，而之前的大约 1 毫秒）。两个测试应用程序，同步多线程应用程序（基于 HttpWebRequest）和异步 I/O 应用程序（基于 HTTP 客户端）产生了相似的结果：使用大约 3% 的 CPU 和 30 MB 内存执行大约 10 秒。两个测试器之间的唯一区别是多线程的使用了 310 个线程来执行，而异步的只有 22 个。

作为我的测试的结论，在处理非常快的请求时，异步 HTTP 调用不是最佳选择。其背后的原因是，当运行包含异步 I/O 调用的任务时，一旦进行异步调用，启动任务的线程就会退出，并将任务的其余部分注册为回调。然后，当 I/O 操作完成时，回调将排队等待在第一个可用线程上执行。所有这些都会产生开销，这使得快速 I/O 操作在启动它们的线程上执行时更加高效。

在处理长或可能长的 I/O 操作时，异步 HTTP 调用是一个不错的选择，因为它不会让任何线程忙于等待 I/O 操作完成。这减少了应用程序使用的线程总数，允许 CPU 绑定操作花费更多 CPU 时间。此外，在只分配有限数量线程的应用程序上（就像 Web 应用程序的情况一样），异步 I/O 可以防止线程池线程耗尽，如果同步执行 I/O 调用可能会发生这种情况。

因此，异步 HttpClient 不是密集负载应用程序的瓶颈。只是就其本质而言，它不太适合非常快速的 HTTP 请求，而是非常适合长或可能长的请求，尤其是在只有有限数量可用线程的应用程序中。此外，通过 ServicePointManager.DefaultConnectionLimit 限制并发性是一个很好的做法，其值足够高以确保良好的并行度，但又足够低以防止临时端口耗尽。[您可以在此处](http://www.ducons.com/blog/tests-and-thoughts-on-asynchronous-io-vs-multithreading)找到有关针对此问题提出的测试和结论的更多详细信息。

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-04-25T20:04:02.940

要考虑的可能会影响您的结果的一件事是，使用 HttpWebRequest 您不会获得 ResponseStream 并使用该流。使用 HttpClient，默认情况下它将网络流复制到内存流中。为了以与当前使用 HttpWebRquest 相同的方式使用 HttpClient，您需要这样做

```
var requestMessage = new HttpRequestMessage() {RequestUri = URL};
Task<HttpResponseMessage> getTask = httpClient.SendAsync(requestMessage, HttpCompletionOption.ResponseHeadersRead); 
```

另一件事是我不确定真正的区别是什么，从线程的角度来看，你实际上是在测试。如果您深入研究 HttpClientHandler ，它只会执行 Task.Factory.StartNew 以执行异步请求。线程行为被委派给同步上下文，其方式与您的 HttpWebRequest 示例完全相同。

毫无疑问，HttpClient 会增加一些开销，因为默认情况下它使用 HttpWebRequest 作为其传输库。因此，在使用 HttpClientHandler 时，您将始终能够直接通过 HttpWebRequest 获得更好的性能。HttpClient 带来的好处是标准类，如 HttpResponseMessage、HttpRequestMessage、HttpContent 和所有强类型标头。它本身并不是性能优化。

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2016-04-15T16:13:53.823

虽然这并没有直接回答 OP 问题的“异步”部分，但这解决了他正在使用的实现中的一个错误。

如果您希望您的应用程序可扩展，请避免使用基于实例的 HttpClients。区别是巨大的！根据负载，您将看到非常不同的性能数字。HttpClient 旨在跨请求重用。编写它的 BCL 团队的人证实了这一点。

我最近的一个项目是帮助一家非常大的知名在线计算机零售商扩展黑色星期五/假日流量的一些新系统。我们在使用 HttpClient 时遇到了一些性能问题。由于它实现了 ，开发人员通过创建一个实例并将其放在语句中`IDisposable`来完成您通常会做的事情。`using()`一旦我们开始对应用程序进行负载测试，服务器就会崩溃——是的，服务器不仅仅是应用程序。原因是 HttpClient 的每个实例都会在服务器上打开一个 I/O 完成端口。由于 GC 的非确定性最终确定以及您正在使用跨越多个[OSI 层](https://en.wikipedia.org/wiki/OSI_model)的计算机资源这一事实，关闭网络端口可能需要一段时间。事实上Windows操作系统**本身**关闭端口最多可能需要 20 秒（根据 Microsoft）。我们打开端口的速度比关闭端口的速度要快——服务器端口耗尽导致 CPU 达到 100%。我的解决方法是将 HttpClient 更改为解决问题的静态实例。是的，它是一种一次性资源，但性能差异远远超过了任何开销。我鼓励您进行一些负载测试，以了解您的应用程序的行为方式。

也在下面的链接中回答：

[在 WebAPI 客户端中每次调用创建一个新的 HttpClient 的开销是多少？](https://stackoverflow.com/questions/22560971/what-is-the-overhead-of-creating-a-new-httpclient-per-call-in-a-webapi-client/35045301#35045301)

[https://www.asp.net/web-api/overview/advanced/calling-a-web-api-from-a-net-client](https://www.asp.net/web-api/overview/advanced/calling-a-web-api-from-a-net-client)

# php - 在zend框架1中处理layout.phtml

> ID：16194055
> 
> 赞同：2
> 
> 时间：2013-04-24T14:03:06.180
> 
> 标签：php, zend-framework

我正在关注本教程（Zend Framework 1.11 入门）：[http ://akrabat.com/wp-content/uploads/Getting-Started-with-Zend-Framework.pdf](http://akrabat.com/wp-content/uploads/Getting-Started-with-Zend-Framework.pdf)

在第 10 页，zf-tutorial/application/layouts/scripts/layout.phtml，代码更改为：

```
<?php echo $this->layout()->content; ?> 
```

至：

```
<?php
$this->headMeta()->appendHttpEquiv('Content-Type', 'text/html;charset=utf-8');
$this->headTitle()->setSeparator(' - ');
$this->headTitle('Zend Framework Tutorial');
echo $this->doctype(); ?>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<?php echo $this->headMeta(); ?>
<?php echo $this->headTitle(); ?>
</head>
<body>
<div id="content">
<h1><?php echo $this->escape($this->title); ?></h1>
<?php echo $this->layout()->content; ?>
</div>
</body> 
```

问题：

1.  输出是一样的，为什么要改代码？

2.  在我运行原始代码后：`<?php echo $this->layout()->content; ?>`，在页面源代码中：有这样的输出：`<!DOCTYPE HTML PUBLIC....`在我运行修改后的代码后，在页面源代码中，`<!DOCTYPE HTML PUBLIC....`应该出现两次，一个来自`$this->headMeta()...`，一个来自`<?php echo $this->layout()->content; ?>`，但它只出现一次，为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:17:34.283

在第 10 页，您有问题的答案：

> **常用 HTML 代码：布局**
> 
> 很快就会很明显，在我们的视图中至少会有很多常见的 HTML 代码用于页眉和页脚部分，也许还有一两个侧边栏。这是一个很常见的问题，Zend_Layout 组件就是为了解决这个问题而设计的。**Zend_Layout 允许我们将所有常见的页眉、页脚和其他代码移动到布局视图脚本中，然后该脚本包含正在执行的操作的特定视图代码。**

如果您得到重复的结果，则必须在**view**和**layout**中包含所有这些常见的标题定义。确保将它们从您的**视图**中删除。

# wpf - 显示当单元格中的任何值更改时更新的几列的总和

> ID：16194058
> 
> 赞同：0
> 
> 时间：2013-04-24T14:03:15.370
> 
> 标签：wpf, data-binding, command, label

我正在尝试在标签中显示两列或多列中的值的总和（即组合总和），虽然我可以在加载数据时获得一个值，但总和缺乏在值时更新的功能应用程序运行时在单元格中更改。

如何实现此功能？我认为添加一个按钮来求和并使用路由命令会更容易。我更喜欢无按钮的方式，因为总和是应用程序的重点，我不希望用户在值更改时继续按下按钮来更新总和。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:18:34.873

每当其中一个值发生更改时，您都需要`PropertyChange`为该`Sum`属性发出通知，因此 Sum 的绑定知道它需要重新评估。

例如，

```
public int Value1
{
    get { return _value1; }
    set
    {
        if (_value1 != value)
        {
            _value1 = value;
            RaisePropertyChanged("Value1");
            RaisePropertyChanged("Sum");
        }
    }    
} 
```

或者

```
SomeDataObject.PropertyChanged += SomeDataObject_PropertyChanged;

void SomeDataObject_PropertyChanged(object sender, PropertyChangedEventArgs e)
{
    if (e.PropertyName == "Value1" || e.PropertyName == "Value2")
    {
        RaisePropertyChanged("Sum");
    }
} 
```

要引发属性更改通知，您需要实现[INotifyPropertyChanged](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.aspx)接口

此外，如果您绑定到 a `TextBox`，则默认值为`UpdateSourceTrigger`is `LostFocus`，因此您的 setter 和 PropertyChange 通知在 TextBox 失去焦点之前不会运行。如果您想在用户输入他们的号码时重新评估它，您可以`UpdateSourceTrigger`将绑定更改为。`OnPropertyChange`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:58:27.050

你用的是什么控件？

Datagrid fo 示例具有事件，当用户在此事件之后完成编辑单元格时可以使用这些事件，您可以对值进行恢复并更新标签，

# ipad - iOS 6 上的 iPad “UIStatusBarStyleBlackTranslucent 在此设备上不可用。”

> ID：16194061
> 
> 赞同：0
> 
> 时间：2013-04-24T14:03:25.730
> 
> 标签：ipad, ios6

我正在明确执行以下针对 iPad 的代码行：

```
[UIApplication sharedApplication].statusBarStyle = UIStatusBarStyleBlackTranslucent; 
```

这在我的控制台中给了我一个运行时警告（如标题所示）。虽然我可以通过指定不同的样式来解决这个问题，但我不完全理解为什么不支持它。例如，如果将 MPMoviePlayerController 置于全屏状态，则可以清楚地看到一个半透明的状态栏。

就我而言，我正在全屏放置一个视图，并且还希望状态栏是半透明的。

有什么见解吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-04T13:13:56.983

好吧，那个错误告诉你 iPad 不支持那种状态栏样式。

从文档：

> 在 iPad 设备上，UIStatusBarStyleDefault 和 UIStatusBarStyleBlackTranslucent 样式默认为 UIStatusBarStyleBlackOpaque 外观。

# android - 以编程方式停止 Android wifi 自动扫描

> ID：16194065
> 
> 赞同：2
> 
> 时间：2013-04-24T14:03:29.230
> 
> 标签：android, android-wifi

如果 wifi 未连接，我的 android 设备中的 wifi 每隔几秒钟就会自动扫描一次。我尝试使用以下方法阻止它：我尝试使用`WifiManager.createWifiLock()`and运行应用程序`acquire()`，但是，这似乎不起作用。

请让我知道为什么我的方法不起作用。有没有办法做到这一点？

# caml - caml 查询以获取 sharepoint 2013 上最受欢迎的文档？

> ID：16194067
> 
> 赞同：0
> 
> 时间：2013-04-24T14:03:33.540
> 
> 标签：caml, sharepoint-2013

我想取回拥有最多赞的网站集的所有文档？我怎样才能写一个caml查询？这就是我到目前为止所尝试的：

```
SPQuery query = newSPQuery();
Query.query = @ "<where> <Eq> <FieldRef Nom= 'NumberOfLikes'/> <ValueType = 'Integer'> 5 </value> </Eq> </where>" 
```

这使我能够拥有拥有 5 个赞的文档，但我想要那些拥有最多赞的文档：s

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T20:08:40.397

你只得到有5个赞的文件的原因是你正在使用操作。可以使用运算符获取点赞数超过5的文档。

您可以使用多个运算符。它们如下：

```
Eq                     Equals
===============================================
Neq                    Not equal
Gt                     Greater than
Geq                    Greater than or equal
Lt                     Lower than
Leq                    Lower than or equal too
IsNull                 Is null
BeginsWith             Begins with
Contains               Contains 
```

让我知道这是否适合您

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T15:52:43.383

您可以在 NumberOfLikes 上使用 orderbyquery，这样您将获得最大的文档，如顶部。如果您想要有限数量的文档，那么您可以设置一个 query.rowlimit 或者如果您没有像 5 这样的条件，那么您可以使用所有文档 gt>5 likes order by likes

# javascript - 加载多个版本的 javascript 库，动态和异步

> ID：16194068
> 
> 赞同：0
> 
> 时间：2013-04-24T14:03:34.663
> 
> 标签：javascript, dom, jsonp, requirejs, amd

我有许多不同版本的 javascript 库可以动态加载。

例如，假设我要加载 foo 库的多个版本。我有：

```
foo-0.1.js
foo-0.2.js 
```

Foo 不是兼容 AMD 的库，也没有无冲突模式。这是我无法控制的第三方库。它只是按照以下方式做一些事情：

```
window.Foo = fooFunction; 
```

这些库版本在插件场景中异步和动态加载。加载实际上是由requirejs完成的，但这并不重要。假设函数的内容被下载并执行。

假设我们有一个需要 foo-0.1 的 MODULE_1 插件和一个需要 foo-0.2 的 MODULE_2 插件。

当用户请求时（例如通过单击其名称），MODULE_1 被初始化并加载 foo-0.1。它设置用户界面（画布）并等待用户输入。window.foo 对象现在指向版本 0.1。

然后，用户请求 MODULE_2，它被初始化并开始加载 foo-0.2，然后设置它的画布并等待用户输入。现在 window.foo 被覆盖并指向 foo-0.2。

最后，用户点击 MODULE_1 的用户界面，它对情况做出反应并尝试做某事。但是 window.foo 指向的是 foo-0.2 对象，它与 MODULE_1 不兼容，并且崩溃得很惨。

我想要的是将 foo-0.1 存储在一个对象中，将 foo-0.2 存储在另一个对象中。加载 foo-0.1 和 foo-0.2 时有什么方法可以更改窗口对象吗？

PS。我认为这不会起作用：

```
/* MODULE_1 */
// load foo-0.1
// when ready:
var foo-0.1 = window.foo

/* MODULE_1 */
// load foo-0.2
// when ready:
var foo-0.2 = window.foo 
```

因为我不能确定两者之一的就绪事件会在另一个的就绪事件之前加载（对吗？）

PPS：我很清楚[RequireJs multiversion support](http://requirejs.org/docs/api.html#multiversion)，但除非加载的库符合 AMD 标准，否则它不会工作。

# extjs - 从 ExtJS 的面板中删除所有停靠的项目

> ID：16194069
> 
> 赞同：2
> 
> 时间：2013-04-24T14:03:44.233
> 
> 标签：extjs

我是 Sencha ExtJS 的新手，并试图弄清楚如何有效地从面板中删除所有停靠的项目。官方参考提到了方法`removeAll`（仅删除常规项目，似乎不适合我的目的）和`removeDocked`（仅删除一个停靠项目）。有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T14:26:41.110

如果您查看该[`removeAll`](http://docs.sencha.com/extjs/4.1.1/source/AbstractContainer.html#Ext-container-AbstractContainer-method-removeAll)函数的代码，您会发现它调用了该[`remove`](http://docs.sencha.com/extjs/4.1.1/source/AbstractContainer.html#Ext-container-AbstractContainer-method-remove)函数。
您可以创建自己的`removeAllDocked`函数，女巫将使用[`removeDocked`](http://docs.sencha.com/extjs/4.1.1/source/DockingContainer.html#Ext-container-DockingContainer-method-removeDocked).

# python - 使用 startproject 命令 Mac OS X Snow Leopard 时出现 Django Unicode 解码错误

> ID：16194070
> 
> 赞同：0
> 
> 时间：2013-04-24T14:03:44.967
> 
> 标签：python, django, django-admin

我是 Django 的新手，我马上就遇到了一个大问题。我无法使用 startproject 来启动我的网络应用程序。

当我使用这个命令时：

```
/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/django/bin/django-admin.py startproject cms 
```

我收到此错误：

> UnicodeDecodeError：“utf8”编解码器无法解码位置 37 中的字节 0xb0：无效的起始字节

然后它不会创建网络应用程序。我什至没有做过任何编程，这似乎是 Django 文件的问题，但我真的很困惑，因为他们自己的文件会有一个不是英语的字符会导致这个错误。我一直在网上搜索，发现有人出现 Unicode 解码错误，但在这个特定步骤中没有任何人，到目前为止我还没有找到答案。我在带有 Snow Leopard 的 Mac 上运行 Django，并且正在使用带有 Python 2.7 的稳定版本的 Django。我一直在尝试解决这个问题，但我一直在碰壁，我真的很想尝试 Django。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-17T01:52:31.787

我知道这个问题太老了，但是这个问题让我很头疼，我会分享我的解决方案，以便其他人受益。

我有完全相同的问题。在我的情况下，错误是因为当我解压缩 django 安装的 tar.gz 文件时，存档中的每个文件都有某种由 MacOS 创建的隐藏安全副本。因此，django 的模板文件夹中有很多带有奇怪字符的隐藏文件，这导致在 django-admin 脚本时出现错误消息“UnicodeDecodeError: 'utf8' codec can't decode byte 0xb0 in position 37: invalid start byte”试图将模板复制到目标文件夹。我所要做的就是找到每个名称以“。”开头的文件。并从 django 安装文件夹中删除它们。

我通过对 django 进行非常简单的调试发现了这一点，即使您的问题的原因不同，这种调试技术也可以帮助您找出正在发生的事情。

读取错误发生时的回溯我发现错误发生在函数调用 content.decode('utf-8') 上，在 django 1.8.1 中是在 django\core\management\templates.py 文件中生成的，第 150 行。我打开 templates.py 文件，找到该行并注意到“内容”是当前正在读取的模板文件的内容，它存储在变量“old_path”中。然后编辑 templates.py 以在调用 content.decode('utf-8') 之前打印“old_path”变量的值，当我再次运行 django-admin 脚本时，错误文件的名称出现在命令提示符。如果您重复此过程，您可以检查文件是否包含奇怪的字符，以及该文件是否不应该位于模板文件夹中（就像我的情况一样）。

# html - em 定义中的“当前选择的字体大小”是什么？

> ID：16194071
> 
> 赞同：0
> 
> 时间：2013-04-24T14:03:46.100
> 
> 标签：html, css, font-size, em

在这个问题中：[为什么用 em 而不是 px？](https://stackoverflow.com/questions/609517/why-em-instead-of-px)在最佳投票的答案中，*em*定义为：

> em 不是一个绝对单位——它是一个相对于当前选择的字体大小的单位。除非您通过使用绝对单位（例如 px 或 pt）设置字体大小来覆盖字体样式，否则这将受到用户浏览器或操作系统中字体选择的影响（如果他们已经制作了字体），因此没有意义使用 em 作为一般长度单位，除非您特别希望它随着字体大小的缩放而缩放。
> 
> 当您特别希望某物的大小取决于当前字体大小时，请使用 em。

在[我的网站](http://quran.2index.net)主页中，我在页面标题（网站名称）中有一个字体大小等于 2.1 em 的*h1*标签，它看起来小于字体大小等于 1.9 em 的*h2标签。*以下屏幕截图演示了使用 Google Chrome 浏览器的情况：

![在此处输入图像描述](https://i.stack.imgur.com/FvrOy.png)

**我的问题是：在***em*定义中考虑的当前字体大小是什么意思？换句话说，我怎么知道当前的字体大小？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:05:25.150

这意味着*em*是基于`font size`最近的相对父级的。因此， 的 parent 设置的 font-size`<h2>`必须大于`<h1>`的 parent。

因此，例如，如果 的父级的`<h2>`字体大小为*40px*，而 的父级的`<h1>`字体大小为`20px`，则`1.9em`的`40px`将*大于* `2.1em``20px`

[**在此处阅读更多内容以了解字体大小调整的工作原理**](http://kyleschaeffer.com/user-experience/css-font-size-em-vs-px-vs-pt-vs/)

# 更新/注意事项

如果您想保证页面中字体的大小，您应该考虑使用`px`设置`font-size`属性。使用*px*将保证字体大小是绝对的，而不是使用*em*得到的*相对值。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:20:56.400

只是在这里添加一个“基线”注释，如果您在 CSS 中将网站的基本字体大小设置为 100%，这相当于大约 16px 的大小。您还需要记住，如果您使用“em”作为度量单位，它将级联。这意味着如果您在容器元素上设置字体大小，则在其子元素上设置的任何字体大小都是根据该字体大小计算的。

例如，假设您将站点基本字体大小设置为 100%/16px。然后创建一个容器，其基本字体大小为 0.75em（大约 12px，12px/16px = .75）。然后在该容器中创建一个高度约为 24 像素的标题元素。要确定“em”值，您需要基于容器的字体大小，而不是基础站点字体大小。所以它不会是 1.5em（24px/16px，16px 是网站默认字体大小），而是 2em（24px/12px，12px 是容器上设置的字体大小）。*

# ruby-on-rails - 如何在表单发送期间呈现正确的保存失败视图？

> ID：16194072
> 
> 赞同：0
> 
> 时间：2013-04-24T14:03:48.083
> 
> 标签：ruby-on-rails, ruby, model-view-controller, simple-form, high-voltage

我正在使用[high_voltage](https://github.com/thoughtbot/high_voltage)创建各种数量的登录页面。

在这些页面上，我有不同的字段用于创建**用户**模型。每个表单都有电子邮件和随机的其他字段。

例如：

```
# views/pages/home1.html.erb
<%= simple_form_for(User.new) do |f| %>
  <%= f.input :email %>
  <%= f.input :first_name %>
  <%= f.button :submit, 'Sign up' %>
<% end %>

# views/pages/home2.html.erb
<%= simple_form_for(User.new) do |f| %>
  <%= f.input :email %>
  <%= f.input :last_name %>
  <%= f.button :submit, 'Sign up' %>
<% end %> 
```

然后我有用于创建**User**的控制器。

```
class UserController < ApplicationController
  def create
    @user = User.new(params[:user])

    if @user.save
      redirect_to root_path
    else
      render 'pages/home' # I don't know what should be here
    end
  end
end 
```

问题是，当有人写错电子邮件地址时，我想呈现正确的模板，但现在我`render 'pages/home'`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-12-06T21:55:29.477

我在这里回答了一个类似的帖子： [从静态页面渲染部分](https://stackoverflow.com/questions/20293225/render-partial-from-static-page/20434043#20434043)

这是提交数据和显示错误代码的提交： [https ://github.com/harlow/high_voltage_demo/commit/0cdbca5b0fe898d27df22787498fc7e350e81422](https://github.com/harlow/high_voltage_demo/commit/0cdbca5b0fe898d27df22787498fc7e350e81422)

在高层次上，我们需要一种方法来知道提交了哪个表单（以便在发生错误时呈现正确的表单）。这可以通过在控制器中创建不同的动作来实现。

```
# config/routes.rb
resources :users, only: [] do
  member do
    post 'short_form'
    post 'long_form'
  end
end 
```

控制器将有两个单独的操作：

```
class UserController < ApplicationController
  def short_form
    @user = User.new(short_form_params)
    @user.save
  end

  def long_form
    @user = User.new(long_form_params)
    @user.save
  end

  private

  def short_form_params
    params.permit(:user).require(:first_name, :last_name, :email)
  end

  def long_form_params
    params.permit(:user).require(:field1, :field2, :field3)
  end
end 
```

如果您对每个表单都使用一个局部变量，我们可以将 注入`User.new`局部变量`user`中。

```
# views/pages/home.html.erb
<%= render 'users/short_form', user: User.new %>

# views/users/_short_form.html.erb
<div id="short_form">
  <%= simple_form_for user, remote: true, url: create_user_short_form do |f| %>
    <%= f.input :email %>
    <%= f.input :first_name %>
    <%= f.button :submit, 'Sign up' %>
  <% end %>
</div>

# views/users/_long_form.html.erb
<div id="long_form">
  <%= simple_form_for user, remote: true, url: create_user_long_form do |f| %>
    <%= f.input :email %>
    <%= f.input :last_name %>
    <%= f.button :submit, 'Sign up' %>
  <% end %>
</div> 
```

来自控制器的响应将呈现`.js.erb`文件并检查它是否有效并返回正确的响应：

```
# views/users/short_form.js.erb
<% if @user.persisted? %>
   # you could redirect the user with JavaScript
   window.location.href = '<%= root_url %>';
   # or dynamically update the content of the page to let the User know their request was submitted
   $('#short_form').html('Thank you for your submission!'); 
<% else %>
   # this will replace the contents of the Form with the errors in it
   $('#short_form').html('<%= j render 'users/short_form', user: @user %>');
<% end %> 
```

希望这一切都有意义。如果您有任何后续问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:22:07.570

我没有使用 high_voltage，但根据您提供的链接，它似乎是为静态页面设计的，而不是像您正在使用的表单，所以我认为您有点超出其正常用例。还有其他支持多步骤向导的[gem 。](https://www.ruby-toolbox.com/categories/rails_wizards)

也就是说，您可能只是将页面信息存储在表单上的隐藏字段中，并在您的控制器中，验证它是否是合法的模板选项之一，如果是，则呈现它，否则默认为“pages/home”或返回403 错误或任何看起来最合适的错误。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-24T14:21:11.300

您不能将 current_template 发送到隐藏字段中的服务器吗？如果用户有验证错误，只需获取当前模板的名称并渲染它！

在视图中

```
 <%= form_for @user do %>
    <%= hidden_field_tag : template, __FILE__ %>
  <% end %> 
```

在控制器中

```
 if @user.save 
   #redirect 
 else
   render "home/#{params[:template]}"
 end 
```

只是一个想法！

# c - 由于 fopen() 和 FILE 导致的无法解释的错误

> ID：16194073
> 
> 赞同：3
> 
> 时间：2013-04-24T14:03:48.887
> 
> 标签：c, file, fopen, stdio

我无法理解由于以下代码而出现的错误。我正在尝试使用打开文件`fopen()`，但这些错误对我来说毫无意义。所以请解释一下整个事情。

```
10 - FILE * THE_FILE_YOU_READ;
11 - THE_FILE_YOU_READ = fopen("num.txt","r"); 
```

这两行单独产生几个警告和错误，如下所示：

```
11 - warning: data definition has no type or storage class [enabled by default]
11 - error: conflicting types for 'THE_FILE_YOU_READ'
10 - note: previous declaration of 'THE_FILE_YOU_READ' was here
11 - warning: initialization makes integer from pointer without a cast [enabled by default]
11 - error: initializer element is not constant 
```

如果它完全相关，我正在使用 Code::Blocks。我没有在程序的其他任何地方声明这个变量 `THE_FILE_YOU_READ。有什么想法，或者这只是我的愚蠢疏忽？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-24T14:10:45.707

您已经在文件范围内的任何函数之外编写了此代码。那是无效的。语句只能出现在函数中。在函数之外，编译器试图将第二行解释为声明/定义，隐式类型为`int`.

# android - 单击按钮时更改按钮的drawableLeft

> ID：16194090
> 
> 赞同：3
> 
> 时间：2013-04-24T14:04:41.443
> 
> 标签：android, button, onclick, android-drawable, xml-drawable

我有一个`Button`，`drawableLeft`当我点击它时，我只想更改`drawableleft`另一个图像。我必须使用什么java代码？

`XML`：

```
<Button
    android:id="@+id/docli_btn_apagar"
    android:layout_width="200dp"
    android:layout_height="70dp"
    android:background="@android:color/transparent"
    android:onClick="ApagarLinha"
    android:drawableLeft="@drawable/trash"
    android:text="@string/apagar" 
    android:textAppearance="?android:attr/textAppearanceLarge"/> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T14:13:00.980

这将在您的按钮`onClick()`处理程序中调用

```
// get your button
Button docli_btn_apagar = (Button) findViewById(R.id.docli_btn_apagar );

// get the drawable
Drawable img = getContext().getResources().getDrawable( R.drawable.smiley );

// set the drawable left
docli_btn_apagar.setCompoundDrawablesWithIntrinsicBounds( img, null, null, null ); 
```

或者：

```
// You can skip the drawable object directly, by using ints/IDs
docli_btn_apagar.setCompoundDrawablesWithIntrinsicBounds(R.drawable.smiley, 0, 0, 0); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:17:34.780

```
public class AsyncClassTest extends Activity {

String strMessage;
private Button button;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    button = (Button) findViewById(R.id.docli_btn_apagar);
    button.setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View view) {
            ((Button) view).setCompoundDrawables(getResources().getDrawable(android.R.drawable.btn_plus), null, null, null);
        }
    });
}
} 
```

# sql - 如何使我的 Powershell Get-WMIObject 脚本更快地在服务器中循环

> ID：16194091
> 
> 赞同：0
> 
> 时间：2013-04-24T14:04:50.510
> 
> 标签：sql, sql-server, performance, sql-server-2008, powershell

我正在编写一个脚本，该脚本检查服务器是否 ping，然后检查所有 SQL Server 服务状态并将其存储在表中。它还适用于 SQL 实例。但是，我必须检查 70 台服务器，并且运行需要一分钟多的时间。我查看了 AsJob 参数，当我将其添加到所有“Get_WMIObject xxService”命令时，它开始为每个服务返回错误信息。即它开始为所有人返回“运行”状态，所以我怀疑它只是重复先前的数据捕获。尽管它确实只运行了 20 秒。有人可以看看下面并建议我哪里出错了或者我可以做些什么来使服务器服务信息的检索异步？

我认为将所有服务器的服务状态存储在哈希表中并一次性更新 SQL 数据表可能会更好，但事实证明它相当复杂。我觉得我的代码需要完全重新考虑才能异步运行，但我试图避免这种情况！

提前致谢

```
<#
Tests all Servers for Ping and SQL Server Service Status
#>

# Return the Ping Status
Function GetStatusCode 
{  
    Param([int] $StatusCode)   
    switch($StatusCode) 
    { 
        0         {"Success"} 
        11001   {"Buffer Too Small"} 
        11002   {"Destination Net Unreachable"} 
        11003   {"Destination Host Unreachable"} 
        11004   {"Destination Protocol Unreachable"} 
        11005   {"Destination Port Unreachable"} 
        11006   {"No Resources"} 
        11007   {"Bad Option"} 
        11008   {"Hardware Error"} 
        11009   {"Packet Too Big"} 
        11010   {"Request Timed Out"} 
        11011   {"Bad Request"} 
        11012   {"Bad Route"} 
        11013   {"TimeToLive Expired Transit"} 
        11014   {"TimeToLive Expired Reassembly"} 
        11015   {"Parameter Problem"} 
        11016   {"Source Quench"} 
        11017   {"Option Too Big"} 
        11018   {"Bad Destination"} 
        11032   {"Negotiating IPSEC"} 
        11050   {"General Failure"} 
        default {"Failed"} 
    } 
} 

# Format the Server Up-time
Function GetUpTime 
{ 
    param([string] $LastBootTime) 
    $Uptime = (Get-Date) - [System.Management.ManagementDateTimeconverter]::ToDateTime($LastBootTime) 
    "Days: $($Uptime.Days); Hours: $($Uptime.Hours); Minutes: $($Uptime.Minutes); Seconds: $($Uptime.Seconds)"  
} 

#Main Body
# Populate Table MyDB.dbo.tbl_ServerPingTest

$conn = New-Object System.Data.SqlClient.SqlConnection("Data Source=MyServer; Initial Catalog=MyDB; Integrated Security=SSPI")
$conn.Open()

$cmd = $conn.CreateCommand()
$cmd.CommandText ="DELETE FROM MyDB.dbo.tbl_ServerPingTest
INSERT INTO MyDB.dbo.tbl_ServerPingTest (ServerName, InstanceName)
SELECT ServerName, InstanceName FROM MyDB.dbo.tbl_servers
WHERE ServerCategory <> 'DECOMMED'"
$cmd.ExecuteNonQuery()

$cmd2 = $conn.CreateCommand()
$cmd2.CommandText = "SELECT * FROM MyDB.dbo.tbl_ServerPingTest"
$da = New-Object System.Data.SqlClient.SqlDataAdapter #($cmd2)
$da.SelectCommand = $cmd2
$dt = New-Object System.Data.DataTable
$da.Fill($dt) | Out-Null

# Cycle through Server and Instances and retrieve information
Foreach($row in $dt.rows) 
{ 
    $ServerName = $row.ServerName
    $InstanceName = $row.InstanceName

    $pingStatus = Get-WmiObject -Query "Select * from win32_PingStatus where Address='$ServerName'" 

    $Uptime = $null 
    $SQLServerStatus = $null 
    $SQLAgentStatus = $null 

    # Enter the Loop if a Server is Pingable
    if($pingStatus.StatusCode -eq 0) 
    { 
        # Trap needed for server where Access is Denied causes the SQL Job to fail
        trap {continue}
        $OperatingSystem = Get-WmiObject Win32_OperatingSystem -ComputerName $ServerName -ErrorAction SilentlyContinue -ErrorVariable wmiResults
        $Uptime = GetUptime( $OperatingSystem.LastBootUpTime ) 

        if ($wmiResults -ne $null)
          {
            $tmperr = "Uptime Info Could Not be Obtained"
            $Uptime = $null
          }
        else
          {
            $tmperr = ""

            filter SvcFilter {
                if ($_.StartMode -eq "Disabled") {$_.StartMode }
                else {$_.State}
                }

            $props="Name","StartMode","State"

            if ($InstanceName -eq 'DEFAULT') 
                {
                    $SQLServerStatus = Get-WMIObject win32_service -property $props -filter "name='MSSQLSERVER'" -computer $ServerName | SvcFilter
                    $SQLAgentStatus = Get-WMIObject win32_service -property $props -filter "name='SQLSERVERAGENT'" -computer $ServerName | SvcFilter
                    $RSAgentStatus = Get-WMIObject win32_service -property $props -filter "name='ReportServer'" -computer $ServerName | SvcFilter
                }
                else
                {
                    $NamedInstanceSQLService = "MSSQL$" + $InstanceName
                    $NamedInstanceAgentService = "SQLAgent$" + $InstanceName
                    $NamedInstanceRSService = "ReportServer$" + $InstanceName
                    $SQLServerStatus = Get-WMIObject win32_service -property $props -computer $ServerName | where {$_.name -eq $NamedInstanceSQLService} | SvcFilter
                    $SQLAgentStatus = Get-WMIObject win32_service -property $props -computer $ServerName | where {$_.name -eq $NamedInstanceAgentService} | SvcFilter
                    $RSAgentStatus = Get-WMIObject win32_service -property $props -computer $ServerName | where {$_.name -eq $NamedInstanceRSService} | SvcFilter
                }

            $ASAgentStatus = Get-WMIObject win32_service -property $props -filter "name='MSSQLServerOLAPService'" -computer $ServerName | SvcFilter

          }
    } 

    $IPAddress = $pingStatus.IPV4Address
    $PingTest = GetStatusCode( $pingStatus.StatusCode ) 
    $ErrMSG = $tmperr

    # Update Table MyDB.dbo.tbl_ServerPingTest with all retreived information 
    $updateRow = $dt.Select("ServerName = '$ServerName' AND InstanceName = '$InstanceName'")
    $updateRow[0].IPAddress = $IPAddress
    $updateRow[0].PingTest = $PingTest
    $updateRow[0].ErrMSG = $ErrMSG
    $updateRow[0].Uptime = $Uptime
    $updateRow[0].SQLServerStatus = $SQLServerStatus
    $updateRow[0].SQLAgentStatus = $SQLAgentStatus   
    $updateRow[0].RSAgentStatus = $RSAgentStatus 
    $updateRow[0].ASAgentStatus = $ASAgentStatus 

    $cmdUpd = $conn.CreateCommand()
    $cmdUpd.CommandText = "UPDATE MyDB.dbo.tbl_ServerPingTest
    SET IPAddress = @IPAddress, PingTest = @PingTest, ErrMSG = @ErrMSG, Uptime = @Uptime, SQLServerStatus = @SQLServerStatus, SQLAgentStatus = @SQLAgentStatus, RSAgentStatus = @RSAgentStatus, ASAgentStatus = @ASAgentStatus
    WHERE ServerName = @ServerName AND InstanceName = @InstanceName"

    # Add parameters to pass values to the UPDATE statement
    $cmdUpd.Parameters.Add("@ServerName", "nvarchar", 50, "ServerName") | Out-Null
    $cmdUpd.Parameters["@ServerName"].SourceVersion = "Original"
    $cmdUpd.Parameters.Add("@InstanceName", "nvarchar", 50, "InstanceName") | Out-Null
    $cmdUpd.Parameters["@InstanceName"].SourceVersion = "Original"
    $cmdUpd.Parameters.Add("@IPAddress", "nvarchar", 50, "IPAddress") | Out-Null
    $cmdUpd.Parameters["@IPAddress"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@PingTest", "nvarchar", 50, "PingTest") | Out-Null
    $cmdUpd.Parameters["@PingTest"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@ErrMSG", "nvarchar", 50, "ErrMSG") | Out-Null
    $cmdUpd.Parameters["@ErrMSG"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@Uptime", "nvarchar", 50, "Uptime") | Out-Null
    $cmdUpd.Parameters["@Uptime"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@SQLServerStatus", "nvarchar", 50, "SQLServerStatus") | Out-Null
    $cmdUpd.Parameters["@SQLServerStatus"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@SQLAgentStatus", "nvarchar", 50, "SQLAgentStatus") | Out-Null
    $cmdUpd.Parameters["@SQLAgentStatus"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@RSAgentStatus", "nvarchar", 50, "RSAgentStatus") | Out-Null
    $cmdUpd.Parameters["@RSAgentStatus"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@ASAgentStatus", "nvarchar", 50, "ASAgentStatus") | Out-Null
    $cmdUpd.Parameters["@ASAgentStatus"].SourceVersion = "Current"

    # Set the UpdateCommand property
    $da.UpdateCommand = $cmdUpd

    # Update the database
    $RowsUpdated = $da.Update($dt)

} 

$conn.Close() 
```

我尝试将 -AsJob 参数添加到每个 Get-WMIObject 行

IE

```
$SQLServerStatus = Get-WMIObject win32_service -property $props -computer $ServerName | where {$_.name -eq $NamedInstanceSQLService} -AsJob | SvcFilter 
```

但我没有在代码中的任何地方使用 Receive-Job。我注意到每个变量都会返回“运行”状态，即使它是“停止”或“禁用”。所以我猜测作业的结果没有被正确捕获，实际上它正在返回以前的 Get-WMIObject 调用的输出（其中大部分将处于“运行”状态）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T06:05:09.683

如果您的 get-wmiObject[想要](http://connect.microsoft.com/PowerShell/feedback/details/645165/add-timeout-parameter-to-get-wmiobject)更[短的 timeout](https://stackoverflow.com/a/15054702/1751302)，那么[get-wmiCustom 函数](http://gallery.technet.microsoft.com/scriptcenter/7bae3d39-c6c3-4a8a-8c98-1b8851bd2cbe)可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T13:54:54.663

我设法通过使用 Start-Job 重新编写来做到这一点，并将其从 80 秒减少到 20 秒。如果有人对如何提高效率有任何进一步的建议，我将不胜感激。我正在考虑一口气而不是一个一个地检索所有 WMIObjects？谁能建议如何？

```
#Main Body
# Populate Table MyDB.dbo.tbl_ServerPingTest

$conn = New-Object System.Data.SqlClient.SqlConnection("Data Source=MyServer; Initial Catalog=MyDB; Integrated Security=SSPI")
$conn.Open()

$cmd = $conn.CreateCommand()
$cmd.CommandText ="DELETE FROM MyDB.dbo.tbl_ServerPingTest
INSERT INTO MyDB.dbo.tbl_ServerPingTest (ServerName, InstanceName)
SELECT ServerName, InstanceName FROM MyDB.dbo.tbl_servers
WHERE ServerCategory <> 'DECOMMED'"
$cmd.ExecuteNonQuery()

$cmd2 = $conn.CreateCommand()
$cmd2.CommandText = "SELECT * FROM MyDB.dbo.tbl_ServerPingTest"
$da = New-Object System.Data.SqlClient.SqlDataAdapter #($cmd2)
$da.SelectCommand = $cmd2
$dt = New-Object System.Data.DataTable
$da.Fill($dt) | Out-Null

# Create list
$serverlist = @()

$sb = {
    param ([string] $ServerName, [string] $InstanceName)

    # Return the Ping Status
    Function GetStatusCode 
    {  
        Param([int] $StatusCode)   
        switch($StatusCode) 
        { 
            0         {"Success"} 
            11001   {"Buffer Too Small"} 
            11002   {"Destination Net Unreachable"} 
            11003   {"Destination Host Unreachable"} 
            11004   {"Destination Protocol Unreachable"} 
            11005   {"Destination Port Unreachable"} 
            11006   {"No Resources"} 
            11007   {"Bad Option"} 
            11008   {"Hardware Error"} 
            11009   {"Packet Too Big"} 
            11010   {"Request Timed Out"} 
            11011   {"Bad Request"} 
            11012   {"Bad Route"} 
            11013   {"TimeToLive Expired Transit"} 
            11014   {"TimeToLive Expired Reassembly"} 
            11015   {"Parameter Problem"} 
            11016   {"Source Quench"} 
            11017   {"Option Too Big"} 
            11018   {"Bad Destination"} 
            11032   {"Negotiating IPSEC"} 
            11050   {"General Failure"} 
            default {"Failed"} 
        } 
    }

    # Format the Server Up-time
    Function GetUpTime 
    { 
        param([string] $LastBootTime) 
        $Uptime = (Get-Date) - [System.Management.ManagementDateTimeconverter]::ToDateTime($LastBootTime) 
        "Days: $($Uptime.Days); Hours: $($Uptime.Hours); Minutes: $($Uptime.Minutes); Seconds: $($Uptime.Seconds)"  
    } 

    try {

        # Fetch IP
        $pingStatus = Get-WmiObject -Query "Select * from win32_PingStatus where Address='$ServerName'"

        $Uptime = $null 
        $SQLServerStatus = $null 
        $SQLAgentStatus = $null 

        # Enter the Loop if a Server is Pingable
        if($pingStatus.StatusCode -eq 0) 
        { 
            # Trap needed for server where Access is Denied causes the SQL Job to fail
            trap {continue}
            $OperatingSystem = Get-WmiObject Win32_OperatingSystem -ComputerName $ServerName -ErrorAction SilentlyContinue -ErrorVariable wmiResults
            $Uptime = GetUptime( $OperatingSystem.LastBootUpTime ) 

            if ($wmiResults -ne $null)
              {
                $tmperr = "Uptime Info Could Not be Obtained"
                $Uptime = $null
              }
            else
              {
                $tmperr = ""

                filter SvcFilter {
                    if ($_.StartMode -eq "Disabled") {$_.StartMode }
                    else {$_.State}
                    }

                $props="Name","StartMode","State"

                if ($InstanceName -eq 'DEFAULT') 
                    {
                        #Write-Host $ServerName + '\' + $InstanceName 
                        $SQLServerStatus = Get-WMIObject win32_service -property $props -filter "name='MSSQLSERVER'" -computer $ServerName | SvcFilter
                        #Write-Host $SQLServerStatus
                        $SQLAgentStatus = Get-WMIObject win32_service -property $props -filter "name='SQLSERVERAGENT'" -computer $ServerName | SvcFilter
                        #Write-Host $SQLAgentStatus
                        $RSAgentStatus = Get-WMIObject win32_service -property $props -filter "name='ReportServer'" -computer $ServerName | SvcFilter
                        #Write-Host $RSAgentStatus
                    }
                    else
                    {
                        #Write-Host $ServerName + '\' + $InstanceName 
                        $NamedInstanceSQLService = "MSSQL$" + $InstanceName
                        $NamedInstanceAgentService = "SQLAgent$" + $InstanceName
                        $NamedInstanceRSService = "ReportServer$" + $InstanceName
                        $SQLServerStatus = Get-WMIObject win32_service -property $props -computer $ServerName | where {$_.name -eq $NamedInstanceSQLService} | SvcFilter
                        $SQLAgentStatus = Get-WMIObject win32_service -property $props -computer $ServerName | where {$_.name -eq $NamedInstanceAgentService} | SvcFilter
                        $RSAgentStatus = Get-WMIObject win32_service -property $props -computer $ServerName | where {$_.name -eq $NamedInstanceRSService} | SvcFilter
                    }

                $ASAgentStatus = Get-WMIObject win32_service -property $props -filter "name='MSSQLServerOLAPService'" -computer $ServerName | SvcFilter

              }
        } 

        $IPAddress = $pingStatus.IPV4Address
        $PingTest = GetStatusCode( $pingStatus.StatusCode ) 
        $ErrMSG = $tmperr

        # Save info about server
        $serverInfo = New-Object -TypeName PSObject -Property @{
        ServerName = $ServerName
        InstanceName = $InstanceName
        IPAddress = $IPAddress
        PingTest = $PingTest
        ErrMSG = $ErrMSG
        Uptime = $Uptime
        SQLServerStatus = $SQLServerStatus
        SQLAgentStatus = $SQLAgentStatus   
        RSAgentStatus = $RSAgentStatus 
        ASAgentStatus = $ASAgentStatus 

        }
        return $serverInfo
    } catch {
        throw 'Failed to process server named {0}. The error was "{1}".' -f $ServerName, $_
    }
}

# Loop servers
$max = 5
$jobs = @()
foreach($row in $dt.rows) {
    #$InstanceName = "DEFAULT"
    $server = $row.ServerName
    $InstanceName = $row.InstanceName
    $jobs += Start-Job -ScriptBlock $sb -ArgumentList @($server, $InstanceName) 
    $running = @($jobs | ? {$_.State -eq 'Running'})

    # Throttle jobs.
    while ($running.Count -ge $max) {
        $finished = Wait-Job -Job $jobs -Any
        $running = @($jobs | ? {$_.State -eq 'Running'})
    }
}

# Wait for remaining.
Wait-Job -Job $jobs > $null

# Check for failed jobs.
$failed = @($jobs | ? {$_.State -eq 'Failed'})
if ($failed.Count -gt 0) {
    $failed | % {
        $_.ChildJobs[0].JobStateInfo.Reason.Message
    }
}

# Collect job data.
$jobs | % {
    $serverlist += $_ | Receive-Job | Select-Object ServerName,InstanceName,IPAddress,PingTest,ErrMSG,Uptime,SQLServerStatus,SQLAgentStatus,RSAgentStatus,ASAgentStatus
}

#$serverlist

Foreach($row in $serverlist) 
{ 
    $ServerName = $row.ServerName
    $InstanceName = $row.InstanceName

    #$dt.Select("ServerName = '$ServerName' AND InstanceName = '$InstanceName'")

    $IPAddress = $row.IPAddress
    $PingTest = $row.PingTest
    $ErrMSG = $row.ErrMSG
    $Uptime = $row.Uptime
    $SQLServerStatus = $row.SQLServerStatus
    $SQLAgentStatus = $row.SQLAgentStatus   
    $RSAgentStatus = $row.RSAgentStatus 
    $ASAgentStatus = $row.ASAgentStatus 

   # Write-Host $ServerName
   # Write-Host $InstanceName

    $updateRow = $dt.Select("ServerName = '$ServerName' AND InstanceName = '$InstanceName'")
    $updateRow[0].IPAddress = $IPAddress
    $updateRow[0].PingTest = $PingTest
    $updateRow[0].ErrMSG = $ErrMSG
    $updateRow[0].Uptime = $Uptime
    $updateRow[0].SQLServerStatus = $SQLServerStatus
    $updateRow[0].SQLAgentStatus = $SQLAgentStatus   
    $updateRow[0].RSAgentStatus = $RSAgentStatus 
    $updateRow[0].ASAgentStatus = $ASAgentStatus 

    $cmdUpd = $conn.CreateCommand()
    $cmdUpd.CommandText = "UPDATE MyDB.dbo.tbl_ServerPingTest
    SET IPAddress = @IPAddress, PingTest = @PingTest, ErrMSG = @ErrMSG, Uptime = @Uptime, SQLServerStatus = @SQLServerStatus, SQLAgentStatus = @SQLAgentStatus, RSAgentStatus = @RSAgentStatus, ASAgentStatus = @ASAgentStatus
    WHERE ServerName = @ServerName AND InstanceName = @InstanceName"

    # Add parameters to pass values to the UPDATE statement
    $cmdUpd.Parameters.Add("@ServerName", "nvarchar", 50, "ServerName") | Out-Null
    $cmdUpd.Parameters["@ServerName"].SourceVersion = "Original"
    $cmdUpd.Parameters.Add("@InstanceName", "nvarchar", 50, "InstanceName") | Out-Null
    $cmdUpd.Parameters["@InstanceName"].SourceVersion = "Original"
    $cmdUpd.Parameters.Add("@IPAddress", "nvarchar", 50, "IPAddress") | Out-Null
    $cmdUpd.Parameters["@IPAddress"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@PingTest", "nvarchar", 50, "PingTest") | Out-Null
    $cmdUpd.Parameters["@PingTest"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@ErrMSG", "nvarchar", 50, "ErrMSG") | Out-Null
    $cmdUpd.Parameters["@ErrMSG"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@Uptime", "nvarchar", 50, "Uptime") | Out-Null
    $cmdUpd.Parameters["@Uptime"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@SQLServerStatus", "nvarchar", 50, "SQLServerStatus") | Out-Null
    $cmdUpd.Parameters["@SQLServerStatus"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@SQLAgentStatus", "nvarchar", 50, "SQLAgentStatus") | Out-Null
    $cmdUpd.Parameters["@SQLAgentStatus"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@RSAgentStatus", "nvarchar", 50, "RSAgentStatus") | Out-Null
    $cmdUpd.Parameters["@RSAgentStatus"].SourceVersion = "Current"
    $cmdUpd.Parameters.Add("@ASAgentStatus", "nvarchar", 50, "ASAgentStatus") | Out-Null
    $cmdUpd.Parameters["@ASAgentStatus"].SourceVersion = "Current"

    # Set the UpdateCommand property
    $da.UpdateCommand = $cmdUpd

    # Update the database
    $RowsUpdated = $da.Update($dt)

}

$conn.Close() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:53:31.857

`get-wmiobject`有一个`-asjob`参数，但`where-object`没有。

此外，当您使用 -asjob 时，返回值是一个“作业对象”，而不是由 get-wmiobject 调用返回的对象。

一旦在远程服务器上完成，您可以使用`receive-job`cmdlet 从每个作业中取回实际对象（您可以使用`wait-job`and`get-job`来帮助了解它何时完成）。

我建议你做`get-help about_Remote_Jobs`一些关于如何构建代码的背景知识。

# c# - 获取 XmlSerializer 以忽略基类上的属性

> ID：16194093
> 
> 赞同：1
> 
> 时间：2013-04-24T14:04:52.213
> 
> 标签：c#, .net, xml, serialization

我有一个`MyBasicHttpBinding`继承自`BasicHttpBinding`它的类 () 又实现了`HttpBindingBase`.

`HttpBindingBase`有一个属性 ProxyAddress。

我想序列化`MyBasicHttpBinding`，但我想忽略`HttpBindingBase.ProxyAddress`.

我有一个方法`MyBasicHttpBinding`叫做`ToXml()`它的实现看起来像这样：

```
public string ToXml()
{
    var overrides = new XmlAttributeOverrides();
    overrides.Add(this.GetType(), "ProxyAddress", new XmlAttributes { XmlIgnore = true });

    var serializer = new XmlSerializer(this.GetType(), overrides);
    var builder = new StringBuilder();
    var writer = new StringWriter(builder);

    serializer.Serialize(writer, this);
    return builder.ToString();
} 
```

我已经尝试`System.ServiceModel.BasicHttpBinding`过添加覆盖位，但也没有用。

我也尝试过添加：

```
[XmlIgnore]
public bool ProxyAddressSpecified = false; 
```

To`MyBasicHttpBinding`和一个`ShouldSerializeProxyAddress()`方法。

这些都没有停止`XmlSerializer`尝试序列化`HttpBindingBase.ProxyAddress`.

所以基本上我不想`HttpBindingBase.ProxyAddress`序列化，但无法弄清楚如何。

# java - Android java解析JSON问题

> ID：16194096
> 
> 赞同：0
> 
> 时间：2013-04-24T14:04:58.690
> 
> 标签：java, android, json

我过去解析过一些简单的 json，但这个给我带来了更多麻烦。我正在尝试从维基百科的“历史上的这一天”中获取数据

[带有 JSON 输出的示例 URL](http://en.wikipedia.org/w/api.php?format=json&action=query&titles=September_17&rvprop=content&prop=revisions)

[常规 HTML 中的实际 URL](http://en.wikipedia.org/wiki/September_17)

现在，如果您将 JSON URL 弹出到：http: [//jsonlint.com/](http://jsonlint.com/)以获取细分，我遇到的第一个麻烦是在这种情况下的页面之后的对象之后，“27993”总是不同的，所以我该如何获取这个如果我不知道名字？

到目前为止，出于测试目的，我有这段代码：

```
JSONObject json = new JSONObject(result);  
input.close();  
JSONObject json2 = new JSONObject(json.getString("query").toString()); 
JSONObject json3 = new JSONObject(json2.getString("pages").toString()); 
JSONObject json4 = new JSONObject(json3.getString("27993").toString()); 
JSONArray contacts = json4.getJSONArray("revisions");
StringBuilder builder = new StringBuilder();
builder.append(contacts.getString(0));    
return builder.toString(); 
```

这将返回修订数组中的所有内容，这将导致我的下一个问题......是否有一种简单的方法来解析该输出？

**编辑：解决问题＃1的修订代码现在关于解析该输出？**

```
 JSONObject json = new JSONObject(result);  
            input.close();  
            JSONObject json2 = new JSONObject(json.getString("query").toString()); 
            JSONObject json3 = new JSONObject(json2.getString("pages").toString()); 
            Iterator i = json3.keys();
            JSONObject j = null;
            while (i.hasNext()) {
                try {
                    String key = i.next().toString();
                    j = json3.getJSONObject(key);
                } catch (JSONException e) {
                    e.printStackTrace();
                }
            }
            JSONArray contacts = j.getJSONArray("revisions");
            StringBuilder builder = new StringBuilder();
            builder.append(contacts.getString(0));    
            return builder.toString(); 
```

**问题的第二部分是解析此类输出的简单解决方案。这是一个片段：**

> ":"{{pp-move-indef}}{{九月日历|float=right}}\n{{ThisDateInRecentYears}}\n{{Day}}\n\n==Events==\n* [[ 456]] – [[Remistus]]，罗马将军 (''[[magister militum]]'')，在 [[Ravenna]] 拥有 [[Goths|Gothic]] 部队 [[Siege|besiege]]d后来在城外的“in Classis”宫中被处决。\n*[[1111]] – 由 [[Pedro Fr\u00f3ilaz de Traba]] 和主教 [[Diego Gelm\u00edrez]] 领导的加利西亚最高贵族 [[Alfonso VII of Le\u00f3n and Castile|Alfonso VII] ] as \"[[加利西亚王国|加利西亚国王]]\"。\n*[[1176]] – [[Myriokephalon 之战]] 进行了。\n*[[1462]] – [[ \u015awiecino]] 战役（也称为 \u017barnowiec 战役）在 [[十三年战争 (1454\u201366)|十三年战争]] 期间进行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:11:07.763

```
JSONObject pages = new JSONObject(json.getJSONObject("pages"));

// Use this to get IDs
Iterator<String> keys = pages.keys();

// Then iterate
while (keys.hasNext()) {
  JSONObject page = new JSONObject(pages.get(keys.next()));
  // Do something with the page
} 
```

# jquery - jquery用函数不工作的结果填充输入

> ID：16194099
> 
> 赞同：0
> 
> 时间：2013-04-24T14:05:08.963
> 
> 标签：jquery

我有以下 jquery 语法：

```
 $.post('get_sku_prices', {data:product1.value},function(result) 
 { 
 var counter=1
 $('input[id=price1]').val(result);
 $('input[id=adjustedprice1]').val(result);
 alert(result);
 counter++; 
 }); 
```

这显然调用`get_sku_prices`了返回结果的函数（在本例中为 108）。但是`alert(result)`会显示`108`将两行插入`108`到两个输入中`price1`并且`adjusted1`不起作用？

这有什么问题？

```
 $('input[id=price1]').val(result);
 $('input[id=adjustedprice1]').val(result); 
```

我的问题的第二部分是我想让输入名称动态化。所以我的表单上有多个输入，price1,price2,price3,price4 等，因此我想让数字动态化。

我对循环没有任何问题，这可以正常工作，但是如何使输入动态填充。所以按照我的例子：

```
$('input[id=price1]').val(result);
$('input[id=price2]').val(result);
$('input[id=price3]').val(result);
$('input[id=price4]').val(result); 
```

是不是很简单：

```
$('input[id=price+counter]').val(result); 
```

在此先感谢，感谢您的时间和精力。

**更新**

问题的第一部分现在正在工作，感谢人们:-)

我现在正试图让语法的动态部分正常工作。注释行确实有效。如果我现在想将其更改为动态，则它不起作用。我相信问题出在柜台上。

查看下面的语法，警报会像您期望的那样重复并出现 1、2、3、4 等。

```
alert(countertwo);
 $.post('get_sku_prices', {data:product1.value},function(result) 
 { 
 //$('#price1').val(result);
 $('#adjustedprice'+counter).val(result);
 //$('#adjustedprice1').val(result);
 $('#price'+counter).val(result);
 }); 
```

如果我将语法更改为：

```
 $.post('get_sku_prices', {data:product1.value},function(result) 
 { 
    alert(countertwo);
 //$('#price1').val(result);
 $('#adjustedprice'+counter).val(result);
 //$('#adjustedprice1').val(result);
 $('#price'+counter).val(result);
 }); 
```

警报现在在每个警报上显示“20”（20 次）。20 是行数。所以在 $.post 函数中警报不起作用？

关于为什么不以及如何解决这个问题的任何想法？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:09:52.793

这段代码怎么样（你也错过了计数器声明后的分号）：

```
$.post('get_sku_prices', {data:product1.value},function(result) 
 { 
 var counter=1;
 $('#price1').val(result);
 $('#adjustedprice1').val(result);
 alert(result);
 counter++; 
 }); 
```

关于你的第二个问题，如果你想用相同的值填充所有输入，最简单的方法是给它一个类

```
<input type="text" id="price1" class="inputprice" />
<input type="text" id="price2" class="inputprice" />
<input type="text" id="price3" class="inputprice" /> 
```

然后在您的脚本中，您将定位所有具有类 inputprice 的元素，并更改值：

```
$('.inputprice').val(result); 
```

# knockout.js - ko.mapping 创建函数仅在分层视图模型中适用于“儿童”的顶级数组

> ID：16194107
> 
> 赞同：0
> 
> 时间：2013-04-24T14:05:24.200
> 
> 标签：knockout.js, mapping

我正在尝试使用 ko.mapping 插件创建函数将计算的 observable 添加到分层视图模型中。但该函数仅适用于顶级“子”数组！代码如下：

```
Children:[{
    Name: "Page 1",
    Children: [ {
        Name: "Page 1 > 1",
        Children: [{
        Name: "Page 1 > 1 > 1",
        Children: []
    }
,{
        Name: "Page 1 > 1 > 2",
        Children: []
    }
]
    }
    ]
},
{
    Name: "Page 2",
    Children: [
    {
        Name: "Page 16",
        Children: []
    }
    ]
},
{
    Name: "Page 3",
    Children: [
    {
        Name: "aaaaa",
        Children: []
    }
] 
```

我的功能如下

```
 var computed = function (data) {
                                var self = this;
                                ko.mapping.fromJS(data, {}, self);
                                self.Uri = ko.computed(function () {
                                    console.log(self.Name());
                                    return self.Name() + " Something";
                                });
                            };

     var mapping = {
                    'Children': {
                        create: function (o) {
                            return new computed(o.data);

                        }
                    }
                };

ko.mapping.fromJS(data, mapping, vm); 
```

有没有办法让“计算”函数在所有“子”数组上运行？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:38:35.130

您也应该为孩子提供映射选项。尝试更新`computed`功能如下：

```
 var computed = function (data) {
                            var self = this;
                            ko.mapping.fromJS(data, mapping, self);
                            self.Uri = ko.computed(function () {
                                console.log(self.Name());
                                return self.Name() + " Something";
                            });
                        }; 
```

# php - 在 php 中使用 strlen 进行表单验证

> ID：16194112
> 
> 赞同：0
> 
> 时间：2013-04-24T14:05:31.467
> 
> 标签：php, string, validation, strlen

我有以下验证：

```
 if (empty($errors) === true) { 
        if (strlen($_POST['Description']) > 250) { //strlen counts the number of bytes
            $errors[] = 'Your description must be less than 250 characters long';
        }
    } 
```

但如果用户输入的描述超过 30 个字符，则始终会显示此错误。我读过 strlen 返回字节数而不是字符串中的字符数。我试过 mb_strlen 来获取字符长度，但这也不起作用。我觉得我在做一些明显愚蠢的事情，如果可以，请提供帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:13:08.420

老实说，我不知道任何使用 8 个字节作为字符的编码。

我认为您的 "$_POST['Description']" 可能不仅仅包含您想要的数据。

做一个

```
 var_dump($_POST['Description']) 
```

看看它显示了什么。

旁注：

```
if (strlen(trim($_POST['Description'])) > 250) 
```

防止空格导致验证失败。

另请注意，您必须为 mb_strlen 指定编码，因为发送的字符编码可能与内部编码不同。

# rest - Xpage REST服务控制和服务bean

> ID：16194114
> 
> 赞同：1
> 
> 时间：2013-04-24T14:05:36.670
> 
> 标签：rest, xpages, xpages-extlib

我正在尝试使用 XPage REST 服务控制来实现 REST 服务。我选择了“customRESTService”。

我想在请求此服务时发出 JSON。我可以在服务器端 Java Script 中编写逻辑。

但我注意到这个 customRESTService 也支持“serviceBean”，这意味着我可以用纯 JAVA 编写整个逻辑。

我给出了下面的 bean 代码。我也在 faces-config.xml 中声明了它。但它在渲染时抛出异常。有没有人在 customRESTService 中使用过“serviceBean”？

我很感激任何帮助！谢谢！！

```
public class GetApproverJSON{
public GetApproverJSON(){
    System.out.println("Instantiating Bean");
}   

public String doGet() throws NotesException{

    JSONObject mainObj  = new JSONObject();;
    JSONObject itemObj;

    try{
        mainObj.put("label", "name");
        mainObj.put("identifier", "abbr");

        itemObj = new JSONObject();
        itemObj.put("name", "");
        itemObj.put("abbr", "");

        mainObj.accumulate("items", itemObj);

        return mainObj.toString();
    }catch(Exception e){
        System.out.println("Exception occured while generating JSON ");
        e.printStackTrace();
        return mainObj.toString();
    }finally{

    }
} 
```

错误 ：

```
com.ibm.domino.services.ServiceException: Error while rendering service
at com.ibm.xsp.extlib.component.rest.CustomService$ScriptServiceEngine.renderService(CustomService.java:304)
at com.ibm.domino.services.HttpServiceEngine.processRequest(HttpServiceEngine.java:167)
at com.ibm.xsp.extlib.component.rest.UIBaseRestService._processAjaxRequest(UIBaseRestService.java:252)
at com.ibm.xsp.extlib.component.rest.UIBaseRestService.processAjaxRequest(UIBaseRestService.java:229)
at com.ibm.xsp.util.AjaxUtilEx.renderAjaxPartialLifecycle(AjaxUtilEx.java:206)
at com.ibm.xsp.webapp.FacesServletEx.renderAjaxPartial(FacesServletEx.java:221)
at com.ibm.xsp.webapp.FacesServletEx.serviceView(FacesServletEx.java:166)
at com.ibm.xsp.webapp.FacesServlet.service(FacesServlet.java:160)
at com.ibm.xsp.webapp.FacesServletEx.service(FacesServletEx.java:137)
at com.ibm.xsp.webapp.DesignerFacesServlet.service(DesignerFacesServlet.java:103)
at com.ibm.designer.runtime.domino.adapter.ComponentModule.invokeServlet(ComponentModule.java:576)
at com.ibm.domino.xsp.module.nsf.NSFComponentModule.invokeServlet(NSFComponentModule.java:1267)
at com.ibm.designer.runtime.domino.adapter.ComponentModule$AdapterInvoker.invokeServlet(ComponentModule.java:847)
at com.ibm.designer.runtime.domino.adapter.ComponentModule$ServletInvoker.doService(ComponentModule.java:796)
at com.ibm.designer.runtime.domino.adapter.ComponentModule.doService(ComponentModule.java:565)
at com.ibm.domino.xsp.module.nsf.NSFComponentModule.doService(NSFComponentModule.java:1251)
at com.ibm.domino.xsp.module.nsf.NSFService.doServiceInternal(NSFService.java:598)
at com.ibm.domino.xsp.module.nsf.NSFService.doService(NSFService.java:421)
at com.ibm.designer.runtime.domino.adapter.LCDEnvironment.doService(LCDEnvironment.java:341)
at com.ibm.designer.runtime.domino.adapter.LCDEnvironment.service(LCDEnvironment.java:297)
at com.ibm.domino.xsp.bridge.http.engine.XspCmdManager.service(XspCmdManager.java:272)
      Caused by: com.ibm.xsp.FacesExceptionEx: Bean getApproverJSON is not a CustomServiceBean
at com.ibm.xsp.extlib.component.rest.CustomService.findBeanInstance(CustomService.java:226)
at com.ibm.xsp.extlib.component.rest.CustomService$ScriptServiceEngine.renderService(CustomService.java:255)
... 20 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T01:57:47.953

您需要将代码更改为：

```
public class GetApproverJSON{ ...} 
```

至：

```
public class GetApproverJSON extends CustomServiceBean { 

   @Override
   public void renderService(CustomService service, RestServiceEngine engine) throws ServiceException {
        HttpServletRequest request = engine.getHttpRequest();
        HttpServletResponse response = engine.getHttpResponse();

        response.setHeader("Content-Type", "application/json; charset=UTF-8");

        // Here goes your code, get the response writer or stream

    } 
```

因为这是 REST 服务所期望的接口。您将只需要实现`renderService`. 您可以从请求对象中获取方法（GET、POST 等）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:21:55.363

我以前从未使用过服务 bean，我通常使用与您的非常相似的静态 doGet 方法创建自己的解析器，并在自定义 REST 服务的 doGet 属性中调用我创建的静态 doGet 方法。但我认为（我可能错了）如果您使用服务 bean，它必须是一个完整的 servlet，就像您编写自己的实际 REST 服务一样，而不仅仅是解析器部分。

我创建了很多解析器，并发现了一个映射列表：

列表>

通常是构建初始数据的最佳方法。然后我遍历列表以构建我的 JSON。在扩展库中有一个名为 JsonWriter 的类，它使构建 JSON 对象变得非常容易。使用 JsonWriter 像：

```
StringWriter sw = new StringWriter();
JsonWriter jw = new JsonWriter(sw);
jw.startObject();
jw.startProperty("SomeProperty");
jw.outStringLiteral("SomeValue");
jw.endProperty();
jw.endObject();
return sw.toString(); 
```

有关完整示例，您可以查看[我为 JQuery FullCalendar 演示构建的 REST 服务](https://bitbucket.org/kstrickland/keithstric.com-demos/src/bed7e734e556/JQueryFullCalendar/Code/Java/com/keithstric/demo/rest/EventParser.java?at=master)。虽然这些方法都不是静态的（我需要跟踪几个属性），但您应该了解基本概念。但是启动整个过程的是对 writeJson() 方法的调用。[这是在此自定义控件](https://bitbucket.org/kstrickland/keithstric.com-demos/src/bed7e734e556/JQueryFullCalendar/CustomControls/ccRestCalendar.xsp?at=master)中调用的。

这些示例应该让您继续构建自己的自定义 JSON 解析器并将该 JSON 发送回您的应用程序。

# wordpress - 在 Wordpress 中创建漂亮的个人资料

> ID：16194116
> 
> 赞同：0
> 
> 时间：2013-04-24T14:05:37.933
> 
> 标签：wordpress, mod-rewrite

我已经使用 wordpress 有一段时间了，但直到现在我从未尝试过的一个方面是重写规则。我可以通过使用模板并通过 GET 获取用户 ID 来创建个人资料页面，但我想做一些更好的事情。

也就是说，我想将 URL 重写为[http://www.example.com/profiles/username](http://www.example.com/profiles/username)

这应该适用于所有选择的主题。我认为这就是 Buddypress 的做法。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:16:13.160

要更改作者库，请将以下内容添加到您的`functions.php`文件中：

```
add_action( 'init', 'so16194116_new_author_base' );
function so16194116_new_author_base()
{
    global $wp_rewrite;
    $author_slug = 'profiles';
    $wp_rewrite->author_base = $author_slug;
} 
```

实施后访问永久链接管理页面，刷新重写规则。

# sql - 当空间存在或不存在时搜索邮政编码

> ID：16194117
> 
> 赞同：1
> 
> 时间：2013-04-24T14:05:38.343
> 
> 标签：sql

我正在运行一个 sql 搜索查询来显示与邮政编码匹配的记录，比如我有一个邮政编码：

'CB4 1AB'

如果数据库有（有和没有空格）

*   cb41ab
*   CB4 1AB

或者我搜索（有和没有空格）

*   cb41ab
*   CB4 1AB

我希望它带回记录

我该怎么做？

```
select addr1, addr2, postcode 
from addresses p
where p.postcode LIKE 'cb%' 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:13:25.163

所以，听起来你正在为此而努力。扩展其他答案：

```
DECLARE @input VARCHAR(50)
SET @input = 'CB4 1AB'

SELECT addr1, addr2, postcode
FROM addresses p
WHERE REPLACE(p.postcode, ' ', '') = REPLACE(@input, ' ', '') 
```

编辑：我删除了“LIKE”，因为这应该涵盖上述所有情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:10:23.023

你可以尝试这样的事情：

```
select addr1, addr2, postcode 
from addresses p
where replace(p.postcode, ' ', '') LIKE 'cb41ab' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T14:22:55.057

我不清楚这个问题，所以我有多个答案：
a）如果您要查找特定的英国邮政编码，请这样做：LIKE 'cb4%1ab'。两个版本都将返回（“间隔”和 wo.space 的）。
b）如果您使用 LIKE 'cb%' 也不会带来任何麻烦。字段将返回它有或没有空格的值。
c）如果您想查找邮政编码，*特别是有*或*没有*空格，请说 LIKE 'cb4_1%' 用于有空格的邮政编码，而 LIKE 'cb41%' 用于没有空格的邮政编码 - 甚至更好地寻找字段大小（6 个字符长或 7 个）所以 LENGTH([fieldname]) = 6 [或 7]
d) 用户输入邮政编码，但您不知道 value 中是否有空格：我想说需要修改代码，不应该在 SQL/Server 端进行整理。如果不可能，其他人添加的 REPLACE 就可以了。如果在您的情况下“d”和“a”都为真，请使用 REPLACE 将空间更改为“%”，因此无论输入是什么以及存储在 db 中的内容（字段值有或没有空格），您都会得到结果

最后但同样重要的是，只是一个建议：如果您有机会“统一”字段的值，请执行此操作（将字段最大长度设置为 6 和/或更新表格并从值中删除空间）

希望这会有所帮助！

[编辑：添加了“d”选项:)]

# c++ - 路径中的 Autoconf 空格

> ID：16194124
> 
> 赞同：1
> 
> 时间：2013-04-24T14:06:01.413
> 
> 标签：c++, autotools, autoconf

[我刚刚将一个 c++ 项目转换为一个 autotools 项目，并从这里开始](http://www.nondot.org/sabre/Mirrored/autoconf-2.12/autoconf_2.html)在 configure.ac 中写了几行。当我的路径应该是“bla bla”时，构建失败说“sh：/home/me/bla：没有这样的文件或目录”。问题是我没有在任何地方写任何路径。我该怎么办？除了重命名路径... 哇！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T21:04:39.603

抱歉，只有几件事是您无法使用 autoconf 完成的，并且名称中带有空格的路径就是其中之一。

# r - 对 data.frames 列表进行排序

> ID：16194127
> 
> 赞同：2
> 
> 时间：2013-04-24T14:06:09.837
> 
> 标签：r

我有一个看起来像这样的大文件：

> ```
>  Col1_names     Col1_values      Col2_names      Col2_values
>       a               0.2              b               0.12
>       c               0.12             m               0.2
>       d               0.5              n               0.21
>       g               0.3              w               0.1
>       p               0.1              y               0.3
>       h               0.32             z               0.01 
> ```

我需要对下面的 data.frame 进行排序，使其看起来像这样：

> ```
>  Col1_names      Col1_values     Col2_names        Col2_values
>        p              0.1              z                 0.01
>        c              0.12             w                 0.1                
>        a              0.2              b                 0.12                     
>        g              0.3              m                 0.2             
>        h              0.32             n                 0.21              
>        d              0.5              y                 0.3 
> ```

换句话说，我需要按升序对包含值（“Col1_values”）的每一列进行排序。我是 R 的新手，所以对我来说似乎太难了。

在实际情况下，data.frame 包含大约 200 个列表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:41:33.807

这些方面的东西应该这样做

```
txt <- "Col1_names     Col1_values      Col2_names      Col2_values
          a               0.20             b               0.12
          c               0.12             m               0.2
          d               0.5              n               0.21
          g               0.30             w               0.10
          p               0.1              y               0.30
          h               0.32             z               0.01"

dat <- read.table(text = txt, header = TRUE)
dat[order(dat$Col1_values), ]

##   Col1_names Col1_values Col2_names Col2_values
## 5          p        0.10          y        0.30
## 2          c        0.12          m        0.20
## 1          a        0.20          b        0.12
## 4          g        0.30          w        0.10
## 6          h        0.32          z        0.01
## 3          d        0.50          n        0.21 
```

# asp.net - 使用信号器将消息广播到特定页面

> ID：16194131
> 
> 赞同：1
> 
> 时间：2013-04-24T14:06:23.407
> 
> 标签：asp.net, signalr

假设我有论坛，人们发布他们的问题，其他人发布答案。比如说人 A 发布一个问题“什么是信号器？” 并站在那一页。其他人也打开该页面进行回答。如果其他人发布任何答案，那么我希望该答案将显示在其他用户打开的页面中。假设五个用户打开该页面并且其中一个回答然后五个用户将看到该答案。

通常，当我们想向所有人广播任何消息时，我们会使用类似于服务器端的语法

```
Clients.All.broadcastMessage(name, message); 
```

所以根据我上面的情况我需要使用什么样的语法？

这是我为广播消息类型找到的一些指南，如下所示

```
// Call send on everyone
        Clients.All.send(message);

        // Call send on everyone except the caller
        Clients.Others.send(message);

        // Call send on everyone except the specified connection ids
        Clients.AllExcept(Context.ConnectionId).send(message);

        // Call send on the caller
        Clients.Caller.send(message);

        // Call send on everyone in group "foo"
        Clients.Group("foo").send(message);

        // Call send on everyone else but the caller in group "foo"
        Clients.OthersInGroup("foo").send(message);

        // Call send on everyone in "foo" excluding the specified connection ids
        Clients.Group("foo", Context.ConnectionId).send(message);

        // Call send on to a specific connection
        Clients.Client(Context.ConnectionId).send(message); 
```

我需要使用哪一个？请解释&谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T15:32:43.913

您可以在具有问题 id 的页面上有一个 div。所以你会有类似的东西：

```
<div id="theAskedQuestionId"><!-- the answer will be inserted here--></div> 
```

例如：

```
<div id="12345"><!-- the answer will be inserted here--></div> 
```

然后你可以使用 jquery 将答案注入到 div 中。这方面的一个例子是：

```
var messagePublisher = $.connection.yourHubName;

messagePublisher.client.broadcastMessage = function(divId, message){
$(divId).html(message); //note: divId will be something like #12345
}; 
```

这将允许您仅向正在查看特定问题的用户显示消息，而不是向查看任何问题的用户广播消息。我想这就是你寻求帮助的原因。

# connection-string - 在运行时更改成员资格提供者的连接字符串？

> ID：16194132
> 
> 赞同：0
> 
> 时间：2013-04-24T14:06:25.433
> 
> 标签：connection-string, membership

我在网上找到了这段代码

```
Imports System
Imports System.Collections.Specialized 

Namespace Williablog.Net.Examples.Providers

    Public Class SqlMembershipProvider
        Inherits System.Web.Security.SqlMembershipProvider
        Public Overrides Sub Initialize(ByVal name As String, ByVal config As System.Collections.Specialized.NameValueCollection)
            ' intercept the setting of the connection string so that we can set it ourselves...
            Dim specifiedConnectionString As String = config.Item("connectionStringName")
            config.Item("connectionStringName") = GetYourRunTimeConnectionStringNAme(specifiedConnectionString)
             ' Pass doctored config to base classes
            MyBase.Initialize(name, config)
        End Sub

    End Class
End Namespace 
```

我认为它会解决我的问题。

1.  我需要在 web.config 中加密我的连接字符串
2.  我正在使用 MS 默认会员提供程序
3.  登录机制“Membership.ValidateUser(UsernameTextbox.Text, passwordtext)) 不允许我更改连接字符串，它使用 web.config 中的连接字符串。
4.  我可以使用上面的代码来更改连接字符串，以便在验证用户运行之前先解密它吗？
5.  如果是，我如何在我的代码中使用上面的代码？

# c# - 如何使控制器中的缓存数据 [OutputCache] 无效？

> ID：16194140
> 
> 赞同：40
> 
> 时间：2013-04-24T14:06:49.143
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, caching

使用 ASP.Net MVC 3 我有一个控制器，它的输出正在使用属性进行缓存`[OutputCache]`

```
[OutputCache]
public controllerA(){} 
```

我想知道是否可以通过调用另一个控制器来使特定控制器的缓存数据（服务器缓存）或所有缓存数据无效

```
public controllerB(){} // Calling this invalidates the cache 
```

* * *

## 回答 #1

> 赞同：61
> 
> 时间：2013-04-25T06:08:58.703

您可以使用该[`RemoveOutputCacheItem`](http://msdn.microsoft.com/en-us/library/cc681136.aspx)方法。

这是一个如何使用它的示例：

```
public class HomeController : Controller
{
    [OutputCache(Duration = 60, Location = OutputCacheLocation.Server)]
    public ActionResult Index()
    {
        return Content(DateTime.Now.ToLongTimeString());
    }

    public ActionResult InvalidateCacheForIndexAction()
    {
        string path = Url.Action("index");
        Response.RemoveOutputCacheItem(path);
        return Content("cache invalidated, you could now go back to the index action");
    }
} 
```

索引操作响应在服务器上缓存 1 分钟。如果您点击该`InvalidateCacheForIndexAction`操作，它将使索引操作的缓存过期。目前没有办法使整个缓存失效，您应该按缓存的操作（而不是控制器）执行此操作，因为该`RemoveOutputCacheItem`方法需要它缓存的服务器端脚本的 url。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:10:11.343

您可以通过使用自定义属性来做到这一点，如下所示：

```
[AttributeUsage(AttributeTargets.Class | AttributeTargets.Method)]
public sealed class NoCacheAttribute : ActionFilterAttribute
{
    public override void OnResultExecuting(ResultExecutingContext filterContext)
    {
        filterContext.HttpContext.Response.Cache.SetExpires(DateTime.UtcNow.AddDays(-1));
        filterContext.HttpContext.Response.Cache.SetValidUntilExpires(false);
        filterContext.HttpContext.Response.Cache.SetRevalidation(HttpCacheRevalidation.AllCaches);
        filterContext.HttpContext.Response.Cache.SetCacheability(HttpCacheability.NoCache);
        filterContext.HttpContext.Response.Cache.SetNoStore();

        base.OnResultExecuting(filterContext);
    }
} 
```

然后在你的`controllerb`你可以做：

```
[NoCache]
public class controllerB
{
} 
```

# javascript - 水平重叠两个 DIVS

> ID：16194141
> 
> 赞同：2
> 
> 时间：2013-04-24T14:06:49.987
> 
> 标签：javascript, jquery, html

嗨，我在一个表格单元格中有两个 div（制作一个时间轴），我需要它们重叠而不是相互重叠。

单元格内所有 DIV 的位置属性必须保持不变（因为我使用了拖放 JQUERY 插件）

[链接到小提琴](http://jsfiddle.net/ianfc89/4DW6y/2/)

[链接到更新的小提琴](http://jsfiddle.net/ianfc89/JDff9/11/)

```
 <tr style="border:1px; height:30px;">
        <td style="border:1px solid black; position:static">
            <div  style="margin-left:0;width:50px;display:inline;position:relative">
                <div style="background-color: green; position:absolute">
                    Div1
                </div>
            </div>
            <div style="margin-left:0px;width:20px;display: inline; position:relative">
                <div style="background-color: red; position:absolute">
                Div2
                </div>
            </div>
        </td>
        <td>
        </td>
    </tr> 
```

我需要两个 DIV 从单元格的边缘开始相对。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:15:24.363

据我所知，您只需将红色`<div>`向下推一点。而且由于您已将其绝对定位，因此很容易通过以下方式完成`top`：

```
<div style="background-color: red; position:absolute; top:10px;"> 
```

在您的 jsFiddle 上检查[此更新](http://jsfiddle.net/4DW6y/7/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:47:43.123

它们将像这样堆叠，您还应该能够浮动 div 并明确设置 z-index 以堆叠它们。

[http://jsfiddle.net/ianfc89/JDff9/13/](http://jsfiddle.net/ianfc89/JDff9/13/)

HTML

```
<body onload="REDIPS.drag.init()">
<script>
    REDIPS.drag.dropMode = 'multiple';
</script>
<div id="drag" class="containDiv">
    <table class="tableWhole">
        <tbody>
            <tr>
                <td class="tableCell">
                    <div style="position:relative">
                    <div id="A125_Contain" class="drag progressContainer" >
                        <div id="A125" style="cursor: move; background-color: red; width: 500px; height: 20px; ">A125</div>
                    </div>
                    <div id="B125_Contain" class="drag progressContainer" >
                        <div id="B125" style="cursor: move; background-color: green; width: 100px; height: 20px;  ">A125</div>
                    </div>
                        <div>
                </td>
                <td class="tableCell"></td>
                <td class="tableCell"></td>
                <td class="tableCell"></td>
                <td class="tableCell"></td>
                <td class="tableCell"></td>
            </tr>
            <tbody>
    </table>
</div> 
```

风格

```
.containDiv {
}
.tableWhole {
    width:1000px;
    table-layout:fixed;
}
.tableCell {
    width:300px;
    height:60px;
    border:1px solid black;
}

.progressContainer
{
 display:inline; border-bottom-style: none; position: relative; top: 0px; left:              0px; width: 100px; height: 20px;
} 
```

# jsp - 如何在 Eclipse 的 jsp 页面中摆脱“javax.servlet.jsp.PageContext 无法解析为类型”？

> ID：16194143
> 
> 赞同：4
> 
> 时间：2013-04-24T14:06:52.227
> 
> 标签：jsp, eclipse-juno, m2e, m2e-wtp

我在 Eclipse 的 .jsp 页面中有这个奇怪的错误：

```
javax.servlet.jsp.PageContext cannot be resolved to a type 
```

我的项目是一个**Maven 项目，** **“作为现有的 Maven 项目”**导入到**Juno**中，并安装了**m2e**和**m2e-wtp**插件。

 ****这是 m2e 插件的错误吗？如果是，有什么可能的解决方法来消除此错误（以及工作区资源管理器中的红色标记）？

否则，我是否需要“告诉”maven 我的项目包含 jsp 页面？希望 m2e 插件能够将正确的库添加到类路径中。如果是，如何？

![在此处输入图像描述](https://i.stack.imgur.com/lgVEx.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2014-08-28T04:04:11.100

对我有用的解决方案在[这个答案](https://stackoverflow.com/a/15782094/453673)中给出。转到项目属性 > 目标运行时 > 选择运行时的复选框（在我的例子中是 Apache Tomcat 7）。
就这样。现在就构建项目，一切都会好起来的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T17:24:07.680

升级到 Kepler 并更新所有插件后，问题消失了。这可能是一个错误。****

# windows - 在 Python 3 中使用“文件路径”导致程序退出

> ID：16194145
> 
> 赞同：0
> 
> 时间：2013-04-24T14:06:53.440
> 
> 标签：windows, exit, filepath, python-3.3

我已经下载了一组 html 文件并将它们保存到的文件路径保存在 .txt 文件中。它的每条路径都在一个新行上。我想查看列表中的第一个文件，然后遍历整个列表，打开文件并提取数据，然后再继续下一个文件。

我的代码适用于直接输入的单个路径（对于第一个文件）：

```
path = r'C:\path\to\file.html' 
```

如果我使用以下方法遍历文本文件，则可以使用：

```
file_list_fp = r'C:\path\to\file_with_pathlist.txt'
with open(file_list_fp, 'r') as file_list:
for filepath in file_list:
    pathend = filepath.find('\n')
    path = file[:pathend]
    q = open(path, 'r').read() 
```

但是当我尝试使用以下任一方法获取单个路径时它失败了：

```
with open(file_list_fp, 'r') as file_list:

    path_n = file_list.readline()
    end = path_n.find('\n')
    path_bad1 = path_n[:end] 
```

或者：

```
with open(file_list_fp, 'r') as file_list:    

    path_bad2 = file_list.readline().split('\n')[0] 
```

有了这两个，我的代码在那之后就退出了。我不知道为什么。任何指针都非常受欢迎。（我在 Windows 上使用 Python 3.3.1。）

# mysql - 如何使用自制软件安装 sphinx 并提供 mysql 支持

> ID：16194150
> 
> 赞同：1
> 
> 时间：2013-04-24T14:07:00.807
> 
> 标签：mysql, sphinx, thinking-sphinx

我正在尝试在我的 Mac OS X (10.8.3) 笔记本电脑上安装 sphinx，以便我可以使用 think sphinx 在 rails 应用程序上进行一些全文搜索。

我用于安装 sphinx 的命令是：

`brew install sphinx --mysql` 和 `brew install sphinx --with-mysql=/usr/local/mysql`

两者似乎都不起作用。安装 sphinx 后，它只是说我需要安装 postgres 或 mysql 才能使用它。

有谁知道我如何强制自制软件安装带有 mysql 支持的 sphinx？

# c# - 此 OleDbParameterCollection 不包含具有 ParameterName "" 的 OleDbParameter

> ID：16194151
> 
> 赞同：-2
> 
> 时间：2013-04-24T14:07:04.073
> 
> 标签：c#, ado.net

我不断收到参数名称错误？在底部我附上了一张图片来帮助解释这个问题。

```
private void loadProgress(string jobNumber)
    {

        productioninfo.Open();

        OleDbCommand _contractReview = new OleDbCommand ("SELECT [Contract Review] FROM [Main$] WHERE [Job No] = '@Job No'", productioninfo);
        _contractReview.Parameters.Add("@Job No", OleDbType.Char);
        _contractReview.Parameters["Job No"].Value = jobNumber;

        OleDbDataReader dr = _contractReview.ExecuteReader();

        while (dr.Read())
        {

        }
        dr.Close();

    } 
```

![![图片](https://www.dropbox.com/s/54t7xcfhkj7sghu/Parameter%20name.jpg)](https://i.stack.imgur.com/5uVSP.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:09:02.963

试试这样；

```
OleDbCommand _contractReview = new OleDbCommand ("SELECT [Contract Review] FROM [Main$] WHERE [Job No] = @JobNo", productioninfo);
_contractReview.Parameters.Add("@JobNo", OleDbType.Char);
_contractReview.Parameters["JobNo"].Value = jobNumber; 
```

并且不要在表名和列名中使用空格。不推荐。

查看[数据库、表和列命名约定？](https://stackoverflow.com/questions/7662/database-table-and-column-naming-conventions)

# ios - UITableViewCell 不正确的 X 位置

> ID：16194152
> 
> 赞同：1
> 
> 时间：2013-04-24T14:07:04.673
> 
> 标签：ios, uitableview

我一直在这里搜索并疯狂地搜索这个问题的可能解决方案。到目前为止，我没有发现任何实际修复它的东西，所以我希望有人能提供帮助。

我正在为 iPad 应用程序开发 UI。我正在使用界面生成器进行操作。我曾短暂地使用故事板，但我不太喜欢它们，所以我现在坚持使用 IB。不幸的是，我对 IOS Ui 的操作不是很有经验，但到目前为止它进展得相对顺利。在我的应用程序中，我有一个视图控制器，它包含一个包含一对子视图的视图。一个子视图包含一个相当像标题栏的窗口（我喜欢它的外观）。第二个包含一个 UITableView。据我所知，UITableView 已正确设置，并使用自定义 UITableViewCells 从数据源提供信息。UITableView 设置为分组虽然目前只有一个部分。该表默认处于编辑模式，因为我希望用户能够添加新项目并将 VC 用作选择对话框。使用 UIModalPresentationFormSheet 呈现（而不是推送）视图控制器（再次，因为我喜欢视图）但我不知道这与问题有什么关系。单元格边框与 X 原点齐平，文本当前没有从那里开始的唯一原因是因为我进入单元格并将标签移到上方，在单元格边缘和包含我的文本的标签之间留下了间隙。

[令人反感的观点 http://bit.ly/144cbjT](http://bit.ly/144cbjT)

问题：由于某种原因，UITableViewCells 将自己定位在 X：0。当您将 UITablewView 设置为分组样式时，这会将它们置于绘制在 UITablewView 上的边框之外。我可能只是关闭边界并逃脱它，但我喜欢它的外观，所以我想保留它。我尝试过处理单元格上的约束和锚点、单元格的内容、表格本身、视图......我尝试简单地将单元格的标签移动一点。我还打开和关闭了剪辑子视图。我已确保从 XIB 正确加载控件。我已确保将所有内容添加为需要的子视图。我已经确定我已经尝试了所有我能想到的，除了在代码中设置单元格的 X 位置。但由于我不确定如何判断边界在哪里，我

问题：我该如何解决这个问题？选择附件应该在分组框之外。文本应该在里面，而不是像现在一样渗出到背景上。我相信单元格的内容应该显示在黄色区域内的边框内。

奇怪的是，这是我在这个应用程序中的第五张或第六张桌子，我一直在做它们基本上都是一样的。到目前为止，这是我唯一遇到的麻烦。

任何人都可以对发生的事情有所了解吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:14:47.880

我认为要在代码中得到这个，你必须做一些明确的事情，所以最有可能的候选者是一个混乱的 IB 文件。

由于它不需要任何费用，我只需从 IB 中删除 tableView 然后重新添加它。如果这不起作用，请尝试重新创建完整的 IB。

希望有帮助

# java - 元素开关有问题

> ID：16194154
> 
> 赞同：1
> 
> 时间：2013-04-24T14:07:07.157
> 
> 标签：java, arrays

所以我正在尝试进行元素切换。基本上切换二维数组中的两个元素。我没有收到任何错误，但它只是无法正常工作，甚至没有打印所有元素。我究竟做错了什么。这是代码。

```
public class ArrayTheory
{
    public static void printArray(int[][]args)
    {
        for(int i=0;i<args.length; i++)
            for(int j=0;j<args.length; j++) {
                System.out.print(args[i][j]);
            }   
            System.out.println();
    }

    public static void arraySwitch(int c1, int c2, int [][]args)
    {
        for(int i=0;i<args.length; i++)
            for(int j=0;j<args.length; j++) {
                int temp = args[i][c1];
                args[i][c1] = args[i][c2];
                args[i][c1] = temp;
            }   
    }
} 
```

这里是元素

```
public class TestArray {
    public static void main(String[] args){
        int[][] test = {{1,2,3,4},
                        {1,2,3,4},
                        {1,2,3,4}};

        int[][] carData = {{16,2008,4},
                           {45,2011,4},
                           {26,2010,7},
                           {18,2009,8}};

        ArrayTheory.arraySwitch(0,2,test);
        ArrayTheory.printArray(test);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:17:37.690

由于数组不是方形的，因此您需要使用`args[0].length`或`args[i].length`如果每行的长度不同，则对第二维进行索引。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:19:55.847

您的代码中的内部循环中有一个错误`arraySwitch`

```
 int temp = args[i][c1];
        args[i][c1] = args[i][c2];
        args[i][c1] = temp;  <<<<<<< bug 
```

那应该是

```
 args[i][c2] = temp; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:18:41.107

你的问题不是很清楚。如果您尝试交换两个特定元素，则需要四个坐标 (a1, a2) 和 (b1, b2) 来处理每个元素。您的代码似乎试图交换两行。您的打印方法看起来不错，除了您的外循环没有大括号。所以你的 println() 只会在二维数组的全部内容被打印后执行一次。

# android - 在 Android 中获取 UARFCN 和 SC

> ID：16194156
> 
> 赞同：2
> 
> 时间：2013-04-24T14:07:14.270
> 
> 标签：android

如何动态读取低级 UMTS (3G) 网络信息：Android 中的 UARFCN（绝对射频信道号）和 SC（扰码）。有可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-07-18T07:15:24.580

在 GSM、WCDMA 和 LTE 中，您可以使用 API 访问 ARFCN：

```
TelephonyManager tm = (TelephonyManager)getSystemService(TELEPHONY_SERVICE);
CellInfo ci = tm.getAllCellInfo.get(0) ; // Registered Cell Tower

if (ci instanceof CellInfoGSM)
{
 ((CellInfoGSM)ci).getCellIdentity().getArfcn();
}
else if (ci instanceof CellInfoWCDMA)
{
 ((CellInfoWcdma)ci).getCellIdentity().getUarfcn();
}
else if (ci instanceof CellInfoLte)
{
 ((CellInfoLte)ci).getCellIdentity().getEarfcn();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-21T11:03:45.860

有几个人[在这里](https://stackoverflow.com/questions/13010618/absolute-radio-frequency-channel-number-arfcn-in-android-device)和[这里](http://grokbase.com/t/gg/android-platform/129s31hx97/writing-an-app-in-android-to-get-the-arfcn-from-the-mobile-network)问过这个问题，还有一些人在 XDA 论坛（*不允许 XDA 链接*）。

我认为没有任何公共 API 可以访问它，但是您可以使用它`TelephonyManager`来获取有关电话服务之类的一些基本信息`IMEI`，但不是 **UARFCN**或**SC**

Playstore 上有一些可用的应用程序，例如[ARFCN Calculator](https://play.google.com/store/apps/details?id=com.aprender.arfcncalculator)、[ARFCN](https://play.google.com/store/apps/details?id=com.ARFCN)或[UARFCN](https://play.google.com/store/apps/details?id=com.UARFCN) ， 这些可能会帮助您理解它

您可以对这些应用程序进行[反编译](http://yeblon.com/how-to-decompile-android-apk-app-files)或[逆向工程](https://kkinder.com/2011/11/27/so-you-want-to-reverse-engineer-an-android-app-apk/)，并检查您是否从中获得了一些信息

# c# - EntityState.Deleted 不起作用，Remove(entity) 可以吗？

> ID：16194162
> 
> 赞同：5
> 
> 时间：2013-04-24T14:07:30.410
> 
> 标签：c#, .net, entity-framework, exception-handling, entity-framework-5

尝试读取记录时，我一直在努力使用 EF，然后在同一事务中删除这些记录。我最初使用的是 EntityState.Deleted 方法，这会产生错误：

> 操作失败：无法更改关系，因为一个或多个外键属性不可为空。当对关系进行更改时，相关的外键属性将设置为空值。如果外键不支持空值，则必须定义新的关系，必须为外键属性分配另一个非空值，或者必须删除不相关的对象。

但是，如果我将其更改为如下所示，使用 .Remove()，那么一切都很好。

1.  使用 .Remove() 与 .Deleted 的区别和最佳时间是什么？
2.  我怎样才能使用 .Deleted 方法完成这项工作？我已经尝试为我的存储库创建一个新的上下文实例来读取和另一个要删除，但随后出现与 IEntityTracker 无法跟踪多个实例相关的错误......我也尝试了。在初始读取时包含以加载依赖记录进入 EF 以便它知道并删除它们。我也试过了。先分离读取的记录。一切都无济于事。

这是有问题的方法。请注意，我确实有一个使用 .Deleted 方法的通用存储库，该方法在这种情况下一直为我服务（读取然后删除相同的记录。）

```
//Delete Allocation Need and AllocatedContainers for alloc need id
public ActionConfirmation<int> DeleteAllocRecords(int intFacilityId, AllocNeedSourceTypes needSourceType, int intNeedSourceId)
{
var context = new InventoryMgmtContext();
var repository = new AllocationNeedRepository(context);

//Delete Allocation Need and hence children in Allocated Containers
var srcType = needSourceType.ToString();
List<AllocationNeed> allocNeeds = repository.SearchFor(
    x => x.FacilityId == intFacilityId
    && x.NeedSourceType == srcType
    && x.NeedSourceId == intNeedSourceId
).ToList();

//var deleteRepository = new Repository<AllocationNeed>(); <--tried separate instance of context to delete...no worky.

foreach (AllocationNeed allocNeed in allocNeeds)
{
    try
    {
        //NO WORK: context.Entry(allocNeed).State = System.Data.EntityState.Deleted;
        context.AllocationNeeds.Attach(allocNeed); 
        context.AllocationNeeds.Remove(allocNeed); <-- Works
        context.SaveChanges();
    }
    catch (Exception ex)
    {
        return ActionConfirmation<int>.CreateFailureConfirmation(ex.Message, allocNeed.Id);
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T14:22:14.320

`Remove`也将删除子对象，但使用`Deleted`不会。你真的应该`Remove`因为这个原因而使用。如果你**真的**想使用`Deleted`，你必须让你的外键可以为空，但是你最终会得到孤立的记录（这是你一开始不应该这样做的主要原因之一）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T14:24:02.327

**1.) .Remove() 与 .Deleted 的区别和最佳使用时间是什么？**

似乎将实体的状态设置为 Deleted 会导致 SaveChanges() 仅从数据库中删除该特定实体，而不考虑可能通过非空外键列引用它的其他行。

`Remove()`将考虑作为关系一部分的行。

**2.）如何使用 .Deleted 方法完成这项工作？**

如果您`ON CASCADE DELETE`为相关行指定了行为，则数据库应自动处理它。这是让 EF 生成数据库时的默认行为。

# c# - 添加性能计数器类别挂起计算机

> ID：16194163
> 
> 赞同：2
> 
> 时间：2013-04-24T14:07:37.527
> 
> 标签：c#, asp.net-mvc, windows, c#-4.0, performancecounter

我正在尝试从 ASP.NET MVC 应用程序（在 Windows 8 x64 PC 上使用 VS 2012）添加性能计数器，但我遇到的问题是，如果我检查类别是否存在或添加新的性能计数器类别，计算机会挂起

我的代码是：

```
namespace TestMvcCounter
{
  public class MvcApplication : System.Web.HttpApplication
  {
      protected void Application_Start()
      {
          AreaRegistration.RegisterAllAreas();

          WebApiConfig.Register(GlobalConfiguration.Configuration);
          FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);
          RouteConfig.RegisterRoutes(RouteTable.Routes);
          BundleConfig.RegisterBundles(BundleTable.Bundles);

          if (!PerformanceCounterCategory.Exists("MY_TEST"))
          {
              CounterCreationDataCollection ccdc = new CounterCreationDataCollection();
              ccdc.Add(new CounterCreationData() { CounterName = "# loops", CounterType = PerformanceCounterType.RateOfCountsPerSecond32 });

              PerformanceCounterCategory.Create("MY_TEST", "Test performance counter", PerformanceCounterCategoryType.MultiInstance, ccdc);
          }

      }
   }
} 
```

当代码到达这一行时

```
!PerformanceCounterCategory.Exists("MY_TEST") 
```

系统挂起，没有任何异常或超时

你知道可能是什么原因导致这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-05T16:11:48.007

经过深入搜索，我发现问题出在 IIS Express 8 上。

我尝试卸载它并重新安装但没有用，然后我尝试再次卸载并安装 IIS Express 7.5 并且它可以工作

# apache - .htaccess - RewriteCond：错误的标志分隔符

> ID：16194168
> 
> 赞同：6
> 
> 时间：2013-04-24T14:07:42.513
> 
> 标签：apache, .htaccess, mod-rewrite

我正在使用 .htaccess 来阻止对我的网站的一些错误请求。在我的本地服务器（XAMPP）上一切正常，但是当我将它上传到主机（共享）时，我收到了这个错误：`RewriteCond: bad flag delimiters`

这是我的 .htaccess 中的代码

```
ServerSignature Off
Options -Indexes

RewriteEngine On

RewriteCond %{REQUEST_METHOD} ^(HEAD|TRACE|DELETE|TRACK|DEBUG) [NC]
RewriteRule ^(.*)$ - [F,L]

RewriteCond %{HTTP_USER_AGENT} (libwww-perl|wget|python|nikto|curl|scan|java|winhttp|clsh ttp|loader) [NC,OR]
RewriteCond %{HTTP_USER_AGENT} (<|>|'|%0A|%0D|%27|%3C|%3E|%00) [NC,OR]
RewriteCond %{HTTP_USER_AGENT} (;|<|>|'|"|\)|\(|%0A|%0D|%22|%27|%28|%3C|%3E|%00). *(libwww-perl|wget|python|nikto|curl|scan|java|winhttp|HTTr ack|clshttp|archiver|loader|email|harvest|extract| grab|miner) [NC,OR]

RewriteCond %{THE_REQUEST} \/\*\ HTTP/ [NC,OR]
RewriteCond %{THE_REQUEST} etc/passwd [NC,OR]
RewriteCond %{THE_REQUEST} cgi-bin [NC,OR]
RewriteCond %{THE_REQUEST} (%0A|%0D) [NC,OR]
RewriteCond %{THE_REQUEST} \?\ HTTP/ [NC,OR]

RewriteCond %{QUERY_STRING} ^(.*);(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} ^(.*)\"|\(|\)(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=http:// [OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=(\.\.//?)+ [OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=/([a-z0-9_.]//?)$ [NC,OR]
RewriteCond %{QUERY_STRING} \=PHP[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12} [NC,OR]
RewriteCond %{QUERY_STRING} (\.\./|\.\.) [OR]
RewriteCond %{QUERY_STRING} ftp\: [NC,OR]
RewriteCond %{QUERY_STRING} http\: [NC,OR]
RewriteCond %{QUERY_STRING} https\: [NC,OR]
RewriteCond %{QUERY_STRING} \=\|w\| [NC,OR]
RewriteCond %{QUERY_STRING} ^(.*)/self/(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} ^(.*)cPath=http://(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (\<|%3C).*iframe.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (<|%3C)([^i]*i)+frame.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [NC,OR]
RewriteCond %{QUERY_STRING} base64_(en|de)code[^(]*\([^)]*\) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} ^.*(\[|\]|\(|\)|<|>).* [NC,OR]
RewriteCond %{QUERY_STRING} (NULL|OUTFILE|LOAD_FILE) [OR]
RewriteCond %{QUERY_STRING} (\./|\../|\.../)+(motd|etc|bin) [NC,OR]
RewriteCond %{QUERY_STRING} (localhost|loopback|127\.0\.0\.1) [NC,OR]
RewriteCond %{QUERY_STRING} (<|>|'|%0A|%0D|%27|%3C|%3E|%00) [NC,OR]
RewriteCond %{QUERY_STRING} concat[^\(]*\( [NC,OR]
RewriteCond %{QUERY_STRING} union([^s]*s)+elect [NC,OR]
RewriteCond %{QUERY_STRING} union([^a]*a)+ll([^s]*s)+elect [NC,OR]
RewriteCond %{QUERY_STRING} (;|<|>|'|"|\)|%0A|%0D|%22|%27|%3C|%3E|%00).*(/\*|union|select|insert|drop|delete|update|cast|cre ate|char|convert|alter|declare|order|script|set|md 5|benchmark|encode) [NC,OR]
RewriteCond %{QUERY_STRING} (sp_executesql) [NC]
RewriteRule ^(.*)$ - [F,L]

<FilesMatch "^(install\.php|setup\.php|wp-config\.php|config\.php|configuration\.php|php\.in i|php5\.ini|bb-config\.php|db.php)">
Order allow,deny
Deny from all
</FilesMatch>

Options -ExecCGI
AddHandler cgi-script .php .pl .py .jsp .asp .htm .shtml .sh .cgi
AddType text/plain .pl .cgi .php
<FilesMatch "\.(php|pl|py|jsp|asp|htm|shtml|sh|cgi)$">
ForceType text/plain
</FilesMatch> 
```

我已经删除了尾随空格和评论。仍然得到这个错误。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-25T01:21:35.303

由于您知道问题出在 a 上`RewriteCond`，因此您可以通过消除一半的条件然后测试剩余的条件来相当快地定位问题。

您可以从删除第一条规则开始。错误仍然存​​在。作为下一步，删除剩余`RewriteCond`s 的前半部分（大约 20 个）并再次测试。继续直到你到达少数`RewriteCond`s 并一个一个地删除它们。

错误随着倒数第二条规则消失。重新插入此规则以验证错误是否再次出现。现在看看

```
RewriteCond %{QUERY_STRING} (;|<|>|'|"|\)|%0A|%0D|%22|%27|%3C|%3E|%00).*(/\*|union|select|insert|drop|delete|update|cast|cre ate|char|convert|alter|declare|order|script|set|md 5|benchmark|encode) [NC,OR] 
```

这种情况有什么问题？你看到 和 中的空格了`cre ate`吗`md 5`？

只要您删除这些空格或用反斜杠转义它们`\`，错误就消失了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T15:46:11.250

正则表达式中有一些（可能）不需要的空格，这对我有用：

```
ServerSignature Off
Options -Indexes

RewriteEngine On

RewriteCond %{REQUEST_METHOD} ^(HEAD|TRACE|DELETE|TRACK|DEBUG) [NC]
RewriteRule ^(.*)$ - [F,L]

RewriteCond %{HTTP_USER_AGENT} (libwww-perl|wget|python|nikto|curl|scan|java|winhttp|clshttp|loader) [NC,OR]
RewriteCond %{HTTP_USER_AGENT} (<|>|'|%0A|%0D|%27|%3C|%3E|%00) [NC,OR]
RewriteCond %{HTTP_USER_AGENT} (;|<|>|'|"|\)|\(|%0A|%0D|%22|%27|%28|%3C|%3E|%00).*(libwww-perl|wget|python|nikto|curl|scan|java|winhttp|HTTrack|clshttp|archiver|loader|email|harvest|extract|grab|miner) [NC,OR]

RewriteCond %{THE_REQUEST} \/\*\ HTTP/ [NC,OR]
RewriteCond %{THE_REQUEST} etc/passwd [NC,OR]
RewriteCond %{THE_REQUEST} cgi-bin [NC,OR]
RewriteCond %{THE_REQUEST} (%0A|%0D) [NC,OR]
RewriteCond %{THE_REQUEST} \?\ HTTP/ [NC,OR]

RewriteCond %{QUERY_STRING} ^(.*);(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} ^(.*)\"|\(|\)(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=http:// [OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=(\.\.//?)+ [OR]
RewriteCond %{QUERY_STRING} [a-zA-Z0-9_]=/([a-z0-9_.]//?)$ [NC,OR]
RewriteCond %{QUERY_STRING} \=PHP[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12} [NC,OR]
RewriteCond %{QUERY_STRING} (\.\./|\.\.) [OR]
RewriteCond %{QUERY_STRING} ftp\: [NC,OR]
RewriteCond %{QUERY_STRING} http\: [NC,OR]
RewriteCond %{QUERY_STRING} https\: [NC,OR]
RewriteCond %{QUERY_STRING} \=\|w\| [NC,OR]
RewriteCond %{QUERY_STRING} ^(.*)/self/(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} ^(.*)cPath=http://(.*)$ [NC,OR]
RewriteCond %{QUERY_STRING} (\<|%3C).*script.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (<|%3C)([^s]*s)+cript.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (\<|%3C).*iframe.*(\>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} (<|%3C)([^i]*i)+frame.*(>|%3E) [NC,OR]
RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [NC,OR]
RewriteCond %{QUERY_STRING} base64_(en|de)code[^(]*\([^)]*\) [NC,OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} ^.*(\[|\]|\(|\)|<|>).* [NC,OR]
RewriteCond %{QUERY_STRING} (NULL|OUTFILE|LOAD_FILE) [OR]
RewriteCond %{QUERY_STRING} (\./|\../|\.../)+(motd|etc|bin) [NC,OR]
RewriteCond %{QUERY_STRING} (localhost|loopback|127\.0\.0\.1) [NC,OR]
RewriteCond %{QUERY_STRING} (<|>|'|%0A|%0D|%27|%3C|%3E|%00) [NC,OR]
RewriteCond %{QUERY_STRING} concat[^\(]*\( [NC,OR]
RewriteCond %{QUERY_STRING} union([^s]*s)+elect [NC,OR]
RewriteCond %{QUERY_STRING} union([^a]*a)+ll([^s]*s)+elect [NC,OR]
RewriteCond %{QUERY_STRING} (;|<|>|'|"|\)|%0A|%0D|%22|%27|%3C|%3E|%00).*(/\*|union|select|insert|drop|delete|update|cast|create|char|convert|alter|declare|order|script|set|md5|benchmark|encode) [NC,OR]
RewriteCond %{QUERY_STRING} (sp_executesql) [NC]
RewriteRule ^(.*)$ - [F,L]

<FilesMatch "^(install\.php|setup\.php|wp-config\.php|config\.php|configuration\.php|php\.ini|php5\.ini|bb-config\.php|db.php)">
Order allow,deny
Deny from all
</FilesMatch>

Options -ExecCGI
AddHandler cgi-script .php .pl .py .jsp .asp .htm .shtml .sh .cgi
AddType text/plain .pl .cgi .php
<FilesMatch "\.(php|pl|py|jsp|asp|htm|shtml|sh|cgi)$">
ForceType text/plain
</FilesMatch> 
```

# android - 在android中读取任何URL时如何显示进度？

> ID：16194172
> 
> 赞同：0
> 
> 时间：2013-04-24T14:07:49.617
> 
> 标签：android, xml, xml-parsing

我在像“ [http://sample.com/test](http://sample.com/test) ”这样的 url 中有一个问题，它有大量的 xml 数据，我无法在 mainUI 中显示进度条。

请做有需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T05:26:50.573

在**AsyncTask**中，后台任务**将 xml 保存在本地内存中**。

```
 int count;
                    try {
                        URL url = new URL("http://sample.com/test");
                        URLConnection conection = url.openConnection();
                        conection.connect();
                        // getting file length
                        int lenghtOfFile = conection.getContentLength();
                        // input stream to read file - with 8k buffer
                        InputStream input = new BufferedInputStream(url.openStream(), 8192);
                        // Output stream to write file
                        OutputStream output = new FileOutputStream("/data/data/com.pc.demo/temp.xml");
                        byte data[] = new byte[1024];
                        long total = 0;
                        while ((count = input.read(data)) != -1) {
                            total += count;
                            int progress = (int)((total*100)/lenghtOfFile) ;
                            System.out.println("update---"+progress);
                            publishProgress(progress);
                            output.write(data, 0, count);
                        }

                        // flushing output
                        output.flush();
                        // closing streams
                        output.close();
                        input.close();

                    } catch (Exception e) {
                        Log.e("Error: ", e.getMessage());
                    } 
```

后执行

```
 File yourFile = new File("/data/data/com.pc.demo/temp.xml");
     InputStream input =  new BufferedInputStream(new FileInputStream(yourFile), 8086); 
```

onProgressUpdate

```
 setProgressPercent(progress[0]) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T05:42:49.267

您可以覆盖 AsyncTask 的 onProgressUpdate() 函数，并使用 doInBackgroud() 中的 publishProgress(Progress... values) 将您的保存状态推送到进度然后更新它，这是我的简单代码，希望可以帮助您.

```
private class DownloadFilesTask extends AsyncTask<URL, Integer, Long> {
 protected Long doInBackground(URL... urls) {
     int count = urls.length;
     long totalSize = 0;
     for (int i = 0; i < count; i++) {
         totalSize += Downloader.downloadFile(urls[i]);
         publishProgress((int) ((i / (float) count) * 100));
         // Escape early if cancel() is called
         if (isCancelled()) break;
     }
     return totalSize;
 }

 protected void onProgressUpdate(Integer... progress) {
     setProgressPercent(progress[0]); //change this with your progress bar
 }

 protected void onPostExecute(Long result) {
     showDialog("Downloaded " + result + " bytes");
 } 
```

}

# java - 彻底关闭 rmi 服务器

> ID：16194175
> 
> 赞同：4
> 
> 时间：2013-04-24T14:07:58.903
> 
> 标签：java, rmi

我在关闭服务器组件时遇到了一些麻烦，希望能得到一些帮助。

我的服务器代码如下所示，它有一个关闭服务器的方法

**服务器**

```
 private final String address = "127.0.0.1";
    private Registry registry;
    private int port = 6789;

    public RmiServer() throws RemoteException {
        try {
            registry = LocateRegistry.createRegistry(port);
            registry.rebind("rmiServer", this);
        } catch (RemoteException e) {
            logger.error("Unable to start the server. Exiting the application.", e);
            System.exit(-1);
        }
    }

    public void shutDownServer() throws RemoteException {
        int succesful = 0;
        try {
            registry.unbind("rmiServer");
            UnicastRemoteObject.unexportObject(this, true);
            Thread.sleep(1000);
        } catch (NotBoundException e) {
            logger.error("Error shutting down the server - could not unbind the registry", e);
            succesful = -1;
        } catch (InterruptedException e) {
            logger.info("Unable to sleep when shutting down the server", e);
            succesful = -1;
        }
        catch (AccessException e) {
            logger.info("Access Exception", e);
            succesful = -1;
        }
        catch (UnmarshalException e) {
            System.out.println(e.detail.getMessage());
            logger.info("UnMarshall Exception", e);
            succesful = -1;
        }
        catch (RemoteException e) {
            System.out.println(e.detail.getMessage());
            logger.info("Remote Exception", e);
            succesful = -1;
        }

        logger.info("server shut down gracefully");     
        System.exit(succesful);
} 
```

我的客户端连接正常，没有问题，所以要关闭我创建了一个新应用程序，复制客户端代码进行连接，然后在服务器上调用 close 方法

**关闭**

公共类关机{

```
private String serverAddress = "127.0.0.1";
private String serverPort = "6789";
private ReceiveMessageInterface rmiServer;
private Registry registry;

public Shutdown(){
    try {
        registry = LocateRegistry.getRegistry(serverAddress, (new Integer(serverPort)).intValue());
        rmiServer = (ReceiveMessageInterface) (registry.lookup("rmiServer"));
        logger.info("Client started correctly");
        rmiServer.shutDownServer();
        System.exit(0);
    }
    catch (UnmarshalException e ){
        logger.error("Unmarshall exception. Exiting application", e);
        System.exit(-1);
    }
    catch (RemoteException e) {
        logger.error("Remote object exception occured when connecting to server. Exiting application", e);
        System.exit(-1);
    } catch (NotBoundException e) {
        logger.error("Not Bound Exception occured when connecting to server. Exiting application", e);
        System.exit(-1);
    }
} 
```

无论我尝试什么，我都会收到以下异常；

```
ERROR com.rmi.client.RMIClient - Unmarshall exception. Exiting application
java.rmi.UnmarshalException: Error unmarshaling return header; nested exception is: 
    java.net.SocketException: Connection reset
    at sun.rmi.transport.StreamRemoteCall.executeCall(Unknown Source)
    at sun.rmi.server.UnicastRef.invoke(Unknown Source)
    at java.rmi.server.RemoteObjectInvocationHandler.invokeRemoteMethod(Unknown Source)
    at java.rmi.server.RemoteObjectInvocationHandler.invoke(Unknown Source)
    at $Proxy0.shutDownServer(Unknown Source)
    at com.rmi.shutdown.Shutdown.<init>(Shutdown.java:31)
    at com.rmi.shutdown.Shutdown.main(Shutdown.java:52)
Caused by: java.net.SocketException: Connection reset
    at java.net.SocketInputStream.read(Unknown Source)
    at java.io.BufferedInputStream.fill(Unknown Source)
    at java.io.BufferedInputStream.read(Unknown Source)
    at java.io.DataInputStream.readByte(Unknown Source)
    ... 7 more 
```

我相信这可能是由于客户端没有正确断开连接而只是被“切断”，但我不确定如何断开服务器端的连接？

请有人建议。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-12T04:35:49.843

使用 force = true 取消导出不会中止正在进行的调用。一般来说，它会让正在进行的调用运行到完成。您的`shutDownServer`方法几乎是正确的，因为它取消注册远程引用并取消导出它。但是，它接下来要做的事情不起作用。首先，它会休眠一秒钟。这使呼叫保持进行，并使客户端等待回复。然后关闭代码退出服务器 JVM，而不从远程调用返回。这会在客户端仍在等待回复时关闭客户端的连接。这就是客户端收到连接重置异常的原因。

要干净地关闭，请注销远程对象，使用 force = true 取消导出它（就像您所做的那样），然后简单地返回。这将向客户端发送回复，使其远程调用完成，然后退出。回到服务器，在最后一个正在进行的调用完成后，如果没有导出其他对象，并且没有其他东西保持 JVM（例如非守护线程），则 JVM 将退出。您需要让 RMI 完成其服务器端处理，而不是调用`System.exit()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T22:36:57.123

The system is doing exactly what you told it to do. You told it to unexport itself, and you set the 'force' parameter to true, which aborts calls in progress, so it unexported itself and aborted the call in progress. Just ignore it, or if you insist on a clean response to the shutdown client, have the server start a new thread for the unexport operation, with a short delay so the shutdown call can return to the client.

# elasticsearch - Elasticsearch日期字段：纪元毫秒输入，字符串输出？

> ID：16194177
> 
> 赞同：3
> 
> 时间：2013-04-24T14:08:02.863
> 
> 标签：elasticsearch

步骤： 1\. 在映射中定义一个日期字段。
2\. 在该字段中插入一个纪元毫秒（长）值。

弹性搜索能否返回该字段的字符串值（yyyy-MM-ddTHH:mm:SS）进行搜索？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-14T11:45:41.433

根据我对 ElasticSearch 的日期格式文档的了解，它将始终接受格式给定格式的输入旁边的毫秒自纪元输入，并且它将使用给定的（第一个）格式生成字符串输出。如果您不提供格式，则将使用“date_optional_time”格式（yyyy-MM-dd'T'HH:mm:ss.SSSZZ）。

如果您的时区有问题，您需要为 ElasticSearch 提供您想要的格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T14:00:52.610

我手头没有代码，但在我的测试中，我相信我设法做到了以下几点：

我使用字段上的日期格式化程序和查询字段定义来执行此操作：

`curl -XGET 'http://localhost:9200/twitter/tweet/1?fields=title,date_field.date_time'`

使用此处指定的日期格式：[http ://www.elasticsearch.org/guide/reference/mapping/date-format/](http://www.elasticsearch.org/guide/reference/mapping/date-format/)

如果您想要返回完整的文档，这可能会很麻烦。在这种情况下，是否可以使用别名“视图”映射来获得与主映射不同的返回结果？可能这已成为一个半答案。

# c++ - 这些实现会导致内存泄漏吗？

> ID：16194178
> 
> 赞同：-22
> 
> 时间：2013-04-24T14:08:06.023
> 
> 标签：c++

以下情况会导致内存泄漏吗？如果是，我该如何解决这个问题？我应该在类中使用指针`Base`（即`Structure* var`）并在析构函数中删除它吗？

如果情况 2 不会导致内存泄漏，会发生什么`Structure(0,0)`？它立即被创建并被销毁还是发生了其他事情？

**情况1 ：**

```
struct Structure
{
    int a;
    int b;
    Structure() { a=1; b=2; }
    Structure(int num1, int num2) : a(num1), b(num2){}
};

class Base
{
    private:
        Structure var;
    public: 
        Base(Structure structure)
        {
            var = structure;
        }
};

class Derived : public Base
{
    public:
        Derived(bool boolean) : Base(boolean ? *(new Structure(0,0)) : *(new Structure(10,10))){}
};

int main()
{
    Derived derived(true);
} 
```

**案例2：**

```
struct Structure
{
    int a;
    int b;
    Structure() { a=1; b=2; }
    Structure(int num1, int num2) : a(num1), b(num2){}
};

class Base
{
    private:
        Structure var;
    public: 
        Base(Structure structure)
        {
            var = structure;
        }
};

class Derived : public Base
{
    public:
        Derived(bool boolean) : Base(boolean ? Structure(0,0) : Structure(10,10)){}
};

int main()
{
    Derived derived(true);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T14:10:40.077

案例 1 泄漏是因为您`new`没有相应`delete`的 .

案例 2 不会泄漏，因为您没有`new`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:11:58.963

第一种情况非常糟糕：

```
 Derived(bool boolean) : Base(boolean ? *(new Structure(0,0)) : *(new Structure(10,10))){}
                                           ^^^^                    ^^^ 
```

您正在动态分配 a`Structure`但您没有保留指针，因此您无法调用`delete`它们，因此您将泄漏内存。第二种情况没有这个问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T15:00:11.900

第一种选择将导致内存泄漏，无论您是传递`true`还是传递`false`给`Derived`. 正好一个会在堆上分配，然后被赋值时`Structure`的默认复制构造函数复制`Structure`

```
 var = structure; 
```

被执行。

如果你：

*   按照问题中的建议用指针替换内部`var`变量类型
*   `delete`析构函数中的指针
*   实现一个复制构造函数来处理分配`Base`复制`var``new`

你不应该有任何问题。

```
struct Structure {
    int a;
    int b;
    Structure() { a=1; b=2; }
    Structure(int num1, int num2) : a(num1), b(num2){}
};

class Base {
    private:
        Structure *var;
    public: 
    Base(Structure *structure) {
        var = structure;
    }
    Base(const Base &b) {
        var = new Structure(*b.var);
    }
    virtual ~Base(){
        delete var;
        var = 0;
    }
}; 
```

# scala - 要么一元操作

> ID：16194180
> 
> 赞同：2
> 
> 时间：2013-04-24T14:08:07.083
> 
> 标签：scala, either

我刚开始习惯于处理一元操作。对于 Option 类型，Tony Morris 的这份备忘单有所帮助： [http ://blog.tmorris.net/posts/scalaoption-cheat-sheet/](http://blog.tmorris.net/posts/scalaoption-cheat-sheet/)

所以最后似乎很容易理解：

*   map 转换选项内部的值
*   `Option[Option[X]]`展平许可证以进行改造`Option[X]`
*   flatMap 在某种程度上是一个地图操作，产生一个`Option[Option[X]]`然后展平为`Option[X]`

至少到目前为止我是这么理解的。

* * *

对于 Either，它似乎有点难以理解，因为 Either 本身没有正确的偏见，没有 map / flatMap 操作......而且我们使用投影。

我可以阅读 Scaladoc，但它不如选项备忘单那么清晰。有人可以提供一个 Either Sheet Cheat 来描述基本的一元操作吗？

在我看来，这`Either.joinRight`有点像`RightProjection.flatMap`并且似乎相当于`Option.flatten`for Either。

在我看来，如果`Either`是右偏，那么 Either.flatten 将是 Either.joinRight 不？

在这个问题中：我询问关于 Eiher 理解的[选项和理解](https://stackoverflow.com/questions/16130039/either-options-and-for-comprehensions/16130181#16130181)，其中一个答案说我们不能混合 monad，因为它被脱糖到 map/flatMap/filter 中的方式。

使用这种代码时：

```
def updateUserStats(user: User): Either[Error,User] = for {
  stampleCount <- stampleRepository.getStampleCount(user).right
  userUpdated <- Right(copyUserWithStats(user,stampleCount)).right
  userSaved <- userService.update(userUpdated).right
} yield userSaved 
```

这是否意味着我所有的 3 个方法调用必须始终返回`Either[Error,Something]`？我的意思是，如果我有一个方法调用`Either[Throwable,Something]`，它就不能正常工作？

* * *

**编辑：** Try[Something] 与右偏的 Either[Throwable,Something] 完全相同吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T00:59:35.193

`Either`从来没有真正打算成为一个基于异常处理的结构。它旨在表示一个函数确实可能返回两种不同类型之一的情况，但人们开始约定左侧类型应该是失败的情况，而右侧是成功的情况。如果您想为某些通过/失败类型的业务检查逻辑返回有偏见的类型，那么`Validation`from`scalaz`效果很好。如果您有一个可以返回值或 a 的函数`Throwable`，那么`Try`将是一个不错的选择。 `Either`应该用于您确实可能获得两种可能类型之一的情况，现在我正在使用`Try`and `Validation`（每种情况用于不同类型的情况），我再也不会使用`Either`了。

# upnp - 如何知道选择哪个版本的 DMR（设备媒体渲染器）？

> ID：16194181
> 
> 赞同：1
> 
> 时间：2013-04-24T14:08:13.430
> 
> 标签：upnp, dlna

我想为音频流实现 DLNA 设备媒体渲染器 (DMR)。我在这里找到了文档：http: [//upnp.org/resources/upnpresources.zip](http://upnp.org/resources/upnpresources.zip) 并发现似乎有三个版本的 DMR（MediaRenderer:1、MediaRenderer:2、MediaRenderer:3）。我找不到任何关于选择哪一个的建议。有什么理由不选择 MediaRenderer:3？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:57:52.857

保证对 UPnP 服务的更新是向后兼容的，因此每个 MediaRenderer:3 设备都将包含 v1 和 v2 服务的实现，并将响应作为该版本的 v1 或 v2 的 MSEARCH。

有关更多详细信息，请参阅 v1.1 设备架构文档（包含在您参考的 zip 中），特别是

§1.2.2 设备可用 - 使用 ssdp:alive 通知

> 更新的 UPnP 设备和服务类型需要完全向后兼容相同类型的先前版本。

§1.3.2 使用 M-SEARCH 的搜索请求

> 设备和服务类型的更新版本需要与以前的版本完全向后兼容。设备必须响应任何受支持版本的 M-SEARCH 请求。例如，如果设备实现了“urn:schemas-upnporg:service:xyz:2”，它必须响应该类型和“urn:schemas-upnp-org:service:xyz:1”的搜索请求。响应必须指定与搜索请求中包含的相同版本

换句话说，正确实现 MediaRenderer:3 的设备将可供需要 v1、v2 或 v3 服务的控制点使用。实现早期版本服务的设备将仅限于使用需要这些早期版本的控制点。

我同意你的观点，实施 MediaRenderer:3 是你最好的选择。这应该允许所有可能的控制点使用您的设备。

# c# - 数据网格选择的索引会带来麻烦

> ID：16194182
> 
> 赞同：1
> 
> 时间：2013-04-24T14:08:13.630
> 
> 标签：c#, wpf

我有一个数据网格，我用数据库中的数据填充。当我单击一行时，我调用 GotFocus 方法并尝试在满足某些要求时使按钮可见。

```
private void dtgVerkoopsdocumenten_GotFocus(object sender, RoutedEventArgs e)
{
    DataItem row = (DataItem)dtgVerkoopsdocumenten.SelectedItems[0];
    if (row.soort2 == "Factuur")
    {
        btnBoeking.IsHitTestVisible = true;
        btnBoeking.Opacity = 1;
    }
    else
    {
        btnBoeking.IsHitTestVisible = false;
        btnBoeking.Opacity = 0.5;
    }
} 
```

这给了我一个错误。

```
Index was out of range. Must be non-negative and less than the size of the collection. 
```

现在，当我调用代码但单击按钮时，它会按照它应该的方式工作。

```
private void tester_Click(object sender, RoutedEventArgs e)
{
    DataItem row = (DataItem)dtgVerkoopsdocumenten.SelectedItems[0];
    test.Content = row.soort2;
    if (row.soort2 == "Factuur")
    {
        btnBoeking.IsHitTestVisible = true;
        btnBoeking.Opacity = 1;
    }
    else
    {
        btnBoeking.IsHitTestVisible = false;
        btnBoeking.Opacity = 0.5;
    }
} 
```

为什么是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T15:38:54.893

Why dont you use DataGrid SelectedIndexChanged event?

Wyy use GotFocus that doesnt tell you if user even made a selection to start with,

```
DataItem row = (DataItem)dtgVerkoopsdocumenten.SelectedItems[0]; 
```

Called from gotfocus will fail as you have nothing selected besides having no error check in place to check if selection,

If you use Selection changed events you know the user has made selection changes there are a number of events for selection

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:13:21.870

因为 dtgVerkoopsdocumenten.SelectedItems 是空的并且`GotFocus`事件在事件之前引发，`SelectedItemChanged`所以我们不确定是否`dtgVerkoopsdocumenten.SelectedItems`有任何项目。你可以`dtgVerkoopsdocumenten.SelectedItems`在做任何事情之前检查。

```
 if (dtgVerkoopsdocumenten.SelectedItems != null && 
        dtgVerkoopsdocumenten.SelectedItems.Count > 0)
    { 
      DataItem row = (DataItem)dtgVerkoopsdocumenten.SelectedItems[0];
      ...
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:13:31.363

在按索引访问所选项目之前，您需要检查所选项目计数是否大于零条件。

# c# - 使用 Stacky API 获取 Stack Overflow 问题

> ID：16194186
> 
> 赞同：10
> 
> 时间：2013-04-24T14:08:27.363
> 
> 标签：c#, stackexchange-api, stacky

我想使用[Stacky C# library](https://stackapps.com/questions/6/stacky-a-net-client-library-full-support-for-api-v2-0) for the [Stack Exchange API从](https://api.stackexchange.com/)*Stack Overflow*获取最新的问题。

*我采用了示例代码并尝试运行它，但在从Stack Exchange*网站返回数据时它挂起。

```
StackyClient client = new StackyClient("0.9", "", Sites.StackOverflow, 
            new UrlClient(), new JsonProtocol());

var o = new QuestionOptions();
o.FromDate = DateTime.Now.AddMinutes(-10.0);
o.ToDate = DateTime.Now;
o.IncludeAnswers = false;
o.IncludeBody = false;
o.IncludeComments = false;
o.SortBy = QuestionSort.Creation;
o.SortDirection = SortDirection.Descending;

IPagedList<Question> l = client.GetQuestions(o); <--- program hangs here 4ever 
```

我究竟做错了什么？

我还看到我可以[注册我的应用程序](https://stackapps.com/apps/oauth/register)以获取*API Key*。但这并不是让它首先运行的必要条件，不是吗？

## 编辑

如果我删除线条

```
o.FromDate = DateTime.Now.AddMinutes(-10.0);
o.ToDate = DateTime.Now; 
```

它工作并返回**所有**问题。另外，如果我添加该行

```
o.Max = 50; 
```

相反，它也不起作用。

## 编辑 2

现在它可以工作了 -**重新启动了我的计算机**。
顺便说一句，我最后使用了该代码

```
var o = new QuestionOptions();
o.FromDate = DateTime.UtcNow.AddMinutes(-20);
o.IncludeAnswers = false;
o.IncludeBody = false;
o.IncludeComments = false;
o.SortBy = QuestionSort.Creation;
o.SortDirection = SortDirection.Descending;

IPagedList<Question> l = client.GetQuestions(o); 
```

和

```
o.Max 
```

期望 Unix 纪元时间，而不是最大帖子数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-26T17:20:55.640

尝试将`StackyClient`构造函数中指定的版本从“0.9”更改为“1.1”。当版本为“0.9”时，我在线路上收到 JSON 解析错误`client.GetQuestions(o)`，但它在“1.1”时运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T23:47:41.443

[使用来自bitbucket](https://bitbucket.org/lfoust/stacky)的最新 Stacky 代码，GetQuestions 不再有 QuestionOptions 参数。同样使用 API 的 0.9 版本会导致 Stacky 崩溃，但根据[这个](http://api.stackexchange.com/)版本 1.x 已被弃用，所以也许 0.9 被删除了？

```
 StackyClient client = new StackyClient("2.1", Sites.StackOverflow,
        new UrlClient(), new JsonProtocol());
  //var o = new QuestionOptions();
  //o.FromDate = DateTime.Now.AddMinutes(-10.0);
  //o.ToDate = DateTime.Now;
  //o.IncludeAnswers = false;
  //o.IncludeBody = false;
  //o.IncludeComments = false;
  //o.SortBy = QuestionSort.Creation;
  //o.SortDirection = SortDirection.Descending;
  QuestionSort sort = QuestionSort.Creation;
  SortDirection sortDir = SortDirection.Descending;
  int page = 1;
  int pageSize = 100;
  DateTime fromDate = DateTime.Now.AddMinutes(-10.0);
  DateTime toDate = DateTime.Now;
  IPagedList<Question> l = client.GetQuestions(sort, sortDir, page, pageSize, fromDate, toDate);
  foreach (var question in l)
  {
    Console.WriteLine(question.Title);
  } 
```

或者，只需删除日期，看看是否有任何结果。

```
 IPagedList<Question> l = client.GetQuestions(sort, sortDir, page, pageSize);//, fromDate, toDate);
  foreach (var question in l)
  {
    Console.WriteLine(question.Title);
  } 
```

# gnuplot - 在 GNU Plot 中添加图例

> ID：16194188
> 
> 赞同：0
> 
> 时间：2013-04-24T14:08:33.410
> 
> 标签：gnuplot, gnu

我在 GNU 的同一张图中有一个带有六个不同颜色线的图。现在我的问题是描述图表右侧的每一行，即我必须添加图例。

什么命令对这个问题有用？例如：我必须添加图例作为附图： ![在此处输入图像描述](https://i.stack.imgur.com/NSAxh.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:11:13.803

启用图例

```
set key 
```

并为情节的每一行添加描述性标题。例如：

```
plot x title "simple x function", x**2 title "quadratic function" 
```

# php - 使用 PHP 的 SSL 破管

> ID：16194190
> 
> 赞同：2
> 
> 时间：2013-04-24T14:08:36.460
> 
> 标签：php

我的错误输出如下所示：

> PHP 警告：fwrite(): SSL: Broken pipe in /home/whitelot/public_html/webservies/mylastwishnew/apnstest.php 在第 89 行

然后对该资源的每次后续写入都会收到错误：

> PHP 警告：fwrite(): SSL: Broken pipe in /home/whitelot/public_html/webservies/mylastwishnew/apnstest.php 在第 89 行

它工作了一段时间，可能有几百条消息/有效负载，然后突然管道破裂，水流到地板上。

如果有一个很好的解决这个问题的方法，任何人都有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-17T01:33:11.420

我发现对 new SoapClient($url, $options); 使用 'keep_alive' => false 选项 解决了我的问题。似乎如果您不使用keep_alive = false，SOAP 连接会尝试重新使用以前的连接，该连接会被SSL 拒绝。见[https://bugs.php.net/bug.php?id=60329](https://bugs.php.net/bug.php?id=60329)

此外，请确保这不是 max_execution_time 或其他可能阻止 SSL 连接成功完成的限制的问题。

# recursion - 这段代码中的递归在哪里？

> ID：16194195
> 
> 赞同：0
> 
> 时间：2013-04-24T14:08:56.163
> 
> 标签：recursion, scheme

我正在自己研究Scheme，最近我遇到了这段代码：

```
((lambda (gcd) (gcd (12 8 gcd))
    (lambda(a b gcdnew)
        (if (= b 0)
        a
        (gcdnew b (modulo a b) gcdnew)))) 
```

作者说这个有递归。这是一个老话题，所以我无法联系他。那么它在哪里（=递归）？似乎第二个“lambda”作为值转到第一个“gcd”，所以我们的身体实际上是：

```
(gcdnew 8 4 gcdnew) 
```

那么，“gcdnew”作为“gcdnew”中的参数有什么意义呢？感谢帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:29:41.943

关键`gcdnew`在于它包含用于递归调用的函数。

`gcd`外部 lambda 通过获取一个函数 ( ) 并将其应用于 12 和 8 来设置递归，并将*相同的函数*作为第三个参数传递。
内部函数内部，`gcdnew`指的是内部函数本身，它通过 using 递归调用自身`gcdnew`，确保在递归中传递它（即自身）。

顺便说一句：有一个轻微的错字，因为你有太多的括号 - 它可能应该是

```
((lambda (gcd) (gcd 12 8 gcd))
   (lambda (a b gcdnew)
     (if (= b 0)
          a
         (gcdnew b (modulo a b) gcdnew)))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-10T12:39:15.190

这被称为 Y 组合器。

而且实际上可以在不支持显式递归的语言中使用它进行递归。（实际上你甚至不需要递归地定义它）

[http://mvanier.livejournal.com/2700.html](http://mvanier.livejournal.com/2700.html)

# c# - Metro UI 未更新

> ID：16194200
> 
> 赞同：0
> 
> 时间：2013-04-24T14:09:07.940
> 
> 标签：c#, xaml, microsoft-metro, c#-5.0

我刚刚开始使用 Metro 应用程序，但我遇到了调度程序未更新 UI 的问题。我的代码在下面请让我知道是什么问题？

```
public class Test : DependencyObject
{

    public static readonly DependencyProperty CurrentItemProperty =
       DependencyProperty.Register("NameOfPerson", typeof(string), typeof(Test), null);

    public String NameOfPerson
    {
        get
        {
            return (string)GetValue(CurrentItemProperty);
        }
        set
        {
            runmethod(value);
        }
    }

    public async void runmethod(String text)
    {
        await Dispatcher.RunAsync(Windows.UI.Core.CoreDispatcherPriority.Normal, () =>
        {
            SetValue(CurrentItemProperty, text);
        }
        );
    }
} 
```

在主页中，我有一个事件按钮单击，当触发更新文本框时。

```
private void Button_Click_2(object sender, RoutedEventArgs e)
    {
        Test t = new Test();
        t.NameOfPerson = "Hello Umar";
    } 
```

MainPage.xaml 看起来像这样

```
<Page
    x:Class="TestApplication.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TestApplication"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

<Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
       <Button Content="Button" HorizontalAlignment="Left" Margin="207,187,0,0"   VerticalAlignment="Top" Height="80" Width="255" Click="Button_Click_2"/>
       <TextBox x:Name="textB" Text="{Binding NameOfPerson}" HorizontalAlignment="Left" Height="80" Margin="730,187,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="307"/>

    </Grid>
</Page> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:24:39.703

如果您想要做的是让按钮刷新您的文本，您应该查看 MVVM 模式并让绑定更新您的 UI。

为此，您必须创建您的对象，在这种情况下，假设是一个人。

```
public class Person
{
    public string Name { get; set; }
} 
```

其次，您希望在视图模型中有一个人，您将使用您的按钮对其进行更新。视图模型将派生自 BindableBase，它是 Windows 应用商店应用程序的一部分，如果您要使用基本页面之类的东西。视图模型如下所示：

```
public class MainPageViewModel : BindableBase
{
    public MainPageViewModel()
    {

    }

    private Person person;
    public Person Person
    {
        get { return person; }
        set { SetProperty(ref person, value); }
    }

    public void LoadData()
    {
        Person = new Person() { Name = "Simple name" };
    }

    public void UpdatePerson()
    {
        Person.Name = "Updated Name";
        OnPropertyChanged("Person");
    }
} 
```

如果你没有 bindableBase，它看起来像这样：

```
 [Windows.Foundation.Metadata.WebHostHidden]
public abstract class BindableBase : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    protected bool SetProperty<T>(ref T storage, T value, [CallerMemberName] String propertyName = null)
    {
        if (object.Equals(storage, value)) return false;

        storage = value;
        this.OnPropertyChanged(propertyName);
        return true;
    }

    protected void OnPropertyChanged([CallerMemberName] string propertyName = null)
    {
        var eventHandler = this.PropertyChanged;
        if (eventHandler != null)
        {
            eventHandler(this, new PropertyChangedEventArgs(propertyName));
        }
    }
} 
```

在 MainPage 上创建 ViewModel 并在 Page 上设置 DataContext。此外，您还想在 Viewmodel 中处理您的对象，因此您将在单击将修改您的 Person 对象的按钮时创建一个更新方法：

```
public sealed partial class MainPage : Page
{
    private readonly MainPageViewModel viewModel;

    public MainPage()
    {
        this.InitializeComponent();
        viewModel = new MainPageViewModel();
        viewModel.LoadData();
        this.DataContext = viewModel;   
    }

    private void Button_Tapped(object sender, TappedRoutedEventArgs e)
    {
        viewModel.UpdatePerson();
    }
} 
```

最后，您在 UI 中的 TextBox 指向 Viewmodel 中 Person 的 name 属性：

```
 <TextBox
        x:Name="textB"
        Text="{Binding Person.Name}"
        HorizontalAlignment="Left"
        Height="80"
        Margin="730,187,0,0"
        TextWrapping="Wrap"
        VerticalAlignment="Top"
        Width="307" /> 
```

我希望这能解决您关于如何使用按钮更新 UI 的问题。

# mercurial - 如何向 Review Board (Mercurial) 提交一系列变更集？

> ID：16194202
> 
> 赞同：1
> 
> 时间：2013-04-24T14:09:15.800
> 
> 标签：mercurial, changeset, review-board

我想将一系列变更集作为一个变更集（补丁）提交到[Review Board](http://www.reviewboard.org/)。怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-01T10:37:41.847

将多个补丁组合成一个的技术术语是“折叠”。如果您想真正将一系列提交合并为一个（更改历史），那么[HistEdit](http://mercurial.selenic.com/wiki/HisteditExtension)扩展提供了一种与[Mercurial Queues](http://mercurial.selenic.com/wiki/MqExtension)一样的方法。

如果您只是对生成补丁感兴趣，那么您有几个选择。您可以使用`hg export`（但这不会将补丁折叠在一起，而是将一系列补丁转储到控制台）或者您可以使用`hg diff`来生成差异。更确切地说，

```
hg diff -r start:end > summary.patch 
```

`start`将为范围内的所有更改生成单个差异`end`。您可以替换`end`为`tip`以获取以 开头的所有更改`start`。如果两者之间存在合并变更集，这甚至应该有效。（`hg export`如果那里有合并变更集，则会产生奇数输出。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-28T12:59:51.620

我建议，由于您需要将一系列更改作为单个项目提交以供审核，因此您应该将最终结果与您开始进行更改的点或代码的最新版本（创建补丁）进行比较。然后将补丁、您所不同的版本的详细信息等附加到请求审查表中。

# javascript - Conditionally load external json into localStorage (as string)?

> ID：16194203
> 
> 赞同：4
> 
> 时间：2013-04-24T14:09:19.607
> 
> 标签：javascript, json, getjson

My test data is currently within my html such :

```
var jsonStatus = [ 
{ "myKey": "A", "status": 0, score: 1.5 },
{ "myKey": "C", "status": 1, score: 2.0 },
{ "myKey": "D", "status": 0, score: 0.2 },
{ "myKey": "E", "status": 1, score: 1.0 },
{ "myKey": "F", "status": 0, score: 0.4 },
{ "myKey": "G", "status": 1, score: 3.0 },
]; 
```

But my data will eventually be ~20.000 entries, so I wish to externalize it into a statusStarter.json file (local or external), that I load once at the apps first start. Once into the client localStorage I can read/write locally with ease! :] Also:

**1\. How to load externalized json into localStorage (as string) ?**

**2\. How to keep conditional ?** (avoid to reload each time)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:09:19.607

[http://jsfiddle.net/LyAcs/7/](http://jsfiddle.net/LyAcs/7/)

**Given a data.json file containing:**

```
[ 
{ "myKey": "A", "status": 0, "score": 1.5 },
{ "myKey": "C", "status": 1, "score": 2.0 },
{ "myKey": "D", "status": 0, "score": 0.2 },
{ "myKey": "E", "status": 1, "score": 1.0 },
{ "myKey": "F", "status": 0, "score": 0.4 },
{ "myKey": "G", "status": 1, "score": 3.0 }
] 
```

**The JS conditional function, with parametrable localStorage.target:**

```
function loadFileJSON( toLocalStorage, fromUrl){
    if (localStorage[toLocalStorage])
            { console.log("Good! Data already loaded locally! Nothing to do!");  }
    else {
        $.getJSON(   fromUrl   , function(data) { 
            localStorage[toLocalStorage] = JSON.stringify(data);
            console.log("Damn! Data not yet loaded locally! Ok: I'am loading it!");
        });
      }
    }
// Function's firing:
loadFileJSON( 'myData','http://mywebsite/path/data.json'); 
// should works w/ local folders as well 
```

* * *

**Read the data:** Your data is now in `localStorage.myData`, as a string. You can access it using:

```
var myJSON = JSON.parse(localStorage.myData);
//Read:
alert("Mister " + myJSON[3].myKey + ", your current score is "+ myJSON[3].score +"!"); 
```

Then and more interesting is the possibility to write this local data.

# php - Symfony2 默认数字格式

> ID：16194207
> 
> 赞同：2
> 
> 时间：2013-04-24T14:09:25.140
> 
> 标签：php, symfony

我想更改 Symfony 2 项目中的默认数字格式。

`10.55`而不是像我想将小数点分隔符显示为 comma那样打印数字`10,55`。

不在 Twig 模板中，而是在所有表单中。如果我想要的话，Twig 就像使用[number_format 函数](http://twig.sensiolabs.org/doc/filters/number_format.html)一样简单。

我已经在 config.yml 文件中设置了我的语言环境。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:56:27.120

您可能`number`在表单类型中使用了类型字段。

因此，您可以使用以下[`grouping`](http://symfony.com/doc/current/reference/forms/types/number.html#grouping)选项：

> [...] 数字将用逗号或句点分组（取决于您的区域设置）：12345.123 将显示为 12,345.123。

您的代码将如下所示：

```
// src/Acme/MyBundle/Form/Type/MyType.php
namespace Acme\MyBundle\Form\Type;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;

class MyType extends AbstractType
{
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder->add('mynumber', 'number', array('grouping' => true));
    }

    public function getName()
    {
        return 'my';
    }
} 
```

[`money`](http://symfony.com/doc/current/reference/forms/types/money.html)（使用字段类型时您有相同的选项）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-02-19T20:13:22.577

我还使用了“数字”字段类型，但从我可以测试的情况来看，不需要表单类型中的分组选项。在 twig 模板中渲染它就足够了：请参见下面的示例 where `{{ discount.discountRate }}`is a float。如果你用'75.3869'替换它，你会发现'75,39'

```
{# number with 2 decimal places, decimal comma, no thousands separator #}
{{ discount.discountRate|number_format(2, ',', '') }}% 
```

# excel - Excel VBA 拖放

> ID：16194208
> 
> 赞同：1
> 
> 时间：2013-04-24T14:09:28.090
> 
> 标签：excel, vba

我很难找到一个可行的解决方案（现在已经找了 2 天）。希望你能帮我弄清楚。

**目的**- 我正在尝试使用 VBA 在列表框之间拖放文本（见图）

![在此处输入图像描述](https://i.stack.imgur.com/8CaSn.jpg)

**注意**：我知道已经有 Pivot Wizards，我对它们不太感兴趣（长篇大论）

**问题** 您知道有什么解决方案可以帮助我将“A 列”移动到任何其他列表框吗？

如果您不知道解决方案，博客或网站也可能会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:27:23.347

除了我上面的评论之外，这是最简单的方法。

创建一个包含 2 个列表框和 1 个命令按钮的用户窗体，如下图所示。

![在此处输入图像描述](https://i.stack.imgur.com/fg8ob.png)

并将此代码粘贴到 Userform Code 区域

```
Dim i As Long

Private Sub UserForm_Initialize()
    For i = 1 To 10
        ListBox1.AddItem i
    Next i
End Sub

Private Sub CommandButton1_Click()
    If ListBox1.ListIndex = -1 Then
        MsgBox "Please select an item from listbox1"
        Exit Sub
    End If

    ListBox2.AddItem ListBox1.List(ListBox1.ListIndex)
    ListBox1.RemoveItem (ListBox1.ListIndex)
End Sub 
```

高温高压

# c# - wpf中的2方式绑定调用属性两次

> ID：16194211
> 
> 赞同：5
> 
> 时间：2013-04-24T14:09:29.420
> 
> 标签：c#, wpf, xaml, data-binding

我一直在使用 wpf 和 2 路数据绑定来更好地理解它，并且我注意到当一个文本框有 2 路数据绑定到一个属性时，该属性被调用了两次。我已经通过在调用属性时向输出窗口写入一个值来验证这一点。我的代码如下： -

我的 xml

```
<Page
    x:Class="_2waybindTest.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:_2waybindTest"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid Background="{StaticResource ApplicationPageBackgroundThemeBrush}">
        <TextBox HorizontalAlignment="Left" Margin="55,93,0,0" TextWrapping="Wrap" Text="{Binding TestProperty, Mode=TwoWay}" VerticalAlignment="Top" Width="540"/>
        <Button Content="Button" HorizontalAlignment="Left" Margin="55,31,0,0" VerticalAlignment="Top" Click="Button_Click_1"/>
        <TextBox HorizontalAlignment="Left" Margin="55,154,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="540"/>
    </Grid>
</Page> 
```

我要测试的简单视图模型类

```
public class viewmodel : INotifyPropertyChanged
{
    public event PropertyChangedEventHandler PropertyChanged;

    private string _TestProperty;

    public void SetTestProperty()
    {
        this.TestProperty = "Set Test Property";
    }

    public string TestProperty{
        get
        {
            return this._TestProperty;
        }
        set
        {
            this._TestProperty = value;

            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs("TestProperty"));
            }

            Debug.WriteLine("this._TestProperty = " + this._TestProperty);
        }
    }
} 
```

我的 xml 代码在后面

```
/// <summary>
/// An empty page that can be used on its own or navigated to within a Frame.
/// </summary>
public sealed partial class MainPage : Page
{
    public MainPage()
    {
        this.InitializeComponent();
        DataContext = new viewmodel();
    }

    /// <summary>
    /// Invoked when this page is about to be displayed in a Frame.
    /// </summary>
    /// <param name="e">Event data that describes how this page was reached.  The Parameter
    /// property is typically used to configure the page.</param>
    protected override void OnNavigatedTo(NavigationEventArgs e)
    {
    }

    private void Button_Click_1(object sender, RoutedEventArgs e)
    {
        var vm = (viewmodel)DataContext;
        vm.SetTestProperty();
    }
} 
```

为什么叫两次。这是预期的行为吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-24T14:13:23.767

通常，您应该在触发 propertyChanged 事件之前检查值是否实际更改，否则您可能会进入绑定更新的无限循环。在您的情况下，文本框可能正在检查更改，以防止这种循环。

```
public string TestProperty{
    set
    {
        if(this._TestProperty == value)
        {
            return;
        }

        this._TestProperty = value;

        if (PropertyChanged != null)
        {
            PropertyChanged(this, new PropertyChangedEventArgs("TestProperty"));
        }            
    }
} 
```

# r - 如何在 R 脚本中全局抑制警告

> ID：16194212
> 
> 赞同：200
> 
> 时间：2013-04-24T14:09:30.167
> 
> 标签：r, warnings

我有一个很长的 R 脚本，它会引发一些警告，我可以忽略。我可以使用

```
suppressWarnings(expr) 
```

对于单个语句。但是如何在全局范围内抑制 R 中的警告？有这个选项吗？

* * *

## 回答 #1

> 赞同：254
> 
> 时间：2013-04-24T14:15:37.413

你可以使用

```
options(warn=-1) 
```

但请注意，全局关闭警告消息可能不是一个好主意。

要重新打开警告，请使用

```
options(warn=0) 
```

（或任何您的默认设置`warn`，请参阅[此答案](https://stackoverflow.com/a/32719422/2093469)）

* * *

## 回答 #2

> 赞同：129
> 
> 时间：2015-09-22T14:20:11.310

你想要`options(warn=-1)`。但是，请注意，这`warn=0`不是最安全的警告级别，不应将其视为当前级别，尤其是在脚本或函数中。因此，暂时关闭警告的最安全方法是：

```
oldw <- getOption("warn")
options(warn = -1)

[your "silenced" code]

options(warn = oldw) 
```

* * *

## 回答 #3

> 赞同：62
> 
> 时间：2016-06-30T16:41:14.017

我现在已经用C 代码中的调用替换了`printf`调用。`warning`它将在明天晚上应该可用的版本 2.17.2 中生效。然后，您应该能够使用`suppressWarnings()`上述任何方法或任何其他方法来避免警告。

```
suppressWarnings({ your code }) 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-04-24T14:14:06.163

看看`?options`并使用`warn`：

```
options( warn = -1 ) 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2021-07-02T09:07:16.007

正如在其他答案中所讨论的，您可能想要设置 options(warn = -1) 并恢复到旧行为。这些`withr`包允许您设置选项值并自动恢复到旧行为。

```
# install.packages("withr")

withr::with_options(.new = list(warn = -1),
                    {code}) 
```

或者，在`local_*`包含它们的函数结束之前，这些函数具有相同的效果。

```
function() {
  withr::local_options(.new = list(warn = -1)

  { code }
} 
```

# c# - C# 隐藏表单但保持活动状态

> ID：16194213
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:09:31.780
> 
> 标签：c#, winforms

我正在运行一个控制台应用程序，该应用程序启动一个我想隐藏的表单，但它保持活动状态，以便它的作用（在按键上启动 .exe）继续工作。

这是我的代码不起作用：

```
Form1 f1 = new Form1();
f1.Show();
foreach (Form f in Application.OpenForms)
{
    if (f.Name == "Form1") 
        f.Hide();       
        //f.visible = false;
} 
```

并尝试在 Form_load 上设置隐藏或可见也不起作用......

有任何想法吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:23:32.117

我认为您正在尝试`WinForms`不正确地使用。它不是[金锤](http://sourcemaking.com/antipatterns/golden-hammer)。

> 这种反模式会导致对首选工具或概念的误用。开发人员和管理人员对现有方法感到满意，不愿意学习和应用更适合的方法。

![金锤](https://i.stack.imgur.com/wJ2qB.jpg)

`WinForms`不是为了在窗口不活动时接收键盘输入而设计的（我认为这是有充分理由的）。

你应该研究的是一个[`Global Keyboard Hook`](http://www.codeproject.com/Articles/19004/A-Simple-C-Global-Low-Level-Keyboard-Hook).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T15:07:46.113

this did it, hides form well and stays active.

this.WindowState=FormWindowState.Minimized; this.ShowInTaskbar = false

# google-chrome - 如何强制 Chrome 预呈现更多页面？

> ID：16194216
> 
> 赞同：3
> 
> 时间：2013-04-24T14:09:39.597
> 
> 标签：google-chrome, google-chrome-extension, google-nativeclient

我正在学习 Chrome 和 Native Client。
基本上我想增加
由 chrome 预渲染的页面数量（现在它只有一页）。

我正在考虑创建一个
允许预渲染更多页面的扩展。

这是一种可行的方法，还是我将其硬编码到 Chrome 中并从头开始构建？

**编辑**
我为这个问题开始了赏金。我真的很感激一些意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-05-01T05:52:59.023

不，没有办法，您需要在 Chrome 中对其进行硬编码并按照您的说明进行重建。

您可能已经知道，[Chrome 明确声明](https://developers.google.com/chrome/whitepapers/prerender#debug)他们目前限制了可以[预渲染](http://www.chromium.org/developers/design-documents/prerender)的页面数量：

> 每个 Chrome 实例最多只能预呈现一个 URL（不是每个选项卡一个）。在某些情况下，此限制将来可能会发生变化。

他们[支持的 API](http://developer.chrome.com/extensions/api_index.html)或他们的[实验性 API](http://developer.chrome.com/extensions/experimental.html)中没有任何内容可以让您访问修改它。目前在 Chrome 中`chrome://settings/`或`chrome://flags/`其他任何地方都没有允许您更改此设置的切换。但是，您可以使用[Page Visibility API](https://developers.google.com/chrome/whitepapers/pagevisibility)来确定是否正在预呈现页面。

除了您使用指定的页面上的一个资源之外，您`<link rel="prerender" href="http://example.org/index.html">`还可以考虑[预取](http://www.whatwg.org/specs/web-apps/current-work/multipage/links.html#link-type-prefetch)资源。

预取的问题是它只会加载指定 URL 的顶级资源。因此，如果您尝试预取其他页面，如下所示：

```
<link rel="prefetch" href="http://example.org/index.html"> 
```

...那么只会`index.html`预取资源，而不是文档中包含的所有 CSS 和 JavaScript 链接。一种方法是为页面中包含的所有资源写出`link`标签，但这可能会变得混乱且难以维护。

另一种方法是等待当前页面完成加载，然后使用[JavaScript 创建一个 iframe](http://feeding.cloud.geek.nz/posts/prefetching-resources-to-prime-browser/)，它隐藏在页面之外，针对您要预取所有资产的 URL。然后，浏览器将加载 URL 的所有内容，并且当用户访问该页面时，它会在用户的缓存中。

还有一个[Chrome 扩展程序](https://chrome.google.com/webstore/detail/prefetch-link-rel/lcgjcablhbecaaheaiebnjingaocdmdf?hl=en)通过搜索`link`定义 a 的标签来结合这两种方法`prefetch`，然后创建隐藏的 iframe，从而导致资产被下载和缓存。

如果目标是针对浏览您的站点优化客户端性能，可能还有其他替代方案，例如创建使用[单页应用程序 (SPA)](http://en.wikipedia.org/wiki/Single-page_application)开发风格的 Web 应用程序，以减少加载和执行 JS 和 CSS 的次数。如果您是 Google 的粉丝，那么您可以查看他们用于构建称为[AngularJs](http://angularjs.org/)的 SPA 的框架。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-27T11:22:58.443

如果预渲染更多页面是个好主意，Chrome 可能已经这样做了。预渲染太多页面会耗尽网站带宽，最终可能会减慢整个网络的速度，这与您想要实现的目标相反。所以很可能是故意的，你只能预渲染一个页面，你不应该尝试破坏它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-26T15:31:48.703

不可能。Chrome 管理基于许多因素的预渲染。如果这是可能的，它也很容易被许多网站滥用。根据您的页面，您可以将所有内容保留在一页上。

# ruby - 访问 Ruby 哈希变量

> ID：16194219
> 
> 赞同：21
> 
> 时间：2013-04-24T14:09:53.390
> 
> 标签：ruby, hash, sinatra

我对 ruby​​ 和 sinatra 很陌生，但基本上我有这条路线：

```
put '/user_list/:user_id' do
    puts request.params["model"]
end 
```

它返回以下内容

```
{"password":"36494092d7d5682666ac04f62d624141","username":"nicholas","user_id":106,"firstname":"Nicholas","email":"nicholas@macpractice.com","is_admin":0,"lastname":"Rose","privileges":""} 
```

我现在很难访问其中每一个的值。它似乎不是哈希格式，所以我真的做不到

```
request.params["model"][:password] 
```

它只是返回零..

我只需要知道我可以做些什么来访问这些变量，或者如何将我的请求参数配置为访问变量的良好格式。

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-04-24T14:12:12.380

尝试`request.params["model"]["password"]`

A`Hash`的键可以由符号和字符串组成。但是，字符串键与符号键不同。

请注意以下事项：

```
h = {:name => 'Charles', "name" => 'Something else'}
h[:name] #=> 'Charles'
h["name"] #=> 'Something else' 
```

**编辑：**

在您的特定情况下，它似乎`request.params["model"]`返回一个字符串而不是哈希。有一种方法[`String#[]`](http://www.ruby-doc.org/core-1.9.3/String.html#method-i-5B-5D)是获取子字符串的方法。

```
s = "Winter is coming"
s["Winter"] #=> "Winter"
s["Summer"] #=> nil 
```

这将解释您的评论。

您可以采取一些措施来纠正您的具体情况。我找到了最简单的使用方法`JSON`。（我敢肯定还有其他人，也许这些会通过其他答案或评论浮出水面。）

```
require 'json'
hash_of_params = JSON.load(request.params["model"]).to_hash
hash_of_params["password"] #=> "36494092d7d5682666ac04f62d624141" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T14:15:41.277

标准哈希对字符串和符号的处理方式不同，我敢打赌这就是这种情况下发生的事情。

用于`request.params["model"]["password"]`获取密码。

例外情况是使用[`HashWithIndifferentAccess`](http://api.rubyonrails.org/classes/ActiveSupport/HashWithIndifferentAccess.html)ActiveSupport 的一部分时。对于该类型的哈希，可以使用字符串或符号来访问相同的元素。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:28:59.173

试试下面的，它也可以工作：

```
request.params["model"][:password.to_s] 
```

# c# - Json序列化没有关系的EF对象

> ID：16194220
> 
> 赞同：2
> 
> 时间：2013-04-24T14:09:56.467
> 
> 标签：c#, asp.net-mvc, entity-framework, json.net

我正在尝试将 Json 序列化 EF 对象存储在另一个数据库中。

我要存储的物品之一是购物车，其中有一些相关的表格。

我怎样才能存储购物车，而不用拖拽它的关系（最好不要诉诸 .Select() 来挑选不同的列）

```
[AllowAnonymous]
public ActionResult Test() {

    using (var db = new DALEntities())
    {
        var q = db.tblCarts.SingleOrDefault(x => x.CartItemID == 4275);

        q.tblContactsExtra = null;
        q.TBLINVENTORY = null;

        var settings = new JsonSerializerSettings {PreserveReferencesHandling = PreserveReferencesHandling .Objects} ;

        var str = JsonConvert.SerializeObject(q, settings);

        return Content(str);
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:32:22.903

不幸的是，您必须将外键设置为允许空值。否则，您将无法实现您想要实现的目标。为此，只需将 ID 字段设为可为空，例如：

```
public int? ContactsExtraId { get; set; }
public virtual tblContactsExtra tblContactsExtra { get; set; }

public int? InventoryId { get; set; }
public virtual TblInventory TBLINVENTORY { get; set; } 
```

# javascript - 通过浏览器本机上下文菜单粘贴自定义 div

> ID：16194221
> 
> 赞同：0
> 
> 时间：2013-04-24T14:09:57.920
> 
> 标签：javascript, contextmenu, copy-paste

我有一个`<div>`块，我希望用户能够通过浏览器本机上下文菜单粘贴数据。`contenteditable="true"`不是一个可接受的解决方案。`Ace editor`( [http://ace.ajax.org/build/kitchen-sink.html](http://ace.ajax.org/build/kitchen-sink.html) ) 将`<textarea>`鼠标光标放在`mousedown`事件上。我试图做这样的事情：

```
<div class="container">
 <div id="editor"></div>
 <textarea id="paste-container"></textarea>
</div> 
```

```
#container {
 position: relative;
}

#editor {
 width: 100px;
 height: 100px;
}

#paste-container {
 position: absolute;
 width: 100px;
 height: 100px;
 display: none;
 opacity: 0;
} 
```

```
var editor = document.querySelector('#editor'),
    paste = document.querySelector('#paste-container');

editor.onmousedown = function () {
 paste.style.display = "block";
 setTimeout(function () {
  paste.style.display = "none";
 }, 0);
} 
```

但我没有得到 textarea 的菜单。请告诉我，如何以这种方式获取用户的粘贴数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T06:06:24.180

所以我找到了解决方案。您需要为事件设置`<textarea>`选择`contextmenu`。像这样的东西：

```
editor.onmousedown = function () {
 paste.style.display= 'block';
};

editor.onmouseup = function() {
 setTimeout(function () {
  paste.style.display = 'none';
 }, 0);
};

editor.oncontextmenu = function () {
 paste.setSelectionRange(0, 0);
}; 
```

# java - 是否可以使用 GSON 将带有句点的 JSON 属性名称反序列化为嵌套对象？

> ID：16194227
> 
> 赞同：5
> 
> 时间：2013-04-24T14:10:09.027
> 
> 标签：java, gson

这是我尝试使用 GSON 使用的 JSON 类型的示例：

```
{
    "person": {
        "name": "Philip"
        "father.name": "Yancy"
    }
} 
```

我想知道是否可以将此 JSON 反序列化为以下结构：

```
public class Person
{
    private String name;
    private Father father; 
}

public class Father
{
    private String name;
} 
```

以便：

```
p.name == "Philip"
p.father.name == "Yancy" 
```

目前我正在使用`@SerializedName`获取包含句点的属性名称，例如：

```
public class Person
{
    private String name;

    @SerializedName("father.name")
    private String fathersName; 
} 
```

然而，这并不理想。

从查看文档来看，这似乎不是立即可行的，但我可能错过了一些东西——我是使用 GSON 的新手。

不幸的是，我无法更改我正在使用的 JSON，并且我不愿意切换到另一个 JSON 解析库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:31:43.697

据我了解，您不能*直接*这样做，因为 Gson 将理解`father.name`为单个字段。

您需要编写自己的**Custom Deserializer**。[**请参阅此处**](https://sites.google.com/site/gson/gson-user-guide#TOC-Writing-a-Deserializer)的 Gson 用户指南说明。

我从来没有尝试过，但它似乎并不难。这篇[**文章**](https://stackoverflow.com/questions/6096940/how-do-i-write-a-custom-json-deserializer-for-gson)也可能会有所帮助。

看看 Gson 的用户指南和那篇文章中的代码，你需要这样的东西：

```
private class PersonDeserializer implements JsonDeserializer<Person> {

  @Override
  public Person deserialize(JsonElement json, Type type,
        JsonDeserializationContext context) throws JsonParseException {

    JsonObject jobject = (JsonObject) json;

    Father father = new Father(jobject.get("father.name").getAsString());

    return new Person(jobject.get("name").getAsString(), father);
  }  
} 
```

假设您有合适的构造函数...

进而：

```
GsonBuilder gsonBuilder = new GsonBuilder();
gsonBuilder.registerTypeAdapter(Person.class, new PersonDeserializer());
Gson gson = gsonBuilder.create();
Person person = gson.fromJson(jsonString, Person.class); 
```

Gson 将调用您的反序列化器，以便将 JSON 反序列化为`Person`对象。

*注意：我没有尝试这段代码，但它应该是这样或非常相似的。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-16T09:25:08.807

我不能只用 Gson 做到这一点。我需要一个新库“JsonPath”。我使用 Jackson 的 ObjectMapper 将对象转换为字符串，但您可以轻松地使用 Gson。

```
public static String getProperty(Object obj, String prop) {
    try {
        return JsonPath.read(new ObjectMapper().writeValueAsString(obj), prop).toString();
    } catch (JsonProcessingException|PathNotFoundException ex) {
        return "";
    }
}

// 2 dependencies needed:
// https://mvnrepository.com/artifact/com.fasterxml.jackson.core/jackson-core
// https://mvnrepository.com/artifact/com.jayway.jsonpath/json-path

// usage:
String motherName = getProperty(new Person(), "family.mother.name");

// The Jackson can be easily replaced with Gson:
new Gson().toJson(obj) 
```

# javascript - 如何使用 JavaScript 暂停 HTML5 视频？

> ID：16194228
> 
> 赞同：7
> 
> 时间：2013-04-24T14:10:09.590
> 
> 标签：javascript, jquery, html5-video

最初视频是隐藏的。当您单击带有 ID 的图像时`3`，视频是可见的。我放了一个带有 ID 的按钮`close_video`来隐藏播放器。问题是单击按钮后它仍在运行视频。如何暂停视频？

代码是：

```
<div id="video" class="popup-video">
  <div class="video">
    <div class="close_video" id="close_video">
    </div>
    <video id="id_video" width="400" height="257" controls="controls" preload="auto">
      <source src="{$content_dir}themes/trendy/video/Wildlife.mp4" type="video/mp4"/>     
    </video>                         
  </div>
</div>  

<script>
  $(document).ready(function(){
    $('#3').click(function(){
      $("#video").removeClass("popup-video").addClass("popup-video-show");
    });
  });
</script>
<script>
  $(document).ready(function(){
    $('#close_video').click(function(){
      $("#video").removeClass("popup-video-show").addClass("popup-video");
    });
  });
</script> 
```

我也试过这个：

```
<script>
  $(document).ready(function(){
    $('#close_video').click(function(){
      $("#video").removeClass("popup-video-show").addClass("popup-video");
      document.getElementById('id_video').pause();
      // and $("#id_video").pause();
    });
  });
</script> 
```

还是没有效果。视频消失了，但仍在播放。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-24T14:16:28.690

使用 jQuery 时，您需要先使用“get”：

```
$('#videoId').get(0).pause() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:15:38.353

通常，您只需单击视频即可暂停/播放。

而不是使用`pause()`try 使用`click()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-31T14:07:26.447

使用 HTML5 时，请使用：

```
document.getElementById(\"movie_player\").click() 
```

这个对我有用。

# php - PHP：如何修复嵌套数组

> ID：16194237
> 
> 赞同：0
> 
> 时间：2013-04-24T14:10:39.780
> 
> 标签：php, arrays, multidimensional-array

我整晚都在为这个嵌套数组苦苦挣扎，所以我最终决定在这方面寻求一些帮助。我正在尝试将下面的嵌套数组更正为其他内容。请回复代码示例/解决方案。我不是最好的 PHP 程序员。谢谢大家！

**我希望它看起来像什么：**

```
array
  0 => 
      'enginename' => string 'Engine1' (length=19)
      'status' => string 'up' (length=2)
      'time' => string '2013-04-17 09:28:00' (length=19)
  1 => 
      'enginename' => string 'Engine2' (length=19)
      'status' => string 'up' (length=2)
      'time' => string '2013-04-17 09:28:00' (length=19) 
```

**它目前的样子：**

```
Writing data... 
The total # of columns in this query are: 3 
The length of the first array is: 363 
array
  0 => 
    array
      0 => 
        array
          'enginename' => string 'Engine1' (length=19)
      1 => 
        array
          'status' => string 'up' (length=2)
      2 => 
        array
          'time' => string '2013-04-17 09:28:00' (length=19)
  1 => 
    array
      3 => 
        array
          'enginename' => string 'Engine2' (length=20)
      4 => 
        array
          'status' => string 'up' (length=2)
      5 => 
        array
          'time' => string '2013-04-17 09:28:00' (length=19)
  2 => 
    array
      6 => 
        array
          'enginename' => string 'Engine3' (length=30)
      7 => 
        array
          'status' => string 'up' (length=2)
      8 => 
        array
          'time' => string '2013-04-17 09:28:00' (length=19) 
```

**更新 4/24 上午 10:26:: bwoebi 的示例输出** 这很好，谢谢，但不是 100% 我需要的。它删除了嵌套数组，但也再次分离了所有键。我需要一个“组”中的前 3 个键，就像我原来的示例所示。

```
array
  0 => 
    array
      'enginename' => string 'Engine1' (length=19)
  1 => 
    array
      'status' => string 'up' (length=2)
  2 => 
    array
      'time' => string '2013-04-17 09:28:00' (length=19)
  3 => 
    array
      'enginename' => string 'Engine2' (length=20)
  4 => 
    array
      'status' => string 'up' (length=2)
  5 => 
    array
      'time' => string '2013-04-17 09:28:00' (length=19)
  6 => 
    array
      'enginename' => string 'Engine3' (length=30)
  7 => 
    array
      'status' => string 'up' (length=2)
  8 => 
    array
      'time' => string '2013-04-17 09:28:00' (length=19) 
```

**更新 4/24 上午 10:36:: bwoebi 的更正示例输出**

```
array
  0 => 
    array
      'enginename' => string 'Engine1' (length=19)
      'status' => string 'up' (length=2)
      'time' => string '2013-04-17 09:28:00' (length=19)
  1 => 
    array
      'enginename' => string 'Engine2' (length=20)
      'status' => string 'up' (length=2)
      'time' => string '2013-04-17 09:28:00' (length=19)
  2 => 
    array
      'enginename' => string 'Engine3' (length=30)
      'status' => string 'up' (length=2)
      'time' => string '2013-04-17 09:28:00' (length=19) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:13:18.913

```
foreach ($array as &$oldArray) {
    $newArray = array();
    foreach ($oldArray as $subArray)
        $newArray += $subArray;
    $oldArray = $newArray;
} 
```

这在您的密钥并非每次都从零开始的情况下有效（如您的示例数组所示）。如果他们这样做，请使用`array_merge`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:18:18.547

你可以试试

```
$array = array_map(function ($v) {
    return array_map("current", $v);
}, $array);

print_r($array); 
```

输出

```
Array
(
    [0] => Array
        (
            [0] => Engine1
            [1] => up
            [2] => 2013-04-17 09:28:00
        )

    [1] => Array
        (
            [0] => Engine2
            [1] => up
            [2] => 2013-04-17 09:28:00
        )

    [2] => Array
        (
            [0] => Engine3
            [1] => up
            [2] => 2013-04-17 09:28:00
        )

) 
```

[现场演示](http://eval.in/17456)

# php - Preg_replace 语法在与空格一起使用时不起作用

> ID：16194240
> 
> 赞同：1
> 
> 时间：2013-04-24T14:10:40.813
> 
> 标签：php, regex, preg-replace

我正在尝试对使用 file_get_contents 从文件接收的内容使用 preg_replace

```
preg_replace("/\/\/data(.*?)\/\/enddata/i",$string,$contents);

$string = 'data new '; 
```

// 这里的内容有白色间距

```
$contents = '

//data
//enddata'; 
```

事情是 preg_replace 正在执行但没有更新:)

有什么想法吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:21:52.977

使用 /is 有助于在替换后返回值:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:13:56.950

`.``s`除非您通过添加修饰符明确告诉它，否则不匹配换行符。

另外，尝试使用不同的分隔符。我个人的偏好是括号，因为它们永远不需要转义，即使模式中有更多的括号:)

```
"(//data(.*?)//enddata)is" 
```

# haskell - 在haskell的列表理解中使用条件

> ID：16194246
> 
> 赞同：4
> 
> 时间：2013-04-24T14:10:49.070
> 
> 标签：haskell, list-comprehension, higher-order-functions

我想使用列表理解仅打印 true

```
listTo::(a->b)->[a]->[b]
listTo f list=[f(x)|x<-list,x==True]

isTrue::Int->Bool
isTrue n
    |n>=5 =True
    |n<5 =False

listTo isTrue[1,2,3,4,5,6,7] 
```

但这不起作用。为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T14:16:51.533

你真的应该考虑使用`filter`，像这样：

```
filter isTrue [1,2,3,4,5,6,7] 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-25T00:28:44.873

```
[f(x)|x<-list,x==True] 
```

这表示“给我一个`f x`¹的列表，其中`x`来自`list`并且`x`等于`True`。

但是对于您的情况，您已`list`作为数字列表传递。看起来您只想包含那些`f x`返回的数字`True`。因此，与其比较`x`和`True`发射`f x`，你应该做相反的事情。更像是：

```
[x | x <- list, f x == True] 
```

但我们可以进一步改进这一点。`==`是一个函数，它接受两个参数，`True`如果它们相等则返回，如果不相等则返回`False`。所以`f x == True`将返回`True`if `f x`is`True`和`False`if `f x`is `False`。似乎是在浪费精力；你可以写`f x`！

```
[x | x <- list, f x] 
```

这就是你如何使用列表推导来做到这一点。但正如邮递员所指出的，已经有一个标准库函数可以做到这一点：`filter`. 如果您正在编写代码来完成工作，而不是学习事物的工作原理，那么这就是您将使用的。

* * *

¹请注意，`f(x)`它只是被解析为`f`应用于带括号的子表达式`(x)`。用括号括起来`x`什么都不做，所以这完全等同于`f x`. Haskell 的函数应用语法与**C 不同**，`function(arg1, arg2, arg3)`而是`function arg1 arg2`在函数之后简单地写出参数（必要时用空格分隔）。括号*仅*用于控制优先级和形成元组。如果您开始尝试通过在参数列表周围放置括号来调用多个参数的函数，那么您将遇到更多错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T14:16:44.420

中`listTo`，`list`有类型`[a]`。因此`x`有类型`a`。但是你在比较`x == True`，这意味着`x`应该有类型`Bool`- 矛盾。

如果将类型签名更改为`listTo :: (Bool -> b) -> [Bool] -> [b]`，它将编译。但是，您将无法将它与`listTo isTrue [1,2,3,4,5,6,7]`as `[1,2,3,4,5,6,7]`is 显然不是 type一起使用`[Bool]`。

我并不完全清楚这段代码应该做什么，但你应该考虑使用`map`or `filter`。

# html - Django - 从列表列表创建表

> ID：16194247
> 
> 赞同：1
> 
> 时间：2013-04-24T14:10:49.537
> 
> 标签：html, django, django-templates

我对 html 中的表格不太擅长，所以这个问题可能很容易回答。

我将列表列表传递`{{ attributes }}`给模板，我想创建一个包含 2 行和多列的表。

**模板：**

```
<div id="table">
<table border=0>
{% for attr in attributes %}
    <td>
       <th>{{ attr.0 }}</th>
        {{ attr.1 }}
    </td>
{% endfor %}
</table>
</div> 
```

我希望`{{ attr.0 }}`成为标题并显示在单行上并`{{ attr.1 }}`显示在第二行上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:19:10.450

怎么样

```
<div id="table">
<table border=0>
<thead>
    <tr>
    {% for attr_head in attributes.keys %}
       <th>{{ attr_head }}</th>
    {% endfor %}
    </tr>
</thead>
<tbody>
    <tr>
    {% for attr in attributes.values %}
        <td>{{ attr }}</td>
    {% endfor %}
    </tr>
</tbody>
</table>
</div> 
```

只需遍历字典的键并将它们呈现为`th`表头中的元素，然后遍历值，将它们呈现在`tbody`. `th`和`td`是表中的列和`tr`行。

另外，您应该阅读[html 表格](http://www.w3schools.com/html/html_tables.asp)，它们并不难

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:21:18.017

您可以循环两次，一次用于标题，一次用于内容？

```
<div id="table">
    <table border=0>
        <tr>
            {% for attr in attributes %}  
            <th>{{ attr.0 }}</th>
            {% endfor %}
        </tr>
        <tr>
            {% for attr in attributes %}
                <td>{{ attr.1 }}</td>
            {% endfor %}
        </tr>
    </table>
</div> 
```

# cuda - 如何使用 CUDA GFLOPs/Watt 对 GPU 进行基准测试

> ID：16194252
> 
> 赞同：0
> 
> 时间：2013-04-24T14:11:08.083
> 
> 标签：cuda, gpu, nvidia, measurement

我想知道在特定应用程序上使用 CUDA 对 GPU 进行基准测试以获得准确的 GFLOPs/Watt 曲线的最佳方法是什么。

所以我想运行一个内核并获取 FLOP/Watt 数据来绘制，以及如何有效地做到这一点。

谢谢

# java - 启动码头服务器时出现 NoClassDefFoundError

> ID：16194256
> 
> 赞同：10
> 
> 时间：2013-04-24T14:11:18.920
> 
> 标签：java, linux, spring, jetty

我正在尝试在码头服务器中托管我的 webapp（spring）。我将我的战争文件复制到码头服务器中的“webapp”文件夹中。我不是试图嵌入码头服务器，而是试图在码头内托管应用程序（如 tomcat）。

我尝试安装码头，我刚刚下载了 jetty7 zip 并解压缩以获取服务器。

我需要在 3 台 linux 机器上进行设置。在一台机器上，服务器启动得很好。没有问题。

但在另外两个中，当服务器启动时，它显示以下错误。

```
2013-04-24 18:52:59.540:INFO::started oejwWebAppContext{/cpewebapp,file:/tmp/jetty-0.0.0.0-9080-cpewebapp.war-_cpewebapp-any-/webapp/},/home/manooja /jetty-hightide-7.4.0.v20110414/webapps/cpewebapp.war
2013-04-24 18:52:59.648:WARN::FAILED spring: java.lang.NoClassDefFoundError: org/springframework/web/context/support/DefaultWebEnvironment
2013-04-24 18:52:59.648:WARN::FAILED oejwWebAppContext{/cpewebapp,file:/tmp/jetty-0.0.0.0-9080-cpewebapp.war-_cpewebapp-any-/webapp/},/home/manooja /jetty-hightide-7.4.0.v20110414/webapps/cpewebapp.war: java.lang.NoClassDefFoundError: org/springframework/web/context/support/DefaultWebEnvironment
2013-04-24 18:52:59.649:WARN::Unable to reach node goal: 开始
java.lang.NoClassDefFoundError: org/springframework/web/context/support/DefaultWebEnvironment
    在 org.springframework.web.servlet.HttpServletBean.(HttpServletBean.java:90)
    在 org.springframework.web.servlet.FrameworkServlet.(FrameworkServlet.java:96)
    在 org.springframework.web.servlet.DispatcherServlet.(DispatcherServlet.java:128)
    在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    在 sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    在 java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    在 java.lang.Class.newInstance0(Class.java:372)
    在 java.lang.Class.newInstance(Class.java:325)
    在 org.eclipse.jetty.servlet.ServletContextHandler$Context.createServlet(ServletContextHandler.java:606)
    在 org.eclipse.jetty.servlet.ServletHolder.newInstance(ServletHolder.java:748)
    在 org.eclipse.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:426)
    在 org.eclipse.jetty.servlet.ServletHolder.doStart(ServletHolder.java:260)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.servlet.ServletHandler.initialize(ServletHandler.java:763)
    在 org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:245)
    在 org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1158)
    在 org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:587)
    在 org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:436)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:36)
    在 org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:180)
    在 org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:482)
    在 org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:135)
    在 org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:137)
    在 org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:50)
    在 org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:601)
    在 org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:531)
    在 org.eclipse.jetty.util.Scanner.scan(Scanner.java:394)
    在 org.eclipse.jetty.util.Scanner.doStart(Scanner.java:329)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:114)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:543)
    在 org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:218)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:41)
    在 org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:50)
    在 org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:94)
    在 org.eclipse.jetty.server.Server.doStart(Server.java:253)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1220)
    在 java.security.AccessController.doPrivileged（本机方法）
    在 org.eclipse.jetty.xml.XmlConfiguration.main(XmlConfiguration.java:1143)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    在 java.lang.reflect.Method.invoke(Method.java:601)
    在 org.eclipse.jetty.start.Main.invokeMain(Main.java:477)
    在 org.eclipse.jetty.start.Main.start(Main.java:623)
    在 org.eclipse.jetty.start.Main.parseCommandLine(Main.java:273)
    在 org.eclipse.jetty.start.Main.main(Main.java:81)
造成的：
java.lang.ClassNotFoundException：org.springframework.web.context.support.DefaultWebEnvironment
    在 java.net.URLClassLoader$1.run(URLClassLoader.java:366)
    在 java.net.URLClassLoader$1.run(URLClassLoader.java:355)
    在 java.security.AccessController.doPrivileged（本机方法）
    在 java.net.URLClassLoader.findClass(URLClassLoader.java:354)
    在 java.lang.ClassLoader.loadClass(ClassLoader.java:423)
    在 java.lang.ClassLoader.loadClass(ClassLoader.java:356)
    在 org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:420)
    在 org.eclipse.jetty.webapp.WebAppClassLoader.loadClass(WebAppClassLoader.java:373)
    在 org.springframework.web.servlet.HttpServletBean.(HttpServletBean.java:90)
    在 org.springframework.web.servlet.FrameworkServlet.(FrameworkServlet.java:96)
    在 org.springframework.web.servlet.DispatcherServlet.(DispatcherServlet.java:128)
    在 sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    在 sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    在 sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    在 java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    在 java.lang.Class.newInstance0(Class.java:372)
    在 java.lang.Class.newInstance(Class.java:325)
    在 org.eclipse.jetty.servlet.ServletContextHandler$Context.createServlet(ServletContextHandler.java:606)
    在 org.eclipse.jetty.servlet.ServletHolder.newInstance(ServletHolder.java:748)
    在 org.eclipse.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:426)
    在 org.eclipse.jetty.servlet.ServletHolder.doStart(ServletHolder.java:260)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.servlet.ServletHandler.initialize(ServletHandler.java:763)
    在 org.eclipse.jetty.servlet.ServletContextHandler.startContext(ServletContextHandler.java:245)
    在 org.eclipse.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1158)
    在 org.eclipse.jetty.server.handler.ContextHandler.doStart(ContextHandler.java:587)
    在 org.eclipse.jetty.webapp.WebAppContext.doStart(WebAppContext.java:436)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.deploy.bindings.StandardStarter.processBinding(StandardStarter.java:36)
    在 org.eclipse.jetty.deploy.AppLifeCycle.runBindings(AppLifeCycle.java:180)
    在 org.eclipse.jetty.deploy.DeploymentManager.requestAppGoal(DeploymentManager.java:482)
    在 org.eclipse.jetty.deploy.DeploymentManager.addApp(DeploymentManager.java:135)
    在 org.eclipse.jetty.deploy.providers.ScanningAppProvider.fileAdded(ScanningAppProvider.java:137)
    在 org.eclipse.jetty.deploy.providers.ScanningAppProvider$1.fileAdded(ScanningAppProvider.java:50)
    在 org.eclipse.jetty.util.Scanner.reportAddition(Scanner.java:601)
    在 org.eclipse.jetty.util.Scanner.reportDifferences(Scanner.java:531)
    在 org.eclipse.jetty.util.Scanner.scan(Scanner.java:394)
    在 org.eclipse.jetty.util.Scanner.doStart(Scanner.java:329)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.deploy.providers.ScanningAppProvider.doStart(ScanningAppProvider.java:114)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.deploy.DeploymentManager.startAppProvider(DeploymentManager.java:543)
    在 org.eclipse.jetty.deploy.DeploymentManager.doStart(DeploymentManager.java:218)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.util.component.AggregateLifeCycle.doStart(AggregateLifeCycle.java:41)
    在 org.eclipse.jetty.server.handler.AbstractHandler.doStart(AbstractHandler.java:50)
    在 org.eclipse.jetty.server.handler.HandlerWrapper.doStart(HandlerWrapper.java:94)
    在 org.eclipse.jetty.server.Server.doStart(Server.java:253)
    在 org.eclipse.jetty.util.component.AbstractLifeCycle.start(AbstractLifeCycle.java:58)
    在 org.eclipse.jetty.xml.XmlConfiguration$1.run(XmlConfiguration.java:1220)
    在 java.security.AccessController.doPrivileged（本机方法）
    在 org.eclipse.jetty.xml.XmlConfiguration.main(XmlConfiguration.java:1143)
    在 sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    在 sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    在 sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    在 java.lang.reflect.Method.invoke(Method.java:601)
    在 org.eclipse.jetty.start.Main.invokeMain(Main.java:477)
    在 org.eclipse.jetty.start.Main.start(Main.java:623)
    在 org.eclipse.jetty.start.Main.parseCommandLine(Main.java:273)
    在 org.eclipse.jetty.start.Main.main(Main.java:81)
2013-04-24 18:52:59.654:INFO::Deployable 添加：/home/manooja/jetty-hightide-7.4.0.v20110414/webapps/root
2013-04-24 18:52:59.849:INFO::started oejwWebAppContext{/,file:/home/manooja/jetty-hightide-7.4.0.v20110414/webapps/root/},/home/manooja/jetty-hightide -7.4.0.v20110414/webapps/root
2013-04-24 18:52:59.861:INFO::Deployment monitor /home/manooja/jetty-hightide-7.4.0.v20110414/contexts 间隔 1
2013-04-24 18:52:59.950:INFO::Started SelectChannelConnector@0.0.0.0:9080 开始

```

请注意，默认端口已更改为 9080。

我有一种预感，它可能是一些配置更改，因为它在一台机器上运行良好。你能帮我指导解决这个问题吗？

> **java -jar start.jar --version**

```
    活动选项：[服务器、客户端、ext、jmx、jsp、资源、websocket]
    类路径中 25 个条目的版本信息。
    注意：此处显示的顺序是它们在类路径中的显示方式。
          对 OPTIONS=[option,option,...] 命令行选项的更改将在此处反映出来。
     0：9.0.2.v20130417 | ${jetty.home}/lib/jetty-xml-9.0.2.v20130417.jar
     1：3.0.0.v201112011016 | ${jetty.home}/lib/servlet-api-3.0.jar
     2：9.0.2.v20130417 | ${jetty.home}/lib/jetty-http-9.0.2.v20130417.jar
     3：9.0.2.v20130417 | ${jetty.home}/lib/jetty-continuation-9.0.2.v20130417.jar
     4：9.0.2.v20130417 | ${jetty.home}/lib/jetty-server-9.0.2.v20130417.jar
     5：9.0.2.v20130417 | ${jetty.home}/lib/jetty-security-9.0.2.v20130417.jar
     6：9.0.2.v20130417 | ${jetty.home}/lib/jetty-servlet-9.0.2.v20130417.jar
     7：9.0.2.v20130417 | ${jetty.home}/lib/jetty-webapp-9.0.2.v20130417.jar
     8：9.0.2.v20130417 | ${jetty.home}/lib/jetty-deploy-9.0.2.v20130417.jar
     9：9.0.2.v20130417 | ${jetty.home}/lib/jetty-client-9.0.2.v20130417.jar
    10：9.0.2.v20130417 | ${jetty.home}/lib/jetty-jmx-9.0.2.v20130417.jar
    11：2.2.0.v201303151357 | ${jetty.home}/lib/jsp/com.sun.el-2.2.0.v201303151357.jar
    12：2.2.0.v201303151357 | ${jetty.home}/lib/jsp/javax.el-2.2.0.v201303151357.jar
    13：1.2.0.v201105211821 | ${jetty.home}/lib/jsp/javax.servlet.jsp.jstl-1.2.0.v201105211821.jar
    14：2.2.0.v201112011158 | ${jetty.home}/lib/jsp/javax.servlet.jsp-2.2.0.v201112011158.jar
    15：2.2.2.v201112011158 | ${jetty.home}/lib/jsp/org.apache.jasper.glassfish-2.2.2.v201112011158.jar
    16：1.2.0.v201112081803 | ${jetty.home}/lib/jsp/org.apache.taglibs.standard.glassfish-1.2.0.v201112081803.jar
    17：3.8.2.v20130121-145325 | ${jetty.home}/lib/jsp/org.eclipse.jdt.core-3.8.2.v20130121.jar
    18：（目录）| ${jetty.home}/资源
    19: 9.0.2.v20130417 | ${jetty.home}/lib/websocket/websocket-api-9.0.2.v20130417.jar
    20：9.0.2.v20130417 | ${jetty.home}/lib/websocket/websocket-common-9.0.2.v20130417.jar
    21: 9.0.2.v20130417 | ${jetty.home}/lib/websocket/websocket-server-9.0.2.v20130417.jar
    22: 9.0.2.v20130417 | ${jetty.home}/lib/websocket/websocket-servlet-9.0.2.v20130417.jar
    23: 9.0.2.v20130417 | ${jetty.home}/lib/jetty-util-9.0.2.v20130417.jar
    24: 9.0.2.v20130417 | ${jetty.home}/lib/jetty-io-9.0.2.v20130417.jar

```

> **目录 ./WEB-INF/lib/**

```
antlr-2.7.6.jar
aopalliance-1.0.jar
bcprov-jdk15on-148.jar
c3p0-0.9.1.jar
commons-collections-3.2.1.jar
commons-dbcp-1.3.jar
commons-lang-2.6.jar
commons-logging-1.1.1.jar
commons-pool-1.5.4.jar
cpewebapp.jar
displaytag-1.2.jar
dom4j-1.6.1.jar
gson-1.6.jar
hibernate-commons-annotations-3.2.0.Final.jar
hibernate-core-3.6.4.Final.jar
hibernate-entitymanager-3.6.4.Final.jar
hibernate-jpa-2.0-api-1.0.0.Final.jar
hibernate-validator-4.2.0.Final.jar
jackson-core-asl-1.8.0.jar
jackson-mapper-asl-1.8.0.jar
javassist-3.12.0.GA.jar
json.jar
jta.jar
log4j-1.2.16.jar
servlet-2.3.jar
slf4j-api-1.6.1.jar
slf4j-log4j12-1.6.1.jar
spring-aop-3.1.0.RELEASE.jar
spring-asm-3.1.0.RELEASE.jar
spring-beans-3.1.0.RELEASE.jar
spring-context-3.1.0.RELEASE.jar
spring-context-support-3.1.0.RELEASE.jar
spring-core-3.1.0.RELEASE.jar
spring-expression-3.1.0.RELEASE.jar
spring-jdbc-3.1.0.RELEASE.jar
spring-ldap-core-1.3.0.RELEASE.jar
spring-ldap-core-tiger-1.3.0.RELEASE.jar
spring-orm-3.1.0.RELEASE.jar
spring-oxm-3.1.0.RELEASE.jar
spring-security-config-3.1.0.RELEASE.jar
spring-security-core-3.1.0.RELEASE.jar
spring-security-ldap-3.1.0.RELEASE.jar
spring-security-web-3.1.0.RELEASE.jar
spring-tx-3.1.0.RELEASE.jar
spring-web-3.1.0.RELEASE.jar
spring-webmvc-3.1.0.M1.jar
spring-web-servlet-3.1.0.RELEASE.jar
sqlite-jdbc-3.7.2.jar
velocity-1.6.2.jar
velocity-tools-view-2.0.jar 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-25T15:36:17.617

正如 Stevie 在评论中指出的那样，问题是一个额外的 Jar 文件进入了战争。

我从我的情况下删除了 Jar`spring-webmvc-3.1.0.M1.jar`并`WEB-INF/lib`重新启动了码头。它开始正常。

这没有引起注意，因为它在编译/构建期间出现（在 eclipse 中订购了 jar），也没有出现在我部署的第一台机器上。

非常感谢您的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-21T10:29:43.393

您可以更改您的项目配置，就像我使用 maven like this page。 [http://mvnrepository.com/artifact/redis.clients/jedis/2.8.1](http://mvnrepository.com/artifact/redis.clients/jedis/2.8.1)

然后，当你在 eclipse et 中使用“更新 maven 项目”时，它会下载 jedis.jar 和其他关系文件供编译器使用。它将在码头工作以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-16T21:22:19.540

在直接使用jetty作为Eclipse J2EE集成服务器的情况下，有时会找不到一些库（我不明白为什么有些找不到，只有少数），并抛出这种异常（NoClassDefFound）。

*   所以你必须放入项目源（目录WEB-INF）：你的罐子

*   重启服务器

*   它将罐子放在运行时 WEB-INF：Data\workspace.metadata.plugins\org.eclipse.wst.server.core\tmpX\MyApp\WEB-INF\lib

*   它有效。

# ms-access - 如何为每个值设置一个日期以从前一个值递增

> ID：16194258
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:11:20.840
> 
> 标签：ms-access, ms-access-2007, vba

嘿，任何人都可以帮助我并给我举例。我仍在 Access 中开发。我的营业时间从 2000 开始，关闭时间从 4000 开始，如果我输入一个新日期，例如明天 2013 年 4 月 25 日，那么 4000 的关闭时间将成为开放时间 4000 可以使用宏查询 vba 来完成，如果您理解我的意思，请您提供此代码和示例。提前致谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:54:10.343

如果您使用表单来创建新条目，并且您有时间文本框，您可以`DMax`在营业时间文本框中使用该时间来获取关闭时间的先前值。

`DMax("ClosingHours", "TableName")`

您也可以在 VBA 代码中使用它。如果您能告诉我们更多关于这些值的信息，可以提供您如何添加它们以及您希望获得更好响应的内容。

# django - Django 验证错误

> ID：16194268
> 
> 赞同：1
> 
> 时间：2013-04-24T14:11:57.800
> 
> 标签：django, django-forms

我正在尝试通过实现文件大小限制和文件扩展名来验证上传的图像。问题是上传图像时，我想在处理之前验证文件大小限制和文件扩展名，但出现此错误

“member_descriptor”对象不可订阅

```
forms.py" in clean_image
  43\.                         if not file.name[-3:].lower() in ['jpg']:

Exception Type: TypeError at /pro/
Exception Value: 'member_descriptor' object is unsubscriptable
File "C:\Python26\lib\site-packages\django\forms\forms.py" in _get_errors
  115\.             self.full_clean()
File "C:\Python26\lib\site-packages\django\forms\forms.py" in full_clean
  270\.         self._clean_fields() 
```

我的表格.py

```
class PersonForm(forms.ModelForm):

    def clean_image(self):
            cleaned_data = super(PersonForm,self).clean()
            image = cleaned_data.get("image")

            if image:
                    if image._size > 4*1024*1024:
                            raise forms.ValidationError("Image Must be <4mb Less")
                    if not file.name[-3:].lower() in ['jpg']:
                            raise forms.ValidationError("Your file extension was not recongized")
                    return image

class Meta:
    model = Person
    fields = ('image',) 
```

视图.py

```
def pro(request):

    form = PersonForm()
    if request.POST.has_key('pro'):
        form = PersonForm(request.POST,request.FILES)
        if request.POST['pro'] == 'first':
            if form.is_valid():
                person = Person.objects.get(user=request.user)
                image = form.cleaned_data['image']

                if image:
                    person.image = form.cleaned_data['image']
                person.save()

    return render(request,'profile.html',{'form':form}) 
```

我的模型.py

```
class Person(models.Model):
    user = models.ForeignKey(User)
    image = models.FileField(upload_to="images/",blank=True)
    def __unicode__(self):
        return self.name 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:30:15.477

在引发异常的那一行中，您尝试访问`file.name`. `file`是 Python 中的内置类型。这就是您在那里访问的内容。你应该尝试类似的东西`if not image.file.name[-3:].lower() in ['jpg']:`。

# iphone - xcode上的应用程序发布代码签名错误

> ID：16194270
> 
> 赞同：0
> 
> 时间：2013-04-24T14:11:58.923
> 
> 标签：iphone, ios, xcode, ios5, ios6

我试图为我的 iPHone 设备构建我的项目的发布版本。（我选择 Products->Archive），然后我收到以下错误：

```
Code Sign error: The identity 'iPhone Distribution: XXX' doesn't match any valid, non-expired certificate/private key pair in your keychains 
```

这是什么意思以及如何摆脱这个问题？

顺便说一句，我打开了我的钥匙串访问，`iphone Distribution: xxx`在“**证书**”下找到了这个，它没有过期。

我用谷歌搜索了这个问题，有人说这是因为我的应用程序包 ID 与配置文件中定义的不匹配。但是如何检查配置文件中定义的捆绑 ID？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:18:25.313

转到项目->目标->构建设置，更改您的代码签名身份以进行发布。在 Project->Build settings-> Codesigning 中执行相同的操作。然后清理构建并再次构建它。

如果它不起作用，请关闭项目并再次打开它并构建它。它会起作用的。

# mysql - 小时和分钟乘以小时费率

> ID：16194272
> 
> 赞同：2
> 
> 时间：2013-04-24T14:12:02.263
> 
> 标签：mysql

我有一个 MySQL 数据库，它记录了在各种客户端上工作的小时数。它有两张表，一张存储时间，另一张保存我为每个客户收取的不同费率。

我有一个网页，它以表格格式显示数据，显示开始/停止时间、活动、计算**时间**、**费率**和其他几个信息调用。

**小时**列是使用哪个工作正常计算的`TIME_FORMAT( TIMEDIFF( end_date, start_date ) , '%h %i' ) AS Hours`，给我工作的小时/分钟。但是，Amount 列仅显示 Hours * Rate 计算，而不是 Hours&Min*Rate。

我如何包括会议记录？

`TIME_FORMAT( TIMEDIFF( end_date, start_date ) , '%h %i' ) * rate` ...是我现在用来计算总量的，但正如我所说，分钟值被忽略了。

感谢任何帮助，Roddy

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:21:05.037

而不是`TIMEDIFF`, 使用[`TIMESTAMPDIFF`](http://dev.mysql.com/doc/refman/5.0/en/date-and-time-functions.html#function_timestampdiff)它会在您指定的度量（秒、小时、年）中为您提供差异。在您的查询中像这样使用它：

```
SELECT TIMESTAMPDIFF( MINUTE , start_date, end_date ) * ( rate / 60 ) AS billable_amount
FROM  `your_table` 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:17:44.973

`'%h %i'`将产生类似的东西`17 15`- 那是一个*字符串*值，而不是可以与另一个数字相乘的东西。

使用`TIMESTAMPDIFF`with unit`MINUTE`代替`TIME_FORMAT`，或者，如果这不起作用（因为根据文档它需要完整的日期值），`TIME_TO_SEC`（并除以 60）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:28:40.123

```
SELECT TIME(NOW());
+-------------+
| TIME(NOW()) |
+-------------+
| 16:29:13    |
+-------------+

SELECT TIME_TO_SEC(TIME(NOW()))/3600;
+-------------------------------+
| TIME_TO_SEC(TIME(NOW()))/3600 |
+-------------------------------+
|                       16.4875 |
+-------------------------------+ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-02-08T23:11:10.790

如果您的总时间值以 00:00 格式存储，小时费率以 00.00 格式存储，您可以使用以下查询返回 2 位小数的值；

```
SELECT ROUND(SUM( TIME_TO_SEC('time') * ('hourly_rate')))/60/60 AS 'total_value' FROM 'table' 
```

# android - 用于 Web 开发的 Android 设备

> ID：16194273
> 
> 赞同：-3
> 
> 时间：2013-04-24T14:12:02.900
> 
> 标签：android

我不确定这样的问题是否适合 Stack Overflow，因为它不包含代码，但由于“Stack Overflow 是专业和发烧友程序员的问答网站”，我敢打赌，许多程序员都想知道这个和一些（比如我）对 Android 设备一无所知，但被迫为该平台准备一个网站。

那么问题来了：在合理的价格范围内，哪种 Android 设备最适合 Web 开发？遗憾的是，他们的模拟器在 Windows 机器上是错误的并且太慢了。最新的设备似乎是一个很好的节省时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:24:06.773

我有一个 HTC Wildfire（用于坏小屏幕），有一个 HTC Desire（bravo）但我把它弄坏了 :(，一个 HTC Desire HD for Good 屏幕和单核 cpu，现在我买了一台二手 HTC One S，它是双核高清手机。我还有一台7寸便宜的国产平板，只做测试用。

一般来说，您的应用程序应该在低端设备上运行良好，例如 htc wildfire、samsung galaxy mini/ace。如果您在这些设备上的表现可以接受，那么您的应用在高端设备（如 HTC One ..、三星 Galaxy s3 等）中将非常出色。

当您想查看 GUI 在不同屏幕中的外观时，就会出现问题。因此，就我而言，我有一部屏幕非常小的手机，一部具有良好的分辨率，一部具有高分辨率。大多数现代设备都包含在这些情况下，其余的您可以在 eclipse 中创建布局 xml 并查看结果时看到它们的外观（无需打开模拟器，动态数据除外）。在查看 xml 的外观时，eclipse 使您能够在许多不同的屏幕（甚至自定义大小的屏幕）中显示它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:24:31.913

我想将此作为对您问题的评论发表，但我没有足够的互联网积分。

我只想解决您评论的一部分：“很遗憾，他们的模拟器在 Windows 机器上是错误的并且太慢了。” 在我安装 x86 模拟器之前，我也有同样的想法（从一行代码到另一行代码需要大约五秒钟的时间）。突然间，手术快得惊人。这主要是因为 x86 模拟器能够使用 CPU 的 VM 加速。

如果有兴趣，请查看[文档。](http://developer.android.com/tools/devices/emulator.html)

# mysql - MySQL 将超过 1 行移动到另一个表，全部在 1 条语句中？

> ID：16194275
> 
> 赞同：0
> 
> 时间：2013-04-24T14:12:09.867
> 
> 标签：mysql

所以我需要将这条语句输出的所有行插入到单独的表中：

```
 SELECT * FROM children WHERE quoteid = '$quoteid' 
```

这仅插入其中一行：

```
 INSERT INTO beneficiaries (quoteid, uid, name, percent) VALUES('$quoteid', '$uid', '$nm', '10') 
```

任何人都知道移动多行的方法还是我必须单独发送它们？

更新：

之前应该提到过这一点，但不，'children' 没有相同的列名，更改它们不是一种选择。对不起！

```
$query = mysql_query("SELECT * FROM beneficiaries WHERE quoteid = '$quoteid'");
$getchildrenrid2 = mysql_fetch_assoc($query);

if(mysql_num_rows($query) == 0)
{
    $getchildren = mysql_query("SELECT * FROM children WHERE quoteid = '$quoteid'");
    $getchildrenrid = mysql_fetch_assoc($getchildren);

        $nm = $getchildrenrid['first_name'] . " " . $getchildrenrid['surname'];
        $query = mysql_query("INSERT INTO beneficiaries (quoteid, uid, name, percent) VALUES('$quoteid', '$uid', '$nm', '10')");

    $query = mysql_query("SELECT * FROM beneficiaries WHERE quoteid = '$quoteid'");
        $getlastchild = mysql_fetch_assoc($query);

            header("Location: ".$conf['location']."/distribution.php?edit=".$getlastchild['id']);
} 
```

“儿童”列：

```
- id
- **quoteid**
- **uid**
- *first_name*
- middle_names
- *surname*
- dob
- guardian_first_name
- guardian_middlenames
- guardian_nickname
- guardian_surname
- guardian_housenum
- guardian_city
- guardian_street
- guardian_postcode 
```

“受益人”列

```
- id
- **quoteid**
- **uid**
- *name*
- **percent** 
```

需要复制的内容：

*   报价单 INTO报价单
*   uid 进入 uid
*   名字 + 姓氏 INTO 名字
*   并将百分比设置为“10”

此外，这应该只在此之后完成： SELECT * FROM children WHERE quoteid = '$quoteid' 完成。

$quoteid 返回当前报价的唯一quoteid。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:14:01.970

假设`children`具有相同的列名...

```
INSERT INTO beneficiaries (quoteid, uid, name, percent)
SELECT quoteid, uid, name, percent FROM children WHERE quoteid = '$quoteid' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:15:00.160

尝试这个：

```
INSERT INTO beneficiaries (quoteid, uid, name, percent) select
quoteid, uid, name, percent from children WHERE quoteid = '$quoteid'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:14:09.733

`INSERT INTO beneficiaries (quoteid, uid, name, percent) SELECT quoteid, uid, name, percent FROM children WHERE quoteid = '$quoteid'`;

根据需要调整列名。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:14:22.913

`INSERT INTO beneficiaries (quoteid, uid, name, percent) SELECT (quoteid, uid, name, percent) FROM children WHERE quoteid = '$quoteid'`

当然，假设列是兼容的，该查询将按照您的要求进行。

来源：[MySQL 文档：INSERT ... SELECT](https://dev.mysql.com/doc/refman/5.0/en/insert-select.html)

# resize - ScrolledPanel 在 DestroyChildren 后未调整大小

> ID：16194279
> 
> 赞同：0
> 
> 时间：2013-04-24T14:12:12.940
> 
> 标签：resize, scroll, wxpython, panel, destroy

我从一个关于 Stackoverflow [ScrolledPanel inside Panel not sizing](https://stackoverflow.com/questions/7795726/scrolledpanel-inside-panel-not-sizing)的主题得到了这段代码。这对我来说很有用。但是我想销毁 scrolled_pa​​nel 的所有孩子，然后重新创建它的新孩子。所以我像这样修改代码：

```
import wx
import wx.lib.scrolledpanel as scrolled

########################################################################
class MyForm(wx.Frame):

    #----------------------------------------------------------------------
    def __init__(self):
        wx.Frame.__init__(self, None, wx.ID_ANY, "Tutorial", size=(200,500))

        self.n = 13
        # Add a panel so it looks the correct on all platforms
        self.panel = wx.Panel(self, wx.ID_ANY)

        # --------------------
        # Scrolled panel stuff
        self.scrolled_panel = scrolled.ScrolledPanel(self.panel, -1, 
                                 style = wx.TAB_TRAVERSAL|wx.SUNKEN_BORDER, name="panel1")
        self.scrolled_panel.SetAutoLayout(1)
        self.scrolled_panel.SetupScrolling()

        words = "A Quick Brown Insane Fox Jumped Over the Fence and Ziplined to Cover".split()
        self.spSizer = wx.BoxSizer(wx.VERTICAL)
        for word in words:
            text = wx.TextCtrl(self.scrolled_panel, value=word)
            self.spSizer.Add(text)
        self.scrolled_panel.SetSizer(self.spSizer)
        # --------------------

        btn = wx.Button(self.panel, label="Add Widget")
        btn.Bind(wx.EVT_BUTTON, self.onAdd)

        panelSizer = wx.BoxSizer(wx.VERTICAL)
        panelSizer.AddSpacer(50)
        panelSizer.Add(self.scrolled_panel, 1, wx.EXPAND)
        panelSizer.Add(btn)
        self.panel.SetSizer(panelSizer)

    #----------------------------------------------------------------------
    def onAdd(self, event):
        """"""
        print "in onAdd"
        self.n += 1
        self.scrolled_panel.DestroyChildren()
        for i in range(self.n):
            new_text = wx.TextCtrl(self.scrolled_panel, value="New Text %s" % i)
            self.spSizer.Add(new_text)
        #new_text = wx.TextCtrl(self.scrolled_panel, value="New Text")
        #self.spSizer.Add(new_text)
        self.scrolled_panel.Layout()
        self.scrolled_panel.SetupScrolling()

# Run the program
if __name__ == "__main__":
    app = wx.App(False)
    frame = MyForm().Show()
    app.MainLoop() 
```

现在，即使我创建的子项超出了面板的大小可以显示的范围，我也不会将滚动条视为原始代码。谁能帮我这个？先谢谢了！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:32:31.143

我通过添加 testpanel 在其中添加 scrolledPanel 解决了这个问题。当从不调用 onAdd() 时，在销毁所有 testpanel 的孩子之后，testpanel 下的所有内容甚至是 sizer 都必须重新创建和重新设置。

我试过在没有测试面板的情况下这样做，我仍然可以使用鼠标滚动，但没有看到滚动条，我不知道为什么。这是我的新代码：

```
import wx
import wx.lib.scrolledpanel as scrolled

########################################################################
class MyForm(wx.Frame):

    #----------------------------------------------------------------------
    def __init__(self):
        wx.Frame.__init__(self, None, wx.ID_ANY, "Tutorial", size=(200,500))
        self.n =17
        # Add a panel so it looks the correct on all platforms
        self.panel = wx.Panel(self, wx.ID_ANY)
        panelSizer = wx.BoxSizer(wx.VERTICAL)
        panelSizer.AddSpacer(50)
        # add a panel
        self.testpanel = wx.Panel(self.panel, wx.ID_ANY)

        #self.testpanel.SetSizer(self.testpanelSizer)
        panelSizer.Add(self.testpanel, 1, wx.EXPAND)

        self.onAdd()
        btn = wx.Button(self.panel, label="Add Widget")
        btn.Bind(wx.EVT_BUTTON, self.onAdd)
        panelSizer.Add(btn)

        self.panel.SetSizer(panelSizer)

    #----------------------------------------------------------------------
    def onAdd(self, event=None):
        self.n +=1
        self.testpanel.DestroyChildren()
        testpanelSizer = wx.BoxSizer(wx.VERTICAL)
        scrolled_panel = scrolled.ScrolledPanel(self.testpanel, -1, 
                                 style = wx.TAB_TRAVERSAL|wx.SUNKEN_BORDER, name="panel1")
        scrolled_panel.SetAutoLayout(1)
        scrolled_panel.SetupScrolling()

        spSizer = wx.BoxSizer(wx.VERTICAL)
        for i in range(self.n):
            new_text = wx.TextCtrl(scrolled_panel, value="New Text %s" % i)
            spSizer.Add(new_text)
        scrolled_panel.SetSizer(spSizer)

        testpanelSizer.Add(scrolled_panel, 1, wx.EXPAND)
        self.testpanel.SetSizer(testpanelSizer)
        self.testpanel.Layout()

# Run the program
if __name__ == "__main__":
    app = wx.App(False)
    frame = MyForm().Show()
    app.MainLoop() 
```

# c++ - 将非统一字符串解析为整数

> ID：16194280
> 
> 赞同：0
> 
> 时间：2013-04-24T14:12:17.000
> 
> 标签：c++, string, parsing

我正在为 .obj 文件编写解析器，并且文件的一部分格式为

> f [int]/[int] [int]/[int] [int]/[int]

并且整数的长度未知。在每个 [int]/[int] 对中，它们都需要放在单独的数组中。将它们分隔为整数的最简单方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:23:21.137

考虑使用其中一个`scanf`函数（`fscanf`如果您正在使用 <stdio.h> 和读取文件`FILE*`，或者`sscanf`解析内存缓冲区中的一行）。因此，如果您有一个包含数据的缓冲区和两个整数数组，如下所示：

```
int first[3], second[3];
char *buffer = "f 10/20 1/300 344/2"; 
```

然后你可以写：

```
sscanf(buffer, "f %d/%d %d/%d %d/%d", 
       &first[0], &second[0], &first[1], &second[1], &first[2], &second[2]); 
```

（`sscanf`的输入模式中的空格不是必需的，因为`%d`跳过了空格，但它们提高了可读性。）

如果您需要错误检查，请分析以下结果`sscanf`：此函数返回成功输入的值的数量（`6`对于此示例，如果一切正确）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:24:30.067

你可以用 fscanf 做到这一点：

```
int matched = fscanf(fptr, "f %d/%d %d/%d %d/%d", &a, &b, &c, &d, &e, &f);
if (matched != 6) fail(); 
```

或 ifstream 和 sscanf：

```
char buf[100];
yourIfstream.getLine(buf, sizeof(buf));
int matched = sscanf(buf, "f %d/%d %d/%d %d/%d", &a, &b, &c, &d, &e, &f);
if (matched != 6) fail(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:20:26.780

```
 #include <stdlib.h>

   long int strtol(const char *nptr, char **endptr, int base);

   long long int strtoll(const char *nptr, char **endptr, int base); 
```

该`strtol`函数将从输入中解析一个整数，并返回整数在字符串中结束的位置。你可以像这样使用它

```
char *input = "f 123/234 234/345 345/456"
char *c = input;
char *endptr;

if (*c++ != 'f') fail();
if (*c++ != ' ') fail();

long l1 = strtol(c, &endptr, 10);
if (l1 < 0) fail(); /* you expect them unsigned, right? */
if (endptr == c) fail();
if (*endptr != '/') fail();
c = endptr+1;
... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:23:35.590

我会为此使用正则表达式。如果你有一个兼容 C++11 的编译器，你可以使用 ，否则你可以查看 boost::regex。在类似 Perl 的语法中，您的正则表达式模式看起来像这样`f ([0-9]+)/([0-9]+) ([0-9]+)/([0-9]+) ([0-9]+)/([0-9]+)`：然后依次获取子匹配项（括号内的内容）并使用 istringstream 将它们从字符串或 char* 转换为整数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T14:56:33.843

最简单的方法是使用 C++11 正则表达式：

```
static const std::regex ex("f (-?\\d+)//(-?\\d+) (-?\\d+)//(-?\\d+) (-?\\d+)//(-?\\d+)");
std::smatch match;
if(!std::regex_match(line, match, ex))
    throw std::runtime_error("invalid face data");
int v0 = std::stoi(match[1]), t0 = std::stoi(match[2]), 
    v1 = std::stoi(match[3]), t1 = std::stoi(match[4]), 
    v2 = std::stoi(match[5]), t2 = std::stoi(match[6]); 
```

* * *

虽然这对于您的情况可能已经足够了，但我不禁添加了一种更灵活的方式来读取这些索引元组，这可以更好地处理非三角形面和不同的面规范格式。为此，我们假设您已经将人脸线放入 a`std::istringstream`并且已经吃掉了人脸标签。这通常是这种情况，因为读取 OBJ 文件的最简单方法仍然是：

```
for(std::string line,tag; std::getline(file, line); )
{
    std::istringstream sline(line);
    sline >> tag;
    if(tag == "v")
        ...
    else if(tag == "f")
        ...
} 
```

现在读取面部数据（`"f"`当然是在案例内部），我们首先单独读取每个索引元组。然后，我们只需使用正则表达式为每种可能的索引格式解析这个索引并适当地处理它们，在 3-element 中返回单个顶点、texcoord 和正常索引`std::tuple`：

```
for(std::string corner; sline>>corner; )
{
    static const std::regex vtn_ex("(-?\\d+)/(-?\\d+)/(-?\\d+)");
    static const std::regex vn_ex("(-?\\d+)//(-?\\d+)");
    static const std::regex vt_ex("(-?\\d+)/(-?\\d+)/?");
    std::smatch match;
    std::tuple<int,int,int> idx;
    if(std::regex_match(corner, match, vtn_ex))
        idx = std::make_tuple(std::stoi(match[1]), 
                              std::stoi(match[2]), std::stoi(match[3]));
    else if(std::regex_match(corner, match, vn_ex))
        idx = std::make_tuple(std::stoi(match[1]), 0, std::stoi(match[2]));
    else if(std::regex_match(corner, match, vt_ex))
        idx = std::make_tuple(std::stoi(match[1]), std::stoi(match[2]), 0);
    else
        idx = std::make_tuple(std::stoi(str), 0, 0);
    //do whatever you want with the indices in std::get<...>(idx)
}; 
```

当然，这为以性能为导向的优化（如果有必要）提供了可能性，例如无需在每次循环迭代中分配新的字符串和流。但这是为适当的 OBJ 加载程序提供所需灵活性的最简单方法。但也可能是上述版本的仅具有顶点和 texcoords 的三角形对您来说已经足够了。

# python - 查询 sqlite3 数据库

> ID：16194284
> 
> 赞同：0
> 
> 时间：2013-04-24T14:12:27.503
> 
> 标签：python, database, sqlite

我正在尝试编写一个程序来查询数据库。数据库是 golfDB，它由一个名为 player 的表组成，其中包含 5 个字段：name（球员姓名）、totalGross（每轮总得分的总和）、totalRounds（打出的轮数）、pars（完成的总杆数） ，和小鸟（小鸟的总数。我的程序需要输出具有最多标准杆的球员，输入球员的平均得分（totalGross/totalRounds），并按照总得分从低到高的顺序列出球员. 现在我还没有真正研究具有最多 pars 函数或排序分数的函数的播放器。我的平均分数函数有问题。我收到这个错误，我真的不确定如何修理它：

```
Traceback (most recent call last):
  File "/Users/tinydancer9454/Documents/python/golfDBuserInterface.py", line 46, in <module>
    main()
  File "/Users/tinydancer9454/Documents/python/golfDBuserInterface.py", line 40, in main
    queryDBavgScore(cursor)
  File "/Users/tinydancer9454/Documents/python/golfDBuserInterface.py", line 29, in queryDBavgScore
    answer = totalGrossScore/ totalRoundsScore
TypeError: unsupported operand type(s) for /: 'tuple' and 'tuple' 
```

到目前为止，这是我的代码：

```
import sqlite3

def getDBCursor(DB):
    """obtain and return a cursor for the database DB"""
    conn= sqlite3.connect('/Users/tinydancer9454/Documents/python/golfDB')
    cursor= conn.cursor()
    return cursor

def queryDBpars(cursor):
    """find out which player had the most pars"""
    cursor.execute('select name from players where pars >= 0')

def queryDBavgScore(cursor):
    """find the average score of inputed player"""
    player= input("Please enter the player's name: ")
    cursor.execute('select totalGross from players where name = ?', (player,))
    totalGrossScore = cursor.fetchone()
    cursor.execute('select totalRounds from players where name = ?', (player,))
    totalRoundsScore = cursor.fetchone()
    answer = totalGrossScore/ totalRoundsScore
    print('The average score for', player, 'is', answer)

def queryDBplayers(cursor):
    """lists the players in order of their total gross score"""

def main():
    """obtain cursor and query the database: golfDB"""
    cursor= getDBCursor('golfDB')
    queryDBpars(cursor)
    queryDBavgScore(cursor)
    queryDBplayers(cursor)
    cursor.close() 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:14:09.577

SQLite3 的[fetchone](http://docs.python.org/2/library/sqlite3.html)返回一个元组，因此您需要在尝试潜水之前获取第一项，否则您实际上将划分两个元组。

```
totalGrossScore = cursor.fetchone()[0]
totalRoundsScore = cursor.fetchone()[0] 
```

在这种情况下，您的查询仅从一个字段获取数据，但请记住，查询可能返回不止一个字段，这就是 fetchone 返回元组的原因。

# arrays - 两个数组元素的比较和计算

> ID：16194287
> 
> 赞同：0
> 
> 时间：2013-04-24T14:12:36.133
> 
> 标签：arrays, perl, counter

我想写的一段代码有问题。我的问题基于两个数组及其包含的元素。

我有两个用数字填充的数组（与字符串中的位置有关）。我希望选择位置之间的子字符串。第一个数组中的元素是子字符串的开头，第二个数组中的元素是子字符串的结尾。

我提供的代码读取文件并使其成为字符串：

```
>demo_data
theoemijono
milotedjonoted
dademimamted 
```

细绳：

```
theoemijonomilotedjonoteddademimamted 
```

所以我想要发生的是提取子字符串

```
emijonomiloted

emimamted 
```

我编写的代码采用第一个元素数组并将其与第二个数组对应元素进行比较，然后确保没有交叉，因此保持子字符串以 emi 开头并以 tedas 结尾，在提供的序列中看到

```
for($i=0; $i<=10; $i++)
{

    if ($rs1_array[$i] < $rs2_array[$i] && $rs1_array[$i+1] > $rs2_array[$i])
    {
        my$size= $rs2_array[$i]-$rs1_array[$i]+ 3);
        my$substr= substr($seq, $rs1_array[$i],$size);
        print $substr."\n";
    }
} 
```

使用此代码适用于第一个子字符串，但第二个子字符串被忽略，因为第一个数组的元素较少，因此无法完成比较。

***更新***

数组结构：

```
@rs1_array = (4, 28);
@rs2_array = (15, 22, 34); 
```

嗨，鲍罗丁，你说的完全正确。我现在已经编辑了代码！感谢您看到与长度问题有关的内容。奇怪偏移的原因是@rs2_array 中的值是起始位置，在这种情况下它没有考虑单词“ted”的其余部分，我需要它来完成字符串。数组正确构建为对于@rs1_array 中的元素，它们表示起始位置“emi”，@rs2_array 元素还保存每个“ted”的起始位置，因此字符串中有 2 个 emi 和 3 个 ted，这会导致不平衡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T05:11:07.500

```
my @starts = ( 4, 28 );
my @ends   = map $_+3, ( 15, 22, 34 );

my $starts_idx = my $ends_idx = 0;
while ($starts_idx < @starts && $ends_idx < @ends) {
   if ($starts[$start_idx] > $ends[$ends_idx]) {
      ++$start_idx;
      next;
   }

   my $length = $ends[$ends_idx] - $starts[$start_idx];
   say substr($seq, $starts[$start_idx], $length);

   ++$ends_idx;
   ++$start_idx;
} 
```

当然，它给出的输出与以下内容相同：

```
say for $seq =~ /(emi(?:(?!emi|ted).)*ted)/sxg; 
```

# javascript - 通过 JQuery "on" 在 Dart 中监听事件

> ID：16194291
> 
> 赞同：0
> 
> 时间：2013-04-24T14:12:53.747
> 
> 标签：javascript, jquery, dart

我通过 js interop 在 Dart 中使用 Bootstrap Modal 对话框。除了侦听自定义事件之外，一切正常。我正在尝试使用以下代码收听“显示”事件：

```
js.scoped(() {
  js.context.jQuery("#myModal").on("shown", new js.Callback.once(() {
    print("Dialog Shown");         
  }));
}); 
```

但是，触发事件时出现以下 Dart 错误：

```
Class '() => dynamic' has no instance method 'call'.\n\nNoSuchMethodError : method not found: 'call'\nReceiver: Closure: (dynamic) => dynamic\nArguments: [Instance of 'Proxy'] 
```

任何想法我做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:40:10.830

您收到此错误是因为回调应该有一个参数（[文档的](http://api.jquery.com/on/)[处理程序参数`on`](http://api.jquery.com/on/)需要一个`eventObject`参数）。所以你的代码应该是：

```
js.context.jQuery("#myModal").on("shown", new js.Callback.many((eventObject) {
  print("Dialog Shown");
})); 
```

还要注意使用 of`js.Callback.many`而不是`js.Callback.once`。前者允许多次调用回调。

# azure - Azure 的云服务负载平衡极不平衡

> ID：16194292
> 
> 赞同：5
> 
> 时间：2013-04-24T14:12:54.680
> 
> 标签：azure, cloud, load-balancing

我正在使用 Azure 托管云服务，我最近对其进行了修改，使其可跨多个实例进行扩展，包括会话缓存辅助角色。我的问题是，为什么我会在一个实例上看到极端负载（超过 90%），而在其他实例上却没有（在所有其他实例中为 15-20%）？我应该担心吗？

在我设置负载平衡之前，当我的单个实例达到 95% 以上的负载时，它会慢慢爬起来——变得不可用。有什么方法可以确保我没有任何用户遇到这种情况，因为他们以某种方式循环到重载的实例上？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-11T10:23:24.373

我们发现当一个负载均衡的实例发生故障转移时，我们也遇到了类似的情况；我们看到的是所有负载都转移了，但不会再次平衡。我们发现关闭 keep-alive 几分钟会让负载再次传播，之后我们可以重新打开它。

[http://technet.microsoft.com/en-us/library/cc772183(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/cc772183(v=ws.10).aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:20:13.300

嗯......天蓝色负载平衡基于循环......所以分布应该几乎相等（60-40甚至70-30仍然可以接受）......所以只是为了确定：你确定你的不使用会设置粘性会话的 IIS“重定向”（我忘记了功能的名称）？

我必须说，如果没有关于您的网站实际“做什么以及如何”的更多详细信息，很难给出建议......我必须说这种行为很奇怪，但目前尚不清楚这是负载平衡器的错误......

*Edit1：*我建议您通过跟踪其活动来进一步检查 90% 的人在做什么......也许您不走运并且会导致重负载的请求落入那台机器以及那些将很快工作正在由另一个人工作......可能发生的另一件事是可能会卡住（可能是无限循环）......如果您实现了可扩展架构，我建议您配置另一台机器并杀死正在受苦的人……

*Edit2：*验证负载均衡器是否正常工作的一种简单方法是：远程登录到服务机器并替换主页上显示的图像之类的内容（只需查看页面即可轻松发现）。在服务器 1 上放一张黄色图像，在服务器 2 上放一张红色图像（好吧......也许不是那么激烈，但你明白了......）。然后继续一次又一次地加载页面......

# java - 无法发现 SQL 语法错误

> ID：16194302
> 
> 赞同：0
> 
> 时间：2013-04-24T14:13:11.180
> 
> 标签：java, mysql, sql, jdbc, syntax-error

每当我尝试插入、删除和更新时，都会出现以下语法错误。但是在我关闭异常 jdialog 并重新启动应用程序后，数据要么被插入、更新和删除

```
com.mysql.jdbc.exceptions.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your  mariaDB server for the right syntax to use near 'Customer' at line 1 
```

**插入查询**

```
try {

            String sql = "Insert into Customer(ID , FirstName, MiddleName, LastName, DOB, Gander, Address, City, PostCode) "
                    + "values (?, AES_ENCRYPT(?, 'uk112'),AES_ENCRYPT(?, 'uk112'),"
                    + "AES_ENCRYPT(?, 'uk112'),?,AES_ENCRYPT(?, 'uk112'),"
                    + "AES_ENCRYPT(?, 'uk112'),AES_ENCRYPT(?, 'uk112'),"
                    + "AES_ENCRYPT(?, 'uk112'))";

            pst = newconn.prepareStatement(sql);
            pst.setString(1, jTextFieldID.getText());
            pst.setString(2, jTextFieldFirstname.getText());
            pst.setString(3, jTextFieldMiddlename.getText());
            pst.setString(4, jTextFieldLastname.getText());
            pst.setString(5, ((JTextField)txt_Date.getDateEditor().getUiComponent()).getText());
            pst.setString(6, Gander);
            pst.setString(7, jTextFieldAddress.getText());
            pst.setString(8, jTextFieldCity.getText());
            pst.setString(9, jTextFieldPostcode.getText());

            pst.execute();
            newconn.close();
            JOptionPane.showMessageDialog(null, "Saved");
        } catch (Exception e) {
            JOptionPane.showMessageDialog(null, e);
        } 
```

**更新查询**

```
try{

    String value1 =  jTextFieldID.getText();
    String value2 = jTextFieldFirstname.getText();
    String value3 = jTextFieldMiddlename.getText();
    String value4 = jTextFieldLastname.getText();
    String value5 = ((JTextField)txt_Date.getDateEditor().getUiComponent()).getText();
    String value6= Gander.toString();
    String value7= jTextFieldAddress.getText();
    String value8 = jTextFieldCity.getText();
    String value9 = jTextFieldPostcode.getText();    
String sql = "update  Customer set FirstName= AES_ENCRYPT(?,'uk112'),"
        + "MiddleName= AES_ENCRYPT(?,'uk112'),"
        + "LastName= AES_ENCRYPT(?,'uk112'),"
        + "DOB=?,Gander= AES_ENCRYPT(?,'uk112'),"
        + "Address= AES_ENCRYPT(?,'uk112'),"
        + "City= AES_ENCRYPT(?,'uk112'),"
        + "PostCode= AES_ENCRYPT(?,'uk112') where ID=?";

    pst = newconn.prepareStatement(sql);
    pst.setString(1, value2);
    pst.setString(2, value3);
    pst.setString(3, value4);
    pst.setString(4, value5);
    pst.setString(5, value6);
    pst.setString(6, value7);
    pst.setString(7, value8);
    pst.setString(8, value9);
    pst.setString(9, value1);
    pst.execute();
    newconn.close();
     JOptionPane.showMessageDialog(null, "Data is updated");

}
catch(Exception e){
 JOptionPane.showMessageDialog(null, e);
} 
```

**删除查询**

```
 String sql = "delete from Customer Where ID =?";
        try{

           pst= newconn.prepareStatement(sql);

          pst.setString(1, jTextFieldID.getText());
           pst.execute();
           JOptionPane.showMessageDialog(null, "Deleted");
       }
       catch(Exception e){
            JOptionPane.showMessageDialog(null, e);
       } 
```

# python - 使用 Scrapy 从详细信息页面中提取数据

> ID：16194303
> 
> 赞同：2
> 
> 时间：2013-04-24T14:13:11.653
> 
> 标签：python, screen-scraping, scrapy, web-crawler

我正在尝试从该站点抓取代理商的电话号码：

列表查看 [http://www.authoradvance.com/agencies/](http://www.authoradvance.com/agencies/)

详情查看 [http://www.authoradvance.com/agencies/b-personal-management/](http://www.authoradvance.com/agencies/b-personal-management/)

电话号码隐藏在详细信息页面中。

那么是否可以通过上面的详细视图 url 之类的 url 浏览网站并抓取电话号码？

我对这段代码的尝试是：

```
from scrapy.item import Item, Field

class AgencyItem(Item):
    Phone = Field()

from scrapy.contrib.spiders import CrawlSpider, Rule
from scrapy.contrib.linkextractors.sgml import SgmlLinkExtractor
from scrapy.selector import HtmlXPathSelector
from agentquery.items import AgencyItem

class AgencySpider(CrawlSpider):
   name = "agency"
   allowed_domains = ["authoradvance.com"]
   start_urls = ["http://www.authoradvance.com/agencies/"]
   rules = (Rule(SgmlLinkExtractor(allow=[r'agencies/*$']), callback='parse_item'),)

   def parse_item(self, response):
       hxs = HtmlXPathSelector(response)
       sites = hxs.select("//div[@class='section-content']")
       items = []
       for site in sites:
           item = AgencyItem()
           item['Phone'] = site.select('div[@class="phone"]/text()').extract()
           items.append(item)
       return(items) 
```

然后我运行“scrapy crawl Agency -o items.csv -t csv”，结果爬取了0页。

怎么了？提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T18:28:38.330

页面上只有一个链接满足您的正则表达式 ( `agencies/*$`)：

```
stav@maia:~$ scrapy shell http://www.authoradvance.com/agencies/
2013-04-24 13:14:13-0500 [scrapy] INFO: Scrapy 0.17.0 started (bot: scrapybot)

>>> SgmlLinkExtractor(allow=[r'agencies/*$']).extract_links(response)
[Link(url='http://www.authoradvance.com/agencies', text=u'Agencies', fragment='', nofollow=False)] 
```

这只是一个指向自身的链接，它没有带`section-content`类的 div：

```
>>> fetch('http://www.authoradvance.com/agencies')
2013-04-24 13:15:22-0500 [default] DEBUG: Crawled (200) <GET http://www.authoradvance.com/agencies> (referer: None)

>>> hxs.select("//div[@class='section-content']")
[] 
```

因此您的循环不会迭代并且`items`永远不会被附加。

所以将你的正则表达式更改为`/agencies/.+`

```
>>> len(SgmlLinkExtractor(allow=[r'/agencies/.+']).extract_links(response))
20

>>> fetch('http://www.authoradvance.com/agencies/agency-group')
2013-04-24 13:25:02-0500 [default] DEBUG: Crawled (200) <GET http://www.authoradvance.com/agencies/agency-group> (referer: None)

>>> hxs.select("//div[@class='section-content']")
[<HtmlXPathSelector xpath="//div[@class='section-content']" data=u'<div
class="section-content">\n\t      <di'>, <HtmlXPathSelector xpath="//div
[@class='section-content']" data=u'<div class="section-content"><div class='>] 
```

# joomla - joomla 全局配置保存时出现错误 500

> ID：16194306
> 
> 赞同：0
> 
> 时间：2013-04-24T14:13:20.087
> 
> 标签：joomla

我是 joomla 的新手，我正在配置我的第一个站点，但由于全局配置出现问题，当我尝试保存它时，我收到 500 错误。

我正在使用 php 内部服务器来运行它，“php -S localhost:8081”......其他一切都很好......

这是堆栈跟踪，似乎不是权限错误，但我不确定。

```
500 - An error has occurred.

JModel: :getName() : Can't get or parse class name.

Return to Control Panel
Call stack
# Function Location
1 JAdministrator->dispatch() /home/dshiga/dev/joomla_hairs/administrator/index.php:46
2 JComponentHelper::renderComponent() /home/dshiga/dev/joomla_hairs/administrator/includes/application.php:153
3 JComponentHelper::executeComponent() /home/dshiga/dev/joomla_hairs/libraries/joomla/application/component/helper.php:351
4 require_once() /home/dshiga/dev/joomla_hairs/libraries/joomla/application/component/helper.php:383
5 JController->execute() /home/dshiga/dev/joomla_hairs/administrator/components/com_config/config.php:18
6 ConfigControllerApplication->save() /home/dshiga/dev/joomla_hairs/libraries/joomla/application/component/controller.php:761
7 JController->getModel() /home/dshiga/dev/joomla_hairs/administrator/components/com_config/controllers/application.php:55
8 JController->createModel() /home/dshiga/dev/joomla_hairs/libraries/joomla/application/component/controller.php:793
9 JModel::getInstance() /home/dshiga/dev/joomla_hairs/libraries/joomla/application/component/controller.php:599
10 JModel->__construct() /home/dshiga/dev/joomla_hairs/libraries/joomla/application/component/model.php:201
11 JError::raiseError() /home/dshiga/dev/joomla_hairs/libraries/joomla/application/component/model.php:220
12 JError::raise() /home/dshiga/dev/joomla_hairs/libraries/joomla/error/error.php:251 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:37:00.960

最后发现，问题是通过“php -S”命令使用php内部服务器引起的，不知道究竟是什么导致了这种情况下的错误，但是将站点托管在apache下解决了这个问题。

# c# - 以编程方式设置 IIS 输出缓存

> ID：16194307
> 
> 赞同：0
> 
> 时间：2013-04-24T14:13:21.603
> 
> 标签：c#, iis, iis-7

我想知道是否可以更改使用代码`Output Caching`的值。`IIS``C#`

我的意思是这些选项：

![在此处输入图像描述](https://i.stack.imgur.com/eP40m.png)

# java - 如何判断 String 和 byte[] 是否相等

> ID：16194317
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:13:40.523
> 
> 标签：java, client-server

我已经建立了一个 UDP 聊天客户端。要将信息从客户端发送到服务器，我需要能够将客户端想要发送的字符串转换为字节 []。我希望能够在服务器端删除客户端。当客户端向服务器发送特定消息时，服务器知道将其从服务器中删除。

但是，当我通过连接发送 byte[] 时，将其转换为字符串并将其与将终止客户端连接的字符串进行比较，它永远不会相同。我只是希望能够发送消息并能够告诉客户端希望服务器终止其客户端 IP 广告端口的日志。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:15:50.563

从字节数组转换为字符串并使用 String.equals() 方法。

```
byte[] b = {(byte) 99, (byte)97, (byte)116};
String s = new String(b, "US-ASCII");// pass encoding here its "US-ASCII". 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:19:26.220

尝试这样的事情：

```
byte[] bytes = ...;
String myString = ...;
String byteString = new String(bytes, <charsetName>);

byteString.equals(myString); 
```

[您可以在此处](http://docs.oracle.com/javase/1.5.0/docs/guide/intl/encoding.doc.html)查看字符集名称

# php - 带有ajax jquery的php mysql 3动态下拉列表

> ID：16194318
> 
> 赞同：0
> 
> 时间：2013-04-24T14:13:40.830
> 
> 标签：php, mysql, jquery, drop-down-menu

我正在使用 php mysql + ajax jquery 创建动态下拉列表，第二个下拉列表的填充基于第一个和第三个的选择是基于第二个的选择，但它没有用任何人都可以帮助我？？？

# 数据库配置文件

```
<?php
$host = "localhost";
$user = "****";
$password = "***";
$db = "lam_el_chamel_db";
?> 
```

# 选择.php

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
    <head>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript">
             $(document).ready(function(){
            $("select#district").attr("disabled","disabled");
            $("select#village").attr("disabled","disabled");
            $("select#governorate").change(function(){

            $("select#district").attr("disabled","disabled");
            $("select#district").html("<option>wait...</option>");

            $("select#village").attr("disabled","disabled");
            $("select#village").html("<option>wait...</option>");

            var id = $("select#governorate option:selected").attr('value');
            $.post("select_district.php", {id:id}, function(data){
                $("select#district").removeAttr("disabled");
                $("select#district").html(data);
            });

            var id2 = $("select#district option:selected").attr('value');
            $.post("select_village.php", {id:id}, function(data){
                $("select#village").removeAttr("disabled");
                $("select#village").html(data);
            });

        $("form#select_form").submit(function(){
            var gover = $("select#governorate option:selected").attr('value');
            var dist = $("select#district option:selected").attr('value');

            if(gover>0 && dist>0)
            {
                var result = $("select#district option:selected").html();
                $("#result").html('your choice: '+result);
            }
            else
            {
                $("#result").html("you must choose two options!");
            }
            if(dist>0 && village>0)
            {
                var result = $("select#village option:selected").html();
                $("#result").html('your choice: '+result);
            }
             else
            {
                $("#result").html("you must choose three options!");
            }
            return false;
        });
    });
        </script>
    </head>
    <body>
    <?php include "select.class.php"; ?>
        <form id="select_form">
            Choose a governorate:<br />
            <select id="governorate">

            <?php echo $opt->ShowGovernorate(); ?>

            </select>
            <br /><br />

           choose a district:<br />
            <select id="district">
                <option value="0">choose...</option>
            </select>
            <br /><br />

            choose a village:<br />
            <select id="village">
                <option value="0">choose...</option>
            </select>
            <input type="submit" value="confirm" />
        </form>
        <div id="result"></div>
    </body>
</html> 
```

# 选择类.php

```
<?php 
 class SelectList
{
    protected $conn;

        public function __construct()

        {
           $this->DbConnect();
        }
    protected function DbConnect()
   {
    include "dbconfig.php";
    $this->conn = mysql_connect($host,$user,$password) OR die("Unable to connect to the database");
    mysql_select_db($db,$this->conn) OR die("can not select the database $db");
    return TRUE;
   }  

    public function ShowGovernorate()
    {
            $sql = "SELECT * FROM governorate";
            $res = mysql_query($sql,$this->conn);
            $governorate = '<option value="0">choose...</option>';
            while($row = mysql_fetch_array($res))
            {
                $governorate .= '<option value="' . $row['governorate_id'] . '">' . $row['governorate_name'] . '</option>';
            }
            return $governorate;

    }
    public function ShowDistrict()
   {
    $sql = "SELECT * FROM districts WHERE governorate_id=$_POST[id]";
    $res = mysql_query($sql,$this->conn);
    var_dump($res);
    $district = '<option value="0">choose...</option>';
       while($row = mysql_fetch_array($res))
      {
        $district .= '<option value="' . $row['district_id'] . '">' . $row['district_name'] . '</option>';
      }
    return $district;
   }

   public function ShowVillage()
   {
    $sql = "SELECT village_id, village_name FROM village WHERE district_id=$_POST[id2]";
    $res = mysql_query($sql,$this->conn);
    $village = '<option value="0">choose...</option>';
       while($row = mysql_fetch_array($res))
       {
         $village .='<option value="' .$row['village_id'] . '">' . $row['village_name'] . '</option>';
       }
       return $village;
   }

}   
$opt = new SelectList(); 

?> 
```

# 选择区.php

```
<?php
include "select.class.php";
echo $opt->ShowDistrict();
?> 
```

# select_village.php

```
<?php
include "select.class.php";
echo $opt->ShowVillage();
?> 
```

我认为它在 select.php 中有一些东西，但我不知道错误是什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:28:02.257

您的 ajax 调用是在 document.ready 函数上完成的。您应该将 ajax 绑定到下拉更改功能，例如：

```
$("select#district option:selected").change(function(){
id = $(this).val(); 
$.post("select_village.php", {id:id}, function(data){
    $("select#village").removeAttr("disabled");
    $("select#village").html(data);
}); 
```

希望有帮助

# video - 获取网站的程序化屏幕截图，包括实时网络摄像头图像

> ID：16194320
> 
> 赞同：1
> 
> 时间：2013-04-24T14:13:44.333
> 
> 标签：video, web, screenshot, webcam, live

我想通过 URL 截取网站的屏幕截图，但目标是捕获在这些网站上播放的实时网络摄像头。当我以编程方式截取屏幕截图时，显示网络摄像头的区域是一个黑色方块。如何确保屏幕截图还包括显示网络摄像头的区域？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T08:39:08.967

只要有可能（在您的情况下，这也是典型的），视频播放通过视频硬件覆盖路由，当您截取屏幕截图时不会读回。所以你会得到黑色而不是真正的网络摄像头图像。

在您的情况下，最简单的解决方案是在后台打开一个视频播放器应用程序（可以是与其中一个网络摄像头相同的应用程序）。可以将其暂停，只需进行视频播放会话即可锁定视频覆盖。视频覆盖通常是每个硬件项目 1（一个）数量的有限资源，因此锁定它会迫使其他玩家退回到屏幕截图友好的视频显示方法。

从那里你的网络摄像头截图会很好。不需要编码，但您当然也可以以编程方式进行类似的操作。

# asp.net - 在负载均衡器上启用粘性会话

> ID：16194328
> 
> 赞同：6
> 
> 时间：2013-04-24T14:14:03.543
> 
> 标签：asp.net, session, iis, load-balancing, sticky

对此的任何建议将不胜感激，我整个上午都在研究，但我仍在摸不着头脑。几周前我开始在一家新公司工作，我是唯一的 .NET 开发人员，因为开发最初是由一家外包公司完成的，我被要求进行研究。我对现有系统的了解非常有限，但据我所知，情况如下。

我们想在 asp.net 网站上启用粘性会话。根据我收集的研究，我需要执行以下步骤。我们正在使用 ASP.NET 状态服务

该设置是一个负载平衡服务器，它为两个 Web 服务器提供服务。

1.  确保两个 Web 服务器具有相同的机器密钥。
2.  确保网站在部署前已经预编译。用于通过 ASP.NET 状态服务对对象进行序列化。
3.  确保 iis 元数据库上的应用程序路径在两个 Web 服务器上相同。

我缺乏的一点知识是会话存储在哪里。会话是否存储在负载均衡器上，它们可以存储在负载均衡器上吗？根据我的阅读，它们由 ASP.NET 状态服务存储，如果服务在负载平衡器上运行，因此会话存储在负载平衡器上。

据我了解，ASP.NET 状态服务在每台 Web 服务器上运行，它们只是相互通信，以便会话存储在两台服务器上。我假设他们这样做的方式是基于所使用的算法类型。任何信息将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-11T12:49:49.887

zeencat，请查看状态服务器模式部分的[http://msdn.microsoft.com/en-us/library/ms178586.aspx ：](http://msdn.microsoft.com/en-us/library/ms178586.aspx)

> StateServer 模式将会话状态存储在一个进程中，称为 ASP.NET 状态服务，它**独立**于 ASP.NET 工作进程或 IIS 应用程序池。使用此模式可确保在重新启动 Web 应用程序时保留会话状态，并且还使会话状态可用于 Web 场中的多个 Web 服务器。要使用 StateServer 模式，您必须首先确保 ASP.NET 状态服务*正在用于会话存储的服务器上运行*。ASP.NET 状态服务在安装ASP.NET 和 .NET Framework 时**作为服务安装。**

据我了解，ASP.Net 状态服务在一台服务器上运行，作为一种名为**ASP.NET 状态服务**的服务，两台服务器将具有相同的 web.config 文件：

```
<configuration>
  <system.web>
    <sessionState mode="StateServer"
      stateConnectionString="tcpip=SampleStateServer:42424"
      cookieless="false"
      timeout="20"/>
  </system.web>
</configuration> 
```

这样，会话将存储在托管服务的服务器上。

希望能帮助到你， []

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-19T15:08:50.600

如果您在 AWS 中，也请考虑使用 ElastiCache；如果在本地作为您的 ASP.NET 会话存储，请考虑使用 Redis，而不是使用粘性会话。它在自动缩放、负载平衡和性能方面具有更多优势。更多信息请访问[http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx](http://blogs.msdn.com/b/webdev/archive/2014/05/12/announcing-asp-net-session-state-provider-for-redis-preview-release.aspx)

# android - 如何将居中背景添加到 activity_mail.xml

> ID：16194330
> 
> 赞同：0
> 
> 时间：2013-04-24T14:14:05.557
> 
> 标签：android, user-interface

这就是我的 activity_mail.xml 的启动方式，我可以在此处添加一个简单的行来添加背景图像还是还有更多内容？

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" 
android:id="@+id/mainLayout"> 
```

这适用于平板电脑应用程序，我希望图像中心对齐。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:32:22.137

只需添加

```
android:background="@drawable/your_image" 
```

并且可选地，

```
android:scaleType="centerInside" 
```

如果您想保持图像比例并在布局内。

# asp.net - asp:chart, charttype='column' 带有可见的图例

> ID：16194333
> 
> 赞同：0
> 
> 时间：2013-04-24T14:14:07.563
> 
> 标签：asp.net, mschart

我对 Asp:Chart 有点困惑，我有一个返回一行的表

![在此处输入图像描述](https://i.stack.imgur.com/ZoEQh.png)

现在我希望它显示在 Asp:chart 中，ChartType="Column"。

1.  我将上表转换为格式

    ![在此处输入图像描述](https://i.stack.imgur.com/u6P38.png)

    我用了一个系列

    ```
    <asp:Chart ID="charttest" runat="server" Width="950px" Height="250px">
                <Series>
                    <asp:Series Name="Categories" IsValueShownAsLabel="true"        
           ChartArea="MainChartArea"
                        ChartType="Column" Legend="legend1"  >
                    </asp:Series>
                  </Series>
                <ChartAreas>
                    <asp:ChartArea Name="MainChartArea" Area3DStyle-Enable3D="true" 
                             Area3DStyle-IsClustered="true" BorderWidth="1" 
                           Area3DStyle-WallWidth="1" Area3DStyle-
                         PointGapDepth="50" Area3DStyle-PointDepth="100" Area3DStyle-                    
                           Rotation="10">

                    </asp:ChartArea>
                </ChartAreas>
               <Legends>
             <asp:Legend Name="legend1" BorderColor="Blue" ></asp:Legend>
               </Legends>
            </asp:Chart> 
    ```

    问题：

    一个。该图显示正确，但只有一个图例，无法将标签从后面的代码更改为百分比。

2.  然后，我使用了多个系列，但是

    ```
     <asp:Chart ID="charttest" runat="server" Width="950px" 
                 Height="250px">
                <Series>
                    <asp:Series Name="Categories" IsValueShownAsLabel="true"   
                     ChartArea="MainChartArea"
                        ChartType="Column" Legend="legend1"  >
                    </asp:Series>
                    <asp:Series Name="Categories2" IsValueShownAsLabel="true" 
                       ChartArea="MainChartArea"
                        ChartType="Column" Legend="legend1" >
                    </asp:Series>
                    <asp:Series Name="Categories3" IsValueShownAsLabel="true" 
                   ChartArea="MainChartArea"
                        ChartType="Column" Legend="legend1" >
                    </asp:Series>
                    <asp:Series Name="Categories4" IsValueShownAsLabel="true" 
                      ChartArea="MainChartArea"
                        ChartType="Column" Legend="legend1" >
                   </asp:Series>
                       </Series>
                   <ChartAreas>
                    <asp:ChartArea Name="MainChartArea" Area3DStyle-Enable3D="true"  
                        Area3DStyle-IsClustered="true" BorderWidth="1" Area3DStyle- 
                        WallWidth="1" Area3DStyle-PointGapDepth="50" Area3DStyle-
                         PointDepth="100" Area3DStyle-Rotation="10">

                    </asp:ChartArea>
                </ChartAreas>
               <Legends>
             <asp:Legend Name="legend1" BorderColor="Blue" ></asp:Legend>
               </Legends>
            </asp:Chart> 
    ```

    问题：

    一个。图例显示正确，我能够以百分比显示标签，但未显示轴值，它必须显示那些条之间有空格。

![在此处输入图像描述](https://i.stack.imgur.com/928iJ.png)

你能告诉我我应该如何解决这个问题。

1.  使用单个或多个系列来解决此问题。我做了很多研究，但找不到完美的解决方案。
2.  列名必须显示在每个块的正下方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-03T19:49:18.067

对于第二个问题，“列名必须显示在每个块的正下方。” 您可能想为您的系列下的每个 DataPoints 添加一个 AxisLabel。

```
<asp:DataPoint AxisLabel="Celtics" YValues="17" /> 
```

这是我发现的一个[链接，它显示了一个示例。](http://www.4guysfromrolla.com/articles/072209-1.aspx)

# php - 单个数据库或多个数据库（用于单个应用程序中的多个用户）

> ID：16194336
> 
> 赞同：1
> 
> 时间：2013-04-24T14:14:14.953
> 
> 标签：php, mysql, database, content-management-system

我是 php/mysql 的新手，我正在编写一个简单的 CMS。但在这种情况下，我将托管多家公司（每家公司都有多个用户），这需要付费才能使用该系统。

所以......我的问题是关于如何组织数据库......谈到安全性、管理和性能，我只想知道这些案例中你们的意见是最好的：

1.  将所有公司托管在一个数据库上，他们会获得一个与用户匹配的公司 ID。

2.  每家公司都有一个单独的数据库来保存用户（并且不再需要公司 ID）。

我会在第一种情况下开始开发......但如果我有一些黑客攻击/sql注入，每个客户端都会受到伤害。分离 DB 后，损害只会得到一个客户。因此，就安全性而言，第二种情况可能会更好。但在管理和绩效方面不能说同样的话。

因此，根据您的经验，任何帮助或提示都会很棒！

在此先感谢，并为我糟糕的英语感到抱歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:24:24.867

我会选择单独的数据库。但不仅仅是为了黑客。

可扩展性：假设您有一个处理 10 个网站的服务器，但其中 1 个网站的请求、内容等增长迅速。您的服务器很难托管所有这些网站。

使用单独的数据库，分散在多个服务器上是小菜一碟。使用一个单独的数据库，您必须升级您当前的数据库或将其集群化，但这有时对于托管公司来说是不可能的，或者非常昂贵。

性能：他们都在 1 个 DB 上，多个用户的数据在 1 个表中，锁可能会减慢其他用户的速度。

大表，意味着大索引，大查找等。因此，拆分到不同的数据库实际上会加快速度。

您将不得不处理每个 DB 的额外内存和 CPU 开销，但它们通常不会产生惊人的大影响。

是的，管理多个数据库需要更多的工作，但是拥有适当的更新脚本并密切关注数据库模式的版本将大大减少您的管理问题。

**更新：**另见这篇文章。 [http://msdn.microsoft.com/en-us/library/aa479086.aspx](http://msdn.microsoft.com/en-us/library/aa479086.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:23:25.973

单独的数据库具有许多优势，包括性能、安全性、可扩展性、移动性等。尝试将所有内容打包到 1 个数据库中，尤其是在谈论单独的公司数据时，风险更大，回报更少。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:23:49.870

你没有提供任何细节，但一般来说，我会选择单独的数据库。

为每个客户端使用自治数据库可以进行更精细的控制，因为可以管理/备份/垃圾/等。他们单独，而不影响其他人。它还需要较少的修饰，因为数据更容易区分，并且一个数据库不能破坏其他数据库。

更不用说它会使开发过程更容易——请注意，单独的数据库意味着您不必总是验证行的“所有者”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:47:07.407

如果您计划将此数据库托管在资源（相对）便宜的 Azure 数据库等云环境中，客户端运行相同的代码库，数据库架构相同（显然），并且有可能共享一些公司之间的数据然后一个多租户数据库可能是要走的路。对于您的其他任何事情，您可能会创建大量与多租户数据库相关的额外工作。

请记住，如果您采用单独的数据库路线，稍后尝试迁移到多租户云解决方案是一项艰巨的任务。我之所以提到这一点，是因为在过去的几年里，我听到的关于 IT 水冷却器的一切都是“云！云！云！”。

# sql - 如何将百分数转换为六十进制

> ID：16194337
> 
> 赞同：0
> 
> 时间：2013-04-24T14:14:17.767
> 
> 标签：sql, sql-server, tsql

我有这个查询：我需要将数据库中的百分数值转换为六十进制（分钟）

```
SELECT 
DISTINCT RD_MAT,
SUM(CASE WHEN RD_PD IN ('421') THEN RD_HORAS ELSE 0 END) AS 'ATRASOS',
SUM(CASE WHEN RD_PD IN ('420') THEN RD_HORAS ELSE 0 END) AS 'FALTAS',
SUM(CASE WHEN RD_PD IN ('084') THEN RD_HORAS ELSE 0 END) AS 'H.EXTRA 100%',
SUM(CASE WHEN RD_PD IN ('080') THEN RD_HORAS ELSE 0 END) AS 'H.EXTRA 50% ',
SUM(CASE WHEN RD_PD IN ('082') THEN RD_HORAS ELSE 0 END) AS 'H.EXTRA NOTURNA' 
FROM SRD020 
INNER JOIN SRV020 ON RD_PD = RV_COD
   AND SRV020.D_E_L_E_T_ <> '*'
   AND SRD020.D_E_L_E_T_ <> '*'
   AND RD_MAT = '000123'
WHERE LEFT(RD_DATPGT,6) = '201304'
GROUP BY RD_MAT 
```

H.EXTRA 100% 的百分数回报率为 16:53。但几分钟后是 16:49。

示例：40 + 40 = 80 的百分位数。40 + 40 = 1:20 六十进制。我需要这个值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:21:22.913

所以，看起来你正在做这样的事情。我将转换为 VARCHAR 用于输出目的，您当然不必这样做。

```
DECLARE @value1 INT, @value2 INT

SET @value1 = 40
SET @value2 = 50

SELECT CAST(FLOOR((@value1+@value2)/60) AS VARCHAR(50)) + ':' +  CAST((@value1+@value2)%60 AS VARCHAR(50)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:30:45.737

```
Declare @h Varchar(5)='16:53'

Select Cast(DateAdd(SS,CAST(REPLACE(@h,':','.') as Float)*60,0) as Time)

>>> 00:16:31.0000000 
```

# javascript - W3C 错误：文档类型在此处不允许元素 X；缺少一个 Y 开始标签

> ID：16194340
> 
> 赞同：1
> 
> 时间：2013-04-24T14:14:18.823
> 
> 标签：javascript, html, w3c-validation

在我的 HTML/PHP 代码中，我有以下一段代码，它确保使用 JavaScript 从一组字段中删除过滤。

```
<form id="prices" action="">
<div class="box searchPrices" id="pricesDiv">
    <h2>Prijzen
    <p class="removeAll" rel="prices"></p>
    <span></span>
    </h2>
    ...
    </div>
</form> 
```

这按预期工作，但现在我的 W3C 验证不再正确验证。有没有一种很好的方法来绕过这个警告，以确保它很好地验证并且仍然删除过滤？

我得到的 W3C 错误：

> 文档类型不允许在此处使用元素“p”；缺少“object”、“applet”、“map”、“iframe”、“button”、“ins”、“del”开始标签之一

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:20:20.943

**HTML4：**

您收到一个错误，因为它不是有效的标记。您不能`<p>`在标签内包含`<h2>`标签。

但是，您可以使用`<span>`内部标题标签等元素，因为它们是内联的。

看看[**这里**](http://www.w3.org/TR/html4/struct/global.html#h-7.5.5)的相关规范部分- 浏览一下，你会发现哪些元素在哪里被允许等等（基本上，[**特殊**](http://www.w3.org/TR/html4/sgml/dtd.html#special)部分下的所有实体）。

* * *

**HTML5：**

从 HTML5开始，根据[**HTML5 规范**](http://dev.w3.org/html5/markup/h2.html#h2)，在标题标签中包含[**段落**](http://dev.w3.org/html5/markup/common-models.html#common.elem.phrasing)**仍然是无效**的。[](http://dev.w3.org/html5/markup/common-models.html#common.elem.phrasing)**[](http://dev.w3.org/html5/markup/h2.html#h2)**

# linq - LINQ：如何加入 IEnumerable 进入具有 SomeType 属性的对象？

> ID：16194346
> 
> 赞同：0
> 
> 时间：2013-04-24T14:14:38.773
> 
> 标签：linq, join

我有一个`IEnumerable<byte>`我想转换为的`new object { byte property1, byte property2, ....}`，将所有这些字节值连接到一个对象中。

我如何使用 LINQ 做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:30:59.943

**我不知道您为什么要实现这一目标**，但我认为有一种方法，使用[`ExpandoObject`](http://msdn.microsoft.com/en-us/library/system.dynamic.expandoobject.aspx)from `System.Dynamics`。

可以使用`Aggregate`LINQ 中的方法来完成：

```
return source.Select((x, i) => new {name = string.Format("{0}{1}", propertyPrefix, i), value = x})
                .Aggregate((new ExpandoObject()) as IDictionary<string, Object>,
                        (e, i) =>
                            {
                                e[i.name] = i.value;
                                return e;
                            }, e => e as ExpandoObject); 
```

您应该将其隐藏在另一种扩展方法下，例如`ToExpandoObject`：

```
public static ExpandoObject ToExpandoObject<TSource>(this IEnumerable<TSource> source, string propertyPrefix)
{
    return source.Select((x, i) => new {name = string.Format("{0}{1}", propertyPrefix, i), value = x})
                    .Aggregate((new ExpandoObject()) as IDictionary<string, Object>,
                            (e, i) =>
                                {
                                    e[i.name] = i.value;
                                    return e;
                                }, e => e as ExpandoObject);
} 
```

用法：

```
var source = new List<int>() {123, 234, 345, 456, 567, 678};

var t = source.ToExpandoObject("Property"); 
```

# eclipse - 部署到 GAE 时指定部署路径？

> ID：16194347
> 
> 赞同：0
> 
> 时间：2013-04-24T14:14:44.657
> 
> 标签：eclipse, google-app-engine, gwt

我已经有一个使用 GAE GoogleAppEngine 在本地运行的 GWT 应用程序。一切正常并部署到 war 文件夹`src/main/webapp`。

appengine.xml 位于：`src\main\webapp\WEB-INF\appengine-web.xml`

问题：当我`rightclik project > Google > Deploy to App Engine`，然后 Eclipse 告诉我`appengine-web.xml`在`target\project-0.0.1-SNAPSHOT\WEB-INF`. 这是真的，因为它只包含`classes`文件夹。但是为什么会生成这个目标文件夹呢？

在本地部署时，一切都刚刚放入`src\main\webapp`并且工作正常。如何告诉 Eclipse Google 插件查看此位置，而不是目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T10:07:17.613

找到它：在整个项目中搜索“target”，应该会出现 2 个配置文件：`org.eclipse.wst.common.component`, `com.google.gdt.eclipse.core.prefs`. 将目标路径替换为：“/src/main/webapp”...

# mysql - 创建触发器以锁定和解锁记录

> ID：16194349
> 
> 赞同：0
> 
> 时间：2013-04-24T14:14:53.087
> 
> 标签：mysql, triggers, locking, record

我正在为 MySQL 数据库创建一个 php 脚本，我称之为 MySQL 触发器。

触发器应该影响实际上是发票的表：

因此，当我将一个名为“date_invoiced”的字段从其 NULL 默认值更新为有效日期时，它会
锁定整个记录以防更新，除非您通过 MySQL 登录
获得将其更改回默认 NULL 的权限，（有效地“重新打开'发票）

不知道怎么做，任何帮助都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:01:20.707

添加触发器对于开发保留强制引用完整性的复杂 MySQL 数据库至关重要。外键无法处理可能涉及多于一列的复杂情况（例如 item_id 和 item_type_id 场景）。

**仅在打开二进制日志记录时创建或删除触发器时才需要**SUPER 。****

 **原因似乎与复制问题有关（MySQL 5.0 文档）。

[RTM](http://dev.mysql.com/doc/refman/5.0/en/show-triggers.html)和[RTM](http://dev.mysql.com/doc/refman/5.1/en/privileges-provided.html)

阅读此[链接](http://forums.cpanel.net/f334/mysql-5-view-trigger-permissions-case-17834-a-73842.html)到...和此线程[Applying column permissions for a table over a trigger](https://stackoverflow.com/questions/11331562/applying-column-permissions-for-a-table-over-a-trigger) , [Can't create MySQL trigger with TRIGGER privilege on 5.1.32](https://stackoverflow.com/questions/1627383/cant-create-mysql-trigger-with-trigger-privilege-on-5-1-32)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:57:55.237

你不能把锁放在一行上。我建议你使用`TRIGGER`on update，如果 date_invoiced 是`NOT NULL`. 除非用户名是“超人”。我认为你可以按照这个例子编写你想要的代码。

```
DELIMITER ||

CREATE TRIGGER upd_lock
    BEFORE UPDATE
    ON table_name
    FOR EACH ROW
BEGIN
    IF OLD.date_invoiced IS NOT NULL AND USER() NOT LIKE '\'superman\'@%' THEN
        SIGNAL SQLSTATE VALUE '45000' SET MESSAGE_TEXT = '[upd_lock] - Record is locked';
    END IF;
END;

||
DELIMITER ; 
```**

# angularjs - AngularJS - 隔离范围绑定到父范围

> ID：16194351
> 
> 赞同：1
> 
> 时间：2013-04-24T14:15:00.300
> 
> 标签：angularjs

**如果我的“父”页面中有一个 html 元素，如下所示：**

```
 <div ng-include"'Go-To-Child-Page.html'" /> 
```

**我的任何孩子/包含页面都是这样的：**

```
 <some-directive two-way-binding="$parent.SomeParentScope"></some-directive> 
```

**为什么这不适用于我的指令？或者更好的是，我该如何让它发挥作用？**

```
 app.directive ('someDirective', function(){
    return {
        retrict: 'E',
        replace: true,
        scope: {
            myBinding : "=twoWayBinding",  <- this is what is not working
        },
        template: '<select ng-model="myBinding" ng-options="myType.Description for myType in myTypes"></select>'
    };
} 
```

**编辑更新：**

为什么我发布这个问题？

完成一个很长的表格后，我立即注意到我有很多类似的控件，我的编码员说我应该抽象出来。其中之一是选择控件。此控制涉及两个场景：

**(1) 用户必须在填充选择控件之前选择过滤器；和**

**(2) 其中代码为选择控件预定义了过滤器。**

这两种情况的解决方案如下所示。我希望这对每个人都有帮助，因为我真的很喜欢使用 Angular，它提供的用于创建“Html-magic”的指令功能非常棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:16:07.917

您似乎做了很多不必要的事情，但这可能是因为我误解了您的目标。

我在这里修复了你的 plnkr：http://plnkr.co/edit/FqpzC5p1Ogm4attYiArV?p= [preview](http://plnkr.co/edit/FqpzC5p1Ogm4attYiArV?p=preview)

必要的基本更改似乎是：

1.  将选定的过滤器（后/前）传递到您的指令中
2.  替换`ngOptions`为`ngRepeat`和 过滤器

您的指令实际上不需要控制器（通常大多数指令应该使用链接器函数）。我删除了一些部分以使其更简单，但您仍然可以`$scope.filterTypes`按原样连接（从 中提取可用的类型`$scope.myTypes`）并且它仍然可以正常工作。

**更新**

由于您没有详细说明您的所有要求，我可能会遗漏一些，但这个实现是我收集到的您正在寻找的：

[http://plnkr.co/edit/pHgJ84Z35q5jxCpq3FHC?p=preview](http://plnkr.co/edit/pHgJ84Z35q5jxCpq3FHC?p=preview)

它有动态过滤，不需要使用控制器，它有双向绑定。唯一的问题是它引用了“描述”字段（就像您原来的那样）。如果您愿意，您可以使用 HTML 进行配置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-26T14:23:09.503

**场景1：让用户过滤：**

```
Filter: 
<input type="radio" ng-model="choice.type" value="Rear"> Rear
<input type="radio" ng-model="choice.type" value="Front"> Front
<br>
Select:
<name-value-select selected-item="selected.item" choice="choice.type" options="axleTypes"></name-value-select> 
```

**场景2：代码中的预过滤：**

```
<name-value-select preselected-filter="Front" selected-item="selected.item" options="axleTypes"></name-value-select> 
```

**两种情况的指令：**

```
.directive('nameValueSelect', function () {
  return {
    replace: true,
    restrict: "E",
    scope: {
        selectedItem: "=",
        choice: "=",
        options: "=",
        preselectedFilter: "@"
    },
    controller: function ($scope) {
        $scope.$watch('choice', function (selectedType) {
            $scope.selectedItem = '';  // clear selection
            $scope.filterTypes = [];
            angular.forEach($scope.options, function (type) {
                if ($scope.preselectedFilter !== undefined) {
                    selectedType = $scope.preselectedFilter;
                }
                if (type.Type === selectedType) {
                    this.push(type);
                }
            }, $scope.filterTypes);
            $scope.filterTypes.sort(function (a, b) {
                return a.Description.localeCompare(b.Description);
            });
        });
    },
    template: '<select  ng-model="selectedItem"  ng-options="o.Description for o in filterTypes"><option value="" selected="selected">Please Select </option></select>'
}; 
 }); 
```

**和众所周知的强制性plunker：**

[http://plnkr.co/edit/tnXgPKADfr5Okvj8oV2S](http://plnkr.co/edit/tnXgPKADfr5Okvj8oV2S)

# qt - 尝试在 V-play 中创建新项目并运行它但出现 383 链接错误？

> ID：16194353
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:15:05.417
> 
> 标签：qt, linker, qml, v-play

尝试在“空 V-play 项目”下创建新项目并运行它，但出现 383 错误。所有以“declspec（dllimport）”开头

顺便说一句，如果有帮助，我按照[本](http://v-play.net/doc/vplay-installation.html)指南进行了设置 V-play 的 T 操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:05:55.167

不得不将qt版本切换到2010

# android - 使用 Android 的 ListView 中的 JSONArray

> ID：16194355
> 
> 赞同：3
> 
> 时间：2013-04-24T14:15:06.757
> 
> 标签：android, json, list, listview

urlHi 我有这段代码可以从 php 页面接收数据，我想把这些数据放在一个列表视图中。我收到了该数据，并且我已经通过 system.out.println 看到了该数据，但我在列表视图中有白行。代码：

```
public class Utenti extends ListActivity {

ListView lv;

ListView listView;

static String temp;
    //ListAdapter adapter;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();

      StrictMode.setThreadPolicy(policy);

lv = getListView();
lv.setTextFilterEnabled(true);
lv.setOnItemClickListener(new OnItemClickListener() {
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

        }
    });

      Thread t = new Thread(new Runnable (){

          public void run() {
              //Looper.prepare();
              JSONObject json =conn("ketut.php");

              try {
                  //Get the element that holds the earthquakes ( JSONArray )
                  JSONArray  ute = json.getJSONArray("success");
                  final List<HashMap<String, String>> mylist = 
                          new ArrayList<HashMap<String, String>>();
                  HashMap<String, String> map = new HashMap<String, String>();
                     for(int i=0;i < ute.length();i++){

                      JSONObject e = ute.getJSONObject(i);
                       System.out.println(e.getString("user"));

                       map.put("name",  e.getString("user"));

                       mylist.add(map);
                  }

                     runOnUiThread(new Runnable() {

                         public void run() {

                          ListAdapter adapter = new SimpleAdapter(Utenti.this, mylist , R.layout.utentii,new String[] { "name" },new int[] { 1});
                          Utenti.this.setListAdapter(adapter);
                          }

                      });

              } catch (JSONException e) {
                  System.out.println("4");
                  e.printStackTrace();
              }

          }
      });
              t.start();
        //  t.start();  

}

public  static JSONObject conn(String pagina){
    HttpURLConnection connection;
    OutputStreamWriter request = null;
    URL url = null;
    String response = null;
    JSONObject jArray = null;

    try
        {
            url = new URL("url"+pagina);
            connection = (HttpURLConnection) url.openConnection();
            connection.setDoOutput(true);
            connection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
            connection.setRequestMethod("POST");

            String line = "";

            InputStreamReader isr = new InputStreamReader(connection.getInputStream());
            BufferedReader reader = new BufferedReader(isr);
            StringBuilder sb = new StringBuilder();
            while ((line = reader.readLine()) != null)
            {
                sb.append(line + "\n");
            }
            response = sb.toString();
            System.out.println(response);
            try{jArray=new JSONObject (response);}
            catch(JSONException e){}

            isr.close();
            reader.close(); 
        }
        catch(IOException e)
        {
            Log.i("NetworkTest","Network Error: " + e);
        }
    return jArray;
}} 
```

utentii.xml

```
<?xml version="1.0" encoding="utf-8"?>
<TextView xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:padding="10dp"
android:textSize="20sp" > 
```

[问题的图像](http://img854.imageshack.us/img854/6540/rowsa.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T18:27:41.650

不。runOnUiThread() 是必要的，因为你想调用`setListAdapter`.

再次。- 移动这两行

```
ListAdapter adapter = new SimpleAdapter(Utenti.this, mylist , R.layout.utentii,new String[] { "name" },new int[] { 1});
setListAdapter(adapter); 
```

在方法中的`for(){}`循环之后`onClick()`。

如果您确定您的`mylist`列表中填充了 json 调用中的数据。

基本上像这样的样本：

用以下内容替换您的 xml 文件内容：

测试.xml

```
<ListView xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@android:id/list"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" /> 
```

对于 ListView 的行

行.xml

```
 <?xml version="1.0" encoding="utf-8"?>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
              android:orientation="vertical"
              android:layout_width="match_parent"
              android:layout_height="match_parent">

    <TextView
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:text="New Text"
            android:id="@+id/textView" android:layout_gravity="center"/>
</LinearLayout> 
```

然后 onCreate():

```
 @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        setContentView(R.layout.test);
        StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();

        StrictMode.setThreadPolicy(policy);

        ListView lv = getListView();
        populateListView();

        lv.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

                populateListView();
            }
        });

    }

    private void populateListView(){

        Thread t = new Thread(new Runnable (){

            public void run() {

                JSONObject json = getUserObject("http://myhost:8080/login/email");
                Log.i("json",json.toString());

                try {
                    //Get the element that holds the earthquakes ( JSONArray )
                    JSONArray friends = json.getJSONObject("user").getJSONArray("friends");

                    final List<Map<String, String>> mylist =
                            new ArrayList<Map<String, String>>();

                    //get list of friend ids in the user object
                    for(int i=0;i < friends.length();i++){
                        Map<String,String> map = new LinkedHashMap<String, String>();
                        map.put("friendid", friends.getString(i));
                        mylist.add(map);

                    }
                    runOnUiThread(new Runnable() {
                        public void run() {
                            ListAdapter adapter = new SimpleAdapter(MyTestListActivity.this, mylist , R.layout.row,new String[] { "friendid" },new int[] {R.id.textView});
                            setListAdapter(adapter);
                        }
                    });

                } catch (JSONException e) {
                    System.out.println("4");
                    e.printStackTrace();
                }

            }
        });
        t.start();

    }

    public  static JSONObject getUserObject(String page){

        JSONObject jArray = null;

        try
        {
            HttpClient httpclient = new DefaultHttpClient();
            HttpPost httppost = new HttpPost(page);

            List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(2);
            nameValuePairs.add(new BasicNameValuePair("user", "test"));
            nameValuePairs.add(new BasicNameValuePair("pwd", "test"));

            httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
            HttpResponse response = httpclient.execute(httppost);
            String str = EntityUtils.toString(response.getEntity(), HTTP.UTF_8);
            try{
                jArray=new JSONObject (str);}
            catch(JSONException e){Log.d("error",e);}    

        }
        catch(Exception e)
        {
            Log.i("NetworkTest", "Network Error: " + e);
        }
        return jArray;
    } 
```

希望这个对你有帮助。

# c++ - 在 C++ 中使用带有结构数组的排序选择

> ID：16194357
> 
> 赞同：0
> 
> 时间：2013-04-24T14:15:14.220
> 
> 标签：c++

我不知道如何使排序选择起作用。我必须按升序对结构中的分数（双打）进行排序。

这是我的代码，我会评论我在哪里得到错误。

我的结构：

```
struct diveInfo   
{
    string diversName;
    double totalScore;
    double totalScore;
    double diff;
    double scores[NUM_SCORES];
}; 
```

我按升序对分数进行排序的功能：

```
void selectionSort(diveInfo *ptr,  int size)
{
    diveInfo temp;

    double minValue;

    int startScan;
    int minIndex;

    for ( startScan = 0; startScan < (size - 1); startScan++)
    {
        minIndex = startScan;
        minValue = ptr[startScan].scores; //keep getting an error here saying type double cannot be assigned to an entity of type double.
        temp = ptr[startScan];

        for (int index = startScan + 1; index < size; index++)
        {
            if ( ptr[index].scores < minValue) 
            {
                temp = ptr[index];
                minIndex = index;
            }

        }
        ptr[minIndex] = ptr[startScan];
        ptr[startScan] = temp;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:17:05.670

`scores`是双精度数组，您需要在此数组中指定索引才能访问特定的双精度值。
例如`minValue = ptr[startScan].scores[0];`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:19:52.170

```
minValue = ptr[startScan].scores; 
```

`scores`是一个双打数组。arrayname 也充当指针。`scores`是`double*`[精确地可以指向大小数组的类型`NUM_SCORES`] 您正在分配一个`double`指向 int 的指针。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:17:20.627

您正在尝试将 double*（双精度数组是双精度 *）分配给双精度。

您可以尝试将双打数组更改为双打数组`vector`。然后您可以使用`std::sort`或对它们进行排序`std::stable_sort`。

# android - 共享首选项问题，调用 clear 后未释放值

> ID：16194362
> 
> 赞同：0
> 
> 时间：2013-04-24T14:15:27.250
> 
> 标签：android, sharedpreferences

在我的应用程序中，我想清除`SharedPreferences`按钮单击。这就是我用来在其中存储值的方法：

```
SharedPreferences clearNotificationSP = getSharedPreferences("notification_prefs", 0);
SharedPreferences.Editor Notificationeditor = clearNotificationSP.edit();
Notificationeditor.putString("notificationCount", notificationCountValue);
Notificationeditor.commit(); 
```

onClick() 上的代码如下：

```
SharedPreferences clearedNotificationSP = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
SharedPreferences.Editor editorSP = clearedNotificationSP.edit();
editorSP.remove("notificationCount");
editorSP.commit();

System.out.println("Saved in SP clearedNotification: "+ clearNotification); 
```

清除后我正在打印该值，但仍然得到相同的值。

我错过了什么？

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:17:06.680

`getDefaultSharedPreferences`和 `getSharedPreferences("notification_prefs", );`

返回两个不同的`SharedPreferences`. 由于您在`notificationCount`里面添加`notification_prefs`，您应该检索 SharedPreference 与`getSharedPreferences("notification_prefs", );`

`getDefaultSharedPreferences`使用默认首选项文件名，而 getSharedPreferences 使用您提供的文件名作为参数

# javascript - 在 contenteditable div 中保持光标位置

> ID：16194364
> 
> 赞同：9
> 
> 时间：2013-04-24T14:15:32.133
> 
> 标签：javascript, dom

首先，这类似于这些：

[在 IE 中编辑 iframe 内容 - 维护文本选择的问题](https://stackoverflow.com/questions/5767037/editing-iframe-content-in-ie-problem-in-maintaining-text-selection/5770175#5770175)

[如何使用 html 子元素在 contenteditable div 中获取插入符号位置？](https://stackoverflow.com/questions/5951886/how-to-get-caret-position-within-contenteditable-div-with-html-child-elements?answertab=votes#tab-top)

基本上，我正在写一些类似于 twitter 中新的推文编辑器的东西。在`div`带有`contentEditable`设置的情况下，我正在解析文本。当我检测到我认为是 URL 时，我会删除该文本并输入`<a>`div 内的标签（例如，输入的消息`go to www.google.com`变为`Go to <a href='..'>www.google.com</a>`。但是，当我这样做时，插入符号的位置会丢失。

只要您不编辑 DOM（如他所说），在其他 SO 帖子中使用 @Tim-Down 的建议只会起作用。我正在编辑 DOM，所以插入符号的位置丢失了。

是否有可能（理想情况下不使用引用的 Rangy 库）通过处理当前代码来实现这一点。

我目前拥有的代码（来自其他 SO 帖子）：

```
var saveSelection, restoreSelection;
if (window.getSelection) {
    // IE 9 and non-IE
    saveSelection = function(win) {
        var sel = win.getSelection(), ranges = [];
        if (sel.rangeCount) {
            for (var i = 0, len = sel.rangeCount; i < len; ++i) {
                ranges.push(sel.getRangeAt(i));
            }
        }
        return ranges;
    };

    restoreSelection = function(win, savedSelection) {
        var sel = win.getSelection();
        sel.removeAllRanges();
        for (var i = 0, len = savedSelection.length; i < len; ++i) {
            sel.addRange(savedSelection[i]);
        }
    };
} else if (document.selection && document.selection.createRange) {
    // IE <= 8
    saveSelection = function(win) {
        var sel = win.document.selection;
        return (sel.type != "None") ? sel.createRange() : null;
    };

    restoreSelection = function(win, savedSelection) {
        if (savedSelection) {
            savedSelection.select();
        }
    };
} 
```

我像这样使用它：

```
$('div').on('keyup paste', function(e) {
    var ranges = saveSelection(window);
    var newContent = /* Get the new HTML content */;
    $('div').html(newContent);
    restoreSelection(window, ranges);
}); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T16:16:31.347

如果用户看到的文本保持不变（您的问题似乎暗示是这种情况），您可以使用基于字符偏移的解决方案。我已经在 Stack Overflow 的其他地方发布了一些代码：

[https://stackoverflow.com/a/13950376/96100](https://stackoverflow.com/a/13950376/96100)

我最近还回答了一个相关问题：

[jQuery：将文本 URL 转换为链接作为输入](https://stackoverflow.com/questions/14636218/jquery-convert-text-url-to-link-as-typing/14637351#14637351)

# wso2 - WSO2 Registry and Apache Synapse Integration

> ID：16194368
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:15:47.670
> 
> 标签：wso2, synapse

I'm a beginer of SOA ,and I want to know some info of integrating the WSO2 Registry and Apache Synapse.Just like how to publish services through the Synapse to the Registry and get services through the Synapse from the Registry .Thank you

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:01:18.033

您可以在以下链接中参考 WS-Discovery 功能。

[http://wso2.com/blogs/architecture/2011/09/loosen-up-with-ws-discovery/](http://wso2.com/blogs/architecture/2011/09/loosen-up-with-ws-discovery/)

[http://docs.wso2.org/wiki/display/ESB460/WS-Discovery](http://docs.wso2.org/wiki/display/ESB460/WS-Discovery)

进一步查看以下链接，了解如何以各种方式集成 WSO2 ESB 和 WSO2 Reg。

[http://docs.wso2.org/wiki/display/ESB460/Storing+Various+WSO2+Enterprise+Service+Bus+Configurations](http://docs.wso2.org/wiki/display/ESB460/Storing+Various+WSO2+Enterprise+Service+Bus+Configurations)

# spring-mvc - 如何在 Spring3 MVC 项目中使用 Jackson 将 json 数据动态解析为不同的对象

> ID：16194371
> 
> 赞同：4
> 
> 时间：2013-04-24T14:15:52.140
> 
> 标签：spring-mvc, jackson

我想知道是否有一种方法可以通过使用 Spring3 中的杰克逊功能将 json 数据动态解析为不同的对象。

我有一个父类如下：

```
public class Recording {
    private String id;

    public String getId() {
        return id;
    }

    public void setId(String id) {
        this.id = id;
    }
} 
```

还有两个孩子：

```
public class Child1Recording extends Recording {
    private String program;

    public String getProgram() {
        return program;
    }

    public void setProgram(String program) {
        this.program = program;
    }
}

public class Child2Recording extends Recording {
    private String time;

    public String getTime() {
        return time;
    }

    public void setTime(String time) {
        this.time = time;
    }
} 
```

像这样的控制器：

```
@RequestMapping(value = "/init/postCheck.ajax", method = RequestMethod.POST)
public @ResponseBody
String postCheck(@RequestBody Recording recording) {
    if (recording instanceof Child2Recording) {
        return "\"child2 success\"";
    } else if (recording instanceof Child1ecording) {
        return "\"child1 success\"";
    }
    return "\"only parent Recording\"";
} 
```

我有不同的场景将不同的 json 数据发布到后端，我想知道是否有办法让控制器像我上面所说的那样工作？

现在，如果我发送 Child2Recording 数据，解析时会发生错误。我无法得到我期望的正确对象。

# sql - 这个 To_Date() 语句有什么问题？

> ID：16194372
> 
> 赞同：0
> 
> 时间：2013-04-24T14:15:54.377
> 
> 标签：sql, oracle

```
 INSERT INTO Log_Table 
    VALUES ('Mismatch', 'C:\Folder-SBX2\', '\Subfolder1\', 'm1.txt', 
        '37587b066cf68b3870101c4bbc1a5dc0', 'SBX2', '7.2 SP13 CC5', 
        To_Date('2013/04/04 11:46:06 AM', 'YYYY-MM-DD HH:MI:SS AM')); 
```

特别是最后一行。我希望日期显示为**2013/04/04 11:46:06 AM**但输入为**04-APR-13**。问题是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T14:26:30.467

Oracle 以自己的格式存储日期。存储与显示无关。

`04-APR-2013`如果我们不更改它，它只是 Oracle 使用的默认格式。如果要更改日期的显示方式，则需要更改客户端中的 NLS_DATE_FORMAT。例如，您可以运行以下命令：

```
sql>  alter session set nls_date_format='YYYY-MM-DD HH:MI:SS AM'; 
```

* * *

> “这太愚蠢了。不是你的答案，而是我的意思是甲骨文”

嗯，没有。以各种不同格式存储日期是愚蠢的。从将日期存储为字符串的人那里检查关于 SO 的无数问题。

> “我将此 alter session 语句与 Select 语句结合使用以正确显示日期”

你没有。你有两个选择。第一个 - 在我看来更好 - 选项是以 Oracle 规范格式返回日期，并让客户端软件决定如何显示它。或者，您可以使用 TO_CHAR 并应用您想要的格式掩码；只是现在您已将日期转换为字符串，这可能会产生不良后果。

如果您可以说服您的 DBA，您的首选格式是 One True Format，那么他们可以全局更改 NLS_DATE_FORMAT，因此每个人都会看到您希望呈现的日期（除非他们更改自己的本地设置）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:31:51.090

因此，将格式添加到您的选择语句中：

```
select to_char(date_column, 'YYYY/MM/DD HH:MI:SS')
from my_table 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:21:31.120

自从我使用 Oracle 以来已经发生了很多事情，但正如我所见，您正在使用过滤器来指示 Oracle 如何将字符串读取为日期。如果是这样，您是否考虑过匹配斜线（左）和减号（右）？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:23:42.840

尝试 ：

```
INSERT INTO Log_Table 
    VALUES ('Mismatch', 'C:\Folder-SBX2\', '\Subfolder1\', 'm1.txt', 
        '37587b066cf68b3870101c4bbc1a5dc0', 'SBX2', '7.2 SP13 CC5', 
        To_Date('2013-04-04 11:46:06', 'YYYY-MM-DD HH:MI:SS')); 
```

`HH`并且`HH12`是等价的。

# c++ - OpenCV checkVector() 在其他有效向量上抛出的断言 >

> ID：16194373
> 
> 赞同：2
> 
> 时间：2013-04-24T14:15:57.140
> 
> 标签：c++, opencv, assert, camera-calibration

整晚都在追这个bug，所以请原谅任何不连贯的地方。

我正在尝试使用 OpenCV`calibrateCamera()`从一组 15 张图片中提取内在和外在参数，这些图片的对象点和世界点都已给出。从调试中可以看出，我正在从输入文件中获取有效点并将它们放在 a`vector<Point3f>`中，而它本身又放在另一个`vector`.

`calibrateCamera()`我把整个shebang传给

```
double rms = calibrateCamera(worldPoints, pixelPoints, src.size(), intrinsic, distCoeffs, rvecs, tvecs); 
```

抛出`Assertion failed (ni >= 0) in unknown function, file ...\calibration.cpp, line 3173`

拉起这个文件给了我们

```
static void collectCalibrationData( InputArrayOfArrays objectPoints,
                                InputArrayOfArrays imagePoints1,
                                InputArrayOfArrays imagePoints2,
                                Mat& objPtMat, Mat& imgPtMat1, Mat* imgPtMat2,
                                Mat& npoints )
{
int nimages = (int)objectPoints.total();
int i, j = 0, ni = 0, total = 0;
CV_Assert(nimages > 0 && nimages == (int)imagePoints1.total() &&
    (!imgPtMat2 || nimages == (int)imagePoints2.total()));

for( i = 0; i < nimages; i++ )
{
    ni = objectPoints.getMat(i).checkVector(3, CV_32F);
    CV_Assert( ni >= 0 );
    total += ni;
}
... 
```

据我所知，a`Point3f`具有`CV_32F`深度，并且在调用 calibrateCamera 之前，我可以在双向量中看到良好的数据。

有什么想法可能在这里发生吗？`calibrateCamera()`需要 a `vector<vector<Point3f>>`，如[http://aishack.in/tutorials/calibrating-undistorting-with-opencv-in-c-oh-yeah/](http://aishack.in/tutorials/calibrating-undistorting-with-opencv-in-c-oh-yeah/)和文档所述；希望 getMat(i) 不会因此而失败。

它可能`vector<vector<Point2f>>`在它之后的像素点上被调用吗？我经历了太多的错误，我愿意相信任何事情。

**编辑：** 因此，`checkVector()`的文档并没有真正的帮助

```
int cv::Mat::checkVector    (int elemChannels, int  depth = -1, bool RequireContinuous = true) const

returns N if the matrix is 1-channel (N x ptdim) or ptdim-channel (1 x N) or (N x 1); negative number otherwise 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-10T14:54:38.320

问题可能出在您的 InputArrayOfArrays 参数之一中（确切地说，在 worldPoints 中，如果断言是从粘贴在您问题中的行中抛出的）。Mat:s 在这里应该可以正常工作。

我通过使所有 3 个 InputArrayOfArrays（或向量 > 和向量 > 在我的例子中）具有完全填充的条目的相同长度向量解决了我的代码中的相同断言错误。所以我的问题出在我的架构中：我的 objectPoints 向量包含空条目（即使现有数据是有效的），并且 calibrate.cpp 要求 3 个 InputArrayOfArrays 中的任何一个中都不存在空条目。顺便说一句，我使用灰度图像来校准单通道数据。

在 calib3d 源中，如果您检查了数据类型是否匹配，则引发错误的最可能原因是 null 值。您可以尝试仔细检查您的有效输入数据：

1）从您选择的结构中计算有效校准图像的数量 `validCalibImages = (int)goodCalibrationImages.size()`

2) 将 worldPoints 定义为`vector<vector<Point3f> > worldPoints`

3) 重要：调整大小以适应每个校准条目的数据 `worldPoints.resize(validCalibImages)`

4）填充数据，例如

```
for(int k = 0; k < (int)goodCalibImages.size(); k++){
for(int i = 0; i < chessboardSize.height; i++){
for(int j = 0; j < chessboardSize.width; j++){
                objectPoints[k].push_back(Point3f(i*squareSize, j*squareSize, 0));
            }
        }
    } 
```

' 希望能帮助到你！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-07-29T20:17:07.450

我同意 FSaccilotto - 调用 checkVector 并确保您传递的是大小为 n 的`Mat 1x1:{3 channel}`向量而不是向量`Mat 1 x n:{3 channel}`或更糟的向量，`Mat 1 x n:{2 channel}`这就是 MatOfPoint 吐出的。这通常可以解决 90% 的断言失败问题。自己明确声明 Mat。

对象模式有点奇怪，因为 xyz 坐标在通道中而不是在 Mat 尺寸中。

# symfony - getResult 返回除 SQL 查询 Symfony2 之外的另一个结果

> ID：16194374
> 
> 赞同：3
> 
> 时间：2013-04-24T14:15:58.410
> 
> 标签：symfony, doctrine

只需要加入第一个上传到他的画廊图片的会员，但有一个大问题，因为我是 symfony 的新手。

表：

```
CREATE TABLE `member` (
`member_id` int(10) NOT NULL AUTO_INCREMENT,
`name` varchar(256) COLLATE utf8_unicode_ci NOT NULL,
 PRIMARY KEY (`member_id`)
 ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `image` (
`image_id` int(10) NOT NULL AUTO_INCREMENT,
`member_id` int(10) NOT NULL,
`path` varchar(256) COLLATE utf8_unicode_ci NOT NULL,
PRIMARY KEY (`image_id`),
KEY `image_member_id_idx` (`member_id`),
CONSTRAINT `image_member_id` FOREIGN KEY (`member_id`) REFERENCES `member` (`member_id`)             ON DELETE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

行动：

```
$items = $this->getDoctrine()
              ->getManager()
              ->getRepository('AcmeMyBundle:Member')
              ->createQueryBuilder('m')
              ->select('m','i')
              ->leftJoin('Acme\MyBundle\Entity\Image', 'i', 'WITH','i.memberId = m.memberId')
              ->addGroupBy('m.memberId')
              ->setMaxResults(10)
              ->getQuery()
              ->getArrayResult(); 
```

它返回 2 倍于数据库中的记录，而不是在我打印`->getQuery->getSQL()`时返回的限制和分组设置

```
SELECT m0_.member_id AS member_id0, 
m0_.name AS name1, 
i1_.image_id AS image_id2, 
i1_.path AS path3, 
i1_.member_id AS member_id4 
FROM member m0_ 
LEFT JOIN image i1_ 
ON (i1_.member_id = m0_.member_id) 
GROUP BY m0_.member_id LIMIT 10 
```

并且此查询在直接从数据库执行时返回正确答案。我需要帮助哪里可能出错？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T23:17:44.700

如果您已正确映射 OneToMany 关系，则不应使用以下列显式加入：

```
->leftJoin('Acme\MyBundle\Entity\Image', 'i', 'WITH','i.memberId = m.memberId') 
```

反而：

```
->leftJoin('Acme\MyBundle\Entity\Image', 'i') 
```

你能告诉我们你的实体吗？

另外，您是否考虑过使用`->getResult()`（物体水合）？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-12T15:46:50.323

我有一个类似的问题。

在我的情况下，有重复的 id（是 db 中的一个视图），所以当学说填充对象时，只为每个重复的行创建一个对象。

我为目标实体（'entityAlias'）添加了一个不同的对象，以便在两种情况下获得相同的响应。

`$queryBuilder = $this->createQueryBuilder('entityAlias'); $queryBuilder->leftJoin(...) ->distinct('entityAlias');`

这为我解决了这个问题。

# javascript - jQuery 是否从被破坏的 DOM 内容中删除事件侦听器？

> ID：16194375
> 
> 赞同：9
> 
> 时间：2013-04-24T14:16:00.823
> 
> 标签：javascript, jquery, memory-leaks, jquery-events

对于 Ajax 应用程序，我反复使用 jQuery 的`html()`方法来更新 DOM 容器（覆盖 HTML 内容，然后将元素绑定到事件侦听器）。

附加到被破坏内容的事件监听器是否被 jQuery 正确删除，或者是否存在内存泄漏的风险？（这里已经有一些相关的问题，但我找不到答案）。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T14:19:05.017

是的，当您使用 jQuery 方法删除或替换内容时，所有事件和数据都会被清除。它是使用内部`cleanData`方法完成的。

[https://github.com/jquery/jquery/blob/1.9-stable/src/manipulation.js#L242](https://github.com/jquery/jquery/blob/1.9-stable/src/manipulation.js#L242) [https://github.com/jquery/jquery/blob/1.9-stable/src/manipulation.js#L746](https://github.com/jquery/jquery/blob/1.9-stable/src/manipulation.js#L746)

# python - Python (newbie): how using imported function into my functions?

> ID：16194378
> 
> 赞同：0
> 
> 时间：2013-04-24T14:16:06.707
> 
> 标签：python, urllib

This code will not work

```
import urllib

def loadHtml (url):
    response = urllib.open(url)
    html = response.read()
    return html

firstUrl = 'http://www.google.it';
html = loadHtml (firstUrl); 
```

This is the error

```
File "af1.py", line 10, in <module>
    html = loadHtml (firstUrl);
File "af1.py", line 5, in loadHtml
    response = urllib.open(url) 
```

I'm at my second day on python .. what's the problem now ?

```
AttributeError: 'module' object has no attribute 'open' 
```

EDIT: **I've not searched for open in urllib because I was not understanding what Python mean by 'module'**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T14:18:19.667

也许`urllib.urlopen()`是你需要的，不是`urllib.open()`吗？

您可以在库中找到更多文档：

*   在官方文档中： http: [//docs.python.org/2/library/urllib.html](http://docs.python.org/2/library/urllib.html)
*   或者通过调用`help(urllib)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:18:37.507

问题正如它所说的那样，`urllib`没有一个名为`open()`.

也许你的意思是[`urllib.urlopen()`](http://docs.python.org/2/library/urllib.html#urllib.urlopen)。

在不离开 Python 的情况下解决此类问题的一种方法是使用`dir()`模块上的函数，并使用一些简单的代码来搜索列表：

```
>>> import urllib
>>> [x  for x in dir(urllib) if x.find("open") >= 0]
['FancyURLopener', 'URLopener', '_urlopener', 'urlopen'] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-24T14:19:32.753

错误是该`urllib`模块没有名为`open`.

```
>>> 'open' in dir(urllib)
False 
```

请参阅以下片段，了解如何了解模块包含的内容。

```
>>> import urllib
>>> dir(urllib)
['ContentTooShortError', 'FancyURLopener', 'MAXFTPCACHE', 'URLopener', '__all__', '__builtins__', '__doc__', '__file__', '__name__', '__package__', '__version__', '_ftperrors', '_have_ssl', '_hexdig', '_hextochr', '_hostprog', '_is_unicode', '_localhost', '_noheaders', '_nportprog', '_passwdprog', '_portprog', '_queryprog', '_safe_map', '_safe_quoters', '_tagprog', '_thishost', '_typeprog', '_urlopener', '_userprog', '_valueprog', 'addbase', 'addclosehook', 'addinfo', 'addinfourl', 'always_safe', 'base64', 'basejoin', 'c', 'ftpcache', 'ftperrors', 'ftpwrapper', 'getproxies', 'getproxies_environment', 'getproxies_registry', 'i', 'localhost', 'noheaders', 'os', 'pathname2url', 'proxy_bypass', 'proxy_bypass_environment', 'proxy_bypass_registry', 'quote', 'quote_plus', 'reporthook', 'socket', 'splitattr', 'splithost', 'splitnport', 'splitpasswd', 'splitport', 'splitquery', 'splittag', 'splittype', 'splituser', 'splitvalue', 'ssl', 'string', 'sys', 'test1', 'thishost', 'time', 'toBytes', 'unquote', 'unquote_plus', 'unwrap', 'url2pathname', 'urlcleanup', 'urlencode', 'urlopen', 'urlretrieve'] 
```

你的意思是`urllib.urlopen`？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T14:19:58.490

错误原因：

```
urllib.open() 
```

也许你想做：

```
urllib.urlopen() 
```

要看到：

```
>>> dir(urllib).index('open')

Traceback (most recent call last):
  File "<pyshell#18>", line 1, in <module>
    dir(urllib).index('open')
ValueError: 'open' is not in list 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-24T15:20:39.997

@realtebo 有**很多**适合初学者的教程。您应该真正从基础开始，而不是尝试使用库。[在这里](https://www.google.com/search?q=python%20for%20beginners)查看

# android - Android data storage choice for a few fixed amount of entries, sqlite or sharedpreferences?

> ID：16194381
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:16:15.007
> 
> 标签：android, database, sqlite, sharedpreferences

I wanna make an app kind of like Google keep, which has these features:

1.  Storing the names, content, background color of every notes and photos (not including to-do lists, it's a little complicated), using `TextView` for notes, Custom View (`TextView` + `ImageView`) for photos;

2.  Entries could change position with each other by drag and drop;

3.  It could only save 10 entries at most. If there exists opening entry position, The app will fill the position with placeholder, and display all the 10 position in one screen (no scrollbar).

In my opinion, both method have some shortcomings for this situation:

Sharedpreferences: the amount of data is too much and kind of complex;

Sqlite: the data entries are limited. Besides, I think `TableLayout` is more suitable than `GridView` cus I want them display in one screen without scrollbar.

Then which data storage method should I choose, sqlite or sharedpreferences? Thanks for your help.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:29:24.307

SharedPreferences 不适合。正如您所注意到的，它不适用于如此数量和复杂性的数据。顾名思义，它用于存储用户的偏好，而不是他们的数据。

请注意，SQLite 支持可用于存储图像等的 BLOB 类型。

但您不仅限于这两个选项。第三个选项是将您的数据以您选择的任何格式存储在一个文件中，例如，您可以将您的 Java 对象序列化为一个文件。由于您将处理有限数量的数据，因此您不一定需要 SQLite 的功能。

但总的来说，我认为 SQLite 是你最好的选择。由于上面给出的原因，它比 SharedPreferences 更好，并且比第 3 个选项更好，因为它内置在 Android 中并且被广泛使用。

# php - 如果该列中已存在数据，MySQL 将数据从一列移动到另一列

> ID：16194387
> 
> 赞同：0
> 
> 时间：2013-04-24T14:16:34.497
> 
> 标签：php, mysql

我已经查看了现有的答案，但似乎找不到合适的答案，所以：

我有一个由具有许多列的 php 表单填充的数据库：

姓名 | 最新图 | 以前的图1 | 以前的图2 | 上一个_figure3

我可以使用典型的 mysql 查询来更新表，但是如果该字段中已经存在数据，我需要在更新时将数据向右移动。

例如，如果我们有：

姓名=李，最新图=80

我现在想用

name=Lee, latest_figure=85, 我想把原来的 80 的图移到 previous_figure1 列。

如果我们再次更新表，并且 name=Lee 有一个 latest_figure=88，我希望 85 移动到 previous_figure1 和 80 移动到 previous_figure2，依此类推。

保留数据的原因是出于图形原因以显示进度/恶化等。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:20:08.423

我认为你应该重写你的表。你应该有一个表：

姓名 | 图 | 时间戳

然后，您始终可以按名称和时间戳顺序获取数字，以便您知道哪个是最新的。这比总是创建一个新列要容易。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:30:15.023

如果设置了主键，您可以尝试使用 ON DUPLICATE KEY。

```
INSERT INTO table (name, latest_figure) VALUES("Lee", 85) ON DUPLICATE KEY UPDATE previous_figure3 = previous_figure2, previous_figure2 = previous_figure1, previous_figure1 = latest_figure, latest_figure = 85; 
```

希望能帮助到你 ：）

# c++ - 如何减少 MSVCRT 冲突带来的潜在问题？

> ID：16194388
> 
> 赞同：1
> 
> 时间：2013-04-24T14:16:43.440
> 
> 标签：c++, msvcrt

我有一个 Visual Studio 2010 C++ 应用程序，其中包含一些包含 Winsock2 标头的第 3 方库，当与 /MD 链接时，它会拖入 MSVCRT.dll。我选择重新编译这些第 3 方库（使用 VS2010），以便***“下推堆栈”***这种对 MSVCRT.dll 的依赖，从而减少由于此与应用程序与 MSVCR100 的链接之间的不兼容而导致的任何[潜在问题](https://stackoverflow.com/questions/7456271/msvcr100-and-msvcrt)的机会.dll。

1.  这通常准确吗***，***即它是否减少了 CRT 库不匹配导致应用程序崩溃的机会？我认为将依赖项推得越低，隔离 API 模块和客户端之间潜在冲突的机会就越大。
2.  更具体地说，当使用不同版本的 CRT（即在我的示例中重新编译的第 3 方库）暴露给模块时，Winsock2 API 是否会暴露任何危险？或者我可以假设应用程序是安全的并且第 3 方库会正常运行吗？

# html - 使用 xlHTML 属性将图表从 excel 发布到 HTML 时出现问题

> ID：16194395
> 
> 赞同：1
> 
> 时间：2013-04-24T14:17:04.463
> 
> 标签：html, vba, excel

我正在尝试将图表从 excel 发布到 HTML 文件，我希望在自动 Outlook 邮件中进一步使用。下面是代码：

```
Sub SaveChartWeb()
Dim wb As Workbook
Dim ws As Worksheet
Set wb = ActiveWorkbook
Set ws = ActiveSheet
wb.PublishObjects.Add _
    SourceType:=xlSourceChart, _
    Filename:=wb.Path & "\Sample2.htm", _
    Sheet:=ws.Name, _
    Source:="Chart 22", _
    HtmlType:=xlHtmlChart

wb.PublishObjects(1).Publish (True)
End Sub 
```

当我运行此代码时，它会引发以下错误：“运行时 1004：此版本在 excel 中不再支持此方法或属性”

我已经尝试了所有可能的 sourcetype 和 HTMLtype 组合。当我使用 xlHTMLstatic 时，它可以工作，但它会发布整个工作表，这是不需要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:51:53.127

除了我的评论，试试这个

```
Sub SaveChartWeb()
    Dim wb As Workbook
    Dim ws As Worksheet

    Set wb = ThisWorkbook
    Set ws = wb.Sheets("Sheet1")

    ws.ChartObjects("Chart 1").Activate
    ActiveChart.Location Where:=xlLocationAsNewSheet

    With wb.PublishObjects.Add(xlSourceChart, "C:\Sample.htm", ActiveChart.Name _
        , "", xlHtmlStatic, "", "")
        .Publish (True)
    End With
End Sub 
```

您始终可以将图表移回工作表或关闭原始文件而不保存。

# dom - inject a javascript function into an Iframe

> ID：16194398
> 
> 赞同：40
> 
> 时间：2013-04-24T14:17:13.217
> 
> 标签：dom, iframe, head, javascript

[This link](http://jaspreetchahal.org/how-to-inject-javascript-into-an-iframe/) ([archived version](http://web.archive.org/web/20160922170751/http://jaspreetchahal.org/how-to-inject-javascript-into-an-iframe/)) describes how to inject code from a script into an iframe:

```
function injectJS() {
  var iFrameHead = window.frames["myiframe"].document.getElementsByTagName("head")[0];
  var myscript = document.createElement('script');
  myscript.type = 'text/javascript';
  myscript.src = 'myscript.js'; // replace this with your SCRIPT
  iFrameHead.appendChild(myscript);
} 
```

That's ok, but what if I want to insert a function object into an iframe *and get it executed in the iframe context*? Let's say I have:

```
function foo () {
    console.log ("Look at me, executed inside an iframe!", window);
} 
```

and I want to insert foo's code inside an iframe? (**function foo could be something loaded dynamically, I can't just wrap it in quotes**)

I naively tried:

`var scriptFooString = "<script>" + foo.toString() + "</script>"`

to get the code inside function, but

*   I don't know how to insert it in the iframe HEAD (maybe with jquery?)
*   I don't know if it's the right way
*   I don't know what happens when if function is way more complex than that
*   I don't know what happens with double and single quotes in `scriptFooString`

Any hint?

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-24T14:29:37.863

首先，如果您的框架和显示它的页面在同一个域中，您只能完成此操作（由于跨域规则）

其次可以通过JS直接操作frame的dom和window对象：

```
frames[0].window.foo = function(){
   console.log ("Look at me, executed inside an iframe!", window);
} 
```

要从 DOMElement 对象中获取框架，您可以使用：

```
var myFrame = document.getElementById('myFrame');

myFrame.contentWindow.foo = function(){
       console.log ("Look at me, executed inside an iframe!");
} 
```

请注意，foo 中的范围没有改变，因此 window 仍然是 foo 中的父窗口等。

如果你想注入一些需要在另一个框架的上下文中运行的代码，你可以注入一个脚本标签，或者评估它：

```
frames[0].window.eval('function foo(){ console.log("Im in a frame",window); }'); 
```

虽然普遍的共识是永远不要使用 eval，但如果你真的需要这样做，我认为它比 DOM 注入更好。

因此，在您的特定情况下，您可以执行以下操作：

```
frames[0].window.eval(foo.toString()); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-12-23T12:51:56.420

这段代码是我研究的结果。接受的答案也对我有很大帮助。首先，我创建了一个简单的 iframe：

```
<iframe id="myiframe" width="200" height="200" srcdoc="<h1 id='title'>Hello from Iframe</h1><button type='button' id='fire'>Click Me!</button>
"></iframe> 
```

为了访问 iframe 的窗口和文档，我使用了这段代码。

```
const iframe = document.getElementById('myiframe');
const iframeWin = iframe.contentWindow || iframe;
const iframeDoc = iframe.contentDocument || iframeWin.document; 
```

最后我将js代码注入iframe：

```
var script = iframeDoc.createElement("script");
  script.append(`
    window.onload = function() {
     document.getElementById("fire").addEventListener('click', function() {
        const text = document.getElementById('title').innerText;
        alert(text);
     })
  }
`);
  iframeDoc.documentElement.appendChild(script); 
```

**演示：** [https ://jsfiddle.net/aliam/1z8f7awk/2/](https://jsfiddle.net/aliam/1z8f7awk/2/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-14T03:52:55.163

这是我的解决方案。我正在使用 jquery 插入内容，然后使用 eval 在该 iframe 的上下文中执行脚本标签：

```
 var content = $($.parseHTML(source, document, true));
    $("#content").contents().find("html").html(content);
    var cw = document.getElementById("content").contentWindow;
    [].forEach.call(cw.document.querySelectorAll("script"), function (el, idx) {
        cw.eval(el.textContent);
    }); 
```

# windows - GetDlgItem, works in one class and not in another

> ID：16194408
> 
> 赞同：1
> 
> 时间：2013-04-24T14:17:28.523
> 
> 标签：windows, mfc

I am trying to use the function GetDlgItem(int id) and not the GetDlgItem(HWND par, int id). In other parts my code I use GetDlgItem as such

```
CWnd * pWnd;
pWnd = GetDlgItem(IDC_UPPER_BTN); 
```

And it works fine. But in another class I am trying to do the exact same thing and it keeps demanding a HWND.

When I search GetDlgItem I see there is a MFC and a windows version. How can I specify which one I want to use?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:47:25.830

您可以使用以下方法显式指定成员函数：

```
this->GetDlgItem(...); 
```

您可以使用以下命令显式指定全局函数：

```
::GetDlgItem(...); 
```

# python - 从 DirectShow comtype 访问 GetCurrentImage() 时出现 Python 内存泄漏

> ID：16194410
> 
> 赞同：1
> 
> 时间：2013-04-24T14:17:32.613
> 
> 标签：python, memory-leaks, directshow, video-capture, comtypes

我必须调试有内存泄漏的其他人的代码。它耗尽了所有 RAM，然后最终崩溃（以 4Mb/s 的速率）。我将其隔离为一个调用，该调用获取视频过滤器的屏幕截图并将其保存到名为**lbDib**的对象中。但是 Python 并没有在使用后释放它。我试图删除它，然后调用 gc.collect()。我已将其分配为零或无等。但内存没有被释放。

经过一番谷歌搜索后，我发现了这个：

[http://msdn.microsoft.com/en-us/library/windows/desktop/dd390556%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/dd390556%28v=vs.85%29.aspx)

其中指出：

> VMR 为图像分配内存并在 lpDib 变量中返回指向它的指针。调用者必须通过调用 CoTaskMemFree 来释放内存。

当我研究内存管理时，我不断地遇到 python 垃圾收集器是自切片以来最好的东西，如果你试图清理内存，你会做错事。

这是创建没有被释放的内存的行：

```
lpDib = vmr_windowless_control.GetCurrentImage() 
```

**vmr_windowless_control**来自哪里：

```
vmr_windowless_control = vmr_config.QueryInterface(IVMRWindowlessControl) 
```

vmr_config的**来源**：

```
vmr_config = self.filter.QueryInterface(IVMRFilterConfig)      
vmr_config.SetRenderingMode(Renderer.VMRMode[vmrmode] 
```

IVMRFilterConfig来自 COMtype DirectShowLib 导入的地方 **：**

```
try:
    from comtypes.gen.DirectShowLib import (ICreateDevEnum, IBaseFilter, IBindCtx,
                                            IMoniker, IFilterGraph,
                                            IVMRFilterConfig,
                                            IVMRWindowlessControl, IAMCrossbar,
                                            IAMTVTuner, IAMStreamConfig,
                                            IAMVideoProcAmp, IFilterMapper2)
except ImportError:
    GetModule("DirectShow.tlb") # Create gen.DirectShowLib if it doesn't exist
    from comtypes.gen.DirectShowLib import (ICreateDevEnum, IBaseFilter, IBindCtx,
                                            IMoniker, IFilterGraph,
                                            IVMRFilterConfig,
                                            IVMRWindowlessControl, IAMCrossbar,
                                            IAMTVTuner, IAMStreamConfig,
                                            IAMVideoProcAmp, IFilterMapper2) 
```

不知道如何攻击这个，大脑被炸了。提前感谢任何帮助或线索。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T09:36:18.937

只需要添加以下内容：

```
from ctypes import windll
windll.ole32.CoTaskMemFree(lpDib) 
```

谢谢大家

# javascript - Instantiating JavaScript module pattern

> ID：16194418
> 
> 赞同：3
> 
> 时间：2013-04-24T14:17:42.377
> 
> 标签：javascript

I'm trying to create multiple instances of a slider on a page. Each slider should know which slide it’s currently viewing. It seems that when I update the `slide` property, I change it for the class, and not the instance. This suggests to me that I'm not instantiating properly in my public `init()` function. Where am I going wrong?

```
var MySlider = (function() {

    'use strict';

    var animating = 0,
           slides = 0, // total slides
           slider = null,
            slide = 0, // current slide
             left = 0;

    function slideNext(e) {
        if ((slide === slides - 1) || animating) return;

        var slider = e.target.parentNode.children[0],
                 x = parseFloat(slider.style.left);

        animate(slider, "left", "px", x, x - 960, 800);
        slide++;
    }

    return {
        init: function() {
            var sliders = document.querySelectorAll('.my-slider'),
                      l = sliders.length;

            for (var i = 0; i < l; i++) {
                sliders[i] = MySlider; // I don't think this is correct.

                slider = sliders[i];

                buildSlider(slider);

            }
        }
    }

})(); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T14:57:00.063

根据您的评论，我认为这更像您想要的：

```
MySlider = (function () {
    Slider = function (e) {
        this.e = e;
        // other per element/per slider specific stuff
    }

    ...

    var sliders; // define this out here so we know its local to the module not init

    return {
        init: function () {

            sliders = document.querySelectorAll('.my-slider');
            var l = sliders.length;

            for (var i = 0; i < l; i++) {
                sliders[i] = new Slider(sliders[i]); //except I'd use a different array

                slider = sliders[i];

                buildSlider(slider);
        }
    }
})(); 
```

这样，您将每个元素与它自己的元素特定数据相关联，但是您有一个包含模块，您可以在其中对您的模块集合进行操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T14:22:55.420

> 似乎当我更新幻灯片属性时，我为类而不是实例更改它。

你是对的。该代码仅在定义 MySlider 类时运行。如果你想要一个实例变量，你需要在返回的对象中声明它，即你的返回块的一部分：

```
 var MySlider = (function(param) {
    return {
       slider: param, 

       init: function() {
            var sliders = document.querySelectorAll('.my-slider'),
                      l = sliders.length;

            for (var i = 0; i < l; i++) {
                sliders[i] = MySlider; // I don't think this is correct.

                slider = sliders[i];

                buildSlider(slider);

            }
        }
}); 
```

# ruby-on-rails - 设计发送重置密码指令“nil:NilClass 的未定义方法‘slice’”

> ID：16194420
> 
> 赞同：1
> 
> 时间：2013-04-24T14:17:48.413
> 
> 标签：ruby-on-rails, devise, ruby-on-rails-3.2

我在 rails (3.2.12) 应用程序中使用设计 (2.2.3)。

我有 2 个设计模型，设计 Admin 和 User 在设计模型 Admin authentication_keys 使用电子邮件和 User authentication_keys 使用用户名（但仍然有电子邮件），管理模型完全正常工作，但忘记密码功能的用户模型已决定停止工作。当我输入电子邮件地址并单击“向我发送重置说明”时，我收到如下错误消息：

```
NoMethodError in PasswordusersController#create

undefined method `slice' for nil:NilClass 
```

`passwordadmins_controller.rb`with之间没有显着差异`passwordusers_controller.rb`，唯一的区别是命名

我该怎么做才能解决这个问题？

这`passwordusers_controller.rb`

```
class PasswordusersController < Devise::PasswordsController

  prepend_before_filter :require_no_authentication
  append_before_filter :assert_reset_token_passed, :only => :edit

  def new
    super
  end

  def create
    self.resource = resource_class.send_reset_password_instructions(resource_params)

    if successfully_sent?(resource)
      redirect_to new_session_user_path, :notice => "Instruction Send To Your Email"
    else
      respond_with(resource)
    end
  end

  def edit
    super
  end

  def update
    self.resource = resource_class.reset_password_by_token(resource_params)

    if resource.errors.empty?
      resource.unlock_access! if unlockable?(resource)
      flash_message = resource.active_for_authentication? ? :updated : :updated_not_active
      set_flash_message(:notice, flash_message) if is_navigational_format?
      sign_in(resource_name, resource)
      redirect_to home_subdomain_path, :notice => "Password changed"
    else
      respond_with resource
    end
  end

  protected

    def after_sending_reset_password_instructions_path_for(resource_name)
      new_session_user_path
    end

    def assert_reset_token_passed
      if params[:reset_password_token].blank?
        set_flash_message(:error, :no_token)
        redirect_to new_session_user_path
      end
    end

    def unlockable?(resource)
      resource.respond_to?(:unlock_access!) &&
        resource.respond_to?(:unlock_strategy_enabled?) &&
        resource.unlock_strategy_enabled?(:email)
    end

end 
```

更新

```
<%= form_for("User", :url => passwordusers_create_path(resource_name), :html => { :method => :post }) do |f| %>
   <%= render 'layouts/flash_messages' %>
   <div class="row-fluid">
     <div class="input-prepend">
      <span class="add-on"><i class="icon-envelope"></i></span>
      <%= f.email_field :email, 'style' => 'width:240px;', :placeholder => 'Email' %>
      </div>
     <div class="dr"><span></span></div>             
      <%= f.submit "Send", :class => 'btn btn-block btn-primary' %>
     <div class="dr"><span></span></div>                               
</div>
<% end %> 
```

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:23:45.053

资源设计默认使用小写字母，试试这个，

```
form_for("User" ..... 
```

改成

```
form_for("user" 
```

# arrays - Non-cell array with uigetfile in Matlab

> ID：16194424
> 
> 赞同：2
> 
> 时间：2013-04-24T14:18:16.420
> 
> 标签：arrays, matlab, cell

My code has 2 parts. First part is an automatic file opening programmed like this :

```
fichierref = 'H:\MATLAB\Archive_08112012';
files = dir(fullfile(fichierref, '*.txt'));
numberOfFiles = numel(files);
delimiterIn = ' ';
headerlinesIn = 11;
for d = 1:numberOfFiles
    filenames(d) = cellstr(files(d).name);
end

for i=1:numberOfFiles
    data = importdata(fullfile(fichierref,filenames{i}),delimiterIn,headerlinesIn);
end 
```

Later on, I want the user to select his files for analysis. There's a problem with this though. I typed the lines as follow :

```
reference = warndlg('Choose the files from which you want to know the magnetic field');
uiwait(reference);
filenames = uigetfile('./*.txt','MultiSelect', 'on');
numberOfFiles = numel(filenames);
delimiterIn = ' ';
headerlinesIn = 11; 
```

It's giving me the following error, after I press OK on the prompt:

```
Cell contents reference from a non-cell array object.

Error in FreqVSChampB_no_spec (line 149)
data=importdata(filenames{1},delimiterIn,headerlinesIn); 
```

I didn't get the chance to select any text document. Anyone has an idea why it's doing that?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:26:59.563

`uigetfile`与“MultiSelect”一起使用时有点烦人：当您选择多个文件时，输出将作为（字符串）元胞数组返回。**但是**，当只选择一个文件时，输出是字符串类型（**不是**像预期的那样具有单个单元格的单元格数组）。

所以，为了解决这个问题：

```
filenames = uigetfile('./*.txt','MultiSelect', 'on');
if ~iscell(filenames) && ischar( a )
    filenames = {filenames}; % force it to be a cell array of strings
end
% continue your code here treating filenames as cell array of strings. 
```

**编辑：**
正如@Sam 所指出的，必须验证用户没有在 UI 上按下“取消”（通过检查这`filenames`是一个字符串）。

# sql-server-2008-r2 - 在 SQL Server 2008R2 中，我可以强制视图使用用户默认架构中的对象，而不是视图所在的架构吗？

> ID：16194432
> 
> 赞同：2
> 
> 时间：2013-04-24T14:18:25.410
> 
> 标签：sql-server-2008-r2

一点背景。我有一个基本应用程序，大多数客户将其用作标准。然而，一些客户有小的代码和数据库定制。这些客户端中的每一个都有自己的分支，维护可能很棘手。

我想将所有这些整合到一个单一的数据库结构中（不是一个单一的数据库——我们不是在做多租户），以便以更统一的方式应用升级。我仍处于概念验证阶段，但我要走的路线是让标准对象保留在它们当前存在的模式中（主要是 dbo），并让自定义对象位于每个客户端的模式中。

例如，我可以有 dbo.users 和 client1.users 有一些额外的列。如果我将客户端的默认架构设置为“client1”，则以下查询

```
SELECT * FROM users 
```

将根据连接的登录名从 client1 模式或 dbo 模式返回数据。这对于我想要实现的目标来说绝对是完美的。

我遇到的问题是视图。我有很多在 dbo 模式中的视图，并引用了用户表。无论我以哪个用户身份连接到数据库，这些视图总是从 dbo.users 中选择。

所以我猜我的问题是：我可以在视图中的表前面加上一些变量，比如“DEFAULT”吗？例如

```
SELECT u.username, u.email, a.level
FROM DEFAULT.users u INNER JOIN accessLevels a ON u.accessID = a.accessID 
```

如果这是不可能的，而且我完全是在找错树，你对我如何实现我打算做的事情有什么建议吗？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-03T22:14:03.450

只需引用视图所在的架构的名称...

选择一个。*，乙。* 从 schema1.TABLEA A 在 A.ID = B.ID 上连接 schema2.TABLEB B

# ssl - 将自签名证书添加到 Heroku 应用程序

> ID：16194435
> 
> 赞同：6
> 
> 时间：2013-04-24T14:18:34.210
> 
> 标签：ssl, heroku, self-signed

我正在尝试将自签名证书添加到我在 Heroku 上的一个应用程序中。我已按照开发中心的指南进行操作。

[https://devcenter.heroku.com/articles/ssl](https://devcenter.heroku.com/articles/ssl)和[https://devcenter.heroku.com/articles/ssl-certificate-self](https://devcenter.heroku.com/articles/ssl-certificate-self)

生成自签名证书后，我尝试通过 heroku certs 添加证书：add server.crt server.key

并得到错误信息： Resolving trust chain... failed ！没有提供的证书是域名证书。

我不确定这意味着什么或如何解决问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-26T15:32:04.293

您必须将 CN 设置为您为其颁发证书的域。

# jquery - 记录页面刷新后经过的时间

> ID：16194436
> 
> 赞同：0
> 
> 时间：2013-04-24T14:18:34.840
> 
> 标签：jquery

有没有一种方法可以记录并在控制台中输出自刷新特定 jquery 操作以来经过的时间？

我有这个代码：

```
$(document).ready(function(){
    $('.content').load('url.jsp', function(){
        //some code or plugin that changes the layout of loaded content

        $('.content').fadeIn();
    });
}); 
```

我想要从刷新到`fadeIn`发生的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:20:56.740

使用`Date`对象，或者`console.time`如果您的浏览器支持。

```
console.time('foo');
var d = new Date();

$(document).ready(function(){
    $('.content').load('url.jsp', function(){

        console.timeEnd('foo');
        console.log(new Date.getTime() - d.getTime() + 'ms');

        $('.content').fadeIn();
    });
}); 
```

# ios - What happens when you close a file using iOS 'Protected Unless Open' encryption?

> ID：16194440
> 
> 赞同：6
> 
> 时间：2013-04-24T14:18:46.670
> 
> 标签：ios, security

Apple's Documentation says the following:

> **Protected Unless Open.** Files are encrypted. A closed file is inaccessible when the device is locked. After the device is unlocked, your app can open and use the file. If the user has a file open and locks the device (for example, by pressing the sleep button), your app can continue to access the file.

[Enabling Store Technologies](https://developer.apple.com/library/ios/documentation/IDEs/Conceptual/AppDistributionGuide/ProvisioningStoreTechnologies/ProvisioningStoreTechnologies.html#//apple_ref/doc/uid/TP40012582-CH14-SW26)

And also:

> **Complete unless already open.** The file is encrypted. A closed file is inaccessible while the device is locked. After the user unlocks the device, your app can open the file and use it. If the user locks the device while the file is open, though, your app can continue to access it. Specify the NSDataWritingFileProtectionCompleteUnlessOpen option (NSData) or the NSFileProtectionCompleteUnlessOpen attribute (NSFileManager).

[Protecting Data Using On-Disk Encryption](https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/AdvancedAppTricks/AdvancedAppTricks.html#//apple_ref/doc/uid/TP40007072-CH7-SW11)

This seems like a great option for allowing me to finish up any remaining work on the file and then closing it myself. What the documentation doesn't say is what happens to the file when I close it. For instance what happens when:

1.  User opens app and opens file within app
2.  User locks device (file remains unprotected because it is open)
3.  App performs remaining operations on file
4.  App closes the file

Now, is the file protected since it is now closed? Or can it be reopened?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-07-16T05:21:55.253

它使用公钥来确保在设备解锁之前无法打开文件。

> **受保护，除非打开**
> **(NSFileProtectionCompleteUnlessOpen)**: 某些文件可能需要在设备锁定时写入。一个很好的例子是在后台下载邮件附件。这种行为是通过使用非对称椭圆曲线加密（ECDH over Curve25519）实现的。除了通常的每个文件密钥外，Data Protection 还会生成一个文件公钥/私钥对。使用文件的私钥和受保护的除非开放类公钥计算共享机密，其对应的私钥受用户密码和设备 UID 保护。每个文件的密钥与此共享密钥的哈希一起包装，并与文件的公钥一起存储在文件的元数据中；然后从内存中擦除相应的私钥。一旦文件关闭，每个文件的密钥也会从内存中擦除。要再次打开文件，共享密钥是使用 Protected unless Open 类的私钥和文件的临时公钥重新创建的；它的哈希用于解包每个文件的密钥，然后用于解密文件。

来自[http://images.apple.com/iphone/business/docs/iOS_Security_Oct12.pdf](http://images.apple.com/iphone/business/docs/iOS_Security_Oct12.pdf)（第 10 页）

# c++ - 仪器一直告诉我我有内存泄漏

> ID：16194441
> 
> 赞同：15
> 
> 时间：2013-04-24T14:18:57.273
> 
> 标签：c++, qt, memory-leaks

我是 mac 和仪器的新手，我用它来测试我的 Qt 应用程序，我发现了很多泄漏的对象，几乎所有这些对象都来自 Qt lib。我非常仔细地检查了我的代码，但找不到问题。为了避免内存泄漏的问题，我严格遵守 RAII 的规则，总是让类处理资源，确保每个小部件都有一个父级，那些没有父级（意图）的小部件将由智能指针或 Qt::WA_DeleteOnClose 保护。

为了修复内存泄漏警告，我编写了一个非常简单的 Qt 应用程序并将其用作测试，仪器总是显示我有一些内存泄漏（如图），即使是我创建的最简单的 Qt 应用程序。

```
 #include <QApplication>
    #include <QLabel>

        int main(int argc, char *argv[])
    {
        QApplication a(argc, argv);

        QLabel w;
        w.resize(320, 240);
        w.show();

        return a.exec();
    } 
```

仪器图表

![调用树](https://i.stack.imgur.com/oW7Hf.png)

![泄漏的物体](https://i.stack.imgur.com/frjpP.png)

我稍微修改了代码，然后看到 Instruments 显示的内存泄漏是否会持续上升。

```
#include <QApplication>
    #include <QLabel>

        int main(int argc, char *argv[])
       {
        QApplication a(argc, argv);

        for(size_t i = 0; i != 100; ++i){
        QLabel w;
        w.resize(320, 240);
        w.show();
       }
       QLabel w;
       w.resize(320, 240);
       w.show();

        return a.exec();
    } 
```

![调用树](https://i.stack.imgur.com/O5dhh.png) ![泄漏的物体](https://i.stack.imgur.com/aa7su.png)

内存泄漏确实增加了，我强烈希望这是仪器的错误，否则我不得不退回到Qt4（我不知道它是否会出现同样的问题）。我认为这并不简单应用程序可以通过mac应用商店（OSX）的质量检查。这是怎么回事？我应该如何解释这种现象？如果没有内存泄漏，我应该看不到泄漏对象的任何消息，对吗？Qt5.0.2的一个bug？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-18T23:22:11.743

内存确实被泄露了，这是一个受信任的框架绝不应该这样做的。

基本上，框架应该使用智能指针，或者应该“手动”跟踪和处理有问题的内存泄漏。

如果没有泄漏，那么所有内存将在使用后返回到堆中。

根据[bugreports.qt-project.org/browse/QTBUG-7505](https://bugreports.qt-project.org/browse/QTBUG-7505) ，此错误位于 4.6.0 版中。

# angularjs - Angular，内容类型未与 $http 一起发送

> ID：16194442
> 
> 赞同：61
> 
> 时间：2013-04-24T14:18:59.687
> 
> 标签：angularjs

Angular 没有添加正确的内容类型选项，我尝试了以下命令：

```
$http({
    url: "http://localhost:8080/example/teste",
    dataType: "json",
    method: "POST",
    headers: {
        "Content-Type": "application/json"
    }
}).success(function(response){
    $scope.response = response;
}).error(function(error){
    $scope.error = error;
}); 
```

上面的代码生成以下 http 请求：

```
POST http://localhost:8080/example/teste HTTP/1.1
Host: localhost:8080
Connection: keep-alive
Content-Length: 0
Cache-Control: no-cache
Pragma: no-cache
Origin: http://localhost:8080
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.64 Safari/537.31
Content-Type: application/xml
Accept: application/json, text/plain, */*
X-Requested-With: XMLHttpRequest
Referer: http://localhost:8080/example/index
Accept-Encoding: gzip,deflate,sdch
Accept-Language: pt-BR,pt;q=0.8,en-US;q=0.6,en;q=0.4
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3
Cookie: JSESSIONID=C404CE2DA653136971DD1A3C3EB3725B 
```

如您所见，内容类型不是“application/json”，而是“application/xml”。我在这里错过了什么吗？

* * *

## 回答 #1

> 赞同：96
> 
> 时间：2013-04-24T14:49:15.103

您需要在请求中包含一个正文。否则，Angular 会删除内容类型标头。

将参数添加`data: ''`到`$http`.

* * *

## 回答 #2

> 赞同：30
> 
> 时间：2013-04-24T16:05:40.010

```
$http({
    url: 'http://localhost:8080/example/teste',
    dataType: 'json',
    method: 'POST',
    data: '',
    headers: {
        "Content-Type": "application/json"
    }

}).success(function(response){
    $scope.response = response;
}).error(function(error){
    $scope.error = error;
}); 
```

像这样试试。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-04-28T14:20:30.207

```
 $http({
                method: 'GET',
                url:'/http://localhost:8080/example/test' + toto,
                data: '',
                headers: {
                    'Content-Type': 'application/json'
                }
            }).then(
                function(response) {
                    return response.data;
                }, 
                function(errResponse) {
                    console.error('Error !!');
                    return $q.reject(errResponse);
                } 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-09-19T02:59:15.687

伟大的！上面给出的解决方案对我有用。打电话也有同样的问题`GET`。

```
 method: 'GET',
 data: '',
 headers: {
        "Content-Type": "application/json"
 } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-11-29T15:29:06.607

以防它对任何人有用。对于 AngularJS 1.5x，我想为所有请求设置 CSRF，我发现当我这样做时：

```
$httpProvider.defaults.headers.get = { 'CSRF-Token': afToken }; 
$httpProvider.defaults.headers.put = { 'CSRF-Token': afToken };
$httpProvider.defaults.headers.post = { 'CSRF-Token': afToken }; 
```

Angular 删除了内容类型，所以我不得不添加：

```
$httpProvider.defaults.headers.common = { "Content-Type": "application/json"}; 
```

否则我会收到 415 媒体类型错误。

所以我这样做是为了为所有请求配置我的应用程序：

```
angular.module("myapp.maintenance", [])
    .controller('maintenanceCtrl', MaintenanceCtrl)
    .directive('convertToNumber', ConvertToNumber)
    .config(configure);

MaintenanceCtrl.$inject = ["$scope", "$http", "$sce", "$window", "$document", "$timeout", "$filter", 'alertService'];
configure.$inject = ["$httpProvider"];

// configure the header tokens for  CSRF for http operations in this module
function configure($httpProvider) {

    const afToken = angular.element('input[id="__AntiForgeryToken"]').attr('value');

    $httpProvider.defaults.headers.get = { 'CSRF-Token': afToken }; // only added for GET
    $httpProvider.defaults.headers.put = { 'CSRF-Token': afToken }; // added for PUT
    $httpProvider.defaults.headers.post = { 'CSRF-Token': afToken }; // added for POST

    // for some reason if we do the above we have to set the default content type for all 
    // looks like angular clears it when we add our own headers
    $httpProvider.defaults.headers.common = { "Content-Type": "application/json" };

} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-11-17T21:14:30.370

只是为了展示如何将**“Content-type”**标头动态添加到每个 POST 请求的示例。在可能的情况下，我将 POST 参数作为查询字符串传递，这是使用*transformRequest*完成的。在这种情况下，它的值为**application/x-www-form-urlencoded**。

```
// set Content-Type for POST requests
angular.module('myApp').run(basicAuth);
function basicAuth($http) {
    $http.defaults.headers.post = {'Content-Type': 'application/x-www-form-urlencoded'};
} 
```

然后从请求方法中的拦截器返回配置对象之前

```
// if header['Content-type'] is a POST then add data
'request': function (config) {
  if (
    angular.isDefined(config.headers['Content-Type']) 
    && !angular.isDefined(config.data)
  ) {
    config.data = '';
  }
  return config;
} 
```

# neventstore - EventStore RDBMS 模式索引

> ID：16194443
> 
> 赞同：1
> 
> 时间：2013-04-24T14:19:01.247
> 
> 标签：neventstore

为什么 Jonathan Oliver 的 EventStore 的 RDBMS 模式包含以下索引中的项目？

```
CREATE UNIQUE NONCLUSTERED INDEX [IX_Commits_Revisions] 
ON [dbo].[Commits] ([StreamId], [StreamRevision], [Items]); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-17T06:52:33.433

据我了解，它是为了防止针对流或聚合根提交重复的修订号。

从业务的角度来看，如果我们有一个 Person 聚合或一个 Security 聚合，那么必须针对这些或任何其他具有相同修订号的聚合进行提交是没有意义的。

此外，流修订版可用于您的应用程序中的乐观锁定。

注意：我只使用 EventStore 大约 3 个月。

# infinidb - InfiniDB 移动平均线

> ID：16194450
> 
> 赞同：0
> 
> 时间：2013-04-24T14:19:20.143
> 
> 标签：infinidb

我正在尝试编写一个从大表（> 1M 行）返回移动平均值的查询。

该表有一列带有日期，另一列带有数值。我需要最后 10 天，每个日期的 10 天移动平均值。

无论我尝试什么结果都非常缓慢（并且仅在 infinidb_vtable_mode = 0 或 2 时运行）。

是否有适当的“infinidb 方式”来进行快速移动平均（或类似的窗口函数）查询？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-15T01:48:21.183

在**InfiniDB 4.0**中，支持窗口函数，使用*AVERAGE*作为窗口函数，您可以通过以下查询获得过去 10 天的移动平均值

```
SELECT date_column, 
      AVERAGE(numeric_column) OVER (PARTITION BY date_column RANGE INTERVAL 10 DAY PRECEDING) 
FROM table_name 
```

让我知道你得到了什么结果

# html - 如何在Firefox中将表格宽度100％强制为父表单元素

> ID：16194451
> 
> 赞同：1
> 
> 时间：2013-04-24T14:19:20.047
> 
> 标签：html, css, firefox

表单包含 widt 为 100% 的表格元素：

```
<form class="browse-addtocart-form" method="post">
  <table class="productTable ui-corner-all" width="100%" cellspacing="0" cellpadding="0" border="0">
 .... 
```

在最新的 FireFox 中，表格宽度太大。左侧在表格之外。在 IE10 和 Chrome 中表格宽度是 100% 来形成的。

在 FireFox 表格宽度太大时，它被渲染得比灰色区域更宽。在 Chrome 和 IE10 页面中正确呈现。

如何在 fireFox 中也呈现适当的宽度？

jquery, jquery-ui 都用到了。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-24T14:48:26.960

您还可以将样式应用于表单本身：

```
clear: both; 
```

# sql-server - Join table to another with multiple foreign keys to the same table

> ID：16194453
> 
> 赞同：0
> 
> 时间：2013-04-24T14:19:22.663
> 
> 标签：sql-server, sql-server-2008, tsql, join

I have a table with category codes which listed in another table, there are 8 category codes and currently I'm doing the below (below is massively simplified):

```
SELECT HeaderCode
     , C1.CategoryName AS C1
     , C2.CategoryName AS C2
     , C3.CategoryName AS C3
     , C4.CategoryName AS C4
     , C5.CategoryName AS C5
     , C6.CategoryName AS C6
     , C7.CategoryName AS C7
     , C8.CategoryName AS C8

FROM Header H
INNER JOIN Cats C1 ON H.Cat1 = C1.CategoryID
INNER JOIN Cats C2 ON H.Cat2 = C2.CategoryID
INNER JOIN Cats C3 ON H.Cat3 = C3.CategoryID
INNER JOIN Cats C4 ON H.Cat4 = C4.CategoryID
INNER JOIN Cats C5 ON H.Cat5 = C5.CategoryID
INNER JOIN Cats C6 ON H.Cat6 = C6.CategoryID
INNER JOIN Cats C7 ON H.Cat7 = C7.CategoryID
INNER JOIN Cats C8 ON H.Cat8 = C8.CategoryID 
```

**[SQL Fiddle Example](http://www.sqlfiddle.com/#!3/8a52f/3/0)**

I did think about a function to get the data but it would be slow as there are 200,000+ records I need to get this information for.

Performance is so far fine but there are times I have to use dynamic SQL and doing this with another 5+ joins is a big mess.

Is there a better/more convenient/easier to maintain way to do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:31:40.333

假设您无法修复您的架构（意思是规范化您的架构），您可以像这样创建一个 Inline(!) 表值函数：

```
CREATE FUNCTION dbo.EightCats(@C1 INT, @C2 INT, @C3 INT, ...)
RETURNS TABLE
AS
RETURN
 SELECT * 
   FROM (SELECT CategoryName AS C1 FROM dbo.Cats WHERE CategoryId = @C1) T1
   CROSS JOIN (SELECT CategoryName AS C2 FROM dbo.Cats WHERE CategoryId = @C2) T2
   CROSS JOIN (SELECT CategoryName AS C3 FROM dbo.Cats WHERE CategoryId = @C2) T3
   ... 
```

然后你可以这样写你的查询：

```
SELECT H.HeaderCode, EC.*
  FROM dbo.Header H
 CROSS APPLY dbo.EightCats(H.Cat1,H.Cat2,H.Cat3,H.Cat4,H.Cat5,H.Cat6,H.Cat7,H.Cat8) EC; 
```

这应该导致相同的执行计划，因此不应该有性能损失。重要的是您仅将其用于八个类别。如果您有另一个只有七个类别的查询，则需要创建一个新函数。否则，您（或者更确切地说是 SQL Server）最终会进行不必要的连接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:31:53.920

我会用桥牌桌来做到这一点。

```
CREATE TABLE HeaderCategory (
  HeaderCategoryId int IDENTITY(1,1) NOT NULL
, HeaderId int
, CategoryId int
, SortBy int
) 
```

并将 HeaderId 和 CategoryId 外键设置为各自的表。SortBy 列用于表示是 Category1、2、3 等。

这是更“规范化”的架构。

然后，要获得与您的问题相同的查询输出，请执行简单的 PIVOT 查询。

如果您不想更改表，还有两种可能性：1）编写一个 GetCategoryName(CategoryId) 函数，并在您的选择中使用它，如下所示：SELECT Header, GetCategoryName(Category1) AS C1, ...

2) 创建一个包含 CategoryNames 的 VIEW。

# java - BXML 的等效 Java 代码

> ID：16194455
> 
> 赞同：0
> 
> 时间：2013-04-24T14:19:23.923
> 
> 标签：java, apache-pivot

我试图了解*Apache Pivot如何根据**BXML*文件中的定义构建 GUI 。我想确保我了解涉及哪些步骤以及在这些步骤中自动完成了什么。为此，我尝试将一个非常简单的 GUI 的 BXML 定义转换为纯 Java。[但是，在遵循 BXML Primer](http://pivot.apache.org/tutorials/bxml-primer.html)中描述的步骤时，布局似乎不是以相同的方式（或根本不是）完成的。

这是 BXML 文件和加载文件的随附类：

*示例.bxml*：

```
<?xml version="1.0" encoding="UTF-8"?>

<Frame xmlns="org.apache.pivot.wtk">
    <TextArea text="Hello World" />
</Frame> 
```

*WithBxml.java*：

```
public final class WithBxml extends Application.Adapter {
    @Override
    public void startup(Display display, Map<String, String> properties) throws Exception {
        Frame frame = (Frame) new BXMLSerializer().readObject(WithBxml.class, "example.bxml");

        frame.open(display);
    }

    public static void main(String[] args) {
        DesktopApplicationContext.main(WithBxml.class, args);
    }
} 
```

这将创建以下 GUI，这是预期的：

![在此处输入图像描述](https://i.stack.imgur.com/MHeCE.png)

我正在尝试使用以下代码重新创建相同的 GUI。但是`TextArea`不可见，如以下屏幕截图所示。

*没有 Bxml.java*：

```
public final class WithoutBxml extends Application.Adapter {
    @Override
    public void startup(Display display, Map<String, String> properties) throws Exception {
        TextArea textArea = new TextArea();
        textArea.setText("Hello World");

        Frame frame = new Frame();
        frame.add(textArea);
        frame.open(display);
    }

    public static void main(String[] args) {
        DesktopApplicationContext.main(WithoutBxml.class, args);
    }
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/fT9Dd.png)

我需要在类中进行哪些更改`WithoutBxml`才能获得与 BXML 文件相同的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:06:17.393

而不是调用`frame.add(textArea);`，我不得不使用`frame.setContent(textArea);`添加`TextArea`到`Frame`. 加载 BXML 文件时会调用此方法，因为`Window`该类使用以下注释`@DefaultProperty("content")`：

```
@DefaultProperty("content")
public class Window extends Container {
    ...
} 
```

正因为如此，`BXMLSerializer`正在调用BXML 文件中`setContent()`元素的子元素。`<Window>`

# windows - 在 Windows 7 上独立运行 AntlrWorks2

> ID：16194456
> 
> 赞同：2
> 
> 时间：2013-04-24T14:19:25.320
> 
> 标签：windows, antlrworks

我肯定错过了什么。下载 AntlrWorks2 后，我找到了可执行文件 bin/antlrworks2.exe 和 bin/antlrworks264.exe。这些不应该是该工具的独立版本吗？都不适合我；在 NetBeans 启动屏幕之后，我第一次收到有关丢失包的错误消息；几次之后，我选择继续，但现在（仍然在初始启动屏幕之后）根本没有发生任何事情。

我找不到任何详细说明如何独立运行 AntlrWorks 的教程或手册，因此非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T14:48:23.397

这是由于 NetBeans 平台中的一个错误造成的。已报案但未收到回复：
[移动安装文件夹后无法启动平台应用程序](https://netbeans.org/bugzilla/show_bug.cgi?id=227219)

这是一个不会删除您自定义的任何首选项的解决方法：

> 我发现只删除`var`用户生成的 `.antlrworks2`设置文件夹下的文件夹可以解决问题......

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-09-28T16:10:25.770

截至本文发布之日，仍然是一个问题。从 \users\username\AppData\Roaming删除`.antlrworks2`文件夹确实有效 - 您可以通过放入`%APPDATA%`文件资源管理器地址栏（如图所示）找到此文件夹 - 这将转到您当前用户登录会话的应用程序数据文件夹。删除`.antlrworks2`文件夹，然后重新运行应用程序。

# css - 改变悬停不透明度不起作用

> ID：16194460
> 
> 赞同：0
> 
> 时间：2013-04-24T14:19:31.140
> 
> 标签：css

我想将鼠标悬停在十字形（.cross）上时将其不透明度更改为 0.9。将鼠标悬停在图像周围的 div 上时将不透明度更改为 0.3，但不会更改为 0.9

[https://dl.dropboxusercontent.com/u/12598822/midori.html](https://dl.dropboxusercontent.com/u/12598822/midori.html)

```
.cross {
    display: block;
    width: 12px;
    height: 12px;
    top: 10px;
    right: 10px;
    background: url(close.svg);
    position: absolute;
    opacity: 0;
    cursor: pointer;
}

div.shortcut .preview:hover > #crosshidden {
    -webkit-transition-property: opacity;
    -webkit-transition-duration: 150ms;
    opacity: 0.3;
    display: block;
}

.cross:hover > #crosshidden {
    opacity: 0.9;
    display: block;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:47:21.523

使用 Google Chrome 开发者工具，我注意到您的**"div.shortcut .preview:hover > #crosshidden" CSS 块比****".cross:hover > #crosshidden"**具有更高的优先级。

一个合适的解决方案是将后面的块替换为：

```
div.shortcut .preview:hover > #crosshidden:hover {
    opacity: 0.9;
} 
```

# sql - How can I create a table with five foreign keys and one of them as primary key (which is also a VARCHAR)

> ID：16194462
> 
> 赞同：0
> 
> 时间：2013-04-24T14:19:36.993
> 
> 标签：sql, sql-server-2005, foreign-keys, primary-key

I am trying to create a table like,

```
 USE [labblyDabbly3455]
    GO

    CREATE TABLE [dbo].[daTableBang]
    (
     TableAID varchar FOREIGN KEY REFERENCES TableA(ID)
     TableATitle VarChar FOREIGN KEY REFERENCES TableA(title)
     TableAName varchar FOREIGN KEY REFERENCES TableA(Name)
     TableASurName varchar FOREIGN KEY REFERENCES TableA(surname)
     TableBID int FOREIGN KEY REFERENCES TableB(ID)
    ) 
```

but getting error,

> Incorrect syntax

I need to declare TableAID as primary key too, **can someone help me with syntax plz**

After i try voo answer i get this error,

> There are no primary or candidate keys in the referenced table 'TableB' that match the referencing column list in the foreign key 'FK__0A537D18'.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:21:32.470

在每列之后的 CREATE 查询中添加逗号

```
CREATE TABLE [dbo].[daTableBang]
(
 TableAID int FOREIGN KEY REFERENCES TableA(ID),
 TableATitle VarChar FOREIGN KEY REFERENCES TableA(title),
 TableAName varchar FOREIGN KEY REFERENCES TableA(Name),
 TableASurName varchar FOREIGN KEY REFERENCES TableA(surname),
 TableBID int FOREIGN KEY REFERENCES TableB(ID)
) 
```

此外，我建议您通过将 TableAID 和 TableBID 作为主键，将 TableAID 作为表 A 的外键，将 TableBID 作为表 B 的外键来更改结构。并删除 TableATTitle、TableAName、TableASurName 的原因。结果查询：

```
CREATE TABLE [dbo].[daTableBang]
(
 TableAID int not null FOREIGN KEY REFERENCES TableA(ID),    
 TableBID int not null FOREIGN KEY REFERENCES TableB(ID),
 PRIMARY KEY (TableAID,TableBID)
) 
```

# c# - How can I dispose an object

> ID：16194463
> 
> 赞同：2
> 
> 时间：2013-04-24T14:19:36.843
> 
> 标签：c#, .net, data-structures, linked-list, idisposable

I am trying to delete a Node from a linked list. Below is the code I have tried.

```
public class Node : IDisposable
{
    public int Value { get; set; }
    public Node Next { get; set; }

    public Node(int value)
    {
        this.Value = value;
    }

    public void Dispose()
    {
        Dispose(true);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposing)
        {
            Next.Dispose();
        }
    }
}

public class LinkedList
{
    Node head;
    public void CreateList()
    {
        Node node1 = new Node(1);
        Node node2 = new Node(2);
        Node node3 = new Node(3);

        head = node1;
        node1.Next = node2;
        node2.Next = node3;
    }

    public void DeleteLastItem()
    {
            Node prevNode = head;
            Node nextNode = head;

            while (nextNode.Next != null)
            {
                prevNode = nextNode;
                nextNode = nextNode.Next;
            }
            prevNode.Next = null;
            nextNode.Dispose();
    }
} 
```

I wanted to dispose the `nextNode` (which is nothing but the last node. And it will not be part of the Linked List).

When I try above code, I am getting below exception:

> Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.

How can I proceed here ? How can I dispose a `Node` object?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:23:55.890

在您的`Dispose(bool)`方法中，您只能处置下一个节点（如果有的话）。在尝试之前检查空引用：

```
protected virtual void Dispose(bool disposing) {
  if (disposing) {
    if (Next != null) {
      Next.Dispose();
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T14:26:19.827

我想您应该在调用 Dispose 之前简单地检查 Next 是否不为空。

当在任何节点上调用 Dispose 方法时，您手动调用下一个，这样您将到达最后一个，Next 属性将为空，因此您会收到此异常。

考虑到您提供的代码，我不明白您为什么需要您的节点是一次性的。仅当您使用非托管资源时才需要，这在您提供的代码中不是这种情况（但也许您为问题简化了它）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T14:26:39.013

在您的 Dispose 逻辑中，检查 NULL：

```
public class Node : IDisposable
{
    public int Value { get; set; }
    public Node Next { get; set; }

    public Node(int value)
    {
        this.Value = value;
    }

    public void Dispose()
    {
        Dispose(true);
    }

    protected virtual void Dispose(bool disposing)
    {
        if (disposing)
        {
            if (Next != null) // <-- new code here
            {
                Next.Dispose();
            }                 
        }
    }
} 
```

# jquery - Making a Div Display When Clicked Wherever the Page is

> ID：16194464
> 
> 赞同：0
> 
> 时间：2013-04-24T14:19:38.313
> 
> 标签：jquery, css

I have one page site that scrolls. I have a navgation menu that remains at the top of the browser at all times. One of the list items is the contact page. I'd like to have a div fadeIn (which I have no trouble doing with jQuery), wherever you happen to be on the page. So I was wondering how do I define it's position? For instance, If I am scrolled half way down the page, and click the contact link, can it just appear right there vs say back up at the top of the page?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:27:34.267

您可以`position:fixed;`在您的联系人 div 上使用。通过一个简单的 JS 脚本，可以动态设置 top 和 left 属性，将 div 定位在屏幕中央。

`fixed`位置是相对于视口的。 `absolute`位置是相对于文档的。

[您可以在这个 w3school 示例](http://www.w3schools.com/cssref/playit.asp?filename=playcss_position&preval=fixed)中测试这些 CSS 属性。降低浏览器高度以添加滚动条并比较固定位置与绝对位置的结果。

**编辑：** [基本固定位置弹出](http://jsfiddle.net/zgQVF/2/)（小提琴）

`$(window).width()`您可以使用或获取视口大小`$(window).height()`。然后，您可以在 jQuery 对象上使用等效的 jQuery 方法获取弹出 div 大小。最后，您使用：(viewPortSize/2) - (divSize/2) 计算正确的位置。

请注意，如果 div 不可见（`display:none`例如），它的大小将为 0 ！这就是为什么我`.fadeIn()`在定位弹出窗口之前调用该函数以确保 div 可见。

# laravel - Laravel 4 cyrillic slug

> ID：16194469
> 
> 赞同：2
> 
> 时间：2013-04-24T14:19:57.560
> 
> 标签：laravel, laravel-4

Currently in L4 you can't get slug from cyrillic string. In L3 there was an ascii array for that. Where and how can I add this array/ability to create a slug from cyrillic string?

EDIT

The library [https://github.com/cocur/slugify](https://github.com/cocur/slugify) is a good option, but I decided to use in L4 a custom Slug library from L3 methods and ascii array. Now I have in L4 working Slug maker just like in L3\.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:33:25.307

您可以通过 composer安装这个库（[https://github.com/cocur/slugify ）并使用。](https://github.com/cocur/slugify)

它非常易于安装和使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-22T19:40:30.873

我在使用阿拉伯语时遇到了这个问题，所以我制作了以下功能，为我解决了这个问题。

```
function make_slug($string = null, $separator = "-") {
    if (is_null($string)) {
        return "";
    }

    // Remove spaces from the beginning and from the end of the string
    $string = trim($string);

    // Lower case everything 
    // using mb_strtolower() function is important for non-Latin UTF-8 string | more info: http://goo.gl/QL2tzK
    $string = mb_strtolower($string, "UTF-8");;

    // Make alphanumeric (removes all other characters)
    // this makes the string safe especially when used as a part of a URL
    // this keeps latin characters and arabic charactrs as well
    $string = preg_replace("/[^a-z0-9_\s-ءاأإآؤئبتثجحخدذرزسشصضطظعغفقكلمنهويةى]/u", "", $string);

    // Remove multiple dashes or whitespaces
    $string = preg_replace("/[\s-]+/", " ", $string);

    // Convert whitespaces and underscore to the given separator
    $string = preg_replace("/[\s_]/", $separator, $string);

    return $string;
} 
```

此功能仅解决阿拉伯语的问题，如果要解决西里尔文或任何其他语言的问题，您需要在这些现有的阿拉伯字符旁边或代替这些`ءاأإآؤئبتثجحخدذرزسشصضطظعغفقكلمنهويةى`现有的阿拉伯字符添加西里尔字符（或其他语言的字符）。

# macos - QFileDialog::getOpenFileName 没有在 Mac OS 10.8 Mountain Lion 上设置初始目录

> ID：16194475
> 
> 赞同：9
> 
> 时间：2013-04-24T14:20:08.287
> 
> 标签：macos, qt, qt4

我无法使用 Qt 4.8 的 QFileDialog 更改当前目录。相同的代码在 Windows 和 Mac OS 10.6 Snow Leopard 上运行良好。如果我不使用本机 Mac OS X 对话框，它也可以正常工作。

这有效：

```
fn=QFileDialog::getOpenFileName(this,"Select File","/Users/myuser/Desktop",QString(),0,QFileDialog::DontUseNativeDialog); 
```

这不起作用：

```
fn=QFileDialog::getOpenFileName(this,"Select File","/Users/myuser/Desktop"); 
```

看起来如果大多数时候它打开最后一次调用 getOpenFileName 的最后一个路径。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-01-13T13:16:16.050

在 Mavericks 上遇到了与 Qt5.2.0 相同的问题...我找到了解决方法：将一个虚拟文件名附加到您要选择的目录中。但是，请确保不要在 Windows 上执行此操作，因为用户会看到它。

```
QString dir = "/Users/myuser/Desktop";
#if defined(__APPLE__)
dir += "/MyFile.txt";
#endif
fn = QFileDialog::getOpenFileName(this, "Select File", dir); 
```

此外，对于像我这样实例化文件对话框的人，因为他们需要更多选项，您也可以这样做：

```
QFileDialog fileDialog(this, "Select File");
#if defined(__APPLE__)
fileDialog.selectFile(dir + "/MyFile.txt");
#else
fileDialog.setDirectory(dir);
#endif
... 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-24T16:32:50.370

这是 Qt 中的一个错误，据报道已在 Qt 5.0.1 和 Qt 4.8.4 中修复（尽管它似乎仍然可以在 4.8.4 中被人们（包括我自己）重现）。

此错误已在 JIRA 中报告为[QTBUG-20771](https://bugreports.qt.io/browse/QTBUG-20771)、[QTBUG-28161](https://bugreports.qt.io/browse/QTBUG-28161)和最后[的 QTBUG-35779](https://bugreports.qt.io/browse/QTBUG-35779)（这似乎最终完全解决了 Qt 5.2.1 中的问题）。这是[Gerrit](https://codereview.qt-project.org/#change,42156)中补丁的链接。

# javascript - IE 列表方法的替代方案？

> ID：16194483
> 
> 赞同：0
> 
> 时间：2013-04-24T14:20:20.450
> 
> 标签：javascript, list, internet-explorer, method-missing

我正在寻找一种`node.classList.contains("foo")`在 Internet Exploder 7-9 中无需重构代码的主要部分的方法。此方法存在于所有其他浏览器（甚至 IE10）中。

我发现[带有 classList 的代码在 IE 中不起作用？](https://stackoverflow.com/q/8098406/522479)但我不明白我将如何使用它来替换该`.contains()`方法。

我已经有代码让我只为某些浏览器运行独立的代码，所以给 IE 一些额外的或不同的代码不是问题。

有没有办法通过`classList`原型或其他一些方便的方式来添加所述方法`className`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:26:25.403

这是不可能的。

乍一看，你会认为如果你自己的`classList`实现`HTMLElement`还不存在的话，你已经能够修补它。

```
if (!("classList" in document.createElement("div"))) {
    HTMLElement.prototype.classList = {
        contains: function () {

        }
    };
} 
```

然而：

1.  您的`contains`实现无法访问 DOMElement (`this`是`classList`对象，而不是元素
2.  在旧版 IE 中扩展 DOM 对象是[*行不通的*](http://perfectionkills.com/whats-wrong-with-extending-the-dom/)。

* * *

您*唯一*的选择是`classList`用您自己的包装函数替换您的所有使用，`classList`如果可用，该函数使用该功能，如果没有，则回退到您自己的实现。

```
var classListWrapper = (function () {
    if ("classList" in document.createElement("div")) {
      return {
        add: function (el, class) {
          el.className.add(class);
        },
        remove: function (el, class) {
          el.className.remove(class);
        },
        // etc.
      }
    } else {
      return {
        add: function (el, class) {
          el.className += ' ' + class;
        },
        remove: function (el, class) {
          el.className = (' ' + el.className + ' ').replace(' ' + class + ' ', ' ');
        },
        // etc.
      };
    }
}()); 
```

...然后在您的代码中使用`classListWrapper.add(element, class)`。

# optimization - gcc transformation pass for ackermann

> ID：16194485
> 
> 赞同：6
> 
> 时间：2013-04-24T14:20:24.957
> 
> 标签：optimization, gcc

`gcc` (I tried `4.7.2` on Mac and Linux with `-O3` flag) optimizes ackermann function to a single call with a big local stack. An example Ackermann code below:

```
int ack(int m,int n){
  if(m == 0) return n+1;
  if(n == 0) return ack(m-1,1);
  return ack(m-1,ack(m,n-1));
} 
```

When disassembled, there is only one recursive call to `ack` function, instead of two calls (I couldn't parse what is going on -`ack` is now transformed by gcc into a function with 8 arguments, and local stack of 49 int and 9 char). I tried to look up what kind of transformation passes gcc did to optimize Ackermann function to a single call, but didn't find anything of interest. I will appreciate pointers on what major transformation passes gcc performed to convert the deeply recursive Ackermann to a single recursive call. LLVM gcc (I tried v4.2 on mac) doesn't reduce it to single recursive call yet, and is 4x slower with `-O3` flag. This optimization seems very interesting.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T21:01:36.040

第一遍是尾调用消除。GCC 在大多数优化级别都会这样做。本质上，尾部位置的所有函数调用都转换为 goto，如下所示：

```
int ack(int m, int n) {
begin:
  if (m == 0) return n + 1;
  if (n == 0) { m -= 1; n = 1; goto begin; }
  n = ack(m, n-1); m -= 1; goto begin;
} 
```

现在只剩下一个递归调用，而 GCC 仅在 -O3 级别将其内联了几次迭代。导致你看到的巨大怪物。

# powershell - Invoke-Command 调用服务器脚本错误

> ID：16194488
> 
> 赞同：0
> 
> 时间：2013-04-24T14:20:27.233
> 
> 标签：powershell, powershell-remoting

我在客户端计算机中有这个脚本，它尝试从服务器计算机运行脚本：

```
try {
      $s = New-PSSession -ComputerName "name" -Authentication CredSSP -Credential $credential
      Enter-PSSession -Id $s.Id
      Set-ExecutionPolicy ByPass -Scope CurrentUser
      Invoke-Command -Session $s -FilePath c:\release1.ps1
} catch {
      Write-Error "Error occurred: " $_.Exception.ToString()
} finally {
      Exit-PSSession
      Remove-PSSession $s } 
```

服务器中的脚本是这样的

`Set-Alias vmrun "C:\Program Files (x86)\VMware\VMware Workstation\vmrun.exe"` `Start-Process -NoNewWindow -FilePath vmrun -ArgumentList " -T ws revertToSnapshot M:\myvm.vmx Release1"`

但我得到了错误

> 写入错误：找不到接受参数“System.Management.Automation.ItemNotFoundException”的位置参数：找不到路径“C:\release1.ps1”，因为它不存在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:40:26.403

`-FilePath`必须指定*本地计算机上*文件的路径。该文件在本地读取，然后作为代码块传递到远程计算机。

请参阅[http://technet.microsoft.com/en-us/library/hh849719.aspx](http://technet.microsoft.com/en-us/library/hh849719.aspx)：

> 在一台或多台远程计算机上运行指定的本地脚本。输入脚本的路径和文件名，或通过管道将脚本路径传递给 Invoke-Command。**该脚本必须驻留在本地计算机上或本地计算机可以访问的目录中。**使用 ArgumentList 参数指定脚本中参数的值。

解决办法是放在`release1.ps1`本地电脑上。或者，如果它必须在远程计算机上，则将其放在本地计算机可访问的共享中，并使用 UNC 路径访问它。

```
Invoke-Command -Session $s -FilePath \\name\share\release1.ps1 
```

# java - Java method which uses a file system hierarchy to create a tree

> ID：16194493
> 
> 赞同：0
> 
> 时间：2013-04-24T14:20:42.337
> 
> 标签：java, arrays, string, tree, apache-zookeeper

I'm facing the following issue and I've been racking my brain looking for a solution, but nothing comes to my mind by now:

I have a file system hierarchy, something like:

```
/HANDLERS/HANDLER1
/HANDLERS/HANDLER2
/HANDLERS/HANDLER3 
```

and

```
/MODULES/PROGRAMMING/PROGRAMMER1
/MODULES/PROGRAMMING/PROGRAMMER2
/MODULES/PROGRAMMING/PROGRAMMER3

/MODULES/TESTING/TESTING1
/MODULES/TESTING/TESTING2 
```

and so on.

I want to create a "tree" assuming "/" which is the root is already created. And the structure shown in the image I attach is the goal.

![enter image description here](https://i.stack.imgur.com/XjgzL.jpg)

I need a method called

```
void createNode(String path){

} 
```

In my requirements, this method will always receive the full path and do something like the following:

```
void create(String fullPath){
 //Here I use a method which splits the fullPath into a String array to get every part that will represent a node, for example, if the fullPath is /MODULE/PROGRAMMING/PROHRAMMER1 I use:
String[] singleNodes = separateNodes(fullPath);//I get:MODULE,PROGRAMMING AND PROGRAMMER
//Then I use a loop to iterate the elements

for (String s : singleNodes) {
}
//WHAT CAN I DO HERE?
} 
```

But I don't have idea on how to work inside the loop, I need to check if the node exists, if it exists, I just have to add the missing part, for instance, if I send /MODULES/PROGRAMMING/PROGRAMMER1, if I send for the very first time, it will create the whole thing, but if then I send /MODULES/PROGRAMMING/PROGRAMMER2, it just have to add PROGRAMMER2.

If somebody could help me I will really appretiate it, thanks in advance.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:53:48.257

**免责声明：**未经测试，没有错误检查，没有 getter/setter。

```
package com.jorge.teste;

import java.util.ArrayList;
import java.util.List;

public class Main {

    public static class Tree<T> {
        Node<T> root;

        public static class Node<T> {
            T data;

            Node<T> parent;

            List<Node<T>> children = new ArrayList<Main.Tree.Node<T>>();

            public Node(final T data, final Node<T> parent) {
                this.data = data;
                this.parent = parent;
            }
        }
    }

    public static Tree<String> tree = new Tree<String>();

    public static void createNode(final String path) {
        String[] parts = path.split("/");
        Tree.Node<String> parent = null;
        for (String part : parts) {
            if (parent == null) {
                if (tree.root == null) {
                    tree.root = new Tree.Node<String>(part, null);
                }
                parent = tree.root;
            } else {
                Tree.Node<String> found = null;
                for (Tree.Node<String> child : parent.children) {
                    if (child.data.equals(part)) {
                        found = child;
                        break;
                    }
                }

                if (found == null) {
                    parent.children.add(found = new Tree.Node<String>(part, parent));
                }

                parent = found;
            }
        }
    }

    public static void main(final String[] args) {
        createNode("/a/b/c");
        createNode("/a/b/c/d");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:38:13.947

**如何在 Java 中将文件路径转换为层次结构**

```
Node createNode(String path) {
    File location = new File(path);
    File[] children = file.listFiles();
    Node node = new Node(location.getName());

    if(location.isDirectory()) {
        List<Node> children = new ArrayList();
        for(File child : children) {
            children.add(createNode(child.getPath()));
        }
        node.setChildren(children);
    }
    return node;
}

class Node {
    String name;
    List<Node> children;
} 
```

你可以这样称呼`createNode(myRoot)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-25T18:16:21.880

我终于设法做到了，它符合我的要求，这与我向 zookeeper 提出的问题有关。

此致。

```
public void createNode(NodePath nodePath, NodeData nodeData, NodeRights nodeRights, NodeCreationHandler nodeCreationHandler) throws KeeperException, InterruptedException, ZookeeperCreationException {

        if (zk == null) {
            throw new ZookeeperCreationException("The zookeeper client has not been instanced.");
        }       
        String targetPath = nodePath.getFullNodePath();
        logger.warn("full path: " + targetPath);
        targetPath = targetPath.substring(1, targetPath.length());
        logger.warn("full path mod: " + targetPath);
        byte[] serializedData = nodeData.serialize(new Object());
        String[] array = targetPath.split(ICoordinationConstants.BASE_ROOT_SPTR);
        String acum="";
        for (int i = 0; i < array.length-1; i++) {
            acum+=(ICoordinationConstants.BASE_ROOT_SPTR+array[i]);
            logger.warn("acum: " + acum);
            if (zk.exists(acum, null) == null) {
                logger.warn("It does not exists, proceed to create it...");
                zk.create(acum, serializedData, Ids.OPEN_ACL_UNSAFE, CreateMode.PERSISTENT);
            }
        }
        zk.create(acum+ICoordinationConstants.BASE_ROOT_SPTR+array[array.length-1], serializedData, Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);             
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:48:54.663

如果你想坚持你目前的循环，那么你应该尝试这样的事情（我假设你已经有了上面所说的根节点）

```
Node currentNode = rootNode; 
for (String s : singleNodes) {
     if( currentNode.hasChild(s) ) currentNode = currentNode.getChild(s);
     else currentNode = currentNode.createChild(s);
} 
```

在这里假设 createChild(s) 返回创建的节点，这可能不应该。但这不是真正的问题

但老实说，我认为这不应该使用循环来完成，通常使用递归更好地处理树。

# ios - 如何在不提示用户提供 Facebook 权限的情况下在 iOS 应用程序中获取公共 Facebook 页面的提要？

> ID：16194497
> 
> 赞同：3
> 
> 时间：2013-04-24T14:20:54.233
> 
> 标签：ios, facebook, access-token, facebook-access-token

我正在尝试使用 Graph API 获取公共 Facebook 页面的提要，如果不提示用户授予权限，我无法弄清楚如何做到这一点。

以下代码有效，但会提示用户提供权限：

```
- (void)doFacebookAuthCompletion:(void (^)(ACAccount* account))completion
{
    ACAccountStore* accountStore = [[ACAccountStore alloc] init];
    ACAccountType* accountType = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];
    NSDictionary* fbOptions = @{
                                ACFacebookAppIdKey: @"<app-id-key>",
                                ACFacebookPermissionsKey: @[ @"email" ]
                                };

    [accountStore requestAccessToAccountsWithType:accountType
                                          options:fbOptions
                                       completion:^(BOOL granted, NSError *error) {
                                           if (granted) {
                                               completion([[accountStore accountsWithAccountType:accountType] lastObject]);
                                           } else {
                                               NSLog(@"%@", [error localizedDescription]);
                                           }
                                       }];
}

- (void)updateFeed
{
    [self doFacebookAuthCompletion:^(ACAccount* account) {
        // What we want to get
        NSURL* url = [NSURL URLWithString:@"https://graph.facebook.com/microsoft/feed"];
        NSDictionary* parameters = @{ };

        // The request
        SLRequest* request = [SLRequest requestForServiceType:SLServiceTypeFacebook
                                               requestMethod:SLRequestMethodGET
                                                         URL:url
                                                  parameters:parameters];
        [request setAccount:account];

        // Send it
        [request performRequestWithHandler:^(NSData *responseData, NSHTTPURLResponse *urlResponse, NSError *error) {
            if (error) {
                NSLog(@"%@", [error localizedDescription]);
            } else {
                NSString *dataString = [[NSString alloc] initWithData:responseData encoding:NSStringEncodingConversionAllowLossy];
                NSLog(@"Response Data: %@", dataString);
            }
        }];
    }];
} 
```

我什至尝试使用[https://developers.facebook.com/docs/reference/api/page/](https://developers.facebook.com/docs/reference/api/page/)中引用的应用程序令牌，它只能在服务器端安全使用，但仍然没有得到任何结果。这段代码：

```
- (void)doFacebookAuthCompletion:(void (^)(ACAccount* account))completion
{
    ACAccountStore* accountStore = [[ACAccountStore alloc] init];
    ACAccountType* accountType = [accountStore accountTypeWithAccountTypeIdentifier:ACAccountTypeIdentifierFacebook];
    ACAccount* account = [[ACAccount alloc] initWithAccountType:accountType];
    account.credential = [[ACAccountCredential alloc] initWithOAuthToken:@"<app-token>" tokenSecret:@"<app-secret>"];
    completion(account);
} 
```

给出以下输出：

```
Response Data: {"error":{"message":"An access token is required to request this resource.","type":"OAuthException","code":104}} 
```

虽然[Graph API Explorer](https://developers.facebook.com/tools/explorer?method=GET&path=microsoft%2Ffeed)在相同的情况下工作得很好`<app-token>`（它不会像这样要求秘密`- initWithOAuthToken:tokenSecret:`）。

即使这种方法有效，发布也不安全。

我现在被困住了。请帮忙？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:37:47.657

我无法给出完整的答案，因为我从未使用过 iOS，但在 Facebook 方面，Graph API 不会让你在没有*某种*令牌的情况下获得任何东西。安全与否，唯一的方法是使用您的应用程序 ID 和密码来生成可以使用的令牌。你可以得到一个使用，例如：

```
https://graph.facebook.com/oauth/access_token?
client_id=YOUR_APP_ID&client_secret=YOUR_APP_SECRET&
grant_type=client_credentials 
```

# linux - 找出 JBoss 消耗了多少 CPU 时间、内存和 I/O 时间？

> ID：16194504
> 
> 赞同：-2
> 
> 时间：2013-04-24T14:21:11.353
> 
> 标签：linux

我正在使用 CentOs Linux。任何人请告诉我如何找到 JBoss 消耗的 CPU 时间、内存和 I/O 时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:44:45.687

正如 Jayaram Pai 所指出的，top 是一个很酷的 cpu 工具，实时内存使用。[您可以从http://manpages.ubuntu.com/manpages/lucid/man1/top.1.html](http://manpages.ubuntu.com/manpages/lucid/man1/top.1.html)找到手册页。除了top 命令，dstat 还实时报告cpu、内存、网络和磁盘的使用情况。相当棒的一个。[从http://manpages.ubuntu.com/manpages/karmic/man1/dstat.1.html](http://manpages.ubuntu.com/manpages/karmic/man1/dstat.1.html)查看手册页。

* * *

注意：dstat 实时报告整个系统资源使用情况。如果一个进程，top 和 iotop 将完成工作。您可能需要为您的 linux 发行版手动安装 iotop。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:15:25.603

使用 top 命令或更丰富多彩的版本 Htop。

# r - 对矩阵对象应用不同的滞后

> ID：16194507
> 
> 赞同：0
> 
> 时间：2013-04-24T14:21:27.707
> 
> 标签：r

我有一个包含 24 个时间序列的矩阵，如下所示：

```
 Ta.f Ta.f Ta.f Ta.f
1995-10-13 04:00:00 13.6 13.6 13.6 13.6
1995-10-13 05:00:00 13.6 13.6 13.6 13.6
1995-10-13 06:00:00 13.6 13.6 13.6 13.6
1995-10-13 07:00:00 13.5 13.5 13.5 13.5
1995-10-13 08:00:00 13.5 13.5 13.5 13.5 
```

我想对每一列使用 apply() 函数来根据列的索引进行区分。所以第 1 列需要 diff(x,)，第 2 列需要 diff(x,lag=2) 等等。我所做的是：

```
trans_temp <- apply(temp_mat,MARGIN=2,diff) 
```

它返回一个矩阵，其中所有时间序列都相差一次。有什么推荐吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:26:16.573

尝试这个：

```
trans_temp <- lapply(seq(ncol(temp_mat)), function(z) diff(temp_mat[,z], lag=z)) 
```

请注意，`diff`由于不同的滞后，s 的各个向量具有不同的长度。

# javascript - try catch error in javascript - get more error details

> ID：16194510
> 
> 赞同：14
> 
> 时间：2013-04-24T14:21:33.260
> 
> 标签：javascript

How can I get more error details from a javascript catch?

Are there more parameters to get more details from the caught error.

```
try { 
    var s = null;
    var t = s.toString();
  } catch(err) {
    alert(err);
  } 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-24T14:24:06.103

[错误对象](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Error)有几个可以使用的属性。可用于获取错误消息的一个属性是`.message`，如下所示：

```
catch(err) {
    alert(err.message);
  } 
```

该`.name`属性返回错误的类型，如下所示：

```
catch(err) {
    x = err.name;
    //  ... do something based on value of x
  } 
```

名称描述错误的类型，值`.name`可以是 :`EvalError, RangeError, ReferenceError, SyntaxError, TypeError`和 `URIError`. `.name`您可以根据属性返回的错误类型决定以不同方式处理错误。

可以在[JavaScriptKit](http://www.javascriptkit.com/javatutors/trycatch2.shtml)上找到一个很好的教程。这也是[Mozilla Developer Network](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Error)上关于错误对象的文章。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-24T14:34:12.880

查看此链接： [参考 Error.prototype](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Error/prototype)

基本上你有`err.name`和`err.message`。

您还有一些特定于供应商的扩展：

微软 =>`err.description`和`err.number`.

Mozilla = >`err.fileName`和.`err.lineNumber``err.stack`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:26:20.473

```
function message()
{
  try
  {
  }
  catch(err)
  {
   alert(err.message); 
 }
} 
```

[**看这里**](http://www.w3schools.com/js/js_errors.asp) 和[**这里**](http://rakeshdiscovery.blogspot.in/2008/12/exception-details-in-javascript.html)

# sockets - I don't understand the paragraph about multicast

> ID：16194512
> 
> 赞同：2
> 
> 时间：2013-04-24T14:21:51.620
> 
> 标签：sockets, unix, networking

This paragraph if from UNP, chapter 21.3 page 555

1.  A host running an application that has joined some multicast group whose corresponding Ethernet address just happens to be one that the interface receives when it is programmed to receive 01:00:5e:00:01:01 (e.e., the interface card performs imperfect filtering). This frame will be discarded either by datalink layer or by the IP layer.

I just don't know which special case is the author talking about. Could you help me explain it clearly?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:38:16.380

在 IPV4 中。多播地址（旧的 D 类）由 4 位固定组成，用于将其标识为多播（1110），其余 28 位用于标识组。

由于 MAC 地址中只有 23 位可用（高 25 位是固定的），当您将多播地址的低 23 位映射到 mac 的低 23 位时，您会丢失 5 位寻址信息。因此，多个组播地址都具有相同的 MAC 地址。

例如

```
237.138.0.1
238.138.0.1
239.138.0.1 
```

所有映射到 MAC 地址：01:00:5e:0a:00:01 （还有更多，这只是一个子集来说明）

因此，如果您加入组 237.138.0.1，您的以太网卡将开始向该 MAC 的堆栈发送帧。由于它是不完美的匹配（因为我们丢弃了这 5 位），以太网卡也会将 238.138.0.1 和 239.138.0.1 发送到堆栈中。但是由于您对这些帧不感兴趣，当它们可以完全匹配时，它们将在第 2 层（数据链路）或第 3 层（网络）被丢弃。

所以特殊情况是，如果您有多个多播流占用相同的低 23 位地址空间，则网段上的所有主机都必须处理堆栈中更高的数据包，因此需要做更多的工作来判断是否他们得到的数据包是他们感兴趣的数据包）。

通常，您只需要确保在规划多播部署时，尽量避免地址重叠。

# vim - How to use a copied text with the "I" and "A" command in a visual block?

> ID：16194514
> 
> 赞同：1
> 
> 时间：2013-04-24T14:21:54.397
> 
> 标签：vim, text, insert, selection

I often insert text before or after a visual block using the "`I`" (insert before visual block) or "`A`" command (insert after visual block).
After typing the text and pushing the `<ESC>` key the text is inserted before or after every line in the block.

But what if I want to insert a piece of **copied** text?
This doesn't work: After pasting the text, the ESC key doesn't work anymore and the copied text is only inserted in 1 line.

How can I insert a copied text on every line before or after a block?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:27:29.723

`I`使用/进行选择并像以前一样进入插入模式`A`。然后，不要键入，而是使用插入模式粘贴您的寄存器`<C-R>"`。(`"`表示默认寄存器；您也可以使用其他寄存器 (例如`a`)。) 与`<Esc>`之前一样结束。

有关`:help i_CTRL-R`更多信息，请参阅。

# c# - 如何让 ac# 进程像在命令行上运行一样创建文件？

> ID：16194518
> 
> 赞同：0
> 
> 时间：2013-04-24T14:22:02.160
> 
> 标签：c#, visual-studio-2012

我试图执行一个进程，就像它在窗口的命令行上执行一样，但是进程类不允许可执行文件创建一个类似于从命令行运行它会执行的文件。进程将在部署时以定时间隔在服务器上异步运行。命令行将调用如下所示：

curl.exe url -o 数据

wgrib2.exe 数据 -csv output.csv

在下面的代码中，我找到了 curl.exe 的解决方法，但是当它被读取为 StandardOutput 时，该文件会切断该文件类型的一些关键停止字符。

```
public static void httpQuery(string queryString)
{
    Process myProcess = new Process();
    try
    {
        string basepath = AppDomain.CurrentDomain.BaseDirectory;

        myProcess.StartInfo.UseShellExecute = false;            // allows us to redirect the output
        myProcess.StartInfo.CreateNoWindow = true;              // stop's command window from being made
        myProcess.StartInfo.Verb = "runas";
        myProcess.StartInfo.FileName = @"C:\Users\Ian's\Desktop\wgrib2\curl.exe";
        myProcess.StartInfo.Arguments = queryString;            // queryString is http://nomads.noaa.gov/....
        myProcess.StartInfo.RedirectStandardError = true;       // redirect error to stream reader
        myProcess.StartInfo.RedirectStandardOutput = true;      // redirect output to strem reader

        myProcess.Start();
        if (myProcess.WaitForExit(10000) == false)
        {
            myProcess.Kill();
        }
        using(StreamReader reader = myProcess.StandardError)    // capture error output if any
        {
            string result = reader.ReadToEnd();                 
            reader.Close();
            StreamReader message = myProcess.StandardOutput;
            string output = message.ReadToEnd();
            StreamWriter writer = new StreamWriter(basepath + "wgrib2\\data");
            writer.Write(output);
            writer.Close();
        }

    }
    catch (Exception e)
    {
        Console.WriteLine(e.Message);
    }
    myProcess.Close();
} 
```

此外，我似乎找不到允许第二个进程写入新文件的方法，或者如果它一直是我找不到它正在写入的目录。我在 IIS 开发服务器上使用 VS2012。这是第二个进程代码。

```
public static void callWgrib2()
    {
        Process wgrib2 = new Process();
        try
        {
            // call on command line: wgrib2.exe data -csv data.csv

            string basepath = AppDomain.CurrentDomain.BaseDirectory;            // path to project directory
            string arg1 = basepath + "wgrib2\\data";                            // filename of operate on
            string arg2 =" -csv " + basepath + "wgrib2\\data.csv";              // filename to write to

            wgrib2.StartInfo.UseShellExecute = false;                           // parameters
            wgrib2.StartInfo.CreateNoWindow = true;
            wgrib2.StartInfo.Verb = "runas";
            wgrib2.StartInfo.FileName = @"C:\Users\Ian's\Desktop\wgrib2\wgrib2.exe";
            wgrib2.StartInfo.Arguments = "\""+ arg1 + arg2 + "\"";
            wgrib2.StartInfo.RedirectStandardError = true;
            wgrib2.Start();

            if (wgrib2.WaitForExit(10000) == false)
            {
                wgrib2.Kill();
            }
            using (StreamReader reader = wgrib2.StandardOutput)
            {
                string result = reader.ReadToEnd();
                reader.Close();
                StreamReader err = wgrib2.StandardError;
                err.ReadToEnd();
                err.Close();
            }

        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
        }
        wgrib2.Close();
    } 
```

有人可以指出我的写作方向吗？我已经为这个问题付出了相当大的努力，但我确信有一个我不知道的简单解决方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:25:23.217

如果要使用实际的命令行过程，可以在争论中使用`cmd`并将`/c`标志传递给它

还有，线

```
wgrib2.StartInfo.Arguments = "\""+ arg1 + arg2 + "\""; 
```

看起来很奇怪

你真的需要你所有的论点，比如`-csv`在同一个引号块中吗？

这就像在命令行上调用

```
C:\Users\Ian's\Desktop\wgrib2\wgrib2.exe "c:\base\wgrib2\data -csv c:\base\wgrib2\data.csv" 
```

# c++builder - Math functions undefined although present in the Borland C++ Builder 6 help under Math unit

> ID：16194523
> 
> 赞同：0
> 
> 时间：2013-04-24T14:22:15.520
> 
> 标签：c++builder, sign, math.h, undefined-function

I want to use the function Sign() in a Borland C++ Builder 6 application. I cannot however find the correct header file.

When I use this function I get a compiler error saying undefined symbol, Sign.

You would think this function would be in math.h but I can't find it there. It shows up in the help list (Unit : Math).

I saw some threads for similar missing function definition (stddev for example). A solution was to add the option -lm or -lc to the compiler. But how to configure it in Borland C++ Builder graphical interface for compiling options ?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T20:25:31.297

您正在寻找 Math.hpp。当帮助显示“Unit: ...”时，它指的是 Delphi 单元。这些通过 Delphi 编译器生成的 Unit.hpp 头文件提供给 C++。math.h 是由 C 运行时提供的单独的头文件。

# asp.net - Is it possible to change a parameter name of an asmx web service without breaking clients

> ID：16194526
> 
> 赞同：1
> 
> 时间：2013-04-24T14:22:36.493
> 
> 标签：asp.net, web-services, wsdl, asmx

Is it possible to change a parameter name of an asmx web service without breaking clients? For example, consider a legacy service which has a web method like so:

```
 [WebMethod]
 public string HelloWorld(string NAME)
 {
      return "Hello World and " + NAME;
 } 
```

The legacy service web method has the parameter NAME, but I'd like to change this to 'Name' to follow coding guide-lines. Will this break existing clients?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:02:39.257

最简单的可能是添加一个新方法

```
 //New clients use this Maybe you put it in a new asmx file.
 [WebMethod]
 public string Hello_World(string FullName)
 {
      return HelloWorld(FullName);
 }

//Old clients use this.
[WebMethod]
 public string HelloWorld(string NAME)
 {
      return "Hello World and " + NAME;
 } 
```

WCF 有方法名称和参数是一回事，但使用注释的 xml 是另一回事。我认为有一种方法可以创建可以与旧版 ASMX 客户端对话的 WCF 服务，我还没有尝试过。在这种情况下，您可以重命名所有方法和参数，并通过属性注释，跨线路维护 xml 的旧名称。

# windows-phone-7 - twitter 的 Hammock api 支持 wp8 的 Twitter 1.1？

> ID：16194529
> 
> 赞同：0
> 
> 时间：2013-04-24T14:22:46.327
> 
> 标签：windows-phone-7, twitter, windows-phone-8, windows-phone, hammock

TweetSharp 支持 twitter v1.1，但我没有找到任何支持 twitter 1.1 的吊床参考资料：[对于 Hammock](https://dev.twitter.com/docs/twitter-libraries/v1) - 这表示“这些库是为现在已弃用的 API 版本制作的，并且在 2012 年 3 月之后可能无法运行。” 但我正在使用它的功能

[对于 tweetSharp](https://dev.twitter.com/docs/twitter-libraries) - 这显示了支持 twitter api 1.1的 api

我正在使用吊床，它工作正常。我应该切换吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:57:10.827

吊床很好。这就是问题所在。您真正需要做的就是更改 tweetsharp 中的端点以访问 v1.1 URL，并且一切都应该继续工作。

# ruby-on-rails - Adding rendered HTML to JSON

> ID：16194530
> 
> 赞同：3
> 
> 时间：2013-04-24T14:22:47.337
> 
> 标签：ruby-on-rails, json, partial-views

Given a controller `MapsController`:

```
class MapsController < ApplicationController
  def index
    @campings = Camping.finm(:all) #in reality a much more complex scope.
    respond_to do |format|
      format.html
      format.json { render :json => @campings }
    end
  end
end 
```

This renders the JSON just fine. But now, I'd like to pass along some HTML to inject into the DOM:

```
$.ajax({
  dataType: "json",
  url: "maps.json?bounding=45.446465,-4.935988,53.944621,17.036668",
}).done(function (data) {
  //...
  var gInfoWindow = new google.maps.InfoWindow({
    content:  camping.infowindow
  });
  //...
  $("#campings").append(camping.listing);
}); 
```

This JavaScript assumes a `.listing` and `.infowindow` attribute in each returned JSON-Object. They should contain HTML, rendered with the partials `campings/_infowindow.html.haml` and `campings/_listing.html.haml`.

Is this the correct angle to tackle this? Or should I rather build the HTML within the JavaScript and avoid sending HTML? If so, is there still a way to use partials to build the actual HTML?

How can I add `listing` and `infowindow` to the Objects`Camping` model does not have these fields?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:28:42.943

也许有点粗糙（而不是 100% 超级“Rails 方式”）但在类似情况下对我来说工作正常：

```
render :text => {:result => "success",
                 :document_row => render_to_string(
                                  :file => "admin/documents/_document_row",
                                  :formats => "html",
                                  :layout => false,
                                  :locals => {:documentable => documentable})}.to_json 
```

所以大致只是生成一个哈希并使用 render_to_string 从 _document_row 模板中获取 html。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:28:44.467

如果您使用类似 KnockoutJS 或其他 javascript 数据绑定或模板工具，您可以在页面中有一个骨架“模板”，当您发出 ajax 请求时，它会填充露营列表。

它的工作方式是您将您的表格或列表或任何露营列表绑定到您的 Knockout 模型中的露营对象数组。当您发出 ajax 请求时，您只需使用返回的 json 更新该数组。当该数组更新时，DOM 会自动更新以显示新列表。这使您的 ajax 请求仅获取数据而不是所有 HTML 标记，这意味着通过网络传输的字节数更少，并且您可以将获取新数据的行为与基于该​​数据更新 DOM 的行为分开。

# html - -webkit-overflow-scrolling:touch 的滚动问题

> ID：16194538
> 
> 赞同：2
> 
> 时间：2013-04-24T14:23:14.050
> 
> 标签：html, iphone, css, jquery-mobile, cordova

我在 iPhone 应用程序中使用 Phonegap 2.5。我也在使用查询手机。当我使用它时它会出现滚动问题`-webkit-overflow-scrolling: touch;`

以下是截图：

![在此处输入图像描述](https://i.stack.imgur.com/zklXv.png)

滚动内容消失后：

![在此处输入图像描述](https://i.stack.imgur.com/eFh51.png)

页眉和页脚是固定的。这是我用于滚动 div 的 div 的代码：

```
<div style="position: absolute; width: 100%; height: 75%; margin-top: 10%; overflow-y: auto; -webkit-overflow-scrolling: touch; -webkit-transform: translate3d(0,0,0);">
    <!--some content -->
</div> 
```

当我删除内容时`-webkit-overflow-scrolling: touch;`，内容不会消失，但不会像原生那样滚动。我无法弄清楚这是什么问题？

**更新：**它在 ios 6 模拟器上运行良好。屏幕截图是 iOS 5 设备。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-06T08:07:00.657

虽然看不到您的 html 标记，但请尝试调用此脚本...

为您的弹出 div 提供 id。

# HTML

```
<div id="yourBox" style="">    
    <!--some content -->    
</div> 
```

# 查询

```
$(document).ready(function(){
    $('#yourBox').trigger("create");
}); 
```

# javascript - Fuel UX - Hook onto change event of wizard

> ID：16194541
> 
> 赞同：6
> 
> 时间：2013-04-24T14:23:21.993
> 
> 标签：javascript, jquery, jquery-ui, jquery-plugins, fuelux

According to the [documentation](http://exacttarget.github.io/fuelux/#wizard), I should be able to hook onto the change event of the Fuel UX wizard component. But for the life of me I cant figure out how. I'm still new-ish to jquery and javascript.

**Javascript** I've tried the following

```
var wizard = $('#MyWizard');

wizard.on('change', '.wizard', function () {
    alert('OH SNAP!');
});

wizard.wizard().on('change', function () {
    alert('OH SNAP!');
}); 
```

... and a few other variations to no success.

I think I'm messing up the basics somewhere. How would i go about adding a custom event to the on change event. (as id like to only have one content area, but on the change event id like to have the server provide me with the required content to fill each wizard step)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T14:40:01.080

我痛苦地接近我需要做的事情。

```
 var wizard = $('#MyWizard');

 wizard.on('change', function (e, data) {
      console.log('change');      
 });

 wizard.on('changed', function (e, data) {
      console.log('changed');
 }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:47:47.340

首先没有 myWizard 只是一个 MyWizard 元素。第二个 DIV 元素没有更改事件。您只需将点击事件添加到您的按钮，例如：

```
<button class="btn btn-mini btn-prev" disabled="disabled" id="prev"><div class="icon-arrow-left"></div>Prev</button> 
```

接着：

```
$('#prev').click(function () { alert('OH SNAP!'); }); 
```

# ruby - fxri 控制台窗口一打开就关闭...无法在 Windows Ruby 2.0 环境中执行 fxri

> ID：16194548
> 
> 赞同：1
> 
> 时间：2013-04-24T14:23:36.747
> 
> 标签：ruby, rubygems, gem, installation, ruby-2.0

我已经安装了 Ruby 2.0

文件：rubyinstaller-2.0.0-p0.exe

网站： http: [//files.rubyforge.vm.bytemark.co.uk/rubyinstaller/rubyinstaller-2.0.0-p0.exe](http://files.rubyforge.vm.bytemark.co.uk/rubyinstaller/rubyinstaller-2.0.0-p0.exe)

我无法从 cmd 提示符、irb 中、ruby 窗口中或通过单击我的操作系统资源管理器窗口中的图标来执行**fxri 。**我尝试通过在整个 Ruby 文件夹中引用多个 fxri 文件来以这四种方式执行**fxri** 。主要的是 (C:\Ruby200\lib\ruby\gems\2.0.0\gems\fxri-0.3.7 \fxri.rb)

我执行了命令**load gem fxri**，然后弹出一个控制台说它正在加载 gem，然后它给了我一条消息说它已成功加载。

我尝试在 cmd 提示符、irb 窗口和 ruby​​ 窗口中输入完整路径名，

和

在进入我的操作系统（Vista 32 位）上的环境变量设置并将**fxri**设置为引用（C:\ **Ruby200** \lib\ruby\gems\2.0.0\gems\fxri- 0.3.7\fxri.rb)。

 **这些都没有奏效。

**我查看了fxri.rb**文件，找不到任何对 ruby​​w 的引用，我可以将其更改为**ruby**​​ 以使其有窗口而不是无窗口。

我已经搜索了几个小时来参考 2.0 环境中的 fxri 不兼容性，但没有找到。

任何见解和/或修复将不胜感激。

谢谢！**

# java - JasperReports - Handle big data from database to PDF

> ID：16194556
> 
> 赞同：1
> 
> 时间：2013-04-24T14:23:54.120
> 
> 标签：java, performance, io, jasper-reports

I have a report that takes a select that return me about 900k records (it´s about 100MB of data) and I need to create a *PDF* with it.

So, my implementation is simple: I get the data from my JDBC Query, put into a `ArrayList` and pass it to my report. I had some problems with memory but I fixed it, my problem now is with CPU processing (it is always at 100%) that makes my process crash.

My code is really simple:

```
 public OutputStream getOutputStream(OutputStream out) {
        try {
            JasperPrint print = JasperFillManager.fillReport(jasperName, params, fillList);
            JRExporter exporter = format.getExporter();
            exporter.setParameter(JRExporterParameter.JASPER_PRINT, print);
            exporter.setParameter(JRExporterParameter.OUTPUT_STREAM, out);
            exporter.exportReport();

        } catch (Exception e) {
            throw new RuntimeException("Error getting the stream", e);
        }
        return out;
    } 
```

I would like to know:

*   How in this case could I use my CPU´s multiple cores?
*   Is there another strategy to do that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-18T10:11:43.250

我建议的两件事。1\. 尝试**从 JasperReport**本身触发查询，而不是将其存储在 Arraylist 中，然后将其传递给报告。

2.使用**Report Virtualizer**。根据您的需要，您可以使用Swap Virtualizer或Gzip virtualizer。Jasper 声称 Gzip 虚拟器将 jasper 对象压缩到原始 jasper 对象的 1/10。

虚拟器将确保无论您的数据有多大，始终使用虚拟器生成报告。我个人使用 GZip 虚拟器打印了超过 25000 份超过 500MB 大小的报告，以确保它确实正常工作。

# c# - Getting data between values and greater than

> ID：16194560
> 
> 赞同：1
> 
> 时间：2013-04-24T14:24:00.143
> 
> 标签：c#, linq, dictionary

I have this dictionary:

```
 Dictionary<char, ValuePair> dictionary = new Dictionary<char, ValuePair>(); 
```

With the following struct:

```
struct ValuePair
{
    public double Value1;
    public double Value2;
} 
```

With the following values:

```
 dictionary.Add('A', new ValuePair { Value1 = 0.0, Value2 = 1.0 });
        dictionary.Add('B', new ValuePair { Value1 = 1.0, Value2 = 1.2 });
        dictionary.Add('C', new ValuePair { Value1 = 1.2, Value2 = 1.4 });
        dictionary.Add('D', new ValuePair { Value1 = 1.4, Value2 = 1.6 });

        dictionary.Add('E', new ValuePair { Value1 = 1.6, Value2 = 1.8 });
        dictionary.Add('F', new ValuePair { Value1 = 1.8, Value2 = 2.0 });
        dictionary.Add('G', new ValuePair { Value1 = 2.0, Value2 = double.MaxValue }); 
```

With query syntax I'm checking if a value is between one of the values, or if the case is G it justneed to be greater than 2.0\. I don't like the solution with double.MaxValue. Is there any other way?

```
 var getValue = (from d in dictionary
                       where 2.1 >= d.Value.Value1 && 2.1 < d.Value.Value2 
                       select d.Key).FirstOrDefault();

        Console.WriteLine(getValue); 
```

Thanks

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:29:36.600

您可以使用可为空的值，请记住，任何类型的 null 和非 null 之间的比较都将返回 false。

如果您使 Value2 可以为空，您的条件将转换为：

```
2.1 >= d.Value.Value1 && !(2.1 >= d.Value.Value2) 
```

# ruby-on-rails-3.2 - 使用“自定义”队列名称的 Sidekiq 工作人员被分配给“默认”队列

> ID：16194562
> 
> 赞同：3
> 
> 时间：2013-04-24T14:24:04.490
> 
> 标签：ruby-on-rails-3.2, queue, sidekiq

```
Rails 3.2.9
Ruby 1.9.3dev (2011-09-23 revision 33323) [i686-linux]
sidekiq  2.10.1 
```

如果我使用自定义队列名称定义如下所示的工作人员

```
 class BulkEmailWorker
    include Sidekiq::Worker
    # https://github.com/mperham/sidekiq/wiki/Advanced-Options
    sidekiq_options(queue: :bulk_mails, backtrace: true)

    # https://github.com/mperham/sidekiq/wiki/Best-Practices
    # Section: Make your jobs small and simple
    def perform
      # https://github.com/mperham/sidekiq/wiki/Delayed-Extensions
      scheduled_mails = MailTemplate.with_schedule
      scheduled_mails.each do |mail_template|
        BulkMailer.delay.general_mail(mail_template.id)
      end
    end
  end 
```

我像这样调用工人：

```
 BulkEmailWorker.perform_async 
```

它不起作用（换句话说，不发送电子邮件）。

检查redis中的数据我发现以下内容：

```
 redis 127.0.0.1:6379> keys *
  1) "myapp:stat:processed:2013-04-24"
  2) "myapp:queue:default"
  3) "myapp:stat:processed"
  4) "myapp:queues"

  redis 127.0.0.1:6379> lrange myapp:queue:default -100 100

   1) "{\"retry\":true,\"queue\":\"default\",\"timeout\":30,\"class\":\"Sidekiq::Extensions::DelayedMailer\",\"args\":[\"---\\n- !ruby/class 'BulkMailer'\\n- :general_mail\\n- - 1\\n\"],\"jid\":\"e46693944febf7ae26ec67a0\"}" 
```

雷迪斯 127.0.0.1:6379>

**从上面可以看出，工作人员被分配到“默认”队列，我猜因此工作人员无法处理。**

对于上述场景，我使用以下命令启动了 sidekiq：

```
 bundle exec sidekiq -e dev_mysql -C config/sidekiq.yml -q bulk_mails 
```

但是，当我从我的工人中删除时

```
 sidekiq_options(queue: :bulk_mails, backtrace: true) 
```

并使用以下命令启动 sidekiq：

```
 bundle exec sidekiq -e dev_mysql -C config/sidekiq.yml 
```

它有效（换句话说，它成功发送了电子邮件）。

*/config/sidekiq.yml*

```
# https://github.com/mperham/sidekiq/wiki/Logging
# http://stackoverflow.com/questions/15260634/sidekiq-configuration-for-multiple-environments
---
  :verbose: true
  :pidfile: ./tmp/pids/sidekiq.pid
  :logfile: ./log/sidekiq.log
  :concurrency:  25 
```

我刚开始使用 Sidekiq 并且是新手。所以如果我有一些我误解或不知道的概念，请多多包涵。

我需要摆脱上述问题，以便我的工作人员被分配到所需的队列并成功处理。

谢谢，吉涅什

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-11-03T09:56:53.623

此外，请注意，您可以通过使用`Sidekiq::Client.push`而不是将作业推送到所需的队列中`perform_async`：

```
Sidekiq::Client.push({
  'class' => BulkEmailWorker,
  'queue' => 'bulk_mails',
  'args'  => [ 1, 2 ]
}) 
```

请注意，键 ( `class`, `queue`, `args`)**必须**是字符串，而不是符号，否则您将得到`ArgumentError: Message must include a class and set of arguments`.

当您需要在具有变量名称（bulk_mails.1、bulk_mails.2 等）的队列上推送作业时，这特别有用，因此您可以通过在某些队列上一次只允许一个作业来轻松**控制并发**，谢谢到[sidekiq-limit_fetch](https://github.com/brainopia/sidekiq-limit_fetch)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-25T13:55:41.347

您可以在 sidekiq.yml 配置文件中添加队列名称和权重：

```
:queues:
- [bulk_mails, 7]
- [default, 5] 
```

`-C config/sidekiq.yml`使用该选项启动 sidekiq 。现在您可以在您的工作人员中引用队列名称：

```
sidekiq_options :queue => :bulk_mails 
```

# android - Android SharedPreferences，如何保存一个简单的 int 变量

> ID：16194567
> 
> 赞同：34
> 
> 时间：2013-04-24T14:24:16.170
> 
> 标签：android, sharedpreferences

我在最后一小时试图在我的 Android 应用程序中保存一个整数。我读到这可以使用 SharedPreferences 来完成。但是我不明白为什么这样做看起来如此混乱。

我怎样才能简单地保存一个 int 变量？然后当我再次运行应用程序时，如何再次与该变量交互？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-04-24T14:25:22.273

```
SharedPreferences sp = getSharedPreferences("your_prefs", Activity.MODE_PRIVATE);
SharedPreferences.Editor editor = sp.edit();
editor.putInt("your_int_key", yourIntValue);
editor.commit(); 
```

你可以得到它：

```
 SharedPreferences sp = getSharedPreferences("your_prefs", Activity.MODE_PRIVATE);
 int myIntValue = sp.getInt("your_int_key", -1); 
```

该`SharedPreference`界面使您可以访问 xml 文件，并且可以通过其编辑器轻松地对其进行修改。该文件存储在`/data/data/com.your.package/shared_prefs/`，您可以通过此`SharedPreference`API访问它

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-24T14:32:04.493

```
public void SaveInt(String key, int value){
       sharedPreferences = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
       SharedPreferences.Editor editor = sharedPreferences.edit();
       editor.putInt(key, value);
       editor.commit();
}
public void LoadInt(){
       sharedPreferences = PreferenceManager.getDefaultSharedPreferences(getApplicationContext());
       savedValue = sharedPreferences.getInt("key", 0);
} 
```

如果要将变量保存在某处，则必须编写 SaveInt("key", 5); 这样你将保存值 5，而第一个默认值是 0。如果你想加载它并在另一个活动中使用它，你必须在那里编写这两个方法，并调用 LoadInt(); 你需要变量的地方。savedValue 是一个预定义的整数（需要在任何你想使用保存变量的地方声明）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-04-24T14:30:24.963

这是设置布尔首选项的示例。您也可以使用整数。

```
SharedPreferences prefs = PreferenceManager
                    .getDefaultSharedPreferences(this);
            if (!prefs.getBoolean("firstTime", false)) {

                SharedPreferences.Editor editor = prefs.edit();
                editor.putBoolean("firstTime", true);
                editor.commit();
            } 
```

希望这可能会有所帮助。

# c# - 如何防止在 C# 代码中包装 WPF FlowDocument？

> ID：16194569
> 
> 赞同：5
> 
> 时间：2013-04-24T14:24:25.397
> 
> 标签：c#, wpf, word-wrap, flowdocument

[研究表明](http://social.msdn.microsoft.com/Forums/en-US/wpf/thread/05e02dc6-c8e5-42e8-b755-505e66155c3c/)，这是防止在段落中换行的方法：

```
<Paragraph>
    <TextBlock TextWrapping="NoWrap">unwrapping text</TextBlock>
</Paragraph> 
```

如何获得 C# 代码中的行为？

```
new Paragraph(new TextBlock()
{
    Text = "unwrapping text",
    TextWrapping = TextWrapping.NoWrap
}); 
```

产生`cannot convert from 'System.Windows.Controls.TextBlock' to 'System.Windows.Documents.Inline'`是因为 Paragraph 的构造函数需要一个内联。

我似乎找不到将 TextBlock 转换为 Inline 以使 Paragraph 满意的方法。如果它在 XAML 中工作，那么在某个地方应该有一个转换器，对吧？我如何找到它？

我意识到 FlowDocument 的重点是包装和流动以及重新调整大小等。我正在写一些简单的报告，只是一些`System.Windows.Documents.Table`数据，不幸的是，包装的第一列是包含日期的列，所以

```
2013-04-24 
```

变成

```
2013-04-
24 
```

`Run`到目前为止，我一直在使用s，虽然它们有一些`TextBlock`属性，但它们没有提供`TextWrapping`或提供任何`TextTrimming`功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:31:45.437

您想将其添加`TextBlock`到内联中，构造函数不会为您执行此操作。我认为最简单的写法是：

```
var p = new Paragraph();
p.Inlines.Add(new TextBlock()
{
    Text = "unwrapping text",
    TextWrapping = TextWrapping.NoWrap
}); 
```

# javascript - 哪一个是正确的？警报（（+“123”））警报（+“123”）警报（+（“123”））

> ID：16194570
> 
> 赞同：0
> 
> 时间：2013-04-24T14:24:27.187
> 
> 标签：javascript, nan

我正在尝试将字符串转换为浮点数。我知道 parseFloat() 可以做到这一点，但我也找到了下面的语法，但没有太多参考。

什么是正确的语法，因为它们似乎都有效。我在哪里可以了解更多信息？我不知道如何谷歌它，因为我不知道它的名字。

```
// syntax 1
alert((+"123"));    // 123
alert((+"x123"));   // NaN
alert((+"123x"));   // NaN
alert((+"123   ")); // 123
alert((+"   123")); // 123
alert((+"12 3"));   // NaN

// syntax 2
alert(+"123");      // 123
alert(+"x123");     // NaN
alert(+"123x");     // NaN
alert(+"123   ");   // 123
alert(+"   123");   // 123
alert(+"12 3");     // NaN

// syntax 3
alert(+("123"));    // 123
alert(+("x123"));   // NaN
alert(+("123x"));   // NaN
alert(+("123   ")); // 123
alert(+("   123")); // 123
alert(+("12 3"));   // NaN 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:26:50.477

它们在语法上都是正确的……但是示例 1 和示例 3 有多余的括号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:29:39.613

这称为隐式转换。由于您使用了数学运算符 (+)，它会尝试将字符串转换为数学运算所需的数值。你在这里问的是给我以下字符串的正值。

# javascript - 将 appcache 与 Chrome 框架一起使用（或检测到它不起作用）

> ID：16194572
> 
> 赞同：1
> 
> 时间：2013-04-24T14:24:30.750
> 
> 标签：javascript, offline, html5-appcache, google-chrome-frame

我们正在使用应用程序缓存（以及更多东西）构建一个离线使用的网络应用程序。

问题是，我们想请使用旧 IE 的用户使用 Google Chrome Frame，希望它能正常工作。但是 appcache 似乎不起作用：尽管该站点已正确缓存，但在没有 Internet 连接的情况下访问我们的站点会失败。我们得到标准的即无网络错误页面。

我发现[这个常见问题解答](http://www.chromium.org/developers/how-tos/chrome-frame-getting-started/differences-between-chrome-and-chrome-frame#TOC-AppCache)说由于 Chrome Frame 依赖于 IE 的网络堆栈，appcache 将无法“按预期”工作。

考虑到这一点，我几乎没有希望让它发挥作用（但是，如果你有解决方案，请随时分享），我更关心的是检测这个问题以相应地调整我的网站的行为。

`window.applicationCache`当 javascript 对象仍然存在时，如何检测 Chrome Frame 缺乏对 appcache 的支持？

# c# - 使用内置的 Exists 方法检查容器和 blob 是否存在于 Azure Blob 存储中

> ID：16194573
> 
> 赞同：2
> 
> 时间：2013-04-24T14:24:31.093
> 
> 标签：c#, asp.net, azure, azure-storage, azure-blob-storage

我发现这个扩展方法来检查 Blob 存储是否存在

[测试 Windows Azure Blob 的存在](http://blog.smarx.com/posts/testing-existence-of-a-windows-azure-blob)

[检查 Azure 存储中是否存在 blob](https://stackoverflow.com/q/2642919/296861)

但是，我在`Microsoft.WindowsAzure.Storage`.

*   `CloudBlobContainer.Exists`
*   `CloudBlockBlob.Exists`

据我测试，它们的功能类似于扩展方法。

## 问题：

它们是新的实用方法吗？我应该使用内置`Exists`方法还是使用自定义扩展方法。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T15:06:24.003

史蒂夫在他的博客文章中写的是真正的扩展方法，因此不是核心库的一部分，但是您提到的方法是核心存储客户端库的一部分。我的建议是使用作为核心库一部分的方法，因为如果库中有任何更改，它们将保持最新。

# iframe - pinterest如何将iframe插入跨域网站

> ID：16194575
> 
> 赞同：2
> 
> 时间：2013-04-24T14:24:38.707
> 
> 标签：iframe, cross-domain, bookmarklet

[我最近从http://about.pinterest.com/goodies](http://about.pinterest.com/goodies)安装了 Pinterest 的“pinit”书签，因为我很想知道它是如何工作的。

**我的问题是...**

我想创建类似的功能，以允许科学家拍摄他们添加到 Flickr、大学网站等内容的图像，并能够使用元数据对它们进行注释，并将它们全部显示在一个页面上。

我注意到（通过 Firebug）当点击 Pinterest pinit 小书签时，它会在正在查看的页面的 DOM 中插入一个 iframe。我的印象是，由于跨域问题，浏览器不应该允许这样做。既然是这样，有没有人有任何想法/代码片段：如何做。

# javascript - 在完整文档中查找最近的元素

> ID：16194578
> 
> 赞同：1
> 
> 时间：2013-04-24T14:24:44.727
> 
> 标签：javascript, jquery

我已经使用 Jquery 索引了我的文档`index`给定一个索引值，我想用一些 '定位' '最近的'元素`class`。这对我不起作用：

```
$(variableIndexNumber).closest('.class'); 
```

原因是有时会`.class`更改其位置，这意味着它可能位于文档中的任何位置。有时它是兄弟姐妹，有时是父母，有时在文档或底部。所以通常的选择器`next` `closest` `first` `nextAll`等对我不起作用（因为文档树）

我可以尝试获得与`.class`其他元素（由变量给出）最近的相对值吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:31:45.570

使用`.prevUntil('.class')`, `.nextUntil('.class')`, `.parentsUntil('.class')`，然后比较它们的大小。

就 DOM 结构而言，无论哪个尺寸最小，都最接近元素。

**更新**：在此过程中，您还需要`.andSelf()`,`.filter()`和典型的`.next()`并`.prev()`实际达到您想要的目标。演示已更新。您可以看到现在代码更加通用。

您可能还需要一个排序功能，就像我在下面的概念验证中所做的那样。

**演示**：http: [//jsfiddle.net/terryyounghk/FzA78/](http://jsfiddle.net/terryyounghk/FzA78/)

旁注：没有`.childrenUntil()`，因为这是向外分支的 DOM 树，而不是向内指向文档根目录，以防您想知道。但我的猜测是，你可以先做一个`$('.me').find('.class')`，然后为每个人做一个`.parentsUntil('.me')`，然后比较大小。我不确定这是否可行。

# php - Regular expression Getting HTML Doctype

> ID：16194587
> 
> 赞同：1
> 
> 时间：2013-04-24T14:25:02.603
> 
> 标签：php, regex

My Html code is like this

`<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">`

or this can be like this

`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">`

I want to get the `Doc Type` which will be like `"XHTML 1.0 Strict"` (for the first one), and `"HTML 4.0"` (for the second one) from it. What will be the regular expression code for this? I like to use it in `PHP preg_match()` function.

Please help me in this case.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:32:25.743

使用[`DOMDocument`](http://php.net/manual/en/class.domdocument.php)and怎么样[`DOMDocumentType`](http://www.php.net/manual/en/class.domdocumenttype.php)？

```
$xml = new DOMDocument(); 
$xml->loadHTMLFile($url);

$name = $xml->doctype->publicId; // -//W3C//DTD XHTML 1.0 Strict//EN 
```

`$doctype`现在包含以下值：

```
DOMDocumentType Object
(
    [name] => html
    [entities] => (object value omitted)
    [notations] => (object value omitted)
    [publicId] => -//W3C//DTD XHTML 1.0 Strict//EN
    [systemId] => http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd
    [internalSubset] => 
    [nodeName] => html
    [nodeValue] => 
    [nodeType] => 10
    [parentNode] => (object value omitted)
    [childNodes] => 
    [firstChild] => 
    [lastChild] => 
    [previousSibling] => 
    [nextSibling] => (object value omitted)
    [attributes] => 
    [ownerDocument] => (object value omitted)
    [namespaceURI] => 
    [prefix] => 
    [localName] => 
    [baseURI] => 
    [textContent] => 
) 
```

所以您现在可以轻松提取类型：

```
$name = $xml->doctype->publicId;
$name = preg_replace('~.*//DTD(.*?)//.*~', '$1', $name);
echo $name; 
```

这将导致`XHTML 1.0 Strict`. 工作 phpfiddle 示例[在这里](http://phpfiddle.org/main/code/1rs-eip)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-24T14:28:50.980

如果文档类型将采用显示的形式，您可以使用

```
'#(?<=<!DOCTYPE HTML PUBLIC "-//W3C//DTD )[^/]+#i' 
```

所以

```
preg_match('#(?<=<!DOCTYPE HTML PUBLIC "-//W3C//DTD )[^/]+#i', html, $match);  
echo $match[0]; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-16T11:47:21.140

```
function contains($haystack, $needle){
    if (strpos($haystack,$needle) !== false) {
        return true;
    }else{
        return false;
    }
}
                $theDocType = "";
                $stringWithHTML = ""; // load some HTML in here from somewhere

                // Create DOM from HTML 
                $doc = new DOMDocument();
                //@$doc->loadHTMLFile("just_a_file.html");
                @$doc->loadHTML($stringWithHTML);

                // Grab document type
                $dtName = $doc->doctype->name;
                $dtPublic = $doc->doctype->publicId;
                if( $dtName="html" && $dtPublic!=""){           
                    // HTML or XHTML?
                    if(contains($dtPublic,"xhtml")){
                        $theDocType = "XHTML 1.0";
                    }else{
                        $theDocType = "HTML 4.01";
                    }
                    // Which type?
                    if(contains($dtPublic,"strict")){
                        $theDocType .= " (Strict)";
                    }elseif(contains($dtPublic,"transitional")){
                        $theDocType .= " (Transitional)";
                    }elseif(contains($dtPublic,"frameset")){
                        $theDocType .= " (Frameset)";
                    }else{
                        $theDocType = "XHTML 1.1"; // XHTML 1.1
                    }
                }else{
                    $theDocType = "HTML 5";
                }

                // Result
                echo $theDocType; 
```

这将输出如下内容：
XHTML 1.1
HTML 5
HTML 4.01 (Strict)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-22T06:28:44.163

我过去使用过这个线程，但在测试过程中，我发现一些大型文档类型存在问题。有时，开发人员将 doctype 分成 2 或 3 行。在这种情况下，使用正则表达式并不是最好的方法。

我在一行或几行中粘贴了一种用于文档类型的方法：

```
<?
class Doctype {
    var $html;
    var $doctype;
    var $version;
    function Doctype($html){
       $this->html = $html;
       $this->extractDoctype();
       $this->processDoctype();
    }
    private function extractDoctype(){
        $preDoctype = "";
        $preDoctypeValid = false;
        $lines = explode(PHP_EOL, $this->html);
        foreach ($lines as &$line) {
            $preDoctype = $preDoctype . $line;
            if(
                (strpos(strtolower($preDoctype), "<!doctype") !== false) && 
                (strpos(strtolower($preDoctype), ">") !== false)){
                $preDoctypeValid = true;
                break;
            }
        }
        if($preDoctypeValid){
            //Store only the pattern: <! doctype >
            $pos1 = strpos(strtolower($preDoctype), "<!doctype");
            $pos2 = strpos($preDoctype, ">", $pos1) + 1;
            $preDoctype = substr($preDoctype, $pos1, $pos2);            
        }else{
            $preDoctype = "";
        }
        $this->doctype = $preDoctype;
    }
    private function processDoctype(){
        $version = "";

        $pattern_html5 = "/<!doctype\s+?html\s?>/i";
        if (preg_match($pattern_html5, strtolower($this->doctype))) {
            $version = "HTML5";
        }else if(strpos(strtolower($this->doctype), "xhtml") !== false){
            $version = "XHTML";     
        }else if(strpos(strtolower($this->doctype), "html") !== false){
            if(strpos(strtolower($this->doctype), "3.2") !== false){
                $version = "HTML 3.2";  
            }
            if(strpos(strtolower($this->doctype), "4.01") !== false){
                $version = "HTML 4.01"; 
            }
            if(strpos(strtolower($this->doctype), "2.0") !== false){
                $version = "HTML 2.0";  
            }
        }else{
            $version = "OTHER";
        }
        $this->version = $version;
    }
    public function getDoctype(){
        return $this->doctype;
    }
    public function getDoctypeVersion(){
        return $this->version;
    }
}
?> 
```

[https://github.com/jabrena/WTAnalyzer/blob/master/r_php/document/Doctype.class.php](https://github.com/jabrena/WTAnalyzer/blob/master/r_php/document/Doctype.class.php)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T14:27:20.217

尝试这个

```
<?php
   $html = file_get_contents("http://google.com");
   $html = str_replace("\n","",$html);
   $get_doctype = preg_match_all("/(<!DOCTYPE.+\">)<html/i",$html,$matches);
   $doctype = $matches[1][0];
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T14:28:28.327

```
'<!doctype.*?//dtd\s+([^/]*)//EN.*?dtd">' 
```

这应该作为您的示例的模式。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-24T15:59:17.897

这个正则表达式提取“DTD”和“/”之间的所有内容，而不进行任何语法检查：

```
.*DTD\s+([^/]+) 
```

这个正则表达式提取文档类型并检查字符串中的一些语法：

```
<!DOCTYPE\s+\w*\s*\w*\s*"[-//\w\d]*DTD\s+([\w\d\s.]*)[^"]*[^>]*> 
```

# c# - Web API route being ignored

> ID：16194588
> 
> 赞同：3
> 
> 时间：2013-04-24T14:25:05.693
> 
> 标签：c#, asp.net-mvc-4, asp.net-web-api

I have these two routes defined:

```
routes.MapRoute(
    name: "GetVoucherTypesForPartner",
    url: "api/Partner/{partnerId}/VoucherType",
    defaults: new { controller = "Partner", action = "GetVoucherTypesForPartner"}
);

routes.MapRoute(
    name: "Default",
    url: "api/{controller}/{action}/{id}",
    defaults: new { controller = "Home", action = "Index", id = UrlParameter.Optional}
); 
```

In my `PartnerProfile` controller, I have 2 methods:

```
public Partner Get(string id)
{ }

public IEnumerable<string> GetVoucherTypesForPartner(string id)
{ } 
```

If I hit the url `~/api/Partner/1234` then, as expected, the `Get` method is called.
However, if I hit the url `~/api/Partner/1234/VoucherType` then the same `Get` method is called. I am expecting my `GetVoucherTypesForPartner` to be called instead.

I'm pretty sure something in my route setup is wrong...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:30:19.977

您似乎映射了标准 MVC 路由，而不是 Web API 路由。有很大的不同。标准路由由派生自`Controller`该类的控制器使用，但如果您使用 ASP.NET Web API 并且您的控制器是从该`ApiController`类型派生的，那么您应该定义 HTTP 路由。

你应该在你的`~/App_Start/WebApiConfig.cs`而不是你的`~/App_Start/RouteConfig.cs`.

所以请继续：

```
public static class WebApiConfig
{
    public static void Register(HttpConfiguration config)
    {
        config.Routes.MapHttpRoute(
            name: "GetVoucherTypesForPartner",
            routeTemplate: "api/Partner/{partnerId}/VoucherType",
            defaults: new { controller = "Partner", action = "GetVoucherTypesForPartner" }
        );

        config.Routes.MapHttpRoute(
            name: "DefaultApi",
            routeTemplate: "api/{controller}/{id}",
            defaults: new { id = RouteParameter.Optional }
        );
    }
} 
```

接着：

```
public class PartnerController : ApiController
{
    public Partner Get(string id)
    {
        ...
    }

    public IEnumerable<string> GetVoucherTypesForPartner(string partnerId)
    {
        ...
    }
} 
```

注意事项：

*   我们定义了 HTTP 路由而不是标准的 MVC 路由
*   `GetVoucherTypesForPartner`必须调用操作所采用的参数，`partnerId`而不是`id`为了尊重您的路由定义并避免任何混淆

# c++-cli - 将 BoostTest 与 C++/CLI 一起使用：可能与否？

> ID：16194589
> 
> 赞同：3
> 
> 时间：2013-04-24T14:25:13.877
> 
> 标签：c++-cli, boost-test

我有一个包含程序代码（模型）的 Visual Studio 项目。我创建了另一个项目来将增强测试放入其中。

问题是我无法让它工作。

我可以在项目中单独使用 boost 测试，但是只要我想将（参考等）链接到第一个项目（我想要运行测试的那个），boost 测试项目就不会编译：

```
1>E:\boost_1_53_0\boost/detail/interlocked.hpp(99): warning C4164: '_InterlockedExchange' : fonction intrinsèque non déclarée
1>E:\boost_1_53_0\boost/detail/interlocked.hpp(100): warning C4164: '_InterlockedExchangeAdd' : fonction intrinsèque non déclarée
1>E:\boost_1_53_0\boost/smart_ptr/detail/spinlock_w32.hpp(62): error C3861: '_InterlockedExchange' : identificateur introuvable 
```

[我在那里](https://stackoverflow.com/questions/10632328/boost-in-vs2010-express-redefinition-and-invalid-calling-convention-errors)读到你不能

> 您的代码不是 C++ 而是“C++ CLI”，因此您不能使用 boost。C++ 没有系统命名空间。在每个 .cpp 文件中，您可以使用 C++/CLI（以及系统命名空间）或 boost。如果你想使用系统命名空间，你必须启用“通用语言运行时支持”，为了提升你必须禁用它

**>> 谁能确认不能将 Boost 与 C++/CLI 程序一起使用？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-29T07:45:20.887

是的，有可能。

首先，您必须将您的 C++/CLI 项目更改为 /clr（/clr:pure 或 /clr:safe 将不起作用）。这允许您的项目以混合模式运行，即同时运行本机 C++ 和托管代码。
[在 msdn.microsoft.com 上阅读更多信息](http://msdn.microsoft.com/en-us/library/x0w2664k.aspx)

为 Visual Studio 设置 Boost.Test（将路径添加到 Boost 的 .h，并在链接器中添加 .lib 路径；您可能必须编译 Boost，因为在某些情况下它不是“仅标题”）；这是一个很好的教程[itee.uq.edu.au](http://itee.uq.edu.au/~comp2304/tutorials/installing_boost_vs2010.html)

就是这样，您可以编写和编译您的测试。

但是，由于 C++/CLI 代码和 Boost 的编译（很可能是链接）过程中的错误，我无法将 Boost 测试放在不同的项目中；所以我不得不将单元测试放在程序本身的代码中（尽管在单独的 .cpp 文件中，这是一个可以接受的解决方案）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-29T08:21:19.093

基本问题是，在像 boost 这样的 C++（非 CLI）代码中，您不能保存任何托管引用或指针。

我发现对于 C++/CLI 代码，通常最好使用 C# 测试框架。C# 可以与 C++/CLI 部分对话，后者可以与纯 C++ 部分对话。此外，C++/CLI 的大多数用例都是为 .Net 包装 C++ 或 C 代码，因此测试 .Net 可以看到的接口是自然的选择。

例如，我有一个项目，其中所有接口都用 C# 指定。一些实现使用 C++/CLI 并调用 boost 库，其他实现是纯 C#。单元测试是通用的，通用参数是被测的实际实现。

MSTest/vstest 的示例：

```
public class MyTest< T > where T : IMyInterface
{
    [TestMethod]
    public void foo() {...}
}

[TestClass]
public class TestCppCli : MyTest< CppCliImpl > {}

[TestClass]
public class TestCSharp : MyTest< CSharpImpl> {} 
```

# java - Java Draw Image JPanel: Working but weird

> ID：16194590
> 
> 赞同：1
> 
> 时间：2013-04-24T14:25:20.337
> 
> 标签：java, swing, drawing, jframe, bufferedimage

I know that everywhere there is a tutoring in how to draw an image. Usually people suggest showing it adding an object that loads that image. But in my case, I don't wanna instantiate a new object every time that I change something in the image.

So, I'm using the Graphics class to do it. Also, I'm doing it using the MVC approach.

**Problem:** As we see, there is only a small region of the image that is drawn, if I load another image, this small regions changes according to the picture. Then, I presume that the Buffered image is been load correctly.

![](https://i.stack.imgur.com/qEy9r.jpg)

**So, I looking for where would be the problem: This is my code:**

```
import java.awt.FlowLayout;
import java.awt.Graphics;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.util.Observable;
import java.util.Observer;

import javax.swing.JFileChooser;
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JPanel;

public class DisplayView extends JFrame implements Observer {

    private static final long serialVersionUID = 1L;
    /**
     * @param args
     */
    private static DisplayView instance;
    private DisplayControl control;
    private JFileChooser fileChooser;

    Panel imageLeft, imageRight;

    private DisplayView() {

        JMenuItem exit = new JMenuItem("Exit");
        exit.setMnemonic('E');
        exit.setToolTipText("Exit Application");
        exit.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent event) {
                System.exit(0);
            }
        });

        fileChooser = new JFileChooser();
        fileChooser.setFileFilter(new ImageFileFilter());

        JMenuItem loadImage = new JMenuItem("Load Image");
        loadImage.setMnemonic('O');
        loadImage.setToolTipText("Loads an Image to Process");
        loadImage.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent event) {
                int ret = fileChooser.showDialog(DisplayView.getInstance(),
                        "Open file");

                if (ret == JFileChooser.APPROVE_OPTION) {
                    System.out.println(fileChooser.getSelectedFile());
                    control.onFileChoose(fileChooser.getSelectedFile()
                            .getAbsolutePath());
                }
            }
        });

        JMenu file = new JMenu("File");
        file.setMnemonic('F');
        file.add(loadImage);
        file.add(exit);

        JMenuBar menuBar = new JMenuBar();
        menuBar.add(file);

        imageLeft = new Panel();
        imageLeft.setSize(500, 500);
        imageLeft.setVisible(true);

        imageRight = new Panel();

        this.setLayout(new FlowLayout());
        this.add(imageLeft);
        // this.add(imageRight);

        this.setTitle("Test");
        this.setSize(300, 200);
        this.setDefaultCloseOperation(EXIT_ON_CLOSE);
        this.setJMenuBar(menuBar);
    }

    static public DisplayView getInstance() {
        if (instance == null)
            instance = new DisplayView();
        return DisplayView.instance;
    }

    public void setControl(DisplayControl control) {
        this.control = control;
    }

    @Override
    public void update(Observable o, Object arg) {
        // TODO Auto-generated method stub
        if (o instanceof DisplayModel) {
            this.imageLeft.setImage(((DisplayModel) o).getOriginalImage());
            // this.imageRight.setImage(((DisplayModel) o).getProcessedImage());

        }
    }

}

class Panel extends JPanel {

    BufferedImage image;

    public void setImage(BufferedImage image) {
        if (image != null)
            this.image = image;
        this.repaint();
    }

    @Override
    public void paint(Graphics g) {
        // TODO Auto-generated method stub
        super.paint(g);
        if (image != null)
            g.drawImage(image, 0, 0, this);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:02:14.083

问题是您的`Panel`类没有覆盖`getPreferredSize()`，因此它的首选大小实际上是 (0,0)，`FlowLayout`因此将分配 (0,0) 的大小给您的`Panel`.

无论如何，我会考虑用`Panel`simple `JLabel`'s 替换您的类，这将做完全相同的事情并为您处理首选尺寸。

*   `setSize()`当您还使用 LayoutManager（您应该这样做）时，调用是无用的。一般来说，只需忘记`setSize/setLocation/setBounds/setPreferredSize`. 答案总是一样的：“使用适当的`LayoutManager`”
*   对于自定义绘画，覆盖`paintComponent`而不是`paint`

# python - Python Regex use during specific string search in a text file

> ID：16194591
> 
> 赞同：0
> 
> 时间：2013-04-24T14:25:20.837
> 
> 标签：python, regex

I have to find an expression in a text file like : `StartTime="4/11/2013 8:11:20:965" and EndTime="4/11/2013 8:11:22:571"`

So I used the regex expression

```
r'(\w)="(\d{1,2}/\d{1,2}/\d{4} \d{1,2}:\d{1,2}:\d{1,2}:\d{2,3})"' 
```

Thanks again to eumiro for his help earlier ([Retrieve randomly preformatted text from Text File](https://stackoverflow.com/questions/16172247/retrieve-randomly-preformatted-text-from-text-file))

But I can't find anything in my file, and I checked it was there.

I can't go trhough 'GetDuration lvl 1' with it actually.

I tried to simplify my regex as `r'(\d)'`, and it worked to lvl 4, so I thought it could be and issue with eventually protected `"` but I didn't see anything about this in python doc.

What am I missing ?

```
Regular_Exp = r'(\w)="(\d{1,2}/\d{1,2}/\d{4} \d{1,2}:\d{1,2}:\d{1,2}:\d{2,3})"'

def getDuration(timeCode1, timeCode2)
    duration =0
    c = ''
    print 'GetDuration lvl 0'
    for c in str(timeCode1) :
        m = re.search(Regular_Exp, c)
        print 'GetDuration lvl 1'

        if m:
            print 'GetDuration lvl 2'
            for text in str(timeCode2) :
                print 'GetDuration lvl 3'
                n = re.search(Regular_Exp, c)
                if n:
                    print 'GetDuration lvl 4'
                    timeCode1Split = timeCode1.split(' ')
                    timeCode1Date = timeCode1Split[0].split('/')
                    timeCode1Heure = timeCode1Split[1].split(':')

                    timeCode2Split = timeCode2.split(' ')
                    timeCode2Date = timeCode2Split[0].split('/')
                    timeCode2Heure = timeCode2Split[1].split(':')

                    timeCode1Date = dt.datetime(timeCode1Date[0], timeCode1Date[1], timeCode1Date[2], timeCode1Heure[0], timeCode1Heure[0], timeCode1Heure[0], tzinfo=utc)
                    timeCode2Date = dt.datetime(timeCode2Date[0], timeCode2Date[1], timeCode2Date[2], timeCode2Heure[0], timeCode2Heure[0], timeCode2Heure[0], tzinfo=utc)

                    print 'TimeCode'
                    print timeCode1Date
                    print timeCode2Date

                duration += timeCode1Date - timeCode2Date

    return duration 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:31:43.650

```
for c in str(timeCode1) :
    m = re.search(Regular_Exp, c)

    ... 
```

`for x in str(something)`意味着您正在`something`逐个字符地迭代（一次一个字符= 1 个长度`str`），并且没有正则表达式可以与之匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:31:47.563

也许这个 exp 应该有帮助：

```
"(\w+?)=\"(.+?)\"" 
```

使用：

```
>>> string = u'StartTime="4/11/2013 8:11:20:965" and EndTime="4/11/2013 8:11:22:571"'
>>> regex = re.compile("(\w+?)=\"(.+?)\"")
# Run findall
>>> regex.findall(string)
[(u'StartTime', u'4/11/2013 8:11:20:965'), (u'EndTime', u'4/11/2013 8:11:22:571')] 
```

另外，`for c in str(timeCode1)`尝试打印`c`，您一次只输入一个字符，使用正则表达式不是一个好主意。

# javascript - 有没有办法在不点击的情况下运行 Chrome 扩展程序？

> ID：16194595
> 
> 赞同：0
> 
> 时间：2013-04-24T14:25:23.990
> 
> 标签：javascript, google-chrome, javascript-events, google-chrome-extension

我正在阅读有关创建 Chrome 扩展程序的文档。到目前为止，我了解到有两种方法可以运行扩展代码，使用 browserAction 或 pageAction。然而，在任何一种情况下，用户都必须手动单击图标。

我正在考虑制作一个可以帮助收集用户统计信息的扩展程序，并且我不希望用户每次都进行交互。

有没有办法做到这一点？哪些事件可以用来代替最适合这种情况的 onClicked？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T17:41:57.327

根据您尝试收集的用户统计信息类型，您的后台页面中可能会有一些事件侦听器。例如，如果您正在收集 url：

```
 chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab){
   doSomethingWithTheUrl(tab.url);
 }); 
```

如果您更具体地了解您想要收集什么样的统计数据，我可以提供一个更相关的示例。查看可用的[chrome API](http://developer.chrome.com/extensions/api_index.html)。

# java - Java - 设置 DPI 以打印图像

> ID：16194597
> 
> 赞同：3
> 
> 时间：2013-04-24T14:25:35.537
> 
> 标签：java, image, printing, dpi

我有一堆 .jpg 图像，我想以固定尺寸（以厘米为单位）打印它们（用墨水在纸上）。假设 image1.png 是 400x600 像素，我想以 300 dpi 打印它。我尝试过使用 PrinterJob 和 Printable 实现，但似乎我无法指定 DPI。这是代码片段：

```
PrinterJob job = PrinterJob.getPrinterJob();

job.setPrintable(new PrintableDeck(cardDB));

PrintRequestAttributeSet attr = new HashPrintRequestAttributeSet();
attr.add(new PrinterResolution(300, 300, PrinterResolution.DPI));
attr.add(new MediaPrintableArea(8,21,210-16,296-42,MediaPrintableArea.MM));
attr.add(MediaSizeName.ISO_A4);
attr.add(new Copies(1));
attr.add(OrientationRequested.PORTRAIT);
attr.add(PrintQuality.HIGH);
//attr.add(Fidelity.FIDELITY_TRUE);

job.print(attr); 
```

和

```
public class PrintableDeck implements Printable {

    BufferedImage image;

    public PrintableDeck(DB cardDB){
        // This load an image into 'image'            
        BufferedImage image = cardDB.getCard(5462).getBufferedImage();
    }

    public int print(Graphics graphics, PageFormat pf, int page)
    throws PrinterException{

        if(page>0){
            return NO_SUCH_PAGE;
        }

        Graphics2D g2 = (Graphics2D) graphics;
        g2.setRenderingHint(RenderingHints.KEY_INTERPOLATION,RenderingHints.VALUE_INTERPOLATION_BILINEAR);
        g2.setRenderingHint(RenderingHints.KEY_RENDERING,RenderingHints.VALUE_RENDER_QUALITY);
        g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING,RenderingHints.VALUE_ANTIALIAS_ON);

        double pageHeight = pf.getImageableHeight();
        double pageWidth = pf.getImageableWidth();

        // This print ONLY ~596x842, as if page is 72 DPI
        System.out.println("Imageable WH: "+pageWidth+" x "+pageHeight);

        // This print correctly 400x600
        System.out.println("Image: "+images.get(0).getWidth(null)+" x "+images.get(0).getHeight(null));

        g2.drawImage(image, 0, 0, null);
        g2.dispose();

        return PAGE_EXISTS;
    }
} 
```

正如您在上面看到的，我有 PageFormat.getImageableHeight() ~ 842 和 PageFormat.getImageableWidth() ~ 595。如果页面为 300 DPI，我预计这些值会更高，大约为 3000 x 2500。我错过了什么？

太感谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2018-04-25T06:27:38.760

如果图像的元数据中没有以前定义的 DPI，Java 会将图像的 DPI 设置为默认的 java 72dpi，因此它比在 java 72dpi 默认分辨率下将图像缩放到其尺寸更好，最好添加 300dpi 分辨率到您的图像元数据，因此，它将在正确的可打印区域尺寸中以更好的分辨率进行调整，除了设置打印机分辨率、介质尺寸和介质可打印区域属性之外，您可以将 dpi 设置为您保存的图像[http://www.javased.com/?post=321736](http://www.javased.com/?post=321736)中的这种方法：

```
private void saveGridImage(File output,BufferedImage gridImage) throws IOException {
    output.delete();

    final String formatName = "png";

    for (Iterator<ImageWriter> iw = ImageIO.getImageWritersByFormatName(formatName); iw.hasNext();) {
       ImageWriter writer = iw.next();
       ImageWriteParam writeParam = writer.getDefaultWriteParam();
       ImageTypeSpecifier typeSpecifier = ImageTypeSpecifier.createFromBufferedImageType(BufferedImage.TYPE_INT_RGB);
       IIOMetadata metadata = writer.getDefaultImageMetadata(typeSpecifier, writeParam);
       if (metadata.isReadOnly() || !metadata.isStandardMetadataFormatSupported()) {
          continue;
       }

       setDPI(metadata);

       final ImageOutputStream stream = ImageIO.createImageOutputStream(output);
       try {
            writer.setOutput(stream);
            writer.write(metadata, new IIOImage(gridImage, null, metadata), writeParam);
         } finally {
           stream.close();
         }
         break;
    }
}

private void setDPI(IIOMetadata metadata) throws IIOInvalidTreeException {

    double INCH_2_CM = 2.54;

       // for PMG, it's dots per millimeter
    double dotsPerMilli = 1.0 * DPI / 10 / INCH_2_CM;

    IIOMetadataNode horiz = new IIOMetadataNode("HorizontalPixelSize");
    horiz.setAttribute("value", Double.toString(dotsPerMilli));

    IIOMetadataNode vert = new IIOMetadataNode("VerticalPixelSize");
    vert.setAttribute("value", Double.toString(dotsPerMilli));

    IIOMetadataNode dim = new IIOMetadataNode("Dimension");
    dim.appendChild(horiz);
    dim.appendChild(vert);

    IIOMetadataNode root = new IIOMetadataNode("javax_imageio_1.0");
    root.appendChild(dim);

    metadata.mergeTree("javax_imageio_1.0", root);
} 
```

然后添加打印属性，例如：

```
 attr.add(new PrinterResolution(300, 300, PrinterResolution.DPI));
   attr.add(new MediaPrintableArea(8,21,210-16,296-42,MediaPrintableArea.MM));
   attr.add(MediaSizeName.ISO_A4); 
```

以获得更好的图像视图质量和分辨率。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-09T14:29:59.470

这是我的代码，请注意我使用的是 Scalr。

```
 private String autoResizeImage(String image, int width, int dpi, String prefix) throws IllegalArgumentException, ImagingOpException, IOException {

    File file = new File(image);

    BufferedImage img = ImageIO.read(file);

    BufferedImage result = Scalr.resize(img, Scalr.Method.SPEED, Scalr.Mode.FIT_TO_WIDTH, width, Scalr.OP_ANTIALIAS);

    File outputfile = new File(prefix);
    PNGEncodeParam penc = PNGEncodeParam.getDefaultEncodeParam(result);

    double meter2inchRatio = 1d / 0.0254d;
    int dim = (int) (dpi * meter2inchRatio) + 1;
    penc.setPhysicalDimension(dim, dim, 1);

    // resize orginal image
    JAI.create("filestore", result, outputfile.getAbsolutePath(), "PNG", penc);

    return outputfile.getAbsolutePath();

} 
```

# javascript - 获取 element 的所有 jQuery/JavaScript 事件订阅

> ID：16194600
> 
> 赞同：2
> 
> 时间：2013-04-24T14:25:51.863
> 
> 标签：javascript, html, jquery

我网站上的所有表单都由 AJAX 提交。而且我找不到它在哪里实施。

当我查看 HTML 时，我看到了`<form>`带有提交按钮的纯文本，但表单始终是异步发送的。

我知道某些`.js`文件包含以下内容：

```
$("form").onsubmit(function(e) {
   var form = $(this).serialize();
   $.post(......
   e.preventDefault();
   .....
}); 
```

但我找不到这个代码。我的 JavaScript 不做这样的事情。

我在哪里可以获得特定元素（或所有表单元素）的事件订阅？

谢谢

升级版：

行。看来我找到了嫌疑人。当我删除对 j​​query.mobile 的脚本引用时，我的表单正在正常发送。如何禁用 AJAX 为一种特定形式发送？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:33:33.280

您可以下载 chrome，选择一个元素。然后在您的开发人员工具的右侧（您也有 css）。有一个名为“事件侦听器”的选项卡。您可以在此处查看绑定到该元素的所有事件 - 及其位置（文件 + 行号）。请注意，您还需要检查父母，因为事件会在 dom 树中冒泡。

如果您是 firefox 用户，您可以使用 firebug 查看事件。

您还可以使用以下代码查看事件。但这不会告诉您哪个脚本和行。

```
$('selector').data('events'); 
```

在这个页面上像这样：

```
$('#show-editor-button input').data('events') 
```

# image - Flex - 在图像上设置边框的简单方法

> ID：16194601
> 
> 赞同：1
> 
> 时间：2013-04-24T14:25:52.473
> 
> 标签：image, apache-flex, border, flex-spark

有没有一种简单的方法可以为图像添加简单的边框？

我正在加载图像缩略图，并希望在运行时添加边框，而不必编辑所有缩略图。

我正在使用 Spark Image。

谢谢！

编辑：我需要在这些拇指周围添加一个 1 像素的白色边框。我将 tumbs 的大小设置为 90x90，以使其适合水平或垂直，但我示例中的实际图像缩小到 90x51（这不是固定的，最大只有 90x90 是固定的）

这是我将 thumbNails 添加到 TileGroup 的代码（从 xml 文件加载图库）：

```
private function loadPopUpThumbs():void{
            if(curThumbImg <= totThumbImg){
                var thumbImg:Image = new Image();
                var _loader:Loader = new Loader();
                var imageNr:int = curThumbImg;
                var thumbContainer:BorderContainer = new BorderContainer();

                _loader.contentLoaderInfo.addEventListener(Event.COMPLETE,function(e:Event):void{ 
                    thumbImg.source = e.currentTarget.content;
                    popUpImgGroup.addElement(thumbImg);

                    thumbImg.width = 90;
                    thumbImg.height = 90;
                    thumbImg.scaleMode = "letterbox";
                    thumbImg.verticalAlign = "bottom";
                    thumbImg.smooth = true;
                    thumbImg.id = "thumbImg" + imageNr;

                    //thumbImg.drawRoundRect(0,0,thumbImg.width,thumbImg.height, null, 0xffffff);

                    thumbImg.addEventListener(MouseEvent.CLICK, function(evt:MouseEvent):void{
                        popUpThumbClicked(imageNr.toString());
                    });

                    trace("Thumb added: " + popUpXMLList.(attribute('nr')==imageNr.toString()).@thumbURL);
                    curThumbImg++;
                    loadPopUpThumbs();
                });

                _loader.load(new URLRequest(encodeURI(popUpXMLList.(attribute('nr')==imageNr.toString()).@thumbURL)));

            }else{
                trace("DONE Adding thubs!!!");
            }
        } 
```

另外：是否可以在添加到 TileGroup 的项目中添加换行符？在我的 XML 文件中，我定义了一个组属性，以便能够将图像分成组。如果我单击一个组中的图像，我可以跳过该组中的下一个/上一个，但不能跳到下一个组。有什么方法可以在我的 TileGroup 中插入换行符，以便我可以在 prevGroup != curGroup 时进行监听，然后在继续添加下一个拇指之前添加某种间距？我所需要的只是一种在 tileGroup 中跳过一行的方法 :)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T08:43:52.220

您可以创建新的自定义图像类，扩展火花图像。非常简单干净。并使用 css 设置边框大小和颜色。参见示例：

```
package classes
{
    import flash.display.CapsStyle;
    import flash.display.JointStyle;
    import flash.display.LineScaleMode;

    import spark.components.Image;

    public class ImageBorder extends Image
    {

        public function ImageBorder()
        {
            super();
        }

        override protected function updateDisplayList(unscaledWidth:Number, unscaledHeight:Number):void
        {
            super.updateDisplayList(unscaledWidth, unscaledHeight); 

            if (imageDisplay && imageDisplay.bitmapData)
            {
                var borderSize:Number   = getStyle("borderSize") || 0;
                var borderColor:Number  = getStyle("borderColor") || 0xffffff;

                var half:Number = borderSize/2;
                imageDisplay.left = imageDisplay.top = imageDisplay.right =  imageDisplay.bottom = borderSize;

                graphics.clear();
                graphics.lineStyle(borderSize, borderColor, 1, false, LineScaleMode.NONE, CapsStyle.NONE, JointStyle.MITER);

                graphics.moveTo(0, half);
                graphics.lineTo(unscaledWidth -half, half);
                graphics.lineTo(unscaledWidth - half, unscaledHeight-half);
                graphics.lineTo(half, unscaledHeight-half);
                graphics.lineTo(half, half);

            }
        }
    }
} 
```

在与 css 一起使用的应用程序中：

```
<fx:Style>
    @namespace s "library://ns.adobe.com/flex/spark";
    @namespace mx "library://ns.adobe.com/flex/mx";
    @namespace classes "classes.*";

    classes|ImageBorder 
    {
        borderSize : 10;
        borderColor : "0xff00ff";
    }

</fx:Style>

<classes:ImageBorder source=" your source url " /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:34:11.983

Spark 图像是一个`SkinnableComponent`.

1.  您可以以任何方便的方式创建支持边框的自定义皮肤，例如样式或属性。
2.  或者，如果你想看到边框，你可以设置该皮肤，如果你不想要，可以删除它
3.  或者你可以把它放在里面`BorderContainer`，`borderVisible`当你想看边框的时候设置为true。

# c# - RichTextBox - InvalidOperationException：调用线程必须是 STA

> ID：16194605
> 
> 赞同：1
> 
> 时间：2013-04-24T14:26:00.247
> 
> 标签：c#, wpf, ajax, multithreading, richtextbox

我正在尝试使用 MSDN 中的这个[**在 RTF 和 HTML**](http://code.msdn.microsoft.com/Converting-between-RTF-and-aaa02a6e)库之间转换来将一些 RTF 文本转换为 HTML。我的设置的要点是从 JavaScript 到 C# 处理程序的 AJAX 调用，该处理程序调用此`MarkupConverter`库进行转换，然后写回 HTML。

这是我的 JavaScript：

```
$.ajax({
   type: "POST",
   url: "MyHandler.ashx",
   data: richTextData,
   success: function (html) {
            alert('success, html: ' + html);
   },
   error: function (msg) {
            alert("error: " + msg);
   }
}); 
```

还有我的处理程序的代码，也很简单：

```
public void ProcessRequest(HttpContext context)
{
   if (context.Request.Form.Count > 0)
   {
      string rtf = context.Request.Form[0];
      string html = "";
      if (rtf != "")
      {
         markupConverter = new MarkupConverter.MarkupConverter();
         html = markupConverter.ConvertRtfToHtml(rtf);
      }
      if (html != "")
      {
         context.Response.ContentType = "text/html";
         context.Response.Write(html);
      }
      else
      {
         context.Response.ContentType = "text/plain";
         context.Response.Write("Error from RTF2HTML");
      }
   }
} 
```

问题是，每次运行时，都会抛出异常，因为`RichTextBox`控件是在后台线程上创建的：

> [InvalidOperationException: 调用线程必须是 STA，因为很多 UI 组件都需要这个。]
> System.Windows.Input.InputManager..ctor() +11032206
> System.Windows.Input.InputManager.GetCurrentInputManagerImpl() +125
> System.Windows.Input .KeyboardNavigation..ctor() +185
> System.Windows.FrameworkElement.EnsureFrameworkServices() +109
> System.Windows.FrameworkElement..ctor() +504
> System.Windows.Controls.Control..ctor() +87
> System.Windows。 Controls.RichTextBox..ctor(FlowDocument 文档) +56
> MarkupConverter.RtfToHtmlConverter.ConvertRtfToXaml(String rtfText) +67 MarkupConverter.RtfToHtmlConverter.ConvertRtfToHtml(String rtfText) +23 MyHandler.ProcessRequest(HttpContext context) +416

我想可能是因为 AJAX 调用是异步的，所以调用被放置在后台线程上。所以我把它改成这样：

```
var postText = $.ajax({
   type: "POST",
   url: "RTF2HTML.ashx",
   data: textData,
   async: false
}).responseText;
alert(postText); 
```

但即使当我检查处理程序中的当前线程时：

```
context.Response.Write("thread: " + System.Threading.Thread.CurrentThread.GetApartmentState().ToString()); 
```

它仍然返回 MTA。

有没有办法连接到主 STA 线程，或者我必须创建一个新线程并指定 STA？如果是这种情况，我该如何设置回调函数以按照`Response.Write`当前的方式返回我的 HTML？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:05:13.730

这可能有用：

[如何在 STA 线程中运行某些东西？](https://stackoverflow.com/questions/2378016/how-to-run-something-in-the-sta-thread)

也许你可以打电话给...

```
html = markupConverter.ConvertRtfToHtml(rtf); 
```

...以相同的方式在不同的线程上？

```
string rtf;

public void ProcessRequest(HttpContext context)
{
   if (context.Request.Form.Count > 0)
   {
      rtf = context.Request.Form[0];
      string html = "";
      if (rtf != "")
      {
         Thread thread = new Thread(ConvertMarkup);
            thread.SetApartmentState(ApartmentState.STA);
            thread.Start();
            thread.Join();
      }
      if (html != "")
      {
         context.Response.ContentType = "text/html";
         context.Response.Write(html);
      }
      else
      {
         context.Response.ContentType = "text/plain";
         context.Response.Write("Error from RTF2HTML");
      }
   }
}

void ConvertMarkup()
{
    markupConverter = new MarkupConverter.MarkupConverter();
     html = markupConverter.ConvertRtfToHtml(rtf);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:03:26.230

```
 using System.Threading; 

    Thread t = new Thread(new ThreadStart(ProcessRequest)); 

    // Make sure to set the apartment state BEFORE starting the thread. 
    t.ApartmentState = ApartmentState.STA; 
    t.Start(); 

    public void ProcessRequest(HttpContext context)
    {
       if (context.Request.Form.Count > 0)
       {
        string rtf = context.Request.Form[0];
        string html = "";
        if (rtf != "")
        {
           markupConverter = new MarkupConverter.MarkupConverter();
           html = markupConverter.ConvertRtfToHtml(rtf);
        }
        if (html != "")
        {
           context.Response.ContentType = "text/html";
           context.Response.Write(html);
        }
        else
        {
           context.Response.ContentType = "text/plain";
           context.Response.Write("Error from RTF2HTML");
        }
     }
  } 
```

# php - 在一个 foreach 循环中显示两个数组

> ID：16194619
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:26:47.383
> 
> 标签：php, file, foreach

我在一个 foreach 循环中使用了两个数组。这是我为两个输入文件类型数组编写的代码片段。

```
$file[]= $_FILES['f_name']['name'];

$tmp_name[]=$_FILES['f_name']['tmp_name'];

    foreach (array_combine($file, $tmp_name) as $code => $name) {
           print_r($code);
       print_r($name);
} 
```

我在打印数组时得到的结果值是：

```
ArrayArray ( [0] => C:\xampp\tmp\phpC24D.tmp [1] => C:\xampp\tmp\phpC24E.tmp [2] => C:\xampp\tmp\phpC25F.tmp [3] => C:\xampp\tmp\phpC260.tmp [4] => [5] => [6] => [7] => [8] => [9] => [10] => ) 
```

它只打印一个数组，不打印另一个数组。我怎样才能把它打印出来？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:27:43.927

实际上它正在打印 2 个数组，只有第一个不包含任何内容。

`ArrayArray (`

`var_dump`相比，我更喜欢使用它，`print_r`因为它为您提供了更多的调试细节。

当您将 2 个数组合并为一个并且它们只有 1 个索引时，`$code`变量中没有任何内容，只是`$name`- 除非您添加数组索引。

# grails - 从组合框 onChange 事件传递两个参数

> ID：16194621
> 
> 赞同：1
> 
> 时间：2013-04-24T14:26:49.713
> 
> 标签：grails, combobox, onchange

我有以下代码：

```
<g:select name="availableUser.id" from="${availableUsers}"
                  noSelection="['': message(code: 'global.noSelection')]"
                  optionKey="id" value="${name}"
                  onchange="${remoteFunction(
                          controller: 'report',
                          action: 'getAvailableUsers',
                          params: [report: reportInstance.id, user: this.value],
                          update: 'userSelection'
                  )}"> 
```

在远程函数 getAvailableUser 中，我可以访问名为 report 的传递参数，但另一个（用户）不断返回 null，即使组合框已正确呈现。像这样：

```
...

<option value="21">John Smith</option> 

... 
```

我正在尝试获取所选项目的价值。在这种情况下，21。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:19:48.830

这是因为`remoteFunction`依次编写了一个 JS 函数，该函数根据使用的相应库（等）触发 AJAX`JQuery`请求`DOJO`。`params`根据您用于项目的 AJAX 库，我需要在本机格式中提到属性。

标记使用不同库时的差异

查询： `'\'user.id=\' + this.value + \'&report=\' + ${reportInstance.id}'`

DOJO：[对键值对使用分号]

`'\'user.id:\' + this.value + \', report:\' + ${reportInstance.id}'`

# emacs - 如何以交互方式运行 setq

> ID：16194623
> 
> 赞同：33
> 
> 时间：2013-04-24T14:26:54.547
> 
> 标签：emacs, elisp, config

`(setq frame-title-format ...)`具体来说，我想做与在我的配置文件中做的事情相同的事情，但来自`M-x`交互式命令。`M-x setq`似乎不起作用。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-24T14:41:58.693

不要使用`M-x`，使用`M-:`，它运行命令[eval-expression](http://www.gnu.org/software/emacs/manual/html_node/emacs/Lisp-Eval.html)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T18:00:54.880

要设置用`defcustom`您定义的变量，也可以使用`M-x set-variable`. 您不必键入括号，并且您将完成名称。

# java - 欧拉计划作业 17

> ID：16194631
> 
> 赞同：4
> 
> 时间：2013-04-24T14:27:24.657
> 
> 标签：java, string

我一直在尝试解决 ProjectEuler 上的 P17（[http://projecteuler.net/problem=17](http://projecteuler.net/problem=17)），但显然我遗漏了一些东西，因为我得到的答案（20908）更小。有人可以看看我的代码并告诉我吗？找了半个小时，还是看不到。

```
public class P17{
  public static void main(String[]args){
        //1, 2, 3... 9
        String[] a = {"one", "two", "three", "four", "five", "six", "seven", "eight", "nine"};
        int s1 = 0;
        for(String i: a){
            s1+=i.length();
        }

        //10, 11, 12... 19
        String[] b = {"ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen", "sixteen", "eighteen", "nineteen"};
        int s2 = 0;
        for(String i: b){
            s2+=i.length();
        }

        //20, 30, 40... 90
        String[] c = {"twenty", "thirty", "forty", "fifty", "sixty", "seventy", "eighty", "ninety"};
        int s3 = 0;
        for(String i: c){
            s3+=i.length();
        }

        //21, 22, 23... 31, 32, 33... 99
        int s4 = 0;
        for(String i: c){
            for(String j: a){
                s4+=(i+j).length();
            }
        }

        String x = "hundred";
        String y = "onethousand";
        String z = "and";

        //100, 200, 300... 900
        int s5 = 0;
        for(String i: a){
            s5+=(i+x).length();
        }

        //101, 102, 103... 201, 202, 203... 909
        int s6 = 0;
        for(String i: a){
            for(String j: a){
                s6+=(i+x+z+j).length();
            }
        }

        //110, 111, 112... 210, 211, 212... 919
        int s7 = 0;
        for(String i: a){
            for(String j: b){
                s7+=(i+x+z+j).length();
            }
        }

        //120, 130, 140... 220, 230, 240... 990
        int s8 = 0;
        for(String i: a){
            for(String j: c){
                s8+=(i+x+z+j).length();
            }
        }

        //121, 122, 123... 221, 222, 223... 999
        int s9 = 0;
        for(String i: a){
            for(String j: c){
                for(String k: a){
                    s9+=(i+x+z+j+k).length();
                }
            }
        }

        //sum
        int sum = s1+s2+s3+s4+s5+s6+s7+s8+s9+y.length();
        System.out.print(sum);
    }
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-24T14:29:15.523

```
String[] b = {"ten", "eleven", "twelve", "thirteen", "fourteen", "fifteen",
    "sixteen", "eighteen", "nineteen"}; 
```

十七在哪里？

（有趣的是你在 Project Euler 问题**17**上犯了这个错误......）

# codeigniter - 用于 Gmail 的带有 SMTP 的 CodeIgniter 非常、非常、非常慢

> ID：16194636
> 
> 赞同：2
> 
> 时间：2013-04-24T14:27:29.943
> 
> 标签：codeigniter, smtp

我正在使用gmail`ssl://smtp.gmail.com`的端口`465`，当我尝试在我的`CodeIgniter`应用程序中发送邮件时，它只是挂起。没有错误也没有警告 - 它实际上只是挂起。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T14:08:16.250

我有同样的问题。在尝试更改 CI-> 电子邮件中可用的所有可能设置后，我添加了

```
$this->email->set_newline("\r\n"); 
```

它奏效了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T23:12:21.063

从您在问题中提供的少量信息来看，您没有做错任何事情。

# c++ - 无论如何要在 QT 中对 UI 应用程序进行单元测试

> ID：16194640
> 
> 赞同：2
> 
> 时间：2013-04-24T14:27:36.870
> 
> 标签：c++, qt, unit-testing, user-interface

我之前在 java 中使用 JUint 和在 c++ 中使用 QT Test 进行了单元测试，但是我刚刚使用 QT 制作了一个 UI 应用程序，并且大多数需要测试的功能都是 QGraphicsView 中以图形方式表示的数据我想知道是否有测试 ui 的行为是否符合预期，而不是仅检查正在发送的数据

我担心的是，就测试显示而言，我可以从 ui 中提取的数据可能是正确的，但在实际呈现时可能表现不同。

我知道这个问题很模糊，所以请随意提问，我会尽量让任何可能提供建议的人更清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:30:15.867

查看FrogLogic 的[Squish](http://www.froglogic.com/squish/gui-testing/?gclid=CI3_2vvB47YCFep7Qgod0ioAbw)。

# asp.net - 动态创建的按钮在回发时不调用函数

> ID：16194641
> 
> 赞同：0
> 
> 时间：2013-04-24T14:27:43.067
> 
> 标签：asp.net, vb.net, vba, postback

在我的 Visual Basic Web 应用程序中，我有一个生成的按钮列表，这些按钮应该允许在单击时下载文件。

我在页面加载时使用生成的按钮的示例，但突然间下载功能停止在回发时被调用，现在所有按钮点击（对于任何按钮）都会导致页面回发。

我的代码：

```
Public folder As String
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not IsPostBack Then
        folder = "Main"
        PopulateFiles(folder)
    End If
End Sub

Protected Sub PopulateFiles(ByVal folder As String)
    Dim myConnection As SqlConnection
    Dim conString As String = ConfigurationManager.ConnectionStrings("ConnectionString").ConnectionString
    Dim myCommand As SqlCommand
    Dim myDataReader As SqlDataReader
    Dim text As String
    Dim size As Decimal
    Dim name As String
    Dim type As String
    Dim id As Integer
    folderName.Text = folder
    container.Controls.Clear()
    myConnection = New SqlConnection(conString)
    myConnection.Open()
    myCommand = New SqlCommand("Uploads_GetAllFiles", myConnection)
    myCommand.CommandType = CommandType.StoredProcedure
    myCommand.Parameters.AddWithValue("@folder", folder)
    Try
        myDataReader = myCommand.ExecuteReader()
        If myDataReader.HasRows Then
            Do While myDataReader.Read()
                name = myDataReader.Item("Name")
                type = myDataReader.Item("Type")
                id = myDataReader.Item("File_ID")
                size = Math.Round(myDataReader.Item("Size") / 1000, 2)
                container.Controls.Add(New LiteralControl("<div class='newRow'>"))
                text = "<div class='fileName'>" & name & "</div>"
                container.Controls.Add(New LiteralControl(text))
                text = "<div class='fileType'>" & type & "</div>"
                container.Controls.Add(New LiteralControl(text))
                text = "<div class='fileSize'>" & size.ToString() & "kb</div>"
                container.Controls.Add(New LiteralControl(text))
                container.Controls.Add(New LiteralControl("<div class='fileDownload'>"))
                Dim newBtn As New Button
                newBtn.ID = "link" & id
                newBtn.Text = "Download"
                newBtn.CssClass = "newbie"
                AddHandler newBtn.Click, AddressOf Retreive_Doc
                newBtn.CommandArgument = id
                container.Controls.Add(newBtn)
                container.Controls.Add(New LiteralControl("</div>"))
                container.Controls.Add(New LiteralControl("<div class='fileDelete'>"))
                Dim newDelBtn As New Button
                newDelBtn.ID = "delete" & id
                newDelBtn.Text = "Delete"
                newDelBtn.CssClass = "delBtn"
                AddHandler newDelBtn.Click, AddressOf Retreive_Xls
                newDelBtn.CommandArgument = id
                container.Controls.Add(newDelBtn)
                container.Controls.Add(New LiteralControl("</div>"))
                container.Controls.Add(New LiteralControl("</div>"))
            Loop
        End If

    Catch ex As Exception
        MsgBox(ex.ToString())
    Finally
        myConnection.Close()
    End Try
End Sub

Protected Sub Retreive_Doc(ByVal sender As Object, ByVal e As System.EventArgs) Handles LinkButton1.Click
    Dim button As Button = sender
    Dim id As Integer = button.CommandArgument
    Dim cmd As SqlCommand = New SqlCommand("Uploads_GetFile")
    cmd.CommandType = CommandType.StoredProcedure
    cmd.Parameters.AddWithValue("@id", id)
    Dim dt As DataTable = GetData(cmd)
    If dt IsNot Nothing Then
        download(dt)
    End If
End Sub 
```

我可以显示从此函数调用的函数，但初始函数甚至没有被调用，所以我不确定是否有道理。

我的HTML如下：

```
<form id="form1" runat="server">
<asp:ScriptManager ID="ScriptManager1" runat="server"></asp:ScriptManager>
<asp:FileUpload ID="upload1" runat="server" /><asp:Button ID="test1" runat="server" Text="Upload" />
<asp:TextBox ID="folderTag" runat="server" ></asp:TextBox>
<asp:Button ID="search" runat="server" Text="Search" />
<asp:Label ID="folderName" runat="server">General</asp:Label><br />
<div id="navContainer" runat="server">

</div>
    <div id="hiddenContent">      
    <asp:LinkButton ID="LinkButton1" CssClass="hide" runat="server" OnClick = "Retreive_Doc">Download Doc</asp:LinkButton>
    <asp:LinkButton ID="LinkButton2" CssClass="hide" runat="server" OnClick = "Retreive_Xls">Download xls</asp:LinkButton>
    </div>
<div id="container" runat="server">
</div>
</form> 
```

正如我之前所说。几天前这是可行的，并且在添加其他一些功能的过程中不知何故我失去了它。

我不确定为什么它在不调用任何函数的情况下发回。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:43:45.427

如果动态创建控件，则需要在回发中重新创建具有相同 ID 的控件。否则，它们将在回发后消失。

`If Not IsPostBack Then`在页面加载事件中删除。

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) 
  Handles Me.Load
   folder = "Main"
   PopulateFiles(folder)
End Sub 
```

**另一个想法**：

如果您想要 CommandArgument，是否有理由不使用 CommandEvent 而不是 Click 事件？

同样，有理由不使用`PlaceHolder`而不是`<div id="container" runat="server">`吗？

```
AddHandler newBtn.Command, AddressOf Retreive_Doc
newBtn.CommandArgument = id

....

protected void Retreive_Doc(object sender, CommandEventArgs e) 
```

# c# - 使用 Open XML 创建 word 文档

> ID：16194646
> 
> 赞同：13
> 
> 时间：2013-04-24T14:27:55.533
> 
> 标签：c#, asp.net, ms-word, openxml, openxml-sdk

我正在创建一个示例处理程序来生成简单的 Word 文档。
该文档将包含文本**Hello world**

这是我使用的代码（C# .NET 3.5），
我创建了 Word 文档，但其中没有文本，大小为 0。
我该如何修复它？
（我使用**CopyStream**方法，因为 CopyTo 仅在 .NET 4.0 及更高版本中可用。）

```
public class HandlerCreateDocx : IHttpHandler
{
    public void ProcessRequest(HttpContext context)
    {
        using (MemoryStream mem = new MemoryStream())
        {
            // Create Document
            using (WordprocessingDocument wordDocument =
                WordprocessingDocument.Create(mem, WordprocessingDocumentType.Document, true))
            {
                // Add a main document part. 
                MainDocumentPart mainPart = wordDocument.AddMainDocumentPart();

                // Create the document structure and add some text.
                mainPart.Document = new Document();
                Body body = mainPart.Document.AppendChild(new Body());
                Paragraph para = body.AppendChild(new Paragraph());
                Run run = para.AppendChild(new Run());
                run.AppendChild(new Text("Hello world!"));
                mainPart.Document.Save();
                // Stream it down to the browser
                context.Response.AppendHeader("Content-Disposition", "attachment;filename=HelloWorld.docx");
                context.Response.ContentType = "application/vnd.ms-word.document";
                CopyStream(mem, context.Response.OutputStream);
                context.Response.End();
            }
        }
    }

    // Only useful before .NET 4
    public void CopyStream(Stream input, Stream output)
    {
        byte[] buffer = new byte[16 * 1024]; // Fairly arbitrary size
        int bytesRead;

        while ((bytesRead = input.Read(buffer, 0, buffer.Length)) > 0)
        {
            output.Write(buffer, 0, bytesRead);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-24T15:49:45.817

通过将流代码放在外部 USING 块中，这对我有用。

这会导致调用`WordprocessingDocument.Close`（通过 Dispose 方法）。

```
public void ProcessRequest(HttpContext context)
{
    using (MemoryStream mem = new MemoryStream())
    {
        // Create Document
        using (WordprocessingDocument wordDocument =
            WordprocessingDocument.Create(mem, WordprocessingDocumentType.Document, true))
        {
            // Add a main document part. 
            MainDocumentPart mainPart = wordDocument.AddMainDocumentPart();

            // Create the document structure and add some text.
            mainPart.Document = new Document();
            Body body = mainPart.Document.AppendChild(new Body());
            Paragraph para = body.AppendChild(new Paragraph());
            Run run = para.AppendChild(new Run());
            run.AppendChild(new Text("Hello world!"));
            mainPart.Document.Save();
        }

        context.Response.ContentType = "application/vnd.openxmlformats-officedocument.wordprocessingml.document";
        context.Response.AppendHeader("Content-Disposition", "attachment;filename=HelloWorld.docx");
        mem.Seek(0, SeekOrigin.Begin);
        mem.CopyTo(context.Response.OutputStream);
        context.Response.Flush();
        context.Response.End();
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:14:44.720

我已经修改了您的代码以使其正常工作。保存下载后我可以正确打开它。请看我下面的修改。希望这有帮助。

```
using (MemoryStream documentStream = new MemoryStream())
{
    using (WordprocessingDocument myDoc = WordprocessingDocument.Create(documentStream, WordprocessingDocumentType.Document, true))
    {
        // Add a new main document part. 
        MainDocumentPart mainPart = myDoc.AddMainDocumentPart();
        //Create Document tree for simple document. 
        mainPart.Document = new Document();
        //Create Body (this element contains
        //other elements that we want to include 
        Body body = new Body();
        //Create paragraph 
        Paragraph paragraph = new Paragraph();
        Run run_paragraph = new Run();
        // we want to put that text into the output document 
        Text text_paragraph = new Text("Hello World!");
        //Append elements appropriately. 
        run_paragraph.Append(text_paragraph);
        paragraph.Append(run_paragraph);
        body.Append(paragraph);
        mainPart.Document.Append(body);

        // Save changes to the main document part. 
        mainPart.Document.Save();
        myDoc.Close();
        context.Response.ClearContent();
        context.Response.ClearHeaders();
        context.Response.ContentEncoding = System.Text.Encoding.UTF8;
        SetContentType(context.Request, context.Response, "Simple.docx");
        documentStream.Seek(0, SeekOrigin.Begin);
        documentStream.CopyTo(context.Response.OutputStream);
        context.Response.Flush();
        context.Response.End();
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-02T02:25:59.183

```
string Filepath = @"C:\Users\infinity\Desktop\zoyeb.docx";
using (var wordprocessingDocument = WordprocessingDocument.Create(Filepath, DocumentFormat.OpenXml.WordprocessingDocumentType.Document))
{
    MainDocumentPart mainPart = wordprocessingDocument.AddMainDocumentPart();
    mainPart.Document = new DocumentFormat.OpenXml.Wordprocessing.Document();
    Body body = mainPart.Document.AppendChild(new Body());
    DocumentFormat.OpenXml.Wordprocessing.Paragraph para = body.AppendChild(new DocumentFormat.OpenXml.Wordprocessing.Paragraph());
    DocumentFormat.OpenXml.Wordprocessing.Run run = para.AppendChild(new DocumentFormat.OpenXml.Wordprocessing.Run());
    run.AppendChild(new DocumentFormat.OpenXml.Wordprocessing.Text("siddiq"));
    wordprocessingDocument.MainDocumentPart.Document.Save();
} 
```

转到 nuget 包管理器并首先将其安装到您的项目中

```
Install-Package DocumentFormat.OpenXml -Version 2.8.1 
```

# javascript - 将弱简单多边形拆分为真正的简单多边形或多边形

> ID：16194648
> 
> 赞同：8
> 
> 时间：2013-04-24T14:28:06.513
> 
> 标签：javascript, graph, svg, polygon

我想将弱简单的多边形划分为简单的多边形。

**背景**

[用例是使用Javascript Clipper](https://sourceforge.net/projects/jsclipper/)简化已简化（联合）的多边形。Javascript Clipper 和[原始 Clipper 的](https://sourceforge.net/projects/polyclipping/?source=directory) `SimplifyPolygon()`功能一样，去除了自相交并组合了公共边，但它不能生成真正的简单多边形。输出用于three.js，`TriangulateShapes()`它需要多边形简单。Three.js 接受具有一个轮廓和零个或多个孔的多边形结构。

**输入，弱简单多边形**

弱简单多边形不能有顺序重复顶点（真正的重复点），也不能有孔（岛），也不能有自相交（边与另一条边交叉），但可以有非顺序多顶点（具有完全相同的坐标但不是顺序的）。输入多边形可以有 CW 或 CCW 缠绕顺序，这意味着 CW 输入是外部多边形，CCW 是一个孔。输入是 CW 或 CCW 多边形。

输入是一个多边形点数组，例如：

```
// 这是一个弱简单多边形的真实例子：

var 输入 = [{"X":270,"Y":520},{"X":130,"Y":490},{"X":210,"Y":250},{"X" :60,"Y":170},{"X":130,"Y":490},{"X":20,"Y":410},{"X":60,"Y":300 },{"X":60,"Y":20},{"X":780,"Y":40}, {"X":680,"Y":180},{"X":460 ,"Y":130},{"X":210,"Y":250},{"X":320,"Y":100},{"X":220,"Y":80}, {"X":210,"Y":250},{"X":520,"Y":250},{"X":680,"Y":180},{"X":770," Y":480},{"X":540,"Y":470}, {"X":520,"Y":250},{"X":380,"Y":280},{" X":430,"Y":390},{"X":540,"Y":470},{"X":270,"Y":520},{"X":330,"Y":350},{"X":210,"Y":250 }];

```

这是上面的`input`多边形作为图像：

![在此处输入图像描述](https://i.stack.imgur.com/5BGZe.png)

以下是编号的点，您可以在其中轻松查看哪些点是重复的：

![在此处输入图像描述](https://i.stack.imgur.com/bMEQZ.png)

如您所见，上述多边形可以有多种划分方式，例如：
- 一个外多边形有五个孔 - 五个外多边形，其中一个有一个孔

**输出，简单多边形作为 exPolygon 结构**

简单多边形是没有自相交的多边形，无论它们是连续的还是非连续的，都没有重复的坐标，没有孔。输出的简单多边形可以有 CW 或 CCW 绕组顺序。CW 表示外孔和 CCW 孔。

输出可以有（而且很多时候会有）孔，但在某些情况下，输出没有孔。输出始终具有至少一个外部多边形，但也可以有多个具有零个或多个孔的外部多边形。

输出应该是具有“外部”和“孔”属性的 exPolygon 对象数组。“outer”是点对象数组，“holes”是点对象数组。如果填充了“孔”，则其中的孔必须是 exPolygon 对象中“外部”多边形的孔。

输出示例：

```
// 这是一个输出示例，但点是随机的：

[ { "外": [{"X":54,"Y":4},{"X":2,"Y":50},{"X":30,"Y":5},{ "X":10,"Y":50}],
    “洞”：[[{“X”：0，“Y”：8}，{“X”：60，“Y”：13}，{“X”：21，“Y”：2}，{“ X":3,"Y":1}],
               [{"X":21,"Y":2},{"X":50,"Y":2},{"X":6,"Y":1}] ] },
  {“外”：[{“X”：54，“Y”：4}，{“X”：2，“Y”：50}，{“X”：30，“Y”：5}，{“ X":10,"Y":50}],
    “洞”：[[{“X”：0，“Y”：8}，{“X”：60，“Y”：13}，{“X”：21，“Y”：2}，{“ X":3,"Y":1}],
               [{"X":21,"Y":2},{"X":50,"Y":2},{"X":6,"Y":1}] ] },
  {“外”：[{“X”：54，“Y”：4}，{“X”：2，“Y”：50}，{“X”：30，“Y”：5}，{“ X":10,"Y":50}],
    “洞”：[] }
];

```

输出的“外部”多边形是 CW，“孔”是 CCW。

多边形中的点数、exPolygons 对象数和孔数没有限制。

以下是弱简单多边形的其他示例：

![在此处输入图像描述](https://i.stack.imgur.com/xcfze.png)

**分割示例**

这是输入多边形的示例：

![在此处输入图像描述](https://i.stack.imgur.com/chrsf.png)

这是如何划分的：

![在此处输入图像描述](https://i.stack.imgur.com/uD12s.png)

其他一些多边形可以有多种可能的输出选择，具体取决于伪重复点的位置。

* * *

**我的问题**

如何以这种方式划分多边形并实现所需的输出结构？我不是在问完整的代码（但如果你有一些空闲时间并想证明它是可能的）。也欢迎考虑可能的算法。

* * *

我已经搜索了几个小时的解决方案并试图找到一种算法。

如果您想尝试解决方案，我这里有一个用于查找重复项的代码：http: [//jsbin.com/unuyev/7/edit](http://jsbin.com/unuyev/7/edit)。它在 SVG 中显示多边形，并将点显示为红色圆圈和每个点的数组索引（按下按钮“使用 JS 运行”后）。

这是相同的，但有 12 个示例多边形（`pindex`在 Javascript 窗口中更改以更改多边形）：http: [//jsbin.com/unuyev/4/edit](http://jsbin.com/unuyev/4/edit)

* * *

编辑：[Javascript Clipper 6](https://sourceforge.net/projects/jsclipper/files/?source=navbar)现在可用，并且支持`StrictlySimple`. 但是根据文档“目前不能保证多边形会严格简单，因为'简化'仍在进行中”。我已经测试了 StrictlySimple，但在某些情况下它会失败：[方向问题](https://sourceforge.net/p/polyclipping/discussion/1148419/thread/0a24db5a/)和[缺乏旋转不变性](https://sourceforge.net/p/polyclipping/discussion/1148419/thread/5c844c2f/#9757)。我们希望这些问题尽快得到修复`StrictlySimple`并按预期工作。

* * *

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:15:42.647

我可能遗漏了一些东西，但这看起来像是找到图形的关节顶点的经典问题。本质上，您试图找到图表中最薄弱的点，这样当您在该点切割图表时，您最终会得到两个单独的图表。所以在你的例子中，如果你在那个顶点切割多边形，你最终会得到多个多边形。您可以很容易地将多边形表示为图形，每个顶点代表一个图形顶点，多边形边作为图形边。

如果我必须解决问题，这就是我会采取的方法。您可以查看以下资源：

*   [算法设计手册中的关节顶点](http://books.google.com/books?id=7XUSn0IKQEgC&pg=PA174&lpg=PA174&dq=articulation+vertex+of+graph&source=bl&ots=z7bISQJS5d&sig=qa5SWLZaV6t8_SgVm0o7jsPK3Ik&hl=en&sa=X&ei=_xJ4UdmgN-moiAKbvIGYDg&ved=0CJcBEOgBMA4#v=onepage&q=articulation%20vertex%20of%20graph&f=false)- 这是你最好的选择。他用简单的术语解释了该算法，并为您提供了可以轻松转换为 JavaScript 的 C 代码。如果我必须开始编写算法，这就是我要开始的地方。
*   [双连通分量](http://en.wikipedia.org/wiki/Biconnected_component)
*   [咬合点检测](http://www.utdallas.edu/~ravip/cs3345/slidesweb/node7.html)（搜索“咬合”）

**更新**

我将尝试为您简要概述问题和解决方案，为您指明正确的方向。使用图实现此算法必然会涉及到图算法术语，因此如果您不熟悉图，您可能需要阅读它们。

在您的情况下，蛮力方法是遍历图形，临时删除每个 vetex，然后在修改后的图形上进行 DFS/BFS 遍历时查看图形是否连接。这不是很有效，并且将在二次时间中运行`O(n(m + n))`。但是有一种线性时间算法，它基于对由 DFS 遍历形成的结果 DFS 树的边缘进行分类。

在不包含任何后边的 DFS 树中（将“较低”节点连接到树中“较高”节点的边 [假设“较高”节点是那些更靠近根的节点]）叶节点不是关节节点，因为删除其中任何一个仍会使图形保持连接状态。但是，删除任何内部节点都会将其后的任何节点与根断开连接。

删除树的根取决于它是否有一个或多个孩子。如果它只有一个孩子，那么它或多或少是一片叶子，因此删除它不会有任何效果。但是，删除具有多个子节点的根节点会断开图的连接。

但是在一般图表中，您可以有后边，因此删除其间的任何节点都不会断开图表。因此，找出关节顶点归结为找出树的哪些部分通过后边链接到祖先节点（即，找出顶点的“可达祖先”）。

在我从算法设计手册链接到的页面中，Skiena 描述了顶点可以是关节顶点（根、桥和父切割节点）的三种情况。使用他描述的算法，您可以确定您正在处理的顶点是否满足任何这些条件。如果是这样，它就是一个关节节点。

希望这可以帮助您入门！

# ios - 来自另一个视图控制器的 iOS reloadTable 函数

> ID：16194649
> 
> 赞同：0
> 
> 时间：2013-04-24T14:28:09.193
> 
> 标签：ios, objective-c, nsnotificationcenter

我有两个视图控制器 A 和 B。

Into AI 有一个 UITableView 和一个 NSNotification 观察者进入 viewDidLoad 函数。

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(refreshInterface) name:@"newDataAreAvailable" object:nil]; 
```

相关选择器：

```
-(void) refreshInterface{
    [[self tableView] reloadData];
} 
```

现在，从我的 B ViewController 我向 A 发布通知以重新加载我的 tableview 数据。

但是`cellForRowAtIndexPath`永远不会被调用并`numberOfRowsInSection`返回 5 个元素。

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:33:08.770

cellForRowAtIndexPath 仅在单元格变为可见时调用。如果表 A 不可见，则在它变得可见之前不会发生。

您还需要确认您的通知正在被触发并且正在重新加载。

# java - 不幸的是，模拟器抛出，myapp 已停止消息

> ID：16194651
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:28:18.377
> 
> 标签：java, php, android

我使用 JSON 为 android 中的客户端服务器通信编写了代码。我正在使用 WAMP 服务器并且 PHP 文件中没有错误。当我运行我的应用程序模拟器时显示“不幸的是，myapp 已停止”。请建议我的想法。我试图修复，但我不能。我的java文件：

```
package com.example.http;

import java.io.BufferedReader;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.util.ArrayList;

import org.apache.http.HttpEntity;
import org.apache.http.HttpResponse;
import org.apache.http.NameValuePair;
import org.apache.http.client.HttpClient;
import org.apache.http.client.entity.UrlEncodedFormEntity;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.impl.client.DefaultHttpClient;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

import android.app.ListActivity;
import android.net.ParseException;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends ListActivity {

JSONArray jArray;
String result = null;
InputStream is = null;
StringBuilder sb=null;
TextView tv;

@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

 ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
//http post
try{
     HttpClient httpclient = new DefaultHttpClient();
     HttpPost httppost = new HttpPost("http://10.0.2.2/android_connect/read1.php");
     httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
     HttpResponse response = httpclient.execute(httppost);
     HttpEntity entity = response.getEntity();
     is = entity.getContent();
     }catch(Exception e){
         Log.e("log_tag", "Error in http connection"+e.toString());
    }
//convert response to string
try{
      BufferedReader reader = new BufferedReader(new InputStreamReader(is,"iso-8859-1"),8);
       sb = new StringBuilder();
       sb.append(reader.readLine() + "\n");

       String line="0";
       while ((line = reader.readLine()) != null) {
                      sb.append(line + "\n");
        }
        is.close();
        result=sb.toString();
        }catch(Exception e){
              Log.e("log_tag", "Error converting result "+e.toString());
        }
//paring data

try{
      jArray = new JSONArray(result);
      JSONObject json_data=null;
      for(int i=0;i<jArray.length();i++){
             json_data = jArray.getJSONObject(i);
             String ct_name = json_data.getString("User_ID");
             tv = (TextView) findViewById(R.id.textView1);

             tv.setText(ct_name);

         }
      }
      catch(JSONException e1){
          Toast.makeText(getBaseContext(), "No City Found" ,Toast.LENGTH_LONG).show();
      } catch (ParseException e1) {
            e1.printStackTrace();
    }
}
} 
```

和 PHP 文件：

```
<?php
mysql_connect("localhost","root","");
mysql_select_db("androidhive");
$sql=mysql_query("select User_ID from opass");
while($row=mysql_fetch_assoc($sql))
$output[]=$row;
print(json_encode($output));
mysql_close();
?> 
```

日志错误：

```
04-21 22:43:33.502: E/AndroidRuntime(399): FATAL EXCEPTION: main
04-21 22:43:33.502: E/AndroidRuntime(399): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.http/com.example.http.MainActivity}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2180)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2230)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.ActivityThread.access$600(ActivityThread.java:141)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1234)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.os.Handler.dispatchMessage(Handler.java:99)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.os.Looper.loop(Looper.java:137)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.ActivityThread.main(ActivityThread.java:5041)
04-21 22:43:33.502: E/AndroidRuntime(399):  at java.lang.reflect.Method.invokeNative(Native Method)
04-21 22:43:33.502: E/AndroidRuntime(399):  at java.lang.reflect.Method.invoke(Method.java:511)
04-21 22:43:33.502: E/AndroidRuntime(399):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
04-21 22:43:33.502: E/AndroidRuntime(399):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
04-21 22:43:33.502: E/AndroidRuntime(399):  at dalvik.system.NativeStart.main(Native Method)
04-21 22:43:33.502: E/AndroidRuntime(399): Caused by: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list'
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.ListActivity.onContentChanged(ListActivity.java:243)
04-21 22:43:33.502: E/AndroidRuntime(399):  at com.android.internal.policy.impl.PhoneWindow.setContentView(PhoneWindow.java:273)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.Activity.setContentView(Activity.java:1881)
04-21 22:43:33.502: E/AndroidRuntime(399):  at com.example.http.MainActivity.onCreate(MainActivity.java:40)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.Activity.performCreate(Activity.java:5104)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1080)
04-21 22:43:33.502: E/AndroidRuntime(399):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2144) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:32:35.540

扩展`ListActivity`和提供自定义布局时，您必须将以下**Id**设置为您的`ListView`in xml - 在本例中为您的`activity_main`.

```
android:id="@android:id/list" 
```

顺便说一句，异常本身就足够解释了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:31:59.020

> 您的内容必须具有`ListView`其`id`属性为 'android.R.id.list'

您的 R.layout.activity_main 没有 listview 元素。

PS：你不应该在主线程上使用网络请求阅读关于[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:36:49.877

从错误消息中：

```
04-21 22:43:33.502: E/AndroidRuntime(399): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.example.http/com.example.http.MainActivity}: java.lang.RuntimeException: Your content must have a ListView whose id attribute is 'android.R.id.list' 
```

您的 "activity_main.xml" 可能没有 id 为 "android.R.id.list" 的属性。因为您的活动扩展了“ListActivity”，所以您应该包含它。

# c++ - 输入错误的If语句

> ID：16194654
> 
> 赞同：-4
> 
> 时间：2013-04-24T14:28:24.297
> 
> 标签：c++, if-statement

程序没有输入它应该输入的 if 语句。例如，当 sentence1 是 oguzhan 并且 sentence2 是第一个字符的 bugrahan 时，它应该输入第一个 if 语句结束替换应该是 4，但它没有。

```
#include <iostream>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <cmath>

using namespace std;

int main() {
  char sentence1[50];
  char sentence2[50];
  int m, n, k, l;
  int i, j, substitution;
  cout << "Enter the first word:" << endl;
  cin >> sentence1;
  cout << "Enter the second word:" << endl;
  cin >> sentence2;
  m = strlen(sentence1);
  n = strlen(sentence2);
  int cost[m + 1][n + 1];
  cost[0][0] = 0;

  for (i = 1; i < m + 1; i++) {
    cost[i][0] = cost[i - 1][0] + 2;

  }
  for (j = 1; j < n + 1; j++) {
    cost[0][j] = cost[0][j - 1] + 2;

  }

  for (i = 1; i < m + 1; i++) {
    for (j = 1; j < n + 1; j++) {

      if ((sentence1[i - 1] == 'a' || sentence1[i - 1] == 'u' ||
           sentence1[i - 1] == 'e' || sentence1[i - 1] == 'i' ||
           sentence1[i - 1] == 'o') &&
          (sentence2[j - 1] != 'a' || sentence2[j - 1] != 'u' ||
           sentence2[j - 1] != 'e' || sentence2[j - 1] != 'i' ||
           sentence2[j - 1] != 'o')) {
        substitution = 4;
      }

      if ((sentence1[i - 1] != 'a' || sentence1[i - 1] != 'u' ||
           sentence1[i - 1] != 'e' || sentence1[i - 1] != 'i' ||
           sentence1[i - 1] != 'o') &&
          (sentence2[j - 1] == 'a' || sentence1[i - 1] != 'u' ||
           sentence1[i - 1] != 'e' || sentence1[i - 1] != 'i' ||
           sentence1[i - 1] != 'o')) {
        substitution = 4;
      }

      if (sentence1[i - 1] == sentence2[j - 1]) {
        substitution = 0;
      }

      if ((sentence1[i - 1] == 'a' || sentence1[i - 1] == 'u' ||
           sentence1[i - 1] == 'e' || sentence1[i - 1] == 'i' ||
           sentence1[i - 1] == 'o') &&
          (sentence2[j - 1] == 'a' || sentence2[j - 1] == 'u' ||
           sentence2[j - 1] == 'e' || sentence2[j - 1] == 'i' ||
           sentence2[j - 1] == 'o')) {
        substitution = 3;
      }
      if ((sentence1[i - 1] != 'a' || sentence1[i - 1] != 'u' ||
           sentence1[i - 1] != 'e' || sentence1[i - 1] != 'i' ||
           sentence1[i - 1] != 'o') &&
          (sentence2[j - 1] != 'a' || sentence2[j - 1] != 'u' ||
           sentence2[j - 1] != 'e' || sentence2[j - 1] != 'i' ||
           sentence2[j - 1] != 'o')) {
        substitution = 3;
      }

      cost[i][j] = min(min(cost[i - 1][j] + 2, cost[i][j - 1] + 2),
                       cost[i - 1][j - 1] + substitution);
    }
  }

  for (i = 0; i < m + 1; i++) {
    for (j = 0; j < n + 1; j++) {

      cout << cost[i][j] << "  ";
    }
    cout << endl;
  }

  cout << sentence1[0];
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T14:32:49.363

像这样的条件：`sentence2[j-1]!='a'||sentence2[j-1]!='u'`始终为真 - 没有单个字符可以同时等于`a`和`u`，因此其中一个必须为真。

如果您正在使用`!=`，它必须几乎总是由`&&`, not加入`||`，否则结果将始终为真，无论输入如何。

# matlab - 在 Matlab 中设置不同的单元格格式

> ID：16194673
> 
> 赞同：3
> 
> 时间：2013-04-24T14:29:23.013
> 
> 标签：matlab, properties, formatting, matlab-uitable

我正在寻找一种在 Matlab 的一列中处理不同类型数据的方法`uitable`。

通常`uitable`用于将整列设置为相同的数据类型，例如`logical`（给出复选框）、`char`（给出左对齐文本）、`numeric`（给出右对齐数字）或 1xn-cell-array（给出带有不同的选择）。

它是使用 的`columnformat`属性设置的`uitable`，例如

```
columnformat = {'numeric', 'logical', {'Fixed' 'Adjustable'}}; % 3 columns 
```

[您可以在 matlab 文档](http://www.mathworks.de/de/help/matlab/ref/uitable.html)中找到一个示例。

我正在寻找一种方法来设置单个单元格的格式以实现如下所示：

![不同的单元格格式](https://i.stack.imgur.com/cXCUN.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T07:31:42.860

Matlab 的 uitable 是底层 JIDE 表的残缺版本。
可以访问底层 java（参见文件交换中的[findjobj](http://www.mathworks.com/matlabcentral/fileexchange/14317-findjobj-find-java-handles-of-matlab-graphic-objects)），但这需要大量工作。Yair Altman 的未记录的 matlab 站点是了解 matlab 的 java 方面的良好起点。

听起来您想要一个属性编辑器之类的东西，而不是通用 UI 表——即第一列中列出的属性，第二列中可编辑的属性值。文件交换中有几个“现成”版本，它们使用 JIDE：

请参阅 [propertiesgui](http://www.mathworks.com/matlabcentral/fileexchange/38864-propertiesgui-display-properties-in-an-editable-context-aware-table)或[property-grid](http://www.mathworks.com/matlabcentral/fileexchange/28732-property-grid-using-jide-implementation)以获取大多数功能示例。第二个示例更易于使用——您只需提供一个类或结构，它就会创建正确的字段输入格式。第一个提供了更多选择——比如颜色框、下拉菜单等，但需要您更多地参与指定事物的行为方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-14T19:25:27.870

我有同样的问题，但最终它通过给（数字）单元格一个（char）初始值来工作。从 UI 更改 char 值时，单元格的格式仍然是 char，尽管该列的其余部分是数字。

# delphi - Delphi XE4 使用 FmxHandleToObjC 函数我必须包括什么

> ID：16194676
> 
> 赞同：4
> 
> 时间：2013-04-24T14:29:26.800
> 
> 标签：delphi, firemonkey, delphi-xe4

我刚刚安装了 XE4，我正在尝试从网络上为 osx 编译一些示例应用程序。

我收到“未声明的标识符 FmxHandleToObjC”错误时无法编译

我已经设置了 SDK，但在网上找不到任何帮助。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T16:11:57.243

该函数在 XE3 中定义，`FMX.Platform.Mac`但在 XE4 中已删除。替换功能似乎是`WindowHandleToPlatform`.

# javascript - 浏览器处理来自 Ajax 请求的 302 响应

> ID：16194678
> 
> 赞同：1
> 
> 时间：2013-04-24T14:29:31.833
> 
> 标签：javascript, jquery, ajax, http, redirect

我有以下。

1.  向服务器发出的 AJAX 请求来自`mydomain.blah.com`
2.  服务器返回 302 **，但**返回到稍微不同的`blah.com`域`mydomain.blah.com`
3.  浏览器似乎破坏了响应。不是`302`进入我的错误回调，而是返回没有响应正文且没有状态代码的响应。

更多详细信息

*   查看 IE 10 中的请求，它被标记为已中止。
*   在 FF 中，萤火虫显示 302 回来了，但它从未被处理过。

使事情复杂化（尽管我不认为这是相关的）发送了多个 ajax 请求。

返回 302 的原因是因为我的服务器会话超时并且我被重定向到登录页面。我对服务器没有太多控制权。

我想从我的服务器发送响应代码 302 到我的错误回调中。这就是我想要实现的。

ajax 调用是使用 JQuery 进行的。

任何帮助表示赞赏。

如果浏览器从 ajax 调用中“破坏”对不同域的 302 响应是官方政策，那么如果有人可以提供一个很酷的参考。然后我就知道我对此无能为力。

# java - Java中字节类型的用途

> ID：16194681
> 
> 赞同：12
> 
> 时间：2013-04-24T14:29:38.700
> 
> 标签：java, byte, primitive

我在 Java 教程中读到了这一行：

> byte：byte 数据类型是一个 8 位有符号二进制补码整数。它的最小值为 -128，最大值为 127（含）。字节数据类型可用于在大型数组中节省内存，其中内存节省实际上很重要。**它们也可以用来代替 int ，它们的限制有助于澄清您的代码；变量的范围有限这一事实可以作为一种文档形式。**

我不太清楚粗线。有人可以为我解释一下吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-24T14:34:33.943

Byte 的（有符号）范围是 -128 到 127，而 int 的（也有符号）范围是 -2,147,483,648 到 2,147,483,647。

这意味着，由于您要使用的值将始终在该范围之间，通过使用字节类型，您告诉任何阅读您的代码的人该值将始终在 -128 到 127 之间，而无需记录关于它。

尽管如此，正确的文档始终是关键，您应该只在出于可读性目的而指定的情况下使用它，而不是作为文档的替代品。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-24T14:31:45.403

如果您使用最大值为 127 的变量，则可以使用`byte`而不是`int`让其他人知道而无需阅读任何`if`条件，这可能会检查边界，该变量只能具有 -128 和 127 之间的值。

所以这是一种自我记录的代码 - 正如你引用的文本中提到的那样。

就个人而言，我不推荐这种“文档”——仅仅因为一个变量只能保存最大值 127 并不能揭示它的真正目的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-24T14:38:45.370

我想可以`byte`用于处理*实际*字节的任何事情。

此外，颜色的部分（红色、绿色和蓝色）通常具有 0-255 的范围（虽然`byte`从技术上讲是 -128 到 127，但数量相同）。

也可能有其他用途。

我必须使用的一般反对意见`byte`（可能是为什么它没有被尽可能频繁地看到）是需要大量的演员表。例如，每当您对 a `byte`(except `X=`) 进行算术运算时，它会自动提升为`int`(even `byte+byte`)，因此如果要将其放回 a ，则必须将其强制转换`byte`。

**一个非常基本的例子：**

[FileInputStream::read](http://docs.oracle.com/javase/7/docs/api/java/io/FileInputStream.html#read%28%29)返回一个`byte`包裹在一个`int`（或-1）中。可以将其转换为 an`byte`以使其更清晰。**我不支持这个例子**（因为我真的（此时）不明白做下面的事情的意义），只是说类似的话可能是有道理的。

它也可能首先*返回*一个字节（如果文件结束，可能会引发异常）。这可能更清楚，但这样做的方式确实有意义。

```
FileInputStream file = new FileInputStream("Somefile.txt");
int val;
while ((val = file.read()) != -1)
{
  byte b = (byte)val;
  // ...
} 
```

如果您不太了解`FileInputStream`，您可能不知道`read`返回什么，因此您会看到 an`int`并且您可能会假设有效范围是`int`(-2^31 到 2^31-1) 的整个范围，或者可能是a `char`(0-65535) （对于文件操作来说不是一个糟糕的假设），但随后您会看到演员`byte`表并重新考虑。

如果返回类型是`byte`，您将从一开始就知道有效范围。

**另一个例子：**

[Color](http://docs.oracle.com/javase/7/docs/api/java/awt/Color.html)的构造函数之一可能已从 3 更改为 3 `int`，`byte`因为它们的范围限制为 0-255。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-24T14:39:36.130

`Integers`在 Java 中以 32 位存储；`bytes`以 8 位存储。

假设您有一个包含一百万个条目的数组。哎呀！那是巨大的！

```
int[] foo = new int[1000000]; 
```

现在，对于 中的每个整数`foo`，您使用**32 位**或**4 字节**的内存。总共有**400 万字节**，即**4MB**。

请记住，`integer`Java 中的 an 是介于 -2,147,483,648 和 2,147,483,647 之间的整数。如果您的数组`foo`只需要包含 1 到 100 之间的整数怎么办？`foo`通过声明为`int`数组，您没有使用很多数字。

这是`byte`变得有帮助的时候。`Bytes`存储 -128 和 127 之间的整数，非常适合您的需要！但为什么选择`bytes`？*因为它们使用了整数空间的四分之一*。现在您的数组正在浪费更少的内存：

```
byte[] foo = new byte[1000000]; 
```

现在每个条目`foo`占用**8 位**或**1 个字节**的内存，因此总共`foo`只占用**100 万字节**或**1MB**的内存。

与使用相比，这是一个*巨大*的改进`int[]`——您刚刚节省了 3MB 的内存。

显然，您不想将其用于包含超过 127 的数字的数组，因此另一种阅读您提到的粗体行的方法是，**由于字节范围有限，这让开发人员知道该变量严格限制为这些界限**。开发人员没有理由假设存储为字节的数字会超过 127 或小于 -128。使用适当的数据类型可以节省空间并通知其他开发人员对变量施加的限制。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-24T14:32:52.127

这意味着知道一个值被显式声明为一个非常小的数字可能会帮助您回忆它的用途。

当您必须为代码创建文档时，请选择真正的文档，但是，依赖数据类型不是文档。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-24T14:36:05.143

int 涵盖从 0 到 4294967295 或 2 到 32 次方的值。这是一个很大的范围，如果你的测试得分超过 100，那么如果你的所有数字都在 0 到 100 之间，那么你就是在浪费额外的空间。存储整数只需要更多的内存和硬盘空间，而且严重的是如果您不使用 int 提供的额外范围，数据驱动的应用程序就会浪费金钱。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-05-26T14:45:40.950

当您想要处理来自文件或网络的流形式的数据时，通常使用字节数据类型。这背后的原因是因为网络和文件是在字节的概念上工作的。

示例： FileOutStream 始终将字节数组作为输入参数。

# javascript - 绑定主干表单视图 UIto 模型更改以启用和禁用“保存”按钮

> ID：16194682
> 
> 赞同：2
> 
> 时间：2013-04-24T14:29:39.507
> 
> 标签：javascript, jquery, backbone.js, backbone-views, backbone-events

我正在使用主干、下划线和主干.stickit 库创建类似这样的形式。我的屏幕大部分看起来[有点像这样](http://jsfiddle.net/Lasang/Mp6G9/198/embedded/result/)。

## 表单html

```
<form id="main">
<div>
    <label for="words">words: <input name="words" type="text"/></label>     
</div>
 <div>
    <label for="type">type: <input name="type" type="text"/></label>     
</div>

    <div>
        <input id="okButton" class="btn" value="save"/>
   </div> 
```

## 主干模型/视图

```
 var app = {
 Model: Backbone.Model.extend({}),
 View: Backbone.View.extend({
    initialize: function() {
        this.setElement($('#main'));
    },
    bindings: {
        'input[name=words]': 'words',
        'input[name=type]': 'type',
        'input#okButton': {
          attributes: [{
            name: 'disabled',
            observe:['type','words'],
            onGet: 'okButtonDisabled'
          }],
        }
    },
    okButtonDisabled: function(words) {
        return words[0].length > 0 ? null : true;
    },
    addDisabledClass: function(words) {
        return words[0].length > 0 ? "" : "disabled";
    },
    render: function() {
        this.stickit();
    }
 })
 }; 
```

当用户在类型字段中输入一些值时，“保存”按钮被启用，否则它被禁用。

上面的例子只绑定类型字段。它不适用于“单词”字段。

# 我正在做的事情

我正在处理的表单的 jsfiddle 在[这里](http://jsfiddle.net/Lasang/Mp6G9/201/)。

## 表单html

```
 <form id="main">
 <div>
     <label for="words">words: <input name="words" type="text"/></label>     
 </div>
 <div>
     <label for="type">type: <input name="type" type="text"/></label>     
 </div>
 </form> 
```

## 模型/视图代码

```
var app = {
Model: Backbone.Model.extend({}),
View: Backbone.View.extend({
    initialize: function() {
        this.setElement($('#main'));
    },
    bindings: {
        'input[name=words]': 'words',
        'input[name=type]': 'type',
        'input#okButton': {
          attributes: [{
            name: 'disabled',
            observe:['type','words'],
            onGet: 'okButtonDisabled'
          }],
        }
    },
    okButtonDisabled: function(words) {
        return words[0].length > 0 ? null : true;
    },
    addDisabledClass: function(words) {
        return words[0].length > 0 ? "" : "disabled";
    },
    render: function() {
        this.stickit();
    }
  })
 };
 var model = new app.Model({
   words: "apple",
   type: "fruit"
 });
 var view = new app.View({
    model: model
 });
 view.render(); 
```

## 我想做的是：

*   最初将“保存”按钮设置为禁用。
*   如果用户对任何表单字段进行任何更改，则必须启用“保存”按钮。
*   但是，如果用户在任何字段中输入内容以启用“保存”按钮，并再次使该字段与原始字段相同，则必须再次禁用“保存”按钮。即将“apple”编辑为“apppleee”，以便启用“保存”，然后将“appleee”反转回“apple”以再次禁用“保存”按钮。

***提前感谢您的帮助。***

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:40:47.927

”*最初将“保存”按钮设置为禁用。* ”
这可以通过 HTML 标记或在`initialize`您的视图（或类似）的方法中完成。

"*如果用户对任何表单字段进行任何更改，则必须启用“保存”按钮。但是，如果用户在任何字段中输入内容以启用“保存”按钮，并再次使该字段与原始字段相同，则“保存” " 按钮必须再次禁用。即将"apple" 编辑为"apppleee" 以启用"save"，将"appleee" 反转回"apple" 以再次禁用"save" 按钮。* "
[如何启用/禁用保存按钮用户更改表单内容时的主干表单视图](https://stackoverflow.com/questions/16108176/how-to-enable-disable-save-button-of-backbone-form-view-when-user-changes-form-c/16108499#16108499)也应该为您提供该部分的解决方案。
基本上，您将模型的原始状态存储为`myView._model = myView.model.toJSON()`. 当你的模型改变时，`this.model.toJSON()``this._model``_.isEqual`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T15:28:47.077

我建议在您的模型中添加一些逻辑（函数），以检查对象值是否符合其默认值。然后，在您的`okButtonDisabled`方法中，调用模型方法来检查默认值。这是您提供的代码中的一个示例：

```
var app = {
    Model: Backbone.Model.extend({
        defaults: {
            words: "apple",
            type: "fruit"
        },

        isDefault: function(key) {
            return this.get(key) === this.defaults[key];
        }
    }),
    View: Backbone.View.extend({
        initialize: function() {
            this.setElement($('#main'));
        },
        bindings: {
            'input[name=words]': 'words',
            'input[name=type]': 'type',
            'input#okButton': {
              attributes: [{
                name: 'disabled',
                observe:['type','words'],
                onGet: 'okButtonDisabled'
              }],
            }
        },
        okButtonDisabled: function(words) {
            return (!this.model.isDefault("words") ||
                    !this.model.isDefault("type")) ? null : true;
        },
        addDisabledClass: function(words) {
            console.log("is this neccessary?");
            return (!this.model.isDefault("words") ||
                    !this.model.isDefault("type")) ? "" : "disabled";
        },
        render: function() {
            this.stickit();
        }
    })
};

var view = new app.View({model:new app.Model()});
view.render(); 
```

[修改后的 JSFiddle](http://jsfiddle.net/Mp6G9/202/)

如果您有很多字段，则可以更改`isDefault`方法以接受键数组。然后，循环遍历这些键，如果任何键与其默认值不匹配，则返回 false。就像是：

```
Model: Backbone.Model.extend({
    isDefault: function(keys) {
        for (var i = 0; i<keys.length; i++) {
            if (this.get(keys[i]) !== this.defaults[keys[i]]) {
                return false;
            }
        }
        return true;
    }
});

View: Backbone.View.extend({
    okButtonDisabled: function(words) {
        return !this.model.isDefault(["words", "type"]) ? null : true;
    }
}); 
```

### 编辑：

如果您可以假设模型中的所有属性都与表单输入相关联，那么您可以遍历每个属性并检查差异。像这样的东西：

```
Model: Backbone.Model.extend({
    isDefault: function(keys) {
        for (var key in this.attributes) {
            if (this.get(key) !== this.defaults[key]) {
                return false;
            }
        }
        return true;
    }
});

View: Backbone.View.extend({
    okButtonDisabled: function(words) {
        return !this.model.isDefault() ? null : true;
    }
}); 
```

[更新了抽象的 JSFiddle](http://jsfiddle.net/Mp6G9/203/)

# matlab - MATLAB 删除第二次/第三次出现重复索引的行

> ID：16194689
> 
> 赞同：0
> 
> 时间：2013-04-24T14:29:58.663
> 
> 标签：matlab, matrix, unique

我有一个有两列的大矩阵。首先是索引，其次是数据。一些索引是重复的。如何仅保留具有重复索引的行的第一个实例？

例如：

```
x = 
    1   5.5
    1   4.5
    2   4
    3   2.5
    3   3
    4   1.5 
```

最终得到：

```
ans = 
    1   5.5
    2   4
    3   2.5
    4   1.5 
```

我尝试了各种变化和迭代

```
[Uy, iy, yu] = unique(x(:,1));
[q, t] = meshgrid(1:size(x, 2), yu);
totals = accumarray([t(:), q(:)], x(:)); 
```

但到目前为止，没有什么能给我我需要的输出。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:34:16.070

在函数中使用`'first'`标签，`unique`然后第二个输出为您提供您想要的行索引，您可以使用它来“过滤”您的矩阵。

```
[~, ind] = unique(x(:,1), 'first');
ans = x(ind, :)

ans =

    1.0000    5.5000
    2.0000    4.0000
    3.0000    2.5000
    4.0000    1.5000 
```

**编辑**

或者正如乔纳斯指出的那样（尤其是旧的 Matlab 版本）

```
[~, ind] = unique(flipud(x(:,1)));
ans = x(flipud(ind), :) 
```

# java - JPA/Hibernate 4 - 获取 ScrollableResults

> ID：16194692
> 
> 赞同：0
> 
> 时间：2013-04-24T14:30:06.207
> 
> 标签：java, hibernate, jpa

我使用 Hibernate 4.2 作为我的 JPA 提供程序。我想使用 ScrollableResults 对象来处理我的结果集。

我的代码基本上是这样的：

```
javax.persistence.Query q = em.createQuery(...);
org.hibernate.Query query = ((org.hibernate.ejb.QueryImpl)q).getHibernateQuery();
query.setParameter(blah blah);
ScrollableResults sr = query.scroll(ScrollMode.FORWARD_ONLY); 
```

这总是抛出异常：

```
Caused by: java.lang.ClassCastException: java.util.ArrayList cannot be cast to java.lang.Integer
    at org.hibernate.type.descriptor.java.IntegerTypeDescriptor.unwrap(IntegerTypeDescriptor.java:36)
    at org.hibernate.type.descriptor.sql.IntegerTypeDescriptor$1.doBind(IntegerTypeDescriptor.java:57)
    at org.hibernate.type.descriptor.sql.BasicBinder.bind(BasicBinder.java:92)
    at org.hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:280)
    at org.hibernate.type.AbstractStandardBasicType.nullSafeSet(AbstractStandardBasicType.java:275)
    at org.hibernate.param.NamedParameterSpecification.bind(NamedParameterSpecification.java:66)
    at org.hibernate.loader.hql.QueryLoader.bindParameterValues(QueryLoader.java:608)
    at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1870)
    at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1831)
    at org.hibernate.loader.Loader.executeQueryStatement(Loader.java:1811)
    at org.hibernate.loader.Loader.doQuery(Loader.java:899)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:341)
    at org.hibernate.loader.Loader.doList(Loader.java:2516)
    at org.hibernate.loader.Loader.doList(Loader.java:2502)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2332)
    at org.hibernate.loader.Loader.list(Loader.java:2327)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:490)
    at org.hibernate.hql.internal.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:355)
    at org.hibernate.engine.query.spi.HQLQueryPlan.performList(HQLQueryPlan.java:195)
    at org.hibernate.internal.SessionImpl.list(SessionImpl.java:1268)
    at org.hibernate.internal.QueryImpl.list(QueryImpl.java:101)
    at com.example.server.ChartGenerator.getChart() 
```

作为一项实验，将 query.scroll() 替换为 query.list() 也会产生相同的异常。

QueryImpl 类型是原始类型，但我不知道该放什么，或者这是否就是问题所在。

我的查询返回一个日期，后跟几个整数；它不直接映射到一个类。我只想要一个对象数组——我有大量数据要处理，而映射到对象只会让我慢下来！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:10:15.897

多亏了 fmodos 的一个很好的提示，所以出现了异常，因为我正在调用：

```
org.hibernate.Query.setParameter("groupids", list); 
```

通过调用以下方法之一可以解决该问题：

```
org.hibernate.Query.setParameterList("groupids", list);
javax.persistence.Query.setParameter("groupids", list); 
```

# javascript - 在 jQuery 中执行此过程的最有效方法是什么？

> ID：16194696
> 
> 赞同：1
> 
> 时间：2013-04-24T14:30:10.493
> 
> 标签：javascript, jquery, performance, anonymous-function, jquery-events

这完美无缺，但不知何故，我认为有更简单快捷的方法可以做到这一点。我不确定，我正在寻找建议。这是代码：

```
 /* create a hover event and a click event */
// set the status of whether the box is open or closed
var status = 0;

// remove the css hover state (fall back hover)
$("#testApp").off("hover");

// add a jQuery mouseover and mouseout event
$("#testApp").on("mouseover", function() {
    $("#testApp div").css({
        "background-image":"url(./images/svg/menucorner-bg-lit.svg)"
    });
});

$("#testApp").on("mouseout", function() {
    $("#testApp div").css({
        "background-image":"url(./images/svg/menucorner-bg.svg)"
    });
});

// create a click event
$("#testApp").on("click", function() {
    if(status == 0) {
        // remove the mouseover and mouseout event when the div opens
        $("#testApp").off("mouseover");
        $("#testApp").off("mouseout");
        $("#testApp div").css({
            "background-image":"url(./images/svg/menucorner-bg-lit.svg)",
            "height":"200px",
            "background-color":"#ccc"
        });
        return status = 1;
    }else{
        // add the mouseover and mouseout event when the div closes
        $("#testApp").on("mouseover", function() {
            $("#testApp div").css({
                "background-image":"url(./images/svg/menucorner-bg-lit.svg)"
            });
        });

        $("#testApp").on("mouseout", function() {
            $("#testApp div").css({
                "background-image":"url(./images/svg/menucorner-bg.svg)"
            });
        });
        $("#testApp div").css({
            "height":"50px",
            "background-color":"transparent"
        });
        return status = 0;
    }
}); 
```

所以基本上它会创建一个悬停状态和一个点击切换。有没有更有效的方法来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:35:39.890

## 1 jQuery 对象来统治他们

由于您`$("#testApp");`在函数顶部使用，因此可以将其设置为变量

```
var testAppEl = $("#testApp") 
```

然后使用它而不是每次都创建一个新的 jQuery 对象

## 利用`hover`

你可以把这个块：

```
// add a jQuery mouseover and mouseout event
$("#testApp").on("mouseover", function() {  
$("#testApp").on("mouseout", function() { 
```

进入`.hover()`：

```
testAppEl.hover(function() {
    $(this).css({
        "background-image":"url(./images/svg/menucorner-bg-lit.svg)"
    });
}, function() {
    $("#testApp div").css({
        "background-image":"url(./images/svg/menucorner-bg.svg)"
    });
}); 
```

## 结合`off()`

这两个在这里可以混合

```
// Old
$("#testApp").off("mouseover");
$("#testApp").off("mouseout");

// New
testAppEl.off("mouseover mouseout"); 
```

## 以更好的方式使用 CSS

正如 Drew 建议的那样，在 CSS 文件中添加类而不是动态的，难以通过 jQuery 跟踪 CSS，即：

```
.someCSS {
    background-image: url(./images/svg/menucorner-bg-lit.svg);
    height: 200px;
    background-color:#ccc;
} 
```

然后在你的 jQuery 中使用

```
testAppEl.addClass("someCSS"); 
```

## 严格的类型/值比较

此外，对于您的第一个`if`块，您应该真正使用严格的比较运算符：

```
if (status === 0) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:43:05.753

我唯一可以建议的是声明不同的 css 类，而不是通过调用 $.css() 来更改 CSS 使用 toggleClass 或 addClass / removeClass

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:43:22.800

[您可以将.data()](http://api.jquery.com/data/)附加到元素以启用和禁用悬停事件，而不是添加和删除事件处理程序。

```
// add a jQuery mouseover and mouseout event
$("#testApp").on("mouseover", function() {
    if (!$(this).data("disabled")) {
        $("#testApp div").css({
            "background-image":"url(./images/svg/menucorner-bg-lit.svg)"
        });
    }
}).on("mouseout", function() {
    if (!$(this).data("disabled")) {
        $("#testApp div").css({
            "background-image":"url(./images/svg/menucorner-bg.svg)"
        });
    }
}).on("click", function() {
    if (!$(this).data("disabled")) {
        $("#testApp div").css({
            "background-image":"url(./images/svg/menucorner-bg-lit.svg)",
            "height":"200px",
            "background-color":"#ccc"
        });
        $(this).data("disabled", true);
    } else {
        $("#testApp div").css({
            "height":"50px",
            "background-color":"transparent"
        });
        $(this).data("disabled", false);
    }
}); 
```

正如其他人所说，使用[.addClass()](http://api.jquery.com/addClass/)和[.removeClass()](http://api.jquery.com/removeClass/)而不是[.css()](http://api.jquery.com/css/)将有助于将行为和外观保持为单独的关注点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:35:20.513

您可以将两个 mouseover mouseout 处理程序融合为一个：

```
$("#testApp").on("mouseover mouseout", function(e) {
    img = e.type == 'mouseover' ? 'menucorner-bg-lit.svg' : 'menucorner-bg.svg';
    $('div', this).css({
        "background-image":"url(./images/svg/"+img+")"
    });
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T14:36:45.897

最后链接和重构

```
function addHover(){
      // add the mouseover and mouseout event when the div closes
        $("#testApp").on("mouseover", function() {
            $("#testApp div").css({
                "background-image":"url(./images/svg/menucorner-bg-lit.svg)"
            });
        })
        .on("mouseout", function() {
            $("#testApp div").css({
                "background-image":"url(./images/svg/menucorner-bg.svg)"
            });
        });

}

/* create a hover event and a click event */
// set the status of whether the box is open or closed
var status = 0;

// remove the css hover state (fall back hover)
$("#testApp").off("hover")
// create a click event
.on("click", function() {
    if(status == 0) {
        // remove the mouseover and mouseout event when the div opens
        $("#testApp").off("mouseover");
        $("#testApp").off("mouseout");
        $("#testApp div").css({
            "background-image":"url(./images/svg/menucorner-bg-lit.svg)",
            "height":"200px",
            "background-color":"#ccc"
        });
        return status = 1;
    }else{
        addHover();
        $("#testApp div").css({
            "height":"50px",
            "background-color":"transparent"
        });
        return status = 0;
    }
}); 
```

# c# - 如果我访问该对象属性，类属性是否会自动初始化？

> ID：16194702
> 
> 赞同：1
> 
> 时间：2013-04-24T14:30:20.727
> 
> 标签：c#, class, properties

当一个对象将另一个对象作为属性并且该属性默认为 null 时。如果它自己的属性被代码访问，该属性会被初始化吗？

```
public User {
    private _obj = null;
    public Obj SomeObject {
        get { return _obj ?? (_obj = new Obj()); }
        set { _obj = value; }
    }

    public User() {
        //do stuff
    }
} 
```

正在使用的代码。

```
User user = new User();

int x = user.SomeObject.SomeIntValue; 
```

如果它为空，这会启动新版本的 SomeObject 吗？

-- 编辑 -- 将@Kjartan 建议应用于代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:34:08.890

这确实会奏效。第一次访问该属性时，_obj 将被新实例填充（因为它之前为 null）。下一次调用，您将返回第一次初始化的同一个 Obj 实例。

这是创建某种“延迟加载”的常用方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T14:44:33.867

应该管用。作为旁注，为简洁起见，您可以替换它：

```
 get {
      if(_obj == null)
           _obj = new Obj();
      return _obj;
 } 
```

...有了这个：

```
 get { return _obj ?? (_obj = new Obj()); } 
```

# asp.net - 用于匹配 2 个电子邮件地址的 ASP.NET 比较验证器

> ID：16194705
> 
> 赞同：0
> 
> 时间：2013-04-24T14:30:29.990
> 
> 标签：asp.net

我想使用比较验证器验证 2 个字段 1）电子邮件地址（必填字段 - 使用必填字段验证器）2）确认电子邮件地址

如果我在电子邮件地址中输入 abc@abc.com 并在确认电子邮件地址中输入 abc@abc.com，它将正常工作。但是，当我在其中一个文本框中的电子邮件地址后添加空格时，它会说两封电子邮件都不匹配，这是不可取的。如何解决这个问题？如果我能够通知用户电子邮件地址中不允许使用该空间，这将对用户有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:35:51.383

好吧，如果用户添加了空格，则电子邮件不匹配，因此错误消息是正确的。如果您想为允许的字符添加另一个验证，您可以`RegularExpressionValidator`在每个字段上使用 a。[这是此正则表达式](https://stackoverflow.com/a/1710535/848330)的示例：

```
<asp:RegularExpressionValidator 
     id="RegValid" 
     ControlToValidate="txtEmail" 
     ValidationExpression="\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*" 
     ErrorMessage="Invalid email address"
     runat="server" >
</asp: RegularExpressionValidator> 
```

* * *

看起来您需要更复杂的验证，因此您可以用自定义验证器替换所有内容并测试所有内容。标记：

```
<asp:CustomValidator runat="server" OnServerValidate="EmailValidate" Display="Dynamic" ControlToValidate="txtEmail2" ID="vldEmail"></asp:CustomValidator> 
```

后面的代码：

```
protected void EmailValidate(object source, ServerValidateEventArgs args)
{
    if(txtEmail1.Text != txtEmail2.Text) {
        args.IsValid = False
        vldEmail.ErrorMessage = "Emails are different"
    }else {
        //for each condition that fails set IsValid to false and choose the error message:
        args.IsValid = False
        vldEmail.ErrorMessage = "..."
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:55:25.330

```
regex = '^(?=.*[A-Za-z0-9])[\S]*$' 
```

[资源](http://www.sitepoint.com/forums/showthread.php?754687-regex-to-allow-anything-but-whitespace)

我自己试过了，效果很好:)

# ios - 下载已购买项目时出现 IOS In App Purchase 错误

> ID：16194706
> 
> 赞同：0
> 
> 时间：2013-04-24T14:30:32.220
> 
> 标签：ios, in-app-purchase

我正在开发一个带有 In App Purchase 消耗品的应用程序；99% 的时间它运行良好，但有时（对于连接或服务器问题）当我验证收据然后（从我的服务器）下载一些项目时，我会收到错误消息。

没关系，它可能会发生，但我怎样才能恢复下载？当用户再次尝试购买此商品时，Apple 会显示消息“您已购买此应用内购买但尚未下载”并且此商品不再有效。我将收据保存在本地，所以我可以用它来恢复我的下载（如果用户使用相同的设备）但是我如何告诉 Apple 交易已经完成（在这种情况下我可以使用 [[SKPaymentQueue defaultQueue] finishTransaction:transaction] ？ 如何？ ）？

在其他作品中，如何避免出现“你已经购买了……”的信息？有任何想法吗？

谢谢！

# ios - UITableView 删除按钮与内容重叠

> ID：16194707
> 
> 赞同：2
> 
> 时间：2013-04-24T14:30:32.777
> 
> 标签：ios, objective-c, xcode, ipad, xib

我正在准备一个`UITableView`自定义原型单元格，`UISwitch`右侧有一个小部件，我想让我的用户能够删除行。

一切都很好，除了当删除按钮出现时它与 重叠`UISwitch`，这样：

![删除与 UISwitch 重叠的按钮](https://i.stack.imgur.com/KKpOE.png)

`UISwitch`删除按钮出现时是否可以向左移动？

* * *

## 结语

为了简洁起见，我决定`UISwitch`在“删除”按钮出现时不移动我的位置，而是让它消失，当“删除”按钮消失时将其恢复。

所以，根据@geo的建议（谢谢），我用这种方式（很简单）解决了这个问题：

在我`UITableViewCell`的 ' 子类`.m`文件中：

```
- (void)willTransitionToState:(UITableViewCellStateMask)state
{
    [super willTransitionToState:state];
    if (state & UITableViewCellStateShowingDeleteConfirmationMask) {
        activationSwitch.hidden = YES;
    }
    else {
        activationSwitch.hidden = NO;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-26T03:20:04.190

我遇到了一个非常相似的问题并修复了它。您需要在 Interface Builder 的自定义表格视图单元格中为您的 UI 元素设置正确的自动调整大小掩码（假设此处不进行自动布局）。

在我的例子中，我需要为我的每个 UI 元素添加 Left 约束（请参阅 Size Inspector、View 部分中的小自动调整图片/动画）。

添加一个左“栏”，你应该很好。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-24T14:37:52.680

覆盖方法

```
-(void)willTransitionToState:(UITableViewCellStateMask)state 
```

->`UITableViewCellStateShowingDeleteConfirmationMask` 您的自定义单元格并在那里进行自定义:)

# c# - DirectoryEntry results in The server is unwilling to process the request

> ID：16194710
> 
> 赞同：0
> 
> 时间：2013-04-24T14:30:39.657
> 
> 标签：c#, .net, active-directory

I am writing a small app that integrates with AD and will be listing users and allowing members of the site to edit certain fields of the users. These fields will be, first name, last name, display name and email.

When I run the following code I get an exception that says

> The server is unwilling to process the request.

Please note that `result` is not `null` and contains the correct active directory user that I want to edit. Also note that `result` is of type `SearchResult`. Also note that the user I am using to connect to AD is the Administrative user.

```
DirectoryEntry entryToUpdate = result.GetDirectoryEntry();

entryToUpdate.Properties["cn"].Value = user.Name;
entryToUpdate.Properties["mail"].Value = user.Email;
entryToUpdate.Properties["sn"].Value = user.Surname;
entryToUpdate.Properties["displayName"].Value = user.DisplayName;

string username = user.Email.Substring(0, user.Email.IndexOf("@"));

entryToUpdate.Properties["sAMAccountName"].Value = username;

entryToUpdate.CommitChanges(); 
```

Any Ideas?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T17:50:37.393

I believe

```
entryToUpdate.Properties["cn"].Value = user.Name; 
```

is your Problem. Use givenName as first Name. "cn" is managed by the System.

Also:
If using Exchange, the Mail attribute is managed by it.

Consider the ramifications of modifing samAccountName. Users may not know how to log in, seperate Systems with pseudo SSO may not recognize them, the Login Name does not match the local Profile Name, etc.

# c# - 如何使用 REST 在 c# mvc4 中建立链接？

> ID：16194712
> 
> 赞同：0
> 
> 时间：2013-04-24T14:30:42.850
> 
> 标签：c#, asp.net-mvc, rest, asp.net-mvc-4

我是使用 REST 的新手。我发现的关于 MVC 4 和 REST 的文档每次都告诉我相同的内容。构建是 --> www.example.com/{controller}/{id} 这是 REST 的基本布局。我先解释一下我的情况：

一个公司有很多部门，一个部门有很多联系人。

webapp 以联系人的登录开始。用户登录后，此时我为该用户创建一个会话。当联系人开始浏览时，我的链接应该是 www.example.com/userid 吗？

当用户登录时，他可以为自己创建一个新会议。那么链接会是什么？我想 --> www.example.com/meeting --> 发帖

在 postmethod 之后，我去与我会面的控制器

```
[HttpPost]
public ActionResult Meeting(Meetingmodel model) 
```

在此操作中，我获取用户的会话并将他与会议绑定。这是正确的方法吗？如果没有任何好的链接/教程？

REST 何时允许使用参数？www.example.com/?category=something

如果看过[http://msdn.microsoft.com/en-us/library/dd203052.aspx](http://msdn.microsoft.com/en-us/library/dd203052.aspx)

但是没有任何关于创建对象作为登录的人。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:52:44.410

好的，我将开始简单地解释它，但你让我有点困惑。

首先，将用户 ID 存储在会话中是正确的方法吗？简短的回答，是的。您不应在 url 中包含您当前的用户 ID。

现在，假设您想要一个 url 来显示星期一到期的会议。网址如下：

www.{yoursite}.com/meeting/monday。要处理这个问题，在您的会议控制器中，只需添加以下操作方法：

公共 ActionResult 会议（字符串 dayOfWeek）

由于您有当前登录的用户 ID，因此在您的会话对象中，您可以轻松地请求您的数据库以当前用户 ID 和 dayOfWeek 查找会议。

这样，您的部分网址实际上就是您的操作方法参数。所以不需要 {url}/?{parameters} 语法。

这对你有帮助吗？

# c# - 写入 xml 文件但不是所有结果

> ID：16194713
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:30:43.457
> 
> 标签：c#, xml, visual-studio-2010

有人可以检查我的代码，看看我做错了什么我正在尝试向 XML 文件添加一个条目。它几乎可以工作了，当我添加条目名称年龄和电子邮件时，它们正在被填充，除非我检查文件而不是说 bill bill@zzz.com 28 它只显示账单账单。据我所见，一切看起来都很好，并且关闭得很好，但我想征求别人的意见。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Xml.Linq;
using System.IO;

public partial class compnew : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void Button1_Click(object sender, EventArgs e)
    {
        XDocument doc = XDocument.Load(Server.MapPath("~/comp.xml"));
        var comp = from itm in doc.Descendants("people") select itm;
        StreamWriter stream = new StreamWriter(Server.MapPath("~/comp.xml"));
        stream.WriteLine("<?xml version=\"1.0\" encoding=\"utf-8\" ?>");
        stream.WriteLine("<comp>");

        stream.WriteLine("<people>");
        stream.WriteLine("<name>" + txtName.Text + "</name>");
        stream.WriteLine("<email>" + txtName.Text + "</email>");
        stream.WriteLine("<age>" + txtName.Text + "</age>");
        stream.WriteLine("</people>");

        foreach (var item in comp){
            stream.WriteLine("<people>");
            stream.WriteLine("<name>" + item.Descendants("name").First().Value.ToString() + "</name>");
            stream.WriteLine("<email>" + item.Descendants("email").First().Value.ToString() + "</email>");
            stream.WriteLine("<age>" + item.Descendants("age").First().Value.ToString() + "</age>");
            stream.WriteLine("</people>");
        }

        stream.WriteLine("</comp>");
        stream.Close();

        txtName.Text = "";
        txtEmail.Text = "";
        txtAge.Text = "";
        DataList1.DataBind();
        Response.Write("Thank you");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:35:11.827

从您的代码：

```
stream.WriteLine("<name>" + txtName.Text + "</name>");
stream.WriteLine("<email>" + txtName.Text + "</email>");
stream.WriteLine("<age>" + txtName.Text + "</age>"); 
```

您正在编写“txtName.Text”作为所有这些的值，而不是 txtEmail.Text 或任何您的字段名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:37:14.387

您已`txtName.Text`被保存到`<name>`、`<email>`和`<age>`。

```
 stream.WriteLine("<name>" + txtName.Text + "</name>");
    stream.WriteLine("<email>" + txtName.Text + "</email>");
    stream.WriteLine("<age>" + txtName.Text + "</age>"); 
```

也许改用`txtEmail`and `txtAge`。

```
 stream.WriteLine("<name>" + txtName.Text + "</name>");
    stream.WriteLine("<email>" + txtEmail.Text + "</email>");
    stream.WriteLine("<age>" + txtAge.Text + "</age>"); 
```

# php - FOSUserBundle - 如何处理角色？

> ID：16194718
> 
> 赞同：1
> 
> 时间：2013-04-24T14:31:01.897
> 
> 标签：php, symfony, user-management

因此，我已经阅读了该捆绑包的[文档](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/index.md)，但没有任何内容描述如何列出现有角色或为特定用户分配/更改卷。我需要能够：

1.  为新注册的用户分配默认角色。
2.  让管理员和超级管理员提升和降级用户。
    *   这要求我能够*看到*我可以选择哪些角色。

那么，这是如何做到的呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:39:58.767

你可以这样做：

```
$roleHierarchy = $container->getParameter('security.role_hierarchy.roles');
$roles = array_keys($roleHierarchy);
$form = $this->createForm(new UserFormType($roles, $user->getRoles()), $user); 
```

在您的 UserFormType 中，您可以像这样添加角色字段：

```
protected $roles;
protected $userRoles;

public function __construct($roles, $userRoles)
{

    foreach ($roles as $role) {
        $theRoles[$role] = $role;
    }
    $this->roles = $theRoles;
    $this->userRoles = $userRoles;

}

public function buildForm(FormBuilderInterface $builder, array $options)
{               

    $builder->add('roles', 'choice', array(
                    'choices' => $this->roles,
                    'data' => $this->userRoles,
                    'expanded' => true,
                    'multiple' => true,
                ));

} 
```

# xaml - 具有多个 ContentPresenter 的自定义控件

> ID：16194720
> 
> 赞同：0
> 
> 时间：2013-04-24T14:31:04.680
> 
> 标签：xaml, windows-8, winrt-xaml, expression-blend, custom-component

我正在尝试实现一个自定义控件，它将根据 3 种不同的控件状态显示不同的内容。我通过向我的控件添加一个状态和 3 个不同的内容属性来实现这一点。

我现在所拥有的就是这样。

1.  用户将`CurrentState`属性设置为`"Default"`、`"CurrentStep"`或之一`"Completed"`。
2.  控制通过 切换到不同的视觉状态`VisualStateManager`。
3.  控制 3 个不同的默认模板集`Visibility`属性`ContentPresenters`以显示单个内容。

这一切都没有问题。我正在努力做的是启用设计时支持。我唯一能做的就是将属性设置`ContentProperty`为内容属性之一，以便 Blend 在其控制树中将此属性显示为子属性。但是，这仅允许在设计时编辑一个内容属性。

我还能做些什么来为我的控件添加设计时支持？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:04:50.807

我不会创建具有多个 contentPresenter 的自定义控件。

为了实现您想要做的事情，大多数时候，您创建一个带有命名部分的控件（默认的 winrt 控件模板使用这种“命名部分”机制）。当您的自定义控件状态发生变化时，您只需显示/隐藏一个或多个命名部分。

通过这种方式，您可以提供一个默认控件模板，其中包含您需要的所有命名部件，并且要自定义控件，您可以覆盖默认模板并定义您自己的部件。取决于状态的显示/隐藏逻辑将保持不变，但目标控制选择取决于编写模板的人。

# r - 根据 GPS 数据计算距离

> ID：16194721
> 
> 赞同：1
> 
> 时间：2013-04-24T14:31:14.427
> 
> 标签：r

我确实有带有 gps 数据的数据框，我需要计算两行之间的距离（当前和上一个）

```
 id                 time       lat      long heartrate altitude
1  20130424.tcx 2013-04-24T04:53:22Z 50.024818 14.522724       151     <NA>
2  20130424.tcx 2013-04-24T04:53:26Z 50.024818 14.522724        96     <NA>
3  20130424.tcx 2013-04-24T04:53:30Z 50.024818 14.522724       104     <NA>
4  20130424.tcx 2013-04-24T04:53:34Z 50.024818 14.522724       107     <NA>
5  20130424.tcx 2013-04-24T04:53:38Z 50.024818 14.522724       108     <NA>
6  20130424.tcx 2013-04-24T04:53:42Z 50.024818 14.522724       112    372.0
7  20130424.tcx 2013-04-24T04:53:46Z 50.024818 14.522724       151    372.0
8  20130424.tcx 2013-04-24T04:53:47Z 50.024677 14.522874       151    356.0
9  20130424.tcx 2013-04-24T04:53:50Z 50.024677 14.522874       118    356.0
10 20130424.tcx 2013-04-24T04:53:54Z 50.024677 14.522874       118    356.0
11 20130424.tcx 2013-04-24T04:53:58Z 50.024464 14.522917       147    358.0
12 20130424.tcx 2013-04-24T04:54:02Z 50.024464 14.522917       144    358.0
13 20130424.tcx 2013-04-24T04:54:06Z 50.024269 14.522853       150    367.0
14 20130424.tcx 2013-04-24T04:54:10Z 50.024269 14.522853       152    367.0
15 20130424.tcx 2013-04-24T04:54:13Z 50.024002 14.522874       152    380.0 
```

我能够将数据连接到自身并获取每一行的前一行（可能有更简单的解决方案）：

```
library(sqldf)
mydft    = mydf[-nrow(mydf),] 
mydft$id  = seq_along(mydft$id) +1
mydf$id  = seq_along(mydf$id)
mydft2 <- sqldf("select a.*, b.lat as lat2, b.long as long2 from mydf a left join mydft b using (id)") 
```

我现在如何计算与列的距离`lat, long, lat2, long2`？我尝试过[这里](http://www.r-bloggers.com/great-circle-distance-calculations-in-r/)描述的方法：

```
R <- 6371 # Earth mean radius [km]
mydft2$delta.long <- (mydft2$long2 - mydft2$long)
mydft2$delta.lat <- (mydft2$lat2 - mydft2$lat)
mydft2$a <- sin(mydft2$delta.lat/2)^2 + cos(mydft2$lat) * cos(mydft2$lat2) * sin(mydft2$delta.long/2)^2
mydft2$c <- 2 * asin(min(1,sqrt(mydft2$a)))
mydft2$d = R * c 
```

但这仅返回列表 NA。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-24T15:13:52.313

一种简单地实现这一目标的方法是使用`R`设施进行空间分析。对于这个例子，我们可以使用`spDistN1`优秀`sp`包中的函数。

第一步是将您的数据转换为 SpatialPoints（或 SpatialPointsDataFrame），我在此示例中假设您的点位于地理投影中（带 WSG84 基准的 longlat）

```
txt <- "            id                 time       lat      long heartrate altitude
20130424.tcx 2013-04-24T04:53:22Z 50.024818 14.522724       151     <NA>
20130424.tcx 2013-04-24T04:53:26Z 50.024818 14.522724        96     <NA>
20130424.tcx 2013-04-24T04:53:30Z 50.024818 14.522724       104     <NA>
20130424.tcx 2013-04-24T04:53:34Z 50.024818 14.522724       107     <NA>
20130424.tcx 2013-04-24T04:53:38Z 50.024818 14.522724       108     <NA>
20130424.tcx 2013-04-24T04:53:42Z 50.024818 14.522724       112    372.0
20130424.tcx 2013-04-24T04:53:46Z 50.024818 14.522724       151    372.0
20130424.tcx 2013-04-24T04:53:47Z 50.024677 14.522874       151    356.0
20130424.tcx 2013-04-24T04:53:50Z 50.024677 14.522874       118    356.0
20130424.tcx 2013-04-24T04:53:54Z 50.024677 14.522874       118    356.0
20130424.tcx 2013-04-24T04:53:58Z 50.024464 14.522917       147    358.0
20130424.tcx 2013-04-24T04:54:02Z 50.024464 14.522917       144    358.0
20130424.tcx 2013-04-24T04:54:06Z 50.024269 14.522853       150    367.0
20130424.tcx 2013-04-24T04:54:10Z 50.024269 14.522853       152    367.0
20130424.tcx 2013-04-24T04:54:13Z 50.024002 14.522874       152    380.0"

gpsdat <- read.table(text = txt, header = TRUE, na.strings = "<NA>")
str(gpsdat)

require(sp)
coordinates(gpsdat) <- ~ long + lat
proj4string(gpsdat) <- CRS("+proj=longlat +datum=WGS84") 
```

在第二步中，我们现在可以使用该`spDistN1`功能

```
sapply(seq_along(gpsdat[-1, ]), function(i)
       spDistsN1(pts = gpsdat[i, ], pt = gpsdat[i+1, ], longlat = TRUE))

 [1] 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000
 [7] 0.019004 0.000000 0.000000 0.023875 0.000000 0.022155
[13] 0.000000 0.029716 
```

根据我们使用的 GPS 数据类型，您可以`R`使用`readOGR`函数（包`rgdal`）直接读取这些类型的数据

# php - drupal 7图像字段不检查图像类型

> ID：16194723
> 
> 赞同：0
> 
> 时间：2013-04-24T14:31:16.640
> 
> 标签：php, drupal-7, drupal-6, drupal-modules, image-uploading

如果您将**(file.php)**重命名为**(file.jpg)**并且您想上传它

drupal 6 image_field 模块可以检测到它并拒绝上传此文件，但 drupal 7 中的 image_field 无法检测到它。

你能帮我在drupal 7中找到另一个可以检测的模块吗（REAL文件类型）。

谢谢你

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:01:06.097

你是对的，Drupal 7 没有 mime 类型验证

有人在此链接中对其进行了修补：http: [//drupal.org/node/959800](http://drupal.org/node/959800)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-08T07:08:38.153

一家网站安全审计公司为我的一个 Drupal 项目提出了同样的问题。我的场景，如果我将 .exe 文件更改为 .jpg 然后尝试通过表单上传，它是为我上传的。

我在 web 和 drupal 社区上进行了搜索，但没有得到任何合适的答案。最后，我在核心“include/file.inc”文件中进行了编辑，并定义了支持的 mime 类型为“'image/jpg'、'image/jpeg'、'image/png'、'image/gif'”。

但不建议更改 Drupal 核心文件。这是完整的代码：

“include/file.inc”文件中函数 file_validate_mime_type 的变化

```
 $errors = array();
 $allowedmimetype = explode('::', $mime_types);
 $finfo = new finfo(FILEINFO_MIME_TYPE);
 $tmpmime =$finfo->file($file->uri);
 if (!in_array($tmpmime, $allowedmimetype) )
 {
    $errors[] = t('Not allowed this mime type '.$tmpmime.'! Only files with the  following mime type are allowed: %files-allowed.', array('%files-allowed' => $mime_types));
 }
 return $errors;
} 
```

在文件“modules/image/image_field.inc”中添加了以下 2 行

```
 $elements[$delta]['#upload_validators']['file_validate_mime_type'][0] = implode('::', $supported_mime); 
```

在以下行之前

`$elements[$delta]['#process'][] = 'image_field_widget_process';`

网络安全审计团队通过了此代码。可能在未来我们会得到一些更好的答案。

# sql - 当sql server中的数据缓存清除时，逻辑读取给出3？

> ID：16194725
> 
> 赞同：1
> 
> 时间：2013-04-24T14:31:23.920
> 
> 标签：sql, sql-server, performance, sql-server-2008

```
dbcc FREEPROCCACHE
dbcc DROPCLEANBUFFERS

set STATISTICS IO ON--Case 1
SELECT * from Production.Suppliers s

--(30 row(s) affected)
--Table 'Suppliers'. Scan count 1, logical reads 3, physical reads 1, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0.

--again without clearing the cache I ran above

set STATISTICS IO ON
SELECT * from Production.Suppliers s

--(30 row(s) affected)
--Table 'Suppliers'. Scan count 1, logical reads 3, physical reads 0, read-ahead reads 0, lob logical reads 0, lob physical reads 0, lob read-ahead reads 0. 
```

我不明白当我在案例 1 中清除缓存时它如何显示逻辑读取 3，我读取的是逻辑读取意味着否。从数据缓存中读取的页面，但我在执行 sql 语句之前在 CASE 1 中清除它仍然给我逻辑读取 3 当数据缓存被清除时

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:39:20.750

注意“物理读取”的区别

简单地，

*   物理读取 = 数据进入缓存
*   逻辑读取 = 访问缓存中的数据

清除缓存会强制进行物理读取，因此您可以进行逻辑读取。您不能有零逻辑读取（对于学究，[除非逻辑读取意味着行但此处*超出范围*](https://stackoverflow.com/a/5194902/27535)）

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T14:39:31.817

逻辑读取并不意味着页面在查询开始之前就在缓存中。SQL Server 必须访问的每个页面都被计为一次逻辑读取。如果页面必须被访问两次，则计算两次逻辑读取。每次必须访问页面时，SQL Server 都必须执行代码以防止在读取该页面时更改该页面（它为此使用了闩锁）。因此，逻辑读取是一项相当昂贵的操作。因此，逻辑读取的数量可以很好地指示查询的成本。

# ruby - DataMapper 无法将字符串转换为整数枚举

> ID：16194726
> 
> 赞同：2
> 
> 时间：2013-04-24T14:31:24.287
> 
> 标签：ruby, datamapper, padrino

我有以下型号

```
class TagType
  include DataMapper::Resource

  ## Relationships
  belongs_to :category
  has n, :tags

  ## Properties
  property :uuid, UUID, :key => true, :default => lambda { |r,p| SecureRandom.uuid }
  property :name, Enum[:venue, :format, :genre, :organization]
end 
```

在我的应用程序控制器中，我收到一个名称参数作为字符串，将其转换为符号，并尝试执行查找：

```
get ':cat_name/:tag_type' do
cat = Category.first :name => params[:cat_name]
halt 400, "Invalid category" if cat.nil?
sym = params[:tag_type].to_sym
puts "Sym: #{ sym.inspect }"
raise "Not symbol!" if sym.class != Symbol
tag_type = TagType.first(:category => cat, :name => sym)
halt 400, "Invalid tag type name" if tag_type.nil? 
```

这是给我

> 4) 错误：test_0001_should_get_all_the_tags_for_a_category(TagController): TypeError: can't convert String into Integer test/app/controllers/tag_controller_test.rb:10:in `[]' test/app/controllers/tag_controller_test.rb:10:in`block (2 levels) in '

的输出`puts "Sym: #{ sym.inspect }"` 是 `Sym: :venue` 我尝试只用一个文字`:genre`代替 sym 以确保它可以正常工作，并且确实如此。如果它不是符号，我会尝试引发异常，但这不会触发，并且每次都会抛出这个错误，尽管它显然是一个符号。

这是使用 DataMapper 扩展`dm-types`，更具体地说是[Enum 类](https://github.com/datamapper/dm-types/blob/master/lib/dm-types/enum.rb)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:56:07.320

如果您查看我的异常，您会发现我错过了一个重要的细节：

> ) 错误：test_0001_should_get_all_the_tags_for_a_category(TagController): TypeError: can't convert String into Integer test/app/controllers/tag_controller_test.rb:10:in []' **test** /app/controllers/tag_controller_test.rb:10:inblock (2 levels)在

这是我测试的第 10 行，恰好与应用程序控制器本身的行匹配！DataMapper 工作正常。我的错。

# javascript - 寻求统计 javascript 函数以从 z 分数返回 p 值

> ID：16194730
> 
> 赞同：11
> 
> 时间：2013-04-24T14:31:42.430
> 
> 标签：javascript, jstat

我需要将 z 分数转换为百分位数。我[在 jStat 库](http://jstat.github.io/test.html#jStat.ztest)中找到了一个我可以使用的函数的引用（jstat.ztest），但是 jStat 文档似乎领先于可用的库，因为在[当前可用的库版本中](http://www.jstat.org/jstat-1.0.0.js)没有这样的函数。

我认为[GitHub 上有该库的更新版本](https://github.com/jstat/jstat)，其中可能包含 ztest 函数，但我是 linux 新手，无法弄清楚如何根据说明构建库。我花了一天的大部分时间学习 git bash 和 cygwin 尝试构建库；我终于决定我最好在这里问。

那么，任何人都可以将我指向一个可以满足我需要的javascript函数吗？或者，任何人都可以将我指向包含 ztest 函数的 jStat 库的构建版本吗？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-24T16:31:25.497

我在网上的一个论坛上发现了这个，它就像一个魅力。

```
function GetZPercent(z) 
  {
    //z == number of standard deviations from the mean

    //if z is greater than 6.5 standard deviations from the mean
    //the number of significant digits will be outside of a reasonable 
    //range
    if ( z < -6.5)
      return 0.0;
    if( z > 6.5) 
      return 1.0;

    var factK = 1;
    var sum = 0;
    var term = 1;
    var k = 0;
    var loopStop = Math.exp(-23);
    while(Math.abs(term) > loopStop) 
    {
      term = .3989422804 * Math.pow(-1,k) * Math.pow(z,k) / (2 * k + 1) / Math.pow(2,k) * Math.pow(z,k+1) / factK;
      sum += term;
      k++;
      factK *= k;

    }
    sum += 0.5;

    return sum;
  } 
```

而且我不需要只为一个功能包含一个大型库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-25T10:08:40.987

只需编辑 Paul 答案中的代码即可进行双边 t 检验

```
function GetZPercent(z) 
{
//z == number of standard deviations from the mean

//if z is greater than 6.5 standard deviations from the mean
//the number of significant digits will be outside of a reasonable 
//range
if ( z < -6.5)
  return 0.0;
if( z > 6.5) 
  return 1.0;

if (z > 0) { z = -z;}

var factK = 1;
var sum = 0;
var term = 1;
var k = 0;
var loopStop = Math.exp(-23);
while(Math.abs(term) > loopStop) 
{
  term = .3989422804 * Math.pow(-1,k) * Math.pow(z,k) / (2 * k + 1) / Math.pow(2,k) * Math.pow(z,k+1) / factK;
  sum += term;
  k++;
  factK *= k;

}
sum += 0.5;

return (2*sum);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-17T08:45:27.040

正如 Shane 已经正确指出的那样，该方程是正常 cdf 的泰勒展开的实现。该`sum`值在“真实”值的上下迭代，精度越来越高。如果该值接近 1 或 0，则存在一个非常低但存在的概率，即`sum`>1 或 <0，因为（相对）较早的突破`loopstop`。`1/Math.sqrt(2*Math.Pi)`通过舍入`0.3989422804`和javascript浮点数的精度问题进一步加强了偏差。此外，提供的解决方案不适用于 z 分数 >7 或 <-7

[我使用decimal.js](https://www.npmjs.com/package/decimal.js) npm 库更新了代码以更准确，并直接返回 p 值：

```
function GetpValueFromZ(_z, type = "twosided") 
{
    if(_z < -14)
    {
        _z = -14
    }
    else if(_z > 14)
    {
        _z = 14
    }
    Decimal.set({precision: 100});

    let z = new Decimal(_z);
    var sum = new Decimal(0);

    var term = new Decimal(1);
    var k = new Decimal(0);

    var loopstop = new Decimal("10E-50");
    var minusone = new Decimal(-1);
    var two = new Decimal(2);

    let pi = new Decimal("3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117067982148086513282306647")

    while(term.abs().greaterThan(loopstop)) 
    {
        term = new Decimal(1)

        for (let i = 1; i <= k; i++) {
            term = term.times(z).times(z.dividedBy(two.times(i)))
        }

        term = term.times(minusone.toPower(k)).dividedBy(k.times(2).plus(1))        
        sum = sum.plus(term);
        k = k.plus(1);
    }

    sum = sum.times(z).dividedBy(two.times(pi).sqrt()).plus(0.5);

    if(sum.lessThan(0))
        sum = sum.abs();
    else if(sum.greaterThan(1))
        sum = two.minus(sum);

    switch (type) {
        case "left":
            return parseFloat(sum.toExponential(40));
        case "right":
            return parseFloat((new Decimal(1).minus(sum)).toExponential(40));
        case "twosided":
            return sum.lessThan(0.5)? parseFloat(sum.times(two).toExponential(40)) : parseFloat((new Decimal(1).minus(sum).times(two)).toExponential(40))

    }

} 
```

通过增加 Decimal.js`precision`值并减少该`loopstop`值，您可以获得非常小（或非常高）z 分数的准确 p 值，以计算时间成本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-10T19:04:29.703

This seems like such a simple ask but I had a hard time tracking down a library that does this instead of copying some random code snippet. Best I can tell this will calculate z-score from a percentage using the simple-statistics library.

I took their documentation about cumulativestdnormalprobability and backed into the following algorithm. Feels like there should be an easier way but who knows.

[https://simplestatistics.org/docs/#cumulativestdnormalprobability](https://simplestatistics.org/docs/#cumulativestdnormalprobability)

```
const z_score = inverseErrorFunction((percentile_value - 0.5) / 0.5) * Math.sqrt(2); 
```

# php - Laravel 动态重路由

> ID：16194735
> 
> 赞同：0
> 
> 时间：2013-04-24T14:31:46.960
> 
> 标签：php, laravel

嘿伙计们，我有一个小问题需要解决，但我似乎找不到解决方法。
我有一个应用程序需要根据哪个用户使用它来动态使用不同的数据库。我以为我会给每个用户一个包含唯一字母数字 ID 的 URL。所以 URL 类似于 ww.mydomain.com/app/1kh1h3as/

所以我有两个问题：

1.  我应该把数据库切换代码放在哪里。是在配置文件中更好还是我应该在模型类中使用它，所以我可以使用 URI 类来解析 id？

2.  我怎样才能让路由器明白它需要将所有呼叫抵消一个段，这样它就不会去寻找 1kh1h3as 控制器和 ww.mydomain.com/app/1kh1h3as/users/all 将在用户控制器中启动 all() 方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:25:16.537

1.  用这个

    DB::connection('mysql')->config['database']='your_user_database_name';

2.  尝试

    Route::any('app/1kh1h3as/(:bundle)', function() { return 'Welcome to the Admin bundle!'; });

# css - 将背景大小应用于多个背景的单个图层

> ID：16194737
> 
> 赞同：1
> 
> 时间：2013-04-24T14:31:47.630
> 
> 标签：css, background-image

刚发现多重背景。我想知道如何将确定的属性仅应用于多个背景列表中的这些背景之一。您如何**单独针对它**？

下面是一个例子来说明：

```
body{
    background:
        url(images/small-group-bubbles.png) repeat-x fixed 10% 0,
        url(images/blur-bubble.png) repeat-x fixed -130% 0,
        url(images/big-bubble.png) repeat-x fixed 40% 0,
        url(images/green-gra-bg.jpg) no-repeat center center fixed;
    -webkit-background-size: cover;
    -moz-background-size: cover;
    -o-background-size: cover;
    background-size: cover;
    background-color: #87d677; 
```

如您所见，有一个多个背景的列表，但我想让这些元素之一以背景大小覆盖整个屏幕。此代码当然会将封面属性应用于所有图像。我希望此封面属性仅应用于最后一张图片：green-gra-bg/jpg。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:50:48.603

我相信您可以为每个背景 url 指定大小内联：

![在此处输入图像描述](https://i.stack.imgur.com/C7kuJ.png)

这是链接：[http ://www.css3.info/preview/multiple-backgrounds/](http://www.css3.info/preview/multiple-backgrounds/)

例如，在您的最后一个网址上使用下面的 /cover

```
body{
    background:
        url(images/small-group-bubbles.png) repeat-x fixed 10% 0,
        url(images/blur-bubble.png) repeat-x fixed -130% 0,
        url(images/big-bubble.png) repeat-x fixed 40% 0,
        url(images/green-gra-bg.jpg) no-repeat center/cover fixed;
    background-color: #87d677;
} 
```

对于我自己的个人示例，我测试了一个我发现的示例：http:
[//www.netmagazine.com/tutorials/get-grips-css3-multiple-background-images](http://www.netmagazine.com/tutorials/get-grips-css3-multiple-background-images)

```
body {
    background: 
        url(imgs/cloud.png) top center/800px no-repeat, 
        url(imgs/clouds-scatter.png) -46% -330px/500px repeat-x, 
        url(imgs/hills.png) bottom center repeat-x, 
        url(imgs/peaks.png) bottom right repeat-x;
} 
```

我添加的 800px 和 500px 尺寸似乎会影响彼此独立的每一层。

# excel - 如何匹配单独工作表上的数据，然后将相邻数据返回到匹配的单元格？

> ID：16194740
> 
> 赞同：0
> 
> 时间：2013-04-24T14:31:52.533
> 
> 标签：excel, excel-formula, vlookup, worksheet-function

我在“sheet1”中的 A1 中有数据。

我在“sheet2”上的 A1 和 C1 中有数据。

结果和公式将在“sheet1”的单元格 B1 中。

我需要'sheet1'上单元格B1中的公式将A1（sheet1）与sheet2上的A1匹配（这很容易！我可以使用查找和引用选项卡来做到这一点）但我希望返回值匹配在 sheet2 上向上 A1，但从 sheet2 上的 C1 返回值。

我不能这样做，请帮忙？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-26T23:01:55.937

也许`=VLOOKUP(A1,Sheet2!A:C,3,FALSE)`

# c# - Moon APNs SocketException

> ID：16194749
> 
> 赞同：0
> 
> 时间：2013-04-24T14:32:16.653
> 
> 标签：c#, apple-push-notifications, socketexception, moonapns

我已经尝试了几天来解决这个问题。搜索了与 MoonAPNs 相关的所有内容，但我的具体错误没有人遇到过。

正如 Title 所说，我正在使用 Moon APN 向 iOS 设备发送推送通知。我已经按照博客中的分步说明进行操作，安装了证书（.cer 和 .p12）等。一切看起来都很简单，但是....

但一直以来，在等待连接到 APN 的 2-3 分钟后

```
(Line in PushNotification.cs at line: 
  _apnsClient.Connect(host, port);), 
```

我收到一个 SocketException。

这是什么意思。是否与端口 2195 有关（已经与管理员检查过，它没有被阻止）。可以是有证书的东西吗？？？？

还有一点。我使用的证书是：“Apple Production IOS Push Services”并且我只在我的设备上安装的 .ipa 文件上进行测试（我已经阅读了在 .ipa 上进行测试的证书，它应该使用 Production Cer）。我自己没有创建这个证书，因为我还没有开发应用程序，我只需要在我的算法认为有必要时向这个应用程序发送推送通知。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T07:18:58.347

我找到了 SocketEception 的原因。这是服务器防火墙限制。打开此端口很重要：

■TCP 端口 5223（设备用于与 APNs 服务器通信）

■TCP 端口 2195（用于向 APNs 发送通知）

■TCP 2196端口（APNs反馈服务使用）

■TCP 端口 443（仅在 Wi-fi 上用作备用，当设备无法与端口 5223 上的 APN 通信时）

打开所有端口后一切正常。我希望有人可以使用此信息！

# udp - 连接 Arduino Ethernet Shield 和读取数据问题 PROCESSING

> ID：16194753
> 
> 赞同：0
> 
> 时间：2013-04-24T14:32:24.200
> 
> 标签：udp, arduino, processing, ethernet

我是这个论坛的新手，也是 Processing 的新手。我有一个具体的问题要问，非常感谢您的时间和想法！

如何将我的 Arduino 与 Ethernet Shield 连接，从传感器获取温度值，以便处理脚本可以看到它们？在直接的 Arduino 脚本中，获取值，从以太网屏蔽连接到服务器并做自己喜欢的事情。我已经做到了。

就我而言，我希望 Arduino 只运行从传感器读取模拟输入值的脚本。可能吗？

我已经使串行连接工作并通过 USB 读取值，但是使用以太网屏蔽？如何在**没有 USB/串行连接的情况下获得 arduino 读取的值？**

附言。我正在使用 WAMP 服务器等，Windows 7

我正在为 arduino 和[http://arduino.cc/en/Tutorial/UDPSendReceiveString](http://arduino.cc/en/Tutorial/UDPSendReceiveString)的处理尝试 UDP 连接脚本示例，但是

1）我不确定这是否是我需要的，

2）我已从防火墙端口 6000、8888 中排除我的测试，并将我的 Arduino 的 IP 地址放在 Arduino 脚本中，并将“localhost”放在处理脚本中

为了更好地使用这里复制的代码

```
/*
  UDPSendReceive.pde:
 This sketch receives UDP message strings, prints them to the serial port
 and sends an "acknowledge" string back to the sender

 A Processing sketch is included at the end of file that can be used to send
 and received messages for testing with a computer.

 created 21 Aug 2010
 by Michael Margolis

 This code is in the public domain.
 */

#include <SPI.h>         // needed for Arduino versions later than 0018
#include <Ethernet.h>
#include <EthernetUdp.h>         // UDP library from: bjoern@cs.stanford.edu 12/30/2008

// Enter a MAC address and IP address for your controller below.
// The IP address will be dependent on your local network:
byte mac[] = {  
  0xDE, 0xAD, 0xBE, 0xEF, 0xFE, 0xED };
IPAddress ip(192, 168, 1, 177);

unsigned int localPort = 8888;      // local port to listen on

// buffers for receiving and sending data
char packetBuffer[UDP_TX_PACKET_MAX_SIZE]; //buffer to hold incoming packet,
char  ReplyBuffer[] = "acknowledged";       // a string to send back

// An EthernetUDP instance to let us send and receive packets over UDP
EthernetUDP Udp;

void setup() {
  // start the Ethernet and UDP:
  Ethernet.begin(mac,ip);
  Udp.begin(localPort);

  Serial.begin(9600);
}

void loop() {
  // if there's data available, read a packet
  int packetSize = Udp.parsePacket();
  if(packetSize)
  {
    Serial.print("Received packet of size ");
    Serial.println(packetSize);
    Serial.print("From ");
    IPAddress remote = Udp.remoteIP();
    for (int i =0; i < 4; i++)
    {
      Serial.print(remote[i], DEC);
      if (i < 3)
      {
        Serial.print(".");
      }
    }
    Serial.print(", port ");
    Serial.println(Udp.remotePort());

    // read the packet into packetBufffer
    Udp.read(packetBuffer,UDP_TX_PACKET_MAX_SIZE);
    Serial.println("Contents:");
    Serial.println(packetBuffer);

    // send a reply, to the IP address and port that sent us the packet we received
    Udp.beginPacket(Udp.remoteIP(), Udp.remotePort());
    Udp.write(ReplyBuffer);
    Udp.endPacket();
  }
  delay(10);
}

/*
  Processing sketch to run with this example
 =====================================================

 // Processing UDP example to send and receive string data from Arduino
 // press any key to send the "Hello Arduino" message
 */

 import hypermedia.net.*;

 UDP udp;  // define the UDP object

 void setup() {
 udp = new UDP( this, 6000 );  // create a new datagram connection on port 6000
 //udp.log( true );         // <-- printout the connection activity
 udp.listen( true );           // and wait for incoming message  
 }

 void draw()
 {
 }

 void keyPressed() {
 String ip       = "192.168.1.177"; // the remote IP address
 int port        = 8888;        // the destination port

 udp.send("Hello World", ip, port );   // the message to send

 }

 void receive( byte[] data ) {          // <-- default handler
 //void receive( byte[] data, String ip, int port ) {   // <-- extended handler

 for(int i=0; i < data.length; i++)
 print(char(data[i]));  
 println();  
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-24T13:54:22.483

将这些值读入文件并使用该文件将数据发送到处理。[http://py.processing.org/reference/createReader.html](http://py.processing.org/reference/createReader.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-06T16:27:44.897

很棒的计划。只有一个问题。它在我的系统上完美运行。我用你的 Arduino 草图加载了我的 Arudino Uno R3 并加载了处理草图。像魅力一样工作，第一次尝试。没有改变我的 Arduino、Windows 系统、Processing (2.0.3)、网络等上的任何东西。

可能是您有 Arduino 板问题（不太可能）或以太网屏蔽问题（可悲的是，更有可能）。您可能遇到网络问题（更有可能）。

试试 Wireshark。在您查看 Wireshark 输出之前，您实际上只是在猜测。请注意，Wireshark 具有过滤器。你会需要它们。过滤掉所有非 UDP 流量。

# postgresql - Rails 3 - ActiveRecord::StatementInvalid

> ID：16194754
> 
> 赞同：0
> 
> 时间：2013-04-24T14:32:24.833
> 
> 标签：postgresql, activerecord, ruby-on-rails-3.1

我将 Rails 2.2.2 站点迁移到 Rails 3.1。架构是相同的，但现在当模型在部分 INSERT 上调用 save() 时出现 ActiveRecord 错误。

这导致了一个约束问题，这实际上不是因为该列在 PostGres 中自动递增，因此它永远不会为 NULL。

Rails 是所有约定，我认为它假定 'id' 列是主键。

处理这个问题的最佳方法是什么？

**1）**从架构列定义中删除“NOT NULL”

**2)**从 Rails 3 内部以某种方式告诉 ActiveRecord.save() 忽略这个约束，因为它是一个自动增量字段？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T17:53:35.307

在您的模型中执行以下操作：

```
self.primary_key = "your PK column name" 
```

# sql - 如何通过sql查询解决复杂的组？

> ID：16194756
> 
> 赞同：1
> 
> 时间：2013-04-24T14:32:28.377
> 
> 标签：sql, postgresql

我有一张像这样的桌子：

```
vending_machine_id | timestamp  | manual |
              543  | 2011-06-08 | true |
              543  | 2011-05-05 | false|
              543  | 2010-12-12 | true |
              542  | 2013-01-29 | true |
              542  | 2012-01-29 | true | 
```

我想要的只是选择每个 vending_machine_id 的最新日期，并带有第三个字段 ( `manual`) 来拥有`true/false`（如果该 vending_machine_id 同时存在`true`和`false`realdings，`true`（如果只有真正的手动读数），或`false`.

我做了这么多：

```
SELECT vmrp.vending_machine_id, max(timestamp), readingMethodSelect.readingMethod
FROM vending_machine_reading_product as vmrp,
(select 
    distinct(manual) as readingMethod, vending_machine_id
    FROM vending_machine_reading_product
    WHERE vending_machine_id in (542, 543, 821, 824)
    group by vending_machine_id, readingMethod) as readingMethodSelect
WHERE vmrp.vending_machine_id = readingMethodSelect.vending_machine_id
GROUP BY vmrp.vending_machine_id, readingMethodSelect.readingMethod
ORDER BY vmrp.vending_machine_id, max(timestamp) desc 
```

它打印：

```
542;"2013-01-29 10:59:47";f
543;"2011-06-08 05:43:26";f
543;"2011-06-08 05:43:26";t
821;"2013-02-12 00:56:56";f
824;"2013-02-11 05:52:55";f 
```

正如您所注意到的，我仍然不知道该怎么做是有一个带有`543`vending_machine_id 的单行，并且该行在末尾`f/t`。（因为这`id`有真假手动阅读类型）。

有什么办法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:38:55.390

```
SELECT  vending_machine_id, 
        MAX(timestamp) "TimeStamp",
        CASE WHEN COUNT(DISTINCT manual) > 1
            THEN 'True/False'
            ELSE MAX(manual)
        END AS "Manual"
-- WHERE ..add condition here..
FROM    TableName
GROUP   BY vending_machine_id 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!1/d31ac/4)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:41:48.553

这是你想要的吗：

```
select vmrp.vending_machine_id, MAX(timestamp),
       bool_and(manual)
from vmrp.vending_machine_id
group by vmrp.vending_machine_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:59:58.537

尝试：

```
SELECT  vending_machine_id, 
        MAX(timestamp) "TimeStamp",
        array_agg(distinct manual order by manual desc)
FROM    TableName
GROUP   BY vending_machine_id 
```

SQLFiddle[在这里](http://www.sqlfiddle.com/#!1/d8b60/3)。

# node.js - nodejs 的 Internet 打印协议 (IPP)

> ID：16194758
> 
> 赞同：2
> 
> 时间：2013-04-24T14:32:30.047
> 
> 标签：node.js, pdf, printing, ipp-protocol

我正在尝试使用打印机在本地打印 pdf 文件。这是一个代码，试图打印。

```
fs.readFile('documents/AccountStatement.pdf', function(err, data) { 
    if (err)
        throw err;
    var printer = ipp.Printer("http://hostname:631/ipp/printer");
    var msg = {
    "operation-attributes-tag": {
      "requesting-user-name": "KUMA1936",
      "job-name": "My Test Job",
      "document-format": "application/pdf"
    },
    data: data
    };
    printer.execute("Print-Job", msg, function(err, res){
        console.log(res);
        console.log(err);
    });
}); 
```

在上面的代码中，printer.execute() 方法和“Print-Job”参数是什么。这里的 631 是什么。当我打印 res 时，它会显示

{版本：'1.1'，状态代码：'服务器错误操作-不支持'，id：442076，'操作属性标签'：{'属性字符集'：'utf-8'，'属性-自然-language': 'en-us' } } 错误为空。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:44:11.827

您可以查看 API[文档](https://github.com/williamwicks/ipp#printerexecuteoperation-message-callback)。第一个参数（字符串）是 IPP 定义的操作。关于`Print-Job`操作的描述[在这里给出](https://www.rfc-editor.org/rfc/rfc2911#section-3.2.1)

> ```
> 3.2.1 Print-Job Operation
> 
>    This REQUIRED operation allows a client to submit a print job with
>    only one document and supply the document data (rather than just a
>    reference to the data).  See Section 15 for the suggested steps for
>    processing create operations and their Operation and Job Template
>    attributes. 
> ```

[您可以在此处](https://github.com/williamwicks/ipp/blob/master/lib/enums.js#L52)查看其他 IPP 支持的操作。631 是用于 IPP 的接受端口，它使用 TCP。

[您可以在此处](https://www.rfc-editor.org/rfc/rfc2911#section-13.1.5.2)查看有关该错误的更多信息，其中显示：

> ```
> 13.1.5.2 server-error-operation-not-supported (0x0501)
> 
>    The IPP object does not support the functionality required to fulfill
>    the request. This is the appropriate response when the IPP object
>    does not recognize an operation or is not capable of supporting it.
>    See sections 3.1.6.1 and 3.1.7. 
> ```

这意味着您的代码中没有错误。很可能您的打印机未配置或不支持 IPP。最后但并非最不重要的`IPP.Printer`一点是，必须给打印机 IP。因此，请检查您提供的 IP 是否有效（您的代码显示您提供了主机名）。从项目[页面](https://github.com/williamwicks/ipp#internet-printing-protocol-ipp-for-nodejs)给出：

> ```
> To find out if your printer supports IPP:
> 
>  - Google your printer's specs
>  - Try: telnet YOUR_PRINTER 631\. If it connects, that's a good sign.
>  - Use the '/examples/findPrinters.js' script. 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-28T23:51:16.763

*   看起来您在发送 IPP-2.0 时收到了 IPP-Version-1.1-Response。
*   尝试使用 version-option 降级到 1.1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-09-09T12:46:37.697

就我而言，我只是**共享**打印机：（*就像与他人共享）*

**所以 URL 会是** *（你会被 findPrinters.js 找到）*

`http://My-Computer-Name.local.:631/printers/my_printer_name`

*如果您的打印机没有与您的计算机连接（如 USB），这应该会有所帮助。但是通过局域网连接。*

# python - 使用列表中项目的索引来比较它们在列表中的顺序

> ID：16194759
> 
> 赞同：1
> 
> 时间：2013-04-24T14:32:31.070
> 
> 标签：python, indexing

我试图通过将它们分配给名称来比较列表中项目的顺序。我已经使用“if”语句来尝试这样做，但它似乎不起作用。我想我可能需要在列表中找到项目的索引，然后找出两者中哪个更大。

这是我的代码：

> 导入重新，系统
> 
> f = open('findallEX.txt', 'r')
> 
> 对于 f.readlines() 中的行：
> 
> ```
>  match = re.findall('[A-Z]+', line)
> 
>   ii=0
> 
>   if index in match: 'VERB'
> 
>   verbindex = ii
> 
>   ii = ii + 1
> 
>   ii=0
> 
>   if index in match: 'OBJ'
> 
>   objindex = ii
> 
>   ii = ii + 1 
> ```

我使用“索引”这个名称只是为了证明我认为它需要是什么。有没有办法做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:46:45.190

你在寻找这样的东西吗？

```
>>> data = ['VERB', 'SUBJ', 'OBJ']
>>> for n, i in enumerate(data):
...     print n, i
... 
0 VERB
1 SUBJ
2 OBJ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T15:26:27.097

要在列表中查找项目的索引：

```
>>> ['VERB', 'SUBJ', 'OBJ'].index('SUBJ')
1 
```

# php - Symfony2 fosUserBundle 更改密码防止嵌套表单

> ID：16194761
> 
> 赞同：0
> 
> 时间：2013-04-24T14:32:41.233
> 
> 标签：php, forms, symfony, nested, fosuserbundle

我如何防止表单 - 通过 Symfony2 - FosUserBundle 呈现 - 被嵌套？构建器有两个字段，其中一个是重复字段。似乎这将被渲染为嵌套

```
public function buildForm(FormBuilderInterface $builder, array $options)
{
    $builder->add('current_password', 'password', array(
        'label' => 'form.current_password',
        'translation_domain' => 'FOSUserBundle',
        'mapped' => false,
        'constraints' => new UserPassword(),
    ));
    $builder->add('new', 'repeated', array(
        'type' => 'password',
        'options' => array('translation_domain' => 'FOSUserBundle'),
        'first_options' => array('label' => 'form.new_password'),
        'second_options' => array('label' => 'form.new_password_confirmation'),
        'invalid_message' => 'fos_user.password.mismatch',
    ));
} 
```

我得到的是，当表单呈现时是这样的：http: [//pastebin.com/Np2bvgvH](http://pastebin.com/Np2bvgvH)

如您所见，重复的表单字段被包裹在另一个“FormRows”-div 中。我希望它们是简单的“FormRow”-div，没有额外的 FormRows。布局并不意味着有两个嵌套的 FormRows

我希望你能理解我的问题。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T13:40:44.813

解决方案是重新定义 repeat_row 块

```
{% block repeated_row %}
{% spaceless %}

    {% for child in form %}
        {{ form_row(child) }}
    {% endfor %}

{% endspaceless %}
{% endblock repeated_row %} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T16:17:44.957

看看[http://symfony.com/doc/2.0/reference/forms/types/repeated.html](http://symfony.com/doc/2.0/reference/forms/types/repeated.html)

Symfony 考虑了这种类型的字段。

# android - 在不同版本的android中编辑不同颜色的文本

> ID：16194767
> 
> 赞同：0
> 
> 时间：2013-04-24T14:32:52.817
> 
> 标签：android

我在构建它时一直在 android 2.3.3 上运行我的应用程序，一切看起来都很好，我在应用程序中有很多编辑文本，一个用于输入，一个用于显示答案，一个用于显示答案的设置启用 false 并在 2.3.3 上将它们更改为稍微不同的颜色，这是我喜欢的。

现在，当我在 4.1.2 版上运行应用程序时，所有编辑文本都是黑色的，我看不到输入的数字，而且看不到微调器

有没有办法在所有版本上实现类似的东西，当我设置编辑文本的背景颜色时，它使它成为方形，我更喜欢圆角。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T16:47:55.103

有两种选择

1.  将 targetsdkversion 设置为您的最低 sdk 版本。这样你会看到相同的，因为它总是显示最小 sdk 版本的主题

2.  或为edittext创建自己的背景选择器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T08:15:39.177

用户通常更喜欢（至少我愿意）在应用程序之间拥有一致的体验，因此您应该考虑使用本机外观。

如果您将 targetSdk 设置为较低的数字，它会使整个应用程序使用过时的 UI，而且它可以在没有专用菜单按钮的设备上创建一整行菜单按钮。

当然，如果您想将其全部更改为自己的样式（可能会更漂亮），您也可以通过样式或扩展视图来实现。甚至还有一个不错的全息风格库，名为[HoloEverywhere](https://github.com/Prototik/HoloEverywhere)，您可以使用它。

# java - Perl 调用 java - 如何防止异常显示？

> ID：16194771
> 
> 赞同：0
> 
> 时间：2013-04-24T14:33:09.270
> 
> 标签：java, perl, system, call

我有一个调用 java 应用程序的 perl CGI，该应用程序又检查 Mysql 数据库。如果我搜索不存在的条目，java 应用程序会在服务器上显示异常处理程序消息（需要 X 显示窗口）。该异常是直截了当且可以理解的，但是必须单击以将其关闭，此时 perl CGI 可以继续。客户当然不能（也不应该）看到异常消息。

我的问题是..如何防止异常消息显示在服务器窗口上并阻止 CGI 继续？有没有办法关闭来自 perl 的消息？我可以控制 perl 脚本，但不能控制我调用的 java 应用程序。

$ENV{'DISPLAY'} = 'myserver:0.0';
$testline = system("java -Dby.product=true -jar javaApp.jar $version status>mytest.txt") >> 8;

如果 $version 不存在，我会得到异常。我将结果通过管道传输到文件中，以便以后在 perl 中进行文件处理

谢谢。洛基。

======================

谢谢。我加了这个...

```
$ENV{'DISPLAY'} = 'server:0.0';
use IPC::Open2;
use POSIX ":sys_wait_h";
$pid = open2(\*CHLD_OUT, \*CHLD_IN, "java -Dby.product=true -jar javaApp.jar $version status>mytest.txt 2>/tmp/java_error.$$"); 
sleep(5);
kill('TERM', $pid); 
```

如果我在数据库中使用一个已知值，它可以像以前一样正常工作。如果我搜索一个不存在的值，java 消息仍然会弹出。如果没有 sleep 行，则不会弹出 java 消息。换句话说，它看起来像 pid 被杀死了，但是太快了以至于结果没有被输入 mytest.txt。我认为 sleep 功能会给 java 应用程序一些时间来工作，然后 kill 会删除弹出消息。但这不会发生。

看来我可能不得不请求对 java 应用程序进行更改，以便它不会在服务器的屏幕上显示消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:31:45.963

**更正和扩展**

尝试

```
system("java -Dby.product=true -jar javaApp.jar $version status 2>/dev/null >mytest.txt"); 
```

`stderr`它将of重定向`java`到无处。或重定向到一个文件（如`2>/tmp/java_error.$$`）以保存它以调试错误。

如果是在 windows 上使用`2>nul`.

或者使用**[IPC::Open3](http://perldoc.perl.org/IPC/Open3.html)**并根据需要处理两个输入文件句柄。

更详细。我创建了一个简单的`a.java`代码，它写入 stdout、stderr 并在定义 arg 时抛出异常：

```
public class a {
  public static void main(String[] args) {
    System.out.println("STDOUT");
    System.err.println("STDERR");
    if (args.length > 0) { int i = 1/0; }
  }
}; 
```

我编译并运行它（不关心 gcj 警告）：

```
$ gcj -C a.java
$ gij -cp . a
STDOUT
STDERR
$ gij -cp . a x
STDOUT
STDERR
Exception in thread "main" java.lang.ArithmeticException: / by zero
   at a.main(a.java:5)
$ gij -cp . a >/dev/null
STDERR
$ gij -cp . a x 2>/dev/null
STDOUT 
```

所以堆栈转储按预期写入标准错误，因此可以重定向。

```
$ perl -e 'system("gij -cp . a x 2>/dev/null")' 
STDOUT 
```

[带有IPC::Open3](http://perldoc.perl.org/IPC/Open3.html)的示例程序：

```
#!/usr/bin/perl
use strict;
use warnings;
use IPC::Open3 'open3';
use Symbol 'gensym';

my ($fcin, $fcout, $fcerr);
$fcerr = gensym;
my $pid = open3 $fcin, $fcout, $fcerr, "gij -cp . a x";
my @out = <$fcout>;
my @err = <$fcerr>;
my $err = waitpid $pid, 0;
print "Exit:", ($err >> 8), "\n";
print "OUT: @out\n";
print "ERR: @err\n"; 
```

输出：

```
Exit:72
OUT: STDOUT

ERR: STDERR
 Exception in thread "main" java.lang.ArithmeticException: / by zero
    at a.main(a.java:5) 
```

甚至 IPC::Open3 的手册页也建议使用[IPC::Run](http://search.cpan.org/~toddr/IPC-Run-0.92/lib/IPC/Run.pm)包。我试过了，但它不是正态分布的一部分。因此，如果您愿意，可以从 CPAN 安装它。

# ruby-on-rails - 通过散列中的元素进行分组

> ID：16194778
> 
> 赞同：1
> 
> 时间：2013-04-24T14:33:26.003
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

假设我有这个数组

```
x=[{:shipping_id=>2, :fsn=>"ab", :price=>300, :quantity=>1},
   {:shipping_id=>3, :fsn=>"abc",:price=>500, :quantity=>2},
   {:shipping_id=>2, :fsn=>"abcd",:price=>300,:quantity=>3},
   {:shipping_id=>4, :fsn=>"abx", :price=>600,:quantity=>1},
   {:shipping_id=>3, :fsn=>"abb", :price=>400,:quantity=>1}] 
```

我想按唯一的运输 ID 对其进行分组，但在这种情况下，我们只需按 shipping_id=2 进行分组

所以我这样做`x.select! {|y| y[:shipping_id]==2}`给了我

```
[{:shipping_id=>2, :fsn=>"ab",:price=>300,:quantity=>1}, {:shipping_id=>2, :fsn=>"abcd",:price=>300,:quantity=>3}] 
```

但问题是我想要这种形式的结果

```
x={:shipping_id=>[2,2],:fsn=>["ab","abcd"],:price=>[300,300],:quantity=>[1,3]} 
```

我应该怎么办？我可以用几行代码做到这一点，但有什么优化的方法吗？

**更新-：最终工作解决方案（我的解决方案）-**

控制器

```
 new_params={}
 order_hash.each do |row|
        new_params=row.convert_to_params(new_params)
 end
 params.merge!(new_params) 
```

模型

```
 def convert_to_params(new_params)
    item=self.instance_values.symbolize_keys
    item.each do |k, v|
      new_params[k].nil? ? new_params[k]=[v] : new_params[k].push(v)
    end
    return new_params
 end 
```

这给了我想要的结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:40:44.757

你可以这样做：

```
ret = Hash[x.group_by {|e| e[:shipping_id]}.map {|e| [e.first, e.last.map {|t| t[:fsn]}]}] 
```

然后，如果您只需要 shipping_id = 2 的那些

```
> ret[2]
=> ["ab", "abcd"] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:59:39.727

```
arr = x= [{:shipping_id=>2, :fsn=>"ab"}, 
{:shipping_id=>3, :fsn=>"abc"}, {:shipping_id=>2, :fsn=>"abcd"}, 
{:shipping_id=>4, :fsn=>"abx"}, {:shipping_id=>3, :fsn=>"abb"}]
@h = {}
arr.group_by {|x| x[:shipping_id]==2 }[true].inject({}) do |mem,i|
   i.each{|k,v| mem[k] =  [v] << mem[k] ; @h = mem}
end
p @h #=> {:shipping_id=>[2, 2], :fsn=>["abcd", "ab"]} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T17:20:33.163

**编辑：**

```
>> z = x.group_by {|y| y[:shipping_id] }
#=> {2=>[{:shipping_id=>2, :fsn=>"ab"}, {:shipping_id=>2, :fsn=>"abcd"}], 3=>[{:shipping_id=>3, :fsn=>"abc"}, {:shipping_id=>3, :fsn=>"abb"}], 4=>[{:shipping_id=>4, :fsn=>"abx"}]}

>> Hash[z.map {|k, v| Array[[k]*v.count, v] }]
#=> {[2, 2]=>[{:shipping_id=>2, :fsn=>"ab"}, {:shipping_id=>2, :fsn=>"abcd"}], [3, 3]=>[{:shipping_id=>3, :fsn=>"abc"}, {:shipping_id=>3, :fsn=>"abb"}], [4]=>[{:shipping_id=>4, :fsn=>"abx"}]} 
```

不完全是您需要的，如果您发现它以某种方式有用，仍将其留在这里。

# android - Android 编程：如何以网格方式以编程方式创建各种视图类型

> ID：16194781
> 
> 赞同：1
> 
> 时间：2013-04-24T14:33:28.507
> 
> 标签：android, user-interface, grid, views

我不确定如何准确地问这个问题，但我会试一试。

这是我正在尝试做的，在一个活动中。

构建一个网格，其中包含 [x] 行，每行 3 列，包含此内容

**[一个 TextView（包含一个名称）] [一个 Spinner（包含一个状态列表）] [一个 EditText]**

如何开始？我可以以编程方式创建的视图，这不是问题，我什至将它们存储在 3 个数组列表中以供以后轻松参考，但我不知道如何正确地做到这一点。

我应该用例如（和伪代码）创建一个xml布局吗

```
LinearLayout (horizontal) 
   TextView ...
   Spinner ...
   EditText ...
/LinearLayout 
```

并尝试在我用来创建每一行的循环中对其进行膨胀，并以标准方式设置每个视图的 id（例如 viewName[x] 其中 x 是我的 for 中的当前“i”，但它有任何用处吗？ ?)，就像我们对 ExpendableList 适配器的组/孩子所做的那样？

或者有没有办法实际使用 GridView/GridLayout 来做到这一点（在这种情况下，在我的 Activity 中，我如何将每个特定创建的 View 放入正确的 GridView/GridLayout 中）？

还是我根本不怀疑的另一种方式？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:04:52.720

如果您想以编程方式添加视图，只需创建一个包含 3 个线性布局（水平）的 layout.xml。还将 id 分配给那些 LinearLayouts。然后在您的 java 代码中，只需找到视图并在这些 LinearLayouts 上调用 addView()。

例子：

```
LinearLayout ll_1 = (LinearLayout)findViewById(R.id.linearlayout1);
LinearLayout ll_2 = (LinearLayout)findViewById(R.id.linearlayout2);
LinearLayout ll_3 = (LinearLayout)findViewById(R.id.linearlayout3);

...

ll_1.addView(new TextView(this));
ll_1.addView(new Spinner(this));
ll_1.addView(new EditText(this));
... 
```

详细地说，例如，如果我想以编程方式将微调器添加到 LinearLayout，然后，

你需要得到布局

```
LinearLayout linearLayout =  findViewById(R.id.layoutID); 
```

如下创建微调器：

```
 Spinner spinner = new Spinner(this);

spinner .setLayoutParams(new LayoutParams(LayoutParams.FILL_PARENT,LayoutParams.WRAP_CONTENT));

                ArrayAdapter spinnerArrayAdapter = new ArrayAdapter(this,
                        android.R.layout.simple_spinner_dropdown_item, spinnerList);
                spinner.setAdapter(spinnerArrayAdapter); 
```

然后添加微调器以查看

```
linearLayout.addView(spinner); 
```

# c# - 调用 Bing.Maps.Location 类构造函数时出现异常

> ID：16194783
> 
> 赞同：0
> 
> 时间：2013-04-24T14:33:35.830
> 
> 标签：c#, windows-8, winrt-xaml, bing-maps

在为 Windows 8 商店应用程序使用 Bing 地图控件时，在非 UI 线程上创建新的[Location 对象会导致异常。](http://msdn.microsoft.com/en-us/library/hh846500.aspx)

> WinRT 信息：应用程序调用了为不同线程编组的接口。

通常这意味着我不正确地尝试从后台线程更新 UI，但事实并非如此，因为这可以通过在空的 Windows 8 商店应用程序项目中放置一个按钮来重现：

```
<Button Content="Click me" Click="Button_Click"/> 
```

并像这样添加一个事件处理程序：

```
private void Button_Click(object sender, RoutedEventArgs e)
{
    Task.Run(() =>
    {
        var loc = new Location(1, 1);
    });
} 
```

Location 结构的构造函数真的在 UI 线程上做了什么，还是我在这里遗漏了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:53:13.993

我没有进入代码来查看 Bing 地图类中发生了什么，但是您不能在 UI 线程之外创建任何 Bing 地图“UI”对象。我认为构造函数只测试它是否在主线程上被调用，如果不是则抛出异常。

这意味着您必须在 UI 线程上实例化您的 Location 对象，还要实例化您的折线、引脚、图层等。

任何将添加到地图控件的元素都必须在 UI 线程中创建。

# twitter-bootstrap - 是否可以使用 php 变量作为 twitter bootstrap popover 的内容？

> ID：16194784
> 
> 赞同：0
> 
> 时间：2013-04-24T14:33:39.080
> 
> 标签：twitter-bootstrap, popover

我需要使用 php 变量作为弹出框的内容。我试过这个，但它不起作用

`<?php $comment = ORM::factory('mark')->getComment($user_id, $subject, $quarter1[$j][1], $quarter1[$j][0]); ?> <a href="#" id="example" class="btn btn-success" rel="popover" data-content="<?php echo $comment;?>">hover for popover</a>`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T16:14:30.057

将 data-toggle="popover" 添加到您的锚点。然后尝试这样的事情：

```
$("a[data-toggle=popover]")
      .popover({
         html: true,
         animation: true,
         placement: 'bottom',
         trigger: 'manual'
       }) 
```

在您的脚本文件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T17:18:56.453

我找到了解决方案！

```
<a class="d" rel = 'popover' data-html='true' data-content="<div><?php echo $comment?></div>"  data-original-title='Popover Title' href="#">hover for popover</a> 
```

# javascript - 返回 XML 文件时 getElementsByTagName 在 IE 中不起作用？

> ID：16194785
> 
> 赞同：1
> 
> 时间：2013-04-24T14:33:39.930
> 
> 标签：javascript, xml, internet-explorer-8

我正在尝试通过 JavaScript 从 XML 文件中选择某些元素，我已经让它在 Firefox、Chrome 和 IE9+ 中工作，但 IE8 被证明是一个真正的绊脚石，我正在使用下面的代码返回 XML 文件：

```
 function httpGet(theUrl) {
            var xmlHttp = null;

            xmlHttp = new XMLHttpRequest();
            xmlHttp.open('GET', theUrl, false);
            xmlHttp.send();

            if(window.DOMParser) {
                var parser = new DOMParser();
                var doc = parser.parseFromString(xmlHttp.responseText, 'text/xml');
                return doc;
            }
            else {
                var xmlDocument = new ActiveXObject('Microsoft.XMLDOM');
                xmlDocument.async = false;
                xmlDocument.loadXML(xmlHttp.responseText);
                return xmlDocument;
            }
        } 
```

然后，我使用以下选择器来列出 XML 文件中的某些项目：

```
 var rssData = httpGet(rssFeed);
    var allTitles = convertToArray(rssData.getElementsByTagName('title'));
    var allDates = convertToArray(rssData.getElementsByTagName('pubDate'));
    var allText = convertToArray(rssData.getElementsByTagName('text')); 
```

然后我将数组项连接在一起并将一个项`innerHTML`设置为该值（如果需要，我可以提供此代码）

奇怪的是 IE8 返回正确数量的项目，但每个项目的值`undefined`与实际值相反，例如“Hello world”

我已经为此奋斗了几个小时，但仍然一片空白……有人知道我做错了什么吗？

编辑：这里要求的是转换为数组函数

```
 function convertToArray(htmlCollection) {
        var nodes = [];
        var collectionLength = htmlCollection.length;
        for(i = 0; i < collectionLength; i++) {
            nodes.push(htmlCollection[i]);
        }
        return nodes;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:57:18.650

问题是您必须使用`.text`而不是`.textContent`用于 ie8，因为`textContent`ie 中不存在该属性。

您可以在[MDN](https://developer.mozilla.org/en-US/docs/DOM/Node.textContent)中看到 textContent 仅适用于 ie 9+

# wordpress - 在后期编辑/保存时跟踪 WordPress 更改

> ID：16194799
> 
> 赞同：3
> 
> 时间：2013-04-24T14:34:08.477
> 
> 标签：wordpress

我想知道当自定义帖子类型的元信息发生更改时如何运行函数。

例如，我有一个与自定义帖子类型关联的单选框。并使用元框制作，当我更改选项时，我想运行一个函数。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-07T10:47:35.053

^(*最初在[OP 的问题](https://stackoverflow.com/posts/16194799/revisions)中。*)

我想我找到了我想要的

```
function do_my_stuff($post_ID)  {
   //do my stuff here;
   return $post_ID;
}

add_action('save_post', 'do_my_stuff'); 
```

[Wordpress：保存或编辑帖子时执行功能](https://stackoverflow.com/questions/5218828/wordpress-executing-function-when-saving-or-editing-post)

但是是否有可能跟踪所做的更改？

是的，在你的帮助下 diggy 做到了，但必须改变一些东西。

```
function do_my_stuff($post_ID)  {
   $newvalue = $_POST['my_metabox_value'];
   echo $newvalue;
   $oldvalue= get_post_meta($post_id, 'my_metabox_value', true );
   echo $oldvalue;
}

add_action('pre_post_update', 'do_my_stuff'); 
```

# javascript - chrome可执行文件如何自动运行？

> ID：16194804
> 
> 赞同：1
> 
> 时间：2013-04-24T14:34:17.280
> 
> 标签：javascript, html, windows, security

因此，您可以在[http://google.com/chrome/](http://google.com/chrome/)上下载 chrome。您选择了 chrome 频道并接受 EULA。Web 安装程序开始下载，几秒钟后自动启动并立即开始安装 chrome (!) 没有 Windows 弹出窗口“您确定要启动可执行文件吗？”。才开始。

它是怎么做到的？它也写在GWT上，有关系吗？或者可能是因为谷歌签署的可执行文件？但是那样它就不能自动运行，只能通过点击下载和启动。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-24T14:44:01.970

Chrome 使用 .NET ClickOnce 安装程序，可以从 IE 自动启动。请注意，对于其他浏览器（已确认适用于 Firefox），您必须明确下载 .exe，就像任何其他可执行文件一样。

至于不要求提升权限，这是因为它将自身安装到您用户的文件夹中，而不是在 Program Files 中。

# javascript - ASP.Net Web 服务总是返回 XML 而不是 JSON

> ID：16194805
> 
> 赞同：0
> 
> 时间：2013-04-24T14:34:17.357
> 
> 标签：javascript, jquery, asp.net, json, web-services

目前我使用 asp.net Web 服务，但是当我通过 ajax 调用 Web 服务方法时，它总是返回 XML 而不是 json

我试试

[ASP.Net Web 服务不会返回 JSON - 始终是 XML](https://stackoverflow.com/questions/9469189/asp-net-web-service-wont-return-json-always-xml)

但它也不适合我..

JS：-

```
$.ajax({
            type: "Post",
            contentType: "application/json; charset=utf-8",
            url: "http://www.quietincomes.com/LoginWebservice.asmx/Demo",
            dataType: "jsonp",
            success: function (data) {
                alert("1" + data);
            },
            error: function (result) {
                alert("2" + JSON.stringify(result));
            }
}); 
```

LoginWebservice.asmx :-

```
 [WebMethod]
    [ScriptMethod(ResponseFormat = ResponseFormat.Json)]
    public string Demo()
    {
        return "Harshit";
    } 
```

我错在哪里..

jsfiddle 示例：-

[http://jsfiddle.net/EXvqc/](http://jsfiddle.net/EXvqc/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:51:03.440

首先，您必须使用**Post**方法向您的 Web 服务发送请求。正如您所使用`JSONP`的那样，它总是寻找回调，您必须为它定义回调方法。

请[参考](http://encosia.com/using-jquery-to-consume-aspnet-json-web-services/)

你必须添加的另一件事如下

```
[System.Web.Script.Services.ScriptService]
    // To allow this Web Service to be called from script, using ASP.NET AJAX, uncomment the following line. 
    // [System.Web.Script.Services.ScriptService]
    public class LoginWebservice : System.Web.Services.WebService
    {

        [WebMethod]
        public string Demo()
        {
            return "Harshit";
        }
    } 
```

指示可以从脚本调用 Web 服务。这个类不能被继承。

您的**aspx/HTML**将包含

```
$.ajax({
            type: "Post",
            contentType: "application/json; charset=utf-8",
            url: "http://www.quietincomes.com/LoginWebservice.asmx/Demo",
            dataType: "json",
            success: function (data) {
                alert("1" + data);
            },
            error: function (result) {
                alert("2" + JSON.stringify(result));
            }
}); 
```

**请参阅下面的输出**

![在此处输入图像描述](https://i.stack.imgur.com/LwBQN.png)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-24T14:47:54.223

JSONP 不是 JSON，JSONP 用于克服同源策略（站点 A 无法向站点 B 发出 ajax 请求）。为了解决这个问题，站点 A 将创建一个脚本标签：

```
document.createElement("script") 
```

然后将它的源设置为站点 B，通常指定一个回调，如 www.B?callback=callMe

站点 B 的典型响应是：

```
callMe({siteBSays:"hello"}); 
```

JQuery 隐藏为您创建 javascript 元素，因此它看起来像一个普通的 ajax 请求。确保站点 B 具有正确的响应类型标题，我认为它是 text/javascript

进行跨域请求的另一种方法是站点 B 有一个响应标头，允许站点 A 通过设置响应标头 Access-Control-Allow-Origin 向它发出 ajax 请求（cors）

# html - Firefox 错误地将 margin-bottom 添加到元素的顶部

> ID：16194806
> 
> 赞同：0
> 
> 时间：2013-04-24T14:34:20.237
> 
> 标签：html, css, firefox, margin

在 Firefox 中，当我添加以下 CSS 规则时，`75px`底部边距也会应用于`#header-container`. Firebug 没有报告这一点，但该元素已在页面下移了确切的边距底部量。其他浏览器不这样做。

有谁知道为什么会发生这种情况以及如何阻止它？谢谢。

```
#header-container{
    position: relative;
    margin: 0 auto 75px;
    width: 960px;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T12:05:12.383

我不知道这是怎么发生的，为什么会这样，但是如果你把你的`#header-container`样式改成这个

```
#header-container{
   position: relative;
   margin-bottom: 75px;
   width: 960px;
   float: left;
} 
```

它将解决问题。

# hibernate - @Column 在休眠语法中

> ID：16194808
> 
> 赞同：1
> 
> 时间：2013-04-24T14:34:28.660
> 
> 标签：hibernate

我不熟悉 Hibernate，但仍然需要对代码进行一些小的修改。

在代码中，我看到如下内容：

```
@Basic
@Column(name = "patients_possible")
public int patientsPossible;

@Basic
public BigDecimal weight; 
```

所以我的问题是为什么其中一些确实有`@column`但有些没有？但是在有`@ColumnOrder`命令的文件顶部，我看到它们都列为列。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:39:30.120

因为模型中的列名与数据库中的列名不同。您基本上是在让 Hibernate 知道映射到您的属性名 patientsPossible 的列是如何在您的数据库中命名的。

# java - 方法和循环内的内联大括号块

> ID：16194811
> 
> 赞同：4
> 
> 时间：2013-04-24T14:34:34.353
> 
> 标签：java, inline, braces

很难准确地搜索到这个。我在几个地方看到过这个，我什至在代码中尝试过，看看它是如何工作的，但只是为了让我确切地知道如何使用它们，并确保我不会滥用它们，我想我会问在这。

```
 public void doSomethingSpecial()
 {

      String strHello = null;

      // What is the following section in braces for
      {
           strHello = "Hello World"
      }

      for(int i = 0; i < 10; i++)
      {

           //  What is the significance of them it in a loop?
           {
                strHello = "Hello";
                // Do something else...
           }
           .
           .
           .
      }
 } 
```

*   有人可以澄清这些大括号大括号的用途吗？
*   我假设它们像一种方法一样工作，并且只要没有在块之外指定任何内容，它们就会限制其范围，但是还有其他用途吗？
*   他们的确切名字是什么？

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:53:03.110

大括号定义范围。例如，如果您在大括号内定义一个局部变量并为其赋值，如下所示：

```
{
int foo = 10;

} 
```

然后 foo 的范围（即定义它并具有值的代码部分）被限制在大括号内的区域。

你的 for 循环也是如此。在这些大括号内，计数器 i 被定义并具有意义，但不在外面。所以这段代码不会编译：

```
for (int i = 0; i < 5; i++) {
  // Do something with i
}

i = 10; // Won't compile. i is undefined as a variable. 
```

这样做的好处很多，因为您可以精确控制不同变量的范围。您还可以在异常处理的上下文中定义异常的范围等。

您还可以执行以下操作：

```
int i = 0;

for (; i < 5; i++) {
  // Do something with i.
}

for (; i < 10; i++) {
  // Do something else with i
} 
```

在这种情况下， i 被定义在更大的范围空间（封闭方法或构造函数的空间）中，for 循环只是增加它的值。因此，您在两个不同的范围区域之间共享一个变量。

最后，您可以在方法或构造函数之外将它们用作类中的初始化块。它们允许您初始化成员变量，例如，无法用一行代码轻松初始化的成员变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:08:36.720

在类中，它们形成一个静态初始化器，它在类加载时运行一次，首先发生。

在该方法中，它们标记了一个范围。它们在您的代码中基本上没用。

但是如果代码如下

```
 {
      String str = "test";
      System.out.println(str);
  }

  {
      System.out.println(str);
  } 
```

第二次打印会报编译错误，因为str的作用域在第一个作用域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T15:04:24.477

所以找到了一些我认为我会在这里为任何人发布的东西，因为其他问题似乎都没有完全澄清这一点。

在类范围内的方法之外使用时：

```
 public class doSomethingSPecial() {
      {
           System.out.println("This is a constructor");
      }

      public doSomeThingSpecial() {}

      public doSomethingSpecial(String specialString) { }

      public doSomethingSpecial(int specialNumber) { }
 } 
```

*“Java 编译器将初始化程序块复制到每个构造函数中。因此，这种方法可用于**在多个构造函数之间共享代码块。** ”* - [Java API 教程](http://docs.oracle.com/javase/tutorial/java/javaOO/initial.html)（感谢 Soririous Delimanolis）

所以每次调用构造函数时都会调用内联大括号。

至于关于在方法和循环中使用的其他问题，大括号似乎只是为了限制范围。

*“但在实践中，如果你发现自己使用这样的代码块，这可能表明你想将该块重构为一个方法”* - 归功于 Robert Munteanu[最佳答案：Java 中的匿名代码块](https://stackoverflow.com/questions/1563030/anonymous-code-blocks-in-java)

到目前为止，这基本上就是我想出的所有东西

# ios - 将公历日期字符串转换为伊斯兰日期会给出正确和不正确的结果

> ID：16194820
> 
> 赞同：17
> 
> 时间：2013-04-24T14:35:11.747
> 
> 标签：ios, objective-c, calendar, nsdate

我有以下两个日期字符串：（1）**24/04/2013**和（2）**19/03/2013**我正在尝试将这些日期转换为伊斯兰（Um Al Qura）日期，我正在使用此代码块这样做：

```
 NSDateFormatter *df = [[NSDateFormatter alloc] init];
    df.dateFormat = @"dd/MM/yyyy";
    df.calendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
    NSDate *dateInGrogrian = [df dateFromString:@"24/04/2013"];

    NSDateFormatter *df2 = [[NSDateFormatter alloc] init];
    NSCalendar * cal = [[NSCalendar alloc] initWithCalendarIdentifier:NSIslamicCalendar];
    [df2 setCalendar:cal];
    [df2 setDateFormat:@"dd/MM/yyyy"];
    NSLog(@"Converted date to Islamic = %@",[df2 stringFromDate:dateInGrogrian]); 
```

如果输入字符串是 24/04/2013，则`NSLog`显示：

`Converted date to Islamic = 14/06/1434`这是正确的（根据所有伊斯兰国家使用[的正式伊斯兰日历）。](http://www.islamicfinder.org/Hcal/hdate_next.php)但如果输入字符串是 19/03/2013，则`NSLog`显示：

`Converted date to Islamic = 08/05/1434`这是不正确的（根据伊斯兰日历，正确的日期必须是 1434 年 7 月 5 日，晚了 1 天）。

-**在您提出答案之前要考虑的注意事项：**

**(1)**我曾尝试使用日历标识符`NSIslamicCivilCalendar`而不是`NSIslamicCalendar`，但无济于事：转换后的日期之一是正确的，另一个是错误的（晚 1 天）。

**(2)**我曾尝试像这样使用 GMT 时区：`[df2 setTimeZone : [NSTimeZone timeZoneWithName:@"GMT"]];`，这为第 (2) 天生成了正确的转换日期，但对于第 (1) 天不正确（落后 1 天）。

**(3)**我尝试过组合解决方案：`NSIslamicCivilCalendar`有/无 GMT 时区，`NSIslamicCalendar`有/无 GMT 时区，但也无济于事......

任何人都可以提供满足两个日期的代码块吗？所以我确保任何提供的公历日期字符串都正确转换为伊斯兰日期字符串。

太感谢了。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-05-02T22:42:42.070

在打印出过去 4 年的所有日期之后，Apple 似乎使用了一种在数学上计算伊斯兰历法的公认公式，因为正如 Moxy 指出的那样，实际的历法不是基于科学日，而是基于月球的近似值。

这个公式是所有奇数月份有 30 天，所有偶数月份有 29 天，并且在任何年份 mod 30 为以下之一的年份的最后一个月添加额外的一天：2、5、7、 10、13、16、18、21、24、26 或 29。

结果是平均月长为 29.53056 天，非常接近 29.53059 天的农历月份。

该公式已在计算机的其他地方使用，因为它是唯一一种无需使用历史上每一年的查找表即可计算日期的方法。因此，除非您自己编写查找表，否则对于所有向后和向前的日期，这将尽可能准确。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-06-18T06:22:25.253

```
// Create a Gregorian Calendar
NSCalendar *gregorianCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];

// Set up components of a Gregorian date
NSDateComponents *gregorianComponents = [[NSCalendar currentCalendar] components:NSDayCalendarUnit | NSMonthCalendarUnit | NSYearCalendarUnit fromDate:[NSDate date]];

NSLog(@"[In Gregorian calendar ->] Day: %ld, Month: %ld, Year:%ld",
      (long)[gregorianComponents day],
      (long)[gregorianComponents month],
      (long)[gregorianComponents year]);

gregorianComponents.day = [gregorianComponents day];
gregorianComponents.month = [gregorianComponents month];
gregorianComponents.year = [gregorianComponents year];

// Create the date
NSDate *date = [gregorianCalendar dateFromComponents:gregorianComponents];

// Then create an Islamic calendar
NSCalendar *hijriCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSIslamicCivilCalendar];

// And grab those date components for the same date
NSDateComponents *hijriComponents = [hijriCalendar components:(NSDayCalendarUnit |
                                                               NSMonthCalendarUnit |
                                                               NSYearCalendarUnit)
                                                     fromDate:date];

NSLog(@"[In Hijri calendar ->] Day: %ld, Month: %ld, Year:%ld",
      (long)[hijriComponents day],
      (long)[hijriComponents month],
      (long)[hijriComponents year]); 
```

# c++ - 创建相机变换和视图矩阵

> ID：16194821
> 
> 赞同：2
> 
> 时间：2013-04-24T14:35:20.323
> 
> 标签：c++, graphics, matrix

这是我经常在网上遇到的一个话题，但大多数网站在正确解释这一点方面做得很差。我目前正在创建自己的 Camera 类，作为从头构建的 3D 渲染器的一部分（如何更好地理解发生了什么，对吧？）。但是我在为相机创建 World 和 View 矩阵时遇到了麻烦。

据我了解，相机的世界矩阵本质上是将相机放置在世界空间中的位置的矩阵；仅当您需要在其位置并根据其方向渲染某些东西时，才需要这样做。另一方面，视图矩阵是将相机从该位置放置到世界空间原点的矩阵，沿 z 轴朝向一个方向或另一个方向（右手为负，左手为正，I相信）。到目前为止我是正确的吗？

给定一个位置定义为 m_Eye 的矩阵和一个定义为 m_LookAt 的外观，我如何生成世界矩阵？更重要的是，如何生成视图矩阵而不必执行昂贵的逆运算？我知道旋转元素的倒数等于它的转置，所以我认为这会影响它。无论如何，这是我一直在修改的代码。顺便说一句，我使用的是右手坐标系。

以下代码应生成适当的局部坐标轴：

```
m_W = AlgebraHelper::Normalize(m_Eye - m_LookAt);
m_U = AlgebraHelper::Normalize(m_Up.Cross(m_W));
m_V = m_W.Cross(m_U); 
```

到目前为止，以下代码是我用来生成 World 矩阵的代码（注意，我也使用基于行的矩阵，因此 m_12 表示第一行和第二列）：

```
Matrix4 matrix = Matrix4Identity;
matrix.m_11 = m_U.m_X;
matrix.m_12 = m_U.m_Y;
matrix.m_13 = m_U.m_Z;

matrix.m_21 = m_V.m_X;
matrix.m_22 = m_V.m_Y;
matrix.m_23 = m_V.m_Z;

matrix.m_31 = m_W.m_X;
matrix.m_32 = m_W.m_Y;
matrix.m_33 = m_W.m_Z;

matrix.m_41 = m_Eye.m_X;
matrix.m_42 = m_Eye.m_Y;
matrix.m_43 = m_Eye.m_Z; 
```

这是计算 World 矩阵以及随后如何提取 View 矩阵的好方法吗？

预先感谢您对此事的任何帮助。

# c# - 从网络共享运行 .NET 4.0 应用程序时出现异常

> ID：16194823
> 
> 赞同：3
> 
> 时间：2013-04-24T14:35:28.857
> 
> 标签：c#, .net, .net-4.0, socketexception

我有一个 .NET 4.0 C# 控制台应用程序。该应用程序被部署到一个网络文件共享（我相信它是一个 Windows 2000 Server 文件服务器），如下所示：

```
\\server\share\Apps\Beta\Group\JobName\JobName.exe 
```

将执行应用程序的代理机器是 Windows 2008 R2 Server，x64。我使用域用户帐户从命令行运行应用程序。当在某个帐户下运行时，我们将调用*UserBeta*，应用程序在尝试连接到 WCF 服务时会引发以下异常：

```
System.Configuration.ConfigurationErrorsException: Error creating the Web Proxy specified in the 'system.net/defaultProxy' configuration section. ---> System.Net.Sockets.SocketException: An invalid argument was supplied 
```

用户帐户*UserBeta*具有修改、读取和执行、列出文件夹内容、在文件夹**Beta**中引入并由上述路径中的子文件夹继承的读取和写入权限。如果我使用第二个用户帐户*UserStage*，它具有相同的权限，只是它们在**Apps**文件夹中被引入更高的一个文件夹，应用程序将毫无例外地运行。这两个帐户都属于代理服务器上的本地管理员组。

有趣的是，如果应用程序在作为*UserStage*执行后 15 秒左右以*UserBeta 身份*执行，它也会成功运行。

我还应该注意，如果从本地驱动器作为*GroupBeta*帐户运行该应用程序运行良好，因此从网络共享运行的特定帐户似乎存在某种信任问题。

我需要应用程序作为网络共享的*UserBeta*帐户运行。ClickOnce 当前不是一个选项。我相信我可以通过在**Apps文件夹中添加***UserBeta*的权限来解决问题，但是我不喜欢在某些东西上投入更多的访问权限，除非这确实是问题所在。如果有人有任何其他想法或可以指出调整权限是正确做法的原因，我将不胜感激。

# javascript - 使用箭头键遍历 contenteditable 段落

> ID：16194824
> 
> 赞同：9
> 
> 时间：2013-04-24T14:35:35.273
> 
> 标签：javascript, jquery, contenteditable

我正在尝试使用箭头键在 contenteditable 段落之间遍历。我不能在所有段落周围放置一个包含 div，因为它们可能会被其他不可编辑的元素分割。

我需要能够确定第一行的字符长度，以便当光标在该行上时按下向上箭头键时，它将跳转到上一段 - 希望保持光标相对于该行的位置。

我可以通过以下方式获取光标索引：

```
function cursorIndex() {
    return window.getSelection().getRangeAt(0).startOffset;
} 
```

并将其设置为：如在此处找到 - [Javascript Contenteditable - 将光标/插入符号设置为索引](https://stackoverflow.com/questions/16095155/javascript-contenteditable-set-cursor-caret-to-index)

```
var setSelectionRange = function(element, start, end) {
    var rng = document.createRange(),
        sel = getSelection(),
        n, o = 0,
        tw = document.createTreeWalker(element, NodeFilter.SHOW_TEXT, null, null);
    while (n = tw.nextNode()) {
        o += n.nodeValue.length;
        if (o > start) {
            rng.setStart(n, n.nodeValue.length + start - o);
            start = Infinity;
        }
        if (o >= end) {
            rng.setEnd(n, n.nodeValue.length + end - o);
            break;
        }
    }
    sel.removeAllRanges();
    sel.addRange(rng);
};

var setCaret = function(element, index) {
    setSelectionRange(element, index, index);
}; 
```

假设光标在第三段的顶行并且按下向上箭头，我希望它跳到第二段的底行

[http://jsfiddle.net/Pd52U/2/](http://jsfiddle.net/Pd52U/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T05:41:19.167

看起来没有简单的方法可以做到这一点，我有以下工作示例。有一点处理，所以它有点慢，当在段落之间上下移动时，它可能会被奇怪的字符输出。

请告知我可以进行的任何改进。

[http://jsfiddle.net/zQUhV/47/](http://jsfiddle.net/zQUhV/47/)

* * *

我所做的是按每个作品拆分段落，将它们一个一个插入一个新元素，检查高度变化 - 当它确实改变时，添加了一个新行。

此函数返回包含行文本、起始索引和结束索引的行对象数组：

```
(function($) {
$.fn.lines = function(){
    words = this.text().split(" "); //split text into each word
    lines = [];

    hiddenElement = this.clone(); //copies font settings and width
    hiddenElement.empty();//clear text
    hiddenElement.css("visibility", "hidden");

    jQuery('body').append(hiddenElement); // height doesn't exist until inserted into document

    hiddenElement.text('i'); //add character to get height
    height = hiddenElement.height();
    hiddenElement.empty();

    startIndex = -1; // quick fix for now - offset by one to get the line indexes working
    jQuery.each(words, function() {
      lineText = hiddenElement.text(); // get text before new word appended
      hiddenElement.text(lineText + " " + this);
        if(hiddenElement.height() > height) { // if new line
            lines.push({text: lineText, startIndex: startIndex, endIndex: (lineText.length + startIndex)}); // push lineText not hiddenElement.text() other wise each line will have 1 word too many
            startIndex = startIndex + lineText.length +1;
            hiddenElement.text(this); //first word of the next line
        }
   });
    lines.push({text: hiddenElement.text(), startIndex: startIndex, endIndex: (hiddenElement.text().length + startIndex)}); // push last line
    hiddenElement.remove();
    lines[0].startIndex = 0; //quick fix for now - adjust first line index
    return lines;
}
})(jQuery); 
```

* * *

现在您可以使用它来测量直到光标点的字符数，并在遍历段落时应用它以保持光标位置相对于行首。然而，当考虑“i”的宽度到“m”的宽度时，这可能会产生非常不准确的结果。

相反，最好找到直到光标点的线条宽度：

```
function distanceToCaret(textElement,caretIndex){

    line = findLineViaCaret(textElement,caretIndex);
    if(line.startIndex == 0) { 
     // +1 needed for substring to be correct but only first line?
        relativeIndex = caretIndex - line.startIndex +1;
    } else {
      relativeIndex = caretIndex - line.startIndex;  
    }
    textToCaret = line.text.substring(0, relativeIndex);

    hiddenElement = textElement.clone(); //copies font settings and width
    hiddenElement.empty();//clear text
    hiddenElement.css("visibility", "hidden");
    hiddenElement.css("width", "auto"); //so width can be measured
    hiddenElement.css("display", "inline-block"); //so width can be measured

    jQuery('body').append(hiddenElement); // doesn't exist until inserted into document

    hiddenElement.text(textToCaret); //add to get width
    width = hiddenElement.width();
    hiddenElement.remove();

    return width;
}
function findLineViaCaret(textElement,caretIndex){
    jQuery.each(textElement.lines(), function() {
        if(this.startIndex <= caretIndex && this.endIndex >= caretIndex) {
            r = this;
            return false; // exits loop
        }
   });
    return r;
} 
```

然后将目标行拆分为字符，并通过逐个添加字符直到到达该点，找到最接近与上面宽度匹配的点：

```
function getCaretViaWidth(textElement, lineNo, width) {
    line = textElement.lines()[lineNo-1];

    lineCharacters = line.text.replace(/^\s+|\s+$/g, '').split("");

    hiddenElement = textElement.clone(); //copies font settings and width
    hiddenElement.empty();//clear text
    hiddenElement.css("visibility", "hidden");
    hiddenElement.css("width", "auto"); //so width can be measured
    hiddenElement.css("display", "inline-block"); //so width can be measured

    jQuery('body').append(hiddenElement); // doesn't exist until inserted into document

    if(width == 0) { //if width is 0 index is at start
        caretIndex = line.startIndex;
    } else {// else loop through each character until width is reached
        hiddenElement.empty();
        jQuery.each(lineCharacters, function() {
            text = hiddenElement.text();
            prevWidth = hiddenElement.width();
            hiddenElement.text(text + this);
            elWidth = hiddenElement.width();
            caretIndex = hiddenElement.text().length + line.startIndex;
            if(hiddenElement.width() > width) {
                // check whether character after width or before width is closest
                if(Math.abs(width - prevWidth) < Math.abs(width - elWidth)) {
                   caretIndex = caretIndex -1; // move index back one if previous is closes
                }
                return false;
            }
        });
    }
    hiddenElement.remove();
    return caretIndex;
} 
```

* * *

使用以下 keydown 函数足以在 contenteditable 段落之间非常准确地遍历：

```
$(document).on('keydown', 'p[contenteditable="true"]', function(e) {
    //if cursor on first line & up arrow key
    if(e.which == 38 && (cursorIndex() < $(this).lines()[0].text.length)) { 
        e.preventDefault();
        if ($(this).prev().is('p')) {
            prev = $(this).prev('p');
            getDistanceToCaret = distanceToCaret($(this), cursorIndex());
            lineNumber = prev.lines().length;
            caretPosition = getCaretViaWidth(prev, lineNumber, getDistanceToCaret);
            prev.focus();
            setCaret(prev.get(0), caretPosition);
        }
    // if cursor on last line & down arrow
    } else if(e.which == 40 && cursorIndex() >= $(this).lastLine().startIndex && cursorIndex() <= ($(this).lastLine().startIndex + $(this).lastLine().text.length)) {
        e.preventDefault();
        if ($(this).next().is('p')) {
            next = $(this).next('p');
            getDistanceToCaret = distanceToCaret($(this), cursorIndex());
            caretPosition = getCaretViaWidth(next, 1, getDistanceToCaret);
            next.focus();
            setCaret(next.get(0), caretPosition);
        }
        //if start of paragraph and left arrow
    } else if(e.which == 37 && cursorIndex() == 0) {
        e.preventDefault();
        if ($(this).prev().is('p')) {
            prev = $(this).prev('p');
            prev.focus();
            setCaret(prev.get(0), prev.text().length); 
        }
        // if end of paragraph and right arrow
    } else if(e.which == 39 && cursorIndex() == $(this).text().length) {
        e.preventDefault();
        if ($(this).next().is('p')) {
            $(this).next('p').focus();
        }
    }; 
```

# jquery - jquery ajax call fails with 401 unauthorized

> ID：16194828
> 
> 赞同：0
> 
> 时间：2013-04-24T14:35:43.840
> 
> 标签：jquery, ajax, post, httpwebrequest, webmethod

I have a jquery ajax POST to a code-behind webmethod. In that webmethod i do a HttpWebRequest to a third party web api service that returns json. Even though the httpwebrequest works fine, a popup appears in the browser asking me to enter credentials (authentication required). On my machine this works well, however when deployed it doesn't except if there is no data returned from the httpwebrequest call.

The jquery call:

```
function serverCall(httpMethod, pageName, methodName, inputData, successCallback, errorCallback, disableGlobalAjaxEvents) {

    // Construct the url
    var url = pageName + "/" + methodName;    

    var triggerGlobalEvents = true;
    if (disableGlobalAjaxEvents && disableGlobalAjaxEvents == true) {
        triggerGlobalEvents = false;
    }

    $.ajax({
        type: httpMethod,
        url: url,
        data: JSON.stringify(inputData),
        contentType: "application/json; charset=utf-8",
        global: triggerGlobalEvents,
        dataType: "json",
        success: function(msg) {
            if (successCallback) {

                var parsedObject = JSON.parse(msg.d);
                successCallback(parsedObject);
            }
        },
        error: function(error, status) {
            if (errorCallback) {
                errorCallback(error, status);
            }
        }
    }); 
```

And here is the actual call:

```
serverCall("POST", "SomePage.aspx", "GetSomething", inpuData, onSuccess, onError, true); 
```

The webmethod:

```
 [WebMethod(
          CacheDuration = 5,
          EnableSession = true)]
        public static string GetSomething(string user, string item)
{
// In the body i do the HTTPWebRequest that returns JSON
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T07:27:25.047

Ok, problem is solved. It wasn't a security issue after all but a serialization issue. In the webmethod i stored the received object (via HttpWebRequest) in the ASP.NET Session. When deployed, the session is stored in a db and hence the serialization problem. On my machine I used inproc session, that is why it worked on my machine.

# android - 在 Android 4.0 后台录制视频

> ID：16194830
> 
> 赞同：0
> 
> 时间：2013-04-24T14:35:59.933
> 
> 标签：android, android-intent, android-camera, android-service, android-4.0-ice-cream-sandwich

我正在尝试使用*Activity*和*Service*在后台录制视频，但是我无法使其正常工作。该应用程序只显示按钮然后关闭。我在 Galaxy SII Android 4.0.3 上运行它，以下是错误和源代码。

日志猫

```
04-24 22:27:10.158: E/MediaRecorder(28177): start failed: -19
04-24 22:27:10.158: D/AndroidRuntime(28177): Shutting down VM
04-24 22:27:10.158: W/dalvikvm(28177): threadid=1: thread exiting with uncaught exception (group=0x40c511f8)
04-24 22:27:10.158: E/AndroidRuntime(28177): FATAL EXCEPTION: main
04-24 22:27:10.158: E/AndroidRuntime(28177): java.lang.RuntimeException: Unable to start service com.example.transfertofile.RecorderService@41519328 with Intent { flg=0x10000000 cmp=com.example.transfertofile/.RecorderService }: java.lang.RuntimeException: start failed.
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2388)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.app.ActivityThread.access$1900(ActivityThread.java:127)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1222)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.os.Looper.loop(Looper.java:137)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.app.ActivityThread.main(ActivityThread.java:4507)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at java.lang.reflect.Method.invokeNative(Native Method)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at java.lang.reflect.Method.invoke(Method.java:511)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at dalvik.system.NativeStart.main(Native Method)
04-24 22:27:10.158: E/AndroidRuntime(28177): Caused by: java.lang.RuntimeException: start failed.
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.media.MediaRecorder.start(Native Method)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at com.example.transfertofile.RecorderService.startRecording(RecorderService.java:107)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at com.example.transfertofile.RecorderService.onStartCommand(RecorderService.java:48)
04-24 22:27:10.158: E/AndroidRuntime(28177):    at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2371)
04-24 22:27:10.158: E/AndroidRuntime(28177):    ... 10 more 
```

CameraRecorder.java

```
public class CameraRecorder extends Activity implements SurfaceHolder.Callback {
    protected void onResume(){
        super.onResume() ;
        setContentView(R.layout.main);

        mSurfaceView = (SurfaceView) findViewById(R.id.surfaceView1);
        mSurfaceHolder = mSurfaceView.getHolder();
        mSurfaceHolder.addCallback(this);
        mSurfaceHolder.setType(SurfaceHolder.SURFACE_TYPE_PUSH_BUFFERS);

        Log.v(TAG, "onresume");
        Runnable task = new Runnable() {
            public void run() {
                // do something

                if (mPreviewRunning) {
                    mPreviewRunning = !mPreviewRunning;
                    stopService(new Intent(CameraRecorder.this, RecorderService.class));
                    Log.v(TAG, "running");
                    finish();
                }
                else {
                    mPreviewRunning = !mPreviewRunning;
                    Intent intent = new Intent(CameraRecorder.this, RecorderService.class);
                    intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
                    startService(intent);
                    Log.v(TAG, "notrunning");
                    finish();
                }
             }
        };
        worker.schedule(task, 100, TimeUnit.MILLISECONDS);
    }
} 
```

记录服务.java

```
public class RecorderService extends Service {
private static final String TAG = "RecorderService";
private SurfaceView mSurfaceView;
private SurfaceHolder mSurfaceHolder;
private static Camera mServiceCamera;
private boolean mRecordingStatus;
private MediaRecorder mMediaRecorder;

@Override
public void onCreate() {
    Log.v(TAG, "oncreate");
    mRecordingStatus = false;
    mServiceCamera = CameraRecorder.mCamera;
    mSurfaceView = CameraRecorder.mSurfaceView;
    mSurfaceHolder = CameraRecorder.mSurfaceHolder;

    super.onCreate();
}

@Override
public IBinder onBind(Intent intent) {
    // TODO Auto-generated method stub
    return null;
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Log.v(TAG, "onstartcom");
    super.onStartCommand(intent, flags, startId);
    if (mRecordingStatus == false)
        startRecording();

    return START_NOT_STICKY;
}

@Override
public void onDestroy() {
    Log.v(TAG, "ondestroy");
    stopRecording();
    mRecordingStatus = false;

    super.onDestroy();
}   

public boolean startRecording(){
    try {
        Log.v(TAG, "startrecording");
        Toast.makeText(getBaseContext(), "Recording Started", Toast.LENGTH_SHORT).show();

        mServiceCamera = Camera.open();
        Camera.Parameters params = mServiceCamera.getParameters();
        mServiceCamera.setParameters(params);
        Camera.Parameters p = mServiceCamera.getParameters();

        final List<Size> listSize = p.getSupportedPreviewSizes();
        Size mPreviewSize = listSize.get(2);
        Log.v(TAG, "use: width = " + mPreviewSize.width 
                    + " height = " + mPreviewSize.height);
        p.setPreviewSize(mPreviewSize.width, mPreviewSize.height);
        p.setPreviewFormat(PixelFormat.YCbCr_420_SP);
        mServiceCamera.setParameters(p);
        Log.v(TAG, "setparams");

        try {
            mServiceCamera.setPreviewDisplay(mSurfaceHolder);
            mServiceCamera.startPreview();
            Log.v(TAG, "setpreview");
        }
        catch (IOException e) {
            Log.e(TAG, e.getMessage() + "woo");
            e.printStackTrace();
        }

        mServiceCamera.unlock();
        Log.v(TAG, "camunlock");

        mMediaRecorder = new MediaRecorder();
        mMediaRecorder.setCamera(mServiceCamera);
        mMediaRecorder.setAudioSource(MediaRecorder.AudioSource.MIC);
        mMediaRecorder.setVideoSource(MediaRecorder.VideoSource.CAMERA);
        mMediaRecorder.setOutputFormat(MediaRecorder.OutputFormat.MPEG_4);
        mMediaRecorder.setAudioEncoder(MediaRecorder.AudioEncoder.DEFAULT);
        mMediaRecorder.setVideoEncoder(MediaRecorder.VideoEncoder.DEFAULT);
        mMediaRecorder.setOutputFile("/sdcard/video.mp4");
        mMediaRecorder.setVideoFrameRate(30);
        mMediaRecorder.setVideoSize(mPreviewSize.width, mPreviewSize.height);
        mMediaRecorder.setPreviewDisplay(mSurfaceHolder.getSurface());

        mMediaRecorder.prepare();
        mMediaRecorder.start(); 

        mRecordingStatus = true;

        return true;
    } catch (IllegalStateException e) {
        Log.d(TAG, e.getMessage());
        e.printStackTrace();
        return false;
    } catch (IOException e) {
        Log.d(TAG, e.getMessage());
        e.printStackTrace();
        return false;
    }
}

public void stopRecording() {
    Toast.makeText(getBaseContext(), "Recording Stopped", Toast.LENGTH_SHORT).show();
    try {
        mServiceCamera.reconnect();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    mMediaRecorder.stop();
    mMediaRecorder.reset();

    mServiceCamera.stopPreview();
    mMediaRecorder.release();

    mServiceCamera.release();
    mServiceCamera = null;
} 
```

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.transfertofile"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk android:minSdkVersion="8" android:targetSdkVersion="17" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.RECORD_AUDIO" />
    <uses-permission android:name="android.permission.CAMERA" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <uses-feature android:name="android.hardware.camera" />
    <uses-feature android:name="android.hardware.camera.autofocus" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme"  >
        <activity
            android:name="com.example.transfertofile.CameraRecorder"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:name="com.example.transfertofile.RecorderService"></service>

    </application>

</manifest> 
```

源代码来自：[https ://github.com/pickerweng/CameraRecorder](https://github.com/pickerweng/CameraRecorder)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-16T07:12:08.717

请在清单文件中添加以下权限。

```
<uses-permission android:name="android.permission.RECORD_VIDEO" /> 
```

# python - df.columns 和 df2.columns 是同一个对象吗？

> ID：16194831
> 
> 赞同：4
> 
> 时间：2013-04-24T14:36:02.177
> 
> 标签：python, pandas

我有一个数据框`df2`，它是另一个数据框的副本：

```
In [5]: df = DataFrame({"A":[1,2,3],"B":[4,5,6],"C":[7,8,9]})
In [6]: df
Out[6]:
   A  B  C
0  1  4  7
1  2  5  8
2  3  6  9

In [7]: df2 = df.copy() 
```

因此**不是**同一个对象：

```
In [8]: df is df2
Out[8]: False

In [9]: hex(id(df))
Out[9]: '0x89c6550L'

In [10]: hex(id(df2))
Out[10]: '0x89c6a58L' 
```

我的问题是关于这两个数据框的列。为什么返回的列对象`df.columns`是`df2.columns`同一个对象？

```
In [11]: df.columns is df2.columns
Out[11]: True

In [12]: hex(id(df.columns))
Out[12]: '0x89bfb38L'

In [13]: hex(id(df2.columns))
Out[13]: '0x89bfb38L' 
```

但是，如果我进行更改，那么它们会成为两个独立的对象吗？

```
In [14]: df2.rename(columns={"B":"D"}, inplace=True)

In [15]: df.columns
Out[15]: Index([A, B, C], dtype=object)

In [16]: df2.columns
Out[16]: Index([A, D, C], dtype=object)

In [17]: df.columns is df2.columns 
Out[17]: False

In [18]: hex(id(df.columns))
Out[18]: '0x89bfb38L'

In [19]: hex(id(df2.columns))
Out[19]: '0x89bfc88L' 
```

有人可以解释这里发生了什么吗？为什么不是从一开始就`df.columns`和`df2.columns`两个独立的对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T15:45:44.600

df.columns 是一个索引对象。

这些是不可变对象（有点像字符串/整数是不可变的。您可以更改对对象的引用，但不能更改实际对象）。

这允许共享并因此提高性能效率（并且您在复制索引时不需要实际复制内存）。当您“更改”一个对象时，您实际上得到了一个新对象（而不是对原始对象的引用）

几乎所有的 pandas 操作都会返回一个新对象，请参见此处： http: [//pandas.pydata.org/pandas-docs/stable/basics.html#copying](http://pandas.pydata.org/pandas-docs/stable/basics.html#copying)

所以`rename`相当于复制然后分配给索引（列和/或索引，无论您要更改什么）。但是，这种分配行为会创建一个新的索引对象。（所以`rename`只是这个操作的一种方便方法）

# git - 避免意外删除 git 存储库的权限

> ID：16194833
> 
> 赞同：0
> 
> 时间：2013-04-24T14:36:09.897
> 
> 标签：git, permissions

我们在文件系统路径上有一些 git 存储库。所有这些存储库的权限都是 755。

已使用以下方式共享存储库：

git init --shared=0775

之所以需要这样做，是因为存储库与属于同一 unix 组的多个用户共享。

用户使用文件系统路径克隆存储库：

git clone /path/to/git/repository

这种方法的最大潜在风险是，任何用户都可以从存储库本身中删除整个 .git 文件夹。

如何减轻这种风险？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T18:15:23.087

一些想法：

*   文件系统的老式备份
*   定期推送到另一台机器上的远程存储库
*   仅仅依靠数量上的安全性——如果中央存储库被删除，很可能所有重要信息都已存储在一个或多个用户存储库中，因此可以从中重建中央存储库。

# java - 调用 .next() 方法时扫描仪 NoSuchElementException

> ID：16194834
> 
> 赞同：0
> 
> 时间：2013-04-24T14:36:15.460
> 
> 标签：java, file, nosuchelementexception

在 Java 中，我得到了这个异常：

```
Exception in thread "main" java.util.NoSuchElementException
    at java.util.Scanner.throwFor(Unknown Source)
    at java.util.Scanner.next(Unknown Source)
    at com.reading.text.Activity3.readFile(Activity3.java:22)
    at com.reading.text.Activity3.main(Activity3.java:10) 
```

从此Java代码：

```
public static void main(String args[])
{
    readFile("C:/Users/forsakendoll/Desktop/boom.txt");
}

public static void readFile(String path) {
    Scanner file = null;
    try {
        file = new Scanner(new File (path));
    } catch (FileNotFoundException e) {
        e.printStackTrace();
    } finally {
        while (file.hasNext()) {
            for(int counter = 0 ; counter < file.next().length(); counter ++) {
                System.out.println(file.next().charAt(counter));    
            }
        }
    }
} 
```

抛出异常

> System.out.println(file.next().charAt(counter));

异常是什么意思？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:40:06.217

您在循环的每次迭代中都调用`.next()`了两次，所以当您接近结尾时，您会跳出列表的末尾，编译器会告诉您那里什么都没有。

而不是这个：

```
for(int counter = 0 ; counter < file.next().length(); counter ++) {
    System.out.println(`file.next()`.charAt(counter));    
} 
```

改为这样做：

```
String temp = file.next();
for(int counter = 0 ; counter < next.length(); counter ++) {
    System.out.println(temp .charAt(counter));    
} 
```

[**看这里**](https://stackoverflow.com/questions/8032099/no-such-element-exception)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:38:37.227

**不要多次调用 next() ！**当您调用它时，它实际上会转到下一个元素。如果您需要多次使用它，请将其放在变量中并使用它。

```
 String next = file.next();
        for(int counter = 0 ; counter < next.length(); counter ++) {
            System.out.println(next.charAt(counter));    
        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:39:54.447

Scanner.next() 方法将内部迭代器沿一个移动。您的代码应该是：

```
public static void readFile(String path) {
    Scanner file = null;
    try {
        file = new Scanner(new File (path));
    } catch (FileNotFoundException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } finally {
        while (file.hasNext()) {
            String next = file.next();
            for(int counter = 0 ; counter < next.length(); counter ++) {
                System.out.println(next.charAt(counter));    
            }
        }
    }
} 
```

# regex - GNU Sed REGEX 查找和更改字符串（无替换）

> ID：16194836
> 
> 赞同：0
> 
> 时间：2013-04-24T14:36:25.853
> 
> 标签：regex, sed

我有以下文字：

```
11 Cherrywood Rise Ashford Kent TN25 4QA United Kingdom N B BONE 02/12 387
Bisham village Bisham Buckinghamshire SL7 1RR United Kingdom Neil Noakes 06/13 488
6 Kynaston Road London London N16 0EX United Kingdom MR N P SALTMARSH 04/13 907
116 Long Acre London London WC2E 9SU United Kingdom Lorna J Gradden 11/14 415 
```

如何使用 sed 匹配日期“mm/yy”格式并更改为“|mm/yy|”

喜欢：`11 Cherrywood Rise Ashford Kent TN25 4QA United Kingdom N B BONE|02/12|387`

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:42:11.850

这对你有用吗？

```
sed -r 's# ([0-9]{2}/[0-9]{2}) #|\1|#' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:46:30.367

示例 1

```
cat t.txt | sed -E 's/([0-9]{2}\/[0-9]{2})/|\1|/g' 
```

11 Cherrywood Rise Ashford Kent TN25 4QA 英国 NB BONE (02/12) 387 Bisham village Bisham Buckinghamshire SL7 1RR 英国 Neil Noakes (06/13) 488 6 Kynaston Road London London N16 0EX United Kingdom MR NP SALTMARSH (04/13) 907 116 Long Acre 伦敦 London WC2E 9SU 英国 Lorna J Gradden (11/14) 415

或者

```
sed -E 's/([0-9]{2}\/[0-9]{2})/|\1|/g' t.txt 
```

# mysql - 选择时间在指定时间的 -1 到 5 分钟之间的位置

> ID：16194837
> 
> 赞同：1
> 
> 时间：2013-04-24T14:36:25.937
> 
> 标签：mysql, sql, time

我想从 mySQL 数据库中选择行，其中当前时间相对于行中的“endTime”字段在 -1 到 5 分钟之间。

“endTime”字段是“时间”类型。

这是我当前的非工作代码：

```
SELECT  *
FROM    table
WHERE   endTime
            BETWEEN
                DATE_ADD(NOW(), INTERVAL -1 MINUTE)
            AND
                DATE_ADD(NOW(), INTERVAL 5 MINUTE) 
```

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T01:08:51.453

我自己解决了：

```
SELECT  *
FROM    table
WHERE   endTime
            > DATE_SUB(CURRENT_TIMESTAMP, INTERVAL 1 MINUTE)
AND     endTime
            < DATE_ADD(CURRENT_TIMESTAMP, INTERVAL 5 MINUTE) 
```

发布此内容以防其他人发现它有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-10T17:05:30.710

可能有点晚了-但这会起作用并且更简洁：

```
SELECT * FROM table WHERE endTime BETWEEN DATE_SUB(NOW(), INTERVAL 5 MINUTE) AND NOW() 
```

# clojure - math.combinatorics 中的 Clojure 惰性序列导致 OutOfMemory (OOM) 错误

> ID：16194841
> 
> 赞同：7
> 
> 时间：2013-04-24T14:36:36.670
> 
> 标签：clojure, lazy-evaluation

[math.combinatorics](https://github.com/clojure/math.combinatorics)的文档指出所有函数都返回惰性序列。

但是，如果我尝试运行包含大量数据的[子集，](https://github.com/clojure/math.combinatorics/blob/master/src/main/clojure/clojure/math/combinatorics.clj#L80)

```
(last (combinatorics/subsets (range 20)))
;OutOfMemoryError Java heap space  clojure.lang.RT.cons (RT.java:559) 
```

我收到 OutOfMemory 错误。

跑步

```
(last (range)) 
```

烧CPU，但不返回错误。

Clojure 似乎并没有像[Stack Overflow question 中解释的](https://stackoverflow.com/questions/1756563/clojure-lazy-magic)那样“保持头脑清醒” 。

为什么会发生这种情况以及如何在子集中使用更大的范围？

**更新**

正如评论所暗示的那样，它似乎适用于某些人的计算机。所以我将发布我的系统配置

我运行 Mac (10.8.3) 并使用[Homebrew安装了](https://en.wikipedia.org/wiki/Homebrew_%28package_management_software%29)[Clojure](http://en.wikipedia.org/wiki/Clojure) (1.5.1) 。

我的Java版本是：

```
% java -version
java version "1.6.0_45"
Java(TM) SE Runtime Environment (build 1.6.0_45-b06-451-11M4406)
Java HotSpot(TM) 64-Bit Server VM (build 20.45-b01-451, mixed mode) 
```

我没有更改任何默认设置。我还通过删除`~/.m2`文件夹重新安装了所有依赖项。

我的[项目.clj](https://gist.github.com/mren/1016597fbca4635dde3c)。

我使用的命令是这个

```
% lein repl
nREPL server started on port 61774
REPL-y 0.1.10
Clojure 1.5.1
=> (require 'clojure.math.combinatorics)
nil
=> (last (clojure.math.combinatorics/subsets (range 20)))
OutOfMemoryError Java heap space  clojure.lang.RT.cons (RT.java:570)
or
OutOfMemoryError Java heap space  clojure.math.combinatorics/index-combinations/fn--1148/step--1164 (combinatorics.clj:64) 
```

我在同事的笔记本电脑上测试了这个问题，他也遇到了同样的问题，但他也在 Mac 上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-29T21:42:26.710

您想计算具有 1000 个元素的集合的幂集吗？你知道这将有 2^1000 个元素，对吧？那太大了，我什至找不到一个好的方法来描述它有多大。如果您尝试使用这样的集合，并且您可以懒惰地这样做，那么您的问题将不是内存：而是计算时间。假设您有一台具有无限内存的超级计算机，每纳秒能够处理一万亿个项目：即每秒处理 10^21 个项目，或每年大约 10^29 个项目。即使是这台超级计算机也需要比宇宙的生命周期长得多的时间来处理`(subsets (range 1000))`.

所以我想说，不要再担心这个集合的内存使用情况，而是研究一种算法，它不涉及遍历元素多于宇宙中原子数的序列。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-29T01:44:55.117

问题是`subsets`使用`mapcat`, 并且`mapcat`不够懒惰，因为它使用 apply 来实现并保存一些要连接的元素。在这里看到[一个很好的解释](http://clojurian.blogspot.co.uk/2012/11/beware-of-mapcat.html)。在子集中使用该链接的惰性 mapcat 版本应该可以解决问题：

```
(defn my-mapcat
   [f coll]
   (lazy-seq
     (if (not-empty coll)
      (concat
      (f (first coll))
     (my-mapcat f (rest coll))))))

(defn subsets
  "All the subsets of items"
  [items]
  (my-mapcat (fn [n] (clojure.math.combinatorics/combinations items n))
  (range (inc (count items)))))

 (last (subsets (range 50))) ;; this will take hours to compute, good luck with it! 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-07-20T10:47:15.943

问题既不是 with `apply`，也不是 with `concat`，也不是 with `mapcat`。

[dAni 的答案](https://stackoverflow.com/a/16270113/244935)，他重新实现的地方`mapcat`，确实意外地解决了问题，但其背后的推理不正确。另外，他的回答指向了一篇文章，作者说*“我相信问题在于应用”*。**这显然是错误的，正如我将在下面解释的那样**。最后，手头的问题与[另一个](https://stackoverflow.com/questions/4290665/does-concat-break-the-laziness-of-line-seq)无关，非懒惰评估**确实**是由`apply`.

如果你仔细观察，dAni 和那篇文章的作者都在`mapcat`没有使用该`map`函数的情况下实现。我将在下一个示例中展示该问题与`map`函数的实现方式有关。

为了证明该问题与任何一个都无关，`apply`或者`concat`请参阅以下`mapcat`. 它同时使用`concat`和`apply`，但仍然实现了完全的惰性：

```
(defn map
  ([f coll]
     (lazy-seq
      (when-let [s (seq coll)]
        (cons (f (first s)) (map f (rest s)))))))

(defn mapcat [f & colls]
  (apply concat (apply map f colls)))

(defn range-announce! [x]
  (do (println "Returning sequence of" x)
      (range x)))

;; new fully lazy implementation prints only 5 lines
(nth (mapcat range-announce! (range)) 5)

;; clojure.core version still prints 32 lines
(nth (clojure.core/mapcat range-announce! (range)) 5) 
```

上面代码中的完全惰性是通过重新实现`map`函数来实现的。事实上，`mapcat`它的实现方式与 in[完全相同](https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj)`clojure.core`，但它完全是惰性的。为了示例，上面的`map`实现稍微简化了一点，因为它只支持单个参数，但即使使用整个可变参数签名来实现它也会起作用：**完全懒惰**。所以我们证明了这里的问题既不是 with`apply`也不是 with `concat`。此外，我们展示了真正的问题必须与`map`函数在`clojure.core`. 让我们看一下：

```
(defn map
  ([f coll]
   (lazy-seq
    (when-let [s (seq coll)]
      (if (chunked-seq? s)
        (let [c (chunk-first s)
              size (int (count c))
              b (chunk-buffer size)]
          (dotimes [i size]
              (chunk-append b (f (.nth c i))))
          (chunk-cons (chunk b) (map f (chunk-rest s))))
        (cons (f (first s)) (map f (rest s)))))))) 
```

可以看出，`clojure.core`实现和我们之前的“简化”版本完全一样，除了表达式的`true`分支。`if (chunked-seq? s)`本质`clojure.core/map`上具有处理*分块序列*的输入序列的特殊情况。

分块序列通过评估 32 个块而不是一次严格地评估一个来降低惰性。在评估深度嵌套的分块序列时，这变得非常明显，例如`subsets`. Clojure 1.1 中引入了分块序列，并且升级了许多核心功能以以不同方式识别和处理它们，包括`map`. 引入它们的主要目的是提高某些流处理场景的性能，但可以说它们使推理程序的惰性特征变得更加困难。[您可以在此处](http://www.infoq.com/news/2009/12/clojure-11-rc1-transients)和[此处](http://blog.fogus.me/2010/01/22/de-chunkifying-sequences-in-clojure/)阅读分块序列。[也在这里](https://stackoverflow.com/questions/3407876/how-do-i-avoid-clojures-chunking-behavior-for-lazy-seqs-that-i-want-to-short-ci)查看这个问题。

真正的问题是它`range`返回一个分块的序列，并由`subsets`. [David James](https://stackoverflow.com/a/17275160/244935)推荐的修复补丁`subsets`来*取消*内部创建的序列`range`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-24T12:11:13.387

此问题已在项目的票证跟踪器上提出：[Clojure JIRA: OutOfMemoryError with combinatorics/subsets](http://dev.clojure.org/jira/browse/MCOMB-2)。在那里，您可以找到 Andy Fingerhut 的补丁。它对我有用。请注意，该补丁不同于[另一个答案建议的 mapcat 变体](https://stackoverflow.com/a/16270113/109618)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-29T15:15:08.147

在没有命令行参数的情况下，JVM 的启动堆大小参数由各种*人体工程学决定*

默认值（JDK 6）是

```

   初始堆大小内存 / 64
   最大堆大小 MIN(内存 / 4, 1GB)

```

`-Xmx`但是您可以使用和`-Xms`args强制使用绝对值您可以[在此处找到更多详细信息](http://www.oracle.com/technetwork/java/javase/gc-tuning-6-140523.html#par_gc.ergonomics.default_size "这里")

# c# - C# 打开文件

> ID：16194844
> 
> 赞同：0
> 
> 时间：2013-04-24T14:36:44.620
> 
> 标签：c#

我为自己编写了一个小程序，用于读取相当大的日志文件（只是纯文本和数字）并将它们写在文本框中（记事本）。

我使用这种方法来读取文件，虽然它可以解决问题，但我想知道是否有某种方法可以优化它，以及当前正在读取的文件是否在读取时被锁定而无法写入（因为它是不断存在的日志文件更新这对我不好）。

```
 private void ReadFile(string path)
    {
        using (FileStream file = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
        using (StreamReader reader = new StreamReader(file))
        {
            StringBuilder sb = new StringBuilder();
            string r = reader.ReadLine();

            while (r != null)
            {
                sb.Append(r);
                sb.Append(Environment.NewLine);
                r = reader.ReadLine();
            }
            textBox.Text = sb.ToString();
            reader.Close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:40:39.170

我在[这里](https://stackoverflow.com/questions/3709104/read-file-which-is-in-use)发布的问题中找到了一些建议，您的代码已经确认第一个建议，所以我会尝试使用

```
File.OpenRead(path) 
```

看看这是否适合你。

如果它没有，那么显然写入文件的程序根本不允许你读取它，只要它有一个句柄。您可能会注意到`FileShare.ReadWrite`它告诉系统其他程序可以对该文件做什么，正在写入日志的程序可能根本不允许您读取该文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:40:22.293

尝试这个：

```
using System;
using System.IO;

namespace csharp_station.howto
{
    class TextFileReader
    {
        static void Main(string[] args)
        {
            // create reader & open file
            Textreader tr = new StreamReader("date.txt");

            // read a line of text
            Console.WriteLine(tr.ReadLine());

            // close the stream
            tr.Close();

            // create a writer and open the file
            TextWriter tw = new StreamWriter("date.txt");

            // write a line of text to the file
            tw.WriteLine(DateTime.Now);

            // close the stream
            tw.Close();
        }
    }
} 
```

这将是最简单的方法。而且我认为您的代码对我来说看起来不错。通过将日志文件读入文本框，我没有看到问题。您可以尝试通过使用威胁来同时执行此操作....

# jersey - WL12c 上的 Jersey：在 war 中嵌入 jersey jar 时找到资源，但在使用 WebLogic 堆栈时找不到

> ID：16194848
> 
> 赞同：1
> 
> 时间：2013-04-24T14:36:49.753
> 
> 标签：jersey, weblogic

我有一个使用 Jersey 实现运行 JAX-RS Web 服务的 Web 应用程序。目标应用服务器是 WebLogic 12c，其默认 JAXRS 实现是 Jersey v1.9。

1) 当在 Jetty (6.1.26) 上运行时，依赖 jersey-server-1.9，一切都很好。

2) 当在 WebLogic 12c 上运行 jersey-core.jar + jersey-server.jar (v1.9) jar 都嵌入在我的战争的 WEB-INF/lib 中时，它也可以工作。

2) 当在 WebLogic 12c 上运行时，从这 2 个 jar 中截断相同的战争（假设 weblogic Java EE 堆栈已经提供了不需要的），它不再工作了。我收到以下错误：

*“weblogic.application.ModuleException：[HTTP:101216]Servlet：“jersey-servlet”无法在 Web 应用程序启动时预加载：“cachede-newgen.war”。com.sun.jersey.api.container.ContainerException：ResourceConfig实例不包含任何根资源类。在 com.sun.jersey.server.impl.application.RootResourceUriRules.(RootResourceUriRules.java:99)"*

不用说，泽西版本在所有三种情况下都是*完全相同的：*

“2013 年 4 月 24 日下午 4:10:24 com.sun.jersey.server.impl.application.WebApplicationImpl _initiate INFO：启动 Jersey 应用程序，版本 'Jersey：1.9 09/02/2011 上午 11:17'”

它再次听起来（视觉！）像一个类路径或类加载器问题:-(

任何想法或解决方法来解决这个问题（考虑到我不想在每次部署的战争中重复球衣罐）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-25T13:13:33.807

好的，我找到了原因:-) - “better_use_mkstemp”让我朝着正确的方向前进（很多谢谢！）。

该解决方案包括在weblogic 描述符文件中**添加**对已部署 Jersey 版本的引用：

```
<library-ref>  
    <library-name>jersey-bundle</library-name>  
    <specification-version>1.1.1</specification-version>  
    <implementation-version>1.1.5.1</implementation-version>  
</library-ref> 
```

奇怪的是，如果没有这样的引用，错误消息（即“ *ResourceConfig 实例不包含任何根资源类*”）给人的感觉是 Jersey 能够启动并扫描您的注释类......

注意：实际上，您还需要参考 JSR-311 api，如下所述：http: [//theblasfrompas.blogspot.be/2011/03/time-to-deploy-restful-web-service-from.html](http://theblasfrompas.blogspot.be/2011/03/time-to-deploy-restful-web-service-from.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:47:19.210

您是否已将球衣罐“部署”到您的服务器？在管理控制台中转到 Deployables（单击自定义表并取消选中排除库）。看看那里是否列出了泽西岛。如果没有，您将需要“部署”它并定位您需要它的任何服务器。然后尝试重新部署您的战争文件。

泽西岛应该住在：

```
wlserver_10.3/common/deployable-libraries 
```

这些共享库不会自动提供给您的服务器，直到它们被定位到它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-12T06:37:42.417

只需移除所有 Jersey jar 并添加一个 Jersey Bundle jar 即可。在将 Jersey Bundle jar 添加到类路径后，我遇到了同样的问题并解决了。

# jakarta-ee - Websphere 上每个持久性单元生成的重复类加载器

> ID：16194850
> 
> 赞同：1
> 
> 时间：2013-04-24T14:36:52.940
> 
> 标签：jakarta-ee, jpa, ejb, websphere, persistence.xml

我们在 WAS 8.5 上运行 EAR，我们的每个 DAO 都重复了 31 次。注意到我们的 persistence.xml 有 30 个 JNDI 数据源，我测试了减少数量，实际上重复计数减少了。

但是我已经尝试连续删除所有多余的行，但我仍然得到重复项。不过，删除最后一行会给我一个 NestedJarException。

```
 <persistence-unit name="unitTest"
          transaction-type="JTA">    
          <jta-data-source>jdbc/Testing/Ds</jta-data-source>
          <mapping-file>META-INF/default-mappings.xml</mapping-file>
          <exclude-unlisted-classes>false</exclude-unlisted-classes>
   </persistence-unit> 
```

有谁知道可能导致我的 EJB 类为每个持久性单元重复的其他任何事情？

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:31:11.467

如果您检查[JPA 2.0 规范](http://jcp.org/en/jsr/detail?id=317)第 76 页第 3.2 项“实体实例的生命周期”，如下所示：

> 3.2 实体实例的生命周期 本节介绍EntityManager 操作用于管理实体实例的生命周期。
> 
> 实体实例的特征可以是新的、托管的、分离的或删除的。
> 
> • 新实体实例没有持久标识，并且尚未与持久上下文相关联。
> 
> • 托管实体实例是具有当前与持久性上下文相关联的持久性身份的实例。
> 
> • 分离实体实例是具有不（或不再）与持久性上下文相关联的持久身份的实例。
> 
> • 删除的实体实例是具有持久身份的实例，与持久上下文相关联，将在事务提交时从数据库中删除。

比我想象的你的情况意味着你有 30 个 jpa 持久对象，每个对象映射为 1 个持久上下文（持久标识），指向每个数据库，你可能有 1 个没有持久标识的分离和/或新对象。

发生这种情况是因为规范如何确定应实施的实体实例生命周期。

问候

# sinatra - 如何使用 Sinatra 提供 500 个页面？

> ID：16194851
> 
> 赞同：2
> 
> 时间：2013-04-24T14:37:03.600
> 
> 标签：sinatra, rack

由于 Sintra 是一个 Rack 应用程序，我认为它可以使用 Rack 方式：

```
get '/' do
      result = true
      if result 
             ['200', {'Content-Type' => 'application/json'}, [{result:true}.to_  json]]
         else
             binding.pry
             ['500', {'Content-Type' => 'application/json'}, [{result:false}.to  _json]] 
         end    
end 
```

它不起作用，它总是返回一个`500`页面，无论变量是`true`还是`false`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:45:10.613

如果您的应用程序中确实有此文字代码：

```
{result:true}.to_  json # <<< whitespace that shouldn't be there 
```

然后您的代码将出现运行时异常（可能缺少方法`to_`或`unknown variable or method json`），这就是您每次都会收到 500 错误的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-17T21:39:16.787

您可以像这样返回一个类似 Rack 的数组作为响应，但数组的第一项需要是`Fixnum`特定的，而不仅仅是在解析时会产生数字的东西`to_i`。Sinatra[检查条目的类型](https://github.com/sinatra/sinatra/blob/1.4.2/lib/sinatra/base.rb#L1037)以确定如何处理响应。

您的响应在“纯” Rack 应用程序中有效，但在 Sinatra 中无效。可以说这是 Sinatra 中的一个错误，或者至少是[说任何有效的 Rack 响应都是有效](http://www.sinatrarb.com/intro.html#Return%20Values)的文档。

Sinatra 尝试将整个数组作为响应的主体返回（因为它响应`each`），但在尝试处理数组时失败，因为内容并非全是字符串。

要修复它，只需将响应中的状态代码从 Strings 更改为 Fixnums：

```
[200, {'Content-Type' => 'application/json'}, [{result:true}.to_json]] 
```

# wix - 我的自定义操作有什么问题？

> ID：16194852
> 
> 赞同：1
> 
> 时间：2013-04-24T14:37:07.220
> 
> 标签：wix, cmd, execution, custom-action

我已经尝试过无数次尝试使用自定义操作来简单地将文件复制到另一个地方。我确实认为这应该很容易解决，但是......我很沮丧，它总是失败！

我发布了我的代码和错误日志，请任何人指出我的出路......提前谢谢你！

```
 <CustomAction Id="QtExecCopyPropertyFileCmd"
                 Property="QtExec64CmdLine" 
                 Value="&quot;[SystemFolder]cmd.exe&quot; /c copy &quot;C:\Program Files\AptWare\AptWare View\Server\broker\webapps\portal\WEB-INF\classes\portal-links.properties&quot; &quot;C:\ProgramData\AptWare\VDM&quot;"/>
  <CustomAction Id="QtExecCopyPropertyFile"
                BinaryKey="WixCA"
                DllEntry="CAQuietExec64"
                Execute="immidiate"
                Return="check"/> 
```

这是我的动作顺序：

```
 <InstallExecuteSequence>
     <Custom Action='SetOldPortalLinkFile' After='InstallInitialize'>NOT (Installed OR PORTALLINKFILEEXISTS) AND OLDPORTALLINKFILEEXISTS</Custom>
     <Custom Action='SetPortalLinkFileDestFolder' After='SetOldPortalLinkFile'>NOT (Installed OR PORTALLINKFILEEXISTS) AND OLDPORTALLINKFILEEXISTS</Custom>
     <Custom Action="QtExecCopyPropertyFileCmd" After="SetPortalLinkFileDestFolder">NOT (Installed OR PORTALLINKFILEEXISTS) AND OLDPORTALLINKFILEEXISTS</Custom>
     <Custom Action="QtExecCopyPropertyFile" After="QtExecCopyPropertyFileCmd">NOT (Installed OR PORTALLINKFILEEXISTS) AND OLDPORTALLINKFILEEXISTS</Custom> 
```

我尝试过的一些方法：

1.  我不认为这是由于 quto 或文件/目录的存在，我从日志中复制了在 cmd shell 中运行的生成的 cmd 它可以工作
2.  它与 32 位或 64 位 CA 无关，我尝试了 32 位和 64 位。都是同样的失败。
3.  我不确定这是否与特权有关，但如果我尝试延迟 CA，仍然出现错误......在我的场景中，我需要一个立即的 CA，因为在卸载以前的版本期间复制的文件将被删除。所以我需要它在 InstallFinalized 之前运行

最后，错误日志：

```
操作 6:22:34: QtExecCopyPropertyFileCmd。

操作开始 6:22:34: QtExecCopyPropertyFileCmd。

MSI (s) (90:88) [06:22:34:743]: Transforming table CustomAction.

MSI (s) (90:88) [06:22:34:743]: PROPERTY CHANGE: Adding QtExec64CmdLine property. Its value is '"C:\Windows\SysWOW64\cmd.exe" /c copy "C:\Program Files\AptWare\AptWare View\Server\broker\webapps\portal\WEB-INF\classes\portal-links.properties" "C:\ProgramData\AptWare\VDM"'.

操作结束 6:22:34: QtExecCopyPropertyFileCmd。返回值 1。

MSI (s) (90:88) [06:22:34:743]: Doing action: QtExecCopyPropertyFile

操作 6:22:34: QtExecCopyPropertyFile。

操作开始 6:22:34: QtExecCopyPropertyFile。

MSI (s) (90:88) [06:22:34:746]: Transforming table CustomAction.

MSI (s) (90:98) [06:22:34:748]: Invoking remote custom action. DLL: C:\Windows\Installer\MSIB138.tmp, Entrypoint: CAQuietExec64

MSI (s) (90:2C) [06:22:34:762]: PROPERTY CHANGE: Deleting QtExec64CmdLine property. Its current value is '"C:\Windows\SysWOW64\cmd.exe" /c copy "C:\Program Files\AptWare\AptWare View\Server\broker\webapps\portal\WEB-INF\classes\portal-links.properties" "C:\ProgramData\AptWare\VDM"'.

CAQuietExec64:  Error 0x80070001: Command line returned an error.

CAQuietExec64:  Error 0x80070001: CAQuietExec64 Failed

CustomAction QtExecCopyPropertyFile returned actual error code 1603 (note this may not be 100% accurate if translation happened inside sandbox) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T08:07:07.387

我现在去回答。 [http://sharp-gamedev.blogspot.com/2009/07/wix-again.html](http://sharp-gamedev.blogspot.com/2009/07/wix-again.html)

在上面的链接中，很明显，CAQuietExec 必须有一些错误来支持构建 dos 命令，例如复制、ren、del 等。但是，使用 xcopy.exe 而不是复制它可以工作，我测试过，它确实有效。我认为对于 ren 或 del 也可以找到其他替换。

对我来说是多么大的陷阱！！

谢谢大家热心回复！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T07:04:08.577

据我了解，您需要先将文件从安装位置复制到另一个位置，然后再在升级中卸载以前的版本。由于升级将删除所有已安装的文件。在这种情况下，试试这个代码。如果您在卸载以前的版本之前安排自定义操作，它将起作用。我用测试项目及其对我的工作进行了尝试。

```
<RemoveExistingProducts Before="InstallInitialize" />
<Custom Action="QtExecCopyPropertyFileCmd" After="AppSearch"> (NOT Installed)</Custom>
<Custom Action="QtExecCopyPropertyFile" After="QtExecCopyPropertyFileCmd"> (NOT Installed)</Custom> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T18:45:13.850

我看到的“错误”是您完全编写了自定义操作。CopyFile 元素支持使用 MoveFile 表来告知 MSI 该文件需要被复制。这将完全支持回滚、升级和卸载故事。当您将进程退出到 dos 命令时，您将失去所有这些。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-07T01:43:00.693

好像您已经找到了解决方案。

但我`copy`几乎和你一样使用，我认为值得分享我的解决方案给任何想要使用`copy`而不是`xcopy`. 我确实从您的链接中尝试过 xcopy 解决方案，但对我来说，xcopy 更适合批量复制，另一方面，我正在复制单个文件，我也想定义自己的目标文件名，但使用 xcopy 与CA（如果可能）。

对于我的项目，我使用`deferred`Execute 而不是`immediate`,`immediate`也是可能的，但语法会有所不同：

```
<!--Syntex for deferred-->
    <!--<Property Id='QtExecCA' Value='"cmd.exe" /c copy C:\temp\test.txt C:\temp\test2.txt' />-->
    <!--Syntex for immediate-->
    <Property Id='QtExecCmdLine' Value='"cmd.exe" /c copy C:\temp\test.txt C:\temp\test2.txt' /><CustomAction Id='QtExecTest' BinaryKey='WixCA' DllEntry='CAQuietExec'
              Execute='immediate' Return='check'/>
.
.
.
<InstallExecuteSequence>
  <Custom Action='QtExecCA' After='InstallInitialize'/>
</InstallExecuteSequence> 
```

这对我的复制代码至关重要。

我花了几次尝试才使 `QtExec`语法正确，我认为这可能是您遇到问题的地方。

[参考`QtExec`](http://wixtoolset.org/documentation/manual/v3/customactions/qtexec.html)

# button - 使用事件处理程序或类似的东西

> ID：16194866
> 
> 赞同：0
> 
> 时间：2013-04-24T14:38:03.923
> 
> 标签：button, adobe, flash-cs5

我正在使用 Adob​​e Flash CS5 和 actionscript 3 - 我的问题是如何制作一个只有在单击其他四个按钮并访问场景后才能单击的按钮？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:57:05.433

假设您的 5 个按钮在时间轴上始终可用，*并且*它们位于顶级文档级别（如果没有，我们需要进行一些调整）。我们还假设，根据您的问题，您还没有准备好文档类文件的最佳实践，因此这将被编写为时间线脚本。

```
//假设 4 个按钮在舞台上，分别命名为 button1、button2 等。
var 先决条件Buttons:Array = [button1, button2, button3, button4];
var 先决条件Clicked:Array /*of Boolean*/ = [];

coyButton.enabled = false;//你的第五个按钮，玩的好难拿到

//循环并监听您的先决条件按钮的点击
对于每个（var 按钮：按钮中的显示对象）{
    button.addEventListener(MouseEvent.CLICK, checkAllClicked);
}

//检查是否所有的按钮都被点击了
函数 checkAllClicked(e:Event):void {
    //在先决条件按钮数组中找到按钮
    var buttonIndex:int = 先决条件Buttons.indexOf(e.currentTarget);
    //在跟踪已单击内容的数组中将匹配索引设置为true
    先决条件点击[buttonIndex] = true;
    //计算其中有多少被点击
    var 先决条件DoneCount:int = 0;
    for (var i:int = 0; i<prerequisitesClicked.length; i++) {
        if (prerequisitesClicked[i]) 先决条件DoneCount++;
    }
    //如果所有的按钮都被点击了，启用按钮（可能还想在这里添加一个监听器）
    if (prerequisiteDoneCount==prerequisiteButtons.length) coyButton.enabled = true;
}
```

# java - 登录jboss的log4j的独立jar

> ID：16194867
> 
> 赞同：0
> 
> 时间：2013-04-24T14:38:05.620
> 
> 标签：java, log4j

是否可以从独立 jar 中登录与部署的 jboss 应用程序相同的日志？

jboss 应用程序和独立应用程序都使用 log4j。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T21:19:32.200

刚刚发现这是可能的，但在某些情况下，独立应用程序必须具有 jboss-common-client.jar，因为通常 jboss log4j 使用它的一些类。

诀窍在于将 -Dlog4j.configuration vm 参数设置为指向与 jboss 相同的 log4j.xml，并确保独立应用程序也以 jboss log4j 配置中使用的参数开始（通常是 jboss.server.home。 dir 以便将其日志写入同一个位置。

# javascript - 从我的 JSON 文件创建标记

> ID：16194869
> 
> 赞同：1
> 
> 时间：2013-04-24T14:38:11.073
> 
> 标签：javascript, json

我正在使用 json 文件中的标记创建地图，我的问题是我无法让标记显示在地图上。我可以链接一个基本的 json 文件，但是当我尝试使用数组文件时，我没有得到任何标记。我的代码是：

```
 <script src="js/mapping.js"></script>
    <script type="text/javascript">
    (function () {

window.onload = function () {

    // Creating a new map
    var map = new google.maps.Map(document.getElementById("map"), {
            center : new google.maps.LatLng(51.50746, -0.127594),
            zoom : 8,
            mapTypeId : google.maps.MapTypeId.ROADMAP
            });

            // Creating a global infoBox object that will be reused by all markers
    infoBubble = new InfoBubble({
      minWidth: 300,
      maxWidth: 400,
      minHeight: 300,
      maxHeight: 400,
      arrowSize: 50,
      arrowPosition: 50,
      arrowStyle: 2,
      borderRadius: 0,
      shadowStyle: 1,
    }); // end Creating a global infoBox object

    // Creating a global infoBox object tabs
    infoBubble.addTab('Details');
    infoBubble.addTab('Info');
    // end Creating a global infoBox object tabs        

    // Custom Markers
    var markers = {};
      var categoryIcons = {
        1 : "images/liver_marker1.png",
        2 : "images/liver_marker2.png",
        3 : "images/liver_marker3.png",
        4 : "images/liver_marker4.png",
        5 : "images/liver_marker.png",
        6 : "images/liver_marker6.png",
        7 : "images/liver_marker.png"
      } // end Custom Markers

    // Looping through the JSON data
    for (var i = 0, length = json.length; i < length; i++) {
        var data = json[i],
        latLng = new google.maps.LatLng(data.Latitude, data.Longitude);

        // Creating a marker and putting it on the map
        var marker = new google.maps.Marker({
                position : latLng,
                map : map,
                title : data.title,
                icon : categoryIcons[data.category]
            });

        // Creating a closure to retain the correct data, notice how I pass the current data in the loop into the closure (marker, data)
        (function (marker, data) {

            // Attaching a click event to the current marker
            google.maps.event.addListener(marker, 'click', function(e) {
                //infoBubble.setContent('<b>'+data.description+'</b>'+'<br>'+data.name);
                infoBubble.updateTab(0, 'Details', data.deviceOwnerName);
                infoBubble.updateTab(1, 'Info', data.name);
                infoBubble.open(map, marker);
                map.panTo(loc);
}); // end Attaching a click event to the current marker

        })(marker, data); // end Creating a closure

    } // end Looping through the JSON data

}

})();
google.maps.event.addDomListener(window, 'load', initialize);
</script> 
```

我的 json 数组文件是：

```
 {
"Device" : [{
        "DeviceId" : "e889",
        "DeviceRef" : "Te889",
        "DeviceName" : null,
        "DeviceText" : "Operated by SE",
        "DeviceLocation" : {
            "Latitude" : "51.484804",
            "Longitude" : "-0.103226",
            "Address" : {
                "SubBuildingName" : null,
                "BuildingName" : null,
                "BuildingNumber" : null,
                "Thoroughfare" : null,
                "Street" : "Volcan Road North",
                "DoubleDependantLocality" : null,
                "DependantLocality" : null,
                "PostTown" : "Norwich",
                "PostCode" : "NR6 6AQ",
                "Country" : "gb"
            },
            "LocationShortDescription" : null,
            "LocationLongDescription" : null
        },
        "Connector" : [{
                "ConnectorId" : "JEV01",
                "ConnectorType" : "JEVS G 105 (CHAdeMO)",
                "RatedOutputkW" : "50.00",
                "RatedOutputVoltage" : null,
                "RatedOutputCurrent" : null,
                "ChargeMethod" : "DC",
                "ChargeMode" : "1",
                "ChargePointStatus" : "In service",
                "TetheredCable" : "0",
                "Information" : null
            }
        ],
        "Controller" : {
            "OrganisationName" : "SE",
            "Website" :  null,
            "TelephoneNo" :  null,
            "ContactName" : null
        },
        "DeviceOwner" : {
            "OrganisationName" : "Unknown",
            "Website" : null,
            "TelephoneNo" : null,
            "ContactName" : null
        },
        "DeviceAccess" : {
            "RegularOpenings" : [{
                    "Days" : "Monday",
                    "Hours" : {
                        "From" : "08:00",
                        "To" : "18:00"
                    }
                }, {
                    "Days" : "Tuesday",
                    "Hours" : {
                        "From" : "08:00",
                        "To" : "18:00"
                    }
                }, {
                    "Days" : "Wednesday",
                    "Hours" : {
                        "From" : "08:00",
                        "To" : "18:00"
                    }
                }, {
                    "Days" : "Thursday",
                    "Hours" : {
                        "From" : "08:00",
                        "To" : "18:00"
                    }
                }, {
                    "Days" : "Friday",
                    "Hours" : {
                        "From" : "08:00",
                        "To" : "18:00"
                    }
                }, {
                    "Days" : "Saturday",
                    "Hours" : {
                        "From" : "08:30",
                        "To" : "05:00"
                    }
                }
            ],
            "Open24Hours" : true
        },
        "PaymentRequiredFlag" : false,
        "SubscriptionRequiredFlag" : true,
        "Accessible24Hours" : false,
        "PhysicalRestrictionFlag" : false,
        "PhysicalRestrictionText" : null,
        "OnStreetFlag" : false,
        "Bearing" : null
    }
    ]} 
```

我正在尝试链接到纬度和经度，但我也希望显示 DeviceId。

任何帮助，将不胜感激。

R

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:47:00.690

纬度和经度是 JSON 文件中的嵌套成员。如果不先深入研究 DeviceLocation 成员，您将无法访问它们。我建议您阅读这篇文章 ( [http://www.w3schools.com/json/](http://www.w3schools.com/json/) ) 以了解 JSON 的工作原理。

# macos - 为什么我的 bash 脚本不能从命令行读取数字？

> ID：16194873
> 
> 赞同：0
> 
> 时间：2013-04-24T14:38:28.740
> 
> 标签：macos, bash

我正在使用 MacOS 运行这个 bash 脚本：

```
#!/bin/bash

BADARGS=65
if [ -z $1 ]
then
    echo "Usage:`basename $0` first-number second-number..."
    exit $BADARGS
fi

for number in $@
do
    echo $number
done | sort -n

#END 
```

该脚本应按升序打印在命令行中输入的数字，但该脚本未读取数字。我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:44:44.980

我猜你是在问这个：

```
/path/to/myscript.sh 5 3 89 12 
```

其中 /path/to/ 是脚本的位置（目录路径）。如果它在当前工作目录中：

```
./myscript.sh 5 3 89 12 
```

# php - Codeigniter 以表格形式在 db 中插入多行

> ID：16194882
> 
> 赞同：-2
> 
> 时间：2013-04-24T14:38:51.127
> 
> 标签：php, mysql, database, codeigniter

我发现了类似的问题，但是我找不到任何适合我情况的答案。

使用 Codeigniter：我有一个产品数据库表和一个库存数据库表。我想在我的网站上显示一个 html 表格，每一行都是一个产品。我附上了一张图片来帮助解释。

![产品表](https://i.stack.imgur.com/160fZ.png)

提交后，我想将每个产品数据行作为单独的行插入数据库中。

这是我最简单形式的控制器...

控制器 - - - - - - - - - - - - - - - - -

```
function add_show_inventory() 
    {
        $data['products']=$this->product->get_products();

        $this->form_validation->set_rules('skuID', 'skuID', 'required');
        $this->form_validation->set_rules('brought-in', '"Brought In"', 'required');
        $this->form_validation->set_rules('finished-with', '"Finished With"', 'required');
        $this->form_validation->set_rules('deliveries', 'Deliveries');
        $this->form_validation->set_rules('add-1', 'Add 1');
        $this->form_validation->set_rules('add-2', 'Add 2');
        $this->form_validation->set_rules('band-comp', 'Band Comp');
        $this->form_validation->set_rules('other-comp', 'Other Comp');
        $this->form_validation->set_rules('half-sales', 'Half Sales');
        $this->form_validation->set_rules('half-amount', 'Half Amount');
        $this->form_validation->set_error_delimiters('<div class="error-module">', '</div>');

        if($this->form_validation->run()== FALSE){
            $this->load->view('header');
            $this->load->view('menu');
            $this->load->view('inventory/show-add-inventory', $data);
            $this->load->view('footer');
        } else {
            if($_POST){

                $data=array(
                    'brought-in'=>$_POST['brought-in'],
                );

                $this->inventory->insert_inventory($data);
                redirect(base_url().'shows/');
            }
        }
    } 
```

获取产品模型-----------------------------

```
function get_products($num=10,$start=0) {
        $where= array('userID'=>$this->session->userdata('userID'), 'active'=>1);

        $this->db->select()
                         ->from('products')
                         ->where($where)
                         ->order_by('product','asc')
                         ->limit($num,$start);
        $query=$this->db->get();
        return $query->result_array();
    } 
```

插入INV模型------------------------------------------

```
function insert_inventory($data) {
    $product_count= $this->db->count_all('products');

    for ($i=0; $i < $product_count; $i++) { 
        $this->db->insert('inventory', array('brought-in'=>$_POST['brought-in']));
    }
    return $this->db->insert_id();
} 
```

看法 - - - - - - - - - - - - - - - - - - - - -

```
<form action="<?= base_url(); ?>inventories/add_show_inventory" method="post">

<?php if(!isset($products)){ ?>
    <p>There are currently no products posted yet.</p>
<?php } else {
    foreach($products as $row){
?>

    <td class="highlight">
        <input type="text" name="brought-in" value="0"> <!-- Brought In -->
    </td>

<?php } ?>

<input type="submit" name="submit" class="submit"> 
```

我从这里的代码中得到的结果是数据库的三个主菜，这是我想要的，但所有行都与表格中的最后一行相同......这意味着模型中的迭代只是在最后一行上迭代表格...

再次，该代码被精简为最简单的形式，因此我没有 3 页完整的代码...但是如果您想查看我没有显示的任何内容，请告诉我...

非常感谢任何和所有的帮助......我已经为此工作了几个星期......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:02:17.950

**在您看来**：

```
<?php $i=0; foreach($products as $row){ ?>

    <td class="highlight">
        <input type="text" name="<?php echo 'brought-in'.$i; ?>" value="0"> <!-- Brought In -->
    </td>

<?php $i++;} ?> 
```

**现在在您的控制器中**：

```
if(!empty($_POST)){
    $count = $this->inventory->fetch_prods_count(); //Write this function in ur model.
    for($i=0;$i<$count;$i++) {
     $data[$i]=array('brought-in'=>$_POST['brought-in'.$i]);
    }

    $this->inventory->insert_inventory($data,$count);
    redirect(base_url().'shows/');
} 
```

**在模型中**：

```
function insert_inventory($data,$count) {
    for($i=0;$i<$count;$i++) {
       $this->db->insert('inventory', $data[$i]);
    }
    return $this->db->insert_id(); //Or just return 1; As U are not processing this value in your controller.
} 
```

* * *

**更新：**
*在您的控制器*中：`inventories/add_show_inventory`功能，更改

```
$data = array($i=>array('brought-in'=>$_POST['brought-in'.$i])); 
```

到

```
$data[$i]=array('brought-in'=>$_POST['brought-in'.$i]); 
```

# c# - BreezeJS - 在 EFContextProvider 麻烦中获取服务器端新创建的实体 ID

> ID：16194889
> 
> 赞同：3
> 
> 时间：2013-04-24T14:39:10.923
> 
> 标签：c#, asp.net, asp.net-mvc, breeze

我正在尝试确定使用 BreezeJS 保存的新添加/插入记录的 ID。这样做的目的是广播和通知监听客户端的变化，以便他们可以在必要时更新他们的视图。

BreezeJS 提供了一种有用的方法，通过继承类型化的 EFContextProvider 来拦截对其底层 Data/ObjectContext 的调用。父级公开了几个要覆盖的方法，例如下面的覆盖示例。这适用于更新/删除操作。但是，因为这发生在保存更改之前，因此此时没有为插入生成 ID。我无法在此类中找到可以覆盖的任何其他方法。在最坏的情况下，我将扩展部分数据上下文（ ），但我觉得将这个通知系统分成多个类是不合适的。建议？

```
 protected override bool BeforeSaveEntity(EntityInfo entityInfo) {
        var hubContext = GlobalHost.ConnectionManager.GetHubContext<AppHub>();
        if (entityInfo.EntityState == EntityState.Modified) {
            try {
                hubContext.Clients.All.handleEntityUpdate(new {
                    EntityType = entityInfo.Entity.GetType().Name,
                    Key = ((dynamic)(entityInfo.Entity)).Id
                });
            }
            catch (Exception ep) {
                //failed to notifiy the clients. *Oh well* no biggie.
                //Try, catch, curley, curley, curley.
            }
        }
        else if (entityInfo.EntityState == EntityState.Deleted) {
            try {
                hubContext.Clients.All.handleEntityDelete(new {
                    EntityType = entityInfo.Entity.GetType().Name,
                    Key = ((dynamic)(entityInfo.Entity)).Id
                });
            }
            catch (Exception ep) {
                //failed to notifiy the clients. *Oh well* no biggie.
                //Try, catch, curley, curley, curley.
            }
        }

        return base.BeforeSaveEntity(entityInfo);
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T19:28:40.447

现在 Breeze 网站上的文档记录很差，但是......我将尝试在这里提供一些至少最少的帮助。关于这个主题的更好的文档正在计划中......现在很快:)

## 服务器端

Breeze 使您能够通过 IKeyGenerator 接口的实现在服务器上自定义 KeyGeneration（您可以在 Breeze.WebApi 源代码中找到定义的接口以及“备用”NumericKeyGenerator 实现）。

Breeze 将自动发现与您的 EFContextProvider 相同的程序集中此接口的任何自定义实现。仅支持一个实现，但可以编写一个实现来支持您希望为其生成自定义密钥的所有可能的数据类型和属性。如果 Breeze 没有找到它，它将默认使用上面提到的“NumericKeyGenerator”。

## 客户端

然后，您将需要创建一个客户端“临时”密钥生成器。在以下页面上对此主题进行了一些讨论：[here](http://www.breezejs.com/documentation/extending-entities)。

这个想法是，Breeze 将使用这个“临时”密钥生成器为任何新创建的实体（指定类型）生成临时密钥。保存这些实体后，Breeze 将使用上述服务器端机制生成一个“真实”密钥并将其保存。然后，Breeze 会将 temp -> real 键的映射返回给客户端，并使用此映射自动使用正确的“真实”键更新客户端实体。

您告诉 Breeze 客户端您要通过*EntityType.setProperties*方法调用自定义密钥生成，如下所示：

```
var regionType = testFns.metadataStore.getEntityType("Region");
regionType.setProperties({ 
   autoGeneratedKeyType: AutoGeneratedKeyType.KeyGenerator }
); 
```

请注意，您只是告诉 Breeze 使用自定义密钥生成器。服务器本身将根据上述逻辑决定使用哪个密钥生成器。

默认情况下，任何 EntityType 的“autoGeneratedKeyType”将为“None”或“Identity”，因此您需要为任何想要“自定义”密钥生成的类型设置此项。

设置完成后，调用 EntityManager.saveChanges 将自动调用服务器上的密钥生成，并将使用“真实”密钥保存新添加的实体，并使用这些新密钥更新客户端。

希望这可以帮助。

# python - 在 Python 中用新行替换行

> ID：16194892
> 
> 赞同：0
> 
> 时间：2013-04-24T14:39:30.580
> 
> 标签：python

我正在读取一个文本文件并根据某些条件逐行搜索数据，更改该行中的某些值并将其写回另一个文件。新文件不应包含旧行。我尝试了以下方法，但没有奏效。我想我错过了一个非常基本的东西。

解决方案：在 C++ 中我们可以增加行，但在 Python 中我不知道如何实现这一点。所以到目前为止，我写的是旧行而不是新行。但是在新文件中，我只想要新行。

例子：

```
M0 38 A 19 40 DATA2 L=4e-08 W=3e-07 nf=1 m=1 $X=170 $Y=140 $D=8
M0 VBN A 19 40 TEMP2 L=4e-08 W=3e-07 nf=1 m=1 $X=170 $Y=140 $D=8 
```

我尝试的代码如下：

```
def parsefile():
    fp = open("File1", "rb+")
    update_file = "File1" + "_update"
    fp_latest = open(update_file, "wb+")  
    for line in fp:
        if line.find("DATA1") == -1:
            fp_latest.write(line)
        if line.find("DATA1") != -1:
            line = line.split()
            pin_name = find_pin_order(line[1])
            update_line = "DATA " + line[1] + " " + pin_name
            fp_latest.write(update_line)
            line = ''.join(line) 
         if line.find("DATA2") != -1:
            line_data = line.split()
            line_data[1] = "TEMP2"
            line_data =' '.join(line_data)
            fp_latest.write(line_data)
         if line.find("DATA3") != -1:
            line_data = line.split()
            line_data[1] = "TEMP3"
            line_data =' '.join(line_data)
            fp_latest.write(line_data)

 fp_latest.close()
 fp.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:39:54.090

The main problem with your current code is that your first `if` block, which checks for `"DATA1"` and writes the line out if it is not found runs when `"DATA2"` or `"DATA3"` is present. Since those have their own blocks, the line ends up being duplicated in two different forms.

Here's a minimal modification of your loop that should work:

```
for line in fp:
    if line.find("DATA1") != -1:
        data = line.split()
        pin_name = find_pin_order(data[1])
        line = "DATA " + data[1] + " " + pin_name
    if line.find("DATA2") != -1:
        data = line.split()
        data[1] = "TEMP2"
        line =' '.join(data)
    if line.find("DATA3") != -1:
        data = line.split()
        data[1] = "TEMP3"
        line =' '.join(data)

    fp_latest.write(line) 
```

This ensures that only one line is written because there's only a single `write()` call in the code. The special cases simply modify the line that is to be written. I'm not sure I understand the modifications you want to have done in those cases, so there may be more bugs there.

One thing that might help would be to make the second and third `if` statements into `elif` statements instead. This would ensure that only one of them would be run (though if you know your file will never have multiple `DATA` entries on a single line, this may not be necessary).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:45:36.027

如果你想在文件中写一个新行替换上次读取的旧内容，你可以使用 file.seek() 方法来移动文件，有一个例子。

```
with open("myFile.txt", "r+") as f:
    offset = 0
    lines = f.readlines()
    for oldLine in lines:
            ... calculate the new line value ...
            f.seek(offset)
            f.write(newLine)
            offset += len(newLine)
            f.seek(offset) 
```

# apache - 为 Zend Skeleton 设置重写规则

> ID：16194896
> 
> 赞同：1
> 
> 时间：2013-04-24T14:39:50.160
> 
> 标签：apache, .htaccess, zend-framework2, virtualhost, opensuse

我使用opensuse 12.2 os、apache 2.2、zend framework 2。为了拥有框架的骨架应用程序，我在apache的文件中设置了一个虚拟主机。这是定义

```
 <VirtualHost 127.0.0.1>
       DocumentRoot "/home/gabriele/Web/zf2-tutorial/public/"
       ServerName zf2-tutorial.localhost
       SetEnv APPLICATION_ENV "development" 
       <Directory "/home/gabriele/Web/zf2-tutorial/public/">
             Options +FollowSymLinks
             AllowOverride All
             DirectoryIndex index.php 
             AllowOverride None
             Order allow,deny
             Allow from all
       </Directory>
   </VirtualHost> 
```

当我移动到 zf2-tutorial.localhost 时，我可以看到欢迎页面。我试过htaccess

```
 Options +FollowSymlinks
     RewriteEngine On
     # The following rule tells Apache that if the requested filename
     # exists, simply serve it.
     RewriteCond %{REQUEST_FILENAME} -s [OR]
     RewriteCond %{REQUEST_FILENAME} -l [OR]
     RewriteCond %{REQUEST_FILENAME} -d
     RewriteRule ^.*$ - [NC,L]
     RewriteRule ^.*$ index.php [NC,L]

     The structure of my folder is :
     \home
           \gabriele 
                    \Web
                         \zf2-tutorial
                                     \public
                                            -index.php
                                            -htaccess 
```

如果我继续 zf2-tutorial.localhost/test1234 我应该看到一个错误重定向到骨架内，而不是我看到一个正常的 apache 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:49:30.613

您已经为初学者正确设置了 VHOST：

```
 AllowOverride All
  DirectoryIndex index.php 
  AllowOverride None # WRONG - remove this. 
```

您已经关闭了 Overrides，这将杀死您的 htaccess。

# php - 不在 php 中发送带有来自电子邮件 ID 的标头的电子邮件

> ID：16194897
> 
> 赞同：0
> 
> 时间：2013-04-24T14:39:50.430
> 
> 标签：php

我将以下代码与 HTML 一起用于 header 。

**$email="example@example.com"; 在示例中，我想在其位置实现变量。代码如下发布，但它没有显示错误也没有发送电子邮件。**

我尝试了以下链接[PHP 电子邮件表单不发送信息](https://stackoverflow.com/questions/15389661/php-email-form-not-sending-information)，[PHP 发送带有文件附件的电子邮件 - 电子邮件根本不发送](https://stackoverflow.com/questions/11004377/php-sending-emails-with-file-attachments-email-not-sending-at-all)。

我努力了

```
$headers .= "From: <".$email.">\n"; 
```

和

$标头 .= $email;

**这会在 email 中标头**的标签中显示 $ email 。

但它工作正常，直到这一行：

```
$headers .= 'From: ' .$email. "\r\n"; 
```

如果我删除此行，则上面的行不会发送电子邮件，但它不会将 From email id 添加到标题中。

请帮帮我，它没有显示任何错误，我已经尝试了上述代码的许多变体，但仍然难倒。

```
<?php

$name = $_REQUEST['name'];
$email = $_REQUEST['email'];
$phone = $_REQUEST['contact'];

$subject = "feedback";
$question = $_REQUEST['question'];

$body = "<html>
<head>

</html>";
$mime_boundary = "<<<--==+X[".md5(time())."]\r\n\r\n";
$headers = "MIME-Version: 1.0"."\r\n" ."Content-Type:text/html;"."\r\n";
$headers .= 'From:'.$email. "\r\n";

$to ='example@example.com';
mail($to,$subject,$body,$headers);
echo "<script>alert(' message  sent.');</script>";

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:49:48.167

如果您使用标准[邮件](http://php.net/manual/ru/function.mail.php)功能，那么试试这个（不要将“发件人”标头添加到 $headers）：

```
mail($to,$subject,$message,$headers,"-f ".$email); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-08T13:35:41.437

我正在处理的其中一台服务器上遇到了同样的问题。显然在我的服务器中，不指定“发件人”标头从您帐户的默认邮件地址发送电子邮件（如果是共享主机）。我选择此解决方案作为临时修复程序，并在“回复”标题中指定了我的实际发件人地址。这样，我仍然可以收到发送到这些电子邮件线程的回复。

此方法似乎仅适用于功能性电子邮件地址（例如 support@example.com）。如果您将这种方法用于用户的电子邮件地址（例如 john@example.com），那么收件人可能会将您的电子邮件视为垃圾邮件。

# javascript - 如何从 JPG 的 arrayBuffer 表示创建画布 imageData 数组

> ID：16194908
> 
> 赞同：9
> 
> 时间：2013-04-24T14:40:16.687
> 
> 标签：javascript, canvas, bytearray, filereader

首先，我知道有实现这一点的标准方法（readAsDataURL 和 drawImage），但不幸的是，它们不适用于这个特定的用例。

我正在使用 filereader API 作为数组缓冲区读取图像，如下所示：

```
 var reader = new fileReader();
    reader.onload = function(e){

          var byteArray = new Uint8ClampedArray(e.target.result);
          //do stuff to this array
    }
    reader.readAsArrayBuffer(file); 
```

然后我用这个返回的数据创建一个clampedarray。

我现在想要做的就是将这个像素数组直接绘制到画布上`putImageData`

目前我正在做以下事情：

```
var byteArray = new Uint8ClampedArray(e.target.result);
var imgdata = ctx.createImageData(img.width, img.height);
var canvdata = imgdata.data;

for (var i = 0; i < canvdata.length; i += 4) {
    canvdata[i] = byteArray[i];
    canvdata[i + 1] = byteArray[i + 1];
    canvdata[i + 2] = byteArray[i + 2];
    canvdata[i + 3] = byteArray[i + 3];
}
ctx.putImageData(imgdata, 0, 0); 
```

使用这种方法，虽然数据被绘制到画布上，但它看起来像乱码的雪花或噪点，并不是图像的正确表示。

这使我相信我在循环中错误地构造了 imagedata 数据，或者我获取像素数组的初始方法可能不正确。

总而言之，我希望能够获取通过 html5 fileReader API 检索到的数组缓冲区（jpeg），然后创建一个与画布兼容的 imageData 数组，以便以后可以使用`putImageData`

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T15:11:30.540

**编辑**

*JPEG*文件不是颜色数据的简单字节数组，因此您不能像这样简单地加载它。如果您想在不直接导入画布的情况下解决此问题，则必须使用*JPEG*解码库，例如我通过快速谷歌搜索找到[**的 notmasteryet 的这个项目。**](https://github.com/notmasteryet/jpgjs)

**原来的**

> 不幸的是，它们不适用于这个特定的用例

为什么它们不可用？

```
// example array
u = new Uint8ClampedArray(4);
u[0] = 255, u[1] = 56, u[2] = 201, u[3] = 8; // [255, 56, 201, 8]
// to String
str = String.fromCharCode.apply(null, u); // "ÿ8É"
// to Base64
b64 = btoa(str); // "/zjJCA=="
// to DataURI
uri = 'data:image/jpeg;base64,' + b64; // "data:image/jpeg;base64,/zjJCA==" 
```

而反过来

```
// uri to Base64
b64 = uri.slice(uri.indexOf(',')+1);
// to String
str = atob(b64);
// to Array
arr = str.split('').map(function (e) {return e.charCodeAt(0);});
// to Uint8ClampedArray
u = new Uint8ClampedArray(arr); // [255, 56, 201, 8] 
```

# ruby - MongoDB：无法从 BSON 类型 EOO 转换为 Date

> ID：16194909
> 
> 赞同：9
> 
> 时间：2013-04-24T14:40:17.960
> 
> 标签：ruby, mongodb, aggregation-framework, database, nosql

我正在尝试使用聚合框架（使用 ruby​​）并像这样投影日期：

```
db['requests'].aggregate([
{"$project" => {
    _id: 0, 
    method: '$method', 
    user: '$user', 
    year: {'$year' => '$timestamp'}
}}]) 
```

文件是这样的：

```
{
_id: ObjectId("5177d7d7df26358289da7dfd"),
timestamp: ISODate("2013-04-12T03:58:05+00:00"),
method: "POST",
status: "200",
inputsize: "874",
outputsize: "4981",
user: "131"
} 
```

但我收到以下错误：

```
Mongo::OperationFailure: Database command 'aggregate' failed: (errmsg: 'exception: can't convert from BSON type EOO to Date'; code: '16006'; ok: '0.0'). 
```

这很奇怪，因为如果我在使用 mongorestore 导入的完全相同的数据库上运行它，它可以正常工作。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-24T15:21:54.377

问题是我保存了一些没有时间戳字段的文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-23T23:31:06.587

如果您需要一些没有此时间戳字段的文档，您可以试试这个（我使用的是 Javascript/Mongoose 表示法）：

```
year: { $cond: [{ $ifNull: ['$timestamp', 0] }, { $year: '$deliveryDateEnd' }, -1] } 
```

在这种情况下，每个没有时间戳字段的文档都将返回 -1。所有其他文件将按预期返回年份。

# tinymce - 在 TinyMCE 中将多个撤消级别分组到批处理中

> ID：16194913
> 
> 赞同：2
> 
> 时间：2013-04-24T14:40:25.607
> 
> 标签：tinymce

我正在为 TinyMCE 编写一个自定义插件。其中一个新按钮在文档中进行了许多 DOM 操作。默认撤消行为会在更改中间创建一些撤消级别。如果用户在使用插件后点击撤消按钮，他/她就会看到一个操作部分反转并且实际上不处于正确状态的文档。

看起来曾经有一对名为 mceBeginUndoLevel / mceEndUnoLevel 的实例命令（在 3.3 版中删除）让开发人员开始/结束一个大型撤消批处理，该批处理将在单个操作中撤消......但我不查看文档中替换该功能的任何内容。

一些论坛帖子建议使用 editor.undoManager.add() 作为替代，这适用于您在操作期间需要**更多**级别的撤消，但实际上我想要的更少。

还有一个您可以挂钩的 undoManager.onBeforeAdd 事件，但查看 undoManager 的源代码，我认为挂钩不会让您中止撤消快照。

那么，有没有一种合适的方法来批处理我使用现有 API 看不到的撤消操作？如果没有，我唯一的其他选择似乎是修补 undoManager 以允许 onBeforeAdd 挂钩中止快照。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:26:19.657

我建议覆盖当前的 UndoManager。它只是一个相当小的文件。这就是我们需要做的，以抑制创建一些不需要的撤消步骤。

# php - 如何获取具有相同ID的mysql表中的所有数据

> ID：16194917
> 
> 赞同：-4
> 
> 时间：2013-04-24T14:40:37.193
> 
> 标签：php, mysql

我的 mySQL 数据库中有类似的东西：

![sql表](https://i.stack.imgur.com/712W6.jpg)

（用户 734 有很多信息：简历、姓名、电话、邮件......）

我想获得一个包含分组数据的数组（在 PHP 中）：

```
array(
    [734]=>
    object {
        [155] => string "Dominique",
        [4] => int(047682037),
        [1] => string "Dominique B"
    },
    [735]=>
    object {
        [155] => string "Other",
        [4] => int(0123456789),
        [1] => string "Other B"
    }
) 
```

不仅适用于 734 用户，而且适用于每个用户。通过一个简单的查询，我得到了所有内容，但顺序不正确。我可以在 SQL 中创建它，还是我可能需要在 PHP 中重新排列数据？

对于每个 user_id，获取所有相关数据的 sql 查询是什么？

我无法更改数据库结构（WP 和 buddypress） 我无法使用原生 WP 功能（因为从另一个站点获取数据）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:42:46.907

```
SELECT * FROM (whatever your table name is)
WHERE user_id = (whatever user id you're interested in getting data for) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T15:18:56.293

解决方案使用`ORDER BY`：

```
$users = array();
$current_user = null;
$result = $mysqli->query("SELECT user_id, field_id, value FROM `TABLE_NAME` ORDER BY user_id, field_id");
while ($result && $row = $mysqli->fetch_assoc($result)) {
    if ($current_user != $row['user_id']) {
      $current_user = $row['user_id'];
      $users[$row['user_id']] = array();
    }
    $users[$row['user_id']][$row['field_id']] = $row['value'];
} 
```

**编辑**：

还有另一种使用`GROUP BY`and的解决方案`GROUP_CONCAT`：

```
$users = array();
$result = $mysqli->query("SELECT user_id, GROUP_CONCAT(field_id SEPARATOR '|') as fields, GROUP_CONCAT(value SEPARATOR '|') as values FROM `TABLE_NAME` GROUP BY user_id");
while ($result && $row = $mysqli->fetch_assoc($result)) {
    $fields = explode('|', $row['fields']);
    $values = explode('|', $row['values']);

    $users[$row['user_id']] = array();
    // Problem id you have your field ids and your values in separate arrays, not sure what you want to do with them
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:47:48.033

```
$result = mysqli_query($con, "SELECT * FROM table_name WHERE user_id = 734"); 
```

或者，如果您不使用 mysqli：

```
$result = mysql_query("SELECT * FROM table_name WHERE user_id = 734"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-24T14:53:43.150

如果您使用的是 PDO 库，您可以检查 PDO::FETCH_GROUP 属性。 [http://php.net/manual/en/pdostatement.fetchall.php](http://php.net/manual/en/pdostatement.fetchall.php)

> **fetch_style：** 要返回按指定列的值分组的关联数组，按位或 PDO::FETCH_COLUMN 与 PDO::FETCH_GROUP。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-24T14:54:29.517

```
$stmt = $this->_mysqli->prepare('SELECT user_id,field_id,value FROM WHERE user_id = ?');

$stmt->bind_param('i', $user_id );
$stmt->execute();
$stmt->bind_result($user_id, $field_id, $value);

while($stmt->fetch())
{
     $data[$user_id][$field_id] = $value;
} 
```

# sql - SQL 布尔逻辑条件

> ID：16194919
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:40:42.833
> 
> 标签：sql, boolean-logic

我对这个声明以及为什么它是真的感到困惑。

**如果类型是“稀有”，则价格必须超过 500 美元**

这个条件符合它，但我很困惑如何。

```
CHECK (type <> 'rare' OR price > 500) 
```

这个问题也是， **如果类型是“新颖”，那么价格必须在 10 美元以上但低于 30 美元。**

```
CHECK ((type <> 'novel') OR (price > 10 AND price < 30)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:43:56.350

“A 或 B”意味着这些陈述中至少有一个是正确的。如果 A 不为真（type = 'rare'），则 B 必须为真（价格 > 500）才能满足条件。您拥有的第二个陈述具有完全相同的逻辑。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:49:23.567

很难从概念上理解为什么它们是等价的。从四个可能的条件开始可能会有所帮助，相对于：如果类型是，`rare`那么价格必须超过 500 美元。

```
Type = 'rare', price > $500:   True
Type <> 'rare', price > $500:  True
Type = 'rare', price <= $500:  False
Type <> 'rare', price <= $500  True 
```

你可以对 (t​​ype <> 'rare' OR price > 500` 进行同样的练习，你会发现它们在逻辑上是等价的。

为什么？直观地说，“if type is `rare`then price must be over $500”只是“关心”类型是否稀有。如果该类型*不是*罕见的，则该陈述为真。同样，如果价格大于 500 美元，那么它总是正确的。该`check`表达式只是捕获这两个条件。

# java - 用一些预定义的值初始化 ArrayList

> ID：16194921
> 
> 赞同：76
> 
> 时间：2013-04-24T14:40:46.570
> 
> 标签：java

我有一个示例程序，如图所示。

我希望我`ArrayList` `symbolsPresent`用一些预定义的符号进行初始化：一、二、三和四。

```
symbolsPresent.add("ONE");
symbolsPresent.add("TWO");
symbolsPresent.add("THREE");
symbolsPresent.add("FOUR"); 
```

```
import java.util.ArrayList;

public class Test {

    private ArrayList<String> symbolsPresent = new ArrayList<String>();

    public ArrayList<String> getSymbolsPresent() {
        return symbolsPresent;
    }

    public void setSymbolsPresent(ArrayList<String> symbolsPresent) {
        this.symbolsPresent = symbolsPresent;
    }

    public static void main(String args[]) {    
        Test t = new Test();
        System.out.println("Symbols Present is" + t.symbolsPresent);

    }    
} 
```

那可能吗？

* * *

## 回答 #1

> 赞同：161
> 
> 时间：2013-04-24T14:43:02.057

尝试这个

```
new String[] {"One","Two","Three","Four"}; 
```

或者

```
List<String> places = Arrays.asList("One", "Two", "Three"); 
```

[**数组**](http://docs.oracle.com/javase/1.5.0/docs/api/java/util/Arrays.html)

* * *

## 回答 #2

> 赞同：56
> 
> 时间：2013-04-24T14:48:38.943

双括号初始化是一个选项：

```
List<String> symbolsPresent = new ArrayList<String>() {{
   add("ONE");
   add("TWO");
   add("THREE");
   add("FOUR");
}}; 
```

请注意，如[JLS §15.9](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.9)所示，在分配的表达式中`String`泛型类型参数*是必需的*

> 如果类实例创建表达式使用类的类型参数的“<>”形式声明匿名类，则这是一个编译时错误。

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-04-24T14:42:02.933

如何使用[**重载的 ArrayList 构造函数**](http://docs.oracle.com/javase/6/docs/api/java/util/ArrayList.html#ArrayList%28java.util.Collection%29)。

```
 private ArrayList<String> symbolsPresent = new ArrayList<String>(Arrays.asList(new String[] {"One","Two","Three","Four"})); 
```

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-04-24T14:58:06.180

您还可以使用 varargs 语法来使您的代码更简洁：

使用重载的构造函数：

```
ArrayList<String> list = new ArrayList<String>(Arrays.asList("a", "b", "c")); 
```

utils 模块中的子类 ArrayList：

```
public class MyArrayList<T> extends ArrayList<T> {
    public MyArrayList(T... values) {
        super(Arrays.asList(values));
    }
}

ArrayList<String> list = new MyArrayList<String>("a", "b", "c"); 
```

或者有一个静态工厂方法（我的首选方法）：

```
public class Utils {
  public static <T> ArrayList<T> asArrayList(T... values) {
    return new ArrayList<T>(Arrays.asList(values));
  }
}

ArrayList<String> list = Utils.asArrayList("a", "b", "c"); 
```

* * *

## 回答 #5

> 赞同：10
> 
> 时间：2015-09-10T06:03:31.377

```
import com.google.common.collect.Lists;

...

ArrayList<String> getSymbolsPresent = Lists.newArrayList("item 1", "item 2");

... 
```

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2015-11-15T11:40:23.847

您可以使用***[Java 8 Stream API](https://docs.oracle.com/javase/8/docs/api/java/util/stream/Stream.html)***。
您可以创建对象流并将它们收集为列表。

```
private List<String> symbolsPresent = Stream.of("ONE", "TWO", "THREE", "FOUR")
    .collect(Collectors.toList()); 
```

* * *

## 回答 #7

> 赞同：7
> 
> 时间：2016-11-24T22:47:22.190

```
public static final List<String> permissions = new ArrayList<String>() {{
    add("public_profile");
    add("email");
    add("user_birthday");
    add("user_about_me");
    add("user_location");
    add("user_likes");
    add("user_posts");
}}; 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2018-04-29T23:33:15.537

`List.of`Java 9 允许您使用工厂用一行代码创建一个不可修改的列表：

```
public class Main {
    public static void main(String[] args) {
        List<String> examples = List.of("one", "two", "three");
        System.out.println(examples);
    }
} 
```

输出：

```
[one, two, three] 
```

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2013-04-24T14:45:11.640

Personnaly 我喜欢在构造函数中进行所有初始化

```
public Test()
{
  symbolsPresent = new ArrayList<String>();
  symbolsPresent.add("ONE");
  symbolsPresent.add("TWO");
  symbolsPresent.add("THREE");
  symbolsPresent.add("FOUR");
} 
```

编辑：这当然是一种选择，其他人更喜欢在声明中进行初始化。两者都是有效的，我选择了构造函数，因为那里可以进行所有类型的初始化（如果您需要循环或参数，...）。但是，我在源代码顶部的声明中初始化了常量。
最重要的是遵循您喜欢的规则，并在我们的课程中保持一致。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-04-24T14:52:20.717

此外，如果您想强制 List 为只读（如果修改，则抛出 UnsupportedOperationException）：

`List<String> places = Collections.unmodifiableList(Arrays.asList("One", "Two", "Three"));`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2014-12-07T05:13:01.393

我建议使用 Arrays.asList() 进行单行初始化。对于声明和初始化列表的不同方式，您还可以参考[Java 中 ArrayList 的初始化](http://www.gitarani.com/classified.htm?classifiedId=3011)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2015-06-09T14:43:48.807

我使用从 ArrayList 继承的泛型类，并使用带有可变编号或参数的参数实现构造函数：

```
public class MyArrayList<T> extends ArrayList<T> {
    public MyArrayList(T...items){
        for (T item : items) {
            this.add(item);
        }
    }
} 
```

例子：

```
MyArrayList<String>myArrayList=new MyArrayList<String>("s1","s2","s2"); 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2015-12-28T10:37:16.257

如果您只想在任何方法之外进行初始化，请使用初始化程序块：

```
import java.util.ArrayList;

public class Test {
private ArrayList<String> symbolsPresent = new ArrayList<String>();

// All you need is this block.
{
symbolsPresent = new ArrayList<String>();
symbolsPresent.add("ONE");
symbolsPresent.add("TWO");
symbolsPresent.add("THREE");
symbolsPresent.add("FOUR");
}

public ArrayList<String> getSymbolsPresent() {
    return symbolsPresent;
}

public void setSymbolsPresent(ArrayList<String> symbolsPresent) {
    this.symbolsPresent = symbolsPresent;
}

public static void main(String args[]) {    
    Test t = new Test();
    System.out.println("Symbols Present is" + t.symbolsPresent);

}    
} 
```

# c# - 在 Visual Studio 2012 中排队负载测试

> ID：16194923
> 
> 赞同：2
> 
> 时间：2013-04-24T14:40:51.067
> 
> 标签：c#, visual-studio-2012, soa, load-testing

我目前正在为大学完成一个项目，该项目要求我们使用 Fowlers “企业架构模式”中描述的技术构建企业应用程序。

这是您的沼泽标准 ASP MVC 应用程序，它与服务层对话，服务层与数据层对话……等等。

我们还被要求运行几个负载测试场景，范围从 1 到 25 个用户。我已经为每个场景（1User.loadtest、5User.loadtest、10User.loadtest 等）创建了一个负载测试，我想知道是否有任何方法可以将它们排队并让它们运行，而不是启动一个，然后回来几分钟后，开始另一个……等等。

TL; DR - 有人知道排队负载测试的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-30T15:49:23.257

负载测试会自动排队。运行负载测试时，您仍然可以添加新测试。但是，您仍然需要单击N次...

另一种解决方案是使用[命令行工具](http://msdn.microsoft.com/en-us/library/ms182588.aspx)。

```
> mstest /TestContainer:LoadTest1.loadtest 
```

# xml - 按xslt中的arregate元素属性对组进行排序

> ID：16194924
> 
> 赞同：0
> 
> 时间：2013-04-24T14:40:51.883
> 
> 标签：xml, xslt, xslt-1.0, xslt-grouping

我正在使用 xslt（1.0 版，使用 MSXSL）转换一些 xml。

假设我的 xml 数据如下所示：

```
<table>
 <record><name>A</name><value>a</value><size>10</size></record>
 <record><name>A</name><value>b</value><size>35</size></record>
 <record><name>A</name><value>c</value><size>60</size></record>
 <record><name>B</name><value>x</value><size>15</size></record>
 <record><name>B</name><value>y</value><size>90</size></record>
 <record><name>B</name><value>z</value><size>20</size></record>
 ...
</table> 
```

我的目标是：

1.  将记录分组`<name>`
2.  每组，确定最大值`<size>`，比如说`maxsize`
3.  `maxsize`按组（降序）对组进行排序
4.  每组，列出记录（按原始顺序）

所以结果可能是：

```
<table>
 <group>B<maxsize>90</maxsize>
  <record><value>x</value><size>15</size>
  <record><value>y</value><size>90</size>
  <record><value>z</value><size>20</size>
 </group>
 <group>A<maxsize>60</maxsize>
  <record><value>a</value><size>10</size>
  <record><value>a</value><size>35</size>
  <record><value>a</value><size>60</size>
 </group>
</table> 
```

现在步骤 1、2 和 4，我可以做到。但是...如何按最大大小对组进行排序？

我尝试在包含组的变量中构建一个新节点集。我可以构建这样一个集合，但我只能以字符串的形式访问它。

应该可以吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:51:33.397

干得好：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:key name="kRecord" match="record" use="name"/>

    <xsl:template match="@* | node()">
        <xsl:copy>
            <xsl:apply-templates select="@* | node()"/>
        </xsl:copy>
    </xsl:template>

  <xsl:template match="/*">
    <xsl:copy>
      <xsl:apply-templates
        select="record[generate-id() = 
                       generate-id(key('kRecord', name)[1])]" 
        mode="group">
        <xsl:sort select="key('kRecord', name)/size
                              [not(. &lt; key('kRecord', ../name)/size)]" 
                  data-type="number"
                  order="descending" />
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="record" mode="group">
    <xsl:variable name="members" select="key('kRecord', name)" />
    <group>
      <xsl:value-of select="name" />
      <maxsize>
        <xsl:value-of select="$members/size[not(. &lt; $members/size)]"/>
      </maxsize>
      <xsl:apply-templates select="$members" />
    </group>
  </xsl:template>

  <xsl:template match="record/name" />
</xsl:stylesheet> 
```

在您的示例输入上运行时，结果是：

```
<table>
  <group>
    B<maxsize>90</maxsize><record>
      <value>x</value>
      <size>15</size>
    </record><record>
      <value>y</value>
      <size>90</size>
    </record><record>
      <value>z</value>
      <size>20</size>
    </record>
  </group>
  <group>
    A<maxsize>60</maxsize><record>
      <value>a</value>
      <size>10</size>
    </record><record>
      <value>b</value>
      <size>35</size>
    </record><record>
      <value>c</value>
      <size>60</size>
    </record>
  </group>
</table> 
```

顺便说一句，如果您使用`node-set()`大多数 XSLT 处理器中可用的函数，则可以访问变量中构造的节点集。我喜欢尽可能避免使用该`node-set()`功能，因为它是非标准的并且没有完整的支持（并且它的命名空间在支持它的处理器之间甚至不一致），但是您可以这样做：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:exslt="http://exslt.org/common" 
                exclude-result-prefixes="exslt">
  <xsl:output method="xml" indent="yes" omit-xml-declaration="yes"/>
  <xsl:key name="kRecord" match="record" use="name"/>

  <xsl:template match="@* | node()">
    <xsl:copy>
      <xsl:apply-templates select="@* | node()"/>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="/table">
    <xsl:copy>
      <xsl:variable name="groups">
        <xsl:apply-templates
          select="record[generate-id() = 
                         generate-id(key('kRecord', name)[1])]"
          mode="group" />
      </xsl:variable>
      <xsl:apply-templates select="exslt:node-set($groups)/*">
        <xsl:sort select="maxsize" data-type="number" order="descending" />
      </xsl:apply-templates>
    </xsl:copy>
  </xsl:template>

  <xsl:template match="record" mode="group">
    <xsl:variable name="members" select="key('kRecord', name)" />
    <group>
      <xsl:value-of select="name" />
      <maxsize>
        <xsl:apply-templates select="$members/size" mode="max">
          <xsl:sort select="." data-type="number" order="descending" />
        </xsl:apply-templates>
      </maxsize>
      <xsl:apply-templates select="$members" />
    </group>
  </xsl:template>

  <xsl:template match="record/name" />

  <xsl:template match="*" mode="max">
    <xsl:if test="position() = 1">
      <xsl:value-of select="." />
    </xsl:if>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-25T04:34:29.063

**这个简短的转换**（只有两个模板，没有模式，没有变量）：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:key name="kRecByName" match="record" use="name"/>

 <xsl:template match="/*">
  <table>
    <xsl:apply-templates select=
     "*[generate-id()=generate-id(key('kRecByName', name)
                                    [not(key('kRecByName', name)/size > size)][1])]">
      <xsl:sort select="size" data-type="number" order="descending"/>
    </xsl:apply-templates>
  </table>
 </xsl:template>

 <xsl:template match="record">
  <group><xsl:value-of select="name"/><maxsize><xsl:value-of select="size"/></maxsize>
    <xsl:copy-of select="key('kRecByName', name)"/>
  </group>
 </xsl:template>
</xsl:stylesheet> 
```

**应用于提供的 XML 文档时**：

```
<table>
 <record><name>A</name><value>a</value><size>10</size></record>
 <record><name>A</name><value>b</value><size>35</size></record>
 <record><name>A</name><value>c</value><size>60</size></record>
 <record><name>B</name><value>x</value><size>15</size></record>
 <record><name>B</name><value>y</value><size>90</size></record>
 <record><name>B</name><value>z</value><size>20</size></record>
 ...
</table> 
```

**产生想要的正确结果**：

```
<table>
   <group>B<maxsize>90</maxsize>
      <record>
         <name>B</name>
         <value>x</value>
         <size>15</size>
      </record>
      <record>
         <name>B</name>
         <value>y</value>
         <size>90</size>
      </record>
      <record>
         <name>B</name>
         <value>z</value>
         <size>20</size>
      </record>
   </group>
   <group>A<maxsize>60</maxsize>
      <record>
         <name>A</name>
         <value>a</value>
         <size>10</size>
      </record>
      <record>
         <name>A</name>
         <value>b</value>
         <size>35</size>
      </record>
      <record>
         <name>A</name>
         <value>c</value>
         <size>60</size>
      </record>
   </group>
</table> 
```

# android - 使用用户定义的属性引用 android 库项目时的问题

> ID：16194928
> 
> 赞同：0
> 
> 时间：2013-04-24T14:41:05.403
> 
> 标签：android, reference, project

问题是：

1.  我有一个项目 A。它运行良好。
2.  然后我将 A 配置为库项目。并新建一个项目 B 来使用它。

然后问题如下： \res\layout\taskslist.xml:18: error: No resource identifier found for attribute 'content' in package 'com.XXX'

名为“内容”的属性在项目 A 中 MultiDirectionSlidingDrawer 使用的 XML 中定义：

```
<resources>
 <declare-styleable name="MultiDirectionSlidingDrawer">
        <attr name="content" format="reference" />
        </declare-styleable>
</resources> 
```

taskslist.xml 看起来像：

```
<com.XXX.util.MultiDirectionSlidingDrawer
    xmlns:my="http://schemas.android.com/apk/res/com.XXX"
    ...
    my:content="@id/content">
    <include
        android:id="@+id/content"
        layout="@layout/menuwithll" />
    <ImageView
        android:id="@+id/handle"
        ... />
</com.XXX.util.MultiDirectionSlidingDrawer> 
```

实际上，我在项目 A 中查看了 R.java。有一个名为“content”的 attr 喜欢：

```
public static final class attr {
     public static int content=0x7f010002;
} 
```

有人知道这个问题吗？提前致谢！！！

顺便提一句。我试过干净的项目。并在“Android”和“Java 构建路径”中配置项目 B。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T16:05:53.443

对于以后也有这个问题的人。通过在布局文件中添加以下代码来解决非常简单：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:my="http://schemas.android.com/apk/res-auto" 
```

# android - 将数据从通知传输到新活动

> ID：16194930
> 
> 赞同：0
> 
> 时间：2013-04-24T14:41:09.557
> 
> 标签：android

我有一个`Activity`调用带有一些文本的显示通知，单击通知后我想用该文本打开一个新活动，因此我创建了通知：

```
NotificationManager notManager;
Notification myNot;
PendingIntent pIntent;
Intent intent;

    protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    nm = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
    Button startBtn = (Button)findViewById(R.id.btnStart);
    tvForNot = (TextView)findViewById(R.id.editText1);
    intent = new Intent(this, BrowserActivity.class);
    intent.putExtra("text", "textToSend");
    pIntent = PendingIntent.getActivity(this, 0, intent, 0);

    OnClickListener startBtnListener = new OnClickListener() {

        @Override
        public void onClick(View v) {
            textToSend = tvForNot.getText().toString();
            notManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE);
            myNot = new Notification(R.drawable.ic_launcher, "title", System.currentTimeMillis());

              func1(textToSend);
            notManager.notify(1,myNot );

        }
    };
    startBtn.setOnClickListener(startBtnListener);

}
public void func1 (String text){
    myNot.setLatestEventInfo(this, "title11", text, pIntent);
} 
```

在`BrowserActivity`我想显示文本但似乎传输的数据有一些问题

```
public class BrowserActivity extends Activity {

  @Override
  protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.browser);

    Intent intent = getIntent();

    String fileName = intent.getStringExtra("text");

    TextView textViewDisplay = (TextView) findViewById(R.id.textW);
    textViewDisplay.setText(fileName);

  }
} 
```

文件名始终为空！我的问题在哪里？为什么我无法提取这些数据？

# asp.net - 在中继器项目中找不到控件

> ID：16194931
> 
> 赞同：1
> 
> 时间：2013-04-24T14:41:09.903
> 
> 标签：asp.net, repeater

我正在使用中继器：

```
<asp:Repeater ID="rptCategories" runat="server" OnItemDataBound="RptCategories_ItemDataBound">
            <ItemTemplate>
                <asp:Panel CssClass="category-wrapper" ID="pnlCategory" runat="server">
                    <%# Eval("SponsorshipCategoryName") %>
                    <asp:HiddenField runat="server" ID="hdnCategoryID" Value='<%# Eval("SponsorshipCategoryID") %>' />
                </asp:Panel>
            </ItemTemplate>
        </asp:Repeater> 
```

根据我的类别类型，我`RadionButtonList`在后面的代码中添加或复选框列表到面板。

我设置了id：

```
rblItems.ID = "rbl_" + category.SponsorshipCategoryID; 
```

然后把控制放在`panel`：

```
panel.Controls.Add(rblItems); 
```

现在我需要能够遍历所有类别面板并获取那些单选按钮列表或复选框。

为此，我循环`rptCategories.Items`

```
 foreach (RepeaterItem rptItem in rptCategories.Items)
           {
               var hdnCategoryID = rptItem.FindControl(HdnCategoryID_ID) as 
                  HiddenField;
               var pnlCategory = rptItem.FindControl(PnlCategory_ID) as Panel;
               var categoryID = (hdnCategoryID == null || hdnCategoryID.Value == 
               string.Empty) ? 0 : int.Parse(hdnCategoryID.Value);
           } 
```

它发现隐藏字段和面板就好了。但是当我试图在我的面板中找到具有我感兴趣的 ID 的控件时，它返回 null。

```
var control = pnlCategory.FindControl("rbl_" + categoryToUpdate.SponsorshipCategoryID); 
```

我不能在这里使用项目数据绑定事件。任何想法可能是什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T17:12:02.617

它可能是两个问题之一（或两者兼而有之）：

1.  您正在动态添加控件：`panel.Controls.Add(rblItems)`. 为了让您能够检索这些动态添加的控件，*必须*在每次回发时重新添加它们。恕我直言，添加动态添加控件的最佳位置是在 `OnInit()`活动期间。

2.  正如@skhurams 所指出的：动态添加的控件的 ID 可能存在问题。尽管您为每个控件显式设置了 ID，但中继器会自动更改这些 ID，以确保在特定页面上没有重复 ID。查看是否是这种情况的最佳方法是查看生成的网页的来源。检查 ID 是否与您期望的不同。您可以选择将其设置`ClientIDMode`为“静态”，但要确保每个 ID 都是真正唯一的。

# ios - 在本地安全地存储在应用程序购买数据中

> ID：16194934
> 
> 赞同：3
> 
> 时间：2013-04-24T14:41:31.693
> 
> 标签：ios, security, in-app-purchase, store

我目前正在开发一个包含应用程序购买的 ios 应用程序。目前，我将购买的产品标识符存储在 Documents 文件夹中的文件中。我假设该目录对用户不可用，但我被告知某些 pc 应用程序能够访问该目录。

有没有人建议将数据安全地存储在设备上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T13:15:51.603

我建议你看看这个帖子：

[http://maniacdev.com/2011/12/tutorial-securing-ios-app-data-using-the-data-protection-api-keychain-and-cryptography/](http://maniacdev.com/2011/12/tutorial-securing-ios-app-data-using-the-data-protection-api-keychain-and-cryptography/)

这是一个分为两部分的教程，带有实际示例。

问候，

法比奥@fcerullo

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:55:30.010

您需要使用钥匙串来存储安全数据。

[http://dev-metal.blogspot.co.il/2010/08/howto-use-keychain-in-iphone-sdk-to.html](http://dev-metal.blogspot.co.il/2010/08/howto-use-keychain-in-iphone-sdk-to.html)

# ajax - 重定向的相同 XMLHttpRequest 实例？

> ID：16194936
> 
> 赞同：0
> 
> 时间：2013-04-24T14:41:34.993
> 
> 标签：ajax, xmlhttprequest

如果 ajax 请求返回 302，重定向会发生在同一个 XMLHttpRequest 实例上吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T21:55:23.873

是的，浏览器将处理重定向，您将从浏览器最终使用的最终资源中获得响应。如果 302 重定向到与 XHR 来源不同的域，您仍然必须在该服务器上启用 CORS 标头。

# jquery - 是否可以在 mouseenter 上暂停 jQuery list_ticker 插件？

> ID：16194938
> 
> 赞同：0
> 
> 时间：2013-04-24T14:41:40.987
> 
> 标签：jquery, ticker

我正在使用[list_ticker 插件](https://github.com/alexefish/ticker)来滚动浏览一些列表元素。

我想知道当鼠标悬停在它上面时是否可以暂停自动收报机，以便用户有时间阅读内容（这只是几个词，但它们包括某人可能想要记下的日期和时间）。

感谢您的关注。

**jQuery函数：**

```
/* List Ticker by Alex Fish 
// www.alexefish.com
//
// options:
//
// effect: fade/slide
// speed: milliseconds
*/

(function($){
  $.fn.list_ticker = function(options){

    var defaults = {
      speed:4000,
      effect:'slide'
    };

    var options = $.extend(defaults, options);

    return this.each(function(){

      var obj = $(this);
      var list = obj.children();
      list.not(':first').hide();

      setInterval(function(){

        list = obj.children();
        list.not(':first').hide();

        var first_li = list.eq(0)
        var second_li = list.eq(1)

        if(options.effect == 'slide'){
            first_li.slideUp();
            second_li.slideDown(function(){
                first_li.remove().appendTo(obj);
            });
        } else if(options.effect == 'fade'){
            first_li.fadeOut(function(){
                second_li.fadeIn();
                first_li.remove().appendTo(obj);
            });
        }
      }, options.speed)
    });
  };
})(jQuery); 
```

**Javascript：**

```
$(document).ready(function() {
    $('#next-ex').list_ticker({
        speed: 6000,
        effect: 'fade'
    });
}); 
```

**HTML：**

```
<ul id='next-ex'>
    <li>Item 1</li>
    <li>Item 2</li>
    <li>Item 3</li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:00:01.730

显然，这个插件中没有内置这样的功能。这里有两个选择：谷歌获得更高级的插件或快速而肮脏的补丁。

```
(function($){
  $.fn.list_ticker = function(options){

    var defaults = {
      speed:4000,
      effect:'slide'
    };

    var options = $.extend(defaults, options);

    return this.each(function(){

      var obj = $(this);
      var list = obj.children();
      var stopped = false; //flag if we should stop ticking
      list.not(':first').hide();

        obj.hover( function(){ //adding hover behaviour
            stopped = true;
        }, function(){
            stopped = false;
        });

      setInterval(function(){
          if(stopped) {return;} //Quick check inside interval

        list = obj.children();
        list.not(':first').hide();

        var first_li = list.eq(0)
        var second_li = list.eq(1)

        if(options.effect == 'slide'){
            first_li.slideUp();
            second_li.slideDown(function(){
                first_li.remove().appendTo(obj);
            });
        } else if(options.effect == 'fade'){
            first_li.fadeOut(function(){
                second_li.fadeIn();
                first_li.remove().appendTo(obj);
            });
        }
      }, options.speed)
    });
  };
})(jQuery); 
```

工作示例[http://jsfiddle.net/tarabyte/8zLuY/](http://jsfiddle.net/tarabyte/8zLuY/)

# android - 当我尝试将显示设置为 MediaPlayer 时，表面已被释放

> ID：16194941
> 
> 赞同：19
> 
> 时间：2013-04-24T14:41:50.373
> 
> 标签：android, surfaceview, android-mediaplayer

我的 xml 文件：

```
<SurfaceView
    android:id="@+id/surfaceView"
    android:layout_marginTop="50dp"
    android:layout_width="fill_parent"
    android:layout_height="300dp" /> 
```

我设置显示的功能：

```
public void playVideo() {
    MediaPlayer mp = new MediaPlayer();
    SurfaceView sv = (SurfaceView) this.findViewById(R.id.surfaceView);
    try {
        mp.setDataSource("sdcard/test/a.3gp");
        SurfaceHolder sh = sv.getHolder();
        mp.setDisplay(sh);***----the exception occured here***
        mp.prepare();
        mp.start();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (SecurityException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

日志如下：

```
04-24 22:19:33.645: W/System.err(16106): java.lang.IllegalArgumentException: The surface has been released
04-24 22:19:33.645: W/System.err(16106):    at android.media.MediaPlayer._setVideoSurface(Native Method)
04-24 22:19:33.645: W/System.err(16106):    at android.media.MediaPlayer.setDisplay(MediaPlayer.java:698) 
```

我在这里发现了一些类似的问题，但所有这些都不适合我。等待您的答复。非常感谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-24T15:05:22.200

表面可以被破坏。这就是为什么您需要将 a 添加到`public void surfaceDestroyed(SurfaceHolder holder)`SurfaceView 的实现中，如下所示：

> ```
>  @Override
> public void surfaceDestroyed(SurfaceHolder holder) {
>     synchronized (this) {
>         hasActiveHolder = false;
> 
>         synchronized(this)          {
>               this.notifyAll(); 
>         }
>     } 
> } 
> ```

您还应该添加一个处理 Surface 创建的函数：

> ```
> @Override
> public void surfaceCreated(SurfaceHolder holder) {
>      synchronized (this) {
>         hasActiveHolder = true;
>         this.notifyAll()
>      }
> } 
> ```

并以这种方式修改您自己的功能：

```
 mp.setDataSource("sdcard/test/a.3gp");
    SurfaceHolder sh = sv.getHolder();
    synchronized (this) {
       while (!hasActiveHolder) {
              try {
                  this.wait();
              } catch (InterruptedException e) {
                //Print something
              }
        }
        mp.setDisplay(sh);
        mp.prepare();
    } 
```

您还有另一种选择，这是 Google 建议您使用 SurfaceView 的方式：在单独的线程中。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-07-21T09:09:19.847

这与执行顺序有关，因为在设置显示之前必须先创建表面`MediaPlayer`，因此您必须将回调方法覆盖`surfaceCreated`为以下内容：

```
@Override
public void surfaceCreated(SurfaceHolder holder) {
    mp.setDisplay(sh); // now "mp" is defined as a class variable
} 
```

现在不需要在你的播放方法中设置显示：

```
private MediaPlayer mp; // to use it inside surfaceCreated callback method
public void playVideo() {
    mp = new MediaPlayer();
    SurfaceView sv = (SurfaceView) this.findViewById(R.id.surfaceView);
    try {
        mp.setDataSource("sdcard/test/a.3gp");
        SurfaceHolder sh = sv.getHolder();
        mp.prepare();
        mp.start();
    } catch (IllegalArgumentException e) {
        e.printStackTrace();
    } catch (SecurityException e) {
        e.printStackTrace();
    } catch (IllegalStateException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-08-24T07:14:22.230

使用 SurfaceHolder.Callback 如下

```
SurfaceView mSurfaceView = (SurfaceView) findViewById(R.id.surfaceView);
SurfaceHolder holder = mSurfaceView.getHolder();
final MediaPlayer player = new MediaPlayer();

holder.addCallback(new SurfaceHolder.Callback() {
    @Override
    public void surfaceCreated(SurfaceHolder holder) {
        player.setDisplay(holder);
    }

    @Override
    public void surfaceChanged(SurfaceHolder holder, int format, int width, 
    int height) {

    }

    @Override
    public void surfaceDestroyed(SurfaceHolder holder) {

    }
});

String UrlPath="android.resource://"+getActivity().getPackageName()+"/"+R.raw.your_file_name_without_extension;
try {
    player.setDataSource(getActivity(),Uri.parse(UrlPath));
    player.prepareAsync();
} catch (IOException e) {
    e.printStackTrace();
}
player.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {

    @Override
    public void onPrepared(MediaPlayer mp) {
        mp.start();
    }
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-03-08T22:37:06.803

`setDisplay`最简单的方法就是调用`surfaceCreated`：

```
@Override
public void surfaceCreated(SurfaceHolder holder) {
    mp.setDisplay(holder)
} 
```

并且不要忘记取消绑定表面：

```
@Override
public void surfaceDestroyed(SurfaceHolder holder) {
    mp.setDisplay(null);
} 
```

**注意：媒体播放器应该在之前的某个地方初始化，例如在`onCreate`.**

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-11-16T17:29:10.803

对于那些仍然有问题的人，请尝试在您的活动/片段/等和**onCreate/onCreateView**方法中实现**SurfaceHolder.Callback ，调用****addCallback(SurfaceHolder.Callback 回调)**方法，使用您的活动/片段/等作为参数回调。

 ***** * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-08T05:19:45.307

我们可以看一下VideoView源码：

```
SurfaceHolder.Callback mSHCallback = new SurfaceHolder.Callback(){
...
    public void surfaceCreated(SurfaceHolder holder)
    {
        mSurfaceHolder = holder;
        openVideo();
    }
    private void openVideo() {
        ...
        mMediaPlayer = new MediaPlayer();
        mMediaPlayer.setDisplay(mSurfaceHolder);
    }
} 
```

所以我们可以知道我们应该`mediaplayer.setDisplay()`在`surfaceCreate`方法被调用时使用。****

# c# - C# List - 添加到列表底部

> ID：16194947
> 
> 赞同：4
> 
> 时间：2013-04-24T14:42:06.513
> 
> 标签：c#, list

我有一个`List<T>`并且想从底部开始添加，但我得到了一个运行时`IndexOutOfBoundsException`。

我已经初始化了一个容量列表：

```
List<ClassA> ClassesOfA = new List<ClassA>(10);
...
...
ClassesOfA[5] = classAObj;
... 
```

有没有办法做到这一点？

我需要这样做，因为我正在从底部分析另一个列表并将结果添加到该列表中。所以我需要能够从底部添加。有没有办法做到这一点，而不是在添加我的对象之前初始化`List<ClassA>`with`ClassA`对象？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-24T14:42:51.220

要将项目添加到列表中，您应该调用`ClassesOfA.Add()`. 以这种方式添加的任何项目都将添加到列表的末尾（不确定列表的开头或列表的结尾是您认为的底部）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-24T14:51:15.947

您可以尝试像这样添加元素：`ClassesOfA.Add(classAObj)`，然后在添加所有列表元素后，您可以调用`ClassesOfA.Reverse()`以反转列表内对象的顺序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-24T14:48:36.523

如果您的第二个列表与您正在处理的第一个列表具有相同数量的元素，我认为您想要使用的只是一个数组，例如：

```
var myArray = new ClassA[listA.Count];
for (int i = 0; i < listA.Count; ++i) myArray[i] = Process(listA[i]); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-24T14:52:13.723

或者，最好保留两个列表并在最后连接它们：

```
var firstList = new List<ClassA>(); 
var secondList = new List<ClassA>();

// Fill the lists.

return firstList.Concat(secondList).ToList(); // using System.Linq; 
```

* * *

但是，如果您真的想走您建议的路线：

您需要根据需要添加尽可能多的空项目以“保留”空间：

```
var list = new List<ClassA>(10);
list.AddRange(new ClassA[5]);

// Or...
var list = Enumerable.Repeat<ClassA>(null, 5).ToList(); 
```

现在您可以继续`Add`从索引 5 开始的项目：

```
list.Add(new ClassA()); 
```

容量不会用尽可能多的项目预先填充列表。如果您想将前 5 个留空，这是我能看到的最好的。

添加将从此时将项目附加到列表的底部。我不完全确定您为什么要这样做。

# ios - 使用带有自定义参数的 Malcom API 发送推送通知

> ID：16194951
> 
> 赞同：4
> 
> 时间：2013-04-24T14:42:13.657
> 
> 标签：ios, apple-push-notifications, malcom

我正在尝试使用 Malcom API 在推送通知中发送自定义参数，但我无法从我的 iOS 应用程序中读取它们。

卷曲示例：

```
curl -u user:pass -H "Content-Type: application/json" -X POST -d '{ "notification": { "applicationCode": "appUDID", "environment": "SANDBOX", "message": "Message", "udids": [ "00c93096526860d932ba1bf116e752b8f2689675" ], "notificationCustomization": { "customfield": [ {"entry": { "key":"new_id", "value": "25" }} ], "badge": 5 } } }' http://api.mymalcom.com/v3/notification/push 
```

iOS 代码（AppDelegate）：

```
- (void)application:(UIApplication *)application didReceiveRemoteNotification:(NSDictionary *)userInfo {

    [MalcomLib didReceiveRemoteNotification:userInfo active:[MalcomLib getAppActive]];

} 
```

userInfo 包含以下信息：

```
{
    aps =     {
        alert = "Message";
        badge = 5;
    };
    notificationId = 521726;
} 
```

你知道我在哪里可以读取这些参数吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-24T14:58:48.470

我认为你的 JSON 不够好。它应该是这样的：

```
{
"notification":{
  "applicationCode":"yourApplicationCode",
  "environment":"SANDBOX",
  "message":"YourMessage",
  "notificationCustomization":{
     "customFields":{
        "entry":[
           {
              "key":"yourkey1",
              "value":"yourvalue1"
           },
           {
              "key":"yourkey2",
              "value":"yourvalue2"
           },
           {
              "key":"yourkey3",
              "value":"yourvalue3"
           }
        ]
     }
  } 
```

} }

希望这可以帮助。

# c# - 使用新断言扩展 XUnit Assert 类

> ID：16194952
> 
> 赞同：14
> 
> 时间：2013-04-24T14:42:18.647
> 
> 标签：c#, extension-methods, assert, xunit.net

我正在尝试通过添加一些硒功能来扩展 xUnit 断言方法

```
namespace MyProject.Web.Specs.PageLibrary.Extensions
{
    public static class AssertExtensions
    {
        public static void ElementPresent(this Assert assert, ...)
        {
            if (...)
            {
                throw new AssertException(...);
            }
        }
    }
} 
```

但是当我尝试使用它时出现这个编译错误。

```
using MyProject.Web.Specs.PageLibrary.Extensions;    
using Xunit;
...

public void DoSomething()
{
    Assert.ElementPresent(...);
} 
```

和错误

```
Error   5   'Xunit.Assert' does not contain a definition for 'ElementPresent' 
```

有谁知道这是否可能或我哪里出错了？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2014-05-04T02:25:34.127

**Edit 2** xUnit 2 最终将断言完全移到了一个单独的程序集中。在 NuGet 上既有编译包也有源包，并且`Assert`类是部分的，因此通过使用包的仅限源版本，`Assert`变得非常容易扩展（即在 C# 中）。

**编辑**为了更完整：xUnit 2 删除了这个扩展点，并建议使用“流利的”断言库的扩展方法。

* * *

为了完整起见，这里是对“官方”扩展方式的描述`Assert`（令人惊讶的是，它根本没有被提及，尽管 Brad Wilson 甚至加入了讨论）。

从版本 1.5（根据 Brad 的博客）开始，xUnit.Extensions 通过`Assertions`和`TestClass`类明确支持这一点。它是这样工作的：

`TestClass`有一个名为`Assert`that 的属性，它是`Assertions`中继所有方法的类型`Xunit.Assert`。因为`TestClass.Assert`是一个实例，你可以通过扩展方法给它添加方法`Assertions`：

```
public static class AssertionsExtensions
{
    public static void DeepEquals(this Assertions assertions, XNode expected, XNode actual)
    {
        assertions.True(XNode.DeepEquals(expected, actual)); // You can also use Assert.True here, there's effectively no difference.
    }
} 
```

现在您需要让您的测试类派生自`Xunit.Extensions.TestClass`（令人困惑的是，还有`Xunit.TestClass`，这不是您想要的），如果您没有明确限定名称，该`Assert`属性将“隐藏”类型。`Xunit.Assert`

在派生自 的测试类中`TestClass`，您现在可以使用

```
Assert.DeepEquals(expectedXml, actualXml); 
```

与内置 xUnit 断言的唯一真正区别（除了语法着色`Assert`是标识符，而不是类型的事实）是，当它失败时，您只需得到 a `TrueException`，而不是`DeepEqualsException`可以假设告诉您*在哪里*的具体比较失败。当然，你也可以用同样的方式来构建它。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-03-18T15:32:41.630

**xUnit 2**的解决方案摘要。（为 NuGet 的 2.1.0 版为我工作。）

Assert 是一个部分类，您可以通过添加另一个部分来扩展它。为此，您需要从源代码编译 Assert 程序集。您可以使用`xunit.assert.source`NuGet 获取源代码。

**步骤**

1.  **从项目中删除**对`xunit.assert`NuGet 包的引用。
2.  而是安装**`xunit.assert.source`**包。
3.  在`Xunit`命名空间中，定义`public partial class Assert`并添加您的自定义断言。
4.  在您的测试项目中安装`xunit.extensibility.execution`包（否则两个不同的`Assert`类之间会发生冲突并且测试将不会运行，因为`xunit.execution.*.dll`会丢失）

自定义断言示例：

```
namespace Xunit
{ 
    public partial class Assert
    {
        public static void ArraySegmentEqual<T>(
            T[] expectedSequence, T[] buffer, int offset = 0)
        {
            for (int i = 0; i < expectedSequence.Length; i++)
            {
                int b = i + offset;

                True(buffer[b].Equals(expectedSequence[i]),
                    $"Byte #{b} differs: {buffer[b]} != {expectedSequence[i]}");
            }
        }
    }
} 
```

注意：*其他答案和编辑也指向解决方案，但我花了很多时间才从那里弄清楚。此外，我并不声称这是唯一或最好的选择。*

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-04-24T23:56:41.237

抱歉，但您感到困惑（编辑：我也是！）。xUnit.net`Assert` ~~是`static`，因此不能添加扩展（尽管其他断言库不起诉这种方法，这就是为什么人们可能期望使用扩展方法来扩展`Assert`）。因此，在 xUnit.net 世界中，如果要添加自定义断言，请添加一个具有不同名称的新静态类。~~

您可以通过以下方式更改您的课程来使您的方法有效：

```
public static class AssertExtensions
{
    public static void ElementPresent(this Assert assert, ...) 
```

至：

```
public class AssertExtensions : XUnit.Assert
{
    public static void ElementPresent(...) 
```

然后使用[Brad Wilson](https://stackoverflow.com/users/1554/brad-wilson)的添加技巧：

```
using Assert = MyProject.Web.Specs.PageLibrary.Extensions.AssertExtensions; 
```

在任何需要您的扩展名的文件的顶部。

这种技术对于添加重载很方便。

（明显的弱点是你不能有多个直接访问 via `Assert.`）

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-24T20:10:31.483

您需要将作为此参数传递给扩展方法的对象实例。在您的情况下，这将是正确的语法

```
var assert = new Assert();
assert.ElementPresent(...); 
```

但我想你不需要甚至不能创建 Assert 类的实例。

您正在尝试做的是调用扩展方法作为扩展类的静态调用，这将不起作用。但为什么不简单地打电话

```
 AssertExtensions.ElementPresent(...); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-21T14:21:36.163

我使用一个简单的`partial`助手来添加`That`属性，以便我可以轻松地在其他任何地方构建扩展：

```
// ReSharper disable once CheckNamespace
namespace Xunit
{
    public partial class Assert
    {
        [CanBeNull]
        public static Assert That => default;
    }
} 
```

阅读[Premil 的](https://stackoverflow.com/a/36088382/235671)回答如何设置项目。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-02T15:31:21.513

对于**xUnit 2+**：

1）将`xunit.assert.source`Nuget包添加到带有扩展名的项目中。

2）创建部分类定义：

```
namespace xUnit
{
  public partial class Assert
  {
    public static void ElementPresent(...)
    {
    }
  }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2019-04-07T07:06:58.270

问题是由于一个简单的封装约束：

由于`Assert`该类已将构造函数设置为`protected`您无法`Extension Method`为它创建一个，因为您无法实例化它。

所以为了扩展`Assert`，你只需要继承它：

```
public class MyExtendedAssert : Assert
{
    public void ElementPresent(...)
    {
        ...
    }
} 
```

并使用：

```
MyExtendedAssert.ElementPresent(...); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-20T14:12:53.170

我能够让@Premil 发布的解决方案起作用，但我必须参考`xunit.core`而不是`xunit.extensibility.execution`.

示例 Visual Studio 2019 解决方案位于[https://github.com/groberts314/TestXUnitCustomAssertions](https://github.com/groberts314/TestXUnitCustomAssertions)。

# java - 如何在文件末尾添加空格（新行）直到它达到一定大小？（在Java中）

> ID：16194953
> 
> 赞同：-8
> 
> 时间：2013-04-24T14:42:20.733
> 
> 标签：java

我想在文件中添加空格（或新行），直到文件大小以字节为单位 % 512 == 0，请帮助我（在 Java 中）。

我试过了

```
while(my_file.length()%512!=0)
{ 
writer.write("\n");
} 
```

，但它给了我一个无限循环，绕过了条件 % 512（我在 while 中添加了一个 System.out.println 以查看大小并且它一直在增加），此外还有一个“\n”1字节长度？因为从我得到的输出中看起来不像

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:49:28.277

既然你什么都没试过，我会给你一些伪代码来让你开始。

```
while ((file.length() % 512) != 0) {
    writeNewLineToFile("\n");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T14:48:36.553

[http://docs.oracle.com/javase/6/docs/api/java/io/File.html#length%28%29](http://docs.oracle.com/javase/6/docs/api/java/io/File.html#length%28%29) 为您提供文件对象的长度（大小）（以字节为单位）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:51:37.170

检查一下

```
 file.length() 
```

并将文本添加到文件中，直到达到所需的文件大小。

# c# - 添加用户控件会导致表单抛出资源错误

> ID：16194955
> 
> 赞同：0
> 
> 时间：2013-04-24T14:42:26.123
> 
> 标签：c#, .net, winforms, exception

所以，我有一个继承自 Uc 的用户控件 UcEx。uc 还有其他自定义控件和表单，例如 MyTree（一个 TreeView）。MyTree 和 Uc 具有位于文件 Common.resx 中的程序集 MyResources 中的本地化字符串。UcEx 是另一个窗体 MainForm 的一部分。

在这种情况下，一切看起来都很好，但是当我向 UcEx 添加一个新的 MyTree 时，它​​已经从 Uc 继承了 4 个 MyTree 类型的对象，MainForm [design] 抛出一个错误：

{找不到适合指定文化或中立文化的任何资源。确保“MyResources.Common.resources”在编译时被正确嵌入或链接到程序集“MyResources”中，或者所有需要的附属程序集都是可加载的并且是完全签名的。}

我不明白这一点，因为已经存在的所有其他 MyTree-s 都不会导致任何错误。这不是命名空间或程序集名称的问题，也不是缺少资源文件的问题，所以我不知道从哪里开始......另外，当我运行调试时，也没有抛出异常。

EDIT1：我已经尝试将**Build Action**更改为**Embedded Resource**和**Custom Tool**作为**ResXFileCodeGenerator**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T14:50:22.743

将 ResourseFile(Common.resx) 的 BuildAction 更改为 EmbededResource 并尝试。

# fonts - HtmlWorker 中的波兰字体

> ID：16194958
> 
> 赞同：0
> 
> 时间：2013-04-24T14:42:32.860
> 
> 标签：fonts, itext, polish

我想从 html 创建 pdf，我使用 itext 库我在 pdf 中遇到波兰字体问题我使用以下代码：

```
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.StringReader;

import com.itextpdf.text.Document;
import com.itextpdf.text.DocumentException;
import com.itextpdf.text.FontFactory;
import com.itextpdf.text.PageSize;
import com.itextpdf.text.html.simpleparser.HTMLWorker;
import com.itextpdf.text.html.simpleparser.StyleSheet;
import com.itextpdf.text.pdf.PdfWriter;

public class PolishFont {
public static void main(String ... args ) throws DocumentException, IOException
{
    String html = "ąśżźćęó";
    StringReader reader = new StringReader(html);// step 1: creation of a document-object
    Document document = new Document(PageSize.LETTER);
    PdfWriter.getInstance(document, new FileOutputStream("c://temp//testpdf1.pdf")); 

    HTMLWorker worker = new HTMLWorker(document);

    document.open();
    FontFactory.register("C:\\Windows\\Fonts\\times.TTF", "arial unicode ms");

    StyleSheet styleSheet = new StyleSheet();
    styleSheet.loadTagStyle("body", "encoding", "Identity-H");
    worker.setStyleSheet(styleSheet);

    worker.parse(reader);
    document.close();
}
} 
```

但是pdf只显示“ó”，哪里出错了？

# javascript - 如何使用 Html Anchor发送 AJAX Post 请求

> ID：16194959
> 
> 赞同：1
> 
> 时间：2013-04-24T14:42:38.527
> 
> 标签：javascript, ajax, jquery

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T14:46:24.820

由于您已标记 jQuery，我假设您正在使用它。如果是这样，您可以这样做：

```
// attach a click handler for all links with class "like"
$('a.like').click(function() {

    // use jQuery's $.post, to send the request
    // the second argument is the request data
    $.post('like.php', {post_id: this.id}, function(data) {
        // data is what your server returns
    });

    // prevent the link's default behavior
    return false;
}); 
```

关于您的第二个问题：**不**，除非您在 SSL (https) 中执行此操作，否则它并不能真正使其更安全。中间人仍然可以中途拦截您的消息并阅读内容。POST 比 GET 更间接（拦截和读取有效负载），但并不安全。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-24T14:49:58.277

要使用 POST 发送类似的链接 ID，您可以执行以下操作：

```
 $(document).ready(function() {
    $("a.like").click(function(event) {
        var data = event.target.id;
        $.ajax({
        type: "POST",
        url: "like.php",
        data: data
        });
    });
    }); 
```

更新了，我的代码中有错字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-24T14:47:26.227

如果我正确理解你的问题，这样的事情应该适合你：

```
$('#link_22').click(function(){
    var link = $(this).attr('id');
    $.post('/like.php/', {post_id: link});
    return false;

}) 
```

然后你可以通过 PHP 来达到这个目的：

```
$_POST['post_id']; 
```

# vb.net - 将字符串添加到位图图像并保存 vb

> ID：16194960
> 
> 赞同：0
> 
> 时间：2013-04-24T14:42:41.273
> 
> 标签：vb.net, visual-studio-2010

我尝试从位图中获取 Image 对象，然后使用它来创建图形对象。然后我使用 DrawString 函数写一些东西，然后保存它。图像已成功保存，但字符串不存在。下面是代码。

```
Dim gr As Graphics = Graphics.FromImage(NewImage)
            gr.DrawString("testSting " & temp_click.Text, font, Brushes.Black, New PointF(10, 10))
            gr.Dispose()
            NewImage.Save("C:\step" & stepNo & ".jpg", System.Drawing.Imaging.ImageFormat.Jpeg) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:52:09.993

我在带有 PictureBox 的 C# 中遇到了类似的问题。我最终不得不存储位图图像的本地副本，操作该本地副本，然后将图片框的图像属性存储为等于本地副本。这是我的代码：

```
 Bitmap bm = (Bitmap)pic.Image;

  Graphics g = Graphics.FromImage(bm);

  ...apply changes to image using g object...

  g.dispose();

  pic.Image = bm;

  pic.Save(....); 
```

希望这可以帮助。

# android - 如何在 4' 和 10' 之间设置屏幕尺寸

> ID：16194962
> 
> 赞同：0
> 
> 时间：2013-04-24T14:42:48.137
> 
> 标签：android, android-layout, android-emulator

我有三星 Galaxy S2 和三星 Note 10.1。我首先在 S2 上创建，现在我尝试在 Note10.1 上运行，但它的屏幕尺寸不同。我需要让note10.1的屏幕看起来像S2。

我尝试将大图片放入 xhdpi，但它使用 hdpi 中的图片，适用于每个屏幕尺寸。

Galaxy S2

![在此处输入图像描述](https://i.stack.imgur.com/TCuDe.png)

注释 10.1

![在此处输入图像描述](https://i.stack.imgur.com/3Ayvw.png)

这是我的xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#000000"
android:orientation="vertical" >

<project.kmutt.Action_bar_view
    android:id="@+id/actionBar"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" />

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="20dp"
    android:orientation="vertical" >
</LinearLayout>

<GridView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/gridview"
    android:layout_width="fill_parent"
    android:layout_height="979px"
    android:layout_alignParentBottom="true"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:layout_weight="0.75"
    android:columnWidth="90px"
    android:numColumns="3" 
    android:gravity="center"
    android:horizontalSpacing="10px"

    android:stretchMode="columnWidth"
    android:verticalSpacing="30px" >
</GridView>

<TableLayout
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="bottom|center_horizontal"
    android:shrinkColumns="*"
    android:stretchColumns="*" >

    <TableRow
        android:id="@+id/tableRow1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:background="#000000" >

        <ImageButton
            android:id="@+id/imageButton1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#000"
            android:src="@drawable/home" />

        <ImageButton
            android:id="@+id/imageButton2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#000"
            android:gravity="center_horizontal"
            android:src="@drawable/web" />

        <ImageButton
            android:id="@+id/imageButton3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#000"
            android:gravity="center_horizontal"
            android:src="@drawable/setting" />

        <ImageButton
            android:id="@+id/imageButton4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="#000"
            android:gravity="center_horizontal"
            android:src="@drawable/about" />
    </TableRow>

    <TableRow
        android:id="@+id/tableRow2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/textView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="Home" />

        <TextView
            android:id="@+id/textView2"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="Website" />

        <TextView
            android:id="@+id/textView3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="Setting" />

        <TextView
            android:id="@+id/textView4"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_horizontal"
            android:text="About" />
    </TableRow>
</TableLayout>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:14:33.367

为两种尺寸之一创建不同的布局文件夹。这些是您可以创建的可能的文件夹结构。

```
res/layout/my_layout.xml             // layout for normal screen size ("default")
res/layout-small/my_layout.xml       // layout for small screen size
res/layout-large/my_layout.xml       // layout for large screen size
res/layout-xlarge/my_layout.xml      // layout for extra large screen size
res/layout-xlarge-land/my_layout.xml // layout for extra large in landscape orientation

res/drawable-mdpi/my_icon.png        // bitmap for medium density
res/drawable-hdpi/my_icon.png        // bitmap for high density
res/drawable-xhdpi/my_icon.png       // bitmap for extra high density 
```

Android 将`my_layout.xml`根据运行的设备在正确的文件夹中查找文件。如果找不到特定文件夹（例如`layout-xlarge`），它将使用`my_layout.xml`默认`res/layout/`文件夹中的文件。

[您可以在此处](http://developer.android.com/guide/practices/screens_support.html)找到更多信息

并避免过于频繁地使用 LinearLayouts。如果您为多个屏幕创建一个布局文件，RelativeLayouts 会好很多。

# c# - 设置 xml 文件的文件路径

> ID：16194964
> 
> 赞同：1
> 
> 时间：2013-04-24T14:42:55.353
> 
> 标签：c#, asp.net, visual-c#-express-2010

我正在用 c# 和 asp.net 在 Visual Web Developer 2010 上制作一个项目，我想将创建的唯一命名的 xml 文件保存到主文件夹中存在的 xml 文件夹中。此刻，xml 文件（从 web 表单中的用户输入生成）保存到主文件夹中，我似乎无法让它们保存到 xml 文件夹中。

```
string xmlPath = MapPath(timeStamp + Company_Name.Text + ".xml");
//There's just some code here setting up the xml nodes.
doc.Save(xmlPath); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T14:45:37.980

```
string xmlPath =MapPath("~/xml/" + timeStamp + Company_Name.Text + ".xml");
//There's just some code here setting up the xml nodes.
doc.Save(xmlPath); 
```

# wpf - WPF - wpf 中的 LINQDataContest 类替代

> ID：16194969
> 
> 赞同：0
> 
> 时间：2013-04-24T14:43:04.877
> 
> 标签：wpf, linq

windowsform 中有`LINQDataContest`用于使用 LINQ 的类，但在`wpf`我没有找到它。

我想知道，是否有另一个类而不是“LINQDataContest”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:32:26.680

```
using System.Linq; 
```

是用于允许使用 LINQ 的标准，

不确定 LINQDataContest 的用途

# android - 无法与同一网络上的 Android 设备进行 ping/通信

> ID：16194970
> 
> 赞同：5
> 
> 时间：2013-04-24T14:43:05.493
> 
> 标签：android, networking, network-programming, ping, icmp

我有一个运行 CM10.1 的 nexus 7。出于某种原因，我无法从同一 wifi 网络上的笔记本电脑访问它。我无法向任何一个方向 ping。在过去，我只能ping 一种方式。

刚刚尝试了我的股票 htc 感觉并没有同样的问题。此外，nexus 和 htc 也无法相互连接。

我在其他 android 设备上也遇到过类似的问题，过去我正在开发一个应用程序，但我无法建立从 android 设备到我的计算机的套接字连接。一旦我能够成功地从我的设备上 ping 笔记本电脑，一切正常。

这不是持久的，过去我摆弄他们最终谈了但当时没有一致的解决方案，我从来没有找到根本原因。

我在 2 个不同的 wifi 网络上观察到了这一点

不确定这里发生了什么，我对网络的理解不是那么深。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T15:09:40.360

我的第一个猜测（假设您使用的是正确的 IP，没有防火墙冲突等）：

检查设备 WiFi 设置中的 WiFi 睡眠策略。您应该将其设置为从不，然后再次尝试 ping 它。

这就是您在 android 设备上找到该选项的方式：

设置 -> 无线和网络设置 -> Wifi 设置 -> 按菜单按钮 -> 高级 -> WiFi 睡眠策略

# javascript - 从asp中继器调用js函数

> ID：16194972
> 
> 赞同：0
> 
> 时间：2013-04-24T14:43:07.760
> 
> 标签：javascript, asp.net, visual-studio, asprepeater

我想从 Visual Studios 2012 中的 aspx 页面调用一个 javascript 函数。该函数从数据库中获取 7 个值，任意次数并根据这些值对 css 进行更改，以及一个更改每个实例的 div 标记中继器

```
<asp:Repeater ID="repModules" runat="server">
     <ItemTemplate>
         <div id="<%#Eval("ModuleID")%>" onload="callFunction()">
           //different div tags, which have their 
           //styles edited by the js function
         </div>
         <script  type="text/javascript">
          function callFunction() {
              go("M1", "name", "20", "0", "80", "50", "70");
          }
         </script>
     </ItemTemplate>
</asp:Repeater> 
```

最终目标是在函数中调用 aspx.net.cs 页面后面的变量，但它甚至无法正常工作。我曾尝试在几个地方以几种不同的方式调用该函数，并且已经坚持了一段时间。js 脚本看起来像这样：

```
 function go(Id, name, eworth, eattained, worth, attained, progress) {
    //here the variables that are read in are 
    //assigned to variables defined in the js
 } 
```

我的方式不是很确定，我们可以访问 javascript 中的 aspx 变量的任何其他方式也很好。任何输入或反馈将不胜感激。非常感谢您的宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T15:00:59.490

您正在为中继器中的每一行声明相同的函数 callFunction()。而不是这样做，我会在页面顶部声明一次。然后，在您的转发器中，调用该函数，从后面传入数据。

为此，您还可以使用 ASP.Net 功能，该功能允许您注册要在启动时调用的 javascript 代码。这是一个示例（在 VB.Net 中）。此代码将进入您的中继器的 ItemDataBound 事件处理程序。请注意，我调用的是“go()”函数而不是“callFunction()”函数。你不需要那个额外的函数，因为你可以直接调用“go()”。

```
Dim csm As ClientScriptManager = Page.ClientScript
Dim sb As New StringBuilder
sb.AppendLine("go(""M1"", ""name"", ""20"", ""0"", ""80"", ""50"", ""70"");")
csm.RegisterStartupScript(Page.GetType, "js_code_startup__unique_key", sb.ToString, True) 
```

然后，您可以将上面代码中的硬编码值替换为您的变量。请注意，我使用两个双引号来转义 sb.AppendLine 调用中代码周围的双引号。

RegisterStartupScript 调用中的第四个参数设置为 True 让它自动为您包含标签。

当页面加载时，此 javascript 代码将在页面底部加载并在遇到时执行。如果您愿意，您可以尝试通过某种类型的 onload 函数调用它（可能在您的 javascript 中分配给 window.onload，或使用 jQuery document.ready）。

如果您不想使用 ItemDataBound 事件处理程序，您可以直接在脚本标签中调用该函数（尽管如果在执行时没有加载它需要的所有项目，这可能是一个问题）。要从数据库中获取值，您可能会进行数据绑定，因此您必须像我对函数调用中的第一个参数所做的那样。

```
<script  type="text/javascript">
    go('<%# Eval("YourVarName") %>', "name", "20", "0", "80", "50", "70");
</script> 
```

**更新 - 将代码转换为 C#**

我对 C# 不太熟悉，但这就是我认为的。我把它放在 ItemDataBound 事件处理程序中。我没有对此进行测试，所以我不确定它是否 100% 准确。

```
protected void repModules_ItemDataBound(object sender, System.Web.UI.WebControls.RepeaterItemEventArgs e){ 
    if (((e.Item.ItemType == ListItemType.Item) || (e.Item.ItemType == ListItemType.AlternatingItem))) {  
        ClientScriptManager csm = Page.ClientScript;
        StringBuilder sb = new StringBuilder();
        sb.AppendLine("go(\"M1\", \"name\", \"20\", \"0\", \"80\", \"50\", \"70\");");
        csm.RegisterStartupScript(Page.GetType, "js_code_startup__unique_key", sb.ToString, true);
    }
} 
```

# java - 在Java中获取不是html的字符串的一部分

> ID：16194974
> 
> 赞同：0
> 
> 时间：2013-04-24T14:43:19.893
> 
> 标签：java, html, string, parsing, substring

在我的 Java 应用程序中，我有必须编辑的字符串。问题是这些字符串可以包含不应编辑的 HTML 标签/元素（没有 id 来检索元素）。

场景（加-）：

```
String a = "<span> <table> </table>  </span> <div></div> <div> text 2</div>";
should become: <span> <table> </table>  </span> <div></div> <div> -text 2</div>  

String b = "text";
should become: -text

String c = "<p> t </p>";
should become: <p> -t </p> 
```

我的问题是：如何检索可以包含 html 标签的字符串中的文本（无法添加 id 或类）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T14:48:21.117

您可以使用 XML 解析库。

```
String newText = null;
for ( Node node : document.nodes() ) {
  if ( node.text() != null ) newText = "-" + node.text();
} 
```

*请注意，这是伪的。*

`newText`现在将是`-text`或节点文本是什么。

**编辑：就“文本****可以**包含 html 元素” 而言，您的问题有点模棱两可。
如果它不包含 html 标签，那么您不能使用 XML 解析器，这会带来问题.. 如果它**不**包含标签，那么您为什么不能这样做...

```
String newString = "-" + a; 
```

# http - 对于哪些 3xx HTTP 代码，Location 标头是强制性的？

> ID：16194988
> 
> 赞同：14
> 
> 时间：2013-04-24T14:44:05.033
> 
> 标签：http

[RFC 2616](http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.30)将`Location`标头定义为：

> Location response-header 字段用于将接收者重定向到 Request-URI 以外的位置，以完成请求或识别新资源
> ……
> 对于 3xx 响应，该位置应指示服务器的首选 URI 用于自动重定向到资源。

AFAIK，对于`3xx Redirection`代码，`Location`标题是：

*   300多项选择：*可选*
*   301 永久移动：**必填**
*   302 找到：**必填**
*   303 见其他：**必填**
*   304未修改：不相关
*   305使用代理：不相关（？）
*   306 切换代理：不相关 (?)
*   307 临时重定向：**必需**
*   308 永久重定向：**必需**

但这只是来自个人经验。是否有定义哪些 HTTP 代码**需要**发送标`Location`头的标准？

也就是说，对于哪些 3xx 代码，HTTP 客户端在收到没有相应`Location`标头的情况下应该抛出异常？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2016-05-08T15:04:21.227

在 RFC 2616 仍然是权威的日子里，这个问题已经被问到了，所以现在 RFC 7230 到 7235 已经到位，这看起来像是一个有趣的研究项目。那么，让我们看看我们在这里得到了什么。

标`Location`头现在在[RFC 7231 第 7.1.2 节](https://www.rfc-editor.org/rfc/rfc7231#section-7.1.2)中定义：

> 在某些响应中使用“Location”标头字段来引用与响应相关的特定资源。关系类型由请求方法和状态码语义组合定义。
> 
> […]
> 
> 对于[201（已创建）](https://www.rfc-editor.org/rfc/rfc7231#section-6.3.2)响应，位置值是指请求创建的主要资源。对于 3xx（重定向）响应，Location 值是指用于自动重定向请求的首选目标资源。

该部分不将此标头仅限制为状态代码的 3xx 范围。事实上，唯一明确提到的状态代码是 201 (Created) 和[303 (See Other)](https://www.rfc-editor.org/rfc/rfc7231#section-6.4.4)。但是，没有任何状态代码实际*需要此标头的消息。*

[RFC 7231 第 6.4 节](https://www.rfc-editor.org/rfc/rfc7231#section-6.4)现在描述了 3xx 范围代码的用途：

> 3xx（重定向）类状态码表示用户代理需要采取进一步的行动来满足请求。 **如果**提供了 Location 头字段，用户代理**可以**自动将其请求重定向到 Location 字段值所引用的 URI，即使不理解特定的状态代码。

该措辞表明，存在或自动重定向到其内容都不是强制性的。

在撰写本文时，[IANA HTTP 状态代码注册表](http://www.iana.org/assignments/http-status-codes/http-status-codes.xhtml)将代码 300 到 308 列为已注册。一个（305）被废弃，一个被保留（306），剩下七个活动代码：

## 300：多项选择 - [RFC 7231，第 6.4.1 节](https://www.rfc-editor.org/rfc/rfc7231#section-6.4.1)

如果服务器知道资源的多个表示，则返回 300 代码。从 RFC 7231 开始，不再推荐`Link`通过[RFC 5988](https://www.rfc-editor.org/rfc/rfc5988)的标头来传达可能的表示列表的方法。关于`Location`标头，RFC 有这样的说法：

> 如果服务器有首选，服务器应该生成一个包含首选 URI 引用的 Location 头字段。用户代理可以使用 Location 字段值进行自动重定向。

这意味着`Location`仅当服务器具有首选表示时才使用标头。如果没有，服务器根本没有这样的偏好。

值得一提的是，`Location`标题本身不适合列出所有可能的表示，因为它的语法是一个不能包含列表的单值字段。因此，

```
Location: //example.com/a
Location: //example.com/b 
```

未定义。

## 301：永久移动 – [RFC 7231，第 6.4.2 节](https://www.rfc-editor.org/rfc/rfc7231#section-6.4.2)

此响应代码是为了让客户端知道所请求的资源有一个全新的位置：后续请求将被定向到`Location`标头中指定的位置。

> 服务器应该在响应中生成一个 Location 头字段，其中包含新永久 URI 的首选 URI 引用。用户代理可以使用 Location 字段值进行自动重定向。

同样，`Location`标题的存在不是绝对要求。缺少此标题的实用性值得怀疑。语义类似于 - 但不等于 - [410 (Gone)](https://www.rfc-editor.org/rfc/rfc7231#section-6.5.9)响应：“此资源已永久移动到一个新的但未知的位置。”

## 302：找到 – [RFC 7231，第 6.4.3 节](https://www.rfc-editor.org/rfc/rfc7231#section-6.4.3)

最初这已被指定为“临时重定向”并在以后的规范中重命名。与 301 相比，这个不能（或不应该）被缓存或用于永久重写 URL。规范的相关部分内容如下：

> 服务器应该在包含不同 URI 的 URI 引用的响应中生成 Location 头字段。用户代理可以使用 Location 字段值进行自动重定向。

我相信缺少`Location`标头的语义与 301 几乎相同：“此资源已暂时移动到一个新的但未知的位置。”

## 303：参见其他 – [RFC 7231，第 6.4.4 节](https://www.rfc-editor.org/rfc/rfc7231#section-6.4.4)

303 应该响应`POST`请求而返回，但适用于任何方法。一般来说，它的目的是让客户端知道在替代 URL 处有更合适的表示，或者请求的资源无法通过 HTTP 传输。

在这个问题的背景下，这有点让人头疼。[RFC 2616，第 10.3.4 节](https://www.rfc-editor.org/rfc/rfc2616#section-10.3.4)指出：

> 不同的 URI 应该由响应中的 Location 字段给出。

较新的 RFC 7231 的相关部分似乎只是假设`Location`存在标头：

> 服务器将用户代理重定向到不同的资源，如 Location 标头字段中的 URI 所示

勘误表中没有任何内容可以澄清这一点，因此我倾向于假设 RFC 2616 的位置。缺少`Location`标头的语义确实因请求方法而异：

*   因为`POST`这与[201（已创建）](https://www.rfc-editor.org/rfc/rfc7231#section-6.3.2)或[202（已接受）相同](https://www.rfc-editor.org/rfc/rfc7231#section-6.3.3)
*   对于任何其他方法，这与[404（未找到）相同](https://www.rfc-editor.org/rfc/rfc7231#section-6.5.4)

## 304：未修改 – [RFC 7232，第 4.1 节](https://www.rfc-editor.org/rfc/rfc7232#section-4.1)

这个响应在某种程度上是特别的，因为它强调“[indication] 用户代理需要采取进一步的行动来满足请求。” 它应该被理解为不是重定向到新的 URI 而是重定向[到本地缓存](https://stackoverflow.com/a/23647421/3012385)。`Location`RFC 7232 的相关部分根本没有提到标头。事实上，这对于我的理解来说意义不大，语义类似于“请求的该实体的表示仍然没有链接，你会在本地缓存中找到它......”这是对关注点分离的极大破坏，但是并不是说`Location`在这个地方不允许。仍然，`Content-Location`或者`Link`带有`rel=self`部分的标题更合适。前一个正在接受明确的提及：

> 生成 304 响应的服务器必须生成以下任何一个头字段，这些字段将在对同一请求的[200（OK）](https://www.rfc-editor.org/rfc/rfc7231#section-6.3.1)响应中发送：[Cache-Control](https://www.rfc-editor.org/rfc/rfc7234#section-5.2)、[Content-Location](https://www.rfc-editor.org/rfc/rfc7231#section-3.1.4.2)、[Date](https://www.rfc-editor.org/rfc/rfc7231#section-7.1.1.2)、[ETag](https://www.rfc-editor.org/rfc/rfc7232#section-2.3)、[Expires](https://www.rfc-editor.org/rfc/rfc7234#section-5.3)和[Vary](https://www.rfc-editor.org/rfc/rfc7231#section-7.1.4)。

## 305：使用代理 - [RFC 2616，第 10.3.6 节](https://www.rfc-editor.org/rfc/rfc2616#section-10.3.6)；[RFC 7231，第 6.4.5 节](https://www.rfc-editor.org/rfc/rfc7231#section-6.4.5)

出于安全考虑，从 RFC 7231 开始不推荐使用此状态代码（参见[附录 B](https://www.rfc-editor.org/rfc/rfc7231#appendix-B)）。它在 RFC 2616 中的定义如下：

> 请求的资源必须通过 Location 字段给出的代理访问。

这*意味着*存在`Location`标头，但它没有明确*要求*它。省略此标头将具有“此资源只能通过*某些*代理访问”的语义含义。

## 306：切换代理 - [draft-cohen-http-305-306-responses-00](https://datatracker.ietf.org/doc/html/draft-cohen-http-305-306-responses-00)

该代码是在 RFC 2068 最终确定并已被 RFC 2616 淘汰后作为草案引入的。据我所知，该草案从未达到推荐的状态，所以这纯粹是为了完整性。该草案的基本原理是为代理提供一种机制，以将客户（临时）引导到其他代理以进行后续请求。

该草案的一部分是引入了`Set-Proxy`标题，该标题将用于代替[第 2.2 节](https://datatracker.ietf.org/doc/html/draft-cohen-http-305-306-responses-00#page-5)`Location`中的标题：

> 在最初的 HTTP/1.1 规范中，“Location”标头用于指示代理设置。在 305 响应的上下文中，“Set-proxy”标头已弃用它的使用。所有新的实现必须发送 Set-proxy 标头。实现可以发送 'Location' 标头以允许向后兼容。

`Set-Proxy`然后在 306 的上下文中是**必需**`Location`的，而标题纯粹是可选的。由于所需的`Set-Proxy`机制旨在替换`Location`，因此缺少后一个标头不会引入语义更改。

## 307：临时重定向 – [RFC 7231，第 6.4.7 节](https://www.rfc-editor.org/rfc/rfc7231#section-6.4.7)

307 是由于 HTTP/1.1 中 302 的语义更改而引入的：虽然通过 302 重定向*可以*更改请求方法，但重定向的请求必须具有与原始请求相同的请求方法。

规范的相关部分内容如下：

> 服务器应该在包含不同 URI 的 URI 引用的响应中生成 Location 头字段。用户代理可以使用 Location 字段值进行自动重定向。

同样，`Location`似乎是可选的。对于由于缺少标头而导致的语义变化，请参见 302。

## 308：永久重定向 – [RFC 7538](https://www.rfc-editor.org/rfc/rfc7538)

与 307 一样，通过 308 进行的重定向将保留其原始请求方法。可以说 308 对 301 就像 307 对 302 一样。

从规范的[第 3 节：](https://www.rfc-editor.org/rfc/rfc7538#section-3)

> 服务器应该在响应中生成一个 Location 头字段，其中包含新永久 URI 的首选 URI 引用。

所以，总而言之，我们遇到了这种情况：

*   隐含：1 (305)
*   可选：1 (306)
*   未提及：1 (304)
*   应该：6（300；301；302；303；307；308）

“应该”将在[RFC 2119](https://www.rfc-editor.org/rfc/rfc2119)的上下文中阅读：

> 这个词或形容词“推荐”意味着在特定情况下可能存在忽略特定项目的正当理由，但在选择不同的课程之前必须理解并仔细权衡全部含义。

这与“必须”或“需要”（也在该 RFC 中）的绝对要求不同。简而言之：没有 3xx 类代码中的`Location`标头是强制性的。

需要注意的是，缺少`Location`标头的问题[并不是一个新问题](https://bugzilla.mozilla.org/show_bug.cgi?id=742508)。从[另一个答案](https://stackoverflow.com/a/21321976/3012385)：

> 301、302、303 和 307 仅在下一个 URL 已知时才提供位置。否则，客户/用户必须决定下一步做什么

# pdf - 如何阅读 PDF 文本矩阵

> ID：16194992
> 
> 赞同：7
> 
> 时间：2013-04-24T14:44:21.230
> 
> 标签：pdf, text, matrix

我正在编写一个程序来直接从我的程序创建 PDF 文件。我使用了 PDF 参考手册并设法弄清楚了除了 1 件事之外的所有内容。文本矩阵——它必须是我读过的最令人困惑的东西，用谷歌搜索、重新阅读、重新搜索和重新阅读，但仍然不理解它。大约在我认为我理解它的时候，出现了一些事情，我意识到我没有。

我遇到的问题是创建标准 11 x 8.5 大小（792 x 612）的横向 PDF 文件。我可以创建文件，并且所有内容在横向中看起来和显示正确。

现在我想删除出现在每个页面上的所有常见文本并将其放入 Form XObject 并使用 Do 将其添加到每个页面。我有这个非常适合肖像 PDF 文件。当我对 Landscape PDF 文件尝试相同的操作时，Form Xobject 文本的旋转与页面的其余部分不同。显然，页面的旋转并不关心 Form XObject。

我相信这与文本矩阵有关，我试图找到对这些值的简单解释。我了解 sin 和 cosin，但不了解如何指定值的布局。示例：我找到了旋转的解释：对于 abcdef tm 产生旋转 cos0 sin0 -sin0 cos0 0 0 将坐标系轴逆时针旋转角度 0...嗯？我理解 sin cosin 和“逆时针”但仅此而已 找不到简单的例子我想我需要看一些例子来理解这一点

文本矩阵会是什么样子：

*   0旋转？
*   90转？
*   180转？
*   270转？

我找到了这个例子，但似乎无法破译它的意思

这个文本矩阵用简单的英语翻译成什么。

示例文本矩阵：0 1 -1 0 07 07 Tm

每个值代表什么？

*   0 =
*   1 =
*   -1 =
*   0 =
*   07 =
*   07 =

任何帮助将不胜感激。任何带有简单英语解释的示例将不胜感激任何带有横向文件和表单 Xobject 的示例 PDF 文件将不胜感激一张图片值一千字，所以我通常可以用记事本打开 PDF 示例文件并找出我不明白的东西（文本矩阵除外）

谢谢理查德

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-06-19T22:55:06.497

PDF 中使用的矩阵是[仿射变换](https://en.wikipedia.org/wiki/Affine_transformation)。

`tm`将参数加载到：

|ab 0|
|cd 0|
|ef 1|

在哪里：

```
a is Scale_x
b is Shear_x
c is Shear_y
d is Scale_y
e is offset x
f is offset y 
```

可以在[http://docstore.mik.ua/orelly/java-ent/jfc/ch04_11.htm找到一个很好的介绍](http://docstore.mik.ua/orelly/java-ent/jfc/ch04_11.htm)

希望这可以帮助某人。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-15T20:01:56.723

PDF 开发人员参考 [https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/pdf_reference_archives/PDFReference.pdf中的第](https://www.adobe.com/content/dam/acom/en/devnet/pdf/pdfs/pdf_reference_archives/PDFReference.pdf)**4.2.2 章常见转换**对您来说也很有趣

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-01T10:34:13.537

## 点定义

[x, y, 1]

这是一个一维向量（数组），它把点放在坐标 x 和 y 上。1 不需要指定点位置，但它有助于计算不同坐标系中点的位置，例如从设备独立像素到设备相关像素。

## 平移计算

```
x_new = a*x + c*y + e;
y_new = b*x + d*y + f; 
```

写成 matix，计算如下：

[![](https://i.stack.imgur.com/LTzn8.png)](https://i.stack.imgur.com/LTzn8.png)

## 翻译矩阵

[![](https://i.stack.imgur.com/mEEvt.png)](https://i.stack.imgur.com/mEEvt.png)

平移移动一个点。

[1, 0, 0, 1, 发送, ty]

```
x_new = 1*x + 0*y + tx;
y_new = 0*x + 1*y + ty; 
```

或者

```
x_new = x + tx;
y_new = y + ty; 
```

## 旋转矩阵

[![在此处输入图像描述](https://i.stack.imgur.com/peYMr.png)](https://i.stack.imgur.com/peYMr.png)

[cos(theta), sin(theta), -sin(theta), cos(theta), 0, 0]

```
x_new = cos(theta)*x - sin(theta)*y + 0;
y_new = sin(theta)*x + cos(theta)*y + 0; 
```

**0度旋转**，cos(0)=1, sin(0)=0: [1, 0, -0, 1, 0, 0]

```
x_new = 1*x + 0*y + 0;
y_new = 0*x + 1*y + 0; 
```

或者

```
x_new = x;
y_new = y; 
```

**90度旋转**，cos(90)=0, sin(90)=1: [0, 1, -1, 0, 0, 0]

```
x_new = 0*x + -1*y + 0;
y_new = 1*x + 0*y + 0; 
```

或者

```
x_new = -y;
y_new = x; 
```

**180度旋转**，cos(180)=-1, sin(180)=0: [-1, 0, -0, -1, 0, 0]

```
x_new = -1*x + 0*y + 0;
y_new = 0*x + -1*y + 0; 
```

或者

```
x_new = -x;
y_new = -y; 
```

**270度旋转**，cos(270)=0, sin(270)=-1: [0, -1, 1, 0, 0, 0]

```
x_new = 0*x + 1*y + 0;
y_new = -1*x + 0*y + 0; 
```

或者

```
x_new = y;
y_new = -x; 
```

## 示例文本矩阵

[0 1 -1 0 07 07]

0 1 -1 0：旋转 90 度 07 07：在每个 x 和 y 方向上平移（偏移）7

# java - java parse_str 替代方案 - 用于 http 响应

> ID：16194994
> 
> 赞同：1
> 
> 时间：2013-04-24T14:44:22.777
> 
> 标签：java, parsing, httpresponse

Facebook 服务器端登录以以下格式发送响应：

```
access_token=USER_ACCESS_TOKEN&expires=NUMBER_OF_SECONDS_UNTIL_TOKEN_EXPIRES 
```

除了编写自定义代码之外，有没有办法在 Java 中方便地解析它？[类似于 PHP 中的parse_str](http://php.net/manual/en/function.parse-str.php)的东西。

编辑：这个问题与查询字符串或请求无关，它是关于以上述格式解析请求正文。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T14:49:56.577

您可以使用字符串拆分方法和映射编写一个简单的解析器，如下所示：

```
Map<String,String> fbParam = new HashMap<String,String> ();
String[] pairs = fbResp.split("&");
for(String pair : pairs) {
  String[] keyval = pair.split("=");
  fbParam.put(keyval[0], keyval[1]);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T09:21:52.180

如果您在 Java EE 环境中，则可以使用[`ServletRequest.getParameter()`](http://java.sun.com/j2ee/sdk_1.3/techdocs/api/javax/servlet/ServletRequest.html).

您也可以考虑使用[Web4J Framework](http://www.web4j.com/)的请求解析器。

# c# - 将 WSDL 转换为 C# 类

> ID：16194995
> 
> 赞同：-1
> 
> 时间：2013-04-24T14:44:26.870
> 
> 标签：c#, web-services, wsdl

我在与我的快递 (www.raben.com) 集成时遇到问题。我有 WSDL 架构[http://integrator.raben-group.com/pl/?soap=itginterface.wsdl](http://integrator.raben-group.com/pl/?soap=itginterface.wsdl)

我正在使用 VS2012 .NET 4.0，项目类型是更大的解决方案中使用的类库。我添加了参考>添加服务参考-> [http://integrator.raben-group.com/pl/?soap=itginterface.wsdl](http://integrator.raben-group.com/pl/?soap=itginterface.wsdl) > Go > Ok

VS 添加新的 sys 文件夹 Service References 并将我的新“IntegratorRabenServiceReference”

我用 XDocument 创建了 XML，我怎样才能将我发送给他们？

编辑：

```
Sample XML data http://jelux.pl/Integrator/sample_data.xml
XSD file http://jelux.pl/Integrator/transport-order-information.xsd
and instruction to XML file http://jelux.pl/Integrator/Import.pdf 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T15:04:16.500

从某种意义上说，您的问题告诉我们您并不真正知道自己在做什么。“如何将化油器固定在我的胡萝卜上？”。目前的格式不太合适，但无论如何我都会尽力帮助你:)

您创建的是使用 Web 服务的代理类。您应该能够创建类似于 a`IntegratorRabenService`的东西，其中您拥有所有必要的方法。如果您愿意，它是 Web 服务的代理。

```
var service = new IntegratorRabenService(); // Using default endpoint
var data = .... // Whatever your method needs
var result = service.ProxyMethodCall(data);
// Do something with result. 
```

希望对一些人有所帮助:)

如果您需要一个完整的示例，我也可以为您提供帮助，因为 Web 服务似乎是公开的，但您需要告诉我 :)

# ruby-on-rails-3 - 是否可以在 PostgreSQL 中有一个 hstore 数组

> ID：16194998
> 
> 赞同：5
> 
> 时间：2013-04-24T14:44:34.133
> 
> 标签：ruby-on-rails-3, postgresql, activerecord, postgresql-9.1

我是 PostgreSQL 的完整初学者。我对 Postgres 提供的 hstore 数据类型感到非常惊讶。好吧，我正在使用 Rails 3 框架并开发一个使用 PostgreSQL 的简单应用程序。我想在一个字段中存储一个哈希数组。例如：

```
authors: [
           {
             name: "abc",
             email: "abc@example.com"
           },
           {
             name: "xyz",
             email: "xyz@example.com"
           }
         ] 
```

在使用 Rails 3 的 PostgreSQL 中这可能吗？如果是这样，有人可以就如何提供见解吗？

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-05T01:55:13.970

当然可以在 Rails 4 中创建一个 array-of-hstore 列，例如在表创建中使用这样的列规范：

```
t.hstore :properties, :array => true 
```

然而，Rails 4.0 中存在一个编码错误，不幸的是使它们无法使用。本质上，您可以从中读取它们，并且它们正确地显示为哈希数组，但不能写入。

我在[https://github.com/rails/rails/issues/11135](https://github.com/rails/rails/issues/11135)打开了一个问题（带有修复补丁） ，希望很快就会被合并。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-27T09:18:21.610

我不确定他们是否允许您拥有一个 hstore 数组，但是有一些活动记录扩展可以添加 hstore 和数组类型。例如：

[https://github.com/funny-falcon/activerecord-postgresql-arrays](https://github.com/funny-falcon/activerecord-postgresql-arrays)

[https://github.com/engageis/activerecord-postgres-hstore](https://github.com/engageis/activerecord-postgres-hstore)

[https://github.com/tlconnor/activerecord-postgres-array](https://github.com/tlconnor/activerecord-postgres-array)

不要错过 Rails 4 相关的改进：

[http://blog.remarkablelabs.com/2012/12/a-love-affair-with-postgresql-rails-4-countdown-to-2013](http://blog.remarkablelabs.com/2012/12/a-love-affair-with-postgresql-rails-4-countdown-to-2013)