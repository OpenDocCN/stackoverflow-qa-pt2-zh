# StackOverflow 问答 14676000-14676999

# python - 从外部函数访问列表

> ID：14676000
> 
> 赞同：0
> 
> 时间：2013-02-03T18:51:41.970
> 
> 标签：python, list, function, global

我有一个我在里面创建的列表`function1`。我希望能够在`function2`. 如果没有全局变量，我怎么能做到这一点？

两个函数都没有嵌套在另一个函数中，我需要能够将其概括为多个函数中的多个列表。

我希望能够访问`word_list`和`sentence_starter`其他功能。

```
def Markov_begin(text):
    print create_word_lists(text)
    print pick_starting_point(word_list)
    return starting_list

def create_word_lists(filename):
   prefix_dict = {}    
   word_list = []
   sub_list = []
   word = ''

   fin = open(filename)
   for line in fin:
      the_line = line.strip()
      for i in line:
           if i not in punctuation:
               word+=(i)
           if i in punctuation:
               sub_list.append(word)
               word_list.append(sub_list)
               sub_list = []
               word = ''
      sub_list.append(word)
      word_list.append(sub_list)
   print 1
   return word_list

def pick_starting_point(word_list):
    sentence_starter = ['.','!','?']
    starting_list = []
    n = 0
    for n in range(len(word_list)-1):
        for i in word_list[n]:
            for a in i:
                if a in sentence_starter:
                    starting_list += word_list[n+1]
    print 2                
    return starting_list

def create_prefix_dict(word_list,prefix_length):
    while prefix > 0:
        n = 0
        while n < (len(word_list)-prefix):
            key = str(''.join(word_list[n]))
            if key in prefix_dict:
                prefix_dict[key] += word_list[n+prefix]
            else:
                prefix_dict[key] = word_list[n+prefix]
           n+=1
       key = ''
       prefix -=1

print Markov_begin('Reacher.txt') 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T18:59:09.630

您应该将其重构为一个类：

```
class MyWords(object):
  def __init__(self):
    self.word_list = ... #code to create word list

  def pick_starting_point(self):
    # do something with self.word_list
    return ... 
```

用法

```
words = MyWords()
words.pick_starting_point()
... 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T18:55:01.033

您可以简单地使用第一个函数创建的列表作为第二个函数的参数：

```
def some_list_function():
  # this function would generate your list
  return mylist

def some_other_function(mylist):
  # this function takes a list as an argument and process it as you want
  return result

some_other_function(some_list_function()) 
```

但是，如果您需要在多个地方使用列表（由多个函数处理），那么将其存储为变量并不是一件坏事 - 更重要的是，如果您的列表生成函数进行一些计算来生成列表，那么您就是通过只计算一次来节省 CPU。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:02:10.550

如果您不想a）使用全局或b）返回列表并传递它，那么您将不得不使用一个类并将您的列表保存在那里。

上课路线最好

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-02-03T19:01:23.293

函数可以具有属性值（例如，请参阅[问题 338101。](https://stackoverflow.com/questions/338101/python-function-attributes-uses-and-abuses)）

在当前上下文中，您可以将 、 、 和 等项目保存和引用`prefix_dict`为`word_list`计算`sub_list`它们`word`的任何函数的单独属性，如下例所示。但是，正如其他答案中所建议的那样，从长远来看，使用类更容易理解和维护。

例如：

```
In [6]: def fun1(v):
    fun1.li = range(v,8)
    return v+1
   ...: 

In [7]: def fun2(v):
    fun2.li = range(v,12) + fun1.li
    return v+2
   ...: 

In [8]: fun1(3)
Out[8]: 4

In [9]: fun2(6)
Out[9]: 8

In [10]: fun2.li
Out[10]: [6, 7, 8, 9, 10, 11, 3, 4, 5, 6, 7] 
```

# css3pie - CSS Pie 无法使用正确的文件路径

> ID：14676012
> 
> 赞同：1
> 
> 时间：2013-02-03T18:53:00.293
> 
> 标签：css3pie

我正在尝试在我的网站中使用 CSS PIE，但由于某种原因它无法正常工作。

我的文件夹结构如下所示：
![在此处输入图像描述](../Images/ace38554eaf5679246e9282ba6df9175.png)

我的CSS是这样的：

```
.region-sidebar-first-inner .block-menu-block-1 {
  background: #730868;
  margin-bottom: 70px;
  background: -webkit-gradient(linear, 0 0, 0 bottom, from(#730868), to(#0a9f9d));
  background: -webkit-linear-gradient(top, #730868 0%, #0e70a2 76%,#0a9f9d 100%);
  background: -moz-linear-gradient(top, #730868 0%, #0e70a2 76%,#0a9f9d 100%);
  background: -ms-linear-gradient(top, #730868 0%, #0e70a2 76%,#0a9f9d 100%);
  background: -o-linear-gradient(top, #730868 0%, #0e70a2 76%,#0a9f9d 100%);
  background: linear-gradient(top, #730868 0%, #0e70a2 76%,#0a9f9d 100%);
  -pie-background: linear-gradient(top, #730868 0%, #0e70a2 76%,#0a9f9d 100%);
  behavior: url(pie/PIE.htc);
} 
```

当我在 Chrome 中检查我的`PIE.htc`-file 时，路径链接到正确的文件，因此它是有效路径。

尽管 CSS Pie 警告我`Note: this path is relative to the HTML file being viewed, not the CSS file it is called from`，但这对我也不起作用......所以其他东西一定是错的，我不知道是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-10T23:37:43.653

中的路径`behavior: url(...);`必须相对于`HTML`您使用该样式的文件，而不是相对于`CSS`文件！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T07:59:00.540

您必须从包含 CSS 文件的文件（使用 PIE 的 CSS）链接您的 PIE.php（或 PIE.htc，但 PIE.php 更好，因为这包括 PIE.htc 并且您对 .htaccess 文件没有问题） .

我的情况是：行为：url（funkce/PIE.php）；

树（此文件/文件夹在同一级别）：
字体（文件夹）
funce（文件夹）
img（文件夹）
模板（文件夹）
slash_something.php（文件）

在模板文件夹中，我有文件夹 css，其中有使用 PIE 的 CSS 文件。我在文件夹“funkce”中的 PIE.php 文件。=> 我必须链接“funkce/PIE.php” => 在你的情况下，提示 - 行为：url(css/pie/PIE.htc);

# javascript - 使用媒体源 API 附加 .webm 视频块不适用于每个视频

> ID：14676016
> 
> 赞同：4
> 
> 时间：2013-02-03T18:53:08.367
> 
> 标签：javascript, video-streaming, html5-video

我已经修改了这个[例子](http://html5-demos.appspot.com/static/media-source.html)，以便用我自己的视频运行它。它不适用于任何视频。

特别是，如果视频的持续时间 > 5 秒（我的意思是完整的视频文件，而不是一个块），它就**不会开始播放**，这似乎根本不合理，我不知道为什么会发生这种情况。

每次调用方法 append() 和 endofstream() 时，我都会得到**INVALID_STATE_ERR : DOM Exception 11**

顺便说一句，我尝试了很多不同的视频更改参数，它似乎并不取决于文件大小，而只取决于持续时间。所以视频的一小部分确实有效。

webkitsourceopen 事件被触发，但不是 webkitsourceend。

这种“限制”从何而来？

# apache - 搞砸了 .htaccess [R=301,L]

> ID：14676017
> 
> 赞同：1
> 
> 时间：2013-02-03T18:53:09.850
> 
> 标签：apache, .htaccess

我想我搞砸了我的 .htaccess

我正在玩弄我的永久链接，现在当我想将它重置回正常的本地主机时。它不像往常一样工作。我不得不写“localhost/index.php”或“127.0.0.1”来打开通常的“localhost”。我该如何解决？

我正在使用它然后一切都开始出错，即使我在“RewriteEngine On”之后输入任何乱码。输入“localhost”不会出现页面错误，除非输入“localhost/index.php”或“127.0.0.1”：

```
Options -Multiviews
RewriteEngine On
RewriteBase /

RewriteCond %{HTTP_HOST}  !^\.
RewriteRule ^(.*) /$1 [R=301,L] 
```

如果我想将其全部重置为正常（只需键入 localhost，它会自动调出我的 localhost index.php）。我必须将 httpd.conf 文件设置回默认值吗？如果是这样，我在哪里可以获得 apache 2.4.2 的默认 httpd.conf 文件？

# c - 安装 OpenCV 并使用 GCC 编译 C 程序

> ID：14676018
> 
> 赞同：6
> 
> 时间：2013-02-03T18:53:15.743
> 
> 标签：c, gcc, opencv, header, linker

作为我正在进行的一个更大项目的一部分，我需要在 C 程序上使用 OpenCV 库。我在 Fedora 17 32 位中使用 yum 安装了 OpenCV 和 opencv-devel。我指示预处理器导入 opencv/cv.h 和 opencv/highgui.h 作为必要的头文件。

正如我所提到的，gcc 用于编译整个 C 项目。但是，链接器似乎存在问题。

每当我尝试编译项目 ( `gcc opencv.c -o opencv`) 时，我都会得到一个错误列表，类似于：

```
/tmp/ccLJWE0c.o: In function `cvRound': opencv.c:(.text+0x19):
undefined reference to `lrint' /tmp/ccLJWE0c.o: In function
`cvDecRefData': opencv.c:(.text+0xa5c): undefined reference to
`cvFree_' opencv.c:(.text+0xacd): undefined reference to `cvFree_'
/tmp/ccLJWE0c.o: In function `cvGetRow': opencv.c:(.text+0xbc3):
undefined reference to `cvGetRows' /tmp/ccLJWE0c.o: In function
`cvGetCol': opencv.c:(.text+0xbee): undefined reference to `cvGetCols'
/tmp/ccLJWE0c.o: In function `cvReleaseMatND': opencv.c:(.text+0xc01):
undefined reference to `cvReleaseMat' /tmp/ccLJWE0c.o: In function
`cvSubS': opencv.c:(.text+0xd21): undefined reference to `cvAddS'
/tmp/ccLJWE0c.o: In function `cvCloneSeq': opencv.c:(.text+0xd6f):
undefined reference to `cvSeqSlice' /tmp/ccLJWE0c.o: In function
`cvSetNew': opencv.c:(.text+0xdce): undefined reference to `cvSetAdd'
/tmp/ccLJWE0c.o: In function `cvGetSetElem': opencv.c:(.text+0xe61):
undefined reference to `cvGetSeqElem' /tmp/ccLJWE0c.o: In function
`cvEllipseBox': opencv.c:(.text+0xf61): undefined reference to
`cvEllipse' /tmp/ccLJWE0c.o: In function `cvFont':
opencv.c:(.text+0xfb1): undefined reference to `cvInitFont'
/tmp/ccLJWE0c.o: In function `cvReadIntByName':
opencv.c:(.text+0x103f): undefined reference to `cvGetFileNodeByName'
/tmp/ccLJWE0c.o: In function `cvReadRealByName':
opencv.c:(.text+0x10d0): undefined reference to `cvGetFileNodeByName'
/tmp/ccLJWE0c.o: In function `cvReadStringByName':
opencv.c:(.text+0x112a): undefined reference to `cvGetFileNodeByName'
/tmp/ccLJWE0c.o: In function `cvReadByName': opencv.c:(.text+0x115a):
undefined reference to `cvGetFileNodeByName' opencv.c:(.text+0x1170):
undefined reference to `cvRead' /tmp/ccLJWE0c.o: In function
`cvCreateSubdivDelaunay2D': opencv.c:(.text+0x11a3): undefined
reference to `cvCreateSubdiv2D' opencv.c:(.text+0x11cd): undefined
reference to `cvInitSubdivDelaunay2D' /tmp/ccLJWE0c.o: In function
`cvContourPerimeter': opencv.c:(.text+0x1307): undefined reference to
`cvArcLength' /tmp/ccLJWE0c.o: In function `cvCalcHist':
opencv.c:(.text+0x132f): undefined reference to `cvCalcArrHist'
/tmp/ccLJWE0c.o: In function `main': opencv.c:(.text+0x14cd):
undefined reference to `cvCreateImage' opencv.c:(.text+0x1510):
undefined reference to `cvGet2D' opencv.c:(.text+0x159e): undefined
reference to `cvSet2D' opencv.c:(.text+0x15df): undefined reference to
`cvSaveImage' collect2: error: ld returned 1 exit status 
```

另外，当我使用以下方法编译程序时：

```
gcc opencv.c -o opencv `pkg-config --libs --cflags opencv` -ldl 
```

我仍然得到：

```
/usr/bin/ld: /tmp/ccMRviO3.o: undefined reference to symbol 'lrint@@GLIBC_2.1'
/usr/bin/ld: note: 'lrint@@GLIBC_2.1' is defined in DSO /lib/libm.so.6 so try adding it to the linker command line
/lib/libm.so.6: could not read symbols: Invalid operation
collect2: error: ld returned 1 exit status 
```

我一直在努力寻找解决方案，但似乎没有什么能解决问题。在 OpenCV 文档中，他们提到了安装所需库的不同方式，但我并不真正理解我必须遵循的步骤。我认为 Fedora 开发了已编译并可以使用的软件包。无论如何，如果这是问题所在，有没有一种简单的方法可以让整个事情顺利进行？

我已经用 Visual Basic 编码 6 年了，但我刚刚开始学习 C 作为我大学教育的一部分；因此我在操作 GCC 方面不是很有经验。:(我会要求你尽可能解释清楚！:)

任何帮助表示赞赏！提前致谢！！！:D

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T18:58:37.793

尝试添加`-lm`, 以包含提供的数学库`lrint`（请参见[此处](http://www.kernel.org/doc/man-pages/online/pages/man3/lrint.3.html)）

# css - 使用 div 创建三行，如 table tr

> ID：14676019
> 
> 赞同：3
> 
> 时间：2013-02-03T18:53:25.603
> 
> 标签：css, html

我想创建简单的`div`三行（无表概念）。

我在 Google 中尝试了所有方法，但没有得到简单的格式。

例如在表格中，这样很容易：

```
<table width="100%" border="0" cellspacing="0" cellpadding="0">
   <tr>
      <td>&nbsp;</td>
   </tr>
   <tr>
      <td>&nbsp;</td>
   </tr>
   <tr>
      <td>&nbsp;</td>
   </tr>
</table> 
```

对不起，如果我在这里问一个非常简单的问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T19:32:52.997

# HTML4 和 HTML5 方法

有时最好用尽可能少的代码对元素进行编码，下面您可以查看 HTML5 和 HTML4 文档类型中列和行的理想编码。重要的是要注意 HTML5 不会取代 DIV，但在我的示例中，它表明有时您不需要使用它们，如果这意味着减少您的代码。

# 3 Columns 一个简单的 HTML5 方法，无需额外的 div

**HTML5**

```
<article id="fruits">

    <hgroup>    
        <h1>Some of My Favorite Fruits</h1>
        <h2>I generally prefer fruits that are not to sweet</h2>
    </hgroup>

    <section>
        <h2>Bananas<h2>
        <p>Some Text..</p>
    </section>

    <section>
        <h2>Kiwi<h2>
        <p>Some Text..</p>
    </section>

    <section>
        <h2>Pears<h2>
        <p>Some Text..</p>
    </section>

</article> 
```

**CSS**

```
#fruits section {width:100%;padding:20px 0;} 
```

# 3 列使用带有少量类的简单 HTML4 方法

**HTML4**

```
<div class="3-columns">

    <div>I'm Column 1</div>

    <div>I'm Column 2</div>

    <div>I'm Column 3</div>

</div> 
```

**CSS**

```
.3-columns {}
.3-columns div {width:100%;padding:20px 0;} 
```

# 3 行使用简单的 HTML5 方法，无需额外的 div

**HTML5**

```
<article id="fruits">

    <hgroup>    
        <h1>Some of My Favorite Fruits</h1>
        <h2>I generally prefer fruits that are not to sweet</h2>
    </hgroup>

    <section>
        <h2>Bananas<h2>
        <p>Some Text..</p>
    </section>

    <section>
        <h2>Kiwi<h2>
        <p>Some Text..</p>
    </section>

    <section>
        <h2>Pears<h2>
        <p>Some Text..</p>
    </section>

    <div class="clear"> </div>

</article> 
```

**CSS**

```
#fruits section {float:left;width:33.3%;}
.clear {clear:both;} 
```

# 3 行使用带有少量类的简单 HTML4 方法

**HTML4**

```
<div class="3-rows">

    <div>I'm Row 1</div>

    <div>I'm Row 2</div>

    <div>I'm Row 3</div>

</div> 
```

**CSS**

```
.3-rows {}
.3-rows div {width:33.3%;float:left;} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T18:57:49.940

您所要做的就是创建一个 div，然后为它创建三个子 div：

```
<div>
   <div>Content</div>
   <div>Content</div>
   <div>Content</div>
</div> 
```

这应该适用于默认样式，您将获得内容行。如果您需要有关特定样式的更多帮助，请发表评论。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T18:56:36.730

正如其他人之前在该网站上所指出的，您可能希望使用表格标签而不是 div 来显示表格数据。

请参阅[如何仅使用 <div> 标签和 Css 创建表](https://stackoverflow.com/questions/3053205/how-create-table-only-using-div-tag-and-css)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T18:57:28.527

## 1 行 3 列

```
<div>
   <div class="id">Stack</div>
   <div class="id">Overflow</div>
   <div class="id">Rulez</div>
</div> 
```

以及样式代码：

```
<style type="text/css" media="screen">
   .id {
      width:33%;
      float:left;
   }
</style> 
```

## 1 列 3 行

```
<div>
   <div>Stack</div>
   <div>Overflow</div>
   <div>Rulez</div>
</div> 
```

# c# - Epson Bitmap ESC 代码中心图像

> ID：14676022
> 
> 赞同：0
> 
> 时间：2013-02-03T18:54:01.067
> 
> 标签：c#, bitmap, spacing, epson, receipt

这是我到目前为止设置的内容

[http://nicholas.piasecki.name/blog/2009/12/sending-a-bit-image-to-an-epson-tm-t88iii-receipt-printer-using-c-and-escpos/](http://nicholas.piasecki.name/blog/2009/12/sending-a-bit-image-to-an-epson-tm-t88iii-receipt-printer-using-c-and-escpos/)

我按照本指南进行操作，现在可以将位图图像打印到收据打印机。

但是现在我会在收据打印机上将图像居中对齐，并且似乎可以理解如何在他的代码中实现这一点。有人可以帮我弄清楚在哪里插入空格来实现这一点吗？

这是取自代码的写入位数组部分：

```
 bw.Write(AsciiControlChars.Newline);
    bw.Write("                 Hello World!");
    bw.Write(AsciiControlChars.Newline);
    bw.Write("          "); 
```

## **^^^This bw.Write(" "); 移动第一行**

```
 // So we have our bitmap data sitting in a bit array called "dots."
    // This is one long array of 1s (black) and 0s (white) pixels arranged
    // as if we had scanned the bitmap from top to bottom, left to right.
    // The printer wants to see these arranged in bytes stacked three high.
    // So, essentially, we need to read 24 bits for x = 0, generate those
    // bytes, and send them to the printer, then keep increasing x. If our
    // image is more than 24 dots high, we have to send a second bit image
    // command.

    // Set the line spacing to 24 dots, the height of each "stripe" of the
    // image that we're drawing.
    bw.Write(AsciiControlChars.Escape);
    bw.Write('3');
    bw.Write((byte)24);

    // OK. So, starting from x = 0, read 24 bits down and send that data
    // to the printer.
    int offset = 0;

    while (offset < data.Height)
    {
        bw.Write(AsciiControlChars.Escape);
        bw.Write('*');         // bit-image mode
        bw.Write((byte)33);    // 24-dot double-density
        bw.Write(width[0]);  // width low byte
        bw.Write(width[1]);  // width high byte

        for (int x = 0; x < data.Width; ++x)
        {
            for (int k = 0; k < 3; ++k)
            {
                byte slice = 0;

                for (int b = 0; b < 8; ++b)
                {
                    int y = (((offset / 8) + k) * 8) + b;

                    // Calculate the location of the pixel we want in the bit array.
                    // It'll be at (y * width) + x.
                    int i = (y * data.Width) + x;

                    // If the image is shorter than 24 dots, pad with zero.
                    bool v = false;
                    if (i < dots.Length)
                    {
                        v = dots[i];
                    }

                    slice |= (byte)((v ? 1 : 0) << (7 - b));
                }

                bw.Write(slice);
            }
        }

        offset += 24;
        bw.Write(AsciiControlChars.Newline);
    }
    // Restore the line spacing to the default of 30 dots.
    bw.Write(AsciiControlChars.Escape);
    bw.Write('3');
    bw.Write((byte)30);
    bw.Write("Text Is awsome");
    bw.Write(AsciiControlChars.Newline);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T03:48:34.830

基本上问题是，由于我们调用了位图图像模式，因此我们插入的任何空间并没有真正向流中添加任何空间，因此为了解决所有问题，您必须在垂直循环中关闭位图图像模式并添加空格然后只需将模式切换回位图图像模式。

# matlab - 如何在matlab中使用蒙特卡罗方法？

> ID：14676024
> 
> 赞同：1
> 
> 时间：2013-02-03T18:54:07.427
> 
> 标签：matlab, integration, montecarlo

我需要使用蒙特卡罗方法和 10^7 个随机数来验证 pi = 0 到 2 of(sqrt(4-x^2))dx 的积分。我对如何在 matlab 中实现这一点有点困惑。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T19:03:26.703

积分描述了四分之一圆。要计算 pi，请按照以下步骤操作：

1.  在 [0 2] x [0 2] 中生成坐标 (x, y) 的 10 ^ 7 个点
2.  计算具有 x ^ 2 + y ^ 2 <= 4 属性的点。让`n`他们计数。
3.  计算 pi 值：`pi = 4 * n / 10 ^ 7`

# nginx - nginx重写中的正则表达式不匹配

> ID：14676032
> 
> 赞同：0
> 
> 时间：2013-02-03T18:55:19.977
> 
> 标签：nginx, rewrite

我正在为 nginx 编写重写规则，但不断出现循环问题如何编写正则表达式以仅匹配`?page=home`但停在`?page=m-home`

这是我现在拥有的，但实际上并没有用

```
if ($args ~ page=[^m\-](.+)){
  set $a $1;
  rewrite ^(.+)$ /cms/index.php?page=m-$a permanent;
} 
```

# html - 如何使整个页面保持原样？

> ID：14676034
> 
> 赞同：0
> 
> 时间：2013-02-03T18:56:02.720
> 
> 标签：html, css

当我的页面达到其断点并且元素开始逃离其 div 时，我想获得一个水平滚动条。我将我的标题设置为内联背景图像，但是......你知道，它当然会保持在原来的位置并移出 div。当窗口变得太小时没有响应。帮助！

```
#logo { 
    background-repeat:no-repeat; 
    background-position: top center; 
    background-size: 100%; 
} 

#mainnavi { 
    border-top:inset gold 3px; 
    background-color:#000033; 
    border-bottom:inset gold 3px; 
    height:45px; text-align:center; 
    font-size:13px; 
    width:100%; 
    text-shadow:20%; 
}   

a:link,a:visited { 
    font-weight:bold; 
    display:inline-block; 
    color:#FFFFFF; 
    background-color:#000033; 
    text-align:center; 
    height:30px; 
    width:120px; 
    text-decoration:blink; 
    overflow:hidden; 
} 
a:hover,a:active { 
    background-color:#000099;
} 
```

这就是我为导航和我的标志所做的。

# c - 如何使用makefile创建两个具有不同-D变量=值的C可执行文件

> ID：14676035
> 
> 赞同：0
> 
> 时间：2013-02-03T18:56:03.610
> 
> 标签：c, makefile

我的代码使用我在构建过程中定义的一个宏，如下所示。

```
gcc -D VAR=1000 main.c -0 main 
```

但我想创建两个可执行文件，一个 VAR=1000，另一个 VAR=2000。假设可执行文件名称为 main_1000 和 main_2000。

我怎样才能使用 Makefile 做到这一点。

我的尝试如下。但它不起作用并给我一个错误。

```
gcc -g   -c -o main.o main.c
main.c: In function ‘main’:
main.c:5:16: error: ‘VAR’ undeclared (first use in this function)
main.c:5:16: note: each undeclared identifier is reported only once for each function it appears in
make: *** [main.o] Error 1 
```

生成文件：

```
CC=gcc
CFLAGS=-g

all: main_1000 main_2000

main_1000: main.o
    $(CC) -D VAR=1000 -o main_1000 main.o $(CFLAGS)

main_2000: main.o
    $(CC) -D VAR=2000 -o main_2000 main.o $(CFLAGS) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T18:59:01.550

```
main_1000: main.o 
```

这意味着您已经期望`main.o`在那里。由于没有将文件编译为`c`文件的规则`o`，`make`因此使用其隐式规则，该规则不包含定义。你想要的是这样的：

```
CC=gcc
CFLAGS=-g

all: main_1000 main_2000

main_1000: main.c
    $(CC) -D VAR=1000 -o $@ $^ $(CFLAGS)

main_2000: main.c
    $(CC) -D VAR=2000 -o $@ $^ $(CFLAGS) 
```

# css - 带有预包装的谷歌浏览器错误

> ID：14676036
> 
> 赞同：9
> 
> 时间：2013-02-03T18:56:03.590
> 
> 标签：css, google-chrome

我想要实现的是**在 textarea 中保留序列空格，并且在行尾不中断单词**。

所以根据这个： [http ://www.w3schools.com/cssref/pr_text_white-space.asp](http://www.w3schools.com/cssref/pr_text_white-space.asp)

当我们设置

```
white-space: pre-wrap; 
```

应该保留 WHITESPACES 并且最后不要拆分单词。

然而，正如这个 jsfiddle 所展示的，谷歌浏览器不保留空格序列（文本区域中有很多空格，但 chrome 显示较少。请注意每个其他浏览器如何显示它们，但 chrome 没有）。

[http://jsfiddle.net/LXUEe/2/](http://jsfiddle.net/LXUEe/2/)

这个问题有什么解决办法吗？

我可以使用以下方法保留空格：

```
white-space: pre; 
```

但随后所有长词都在行尾拆分（尽管仅适用于 chrome...）

有什么解决办法吗？

提前致谢！

**编辑**：尝试在该 jsfiddle 的一行中不断输入空格。光标一旦到达最右端就会卡住并且不会进入下一行（chrome）

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-06T08:30:03.473

我想说 Chrome 是唯一正确遵循[W3C 建议](http://www.w3.org/TR/CSS21/text.html#white-space-model)的浏览器。

看第二点 4

> 如果行尾的空格 (U+0020) 或制表符 (U+0009) 将 **'white-space' 设置为 'pre-wrap'，UA 可能会在视觉上折叠它们**。

希望有帮助。

# uiscrollview - 在标签栏项目之间切换后，UIScroller 无法向上滚动

> ID：14676039
> 
> 赞同：0
> 
> 时间：2013-02-03T18:56:13.797
> 
> 标签：uiscrollview, uitabbar

当第一次按下标签栏项目时，滚动条可以完美运行。我在标签栏项目之间切换后，滚动条只能以我最初设置的宽度和高度向下移动。

这是我的代码

```
-(void)viewDidAppear:(BOOL)animated{
[scroller2 setScrollEnabled:YES];
[scroller2 setContentSize:CGSizeMake(320, 2000)];

[super viewDidAppear:animated]; 
```

我将非常感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T16:19:19.637

我有同样的问题......试试这个：

```
- (void) viewWillDisappear:(BOOL)animated {

    [self.scrollView setContentOffset:CGPointMake(self.scrollView.contentOffset.x, 0)
                             animated:NO];

} 
```

# objective-c - Xcode 中的 XML 解析问题？

> ID：14676041
> 
> 赞同：1
> 
> 时间：2013-02-03T18:56:22.063
> 
> 标签：objective-c, xml, xcode, xml-parsing, nsxmlparser

我正在制作一个 mac 应用程序，我需要它来解析本地 xml 文件并将其显示到 tableView 中。出于某种原因，我的 tableView 中有一个空白行，这没有任何意义，因为它在我的 xml 中找到了字符。这是我的代码：

```
- (void)parserDidStartDocument:(NSXMLParser *)parser{
    NSLog(@"found file and started parsing");
}

- (void)parseXMLFileAtURL:(NSString *)URL
{
    //you must then convert the path to a proper NSURL or it won't work
    NSURL *xmlURL = [NSURL URLWithString:URL];

    // here, for some reason you have to use NSClassFromString when trying to alloc NSXMLParser, otherwise you will get an object not found error
    // this may be necessary only for the toolchain

    rssParser = [[NSXMLParser alloc] initWithContentsOfURL:xmlURL];

    // Set self as the delegate of the parser so that it will receive the parser delegate methods callbacks.
    [rssParser setDelegate: self];
    // Depending on the XML document you're parsing, you may want to enable these features of NSXMLParser.
    [rssParser setShouldProcessNamespaces:NO];
    [rssParser setShouldReportNamespacePrefixes:NO];
    [rssParser setShouldResolveExternalEntities:NO];
    [rssParser parse];
}

- (void)parser:(NSXMLParser *)parser parseErrorOccurred:(NSError *)parseError {
    NSString * errorString = [NSString stringWithFormat:@"Unable to download XML feed (Error code %i )", [parseError code]];
    NSLog(@"Error parsing XML: %@", errorString);
}

- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict{
    //NSLog(@"found this element: %@", elementName);
    currentElement = [elementName copy];

    if ([elementName isEqualToString:@"event"]) {
        // clear out our story item caches...
        item = [[NSMutableDictionary alloc] init];
        date = [[NSMutableString alloc] init];
        opponent = [[NSMutableString alloc] init];
        location = [[NSMutableString alloc] init];
        time = [[NSMutableString alloc] init];
        games = [[NSMutableString alloc] init];

    }

}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName{
    NSLog(@"ended element: %@", elementName);

    if ([elementName isEqualToString:@"event"]) {
        // save values to an item, then store that item into the array...
        [item setObject:date forKey:@"date"];
        [item setObject:opponent forKey:@"opponent"];
        [item setObject:location forKey:@"location"];
        [item setObject:time forKey:@"time"];
        [item setObject:games forKey:@"games"];
        NSMutableArray *stories = [[NSMutableArray alloc] init];
        [stories addObject:[item copy]];

        [arrayController addObject:[NSDictionary dictionaryWithObjectsAndKeys:
                                    date, @"date", 
                                    opponent, @"opponent",
                                    location, @"location",
                                    time, @"time",
                                    games, @"games"
                                    , nil]];

    }

}

- (void)parser:(NSXMLParser *)parser foundCharacters:(NSString *)string{
    //NSLog(@"found characters: %@", string);
    // save the characters for the current item...

    if ([date isEqualToString:@"date"]) {
        [date appendString:string];
    } else if ([opponent isEqualToString:@"opponent"]) {
        [opponent appendString:string];
    } else if ([location isEqualToString:@"location"]) {
        [location appendString:string];
    } else if ([time isEqualToString:@"time"]) {
        [time appendString:string];
    } else if ([games isEqualToString:@"games"]) {
        [games appendString:string];
    }
}

- (void)parserDidEndDocument:(NSXMLParser *)parser {
    NSLog(@"all done!");
    [tabelview reloadData];
} 
```

当我删除我的添加部分时，它将项目添加到 arraycontroller，并添加

`[arrayController addObject:stories];`我得到了一堆`('s`

如果您还有其他需要，不要只是投反对票，而是告诉我。谢谢！

这是我的xml：

```
 <?xml version="1.0" encoding="ISO-8859-1"?>
<xmlData>
    <event>
        <date>date here</date>
        <opponent>opponent here</opponent>
        <location>location here</location>
        <time>time here</time>
        <games>games here</games>
    </event>
    <event>
        <date>date here</date>
        <opponent>opponent here</opponent>
        <location>location here</location>
        <time>time here</time>
        <games>games here</games>
    </event>
    <event>
        <date>date here</date>
        <opponent>opponent here</opponent>
        <location>location here</location>
        <time>time here</time>
        <games>games here</games>
    </event>
    <event>
        <date>date here</date>
        <opponent>opponent here</opponent>
        <location>location here</location>
        <time>time here</time>
        <games>games here</games>
    </event>
</xmlData> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:11:55.783

错误在您的解析器中。请修改逻辑。`item`填充表格视图数组时，您没有使用您的对象。此外，您没有捕捉 XML 元素之间的文本，也没有将它们分配给适当的变量。

请注意以下事项：

*   当您输入一个元素时，跟踪您当前所在的元素
*   当您找到字符时，您必须根据您所在的元素填充适当的属性变量
*   完成`event`元素后，您应该将您`item`的所有填充键添加到数据数组中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:50:11.137

你需要知道如何使用数组。您正在分配一个数组**stories**。但后来没有使用。请检查您的 didEndElement 方法。

创建一类事件，创建 .h 和 .m 文件，然后创建所有元素的属性，然后将**事件**类的整个对象添加到数组中。您可以在 appHandler 或 Single ton 类中使用该数组。

检查这件事。愿它帮助你。

# variables - 难以理解 Lisp 中的变量重新分配

> ID：14676047
> 
> 赞同：0
> 
> 时间：2013-02-03T18:57:10.863
> 
> 标签：variables, lisp

我在理解 nconc 的一些实验的结果时遇到了一些问题。

```
(setf x '(a b c))
(setf y '(1 2 3))

(nconc x y) ; => x = (A B C 1 2 3), y = (1 2 3) 
```

根据我的阅读，nconc 将 x 的其余字段更改为指向 y。

```
(setf (nth 1 y) 10) ; => x = (A B C 1 10 3), y = (1 10 3) 
```

到现在为止还挺好。

```
(setf y '(4 5 6)) ; => x = (A B C 1 10 3) y = (4 5 6) 
```

为什么 x 仍然引用旧的 cons 单元格，或者换句话说，重新分配 y 不只是改变 y 地址处的数据？

在此先感谢迈克尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:49:47.003

Lisp 变量不指向固定内存。它们指向 Lisp 数据对象。设置变量不会更改任何对象内存。该变量只是指向一些其他数据。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T19:28:26.867

因为最后一个`cons`in`x`设置为指向指向的`cons`那个`y`。它不会`y`动态或通过引用指向 ' 值。

```
(setf x '(a b c))
; x = (a b c)
(setf y '(1 2 3))
; x = (a b c)
; y = (1 2 3)
(nconc x y)
; x = (a b c 1 2 3)
; y = (1 2 3) = (nthcdr 3 x)
(setf (nth 1 y) 10)
; x = (a b c 1 10 3)
; y = (1 10 3) = (nthcdr 3 x)
(setf y '(4 5 6))
; x = (a b c 1 10 3)
; y = (4 5 6) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:32:19.853

nconc 将 x 的其余字段更改为指向的**值**。`y`该**值** `y`是 y 指向的单元格。如果您将`y`指针移动到另一个目标， 的其余字段`x`将不会改变，并且仍将指向`(1 2 3)`。

# javascript - 检测何时应用 css

> ID：14676049
> 
> 赞同：4
> 
> 时间：2013-02-03T18:57:20.183
> 
> 标签：javascript, jquery, css

我正在构建一个基于 AJAX 的网站，其中所有网站内容都通过 AJAX 加载。

某些页面具有与内容一起加载的 CSS（代码如下）。加载 HTML 和 CSS 后，我会运行一些脚本来更改某些图像位置、更改宽度等。

问题是有时我的 javascript在应用 CSS 规则*之前就被执行了。*例如：如果我的 div 宽度根据 css 应该是 200px，有时 javascript 将其读取为 1000px，所以我得到了错误的计算。

我的研究并没有产生一个跨浏览器的解决方案，不仅可以检测加载的图像，还可以检测加载的 CSS 和其他所有内容。

我使用 jQuery 的 AJAX 函数来获取所需的 HTML（这部分工作正常）。获得 HTML 后，我将其与[**jQuery 的 html 函数**](http://api.jquery.com/html/)一起应用。

完成后，我使用此代码加载所需的 css：

```
css         = document.createElement('link');
css.rel     = 'stylesheet';
css.type    = 'text/css';
css.media   = "all";
css.href    = url;
document.getElementsByTagName("head")[0].appendChild(css); 
```

我*可以*使用超时功能，但这只是盲目猜测，我想确保我的脚本在需要运行时运行。有什么建议吗？

**编辑**我已包含此图像以使解释更清晰

![在此处输入图像描述](../Images/81a7746f4f23955c13595e2905dc5c3f.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T02:06:37.907

以前从未尝试过，但是[样式表加载事件](https://developer.mozilla.org/en-US/docs/HTML/Element/link#Stylesheet_load_events)呢？如果 IE 不会触发该`onload`事件，并且您需要支持它，`onreadystatechange`则应该可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-05T13:27:28.953

我很高兴看到我不是唯一一个有这个问题的人。我有一些 JavaScript 需要在 CSS 样式应用于 DOM 之后运行。

我认为 ZER0 建议的是一个很好的解决方案，但我无法`OnLoad`在我的 CSS 标记上使用该事件，因为我在文档*末尾*`<link>`加载了一个串联/缩小的 JS 文件，而我的串联/缩小 CSS 位于*顶部*文档。

 ****我的解决方案：**`<style>`使用标签 将 JavaScript 依赖的基本 CSS 样式直接放在 DOM 上。

这样，当 DOM 加载时，样式会立即应用。到 JS 运行时，DOM 已经应用了基本样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T22:02:40.547

我认为你把问题复杂化了。如果您将所有 CSS 设置为仅对某个父类做出反应——例如：如果您动态加载 about 页面——所有 CSS 应该看起来像`.about .example {} .about h2 {} etc`. 联系页面也是如此`.contact img {}`

现在，除非您的 CSS 文件绝对庞大，否则如果您在顶部包含一个文件，您几乎可以保证 CSS 将被应用。**

# cuda - Cudafy - 如何将 machine32 传递给 nvcc

> ID：14676051
> 
> 赞同：0
> 
> 时间：2013-02-03T18:57:34.733
> 
> 标签：cuda

我试图让[cudafy.net](http://cudafy.codeplex.com/)示例在我的 64 位机器上编译。我陷入了错误：

致命错误...找不到“（null）”

这似乎是固定[在这里](https://stackoverflow.com/questions/2970493/cuda-linking-error-visual-express-2008-nvcc-fatal-due-to-null-configuratio)：

通过将 `--machine 32`参数传递给`nvcc`调用

问题：我如何在 VS2010 解决方案中做到这一点？

![在此处输入图像描述](../Images/b7d9dee1c1693b8b20a34fde65f96461.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:35:15.580

CudafyTranslator.Cudafy() 方法有几个重载。例如[，此](http://www.hybriddsp.com/Portals/0/cudafy/html/bf773c5e-fbe2-f1e6-f0b1-e8f7fc0079f6.htm)重载采用 ePlatform Enum 值，该值定义了您希望编译内核的平台（Auto、x86、x64 或两者）。

# linux - 列出最后 5 个隐藏目录的内容

> ID：14676052
> 
> 赞同：0
> 
> 时间：2013-02-03T18:57:36.183
> 
> 标签：linux, bash, shell, unix, sh

我被要求用一个命令列出当前工作目录中最后 5 个隐藏目录的内容。我认为这样的事情可以完成这项工作：

```
ls -a -1 | grep "^\." | tail -n 5 | ls 
```

但它只列出了最后五个目录的名称.. 我如何列出内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:04:25.260

```
ls -a -1 | grep "^\." | tail -n 5 | xargs ls 
```

# bash - 如何重新启用已禁用的陷阱

> ID：14676056
> 
> 赞同：0
> 
> 时间：2013-02-03T18:57:59.733
> 
> 标签：bash

我启用了一个陷阱调试

```
function my_trap ()
{
    # some code in here
}
trap 'my_trap' DEBUG 
```

然后我需要禁用它一段时间，所以我做了

```
trap - DEBUG 
```

**现在**：
我怎样才能重新启用同一个陷阱？
..无需重写：

```
trap 'my_trap' DEBUG 
```

我不想重新编写它，因为如果我更改了陷阱函数名称，我只需要更改一点即可。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:13:45.487

我只找到了以下方法：

```
traps=$( trap )
declare regex="'([^']+)' DEBUG"
[[ ${traps} =~ ${regex} ]]
trap "${BASH_REMATCH[1]}" DEBUG 
```

还有更优雅的吗？

# javascript - 茉莉花未定义

> ID：14676064
> 
> 赞同：29
> 
> 时间：2013-02-03T18:58:28.553
> 
> 标签：javascript, jasmine

我是 Jasmine 的新手，假设使用`.not.toBeDefined()`or`.toBeUndefined()`匹配项可以检查变量是否为`undefined`：

```
describe('toBeDefined', function() {

    it('should be defined', function() {
        var obj = {};
        expect(obj).toBeDefined(); // Passes
    });

    it('should not be defined using .not.tobeDefined()', function() {
        //var obj = {};
        expect(obj).not.toBeDefined(); // Fails // ReferenceError: obj is not defined
    });

    it('should not be defined using .tobeUnefined()', function() {
        //var obj = {};
        expect(obj).toBeUndefined(); // Fails // ReferenceError: obj is not defined
    });

}); 
```

我完全明白这会在代码中失败，但我假设使用这些匹配项不会。我只是使用了这些错误，还是无法编写规范来检查是否有问题`undefined`？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-03T19:22:27.393

问题是

```
 expect(obj).toBeUndefined(); 
```

*在调用 Jasmine 之前就*失败了。引用未定义的变量是错误的（至少在新浏览器或“严格”模式下）。

试试这个设置：

```
it('should not be defined using .tobeUnefined()', function() {
    var obj = {};
    expect(obj.not_defined).toBeUndefined(); 
}); 
```

在该代码中，有一个变量“obj”，其值为空对象。在 JavaScript 中引用对象的不存在属性是可以的，因为这样的引用结果在`undefined`测试中会通过。另一种方法是：

```
it('should not be defined using .tobeUnefined()', function() {
  var no_value;

  expect(no_value).toBeUndefined();
}); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-02-23T22:00:09.047

请注意，您的错误表明`obj is not defined`.

它并没有说 obj 是*undefined*。

*undefined*实际上是 Javascript 中的一种数据类型。

默认情况下，任何没有赋值的声明变量都会被赋予*undefined*值，但必须声明该变量。

因此，当 Jasmine 测试一个值是否*未定义*时，它是在确定是否`obj === undefined`。

如果你声明

```
var obj; 
```

然后`obj`将测试为未定义。

如果您不声明`obj`，那么 Jasmine 匹配器将无法与*undefined*的数据类型进行比较。

# ruby-on-rails - 无法将 rail 应用程序部署到 heroku（安装 linecache19 (0.5.12) 时出错）

> ID：14676065
> 
> 赞同：0
> 
> 时间：2013-02-03T18:58:28.510
> 
> 标签：ruby-on-rails, heroku

我正在尝试将我的铁路应用程序上传到 Heroku。我正在使用 Ruby 1.9.3。该应用程序可以在我的本地计算机上正常部署。

```
 An error occurred while installing linecache19 (0.5.12), and Bundler cannot continue.
   Make sure that `gem install linecache19 -v '0.5.12'` succeeds before bundling.
 !
 !     Failed to install gems via Bundler.
 !
 !     Heroku push rejected, failed to compile Ruby/rails app 
```

我试过将这一行输入到 Gemfile

```
gem 'linecache19', :git => 'git://github.com/mark-moseley/linecache' 
```

但这似乎并不能解决问题。

有人可以建议吗？预先感谢您的帮助。ps：对于新手的问题真的很抱歉，我在 Ruby on Rails 开发方面还很新。

下面是我完整的 Gemfile

* * *

```
source 'http://rubygems.org'

gem 'rails', '3.1.0'

# Bundle edge Rails instead:
# gem 'rails',     :git => 'git://github.com/rails/rails.git'

# for Heroku deployment - as described in Ap. A of ELLS book
group :development, :test do
 gem 'sqlite3'
 gem 'ruby-debug19', :require => 'ruby-debug'
end
group :production do
 gem 'pg'
end

# Gems used only for assets and not required
# in production environments by default.
group :assets do
 gem 'therubyracer'              
 gem 'sass-rails', "  ~> 3.1.0"
 gem 'coffee-rails', "~> 3.1.0"
 gem 'uglifier'
end

gem 'jquery-rails'

# Use unicorn as the web server
# gem 'unicorn'

# Deploy with Capistrano
# gem 'capistrano'

# To use debugger
gem 'haml'

gem 'linecache19', :git => 'git://github.com/mark-moseley/linecache' 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:29:50.177

`linecache19`是用于调试目的的 gem。生产中不需要它，因此您应该将其从生产中使用的 gem 中排除。

将其添加到`:development, :test`文件顶部已有的组中`bundle`，然后重新部署。

```
group :development, :test do
  gem 'sqlite3'
  gem 'ruby-debug19', :require => 'ruby-debug'
  gem 'linecache19', :git => 'git://github.com/mark-moseley/linecache'
end 
```

# java - XmlHttpRequest 状态=0

> ID：14676066
> 
> 赞同：0
> 
> 时间：2013-02-03T18:58:32.813
> 
> 标签：java, javascript, ajax, servlets, xmlhttprequest

我有来自 javascript 文件的这个 ajax 调用，我想将要删除的用户的 id 作为参数传递：

```
function eliminaUtente(id,nome){
if (confirm("Sei sicuro di voler eliminare l'utente "
    + nome
    + "?")) {
var xmlHttp2 = new XMLHttpRequest();
xmlHttp2.open("POST", "EliminaUtente", true);
xmlHttp2.setRequestHeader("Content-type",
        "application/x-www-form-urlencoded");
var params2 = "id=" + id;
xmlHttp2.send(params2);
xmlHttp2.onreadystatechange = function() {
    if (xmlHttp2.readyState == 4) 
    {
                    alert(xmlHttp2.status);  <-----------this prints always 0!
        if (xmlHttp2.status == 200) //
        {
            alert("utente eliminato!");
        } else {
            alert("An error occurred while communicating with server.");
        }
    }
}; 
```

} }

在名为 EliminaUtente 的对应 Servlet 中，我有以下代码：

```
 protected void doPost(HttpServletRequest request,
        HttpServletResponse response) throws ServletException, IOException {
    // TODO Auto-generated method stub
    String id = request.getParameter("id");
    System.out.println(id);
    String query = "delete from utente where idutente=" + id;
    System.out.println(query);
    try {
        Class.forName("com.mysql.jdbc.Driver").newInstance();

        Connection con = DriverManager
                .getConnection("jdbc:mysql://localhost/Spinning?user=root");
        PreparedStatement prest = con.prepareStatement(query);
        prest.executeUpdate();

        response.setContentType("text/plain");
        PrintWriter ajaxWriter = response.getWriter();
        ajaxWriter.print("ok");
        ajaxWriter.flush();
        ajaxWriter.close();

        con.close();
    } catch (Exception e) {
        e.printStackTrace();
        response.setContentType("text/plain");
        PrintWriter ajaxWriter = response.getWriter();
        ajaxWriter.print("ko");
        ajaxWriter.flush();
        ajaxWriter.close();
    }

} 
```

}

我不明白问题出在哪里……你能帮帮我吗？;)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T14:59:43.073

我尝试了您的代码并进行了一些更改，我想解释一下我做了什么以及从中学到了什么。我阅读了一些资料。首先我阅读了[XMLHttpRequest](http://www.w3.org/TR/XMLHttpRequest/)对象和[onreadyState](http://www.w3schools.com/ajax/ajax_xmlhttprequest_onreadystatechange.asp)事件。我实现了您的示例`PUT`和`GET`操作方法。

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
    version="2.5">

    <servlet>
        <servlet-name>testServlet</servlet-name>
        <servlet-class>com.test.testServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>testServlet</servlet-name>
        <url-pattern>/test/*</url-pattern>
    </servlet-mapping>

</web-app> 
```

testServlet.java

```
package com.test;

import java.io.IOException;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

public class testServlet extends HttpServlet {
    /**
     * 
     */
    private static final long serialVersionUID = 1L;

    @Override
    protected void doPost(HttpServletRequest req, HttpServletResponse resp)
            throws ServletException, IOException {
        // TODO Auto-generated method stub
        /*super.doPost(req, resp);*/
        String strId = req.getParameter("id");
        System.out.println(strId);
    }

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp)
            throws ServletException, IOException {
        // TODO Auto-generated method stub
        //super.doGet(req, resp);
        String strId = req.getParameter("id");
        System.out.println(strId);
    }
} 
```

和主要部分 NewFile.jsp

```
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Insert title here</title>
</head>
<body>
    <input type="button" value="Submit" onclick="eliminaUtente('1')" width="100%" />
</body>
<script language="javascript" type="text/javascript">
    function eliminaUtente(id) {

        var xmlHttp = new XMLHttpRequest();
        var url = "test/NewFile.jsp?id=" + id;
        xmlHttp.open("POST", url, true);
        xmlHttp.send(url);
        xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
                alert("utente eliminato!");
            } else {
                alert("An error occurred while communicating with server.");
            }
        };
    }
</script>
</html> 
```

通过这种方式，我编写参数 1（我在 jsp 文件方法调用中对其进行硬编码）并将其写入控制台，这里的第一件事是您的代码和我的代码的区别，我删除了`xmlHttp2.setRequestHeader("Content-type","application/x-www-form-urlencoded");`因为如果方法类型是`POST`默认加密就是这样。

```
enctype = content-type [CI]
This attribute specifies the content type used to submit the form to the server (when the value of method is "post"). The default value for this attribute is "application/x-www-form-urlencoded". The value "multipart/form-data" should be used in combination with the INPUT element, type="file". 
```

*   所以不需要 enctype 默认值对于`POST`.
*   这是开放方法签名`open(method, url, async, user, password)`，这里 async 是参数，这意味着如果它是假的，则不要等待来自服务器的响应，当响应到来时，它会运行另一行。如果是真的，请等到响应到来。实际上我尝试了他们的机器人并且它有效。
*   最后我用`GET`. 如果你想使用它，`GET`你应该添加`xmlHttp2.setRequestHeader("Content-type","application/x-www-form-urlencoded");`加密代码并从方法中删除`url`参数。`send()`

    功能消除（ID）{

    ```
     var xmlHttp = new XMLHttpRequest();
        var url = "test/NewFile.jsp?id=" + id;
        xmlHttp.open("GET", url, true);
            xmlHttp2.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        xmlHttp.send();
        xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4 && xmlHttp.status == 200) {
                alert("utente eliminato!");
            } else {
                alert("An error occurred while communicating with server.");
            }
        };
    } 
    ```

注意：我在 Firefox 中尝试此代码，我创建 xmlHttpRequest 对象。对于所有浏览器（包括 IE6），请确保您知道使用：

```
var xmlhttp;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:06:32.360

错字？

`alert(xmlHttp2.status);` <-----------这总是打印0！现在有“2”

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-08T11:26:34.027

问题是我必须在这一行加上 false ：

```
xmlHttp2.open("POST", "EliminaUtente", FALSE); 
```

# ruby-on-rails-3 - 如何测试javascript函数？

> ID：14676069
> 
> 赞同：1
> 
> 时间：2013-02-03T18:58:41.990
> 
> 标签：ruby-on-rails-3, capybara

是否可以使用 Capybara 在页面中测试 js 函数的存在？如果是这样，我可以打电话并检查结果吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:15:09.183

Capybara 用于通过实际呈现页面来测试 Web 应用程序的整体功能。当您使用可以执行 Javascript 的引擎时（默认的 Rack::Test 引擎不支持），您可以使用它来检查您的页面在执行相关的 Javascript 后是否确实正确呈现。有一些方法可以通过调用`page.execute_script("typeof yourFunctionName == 'function'")`（并且只有选择的引擎支持这个）来测试函数的存在并检查它的值，但知道 Capybara 它不是设计为 Javascript 测试框架。你应该为此使用茉莉花。

# javascript - 修订版 55 后 OBJLoader 不再工作

> ID：14676073
> 
> 赞同：0
> 
> 时间：2013-02-03T18:59:13.337
> 
> 标签：javascript, three.js

我正在使用 three.js 库中的 objloader 在浏览器中渲染一个多维数据集。我让它工作正常，但在从 git 加载新版本（修订版 55）后，我无法正确处理。立方体只是没有出现在浏览器中。我也使用了 git 的 demo obj loader，但没有任何改进（相机位置也可以）。objloader 不再适用于我，即使它适用于演示模型（male02.obj）也很难......加载器中有什么变化吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:25:55.417

这是[https://github.com/mrdoob/three.js/issues/2949](https://github.com/mrdoob/three.js/issues/2949)的副本据我所知，它将在 r56 中修复。同时，如果您从以前的版本中找到 OBJLoader，您可以使用它来代替。

# haskell - Haskell 广告包

> ID：14676075
> 
> 赞同：4
> 
> 时间：2013-02-03T18:59:27.707
> 
> 标签：haskell, automatic-differentiation

我想使用广告自动微分包来学习 Haskell 中的神经网络权重。我发现了一些可能只是我需要的[函数](http://hackage.haskell.org/packages/archive/ad/3.4/doc/html/Numeric-AD-Newton.html#g:2)，但是我无法弄清楚它们期望的第一个参数是什么。一定是要优化的功能，具体是什么形式我不知道。他们有这样的签名：

```
gradientDescent :: (Traversable f, Fractional a, Ord a) => (forall s. Mode s => f (AD s a) -> AD s a) -> f a -> [f a] 
```

我发现`forall s.`意思是一个名为存在量词的东西，仅此而已。我的问题是，我怎样才能将带有签名的成本函数`cost :: [Double] -> Double`（它需要权重列表）传递给这个库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T19:10:45.763

因此，第一个参数是对`AD`单个的任何可遍历的函数`AD`。对于可遍历的，我们可以用列表之类的东西来代替。该函数在模式下必须是多态的。所以让我们忽略这一点，不要做一些指定模式的事情！这个功能显然是我们正在优化的东西。下一个参数是我们传入的初始值。我们现在也将其称为列表。结果是一个稳定更优化的选择列表，用于改进对我们目标的猜测。

请注意，它是所有模式`AD s a`的一个实例，只要是`Num`和。所以只需编写一个从整数列表到单个整数的多态函数，传入一个初始状态，您提供的函数将为您优化它。`Fractional``s``a``Num``Fractional`

即不要将您的成本函数指定为双精度数，而是将其指定为任何`Num`and的多态`Fractional`，并让库处理其余部分！

您可能更愿意通过尝试其他更基本的功能（例如`diff`first）来习惯这种风格。

# c# - 我得到一个查询字符串作为从 LINQ 到 SQL 和 WCF 服务的返回值，但没有具体值

> ID：14676081
> 
> 赞同：1
> 
> 时间：2013-02-03T18:59:56.497
> 
> 标签：c#, sql, wcf, linq

我有一个愚蠢的问题，我不知道如何解决它。

我使用 Silverlight 和 Visual Studio 2010。要连接到数据库，我使用了 LINQ to SQL。到目前为止，一切都很好。一切正常，但最后我得到的结果是一个查询字符串，没有值。

我在 WCF 服务文件中的代码：

```
public string get_info()
{
    LinqMapInfoDataContext context = new LinqMapInfoDataContext();
    var result = from x in context.mytabel
                 where (x.map_x == 4) && (x.map_y == 7)
                 select x.id;
    string returnValue = result.ToString();
    return returnValue;
} 
```

和我在 mainpage.xaml.cs 中的代码

```
private void ser_client_get_infoCompleted(object sender, ServiceRefMapInfo.get_infoCompletedEventArgs e)
{
    lbl_key.Content = e.Result.ToString();
} 
```

好吧，我真的以为在编译我的项目后我会在浏览器中显示“id”（一个具体的字符串值），但没有。lbl_key.Content 显示：

```
SELECT [t0].[id] FROM [dbo].[mytable] AS [t0] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:14:16.167

您的代码应该是：

```
var id = result.FirstOrDefault();
string returnValue = Convert.ToString(id); 
```

# php - 为什么插件应该从应用程序扩展基类？

> ID：14676082
> 
> 赞同：0
> 
> 时间：2013-02-03T19:00:01.020
> 
> 标签：php, oop, cakephp, cakephp-2.3

如果您阅读了有关创建插件的 CakePHP 文档。它清楚地说明了`PluginAppModel`和基类是从和`PluginAppController`类扩展而来的。使用插件在应用程序中实现。`AppModel``AppController`

这对我来说似乎非常冒险。

插件无法控制应用程序可能在这些基类中配置的回调、组件、助手等。

`PluginAppModel`让您的/`PluginAppController`仅扩展 CakePHP 库中的基类是否有任何问题。喜欢`Model`和`Controller`？

有人可以解释为什么插件应该扩展这些应用程序特定类的逻辑吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:00:25.460

无论您做什么，都应从继承链中排除 App* 类，或者是否包含它们。总会有可能失败的地方，因为人们在这些课程中所做的事情是不可预测的。

不太可能的情况是，如果您扩展 App* 基类而不是不扩展它们，那么您的插件会出现问题。

Auth 和 Session Component 在控制器的情况下是您应该扩展 App* 类的一个很好的理由。AppModel 中的行为是另一个。

如果您的插件依赖于 Controller 或 Model 类的某个属性的某个未更改的状态，我认为您在构建该插件时做错了。最好通过提供配置选项或检查继承属性和附加组件和行为的状态来保持插件的灵活性。

如果您的插件中确实存在缺陷 - 我仍然认为它做错了 - 您应该记录它，以便阅读文档的人可以正确集成它。

# qt - QMessageBox 停止 QTimer

> ID：14676085
> 
> 赞同：0
> 
> 时间：2013-02-03T19:00:10.653
> 
> 标签：qt

我在连接到信号`QMessageBox`的插槽中创建了一个带有单个按钮“OK”的实例，并使用函数显示它，似乎计时器暂停，直到按下按钮并且盒子关闭。我希望创建本地事件循环并发送计时器消息，但是计时器被暂停（没有发出信号）。谁能解释一下？PS对不起我的英语。`QTimer``timeout()``exec``exec``timeout()`

更新：示例代码：

```
#include "mainwindow.h"
#include "ui_mainwindow.h"

MainWindow::MainWindow(QWidget *parent) :
      QMainWindow(parent),
      ui(new Ui::MainWindow)
{
  ui->setupUi(this);
  QTimer *tm1=new QTimer(this),
  *tm2=new QTimer(this);

  connect(tm1,SIGNAL(timeout()),this,SLOT(tslot1()));
  connect(tm2,SIGNAL(timeout()),this,SLOT(tslot2()));
  tm1->start(1000);
  tm2->start(1000);
}

void MainWindow::tslot1(void)
{
  static int cnt;
  qWarning(QString("slot 1 called %1 time(s)").arg(++cnt).toAscii().data());
}

void MainWindow::tslot2(void)
{
  static int cnt;
  qWarning(QString("slot 2 called %1 time(s)").arg(++cnt).toAscii().data());
  if (3==cnt)
  {
    QMessageBox *mb=new QMessageBox(QMessageBox::Critical,tr("Error"),tr("tm2 halted !"),QMessageBox::Ok,this);
    mb->exec();
  }
}

MainWindow::~MainWindow()
{
  delete ui;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:39:01.807

好吧，您可以看到事件循环正在运行，因为`timer1`正在触发超时。从[文档](http://doc.qt.io/qt-4.8/qmessagebox.html#exec)中您可以看到这`exec()`是阻塞调用 - 因此它将阻塞调用函数（QTimer 插槽），直到对话框关闭。

这将我们引向`QObject`源代码。执行 slot 函数后`QMetaObject::activate`，最后一步是重置信号的发送者：

`QObjectPrivate::resetCurrentSender(receiver, &currentSender, previousSender);`

这将重置`QTimer`状态，并再次开始倒计时。我认为这是确保定时器回调按顺序调用的常识方法——就像大多数 UI 库中的定时器一样，而不是在**同一个**定时器中并行调用。

因为`exec()`会阻塞定时器回调，`QTimer`不会被重置并且回调不会被再次调用（直到函数恢复，并`QTimer`得到它的重置）。

你有几种方法来处理这个：

1）如果您不希望您的函数阻塞，并且您不需要模态对话框的结果来继续该函数 - 调用`QMessageBox::open()`而不是`QMessageBox::exec()`- 它不会阻止调用者函数。

2）如果您需要对话框的结果来继续该功能，并且您不想停止计时器回调，那么天真的方法是在进入回调函数时通过调用和顺序`QTimer`手动重置。`QTimer::stop()``QTimer::start()`

# c++ - 解析和比较

> ID：14676087
> 
> 赞同：-1
> 
> 时间：2013-02-03T19:00:34.933
> 
> 标签：c++, parsing, comparison

我正在研究 C++ 中的解释语言。目前我已经制作了一个从 javascript 解释的语言版本，其中有一些绑定到 javascripts DOM。现在，我想用 c++ 制作一个基于系统的版本，但刚开始时，我意识到，将 javascript 重写为 c++ 比我想象的要困难得多。你知道，类型定义，比较等。

现在，我正在设计能够识别小、大和混合转换中的“部分”一词的解析器。问题是，在 javascript 中，您可以使用“==”运算符将字符串值的索引与数字进行比较。这不仅评估给定左侧的值，还可以用于比较任何内容。好了，谈谈javascript。问题是，我在 C++ 方面有点缺乏经验，但实际上，我想编写一个函数，将字符串作为输入，搜索单词“section”（大写和混合）并在它看到时执行一些操作它。听起来很简单吧？好吧，这是我实际编译成功的代码，但它根本没有看到“部分”这个词：

```
#include <iostream>
#include <string>

string scanForSections(string iText){
    for(int i=0;i<iText.size();i++){
        if((iText[i]=='s'||iText[i]=='S')&&
           (iText[i+1]=='e'||iText[i+1]=='E')&&
           (iText[i+2]=='c'||iText[i+2]=='C')&&
           (iText[i+3]=='t'||iText[i+3]=='T')&&
           (iText[i+4]=='i'||iText[i+4]=='I')&&
           (iText[i+5]=='n'||iText[i+5]=='N')&&
           (iText[i+6]==' ')){
            i+=7;
            cout<<"section found!\n";
        }
    }
    return "0";
}

int main()
{
    scanForSections("section SECTION SeCtIoN");
    return 0;
} 
```

我应该如何在这里进行比较？。等于（）？其他比较运算符？子串？任何解决方案？例子？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:02:19.987

您的函数查找“sectin”而不是“section”。

顺便说一句，你真的应该做一些研究，至少研究可用的字符串函数，如果不研究可用的解析库的话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:07:20.943

我建议这样做：

1.  将字符串转换为大写[或小写]。
2.  用于[`std::string::find()`](http://www.cplusplus.com/reference/string/string/find/)定位您要查找的字符串。`string::npos`如果未找到该字符串，则该函数返回。

您可能还想构建某种“要查找的单词”和“如何处理该单词”的表格，而不是手动编写一大堆 if 语句。

当您有数十个关键字时，使用比较每个字母的方法是不可持续的 - 如此处所示，您错过了您正在寻找的工作中的一个字母。

# mysql - 在 MySQL 中已分组的查询上使用 GROUP_CONCAT

> ID：14676092
> 
> 赞同：2
> 
> 时间：2013-02-03T19:00:58.287
> 
> 标签：mysql

我有一个需要创建的大订单列表，并且我需要获取每个订单的产品代码及其数量的列表。

为简化起见，我展示了单个订单的示例，但外部查询需要为系统中的每个订单提供此结果。

到目前为止，我有以下内容：

```
mysql> select ProductCode,Quantity from OrderProducts where Order_ID = X;
+-------------+----------+
| ProductCode | Quantity |
+-------------+----------+
| PROD1       |        1 |
| PROD2       |        1 |
| PROD1       |        1 |
+-------------+----------+
3 rows in set (0.00 sec)

mysql> SELECT CONCAT(OrderProducts.ProductCode,' (',SUM(OrderProducts.Quantity),')') FROM OrderProducts WHERE Order_ID = X GROUP BY OrderProducts.ProductCode;
+------------------------------------------------------------------------+
| CONCAT(OrderProducts.ProductCode,' (',SUM(OrderProducts.Quantity),')') |
+------------------------------------------------------------------------+
| PROD1 (2)                                                              |
| PROD2 (1)                                                              |
+------------------------------------------------------------------------+
2 rows in set (0.00 sec) 
```

我需要的是上面查询的 GROUP_CONCAT 结果，但它不会让我将 GROUP_CONCAT 包裹在上面显示的 CONCAT 周围，因为我认为因为 SUM() 本身已经在进行分组。这是我需要返回的内容：

```
PROD1 (2),PROD2 (1) 
```

**编辑**

我不清楚上面查询的使用。我将使用该查询作为 select 中的子查询，该查询将查询`Orders`. 以下是查询的更新版本：

```
SELECT 
  ( 
    SELECT 
      GROUP_CONCAT(SerialNumberedProductCount) 
    FROM  
    ( 
      SELECT 
        OrderProducts.Order_ID,
        CONCAT(OrderProducts.ProductCode,' (',SUM(OrderProducts.Quantity),')') AS SerialNumberedProductCount 
       FROM  
        OrderProducts, Products 
       WHERE 
        OrderProducts.Order_ID = Orders.Order_ID AND 
        OrderProducts.Product_ID = Products.Product_ID AND 
        Products.IsSerialNumbered = 1 
       GROUP BY 
        OrderProducts.ProductCode
    ) SerialNumberedProductCountsSubQuery 
    WHERE 
      SerialNumberedProductCountsSubQuery.Order_ID = Orders.Order_ID
  ) AS SerialNumberedProductCounts 
FROM 
  Orders 
```

使用上述查询，我​​收到以下错误：

`ERROR 1054 (42S22): Unknown column 'Orders.Order_ID' in 'where clause'`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:03:40.937

要应用另一个聚合，您需要将其包装在子查询中。不过，这将对子查询返回的所有行应用聚合`GROUP_CONCAT()`，就像您所需示例的输出一样。`GROUP BY`由于内部子查询只返回一个已经聚合的列，因此外部查询中不需要 a

```
SELECT GROUP_CONCAT(prod_sum)
FROM (
  SELECT CONCAT(OrderProducts.ProductCode,' (',SUM(OrderProducts.Quantity),')') AS prod_sum 
  FROM OrderProducts 
  WHERE Order_ID = 'X'
  GROUP BY OrderProducts.ProductCode
) subq 
```

[http://sqlfiddle.com/#!2/68bca/4](http://sqlfiddle.com/#!2/68bca/4)

### 重发后更新

要加入针对 的子查询的结果`Orders`，您可能应该加入整个构造，而不是使用子选择。

```
SELECT 
  /* Replace these with the columns you actually need */
  Orders.*,
  SerialNumberedProductCounts.*
FROM 
  Orders
  LEFT JOIN ( 
    SELECT
      Order_ID, 
      GROUP_CONCAT(SerialNumberedProductCount) 
    FROM  
    ( 
      SELECT 
        OrderProducts.Order_ID,
        CONCAT(OrderProducts.ProductCode,' (',SUM(OrderProducts.Quantity),')') AS SerialNumberedProductCount 
       FROM  
        OrderProducts, Products 
       WHERE 
        OrderProducts.Product_ID = Products.Product_ID AND 
        Products.IsSerialNumbered = 1 
       GROUP BY 
        OrderProducts.ProductCode
    ) SerialNumberedProductCountsSubQuery 
    GROUP BY Order_Id
  ) AS SerialNumberedProductCounts 
  ON SerialNumberedProductCounts.Order_ID = Orders.Order_ID 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:03:40.383

你可以像这样使用它

```
SELECT
  GROUP_CONCAT(con) as Con
from (SELECT
    CONCAT(OrderProducts.ProductCode,' (',SUM(OrderProducts.Quantity),')') as Con
      FROM OrderProducts
      WHERE Order_ID = X
      GROUP BY OrderProducts.ProductCode
) as r 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T19:15:41.060

```
SELECT GROUP_CONCAT(CONCAT(productcode,'(',n,')')) summary 
  FROM 
     ( SELECT productcode
            , SUM(quantity) n 
         FROM orderproducts 
        WHERE order_id = x
        GROUP 
           BY productcode
     ) x; 
```

# mysql - Joomla 2.5 组件 - 存储日期/时间，显示在不同的时区

> ID：14676094
> 
> 赞同：0
> 
> 时间：2013-02-03T19:01:22.483
> 
> 标签：mysql, datetime, joomla, joomla2.5, joomla-extensions

为 Joomla v2.5 开发一个组件，我正在使用一个带有 mysql 时间戳列的表。

组件的设置之一是“时区”。我不想使用服务器时区，因为代码将在不同的服务器/时区上运行，我想独立。所以想法是将时间戳存储在mysql中，并根据组件的参数显示正确的日期/时间。主要缺点是 mysql 服务器使用的时区，这使整个情况变得复杂。那么，有没有办法在 MySQL 中以通用格式存储当前时间戳并以正确的方式显示呢？

最终目标是组件能够根据组件的参数显示正确的日期/时间，例如。用户动态更改参数，不会对数据库进行修改，仅在“视图”上进行

为了在正确的时区显示日期，我使用了这个：

```
JHtml::date($date_from_mysql , 'd/m/Y H:i:s', $my_component_timezone_parameter) 
```

请分享你的想法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T04:15:38.323

尝试

```
jimport ('joomla.utilities.date');
$date = new JDate($mydate);
$curdate = $date->toFormat('%Y-%m-%d %H:%M:%S'); 
```

对于时区设置，请尝试[http://docs.joomla.org/JDate::setTimezone/1.6](http://docs.joomla.org/JDate%3a%3asetTimezone/1.6)

[http://www.webamoeba.co.uk/site/index.php/articles-joomla-date-time](http://www.webamoeba.co.uk/site/index.php/articles-joomla-date-time)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T19:53:37.753

或尝试覆盖表类中的 store 方法：

```
public function store($updateNulls = false)
{
    // get date
    $date = JFactory::getDate();

    // set variable for timestamp
    $this->myDate = $date->toMySQL();

    return parent::store($updateNulls);
} 
```

# c# - 动态表单创建 - XSD XML SQL

> ID：14676097
> 
> 赞同：2
> 
> 时间：2013-02-03T19:01:30.803
> 
> 标签：c#, xml, asp.net-mvc, xsd

我想创建一个网站，让用户能够创建/设计自己的动态表单。(c#asp MVC4)。文本框、下拉菜单、复选框、单选按钮等

我正在考虑这样，创建的表单模板将是 XML，我将通过 xslt 将其转换为 HTML 以呈现给用户。

保存/编辑表单后，我会将表单的结果存储到数据库表中。每行都有一个表单 ID、字段名称、标识字段类型的属性（日期、整数、字符串）、值。

我的问题是：

1.  你认为这是做这件事的正确方法吗？我错过了什么吗？有没有更简单的方法来做到这一点？
2.  我应该将信息保存到数据库吗？我正在考虑将表单保存到 XML 中，并将提交的值放在数据库中的单个条目中，但是我认为这可能会减慢以后查询数据的速度，因为它需要解析大量的 XML。
3.  有什么我可以使用的东西吗：有什么推荐的 XSD 可以用于初学者吗？项目？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:40:56.727

值得一提的是：是的，这里说使用 XML 描述表单是描述表单的好方法。

您可能会发现查看 XForms 很有帮助（[规范](http://www.w3.org/TR/xforms/)写得很清楚，Steven Pemberton[为 HTML 表单的用户编写了一个关于 XForms 的优秀教程](http://www.w3.org/MarkUp/Forms/2010/xforms11-for-html-authors/)）。您可能会发现使用 XForms 做您想做的事情比从头开始编写应用程序更容易。或者，如果您决定从头开始编写自己的应用程序，您可能会发现 XForms 设计值得学习。

我认为我对您关于数据库的问题的理解不够清楚，无法回答。请记住，如果您使用 XQuery 数据库（例如 SQL Server），解析存储在数据库中的 XML 的成本可能会相对较低。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-16T07:15:57.790

如果您不需要拖放功能，CKEditor 可以适应您的要求。

还可以选择使用前置标记来为创建的表单保留最低级别的细节。

我看到您决定不使用 XML，考虑到现在可用的免费选项数量之多，这是一个明智的选择。

# text - 具有语法高亮 + 背景文本高亮的 GUI 文本编辑器

> ID：14676103
> 
> 赞同：0
> 
> 时间：2013-02-03T19:02:14.790
> 
> 标签：text, syntax, editor, highlighting

寻找一个基于 GUI 的文本编辑器，它具有一些更常用的语言的语法突出显示，以及手动文本背景突出显示。就像您可以永久突出显示文本选择一样，而不仅仅是“当前行突出显示”或更改“当前选定”文本的默认背景颜色。我认为记事本++有这个，但我无法告诉如何访问它。

到目前为止，我只能找到做其中一种或另一种的编辑。主要只是为了学习目的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:11:21.270

看看 SharpDevelop 项目中的 AvalonEdit。可能是你正在寻找的。或者至少是发展自己的良好基础。

# haskell - Haskell 和 postgresql-libpq

> ID：14676104
> 
> 赞同：1
> 
> 时间：2013-02-03T19:02:16.670
> 
> 标签：haskell, persistent, yesod

我对 postgresql-libpq (Windows x32 OS) 有一些问题。

我试图在我的项目目录中执行一个 'ghci -package postgresql-libpq' 或 'yesod devel' 我收到了这样的错误“在 DLL libintl.dll 库中找不到进入 libintl_gettext 的入口点”。

为什么我会看到此错误，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:40:04.317

看起来 libintl.dll 没有安装/不在您的路径中。在 Windows 上，postgres 似乎偶尔会出现问题：[http ://blog.kimiensoftware.com/2011/07/windows-postgresql-and-the-case-of-the-vanishing-libint-dll-372](http://blog.kimiensoftware.com/2011/07/windows-postgresql-and-the-case-of-the-vanishing-libint-dll-372)

# java - 是否可以使用 XML API 跟踪文件指针（文档位置）？

> ID：14676109
> 
> 赞同：3
> 
> 时间：2013-02-03T19:03:25.777
> 
> 标签：java, xml, sax, stax, file-pointer

我想通过其主要级别条目的 ID 索引 XML 文件。我计划解析整个文档，从条目中提取 ID 并将其编入索引（记住开始标签的文件位置`<`和结束标签的位置`>`+ 1）。稍后这将允许我通过 ID 快速找到这个地方。

但是是否可以使用 SAX 跟踪文件位置？

如果 SAX 无法实现，那么是否还有其他解析器能够做到这一点？

**更新**

我发现[Location](http://docs.oracle.com/javase/7/docs/api/javax/xml/stream/Location.html)有`getCharacterOffset()`方法。是`StAX`吗？

**更新 2**

`Location`工作，但不知何故出乎意料。第一个标签是`mediawiki`，它从零位置开始。`getCharacterOffset()`从处理的最开始同时返回 4。

似乎发生了一些预读。

# php - PHP Mcrypt 错误：无法开源设备

> ID：14676112
> 
> 赞同：1
> 
> 时间：2013-02-03T19:03:32.113
> 
> 标签：php, mcrypt

我出于某种原因降级为`PHP 5.2.8`from ，我启用了扩展，但是当我运行该功能时，它无法正确执行，并且我收到以下警告`PHP 5.4.2``mcrypt``mcrypt_create_iv ($size, MCRYPT_DEV_RANDOM)`

```
Warning: mcrypt_create_iv() [function.mcrypt-create-iv]:Cannot open source device 
```

请问我该如何解决这个问题？感谢您的任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-10T09:35:17.993

出现此问题是因为`MCRYPT_DEV_URANDOM`仅从 Windows 开始支持`PHP version 5.3.0`，这就是它在降级之前运行良好的原因。

我改成`MCRYPT_RAND`在以前的版本上工作的那个，问题就解决了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:05:32.110

> 找到文件包含/CryptRandom.php。找到以下行（可能在第 285 行附近）： $iv = mcrypt_create_iv( $rem, MCRYPT_DEV_URANDOM ); 将其更改为： $iv = mcrypt_create_iv( $rem, MCRYPT_RAND );

[资源](http://www.mediawiki.org/wiki/Thread%3aProject%3aSupport_desk/mcrypt_create_iv%28%29_function.mcrypt-create-iv_%3a_Cannot_open_source_device)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-13T09:18:06.797

检查设备文件（如果是 Linux）：

```
/dev/random 
```

# imagemagick - ImageMagick 和动画 gif 的透明背景

> ID：14676119
> 
> 赞同：33
> 
> 时间：2013-02-03T19:04:04.423
> 
> 标签：imagemagick

我有一个动画作为一批 .png 文件（100 个文件）。背景在源 .png 文件中是透明的。我想将它们转换为单个动画 gif。我试过这个命令：

```
convert -delay 0 -loop 0 -alpha set *.png ani.gif 
```

但结果如下（绿色为 HTML 页面背景）：

![在此处输入图像描述](../Images/174b134ca23c8dcd291b745be64a455f.png)

我应该如何从后面的每一帧中删除之前的帧？

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-02-03T19:14:02.647

我找到了`-dispose previous`。

**更新**

好的，`convert -delay 0 -loop 0 -alpha set -dispose previous *.png ani.gif`

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2014-04-25T06:10:20.730

解决方案在这里：

[http://www.alecjacobson.com/weblog/?p=2601](http://www.alecjacobson.com/weblog/?p=2601)

魔术关键字似乎是“处置”并调用以下解决了问题：

```
convert -dispose 2 screencapture-*.tga screencapture.gif 
```

# javascript - Three.js 调试技术

> ID：14676122
> 
> 赞同：3
> 
> 时间：2013-02-03T19:04:13.237
> 
> 标签：javascript, debugging, three.js, source-maps

我有一个 Three.js 页面，我想从 r42 更新到 r55。在那段时间里，相当多的 API 发生了变化。

其中一些更改很简单，但现在我被困在 . 的一些粗糙细节上`JSONLoader`，格式已从 JavaScript 更改为 JSON，并且可能其他更改导致它失败。一个`undefined`值在内部某个地方触发了 API，我不知道问题出在哪里，因为堆栈的顶部几层是在缩小的代码中。

什么技术最适合在此处获取完整源代码？是否有可用的[源地图](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/)？

我尝试将`three.min.js`文件交换为[`Three.js`](https://github.com/mrdoob/three.js/blob/master/src/Three.js)，但是缩小的文件也包含许多其他文件。我不喜欢将所有这些文件加载​​到我的工作区并引用它们中的每一个只是为了调试一个问题一分钟的想法。

是否有一个文件包含未缩小的等价物`three.min.js`？是否有另一种同样有效的方法？

* * *

**编辑**所以我克隆了three.js repo来获取源文件，最终会得到一堆像这样的HTML：

```
<script type="text/javascript" src="three.js/src/Three.js"></script>
<script type="text/javascript" src="three.js/src/core/Object3D.js"></script>
<script type="text/javascript" src="three.js/src/core/Geometry.js"></script>
... 
```

存储库约为 200MB，并且需要一段时间才能克隆。显然，没有办法用 Git 进行部分克隆。

必须有一个更简单的方法！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:29:44.043

实际上，当我想调试我的代码时，我就是这样做的。换出three.min.js 并放入three.js。缩小版包含相同的代码。

文件的非缩小版本受版本控制：

[https://github.com/mrdoob/three.js/tree/master/build](https://github.com/mrdoob/three.js/tree/master/build)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-06T00:31:58.713

1.  使用非缩小版本
2.  查看已经在three.js（即console.log）中存在的已注释掉的调试点
3.  'use strict' 如果还没有
4.  添加更多 console.log/debugs

# ruby-on-rails-3 - 为什么 Sublime 突出显示“模型”作为 Ruby on Rails 的关键字？

> ID：14676129
> 
> 赞同：1
> 
> 时间：2013-02-03T19:05:18.833
> 
> 标签：ruby-on-rails-3, sublimetext2

我的 Ruby on Rails 应用程序中有一个名为*model*的变量，出于某种原因，Sublime 将其突出显示为一个特殊的关键字，但我不知道为什么。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:56:30.673

没有。我的也是这样。我认为这只是对 sublimetext2 的疏忽。但是，`model`不在保留字列表中。

# xml - 使用 POST 身份验证重定向到第三方支付网关

> ID：14676132
> 
> 赞同：0
> 
> 时间：2013-02-03T19:05:48.570
> 
> 标签：xml, magento, payment-gateway

我在 Magento 中为自定义付款方式提供了一个几乎完整的解决方案。我遵循 [this] [http://www.junaidbhura.com/how-to-make-a-custom-magento-payment-extension-for-an-external-gateway/](http://www.junaidbhura.com/how-to-make-a-custom-magento-payment-extension-for-an-external-gateway/)优秀教程，但我现在遇到身份验证问题。

我联系了网关，一位 IT 代表告诉我，我必须将正确的值发布到网关以进行身份​​验证。这些值也必须以 XML 格式发送：

测试模式用户名：###### 测试模式密码：###### 测试模式商家ID：##### 测试模式终端ID：##### BIN = ######1

我在网关模块中创建了一个带有正确字段的 system.xml：

```
<?xml version="1.0"?>
<config>
  <sections>
    <payment>
      <groups>
        <mygateway translate="label comment" module="mygateway">
          <label>My Module mygateway</label>
          <frontend_type>text</frontend_type>
          <sort_order>0</sort_order>
          <show_in_default>1</show_in_default>
          <show_in_website>1</show_in_website>
          <show_in_store>1</show_in_store>
          <fields>
            <active translate="label">
              <label>Enabled</label>
              <frontend_type>select</frontend_type>
              <source_model>adminhtml/system_config_source_yesno</source_model>
              <sort_order>10</sort_order>
              <show_in_default>1</show_in_default>
              <show_in_website>1</show_in_website>
              <show_in_store>0</show_in_store>
            </active>
            <title translate="label">
              <label>My Module mygateway Paymentech</label>
              <frontend_type>text</frontend_type>
              <sort_order>20</sort_order>
              <show_in_default>1</show_in_default>
              <show_in_website>1</show_in_website>
              <show_in_store>1</show_in_store>
            </title>
            <order_status translate="label">
              <label>New Order Status</label>
              <frontend_type>select</frontend_type>
              <source_model>adminhtml/system_config_source_order_status</source_model>
              <sort_order>50</sort_order>
              <show_in_default>1</show_in_default>
              <show_in_website>1</show_in_website>
              <show_in_store>0</show_in_store>
            </order_status>
            <allowspecific translate="label">
              <label>Payment Applicable From</label>
              <frontend_type>select</frontend_type>
              <sort_order>61</sort_order>
              <source_model>adminhtml/system_config_source_payment_allspecificcountries</source_model>
              <show_in_default>1</show_in_default>
              <show_in_website>1</show_in_website>
              <show_in_store>0</show_in_store>
            </allowspecific>
            <specificcountry translate="label">
              <label>Countries Payment Applicable From</label>
              <frontend_type>multiselect</frontend_type>
              <sort_order>70</sort_order>
              <source_model>adminhtml/system_config_source_country</source_model>
              <show_in_default>1</show_in_default>
              <show_in_website>1</show_in_website>
              <show_in_store>0</show_in_store>
              <depends>
                <allowspecific>1</allowspecific>
              </depends>
            </specificcountry>
            <sort_order translate="label">
              <label>Sort Order</label>
              <frontend_type>text</frontend_type>
            </sort_order>
            <sort_order>100</sort_order>
            <show_in_default>1</show_in_default>
            <show_in_website>1</show_in_website>
            <show_in_store>0</show_in_store>
            <test_apiusername translate="label">
                            <label>Test Mode Username</label>
                            <frontend_type>text</frontend_type>
                            <sort_order>6</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </test_apiusername>
                        <test_apipassword translate="label">
                            <label>Test Mode Password</label>
                            <frontend_type>obscure</frontend_type>
                            <backend_model>adminhtml/system_config_backend_encrypted</backend_model>
                            <sort_order>7</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </test_apipassword>
                        <test_MerchantID translate="label">
                            <label>Test Mode MerchantID</label>
                            <frontend_type>text</frontend_type>
                            <sort_order>8</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </test_MerchantID>
                        <test_TerminalID translate="label">
                            <label>Test Mode TerminalID</label>
                            <frontend_type>text</frontend_type>
                            <sort_order>9</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </test_TerminalID>
                        <test_BINNumber translate="label">
                            <label>Test Mode BIN</label>
                            <frontend_type>text</frontend_type>
                            <sort_order>10</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </test_BINNumber>
                        <test_cgi_url>
                            <label>Test Mode Gateway URL</label>
                            <frontend_type>text</frontend_type>
                        <sort_order>11</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        <comment>Above values should be entered for Test account</comment>
                        </test_cgi_url>
                        <apiusername translate="label">
                            <label><![CDATA[<strong>Production</strong>]]> Mode Username</label>
                            <frontend_type>text</frontend_type>
                            <sort_order>12</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </apiusername>
                        <apipassword translate="label">
                            <label><![CDATA[<strong>Production</strong>]]> Mode Password</label>
                            <frontend_type>obscure</frontend_type>
                            <backend_model>adminhtml/system_config_backend_encrypted</backend_model>
                            <sort_order>13</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </apipassword>
                        <MerchantID translate="label">
                            <label><![CDATA[<strong>Production</strong>]]> Mode MerchantID</label>
                            <frontend_type>text</frontend_type>
                        <sort_order>14</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </MerchantID>
                        <TerminalID translate="label">
                            <label><![CDATA[<strong>Production</strong>]]> Mode TerminalID</label>
                            <frontend_type>text</frontend_type>
                        <sort_order>15</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </TerminalID>
                        <BINNumber translate="label">
                            <label><![CDATA[<strong>Production</strong>]]> Mode BIN</label>
                            <frontend_type>text</frontend_type>
                        <sort_order>16</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>1</show_in_store>
                        </BINNumber>
          </fields>
        </mygateway>
      </groups>
    </payment>
  </sections>
</config> 
```

我不确定验证到 PaymentController.php 所需的 POST 值的实现

```
<?php

class Myname_Mygateway_PaymentController extends Mage_Core_Controller_Front_Action {
    // The redirect action is triggered when someone places an order
    public function redirectAction() {
        $this->loadLayout();
        $block = $this->getLayout()->createBlock('Mage_Core_Block_Template','mygateway',array('template' => 'mygateway/redirect.phtml'));
        $this->getLayout()->getBlock('content')->append($block);
        $this->renderLayout();
    }

    // The response action is triggered when your gateway sends back a response after processing the customer's payment
    public function responseAction() {
        if($this->getRequest()->isPost()) {

            /*
            /* Your gateway's code to make sure the reponse you
            /* just got is from the gatway and not from some weirdo.
            /* This generally has some checksum or other checks,
            /* and is provided by the gateway.
            /* For now, we assume that the gateway's response is valid
            */

            $validated = true;
            $orderId = '123'; // Generally sent by gateway

            if($validated) {
                // Payment was successful, so update the order's state, send order email and move to the success page
                $order = Mage::getModel('sales/order');
                $order->loadByIncrementId($orderId);
                $order->setState(Mage_Sales_Model_Order::STATE_PROCESSING, true, 'Gateway has authorized the payment.');

                $order->sendNewOrderEmail();
                $order->setEmailSent(true);

                $order->save();

                Mage::getSingleton('checkout/session')->unsQuoteId();

                Mage_Core_Controller_Varien_Action::_redirect('checkout/onepage/success', array('_secure'=>true));
            }
            else {
                // There is a problem in the response we got
                $this->cancelAction();
                Mage_Core_Controller_Varien_Action::_redirect('checkout/onepage/failure', array('_secure'=>true));
            }
        }
        else
            Mage_Core_Controller_Varien_Action::_redirect('');
    }

    // The cancel action is triggered when an order is to be cancelled
    public function cancelAction() {
        if (Mage::getSingleton('checkout/session')->getLastRealOrderId()) {
            $order = Mage::getModel('sales/order')->loadByIncrementId(Mage::getSingleton('checkout/session')->getLastRealOrderId());
            if($order->getId()) {
                // Flag the order as 'cancelled' and save it
                $order->cancel()->setState(Mage_Sales_Model_Order::STATE_CANCELED, true, 'Gateway has declined the payment.')->save();
            }
        }
    }
} 
```

最后是重定向的表单，即redirect.phtml

```
<?php
// Retrieve order
$_order = new Mage_Sales_Model_Order();
$orderId = Mage::getSingleton('checkout/session')->getLastRealOrderId();
$_order->loadByIncrementId($orderId);
?>
<form name="mygatewayform" method="post" action="http://www.gateway.com/the_url_they_gave_me">
    <input type="hidden" name="orderid" value="<?php echo $orderId; ?>">
    <input type="hidden" name="grandtotal" value="<?php echo $_order->getBaseGrandTotal(); ?>">
</form>
<script type="text/javascript">
document.mygatewayform.submit();
</script> 
```

我能够运行测试订单，但由于 IP 记录，网关只收到了我的订单，而且格式不正确。在发帖之前，我已经在 Magento 论坛和 Google 上搜索了将近三周，但我没有找到任何解决方案。网关无法提供帮助，因为也没有 Magento 集成手册。

如果不是太麻烦，我将非常感谢您的帮助...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:13:31.310

您的以下说明用于创建将重定向到第三方网关的付款。

`The URL that the payment gateway needs to redirect to on your web site after processing the customer’s payment (based on the naming we’ve used in this example) should be: http://www.yourwebsite.com/mygateway/payment/response .`

完成您要完成的工作的最佳方法是遵循此[http://www.excellencemagentoblog.com/magento-create-custom-payment-method-api-based](http://www.excellencemagentoblog.com/magento-create-custom-payment-method-api-based)。

另见

> /app/code/core/Mage/Paygate/Model/Authorizenet.php

```
//create xml and send info to gateway
private function callApi(Varien_Object $payment, $amount,$type){

    //call your authorize api here, incase of error throw exception.
    //only example code written below to show flow of code

    /*
     $order = $payment->getOrder();
    $types = Mage::getSingleton('payment/config')->getCcTypes();
    if (isset($types[$payment->getCcType()])) {
    $type = $types[$payment->getCcType()];
    }
    $billingaddress = $order->getBillingAddress();
    $totals = number_format($amount, 2, '.', '');
    $orderId = $order->getIncrementId();
    $currencyDesc = $order->getBaseCurrencyCode();

    $url = $this->getConfigData('gateway_url');
    $fields = array(
            'api_username'=> $this->getConfigData('api_username'),
            'api_password'=> $this->getConfigData('api_password'),
            ......

            'customer_firstname'=> $billingaddress->getData('firstname'),
            'customer_lastname'=> $billingaddress->getData('lastname'),
            'customer_phone'=> $billingaddress->getData('telephone'),
            'customer_email'=> $billingaddress->getData('email'),
            'customer_ipaddress'=> $_SERVER['REMOTE_ADDR'],
            'bill_firstname'=> $billingaddress->getData('firstname'),
            'bill_lastname'=> $billingaddress->getData('lastname'),
            'Bill_address1'=> $billingaddress->getData('street'),
            'bill_city'=> $billingaddress->getData('city'),
            'bill_country'=> $billingaddress->getData('country_id'),
            'bill_state'=> $billingaddress->getData('region'),
            'bill_zip'=> $billingaddress->getData('postcode'),
            'customer_cc_expmo'=> $payment->getCcExpMonth(),
            'customer_cc_expyr'=> $payment->getCcExpYear(),
            'customer_cc_number'=> $payment->getCcNumber(),
            'customer_cc_type'=> strtoupper($type),
            'customer_cc_cvc'=> $payment->getCcCid(),
            'merchant_ref_number'=> $order->getIncrementId(),
            'currencydesc'=>$currencyDesc,
            'amount'=>$totals
    );

    $fields_string="";
    foreach($fields as $key=>$value) {
    $fields_string .= $key.'='.$value.'&';
    }
    $fields_string = substr($fields_string,0,-1);
    //open connection
    $ch = curl_init($url);
    //set the url, number of POST vars, POST data
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
    curl_setopt($ch, CURLOPT_POST,1);
    curl_setopt($ch, CURLOPT_POSTFIELDS,$fields_string);
    curl_setopt($ch, CURLOPT_FOLLOWLOCATION ,1);
    curl_setopt($ch, CURLOPT_HEADER ,0); // DO NOT RETURN HTTP HEADERS
    curl_setopt($ch, CURLOPT_RETURNTRANSFER ,1); // RETURN THE CONTENTS OF THE CALL
    curl_setopt($ch, CURLOPT_CONNECTTIMEOUT, 120); // Timeout on connect (2 minutes)
    //execute post
    $result = curl_exec($ch);
    curl_close($ch);
    */

    return array('status'=>1,'transaction_id' => time() , 'fraud' => rand(0,1));
} 
```

# c# - 将整个对象作为参数存储到其他对象的性能

> ID：14676133
> 
> 赞同：1
> 
> 时间：2013-02-03T19:05:48.740
> 
> 标签：c#, memory

我有一个`Object A`可以随意生产的系统`Object B`。一个`Object A`可以产生任意数量的`Object B`，并且有多个`Object A`。

`Object A`在我的程序中知道哪个产生了哪个`Object B`（出于各种原因）很有用。目前，每当`Object B`创建 an 时，我只是将`Object A`创建它的作为参数存储在`Object B`. 但这对我来说感觉不对。

**问题1：**有没有办法简单地存储对正确`Object A`内部的引用`Object B`，而不是整个对象？或者这实际上是怎么回事？

**问题2：**这样做是不是我现在的记忆效率低下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:32:29.423

**问题一：**

对的，这是可能的。您可以传递对创建者对象的引用，例如通过构造函数。*它也可以是公共属性设置器或公共字段，但我建议使用构造函数。*

```
public class ObjectB
{
    public ObjectA Parent {get; private set;}

    public ObjectB(ObjectA parent)
    {
        this.Parent = parent;
    }
}

public class ObjectA
{
    private ObjectB GetNewObjectB()
    {
         return new ObjectB(this);
    }
} 
```

**问题2：**

对象引用`4bytes/8bytes`承担`32bit/64bit OS`。因此，您可以粗略地想象额外的内存消耗并确定它是否对您来说是一个问题（*恕我直言，对于大多数应用程序来说这不是问题*）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:10:41.027

问题 1：是的 - 如果你有

```
class A {}

class B
{
  A creator;
} 
```

那么“创建者”引用就是这样 - 指向对象实例的指针，而不是内容本身的副本。

问题 2：我认为我没有足够的信息来回答这个问题 - 如果您需要存储在 B 中的引用，那么它的效率并不低。如果您对它变得无效感到高兴，您可能希望将其转换为 WeakReference。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:10:50.577

类是引用类型，所以如果你的类`B`有一个类类型的字段，`A`那么只有对实例的引用`A`存储在字段中，而不是整个对象的副本。

```
class B
{
    //creator is a reference to the instance of A which created this instance
    private A creator;
} 
```

# c# - Petapoco 更新日期时间错误

> ID：14676136
> 
> 赞同：0
> 
> 时间：2013-02-03T19:06:05.493
> 
> 标签：c#, datetime, petapoco

我试图使用 Petapoco 更新一些日期时间字段，但更新总是失败，所以我查找了我的 SQL 分析器并找到了以下执行语句。

```
 exec sp_executesql N'UPDATE [db_Product] SET [aName] = @0, [aDesc] = @1, [EmpID] = @2, [UPCCode] = @3, [isActive] = @4, [isExpendable] = @5, [ProductCatID] = @6, [ProductSubCatID] = @7, [PromoCatID] = @8, 
    [Property1Name] = @9, [Property2Name] = @10, [RackPrice] = @11, [DiscountMethod] = @12, [DiscountAmount] = @13, [SellingPrice] = @14, [Cost] = @15, [CurrencyType] = @16, [qtyPerSaleMin] = @17, 
    [qtyPerSaleMax] = @18, [SupplierID] = @19, [BrandID] = @20, [StartDate] = @21, [EndDate] = @22, [MadeIn] = @23, [TakeStockName] = @24, [LifeCycleName] = @25, [ReOrderQty] = @26, [ReOrderPoint] = @27, 
    [ReOrderDays] = @28, [PreOrderDays] = @29, [aMemo] = @30, [Updator] = @31, [DateUpdate] = @32 WHERE [ProductID] = @33',N'@0 nvarchar(4000),@1 nvarchar(4000),@2 int,@3 nvarchar(4000),@4 int,@5 int,@6 int,@7 
    int,@8 int,@9 nvarchar(4000),@10 nvarchar(4000),@11 decimal(4,4),@12 nvarchar(4000),@13 decimal(4,4),@14 decimal(4,4),@15 decimal(4,4),@16 nvarchar(4000),@17 int,@18 int,@19 int,@20 int,@21 datetime,@22 
    datetime,@23 nvarchar(4000),@24 nvarchar(4000),@25 nvarchar(4000),@26 int,@27 int,@28 int,@29 int,@30 nvarchar(4000),@31 int,@32 datetime,@33 
    int',@0=N'testxxx',@1=N'',@2=0,@3=N'',@4=0,@5=0,@6=1,@7=0,@8=0,@9=N'Color',@10=N'Size',@11=0,@12=N'%',@13=0,@14=0,@15=0,@16=N'TWD',@17=0,@18=0,@19=0,@20=0,

@21=''2013-01-20 12:28:00:000'',@22=''2063-01-20 12:28:00:000'', <--problem

@23=N'TW ',@24=N'週盤',@25=N'新品',@26=1,@27=1,@28=3,@29=1,@30=N'',@31=0,

@32=''2013-02-04 02:45:47:640'' <----problem

,@33=1 
```

出于某种原因，所有日期时间字段都有**''**，因此会导致更新错误。

编辑：C# 代码，BAL

```
public int Update(int _id, ProductManager _M)
{
    int result = _M.Product.UpdateByID(_id, _M.Product);

    return result;

} 
```

C# 代码，DAL

```
public virtual int UpdateByID(int _id, db_Product data)
{
    data.DateUpdate = DateTime.Now;
     using (var db = new ConnClass().ConnDB())
     {
         var result = db.Update(data, _id);
         return result;
     }
} 
```

BAL **_M.Product.UpdateByID(_id, _M.Product);** 将更新发送到 DAL 代码以进行更新。我检查了我的**ProductManager _M**中的值，dateTime 值是有效的。

**Petapoco 执行命令**

```
 UPDATE [db_Product] SET [aName] = @0, [aDesc] = @1, [EmpID] = @2, [UPCCode] = @3, [isActive] = @4, [isExpendable] = @5, [ProductCatID] = @6, [ProductSubCatID] = @7, 
[PromoCatID] = @8, [Property1Name] = @9, [Property2Name] = @10, [RackPrice] = @11, [DiscountMethod] = @12, [DiscountAmount] = @13, [SellingPrice] = @14, [Cost] = @15, [CurrencyType] = @16, [qtyPerSaleMin] = @17, [qtyPerSaleMax] = @18, [SupplierID] = @19, [BrandID] = @20, 
[StartDate] = @21, [EndDate] = @22, [MadeIn] = @23, [TakeStockName] = @24, [LifeCycleName] = @25, [ReOrderQty] = @26, [ReOrderPoint] = @27, [ReOrderDays] = @28, [PreOrderDays] = @29, 
[aMemo] = @30, [Updator] = @31, [DateUpdate] = @32 WHERE [ProductID] = @33 
```

我已经花了几天时间调试这个有趣的结果......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-27T16:41:12.737

Petapoco 使用 ADO.net 运行该`UPDATE`语句`ExecuteNonQuery()`并返回此函数返回的值。

该函数的文档指出：

> 对于 UPDATE、INSERT 和 DELETE 语句，返回值是受命令影响的行数。当正在插入或更新的表上存在触发器时，返回值包括受插入或更新操作影响的行数以及受一个或多个触发器影响的行数。对于所有其他类型的语句，返回值为 -1。如果发生回滚，则返回值也是 -1。

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlcommand.executenonquery.aspx)

# c - C 内存泄漏和 Valgrind 输出

> ID：14676138
> 
> 赞同：0
> 
> 时间：2013-02-03T19:06:17.297
> 
> 标签：c, memory-leaks, valgrind

我正在使用 C 进行一些学习，并且无法识别内存泄漏情况。

首先，一些代码：

* * *

我的**主要**功能：

```
#define FILE_NAME "../data/input.txt"

char * testGetLine( FILE * );
int testGetCount(void);

int main(void)
{
    int count = 0;
    FILE * fptr;

    if ((fptr = fopen(FILE_NAME, "r")) != NULL) {
        char * line;
        while ((line = testGetLine(fptr)) != NULL) {            

            printf("%s", line);
            free(line); count++;
        }

        free(line); count++;

    } else {
        printf("%s\n", "Could not read file...");
    }

    // testing statements
    printf("testGetLine was called %d times\n", testGetCount());
    printf("free(line) was called %d times\n", count);

    fclose(fptr);
    return 0;
} 
```

和我的**getline**函数：

```
#define LINE_BUFFER 500

int count = 0;

char * testGetLine(FILE * fptr)
{
    extern int count;

    char * line;
    line = malloc(sizeof(char) * LINE_BUFFER);
    count++;

    return fgets(line, LINE_BUFFER, fptr);
}

int testGetCount(void) {
    extern int count;
    return count;
} 
```

* * *

我的理解是，`free`每次我调用我的`testGetLine`函数时，我都需要调用，我这样做了。据我所知，在一个有四行的简单文本文件上，我需要免费调用**5**次。我在以下输出中使用我的测试语句验证了这一点：

```
This is in line 01
Now I am in line 02
line 03 here
and we finish with line 04
testGetLine was called 5 times
free(line) was called 5 times 
```

* * *

我遇到的麻烦是，valgrind 说我`alloc` **6**次，而我只调用了`free` **5**次。这是 valgrind 的截断输出：

```
HEAP SUMMARY:
    in use at exit: 500 bytes in 1 blocks
  total heap usage: 6 allocs, 5 frees, 3,068 bytes allocated
500 bytes in 1 blocks are definitely lost in loss record 1 of 1
   at 0x4C2B3F8: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
   by 0x4007A5: testGetLine (testGetLine.c:13)
   by 0x400728: main (tester.c:16)
LEAK SUMMARY:
   definitely lost: 500 bytes in 1 blocks
   indirectly lost: 0 bytes in 0 blocks
     possibly lost: 0 bytes in 0 blocks
   still reachable: 0 bytes in 0 blocks
        suppressed: 0 bytes in 0 blocks 
```

* * *

我觉得我在内存管理方面遗漏了一些东西。valgrind 说我正在使用的第 6 个内存分配在哪里？我应该如何释放它？

* * *

**跟进实施阿德里安的回答**

`testGetLine`调整：

```
char * testGetLine(FILE * fptr)
{
    extern int count;

    char * line;
    line = malloc(sizeof(char) * LINE_BUFFER);
    count++;

    if (fgets(line, LINE_BUFFER, fptr) == NULL) {
        line[0] = '\0';
    }

    return line;
} 
```

`main`while循环调整：

```
while ((line = testGetLine(fptr))[0] != '\0') {            

    printf("%s", line);
    free(line); count++;
}

free(line); count++; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:11:13.713

`fgets`退货说明：

> 成功时，函数返回 str。如果在尝试读取字符时遇到文件结尾，则设置 eof 指示符 (feof)。如果这发生在可以读取任何字符之前，则返回的指针是空指针（并且 str 的内容保持不变）。如果发生读取错误，则设置错误指示符 (ferror) 并返回空指针（但 str 指向的内容可能已更改）。

当`fgets`不读取任何内容时，它不会返回`char *`您使用 malloc 的那个。

因此，`malloc`您最后一次通话中的 没有被释放。while 之后的语句无法按您的意愿工作。

解决方案：更改您的退货并`line`改为退货：

```
char * testGetLine(FILE * fptr)
{
    extern int count;

    char * line;
    line = malloc(sizeof(char) * LINE_BUFFER);
    count++;
    fgets(line, LINE_BUFFER, fptr);
    return line;
} 
```

# vb.net - 在 vb.net 中多次执行相同的函数

> ID：14676155
> 
> 赞同：1
> 
> 时间：2013-02-03T19:08:41.470
> 
> 标签：vb.net, multithreading

我有一个来自外部网络服务的搜索功能。搜索一天的数据返回记录数大约需要 3 秒。要求连续搜索一个月的数据。

所以进行普通搜索是不明智的（大约需要 90 秒）。

我想使用开始和结束日期作为参数进行搜索功能并返回记录数。并在 for 循环中调用此函数（更改日期范围）并在完成后汇总记录。

我认为最好的方法是执行任务或线程。但我无法成功地做到这一点。

所以它将需要 3 秒而不是 90 秒。

在这方面的任何帮助都将得到很大的利用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:20:45.630

如果我正确地阅读了你的问题，这应该让你开始：

```
Module modSum

Private mSum As Integer
Public Property Sum() As Integer
    Get
        Return mSum
    End Get
    Set(ByVal value As Integer)
        mSum = value
    End Set
End Property

Public Sub DoSum()

    For i = 1 To 30

        Dim dateToQuery As Date
        dateToQuery = Date.Parse("2013-02-" & i.ToString)

        Dim sc As New WebserviceCall
        sc.startdate = "2013-01-01"
        sc.enddate = "2013-01-31"

        Dim th As New Threading.Thread(AddressOf sc.DoServiceCall)
        th.Start()

    Next

End Sub

Public Class WebserviceCall

    Public startdate As Date
    Public enddate As Date

    Public Sub DoServiceCall()

        Dim ws As New YourService.Service
        Dim result As Integer = ws.GetSum(startdate, enddate)

        mSum += result

    End Sub

End Class

End Module 
```

# visual-studio - 部署应用程序时出现错误 0x80072736？

> ID：14676157
> 
> 赞同：6
> 
> 时间：2013-02-03T19:08:46.720
> 
> 标签：visual-studio, deployment, visual-studio-2012, windows-phone-8

我正在尝试将我的 Windows Phone 8 应用程序从 Visual Studio 2012 部署到我的 HTC 8X。我收到此错误：

```
Error   1   Error writing file
'%FOLDERID_SharedData%\PhoneTools\11.0\Install\{12b7fcb7-793b-4023-abeb-14a76d3f7447}\MyApp_Debug_AnyCPU.xap'.
Error 0x80072736: An operation was attempted on something that is not a socket.
 0      0 
```

该应用程序当前未安装在设备上。重新启动 Visual Studio 和手机并不能解决问题。如果我第二次从 Visual Studio 部署应用程序而不重新启动它，则错误将更改为：

```
Error   1   0x8974002F      0   0 
```

我尝试删除 bin 文件夹并重建解决方案。执行此操作后，错误更改为：

```
Error   1   This operation returned because the timeout period expired.     0   0 
```

手机已解锁，Windows Phone 应用已安装并连接到我的手机。在我当前的计算机上部署之前，我没有遇到任何问题。是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T23:33:29.100

我通过重新启动计算机解决了这个问题。关于这个问题的原因的任何想法仍然是受欢迎的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-02T14:38:10.303

我遇到了类似的问题，我通过将手机直接插入计算机而不是使用 USB 延长线来解决它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-02-17T17:48:17.167

就我而言，我更改了 USB 端口并且它工作正常。（前面的 USB 端口有问题，但后面的 USB 端口很好。）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-09T08:35:23.430

就我而言，我的手机上有一个待处理的系统更新。安装更新，重新启动手机，解决了这个问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-10-19T03:57:49.357

这只是一个示例应用程序。全景应用程序。它在一个房间工作，而在另一个房间出现部署错误。

错误 1 ​​由于超时期限已过，此操作返回。0 0
万圣节也许吧！可能我会尝试重新启动计算机。我在运行 Windows 10 的笔记本电脑上使用 Visual Studio 2013。我有两个不同的应用程序，都是全景应用程序，但它们无法部署。

# html - 使用 html 发布的 Minecraft 服务器。请帮忙

> ID：14676158
> 
> 赞同：0
> 
> 时间：2013-02-03T19:08:50.193
> 
> 标签：html, jar, minecraft

我正在尝试免费创建一个 Minecraft 24/7 香草服务器，但我似乎无法获得 html 来运行位于[https://s3.amazonaws.com/MinecraftDownload/launcher的 Minecraft_Server.jar（jar 文件） /minecraft_server.jar](https://s3.amazonaws.com/MinecraftDownload/launcher/minecraft_server.jar)。我不知道启动类，但我知道下载链接。jar 文件用于保存和读取计算机上的文件，通常由 .command 启动。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:33:42.950

我将一次解决您面临的问题。

1.  单独的 HTML 不能运行 Java 程序。HTML 可以运行小程序；这就是[Minecraft 演示](http://minecraft.net/demo)的工作方式。
2.  minecraft_server.jar 不是 Java 小程序。因此，您不能使用 HTML 在线运行它。
3.  未修改的 minecraft_server.jar 并非设计为从 BAT 文件运行（我认为您的意思是 BAT 而不是 .command 文件）。

如果您尝试在线管理 Minecraft 服务器，请查看一些在线控制台，例如[McMyAdmin](http://www.mcmyadmin.com/)或[SpaceBukkit](http://spacebukkit.xereo.net/)。您还可以找到为这些控制台提供快速[Google](https://www.google.co.uk/search?q=minecraft%20server%20hosting)的在线托管服务。

# neo4j - 如何定义和执行 Neo4J 图形的模式？

> ID：14676163
> 
> 赞同：2
> 
> 时间：2013-02-03T19:09:12.377
> 
> 标签：neo4j, rdbms, graph-databases

我想通过 Neo4j 图实现 RDBMS 定义和执行已知模式的能力。我们知道我们的图应该是什么样子（所有的边类型和节点类型）。所以我们只是想阻止某人（开发人员/用户）添加“无效”的边或节点类型，即不属于定义的图形模式的一部分。我们如何执行图形模式？请注意，我不是在询问如何强制执行边或图的属性，而只是在询问一组特定的已知边和节点类型时如何强制组成图。请帮忙

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:32:08.397

这可能应该在应用程序端完成。构建一个强制执行此类事情的包装器/API，并让开发人员使用它。对不起，简短的回答...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T20:55:16.510

此处列出的大多数语言驱动程序或框架都提供了定义模式的方法：

[http://www.neo4j.org/drivers](http://www.neo4j.org/drivers)

对于 Java，我们开发了 structr ( [https://github.com/structr/structr](https://github.com/structr/structr) )，您可以在其中在 Java bean 中定义您的模式。您可以从简单的 Maven 原型开始 fe，如截屏视频所示：http: [//vimeo.com/53235075](http://vimeo.com/53235075)

干杯阿克塞尔

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-12-13T10:29:50.170

它必须发生在 Neo4j 之上的一层。我一直在构建其中一个层（[Restagraph](https://github.com/equill/restagraph)），它在其上放置了一个 REST 接口。

它比 Structr 不成熟，但可能值得一看。我将它打包在一个 Docker 镜像中，它的设计目的是让您可以轻松地在 YAML 文件中定义自己的模式。

# php - 我是否需要使用 WSDL 来使用 SOAP Web 服务？

> ID：14676166
> 
> 赞同：0
> 
> 时间：2013-02-03T19:09:18.803
> 
> 标签：php, web-services

首先对这个过于宽泛的问题感到抱歉，但我似乎无法理解这一点。

我正在构建一个 phonegap 应用程序，它将数据推送到 PHP 脚本，该脚本又将通过 SOAP 将 XML 发送到 Web 服务。我知道我的脚本将使用的 Web 服务的所有功能以及它接受和返回的数据，但是 Web 服务的所有者告诉我，我必须将 WSDL 文件加载到我的应用程序中才能使用 Web服务。

我不明白为什么——当然，如果我确切地知道我要发送什么以及我会收到什么，为什么我需要导入一个 WSDL 文件？（我不想从 WSDL 文件或类似的东西中生成类）。

再次为一个过于模糊的问题感到抱歉，但我希望有人可以为我解决这个问题？

# qt - 如何在 QTabWidget 的两个选项卡之间插入空格？

> ID：14676167
> 
> 赞同：10
> 
> 时间：2013-02-03T19:09:33.717
> 
> 标签：qt, qt4, qt5, qtabwidget, qtabbar

我想插入一个空格将第二个标签与第三个标签分开。这可能吗？我尝试了一些样式表，但由于这个小部件对我来说有点新，所以到目前为止我还没有成功。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-03T21:36:26.503

是的，这是可能的，但不是那么明显。这是我前段时间想出的一种方法。

每当您需要两个选项卡之间的空格时，请在选项卡之间插入一个新选项卡，并通过调用禁用新选项卡`QTabWidget::setTabEnabled(int index, bool enable)`。这样，新标签将不再可能与之交互（除非该标签是唯一存在的）。您还需要在 上设置以下样式表`QTabWidget`：

```
 QTabBar::tab:disabled {
    width: 100px;
    color: transparent;
    background: transparent;
 } 
```

此样式表使新选项卡不可见（实际上它使所有禁用的选项卡不可见，因此除非没问题，否则此方法对您不起作用）。`width`您可以通过更改样式表中的值来调整空间的宽度。

结果：

![QTabWidget 与选项卡之间的空间](../Images/a4176c0cdb9c6b3ff26c249a7614de6b.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-05-07T02:32:06.163

如果您不想像在接受的答案中那样创建不可见的选项卡，这里有一种仅使用样式表的方法。同样，调整像素量以增加或减少制表符之间的间距。

```
QTabBar::tab {
    margin-left:2px;
    margin-right:2px;
} 
```

[![在此处输入图像描述](../Images/dc55fd083f35206f859faa9a4a0e3672.png)](https://i.stack.imgur.com/52BmJ.gif)

```
QTabBar::tab {
    margin-left:40px;
    margin-right:40px;
} 
```

[![在此处输入图像描述](../Images/2d81956e5abb84f7c22db67d68782f6b.png)](https://i.stack.imgur.com/0dFcv.gif)

# c - 子设置由父 C 读取的标志

> ID：14676168
> 
> 赞同：0
> 
> 时间：2013-02-03T19:09:35.917
> 
> 标签：c, process, fork

在我之后`fork()`，孩子将进行一些比较，涉及一些函数调用和设置一些标志。父母只是走到尽头等待孩子。在一种情况下，我不希望父母等待孩子（在后台运行）。我认为问题在于孩子设置标志的时间太长，而父母已经结束了。跟随父进程和子进程显示标志设置正确但父进程未正确读取。有没有办法让父母停下来？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T13:27:55.953

一旦你从父级派生一个子级，它们就会成为具有自己地址空间的不同进程。因此，子项对变量所做的更改对父项不可见。

在这两个进程之间进行通信。您应该使用任何这些[IPC](http://www.tldp.org/LDP/tlk/ipc/ipc.html)机制。我确实相信[共享内存](http://www.cs.cf.ac.uk/Dave/C/node27.html)方法最适合您的需求，因为子进程可以获得父内存页面的快照。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T12:18:15.633

您可以使用[wait(2)](http://linux.die.net/man/2/wait)使用子进程的 pid 来停止父进程，直到子进程终止。正如 Dipstick 所说，如果不需要创建新进程，线程会更好。由于没有任务切换，线程使程序更复杂，但比进程更有效（我猜是 1000 倍）。考虑：[Pthreads](http://en.wikipedia.org/wiki/Pthreads)

# html - 父 div 的 div 背景中的 div 不适用于嵌套 div

> ID：14676174
> 
> 赞同：1
> 
> 时间：2013-02-03T19:10:21.733
> 
> 标签：html, css

我在两个`div`s 之间有问题。`div#mainbody`这是父母`div`有一个背景，`div`2个孩子`div`有自己的背景，所以`div`2个浮出父母`div`，但我希望它在父母里面`div`。

***HTML：***

```
<!-- parent div -->
<div id="mainbody">hi
   <div id="b1"></div> <div id="b2"></div> <!-- children divs -->

   <div id="main">
      <img src="images/fslam.png" id="fill" /><br/>
      <img src="images/register.png" id="register" /><br/>
      <img src="images/login.png" id="login" />
   </div>
</div> 
```

***CSS：***

```
div[id=mainbody] {
   background-image: url(../images/img1300.png);
   box-shadow: 8px 8px 16px #000000;
}

div[id=main] {
   position: absolute;
   width:500px;
   height:375px;
   background-color:#FF6;
   z-index:1;
   background:-webkit-linear-gradient(top,#81cbbc,#fcf59b 2%);
   -webkit-background-size:100% 40px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:45:58.053

只需使用`position: relative;`而不是`absolute`.

更新[的小提琴](http://jsfiddle.net/crYLK/2/)

```
#main {
    position:relative;
    width:500px;
    height:375px;
    background-color:#FF6;
    z-index:1;
    background:-webkit-linear-gradient(top, #81cbbc, #fcf59b 2%);
    -webkit-background-size:100% 40px;
} 
```

# excel - excel vba全局变量和并发

> ID：14676185
> 
> 赞同：0
> 
> 时间：2013-02-03T19:11:13.257
> 
> 标签：excel, vba, scope, global-variables

关于如何在 Excel VBA 中使用全局变量，我有几个问题。

所以我的应用程序使用了第三方提供的 API 对象。目前在所有函数中，我们初始化这个对象并使用它：

```
function()
   Dim api as someApi
   api.dosth

end function 
```

我只是想知道，而不是每次都初始化它，我可以把它变成一个全局变量吗？就像只是在开头声明它并在 workbook_open 函数中初始化它？如果多个函数同时运行，并试图使用这个共享的 api 对象，会不会有问题？还有一个关于全局变量的一般问题：所有模块都共享变量吗？还是每个模块只能看到自己代码中声明的全局变量？例如，如果我在同一个工作簿中有模块 a 和模块 b，并且在模块 a 中声明了 api 对象并在 workbook_open 事件中进行了初始化，那么模块 b 中的函数是否可以使用它？

非常感谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:18:10.673

根据 API 的使用情况，它可以被初始化一次并在任何地方使用。

我建议阅读全局/公共/私有变量。

本质上，在函数外部将变量声明为 Private 意味着只能在该模块内访问该变量。声明为公共，意味着可以使用该工作簿在所有模块中访问它。声明为全局意味着它可以在该 Excel 实例中的所有工作簿中访问。

如果您只想使用一个工作簿在任何地方访问 API，我建议创建一个公共变量并在工作簿打开时对其进行初始化，确保在工作簿关闭时正确关闭/杀死任何变量。

# php - 从数据库中删除行并使用jquery查看

> ID：14676188
> 
> 赞同：1
> 
> 时间：2013-02-03T19:11:26.147
> 
> 标签：php, jquery, ajax

我有一个网页显示数据如下：

```
| id | name   | delete |
|  1 | orange | delete |
|  2 | apple  | delete | etc... 
```

当您按下删除（它是一个按钮）时，您会得到一个 jquery 对话框，再次显示两个按钮。您可以一次删除多个项目或仅删除所选项目。

```
-------------------------------
|dialog                       |
-------------------------------
|delete this row              |
|delete entire series         |
------------------------------- 
```

我的问题是：例如在对话框中选择“删除此行”时，如何在 jquery 中获取所选行的 ID？如何重定向到删除数​​据库中的行的 php 页面，然后重定向到当前更新的页面（删除了行）？

我对 jquery 很陌生，但这是我到目前为止得到的：

jQuery

```
<script>
$(function() {
   $( ".dialog" ).dialog({ autoOpen: false });
});
$(function() {
  $(".showDialog").click( function()
       {
         $( ".dialog" ).dialog( "open");
       });   
 });
 $(function() {
  $( ".deleteEvent" ).click( function()
    { 

        $( ".dialog" ).dialog( "close");
        $(this).closest("tr").remove(); // doesn't work
    });
 });
 </script> 
```

对话

```
<div class="dialog" title="delete event dialog">
    <input class="deleteEvent" type='button' value='delete this row'/>
</div> 
```

桌子

```
foreach($table as $row)
{
    echo '<tr><td>'.$row['id'].'</td>',
    '<td>'.$row['name'].'</td>',
    '<td><div class="showDialog" ><IMG style="margin-left:15px;" src="./public/pictures/trash.gif"></a></div></td>',
    '</tr>';
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:13:38.730

当您使用删除输入按钮输出 html 时，还添加一个隐藏输入字段，将 id 作为值传递

编辑：

我误读了您的代码，看起来您没有为每个显示的行提供单独的输入按钮。对于您的情况，我建议将该行添加为您的 div id 值的一部分，或者在您的 div 中添加一个自定义属性，如下所示：

```
foreach($table as $row)
{
    echo '<tr><td>'.$row['id'].'</td>',
    '<td>'.$row['name'].'</td>',
    '<td><div id="row_'.$row['id'].'" class="showDialog" ><IMG style="margin-left:15px;" src="./public/pictures/trash.gif"></a></div></td>',
    '</tr>';
} 
```

或者

```
foreach($table as $row)
{
    echo '<tr><td>'.$row['id'].'</td>',
    '<td>'.$row['name'].'</td>',
    '<td><div row="'.$row['id'].'" class="showDialog" ><IMG style="margin-left:15px;" src="./public/pictures/trash.gif"></a></div></td>',
    '</tr>';
} 
```

然后在您的点击事件中，您可以分别使用`$(this).attr('id').split('_')[1]`或`$(this).attr('row')`

# solr - Solr 空间搜索 - 如何先按显式匹配然后按距离对文档进行排序？

> ID：14676191
> 
> 赞同：1
> 
> 时间：2013-02-03T19:11:50.880
> 
> 标签：solr, spatial-query

我正在尝试确定如何对查询结果进行排序或评分，以便首先返回在特定字段上具有显式匹配的文档，然后是升序距离的其他匹配文档。

按照 Solr 的空间教程中使用的示例，假设我有几个商店，看起来像这样（伪）：

```
<Store>
  <Id>1</Id>
  <Coords>10,-15</Coords>
  <PostalCode>12345</PostalCode>
  <ServiceArea>
    <PostalCode>12345</PostalCode>
    <PostalCode>23456</PostalCode>
  </ServiceArea> 
</Store>

<Store>
  <Id>2</Id>
  <Coords>11,-16</Coords>
  <PostalCode>23456</PostalCode>
  <ServiceArea>
    <PostalCode>12345</PostalCode>
    <PostalCode>23456</PostalCode>
  </ServiceArea> 
</Store> 
```

所以，两家店。每个人都有自己的邮政编码，并且每个人都为彼此的邮政编码提供服务。现在我想查询以下内容：

```
Find stores which service PostalCode 12345
Ordered by stores in PostalCode 12345 first
Then ordered by ascending distance from PostalCode 12345 
```

我试图保持这个使用`StandardQueryParser`，如果涉及到提升，它需要在查询中定义，而不是在索引中定义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T16:31:07.740

对于排序规范，使用：

> sort=query({!field f=PostalCode v=12345})+desc,geodist()+asc

您可以对字段、分数和函数查询进行排序。函数查询开辟了很多可能性，如上所示，“query()”函数查询开辟了更多可能性。query() 将返回其中查询的分数，在这种情况下是搜索具有特定值的字段。我选择使用“字段”查询解析器，但您也可以使用 {!v="PostalCode:12345"}。

顺便说一句，不要忘记 geodist() 的其他参数，例如 'pt' 和 'sfield'。

# perl - 没有可执行文件路径的 Perl 系统调用，除了使用 PATH 变量

> ID：14676194
> 
> 赞同：0
> 
> 时间：2013-02-03T19:12:03.197
> 
> 标签：perl, include, system-calls

我不知道如何正确地用谷歌搜索：我想调用一个外部工具`Perl`- 对于非 root 安装的模块，我可以将目录添加到`@INC`. 但这不适用于其他二进制文件/可执行文件。例如 Perlfile 在`/home/user/dev/perl.pl`，模块在`/home/user/dev/modules/`，Pythonscript 在`/home/user/dev/tools/python.py`. 现在我可以`push @INC,'/home/user/dev/modules/'`找到所有模块。对于 pythonscript 我需要使用整个路径`system("python /home/user/dev/tools/python.py")`。是否有可能自动搜索工具目录，而不将其添加到构建 PATH，所以我只需要调用`system("python python.py")`？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:16:58.550

您可以从 Perl 脚本中将路径附加到 PATH 变量：

```
$ENV{PATH} .= ':/home/user/dev/tools'; 
```

通常，该设置不能更改父进程的 PATH 变量，只能更改脚本本身及其子进程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:28:10.897

如果您的 Python 脚本具有`#!`指向 python 的正确 shebang 行（例如第一行），您不需要这样做`system("python /home/user/dev/tools/python.py")`-`system("/home/user/dev/tools/python.py")`就足够了。

那么你就不需要依赖 Python 搜索了`$PATH`。

然后，您可以更改 $PATH：

```
local $ENV{PATH} = $ENV{PATH} ? "$ENV{PATH}:/home/user/dev/tools" 
                              : "/home/user/dev/tools";

system("python.py"); 
```

（确保将其本地化，以免影响程序中其他地方的 PATH）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:38:18.953

一种可能适合也可能不适合您需求的替代方法：

在调用系统之前的某处：

```
chdir '/home/user/dev/tools' or die "Couldn't chdir to tools: $!\n"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T21:38:44.413

关于你的更新，

> 在 perl.pl 中设置 $ENV 没有影响。$export PATH=$PATH:/home/user/dev/tools 并从 shell 运行 $python.py 工作。

这不是真的。如果这样可行，那么从 Perl设置`$ENV{PATH}`和运行也是如此。`python.py`

```
local $ENV{PATH} = "$ENV{PATH}:/home/user/dev/tools";
system("python.py"); 
```

# shape - jvectormap 缺失国家

> ID：14676195
> 
> 赞同：6
> 
> 时间：2013-02-03T19:12:04.943
> 
> 标签：shape, jvectormap

我已经使用 jvectormap 几个星期了，但是有很多缺失的国家。有谁知道我在哪里可以获得 jvectormap 格式的国家信息？

我在谷歌搜索了几个小时，但找不到任何东西。

有一个 jqvmap 有几个国家，但它的投影不同，也有一些国家缺失。

目前我正在使用：

```
jvectormap-world-en.js 
```

而且我无法处理 python 转换器。

有没有人有这方面的来源？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-04T16:05:54.473

您遇到的问题不仅仅是地图上缺少某些国家/地区。如果您只是将一堆小国家添加到地图上，那么即使在最高级别的缩放下，它们中的大多数也将不可见。[此演示](http://jvectormap.com/examples/markers-world/)建议的解决方案是使用 jVectorMap 的标记功能来呈现较小的国家。

您需要为标记分配代码而不是索引，以使数据方法正常工作。为此，只需在定义标记时使用哈希而不是数组：

```
//instead of this
markers: [
  {latLng: [41.90, 12.45], name: 'Vatican City'},
  {latLng: [43.73, 7.41], name: 'Monaco'},
  ...
]

//use this
markers: {
  "VA": {latLng: [41.90, 12.45], name: 'Vatican City'},
  "MC": {latLng: [43.73, 7.41], name: 'Monaco'},
  ...
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-08-07T10:05:45.320

您可以将以下几行添加到 jquery-jvectormap-world-mill.js 文件中以获取一些缺失的国家/地区

```
 "BH":  {"path": "M548 215 L549 215 L549 216 L548 216 Z", "name": "Bahrain"},
    "MV":  {"path": "M622 291 L624 291 L624 293 L622 293 Z", "name": "Maldives"},
    "SC":  {"path": "M564 301 L566 301 L566 303 L564 303 Z", "name": "Seychelles"},
    "MU":  {"path": "M571 347 L573 347 L573 349 L571 349 Z", "name": "Mauritius"},
    "SG":  {"path": "M680 280 L682 280 L682 282 L680 282 Z", "name": "Singapore"},
    "PW":  {"path": "M779 260 L781 260 L781 262 L779 262 Z", "name": "Palau"} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-15T13:56:06.077

最后我在维基媒体上找到了所有国家的矢量图：

[维基媒体.org](http://commons.wikimedia.org/wiki/File%3aBlankMap-Equirectangular.svg)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-14T18:03:14.740

这是包含所有国家/地区的更新 JS 文件

[https://gist.github.com/paulsheldrake/69d8817ab616aa81919b9dc438359ccf](https://gist.github.com/paulsheldrake/69d8817ab616aa81919b9dc438359ccf)

# php - 尝试发送表单元素，只显示提交按钮

> ID：14676203
> 
> 赞同：0
> 
> 时间：2013-02-03T19:13:30.593
> 
> 标签：php, html

我有一个`sign_up.php`包含我的网站注册表单的文件。表单的操作是我的`sitesignup.php`文件，它应该获取我的表单收集的信息，确保它都是有效且安全的，然后将其发送到我的 SQL 数据库。我遇到的问题是表单元素没有显示在 $_POST 数组中`sitesignup.php`，只有提交按钮。

有人可以让我了解我做错了什么吗？

文件：用户界面/sign_up.php

```
<head >
    <link rel="stylesheet" type="text/css" href="user_interface_tables.css">
</head>
<table class="outer">
    <tr>
    <form name="sign_up" method="post" action="user_interface/sitesignup.php">
    <input type="hidden" id="pagereference" value="<?php echo  $_SERVER['PHP_SELF']?>" >
        <td>
        <table class="inner">
            <tr>
                <td colspan="3"><strong>User Registration Form</strong></td>
            </tr>
            <tr>
                <td width="150">First Name <font id="asterisk">*</font></td>
                <td width="6">:</td>                
                <td width="290"><input type="text" id="first_name"></td>                
            </tr>
            <tr>
                <td >Last Name <font id="asterisk">*</font></td>
                <td >:</td>             
                <td ><input type="text" id="last_name"></td>                
            </tr>
            <tr>
                <td >User Name <font id="asterisk">*</font></td>
                <td >:</td>             
                <td "><input type="text" id="user_name"></td>               
            </tr>
            <tr>
                <td >Email<font id="asterisk">*</font></td>
                <td >:</td>             
                <td ><input type="text" id="email"></td>                
            </tr>
            <tr>
                <td >Password<font id="asterisk">*</font></td>
                <td >:</td>             
                <td ><input type="password" id="password1"></td>                
            </tr>
            <tr>
                <td >Confirm Password<font id="asterisk">*</font></td>
                <td >:</td>             
                <td ><input type="password" id="password2"></td>                
            </tr>
            <tr>
                <td >Registration Code</td>
                <td >:</td>             
                <td ><input type="text" id="registration_code"></td>                
            </tr>
            <tr>
                <td colspan="2"><input type="submit"name="submit" ></td>
            </tr>

        </table>
        </td>
    </form>
    </tr>
</table> 
```

文件：用户界面/sitesignup.php

```
<?php
var_dump($_POST);
?> 
```

输出：array(1) { ["submit"]=> string(6) "Submit" }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:13:30.593

当我即将发布时，我意识到了这个问题。其他人可以从我的错误中吸取教训，注意我是如何使用 id="blah" 作为表单元素的。

`name`标签是用于识别表单元素的标签，标签`id`是我用于CSS的标签，我想我写它的时候并没有想到......

例如：代替

```
<tr>
    <td >User Name <font id="asterisk">*</font></td>
    <td >:</td>             
    <td "><input type="text" id="user_name"></td>               
</tr> 
```

我会写

```
<tr>
    <td >User Name <font id="asterisk">*</font></td>
    <td >:</td>             
    <td "><input type="text" name="user_name"></td>             
</tr> 
```

现在我的 var 转储显示了我所有的表单元素：D

> array(7) { ["first_name"]=> string(3) "dan" ["last_name"]=> string(3) "dan" ["user_name"]=> string(4) "name" ["email "]=> string(4) "name" ["password1"]=> string(4) "name" ["password2"]=> string(4) "name" ["submit"]=> string(6) “提交” }

# android - 来自地址的特定英国国家

> ID：14676217
> 
> 赞同：2
> 
> 时间：2013-02-03T19:15:05.083
> 
> 标签：android, street-address

我正在开发一个应用程序，它可以根据用户所在的国家/地区获取用户位置和搜索。

我的问题是`Address.getCountryName()`当我需要的是“威尔士”、“英格兰”等时返回字符串“英国”。

我试过`Address.GetAdminArea()`了，但这总是返回`Null`。

我尝试在调试模式下查看返回的地址，但看不到我需要什么。

有任何想法吗？

# javascript - KnockoutJS：如何在可观察数组中插入数据后运行脚本

> ID：14676220
> 
> 赞同：0
> 
> 时间：2013-02-03T19:15:14.543
> 
> 标签：javascript, data-binding, knockout.js, knockout-2.0

我有一个画廊列表：

```
 <div class="gallery">
            <a href="#" class="next">next</a>
            <a href="#" class="prev">prev</a>

            <div class="frame">
                <ul data-bind="foreach: designs">
                    <li>
                        <span class="text">№&lt;span data-bind="text: getID()"></span> <span data-bind="text: getName()"></span></span>
                         <img src="images/img01.jpg" width="182" height="102" alt="image description"/>
                    </li>
                </ul>
            </div>

  </div> 
```

**JS**

```
Models.Design = function () {...}

function ViewModel(){   
    this.designs = ko.observableArray();

    this.addDesign = function (_id, _name, _image, _video) {

        var design = new Models.Design;

        design.setID(_id);
        design.setName(_name);

        this.designs.push(design);
   };

   this.addDesign(1, "Image 1");
   this.addDesign(2, "Image 1");
   this.addDesign(3, "Image 1");
 // at this moment there is no elements in DOM
} 
```

**问题：**我需要在哪里写`$('.gallery').galleryScroll();`来更新我的画廊滑块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:29:16.820

只需订阅 observable。对集合的任何可见*更改都将调用您的回调。

```
function ViewModel() {
    this.designs = ko.observableArray();
    this.designs.subscribe(function () {
        $('.gallery').galleryScroll();
    });

    // ...
} 
```

* 可见意味着你对 observable 执行操作，而不是直接对底层数组执行操作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:42:42.710

我找到了解决方案：

```
ko.bindingHandlers.gallery = {
    update: function(element, valueAccessor) {
        setTimeout(function() {
            $(element).parents('.gallery').galleryScroll();
        });
    }
};

 <ul data-bind="foreach: designs, gallery:{}">
     <li>....</li>
 </ul> 
```

# php - 添加到子 XML cdata

> ID：14676221
> 
> 赞同：1
> 
> 时间：2013-02-03T19:15:23.000
> 
> 标签：php, html, xml

我想知道如何在 xml child 中添加 cdata？我得到了这个代码：

```
$errors = array();
if(isset($_POST['newtopic'])){
    $topicname = preg_replace('/[^A-Za-z]/', '', $_POST['topicname']);
    $textarea = $_POST['textarea'];
    $desc = $_POST['desc'];
    $startedby = $_POST['startedby'];
    $tn = $_POST['topicname'];

    if($topicname == ''){
        $errors[] = 'You`re topic title is missing!';
    }
    if($topicname == ''){
    $errors[] = 'You`re textarea is missing!';
}

    if(count($errors) == 0){
        $xml = new SimpleXMLElement('<topic></topic>');
        $xml->addChild('textarea', $textarea);
        $xml->addChild('desc', $desc);
        $xml->addChild('startedby', $startedby);
        $xml->addChild('date', $date);
        $xml->addChild('topicname', $tn);
        $xml->asXML('topics/sitenews/' . $topicname . '.xml');
        header('Location: sitenews.php');
        die;
    }
} 
```

我只想将 cdata 添加到 $textarea 部分，我尝试过已经使用`'<![CDATA['. $textarea .']]>'`但它不起作用。

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:22:19.447

请参阅此处 [如何使用 SimpleXmlElement 编写 CDATA？](https://stackoverflow.com/questions/6260224/how-to-write-cdata-using-simplexmlelement)

从链接的示例中复制：

```
class SimpleXMLExtended extends SimpleXMLElement{ 
  public function addCData($cdata_text){ 
   $node= dom_import_simplexml($this); 
   $no = $node->ownerDocument; 
   $node->appendChild($no->createCDATASection($cdata_text)); 
  } 
} 

$doc = new SimpleXMLExtended($xml); 
$element = $doc->addChild('response'); 
$node_note = $element->addChild('note'); 
$node_note->addCData('my cdata guff'); 
var_dump($doc->asXML()); 
```

# c - 在 gcc 中从内联汇编中引用全局变量

> ID：14676222
> 
> 赞同：0
> 
> 时间：2013-02-03T19:15:27.420
> 
> 标签：c, gcc, assembly, inline-assembly, undefined-reference

我遇到的问题是链接器从内联汇编代码生成未定义的引用错误。

```
int global_var = 0;
void myfunc()
{
    asm(".intel_syntax noprefix\n");
    asm("lea eax, global_var\n");
} 
```

我正在使用 GCC 3.4.2 使用 -masm=intel 进行编译，没有任何优化或任何东西。如果有人也遇到这种不便，请提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:55:24.713

基本上，这是*名称修改*的问题- 也就是说，编译器在编译阶段修改（更改）变量和函数的名称。在这种情况下，“global_var”被更改为“_global_var”

如果您更改函数的第二行以使其访问“_global_var”，那么它编译得很好。（测试 GCC 4.7.1）

# vhdl - 无法对 VHDL 中的无符号执行逻辑运算？

> ID：14676225
> 
> 赞同：0
> 
> 时间：2013-02-03T19:15:37.040
> 
> 标签：vhdl, modelsim

我在执行逻辑操作时遇到问题`unsigned`：

```
library ieee;
use ieee.std_logic_1164.all;
use ieee.std_logic_arith.all;    
with sel select
s_1<=a+b when "000",
a+((not b)+1) when "001",
s_2 when "010",
s_3 when "011",
s_4 when "100",
(others=>'0') when others; 
```

这里有一个错误：

> 前缀运算符“not”没有可行的条目

`s_1,a,b,s_2,s_3,s_4`都是类型`unsigned(31 downto 0)`。

我找到了一个转换`std_logic_vector`为无符号的代码，以启用逻辑操作，`std_logic_vector`如果它不能在无符号上完成，但是这个代码使用`numeric_std.all`的时候我认为它与无符号的数据类型发生冲突`std_logic_arith`并使无符号的数据类型未知。

现在我不知道如何对 unsigned 执行逻辑操作，也不知道如何转换`std_logic_vector`为`unsigned`. 有人能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:48:19.070

您正在使用一个非标准库，`use ieee.std_logic_arith.all;` 它显然没有实现“非”运算符。

`use ieee.numeric_std.all;` 取而代之应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T14:31:54.103

一个可怕的解决方法是`xor` `b`使用所有向量的向量......

# html - jsp标签中的html

> ID：14676227
> 
> 赞同：0
> 
> 时间：2013-02-03T19:15:42.407
> 
> 标签：html, jsp, tags

jsp标签中的html

```
 <jsp:setProperty name="mail" property="message" value="<html> <body><h1>Welcome</h1> <br/> <table cellpadding=\"6\" cellspacing=\"0\" border=\"1\">
                   <tr><td style=\"text-align: left;font-weight: bold\">User Name:</td><td> +email+</td></tr> <tr><td style=\"text-align: left;font-weight: bold\">Password:</td><td>+pass+</td></tr>
                  </table></body></html>"/> 
```

不以表格格式显示，但显示整个 html 标记

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:19:00.560

在 XML 中，双引号不使用反斜杠进行转义。他们使用`&quot;`.

# jquery - 如何添加文本而不是图像 jquery 幻灯片？

> ID：14676228
> 
> 赞同：1
> 
> 时间：2013-02-03T19:15:47.900
> 
> 标签：jquery

我正在使用由 Matt Hinchliffe ( [http://i-like-robots.github.com/jQuery-Slideshow/](http://i-like-robots.github.com/jQuery-Slideshow/) ) 创建的查询幻灯片我真的很喜欢这个幻灯片的简单性和速度。要回答我的问题，请访问我的网站 ( [http://www.vanessenstudio.com](http://www.vanessenstudio.com) )

我想要这个部分：

```
 <section id="introduction">
    <div id="example">
    <div class="slideshow" data-transition="scroll" data-loop="true" data-skip="true" data-pagination="false">
    <ul class="carousel">
        <li class="slide"><img alt="" src="images/facephoto.jpg" width="960" height="400" /></li>
        <li class="slide"><img alt="" src="images/facephoto1.jpg" width="960" height="400" /></li>
        <li class="slide"><img alt="" src="images/facephoto2.jpg" width="960" height="400" /></li>
    </ul>
    </div>
    </div>
    </section> 
```

有一张幻灯片，其文本的固定宽度和高度为 960 x 400。我知道我可以在 Illustrator 中创建一个文件并将其另存为图像，但我想知道这是否可能。我在 li class by 之后替换了 ing alt= 并且确实出现了足够的文本。不幸的是，它没有出现在固定的宽度和高度中。

任何帮助，将不胜感激。

# java - 以水平顺序显示一系列图片（带有图像的 JPanel）

> ID：14676229
> 
> 赞同：1
> 
> 时间：2013-02-03T19:16:04.323
> 
> 标签：java, image, swing, embedded-resource

我一直在寻找一种以类似网格的方式在 JPanel 上显示图像的方法，并遇到了[这个解决方案](https://stackoverflow.com/questions/7222988/java-drag-and-drop-images-in-a-list)。该代码运行良好，但是当我尝试通过使用`jpg`图像而不是绘制矩形来修改它时，我无法让它工作。我的修改如下：

```
/*
 * courtesy of https://stackoverflow.com/questions/7222988/java-drag-and-drop-images-  in-a-list
 */

import java.awt.*;
import java.awt.datatransfer.DataFlavor;
import java.awt.datatransfer.Transferable;
import java.awt.datatransfer.UnsupportedFlavorException;
import java.io.IOException;
import java.io.Serializable;
import javax.swing.*;
import javax.swing.border.Border;

public class ImagePreviewList {

public static void main(String[] args) throws Exception {
    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
    JFrame frame = new JFrame("Image panel");
    frame.setSize(800, 300);
    frame.setLocationByPlatform(true);
    JList imageList = createImageList();
    frame.getContentPane().add(new JScrollPane(imageList));
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setVisible(true);
}

private static JList createImageList() {

    JList imageList = new JList(createModel());
    imageList.setCellRenderer(new ImageCellRenderer());
    imageList.setLayoutOrientation(JList.HORIZONTAL_WRAP);
    imageList.setVisibleRowCount(-1);
    imageList.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
    imageList.setFixedCellWidth(240);
    imageList.setFixedCellHeight(120);

    imageList.setDragEnabled(true);
    imageList.setDropMode(DropMode.INSERT);
    imageList.setTransferHandler(new ImageTransferHandler(imageList));

    return imageList;
}

private static DefaultListModel createModel() {
    DefaultListModel model = new DefaultListModel();
    model.addElement(new RTS_image("3-Way_Stop_sign"));
    model.addElement(new RTS_image("4-Way_Stop_sign"));
    model.addElement(new RTS_image("No_Entry_sign"));
    model.addElement(new RTS_image("One-Way_Roadway_sign-0"));
    model.addElement(new RTS_image("One-Way_Roadway_sign-1"));
    model.addElement(new RTS_image("One-Way_Roadway_sign-3"));
    model.addElement(new RTS_image("Pedestrian-Priority_sign"));
    model.addElement(new RTS_image("Stop#Go_sign"));
    model.addElement(new RTS_image("Stop_and_Yield_sign"));
    model.addElement(new RTS_image("Stop_sign-0"));
    model.addElement(new RTS_image("Stop_sign-1"));
    model.addElement(new RTS_image("Yield_at_Mini-Circle_sign"));
    model.addElement(new RTS_image("Yield_sign"));
    model.addElement(new RTS_image("Yield_to_Pedestrians_sign"));
    model.addElement(new RTS_image("Yield_to_oncoming_traffic_sign"));
    return model;
}

static class ImageTransferHandler extends TransferHandler {

    private static final DataFlavor DATA_FLAVOUR = new DataFlavor(RTS_image.class,  "Images");

    private final JList previewList;
    private boolean inDrag;

    ImageTransferHandler(JList previewList) {
        this.previewList = previewList;
    }

    public int getSourceActions(JComponent c) {
        return TransferHandler.MOVE;
    }

    protected Transferable createTransferable(JComponent c) {
        inDrag = true;
        return new Transferable() {
            public DataFlavor[] getTransferDataFlavors() {
                return new DataFlavor[] {DATA_FLAVOUR};
            }

            public boolean isDataFlavorSupported(DataFlavor flavor) {
                return flavor.equals(DATA_FLAVOUR);
            }

            public Object getTransferData(DataFlavor flavor) throws UnsupportedFlavorException, IOException {
                return previewList.getSelectedValue();
            }
        };
    }

    public boolean canImport(TransferSupport support) {
        if (!inDrag || !support.isDataFlavorSupported(DATA_FLAVOUR)) {
            return false;
        }

        JList.DropLocation dl = (JList.DropLocation)support.getDropLocation();
        if (dl.getIndex() == -1) {
            return false;
        } else {
            return true;
        }
    }

    public boolean importData(TransferSupport support) {
        if (!canImport(support)) {
            return false;
        }

        Transferable transferable = support.getTransferable();
        try {
            Object draggedImage = transferable.getTransferData(DATA_FLAVOUR);

            JList.DropLocation dl = (JList.DropLocation)support.getDropLocation();
            DefaultListModel model = (DefaultListModel)previewList.getModel();
            int dropIndex = dl.getIndex();
            if (model.indexOf(draggedImage) < dropIndex) {
                dropIndex--;
            }
            model.removeElement(draggedImage);
            model.add(dropIndex, draggedImage);
            return true;
        } catch (Exception e) {
            e.printStackTrace();
            return false;
        }
    }

    protected void exportDone(JComponent source, Transferable data, int action) {
        super.exportDone(source, data, action);
        inDrag = false;
    }
}

static class ImageCellRenderer extends JPanel implements ListCellRenderer {

    DefaultListCellRenderer defaultListCellRenderer = new DefaultListCellRenderer();
    JLabel imageLabel = new JLabel();
    JLabel descriptionLabel = new JLabel();

    ImageCellRenderer() {
        setLayout(new BorderLayout());
        Border emptyBorder = BorderFactory.createEmptyBorder(5, 5, 5, 5);
        imageLabel.setBorder(emptyBorder);
        descriptionLabel.setBorder(emptyBorder);
        add(imageLabel, BorderLayout.CENTER);
        add(descriptionLabel, BorderLayout.SOUTH);
    }

    public Component getListCellRendererComponent(JList list, Object value, int index, boolean isSelected, boolean cellHasFocus) {
        defaultListCellRenderer.getListCellRendererComponent(list, value, index, isSelected, cellHasFocus);
        setBorder(defaultListCellRenderer.getBorder());
        setBackground(defaultListCellRenderer.getBackground());
        imageLabel.setIcon((Icon)value);
        descriptionLabel.setText("Description");
        return this;
    }
}

static class RTS_image implements Icon, Serializable {
    private String Name_of_RoadSign; 

    RTS_image(String name_of_roadsign) {
        this.Name_of_RoadSign = name_of_roadsign;
    }

    java.net.URL imgURL = com.umusebo.RTS.ImagePreviewList.class.getResource("images/01_Regulatory_Signs/01_Control_Signs/reg_cont_" + Name_of_RoadSign + ".jpg");

    Image img = Toolkit.getDefaultToolkit().createImage(imgURL);

    public void paintIcon(Component c, Graphics g, int x, int y) {
        g.drawImage(img, x, y, c);
    }

    public int getIconWidth() {
        return 114;
    }

    public int getIconHeight() {
        return 125;
    }

    public String getName_of_RoadSign() {
        return Name_of_RoadSign;
    }

    public boolean equals(Object o) {
        if (o == null || getClass() != o.getClass()) {
            return false;
        }
        return Name_of_RoadSign.equals(((RTS_image)o).Name_of_RoadSign);
    }

} 
```

}

执行后出现以下错误（对于我尝试显示的 15 张图像重复 15 次）：

```
Uncaught error fetching image:
java.lang.NullPointerException
at sun.awt.image.URLImageSource.getConnection(URLImageSource.java:115)
at sun.awt.image.URLImageSource.getDecoder(URLImageSource.java:125)
at sun.awt.image.InputStreamImageSource.doFetch(InputStreamImageSource.java:263)
at sun.awt.image.ImageFetcher.fetchloop(ImageFetcher.java:205)
at sun.awt.image.ImageFetcher.run(ImageFetcher.java:169) 
```

问题可能出在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:30:14.173

您已经声明了许多您尝试使用来自其他变量的值来初始化的类级别字段`null`

例如，您正在`imgURL`从变量声明和初始化`Name_of_RoadSign`，这将是`null`.

```
java.net.URL imgURL = com.umusebo.RTS.ImagePreviewList.class.getResource(
    "images/01_Regulatory_Signs/01_Control_Signs/reg_cont_"
    + Name_of_RoadSign + ".jpg"); 
```

您必须记住，类字段是在执行任何类构造函数之前初始化的。

尝试在构造函数中初始化这些类变量

```
RTS_image(String name_of_roadsign) {
    this.Name_of_RoadSign = name_of_roadsign;
    imgURL = com.umusebo.RTS.ImagePreviewList.class.getResource(
        "images/01_Regulatory_Signs/01_Control_Signs/reg_cont_"
        + Name_of_RoadSign + ".jpg");
    img = Toolkit.getDefaultToolkit().createImage(imgURL);
} 
```

`ToolKit#createImage`往往会默默地忽略错误，`null`即使无法加载图像也会返回 none 值。你最好使用它`ImageIO`。除了支持更广泛的图像格式之外，它还会抛出更有意义的异常，从而更容易诊断问题。

例如...

```
img = ImageIO.read(imgURL); 
```

不要忘记，这会抛出一个，`IOException`所以你要么需要抓住它，要么（更好）将它传回给调用者。

我还鼓励您熟悉[*Java 编程语言的代码约定*](http://www.oracle.com/technetwork/java/codeconv-138413.html)。你不会通过忽视他们来结交任何朋友或影响他们。;)

# ios - UIVIew 会随着我向下滚动而增长吗？

> ID：14676232
> 
> 赞同：-3
> 
> 时间：2013-02-03T19:16:23.090
> 
> 标签：ios, uiview, uiviewcontroller, uiscrollview, screen

所以我想制作一个应用程序，它会在比屏幕长度视图更长的时间上显示 20 张图片。然后在用户一直向下滚动到底部并到达末尾之后，如果他尝试向下滚动更多，则视图将变得更长，并加载另外 20 张图片。有没有人对如何做这样的事情有任何想法？和建议或提示或小教程将不胜感激。

非常感谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:53:34.040

我认为 UITableView 非常适合这个。您的表中可以有两个部分。首先将包含带有图片的单元格。第二个将包含一个代表用于加载更多图像的按钮的单元格。如果用户点击此单元格，您只需加载更多图片并增加 UITableViewDataSource 方法中的单元格数量。

# encoding - 视频编码和关键帧

> ID：14676234
> 
> 赞同：4
> 
> 时间：2013-02-03T19:16:35.520
> 
> 标签：encoding, ffmpeg, x264, keyframe

我正在逐帧转码视频并使用 x264+ffmpeg 进行编码。原始视频播放良好，但我转码视频的前几帧显示灰色伪影。我知道这是因为时间压缩，这些伪影在几帧后消失了。

请看这两张图片，它们是第一帧和第二帧。第三帧正常（即没有灰色伪影，也没有像第二帧那样模糊） ![第一帧](../Images/71ce93a2e58c2661168b8d95dae141fe.png) ![第二帧](../Images/cc9b5013f6e8c00edd423891846db9ac.png)

如何强制第一帧成为关键帧（即在我的输出视频中完全编码），以使这些伪影不显示？

**编辑 - 更多细节**

这是我正在做的更多细节。我使用 bit form differents 教程逐帧读取视频并将每一帧重新编码为新视频。我的编码参数如下：

```
avcodec_get_context_defaults3(c, *codec);
c->codec_id = codec_id;
c->bit_rate = output_bitrate;
/* Resolution must be a multiple of two. */
c->width    = output_width;
c->height   = output_height;
/* timebase: This is the fundamental unit of time (in seconds) in terms
 * of which frame timestamps are represented. For fixed-fps content,
 * timebase should be 1/framerate and timestamp increments should be
 * identical to 1\. */
st->r_frame_rate.num = output_framerate_num;
st->r_frame_rate.den = output_framerate_den;
c->time_base.den = output_timebase_den;
c->time_base.num = output_timebase_num;
c->gop_size      = 3; /* emit one intra frame every twelve frames at most */
c->pix_fmt       = STREAM_PIX_FMT;
if (c->codec_id == AV_CODEC_ID_MPEG2VIDEO) {
    /* just for testing, we also add B frames */
    c->max_b_frames = 2;
}
if (c->codec_id == AV_CODEC_ID_MPEG1VIDEO) {
    /* Needed to avoid using macroblocks in which some coeffs overflow.
     * This does not happen with normal video, it just happens here as
     * the motion of the chroma plane does not match the luma plane. */
    c->mb_decision = 2;
}
c->max_b_frames = 2;
c->scenechange_threshold = 0;
c->rc_buffer_size = 0;
c->me_method = ME_ZERO; 
```

然后我处理每一帧，可能在那里做错了什么。解码位：

```
while(av_read_frame(gFormatCtx, &packet)>=0) {
    // Is this a packet from the video stream?
    if(packet.stream_index==gVideoStreamIndex) {
        // Decode video frame
        avcodec_decode_video2(gVideoCodecCtx, pCurrentFrame, &frameFinished, &packet);
        // Did we get a video frame?
        if(frameFinished) {
            [...]
            if(firstPts == -999) /*Initial value*/
                firstPts = packet.pts;
            deltaPts = packet.pts - firstPts;
            double seconds = deltaPts*av_q2d(gFormatCtx->streams[gVideoStreamIndex]->time_base);
            [...]
            muxing_writeVideoFrame(pCurrentFrame, packet.pts);
        }
    }
} 
```

实际写法：

```
int muxing_writeVideoFrame(AVFrame *frame, int64_t pts)
{
frameCount = frameCount +1;
if(frameCount > 0)
{
    if (video_st)
        video_pts = (double)video_st->pts.val * video_st->time_base.num /
                    video_st->time_base.den;
    else
        video_pts = 0.0;

    if (video_st && !(video_st && audio_st && audio_pts < video_pts))
    {
        frame->pts = pts;//av_rescale_q(frame_count, video_st->codec->time_base, video_st->time_base);
        write_video_frame(oc, video_st, frame);
    }
}

return 0;
}

static int write_video_frame(AVFormatContext *oc, AVStream *st, AVFrame *frame)
{
    int ret;
    static struct SwsContext *sws_ctx;
    //LOGI(10, frame_count);
    AVCodecContext *c = st->codec;

    /* encode the image */
    AVPacket pkt;
    int got_output;
    av_init_packet(&pkt);
    pkt.data = NULL;    // packet data will be allocated by the encoder
    pkt.size = 0;
ret = avcodec_encode_video2(c, &pkt, frame, &got_output);
if (ret < 0) {
    fprintf(stderr, "Error encoding video frame: %s\n", av_err2str(ret));
    exit(1);
}
/* If size is zero, it means the image was buffered. */
if (got_output) {
    if (c->coded_frame->key_frame)
        pkt.flags |= AV_PKT_FLAG_KEY;
    pkt.stream_index = st->index;
    /* Write the compressed frame to the media file. */
    ret = av_interleaved_write_frame(oc, &pkt);
} else {
    ret = 0;
}

    if (ret != 0) {
        LOGI(10, av_err2str(ret));
        exit(1);
    }
    frame_count++;
    return got_output;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:04:37.363

您的问题很可能出在解码部分而不是编码中（x264 无法产生此类伪影）。如上所述，您似乎不是从关键帧开始解码（或者可能是您的流是开放式的，并且您没有丢弃第一个 B 帧）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:32:34.243

这是因为您的视频不是以 [**关键帧**](http://wikipedia.org/wiki/Video_compression_picture_types)开头的。为了解决这个问题，我使用[**AviDemux**](http://fixounet.free.fr/avidemux)。从 2.6 版开始

*   MP4 混音器
*   MP4v2 混音器

并且可能更多支持没有关键帧的视频。

# cordova - 在系统上下文菜单中执行我的 Cordova 移动应用程序的选项

> ID：14676236
> 
> 赞同：0
> 
> 时间：2013-02-03T19:16:51.593
> 
> 标签：cordova, contextmenu, windows-phone-8

我有一个 Cordova(PhoneGap) WindowsPhone8 移动应用程序，它将 URL 存储在远程服务器上。

这些 URL 可以在电话、电子邮件、SMS 收件箱甚至其他应用程序中的任何位置。

是否可以在系统的上下文菜单中添加一个选项以在选定/或长按的 URL 上执行我的应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-09T20:17:35.447

您可以尝试使用点击事件或其他必需的事件来处理此问题。

一个简单的实现可以使用插件[http://dev.jtsage.com/jQM-SimpleDialog/demos2/](http://dev.jtsage.com/jQM-SimpleDialog/demos2/)

# c# - 如何将现有的数据访问类转换为 Web 服务

> ID：14676238
> 
> 赞同：-2
> 
> 时间：2013-02-03T19:16:55.200
> 
> 标签：c#, asp.net, web-services

我有一个数据访问类，它使用某些存储过程来选择/插入/更新数据库中的数据。如何将此类转换为 Web 服务并将所有方法转换为 Web 方法？我正在使用 vs 2012 和 c#。该数据处理类部分的一个示例是

```
namespace HPS.Thesaurus.Data
{
public class TermDB : DbObjectStatic
{
    #region Public Methods

    #region CRUD Methods                

    public static int Add(Term term, string useString, string useForString, string broaderTermString, string narrowerTermString, string relatedTermString, string userName, ref int historyTermId)
    {
        int rowsAffected = 0;
        SqlParameter[] parameter = 
        { 
            new SqlParameter("@name", SqlDbType.VarChar, 200),
            new SqlParameter("@type", SqlDbType.Int),
            new SqlParameter("@scope", SqlDbType.VarChar, 2000),
            new SqlParameter("@hpspublic", SqlDbType.Bit),
            new SqlParameter("@additionalnotes",SqlDbType.VarChar,2000),
            new SqlParameter("@usestring", SqlDbType.VarChar, 2000),
            new SqlParameter("@useforstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@broaderstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@narrowerstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@relatedstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@changedby", SqlDbType.VarChar, 15),
            new SqlParameter("@id", SqlDbType.Int),
            new SqlParameter("@historytermid", SqlDbType.Int)
        };

        parameter[0].Value = term.Name;
        parameter[1].Value = term.Type;
        parameter[2].Value = term.Scope;
        parameter[3].Value = term.HPSPublic;
        parameter[4].Value = term.AdditionalNotes;

        if (useString.Trim().Length > 0)
        {
            parameter[5].Value = useString;
        }

        if (useForString.Trim().Length > 0)
        {
            parameter[6].Value = useForString;
        }

        if (broaderTermString.Trim().Length > 0)
        {
            parameter[7].Value = broaderTermString;
        }

        if (narrowerTermString.Trim().Length > 0)
        {
            parameter[8].Value = narrowerTermString;
        }

        if (relatedTermString.Trim().Length > 0)
        {
            parameter[9].Value = relatedTermString;
        }

        if (userName.Trim().Length > 0)
        {
            parameter[10].Value = userName;
        }

        parameter[11].Direction = ParameterDirection.Output;
        parameter[12].Direction = ParameterDirection.Output;

        try
        {
            RunProcedure("Term_Add", parameter, out rowsAffected, AppConfiguration.ConnectionString());
        }
        catch
        {
            return -1;
        }

        historyTermId = (int)parameter[12].Value;
        return (int)parameter[11].Value;
    }

    public static bool Delete(Term term)
    {
        int rowsAffected = 0;

        SqlParameter[] parameter = 
        { 
            new SqlParameter("@id", SqlDbType.Int) 
        };

        parameter[0].Value = term.Id;

        try
        {
            RunProcedure("Term_Delete", parameter, out rowsAffected, AppConfiguration.ConnectionString());
        }
        catch
        {
            return false;
        }

        return rowsAffected > 0;
    }

    public static Term GetTerm(int termId)
    {
        SqlParameter[] parameters = 
        { 
            new SqlParameter("@id", SqlDbType.Int)
        };

        parameters[0].Value = termId;

        using (DataTable dt = RunProcedure("Term_Get", parameters, "terms", AppConfiguration.ConnectionString()))
        {
            if (dt.Rows.Count > 0)
            {
                return FillData(dt.Rows[0]);
            }
            else
            {
                return null;
            }
        }
    }

    public static Term GetTerm(string termName)
    {
        SqlParameter[] parameters = 
        { 
            new SqlParameter("@name", SqlDbType.VarChar, 1000)
        };

        parameters[0].Value = termName;

        using (DataTable dt = RunProcedure("Term_GetByName", parameters, "terms", AppConfiguration.ConnectionString()))
        {
            if (dt.Rows.Count > 0)
            {
                return FillData(dt.Rows[0]);
            }
            else
            {
                return null;
            }
        }
    }

    public static bool Update(Term term, string useString, string useForString, string broaderTermString, string narrowerTermString, string relatedTermString, string changedBy, ref int historyTermId)
    {
        int rowsAffected = 0;
        SqlParameter[] parameter = 
        {   
            new SqlParameter("@id", SqlDbType.Int),
            new SqlParameter("@name", SqlDbType.VarChar, 200),
            new SqlParameter("@type", SqlDbType.Int),
            new SqlParameter("@scope", SqlDbType.VarChar, 2000),
            new SqlParameter("@hpspublic", SqlDbType.Bit),
            new SqlParameter("@additionalnotes",SqlDbType.VarChar,2000),
            new SqlParameter("@usestring", SqlDbType.VarChar, 2000),
            new SqlParameter("@useforstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@broaderstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@narrowerstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@relatedstring", SqlDbType.VarChar, 2000),
            new SqlParameter("@changedBy", SqlDbType.VarChar, 15),
            new SqlParameter("@historyTermId", SqlDbType.Int),      
        };

        parameter[0].Value = term.Id;
        parameter[1].Value = term.Name;
        parameter[2].Value = term.Type;
        parameter[3].Value = term.Scope;
        parameter[4].Value = term.HPSPublic;
        parameter[5].Value = term.AdditionalNotes;
        if (useString.Trim().Length > 0)
        {
            parameter[6].Value = useString;
        }

        if (useForString.Trim().Length > 0)
        {
            parameter[7].Value = useForString;
        }

        if (broaderTermString.Trim().Length > 0)
        {
            parameter[8].Value = broaderTermString;
        }

        if (narrowerTermString.Trim().Length > 0)
        {
            parameter[9].Value = narrowerTermString;
        }

        if (relatedTermString.Trim().Length > 0)
        {
            parameter[10].Value = relatedTermString;
        }

        if (changedBy.Trim().Length > 0)
        {
            parameter[11].Value = changedBy;
        }

        parameter[12].Direction = ParameterDirection.Output;

        try
        {
            RunProcedure("Term_Update", parameter, out rowsAffected, AppConfiguration.ConnectionString());
        }
        catch
        {
            return false;
        }

        historyTermId = (int)parameter[12].Value;
        return rowsAffected > 0;
    }

    #endregion

    public static TermList GetAll()
    {
        TermList tl = null;

        using (DataTable dt = RunProcedure("Term_GetAll", new IDataParameter[] { }, "terms", AppConfiguration.ConnectionString()))
        {
            tl = new TermList();
            if (dt.Rows.Count > 0)
            {
                foreach (DataRow dr in dt.Rows)
                {
                    tl.Add(FillData(dr));
                }
            }
        }

        return tl;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:43:42.450

要将方法转换为 Web 服务，您需要将所有方法声明为 [Operation Contract]，并将所有自定义类声明为 [Data Contract] 属性。您的示例非常简单的答案是

```
[Operation Contract]
public static int Add(Term term, string useString, string useForString, string broaderTermString, string narrowerTermString, string relatedTermString, string userName, ref int historyTermId); 
```

为了解决这个问题，请尝试在 WCF 中创建一个单独的 Web 服务项目，以便您获得所有默认配置，然后手动添加具有适当合同和操作的方法应该可以工作。

# c# - 如何在不滚动的情况下找到文本框中适合多少文本

> ID：14676240
> 
> 赞同：3
> 
> 时间：2013-02-03T19:17:10.663
> 
> 标签：c#, textbox, windows-runtime, winrt-xaml

我有一个相对较大的文本。我需要将一定数量的此文本添加到文本框中，以便无需滚动即可看到它，然后将其余文本添加到另一个文本框，然后再添加另一个 -.-.-.> 循环生成尽可能多的文本框有必要的。

我的问题是我不知道如何找出每个文本框中有多少文本。到目前为止，我唯一能做的就是分配固定数量的适合页面的字符。但这不适用于不同的屏幕分辨率。有没有办法，技巧或解决方法可以用来计算有多少文本可以放入具有固定字体和字体大小但相对宽度和高度的文本框中？

```
int TextLength = 1000, PageStart = 0;

List<TextBox> Pages = new List<TextBox>();  
while (PageStart < TextLength) 
{
     TextBox p = new TextBox();
      if (PageStart + PageLength < TextLength)
      {
             p.PageText = Text.Substring(PageStart, PageLength);
             PageStart += PageLength;
             Pages.Add(p);
      }
      else
      {
             PageLength = TextLength - PageStart;
             p.PageText = Text.Substring(PageStart, PageLength);
             Pages.Add(p);
             break;
       }                      
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:18:38.300

使用 TextBlock 可能会更好。除此之外，TextBlock 测量技术也应该适用于 TextBoxes -[如果我从代码创建文本块，如何计算加载时的文本框高度和宽度？](https://stackoverflow.com/questions/10556019/how-to-calculate-the-textbock-height-and-width-in-on-load-if-i-create-textblock)

您需要在增加文本量的同时测量 ActualHeight，直到超出限制。

# cuda - 使用 Mathematica CUDADot 时提高 GPU 的利用率？

> ID：14676243
> 
> 赞同：3
> 
> 时间：2013-02-03T19:17:37.247
> 
> 标签：cuda, wolfram-mathematica

我最近开始使用带有 GT430 的 Mathematica 的 CUDALink，并且正在使用 CUDADot 将 150000x1038 矩阵（encs）乘以 1038x1 矩阵（探针）。encs 和 probe 都向内存管理器注册：

```
mmEncs = CUDAMemoryLoad[encs];
mmProbe = CUDAMemoryLoad[probe]; 
```

我认为这些的点积会最大化 GT430，所以我用以下方法进行了测试：

```
For[i = 0, i < 10, i++,
 CUDADot[mmEncs, mmProbe];
] 
```

在它运行时，我使用 MSI 的“Afterburner”实用程序来监控 GPU 的使用情况。以下屏幕截图显示了结果：

![在此处输入图像描述](../Images/f88195f50d47410e665419fff6f6d953.png)

每个 CUDADot 操作都有一个明显的峰值，总的来说，我想说这张照片表明我使用的 GPU 容量不到 1/4。两个问题：

Q1：为什么峰值会达到 50%？好像很低。

问题 2：为什么高峰之间会有如此显着的不活动期？

提前感谢您的任何提示！我不知道第一季度，但也许第二季度是因为主机和设备之间的意外内存传输？

自原始发布以来的附加信息：CUDAInformation[] 报告“核心数 - > 64”，但 NVIDIA 控制面板报告“CUDA 核心数：96”。如果 CUDALink 错误地假设它有 64 个内核，那么它​​有没有机会利用 GT430？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:05:46.327

我将通过指出我不知道“MSI Afterburner”真正测量的是什么，或者它以什么频率对它测量的数量进行采样，我不相信你也会这样做。这意味着我们不知道屏幕截图中 x 轴或 y 轴的单位是什么。这使得几乎不可能对性能进行任何量化。

1.*为什么峰值最大为 50%？好像很低。*

如果你不知道它真正测量的是什么，我不相信你可以说它“看起来很低”。例如，如果它测量指令吞吐量，则可能是 Mathematica 点内核在您的设备上存在内存带宽限制。这意味着代码的吞吐量瓶颈将是内存带宽，而不是 SM 指令吞吐量。如果要绘制内存吞吐量，您会看到 100%。我希望 gemv 操作受内存带宽限制，所以这个结果可能不会太令人惊讶。

2.*为什么高峰之间会有如此显着的不活动期？*

CUDA API 具有设备和主机端延迟。在 WDDM 平台上（因此 Windows Vit、7、8 以及从它们派生的任何服务器版本），此主机端延迟相当高，并且 CUDA 驱动程序执行批处理操作以帮助分摊该延迟。这种批处理可能导致 GPU 操作中的“间隙”或“暂停”。我想这就是你在这里看到的。NVIDIA 在 Windows 平台上有一个用于 Telsa 卡的专用计算驱动程序 (TCC)，以克服这些限制。

评估此操作性能的更好方法是自己计时循环，计算每次调用的平均时间，计算操作计数（点积有一个已知的下限，您可以从矩阵的维度和向量），并计算 FLOP/s 值。您可以将其与 GPU 的规格进行比较，以了解它的性能好坏。

# asp.net-mvc - 将视图模型从一种方法传递到另一种方法（帖子）

> ID：14676244
> 
> 赞同：0
> 
> 时间：2013-02-03T19:17:42.967
> 
> 标签：asp.net-mvc, viewmodel

我有一个wizardtype表单，我想将模型从第一步一直保存到最后。

这就是我现在的做法，但我似乎无法将模型从第 3 步保留到第 4 步。

```
[HttpPost]
public ActionResult Register(MemberViewModel model)
{
    var mobile = model.Mobile;
    var xml = MemberclubHelper.CreateVerificationTokenXML(mobile, "47");
    MemberclubHelper.SendVerificationToken(xml);
    return RedirectToAction("RegisterStep1", new { mobile = mobile });
}

public ActionResult RegisterStep1(string mobile)
{
    var model = new MemberViewModel();
    model.Mobile = mobile;
    return View("Register/Step1", model);
}

[HttpPost]
public ActionResult RegisterStep1(MemberViewModel model)
{
    var interests = (from interest in model.Interests where interest.isChecked select interest.value).ToList();
    var passing = (from pass in model.Passing where pass.isChecked select pass.value).ToList();

    var xml = MemberclubHelper.CreateMemberProfileXML(model.Mobile, model.FirstName, model.FirstName,
        model.Email1, model.Zipcode, model.SelectedKid1, model.SelectedKid2, model.SelectedKid3,
        model.Gender.ToString(), interests, passing);
    model.XmlToSend = xml;
    if (xml.Contains("error"))
    {
        model.ErrorMessage = xml;
        return View("Register/Step1", model);
    }

    return View("Register/Step2", model);
}

[HttpPost]
public ActionResult RegisterStep2(MemberViewModel model)
{
    var result = MemberclubHelper.SendCreateUser(model.XmlToSend, model.Password);
    if (result.Contains("error"))
    {
        model.ErrorMessage = result;
        return View("Register/Step2", model);
    }

    else
    {
        return View("Register/Finished");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:45:08.617

我认为为每个步骤创建一个单独的视图模型（即 MemberViewModelStep1）可能会更好地为您服务。对我来说，这似乎只有您的一些 MemberViewModel 属性将在每个步骤中设置，除非您通过隐藏输入或其他机制在步骤之间携带大量该状态。

或者，您是否考虑过使用 JavaScript 在您的步骤之间建立该状态，然后使用完全填充的 MemberViewModel 提交单个帖子？

# shell - Echo 命令和带有 tr 命令的新行不起作用

> ID：14676245
> 
> 赞同：1
> 
> 时间：2013-02-03T19:17:49.853
> 
> 标签：shell, tr

我正在运行命令以将`,`文件替换为换行符

```
echo `tr ',' '\n' < file.txt` > file.txt 
```

该命令正在转换

```
a,b,c 
```

至

```
a b c 
```

而不是将其转换为

```
a
b
c 
```

谁能向我解释为什么会发生并解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:08:57.537

首先，运行一个将输入和输出重定向到同一个文件的命令是危险的。正如您所看到的，它可能会起作用，但它可能会在您尝试读取文件时破坏文件的内容，具体取决于事情发生的顺序。

为了避免这个问题，让我们简化命令：

```
$ cat file.txt
a,b,c
$ tr , '\n' < file.txt 
a
b
c 
```

所以`tr`命令本身正在按您的预期工作。现在让我们尝试回显输出：

```
$ echo `tr , '\n' < file.txt`
a b c 
```

shell 执行命令并将其输出用作`echo`-- 但输出被分割成由空格分隔的单词（包括换行符）。

如果您使用 sh、bash 或类似的 shell，则可以通过引用以下参数来避免这种情况：

```
$ echo "`tr , '\n' < file.txt`"
a
b
c 
```

如果你的 shell 支持它（大多数都支持），你可以使用`$(...)`而不是反引号：

```
$ echo "$(tr , '\n' < file.txt)"
a
b
c 
```

我发现它更容易阅读，因为您可以轻松地区分结构的开头和结尾；它也可以嵌套。

最后，至少对于您正在做的事情，使用`echo`. 这是我的做法：

```
tr , '\n' < file.txt > $$ && mv $$ file.txt 
```

这会翻译 的内容`file.txt`，将输出写入临时文件（`$$`是当前 shell 的进程 ID，便于生成临时文件名）。然后它将临时文件重命名为`file.txt`-- 但前提是第一个命令成功。如果出现问题，可以避免破坏您的输入文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:33:53.617

这可能是您正在寻找的。

```
tr ',' '\n' < file.txt > tempFile.txt  
mv tempFile.txt file.txt 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-05T05:54:56.973

```
cat file.txt | tr "," "\n" 
```

然后可以将其重定向到您的文件（通过[Keith 在上面的评论](https://stackoverflow.com/a/14676753/2361131)中提到的中间 tmp 文件）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T19:32:15.540

或许这

```
sed -i 's , \n g' file.txt 
```

# php - 在 CakePHP 中将变量从 beforeDelete 传递到 afterDelete()

> ID：14676247
> 
> 赞同：2
> 
> 时间：2013-02-03T19:18:17.320
> 
> 标签：php, cakephp

我想在删除数据库中的记录后删除文件。因为我使用来自相关模型的一些数据来构建图像路径，所以我需要在 beforeDelete() 中获取这些数据。

```
function beforeDelete() {
    $info = $this->find('first', array(
        'conditions' => array('Media.id' => $this->id),
    ));
}

function afterDelete() {
   unlink(WWW_ROOT . 'img/photos/' . $info['News']['related_id'] . "/" . $info['Media']['file']);       
} 
```

如何正确访问`$info`数组`afterDelete()`？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-03T19:26:25.757

您可以简单地在方法范围之外声明这个 var。

```
private  $info;
function beforeDelete() {
$this->info = $this->find('first', array(
    'conditions' => array('Media.id' => $this->id),
));
}

function afterDelete() {
   unlink(WWW_ROOT . 'img/photos/' . $this->info ['News']['related_id'] . "/" . $this->info ['Media']    ['file']);       
} 
```

# java - 在 If/Switch 语句中使用用户输入的字符

> ID：14676248
> 
> 赞同：1
> 
> 时间：2013-02-03T19:18:16.710
> 
> 标签：java, if-statement, switch-statement

我正在上我的第一个 Java 课程，并且很难完成这项作业。

任务本身非常简单。我所要做的就是提示用户输入一个整数、一个字符，然后是另一个整数。

如果输入的字符是+，两个整数应该相加。如果输入的字符是-，则两个整数相减。ETC...

**问题是我不知道如何从用户那里接受一个字符，然后在我的 If/Switch 语句中使用它。**

这是我的提示：

```
// Prompt the user to enter an integer
    System.out.print("Please enter an integer number:");
    int int1  = input.nextInt();

// Prompt the user to enter a character
// Since I could not use characters, I am using integers to represent them.
    System.out.print("Enter 0 for +, 1 for -, 2 for /, 3 for %, and 4 for *");
    int char1 = input.nextInt();

// Prompt the user to enter another integer
    System.out.print("Please enter another integer number:");
    int int2 = input.nextInt(); 
```

这是我的 If/Switch 语句：（我知道它们是多余的，但它是作业的一部分）

```
if (char1 == 0) {
    int ans = int1 + int2;
    System.out.println(int1 + " + " + int2 + " = " + ans);
} else if (char1 == 1) {
    int ans = int1 - int2;
    System.out.println(int1 + " - " + int2 + " = " + ans);
} else if (char1 == 2) {
    int ans = int1 / int2;
    System.out.println(int1 + " / " + int2 + " = " + ans);
} else if (char1 == 3) {
    int ans = int1 % int2;
    System.out.println(int1 + " % " + int2 + " = " + ans);
} else if (char1 == 4) {
    int ans = int1 * int2;
    System.out.println(int1 + " * " + int2 + " = " + ans);
} else
    System.out.println("Invalid operator");

int result = 0;
switch (char1) {
    case 0: result = int1 + int2;
            System.out.println(int1 + " + " + int2 + " = " + result); break;
    case 1: result = int1 - int2;
            System.out.println(int1 + " - " + int2 + " = " + result); break;
    case 2: result = int1 / int2;
            System.out.println(int1 + " / " + int2 + " = " + result); break;
    case 3: result = int1 % int2;
            System.out.println(int1 + " % " + int2 + " = " + result); break;
    case 4: result = int1 * int2;
            System.out.println(int1 + " * " + int2 + " = " + result); break;
    default: System.out.println("Invalid operator");
} 
```

其他一切都很好。我只是想从使用 0 表示 +、1 表示 - 更改为仅使用 +、-、/、% 和 *。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:28:08.000

您可以将用户的运算符作为**String**或**Char**

像这样 ：

```
 Scanner input = new Scanner(System.in);
        // Prompt the user to enter an integer
        System.out.print("Please enter an integer number:");
        int int1 = input.nextInt();

// Prompt the user to enter a character
// Since I could not use characters, I am using integers to represent them.
        System.out.print("Enter +, -,  /,  %, *");
        char char1 = input.next().charAt(0);

// Prompt the user to enter another integer
        System.out.print("Please enter another integer number:");
        int int2 = input.nextInt();

        if (char1=='+') {
            int ans = int1 + int2;
            System.out.println(int1 + " + " + int2 + " = " + ans);
        } else if (char1=='-') {
            int ans = int1 - int2;
            System.out.println(int1 + " - " + int2 + " = " + ans);
        } else if (char1=='/') {
            int ans = int1 / int2;
            System.out.println(int1 + " / " + int2 + " = " + ans);
        } else if (char1=='%') {
            int ans = int1 % int2;
            System.out.println(int1 + " % " + int2 + " = " + ans);
        } else if (char1=='*') {
            int ans = int1 * int2;
            System.out.println(int1 + " * " + int2 + " = " + ans);
        } else {
            System.out.println("Invalid operator");
        }

        int result = 0;

        switch (char1) {
            case '+':
                result = int1 + int2;
                System.out.println(int1 + " + " + int2 + " = " + result);
                break;
            case '-':
                result = int1 - int2;
                System.out.println(int1 + " - " + int2 + " = " + result);
                break;
            case '/':
                result = int1 / int2;
                System.out.println(int1 + " / " + int2 + " = " + result);
                break;
            case '%':
                result = int1 % int2;
                System.out.println(int1 + " % " + int2 + " = " + result);
                break;
            case '*':
                result = int1 * int2;
                System.out.println(int1 + " * " + int2 + " = " + result);
                break;
            default:
                System.out.println("Invalid operator");
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:20:10.483

你可以这样做：

```
System.out.print("Enter +, -, /, or *");
char char1 = input.nextLine().charAt(0); 
```

`nextLine`将获取用户输入的全部内容，并`charAt`获取指定索引处的字符。

因此，`charAt(0)`获取第一个字符。这是一个直观的解释：顶部是字符串，底部是它的字符编号：

```
|t|h|i|s| |i|s| |a| |t|e|s|t|
-----------------------------
|0|1|2|3|4|5|6|7|8|9|1|1|1|1|
| | | | | | | | | | |0|1|2|3| 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:21:00.057

您可以通过这种方式使用`char`来自用户输入的 a：

A`char`只是一个无符号整数值 0..65535 所以你可以写例如`+`值`43`[Which is the unicode of '+']

```
switch (char1) {
    case '+': result = int1 + int2;
        System.out.println(int1 + " + " + int2 + " = " + result); break;
    case '-': result = int1 - int2;
        System.out.println(int1 + " - " + int2 + " = " + result); break;
    case '/': result = int1 / int2;
        System.out.println(int1 + " / " + int2 + " = " + result); break;
    case '%': result = int1 % int2;
        System.out.println(int1 + " % " + int2 + " = " + result); break;
    case '*': result = int1 * int2;
        System.out.println(int1 + " * " + int2 + " = " + result); break;
    default: System.out.println("Invalid operator");
} 
```

# node.js - Mongoosejs，如何将来自请求正文的字符串数组保存为objectId数组？

> ID：14676253
> 
> 赞同：1
> 
> 时间：2013-02-03T19:18:46.813
> 
> 标签：node.js, angularjs, mongoose, express

我在尝试处理 objectIds 数组时遇到了麻烦（为了进一步填充 mongoosejs 模型），我希望你能帮助我。这是上下文：

我有一个小的 nodejs / angularjs 应用程序，其中有产品和提供者。产品有一个属性 provider，它是 objectId 的数组，引用提供者。这是架构：

```
var productSchema = new Schema({

    name            : { type: String, required: true, trim: true},
    providers       : [{ type: Schema.Types.ObjectId, ref: 'provider' }]
}); 
```

用户可以通过 GUI 查询提供者列表。然后他可以选择每个产品可用的提供商（复选框）。在内部，这意味着我将与 providers _id 对应的十六进制字符串推送到我的角度产品模型的数组提供者中，然后将请求发送到 nodejs/express 服务器。

这是问题所在，我一直在尝试以多种方式将十六进制字符串转换为 objectId，但我找不到正确的方法。我最后一次尝试是使用猫鼬的“presave”功能。这里是当前版本。

```
productSchema.pre('save', function (next) {

    var err = new Error('There was an error when trying to add the providers id as objectId'),
    i = 0;

    for (i = 0; i < this.providers.length; i++) {

        this.providers[i] = mongoose.Types.ObjectId(this.providers[i].toString())
    }

    next(err);
}); 
```

欢迎任何帮助，我认为猫鼬会独自处理所有事情。这样做的正常方法是什么？（预保存只是一个想法）

谢谢阅读

# c++ - 覆盖基类无法正常工作

> ID：14676254
> 
> 赞同：0
> 
> 时间：2013-02-03T19:18:53.437
> 
> 标签：c++, inheritance, polymorphism

我正在尝试在 C++ 中覆盖这样的基类

```
class A:
    QWidget *getWidget();

class B: public A:
    using A::getWidget;
    QWidget *getWidget(); 
```

当我尝试使用它时：

```
A *test = new B();
test->getWidget(); 
```

在这里，来自类 A 的小部件被返回。有没有办法获得小部件 B？由于我不想从检查我的类开始并向下转换为 B 以获得正确的小部件，因此我希望能够像上面的代码片段一样使用它。有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T19:21:06.913

首先，您应该声明`getWidget()`您`virtual`想要函数调用的动态多态解析。这应该可以解决您正在解决的特定问题。

其次，`using A::getWidget`是没用的，因为您正在将`A`的函数`getWidget()`导入 的范围`B`，它已经定义了一个具有相同名称和签名的函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:26:30.390

那是C++代码吗？

```
class A
{
public:
    //you need the virtual keyword here
    virtual QWidget *getWidget();
    virtual ~A();
};

class B : public A
{
public:
    //you need using to overload a method from the base class, it's not needed for override
    QWidget *getWidget();
};

A *test = new B();
test->getWidget();
delete test; 
```

LE：也不要忘记基类中的虚拟析构函数。

# javascript - javascript数组和mysql

> ID：14676255
> 
> 赞同：0
> 
> 时间：2013-02-03T19:18:55.123
> 
> 标签：javascript, sql

```
 var day = new Array();
     $(':checkbox:checked').each(function(i){
     day.push($(this).val());
      });
       alert(day); 
```

返回这个：

![在此处输入图像描述](../Images/1a693534c5d83eb19ffc7a56ec0cf3f4.png)

但我想得到这个：

```
`3`,`10`,`16` 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:22:04.913

```
day.push('`' + $(this).val() + '`'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:20:58.060

它在一个数组中。警报只是以不同的方式显示数组。试着看看它，`console.log()`你会看到

# symfony - 使用 Silex 自定义路由配置

> ID：14676257
> 
> 赞同：5
> 
> 时间：2013-02-03T19:19:00.503
> 
> 标签：symfony, routing, yaml, silex

我知道 Silex 方法的基础是将所有应用程序逻辑放在一个文件中。但是我的应用程序可能有超过 20 个控制器。所以我想要一个方便的地图来管理路由器。

我的问题是寻找能够将路由器制作成单独文件的解决方案。在最好的情况下，文件必须是 YAML 类型：

```
# config/routing.yml

_home:
    pattern: /
    defaults: { _controller: MyProject\Controller\MyController::index } 
```

但是原生也是一个很好的案例（*对我来说*）：

```
$routes = new RouteCollection();

$routes->add(
    'home',
    new Route('/', array('controller' => 'MyProject\Controller\MyController::index')
));

return $routes; 
```

第二种情况的问题是我必须为每个路由规则使用**match()函数。**这一点都不清楚。

有哪些方法可以解决这个问题？条件是我想使用现有的 API Silex 或 Symfony2 的组件。

*小记*：

我没有为我的 Controller 类使用**ControllerProviderInterface**。这是一个独立的类。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-03T20:25:30.420

首先，Silex 的基础不是你把所有东西都放在一个文件里。Silex 的基础是您创建自己的“框架”，即您自己组织应用程序的方式。

> “如果您对自己做出所有架构决策感到满意，请使用 silex，如果不是，请使用全栈 Symfony2。” ——达斯汀·惠特尔

[在这篇](https://igor.io/2012/11/09/scaling-silex.html)由 Silex 的创建者创建的博文中了解更多相关信息。

* * *

### 如何解决您的问题

您基本上想要的是解析一个 Yaml 文件并从每个解析的路由中获取`pattern`和设置。`defaults._controller`

要解析 Yaml 文件，可以使用Symfony2[的 Yaml 组件](http://symfony.com/doc/current/components/yaml/introduction.html)。你得到一个数组，你可以用它来添加到 Silex 的路由：

```
// parse the yaml file
$routes = ...;
$app = new Silex\Application();

foreach ($routes as $route) {
    $app->match($route['pattern'], $route['defaults']['_controller']);
}

// ...
$app->run(); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-08-05T22:01:58.053

我想我会在这里添加我的方法，尽管其他方法可能有效，但实际上并没有一个简单的解决方案。添加`FileLocator`/`YamlFileLoader`添加我不希望在我的应用程序中读取/解析 yaml 文件的大量负载。

**作曲家**

首先，您需要包含相关文件。symfony YAML 组件，以及一个非常简单和有用的[配置服务提供者](https://github.com/igorw/ConfigServiceProvider)，由[积极从事 Silex 工作](https://github.com/igorw)的人提供。

```
"require": {
    "symfony/yaml": "~2.3",
    "igorw/config-service-provider": "1.2.*"
} 
```

**文件**

假设您的路线文件如下所示（`routes.yml`）：

```
config.routes:
  dashboard:
    pattern:  /
    defaults: { _controller: 'IndexController::indexAction' }
    method:   GET 
```

**登记**

单独注册每个 yaml 文件。文件中的第一个键是它将在您的`$app`变量下可用的名称（由 pimple 服务定位器处理）。

```
$this->register(new ConfigServiceProvider(__DIR__."/../config/services.yml"));
$this->register(new ConfigServiceProvider(__DIR__."/../config/routes.yml"));
// any more yaml files you like 
```

**路线**

您可以使用以下方法获取这些路线：

```
$routes = $app['config.routes']; // See the first key in the yaml file for this name
foreach ($routes as $name => $route)
{
    $app->match($route['pattern'], $route['defaults']['_controller'])->bind($name)->method(isset($route['method'])?$route['method']:'GET');    
} 
```

`->bind()`例如，允许您“命名”要在 twig 中使用的 url。
`->method()`允许您指定 POST | 得到。您会注意到，如果路由未指定方法，我将其默认为带有三元组的“GET”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T20:34:48.283

好的，我就是这样解决的。

此方法是我的应用程序的一部分，在**run()**之前调用：

```
# /src/Application.php

...

protected function _initRoutes()
{
    $locator = new FileLocator(__DIR__.'/config');
    $loader = new YamlFileLoader($locator);

    $this['routes'] = $loader->load('routes.yml');
} 
```

应用程序类是我自己的，它扩展了 Silex\Application。

配置文件：

```
# /src/config/routes.yml
home:
    pattern: /
    defaults: { _controller: '\MyDemoSite\Controllers\DefaultController::indexAction' } 
```

这对我来说可以！

**更新**：

我认为这是添加收藏的正确选择：

```
$this['routes']->addCollection($loader->load('routes.yml')); 
```

更灵活。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-08T01:32:50.197

您可以扩展`routes`服务（即 a ），并使用and`RouteCollection`加载 YAML 文件：`FileLocator``YamlFileLoader`

```
use Symfony\Component\Config\FileLocator;
use Symfony\Component\Routing\Loader\YamlFileLoader;

$app->extend('routes', function($routeCollection) {

    $locator    = new FileLocator([__DIR__ . '/../config']);
    $loader     = new YamlFileLoader($locator);
    $collection = $loader->load('routes.yml');

    $routeCollection->addCollection($collection);

    return $routeCollection;

}); 
```

不过，您将需要`symfony/config`和`symfony/yaml`依赖项。

# python - Python按其项的总和对字典进行排序

> ID：14676260
> 
> 赞同：0
> 
> 时间：2013-02-03T19:19:20.113
> 
> 标签：python, sorting, dictionary

我有以下需要排序的数据结构。对于作为一组具有相同高度的物品的每个箱子，我需要获得面积总和和重量总和，并按比例对箱子进行排序。

```
bins = {
  12 : [
    {
      length : 12
      width  : 24
      weight : 50
    },
    {
      length : ...
      width  : ...
      weight : ...
    }
  ]
  52 : ...
  24 : ...
  36 : ...
} 
```

输入的键`bins`是高度，每个 bin 中都有一个项目列表。

我试图想出一些东西，但我没有运气。

```
bins = sorted(bins, key=lambda bin: (
  sum([item['Length']*item['Width'] for item in bins[bin]]) /
  sum([item['Weight'] for item in bins[bin]])
), reverse=True) 
```

问题是这会返回一个列表。无论如何要保留字典对象。我应该将其转换为迭代器吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:18:50.697

`Sorted()`返回一个列表，因为字典无法排序。该结构不存储订单。

另一种解决方案是使用`OrderedDict`. 这是一个字典，它会记住您插入项目的顺序。因此，您不能真正“排序”和 OrderedDict，但您可以将结果或 sorted() 函数存储在新的 OrderedDict 中。

有关更多详细信息，请参阅此问题：

[如何对 OrderedDict 的 OrderedDict 进行排序 - Python](https://stackoverflow.com/questions/8031418/how-to-sort-ordereddict-in-ordereddict-python)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:08:52.200

字典本质上是无序的。你不能对它们进行排序。你可以用谷歌搜索“SortedDict”的实现，它就像字典，但也允许排序。

# ios - IOS 脸书 API。将图像发布到公共页面

> ID：14676262
> 
> 赞同：1
> 
> 时间：2013-02-03T19:19:28.133
> 
> 标签：ios, objective-c, facebook, social-networking

我正在尝试实现下一个功能：授权后，用户点击按钮，应用程序将图像和文本中的帖子同时发送到用户墙和公共页面墙。现在我可以做到这一点，但我不能发布到带有图像的公共页面，只有文本。我从 Facebook API 实现了标准方法，用于在授权后接收权限：

```
- (void) performPublishAction:(void (^)(void)) action {

    if ([FBSession.activeSession.permissions indexOfObject:@"publish_actions"] == NSNotFound ||
        [FBSession.activeSession.permissions indexOfObject:@"manage_pages"] == NSNotFound) {
        // if we don't already have the permission, then we request it now

        [[FBSession activeSession] reauthorizeWithPublishPermissions:[NSArray arrayWithObjects:@"publish_actions",@"share_item",@"publish_stream",@"manage_pages",nil]
                                                     defaultAudience:FBSessionDefaultAudienceFriends
                                                   completionHandler:^(FBSession *session, NSError *error) {
                                                       if (!error) {
                                                           action();
                                                       }
                                                       //For this example, ignore errors (such as if user cancels).
                                                   }];
    } else {
        action();
    }

} 
```

而且我认为我不能这样做的原因是我没有正确的权限将图像发布到公共页面墙上。我对吗？或者也许根本不可能？

谢谢！

# javascript - 函数定义后的括号和分号

> ID：14676263
> 
> 赞同：3
> 
> 时间：2013-02-03T19:19:40.833
> 
> 标签：javascript

最近我在别人的代码中看到了一个函数，如下所示：

```
function xyz(){ //function code here ;
} (); 
```

我不明白`();`函数定义之后的内容。

有人可以告诉我`();`在 JavaScript 中使用它的意义和时间是什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:22:14.603

您显示的代码无法编译。

添加括号后，这将是一个命名的立即调用函数：

```
(function xyz(){ //function code here ;
}) (); 
```

大多数情况下，这些函数是匿名的：

```
(function(){
   var a; // a isn't visible outside
   // code using a
})(); 
```

代码是直接调用的，就像没有函数定义一样，但是这样一个函数的重点是定义一个范围（只能是全局范围或函数），以便范围的变量不会泄漏到封闭的变量中。这种模式对于使您的代码干净非常有用：您不会在外部范围内添加任何变量，也不能删除现有的变量。

这里函数还有一个名字，可以在里面进行递归使用。

```
(function xyz(){
   var a; // a isn't visible outside
   // code using a and calling xyz
})(); 
```

# c++ - GLM - 向量和矩阵是否保证与 GLSL 对应的内存等效？

> ID：14676264
> 
> 赞同：0
> 
> 时间：2013-02-03T19:19:42.803
> 
> 标签：c++, opengl, glm-math

直觉上我会说是的，因为否则这整个“遵循 GLSL 规范”的事情并没有那么大的意义。不过，我没有在任何地方明确提到这一点。在代码中，我问是否

```
glm::someType something{...};
(float*)&something === glm::value_ptr(something) 
```

（当然不是 float* 使用 double 或 half 变体时，但你明白了）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:26:17.567

> “遵循 GLSL 规范”的事情并没有那么大的意义。

GLSL 没有指定内存布局。它仅仅定义了各种类型的词汇结构，比如它们有哪些元素。GLM 遵循相同的词法结构，但它可能遵循最适合它的内存布局。

请注意，GLM 和 GLSL 之间的唯一接口是 glUniform 和 glVertexAttrib[Pointer] 调用，它们的内存布局是众所周知的。只要 GLM 与这些合作，一切都很好。

# python - 如何使用 Python 将文本文件读入列表或数组

> ID：14676265
> 
> 赞同：209
> 
> 时间：2013-02-03T19:19:51.097
> 
> 标签：python, arrays, list, text

我正在尝试将文本文件的行读入 python 中的列表或数组。我只需要能够在创建列表或数组后单独访问它。

文本文件格式如下：

```
0,0,200,0,53,1,0,255,...,0. 
```

在`...`上面的地方，实际的文本文件有成百上千的项目。

我正在使用以下代码尝试将文件读入列表：

```
text_file = open("filename.dat", "r")
lines = text_file.readlines()
print lines
print len(lines)
text_file.close() 
```

我得到的输出是：

```
['0,0,200,0,53,1,0,255,...,0.']
1 
```

显然，它将整个文件读入仅包含一项的列表，而不是单个项目的列表。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：174
> 
> 时间：2013-02-03T19:29:10.763

您必须使用将字符串拆分为值列表`split()`

所以，

```
lines = text_file.read().split(',') 
```

编辑：我没有意识到这会有这么大的吸引力。这是一种更惯用的方法。

```
import csv
with open('filename.csv', 'r') as fd:
    reader = csv.reader(fd)
    for row in reader:
        # do something 
```

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2013-02-04T10:46:55.860

您还可以使用 numpy loadtxt 之类的

```
from numpy import loadtxt
lines = loadtxt("filename.dat", comments="#", delimiter=",", unpack=False) 
```

* * *

## 回答 #3

> 赞同：25
> 
> 时间：2014-11-20T17:47:24.583

所以你想创建一个列表列表......我们需要从一个空列表开始

```
list_of_lists = [] 
```

接下来，我们逐行读取文件内容

```
with open('data') as f:
    for line in f:
        inner_list = [elt.strip() for elt in line.split(',')]
        # in alternative, if you need to use the file content as numbers
        # inner_list = [int(elt.strip()) for elt in line.split(',')]
        list_of_lists.append(inner_list) 
```

一个常见的用例是列数据，但我们的存储单元是文件的行，我们已经一一读取，因此您可能想要*转置* 列表列表。这可以用以下成语来完成

```
by_cols = zip(*list_of_lists) 
```

另一个常见用途是为每一列命名

```
col_names = ('apples sold', 'pears sold', 'apples revenue', 'pears revenue')
by_names = {}
for i, col_name in enumerate(col_names):
    by_names[col_name] = by_cols[i] 
```

以便您可以对同质数据项进行操作

```
 mean_apple_prices = [money/fruits for money, fruits in
                     zip(by_names['apples revenue'], by_names['apples_sold'])] 
```

我写的大部分内容都可以使用`csv`标准库中的模块加速。另一个第三方模块是`pandas`，它可以让您自动化典型数据分析的大部分方面（但有许多依赖项）。

* * *

*更新*虽然在 Python 2 中`zip(*list_of_lists)`返回一个不同的（转置的）列表列表，但在 Python 3 中情况发生了变化，并`zip(*list_of_lists)`返回了一个不可下标的*zip 对象。*

如果您*需要*索引访问，您可以使用

```
by_cols = list(zip(*list_of_lists)) 
```

它为您提供了两个 Python 版本中的列表列表。

另一方面，如果您*不需要*索引访问并且您想要的只是构建一个按列名索引的字典，那么一个 zip 对象就可以了......

```
file = open('some_data.csv')
names = get_names(next(file))
columns = zip(*((x.strip() for x in line.split(',')) for line in file)))
d = {}
for name, column in zip(names, columns): d[name] = column 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2018-03-14T05:36:30.273

**这个问题是询问如何将文件中的逗号分隔值内容读取到可迭代列表中：**

`0,0,200,0,53,1,0,255,...,0.`

**最简单的方法是使用`csv`模块，如下所示：**

```
import csv
with open('filename.dat', newline='') as csvfile:
    spamreader = csv.reader(csvfile, delimiter=',') 
```

**现在，您可以像这样轻松地迭代`spamreader`：**

```
for row in spamreader:
    print(', '.join(row)) 
```

**有关更多示例，请参阅[文档](https://docs.python.org/3.6/library/csv.html)。**

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-24T13:27:06.330

我有点晚了，但您也可以将文本文件读入数据框，然后将相应的列转换为列表。

```
lista=pd.read_csv('path_to_textfile.txt', sep=",", header=None)[0].tolist() 
```

例子。

```
lista=pd.read_csv('data/holdout.txt',sep=',',header=None)[0].tolist() 
```

注意：相应数据框的列名将采用整数形式，我选择 0 因为我只提取第一列

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-10-21T07:39:22.107

这样更好，

```
 def txt_to_lst(file_path):

    try:
        stopword=open(file_path,"r")
        lines = stopword.read().split('\n')
        print(lines)

    except Exception as e:
        print(e) 
```

# drupal - Drupal Ubercart 迁移到 Virtuemart

> ID：14676266
> 
> 赞同：-1
> 
> 时间：2013-02-03T19:19:58.767
> 
> 标签：drupal, joomla, virtuemart, ubercart

我正在尝试将一个功能齐全的基于 Drupal/Ubercart 的网上商店迁移到 VirtueMart 商店。

现在我对 VirtueMart 和 Joomla 非常熟悉，但对 Drupal 不太熟悉。

我的问题是 Drupal/Ubercart 的产品类别在哪里？

因为我看到 ubercart 有一个产品和订单表，但我也在寻找产品类别，我只是找不到它们。

先感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:04:57.197

Drupal 网站有可能使用分类法将其产品分类。如果是这样，您可以在分类表中找到它们。

# javascript - 如何使用 javascript 和 web 获取黑莓 uuid

> ID：14676267
> 
> 赞同：0
> 
> 时间：2013-02-03T19:20:00.147
> 
> 标签：javascript, blackberry, blackberry-webworks

我正在尝试使用带有 Web 的 javascript 来查找设备 UUID，适用于 OS 7 及更低版本的设备。

我正在使用的代码：

```
function getIdentityData(){

            $.ajax({
                type: "get",
                url: "http://localhost:8472/blackberry/identity/get",
                success: function(msg){
                    alert(msg);
                }
            });
        } 
```

正如在他们的文档中发现的那样不起作用，我从来没有收到警报？[https://developer.blackberry.com/html5/apis/blackberry.identity.phone.html](https://developer.blackberry.com/html5/apis/blackberry.identity.phone.html)

我的配置文件中有以下内容

```
<rim:permit>read_device_identifying_information</rim:permit> 
<feature id="blackberry.identity.phone" /> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T18:26:07.223

您是否尝试过此处记录的 blackberry.identity.PIN - [https://developer.blackberry.com/html5/apis/blackberry.identity.html#.PIN](https://developer.blackberry.com/html5/apis/blackberry.identity.html#.PIN)

# c# - 找不到模型

> ID：14676269
> 
> 赞同：8
> 
> 时间：2013-02-03T19:20:25.703
> 
> 标签：c#, asp.net, asp.net-mvc

我已经包含了一个模型并创建了一个视图文件以及一个控制器来指导所有这些

```
public class CreateNewUserModel
{
    [Required]
    [Display(Name = "User name")]
    public string UserName { get; set; }

    [Required(ErrorMessage = "Email required")]
    [EmailAddress(ErrorMessage = "Not a valid email")]
    public string UserEmail { get; set; }

    [Required]
    [StringLength(100, ErrorMessage = "The {0} must be at least {2} characters long.", MinimumLength = 6)]
    [DataType(DataType.Password)]
    [Display(Name = "Password")]
    public string Password { get; set; }

    [DataType(DataType.Password)]
    [Display(Name = "Confirm password")]
    [Compare("Password", ErrorMessage = "The password and confirmation password do not match.")]
    public string ConfirmPassword { get; set; }

    [Required]
    [Display(Name = "Role")]
    public string UserRole { get; set; }
    public IEnumerable<System.Web.Mvc.SelectListItem> UserRoles { get; set; }
} 
```

在视图文件的顶部

我也有`@model CreateNewUserModel`

这是我得到的编译错误

```
Compilation Error 
Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. 

Compiler Error Message: CS0246: The type or namespace name 'CreateNewUserModel' could not be found (are you missing a using directive or an assembly reference?)

 Source Error:   
Line 32:     
Line 33:     
Line 34:     public class _Page_Views_Account_CreateNewUser_cshtml : System.Web.Mvc.WebViewPage<CreateNewUserModel> {
Line 35:         
Line 36: #line hidden 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-03T19:23:46.553

您只需要完全指定模型类型的名称或导入模型的命名空间。

例如

```
@model MyNamespace.CreateNewUserModel 
```

或者

```
@using MyNamespace
@model CreateNewUserModel 
```

显然，将上面示例中的“MyNamespace”替换为您定义模型类的命名空间。

# haskell - Haskell：如何对函数列表求和？

> ID：14676270
> 
> 赞同：0
> 
> 时间：2013-02-03T19:20:44.310
> 
> 标签：haskell

我想在 Haskell 中使用递归。我定义：

```
pf:: Int -> Int
pf 1 = 1
pf n = pf 1 + sum[pf 1..pf n-1] 
```

但总和不正确！总结函数列表的正确方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T19:26:47.757

`[pf 1..pf (n-1)]`不一样`[pf 1, pf 2, pf 3, ..., pf (n-1)]`。

```
> let f x = 2^x
> [f 1 .. f 4]
[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]
> [f 1, f 2, f 3, f 4]
[2,4,8,16] 
```

你可能想要`map`：

```
pf n = pf 1 + sum (map pf [1..n-1]) 
```

而且，正如一句话，`pf x = 2^(x-1)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T01:51:36.490

从接受的答案开始，我们可以做以下细化

```
pf n = pf 1 + sum (map pf [1..n-1]) 
```

我们将 pf 1 与一个总和相加，然后它只是一个总和
通常的总和可以使用 fold 表示如下

```
sum = fold (+) 0 
```

这里 0 可以被视为总和的种子，以说服您在 ghci 中输入以下两个表达式

```
foldl (+) 10 [1..10] -- return 65
10 + sum [1..10]    -- return 65 too 
```

在我们的示例中，种子等于**pf 1**，这导致我们

```
pf n = foldl (+) (pf 1) (map pf [1..n-1]) 
```

再次我们可以重写一个术语，这次我将重点关注列表范围 [1..n-1]

```
enumFromTo 1 (n-1) = [1..n-1] 
```

或者 n-1 可以（再次）重写为 pred n，那么我们有

```
enumFromTo 1 (pred n) = [1..n-1] 
```

代入主表达式，我们得到

```
pf n = foldl (+) (pf 1) (map pf (enumFromTo 1 (pred n))) 
```

现在我们可以用无点风格表达主要表达方式

```
pf = foldl (+) (pf 1) . map pf . enumFromTo 1 . pred 
```

我们可以做更多的考虑，而不是 map 可以用折叠来表达，但肯定我们会失去可读性，请注意

```
map f = foldl (\x xs -> f x : xs) [] 
```

# algorithm - 将无向图转换为带约束的有向图

> ID：14676280
> 
> 赞同：0
> 
> 时间：2013-02-03T19:21:35.573
> 
> 标签：algorithm, graph

给定一个无向图和一个节点，你如何将这个图修改为一个有向图，这样，任何路径都指向一个特定的节点。这个问题在 SE 面试中作为一个流行的算法问题出现

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:25:14.303

这只是创建一个以给定节点为根（并指向）的树，然后将其完成为 DAG，任何搜索算法（例如 BFS 或 DFS）都可以为您提供解决方案：从给定节点开始，使用搜索算法 -每当遇到一个节点时，将其连接到一个已经连接的节点（通常连接到您到达它的那个节点），然后您可以根据遇到节点的顺序设置剩余边的方向（从后者到较早）

# c# - c#中的浅拷贝

> ID：14676285
> 
> 赞同：5
> 
> 时间：2013-02-03T19:21:59.610
> 
> 标签：c#

我明白浅拷贝的定义

浅拷贝是创建一个新对象，然后将当前对象的非静态字段复制到新对象中。如果一个字段是一个值类型 --> 对该字段进行逐位复制；对于引用类型 --> 引用被复制但被引用的对象不是；因此原始对象及其克隆引用同一个对象。

但为什么不复制静态字段？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T19:24:31.263

因为静态字段不是对象的一部分。您可以使用`ClassName.StaticValue`. 实际上，您无法使用`ClassInstanceName.StaticValue`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:24:42.297

静态字段由特定类的所有实例共享。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T19:25:24.517

因为静态成员是`class`级别成员而不是实例级别，这意味着静态成员对于给定类型的所有实例都是通用的。

# c# - 点击表单不点击底层控件

> ID：14676293
> 
> 赞同：0
> 
> 时间：2013-02-03T19:22:30.030
> 
> 标签：c#, winforms

我有一个 Windows 窗体应用程序。当我单击一个窗口时，这会激活表单，然后我需要再次单击以调用特定的控件单击事件。例如，如果我单击一个按钮，这将激活表单，然后我需要再次单击该按钮。

有没有办法一键执行控件单击和窗口激活？最好我希望它适用于任何可点击控件（菜单、按钮、标签等）

到目前为止，我已经设法在鼠标悬停时激活 win 表单，然后控制点击起作用。我希望在单击时激活 win 表单，如果有单击事件，还希望在底层控件上运行单击命令。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:41:51.533

好吧，这是一种完成您想要的方法（只需将类似的方法附加到您的 from`MouseClick`事件）：

```
private void Form1_MouseClick(object sender, MouseEventArgs e)
{
    var c = this.GetChildAtPoint(e.Location);
    this.InvokeOnClick(c, e);
} 
```

这种方法虽然有它的缺点 - 例如，即使它被禁用，控件也会被点击等等，所以你必须确保光标下的控件是你自己“可点击”的......

# java - IntelliJ IDEA 12 - Android GUI 设计器无法成功更改应用主题

> ID：14676294
> 
> 赞同：3
> 
> 时间：2013-02-03T19:22:34.977
> 
> 标签：java, android, user-interface, intellij-idea

IntelliJ 中的 Android GUI 设计器有一个用于选择“框架主题”的下拉菜单。问题是，当我测试我的应用程序时，更改它对模拟器中显示的内容没有影响。无论选择什么，应用程序主题始终是默认的黑色 Holo 主题（我猜是 Theme.Holo。）我希望它是 Theme.Holo.Light - 但实际上我选择哪一个并没有什么区别.

有人对在设计师中进行这项工作有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:53:59.333

主题需要在文件中[手动设置](http://developer.android.com/guide/topics/ui/themes.html#ApplyATheme)`AndroidManifest.xml`，在 GUI 设计器中，此选项仅用于预览应用在不同主题下的外观。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-28T08:27:26.040

“如果您希望将主题应用于应用程序中的一个 Activity，则将 android:theme 属性添加到标签中。”

例如

```
 <activity android:name="MainActivity"
              android:label="@string/app_name"
              android:theme="@android:style/Theme.Holo.Light.NoActionBar.Fullscreen"> 
```

“要为应用程序的所有活动设置主题，请编辑标签以包含带有样式名称的 android:theme 属性”

```
 <application android:theme="@style/CustomTheme"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-16T06:40:18.107

就像 CrazyLoader 说的，你需要在文件中手动更改主题。`AndroidManifest.xml`例如，如果我想将我的应用中所有活动的主题更改为`Holo.Light`，我会这样做：

```
 <application
      android:label="@string/app_name"
      android:icon="@drawable/ic_launcher"
      android:theme="@android:style/Theme.Holo.Light> 
```

如果我希望将主题应用于个人活动，我会这样做：

```
<activity
        android:name="MainActivity"
        android:label="@string/app_name"
        android:theme="@android:style/Theme.Holo.Light"> 
```

注意：如果您的`minSDK`设置低于 API 11，您将收到以下错误：

> @android:style/Theme.Holo.Light 需要 API 级别 11（当前最低为 8）

# templates - 为什么 WiX 在 Visual Studio 2012 Express 中不起作用？

> ID：14676295
> 
> 赞同：3
> 
> 时间：2013-02-03T19:23:05.950
> 
> 标签：templates, visual-studio-2012, wix, windows-installer

> **可能重复：**
> [Visual Studio Express 版本的 Wix 项目模板？](https://stackoverflow.com/questions/13218710/wix-project-template-for-visual-studio-express-versions)

正在寻找与 Visual Studio 2012 Express 集成的免费安装程序创建者。我已经阅读了有关 Windows Installer XML (WiX) 的精彩内容，但它似乎不适用于 Visual Studio 的 Express 版本。有什么变通办法吗？我想知道为什么免费和开源功能不会或不能支持 Express 版本中的项目模板，但可以支持所有其他版本。这是微软让人们升级的内置障碍吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-03T20:09:40.750

Visual Studio Express 不支持第三方的可扩展性。这是 Microsoft 对 Visual Studio 所有免费版本的限制。由于 Wix 是作为一个开源项目进行维护的，因此它不能像 Visual Studio Professional 那样深入地集成到 Visual Studio Express 中，甚至更好。

您仍然可以[从命令行](http://wix.sourceforge.net/manual-wix3/using_custom_actions.htm)或通过[WixEdit](http://wixedit.sourceforge.net/)调用 Wix 。

# eclipse - Web 应用程序中的代码覆盖率 (Wicket)

> ID：14676300
> 
> 赞同：0
> 
> 时间：2013-02-03T19:23:39.187
> 
> 标签：eclipse, web-applications, wicket, code-coverage, cobertura

我在 Eclipse 中使用 Apache Wicket 作为我的 Web 应用程序框架。

目前我已经安装了 eCobertura 作为 Eclipse 插件。但它需要一个 main() 方法才能运行。我一个也没有。

那么如何在 Web 应用程序中运行代码覆盖率呢？

问候...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T15:36:03.910

或者您可以尝试 EclEmma，它在 Eclipse Marketplace 中提供，并且非常易于使用。它为您的项目、包或文件提供了一个右键单击选项：“Coverage -> JUnit test”。

我将它与 Wicket 一起使用，您不需要任何正在运行的服务器或类似的服务器来运行测试。

# indexing - RavenDB：如果我使用 Id 创建索引，我应该指定任何索引选项吗？

> ID：14676301
> 
> 赞同：0
> 
> 时间：2013-02-03T19:23:39.483
> 
> 标签：indexing, ravendb, lucene

来自[RavenDB 的文档](http://ravendb.net/docs/client-api/querying/static-indexes/configuring-index-options)：

> 每个 RavenDB 服务器实例用于促进快速查询的索引由全文搜索引擎**Lucene提供支持。**
> 
> Lucene 获取一个 Document，将其分解为 Fields，然后在称为 Tokenization 的过程中将 Field 中的所有文本拆分为标记（Terms）。这些标记将存储在索引中，稍后将对其进行搜索。
> 
> {...}
> 
> 标记化和分析过程完成后，生成的标记存储在索引中，现在可以使用该索引进行搜索。
> 
> {...}
> 
> 每个字段的默认值是 Stores 中的 FieldStorage.No 和 Indexes 中的 FieldIndexing.Default。
> 
> 设置 FieldIndexing.No 会导致查询时 where 子句中的值不可用（类似于原始投影中不存在）。**FieldIndexing.NotAnalyzed 导致将整个属性视为单个标记，并且匹配必须准确，类似于在此字段上使用 KeywordAnalyzer。例如，后者对于产品 ID 很有用。**FieldIndexing.Analyzed 允许对字段执行全文搜索操作。**FieldIndexing.Default 将字段索引为单个术语，小写。**

* * *

据我了解，要创建 RavenDB 索引，您只需指定属性`Map`，如下所示：

```
public class PlayersIndex : AbstractIndexCreationTask<Player>
{
    public PlayersIndex()
    {
        Map = players => from doc in players
                            select new { doc.PlayerId, doc.TeamId, doc.PositionId };
    }
} 
```

这是我的问题：

如果您假设`PlayerId`是`Guid`，`TeamId`是`int`， 并且`PositionId`是`enum`，我应该：

1.  避免指定任何索引选项？
2.  将每个字段配置为`FieldIndexing.NotAnalyzed`？

换句话说，我是否应该考虑指定如下字段的想法？

```
public class PlayersIndex : AbstractIndexCreationTask<Player>
{
    public PlayersIndex()
    {
        Map = players => from doc in players
                            select new { doc.PlayerId, doc.TeamId, doc.PositionId };

        Indexes.Add(x => x.PlayerId, FieldIndexing.NotAnalyzed);
        Indexes.Add(x => x.TeamId, FieldIndexing.NotAnalyzed);
        Indexes.Add(x => x.PositionId, FieldIndexing.NotAnalyzed);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:54:53.880

Jim，根据您的需要，您不必指定任何索引选项。

# actionscript-3 - 使用 Actionscript 3.0 进行拖动，就像 RTS 游戏中的移动摄像机一样

> ID：14676303
> 
> 赞同：0
> 
> 时间：2013-02-03T19:23:49.907
> 
> 标签：actionscript-3, flash, draggable

我正在尝试使用 Flash 构建 RTS 游戏并进行一些基本测试。我遇到[这个网站](http://www.flashandmath.com/basic/dragdroptour/dd_tour1.html)教我拖动对象。我修改了代码以模拟在单击时移动游戏的游戏世界。中心圆是相机的焦点/中心。矩形板代表游戏世界。

我尝试将函数boardMove更改为根据mouseX和mouseY单击并移动。但是每次点击，mouseX 和 mouseY 就变成了棋盘的中心，这不是我想要的。我想让它**相**对于鼠标位置，但我只能让板闪烁，或者随着它的左上角移动。

任何建议，将不胜感激。

```
// Part 1 -- Setting up the objects

var board:Sprite = new Sprite();
var myPoint:Sprite = new Sprite();
var stageWidth = 550;
var stageHeight = 400;
var boardWidth = 400;
var boardHeight = 300;
var pointWidth = 10;

this.addChild(board);
this.addChild(myPoint);

board.graphics.lineStyle(1,0);
board.graphics.beginFill(0xCCCCCC);
board.graphics.drawRect(0,0,boardWidth,boardHeight);
board.graphics.endFill();
board.x = (stageWidth - boardWidth) / 2;
board.y = (stageHeight - boardHeight) / 2;

myPoint.graphics.lineStyle(1,0);
myPoint.graphics.beginFill(0x0000FF,0.7);
myPoint.graphics.drawCircle(0,0,pointWidth);
myPoint.graphics.endFill();
myPoint.x = (stageWidth - pointWidth) / 2;
myPoint.y = (stageHeight - pointWidth) / 2;

// Part 2 -- Add drag-and-drop functionality - Better Attempt

stage.addEventListener(MouseEvent.MOUSE_DOWN, startMove);

function startMove(evt:MouseEvent):void {
    stage.addEventListener(MouseEvent.MOUSE_MOVE, boardMove);
}

// Revised definition of pointMove in Part II of our script

function boardMove(e:MouseEvent):void {
    board.x = checkEdgeX(board.mouseX);
    board.y = checkEdgeY(board.mouseY);
    e.updateAfterEvent();
}

stage.addEventListener(MouseEvent.MOUSE_UP, stopMove);

function stopMove(e:MouseEvent):void {
    stage.removeEventListener(MouseEvent.MOUSE_MOVE, boardMove);
}

// Part III -- Check for boundaries

function checkEdgeX(inX:Number):Number {
    var x = stageWidth / 2 - boardWidth;
    if (inX < x) {
        return x;
    }

    x = stageWidth / 2;
    if (inX > x) {
        return x;
    }

    return inX;
}

function checkEdgeY(inY:Number):Number {
    var y = stageHeight / 2 - boardHeight;
    if (inY < y) {
        return y;
    }

    y = stageHeight / 2;
    if (inY > y) {
        return y;
    }

    return inY;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T01:39:39.100

一种选择是确定鼠标的相对移动并相应地移动棋盘；就像是：

```
private Point lastPosition;

function startMove(...) {
    lastPosition = null;
    ...
}

function boardMove(e:MouseEvent):void {
    Point position = new Point(stageX, stageY);
    if (lastPosition != null) {
        Point delta = position.subtract(lastPosition);
        board.x += delta.x; // NOTE: also try -= instead of +=
        board.y += delta.y; // NOTE: also try -= instead of +=
        e.updateAfterEvent();
    }
    lastPosition = position;
} 
```

# javascript - IE9 中的 JQuery PostMessage document.location.hash

> ID：14676314
> 
> 赞同：0
> 
> 时间：2013-02-03T19:24:59.167
> 
> 标签：javascript, jquery, internet-explorer-9

我正在使用 jQuery postmessage 插件进行 iframe 通信（用于自动调整父 iframe 的大小）

我有以下代码：

```
 $(function () {
        var parentUrl = decodeURIComponent(document.location.hash.replace(/^#/, ''));

        function setHeight() {
            $.postMessage({ if_height: document.body.scrollHeight }, parentUrl, parent);
        };

        $(document).contents().bind("DOMSubtreeModified", function () { setHeight(); });
    }); 
```

在 IE9 中，document.location.hash 返回一个空字符串，这不会成功地 postMessage。在 IE10、Chrome 和 FF 中，document.location.hash 可以正常工作并返回一个值。

知道这里有什么问题吗？

谢谢。

# r - 如何在 rbga.bin、gena lg 包中设置交叉率？

> ID：14676316
> 
> 赞同：1
> 
> 时间：2013-02-03T19:25:07.087
> 
> 标签：r, algorithm, genetic-algorithm, mutation

我正在使用 R，特别是包 genalg，它允许快速实现遗传算法和搜索相关活动。

我能够运行示例代码，一切正常。感谢作者。

关于如何在 genalg 中设置标准 GA 的参数（突变率和交叉率），我仍然有以下问题。我在包文档中找不到这些问题的答案。

然后考虑函数调用

```
GAcall <- rbga.bin(size= numOfLAttr,
               popSize=10, mutationChance=0.05, zeroToOneRatio=10, 
               iters=3, evalFunc=trading.evaluate, verbose=TRUE, 
               monitorFunc=monitor) 
```

a) 如何在 rbga.bin 中设置交叉率？

a.1) 如果不可能 a) 在 rbga 中实现交叉，如果是这样，应用的概率是多少？

b）mutationChance 参数是否对应于 Goldberg 书中描述的简单 GA 的“突变率”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:44:58.027

CrosseOver 已实现。以详细模式运行`rbga.bin`以获取*应用交叉*的消息...。

生成父概率：

```
parentProb = dnorm(1:popSize, mean = 0, 
          sd = (popSize/3)) 
```

因此，要调整 crosseOver，您可以使用**popSize**参数。

# java - 如何覆盖在方法中获取消息的循环

> ID：14676318
> 
> 赞同：3
> 
> 时间：2013-02-03T19:25:11.810
> 
> 标签：java, arraylist, bluetooth

我有一个蓝牙服务器从客户端，手机接收数据。我正在使用的代码如下所示

```
@Override
public void run() {
    try {
        this.localDevice = LocalDevice.getLocalDevice();
        this.localDevice.setDiscoverable(DiscoveryAgent.GIAC);

        this.server = (StreamConnectionNotifier) Connector.open(URL);

        while(true) {
            if(this.connection == null) {
                this.connection = this.server.acceptAndOpen();

                System.out.println("INFO: Bluetooth client connected");

                BufferedReader reader = new BufferedReader(new InputStreamReader(connection.openInputStream()));
                this.writer = new BufferedWriter(new OutputStreamWriter(connection.openOutputStream()));

                String line;
                while((line = reader.readLine()) != null) {
                    if(line.equals("--#do:disconnect")) {
                        break;
                    }

                    System.out.println("INFO: Received from Bluetooth: " + line);
                }

                System.out.println("INFO: Client disconnected");
            }
        }
    } catch(BluetoothStateException ex) {
        ex.printStackTrace();
    } catch(IOException ex) {
        ex.printStackTrace();
    }
} 
```

如您所见，我有一个不定式循环接收消息，直到它被告知停止。目前循环接收所有消息。这是有问题的。使用代码的类是MVC中的模型类。在课堂上，我还有一个名为`getContacts()`. 它用于通过蓝牙从手机接收联系人。当服务器发送时，电话被告知发送联系人`--#do:getcontacts`。

我需要做的是在方法中获取一个ArrayList中的联系人，`getContacts()`并将其作为方法的返回值返回，以便控制器可以处理联系人。

```
public ArrayList<Contact> getContacts() {
    ArrayList<Contact> contacts = new ArrayList<>();

    // How do I get the contacts in the ArrayList?

    return contacts;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T19:09:53.000

我会给你一些建议。我的示例不是工作代码，只是您的工作基础。

首先，我强烈建议您在服务器中使用线程。每次客户端连接到服务器时，您都会创建一个新线程，其参数包含启动它所需的所有数据：

```
boolean running = true;    //this class variable will allow you to shut down the server correctly

public void stopServer(){    //this method will shut down the server
    this.running = false;
}

public void run() {
    ...

    while(running) {
        // if(this.connection == null) {  // I removed this line since it's unnecessary, or even harmful!
        StreamConnection connection = this.server.acceptAndOpen();  //This line will block until a connection is made...
        System.out.println("INFO: Bluetooth client connected");
        Thread thread = new ServerThread(connection);
        thread.start()              //don't forget exception handling...
    } 
} 
```

在 ServerThread 类中，您实现了处理客户端的这些行（非编译代码，没有异常处理！）：

```
Class ServerThread extends Thread {
    StreamConnection connection;

    public ServerThread(StreamConnection connection){
        this.connection = connection;
    }

    public void run() {
        ...

        connection.close();     //closing the connection...don't forget exception handling!
        System.out.println("INFO: Client disconnected");
    }
} 
```

这段代码有什么好处？您的服务器现在能够同时处理一千个客户端。您已经进行了并行化，这就是服务器通常的工作方式！没有线程的服务器就像没有鞋子的袜子......

其次，如果您有 Java 客户端和 Java 服务器，则可以使用更简单的方法将对象发送到服务器：ObjectOutputStream/ObjectInputStream。您只需将包含联系人的数组（我将像往常一样使用 ArraList）发送到服务器，然后读取该数组。这是服务器的代码（同样未编译且没有任何异常处理）：

```
Class ServerThread extends Thread {
    StreamConnection connection;

    public ServerThread(StreamConnection connection){
        this.connection = connection;
    }

    public void run() {

        BufferedInputStream bis = new BufferedInputStream(this.connection.openInputStream());
        ObjectInputStream ois = new ObjectInputStream(bis);

        ArrayList contacts = (ArrayList) ois.readObject();  //this is a cast: don't forget exception handling!
        //You could also try the method ois.readUTF(); especially if you wanna use other non-Java clients

        System.out.println("INFO: Received from Bluetooth: " + contacts);
        this.connection.close();    //closing the connection...don't forget exception handling!
        //ois.close();      //do this instead of "this.connection.close()" if you want the connection to be open...i.e. to receive more data

        System.out.println("INFO: Client disconnected");

        //here you do whatever you wanna do with the contacts array, maybe add to your other contacts?
    }
} 
```

在 Java 中，每个类都是一个对象，包括 ArrayList。并且由于对象的结束将被视为断开连接，因此您无需执行任何其他操作。

第三：您使用上述服务器不仅用于蓝牙连接，还用于 WLAN 连接，aso。然后您可以轻松地启动不同的线程，例如在伪代码`if(connection.isBluetooth()){//create a thread from BluetoothThread} else if(connection.isWLAN()){//create a thread from WLANsThread}`中。我不知道您的应用程序是关于什么的，但也许有一天您想将其扩展到台式机，因此使用 WLAN 将是正确的选择。还因为您无论如何都需要在客户端中构建验证（“哪些联系人将被发送到哪个服务器？”），无论是蓝牙还是WLAN，因为蓝牙的低范围不能给你任何安全性. ;)

第四，最后关于您的问题：要获得某些东西，您需要有一个数据源和/或一个类变量。这是一个简短的示例，其中包含一个存储联系人的文件（但它也可以是数据库......本地或其他地方！）：

```
public class MyApp(){
    ArrayList contacts;
    ...

    public void run(){                  //this happens when we start our app
        this.contacts = new ArrayList();
        FileReader fr = new FileReader ("C:\WhereverYourFileIs\Contacts.file");
        BufferedReader br = new BufferedReader(fr);
        //here you use a loop to read the contacts via "br" from the file and fill them into your array...I can't provide you more code, since the exact data structure is up to you.
    }

    //now we want to send our contacts array to the already connected server:
    public sendArrayToServer() {
        BufferedOutputStream bos = new BufferedOutputStream (this.connection.openOutputStream());
        ObjectOutputStream oos = new ObjectOutputStream(bos);
        oos.writeObject(this.contacts);
         //If you use readUTF() in the server, you need to call here something like oos.writeUTF(this.contacts.toString()); or even need to use another parser method which exactly creates the string you want.
        this.connection.close();    //closing the connection...don't forget exception handling!
        //oos.close();      //do this instead of "this.connection.close()" if you want the connection to stay open...
    }
} 
```

现在在服务器中，您只需读出上面已经描述的联系人数组。您如何处理这些联系人仍取决于您。

希望这可以帮助您了解您的问题并找到解决方案。编程就是反复试验……和改进你的代码。

**编辑：**

经过我们的讨论，我终于找到了你需要的东西：你需要一个名为 BluetoothManager 的单线程服务器，它与另一个名为 GUIController 的线程交互。现在，既然我无论如何都在脑海中完成了实现，我可以为您发布它，并附上一些解释。请注意，在这种情况下，您不需要在服务器中初始化另一个线程，因为 BluetoothManager 已经是一个线程，而且您同时只需要一个连接（问题仍然存在，如果那是一个“服务器” ，我宁愿称它为“接收器”）：

```
Public class BluetoothManager extends Thread{
    boolean running = true;    //this class variable will allow you to shut down the server correctly
    GUIController controller;

    public BluetoothManager(GUIController controller){
        this.controller = controller;  //this registers the GUIController in the BluetoothManager
    }

    public void stop(){    //this method will shut down the "server"
        this.running = false;
    }

    public void run() {
        this.localDevice = LocalDevice.getLocalDevice();
        this.localDevice.setDiscoverable(DiscoveryAgent.GIAC);
        this.server = (StreamConnectionNotifier) Connector.open(URL);
        while(running){
            StreamConnection connection = this.server.acceptAndOpen();  //This line will block until a connection is made...or running==false!
            System.out.println("INFO: Bluetooth client connected");
            BufferedInputStream bis = new BufferedInputStream(this.connection.openInputStream());
            ObjectInputStream ois = new ObjectInputStream(bis);
            ArrayList contacts = (ArrayList) ois.readObject();  //this is a cast: don't forget exception handling!
            System.out.println("INFO: Received from Bluetooth: " + contacts);
            this.connection.close();    //closing the connection...don't forget exception handling!
            System.out.println("INFO: Client disconnected");
            this.controller.refreshContacts(contacts);
        }
    } 
}

public class GUIController extends Thread implements Runnable {
    ArrayList contacts;   //also a HashMap may be appropriate
    BluetoothManager manager;

    public void run(){
        this.contacts = new ArrayList();
        FileReader fr = new FileReader ("C:\WhereverYourFileIs\Contacts.file");
        BufferedReader br = new BufferedReader(fr);
        //here you use a loop to read the contacts via "br" from the file and fill them into your array...I can't provide you more code, since the exact data structure is up to you.
    }

    public void startBluetoothManager(){    //starting the BluetoothManager
        this.manager = new BluetoothManager(this);
        this.manager.start();
    }

    public void abortBluetoothManager(){  //call this when clicking on the "Abort" button
        this.manager.stop();
        //now the next 2 lines you normally don't need...still may use it if you've problems shutting down the thread:
        // try{ this.manager.interrupt(); }   //we want to be 100% sure to shut down our thread!
        // catch(Exception e){}
        this.manager = null; //now the garbage collector can clean everything...byebye
    }

    public void refreshContacts(ArrayList contacts) {
        // synchronize(this.contactArray){  //no synchronisation needed if you have a GUI pop-up with an "Abort"-button!
        Iterator i = this.contacts.iterator();
        while(i.hasNext()){
            this.contacts.add(i.next());
        }
        //At the end you need remove the "Receiving message" pop-up together with the "Abort Receiving"-button, these are all class variables!
        // important note: If you have unique entries, you may need to replace them! In this case I suggest storing all contact objects better in a HashMap contacts, and use the unique ID as a key to find the element. And then you may prompt the user, if there are identical entries, to overwrite each entry or not. These things remain all up to you.
    }
}
//As always: This is no compiled code!! 
```

GUIController 首先运行 BluetoothManager `startBluetoothManager()`，除了显示通知“接收联系人”和“中止 Reveiving”按钮外，什么都不做。当 BluetoothManager 完成后，他只需通过调用将新联系人添加到 GUIController 内的现有联系人数组中`refreshContacts(...)`。如果您按下“Abort Reveiving”按钮，您会立即调用该`abortBluetoothManager()`方法，该方法设置`running=false`在 BluetoothManager 中以结束服务器并完成线程。

该解决方案解决的主要问题：两个线程无法直接相互通信！一旦你调用`thread.start()`，每个线程都是独立的。这就是为什么 BluetoothManager 线程不可能告诉 GUIController 线程“我已经完成了！”。这些线程唯一能做的就是共享相同的资源，并通过这些资源进行通信。在我们的例子中，它是`contacts`GUIController 中的 -ArrayList，首先我认为它需要同步并且可以由两个线程更新（但不能同时更新）。而且 - 有点有趣 - 还有第二个共享资源，它实际上是`running`BluetoothManager 类中的标志，可以将其关闭（但从来不需要任何同步`running`，

现在关于同步：我更多地考虑了这个问题并理解了，您也可以在*没有*任何“同步（...）”调用的情况下解决您的问题。因此，如果您不想同步 ArrayList，则必须这样做：在服务器运行时，您只显示“接收联系人”弹出窗口和“中止接收”按钮。发生这种情况时，您永远不会访问 GUIController 内的contact-ArrayList。这在某种程度上是一种“内在同步”，不需要真正的 Java 同步。您仍然可以实现同步，只是为了 100% 确保将来扩展应用程序时不会发生任何事情。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-09T02:04:23.457

首先，您的代码中很少有需要审查/修复的东西

1-`ArrayList<Contact> contacts`应该在您的类中定义，因此线程可以访问它并将其填充为方法**中**的局部变量`getContacts()`

```
public ArrayList<Contact> getContacts() {

    //ArrayList<Contact> contacts = new ArrayList<>();    

    return contacts;
} 
```

2-您应该避免在 run 方法中使用*无限*循环，以便能够在需要时停止线程。

```
//while(true)
while(isRunning) { // a flag that is set to true by default

} 
```

3-在断开连接后检查连接是否相等*而不*将其设置为 null 意味着**仅从**第一个客户端接受连接（假设连接最初设置为 null），然后您将只有一个无限循环，但代码`this.connection = this.server.acceptAndOpen();`不会不再触手可及

```
if(this.connection == null) {               
  while((line = reader.readLine()) != null) {
     if(line.equals("--#do:disconnect")) {
           // You have to set it to null if you want to continue listening after disconnecting
           this.connection = null
           break;
      }
   }
 } 
```

或者干脆**把这个检查去掉**，我看没用。

现在回到你的问题：

您可以将您的联系人列表定义为类成员，以便通过`run()`和`getContacts()`方法访问。如果需要，您可以将其设为最终版本。然后在方法中填充这个列表`run()`；就这样。

例如

```
 class MyServerThread implements Runnable {
    private boolean isRunning = true;
    ArrayList<Contact> contacts = new ArrayList<>();

    public ArrayList<Contact> getContacts(){
        // Make sure that your not currently updating the contacts when this method is called
        // you can define a boolean flag and/or use synchronization
        return contacts;
    }

    public void run() {

     ...

    while(isRunning ) {
            this.connection = this.server.acceptAndOpen();

            System.out.println("INFO: Bluetooth client connected");

            BufferedReader reader = new BufferedReader(new InputStreamReader(connection.openInputStream()));
            this.writer = new BufferedWriter(new OutputStreamWriter(connection.openOutputStream()));

            // You need to remove previously received contacts before issuing a new --#do:getcontacts command                
            contacts.clear();

            String line;
            while((line = reader.readLine()) != null) {
                if(line.equals("--#do:disconnect")) {
                    break;
                }

                // Here you can parse the contact information
                String contactName = ...
                String contactPhone = ...
                contacts.add(new Contact(contactName,contactPhone));
            }

            System.out.println("INFO: Client disconnected");            
    }
} catch(BluetoothStateException ex) {
    ex.printStackTrace();
} catch(IOException ex) {
    ex.printStackTrace();
}
  }

 } 
```

您不必使用对象序列化，您可以构建一个简单的协议将联系人从手机发送到 PC，类似于您发送的命令，例如`--#C:name$phone`

# c# - 在 NHibernate IUserType 上实现不同的 SELECT 和 INSERT 行为

> ID：14676320
> 
> 赞同：0
> 
> 时间：2013-02-03T19:25:20.250
> 
> 标签：c#, nhibernate, nhibernate-mapping

有没有办法将 Create (INSERT) 行为与 SELECT 行为分开。

假设我有一个数据库，其中有一列将返回一个如下所示的字符串

```
Predecessors = "1,3,4,5" 
```

在我的应用程序中，我想通过实现 IUserType 来像 int 数组一样使用这个字符串

```
public interface IIntArray
{
    int[] Items { get; set; }
}

public class IntArray : IIntArray
{
    public int[] Items { get; set; }

    public IntArray(string item)
    {
        if(string.IsNullOrEmpty(item))
            return;

        Items = System.Array.ConvertAll<string, int>(item.Split(new[] {','}), int.Parse);

        // for older .net versions use the code below
        // Items = Array.ConvertAll<string, int>(item.ToString().Split(new[] { ',' }), delegate(string str) { return int.Parse(str); });
    }
}

public class IntArrayType : IUserType
{
    #region Implementation of IUserType

    /// <summary>
    /// Compare two instances of the class mapped by this type for persistent "equality"
    /// ie. equality of persistent state
    /// </summary>
    /// <param name="x"></param>
    /// <param name="y"></param>
    /// <returns></returns>
    public new bool Equals(object x, object y)
    {
        if (x == null && y == null) return true;
        if (x == null || y == null) return false;
        return x.GetType() == y.GetType();
    }

    /// <summary>
    /// Get a hashcode for the instance, consistent with persistence "equality"
    /// </summary>
    public int GetHashCode(object x)
    {
        return x.GetHashCode();
    }

    /// <summary>
    /// Retrieve an instance of the mapped class from a resultset.
    /// Implementors should handle possibility of null values.
    /// </summary>
    /// <param name="rs">a IDataReader</param>
    /// <param name="names">column names</param>
    /// <param name="owner">the containing entity</param>
    /// <returns></returns>
    /// <exception cref="HibernateException">HibernateException</exception>
    public object NullSafeGet(IDataReader rs, string[] names, object owner)
    {
        var value = NHibernateUtil.String.NullSafeGet(rs, names[0]);

        if (value == null || (string.IsNullOrEmpty(value.ToString())))
        {
            return null;
        }

        return new IntArray(value.ToString());
    }

    /// <summary>
    /// Write an instance of the mapped class to a prepared statement.
    /// Implementors should handle possibility of null values.
    /// A multi-column type should be written to parameters starting from index.
    /// </summary>
    /// <param name="cmd">a IDbCommand</param>
    /// <param name="value">the object to write</param>
    /// <param name="index">command parameter index</param>
    /// <exception cref="HibernateException">HibernateException</exception>
    public void NullSafeSet(IDbCommand cmd, object value, int index)
    {
        if (value == null)
        {
            ((IDataParameter)cmd.Parameters[index]).Value = DBNull.Value;
        }
        else
        {
            var state = (IIntArray)value;
            ((IDataParameter)cmd.Parameters[index]).Value = state.GetType().Name;
        }
    }

    /// <summary>
    /// Return a deep copy of the persistent state, stopping at entities and at collections.
    /// </summary>
    /// <param name="value">generally a collection element or entity field</param>
    /// <returns>a copy</returns>
    public object DeepCopy(object value)
    {
        return value;
    }

    /// <summary>
    /// During merge, replace the existing (<paramref name="target" />) value in the entity
    /// we are merging to with a new (<paramref name="original" />) value from the detached
    /// entity we are merging. For immutable objects, or null values, it is safe to simply
    /// return the first parameter. For mutable objects, it is safe to return a copy of the
    /// first parameter. For objects with component values, it might make sense to
    /// recursively replace component values.
    /// </summary>
    /// <param name="original">the value from the detached entity being merged</param>
    /// <param name="target">the value in the managed entity</param>
    /// <param name="owner">the managed entity</param>
    /// <returns>the value to be merged</returns>
    public object Replace(object original, object target, object owner)
    {
        return original;
    }

    /// <summary>
    /// Reconstruct an object from the cacheable representation. At the very least this
    /// method should perform a deep copy if the type is mutable. (optional operation)
    /// </summary>
    /// <param name="cached">the object to be cached</param>
    /// <param name="owner">the owner of the cached object</param>
    /// <returns>a reconstructed object from the cachable representation</returns>
    public object Assemble(object cached, object owner)
    {
        return cached;
    }

    /// <summary>
    /// Transform the object into its cacheable representation. At the very least this
    /// method should perform a deep copy if the type is mutable. That may not be enough
    /// for some implementations, however; for example, associations must be cached as
    /// identifier values. (optional operation)
    /// </summary>
    /// <param name="value">the object to be cached</param>
    /// <returns>a cacheable representation of the object</returns>
    public object Disassemble(object value)
    {
        return value;
    }

    /// <summary>
    /// The SQL types for the columns mapped by this type. 
    /// </summary>
    public SqlType[] SqlTypes { get { return new[] { NHibernateUtil.String.SqlType }; } }

    /// <summary>
    /// The type returned by <c>NullSafeGet()</c>
    /// </summary>
    public Type ReturnedType { get { return typeof(IntArray); } }

    /// <summary>
    /// Are objects of this type mutable?
    /// </summary>
    public bool IsMutable { get { return false; } }

    #endregion
} 
```

在我的 NHibernate 类中，我映射到这样的属性

```
public virtual IntArray Predecessors { get; set; } 
```

和 hbm 映射

```
<property name="Predecessors" type="Example.IntArrayType, Example" /> 
```

IntArray 类在读取数据时可以完成工作，但是在尝试放回某些东西时，这不起作用。我想做的是以某种方式强制 IntArray 属性将 IntArray.Items 的值呈现为逗号分隔的字符串

```
string magic = string.Join(",", Predecessors.Items); 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T06:14:53.753

像这样的东西应该可以解决问题

```
public void NullSafeSet(IDbCommand cmd, object value, int index)
{
    var ints = value as IntArray;
    if(ints != null && ints.Items != null)
    {
      NHibernate.NHibernateUtil.StringClob.NullSafeSet(cmd, string.Join(", ", ints.Items), index);
    }
} 
```

# php - 如何防止一个脚本读取其他脚本

> ID：14676323
> 
> 赞同：0
> 
> 时间：2013-02-03T19:25:48.237
> 
> 标签：php

好的，所以我为我的 php 站点提供了 linux 托管。

我已经用谷歌搜索了一段时间，但我无法找到答案。

我将如何制作一个可以插入一些 PHP 代码的脚本，但该脚本无法读取或写入其他文件，尤其是更高级别的文件？

我知道允许将可执行代码输入文件是危险的，但我想知道有人知道防止它到达文件外部的最佳方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:29:07.137

> 我将如何制作一个可以插入一些 PHP 代码的脚本，但该脚本无法读取或写入其他文件，尤其是更高级别的文件？

在共享虚拟主机上 - 无法访问根级别 - 这将是不可能的。

默认情况下，PHP 脚本将在特定用户帐户下运行。该用户帐户（通常是网络服务器的）*必须*有权访问所有 PHP 文件。没有任何权限设置的组合可以改变这一基本事实。

# html - “浮动”块级元素

> ID：14676324
> 
> 赞同：-1
> 
> 时间：2013-02-03T19:25:51.903
> 
> 标签：html, css, css-float

我在工作中的网站上工作，与我一起工作的程序员提到你不能浮动块级元素。他说我需要找到一种方法来实质上浮动块级元素，而无需实际使用 float 属性。例如，侧导航栏右侧的“浮动”文本。

在网页设计方面，我仍然被认为是新手，因此我们将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:01:05.080

要回答*如何在不实际使用“Float”属性的情况下浮动块级元素*的问题，您可以在 CSS 中使用绝对定位：

```
#myBlockId {
    position: absolute;
    left: 100;
    top: 100;
    z-index: 2;
} 
```

以上将在其他内容上方浮动一个块`<div id="byBlockId">...</div>`（通过 tha `z-index`）并将其准确定位在 (100, 100)。

关于开发人员告诉您的内容，我认为您*只能*浮动块级元素。您最好的选择可能是要求开发人员澄清他的意思。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:42:53.797

浮动的元素被转换/成为块级元素（除非在 CSS 中定义为内联）。

因此，与您一起工作的程序员说块级元素不能浮动的事实告诉了小猪。

但是，如果您的程序员（在他自己的头脑中）将块级元素定义为必须保持其包含元素的 100% 宽度的元素并且无法更改，那么事情将开始变得棘手。

如果没有视觉示例，就不可能提供进一步的帮助。

尝试阅读来自粉碎杂志的这篇粉碎文章：http: [//coding.smashingmagazine.com/2007/05/01/css-float-theory-things-you-should-know/](http://coding.smashingmagazine.com/2007/05/01/css-float-theory-things-you-should-know/)

# ios - 从 iOS 发送 C++ 协议缓冲区消息

> ID：14676334
> 
> 赞同：1
> 
> 时间：2013-02-03T19:26:58.407
> 
> 标签：ios, sockets, protocol-buffers, akka, nsstream

在[之前的 Stack Overflow 问题](https://stackoverflow.com/questions/14657435/protocol-buffer-messages-via-akka-io-and-sockets)中，人们在构建我的 Akka 套接字服务器时向我展示了我的方式的错误非常有帮助，实际上我现在有一个 Akka 套接字客户端，它可以使用以下框架发送消息：

消息长度：4 字节消息类型：4 字节消息负载：（长度）字节

这是我用来发送消息的 iOS 代码：

```
 NSInputStream *inputStream;
    NSOutputStream *outputStream;

    CFReadStreamRef readStream;
    CFWriteStreamRef writeStream;
    CFStreamCreatePairWithSocketToHost(NULL, (CFStringRef)@"localhost", 9999, &readStream, &writeStream);
    inputStream = (__bridge_transfer NSInputStream *)readStream;
    outputStream = (__bridge_transfer NSOutputStream *)writeStream;

    [inputStream setDelegate:self];
    [outputStream setDelegate:self];

    [inputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];
    [outputStream scheduleInRunLoop:[NSRunLoop currentRunLoop] forMode:NSDefaultRunLoopMode];

   // [inputStream open];
    [outputStream open];
    NSLog(@"NSData raw zombie is %d bytes.", [rawZombie length]);
    uint32_t length = (uint32_t)htonl([rawZombie length]);
    uint32_t messageType = (uint32_t)htonl(1);        

    NSLog(@"Protobuf byte size %d", zombieSighting->ByteSize());

    [outputStream write:(uint8_t *)&length maxLength:4];
    [outputStream write:(uint8_t *)&messageType maxLength:4];
    [outputStream write:(uint8_t *)[rawZombie bytes] maxLength:length];

    [outputStream close]; 
```

'rawZombie' 变量（NSData *）来自以下方法：

```
- (NSData *)getDataForZombie:(kotancode::ZombieSighting *)zombie {
    std::string ps = zombie->SerializeAsString();
    NSLog(@"raw zombie string:\n[%s]", ps.c_str());
    return [NSData dataWithBytes:ps.c_str() length:ps.size()];
} 
```

我看到的症状是我收到了由 iOS 发送的消息，它的长度是正确的，消息类型 (1) 也是正确的，并且正文很好。使用 Scala protobufs 的 Akka 服务器对消息进行反序列化，并完美地打印出消息上的所有值。问题是，在我收到该消息后，Akka 服务器立即认为它收到了另一条消息（显然，更多数据进入了流中）。每次运行 iOS 应用程序时，最后的数据都不相同。

例如，以下是来自两个连续消息接收的一些跟踪输出：

```
received message of length 45 and type 1
name:Kevin
lat: 41.007
long: 21.007
desc:This is a zombie
zombie type:FAST
received message of length 7 and type 4
received message of length 45 and type 1
name:Kevin
lat: 41.007
long: 21.007
desc:This is a zombie
zombie type:FAST
received message of length 164 and type 1544487554 
```

所以你可以看到，在 Akka 服务器收到正确的消息数据之后，它也收到了一些随机的任意废话。鉴于我的 Akka 客户端可以正常工作而没有这种额外的任意废话，我假设我将 protobuf 对象写入 NSStream 的方式有问题...任何人都可以发现我的愚蠢错误，因为我确信那是什么正在这里发生。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:25:46.963

该死的地狱。我不敢相信我没有看到这个。在这里的代码行中：

```
[outputStream write:(uint8_t *)[rawZombie bytes] maxLength:length] 
```

我使用值“长度”作为要传输的最大字节数。不幸的是，该值已经翻转了它的“endian”顺序，以准备通过网络传输。我用 [rawZombie length] 替换了“长度”，它就像一个魅力。

:(

# c# - 在验证 MVC ModelState 时从控制器突出显示 HTML 表单中的字段

> ID：14676338
> 
> 赞同：1
> 
> 时间：2013-02-03T19:27:43.023
> 
> 标签：c#, asp.net-mvc

我有一个 HTML 表单，其中包含两个下拉列表，分别代表信用卡到期月份和年份。在我的控制器中，我正在检查选择的月份/年份是否在未来。如果没有，我会在 ModelState 中添加一个错误以返回给用户。

我唯一没有想到的是如何让下拉列表以红色突出显示，就像文本框在不满足所需字段要求或使用 DataAnnotations 实施的其他检查时所做的那样。

有什么提示吗？使用 C# 和 .NET 4.5。

# c++ - 使用 C++ 驱动程序的 MongoDB 插入性能低

> ID：14676339
> 
> 赞同：2
> 
> 时间：2013-02-03T19:27:47.390
> 
> 标签：c++, mongodb, bulkinsert

这是我过去两天优化和分析的一段代码，因为它花费了太多时间：

```
{
    mongo::ScopedDbConnection _dbConnection (DbHost);
    _dbConnection->insert(TokensDB, tokensArray );
    _dbConnection.done();
}

{
    mongo::ScopedDbConnection _dbConnection (DbHost);   
    _dbConnection->insert(IdxDB, postingsArray);
    _dbConnection.done();
} 
```

这`postingsArray`是`std::vector<BSON (int64_t, int64_t, int64_t, int)>`20 000 个元素。这个插入总是只需要几毫秒。`tokensArray`是`std::vector<BSON (int64_t, std::string)>`, 5000 个元素。这是奇怪的插入。

如果我完全按照上面的代码片段进行操作，则需要 45-50 毫秒。但是，如果我像最初那样切换两个块（插入`IdxDB`第一个和`TokensDB`第二个），则需要 400-500 毫秒。这里发生了什么？为什么顺序很重要？为什么插入 5000 个 2-field 记录比插入 20k 4-field 对象花费更长的时间？

我最初的想法是因为`std::string`字段（它包含单个英文单词，所以平均大约 5-7 个符号）。我已将其替换为随机`int64_t`数 - 插入完成时间没有明显变化。

所有的分析都是在一个干净的数据库上完成的，并且每次都使用完全相同的数据，我不相信这是我组织测量的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T13:28:54.587

MongoDB在后台执行了很多事情，所以插入大数据`postingsArray`的时间很短，但会影响之后的性能，这是正常的。当您`postingsArray`单独测量插入时，您仅测量 MongoDB 驱动程序接受插入所需的时间。但是，当您测量后续操作时，您开始注意到`postingsArray`插入启动的后台工作负载。
见第 6 点：[http ://article.gmane.org/gmane.comp.db.mongodb.user/818](http://article.gmane.org/gmane.comp.db.mongodb.user/818)

顺便说一句，您的示例编写方式我怀疑 MongoDB 为您提供了相同的插入连接。（例如，您可能正在从池中获取一个连接，插入`postingsArray`它，释放它，然后再次从池中获取相同的连接并插入`tokensArray`它）。在这种情况下，TCP/IP 套接字可能仍在忙于`postingsArray`插入，而您所看到的可能正在达到 TCP/IP 缓冲区的限制。

PS您可能想要更改写入问题以测量 MongoDB 执行插入所需的实际时间：http: [//article.gmane.org/gmane.comp.db.mongodb.user/68288](http://article.gmane.org/gmane.comp.db.mongodb.user/68288)

# php - 带有桥接表的 PHP ActiveRecord

> ID：14676340
> 
> 赞同：0
> 
> 时间：2013-02-03T19:27:50.120
> 
> 标签：php, phpactiverecord

我正在尝试建立我的“ `homes`”表和“ `furniture`”表之间的关联。

基本上，一个家可以有多个家具，所以我有一个 home_furniture_bridge 表，如下所示：

```
home_id | furniture_id 
```

显然，home_furniture_bridge 与 home 的关系是无关紧要的，重要的是 home 和家具之间的关系。在 PHP ActiveRecord 中如何描述这种关联？

编辑：目前我有一个 home.php 模型和一个家具.php 模型。我不需要 home_furniture_bridge 模型吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T10:38:47.187

为了使用这种多对多关联，您需要定义第 3 个模型并使用`has_many` `through`其中一个模型中的语法：

```
class Home extends ActiveRecord\Model {
    static $has_many = array(
            array('home_furniture_bridge', 'class_name' => 'HomeFurnitureBridge'),
            array('furniture', 'class_name' => 'Furniture', 'through' => 'home_furniture_bridge')
    );
}

class HomeFurnitureBridge extends ActiveRecord\Model {
    static $belongs_to = array(
            array('home'),
            array('furniture', 'class_name' => 'Furniture')
    );
}

class Furniture extends ActiveRecord\Model {
    static $has_many = array(
            array('homes')
    );
} 
```

请注意，您必须为`home_furniture_bridge`and使用类名`furniture`，因为 php AR 使用表和类名的复数/单数约定。

# sql - MS SQL 使用联结表创建多对多关系

> ID：14676342
> 
> 赞同：36
> 
> 时间：2013-02-03T19:28:06.810
> 
> 标签：sql, sql-server, many-to-many, junction-table

我正在使用 Microsoft SQL Server Management Studio，在创建联结表时，我应该为联结表创建一个 ID 列，如果是这样，我是否也应该将其设为主键和标识列？还是只为我要加入多对多关系的表保留 2 列？

例如，如果这将是多对多表：

```
MOVIE
Movie_ID
Name
etc...

CATEGORY
Category_ID
Name
etc... 
```

我应该制作联结表：

```
MOVIE_CATEGORY_JUNCTION
Movie_ID
Category_ID
Movie_Category_Junction_ID 
```

[并制作`Movie_Category_Junction_ID`我的主键并将其用作身份列]？

或者：

```
MOVIE_CATEGORY_JUNCTION
Movie_ID
Category_ID 
```

[然后把它留在没有主键或身份表的地方]？

* * *

## 回答 #1

> 赞同：68
> 
> 时间：2013-02-03T19:32:42.703

我会使用第二个联结表：

```
MOVIE_CATEGORY_JUNCTION
Movie_ID
Category_ID 
```

主键将是两列的组合。您还将有一个从每一列到`Movie`and`Category`表的外键。

联结表看起来与此类似：

```
create table movie_category_junction
(
  movie_id int,
  category_id int,
  CONSTRAINT movie_cat_pk PRIMARY KEY (movie_id, category_id),
  CONSTRAINT FK_movie 
      FOREIGN KEY (movie_id) REFERENCES movie (movie_id),
  CONSTRAINT FK_category 
      FOREIGN KEY (category_id) REFERENCES category (category_id)
); 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/002f1/2)。

使用这两个字段`PRIMARY KEY`将防止重复的电影/类别组合被添加到表中。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-02-03T19:58:43.940

对此有不同的思想流派。一所学校更喜欢包含一个主键并将链接表命名为比它链接的两个表更重要的东西。原因是，虽然该表可能一开始看起来只是一个链接表，但它可能会成为包含重要数据的自己的表。

一个例子是杂志和订阅者之间的多对多。实际上，该链接是具有自己属性的订阅，例如到期日期、付款状态等。

但是，我认为有时链接表只是一个链接表。与类别的多对多关系就是一个很好的例子。

因此，在这种情况下，不需要单独的一个字段主键。您可以拥有一个自动分配键，这不会造成任何伤害，并且可以更轻松地删除特定记录。作为一般做法，这可能很好，因此如果该表后来发展为具有自己重要数据（作为订阅）的重要表，它将已经具有自动分配的主键。

您可以在两个字段上放置唯一索引以避免重复。如果您有单独的自动分配键，这甚至可以防止重复。您可以将这两个字段用作主键（这也是唯一索引）。

因此，一种思想可以坚持使用整数自动分配主键，并避免复合主键。这不是唯一的方法，也许不是最好的方法，但它不会导致你犯错误，陷入你真正后悔的问题。

但是，对于您正在做的事情，您可能只使用这两个字段就可以了。我仍然建议将这两个字段设为复合主键，或者至少在这两个字段上放置一个唯一索引。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-10-23T14:46:10.077

我会选择第二个连接表。但是将这两个字段设为主键。这将限制重复条目。

# sql-server - 在编写复杂的 sql 查询时需要帮助

> ID：14676344
> 
> 赞同：3
> 
> 时间：2013-02-03T19:28:10.983
> 
> 标签：sql-server

```
CREATE TABLE #tmpTableA
(
    [Id] [int] NOT NULL,
    RegionId INT,
    DistrictId INT,
    NurseryDays INT,
    TransplantDays INT     
 )

INSERT #tmpTableA ([Id], RegionId,DistrictId,NurseryDays,TransplantDays) VALUES (1,1,NULL,2,2) 
INSERT #tmpTableA ([Id], RegionId,DistrictId,NurseryDays,TransplantDays) VALUES (2,1,2,NULL,2) 
```

示例代码的输出是，

```
Id  RegionId    DistrictId     NurseryDays         TransplantDays
2     1            2               NULL              2
1     1            NULL             2                2 
```

我想要的结果是，1.）如果 RegionId 和 DistrictId 存在，则获取此组合的移植天数，否则获取 RegionId 和 DistrictId（NULL）的移植天数。

2.) 如果 RegionId 和 DistrictId 存在，则获取此组合的育儿日，否则获取 RegionId 和 DistrictId(NULL) 的育儿日。

## 期望的结果：

```
NurseryDays        TransplantDays
 2                      2 
```

这可能在单个查询中吗？

谢谢和问候，费萨尔·纳西尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:27:44.290

您的结果描述与实际结果不符。如果您需要数据中 regionid 和 districtid 的保育日，则该值应为空。

您将需要创建一个如图所示的存储过程来获得结果。

```
create PROCEDURE ProcGetDays 
    @regionid int
AS
BEGIN

    SET NOCOUNT ON;
declare @nurserydays int
declare @transplantdays int

select @transplantdays = transplantdays from tmpTableA where regionid=@regionid and districtid is not null
if @transplantdays is null
    select @transplantdays = transplantdays from tmpTableA where regionid=@regionid

select @nurserydays=nurserydays from tmpTableA where regionid=@regionid and districtid is not null
if @nurserydays is null
    select @nurserydays=nurserydays from tmpTableA where regionid=@regionid

select @nurserydays as nurserydays,@transplantdays as transplantdays

END
GO 
```

如果您需要使用临时表，则需要在存储过程中创建它以使其仍然可用。在示例中，我使用了永久表。

结束

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:46:11.520

首先，使用过滤器检索具有特定`RegionId`和特定或 NULL 的行`DistrictId`。然后以更具体的行在另一行之前的方式对行进行排序，然后选择最上面的行。

在 SQL 中，它可能如下所示：

```
SELECT TOP 1
  NurseryDays,
  TransplantDays
FROM YourTable
WHERE RegionId = @RegionId
  AND (DistrictId = @DistrictId OR @DistrictId IS NULL)
ORDER BY
  CASE DistrictId
    WHEN @DistrictId THEN 0
    ELSE 1
  END
; 
```

# php - 如何更新用于启动循环的while循环中的变量

> ID：14676346
> 
> 赞同：0
> 
> 时间：2013-02-03T19:28:25.357
> 
> 标签：php, loops

我遇到了一些代码问题。

我正在尝试生成一个唯一名称以插入数据库。

我创建了以下函数来检查名称是否已经存在：

```
function checkExists($database_reelfilm, $reelfilm, $mySlug, $locVal){
        $mmid_rs_slugCheck = "-1";
        if (isset($mySlug)) {
          $mmid_rs_slugCheck = $mySlug;
        }
        $mmid2_rs_slugCheck = "-1";
        if (isset($locVal)) {
          $mmid2_rs_slugCheck = $locVal;
        }
        mysql_select_db($database_reelfilm, $reelfilm);
        $query_rs_slugCheck = sprintf("SELECT * FROM locations_loc WHERE locations_loc.slug_loc = %s AND locations_loc.id_loc != %s", GetSQLValueString($mmid_rs_slugCheck, "text"),GetSQLValueString($mmid2_rs_slugCheck, "int"));
        $rs_slugCheck = mysql_query($query_rs_slugCheck, $reelfilm) or die(mysql_error());
        $row_rs_slugCheck = mysql_fetch_assoc($rs_slugCheck);
        $totalRows_rs_slugCheck = mysql_num_rows($rs_slugCheck);
        if($totalRows_rs_SlugCheck > 0){
            return true;
        }else{
            return false;
        }
    }; 
```

然后我创建一个循环来检查变量名称是否存在，如果存在，我希望它将计数器的值添加到变量名称然后重新检查它是否存在，直到我有一个唯一的名称，然后我可以保存到我的D b。

```
$updateVal = slugify($row_rs_locations['name_loc']);
        $newSlug = slugify($row_rs_locations['name_loc']);
        $locVal = $row_rs_locations['id_loc'];
        //echo(slugify($row_rs_locations['name_loc']));
        $checkCount = 1;
        $isDupe = '<BR>';
        while(checkExists($database_reelfilm, $reelfilm, $newSlug, $locVal)){
            $isDupe = 'Duplicate Added ' . $checkCount . ' to slug...<BR>';
            $newSlug = $newVal . $checkCount;
            $checkCount ++;
        }
        if($updateVal != $newVal){
            $updateVal = $newSlug;
        } 
```

我显然做错了什么，我需要在下一次迭代中使用 while 循环来使用循环中设置的 newSlug 值，从我的各种尝试来看，我完全不确定这是否可能。

实现这一目标的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:43:57.173

`$newVal`从来没有给过一个值，但它被使用了两次（第二个代码块）。我认为你需要类似的东西：

```
$newSlug = slugify($row_rs_locations['name_loc']);
$newVal = $newSlug; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:51:19.730

> 我需要在下一次迭代中使用 while 循环来使用循环中设置的 newSlug 值

在while循环中你做

```
$newSlug = $newVal . $checkCount; 
```

但是 $newVal 不存在。将该行替换为以下内容：

```
$newSlug .= $checkCount; 
```

# javascript - 我应该如何处理许多嵌套匿名函数中的范围？

> ID：14676347
> 
> 赞同：1
> 
> 时间：2013-02-03T19:28:25.993
> 
> 标签：javascript, node.js, mongodb

我在 mongodb 中有一个 Collection，其中包含嵌入的引用文档，这迫使我运行多个匿名函数。

首先我初始化这个数组

```
 var player = {
    name : '',
    life : 10,
    gold : 50,
    score : 0,
    clientId : socket.id,
    playerId : data.playerId,
    deck : []
  }; 
```

现在我需要通过从 mongodb 获取数据来添加数据。

```
// First find the player. 
  var playerCol = db.collection('Guest');
  playerCol.find({'_id' : new ObjectId(data.playerId)}).toArray(function(err, playerRes) {
    // Traverse and load each tower in deck.
// Traverse each embedded reference, so each can be fetched.
playerRes[0].deck.towers.forEach(function(tower) {
  // fetch data for tower.
  towerCol = db.collection('Tower');
  towerCol.find({'_id' : new ObjectId(tower.oid)}).toArray(function(err, completeTower) {
    // Add the tower data to the deck.
    player.deck.push(completeTower.pop());
  });
}); 
```

现在的问题是播放器数组仍然是第一次初始化时的样子。为什么我在播放器中的数据不持久？好吧，我知道为什么，因为当不在匿名函数中调用时，它在另一个范围内。但是我应该如何将我的值添加到播放器数组中？

片段合二为一。

```
// Initialize the player.
var player = {
  name : '',
  life : 10,
  gold : 50,
  score : 0,
  clientId : socket.id,
  playerId : data.playerId,
  deck : []
};

// Load players deck.
var playerCol = db.collection('Guest');
playerCol.find({'_id' : new ObjectId(data.playerId)}).toArray(function(err, playerRes) {
// Traverse and load each tower in deck.

playerRes[0].deck.towers.forEach(function(tower) {

  towerCol = db.collection('Tower');
  towerCol.find({'_id' : new ObjectId(tower.oid)}).toArray(function(err, completeTower) {
    player.name = "Melvar";
    player.deck.push(completeTower.pop());
    console.log(player.deck); // Prints the data, just pushed
  });
});

console.log(player.deck); // Prints empty array.
process.exit(1); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:07:59.143

虽然 Node.JS 是单线程的，但它是基于事件的。做工作并等待其他工作完成。等待 MongoDB 调用返回是可以“等待”的完美示例。在这种情况下，这意味着 Node 进程在等待响应时，可以执行其他 JavaScript 代码。最终，MongoDB 做出响应，并在下一个“等待其他工作”机会时执行代码。

下面标记为#1，代码在`playerCol.find`返回之前执行。Node.JS 和 MongoDB 驱动程序是异步的。这意味着**在进行**初始调用之后`find`才会返回调用结果。稍后，当数据库响应了这些值时，就会进行回调。在第一次调用时，回调是在 toArray 中声明的内部函数。我已将其重命名为**`playerCol.find``findPlayerAsync.`**

 **因此，在执行 find 之后，运行的下一行是`console.log(player.deck)`. 如果您添加一个如图所示的标记字符串`after find:`，您将看到该值在另一个`console.log`执行之前显示在控制台上（标记为 #2）。

```
// Load players deck.
var playerCol = db.collection('Guest');
playerCol.find({'_id' : new ObjectId(data.playerId)}).toArray(function findPlayerAsync(err, playerRes) {
// Traverse and load each tower in deck.

playerRes[0].deck.towers.forEach(function(tower) {

  towerCol = db.collection('Tower');
  towerCol.find({'_id' : new ObjectId(tower.oid)}).toArray(function findTowerAsync(err, completeTower) {
    player.name = "Melvar";
    player.deck.push(completeTower.pop());
    console.log('Inside towerCol.find: ' + player.deck); // #2 Prints the data, just pushed
  });
});

console.log('After find: ' + player.deck); // #1 Prints empty array.
process.exit(1); 
```

我希望控制台是：

```
After find: []
Inside towerCol.find: [......] 
```**

# asp.net-mvc - 什么可能导致我的 MVC 应用程序启动异常缓慢？

> ID：14676349
> 
> 赞同：1
> 
> 时间：2013-02-03T19:28:34.060
> 
> 标签：asp.net-mvc, asp.net-mvc-4, iis-express

非常常见的是，在我在家用机器上用 VS2012 调试的各种 MVC3/4 应用程序中，按 F5 开始调试并在 Chrome 中打开配置的起始页后，可能需要数到十分钟才能激活。

我没有很长的启动程序来加载缓存或生成代码等，并且同一个应用程序将在我的办公机器上立即启动。很多时候它也会在我的家用机器上这样做，但是这种缓慢的启动似乎是在几个小时的调试之后发生的，可能是某些操作。重新启动 VS 似乎无济于事，杀死 IIS Express 也无济于事。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T11:00:09.657

我们最近遇到了一个相同的场景，将应用程序附加到调试器导致每个页面加载大约需要 10 分钟，但在没有调试的情况下运行或在 QA 环境中运行正常。

问题原来是 log4net 被配置为使用网络路径来存储日志文件，该路径在我们的本地设置中不可用。这导致多次尝试访问不存在的远程路径（每个类使用 Spring .Net 设置一次）（因此 log4net 在每种情况下都抛出异常）。

但这应该会影响您开箱即用，并且不应该随着时间的推移而增加..

# java - 多线程和 Google App Engine Servlet

> ID：14676353
> 
> 赞同：3
> 
> 时间：2013-02-03T19:28:51.493
> 
> 标签：java, multithreading, google-app-engine

在 Google App Engine (GAE) 上，前端实例可以创建多达 10 个线程以最大化吞吐量。根据[this page](https://developers.google.com/appengine/docs/java/runtime#The_Sandbox)，这样的多线程可以实现如下：

```
Runnable myTask = new Runnable({
    @Override
    public void run() {
        // Do whatever
    }
});

ThreadFactory threadFactory = ThreadManager.currentRequestThreadFactory();

// GAE caps frontend instances to 10 worker threads per instance.
threadFactory.newRequestThread(myTask); 
```

为了访问我的 GAE 服务器端，我将公开许多映射到某些 URL 的 servlet，例如`FizzServlet`映射到`http://myapp.com/fizz`：

```
public class FizzServlet extends HttpServlet {
    @Override
    public void doGet(HttpServletRequest request,
            HttpServletResponse response) throws IOException {
        // Handle the request here. Somehow send it to an available
        // worker thread.
    }
} 
```

**我想我对如何将这两个想法联系起来感到窒息。**据我所知，这里有 3 种不同的机制/项目：

1.  `ServletContextListener`App Engine 实例本身，我可以通过在 GAE 启动实例时实现并运行自定义代码来“挂钩”其生命周期；和
2.  这个`ThreadFactory`/`ThreadManager`东西（上）
3.  小服务程序/侦听器

我想我想知道如何实现代码，以便每次收到新请求时，例如`FizzServlet#doGet`，如何确保将请求发送到可用线程（如果有可用线程）。这样，如果`FizzServlet`是我公开的唯一 servlet，它可能会被调用多达 10 次，然后才会导致新的（第 11 个）传入请求在前一个请求正在处理时挂起。

我正在寻找 servlet 和这个线程创建代码之间的粘合代码。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:58:45.380

> 我想我想知道如何实现代码，以便每次有新请求进入时，比如 FizzServlet#doGet，如何确保将请求发送到可用线程（如果有可用线程）。这样，如果 FizzServlet 是我公开的唯一 servlet，它可能会被调用多达 10 次，然后才会导致新的（第 11 个）传入请求在前一个请求正在处理时挂起。

这就是 GAE servlet 引擎为您所做的。您部署一个包含 servlet 的应用程序，当请求进来时，servlet 引擎使用一个线程来处理请求并调用您的 servlet。你没有什么可做的。

如果 GAE 调用的 servlet`doGet()`或`doPost()`方法需要并行执行多个任务（例如联系其他几个网站），那么您将按照链接到的页面中的说明自行启动线程。

# php - 返回值作为'customvariablename'

> ID：14676361
> 
> 赞同：0
> 
> 时间：2013-02-03T19:29:32.460
> 
> 标签：php

我正在尝试爬取文件并在每个图像路径的开头插入“../../”。不幸的是，脚本超时了，因为在添加它之前只花了几秒钟的时间运行，所以有些东西告诉我它没有做我认为应该做的事情。这就是我的做法：

```
$filedata = substr_replace(substr($filedata,$imageBeginning,1),"../../",$imageBeginning); 
```

我正在爬取整个 HTML 文件来完成此操作，因此我需要一个有效的解决方案。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:41:40.547

这是完全未经测试的，但是是这样的：

```
preg_replace('/(<img\s+.*?src=")(.*\\.(?:jpg|png|bmp|gif).*?>)/', '$1../../$2', $filedata); 
```

说明：您正在正则表达式中进行 2 次捕获。第一个是从`img`标记开始到`src`属性开始的所有内容。第二个是`src`属性值及其之后的所有内容。然后你只需在替换的中间插入“../../”。

[http://php.net/manual/en/function.preg-replace.php](http://php.net/manual/en/function.preg-replace.php)

# php - MySQL运行近80小时消耗过多内存

> ID：14676364
> 
> 赞同：1
> 
> 时间：2013-02-03T19:29:58.070
> 
> 标签：php, mysql, ssh, fopen

我们一直试图找出问题所在，但似乎无法解决。我希望这里有人可以提供帮助。我们经常发生崩溃，当我使用 top 函数监控 SSH 时，它显示 MySQL 连接已经打开了 80 多个小时，并且消耗了我们近 20% 的内存使用量。

我们有很多运行的 cron 脚本，但我认为我们不需要使用 mysql_close 函数。这是正常的吗？我将如何关闭连接？我们所有的 cron 脚本都使用 wordpress wp-config 文件连接到数据库。所以脚本都会说类似

```
require_once('wp-config.php'); 
..... your code ........ 
```

由于我们有数千个 cron 脚本，因此我们以一种可以打开一大堆它们的方式创建它。fclose 没有被使用。这可能是保持 MySQL 连接打开的原因吗？多 fopen 脚本如下所示。

```
$subdomain_array = array('sub1','sub2','sub3','sub4','sub5','sub6','sub7','sub8');
$count_subdomains = count($subdomain_array);

for ($x=0;$x<$count_subdomains;$x++) {

$cron_root_folder1 = "http://".$subdomain_array[$x].".domain.com/myscripts/";
$next_file1 = $cron_root_folder1."file_name.php";
$handle = fopen($next_file1,"r");
echo "<h1>".$subdomain_array[$x]."</h1>";

    while ($buffer = fgets($handle)) {
        echo $buffer;
    }
echo "<br /><br />"; 
```

我们有大约 75 个这些 fopen 脚本在不同时间运行。如果有人可以提供帮助，我们将不胜感激！

我应该补充一点，SSH 显示我有 170 个正在休眠的进程。我猜mysql就是其中之一。

# php - 将 img 路径上传到 db codeigniter

> ID：14676365
> 
> 赞同：0
> 
> 时间：2013-02-03T19:29:59.990
> 
> 标签：php, codeigniter, file-upload

我正在尝试在上传图片后上传图片的路径。

当我在底部注释掉模型时，表单当前将文件发送到文件系统没有问题。

**控制器：**

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Upload extends CI_Controller {
    function __construct(){
        parent::__construct();
        $this->load->helper(array('form', 'url'));
    }

    function index() {
        $this->load->view('uploaderview', array('error' => ' ' ));
    }

    function do_upload(){
        $config['upload_path'] = './upl0d/';
        $config['allowed_types'] = 'gif|jpg|png';
        $config['max_size'] = '2048';      //2mb
        $config['max_width']  = '1024';
        $config['max_height']  = '768';
        $config['encrypt_name'] = FALSE;
        $this->load->library('upload', $config);

        if ( ! $this->upload->do_upload()) {
            $error = array('error' => $this->upload->display_errors());
            $this->load->view('uploaderview', $error);
        } else {
            ## Insert into filesystem.
            $data = array('upload_data' => $this->upload->data());
            ## load the success page.
            $this->load->view('uploadsuccess', $data);
            ## Insert into db
            ## then insert the img name into the database
            this->load->model('uploadermodel');
            $this->uploadermodel->uploadcoupon();               
        }
    }
} 
```

**还有一个模型：**

```
<?php
class Uploadermodel extends CI_Model{
    function __construct(){
        // Call the Model constructor
        parent::__construct();
    }

    function uploadcoupon(){
        $uploadFileName = $upload_data['orig_name'];
        $currentDt = date('Y-m-d H:i:s');
        $data = array('fileNameUploaded'=>$uploadFileName,'date'=>$currentDt);
        $this->db->insert('Coupon', $data); 
    }
}   
?> 
```

当我包含模型时，我收到以下错误：

```
syntax error, unexpected T_OBJECT_OPERATOR on line 36 
```

这是控制器的第 36 行：

```
this->load->model('uploadermodel'); 
```

有人看到我在这里做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T23:35:54.613

@CodeTalk - 查看您的其他问题以获取更完整的详细信息：

[将数据从控制器传递到模型 Codeigniter](https://stackoverflow.com/questions/14676864/pass-data-from-controller-to-model-codeigniter)

但是你需要通过

```
 $this->uploadermodel->uploadcoupon($my_insert_data); 
```

然后再次：

```
uploadcoupon($my_insert_data) 
```

# c# - 如何转换列表 或列出 to a ListView.ListViewItemCollection in one line How can we transform a list of string or a list of object to a ListViewItemCollection in one line with linq, where object is for example a person 问问题 问问题 2013-02-03T19:31:22.653 3222 次 This question shows research effort; it is useful and clear 2 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. How can we transform a list of string or a list of object to a ListViewItemCollection in one line with linq, where object is for example a person with Name property that will be displayed to the ListViewItem. Here is my current code : foreach (string word in sf.lstWords) { lvWords.Items.Add(new ListViewItem(word)); } Use ListView.ListViewItemCollection.AddRange and the Linq method Select lvWords.Items.AddRange(sf.lstWords.Select(t => new ListViewItem(t)).ToArray()); I use ToArray() because the signature of AddRange is void AddRange(ListViewItem[]) c#linq 4 1 回答 1 This answer is useful 11 使用ListView.ListViewItemCollection.AddRange和Linq方法Select lvWords.Items.AddRange(sf.lstWords.Select(t => new ListViewItem(t)).ToArray()); 我使用ToArray()是因为 AddRange 的签名是无效的AddRange(ListViewItem[]) 于 2013-02-03T19:33:42.787 回答 Related 1 java - 使用仿射变换旋转多边形 2 javascript - 为什么我的 Angular.js $routeProvider 什么都不做？ 1 java - 扩展 AbstractTableModel 不更新 JTable 中的单元格内容 2 php - 开发始终运行的 PHP 脚本 1 objective-c - Objective C HTTP Post请求参数在应用程序和服务器之间丢失 6 python - 为什么我不能更改列表中的列表？ 0 ios - 访问 Obj-c 中的对象 2 android - AIR Android GCM ANE MismatchSenderId 2 java - Apache Sling 循环重复 1 php - 代码中的特殊字符 - PHP Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：14676374
> 
> 赞同：2
> 
> 时间：
> 
> 标签：c#, linq

How can we transform a list of string or a list of object to a ListViewItemCollection in **one line** with linq, where object is for example a person with Name property that will be displayed to the ListViewItem.

Here is my current code :

```
foreach (string word in sf.lstWords)
{
  lvWords.Items.Add(new ListViewItem(word));
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-03T19:33:42.787

使用[`ListView.ListViewItemCollection.AddRange`](http://msdn.microsoft.com/en-us/library/1c1wawcw.aspx)和Linq方法[`Select`](http://msdn.microsoft.com/en-us/library/bb548891.aspx)

```
lvWords.Items.AddRange(sf.lstWords.Select(t => new ListViewItem(t)).ToArray()); 
```

我使用`ToArray()`是因为 AddRange 的签名是无效的`AddRange(ListViewItem[])`

# python - 将电子邮件从 procmail 传送到解析正文并保存为文本文件的 python 脚本

> ID：14676375
> 
> 赞同：1
> 
> 时间：2013-02-03T19:31:23.187
> 
> 标签：python, parsing, procmail

我正在构建一个数据记录器，我花了很多时间试图做到这一点，每个论坛都把我带到不同的方向，我认为一个周末的谷歌搜索权证在这里提交一个问题。

我正在运行 Ubuntu 12.10，我使用 fetchmail 来获取我的邮件，它将它发送到 procmail，并且我让 procmail 将它传送到一个应该解析正文的 python 脚本，并将其保存到一个文本文件中。问题是我不知道如何编写一个可以执行此操作的 python 脚本，我在网上找到的每个示例都让我有点头晕目眩，我希望有人能花点时间来帮助我了解如何实现这一点.

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-06T00:15:57.513

在 .promailrc 中，使用以下配方将所有电子邮件通过管道传输到 python 脚本中：

```
:0Wc:
| /usr/bin/python [PATH TO PYTHON SCRIPT] 
```

在 python 脚本中，您可以使用以下命令接收传入的电子邮件：

```
import sys
import email

full_msg = sys.stdin.readlines()

msg = email.message_from_string(full_msg.join());

to = msg['to']
from = msg['from']
subject = msg['subject']
body = msg['body'] 
```

# css - 在 IE 中显示下拉菜单时出现问题

> ID：14676376
> 
> 赞同：0
> 
> 时间：2013-02-03T19:31:57.263
> 
> 标签：css, internet-explorer, drop-down-menu, navigation, gradient

我不确定为什么这个下拉菜单不会出现在 IE 中。任何人都可以看到问题是什么？它适用于所有其他浏览器，但不适用于 IE。我知道 IE 中的渐变需要很多思考。这是我的代码。

```
.menu { 
   border: 1px solid #ccc;
   background: #006699; /* Old browsers */
   background: -moz-linear-gradient(top,  #006699 0%, #1f416b 100%); /* FF3.6+ */
   background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#006699), color-stop(100%,#1f416b)); /* Chrome,Safari4+ */
   background: -webkit-linear-gradient(top,  #006699 0%,#1f416b 100%); /* Chrome10+,Safari5.1+ */
   background: -o-linear-gradient(top,  #006699 0%,#1f416b 100%); /* Opera 11.10+ */
   background: -ms-linear-gradient(top,  #006699 0%,#1f416b 100%); /* IE10+ */
   background: linear-gradient(to bottom,  #006699 0%,#1f416b 100%); /* W3C */
   filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#006699', endColorstr='#1f416b'); /* IE6-9 */  
}

.menu li a {
   padding: 15px 45px;
   text-decoration: none;
   font-size: 0.9em;
   color: #fff;
   font-family: Arial, sans-serif;      
}

.menu li.current > a,
.menu li.current > a:hover,
.menu li.current.hover > a {
   background: rgb(70,168,217); /* Old browsers */
   background: -moz-linear-gradient(top, rgba(122,188,255,1) 0%, rgba(96,171,248,1) 44%, rgba(64,150,238,1) 100%); /* FF3.6+ */
   background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,rgba(122,188,255,1)), color-stop(44%,rgba(96,171,248,1)), color-stop(100%,rgba(64,150,238,1))); /* Chrome,Safari4+ */
   background: -webkit-linear-gradient(top, rgba(122,188,255,1) 0%,rgba(96,171,248,1) 44%,rgba(64,150,238,1) 100%); /* Chrome10+,Safari5.1+ */
   background: -o-linear-gradient(top, rgba(122,188,255,1) 0%,rgba(96,171,248,1) 44%,rgba(64,150,238,1) 100%); /* Opera11.10+ */
   background: -ms-linear-gradient(top, rgba(122,188,255,1) 0%,rgba(96,171,248,1) 44%,rgba(64,150,238,1) 100%); /* IE10+ */
   filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#7abcff', endColorstr='#4096ee',GradientType=0 ); /* IE6-9 */
   background: linear-gradient(top, rgba(122,188,255,1) 0%,rgba(96,171,248,1) 44%,rgba(64,150,238,1) 100%); /* W3C */
   color: #fff;
   text-shadow: 0px -1px 0px rgba(0,0,0,0.2);
   cursor: default;
}

.menu li a:hover,
.menu li.hover > a {
   background: #b32416; /* Old browsers */
   background: -moz-linear-gradient(top,  #b32416 0%, #8f0222 44%, #6d0019 100%); /* FF3.6+ */
   background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#b32416), color-stop(44%,#8f0222), color-stop(100%,#6d0019)); /* Chrome,Safari4+ */
   background: -webkit-linear-gradient(top,  #b32416 0%,#8f0222 44%,#6d0019 100%); /* Chrome10+,Safari5.1+ */
   background: -o-linear-gradient(top,  #b32416 0%,#8f0222 44%,#6d0019 100%); /* Opera 11.10+ */
   background: -ms-linear-gradient(top,  #b32416 0%,#8f0222 44%,#6d0019 100%); /* IE10+ */
   background: linear-gradient(to bottom,  #b32416 0%,#8f0222 44%,#6d0019 100%); /* W3C */
   filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#b32416', endColorstr='#6d0019'); /* IE6-9 */
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:35:15.473

哪个IE版本？

我知道您的 html 页面的头部需要这样的东西。与SVG或其他东西有关。条件格式。

```
<!-- following class is conditional for IE9 and must be put in elements for css gradient to work -->
<!--[if gte IE 9]>
  <style type="text/css">
    .gradient {
       filter: none;
    }
  </style>
<![endif]--> 
```

然后将此渐变类应用于使用渐变的元素。

[http://www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

**编辑**

好的。做了一点研究，发现过滤器应该有一个 8 位十六进制代码，其中前两个是不透明度。我认为 FF 代表 100%，00 代表 0%。另外，使用双引号“。可能会有所作为。

所以做这样的事情：

```
filter:progid:DXImageTransform.Microsoft.gradient
(startColorstr="#ff7abcff",endColorstr="#ff4096ee",GradientType=0); 
```

# java - 从所有方法访问 SimpleCursorAdapter

> ID：14676385
> 
> 赞同：2
> 
> 时间：2013-02-03T19:32:30.353
> 
> 标签：java, android

我正在尝试在我的类中设置一个“SimpleCursorAdapter”对象变量，以便所有方法都可以访问它，所有这些都是非常标准的东西。目前，我的“OnCreate”方法中出现错误，显示以下错误：

错误：

```
cursorAdapter cannot be resolved to a type. 
```

下面是类中声明的 SimpleCursorAdapter：

```
package com.example.flybase2;

import android.app.AlertDialog;
import android.app.AlertDialog.Builder;
import android.app.ListActivity;
import android.content.DialogInterface;
import android.content.Intent;
import android.database.Cursor;
import android.os.Bundle;
import android.support.v4.widget.SimpleCursorAdapter;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.EditText;
import android.widget.ImageButton;
import android.widget.ListView;

public class ViewAppointments extends ListActivity implements OnClickListener {
SimpleCursorAdapter cursorAdapter;
ListView searchedAppView;
ImageButton searchAppoints;
EditText searchAppName;
Long id;

DBHandlerApp delApp = new DBHandlerApp(this, null, null);

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.appointmentview);

    searchedAppView = (ListView)findViewById(android.R.id.list);

    searchAppoints = (ImageButton) findViewById(R.id.btnSearchAppointName); 
    searchAppName = (EditText) findViewById(R.id.inputAppointName); 

    DBHandlerApp DBAppointments = new DBHandlerApp(this, null, null);

    DBHandlerApp searchApps = new DBHandlerApp(this, null, null);

    searchApps.open();

    Cursor cursor = searchApps.getAppointmentsData();
    searchApps.close();
    startManagingCursor(cursor);

    @SuppressWarnings("static-access")
    String [] from = new String [] {DBAppointments.KEY_NAMEAPP, DBAppointments.KEY_TYPEAPP, DBAppointments.KEY_TIMEAPP, DBAppointments.KEY_DATEAPP, DBAppointments.KEY_COMMENTAPP};
    int [] to = new int [] {R.id.txtAppointName, R.id.txtAppointType, R.id.txtAppointTime, R.id.txtAppointDate, R.id.txtAppointCom};

    @SuppressWarnings("deprecation")

    //ERROR: cursorAdapter cannot be resolved.
    cursorAdapter = new SimpleCursorAdapter(this, R.layout.setappointviews, cursor, from, to);
    searchedAppView.setAdapter(cursorAdapter);

    searchedAppView.setTextFilterEnabled(true);

    searchAppoints.setOnClickListener(this);

    searchAppName.addTextChangedListener(new TextWatcher()
     {

        @Override
        public void afterTextChanged(Editable s) {

            cursorAdapter.getFilter().filter(s.toString());

        }

        @Override
        public void beforeTextChanged(CharSequence s, int start, int count,
                int after) {

        }

        @Override
        public void onTextChanged(CharSequence s, int start, int before,
                int count) {

        }

     });

    }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:59:51.077

你不需要那个对象。你可以做：

```
searchedAppView.getAdapter(); //listView.getAdapter() 
```

在您的活动中的任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:25:04.620

您的问题与注释的位置有关。

```
@SuppressWarnings("deprecation") 
```

在`onCreate()`其中（奇怪地）导致错误。

# gif - 在 Qualtrics 中使用动画 gif

> ID：14676386
> 
> 赞同：0
> 
> 时间：2013-02-03T19:32:35.707
> 
> 标签：gif, survey, animated, qualtrics

有没有人有关于如何在 Qualtrics 中使用动态 gif 的提示？我想添加一个（假的）“页面加载”动画 gif。我已将要使用的 gif 添加到图形库中，但是当我显示它时，动画不起作用。

仅供参考，我使用谷歌浏览器作为调查的浏览器。

我确实看过这个帖子：[http](http://www.west-wind.com/weblog/posts/2004/Dec/27/Animated-GIF-images-in-hidden-page-elements) ://www.west-wind.com/weblog/posts/2004/Dec/27/Animated-GIF-images-in-hidden-page-elements但仍然无法弄清楚如何要解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T22:57:13.000

所以我想出了如何解决这个问题。显然 Qualtrics 会生成一些 php 内容来显示其库中的图形。如果我只是将要显示的图像上传到外部网站，我可以使用 Qualtrics 链接到 url。如果我这样做，动画效果就很好。

只是想我会分享以防其他人遇到这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-02T19:56:56.643

要在 Qualtrics 中使用加载屏幕，请插入图形并选择“使用来自网络的图形”。只需通过 google 搜索找到您喜欢的页面，然后将 url 插入 Qualtrics。

# c# - 具有最大大小的字典的数据结构

> ID：14676388
> 
> 赞同：1
> 
> 时间：2013-02-03T19:32:41.277
> 
> 标签：c#, algorithm, data-structures, hash, dictionary

> **可能重复：**
> [IDictionary 是否有任何 LRU 实现？](https://stackoverflow.com/questions/754233/is-it-there-any-lru-implementation-of-idictionary)

我正在寻找一种类似于字典但只能包含一组键值对的数据结构。当一个键值对被添加到一个已经满的字典中时，一个最近没有被访问过的键值对将被删除。

C# 是否已经存在类似的东西？

我记得为操作系统类实现了类似的东西，并且数据结构用于决定应该将 RAM 的哪一部分分页到磁盘。这是通过将引用位与每个键值对相关联来完成的，该键值对在访问该对时设置为真。当需要删除一对时，键值对将被迭代，直到找到一个将其引用位设置为 false 的对。每对迭代的参考位将设置为假，最后一个将被删除。

如果 C# 中尚不存在为此的数据结构，那么我描述的算法是否是实现它的好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:55:19.453

看起来在.Net框架中还没有任何实现，所以这就是我最终使用的

```
using System.Collections.Generic;
using System.Linq;

namespace MyProject.Util
{
public class LruCache<Key, Value>
{
    public delegate Value ValueCreator();

    Dictionary<Key, ValueWithReference> cache;

    //The maximum number of elements that can fit in the cache.
    int maxCacheSize;

    IEnumerator<Value> valueRemover;

    public LruCache(int maxCacheSize) {
        this.cache = new Dictionary<Key, ValueWithReference>();
        this.maxCacheSize = maxCacheSize;
        this.valueRemover = GetKeyValuePairRemover().GetEnumerator();
    }

    /// <summary>
    /// Gets the value associated with the specified key. If it doesn't exist in the cache 
    /// then it will be created with createValue() and added to the cache. 
    /// </summary>
    public Value GetAndAddValue(Key key, ValueCreator createValue) {
        if (this.cache.ContainsKey(key) == false)
        {
            while (this.cache.Count >= this.maxCacheSize) {
                this.valueRemover.MoveNext();
            }

            this.cache[key] = new ValueWithReference(createValue());
        }

        this.cache[key].recentlyUsed = true;
        return this.cache[key].value;

    }

    protected IEnumerable<Value> GetKeyValuePairRemover() { 
        while (true) {
            List<Key> keyList = this.cache.Keys.ToList();

            foreach(Key key in keyList) {
                if (this.cache[key].recentlyUsed)
                {
                    this.cache[key].recentlyUsed = false;
                }
                else {
                    Value removedValue = this.cache[key].value;
                    this.cache.Remove(key);
                    yield return removedValue;
                }
            }

        }
    }

    protected class ValueWithReference
    {
        public Value value;
        public bool recentlyUsed;

        public ValueWithReference(Value value)
        {
            this.value = value;
            this.recentlyUsed = true;
        }
    }
}
} 
```

# android - android：文本视图中的问题

> ID：14676390
> 
> 赞同：0
> 
> 时间：2013-02-03T19:32:46.493
> 
> 标签：android, textview

我的 textview 包含 c++ 代码。因为它包含特殊字符，所以我已经包含了所有其他字符，但是当我在代码中使用“\n”时，它会进入下一行并将剩余的文本输入到下一行。我该如何解决？此外，我在每一行的开头都包含了 \n，因为我希望这些行从下一行开始。这是我的布局示例：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >

<ScrollView
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/string_display"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_gravity="left"
        android:text="
\n #include&lt;iostream>
\n #include&lt;conio.h>
\n #include&lt;stdio.h> 
\n void main()
\n {
\n  clrscr();
\n  char a[100];
\n  cout&lt;&lt;&quot;Enter String:&quot;;
\n  cin>>a;
\n  cout&lt;&lt;&quot;String you entered:&quot;;
\n  cout&lt;&lt;a;
\n  getch();
\n }
\n \n 
//using gets function
\n //now it will include spaces
\n
\n #include&lt;iostream.h>
\n #include&lt;conio.h>
\n #include&lt;stdio.h>

\n \n void main()
\n {
\n  clrscr();
\n  char a[100]; 
\n  cout&lt;&lt;&quot;Enter String:&quot;;
\n  gets(a);
\n  cout&lt;&lt;&quot;String you entered:&quot;;
\n  cout&lt;&lt;a;
\n  getch();
\n}

"
android:textSize="20sp" />

</ScrollView>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:47:26.860

只需转义要显示的换行符`\\n`。

# android - string.xml 中的错误

> ID：14676394
> 
> 赞同：-2
> 
> 时间：2013-02-03T19:33:18.683
> 
> 标签：android, xml, android-xml

> **可能重复：**
> [如何将变量放入字符串资源中？](https://stackoverflow.com/questions/5854647/how-to-put-variable-inside-string-resources)

string.xml 文件在以下行中给出错误。

错误：在此行找到多个注释：-错误：以非位置格式指定了多个替换；您是要添加 formatted="false" 属性吗？- 错误：在预期的位置找到标签

```
 <!-- Search failure message. -->
<string name="no_results">No results found for \"%s\"</string> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:36:14.847

如果您需要使用 格式化字符串`String.format(String, Object...)`，则必须以正确的方式将格式参数放入字符串资源中。用以下内容替换您的字符串：

```
<string name="no_results">No results found for %1$s</string> 
```

-

```
Resources res = getResources();
String text = String.format(res.getString(R.string.no_results), "your text"); 
```

# java - Java重载方法选择

> ID：14676395
> 
> 赞同：17
> 
> 时间：2013-02-03T19:33:27.767
> 
> 标签：java, overloading

我试图弄清楚Java如何选择执行哪种方法：

```
//Example 1 prints Square:add(Figure)
Figure fs = new Square();
fs.add(fs);

//Example 2 prints Square:add(Figure)
Rectangle rs = new Square();
rs.add(fs);

//Example 3 prints Rectangle:add(Rectangle). Expected Square:add(Square)
rs.add(new Square());

//Example 4 prints Rectangle:add(Rectangle). Expected Square:add(Figure)
Square ss = new Square();
ss.add(rs);

class Figure
{
    public void add(Figure f){ System.out.println("Figure:add(Figure)"); }
}

class Rectangle extends Figure
{
    @Override
    public void add(Figure f){ System.out.println("Rectangle:add(Figure)"); }
    public void add(Rectangle r){ System.out.println("Rectangle:add(Rectangle)"); }
}

class Square extends Rectangle
{
    @Override
    public void add(Figure f){ System.out.println("Square:add(Figure)"); }
    public void add(Square s){ System.out.println("Square:add(Square)"); }
} 
```

我在[这里](https://stackoverflow.com/questions/1572322/overloaded-method-selection-based-on-the-parameters-real-type)学到的是

*   方法签名根据编译时数据类型确定
*   调用的实际方法取决于调用该方法的对象的动态类型。

基于此，前两次调用的结果符合预期。但是，我不明白示例 3 和 4 的结果。

好像是[java语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12)里规定的，但是没看懂。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-03T19:37:52.543

> 但是，我不明白示例 3 和 4 的结果。

好的，让我们分别看看它们。

**示例 3**

```
//Example 3 prints Rectangle:add(Rectangle). Expected Square:add(Square)
rs.add(new Square()); 
```

重要的部分是表达式的*编译时*`rs`类型和`new Square()`.

`rs`仅声明为`Rectangle`，因此编译器将查看声明的方法`Rectangle`及其超类：

```
public void add(Figure f)
public void add(Rectangle r) 
```

表达式的类型`new Square()`是`Square`，所以两种方法都*适用*——但第二种更*具体*。

所以编译器会调用引用`add(Rectangle)`的对象。`rs`这就是编译时方面的内容。

在执行时， 的值`rs`指的是`Square`- 但`Square`不会覆盖的实例，`add(Rectangle)`因此选择的方法是以下中的实现`Rectangle`：

```
public void add(Rectangle r){ System.out.println("Rectangle:add(Rectangle)"); } 
```

**示例 4**

```
//Example 4 prints Rectangle:add(Rectangle). Expected Square:add(Figure)
Square ss = new Square();
ss.add(rs); 
```

再次，让我们考虑所涉及的编译时类型......`ss`是 type `Square`，并且`rs`是 type `Rectangle`（编译时类型，记住）。

声明的方法`Square`及其超类是：

```
public void add(Figure f)
public void add(Rectangle r)
public void add(Square s) 
```

由于编译时类型`rs`是 only `Rectangle`(not `Square`)，所以前两种方法适用，但第三种方法不适用。因此，再次`add(Rectangle)`在编译时选择（因为它比 更具体`add(Figure)`）。

同样，执行时间类型`ss`是`Square`，它不会覆盖`add(Rectangle)`，因此`Rectangle`使用了 in 的实现。

如果这里有什么令人困惑的地方，请告诉我——如果你能具体说明哪一部分，那就太好了。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T19:40:14.667

```
rs.add(new Square()); 
```

rs 的声明类型是矩形。因此，它查看 Rectangle 中的一个方法以及所有采用 Square 或与 Square 兼容的类型作为参数的超类。最具体的一个是`add(Rectangle)`因为 Square 是一个 Rectangle，而且 Rectangle 比 Figure 更具体。

```
Square ss = new Square();
ss.add(rs); 
```

`add(Rectangle)`在 Square 和所有超类中查找方法。`Rectangle.add(Rectangle)`被选中，因为`Square.add(Square)`不适用（矩形不是正方形），并且`Square.add(Figure)`不太具体。

# php - ... 在 var_dump php 中是什么意思？

> ID：14676398
> 
> 赞同：1
> 
> 时间：2013-02-03T19:33:45.770
> 
> 标签：php, var-dump

这是一个示例输出：

```
class Framework\Configuration\Driver\Ini#3 (2) { protected $_parsed => array(0) { } private $_inspector => class Framework\Inspector#4 (4) { protected $_class => ... protected $_meta => array(3) { 'class' => array(0) { ... } 'properties' => array(0) { ... } 'methods' => array(0) { ... } } protected $_properties => array(0) { } protected $_methods => array(0) { } } } 
```

例如有`protected $_class => ..`

是什么意思？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:38:10.983

你有没有安装xdebug？！它将 var_dump 的最大深度限制为 3 级。

在这里阅读更多：[http ://www.xdebug.org/docs/display](http://www.xdebug.org/docs/display)

您可以通过更改 xdebug.var_display_max_depth 变量来更改它。

# css - 列表 - 你可以在同一个列表中有两种样式吗？

> ID：14676404
> 
> 赞同：0
> 
> 时间：2013-02-03T19:34:12.540
> 
> 标签：css, styles, html-lists

我正在开发的网站顶部有一个导航栏，它是使用无序列表创建的。我需要添加一个 Facebook 按钮以与导航栏的其余部分内联，但我希望它不采用与导航栏相同的 CSS 样式属性（即：与该特定列表相关的 CSS 属性）。有没有办法编写代码，以便我可以让 Facebook 按钮与导航栏内联，但应用不同的样式？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T19:51:26.720

您应该避免使用 !important，这是一种不好的做法，虽然它可以覆盖继承的样式，但可以通过分层您的 css 结构以创建更强大的 css 来实现相同的效果，阅读这篇文章了解如何在不使用的情况下实现相同的效果!important 规则。

[http://coding.smashingmagazine.com/2010/11/02/the-important-css-declaration-how-and-when-to-use-it/](http://coding.smashingmagazine.com/2010/11/02/the-important-css-declaration-how-and-when-to-use-it/)

要为 facebook 按钮设置不同的样式，只需给它一个 id（例如 #facebook）并使用它来给它特定的样式

```
li#facebook {
    padding: 0; 
    margin: 0;
} 
```

然后，这会将这些样式仅应用于具有 facebook ID 的元素

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:30:54.780

违背粮食怎么办？

例如 - 浮动所有 li 的权利，使 facebook 链接成为第一个菜单项。然后，您可以使用 :first-child 来设置 facebook 菜单项的样式，并且使用 CSS 任何元素都不需要标识符？

HTML：

```
<ul>
    <li><a href="#">Facebook</a></li>
    <li><a href="#">Menu Item 2</a></li>
    <li><a href="#">Menu Item 3</a></li>
    <li><a href="#">Menu Item 4</a></li>
    <li><a href="#">Menu Item 5</a></li>
</ul> 
```

CSS：

```
* {
    padding:0;
    margin:0;
}

ul {
    float:right;
    list-style:none;
}
li {
    float:right;
    margin:0 0 0 20px;
}
li a {
    float:right;
    text-decoration:none;
    color:#000;
}
li:first-child a {
    font-weight:bold;
    color:#f00;
} 
```

这是一个例子：http: [//jsfiddle.net/seemly/wMWHc/](http://jsfiddle.net/seemly/wMWHc/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:43:32.790

是的，您可以为 Facebook 元素设置单独的样式，这些样式将使用`!important`声明覆盖父 CSS。[这个网站](http://coding.smashingmagazine.com/2010/11/02/the-important-css-declaration-how-and-when-to-use-it/)提供了一个很好的解释。

没有你的 CSS 很难解释如何使用它，但让我们举个例子。像这样是特定列表 ( `li`) 元素的父 CSS 样式：

```
li {
  padding: 20px;
  margin 0 5px 0 5px;
  background-color: #ffc;
} 
```

因此，如果您希望 Facebook 元素不继承`padding`or `background-color`，请设置一个名为`#facebook`然后设置的类，如下所示：

```
li#facebook {
  padding: 0 !important;
  background-color: transparent !important;
} 
```

这应该确保`#facebook`元素获得 0`padding`并且`background-color`设置为透明。

但就像我说的，没有你的 CSS 很难给出一个可靠的答案，所以你应该`!important`在自己的设置中进行试验以获得你想要的结果。

# javascript - 类声明是否受 JavaScript 范围的约束？

> ID：14676405
> 
> 赞同：2
> 
> 时间：2013-02-03T19:34:32.337
> 
> 标签：javascript, oop, class, scope

考虑到 JavaScript 如何使用函数来确定变量的范围，我开始考虑在以下示例的情况下会发生什么：

```
var OuterClass = function () {

    var InnerClass = function () {
        this.foo = "bar";
    };

    this.getInstanceOfInner = function () {
        return new InnerClass();
    };

};

var instanceOfOuter = new OuterClass();
console.log(instanceOfOuter.getInstanceOfInner()); 
```

[**上面的小提琴**](http://jsfiddle.net/vfydN/)

在不同的浏览器中测试上述代码，结果各不相同：

*   **Chrome：**记录内部类的一个实例，并且似乎知道类声明。
*   **Firefox：**似乎记录了一个“无类型”的对象，但具有正确的属性。
*   **IE9：**记录对象的字符串表示`[object Object]`

*我对此感到有些困惑，这里的交易是什么？类声明是否受作用域的影响，与其他变量一样吗？还是由每个供应商按自己的意愿实施？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:54:05.353

JavaScript 中没有类和实例，只有原型和构造*函数（在*[此处](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Details_of_the_Object_Model)了解不同之处）。它们遵循与任何其他对象相同的范围规则。因此构造函数`InnerClass`本身在外部不可用，`ÒuterClass`但返回的“实例”知道它的原型，浏览器可能会也可能不会记录它。

# java - 列出文件夹中的所有文件以及子文件夹

> ID：14676407
> 
> 赞同：64
> 
> 时间：2013-02-03T19:34:42.510
> 
> 标签：java

> **可能重复：**
> [使用Java递归列出目录中的所有文件](https://stackoverflow.com/questions/2534632/list-all-files-from-a-directory-recursively-with-java)

我如何返回一个包含文件夹上所有文件以及子文件夹的文件数组，我的方法只适用于文件夹，它不包括子文件夹。

```
public File[] listf(String directoryName) {

    // .............list file
    File directory = new File(directoryName);

    // get all the files from a directory
    File[] fList = directory.listFiles();

    for (File file : fList) {
        if (file.isFile()) {
            System.out.println(file.getAbsolutePath());
        } else if (file.isDirectory()) {
            listf(file.getAbsolutePath());
        }
    }
    System.out.println(fList);
    return fList;
} 
```

* * *

## 回答 #1

> 赞同：97
> 
> 时间：2013-02-03T19:41:40.167

使用您当前的代码，进行此调整：

```
public void listf(String directoryName, List<File> files) {
    File directory = new File(directoryName);

    // Get all files from a directory.
    File[] fList = directory.listFiles();
    if(fList != null)
        for (File file : fList) {      
            if (file.isFile()) {
                files.add(file);
            } else if (file.isDirectory()) {
                listf(file.getAbsolutePath(), files);
            }
        }
} 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-02-03T19:37:28.473

使用来自 Apache commons 的 FileUtils [。](https://commons.apache.org/proper/commons-io/apidocs/org/apache/commons/io/FileUtils.html#listFiles(java.io.File,%20org.apache.commons.io.filefilter.IOFileFilter,%20org.apache.commons.io.filefilter.IOFileFilter))

```
listFiles

public static Collection<File> listFiles(File directory,
                                         String[] extensions,
                                         boolean recursive)
Finds files within a given directory (and optionally its subdirectories) which match an array of extensions.
Parameters:
directory - the directory to search in
extensions - an array of extensions, ex. {"java","xml"}. If this parameter is null, all files are returned.
recursive - if true all subdirectories are searched as well
Returns:
an collection of java.io.File with the matching files 
```

* * *

## 回答 #3

> 赞同：21
> 
> 时间：2013-02-03T19:45:23.523

您可以返回 a`List`而不是数组，事情变得更加简单。

```
 public static List<File> listf(String directoryName) {
        File directory = new File(directoryName);

        List<File> resultList = new ArrayList<File>();

        // get all the files from a directory
        File[] fList = directory.listFiles();
        resultList.addAll(Arrays.asList(fList));
        for (File file : fList) {
            if (file.isFile()) {
                System.out.println(file.getAbsolutePath());
            } else if (file.isDirectory()) {
                resultList.addAll(listf(file.getAbsolutePath()));
            }
        }
        //System.out.println(fList);
        return resultList;
    } 
```

# powershell - 在 Nuget 卸载期间删除 PropertyGroup.ps1

> ID：14676408
> 
> 赞同：0
> 
> 时间：2013-02-03T19:34:49.720
> 
> 标签：powershell, nuget

我有一个 Nuget 包，它在安装期间将一些 MSBuild 条目添加到项目 XML 中。这工作正常，产生以下（以及其他条目）：

```
<PropertyGroup>
    <JsCompilationToolsPath>some/path/determined/at/runtime</JsCompilationToolsPath>
</PropertyGroup> 
```

但是，我在卸载期间无法删除该属性（及其生成的组元素）。我的 PowerShell-fu 有很多不足之处，但到目前为止我已经尝试了一些方法：

1.  删除所有至少具有一个名为的 Property 元素的 PropertyGroup 元素`JsCompilationToolsPath`；
2.  移除所有已命名的 Property 元素`JsCompilationToolsPath`，然后移除所有没有子元素的 PropertyGroup 元素；
3.  只需删除命名的 Property 对象。

这是后一种尝试：

```
$msBuildProject.Properties | Where-Object { $_.Name -eq "JsCompilationToolsPath" } | ForEach-Object { $msBuildProject.RemoveProperty($_) } 
```

这些方法都没有任何效果；脚本运行没有错误，但没有删除属性元素。

通过 PowerShell 删除 MSBuild 属性的正确方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-22T10:36:55.177

我想出了以下内容：

```
param($installPath, $toolsPath, $package, $project)

Set-StrictMode -Version Latest

function RemoveMatchingPropertyGroups($buildProject, $property)
{
    foreach ($pg in $buildProject.Xml.PropertyGroups)
    {
        $firstChild = $pg.FirstChild.Name
        if ($property -eq $firstChild)
        {
            Write-Host "Removing old $firstChild"
            try
            {
                $pg.Parent.RemoveChild($pg)
            }
            catch
            {
            }
        }
    }
} 

Add-Type -AssemblyName 'Microsoft.Build, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'
$buildProject = [Microsoft.Build.Evaluation.ProjectCollection]::GlobalProjectCollection.GetLoadedProjects($project.FullName) | Select-Object -First 1

RemoveMatchingPropertyGroups $buildProject "JsCompilationToolsPath" 
```

您基本上需要加载 msbuild 引擎 dll，然后遍历所有属性组，如果`PropertyGroup.FirstChild.Name`匹配，您可以删除属性组。这是通过调用`PropertyGroup.Parent.RemoveChild()`The `Parent`needs to be there 来完成的，因为您想要删除属性组本身，而不仅仅是属性。

# ruby-on-rails - 尽管有 Heroku 数据库缓存，为什么我们的 Rails 数据库查询速度很慢？

> ID：14676409
> 
> 赞同：1
> 
> 时间：2013-02-03T19:35:06.167
> 
> 标签：ruby-on-rails, ruby-on-rails-3, heroku, rails-activerecord

我们之前使用 Heroku Basic 数据库，但发现我们网站上涉及大量数据库查询的操作非常缓慢。我们在 3 天前升级到 Heroku Crane 数据库，希望它能帮助解决这个问题。但是，查询似乎同样慢。即使连续两次运行相同的操作似乎也很慢，而由于缓存，我希望它会很快。

我们的数据库大小只有 15.4MB，而我们使用的 Crane 数据库提供了 400MB 的缓存。从理论上讲，似乎整个数据库都可以被缓存，从而提供非常快速的查询处理。应该是这样吗？我们如何着手解决或排除问题？此外，缓存磁盘是基于块的，还是基于查询的（即，我们是否必须两次运行完全相同的查询才能从缓存中受益？）

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T21:29:54.317

仅供参考，我在 Heroku Postgres 团队工作。

通常，Postgres 会缓存它从磁盘中提取的底层表数据，因此您必须至少对其进行一次操作才能将其加载到内存中。但是，如果您正在执行复杂的查询，缓存数据不会让您获得那么多，有时 Rails 无法将足够的工作委派给 db，从而使您的应用程序 CPU 受限并且您的 db 未得到充分利用。

我会深入研究优化你的查询和索引，让 Postgres 更好地发挥它的魔力。您可以从运行开始`EXPLAIN`并`EXPLAIN ANALYZE`找出查询的哪一部分需要很长时间。

优化数据库使用的好资源：[http](http://www.freebsddiary.org/postgresql-analyze.php) ://www.freebsddiary.org/postgresql-analyze.php和[http://wiki.postgresql.org/wiki/Performance_Optimization](http://wiki.postgresql.org/wiki/Performance_Optimization)

在 Rails 中使用 EXPLAIN 的示例：[了解如何通过 Postgres/rails 解释数据优化查询](https://stackoverflow.com/questions/14428547/understanding-how-to-optimize-a-query-via-the-postgres-rails-explain-data)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T19:14:44.390

with that small of a database, you should not see any performance issues. I would profile the app and tease out the slow parts, as I recommend here: [Rails Performance Tuning for Production?](https://stackoverflow.com/questions/8022554/rails-performance-tuning-for-production/8420679#8420679)

# html - 在另一个框架内显示 iframe

> ID：14676410
> 
> 赞同：0
> 
> 时间：2013-02-03T19:35:13.607
> 
> 标签：html

我需要在页面的一半（左侧）处创建 html 文档 - 超链接列表（`Lab2.6-Giper.html`）。右侧有两个框架（上下）。在上框架中我显示列表中的页面，在下框架中我需要显示带有一些页面（`Lab2.7-Giper_ris.html`）的 iframe。但它没有显示 iframe。有什么问题？

```
<html>
<head>
    <meta charset="utf-8">
</head>
<frameset cols="50%,*">
    <frameset>
        <frame name="left" src="Lab2.6-Giper.html" target="frame_left_up">
    </frameset>
    <frameset rows="50%,*">
        <frame name="frame_right_up">
        <frameset>
            <iframe name="frame_right_down" src="Lab2.7-Giper_ris.html">Frame</iframe>
        </frameset>
    </frameset>
</frameset>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:55:21.563

框架集只能包含框架（和其他框架集）。

如果你想要一个 iframe，那么你必须指定一个加载 HTML 文档的框架。该 HTML 文档可能包含 iframe。

# python - Pycrypto，列入 AES 密钥生成器

> ID：14676415
> 
> 赞同：0
> 
> 时间：2013-02-03T19:35:23.857
> 
> 标签：python, encryption

> **可能重复：**
> [将列表传递给 PyCrypto 中的 AES 密钥生成器](https://stackoverflow.com/questions/14539360/pass-list-to-aes-key-generator-in-pycrypto)

我正在通过将 JavaScript 移植到 Python 来为 API 制作包装器。

它将列表作为密钥传递给 AES 生成器，例如：

```
[1885434739, 825373440, 0, 0] 
```

然而，这给了我错误：

```
TypeError: 'list' does not support the buffer interface 
```

有谁知道我如何使用列表作为密钥来获得 Pycrypto AES 加密，因为它是一个 API，我无法更改输入是列表的要求。谢谢你。

当前代码示例：

```
test_key = [1885434739, 825373440, 0, 0]
aes = AES.new(test_key, AES.MODE_ECB)
print(aes) 
```

# c# - System.Drawing.Graphics 的 Invalidate 方法重绘问题

> ID：14676417
> 
> 赞同：0
> 
> 时间：2013-02-03T19:35:44.947
> 
> 标签：c#, repaint

我有一个带有绘图部分的 Windows.Form，即：

```
this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F); 
```

有一个 System.Windows.Forms.Control.Invalidate() 方法，每 50 毫秒调用一次，擦除绘制的所有内容并绘制任何被询问的内容：

```
System.Drawing.Graphics.DrawRectangle() 
```

但我需要的是它不会删除之前绘制的所有内容，我只需要它来添加新的矩形。我应该更换什么方法来获得这个功能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:05:33.060

无效意味着您的绘画区域不再有效..即，如果用户调整了窗口的大小并且您的所有绘图比例都应该对该事件做出反应，或者如果应该从您的绘图中删除某些东西，而它在其他东西之上等等。所以假设如果您想对“无效”做出反应，则需要删除该区域并重新绘制所有内容是合乎逻辑的。

所以 - 这已经解释过了，但你真正需要的是一些数组，它包含你需要绘制的元素并使用 invalidate 来绘制它们.. 即：（我将用伪代码编写它）

```
List<Shape> Shapes = new List<Shape>();

ctor:
Shapes.Add(rect1);
Shapes.Add(rect2);
...
and so on..

void some_user_incoming_event(){
    shapes.Add(rect200);
    Invalidate();
}

public void Invalidate()
{
    foreach(var shape in shapes) {code to draw specific shape}  
} 
```

如果您使用该策略，您将获得您想要的结果，但正如此答案上面的注释中所述 - 您需要停止每 x 毫秒调用一次 invalidate .. 否则您会看到闪烁。取而代之的是-每次发生更改时，您都需要手动调用 Invalidate 。

这种策略也称为 MVP (model-view-presenter)，其中 List 是您的模型，您的图形区域是您的视图，您的 Invalidate() 方法是您的 Presenter。

我希望这有帮助。

# java - Spring 3.2 / Hibernate4.1.9：使用@OneToMany 或@ManyToMany 针对未映射的类错误

> ID：14676419
> 
> 赞同：1
> 
> 时间：2013-02-03T19:35:50.613
> 
> 标签：java, spring, hibernate

我现在对一小段代码感到疯狂。我正在创建一个基于 spring MVC 3.2 的简单休息服务，并使用带有 spring-orm 和 hibernate4.1.9 的 JPA 持久层。

我正面临一个关于未映射类的奇怪错误。这是我的第一个实体（在我建立关系之前完美运行）

**用户.java**

```
@Entity
@Table(name="user")
public class User {
//[...]
@OneToMany(mappedBy="owner", cascade=CascadeType.ALL, fetch=FetchType.EAGER)
private Set<FileInfo> fileInfos;
//[...]
} 
```

**文件信息.java**

```
@Entity
@Table(name="file_info")
public class FileInfo {
//[...]
@ManyToOne
@JoinColumn(name = "owner_id")
private User owner;
//[...]
} 
```

**小服务程序配置**

```
<?xml  version="1.0" encoding="UTF-8"?>
<!--[...]-->
<context:component-scan base-package="org.mypackage.myapp" />
<!--[...]-->
<bean id="sessionFactory"
   class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
   <property name="dataSource" ref="dataSource" />
   <property name="configLocation">
      <value>classpath:hibernate.cfg.xml</value>
   </property>
   <property name="packagesToScan" value="org.mypackage.myapp.model" />
   <property name="configurationClass">
      <value>org.hibernate.cfg.AnnotationConfiguration</value>
   </property>
   <property name="hibernateProperties">
      <props>
         <prop key="hibernate.dialect">${jdbc.dialect}</prop>
         <prop key="hibernate.show_sql">true</prop>
      </props>
   </property>
</bean>
<!--[...]-->
<tx:annotation-driven />
<bean id="transactionManager"
   class="org.springframework.orm.hibernate4.HibernateTransactionManager">
   <property name="sessionFactory" ref="sessionFactory" />
</bean>
<!--[...]--> 
```

**错误跟踪**

```
Caused by: org.hibernate.AnnotationException: Use of @OneToMany or @ManyToMany targeting an unmapped class: org.mypackage.myapp.model.User.fileInfos[org.mypackage.myapp.model.FileInfo]
    at org.hibernate.cfg.annotations.CollectionBinder.bindManyToManySecondPass(CollectionBinder.java:1057)
    at org.hibernate.cfg.annotations.CollectionBinder.bindStarToManySecondPass(CollectionBinder.java:733)
    at org.hibernate.cfg.annotations.CollectionBinder$1.secondPass(CollectionBinder.java:668)
    at org.hibernate.cfg.CollectionSecondPass.doSecondPass(CollectionSecondPass.java:66)
    at org.hibernate.cfg.Configuration.originalSecondPassCompile(Configuration.java:1597)
    at org.hibernate.cfg.Configuration.secondPassCompile(Configuration.java:1355)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1737)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1788)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBuilder.buildSessionFactory(LocalSessionFactoryBuilder.java:242)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.buildSessionFactory(LocalSessionFactoryBean.java:372)
    at org.springframework.orm.hibernate4.LocalSessionFactoryBean.afterPropertiesSet(LocalSessionFactoryBean.java:357)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.invokeInitMethods(AbstractAutowireCapableBeanFactory.java:1545)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1483) 
```

有谁知道问题出在哪里。我对这项技术没有太多经验，我不确定这篇文章中提供的信息是否足够。

感谢帮助 ！

编辑 ：

这是我的 hibernate.cfg.xml

```
<!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <mapping package="org.mypackage.myapp.model"/>
    <mapping class="org.mypackage.myapp.model.User"/>
    <mapping class="org.mypackage.myapp.model.FileInfo"/>
    <mapping class="org.mypackage.myapp.model.Group"/>
    <mapping class="org.mypackage.myapp.model.FileInfoGroup"/>
  </session-factory>
</hibernate-configuration> 
```

奥利314

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:28:48.830

好的，我终于找到了为什么应用程序在部署过程中会产生错误！。

我可能在配置过程中出错了。我正在配置一个 spring-servlet 文件，但没有看到我的 spring 配置文件夹中还有另一个名为 root-context.xml 的配置文件。它是在我的项目配置期间由 STS 自动生成的（可能是由于我的错误操作），这是服务器用于部署应用程序的文件。在这个文件中，我的会话工厂 bean 没有正确配置。因此，在修复错误后，一切正常。

*注意：我不确定 hibernate.cfg.xml 与 spring 的必要性，因为一切都可以在根 spring 配置文件中进行。在我看来，只有在项目多次定义会话工厂时才有必要。根据 DRY 模式，hibernate.cfg,xml 在这种情况下是相关的。如果我错了，任何人都可以告诉我吗？*

# c - 在 2s 补码中找到最少的位来存储 int

> ID：14676420
> 
> 赞同：0
> 
> 时间：2013-02-03T19:35:50.787
> 
> 标签：c, bit-manipulation

这是我目前正在处理的家庭作业问题。我们要做的是查看传递的 32 位 int x 并返回将这个值存储在 2s 补码中所需的最少位。

例如：

```
howManyBits(0) = 1;
howManyBits(-1) = 1;
howManyBits(7) = 4;
howManyBits(-10) = 5; 
```

问题在于我只能使用按位运算符来找到它，我不能有大于一个字节的常量，而且我总共不能有超过 90 个操作。目前，我能够从最高位一直向右涂抹一个 1，然后我计算其中的每个 1。但是，由于它是一个 32 位的 int，并且每次检查是否有位翻转时，我都必须将 int 向右移动 1，因此对位进行计数的过程本身需要 90 次操作，并且由于位涂抹拿了20，我已经超过了最大操作。

此外，我不会大声在我的解决方案中使用条件或循环。

我知道如果我能找出一个可以解决它的 log_2 算法，但我也无法仅在位运算符中解决这个问题。

我想要的只是提示/解释一个可以在更少的操作中完成的过程，而不是实际的代码解决方案。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:26:05.540

您可以通过 7 次操作找到 32 位数字的 log_2。查看优秀的[Bit Twiddling Hacks](http://graphics.stanford.edu/~seander/bithacks.html#IntegerLogLookup)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:41:32.977

休斯顿 - 你有问题。

IE

```
howManyBits(0) = howManyBits(-1) = 1; 
```

因此，您需要至少 2 位为零。（或-1）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:49:16.220

由于这是家庭作业，我不想给你一个直接的答案，但你在 log2 的想法上走在了正确的轨道上。

您可以通过三个操作的组合将其拉出（对于正数）

```
 1) Shift right 1
 2) Test for 0
 3) Add 1 to a number 
```

希望这足以让你到达那里。由于源数字将是二进制补码，因此您需要先将其转换为正数，以使上述内容生效。

# php - 我需要为所有关联定义模型吗？

> ID：14676421
> 
> 赞同：0
> 
> 时间：2013-02-03T19:36:05.047
> 
> 标签：php, phpactiverecord

如果我有一个用户表和一个电子邮件表，我是否必须定义一个`email.php`模型来定义这个关系`User.php`：

```
static $has_many = array(
      array('emails')
    ); 
```

另外，如果我有一个像电子邮件这样的对象，它可以与可以拥有该对象的其他对象具有外键关系，我如何定义电子邮件可以`belong_to users`AND `belong_to domains`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T11:03:49.723

1.  如果模型使用 phpAR 默认命名约定，则不必定义模型。尽管您可能想要，但如果您使用关联。如果您不定义`Email`模型及其与 的`belongs_to`关系`User`，您将无法访问`User`through `Email`（反之亦然，`Email`通过`User`）

2.  多个`belongs_to`是通过数组实现的：

    ```
    class Email extends ActiveRecord\Model {
        static $belongs_to = array(
            array('user'),
            array('domain')
        );
    } 
    ```

请注意，`belongs_to`您必须使用单数形式，而不是复数形式

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-03T19:41:06.770

你在使用框架吗？

如果不是，您应该为每个模型使用静态吸气剂。

您应该在其数据字段上使用延迟加载。

所以如果你写 email->getUser() 你会得到一个用户对象，它只知道它的 id 并且可以在需要时从数据库中延迟加载数据。

始终要知道自己在做什么（有时最好使用连接来避免 N 次查询（在使用循环或获取数据时会抛出超过 2 个表））。

我建议您不要编写自己的 ORM 或 Active Records 实现，除非您想学习一些东西。

更好地为您的项目使用理论 2 或等效框架。

# java - 使用 DOM 将 XML 解析为 HashMap

> ID：14676423
> 
> 赞同：0
> 
> 时间：2013-02-03T19:36:24.933
> 
> 标签：java, xml, parsing, dom, hashmap

我彻底搜索了我的问题的答案，但没有得到它。我的任务就是这样。我有一个 XML：

```
<?xml version="1.0" encoding="utf-8" ?>
<users>
    <user id="1">
        <login>james.bond</login>
        <password>12345</password>
        <enabled>true</enabled>
    </user>
    <user id="2">
        <login>john.doe</login>
        <password>67890</password>
        <enabled>false</enabled>
    </user>
</users> 
```

我想将它解析为 HashMap ，其中键和值应该是这样的（通过句点的节点名称作为键，这些节点的值作为映射中的值）：

**K：** users.user.1.login **V：** james.bond

**K：** users.user.1.password **V：** 12345

ETC...

就在我拥有的那一刻：

```
public Map<String, String> parse(File file) {
        Document doc = null;

        try {
            DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
            DocumentBuilder db = dbf.newDocumentBuilder();

            dbf.setIgnoringComments(true);

            doc = db.parse(file);
        } catch (ParserConfigurationException pce) {
            System.out.println("Parser was not configured properly [LOG IT!]");
        } catch (IOException io) {
            System.out.println("Cannot read input file [LOG IT!]");
        } catch (SAXException se) {
            System.out.println("Problem parsing the file [LOG I!]");
        } catch (IllegalArgumentException ae) {
            System.out.println("Please specify an XML source [LOG IT!]");
        }

        Element root = doc.getDocumentElement();

        return stepThrough(root);
    }

private Map<String, String> stepThrough(Node node) {
        String nodeName =  node.getNodeName();

        if (!nodeName.equals("#text")) {
            buildedKey.append(nodeName).append(".");
        }

        if (node.getNodeValue() != null && !node.getNodeValue().matches("^\\W*$")) {
            parsedMap.put(buildedKey.toString(),node.getNodeValue());
        }

        if (node.getNodeType() == Node.ELEMENT_NODE) {
            if (node.hasAttributes()) {
                NamedNodeMap startAttr = node.getAttributes();
                for (int i = 0; i < startAttr.getLength(); i++) {
                    Node attr = startAttr.item(i);
                    buildedKey.append(attr.getNodeValue()).append(".");
                }
            }
        }

        for (Node child = node.getFirstChild(); child != null; child = child.getNextSibling()) {
            stepThrough(child);
        }

        return parsedMap;
    } 
```

我的地图中有最后一个键，例如： **users.user.1.login.password.enabled.user.2.login.password.enabled**

换句话说，所有节点名称都是串联的。

你能帮我吗？谢谢！

PS：我有一个限制，我不能使用像 XStream 这样的库......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:45:46.967

问题是您`buildedKey`对所有遍历都使用相同的全局，并且当您返回 from 时不会删除添加的部分`stepThrough`。简单的解决方案是作为参数传递`buildedKey`，而不是使用全局变量：

```
private Map<String, String> stepThrough(Node node, String buildedKey) {
        String nodeName =  node.getNodeName();

        if (!nodeName.equals("#text")) {
            buildedKey += nodeName + ".";
        }

        if (node.getNodeValue() != null && !node.getNodeValue().matches("^\\W*$")) {
            parsedMap.put(buildedKey,node.getNodeValue());
        }

        if (node.getNodeType() == Node.ELEMENT_NODE) {
            if (node.hasAttributes()) {
                NamedNodeMap startAttr = node.getAttributes();
                for (int i = 0; i < startAttr.getLength(); i++) {
                    Node attr = startAttr.item(i);
                    buildedKey += attr.getNodeValue() + ".";
                }
            }
        }

        for (Node child = node.getFirstChild(); child != null; child = child.getNextSibling()) {
            stepThrough(child, buildedKey);
        }

        return parsedMap;
    } 
```

此外，您最好使用`String`for`buildedKey`而不是`StringBuilder`因为`String`它是不可变的，并且您不想在一个节点中破坏 buildedKey 并在另一个节点中使用相同的破坏密钥。

# xcode - 如何通过 xcode “进行安装”？

> ID：14676425
> 
> 赞同：10
> 
> 时间：2013-02-03T19:36:35.280
> 
> 标签：xcode, macos, makefile

我有一个 xcode 项目，它从 OSX 的 C/C++ 源代码构建一个库。有没有办法让 xcode 将库及其头文件安装到 /usr/local/lib 中？

我在 Target > Build Settings 下有以下设置：

*   部署
    *   部署位置 = 是
    *   部署后处理 = 是
    *   安装构建产品位置 = /tmp/projname.dst
    *   安装目录 = /usr/local/lib
    *   跳过安装 = 否

当我执行 Product > Build 时，它会将生成的 .a 并将公共标头添加到 /tmp/projname.dst/ 文件夹中的 include/ 子文件夹中。但是我来自 Makefiles 的土地，我想在这里拥有相当于“make install”的东西（我希望它在尝试将东西放入 /usr/local/include/ 和 /usr/ 时询问我的权限本地/lib/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-05T08:52:31.480

看起来“xcodebuild install”就是你这样做的方式。

# python - 尝试使用python登录时网站返回501

> ID：14676428
> 
> 赞同：0
> 
> 时间：2013-02-03T19:37:10.397
> 
> 标签：python, http, web-scraping, screen-scraping

我说的是这个网站：

[http://www.belegger.nl/mijnbelegger/voorpagina](http://www.belegger.nl/mijnbelegger/voorpagina)

我正在尝试按如下方式登录：

```
def login(self, username, password):
    #form_doc: a lxml.html object
    form_doc = self.browser.getdoc("http://www.belegger.nl/mijnbelegger/voorpagina")
    form_html = form_doc.cssselect("div.loginPanel form")[0]
    form_dict = {inp.get('name') : inp.get('value') for inp in form_html.cssselect("input")}
    form_dict['username'] = username
    form_dict['password'] = password

    #form_dict now contains all the correct inputs and their values

    #then, i precisely copy all the headers of a successful browser login:
    self.add_headers()        

    #what follows is a POST request:
    self.browser.open("http://www.belegger.nl/mijnbelegger/voorpagina", self.browser.urlencode(form_dict))

def add_headers(self):
    headers = {
        'Host' : 'www.belegger.nl',
        'User-Agent' : 'Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:18.0) Gecko/20100101 Firefox/18.0',
        'Accept' : 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',
        'Accept-Language' : 'en-gb,en;q=0.5',
        'Accept-Encoding' : 'gzip, deflate',
        'Referer' : 'http://www.belegger.nl/mijnbelegger/profiel',
        'Content-Length' : '187',
        'Content-Type' : 'text/plain; charset=UTF-8',
        'Connection' : 'keep-alive',
        'Pragma' : 'no-cache',
        'Cache-Control' : 'no-cache'
    }
    for header in headers.items():
        self.browser.opener.addheaders.append(header) 
```

这是产生的请求：

```
POST /mijnbelegger/voorpagina HTTP/1.1
Content-Length: 115
Accept-Language: en-gb,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: close
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:18.0) Gecko/20100101 Firefox/18.0
Host: www.belegger.nl
Referer: http://www.belegger.nl/mijnbelegger/profiel
Pragma: no-cache
Cache-Control: no-cache
Content-Type: application/x-www-form-urlencoded

formtoken=c5851960db739b61bc28afd4f23cec2badacb807&username=xxx&password=xxx&Inloggen=Inloggen 
```

python中的请求几乎与firefox中的请求完全相似，唯一的区别是'connection'标头，它似乎不能通过urllib2更改。

但还有更多：

如果我尝试使用 firefox 插件“live http headers”重新成功登录，我会收到相同的 501 错误。当我使用正确的“formtoken”值时，我什至会得到这个。

那么，这个 501 的原因可能是什么？

# java - 将一个小数除以一个大数，得到 0.0

> ID：14676433
> 
> 赞同：-1
> 
> 时间：2013-02-03T19:37:53.477
> 
> 标签：java, math, double

我正在做一个程序，该程序根据测量的放射性计算前一个时间点的放射性活动。

但是，如果半衰期与经过的时间相比非常大，我会得到 a`0.00`作为答案，然后`A= Ao`至少让我知道直到`(times[i]-times[0])`变大。

例如，如果`(times[i]-times[0]) = 5`我`Thalflife = 6540`想得到`0.00076452599`但是我得到`0.0`的是使用错误类型的两倍，或者`/`是给我问题的命令？

```
private double[]theoreticalVals(double activity) {
   /* below is an implementation of the activity decay 
    * calculation formula A= Ao/2^(t/Thalflife)
    * An array of values will be returned. 
    * The times array defines the length of the array and gives the point in time values
    */
 double Ao= activity; 
 double [] vals = new double[times.length];
 double a; 
 vals[0]=Ao;                            //initial activity
 for(int i = 1; i<times.length;i++){                
   a =(times[i]-times[0])/Hf;       //  
   double lowerhalfterm = Math.pow(.5,a);                   //  2-(^(t/Thalflife))
   vals[i]= Ao/lowerhalfterm;

}                                          // A=Ao/2^(t/Thalflife)

return vals; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:11:15.973

`times`可能是一个整数数组，`Hf`也可能是一个整数。您需要将其中一个变量的声明更改为浮动变量，例如`double`，或者您需要在计算中强制转换其中一个变量。

将声明从：

```
int Hf; 
```

到：

```
double Hf; 
```

或投入计算：

```
(times[i]-times[0])/((double)Hf) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:07:38.637

您将 int 除以 int，因此您使用的是整数除法。要进行双重除法，其中一个操作数至少必须是双精度数：

```
double result = ((double) i1) / i2 
```

# php - PHP 语法（基本）

> ID：14676435
> 
> 赞同：-3
> 
> 时间：2013-02-03T19:38:14.780
> 
> 标签：php, arrays, syntax

是的，我知道这是一个基本问题，但我正在学习 PHP。

```
 $sqlquery = "SELECT * FROM table WHERE data = " . trim($array[$elementnum]);
   echo $sqlquery; //Returns correctly
   $queryresult = mysql_query($sqlquery);  
   var_dump($queryresult);               // returns false
   mysql_fetch_row($queryresult);      //Doesn't Work 
```

我该如何正确地做到这一点？我想从表中选择数据，其中某一列等于我的数组在特定元素处的值。数组和元素 num 都是变量

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:55:06.740

```
var_dump($queryresult);               // returns false
mysql_fetch_row($queryresult);      //Doesn't Work 
```

返回 false是`var_dump`不是有点放弃了？

这意味着您的查询无效！

# arm - ARM Chromebook 上的微控制器开发

> ID：14676437
> 
> 赞同：1
> 
> 时间：2013-02-03T19:38:38.430
> 
> 标签：arm, microcontroller, chromebook

我有一个 ARM Chrombook，想用它来编程微控制器。如果可能的话，我想让 Chromebook 保持正常（不是“开发者”）模式。

这提出了两个问题：

1.  Chromebook 目前仅支持 HID 和大容量存储 USB 配置文件，但大多数微控制器都是使用老式串行（或微型 USB 串行转换）进行编程的。
2.  Chromebook 无法编译代码（无法安装 GCC）。

到目前为止，我发现[mbed](http://mbed.org/)看起来可行，但超出了我的预算。

数字 1 更令人烦恼，因为如果归根结底，我总是可以将 TRRS 耳机/麦克风插孔用作串行 TX/RX 端口。真正的问题是#2。我找到一个（免费/便宜）完全在线的编译器导出十六进制文件的运气为零。

是否存在一些在线 GCC 工具链等价物，还是我坚持在台式计算机上进行开发？

谢谢！

[编辑] 我尝试使用 USB 串行适配器 (Digi Edgeport/8)，但 ChromeOS 无法识别它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:54:07.093

您对开发平台的选择将受到可用工具的严重限制。对于更小众的 uController，您可能会发现几乎没有选择。可以肯定的是，没有一个工具供应商会对支持的 Chromebook 作为一个独特的平台感兴趣，因为它在已经很小的市场中所占的比例很小。同样，基于 Web 服务的工具也非常小众，我很难理解为什么有人会想要它们。

最好的办法是安装 Linux——提供你想在它下运行的开发工具。GCC 当然可以，但对于专有工具，它可能必须是某种 Windows 风格——而且很可能是 XP。

使用 USB 串行加密狗可以轻松克服缺少串行端口的问题。避免在 PL2303 芯片组上构建的加密狗，在这种情况下，有缺陷的驱动程序、芯片甚至可能是设备的邪恶三位一体很常见。基于 FTDI 芯片组的设备看起来更可靠，但价格更高。使用 TRRS 作为串行端口听起来就像一场噩梦：记住控制台界面是您调试系统的方式 - 您需要相信它可以可靠地工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-03-25T04:10:17.937

[如果您愿意使用 Javascript，那么您有一个使用 Espruino http://www.espruino.com/](http://www.espruino.com/)的开箱即用解决方案，它支持许多不同的 ARM M3-Cortex 板，并且可能会在更高版本中这样做在未来结束 AVR。Espruino 实际上有一个 Chrome 打包的应用程序作为其唯一的开发环境，因此即使在离线时也能完全正常运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-08T10:23:19.363

不幸的是，在您的 chromebook 上，usb 串行说起来容易做起来难。似乎 Chrubuntu 没有编译必要的模块（我正在拼命寻找实现这一目标的方法），因此您的 chromebook 在这方面可能完全不行。

# php - 使用 symfony 生成的密码进行 android 身份验证

> ID：14676438
> 
> 赞同：0
> 
> 时间：2013-02-03T19:38:39.813
> 
> 标签：php, android, symfony

我正在使用脚本（使用 symfony 创建）中的 xml 文件导入密码。

我将密码存储在数据库中，但我不知道使用的加密进行比较。

android中是否有相同的加密功能？

谢谢 ：）

# php - 如何检查 '.'[dot] 是否存在于字符串中？strstr 在 php 中不起作用

> ID：14676441
> 
> 赞同：11
> 
> 时间：2013-02-03T19:39:00.003
> 
> 标签：php, strstr

我想看看是否。[dot] 是否存在于字符串中。

我试过 strstr 但它返回 false。

这是我的代码：-

```
<?php
$str = strpos("true.story.bro", '.');
if($str === true)
{
        echo "OK";
} else {
        echo "No";
}
?> 
```

我想看看是否'。是否存在于字符串中，我可以做爆炸，但我想在 1 行中做，我该怎么做？

谢谢

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-02-03T19:41:10.680

您可以直接使用[strpos](http://php.net/manual/fr/function.strpos.php)。

```
if (strpos($mystring, ".") !== false) {
    //...
} 
```

希望这有帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:43:23.667

Strpos 返回第一个参数中第二个参数第一次出现的索引。采用

```
$str !== false 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:43:31.887

您使用 strpos 不正确。它返回字符串第一次出现的整数，`true`如果找到则不返回。

试试这个代码：

```
$str = strpos("true.story.bro", '.');
if($str !== false)
{
    echo "OK";
} else {
    echo "No";
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T19:43:39.147

如果 ”。” 位于字符串的第一个字节处，`strpos`将正确返回零。这不方便地评估等于`false`。像这样颠倒你的逻辑：

```
<?php
$str = strpos("true.story.bro", '.');
if($str === false)
{
        echo "No";
} else {
        echo "OK";
}
?> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-03T19:51:42.063

strpos 的返回值是整数（0 到 strlen(string)-1）或布尔值（假），然后，您可以使用两种情况进行检查：

```
$pos = strpos('this is text with . dot', '.');
if(is_int($pos)){
 echo 'dot is found';
}else{
 echo 'dot not found';
}

or 
if($pos === false){
 echo 'dot not found';
}else{
 echo 'dot found';
}

note strpos('. test', '.') = 0  then is_int(0) ?  true 
```

# python - Django，序列化关系，对象而不是id

> ID：14676442
> 
> 赞同：2
> 
> 时间：2013-02-03T19:39:08.783
> 
> 标签：python, django, orm, django-models

我有关于序列化和关系的问题。我想获取对象而不是对象 ID。(Django 1.4)

这段代码在我看来：

```
serializers.serialize("json", Projects.objects.all(), indent=5, use_natural_keys=True) 
```

序列化项目后，我得到：

```
 [
      {
           "pk": 1, 
           "model": "work.projects", 
           "fields": {
                "count": 3, 
                "date": "2013-02-03T09:43:20.474Z", 
                "client": 1, 
                "status": false, 
                "service": 1
           }
      }
 ] 
```

这是我的模型：

```
 from django.db import models

    class ServicesManager(models.Manager):
        def get_by_natural_key(self, name, price, unit):
            return self.get(name=name, price=price, unit=unit)

    class Services(models.Model):
        objects = ServicesManager()

        name = models.CharField(max_length=200)
        price = models.IntegerField()
        unit = models.CharField(max_length=50)

    class CustomersManager(models.Manager):
        def get_by_natural_key(self, name, city, street, post_code, phone, nip):
            return self.get(name=name, city=city, street=street, post_code=post_code, phone=phone, nip=nip)

    class Customers(models.Model):
        objects = CustomersManager()

        name = models.CharField(max_length=200)
        city = models.CharField(max_length=200)
        street = models.CharField(max_length=200)
        post_code = models.CharField(max_length=100)
        phone = models.CharField(max_length=200)
        nip = models.CharField(max_length=200)

    class Projects(models.Model):
        client = models.ForeignKey(Customers)
        service = models.ForeignKey(Services)
        count = models.IntegerField()
        date = models.DateTimeField(auto_now_add=True)
        status = models.BooleanField(null=False)

        def natural_key(self):
            return (self.count, self.date, self.status,) + self.service.natural_key() + self.client.natural_key()
        natural_key.dependencies = ['work.services', 'work.customers'] 
```

**这是解决方案（模型）：**

```
from django.db import models

class Services(models.Model):
    name = models.CharField(max_length=200)
    price = models.IntegerField()
    unit = models.CharField(max_length=50)

    def natural_key(self):
        return (self.name,self.price,self.unit)

class Customers(models.Model):
    name = models.CharField(max_length=200)
    city = models.CharField(max_length=200)
    street = models.CharField(max_length=200)
    post_code = models.CharField(max_length=100)
    phone = models.CharField(max_length=200)
    nip = models.CharField(max_length=200)

    def natural_key(self):
        return (self.name,self.city,self.street,self.post_code,self.phone,self.nip)

class Projects(models.Model):
    client = models.ForeignKey(Customers)
    service = models.ForeignKey(Services)
    count = models.IntegerField()
    date = models.DateTimeField(auto_now_add=True)
    status = models.BooleanField(null=False)

    def natural_key(self):
        return (self.count, self.date, self.status, self.service.natural_key(), self.client.natural_key()) 
```

**并查看代码（对于 UTF-8）**

```
serializers.serialize("json", Projects.objects.all().filter(pk=1), indent=3, use_natural_keys=True, ensure_ascii=False) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:45:42.180

尝试[DjangoFullSerializers](http://code.google.com/p/wadofstuff/wiki/DjangoFullSerializers)`wadofstuff`。_ 查看有关关系的[文档。](http://code.google.com/p/wadofstuff/wiki/DjangoFullSerializers#Relations)这应该可以完成这项工作。

# javascript - 页面何时加载

> ID：14676444
> 
> 赞同：1
> 
> 时间：2013-02-03T19:39:20.787
> 
> 标签：javascript, jquery

我想要页面加载 10 次时

```
alert ('hello !!'); 
```

如何得到它？

这是我的代码：

```
<html>
<head>
    <title>my problem !!</title>
    <script type="text/javascript">
    var i = 0;
    myfunc = function () {
        if (i++ == 10){
            alert ('hello !!');
        }
    }
    window.onload = myfunc;
    </script>
</head>
<body>
</body>
</html> 
```

谢谢你的帮助：x

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:01:32.780

使用[HTML 5 本地存储](http://diveintohtml5.info/storage.html)：

```
<html>
    <script>
        var visitCount = localStorage["visitCount"];
        visitCount = parseInt(visitCount);

        if (!visitCount) {
            visitCount = 0;
        }

        visitCount = visitCount + 1;

        if (visitCount >= 10) {
            alert("hello!");
            visitCount = 0;
        }

        localStorage["visitCount"] = visitCount;
    </script>

    <body>
        Hi!
    </body>
</html> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:42:31.137

您不能仅使用 javascript 来做到这一点。您需要跟踪使用 cookie 打开页面的次数。每次页面加载时，读取cookie，增加值，检查是否为10。如果是，则输出消息。如果没有，则将新值写入 cookie。或者，您可以使用服务器端代码和会话变量来执行此操作。

# air - 使用 AIR for IOS、Android、Windows 和 OSX 混合 HTML5 和 Flash？

> ID：14676448
> 
> 赞同：0
> 
> 时间：2013-02-03T19:40:02.860
> 
> 标签：air

AIR新手问题。我目前有一个用 flex 编写的单页应用程序。我正在用 HTML5 编写所有新代码。我希望能够将这些集成到一个应用程序中。这显然不是桌面浏览器的问题。主要目标是 iOS 和 Android 平板电脑。桌面应用程序是次要优先级，但也是一个好处。查看 Adob​​e 的文档，很明显我可以使用我的 Flex 应用程序并在 iOS 和 Android 上交付它。但是，当我创建 HTML5 内容时，我需要在 iOS 和 Android 上的单个应用程序中一起交付新旧内容。我可以使用 AIR 将混合 HTML5/flash 代码作为可安装应用程序交付吗？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T00:47:00.560

好吧，不幸的是我仍然没有明白这一点。

但我认为您将不得不将旧内容放入一个非常新的应用程序中。

我没有使用 FlashBuilder 的经验，但我建议您使用 Adob​​e Flash Pro CS6 以获得完整的 IOS 和 Android 兼容性。

从 adobe 网站下载 30 天试用版。

在 CS6 版本中，您需要的扩展（AIR for Android 和 AIR for IOS）已经存在。

对于旧版本，您必须使用谷歌搜索它们。

如果您启动 Adob​​e Flash Pro CS6，您可以选择以下选项之一：

AIR（2.0）：用于桌面（PC 和 OSX）AIR for Android：自我解释 AIR for IOS：你明白了 ^^

因此您可以选择其中之一并开始设计主应用程序。

如果你想把旧的 SWF 放进去，你可以这样做。

对于您已经完成的 html5 内容，您可以使用`HTMLLoader`.

完成第一个项目后，cou 可以简单地将代码和内容复制到一个新项目中，或者您可以为所有 3 种不同的操作系统类型输出该项目。您可能想尝试一些属性，例如宽度和高度、帧模式、权限和类似的东西。

希望你明白了主要的想法。

如果您在嵌入旧内容时遇到问题，那里有大量的教程。

优雅

# python - 使用 PyInstaller 将 setup.py Python 项目转换为二进制文件？

> ID：14676453
> 
> 赞同：8
> 
> 时间：2013-02-03T19:40:19.550
> 
> 标签：python, setuptools, pyinstaller, package-managers, distribute

我有一个使用标准`setup.py`设置描述的项目，其中一些`.py`文件是可执行的（在`scripts=`包的一部分中），一些`.py`文件只是这些脚本文件导入的库。

有没有办法使用 PyInstaller 将此设置转换为一系列二进制文件，`setup.py`以便将脚本描述的每个文件都制成可执行文件？其余的`.py`是内部库，因此当然不需要转换这些库，并且一旦生成二进制文件就没有用处。

澄清一下，我只对制作 Mac OS X 和 Linux 二进制文件感兴趣，而不是 Windows。谢谢。

# ios - 单例潜在泄漏？

> ID：14676457
> 
> 赞同：1
> 
> 时间：2013-02-03T19:40:50.543
> 
> 标签：ios, xcode, singleton, memory-leaks, analyzer

在我项目中的一个第三方库中，单例 sharedInstance 方法似乎在最后的 return_sharedInstance 行上抛出了一个分析器警告：

```
+ (BlockBackground*)sharedInstance
{
    if (_sharedInstance != nil) {
        return _sharedInstance;
    }

    @synchronized(self) {
        if (_sharedInstance == nil) {
            [[[self alloc] init] autorelease];
        }
    }

    return _sharedInstance;
} 
```

无论如何，实际修复此警告的正确方法是什么？我还看到你不应该在这样的方法中进行自我分配，这是真的吗？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T19:47:19.170

实际上，您的行在`[[[self alloc] init] autorelease];`对象上创建并立即将其丢弃。您需要替换为`_sharedInstance = [[self alloc] init];`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T19:45:43.940

这是`autorelease`; 你需要删除它，但更重要的是（感谢@Yaman/@rmaddy）你没有将分配的对象分配给`_sharedInstance`.

会发生的是，下次运行循环结束时，或者下次自动释放池被销毁时，以较早者为准，实例将被释放。`_sharedInstance`指针将悬空*，*并且对象的下一个用户将错误地*发送到已释放实例*（或某些此类）的消息。

# linux - 删除所有具有相似模式且日期小于特定日期的文件

> ID：14676462
> 
> 赞同：1
> 
> 时间：2013-02-03T19:41:14.197
> 
> 标签：linux, unix, sunos

我正在尝试从 Unix 目录中删除文件，该目录以`EXPORT_v1x0`2013-01-25（2013 年 1 月 25 日）开头且日期小于 2013-01-25。我可以一个一个地删除文件，但我需要几天时间才能删除所有文件。有没有更好的方法来删除具有特定模式的文件？

以下是我执行 ls 时的示例文件

```
bash-3.00$ ls /data/bds/real
EXPORT_v1x0_20120811.dat.gz 
EXPORT_v1x0_20120811.dat.gz 
```

如果你看到上面的文件。每个文件都有一个日期。假设我们考虑这个文件——

```
EXPORT_v1x0_20120811.dat.gz 
```

它的日期是`20120811`所以我需要删除所有以 开头`EXPORT_v1x0`且日期小于`20130125`. 因此，如果我应该删除所有日期小于`20130125`的文件，那么我上面提到的所有文件都将被删除，因为日期小于`20130125`.

**注意：-**所有文件都具有与我上面提到的完全相同的模式。只有日期和后面的其他数字不同。

所以我只需要删除所有以 开头`EXPORT_v1x0`且日期小于`20130125`.

我正在跑步`SunOS`。我仍在更好地学习 Unix。所以不确定任何高端命令和脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:52:27.073

解决问题的第一种天真的方法，根据您的需要调整它：

```
find . | awk -F'_' '$3<20130125' | xargs rm 
```

为了防止`find`进行递归搜索并留在当前文件夹中：

```
find . \( ! -name . -prune \) -type f | ... 
```

*第二次更新：*

将`name`参数添加到仅列出包含字符串“EXPORT_v1x0”的文件

```
find . \( ! -name . -prune \) -type f -name "EXPORT_v1x0*" | ... 
```

`find`实现非递归的更简单方法是使用`maxdepth`标志

```
find . -maxdepth 1 -type f -name "EXPORT_v1x0*" | ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:52:07.780

**警告：要非常小心**

您可以像这样列出所需的文件：

```
ls -1 | awk -F _ '$3<"20130125"' 
```

如果这给出了正确的文件列表，你可以这样做

```
ls -1 | awk -F _ '$3<"20130125"' | xargs rm 
```

# mongodb - Mongo 在多个字段上选择不同的 + 通用架构

> ID：14676467
> 
> 赞同：1
> 
> 时间：2013-02-03T19:41:54.397
> 
> 标签：mongodb, aggregation-framework

我目前正在学习 MongoDB，但遇到了一些问题。

对于一个项目，我使用的是 SQL，我有 3 个表：Artist、Album、Song。

然后我决定换成 Mongo，因为我有很多行，也因为我很好奇......

在 Mongo 中，我只有一首合集 Song，其中包含所有内容：

*   曲目名称
*   艺术家姓名
*   艺术品
*   文件夹
*   专辑名
*   专辑日期

首先我想知道这个结构是否正确，或者我是否应该为我在 SQL 中拥有的每个表创建集合？我的主要目标是能够搜索 artistName="something" 和 trackName="something_else"... 通过简单的查找，它的工作速度非常快！:)

但是，我还需要一个页面来显示所有艺术家及其链接（文件夹），这是我的问题：我想显示所有艺术家，按艺术家姓名排序，以 A 开头（例如）并获取每个艺术家的文件夹。 ..

我试过这个：

```
$cursor =$collection->distinct("artistName", array( "artistName" => $regex)); 
```

这工作正常，但我需要`folder`..

然后我尝试了这个：

```
$ops = array(
    array(
        '$project' => array(
            "artistName" => 1,
            "folder"   => 1,
        )
    ),
    array('$match' => array( "artistName" => $regex)),
    array('$group' => array(
                        '_id'=>'$artistName',
                        "artistName" => array('$first' => '$artistName'),
                        "folder" => array('$first' => '$folder')
                        ),
    array('$sort' => array('artistName'=>-1)),
    )
);

$results = $collection->aggregate($ops); 
```

没有排序但排序我有以下错误：

```
Pipeline::run(): unrecognized pipeline op "0' 
```

所以我的问题是做我需要的最好的方法是什么？

非常感谢，瓦伦丁

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T06:13:40.453

[结构很好，在这种情况下简单是一件好事。你可以在这里](http://docs.mongodb.org/manual/core/data-modeling/)查看如何在 mongodb 中设计 dm 的教程。对于您编写的提案，我将选择聚合框架，并且在您编写的语法中存在导致问题的错误，您在 $groups 数组的括号内编写了 $sort。试试这个：

```
$ops = array(
    array('$project' => array(
                          "artistName" => 1,
                          "folder"   => 1,
                          )
         ),
    array('$match' => array( "artistName" => $regex)),
    array('$group' => array(
                        '_id'=>'$artistName',
                        "artistName" => array('$first' => '$artistName'),
                        "folder" => array('$first' => '$folder')
                        )
         ),
    array('$sort' => array('artistName'=>-1))
    ); 
```

这里面也有一点概念上的错误。由于关系是多对多的，我猜文件夹和艺术家之间的结构只会给你艺术家匹配的第一个文件夹。还有“艺术家姓名”=> 数组（'$first' => '$artistName'），我猜你喜欢拥有另一个包含艺术家姓名的字段，它与 _id 相同。在组运算符数组中，与 gourping 函数的键相关的 _id 作为 SQL 中的 GROUP BY 字段。你可以在[这里](http://docs.mongodb.org/manual/reference/aggregation/group/#_S_group)查看操作。

对于你的情况，我会使用：

```
$ops = array(
    array('$match' => array( "artistName" => $regex)),
    array(
        '$project' => array(
            "artistName" => 1,
            "folder"   => 1,
        )
    ),
    array('$group' => array(
                        '_id'=>array('artistName' => '$artistName', 
                                     'folder' => '$folder')
                        )),
    array(
        '$project' => array(
            "_id" => 0,
            "artistName" => '$_id.artistName',
            "folder"   => '$_id.folder',
        )
    ),
    array('$sort' => array('artistName'=>-1))
); 
```

# jquery - 如何使用 Jquery 从 UL 列表中仅选择悬停的项目

> ID：14676475
> 
> 赞同：3
> 
> 时间：2013-02-03T19:42:37.377
> 
> 标签：jquery, mysql, slider, jquery-animate, thumbnails

好的，所以我有一个无序列表，它是通过从 JSON 对象附加 li 构建的。当我将鼠标悬停在 UL 上时，我想要做的是仅从 UL 中选择当前 LI。我可以像选择 :first LI 或最后一个或偶数或赔率或其他任何东西一样接近，但我无法让它在从列表中选择的项目上进行转换。

最终目标是产生一种效果，即在 LI 悬停时将循环执行来自 MySql 数据库的多个操作（但我离实现这一目标还很遥远）。任何帮助将不胜感激。这是我的代码：

```
$("#thumbnails").hover(function(){
$('#thumbnails > li:first').text("Whats 2 + 2");
}); 
```

我知道这段代码是错误的，如果我只选择 LI 将更改其中每一个的文本。

UL 被命名为 thumbnails，并从另一个 CSS 样式表中获取它的基础

```
<ul name="thumbnails" id="thumbnails">

</ul> 
```

最后，我基本上希望构建这样的东西 [http://www.melonhtml5.com/demo/metro_gallery/demo2.php](http://www.melonhtml5.com/demo/metro_gallery/demo2.php)

除了它将滚动来自 MySql 数据库而不是图像的项目。这甚至可能吗？

如果您知道我可以购买的代码示例，而不必从头开始构建它，那么您将获得主要奖励积分。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:10:00.850

我不确定我是否知道你在问什么，但听起来你想对悬停在上面的 LI 做一些事情，而不将事件处理程序绑定到每个事件处理程序。

如果是这种情况，那么您可以使用该`on`方法来查看列表，然后像这样监听其特定的 LI 子级：

```
$("#myList").on("mouseenter", "li", function () {
     //do stuff here
});

$("#myList").on("mouseleave", "li", function () {
    //stop doing stuff here
}); 
```

[这是一个例子](http://jsfiddle.net/tbwIII/pcEL9/)

更多[关于 jQuery on 方法](http://api.jquery.com/on/)

# nhibernate - LINQ NHibernate-为什么我在 HAVING 子句中得到 Column 'is invalid？

> ID：14676480
> 
> 赞同：0
> 
> 时间：2013-02-03T19:42:58.917
> 
> 标签：nhibernate, linq-to-sql

我想获取表中的最后一个条目并将它们与另一个表连接以生成不匹配的条目。

我收到以下错误

```
Column is invalid in the HAVING clause 
because it is not contained in either 
an aggregate function or the GROUP BY clause 
```

运行以下命令时适用于 CFWD 和 Balance

```
var lastEntries = from s in session.Query<Statement>()
                  group s by s.Customer.Id into grp
                  select grp.OrderByDescending(g => g.Id).First();

 var customers = session.Query<Customer>();

 var balances = from s in lastEntries 
                join c in customers on s.Customer.Id equals c.Id 
                where s.Customer.Balance !=  s.CFwd
                select s ;

 foreach (var line in balances )
 {
     ...
 } 
```

但是，在[LiNQPad](http://www.linqpad.net/)中进行相同测试会产生预期的结果而不会出现错误

```
var lastEntries = from s in Statements
                  group s by s.Customer.Id into grp
                  select grp.OrderByDescending(g => g.Id).First();

var customers = from s in  Customers select s;

var balances = from s in lastEntries 
       join c in Customers on s.Customer.Id equals c.Id 
       where c.Balance !=  s.CFwd 
       select s;

 balances .Dump(); 
```

**更新**

以下是NHibernate生成的SQL语句

```
select statement0_.Id as Id0_, 
statement0_.TransactionDate as Transact2_0_, 
statement0_.RefNo as RefNo0_, 
statement0_.Description as Descript4_0_, 
statement0_.BFwd as BFwd0_, 
statement0_.Amount as Amount0_, 
statement0_.CFwd as CFwd0_, 
statement0_.TransactionTypeId as Transact8_0_, 
statement0_.CustomerId as CustomerId0_ 
from Statement statement0_, Customer customer1_ 
where customer1_.Id=statement0_.CustomerId
group by statement0_.CustomerId 
having customer1_.Balance<>statement0_.AmountCFwd 
```

而 LINQPad 生成以下内容

```
SELECT [t5].[test], [t5].[Id], [t5].[TransactionDate], 
[t5].[CustomerId], [t5].[RefNo], [t5].[Description], 
[t5].[BFwd], [t5].[Amount], [t5].[CFwd], 
[t5].[TransactionTypeId]
FROM (
    SELECT [t1].[Id]
    FROM [Statement] AS [t0]
    INNER JOIN [Customer] AS [t1] ON [t1].[Id] = [t0].[CustomerId]
    GROUP BY [t1].[Id]
    ) AS [t2]
OUTER APPLY (
    SELECT TOP (1) 1 AS [test], [t3].[Id], [t3].[TransactionDate], 
     [t3].[CustomerId], [t3].[DocRefNo], [t3].[Description], 
     [t3].[BFwd], [t3].[Amount], [t3].[CFwd], 
     [t3].[TransactionTypeId]
    FROM [Statement] AS [t3]
    INNER JOIN [Customer] AS [t4] ON [t4].[Id] = [t3].[CustomerId]
    WHERE [t2].[Id] = [t4].[Id]
    ORDER BY [t3].[Id] DESC
    ) AS [t5]
INNER JOIN [Customer] AS [t6] ON (
    SELECT [t7].[Id]
    FROM [Customer] AS [t7]
    WHERE [t7].[Id] = [t5].[CustomerId]
    ) = [t6].[Id]
WHERE [t6].[Balance] <> [t5].[CFwd]
ORDER BY [t5].[Id] DESC 
```

我尝试重新排列语句以允许分组，但似乎没有正确。

哪个是可以防止错误的正确语法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T03:18:40.493

事实证明，我在考虑 SQL 方式而不是对象。我需要的唯一声明是

```
var lastEntries = from s in session.Query<Statement>()
              group s by s.Customer.Id into grp
              select grp.OrderByDescending(g => g.Id).First(); 
```

并为 Statement 对象的所有列添加分组，如下所示

```
var lastEntries = from s in session.Query<Statement>()
              group s by new 
                    {
                       s.Customer
                      , s.Id
                       ...
                    } into grp
              select grp.OrderByDescending(g => g.Id).First(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:14:25.130

我认为这可能是一个简单的错字的问题。

在您在 LinqPad 中工作的示例中，您的 where 子句与 join 进行比较`Customers`。

但是，在您的 LinqToNHibernate 示例中，您的 where 子句与`s`from`lastEntries`而不是join customer 进行比较`c`。

所以也许对于你的 NHibernate 例子，你只需要做

```
var balances = from s in lastEntries 
            join c in customers on s.Customer.Id equals c.Id 
            where c.Balance !=  s.CFwd
            select s ; 
```

# php - 进行 CodeIgniter 数据库查询

> ID：14676485
> 
> 赞同：4
> 
> 时间：2013-02-03T19:43:35.267
> 
> 标签：php, sql, codeigniter, activerecord

有人可以帮助我使用 Codeigniter 活动记录完成此查询吗？：

我有一个包含两个值的 int 数组：

```
 $prices =  array( 
       [0] => 23,
       [1] => 98
       );
 how i can make something like : 

return $this->db->query("select * from product where price IN (?)", array(implode(',',$prices))->result(); 
```

请提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:46:31.637

试试这个（未经测试）

```
$query = $this->db->from('product')
                  ->where_in('price', implode(',',$prices))
                  ->get(); 
```

[CodeIgniter Active Record 文档](http://ellislab.com/codeigniter/user-guide/database/active_record.html)非常好，因此您绝对应该阅读它。例如，您会注意到该`select()`方法是不必要的，因为我们希望所有项目都是如此`*`假设的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:12:23.697

试试这个

```
return  $this->db->query("select * from product where price IN ('". implode(',',$prices)->result()."' )"); 
```

# ipad - 如何在 iPad 上使用 fastClick + AngularJS

> ID：14676488
> 
> 赞同：4
> 
> 时间：2013-02-03T19:43:44.527
> 
> 标签：ipad, angularjs

使用 AngularJS 在 iPad 上单击 ng-click 时有延迟 我有需要编写的生成指令

```
my_app.directive 'touch', ->
  (scope, e, attr) ->
    e.fastClick (e) ->
      scope.$apply attr.fastClick 
```

但它不知道 fastClick 是什么，即使我已将它包含在我的应用程序中。我认为它需要作为服务创建，然后注入到我的指令中，但是如何？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-08T19:36:29.883

以防万一其他人发现这个，谁不使用咖啡脚本，这里是转换

```
 app.directive("ngTap", function() {
  return function($scope, $element, $attributes) {
    var tapped;
    tapped = false;
    $element.bind("click", function() {
      if (!tapped) {
        return $scope.$apply($attributes["ngTap"]);
      }
    });
    $element.bind("touchstart", function(event) {
      return tapped = true;
    });
    $element.bind("touchmove", function(event) {
      tapped = false;
      return event.stopImmediatePropagation();
    });
    return $element.bind("touchend", function() {
      if (tapped) {
        return $scope.$apply($attributes["ngTap"]);
      }
    });
  };
}); 
```

它是 gfTop，因为示例是“好电影”应用程序。随意将其更改为您喜欢的任何内容。

另请注意，您必须将所有“ng-click”更改为“gfTap”。

更新：处理点击和点击事件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-03T22:15:34.483

在没有外部库的情况下实现自己的点击指令非常简单。我会建议。

Goodfilms 在他们关于 AngularJS 移动应用程序的博客文章中对此进行了讨论：http: [//goodfil.ms/blog/posts/2012/08/13/angularjs-and-the-goodfilms-mobile-site-part-1/](http://goodfil.ms/blog/posts/2012/08/13/angularjs-and-the-goodfilms-mobile-site-part-1/)

这是他们的点击代码（也在 Coffeescript 中），直接来自博客文章：

```
app.directive 'gfTap', ->
  (scope, element, attrs) ->
    tapping = false
    element.bind 'touchstart', -> tapping = true
    element.bind 'touchmove', -> tapping = false
    element.bind 'touchend', -> scope.$apply(attrs['gfTap']) if tapping 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-08-02T12:37:05.007

AngularJS 1.1.5 附带了一个处理触摸事件的内置 ng-click 指令。

文档：[http ://code.angularjs.org/1.1.5/docs/api/ngMobile.directive:ngClick](http://code.angularjs.org/1.1.5/docs/api/ngMobile.directive:ngClick)

来源：[https ://github.com/angular/angular.js/blob/master/src/ngMobile/directive/ngClick.js](https://github.com/angular/angular.js/blob/master/src/ngMobile/directive/ngClick.js)

我强烈建议不要自己实施这样的指令 - 有许多边缘情况可能会中断（鬼点击等）。查看上面引用的代码，了解更多需要处理的边缘情况示例。

# codeigniter - codeigniter 路由段使用 nginx 错误地将破折号转换为下划线

> ID：14676489
> 
> 赞同：0
> 
> 时间：2013-02-03T19:43:52.587
> 
> 标签：codeigniter

我在运行 nginx 1.3.8 的服务器上遇到了一个奇怪的 codeigniter 2 问题。我的 uri 段中的破折号作为下划线被路由到我的控制器方法：

网址：[http ://myserver.com/dothis/some-slug-with-dashes/someid](http://myserver.com/dothis/some-slug-with-dashes/someid)

在 routes.php 中：

```
$route['^dothis/(.+)/(.+)$'] = "mycontroller/dothis/$1/$2"; 
```

在 mycontroller.php

```
function dothis($slug, $id) {
  // echo $slug shows a value of "some_slug_with_dashes"
} 
```

apache 网络服务器上的相同代码按预期工作（破折号仍然是破折号）。

我做了一些跟踪和调试，发现问题出现在 core/Router.php 的 _parse_routes() 和 _set_segments() 函数周围。Router.php 的第 389 行是

```
return $this->_set_request(explode('/', $val)); 
```

在这里回显 $val 的值表明它是`/mycontroller/dothis/some-slug-with-dashes/F3e`.

输出explode()的值显示

```
Array
(
    [0] => mycontroller
    [1] => dothis
    [2] => some-slug-with-dashes
    [3] => someid
) 
```

跟踪执行到 _set_request()，如果我插入一行来输出`$segments`参数的值：

```
function _set_request($segments = array())
{
    echo "\n<br/>_set_request() segments: <pre>";print_r($segments);echo "</pre>"; // inserted debug
    $segments = $this->_validate_request($segments);
    ...
} 
```

我得到的调试输出是

```
_set_request() segments:

Array
(
    [0] => mycontroller
    [1] => dothis
    [2] => some_slug_with_dashes
    [3] => someid
) 
```

如果我回显额外的调试输出`$this->uri->segments`，`$this->uri->rsegments`我会得到：

```
// $this->uri->segments
Array
(
    [0] => dothis
    [1] => some-slug-with-dashes
    [2] => someid
)

// $this->uri->rsegments
Array
(
    [0] => mycontroller
    [1] => dothis
    [2] => some_slug_with_dashes
    [3] => someid
) 
```

我检查了我的 codeigniter uri 允许的字符，这是默认设置。我还检查了 nginx 和 fastcgi 参数，它们是基本规则。我还搜索了 stackoverflow 问题和 nginx 论坛。php 在调用之前显示正确的值`_set_request()`但在`_set_request() param`.

有没有人知道或有一些关于可能导致这种情况发生的建议的想法？

更新 - 我的 nginx 配置如下：

nginx.conf：

```
user  nginx;
worker_processes  1;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;

events {
    worker_connections  1024;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;

    log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '
                      '$status $body_bytes_sent "$http_referer" '
                      '"$http_user_agent" "$http_x_forwarded_for"';

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #tcp_nopush     on;

    keepalive_timeout  35;

    # limit num of requests from single IP to 5req/s
    limit_req_zone $binary_remote_addr zone=flood:10m rate=5r/s;

    ##########################################################

    # load gzip settings
    include /etc/nginx/conf.d/gzip.conf;

    # load geoip
    include /etc/nginx/conf.d/geoip.conf;

    ##########################################################

    # load all vhosts
    include /etc/nginx/sites-enabled/*.conf;
} 
```

php.conf：

```
location ~ \.php {
    #fastcgi_pass unix:/tmp/php5-fpm.sock;
    #fastcgi_pass 127.0.0.1:9000;
    fastcgi_pass   php;

    fastcgi_buffers 16 16k;
    fastcgi_buffer_size 32k;

    fastcgi_param  QUERY_STRING       $query_string;
    fastcgi_param  REQUEST_METHOD     $request_method;
    fastcgi_param  CONTENT_TYPE       $content_type;
    fastcgi_param  CONTENT_LENGTH     $content_length;

    fastcgi_param  PATH_INFO          $fastcgi_script_name;
    fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;
    fastcgi_param  SCRIPT_FILENAME    $document_root$fastcgi_script_name;
    fastcgi_param  REQUEST_URI        $request_uri;
    fastcgi_param  DOCUMENT_URI       $document_uri;
    fastcgi_param  DOCUMENT_ROOT      $document_root;
    fastcgi_param  SERVER_PROTOCOL    $server_protocol;

    fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;
    fastcgi_param  SERVER_SOFTWARE    nginx;

    fastcgi_param  REMOTE_ADDR        $remote_addr;
    fastcgi_param  REMOTE_PORT        $remote_port;
    fastcgi_param  SERVER_ADDR        $server_addr;
    fastcgi_param  SERVER_PORT        $server_port;
    fastcgi_param  SERVER_NAME        $server_name;

    ### SET GEOIP Variables ###
    fastcgi_param GEOIP_COUNTRY_CODE    $geoip_country_code;
    fastcgi_param GEOIP_COUNTRY_CODE3   $geoip_country_code3;
    fastcgi_param GEOIP_COUNTRY_NAME    $geoip_country_name;
    fastcgi_param GEOIP_CITY_COUNTRY_CODE   $geoip_city_country_code;
    fastcgi_param GEOIP_CITY_COUNTRY_CODE3  $geoip_city_country_code3;
    fastcgi_param GEOIP_CITY_COUNTRY_NAME   $geoip_city_country_name;
    fastcgi_param GEOIP_REGION              $geoip_region;
    fastcgi_param GEOIP_CITY                $geoip_city;
    fastcgi_param GEOIP_POSTAL_CODE         $geoip_postal_code;
    fastcgi_param GEOIP_CITY_CONTINENT_CODE $geoip_city_continent_code;
    fastcgi_param GEOIP_LATITUDE            $geoip_latitude;
    fastcgi_param GEOIP_LONGITUDE           $geoip_longitude;
} 
```

我的虚拟主机配置：

```
upstream php {
    server 127.0.0.1:8004;
}

server {
    listen 80;
    server_name  myserver.com;
    return       301 http://www.myserver.com$request_uri;
}

server {
    server_tokens off;
    listen 80;
    server_name www.myserver.com;

    root /var/www/sites/com.mysite/httpdocs;
    access_log /var/www/sites/com.mysite/logs/access.log;
    error_log /var/www/sites/com.mysite/logs/error.log;

    index index.html index.php;

       location /test {
                auth_basic "Restricted";
                auth_basic_user_file /var/www/sites/com.mysite/.htpasswd;
       }

    location / { 
        # if you're just using wordpress and don't want extra rewrites
        # then replace the word @rewrites with /index.php
        try_files $uri $uri/ @rewrites;
    }

    location @rewrites {
        # Can put some of your own rewrite rules in here
        # for example rewrite ^/~(.*)/(.*)/? /users/$1/$2 last;
        # If nothing matches we'll just send it to /index.php
        rewrite ^ /index.php last;
    }

    # This block will catch static file requests, such as images, css, js
    # The ?: prefix is a 'non-capturing' mark, meaning we do not require
    # the pattern to be captured into $1 which should help improve performance
    #location ~* \.(?:ico|css|js|gif|jpe?g|png|txt|xml)(\?[0-9]+)?$ {
    location ~* \.(?:ico|css|js|gif|jpe?g|png|txt|xml)$ {
        # Some basic cache-control for static files to be sent to the browser
        expires max;
        add_header Pragma public;
        add_header Cache-Control "public, must-revalidate, proxy-revalidate";
    }

    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/html;
    }

    include /etc/nginx/conf.d/php.conf;
    include /etc/nginx/conf.d/drop.conf;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T19:18:55.497

我找到了问题 - 开发人员错误！结果发现部署脚本没有从 nginx 服务器中正确删除旧的错误 MY_Router.php 文件（该文件在本地不存在，也不存在于 apache 安装中）。很抱歉误报 - codeigniter、nginx 和 php-fpm 正在按预期工作。开发人员（我）不在这种情况下。

# ruby-on-rails - 导入aptana studio后设计不工作

> ID：14676494
> 
> 赞同：0
> 
> 时间：2013-02-03T19:44:16.890
> 
> 标签：ruby-on-rails, ruby, devise, aptana

将项目导入 Aptana Studio 工作区后，我发现启动服务器设计插件后不起作用。

```
undefined method `admin_signed_in?' 
```

它显示超时我想加载任何使用设计功能的控制器。

我试过。`bundle install` `gem update rails`还尝试重新安装插件。重新启动服务器。因此，但似乎没有任何效果。

在我的办公室 PC 上，项目运行良好，但我想在家里添加一些东西，但无法正常工作。

**宝石文件**

```
gem 'devise'
gem "paperclip", :git => "http://github.com/thoughtbot/paperclip.git" 
```

和其他内置的东西。

我希望有人能帮忙。

埃德加斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T10:20:33.920

基于[https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role](https://github.com/plataformatec/devise/wiki/How-To:-Add-an-Admin-role)， routes.rb 应包含以下行：

```
devise_for :admins 
```

# jquery - 需要两个选框，但他们一直在克隆

> ID：14676497
> 
> 赞同：2
> 
> 时间：2013-02-03T19:44:50.533
> 
> 标签：jquery, css, html

我对 jQuery 很陌生，如果我怀疑答案很简单，请提前道歉。

我一直试图让两个选框运行，一个在另一个下面。然而，他们一直在克隆，所以我最终得到了四个。我该如何解决这个问题？

我的 html 文档如下所示：

```
<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="jquery.marquee.js"></script>
<script>
        $(function(){
            $('.marquee').marquee({
                //speed in milliseconds of the marquee
                speed: 350000,
                //gap in pixels between the tickers
                gap: 50,
                //gap in pixels between the tickers
                delayBeforeStart: 0,
                //'left' or 'right'
                direction: 'left'
            });
        }); 
</script>
<style type="text/css">
        body {
          font-family:Verdana, Geneva, sans-serif;
          color: #FFF;
          background-color: #333;
        }

        .marquee {
margin-top: 150px;
width: 1580px;
overflow: hidden;
border:0px;
line-height:300px;
font-size:64pt;
vertical-align: top;
position: absolute;
left: 11px;
        }

        .marquee p {    
        margin-top: 10px;
        line-height:100px;
        }

        price {
            font-size:54pt; 
            color: #CCC;
            vertical-align: baseline;
            font-size: 54pt;
            position: relative;
            bottom: -50pt;
        }
</style>
<title>  </title>
</head>

<body>
<div class='marquee'>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

AAPL<price>586.92 <img src="down.png"> -9.62</price> 
GOOG<price>690.00 <img src="up.png"> +2.41</price> 
IBM<price>195.3375 <img src="down.png"> -1.81</price> 
MSFT<price>29.695 <img src="up.png"> +0.18</price> 
AMZN<price>234.60 <img src="up.png"> +2.46</price> 
PM<price>87.67 <img src="up.png"> +0.08</price> 
QCOM<price>59.67 <img src="down.png"> -0.06</price> 
SLB<price>69.25 <img src="down.png"> -0.90</price> 
ORCL<price>31.50 <img src="up.png"> +0.02</price> 
KO<price>37.3067 <img src="down.png"> -0.02</price> 
XOM<price>90.56 <img src="down.png"> -1.02</price> 
PFE<price>24.82 <img src="up.png"> +0.27</price> 
GE<price>21.4799 <img src="up.png"> +0.14</price> 
CVX<price>108.66 <img src="down.png"> -2.80</price> 

<p>

FITB<price>14.45 <img src="down.png"> -0.11</price> 
DFS<price>41.35 <img src="up.png"> +0.03</price> 
EIX<price>47.02 <img src="up.png"> +0.31</price> 
GRA<price>66.09 <img src="up.png"> +0.28</price> 
M<price>40.95 <img src="up.png"> +0.43</price> 
AON<price>55.18 <img src="up.png"> +0.38</price> 
BXP<price>107.16 <img src="up.png"> +0.70</price> 
CNP<price>21.69 <img src="down.png"> -0.05</price> 
NBL<price>95.07 <img src="down.png"> -0.33</price> 
APC<price>70.68 <img src="up.png"> +0.34</price> 
AYI<price>64.69 <img src="down.png"> -1.40</price> 
</p>
</div>

</body>
</html> 
```

我上面提到的 jQuery marquee 脚本 (jquery.marquee.js) 是 Aamir Afridi 的，见下文：

```
/**
 * jQuery.marquee - scrolling text horizontally
 * Date: 11/01/2013
 * @author Aamir Afridi - aamirafridi(at)gmail(dot)com | http://www.aamirafridi.com
 * @version 1.0
 */

;(function($) {
$.fn.marquee = function(options) {
    return this.each(function() {
        // Extend the options if any provided
        var o = $.extend({}, $.fn.marquee.defaults, options),
            $this = $(this),
            $marqueeWrapper,
            elWidth;

        //check if element has data attributes. They have top priority
        o = $.extend({}, o, $this.data());

        //wrap inner content into a div
        $this.wrapInner('<div class="js-marquee"></div>');

        //Make copy of the element
        $this.find('.js-marquee').css({
            'margin-right': o.gap, 
            'float':'left'
        }).clone().appendTo($this);

        //wrap both inner elements into one div
        $this.wrapInner('<div style="width:100000px" class="js-marquee-wrapper"></div>');

        //Save the width of the each element so we can use it in animation
        elWidth = $this.find('.js-marquee:first').width() + o.gap;

        //Save the reference of the wrapper
        $marqueeWrapper = $this.find('.js-marquee-wrapper');

        //Animate recursive method
        var animate = function() {
            //Move to zero possition
            $marqueeWrapper.css('margin-left', o.direction == 'left' ? 0 : '-' + elWidth + 'px');
            //Start animating to wards left
            $marqueeWrapper.animate({
                    'margin-left': o.direction == 'left' ? '-' + elWidth + 'px' : 0
                },
                o.speed, 'linear',
                animate
            );
        };

        //Starts the recursive method
        setTimeout(animate, o.delayBeforeStart);

    });
};//End of Plugin

// Public: plugin defaults options
$.fn.marquee.defaults = {
    //speed in milliseconds of the marquee
    speed: 10000,
    //gap in pixels between the tickers
    gap: 20,
    //gap in pixels between the tickers
    delayBeforeStart: 1000,
    //'left' or 'right'
    direction: 'left'
};
})(jQuery); 
```

[您可以在这里](http://lilyjen.com/investors/exhibition-ticker/index.html)看到它的实际效果。

再次非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:16:45.270

您有四行，因为您的内容对于您设置的宽度来说太宽，对于插件在其容器 div 中使用的宽度也太宽。所以它会环绕并给你额外的行。您可以将您的品牌类别更改为：

```
.marquee {
  margin-top: 150px;
  white-space:nowrap;
  overflow: hidden;
  border:0px;
  line-height:300px;
  font-size:64pt;
  vertical-align: top;
  position: absolute;
  left: 11px;
} 
```

我取出您的`width`并添加了`white-space: nowrap`，因此您的文本不会垂直换行并沿页面向下流动。此外，在插件代码中，您需要更改此行：

```
//wrap both inner elements into one div
$this.wrapInner('<div style="width:100000px" class="js-marquee-wrapper"></div>'); 
```

对此：

```
//wrap both inner elements into one div
$this.wrapInner('<div class="js-marquee-wrapper"></div>'); 
```

您可以完全删除宽度样式，它似乎工作正常。如果你不想编辑插件代码，你也可以添加这个样式来覆盖宽度：

```
.js-marquee-wrapper {
  width: auto !important;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T14:51:59.170

我开发了这个插件。这旨在具有简单的滚动内容。我可以看到您有很多元素，包括默认情况下`<p>`具有`display:block`的元素，因此这会使内容推送到下一行。

最简单的解决方案是将其添加到您的 css 中：

```
.marquee p {
  display: inline;
} 
```

在行动中查看它[http://jsfiddle.net/aamir/R464v/2/](http://jsfiddle.net/aamir/R464v/2/)

所以在你的演示中：

```
.marquee p {    
    margin-top: 10px;
    line-height:100px;
    display: inline; /* <============ ADD THIS TO YOUR CSS */
} 
```

这应该是诀窍；）

我通过删除一些 html 但保持相同的结构使您的示例更简单。[试试这个](http://jsfiddle.net/R464v/6/)

# c# - MEF 和工厂，直接导入创建的对象

> ID：14676503
> 
> 赞同：1
> 
> 时间：2013-02-03T19:45:06.817
> 
> 标签：c#, import, mef, factory

我已经开始与 MEF 合作。在我的应用程序中，我有一些模型的工厂。我的工厂有 2 种创建方法；一个接受名称作为参数，另一个接受类型。

```
[Export(typeof(IFactory))]
[PartCreationPolicy(CreationPolicy.Shared)]
public class MyFactory : IFactory
{
    public IModel Create(String name) {...}
    public IModel Create(Type type) {...}
}

public class Foo
{
    [Import(typeof(IFactory))]
    public IFactory Factory { get; set; }

    public Foo()
    {
        IModel modelByName = Factory.Create("name");
        IModel modelByType = Factory.Create(typeof(Foo));
    }
} 
```

目前我必须导入一个工厂，然后在工厂对象上调用 create 来获取模型。现在我想知道是否有办法直接导入模型，例如：

```
[Import(typeof(IModel), Name:"Name")]
public IModel Model { get; set; } 
```

编辑 - - - - - - - - - - - - - - - - - - - - - - - - - --

目标是替换如下内容：

```
public class Foo
{
    [Import(typeof(IFactory))]
    public IFactory Factory { get; set; }

    public IModel Model { get; set; }
    public IModel Model1 { get; set; }

    public Foo()
    {
        Model = Factory.Create("Foo");
        Model1 = Factory.Create(typeof(Foo1));
    }
} 
```

像这样的东西：

```
public class Foo
{
    //Should internal import a IFactory(singeleton) object 
    //and call the Create(name:String) method on it
    [Import(typeof(IModel), Name:"Foo")]
    public IModel Model { get; set; }

    //Should internal import a IFactory(singeleton) object 
    //and call the Create(type:Type) method on it
    [Import(typeof(IModel), Type: typeof(Foo1))]
    public IModel Model1 { get; set; }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:57:32.690

您不能将`[Import]`属性的参数传递给正在导入的类型的方法。

但是，我认为如果可以的话，您不应该这样做，因为进行这样的导入会导致您的类被构建，并且很可能会过早地构建。您应该将对象的构造延迟到实际需要的时候。通过直接导入，您将失去这种惰性行为。

此外，工厂通常需要一些参数来构造类型，但这里不是这种情况。如果您绝对必须直接导入，则可以只导入类型本身，而不是工厂（当然，您将失去稍后通过更改工厂行为轻松操作构造的选项）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T22:31:35.953

您可以将合同名称添加到导出中，然后在导入部件时使用它们。

对于`IModel`接口：

```
public interface IModel { } 
```

您可以`IModel`使用合同名称将实现导出为：

```
[Export("Foo1", typeof(IModel))]
public class Foo1 : IModel { } 
```

您还可以在单​​个类上添加多个导出属性。这样您就可以满足两种类型的导入（按名称和类型）。

```
[Export("Foo2", typeof(IModel))]
[Export(typeof(Foo2))]
public class Foo2 : IModel { } 
```

然后你像这样导入：

```
public class Foo
{
    //Import using the contract name.
    [Import("Foo1", typeof(IModel))]
    public IModel Model1 { get; set; }

    //Import using the actual type.
    [Import(typeof(Foo2))]
    public IModel Model2 { get; set; }

    //Import the same model but with contract name instead of type. 
    //This is possible because there are two different exports.
    [Import("Foo2")]
    public IModel Model3 { get; set; }
} 
```

如您所见，您根本不必使用 ant factory。MEF 将成为您的工厂。

# php - php/sql - 在多个字段上插入相同的值

> ID：14676513
> 
> 赞同：2
> 
> 时间：2013-02-03T19:46:07.813
> 
> 标签：php, mysql

我有这个代码（这是工作并将这些变量传递给另一个文件）

```
 var month = "<?php echo openedMonthbid();?>";
    var user = "<?php echo $_SESSION['member_id'];?>";
    var day = new Array();

    $(':checkbox:checked').each(function(i){
    day.push('`' + $(this).val() + '`');  });
    var count = day.length;

                            $.ajax({
                            type: "POST",
                            url: "sendBidding.php",
                            data : "user="+user+"&days="+day+"&month="+month+"&number=",
                            dataType: "json", 
```

sendBidding.php

```
$month = $_POST['month'];
$user = $_POST['user'];
$days = $_POST['days'];
$count = $_POST['count'];//if a check 3 values I get '3'

      mysql_query("INSERT INTO $month ($days) VALUES ('1','1','1')");

    $result = true;

    echo json_encode(array("success"=>$result,
                               "datas" => $data,
                                "mon"=>$month)); 
```

我想添加与所选天数一样多的值（'1'）。如何更改 VALUES ('1','1','1') ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:57:28.760

这是生成一系列相同字符串的解决方案。使用[`array_fill()`](http://php.net/manual/en/function.array-fill.php).

```
$month = $_POST['month'];
$days = $_POST['days'];

// Be sure to whitelist $month and $days before using them in an SQL query!  
// For example, you could store an associative array keyed by month,
// containing lists of the day column names.
$month_table_whitelist = array(
  "month_jan" => array("day1", "day2", "day3", /* etc */),
  "month_feb" => array("day1", "day2", "day3", /* etc */),
  /* etc */
);
if (!array_key_exists($month, $month_table_whitelist)) {
  die("Please specify a valid month.");
}
if (!array_search($days, $month_table_whitelist[$month])) {
  die("Please specify a valid day of month.");
}

$count = $_POST['count'];//if a check 3 values I get '3'

$tuples = array_fill(1, $count, "('1')");

$status = mysql_query("INSERT INTO $month ($days) VALUES ".implode(",", $tuples));
if ($status === false) {
  die(mysql_error());
} 
```

PS：通过将不安全的值 $month 和 $days 直接插入到查询中，您的查询容易受到 SQL 注入的影响。您应该使用白名单方法来确保这些输入与数据库中的真实表名和列名匹配，不要只信任用户输入。

PPS：您应该知道您正在使用 ext/mysql 函数，但这些已被弃用。如果这是一个新应用程序，您应该在投入更多时间使用已弃用的 API 之前开始使用 mysqli 或 PDO。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-03T20:10:41.403

```
$count = $_POST['count'];//if a check 3 values I get '3'

$daystatic="('1')";

mysql_query("INSERT INTO $month ($days) VALUES ". $daystatic . str_repeat ( ",$daystatic" , $count-1)); 
```

# ffmpeg - 使用 ffmpeg 覆盖多个视频

> ID：14676517
> 
> 赞同：6
> 
> 时间：2013-02-03T19:46:39.593
> 
> 标签：ffmpeg

我正在尝试使用 ffmpeg 将多个视频叠加到一个视频中。[已经有一个只有一个覆盖的问题](https://stackoverflow.com/questions/5890738/overlaying-video-with-ffmpeg)，但我想同时添加多个视频（以避免多个编码）。

我尝试使用以下行：

```
ffmpeg -i background.m2v -vf "movie=a.m2v [a]; movie=b.m2v [b]; [in][a] overlay=0:366, [b] overlay=592:41" combined.m2v 
```

现在的错误是，覆盖区域 (0,366) – (720,942) 不在主区域 (0,0) – (720, 210) 内。但如果我只使用一个覆盖文件，它就可以工作。

视频大小：

*   背景：720x576
*   a.m2v：72x48
*   b.m2v：720x210

结果，我希望 a.m2v 视频位于左上角（徽标），b.m2v 位于下三分之一处。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T09:24:54.133

我用 测试了这个`mp4`，但`m2v`应该也可以

```
set 'overlay, overlay = 0:366'
ffmpeg -i background.mp4 -i a.mp4 -i b.mp4 -filter_complex "$1" combined.mp4 
```

[§ 叠加](http://ffmpeg.org/ffmpeg-filters.html#overlay-1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T16:19:58.743

我还在 svnpenn 之前找到了答案/解决方法：

```
ffmpeg -i background.m2v -vf "movie=a.m2v [a]; movie=b.m2v [b]; [in][a] overlay=0:366 [c]; [c][b] overlay=592:41" combined.m2v 
```

# opengl - 仅在矩形中渲染部分场景

> ID：14676519
> 
> 赞同：0
> 
> 时间：2013-02-03T19:46:55.053
> 
> 标签：opengl, glsl

你将如何实现像[这个视频](http://www.youtube.com/watch?v=dUBxHd3bMhg)这样的东西（从 1:25 开始）

我想尝试做类似的事情，但没有太多关于从哪里开始的线索。我听说过“门户渲染”技术，但我也读过它是过时的技术。

什么是在矩形内渲染部分场景的最简单方法，剪裁其余几何图形，但仍然保留背景。

我被告知要渲染整个场景，但忽略颜色片段并为墙壁留下深度信息。你能在这里给我一个更具体的建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:49:23.063

您可以做的是渲染整个场景，如果像素位于您定义的矩形之外，则在片段着色器中使用**丢弃语句。**顾名思义，**discard丢弃一个像素并且不向纹理/后缓冲区写入任何内容，因此您的背景将被保留。**

如果你的矩形要改变每一帧（就像在视频中一样），那么你最好在屏幕空间着色器中实现这个方法。然后您可以使用归一化坐标 [0.0 .. 1.0]，这样可以更容易地确定像素是否位于矩形之外。

# c - 在 NASM 中执行循环失败

> ID：14676521
> 
> 赞同：0
> 
> 时间：2013-02-03T19:47:05.417
> 
> 标签：c, assembly, x86, nasm

我试图在 NASM 中编写一个简单的汇编程序，它将打印 Hello World 5 次。但是在打印hello world的无限循环中执行失败。我尝试调试代码，发现`ecx`没有正确执行并`eax`显示其他值。我的代码如下：

```
 section .data
    msg:    db "Hello World",10,0
    section .text
        global main
        extern printf
    main:   push ebp
        mov ebp,esp

        mov ecx,0
        mov DWORD[esp-4],0x5
        mov eax,DWORD[esp-4]
        jmp .loop
   .loop:
        push eax
        push ecx
        add esp,8

        pop ecx
        pop eax

        cmp ecx,eax
        jne .task

        jmp .done
     .task:
        push DWORD msg
        call printf
        add esp,4

        add ecx,1

        jmp .loop
      .done:
        mov esp,ebp
        pop ebp
        ret 
```

你能通过展示我的错误来帮助我吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T19:52:12.830

根据[X86 调用约定](https://en.wikipedia.org/wiki/X86_calling_conventions#cdecl)，寄存器 EAX、ECX 和 EDX 是调用者保存的。在打电话之前保存它们，然后再`printf`恢复。

您的代码中还有一个我无法理解的片段（`add esp, 8`在循环中被 push/pop 包围）。我不能在这里提供任何解释，但如果你也不明白，那可能是错误的*。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:19:02.367

Anton（上图）是对的 - 无法解释`add esp,8`的东西会破坏堆栈并搞砸一切（你应该假设`printf`会破坏你所依赖的 ECX 和 EAX 中的值）。

这是一个参考版本：

```
section .data
msg:    db "Hello World",10,0
section .text
    global main
    extern printf

main:
    push dword 0x5     ;count = 5;

.next:
    push dword msg
    call printf
    add esp,4

    sub dword [esp],1  ;count--;
    jne .next          ;if(count != 0) goto next;

    add esp,4          ;Remove "count" from stack
    mov eax,0          ;Value to return from "main"
    ret 
```

# c++ - 一个宏定义调用中的对象及其类定义

> ID：14676525
> 
> 赞同：3
> 
> 时间：2013-02-03T19:47:28.240
> 
> 标签：c++, macros

我想编写一个宏，它在下面的用法中定义了一个在它下面定义的`foobar`类的全局对象。

```
SOMEMACRO(foobar)
{
public:
   int a;
}; 
```

换句话说，我希望上面的效果与：

```
class SomeClassPossiblyWith_foobar_InItsName
{
public:
   int a;
};
SomeClassPossiblyWith_foobar_InItsName foobar; 
```

为对象提供准确的“foobar”名称（或至少以这种方式调用对正确对象的引用）非常重要。只要允许多次使用宏，类的名称就无关紧要。

这相当困难，因为通常应该在使用类之前定义它，但也许存在一些棘手的（可能涉及模板）实现它的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:55:09.987

它非常简单，使用预处理器连接运算符`##`。

就像是：

```
#define SOMEMACRO(name) \
SomeClassPossiblyWith_##name##_InItsName name; \
class SomeClassPossiblyWith_##name##_InItsName 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:46:20.227

同时，我找到了使用适当对象进行引用和初始化的解决方案，以某种方式回答了这个问题。我不确定这是标准投诉（它符合 gcc 4.6）。

```
template<typename T>
T &delayed_make_object()
{
    static T obj;
    return obj;
}

#define DOIT(_name) \
    class TypeFor ## _name; \
    TypeFor ## _name & _name = delayed_make_object<TypeFor ## _name>(); \
    class TypeFor ## _name

DOIT(foo)
{
    public:
    int abc;
};  

DOIT(bar)
{
    public:
    int cba;
};

int main()
{
  foo.abc=bar.cba;   // works!
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T21:47:20.370

你可以这样做：

```
#define SING(classname, body) class SING_##classname \
body \
; SING_##classname classname; 
```

然后，以这种方式使用它：

```
SING (foobar, {
    public:
        int a;
    }
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T22:10:37.497

编辑：为代码添加了更多解释。

使用模板的解决方案如下：

我为类创建了一个模板，这些类在创建时应该具有一个具有全局访问权限的实例。我想这就是你想要的。（我已将其命名为 Singleton 引用具有名称的设计模式）.h：

```
// C++ header for template Singleton
template<typename T>
class Singleton : public T {
    static Singleton<T>* instance;
    Singleton();
public:
    static Singleton<T>* getInstance();
}; 
```

getInstance() 方法将来自您将获得该实例的位置。它可以是一个对象而不是一个指针，但我更喜欢这种方式，因为它更通用，你想做一些更复杂的事情，比如在运行时更改实例；它还允许仅在使用对象时实例化对象，从而防止不需要内存分配。.cpp：

```
// C++ source for template Singleton
template<typename T>
Singleton<T>* Singleton<T>::instance = NULL;

template<typename T>
Singleton<T>::Singleton()
: T()
{}

template<typename T>
Singleton<T>* Singleton<T>::getInstance()
{
    if (instance == NULL)
    {
        instance = new Singleton<T>();
    }
    return instance;
} 
```

您可以正常实现任何您想要的类，并使用 Singleton 模板来确保您将始终处理某个类的相同全局实例。如果需要，您还可以使用 typedef 来命名类型名称。你的类定义：

```
// Definition of class foobar
class foobar_impl {
public:
    int a;
};

typedef Singleton<foobar_impl> Foobar; 
```

然后，您使用模板重新获取 foobar_impl 的实例：

```
int main(int argc, char** argv)
{
    Foobar *pf = Foobar::getInstance();
    return 0;
} 
```

然而，这个解决方案的问题是 Singleton 模板只适用于具有空构造函数的类。但是你的例子也是如此，所以我认为这就是你想要的。

# git - 在 git 中创建新分支时，“track”是什么意思？

> ID：14676529
> 
> 赞同：16
> 
> 时间：2013-02-03T19:48:02.977
> 
> 标签：git, aptana

我正在使用 Aptana 和 Git。当我去创建一个新分支时，会出现以下对话框。

![在此处输入图像描述](../Images/5197b6415d1dcb49b7015810ff3f7742.png)

我想知道那个“跟踪”复选框是做什么的，什么时候最适合检查它。

我理解 git 中跟踪的概念，但主要是文件。我似乎不明白它如何应用于正在创建的新分支？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-03T19:51:08.460

在这种情况下，`track`指的是 git-checkout 和 git-branch 的`--track`选项。

当本地分支从远程跟踪分支启动时，git 会设置分支，以便`git pull`从远程跟踪分支适当地合并。

来自`man git-branch`：

> ```
> -t, --track
>     When creating a new branch, set up configuration to mark the
>     start-point branch as "upstream" from the new branch. This
>     configuration will tell git to show the relationship between the
>     two branches in git status and git branch -v. Furthermore, it
>     directs git pull without arguments to pull from the upstream when
>     the new branch is checked out. 
> ```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-22T01:18:09.897

即使在阅读了评论之后，我仍然不明白*Marco提供的答案。*所以我决定自己进一步研究它并用外行的方式提供答案......

* * *

**本地分支：**是从 Git 的主分支*分支出来*的路径。master 分支是最终提交更改的主要路径。该分支是本地的，并且未链接到远程分支。

**远程分支：**与“本地分支”相同，但位于远程 Git 上。该分支是远程的，并且未链接到本地​​分支。

**远程跟踪分支：**

*   它们用于将您在本地处理的内容与远程处理的内容联系起来。
*   `git pull`他们知道在执行或执行时从哪个远程分支获取更改`git fetch`。键入`git status`将说明您在远程分支之前有多少次提交。

**妙语...**

使用`--track`将创建分支，然后自动从所选分支“拉”。所以在这种情况下（参考问题中的图片），将在**本地**创建一个名为“feat/password-confirmation”的新分支，并将与名为“master”的远程分支（远程上的主路径）进行比较)

我以为你说主分支是本地的？本地和远程的主路径都称为“主路径”，但仅与`git push`or交互`git pull`。

如果您不需要跟踪远程 Git，则无需勾选“跟踪”复选框。

* * *

希望有帮助。

[来源](http://gitready.com/beginner/2009/03/09/remote-tracking-branches.html)

# xslt - 如何在 XSLT 中将节点删除到同一级别的组中

> ID：14676533
> 
> 赞同：1
> 
> 时间：2013-02-03T19:48:15.907
> 
> 标签：xslt

我正在尝试将所有记录分组到同一级别（我同意它不正确，但遗留系统已经在生产环境中工作）。

我有这个xml文件...

![在此处输入图像描述](../Images/c593add3c6c52db39cb5d329920046e3.png)

现在，我需要删除保留值的节点“SalesOrg”......文件需要获取此结构。

![在此处输入图像描述](../Images/195def2af3f672af2c40a8080c7eab6e.png)

我正在使用这个 XSLT 来尝试它

![在此处输入图像描述](../Images/f89939e3b9ee0419223bac28875a73bc.png)

但是，输出 XML 文件继续相同..

![在此处输入图像描述](../Images/f42bf7fb4025a07ce43e34583c9d0664.png)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:13:30.427

如果您只需要删除 SalesOrg-Nodes，请使用以下样式表：

```
<?xml version="1.0" encoding="UTF-8" ?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:template match="@*|node()">
    <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
    </xsl:copy>
  </xsl:template>
  <xsl:template match="SalesOrg">
    <xsl:copy-of select="*" />
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:31:06.607

**这种转变**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="node()|@*">
  <xsl:copy>
   <xsl:apply-templates select="node()|@*"/>
  </xsl:copy>
 </xsl:template>
 <xsl:template match="SalesOrg">
  <xsl:apply-templates/>
 </xsl:template>
</xsl:stylesheet> 
```

**当应用于提供的 XML 文档（无法复制/粘贴图片！！！）时，会产生想要的结果（无法复制/粘贴图片！！！）。**

# c# - RELEASE 代码中是否优化了未使用的方法？

> ID：14676538
> 
> 赞同：1
> 
> 时间：2013-02-03T19:48:58.297
> 
> 标签：c#, jit

> **可能重复：**
> [C# 编译器优化 - 未使用的方法](https://stackoverflow.com/questions/5204667/c-sharp-compiler-optimization-unused-methods)

JIT 编译器在程序启动后运行并将代码（通常是字节码或某种 VM 指令）即时（或称为即时）编译成通常更快的形式，通常是主机 CPU 的本机指令系统。JIT 可以访问动态运行时信息，而标准编译器则不能，并且可以进行更好的优化，例如经常使用的内联函数。

这与在程序首次运行之前将所有代码编译为机器语言的传统编译器形成对比。但我的问题是 JIT 编译器是否消除了空方法？谁能给一个简洁易懂的描述？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T19:55:34.357

不是的，我只是通过在我当前的项目中添加一个未使用的函数并在 exe 中添加 dotPeeking 来测试它。它还在那里。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T19:55:52.967

即使在发布模式下，您也可以关闭优化。所以我认为你的问题是：在优化模式下是否删除了私有方法。然后答案是否定的。

我认为它在这里被广泛讨论： [C#编译器优化 - 未使用的方法](https://stackoverflow.com/questions/5204667/c-sharp-compiler-optimization-unused-methods)

（PS：当我复制/粘贴你的标题时，这是谷歌的第一次点击）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T19:56:27.067

[上一个问题](https://stackoverflow.com/questions/5204667/c-sharp-compiler-optimization-unused-methods)可能会回答您的问题。似乎它没有被编译但是那些未使用的方法永远不会被调用。这似乎不会影响内存占用，因为 JIT 会根据需要将这些部分带入内存。

# jsf-2 - 使用 JSF2.0 Mojarra 和 JQuery 使会话无效

> ID：14676541
> 
> 赞同：1
> 
> 时间：2013-02-03T19:49:19.673
> 
> 标签：jsf-2

我想在 JSF2.0 的窗口关闭期间使会话无效。所以我写了下面的代码来做到这一点：

```
 var preventUnloadPrompt;
 var messageBeforeUnload = "my message here - Are you sure you want to leave this page?";
 $('a').live('click', function() {
    preventUnloadPrompt = true;
 });
 $('form').live('submit', function() {
    preventUnloadPrompt = true;
 });
 $(window).bind("beforeunload", function(e) {
    var rval;
    if (preventUnloadPrompt) {
        return;
    } else {
        // return messageBeforeUnload;
        doInvalidate();
    }
    return rval;
 });

function doInvalidate()
{
     $.ajax({
         url: "http://localhost:8080/MyPrj/SessionTimeout",
         type: 'GET'
     });
 } 
```

我的servlet如下：

```
 public class SessionTimeout extends HttpServlet {
    .....
    protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        System.err.println("IN SESSION TIMEOUT GET!!!");
            FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
   }
  .....
} 
```

在启动我的第一个 JSF2.0 页面后（此时 FacesContext 必须已经初始化），我试图关闭窗口。我可以看到我的`SessionTimeout`servlet 被调用但`FacesContext.getCurrentInstance().getExternalContext().invalidateSession();`正在抛出`NullPointerException`。为什么会这样？`FacesContext`在我的 servlet 中这个 AJAX 调用期间我看不到吗？如果以上是不可能的，有人可以建议任何其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:13:28.007

由.`FacesContext`创建，`FacesServlet`因此仅在 . 提供请求时可用`FacesServlet`。换句话说，它仅在 JSF 工件（如托管 bean、阶段侦听器等）中可用，但绝对不能在独立于 JSF 调用的“普通”servlet 中使用。

只需使用标准的 servlet API 方法，就像 JSF 使用“幕后”一样（你知道，JSF 是一个基于 Servlet 的 MVC 框架，哎呀，它`FacesServlet` **是一个**servlet！）。要使会话无效，只需执行与正在执行的操作[完全相同的](http://docs.oracle.com/javaee/6/api/javax/faces/context/ExternalContext.html#invalidateSession%28%29)`ExternalContext#invalidateSession()`操作即可。

```
request.getSession().invalidate(); 
```

# ember.js - 如何：使用 ember.js 上传文件

> ID：14676546
> 
> 赞同：7
> 
> 时间：2013-02-03T19:50:22.390
> 
> 标签：ember.js

我想知道如何使用 ember.js 进行真正的文件上传（将文件保存到服务器）

有什么好的例子吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-11-02T00:49:11.060

[从另一个线程](https://stackoverflow.com/questions/38844566/input-type-file-in-ember-js/40369335#40369335)查看我的答案

```
<input
  multiple="true"
  onchange={{action "upload"}}
  accept="image/png,image/jpeg,application/pdf"
  type="file"
/>

actions: {
  upload: function(event) {
    const reader = new FileReader();
    const file = event.target.files[0];
    let imageData;

    // Note: reading file is async
    reader.onload = () => {
      imageData = reader.result;
      this.set(data.image', imageData);

      // additional logics as you wish
    };

    if (file) {
      reader.readAsDataURL(file);
    }
  }
} 
```

它只是工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-04T09:53:58.523

如果您阅读下面链接中的答案，您将了解如何使用 emberjs 进行文件上传和保存到服务器：

[使用 Ember 数据上传文件](https://stackoverflow.com/questions/9200000/file-upload-with-ember-data/13820443#13820443)

在上面链接中“托兰·比卢普斯”提供的答案中，我从他的答案中复制的以下几行将保存到服务器：

```
var person = PersonApp.Person.createRecord({username: 'heyo', attachment: fileToUpload});

self.get('controller.target').get('store').commit() 
```

# wpf - 从 c# 中的 e.Key 调用 mouseDouble click 事件- 怎么做？

> ID：14676553
> 
> 赞同：0
> 
> 时间：2013-02-03T19:50:53.660
> 
> 标签：wpf, c#-4.0, mouseevent

我是 C# 中的新手程序员和代码（实际上是 WPF）。我的代码有问题，想知道您是否可以提供帮助。

我需要在已经存在`DoubleClick`的交换机上添加一个。`e.Key`代码是这样的：

```
private void txtMainInput(object sender, keyEventArgs e)
{
    ...
    switch (e.key)
    {
        case Key.Enter:
                OnInput_EnterDown();
        break;

        case Key.Tab:
                OnInput_TabDown();
        break;

        case MouseDoubleClick:
                OnInput_DoubleClick();

        break;

        default:
        break;
   }
} 
```

`Problem is`并不`third case`真正存在，因为密钥派生自`keyboardEventArgs`和`mouseDoubleclick`派生自`mouseEventArgs`，因此我不能调用`MouseDoubleClick`. 我怎样才能克服这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:11:20.343

第三个不存在的原因是因为 KeyEventArgs***在键盘的 KeyDown/KeyPress 事件上***返回，而不是在鼠标上......

要订阅鼠标点击，您需要另一个事件，例如`MouseDoubleClick`并在其中放置您想要的任何逻辑：

```
 public MainWindow()
    {
        InitializeComponent();
        txtMainInput.MouseDoubleClick += txtInput_MouseDoubleClick;
    }

    void txtInput_MouseDoubleClick(object sender, MouseButtonEventArgs e)
    {
        // Put doubleClick logic here
    } 
```

以同样的方式您可以订阅`MouseDown`等`MouseUp`...由于您将其标记为 WPF，这也可以在 XAML 中完成...。

# javascript - Leaflet Markerclusterer 与 Leaflet.Label

> ID：14676562
> 
> 赞同：3
> 
> 时间：2013-02-03T19:51:49.660
> 
> 标签：javascript, jquery, openstreetmap, leaflet

**问题：**是否可以在[Leaflet.markercluster](https://github.com/Leaflet/Leaflet.label)上使用[Leaflet.label](https://github.com/Leaflet/Leaflet.markercluster)？

**问题：**当光标悬停在群集图标上时，我试图显示一个 HTML div。

对于普通标记，您可以使用将标签附加到标记上

```
L.marker([-37.7772, 175.2606]).bindLabel('Look revealing label!').addTo(map); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T20:17:38.520

[http://jsfiddle.net/WUXXz/](http://jsfiddle.net/WUXXz/)

```
var label = null;

markers.on('clustermouseover', function (a) {
    label = new L.Label().setLatLng(a.layer.getLatLng())
        .setContent('<p>Hello world!<br />This is a nice popup.</p>')
        .openOn(map);
});

markers.on('clustermouseout', function () {
   if (label) {
      label.close();
      label = null;
   }
}); 
```

# java - 自定义键盘 - Android

> ID：14676566
> 
> 赞同：1
> 
> 时间：2013-02-03T19:52:07.260
> 
> 标签：java, android, keyboard, android-custom-view, android-keypad

是否有任何已知的`inputTypes`on组合可以为 Num-pad 键盘提供特殊字符，`inputText`例如`$`、和. 我试图允许用户输入一个数字，并且该字段也可以采用提到的字符。我尝试了很多，但似乎都没有提供所需的输出。`*``#``&`

我必须为此创建自己的自定义键盘吗？由于我的请求非常针对某些特殊字符，请不要将此标记为重复问题。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:21:19.977

您可以根据需要使用[KeyboardView](http://developer.android.com/reference/android/inputmethodservice/KeyboardView.html)进行自定义。

```
KeyboardView customKeyboard = new KeyboardView(context);
customKeyboard.setKeyboard(new Keyboard(this, R.xml.customLayout));

customKeyboard.setOnKeyboardActionListener(new OnKeyboardActionListener() {
    //do your work here
} 
```

其中**R.xml.customLayout**指的是**/res/xml/customLayout.xml**。自定义键盘的一个非常好的教程是..

*   [创建您自己的自定义键盘 for.html](http://tutorials-android.blogspot.com/2011/06/create-your-own-custom-keyboard-for.html)

这将对您有更好的帮助。

# android - Facebook 和其他通知如何在没有 gmail 帐户同步的情况下工作

> ID：14676572
> 
> 赞同：0
> 
> 时间：2013-02-03T19:52:41.250
> 
> 标签：android, google-cloud-messaging

据我所知，到目前为止，在 android 中推送通知的唯一方法是 GCM，要在 GCM 上注册设备，我们需要在设备上同步 Gmail 帐户，所以如果我正在开发使用 GCM 进行推送通知服务的应用程序，我需要检查 Gmail 帐户是否已在设备上配置和同步。

但是像 facebook、Twitter 等应用程序从不要求添加和同步 Gmail 帐户，那么他们如何能够使用推送通知呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:22:21.620

如果您曾经登录过 facebook 并发送推送通知，如果您想要 facebook for android 去[http://goo.gl/CPLFl](http://goo.gl/CPLFl) 还有其他免费的 android 付费应用程序。

# python - 将带有一些标题的文本文件转换为直方图的数组

> ID：14676573
> 
> 赞同：0
> 
> 时间：2013-02-03T19:52:44.187
> 
> 标签：python, arrays

我有一个标题包含“#”的文件，然后是逗号分隔的数据。IE

```
#blah
#blah
#blah 
1, 2, 3, 4, 5, 6
7, 8, 9,10,11,12
... 
```

我希望能够跳过 # 并将数据转换为数组（列上的直方图）。这读进去了。

```
filename = 'input.txt'
listin = []
for line in open(filename,'r'):
    li=line.strip()
    if not li.startswith("#"):
        line = line.partition('#')[0]
        #line = line.rstrip()
        listin.append(line.split(',')) 

data = numpy.asarray(listin)
SubData=data[:,0]

hist,nbins = np.histogram(SubData)

Error:
TypeError: cannot perform reduce with flexible type 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:04:28.427

您需要将数据转换为数字类型。您的数组包含字符串。

```
listin.append([int(token) for token in line.split(',')]) 
```

此外，您需要删除每一行以删除换行符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T10:38:49.780

您还可以使用 numpy loadtxt 之类的

```
from numpy import loadtxt
data = loadtxt("input.txt", comments="#", delimiter=",", unpack=True) 
```

返回列中的数据：

```
array([[  1.,   7.],
   [  2.,   8.],
   [  3.,   9.],
   [  4.,  10.],
   [  5.,  11.],
   [  6.,  12.]]) 
```

用于`unpack=False`按行加载文件。

# c++ - std::is_integer 和 std::is_integral 之间的区别？

> ID：14676574
> 
> 赞同：32
> 
> 时间：2013-02-03T19:52:49.290
> 
> 标签：c++, c++11, language-lawyer, typetraits

C++11 提供了两种类型特征模板类：`std::is_integer`和`std::is_integral`. 但是，我无法分辨它们之间的区别。

什么类型，比如说 T，可以使`std::is_integer<T>::value`真假`std::is_integral<T>::value`假？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-02-03T20:01:09.817

`std::is_integer<T>`不存在。

话虽如此，`std::numeric_limits<T>::is_integer`确实存在。

我不知道 和 之间有任何显着`std::numeric_limits<T>::is_integer`区别`std::is_integral<T>`。后者的设计要晚得多，并在 C++11 中成为标准，而前者是在 C++98 中引入的。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-02-05T08:05:55.973

没有任何类型`T`对`std::is_integral<T>::value`和有不同的结果`std::numeric_limits<T>::is_integer`。引用[标准草案](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3376.pdf)：

**3.9.1 基本类型[basic.fundamental]**

> 7 类型 bool、char、char16_t、char32_t、wchar_t 以及有符号和无符号整数类型统称为整数类型。整数类型的同义词是整数类型。 [...]

**18.3.2.4 numeric_limits 成员 [numeric.limits.members]**

```
static constexpr bool is_integer; 
```

> 17 如果类型是整数，则为真。

**20.9.4.1 主要类型类别 [meta.unary.cat]**（表 47）

```
template <class T> struct is_integral; 
```

> T 是整数类型 (3.9.1)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-02-27T10:14:43.747

`std::is_integral_v<T>`只会为内置整数返回 true。

该标准允许`std::numeric_limits<T>::is_integer`对自定义整数类型（如`boost::multiprecion::cpp_int`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-05-02T09:53:06.363

`std::is_integral<T>`并且`std::numeric_limits<T>::is_integer`不一样。例如`boost::multiprecision`，大整数的处理方式不同。

这是来自相应的问题：

> `is_integral`返回有关类型性质的信息，并且仅对“本机”整数类型为真，对于类类型永远不应该为真。也就是说`is_integer`和`is_class`是互斥的。
> 
> `numeric_limits`另一方面，返回有关类型行为的信息——如果你愿意，它是否对特定概念进行建模——因此应该专门用于 UDT。请注意，专门 `is_integer`针对 UDT 会破坏代码，因为`is_integer`这意味着许多其他事情也是正确的，例如微不足道的移动/复制/初始化等。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-12T00:06:45.840

不同之处在于它`std::is_integral<T>`只会识别十进制整数，包括`bool` `char` `char16_t` `char32_t` `wchar_t` `short` `int` `long` `long long`. 虽然`std::numeric_limits<T>::is_integer`会识别所有这些以及`float` `double`. 查看这两个页面以获取更多信息：[is_integer](http://en.cppreference.com/w/cpp/types/numeric_limits/is_integer)，[is_integral](http://en.cppreference.com/w/cpp/types/is_integral)

# php - 登录在 Mozilla Firefox 中不起作用，但在 safari、chrome 和 ie 中起作用？

> ID：14676575
> 
> 赞同：-1
> 
> 时间：2013-02-03T19:52:53.283
> 
> 标签：php, login

我在 mozilla firefox 中的登录脚本有问题，由于某种原因，它不会让用户登录。我的登录脚本在 chrome 和 safari 中运行良好。

这是我的代码，我想知道为什么它不让人们登录，请问有什么想法吗？

HTML：

```
<form id="myform" form action="login.php" method="post" class="loginform">

Email
  <input type="text" name="email" maxlength="30" />

Password
<input type="password" name="password" maxlength="30" />

<input type="image" src="../PTB1/assets/img/icons/loginarrow1.png" name="submit" class="loginbutton" value="Login" />

            </form> 
```

PHP：

```
<?php

    if (logged_in()) 

{ 
$_SESSION['login_message']="<div class=\"login-overlay\"></div><div class=\"login-box\"><div class=\"loginframe2\">
<h1>Login You In Securely </h1>
<p>login you in securely. Please wait.<br/><br/>
<div class=\"login-logo\">
  <img src=\"assets/css/photobox/loading.gif\" width=\"24\" height=\"24\"><div class=\"login-text-logo\">Login You In. Please Wait</div></div>
</div></div>"; 
header("Location:home.php");

}

    include_once("includes/form_functions.php");

    // START FORM PROCESSING
    if (isset($_POST['submit'])) { // Form has been submitted.
        $errors = array();

        // perform validations on the form data
        $required_fields = array('email', 'password');
        $errors = array_merge($errors, check_required_fields($required_fields, $_POST));

        $fields_with_lengths = array('email' => 30, 'password' => 30);
        $errors = array_merge($errors, check_max_field_lengths($fields_with_lengths, $_POST));

        $email = trim(mysql_prep($_POST['email']));
        $password = trim(mysql_prep($_POST['password']));
        $hashed_password = md5($password);

        if ( empty($errors) ) {
            // Check database to see if email and the hashed password exist there.
            $query = "SELECT id, email, close_account ";
            $query .= "FROM ptb_users ";
            $query .= "WHERE email = '{$email}' ";
            $query .= "AND password = '{$hashed_password}' ";
            $query .= "AND close_account = '0' ";
            $query .= "LIMIT 1";
            $result_set = mysql_query($query);
            confirm_query($result_set);
            if (mysql_num_rows($result_set) == 1) {
                // email/password authenticated
                // and only 1 match
                $found_user = mysql_fetch_array($result_set);
                $_SESSION['user_id'] = $found_user['id'];
                $_SESSION['email'] = $found_user['email'];
                $_SESSION['sub_expires'] = $found_user['subscription_expires'];

                $result = mysql_query("UPDATE ptb_users SET user_online='Online' WHERE id=".$_SESSION['user_id']."") 
or die(mysql_error());

if($result) 
{ 
$_SESSION['login_message']="<div class=\"login-overlay\"></div><div class=\"login-box\"><div class=\"loginframe2\">
<h1>Login You In Securely </h1>
<p>login you in securely. Please wait.<br/><br/>
<div class=\"login-logo\">
  <img src=\"assets/css/photobox/loading.gif\" width=\"24\" height=\"24\"><div class=\"login-text-logo\">Login You In. Please Wait</div></div>
</div></div>"; 
header("Location:home.php");

}

            }else{

                // email/password combo was not found in the database
                $message = "<div class=\"infobox_out\"><strong>Email / Password combination incorrect.</strong><br />
                    Please make sure your caps lock key is off and try again.</div>";
                    echo "<a href=\"#\"><div class=\"infobox-close2\"></div></a>";

            }

                } else {
            if (count($errors) == 1) {
                $message = "<div class=\"infobox_out\">There was 1 error in the form.<div>";

            } else {
                $message = "<div class=\"infobox_out\">There were " . count($errors) . " errors in the form.<div>";
            }
        }

    } else { // Form has not been submitted.
        if (isset($_GET['logout']) && $_GET['logout'] == 1) {
            $message = "<div class=\"infobox\">You are now logged out.</div>";
            echo "<a href=\"#\"><div class=\"infobox-close3\"></div></a>";

    } else { // Form has not been submitted.
        if (isset($_GET['logout']) && $_GET['logout'] == 2) {
            $message = "<div class=\"infobox_out\">Sorry, we've had to log you out. Your session has expired.</div>";
            echo "<a href=\"#\"><div class=\"infobox-close2\"></div></a>";

            } else { // Form has not been submitted.
        if (isset($_GET['logout']) && $_GET['logout'] == 1) {
            $message = "<div class=\"infobox\">You are now logged out.</div>";
            echo "<a href=\"#\"><div class=\"infobox-close3\"></div></a>";

        }

        } 

    }

        $email = "";
        $password = "";
    }
?>

<br/>
            <?php if (!empty($message)) {echo "<p class=\"message\">" . $message . "</p>";} ?>
            <?php if (!empty($errors)) { display_errors($errors); } ?>

                     <? if (logged_in()) { ?> 

            <?php

$initial_prompt = initial_prompt();
while ($initial = mysql_fetch_array($initial_prompt)) 

 if ($initial['initial_prompt'] == '0')  {

 redirect_to("dashboard.php"); } ?>

 <? } ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:11:33.010

错过了这个：

```
 <form id="myform" form action="login.php" method="post" class="loginform"> 
```

...应该是：

```
 <form id="myform" action="login.php" method="post" class="loginform"> 
```

而且，`value`in`type="image"`不合规格。`type="image"`只会将图像定义为提交按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:18:19.700

提交服务器端图像映射 ( `<input type="image"`) 的浏览器处理不一致。

所有浏览器都应该提交`name.x=x_coord`并且`name.y=y_coord`（​​尽管当它到达服务器时，PHP 会解析`.`为`_`），但并非所有浏览器都会提交`name=Value`。

不要测试`if (isset($_POST['submit'])) {`何时`submit`是图像映射。

# r - 导致计算错误的数据集大小

> ID：14676576
> 
> 赞同：1
> 
> 时间：2013-02-03T19:52:57.340
> 
> 标签：r, error-handling, dataset, limit

[我已经根据我之前提出的问题](https://stackoverflow.com/questions/14631548/efficiency-of-transforming-counts-to-percentages-and-index-scores)修改了下面的代码：

```
Input_Data <- read.csv("http://dl.dropbox.com/u/58164604/Input_Data.csv", row.names=1, stringsAsFactors = FALSE)

TPop<-Input_Data[1]
TPopCount <- TPop[, 1]
TPopSum <- sum(TPopCount)

OACRaw<-Input_Data[,4:ncol(Input_Data)]
OACRawCount <-ncol(OACRaw)

OA_Percentage <- TPopCount/TPopSum * 100
Data_Per_Row <- OACRaw/matrix(rep(TPopCount, each=OACRawCount), ncol=OACRawCount, byrow=T)*100
Data_Index_Row <- Data_Per_Row/OA_Percentage * 100
names(Data_Per_Row) <- names(Data_Index_Row) <- names(OACRaw) 
```

但是，当我尝试让它适用于更大的数据集（186 列和超过 180,000 行）时，它会出现以下错误：

```
Error in FUN(left, right) : non-numeric argument to binary operator 
```

但是，当相同的代码运行较小的数据集（46 列和 180,00 行）时，它可以正常工作：

```
Input_Data <- read.csv("http://dl.dropbox.com/u/58164604/Input_Data.csv", row.names=1, stringsAsFactors = FALSE)

TPop<-Input_Data[1]
TPopCount <- TPop[, 1]
TPopSum <- sum(TPopCount)

OACRaw<-Input_Data[,4:50]
OACRawCount <-ncol(OACRaw)

OA_Percentage <- TPopCount/TPopSum * 100
Data_Per_Row <- OACRaw/matrix(rep(TPopCount, each=OACRawCount), ncol=OACRawCount, byrow=T)*100
Data_Index_Row <- Data_Per_Row/OA_Percentage * 100
names(Data_Per_Row) <- names(Data_Index_Row) <- names(OACRaw) 
```

谁能解释为什么会这样以及如何让这段代码在更大的数据集上工作？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:14:41.750

`OACRaw`您的数据框中有一些奇怪的值。例如，在第 184 列第 22 行，该值为反引号字符：“`”。当您尝试划分它时，这是错误的原因。

第 184 列之后可能还有其他虚假值。

所以错误不是由于数据的大小，只是因为当您只选择第一列时，虚假值被排除在外。

# php - 在 like 语句中使用 var

> ID：14676578
> 
> 赞同：-1
> 
> 时间：2013-02-03T19:53:03.533
> 
> 标签：php, sql

我在 sql 语句中使用了一个 var，它检查一个可能有很多标签的字段，例如

```
adtags="home, about, article"

$queryVar = 'home'

$bannerName = $wpdb->get_results($wpdb->prepare("select  pic.filename
,       pic.pid
,       fv1.field_value as MovieName
,       fv2.field_value as Adlink
from    ngg_pictures pic
inner join 
    nggcf_fields f1
on      f1.field_name = 'adtags'
inner join 
    nggcf_field_values as fv1
on      fv1.pid = pic.pid
    and fv1.fid = f1.id
inner join 
    nggcf_fields f2
on      f2.field_name = 'adlink'
inner join 
    nggcf_field_values as fv2
on      fv2.pid = pic.pid
    and fv2.fid = f2.id
where   fv1.field_value like '%s'   ",$queryVar)); 
```

注意（fv1.field_value 正在拉取广告标签）

如果 adtags 只包含一个标签，我可以在其中找到一个实例，并且我删除了 queryvar 方法，我可以让它工作，但我想做的是搜索 fv1.field_value 以查找 $queryVar 的出现（home 或任何传递的东西)

我认为为了做到这一点，我需要使用通配符，例如 %home%

```
where   fv1.field_value like '%home%' 
```

但是当查询变量被引用为 %s 时，我该如何实现这一点，我可以以某种方式逃避它吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T19:57:12.043

通配符用于匹配子字符串，例如 "%home%" 将匹配 "come home"、"three homeruns" 和 "homeward bound"。

您正在寻找`in`运营商，这可能是一个很好的起点：

[http://www.w3schools.com/sql/sql_in.asp](http://www.w3schools.com/sql/sql_in.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:02:56.633

**答案 1**

将有助于查看整行代码。只需将变量放在字符串中。

```
"where fv1.field_value like '%$queryVar%'"; 
```

在此之前，您可以做一些事情来避免可能的查询注入。

只取第一个词。

```
$queryVar = preg_replace('/\s.*$/', '', $queryVar); 
```

只取字母。

```
$queryVar = preg_replace('/[^a-z]+/i', '', $queryVar); 
```

**答案 2**

在查询之前执行此操作：

```
$queryVar = "%$queryVar%"; 
```

**答案 3**

用 % 转义。

```
where   fv1.field_value like '%%%s%%'   ",$queryVar)); 
```

# css - css3 repeating-linear-gradient - 得到细粒度的模式？

> ID：14676592
> 
> 赞同：1
> 
> 时间：2013-02-03T19:54:44.613
> 
> 标签：css, linear-gradients

我想创建一个细粒度的背景图案，在对角红线和蓝线之间交替，每条线的宽度只有几个像素。

我不确定我是否理解重复线性渐变的规则

例如，您会认为我想要的是这样的：

```
p {
  width: 100%;
  height: 100%;
  background-image: repeating-linear-gradient(45deg, red 3px, blue 3px)
} 
```

但这完全是蓝色的。

[这是一个例子](http://jsbin.com/uyixok/1/)

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T21:31:46.363

您放置的“3px”是从开始的偏移量，而不是从最后一个颜色停止的相对偏移量。

如果你想看到交替的颜色（没有渐变），你需要一些不同的东西：

```
body {
    background-image: repeating-linear-gradient(45deg, red 0px, red 3px, blue 3px, blue 6px);
} 
```

渐变以红色 ( `red 0px`) 开头。`red 3px`然后在接下来的三个像素 ( ) 中变为红色。然后变为蓝色 ( `blue 3px`) 并使接下来的三个像素变为蓝色 ( `blue 6px`)。

请参阅[http://jsfiddle.net/uhB3G/1/](http://jsfiddle.net/uhB3G/1/)（仅适用于当前的 Firefox，IIRC FF 17+）

# ruby-on-rails - NilClass:Class 的未定义方法“model_name”，在视图之间传递表单

> ID：14676598
> 
> 赞同：0
> 
> 时间：2013-02-03T19:55:16.407
> 
> 标签：ruby-on-rails, ruby, rails-activerecord

刚开始学习rails，我正在尝试将表单从一个视图传递到另一个视图......我假设这样做的方法是使用部分渲染。

我想将 /users/form 中包含的表单的部分传递给主视图中的 index.html.erb。我只想创建一个新用户，但是来自主视图中的 index.html.erb。

相关代码：

_form.html.erb（在用户视图中）

```
<%= simple_form_for(@user) do |f| %>
  <%= f.error_notification %>

  <div class="form-inputs">
    <%= f.input :email %>
    <%= f.input :condition, :hint => 'what should we look up for you?'%>
  </div>

  <div class="form-actions">
    <%= f.button :submit, 'Begin curation' %>

  </div>
<% end %> 
```

用户模型（user.rb）

```
class User < ActiveRecord::Base
  attr_accessible :condition, :email, :name
end 
```

users_controller.rb

```
class UsersController < ApplicationController
  # GET /users
  # GET /users.json
  def index
    @users = User.all

    respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @users }
    end
  end

  # GET /users/1
  # GET /users/1.json
  def show
    @user = User.find(params[:id])

    respond_to do |format|
      format.html # show.html.erb
      format.json { render json: @user }
    end
  end

  # GET /users/new
  # GET /users/new.json
  def new
    @user = User.new

    respond_to do |format|
      format.html # new.html.erb
      format.json { render json: @user }
    end
  end

  # GET /users/1/edit
  def edit
    @user = User.find(params[:id])
  end

  # POST /users
  # POST /users.json
  def create
    @user = User.new(params[:user])

    respond_to do |format|
      if @user.save
        format.html { redirect_to @user, notice: 'Thanks for sharing. We will be back with your curated information in 2-3 days time!' }
        format.json { render json: @user, status: :created, location: @user }
      else
        format.html { render action: "new" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end

  # PUT /users/1
  # PUT /users/1.json
  def update
    @user = User.find(params[:id])

    respond_to do |format|
      if @user.update_attributes(params[:user])
        format.html { redirect_to @user, notice: 'User was successfully updated.' }
        format.json { head :no_content }
      else
        format.html { render action: "edit" }
        format.json { render json: @user.errors, status: :unprocessable_entity }
      end
    end
  end

  # DELETE /users/1
  # DELETE /users/1.json
  def destroy
    @user = User.find(params[:id])
    @user.destroy

    respond_to do |format|
      format.html { redirect_to users_url }
      format.json { head :no_content }
    end
  end
end 
```

我确信这是一个简单的解决方法，我只是不知道语法。我检查了其他地方，并没有找到任何对我有帮助的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T19:56:50.767

我敢打赌你没有定义@user 变量。SimpleForm 需要一个来自正确模型的实例变量来有效地使用输入字段来发挥它的魔力。如果您的变量未实例化，它会给出该错误。

model_name 在 NilClass 上调用。NilClass 是你的@user。

试试这个：

```
<%= simple_form_for User.new do |f| %>
... 
```

## 更新

```
# app/controllers/users_controller.rb
class UsersController < ApplicationController

  before_filter :prepare_user_form, only: [:index, :new]

  protected

  def prepare_user_form
    @user = User.new
  end

end

# _form.html.erb
<%= simple_form_for @user do |f| %>
... 
```

# python - tkinter root.mainloop() 不适合？

> ID：14676602
> 
> 赞同：0
> 
> 时间：2013-02-03T19:55:28.880
> 
> 标签：python, matplotlib, tkinter

我有一个包含不同天体的大型数据库，我希望能够在 GUI 中为它们显示不同的信息。但是，我发现了一个大问题，不知道是否有办法治疗它或者我不得不放弃这个想法。

对于这些来源中的每一个，在绘制任何内容之前都需要执行大量计算。我的想法是打开一个主 GUI 窗口，然后逐个对象：

1.  首先进行计算。信息是通过使用 python 的 mysql 命令从数据库中获取的。在这个阶段结束时，我将绘制两个或三个数组。

2.  使用 GUI 显示这些图。在这个阶段，用户可以通过点击使用事件来删除一些坏点（因此GUI应该能够与数据库通信）。当一些点被删除时，必须更新图。

3.  当坏点被删除时，用户可以点击不同的按钮来对源进行分类（比如“星”、“星系”、“随便”）。

4.  一旦用户点击了任何分类按钮，程序将跳转到数据库中的下一个源，并再次启动该过程。

问题是，如果我这样做，我必须与 root.mainloop() 声明作斗争。鉴于对象的计算很复杂，涉及到很多代码，为了清楚起见，我非常希望避免在 GUI 中包含此代码。但否则，我将不得不打开一个 Tkinter 窗口，分类一个对象，关闭它，打开一个新对象，......这既耗时又令人不安......

有没有办法在 GUI 部分之外进行计算并将参数传递到 Tkinter 窗口而无需清除它？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:19:05.993

您可以在工作线程或单独的进程中运行计算。

对于任何单一的计算，它可以在不到一秒的时间内完成吗？如果是这样，让事件循环为您工作而不是对您不利。如果您可以以某种方式将所有计算放入列表、迭代器或生成器中，则可以使用`after`.

粗略地说，您的代码如下所示：

```
def do_one_calculation():

    <do the next calculation here>

    if there_are_more_calculations():
        root.after(100, do_one_calculation) 
```

根据您的计算速度有多快或多慢，您可以通过将第一个参数调整为每秒执行更多或更少的操作`after`。最终结果是计算“在后台”运行，这在 GUI 中意味着 GUI 不做任何事情的所有时间。

# spring - Hibernate 和 JPA 生产配置

> ID：14676603
> 
> 赞同：1
> 
> 时间：2013-02-03T19:55:30.753
> 
> 标签：spring, hibernate, jpa

我想知道是否有人可以查看我的生产 Hibernate 配置并让我知道我是否遗漏任何内容或给我任何提示以轻松提高***生产环境的性能***

```
<bean id="entityManagerFactory"
        class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
        </property>
        <property name="jpaProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">verify</prop>
                <prop key="hibernate.connection.pool_size">10</prop>
                <prop key="hibernate.current_session_context_class">thread</prop>
            </props>
        </property>
    </bean> 
```

基本上我想知道这个配置是否会导致连接池问题，我应该开始使用 c3p0

```
 <bean id="entityManagerFactory"
        class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
        <property name="dataSource" ref="dataSource" />
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter" />
        </property>
        <property name="jpaProperties">
            <props>
                <prop key="hibernate.dialect">org.hibernate.dialect.MySQLDialect</prop>
                <prop key="hibernate.show_sql">true</prop>
                <prop key="hibernate.hbm2ddl.auto">verify</prop>
                <prop key="hibernate.connection.pool_size">10</prop>
                <prop key="hibernate.current_session_context_class">thread</prop>
                <prop key="hibernate.c3p0.acquire_increment">1</prop>
                <prop key="hibernate.c3p0.min_size">5</prop>
                <prop key="hibernate.c3p0.max_size">20</prop>
                <prop key="hibernate.c3p0.timeout">300</prop>
                <prop key="hibernate.c3p0.max_statements">50</prop>
                <prop key="hibernate.c3p0.idle_test_period">3000</prop>
            </props>
        </property>
    </bean> 
```

如果是这样，这是配置 c3p0 的正确方法吗

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>com.example</groupId>
<artifactId>Reservosity</artifactId>
<packaging>war</packaging>
<version>0.0.1-SNAPSHOT</version>

<properties>
    <org.springframework.version>3.1.1.RELEASE</org.springframework.version>
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
</properties>

<dependencies>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>3.0.1</version>
        <scope>provided</scope>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-webmvc</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-orm</artifactId>
        <version>${org.springframework.version}</version>
    </dependency>
    <dependency>
        <groupId>taglibs</groupId>
        <artifactId>standard</artifactId>
        <version>1.1.2</version>
    </dependency>
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jstl</artifactId>
        <version>1.2</version>
    </dependency>
    <dependency>
        <groupId>org.hsqldb</groupId>
        <artifactId>hsqldb</artifactId>
        <version>2.2.8</version>
    </dependency>
    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.20</version>
    </dependency>
    <dependency>
        <groupId>commons-dbcp</groupId>
        <artifactId>commons-dbcp</artifactId>
        <version>1.4</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-entitymanager</artifactId>
        <version>3.6.10.Final</version>
    </dependency>
    <dependency>
        <groupId>com.github.jsimone</groupId>
        <artifactId>webapp-runner</artifactId>
        <version>7.0.27.1</version>
        <scope>provided</scope>
    </dependency>

    <dependency>
        <groupId>c3p0</groupId>
        <artifactId>c3p0</artifactId>
        <version>0.9.1.2</version>
    </dependency>

    <!-- Tiles dependency -->
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-core</artifactId>
        <version>2.2.1</version>
    </dependency>

    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-jsp</artifactId>
        <version>2.2.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-api</artifactId>
        <version>2.2.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-servlet</artifactId>
        <version>2.2.1</version>
    </dependency>
    <dependency>
        <groupId>org.apache.tiles</groupId>
        <artifactId>tiles-template</artifactId>
        <version>2.2.1</version>
    </dependency>

    <!-- Security -->
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-core</artifactId>
        <version>3.1.3.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-web</artifactId>
        <version>3.1.3.RELEASE</version>
    </dependency>
    <dependency>
        <groupId>org.springframework.security</groupId>
        <artifactId>spring-security-config</artifactId>
        <version>3.1.3.RELEASE</version>
    </dependency>

    <dependency>
        <groupId>javax.validation</groupId>
        <artifactId>validation-api</artifactId>
        <version>1.0.0.GA</version>
    </dependency>
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-validator</artifactId>
        <version>4.3.1.Final</version>
    </dependency>
    <dependency>
        <groupId>joda-time</groupId>
        <artifactId>joda-time</artifactId>
        <version>2.1</version>
    </dependency>

    <dependency>
        <groupId>org.codehaus.jackson</groupId>
        <artifactId>jackson-mapper-asl</artifactId>
        <version>1.9.11</version>
    </dependency>
</dependencies>

<build>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
        <plugin>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.2</version>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <version>2.4</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>copy</goal>
                    </goals>
                    <configuration>
                        <artifactItems>
                            <artifactItem>
                                <groupId>com.github.jsimone</groupId>
                                <artifactId>webapp-runner</artifactId>
                                <version>7.0.27.1</version>
                                <destFileName>webapp-runner.jar</destFileName>
                            </artifactItem>
                        </artifactItems>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:35:35.290

[休眠文档](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#tutorial-firstapp-configuration)说：

> 警告
> 
> 内置的 Hibernate 连接池绝不用于生产用途。它缺乏在任何体面的连接池上都可以找到的几个功能。

所以是的，您应该使用默认休眠连接池以外的连接池。池的配置完全取决于您的应用程序：典型的事务持续时间是多少，您想要支持多少并发事务等。

# ember.js - 通过在 Template 中设置 templateName 动态创建 Ember View

> ID：14676608
> 
> 赞同：2
> 
> 时间：2013-02-03T19:55:57.293
> 
> 标签：ember.js

我希望使用这样的变量加载我的视图：

```
{{#if model.isLoaded }}
  Loaded: {{ model.template.slug }}
  {{ view App.DocumentView templateName="model.template.slug" }}
{{ else }}
  Loading…
{{/if}} 
```

有没有办法将变量传递给这样的视图？当我的模型更新时，我怎么能加载它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T10:56:33.113

使用 Binding 将模板的名称绑定到模型的属性。

```
{{#if model.isLoaded }}
  Loaded: {{ model.template.slug }}
  {{ view App.DocumentView templateNameBinding="model.template.slug" }}
{{ else }}
  Loading…
{{/if}} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-10T13:59:38.640

我创建了一个库来帮助解决此类问题，请查看[github](https://github.com/juanjardim/ember-template-factory)

# gnu-make - BaseX 数据库中文档的修改时间戳

> ID：14676611
> 
> 赞同：0
> 
> 时间：2013-02-03T19:56:11.263
> 
> 标签：gnu-make, basex

我有一个 gnu make 系统，并且想根据 BaseX XML 数据库中文档的更新来触发规则。换句话说，`archive(member)`可以在 gnu make 中使用类似的东西来引用存档的成员，我想使用`db(foo.xml)`. 或者，由于这可能是不可能的，一些解决方法涉及创建具有正确时间戳的虚拟文件，但我什至无法弄清楚如何从 BaseX 数据库中的文档中检索修改日期。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-29T15:06:13.857

标记为 BaseX 不维护文档修改时间的**答案**。

# css - 如何在 CSS 文件中导入 Google Web 字体？

> ID：14676613
> 
> 赞同：294
> 
> 时间：2013-02-03T19:56:20.913
> 
> 标签：css, fonts, google-webfonts

我正在使用只能访问 CSS 文件的 CMS。所以，我不能在文档的 HEAD 中包含任何东西。我想知道是否有办法从 CSS 文件中导入网络字体？

* * *

## 回答 #1

> 赞同：452
> 
> 时间：2013-02-03T20:00:41.193

使用[`@import`](https://developer.mozilla.org/en-US/docs/Web/CSS/@import)方法：

```
@import url('https://fonts.googleapis.com/css?family=Open+Sans&display=swap'); 
```

显然，"Open Sans" ( `Open+Sans`) 是导入的字体。所以用你的替换它。`+`如果字体名称有多个单词，请像我一样，通过在每个单词之间添加一个符号来对其进行 URL 编码。

确保将 放在`@import`CSS 的最顶部，在任何规则之前。

Google Fonts 可以自动`@import`为您生成指令。选择字体后，单击`(+)`它旁边的图标。在左下角，将出现一个名为“1 Family Selected”的容器。单击它，它将展开。使用“自定义”选项卡选择选项，然后切换回“嵌入”并单击“嵌入字体”下的“@import”。`<style>`将标签之间的 CSS 复制到样式表中。

[![](../Images/44ad13f76d4077ef90ac2f3c3799c1b1.png)](https://i.stack.imgur.com/2rmPS.png)

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2015-07-01T21:52:17.313

```
<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Open+Sans:300,400,600,700&amp;lang=en" /> 
```

最好不要使用`@import`。只需`link`在布局的头部使用元素，如上所示。

* * *

## 回答 #3

> 赞同：56
> 
> 时间：2017-04-23T15:01:38.637

下载字体 ttf/其他格式文件，然后简单地添加这个 CSS 代码示例：

```
@font-face { font-family: roboto-regular; 
			 src: url('../font/Roboto-Regular.ttf'); } 
h2{
	font-family: roboto-regular;
}
```

* * *

## 回答 #4

> 赞同：45
> 
> 时间：2015-12-13T11:45:29.073

在您的 CSS 文件中添加以下代码以导入 Google Web 字体。

```
@import url(https://fonts.googleapis.com/css?family=Open+Sans); 
```

将**Open+Sans**参数值替换为您的字体名称。

您的 CSS 文件应如下所示：

```
@import url(https://fonts.googleapis.com/css?family=Open+Sans);

body{
   font-family: 'Open Sans',serif;
} 
```

* * *

## 回答 #5

> 赞同：20
> 
> 时间：2016-10-11T07:38:48.080

1.  只需访问[https://fonts.google.com/](https://fonts.google.com/)
2.  **通过单击+**添加字体
***   转到选定的字体 > 嵌入 > @IMPORT > 复制 url 并将 .css 文件粘贴到正文标记上方。*   完成。**

 *** * *

## 回答 #6

> 赞同：20
> 
> 时间：2018-09-11T08:16:24.243

除了上述答案，还要考虑这个网站； [https://google-webfonts-helper.herokuapp.com/fonts](https://google-webfonts-helper.herokuapp.com/fonts)

主要优势：

*   **允许您*自行托管*这些谷歌字体以获得更好的响应时间**

其他优点：

*   选择你的字体
*   选择你的字符集
*   选择你的字体样式/重量
*   选择您的目标浏览器（现代首选）
*   你得到 CSS 片段（添加到你的 css 样式表）加上一个字体文件的压缩包，以包含在你的项目文件夹中（比如 css_fonts）

在文件 **'your_css_theme.css'中**添加

```
/* open-sans-regular - latin - modern browsers  */
@font-face {
   font-family: 'Open Sans';
   font-style: normal;
   font-weight: 400;
   src: local(''),
        url('css_fonts/open-sans-v18-latin-regular.woff2') format('woff2'), /* Chrome 26+, Opera 23+, Firefox 39+ */
        url('css_fonts/open-sans-v18-latin-regular.woff') format('woff'); /* Chrome 6+, Firefox 3.6+, IE 9+, Safari 5.1+ */
 }

 body { 
        font-family: 'Open Sans',sans-serif;  
 } 
```

* * *

## 回答 #7

> 赞同：12
> 
> 时间：2013-02-03T19:59:47.893

使用标签@import

```
@import url('http://fonts.googleapis.com/css?family=Kavoon'); 
```

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2013-02-03T20:04:09.570

您还可以使用 @font-face 链接到 URL。 [http://www.css3.info/preview/web-fonts-with-font-face/](http://www.css3.info/preview/web-fonts-with-font-face/)

CMS 是否支持 iframe？您也可以将 iframe 放入内容的顶部。这可能会更慢 - 最好将其包含在您的 CSS 中。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-07-07T10:23:26.083

```
<link href="https://fonts.googleapis.com/css?family=(any font of your 
choice)" rel="stylesheet" type="text/css"> 
```

要选择字体，您可以访问链接：**[https ://fonts.google.com](https://fonts.google.com)**

*从网站上写下您选择的字体名称，不包括括号。*

**例如**，您选择 Lobster 作为您选择的字体，

```
<link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" 
type="text/css"> 
```

*然后，您可以在整个 HTML/CSS 文件中正常使用它作为字体系列。*

**例如**

```
<h2 style="Lobster">Please Like This Answer</h2> 
```

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2017-06-12T06:46:00.947

只需通过链接

[https://developers.google.com/fonts/docs/getting_started](https://developers.google.com/fonts/docs/getting_started)

要将其导入样式表，请使用

```
@import url('https://fonts.googleapis.com/css?family=Open+Sans'); 
```

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-05-26T09:20:54.503

我们可以在 css3 中轻松做到这一点。我们必须简单地使用@import 语句。以下视频很容易地描述了如何做到这一点。所以请继续注意。

[https://www.youtube.com/watch?v=wlPr6EF6GAo](https://www.youtube.com/watch?v=wlPr6EF6GAo)

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2021-05-12T12:28:30.017

自 2015 年以来，谷歌方面发生了一些变化。我很难找到它，所以想包括新方法：

1.  在所需的字体页面上向下滚动
2.  单击字体名称旁边的小加号图标
3.  嵌入链接和其他选项将出现在网页右侧的“选定家庭”对话框中。**

# android - 如何使用 intellij idea 获取地图 api 发布密钥？

> ID：14676616
> 
> 赞同：1
> 
> 时间：2013-02-03T19:56:29.407
> 
> 标签：android, api, map, android-keystore

编辑：

1.  在这一点上，我应该确保如果我可以成功创建它，它是否可以在从谷歌市场下载的 apk 上运行？我的意思是如果我通过我的服务器发布应用程序，它会正常运行吗？ **是的**

2.  有一些与获取“释放密钥”相关的示例，但没有什么可以帮助我。我生成了我的调试密钥，它没有任何问题。但我无法获得发布 api 密钥。我做了几乎所有写在互联网和 stackoverflow 上的东西。

如果我有调试密钥，我应该怎么做才能获得发布密钥？

**答案**：[http ://chocotech.blogspot.com/2012/10/get-debug-key-and-release-key-for.html](http://chocotech.blogspot.com/2012/10/get-debug-key-and-release-key-for.html)

# c# - WCF 合同命名空间未被识别

> ID：14676625
> 
> 赞同：0
> 
> 时间：2013-02-03T19:57:16.647
> 
> 标签：c#, wcf, datacontractserializer, datacontract

当我尝试为我的 WCF 服务的合同对象指定自定义命名空间时遇到了问题。

我有以下两个合同：

```
[MessageContract(WrapperNamespace="http://www.mysite.com/Contracts/Users")]
public class CreateUserRequest
{
    [MessageBodyMember]
    public User User { get; set; }
}
[MessageContract(WrapperNamespace="http://www.mysite.com/Contracts/Users")]
public class CreateUserRequest
{
    [MessageBodyMember]
    public int ID {get;set;

    [MessageBodyMember]
    public string Name {get;set;}
} 
```

使用此合约的此操作的定义如下：

```
 [OperationContract]
    [WebInvoke(BodyStyle=WebMessageBodyStyle.Bare)]
    CreateUserResponse CreateUser(CreateUserRequest request); 
```

我正在向此服务操作发送内容类型为**application/xml的以下 XML。**

```
<CreateUserRequest xmlns="http://www.mysite.com/Contracts/Users">
        <User> 
               <First>John</First>
               <Last>Smith</Last>
               <Username>john</Username>
               <Password>password</Password>
        </User>
</CreateUserRequest> 
```

我也尝试在打开的用户标记中再次指定命名空间，但是当我调试我的操作时，用户进入为空。

我试图做一个返回这个对象的 Test() 方法，它似乎没有识别命名空间的变化，或者它只是不工作。任何想法为什么？

# c++ - 当需要数组删除运算符时，为什么常规删除运算符起作用？

> ID：14676630
> 
> 赞同：1
> 
> 时间：2013-02-03T19:57:42.403
> 
> 标签：c++, visual-c++, clang

我最近发现我们代码中的很多地方都在做这样的事情：

```
int * int_array = new int[1000];

// ... do things with int_array

delete int_array; 
```

问题当然是它应该使用`delete []`运算符，而不是常规`delete`运算符。

谜团是：这段代码在 Windows 上由 Visual Studio 2003 和 2005 编译，在 OS X 上由 GCC / clang 编译时，已经运行了好几年。为什么这之前没有导致事情发生严重错误？

据我了解，我们告诉编译器以“错误”的方式释放内存，通常如果你这样做，会发生可怕的事情并且你的程序崩溃。为什么这不会发生在我们身上？现代编译器是否会自动为您“做正确的事情”，或者是否足够正确的事情对基本类型无关紧要，或者其他什么？我不能接受我们只是运气好，因为这段代码已经使用了多年，在多种不同的操作系统下被成千上万的客户使用。

请注意，我不是在为做错事找借口，只是想了解为什么我们不会因为做错事而陷入困境。:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T20:04:07.390

这是未定义行为的本质——它可能完全按照您的意图去做。问题是，对于编译器、操作系统、库或 CPU 的下一版本……它可能会做一些完全不同的事情。

最有可能的是，您逃脱它有两个原因：

1.  `int`没有析构函数。因此，未能正确销毁数组中的每个元素没有任何后果。

2.  在这个平台上，`new`并`new[]`使用相同的分配器。因此，您不会将块返回给错误的分​​配器。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T04:50:49.867

让我们逐步了解发生了什么（但我们将忽略异常）：

```
int *foo = new int[100]; 
```

这会分配`100*sizeof(int)`内存字节并调用`int::int()`100 次，为数组中的每个元素调用一次。

由于`int`是内置类型，它有一个简单的构造函数（即，它什么都不做）。

现在，怎么样：

```
delete foo; 
```

这将调用`int::~int()`指向的地址`foo`，然后删除 指向的内存`foo`。同样，由于`int`它是一个内置类型，它有一个微不足道的析构函数。

将此与以下内容进行比较：

```
delete [] foo; 
```

这将调用`int::~int()`指向的数组中的每个项目，`foo`然后删除 foo 指向的内存。

这里的基本区别是元素 1..99 不会被破坏。因为`int`这不是问题，这可能就是您现有代码有效的原因。对于具有真正析构函数的对象数组，您会看到更多的不当行为。

PS即使您使用array-new分配它，大多数实现都会删除指向的整个内存块，但`foo`如果`delete foo;`您指望它，您将是愚蠢的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T20:00:15.467

这不起作用。不删除数组`[]`会泄漏内存。如果您的应用程序长时间运行，它会影响性能。对于短命的节目不会有问题。

另一件需要注意的事情是`delete`会破坏所有被分配的内存`new`。`new`如果您已通过(not )分配了一个数组，`new []`则可以使用它`delete`来销毁它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T20:00:27.483

这不会导致程序崩溃，但`999 * sizeof(int)`每次这样做都会泄漏内存字节。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-03T20:01:13.547

常规`delete`运算符实际上可能会从数组中释放所有内存，具体取决于分配器，但真正的问题是它永远不会在数组元素上运行任何析构函数。

# html - 显示带有大数字和几个文字的信息图表的最简单方法

> ID：14676632
> 
> 赞同：1
> 
> 时间：2013-02-03T19:58:09.633
> 
> 标签：html, css

我想创建一个包含多个项目的页面，每个项目都有一个大数字和侧面的一些文字（如底部的“大银行繁荣[”](http://cdn2.business2community.com/wp-content/uploads/2013/01/small-business-credit-nfib-infographic-large.gif)）

我找到了两个解决方案。

*   为每个项目使用带有 CSS 布局的两列

这个解决方案的问题是，HTML 将有大量的 div（每个包装一个和两列。

*   用这个大数字创建一个图像，并将其作为一些带有侧面文本的 div 的背景。

HTML 会简单得多，但在这种情况下，如果我必须更改数字，我将需要一直创建新图像。

任何人都可以推荐更好的（从源代码角度来看简约）解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:10:41.060

我会使用来自 HTML5 的新数据属性和带有`content`. 标记非常少，而且很容易更改。

**HTML：**

```
<p data-text="50%">According to some statistician, 50% of all humans...</p> 
```

**CSS：**

```
p {
    width: 20em;
    padding-left: 7em;
    position: relative;
}
p::before {
    content: attr(data-text);
    position: absolute;
    top: .25em;
    left: 0;
    font-size: 3em;
} 
```

[演示](http://jsfiddle.net/CZZWK/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:12:24.720

在这种情况下使用图像不仅从开发人员的角度来看是一个糟糕的解决方案，而且因为它给您的文档带来了错误的语义含义。数字应该标记为数字 - 或尽可能接近 - 而不是图像。

现在，您可以做的是创建一个 div 标签，例如创建一个 div 标签 - 或者任何其他在语义上更接近它所包含内容的标签 - 并在其中包含两个元素，数字作为跨度，或者实际上，此时的任何内容，你就明白了，把文字当作一个段落。

```
<div>
   <span>45%</span>
   <p>Lorem ipsum dolor amet.</p>
</div> 
```

为了使它看起来像您在该信息图中向我们展示的那样很简单，我将向您展示代码并在之后进行解释：

```
div {
   width: 500px;
}

span {
   display: block;
   float: left;
   width: 40%;
} 
```

这是基本思想。您将 span 元素与内部的数字一起浮动到左侧，以便数字和段落彼此相邻。根据需要增加跨度的字体大小，使用颜色或字体系列使其看起来更好。

如果更多这些 div 元素将出现在彼此下方，则必须确保它们被正确清除：

```
div:after {
   clear: both;
   content: '';
   height: 0;
} 
```

这也确保您的浮动元素不会出现在您的 div 中，如果应用了边框，它会看起来很奇怪。

# d3.js - d3.js -- 带有颜色类别的堆叠条

> ID：14676633
> 
> 赞同：1
> 
> 时间：2013-02-03T19:58:11.340
> 
> 标签：d3.js

我正在尝试使用 d3.js 中的堆栈布局构建堆积条形图（请参阅我在这里的位置：http://bl.ocks.org/4676028 [）](http://bl.ocks.org/4676028)。我已经正确显示和堆叠了条形图。但是我的数据存在差距，因此对于这些情况，我使用插值。因此，在我的数据文件中，每个数据类别都有两列：一列用于实际数值，另一列带有 0/1 标志，指示该值是否为插值。

我想要做的是检查标志，如果值被插值，改变矩形填充的颜色或不透明度。但我终其一生都无法弄清楚如何做到这一点——d3 的数据结构让我很困惑。非常感激任何的帮助。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T03:24:26.670

终于想通了；发布以防其他人遇到类似问题。您可以使用标准 javascript 语法访问不同的数组。唯一棘手的是，使用 d3 的堆栈布局，索引值 (i) 会为堆栈中的每个系列重置。因此，您需要某种计数器值来跟踪每次启动新系列时的增量。

```
var n = 0;
var rect = tnum.selectAll("rect")
  .data(function(d) {return(d)})
.enter().append("svg:rect")
  .attr("x", function(d) { return x(d.x); })
  .attr("y", function(d) { return -y(d.y0) - y(d.y); })

  .attr("height", function(d) { return y(d.y); })
  .attr("width", x.rangeBand())
  .attr("title",  function(d) { return d.x; }) 
  .attr("class", function(d) { return d.y; })
  .style("opacity", function(d, i) { 

    if(i === interp[0].length-1 && n < 2) {
    n+=1;
    }
    var flag = interp[n][i].int;

  console.log();

  if (flag == 1) {return "0.85"}    // if close is less than 400 fill = red
        else    { return "1" ;}}) 
```

# qt - 用 cmake 编译 qt 库

> ID：14676640
> 
> 赞同：1
> 
> 时间：2013-02-03T19:58:57.727
> 
> 标签：qt, cmake

我很抱歉我的愚蠢问题。我正在尝试使用带有 Qt 对象的类中的 cmake 编译 dll。库包含使用其他文件中定义的类的函数。在链接过程中，我收到错误“未定义的引用”到类成员。CMakeList.txt 中的错误在哪里？

CMakeList.txt：

```
cmake_minimum_required(VERSION 2.8) 
project(foo)            
set(SOURCE_LIB foo.cpp window.cpp)          
find_package (Qt4 REQUIRED)
include (${QT_USE_FILE})
ADD_DEFINITIONS(-DFOO_LIBRARY)
add_library(foo SHARED ${SOURCE_LIB})   
target_link_libraries(foo ${QT_LIBRARIES}) 
```

富.h：

```
#ifndef FOO_H
#define FOO_H

#include "foo_global.h"

void FOOSHARED_EXPORT hello_world();
#endif // FOO_H 
```

foo.cpp：

```
#include <QApplication>
#include <QMessageBox>
#include "window.h"

void hello_world()
{
    int argc = 0;
    char ** argv = (char **) 0;
    QApplication a(argc, argv);
    Window *w = new Window();
    w->Msg();
} 
```

foo_global.h：

```
#ifndef FOO_GLOBAL_H
#define FOO_GLOBAL_H

#include <QtCore/qglobal.h>

#if defined(FOO_LIBRARY)
#  define FOOSHARED_EXPORT Q_DECL_EXPORT
#else
#  define FOOSHARED_EXPORT Q_DECL_IMPORT
#endif

#endif // FOO_GLOBAL_H 
```

窗口.cpp：

```
#include <QMessageBox>
#include "window.h"

void Window :: Msg()
{
    QMessageBox *msg = new QMessageBox();
    msg->setText("hello");
    msg->exec();
} 
```

窗口.h：

```
#ifndef WINDOW_H
#define WINDOW_H

#include <QtGui>

class Window
{
    Q_OBJECT
public:
    void Msg();

};

#endif // WINDOW_H 
```

输出：

```
Test\build>c:\MinGW\bin\mingw32-make.exe
Scanning dependencies of target foo
[ 50%] Building CXX object CMakeFiles/foo.dir/foo.cpp.obj
[100%] Building CXX object CMakeFiles/foo.dir/window.cpp.obj
Linking CXX shared library libfoo.dll
Creating library file: libfoo.dll.a
CMakeFiles\foo.dir/objects.a(foo.cpp.obj):foo.cpp:(.text$_ZN6WindowC1Ev[Window::
Window()]+0x8): undefined reference to `vtable for Window'
collect2: ld returned 1 exit status
mingw32-make[2]: *** [libfoo.dll] Error 1
mingw32-make[1]: *** [CMakeFiles/foo.dir/all] Error 2
mingw32-make: *** [all] Error 2 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-04T07:16:59.840

包含`Q_OBJECT`宏的类的所有头文件必须由元对象编译器处理。因此，您的 cmake 文件应如下所示：

```
cmake_minimum_required(VERSION 2.8) 
project(foo)            
set(LIB_SOURCE foo.cpp window.cpp)          
set(LIB_HEADER foo.h)
find_package (Qt4 REQUIRED)
include (${QT_USE_FILE})
ADD_DEFINITIONS(-DFOO_LIBRARY)

QT4_WRAP_CPP(LIB_HEADER_MOC ${LIB_HEADER})

add_library(foo SHARED ${LIB_SOURCE} ${LIB_HEADER_MOC})   
target_link_libraries(foo ${QT_LIBRARIES}) 
```

# php - 在线展示访客的最佳方式

> ID：14676641
> 
> 赞同：-2
> 
> 时间：2013-02-03T19:58:58.660
> 
> 标签：php, mysql

我一直在思考这个问题。一个有 10000 名访问者 24/7 在线访问的网站，运行查询以选择所有具有 lastaction > time() - 300（5 分钟前）的行不是很好吗？此查询将每分钟运行数千次。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:10:15.930

使用像[memcached](http://memcached.org/)（[文档](http://php.net/manual/en/book.memcache.php)）这样的缓存。

然后，仅在缓存已过期时才运行此查询

```
SELECT count(*) FROM users WHERE status = 1 // assume status = 1 = logged in here 
```

像这样：

```
$memcache = memcache_connect('localhost', 11211);
// it is highly important to firewall off your memcache port.
$contents = memcache_get($memcache, 'user_count');
if ($contents === false) {
    $count = /* query here */
    memcache_set($memcache, 'user_count', $count, 0, 2);
} else {
    $count = htmlspecialchars($contents);
    // note: slightly unsafe in that there is no security. always escape. 
} 
```

# javascript - 如何环绕元素内的部分文本？

> ID：14676642
> 
> 赞同：1
> 
> 时间：2013-02-03T19:59:02.073
> 
> 标签：javascript, jquery, html, text, word-wrap

假设我有一句话：

```
Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
```

`<p>`标签内。我想以某种方式使用 javascript 在 word 周围创建一个元素`amet`，例如：

```
Lorem ipsum dolor sit <span>amet</span>, consectetur adipiscing elit. 
```

有什么方法可以做到这一点吗？在实际的应用程序中，我不知道我想在什么文本周围有一个元素，所以我不能只修改 HTML。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:05:25.680

一种选择是使用`replace`方法。

```
$('p').html(function(index, oldHtml){
   return oldHtml.replace(/(amet)/g, '<span>$1</span>');
}); 
```

[http://jsfiddle.net/YxMvq/](http://jsfiddle.net/YxMvq/)

# c++ - 将过剩与 Qt4 联系起来

> ID：14676644
> 
> 赞同：-1
> 
> 时间：2013-02-03T19:59:16.997
> 
> 标签：c++, qt, opengl, glut

与 Qt 相比，我想要一个 OpenGL 窗口。但是，如何将 glut/openGL 库链接到 Qt？我尝试了一些教程，但没有帮助。

这些是我的问题：

1.  我是否必须将库放在 Qt 中的编译器文件夹中？

2.  我必须使用哪个 Qt 项目来启动 OpenGL 程序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T22:21:00.787

> 如何将 glut/openGL 库链接到 Qt？

GLUT 不是 OpenGL 的一部分。GLUT 是一个简单的应用程序框架，用于制作简单的 OpenGL 演示应用程序。将 GLUT 视为一种非常小、非常有限的 Qt。

Qt 本身带有可接受的 OpenGL 支持（它并不理想，直到最近我才受到它的一些缺点的阻碍，但普通用户不会注意到它）。Qt 有 QGLWidget，它为您创建了一个 OpenGL 上下文。

链接照常进行。

> 我是否必须将库放在 Qt 中的编译器文件夹中？

不！永远不要复制图书馆。OpenGL 开发文件随您的编译器一起提供，并且可以直接访问它们。只需与`opengl32.lib`(Windows) 或`libGL.so`(Unix/Linux) 或`OpenGL`框架（在 MacOS X 上）链接。

> 我必须使用哪个 Qt 项目来启动 OpenGL 程序？

随你喜欢。它当然应该打开一些窗口，您可以在其中添加 QGLWidget 子窗口。

# qt - QT 5.0.1 QMake 不做任何事情

> ID：14676645
> 
> 赞同：1
> 
> 时间：2013-02-03T19:59:17.200
> 
> 标签：qt, qmake

我对 Qt 很陌生，我想做一个简单的图像编辑器。所以我下载了 5.0.1 并且我在 Qt Creator 中，据我所知，它可以让您设计 UI 并从编辑器中构建/运行。

我想实际使用 Visual Studio IDE，因为我觉得它很舒服，所以我假设我需要在我的 Qt 项目上运行 qmake。它输出它已正常退出，但我在任何地方都没有得到任何 .sln 文件或 .proj 文件，我似乎只在调试文件夹中得到一个 vc100.pdb 文件。

```
# Add more folders to ship with the application, here
folder_01.source = qml/untitled
folder_01.target = qml
DEPLOYMENTFOLDERS = folder_01

# Additional import path used to resolve QML modules in Creator's code model
QML_IMPORT_PATH =

# If your application uses the Qt Mobility libraries, uncomment the following
# lines and add the respective components to the MOBILITY variable.
# CONFIG += mobility
# MOBILITY +=

# The .cpp file which was generated for your project. Feel free to hack it.
SOURCES += main.cpp

# Please do not modify the following two lines. Required for deployment.
include(qtquick2applicationviewer/qtquick2applicationviewer.pri)
qtcAddDeployment() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:28:37.630

如果你使用不同于 express 的 Visual Studio 版本，你可以安装[VS 插件](http://qt-project.org/downloads#qt-other)并且你不需要手动运行*qmake*（或者创建项目，或者创建 sln 和项目，你仍然会使用外部设计器应用程序）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:29:03.270

不要为 qmake 和其他东西烦恼，只需[下载 Visual Studio Add-In](http://qt-project.org/downloads#qt-other)，它可以让您忘记所有这些问题。您只需要安装其中一个（取决于您使用的 Visual Studio），为您的 Qt 二进制文件选择路径并享受 :) 创建新项目后，所有路径都将被设置，您所需要的只是运行选项“构建项目”

# c# - 为什么我会收到此错误：需要返回值或抛出异常？

> ID：14676652
> 
> 赞同：2
> 
> 时间：2013-02-03T19:59:55.943
> 
> 标签：c#, unit-testing, tdd, rhino-mocks

尝试运行测试时出现以下错误。我试过**`IgnoreArguments()`** 了，但这似乎没有奏效。这个异常只有在我尝试时才会抛出，**`mock.Ordered()`**如果我这样做**`mock.Record()`**了，它就会通过。

> System.InvalidOperationException：以前的方法“IProductRepository.GetAllProducts();” 需要返回值或抛出异常。

* * *

```
 [Test]
        public void TestwithOrderedRecordsandPlayBack()
        {
            var mock = new MockRepository();
            var productRepository = mock.StrictMock<IProductRepository>();

            var product = new Grains
            {
                Name = "Wonder Bread",
                Category = "Grains"
            };

            IList list = new ArrayList();
            //Class under test
            var service = new ProductService(productRepository);

            using (mock.Ordered())
            {
                Expect.Call(productRepository
                    .GetAllProducts())
                    .IgnoreArguments()
                    .Return(new ArrayList());
                Expect.Call(()=>productRepository.SaveProduct(product));
            }

            using (mock.Playback())
            {
                list = service.GetAllProducts();
                service.SaveProduct(product);
            }
        } 
```

* * *

服务电话：

```
 public virtual IList GetAllProducts()
        {
            IList list = _productRepository.GetAllProducts();
            return list;
            //throw new System.Exception("Not implemented");
        }

public virtual IList GetAllProducts()
        {
            IList list = _productRepository.GetAllProducts();
            return list;
            //throw new System.Exception("Not implemented");
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:39:50.070

```
 using (mock.Ordered())
        {
            Expect.Call(productRepository
                .GetAllProducts())
                .IgnoreArguments()
                .Return(new ArrayList());
            Expect.Call(() => productRepository.SaveProduct(product));
        } 
```

这失败了，与您描述的错误完全相同。System.InvalidOperationException：以前的方法“IProductRepository.GetAllProducts();” 需要返回值或抛出异常。

原因是模拟存储库从未离开记录模式。您可能会认为（我也这样做过）`mock.Ordered()`将存储库置于某种有序记录状态，但事实并非如此。因此，您需要指定何时完成记录行为。

您可以通过两种方式做到这一点：

```
 using (mock.Record())
        using (mock.Ordered())
        {
            Expect.Call(productRepository.GetAllProducts()).Return(new ArrayList());
            Expect.Call(() => productRepository.SaveProduct(product));
        } 
```

或在完成录制后删除 mock.ReplayAll()：

```
 using (mock.Ordered())
        {
            Expect.Call(productRepository.GetAllProducts()).Return(new ArrayList());
            Expect.Call(() => productRepository.SaveProduct(product));
        }

        mock.ReplayAll();

        using (mock.Playback())
        {
            service.GetAllProducts();
            service.SaveProduct(product);
        } 
```

我测试了两者，都工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:08:18.730

不是 100% 肯定，但将其作为答案删除，以便您可以轻松阅读答案/评论。**让我知道这是否不是解决方案，然后我将删除答案以避免混淆。**

我认为你的问题在于

`Expect.Call(()=>productRepository.SaveProduct(product))`

您已经处于录制模式 ( `mock.Ordered()`)，因此无需指定`Expect.Call()`。

`Expect.Call()`要求返回值。您只是在寻找一种方法来验证方法 save 是否被调用。

我认为您应该将代码更改为：

```
 using (mock.Ordered())
        {
            Expect.Call(productRepository
                .GetAllProducts())
                .IgnoreArguments()
                .Return(new ArrayList());
            productRepository.SaveProduct(product);
        } 
```

（您可能认为您在测试方法中调用了 SaveProduct，但您不会，RhinoMocks 比这更聪明，并且会记录这个 void 调用）

# php - 具有长路径和未知键的巨大数组

> ID：14676654
> 
> 赞同：0
> 
> 时间：2013-02-03T19:59:58.933
> 
> 标签：php, arrays

我有一个巨大的数组，例如这里是元素的路径（文本数据）：

```
$content['start']**[0]**['teaser']**[14]**['body'][0]['markup'];
$content['start']**[1]**['teaser']**[98]**['body'][0]['markup']; 
```

如果键（标记为**）是可变的，有什么方法可以到达这些元素？

使用第一个键 [0]、[1] 我可以使用 count() 进行处理，但第二个键...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:07:19.123

您可以使用[array_keys](http://php.net/array_keys)来获取密钥。您没有指定是否会有多个键，因此此示例假定一个（未知）键（如果有多个，则必须使用嵌套循环）

```
$key1 = array_keys($content['start']);
$key1 = $key1[0];

$key2 = array_keys($content['start'][$key1]['teaser']);
$key2 = $key2[0];

$value = $content['start'][$key1]['teaser'][$key2]['body'][0]['markup']; 
```

# ruby - 无法挽救 YAML.load 异常

> ID：14676656
> 
> 赞同：2
> 
> 时间：2013-02-03T20:00:12.627
> 
> 标签：ruby, exception, exception-handling, yaml

我正在尝试处理在 Ruby 中加载无效的 YAML 数据，但似乎无法挽救 psych 引发的异常。

这是一些示例代码来演示我遇到的问题：

```
require 'yaml'
begin
    YAML.load('&*%^*')
rescue
    puts "Rescued"
end 
```

还有一个例外：

```
# ruby test.rb
/usr/lib64/ruby/1.9.1/psych.rb:203:in `parse': (<unknown>): did not find expected alphabetic or numeric character while scanning an anchor at line 1 column 1 (Psych::SyntaxError)
    from /usr/lib64/ruby/1.9.1/psych.rb:203:in `parse_stream'
    from /usr/lib64/ruby/1.9.1/psych.rb:151:in `parse'
    from /usr/lib64/ruby/1.9.1/psych.rb:127:in `load'
    from test.rb:3:in `<main>' 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-03T20:15:54.010

的继承`SyntaxError`是：

```
SyntaxError < ScriptError < Exception 
```

`rescue`没有参数只捕获`StandardError`它的子类`Exception`：

```
StandardError < Exception 
```

因此，如果您想从 中捕获语法错误`Yaml.load`，您必须`rescue SyntaxError => e`使用 或 来捕获所有错误`rescue Exception => e`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-03T20:05:55.553

请参阅[Begin Rescue 未捕获错误](https://stackoverflow.com/questions/3168160/begin-rescue-not-catching-error)。可以挽救语法错误，但不推荐。这就是为什么您需要跳过键入“ `rescue SyntaxError`”的额外步骤。

# ruby-on-rails - 将 Rails Net::HTTP 请求转换为 MD5 Hex Digest

> ID：14676669
> 
> 赞同：0
> 
> 时间：2013-02-03T20:01:03.530
> 
> 标签：ruby-on-rails, ruby, http-post, md5

为了使用第三方 API，我需要将 Net::HTTP::Post 请求编码为 MD5 十六进制摘要，然后将其用作签名的一部分。但是，当我尝试简单时`Digest::MD5.hexdigest(req)`，它会引发“无法转换为字符串错误”，而当我明确时`req.to_s`，它只会给出 MD5`#<Net::HTTP::Post:0x112a0eef8>`

我只是：

```
request = Net::HTTP::Post.new(url.path)
request.body = {
  "key" => "val"
}.to_json
# later...
hexDigest = Digest::MD5.hexdigest(request) 
```

这是文档化的规范，我认为：“[with the] JSON body contains the new information。”

这是他们提供的相关示例 Java 代码：

```
ByteArrayOutputStream requestOutputStream = new ByteArrayOutputStream();
httpMethod.getEntity().writeTo(requestOutputStream);
DigestUtils.md5Hex(requestOutputStream.toByteArray()).toLowerCase(); 
```

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T16:14:10.623

这些行的等效 ruby​​ 代码是：

```
OpenSSL::Digest::MD5.hexdigest(request.body) 
```

`httpMethod.getEntity()`将返回定义为请求正文的 json。

`requestOutputStream.toByteArray()`将返回与请求正文对应的字节数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:20:31.010

尝试显式调用“to_s”方法，它应该会有所帮助：

```
hexDigest = Digest::MD5.hexdigest(request.to_s) 
```

# objective-c - 生成 20 世纪的第一个月 - Objective-C

> ID：14676670
> 
> 赞同：1
> 
> 时间：2013-02-03T20:01:03.323
> 
> 标签：objective-c, date, nsdate, nsdatecomponents, date-formatting

我正在使用 Objective-C 创建一堆代码来确定从 1/1/1901 到 31/12/2000 每月的第一天。我想得到这个输出：

```
1/1/1901
1/2/1901
1/3/1901
.
.
.
1/11/2000
1/12/2000 
```

但我得到每个月的最后一天：

```
31/1/1901
28/2/1901
.
.
.
30/11/2000
31/12/2000 
```

这是我的代码：

```
int main(int argc, const char * argv[])
{

@autoreleasepool {

    NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
    [formatter setDateFormat:@"dd/MM/yyyy"];
    NSDate *date = [[NSDate alloc] init];
    date = [formatter dateFromString:@"01/01/1901"];
    NSDate *stopDate = [[NSDate alloc] init];
    stopDate = [formatter dateFromString:@"31/12/2000"];

    NSCalendar *cal = [NSCalendar currentCalendar];

    while ([[date earlierDate:stopDate] isEqualToDate:date]){
        NSDateComponents *comps = [cal components:NSWeekdayCalendarUnit|NSMonthCalendarUnit|NSYearCalendarUnit fromDate:date];

        if ([comps month] == 12){
            [comps setMonth:1];
            [comps setYear:[comps year]+1];
        }else{
            [comps setMonth:[comps month]+1];
        }

        date = [cal dateFromComponents:comps];
        NSLog(@"%@",date);
    }

}

return 0;
} 
```

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:48:55.433

创建并显示具有相同时区的日期。采用

```
NSLog(@"date: %@", [formatter stringFromDate:date]); 
```

打印日期。

```
NSLog(@"date: %@", date); 
```

使用您当地的时区，包括小时。NSDate 以相对于 GMT 的秒数存储日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:53:21.647

这是另一种方法：

```
int main(int argc, const char * argv[]) {
    @autoreleasepool {

        NSDateFormatter *formatter = [[NSDateFormatter alloc] init];
        [formatter setDateStyle: NSDateFormatterShortStyle];

        NSCalendar *cal = [NSCalendar currentCalendar];

        NSDateComponents *comps = [[NSDateComponents alloc] init];
        [comps setDay:1];

        for (int year = 1901; year <= 2000; year++) {
            [comps setYear:year];
            for (int month = 1; month <= 12; month++) {
                [comps setMonth:month];

                NSDate *date = [cal dateFromComponents:comps];
                NSLog(@"%@", [formatter stringFromDate:date]);
            }
        }
    }

    return 0;
} 
```

# php - 有没有办法用 MySQL 一次性验证不止一件事情？

> ID：14676671
> 
> 赞同：0
> 
> 时间：2013-02-03T20:01:09.037
> 
> 标签：php, mysql, activerecord, login

我正在构建一个登录函数来检查用户名和密码组合是否位于数据库中。

但是当我这样做时，我还想检查用户名和密码组合是否是一个活动帐户。因此，我可以告诉用户他们是否因为帐户未激活或密码不正确而无法登录。

我想知道是否有一种方法可以一次完成两项检查。目前我已经设置了一个顺序搜索，首先获取通行证/用户组合，然后检查他们的帐户是否处于活动状态。这样我一次登录的查询量增加了一倍，不好。

这是我到目前为止所拥有的。

```
$selectUser = "SELECT FirstName, LastName FROM User WHERE Username=? And Pass=?";
            $loginStmt = mysqli_prepare($link, $selectUser);
            mysqli_stmt_bind_param($loginStmt, 'ss', $u1, $p1);
            if (!mysqli_stmt_execute($loginStmt))
            {
                mysqli_close($link);
                die("The system is not available, try again later");
            }
            mysqli_stmt_store_result($loginStmt);
            $row_cnt = mysqli_stmt_num_rows($loginStmt);
            if ($row_cnt == 0)
            {
                $Error .= 'Invalid Username/Password. <br />';
            }
            else
            {
                $isActive = "SELECT isActivated FROM User WHERE Username=? And Pass=?";
                $isActiveStmt = mysqli_prepare($link, $isActive);
                mysqli_stmt_bind_param($isActiveStmt, 'ss', $u1, $p1);
                mysqli_stmt_bind_result($isActiveStmt,$active);
                mysqli_stmt_fetch($isActiveStmt);
                if($active != 1)
                {
                    $Error = 'Your account has not been activated yet, check email or contact admin'.
                }
                else
                {
                    mysqli_stmt_bind_result($loginStmt, $lname, $fname);
                    mysqli_stmt_fetch($loginStmt);
                    $_SESSION['Name'] = $lname." ".$fname; 
                    $_SESSION['Username'] = $txtUsername;
                    header("Location: Default.php");
                    //mysqli_close($link);
                    //$Error = "success";
                    exit();
                }
            } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:14:40.233

您只需要运行第二个 SQL SELECT isActivated FROM User WHERE Username=? 并且通过=？

如果用户名和密码不存在，$row_cnt 将为 0。如果不为 0，可以查看 isActivated 列。

# haskell - Numeric.Probability.Monad 未从概率包中导出，因此示例不起作用？

> ID：14676675
> 
> 赞同：1
> 
> 时间：2013-02-03T20:01:31.470
> 
> 标签：haskell, probability, cabal, ghci

我在玩[概率](http://hackage.haskell.org/packages/archive/probability/0.2.4/doc/html/Numeric-Probability-Distribution.html)包，试图理解各种例子是如何工作的。许多示例导入 Numeric.Probability.Monad 似乎是隐藏的，因此意味着我无法运行示例。

[蒙蒂霍尔示例](http://hackage.haskell.org/packages/archive/probability/0.2.4/doc/html/src/Numeric-Probability-Example-MontyHall.html#Door)：

```
module Numeric.Probability.Example.MontyHall where

import qualified Numeric.Probability.Distribution as Dist
import qualified Numeric.Probability.Transition as Trans
import Numeric.Probability.Simulation ((~.), )

import Numeric.Probability.Percentage
    (Dist, RDist, Trans, )

import qualified Numeric.Probability.Monad as MonadExt 
```

如果我尝试在 ghci 中运行它

```
:load "MontyHall.hs"

MontyHall.hs:10:18:
    Could not find module `Numeric.Probability.Monad'
    it is a hidden module in the package `probability-0.2.4'
    Use -v to see a list of the files searched for.
Failed, modules loaded: none. 
```

显然我做错了什么，因为无法运行的示例有什么意义。那么我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:54:44.277

`Numeric.Probability.Monad`文件中使用的唯一函数`MontyHall`是这个：

```
compose :: Monad m => [a -> m a] -> a -> m a
compose = foldl (flip (<=<)) return 
```

这是一个简单的辅助函数，您可以自己内联它。

# php - PHP创建具有不同排序字段的数组

> ID：14676679
> 
> 赞同：1
> 
> 时间：2013-02-03T20:01:57.713
> 
> 标签：php, sorting

首先感谢stackoverflow提供这个平台和你，给新手一个帮助;-)

现在..我有 2 个表：页面和部分每个都有自己的 id。一页有一个或多个部分。一个部分恰好属于 1 页。两个 id 的列表序列在不同的字段中处理。

我读取了两个表并创建了一个（未排序的）数组。我最终需要的是一个排序列表，如下所示，page_id 和 section_id 的顺序正确。

这是检索数据后我的 tarray 的示例：

```
myArr[] = array( page_id=>2,  section_id=>2,  parent_id=>0, level=>0, page_seq=>1, section_seq=>2, page_title=>p1 );
myArr[] = array( page_id=>2,  section_id=>9,  parent_id=>0, level=>0, page_seq=>1, section_seq=>1, page_title=>p1 );
myArr[] = array( page_id=>3,  section_id=>3,  parent_id=>0, level=>0, page_seq=>2, section_seq=>1, page_title=>p2 );
myArr[] = array( page_id=>4,  section_id=>4,  parent_id=>0, level=>0, page_seq=>3, section_seq=>1, page_title=>p3 );
myArr[] = array( page_id=>5,  section_id=>5,  parent_id=>3, level=>1, page_seq=>3, section_seq=>1, page_title=>p2-3 );
myArr[] = array( page_id=>6,  section_id=>6,  parent_id=>3, level=>1, page_seq=>2, section_seq=>1, page_title=>p2-2 );
myArr[] = array( page_id=>7,  section_id=>7,  parent_id=>4, level=>1, page_seq=>1, section_seq=>1, page_title=>p3-1 );
myArr[] = array( page_id=>8,  section_id=>8,  parent_id=>7, level=>2, page_seq=>1, section_seq=>1, page_title=>p3-1-1 );
myArr[] = array( page_id=>9,  section_id=>10, parent_id=>5, level=>2, page_seq=>1, section_seq=>1, page_title=>p2-1-1 );
myArr[] = array( page_id=>9,  section_id=>11, parent_id=>5, level=>2, page_seq=>1, section_seq=>2, page_title=>p2-1-1 );
myArr[] = array( page_id=>10, section_id=>12, parent_id=>3, level=>1, page_seq=>1, section_seq=>1, page_title=>p2-1 ); 
```

我的问题是排序。

*   section_seq 是页面内部分的序列。
*   page_seq 是同一父级的级别内的页面序列。

我已经在这里找到了一些递归循环示例，但是 - 老实说 - 我无法根据我的需要调整它们。而且，我需要一个递归循环吗？

我的数组的键应该是什么：section_id，因为它在所有页面中都是唯一的？如何进行正确的排序？

需要注意的是：页面标题很遗憾不能用于排序目的 - 如上例所示 - ）因为它是自由文本......

所以我需要的是：

*   读取级别为 0 且 page_seq = 1 的第一页 (1)
*   读取具有级别 1 的第一页 (2) - 如果存在 - 以页面 (1) 作为父页面且 page_seq = 1
*   读取具有级别 2 的第一页 (3) - 如果存在 - 以页面 (2) 作为父页面且 page_seq = 1
*   ...只要不存在更深层次就继续
*   读取具有级别 2 的第二页 (4) - 如果存在 - 以页面 (2) 作为父级且 page_seq = 1
*   ...只要不存在更深层次并且此级别上没有更多页面以页面 (2) 作为父级，就继续
*   读取具有级别 1 的第二页 (5) - 如果存在 - 页面 (1) 作为父级且 page_seq = 1
*   ...只要不存在更深层次并且此级别上没有更多页面以第 (5) 页为父级，则继续
*   读取级别为 0 且 page_seq = 2 的第二页 (6)
*   等等。

任何强大的帮助和想法？

在此先感谢沃尔夫冈

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T21:54:36.363

所以最后我找到了解决方案

1）创建要处理的所有页面的列表。$key 生成的第一层看起来像“1”，第二层像“1.1”，第三层像“1.1.1”等。

```
read all pages
while ( $fetch_obj_pages = $obj_pages->fetchRow() ):
    // do some validations and keep only those in mind which should be processed
    ....

    // get and save key for sorting
    if ( $isValid == TRUE ):
        $key = '';
        if ( array_key_exists ( $fetch_obj_pages[ 'parent_id' ],  $pageSortList ) == TRUE ):
            $key = $pageSortList[ $fetch_obj_pages[ 'parent_id' ]] . '.';
        endif;
        $key .= $fetch_obj_pages[ 'page_seq' ];
        $pageSortList[ $fetch_obj_pages[ 'page_id' ]] = $key;
     endif;
endwhile; 
```

2) 创建所有要处理的部分的列表。它取上面 pages 列表中生成的 key 并通过 section 排序顺序对其进行增强，然后将其保存为每个 section_id 作为 key。

```
read all sections
while ( $fetch_obj_sections = $obj_sections->fetchRow() ):
    // do some validations and keep only those in mind which should be processed
    ....

    // get and save key for sorting
    if ( $isValid == TRUE ):
        // get key from page and save key for section
        $key = '';
        if ( array_key_exists ( $fetch_obj_sections[ 'page_id' ],  $pageSortList ) == TRUE ):
            $key = $pageSortList[ $fetch_obj_sections[ 'page_id' ]] . '-';
        endif;
        $key .= $fetch_obj_sections[ section_seq ];
        $sectionSortList[ $fetch_obj_sections[ 'section_id' ]] = $key;
    endif;
endwhile; 
```

3) 对节列表 natsort ( $sectionSortList ) 进行排序；

4) 通过循环 $sectionSortList 并获取必要的数据来构建结果，因为 section_id 用作此列表中的键。

在有人问之前：当然，所有可能的过滤器都是在 SQL 中完成的。但有些是不可能的，因为需要循环完成——

最有可能的是，步骤 1) 和 2) 可以使用 JOIN 和适当的 ORDER BY 一步完成。

Last-Bit-Saving-Junkies 将找到很多代码优化和减少的地方。但是，我喜欢 : 和 endif; 的替代功能；;-)

如果有人看到让事情变得更快的可能性，欢迎提供您的想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T23:43:06.883

我的想法是使用数据库进行排序。使用 MySQL，您可以在两个表上使用左连接来获取一个结果表中的部分和页面数据。在查询中，您可以使用 ORDER BY 关键字来指定必须对结果进行排序的列。

# postgresql - 错误语法（从 shell 脚本执行 psql 查询）

> ID：14676683
> 
> 赞同：0
> 
> 时间：2013-02-03T20:02:16.650
> 
> 标签：postgresql, shell, psql

我得到这个查询想要在我的第二台服务器上远程执行并且

```
#!/bin/bash
QUERY=`psql -h my2ndserverip  -d testdb -U testuser  'select count(*) as result   
from testdb.user  where last_logged_date > (clock_timestamp()  -interval '90    minutes)
 echo "users = $QUERY" > tmp.txt 
```

修复语法的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:07:49.127

有不止一个问题

而不是 SQL 查询中的引号，您可以使用 $$

```
postgres=# select interval $$90 min$$;
 interval 
──────────
 01:30:00
(1 row) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:25:46.647

使用here文档（heredocuments保留引号并允许shell变量替换，如**单引号内**`90`使用的参数所示）：

 **```
#!/bin/bash

limit=${1:-90}

psql -h my2ndserverip  -d testdb -U testuser -t -A <<EOFEOF > tmp.txt
  SELECT count(*) AS result   
  FROM "user"  
  WHERE last_logged_date > clock_timestamp()-interval '${limit} minutes'
  ;
EOFEOF

exitcode=$?
result=`cat tmp.txt`

echo "Limit=${limit} Exitcode=${exitcode} Result=${result}"
#Eof 
```

我想您希望 psql 省略列标题等，所以我将`-t -A`标志添加到 psql 命令行。

顺便说一句，我将`from testdb.user`, 更改为`FROM user`，我认为您没有名为“testdb”的模式。**

# solr - Solr：按 id desc 排序 > 1000 个项目

> ID：14676684
> 
> 赞同：1
> 
> 时间：2013-02-03T20:02:20.033
> 
> 标签：solr, lucene

这感觉很奇怪，但我正在尝试使用 solr 对我的 id（主）字段进行搜索和排序。我有一个像这样的查询：

```
http://foo.com/solr/collection/select?q=*%3A*&sort=id+desc&fl=id+title&wt=json 
```

这将返回按降序排序的字段，但从 999 开始。我的索引中有大约 1200 个项目。

从我的 schema.xml：

```
<field name="id" type="string" indexed="true" stored="true" required="true" multiValued="false" /> 
```

我确实考虑过将我的 id 设置为 int，但我必须杀死所有东西并重新开始（这不是一个大问题）。

有小费吗？

干杯，

汤姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T02:20:48.520

如果您的 id 字段确实是一个数值并且您想按该值排序，我会推荐以下两个选项之一。

1.  将字段类型更改为 int 并重新索引。
2.  创建一个`id_sort`int 类型的新字段，并使用[copyField](http://wiki.apache.org/solr/SchemaXml#Copy_Fields)`id`指令在索引时使用该字段的值填充该字段。

# python - Pyinstaller 错误 - 至少需要一个 scriptname 文件

> ID：14676686
> 
> 赞同：2
> 
> 时间：2013-02-03T20:02:30.130
> 
> 标签：python, cmd, pyinstaller

在尝试通过输入构建独立后

> python pyinstaller.py -F myscript.py

在 pyinstaller 目录中我得到一个错误：

> 错误：需要至少一个 scriptname 文件或恰好一个 .specfile

我将脚本与 pyinstaller 放在同一目录中。什么可能导致错误？

编辑：回答评论：我从与 pyinstaller 相同的目录运行命令。我可以访问这两个文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2021-05-05T16:55:31.840

尝试`-m`在 python 之后添加。此外，从我所看到和尝试的情况来看，“pyinstaller.py”不起作用，但在删除“.py”后它可以工作

因此，也许您可​​以尝试以下方法：

`python -m PyInstaller -F myscript.py`

注意：在这种情况下，“PyInstaller”区分大小写，如果只使用“pyinstaller”则不起作用

但是，在以下情况下，“pyinstaller”确实有效：`pyinstaller -F myscript.py`

# visual-c++ - 用户输入在 OpenCV 中显示在错误的坐标处

> ID：14676687
> 
> 赞同：0
> 
> 时间：2013-02-03T20:02:31.293
> 
> 标签：visual-c++, opencv

我正在尝试使用 OpenCV 2.4.3（VS 2010）在用户接受的输入（通常是中心）处显示圆圈。在输出图像（使用“namedWindow”显示）上，圆圈似乎按列移动，因为一个标记点​​沿列。不知道我应该如何纠正这个。

**代码：**

```
struct OPTIONS{
        OPTIONS(): X(-1), Y(-1), drawing_dot(false){}
        int X;
        int Y;
        bool drawing_dot;
    };
    OPTIONS options;
    void my_mouse_callback( int event, int x, int y, int flags, void* param ){

        IplImage* image = (IplImage*) param;

        switch( event ){

        case CV_EVENT_LBUTTONDOWN:
            options.X = x;
            options.Y = y;
            options.drawing_dot = true;
            break;
        default:
            break;
        }
    }
    int main( void ){
        IplImage* image = cvLoadImage("Images/TestRealData/img1.bmp");
        Mat frame = imread("Images/TestRealData/img1.bmp");
        namedWindow("Test", CV_WINDOW_KEEPRATIO);
        cvSetMouseCallback("Test", my_mouse_callback, (void*) image);
        while( cvWaitKey(15) != 27 ){
            if( options.drawing_dot ){
                circle(frame, Point(options.X,options.Y), 3, CV_RGB(0,0,255), 2);
                options.drawing_dot = false;
            }
            imshow("Test", frame);
            waitKey(10);
        }
        cvReleaseImage(&image);
        return 0;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T04:50:39.773

我认为这个圈子不会改变。鼠标光标可能会欺骗我们的眼睛。您可以简单地通过增加半径并减少圆形轮廓的厚度来检查它，例如：

```
circle(frame, Point(options.X, options.Y/2), 15, CV_RGB(0, 0, 255), 1); 
```

顺便说一句，我想如果你想在你点击的点画圆，`options.Y`不应该除以2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-08T06:46:14.597

失去很多时间后找到答案 -

确保在“namedWindow”中指定标志。将标志更改为 CV_WINDOW_KEEPRATIO 对我有用。希望这可以帮助那里的人。

# ios - 在 iOS 上正确处理 JSON 中的 UTF-8

> ID：14676688
> 
> 赞同：5
> 
> 时间：2013-02-03T20:02:42.983
> 
> 标签：ios, objective-c, utf-8

我收到一些带有奇怪 UTF-8 字符串的 JSON。例如：

```
{
  "title": "It\U2019s The End";
} 
```

处理这些数据以便以可读方式呈现的最佳方式是什么？我想将该 \U2019 转换为它应该代表的引号。

编辑：假设我已将字符串解析为 NSString*`jsonResult`

编辑 2：我通过[AFNetworking](https://github.com/AFNetworking/AFNetworking)接收 JSON ：

```
AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {
    NSString* jsonResult = [JSON valueForKeyPath:@"title"];
} failure:nil]; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:49:11.587

**更新：**

Kurt 已经引起了人们对引擎盖下`AFJSONRequestOperation`使用的关注。`NSJSONSerialization`因此，您的 JSON 可能无效（如下所述，不应该有 a `;`，`U`应该是小写的`u`。这在下面的原始答案中有所提及。

* * *

这是 JSON 能够存储其数据的方式的一部分。您需要通过 JSON 解析器传递 JSON 字符串，然后才能正确提取字符串。

*注意：您上面发布的JSON是无效的，末尾不应该有分号，并且U应该是小写的u；下面的例子有一个修改过的 JSON 字符串*

```
NSString* str = @"{\"title\": \"It\\u2019s The End\"}";

NSError *error = nil;
NSData* data = [str dataUsingEncoding:NSUTF8StringEncoding];
NSDictionary *rootDictionary = [NSJSONSerialization JSONObjectWithData:data
                                                               options:0
                                                                 error:&error];
if (error) {
    // Handle an error in the parsing
}
else {
    NSString *title = [rootDictionary objectForKey:@"title"];
    NSLog(@"%@", title); //Prints "It’s The End"
} 
```

# c - C prog 读取两个模式之间的文件行并将它们打印出来

> ID：14676689
> 
> 赞同：0
> 
> 时间：2013-02-03T20:02:48.210
> 
> 标签：c

我正在寻找逻辑和代码来读取文件并打印两个匹配的模式之间的行。两种模式可以在一行中，也可以在下一个连续行中，或者第一个模式出现在行号“n”中，第二个模式出现在行号“m”中，或者第二个模式出现在行号“n”中，第一个模式出现在行中数字“米”。

实现的一种方法是读取文件并跟踪两个 int 变量，这将记录第一个模式匹配和其他模式匹配的行号。例如变量 x、y。x 将记录第一个模式的行号，y 将记录第二个模式的行号，关闭文件。然后检查 x=y 或 x> y 或 x < y 的条件，并基于该重读文件并打印 x 和 y 或 y 和 x 之间的行。不确定我是否可以在关闭文件之前重新读取文件？

另一种方法是用 (string compare(pattern1 with current line) || string compare(patter2 with current line) && (string compare(pattern1 with current line) || string compare(patter2 with current line) 编写 if 条件...不确定这是否可行，因此需要一些关于如何在 C 编程中实现它的反馈或指示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:38:36.460

您可以使用`fpos_t`变量的第一种方法来跟踪文件中每个模式匹配的位置，在找到匹配项时获取这些变量的值`fgetpos()`。然后，您可以使用`fsetpos()`将文件中的位置设置回您从第一个匹配项记录的点，以重新读取这些行并打印出您想要的行。无需关闭并重新打开文件。

[您可以在fgetpos/fsetpos 和 ftell/fseek](https://stackoverflow.com/questions/3348637/fgetpos-fsetpos-and-ftell-fseek)中找到有关这些函数的信息，以及使用`fgetpos()`和`fsetpos()` [此处](http://www.cplusplus.com/reference/cstdio/fsetpos/)的示例。

# php - 在 PHP 中使用 XML 中的特殊字符解析 XML

> ID：14676692
> 
> 赞同：1
> 
> 时间：2013-02-03T20:02:57.633
> 
> 标签：php, xml, parsing

我无法解析下面的 XML 以获得我想要的输出。我从 Commission Junction 获取下面的 XML，并且无法控制输出。

```
<cj-api>
   <advertisers total-matched="609" records-returned="10" page-number="1">
      <advertiser>
         <advertiser-id>2283</advertiser-id>
         <account-status>Active</account-status>
         <seven-day-epc>0.00</seven-day-epc>
         <three-month-epc>1.11</three-month-epc>
         <language>en</language>
         <advertiser-name>
            Name here
         </advertiser-name>
         <program-url>http://website.com/</program-url>
         <relationship-status>joined</relationship-status>
         <mobile-tracking-certified>false</mobile-tracking-certified>
         <network-rank>1</network-rank>
         <primary-category>
            <parent>Financial Services</parent>
            <child>Loans</child>
         </primary-category>
         <performance-incentives>false</performance-incentives>
         <actions>
            <action>
               <name>Sale</name>
               <type>sale</type>
               <id>120</id>
               <commission>
                  <default type="item-level">USD 15.00</default>
               </commission>
            </action>
         </actions>
         <link-types>
            <link-type>Text Link</link-type>
            <link-type>Banner</link-type>
            <link-type>Content Link</link-type>
         </link-types>
      </advertiser>
   </advertisers>
</cj-api> 
```

我正在使用 cURL 发送请求并接收响应。当我打印响应时，我得到了上面的 XML，一切看起来都很好，但是当我尝试解析下面的信息时，当我希望看到“2283”时得到“0”

```
$xml = simplexml_load_string($response);
print $xml->{"cj-api"}->advertisers->advertiser->advertiser-id; 
```

谁能帮我理解我做错了什么？

为了让我更加高兴，如果有人能告诉我如何将每个元素解析为它自己的变量，我会非常感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:41:54.783

这应该可以解决您的问题。

```
<?php

$xml_string = <<<XML
<cj-api>
   <advertisers total-matched="609" records-returned="10" page-number="1">
      <advertiser>
         <advertiser-id>2283</advertiser-id>
         <account-status>Active</account-status>
         <seven-day-epc>0.00</seven-day-epc>
         <three-month-epc>1.11</three-month-epc>
         <language>en</language>
         <advertiser-name>
            Name here
         </advertiser-name>
         <program-url>http://website.com/</program-url>
         <relationship-status>joined</relationship-status>
         <mobile-tracking-certified>false</mobile-tracking-certified>
         <network-rank>1</network-rank>
         <primary-category>
            <parent>Financial Services</parent>
            <child>Loans</child>
         </primary-category>
         <performance-incentives>false</performance-incentives>
         <actions>
            <action>
               <name>Sale</name>
               <type>sale</type>
               <id>120</id>
               <commission>
                  <default type="item-level">USD 15.00</default>
               </commission>
            </action>
         </actions>
         <link-types>
            <link-type>Text Link</link-type>
            <link-type>Banner</link-type>
            <link-type>Content Link</link-type>
         </link-types>
      </advertiser>
      <advertiser>
         <advertiser-id>2284</advertiser-id>
         <account-status>Not Active</account-status>
         <seven-day-epc>0.00</seven-day-epc>
         <three-month-epc>1.11</three-month-epc>
         <language>en</language>
         <advertiser-name>
            Name here
         </advertiser-name>
         <program-url>http://website.com/</program-url>
         <relationship-status>joined</relationship-status>
         <mobile-tracking-certified>false</mobile-tracking-certified>
         <network-rank>1</network-rank>
         <primary-category>
            <parent>Financial Services</parent>
            <child>Loans</child>
         </primary-category>
         <performance-incentives>false</performance-incentives>
         <actions>
            <action>
               <name>Sale</name>
               <type>sale</type>
               <id>120</id>
               <commission>
                  <default type="item-level">USD 15.00</default>
               </commission>
            </action>
         </actions>
         <link-types>
            <link-type>Text Link</link-type>
            <link-type>Banner</link-type>
            <link-type>Content Link</link-type>
         </link-types>
      </advertiser>
   </advertisers>
</cj-api>
XML;

$parse = simplexml_load_string($xml_string);
foreach($parse->advertisers->advertiser as $advertiser){
    $id = (string) $advertiser->{"advertiser-id"};
    var_dump($id);
}
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T21:57:49.117

```
printf("id is %s", $xml->{"advertisers"}->advertiser->{"advertiser-id"}); 
```

# macos - 使用终端将文件复制到动态创建的文件夹

> ID：14676693
> 
> 赞同：1
> 
> 时间：2013-02-03T20:03:01.030
> 
> 标签：macos, terminal

我正在尝试使用 mac 的终端将文件从一个目录复制到另一个目录，其中第二个目录基于日期：

```
cp -Rp /path/from/* /first part of path to/$(date '+%m')_$(date '+%d')_$(date '+%Y')/second part of path to/ 
```

日期片让我有些悲伤，我担心。有没有办法可以创建带有日期的动态路径？

谢谢...

# actionscript-3 - 从 Flash 播放器捕获正在播放的视频

> ID：14676694
> 
> 赞同：0
> 
> 时间：2013-02-03T20:03:07.803
> 
> 标签：actionscript-3, actionscript, flash

有没有办法只捕捉从 Flash 播放器播放的视频到另一个 Flash 播放器或 html5 视频播放器？（例如：将 youtube 播放器嵌入到具有不同控件和设计的自定义播放器中）

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T22:06:38.150

您可以使用[Youtube API](https://developers.google.com/youtube/getting_started)来做到这一点……具体来说，您在您的应用程序中嵌入了一个“无铬”的 youtube 播放器。然后，您可以添加自己的 Flash 或 HTML UI 来控制播放。

其他视频服务可能允许这样做。你只需要检查他们的 API 文档，看看是否可行。

# javascript - AngularJS 模板。内部 JS 不执行

> ID：14676695
> 
> 赞同：4
> 
> 时间：2013-02-03T20:03:10.057
> 
> 标签：javascript, angularjs, requirejs

我有很多模板 html 页面，其中包括 js 代码。当我的 RouteProvider 加载此模板之一时，JS 不会执行。我不想使用评估。我可以在外部 .js 文件中编写代码并使用 requireJS，但我不知道如何使用 requireJS 停用“未使用”的 js 文件。你能告诉我如何在我加载的模板页面上执行我的 JS 代码吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:15:06.677

在当前版本（1.0.4 和 1.1.2）中，AngularJS*不会*`templateUrl`执行通过（或`template`）指定的部分中包含的任何 JavaScript 代码。

目前，您最好的选择是预先加载大部分代码。人们正在试验 requireJS，在 SO 和邮件列表上有很多关于它的问题。但事实是——虽然可以为控制器和部分加载按需加载——但通常按需加载并没有得到很好的支持（有关更多信息，请参阅[如何在 AngularJS 中减轻模块化？](https://stackoverflow.com/q/12645720/1418796)）。实际上，这可能不是问题，因为使用 AngularJS 编写的代码往往非常非常简洁，因此预先加载内容不会对性能产生不利影响（相反，因为所有代码都在浏览器中没有与按需负载相关的延迟）。

按需加载是 AngularJS 2.0 的一个功能。

# xcode - Xcode 'autorelease 在 URL 请求中不可用

> ID：14676697
> 
> 赞同：0
> 
> 时间：2013-02-03T20:03:18.487
> 
> 标签：xcode, web-services, autorelease

我的 .m 文件中有以下代码：

```
- (IBAction)LoginButton:(id)sender {

// create string contains url address for php file, the file name is phpFile.php, it receives parameter :name
NSString *strURL = [NSString stringWithFormat:@"http://www.myURL.com/verify.php?Email=%@",Email.text];

// to execute php code
NSData *dataURL = [NSData dataWithContentsOfURL:[NSURL URLWithString:strURL]];

// to receive the returend value
NSString *strResult = [[[NSString alloc] initWithData:dataURL encoding:NSUTF8StringEncoding]autorelease];

NSLog(@"%@", strResult);

UIAlertView *alert = [[UIAlertView alloc]
                      initWithTitle:@"Result:"
                      message:strResult
                      delegate:nil
                      cancelButtonTitle:@"Okay"
                      otherButtonTitles:nil];    
                      [alert show]; 
} 
```

而且我知道自动释放在自动引用计数模式下不可用。

以下行似乎是一个问题：

```
NSString *strResult = [[[NSString alloc] initWithData:dataURL encoding:NSUTF8StringEncoding]autorelease]; 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:19:28.407

只需删除`autorelease`通话即可；如果您使用 ARC（自动引用计数），则无需担心内存管理。

# matlab - matlab 串行/fgets 不适用于非 ascii 字符

> ID：14676698
> 
> 赞同：1
> 
> 时间：2013-02-03T20:03:23.450
> 
> 标签：matlab, serial-port, data-import

执行脚本：

```
in = serial('/dev/ttyS0', 'BaudRate', 9600, 'DataBits', 8, ...
    'Parity', 'none', 'StopBits', 1, 'Terminator', 'LF');
fopen(in);
line = fgets(in); 
```

并输入数据'ñ\n'（hexa C3 B1 0A），`fgets`挂起和超时，即不识别LF。这仅在输入扩展的非 ascii 字符串时发生。我正在使用 Matlab 7.12 R2011a

# ios - 如何在相机视图上放置透明图像？

> ID：14676703
> 
> 赞同：-1
> 
> 时间：2013-02-03T20:03:54.277
> 
> 标签：ios, objective-c, uiviewcontroller, camera

我正在开发一个应用程序来捕获实时视频以对图像执行 OCR。

我想将半透明图像放在相机视图的前面，以指导用户如何放置图像。像其他扫描应用程序一样...

任何想法？？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:19:17.987

只需添加另一个视图

```
+ view
   + videoPreview + preview Layer
   + overlay view 
```

代码可能如下所示：

```
videoPreviewLayer = [[AVCaptureVideoPreviewLayer alloc] initWithSession:captureSession];
[self.videoPreview.layer addSublayer:videoPreviewLayer];
[self.view addSubview:videoPreview];
[self.view addSubview:overlayView]; 
```

编辑：清理了一点格式。

# ios - sizeWithFont:constrainedToSize:lineBreakMode 中的内存泄漏：

> ID：14676705
> 
> 赞同：0
> 
> 时间：2013-02-03T20:04:02.777
> 
> 标签：ios, objective-c, memory-leaks, instruments

尝试创建 CGSize 以设置 UILabel 的正确高度时出现泄漏。在 heightForRowAtIndexPath 中设置高度时，我也收到了同样的泄漏。

这是泄漏的代码片段：

```
CGSize size = [news.news sizeWithFont:[UIFont fontWithName:@"HelveticaNeue" size:12] constrainedToSize:CGSizeMake(230.0f, CGFLOAT_MAX) lineBreakMode:NSLineBreakByWordWrapping];

                UILabel *newsLabel = [[UILabel alloc] initWithFrame:CGRectMake(65, 50, 230, size.height)];
                newsLabel.font = [UIFont fontWithName:@"HelveticaNeue" size:12];
                newsLabel.textAlignment = NSTextAlignmentLeft;
                newsLabel.text = news.news;
                newsLabel.numberOfLines = 0;
                newsLabel.lineBreakMode = NSLineBreakByWordWrapping;
                newsLabel.textColor = COLOR_DARK_GRAY;
                newsLabel.highlightedTextColor = COLOR_WHITE;
                newsLabel.backgroundColor = COLOR_CLEAR;
                [cell.contentView addSubview:newsLabel];
                [newsLabel release]; 
```

这是泄漏仪器中列出的泄漏：

泄漏对象：icu::UCharCharacterIterator 负责库：WebCore 负责框架：WebCore::LineBreakIteratorPool::take(WTF::AtomicString const&)

还有一个指向同一行的不同泄漏：

泄漏对象：icu::UCharCharacterIterator 负责库：WebCore 负责框架：WebCore::acquireLineBreakIterator(unsigned short const*, int, WTF::AtomicString const&)

如果还有什么我可以提供的，我很乐意这样做。我已经通过注释掉上面的单行（创建 CGSize 大小）来确认它是泄漏的行。发生在模拟器和设备上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:15:19.657

在您的声明中`newsLabel.font = [UIFont fontWithName:@"HelveticaNeue" size:12];`，您创建了一个`UIFont`要自动释放的对象。但是，如果您的代码在没有使用 明确设置自动释放池的线程中运行`@autoreleasepool {}`，则该对象将永远不会被释放（因为不存在自动释放池），并且会泄漏。
因此，如果您的代码确实在单独的线程中运行，请检查您是否设置了自动释放池。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:13:09.050

除非您有权访问`WebCore`代码，否则无需执行任何操作。你的代码对我来说看起来不错。Apple 的库中有许多小漏洞，您有时只需要接受这些漏洞并不会消失。

# c# - LastCall 和 Expect.Call 有什么区别？

> ID：14676708
> 
> 赞同：2
> 
> 时间：2013-02-03T20:04:16.990
> 
> 标签：c#, unit-testing, tdd, rhino-mocks

有人可以解释什么时候应该使用 Rhino Mocks LastCall 以及什么时候应该使用 Expect.Call。我收集到 Expect.Call 只是包装器中的 LastCall。我还假设在 Rhino Mocks 中处理返回值时应该使用 Expect.Call。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:12:52.823

```
using (mocks.Record())
{
    myMock.AVeryMeaningFullMethodThatDoesNotReturnAValue("a to be ignored parameter");
    LastCall.IgnoreArguments();

    Expect.Call(myMock.AnotherMethodThatDoesReturnAValue()).IgnoreArguments().Returns("barney");
} 
```

先做一点介绍。在`Record`模式下，您可以指定“模拟”环境的行为。您可以这样做，但只需指定您期望的方法：

```
myMock.AVeryMeaningFullMethodThatDoesNotReturnAValue("a to be ignored parameter"); 
```

或者，您可以通过 Mocking 框架执行此操作：

```
Expect.Call(myMock.Do("stuff")).Return("something"); 
```

第一种情况，不能调用Rhino mocking 框架的方法，因为mocked 方法没有返回值。`Expect.Call()`要求返回类型。为了让您作为程序员指定 Rhino 模拟行为（例如`IgnoreArguments()`），他们提供了一个静态类`LastCall`。

这样你仍然可以`IgnoreArguments`使用 void 方法。或指定您希望它重复多次 ( `LastCall.Repeat.Any()`)。

# c++ - 状态机的 C++ 代码

> ID：14676709
> 
> 赞同：47
> 
> 时间：2013-02-03T20:04:18.103
> 
> 标签：c++, design-patterns, switch-statement, state-machine, idioms

这是一个用 C++ 编写的面试问题：

> 为自动售货机编写代码：从一个仅售卖一种商品的简单机器开始。所以两个状态变量：金钱和库存，就可以了。

我的答案：

我会使用具有大约 3-4 个状态的状态机。使用枚举变量来指示状态并使用 switch case 语句，其中每个 case 都有对应于每个状态的操作，并停留在循环中以从一个状态移动到另一个状态。

下一个问题：

> 但是对于添加更多状态和修改状态中的现有操作，使用 switch case 语句并不能“很好地扩展”。你将如何处理这个问题？

我当时无法回答这个问题。但后来想，我大概可以：

*   对不同的状态有不同的功能（每个功能对应一个状态）
*   有一个`std::map`from (string, function) 其中 string 表示状态以调用相应的状态函数。
*   主函数有一个字符串变量（从初始状态开始），并在循环中调用与该变量对应的函数。每个函数执行所需的操作并将新状态返回给主函数。

我的问题是：

*   在大规模软件系统的上下文中，关于可伸缩性的 switch-case 语句有什么问题？
*   如果是这样，我的解决方案（目前我觉得它比长线性代码更模块化）会解决问题吗？

面试问题是期待来自大型软件系统的 C++ 习语和设计模式的答案。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-11-11T00:13:55.923

我正在考虑一种更面向对象的方法，使用[`State Pattern`](http://en.wikipedia.org/wiki/State_pattern)：

## 机器：

```
// machine.h
#pragma once

#include "MachineStates.h"

class AbstractState;

class Machine {
  friend class AbstractState;

public:
  Machine(unsigned int _stock);
  void sell(unsigned int quantity);
  void refill(unsigned int quantity);
  unsigned int getStock();
  ~Machine();

private:
  unsigned int stock;
  AbstractState *state;
};

// --------

// machine.cpp
#include "Machine.h"
#include "MachineStates.h"

Machine::Machine(unsigned int _stock) {
  stock = _stock;
  state = _stock > 0 ? static_cast<AbstractState *>(new Normal())
                    : static_cast<AbstractState *>(new SoldOut());
}

Machine::~Machine() { delete state; }

void Machine::sell(unsigned int quantity) { state->sell(*this, quantity); }

void Machine::refill(unsigned int quantity) { state->refill(*this, quantity); }

unsigned int Machine::getStock() { return stock; } 
```

## 美国：

```
// MachineStates.h
#pragma once

#include "Machine.h"
#include <exception>
#include <stdexcept>

class Machine;

class AbstractState {
public:
  virtual void sell(Machine &machine, unsigned int quantity) = 0;
  virtual void refill(Machine &machine, unsigned int quantity) = 0;
  virtual ~AbstractState();

protected:
  void setState(Machine &machine, AbstractState *st);
  void updateStock(Machine &machine, unsigned int quantity);
};

class Normal : public AbstractState {
public:
  virtual void sell(Machine &machine, unsigned int quantity);
  virtual void refill(Machine &machine, unsigned int quantity);
  virtual ~Normal();
};

class SoldOut : public AbstractState {
public:
  virtual void sell(Machine &machine, unsigned int quantity);
  virtual void refill(Machine &machine, unsigned int quantity);
  virtual ~SoldOut();
};

// --------

// MachineStates.cpp
#include "MachineStates.h"

AbstractState::~AbstractState() {}

void AbstractState::setState(Machine &machine, AbstractState *state) {
  AbstractState *aux = machine.state;
  machine.state = state;
  delete aux;
}

void AbstractState::updateStock(Machine &machine, unsigned int quantity) {
  machine.stock = quantity;
}

Normal::~Normal() {}

void Normal::sell(Machine &machine, unsigned int quantity) {
  unsigned int currStock = machine.getStock();
  if (currStock < quantity) {
    throw std::runtime_error("Not enough stock");
  }

  updateStock(machine, currStock - quantity);

  if (machine.getStock() == 0) {
    setState(machine, new SoldOut());
  }
}

void Normal::refill(Machine &machine, unsigned int quantity) {
  int currStock = machine.getStock();
  updateStock(machine, currStock + quantity);
}

SoldOut::~SoldOut() {}

void SoldOut::sell(Machine &machine, unsigned int quantity) {
  throw std::runtime_error("Sold out!");
}

void SoldOut::refill(Machine &machine, unsigned int quantity) {
  updateStock(machine, quantity);
  setState(machine, new Normal());
} 
```

我不习惯用 C++ 编程，但这段代码显然是针对~~GCC 4.8.2~~ `clang` @编译的，`11.0.0`而且 Valgrind 没有显示任何泄漏，所以我想这很好。我不是在计算金钱，但我不需要这个来向你展示这个想法。

要测试它：

```
// main.cpp
#include "Machine.h"
#include "MachineStates.h"
#include <iostream>
#include <stdexcept>

int main() {
  Machine m(10), m2(0);

  m.sell(10);
  std::cout << "m: "
            << "Sold 10 items" << std::endl;

  try {
    m.sell(1);
  } catch (std::exception &e) {
    std::cerr << "m: " << e.what() << std::endl;
  }

  m.refill(20);
  std::cout << "m: "
            << "Refilled 20 items" << std::endl;

  m.sell(10);
  std::cout << "m: "
            << "Sold 10 items" << std::endl;
  std::cout << "m: "
            << "Remaining " << m.getStock() << " items" << std::endl;

  m.sell(5);
  std::cout << "m: "
            << "Sold 5 items" << std::endl;
  std::cout << "m: "
            << "Remaining " << m.getStock() << " items" << std::endl;

  try {
    m.sell(10);
  } catch (std::exception &e) {
    std::cerr << "m: " << e.what() << std::endl;
  }

  try {
    m2.sell(1);
  } catch (std::exception &e) {
    std::cerr << "m2: " << e.what() << std::endl;
  }

  return 0;
} 
```

一点点`Makefile`：

```
CC = clang++
CFLAGS = -g -Wall -std=c++17

main: main.o Machine.o MachineStates.o
    $(CC) $(CFLAGS) -o main main.o Machine.o MachineStates.o

main.o: main.cpp Machine.h MachineStates.h
    $(CC) $(CFLAGS) -c main.cpp

Machine.o: Machine.h MachineStates.h

MachineStates.o: Machine.h MachineStates.h

clean:
    $(RM) main 
```

然后运行：

```
make main
./main 
```

输出是：

> ```
> m: Sold 10 items
> m: Sold out!
> m: Refilled 20 items
> m: Sold 10 items
> m: Remaining 10 items
> m: Sold 5 items
> m: Remaining 5 items
> m: Not enough stock
> m2: Not enough stock 
> ```

现在，如果你想添加一个`Broken`状态，你只需要另一个`AbstractState`孩子：

```
diff --git a/Machine.cpp b/Machine.cpp
index 935d654..6c1f421 100644
--- a/Machine.cpp
+++ b/Machine.cpp
@@ -13,4 +13,8 @@ void Machine::sell(unsigned int quantity) { state->sell(*this, quantity); }

 void Machine::refill(unsigned int quantity) { state->refill(*this, quantity); }

+void Machine::damage() { state->damage(*this); }
+
+void Machine::fix() { state->fix(*this); }
+
 unsigned int Machine::getStock() { return stock; }
diff --git a/Machine.h b/Machine.h
index aa983d0..706dde2 100644
--- a/Machine.h
+++ b/Machine.h
@@ -12,6 +12,8 @@ public:
   Machine(unsigned int _stock);
   void sell(unsigned int quantity);
   void refill(unsigned int quantity);
+  void damage();
+  void fix();
   unsigned int getStock();
   ~Machine();

diff --git a/MachineStates.cpp b/MachineStates.cpp
index 9656783..d35a53d 100644
--- a/MachineStates.cpp
+++ b/MachineStates.cpp
@@ -13,6 +13,16 @@ void AbstractState::updateStock(Machine &machine, unsigned int quantity) {
   machine.stock = quantity;
 }

+void AbstractState::damage(Machine &machine) {
+  setState(machine, new Broken());
+};
+
+void AbstractState::fix(Machine &machine) {
+  setState(machine, machine.stock > 0
+                        ? static_cast<AbstractState *>(new Normal())
+                        : static_cast<AbstractState *>(new SoldOut()));
+};
+
 Normal::~Normal() {}

 void Normal::sell(Machine &machine, unsigned int quantity) {
@@ -33,6 +43,10 @@ void Normal::refill(Machine &machine, unsigned int quantity) {
   updateStock(machine, currStock + quantity);
 }

+void Normal::fix(Machine &machine) {
+  throw std::runtime_error("If it ain't broke, don't fix it!");
+};
+
 SoldOut::~SoldOut() {}

 void SoldOut::sell(Machine &machine, unsigned int quantity) {
@@ -43,3 +57,17 @@ void SoldOut::refill(Machine &machine, unsigned int quantity) {
   updateStock(machine, quantity);
   setState(machine, new Normal());
 }
+
+void SoldOut::fix(Machine &machine) {
+  throw std::runtime_error("If it ain't broke, don't fix it!");
+};
+
+Broken::~Broken() {}
+
+void Broken::sell(Machine &machine, unsigned int quantity) {
+  throw std::runtime_error("Machine is broken! Fix it before sell");
+}
+
+void Broken::refill(Machine &machine, unsigned int quantity) {
+  throw std::runtime_error("Machine is broken! Fix it before refill");
+}
diff --git a/MachineStates.h b/MachineStates.h
index b117d3c..3921d35 100644
--- a/MachineStates.h
+++ b/MachineStates.h
@@ -11,6 +11,8 @@ class AbstractState {
 public:
   virtual void sell(Machine &machine, unsigned int quantity) = 0;
   virtual void refill(Machine &machine, unsigned int quantity) = 0;
+  virtual void damage(Machine &machine);
+  virtual void fix(Machine &machine);
   virtual ~AbstractState();

 protected:
@@ -22,6 +24,7 @@ class Normal : public AbstractState {
 public:
   virtual void sell(Machine &machine, unsigned int quantity);
   virtual void refill(Machine &machine, unsigned int quantity);
+  virtual void fix(Machine &machine);
   virtual ~Normal();
 };

@@ -29,5 +32,13 @@ class SoldOut : public AbstractState {
 public:
   virtual void sell(Machine &machine, unsigned int quantity);
   virtual void refill(Machine &machine, unsigned int quantity);
+  virtual void fix(Machine &machine);
   virtual ~SoldOut();
 };
+
+class Broken : public AbstractState {
+public:
+  virtual void sell(Machine &machine, unsigned int quantity);
+  virtual void refill(Machine &machine, unsigned int quantity);
+  virtual ~Broken();
+};
diff --git a/main b/main
index 26915c2..de2c3e5 100755
Binary files a/main and b/main differ
diff --git a/main.cpp b/main.cpp
index 8c57fed..82ea0bf 100644
--- a/main.cpp
+++ b/main.cpp
@@ -39,11 +39,34 @@ int main() {
     std::cerr << "m: " << e.what() << std::endl;
   }

+  m.damage();
+  std::cout << "m: "
+            << "Machine is broken" << std::endl;
+  m.fix();
+  std::cout << "m: "
+            << "Fixed! In stock: " << m.getStock() << " items" << std::endl;
+
   try {
     m2.sell(1);
   } catch (std::exception &e) {
     std::cerr << "m2: " << e.what() << std::endl;
   }

+  try {
+    m2.fix();
+  } catch (std::exception &e) {
+    std::cerr << "m2: " << e.what() << std::endl;
+  }
+
+  m2.damage();
+  std::cout << "m2: "
+            << "Machine is broken" << std::endl;
+
+  try {
+    m2.refill(10);
+  } catch (std::exception &e) {
+    std::cerr << "m2: " << e.what() << std::endl;
+  }
+
   return 0;
 } 
```

要添加更多产品，您必须拥有产品地图及其各自的库存数量等等......

最终代码可以在[这个 repo](https://github.com/hbarcelos/cpp-state-machine)中找到。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2013-02-03T20:08:17.397

考虑使用表而不是`switch`语句。一列可以是转换标准，另一列是目标状态。

这可以很好地扩展，因为您不必更改表处理功能；只需在表格中添加另一行。

```
+------------------+---------------------+---------------+
| Current state ID | transition criteria | Next state ID |
+------------------+---------------------+---------------+
|                  |                     |               |
+------------------+---------------------+---------------+ 
```

在我的工作代码中，我们使用一列函数指针而不是“下一个状态 ID”。该表是一个单独的文件，其中定义了访问器函数。有一个或多个包含语句来解析每个函数指针。

## 编辑 1：单独表格文件的示例。

**表.h**

```
#ifndef TABLE_H
#define TABLE_H

struct Table_Entry
{
    unsigned int  current_state_id;
    unsigned char transition_letter;
    unsigned int  next_state_id;
};

Table_Entry const *    table_begin(void);
Table_Entry const *    table_end(void);

#endif // TABLE_H 
```

**表.cpp：**

```
#include "table.h"

static const Table_Entry    my_table[] =
{
    //  Current   Transition     Next
    //  State ID    Letter     State ID
    {    0,          'A',        1}, // From 0 goto 1 if letter is 'A'.
    {    0,          'B',        2}, // From 0 goto 2 if letter is 'B'.
    {    0,          'C',        3}, // From 0 goto 3 if letter is 'C'.
    {    1,          'A',        1}, // From 1 goto 1 if letter is 'A'.
    {    1,          'B',        3}, // From 1 goto 3 if letter is 'B'.
    {    1,          'C',        0}, // From 1 goto 0 if letter is 'C'.
};

static const unsigned int  TABLE_SIZE =  
    sizeof(my_table) / sizeof(my_table[0]);

Table_Entry const *
table_begin(void)
{
    return &my_table[0];
}

Table_Entry const *
table_end(void)
{
    return &my_table[TABLE_SIZE];
} 
```

**state_machine.cpp**

```
#include "table.h"
#include <iostream>

using namespace std;  // Because I'm lazy.

void
Execute_State_Machine(void)
{
    unsigned int current_state = 0;
    while (1)
    {
        char transition_letter;
        cout << "Current state: " << current_state << "\n";
        cout << "Enter transition letter: ";
        cin >> transition_letter;
        cin.ignore(1000, '\n'); /* Eat up the '\n' still in the input stream */
        Table_Entry const *  p_entry = table_begin();
        Table_Entry const * const  p_table_end =  table_end();
        bool state_found = false;
        while ((!state_found) && (p_entry != p_table_end))
        {
            if (p_entry->current_state_id == current_state)
            {
                if (p_entry->transition_letter == transition_letter)
                {
                    cout << "State found, transitioning"
                         << " from state " << current_state
                         << ", to state " << p_entry->next_state_id
                         << "\n";
                    current_state = p_entry->next_state_id;
                    state_found = true;
                    break;
                }
             }
             ++p_entry;
         }
         if (!state_found)
         {
             cerr << "Transition letter not found, current state not changed.\n";
         }
    }
} 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-02-03T20:22:28.687

我曾经用 C++ 编写过一个状态机，我需要对很多状态对（源→目标对）进行相同的转换。我想举例说明：

```
4 -> 8   \
5 -> 9    \_ action1()
6 -> 10   /
7 -> 11  /

8 -> 4   \
9 -> 5    \_ action2()
10 -> 6   /
11 -> 7  / 
```

我想出的是一组（转换标准+下一个状态+要调用的“动作”函数）。为了保持一般性，转换标准和下一个状态都写成函子（lambda 函数）：

```
typedef std::function<bool(int)> TransitionCriteria;
typedef std::function<int(int)>  TransitionNewState;
typedef std::function<void(int)> TransitionAction;   // gets passed the old state 
```

如果您有很多适用于许多不同状态的转换，如上例所示，则此解决方案很好。但是，对于每个“步骤”，此方法需要线性扫描所有不同转换的列表。

对于上面的示例，将有两个这样的转换：

```
struct Transition {
    TransitionCriteria criteria;
    TransitionNewState newState;
    TransitionAction action;

    Transition(TransitionCriteria c, TransitionNewState n, TransitionAction a)
        : criteria(c), newState(n), action(a) {}
};
std::vector<Transition> transitions;

transitions.push_back(Transition(
    [](int oldState){ return oldState >= 4 && oldState < 8; },
    [](int oldState){ return oldState + 4; },
    [](int oldState){ std::cout << "action1" << std::endl; }
));
transitions.push_back(Transition(
    [](int oldState){ return oldState >= 8 && oldState < 12; },
    [](int oldState){ return oldState - 4; },
    [](int oldState){ std::cout << "action2" << std::endl; }
)); 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-02-03T20:20:48.253

我不知道这是否能让你通过面试，但我个人会避免手动编写任何状态机，尤其是在专业环境中。状态机是一个经过充分研究的问题，并且存在经过良好测试的开源工具，这些工具通常可以生成比您自己手动生成的代码更好的代码，它们还可以帮助您诊断状态机的问题，例如。能够自动生成状态图。

我针对此类问题的 goto 工具是：

*   [拉格尔](http://www.complang.org/ragel/)
*   [SMC](http://smc.sourceforge.net/)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-05-28T09:31:43.657

```
#include <stdio.h>
#include <iostream>

using namespace std;
class State;

enum state{ON=0,OFF};
class Switch {
    private:
        State* offState;
        State* onState;
        State* currState;
    public:
        ~Switch();
        Switch();
        void SetState(int st);
        void on();
        void off();
};
class State{
    public:
        State(){}
        virtual void on(Switch* op){}
        virtual void off(Switch* op){} 
};
class OnState : public State{
    public:
    OnState(){
        cout << "OnState State Initialized" << endl;
    }
    void on(Switch* op);
    void off(Switch* op);
};
class OffState : public State{
    public:
    OffState(){
        cout << "OffState State Initialized" << endl;
    }
    void on(Switch* op);
    void off(Switch* op);
};
Switch::Switch(){
    offState = new OffState();
    onState = new OnState();
    currState=offState;
}
Switch::~Switch(){
    if(offState != NULL)
        delete offState;
    if(onState != NULL)
        delete onState;
}
void Switch::SetState(int newState){
    if(newState == ON)
    {
        currState = onState;
    }
    else if(newState == OFF)
    {
        currState = offState;
    }
}
void Switch::on(){
    currState->on(this);
}
void Switch::off(){
    currState->off(this);
}
void OffState::on(Switch* op){
    cout << "State transition from OFF to ON" << endl;
    op->SetState(ON);
}
void OffState::off(Switch* op){
    cout << "Already in OFF state" << endl;
}
void OnState::on(Switch* op){
    cout << "Already in ON state" << endl;
}
void OnState::off(Switch* op){
    cout << "State transition from ON to OFF" << endl;
    op->SetState(OFF);
}
int main(){
    Switch* swObj = new Switch();
    int ch;
    do{
        switch(ch){
            case 1:     swObj->on();
                    break;
            case 0:     swObj->off();
                    break;
            default :   cout << "Invalid choice"<<endl;
                    break;
        }
        cout << "Enter 0/1: ";
        cin >> ch;  
    }while(true);`enter code here`
    delete swObj;
    return 0;
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2017-08-30T23:03:26.243

我已经使用这些方法编写了很多状态机。但是当我为 Nexus 7000（价值 117,000 美元的交换机）编写 Cisco 的收发器库时，我使用了我在 80 年代发明的方法。那是使用一个使状态机看起来更像多任务阻塞代码的宏。这些宏是为 C 编写的，但当我为 DELL 工作时，我对 C++ 做了一些小的修改。您可以在此处阅读更多相关信息：[https ://www.codeproject.com/Articles/37037/Macros-to-simulate-multi-tasking-blocking-code-at](https://www.codeproject.com/Articles/37037/Macros-to-simulate-multi-tasking-blocking-code-at)

# ruby - 了解 ruby 中的 Tk 列表框

> ID：14676711
> 
> 赞同：2
> 
> 时间：2013-02-03T20:04:19.937
> 
> 标签：ruby, tk

我正在尝试制作一个小程序来将一些数据转换为可用的形式。我想做的一件事是能够选择一些文件并对它们执行操作，所以我想我会使用 Tk 中的列表框对象来做到这一点。我希望能够打开一个文件并看到它的文件名显示在列表框中。据我所知，这正是在列表框中使用 listvariable 的目的。然而，当我运行我的代码时，列表框永远不会更新（尽管 listvariable 变量中已经显示的项目很好）。

所以这是一个接近 MWE 的地方。我做错了什么，我误解了什么基本思想？

```
require 'tk'
require 'tkextlib/tile'

$path_list = []
$populate_list = TkVariable.new( $path_list )

def get_file
  file = Tk.getOpenFile
  file = open(file) unless file.empty?
  path = File.basename(file, ".out")
  if $path_list.include?(path)
    Tk.messageBox(
        'type'    => "ok",
        'icon'    => "warning",
        'title'   => " - Minimum Working Example - ",
        'message' => "This file has already been added! Nothing was added to the list"
    )
  else
    $path_list.push(path)
  end
end

root = TkRoot.new {title "- Minimum Working Example -"}
frame = Tk::Tile::Frame.new(root) {padding "3 3 12 12"}.grid( :sticky => 'nsew') # 'north south east west'
TkGrid.columnconfigure root, 0, :weight => 1; TkGrid.rowconfigure root, 0, :weight => 1

$file_listbox = Tk::Listbox.new(frame) {
  listvariable $populate_list}.grid( :column => 1, :row => 0, :rowspan => 6)

Tk::Tile::Button.new(frame) {
  width 15; text 'Open file...'; command {get_file}}.grid( :column => 0, :row => 1)

Tk.mainloop 
```

我是否可能必须以其他顺序编写它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T06:27:56.920

只需添加一行代码：

```
$populate_list.value = $path_list 
```

在这个下：

```
$path_list.push(path) 
```

它对我有用，虽然看起来很奇怪。

`TkVariable`为您的 ruby​​ 变量创建一个代理，从而将您的 ruby​​ var 引用与 Tk 小部件连接起来。但我不知道为什么代理 var 的更改不会影响它指向的 var。我不确定它是否应该自动执行此操作。

# wordpress - 用户组显示差异的最佳实现

> ID：14676713
> 
> 赞同：0
> 
> 时间：2013-02-03T20:04:35.197
> 
> 标签：wordpress, content-management-system

我正在用 Wordpress 开发一个为公司提供功能和内容的网站。每家公司将有数百名用户。所有公司的所有用户都获得相同的内容。但是，主要标题发生了变化（它需要包含公司自己的徽标）。他们还将有自己的子域，至少在登录页面，最好是所有页面。内容会定期更改，所以我希望只有一份。

所以要求是：

*   相同相对 url 的所有用户的相同内容
*   基于当前用户组的不同标题
*   每组不同的基本网址
*   如果用户登录错误，则将用户转发到正确的基本 url

实现这一点的最佳方法是什么？

*   带有处理标题的子主题的直接 WP。Mod-rewrite 处理 url
*   WP-MultiSite（不同基本网址下的相同内容如何在这里工作？）
*   网站的多个副本并以某种方式同步内容（我将如何进行同步？）
*   使用不同的 CMS

假设我可能不得不与成千上万家拥有成百上千用户的公司打交道，那么其中哪一个是最适合未来的方法。

另外，如果有一种更简单的方法，因为我在研究中遗漏了一些东西，比如现有的插件，那也很棒。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T17:13:34.743

我会说这样的事情不仅仅取决于这些要求。例如，您希望用户管理的粒度如何？允许用户在不同的组上做多少？不同域是否允许唯一信息，或者所有信息是否共享？

根据您提供的信息，我认为您最好使用 wordpress 的多站点版本。然后，您可以使用广播插件在所有站点上共享信息，并创建一个模板站点，从中创建新站点（例如使用 NS 克隆插件）。

这种方法当然存在一些问题，例如搜索引擎优化。你会得到很多重复的内容，这会损害各个网站的谷歌排名。

也可以使用单个站点安装来执行此操作，但是您会遇到多域结构的问题。可以做到，但是可用的缓存插件不支持它（至少我不知道），而开箱即用支持多站点环境。阻止用户在不同的域上发帖也更加困难，因为他们使用的是单一安装。多站点环境也具有共享用户群，但可以随意从不同站点添加或删除它们。

使用多站点环境还可以让您在模板方面获得更大的灵活性。

# regex - grep：匹配直到（不包括）第一个空格的所有字符

> ID：14676714
> 
> 赞同：29
> 
> 时间：2013-02-03T20:04:41.357
> 
> 标签：regex, grep, whitespace

我有一个具有以下格式的文本文件：

```
characters(that I want to keep) (space) characters(that I want to remove) 
```

例如：

```
foo garbagetext
hello moregarbage
keepthis removethis
(etc.) 
```

所以我试图在 Linux 中使用 grep 命令来只保留每行中的字符，不包括第一个空格。我尝试了很多尝试，例如：

```
grep '*[[:space:]]' text1.txt > text2.txt
grep '*[^\s]' text1.txt > text2.txt
grep '/^[^[[:space:]]]+/' text1.txt > text2.txt 
```

试图从不同的例子中拼凑起来，但我没有运气。他们都产生一个空白`text2.txt`文件。我是新来的。我究竟做错了什么？

*编辑：

我要保留的部分包括大写字母。所以我想在每一行中保留任何/所有字符，但不包括空格（从空格开始删除所有内容）。

**编辑：

垃圾文本（我想删除）可以包含任何内容，包括空格、特殊字符等。例如：

```
AA rough, cindery lava [n -S] 
```

运行后`grep -o '[^ ]*' text1.txt > text2.txt`，上面的行变为：

```
AA
rough,
cindery
lava
[n
-S] 
```

在 text2.txt 中。（我只想保留`AA`）

* * *

解决方案（由 Rohit Jain 提供，由 beny23 提供进一步输入）：

```
 grep -o '^[^ ]*' text1.txt > text2.txt 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-03T20:06:24.267

您将量词`*`放在错误的位置。

试试这个： -

```
grep '^[^\s]*' text1.txt > text2.txt 
```

或者，甚至更好：-

```
grep '^\S*' text1.txt > text2.txt 
```

`\S`表示匹配*非空白*字符。并且锚点`^`用于匹配行首。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-08-13T18:32:41.307

我意识到这个问题早已用 grep 解决方案得到了解答，但对于后代，我想指出，对于这种特殊情况，至少还有两个其他解决方案，这两个解决方案都比 grep 更有效。

由于您没有进行任何复杂的文本模式匹配，只取用空格分隔的第一列，您可以使用一些基于列的实用程序，例如 awk 或 cut。

**使用 awk**

```
$ awk '{print $1}' text1.txt > text2.txt 
```

**使用剪切**

```
$ cut -f1 -d' ' text1.txt > text2.txt 
```

**~1.1MB 文件的基准测试**

```
$ time grep -o '^[^ ]*' text1.txt > text2.txt

real    0m0.064s
user    0m0.062s
sys     0m0.001s
$ time awk '{print $1}' text1.txt > text2.txt

real    0m0.021s
user    0m0.017s
sys     0m0.004s
$ time cut -f1 -d' ' text1.txt > text2.txt

real    0m0.007s
user    0m0.004s
sys     0m0.003s 
```

`awk`比 快大约 3 倍`grep`，并且`cut`比那快大约 3 倍。同样，这个小文件只运行一次并没有太大区别，但是如果您正在编写一个脚本，例如，为了重复使用，或者经常在大文件上执行此操作，您可能会欣赏额外的效率。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-12T03:47:30.337

我经常使用 egrep 来帮助“着色”日志行，所以我一直在寻找正则表达式的新变化。对我来说，通过添加这样的 \W ，上述效果会更好：

```
$ egrep --color '^\S*\W|bag' /tmp/barf -o
foo
bag
hello
bag
keepthis
(etc.) 
```

问题是，我的日志文件几乎总是带有时间戳，所以我在示例文件中添加了一行：

```
2013-06-11 date stamped line 
```

然后它就不能很好地工作了。所以我恢复到我以前的正则表达式：

```
egrep --color '^\w*\b|bag' /tmp/barf 
```

*但是没有日期戳的行显示*了问题。没有着色很难看到这个......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-08-31T05:36:34.147

跟进@Steve 的回答，如果您想使用不同的分隔符（例如逗号），您可以使用-F 指定它。如果您希望每行的内容直到第一个逗号，这将很有用，例如在尝试读取 csv 文件中第一个字段的值时。

```
$ awk -F "," '{print $1}' text1.txt > text2.txt 
```

# git - 挑选一个提交并保留原始 SHA 代码

> ID：14676715
> 
> 赞同：77
> 
> 时间：2013-02-03T20:04:42.947
> 
> 标签：git, commit, sha, cherry-pick

我想在获取的遥控器上挑选一个提交，同时保留它的原始 SHA 提交代码（我当前的分支基于我重置为以前状态的这个遥控器）。

* * *

## 回答 #1

> 赞同：100
> 
> 时间：2013-02-03T20:19:47.840

git SHA 哈希是根据不同的信息计算得出的：

1.  它所指的**树；**基本上，提交出现的分支中存储库的当前内容。
2.  **父提交**的 SHA 。
3.  **提交**消息。
4.  作者**信息**：姓名、电子邮件和时间戳。
5.  **提交者信息**：姓名、电子邮件和时间戳。

即使您编辑了一个精心挑选的提交，使得树、提交消息、作者和提交者信息完全相同，父提交（或提交，如果处理合并提交）的 SHA 总是不同的。因此，您将无法在挑选樱桃后生成相同的 SHA 哈希（除非您发现 SHA 冲突；））。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-02-03T20:10:56.367

SHA 提交哈希由存储库的状态组成，使用直到提交点的整个历史记录（不包括分支）。这意味着除非整个历史记录相同，否则您不能将原始哈希保留在樱桃采摘上，在这种情况下，樱桃采摘将毫无意义。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-03T22:35:24.360

根据您对其他答案的评论，我认为您只是想重置为一些远程提交。您可以使用它`git reset --hard <SHA>`来执行此操作。**警告：这将*丢弃您在工作目录中的所有（未提交）更改*，并且您在此分支中所做的所有提交将不再可访问。**

如果这不是你想要的（或者你不确定），请更清楚地描述你做了什么，你想做什么或者你想要完成什么。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2019-10-10T02:15:05.820

进入交互式 rebase（“git rebase -i”）并在末尾粘贴一个新条目，其中包含您想要添加到 HEAD 的确切修订。

例子：

打开一个交互式变基会话：

```
$ git rebase -i HEAD~4 
```

屏幕现在显示[类似于]：

```
pick efdd0ece Linked how to make a pull requests in README
pick 790a3be8 adjust pytest pins to fix testing infra
pick 5bb90d8f drop 3.4 support
pick 839dc8ba v2.22.0
pick b97fb61a Print the type of the password instead of the password itself 
```

您当前的 HEAD 是最后一个条目。在底部添加一个新条目（只需“选择”和您的修订；无需描述），其中包含您要添加的确切修订：

```
pick efdd0ece Linked how to make a pull requests in README
pick 790a3be8 adjust pytest pins to fix testing infra
pick 5bb90d8f drop 3.4 support
pick 839dc8ba v2.22.0
pick b97fb61a Print the type of the password instead of the password itself
pick 2a173c2a6491aae0772640ba7946a08315d18eb8 
```

保存并关闭。确切的修订现在将成为您的 HEAD：

```
$ git log --oneline | head -n 6
2a173c2a Some commit
b97fb61a Print the type of the password instead of the password itself
839dc8ba v2.22.0
5bb90d8f drop 3.4 support
790a3be8 adjust pytest pins to fix testing infra
efdd0ece Linked how to make a pull requests in README 
```

如其他答案所述，**您仍然必须遵守规则**。这仅适用于您拥有完全相同的分支、父级和提交者的非常狭窄的情况（例如，在以代码审查为中心的流程中，您有一堆提交在某个地方排队，开发人员可以将它们向上推送并无需先将它们提交到存储库中即可将它们关闭）；真的只有当时间戳是唯一可能改变的东西时。在这种情况下，您可以强制相同的修订，以强制时间戳保持不变。

在大多数其他情况下，父母通常会有所不同，仅此一项，就意味着你强迫某个修改的梦想将破灭。如果任何非时间戳因素不同，Git 将始终将修订修正为正确。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2020-12-02T20:39:03.727

我在以前的答案中找不到它，所以请注意，如果您在提交的父级之上进行挑选，实际上可以通过添加`--ff`标志来保留原始 SHA。

# c# - 从方法返回可为空的 GCHandle

> ID：14676717
> 
> 赞同：0
> 
> 时间：2013-02-03T20:05:01.143
> 
> 标签：c#, .net

想要这样做，但 GCHandle 不可为空。我需要 GCHandle 来检索与缓冲区关联的 IntPtr，然后释放它，因此它不是仅返回 IntPtr 的选项。

```
public GCHandle PacketToGCHandle(PacketAdmin packet)
{
    byte[] data;
    bool result;
    if ((data = PacketToByteData(packet)) != null)
    {
        GCHandle pinnedArray = GCHandle.Alloc(data, GCHandleType.Pinned);
        return pinnedArray;
    }
    else
    {
        result = false;
        report.BindReport(architecture.report);
    }
    return null;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:14:30.823

你需要使它可以为空：

```
public GCHandle? PacketToGCHandle(PacketAdmin packet) 
```

这是一个简短的版本：

```
public Nullable<GCHandle> PacketToGCHandle(PacketAdmin packet) 
```

它的值（如果存在）可以通过`Value`属性获得，`HasValue`属性表示是否`null`存在。

# c++ - 使用 jsoncpp 将字符串映射转换为 json

> ID：14676718
> 
> 赞同：6
> 
> 时间：2013-02-03T20:05:10.577
> 
> 标签：c++, json, jsoncpp

我正在使用 jsoncpp，有没有办法在 Json::Value 中放置地图？

我知道我可以一一提取密钥并将它们放入 Json::Value 中。但有更优雅的方式吗？例如在 C# 对应部分 NewtonSoft json api

我会做

```
 String json = JsonConvert.SerializeObject(cmdDict); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2019-03-15T05:28:06.233

jsoncpp 不支持。

支持 JSON 和 C++ 类型之间转换的两个 C++ 库是[nlohmann](https://github.com/nlohmann/json)和[jsoncons](https://github.com/danielaparker/jsoncons)（请参阅[此答案](https://stackoverflow.com/questions/54318130/cpp-json-parser-in-cpp-that-provide-support-serialize-deserialize-feature-conv/55187898#55187898)）。请注意，C++ 没有自省功能，因此需要根据库的规范显式设置自定义 C++ 类型和 JSON 之间的映射。

# search - 单击搜索并转到工作簿中的单元格

> ID：14676719
> 
> 赞同：1
> 
> 时间：2013-02-03T20:05:16.553
> 
> 标签：search, hyperlink, tags, excel

我想知道是否有人可以帮助我解决这个问题。

我有一个带有几个选项卡和一个主页的工作簿。

在主页上，我有自动填充的前 20 个问题。我想要做的是在“数字”行上自动创建超链接，当我单击它们以在工作簿中搜索该数字并转到时。类似于 CTRL+F。

```
编号 - 问题 - 状态   
IM123
IM124
IM145
ETC..
```

有人能帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T17:16:37.197

在这种情况`Worksheet_SelectionChange`下，您可以使用类似这样的东西来搜索数据

```
If Not Intersect(Target, Range("A1:A4")) Is Nothing Then
    If Target.Count = 1 Then
        Cells.Find(What:=Target.Value, LookIn:=xlFormulas, LookAt:= _
                   xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
                   After:=ActiveCell, SearchFormat:=False).Activate
    End If
End If 
```

这将移动到下一个包含与您单击的单元格相同数据的单元格，只要您在指定范围内*(A1:A4)*并且您只选择了一个单元格*(Target.Count=1)*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T18:19:24.127

以下将搜索您选择的单元格中的任何数字。除了找到第一个结果外，它还会询问您是否要继续搜索下一个结果。这样，如果您有多个问题实例，您可以“循环”通过工作表中找到的所有结果。它还将忽略在 MainWorksheet 上找到的包含前 20 个问题的搜索结果。Cells.Find 本身只会返回找到的第一个结果，即使它在同一个工作表中。

它还会告诉您是否在每张表中找到了问题编号，以及何时检查了所有工作表（以防找不到更多结果）。如果您回复不想继续搜索，它将转到在最近检查的工作表中找到的问题编号的第一个实例。

为了模拟超链接，您需要使用工作表事件，例如 Intersect（在 Sean 的回答中描述）或 FollowHyperlink。就个人而言，我更喜欢在可能的情况下使用工作表事件的替代方法，因为它们总是在满足条件时触发，即使是无意的。例如，您可以创建一个形状或宏按钮并将宏分配给它。这样，代码只会在用户单击按钮时运行。

此外，一旦您确定了问题，请让我们知道您是否真的想做更多事情。例如，您可以自动更改相关单元格，或创建已找到的该问题（或所有问题）的所有实例的列表。

祝你好运！

```
'Create a string variable to store the problem status
    Dim StringProblemStatus As String

'Create a string variable to store the worksheet name of the main page containing the problem status
    Dim StringMainWorksheet

'Create a range variable to store the results of the Find method
    Dim RangeFindResults As Range

'Create an integer variable to store the current worksheet number
    Dim IntegerSheetCount As Integer

'Set the variable to the problem status stored in the current cell
    StringProblemStatus = Selection.Value

'Set the variable to the worksheet name containing the problem status
    StringMainWorksheet = ActiveSheet.Name

'Create a For/Next loop so that the following code will evaluate all worksheets in the workbook
    For IntegerSheetCount = 1 To ActiveWorkbook.Sheets.Count
    Sheets(IntegerSheetCount).Activate

'Search for the problem number within the worksheet

        'Check that the sheet being searched is not the MainWorksheet
        If ActiveSheet.Name <> StringMainWorksheet Then

            'Searches for exact matches
            Set RangeFindResults = _
            Cells.Find( _
            What:=StringProblemStatus, _
            After:=ActiveCell, _
            LookIn:=xlFormulas, _
            LookAt:=xlWhole, _
            SearchOrder:=xlByRows, _
            SearchDirection:=xlNext, _
            MatchCase:=False, _
            SearchFormat:=False _
            )

            'Returns a message to the user if the status is not found
            If RangeFindResults Is Nothing Then
                MsgBox "Problem Status " & StringProblemStatus & " was not found in worksheet " & Sheets(IntegerSheetCount).Name
            Else

                'Returns a message to the user if the status is found
                If MsgBox("Problem Status " & RangeFindResults & " found in worksheet " & _
                Sheets(IntegerSheetCount).Name & " in cell " & " " & RangeFindResults.Address & _
                ". Continue searching?", vbYesNo) = vbNo Then

                    RangeFindResults.Activate 
                    Exit Sub

                End If

            End If

        End If

    'Move to the next worksheet
    Next IntegerSheetCount

    'Notify the user that all worksheets have been searched
    MsgBox "All worksheets searched"

End Sub 
```

# jquery - HTML / jQuery : 我想从另一个文件加载横幅

> ID：14676722
> 
> 赞同：1
> 
> 时间：2013-02-03T20:05:28.510
> 
> 标签：jquery, html, dynamic

我是 jQuery 新手，但一位朋友建议为此使用它。

我想将横幅从另一个位置动态加载到广告框中。我已经让它通过横幅循环了。

```
$(document).ready(function() {
    $('.banner').cycle({
        fx: 'fade' // choose your transition type, ex: fade, scrollUp, shuffle, etc...
    });
}); 
```

这很好用，但链接仍然必须在 html 文件中，我希望能够编辑单个文件，它将更新所有模板上的横幅。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T00:06:27.400

像这样的东西。

```
$(document).ready(function() {
    $('.banner').load('banner.html').cycle({
        fx: 'fade' // choose your transition type, ex: fade, scrollUp, shuffle, etc...
    });
}); 
```

看看[http://api.jquery.com/load/](http://api.jquery.com/load/)

# python - cv2.imshow 和 numpy.dstack 核心转储

> ID：14676726
> 
> 赞同：5
> 
> 时间：2013-02-03T20:05:42.400
> 
> 标签：python, opencv, numpy

我正在尝试将两个图像堆叠在一起，所以我可以在一个窗口中显示它们。第一个图像是原始的 3 通道图像，第二个是灰色版本。**我用 cv2.cvtColor 进行了颜色转换，用numpy.dstack**转换回 3 通道，当我尝试**cv2.imshow**时，它给了我一个“**核心转储**”错误。我错过了什么吗？我需要两个图像具有相同数量的通道才能将它们与 numpy.hstack 堆叠。这发生在 Ubuntu 64 位机器上。

```
import cv2
import numpy as np

img = cv2.imread("/home/bernie/Dropbox/Python/Opencv/lena512.jpg")

gray = cv2.cvtColor(img,cv2.COLOR_BGR2GRAY)
gray = np.dstack((gray,gray,gray))

#res = np.hstack((img,gray))

print gray.dtype
print gray.shape

cv2.imshow('gray',gray)
#cv2.imshow('res',res)
cv2.waitKey() 
```

* * *

## 添加

另一方面，使用

```
gray = cv2.cvtColor(gray,cv2.COLOR_GRAY2BGR) 
```

在**第 7 行**中，没有任何抱怨，所以我现在会坚持这一点。这意味着**cv2.cvtColor**结果和**numpy.dstack**结果之间存在差异，用于将 1 通道图像转换为具有相等值的 3 通道。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T18:25:05.603

正如评论中所建议的，尝试使用，`cv2.merge`因为显然它的步幅不同于`np.dstack`：

```
gray = cv2.merge([gray]*3) 
```

有关更多信息，请参阅[@fraxel](https://stackoverflow.com/users/1175101/fraxel)的[链接](http://answers.opencv.org/question/373/cv2-bindings-incompatible-with-numpydstack/)

# c - 使用 C 在 Raspberry Pi 上的 clock_gettime

> ID：14676730
> 
> 赞同：0
> 
> 时间：2013-02-03T20:06:09.623
> 
> 标签：c, timer, timing, raspberry-pi

我想在循环中测量函数开始到结束之间的时间。这种差异将用于设置内部 while 循环的循环数量，这在这里做了一些不重要的事情。

我想像这样计时功能：

```
#include <wiringPi.h>
#include <time.h>
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <unistd.h>
#define BILLION 1E9

float hz = 1000;
long int nsPerTick = BILLION/hz;

double unprocessed = 1;
struct timespec now;
struct timespec last;
clock_gettime(CLOCK_REALTIME, &last);

[ ... ]

while (1) 
{
    clock_gettime(CLOCK_REALTIME, &now); 

    double diff = (last.tv_nsec - now.tv_nsec );

    unprocessed = unprocessed + (diff/ nsPerTick);
    clock_gettime(CLOCK_REALTIME, &last);

    while (unprocessed >= 1) { 
            unprocessed --;
            DO SOME RANDOM MAGIC;
            }
    } 
```

计时器之间的差异始终为负。有人告诉我这是错误所在：

```
 if ( (last.tv_nsec - now.tv_nsec)<0) {
         double diff = 1000000000+ last.tv_nsec - now.tv_nsec;
         }
    else {
         double diff = (last.tv_nsec - now.tv_nsec );
    } 
```

但是，我的变量差异总是像“-1095043244”这样的负数（但在函数期间花费的时间当然是正数）。

怎么了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-29T11:52:55.747

我只是在用类似的方法和类似的问题调查 Pi 的时间安排。我的想法是：

您不必使用双倍。事实上，您也不需要纳秒，因为 Pi 上的时钟无论如何都具有 1 微秒的精度（这是 Broadcom 的做法）。我建议您使用 gettimeofday() 来获取微秒而不是纳秒。那么计算就很简单了，就是：

```
number of seconds + (1000 * 1000 * number of micros) 
```

您可以简单地将其计算为无符号整数。

我为此实现了方便的 API：

```
typedef struct
{
    struct timeval startTimeVal;
} TIMER_usecCtx_t;

void TIMER_usecStart(TIMER_usecCtx_t* ctx)
{
    gettimeofday(&ctx->startTimeVal, NULL);
}

unsigned int TIMER_usecElapsedUs(TIMER_usecCtx_t* ctx)
{
    unsigned int rv;

    /* get current time */
    struct timeval nowTimeVal;
    gettimeofday(&nowTimeVal, NULL);

    /* compute diff */
    rv = 1000000 * (nowTimeVal.tv_sec - ctx->startTimeVal.tv_sec) + nowTimeVal.tv_usec - ctx->startTimeVal.tv_usec;

    return rv;
} 
```

用法是：

```
TIMER_usecCtx_t timer;
TIMER_usecStart(&timer);

while (1)
{
    if (TIMER_usecElapsedUs(timer) > yourDelayInMicroseconds)
    {
        doSomethingHere();
        TIMER_usecStart(&timer);
    }
} 
```

另请注意，对 Pi 的 gettime() 调用几乎需要 1 [us] 时间才能完成。因此，如果您需要大量调用 gettime() 并且需要更高的准确性，请使用一些更高级的获取时间的方法...我在[这篇关于 Pi 获取时间调用的简短文章中对此进行了更多解释](http://yosh.ke.mu/article/raspberry_pi_getting_time)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:22:12.653

你的第一个问题是你有`last.tv_nsec - now.tv_nsec，这是错误的方式。

`last.tv_nsec`是过去的（假设它设置为 1），并且`now.tv_nsec`总是更晚（例如，8ns 之后，所以它是 9）。在这种情况下，`last.tv_nsec - now.tv_nsec`== 1 - 9 == -8。

另一个问题是 tv_nsec 不是以纳秒为单位的时间：为此，您需要将时间（以秒为单位）乘以十亿并加上。因此，要获得现在和上次之间的 ns 差异，您需要：

```
((now.tv_sec - last.tv_sec) * ONE_BILLION) + (now.tv_nsec - last.tv_nsec) 
```

（注意，尽管 now.tv_nsec 和 last.tv_nsec 都小于 10 亿，但我仍然有点惊讶，但从另一个中减去一个得到的值小于 -1000000000，所以我可能还缺少一些东西。 )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-06-10T19:04:36.240

好吧，我不知道 C，但如果它是 Raspberry Pi 上的时间问题，它可能与芯片上缺少 RTC（实时时钟）有关。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-17T01:53:30.753

你不应该存放`last.tv_nsec - now.tv_nsec`在双份中。

如果您查看 的文档[`time.h`](http://pubs.opengroup.org/onlinepubs/7908799/xsh/time.h.html)，您可以看到它`tv_nsec`存储为 long。因此，您将需要以下内容：

```
long diff = end.tv_nsec - begin.tv_nsec 
```

话虽如此，仅比较纳秒可能会出错。您还需要查看秒数。因此，要将所有内容转换为秒，您可以使用以下命令：

```
long nanosec_diff = end.tv_nsec - begin.tv_nsec;
time_t sec_diff = end.tv_sec - begin.tv_sec; // need <sys/types.h> for time_t
double diff_in_seconds = sec_diff + nanosec_diff / 1000000000.0 
```

另外，请确保您始终从开始时间中减去结束时间（否则您的时间仍然是负数）。

你去吧！

# javascript - Facebook Feed 上的网页无限滚动

> ID：14676733
> 
> 赞同：2
> 
> 时间：2013-02-03T20:06:26.433
> 
> 标签：javascript, jquery, json, jquery-plugins

我正在尝试使用**[此](https://github.com/paulirish/infinite-scroll/)**插件为 Facebook 提要创建无限滚动效果，现在我可以通过图形 api（粉丝页面墙贴）访问我需要的提要，并将其限制为 10，即使如此 Facebook 也提供了下一个以及指向实际 json 数据中下一个或前 10 个帖子的先前链接，但我似乎无法让这个插件使用它。

以下是 json 数据的示例：

```
{
   "data": [
      {
         "id": "393459637370574_326418557474553",
         "from": {
            "category": "Consulting/business services",
            "name": "Global Georgia",
            "id": "393459637370574"
         },
         "to": {
            "data": [
               {
                  "name": "Global Georgia Tour",
                  "start_time": "2012-12-05",
                  "location": "Republic of Georgia",
                  "id": "297926606990415"
               }
            ]
         },
         "message": "What a lovely trip it was!",
         "picture": "http://photos-a.ak.fbcdn.net/hphotos-ak-snc7/205700_468134469903090_2092776360_s.jpg",
         "link": "https://www.facebook.com/photo.php?fbid=468134469903090&set=oa.462645617136057&type=1&relevant_count=4",
         "icon": "http://static.ak.fbcdn.net/rsrc.php/v2/yz/r/StEh3RhPvjk.gif",
         "privacy": {
            "value": ""
         },
         "type": "photo",
         "object_id": "468134469903090",
         "created_time": 1359555861,
         "updated_time": 1359555861,
         "likes": {
            "data": [
               {
                  "name": "Mareleen du Plessis",
                  "id": "1382224862"
               }
            ],
            "count": 1
         },
         "comments": {
            "count": 0
         }
      },
      {
         "id": "393459637370574_333589073411971",
         "from": {
            "category": "Consulting/business services",
            "name": "Global Georgia",
            "id": "393459637370574"
         },
         "story": "Global Georgia shared a link.",
         "story_tags": {
            "0": [
               {
                  "id": "393459637370574",
                  "name": "Global Georgia",
                  "offset": 0,
                  "length": 14,
                  "type": "page"
               }
            ]
         },
         "picture": "http://external.ak.fbcdn.net/safe_image.php?d=AQCwYiOOZnd4DK5_&w=90&h=90&url=http\u00253A\u00252F\u00252Frsa.mfa.gov.ge\u00252FuniInc.php\u00253Fmode\u00253Dimg\u002526src_jpg\u00253Dfiles\u00252Frsa\u00252FPresentation_Credentials_to_President_Jacob_Zuma_of_South_Africa-29.01.2013.jpg\u002526im_new_w\u00253D200",
         "link": "http://rsa.mfa.gov.ge/index.php?lang_id=ENG&sec_id=913&info_id=16905",
         "name": "News - Embassy of Georgia to the Republic of South Africa",
         "caption": "rsa.mfa.gov.ge",
         "description": "On January 2013, in Pretoria, the firstAmbassador Extraordinary and Plenipotentiary of Georgia in the Republic of South Africa, Mr Beka Dvali presented his credentials to the President of the Republic of South Africa, H.E. Mr Jacob Zuma. ",
         "icon": "http://static.ak.fbcdn.net/rsrc.php/v2/yD/r/aS8ecmYRys0.gif",
         "privacy": {
            "value": ""
         },
         "type": "link",
         "status_type": "shared_story",
         "created_time": 1359550985,
         "updated_time": 1359550985,
         "likes": {
            "data": [
               {
                  "name": "Ivan A Meyer",
                  "id": "100000016287990"
               },
               {
                  "name": "Amanda Aldum",
                  "id": "779374234"
               },
               {
                  "name": "Cazz Bouwer",
                  "id": "100001702505460"
               },
               {
                  "name": "Gigi Mikeladze",
                  "id": "100004658262461"
               }
            ],
            "count": 4
         },
         "comments": {
            "count": 0
         }
      },
      {
         "id": "393459637370574_450229665031926",
         "from": {
            "category": "Consulting/business services",
            "name": "Global Georgia",
            "id": "393459637370574"
         },
         "story": "Global Georgia shared Embassy of Georgia in the Republic of South Africa's photo.",
         "story_tags": {
            "0": [
               {
                  "id": "393459637370574",
                  "name": "Global Georgia",
                  "offset": 0,
                  "length": 14,
                  "type": "page"
               }
            ],
            "22": [
               {
                  "id": "340928409306379",
                  "name": "Embassy of Georgia in the Republic of South Africa",
                  "offset": 22,
                  "length": 50,
                  "type": "page"
               }
            ]
         },
         "picture": "http://photos-f.ak.fbcdn.net/hphotos-ak-snc7/385189_475566662509219_1872863393_s.jpg",
         "link": "https://www.facebook.com/photo.php?fbid=475566662509219&set=a.405386502860569.99241.340928409306379&type=1",
         "name": "Timeline Photos",
         "caption": "Information on the meeting of the Ambassador of Georgia\r\nwith the National Librarian and Chief Executive Officer\r\nof the National Library of South Africa\r\n\r\nOn 24 January 2013 H.E. Mr Beka Dvali, Ambassador of Georgia held a meeting with Mr John Tsebe, the National Librarian and Chief Executive Officer of  the National Library of the Republic of South Africa, and the Chair of the Conference of Directors of National Libraries (CDNL)).\r\nAmbassador of Georgia passed on Mr Tsebe several books to be catalogued as the first ever publications on Georgia at the National Library of South Africa.\r\nDuring the meeting, the parties discussed the possibilities of cooperation between the national libraries of the two countries, the issues of supplying Georgian and Georgia-related books, by the support of the Embassy, to the National Library of South Africa as well as the prospects of hosting by the library a  literature event featuring contemporary Georgian author(s). \r\n\r\n24 January 2013\r\nPretoria",
         "properties": [
            {
               "name": "By",
               "text": "Embassy of Georgia in the Republic of South Africa",
               "href": "https://www.facebook.com/EmbassyOfGeorgia?ref=stream"
            }
         ],
         "icon": "http://static.ak.fbcdn.net/rsrc.php/v2/yD/r/aS8ecmYRys0.gif",
         "privacy": {
            "value": ""
         },
         "type": "photo",
         "status_type": "shared_story",
         "object_id": "475566662509219",
         "application": {
            "name": "Photos",
            "id": "2305272732"
         },
         "created_time": 1359387805,
         "updated_time": 1359387805,
         "comments": {
            "count": 0
         }
      }
   ],
   "paging": {
      "previous": "https://graph.facebook.com/393459637370574/feed?limit=3&date_format=U&access_token=XXXX&since=1359555861&__previous=1",
      "next": "https://graph.facebook.com/393459637370574/feed?limit=3&date_format=U&access_token=XXXX&until=1359387804"
   }
} 
```

我将如何使此功能正常工作？

非常感谢任何帮助/建议

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T11:57:30.960

看起来您必须花费大量时间与无限滚动.js 争吵才能让它做您想做的事情，因为它取决于您的 HTML 中的分页链接。

可能更容易的是编写自己的 Javascript 来检测用户何时滚动并根据您最近 JSON 响应中的下一页链接自动加载内容。

如果您查看[jscroll.js](https://github.com/pklauzinski/jscroll/blob/master/jquery.jscroll.js)的代码（与 infinte-scroll 类似的插件，但代码更简单），您可能会很好地了解要查找的内容以及何时加载新内容。具体来说，从第 84 行开始：

```
 // Observe the scroll event for when to trigger the next load
    function _observe() {
        var $inner = $e.find('div.jscroll-inner').first(),
            data = $e.data('jscroll'),
            iContainerTop = parseInt($e.css('paddingTop')) + parseInt($e.css('borderTopWidth')),
            iTopHeight = _isWindow ? _$scroll.scrollTop() : $e.offset().top,
            innerTop = $inner.length ? $inner.offset().top : 0,
            iTotalHeight = Math.ceil(iTopHeight - innerTop + _$scroll.height() + iContainerTop),
            nextHref = $.trim(data.nextHref + ' ' + _options.contentSelector);

        if (_checkNextHref(data) && !data.waiting && iTotalHeight + _options.padding >= $inner.outerHeight()) {
            _debug('info', 'jScroll:', $inner.outerHeight() - iTotalHeight, 'from bottom. Loading next request...');
            return _load();
        }
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T15:49:52.140

查看文档，它似乎允许通过 AJAX 调用 href 中的链接并将响应返回给您的功能。

如果您在 pageload 上进行初始调用以填充初始提要，则创建一个 display: none 链接，如下所示：

```
#nextLink {
   display: none;
} 
```

并给它 data['paging']['next'] 的 href 然后你可以用类似的东西初始化无限滚动：

```
$('.feedContainer').infinitescroll({
  // other options
  nextSelector: "a#nextLink",
  dataType: 'json',
  appendCallback: false
}, function(json, opts) {
    // Update your next link to point to the next page
    $('#nextLink').attr('href',json['data']['paging']['next']);

    // Add your new feed rows here
    var htmlStr = '<li>FeedContent</li>';

    // Append it to the container
    $('.feedContainer').append(htmlStr);
}); 
```

如果支持，请使用 dataType 'jsonp'。

这应该大致给你你正在寻找的东西！

# ios - 为 Phonegap Build 应用添加不带 Xcode 的 facebook iOS SDK

> ID：14676734
> 
> 赞同：1
> 
> 时间：2013-02-03T20:06:38.470
> 
> 标签：ios, facebook, cordova, phonegap-plugins, phonegap-build

我已经能够在不使用 Xcode 的情况下成功构建我的 iOS 应用程序。我的应用程序是 HTML、CSS 和 Javascript 的集合，以及我可以[使用 Phonegap Build 编译的](https://build.phonegap.com/docs/start)config.xml 。

该应用程序的基本功能已经在 iPhone 上进行了测试并且运行良好，但现在**我想使用[Phonegap Build 的 FacebookConnect 插件](https://github.com/phonegap-build/FacebookConnect)**向应用程序添加一个社交层。但是，GitHub 上的文档要求在 Xcode 中设置应用程序。

在不使用 Xcode 的情况下，有没有办法下载 SDK（而不是 .pkg）并将其添加到我上传到 Phonegap Build 以进行编译的项目文件中？如果是这样，我从哪里获得这些文件，我需要哪些文件，以及在我的项目结构中的哪里包含这些文件？

这是我目前的项目结构：

```
-config.xml
-index.html
-includes
--css
--js 
```

也许有一种方法可以用 GitHub 做到这一点，但我从未做过拉取请求或类似的事情。我只是在我的文本编辑器中工作，不知道如何从 GitHub 中提取。

[Phonegap 构建插件](https://build.phonegap.com/docs/plugins)

感谢您对此提供的任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-26T17:55:37.983

我已经在没有 Xcode 的情况下在 Windows 上成功实现了用于 Phonegap Build 的 FacebookConnect 插件。

我建议只按照[Phonegap Build Plugins 页面](https://build.phonegap.com/docs/plugins)上的说明进行操作，而忽略[GitHub 页面](https://github.com/phonegap-build/FacebookConnect)上的说明（其中涉及 Xcode 和其他您不需要 Build 插件的内容）。他们现在更新了 GitHub 页面说明，以引导 Phonegap Build 用户远离 GitHub 说明并转到 Phonegap Build Plugins 页面。

**对于第 1 步**（在 facebook 上设置您的应用），选择 Native iOS App，Bundle ID 与您在 config.xml（即 com.company.appname）中的“id”相同，您可以将 App Store ID 设置为测试时为“0”。

**对于第 2 步**，请确保使用`facebook-js-sdk.js`. 一时间有错别字。

一个很好的测试方法是将[GitHub 上的示例 Simple 应用程序](https://github.com/phonegap-build/FacebookConnect/tree/master/example/Simple)的内容粘贴到一个新的 index.html 文件中，然后将其与您的普通 config.xml 文件一起上传到 Phonegap Build 。我在我的应用程序上进行了一次构建，然后在测试之后，上传了我的普通 index.html 文件。您需要在示例应用程序的 index.html 中进行的唯一更改是将您的 Facebook 应用程序 ID 放在 FB.init 函数的底部。我也改为`response.session`匹配`response.authResponse`Facebook JS SDK，但我不确定这是否有必要。

请务必使用**第 3 步**`config.xml`中提到的所有内容更新您的文件。我还添加了以下代码：

 **```
<access origin="http://m.facebook.com" />

<access origin="http://graph.facebook.com" />

<access origin="http://api.facebook.com" />

<access origin="http://fbcdn.net" subdomains="true" />

<access origin="http://akamaihd.net" subdomains="true" /> 
```

`config.xml`如果您的文件中已经包含以下内容，则不需要上述代码：

```
<access origin="*" /> 
```

FacebookConnect 插件使用 Facebook JS SDK，您可以在此处了解更多信息：[https](https://developers.facebook.com/docs/reference/javascript/) ://developers.facebook.com/docs/reference/javascript/ 。

此外，我遇到的另一个问题是 Phonegap 构建团队正在处理的问题是，在请求权限时，您不能只通过放弃`scope`选项来请求基本权限。目前，您必须至少包含一个`scope`选项才能使登录功能正常工作。

```
function fbLogin () {
  FB.login(function(response) {
    if (response.authResponse) {
      alert('User Login Success!');
    }   else {
      alert('User cancelled login or did not fully authorize.');
    }
  }, { scope: "email" });
} 
```

大多数开发人员可能想要要求的不仅仅是基本权限，所以这应该不是什么大问题。

[我上面的回复来自Phonegap Build Support Site](http://community.phonegap.com/nitobi/topics/_plugins_weve_added_facebook_connect_to_build)上关于 Facebook 插件的讨论。您可以在此处了解有关插件以及当前问题和解决方案的更多信息。

我花了一点时间才弄清楚这些东西，所以希望这能帮助其他人节省一些时间。**

# haskell - 为什么 Haskell 在偏函数中使用底部而不是 null？

> ID：14676737
> 
> 赞同：6
> 
> 时间：2013-02-03T20:07:07.113
> 
> 标签：haskell, types

我正在阅读有关 Haskell 指称语义（[http://en.wikibooks.org/wiki/Haskell/Denotational_semantics](http://en.wikibooks.org/wiki/Haskell/Denotational_semantics)）的内容，但我不明白为什么在一个类型中，与“正常”相比，底部“值”被置于另一个级别值，例如为什么它不能被模式匹配。

我相信模式修补底部会造成麻烦，因为底部也表示非终止计算，但为什么非终止计算和错误应该被同等对待？（我假设使用不受支持的参数调用部分函数可以被视为错误）。

如果所有 Haskell 类型都包含一个模式匹配的 Java-null-like 值而不是底部，那么会丢失哪些有用的属性？

换句话说：为什么不明智地通过提升所有类型的空值来使所有 Haskell 函数总计？

（非终止计算是否需要特殊类型？）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-03T21:01:30.893

在不限制语言的图灵完整性的情况下，您无法摆脱不终止，并且由于停止问题，我们通常无法检测到不终止并将其替换为值。

所以*每一种*图灵完备语言都有底。

Haskell 和 Java 之间的唯一区别是 Java 有底部*和*空值。Haskell 没有后者，这很方便，因为这样我们就不必检查空值了！

换句话说，既然底部是*不可避免*的（在图灵完备的世界中），那么除了招致 bug 之外，*还*让所有东西都可以为空还有什么意义呢？

还要注意，虽然 Prelude 中的一些函数由于历史原因是部分的，但现代 Haskell 风格倾向于在几乎所有地方编写总函数，并`Maybe`在函数中使用显式返回类型，`head`否则会是部分的。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-02-04T02:46:43.050

我在评论中的狡辩无法忍受，我认为 sclv 回答了你问题的第一部分，但至于

> 如果所有 Haskell 类型都包含一个模式匹配的 Java-null-like 值而不是底部，那么会丢失哪些有用的属性？
> 
> 换句话说：为什么不明智地通过提升所有类型的空值来使所有 Haskell 函数总计？

在这里，您似乎在区分非终止和异常。所以，虽然不可能（由于停止问题）在非终止时进行模式匹配，但为什么不能在异常时进行模式匹配呢？

我用我自己的一个问题来回答这个问题：那些从不抛出异常的函数呢？Haskell 毕竟具有全部功能。如果已知某些东西是非异常的，我不应该使用模式匹配来确保它是非异常的。Haskell 作为一种束缚和纪律语言，自然会想在类型上传达这种差异。也许通过写作

```
Integer 
```

对于已知不是异常的整数类型和

```
?Integer 
```

对于可能是异常的整数类型。答案是我们已经这样做了：Haskell 在前奏中有一个类型

```
data Maybe a = Just a | Nothing 
```

可以理解为“要么有，`a`要么什么都没有”。我们可以进行模式匹配，`Maybe`所以这个提议不会给我们任何东西。（我们也有类型`Either`更丰富的“可能出错的计算”以及花哨的 monad 语法/组合器，以使这些易于使用）。

那么，为什么会有*例外*呢？在 Haskell 中，除了 IO monad 之外，我们不能“捕获”异常。如果我们可以完美地模拟异常`Maybe`，`Either`为什么语言中有异常？

对此有几个答案，但核心是*Haskell 异常是不精确的*。可能会出现异常，因为您的程序内存不足，或者您正在执行的线程被另一个线程杀死，或者一大堆其他不可预测的原因。此外，通常对于异常，我们关心我们得到*哪个异常。*那么下面的表达式会导致什么结果呢？

```
(error "error 1") + (error "error 2") :: Integer 
```

这个表达式显然应该导致异常，但是哪个异常呢？ `(+)`专门针对 Integer 的两个参数都很严格，所以这无济于事。我们可以决定它是第一个值，但一般来说我们会有

```
x + y =/= y + x 
```

这将限制我们对等式推理的选择。Haskell 提供了一种行为不精确的异常概念，这很重要，因为语言的纯部分具有完全精确的行为，并且可能会受到限制。

# android - 如何使用 invalidate() 方法重绘 SurfaceView？

> ID：14676741
> 
> 赞同：1
> 
> 时间：2013-02-03T20:07:33.420
> 
> 标签：android, android-canvas, android-view

我有一个`GameBoard`扩展类`SurfaceView`。在里面我有一个`OnDraw`方法：

```
@Override
    protected void onDraw(Canvas canvas) {
        super.onDraw(canvas);
        int size  = getWidth()/8;
        canvasSize = size;
        pawnBitmap[0] = bigPawn;
        pawnBitmap[1] = smallPawn;
        float left_distance;
        float top_distance;
        for(int j = 0; j < 10; j++){
            for (int i =0; i < 4; i++){
                left_distance = i*size+(float)50;
                top_distance = j*size+(float)10;
                canvas.drawBitmap(pawnBitmap[0], left_distance, top_distance, paint);
                canvas.drawBitmap(pawnBitmap[1], 6*size+i*30+(float)10, top_distance+30, paint);
            }
        }

    } 
```

`pawnBoard`，`bigPawn`并且`smallPawn`在这个类中是公开的，它们就像：

```
public BitmapFactory myBitmapFactory = new BitmapFactory();

public  Bitmap[] pawnBitmap = new Bitmap[2];
public Bitmap bigPawn =  Bitmap.createScaledBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.game_button_2), 90, 90, false);
public Bitmap smallPawn = Bitmap.createScaledBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.game_button_2), 30, 30, false); 
```

我还有第二种方法，我正在更改 bigPawn 和 smallPawn 的图像：

```
public void setBitmaps(Bitmap one, Bitmap two){
        this.paint = new Paint();
        this.bigPawn = one;
        this.smallPawn = two;
        this.tmp=4;
        invalidate();

    } 
```

但是在另一个（在另一个类中）调用这个方法之后，图像并没有改变。我检查了使用`tmp`变量 if`setBitmaps()`方法是否真的改变了图像，这是正确的。但是无效功能不起作用。为什么？这是我调用该`setBitmaps`方法的方式：

```
public void savePermutation(View view){

        Bitmap tmpBitmap1 = Bitmap.createScaledBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.blue), 230, 230, false);
        Bitmap tmpBitmap2 = Bitmap.createScaledBitmap(BitmapFactory.decodeResource(getResources(), R.drawable.blue), 100, 100, false);
        myGameBoard.setBitmaps(tmpBitmap1, tmpBitmap2);

    } 
```

我一直在寻找解决方案，但我发现这些都没有帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T21:00:21.430

覆盖`surfaceCreated()`。然后添加这一行：

```
setWillNotDraw(false); 
```

# c++ - 提升正则表达式定义

> ID：14676745
> 
> 赞同：0
> 
> 时间：2013-02-03T20:08:02.957
> 
> 标签：c++, regex, boost

我已经定义了以下 reg。使用 boost 正则表达式库的表达式

`"([[:digit:]]{1,})([[:blank:]]*\\[label=\")([[:print:]]*)(\\([[:print:]]*\\)\\([[:print:]]+\\))(\"];)"`

我`regex_search`用来提取我感兴趣的数据`match[3]`：以下字符串成功，结果`MulOp`

```
0 [label="MulOp(   text1 )(depth =1)"]; 
```

但是它对于以下字符串失败并找到结果`CALL( %text1`，当我希望结果只是`CALL`

```
8 [label="CALL(   %text1(text2) text3 )(depth =2)"]; 
```

你能告诉我如何定义将匹配这两种情况的通用正则表达式吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:45:12.560

问题来自目标字符串中的“（text2）”。这增加了`'('`第一个中不存在的字符，所以`([[:print:]]*)`吃第一个`'('`。您需要`'('`从第一场比赛中排除。将其替换为类似`([^(]*)`if 您的语法将始终是目标名称后跟`'('`. 除此之外很难说，因为你还没有真正定义你正在寻找的是什么。（我不会通过建议仅通过两个示例来简单化这一点，匹配您想要的内容是微不足道的：只需搜索“MulOp”和“CALL”，如果其中任何一个存在，则返回它）

# linux - 使用 Perl 实现 linux 命令“重命名”

> ID：14676746
> 
> 赞同：3
> 
> 时间：2013-02-03T20:08:03.793
> 
> 标签：linux, macos, perl

Mac Os X 没有有用的 linux 命令`rename`，它的格式如下：

```
rename 'perl-regex' list-of-files 
```

所以这是我放在一起的内容，但它不会重命名任何文件（$new 始终与 $file 相同）：

```
#!/usr/bin/env perl -w
use strict;
use File::Copy 'move';

my $regex=shift;
my @files=@ARGV;

for my $file (@files)
{
    my $new=$file;
    $new =~ "$regex";    # this is were the problem is !!!
    if ($new ne $file) 
    {
        print STDOUT "$file --> $new \n";
        move $file, ${new} or warn "Could not rename $file to $new";
    }
} 
```

就好像我没有通过正则表达式，如果我硬编码它

```
$new =~ s/TMP/tmp; 
```

它会工作得很好......有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:45:38.087

```
$operator = 's/TMP/tmp/';
print $operator; 
```

不会神奇地评估运营商，所以毫不奇怪

```
$operator = 's/TMP/tmp/';
$x =~ $operator; 
```

也没有。如果你想评估 Perl 代码，你必须将它传递给 Perl 解释器。您可以使用`eval EXPR`.

```
$operator = 's/TMP/tmp/';
eval('$x =~ '.$operator.'; 1')
   or die $@; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T20:25:21.503

你不能把整个句子`s/TMP/tmp;`放在一个变量中。但是，您可以执行类似的操作

```
$new =~ s/$find/$replace; 
```

`$find`成为您的正则表达式以及`$replace`您想要替换匹配项的内容。

如果你仍然想通过整个句子，你可能想看看[eval()](http://perldoc.perl.org/functions/eval.html)。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-03T21:45:22.333

有两种方法可以优雅地解决这个问题

1.  需要两个单独的命令行参数：一个用于正则表达式，一个用于替换。这是不优雅和限制性的。

    ```
    my ($search, $replace, @files) = @ARGV;

    ...;

    my $new = $file;
    $new =~ s/$search/$replace/e; # the /e evals the replacement,
                                  # allowing us to interpolate vars 
    ```

    像`my-rename '(.*)\.txt' '@{[our $i++]}-$1.foo' *.txt`. 这允许通过字符串变量插值执行几乎任何代码⁽¹⁾。

    [(1): 在旧的 perls 中没有嵌套的正则表达式]

2.  只允许任意 Perl 代码，类似于`perl -ne'...'`. 开关的语义是`-n`当前行作为`$_`. `$_`将文件名传递为，并将最后一条语句的值用作新文件名是有意义的。这会导致类似

    ```
    # somewhat tested
    my ($eval_content, @files) = @ARGV;

    my $code = eval q' sub {
       no strict; # could be helpful ;-)
       my @_out_;
       FILENAME:
       for (@_) {
          my $_orig_ = $_;
          push @_out_, [ $_orig_ =>  do { ' . $eval_content . q' } ];
          # or
          #     do { " . $eval_content . " };
          #     push @_out_, [ $_orig_, $_ ];
          # if you want to use $_ as out-argument (like -p).
          # Can lead to more concise code.
       }
       return @_out_;
    } ';
    die "Eval error: $@" if $@;

    for my $rename ($code->(@files)) {
        my ($from, $to) = @$rename;
        ...
    } 
    ```

    这可以像`my-rename 'next FILENAME if /^\./; our $i++; s/(.*)\.txt/$i-$1.foo/; $_' *.txt`. 这会跳过所有以点开头的文件，注册一个全局变量`$i`，并在每个文件名前面放置一个从一开始向上计数的数字，然后更改扩展名。然后我们`$_`在最后一条语句中返回。

    循环构建原始文件名和新文件名对，可以在第二个循环中处理。

    这可能是相当灵活的，并且不会过于低效。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-03T22:26:13.527

好吧，它已经是一个 Perl 实用程序，并且在 CPAN 上：[http](http://cpan.me/rename) ://cpan.me/rename 。您可以直接使用该实用程序随附的模块[File::Rename](http://cpan.me/File%3a%3aRename)：

```
#!/usr/bin/env perl
use File::Rename qw(rename);
rename @ARGV, sub { s/TMP/tmp/ }, 'verbose'; 
```

其他可能性是将模块和来自该发行版的脚本连接起来，并将生成的文件放入您的`$PATH`.

# python - 循环遍历python中的特定文件

> ID：14676747
> 
> 赞同：1
> 
> 时间：2013-02-03T20:08:04.353
> 
> 标签：python, file, loops, filenames

所以我有一个脚本，我在其中循环浏览文件夹中的一组文件。检索该特定目录中的文件列表后，如何指定要在脚本中使用的文件？

```
target = './directory/'

for file in listdir(target): 
```

现在我在同一个文件夹中有几个不同的文件。

*   **kplr006933899** -2009131105131_ **llc** .fits
*   kplr006933899-2009131105131_lpd **-targ** .fits
*   kplr006933899-2012151031540_ **slc** .fits
*   kplr006933899-2012151031540_spd **-targ** .fits

它们都属于同一组，用“ **kplr006933899** ”表示。如何将部分字符串指定为不同的变量，以指定要循环的文件？

例如：

```
def function(name,types) 
```

调用时可以在哪里写：

```
function(kplr006933899,[slc,llc]) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:19:50.807

有多种方法可以做到这一点。第一种方式：

```
import fnmatch

def my_function(name, types):
    result = []
    for t in types:
        pattern = "{}*{}.fits".format(name, t)
        for filename in fnmatch.filter(listdir(target), pattern):
            result.append(filename)
    return result 
```

您可以使用以下命令调用此函数：`my_function("kplr006933899", ["slc", "llc"])`。该[`fnmatch.filter`](http://docs.python.org/2/library/fnmatch.html#fnmatch.filter)函数执行与您的模式和给定文件名的模式匹配。

第二种方法是使用[`glob`](http://docs.python.org/2/library/glob.html)：

```
result = []
for t in types:
    result.extend(glob.glob("{}/{}*{}.fits".format(target, name, t)))
return result 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:14:10.310

```
>>> "kplr" in  "kplr006933899-2009131105131_llc.fits"
True
>>> 
>>> "kplR" in  "kplr006933899-2009131105131_llc.fits"
False
>>> 
```

请注意，您需要使用引号来表示 string `function("kplr006933899", [slc, llc])`，否则`kplr006933899`将被解释为变量。

# java - 自定义侦听器未注册

> ID：14676756
> 
> 赞同：0
> 
> 时间：2013-02-03T20:09:25.323
> 
> 标签：java, android, listener

我有一个`MyService`实现 custom 的类`CallReceiver.Listener`。问题是调用的侦听器注册`MyService`不起作用。`mListener`in`CallReceiver`始终为空。它证明听众没有注册，但我不知道为什么会这样。

MyService 类（摘录）：

```
public class MyService extends Service implements CallReceiver.Listener {

CallReceiver mCallReceiver;

   public int onStartCommand (Intent intent, int flags, int startId) {

    serviceStart();
    return startId;
   }

    // starting service
    public void serviceStart()  {

    mCallReceiver = new CallReceiver();

    // registering listener for CallReceiver
    mCallReceiver.registerListener(this);
   }

    public void onPhoneStateChange(boolean state) {
     if (state) {
        Log.v("onPhoneStateChange", "service destroyed");
        serviceDestroy();
    } else {
        // serviceStart();
    }
  }

} 
```

呼叫接收器类：

```
public class CallReceiver extends BroadcastReceiver   {

private boolean isRinging = false;
private Listener mListener = null;

// interface declaration
 public interface Listener {
        public void onPhoneStateChange(boolean state);
    }

// listener registration
 public void registerListener (Listener listener) {
        mListener = listener;
    }

@Override
public void onReceive(Context context, Intent intent) {

        String state = intent.getStringExtra(TelephonyManager.EXTRA_STATE);

        if(TelephonyManager.EXTRA_STATE_RINGING.equals(state))  {
            // do something while ringing
                Log.v("phone", "ringing");
                isRinging = true;
        }

        else if(TelephonyManager.EXTRA_STATE_IDLE.equals(state))    {
            //do something when the call ends
            Log.v("phone", "idle");
            isRinging = false;
        }

        if(mListener != null)   {
            // onPhoneStateChange is not called because mListener is null
            mListener.onPhoneStateChange(isRinging);
        }

  }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:30:38.103

您应该动态注册您的接收器。

```
// registering listener for CallReceiver
   mCallReceiver.registerListener(this);
   IntentFilter filter = new IntentFilter("your.Intent");
   registerReceiver (mCallReceiver, filter); 
```

此外，在您的服务 onDestroy() 中，不要忘记取消注册它。

```
@Override
public void onDestroy ()
{
    try {
    unregisterReceiver (broadcastReceiver);
    }
    catch (IllegalArgumentException e){}
    catch (NullPointerException ne){}
    super.onDestroy();
} 
```

# php - PHP不工作，数据库不更新

> ID：14676757
> 
> 赞同：1
> 
> 时间：2013-02-03T20:09:30.703
> 
> 标签：php, mysql, sql, break

我正在编写这个 php 脚本来更新用户密码，需要旧密码、新密码和新密码确认。这一切似乎都取决于实际的`UPDATE`mysql 语句。不知道我做错了什么，感谢大家的帮助！

另外，我知道它不安全等等，我只是想让它首先工作，我是一个 php 新手！

我正在撕扯头发，当我运行它时，一切似乎都正常，除了它刚刚中断`if (empty($error)){`，我已经测试了会话电子邮件的回声并显示了这一点，但是它没有使用新密码更新数据库。请帮忙！下面是我的代码：

```
<?php
session_start();

include('database_connection.php');

$error = array();

if (empty($_POST['oldpassword'])){
$error[] ='You did not enter your current password!';
} else {
    $oldpassword = $_POST['oldpassword'];
}

if (empty($_POST['newpassword'])){

    $error[] = 'You did not enter a new password!';
} else {
    if(preg_match("/^.*(?=.{8,})(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).*$/", $_POST["newpassword"])){
        $newpassword = $_POST['newpassword'];
    } else{
        $error[] = 'Password must be at least 8 characters and must contain at least one lower case letter, one upper case letter and one digit!';
    }
}

if (empty($_POST['newpasswordcon'])){
    $error[] = 'You did not enter your new password confirmation!';
} else {
    if(preg_match("/^.*(?=.{8,})(?=.*[0-9])(?=.*[a-z])(?=.*[A-Z]).*$/", $_POST["newpasswordcon"])){
        $newpasswordcon = $_POST['newpasswordcon'];
    } else{
        $error[] = 'Password must be at least 8 characters and must contain at least one lower case letter, one upper case letter and one digit!';
    }
}

if($_POST['newpassword'] != $_POST['newpasswordcon']){
$error[] ='New password and confirmation do not match!' ;
}

$sql = "SELECT password FROM users WHERE email='" . $_SESSION['email'] . "'";
$result = mysql_query($sql);

if( $r = mysql_fetch_array($result) ) {
extract($r);

if($_POST['oldpassword'] != $password);{
$error[] ='Incorrect current password!';

}

//breaks here
echo $_SESSION['email'];

if (empty($error)){

echo $_SESSION['email'];
mysql_query("UPDATE users SET password='$newpassword' WHERE email='" . $_SESSION['email'] . "'");

echo '<p class ="alert alert-success fade in">Success! Your password has been updated!</p>';

}
} else{

    foreach ($error as $key => $values) {

            echo '<p class ="alert alert-error fade in">'.$values.'</p>';

}
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:20:24.237

有一个不应该存在的分号。

```
if ($_POST['oldpassword'] != $password);{ // <- remove this semicolon after )
   $error[] ='Incorrect current password!';
} 
```

* * *

## 回答 #2

> 赞同：-4
> 
> 时间：2013-02-03T20:16:26.397

我在您的代码中没有看到任何 addlashes() 并且想知道您是否得到任何匹配项？[http://www.php.net/manual/en/function.addslashes.php](http://www.php.net/manual/en/function.addslashes.php)

# vba - 无法调试代码

> ID：14676760
> 
> 赞同：1
> 
> 时间：2013-02-03T20:09:58.977
> 
> 标签：vba, ms-access, ms-access-2007

我对 Access 有一个非常奇怪的问题。我有一个表单，我为该表单创建了一个带有 Click 事件的简单子命令按钮：

```
MsgBox "Hello" 
```

当我放一个断点时，它不会在 break 语句处停止，它只是执行 sub。我不是每天都在 Access 中编程，但我已经使用 Access 进行了 10 多年的编程。我从来没有遇到过这个问题，而且我之前曾在这个客户端访问数据库上工作过。

任何意见，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T20:15:24.957

当您勾选`Access Options->Current Database->Use Access Special Keys`选项时，断点将不再被触发。取消选中此选项还可以防止诸如 F11 打开访问对象窗口之类的事情。

# jquery - JQuery缩放多个项目，纵横比

> ID：14676762
> 
> 赞同：0
> 
> 时间：2013-02-03T20:10:00.920
> 
> 标签：jquery

任何人都可以帮我在缩放时保持这些框之间的间隙，我想任何做过多媒体/图形的人都会知道需要这个算法

我为它创建了一个单独的小提琴。 [http://jsfiddle.net/p9BJ8/](http://jsfiddle.net/p9BJ8/)

```
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <script src="http://code.jquery.com/jquery-1.9.0.min.js"></script>
</head>
<body>
    <div id="canvas">
        <div id="innercanvas">
            <div class="square" style="top:30px; left:30px; width:40px; position:absolute; height:40px; background-color:red"></div>
            <div class="square" style="top:100px; left:90px; width:40px; position:absolute; height:40px; background-color:red"></div>
        </div>
    </div>

    <input type="submit" id="ZoomIn" value="+" />

    <script type="text/javascript">
        var zoom = 40;
        $(document).ready(function () {

            $('#ZoomIn').bind('click', function () {
                zoom = zoom + 5;
                $("#innercanvas .square").each(function (index) {

                    $("#innercanvas").width($("#innercanvas").width + 5);
                    $("#innercanvas").height($("#innercanvas").height + 5);

                    var id = $(this).attr("id");

                        var _offset = $(this).offset();
                        $(this).offset({ top: _offset.top + 5, left: _offset.left + 5 });
                        $(this).width(zoom);
                        $(this).height(zoom);                   
                });
            });    
        });

    </script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:17:19.037

看到这个更新的小提琴：http: [//jsfiddle.net/p9BJ8/1/](http://jsfiddle.net/p9BJ8/1/)

我只改变了一行：

```
$(this).offset({ top: _offset.top + 5*index, left: _offset.left + 5*index }); 
```

该`index`变量来自您的函数回调，它只是等于循环的迭代次数。所以第一次通过是5*1，第二次通过是5*2。所以第二个正方形向下移动了 10 而不是 5，这是必要的，因为第一个正方形既移动了 5 又增加了 5。

# 编辑

为了回应 OP 的评论，这个将对象之间的距离保持在其大小的固定百分比：http: [//jsfiddle.net/p9BJ8/6/](http://jsfiddle.net/p9BJ8/6/)

我创建了以下函数来计算初始“差距百分比”，即`gap's width / square's width`, 和`gap's height / square's height`. 我们实际上只是在用 JavaScript 做基本的数学运算，所以希望这个函数对你来说足够清楚：

```
function getGapPercentage(){
    var squares = $("#innercanvas .square");
    var s1 = squares.eq(0);
    var s2 = squares.eq(1);
    var s1top = parseInt(s1.css('top'), 10);
    var s2top = parseInt(s2.css('top'), 10);
    var s1left = parseInt(s1.css('left'), 10);
    var s2left = parseInt(s2.css('left'), 10);
    var h = s1.height();
    var w = s1.width();
    var gapH = s2top - h - s1top;
    var gapW = s2left - w - s1left;
    var gapPercents =  {
        top: gapH / h,
        left: gapW / w
    };

    return gapPercents;
} 
```

从那里，我们只需修改设置正方形新位置的行：

```
$(this).offset({
    top: _offset.top + (5 + 5*gapPercents.top) * index,
    left: _offset.left + (5 + 5*gapPercents.left) * index
}); 
```

请注意，在`.click()`事件中我`getPercentage()`再次调用该函数，但它只是为了向您显示（通过控制台中的输出）百分比保持不变。不要担心它们实际上似乎略有变化。那只是因为浏览器不能修改一小部分像素，所以有时间隙百分比会与原始值相差很小。但它总是会非常接近原始百分比。

# ember.js - EmberJs：路由器中未收到自定义事件

> ID：14676763
> 
> 赞同：2
> 
> 时间：2013-02-03T20:10:07.367
> 
> 标签：ember.js, eventtrigger, custom-event

> **可能重复：**
> [emberjs：如何在视图中触发自定义事件](https://stackoverflow.com/questions/14634622/emberjs-how-to-trigger-a-custom-event-in-a-view)

我创建了一个 jsfiddle 来演示这个问题。当您单击视图（在文本上）时，您将在控制台中看到视图接收到单击。但是当我创建一个自定义事件并触发它时，它没有在路由器中收到：

```
App.IndexView = Em.View.extend({
    click: function(e) {
        console.log("CLICK");
        this.get("controller").send("doStuff");
}
});

App.IndexRoute = Em.Route.extend({
    ....
    doStuff: function(e) {
       alert("Do stuff") ;    
    }
}); 
```

这里也是一个完整的工作示例[http://jsfiddle.net/jeanluca/9Xasr/6/](http://jsfiddle.net/jeanluca/9Xasr/6/)

有什么建议么 ？

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:49:17.457

您正在调用`doStuff()`App.IndexView 的控制器，但您`doStuff`在 Route 内部定义。你应该把它移到`App.IndexController`：

```
App.IndexController = Em.Controller.extend({
    doStuff: function(e) {
       alert("Do stuff") ;    
    }
}); 
```

小提琴：http: [//jsfiddle.net/8k4PE/](http://jsfiddle.net/8k4PE/)

另一方面，如果您希望路由接收事件：

```
<script type="text/x-handlebars" data-template-name="navigation">
    <span {{action "doStuff}}>Sidebar</span>
</script>

App.IndexRoute = Em.Route.extend({
    //...
    events: {
      doStuff: function(e) {
         alert("Do stuff") ;    
      }
    }
}); 
```

# recursion - WebGL 递归

> ID：14676764
> 
> 赞同：2
> 
> 时间：2013-02-03T20:10:07.493
> 
> 标签：recursion, webgl

我正在编写一个使用递归算法计算几何并使用 WebGL 显示该几何的网站。WebGL 可以使用递归计算几何吗？我知道着色器不能递归，但我不知道是否仍然支持一些递归。

谢谢，伊斯特万。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:17:19.593

您可以使用 JavaScript 中的递归算法轻松生成几何图形。您可以将生成的几何图形存储在数组缓冲区中，然后将其传递给 WebGL。然而，WebGL 没有任何几何生成功能（例如，几何着色器或细分曲面）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-08T17:24:51.257

[使用 webgl 1.0，您可以使用在 webgl渲染](https://www.khronos.org/registry/webgl/specs/1.0/#5.14.7)缓冲区的帮助下创建的渲染目标从着色器中获取输出，然后使用画布的[getImageData](https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/getImageData)获取具有表示几何图形的值的缓冲区。这非常耗时，但可能。另外，建议关注[项目](http://openjscad.org/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-25T23:36:06.823

在 JS 中计算递归算法并将结果传递到着色器中定义的变量中将解决您的问题。

# sql - SQLITE FTS3 查询比标准表慢

> ID：14676779
> 
> 赞同：0
> 
> 时间：2013-02-03T20:11:35.790
> 
> 标签：sql, sqlite, fts3

我从源代码构建 sqlite3 以包含 FTS3 支持，然后在包含 150 万行数据的现有 sqlite 数据库中创建一个新表，使用

```
CREATE VIRTUAL TABLE data USING FTS3(codes text); 
```

然后用

```
INSERT INTO data(codes) SELECT originalcodes FROM original_data; 
```

然后查询每个表

```
SELECT * FROM original_data WHERE originalcodes='RH12'; 
```

这会立即返回，因为我在该列上有一个索引

FTS3 表上的查询

```
SELECT * FROM data WHERE codes='RH12'; 
```

耗时近 28 秒

有人可以帮助解释我做错了什么，因为我预计这会更快

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:44:59.687

该[文档](http://www.sqlite.org/fts3.html#section_1_4)解释说：

> 可以使用两种不同形式的 SELECT 语句有效地查询 FTS 表：
> 
> *   按rowid查询。如果 SELECT 语句的 WHERE 子句包含“rowid = ?”形式的子子句，那么在哪里？是一个 SQL 表达式，FTS 能够使用等效的 SQLite INTEGER PRIMARY KEY 索引直接检索请求的行。
> *   全文查询。如果 SELECT 语句的 WHERE 子句包含“ MATCH ?”形式的子子句，则 FTS 能够使用内置的全文索引将搜索限制为与指定的全文查询字符串匹配的那些文档作为 MATCH 子句的右手操作数。
> 
> 如果这两种查询策略都不能使用，则对 FTS 表的所有查询都使用对整个表的线性扫描来实现。

为了高效查询，您应该使用

```
SELECT * FROM data WHERE codes MATCH 'RH12' 
```

但这将找到*包含*搜索字符串的所有记录。

为了有效地进行“普通”查询，您必须在普通表中保留一份数据副本。（如果要节省空间，可以使用[无内容或外部内容](http://www.sqlite.org/fts3.html#section_6_2)表。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:29:01.827

您应该更仔细地阅读[文档。](http://www.sqlite.org/fts3.html#section_1_4)

使用对虚拟 FTS 表的任何查询`WHERE col = 'value'`都会很慢（除了对 的查询`ROWID`），但使用 FTS 的查询`WHERE col MATCH 'value'`将使用 FTS 并且速度很快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T20:32:17.590

我不是这方面的专家，但这里有一些事情需要考虑。你的测试有缺陷（我认为）。您正在将具有精确文本匹配的场景（索引可以在 original_data 上使用 - 没有什么能胜过这种场景）与 fts3 表上的相等性（我不确定 FTS3 甚至会在这种类型的查询）。如果您想将苹果与苹果进行比较（以了解 FTS3 的好处），您需要将 original_data 上的“喜欢”操作与 FTS3 数据上的“匹配”操作进行比较。

# iphone - 如何知道控制器是presentModalViewController 还是pushViewController？

> ID：14676788
> 
> 赞同：0
> 
> 时间：2013-02-03T20:13:03.510
> 
> 标签：iphone, ios, objective-c

视图控制器可以通过 pushViewController 或 presentModalViewController 从超级视图控制器获得。在这个视图控制器中，我应该如何知道控制器来自哪条路？我需要它来关闭视图——

```
if (presentModalViewController ) {
        [self dismissModalViewControllerAnimated:YES];
    }else{
        [self.navigationController popViewControllerAnimated:YES];
    } 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:26:23.510

如果视图不在导航控制器中（例如因为它被呈现），self.navigationController 将为 nil。当然，如果您展示并拥有导航控制器，则需要更深入地挖掘。

此外，如果您没有出现，“self.presentingViewController”可能为零。

注意 iOS 的一个常见习惯用法是创建一个简单的协议来处理关闭视图。推送/呈现的视图是委托并调用其“viewWantsToClose”目标。如果你创建一个新的 Utility 项目，你会明白我在说什么。这就是 Apple 关闭“信息”视图的方式。您可能会让您的视图接受“doCloseAction”的块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:24:32.777

您负责推送或呈现视图，因此您应该知道何时弹出或关闭视图。如果您仍然需要执行这种检查，您可以从子视图中验证是否`self.navigationController`为 nil

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T22:03:57.020

你可以做：

```
if (self.navigationController == nil) {
      //[self dismissModalViewControllerAnimated:YES]; //Deprecated in iOS 6.0
      [self dismissViewControllerAnimated:YES completion:nil];
}else{
    [self.navigationController popViewControllerAnimated:YES];
} 
```

或者

```
NSArray* views = [self.navigationController viewControllers];
if (self.navigationController == nil || self == [views objectAtIndex:0])
{
   //In the root view of navigationController or a presented View.
   [self dismissViewControllerAnimated:YES completion:nil];
}else{
   [self.navigationController popViewControllerAnimated:YES];
} 
```

# algorithm - 在二叉搜索树中查找小于给定值的所有值的算法

> ID：14676790
> 
> 赞同：3
> 
> 时间：2013-02-03T20:13:08.770
> 
> 标签：algorithm, binary-search-tree, inorder

> **使用 int 的二叉搜索树创建一个包含小于给定整数x**值的所有整数的链表。

我试过什么？

**1）残酷的解决方案（低效）**

BST的 [有序](http://en.wikipedia.org/wiki/Tree_traversal#In-order)访问，我在列表中为Bst中的每个整数插入一个节点，然后我从x开始释放列表的每个节点

**2）更高效但错误**

我进行了搜索，当我找到 x 时，我创建了一个列表，其中包含对我找到 x 的节点的左儿子的有序访问。

这显然是错误的，例如考虑以下 BST：

```
 10
                        /  \
                       9    11
                      /       \
                     5         15
                    / \        / \
                   1   8      13  19
                             /  \
                            12  14 
```

使用此解决方案，如果 x=15 我只考虑 {12,13,14}，它只适用于 x=root。

问题是我该怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:19:39.323

伪代码。*v*是当前顶点，*ans*是答案列表，*someTraversal*是遍历树并返回其元素列表的方法。

1.  v := 根，ans := []

2.  **如果**v.value > x
    **那么**v := v.left，**转到**2；

3.  ans.append(someTraversal (v.left))

4.  **如果**v.value = x
    **则返回**ans;

5.  ans.append(v.value)

6.  v := v.right;

7.  **转到**2；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-04T20:41:31.867

如果存储每个节点的父节点，可以实现更高效的解决方案，只要不关心结果列表中元素的顺序即可：

1.  创建一个新列表以保存结果
2.  找到感兴趣的节点
3.  将步骤 2 中找到的节点的左子树中的所有节点添加到列表中，使用您喜欢的任何遍历（按顺序、预排序等）
4.  从步骤 2 中找到的节点的父节点开始，向上遍历所有父节点，一路添加每个节点，直到当前节点是根节点或其父节点左侧的节点
5.  最后，将所有元素添加到步骤 4 中找到的节点的左侧，再次使用任意遍历

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-08T04:49:54.943

这是一个中序遍历的修改版本，它在节点的值大于 x 时终止。

```
def nums_less_than(n, x, l=None):
  if l == None:
    l = []
  if n.left:
    nums_less_than(n.left, x, l)
  if n.value < x:
    l.append(n.value)
    if n.right:
      nums_less_than(n.right, x, l)
  return l 
```

# python - Python 包的最小 buildout.cfg 文件是什么？

> ID：14676791
> 
> 赞同：2
> 
> 时间：2013-02-03T20:13:10.220
> 
> 标签：python, virtualenv, buildout

我正在开发一个小的 Python 包——一堆`*.py`文件。它有一些依赖项，我想使用 virtualenv 和 buildout 来创建自己的、独立的开发环境，我想将它打包为 Python 鸡蛋。

我应该使用什么食谱？

我应该将我的项目放入`eggs`、`develop`或`parts`变量中吗？

我应该将代码保存在文件夹`src`中`parts`还是`develop-eggs`文件夹中？

那么我在哪里添加依赖项呢？

我阅读了一些教程，但它们看起来对我来说太复杂了——我所需要的只是一个带有解释的简单示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:27:47.653

可能还有其他方法。这就是我喜欢构建我的包的方式：

```
mypackage/
    __init__.py
    mymodule.py

setup.py

    from setuptools import setup

    setup(...
          packages=['mypackage'],
          package_dir={'mypackage': 'mypackage'})

          entry_points="""
              [console_scripts]
              mypackage-script = mypackage.script:main
          """,
  )

buildout.cfg

    [buildout]
    parts =
        scripts
    eggs =
        mypackage
        django
        lxml
        ...

    develop = .

    [scripts]
    recipe = zc.recipe.egg:scripts
    eggs =
        ${buildout:eggs}
    scripts =
        mypackage-script

    interpreter = python 
```

# jpa - JPQL - 谓词和标准API

> ID：14676793
> 
> 赞同：0
> 
> 时间：2013-02-03T20:13:29.467
> 
> 标签：jpa, jpql, predicate

我想写一个基于 2 列计算的谓词。例如 - 我有一个 daysBetween (int) 和 lastSent (date)。

我想知道是否有可能执行以下查询：

从 X 中选择 last_sent + [其他一些间隔的列] lessThan now()

类似于（我现在这不是写它的正确方法..），

```
builder.between(userData.<Date>get("lastSent").addDays(userIntervals.<Integer>get("interval")),DateUtils.now()); 
```

有没有使用谓词编写这样的查询？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T14:48:12.583

JPA Criteria 没有定义 addDays() API。您可以通过 function() API 调用特定于数据库的函数，

见， [http ://en.wikibooks.org/wiki/Java_Persistence/Criteria#Special_Operations](http://en.wikibooks.org/wiki/Java_Persistence/Criteria#Special_Operations)

一些 JPA 提供程序提供对 JPQL 和 Criteria 的扩展。

见， [http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#JpaCriteriaBuilder_and_EclipseLink_Extensions](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/Criteria#JpaCriteriaBuilder_and_EclipseLink_Extensions)

和，

[http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#EclipseLink_Extensions_.28EQL.29](http://wiki.eclipse.org/EclipseLink/UserGuide/JPA/Basic_JPA_Development/Querying/JPQL#EclipseLink_Extensions_.28EQL.29)

# emacs - Emacs 24 的自动完成功能不适用于 Java、C 或 C++ 模式

> ID：14676802
> 
> 赞同：7
> 
> 时间：2013-02-03T20:14:19.203
> 
> 标签：emacs, autocomplete, emacs24

我使用 marmalade repo 安装了自动完成功能。一切安装正确，在移动东西之后，我设法启动并自动更正运行，而我的 init.el 中的以下代码没有任何错误：

```
;; auto-complete
(add-to-list 'load-path "~/.emacs.d/elpa/auto-complete")
(require 'auto-complete-config)
(add-to-list 'ac-dictionary-directories "~/.emacs.d/elpa/auto-complete/dict")
(ac-config-default) 
```

现在我可以在 Emacs Lisp 中使用自动完成功能，而不会出现任何问题，但是每当我使用任何其他模式时，例如 Java、C 或 C++，它都无法正常工作。

我也安装了 yasnippet（它工作得很好），不确定这是否与它有关。这是我的 init.el 中的相关代码：

```
;;yasnippet
(add-to-list 'load-path
              "~/.emacs.d/plugins/yasnippet")
(require 'yasnippet)
(yas-global-mode 1) 
```

我正在学习 Emacs，目前我还是个菜鸟。我一直在查看所有文档和 SO，但没有找到任何东西。我真的很感激这方面的任何帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T21:01:57.410

您可能需要添加完成源。这是我的配置中的内容：

```
(set-default 'ac-sources
             '(ac-source-abbrev
               ac-source-dictionary
               ac-source-yasnippet
               ac-source-words-in-buffer
               ac-source-words-in-same-mode-buffers
               ac-source-semantic)) 
```

*更新*：`ac-config-default`应该涵盖这一点，但如果这些模式没有激活自动完成功能，请尝试将以下内容放入您的 init.el 中：

```
(dolist (m '(c-mode c++-mode java-mode))
  (add-to-list 'ac-modes m))

(global-auto-complete-mode t) 
```

*更新 2 ：我已经发布了一个[要点](https://gist.github.com/4704610)，它可以调整您的 init.el 以*使用*`package-install`.*

 *我不知道您引用的是哪个版本的自动完成功能，但最新版本对我来说效果很好。

![具有工作自动完成功能的 C 模式](../Images/9a76e4a8ab8aadd9b2c3aa528fdba78a.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T01:40:41.270

我和你有完全相同的问题。Emacs-Lisp 与自动完成完美结合，但 C、C++ 不起作用。在尝试了各种组合之后，我发现从 .emacs 中注释掉 yasnippet 可以解决我的问题。希望这可以帮助你。我的自动完成版本是 1.3.1。*

# c++ - 提高 OpenGL 中的 VBO 性能

> ID：14676804
> 
> 赞同：4
> 
> 时间：2013-02-03T20:14:29.600
> 
> 标签：c++, performance, opengl, 3d, vbo

所以我目前正在尝试以不错的速度渲染复杂的模型，但遇到了一些麻烦；渲染单个模型会导致我的帧速率变得紧张，而在程序中没有任何额外的工作。我的模型（场景中只有一个）似乎太大了。我上传到缓冲区的顶点数组中有 444384 个浮点数（因此模型中有 24688 个三角形）。

```
//Create vertex buffers
glGenBuffers(1, &m_Buffer);
glBindBuffer(GL_ARRAY_BUFFER, m_Buffer);    
int SizeInBytes = m_ArraySize * 6 * sizeof(float);
glBufferData(GL_ARRAY_BUFFER, SizeInBytes, NULL, GL_DYNAMIC_DRAW);

//Upload buffer data
glBufferSubData(GL_ARRAY_BUFFER, 0, sizeof(float) * VertArray.size(), &VertArray[0]); 
```

我知道 VBO 的大小是有区别的，因为 A）减小大小可以提高性能，B）注释掉渲染代码：

```
glPushMatrix();

//Translate
glTranslatef(m_Position.x, m_Position.y, m_Position.z);

glMultMatrixf(m_RotationMatrix);

//Bind buffers for vertex and index arrays
glBindBuffer(GL_ARRAY_BUFFER, m_Buffer);

glEnableClientState(GL_VERTEX_ARRAY);
glVertexPointer(3, GL_FLOAT, 6 * sizeof(float), 0);
glEnableClientState(GL_NORMAL_ARRAY);
glNormalPointer(GL_FLOAT, 6 * sizeof(float), (void*)12);

//Draw
glDrawArrays(GL_TRIANGLES, 0, m_ArraySize);

glDisableClientState(GL_VERTEX_ARRAY);
glDisableClientState(GL_NORMAL_ARRAY);

//Unbind the buffers
glBindBuffer(GL_ARRAY_BUFFER, 0);

glPopMatrix(); 
```

给我留下大约 2000-2500 FPS，而取消注释此代码会使我下降到大约 130FPS，或 8 毫秒/帧（仅此一项就足够了，但我还需要能够在程序中做其他事情，其中​​一些这可能是 CPU 密集型的）。具有 85k 个三角形的更复杂的模型将其降低到 50 FPS 或大约 20 毫秒/帧，此时程序明显卡顿。

在这一点上，我使用的一对着色器非常少，我怀疑这就是问题所在。他们在这里，以防万一；首先是顶点着色器：

```
void main()
{
    vec3 normal, lightDir;
    vec4 diffuse;
    float NdotL;
    /* first transform the normal into eye space and normalize the result */

    normal = normalize(gl_NormalMatrix * gl_Normal);
    /* now normalize the light's direction. Note that according to the

    OpenGL specification, the light is stored in eye space. Also since
    we're talking about a directional light, the position field is actually
    direction */
    lightDir = normalize(vec3(gl_LightSource[0].position));
    /* compute the cos of the angle between the normal and lights direction.

    The light is directional so the direction is constant for every vertex.
    Since these two are normalized the cosine is the dot product. We also
    need to clamp the result to the [0,1] range. */
    NdotL = max(dot(normal, lightDir), 0.0);
    /* Compute the diffuse term */

    diffuse = gl_FrontMaterial.diffuse * gl_LightSource[0].diffuse;
    gl_FrontColor =  NdotL * diffuse;

    gl_Position = ftransform();
} 
```

和片段着色器：

```
void main()
{
    gl_FragColor = gl_Color;
} 
```

我正在使用[GTX 660M](http://www.geforce.com/hardware/notebook-gpus/geforce-gtx-660m)作为我的显卡运行程序。

现在据我所知，VBO是OpenGL中渲染大量多边形最快的方法，而且网上似乎建议很多机器可以同时计算和显示数百万个多边形，所以我相信一定有办法优化我相对微不足道的 27k 三角形的渲染。我宁愿现在就这样做，也不愿将来重写和重组大量代码。

我启用了背面剔除；我不确定 fustrum 剔除会有所帮助，因为有时，所有或大部分模型都在屏幕上（我目前剔除对象，但不是单个对象中的三角形）。剔除视口中不面向相机的面可能会有所帮助，但我不知道该怎么做。除此之外，我不确定如何优化渲染。我还没有实现顶点缓冲区，但我读过这可能只会将速度提高 10% 左右。

人们如何以可接受的帧速率同时在屏幕上实现数万或数十万个三角形，同时进行其他操作？我可以做些什么来提高我的 VBO 渲染的性能？

**更新：**根据下面的评论，我只画了一半的数组，如下所示：

glDrawArrays(GL_TRIANGLES, 0, m_ArraySize/2);

然后是数组的四分之一：

glDrawArrays(GL_TRIANGLES, 0, m_ArraySize/4);

减少每次绘制的数组数量实际上使速度翻了一番（分别从 12 毫秒到 6 毫秒和 3 毫秒），但模型完全完好无损——没有任何遗漏。这似乎表明我在其他地方做错了什么，但我不知道是什么；我相当有信心在构建模型时不会添加 4 次以上相同的三角形，那还能是什么呢？我可能会以某种方式多次上传缓冲区吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-08T03:54:44.787

`glDrawArrays()`将要绘制的**索引**数作为其第三个参数。您传入交错顶点和法线数组中的浮点数，这是索引数的 6 倍。GPU 滞后是因为您告诉它访问缓冲区边界之外的数据——现代 GPU 在发生这种情况时会触发故障，旧的 GPU 只会使您的系统崩溃:)

考虑以下交错数组：

```
vx0 vy0 vz0 nx0 ny0 nz0 vx1 vy1 vz1 nx1 ny1 nz1 vx2 vy2 vz2 nx2 ny2 nz2 
```

该数组包含三个顶点和三个法线（一个三角形）。绘制三角形需要三个顶点，因此您需要三个索引来选择它们。要绘制上述三角形，您将使用：

```
glDrawArrays(GL_TRIANGLES, 0, 3); 
```

属性的工作方式（顶点、法线、颜色、纹理等），单个索引从每个属性中选择一个值。如果您在上面的三角形中添加颜色属性，您仍将只使用 3 个索引。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-04T09:01:41.723

I think the problem is that each triangle in your model, has its own three vertices. You're not using indexed triangles (GL_ELEMENT_ARRAY_BUFFER, glDrawElements) so that it's possible for vertex data to be shared between triangles.

From what I can tell, there are two issues with your current approach.

1.  The sheer amount of data that needs to be processed (although this can be a problem with indexed triangles as well).

2.  When using glDrawArrays() as opposed to glDrawElements, the GPU cannot make use of the post-transform cache, which is used to reduce the amount of vertex processing.

If possible, re-arrange your data to use indexed triangles.

I'll just add the caveat that if you use indexed triangles, you have to make sure that you're sharing vertex data between triangles as much as possible to get the best performance. It's really about how well you organise your data.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-04T09:30:25.687

**编辑**：阅读一些评论；下面的回复。

* * *

一些随机的事情要尝试。

```
glBufferData(GL_ARRAY_BUFFER, SizeInBytes, NULL, GL_DYNAMIC_DRAW); 
```

试试`GL_STATIC_DRAW`。在稳定状态下它可能无济于事（因为驱动程序应该注意到不需要重新上传，因为没有修改顶点缓冲区数据），但值得一试。

```
glDisableClientState(GL_VERTEX_ARRAY);
glDisableClientState(GL_NORMAL_ARRAY);

//Unbind the buffers
glBindBuffer(GL_ARRAY_BUFFER, 0); 
```

如果不需要，不要在每次绘制后更改顶点缓冲区状态。它只是一个缓冲区，让它绑定。

```
 normal = normalize(gl_NormalMatrix * gl_Normal);
    /* now normalize the light's direction. Note that according to the

    OpenGL specification, the light is stored in eye space. Also since
    we're talking about a directional light, the position field is actually
    direction */
    lightDir = normalize(vec3(gl_LightSource[0].position));
    /* compute the cos of the angle between the normal and lights direction.

    The light is directional so the direction is constant for every vertex.
    Since these two are normalized the cosine is the dot product. We also
    need to clamp the result to the [0,1] range. */
    NdotL = max(dot(normal, lightDir), 0.0); 
```

您实际上可以稍微优化一下并节省一个`normalize()`（因此是半昂贵的`invsqrt`）。请注意，对于向量`v1`和`v2`，以及标量`s1`和`s2`：

```
dot(v1 * s1, v2 * s2) == s1 * s2 * dot(v1, v2); 
```

因此，如果`v1`和`v2`未归一化，您可以将它们的平方大小分解，将它们相乘，然后乘以组合`invsqrt`一次以缩小它们的点积。

* * *

85k 个三角形，大约 50 FPS？使用 GTX660M 我会说你做得很好。我不希望在您正在运行的硬件上获得更高的数字。

至于固定功能流水线——现在所有酷孩子都在使用完全可编程的流水线。但是 FF 不会失去你的性能——在内部，驱动程序将 FF 状态编译成一组着色器，因此无论如何它都作为着色器在 GPU 上执行。

正如@JamesSteele 提到的，如果您可以在顶点数据中保持良好的参考位置，索引三角形是一个好主意。不过，这可能需要重新编译或以其他方式重新调整您的输入数据。

# mysql - 带有条件的 MySQL SELECT 查询

> ID：14676806
> 
> 赞同：1
> 
> 时间：2013-02-03T20:14:36.930
> 
> 标签：mysql, select

我有一张桌子，看起来像：

```
id batch_id start_ts stop_ts 
```

我想选择昨天开始的那些 id（可以通过给出 start_ts > .. AND start_ts < .. 轻松完成）并在表中有另一个 id 与该 id 的 batch_id 相同的 batch_id 并且该 id 昨天结束。

构建这个 MySQL 查询的好方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:19:15.920

关于什么 ...

```
select <field list>  
from table t1
join table t2 on t1.id = t2.batch_id
where start_ts between <date 1> and <date 2> 
```

# r - 提取与新观察相关联的每棵树的终端节点

> ID：14676810
> 
> 赞同：2
> 
> 时间：2013-02-03T20:15:10.447
> 
> 标签：r, regression, linear-regression, random-forest

我想提取随机森林 R 实现的终端节点。据我了解随机森林，您有一系列正交树。当您预测一个新的观测值（回归）时，它会进入所有这些树，然后对每棵树的预测进行平均。如果我不想平均，但可能对这些相应的观察结果进行线性回归，我需要一个与这个新观察结果“相关”的观察结果列表。我已经浏览了源代码，但还没有想出一种方法来获得它。谁能帮我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T02:38:30.493

必须有更好的方法来做到这一点，但这里有一个解决方法：

```
library(randomForest)
set.seed(713)
## data
my.df <- data.frame(x = rnorm(100), y = rnorm(100))
## forest
rf <- randomForest(y ~ x, data = my.df, ntree = 10, keep.inbag = TRUE) 
```

`keep.inbag = TRUE`保存用于拟合此示例中 10 棵树中的每棵树的 inbag 观测值

```
predList <- lapply(seq_len(rf$ntree), function(z) 
            predict(rf, newdata = my.df[rf$inbag[, z] == 1, ], nodes = TRUE)) 
```

`nodes = TRUE`跟踪每个观察结束的终端节点。

```
node.list <- lapply(seq_len(rf$ntree), function(z) 
            split(x = my.df[rf$inbag[, z] == 1, "x"], 
                    f = attr(predList[[z]], "nodes")[, z])) 
```

第一棵树的前三个终端节点：

```
node.list[[1]][1:3]

$`3`
[1] 2.028358 2.071939

$`7`
[1] 0.8306559

$`9`
[1] 1.660134 1.621299 
```

# php - 作为属性和未定义方法的函数

> ID：14676815
> 
> 赞同：2
> 
> 时间：2013-02-03T20:15:44.090
> 
> 标签：php

我正在制作一个游戏，并开始在服务器端实现角色能力。

所以我有一个数组来保存所有角色能力：

```
$abils = array(); 
```

为他们上一堂课：

```
class Abil{
    private $timing;
    private $func;

    public function __construct($time, $func){
        global $abils;
        $this->timing = $time;
        $this->func = $func;
        array_push($abils,$this);
    }

    public function trigger($time,$params){
        if(preg_match('/^'.$this->timing.'$/',$time)) $this->func($params);
    }
} 
```

`$time`是能力的“时机”，如 RegEx。例如，`\d\d-0`将是轮到任何人的开始。
`$func`是使用该能力时运行的功能。

当达到某个“时间”时（例如，某人的回合开始），`triggerAll()`将使用一个全局函数来触发该时间的所有能力：

```
function triggerAll($time,$params = NULL){
    global $abils;
    foreach($abils as $abil) $abil->trigger($time,$params);
} 
```

但是，当`triggerAll`被调用时，会产生一个致命错误：
`Fatal error: Call to undefined method Abil::func()`

我怀疑这是因为它`$func`不是一个 METHOD 而是一个拥有函数的 PROPERTY。任何解决方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:15:44.090

找到了解决方法：[`call_user_func`](http://www.php.net/manual/en/function.call-user-func.php)

```
call_user_func($this->func,$params); 
```

代替

```
$this->func($params); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:21:08.813

我怀疑这会起作用：

```
$f = $this->func;
$f($params); 
```

也许（虽然可能只在 5.5 中）

```
($this->func)($params); 
```

# vim - cygwin下的vim：无法将vim缓冲区通过管道传输到外部程序

> ID：14676820
> 
> 赞同：1
> 
> 时间：2013-02-03T20:16:04.960
> 
> 标签：vim, cygwin

我在 Windows 7 机器上安装了 cygwin。在那种环境下，我大量使用 vim 进行代码开发。在该过程中，我使用了几个类似过滤器的小型程序，将 vim 缓冲区内容传递给它们，并以通常的 vim 方式捕获它们的输出。我在 UNIX 系统上使用 vim 时编写了这些，它们在那里工作得很好。当我尝试在 cygwin 下使用它们时，它们几乎总是失败，出现以下错误：

```
      1 [main] gvim 25276 异常：：句柄：异常：STATUS_ACCESS_VIOLATION
   6630 [main] gvim 25276 open_stackdumpfile：将堆栈跟踪转储到 gvim.exe.stackdump
      1 [main] gvim 44480 异常：：句柄：异常：STATUS_ACCESS_VIOLATION
    353 [main] gvim 44480 open_stackdumpfile：将堆栈跟踪转储到 gvim.exe.stackdump
      1 [main] gvim 30724 异常：：句柄：异常：STATUS_ACCESS_VIOLATION
    411 [main] gvim 30724 open_stackdumpfile：将堆栈跟踪转储到 gvim.exe.stackdump
      1 [main] gvim 468 异常：：句柄：异常：STATUS_ACCESS_VIOLATION
    397 [main] gvim 468 open_stackdumpfile：将堆栈跟踪转储到 gvim.exe.stackdump
      1 [main] gvim 28116 异常：：句柄：异常：STATUS_ACCESS_VIOLATION
    401 [main] gvim 28116 open_stackdumpfile：将堆栈跟踪转储到 gvim.exe.stackdump
      1 [main] gvim 35968 异常：：句柄：异常：STATUS_ACCESS_VIOLATION
    345 [main] gvim 35968 open_stackdumpfile：将堆栈跟踪转储到 gvim.exe.stackdump
    258 [main] vim 39032 fork: child -1 - 在初始化前等待 longjmp 死亡，重试 0，退出代码 0x600，errno 11

 不能分叉

```

谁能告诉我这里发生了什么，以及如何解决它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T02:55:54.757

您是否尝试[过重新设置](http://cygwin.wikia.com/wiki/Rebaseall)cygwin？与分叉相关的一些错误通常会随着此过程而消失。

# facebook - 如何在服务器端的移动应用程序中验证 FBLogin

> ID：14676821
> 
> 赞同：1
> 
> 时间：2013-02-03T20:16:12.370
> 
> 标签：facebook, facebook-graph-api, cordova

我正在开发一个基于 Phonegap 的应用程序，它使用 Facebook OAuth 进行 SSO 登录。如何在服务器端验证 FB.login javascript 响应？从 Facebook 手机成功重定向回我的应用程序后，我得到了 userId 和 accessToken。检查 accessToken 以获得服务器上用户的访问权限就足够了吗？

```
https://graph.facebook.com/me?fields=id&access_token=... 
```

我的问题是移动和网络上的 JS 和 PHP 混合：用户在移动（Javascript）上使用 FB.login 并成功返回（客户端），因为用户已经通过网络连接。现在我可以检查数据库中的 FB id 以通过 AJAX 请求加载用户凭据。如何使 AJAX 请求安全。原型将登录通过有效 FB 的每个人，该 FB 也存在于我的数据库中。因此，系统可以打开以获取会话，而无需在 FB（服务器）上重新验证。我的想法是检查accessToken是否有效，但不确定这是否足够......我认为不是......也许也检查IP？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:02:16.047

使用 SignedRequest 而不是 accessToken 接缝是我需要的正确选择，例如 PHP 解决方案，使用应用程序机密。

```
private function check_signed_request($signed_request) {

    $secret = Semods_Utils::getSetting('socialdna.facebook_secret','');
    list($encoded_sig, $payload) = explode('.', $signed_request, 2);

    // decode the data
    $sig = $this->base64_url_decode($encoded_sig);
    $data = json_decode($this->base64_url_decode($payload), true);

    if (strtoupper($data['algorithm']) !== 'HMAC-SHA256') {
        throw new Exception('Unknown algorithm. Expected HMAC-SHA256');
    }

    // Adding the verification of the signed_request below
    $expected_sig = hash_hmac('sha256', $payload, $secret, $raw = true);
    if ($sig !== $expected_sig) {
        throw new Exception('Bad Signed JSON signature!');            
    }

    return true;
}

private function base64_url_decode($input) {
    return base64_decode(strtr($input, '-_', '+/'));
} 
```

见：[https ://developers.facebook.com/docs/howtos/login/signed-request/](https://developers.facebook.com/docs/howtos/login/signed-request/)

**问题** 我没有收到签名请求，这些是未定义的：

```
response.authResponse.signed_request
response.authResponse.signedRequest 
```

而这个只包含“...”

```
response.authResponse.sig 
```

任何人的想法？

**编辑** 好的 .sig 接缝仅由我的插件提供，硬编码：所以修复应该在那里[https://github.com/davejohnson/phonegap-plugin-facebook-connect](https://github.com/davejohnson/phonegap-plugin-facebook-connect)

但报道： [https ://github.com/davejohnson/phonegap-plugin-facebook-connect/issues/245](https://github.com/davejohnson/phonegap-plugin-facebook-connect/issues/245)

# spring - 未使用 TideFXMLLoader 设置花岗岩基础位置

> ID：14676831
> 
> 赞同：1
> 
> 时间：2013-02-03T20:17:30.063
> 
> 标签：spring, fxml, graniteds

我有一个使用 graniteds+javafx+spring 的小型测试项目。我遵循了本教程[GraniteDs+JavaFx](http://java.dzone.com/articles/data-management-javafx-and)。

一切正常，但如果我使用一个 fxml 文件，其中我有一些具有相对 url 的图像，如本例所示：

```
<children>
    <ImageView fitHeight="32.0" fitWidth="32.0" layoutX="14.0" layoutY="14.0" onMouseClicked="#menuHome" pickOnBounds="true" preserveRatio="true">
      <image>
        <Image url="@../images/icons/home.png" />
      </image>
    </ImageView> 
```

我有这个例外：

```
 SEVERE: Could not show view
 javafx.fxml.LoadException: Base location is undefined.
     at javafx.fxml.FXMLLoader$Element.processPropertyAttribute(FXMLLoader.java:283)
     at javafx.fxml.FXMLLoader$Element.processInstancePropertyAttributes(FXMLLoader.java:197)
     at javafx.fxml.FXMLLoader$ValueElement.processStartElement(FXMLLoader.java:570)
     at javafx.fxml.FXMLLoader.processStartElement(FXMLLoader.java:2314)
     at javafx.fxml.FXMLLoader.load(FXMLLoader.java:2131)
     at org.granite.client.tide.javafx.TideFXMLLoader.load(TideFXMLLoader.java:49) 
```

加载 FXML 的代码是这样的：

```
private Parent showView(Stage stage, boolean loggedIn) {
try {               
    Parent root = (Parent) TideFXMLLoader.load(contextManager.getContext(),
         loggedIn ? "Home.fxml" : "LoginUi.fxml", loggedIn ? Home.class
        : LoginUi.class);

            Scene scene = new Scene(root);              
            stage.setScene(scene);
            stage.show();

            return root;
        } catch (Exception e) {
            log.error(e, "Could not show view");
        }
        return null;
    } 
```

有没有办法用 TideFXMLLoader 设置基准位置？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-10T20:48:36.457

我知道这个问题有点老了，你可能已经以某种方式解决了。但我解决了它在加载 fxml 之前放置以下代码：

loader.setLocation(Class.class.getResource(url));

希望能帮助到你

# c# - 在 EntityFramework 中保存多对多

> ID：14676832
> 
> 赞同：2
> 
> 时间：2013-02-03T20:17:46.703
> 
> 标签：c#, asp.net-mvc, entity-framework, asp.net-mvc-4, entity-framework-5

我想在编辑时的列表框中显示教师和教师的所有分配课程（多对多关系：课程、教师和 CourseTeacher）。（我想突出显示已经选择的课程，如果用户更改选择，它将反映在数据库中）。

我的问题是它适用于 Get 方法，但是当我发布更新教师和相关课程时，它不会自动执行（更新教师信息，但不是选定的课程），尽管它在对象中分配了所有课程。

我是 MVC 的新手，所以我什至不确定我的模型是否正确。但我想问题出在 post 方法中。（最后一段代码，请参阅我的评论）。

要清楚。我已经有可用的课程列表。我只想把他们和几位老师联系起来。

到目前为止我所做的：ViewModel

```
public class TeacherEditor
    {
        public Teacher Teacher { get; set; }
        public int[] SelectedCourseIds { get; set; }
        public MultiSelectList Courses { get; set; }
    } 
```

教师模型：

```
 public class Teacher
    {
        public int TeacherID { get; set; }

        public string FirstName { get; set; }
        public string LastName { get; set; }

        public ICollection<Course> Courses { get; set; }

            public Teacher()
          {
              Courses = new HashSet<Course>();
          }
    } 
```

看法：

```
 <div class="editor-field">
                     @Html.ListBoxFor(model=>model.SelectedCourseIds, Model.Courses)
        </div> 
```

控制器获取：

```
 public ActionResult Edit(int id = 0)
        {
            var teacher = db.Teachers.Include(x=>x.Courses).Where(x=>x.TeacherID==id).SingleOrDefault();
            if (teacher==null)
            {
                return HttpNotFound();
            }
            var selectedCourses = teacher.Courses.Select(x=>x.CourseID);
            var model = new TeacherEditor
            {
                Teacher = teacher,
                Courses = new MultiSelectList(db.Courses, "CourseID", "Name", selectedCourses),
                SelectedCourseIds = selectedCourses.ToArray()
            };
            if (model == null)
            {
                return HttpNotFound();
            }
            return View(model);
        } 
```

控制器 POST：

```
 [HttpPost]
        public ActionResult Edit(TeacherEditor teacherEditor)
        {
            if (ModelState.IsValid)
            {
                    foreach (var id in teacherEditor.SelectedCourseIds)
                    {
                        Course course = db.Courses.Where(x=>x.CourseID==id).SingleOrDefault();
                        teacherEditor.Teacher.Courses.Add(course); //Here I'm adding courses back to Teacher object for save.
                    }
                db.Entry(teacherEditor.Teacher).State = EntityState.Modified; /?This doesn't save records to my relationship table. Why?
                db.SaveChanges();
                return RedirectToAction("Index");
            }
            return View(teacherEditor);
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T21:51:29.653

您的问题是您无法在 POST 上绑定到 MVC（ICollection）中的接口。DefaultModelBinder 不支持绑定到抽象基类和接口。更改`ICollection<Course> Courses`为具体的实现，例如`List<Course> Courses`.

然后，您可以在视图中使用索引符号表示课程，ListBoxFor 应该处理它。

尝试类似：

```
public class Teacher
    {
        public int TeacherID { get; set; }

        public string FirstName { get; set; }
        public string LastName { get; set; }

        public IQueryable<Course> Courses { get; set; }

        public Teacher()
        {
            Courses = new IQueryable<Course>();
        }
    } 

public class TeacherEditor
    {
        public Teacher Teacher { get; set; }
        public int[] SelectedCourseIds { get; set; }
        public List<Course> CourseList 
        {
            get { return Teacher.Courses.ToList(); }
            set { Teacher.Courses = value.ToList(); }
        }
    } 
```

# regular-language - 结合确定性有限自动机

> ID：14676833
> 
> 赞同：8
> 
> 时间：2013-02-03T20:17:58.173
> 
> 标签：regular-language, automata, deterministic

我对这些东西真的很陌生，所以我为这里的noobishness道歉。

构造一个`Deterministic Finite Automaton`识别以下语言的 DFA：

```
L= { w : w has at least two a's and an odd number of b's}. 
```

每个部分的自动化`(at least 2 a's, odd # of b's)`很容易单独制作......谁能解释一种将它们组合成一个系统的方法？谢谢。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2014-12-04T03:40:33.903

您可以使用以下简单步骤来构建组合 DFA。

令**Σ = {a [1] , a [2] , ...,a [k] }**。
**第一步：**为两种语言设计 DFA 并将它们的状态命名为 Q [0] , Q [1] , ...

**第二步：**唯一地重命名两个 DFA 中的每个状态，即将 DFA 中的所有状态重命名为 Q [0]， Q [1]， Q [2]， Q [3]，...假设您从下标 0 开始；这意味着没有一个州有相同的名字。

**第三步：**使用以下步骤构建转移表（δ）

   **3a。**组合 DFA 的
      起始状态：取两个 DFA（DFA1 和 DFA2）的起始状态，命名为 Q [[ i , j ]]其中 i 和 j 分别是 DFA1 和 DFA2 的起始状态的下标；即Q [i]是第一个DFA 的开始状态，Q [j]是第二个DFA 的开始状态，并将Q [[i , j]]标记为组合DFA 的开始状态。

   **3b。**将两个 DFA 的状态映射为
           δ(Q [i] , [ak] ) = Q [p1]和 δ(Q [j] , [ak] ) = Q [p2]，其中 Q [p1]属于 DFA1，Q [p2]属于 DFA2，则 δ(Q [[ i , j ]] , a [k] ) = Q [[p1,p2]]

   **3c**。在转换表中剩余任何 Q [[i,j]时填充整个表。]

   **3d**。组合 DFA 的最终状态：
      对于`AND`这种情况，最终状态将是所有 Q [[i , j]]，其中 Q [i]和 Q [j] 分别是 DFA1 和 DFA2 的最终状态。
      对于`OR`这种情况，最终状态将是所有 Q [[i , j]]，其中 Q [i]或 Q [j]是 DFA1 和 DFA2 的最终状态。

**第 4 步：** 重命名所有 Q [[i, j]]（唯一）并绘制 DFA，这将是您的结果。

例子：

```
L= {w: w has at least two a's and an odd number of b's}. 
```

**Step1：**
奇数个b的DFA。
![](../Images/9d35dc0a428415db697114e1a533e535.png)
DFA 至少 2 个。
![](../Images/90f12caa61d34a1dc3958ef368e134ee.png)

**Step2：**
重命名 DFA1 的状态
![在此处输入图像描述](../Images/61e02ac9dcb0a43b0af4affaa60b9c3b.png)

**Step3(a,b,c)：**
构造的转换表如下。
![桌子](../Images/96be4d98476023a33ee3f2707c4e3d0a.png)

**Step3d：**
**由于我们必须对两个 DFA 进行 AND，所以最终状态将是 Q [[2,4]] ，因为它包含两个 DFA 的最终状态。**
**如果我们必须对两个 DFA 进行 OR 运算，最终状态将是 Q [[0,4]] ,Q [[2,3]] ,Q [[1,4]] ,Q [[2,4]]。**
添加最终状态后的转换表会像这样。

![决赛桌](../Images/0072eb33d1718db0181ba7166916e024.png)

**Step4：**
重命名所有状态 Q [[i,j]]
Q [[0,3]] to Q [0]
Q [[1,3]] to Q [2]
Q [[0,4]] to Q [1]
Q [[2,3]] to Q [4]
Q [[1 ,4]]到 Q [3]
Q [[2,4]]到 Q [5]
所以最终的 DFA 将如下所示。 ![桌子](../Images/5fe62b5b9658bb285de9e3a047f0020c.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T21:11:01.850

它是使用两个自动机的[乘积完成的。](http://planetmath.org/productofautomata)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-05T11:02:11.737

至少两个且为奇数的语言`L`是常规语言。其DFA如下：`a``b`
![a_and_odd_b](../Images/1743601009a35ad00c685fe42300b3b0.png)

在这个 DFA 中，我在`DFS`概念上结合了两个 s！

```
DFA-1 = for odd number of `b`'s (placed vertically three times in diagram)
DFA-2 = for >=  two a           (placed Horizontally two times in diagram) 
```

[DFA 过于症状和简单，所以我相信无需赘述如何结合两个 DFA]

要绘制此 DFA，您始终跟踪`b`有多少 s 是偶数或奇数。`States 0, 2 and 4`表示偶数`b`已经来了。因此，您可以将此 DFA 垂直分为两部分，其中底部状态为偶数`b`，上部状态为奇数。

如果奇数也接受字符串，`b`因此最终状态应处于上部状态之一。

s 的数量不仅`b`是条件，而且`a`应该是至少`2`。因此，您可以将此 DFA 水平划分为三个部分，其中`a`s 的数量为 0 `state-0 and 1`，`a`s 为 1，`state-2 and 3`s`a`为 2 `state-4 and 5`。在前两个`a`s 之后，字符串中允许有任意数量的s，因此状态和`a`存在自循环。`q4``q5`

[所需的状态数为 6，因为奇偶数为 2 个状态，`b`并且应该至少`2`有 3 个状态 a=0、a=1、a=2，因此 2*3 = 6]

# php - 压缩的 CSS/JS/HTML

> ID：14676842
> 
> 赞同：1
> 
> 时间：2013-02-03T20:19:11.700
> 
> 标签：php, javascript, html, css, gzip

我最近听说过这件事，我有几个问题：

1.  有没有浏览器支持这个？
2.  如果浏览器不支持它会发生什么，它们会被卸载吗？
3.  我可以在使用 Apache 和 PHP5 的共享主机上使用此功能吗？
4.  如何使用此功能？

PS如果重要的话，它与Wordpress有关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:22:51.920

1.  浏览器发送一个`Accept-Encoding`请求标头，这将使服务器清楚地知道是否支持压缩。好消息是*几乎所有流行的浏览器都支持它*

2.  服务器根据浏览器是否支持 gzip（即`Accept-Encoding`请求标头是否包含`gzip`在其中）来响应请求。如果支持，服务器会使用 gzip 压缩的内容进行响应 - 由`Content-Encoding`响应标头指示。

3.  检查[**如何**](http://httpd.apache.org/docs/2.2/mod/mod_deflate.html)在 Apache HTTPD 上配置输出压缩 - 请注意，您需要能够编辑配置文件，因为您在共享托管服务器上，所以您可能无法编辑。

4.  您只需在 Apache 上配置 mod_deflate 即可开始使用此功能。它将负责检查`Accept-Encoding`请求标头并做出相应的响应。*确保不要使用 force-gzip 强制压缩*- 您可以在上面的链接中找到有关此的详细信息。

# qt5 - qt 5 源代码构建 nmake 失败

> ID：14676845
> 
> 赞同：1
> 
> 时间：2013-02-03T20:19:19.260
> 
> 标签：qt5

我正在尝试使用 namke 从 Windows 7 64 位上的源文件构建 qt 5。配置完成，但 nmake 有时会在文件 gdom.h 中显示无效参数。我安装了最新版本的 Visual C++ 2010、Perl 和 Python。我是否还需要 Windows SDK？这会有所作为吗？源文件似乎有问题。有人见过这个吗？我在虚拟机中有 Windows 7 32 位。也许我会在那里尝试。感谢任何人的意见。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:37:40.500

Angle 也需要 directx sdk，而构建 Qt 需要 windows sdk，请阅读[此处](http://qt-project.org/doc/qt-5.0/qtdoc/requirements-win.html)了解更多详细信息，看看您是否也需要 directx sdk。

无论如何，已经有 Visual Studio 2010 二进制文件可供[下载](http://qt-project.org/downloads)，您是否检查过它们是否对您来说不够用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-05T09:05:47.453

在我的 Windows 8 系统上编译 Qt5 而不安装 Windows SDK 失败。以下是我成功编译 Qt 5.0.1 的方法：

1.  安装草莓 perl ( [http://strawberryperl.com/](http://strawberryperl.com/) )
2.  安装 Windows SDK [http://msdn.microsoft.com/en-us/windows/desktop/aa904949](http://msdn.microsoft.com/en-us/windows/desktop/aa904949)即使您使用的是 Windows 7。在旧版本的 Microsoft Windows 上应该安装 DirectX SDK。
3.  [从http://qt-project.org/downloads](http://qt-project.org/downloads)下载 Qt 5.0.0 源代码
4.  启动“VS2012 x64 Native Tools 命令提示符”</li>
5.  确保 python 在命令提示符下可用。安装 Python 时，您可以将 python.exe 添加到环境路径。（我使用python 3.3）
6.  切换到 Qt 5.0.0 源目录（包含 configure.exe 的目录）
7.  跑`configure -developer-build -opensource -nomake examples -nomake tests`
8.  之后`namke`

# ember.js - Ember 数据 - hasMany/belongsTo 与默认模型不同

> ID：14676848
> 
> 赞同：3
> 
> 时间：2013-02-03T20:19:29.393
> 
> 标签：ember.js, associations, ember-data, belongs-to

在 Ember Data 中，如何定义使用与默认选择不同的模型或外键的 belongsTo/hasMany 关联？

例如，我有一个`App.Item`属于模型的`App.User`模型，但我想通过`owner`属性访问用户：

```
App.Item = DS.Model.extend({
  owner: DS.belongsTo('App.User'),
});

item.get('owner'); // should be an App.User

// And the data from the server looks like:
{
  owner: 2, //id
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:35:58.830

您可以在适配器上指定自定义主键。这些需要在商店创建之前设置。

```
App.Adapter.map('App.User', {
  primaryKey: 'owner'
}); 
```

# extendscript - After Effects / ExtendScript：使用库和导入 .jsx 文件？

> ID：14676861
> 
> 赞同：12
> 
> 时间：2013-02-03T20:20:53.377
> 
> 标签：extendscript, after-effects, jsx

*我是 After Effects 脚本的新手，但对浏览器中的 JavaScript 有很多经验。*

1.  如何导入 .jsx 文件？
2.  我可以使用诸如 underscore.js 之类的 js 库吗？
3.  什么是 AE 脚本的好资源？（理想的信息图表项目）

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-04T15:07:34.443

1.  在脚本旁边包含 .jsx

采用：

```
#include "includeme.jsx" 
```

**编辑2：**

您还可以使用以下语法包含文件：

```
//@include "includeme.jsx" 
```

哪个（恕我直言）是更好的方法。它不会破坏 linter 并且更加 javascript-ish。

2.  您可以使用普通的旧 javascript（ES3 语法）。如果您包含的库使用某些特定于浏览器的 js（如`console.log()`），您将收到错误消息

3.  最好的资源是[AECS6 脚本指南](http://blogs.adobe.com/aftereffects/files/2012/06/After-Effects-CS6-Scripting-Guide.pdf?file=2012/06/After-Effects-CS6-Scripting-Guide.pdf)。[http://aescripts.com](http://aescripts.com)上也有很多开源脚本可供您查看

**编辑1：** 您还可以包含这样的文件。

```
var path = ((File($.fileName)).path); // this is the path of the script
// now build a path to another js file
// e.g. json lib https://github.com/douglascrockford/JSON-js
var libfile = File(path +'/_libs/json2.js');
if(libfile.exists){
  $.evalFile(libfile);
} 
```

# android - onCallStateChanged 不改变状态

> ID：14676862
> 
> 赞同：0
> 
> 时间：2013-02-03T20:20:59.717
> 
> 标签：android, phone-state-listener

我的问题`onCallStateChanged()` 不是听众或程序本身。

除了一件事，一切都很好。当我处于`while()-Loop`.

我想要做的是让 LED 在电话响铃时闪烁。

所以我跳进：

```
if (TelephonyManager.CALL_STATE_RINGING == state){
// Incoming call handling

        Log.d(incomingNumber, "Ring");
        ring = true;
        idle = false;

        if (mCamera == null) {
            mCamera = Camera.open();

            Parameters pLightOn = mCamera.getParameters();
            Parameters pLightOff = mCamera.getParameters();

            pLightOn.setFlashMode(Parameters.FLASH_MODE_TORCH);
            pLightOff.setFlashMode(Parameters.FLASH_MODE_OFF);

            mCamera.setParameters(pLightOn);
            mCamera.startPreview();
            try {
                Thread.sleep(30);
            } catch (InterruptedException e1) {
                // TODO Auto-generated catch block
                e1.printStackTrace();
            }

            //##########################################
            while(ring && !idle){

                try {
                    mCamera.setParameters(pLightOff);
                    Thread.sleep(1000);

                    mCamera.setParameters(pLightOn);
                    Thread.sleep(30);

                } catch (InterruptedException e) {
                    // TODO Auto-generated catch block
                    idle = true;
                    pLightOff.setFlashMode(Parameters.FLASH_MODE_OFF);
                    e.printStackTrace();
                }
                catch(RuntimeException ex){
                    idle = true;
                    pLightOff.setFlashMode(Parameters.FLASH_MODE_OFF);
                    String errorMessage = "Error setting camera flash status. Your device may be unsupported.";
                }
            }

            idle = true;
            ring = false;
            pLightOff.setFlashMode(Parameters.FLASH_MODE_OFF);
            mCamera.stopPreview();
            mCamera.release();
            //##########################################                
        }
    } 
```

**但问题是，当我结束通话时，它不会跳出`WHILE`. `STATE`没有改变，它保持在`RING`. 所以我有无尽的眨眼。它永远不会回到`IDLE`.**

**当我删除`while-loop`一切工作正常。** 它跳进去。 Switch `LED ON`... 然后`OFF`... 当我结束调用它时返回到`IDLE`. 就一次……但只要电话处于`RING`状态，我希望他这样做。

有什么想法可以解决这个问题..？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-31T05:49:37.060

It seems the thread problem. Do not program while-loop in android main thread. Just create a thread for while-loop to avoid block main thread block.

# radio - dbm 中的传输功率值是多少（从最小值到最大值）-CC2420 RADIO

> ID：14676863
> 
> 赞同：1
> 
> 时间：2013-02-03T20:21:05.673
> 
> 标签：radio, wireless, sensors, tinyos

在模块实现中，将数据包的传输功率设置为 0 到 31（最小到最大）。

实际上传输功率值是多少？以dbm为单位的传输功率范围？？？

```
31----  0 dbm
29 --- ??
28--- ??
7-----  -15dbm
0----  ??

Is 0dbm  the maximum transmission power value?? 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-05T09:21:09.250

CC2420 数据表给出了这些值：

```
PA_LEVEL  Output power[dBm]  
   31            0
   27           -1
   23           -3
   19           -5
   15           -7
   11          -10
    7          -15
    3          -25 
```

数据表可从[http://www.ti.com/product/cc2420下载](http://www.ti.com/product/cc2420)

0 dBm 是最大传输功率。

# codeigniter - 将数据从控制器传递到模型 Codeigniter

> ID：14676864
> 
> 赞同：0
> 
> 时间：2013-02-03T20:21:07.873
> 
> 标签：codeigniter, file-upload, models

**控制器**

```
 <?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

    class Upload extends CI_Controller {

            function __construct(){
                parent::__construct();
                $this->load->helper(array('form', 'url'));
            }

            function index()
            {
                $this->load->view('uploaderview', array('error' => ' ' ));
            }

            function do_upload(){
                $config['upload_path'] = './upl0d/';
                $config['allowed_types'] = 'gif|jpg|png';
                $config['max_size'] = '2048'; //2mb
                $config['max_width']  = '1024';
                $config['max_height']  = '768';
                $config['encrypt_name'] = FALSE;
                $config['overwrite'] = FALSE;

                $this->load->library('upload', $config);

                if ( ! $this->upload->do_upload()){
                    $error = array('error' => $this->upload->display_errors());
                    $this->load->view('uploaderview', $error);
                }
                else{
                    ## Insert into filesystem.
                    $data = array('upload_data' => $this->upload->data());
                    ## load the success page.
                    $this->load->view('uploadsuccess', $data);
                    ## Insert into db
                    ## then insert the img name into the database
                    $this->load->model('uploadermodel');
                    $this->uploadermodel->uploadcoupon();               
                }
            }
    }
    ?> 
```

**模型**

```
 <?php

    class Uploadermodel extends CI_Model{

        function __construct(){
            // Call the Model constructor
            parent::__construct();
        }

        function uploadcoupon($data){
            $uploadFileName = $this->upload->data();
            $currentDt = date('Y-m-d H:i:s');
            $data = array('fileNameUploaded'=>$uploadFileName,'date'=>$currentDt);
            $this->db->insert('Coupon', $data); 
        }

    }   
    ?> 
```

我正在尝试收集价值`$config['file_name']`并将其与我的模型一起发送。我该怎么做？目前它正在尝试上传：`VALUES (Array, '2013-02-03 20:20:01')`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T23:06:13.183

您现在有一个带有键“upload_data”的数组 $data（您实际上不需要这样做 - 我希望他们会修复文档，但不要这样做）

所以，做一个 var_dump($data['upload_data']) 你会看到你刚刚上传的文件的所有信息。

从内存中，会有类似 $data['upload_data']['file_name']...

因此，只需将该值加上您的完整插入数据传递给您的模型。

```
$this->uploadermodel->uploadcoupon(); 
```

需要通过 $data...

```
$this->uploadermodel->uploadcoupon($data); 
```

不要像你正在做的那样尝试从 $this->upload 中获取它

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T02:51:32.277

为此，您需要这个

```
$image_data = $this->upload->data();
$data['image_name'] = $image_data['file_name'];

//Now you can insert file name
$this->uploadermodel->uploadcoupon($data); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-04T07:24:52.337

从文档：

> **$this->upload->data()**是一个帮助函数，它返回一个数组，其中包含与您上传的文件相关的所有数据。这是数组原型。

因此，您需要指定要存储在数据库中的数组索引。更多信息请点击这里：

[http://ellislab.com/codeigniter/user-guide/libraries/file_uploading.html](http://ellislab.com/codeigniter/user-guide/libraries/file_uploading.html)

# ruby-on-rails - 在关联或 XYZ 方法中使用默认值

> ID：14676872
> 
> 赞同：0
> 
> 时间：2013-02-03T20:22:04.360
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

在我的代码中，Author has_many Books，所以我可以这样做：

```
@author.books 
```

如果作者没有书，当`@author.books`被调用时，我想要一个默认的书对象，其中已经填写了该作者的信息（即 author_id），例如：

```
class Author < ActiveRecord::Base
  has_many :books

  def books
    the_books || default_book
  end
end 
```

这显然不是真正的代码，但它展示了我正在尝试做的事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T22:15:44.900

怎么样：

```
class Author < ActiveRecord::Base
  has_many :books
  alias :__books__ :books

  def books
    result = __books__
    result.empty? ? default_books : result
  end

  private
  def default_books
    # ...
  end
end 
```

# c# - 如何防止我的 NUnit 测试有时并行运行

> ID：14676873
> 
> 赞同：2
> 
> 时间：2013-02-03T20:22:08.877
> 
> 标签：c#, unit-testing, concurrency, locking, nunit

我正在使用 Monodevelop 中包含的 NUnit 测试运行程序。我有 2 个测试必须与静态资源交互，所以我需要它们串行运行而不是并行运行。我试过使用类似的东西

```
static string Locker="foo";
[Test]
public void Test1()
{
  lock(Locker)
  {
    //....
  }
}
[Test]
public void Test2()
{
  lock(Locker)
  {
    //....
  }
} 
```

这似乎不起作用。还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-10-01T09:02:43.523

我在**真正**需要时使用这种方法（我认为这是一个坏主意）：

```
using System.Threading;
private ManualResetEvent FixtureHandle = new ManualResetEvent(true);
[SetUp]
public void SetUp()
{
    FixtureHandle.WaitOne();
}
[TearDown]
public void TearDown()
{
    FixtureHandle.Set();
}
[Test]
public void Test1()
{
  //only test
}
[Test]
public void Test2()
{
  //only test
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:27:36.203

不知道 Monodevelop 但 nunit 控制台有[命令行参数](http://www.nunit.org/index.php?p=consoleCommandLine&r=2.4) **/nothread**

我认为在 Monodevelop 中应该是类似的东西

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-25T01:37:27.357

对于连续运行测试，最好使用 Order 属性：

```
static string Locker="foo";
[Test, Order(1)]
public void Test1()
{
  lock(Locker)
  {
    //....
  }
}
[Test, Order(2)]
public void Test2()
{
  lock(Locker)
  {
    //....
  }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-03T21:19:58.187

不要直接使用静态资源，而是将其提取到依赖项中，然后模拟它（使用[moq](http://code.google.com/p/moq/)或类似的东西）。

这将让您编写实际的单元测试来隔离您尝试测试的特定代码，而不必担心外部上下文。

* * *

## 回答 #5

> 赞同：-3
> 
> 时间：2013-02-03T21:09:06.547

您错过了单元测试的重点。单元测试必须在各个方面都是独立的。

这意味着执行顺序不得影响单元测试结果。

# ruby-on-rails - Mysql2（rails 3）的未定义方法“next_result”

> ID：14676875
> 
> 赞同：8
> 
> 时间：2013-02-03T20:22:20.707
> 
> 标签：ruby-on-rails, ruby-on-rails-3, sphinx, thinking-sphinx

我以前用的是软件的第二个版本，没有问题。在我上一个应用程序中，我决定使用最新的“thinking-sphinx”。我有一个奇怪的错误。

```
> NoMethodError in Adverts#index undefined method `next_result' for
> #<Mysql2::Client:0xac86a54> 
```

我的宝石文件

```
 gem 'rails', '3.2.11'
    gem 'pg', '0.14.0'  # My database

# for sphinx
                gem "mysql2", "~> 0.3.11"
                gem "thinking-sphinx", "~> 3.0.0" 
```

索引：

```
ThinkingSphinx::Index.define :car, :with => :active_record do
   has user_id, model_id, city_id, area_id, engine_id, mileage
  end 
```

think_sphinx.yml

```
 development:
      port: 9312
    test:
      port: 9313
    production:
      port: 9312 
```

控制器：

```
class AdvertsController < ApplicationController
  def index
    @cars = Car.by_model_id(@model_id)
  end
end 
```

模型：

```
class Car < ActiveRecord::Base
    include ThinkingSphinx::Scopes

    sphinx_scope(:by_model_id) { |id|
      {:with => {:model_id => id}}
    }
end 
```

我的观点

> %ul= 渲染 :partial => "item", :collection => @cars, :as => :item

物品

> %li=item.id

怎么了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-12T13:15:43.830

在我再次仔细阅读 READ ME 文档（[https://github.com/pat/thinking-sphinx](https://github.com/pat/thinking-sphinx)）之前花了 2 个多小时后，我快要发疯了，发现是 mysql gem 版本导致.

升级到 'mysql2', '0.3.12b4' 解决了这个问题....

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-02T06:49:33.170

`gem 'mysql2', '~> 0.3.12b5'`修复了这个问题。

[https://github.com/pat/thinking-sphinx/issues/446](https://github.com/pat/thinking-sphinx/issues/446)

也适用于 0.3.12b4 确认。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T20:36:22.057

看起来您没有通过查询获得结果集。你有没有检查过你是否得到了你认为应该得到的结果。控制台是一个有价值的工具。在控制台中测试您的查询以确保。如果结果为空，您是否也可以考虑签入您的代码？在尝试使用它之前，您不会在生产中遇到这种情况。

# windows-7 - 带和不带 -list 的 Get-WmiObject：不同的对象？

> ID：14676878
> 
> 赞同：1
> 
> 时间：2013-02-03T20:22:36.513
> 
> 标签：windows-7, powershell-2.0

我正在使用 PowerShell 2.0 并尝试从 Win32_ShadowCopy 获取可能的方法。

现在，当我使用时，`Get-WmiObject -list Win32_ShadowCopy | Get-Member`我得到：

```
 TypeName: System.Management.ManagementClass#ROOT\cimv2\Win32_ShadowCopy

Name                MemberType    Definition
----                ----------    ----------
Name                AliasProperty Name = __Class
Create              Method        System.Management.ManagementBaseObject Cre...
... 
```

但如果我使用`Get-WmiObject Win32_ShadowCopy | Get-Member`我得到：

```
 TypeName: System.Management.ManagementObject#root\cimv2\Win32_ShadowCopy

Name                MemberType   Definition
----                ----------   ----------
Revert              Method       System.Management.ManagementBaseObject Reve...
Caption             Property     System.String Caption {get;set;}
... 
```

现在我不明白。为什么我会得到 2 个看似不同的课程？我希望这两个命令的结果相同。我可以找到`-list`文档中的内容，但找不到没有`-list`开关的默认行为。有人愿意澄清吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T02:11:14.680

这是来自关于列表的获取帮助。

-List [] 指定是否检索和显示在 Namespace 参数中指定的 WMI 存储库命名空间中的 WMI 类的名称。此 cmdl 不使用 HKEY_LOCAL_MACHINE\ SOFTWARE\Microsoft\WBEM\Scripting 注册表项中的默认命名空间注册表项来确定默认命名空间。如果您指定 List 参数而不是 Namespace 参数，则默认使用 root\CIMV2 命名空间。

```
Required?                    false
Position?                    named
Default value
Accept pipeline input?       false
Accept wildcard characters?  false 
```

为您的脚本

```
Get-WmiObject -list Win32_ShadowCopy 
```

等于：

```
Get-WmiObject -list -class Win32_ShadowCopy 
```

这意味着您要列出名称为 Win32_ShadowCopy 的类。

和

```
Get-WmiObject Win32_ShadowCopy 
```

等于：

```
Get-WmiObject -Class Win32_ShadowCopy 
```

它返回指定类的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:41:12.120

Get-WmiObject 默认将返回给定类的*实例*。另一方面，Get-WmiObject -List 将返回类本身。后者主要在使用通配符时有用（例如，列出默认的所有类 - root\cimv2 命名空间，名称为 Disk，您可以这样做`Get-WmiObject -Class *Disk* -List`）。

# c - 条件比较

> ID：14676885
> 
> 赞同：0
> 
> 时间：2013-02-03T20:23:03.950
> 
> 标签：c

我正在编写我的简单 C shell 的退出部分。

```
int main(int argc, char*argv[]){
    while(1){
        char input_line[MAX], *tokens[X_MAX];
        int i,n; //n is the number of tokens inside the *tokens
        .
        .
        .//gets the input from user and stores into tokens
        .
        if(n ==1){
            char *ex = "exit";
            printf("difference: %i\n",strcmp(tokens[0],ex));  //this prints out 10
        }

    }
} 
```

当它们明显不同时，我被困在了这一部分。我想做的是，当用户输入“exit”（存储在 char 数组“tokens”中）时，if 语句将其拾取，然后将其与存储在“ex”中的进行比较。

任何想法？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:24:47.080

很可能您没有修剪从用户那里获得的字符串，它仍然包含换行符`'\n'`. 我跳到这个条件是因为`\n`ASCII 是 10。

* * *

对于修剪，我使用这个：

```
for (p = line + strlen(line) - 1; p >= line && isspace(*p); --p)
        ;

p[1] = 0; 
```

不知道我是从哪里弄来的，或者它是不是我的。不过可能不是我的。

# python - python dict键按多个值排序

> ID：14676890
> 
> 赞同：0
> 
> 时间：2013-02-03T20:24:19.673
> 
> 标签：python, sorting, ranking, rank

很容易对字典进行排序以按值列出，但我需要通过提升与其他值相关的特定值来对键进行排序。

一个例子：

```
x = [('key1', {'s': 'foo', 'w': 30}), ('key2', {'s': 'bar', 'w': 26}),
     ('key3', {'s': 'foo', 'w': 23}), ('key4', {'s': 'bar', 'w': 13})]

result: ['key2', 'key1', 'key3', 'key4'] 
```

这些东西是按'w'排序的，但是对于's'，如果'w'达到某个阈值，我们更喜欢'bar'而不是'foo'。**这是否以某种方式在 python 中实现，是否有任何规则可以做到这一点，或者你知道 python 库来处理它吗？**

它不是关于学习特征，而是关于按我指定的方式排序 - 提升或限制 - 值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:51:39.800

在 Python 2 中，您可以使用以下内容：

```
def compare(item1, item2):
    key1, it1 = item1
    key2, it2 = item2
    if max(it1['w'], it2['w']) > threshold:
        return cmp(it1['s'], it2['s'])
    else:
        return cmp(it1['w'], it2['w']) 
```

和

```
sorted(x, cmp=compare) 
```

`sorted`在 python 3 中更改，如果您使用它，请参阅

[http://code.activestate.com/recipes/576653-convert-a-cmp-function-to-a-key-function/](http://code.activestate.com/recipes/576653-convert-a-cmp-function-to-a-key-function/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:44:49.677

`key`有了这种复杂的排序需求，您应该`cmp`查看`sorted()`. 有关详细信息和示例，请参阅 Python wiki：[http ://wiki.python.org/moin/HowTo/Sorting/#Key_Functions](http://wiki.python.org/moin/HowTo/Sorting/#Key_Functions)

`key`如果可以基于单个元素确定重要性，则使用。如果重要性取决于两个元素之间的关系，则最好使用`cmp`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T21:28:11.277

到目前为止没有任何答案有帮助，但对我来说解决方案是：

每个键在 1.0 的开头都得到一个分数，然后对于每个特征/值，我将它乘以 sth。最后我做了一个正常的订购。

```
key1['score'] is 1.0

# feature 1
if key['s'] == foo:
    score = score * 0.1  
else:
    score = score * 0.6

# feature 2
... and so on

order keys by score, done. 
```

谢谢，对于您的问题、想法和评论。

# mysql - 优化这个 mysql 查询

> ID：14676891
> 
> 赞同：0
> 
> 时间：2013-02-03T20:24:21.950
> 
> 标签：mysql, performance, optimization

我希望以某种方式加快这个查询。可能达到在低流量站点上运行它可以接受的程度。它需要 15 秒以上，这太长了。

目前表中有 13k 行，大约是 1 个月的数据，但是我预计一旦网站投入使用，每月的数据会翻倍。目的是选择上周的前 10 名收益。

有两个表，用户表和跟踪器表，在跟踪器表中，每个用户有多行，每个用户每天至少 8 行。

查询的目的是获取每个用户的最新行，然后从 1 周前插入的行中减去一个值，以获得他们获得的 xp 数量，然后选择前 10 名获得最高收益的人。

表模式（我肯定也可以改进）

用户表

```
id int(11) primary
rsn varchar(12) unique
joined timestamp
disabled bool 
```

跟踪表

```
id int(11) primary
user_id int(11) index /* Associated with the id in the users table */
timestamp timestamp
overall_rank int(11)
overall_level int(4)
overall_exp int(10) 
```

和查询。

```
SELECT  `users`.`rsn` ,  `tracker`.`timestamp` , @uid :=  `tracker`.`user_id` , (
    SELECT  `overall_exp` 
    FROM  `tracker` 
    WHERE  `user_id` = @uid 
    ORDER BY  `timestamp` DESC 
    LIMIT 1
) - (
    SELECT  `overall_exp` 
    FROM  `tracker` 
    WHERE  `timestamp` >= SUBDATE( NOW( ) , INTERVAL 1 WEEK ) 
    AND  `user_id` = @uid 
    ORDER BY  `timestamp` ASC 
    LIMIT 1 ) AS  `gained_exp` 
FROM  `tracker` 
JOIN  `users` ON  `tracker`.`user_id` =  `users`.`id` 
ORDER BY  `gained_exp` DESC 
LIMIT 10 
```

解释输出

```
+----+----------------------+---------+-------+---------------+---------+---------+------------------+-------+----------------------------------------------+
| id | select_type          | table   | type  | possible_keys | key     | key_len | ref              | rows  | Extra                                        |
+----+----------------------+---------+-------+---------------+---------+---------+------------------+-------+----------------------------------------------+
|  1 | PRIMARY              | users   | index | PRIMARY       | rsn     | 14      | NULL             |    71 | Using index; Using temporary; Using filesort |
|  1 | PRIMARY              | tracker | ref   | user_id       | user_id | 4       | surreal.users.id |   103 |                                              |
|  3 | UNCACHEABLE SUBQUERY | tracker | ALL   | NULL          | NULL    | NULL    | NULL             | 11752 | Using where; Using filesort                  |
|  2 | UNCACHEABLE SUBQUERY | tracker | ALL   | NULL          | NULL    | NULL    | NULL             | 11752 | Using where; Using filesort                  |
+----+----------------------+---------+-------+---------------+---------+---------+------------------+-------+----------------------------------------------+ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T21:04:39.627

尝试通过首先找到所有用户的今天和 1 周前的时间戳来避免相关子查询，然后在进行计算之前再次加入两次跟踪器以找到相应的整体_exp 值：

```
SELECT rsn, ts.thisweek, ts.user_id,
       last.overall_exp - previous.overall_exp AS gained_exp
FROM (SELECT user_id, MIN(timestamp) AS lastweek, MAX(timestamp) AS thisweek
      FROM tracker
      WHERE timestamp >= SUBDATE(NOW(), INTERVAL 1 WEEK)
      GROUP BY user_id) AS ts
INNER JOIN tracker previous
ON previous.user_id = ts.user_id AND previous.timestamp = ts.lastweek
INNER JOIN tracker last
ON last.user_id = ts.user_id AND last.timestamp = ts.thisweek
JOIN users ON ts.user_id = users.id
ORDER BY gained_exp DESC
LIMIT 10 
```

# excel - 宏：如何使用 CSV 文件中的数据定位最后一行

> ID：14676910
> 
> 赞同：0
> 
> 时间：2013-02-03T20:25:47.593
> 
> 标签：excel, vba

我正在尝试从多个 Excel 文件中复制一些数据范围并将其粘贴（通过附加）到单个 csv 文件中。因此，要附加数据，我需要找到 csv 文件中的最后一行。在 csv 中定位最后一个行号的方法是否与在 excel 中定位最后一个行号的方式不同，如下所示？Cells(Rows.Count, "a").End(xlUp) 如果是这样，我如何找到 csv 中的最后一行？或者您对如何将来自不同 Excel 文件的数据范围附加到单个 csv 文件有任何建议？

非常感谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T06:25:10.603

这样做的一个好方法是 cells(1048576,1).end(xlup).row。这将为您提供第一列中非空白的最后一行。为此，您必须确保第一列不为空并且包含数据。'1048576' 是 excel 2010 中的最后一行。在 2007 年，它大约是 600000。所以根据您的 excel 版本相应地更改它。

如果要附加数据，请使用此

```
Cells(Cells(1048576, 1).End(xlUp).Row + 1, 1).Select
Activesheet.paste 
```

希望这可以帮助。

# ios - 创建单例 NSMutableArray

> ID：14676914
> 
> 赞同：0
> 
> 时间：2013-02-03T20:26:04.900
> 
> 标签：ios

我正在尝试做一个单例 NSMutableArray，但计数函数总是显示 0 个元素。我猜它没有很好地接收对象。

这是我创建的代码。

```
//VariableStore.h
@interface VariableStore : NSObject
{
    NSMutableArray *pruebaGlobal;
}
@property (nonatomic, retain) NSMutableArray *pruebaGlobal;
+ (VariableStore *)sharedInstance;
- (NSMutableArray*)pruebaGlobal;
@end

//VariableStore.m
@implementation VariableStore
@synthesize pruebaGlobal;
+ (VariableStore *)sharedInstance
{
    // the instance of this class is stored here
    static VariableStore *myInstance = nil;

    // check to see if an instance already exists
    if (nil == myInstance) {
        myInstance  = [[[self class] alloc] init];
        myInstance.pruebaGlobal = [[NSMutableArray alloc] initWithCapacity:100];
    }
    // return the instance of this class
    return myInstance;
}

- (NSMutableArray*)pruebaGlobal{
    return pruebaGlobal;
}

@end

//ViewController.m

NSMutableArray *p = [[VariableStore sharedInstance] pruebaGlobal];
p = [NSArray arrayWithObjects:
                   [NSMutableArray arrayWithObjects:@"Sí", @"No", nil, nil, nil],
                   [NSMutableArray arrayWithObjects:@"Súbita", @"Fluctuante", @"Progresiva", nil, nil],
nil];

NSLog(@"%d", [[[VariableStore sharedInstance] pruebaGlobal] count]); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:41:23.180

撇开`nil`在您的数组构造中的滥用不谈，您的代码根本不会向您要计算的数组添加任何内容。尝试这个：

```
NSMutableArray *p = [[VariableStore sharedInstance] pruebaGlobal];
[p addObject:[NSMutableArray arrayWithObjects:@"Sí", @"No", [NSNull null], [NSNull null], nil]];
[p addObject:[NSMutableArray arrayWithObjects:@"Súbita", @"Fluctuante", @"Progresiva", [NSNull null], nil]]; 
```

至于您合成的属性，您将其指定为保留属性，然后为它显式定义一个 getter，而不是一个 setter。如果将属性声明为保留，则可以让编译器同时处理 getter 和 setter，或者自己编写两者，但不能只编写其中一个。`- (NSMutableArray*)pruebaGlobal`我的建议，只需从头文件和实现文件中删除显式 getter: 即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:35:50.590

这部分代码至少有两个问题：

```
NSMutableArray *p = [[VariableStore sharedInstance] pruebaGlobal];
p = [NSArray arrayWithObjects:
               [NSMutableArray arrayWithObjects:@"Sí", @"No", nil, nil, nil],
               [NSMutableArray arrayWithObjects:@"Súbita", @"Fluctuante", @"Progresiva", nil, nil], nil]; 
```

第一：`[NSMutableArray arrayWithObjects:@"Sí", @"No", nil, nil, nil]`
`arrayWithObjects`只能取对象而`nil`不是对象，它用于终止扩充列表。如果您想将 的概念插入`nil`到 a中`NSArray`，您需要插入`[NSNull null]`一个专门为该用途而存在的单例对象。

另一个问题是使用`p` ：
您正在获取对您的`NSMutableArray`pruebaGlobal 的引用，然后您将指针的内容替换为`p`另一个新数组的地址。所以`p`现在指向一个不同的对象`pruebaGlobal`。

纠正这个问题的方法是这样的：

```
NSMutableArray *p = [[VariableStore sharedInstance] pruebaGlobal];  
[p addObject:@"test object"];
NSLog(@"%d", [[[VariableStore sharedInstance] pruebaGlobal] count]); 
```

现在你的计数应该是 1。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T20:36:08.323

问题是该属性的合成 ivar 将被命名`_pruebaGlobal`。但是您的`pruebaGlobal`方法正在返回`pruebaGlobal`ivar。

您的代码应更新为：

```
//VariableStore.h
@interface VariableStore : NSObject

@property (nonatomic, retain) NSMutableArray *pruebaGlobal;

+ (VariableStore *)sharedInstance;
- (NSMutableArray*)pruebaGlobal;

@end

//VariableStore.m
@implementation VariableStore

+ (VariableStore *)sharedInstance {
    // the instance of this class is stored here
    static VariableStore *myInstance = nil;

    // check to see if an instance already exists
    if (nil == myInstance) {
        myInstance  = [[[self class] alloc] init];
        myInstance.pruebaGlobal = [[NSMutableArray alloc] initWithCapacity:100];
    }

    // return the instance of this class
    return myInstance;
}

@end 
```

`@synthesize`现代的 Objective-C 编译器（Xcode 4.4 或更高版本）不再需要 ivar 或行。两者都会为您生成。

您不需要实现该`pruebaGlobal`方法 - 它会为您合成。

您的另一半问题是您将一个全新的数组分配给对属性`p`没有影响的变量。`pruebaGlobal`如果需要，您需要分配`p`给全局。

该行：

```
NSMutableArray *p = [[VariableStore sharedInstance] pruebaGlobal]; 
```

将您的空全局数组分配给`p`. 然后你做：

```
p = [NSArray arrayWithObjects:... 
```

将一个新数组分配给`p`. 然后，您尝试记录未修改的全局。

您需要添加：

```
[VariableStore sharedInstance].pruebaGlobal = p; 
```

# ruby-on-rails - 在 Rails 中加载 csv 文件时没有此类文件或目录错误

> ID：14676917
> 
> 赞同：3
> 
> 时间：2013-02-03T20:26:19.797
> 
> 标签：ruby-on-rails, rake, fastercsv

我正在尝试将数据从 csv 文件加载到我的 rails 数据库。这是我的 rake 任务：

```
namespace :db do
require 'csv'
  desc "load user data from csv"
  task :load_csv_data  => :environment do
    CSV.foreach("transfers.csv") do |row|
      Transfer.create(
      :transfer_id => row[0],
      :net => row[1]
      )
    end
  end
end 
```

它保存为 lib\tasks\inport_csv_data.rake。transfer.csv 文件保存在同一文件夹中。

```
this is what i get when trying to run the task from the shell:
$ rake db:load_csv_data --trace
** Invoke db:load_csv_data (first_time)
** Invoke environment (first_time)
** Execute environment
** Execute db:load_csv_data
rake aborted!
No such file or directory - transfers.csv
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/csv.rb:1342:in `initialize'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/csv.rb:1342:in `open'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/csv.rb:1342:in `open'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/csv.rb:1207:in `foreach'
c:/Users/uklar/openfinance/lib/tasks/import_csv_data.rake:7:in `block (2 levels) in <top (required)>'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:227:in `call'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:227:in `block in execute'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:222:in `each'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:222:in `execute'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:166:in `block in invoke_with_call_chain'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/1.9.1/monitor.rb:211:in `mon_synchronize'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:159:in `invoke_with_call_chain'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/task.rb:152:in `invoke'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:141:in `invoke_task'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:99:in `block (2 levels) in top_level'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:99:in `each'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:99:in `block in top_level'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:108:in `run_with_threads'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:93:in `top_level'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:71:in `block in run'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:158:in `standard_exception_handling'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/lib/rake/application.rb:68:in `run'
c:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/rake-10.0.2/bin/rake:37:in `<top (required)>'
c:/RailsInstaller/Ruby1.9.3/bin/rake:19:in `load'
c:/RailsInstaller/Ruby1.9.3/bin/rake:19:in `<main>'
Tasks: TOP => db:load_csv_data 
```

知道我在这里做错了什么吗？这一切看起来都很直接......谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:32:20.623

假设您从命令行启动 rake 任务，Ruby 在启动 rake 任务时会在命令行所在的当前工作目录中查找文件。这就是它找不到它的原因。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T20:41:57.787

您需要明确指向该文件。这将`file`假设`/path/to/your/rails/app/lib/tasks/transfers.csv`该`.csv`文件实际上与`lib/tasks`您的 rake 任务位于同一文件夹中。

```
# ...

file = File.expand_path('../transfers.csv', __FILE__)
CSV.foreach(file) do |row|
  # ... 
```

# phantomjs - PhantomJS 在 Mac OS X 上真的很慢

> ID：14676922
> 
> 赞同：3
> 
> 时间：2013-02-03T20:26:49.617
> 
> 标签：phantomjs

我正在尝试使用 PhantomJS，我真的很喜欢它，但它真的很慢......打开[http://www.google.com](http://www.google.com)
并退出的 简单代码需要 47347 毫秒，这非常慢......

如果我尝试使用“sudo”运行它需要 1282，这是 40 倍的加速，为什么会发生这种情况？我正在使用 phantom 1.8.1、Mac OS X 10.7.5。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-08-27T09:34:51.587

不确定 sudo 部分，但也许这有效：
[https ://github.com/segmentio/nightmare/issues/126#issuecomment-75944613](https://github.com/segmentio/nightmare/issues/126#issuecomment-75944613)

> 它是 phantomjs 模块和它的依赖，shoe 之间的套接字连接。
> 
> 您可以自己手动编辑鞋子。进入 node_modules/phantom/shoe/index.js 并将第 8 行更改为读取
> 
> ```
> var server = sockjs.createServer({
>         heartbeat_delay : 200
> }); 
> ```

# javascript - 对象在 node.js 简单服务器中变得未定义

> ID：14676927
> 
> 赞同：-3
> 
> 时间：2013-02-03T20:27:15.917
> 
> 标签：javascript, jquery, node.js

好的，所以当我运行这个服务器时：

```
var net = require('net');

var server = net.createServer(function (data) {
    console.log("Hello " + data.name);
});

server.listen(1337, '127.0.0.1'); 
```

然后在 chrome 上浏览此页面（来自文件，而不是域）：

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript">
            var data = new function(){
                this.name = "John";
            };

            $.post('http://127.0.0.1:1337/', data);
        </script>
    </head>
    <body>

    </body>
</html> 
```

我在我的服务器上得到以下输出：

```
Hello undefinied 
```

我的问题是，为什么我的数据对象的名称在我将它发送到服务器时变得未定义？

* * *

编辑：所以我将服务器更改为：

```
var http = require('http');

var server = http.createServer(function (data) {
    console.log("Hello " + data.name);
});

server.listen(1337, '127.0.0.1'); 
```

并将我客户的脚本更改为：

```
var data = {
                name: "John"
            };
            $.post('http://127.0.0.1:1337/', data); 
```

但我仍然遇到同样的错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:28:51.627

`net.connection`创建一个普通的 TCP 套接字，而不是一个 HTTP 服务器。

相反，您想要`http.createServer`，并且它接受作为其参数的函数不会获得仅包含提交数据的简单对象。您需要阅读该`http`模块的手册并了解如何处理请求对象。

[node.js 主页上](http://nodejs.org/)有一个示例（只需向下滚动）。

另请参阅[请求事件](http://nodejs.org/api/http.html#http_event_request)和[node.js 提取 POST 数据](https://stackoverflow.com/questions/4295782/node-js-extracting-post-data)的 API 文档。

# ruby-on-rails-3 - Spree，将控制器添加到管理页面

> ID：14676932
> 
> 赞同：0
> 
> 时间：2013-02-03T20:27:45.367
> 
> 标签：ruby-on-rails-3, routes, spree

我正在尝试将我的自定义控制器添加到 spree 1.3.1 的管理部分，但我失败了。我想在顶部菜单中查看我的 contoller.index.html 的 url。我已经这样做了：

**/controllers/spree/admin/parsers_controller.rb:**

```
module Spree
  module Admin
    #class ParsersController < Spree::Admin::BaseController
    class ParsersController <  Spree::Admin::ResourceController
      def index

      end

    end
  end
end 
```

**污损：**

```
Deface::Override.new(:virtual_path => "spree/layouts/admin",
                     :name => "admin_content_admin_tab_parser",
                     :insert_bottom => "[data-hook='admin_tabs']",
                     :text => "<%= tab :parsers,  :url => spree.admin_parsers_path, :icon => 'icon-th-large' %>",
                     :disabled => false) 
```

路线.rb：

```
Spree::Core::Engine.routes.prepend do
  namespace :admin do
    resources :parsers
    end
end 
```

**index.html.erb**

```
<h1>Parser index.html</h1> 
```

我收到错误：

您的收据给出了同样的错误：

```
NoMethodError in Spree/admin/overview#index
Showing /home/ssa/spree-1.3.1-0/ruby/lib/ruby/gems/1.9.1/gems/spree_core-1.3.1/app/views/spree/layouts/admin.html.erb where line #54 raised:

undefined method `admin_parsers_path' for #<ActionDispatch::Routing::RoutesProxy:0x0000000612a560>
Extracted source (around line #54):

51:           <div class="sixteen columns main-menu-wrapper">
52:             <ul data-hook="admin_tabs" class="inline-menu fullwidth-menu">
53: <%= render :partial => 'spree/admin/shared/tabs' %>
54:             <%= tab(:promotions, :url => spree.admin_promotions_path, :icon => 'icon-bullhorn') %><%= tab(:users, :url => spree.admin_users_path, :icon => 'icon-user') %><%= tab :parsers,  :url => spree.admin_parsers_path, :icon => 'icon-th-large' %>
55: </ul>
56: </div> 
57:         </div> 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-10T12:25:01.307

好的，所以问题很简单： [为什么我得到“未定义的方法 `assert_valid_keys`”？](https://stackoverflow.com/questions/9507770/why-am-i-getting-undefined-method-assert-valid-keys)

不能在我的模型中声明：`belongs_to :aThingA, :aThingB` 需要：

```
belongs_to :aThingA
belongs_to :aThingB 
```

# javascript - Internet Explorer 中的 onchange

> ID：14676935
> 
> 赞同：0
> 
> 时间：2013-02-03T20:27:55.217
> 
> 标签：javascript, html, ajax, internet-explorer

为什么我不能在ie中使用onChange？有没有解决方案？

HTML：

```
<select id="auto_doors" style="display:none;" name="auto_doors" onchange="updateField(this.value, 'auto_fuel', 5, 6, this.parentNode.id), resetBelow(4,'auto'), show('auto_fuel')">
</select> 
```

功能：

```
if (jQuery.browser.msie) { setTimeout(DoSomething, 0); } else { DoSomething(); }
        function updateField(str, id, prevvalue, value, vehicletype)
        {
        if (str=="")
          {
          document.getElementById(id).innerHTML="";
          return;
          } 
        if (window.XMLHttpRequest)
          {// code for IE7+, Firefox, Chrome, Opera, Safari
          xmlhttp=new XMLHttpRequest();
          }
        else
          {// code for IE6, IE5
          xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
          }
        xmlhttp.onreadystatechange=function()
          {
          if (xmlhttp.readyState==4 && xmlhttp.status==200)
            {
            document.getElementById(id).innerHTML=xmlhttp.responseText;
            }
          }
        xmlhttp.open("GET","inc/form_rest.php?q="+str+"&prevvalue="+prevvalue+"&value="+value+"&vehicletype="+vehicletype,true);
        xmlhttp.send();
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:35:03.370

尝试将 on on change 事件绑定到 auto_doors 元素，如下所示：

```
$("#auto_doors").change(function(){
   updateField(this.value, 'auto_fuel', 5, 6, this.parentNode.id), resetBelow(4,'auto'), show('auto_fuel');
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:37:14.740

您可以使用 jQuery 来解决此问题，代码如下所示：

```
$('#auto_doors').change(function() {
  alert('Handler for .change() called.');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T20:31:58.157

可能有帮助的三个观察结果：

1.  不再需要支持 IE6 及以下版本。`new XMLHttpRequest()`足够了。
2.  你应该`onreadystatechange` *在*调用后设置`.open()`。在某些浏览器（可能只是 IE）中，调用`.open()`算作“新请求”并清除 readystatechange 处理程序。
3.  旧版本的 IE（IE7？）不喜欢`this.value`在`<select>`. 相反，您应该使用`this.options[this.selectedIndex].value`.

# c++ - BigInt 显示函数

> ID：14676939
> 
> 赞同：1
> 
> 时间：2013-02-03T20:28:39.687
> 
> 标签：c++, bigint

我正在为 BigInt 类实现代码，但在显示对象时遇到问题。我不确定我做错了什么，但我的结果是相反的。请帮忙！

```
BigInt.h

#include <iostream>
using namespace std;
using std::cout;

#ifndef BIGINT_H
#define BIGINT_H

class BigInt
{
//input and output operators
    friend istream & operator >> (istream &, BigInt &);
    friend ostream & operator << (ostream &, const BigInt &);

public:
    BigInt(); //default constructor
    BigInt(int); //initializes array with user-specified numbers

    BigInt operator + (BigInt &);

    void display(); //prints array

private:
   static const int CAPACITY = 40;
   int Digits[CAPACITY]; //stores all digits
};
#endif 
```

大整数.cpp

```
#include <iostream>
#include "BigInt.h"
using std::cout;

BigInt::BigInt()
{
   for (int i = 0; i < CAPACITY; i++)
      Digits[i] = 0;
}

BigInt::BigInt(int InitNum)
{
   //Inputs the individual numbers given to BigInt into the Digits array's elements
   for(int i = 0; i < CAPACITY; i++)
   {
      if(InitNum > 0)
      {
         Digits[i] = InitNum%10;
         InitNum = InitNum/10;
      }
      else
         Digits[i]=0;
   }
}

//------------------------------------------------------------------
BigInt BigInt::operator +(BigInt & a)
{
   for(int i = CAPACITY - 1; i >= CAPACITY; i--)
      Digits[i]+=a.Digits[i];
}

//-----------------------------------------------------------------
ostream & operator << (ostream & cout, const BigInt& a)
{
   for(int i=0; i< a.CAPACITY ; i++)
      cout << a.Digits[i];
   return cout;
}

istream & operator >> (istream & cin,  BigInt& a)
{
   for(int i = 0; i < a.CAPACITY; ++i)
      cin >> a.Digits[i];

   return cin;
}

//---------------------------------------------------------------
void BigInt::display()
{
   for(int i = 0; i< CAPACITY; i++)
      cout << Digits[i];

   cout << "\n";
} 
```

主文件

```
#include <iostream>
#include <cstdlib>
#include <fstream>
#include "BigInt.h"

int main()
{
   BigInt object1(45756369);
   BigInt object2(47435892);

   object1.display();
   object2.display();

   BigInt object3 = object1 + object2;

   cout << object3;

   return 0;
} 
```

谢谢！另外，operator+ 功能好吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T20:51:45.477

您在构造函数中将数字倒置 Num % 10 将为您提供最后一个数字...在完成将数组填充到构造函数后，您需要反转数组。

# c# - 如何在定义明确的模型中反序列化动态属性？

> ID：14676940
> 
> 赞同：1
> 
> 时间：2013-02-03T20:28:42.077
> 
> 标签：c#, json, asp.net-web-api, json.net, deserialization

我有一个定义如下的 web api 方法：

```
[HttpPost]
public void Post(Input model)
{
    ...
} 
```

使用这样的输入模型：

```
public class Input
{
    public string Id { get; set; }
    public object Extra { get; set; }
} 
```

我想要做的是传递一个有效的 JSON 对象作为额外的参数，就像下面的 jQuery 示例一样：

```
$.post(
    'http://localhost/api/myController',
    { 
        id: 'someId',               
        extra: { 
            tags: ['a', 'b'],
            anotherValue: 'hello',
            oneMore: { 
                foo: 'bar'
            }
        }
    }); 
```

*Id*正确地进入了我的 model.Id 属性。但是，*额外的*属性以 {object} 的形式出现，因为我不知道里面有什么，所以我无法以任何方式反序列化它。

我尝试将其设为*动态*和/或将其转换为动态/ExpandoObject/Dictionary 但没有成功。我知道如果我只收到一个原始的 HttpRequestMessage 并自己处理它，我可能可以让它工作。但是，我宁愿不这样做，而是依赖 .NET 的所有验证。

是否可以？

谢谢

**编辑1：**在测试了更多替代方案后，我发现*额外的*属性没有任何实际价值，它只是被初始化为一个*新的 object()*。看起来默认模型绑定器实现不处理动态 JSON（至少不是这样），只是调用它无法处理的模型属性的默认构造函数。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:10:25.813

将您的属性定义为`object`应该工作，或者如果您想明确，您可以为您的`Extra`属性指定 type `JObject`。

但是问题在于`$.post`请求。为了将复杂数据发布到 web.api 方法并允许模型绑定，您需要做两件事：

*   将内容类型设置为“应用程序/json”
*   并将数据作为 JSON 发送并调用`JSON.stringify`它

但是`$.post`您无法指定内容类型，因此您需要使用`$.ajax`：

因此，以下调用应将数据发布到您的操作中：

```
$.ajax({
    url: 'http://localhost/api/myController',
    type: 'POST',
    contentType: 'application/json',
    data: JSON.stringify(
    { 
        id: 'someId',               
        extra: { 
            tags: ['a', 'b'],
            anotherValue: 'hello',
            oneMore: { 
                foo: 'bar'
            }
        }
    })
}); 
```

# ruby-on-rails-3 - 哪个组件在 Rails JSON 响应中对 JSON 值进行排序，为什么？

> ID：14676943
> 
> 赞同：1
> 
> 时间：2013-02-03T20:28:51.537
> 
> 标签：ruby-on-rails-3

我注意到 Rails JSON 输出是按字母顺序排序的。

这是一个基本 Rails 应用程序的 JSON 输出示例：

```
{"created_at":"2013-02-03T19:44:39Z","email":"mohsen@example.com","id":2,"name":"Mohsen","updated_at":"2013-02-03T19:44:39Z"} 
```

它似乎`created_at`并且`updated_at`具有相同的起源，并且可能应该彼此相邻。但是 Rails 的输出是按字母顺序排列的。

哪个组件在做这项工作，为什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-11T16:51:34.957

我发现第一行`ActiveModel::Serializers::JSON#as_json`调用`ActiveModel::Serialization#serializable_hash`，其中有[这行代码对属性名称进行排序](https://github.com/rails/rails/blob/3508da50f02b11290245976f2dbaeef6cd794e83/activemodel/lib/active_model/serialization.rb#L71)：

```
attribute_names = attributes.keys.sort 
```

这是对属性进行排序的地方。至于*为什么要*对它们进行排序，答案就不太清楚了。[Josh Peek 早在 2009 年 7 月就以这种提交方式引入了排序](https://github.com/rails/rails/commit/783db25e0c640c1588732967a87d65c10fddc08e)，但提交评论只是“将 AMo JSON 序列化程序集成到 AR 中”。他没有说为什么他把电话加到`.sort`.

但是，如果您不喜欢这种类型，那么只要您愿意在 Rails 4 发布时升级到它，那么您就很幸运了。Rails 核心团队似乎同意不应该对 JSON 键进行排序。[2012 年 3 月，他们接受了这个拉取请求，其中`sort`删除](https://github.com/rails/rails/commit/cf833b9d97f612ed2105ca4c467f03f812433320)了对的调用。此提交不在最新的 Rails 3.2 中，但将在即将推出的 Rails 4 中。

# jquery - jQuery去抖动幻灯片跳过幻灯片

> ID：14676945
> 
> 赞同：1
> 
> 时间：2013-02-03T20:28:54.547
> 
> 标签：jquery, performance, scroll, requestanimationframe, debouncing

我为我的个人主页编写了一个插件，它应该滚动浏览一系列元素，捕捉到每个元素 offsetTop。
我正在使用*requestanimationframe*来消除滚动事件，但有时会跳过幻灯片，我就是不知道为什么。**此外**，在 Chrome 和 Safari 上，我遇到了*window.pageYOffset的问题*可能小于 0 并且大于文档高度，因为这些浏览器在 mac（带有触摸板）上使用了某种缓和功能——你将如何处理？

这是代码：

```
// requerstanimationframe for all browsers
window.rAF = (function(){
      return  window.requestAnimationFrame       || 
              window.webkitRequestAnimationFrame || 
              window.mozRequestAnimationFrame    || 
              window.oRequestAnimationFrame      || 
              window.msRequestAnimationFrame     || 
              function( callback ){
                window.setTimeout(callback, 1000 / 60);
              };
    })();

// main plugin code
var Slides = {

    el: ".slide",
    arrowUp: $(".btn-previous"),
    arrowDown: $(".btn-next"),
    lastSlide: 0,
    lastY: 0,
    scrolling: false,
    scrollSpeed: 500,

    init: function(){

        this.$elem = $(this.el);
        this.catchSlides();
        this.newPos(true);

        // event handler
        this.registerHandler();

        return this;
    },

    registerHandler: function(){
        var that = this,
            handler = {
            "resize.slider": jQuery.proxy(this.onResize,this),
            "scroll.slider": jQuery.proxy(this.onScroll,this),
            "keydown.slider": jQuery.proxy(this.keyhandler,this),
            "mousedown.slider": function(){ that.scrolling = true; },
            "mouseup.slider": function(){ that.scrolling = false; }
        };

        $(window).on(handler);
        $(".btn").on("click.slider", jQuery.proxy(this.btnhandler,this))
    },

    catchSlides: function(){
        // count slides and save selectors
        var array = [];

        for(var i=0; i<this.$elem.length; i++){    

            var el = this.$elem.eq(i);
            array[i] = el;
        }

        this.elements = array;
        this.slideCount = this.elements.length;
    },

    getPositions: function(){
        // what are the postions of those slides?
        var array = [];

        for(var i=0; i<this.slideCount; i++){ 

            var el = this.elements[i];
            array[i] = el[0].offsetTop;
        }

        this.posArray = array;
    },

    arrows: function(){
        if(this.slideCount>1){
            switch(this.lastSlide) {

                case 0: // erster slide
                    if(this.arrowUp.is(":visible")) this.arrowUp.hide();
                    if(!this.arrowDown.is(":visible")) this.arrowDown.show(); 
                break;

                case this.slideCount-1: // letzter slide
                    if(this.arrowDown.is(":visible")) this.arrowDown.hide();
                    if(!this.arrowUp.is(":visible")) this.arrowUp.show(); 
                break;

                default: 
                    this.arrowUp.show();
                    this.arrowDown.show();

            }
        }
        else {
            this.arrowUp.hide();
            this.arrowDown.hide();
        }
    },

    getY: function(){
        return window.pageYOffset;
    },

    newPos: function(jump){
        // go to the new coordinate, hide one of those arrows 
        // if first or last slide
        this.arrows();
        this.getPositions();
        this.jumpTo(jump);
    },

    clear: function(){
        this.lastY = this.getY();
        this.scrolling = false;
    },

    onResize: function(){
        if(!this.scrolling){
            rAF(jQuery.proxy(this.newPos,this));
        }
        this.scrolling = true;
    },

    onScroll: function(){
        if(!this.scrolling){
            rAF(jQuery.proxy(this.update,this));
        }
        this.scrolling = true;
    },

    update: function(){
        // which direction did the user scroll?
        if(this.lastY<this.getY()){ // down?
            this.slide("down");
        }
        else if(this.lastY>this.getY()){ // or up?
            this.slide("up");
        }
        else this.clear();
    },

    slide: function(string){
        if(string==="down" && this.lastSlide<this.slideCount-1){
            this.lastSlide++;
            this.newPos();
        }
        else if(string==="up" && this.lastSlide>0){
            this.lastSlide--;
            this.newPos();
        }
        else this.clear();
    },

    jumpTo: function(jump, slideIndex){
        var that = this,
            slideIndex = slideIndex || this.lastSlide,
            destination = this.posArray[slideIndex];

        this.scrolling = true;

        if(jump && jump!==undefined){
            // jump to position without animation
            $("html,body").stop().animate({scrollTop: destination}, 0, function(){ that.clear(); });
        }
        else $("html,body").stop().animate({scrollTop: destination}, this.scrollSpeed, function(){ that.clear(); });
    },

    keyhandler: function(e){
        switch(e.which) {
            case 38: 
            e.preventDefault();
            this.slide("up");// up
            break;

            case 40: 
            e.preventDefault();
            this.slide("down");// down
            break;

            default: return;
        }
    },

    btnhandler: function(e){
        // register arrow-buttons from ui
        var $next = $(".btn-next"),
            $prev = $(".btn-previous");

        e.preventDefault();

        if(e.target===$next || $.contains($next[0], e.target)) this.slide("down");
        else if(e.target===$prev || $.contains($prev[0], e.target)) this.slide("up");
    }
};

Slides.init(); 
```

希望有人可以提供帮助。谢谢。

# ruby - 升级到 ruby 1.9.3-p374 时出现“Make”错误

> ID：14676950
> 
> 赞同：1
> 
> 时间：2013-02-03T20:29:02.967
> 
> 标签：ruby, makefile, version, upgrade, ruby-1.9.3

**问题：**

我是 Rails 的新手，并试图开始使用 Rails 教程。升级到不同版本的 ruby​​ 时，尝试将 ruby​​ 版本从 1.8.7 升级到 1.9.3-p374 时出现以下错误

**错误**

```
Error running 'make', please read /usr/local/rvm/log/ruby-1.9.3-p374/make.log
There has been an error while running make. Halting the installation. 
```

**酿造清单**

```
apple-gcc42 
cmake       
libksba     
libyaml     
readline
autoconf    
curl        
libtool     
make        
sqlite
automake    
git     
libxml2     
openssl
bash        
libgpg-error    
libxslt     
pkg-config 
```

**海合会版本**

```
i686-apple-darwin11-gcc-4.2.1 (GCC) 4.2.1 (Apple Inc. build 5666) (dot 3)
Copyright (C) 2007 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. 
```

**cpp路径**

```
/usr/bin/cpp 
```

**我遵循的步骤**

1.  安装了 XCode 命令行工具
2.  [重新安装稳定版的 RVM](https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)
3.  酿造更新
4.  brew tap homebrew/dupes
5.  brew install autoconf automake apple-gcc42
6.  rvm pkg 安装 openssl
7.  冲泡安装 libksba
8.  遵循moncef[文章的所有说明](http://www.moncefbelyamani.com/how-to-install-xcode-homebrew-git-rvm-ruby-on-mac/)

# python - 使用记事本开发并在 python 中运行，还是使用 Interactive Python？

> ID：14676954
> 
> 赞同：0
> 
> 时间：2013-02-03T20:29:37.587
> 
> 标签：python, interactive

我使用 python 如下...notepad++ 在屏幕的左侧。黑色命令提示符位于屏幕右侧。我在记事本中编写我的 python prog 并将其作为 ggg.py 保存到 python 目录，然后使用（控制 S）。我切换到命令提示符屏幕并运行它。任何错误我都会回去修复并再次运行。难道是使用带有>>>提示符的python更有效。即如何使用交互式python（>>>）复制上述内容？它比我目前的方法更容易吗？橡子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T19:00:07.387

我建议你试试 IPython。它是python的高级交互式编程环境。在 Ipython 中，您可以使用魔术命令 %edit 打开像 Notepad++ 这样的外部编辑器来键入您的代码，然后在 IPython 中执行代码。或者您可以键入 %run 将脚本加载到 IPython。还有许多其他神奇的命令可以帮助您提高效率。

您还可以尝试 IPython 的新功能笔记本。

# android - 在 DialogFragment 中动态添加微调器

> ID：14676956
> 
> 赞同：4
> 
> 时间：2013-02-03T20:29:39.890
> 
> 标签：android, android-dialog, android-dialogfragment

我想在**Dialog**中动态添加我的自定义项目，例如**Spinner**，但它没有显示出来。我想微调器项目没有被. 我没有收到任何错误，但项目没有动态显示。**`findviewbyid()`**

 **请提出一种方法来做到这一点。

**这是我的课程和 xml 文件：**

```
public class AlertDialogFragment extends DialogFragment {

@Override
public Dialog onCreateDialog(Bundle savedInstanceState) {
    // Use the Builder class for convenient dialog construction
    AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
    LayoutInflater inflater = getActivity().getLayoutInflater();

    View view = inflater.inflate(R.layout.dialog, null);

    Spinner spin;
    spin = (Spinner)view.findViewById(R.id.spinner1);

    List<String> list = new ArrayList<String>();
    list.add("Material 1");
    list.add("Material 2");
    list.add("Material 3");
    list.add("Material 4");
    list.add("Material 5");
    list.add("Material 6");

    //Second List
    List<String> list2 = new ArrayList<String>();
    list2.add("Mat 7");
    list2.add("Mat 8");
    list2.add("Mat 9");

    //Combined List
    List<String> listCombine = new ArrayList<String>();
    listCombine.addAll(list);
    listCombine.addAll(list2);

    ArrayAdapter<String> dataAdapter = new ArrayAdapter<String>(getActivity(),
            android.R.layout.simple_spinner_item, listCombine); 

    dataAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);

    spin.setAdapter(dataAdapter);

    builder
    .setTitle("Title")
    .setView(inflater.inflate(R.layout.dialog, null))
           .setPositiveButton("Add", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                   // FIRE ZE MISSILES!
               }
           })
           .setNegativeButton("Cancel", new DialogInterface.OnClickListener() {
               public void onClick(DialogInterface dialog, int id) {
                   // User cancelled the dialog
               }
           });
    // Create the AlertDialog object and return it
    return builder.create();
} 
```

}

**我的xml文件是：**

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:orientation="vertical"
android:layout_width="wrap_content"
android:layout_height="wrap_content">

<LinearLayout android:orientation="horizontal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_margin="20dp">

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Materials"
    android:layout_marginRight="10dp"
    android:textSize="20sp"
    android:textAppearance="?android:attr/textAppearanceMedium" />

<Spinner
    android:id="@+id/spinner1"
    android:layout_width="0dip"
    android:layout_height="35dp"
    android:layout_weight="1" 
    android:layout_marginRight="10dp"
    android:background="#FFB2B2"      
     />

</LinearLayout>

<LinearLayout android:orientation="horizontal"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_margin="20dp">

<TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="Weight"
    android:layout_marginRight="35dp"
    android:textSize="20sp"
    android:textAppearance="?android:attr/textAppearanceMedium" />

 <TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="55"
    android:textSize="20sp"
    android:textAppearance="?android:attr/textAppearanceMedium" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:32:03.150

而不是在这里膨胀第二个布局：

```
builder
    .setTitle("Title")
    .setView(inflater.inflate(R.layout.dialog, null)) // Second layout! 
```

只需使用您已经膨胀和设置的布局：

```
builder
    .setTitle("Title")
    .setView(view) // Existing layout 
```**

# c# - 为中等信任级别编译 MVC 应用程序

> ID：14676964
> 
> 赞同：8
> 
> 时间：2013-02-03T20:31:23.517
> 
> 标签：c#, asp.net-mvc-4, medium-trust

我正在尝试将 ASP.NET MVC4 站点部署到 HostGator 共享 Windows 主机。当他们的技术支持告诉我必须为中等安全性编译我的应用程序时，我遇到了一些麻烦。

据我所知，为应用程序设置信任级别的唯一方法`<trust level="Medium">`是在 machine.config 或 web.config 中设置。假设我错了，是否有另一种方法可以编译我的应用程序以获得中等信任？

根据我最初的假设，以及我在[此页面](http://msdn.microsoft.com/en-us/library/aa302425.aspx#c09618429_009)上找到的信息，我将信任级别添加到我的 web.config：

> 默认情况下，Web 应用程序以完全信任的方式运行并具有不受限制的权限。要在 ASP.NET 中修改代码访问安全信任级别，您必须在 Machine.config 文件或应用程序级 Web.config 文件中设置一个开关，并将应用程序配置为部分信任应用程序。我将信任级别放在我的 web.config 中，并从主机获取此错误消息：
> 
> 解析器错误消息：此配置部分不能用于此路径。当站点管理员使用继承的配置文件锁定对此部分的访问权限时，就会发生这种情况。

但是 HostGator 仍然坚持我编译为中等信任，有人对我有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-08T10:16:07.577

你是对的。您可以将 web.config 的信任设置更改为中。但是，您可能有一些程序集不能在部分信任模式下工作（例如某些 IoC 容器）。

唯一确定的方法是运行它并找出答案。

# javascript - 主干分页器集合未在重置时触发渲染

> ID：14676965
> 
> 赞同：1
> 
> 时间：2013-02-03T20:31:28.307
> 
> 标签：javascript, jquery, backbone.js

我有一个骨干分页器集合：

```
 var ExercisesCollection = Backbone.Paginator.requestPager.extend({

        model: ExerciseModel,

        paginator_core: {
            url: "/exercises"
        },

        paginator_ui: {
            firstPage: 1,
            currentPage: 1,
            perPage: 10,
            totalPages: 10
        },

        server_api: {
            "filter": "",
            "categories": "",
            "top": function() { return this.perPage; },
            "skip": function() { return this.currentPage * this.perPage; }
        },

        parse: function (response) {
            this.totalPages = response.meta.totalPages;
            return response.data;
        }

    }); 
```

我在主干视图中使用它，如下所示：

```
var Exercises = Backbone.View.extend({

    initialize: function () {
        this.collection = new ExercisesCollection();
        this.collection
            .on( "reset", this.render, this )
            .on( "change", this.render, this);
        this.collection.goTo( 1 );
    },

    render: function() {
        alert("bah!");
    }
}); 
```

通过查看网络活动，我可以看到它正在向服务器发送请求并接收到适当的响应。但是它从不调用渲染函数。重置和更改事件似乎不起作用。

任何想法我做错了什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-03-18T19:51:20.417

我在 2016 年遇到了同样的问题 :)
当您使用该`'server'`模式时，您需要收听`'sync'`事件，而不是`'reset'`.

```
// in a view
this.listenTo(this.collection, 'sync', this.renderPage); 
```

从骨干文档（[http://backbonejs.org/#Collection-fetch](http://backbonejs.org/#Collection-fetch)）：

> 当模型数据从服务器返回时，它使用 set 来（智能地）合并获取的模型，除非您传递 {reset: true}，在这种情况下，集合将（有效地）重置。

所以它默认不调用`reset()`，所以没有`'reset'`事件。

`'sync'`我在这个答案中 发现了这个事件： [https ://stackoverflow.com/a/17053978/1657101](https://stackoverflow.com/a/17053978/1657101)

> 从主干 1.0 开始，model.fetch() 触发“同步”。这就是你应该绑定的。

# eclipse - FileLocator.resolve(url) 的转义结果

> ID：14676966
> 
> 赞同：8
> 
> 时间：2013-02-03T20:31:30.073
> 
> 标签：eclipse, eclipse-plugin

该方法`FileLocator.resolve(url)`可用于将地址转换`bundleentry://something/somewhere/x.txt`为`/mnt/foo/somewhere/x.txt`.

但是，这也记录在[https://bugs.eclipse.org/bugs/show_bug.cgi?id=145096](https://bugs.eclipse.org/bugs/show_bug.cgi?id=145096)中，URL 没有转义。例如，如果包含引用包的 Eclipse 安装位于包含空格的目录中，则返回的 URL`FileLocator.resolve`仍然包含空格，因此调用`url.toURI()`失败。

*   如何手动转义URL 中的*所有必要字符？*
*   如何`File`根据相对于当前包的路径获取对象？

作为参考，如果该文件位于包含空格的目录中，则尝试`dir`在我的插件文件中查找目录时失败的代码如下：`.jar`

```
 final IPath pathOfExampleProject = new Path("dir");
    final Bundle bundle = Platform.getBundle(AproveIDs.PLUGIN_ID);
    final URL url = FileLocator.find(bundle, pathOfExampleProject, null);
    final URL url2 = FileLocator.toFileURL(url);
    url2.toURI(); // Illegal character in path at index [...] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-03T20:50:14.870

我刚刚找到了这段代码：

[http://code.google.com/p/dart/source/browse/branches/bleeding_edge/dart/editor/tools/plugins/com.google.dart.tools.core/src/com/google/dart/tools/核心/内部/模型/BundledSystemLibrary.java?r=2057](http://code.google.com/p/dart/source/browse/branches/bleeding_edge/dart/editor/tools/plugins/com.google.dart.tools.core/src/com/google/dart/tools/core/internal/model/BundledSystemLibrary.java?r=2057)

相关行确实有帮助：

```
// We need to use the 3-arg constructor of URI in order to properly escape file system chars.
URI resolvedUri = new URI(resolvedUrl.getProtocol(), resolvedUrl.getPath(), null); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-27T16:18:23.923

两个附加说明：

*   FileLocator.resolve 确实解析了一个 URL，但它不一定返回一个 file:/ URL。在打包捆绑包的默认情况下（在 .jar 中），您应该使用 FileLocator.toFileURL，它会在需要时自动将资源提取到缓存中。
*   由于 Eclipse 4.x 现在默认包含 EMF Common API，您可以使用 EMF 的 URI API 更简单地转义 URL，如下所示：

`URI resolvedUri = URI.createFileURI(resolved.getPath());`

要获取文件名，请调用`resolvedUri.toFileString();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-08T13:19:38.550

来自[Vogella 博客：](http://blog.vogella.com/2010/07/06/reading-resources-from-plugin/ "沃杰拉博客")

```
URL url;
try {
    url = new 
    URL("platform:/plugin/de.vogella.rcp.plugin.filereader/files/test.txt");
    InputStream inputStream = url.openConnection().getInputStream();
    BufferedReader in = new BufferedReader(new InputStreamReader(inputStream));
    String inputLine;

while ((inputLine = in.readLine()) != null) {
    System.out.println(inputLine);
}

in.close();

} catch (IOException e) {
    e.printStackTrace();
} 
```

要获取 URL，可以使用以下方法：

```
Bundle thisBundle = FrameworkUtil.getBundle(getClass());
URL fileURL = thisBundle.getEntry("<relative_file_path_from_project_root"); 
```

此外，可以选择 Stream/Reader 的类型来读取图像/文本。

# symfony - 收集表单 Symfony 2 中的自动 div 和字段

> ID：14676971
> 
> 赞同：0
> 
> 时间：2013-02-03T20:31:52.493
> 
> 标签：symfony, twig, formbuilder

我有一个表格集合。当我渲染我的结果时，我有每个表单的 div 和标签（当我使用原型添加表单时，这些也被添加）第一个表单是

```
namespace Webwall\CamBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class SocialType extends AbstractType {

    public function buildForm(FormBuilderInterface $builder, array $options) {
        $builder

                ->add('account')

        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver) {
        $resolver->setDefaults(array(
            'data_class' => 'Webwall\CamBundle\Entity\Social',
        ));
    }

    public function getName() {
        return 'social';
    }

} 
```

“主要形式”是

```
namespace Webwall\CamBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class MediaType extends AbstractType {

    public function buildForm(FormBuilderInterface $builder, array $options) {

        $builder                
                ->add('socials', 'collection', array(
                    'type' => new SocialType(),
                    'allow_add' => true, 
                ))

        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver) {
        $resolver->setDefaults(array(
            'data_class' => 'Webwall\CamBundle\Entity\Media'
        ));
    }

    public function getName() {
        return 'foto';
    }

} 
```

在我的树枝上

```
<div id="form_foto">
{{ form_errors(form) }}
{{ form_rest(form) }} 
```

在我的 dom 我有这个

```
<div><label class="required">Socials</label><div id="foto_socials" data-prototype=""><div><label class="required">0</label> 
```

为什么我有这个默认的 div？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T02:15:16.940

编辑树枝文件

```
 <ul class="unstyled child" data-prototype="{{ form_widget(form.socials.vars.prototype)|e }}">
                            {% for row in form.socials %}
                                <li style="margin-bottom: 5px;"> {{ form_widget(row.account) }}</li>
                            {% endfor %}
                        </ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-16T16:13:03.017

我有同样的问题，您可以修改**twig**（如 Kaan 建议的那样），**或者**您可以通过**添加选项行**来修改您的类型表单：

```
 $builder                
            ->add('socials', 'collection', array(
                'type' => new SocialType(),
                'options' => array('label' => false), // ADD THIS LINE IN YOUR CODE
                'allow_add' => true, 
            )) 
```

# memory - 我需要加速包含mod操作的代码

> ID：14676972
> 
> 赞同：1
> 
> 时间：2013-02-03T20:31:53.260
> 
> 标签：memory, optimization, modulo

我有以下数学方程式

```
for(i=0;i<M;i++)
for(j=0;j<M;j++)
R=((A(i)+B(j))%M)*M+(C(i)+D(j))%M; 
```

在 C 代码中，我试图加快代码速度，我发现如果我删除 mod 操作，它会变得快 6 倍，但我无法删除它但是 A、B、C 和 D 的值在 0 之间和 M，所以我有四个案例

首先如果 A+B 和 C+D 小于 M 不需要进行 mod 操作

```
R=R 
```

其次，如果 A+B 小于 M 并且 C+D 大于 MI 只需要使

```
R=R-M 
```

第三，如果 A+B 和 C+D 大于 M 那么我需要 \

```
R=R-M*M-M 
```

最后，如果 A+B 大于 M 且 C+D 小于 M 则我需要

```
R=R-M*M 
```

如果我使用 if else 来实现它会很耗时？所以任何建议

# sublimetext2 - ubuntu 的 Sublime Text URL 处理程序

> ID：14676981
> 
> 赞同：10
> 
> 时间：2013-02-03T20:32:29.927
> 
> 标签：sublimetext2

如何让 sublime text 2 响应`txmt`ubuntu 中的 url 方案？这在 OSX 中通过[subl-handler](https://github.com/asuth/subl-handler)和在 Windows 中通过[SublimeProtocol](https://bitbucket.org/sublimator/sublimeprotocol/overview)是可能的。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-08T14:51:19.703

我今天问了我同样的问题，看到 txmt 协议和 Rails 的“better_errors”gem。

找了半天，一无所获，只好自己动手做了。

我写了[一篇文章和我的博客](http://blog.byscripts.info/2013/02/txmt-protocol-and-sublime-text-2-english.html)，但为了“面向未来”，我将其复制在这里：

# 第1步

创建文件`/usr/share/applications/sublime-handler.desktop`

```
[Desktop Entry]
Name=Sublime Text 2 URL Handler
GenericName=Text Editor
Comment=Handle URL Scheme txmt://
Exec=/home/<your_user>/bin/sublime-handler %u
Terminal=false
Type=Application
MimeType=x-scheme-handler/txmt;
Icon=sublime-text-2
Categories=TextEditor;Development;Utility;
Name[en_US]=Sublime Text 2 URL Handler 
```

# 步骤 2：更新 MIME 类型数据库

```
$ sudo update-desktop-database 
```

# 第 3 步：创建 ~/bin/sublime-handler 文件

```
#!/usr/bin/env bash

request=${1:23}               # Delete the first 23 characters
request=${request//%2F//}     # Replace %2F with /
request=${request/&line=/:}   # Replace &line= with :
request=${request/&column=/:} # Replace &column= with :
sublime-text-2 $request       # Launch ST2 
```

然后使其可执行：`$ chmod +x ~/bin/sublime-handler`

# 第 4 步：测试 txmt:// 文件

如果这不起作用，说我，我会尽力帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-14T17:13:02.773

添加答案，因为我没有足够的声誉来发表评论。

对于 Ubuntu 14.04，Sublime Text 3，上述说明有效。非常感谢，@ByScripts！

在步骤 3 中，替换：

```
sublime-text-2 $request # Launch ST2 
```

和：

```
subl $request # Launch ST3 
```

...并且不要忘记在第 1 步中添加您自己的用户名：

```
Exec=/home/<your_user>/bin/sublime-handler %u 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-27T13:30:30.240

我没有评论的声誉，但我想补充一下已接受的答案，您还需要配置浏览器以使用新的打开 txmt 文件`~/bin/sublime-handler`

我将我的处理程序保存在 中`/usr/bin`，顺便说一句，它也可以工作。

要配置 Firefox：

1.  转到编辑 > 首选项 > 应用程序或在 URI 字段中输入以下内容 `about:preferences#applications`
2.  搜索`txmt`
3.  在`txmt`条目上单击操作字段并浏览您的 sublime-handler 文件

# r - 如何为数据框动态分配名称？

> ID：14676983
> 
> 赞同：3
> 
> 时间：2013-02-03T20:32:34.140
> 
> 标签：r

我正在尝试进行网络搜索，该搜索将根据邮政编码返回几个数据帧（不同大小）。我想将每个搜索结果转储到以邮政编码命名的数据框中。

```
require(XML)
zip <- c(zip1, zip2, zip3, etc)
k <-4        #index for the table that needs to be retrieved

for (i in 1:length(zip)) {
url <- paste(text1, zip[i], text2, sep="")
resultsdataframe <- data.frame (readHTMLTable(url), which = k)
} 
```

所以我的问题是：如何为结果数据帧获取不同的名称，每个名称都是从 zip[i] 动态命名的？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:39:20.397

您可以使用`sapply`，它会为您分配名称。

```
sapply(zip, function(x)
{
  url <- paste(text1, x, text2, sep="")
  data.frame (readHTMLTable(url), which = k)
} 
```

例如

```
zip <- paste('zip',1:5, sep ='')
ll <- sapply(zip, function(x)
   {
     data.frame ()
   })

ll
$zip1
data frame with 0 columns and 0 rows

$zip2
data frame with 0 columns and 0 rows
.... 
```

无需使用`assign`. 您可以像这样访问您的列表

```
ll[['zip1']]
data frame with 0 columns and 0 rows 
```

# c# - 如何检查 NotifyIcon 是否隐藏

> ID：14676988
> 
> 赞同：4
> 
> 时间：2013-02-03T20:33:08.320
> 
> 标签：c#, .net, windows, system-tray, trayicon

我不想强制它可见，我只想检查它是否被 Windows 隐藏。

默认情况下，Windows 会隐藏系统图标（操作中心、电池、网络、声音、日期和时间）以外的托盘图标。

![在此处输入图像描述](../Images/3b84db5779703404553e1b436a195ac7.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2021-07-16T13:16:33.677

我使用函数[Shell_NotifyIconGetRect](https://docs.microsoft.com/en-us/windows/win32/api/shellapi/nf-shellapi-shell_notifyicongetrect)，并获取返回值来检查 NotifyIcon 是否被隐藏。

当`NotifyIcon`未隐藏时（在可见托盘部分），该函数将返回零。当`NotifyIcon`被隐藏时，函数将返回 0x00000001 表示`Incorrect function`. 这真的很hack，我不知道为什么。这是一个例子：

```
bool isIconHidden = false;
int hresult = Shell_NotifyIconGetRect(ref nid, out rect);

if (hresult == 0)
{
    isIconHidden = false;
}
else if (hresult == 0x00000001)
{
    isIconHidden = true;
}
else
    throw new Win32Exception(hresult); 
```

有关 Shell_NotifyIconGetRect 函数使用的更多详细信息，请参阅[通知图标位置](https://www.quppa.net/blog/2010/12/08/windows-7-style-notification-area-applications-in-wpf-part-2-notify-icon-position/)和[确定托盘图标的位置](https://stackoverflow.com/questions/4366449/determining-location-of-tray-icon)。但我不确定该解决方案是否适用于所有 Windows 平台。我的操作系统是 Win10 系列。希望对你有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T22:10:45.870

@Hans 说没有直接的方法可以找到，这是不幸的（但有道理）。

您仍然可以尝试间接找出答案。您可以[拍摄桌面](https://stackoverflow.com/questions/5292700/efficiently-acquiring-a-screenshot-of-the-windows-desktop)位图的快照，找到任务栏（我认为在 Windows 7 中它不能从底部移动，我不确定）并寻找您的图标。如果你找到它——它就在那里。

# javascript - 发生错误时如何继续执行javascript

> ID：14676989
> 
> 赞同：2
> 
> 时间：2013-02-03T20:33:30.810
> 
> 标签：javascript, wordpress, halt

我使用 WP 原生函数 wp_enqueue_script() 在 WP 前端和后端加载我的所有脚本，以便它可以处理对同一脚本的重复调用等等。

其中一个问题是其他程序员不使用这个函数，而是直接从他们的代码中加载他们的脚本，这会导致 jQuery 或 jQuery-UI 被加载两次，从而导致一堆错误。

另一个问题是不属于我的代码会触发错误并在此之后停止 JavaScript 的执行。

简而言之：

Javascript 错误发生在不属于我的代码中。
由于该错误，我的代码无法执行。
我希望我的代码绕过该错误并仍然执行。
有没有办法处理这些问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-06T22:12:22.397

```
function ShieldAgainThirdPartyErrors($) {
    // Code you want protect here...
}

// First shot.
// If no error happened, when DOMContentLoaded is triggered, this code is executed.
jQuery(ShieldAgainThirdPartyErrors);

// Backup shot.
// If third party script throw or provoke an unhandled exception, the above function 
// call could never be executed, so, lets catch the exception and execute the code.
window.onerror = function () {

    ShieldAgainThirdPartyErrors(jQuery);

    return true;
} 
```

如果您想在必要时扣动您的扳机两次；）设置一个标志以表示第一次射击成功并避免备用射击，我认为在某些情况下，即使第三方代码进入，您的第一次射击也可以执行麻烦并触发第二枪。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T00:21:24.857

完全不推荐，但您可以使用：

```
try {  
  //Some code likely to throw an error  
} catch (err) {} 
```

这将允许之后的任何内容继续运行，尽管您通常也应该捕获错误。我不会捕获错误的唯一情况是使用数组并在`somearray[i-1]`小于`i-1`0 的情况下进行操作。这只是因为它比使用条件来防止它更干净。

# php - 在 php 中使用 strstr 作为布尔检查是什么意思？

> ID：14676990
> 
> 赞同：3
> 
> 时间：2013-02-03T20:33:42.420
> 
> 标签：php, boolean, strstr

例如给定代码：

```
if(strstr($key, ".")){
    // do something
} 
```

strstr 返回一个字符串，如何将其用作布尔值？它是如何变成真或假的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T20:35:06.223

这是一个例子

```
 <?php
 $email  = 'name@example.com';
 $domain = strstr($email, '@');
 echo $domain; // prints @example.com

 $user = strstr($email, '@', true); // As of PHP 5.3.0
 echo $user; // prints name
 ?> 
```

**定义：**

该`strstr()`函数在另一个字符串中搜索第一次出现的字符串。此函数返回字符串的其余部分（从匹配点开始），如果未找到要搜索的字符串，则返回 FALSE。

```
 strstr(string,search) 
```

`string`----> 必填。指定要搜索的字符串

`search`----> 必填。指定要搜索的字符串。如果该参数是一个数字，它将搜索与数字的 ASCII 值匹配的字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:35:50.343

引用[PHP 文档](http://php.net/manual/en/function.strstr.php)：

> 返回字符串的一部分，如果没有找到 needle，则返回 FALSE。

所以布尔检查基本上是，是否`.`找到了子字符串（在这种情况下）。

此函数可以返回的任何其他值都是非空字符串，它将被评估为真（请参阅文档中的[此条目](http://php.net/manual/en/types.comparisons.php)。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-03T20:45:25.510

这很简单：在 if 语句中，当我们有一个空值（例如非空字符串）时，这是真的。例如：

```
if("test") { //this is true
}

$value = "test";
if($value) { //this is true
}

$value = 3;
if($value) { //this is true
} 
```

另一方面，当您有一个空变量时，在 if 语句中它的行为就像 false。例如：

```
$var = 0;
if($var) { //this is false
}

$var = false;
if($var) { //this is false
}

$var = "";
if($var) { //this is false
} 
```

所以在你的情况下，你有：

```
$key = "test.com"
$val = strstr($key, "."); //Return ".com" 

if ($val) { //This is not a non empty string so it is true
}

$key = "justtest"
$val = strstr($key, "."); //Return boolean false so it is false

if ($val) { //This is returning boolean false
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-03T20:46:40.267

strstr 的返回值要么是布尔值（false）要么是字符串，那么

```
$strstr = strstr($key, '.');
if(is_string($strstr)){
 echo 'is found';
}

or 

if($strstr === false){
 echo 'not found';
} 
```

注意： is_bool($strtsr) 也可以使用，因为字符串不会被强制转换为 bool (true)

```
echo is_bool('test') ? 'true' : 'false'; //false 
```

# javascript - 在屏幕外的文本上使用 javascript 替换

> ID：14676994
> 
> 赞同：5
> 
> 时间：2013-02-03T20:34:17.710
> 
> 标签：javascript, replace, off-screen

假设我有很长的文本，例如

*Lorem ipsum dolor sit amet, consectetur adipiscing elit。在发酵 purus eu ipsum gravida sagittis。Curabitur auctor、enim vitae accumsan viverra、tellus massa cursus diam、posuere mattis turpis metus a risus。Quisque eu nisl nulla，id fringilla velit。Aenean tincidunt accumsan odio quis rhoncus。Cras molestie cursus tincidunt。Phasellus lectus lectus，pellentesque nec tempor nec，hendrerit et nulla。Nunc blandit porttitor Tellus。Phasellus vulputate diam dui。Mauris eget elit diam。Sed m​​ollis 前庭 mi，quis fringilla urna tempor non。*

假设从

*Cras molestie cursus tincidunt。Phasellus lectus lectus，pellentesque nec tempor nec，hendrerit et nulla。Nunc blandit porttitor Tellus。Phasellus vulputate diam dui。Mauris eget elit diam。Sed m​​ollis 前庭 mi，quis fringilla urna tempor non。*

文本不在屏幕上 - 您需要滚动才能看到它。我想`.replace()`在屏幕外的所有文本上使用 javascript，在这种情况下以“Cras molestie”等开头。我无法知道哪些文本是屏幕外的，哪些不是，所以我可以' t 只是修改 HTML。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-23T00:13:15.790

这个问题很老，但我发现它很有趣；

我做了一个简单的例子，只显示屏幕区域中的部分文本，在用户需要的文本中导航，使用箭头键（向上或向下）。

示例代码：

```
<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.0.0-beta1/jquery.min.js"></script>
</head>
<body>
    <style>
        body{
            font-size: 40px;
        }
        #content{
            float: left;
        }
        #full_content{
            float: left;
            visibility: hidden;
            display: none;
        }
    </style>
<div id="content" >

</div>
<div id="full_content" >
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce erat purus, sollicitudin quis metus sit amet, ultrices hendrerit arcu. Nulla maximus pharetra tincidunt. Phasellus tincidunt semper sem tempus dapibus. Pellentesque ligula nibh, eleifend ut dictum sed, aliquam et orci. Curabitur tempor augue non turpis elementum imperdiet quis vel tortor. Quisque nec rutrum justo. Praesent scelerisque dignissim nisi. Etiam et gravida mi.

Pellentesque dolor sapien, imperdiet nec convallis non, dictum a arcu. In hac habitasse platea dictumst. Mauris consectetur ultrices nibh nec vestibulum. Etiam maximus, nunc in euismod bibendum, neque ex iaculis nisl, eu finibus velit turpis vitae lacus. Etiam feugiat accumsan viverra. Vivamus turpis libero, molestie at eleifend et, ultrices ut tellus. Donec ipsum tortor, sagittis in aliquet eget, ullamcorper hendrerit erat. Praesent nec mi finibus, malesuada ex et, commodo tortor. Maecenas justo mi, posuere ut laoreet egestas, pretium sit amet est. Curabitur orci tortor, rutrum eu tristique a, ullamcorper vitae augue. Aenean condimentum erat vitae ex semper bibendum. In hac habitasse platea dictumst. Ut ullamcorper quis magna at gravida. Integer eu commodo neque, sit amet ullamcorper nisi. Nullam magna nulla, faucibus a suscipit in, vulputate eu nulla.

Phasellus sit amet bibendum erat. Etiam maximus id lorem vel porttitor. Sed quis nibh feugiat, ultricies neque non, porta turpis. Donec viverra lacinia risus vitae vulputate. Fusce tincidunt luctus sem, tempus lobortis urna cursus a. Suspendisse egestas magna sit amet mattis fermentum. Sed tempor, ligula vel tincidunt efficitur, neque nisi faucibus purus, congue iaculis urna sem tincidunt sapien. Fusce aliquet euismod neque, id aliquam diam posuere id. Praesent aliquet orci id tincidunt pellentesque. Vivamus id metus id erat convallis dapibus. In fermentum nulla ex, vitae pulvinar diam semper eu. Donec sagittis purus eget maximus rhoncus. Curabitur laoreet arcu magna, vel luctus arcu auctor vitae.

Fusce aliquam ex felis, sed fringilla nisi finibus id. Sed porttitor arcu mauris, a semper mi ultrices in. Nam rutrum sem sed sagittis dictum. Donec massa tortor, tempor gravida neque sed, sagittis ultrices augue. Donec fringilla, augue eget semper fermentum, tellus dui rutrum nisi, vel lobortis eros diam at velit. Maecenas tellus dui, aliquet vitae placerat id, sollicitudin eget dui. Duis blandit est ac diam eleifend, vel dictum tortor tempor. Sed eu nulla ut nunc blandit euismod id ac nibh. Morbi massa nisi, aliquam nec ornare in, vulputate sit amet lorem. Duis cursus est quis porta blandit. Pellentesque ultricies convallis convallis. Vivamus tincidunt nisl sed purus lacinia, sagittis placerat magna vestibulum. Aliquam at ornare risus, non tempus justo. Etiam in elit pellentesque, interdum ipsum vitae, facilisis nibh.

Sed eu quam justo. Sed lobortis justo nec quam cursus fringilla. In iaculis, augue vitae bibendum mollis, urna mauris fermentum tortor, in feugiat nunc augue imperdiet ipsum. Quisque arcu enim, blandit sed odio non, feugiat egestas mi. Nunc sodales erat vitae turpis condimentum placerat nec et quam. Ut ipsum lorem, auctor in fermentum eu, commodo quis nisi. Nulla quis tincidunt sem, sit amet malesuada diam. Nam sagittis maximus magna, eget aliquet dui semper pretium. Morbi varius leo non ipsum semper, ac bibendum neque gravida. Phasellus sapien lectus, pretium eget ligula at, elementum tincidunt diam. Nam quis tincidunt tortor. Vivamus a fringilla tellus. Cras elementum ultricies ipsum, non lobortis massa elementum vel.

Phasellus ligula dolor, laoreet in nibh non, dictum vehicula dolor. Donec eu vulputate tellus, at mattis dui. Etiam et diam sed tellus tincidunt malesuada. Praesent congue tristique lectus, sed auctor mauris. Proin nibh mi, gravida id tempus quis, feugiat in tortor. Mauris lobortis diam erat, ut accumsan quam lobortis sed. Sed mollis tellus et eros porttitor consequat. Quisque ultricies lorem a mollis ornare. Vivamus sit amet velit eget neque mattis egestas id sit amet erat. Quisque eleifend libero urna, in dictum lacus vulputate sit amet. Duis pellentesque elementum tortor, ut cursus nunc convallis a. Proin interdum nibh gravida, suscipit metus eget, dignissim nisi.

Praesent dapibus enim sit amet diam viverra lobortis. Nullam nec placerat mauris. Sed velit nibh, dignissim quis rhoncus sed, fermentum non turpis. Quisque congue enim finibus orci venenatis, sed dignissim ligula tempus. Donec finibus id sapien a elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec ultricies sed justo a tincidunt. Nullam vulputate finibus mauris. Praesent tincidunt id nisi eu rhoncus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vehicula velit diam, eu pellentesque risus elementum ut.

Donec ut hendrerit purus. Fusce pulvinar sem nec turpis commodo tempus. Nam id maximus velit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Sed sodales finibus dictum. Phasellus fermentum placerat condimentum. Phasellus porta sit amet sem bibendum malesuada. In hac habitasse platea dictumst. Nunc sit amet est egestas, luctus lectus eu, eleifend lorem. Duis nec nisi orci. Quisque venenatis blandit neque rutrum porttitor. Nullam eget ultricies risus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec felis risus, efficitur eget pellentesque a, tincidunt non lectus. Donec a cursus est.

Fusce commodo ligula non imperdiet congue. Proin vitae pharetra odio. Vestibulum tempor felis vel mi convallis, non aliquet ipsum pharetra. Quisque lectus odio, ultricies vitae porttitor ac, consequat elementum est. Nam blandit mauris ante, nec placerat nunc vulputate id. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Curabitur semper felis ligula, a posuere nulla viverra a. Aliquam vel massa consectetur, dictum nisi quis, volutpat libero. In suscipit, urna sed varius elementum, tortor nulla consequat enim, ut sodales mauris turpis vitae augue.

Mauris at nulla nibh. Donec nec semper augue, in efficitur quam. Nullam tortor tellus, lobortis ac gravida congue, posuere ac eros. Praesent et dolor sit amet mi fermentum interdum. Aenean ligula nunc, vulputate et maximus nec, scelerisque eu diam. Vivamus pellentesque quis odio vitae cursus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam interdum luctus porta. Ut fermentum, lacus eu placerat finibus, quam sem pellentesque purus, vel placerat libero elit aliquet eros. Donec a libero vel eros bibendum consequat et et lectus. Etiam congue suscipit finibus. Nam tristique, sapien a pulvinar convallis, enim metus maximus dui, vel laoreet ligula dolor vitae justo. Phasellus blandit odio nulla, sit amet elementum diam volutpat fermentum. Suspendisse non blandit purus.

Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce erat purus, sollicitudin quis metus sit amet, ultrices hendrerit arcu. Nulla maximus pharetra tincidunt. Phasellus tincidunt semper sem tempus dapibus. Pellentesque ligula nibh, eleifend ut dictum sed, aliquam et orci. Curabitur tempor augue non turpis elementum imperdiet quis vel tortor. Quisque nec rutrum justo. Praesent scelerisque dignissim nisi. Etiam et gravida mi.

Pellentesque dolor sapien, imperdiet nec convallis non, dictum a arcu. In hac habitasse platea dictumst. Mauris consectetur ultrices nibh nec vestibulum. Etiam maximus, nunc in euismod bibendum, neque ex iaculis nisl, eu finibus velit turpis vitae lacus. Etiam feugiat accumsan viverra. Vivamus turpis libero, molestie at eleifend et, ultrices ut tellus. Donec ipsum tortor, sagittis in aliquet eget, ullamcorper hendrerit erat. Praesent nec mi finibus, malesuada ex et, commodo tortor. Maecenas justo mi, posuere ut laoreet egestas, pretium sit amet est. Curabitur orci tortor, rutrum eu tristique a, ullamcorper vitae augue. Aenean condimentum erat vitae ex semper bibendum. In hac habitasse platea dictumst. Ut ullamcorper quis magna at gravida. Integer eu commodo neque, sit amet ullamcorper nisi. Nullam magna nulla, faucibus a suscipit in, vulputate eu nulla.

Phasellus sit amet bibendum erat. Etiam maximus id lorem vel porttitor. Sed quis nibh feugiat, ultricies neque non, porta turpis. Donec viverra lacinia risus vitae vulputate. Fusce tincidunt luctus sem, tempus lobortis urna cursus a. Suspendisse egestas magna sit amet mattis fermentum. Sed tempor, ligula vel tincidunt efficitur, neque nisi faucibus purus, congue iaculis urna sem tincidunt sapien. Fusce aliquet euismod neque, id aliquam diam posuere id. Praesent aliquet orci id tincidunt pellentesque. Vivamus id metus id erat convallis dapibus. In fermentum nulla ex, vitae pulvinar diam semper eu. Donec sagittis purus eget maximus rhoncus. Curabitur laoreet arcu magna, vel luctus arcu auctor vitae.

Fusce aliquam ex felis, sed fringilla nisi finibus id. Sed porttitor arcu mauris, a semper mi ultrices in. Nam rutrum sem sed sagittis dictum. Donec massa tortor, tempor gravida neque sed, sagittis ultrices augue. Donec fringilla, augue eget semper fermentum, tellus dui rutrum nisi, vel lobortis eros diam at velit. Maecenas tellus dui, aliquet vitae placerat id, sollicitudin eget dui. Duis blandit est ac diam eleifend, vel dictum tortor tempor. Sed eu nulla ut nunc blandit euismod id ac nibh. Morbi massa nisi, aliquam nec ornare in, vulputate sit amet lorem. Duis cursus est quis porta blandit. Pellentesque ultricies convallis convallis. Vivamus tincidunt nisl sed purus lacinia, sagittis placerat magna vestibulum. Aliquam at ornare risus, non tempus justo. Etiam in elit pellentesque, interdum ipsum vitae, facilisis nibh.

Sed eu quam justo. Sed lobortis justo nec quam cursus fringilla. In iaculis, augue vitae bibendum mollis, urna mauris fermentum tortor, in feugiat nunc augue imperdiet ipsum. Quisque arcu enim, blandit sed odio non, feugiat egestas mi. Nunc sodales erat vitae turpis condimentum placerat nec et quam. Ut ipsum lorem, auctor in fermentum eu, commodo quis nisi. Nulla quis tincidunt sem, sit amet malesuada diam. Nam sagittis maximus magna, eget aliquet dui semper pretium. Morbi varius leo non ipsum semper, ac bibendum neque gravida. Phasellus sapien lectus, pretium eget ligula at, elementum tincidunt diam. Nam quis tincidunt tortor. Vivamus a fringilla tellus. Cras elementum ultricies ipsum, non lobortis massa elementum vel.

Phasellus ligula dolor, laoreet in nibh non, dictum vehicula dolor. Donec eu vulputate tellus, at mattis dui. Etiam et diam sed tellus tincidunt malesuada. Praesent congue tristique lectus, sed auctor mauris. Proin nibh mi, gravida id tempus quis, feugiat in tortor. Mauris lobortis diam erat, ut accumsan quam lobortis sed. Sed mollis tellus et eros porttitor consequat. Quisque ultricies lorem a mollis ornare. Vivamus sit amet velit eget neque mattis egestas id sit amet erat. Quisque eleifend libero urna, in dictum lacus vulputate sit amet. Duis pellentesque elementum tortor, ut cursus nunc convallis a. Proin interdum nibh gravida, suscipit metus eget, dignissim nisi.

Praesent dapibus enim sit amet diam viverra lobortis. Nullam nec placerat mauris. Sed velit nibh, dignissim quis rhoncus sed, fermentum non turpis. Quisque congue enim finibus orci venenatis, sed dignissim ligula tempus. Donec finibus id sapien a elementum. Interdum et malesuada fames ac ante ipsum primis in faucibus. Donec ultricies sed justo a tincidunt. Nullam vulputate finibus mauris. Praesent tincidunt id nisi eu rhoncus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Etiam vehicula velit diam, eu pellentesque risus elementum ut.

Donec ut hendrerit purus. Fusce pulvinar sem nec turpis commodo tempus. Nam id maximus velit. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Sed sodales finibus dictum. Phasellus fermentum placerat condimentum. Phasellus porta sit amet sem bibendum malesuada. In hac habitasse platea dictumst. Nunc sit amet est egestas, luctus lectus eu, eleifend lorem. Duis nec nisi orci. Quisque venenatis blandit neque rutrum porttitor. Nullam eget ultricies risus. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec felis risus, efficitur eget pellentesque a, tincidunt non lectus. Donec a cursus est.

Fusce commodo ligula non imperdiet congue. Proin vitae pharetra odio. Vestibulum tempor felis vel mi convallis, non aliquet ipsum pharetra. Quisque lectus odio, ultricies vitae porttitor ac, consequat elementum est. Nam blandit mauris ante, nec placerat nunc vulputate id. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Curabitur semper felis ligula, a posuere nulla viverra a. Aliquam vel massa consectetur, dictum nisi quis, volutpat libero. In suscipit, urna sed varius elementum, tortor nulla consequat enim, ut sodales mauris turpis vitae augue.

Mauris at nulla nibh. Donec nec semper augue, in efficitur quam. Nullam tortor tellus, lobortis ac gravida congue, posuere ac eros. Praesent et dolor sit amet mi fermentum interdum. Aenean ligula nunc, vulputate et maximus nec, scelerisque eu diam. Vivamus pellentesque quis odio vitae cursus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam interdum luctus porta. Ut fermentum, lacus eu placerat finibus, quam sem pellentesque purus, vel placerat libero elit aliquet eros. Donec a libero vel eros bibendum consequat et et lectus. Etiam congue suscipit finibus. Nam tristique, sapien a pulvinar convallis, enim metus maximus dui, vel laoreet ligula dolor vitae justo. Phasellus blandit odio nulla, sit amet elementum diam volutpat fermentum. Suspendisse non blandit purus.

</div>
    <script>
        var index = 0;
        function cutText(index) {
            if (!index) index = 0;
            if(index < 0) index = 0;
            //var width = window.screen.width;
            var text = document.getElementById("full_content");
            var fontSize = getComputedStyle(text).getPropertyValue("font-size").replace("px", "");
            var doc = document.documentElement;
            var width = document.documentElement.clientWidth;
            var height = document.documentElement.clientHeight;
            var strText = text.textContent;
            //calculate text length for screen
            var charMaxWidth = 10;
            var maxChars = (Math.ceil(width / (fontSize / 3)) * Math.ceil(height / fontSize)) / 2;

            var startCut = index;
            if (index > 0) {
                startCut = index * maxChars;
                //startCut = index + maxChars;
            }
            //Check if the next cut not contains an empty string
            if(strText.slice(startCut,  startCut+maxChars).length == 0){
                index--;
                startCut = index * maxChars;
            }
            //only permit if the startCut be less of strTextLength
            if(startCut < strText.length){
                var content = document.getElementById("content");
                content.innerHTML = strText.slice(startCut,  startCut+maxChars) + "...";
                console.log(startCut,maxChars);
            }
        }
        window.onload = function(){
            cutText(0);
        }
        window.onkeydown = function(e){
            //Navigate bt code
            if(e.keyCode == 38){
                cutText(index--);
            }
            if(e.keyCode == 40){
                cutText(index++);
            }
        };
    </script>
</body>
</html> 
```

你可以在这里看到结果：[https ://jsfiddle.net/hmr9d35h/](https://jsfiddle.net/hmr9d35h/)

# android - 如何在android中获取相机中的触摸位置

> ID：14676996
> 
> 赞同：1
> 
> 时间：2013-02-03T20:34:38.037
> 
> 标签：android, video, image-processing, touch, android-camera

我是 Java 和 Android 开发的初学者。我遵循了Android“Hello word”和在线视频录制教程。现在我了解了如何创建应用程序。现在我试图在我的视频录制过程中获得一个触摸位置（x，y 坐标），我想返回触摸位置以供以后的图像处理。我该怎么做？我应该把我的触摸位置代码放在哪里？如果有人可以帮助我，我将不胜感激。

# java - Java 内存可见性和 AtomicReference 的

> ID：14676997
> 
> 赞同：4
> 
> 时间：2013-02-03T20:34:46.897
> 
> 标签：java, memory, concurrency, visibility

注意：：这个问题与内存可见性有关，而不是“公共”、“私人”等。

可以说我有以下课程：

```
public class Data {
    public final byte[] array;
    public final int offset, length;
    public Data(byte[] array, int offset, int length) {...}
    ...
} 
```

（上述数组中的元素可以通过未显示的方法进行更改。）

现在假设我在另一个类中有一个包含给定数据的队列：

```
final ConcurrentLinkedQueue<Data> queue = new ConcurrentLinkedQueue<>(); 
```

现在假设我在带有队列的类中有以下代码：

```
Data data = queue.poll();
... code for reading the elements in the data object. 
```

我的问题是：**在轮询队列之前设置的数组中的元素是否保证对从队列中轮询数据的线程可见？**

我知道队列轮询之后设置的元素对读者是不可见的，我只对队列轮询之前设置的元素感兴趣。

如果不是，我的理解是在调用 poll 方法之后放置的以下代码将确保数组的可见性

```
data = new Data(data.array, data.offset, data.length); 
```

因为对象构造确保对象字段的完全可见性。它是否正确？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-03T20:39:58.993

[文档](http://docs.oracle.com/javase/6/docs/api/#MemoryVisibility)说：

> java.util.concurrent 及其子包中所有类的方法将这些保证扩展到更高级别的同步。尤其：
> 
> 在将对象放入任何并发集合之前的线程中的操作发生在另一个线程中从集合中访问或删除该元素之后的操作。

所以是的，您可以保证看到在将对象存储到队列之前已设置的数组中的值。（我假设您在将 te 数组存储到此处的队列后不会修改一次）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T20:44:00.933

在对象构造之后，最终字段保证可见且正确。注意：这不会扩展到那些字段引用的对象。即 byte[] 可能不一致（但我怀疑它会在大多数 JVM 上）

有一个简单的解决方案是使用 ExecutorService。它不仅包装了一个队列和一个线程池，而且对 volatile 字段进行了足够的访问，以确保您的数据是正确的。

简而言之，保持简单，使用标准库，它更有可能工作。

# sencha-touch - 在 Sencha Touch 的视图中使用 getComponent？

> ID：14676998
> 
> 赞同：2
> 
> 时间：2013-02-03T20:34:57.217
> 
> 标签：sencha-touch, sencha-touch-2

我过去使用过以下内容：

Ext.getCmp("MyLabel") 访问视图中的项目。

但是，我决定使用“itemId”属性来命名我的组件，因为我正在使用内部具有相同基本标签的多个视图。

我希望能够创建一个类，该类提供一个设置标签文本的辅助方法。

由于标签将是 items 属性中的项目之一，我想通过容器或视图访问它，而不是使用 Ext.ComponentQuery 静态类。我不需要在 DOM 中搜索它，因为我知道它将是视图中的一个项目，因此性能应该更高。我试过使用：

```
view.getComponent("lblUserName")
view.getComponent("#lblUserName") 
```

我的标签的 itemId 属性设置为上面的位置。然而它只是返回'未定义'。

有没有办法在我的视图功能中从我的视图访问标签？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T20:36:43.477

怎么样

```
view.down("#lblUserName") 
```

我看到你说这`lbl`是一个直接后裔-这就是为什么`getComponent` *应该*工作-

`down`将搜索层次结构，直到匹配...值得一试。