# StackOverflow 问答 16082000-16082999

# objective-c - 延迟初始化objective-c后属性未设置

> ID：16082003
> 
> 赞同：1
> 
> 时间：2013-04-18T11:42:49.233
> 
> 标签：objective-c, properties, boolean, lazy-initialization

我有一个 BOOL 属性，一开始这个属性等于 NO。我想在我的程序开始时将此属性设置为 YES，但有机会切换它。为此，我做了这个吸气剂：

```
-(BOOL)turn
{
    if(!_turn)
        _turn = YES;
    return _turn;
} 
```

这个 getter 将我的 turn 属性设置为 YES，但它使其“恒定”，始终为 YES。为什么？

我想

```
if(!_turn) 
```

构造特别是出于您要设置“尚未设置”对象值的原因

你能回答我为什么会这样吗？以及如何将我的属性值设置为我想要的值。谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T11:49:46.780

看看你的行动表：

```
转：假真
!turn turn = YES 什么都不做

```

什么时候`_turn`是假的，你把它翻转得太真了。当`_turn`为真时，你什么也不做（没有 else 语句）。然后你返回 的值`_turn`。所以，是的，你在所有情况下都返回 true。

老实说，设计不是很好。如果要将变量的初始值设置为某个值，请在`init`方法中执行此操作。然后提供另一种简单地切换值的方法：

```
-(BOOL) toggleTurn {
  _turn = !_turn;
  return _turn;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T11:50:00.603

通常惰性初始化技术与指向对象的指针一起使用，而不是与原始类型一起使用。这是因为*BOOL*只有两种可能的状态：*NO*和*YES*，没有通常与对象的*nil*相关联的“未定义状态” 。

它不切换的原因是你没有切换它，你只是在它等于*NO时将它设置为**YES ，但是当它等于**YES*时你没有处理这种情况。如果您想切换它，只需执行以下操作：

 **```
-(BOOL)turn
{
    return _turn= !_turn;
} 
```

**PS**：谁能争辩说您的方法不是正确的吸气剂，因为您在返回之前更改了变量。所以我建议只返回 _turn 而不切换它，并创建另一个单独的方法来切换变量。

另外我想提一下，你所做的不叫惰性初始化，我给你看一个惰性初始化的例子：

```
// In the interface:
@property(nonatomic,readonly) NSNumber* turnObject;
// In newer compiler versions it should be auto synthesized to _turnObject

// In the implementation: 
-(BOOL) turn
{
    // In this case I am not toggling it
    if(!_turnObject)        // Equal to if(turnObject==nil)
        _turnObject= @(NO); // Equal to _turnObject=[NSNumber numberWithBOOL: NO];
    return _turnObject;
} 
```**

# java - 如何识别 Tenured Space

> ID：16082004
> 
> 赞同：5
> 
> 时间：2013-04-18T11:42:59.367
> 
> 标签：java, memory, garbage-collection

我想构建一个 MemoryWarningSystem ，如许多​​文章中所述：例如[http://www.javaspecialists.eu/archive/Issue092.html](http://www.javaspecialists.eu/archive/Issue092.html)。

因此，我想像这样识别终身空间：

```
 private MemoryPoolMXBean findTenuredGenPool() {
        for (MemoryPoolMXBean pool : ManagementFactory.getMemoryPoolMXBeans()) {

                 if(pool is tenured space)
                    return tenured

        }
    } 
```

我见过两种不同的方法来识别终身空间

1.  检查池名称是否等于“PS Old Gen”和/或“Tenured Gen”。
2.  检查是否“ `pool.getType() == MemoryType.HEAP && pool.isUsageThresholdSupported()`”

**问题 1**：CMS Old Gen 怎么样？那么其他终身职位呢？我应该将它们都添加到终身姓名列表中吗？

**问题 2**：这是检索终身空间的“安全”方式吗？它可靠吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:56:13.683

对于 HotSpot JVM，旧空间的可能内存池名称

*   `Tenured Gen`
*   `PS Old Gen`
*   `CMS Old Gen`
*   `G1 Old Gen`

对于 JRockit

*   `Old Space`

# c - libuv - 如何使用二进制协议

> ID：16082005
> 
> 赞同：0
> 
> 时间：2013-04-18T11:43:00.360
> 
> 标签：c, protocols, binary-data, libuv

当通过简单的二进制协议进行通信时，我有客户端-服务器应用程序。当四个字节是数据长度 [datasize] 和 datasize 的数据块大小时，二进制协议有 12 个字节的头（见代码）。

```
struct header {
    int32_t message_type;
    int32_t message_id;
    int32_t data_size;
}; 
```

数据流：

* * *

标题 | 数据 | 标题 | 数据 |

* * *

如何通过 libuv 从客户端接收二进制数据？你知道 libuv 处理二进制数据协议的例子吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T06:40:55.250

`libuv`调用后使用异步事件通知新数据到达`uv_read_start`。因此，您可以在回调函数中从客户端获取二进制数据块，例如`void data_callback(uv_stream_t *, size_t, uv_buf_t)`.

接下来您需要做的就是将二进制数据块组合到高层协议。您可以为每个客户端设置一个状态机，为其提供数据块，然后在协议包完成时将包发送到更高层。

我有一个与您类似的协议解析示例。它是一个基于`libuv`. 协议解析模块在这里：[package.h](https://github.com/NetEase/libpomelo/blob/master/include/pomelo-protocol/package.h)和[package.c](https://github.com/NetEase/libpomelo/blob/master/src/package.c)。希望对你有帮助。:)

# c++ - 进行循环分析的最佳方法

> ID：16082012
> 
> 赞同：0
> 
> 时间：2013-04-18T11:43:28.713
> 
> 标签：c++, c, loops, profiling, profiler

我必须更改一个在一个函数内有很多循环的 C/C++ 程序。我必须添加 cuda 功能。

在我开始进行更改之前，我想花时间检查所有找到的循环。但我没有找到任何能做到这一点的分析程序。最好的方法是什么。我在linux上。如果您有任何解决方案，请告诉我。

在这里你会找到一个工具的例子，它可以制作我想要的东西，但我没有找到它或类似的东西：[http ://carbon.ucdenver.edu/~dconnors/papers/wbia06-loopprof.pdf](http://carbon.ucdenver.edu/~dconnors/papers/wbia06-loopprof.pdf)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:34:22.177

我会使用[`gperftools`](http://code.google.com/p/gperftools/?redir=1), 并找出代码大部分时间花在哪里。一旦你确定了一个函数或函数的一部分，你可能就完成了。准确了解函数中哪些指令是“最重的”将需要针对该特定循环长时间运行测试用例，以便分析器可以为循环中的每条指令（或至少大多数指令）获取足够的数据。但是，如果您想用另一种技术替换代码，实际上分析到指令可能并不相关——替换几行代码的一个循环不太可能有太大帮助，因为开销太大。相反，您想占用更大的块并将其移至 CUDA。

# c++ - 我怎样才能把它分成2个功能

> ID：16082014
> 
> 赞同：2
> 
> 时间：2013-04-18T11:43:41.013
> 
> 标签：c++

我想知道是否有人可以帮助我用一种更优雅的方式来编写我正在编写的程序。我的代码如下，我想知道是否有办法将打印总计的部分分离成一个新函数。我试过了，但我总是得到总数为 0，所以我一定是传递了错误的东西。

```
void printNumbers(int x, double y, double z, double v, int sum, double sum2,int sum3,int sum4){
while(x != 0){
    y = sqrt (x);
    z = pow (x,2);
    v = pow (x,3);
    sum = sum + x;
    sum2 = sum2 + y;
    sum3 = sum3 + z;
    sum4 = sum4 + v;
    cout << "       " << x << setw(12)  << setprecision (4) << y << setw(8) << z <<   setw(8) << v << endl;
    x--;
}
cout << "       total is" << sum << setw(12) << sum2 << setw(8)<< sum3 << setw(8) << sum4 <<    endl;
} 
```

这是我尝试过的，当时我只有一个总数，但它仍然没有工作，只是给出了答案 0：

```
void printFooters(int sum){

cout << " " << "====================================="<< endl;
   cout << "Totals " << sum << endl << endl;
cout << " " << "====================================="<< endl;
} 
```

这就是我在 main() 中调用它的方式：

```
printFooters(sum); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T11:50:15.450

如果要更新总和，则需要将总和作为参考。

```
void printNumbers(int x, double y, double z, double v, int& sum, double& sum2,int& sum3,int&  sum4) 
```

如果您不按值传递总和，那么您只需获得总和当前值的副本。

或者，您可以使用指向总和的指针，但这将涉及在访问总和变量时更改语法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:11:00.400

您应该首先决定输入哪些变量以及应该输出哪些变量。尽量不要对输入和输出都使用一个变量，这通常比有价值更令人困惑。

只有输入值是 x。其他一切都是输出值。在您使用该值的方式中，值的内容仅在函数 printNumbers() 内的本地副本中被修改。他们会在功能结束时迷路。我希望您想从函数输出计算结果（但是 printNumbers 是该函数的错误名称）。

C 和 C++ 总是按值将变量传递给函数参数。这意味着，变量是从参数初始化的，但任何更改都只能在函数内部完成。在函数结束时，副本被丢弃，并且不会更改您传递给它的任何内容。

如果你想从函数中输出，你可以使用 return，或者使用指针或对变量的引用。我建议在 C++ 中使用引用，它们更容易理解和使用。

在函数中使用引用而不是复制的变量。然后，当您在函数内部修改该值时，它将在函数返回后保留修改后的值。

```
void f1(int in, int out)
{
  out = in + 1;
}

void f2(int in, int &out)
{
  out = in + 1;
}

int o1=-1, o2=-1;
f1(1, o1);
f2(1, o2);

cout << o1 << "," << o2 << endl; // will print -1,2 
```

因此，将您的函数声明为： void printNumbers(int x, double &y, double &z, double &v, int &sum, double &sum2,int &sum3,int &sum4);

然后你可以这样做：

```
double y,z;
int sum, sum2, sum3, sum4;
printNumbers(4, y, z, sum, sum2, sum3, sum4);
printFooters(sum); 
```

而这一次，它应该打印计算出的任何 printNumbers。请参阅[http://www.cprogramming.com/tutorial/references.html](http://www.cprogramming.com/tutorial/references.html)了解更多信息，或使用 google。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:51:43.207

您可以将所有这些参数批处理到结构中，并将所有计算和输出分开。
在您的情况下，这可能是矫枉过正，并且是相当多的代码，但无论如何......

```
struct Powers
{
    double sqroot;
    int one;
    double square;
    double cube;
};

Powers calculatePowers(int x)
{
    Powers powers;
    powers.sqroot = sqrt(x);
    powers.one = x;
    powers.square = x * x;
    powers.cube = x * x * x;
    return powers;
}

struct Sums
{
    int sum1;
    double sum2;
    int sum3;
    int sum4;
};

Sums addPowers(Sums sums, Powers powers)
{
    sums.sum1 += powers.one;
    sums.sum2 += powers.sqroot;
    sums.sum3 += powers.square;
    sums.sum4 += powers.cube;
    return sums;
} 

void printPowers(Powers powers)
{
        cout << "       " << powers.one 
             << setw(12)  << setprecision (4) << powers.sqroot 
             << setw(8)   << powers.square
             << setw(8)   << powers.cube 
             << endl;    
}

void printTotals(Sums sums)
{
    cout << "       total is" 
         << sums.sum1 
         << setw(12) << sums.sum2 
         << setw(8)  << sums.sum3 
         << setw(8)  << sums.sum4 
         << endl;    
}

void doEverything(int x)
{
    Sums sums = {0, 0, 0, 0};
    while (x > 0)
    {
        Powers powers = calculatePowers(x);
        printPowers(powers);
        sums = addPowers(sums, powers);
        x--;
    }
    printTotals(sums);
} 
```

# php - 根据设定的概率选择用户

> ID：16082020
> 
> 赞同：0
> 
> 时间：2013-04-18T11:43:51.827
> 
> 标签：php, mysql, arrays, probability

我的数据库存储有关用户、他们的组和关系的信息。users 表中的一列 ,`fcount`跟踪每个用户在其当前组中的关系数；它从 0 开始，我会在适当的时候增加它。
我需要编写一个脚本来选择给定组中的所有用户，然后随机选择其中一个用户，被选中的概率取决于一个人拥有的关系数量；更少的关系意味着更大的可能性。

目前，我使用以下代码完成此操作，减去概率部分：

```
$query = "SELECT uid FROM users WHERE groupid=:gid AND status='1'";
...
while ($row = $stmt->fetch(PDO::FETCH_NUM)) {
    $friends[] = $row[0];
}

foreach ($users as $value) {
    $key = array_search($value, $friends);
    unset($friends[$key]);
    shuffle($friends);
    $newrel = end($friends);
    $user = $value;
    $friends[] = $value;

    $query = "UPDATE users SET rel=:newrel WHERE uid=:uid";
    $query_params = array(':newrel' => $newrel, ':uid' => $user );
... } 
```

我认为调整概率的最简单方法是编辑`$friends`数组，以便用户多次出现。因此，具有`fcount`0 的用户将在数组中重复 5 次，具有`fcount`1 的用户将重复 3 次。[也许这不是处理它的最佳方式，但它对我来说很有意义并且符合我已有的代码。您可以自由提供更好的方案。]

我还没有弄清楚如何获取用户数组并将应该相乘的用户的条目相乘。

```
SELECT uid, fcount FROM users WHERE groupid=:gid AND status='1'; 
```

返回反映此表的数组：

```
+-----+--------+
| uid | fcount |
+-----+--------+
| 105 |      3 |
| 106 |      2 |
| 107 |      0 |
| 108 |      0 |
| 109 |      1 |
+-----+--------+ 
```

然后变成这样的数组：

```
array(15) { 
[0]=> string(3) "105" 
[1]=> string(3) "106" 
[2]=> string(3) "107" 
[3]=> string(3) "107" 
[4]=> string(3) "107" 
[5]=> string(3) "107" 
[6]=> string(3) "107" 
[7]=> string(3) "108" 
[8]=> string(3) "108" 
[9]=> string(3) "108" 
[10]=> string(3) "108" 
[11]=> string(3) "108"
[12]=> string(3) "109" 
[13]=> string(3) "109" 
[14]=> string(3) "109" 
} 
```

* * *

在我看来，这可以通过根据循环中的 if 语句`foreach`将每个用户 ID *n*次推送到新数组中来完成。我会尝试构建它，即使我可能会失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T13:45:04.387

```
$problist = array();
foreach ($row as $value) {
    if ($value['fcount'] == 0) {
        array_push($problist, $value['uid'], $value['uid'], $value['uid'], $value['uid'], $value['uid']);
    } elseif ($value['fcount'] == 1) {
        array_push($problist, $value['uid'], $value['uid'], $value['uid']);
    } elseif ($value['fcount'] >= 2) {
        $problist[] = $value['uid'];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:49:31.113

在一般情况下计算概率的最简单方法

```
$relations = 10;
$chance = rand(1,100);
if ($chance <= $relations) {
// success
} 
```

在这种情况下，关系越多，概率就越大，就像如果 $relations = 99，你将有 99% 的概率点击这个用户，关系 = 99

# jquery - 在上传之前计算文件的校验和（md5 或 sh1）并使用 uploadify jquery 插件将哈希发送到服务器

> ID：16082021
> 
> 赞同：0
> 
> 时间：2013-04-18T11:43:54.530
> 
> 标签：jquery, file-upload, md5, uploadify

我想在请求中添加并发送一个变量，即“Md5ofFile”，每个文件正在上传。

并再次在服务器上验证“Md5ofFile”是否与服务器上接收的文件的哈希相同，否则向客户端发送错误消息

提前致谢

# java - 如何在 IBM Lotus Notes 插件中捕获“发送邮件”

> ID：16082023
> 
> 赞同：0
> 
> 时间：2013-04-18T11:43:56.413
> 
> 标签：java, eclipse-plugin, lotus-notes, lotus-domino

这是我想要做的：添加一个特殊按钮以将文件附加到 Notes“新消息”窗口。如果使用此按钮附加文件，则在发送电子邮件时，应将它们上传到服务器并将指向它们的链接添加到电子邮件中。

我的问题 - 是否有可能（以及如何）在 Lotus Notus 的插件中捕获“发送邮件”事件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:06:57.193

我不知道 Eclipse 插件如何做到这一点。此外，由于 Notes 可以离线使用——当不可能将文件上传到服务器时——最好让运行在 Domino 服务器上的代码截获邮件消息并执行上传。

大多数在服务器上挂钩邮件操作的产品使用 Lotus Notes C API 的扩展管理器函数来挂钩 EM_NSFNOTEUPDATE 事件的 EM_BEFORE 通知，并检查 NSFNoteUpdate 操作是否发生在服务器的 mail.box 文件中，然后检查邮件是否需要特殊处理（即，在您的情况下，将通过查找您的按钮代码已插入到消息中的特殊 NotesItem）。通常的编码方法是立即更改消息的状态以将其暂停，防止 Domino 路由器在您的代码仍在处理消息时尝试发送消息。许多产品实际上有两个组件 - EM 挂钩 DLL 和一个单独的服务器任务，它接收来自挂钩 DLL 的信号，处理消息，然后将其从保持状态释放。这种方法可以防止您的代码在处理大文件时占用路由器线程。

（注意：较新版本的 Domino 服务器能够使用用 Java 编写的 OSGI 插件，而不是使用 Notes C API 进行此类操作。我还没有研究过这对于处理邮件消息的操作可能如何工作的详细信息. )

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-28T08:46:04.357

我有点想通了。8.5 中提供了一个非常好的扩展点 - “com.ibm.notes.mailsend.MailSendAttachmentsDialog”，专门用于自定义处理附件。您可以在 plugin.xml 中的 IBM\Lotus\Notes\framework\shared\eclipse\plugins\com.ibm.notes.mailsend_8.5 中看到它。*** .jar。

唯一的问题是 - 它只处理附件而无法访问其他任何内容。因此，如果有人想出如何从那里获取主题行和消息文本，请回复。

更新：明白了。

```
NotesUIElement elem = (new NotesUIWorkspace()).getCurrentElement();
if (elem instanceof NotesUIDocument) {
NotesUIDocument doc = ((NotesUIDocument) elem);
String to = doc.getField("EnterSendTo").getText();
String cc = doc.getField("EnterCopyTo").getText();
String bcc = doc.getField("EnterBlindCopyTo").getText();
String subject = doc.getField("Subject").getText();
String body = doc.getField("Body").getText();
    ....
 } 
```

# javascript - 如何在 IE 中隐藏部分 javascript

> ID：16082026
> 
> 赞同：5
> 
> 时间：2013-04-18T11:44:03.913
> 
> 标签：javascript, jquery, internet-explorer

这是我打开 jquery 对话框的 javascript 函数。

```
 ('#dialog').append(iframe).appendTo("body").dialog({
          autoOpen: false,
          modal: true,
          resizable: false,
          show: 'slide',        
          width: 800,       
          height: 700,        
         close: function() {           
    }   
});             
$('#dialog_click').click("callback",function() {            
   $('#dialog').dialog('open');                 
   return false;
}); 
```

如何`show: 'slide,`从 IE 中隐藏该部分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T11:47:07.903

```
var options = {
          autoOpen: false,
          modal: true,
          resizable: false,       
          width: 800,       
          height: 700,        
         close: function() {           
    }   
};
if ( ! $.browser.msie){
  options ['show'] = 'slide';
}

$('#dialog').append(iframe).appendTo("body").dialog(options); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T11:47:31.380

```
$('#dialog').append(iframe).appendTo("body").dialog({
          autoOpen: false,
          modal: true,
          resizable: false,       
          width: 800,       
          height: 700,        
         close: function() {           
    } 
});

if(!$.browser.msie) {
     $( "#dialog" ).dialog( "option", "show", "slide" );
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T11:47:24.447

尝试这个

```
if ( ! $.browser.msie){
  $( "#dialog" ).dialog( "option", "show", "slide" )
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-18T12:45:17.133

有几种解决方法（整个脚本的*条件注释*，稍后更改属性等），但没有人发布完全符合您要求的解决方案：**仅在`IE`**.

然后看看这个：

```
 ('#dialog').append(iframe).appendTo("body").dialog({
          autoOpen: false,
          modal: true,
          resizable: false,

        /*@cc_on @*/
        /*@if (true)

        @else @*/
          show: 'slide',        
        /*@end @*/

          width: 800,       
          height: 700,        
         close: function() {           
    }   
});             
$('#dialog_click').click("callback",function() {            
   $('#dialog').dialog('open');                 
   return false;
}); 
```

`IE`不会包含`show: 'slide',`，而`non-IE`浏览器不会读取**`Conditional Compilation Statements`**，因此条件将落在（未注释的）else 部分。

阅读有关[条件编译语句的更多信息](http://msdn.microsoft.com/en-us/library/7kx09ct1%28VS.80%29.aspx)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-18T11:58:26.970

jquery 已从 >= 1.9 版本中删除了对 jQuery.browser.msie 的支持

所以

```
var opts = {
    autoOpen : false,
    modal : true,
    resizable : false,
    show : 'slide',
    width : 800,
    height : 700,
    close : function() {
    }
};
if (!/msie/.test(window.navigator.userAgent)) {
    opts.show = 'slide';
}

('#dialog').append(iframe).appendTo("body").dialog(opts);
$('#dialog_click').click("callback", function() {
    $('#dialog').dialog('open');
    return false;
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T11:50:41.707

您可以做几件事。

首先有条件注释，即

```
<!--[if !IE ]>
    <script>
       $('#dialog').append(iframe).appendTo("body").dialog({
         autoOpen: false,
         modal: true,
         resizable: false,
         show: 'slide',        
         width: 800,       
         height: 700,        
         close: function() {           
         }   
       });             
       $('#dialog_click').click("callback",function() {            
         $('#dialog').dialog('open');                 
         return false; 
       }); 
    </script>
<![endif]--> 
```

或者您可以检查 jquery browser variable ，正如其他人所指的那样。

此外，如果您采用这种方式，并且您真的想针对旧版本的 IE，您可以使用一些特定于它的功能（例如 attachEvent ）

# symfony - Symfony 2找不到映射实体的主键

> ID：16082030
> 
> 赞同：0
> 
> 时间：2013-04-18T11:44:15.423
> 
> 标签：symfony, doctrine-orm

我遇到了一个映射实体的主键没有被学说检测到的问题。

我有 2 个表，用户和操作员。用户和运营商之间存在单向的多对一关系。

用户实体定义为

```
XXX\SecurityBundle\Entity\User:
    type: entity
    repositoryClass: XXX\SecurityBundle\Repository\UserRepository
    table: XXX_USER
    id:
        id: 
            type: integer
            unsigned: false
            nullable: false
            column: ID
            generator:
                strategy: AUTO
    fields:
        username:
            type: string
            length: 32
            nullable: false
            column: USERNAME
...
    manyToOne:
        operator:
            targetEntity: XXX\CoreDataBundle\Entity\Operator
            joinColumn:
            name: operator_id
            referencedColumnName: id 
```

运营商实体定义为

```
XXX\CoreDataBundle\Entity\Operator:
    type: entity
    respositoryClass: XXX\CoreDataBundle\Repository\OperatorRepository
    table: OPERATORS
    id:
        id:
            type: integer
            unsigned: false
            nullable: false
            column: ID
            generator:
                strategy: AUTO
    fields:
        operName:
            type: string
            length: 32
            nullable: false
            column: OPERATOR_NAME 
```

验证架构时，我收到以下错误：

*   引用的列名“id”必须是目标实体类“XXX\CoreDataBundle\Entity\Operator”上的主键列。

当我尝试将操作员分配给用户时，我收到以下错误：

[ErrorException]
注意：未定义的索引：id in vendor/doctrine/orm/lib/Doctrine/ORM/Persisters/BasicEntityPersister.php line
607

据我所见，“id”被设置为运营商实体的主键。教义背后的数据库是oracle，与实体定义同步，并且在数据库上正确设置了主键。

任何人都能够发现我在定义映射时的错误？

我不认为实体位于不同捆绑包中的事实是一个问题，因为我在同一个捆绑包中遇到了类似的问题。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-12-01T18:41:35.190

Oracle 的列名和表名总是大写的。因此，如果使用它们，您需要将 referencedColumnName 大写，即使在 PHP 端它是小写的。

# php - Javascript Facebook PHP - 发送通知

> ID：16082033
> 
> 赞同：0
> 
> 时间：2013-04-18T11:44:26.187
> 
> 标签：php, javascript, facebook, iframe

我想在每周一上午 10 点（cronjob）向所有使用我的应用程序的用户发送新一轮已经开始的通知。

问题是，它现在适用于 5-6 个测试用户，这很好，但是如果应用程序有超过 1000 个用户（例如）会发生什么。
我的主机将最大执行时间设置为 30 秒，我们无法修改它。

一种解决方案是，启动一个 php 脚本，其中我有一个 iframe 加载 send-php-script 范围为（例如）1-50 个用户，重新加载，然后加载 51-100，依此类推

我试图对其进行编码，但失败了。这是我的尝试：

```
 <script>
<?php
foreach($userids as $id) {
    ?>
    var url = 'cron_send_notify_iframe.php?id= + '<?php echo $id['userid'];?>' + &tabpageid= + '<?php echo $id['tabpageid'];?> ' + &token= + '<?php echo $appAccessToken?>;
    document.getElementById('iframe').src = url;
    <?php
    sleep(1);
}
?>              
</script>
<iframe width="271px" height="295px" frameborder="no" id="iframe" src=""></iframe> 
```

cron_send_notify_iframe.php 仅用于发送通知（适用于 uid）。

我想，我可以每秒发送一个通知。那会奏效吗？有更好的解决方案吗？也许给一个范围（$from - $to）并发送给他们......你怎么看？

# android - 使用多个 sqlite 表填充 ListView 及其详细视图

> ID：16082036
> 
> 赞同：0
> 
> 时间：2013-04-18T11:44:33.953
> 
> 标签：android, sqlite, android-layout, android-listview

目前我正在寻找一种解决方案，用来自 3 个不同 SQLite 表的内容填充 ListView。点击时，每个 ListView 项目（行）应显示相应的详细视图（活动），该视图基于三个 xml 布局之一。

有什么建议么？

编辑：

目前我为一种类型的 Object/SQLite 表解决了这个问题。从 SQLite 表中获取内容到 ArrayList 并通过 putExtra 将其传递给细节活动，该活动处理设置文本/内容。

listView 条目的匹配和启动相应的详细视图通过 arrayList 索引与 listView 索引匹配来解决。

我不确定这是否是一个适当的解决方案。估计不是...

```
public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

   Intent typeOne_details_intent = new Intent(this, TypeOneDetailActivity.class);
   typeOne_result = new TypeOneResult();
   typeOne_result = typeOneResult_arr.get(position); 
   typeOne_details_intent.putExtra("result", TypeOneResult);
   startActivity(typeOne_details_intent);
} 
```

如何解决这个问题以添加 typeTwoDetails 并在 listview 和根据 detailview 之间获得更好的匹配？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T16:00:51.423

您可以使用自定义适配器来确定要启动的活动，设置自定义行视图等。一种方法是，您可以创建行对象接口，并检查对象类型以确定行的布局并设置诸如onClick 侦听器和要启动的 Activity。

下面的快速示例：

```
public class CustomAdapter extends BaseAdapter<ListObjectInterface>{
...
ListObjectInterface data[];
....

public CustomAdapter(Context context, int layoutResourceId, ListObjectInterface[] data) {
    ...
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View row = convertView;
    ... /* do things. such as check if instance is present, etc. */

    ListObjectInterface object = data[position];

    if (object instanceOf TypeA) {
        row = inflater.inflate(layoutResourceIdA, parent, false);
        ...
        ... /* get View objects and set Button listener to launch Activity A */
    } else if (object instanceOf TypeB) {
        row = inflater.inflate(layoutResourceIdB, parent, false);
        ...
        ... /* get View objects and set Button listener to launch Activity B */
    } ... /* etc */

    ... /* more logic */

    return row;
}
} 
```

# c# - 如何清除动态添加的div内容，只显示div内容？

> ID：16082038
> 
> 赞同：1
> 
> 时间：2013-04-18T11:44:38.880
> 
> 标签：c#, javascript, jquery, asp.net, html

我的页面中有一个名为“BenefitsValue”的 div，显示设置为无。

```
<input id="Radio1" type="radio" name="bunit" value="1" onclick="onSample1()" 
       runat="server"/>Sample1
<input id="Radio2" type="radio" name="bunit" value="2" onclick="onSample2()" 
       runat="server"/>Sample2
<div id="BenefitsValue" style="display:none">
     <table id="approverTable">
          <tr id="rowtr" align="center">
              <td>
                 <input type="text" id="From" size="11" maxlength="9" 
                        class="gov-textbox" style="width: 100px;" />
               </td>
               <td>
                  <a id="addRangeLink" class="addRange" href="javascript:;" 
                     onclick="AddTextBox();">AddRange</a> 
               </td>
          </tr>
    </table>
 </div> 
```

我将通过单击 AddRange 动态添加多个文本框。

```
function AddRange() {
    var val = "";
    var oTable = document.getElementById('approverTable');
    var rowCount = oTable.rows.length;
    var row = oTable.insertRow(rowCount);
    var cell0 = row.insertCell(0);
    var innerhtml;
    cell0.innerHTML = '<input type="text" id="From' + rowCount
        + '"  size="11" maxlength="9" class="gov-textbox" style="width: 100px;" />';
    } 
```

如果我选择`radiobutton1`我将显示内容，我将通过单击 AddRange...`div`动态添加多个。`textboxes`

然后，一旦我选择`radiobutton2`它必须清除该`textboxes`div 的新添加并只显示我`text box`在 div 中指定的单个 ..

我曾经`$("#BenefitsValue").empty();`清除过内容，但是如果我再使用`$("#BenefitsValue").show()`它再次显示它，它什么也不显示...

如何克服它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T11:51:37.823

只需在单选按钮更改中进行回发。所以它会清除 JavaScript 添加的内容，并将默认内容添加到页面中。

或者为动态内容添加一个不同的类并按类名删除它们。

```
$('dynamic-class').remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:04:19.273

这个怎么样？

`**[Live Demo](http://jsfiddle.net/gU6Sg/1/)**`

**JS**

```
function AddRange() {
    var val = "";

    var oTable = document.getElementById('approverTable');

    var rowCount = oTable.rows.length;
    var row = oTable.insertRow(rowCount);
    row.className='dynamic';
    var cell0 = row.insertCell(0);
     var innerhtml;
    cell0.innerHTML = '<input type="text" id="From' + rowCount + '"  size="11" maxlength="9" class="gov-textbox" style="width: 100px;" />';
}

function onSample1(){
    $('#BenefitsValue').show();    
}

function onSample2(){
    $('.dynamic').remove();
} 
```

**HTML**

```
<input id="Radio1" type="radio" name="bunit" value="1" onclick="onSample1()" runat="server"/>Sample1
<input id="Radio2" type="radio" name="bunit" value="2" onclick="onSample2()" runat="server"/>Sample2

<div id="BenefitsValue" style="display:none">
    <table id="approverTable">
        <tr id="rowtr" align="center">
            <td>
                <input type="text" id="From" size="11" maxlength="9" class="gov-textbox"                                         style="width: 100px;" />
            </td>
            <td>
                <a id="addRangeLink" class="addRange" href="javascript:;" onclick="AddRange();">AddRange</a> 
            </td>
        </tr>
    </table>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T11:51:06.343

您是否试图从视图中隐藏元素？

```
$("#BenefitsValue").empty(); 
```

删除内容。相反，使用

```
$("#BenefitsValue").hide(); 
```

然后你可以`.show()`用来把它带回来

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T11:54:39.503

`<div>`您需要为动态添加的文本框创建不同的文本框。例如：

```
<table id="approverTable">
      <tr id="rowtr" align="center">
          <td>
             <input type="text" id="From" size="11" maxlength="9" 
                    class="gov-textbox" style="width: 100px;" />
           </td>
           <td>
              <a id="addRangeLink" class="addRange" href="javascript:;" 
                 onclick="AddTextBox();">AddRange</a> 
           </td>
           <td>
               <div id="dynamicallyAddedTextBoxesGoHere">
               </div>
           </td>
      </tr>
</table> 
```

将您的文本框添加到`$("#dynamicallyAddedTextBoxesGoHere")`. 然后在您的 javascript 中，您可以显示/隐藏此 div -

```
$("#dynamicallyAddedTextBoxesGoHere").hide();

$("#dynamicallyAddedTextBoxesGoHere").show(); 
```

# jquery - jQuery - Run a function when user has scrolled up 100px from current location

> ID：16082051
> 
> 赞同：0
> 
> 时间：2013-04-18T11:45:26.800
> 
> 标签：jquery, scroll

I am trying to run a function once the user has scrolled up 100px and another function when they scroll down (any number of pixels) from there current location. So if the user scrolls half way down a page and then starts to scroll up i need a function to run once they have scrolled up 100px from the current stored scrollTop value.

If the user was 700px down the page and they started to scroll up I need a function to run when they hit 600px. This should be dynamic from where ever the user is down the page.

As a starting point i have:

```
var lastScrollTop = 0;

$(window).scroll(function(event){
    var st = $(this).scrollTop();

    if (st > lastScrollTop){
        // Scrolling down
    } else {
        // Scrolling up
    }
    lastScrollTop = st;
}); 
```

Thanks

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T11:54:04.640

jsFiddle(http://jsfiddle.net/nick_craver/gWD66/1/)

试试这个链接。可能对你很有帮助

使用本准则

```
 <script type="text/javascript">
var position = $(window).scrollTop();
$(window).scroll(function() {
    var scroll = $(window).scrollTop();
    if(scroll > position) {
      moveCarDownward(scroll);  // $('#status').html('going down!');
    } else {
       moveCarUpward(scroll);  //$('#status').html('going up!');
    }
    position = scroll;
}); 
```

另一个链接 javascript[链接中的哪一个](http://jsfiddle.net/Aletheios/hWmNj/)

# clearcase - Get elements of a label which is present only in the current version but not in any other previous versions

> ID：16082053
> 
> 赞同：1
> 
> 时间：2013-04-18T11:45:54.260
> 
> 标签：clearcase

how do I get elements of a label which is present only in the current version but not in any other previous versions?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:10:01.627

这对于 ClearCase 是不可能的，考虑到标签只能与元素的*一个*版本相关联（“元素”是文件或目录）。

您可以尝试搜索仅应用于*一个*元素而不应用于任何其他元素的标签。

> 自上次集成分支以来，如何从当前分支获取标签的所有更改元素？

“[我怎样才能找到没有应用标签的最新版本的分支上的所有元素？](https://stackoverflow.com/a/5209923/6309) ”中描述的查询可能很有趣。

[此IBM 页面](http://www-01.ibm.com/support/docview.wss?rcss=faqtt_1Q09&uid=swg21124425)上还提供了更简单的查询：

### 查找所有具有给定标签但不在给定分支上的元素版本：

> 视窗：

```
cleartool find -all -version "lbtype_sub(MYLABEL) && !brtype(mybranch)" -print 
```

> UNIX 和 Linux：

```
cleartool find -all -version 'lbtype_sub(MYLABEL) && !brtype(mybranch)' -print 
```

# git - Prestashop Test/Production Server Best Practices

> ID：16082054
> 
> 赞同：6
> 
> 时间：2013-04-18T11:45:57.850
> 
> 标签：git, development-environment, prestashop, production-environment, dev-to-production

We have an eShop build on prestashop and we are developing new features every week. I'm writing here because I don't find the correct way to update our production environment with the changes, without having to upload all the code again or having to upload the modified files manually.

Now we work like this:

*   Our developers work with local copies connected to a GIT repo.
*   Once we have some new features and we want to create a new release I download the latest version from the repo and test it locally on another computer.

=> HERE comes the part that I don't like... :)

*   Once all the tests have been passed in my local copy we take all the files that have been modified (looking at the commits) and we upload them manually to the development environment.
*   We test it again and if it works we upload the same files to the production environment.

We have been thinking in linking both environments source files with the repo as well, but I don't link it because I don't want to have the .git folder published messing my production code.

I didn't find the way of having a tested copy of our code pushed at our GIT REPOSITORY and update the servers automatically, without having to upload the files manually or having to upload entire folders (themes, classes, etc...) via FTP.

Is there anybody working with prestashop and GIT and having a nice automated system to do all this? :)

Many thanks in advance!

Regards,

Jordi

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T14:08:39.450

Here is the workflow we use, it's (I guess) pretty standard:

*   one git repo
*   preprod domain
*   prod domain

All the development is done on branches, when it's ready to ship we merge on the master. So on the preprod we pull the branch we are working on, and on the production we only pull the master. The preprod and prod domain are on the same server, it's just a sub-domain with a htaccess to protect it.

We use this not only for Prestashop but for every thing, it works well.

For the part where you want to automatically pull the code, it must be possible (à la Heroku). But for me the most important is: you should git everywhere and forget about FTP. It's really easier and you're sure everything you need is updated.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-09T07:35:32.457

我认为您的回答也不正确:)

如果您在 Web 服务器上使用 apache，请检查此代码

这需要存在于您的 .htaccess 文件中

```
RewriteCond %{HTTP:Authorization} ^(.*)
RewriteRule . - [E=HTTP_AUTHORIZATION:%1] 
```

当然你需要有 .htpasswd 文件。

它的意思是任何名称以“。”开头的文件或文件夹。点，您需要先进行自动化，然后才能访问它。

在此处查看有关 Mod 重写的更多信息：[http ://httpd.apache.org/docs/2.2/rewrite/access.html](http://httpd.apache.org/docs/2.2/rewrite/access.html)

我认为它对你有用，Jordi。(Saludos de Bcn)

# c# - Can Directory.CreateDirectory make a folder accessible from one thread but not others?

> ID：16082056
> 
> 赞同：2
> 
> 时间：2013-04-18T11:46:09.583
> 
> 标签：c#, multithreading, directory

We have a list of the complete paths where we want to copy some files to, sort of like this

```
 C:\temp\sub1\file1A
 C:\temp\sub1\file1B
 C:\temp\sub2\file2A
 C:\temp\sub3\file3A
 C:\temp\sub3\file3B
 C:\temp\sub3\file3C
 etc.... 
```

There is some code that does this

```
for each file in the file list
    if (!Directory.Exists(dirName)
    {
        Directory.CreateDirectory(dirName)
    } 
```

And we can see from the logs that all the sub folders get created, and only 1 attempt is made for each sub folder - so the Directory.Exists is returning true after the first file in each sub folder has been through the above loop.

Then the code does something like

```
var fileDownloadActions = new List<Action>();

// populated the list with  GetFile(requiredInfo)

Parallel.Invoke(new ParallelOptions {MaxDegreeOfParallelism = 10},
                fileDownloadActions.ToArray()); 
```

And now here is the odd bit - most of the time this works just fine, however sometimes it fails with multiple DirectoryNotFoundExceptions - claiming it can't find the directories that have just been created!

Sometime it can't find any of the created sub folders, sometimes it works for some but not others.

Current working theory is that although the thread that created the folders thinks they are created (and the checks for Directory.Exists are returning true as no matter how many files we have in the folder we only try to create each folder once) they haven't been actually properly fully created on the OS and when we try to access them from the other threads it goes Bang!

Ever seen / heard of something like this before?

Is our working theory correct and if so what is the best way to fix this? (I'd rather not just put in a sleep!)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T13:10:17.837

这可以通过访问修改后的闭包来解释吗？

我想这取决于你的循环是什么样子，但从我所看到的情况来看，如果你要存储代表以供稍后执行，那么你可能没有得到你期望的 dirName 值。

查看“**捕获的变量**”部分下的[http://www.yoda.arachsys.com/csharp/csharp2/delegates.html 。](http://www.yoda.arachsys.com/csharp/csharp2/delegates.html)

# joomla - 是否可以在没有会话的情况下在 joomla 中设置用户参数？

> ID：16082057
> 
> 赞同：0
> 
> 时间：2013-04-18T11:46:14.940
> 
> 标签：joomla, joomla2.5

默认`JUser::setParam()`方法只为会话设置参数。是否有可能以某种方式存储不在会话中的参数，以便它们始终可用？我还在`users`表字段中找到`params`，它存储了当前用户的一些参数，但不知道如何在那里添加数据......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T11:45:55.733

添加参数后，您是否尝试过[保存](https://github.com/joomla/joomla-cms/blob/2.5.x/libraries/joomla/user/user.php#L715)对象？

```
$user = JFactory::getUser();
$user->setParam($key, $value);
$user->save; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:21:32.367

一种简单而舒适的方法是使用流行的[Community Builder](http://www.joomlapolis.com/community-builder) Extension，它允许您在管理员后端定义自定义用户字段。它有一个 API 来获取 CB 用户对象并写入和读取存储在数据库中的那些字段，而不是会话。简单示例，不知道您的 Joomla/CB 版本（适用于 Joomla 2.5 和 CB 1.8）以及应该执行的位置（站点、管理员、外部）（假设您的参数已命名`customParam`且用户 ID 为 42）：

```
cbimport( 'cb.field' ); 
$mosCbUser = CBUser::getUserDataInstance(42);

// read value
$customParameter = $mosCbUser->customParam;

// write value 
$mosCbUser->customParam = 'newnew';
$mosCbUser->store();

/* write value to DB directly with optional boolean third parameter 
specifing whether to trigger the user update plugins 
like onBeforeUserUpdate or onAfterUserUpdate
*/
$mosCbUser->storeDatabaseValue('cb_adresse', 'new address', false); 
```

一定要在 CB 插件上下文中，如果不是这样，包括例如

```
global $_CB_framework, $_CB_database, $ueConfig;
$app  = JFactory::getApplication();
include_once( $app->getCfg( 'absolute_path' ) . '/administrator/components/com_comprofiler/plugin.foundation.php' ); 
```

# php - 给一个愚蠢的数据类起什么名字？

> ID：16082059
> 
> 赞同：0
> 
> 时间：2013-04-18T11:46:16.253
> 
> 标签：php, object, symfony

我正在为我正在开发的应用程序编写一个非常简单的电子邮件 mime 解析器，并且认为创建一个愚蠢的数据类以作为“电子邮件”但作为对象是一个好主意。

这一切都很好，这对 SO 来说可能是一个可怕的问题，但唉，我还是在问。你会叫什么愚蠢的数据类？

当我在 Symfony 2.2 中编写项目时，我想使用“实体”这个词；尽管它是一个宽泛的术语，但由于在 DocTrine 中使用了实体，它没有多大意义并且可能引起混淆。那么，这种事情的术语是什么？只是为了存储数据并可能在其上使用方法（如实体）来格式化或检索其他信息位。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T11:49:10.660

怎么样称呼它（我们中间的德国人可以自由地使用 ROFL ;-)）：

POPO - 普通的旧 PHP 对象

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T11:49:11.133

如果您使用该类只是为了传递数据，那么在我看来，这是一个 DTO（来自 Java 的数据传输对象）。`EmailDto`所以可以工作是。
`Email`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T11:49:03.440

类的通用名称是对象、实体、事物、数据、类、处理程序等。不过，描述性名称确实可以避免混淆。YMMV

# c++ - QT based Win7 app can't cope with the death of an I/O device

> ID：16082060
> 
> 赞同：0
> 
> 时间：2013-04-18T11:46:18.603
> 
> 标签：c++, windows, qt, serial-port, hung

I'm writing a QT based native c++ app that uses QtSerialPort library under Win7\. It communicates with it periodically(*say every 5seconds*).
Problem is: the device that my app connects to via serial port, has power loss issues(can't change this). When this happens my app becomes hung and immortal: can't be killed by windows task manager or by **process hacker**(*a nice replacement for windows task manager*)' termination facilities. Soft restart is the best solution at the hand.

Now how can my app cope with such device situation?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:21:51.017

我会将这个问题提交到 Qt 的兴趣邮件列表 (interest@qt-project.org)。由于 QtSerialPort 库是相当新的，所以当广泛的用户群开始使用它时可能会出现错误。编写该库的开发人员很有可能可以为您提供更好的解决方案，或者他们发现这是他们代码中的错误并修复它。

# ios - shouldSelectViewController not getting called

> ID：16082061
> 
> 赞同：4
> 
> 时间：2013-04-18T11:46:19.140
> 
> 标签：ios, uitabbarcontroller, uitabbar, appdelegate

I am trying to call my shouldSelectViewController Delegate function. But it doesnt seem to work.

I did the following, but still the function doesnt get called

# .h

```
@interface myAppDelegate : UIResponder <UIApplicationDelegate, UITabBarControllerDelegate>

@property (strong, nonatomic) UIWindow *window;

@end 
```

# .m

```
@implementation TakeFiveCameraAppDelegate

@synthesize window;

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{   
    UITabBarController *tabBarController = (UITabBarController *)self.window.rootViewController;
    tabBarController.delegate = (id)self;
    return YES;
}

- (BOOL)tabBarController:(UITabBarController *)tabBarController shouldSelectViewController:(UIViewController *)viewController {
    NSLog(@"test");
    return YES;
}

@end 
```

I am not sure what am I missing here.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-28T08:40:49.107

加入`viewDidLoad`

[自我设置委托：自我]；

# asp.net-mvc-4 - MVC4 WebAPI 拒绝无效的枚举值

> ID：16082062
> 
> 赞同：19
> 
> 时间：2013-04-18T11:46:28.080
> 
> 标签：asp.net-mvc-4, asp.net-web-api

如何使 JSON.NET / MVC 4 WebAPI 拒绝枚举没有成员的整数值？例如：

如果我有这个模型：

```
public enum Colour { Red = 1 };

public class Model
{
  public Colour Colour { get; set; }
}

Model Post(Model model)
{
   // model.Colour could be 99, 34234234, 0 etc, etc
} 
```

如果我发布`{ Color: 9999 }`，我最终会得到一个 model.Color = 999 的模型，而我想返回一个 Bad Request 状态代码。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2017-03-02T23:43:42.607

事实证明[EnumDataTypeAttribute](https://docs.microsoft.com/en-us/dotnet/core/api/system.componentmodel.dataannotations.enumdatatypeattribute)`System.ComponentModel.DataAnnotations`与命名空间中开箱即用的 ValidationAttributes 一起执行[Enum.Defined 检查](https://github.com/dotnet/corefx/blob/f64e71f762daf233523e6ac112bc8cb5c318e7af/src/System.ComponentModel.Annotations/src/System/ComponentModel/DataAnnotations/EnumDataTypeAttribute.cs#L106)。

一旦我将此属性应用于我的视图模型，超出范围的整数值验证失败：

```
public enum Color {Red = 1, Blue = 2}

public class Car
{
    [EnumDataType(typeof(Color))]
    public Color Color { get; set; }
} 
```

注意：由于枚举模型绑定的默认行为，可以解析为在枚举上定义的整数的值仍将通过验证。这意味着，例如，`true`将被解析为`1`，这对于这个枚举是有效的。我假设可以映射到整数的字符也可以工作。

如果您只希望一种枚举解析方式起作用，无论是字符串还是整数，请考虑在您的视图模型上使用该特定类型，然后编写一个`ValidationAttribute`接受枚举类型的自定义，验证您的视图模型上的字符串或整数匹配枚举中的值。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2013-04-18T13:50:15.263

一种选择是编写验证器：

```
public class ValidEnumValueAttribute : ValidationAttribute
{
    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        Type enumType = value.GetType();
        bool valid = Enum.IsDefined(enumType, value);
        if (!valid)
        {
            return new ValidationResult(String.Format("{0} is not a valid value for type {1}", value, enumType.Name));
        }
        return ValidationResult.Success;
    }
} 
```

用于：

```
public enum Color {Red = 1, Blue = 2}

public class Car
{
    [ValidEnumValue]
    public Color Color { get; set; }
} 
```

在控制器中，`ModelState.IsValid`将是`false`.
如果您真的想使请求失败，您也可以抛出一个`ValidationException`，但我*不太*确定应该如何使用它们。

# twitter - 403 error when trying to search twitter, Processing, Twitter4j, controlP5

> ID：16082067
> 
> 赞同：0
> 
> 时间：2013-04-18T11:46:35.973
> 
> 标签：twitter, processing, twitter4j

When executing a twitter query i get a 403 error, the error message is below, however my other queries work perfectly and are executed prior to this one, can anyone spot what may be wrong here:

> TWITTER EXCEPTION: TwitterException{exceptionCode=[f3acd3ed-00581fa3], statusCode=403, retryAfter=0, rateLimitStatus=null, version=2.1.5-SNAPSHOT(build: d372a51b9b419cbd73d416474f4a855f3e889507)}

this occurs when i execute a search from my app, im not overdoing the limits as i can execute my other searches perfectly its just this one, any help would be appreciated, the code is listed below. im using a combination of Twitter4j and Processing with controlP5 to handle the input like the search.

```
void setup(){
...
             cp5.addTextfield("SEARCH")
             .setPosition(30,20)
             .setSize(100,20)
             .setFocus(true)
             .setColor(color(255,0,0))
             .setGroup(g2)
             ;
}

      public void SEARCH(String theText) {
        qm.srch = true;
        qm.theText = theText;
        qm.userSearch();
        qm.srch = false;
        // automatically receives results from controller input
        println("a textfield event for controller 'input' : "+theText);
      }

  void userSearch() {
    try {
      if (srch) {
        ConfigurationBuilder cb9 = new ConfigurationBuilder();
        cb9.setOAuthConsumerKey("XXXXXXXXXXXXXXXXXXXXXX");
        cb9.setOAuthConsumerSecret("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXx");
        cb9.setOAuthAccessToken("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX");
        cb9.setOAuthAccessTokenSecret("XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX");
        println("Connected");
        Twitter twitter = new TwitterFactory(cb9.build()).getInstance();
        Query srchh = new Query(theText2);

        srchh.setRpp(5);
        QueryResult srchhRes = twitter.search(srchh);
        ArrayList srchhTwe = (ArrayList) srchhRes.getTweets();
        for (int i = 0; i < srchhTwe.size(); i++) {

          Tweet t = (Tweet) srchhTwe.get(i);
          String user = t.getFromUser();
          GeoLocation l = t.getGeoLocation();
          String locNam = t.getLocation();
          String msg = t.getText();
          wholeTweetsL.add(msg);
          println("\nMessage: " + msg);
          println("\nLocation: " + locNam);
        }
      }
    }
    catch(TwitterException e) {
      println("TWITTER EXCEPTION: " + e);
    }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:33:15.660

来自推特[https://dev.twitter.com/docs/error-codes-responses](https://dev.twitter.com/docs/error-codes-responses)

403 Forbidden 请求被理解，但已被拒绝或不允许访问。随附的错误消息将解释原因。当由于更新限制而拒绝请求时使用此代码。

# android - Android Relativelayout two buttons rightof one button

> ID：16082068
> 
> 赞同：0
> 
> 时间：2013-04-18T11:46:40.417
> 
> 标签：android, android-relativelayout, android-xml

I was wondering how to use Relativelayout in order to make a tructure like this:

three buttons, let's call them A B and C; I want to put B and C one above the other and both of them on the right side of A as a single block matching the same width and height of A (so we'll have that B and C have half height of A but the same width).

Since I can't post images yet here you can find the image of what I'm looking for: [http://img191.imageshack.us/img191/9765/stackg.jpg](http://img191.imageshack.us/img191/9765/stackg.jpg)

The code I wrote about this part is this one:

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@android:color/black"
    android:paddingLeft="16dp"
    android:paddingRight="16dp" >

    <Spinner
        android:id="@+id/A"
        android:layout_width="0dp"
        android:layout_height="96dp"
        android:layout_below="@id/another_block_that_fills_all_the_line"
        android:layout_alignParentLeft="true"
        android:layout_toLeftOf="@+id/B" />

    <Spinner
        android:id="@id/B"
        android:layout_width="96dp"
        android:layout_height="48dp"
        android:layout_below="@id/another_block_that_fills_all_the_line"
        android:layout_alignParentRight="true" />

    <Spinner
        android:id="@id/C"
        android:layout_width="96dp"
        android:layout_height="48dp"
        android:layout_below="@id/B"
        android:layout_alignParentRight="true" />

</RelativeLayout> 
```

The problem is that it's not going to scale with every screen because I had to set static sizes. I tried a lot of different solutions like using all the possible combinations for the layout_align and changing wrap_content even randomly but still, I can't fit them in the way I want them to without using static sizes.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T11:54:47.163

`LinearLayout`与 一起使用`layout_weight`。试试这个布局

```
<LinearLayout android:layout_width="fill_parent" android:layout_height="wrap_content"
    android:orientation="horizontal">

    <Button android:layout_width="0dip" android:layout_height="fill_parent"
        android:layout_weight="1.0"/>

    <LinearLayout android:layout_width="0dip" android:layout_height="fill_parent"
        android:layout_weight="1.0" android:orientation="vertical">

        <Button android:layout_width="fill_parent" android:layout_height="0dip"
            android:layout_weight="1.0"/>

        <Button android:layout_width="fill_parent" android:layout_height="0dip"
            android:layout_weight="1.0"/>

     </LinearLayout>
</LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:02:34.117

尝试这个，

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@android:color/black">
    <Button
        android:id="@+id/A"
        android:layout_width="wrap_content"
        android:layout_centerInParent="true"
        android:layout_height="wrap_content"
        android:layout_alignTop="@+id/relativeLayout"
        android:layout_alignBottom="@+id/relativeLayout"
        android:text="AAA"/>
    <RelativeLayout
        android:id="@+id/relativeLayout"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/A"
        android:layout_centerVertical="true"
        android:background="@android:color/black">
        <Button
            android:id="@+id/B"
            android:layout_width="wrap_content"
            android:text="BBB"
            android:layout_height="wrap_content"/>
        <Button
            android:id="@+id/C"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_below="@id/B"
            android:text="CCC"/>
     </RelativeLayout>
</RelativeLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:03:49.267

它应该如下所示

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:gravity="center_horizontal"
android:padding="10dp" >
<View
    android:id="@+id/helper"
    android:layout_width="0dp"
    android:layout_height="0dp"
    android:layout_alignParentTop="true"
    android:layout_centerHorizontal="true" />
<Spinner
    android:id="@+id/A"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_toLeftOf="@id/helper"
    android:background="@android:color/black" />
<LinearLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@id/A"
    android:layout_alignParentRight="true"
    android:layout_alignTop="@id/A"
    android:layout_marginLeft="10dp"
    android:layout_toRightOf="@id/helper"
    android:orientation="vertical" >
    <Spinner
        android:id="@+id/B"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_marginBottom="2dp"
        android:layout_weight="1"
        android:background="@android:color/black" />
    <Spinner
        android:id="@+id/C"
        android:layout_width="wrap_content"
        android:layout_height="0dp"
        android:layout_weight="1"
        android:background="@android:color/black" />
</LinearLayout> 
```

# c# - How to add to ContextMenuStrip and ToolStrip same ToolStripButtons?

> ID：16082069
> 
> 赞同：2
> 
> 时间：2013-04-18T11:46:42.177
> 
> 标签：c#, winforms, contextmenustrip, toolstripbutton, toolstripmenu

I have tool bar in my app and context menu with the same options, so I want to add ToolStripButtons to both ContextMenuStrip and ToolStrip, unfortunately I can't do this. Even when I add manually items to both it shows only on one.

For now I have buttons in tool bar:

![](https://i.stack.imgur.com/sey8S.png)

I want something like this. I want this options to be one, because I will be often enable and disable this buttons and finally there is one option so why two buttons?

![](https://i.stack.imgur.com/g6rwJ.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-03T19:19:37.580

这是一个常见问题，我发现最简单的解决方案是将“共享”代码放在`MenuFeature`继承自`ToolStripMenuItem`.

您仍然需要创建该类的 2 个实例，但每个实例都非常轻量级，并且只有两种用法之间的差异的代码（即 ContextMenu 项可能使用`ToolStripItemDisplayStyle.ImageAndText`，而 ToolStrip 项可能使用`ToolStripItemDisplayStyle.Image`）。

这允许通用代码在您的自定义`MenuFeature`类中仅存在一次，但仍允许对该菜单项的每次使用进行本地更改。

如果您想自动同步 /etc 等属性`Enabled`，`Visible`您可以在构造函数中维护所有实例的静态集合，然后使用`EnabledChanged`/etc 等事件更新所有项目。但是，我建议不要这样做，因为我发现同一菜单“功能”的不同实例通常需要它们自己的状态 - 但这超出了这个问题的范围，那些对我如何管理项目感兴趣的人可以发表评论关于这个答案或 PM 我。

# vb.net - 如何以编程方式生成新的 MS 访问文件

> ID：16082071
> 
> 赞同：4
> 
> 时间：2013-04-18T11:46:45.263
> 
> 标签：vb.net, visual-studio-2010, ms-access, ms-access-2007

我在互联网最深最黑暗的角落里四处张望，但对于我的生活，我找不到正确的方法来打开一个新的 Access 文件，然后使用 vb.net 将数据写入数据库..

这里的关键字是新数据库，我不想打开现有文件。

这甚至可能吗？

提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T12:19:50.803

终于找到路了，多亏了我的一个同事

> ADO.NET 和 ActiveX 数据对象 (ADO) 都没有提供创建 Microsoft Access 数据库的方法。但是，我们可以使用 Microsoft Jet OLE DB Provider 和 Microsoft ADO Ext 创建 Access 数据库。2.7 用于具有 COM 互操作层的 DDL 和安全性 (ADOX)。为此，**从项目菜单中选择引用，选择 COM 选项卡，然后添加对 Microsoft ADO Ext 的引用。2.7 用于 DDL 和安全性**；那么你就可以使用这个功能了。

完成此操作后，使用以下代码段创建数据库

* * *

```
Public Class Form1

    Private Sub btnLoad_Click(ByVal sender As System.Object, _
                              ByVal e As System.EventArgs) _
                              Handles btnLoad.Click

        CreateAccessDatabase("C:\test\testDB.mdb")
        MsgBox("Database created")
    End Sub 
```

* * *

```
 Public Function CreateAccessDatabase( ByVal DatabaseFullPath As String) As Boolean
        Dim bAns As Boolean
        Dim cat As New ADOX.Catalog()
        Try

            Dim sCreateString As String
            sCreateString =_ 
                           "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & _
                           DatabaseFullPath
            cat.Create(sCreateString)

             bAns = True

        Catch Excep As System.Runtime.InteropServices.COMException
             bAns = False

        Finally
            cat = Nothing
        End Try
        Return bAns
    End Function
End Class 
```

* * *

# c# - Get excel sheet names using Getschema method without sorting

> ID：16082076
> 
> 赞同：0
> 
> 时间：2013-04-18T11:47:04.420
> 
> 标签：c#, asp.net, excel, oledb

I am inserting data into Sql table from excel sheet. `oledbConnection.GetSchema("Table_Name")` getting excel sheet names in sorted order. I dont want them to be sorted coz i want to get the first sheet in order to perform some operations on it. Here is my code snippet.

```
string con = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + excel +";Extended Properties=\"Excel 12.0;HDR=Yes;IMEX=2\"";
            OleDbConnection cn = new OleDbConnection(con);
            cn.Open();

            DataTable sheetTable = cn.GetSchema("Tables");
            string strSHeetName = Convert.ToString(sheetTable.Rows[0]["TABLE_NAME"]); 
```

any help would be highly appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-06T04:12:29.343

试试这个代码，这对我有用......

```
Microsoft.Office.Interop.Excel.Application xlApp = new Microsoft.Office.Interop.Excel.Application();
Microsoft.Office.Interop.Excel.Workbook excelBook = xlApp.Workbooks.Open(filePath); 
string[] excelSheets = new string[excelBook.Worksheets.Count];
int i = 0;
foreach(Microsoft.Office.Interop.Excel.Worksheet wSheet in excelBook.Worksheets)    
{
  excelSheets[i] = wSheet.Name;
  i++;
} 
```

*将“filePath”替换为您的文件位置路径...

# ruby-on-rails - ActiveRecord 属性依赖于其他模型的计算

> ID：16082077
> 
> 赞同：2
> 
> 时间：2013-04-18T11:47:07.117
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

这是我的场景：

```
class User < ActiveRecord::Base
  has_many :things
  # attr_accessible :average_rating
end

class Thing < ActiveRecord::Base
  belongs_to :user 

  has_one :thing_rating
end

class ThingRating < ActiveRecord::Base
  belongs_to :thing

  attr_accessible :rating
end 
```

我想在我的用户模型中有一个属性，该属性具有他相关 ThingsRating 的平均计算。

管理此问题的最佳做法是什么？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:02:37.970

可能你可以使用不确定的关系，但你可以试试这个

```
class User < ActiveRecord::Base
  has_many :things
  has_many :thing_ratings, through: :things

  # attr_accessible :average_rating

  def avg_rating
    @avg_rating ||= thing_ratings.average("thing_ratings.rating")
  end 
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T11:54:37.157

简单的方法：

```
class User < ActiveRecord::Base
  has_many :things

  def avg_rating
    @avg_rating ||= average(things.map(&:thing_rating))
  end

  private
  def average(values)
    values.inject(0.0) { |sum, el| sum + el } / arr.size
  end
end 
```

作为首发，这很好。但是，如果您有一点流量，您可能会发现自己遇到了扩展问题。

然后，您必须对其进行重构，以避免每次为不同的用户调用该方法时对事物进行 SQL 查询。
然后你可以有几个可能性：

*   在您的用户数据库中添加一个字段，该字段`avg_rating`将在`ThingRating`创建或更新时更新。
*   使用 memcached 或 redis 数据库来缓存值，并在每次`ThingRating`更新或创建 a 时使缓存失效。

当然，这些解决方案并不详尽。您可以找到其他更适合您需求的产品。

# perl - 无法在 Perl 中创建哈希？

> ID：16082081
> 
> 赞同：1
> 
> 时间：2013-04-18T11:47:14.137
> 
> 标签：perl, hash

我正在从[这里](http://www.perl.com/pub/2000/10/begperl1.html)学习 Perl 脚本。我在创建哈希时遇到问题。代码在这里：

```
print "Hello World!\n";
@days = ("1", "2");
print "There are $#days days\n";
print "1 is $days[0]\n";
%months = ("a" => 1, "b" => 2, "c" => 3);
print "There are $#months keys\n";
print "a is $months[0]\n";
for $i (keys %months)
{ print "$i has value $months[$i].\n"} 
```

现在它与数组一起工作正常。但是对于 Hash 它的打印“有 -1 个键”。此外，它不会为最后打印调用的变量值打印任何内容。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T11:51:18.640

您在哈希上使用数组语法，这根本不符合您的想法。您不是在您的哈希上操作，而是在一个名为`@months`. 例如：

```
print "There are $#months keys\n"; 
```

这将查找数组`@months`，看到它是空的，然后愉快地打印`-1`。

当你这样做

```
for $i (keys %months) { 
    print "$i has value $months[$i].\n"
} 
```

Perl 将尝试将键`a`和转换为数字，`b`即. 这将发出警告：`c``0`

```
Argument "a" isn't numeric in array element ... 
```

然后它将打印空数组元素`$month[0]`。这将发出未定义的值警告。您没有收到这些警告，因为您没有使用

```
use strict;
use warnings; 
```

在你的脚本中。`strict`会告诉您`@months`尚未声明，并立即停止此错误。

您应该使用的语法是：

```
print "There are " . (keys %months) . " keys\n";
...
print "$i has value $months{$i}\n"; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T11:55:54.850

在 Perl 中，访问散列中的元素使用与数组略有不同的语法。对散列使用花括号，对数组使用方括号：

```
print "a is $months{a}\n";  # "a is 1" 
```

并且`$#months`是另一种说法“@months 的最后一个索引”，当你真正的意思是计算键的数量时`%months`：

```
printf "There are %d keys\n", scalar keys %months; 
```

如果你坚持`print`而不是`printf`：

```
print "There are $#{[keys %months]} keys\n"; 
```

[（但也许它比你现在想要的位置提前了几步）]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T11:53:08.740

`$#months`并`$months[0]`引用数组而不是哈希。您可以使用花括号访问散列值`$months{key}`。

此外，您应该`use strict;`使用`my()`. 如果你这样做了，你会得到一个`@months`不存在的编译器错误。

# windows-7 - CFMail is not working in ColdFusion 10

> ID：16082082
> 
> 赞同：0
> 
> 时间：2013-04-18T11:47:20.887
> 
> 标签：windows-7, coldfusion, coldfusion-10, cfmail

I have a Windows 7 (32bit) pc and installed ColdFusion 10\. The `cfmail` tag is not working. It was working on ColdFusion 8.

Mail is going to the `ColdFusion10\cfusion\Mail\Undelivr` folder.

**(Update from comments)** In the mail log I am seeing:

> "Error","scheduler-0","04/18/13","17:29:13",,"javax.mail.AuthenticationFailedExc‌​eption: 535 No SMTP server defined. Use real server address instead of 127.0.0.1 in your account. "

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:40:07.893

查看您收到的错误，我的猜测是您尚未定义 ColdFusion 使用的 SMTP 服务器，因此它正在尝试通过您的 Windows 7 电脑路由邮件。您可以在 ColdFusion 管理员中为所有`cfmail`标签定义 SMTP 服务器设置。（您也可以在`cfmail`标签本身中定义设置。）

这是[ColdFusion 管理员下的邮件设置文档的链接](http://help.adobe.com/en_US/ColdFusion/10.0/Admin/WSc3ff6d0ea77859461172e0811cbf3638e6-7ffc.html#WSc3ff6d0ea77859461172e0811cbf364104-7ff7)。

在管理员中添加设置后，请务必选中“验证邮件服务器连接”选项。当您单击提交按钮时，这将为您测试连接。在您成功连接到 SMTP 服务器之前，您的邮件将无法工作。

# javascript - 无法替换 div 元素的类 - 没有名为 css 的方法

> ID：16082084
> 
> 赞同：0
> 
> 时间：2013-04-18T11:47:26.590
> 
> 标签：javascript, jquery

我想用 jQuery 替换旧的 html 元素类。这是我正在做的事情：

```
var elem = $('.my_selector')[0];
elem.css('class', 'my_new_class'); 
```

但我收到错误消息“未捕获的类型错误：`Object#<HtmlDivElement> has no method css`.

我如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T11:48:38.783

`$('.my_selector')[0]`正在返回一个 DOM 元素，而不是一个 jQuery 对象。您还需要使用`addClass`方法而不是`css`. 要获取第一个元素，可以使用`:first`伪选择器。

所以这应该是你正在寻找的：

```
$('.my_selector:first').removeClass('my_selector').addClass('my_new_class'); 
```

**编辑**您可以使用`removeClass`/`addClass`或`toggleClass`. 两者都很好。如果您有一个元素可以同时具有两个类的情况，那么显式添加新类可能会更安全，因为`toggleClass`这将删除这两个类。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T11:51:19.600

问题是您试图`css()`从 DOM 元素中调用 jQuery 方法（甚至在这里不相关），该元素是用`[0]`. 你可以[`toggleClass()`](http://api.jquery.com/toggleClass/)用来做这项工作：

```
$(".my_selector:first").toggleClass("my_selector my_new_class"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T11:48:32.617

```
var elem = $('.my_selector')[0]; 
```

这将返回 DOM 元素，而不是 jQuery 对象。只需将其更改为...

```
var elem = $('.my_selector'); 
```

要仅获取与选择器匹配的第一个元素，请使用此...

```
var elem = $('.my_selector').first(); 
```

还有，你有...

```
elem.css('class', 'my_new_class'); 
```

这是不正确的，应该改为这个......

```
elem.attr('class', 'my_new_class'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T11:50:48.290

尝试这个 ，

```
var elem = $(".my_selector");
elem.class("newclass"); 
```

否则你可以这样做，

```
var elem = $(".my_selector");
elem.removeClass("my_selector");
elem.addClass("newclass"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T11:57:17.120

```
$(".my_selector").removeClass('currentClass').addClass('newClass'); 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-04-18T11:52:13.953

如前所述，您需要第一个元素的 jquery 对象。一个好的方法可能是这样的：

```
$('.my_selector').first().css('class', 'my_new_class'); 
```

此外，方法签名的目的是`.css( propertyName, value )`设置一个 CSS 属性而不是更改一个类。为此，您需要删除旧类并`.removeClass`分别使用 和 添加新类`.addClass`。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-04-18T11:50:23.850

~~$($('.my_selector')[0]).css('class', 'my_new_class');~~

```
document.getElementsByClassName('my_selector')[0].className = 'my_new_class'; 
```

# c# - 在浏览器上显示文件

> ID：16082091
> 
> 赞同：0
> 
> 时间：2013-04-18T11:47:42.387
> 
> 标签：c#, asp.net-mvc, file, download

我想要两个链接来下载和查看文件

我可以直接下载文件。如果用户选择查看选项，我想在浏览器新选​​项卡中打开该文件。

我将如何在 asp.net mvc 中做到这一点？

对于下载，我有以下操作

```
public FileResult Document()
        {

           return File(filepath, contenttype,filename);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T11:52:31.207

您无法控制文件是在服务器的新选项卡还是现有选项卡中打开，这是通过`target`在链接定义上设置属性来控制的。

您可以通过设置内容类型来控制浏览器是否下载或尝试显示文件。

# asp.net-mvc - IIS 7.5 MVC4/.NET4.5 加载默认页面

> ID：16082094
> 
> 赞同：0
> 
> 时间：2013-04-18T11:47:50.890
> 
> 标签：asp.net-mvc, iis, asp.net-mvc-4, iis-7.5, asp.net-mvc-routing

... 其他所有内容（脚本、CSS、其他页面）都返回 404 错误。这适用于我在 IIS Express 下的 DEV 机器，所以我假设我错误地配置了 IIS 7.5，但我没有任何反应。因此，当我导航到该站点时，我得到的只是几行 HTML，没有样式或 javascript。看起来像是 90 年代的网页。

我有：

*   为运行集成 .NET 4 的应用程序设置我自己的应用程序池
*   确保 web.config`<modules runAllManagedModulesForAllRequests="true">`在`system.webServer`元素中
*   重新安装.NET 4.5
*   将 MVC4.0 运行时安装到 GAC

我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T12:01:24.100

所以事实证明，我的核心项目被设置为使用 .NET4 而不是 .NET4.5，这导致了这种情况。

# salesforce - POST 请求无法在 Salesforce 中接收 JSON 响应

> ID：16082098
> 
> 赞同：3
> 
> 时间：2013-04-18T11:47:58.763
> 
> 标签：salesforce, apex-code

我正在调用 FluidSurvey 的 API。当我发出 POST 请求时……它在 fluidSurvey 上发布请求，但我没有收到 JSON 响应。相反，它什么也不返回。有什么建议吗？？

我的控制器代码

```
public class fluidSurvey{

public String tst{set;get;}
public String result{get;set;}

public PageReference chk() {
    getData();
    return null;
}

public void getData(){
    String apiKey = 'xxxxxx';
    String pwd = 'xxxxxx';
    String u = 'https://app.fluidsurveys.com/api/v2/surveys/survey_id/responses/';

    HttpRequest req = new HttpRequest();
    Http http = new Http();
    HTTPResponse res;
    try{
        req.setEndPoint(u);
        req.setTimeout(2000);
        req.setMethod('POST');
        Blob headerValue = Blob.valueOf(apikey + ':' + pwd);
        String authorizationHeader = 'Basic '+ EncodingUtil.base64Encode(headerValue);
        req.setHeader('Authorization', authorizationHeader);
        req.setHeader('Content-Type', 'application/json');
        req.setHeader('Content-Length','31999');

        res = http.send(req); 
        tst= res.toString();

       catch(Exception e){
           System.debug('Callout error: '+ e);
           System.debug(tst+'--------'+res);
       }     
    }

} 
```

Apex 页面代码是

```
<apex:page controller="fluidSurvey">

<apex:form >
    <apex:pageBlock title="New Fluid Surveys API">
    <apex:outputText value="{!tst}"></apex:outputText><br/>
<apex:pageBlockButtons location="bottom">
    <apex:commandButton value="Submit" action="{!chk}"/>
</apex:pageBlockButtons>   
</apex:pageBlock>
</apex:form> 
```

和 api 文档链接是[http://docs.fluidsurveys.com/api/surveys.html#getting-a-list-of-surveys](http://docs.fluidsurveys.com/api/surveys.html#getting-a-list-of-surveys) ..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T14:46:01.360

FluidSurveys 开发人员在这里。

看起来您正在执行 POST 请求，根据文档，该请求用于创建新响应。但是您的函数名为 getData，所以我假设您想要获取响应列表？

将请求类型从 GET 更改为 POST，它应该开始工作。

此外，响应类型将为 application/json，但您不应将请求类型设置为该编码。

如果我弄错了并且您希望提交新的响应，那么此代码将不起作用，因为您实际上并没有传递任何内容。正如您在[http://docs.fluidsurveys.com/api/surveys.html#submitting-a-new-response](http://docs.fluidsurveys.com/api/surveys.html#submitting-a-new-response)看到的那样，您实际上需要传递问题 ID 和答案的字典。找出 id 是什么或格式是什么的最好方法是首先查看从 GET 请求返回的响应。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T09:19:34.627

我的代码的问题是我设置了内容长度标头，但没有设置任何正文，服务器正在努力等待 3199 字节的正文。所以在使用 setBody 方法后，我的代码正确地返回了一个 json 响应

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-19T16:37:15.650

我想补充一下这个答案，因为我发现由于入侵检测规则，来自 Apex 的一些消息被发布到外部端点被另一端的防火墙丢弃。

显然，在 Apex 端，出站消息不符合某些阻止中间人攻击的构造规则，并且某些防火墙或 IDS 正在阻止它们。这将在 Apex 端显示为“读取超时”。

具体的 IDS 规则是 CVE-2009-3555 ( [http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555](http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3555) )。

如果您在 Apex 中遇到对外部端点的读取超时并且无法将它们隔离到 apex 编程，您可能会在目标防火墙上进行一些日志记录以查看是否是问题所在，如果是，请在该防火墙中创建一个例外这种情况。

# objective-c - CFNotificationCenterRemoveObserver 观察者

> ID：16082100
> 
> 赞同：2
> 
> 时间：2013-04-18T11:48:04.450
> 
> 标签：objective-c, macos

在[参考文献中](http://developer.apple.com/library/mac/#documentation/CoreFoundation/Reference/CFNotificationCenterRef/Reference/reference.html)，我看到可以使用空观察者指针向通知注册观察者。但是，这两种删除方法都需要一个非 NULL 的有效指针值。当没有注册完成时，我该如何克服？

我还在这个答案示例中注意到[CFNotificationCenter 使用示例？](https://stackoverflow.com/questions/6968677/cfnotificationcenter-usage-examples)删除是使用 NULL 完成的，但再次根据参考资料 - 这是错误的。

那么，删除使用 NULL 观察者完成的注册的正确方法是什么？他们不应该被删除吗（他们只是留在那里直到由于应用程序退出而清除内存？？）？？？

任何解释都非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T12:10:16.770

发送观察者并没有真正的惩罚（这是 a `void *`，并且根本不被系统解释）。首选用例是，如果您要删除观察者，您应该向`observer`初始`CFNotificationCenterAddObserver`调用和后续调用发送一个`CFNotificationCenterRemoveObserver`。

例如，似乎将 NULL 传递给 Add 和 Remove 确实有效，但正如您指出的那样，这样做会破坏 API 合同，因此我不建议在运输代码中使用它。

它`observer`本身通常只是一个字符串指针，只要传入相同的指针，就可以了。

```
char *myObserver="anObserver";

CFNotificationCenterAddObserver ( notificationCenter, (void*)myObserver, myCallback, NULL, NULL, CFNotificationSuspensionBehaviorDrop); 
```

然后：

```
CFNotificationCenterRemoveObserver ( notificationCenter, (void*)myObserver, NULL, NULL); 
```

确保使用*相同*的字符串指针，而不仅仅是相同的字符串，因为 Foundation 只检查 的相等性`void*`，它对内容一无所知。

通过进一步的解释，这种模式的原因是您可以使用单个回调来处理多个观察者。

# iphone - 图像未在 iOS 4.3 中保存（下载）

> ID：16082103
> 
> 赞同：0
> 
> 时间：2013-04-18T11:48:10.543
> 
> 标签：iphone, ios, objective-c, ios4, iphone-sdk-3.0

我在用着

```
 UIImage *viewImage = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL  URLWithString:self.imageURL]]];
NSLog(@"UIImage : %@",viewImage);
ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];

[library writeImageToSavedPhotosAlbum:[viewImage CGImage] orientation:(ALAssetOrientation)[viewImage imageOrientation] completionBlock:^(NSURL *assetURL, NSError *error){

if (error) {
    NSLog(@"error");
} else {
    NSLog(@"URL IS  %@", assetURL);
    [self assignDictonary:viewImage withURL:assetURL withMediaType:@"public.image"];

}
}];
[library release]; 
```

或者

```
 dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,(unsigned long)NULL), ^(void) {
UIImageWriteToSavedPhotosAlbum([UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL URLWithString:self.imageURL]]], self, @selector(image:didFinishSavingWithError:contextInfo:), nil);
}); 
```

要保存图像..

它适用于 iOS 5 以上的所有版本...

它不适用于 iOS 4.3...

为什么会这样..任何人都可以建议我一些其他的解决方案..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:14:16.700

这可能是因为您在保存完成之前释放了库实例。尝试将发布移动到完成块：

```
UIImage *viewImage = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL  URLWithString:self.imageURL]]];
NSLog(@"UIImage : %@",viewImage);
ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];

[library writeImageToSavedPhotosAlbum:[viewImage CGImage] orientation:(ALAssetOrientation)[viewImage imageOrientation] completionBlock:^(NSURL *assetURL, NSError *error){

if (error) {
    NSLog(@"error");
} else {
    NSLog(@"URL IS  %@", assetURL);
    [self assignDictonary:viewImage withURL:assetURL withMediaType:@"public.image"];

}
[library release];
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:22:54.593

我认为问题在于，在您尝试调用将图像保存到资产库后，图像正在加载。

另一种方法是使用 NSURLConnection 下载图像，而不是信任

+[NSData dataWithContentsOfURL:] 方法。这就是我在 iOS5+ 上的做法：

```
 NSURL *imageURL = [NSURL  URLWithString: @"https://i.chzbgr.com/maxW500/7335737088/h25EA2F17/"];
  NSURLRequest *request = [NSURLRequest requestWithURL: imageURL];
  [NSURLConnection sendAsynchronousRequest:request
                                     queue: [NSOperationQueue mainQueue]
                         completionHandler:^(NSURLResponse *response, NSData *data, NSError *error)
   {
     UIImage *viewImage = [UIImage imageWithData: data];
     ALAssetsLibrary *library = [[ALAssetsLibrary alloc] init];

     [library writeImageToSavedPhotosAlbum: [viewImage CGImage]
                               orientation: (ALAssetOrientation)[viewImage imageOrientation]
                           completionBlock:
      ^(NSURL *assetURL, NSError *error)
      {
        if (error)
        {
          NSLog(@"error");
        }
        else
        {
          NSLog(@"URL IS  %@", assetURL);
        }
      }];
     NSLog(@"UIImage : %@",viewImage);
   }]; 
```

# c# - 获取当前页面的文件夹名称 ASP.NET C#

> ID：16082113
> 
> 赞同：1
> 
> 时间：2013-04-18T11:48:45.483
> 
> 标签：c#, asp.net

我有一个在项目符号列表中的导航栏。我这样做的目的是能够根据当前页面在站点上的位置来更改类。我有可以找到当前文件名的代码，但**我希望能够检索当前文件所在文件夹的名称**。我该怎么做呢？

```
protected void Page_Load(object sender, EventArgs e)
{
    string[] file = Request.CurrentExecutionFilePath.Split('/'); 
    string fileName = file[file.Length-1];

    if (fileName == "Dashboard.aspx")
    {
        MainNavList.Items.FindByText("Dashboard").Attributes.Add("class", "active");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T11:51:59.010

有了`HttpContext.Current.Request.Url.AbsolutePath`你就可以得到当前的 URL 路径。

例如，如果我访问的页面是：

`http://www.website.com/Directory1/Directory2/Page.aspx`

然后它会输出你可以使用的字符串`split()`：

`/Directory1/Directory2/Page.aspx`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T14:39:41.323

谢谢耶罗尼莫！我所做的只是将 -1 更改为 -2 并放入名为“Dashboard”的文件夹的名称中。这对我有用：

```
protected void Page_Load(object sender, EventArgs e)
{
    string[] file = Request.CurrentExecutionFilePath.Split('/'); 
    string fileName = file[file.Length-2];

    if (fileName == "Dashboard")
    {
        MainNavList.Items.FindByText("Dashboard").Attributes.Add("class", "active");
    } 
```

}

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:32:20.877

尝试使用`Request.MapPath`或`Request.PhysicalPath`获取磁盘上 ASPX 文件的位置。

# javascript - OpenStack Horizo n 仪表板（Folsom 版本）js 构建器

> ID：16082115
> 
> 赞同：2
> 
> 时间：2013-04-18T11:49:00.290
> 
> 标签：javascript, openstack, openstack-horizon

据我所知，OpenStack Horizo​​n 仪表板（Folsom 版本）使用[LESS.js](http://lesscss.org/)编译 *.css 静态文件。这很清楚。

但我不知道用什么来压缩 Horizo​​n *.js 文件（例如*Horizo* ​​n.instances.js等）到*176baabe0b2d.js 之*类的东西，它直接在浏览器中工作。

需要您的帮助来确定这个 js 构建器。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:29:19.533

答案找到了。

文件中有一个`COMPRESS_OFFLINE`常数`../openstack_dashboard/local/local_settings.py`。它应该等于`True`。

然后你应该`./manage.py compress`从你的目录运行命令`../openstack_dashboard`来重建压缩的 js Horizo​​n 文件。

# c# - 为什么将双精度数除以零不会引发异常，而将整数除以呢？

> ID：16082118
> 
> 赞同：3
> 
> 时间：2013-04-18T11:49:06.667
> 
> 标签：c#, asp.net, memory-management, int, double

当我们将 a`double`除以零时，它不会抛出任何异常，而是成功映射到无穷大。但在`int`.

尽管事实上两者`int`和`double`都有他们可以持有的价值的上限，比如 max

```
double = 1.7976931348623157E+308; //not infinity 
```

为什么`int`没有以相同的方式实施？

请把我的问题读成这样--> 这种行为是在什么基础上建立在 double 中而不是 int 中的。这样做的理由是什么？甚至 excel 也给出了与双重天气相同的结果，它是 int 或 decimal，但为什么不是 c# 中的 int？

**编辑**你们所有人都说要符合既定的行业标准是这样的..我想知道他们设定该标准的原因..**必须有一个原因，否则它将是一个独裁统治**

# java - 无法使用 Hibernate 在 Oracle 中检索最后插入的行的 id

> ID：16082119
> 
> 赞同：0
> 
> 时间：2013-04-18T11:49:09.510
> 
> 标签：java, hibernate, oracle11g

我正在使用在插入序列之前触发的触发器为 Oracle 11g xe 中的表生成 id

这是我的触发器

```
DROP TRIGGER GOOGLEPLAY.ORGANIZATION_CODE_GENERATOR;

CREATE OR REPLACE TRIGGER GOOGLEPLAY.ORGANIZATION_code_generator
BEFORE INSERT
ON GOOGLEPLAY.ORGANIZATIONS 
REFERENCING NEW AS New OLD AS Old
FOR EACH ROW
DECLARE

BEGIN

        select ORGANIZATION_SEQ.nextval into :NEW.code from dual;

EXCEPTION
   WHEN OTHERS
   THEN
      -- Consider logging the error and then re-raise
      RAISE;
END ORGANIZATION_code_generator; 
```

这是我的顺序

```
DROP SEQUENCE GOOGLEPLAY.ORGANIZATION_SEQ;

CREATE SEQUENCE GOOGLEPLAY.ORGANIZATION_SEQ
  START WITH 41
  MAXVALUE 99
  MINVALUE 1
  NOCYCLE
  NOCACHE
  NOORDER; 
```

我想使用我正在使用的休眠获取此 ID

```
 session.persist(cashierOrganization);
  session.flush();
  cashierOrganization = (Organizations) session.merge(cashierOrganization); 
```

但我总是得到 0 的 id 有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T15:36:56.923

您是否尝试使用自定义生成器在插入期间获取触发器设置的 Id？当您使用 Oracle 时，这是一种相对常见的情况。尝试使用这个：

```
@Id
@GeneratedValue(generator="triggerGenerator")
@GenericGenerator(name="triggerGenerator", 
    strategy="package.to.my.custom.generator.TriggerAssignedIdentityGenerator")
private Long id; 
```

TriggerAssignedIdentityGenerator 是一个实现自定义生成器策略的类，它的实现显示在 Hibernate 论坛的这个主题中：

*   [在插入触发器和 ID 生成器之前](https://forum.hibernate.org/viewtopic.php?t=973262)

希望这有帮助！

# javascript - 在 HighChart 中转换时间

> ID：16082122
> 
> 赞同：0
> 
> 时间：2013-04-18T11:49:15.637
> 
> 标签：javascript, datetime, highcharts

我正在使用高图表来比较每位患者的等待时间和出院时间。

例如：

```
Patient ID   Expected Time    Waiting Time
2            2 hours          1 hour 
```

我有一个数据库连接来获取这些时间：

```
$query2 = "SELECT PatientID,Forename, Patient.Illness, Patient.Priority, Arrival_time, MY_TIME() AS now, ABS( TIMEDIFF( MY_TIME( ) , Arrival_time ) ) AS Waiting_Time, TIME_TO_SEC( Expected_time) as Expected_time , TIME_TO_SEC( Discharge_time )  as Discharge_time, Examined
FROM Patient, priority_time
WHERE Patient.Illness = priority_time.Illness
AND Patient.Priority = priority_time.Priority;";
$result2 = mysqli_query($conn, $query2) or die("Invalid query: ".$query2); 
```

我想在 X 轴上显示患者 ID，在 Y 轴上显示等待时间。

问题：

```
Converting Time to display in this format: hours: minutes: seconds on Y axis. 
```

这是我的代码：

```
<html>
    <head>
    <script src="http://code.jquery.com/jquery-1.7.1.min.js"></script>
    <script src="js/highcharts.js"></script>
    <script type="text/javascript">
        function drawChart(){
            var chart = new Highcharts.Chart({
                chart: {
                    renderTo: 'divforchart',
                    type:'column',
                },
                xAxis: {
                    name:'patients',
                    categories: ['Juan','Pepe','Paco']
                },
                yAxis: {
                    type: 'datetime'
                },

                series: [
                    {
                        name: 'Arrival time',
                        data: [
                            ['Juan',Date.UTC(2012,4,18,11,0)], 
                            ['Pepe',Date.UTC(2012,4,18,11,0)], 
                            ['Paco',Date.UTC(2012,4,18,11,0)] 
                        ]
                    },
                    {
                        name: 'Expected time',
                        data: [
                            ['Juan',Date.UTC(2012,4,18,12,00)], 
                            ['Pepe',Date.UTC(2012,4,18,13,00)], 
                            ['Paco',Date.UTC(2012,4,18,11,15)]
                        ]
                    }
                ]
            });
        }
    </script>
    </head>
    <body onLoad="drawChart()">
     <div id="divforchart" style="height: 400px"></div>
    </body> 
```

编辑： ![可视化](https://i.stack.imgur.com/mBlic.jpg)

# ios - CALayer setString 导致 setNeedsDisplay

> ID：16082123
> 
> 赞同：0
> 
> 时间：2013-04-18T11:49:16.430
> 
> 标签：ios, uiview, calayer, catextlayer

我有一个带有几个子层的自定义 UIView。一个是 CATextLayer。我在视图的 LayoutSubviews 方法中设置图层。当我随后为 CATextLayer 设置文本时，我的自定义视图的 layoutSubviews 方法被调用，这让我很痛苦。为什么会这样？

# django - Django：如何将一个应用程序集成到另一个应用程序中

> ID：16082124
> 
> 赞同：5
> 
> 时间：2013-04-18T11:49:21.897
> 
> 标签：django, templates, view, include

我想知道我们如何从不同的应用程序中“调用”一个应用程序。基本上，我有，例如：

*   一个日历应用程序，它执行特定过程以在 html 中呈现日历
*   显示网站 index.html 的“主要”应用程序

我希望主应用程序调用日历应用程序并将其呈现在侧边栏中的内容。

例如，CodeIgniter 框架可以处理这个问题。一个控制器可以调用另一个控制器，将它返回的内容（html 输出）保存在一个变量中，最后将该变量包含在将用于呈现最终 html 文件的上下文中。

Django有可能吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T22:01:52.623

好吧，我想我可能会找到解决方案。我是 Django 新手，所以我不知道这是否是一种好方法，是否违反了一些常规规则，是否打开了一些安全漏洞，或者简单地说，还有其他更好的方法，但无论如何，它有效...

所以，我创建了我的应用程序**Calendar**和我的应用程序**Show**。我希望**Show**调用**Calendar**，呈现其模板，然后将结果插入到**Show**的模板中。

为此，我使用`TemplateResponse`而不是`HttpResponse`在日历端：

```
# Calendar view

from django.template.response import TemplateResponse

def render_calendar(request):
    return TemplateResponse(request, 'calendar/calendar-template.html', {}) 
```

然后在 Show 端，获取`TemplateResponse`实例，调用它的`render()`方法，最后`rendered_content`在上下文中插入：

```
# Show view

from calendar import views

def show(request, show_id):
    cal = views.render_calendar(request)
    cal.render()
    context = {"calendar": cal.rendered_content}
    return render_to_response("show/show-template.html", context) 
```

这就是诀窍！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:57:44.937

有点...

有一个模板标签[**{% ssi %}**](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#ssi)允许您将一个模板包含在另一个模板中，唯一的事情是您需要向父模板传递另一个模板所需的所有上下文变量。

# ios - iOS 核心数据错误 - 对多关系的值类型不可接受

> ID：16082133
> 
> 赞同：5
> 
> 时间：2013-04-18T11:49:41.383
> 
> 标签：ios, objective-c, core-data

我正在为这个问题而烦恼，这似乎应该是一件非常简单的事情。iOS / Objective C 对我来说是新的，所以也许我只是没有掌握一些基本的东西。

问题是我在我的核心数据模型中添加了一个新实体，并建立了一对多的关系。该模型已经有两个具有一对一关系的实体。

![核心数据模型](https://i.stack.imgur.com/Shm4p.png)

Players 实体是新实体。

我有一个 UITableViewController，我在其中保存到 UITextFields 的属性。这适用于 Teams/TeamDetails 的原始配置，但是当我将 Players 实体添加到代码中时，它会崩溃并出现以下错误：

```
Terminating app due to uncaught exception 'NSInvalidArgumentException', 
reason:   'Unacceptable type of value for to-many relationship: 
property = "playerDetails"; desired type = NSSet; given type = Players; 
```

所以，在我的 Save 方法中，我有：

```
Teams *team = [NSEntityDescription insertNewObjectForEntityForName:@"Teams" inManagedObjectContext:self.managedObjectContext];
TeamDetails *teamdetails = [NSEntityDescription insertNewObjectForEntityForName:@"TeamDetails" inManagedObjectContext:self.managedObjectContext];

team.teamDetails = teamdetails; 
```

然后我继续设置属性，例如：

```
team.teamName = teamNameTextField.text;
team.teamDetails.managerName = managerNameTextField.text; 
```

这一切都没有问题。现在我扩展它以合并 Players 实体：

```
Players *playerDetails = [NSEntityDescription insertNewObjectForEntityForName:@"Players" inManagedObjectContext:self.managedObjectContext];

team.playerDetails = playerDetails; 
```

我得到了上面的错误。我尝试了以下方法：

```
[team setPlayerDetails:playerDetails]; 
```

但这没有任何区别。我也试过：

```
NSSet *playerDetails = [NSEntityDescription insertNewObjectForEntityForName:@"Players" inManagedObjectContext:self.managedObjectContext]; 
```

但同样，没有区别 - 它仍然认为它得到的是 Players 类型的对象，而不是 NSSet。

我觉得我只是没有掌握一些简单的东西，所以非常感谢任何帮助！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-18T11:58:05.233

`playerDetails`是一对多关系，所以 的值`team.playerDetails`是一*组*玩家，而不是单个玩家对象。您可以使用

```
[team addPlayerDetailsObject:playerDetails]; 
```

或者更简单地说，使用反比关系：

```
playerDetails.team = team; 
```

# css - 按钮上的最小宽度会在 IE 中导致其右侧的空间

> ID：16082135
> 
> 赞同：2
> 
> 时间：2013-04-18T11:49:44.777
> 
> 标签：css, internet-explorer, button, internet-explorer-9

我目前正在调查`CSS` `min-width`Internet Explorer 中该属性的奇怪行为。我听说过文本对齐的错误，使用`min-width`. 但这对我来说是新的。

```
<table cellspacing="0" cellpadding="0">
  <tr>
    <td><button>Einloggen</button></td>
  </tr>  
</table> 
```

当我将`min-width`按钮设置为一个实际上会拉伸按钮右侧的空间时，它会出现/`td`变宽。我只在 IE 中看到了这种行为。也检查了 Opera、FF、Chrome 和 Safari。

这是一个包含示例的[jsfiddle 。](http://jsfiddle.net/JNDUz/4/)

这是一个已知的错误？有什么解决方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T13:52:57.213

Internet Explorer 9 似乎确实存在一个奇怪的问题。有趣的是，版本 8 和 10 都可以正确呈现此演示，没有问题。

话虽如此，关于 IE9，我找到了一种似乎可以解决问题的解决方法。我的成功在于使用伪元素`::before`作为后备：

```
/* For everybody but IE9 */
button {
    min-width: 200px;
}

/* For Internet Explorer 9 */
button::before {
    content: "" \9;
    display: block;
    width: 200px;
} 
```

小提琴：http: [//jsfiddle.net/JNDUz/21/](http://jsfiddle.net/JNDUz/21/)

虽然这*可行*，但它确实会导致 Internet Explorer 10 中的按钮稍宽（伪元素宽度 + 父填充/边距）。这些黑客在 IE10 中没有任何业务，但很难将它们单独在 CSS 中隔离到某些浏览器。该`\9`技巧可以将其与非 IE 浏览器隔离开来，但有更好的方法：

```
<!--[if IE 9]><html lang="en-us" class="no-js ie9"><![endif]--> 
```

通过将 HTML 标记包装在条件注释中，我们现在可以单独针对 IE 进行修复：

```
/* For Internet Explorer 9 */
.ie9 button::before {
    content: "";
    display: block;
    width: 200px;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:00:28.933

好吧，这有点奇怪，它在按钮的右侧添加了填充，但我设法在右侧获得了最少的空间，通过使用这个

```
button {
   padding: 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T12:08:59.373

我相信它不是有效的标记，但将`Einloggen`单词包装到 div 可以解决问题。

```
<table cellspacing="0" cellpadding="0">
    <tr>
        <td>
            <button>
                <div>Einloggen</div>
            </button>
        </td>
    </tr>
</table> 
```

[jsfiddle](http://jsfiddle.net/JNDUz/5/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T14:19:48.197

上面的解决方法似乎工作正常，但也要考虑到 CSS/HTML 规范中不推荐使用单元格间距和单元格填充。也许不推荐使用的状态与它有关。

# hadoop - 无法查看 HDFS 上的文件

> ID：16082138
> 
> 赞同：0
> 
> 时间：2013-04-18T11:49:47.367
> 
> 标签：hadoop, hdfs

我在我的 HDFS 上创建了一些文件。我能够执行 hadoop fs -ls 命令来查看它们并且运行良好。后来我无法查看它们。因此，我尝试格式化名称节点并将文件重新添加进去，它说文件已经退出。知道为什么会这样吗？如果我无法查看这些文件，如何删除它们？

![在此处输入图像描述](https://i.stack.imgur.com/41sqz.png)

我能够在浏览器上查看文件。

![在此处输入图像描述](https://i.stack.imgur.com/qRtdU.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T01:33:00.577

您似乎以 user 身份登录`yeshwanthvenkatesh`。当您在`hadoop fs -ls`没有路径的情况下运行时，hadoop 会显示您的主目录（可能`/user/yeshwanthvenkatesh`）的内容，该目录似乎是空的。您可以尝试运行：

```
hadoop fs -ls /user/hadoop/scolopax/input/ebird/autogen 
```

但由于该目录属于 user `hadoop`，您可能没有权限。如果没有，试试这个：

```
sudo -u hadoop hadoop fs -ls /user/hadoop/scolopax/input/ebird/autogen 
```

# java - 如何修复我的扫描仪输入为空？

> ID：16082143
> 
> 赞同：-2
> 
> 时间：2013-04-18T11:50:13.457
> 
> 标签：java, eclipse, variables, pointers, null

嗨，我是 Java 编程新手，在我的最新项目中遇到了问题。我正在为保龄球制作一个分数生成器并完成了代码，除非我去测试它，它说

“Bowling_Score.main (Bowling_Score.java:34) 处的线程“主”java.lang.NullPointerException 中的异常”

我尝试了一切来解决它，并浏览了大量的网站，但没有解决方案解决我的问题。这可能很容易解决，但我似乎找不到答案。有问题的行是这里的第二行。

```
 System.out.println("Frame 1, Throw 1");
    Frame1Throw1 = sc.nextInt(); 
```

这是我知道如何使用带变量的扫描仪的唯一方法，所以如果有更好的方法请告诉我。这也可能是一个问题，因为变量 Frame1Throw1 是列表中的第一个变量。

变量是正确的，我的扫描仪的名字是 sc

请具体回答，因为正如我所说，我是 Java 新手，现在只是学习基础知识。这是我的第一个大项目。

谢谢你！

PS我使用eclipse来编码我不知道这是否重要

***我得到了一个答案，它很有帮助，但它没有用。这是代码开头的更多内容，可能有助于回答。

```
 import java.util.Scanner;
    public class Bowling_Score {

     private static Scanner sc;
public static void main(String[] args) {
//All Variables
    int Frame1Throw1 = 0;
    int Frame1Throw2 = 0;
    int Frame2Throw1 = 0;
    int Frame2Throw2 = 0;
    int Frame3Throw1 = 0;
    int Frame3Throw2 = 0;
    int Frame4Throw1 = 0;
     //Then I have one variable for each throw of the game, and one for the final total score.
        //Directions
    System.out.println("To put in your score, put the number of pins you  knocked down in the throw specified. If you get a strike, enter a 10 in the first throw of the frame and a 0 in the second throw of the frame. If you get a spare, Ener a 0 in the first throw of the frame and 10 in the second throw of the frame.");

    //Frame 1
    System.out.println("Frame 1, Throw 1");
    Frame1Throw1 = sc.nextInt();
    if (Frame1Throw1 == 10){
        Frame1Throw1 = Frame1Throw1 + Frame2Throw1 + Frame2Throw2;
        Frame1Throw2 = 0; } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T11:52:05.427

A`NullPointerException`表示您引用的对象尚未初始化。所以在这种情况下，我想你`sc`之前没有在你的代码中创建过。

寻找类似的东西

```
Scanner sc; 
```

并将其更改为

```
Scanner sc = new Scanner(System.in); 
```

否则可能是范围问题（您在该方法看不到的地方创建了对象），如果第一个解决方案不起作用，您将需要提供更多代码。

# c# - 无法在 app.config WPF 中的 appsetting 部分保留新更改？

> ID：16082145
> 
> 赞同：0
> 
> 时间：2013-04-18T11:50:17.880
> 
> 标签：c#, wpf, c#-4.0, app-config

下面是我用来更新或更改 app.config 中 appsetting 值的代码

```
 Configuration config = ConfigurationManager.OpenExeConfiguration(ConfigurationUserLevel.None);              
 config.AppSettings.Settings["userName"].Value = username;
 config.AppSettings.Settings["pwd"].Value = pwd;
 config.Save(ConfigurationSaveMode.Modified, true);                
 ConfigurationManager.RefreshSection("appSettings"); 
```

我正在使用上面的代码在运行时更改或更新 appsetting 部分中的设置，并希望更改保持不变，以便在我运行应用程序时它应该从 appsettings 中选择新值，但在这里它不会发生，因此所做的更改并保存在运行时，当我再次重新启动我的应用程序时，它不会持续存在，它具有旧的默认设置。我还检查了 bin/debug 中的 app.config，但它在 appsettings 中也有旧值。我参考了各种博客并在此处发布作为参考，但它得到了与上面相同的代码，但它没有保留设置。[已经提到了这篇文章](https://stackoverflow.com/questions/4216809/configurationmanager-doesnt-save-settings)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T04:08:38.363

请参见下文（来自 MSDN）并记住 app.config 在您的项目中。.exe.config 是实际的文件名。客户端应用程序使用适用于所有用户的全局配置、适用于单个用户的单独配置以及适用于漫游用户的配置。userLevel 参数通过指示配置文件是否没有用户级别（配置文件与应用程序位于同一目录中）或具有每个用户级别（配置文件位于应用程序设置路径中）来确定正在打开的配置文件的位置由用户级别决定）。

通过为 userLevel 传递以下值之一来指定要获取的配置：

```
To get the Configuration object that applies to all users, set userLevel to None.

To get the local Configuration object that applies to the current user, set userLevel to PerUserRoamingAndLocal.

To get the roaming Configuration object that applies to the current user, set userLevel to PerUserRoaming.
NoteNote

To get the Configuration object for a resource, your code must have read permissions on all the configuration files from which it inherits settings. To update a configuration file, your code must additionally have write permissions for both the configuration file and the directory in which it exists. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:21:51.633

我得到了上述问题的解决方案，我的目标是在应用程序或用户级别保持运行时所做的更改。最初我尝试使用 App.config，我在 app.config 的 appsettings 部分保留了应用程序的默认设置，但后来经过研究，我参考了我知道 appsetting 不会保留更改，而是可以在 YourApplication 下使用 userSettings 部分.Property.Settings 您可以提供您的用户级别设置，它对我有用。为此，您无需转到 App.config 手动执行此操作，而是可以从项目的属性窗口中执行此操作。

右键单击您的项目-> 选择左侧的设置选项卡-> 现在在右侧，您将看到资源部分，提供资源名称、类型、范围及其值，您就完成了。相同的值也可以从代码中动态访问和更改。以下是相同的代码摘录-

访问设置值

```
enter code here
        userName = Properties.Settings.Default.UserName;
        pwd = Properties.Settings.Default.PWD; 
```

保存新设置

```
enter code here
        Properties.Settings.Default.UserName = userName.ToString();
        Properties.Settings.Default.PWD = newPWD..ToString();
        Properties.Settings.Default.Save(); 
```

当您下次启动应用程序时，您将获得新的更改设置作为默认设置。希望对大家有帮助 谢谢各位

主播

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:04:37.127

我前段时间也有同样的问题。我宁愿把它放在评论中，但我没有这个特权。我的回答可能不是你的情况，但我认为值得分享。

请问你的bin文件夹在哪里？当您以编程方式更改不在用户可访问空间中的文件时，Windows 7 会在漫游空间中创建该文件的副本，并且该文件将保留在那里。每次您尝试访问该文件（如您的 app.config）时，W7 都会将您的读取/写入透明地重定向到该文件，因此您有可能在漫游空间中修改该文件，而您正在查看的文件保持不变。

在您连续启动应用程序时，您所做的更改是否仍然存在？

*免责声明/道歉：我不是经验丰富的用户，所以如果我说愚蠢的话，请告诉我，我将删除此评论。*

# html - 需要 HTML5 应用指南

> ID：16082149
> 
> 赞同：0
> 
> 时间：2013-04-18T11:50:35.283
> 
> 标签：html

我对 HTML 5 很陌生，但对 HTML5 还不太了解。我想创建一个 HTML5 应用程序，它将表示将从 Web 服务访问的数据。

1.  如果我使用本地存储，我的数据将存储在 sqlite 文件中吗？如果是，它会保存在哪里？
2.  我是否有其他方法可以在本地保存从 Web 服务访问的数据？

我尝试通过执行 xmlhttpRequest 对象来使用，它在 IE 中运行良好，但在 Mozilla 和 Chrome 中无法运行，下面是我的代码片段

```
 function webServiceCallWithParameters() {
try {
        alert("1");
        var xmlHttpReq;
        if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
            xmlHttpReq = new XMLHttpRequest();
        }
        else {// code for IE6, IE5
            xmlHttpReq = new ActiveXObject("Microsoft.XMLHTTP");
        }

        alert(xmlHttpReq);
            xmlHttpReq = new XMLHttpRequest();
        xmlHttpReq.open("POST", "http://localhost/EventWebService/Service.asmx/Add", false);
        xmlHttpReq.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
        xmlHttpReq.send("num1=12&num2=13");
        alert(xmlHttpReq.responseText);
    } catch (e) {
    alert(e);
    }          
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T11:56:41.073

> 1.如果我使用本地存储，我的数据会存储在 sqlite 文件中吗？

这取决于任何给定的浏览器是如何实现本地存储的，但是这有什么关系呢？它的存储方式对您的 Web 应用程序没有任何影响。

> 如果是，它会保存在哪里？

同样，这取决于浏览器的实现，但为什么这很重要？它对存储它的 Web 应用程序没有任何影响。

> 2.我是否有其他方法可以将我从 Web 服务访问的数据保存在本地？

您可以使用[IndexedDB](https://developer.mozilla.org/en-US/docs/IndexedDB)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-21T05:28:21.143

优点：

1.  更少的代码
2.  更多功能，如 css 动画
3.  更少使用javascript
4.  简单的移动 UI 转换
5.  与 HTML 或 CSS 框架和 MVC 轻松集成

缺点：

1.  不支持所有浏览器和所有版本

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T11:57:32.873

有许多离线技术可用，以防万一`HTML5`

他们是

1.  网络存储，
2.  网络 SQL 数据库，
3.  索引数据库，
4.  文件访问

请参阅[http://www.html5rocks.com/en/tutorials/offline/storage/](http://www.html5rocks.com/en/tutorials/offline/storage/)了解有关这些存储技术的深入描述以及它们之间的比较。

希望能帮助到你。

# java - 我在哪里下载 com.rackspacecloud.client.cloudfiles.* 包

> ID：16082151
> 
> 赞同：1
> 
> 时间：2013-04-18T11:50:43.870
> 
> 标签：java

我按照步骤使用 java 连接 swift [http://ceph.com/docs/master/radosgw/swift/java/#setup](http://ceph.com/docs/master/radosgw/swift/java/#setup) 但我可以找到包：

```
import com.rackspacecloud.client.cloudfiles.FilesClient;
import com.rackspacecloud.client.cloudfiles.FilesConstants;
import com.rackspacecloud.client.cloudfiles.FilesContainer;
import com.rackspacecloud.client.cloudfiles.FilesContainerExistsException;
import com.rackspacecloud.client.cloudfiles.FilesObject;
import com.rackspacecloud.client.cloudfiles.FilesObjectMetaData; 
```

我在哪里可以买到它们？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T18:09:55.387

该软件包的源代码（[正式称为 Rackspace Cloud Files Java API）](http://www.rackspace.com/knowledge_center/article/java-api-installation)可[在 github 上找到](https://github.com/rackerlabs/java-cloudfiles)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T11:52:59.840

下载这个jar [aws-java-sdk-1.1.7.1.jar](http://www.jarvana.com/jarvana/archive-details/com/amazonaws/aws-java-sdk/1.1.7.1/aws-java-sdk-1.1.7.1.jar)

有很多网站提供搜索类文件。

例如：findjar.com 和 jarvana.com ...

# ruby-on-rails - 页面加载在rails中花费了很多时间

> ID：16082161
> 
> 赞同：0
> 
> 时间：2013-04-18T11:51:07.397
> 
> 标签：ruby-on-rails, ruby

我正在使用 gmaps4rails gem 在谷歌地图中显示不同的位置。我有近 15000 条记录要显示，但加载页面需要近 10 秒。这是我将给定记录转换为 gmaps4rails 对象的代码：

```
@json = AlphaCourses.find(:all,:id,:latitude,:longitude).to_gmaps4rails 
```

任何人都可以帮助我尽早加载页面。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:27:01.067

尝试缓存策略。RailsCasts 中关于[缓存的很棒的教程。](http://railscasts.com/episodes/89-page-caching)而且也在[这里](http://guides.rubyonrails.org/caching_with_rails.html)。谢谢。

# windows-phone-7 - 使用应用栏 WP8 创建屏幕截图

> ID：16082167
> 
> 赞同：2
> 
> 时间：2013-04-18T11:51:16.803
> 
> 标签：windows-phone-7, windows-phone-8, windows-phone, screenshot, writeablebitmap

在我的应用程序中，可以创建当前视图的屏幕截图。我用 WriteableBitmap 类实现它。例如：

```
var frame = Application.Current.RootVisual as PhoneApplicationFrame;                WriteableBitmap bitmap = new WriteableBitmap(frame, null);
BitmapImage result = new BitmapImage();
using (var stream = new MemoryStream())
{
    bitmap.SaveJpeg(stream, (int)frame.ActualWidth, (int)frame.ActualHeight, 0, 100);
    result.SetSource(stream);
} 
```

问题是如果在页面上，现在正在显示，有一个应用程序栏，它不会显示在保存的图像上。任何想法我应该如何处理这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:25:28.353

`Application`bar 不是您应用程序的一部分，因此您不能这样做。唯一的方法是要求用户通过按 Windows+相机按钮来制作屏幕截图。

# python - 通过高斯与 scipy 的总和进行曲线拟合

> ID：16082171
> 
> 赞同：3
> 
> 时间：2013-04-18T11:51:28.273
> 
> 标签：python, scipy, curve-fitting

我在做生物信息学，我们在 mRNA 上绘制小 RNA。我们有每个 mRNA 上蛋白质的映射坐标，我们计算蛋白质与 mRNA 结合的位置与小 RNA 结合的位点之间的相对距离。

我获得以下数据集：

```
dist    eff
-69 3
-68 2
-67 1
-66 1
-60 1
-59 1
-58 1
-57 2
-56 1
-55 1
-54 1
-52 1
-50 2
-48 3
-47 1
-46 3
-45 1
-43 1
0   1
1   2
2   12
3   18
4   18
5   13
6   9
7   7
8   5
9   3
10  1
13  2
14  3
15  2
16  2
17  2
18  2
19  2
20  2
21  3
22  1
24  1
25  1
26  1
28  2
31  1
38  1
40  2 
```

当我绘制数据时，我有 3 张图片：1 张在 3 -4 左右，另一张在 20 左右，最后一张在 -50 左右。

我尝试三次样条插值，但它对我的数据效果不佳。

我的想法是用高斯总和进行曲线拟合。例如，在我的情况下，在点 5,20 和 -50 处估计 3 条高斯曲线。

我该怎么做？

我查看了 scipy.optimize.curve_fit()，但我怎样才能以精确的间隔拟合曲线？如何将曲线添加到一条曲线？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T16:01:51.897

```
import numpy as np
import matplotlib.pyplot as plt
import scipy.stats
import scipy.optimize

data = np.array([-69,3, -68, 2, -67, 1, -66, 1, -60, 1, -59, 1,
                 -58, 1, -57, 2, -56, 1, -55, 1, -54, 1, -52, 1,
                 -50, 2, -48, 3, -47, 1, -46, 3, -45, 1, -43, 1,
                 0, 1, 1, 2, 2, 12, 3, 18, 4, 18, 5, 13, 6, 9,
                 7, 7, 8, 5, 9, 3, 10, 1, 13, 2, 14, 3, 15, 2,
                 16, 2, 17, 2, 18, 2, 19, 2, 20, 2, 21, 3, 22, 1,
                 24, 1, 25, 1, 26, 1, 28, 2, 31, 1, 38, 1, 40, 2])
x, y = data.reshape(-1, 2).T

def tri_norm(x, *args):
    m1, m2, m3, s1, s2, s3, k1, k2, k3 = args
    ret = k1*scipy.stats.norm.pdf(x, loc=m1 ,scale=s1)
    ret += k2*scipy.stats.norm.pdf(x, loc=m2 ,scale=s2)
    ret += k3*scipy.stats.norm.pdf(x, loc=m3 ,scale=s3)
    return ret

params = [-50, 3, 20, 1, 1, 1, 1, 1, 1]

fitted_params,_ = scipy.optimize.curve_fit(tri_norm,x, y, p0=params)

plt.plot(x, y, 'o')
xx = np.linspace(np.min(x), np.max(x), 1000)
plt.plot(xx, tri_norm(xx, *fitted_params))
plt.show() 
```

![在此处输入图像描述](https://i.stack.imgur.com/L3ukE.png)

```
>>> fitted_params
array([ -60.46845528,    3.801281  ,   13.66342073,   28.26485602,
          1.63256981,   10.31905367,  110.51392765,   69.11867159,
         63.2545624 ]) 
```

所以你可以看到你对三峰函数的想法与你的真实数据不太一致。

# django - Django：在 Django 中向管理员用户添加新字段

> ID：16082177
> 
> 赞同：-1
> 
> 时间：2013-04-18T11:51:38.040
> 
> 标签：django, django-admin

我需要向 django 管理员用户添加一个新的字符字段。为此，我创建了为 models.py 扩展 ModelForm 的新模型

```
class UserAdminForm(forms.ModelForm):
      class Meta:
    model = User
is_developer = forms.BooleanField(default=False) 
```

我编辑 admin.py 文件。

```
class UserAdmin(admin.ModelAdmin):
form = UserAdminForm
admin.site.unregister(User)
admin.site.register(User, UserAdmin) 
```

当我尝试运行 syncdb 命令时，它给出错误 `TypeError: __init__() got an unexpected keyword argument 'default'.`是什么原因。请告诉我如何向 Django 管理员用户添加新文件。给我一些示例代码或教程链接。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:47:33.023

根据您使用的 Django 版本（<1.5 或 1.5）选择此处描述的两个版本之一： [https ://docs.djangoproject.com/en/dev/topics/auth/customizing/#extending-the-existing -用户模型](https://docs.djangoproject.com/en/dev/topics/auth/customizing/#extending-the-existing-user-model)

# xpath - 如何从 Xpath 返回的序列中选择第一个元素

> ID：16082184
> 
> 赞同：0
> 
> 时间：2013-04-18T11:51:51.017
> 
> 标签：xpath, firebug, selenium-webdriver

我正在尝试查找特定的 web 元素：属于“selectDateTime”类并且位于标签“From”旁边的输入字段。实际上是 XPath 查询

```
//fieldset[legend="Pickup"]//div[@class="selectDateTime"] 
```

创建此元素，但同一类的另一个元素出现在页面上。我尝试使用以下 XPath 查询选择第一个或最后一个元素

//fieldset[legend="Pickup"]//div[@class="selectDateTime"][1] (//fieldset[legend="Pickup"]//div[@class="selectDateTime"])[1]

但是在第一种情况下，查询找到了 2 个元素，在第二种情况下，查询不会产生结果。你知道，我该如何解决这个问题？可能是，你有解决办法吗？欢迎您提出您的想法。

这是解析的 XML：

```
[fieldset]
    [legend]
        Pickup
    [/legend]
    [div class="block block_position_first"]
        [div class="tr"]
            [div class="td"]
                [label]
                    From:
                [/label]
            [/div]
            [div class="td"]
                [div class="selectDateTime"]
                    [input class="date" type="text" placeholder="dd/mm/yyyy"/]
                    [input class="time" type="text" placeholder="00:00"/]
                [/div]
            [/div]
        [/div]
        [div class="tr"]
            [div class="td"]
                [label]
                    To:
                [/label]
            [/div]
            [div class="td"]
                [div class="selectDateTime"]
                    [input class="date" type="text" placeholder="dd/mm/yyyy"/]
                    [input class="time" type="text" placeholder="00:00"/]
                [/div]
            [/div]
        [/div]
    [/div]
[/fieldset] 
```

发布 XML 文件存在一些问题，因此我将 < 和 > 分别替换为 [ 和 ]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:49:26.033

用于`[1]`第一个元素和`[last()]`最后一个元素。确保添加适当的括号，否则您将收到最后一步表达式每次运行的第一个或最后一个元素。

```
(//fieldset[legend="Pickup"]//div[@class="selectDateTime"])[1]
(//fieldset[legend="Pickup"]//div[@class="selectDateTime"])[last()] 
```

# ruby-on-rails - Rails 4 资产管道和在 SCSS 中引用图像

> ID：16082191
> 
> 赞同：3
> 
> 时间：2013-04-18T11:52:08.617
> 
> 标签：ruby-on-rails, sass, asset-pipeline, ruby-on-rails-4

我正在检查 Rails 4 beta，当我使用 Capistrano（Nginx、Unicorn、Postgres）进行部署时，它会通过清单成功部署资产。

例如。`logo-515b878aa9fea59fa353f24f11c3ab.png`但我注意到它也不会上传原始文件`logo.png`（没有清单）。

我想知道这是正常行为还是我遗漏了什么。

以及如何在 CSS 文件中调用 thie 'logo.png' 文件，因为以下内容不起作用，因为它没有使用清单文件。

```
// Pages.SCSS file
.logo {
 background: url("logo.png") no-repeat scroll 0% 0%;
} 
```

或者

```
// Pages.SCSS file
.logo {
 background: url(image_path("logo.png")) no-repeat scroll 0% 0%;
} 
```

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-26T14:38:29.887

它是一种rails错误，在[这里找到了答案](https://github.com/rails/rails/issues/9879)

```
rake assets:precompile RAILS_ENV=production 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T11:59:07.203

我的问题与不使用 image_path 或 image_url 相关（停止使用对 css 文件中图像文件的显式调用）。它在重新启动独角兽进程后解决了我的问题（我认为我的 Capistrano 配方会在冷部署后重新启动服务器）。

再次感谢。

# text - 如何使用 watir 点击带有特定文本的链接元素？

> ID：16082195
> 
> 赞同：5
> 
> 时间：2013-04-18T11:52:17.680
> 
> 标签：text, click, watir

我无法使用**watir**单击文本链接“添加” ：

页：

```
<div id="divAdd" style="float: right">
    <a onclick="SwitchView('2')" style="color: #1B56A7; cursor: pointer;">Add</a>
</div> 
```

瓦提尔代码：

```
browser.link(:text =>"Add").click 
```

例外：

```
Unable to locate element, using {:tag_name=>["a"], :text=>"Add"} 
```

请帮助我如何处理这个？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-18T22:14:32.280

如果页面有很多 ajax 和 javascript 运行，您可能只需要稍等片刻，让客户端代码在从浏览器加载页面后完成呈现页面。

尝试这个

```
browser.link(:text =>"Add").when_present.click 
```

如果这不起作用，请确保该项目不在框架或其他东西中。

顺便说一句，如果页面上有多个链接带有“添加”文本，那么您可能必须在链接之外指定一个容器，以便您识别所需的链接。例如。

```
browser.div(id: => "divAdd").link.when_present.click 
```

如果

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-14T10:24:51.407

这将是我的做法。

```
while browser.div(:class, 'containerDIV').a(:text, 'Add').exists? do
    browser.div(:class, 'containerDIV').a(:text, 'Add').click 
 end 
```

# android - Android FragmentTransaction：如何在其中生成覆盖幻灯片并将现有 Fragment 向左移动

> ID：16082202
> 
> 赞同：4
> 
> 时间：2013-04-18T11:52:36.847
> 
> 标签：android, android-widget, android-fragments

我正在尝试执行以下操作。创建一个新的片段 B（菜单），将其从右侧滑入，我想将已显示的片段 A 移动（不隐藏或替换！）左侧。 ![在此处输入图像描述](https://i.stack.imgur.com/LJNpz.jpg)

我从 Fragment B 得到了 Transaction，但 Fragment A 根本没有改变他的位置。好像，我`FragmentManager`不知道 Fragment A 存在（Fragment A 不是动态添加的，它是在 XML 中定义的）。

*   main_screen_layout-xml

    ```
    <RelativeLayout //...
        android:id="@+id/main_screen"
        tools:context=".MainActivity" 

      <fragment
        android:id="@+id/map_screen"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        class="com.google.android.gms.maps.SupportMapFragment" >
      </fragment> 
    ```

*   分片交易

    ```
    FragmentManager fragmentManager = getSupportFragmentManager();
    FragmentTransaction ft = fragmentManager.beginTransaction();            
    ft.add(R.id.main_screen, new MenuFragment(), MENU_FRAGMENT); //adding Fragment B
    ft.setCustomAnimations(R.anim.slide_in_right, R.anim.slide_out_left_cut);       
    ft.addToBackStack(null);
    ft.commit(); 
    ```

片段 A 存在于其中`FragementManager`，我可以隐藏它，但这不是我的目标

```
Fragment fragmentA = fragmentManager.findFragmentById(R.id.map_screen);
ft.hide(fragmentA); //hide FragmentA 
```

我究竟做错了什么？

一些注意事项：

*   我正在使用支持库 (android.support.v4.app.FragmentManager..)，但在 API 17 上进行测试
*   如前所述，我没有特别声明 FragmentA `FragmentManager`（尝试过，但它说 Fragment 已经存在）
*   片段 A 是（如您在 XML 中看到的）类的谷歌地图`SupportMapFragment`
*   动画 XML 正在运行，这就是我没有发布它的原因

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-26T15:47:51.357

我不确定这是否正是您要查找的内容，但请查看此[滑动菜单](https://github.com/jfeinstein10/SlidingMenu)库...它允许在移动中心内容片段的同时从左侧或右侧滑入片段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T16:28:53.893

解决方案：

创建具有重叠片段的相对布局：

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/main_screen"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    tools:context=".MainActivity" >

    <RelativeLayout
        android:id="@+id/back_frame"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <include layout="@layout/menu_fragment" />
    </RelativeLayout>

    <RelativeLayout
        android:id="@+id/front_frame"
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <fragment
            android:id="@+id/map_screen"
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:layout_above="@+id/map_screen_bottom_bar"
            class="com.google.android.gms.maps.SupportMapFragment" >
        </fragment> 
```

并简单地调用`.translationX(-1 * mScreenWidth)` （mScreenWidth 是我的 ScreenWidth 减去你想要的间隙）。

```
 if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.HONEYCOMB_MR1) {
                ((RelativeLayout) findViewById(R.id.front_frame)).animate()
                    .translationX(-1 * mScreenWidth);
            } else {
                TranslateAnimation slideOut = new TranslateAnimation(0, -1
                    * mScreenWidth, 0, 0);
                slideOut.setDuration(getResources().getInteger(
                    R.integer.animation_transistion_length_short));
                slideOut.setFillEnabled(true);

                slideOut.setAnimationListener(new AnimationListener() {

                    @Override
                    public void onAnimationStart(Animation animation) {}

                    @Override
                    public void onAnimationRepeat(Animation animation) {}

                    @Override
                    public void onAnimationEnd(Animation animation) {
                        RelativeLayout mView = (RelativeLayout) findViewById(R.id.front_frame);
                        int[] pos = { mView.getLeft() - mScreenWidth,
                            mView.getTop(), mView.getRight(),
                            mView.getBottom() };
                        mView.layout(pos[0], pos[1], pos[2], pos[3]);
                    }
                });

                ((RelativeLayout) findViewById(R.id.front_frame))
                    .startAnimation(slideOut);
            } 
```

# bash - Bash 脚本 - 在单列中有重复的多行中构造单行

> ID：16082204
> 
> 赞同：1
> 
> 时间：2013-04-18T11:52:43.667
> 
> 标签：bash, duplicates

我有一个检测日志文件，其中有 6 行重复的第一列，如下所示。

```
//SC001@1/1/1@1/1,get,ClientStart,1363178707755
//SC001@1/1/1@1/1,get,TalkToSocketStart,1363178707760
//SC001@1/1/1@1/1,get,DecodeRequest,1363178707765
//SC001@1/1/1@1/1,get-reply,EncodeReponse,1363178707767
//SC001@1/1/1@1/2,get,DecodeRequest,1363178708765
//SC001@1/1/1@1/2,get-reply,EncodeReponse,1363178708767
//SC001@1/1/1@1/2,get,TalkToSocketEnd,1363178708770
//SC001@1/1/1@1/2,get,ClientEnd,1363178708775
//SC001@1/1/1@1/1,get,TalkToSocketEnd,1363178707770
//SC001@1/1/1@1/1,get,ClientEnd,1363178707775
//SC001@1/1/1@1/2,get,ClientStart,1363178708755
//SC001@1/1/1@1/2,get,TalkToSocketStart,1363178708760 
```

注意：,（逗号）是这里的分隔符

同样，日志文件中有许多重复的第一列值 (ID)（上面的示例只有两个值 (ID)；//SC001@1/1/1@1/1 和 //SC001@1/1/1 @1/2）我需要按照以下格式合并日志记录。

```
ID,ClientStart,TalkToSocketStart,DecodeRequest,EncodeReponse,TalkToSocketEnd,ClientEnd

//SC001@1/1/1@1/1,1363178707755,1363178707760,1363178707765,1363178707767,1363178707770,1363178707775
//SC001@1/1/1@1/2,1363178708755,1363178708760,1363178708765,1363178708767,1363178708770,1363178708775 
```

我想有一个用于此练习的 bash 脚本，并感谢专家对此的支持。希望可能有更有效的 sed 或 awk 解决方案。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T11:58:32.390

单程：

```
sort -t, -k4n,4 file | awk -F, '{a[$1]=a[$1]?a[$1] FS $NF:$NF;}END{for(i in a){print i","a[i];}}' 
```

`sort`命令根据最后（第 4）列对文件进行排序。`awk`接受排序后的输入并形成一个数组，其中第一个字段是键，值是最后一列的值的组合。

# linux - 一个目录中的所有文件，linux

> ID：16082205
> 
> 赞同：4
> 
> 时间：2013-04-18T11:52:46.247
> 
> 标签：linux, bash

今天我在linux中尝试了一个脚本来获取一个目录中的所有文件。这很简单，但我发现了一些有趣的东西。

```
 #!/bin/bash
InputDir=/home/XXX/
for file in $InputDir'*'
do
  echo $file
done 
```

输出是：

```
/home/XXX/fileA /home/XXX/fileB 
```

但是当我直接输入目录时，比如：

```
 #!/bin/bash
InputDir=/home/XXX/
for file in /home/XXX/*
do
  echo $file
done 
```

输出是：

```
/home/XXX/fileA
/home/XXX/fileB 
```

似乎，在第一个脚本中，只有一个循环，所有文件名都存储在第一个循环中的变量 $file 中，用空格分隔。但是在第二个脚本中，一个文件名仅在一个循环中存储在 $file 中，并且循环不止一个。这两个脚本之间到底有什么区别？

非常感谢，也许我的问题有点天真..

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T11:59:06.523

行为是正确的并且“符合预期”。

`for file in $InputDir'*'`意思是`assign "/home/XXX/*" to $file`（注意引号）。由于您引用了星号，因此此时不会执行。当 shell 看到`echo $file`时，它首先扩展变量，然后进行全局扩展。所以在第一步之后，它看到

```
echo /home/XXX/* 
```

在全局扩展之后，它看到：

```
echo /home/XXX/fileA /home/XXX/fileB 
```

只有现在，它才会执行命令。

在第二种情况下，模式在执行`/home/XXX/*`之前被扩展`for`，因此，目录中的每个文件都被分配给`file`然后执行循环体。

这将起作用：

```
for file in "$InputDir"* 
```

但它很脆；`/`例如，当您忘记将 a 添加到变量的末尾时，它将失败`$InputDir`。

```
for file in "$InputDir"/* 
```

稍微好一点（Unix 将忽略路径中的双斜杠），但如果`$InputDir`未设置或为空，则会导致麻烦：您会突然列出`/`（根）文件夹中的文件。例如，由于拼写错误，可能会发生这种情况：

```
inputDir=...
for file in "$InputDir"/* 
```

Unix 上的案例很重要 :-)

为了帮助您理解这样`set -x`的代码，请在要调试的代码之前的一行中使用 ("enable tracking")。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-18T11:56:47.803

不同之处在于引用`'*'`。在第一种情况下，循环只执行一次，当传递给时，`$file`等于`/home/XXX/*`然后扩展到目录中的所有文件`echo`。在第二种情况下，它每个文件执行一次，`$file`依次等于每个文件名。

底线 - 改变：

```
for file in $InputDir'*' 
```

至：

```
for file in $InputDir* 
```

或者，更好，并使其更具可读性 - 更改：

```
InputDir=/home/XXX/
for file in $InputDir'*' 
```

至：

```
InputDir=/home/XXX
for file in $InputDir/* 
```

# c# - 尝试将 TextBox.Text 值转换为 Int32 时出错

> ID：16082210
> 
> 赞同：0
> 
> 时间：2013-04-18T11:53:08.750
> 
> 标签：c#, textbox, type-conversion

在`txtDefinavalor.Text`我只能输入 1% 到 999% 的值，所以我编写了代码，如果值高于 100%，则将文本框的值更改为 100%。为此，我从文本框中删除了 % 并使用 convert.int32 制作了 if 代码（有相同的错误），然后尝试了 int32.Parse （有相同的错误）。

错误是“输入字符串的格式不正确”在线：

```
string valor = txtDefinavalor.Text.Replace("%", string.Empty); 
```

我认为替换“”后的文本框已经是整数并且不需要转换，但我不能让字符串>值

查看完整代码：

```
if (rbtPercentualmensal.Checked || rbtPercentualmedioanual.Checked)
{
    string valor = txtDefinavalor.Text.Replace("%", string.Empty);
    if (Int32.Parse(valor) > 100)
    {
        txtDefinavalor.Text = "100%";
    }
} 
```

怎么解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:10:06.677

所有这些字符串操作都很棒而且很有趣，但是如果关键是用户不应该在输入中输入空格，那**你为什么要让他**呢？

考虑到其他回答这个问题的人，解决方案是让用户保持直截了当，而不是让他们输入虚假字符。

除了作为学术练习之外，我会跳过所有这些 sting 处理和 int 解析，而是利用已经编写的内置代码。

只需从控件中派生一个新控件，`NumericUpDown`让它为您完成繁重的工作。

就像是：

```
public partial class PercentageNumericUpDown : NumericUpDown
{
    public PercentageNumericUpDown()
    {
        InitializeComponent();
    }

    protected override void UpdateEditText()
    {
        this.Text = this.Value + "%";
    }
} 
```

的`override`将`UpdateEditText()`确保在编辑发生后自动为您附加 % 符号。

您可以设置有效值的范围，只允许用户输入（或向上/向下值），您也可以在此处获得自动验证。它具有您可以设置的属性`Min`。`Max`

如果需要，它还允许您设置负范围。和小数位，如果你需要的话。

如果可以，不妨利用内置控件，而不是重新发明轮子。

只是一个想法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:12:04.157

解决了问题。我使用了 Convert.int16，但主要问题是 valor 得到了错误的文本框值，所以它是空值，我认为因此我出错了。无论如何，为了答案。现在它的工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:12:12.473

检查这段示例源代码：

```
using System;

namespace ConsoleApplication1
{
    class Program
    {
        public static string FilterText(string input)
        {
            // Replace % by spaces, then remove all spaces/tabs with Trim function.
            string filteredText = input.Replace("%", " ").Trim();
            // Parse the text.
            int number = Int32.Parse(filteredText);
            // Fix not expected values.
            number = (number < 0) ? 0 : number;
            number = (number > 100) ? 100 : number;

            return number + "%";
        }

        public static void Main(string[] args)
        {
            Console.WriteLine("\"100%\": \"" + FilterText("100%") + "\"");
            Console.WriteLine("\"  50%\t\t\": \"" + FilterText("  50%\t\t") + "\"");
            Console.WriteLine("\"0%\": \"" + FilterText("0%") + "\"");
            Console.WriteLine("\"150%\": \"" + FilterText("150%") + "\"");
            Console.WriteLine("\"   -06%  \t \": \"" + FilterText("   -06%  \t ") + "\"");
        }
    }
} 
```

此示例的输出为：

```
"100%": "100%"
"  50%          ": "50%"
"0%": "0%"
"150%": "100%"
"   -06%         ": "0%" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T12:02:05.513

如果您使用的是 winforms，请使用仅允许您输入数字的 maskedtextbox，甚至是 numericupdown 字段，您可以设置它的上限和下限，并且只允许输入数字。

如果您使用的是 asp.net，那么您应该只使用不允许他们输入某些值的验证控件。例如范围验证器。

然后我假设是一个按钮单击比较变得容易得多，因为您不必删除任何 % 符号或任何类似的东西。此外，当您试图确定某物是否是数字时，您应该使用 tryparse 来确保它实际上是一个数字。

```
int test;
if(Int32.TryParse(txtDefinavalor.Text, out test)
{
    // do something here

}
else
{
   // error condition handled here
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T12:03:06.353

尝试 int32.TryParse

```
if (rbtPercentualmensal.Checked || rbtPercentualmedioanual.Checked)
{
int j ;
string valor = txtDefinavalor.Text.Replace("%", string.Empty);
if(Int32.TryParse(valor,out j) && j > 100)
{
  //// Do what ever you want here ...

}
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T11:57:56.667

尝试：

```
string valor = txtDefinavalor.Text.Trim().Replace("%", "");
if (Convert.ToInt32(valor) > 100)
{
    txtDefinavalor.Text = "100%";
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-18T11:58:42.690

尝试替换“。” 和“，”（如果用户输入了它们），也做 TRIM！

```
string valor = txtDefinavalor.Text.Replace("%", string.Empty).Replace(",", string.Empty).Replace(".", string.Empty).Trim(); 
```

或者

您的字符串中可能有一些无效的 Int char。为了解决这个问题，使用这个 foreach 循环：

```
 foreach (char letter in valor)
        {
            if(!char.IsDigit(letter))
                valor = valor.Replace(letter.ToString(), string.Empty);
        } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-18T12:04:03.357

@Habib 可能是对的 - 输入字符串中有一些非数字字符。但是，我首选的方法是消除在文本框中添加百分号的需要。要么将其放在标识文本框的标签中，要么将其作为文本框**之后**的标签。

# android - 如何获取最后一个 ListView 项目位置

> ID：16082212
> 
> 赞同：2
> 
> 时间：2013-04-18T11:53:12.750
> 
> 标签：android, listview, radio-button

我用单选按钮创建了一个列表视图。列表视图如下图所示： ![在此处输入图像描述](https://i.stack.imgur.com/Yn0Mo.jpg)

我的 getView 是：

```
public View getView(final int position, View convertView, ViewGroup parent) {
    ViewHolder holder = null;
    PaymentData rowItem = getItem(position);
    LayoutInflater mInflater = (LayoutInflater) context
            .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    if (convertView == null) {
        convertView = mInflater.inflate(
                com.android.paypal.homeactivity.R.layout.list_item, null);
        holder = new ViewHolder();
        holder.radioBtn = (RadioButton) convertView
                .findViewById(com.android.paypal.homeactivity.R.id.rdb_payment_method);
        holder.btPaymentMethod = (Button) convertView
                .findViewById(com.android.paypal.homeactivity.R.id.bt_item_event);
        convertView.setTag(holder);
    } else
        holder = (ViewHolder) convertView.getTag();

    holder.radioBtn.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {

            if ((position != mSelectedPosition) && (mSelectedRB != null)) {
                mSelectedRB.setChecked(false);
            }

            mSelectedPosition = position;
            mSelectedRB = (RadioButton) v;
        }
    });

    if (mSelectedPosition != position) {
        holder.radioBtn.setChecked(false);
    } else {
        holder.radioBtn.setChecked(true);
        if (mSelectedRB != null && holder.radioBtn != mSelectedRB) {
            mSelectedRB = holder.radioBtn;
        }
    }

    holder.radioBtn.setText(rowItem.getRdbText());
    holder.btPaymentMethod.setText(rowItem.getBtText());
    return convertView;

} 
```

我想在屏幕第一个出现时自动检查最后一个单选按钮。我怎样才能做到这一点。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T12:15:05.747

持有一个布尔值来表示用户是否自己选择了任何东西。让布尔值成为`userSelected = false;`

现在你可以做`getView()`：

```
if(position==getCount()-1 && userSelected==false)
    holder.radioBtn.setChecked(true);
else
    holder.radioBtn.setChecked(false); 
```

在onItemClick中，当用户自己做出选择后，只需设置`userSelected=true;`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T12:13:21.563

您的最后一个职位是，adpater 类中的方法在`int lastpostion = getcount() -1;`哪里`getcount()`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-29T05:10:22.083

使用这种方法

```
mListView.setOnScrollListener(new OnScrollListener() {

        @Override
        public void onScrollStateChanged(AbsListView view, int scrollState) {

            if (scrollState == onScroll) {
                if (mListView.getLastVisiblePosition() == adapter.getCount() - 1) {
                    //Update new data here
                                            // and then, notify your adapter 
                                            adapter.notifyDataSetChanged();
                }
            }
        }

        @Override
        public void onScroll(AbsListView view, int firstVisibleItem, int visibleItemCount, int totalItemCount) {

        }

    }); 
```

# javascript - jQuery：我需要 keyUp 和 change 事件吗？

> ID：16082213
> 
> 赞同：33
> 
> 时间：2013-04-18T11:53:14.133
> 
> 标签：javascript, jquery

我有一个包含 2 个表单的页面；每个表单都有一个输入文本字段；

在第一种形式的输入文本中找到的值必须与在第二种形式的输入文本中找到的值相同；

当值改变时，其他输入文本字段也修改它的值；

我应该同时使用`onkeyup`和`onchange`事件吗？

如果不是，哪一个是正确的使用？

我问这个是因为它接缝我有 2 个帖子请求，我认为这就是原因。

```
 $('input.searchbox').keyup( function(){
       $('input.txtfieldsearch').val($('input.searchbox').val());
       listViewUpdate();
       $('input.txtfieldsearch').trigger("keyup");
   });

    $('input.txtfieldsearch').keyup( function(){
       $('input.searchbox').val($('input.txtfieldsearch').val());
       listViewUpdate();
    });

   $('input.searchbox').change( function(){
       $('input.txtfieldsearch').val($('input.searchbox').val());
       listViewUpdate();
       $('input.txtfieldsearch').trigger("change");
   });

    $('input.txtfieldsearch').change( function(){
       $('input.searchbox').val($('input.txtfieldsearch').val());
       listViewUpdate();
    }); 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-04-18T12:52:03.573

您可以使用[`$.on()`](http://api.jquery.com/on/)函数并附加**多个处理程序**。

```
$("#element").on('keyup change', function (){
   // Your stuff...
}); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2014-07-01T08:54:03.893

如果您不需要为旧版浏览器提供支持，则只能使用“输入”事件。每次输入元素中的值更改时都会触发它。以下是支持的浏览器列表：[https ://developer.mozilla.org/en-US/docs/Web/Events/input](https://developer.mozilla.org/en-US/docs/Web/Events/input)

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-18T13:00:04.670

[`onkeyup`](https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onkeyup)主要在用户按下一个键然后释放时触发。[`onchange`](https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers/onchange)如果用户使用浏览器的自动完成功能，就会发生这种情况。您应该使用该[`.on()`](http://api.jquery.com/on/)方法来捕获这两个事件，以防万一：

```
$('input.searchbox').on('keyup change', function(e){
    $('input.txtfieldsearch').val($('input.searchbox').val());
    listViewUpdate();
    $('input.txtfieldsearch').trigger(e.type);
});

$('input.txtfieldsearch').on('keyup change', function(){
    $('input.searchbox').val($('input.txtfieldsearch').val());
    listViewUpdate();
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-18T11:58:19.997

如果你想对变化做出反应，你应该使用`change`.

在某些情况下，keyup 不会进行更改（如 shift）和没有 keyup 的更改（粘贴）的情况。

# laravel - Laravel：在 JOIN 中使用 Fluent 中的复杂条件

> ID：16082214
> 
> 赞同：7
> 
> 时间：2013-04-18T11:53:16.027
> 
> 标签：laravel, laravel-3

由于复杂的架构和需要使用 Fluent 或 Eloquent 的库（不仅仅是原始 DB::query() ），我需要创建：

```
LEFT JOIN `camp_to_cabin` 
ON `camper_to_cabin`.`cabin_id` = `camp_to_cabin`.`cabin_id`
AND `camp_to_cabin`.`camp_id` =1 OR `camp_to_cabin`.`camp_id` IS NULL 
```

作为连接子句；我已经尝试了回调和我能想到的所有其他东西，但无法获得正确的语法来生成。

我努力了：

```
 ->left_join('camp_to_cabin', function ($join){
        $join->on( 'camper_to_cabin.cabin_id', '=', 'camp_to_cabin.cabin_id')
        $join->on( 'camp_to_cabin.camp_id', '=', 1)
        $join->on( 'camp_to_cabin.camp_id', '=', null)

    }) 
```

但它在我的 1 & null 周围加上了反引号（我知道 null 位不正确 - 正在试验），我无法摆脱；否则它看起来很接近

有什么帮助吗？

TIA

* * *

谢谢，菲尔-最终答案是：

```
->left_join('camp_to_cabin', function ($join) use ($id){
$join->on( 'camper_to_cabin.cabin_id', '=', 'camp_to_cabin.cabin_id');
$join->on( 'camper_to_cabin.cabin_id', '=', DB::raw($id));
$join->or_on( 'camper_to_cabin.cabin_id', 'IS', DB::raw('NULL'));
 }) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-18T13:21:51.603

看起来您需要使用[`DB::raw()`](http://laravel.com/docs/database/fluent#expressions)否则`->on()`需要两列。就像是...

```
->left_join('camp_to_cabin', function ($join){
    $join->on( 'camper_to_cabin.cabin_id', '=', 'camp_to_cabin.cabin_id')
    $join->on( 'camp_to_cabin.camp_id', '=', DB::raw(1))
    $join->or_on( 'camp_to_cabin.camp_id', '=', DB::raw(null))
}) 
```

# vbscript - 从文件中提取文本字符串

> ID：16082215
> 
> 赞同：0
> 
> 时间：2013-04-18T11:53:17.633
> 
> 标签：vbscript

我正在编写一个实用程序，用于将网络上所有设备的所有系统信息收集到 XML 文档中，其中一个值是某个软件版本号。不幸的是，版本号仅存储在每台机器上的单个文本文件中（c:\master.txt），更有趣的是，每个文本文件的格式都不同，具体取决于所使用的图像。

可以说

```
Product Number: 11dsSt2 BRANDONII,STNS6.0.2.200 
```

下一个

```
Ver: 22335TS BOX2 S6.1.3.011,STN 
```

等等。

我所做的是创建一个 VBS 来查找与版本模式匹配的数字模式，即

```
[A-Z]#.#.#.### 
```

这可行，但是我只想输出该模式，而不是整行。这是我的代码。有什么建议么？

```
Const ForReading = 1
Set objRegEx = CreateObject("VBScript.RegExp")
objRegEx.Pattern = "[A-Z]{1}[0-9]{1}.[0-9]{1}.[0-9]{1}.[0-9]{3}"
objregex.global = true
objregex.ignorecase = true
Set objFSO = CreateObject("Scripting.FileSystemObject")
Set objFile = objFSO.OpenTextFile("C:\master.txt", ForReading)
Do Until objFile.AtEndOfStream
strSearchString = objFile.ReadLine
set colMatches = objRegEx.Execute(strSearchString)
If colMatches.Count > 0 Then
Addmatch
End If

Loop
objFile.Close
Sub Addmatch 'Creates a text file with the part number
Const ForAppending = 8
Set objFSO = CreateObject("Scripting.FileSystemObject")
set objFile1 = objFSO.OpenTextFile("C:\test.txt", ForAppending, True)
objFile1.Writeline strSearchString 
objFile1.Close

end sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:05:32.033

使用 first/one and only match 获取值，并将其传递给 Addmatch 的略微修改版本：

```
If colMatches.Count > 0 Then
   Addmatch colMatches(0).Value
End If 
```

...

```
Sub Addmatch(sWhatToWriteLn) ' some truthful comment
  Const ForAppending = 8
  Set objFSO = CreateObject("Scripting.FileSystemObject")
  Set objFile1 = objFSO.OpenTextFile("C:\test.txt", ForAppending, True)
  objFile1.Writeline sWhatToWriteLn 
```

...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T13:02:20.033

您正在存储从文件中读取的整行（在 中`strSearchString`），而不仅仅是匹配的文本。改用这样的东西（未经测试！）：

```
if ColMatches.Count > 0 then
  AddMatch(ColMatches(0))      ' Just grab the matched text and pass to AddMatch
End If

Sub AddMatch(strMatchedText)   ' Change to accept parameter of text to write out
  ' Other code
  objFile1.Writeline strMatchedText
  objFile1.Close
End Sub 
```

# javascript - 如何使用 JQuery 或 Javascript 将数据导出到 CSV

> ID：16082231
> 
> 赞同：8
> 
> 时间：2013-04-18T11:54:04.370
> 
> 标签：javascript, jquery, asp.net, export-to-csv

**我需要什么：** 我们在 response.d 中有值，即逗号分隔值。现在我想将 response.d 的数据导出到 .csv 文件。

我写了这个函数来执行这个。我收到了 response.d 中的数据，但没有导出到 .csv 文件，因此请给出解决此问题的解决方案，将数据导出到 .csv 文件中。

```
function BindSubDivCSV(){ 
  $.ajax({
      type: "POST", 
      url: "../../WebCodeService.asmx / ShowTrackSectorDepartureList", 
      data: "{}", 
      contentType: "application/json; charset=utf-8", 
      dataType: "json",
      success: function (response) {  
        alert(response.d);//export to csv function needed here
      },
      error: function (data) {}
  });
  return false;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-26T07:44:10.923

如果您无法控制服务器端的工作方式，这是我在另一个 SO 问题中提供的客户端解决方案，等待该 OP 的接受：[Export to CSV using jQuery and html](https://stackoverflow.com/questions/16078544/export-to-csv-using-jquery-and-html)

**正如我在那边的回答中提到的那样，**您必须考虑某些限制或限制，其中包含更多详细信息。****

 *** * *

这是我提供 的相同**演示：http:** [//jsfiddle.net/terryyounghk/KPEGU/](http://jsfiddle.net/terryyounghk/KPEGU/)

并让您大致了解脚本的外观。

**您需要更改的是如何迭代数据（在另一个问题的情况下是表格单元格）以构造有效的 CSV 字符串。**这应该是微不足道的。

```
$(document).ready(function () {

    function exportTableToCSV($table, filename) {

        var $rows = $table.find('tr:has(td)'),

            // Temporary delimiter characters unlikely to be typed by keyboard
            // This is to avoid accidentally splitting the actual contents
            tmpColDelim = String.fromCharCode(11), // vertical tab character
            tmpRowDelim = String.fromCharCode(0), // null character

            // actual delimiter characters for CSV format
            colDelim = '","',
            rowDelim = '"\r\n"',

            // Grab text from table into CSV formatted string
            csv = '"' + $rows.map(function (i, row) {
                var $row = $(row),
                    $cols = $row.find('td');

                return $cols.map(function (j, col) {
                    var $col = $(col),
                        text = $col.text();

                    return text.replace('"', '""'); // escape double quotes

                }).get().join(tmpColDelim);

            }).get().join(tmpRowDelim)
                .split(tmpRowDelim).join(rowDelim)
                .split(tmpColDelim).join(colDelim) + '"',

            // Data URI
            csvData = 'data:application/csv;charset=utf-8,' + encodeURIComponent(csv);

        $(this)
            .attr({
            'download': filename,
                'href': csvData,
                'target': '_blank'
        });
    }

    // This must be a hyperlink
    $(".export").on('click', function (event) {
        // CSV
        exportTableToCSV.apply(this, [$('#dvData>table'), 'export.csv']);

        // IF CSV, don't do event.preventDefault() or return false
        // We actually need this to be a typical hyperlink
    });
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-07-01T08:46:04.043

使用上面的代码（来自 Terry Young），我发现在 Opera 中它会拒绝为文件命名（简单地称之为“下载”）并且并不总是可靠地工作。

为了让它工作，我必须创建一个二进制 blob：

```
 var filename = 'file.csv';
    var outputCSV = 'entry1,entry2,entry3';
    var blobby = new Blob([outputCSV], {type: 'text/plain'});

    $(exportLink).attr({
                'download' : filename,
                'href': window.URL.createObjectURL(blobby),
                'target': '_blank'
                });

    exportLink.click(); 
```

另请注意，动态创建“exportLink”变量不适用于 Firefox，因此我必须在我的 HTML 文件中包含它：

```
 <div>
        <a id="exportLink"></a>
    </div> 
```

使用上述方法，我已经使用 Windows 7 64bit 和 Opera (v22)、Firefox (v29.0.1) 和 Chrome (v35.0.1916.153 m) 成功测试了这一点。

为了在 Internet Explorer 上启用类似的功能（尽管方式不太优雅），我不得不使用 Downloadify。**

# android - 为什么应用程序崩溃？具有不同视图的 ListView

> ID：16082233
> 
> 赞同：-1
> 
> 时间：2013-04-18T11:54:05.397
> 
> 标签：android, android-listview

我尝试将 ListView 创建为设置页面。第一行是 EditText；2-5 行是两个文本。

所以我的适配器类：

```
public class SettingsAdapter extends BaseAdapter {
    private static final int TYPE_NAME = 0;
    private static final int TYPE_SETTING = 1;
    private static final int TYPE_MAX_COUNT = 2;

    SPMEditActionActivity   context;
    LayoutInflater          inflater;
    ArrayList               data;

    SettingsAdapter(SPMEditActionActivity _context) {

        context = _context;
        inflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        data = new ArrayList();

        for(int i=0;i<5;i++)
            data.add("Hello");
    }

    @Override
    public int getItemViewType(int position) {
        return position==0 ? TYPE_NAME : TYPE_SETTING;
    }

    @Override
    public int getViewTypeCount() {
        return TYPE_MAX_COUNT;
    }

    @Override
    public int getCount() {
        return data.size();
    }

    @Override
    public Object getItem(int position) {
        return data.get(position);
    }

    @Override
    public long getItemId(int position) {
        return position;
    }

    // пункт списка
    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        int type = getItemViewType(position);

        View view = convertView;
        if (view == null) {
            if(type == TYPE_NAME)
                view = inflater.inflate(R.layout.editactionactivity_settings_name, parent, false);
            else
                view = inflater.inflate(R.layout.editactionactivity_setting, parent, false);

        }
        return view;
    }

} 
```

活动：

```
public class SPMEditActionActivity extends Activity {

    final int START_TIME_DIALOG = 1;
    final int END_TIME_DIALOG = 2;

//==============UI===============================================
    private ListView        settings_listview ; 
    private SettingsAdapter settings_adapter;

    private Button save_button;
    private Button cancel_button;
//==============================================================

//========UI LISTENERS==========================================

        private OnClickListener save_button_listener = new OnClickListener() {
            public void onClick(View v) {
                 save();
            }
        };      
        private OnClickListener cancel_button_listener = new OnClickListener() {
            public void onClick(View v) {
                 cancel();
            }
        };

//==============================================================

//==============================================================

//=================LIFECYCLE METHODS============================
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_spmeditaction);

        save_button  = (Button) findViewById(R.id.EditActionActivity_save_button);
        cancel_button= (Button) findViewById(R.id.EditActionActivity_cancel_button);

        settings_adapter = new SettingsAdapter(SPMEditActionActivity.this);
        settings_listview.setAdapter(  settings_adapter    );

        save_button.setOnClickListener(save_button_listener);
        cancel_button.setOnClickListener(cancel_button_listener);

    }

//==============================================================
    private void save(){
        finish();

    }

    private void cancel(){
        finish();
    }

} 
```

在活动中，当我设置适配器时

```
settings_adapter = new SettingsAdapter(this);
settings_listview.setAdapter(  settings_adapter    ); 
```

我的应用程序因 NullPointerException 而崩溃。

谁能向我解释，我做错了什么？

PS。我用这个[教程](http://android.amberfog.com/?p=296)

日志输出：

```
04-18 15:59:19.982: E/AndroidRuntime(24150): FATAL EXCEPTION: main
04-18 15:59:19.982: E/AndroidRuntime(24150): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.hemul.soundprofilemanager/com.hemul.soundprofilemanager.SPMEditActionActivity}: java.lang.NullPointerException
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2059)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2084)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.app.ActivityThread.access$600(ActivityThread.java:130)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1195)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.os.Handler.dispatchMessage(Handler.java:99)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.os.Looper.loop(Looper.java:137)
04-18 15:59:19.982:E/AndroidRuntime(24150):     at android.app.ActivityThread.main(ActivityThread.java:4745)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at java.lang.reflect.Method.invokeNative(Native Method)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at java.lang.reflect.Method.invoke(Method.java:511)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:786)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:553)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at dalvik.system.NativeStart.main(Native Method)
04-18 15:59:19.982: E/AndroidRuntime(24150): Caused by: java.lang.NullPointerException
04-18 15:59:19.982: E/AndroidRuntime(24150):    at com.hemul.soundprofilemanager.SPMEditActionActivity.onCreate(SPMEditActionActivity.java:111)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.app.Activity.performCreate(Activity.java:5008)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1079)
04-18 15:59:19.982: E/AndroidRuntime(24150):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2023)
04-18 15:59:19.982: E/AndroidRuntime(24150):    ... 11 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:12:21.680

你 `settings_listview`是空的，因为你没有在 onCreate 中分配对 this 的引用

像这样从 xml 获取您的列表视图参考

```
settings_listview=(ListView)findViewById(R.id.yourlistview);  <-- your listview id in xml 
```

后`setContentView(R.layout.activity_spmeditaction);`

# php - ioncube 在原始文件被加密后是否保留评论？

> ID：16082234
> 
> 赞同：0
> 
> 时间：2013-04-18T11:54:06.357
> 
> 标签：php, reflection, ioncube

我想使用`getDocComment()`Reflection的功能来收集上述功能的评论。它适用于未加密的 php 文件。但将来我想用 Ioncube 加密 php 源，我想知道 Ioncube 是否删除了内部 php 注释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:14:15.643

根据他们的文档，ioncube 似乎默认保留了这些评论：

> 3.15.3 省略文档注释 [ --no-doc-comments ] 文档注释是具有以下语法的注释： /** 我的代码注释 */ 这些注释由 PHP 5 反射 API 公开，并由 PHP 5 保留默认编码器。为了从编码文件中省略这些文档注释，请指定 --no-doc-comments 选项。

# macos - Aparapi 添加示例

> ID：16082235
> 
> 赞同：2
> 
> 时间：2013-04-18T11:54:11.220
> 
> 标签：macos, opencl, java-6, aparapi

我正在研究 Aparapi ( [https://code.google.com/p/aparapi/](https://code.google.com/p/aparapi/) ) 并且包含其中一个示例的奇怪行为。样本是第一个，“添加”。构建和执行它，没问题。我还放了下面的代码来测试GPU是否真的用过

```
if(!kernel.getExecutionMode().equals(Kernel.EXECUTION_MODE.GPU)){
    System.out.println("Kernel did not execute on the GPU!");
} 
```

它工作正常。但是，如果我尝试将数组的大小从 512 更改为大于 999 的数字（例如 1000），我将得到以下输出：

```
!!!!!!! clEnqueueNDRangeKernel() failed invalid work group size
after clEnqueueNDRangeKernel, globalSize[0] = 1000, localSize[0] = 128
Apr 18, 2013 1:31:01 PM com.amd.aparapi.KernelRunner executeOpenCL
WARNING: ### CL exec seems to have failed. Trying to revert to Java ###
JTP

Kernel did not execute on the GPU! 
```

这是我的代码：

```
 final int size = 1000;

  final float[] a = new float[size];
  final float[] b = new float[size];

  for (int i = 0; i < size; i++) {
     a[i] = (float)(Math.random()*100);
     b[i] = (float)(Math.random()*100);
  }

  final float[] sum = new float[size];

  Kernel kernel = new Kernel(){
     @Override public void run() {
        int gid = getGlobalId();
        sum[gid] = a[gid] + b[gid];
     }
  };

  Range range = Range.create(size);
  kernel.execute(range);

  System.out.println(kernel.getExecutionMode());
  if (!kernel.getExecutionMode().equals(Kernel.EXECUTION_MODE.GPU)){
     System.out.println("Kernel did not execute on the GPU!");
  }

  kernel.dispose(); 
```

}

我尝试使用指定大小

```
Range range = Range.create(size, 128); 
```

正如谷歌小组中所建议的那样，但没有任何改变。

我目前正在使用 Java 1.6.0_43 的 Mac OS X 10.8 上运行。Aparapi 版本是最新的（2012-01-23）。

我错过了什么吗？有任何想法吗？

提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T13:23:32.400

Aparapi 继承了 OpenCL 的“网格样式”实现。当您指定执行范围（例如 1024）时，OpenCL 会将这个“范围”分成大小相等的组。可能 4 组 256 或 8 组 128。

组大小*必须*是范围的一个因素（因此 assert(range%groupSize==0)）。

默认情况下，Aparapi 在内部选择组大小。

但是您选择完全指定要使用的范围和组大小

范围 r= Range.range(n,128)

您有责任确保 n%128==0。

从错误中，您似乎选择了 Range.range(1000,128)。

可悲的是 1000 % 128 != 0 所以这个范围会失败。

如果您指定

范围 r = Range.range(n)

Aparapi 将通过查找 n 的最大公因数来选择有效的组大小。

尝试删除 128 作为第二个参数。

加里

# mysql - INNER JOIN 后从多个表中获取最大日期

> ID：16082238
> 
> 赞同：2
> 
> 时间：2013-04-18T11:54:34.430
> 
> 标签：mysql, sql, greatest-n-per-group

我有两个下表

```
table 1)
ID |  HOTEL ID | NAME 
1       100      xyz 
2       101      pqr
3       102      abc

table 2)
ID | BOOKING ID | DEPARTURE DATE | AMOUNT
1         1       2013-04-12        100
2         1       2013-04-14        120
3         1       2013-04-9          90
4         2       2013-04-14        100
5         2       2013-04-18        150
6         3       2013-04-12        100 
```

我想在 mysql 中获取 reault，以便它从表 2 中获取具有 MAX DEPARTURE DATE 的行。

```
ID | BOOKING ID | DEPARTURE DATE | AMOUNT
2         1       2013-04-14        120
5         2       2013-04-18        150
6         3       2013-04-12        100 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T11:59:15.783

```
SELECT  b.ID,
        b.BookingID,
        a.Name,
        b.departureDate,
        b.Amount
FROM    Table1 a
        INNER JOIN Table2 b
            ON a.ID = b.BookingID
        INNER JOIN
        (
            SELECT  BookingID, MAX(DepartureDate) Max_Date
            FROM    Table2
            GROUP   BY BookingID
        ) c ON  b.BookingID = c.BookingID AND
                b.DepartureDate = c.Max_date 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/fc62e/3)

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-18T11:57:40.087

出色地，

```
SELECT * FROM `table2` ORDER BY `DEPARTURE_DATE` DESC LIMIT 0,1 
```

应该有帮助

# javascript - 如何使用 IE 的 jquery 和刷新下拉列表克隆带有 html 控件的 div 而不使用其内容？

> ID：16082242
> 
> 赞同：0
> 
> 时间：2013-04-18T11:54:40.103
> 
> 标签：javascript, asp.net-mvc-3, jquery-ui, jquery

我正在使用**jquery .clone()**函数来克隆一个具有**6 个控件（下拉菜单、文本框等）的****div**。我有一个功能，其中有 2 个下拉菜单**DDL A**和**DDL B**。现在更改 DDL A 项会填充 DDL B 中的内容。此功能在**Chrome**、**Firefox**、**Ipad中运行良好，但在****IE**中不起作用。

 ******> 该场景就像我克隆了 6 个控件的 div 以添加新的数据输入行，并且当我从 DDL A 中选择项目时，它会在 DDLB 中显示相应的项目。但是当我再次从 DDL A 中选择其他项目时，DDL B 的选项不会刷新。奇怪的是，在 IE 的 Firebug 中，DDL B 显示了正确的选项，但视图却没有。

是 IE 在重新填充之前没有刷新下拉列表还是它不理解 jquery .clone() 函数？谁能帮我找到合适的解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:04:18.353

IE 的问题是当我们编写脚本时它不会清除下拉列表

**$("#ddlB").empty();**

其他浏览器可以很好地使用这个片段。

所以我们需要使用

**$("#ddlB")[0].options.length = 1;**

这些清除了 IE 中旧的下拉状态和数据。我现在成功地创建了一个功能，我可以在其中克隆具有不同 html 控件的 div。以下是片段

```
$(function () {
    $('.addRow').click(function () {
         var clickNumrow = $(this).data('clickNumrow');
         if (!clickNumrow) clickNumrow = 1;
         $("#original").clone(true).insertBefore('.addnewRow').attr('id', 'original_' + clickNumrow);
         $("#original_" + clickNumrow + " select#materialid")[0].options.length = 1;
         $(this).data('clickNumrow', ++clickNumrow);
     });  
}); 
```

我终于可以刷新下拉项的选择更改下拉列表

```
$(function () {
     $('select#categoryid').change(function () {
         var url = "/Material/FillMatByCatId";
         var ddlsource = this;
         var prt = $(this).parent().parent().parent().attr('id');
         var ddltarget = '#' + prt + ' select#materialid';
         if ($(this).val() != '') {

            $.getJSON(url, { CatId: $(this).val() }, function (data) {
                $(ddltarget)[0].options.length = 1;
                $(ddltarget).empty();
                $.each(data, function (index, optionData) {

                $(ddltarget).append("<option value='" + optionData.Value + "'>" + optionData.Text + "</option>");
                });
            });
         }
     });
}); 
```******

# python - 如何在 python tkinter 中绑定 Ctrl+/？

> ID：16082243
> 
> 赞同：17
> 
> 时间：2013-04-18T11:54:46.167
> 
> 标签：python, key-bindings

```
<Control-Shift-Key-0>
<Control-Key-plus> 
```

有效，但

```
<Control-Key-/> 
```

没有。

我无法在 python中绑定`ctrl`+ 。`/`是否有所有可能键的文档？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2013-04-18T12:02:14.000

使用`<Control-slash>`：

```
def quit(event):
    print "you pressed control-forwardslash"
    root.quit()

root = tk.Tk()
root.bind('<Control-slash>', quit)      # forward-slash
# root.bind('<Control-backslash>', quit)  # backslash
root.mainloop() 
```

* * *

我没有指向这些事件名称的完整列表的链接。这是我收集的部分列表：

```
| event                 | name                  |
| Ctrl-c                | Control-c             |
| Ctrl-/                | Control-slash         |
| Ctrl-\                | Control-backslash     |
| Ctrl+(Mouse Button-1) | Control-1             |
| Ctrl-1                | Control-Key-1         |
| Enter key             | Return                |
|                       | Button-1              |
|                       | ButtonRelease-1       |
|                       | Home                  |
|                       | Up, Down, Left, Right |
|                       | Configure             |
| window exposed        | Expose                |
| mouse enters widget   | Enter                 |
| mouse leaves widget   | Leave                 |
|                       | Key                   |
|                       | Tab                   |
|                       | space                 |
|                       | BackSpace             |
|                       | KeyRelease-BackSpace  |
| any key release       | KeyRelease            |
| escape                | Escape                |
|                       | F1                    |
|                       | Alt-h                 | 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2016-01-06T04:12:33.827

这是所有 tk keysysm 代码的列表： [https ://www.tcl.tk/man/tcl8.6/TkCmd/keysyms.htm](https://www.tcl.tk/man/tcl8.6/TkCmd/keysyms.htm)

我正在寻找的两个是`<Win_L>`和`<Win_R>`。

# javascript - 如何将数组从一个 html 传递到另一个 html 页面？

> ID：16082250
> 
> 赞同：0
> 
> 时间：2013-04-18T11:55:12.403
> 
> 标签：javascript, html, arrays, cordova

我将它用于**Phonegap**，所以我更喜欢javascript中的解决方案。

我发现了许多使用**PHP**的解决方案。这就是为什么我想把它说清楚。

好吧，我得到了一个数组，它的值来自数据库。我想将此数组传递给第二个 HTML 页面。

要传递变量，正在使用以下代码...

**编辑：**

```
 window.location.href="1stpage.html"?var1=&value; 
```

希望，我对编码是正确的。

请指导我，如果我错了。

**参考建议的答案进行更改**

Julio Meca Hansen 先生，我尝试实现相同的

```
 window.location.href='1st page.html?var1=5&var2=6'; 
```

并尝试通过在第二页上打印值来验证它......

```
console.log("value1: "+var1 +"value2: "+var2 ); 
```

唉！，我得到这个错误......

```
E/Web Console(12476): ReferenceError: Can't find variable: var1 at file:///android_asset/www/1st%20page.html?var1=5&var2=6:17 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:32:23.947

如果这个数组只被 JavaScript 使用，那么不要使用 cookie。Cookie 用于存储服务器需要访问的信息，随意设置它们可以显着增加您的网络使用量！

相反，请使用 JavaScript 的`localStorage`界面。所有现代浏览器都支持它（IE7 及更低版本不算“现代”，尤其是 Windows 更新实际上迫使您更新），并且非常易于使用：

```
var someArray = [1,2,3,4];
if( !window.localStorage) alert("Sorry, you're using an ancient browser");
else {
    localStorage.myArray = JSON.stringify(someArray);
} 
```

稍后，您可以检索它：`JSON.parse(localStorage.myArray)`

我希望这是你想要达到的目标。如果没有，请澄清您的问题；）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:26:53.580

我假设您使用的是 jquery，但在普通的旧 js 中原理是相同的 - 使用 cookie 例如

[如何在 jquery cookie 中存储一个数组？](https://stackoverflow.com/questions/1959455/how-to-store-an-array-in-jquery-cookie)

这实际上存储了数组，而不是其他答案中描述的大量变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T12:16:42.100

如果您不想使用 javascript：

```
<a href="1stpage.html?var1=5&var2=6">
   <img src="images/img1.png" alt="" />
</a> 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T11:58:58.987

如果代码链接到图像，它会更像这样：

```
<img src="images/img1.png" alt="" onclick="window.location.href='1stpage.html?var1=5&var2=6';"> 
```

修改它以满足您的需求：P

# mysql - 在mysql中查找奇怪的字符

> ID：16082252
> 
> 赞同：1
> 
> 时间：2013-04-18T11:55:27.727
> 
> 标签：mysql

一年前，我们将数据迁移到 MySQL。由于编码不匹配，许多奇怪的字符（Ã、ª、€ 等）被插入到记录中。我们想跟踪整个数据库中的所有这些字符。

我尝试了以下查询。

```
 select * from <table_name> where <field_name> regexp '[^a-zA-Z0-9&,$\'"() .-]' 
```

它给了我除了 az、AZ、0-9、&、逗号、美元、单引号、双引号、括号、空格、句点、连字符之外的所有`<field_name>`条目.

但是要找到所有奇怪的字符需要很长时间，因为我们有大约 93 个表，每个表大约有 20 个字段。

有没有更好的方法来解决这个问题？

使用正确的编码设置再次重新导入不是一种选择，因为从那时起数据已经发生了很大变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:23:02.880

您提到的字符看起来像 utf-8 数据呈现，就好像它是 ASCII 或 Latin-1 八位字符。

这是关于如何找到问题的帖子。它比您的方法效果更好，并且在字符集匹配方面非常自律。

[如何在 MySQL 中找到非 ASCII 字符？](https://stackoverflow.com/questions/401771/how-can-i-find-non-ascii-characters-in-mysql/11741314#11741314)

您能否提供包含此垃圾的表之一的表定义？这样我们就可以看到表和列的字符集和排序规则设置。

# iphone - 如何在 xcode 模拟器中获取当前的经度和纬度？

> ID：16082254
> 
> 赞同：0
> 
> 时间：2013-04-18T11:55:30.973
> 
> 标签：iphone, xcode

我正在尝试按位置获取当前的经纬度，但我得到的都是 0.0000，我正在使用以下代码

```
(CLLocationCoordinate2D) getLocation{
    CLLocationManager *locationManager = [[[CLLocationManager alloc] init] autorelease];
    locationManager.delegate = self;
    locationManager.desiredAccuracy = kCLLocationAccuracyBest;
    locationManager.distanceFilter = kCLDistanceFilterNone;
    [locationManager startUpdatingLocation];
    CLLocation *location = [locationManager location];
    CLLocationCoordinate2D coordinate = [location coordinate];

    return coordinate;
} 
```

并称之为使用：

```
CLLocationCoordinate2D coordinate = [self getLocation];
NSString *latitude = [NSString stringWithFormat:@"%f", coordinate.latitude];
NSString *longitude = [NSString stringWithFormat:@"%f", coordinate.longitude];

NSLog(@"*dLatitude : %@", latitude);
NSLog(@"*dLongitude : %@",longitude); 
```

我还在项目中添加了核心定位。请给我提意见。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:05:25.457

实现位置管理器的委托方法

```
- (void)locationManager:(CLLocationManager *)manager didUpdateToLocation: (CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation 
```

`newLocation.coordinate.latitude`你可以使用and得到 lat 和 lng`newLocation.coordinate.longitude`

对于在模拟器中设置当前位置，您可以关注@ios_av

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:06:41.947

IPHone 模拟器总是为 lat 和 long 给出 0.0000，因为它没有检测到位置。

您可以使用此路径添加自定义位置： **选择 iPhone 模拟器并选择调试 --> 位置 --> 自定义位置**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T08:18:56.000

尝试这个

1.  在 iPhone 模拟器中运行项目
2.  在 TextEdit 文件中创建以下文件，例如将其称为 MyOffice。将扩展名设为 .gpx ![在此处输入图像描述](https://i.stack.imgur.com/aRh5p.png)
3.  在 Xcode 中的 Simulate 区域中选择`Add GPX File to Project...`![在此处输入图像描述](https://i.stack.imgur.com/9pZsA.png)
4.  将创建的文件从菜单添加到项目。
5.  现在您可以在模拟区域中看到您的位置：![在此处输入图像描述](https://i.stack.imgur.com/Vr2Rp.png)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T12:04:32.463

您必须使用此路径添加自定义位置：选择 iPhone 模拟器并`Debug -->Loction --> Custom Location`在菜单中选择

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T12:08:00.660

在模拟器中，您可以强制一个本地位置：转到菜单：调试：位置并选择其中一种声音（有些通过预先注册的路线模拟运动）或输入您选择的坐标

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T12:13:52.437

如果您想在您的应用程序中获取当前位置，请查看本教程
[http://www.techotopia.com/index.php/An_Example_iOS_5_iPhone_Location_Application](http://www.techotopia.com/index.php/An_Example_iOS_5_iPhone_Location_Application)

如果您没有在设备上运行此程序，则为模拟器添加您的纬度和经度
，检查此
[https://stackoverflow.com/a/12637537/2106973](https://stackoverflow.com/a/12637537/2106973)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-18T12:04:02.997

模拟器无法返回当前位置，它给出了默认的加利福尼亚纬度和经度位置，但您可以通过 - 调试 -> 位置 -> 自定义位置在模拟器中设置静态位置

# android - 字符串列表数组搜索字符串

> ID：16082255
> 
> 赞同：-2
> 
> 时间：2013-04-18T11:55:45.547
> 
> 标签：android, string, search, arraylist

我在搜索列表数组时遇到问题，试图找到某个字符串，然后将该字符串存储到一个名为 name 的变量中

```
 private List<String> listview_array1 = new ArrayList<String>();
    private List<String> listview_array2 = new ArrayList<String>();
    private List<String> listview_array3 = new ArrayList<String>();

                    String name1 = null;

    if(listview_array1.contains("The")) {

        //assign value to name1     

        System.out.println(name1);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:03:18.210

文档是你的朋友。一般来说，我如何使用一个类的任何问题的第一行都是查找它的文档。

[http://developer.android.com/reference/java/util/ArrayList.html](http://developer.android.com/reference/java/util/ArrayList.html)

至于您的问题，您将需要 indexof 方法。详情见上页。

# .net - 如何使用具有特定日期的 Sitecore 项目进行 Lucene 搜索？

> ID：16082256
> 
> 赞同：2
> 
> 时间：2013-04-18T11:55:45.880
> 
> 标签：.net, sitecore, lucene.net, sitecore6

我有一个内容项是 Sitecore，其日期字段名为“EventDate”。我想使用 Lucene.Net 搜索具有特定日期的项目。

以下是我尝试过的代码，但我没有得到结果：

```
var index = SearchManager.GetIndex("event_search_index");   
var items = new List<EventDetailItem>();   
var eventDateString = eventDate.Year.ToString("D4") + eventDate.Month.ToString("D2") +  eventDate.Date.Day.ToString("D2");

using (var context = new IndexSearchContext(index))
{
    var searchTerm = new Lucene.Net.Index.Term("EventDate", eventDateString);    
    var query = new Lucene.Net.Search.TermQuery(searchTerm);   
    var topFieldDocs = context.Searcher.Search(query, 1);    
    if (topFieldDocs != null) 
    {
        var scoreDocs = topFieldDocs.ScoreDocs;
        foreach (var scoreDoc in scoreDocs)
        {
            var doc = context.Searcher.Doc(scoreDoc.doc);
            var uriField = doc.GetField("_url");
            var itemUri = new Sitecore.Data.ItemUri(uriField.StringValue());
            var item = Sitecore.Context.Database.GetItem(itemUri.ToDataUri());

            if (item == null) continue;

            var eventItem = new EventDetailItem(item);
            items.Add(eventItem);
         }
     }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T12:26:50.147

您正在使用标准**Sitecore**日期字段（切换到原始值视图），因此日期存储为`yyyyMMddTHHmmss`字符串，例如：

```
20130418T140122 
```

然后你`TermQuery`只使用查询的第一部分，例如：

```
20130418 
```

因此，您看不到任何结果`TermQuery`与确切的字段值匹配。

您应该尝试`WildcardQuery`使用`20130418*`或使用`RangeQuery`从`20130418T000000`包含此值开始到`20130819T000000`排除此值结束。

[您可以在此处找到有关解决 Sitecore 和 Lucene 问题的更多信息。](http://www.cognifide.com/blogs/sitecore/troubleshooting-sitecore-lucene-search-and-indexing/)

# java - JavaFX - 使节点对事件不可见

> ID：16082259
> 
> 赞同：1
> 
> 时间：2013-04-18T11:55:53.583
> 
> 标签：java, javafx-2, javafx

我需要使 JavaFX 中的一些节点对鼠标事件不可见。例如，有一个 HBox，里面有 6 个元素，HBox 上有一个 Rectangle，现在我需要在 HBox 的 6 个元素上捕获 MouseEntered 和 MouseExited 事件，这是不可能的，因为 Rectangle 正在捕获它们。

谢谢你的回答

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:53:43.220

用于`node.setMouseTransparent(true);`使节点对鼠标事件透明。

# magento - 如何在 Magento 的主页上加载模型框

> ID：16082261
> 
> 赞同：0
> 
> 时间：2013-04-18T11:55:58.997
> 
> 标签：magento

我想在 Magento 主页上显示一个登录模型框，并希望在进入该站点之前先对用户进行身份验证。我想在主页加载时显示它。有人可以告诉我我该怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T22:57:31.913

Vinai Kopp（来自 Magento）为此编写了一个模块：

[http://www.magentocommerce.com/magento-connect/login-only-catalog.html](http://www.magentocommerce.com/magento-connect/login-only-catalog.html)

# c++ - char数组的加法

> ID：16082262
> 
> 赞同：2
> 
> 时间：2013-04-18T11:56:00.197
> 
> 标签：c++, c

这可能是一个愚蠢的问题。玩弄C++，发现这行代码让我有点懵

```
char buffer[7] = {'0', '1', '0', '9', '0', '1'};

// It prints 010901
printf("%s", buffer);

// It prints 0901
printf("%s", buffer+2); 
```

为什么我们可以（+ 2）缓冲区变量，它就像向右移动了 2 个字符？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T11:57:20.330

在这样的上下文中，数组名称`buffer`“降级”为只是指向第一个值的指针。由于 C 和 C++ 支持指针运算，并且字符串被表示为指向字符数组的指针，这很好。

请注意终止`'\0'`字符，这是隐含的，因为您指定的大小比您提供的初始化数据大。

不过，您的代码可以简化为：

```
const char buffer[] = "010901"; 
```

您可以像这样可视化它：

```
 +-----+-----+-----+-----+-----+-----+-----+
buffer ------> | '0' | '1' | '0' | '9' | '0' | '1' | '\0 |
               +-----+-----+-----+-----+-----+-----+-----+
                              ^
                              |
                              |
                         buffer + 2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T11:57:56.010

数组类型的表达式经常进行数组到指针的转换。基本上，`buffer`这里的名称可以转换为指向其第一个元素的指针。这就是在这两种情况下发生的情况。该数组被转换为 a`char*`然后`printf`将其解释为指向 C 样式字符串中的第一个字符。

在第二种情况下，在转换为指针之后，您将该指针加 2。这为您提供了指向第三个元素的指针。`printf`再次将其视为 C 样式字符串，但从您创建的数组的第三个字符开始。

起初我以为你的字符串不是以空结尾的有问题。但是，您的代码没问题，因为数组的大小为 7，并且最后一个元素将设置为 0，因为您没有为其指定初始化程序。然而，这令人困惑。我建议你改为这样声明你的数组：

```
char buffer[] = "010901"; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:01:46.227

你需要终止那个字符串，兄弟！

```
char buffer[7] = {'0', '1', '0', '9', '0', '1', '\0'};

// It prints 010901
printf("%s", buffer);

// It prints 0901
printf("%s", buffer+2); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T11:58:18.060

C++ 定义了一个隐式的数组到指针的转换；也就是说，数组可以隐式转换为指向其第一个元素（索引为 0 的元素）的指针。这意味着您的代码基本上是这样解释的：

```
printf("%s", (&buffer[0]) + 2); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T12:00:21.583

```
char buffer[7] = {'0', '1', '0', '9', '0', '1' , '\0'}; 
```

C中的数组名基本上也是指向数组位置的指针

`buffer[i]`被翻译为`*(buffer+i)`即添加`i`到指针值[跟随指针算术]。因此，它给出了该位置的地址。 `printf`将打印 a`%s`直到遇到 a `\n`。因此，输出。

检查[这个](http://pw1.netcom.com/~tjensen/ptr/pointers.htm)以了解指针和数组

# oracle - 需要帮助以在单个邮件中获取整个文件，该邮件在 oracle PL/SQL 中大小为 4 mb

> ID：16082264
> 
> 赞同：0
> 
> 时间：2013-04-18T11:56:03.997
> 
> 标签：oracle, plsql, clob, varchar2

PL/SQL 过程中的以下代码检查字节大小，如果它超过 30000 字节，它会迭代数据并 **为每 30000 字节（30 kb）发送邮件附件（通过多个邮件的 txt 文件）。**
我需要**在单个邮件中获取整个文件，该邮件**在 oracle PL/SQL 中大小为 4 mb。

lv_message_tab 的数据类型是 varchar2(32767) 。我可以使用**CLOB**数据类型而不是 * *Varchar2(32767)，* * 如果是，请建议如何使用。

提前一百万谢谢！！！

```
FOR lv_idx in 1..pv_message.COUNT
      LOOP
         lv_message := lv_message||pv_message(lv_idx)|| lv_cr;

         IF LENGTH(lv_message) >= 30000
         THEN

          lv_message_tab.EXTEND;
          lv_message_tab(lv_message_tab.LAST) := lv_message;
          lv_message := null;

         END IF;

      END LOOP;
--This send the attachment for 30000 characters and above
      IF lv_message_tab.COUNT > 0 
      THEN

           FOR lv_idx in 1..lv_message_tab.COUNT
           LOOP

              UTL_SMTP.HELO(lv_conn, lv_smtp_host);
              UTL_SMTP.MAIL(lv_conn, gc_sender);
              UTL_SMTP.RCPT(lv_conn, lv_to_email_ids);
              UTL_SMTP.RCPT(lv_conn, lv_cc_email_ids);

               UTL_SMTP.DATA(lv_conn,
              'Date: '   || TO_CHAR(SYSDATE, gc_dd_month_yyyy_format) || lv_cr ||
              'From: '   || gc_sender || lv_cr ||
              'Subject: '|| lv_subject || lv_cr ||
              'To: '     || lv_to_email_ids || lv_cr ||
              'CC: '     || lv_cc_email_ids || lv_cr ||

              'MIME-Version: 1.0'|| lv_cr ||    -- Use MIME mail standard
              'Content-Type: multipart/mixed;'|| lv_cr ||
              ' boundary="-----SECBOUND"'|| lv_cr ||
                lv_cr ||

              '-------SECBOUND'|| lv_cr ||
              'Content-Type: text/plain;'|| lv_cr ||
              ' name="excel.csv"'|| lv_cr ||
              'Content-Transfer_Encoding: 8bit'|| lv_cr ||
              'Content-Disposition: attachment;'|| lv_cr ||
              ' filename="'||pv_file_name||'"'|| lv_cr ||
              lv_cr ||lv_message_tab(lv_idx)
              || lv_cr ||   -- Content of attachment
              lv_cr ||

               '-------SECBOUND--' );   

          END LOOP;

      END IF;

      --This send the attachment for the rest of the data...for the last few iterations
      IF lv_message IS NOT NULL
      THEN

          UTL_SMTP.HELO(lv_conn, lv_smtp_host);
          UTL_SMTP.MAIL(lv_conn, gc_sender);
          UTL_SMTP.RCPT(lv_conn, lv_to_email_ids);
          UTL_SMTP.RCPT(lv_conn, lv_cc_email_ids);

           UTL_SMTP.DATA(lv_conn,
          'Date: '   || TO_CHAR(SYSDATE, gc_dd_month_yyyy_format) || lv_cr ||
          'From: '   || gc_sender || lv_cr ||
          'Subject: '|| lv_subject || lv_cr ||
          'To: '     || lv_to_email_ids || lv_cr ||
          'CC: '     || lv_cc_email_ids || lv_cr ||

          'MIME-Version: 1.0'|| lv_cr ||    -- Use MIME mail standard
          'Content-Type: multipart/mixed;'|| lv_cr ||
          ' boundary="-----SECBOUND"'|| lv_cr ||
            lv_cr ||

          '-------SECBOUND'|| lv_cr ||
          'Content-Type: text/plain;'|| lv_cr ||
          ' name="excel.csv"'|| lv_cr ||
          'Content-Transfer_Encoding: 8bit'|| lv_cr ||
          'Content-Disposition: attachment;'|| lv_cr ||
          ' filename="'||pv_file_name||'"'|| lv_cr ||
          lv_cr ||lv_message
          || lv_cr ||   -- Content of attachment
          lv_cr ||

           '-------SECBOUND--' );   

     END IF;

     UTL_SMTP.QUIT(lv_conn);

    pv_rtn := TRUE;

ELSE

    pv_rtn := FALSE;

END IF; 
```

* * *

我通过将输入作为集合表来调用该过程，例如

程序

```
SP1_Send_letter_ATTACH_WAL(pv_job_id IN job.job_id%TYPE,
                           pv_status IN job_transaction_details.status_id%TYPE,
                           pv_subject IN VARCHAR2,
                           pv_message IN stringtable,
                           pv_file_name IN VARCHAR2,
                           pv_date_time IN DATE DEFAULT SYSDATE,
                           pv_rtn OUT BOOLEAN); 
```

我只想将变量的数据存储到clob 数据类型`pv_message`的变量中。`lv_message`

```
lv_message CLOB; 
```

如何存储 lv_message := pv_message（即集合数据类型为 CLOB 类型）。我已经尝试过使用 'to_clob()' 函数进行类型转换，`lv_message = to_clob(pv_message)`但它不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:26:48.933

尝试在循环中使用[UTL_SMTP.WRITE_DATA](http://docs.oracle.com/cd/B19306_01/appdev.102/b14258/u_smtp.htm#i1004100)过程，而不是创建整个邮件。

我无法测试它，但应该是这样的：

```
 UTL_SMTP.HELO(lv_conn, lv_smtp_host);
          UTL_SMTP.MAIL(lv_conn, gc_sender);
          UTL_SMTP.RCPT(lv_conn, lv_to_email_ids);
          UTL_SMTP.RCPT(lv_conn, lv_cc_email_ids);

           UTL_SMTP.DATA(lv_conn,
          'Date: '   || TO_CHAR(SYSDATE, gc_dd_month_yyyy_format) || lv_cr ||
          'From: '   || gc_sender || lv_cr ||
          'Subject: '|| lv_subject || lv_cr ||
          'To: '     || lv_to_email_ids || lv_cr ||
          'CC: '     || lv_cc_email_ids || lv_cr ||

          'MIME-Version: 1.0'|| lv_cr ||    -- Use MIME mail standard
          'Content-Type: multipart/mixed;'|| lv_cr ||
          ' boundary="-----SECBOUND"'|| lv_cr ||
            lv_cr ||

          '-------SECBOUND'|| lv_cr ||
          'Content-Type: text/plain;'|| lv_cr ||
          ' name="excel.csv"'|| lv_cr ||
          'Content-Transfer_Encoding: 8bit'|| lv_cr ||
          'Content-Disposition: attachment;'|| lv_cr ||
          ' filename="'||pv_file_name||'"'|| lv_cr ||
          lv_cr;

 -- this is the importent part (other parts were taken from the question and were just moved out of the loop)
      FOR lv_idx in 1..lv_message_tab.COUNT
       LOOP

         UTL_SMTP.WRITE_DATA(lv_conn, lv_message_tab(lv_idx));
       END LOOP;

     UTL_SMTP.WRITE_DATA(lv_conn,lv_cr ||   -- Content of attachment
          lv_cr ||'-------SECBOUND--' ); 
```

以前在OTN上有一个包叫`DEMO_MAIL`，但是我找不到……
如果能找到的话，非常有用。

# php - 匹配以字符开头的子字符串

> ID：16082266
> 
> 赞同：0
> 
> 时间：2013-04-18T11:56:17.660
> 
> 标签：php, regex

我想匹配以某个字符（星号）开头的字符串部分：

`abc*DEFxyz` =>`*DEF`

`abc*DE*Fxyz`=> `*DE`,`*F`

试过了`preg_match_all('/[$\*A-Z]+/', $string, $matches);`，但是好像不行。我`*DE*F`在第二个例子

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T11:59:13.510

将您的正则表达式更改为： `\*[A-Z]+`

[http://regexr.com?34itc](http://regexr.com?34itc)

您的正则表达式：`[$\*A-Z]+` 表示包含`*`和 AZ 字符的字符串，没有提及有关 start 的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:09:09.263

尝试：

```
^[^*]*\* 
```

上面写着“从行首，跳过所有非星号字符并停在第一个”

扩展这个：

```
s/^[^*]*\*(.*)/ 
```

将返回星号之后的字符串的其余部分。要包括星号，请像这样调整

```
s/^[^*]*(\*.*)/ 
```

这是检查正则表达式的好工具：http: [//gskinner.com/RegExr/](http://gskinner.com/RegExr/)

希望这可以帮助

# cuda - 直接在设备上创建带有字段的对象

> ID：16082270
> 
> 赞同：3
> 
> 时间：2013-04-18T11:56:39.620
> 
> 标签：cuda, thrust

我正在尝试创建一个将在设备上分配的类。我希望构造函数在设备上运行，以便包括内部字段在内的整个对象在设备上自动分配，而不必创建主机对象然后手动将其复制到设备。

我正在使用推力 device_new

这是我的代码：

```
using namespace thrust;

class Particle
{
    public:
    int* data;

    __device__  Particle()
    {
        data = new int[10];
        for (int i=0; i<10; i++)
        {
            data[i] = i*2;
        }
    }
};

__global__ void test(Particle* p)
{
    for (int i=0; i<10; i++)
        printf("%d\n", p->data[i]);
}

int main() {

    device_ptr<Particle> p = device_new<Particle>();

    test<<<1,1>>>(thrust::raw_pointer_cast(p));

    cudaDeviceSynchronize();

    printf("Done!\n");

} 
```

我用 device_new （推力）注释了构造函数`__device__`，但这不起作用，有人可以向我解释为什么吗？

为帮助喝彩

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T14:27:21.627

我相信答案就在[此处](https://groups.google.com/forum/?fromgroups#!topic/thrust-users/X6kCgV9ARIg)给出的描述中。知道幕后推力的人可能会出现并指出这是否属实。

尽管自 2009 年以来推力发生了很大变化，但我相信`device_new`可能仍在使用某种形式的操作，其中对象实际上是在主机上临时实例化，然后复制到设备上。但是，我相信上述参考文献中描述的尺寸限制不再适用。

我能够让它工作：

```
#include <stdio.h>
#include <thrust/device_ptr.h>
#include <thrust/device_new.h>

#define N 512

using namespace thrust;

class Particle
{
    public:
    int data[N];

    __device__ __host__  Particle()
    {
//        data = new int[10];
        for (int i=0; i<N; i++)
        {
            data[i] = i*2;
        }
    }
};

__global__ void test(Particle* p)
{
    for (int i=0; i<N; i++)
        printf("%d\n", p->data[i]);
}

int main() {

    device_ptr<Particle> p = device_new<Particle>();

    test<<<1,1>>>(thrust::raw_pointer_cast(p));

    cudaDeviceSynchronize();

    printf("Done!\n");

} 
```

有趣的是，如果我在构造函数上省略`__host__`装饰器，它会给出虚假的结果，这表明临时对象复制机制仍然存在。如果我切换到使用动态分配而不是静态分配，它还会给出虚假结果（并且 cuda-memcheck 报告越界访问错误）`data`，还建议我`device_new`在主机上使用临时对象创建，然后是副本到设备。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T18:46:14.137

首先感谢 Rovert Crovella 的投入（和以前的答案）

所以显然我“高估”了 device_new 可以做什么，我认为它可以直接在设备上初始化对象，因此内部任何动态分配的内存也在设备上完成。

但似乎 device_new 基本上只是与手动方式相同：

```
Particle temp;
Particle *d_p;
cudaMalloc(&d_p, sizeof(Particle));
cudaMemcpy(d_p, &temp, sizeof(Particle), cudaMemcpyHostToDevice); 
```

所以它创建一个临时主机对象并复制它，就像手动完成一样。这意味着在对象内部分配的内存是在主机上分配的，并且只有指针作为对象的一部分被复制，因此您不能在内核中使用该内存，您必须手动将该内存复制到设备，并且推力不会'似乎没有这样做。

因此，它只是创建临时主机对象并复制它的一种更简洁的方法，除了您无法复制内部分配的动态内存，因为您无权访问该临时变量。

我希望在未来，CUDA 中会有一种方法或功能可以让您直接在设备上初始化对象，因此构造函数（或其他地方）中的任何动态分配的数据也可以在设备上分配，而不是繁琐的方式手动复制每一块内存。

# javascript - 在 iframe 中下载不起作用

> ID：16082274
> 
> 赞同：2
> 
> 时间：2013-04-18T11:56:44.197
> 
> 标签：javascript, iframe, windows-8, download, internet-explorer-10

我们在 Windows 8 IE 10 中存在下载问题。

目前我们使用以下（伪代码）：

```
<form id="downloadformid" target="iframeid" action="https://url/" method="post">
  <input type="hidden" name="item1" value="value1"/>
  <input type="hidden" name="item2" value="value2"/>
</form>
<iframe id="iframeid" style="display:none;"></iframe>
<script type="text/javascript">
  $(document).ready(function() {
    var downloadForm = document.getElementById("downloadformid")
    if (downloadForm != null) {
      downloadForm.submit()
    }
  })
</script> 
```

这样做的问题是，这不会在 Windows 8 IE 10 上显示下载选项。

这是否有原因，是否有解决方法或更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T02:29:58.357

尝试将**名称**属性添加到`<iframe>`

```
<iframe name="iframeid" id="iframeid" style="display:none;"></iframe> 
```

# objective-c - 在 Objective-C 中定义静态常量值的类

> ID：16082275
> 
> 赞同：19
> 
> 时间：2013-04-18T11:56:47.663
> 
> 标签：objective-c, static, constants

我想创建一个包含可从所有项目访问的静态值的类。

伪代码：

```
class Constants:
  constant String API_URL : "http://api.service.com"
  constant Integer SOME_VALUE : 7 
```

我该怎么做`Objective-C`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-18T13:28:20.450

您的问题的答案是**extern** keyword 。我会用一个例子向你解释。在您的项目中添加目标 c 类并将它们命名为 Common ，现在在 Common.h

```
 @interface Common : NSObject

     extern NSString *SiteApiURL;

     @end 
```

使用 extern 关键字定义 NSString 类的实例后，您需要切换到 Common.m 类并初始化 NSString (SiteApiURL) 的值

```
 #import "Common.h"

     @implementation Common

     NSString *SiteApiURL = @"http://api.service.com";

     @end 
```

像这样在 project-Prefix.pch 文件中导入 Common.h 类

```
 #import <Availability.h>

    #ifndef __IPHONE_3_0
    #warning "This project uses features only available in iOS SDK 3.0 and later."
    #endif

    #ifdef __OBJC__
        #import <UIKit/UIKit.h>
        #import <Foundation/Foundation.h>
        #import "Common.h"
    #endif 
```

全部完成，现在您可以在整个项目的任何地方使用对象“SiteApiURL”，并且您无需在任何地方导入任何类，即您可以直接在项目的任何地方使用此变量。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-04-18T12:02:40.377

你可以使用预处理器来做到这一点：

```
#define API_URL @"http://api.service.com"
#define SOME_VALUE (7) 
```

访问定义很简单：`[object do:API_URL];`

或者你可以使用常量

```
NSString * const apiURL = @"http://api.service.com";
NSNumber * const someValue = @7; 
```

访问 const 就像访问变量一样，所以字符串只是一个简单的调用。NSNumber 是原语的对象包装器，因此您需要像这样访问它：`someValue.intValue`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T11:58:46.687

您可以`Singleton`使用所有必要的常量创建一个[这是一个示例](http://www.galloway.me.uk/tutorials/singleton-classes/)

如果您不想创建类，则可以使用静态私有变量和静态 getter。

```
@interface

+(NSString*) getValue;

@end

@implementation

static NSString *_value = @"....";

+(NSString*) getValue {
   return _value;
}

@end 
```

# python - 在命令行中将复杂对象传递给 python 脚本

> ID：16082280
> 
> 赞同：0
> 
> 时间：2013-04-18T11:56:58.073
> 
> 标签：python, command-line, arguments

我是 Python 编程的初学者，我想使用命令行 (cmd) 将复杂对象（Python 字典或类对象）作为参数传递给 Python 脚本。我看到**sys.argv**只获取字符串参数。

这是我想要的一个例子：

```
class point(object):
     def __init__(self,x,y):
         self.__x=x
         self.__y=y
p=point(4,8)
import os
os.system('""xxxxxx.exe" "-s" "../create_scenario.py" "'+ p +'""') 
```

xxxxxx.exe 是一个接受运行带有 -s 选项的 python 脚本的程序。谢谢大家！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:49:46.727

您可以尝试使用 pickle 模块对字符串进行序列化\反序列化到\从字符串。寻找[转储](http://docs.python.org/2/library/pickle.html#pickle.dumps)和[装载](http://docs.python.org/2/library/pickle.html#pickle.loads)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:00:36.620

你可以使用[`eval`](http://docs.python.org/3.3/library/functions.html#eval)：

```
my_dict = eval(sys.argv[1])
print(my_dict) 
```

命令提示：

```
$ my_script.py {1:2}
$ {1: 2} 
```

但是不建议您执行此操作（[请参阅此帖子](https://stackoverflow.com/questions/1832940/is-using-eval-in-python-a-bad-practice)）。您应该避免这种情况，而是将数据存储在文件中（例如使用[JSON ）。](http://docs.python.org/3.3/library/json.html)

# c++ - 抽象函数

> ID：16082282
> 
> 赞同：0
> 
> 时间：2013-04-18T11:56:59.830
> 
> 标签：c++, function, abstract

我在锻炼方面有点问题。我有 2 节课：

首先 ：

```
namespace Abstract{

    class AbstractClass{
    public:

        virtual void setName(const std::string & _name) =0;
        virtual void print() =0;
        void DynamicCastTest(){};

    };

} 
```

第二 ：

```
class ConcreteClass : public Abstract::AbstractClass{

    std::string type;

public:
    ConcreteClass();
    ConcreteClass(const char* a);
    ~ConcreteClass();

    static Abstract::AbstractClass* CreateConcreteClass(const char* a);

    virtual void setName(const std::string & _name); 
    virtual void print(); 

}; 
```

第二类的cpp文件：

```
#include "concreteClass.h"

ConcreteClass::ConcreteClass(){
    type = "";
}

ConcreteClass::ConcreteClass(const char* a){
    type = a;
}

ConcreteClass::~ConcreteClass(){}

static ConcreteClass* CreateConcreteClass(const char* a){
    return new ConcreteClass(a);
}

void ConcreteClass::setName(const std::string & _name){
    type = _name;
}

void ConcreteClass::print(){
    std::cout<<type<<std::endl;
} 
```

但在我的主要，当我打电话时：

```
const char* s = "";
Abstract::AbstractClass* a = ConcreteClass::CreateConcreteClass(s); 
```

在编译中，Visual out me 一个错误 LNK2019 ：

> "public: 静态类 ConcreteClass * __cdecl ConcreteClass::CreateConcreteClass(char const *)" (?CreateConcreteClass@ConcreteClass@@SAPAV1@PBD@Z)

在这最后一行。为什么 ？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T12:06:24.567

啊，明白了：

```
static ConcreteClass* CreateConcreteClass(const char* a){
    return new ConcreteClass(a);
} 
```

不是以下声明：

```
ConcreteClass::CreateConcreteClass(s) 
```

我会留给你弄清楚修复是什么，因为这是一个很好的学习体验，而且我 100% 确定你不需要练习复制粘贴 - 或者你可以等待，因为我'确定其他人很快就会发布“固定”答案，仅仅是因为他们不在乎你是否学习。

编辑：澄清。您已经在类中声明了一个静态成员函数。并且您已经定义了一个不是任何类成员的静态函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:10:34.287

您声明`CreateConcreateClass`为：

```
 static Abstract::AbstractClass* CreateConcreteClass(const char* a); 
```

但后来我们有了这个，它是一个静态函数，但不是你在类中声明的那个：

```
static ConcreteClass* CreateConcreteClass(const char* a){
    return new ConcreteClass(a);
} 
```

签名必须与您的声明相匹配，因此应该是这样的：

```
Abstract::AbstractClass* ConcreteClass::CreateConcreteClass(const char* a){
    return new ConcreteClass(a);
} 
```

# c# - 在数据绑定列表框等待 C# Windows Phone 7 应用程序（MVVM Light）中的异步操作时显示进度覆盖？

> ID：16082284
> 
> 赞同：0
> 
> 时间：2013-04-18T11:57:19.707
> 
> 标签：c#, telerik, progress-bar, windows-phone-7.1, mvvm-light

我有一个带有 Telerik 数据绑定列表框的 C# Windows Phone 7 应用程序。数据绑定列表框的 ItemsSource 属性绑定到我的视图模型中的一个属性，该属性从 RESTful Web 服务中检索其内容。只读属性的逻辑如下：

> List 属性是否为空（首次使用）？
> 
> ^ 返回一个空列表
> 
> ^ 异步检索列表内容
> 
> ^ 检索完成时引发属性更改事件

它工作正常，现在我想在异步操作正在进行时显示进度叠加。我正在使用 Coding4Fun 工具包的进度覆盖控件。问题是我不知道在哪里“插入”正确的代码来显示和隐藏进度覆盖。我尝试从下面的视图模型中执行此操作（请参见下面的代码），但进度覆盖不可见。我猜那是因为它没有正确地作为当前可见的应用程序页面的父级？

如何正确显示进度叠加？请注意，如果有一个很好的 XAML 方法可以做到这一点，我想知道，否则我会尽我所能。

```
 /// <summary>
    /// Does the async load of the list we return to the data bound contro.
    /// </summary>
    /// 
    async private void LoadListContentsAsync()
    {
        bool bIsProgOverlayShowing = false;

        if (!IsLoadingList)
        {
            // Set the busy flag.
            IsLoadingList = true;

            Coding4Fun.Toolkit.Controls.ProgressOverlay po = new Coding4Fun.Toolkit.Controls.ProgressOverlay();

            po.Content = "Loading List";
            po.Show();

            // Set the cleanup flag for the progress overlay.
            bIsProgOverlayShowing = true;

            try
            {
                // Do the asynchronous load.
                List<string> bl = await this.GetListContentsAsync();

                _listContents = bl.ToObservableCollection();

                // Raise the property changed event handler.
                RaisePropertyChanged("ListContents");
            }
            finally
            {
                // Make sure the loading flag is cleared.
                IsLoadingList = false;

                // Hide the progress overlay if it is showing.
                if (bIsProgOverlayShowing)
                    po.Hide();
            }
        } // if (!IsLoadingList)
    } // async private void LoadListContentsAsync() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:09:40.477

你可能会发现我的`TaskCompletionNotifier`类型很有用。您可以[从这里获取源代码](http://nitoasyncex.codeplex.com/SourceControl/changeset/view/cfd83ac30725#Source/Nito.AsyncEx%20%28NET4,%20Win8,%20SL4,%20WP75%29/TaskCompletionNotifier.cs)；它将在我的 AsyncEx 库的下一个版本中，但不在当前版本中。

您的 VM 属性可以是类型`ITaskCompletionNotifier<ObservableCollection<string>>`，并且可以通过传递一个`Task<ObservableCollection<string>>`to来创建`TaskCompletionNotifierFactory.Create`。实际的 VM 属性可以是只读的。

完成后，您的数据绑定代码就可以`myVMProperty.Result`用来绑定到`ObservableCollection<string>`（该`Result`属性是`null`直到任务完成）。其他数据绑定代码可用于`myVMProperty.IsCompleted`绑定到一个布尔值，指示操作是否完成。进度指示器可以使用常见的布尔到可见性转换器绑定到此。

# .net - 当此下拉列表来自用户控件时，如何从下拉列表中获取值以进行绑定？

> ID：16082286
> 
> 赞同：1
> 
> 时间：2013-04-18T11:57:23.080
> 
> 标签：.net, vb.net, drop-down-menu, user-controls, bind

我的用户控件（UCProducs）中有 3 个下拉列表（cbb_state、cbb_products、cbb_item），每个都有一个数据源（ods_state、ods_products、ods_item），并且我有我的 .aspx 页面，它正在使用这个 UserControl....此页面具有必须绑定我的用户控件中的 3 个下拉列表中的值的 ObjectDataSource...我尝试了一些示例，但没有一个对我有帮助。

这是我的 UserControl 代码文件：

```
Imports System.Data.SqlClient
Partial Class UCProducts
Inherits System.Web.UI.UserControl

Public Property Item() As Integer
    Get
        If cbb_item.SelectedValue <> "" Then
            Return cbb_item.SelectedValue
        Else
            Return 0
        End If
    End Get
    Set(ByVal value As Integer)
        cbb_item.SelectedValue = value
        Distrito = fc_produts.value)
        If value > 0 Then
            cbb_products.Enabled = True

        End If
    End Set
End Property

Public Property State() As Integer
    Get
        If cbb_state.SelectedValue <> "" Then
            Return cbb_state.SelectedValue
        Else
            Return 0
        End If
    End Get
    Set(ByVal value As Integer)
        If Not value = 0 Then
            cbb_state.SelectedValue = value

        End If

    End Set
End Property

Public Property Products() As Integer
    Get
        Return cbb_products.SelectedValue
    End Get
    Set(ByVal value As Integer)
        cbb_products.SelectedValue = value
    End Set
End Property

Private Function fc_pega_sub(ByVal index As Integer) As Integer

        'my code
End Function

Private Function fc_pega_distrito(ByVal value As Integer) As Integer

        'my code
End Function

Protected Sub cbb_regiao_SelectedIndexChanged(ByVal sender As Object, ByVal e As System.EventArgs) Handles cbb_regiao.SelectedIndexChanged
    'my code
End Sub
End Class 
```

在我的 .aspx 页面中：

```
 <uc5:UCProduts ID="ucProd" runat="server" /> 
```

我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-10T14:03:58.963

我终于做到了，哈哈，所以答案很简单......因为当我将 UserControl 放入我的页面时，我已经创建了我的属性“Products()”，我只需要引用绑定我的列的属性！这是解决方案：

```
<uc2:Products ID="Products" runat="server" Products='<%# Bind("fk_products") %>' /> 
```

# css - 媒体查询在 chrome 中不起作用，但在 iphone 上起作用

> ID：16082289
> 
> 赞同：1
> 
> 时间：2013-04-18T11:57:34.910
> 
> 标签：css, google-chrome, media-queries

我在样式表的底部添加了这个

```
@media only screen 
and (min-device-width : 320px) 
and (max-device-width : 480px) {

body {
 background: #000 !important;

 }

} 
```

它在 iphone 上运行良好，但我想通过调整浏览器大小在 ff 或 chrome 中进行测试，它确实添加了样式。我怎样才能让它工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T12:00:27.377

去除那个`-device`

```
@media only screen 
and (min-width : 320px) 
and (max-width : 480px) {

body {
 background: #000 !important;

 }

} 
```

`min-width max-width`测量浏览器窗口的宽度。`min-device-width max-device-width`测量永远不会改变的设备（即您的显示器）的宽度

# php - 如何通过 SOAP 将多语言文章导入 Magento？

> ID：16082291
> 
> 赞同：1
> 
> 时间：2013-04-18T11:57:37.520
> 
> 标签：php, magento, soap, import, internationalization

我想使用提供的 SOAP 接口将多语言文章导入 Magento。我已经能够为仅在其前端使用一种语言的商店做到这一点。

但我喜欢为国际商店执行此操作，即拥有多个商店视图的 Magento 商店。我知道商店视图的 ID 是`catalogProductCreate`SOAP 方法中的一个参数。但我犹豫是否使用不同的商店视图 ID 传输完整的产品记录两次，因为 Magento SOAP API 的速度并不真正为人所知。:-) 老实说，我无法相信有必要创建两次文章才能以两种语言显示它。

有没有更简单的方法可以使用 SOAP 将文章导入多个商店视图？两条记录仅在翻译后的描述性字符串上有所不同——价格、股票数据等都是相同的。有谁知道 Magento 如何处理这种情况？

# javascript - 如何检测表单字段实时更改以显示或隐藏提交按钮

> ID：16082293
> 
> 赞同：0
> 
> 时间：2013-04-18T11:57:41.257
> 
> 标签：javascript, jquery, forms

我的表格如下所示：

```
<form id="myform">
    <fieldset>
        <div class="row-fluid">
            <label class="checkbox"><input type="checkbox" id="status" name="status">Active</label>
        </div>
        <div class="row-fluid">
            <label>Address</label>
            <input type="text" id="city" name="city" />
            <input type="text" id="state" name="state" />
        </div>
        <a id="save" class="btn btn-primary hide">save changes</a>
        <a id="close" class="btn">Close</a>
    </fieldset>
</form> 
```

我的这个表格出现了预填充。那就是我的状态被检查了，name 的值为 Anyname，city 的值为 Anycity，State 的值为 AnyState。基本上，当表单出现时，保存更改表单是隐藏的。但是，如果用户单击任何字段，只需附加任何字符或删除字符，它就会实时检测到更改，任何立即设置的保存更改按钮显示即删除类隐藏。如果再次删除附加字符并将其设置为原始字符，则它应该再次隐藏保存更改按钮。

基本上它是实时检测表单字段更改并实时隐藏或显示按钮。

我看过几个与之相关的问题，但没有一个能满足我的要求。

我试过了

```
 $('myform:input, myform:checkbox').change(function() {
      $("#save").removeClass("hide");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:08:30.547

您指的是 ID 为 的元素`accept`，但在您的 HTML 中不存在该元素。

您的保存按钮的 ID 为`save`。

这是一个 jsfiddle，它在值更改时显示按钮：http: [//jsfiddle.net/Town/tUAeh/](http://jsfiddle.net/Town/tUAeh/)

为了在字段返回到以前的值时隐藏按钮，您需要存储初始值并将其与当前值进行比较，以确定是否实际发生了更改。

还值得注意的是，该`change`事件仅在失去焦点时在文本框上触发。我不确定这对你来说是否有问题，但你可能会更好地使用`keyup`它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:03:30.470

看看[这个工作的 jsFiddle](http://jsfiddle.net/tUAeh/4/)

```
$('input', '#myform').keyup(function() {
     if ( $(this).val() !=  $(this).attr('value') ){
          $("#save").removeClass("hide");
     }else{
         donthide = false;
         $('input', '#myform').each(function(){
             console.log($(this).val() + ' ?= ' + $(this).attr('value'));
             if ( $(this).val() != $(this).attr('value') ){
                 donthide = true;
             }
         });
         console.log(donthide);
         if (!donthide) $('#save').addClass('hide');
     }
}); 
```

这仅在所有字段都具有“值”属性时才有效，但您可以更改它以补偿缺失值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T13:00:58.943

首先，您必须保存当前值，然后在发生任何更改时进行比较。我使用 .data 来存储原始文件。

编辑：从原始文件中删除了一些调试/显示操作代码。

```
// save original values
$(':input').each(function () {
    var setvalue = getCurrentValue($(this));
    $(this).data('originalvalue', setvalue);
});
// check them if anything changes
$(':input').change(function () {
    if (checkvalues()) {
        $("#save").addClass("hide");
    } else {
        $("#save").removeClass("hide");
    }
});
//return current value for checking/setting
function getCurrentValue(checkMe) {
    var currentValue = '';
    if (checkMe.is(':checkbox')) {
        currentValue = checkMe.prop('checked');
    } else {
        currentValue = checkMe.val();
    }
    return currentValue;
}
// if any do not match original, return false
function checkvalues() {
    var original = true;
    $(':input').each(function () {
        var currentValue = getCurrentValue($(this));
        var originalValue = $(this).data('originalvalue');
        if (currentValue !== originalValue) {
            original = false;
        }
    });
    return original;
} 
```

编辑：上面的更紧凑的版本：

```
$(':input').each(function () {
    $(this).data('originalvalue', getCurrentValue($(this)));
});
$('#myform').on('change', ':input', function () {
    if (checkvalues()) {
        $("#save").addClass("hide");
    } else {
        $("#save").removeClass("hide");
    }
});

function getCurrentValue(checkMe) {
    return checkMe.is(':checkbox') ? checkMe.prop('checked') : checkMe.val();
}

function checkvalues() {
    var original = true;
    $(':input').each(function () {
        if (getCurrentValue($(this)) !== $(this).data('originalvalue')) {
            original = false;
        }
    });
    return original;
} 
```

使用中的紧凑版本示例：http: [//jsfiddle.net/gRXDN/](http://jsfiddle.net/gRXDN/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T12:23:40.140

~~由于您需要将原始值与当前值进行比较，因此您必须将原始值存储在某处。~~

正如 CBroe 在评论中指出的那样，您可以使用`defaultValue`or获取每个元素的原始值`defaultChecked`：

以下检查每个输入以查看值是否已更改，并返回已更改`length`的元素的（数量）。然后，您可以使用它来显示/隐藏保存按钮。

```
var $inputs = $('#myform :input');
$inputs.on('keyup change', function() {

  var dataChanged = $inputs.filter(function() {
    if ($(this).is(':checkbox')) {
      var originalValue = this.defaultChecked;
      var currentValue = this.checked;
    } else {
      var originalValue = this.defaultValue;
      var currentValue = this.value;
    }
    return originalValue != currentValue;
  }).length;    

  if (dataChanged == 0) {
    $('#save').addClass('hide') 
  } else { 
    $('#save').removeClass('hide');
  }

}); 
```

请注意我是如何附加`keyup()`事件以及`change()`事件的。这将在按下键时触发文本输入功能，并立即隐藏或显示保存按钮。

### [这是一个小提琴](http://jsfiddle.net/qaf4M/2/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T12:02:00.927

它给你一个错误吗？因为它应该这样做，因为您在#accept 之后缺少引号。而且我认为您的选择器很奇怪，请尝试

```
$('#myform input[type=text], #myform [type=checkbox]').change(); 
```

由于没有状态为 :input 的名为 myform 的元素

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T12:04:58.373

试试这个

```
$('input[type=text] input[type=checkbox]').change(function(){
    $('#save').removeClass('hide'); 
}); 
```

在表单中没有“接受”id。确保你删除类以接受 id。

# c - C中的等分布概率

> ID：16082295
> 
> 赞同：-2
> 
> 时间：2013-04-18T11:57:45.820
> 
> 标签：c, simulation, probability, server-load

我有一个运行超过 1000000 次迭代来模拟服务器负载的程序。请求的到达率是一个变量。例如，如果到达率是 2：这意味着在每 2 次迭代中，应该有 1 个请求传入，这将在模拟结束时生成“大约”500,000 个请求，依此类推。我不能仅仅通过根据到达率在每个第 n 个间隔引入一个新请求来做到这一点。一定有运气因素。

```
#include<stdio.h>
#include<time.h>
#include <stdlib.h>

//random number generator method
int random_number(int min_num, int max_num){
  int result=0,low_num=0,hi_num=0;

  if(min_num<max_num){
    low_num=min_num;
    hi_num=max_num+1; // this is done to include max_num in output.
  }else{
    low_num=max_num+1;// this is done to include max_num in output.
    hi_num=min_num;
  }
  result = (rand()%(hi_num-low_num))+low_num;
  return result;
}

int main(){
  srand(time(NULL));
  unsigned int arrivalRate = 2;
  unsigned int noOfRequests = 0;
  unsigned int timer;
  for(timer = 0; timer < 1000000; timer++){
    //gives a random number between 0 and arrival rate
    int x = random_number(0, arrivalRate);
    //there is a new request
    if(x <= 1){
      noOfRequests++;
    }    
  }
  printf("No of requests: %d", noOfRequests);
} 
```

因此，如果我使用到达率 2 运行此代码，它会生成大约 600,000 个请求，而这应该只有大约 500,000 个（+-1000 是可以容忍的）请求。如何改进我的代码以产生更合理的结果，它产生的结果比预期的要多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:22:15.550

我想问题在于随机数函数返回的值存在偏差。

rand() 返回一个浮点数，但**结果**被截断为整数，这将使其偏向较小的数字。由于当结果 <=1 时**noOfRequests 会**增加，这可能就是**noOfRequests**最终远大于 500,000 的原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T13:24:27.713

随机函数的结果均匀分布在 0 和 2 之间。这意味着输出是`0`、`1`或`2`，每个概率为 33%。您正在测试`<= 1`，这意味着您有 67% 的概率接受请求，大约为每百万 666K。

要解决您的问题，您需要从区间中排除下限，将结果的计算更改为：

```
result = (rand()%(hi_num-low_num+1))+low_num; 
```

或者您可能想要排除上限，具体取决于您的需要。您的陈述“这意味着在每 2 次迭代中，应该有 1 个请求传入”与从 3 个数字中随机选择 2 个数字不一致。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T14:56:54.727

> 例如，如果到达率是 2：这意味着在每 2 次迭代中，应该有 1 个请求传入......

不，这意味着**平均**每 2 次迭代应该有 1 个传入。有很大的不同。这意味着每次迭代生成的平均请求数是 1/2，而不是 2。

实际上，您可能希望使用与 Uniform 不同的分布。如果您在每个时间步生成计数，有时您的计数为 0，有时可能更多。到目前为止，您编写程序的方式需要一个离散（计数）分布，它永远不会变为负数并且平均值为 1/2。不要**使用**正态（又名高斯）分布之类的东西——它既会给出分数，也会对你不利。

从长远来看，您可能希望转换为离散事件仿真模型。如果什么都没有发生，则无需查看每个时间刻度，并且将时间视为连续而不是刻度通常更现实。查看[此冬季模拟会议教程论文](http://www.informs-sim.org/wsc06papers/001.pdf)，了解如何执行此操作的十页介绍。那里的代码是 Java，但这些概念可以并且已经用任意数量的语言实现。基本上，您需要一个优先级队列来跟踪以什么顺序发生的事情，以及一个如本文所述的小事件循环来控制事情。

# android - 如何更改操作栏上菜单项的位置

> ID：16082297
> 
> 赞同：15
> 
> 时间：2013-04-18T11:57:46.643
> 
> 标签：android, android-layout, android-actionbar, menuitem

我正在开发一个应用程序，我必须在操作栏上添加自定义布局。添加自定义布局已完成，但是当我在操作栏上添加菜单项时，我的自定义布局将其位置从操作栏的右侧更改为操作栏的中心。下面是我到目前为止所取得的成果。

![到此为止](https://i.stack.imgur.com/wERrp.png)

我想要在操作栏上这样的东西。

![像这样](https://i.stack.imgur.com/5colE.png)

操作栏最右侧的自定义布局（黄色按钮）和中间的菜单项。

添加我的代码以使用本机 android 操作栏实现此自定义布局：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    getActionBar().setDisplayHomeAsUpEnabled(true);
    getActionBar().setHomeButtonEnabled(true);

    actionBar = getActionBar();
    actionBar.setDisplayShowTitleEnabled(false);
    actionBar.setDisplayUseLogoEnabled(false);
    actionBar.setDisplayHomeAsUpEnabled(false);
    actionBar.setDisplayShowCustomEnabled(true);
    cView = getLayoutInflater().inflate(R.layout.header, null);
    actionBar.setCustomView(cView);

}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.websearch_menu, menu);
    return true;

}

@Override
public boolean onOptionsItemSelected(MenuItem item) {

    switch (item.getItemId()) {

    case android.R.id.home:
        finish();

    default:
        return super.onOptionsItemSelected(item);
    }
} 
```

如何做到这一点？

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-02-03T01:28:39.527

只需`orderInCategory`在您的 xml 文件中使用，它就会从小到大排序（从操作栏的左侧开始）。如：

```
<item
    android:id="@+id/Refresh"
    android:icon="@drawable/ic_action_refresh"
    android:showAsAction="ifRoom"
    android:title="@string/refresh"
    android:orderInCategory="2"/>
<item
    android:id="@+id/Search"
    android:icon="@drawable/ic_action_action_search"
    android:showAsAction="ifRoom|collapseActionView"
    android:title="@string/search"
    android:orderInCategory="1"/> 
```

即使**刷新**项目在 xml 文件中排在第一位，它也不会排在第一位。但是在您的操作栏中从左到右的**搜索**图标将首先根据其 orderInCategory 属性。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T12:03:23.950

我假设您将自定义视图设置为操作栏中的自定义视图。如果您使用的是 ActionbarSherlock，您可以改为将自定义视图添加为普通菜单项，并使用`.setActionView(yourCustomView or yourCustomLayoutId)`. 然后您可以设置`.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS)`显示视图。只需确保您的自定义视图设置为宽度`wrap_content`，否则它会将其他菜单项推离屏幕。这可能在没有 ActionbarSherlock 的情况下也可以工作，但我还没有在那里尝试过。

编辑：尝试修改你的`onCreateOptionsMenu`方法

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.websearch_menu, menu);

    // add this
    menu.add(Menu.NONE, 0, Menu.NONE, "custom")
        .setActionView(R.layout.header)
        .setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);

    return true;
} 
```

并从您的 onCreate 方法中删除它

```
actionBar.setDisplayShowCustomEnabled(true);
cView = getLayoutInflater().inflate(R.layout.header, null);
actionBar.setCustomView(cView); 
```

编辑：

如果您需要从自定义布局中引用视图，您可以在您的`onCreateOptionsMenu`方法中执行此操作，如下所示（注意：我在浏览器中编写了此代码，所以不能保证我没有打错字或其他东西）：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {

    // inflate the menu and add the item with id viewId,
    // which has your layout as actionview

    View actionView = menu.getItem(viewId).getActionView();
    View viewFromMyLayout = actionView.findViewById(R.id.viewFromMyLayout);

    // here you can set listeners to your view or store a reference 
    // to it somewhere, so you can use it later

    return true;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-06-02T16:08:20.920

菜单项的顺序将根据它们在膨胀的 XML 文件中的顺序进行设置。

因此，您需要做的就是根据需要更改 XML 文件中的顺序。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T12:00:05.537

实现它的一种方法是调用[invalidateOptionMenu](http://developer.android.com/reference/android/app/Activity.html#invalidateOptionsMenu%28%29)并在[onCreateOptionsMenu](http://developer.android.com/reference/android/app/Activity.html#onCreateOptionsMenu%28android.view.Menu%29)方法中，根据您希望放置它们的顺序放置项目。

顺便说一句，如果你使用 ActionBarSherlock，这个方法是可用的，所以忽略关于它的 Lint 警告。

# android - 获取数组中的所有edittext

> ID：16082298
> 
> 赞同：-4
> 
> 时间：2013-04-18T11:57:47.570
> 
> 标签：android, android-edittext

如果我在任何一个编辑文本中更改它的总和并显示在 Textview 中，我的应用程序中现在有 10 个 EditText

但是我如何使用更少的代码

或者我为所有 EditText 处理所有 EditText Onchange 事件

我尝试使用 TextWatcher 观看所有编辑文本，但我如何获得所有编辑文本

```
private TextWatcher filterTextWatcher = new TextWatcher() {

    public void afterTextChanged(Editable s) {
        //Do your stuff
        String text;

    }

    public void beforeTextChanged(CharSequence s, int start, int count,
            int after) {
        // do your stuff
    }

    public void onTextChanged(CharSequence s, int start, int before,
            int count) {
        // do your stuff

    }

}; 
```

请帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:08:53.873

一种简单的方法是获取包含所有 EditTexts 的父视图组，遍历其子视图并执行任何操作：

```
ViewGroup editTextsContainer = (ViewGroup) findViewById(R.id.editTexts_container);
int sum = 0;
int i = edtTextsContainer.getChildCount();
for(int j=0;j<i;j++) {
    View child = editTextsContainer.getChildAt(i);
    if(child instanceof EditText) {
        sum += Integer.parseInt((EditText)child).getText());
        // handle cases where edittext text is not numbers, or set the inputType in xml to avoid
    }
}
myTextView.setText(""+sum); 
```

代码没有经过测试，只是给你一个粗略的想法。

# c# - Kendo ListView：无法刷新（重新加载）数据

> ID：16082300
> 
> 赞同：7
> 
> 时间：2013-04-18T11:57:54.053
> 
> 标签：c#, kendo-ui, kendo-asp.net-mvc

这是我的列表视图：

```
@(Html.Kendo().ListView<Entity>()
  .Name("listView")
  .TagName("div")
  .ClientTemplateId("template")
  .DataSource(dataSource => {
      dataSource.Read(read => read.Action("Products_Read", "Home").Data("additionalData"));
      dataSource.PageSize(4);

})
.Pageable()   
) 
```

以下是必须重新加载数据的 javascript 函数：

```
var someData = "-1";
function reload() {
   // insure that function exists
   // alert( $("#listView").data("kendoListView").refresh)
   $("#listView").data("kendoListView").refresh();

}

function additionalData() {
    return {
        someData:  someData
    };
} 
```

我按照[文档](http://docs.kendoui.com/api/web/listview)中的说明做了所有事情，但没有看到任何回发。有什么问题吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-18T13:19:59.450

`refresh()`（请参阅[refresh](http://docs.kendoui.com/api/web/grid#methods-refresh)）仅刷新屏幕上的数据，但不重新加载数据。如果你想这样做，你必须使用`read()`：

```
$("#listView").data("kendoListView").dataSource.read(); 
```

# c# - 泛型基类包装嵌套泛型类以减少类型参数规范：这种模式有名称吗？

> ID：16082303
> 
> 赞同：1
> 
> 时间：2013-04-18T11:57:57.187
> 
> 标签：c#, generics, design-patterns, naming, nested-class

好的问题标题远非不言自明。我经常看到自己这样做：

从[这个答案](https://stackoverflow.com/questions/98033/wrap-a-delegate-in-an-iequalitycomparer)：

```
public static class Equality<T>
{
    public static IEqualityComparer<T> CreateComparer<K>(Func<T, K> keySelector)
    {
        return new KeyEqualityComparer<K>(keySelector);
    }

    class KeyEqualityComparer<K> : IEqualityComparer<T>
    {
        readonly Func<T, K> keySelector;

        public KeyEqualityComparer(Func<T, K> keySelector)
        {    
            this.keySelector = keySelector;
        }

        public bool Equals(T x, T y)
        {
            ----
        }

        public int GetHashCode(T obj)
        {
            ....
        }
    }
} 
```

我做了什么：`KeyEqualityComparer<T, K>`我必须调用一个实现细节：

```
new KeyEqualityComparer<Person, int>(p => p.ID); 
```

通过将其嵌套为私有类，我不仅隐藏了实现（内部类的公共构造函数现在变得晦涩难懂），而且获得了更好的语法：

```
Equality<Person>.CreateComparer(p => p.ID); 
```

请注意，我没有从父类（静态）继承嵌套类。

或者有时我看到自己[这样做](https://codereview.stackexchange.com/questions/25131/generic-wrapper-for-equality-and-hash-implementation-is-there-a-way-i-can-make)：

```
public abstract class Equater<T> : IEqualityComparer<T>
{
    public static Equater<T> Create<TKey>(Func<T, TKey> keySelector)
    {
        return new Impl<TKey>(keySelector);
    }

    public abstract bool Equals(T x, T y);

    public abstract int GetHashCode(T obj);

    class Impl<TKey> : Equater<T>
    {
        readonly Func<T, TKey> keySelector;

        public Impl(Func<T, TKey> keySelector)
        {
            this.keySelector = keySelector;
        }

        public override bool Equals(T x, T y)
        {
            ----
        }

        public override int GetHashCode(T obj)
        {
            ....
        }
    }
} 
```

另一个类似的[在这里](https://stackoverflow.com/a/16082916/661933)

```
public class Accessor<S>
{
    public static Accessor<S, T> Create<T>(Expression<Func<S, T>> memberSelector)
    {
        return new GetterSetter<T>(memberSelector);
    }

    class GetterSetter<T> : Accessor<S, T>
    {
        public GetterSetter(Expression<Func<S, T>> memberSelector) : base(memberSelector)
        {

        }
    }
}

public class Accessor<S, T> : Accessor<S>
{
    Func<S, T> Getter;
    Action<S, T> Setter;

    public bool IsReadable { get; private set; }
    public bool IsWritable { get; private set; }
    public T this[S instance]
    {
        get
        {
            if (!IsReadable)
                throw new ArgumentException("Property get method not found.");

            return Getter(instance);
        }
        set
        {
            if (!IsWritable)
                throw new ArgumentException("Property set method not found.");

            Setter(instance, value);
        }
    }

    protected Accessor(Expression<Func<S, T>> memberSelector) //access not given to outside world
    {
        ----
    }

} 
```

请注意，在这两种情况下，我从包装类继承。所以现在我不仅获得了前者的好处，而且还可以维护这样的列表：

```
List<Equater<Person>> { persons with different implementations }; 
```

它时不时地帮助我。**所以我很想知道这种模式是否有名字？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-31T08:16:05.987

我认为这很像基于抽象工厂模式的[类集群模式。](https://developer.apple.com/library/ios/documentation/General/Conceptual/CocoaEncyclopedia/ClassClusters/ClassClusters.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:42:05.050

我认为您在这里没有遵循任何一种模式。

我想说，通过用一个“Create”方法替换多个“CreateComparer”方法，您只是简化了一个 Creation Method 模式。你可以在某种意义上说这是一种工厂模式？！或者也许是一种建造者模式——我猜那个是可以解释的？！

通过在“Equater”中嵌入“Impl”，您有点遵循命令模式 - 封装方法调用，以便您的调用代码不知道它是*如何*完成的。

无论如何，对不起，我不能比这更有帮助或给你一个明确的答案！无论如何，希望它有所帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T09:15:52.747

正如伯蒂正确指出的那样，我在这里可能没有遵循*任何一种*模式。

我想说，通过将具体实现的实例化委托给`CreateComparer`方法，我刚刚简化了对象创建——它属于[Creation Method patterns](http://en.wikipedia.org/wiki/Creational_pattern)。通过具有用于对象实例化的静态函数，它有点像*工厂模式*——特别[是工厂方法的这种变体](http://en.wikipedia.org/wiki/Factory_method_pattern#C.23)。

`Impl`通过从我继承，`Equater`我有点遵循了[抽象工厂](http://c2.com/cgi/wiki?AbstractFactoryPattern)模式——`Equater`工厂的工厂在哪里，`Impl`它的实现是为了回馈`Impl`自己，但`Impl`实际上并没有创建任何其他对象（换句话说`Impl`，这并不意味着是一个工厂），但是通过构造函数*实例化自己。*所以严格意义上来说，它不是抽象工厂模式，但它会更接近于 if`Impl`可以有一个方法来调用自己的构造函数并返回一个实例。

同样通过嵌入和隐藏实现细节（嵌套类本身），暴露的类（父类）假装给外界，就好像它正在做它的工作一样。这就是所谓的[委托模式](https://en.wikipedia.org/wiki/Delegation_pattern)

至于*在嵌套泛型类中隐藏泛型类的实现以便为方法调用提供更容易签名的*名称，我认为不存在这样的名称。即使存在任何名称，它也必须非常特定于语言（或类似语言），因为涉及到诸如泛型/类型推断等语言结构。Eric Lippert 在[这里](https://stackoverflow.com/a/3300140/661933)的嵌套类中发现了相同的用途，尽管它与泛型无关，他称之为工厂模式。

# sql-server - 不支持 bcp '-C' 选项

> ID：16082305
> 
> 赞同：0
> 
> 时间：2013-04-18T11:57:57.913
> 
> 标签：sql-server, linux, bcp

我在 Linux 机器上安装了 bcp version#11.0.1790.0。我想将数据从数据文件“bcp in”到 SQL Server。我的数据文件是 UTF-8 格式，我想以 ISO_1 格式将数据加载到 sql server。为此，我尝试使用用于指定代码页的 -C 选项。但是 bcp 说：

`-C option is not supported in this release.`

**-C 选项是否有任何替代方案。是否有任何特定原因导致 bcp for linux 不支持 -C 选项但 bcp for Windows 支持？**

谢谢，

马诺伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T04:30:53.630

我的问题解决了，我以 UTF8 格式创建了数据文件并以相同的格式加载。bcp 的 Linux 版本不需要“-C”选项。但是，当使用 windows Bcp 时，我们只需要指定代码页..

# java - 在服务器中公开生成的文件的有效方法？

> ID：16082313
> 
> 赞同：2
> 
> 时间：2013-04-18T11:58:12.090
> 
> 标签：java, performance, jsf-2, jboss5.x, java-ee-5

我正在开发一个在 JBoss5.1、JEE5、JSF2、Spring3.0、Icefaces2.0、HTML 和 Jquery1.8 上运行的应用程序。

我需要即时生成文件供客户下载。生成文件时，目前我将文件内容作为字节流式传输到 JSF 页面并`<ice:outputResource>`用于显示下载链接。这适用于较小的文件。随着文件大小的增加，这不是一个好的解决方案，因为我遇到了`OutOfMemoryError`问题，因为应用程序 JVM 必须承担将文件内容放入堆然后通过应用程序汇集的负担。

我想做的是将生成的文件作为直接链接提供，以便它们可以由通过 HTTP 包含的网络提供服务。我有一个在安全环境中执行此操作的限制，以便用户在生成和查看链接之前进行身份验证。所以，我打算在 WEB-INF 目录中生成文件，并在用户下载后立即删除文件，从而有效地使 WEB-INF 仅包含客户当前正在查看的文件。我不确定**JBoss 服务器在缓存方面如何处理这些文件以及是否会影响服务器性能**。另外，如果有任何替代方法可以解决我的问题，我将不胜感激。

我相信我清楚地描述了我的问题，如果没有，请告诉我。提前感谢您的时间和帮助。

PS - 我什至可以在 WEB-INF 之外创建文件并且仍然保证它们的安全。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:21:00.047

*   在服务器上的 webapp 之外使用一些预配置的文件夹。正如前面在评论中提到的那样，在 WEB-INF 中生成它们并不是一个好主意
*   创建 servlet，将请求文件的内容从您的预配置文件夹提供给用户
*   如果需要，您还可以保护 servlet
*   servlet 还可以在文件交付给用户后立即删除文件
*   或者，您可以[将外部文件夹映射](https://community.jboss.org/wiki/ExternalDirectories)到 webapp 并让 JBoss 将它们作为静态内容提供（但如果需要，您需要保护访问权限）

PS，如果生成的文件永远不会下载，你可能仍然会做一些“预定的”清理工作。

**服务内容的 Servlet**（回答您的评论）

在您的情况下使用外部文件夹时，我没有看到任何安全问题。此外部文件夹只能在您的应用程序中访问。

假设您有一个将文件生成到 ( *FilesRootDir* ) 的目录 - /var/myapp/storage/tmp。

1.  在您的 web 应用程序中创建知道*FilesRootDir位置的 servlet*
2.  假设 servlet 映射到以下 url (/mywebapp/downloads/file)
3.  为简单起见，您的 servlet 接收生成文件的相对路径（*路径*）作为参数
4.  采取以上
    1.  该应用程序在此处生成文件 /var/myapp/storage/tmp/dir1/document.csv
    2.  并生成链接/mywebapp/downloads/file?path=/dir1/document.csv，以便用户下载文件
5.  当用户决定下载文件时，该请求由您的 servlet 处理。
    1.  servlet 接收请求文件的位置 - /dir1/document.csv
    2.  构造连接*FilesRootDir*和*路径参数*的绝对路径- */var/myapp/storage/tmp/dir1/document.csv*
    3.  读取文件内容并将其输出给用户

我相信您可以对您的 servlet 应用与应用程序中相同的安全约束，因为它是应用程序的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-19T00:12:35.567

提供内容，但对服务器中公开的公共文件使用长哈希，例如对于 file `image.jpg`，使用这样的 URL：

```
http://yourserver.com/somepath/bNKq9Ro_UZeesmQlVs9OQkrKVlpxzpzPXf9DCTbqe_FbLczI 
```

将哈希值保存`bNKq9Ro_UZeesmQlVs9OQkrKVlpxzpzPXf9DCTbqe_FbLczI`在数据库中并将其与文件相关联`image.jpg`，换句话说：

```
hashfunction('image.jpg') = 'bNKq9Ro_UZeesmQlVs9OQkrKVlpxzpzPXf9DCTbqe_FbLczI 
```

一台计算机大约需要 3 TRESSIGINTILLION 年才能猜出这样一个文件的哈希值。

# ruby-on-rails - 这个 ruby on rails 代码线程安全吗？

> ID：16082329
> 
> 赞同：2
> 
> 时间：2013-04-18T11:58:50.263
> 
> 标签：ruby-on-rails, ruby, multithreading, thread-safety, jruby

`Logger`我在 JRuby on Rails 应用程序中遇到问题。一个线程将日志级别更改为错误，并且不会变回。这个代码是线程安全的，还是我应该寻找它发生的其他地方？

[https://github.com/rails/rails/blob/master/activesupport/lib/active_support/benchmarkable.rb#L50](https://github.com/rails/rails/blob/master/activesupport/lib/active_support/benchmarkable.rb#L50)

```
def silence
  message = "ActiveSupport::Benchmarkable#silence is deprecated. It will be removed from Rails 4.1."
  ActiveSupport::Deprecation.warn message
  old_logger_level, logger.level = logger.level, ::Logger::ERROR if logger
  yield
ensure
  logger.level = old_logger_level if logger
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:15:03.240

好的，看起来`yield`在第一个线程中其他线程会执行`silence`它会`logger.level`设置为`ERROR`，所以如果其他线程将在第一个线程之后结束，它会将 level 设置为`ERROR`永久。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-24T12:09:03.763

我在 Rails 记录器和 JRuby 中遇到了同样的线程安全问题。我不知道您是否正在寻找解决方法，但此修复对我有用：http: [//log.kares.org/2011/04/railslogger-is-not-threadsafe.html](http://log.kares.org/2011/04/railslogger-is-not-threadsafe.html)。

# c# - 与 Windows7 显示 API 通信

> ID：16082330
> 
> 赞同：0
> 
> 时间：2013-04-18T11:58:51.450
> 
> 标签：c#, pinvoke, marshalling

我还没有找到一个体面的（真的）围绕新的 win7 CCD api 的 pinvoke 包装器。该 api 可以从这里找到：http: [//msdn.microsoft.com/en-us/library/windows/hardware/hh406259 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/hh406259(v=vs.85).aspx)

我花了几个小时转换结构/方法调用，以便可以从 C# 中使用它。

这是第一个“草稿”：

```
using System;
using System.Runtime.InteropServices;

namespace CONVERTING_CCD
{
    /// <summary>
    /// This class takes care of wrapping "Connecting and Configuring Displays(CCD) Win32 API"
    /// Author Erti-Chris Eelmaa || easter199 at hotmail dot com
    /// </summary>
    public class CCDWrapper
    {
        [StructLayout(LayoutKind.Sequential)]
        public struct LUID
        {
            public uint LowPart;
            public uint HighPart;
        }

        [Flags]
        public enum DisplayConfigVideoOutputTechnology : uint
        {
            Other = 4294967295, // -1
            Hd15 = 0,
            Svideo = 1,
            CompositeVideo = 2,
            ComponentVideo = 3,
            Dvi = 4,
            Hdmi = 5,
            Lvds = 6,
            DJpn = 8,
            Sdi = 9,
            DisplayportExternal = 10,
            DisplayportEmbedded = 11,
            UdiExternal = 12,
            UdiEmbedded = 13,
            Sdtvdongle = 14,
            Internal = 0x80000000,
            ForceUint32 = 0xFFFFFFFF
        }

        #region SdcFlags enum

        [Flags]
        public enum SdcFlags : uint
        {
            Zero = 0,

            TopologyInternal = 0x00000001,
            TopologyClone = 0x00000002,
            TopologyExtend = 0x00000004,
            TopologyExternal = 0x00000008,
            TopologySupplied = 0x00000010,

            UseSuppliedDisplayConfig = 0x00000020,
            Validate = 0x00000040,
            Apply = 0x00000080,
            NoOptimization = 0x00000100,
            SaveToDatabase = 0x00000200,
            AllowChanges = 0x00000400,
            PathPersistIfRequired = 0x00000800,
            ForceModeEnumeration = 0x00001000,
            AllowPathOrderChanges = 0x00002000,

            UseDatabaseCurrent = TopologyInternal | TopologyClone | TopologyExtend | TopologyExternal
        }

        [Flags]
        public enum DisplayConfigFlags : uint
        {
            Zero = 0x0,
            PathActive = 0x00000001
        }

        [Flags]
        public enum DisplayConfigSourceStatus
        {
            Zero = 0x0,
            InUse = 0x00000001
        }

        [Flags]
        public enum DisplayConfigTargetStatus : uint
        {
            Zero = 0x0,

            InUse                         = 0x00000001,
            FORCIBLE                       = 0x00000002,
            ForcedAvailabilityBoot       = 0x00000004,
            ForcedAvailabilityPath       = 0x00000008,
            ForcedAvailabilitySystem     = 0x00000010,
        }

        [Flags]
        public enum DisplayConfigRotation : uint
        {
            Zero = 0x0,

            Identity = 1,
            Rotate90 = 2,
            Rotate180 = 3,
            Rotate270 = 4,
            ForceUint32 = 0xFFFFFFFF
        }

        [Flags]
        public enum DisplayConfigPixelFormat : uint
        {
            Zero = 0x0,

            Pixelformat8Bpp = 1,
            Pixelformat16Bpp = 2,
            Pixelformat24Bpp = 3,
            Pixelformat32Bpp = 4,
            PixelformatNongdi = 5,
            PixelformatForceUint32 = 0xffffffff
        }

        [Flags]
        public enum DisplayConfigScaling : uint
        {
            Zero = 0x0, 

            Identity = 1,
            Centered = 2,
            Stretched = 3,
            Aspectratiocenteredmax = 4,
            Custom = 5,
            Preferred = 128,
            ForceUint32 = 0xFFFFFFFF
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfigRational
        {
            public uint numerator;
            public uint denominator;
        }

        [Flags]
        public enum DisplayConfigScanLineOrdering : uint
        {
            Unspecified = 0,
            Progressive = 1,
            Interlaced = 2,
            InterlacedUpperfieldfirst = Interlaced,
            InterlacedLowerfieldfirst = 3,
            ForceUint32 = 0xFFFFFFFF
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfigPathInfo
        {
            public DisplayConfigPathSourceInfo sourceInfo;
            public DisplayConfigPathTargetInfo targetInfo;
            public uint flags;
        }

        [Flags]
        public enum DisplayConfigModeInfoType : uint
        {
            Zero = 0,

            Source = 1,
            Target = 2,
            ForceUint32 = 0xFFFFFFFF
        }

        [StructLayout(LayoutKind.Explicit)]
        public struct DisplayConfigModeInfo
        {
            [FieldOffset((0))]
            public DisplayConfigModeInfoType infoType;

            [FieldOffset(4)]
            public uint id;

            [FieldOffset(8)]
            public LUID adapterId;

            [FieldOffset(16)]
            public DisplayConfigTargetMode targetMode;

            [FieldOffset(16)]
            public DisplayConfigSourceMode sourceMode;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfig2DRegion
        {
            public uint cx;
            public uint cy;
        }

        [Flags]
        public enum D3DmdtVideoSignalStandard : uint
        {
            Uninitialized = 0,
            VesaDmt = 1,
            VesaGtf = 2,
            VesaCvt = 3,
            Ibm = 4,
            Apple = 5,
            NtscM = 6,
            NtscJ = 7,
            Ntsc443 = 8,
            PalB = 9,
            PalB1 = 10,
            PalG = 11,
            PalH = 12,
            PalI = 13,
            PalD = 14,
            PalN = 15,
            PalNc = 16,
            SecamB = 17,
            SecamD = 18,
            SecamG = 19,
            SecamH = 20,
            SecamK = 21,
            SecamK1 = 22,
            SecamL = 23,
            SecamL1 = 24,
            Eia861 = 25,
            Eia861A = 26,
            Eia861B = 27,
            PalK = 28,
            PalK1 = 29,
            PalL = 30,
            PalM = 31,
            Other = 255
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfigVideoSignalInfo
        {
            public long pixelRate;
            public DisplayConfigRational hSyncFreq;
            public DisplayConfigRational vSyncFreq;
            public DisplayConfig2DRegion activeSize;
            public DisplayConfig2DRegion totalSize;

            public D3DmdtVideoSignalStandard videoStandard;
            public DisplayConfigScanLineOrdering ScanLineOrdering;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfigTargetMode
        {
            public DisplayConfigVideoSignalInfo targetVideoSignalInfo;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct PointL
        {
            public int x;
            public int y;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfigSourceMode
        {
            public uint width;
            public uint height;
            public DisplayConfigPixelFormat pixelFormat;
            public PointL position;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfigPathSourceInfo
        {
            public LUID adapterId;
            public uint id;
            public uint modeInfoIdx;

            public DisplayConfigSourceStatus statusFlags;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct DisplayConfigPathTargetInfo
        {
            public LUID adapterId;
            public uint id;
            public uint modeInfoIdx;
            public DisplayConfigVideoOutputTechnology outputTechnology; 
            public DisplayConfigRotation rotation;
            public DisplayConfigScaling scaling;
            public DisplayConfigRational refreshRate;
            public DisplayConfigScanLineOrdering scanLineOrdering;

            public bool targetAvailable;
            public DisplayConfigTargetStatus statusFlags;
        }

        [Flags]
        public enum QueryDisplayFlags : uint
        {
            Zero = 0x0,

            AllPaths = 0x00000001,
            OnlyActivePaths = 0x00000002,
            DatabaseCurrent = 0x00000004
        }

        [Flags]
        public enum DisplayConfigTopologyId : uint
        {
            Zero = 0x0,

            Internal = 0x00000001,
            Clone = 0x00000002,
            Extend = 0x00000004,
            External = 0x00000008,
            ForceUint32 = 0xFFFFFFFF
        }

        #endregion

        [DllImport("User32.dll")]
        public static extern int SetDisplayConfig(uint numPathArrayElements, out DisplayConfigPathInfo pathArray,
                                                  uint numModeInfoArrayElements, out DisplayConfigModeInfo modeInfoArray,
                                                  SdcFlags flags);

        [DllImport("User32.dll")]
        public static extern int QueryDisplayConfig(QueryDisplayFlags flags, ref int numPathArrayElements,
                                                ref DisplayConfigPathInfo[] pathInfoArray, 
                                                ref int modeInfoArrayElements,
                                                ref DisplayConfigModeInfo[] modeInfoArray,
                                                IntPtr z);

        [DllImport("User32.dll")]
        public static extern int GetDisplayConfigBufferSizes(QueryDisplayFlags flags, out int numPathArrayElements, out int numModeInfoArrayElements);
    }
} 
```

我差不多完成了，完成后，我会将其发送到 pinvoke.net。现在有一个问题，即当我调用 QueryDisplayConfig() 时，会抛出空引用异常，这根本不会告诉我任何事情。我花了几个小时重新检查所有内容，从后到前，从前到后。

这是实际的代码用法：

```
static void Main(string[] args)
{
    int numPathArrayElements;
    int numModeInfoArrayElements;

    // query active paths from the current computer.
    if (CCDWrapper.GetDisplayConfigBufferSizes(CCDWrapper.QueryDisplayFlags.OnlyActivePaths, out numPathArrayElements,
                                                   out numModeInfoArrayElements) == 0)
    {
        // 0 is success.
        var pathInfoArray = new CCDWrapper.DisplayConfigPathInfo[numPathArrayElements];
        var modeInfoArray = new CCDWrapper.DisplayConfigModeInfo[numModeInfoArrayElements];
        CCDWrapper.DisplayConfigTopologyId currentTopologyId; // don't use it right now.

        var first = Marshal.SizeOf(new CCDWrapper.DisplayConfigPathInfo());
        var second = Marshal.SizeOf(new CCDWrapper.DisplayConfigModeInfo());

        var status = CCDWrapper.QueryDisplayConfig(CCDWrapper.QueryDisplayFlags.OnlyActivePaths,
                                ref numPathArrayElements, ref pathInfoArray, ref numModeInfoArrayElements, 
                                ref modeInfoArray, IntPtr.Zero);

    }
} 
```

请注意，结构大小应适当：

```
var first = Marshal.SizeOf(new CCDWrapper.DisplayConfigPathInfo());
var second = Marshal.SizeOf(new CCDWrapper.DisplayConfigModeInfo()); 
```

第一个 => 72，第二个 => 64，

当我从 C++ 检查它时：

```
int first = sizeof(DISPLAYCONFIG_PATH_INFO);
int second = sizeof(DISPLAYCONFIG_MODE_INFO); 
```

它给了我同样的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:45:20.600

您在 SetDisplayConfig 和 QueryDisplayConfig 声明中对数组的处理是错误的。尝试以下更改：

```
[DllImport("User32.dll")]
public static extern int SetDisplayConfig(
    uint numPathArrayElements, 
    [In] DisplayConfigPathInfo[] pathArray,
    uint numModeInfoArrayElements, 
    [In] DisplayConfigModeInfo[] modeInfoArray,
    SdcFlags flags
);

[DllImport("User32.dll")]
public static extern int QueryDisplayConfig(
    QueryDisplayFlags flags, 
    ref int numPathArrayElements,
    [Out] DisplayConfigPathInfo[] pathInfoArray, 
    ref int modeInfoArrayElements,
    [Out] DisplayConfigModeInfo[] modeInfoArray,
    IntPtr z
); 
```

# pfx - 为什么我在尝试使用 signtool 签署应用程序时收到“指定的 PFX 密码不正确”？

> ID：16082333
> 
> 赞同：11
> 
> 时间：2013-04-18T11:58:57.210
> 
> 标签：pfx, signtool

我按照这个[链接](https://bytescout.com/support/index.php?_m=knowledgebase&_a=viewarticle&kbarticleid=296) 签署了我的 exe 应用程序。

*   我在 Windows 7 上安装了 SDK 工具，

*   跑 `C:\Program Files\Microsoft SDKs\Windows\v6.1\Bin>makecert.exe -sv App-O.pvk -n "CN=MY DIGITAL KEY" App-O.cer`

打开对话框以提供密码：

![在此处输入图像描述](https://i.stack.imgur.com/Nur3L.png)

我写了密码：'fess'

新窗口打开：

![在此处输入图像描述](https://i.stack.imgur.com/4RUWH.png)

我输入了：'fess'

`#Succeeded`

创建了 App-O.cer 和 App-O.pvk 文件。

现在我生成 pfx：

```
pvk2pfx.exe -pvk App-O.pvk -spc App-O.cer -pfx App-O.pfx 
```

打开对话框以提供密码：

![在此处输入图像描述](https://i.stack.imgur.com/GCqv3.png)

我贴了'fess'

文件 pfx 创建。

现在我运行signtool：

```
 C:\Program Files\Microsoft SDKs\Windows\v6.1\Bin>signtool.exe sign /f "App-O.pfx" /p fess "C:\Output\setup.exe" 
```

在这里我得到了错误：

```
SignTool Error: The specified PFX password is not correct.

Number of files successfully Signed: 0
Number of warnings: 0
Number of errors: 1 
```

我错过了什么？

顺便说一句，我从 Windows SDK 的 CMD shell 得到同样的错误。

谢谢，

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-20T14:30:35.933

有几个问题。

首先，您使用的是自签名证书，因此您应该通过在 makecert 命令中添加 -r 密钥来明确定义它，否则您将在签名步骤中收到错误“签名者的证书对签名无效”。

接下来，在这一步

```
signtool.exe sign /f "App-O.pfx" /p fess "C:\Output\setup.exe" 
```

您正在尝试使用密码“fess”打开 pfx。但是您实际上没有为 pfx 文件设置任何密码。为此，您应该将 -po 键添加到 pfx 创建命令。

之后，您可以签署您的申请。

所以正确的过程是：

```
makecert.exe -sv App-O.pvk -n "CN=MY DIGITAL KEY" App-O.cer -r

pvk2pfx.exe -pvk App-O.pvk -spc App-O.cer -pfx App-O.pfx -po fess

signtool.exe sign /f "App-O.pfx" /p fess "C:\Output\setup.exe" 
```

以下是一些有用的链接：

*   如何创建证书：http: [//msdn.microsoft.com/en-us/library/ff699202.aspx](http://msdn.microsoft.com/en-us/library/ff699202.aspx)
*   pvk2pfx 命令键：http: [//msdn.microsoft.com/en-us/library/windows/hardware/ff550672%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/hardware/ff550672%28v=vs.85%29.aspx)
*   signtool 命令键：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa387764%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387764%28v=vs.85%29.aspx)
*   如何签署文件：http: [//msdn.microsoft.com/en-us/library/windows/desktop/aa388170%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa388170%28v=vs.85%29.aspx)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2019-12-17T08:19:22.057

刚刚在*某些*机器上收到与 DigiCert 代码签名证书类似的错误时，偶然发现了这个问题。

结果我在导出证书时选择了 SHA256 加密而不是 TripleDES-SHA1，并且我们的一台构建机器仍在运行 Windows Server 2012 R2。该操作系统显然无法解密证书，从而导致相同的（在这种情况下令人恼火）错误消息。

`Hosted VS2017`更新：同样的行为也发生在使用管道和 DigiCert 证书的Azure Devops 经典管道上。

新的 YAML 管道使用 SHA256

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-09-28T10:01:40.447

您只需要`-pi`像这样添加参数（pvk 文件的密码）：

```
pvk2pfx.exe -pvk App-O.pvk -pi fess -spc App-O.cer -pfx App-O.pfx -po fess -f 
```

# php - 循环内的persist（）和flush（） - 教义

> ID：16082337
> 
> 赞同：5
> 
> 时间：2013-04-18T11:59:02.917
> 
> 标签：php, collections, orm, doctrine, data-access-layer

我想知道 ff: 代码将往返数据库多少次。

```
foreach ($recipients as $recipient) {
    $received_email = new ReceivedEmail();
    $received_email->setRecipient($recipient);
    $received_email->setEmail($email);

    $entityManager->persist($received_email);
    $entityManager->flush(); 
} 
```

`$recipients`是与 ReceivedEmail 具有一对多关系的 User 对象数组

`$email`是与 ReceivedEmail 具有一对多关系的对象。

例如，如果`$recipients`有五个实体，那么循环是否会生成总共五次到数据库的行程？还是只有一个？

上面的示例是插入新 ReceivedEmail 记录的最优化方式吗？

谢谢

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-18T12:14:19.017

将为每个持久化生成一个 INSERT 语句。

更重要的是，您可以只显示您的 SQL 语句进行调试，只需配置 Doctrine 进行日志记录： [https ://stackoverflow.com/a/4585421/1815881](https://stackoverflow.com/a/4585421/1815881)

在你的情况下：

```
$entityManager->getConfiguration()->
                setSQLLogger(new \Doctrine\DBAL\Logging\EchoSQLLogger()); 
```

对于许多插入，您应该考虑**批处理**：

*   [https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/batch-processing.html](https://www.doctrine-project.org/projects/doctrine-orm/en/2.6/reference/batch-processing.html)

希望我已经揭示了问题。

# jquery - 如何预加载 javascript、图像、css 和/或 misc 文件？

> ID：16082350
> 
> 赞同：1
> 
> 时间：2013-04-18T11:59:23.527
> 
> 标签：jquery, preload

目前我正在做一个涉及数千行 CSS、JavaScript 和一堆图像的大型项目。通过增加压缩来缩小 CSS 样式表和 JavaScript 文件有很大帮助，但它仍然不是完美的。

为了在 CSS 样式表中预加载图像，我找到了一堆插件，包括在 stackoverflow 上。然而，由于有很多 jQuery 和 JavaScript 库——在样式表中只预加载 CSS 图像对我的事业毫无帮助。有没有办法一次性预加载 CSS 文件，以及在这些文件中找到的图像和 JavaScript 库？我会在确认用户凭据后使用此类功能，并在预加载所需内容后将用户重定向到内部内容。

另外：我可以轻松地提供预加载所需的文件数组，而无需 JavaScript 来解析任何文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:09:43.740

你可以看看使用 appcache 来缓存资源。这将加快现代浏览器的速度，但对旧浏览器没有帮助。[这里](http://www.html5rocks.com/en/tutorials/appcache/beginner/)有一个很好的教程。

我猜你的大部分页面大小来自图像。您可以尝试拆分图像并使用 gzip，甚至更旧的浏览器也支持（例如 IE 5.5+）。

# c# - 请求被中止：操作已超时

> ID：16082353
> 
> 赞同：1
> 
> 时间：2013-04-18T11:59:34.450
> 
> 标签：c#, asp.net, .net, garbage-collection, httpwebrequest

> **只是想补充一点，在添加了这个问题中给出的代码之后，我没有发现这个错误再次发生。我认为垃圾收集做到了。**

我正在努力处理上述错误。我有两个 asp.net web 应用程序。其中一个被视为服务器，另一个被视为客户端。我正在使用 Hessian 编码方法来处理 Web 请求和响应。

最初，我的客户端和服务器 100% 正确地相互响应。但一段时间后，我的客户端停止联系我的服务器，我收到此错误：

> 请求被中止：操作已超时

我已经尝试了很多我在互联网上找到的东西来解决我的问题。我做的第一件事是关闭请求和响应流。

然后我添加了以下属性：

```
request.KeepAlive = false;
request.Timeout = 5000;
request.Proxy = null;

request.ServicePoint.ConnectionLeaseTimeout = 5000;
request.ServicePoint.MaxIdleTime = 5000; 
```

之后我添加了 ReadWriteTime 和 GC.Collect()。

但我所有的努力都没有结果。

此问题仅发生在 GoDaddy 服务器上，我的项目在我的本地服务器和另一台物理服务器上运行良好。从本地主机运行项目时，我也没有收到此错误。

仅当我部署到我的 GoDaddy 服务器或我将本地客户端连接到我的 GoDaddy 服务器时才会发生这种情况。

从日志中我可以看到请求停止到达服务器端。

这是我的最终代码：

```
// Send Request to Edge Server. Will receive a response as an Encoded stream
        String infoMessage = "userId Is: " + request.Info.UserId.AsString() + " Session Id is: " + request.Info.SessionId.AsString();
        String logMessage = "inside Invoke: " + infoMessage;
        Stream requestStream = null;
        HttpWebResponse webResponse = null;
        Stream responseStream = null;
         HttpWebRequest webRequest=null;
        try
        {
            // Construct web request
            logMessage = "Creating webrequest to: " + url + " " + infoMessage;
            webRequest = (HttpWebRequest)WebRequest.Create(url);
            webRequest.ContentType = encoderType.Trim().ToLower();
            webRequest.Method = REQUEST_METHOD;
            webRequest.Timeout = 120000;
            webRequest.ReadWriteTimeout = 120000;
            webRequest.KeepAlive = false;
            webRequest.Proxy = null;
            webRequest.ServicePoint.ConnectionLeaseTimeout = 5000;
            webRequest.ServicePoint.MaxIdleTime = 5000;
            logMessage = logMessage + "Timeout is 5000 Keep Alive False";

            logMessage = "timout is: " + webRequest.Timeout.ToString() + logMessage;
            // Encode Request object as Stream
            requestStream = webRequest.GetRequestStream();
            EncoderFactory.GetInstance(this.encoderType).Encode(requestStream, request);
            logMessage = "going to getresponse" + logMessage;
            webResponse = (HttpWebResponse)webRequest.GetResponse();
            logMessage = "Response returend" + logMessage;
            // Recieve web response
            String contentType = webResponse.ContentType;
            logMessage = "going to get response stream" + logMessage;
            responseStream = webResponse.GetResponseStream();

            // If response Content Type is 'text/html' then assume it's an error message
            if (contentType.ToLower().Trim().StartsWith("text/html"))
            {
                StreamReader reader = new StreamReader(responseStream, Encoding.Default);
                String errorMessage = reader.ReadToEnd();
                reader.Close();
                return new ErrorResponse(-1000, logMessage + " " + errorMessage);
            }
            else if (contentType.ToLower().Trim().StartsWith(EncoderFactory.ENCODER_TYPE_HESSIAN))
            {
                // Decode Response object from Stream
                return (Response)EncoderFactory.GetInstance(this.encoderType).Decode(responseStream);
            }
            else
            {
                return new ErrorResponse(-1001, "Invalid response - ContentType='" + contentType + "'");
            }
        }
        catch (Exception ex)
        {

            return new ErrorResponse(-1002, "Exception is -1002 and Message is = " + ex.Message + " " + logMessage + ".");
        }
        finally
        {

            // Close request stream
            if (requestStream != null)
            {
                try
                {
                    requestStream.Flush();
                    requestStream.Close();
                }
                catch { }
            }

            // Close web response
            if (webResponse != null)
            {
                try
                {
                    webResponse.Close();
                }
                catch { }
            }

            // Close response stream
            if (responseStream != null)
            {
                try
                {
                    responseStream.Flush();
                    responseStream.Close();
                }
                catch { }
            }
            GC.Collect();
        }
    } 
```

# ruby-on-rails-3 - 让 alertify 使用 turbolinks

> ID：16082354
> 
> 赞同：2
> 
> 时间：2013-04-18T11:59:43.397
> 
> 标签：ruby-on-rails-3, turbolinks, alertify

我正在尝试在 rails 3 应用程序中使用 turbolinks。一切都很好，除了 Alertify 在页面更改后停止工作。

我已经安装了 jquery-turbolinks gem 来修补它，但这没有任何效果。

我也尝试过包装 alertify 函数并在 page:change 上触发它，但同样没有乐趣。

有人对 turbolinks 有问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-15T00:00:12.410

任何使用 Alertify 0.4.0（当前为 RC1）遇到此问题的人都可以通过重置您正在使用的 Alertify 元素来解决此问题。就我而言，它是 Alertify.dialog：

```
Alertify.dialog.el = false
// Do your normal JS stuff 
```

在我对此的粗略理解中，Alertify 认为已经创建了一个对话框元素，但是当 Turbolinks 加载页面时，它会破坏该元素。我们需要告诉 Alertify 它已被销毁，Alertify 将重新创建它。

如果您需要任何有关细节的帮助，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T11:23:16.303

据我所知，Turbolinks 与全局范围混淆，这会阻止警报与 DOM 正确连接。

因此，我的工作是：

```
 //Keep global reference to alertify init() function
    $(document).on('ready',function(){
     window alertifyInit = alertify.init;
    });
    //re-initialise on page change/load
    $(document).on('page:change page:load',function(){
        alertifyInit();
    }); 
```

# php - 将动态生成的列表中的数据从一个页面传递到另一个页面

> ID：16082357
> 
> 赞同：2
> 
> 时间：2013-04-18T11:59:51.507
> 
> 标签：php, javascript, jquery, jquery-mobile

在我的 jquery 移动应用程序中，我有一个动态生成的列表视图，我想要做的是当用户单击列表项时，我想从列表项中的隐藏字段中获取一个值并将该值传递给另一个页面，以便我可以根据该变量值进行查询。（这是多页布局）

由于我与第一页在同一个 DOM 中，我假设我可以使用普通的旧变量访问数据并传递到另一个页面。我需要知道的是，如何从动态生成的列表中获取值。任何帮助，将不胜感激。

```
<ul data-role="listview" class="ui-listbox" data-theme="c"  role="listbox" style="margin-top:20px">
    <li data-role="list-divider" role="heading" tabindex="0" class="ui-li ui-li-divider ui-btn ui-bar-b ui-btn-up-undefined">Today's Journey</li>
    <?php foreach ($journeys as $journey) : ?>
    <?php if ($journey['user_type'] == 0): ?>
        <li class="list-item-speaker" data-icon="false">
            <a href="#journeydetails?id=<?php echo $journey['journey_id']; ?>" id="journeyDetailsDriver" data-transition="flip" >
                <div class="list-item-content-speaker" style="float:left">
                    <img src="<?php echo $journey['facebook_image']; ?>" class="thumb-speaker-small" alt="<?php echo $journey['facebook_first_name']." ".$journey['facebook_last_name']; ?>" />
                    <h3 style="padding-left:10px;"><?php echo $journey['from_destination']." - ".$journey['to_destination']; ?></h3>
                    <p style="padding-left:10px"><?php echo $journey['facebook_first_name']." ".$journey['facebook_last_name']; ?></p>
                    <p style="padding-left:10px; padding-top:10px; font-size:0.9em; font-weight:bold"><?php echo $journey['depart_date']; ?></p>
                    //VALUE I NEED FROM HIDDEN FIELD
                    <input type="hidden" name="journeyID" id="journeyID" value="<?php echo $journey['journey_id']; ?>">
                </div>
                <h3 style="float:right; margin-top:45px; color:#189ACB"><?php echo $journey['seats_available']. ' seats'; ?></h3>
            </a>
        </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:03:23.277

您可以使用 URL 查询标签，或将数据保存在 cookie 或 HTML5 本地/会话存储中。

要从列表中获取信息，这是一个示例

```
<ul>
  <li>Coffee</li>
  <li>Tea</li>
  <li>Milk</li>
</ul>

var a = [],
    list = document.getElementsByTagName("li");

Array.prototype.forEach.call(list, function(entry) {
    a.push(entry.textContent);
});

console.log(a); 
```

在[jsfiddle上可用](http://jsfiddle.net/Xotic750/L5AjY/)

# jquery - jQuery 的悬停事件类型打印为 mouseover 和 mouseenter

> ID：16082358
> 
> 赞同：1
> 
> 时间：2013-04-18T11:59:59.660
> 
> 标签：jquery, google-chrome, console

看这张照片：

![在此处输入图像描述](https://i.stack.imgur.com/1JIWg.png)

这是错误还是标准？

PS：args 之后的鼠标悬停只是一个标签。

# 事件监听器

```
$ ->
  $('.bigger-on-hover').hover (event) ->

    console.log 'args'
    console.log arguments
    console.log @
    window.x = arguments
    window.y = @
    console.log 'args'
    console.log 'mouseover'
    console.log event.type 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:47:04.490

mouseenter 仅在 Internet Explorer 中，但 jQuery 在其他浏览器中模仿它。

你`event`实际上是 jQuery 事件，所以它的类型是`mouseenter`.

要查看本机事件，请使用`event.originalEvent`. 您可以使用 来查看其类型`console.log(event.originalEvent.type)`。在非 IE 中，该类型是`mouseover`.

jQuery 监听那个 mouseover 事件，当它听到它时，它检查鼠标指针是否已经在那个元素上，发现它不是，然后触发一个 jQuery mouseenter 事件。然后它将事件改回，`mouseover`以便在冒泡时具有正常效果。

当你使用 时`.hover()`，jQuery 会监听这些进入和离开事件来触发它的开启和关闭。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:51:21.577

[`jQuery.fn.hover`](https://github.com/jquery/jquery/blob/85fc5878b3c6af73f42d61eedf73013e7faae408/src/event-alias.js#L14-L16)是别名：

```
jQuery.fn.extend({
    hover: function( fnOver, fnOut ) {
        return this.mouseenter( fnOver ).mouseleave( fnOut || fnOver ); 
```

那些`mouseenter`和`mouseleave`方法本身也只是[特殊处理](https://github.com/jquery/jquery/blob/85fc5878b3c6af73f42d61eedf73013e7faae408/src/event.js#L670-L692)的[捷径](https://github.com/jquery/jquery/blob/85fc5878b3c6af73f42d61eedf73013e7faae408/src/event-alias.js#L1-L11)。

打印的对象`console.log`不是冻结的快照。如果在扩展对象之前修改了对象，则修改后的版本将记录到控制台。这就是这里发生的事情。

# android - 如何根据视图最大尺寸自动调整多行 TextView 上的文本大小？

> ID：16082359
> 
> 赞同：23
> 
> 时间：2013-04-18T12:00:02.763
> 
> 标签：android, textview, word-wrap, typeface, text-size

我一直在寻找一种在文本视图中自动调整文本的方法。通过我的搜索，我发现了许多解决方案，例如：

*   [FontFitTextView](https://stackoverflow.com/questions/2617266/how-to-adjust-text-font-size-to-fit-textview)
*   [AutoResizeTextView](https://stackoverflow.com/questions/5033012/auto-scale-textview-text-to-fit-within-bounds?lq=1)
*   [自动缩放/调整大小](https://stackoverflow.com/questions/2596452/how-to-scale-resize-text-to-fit-a-textview?lq=1)

但像许多其他人一样，这些并不能解决我的问题。当我们使用带有多行的 TextView 时，它们无法按预期工作。

基本上我的目标是这个：

![阶段1](https://i.stack.imgur.com/3QImF.png) ![阶段2](https://i.stack.imgur.com/Y97ZO.png) ![第三阶段](https://i.stack.imgur.com/GJBtg.png) ![第 4 阶段](https://i.stack.imgur.com/tIrOl.png)

如您所见，文本根据宽度、高度调整大小并注意换行，创建多行文本视图。还可以更改字体。

我解决这个问题的一个想法是这样的：

```
int size = CONSTANT_MAX_SIZE;
TextView tv = (TextView) findViewById(R.id.textview1)
while(Math.abs(tv.getMeasuredHeight()) >= TEXTVIEW_MAX_HEIGHT) {
    size--;
    tv.setTextSize(size);
    tv.measure(MeasureSpec.UNSPECIFIED,MeasureSpec.UNSPECIFIED);
    i++;
} 
```

CONSTANT_MAX_SIZE 是一个常量，定义了字体的最大尺寸（TextView 中的 textsize 专有）

TEXTVIEW_MAX_HEIGHT 是一个常量，它定义了 textview 可以拥有的最大尺寸。

每次更改 textview 中的文本时都会调用此方法。

textview xml 是这样的：

```
<TextView
     android:id="@+id/textview1"
     android:layout_width="200dp"
     android:layout_height="wrap_content"
     android:singleLine="false"
     android:inputType="textMultiLine"
     android:text=""
     android:textSize="150sp" /> 
```

由于 XML 中的宽度会受到限制，因此只需要考虑视图的高度，因为调整它 android 会在需要时自动创建多行。

尽管这是一个潜在的解决方案，但效果并不理想（远非如此），并且它不支持缩小尺寸（当您删除文本时）。

有什么建议和/或想法吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-05-21T14:07:27.817

在等待这个问题的可能解决方案时，我一直在尝试并试图弄清楚。

最接近这个问题的解决方案是基于油漆的方法。

基本上，paint 有一个名为“breaktext”的方法，它：

> public int breakText (CharSequence text, int start, int end, boolean measureForwards, float maxWidth, float[] measureWidth)
> 
> 在 API 级别 1 中添加
> 
> 测量文本，如果测量的宽度超过 maxWidth，则提前停止。返回测量的字符数，如果测量宽度不为空，则返回测量的实际宽度。

我将它与paint 'getTextBounds' 结合起来：

> public void getTextBounds (String text, int start, int end, Rect bounds)
> 
> 在 API 级别 1 中添加
> 
> 返回边界（由调用者分配）包围所有 > 字符的最小矩形，隐含原点位于 (0,0)。

所以现在我可以获得适合给定宽度的字符数和这些字符的高度。

使用一段时间，您可以继续从要测量的字符串中移动删除字符并获取行数（通过使用 while(index < string.length)）并将其乘以在 getTextBounds 中获得的高度。

此外，您必须为每两行添加一个可变高度，表​​示行之间的空间（不计入 getTextBounds）。

作为示例代码，了解多行文本高度的函数如下所示：

```
public int getHeightOfMultiLineText(String text,int textSize, int maxWidth) {
    paint = new TextPaint();
    paint.setTextSize(textSize);
    int index = 0;
    int linecount = 0;
    while(index < text.length()) {
        index += paint.breakText(text,index,text.length,true,maxWidth,null);
        linecount++;
    }

    Rect bounds = new Rect();
    paint.getTextBounds("Yy", 0, 2, bounds);
    // obtain space between lines
    double lineSpacing = Math.max(0,((lineCount - 1) * bounds.height()*0.25)); 

    return (int)Math.floor(lineSpacing + lineCount * bounds.height()); 
```

*注意：maxWidth 变量以像素为单位*

然后您将不得不在一段时间内调用此方法以确定该高度的最大字体大小。一个示例代码是：

```
textSize = 100;
int maxHeight = 50;
while(getHeightOfMultiLineText(text,textSize,maxWidth) > maxHeight)
  textSize--; 
```

不幸的是，这是我能够从上面的图像中实现这一方面的唯一（据我所知）方法。

希望这对任何试图克服这一障碍的人有所帮助。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-09-10T04:05:00.580

[![在此处输入图像描述](https://i.stack.imgur.com/xXHZK.png)](https://i.stack.imgur.com/xXHZK.png) [![在此处输入图像描述](https://i.stack.imgur.com/lYzZN.png)](https://i.stack.imgur.com/lYzZN.png) [![在此处输入图像描述](https://i.stack.imgur.com/GD7ha.png)](https://i.stack.imgur.com/GD7ha.png)

phamducgiam 的一些改进答案。它显示已经适合大小的文本，而不是显示后的草图。由于启动 textSize 100，在编辑器中看起来很难看，但在运行时可以正常工作。这是代码：

```
import android.content.Context;
import android.text.TextPaint;
import android.util.AttributeSet;
import android.util.TypedValue;
import android.widget.TextView;

public class FontFitTextView extends TextView {

    public FontFitTextView(Context context) {
        super(context);
    }

    public FontFitTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public FontFitTextView(Context context, AttributeSet attrs, int defStyleAttr) {
        super(context, attrs, defStyleAttr);
    }

    @Override
    protected void onMeasure(final int widthMeasureSpec, final int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);
        // start decreasing font size from 100
        setTextSize(TypedValue.COMPLEX_UNIT_PX, 100);

        // calculate dimensions. don't forget about padding
        final float maxWidth = getWidth()-(getPaddingLeft()+getPaddingRight());
        final float maxHeight = getHeight()-(getPaddingTop()+getPaddingBottom());

        if (maxWidth < 1.0f || maxHeight < 1.0f) {
            return;
        }

        CharSequence text = getText();
        int lineCount = getLineCount(maxWidth, text);
        float height = getHeight(lineCount);
        // keep decreasing font size until it fits
        while (height > maxHeight) {
            final float textSize = getTextSize();
            setTextSize(TypedValue.COMPLEX_UNIT_PX, (textSize - 1));
            height = getHeight(getLineCount(maxWidth, getText()));
        }
        // show fitted textView
        requestLayout();
    }

    private float getHeight(int lineCount) {
        return lineCount * getLineHeight() + (lineCount > 0 ? (lineCount - 1) * getPaint().getFontSpacing() : 0);
    }

    private int getLineCount(float maxWidth, CharSequence text) {
        int lineCount = 0;
        int index = 0;
        final TextPaint paint = getPaint();
        while (index < text.length()) {
            index += paint.breakText(text, index, text.length(), true, maxWidth, null);
            lineCount++;
        }
        return lineCount;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-26T15:49:42.667

你对这个问题有一个很好的解决方案，但我从不同的角度来看待这个问题。我认为至少对于新的android开发人员来说，逻辑更简单，更容易理解。这个想法是基于在大字符串的空格之间插入 '\n' 字符。然后，我将 textView 处的编辑字符串设置为显示文本。所以，这里是代码..

```
private String insertNewLineCharAtString(String str, int step){
    StringBuilder sb = new StringBuilder();
    int spaceCounter = 0;
    String[] strArray = str.split(" ");
    for(int i = 0; i < strArray.length; i++){

        if(spaceCounter == step){
            sb.append('\n');
            sb.append(strArray[i]);
            spaceCounter = 0;
        }else{
            sb.append(" "+strArray[i]);
        }
        spaceCounter++;

    }
    return sb.toString();
} 
```

参数很简单。Str 是我们要编辑的字符串，变量 step 定义该方法将在多少空格中插入“/n”字符。然后，您只需调用以下代码：

```
myTextView.setText(insertNewLineCharactersAtString(yourDisplayingStr); 
```

希望这对你们中的许多人有所帮助，因为你们不想更深入地使用 TextPaint 、 Rects 和数学函数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-08T18:29:29.037

使用[nunofmendes 的想法](https://stackoverflow.com/a/16672131)，我编写了一个 TextView 的派生类，它可以自动调整文本大小并支持多行。

```
import android.content.Context;
import android.os.Handler;
import android.text.Layout;
import android.text.TextPaint;
import android.text.TextUtils.TruncateAt;
import android.util.AttributeSet;
import android.util.TypedValue;

public class AutoResizeTextView extends TextView {

    private Handler measureHandler = new Handler();
    private Runnable requestLayout = new Runnable() {
        @Override
        public void run() {
            requestLayout();
        }
    };

    public AutoResizeTextView(Context context, AttributeSet attrs, int defStyle) {
        super(context, attrs, defStyle);
    }

    public AutoResizeTextView(Context context, AttributeSet attrs) {
        super(context, attrs);
    }

    public AutoResizeTextView(Context context) {
        super(context);
    }

    @Override
    protected void onMeasure(final int widthMeasureSpec,
                             final int heightMeasureSpec) {
        super.onMeasure(widthMeasureSpec, heightMeasureSpec);

        final float maxWidth = getWidth();
        final float maxHeight = getHeight();
        if (maxWidth < 1.0f || maxHeight < 1.0f) {
            return;
        }

        int index = 0;
        int lineCount = 0;
        CharSequence text = getText();
        final TextPaint paint = getPaint();
        while (index < text.length()) {
            index += paint.breakText(text, index, text.length(), true, maxWidth, null);
            lineCount++;
        }
        final float height = lineCount * getLineHeight() + (lineCount > 0 ?
                (lineCount - 1) * paint.getFontSpacing() : 0);
        if (height > maxHeight) {
            final float textSize = getTextSize();
            setTextSize(TypedValue.COMPLEX_UNIT_PX, (textSize - 1));
            measureHandler.post(requestLayout);
        }
    }
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-11-21T04:06:14.257

感谢您的解决方案，您是超人！我已经在 TextView 的派生类中实现了您的代码。该代码将转换为 Xamarin android 的 C# 代码。如果需要，您可以轻松转换为 Java（删除 Java 的第一个构造函数）。

```
public class AutoFitTextView : TextView
{
    public AutoFitTextView(System.IntPtr javaReference, Android.Runtime.JniHandleOwnership transfer)
        : base(javaReference, transfer)
    {
    }

    public AutoFitTextView(Context context)
        : base(context)
    {

    }

    public AutoFitTextView(Context context, IAttributeSet attrs)
        : base(context, attrs)
    {

    }

    public void ResizeFontSize()
    {
        int textSize = 50;
        int maxHeight = this.Height;
        while (GetHeightOfMultiLineText(this.Text, textSize, this.Width) > maxHeight)
        {
            textSize--;
        }
        float scaleFactor = Context.Resources.DisplayMetrics.ScaledDensity;
        float additionalFactor = 1.2f;

        TextSize = ((float)(textSize / (additionalFactor * scaleFactor)));
    }

    private int GetHeightOfMultiLineText(string text, int textSize, int maxWidth)
    {
        TextPaint paint = new TextPaint();
        paint.TextSize = textSize;
        int index = 0;
        int lineCount = 0;
        while (index < text.Length)
        {
            index += paint.BreakText(text, index, text.Length, true, maxWidth, null);
            lineCount++;
        }

        Rect bounds = new Rect();
        paint.GetTextBounds("Yy", 0, 2, bounds);
        // obtain space between lines
        double lineSpacing = Math.Max(0, ((lineCount - 1) * bounds.Height() * 0.25));

        return (int)Math.Floor(lineSpacing + lineCount * bounds.Height());
    }

} 
```

这是AXML代码

```
 <touchtest.AutoFitTextView
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:id="@+id/tvLabel2"
        android:singleLine="false"
        android:inputType="textMultiLine"
        android:text="I am here To test this text" /> 
```

* * *

## 回答 #6

> 赞同：-2
> 
> 时间：2013-11-02T14:22:28.100

可编译的、固定的代码：复制粘贴这个，而不是接受的，因为你需要修复它:)

```
public static int getHeightOfMultiLineText(String text, int textSize, int maxWidth) {
    TextPaint paint = new TextPaint();
    paint.setTextSize(textSize);
    int index = 0;
    int lineCount = 0;
    while (index < text.length()) {
        index += paint.breakText(text, index, text.length(), true, maxWidth, null);
        lineCount++;
    }

    Rect bounds = new Rect();
    paint.getTextBounds("Yy", 0, 2, bounds);
    // obtain space between lines
    double lineSpacing = Math.max(0, ((lineCount - 1) * bounds.height() * 0.25));

    return (int) Math.floor(lineSpacing + lineCount * bounds.height());
} 
```

需要使用，谢谢。

**重要提示：您需要考虑比例因子**

```
 int textSize = 50;
    int maxHeight = boundsTv.height();
    while (getHeightOfMultiLineText(text, textSize, params.width) > maxHeight) {
        textSize--;
    }
    float scaleFactor =  mainActivity.getResources().getDisplayMetrics().scaledDensity;     
    float temp = 1.2f;

    tvText.setTextSize((float) (textSize / (temp*scaleFactor))); 
```

# c# - 如何获取列表视图数据模板项目双击WPF MVVM

> ID：16082360
> 
> 赞同：2
> 
> 时间：2013-04-18T12:00:02.827
> 
> 标签：c#, wpf, listview, mvvm

如何绑定到列表视图中显示并被双击的数据模板？

我想要这样的东西：

```
<CheckBox Grid.Column="1" Grid.Row="5" Command="{Binding AddItemCommand}"></CheckBox> 
```

我已经完成了所有工作，但不知道如何将命令绑定到列表视图中的数据模板或该数据模板中的网格。

数据模板是这样的：

```
<DataTemplate x:Key="ServerViewItemTemplate" DataType="ViewModel:ServerViewModel">
        <Border BorderBrush="Black" BorderThickness="1" Margin="10">

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="70" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <Grid.RowDefinitions>
                    <RowDefinition Height="20" />
                    <RowDefinition Height="20" />
                    <RowDefinition Height="20" />
                    <RowDefinition Height="20" />
                    <RowDefinition Height="20" />
                    <RowDefinition Height="20" />
                </Grid.RowDefinitions>

                <TextBlock Grid.Column="0" Grid.Row="0" Text="ServerId:" FontWeight="Bold"/>
                <TextBlock Grid.Column="1" Grid.Row="0" Text="{Binding ServerId}" FontWeight="Bold"/>
                <TextBlock Grid.Column="0" Grid.Row="1" Text="Login:"/>
                <TextBlock Grid.Column="1" Grid.Row="1" Text="{Binding Login}" />
                <TextBlock Grid.Column="0" Grid.Row="2" Text="Password:"/>
                <TextBlock Grid.Column="1" Grid.Row="2" Text="{Binding Password}" />
                <TextBlock Grid.Column="0" Grid.Row="3" Text="Type:"/>
                <TextBlock Grid.Column="1" Grid.Row="3" Text="{Binding Type}" />
                <TextBlock Grid.Column="0" Grid.Row="4" Text="IpAddress:"/>
                <TextBlock Grid.Column="1" Grid.Row="4" Text="{Binding IpAddress}" />
                <TextBlock Grid.Column="0" Grid.Row="5" Text="Include:"/>
                <CheckBox Grid.Column="1" Grid.Row="5" Command="{Binding AddItemCommand}"></CheckBox>
            </Grid>
        </Border>
    </DataTemplate> 
```

所以如果它被双击它应该调用ICommand，和在CheckBox AddItemCommand中一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:16:34.967

我建议使用 Behavior 来处理双击事件。根据双击时想要执行的操作，您可能需要将`ICommand`依赖属性添加到行为，以便您可以绑定到视图模型上的命令。

这是一个类似的帖子：[XAML 中是否有办法在双击时选择文本框中的所有文本？](https://stackoverflow.com/questions/16041556/is-there-a-way-in-xaml-to-select-all-text-in-textbox-when-double-clicked/16042596#comment22891353_16042596)

在该示例中，用户在双击时选择 TextBox 中的文本。

更多的：

您的 XAML 将如下所示：

```
<DataTemplate x:Key="ServerViewItemTemplate" DataType="ViewModel:ServerViewModel">
    <Border BorderBrush="Black" BorderThickness="1" Margin="10">

        <Grid>
            <e.Interaction.Behaviors>
                <local:DoubleClickBehavior Command="{Binding Path=AddItemCommand}"/>
            </e.Interaction.Behaviors>

            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="70" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
... ... 
```

# r - 根据另一个变量的平均值和一个因子在数据框中创建一个数值变量

> ID：16082366
> 
> 赞同：1
> 
> 时间：2013-04-18T12:00:13.827
> 
> 标签：r

好的，所以我有一个很可能是一个简单的问题，尽管我发现它很难提出（这可能是问题的根源）。

如果我有以下示例数据：

```
 V1 <- c(1,1,1,1,1,2,2,2,2,2)
    factor <- factor(V1)
    V2 <- c(1,2,3,4,5,6,7,8,9,10)
    V3 <- c(10,20,30,40,50,60,70,80,90,100)
    test <- data.frame(factor,V2,V3) 
```

我该如何生成另一个变量，比如说 V4，即每个因子水平的 V3 的平均值？我可以使用例如 tapply 获得平均值：

```
 tapply(test$V3, test$factor, FUN=mean) 
```

在这种情况下，这将分别导致 30 和 80，但我希望它形成一个重复变量，相关因子水平的长度如下：

```
 factor V2  V3 v4
   1       1  1  10 30
   2       1  2  20 30
   3       1  3  30 30
   4       1  4  40 30
   5       1  5  50 30
   6       2  6  60 80
   7       2  7  70 80
   8       2  8  80 80
   9       2  9  90 80
   10      2 10 100 80 
```

欢迎任何建议和解决方案以及如何更好地表达问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T12:02:49.863

使用`ave`代替`tapply`：

```
within(test, {
  V4 <- ave(V3, factor, FUN = mean)
})
   factor V2  V3 V4
1       1  1  10 30
2       1  2  20 30
3       1  3  30 30
4       1  4  40 30
5       1  5  50 30
6       2  6  60 80
7       2  7  70 80
8       2  8  80 80
9       2  9  90 80
10      2 10 100 80 
```

该构造与您使用的方式非常相似`tapply`。我使用`within`的原因有两个：（1）节省一些输入，（2）允许我们自动创建新列。

* * *

该`data.table`包为这些类型的操作提供了一些非常方便的语法：

```
> library(data.table)
data.table 1.8.8  For help type: help("data.table")
> DT <- data.table(test)
> DT[, V4 := mean(V3), by = factor]
> DT
    factor V2  V3 V4
 1:      1  1  10 30
 2:      1  2  20 30
 3:      1  3  30 30
 4:      1  4  40 30
 5:      1  5  50 30
 6:      2  6  60 80
 7:      2  7  70 80
 8:      2  8  80 80
 9:      2  9  90 80
10:      2 10 100 80 
```

* * *

不要让读者不知所措，但有*很多*方法可以做到这一点。以下是基础 R 中的另外两个解决方案（尽管比已经共享的替代方案效率低得多）。

`aggregate`

```
merge(test, 
      setNames(aggregate(V3 ~ factor, test, mean), 
               c("factor", "V4")), all = TRUE) 
```

利用你的`tapply`输出。

```
temp <- tapply(test$V3, test$factor, FUN=mean)
temp <- data.frame(V4 = temp)
merge(test, temp, by.x = "factor", by.y = "row.names", all = TRUE) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:04:53.953

这是一个解决方案`plyr`：

```
R> ddply(test, .(factor), transform, V4=mean(V3))
   factor V2  V3 V4
1       1  1  10 30
2       1  2  20 30
3       1  3  30 30
4       1  4  40 30
5       1  5  50 30
6       2  6  60 80
7       2  7  70 80
8       2  8  80 80
9       2  9  90 80
10      2 10 100 80 
```

# sql - 向表中插入数据返回错误代码 195

> ID：16082367
> 
> 赞同：1
> 
> 时间：2013-04-18T12:00:13.907
> 
> 标签：sql, sql-server, cobol, error-code

[这个问题源于我在这个](https://stackoverflow.com/questions/16021936/inserting-data-into-sql-server-returns-error-code-00q)问题中收到的建议，即更改我的错误代码定义并从那里开始。

我的问题：尝试将数据插入表时，我收到`SQLCODE 00195`和`SQLSTATE S0001`. 如果我正确理解错误代码，一个非零的正数表示查询成功但有警告。当我查看我的数据库时，没有插入任何数据。我找到[了两个](http://www.sql-server-helper.com/error-messages/msg-195.aspx) 将这个错误代码描述为的[资源](https://issues.apache.org/jira/browse/OPENJPA-1615)

> 不是公认的内置函数名

如您所见，我的表达式中使用的两个函数是`TRIM`和`SHA1`。如果我忽略它们，同样的错误仍然存​​在。

`PIC -(4)9`正如我在另一篇文章中所建议的那样，使用 SQLCODE 字段的定义`-195`作为结果返回，也是一个我似乎找不到任何相关的错误代码。

我使用 SQL Server 2012 和 Percobol，它利用了 OpenCobol 编译器。

字段声明：

```
01 SQLCODE PIC 9(5).
01 SQLSTATE PIC X(5).

01 WS-INPUT.
        05 ACHTERNAAM PIC X(25) VALUE SPACES.
        05 VOORNAAM PIC X(15) VALUE SPACES.
        05 EMAIL PIC X(50) VALUE SPACES.
        05 LOGIN PIC X(15) VALUE SPACES.
        05 WACHTWOORD PIC X(11) VALUE SPACES.
        05 GEBR_TYPE PIC X(20) VALUE SPACES. 
```

SQL查询：

```
EXEC SQL INSERT INTO dbo.Gebruikers
    VALUES ( TRIM( :LOGIN ), TRIM( :ACHTERNAAM ),
             TRIM( :EMAIL ), TRIM( :PROJECTCODE ),
             TRIM( :GEBR_TYPE ), TRIM( :VOORNAAM ),
             SHA1( TRIM( :WACHTWOORD ) ) )
END-EXEC 
```

数据库：

![表格概览](https://i.stack.imgur.com/3ekP1.jpg)

连接字符串：

```
jdbc:sqlserver://localhost\SQLEXPRESS;databaseName=Groep31;user=Groep31;password=somepw 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:18:52.297

[解决方案](http://blog.sqlauthority.com/2007/04/24/sql-server-trim-function-udf-trim/)：`TRIM`SQL Server 不支持。使用`RTRIM`固定它。

[解决方案](http://msdn.microsoft.com/en-us/library/ms174415.aspx)：`SHA1`SQL Server 也不支持。使用`HashBytes('SHA1', RTRIM(:WACHTWOORD))`修复了这个（虽然现在有一些编码问题）。

# php - 如何通过ajax函数调用获取动态值

> ID：16082373
> 
> 赞同：0
> 
> 时间：2013-04-18T12:00:27.287
> 
> 标签：php, mysql, ajax

在我的网页上，我有这样的文本区域 ![在此处输入图像描述](https://i.stack.imgur.com/tszzE.png)

我想当我交替选择框（或onChange事件）的值时在textarea中获取数据，所以我使用了ajax函数

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
        <script>                          
                function myCall() {
                    var request = $.ajax({
                        url: "ajax.php",
                        type: "GET",            
                        dataType: "html"
                    });

                    request.done(function(msg) {
                        $("#mybox").html(msg);          
                    });

                    request.fail(function(jqXHR, textStatus) {
                        alert( "Request failed: " + textStatus );
                    });
                }

        </script> 
```

这是我的选择框代码，

```
<select name="txtname" id="txtname" onChange="myCall()" >
    <option value="0">Select Age:</option>
    <option value="100083">100083</option>
    <option value="22-26">22-26</option>
    <option value="26-30">26-30</option>
    <option value="30-34">30-34</option>

    </select> 
```

实际上我想根据选择框值来获取记录，这个函数对静态值工作正常，但我很困惑如何从数据库中获取数据..我的 ajax 页面编码在这里..

```
<?php

$con=mysql_connect("localhost","root","");
if (!$con)
  {
  die('Could not connect: ' . mysql_error());
  }

mysql_select_db("hmc", $con);

$sql="SELECT * FROM news WHERE name = '22-26'";

$result = mysql_query($sql);
?>

                       <?php
  while($row=mysql_fetch_array($result))
{
?>
        <tr>
<td>
<?php echo $row['news1'];?></h3></td>

</tr><br /><hr /><br />

<?php
}
?>

</div> 
```

任何想法将不胜感激...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:03:10.193

您的 ajax 调用不正确，您需要将您的选择框值传递给 php 端，像这样

```
$.ajax({
                    url: "ajax.php",
                    type: "GET",            
                    dataType: "html",
                    data:"value="+$("#txtname").val();
                }); 
```

然后使用 $_GET['value'] 在 php 端使用这个值

# java - 打印堆栈而不弹出元素java

> ID：16082380
> 
> 赞同：2
> 
> 时间：2013-04-18T12:00:36.660
> 
> 标签：java, printing, stack

对于一项任务，我必须编写一个打印堆栈的方法，这部分很容易

```
public void print(stack s)
{
   while(!isEmpty())
   {
      System.out.println(s.peek());
      s.pop();
   }

} 
```

问题是在我打印堆栈之后，我的任务是打印堆栈上的底部元素，这不再是因为我在我的打印方法中使用了 s.pop() 。这是我打印底部元素的代码。

```
public void bottom(stack s)
{
  if(isEmpty())
   {
     System.out.println("Stack is empty");
   }
  else
   {
     System.out.println(stackArray[0]);
   }
} 
```

我的问题是：我应该如何修改打印方法，这样我就不必从堆栈中弹出元素？还是有另一种方法可以使堆栈在使用 print 方法后仍然保留我的元素？

根据要求，这是我们在课堂上使用的堆栈（大部分是荷兰语）：

```
public class MyStack
{
    protected Object[ ] stackArray;
    protected int top;
    private int grootte;
    private static final int DEFAULT_GROOTTE = 10;

    public MyStack( )
    {
        grootte = DEFAULT_GROOTTE;
        stackArray = new Object[grootte];
        top = 0;
    }

    public boolean isEmpty( )
    {
        if (top == 0)
                return true;
            else 
                return false;
    }

    public void push(Object e)
    {
        if (top == grootte)
            allocateMore( );
        stackArray[top] = e;
        top++;
    }

    public Object pop( )
    {
            if(isEmpty( ))
            {
                System.out.println("Stack leeg : er kan geen element van de stack afgehaald worden.");
                return null;
            }
                    top--;
                    return stackArray[top];

}
    public Object peek( )
    {
            if(isEmpty( ))
            {
                System.out.println("Stack leeg : er kan geen topelement van de stack getoond worden.");
                return null;
            }
                    return stackArray[top-1];
    }

    public int size( )
    {
        return top;
    }

    private void allocateMore( )
    {
        Object[ ] original = stackArray;
        grootte = grootte * 2;
        stackArray = new Object[ grootte];
        for(int i = 0; i < grootte/2; i++)
        {
            stackArray[i] = original[i];
    }
    }

} 
```

因为我的代表不够高，无法回答我自己的问题，所以快速编辑

我想我找到了另一种使用它来打印堆栈的方法

```
public void print(stack s)
{
 for(int i =top-1; i>=0;i--)
   System.out.println(stackArray[i]);
} 
```

这可能不是最好的方法，但它正在工作：P

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T12:05:03.190

如果您使用内置`java.util.Stack`类型，则它派生自`Vector`，因此您可以使用它`getElement(int)`来读取任何堆栈深度的元素。

如果这是您自己的代码，则必须添加一个方法来执行相同的操作。

或者，您可以将元素弹出到另一个堆栈或`List`类型中，然后在打印后重建堆栈，但这会非常低效，您的老师很可能会对这样的解决方案皱眉。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-01-26T07:55:16.647

如果您只想查看没有任何花哨的内容的内容，有一个简单的解决方法。

```
System.out.println(Arrays.toString(myStack.toArray())); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-22T08:31:43.390

使用*Iterator*循环堆栈，因为它们适用于任何 Collection 对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-25T07:21:13.870

```
if (!_stack.empty()) 
```

检查堆栈是否为空

```
for(int i=_stack.size()-1; i>=0;i--)  
System.out.println(_stack.get(i)); 
```

获取堆栈值

# c++ - c++中的继承。为什么是错的？

> ID：16082381
> 
> 赞同：0
> 
> 时间：2013-04-18T12:00:39.377
> 
> 标签：c++, inheritance, syntax, constructor, initialization

```
class Human 
{
    protected:
        string name;
    public:
        Human () : name ("Jim") {}
        Human (string n) : name (n) {}
};

class Adult : public Human
{
    private:
        string passportId;
    public:
        Adult ()// : name ("Eric"), passportId ("N0123") - *THIS IS ERROR* 
        {
            // this is ok
            name = "Eric";  
            passportId = "N0934956";
        }

        Adult (string n, string id)// : name(n), passportId(id) *THIS IS ERROR*
        { 
            // this is ok
            name = n;
            passportId = id;
        }
}; 
```

所以我们有基类**Human**和派生类**Adult**。在代码中（构造函数的实现在哪里）你可以看到注释行。

为什么在这种情况下使用这样的初始化是错误的？

```
Adult (string n, string id) : name(n), passportId(id) {} // *THIS IS ERROR* 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T12:05:45.990

正确的形式是：

```
Adult(string n, string id) : Human(n), passportId(id) {} 
```

初始化列表用于初始化基类和您自己的成员。你不初始化你的基地的成员，他们自己做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T12:05:43.670

使用初始化列表你只能初始化你自己的成员变量。

您必须`Human`在初始化列表中使用构造函数：

```
Adult (string n, string id)
    : Human(n), passportId(id)
    {} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-18T12:06:36.503

基类是在派生类之前构建的，因此您将无法在初始化列表中实例化基类的成员。

但是，您可以像这样在初始化列表中调用基类的构造函数

```
Adult() : Human("Eric"), passportId("N0123") { } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T12:12:11.710

这不起作用，因为您尝试访问尚未构造的对象的成员。你能做的是

```
class Human 
{
    protected:
        string name;
    public:
        Human () : name ("Jim") {}
        Human (string n) : name (n) {}
};

class Adult : public Human
{
    private:
        string passportId;
    public:
        Adult () : Human ("Eric"), passportId ("N0123") 
        {
        }

        Adult (string n, string id) : Human(n), passportId(id)
        { 
        }
}; 
```

这行得通，因为它指示编译器使用给定值创建对象的基类部分。稍后在代码中 - 正如您已经在构造函数中所做的那样 - 您可以访问受保护的成员。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T12:03:57.513

在执行成员初始化列表之前`Adult`，会调用并执行基类默认构造函数。在基类子对象初始化期间，成员`name`（它是基类的成员）被构造（并初始化）。这意味着，在执行派生类的成员初始化列表时，`name`已经存在，这就是您的程序格式错误的原因。

您应该做的是：选择适当的基类构造函数以便`name`正确初始化。这是您的操作方法：

```
Adult (string n, string id) : Human(n), passportid(id) {} 
```

希望有帮助。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-18T12:04:28.463

成员初始化器列表（即`:`构造器中的初始化器）只能初始化基类和构造器类的成员。初始化基类的成员是基类构造函数的工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-18T12:04:29.063

因为你的派生类`Adult`包含`Human`一个对象，你必须调用它的构造函数才能创建它。当您的`Adult`对象死亡时，以相反的顺序调用析构函数。First`Adult`的析构函数，然后`Human`是 的析构函数。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-18T12:05:20.240

在第一次初始化中：

```
Adult ()// : name ("Eric"), passportId (N0123) - *THIS IS ERROR* 
```

你可能忘记了`"`passportId周围，第二个：

```
Adult (string n, string id)// : name(name), passportId(id) *THIS IS ERROR* 
```

我认为你混淆了`n`and `name`，而且，看起来你应该像这样调用父构造函数：

```
Adult (string n, string id) : Human(n), passportId(id) 
```

* * *

## 回答 #9

> 赞同：-2
> 
> 时间：2013-04-18T12:03:13.203

你把名字和n混淆了吗？

```
Adult (string n, string id) : name(n), passportId(id) {} 
```

# django - Django：我如何对两个模型的日期进行排序？

> ID：16082382
> 
> 赞同：2
> 
> 时间：2013-04-18T12:00:40.970
> 
> 标签：django, date, sorting, models

1.) 我有以下 models.py 定义：

```
 from django.db import models
    from datetime import date

    class Author(models.Model):
        author  = models.CharField(max_length=20)
        def __unicode__(self):
            return '%s' % (self.author)

    class SystemA(models.Model):
        author      = models.ForeignKey(Author)
        date        = models.DateField()
        system      = models.CharField(max_length=20, blank=False, default="System A")
        description = models.CharField(max_length=300)
        status = models.CharField(max_length=6)
        def __unicode__(self):
            return '%s, %s, %s, %s, %s' % (self.date, self.author, self.system, self.description, self.status)

    class SystemB(models.Model):
        author      = models.ForeignKey(Author)
        date        = models.DateField()
        system      = models.CharField(max_length=20, blank=False, default="System B")
        description = models.CharField(max_length=300)
        status = models.CharField(max_length=6)
        def __unicode__(self):
            return '%s, %s, %s, %s, %s' % (self.date, self.author, self.system, self.description, self.status) 
```

2.) 这个 admin.py 定义：

```
 from acc.models import SystemA, SystemB, Author
    from django.contrib import admin

    admin.site.register(SystemA)
    admin.site.register(SystemB) 
```

3.）这是我的views.py定义：

```
 from django.http import HttpResponse
    from acc.models import SystemA, SystemB
    from django.template import Context, loader
    from itertools import chain
    from operator import attrgetter

    def index(request):
      a_list = SystemA.objects.all().order_by('-date')
      b_list = SystemB.objects.all().order_by('-date')
      result_list = sorted(
        chain(a_list, b_list),
        key=attrgetter('date'))
      t = loader.get_template('index.html')
      #c = Context({'result_list': result_list,})
      c = Context({'a_list': a_list,'b_list': b_list,})
      return HttpResponse(t.render(c)) 
```

4.) 最后，呈现静态 HTML 页面 (index.html) 的模板定义为：

```
 {% if a_list %}
    <ul>
    {% for a in a_list %}
    <li>{{a.date}} | {{a.author}} | {{a.system}} | {{a.description}} | {{a.status}}</li>
    {% endfor %}
    </ul>
    {% endif %}

    {% if b_list %}
    <ul>
    {% for b in b_list %}
    <li>{{b.date}} | {{b.author}} | {{b.system}} | {{b.description}} | {{b.status}}</li>
    {% endfor %}
    </ul>
    {% endif %} 
```

代码正在运行，我已经从管理界面输入了一些数据。结果：

```
April 18, 2013 | owta | System A | All jobs went bananas! | FAILED
April 17, 2013 | rash | System A | All Well | OK

April 18, 2013 | owta | System B | All jobs went bananas! | FAILED
April 17, 2013 | rash | System B | All well | OK 
```

我的目标是获得按日期排序的结果，独立于模型（SystemA/SystemB），按以下排序顺序：

```
April 17, 2013 | rash | System A | All Well | OK
April 17, 2013 | rash | System B | All well | OK
April 18, 2013 | owta | System A | All jobs went bananas! | FAILED
April 18, 2013 | owta | System B | All jobs went bananas! | FAILED 
```

我花了半周的时间试图解决这个问题，但没有成功，而且我是 Django 的菜鸟。一些帮助将不胜感激！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T14:08:03.057

> “我以前使用单一模型解决方案，但不知何故觉得我必须为我的系统提供不同的类/模型，以便将数据很好地提取到从每个系统按日期排序的静态页面中”

皮疹，这就是你用一个模型做的事情。请记住，始终尽量减少系统中的重复。

### 模型.py

```
from django.db import models

class Author(models.Model):
    author  = models.CharField(max_length=20)
    def __unicode__(self):
        return '%s' % (self.author)

class System(models.Model):
    SYSTEM_CHOICES = (('A','System A'),('B','System B'))
    author      = models.ForeignKey(Author)
    date        = models.DateField()
    system      = models.CharField(max_length=1, choices=SYSTEM_CHOICES) # see [1]
    description = models.CharField(max_length=300)
    status      = models.CharField(max_length=6) 
```

### 管理员.py

```
from django.contrib import admin

class SystemAdmin(admin.ModelAdmin):
    list_filter = ['system'] # See [2]

admin.site.register(System, SystemAdmin) 
```

### 网址.py

```
url(r'^/system/(?P<system>A|B)/list/$', views.SystemListView.as_view(), name='system-list' ) 
```

### 视图.py

```
from django.views.generic.list import ListView
from .models import System

class SystemListView(ListView):
    model = System
    context_object_name = "Systems"

    def get_queryset(self):
        return super(SystemListView, self) \
          .filter(system = self.kwargs['system']) \
          .order_by(self.request.GET.get('sort') or '-date') 
```

### {template_folder}/yourapp/system/list.html

```
<h1> System {{ system }}{# See [3] #} </h1>
<ul>
{% for sys in Systems %}
  <li>{{sys.date}} | {{sys.author}} | {{sys.description}} | {{sys.status}}</li>
{% endfor %}
</ul> 
```

### 附录

```
[1] https://docs.djangoproject.com/en/stable/ref/models/fields/#choices
[2] https://docs.djangoproject.com/en/stable/ref/contrib/admin/#django.contrib.admin.ModelAdmin.list_filter
[3] https://github.com/django/django/blob/master/django/views/generic/detail.py#L99 
```

# c# - 如何让敌人在 XNA 的屏幕周围跟随玩家？

> ID：16082384
> 
> 赞同：3
> 
> 时间：2013-04-18T12:00:52.870
> 
> 标签：c#, xna, artificial-intelligence, game-physics, path-finding

好的，所以我有一些代码可以让我的敌人在我的 XNA 游戏中跟随玩家，但他们只会跟随玩家直到玩家在他们面前。如果玩家经过一个敌人，它将停止向他移动。相反，它们会随着玩家不断上下移动。

我使用的代码是这样的：

```
 Vector2 direction = player.Position - goblins[i].Position;
         direction.Normalize();
         Vector2 velocity = direction * goblins[i].enemyMoveSpeed;
         goblins[i].Position += velocity; 
```

（忽略妖精位，我刚刚更换了图形）

不完全确定要去哪里，有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T03:17:59.500

汤姆，你好，你好吗？

在这里，您有两个对我有很大帮助的示例：

1.  Chase & Evade ( [http://xbox.create.msdn.com/en-US/education/catalog/sample/chase_evade](http://xbox.create.msdn.com/en-US/education/catalog/sample/chase_evade) ) 这是一个 Microsoft 示例，展示了如何为 AI 实现几种简单的行为，包括追逐、逃避和徘徊。
2.  为敌人添加视野 ( [http://robotfootgames.com/xna-tutorials/5-xna-platformer-starter-kit-field-of-view-for-enemies](http://robotfootgames.com/xna-tutorials/5-xna-platformer-starter-kit-field-of-view-for-enemies) ) 与 1 号样本和 Plaformer 入门套件相关

# javascript - 在 Google Chrome 上显示 svg 图像

> ID：16082387
> 
> 赞同：2
> 
> 时间：2013-04-18T12:00:59.643
> 
> 标签：javascript, google-chrome, svg, d3.js

当我想在 Google Chrome 上使用库 D3.js 显示 SVG 图像时遇到问题。

下面是代码：

```
var svg = d3.select("body").append("embed");

svg.attr("src","img/drawing.svg").attr("type","image/svg+xml"); 
```

此代码适用于 Firefox，但不适用于 Google Chrome（如果我使用对象而不是嵌入，则会出现同样的问题）。

但是，如果我将此样式添加到我的 SVG 图片 :`attr("style", "display:block")`中，我的图片会显示在 Google Chrome 上。

...有人可以解释一下会发生什么吗？因为这样显示我的图像非常难看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T19:51:05.093

根据[w3schools](http://www.w3schools.com/svg/svg_inhtml.asp)的说法，嵌入标签“*在 HTML4 和 XHTML 中已弃用（但在 HTML5 中允许）* ”。您应该使用对象标签。以下代码段适用于我的 Chrome：

```
var svg = d3.select("body").append("object");

svg.attr("data", "http://upload.wikimedia.org/wikipedia/commons/6/6b/Bitmap_VS_SVG.svg")
   .attr("type","image/svg+xml"); 
```

# java - JPA Join 使用任意字段（不是主键）

> ID：16082388
> 
> 赞同：5
> 
> 时间：2013-04-18T12:01:01.423
> 
> 标签：java, jakarta-ee, jpa, one-to-many

我有两个实体，我想使用它们共同的字段（称为 shared_id）将它们连接在一起。该字段不是任一实体的主键。shared_id 是唯一的——每个 Hipster 都有一个唯一的 shared_id。

表格如下所示：

```
Hipster    Fixie
=========  ========
id         id
shared_id  shared_id 
```

Hipster 和他们的 Fixies 之间存在 OneToMany 关系。我试过这样的事情：

```
@Entity
public class Hipster {

    @Id
    @Column(name = "id")
    private Integer id;

    @Column(name = "shared_id")
    private Integer sharedId;

    @OneToMany(mappedBy = "hipster")
    private List<Fixie> fixies;
}

@Entity
public class Fixie {

    @Id
    @Column(name = "id")
    private Integer id;

    @ManyToOne
    @JoinColumn(name = "shared_id", referencedColumnName = "shared_id")
    private Hipster hipster;
}

@Repository
public class HipsterDAO {

    @PersistenceContext
    private EntityManager entityManager;

    public Hipster getHipsterBySharedId(Integer sharedId) {

        String queryString = "SELECT h FROM Hipster h WHERE h.sharedId = :sharedId";
        TypedQuery<Hipster> query = entityManager.createQuery(queryString, Hipster.class);

        query.setParameter("sharedId", sharedId);
        try {
            return query.getSingleResult();
        } catch (PersistenceException e) {
            return null;
        }
    }
} 
```

现在，我的 DAO 给了我这个错误：

```
java.lang.IllegalArgumentException: Can not set java.lang.Integer field Hipster.sharedId to java.lang.Integer 
```

我认为这很令人不安，因为 sharedId 字段用于关系中，而不仅仅是一个基本字段。我没有在 Fixie 实体中包含 sharedId 字段，但是如果我这样做了，我会得到相同的结果。如何说服它为我运行此查询？我需要更改查询或实体吗？

# perl - 当 Term::ReadKey::ReadKey 返回“0”时，这是什么意思？

> ID：16082391
> 
> 赞同：1
> 
> 时间：2013-04-18T12:01:11.197
> 
> 标签：perl, getc, readkey

在`dumpkeys --long-info`Linux 终端中调用后，我得到以下值：

```
# ...
0x0000  nul
0x0001  Control_a
0x0002  Control_b
0x0003  Control_c
0x0004  Control_d
# ... 
```

当我运行此脚本并按`Ctrl a`or时，`Ctrl b`我会得到相应的值。
当我按下`Ctrl Space` `ReadKey`返回时`0`。
这个 null 是否意味着它是的值，`Ctrl Space`或者它是否意味着没有设置或为空的东西？

```
#!/usr/bin/env perl
use warnings;
use strict;
use Term::ReadKey;

ReadMode('cbreak');
print "Press keys to see their ASCII values.  Use Ctrl-C to quit.\n";

while (1) {
    my $char = ReadKey(0);
    last unless defined $char;
    printf("$char -> Hex: %x\n", ord($char), ord($char));
}

ReadMode('normal');

# -> Hex: 1  # Ctrl a
# -> Hex: 2  # Ctrl b
# -> Hex: 4  # Ctrl d
# -> Hex: 0  # Ctrl Space 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T13:01:55.237

`showkey -a`给我看

```
^A        1 0001 0x01   #  Ctrl a
^B        2 0002 0x02   #  Ctrl b
^@        0 0000 0x00   #  Ctrl Space 
```

并且在[这个](https://superuser.com/a/258834/26076)答案中据说`Ctrl``Space`发送 ASCII NUL 所以我假设 0 代表`Ctrl``Space`1 代表什么`Ctrl``a`

# model-view-controller - 是否可以在 ExtJS MVC 的文件夹中导入所有视图

> ID：16082392
> 
> 赞同：0
> 
> 时间：2013-04-18T12:01:13.930
> 
> 标签：model-view-controller, extjs, view

假设我们有这样的 ExtJS 应用程序文件夹结构：

```
/app
  /view
    /windows
      /window1.js
      /window2.js
      /window3.js 
```

`view.windows`是否可以从 Controller导入文件夹中的所有视图，例如：

```
views:[
  'windows/*'
] 
```

代替

```
views:[
  'windows/window1.js',
  'windows/window2.js',
  'windows/window3.js'
] 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:27:33.137

我认为以下是可能的：

```
requires: ['AppName.view.windows.*'] 
```

# c# - RadioButtonList 内的标题

> ID：16082393
> 
> 赞同：0
> 
> 时间：2013-04-18T12:01:18.977
> 
> 标签：c#, radiobuttonlist

我注意到 RadioButtonList 中的 ListItems 之间不可能有不同的标题。所以我必须拆分 upp 到不同的 RadioButtonList 才能有标题。

是否可以在不重新加载页面或将其放在更新面板中的情况下做到这一点？

```
Exampel:

**Heading 1**

x Option 1
x Option 2
x Option 3

**Heading 2**

x Option 4
x Option 5
x Option 6 
```

我只希望能够检查 6 个选项之一

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:05:44.907

只是将其标记为已解决（对于对解决方案感兴趣的其他人）：

> 您可以通过设置 RadioButton.GroupName 属性来做到这一点！
> 
> [http://msdn.microsoft.com/de-de/library/system.windows.controls.radiobutton.groupname.aspx](http://msdn.microsoft.com/de-de/library/system.windows.controls.radiobutton.groupname.aspx)

# windows-phone-7 - 在 Windows Phone 7 应用程序中以编程方式获取电池剩余百分比？

> ID：16082396
> 
> 赞同：0
> 
> 时间：2013-04-18T12:01:21.683
> 
> 标签：windows-phone-7, c#-4.0

如何在 windows phone 7 应用程序中获取剩余电池百分比？我已经尝试过 Microsoft.Phone.Info.DeviceExtendedProperties.GetValue() 但它不起作用。

# php - 使用第二维键的稳定排序数组

> ID：16082397
> 
> 赞同：2
> 
> 时间：2013-04-18T12:01:22.067
> 
> 标签：php, sorting

我必须使用返回 JSON 的网络服务。解码 JSON 后，我得到数组：

```
$arrays[0]["2013-04-09"]=$someValue;
$arrays[1]["2013-04-09"]=$someValue;
$arrays[2]["2013-04-11"]=$someValue;
$arrays[3]["2013-04-05"]=$someValue;
$arrays[4]["2013-04-09"]=$someValue; 
```

我想要排序（稳定的方式并使用第二个暗键的键）数组并得到结果：

```
$arrays[3]["2013-04-05"];
$arrays[0]["2013-04-09"]; //stable way don't swap with next val
$arrays[1]["2013-04-09"]; //stable way don't swap with next and prev vel
$arrays[4]["2013-04-09"]; //stable way, don't swap with prev val
$arrays[2]["2013-04-11"]; 
```

你能帮助我吗？我尝试创建自己的排序功能，因为 ksort 或 krsort 仅使用第一个暗键进行排序。谢谢你的回答。

编辑：我尝试编写自己的函数 - 这很有效 - 我在单元测试中得到了错误的“有效答案”，这就是我说这不起作用的原因：

```
private function getResult(){
...
usort($arrays,array($this,'mycmp'));
...
}
private function mycmp($a, $b){
    foreach($a as $key=>$val){
        $first = $key;
    }
    foreach($b as $key=>$val){
        $second = $key;
    }

    if ($first == $second){
        return 0;
    }
    return ($first < $second) ? -1:1;

} 
```

感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:10:10.083

假设每个子数组在同一个地方都有日期键（例如，总是对象中的第一个键），您可以执行以下操作：

```
$keyPosition = 0; // location of the key in the array structures

usort($data, function ($a, $b) use ($keyPosition) {
    $aKeys = array_keys($a);
    $bKeys = array_keys($b);

    return strcmp($aKeys[$keyPosition], $bKeys[$keyPosition]);
}); 
```

**但是**，您应该注意的是[PHP 不再支持稳定排序](https://bugs.php.net/bug.php?id=53341)，因此您可能无法获得与以前完全相同的排序。如果这是绝对要求，您可能需要滚动自己的排序功能。[这是一个可能有帮助的要点](https://gist.github.com/olvlvl/1574867)。

# delphi - Delphi DLL 动态错误引发许多连续异常

> ID：16082398
> 
> 赞同：0
> 
> 时间：2013-04-18T12:01:26.200
> 
> 标签：delphi, dll

我从 Delphi 示例代码中找到了这个源代码，我在 Delphi 动态 DLL 中添加了一个控件或组件，我无法弄清楚，

```
library DLLEntryLib;

uses
  SysUtils,
  Windows,
  Dialogs,
  Classes,
  msHTML,
  SHDocVw;

type
TMyWeb = class(TWebBrowser)
constructor create(Aowner: TComponent); override;
end;

var
web: TMyWeb;

// Initialize properties here
constructor TMyWeb.Create(AOwner: TComponent);
begin
inherited Create(Self);
end;

procedure getweb;
begin
    web := TmyWeb.create(nil);
    web.Navigate('http://mywebsite.com');
end;

procedure xDLLEntryPoint(dwReason: DWord);
begin
  case dwReason of
    DLL_PROCESS_ATTACH:
    begin
    getweb; //I THINK THE ERROR IS HERE, HOW TO WORK THIS OUT?
    ShowMessage('Attaching to process');
    end;
    DLL_PROCESS_DETACH: ShowMessage('Detaching from process');
    DLL_THREAD_ATTACH:  MessageBeep(0);
    DLL_THREAD_DETACH:  MessageBeep(0);
  end;
end;

begin
  { First, assign the procedure to the DLLProc variable }
  DllProc := @xDLLEntryPoint;
  { Now invoke the procedure to reflect that the DLL is attaching to the
    process }
  xDLLEntryPoint(DLL_PROCESS_ATTACH);
end.

//IN MY APPLICATION FORM.
procedure TMainForm.btnLoadLibClick(Sender: TObject);
begin
if LibHandle = 0 then
begin
LibHandle := LoadLibrary('DLLENTRYLIB.DLL');
if LibHandle = 0 then
  raise Exception.Create('Unable to Load DLL');
end
else
MessageDlg('Library already loaded', mtWarning, [mbok], 0);
end; 
```

如何摆脱错误？引发多次连续异常

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:47:12.893

当你写：

```
inherited Create(Self); 
```

你应该写

```
inherited Create(AOwner); 
```

您要求控件拥有自己。那是行不通的。如果构造函数失败，这很可能导致非终止递归。

另一个大问题是您正在内部创建一个 Web 浏览器控件`DllMain`。这是一个非常大的禁忌。你会想停止这样做。将该代码移动到单独的导出函数中。中什么都不做`DllMain`。

大概调用者已经初始化了 COM。如果没有，您将需要确保调用者这样做。如果调用者是 VCL 表单应用程序，则 COM 将自动初始化。

# java - 使用java程序读取java类文件

> ID：16082401
> 
> 赞同：-3
> 
> 时间：2013-04-18T12:01:44.437
> 
> 标签：java, io, byte, fileinputstream

我正在编写一个 java 代码来帮助我读取和打印`.class`文件中的所有字节码。

我试过上网，但答案并没有真正回答我的问题。
下面是我目前拥有的代码，基于我在[StackOverflow上找到的一些帮助](http://stackoverflow.com)

```
private static void readByte ( )
{
     Path file = Paths.get("bin/com/reading/frombyte/ReadFourBytes.class");          
     try {
         byte[] myBytes = Files.readAllBytes(file);
         for(byte b : myBytes)
             System.out.println((char)b);
     } catch (IOException e) {
         e.printStackTrace();
     }
} 
```

基本上我想将这些解释`bytes`成人类可读的字符。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:13:52.413

我认为这个命令会帮助你：

```
javap -verbose -c -private ReadFourBytes 
```

# html - 具有小宽度和水平滚动条的块

> ID：16082403
> 
> 赞同：0
> 
> 时间：2013-04-18T12:01:55.780
> 
> 标签：html, css

我想制作一个充满大量照片的块。网页的宽度总是太小，所以我想添加一个水平滚动。

我在这里做到了：http: [//jsfiddle.net/49REZ/](http://jsfiddle.net/49REZ/)

**HTML**

```
<div class="wrapper">
    <div class="photos">
        <ul>
            <li><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg"/></li>
            <li><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg"/></li>
            <li><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg"/></li>
            <li><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg"/></li>
        </ul>
    </div>
</div> 
```

**CSS**

```
.wrapper {
    width: 80%;
    margin: 10px auto;
}

.wrapper {
    overflow-x: scroll;
    overflow-y: hidden;
}

ul, li {
    margin: 0;
    padding: 0;
}

.wrapper ul {
    width: 10000px;
}

ul li {
    list-style: none;
    float: left;
} 
```

它在 Chrome 中运行良好。

但它在 Firefox 中效果不佳，因为它会`10000px`在照片后显示带有大量可用空间的块。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:02:04.847

尝试将 css 替换为以下内容：

```
.wrapper ul {
    white-space: nowrap;
}

ul li {
    list-style: none;
    display: inline-block;
} 
```

[http://jsfiddle.net/49REZ/4/](http://jsfiddle.net/49REZ/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T13:19:09.343

你可以试试这个：
**HTML：**

```
<ul class="images">
  <li><a href="#"><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg" width="150" height="150"/></a></li>
  <li><a href="#"><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg" width="150" height="150"/></a></li>
  <li><a href="#"><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg" width="150" height="150"/></a></li>
  <li><a href="#"><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg" width="150" height="150"/></a></li>
  <li><a href="#"><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg" width="150" height="150"/></a></li>
  <li><a href="#"><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg" width="150" height="150"/></a></li>
  <li><a href="#"><img src="http://photos-ak.sparkpeople.com/nw/4/4/l446472527.jpg" width="150" height="150"/></a></li>
</ul> 
```

**CSS：**

```
 ul.images {
    margin: 0;
    padding: 0;
    white-space: nowrap;
    width: 500px;
    overflow-x: auto;
    background-color: #ddd;
  }
  ul.images li {
    display: inline;
    width: 150px;
    height: 150px;
  } 
```

[jsfiddle](http://jsfiddle.net/uKyQQ/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T12:07:11.870

尝试将您的 10 000px 放在另一个母组件上，例如 div，或者直接放在 body

# android - Android如何检测手机是否转身

> ID：16082406
> 
> 赞同：1
> 
> 时间：2013-04-18T12:01:59.170
> 
> 标签：android

这是我检测手机是否转机的代码

```
private SensorManager sensorManager;
    private int orientationLim = 165;

@Override
    public void onSensorChanged(SensorEvent event) {
        if (event.sensor.getType() == Sensor.TYPE_ORIENTATION) {

            // If shake to stop is enabled
            boolean turnAroundToStop = Utils.getBooleanFromProperties(this, Properties.SP_CB_TURN_AROUND_TO_STOP);

            if (turnAroundToStop) {
                float value = Math.abs(event.values[1]);
                if (value > orientationLim && !stopped) {
                    // Down
                    stopped = true;
                } else {
                    // Up
                    stopped = false;
                }
            }
        }
    } 
```

但问题是`stopped`即使电话没有完全转过来，变量也设置为 true 只是一点点。

我如何修改仅在电话转机时才会执行的代码。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:10:18.273

```
float pitch = values[2];
if (pitch <= 45 && pitch >= -45) {
    // mostly vertical
} else if (pitch < -45) {
    // mostly right side up
} else if (pitch > 45) {
    // mostly left side up
} 
```

看看这里关于这个主题：

[http://www.workingfromhere.com/blog/2009/03/30/orientation-sensor-tips-in-android/](http://www.workingfromhere.com/blog/2009/03/30/orientation-sensor-tips-in-android/)

# web-hosting - 非用户代理被拒绝

> ID：16082412
> 
> 赞同：0
> 
> 时间：2013-04-18T12:02:14.087
> 
> 标签：web-hosting, agent, http-status-code-406

我被卡住了，而且我的头顶上。我用 woocommerce 和 realex（商家公司）建立了一个电子商务网站。我的响应 URL 有问题，在发出编程（非用户代理）请求时它被拒绝。

尝试： `$ wget curl http://fifty2printsolutions.com/?wc-api=WC_Gateway_Realex_Redirect`

但是当你设置一个有效的用户代理时：

尝试： `$ curl -A "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_6_8) AppleWebKit/534.30 (KHTML, like Gecko) Chrome/12.0.742.112 Safari/534.30" http://fifty2printsolutions.com/?wc-api=WC_Gateway_Realex_Redirect`

有用。

这指向服务器配置问题，似乎他的服务器以 406 响应拒绝了程序化（非用户代理）请求。至少这是扩展作者告诉我的

我该如何解决这个问题？我和主人爸爸在一起，支持有点缺乏光泽。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T01:17:43.097

我认为您可能正在处理 Apache mod_security 问题。根据我的实验，只要我在 User-Agent 中有*东西*，它就可以处理。但是，如果我在 User-Agent 中包含**libwww**或**perl**字样，或者将其留空，则它不起作用。

Realex Epage Redirect 使用“epage.cgi / libwww-perl”（或类似的，我面前没有它）作为用户代理。这符合这两个规则，因此被阻止。我们之前遇到过这种情况，唯一的解决方案是要求站点管理员修改 mod_security 规则以允许这样做。我们曾经将 User-Agent 字符串更改为其他字符串，但令人难以置信的是，几个购物车突然停止工作，我们不得不推出更改。

希望这可以帮助

欧文

# c# - 将 PDF 流复制到文件

> ID：16082414
> 
> 赞同：0
> 
> 时间：2013-04-18T12:02:24.813
> 
> 标签：c#, php, filestream, tcpdf, streamwriter

我正在使用 StreamReader 通过 WebRequest 从 C# 调用 PHP (TCPPDF) 中的例程。PDF 文件作为流返回并存储在字符串 (obv) 中。我知道返回到字符串的数据实际上是一个 PDF 文件，因为我已经在 PHP 中对其进行了测试。我很难将字符串写入文件并实际上在 C# 中获取有效的 PDF。我知道这与我尝试对文件进行编码的方式有关，但我尝试过的几件事导致“今天不行，Padre”（即他们没有工作）

这是我用来执行请求的类（感谢用户'Paramiliar'对于我正在使用/借用/偷窃的示例）：

```
 public class httpPostData
    {
        WebRequest request;
        WebResponse response;

        public string senddata(string url, string postdata)
        {

            // create the request to the url passed in the paramaters
            request = (WebRequest)WebRequest.Create(url);

            // set the method to POST
            request.Method = "POST";

            // set the content type and the content length
            request.ContentType = "application/x-www-form-urlencoded";
            request.ContentLength = postdata.Length;

            // convert the post data into a byte array
            byte[] byteData = Encoding.UTF8.GetBytes(postdata);

            // get the request stream and write the data to it
            Stream dataStream = request.GetRequestStream();
            dataStream.Write(byteData, 0, byteData.Length);
            dataStream.Close();

            // get the response
            response = request.GetResponse();
            dataStream = response.GetResponseStream();
            StreamReader reader = new StreamReader(dataStream);

            // read the response
            string serverresponse = reader.ReadToEnd();

            //Console.WriteLine(serverresponse);
            reader.Close();
            dataStream.Close();
            response.Close();

            return serverresponse;
        }
    } // end class httpPostData 
```

...和我的呼唤

```
httpPostData myPost = new httpPostData();    
// postData defined (not shown)
string response = myPost.senddata("http://www.example.com/pdf.php", postData); 
```

如果不清楚，我会坚持写入`string response`有效的 .pdf 文件。我已经尝试过了（感谢用户 Adrian）：

```
static public void SaveStreamToFile(string fileFullPath, Stream stream)
    {
        if (stream.Length == 0) return;

        // Create a FileStream object to write a stream to a file
        using (FileStream fileStream = System.IO.File.Create(fileFullPath, (int)stream.Length))
        {
            // Fill the bytes[] array with the stream data
            byte[] bytesInStream = new byte[stream.Length];
            stream.Read(bytesInStream, 0, (int)bytesInStream.Length);

            // Use FileStream object to write to the specified file
            fileStream.Write(bytesInStream, 0, bytesInStream.Length);
        }
    }

..and the call to it:

    string location = "C:\\myLocation\\";

    SaveStreamToFile(location, response);  // <<-- this throws an error b/c 'response' is a string, not a stream. New to C# and having some basic issues with things like this 
```

我想我已经接近了......在正确的方向轻推将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T13:19:28.660

您可以使用[WebClient](http://msdn.microsoft.com/en-us/library/system.net.webclient.aspx)。使用方法[DownloadFile](http://msdn.microsoft.com/en-us/library/system.net.webclient.downloadfile.aspx)或异步方法。

玩得开心！费尔南多.-

* * *

抱歉，直到现在我还没有阅读您的评论。我想你已经这样做了......

但这可能会对您有所帮助（只需替换 url 和路径）（来自：http: [//msdn.microsoft.com/en-us/library/ez801hhe.aspx](http://msdn.microsoft.com/en-us/library/ez801hhe.aspx)）

```
string remoteUri = "http://www.contoso.com/library/homepage/images/";
string fileName = "ms-banner.gif", myStringWebResource = null;

// Create a new WebClient instance.
WebClient myWebClient = new WebClient();

// Concatenate the domain with the Web resource filename.
myStringWebResource = remoteUri + fileName;

Console.WriteLine("Downloading File \"{0}\" from \"{1}\" .......\n\n", fileName, myStringWebResource);

// Download the Web resource and save it into the current filesystem folder.
myWebClient.DownloadFile(myStringWebResource,fileName);     

Console.WriteLine("Successfully Downloaded File \"{0}\" from \"{1}\"", fileName, myStringWebResource);

Console.WriteLine("\nDownloaded file saved in the following file system folder:\n\t" + Application.StartupPath); 
```

# android - 如何以编程方式关闭 Android 4.0 根设备

> ID：16082416
> 
> 赞同：3
> 
> 时间：2013-04-18T12:02:27.893
> 
> 标签：android, root, android-firmware

请帮我找出解决方案，我知道有很多关于这个的问题和重复，但在这里我描述了我尝试过的所有事情。

我有一台 android 设备，它安装了 4.0 版本的 android。我想使用我的一个演示应用程序关闭此设备。

```
1) Demo application is signed by platform keys which are used in built in file system.
2) Device is already rooted as its development board and i have all permissions on this. 
```

应用程序包含以下内容

```
1) Application is system application
2) Application signed by platform keys which are used in built in file system. 
```

为了使自动化更容易，我确实使用这个[keytool-importkeypair 将这](https://github.com/getfatday/keytool-importkeypair/tree/)`key/cert`对导入到我的 java文件中，并使用 eclipse 进行签名。`keystore`

使用的命令如下所述。

**指令：** `keytool-importkeypair -k ~/Desktop/myown.keystore -p android -pk8 platform.pk8 -cert platform.x509.pem -alias platform`

我使用以下代码重新启动，但我从来没有成功。我在stackoverflow上阅读了很多问题和答案，但他们都说你需要

```
1) root access of device
2) signed apk with any one keys which are available on `build/target/product/security/`
3) Given Proper permission in AndroidManifest.xml file. 
```

我在alomg点上是对的吗？

申请代码：

**第一次尝试**

```
public static void shutdown2() {

Runtime runtime = Runtime.getRuntime();
Process proc = null;
OutputStreamWriter osw = null;

String command = "/system/bin/reboot -p";

try { // Run Script

    proc = runtime.exec("/system/xbin/su");
    osw = new OutputStreamWriter(proc.getOutputStream());
    osw.write(command);
    osw.flush();
    osw.close();

} catch (IOException ex) {
    ex.printStackTrace();
} finally {
    if (osw != null) {
        try {
            osw.close();
        } catch (IOException e) {
            e.printStackTrace();
        }
    }
}
try {
    if (proc != null)
        proc.waitFor();
} catch (InterruptedException e) {
    e.printStackTrace();
}
if (proc.exitValue() != 0) {
}
 } 
```

**第二次尝试：**

```
private void shutdown3() {
        try {

            String[] cmd = { "/system/bin/sh","su","reboot -p"};

            Process proc = Runtime.getRuntime().exec(cmd);
            proc.waitFor();
        } catch (Exception ex) {
            Log.i("TAG", "Could not reboot 3  ", ex);
        }
    } 
```

**第三次尝试：**

```
private void shutdown() {
        try {
            Process proc = Runtime.getRuntime().exec(
                    new String[] { "/system/bin/su", "-c",
                            "/system/bin/reboot -p" });
            proc.waitFor();
        } catch (Exception ex) {
            Log.i("TAG", "Could not reboot 1 ", ex);
        }
    } 
```

在第三种方法中，我也尝试过`"/system/bin/su"`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-28T13:40:45.407

一个更好的解决方案是运行：

`su -c am start -a android.intent.action.ACTION_REQUEST_SHUTDOWN`

您可以`Process`为此使用 a 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-20T12:50:33.227

下面的代码对我有用

```
 Process process = Runtime.getRuntime()
                .exec(new String[]{ "su", "-c", "busybox poweroff -f"});
        process.waitFor(); 
```

# rest - 如何方便地从 .NET 代码中使用 OData 服务

> ID：16082417
> 
> 赞同：1
> 
> 时间：2013-04-18T12:02:31.200
> 
> 标签：rest, asp.net-web-api, odata

是否有从 .NET 代码使用 OData 服务的最佳实践方法/库？这样我就不必弄乱构建查询字符串并手动解析响应了吗？

我设想这样的事情：

```
class Person
{
    public string Name {get; set;}
    public int Age {get; set;}
}

void Main()
{
    Person person = 
       new ODataRequest<Person>()
           .EndPoint("http://server.com/personservice")
           .AddHeader("header", "value")
           .AsJson()
           .Where(p => p.Name.EndsWith("y") && p.Age > 21)
           .Skip(10)
           .Take(5)
           .Send();
} 
```

请忽略语法（并且我将端点相关的东西与查询相关的东西混合在一起），这只是为了传达这个想法。

上面的代码应该使用 $filter、$skip 等表达式自动构建正确的 OData 查询字符串，并解析响应。

这样的图书馆已经建成了吗？还是我一个人在这里？:)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:09:07.643

根据 Padrus 的回答，您正在寻找的库绝对是 WCF 数据服务。它具有扎实的代码生成经验以及相当完整的 LINQ 提供程序。如果您想以最少的投资预先使用它，请试用最新的 LINQPad 测试版 ( [http://www.linqpad.net/Beta.aspx](http://www.linqpad.net/Beta.aspx) )，它内置了 WCF DS 客户端。尽我所能知识，.NET 没有其他可比的东西。

注意：WCF DS 内置在 Visual Studio 中。如果您使用添加服务引用向导添加对 OData 服务的引用，您将获得我们的 DLL。请注意，如果您使用的是 VS 2012，您将获得对我们的 NuGet 包的引用，然后您可以维护您维护所有其他 NuGet 依赖项的方式。如果您使用的是 VS 2010，您仍应考虑添加对 NuGet 包的引用并使用 NuGet 来更新依赖项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:07:19.613

也许这个视频可以帮助你：http: [//msdn.microsoft.com/en-us/data/gg591296.aspx](http://msdn.microsoft.com/en-us/data/gg591296.aspx)

# windows - 想用win32、wmi模块改变接口的属性

> ID：16082418
> 
> 赞同：1
> 
> 时间：2013-04-18T12:02:33.220
> 
> 标签：windows, python-2.7, tap, tunnel, tun

我在用`wmi module`

```
x = wmi.WMI().Win32_NetworkAdapterConfiguration(index=9)
// this index for my tap drive 
```

并更改界面内的属性，它不会在界面中更改

```
nic = x[0]
nic.properties['NetEnabled'] = True 
//it still gives False in the interface when i see it again 
```

即使我无法分配 IP 地址、网关和子网掩码

* * *

我试过了

```
c = t.ExecQuery("select * from Win32_TapDrive where NetConnectionID='Local Area Connection'")
//It gives unknown object i can't deal with it 
```

请提供任何帮助。
我正在使用windows环境。

# php - 调用未定义的函数 session_register()

> ID：16082420
> 
> 赞同：9
> 
> 时间：2013-04-18T12:02:35.643
> 
> 标签：php, mysql, login

请大家帮帮我！！

为什么我无法登录，这是错误： ***致命错误：在第 27 行调用 C:\xampp\htdocs**\proses1.php 中的未定义函数 session_register()***

这个proses1.php代码：

```
<?php
include "connect.php";
   $username= $_POST['username'];
   $password= $_POST['password'];

   if (!$_POST['username'] | !$_POST['password'])
 {
    print "<script>alert('isi username dan password anda!');
    javascript:history.go(-1);</script>";
    exit;
 }
 $username = stripslashes($username);
 $password = stripslashes($password);
 $username = mysql_real_escape_string($username);
 $password = mysql_real_escape_string($password);
 $sql="SELECT login.username, login.password, login.status FROM login WHERE        
 login.username='$username' AND login.password='$password'";
 $result=mysql_query($sql) or die(mysql_error());
 $count=mysql_num_rows($result);
 // If result matched $myusername and $mypassword, table row must be 1 row
 $r=mysql_fetch_array($result);

 session_start();
 session_register("username");
 session_register("password");
 session_register("status");
 //session_register("nojual");
 $_SESSION['username']=$r[username];
 $_SESSION['password']=$r[password];
 $_SESSION['status']=$r[status];
 //$_SESSION['nojual']=$r[nojual];
//$_SESSION['nojual']=$r[nojual];

       if ($_SESSION['status']=='dokter') // ini untuk admin
           {
           header("location:home_dokter.php");
       }else if($_SESSION['status']=='apotik'){
           header("location:uji.php");
       }else if($_SESSION['status']=='bagian persediaan'){
          header("location:obat.php");

      }else{
      print "<script>alert('anda salah login!');
    javascript:history.go(-1);</script>";
    exit;
   }
  ?> 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-04-18T12:04:49.077

PHP 5.4 中不再存在该函数，而是使用

```
$_SESSION['myusername']="something"; 
```

# jquery - 如何使用下拉框按 .class 过滤图像

> ID：16082424
> 
> 赞同：0
> 
> 时间：2013-04-18T12:02:41.623
> 
> 标签：jquery, drop-down-menu

我正在查看另一个问题
[如何使用输入表单和 jquery 按类别过滤图像？](https://stackoverflow.com/questions/6792616/how-to-filter-images-by-category-using-input-form-and-jquery)

它有点像我的问题，我尝试玩一些 jsfiddles 但我没有成功。 [http://jsfiddle.net/3bk22/44/](http://jsfiddle.net/3bk22/44/)

```
<img src="http://placehold.it/123x100/123/1" class='landClass' />

<img src="http://placehold.it/100/fe2/2" class='landClass' />

<img src="http://placehold.it/100x50/aaa/3" class='absClass' />

<img src="http://placehold.it/200x150/42E/4" class='landClass' />
<br/> <br/>
Filter: <br/>
<select>
<option value="abstract" /> Abstract<br />
<option value="landscape" /> Landscape<br />
</select>

$('option[value="landscape"]').click(function(){
$('.landClass').toggle();
 });

$('option[value="abstract"]').click(function(){
    $('.absClass').toggle();
}); 
```

我基本上不知道在给他们上课后是否可以为 850 多张图像创建一个过滤器。我打算使用复选框，但是会有 50 多个类别，我希望尽量减少框所需的区域。

**我想达到什么目的？**
- 所有类别的下拉过滤器。
- 我可以添加无限类别的下拉菜单。
- 加载时默认显示该框为空。
- 隐藏任何不属于当前过滤器的图像。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:10:07.153

您应该调整您的类名或下拉列表以保持一致，然后执行以下操作：

```
$("select").change(function(){
    $("img").hide();
    $("." + $(this).val()).show();
}); 
```

[http://jsfiddle.net/3bk22/45/](http://jsfiddle.net/3bk22/45/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:12:06.860

我会使用数据属性来引用相应的图像：

```
var $img = $('.landClass, .absClass');
$('.filter').change(function() {
    $img.hide().filter('.' + $('option:selected', this).data('class')).show();
}); 
```

HTML：

```
<option value="abstract" data-class="absClass">Abstract</option>
<option value="landscape" data-class="landClass">Landscape</option> 
```

[http://jsfiddle.net/3bk22/47/](http://jsfiddle.net/3bk22/47/)

或者可能更好的主意只是更改图像的类名以匹配 James Montagne 建议的选项值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:06:52.007

尝试

```
$('select').change(function(){
    var value = $(this).val();
    $('img').hide();
    if(value == 'abstract'){
        $('.absClass').show();
    } else if(value == 'landscape'){
         $('.landClass').show();
    }
}) 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/HAhCP/1/)

# image - GWT：循环加载图像

> ID：16082429
> 
> 赞同：0
> 
> 时间：2013-04-18T12:02:57.473
> 
> 标签：image, gwt, reload

我尝试实现一种基于简单 JPEG 文件的视频流。在我的服务器上，外部相机正在循环创建 JPEG。我只想在我的 GWT 应用程序中包含这张图片。

我通过计时器重新加载图片的第一个想法非常简单但不太好：客户端为每个重新加载周期打开一个连接，并且图片闪烁（至少在 Firefox 中）。

我该如何解决这些问题？我正在考虑类似“Web-Sockets”的东西，但我真的不知道该怎么做。我想避免每次重新加载都使用单个连接。我的想法是有一个类似开放连接的东西，它只根据客户的要求提供一张新图片。

交换图片时如何避免闪烁？

欢迎任何想法！

问候，范达伦

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:36:30.973

避免闪烁的解决方案是将两个图像绝对定位在同一位置。计时器将在每一帧中交替加载一个或另一个。为每个图像设置一个`load`处理程序，以便在加载图像时更改 z-index 并重新启动计时器。

向图像 url 添加一个额外的参数，使浏览器每次都要求服务器绕过其缓存。

如果帧之间的时间很短，通常浏览器会在服务器中正确配置[keep-alive](http://en.wikipedia.org/wiki/HTTP_persistent_connection)的情况下重复使用相同的连接 。它通常以 5-15 秒的典型值启用，您可以增加该值，因此如果您的 .jpg 图像以这种周期性更新，您不必担心并寻找更好的解决方案。

我基于这些想法提出了一个 UI 解决方案。但是，如果您使用 websocket/comet 机制为您提供 base64 格式的最后一个 .jpg 文件（只需通过返回的值更改 url），它也会起作用。

GWT 代码：

```
public void onModuleLoad() {

  final Image i1 = new Image();
  i1.setWidth("400px");

  final Image i2 = new Image();
  i2.setWidth("400px");

  AbsolutePanel panel = new AbsolutePanel();
  panel.add(i1, 0, 0);
  panel.add(i2, 0, 0);
  panel.setSize("600px", "400px");

  RootPanel.get().add(panel);

  // You could change this by base64 data if you use comet/websockets
  String url = "my_image_url.jpg?";

  final Timer loadNext = new Timer() {
    boolean b;
    int c;
    public void run() {
      // the counter parameter forces to load the next frame instead of using cache
      if (b  = !b) {
        i1.setUrl(url + c++);
      } else {
        i2.setUrl(url + c++);
      }
    }
  };

  i1.addLoadHandler(new LoadHandler() {
    public void onLoad(LoadEvent event) {
      i1.getElement().getStyle().setZIndex(1);
      i2.getElement().getStyle().setZIndex(0);
      loadNext.schedule(1000);
    }
  });

  i2.addLoadHandler(new LoadHandler() {
    public void onLoad(LoadEvent event) {
      i1.getElement().getStyle().setZIndex(0);
      i2.getElement().getStyle().setZIndex(1);
      loadNext.schedule(1000);
    }
  });

  loadNext.schedule(1000);
 } 
```

如果你想使用[gwtquery](http://code.google.com/p/gwtquery/)，代码显然更小：

```
 // You could change this by base64 data if you use comet/websockets
  final String url = "my_image_url.jpg?";

  final GQuery images = $("<img/><img/>").appendTo(document);
  images.css($$("position: fixed, top: 10px, left: 600px, width: 400px"));

  final Timer timer = new Timer() {
    int c;
    public void run() {
      images.eq(c%2).attr("src", url + c++);
    }
  };

  images.bind("load", new Function(){
    public void f() {
      $(this).css($$("z-index: 1")).siblings("img").css($$("z-index: 0"));
      timer.schedule(1000);
    }
  });

  timer.schedule(1000); 
```

# php - 如何使用 mysql 在表中获取用户 ID 的下线

> ID：16082445
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:03:39.947
> 
> 标签：php, mysql

目前我正在使用 php 和 mysql 来获取特定用户 ID 的下线。有什么办法我可以使用 mysql 来做到这一点。我的代码是......

```
function downlineSearch($mid, $s) 
{
    global $nums; global $str;
    $q = $cn->query("SELECT userid, CONCAT(lastname,' ',firstname,' ',middlename) AS name FROM clientsdata WHERE (recid LIKE '%$s%' OR lastname LIKE '%$s%' OR firstname LIKE '%$s%' OR middlename LIKE '%$s%') AND sponsor = $mid");
    while($r = $q->fetch_array(MYSQL_ASSOC)) 
    {
        $nums += 1;
        $str .= "<tr><td valign='middle'>NRN".$r['userid']."CCN</td><td valign='middle'>".$r['name']."</td></tr>";
        downlineSearch($r['userid'], $s);
    }
}

$str = '';
downlineSearch($mid, 'janet');
echo '<table id="tblSearch" width="100%">';
echo "<tr><td colspan='4' align='center' style='padding-top:10px;'><h3> $nums records found for [ <span style='color:red'>".$_POST['s']."</span> ]</h3></td></tr>";
echo $str;
echo '</table>';` 
```

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:23:18.303

我猜你需要设置$cn的值，大概是这样的：

```
 $cn = new mysqli; 
```

这有帮助吗？

您收到的错误信息是什么？

你知道错误发生在哪一行吗？

你有能力逐行调试和查看变量吗？如果没有，添加几个“echo”语句，在浏览器中查看发生了什么。或者，使用 error_log()，在 PHP 错误日志中显示信息，如果您可以访问它。

（我很抱歉在“答案”中要求澄清，但系统不允许我对其他人的问题添加评论 - 但是。一旦您添加一些澄清，我会将这个“答案”修改为实际答案回答你的问题。）

# boost - 没有 Boost 的 Asio

> ID：16082449
> 
> 赞同：7
> 
> 时间：2013-04-18T12:03:48.563
> 
> 标签：boost, boost-asio

Asio 是否仍然与 Boost 分开开发，或者 Boost.Asio 是唯一仍在更新的版本？

在[Asio 网站上](http://think-async.com/Asio)，他们谈到这两个版本都有好处，而且 Asio 的更新频率比 Boost 高。然而，该网站上最新的开发版本是 1.5.3，于 2011 年 3 月发布，而 2013 年 2 月的最新 Boost 1.53 版本包括 Asio 1.8.3，自 1.5.3 以来有大量更改。

Asio 网站要么在没有通知的情况下被放弃，转而支持仅 Boost 更新，要么它已移动到我尚未找到的某个位置。有谁确切地知道发生了什么？

我问的原因是我试图从我的项目中删除 Boost，而 Boost.Asio 是我目前使用的唯一 Boost 库。Asio 本身是一个只有头文件的库，但 Boost.Asio 引入了其他几个未使用的 Boost 库（System、Regex、Date_Time）。

我愿意切换到另一个轻量级套接字库，但还没有找到一个和 Asio 一样好的（在低依赖性和使用本机平台 iocp/epoll 方法方面）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T15:18:34.330

Asio 是单独开发的，然后*经过增强*并合并到 Boost.Asio 中。但是，您可能无法根据正在使用的功能和编译器从项目中删除 Boost。从 Asio 1.10.0 开始，Asio 尝试使用等效的 C++11 标准库而不是 Boost。

Asio 基本上就是 Boost.Asio：

*   没有 Boost 命名空间和宏命名约定。
*   不依赖于 Boost.System 和 Boost.Thread，因为 Asio 提供了自己的有限功能来代替这两个库。

1.10.0 之前的 Asio 版本可能存在 Boost 依赖项。这些依赖项通常在模板中引入；因此，依赖关系可能仅在应用程序使用特定功能时发生。很容易忽略[Asio 和 Boost.Asio](http://think-async.com/Asio/AsioAndBoostAsio)页面上的细微细节，其中指出：

> Asio 仅是头文件，并且对于**大多数用途**不需要链接到任何 Boost 库。在将 C++11 与最新版本的 gcc、clang 或 MSVC 一起使用时，可以通过定义`ASIO_STANDALONE`编译时间来独立于 Boost 使用 Asio。

通常，以下功能会引入依赖项：

*   计时器依赖于 Boost.DateTime 或 Boost.Chrono。对于 Asio 1.10.0 及更高版本，将使用 C++11 构建`std::chrono`。
*   `read_until()`使用正则表达式的操作依赖于 Boost.Regex。
*   基于[Boost.Coroutine](http://www.boost.org/doc/libs/1_57_0/libs/coroutine/doc/html/index.html)库的[堆栈式协程。](http://think-async.com/Asio/asio-1.10.6/doc/asio/overview/core/spawn.html)

* * *

可能值得考虑使用：

*   [BCP](http://www.boost.org/doc/libs/1_57_0/tools/bcp/doc/html/index.html)提取项目所需的 Boost 库子集。
*   [libuv](https://github.com/joyent/libuv)，一个 C 库，提供异步事件循环和对本地 I/O 事件通知的抽象。 [这个](https://stackoverflow.com/questions/11423426/#13220533)答案比较了两个库。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-05-09T04:43:01.640

我通过电子邮件询问了非 Boost 版本在哪里维护，作者 Christopher Kohlhoff 说他在 github 上维护它

[https://github.com/chriskohlhoff/asio](https://github.com/chriskohlhoff/asio)

今天看它似乎没有 1.8.3 在那里，或者至少它没有被标记，所以可能是他停止维护那个 repo。

# javascript - 在执行上一条语句之前显示 Javascript 警告框

> ID：16082452
> 
> 赞同：5
> 
> 时间：2013-04-18T12:03:51.513
> 
> 标签：javascript, jquery, jquery-mobile

我遇到了一个奇怪的问题，但这并不奇怪，因为我是一个 JavaScript 新手。基本上我正在创建一个简单的高低纸牌游戏。（抽两张牌，最高牌获胜）。无论如何，代码如下。

该程序的基本流程非常简单。我选择 2 个随机数 (1-52)。这些数字映射到相应的卡。（即数字 1 是黑桃 A，数字 37 是梅花 J 等）。无论如何，抽完牌后，程序就是显示相应的牌并确定获胜者。在所有这一切结束时，我会出现一个警报，并告诉平局的获胜者并询问用户是否想再次玩。

我遇到的问题是：即使程序应该已经显示了卡片的图像并将结果输出到文本区域，但警报框会在任何实际发生之前出现，并且从不显示卡片或结果。有任何想法吗？到目前为止，我正在发布所有代码，我们将不胜感激。提前致谢。

```
function drawCards() {
    var oppCard = randNumber();
    var customerCard = randNumber();

    while (oppCard == customerCard) {
        customerCard = randNumber();
    }
    var oppCardName = displayCard(oppCard, "oppImage");
    var customerCardName = displayCard(customerCard, "custImage");

    var result2 = "Your card was: " + customerCardName;
    var result1 = "The opponent's card was: " + oppCardName;

    var result3 = determineWinner(oppCard, customerCard);
    var result4 = result3 + '\n' + result1 + '\n' + result2;
    $("#textareaRes").text(result4);

    playAgain(result3);
}

function determineWinner(oppsCard, customersCard) {
    var oppValue = oppsCard % 13;
    var customerValue = oppsCard % 13;

    var winnerString = "";
    if (oppValue == 0) {
        oppValue = 13;
    }
    if (customerValue == 0) {
        customerValue = 13;
    }
    if (oppValue == customerValue) {
        winnerString = "You Tied.";
    }
    else if (oppValue > customerValue) {
        winnerString = "You Lose.";
    }
    else if (oppValue < customerValue) {
        winnerString = "You Win!!";
    }
    return winnerString;
}

function randNumber() {
    var min = 1;
    var max = 52;
    var random = Math.floor(Math.random() * (max - min + 1)) + min;
    return random;
}

function playAgain(resultString) {
    if (resultString == "You Lose." || resultString == "You Win!!") {
        alert(resultString);
        var conf = confirm("Play Again?");
        if (conf == true) {
            $("#textareaRes").text("");
            document.getElementById("custImage").src="./cardImages/default.png";
            document.getElementById("oppImage").src="./cardImages/default.png";
        }
        else {
            window.location = "#mainMenuPage";
        }
    }
    else {
        alert(resultString);
        alert("Try Again.");
        $("#textareaRes").text("");
        document.getElementById("custImage").src="./cardImages/default.png";
        document.getElementById("oppImage").src="./cardImages/default.png";
    }
} 
```

所以我没有把显卡功能的代码放在这里，只是因为测试它特别长。它只是一个适用于所有 52 个随机数的巨型开关盒。最终产品实际上是从 XML 文件中提取的，但我只是将其用于测试目的。（如果由于某种原因，您需要查看显示卡函数，请告诉我，我可以发布它。）总之，回顾一下，在 drawCards() 函数中进行的最后一次调用是 playAgain 函数。运行此代码后，将显示结果和卡片图像。它只是直接跳转到 playAgain 函数调用的警报。这可能是一个非常愚蠢的问题，但我对此感到有些困惑。因此，你们可以提供的任何帮助将不胜感激。谢谢。

编辑：它实际上在计算机的浏览器中正确执行。但是，问题发生在手机或平板电脑等移动设备上。所以这可能是我在这里做错的事情。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T12:11:11.223

只要您的 Javascript 代码正在运行，浏览器中的更改就不会显示出来。

浏览器是事件驱动的，因此更改 DOM 中的元素不会立即显示更改，而是会触发一个事件来重绘元素。当您的函数完成运行后，浏览器将处理所有未决事件并显示更改。

因此，在构建应用程序时，您必须使用相同的方法，以便浏览器有机会显示更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-12-29T15:10:51.617

对于发现此问题并寻找**解决方案**的任何人，可以在此答案中找到解决方案：[https ://stackoverflow.com/a/13338585/870729](https://stackoverflow.com/a/13338585/870729)

这是一个简单示例的[工作小提琴：](https://jsfiddle.net/cale_b/qpozoe2z/)

```
jQuery(function($) {
  $.when($('#empty-me').html('')).done(function() {
    alert('I did it!');
  });
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T12:22:05.660

“./cardImages/default.png”

我不确定...但是尝试“../cardImages/default.png”...我总是使用2个点来达到更高的水平

# winapi - 如何像工具栏按钮一样处理焦点

> ID：16082453
> 
> 赞同：1
> 
> 时间：2013-04-18T12:03:52.423
> 
> 标签：winapi, focus

我想在 WinAPI 中创建一个控件，它的工作方式类似于某些工具栏按钮：您可以单击该按钮，但无法获得焦点；焦点停留在拥有它的控件上。我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T07:34:25.557

这不是一个完整的答案，因为我最终放弃了这项任务，但我发现实际上，控件必须`SetFocus(Self)`手动进行，而且它们通常在`WM_LMOUSEDOWN`处理程序中执行此操作。

因此，要像工具栏按钮那样处理点击，不这样做就足够了。

问题是，标准控件和通用框架通常会在其内部深处自动执行此操作。使用 MFC 或 VCL 等框架可能会以某种方式破解此问题，`WM_LMOUSEDOWN`BUTTON 控件的标准处理程序似乎执行 SetFocus，并且不能简单地跳过它，因为它也执行单击处理。

# javascript - 从 ajax 响应中提取文本，其中包含

> ID：16082460
> 
> 赞同：0
> 
> 时间：2013-04-18T12:04:03.227
> 
> 标签：javascript, ajax, text, extract

我写了一小段代码来从 rss 页面检索新闻。这是代码：

```
this.loadRecentNews = function loadRecentNews() {
            $.get("http://rss.nytimes.com/services/xml/rss/nyt/GlobalHome.xml", function (data) {
                $(data).find("item").each(function () {
                    var el = $(this);

                    console.log("------------------------");
                    console.log("Title      : " + el.find("title").text());
                    console.log("Link     : " + el.find("link").text());
                    console.log("Description: " + el.find("description").text());
                    console.log("Date: " + el.find("pubDate").text());

                });
            });

        }; 
```

这是输出：

```
Title : Example of title

Link : http://www.example.com

Description : Example of <<bb>>Description</b> containing <> tag..

Date : Example of date 
```

我的问题是我只想提取描述值的文本来构建一个包含此文本的新 Json 对象。

我怎样才能只提取没有 <> 值的文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:08:45.013

看到你正在使用 jQuery，你可以使用它的`.text()`方法。

```
var beforeText = "Example of <b>Description</b>" ;
var afterText = $("<p>").html(beforeText).text() ; 
```

这使用 jQuery 创建一个新的 HTML 元素（从未添加到页面中）并更新其 innerHTML，然后用于`.text()`仅获取文本。

另一个（风险更高的）选项是一个正则表达式，用于替换空字符串之间`<`的任何内容：`>`

```
var afterText = beforeText.replace(/<[^>]*>+/g, "") 
```

# macos - OSX：如何将静态库转换为动态库？

> ID：16082470
> 
> 赞同：14
> 
> 时间：2013-04-18T12:04:43.070
> 
> 标签：macos, dynamic, linker, static-libraries

假设我在运行 Mountain Lion 并安装了 Xcode 4.4 的 Mac 上有一个名为 somelib.a 的第三方库。我想从中获得一个名为 somelib.dylib 的动态库。一个合适的 Linux 命令是：

```
g++ -fpic -shared -Wl,-whole-archive somelib.a -Wl,-no-whole-archive -o somelib.so 
```

其中 -whole-archive 和 -no-whole-archive 被传递给链接器。当我为 Mac 做同样的事情时：

```
g++ -fpic -shared -Wl,-whole-archive somelib.a -Wl,-no-whole-archive -o somelib.dylib 
```

ld 失败并出现错误：

```
ld: unknown option: -whole-archive 
```

OSX 上的 ld 似乎与 GNU ld 不同。我该如何修改上面的命令才能得到想要的结果？

先感谢您！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-26T10:28:52.450

我找到了解决我的问题的方法：

```
g++ -fpic -shared -Wl,-force_load somelib.a -o somelib.dylib 
```

所需的参数是`-force_load`：

*   后面需要一个你想确保加载的库。
*   我的意思是，需要为每个库重复它（与`-noall_load`包装它们的方法不同）。
*   例如，`-Wl,-force_load libYetAnotherFile.a`（`-Wl,`仅需要部分，因为我们不直接将参数传递给链接器）。

**请注意**，*旧答案* ^(（编辑前）)改为使用`-noall_load`，但现在这会导致链接器错误（`-noall_load`已被删除，之前已过时）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-07-05T07:56:07.427

注意：OSX 链接器文档的`ld`链接。

[http://www.unix.com/man-page/osx/1/ld/](http://www.unix.com/man-page/osx/1/ld/)

我知道现在给出答案已经太晚了，但我没有足够的声誉来评论@hanslovsky 的答案。但是，拥有这些选项的文档也对我有很大帮助。它有助于选项的确切作用，以及`ld`链接器还具有的其他选项。所以我只是想与其他发现链接问题的人分享。

## 更新：

在@GhostCat 发表评论后，我决定扩展我的答案。

的文档`-all_load`是：

> *-all_load*
> 
> > ```
> > Loads all members of static archive libraries. 
> > ```

因此它会为您记录的所有静态库加载。如果你想要类似于`--whole-archive`and的东西`--no-whole-archive`，那么你需要使用`-force_load`and `-noall_load`。

*-force_load* "path_to_archive"

> 加载指定静态归档库的所有成员。注意： - all_load 强制加载所有档案的所有成员。
> 此选项允许您以特定存档为目标。

*-noall_load*

> 这是默认设置。此选项已过时。

然后，您可以定义要完全加载的库，`-force_load`然后再使用`-noall_load`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-05-06T05:47:58.457

根据`ld`手册，`-noall_load`是默认值并被忽略。（如果你使用它，你会收到一条错误消息`ld: warning: option -noall_load is obsolete and being ignored`：）

显然`-all_load`，申请一个图书馆的方法如下：

```
-Wl,-force_load,somelib.a 
```

# c# - ASP.NET - 从数据库中检索图像列表并将它们显示在视图中？

> ID：16082471
> 
> 赞同：1
> 
> 时间：2013-04-18T12:04:46.170
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, asp.net-mvc-4

我想从数据库中检索图像列表并将它们显示在视图上。所有图像都以“图像”数据类型格式存储在数据库中。下面是我的控制器、视图模型和视图。我不确定它是否正确，所以请帮忙。我刚刚使用了 Linq2SQL，因为它只是一个示例项目。请更正我的代码，并帮助我如何在视图上显示图像列表。我只是一个初学者，所以如果你能保持解决方案简单明了，那就太好了。

**视图模型：**

```
public class ImageViewModel
{
    public byte[] Image { get; set; }
    public int imageId { get; set; }
    public IEnumerable<int> imageList { get; set; }     
} 
```

**控制器：** * *（更新和解决）* *

```
 public ActionResult Index()
{

    var imagesList = (from q in ctx.Images
                      select new Models.ImageViewModel
                      {
                      imageId = q.id
                      }).ToList();

    IEnumerable<int> imageIds = imagesList.Select(x=>x.imageId);
    Models.Test obj = new Models.Test();
    obj.imageList = imageIds;
    return View(obj);
}

    public ActionResult View(int imageId)
    {
        byte[] imageArray = (from q in ctx.Images
                             where q.id == imageId
                             select q.data.ToArray()).FirstOrDefault(); 
        return File (imageArray,"image/jpg");
    } 
```

**看法：**

```
 @model MvcApplication3.Models.ImageViewModel

   @foreach (var id in Model.imageList)
{ 
    <img src="@Url.Action("View", "Home", new { imageId = id},null)" />
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T12:25:34.193

进行一个新操作，为您的图像获取一个唯一标识符，使用该 ID`byte[]`从您的数据库中获取一个，然后将其直接写入响应流，如下所示

```
Response.ContentType = "content type of your image";
//filecontents is the byte[]
Response.BinaryWrite(filecontents); 
```

然后，每当您需要显示数据库中的图像时，您都可以像这样设置源

```
<img src="/Controller/Action/ImageId"/> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T13:58:41.673

布里顿也推荐了这一点，但我会重申。

你应该有两个动作/视图来实现你想要的。一个检索单个图像，另一个是使用前面提到的操作检索单个图像的所有图像的列表。

这是我的意思的一个非常粗略的例子。我还没有对此进行测试以确保它可以编译，但它应该让您大致了解如何执行此操作。

```
class ImageLibrary
}
    public ActionResult List()
    {
        //I'm going to assume here you have some sort of service or repository for obtaining your images at this point.
        //This doesn't retrieve the actual image data, just the metadata. It's less of a hit on the DB this way
        var imagesList = imageService.ListAllImages()
        IEnumerable<int> imageIds = imagesList.Select(x=>x.ImageId)
        return View("List", imageIds)
    }

    public ActionResult View(int imageId)
    {
        var image = imageService.GetImage(imageId);

        var contentDisposition = new System.Net.Mime.ContentDisposition() { FileName = image.Name, Inline = true };
        Response.AppendHeader("Content-Disposition", contentDisposition.ToString());
        return File(image.Data, image.ContentType); //including content type since I'm assuming the image could be a jpg, gif, png, etc./
    }

} 
```

并在`ImageLibrary/List`视图中。

```
@foreach(var id in Model)
{
    <img src="@Url.Action("View", "ImageLibrary", new {imageId = id})">
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:13:11.770

我不确定您是否将数据作为 base64 字符串获取，如果是这样，您可以尝试：

```
<img src="data:image/png;base64,@(item.bitimage)" alt="test.png" /> 
```

失败的尝试：

```
<img src="data:image/png;base64,@ToBase64String(item.bitimage)" alt="test.png" /> 
```

[http://www.techerator.com/2011/12/how-to-embed-images-directly-into-your-html/](http://www.techerator.com/2011/12/how-to-embed-images-directly-into-your-html/)

# plsql - 动态 SQL 和游标相关问题

> ID：16082476
> 
> 赞同：0
> 
> 时间：2013-04-18T12:04:53.810
> 
> 标签：plsql, oracle11g

我已经声明游标并在过程主体中使用，然后我有动态 sql 语句，它可以动态创建一个表。之后我需要访问我声明的同一个游标。

当我尝试在执行动态 sql 语句之前打开游标时，它工作正常。

当我在执行动态 sql 语句后尝试打开游标时，它没有打开和游标。

请帮我。

谢谢你。

```
 create or replace procedure(columns varchar2)
   is
   column_names varchar2(100);
   sql_query varchar2(200);
   begin
       select pk_cols into column_names
       from rules where rule_column=columns;

       sql_query:='create global temporary table ('||column_names||')';
       execute immediate sql_query;
   end; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:19:26.020

创建表是 DDL，它在 Oracle 中会导致隐式提交，从而结束您的事务。

要解决此问题，您可以在自治事务中创建表：

```
 -- open cursor

  declare
    pragma autonomous_transaction;
  begin
    execute immediate 'create table ...';
  end;

  -- do more with your cursor 
```

有关自主事务的更多信息，请参阅Tim Hall 优秀网站上的[此概述。](http://www.oracle-base.com/articles/misc/autonomous-transactions.php)

# iphone - 努力使用 Interface Builder 来设置我的 App-Layouts

> ID：16082479
> 
> 赞同：0
> 
> 时间：2013-04-18T12:04:59.850
> 
> 标签：iphone, ios, objective-c, interface-builder, uitextview

主要问题是在切换 3.5" 和 4" 之间有 2 张图片，它们准确地显示了我的问题。

![图1](https://i.stack.imgur.com/sL3rr.png)

* * *

![图2](https://i.stack.imgur.com/IUpI8.png)

您在第二张图片中看到 UIImageView 缩小了一点。这不是我想要的。更好的外观是 textView 是否会按比例缩小，并且内容可能会变得可滚动。

```
How can i solve this? Thanks in advance. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:35:17.073

我强烈建议你看看这个链接。 [教程解释自动布局](http://www.raywenderlich.com/20881/beginning-auto-layout-part-1-of-2)。

从我可以从图像中了解到，您应该修复图像视图的高度并编辑文本视图的高度，使其具有小于当前高度的值，以便您可以单击高度约束单击齿轮图片并编辑它

# mysql - character_set_connection 的目的是什么？

> ID：16082480
> 
> 赞同：19
> 
> 时间：2013-04-18T12:05:02.710
> 
> 标签：mysql, character-encoding

只需阅读 Stefan Gehrig 对“SET CHARACTER SET utf8”是否有必要的出色回答[？](https://stackoverflow.com/questions/1566602/is-set-character-set-utf8-necessary)，在解释解释和运行查询 wrt 字符集和排序规则的阶段时，它比 MySQL 的文档更进一步，但我仍然看不到 character_set_connection 的目的，或者更具体地说，将语句从 character_set_client 转码为 character_set_connection。

为什么不直接使用 character_set_client 进行查询，并在与列值进行比较时直接从 character_set_client 转码为列的字符集？这个中间阶段的目的是什么？该手册给出了比较文字刺痛的示例，但是为什么您首先要这样做，更不用说在 character_set_connection 中与 character_set_client 对立了？除非我对此的理解（例如“select 'somestr' = 'somestr' from x”）是错误的。

谢谢你。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-11-14T10:17:53.950

阅读答案和文档后，我只能想到`character_set_connection`（和`_collation`）的一个用例：

> 选择“字符串A”<“字符串B”

`character_set_client`仅对传输到服务器很重要。`character_set_connection`（以及不独立于字符集的排序规则）对语句的*解释很重要。*“StringA”是否小于“StringB”取决于文字的字符集和排序规则。开发人员可能会选择不同于`character_set_client`.

在实践中，`character_set_connection`大部分时间都无关紧要，因为将文字与列进行比较，在这种情况下使用列的字符集和排序规则。

如我错了请纠正我！

请参阅[https://dev.mysql.com/doc/refman/5.0/en/charset-connection.html](https://dev.mysql.com/doc/refman/5.0/en/charset-connection.html)：

> 服务器收到语句后应该将其翻译成什么字符集？为此，服务器使用 character_set_connection 和 collat​​ion_connection 系统变量。它将客户端发送的语句从 character_set_client 转换为 character_set_connection（具有引入符的字符串文字除外，例如 _latin1 或 _utf8）。collat​​ion_connection 对于比较文字字符串很重要。对于字符串与列值的比较， collat​​ion_connection 无关紧要，因为列有自己的排序规则，它具有更高的排序规则优先级。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-24T05:00:17.557

两者的不同之处在于`character_set_client`假设是从客户端发送语句的字符集，因此服务器用于解释语句的字符集，而`character_set_connection`服务器将语句转换为用于处理的字符集。

`character_set_connection`如前所述，用于比较文字字符串。但是，这并不一定意味着等式的两边都必须是文字字符串。例如：

```
WHERE column_name = 'literal_string'
     (charset col)  (charset connection) 
```

如果列和连接的字符集不同，则比较是非法的，会导致错误。

然后将结果（和响应消息）编码`character_set_results`为发送回客户端。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-30T09:45:09.803

这是因为 MySQL 允许每个字符串文字都有自己的字符集。也就是说，语句中字符串文字的字符集并不总是与语句相同。

请参阅手册中的此页面：http: [//dev.mysql.com/doc/refman/5.5/en/charset-literal.html](http://dev.mysql.com/doc/refman/5.5/en/charset-literal.html)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-06T11:47:41.520

```
> <?php

// ... (create a connection to mysql) ...

mysql_query("SET character_set_results = 'utf8', character_set_client = 'utf8', character_set_connection = 'utf8', character_set_database = 'utf8', character_set_server = 'utf8'", $conn);

$re = mysql_query('SHOW VARIABLES LIKE "%character_set%";')or die(mysql_error());
while ($r = mysql_fetch_assoc($re)) 
{
    var_dump ($r); echo "<br />";
} 

exit;

?> 
```

所有重要的变量现在都是 utf-8，我们可以安全地使用带有 mysql_escape_string($var) 的 INSERT 或 SELECT，而无需任何编码函数。

# codeigniter - 根据变量 codeigniter 更改标头值

> ID：16082482
> 
> 赞同：0
> 
> 时间：2013-04-18T12:05:05.533
> 
> 标签：codeigniter, codeigniter-2

我的标题中有以下内容：

```
<div id="wrapper" class="homepage itemlist com_k2 category">
  <div id="rt-header">
    <div class="rt-container">
      <div class="rt-grid-3 rt-alpha">
        <div class="rt-block"><a href="#" id="rt-logo"></a></div>
      </div>
      <div class="rt-grid-9 rt-omega">
        <div class="rt-fusionmenu">
          <div class="nopill">
            <div class="rt-menubar">
              <ul class="menutop level1 ">
                <li class="parent  root f-main-parent firstItem f-mainparent-item"> <a class="daddy item bullet" href="www.domain.com"> <span> الرئيسية </span> </a> </li>

                <li class="active root"> <a class="orphan item bullet" href="load_kitchen_list"> <span> المطبخ </span> </a> </li>
                <li class="root"> <a class="orphan item bullet" href=""> <span style="font-size:medium;"> الملف الشخصي </span> </a> </li>
                <li class="root"> <a class="orphan item bullet" href="main/contactus"> <span> للإتصال بنا</span> </a> </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="clear"></div>
    </div>
  </div> 
```

现在如果你调查

*   元素，您会发现其中一个中有一个活动标志。这确保当前看到的页面在导航栏中突出显示。我想知道如何根据加载的视图进行更改？这就是我加载视图的方式：

    ```
    $this->load->view('layout/header');
    $this->load->view('home');
    $this->load->view('layout/footer'); 
    ```

    因此，在这种情况下，主导航选项卡应该处于活动状态。

    问候，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T13:14:02.660

我最近完成了类似的事情。可能不是最好的方法，但它对我有用。

在您的控制器中，在您的视图之前添加它

```
$data['contact'] = 'active'; 
```

然后将 $data 变量从控制器传递到视图

```
$this->load->view('header', $data); 
```

并在您的视图中将其添加到列表项

```
<li class="contact <?php if(isset($contact)) {echo $contact; }"> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T13:10:14.967

从控制器：

为您的菜单设置名称并将加载的菜单或页面名称放入变量中，如下所示：

```
$data['active'] = 'menu1';
$this->load->view('layout/header',$data);
$this->load->view('home');
$this->load->view('layout/footer'); 
```

在视图中：

```
<div id="wrapper" class="homepage itemlist com_k2 category">
  <div id="rt-header">
    <div class="rt-container">
      <div class="rt-grid-3 rt-alpha">
        <div class="rt-block"><a href="#" id="rt-logo"></a></div>
      </div>
      <div class="rt-grid-9 rt-omega">
        <div class="rt-fusionmenu">
          <div class="nopill">
            <div class="rt-menubar">
              <ul class="menutop level1 ">
                <li class="<?php if(isset($active) && $active == 'menu1') echo 'active';  ?> parent  root f-main-parent firstItem f-mainparent-item"> <a class="daddy item bullet" href="www.domain.com"> <span> الرئيسية </span> </a> </li>

                <li class="<?php if(isset($active) && $active == 'menu2') echo 'active';  ?> root"> <a class="orphan item bullet" href="load_kitchen_list"> <span> المطبخ </span> </a> </li>
                <li class="<?php if(isset($active) && $active == 'menu3') echo 'active';  ?> root"> <a class="orphan item bullet" href=""> <span style="font-size:medium;"> الملف الشخصي </span> </a> </li>
                <li class="<?php if(isset($active) && $active == 'menu4') echo 'active';  ?> root"> <a class="orphan item bullet" href="main/contactus"> <span> للإتصال بنا</span> </a> </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="clear"></div>
    </div>
  </div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T13:05:40.100

给每个菜单项一个不同的类或 id，然后通过 jQuery 或 js 执行

```
<li class="kitchen root"> <a class="orphan item bullet" href="load_kitchen_list"> <span> المطبخ </span> </a> </li>
<li class="anotherclass root"> <a class="orphan item bullet" href=""> <span style="font-size:medium;"> الملف الشخصي </span> </a> </li>
<li class="contact root"> <a class="orphan item bullet" href="main/contactus"> <span> للإتصال بنا</span> </a> </li> 
```

然后例如在联系页面中，您只需通过 jQuery 执行此操作：

```
$(document).ready(function(){
    $(".contact").addClass("active");
}); 
```

# ruby-on-rails - 如何使用 latsrate gem 按平均评分对记录进行排序？

> ID：16082485
> 
> 赞同：1
> 
> 时间：2013-04-18T12:05:14.403
> 
> 标签：ruby-on-rails, rubygems

我正在使用letsrate gem 进行评级[https://github.com/muratguzel/letsrate](https://github.com/muratguzel/letsrate)
如何按平均评级对我的记录进行排序？
还是我必须从头开始写我自己的评分？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:50:03.867

可以使用 Letsrate gem 按评分排序，但由于一个错误，这有点困难。举个例子，一个带有`User`s的应用程序`Car`对速度、引擎和价格进行评分。

```
class Car < ActiveRecord::Base
  attr_accessible :name
  letsrate_rateable "speed", "engine", "price"
end 
```

现在，您可以创建一些用户、汽车和评级。

```
user = User.create!(email: 'user@example.com', password: 'password', password_confirmation: 'password')
other = User.create!(email: 'other@example.com', password: 'password', password_confirmation: 'password')

camry = Car.create!(name: 'Camry')
mustang = Car.create!(name: 'Mustang')
ferrari = Car.create!(name: 'Ferrari')

camry.rate 2, user.id, 'speed'
camry.rate 3, user.id, 'engine'
camry.rate 5, user.id, 'price'
camry.rate 4, user.id
mustang.rate 3, user.id, 'speed'
mustang.rate 4, user.id, 'engine'
mustang.rate 3, user.id, 'price'
mustang.rate 3, user.id
ferrari.rate 5, user.id, 'speed'
ferrari.rate 5, user.id, 'engine'
ferrari.rate 1, user.id, 'price'
ferrari.rate 5, user.id

camry.rate 3, other.id, 'speed'
camry.rate 2, other.id, 'engine'
camry.rate 4, other.id, 'price'
camry.rate 5, other.id
mustang.rate 4, other.id, 'speed'
mustang.rate 3, other.id, 'engine'
mustang.rate 3, other.id, 'price'
mustang.rate 4, other.id
ferrari.rate 5, other.id, 'speed'
ferrari.rate 4, other.id, 'engine'
ferrari.rate 1, other.id, 'price'
ferrari.rate 4, other.id 
```

`rate_average_without_dimension`通过加入关联，可以很容易地根据总体评分进行排序，没有维度：

```
Car.joins(:rate_average_without_dimension).order('rating_caches.avg DESC') 
```

您可以将其范围限定为

```
scope :sorted_by_rating_without_dimension, joins(:rate_average_without_dimension).order('rating_caches.avg DESC')
scope :top_ten_without_dimension, sorted_by_rating_without_dimension.limit(10) 
```

现在您可以包含一个“前 10 名”列表：

```
Car.top_ten_without_dimension 
```

但是，如果您想要“十大引擎”或“最佳价值”列表怎么办？它应该像这样简单

```
Car.joins(:engine_average).order('rating_caches.avg DESC')
Car.joins(:price_average).order('rating_caches.avg DESC') 
```

但是，你会得到一个错误

```
ActiveRecord::ConfigurationError: Association named 'engine_average' was not found; perhaps you misspelled it 
```

这是因为 Letsrate 使用字符串而不是符号创建关联。作为一种解决方法，您可以将`letsrate_rateable`调用更改为以下内容：

```
DIMENSIONS = ["speed", "engine", "price"]
letsrate_rateable *DIMENSIONS

DIMENSIONS.each do |dimension|
  has_one :"#{dimension}_average", :as => :cacheable, :class_name => "RatingCache", :dependent => :destroy, :conditions => {:dimension => dimension.to_s}
end 
```

（注意插值`:`前面的）。`"#{dimension}_average"`

现在，您可以使用

```
Car.joins(:engine_average).order('rating_caches.avg DESC') 
```

或者作为范围，

```
scope :sorted_by_engine_rating, joins(:engine_average).order('rating_caches.avg DESC')
scope :top_ten_engines, sorted_by_engine_rating.limit(10) 
```

我已[提交](https://github.com/muratguzel/letsrate/pull/28)修复此错误的拉取请求。随意发表评论或给它+1以使其被接受。

# vb.net - 无法将gridview行号传递给javascript函数

> ID：16082490
> 
> 赞同：1
> 
> 时间：2013-04-18T12:05:27.837
> 
> 标签：vb.net, gridview, webforms

单击复选框时，我试图将gridview的行号传递给javascript函数。这是gridview中的复选框代码

```
<asp:CheckBox ID="chkGroup" runat="server" CommandArgument='<%#Eval("TempFaultID")%>'
OnClick="highlightDescription('+<%# CType(Container,GridViewRow).RowIndex %>+',this.checked);">
</asp:CheckBox> 
```

这是此复选框触发的javascript函数

```
 <script language="javascript" type="text/javascript">
        function highlightDescription(index, state) {
            alert(index + state);
        }    
  </script> 
```

这是输出

![在此处输入图像描述](https://i.stack.imgur.com/Ge2pv.png)

问题是我无法获取行索引。任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T12:45:09.670

在整个 OnClick 函数上使用 <%# 标记：

```
<asp:CheckBox ID="chkGroup" runat="server"  
OnClick=<%# String.Format("highlightDescription('{0}',this.checked);", CType(Container,GridViewRow).RowIndex) %> >
</asp:CheckBox> 
```

# paypal - 显示一个空白页面并说您应该先登录才能使用沙箱

> ID：16082493
> 
> 赞同：2
> 
> 时间：2013-04-18T12:05:32.643
> 
> 标签：paypal, paypal-sandbox, nopcommerce

嗨，我正在尝试将 paypal 标准集成到 nop commerce 2.4 中。在管理面板中设置所需的东西后，当我不使用沙箱时，购物车显示正常。但是，当我启用“使用沙箱”并在继续为贝宝付款后，网站重定向到贝宝以显示贝宝购物车，它显示一个空白页面并说您应该先登录才能使用沙箱，这样的消息。但是当我将网站置于实时模式时，重定向会像往常一样加载贝宝结帐页面。我不明白有什么问题。

过去几天我在互联网上搜索，我陷入了困境..请帮帮我。

因为我不是代表 10 我无法上传图片： [请查看我的购物车出现的屏幕链接](http://www.luminowebdesign.com/uploads/PayPal-Sandbox-before-login__st.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:51:25.687

当您将购物车设置为沙盒时，这用于测试。您需要在[PayPal 的开发者网站](http://www.developer.paypal.com)上使用 PayPal 设置开发者帐户。设置好开发者帐户后，您需要设置一个测试沙盒卖家和买家帐户。然后，如果您要使用沙箱进行测试，您将使用您的沙箱账户凭据配置您的购物车。然后在一个单独的选项卡中，如果您尚未登录，请登录到[PayPal 的开发人员帐户。然后在另一个选项卡中，您可以使用沙箱检查并测试您的结帐。](http://www.developer.paypal.com)

# android - Android：如何在后退按钮上保持会话？

> ID：16082494
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:05:39.673
> 
> 标签：android

我的应用程序包含两个活动类。从第一个活动用户可以登录，从第二个活动用户可以查看他们的项目详细信息。我也在使用注销按钮维护会话。在我的应用程序中，如果用户从第二个活动单击后退按钮，那么它会转到应用程序部分（表示主菜单），一段时间后用户单击我的应用程序图标它会转到第一个活动而不是第二个活动但用户没有注销。
`I want user should go to second activity not first activity if user already login`. 我试过但没有工作，我还在努力。
我该如何做上述事情请任何人建议我答案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:27:11.447

您应该将当前用户的状态保存到[SharedPreferences](http://developer.android.com/reference/android/content/SharedPreferences.html)。

在logIn Activity的**onCreate方法中，在调用****setContentView()**之前，可以检查用户是否已登录。如果是*这样*，则打开新的 Activity 希望**startActivity()**并在当前 Activity 上调用**finish() 。**如果不是继续正常的**setContentView()**调用。

这样，如果她在 SharedPreferences 中的状态设置为已登录，则 logIn 活动将不可见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:37:05.813

您不必显示第一个活动。但实际上总是有主要活动。这应该决定是直接启动登录活动，还是直接显示用户内容。一旦您开始登录或内容活动，您就可以从主要活动中使用完成（），因此当用户推回（）时，他将不会再看到主要活动。

```
MainActivity extends Activity
{
 public void onCreate()
 {
   if isLogged()
     startActivity(new Intent(ContentActivity ...));
   else
     startActivity(new Intent(LoginActivity...));
   finish()
}

LoginActivity extends Activity
{
  ...
  public void onLoginSuccess(String username)
  {
     // called from dialog OK button and login process success
     startActivity(new Intent(ContentActivity ...));
     finish();
  }
} 
```

# ios - 为非标准语言环境本地化应用程序

> ID：16082495
> 
> 赞同：0
> 
> 时间：2013-04-18T12:05:40.547
> 
> 标签：ios, localization, internationalization, locale, icu

我正在编写一个应用程序，它应该支持一种不在设备上可用（40？）语言列表中的语言，但区域格式是。我想本地化天的名称以及“昨天......”。问题是，那些日子（星期一，...）是使用任何设备获取的`NSLocale`，因此可以在任何设备上使用，但是像“昨天”这样的词必须本地化为 40 种左右的语言。尽管 XCode 允许我对想要的区域进行本地化，但该设备使用标准语言，在我的例子中是丹麦语。

结果是（就像在通话应用程序中一样）“昨天”以英语显示（因为我无法本地化特定区域，比如 kamba-Kenya），但日期名称被翻译得很好。除了硬编码，还有什么办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T06:18:37.207

我怀疑你必须为 iOS 支持的语言环境硬编码这些数据。完全避免对任何语言环境进行硬编码需要付出一些额外的努力。

[iOS 大量使用来自CLDR](http://cldr.unicode.org)的区域敏感数据，并且支持您的区域设置，您不必本地化这些字符串，因为这些*相对日期名称*的翻译（这是 CLDR 术语中的类别，涵盖诸如“今天”、“昨天”之类的词, 和“明天”)[计划](http://cldr.unicode.org/translation/date-time-names#TOC-Relative-Date-Names)成为语言环境数据的一部分。一个显示德语与英语数据对比的[示例：](http://www.unicode.org/reports/tr35/tr35-dates.html#Calendar_Fields)

```
<fields>
   ...
   <field type='day'>
    <displayName>Day</displayName>
    <relative type='-1'>Yesterday</relative>
    <relative type='0'>Today</relative>
    <relative type='1'>Tomorrow</relative>
   </field>
   ...
  </fields>
  <fields>
   ...
   <field type='day'>
    <displayName>Tag</displayName>
    <relative type='-2'>Vorgestern</relative>
    <relative type='-1'>Gestern</relative>
    <relative type='0'>Heute</relative>
    <relative type='1'>Morgen</relative>
    <relative type='2'>Übermorgen</relative>
   </field>
   ...
  </fields> 
```

另外，我发现它`NSDateFormatter`有两个称为的属性[`setDoesRelativeDateFormatting`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDateFormatter/setDoesRelativeDateFormatting)，[`doesRelativeDateFormatting`](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSDateFormatter_Class/Reference/Reference.html#//apple_ref/occ/instm/NSDateFormatter/doesRelativeDateFormatting)它们很可能为您提供了那些受支持的语言环境所需的东西。我不是 iOS 开发人员，所以我不能肯定地说。

虽然 CLDR 中提供了[数据`ka-KE`](http://unicode.org/cldr/trac/browser/trunk/common/main/kam.xml#L550)，但由于 iOS 尚不支持此语言环境，因此您必须经过一些步骤才能使其工作；例如，为 iOS 构建[ICU](http://site.icu-project.org/)，这在[此答案](https://stackoverflow.com/questions/8126233/how-to-build-icu-so-i-can-use-it-in-an-iphone-app)中有详细介绍，或者使用[此处](https://github.com/zhm/icu-ios)提供的静态构建。

# android - android:settingsActivity - 如何获得非标准行为

> ID：16082496
> 
> 赞同：0
> 
> 时间：2013-04-18T12:05:40.527
> 
> 标签：android, wallpaper

我做了一个动态壁纸，里面有很多复杂的设置。查看网络上的各种示例，似乎在壁纸中设置首选项的标准方法是拥有一些像这样的 xml：

```
<wallpaper xmlns:android="http://schemas.android.com/apk/res/android"
    android:thumbnail="@drawable/my_icon"
    android:description="@string/wallpaper_description" 
    android:settingsActivity="com.mycompany.mywallpaper.MyWallpaperSettings"
/> 
```

`MyWallpaperSettings`像这样定义的类在哪里：

```
public class MyWallpaperSettings extends PreferenceActivity implements SharedPreferences.OnSharedPreferenceChangeListener 
```

和...

```
@Override
protected void onCreate(Bundle blah) 
{
    super.onCreate(blah);
    getPreferenceManager().setSharedPreferencesName(MyWallPaper.SHARED_PREFS_NAME);
    addPreferencesFromResource(R.xml.my_settings);
    getPreferenceManager().getSharedPreferences().registerOnSharedPreferenceChangeListener(this);
} 
```

这一切都像宣传的那样有效，但看起来相当粗糙。我注意到一些壁纸设置的外观和感觉要复杂得多，或者看起来一点也不像标准设置屏幕，有些会弹出一个对话框，上面的按钮是网站链接。我想知道如何实现这一目标。是否所有关于在 my_settings.xml 中拥有更高级的 xml 或者 android:settingsActivity=.. 指向不是 PreferenceActivity 的东西，而只是一个正常的活动？或者也许 oncreate 中的代码需要看起来不同 - 我只是不确定我应该在哪里偏离示例。

查看 developer.android.com 它说“这是一个向用户显示偏好层次结构的活动的基类。” - 这听起来像是我只能做一些我能做的事情......这就是为什么我在试图突破 PreferenceActivity 内可以做的事情的限制和`android:settingsActivity=`指出根本不是的事情之间左右为难一个 PreferenceActivity （如果允许的话）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:37:50.487

根据[这个](http://developer.android.com/reference/android/app/WallpaperInfo.html#getSettingsActivity%28%29)你不需要有一个 PreferenceActivity，任何活动都可以。

PreferenceActivity 是一种设置屏幕的简单方法，但如果您不想使用，可以创建自己的。

# windows - 使用智能卡读卡器与 RDP 和切换用户的应用程序

> ID：16082503
> 
> 赞同：0
> 
> 时间：2013-04-18T12:05:55.000
> 
> 标签：windows, smartcard, rdp

一个 Windows 应用程序可与智能卡读卡器配合使用。它有这样的循环：

```
do{
lErr = SCardListReaders( hContext, ... );
if ( lErr != SCARD_S_SUCCESS )
    return 1;
//Show readers
}while(!stop) 
```

即它获取当前的读者列表，而不是显示它。问题是这不适用于`RDP`连接。假设我们有计算机 A (COMP_A) 和智能卡读卡器 A (READER_A)，计算机 B (COMP_B) 和读卡器 B (READER_B)。该应用程序在 COMP_A 上启动，并在阅读器列表中显示 READER_A。然后我们通过 COMP_B 连接到 COMP_A`RDP.`正确的结果必须是列表中有 READER_B。但是应用程序“崩溃”了，因为`SCardListReaders`返回`SCARD_E_SERVICE_STOPPED.` Some goggling 给出了我们需要重新建立上下文的答案。所以新版本的循环：

```
do{
lErr = SCardListReaders( hContext, ... );
if ( lErr == SCARD_E_SERVICE_STOPPED )
{
    SCardReleaseContext( hContext );
    //Sleep(10000)
    SCardEstablishContext( ..., &hContext );
    lErr = SCardListReaders( hContext, ... );
}
if ( lErr != SCARD_S_SUCCESS )
    return 1;
//Show readers
}while(!stop) 
```

它不起作用，`SCardListReaders`在列表中返回 READER_A。我想是因为`SCardEstablishContext`在最终设置 RDP 连接之前新的结束。至少如果 Sleep 未注释它可以正常工作。与用户切换的情况类似，即当用户选择“切换用户”时`SCardListReaders`返回。`SCARD_E_SERVICE_STOPPED`

问题是如何制作正确的代码？如何判断这是RDP连接还是用户切换？如何重新建立`scard context?`

实际上我做了一些改变，这些改变使用`WTSQuerySessionInformation`了带`WTSClientProtocolType`参数的函数。我等什么时候`WTSClientProtocolType = 2`再打电话`SCardEstablishContext`。但我不确定这是否正确，对于切换用户也不正确。

# c# - 我可以从我的 UserControl 类中获取对绑定在 XAML 中的对象的引用吗？

> ID：16082509
> 
> 赞同：0
> 
> 时间：2013-04-18T12:06:09.090
> 
> 标签：c#, xaml, data-binding

我有一个 XAML 与一个从 UserControl 类继承的 cs 类配对。我想在此类中访问 XAML 中被绑定的对象（绑定源），并在触发事件时根据对象的某些属性在 UI 中进行一些更改。有没有办法管理这个？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:09:25.827

我想你正在寻找`DataContext`. 从你`UserControl`的 cs 课：

```
var myObject = (MyType)this.DataContext;
myObject.PropertyChanged += myHandler; 
```

请注意，`DataContext`当您在构造函数中时，不会设置。您应该能够在`Loaded`活动中或之后获得它。

# android - Android：在我看来使用 onTouch 和 OnLongClick

> ID：16082511
> 
> 赞同：0
> 
> 时间：2013-04-18T12:06:13.953
> 
> 标签：android, class, onclick

我有个问题。在我的 View an element 中使用 onLongClick 是不可能的。我创建了一个特定的类，其中必须有两个事件处理 onTouch 和 onLongClick。

```
public class myClass extends SurfaceView implements SurfaceHilder.Callback {
...
//I define my thread and constructor
...
public boolean onTouch(MotionEvent ev) {
...
// here work in touch events
...
return true;
} 
```

现在，在我的课堂上声明 onLongClick 对我来说是正确的。还希望他知道已定义事件的坐标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:35:57.510

不确定这是否是您要查找的内容，但对于 onlongpress，请使用：

```
 buttonname.setOnLongClickListener(new View.OnLongClickListener() {

        public boolean onLongClick(View v) {

            //whatever method you want to call

            return true;
        }
    }); 
```

# sql-server - SQL Azure 和 Azure 表存储之间的事务

> ID：16082512
> 
> 赞同：2
> 
> 时间：2013-04-18T12:06:14.863
> 
> 标签：sql-server, azure, transactions, azure-sql-database, azure-table-storage

在我目前的项目中，我们正在开发一个分布式云应用程序，它将存储实体的状态和相关事件。当从队列中接收到消息时，我们会更新 SQL Azure 中实体的状态，并将与该更新关联的事件保存在表存储中。

它看起来像这样：

*   启动工作单元
    *   在 SQL Azure 中更新实体
    *   将事件保存到表存储
    *   提交事务
*   结束工作单元

我们在这里遇到的问题是我们无法在一个事务中提交 SQL Azure 和表存储中的更改。因此，当 SQL Azure 中实体保存失败时，我们希望回滚表存储中的事件保存。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:52:03.490

如果我了解您的目标，您将尝试涵盖以下两种情况：

*   如果数据库插入失败，回滚 Azure 表
*   如果 Azure 表插入失败，回滚 SQL Azure

假设您在同一个线程中执行两个请求，您是否尝试过这样的方法（伪代码）？请注意，我正在使用数据库引擎的事务功能；这与 MSDTC 不同，因为我只为单个连接执行此操作 - 所以这是受支持的。

```
dbConnection.BeginTransaction;

try { 
     // add record in database - it is in a transaction so it can be rolled back
     insert_into_sqlazure;
     }
catch
{ 
    // automatic rollack - just exist with error
    exit_with_error;
}

try
{
     insert_into_azure_table;
     dbConnection.CommitTransaction;
}
catch
{
    dbConnection.Rollback;
    exit_with_error;
} 
```

# php - 将文本文件中的行添加到php中的文本框

> ID：16082515
> 
> 赞同：0
> 
> 时间：2013-04-18T12:06:25.393
> 
> 标签：php, html

我想将特定行中的特定文本添加到我的 html 代码中的文本框中。

我通过使用以下方法从文本文件（这是一个 BASH 脚本）中获取该行：

```
<?php 
    $myFile = "C:\dat300backups\script.txt";
        $lines = file($myFile);//file in to an array
        echo $lines[13];
?> 
```

然后我想要我从中得到的文本：

```
echo $lines[13]; 
```

插入到 texbox 中：

```
IP Subnet: <input type="text" name="ipsubnet" value="I want the line here"><br> 
```

这是整个代码：

```
 <html>
    <head>
    <title>Rate Limiter</title>
    </head>

    <body>

    <?php 

    $myFile = "C:\dat300backups\script.txt";
    $lines = file($myFile);//file in to an array
    echo $lines[13];
    echo("<br>");
    echo $lines[14];
    echo("<br>");
    echo $lines[15];
    echo("<br>");   
    echo $lines[16];
    echo("<br>");
    echo $lines[17];
    echo("<br>");
    echo $lines[18];
    echo("<br>");
    echo $lines[19];
    echo("<br>");
    echo $lines[20];
    echo("<br>");
    echo $lines[21];
    echo("<br>");
    echo("<br>");

    ?>

    <form>
    IP Subnet: <input type="text" name="ipsubnet" value=""><br>
    IP From: <input type="text" name="ipfrom"><br>
    IP To: <input type="text" name="ipto"><br>
    WAN: <input type="text" name="wan"><br>
    LAN: <input type="text" name="lan"><br>
    Traffic Control Path: <input type="text" name="tcpath"><br>
    PacketLimit: <input type="text" name="packetlimit"><br>
    Download Rate: <input type="text" name="drate"> kbit/s<br>
    Upload Rate: <input type="text" name="urate"> kbit/s<br>
    </form>

    <form name="input" action="html_form_action.asp" method="get">
    Password: <input type="password" name="pwd">
    <input type="submit" value="Submit">
    </form>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:21:59.927

只是为了清理你的代码：

```
<?php 

    $myFile = "C:\dat300backups\script.txt";
    $lines = file($myFile);//file in to an array
    for ($i = 13, $i <= 21; $i++) {
        echo "<input type=\"text\" name=\"ipsubnet\" value=\"" . $lines[$i] . "\"><br>\n";
    }

    echo("<br>");

?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:08:44.113

您可以通过以下方式将 PHP 变量作为值传递到您的 html 代码中。不要忘记将您的文件保存为 .php 扩展名，并且以下代码应为 html 格式。

这是短标签（不是一个好习惯）：

```
IP Subnet: <input type="text" name="ipsubnet" value="<?=$lines[13]; ?>"> 
```

这里是“经典”标签：

```
IP Subnet: <input type="text" name="ipsubnet" value="<?php echo $lines[13]; ?>"> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:12:05.690

```
IP Subnet: <input type="text" name="ipsubnet" value="<?php echo $lines[13]; ?>"> 
```

# sublimetext2 - 负责活动选项卡颜色的键名是什么？

> ID：16082516
> 
> 赞同：0
> 
> 时间：2013-04-18T12:06:26.963
> 
> 标签：sublimetext2

当我们在 SublimeText2 中打开多个文件时，当前显示文件的选项卡比其他选项卡更暗/更亮。我的问题是，我看不到它——阴影差异太小了。

文件中键的名称是什么`.tmTheme`，所以我可以使它更具对比性？还是只是我无法影响的硬编码效果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T15:52:55.207

标签颜色由 .sublime-theme 中的图像设置。您关注的类/属性是

```
{
    "class": "tab_control",
    "attributes": ["selected"],
    "layer0.texture": "//IMAGE TO USE AS BACKGROUND FOR TAB//",
    "layer1.opacity": 0.0
} 
```

但是`"class": "tab_control"`可以自定义任何属性。

# ssas - 对 SSAS 措施进行分组

> ID：16082518
> 
> 赞同：0
> 
> 时间：2013-04-18T12:06:32.270
> 
> 标签：ssas, grouping, measures

嗨，我的立方体中有一个事实表，其中包含成员对建筑物的访问。事实表上有一个小时维度。例如：

会员 1 次访问 2 次 1:00-2:00 会员 2 次访问 2 次 2:00-3:00 会员 1 次访问 2 次 4:00-5:00

因此，总共有 6 次个人访问。有没有办法在 1:00 - 4:00 之间获得唯一身份访问者，在这种情况下是 2。

这是一个有点模糊的问题，但任何正确方向的指针都将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-01T16:41:07.520

在度量聚合中使用不同的计数

[半附加措施](http://technet.microsoft.com/en-us/library/ms175356.aspx)

# jquery - 在排序更改事件期间更新排序顺序 - jQuery UI

> ID：16082519
> 
> 赞同：4
> 
> 时间：2013-04-18T12:06:32.930
> 
> 标签：jquery, jquery-ui, jquery-ui-sortable

我希望列表元素的值是排序事件期间排序位置的索引。

此值应在排序更改事件期间自动更新。

```
 <script type="text/javascript">
        $(function() {
            $('#sortable').sortable({
                start : function(event, ui) {
                    var start_pos = ui.item.index();
                    ui.item.data('start_pos', start_pos);
                },
                change : function(event, ui) {
                    var start_pos = ui.item.data('start_pos');
                    var index = ui.placeholder.index();

                    if (start_pos < index) {
                        $('#sortable li:nth-child(' + index + ')').html(index-2);
                    } else {
                        $('#sortable li:eq(' + (index + 1) + ')').html(index + 1);
                    }
                },
                update : function(event, ui) {
                    var index = ui.item.index();
                    $('#sortable li:nth-child(' + (index + 1) + ')').html(index);

                },
                axis : 'y'
            });
        });

    </script> 
```

我创建了一个小提琴 [http://jsfiddle.net/jagan2explore/4mcpq/](http://jsfiddle.net/jagan2explore/4mcpq/)

解释我的要求。

如果我将第 1 个元素移动到第 5 个位置，则所有其他元素的值都会正确更新，如果我将第 5 个元素移动到第 1 个位置，则值会相应更新。

假设如果我将列表元素从 1 移动到 5 并从 5 移动到 2 而没有离开（在单个排序事件期间），则值不会相应地更新。

我错过了什么吗？

任何帮助将不胜感激。提前致谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-18T12:54:20.173

尝试这个：

```
update : function(event, ui) {
    var index = ui.item.index();
    var start_pos = ui.item.data('start_pos');

    //update the html of the moved item to the current index
    $('#sortable li:nth-child(' + (index + 1) + ')').html(index);

    if (start_pos < index) {
        //update the items before the re-ordered item
        for(var i=index; i > 0; i--){
            $('#sortable li:nth-child(' + i + ')').html(i - 1);
        }
    }else {
        //update the items after the re-ordered item
        for(var i=index+2;i <= $("#sortable li").length; i++){
            $('#sortable li:nth-child(' + i + ')').html(i-1);
        }
    }
}, 
```

演示：[jsfiddle](http://jsfiddle.net/4mcpq/3/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T15:07:39.423

我用另一种方法更新了你的小提琴，它似乎按预期工作：

```
 $(function() {
            $('#sortable').sortable({
                start : function(event, ui) {
                    var start_pos = ui.item.index();
                    ui.item.data('start_pos', start_pos);
                },
                change : function(event, ui) {
                    var start_pos = ui.item.data('start_pos');
                    var index = ui.placeholder.index();

                    cIndex = (start_pos < index) ? index-2 : index-1;
                    ui.placeholder.prevAll('li').each(function(){
                        $this = $(this);
                        if($this.is(ui.item)) {return;}
                        $this.html(cIndex);
                        cIndex--;
                    });

                    cIndex = (start_pos < index) ? index : index+1;
                    ui.placeholder.nextAll('li').each(function(){
                        $this = $(this);
                        if($this.is(ui.item)) return;
                        $this.html(cIndex)
                        cIndex++;
                    });

                    ui.item.html((start_pos < index) ? index-1 : index);
                },
                axis : 'y'
            });
        }); 
```

**演示** [这是小提琴！](http://jsfiddle.net/4mcpq/4/)

# regex - 在 Perl 中使用正则表达式查找空字符

> ID：16082526
> 
> 赞同：5
> 
> 时间：2013-04-18T12:06:42.520
> 
> 标签：regex, perl

我想在我拥有的数组中找到空字符。我尝试显示 ASCII 值并打印 0（所以我确认它是一个空值）。如何编写正则表达式来过滤掉这些值。

我写 ：

```
m/^$/ig 
```

这真的没有帮助我。有人知道如何匹配空字符吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T12:20:20.133

您可以使用`\x`后跟 ASCII 字符的十六进制代码来匹配该 ASCII 字符。

例如`/\x3F/`，将匹配“？”，`/\x46\x4F\x4F/`以匹配“FOO”。

[在 Regexr 上](http://regexr.com?34itl)查看

所以`/\x00/`会匹配 NULL 字符。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-18T12:08:42.647

您可以使用`\0`查找空字符。（但不要在这个后面加上另一个数字）

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-04-18T12:12:07.497

0x0 应该可以解决问题。

0x[0-9A-F] 查找任何十六进制字符

# model-view-controller - 从 Zendframework 2 中的布局调用模型中的方法

> ID：16082529
> 
> 赞同：0
> 
> 时间：2013-04-18T12:06:53.530
> 
> 标签：model-view-controller, zend-framework2

我尝试在 Zendframework 2 中调用模型表单布局中的方法来显示一些用户特定的东西。我曾尝试在 init 和 onBootstrap 的 Module.php 中执行此操作，并尝试声明一些将在 layout.phtml 中可用的变量，但我失败了并且没有发现任何有用的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:24:09.667

为此，您通常会使用视图助手作为模型的代理

在您的应用程序中创建一个视图助手，例如，

```
<?php
namespace Application\View\Helper;

use Zend\View\Helper\AbstractHelper;

class MyModelHelper extends AbstractHelper
{
    protected $model;

    public function __construct($model)
    {
         $this->model = $model;
    }

    public function myCoolModelMethod()
    {
        return $this->model->method();
    }
} 
```

然后，您可以通过使用方法和异常函数将其注册到`Module.php`文件中的框架来使其可用，作为工厂来组成您的助手，并注入它所期望的模型`getViewHelperConfig()`

```
<?php
namespace Application;
class Module
{
    public function getViewHelperConfig()
    {
        return array(
            'factories' => array(
                 'myModelHelper' => function($sm) {
                      // either create a new instance of your model
                      $model = new \FQCN\To\Model();
                      // or, if your model is in the servicemanager, fetch it from there
                      //$model = $sm->getServiceLocator()->get('ModelService')
                      // create a new instance of your helper, injecting the model it uses
                      $helper = new \Application\View\Helper\MyModelHelper($model);
                      return $helper;
                 },
             ),
        );
    }
} 
```

最后，在你的视图（任何视图）中，你可以调用你的助手，它又会调用你的模型方法

```
 // view.phtml
 <?php echo $this->myModelHelper()->myCoolModelMethod(); ?> 
```

# javascript - Date.getTimezoneOffset 返回错误的结果？

> ID：16082530
> 
> 赞同：2
> 
> 时间：2013-04-18T12:07:00.563
> 
> 标签：javascript

经过巴西时区测试。如果您不是来自巴西，请在您的系统上更改它。这是代码：

```
var b = new Date(2013, 9, 20, 0, 0, 0);
var bt = b.getTime();
var bof = b.getTimezoneOffset(); // in hours
var m = 60*1000; // minutes * miliseconds

var utctime1 = bt - bof*m;
var utctime2 = Date.UTC(2013, 9, 20, 0, 0, 0);

return utctime1 == utctime2; 
```

返回 false，表示时间戳不同。

经过进一步调查，似乎 20.10.2013 0:00 JS 返回一个时区的时间戳，但返回另一个时区的 timezoneOffset。真的有错误还是我做错了什么/想错了？

# android - Android中各种加密算法的时间比较

> ID：16082533
> 
> 赞同：2
> 
> 时间：2013-04-18T12:07:08.793
> 
> 标签：android, performance, encryption, aes

我正在开发一个加密/解密任何文件的 android 应用程序。这是我的大学项目。

我目前正在使用 AES 与 CBC 和 PKCS#7 [AES/CBC/PKCS7Padding]。我的应用程序运行良好，但我担心加密和解密文件所需的时间。

我想知道是否有一些资源可以比较使用任何 android 硬件加密和解密任何大小的示例文件所花费的时间。

此外，所花费的时间是否仅取决于文件的大小，还是文件的类型？我阅读的这篇文章指出了一些[DES、三重 DES、AES、河豚加密数据的比较](https://stackoverflow.com/questions/5554526/comparison-of-des-triple-des-aes-blowfish-encryption-for-data)

我还读到，除了 AES，我们在 Android 中工作时没有太多选择。

我想对至少 3 种算法进行比较研究，并证明我对 AES 的使用优于其他算法。

除此之外，我发现使用称为 AES-NI 的新型英特尔酷睿系列处理器可以实现 AES 加速（[http://software.intel.com/en-us/articles/intel-advanced-encryption-standard-instructions-aes-ni /](http://software.intel.com/en-us/articles/intel-advanced-encryption-standard-instructions-aes-ni/)），但据我了解，它们仅适用于英特尔处理器，不适用于 Android 处理器（不使用英特尔）。如果我错了，请纠正我。

# jquery - 如何使用 js-test-driver 测试 fadeTo、fadeOut 等 jquery 动画函数？

> ID：16082536
> 
> 赞同：4
> 
> 时间：2013-04-18T12:07:22.403
> 
> 标签：jquery, unit-testing, animation, js-test-driver

我试图为我的 js 函数编写一些测试用例，但我遇到了一个恼人的问题。

在我的脚本中有一个代码部分，如：

```
$("idOfTheDiv").fadeOut('fast'); 
```

或者：

```
$("idOfTheDiv").fadeTo('fast', 1); 
```

这在我的页面上运行良好。

当我想写一些 js-test-driver 单元测试用例时，问题就来了。当我想验证 fadeTo 函数时：

...

```
assertTrue($("#idOfTheDiv").css("opacity") == "0"); 
```

...

然后它失败了。

原因可能是这是一个动画，当我尝试验证时，它没有完成动画。

有人可以知道一种能够在 js-test-driver 中测试 jQuery 动画函数的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:24:48.140

要测试异步行为，您需要使用 js-test-driver 中的[AsyncTestCase](http://code.google.com/p/js-test-driver/wiki/AsyncTestCase)。

尝试这个：

```
FadeTest = AsyncTestCase("FadeTest", {

testFadeOut : function(queue) {
    // add HTML to your Test
    /*:DOC += <div id="idOfTheDiv"><p>foo</p></div>*/

    var animationComplete = false;

    queue.call('prepare test', function(callbacks) {
        var onAnimationComplete = callbacks.add(function() {
            animationComplete = true;
        });

        $("#idOfTheDiv").fadeOut('fast', onAnimationComplete);
    });

    // The async test will wait until the onAnimationComplete function has been called.
    // So the following part is executed when the animation is done.
    queue.call('assertion', function() {
       assertTrue(animationComplete);
       // Now you can check the opacity of the div
       assertEquals(0, $("#idOfTheDiv").css("opacity")); 
    });

}

}); 
```

注意：*我自己没有尝试过代码。希望没有错别字。;)*

**编辑：**如果您要测试的函数没有回调功能，您可以使用 AOP 添加它。程序是：

*   向要测试的函数添加 after() 回调（如在此[jsfiddle](http://fiddle.jshell.net/faFL9/7/)中）。
*   在队列的回调对象中注册 after() 函数。
*   在下一个队列步骤中，您可以在方法完成后做出应该为真的断言。

# javascript - 淘汰自动增长绑定删除更改事件绑定

> ID：16082537
> 
> 赞同：1
> 
> 时间：2013-04-18T12:07:25.367
> 
> 标签：javascript, knockout.js, custom-binding, autogrow

我有一个 jquery autogrow 插件的自定义绑定，可以在这里看到[Autosize knockout custom binding autosize on load](https://stackoverflow.com/questions/15062712/autosize-knockout-custom-binding-autosize-on-load)

参考代码：

```
ko.bindingHandlers.autogrow = {

            init: function (element, valueAccessor, allBindingsAccessor) {
                ko.applyBindingsToNode(element, { value: valueAccessor() });

                ko.utils.domNodeDisposal.addDisposeCallback(element, function () {
                    //$(element).data('autosize').remove();
                });

                $(element).autosize({ append: "\n" });

                $(element).focus(function () {
                    $(element).trigger('autosize');
                });
            }
        }; 
```

我使用它如下：

```
 <textarea id="autogrow" class="text-nm span2" data-bind="autogrow: AreaProcessName, attr: { id: 'AreaProcessName' + Id }, event: { change: ViewModel.vmAreaProcess.SetAreaRevision($data) }"></textarea> 
```

attr 绑定仍在工作，但更改事件绑定已停止工作。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:52:07.703

jsfiddle.net/sujesharukil/3p9bj/17 这似乎工作正常。我所做的只是从更改事件中删除 ($data)。正如我在第一条评论中指出的那样，原因是当您设置类似

```
data-bind="event: {'someevent': func()} 
```

本质上发生的是，someevent 的偶数处理程序被设置为 func() 调用的返回。由于您的函数 ViewModel.vmAreaProcess.SetAreaRevision 没有返回处理程序函数，因此在实际触发事件时它不会执行回调，因为 func() 会立即执行。

当你这样设置时

```
data-bind="event: {'someevent': func} 
```

您实际上是在将“someevent”绑定到 func 处理程序。该函数将在事件触发时执行。希望清除它？

# android - 将“adb卸载”集成到eclipse

> ID：16082540
> 
> 赞同：0
> 
> 时间：2013-04-18T12:07:35.593
> 
> 标签：android, eclipse, adb

我想将“adb 卸载”集成到 Eclipse。我切换到

1.  “外部工具配置”->“新启动配置”
2.  （右选项卡）“位置”设置为“路径/到/adb.exe”
3.  “工作目录”留空
4.  “参数”设置为“卸载 ${project_name}”

`${project_name}`不返回`com.my.project.` 我需要在第二个参数中指定哪个变量而不是`${project_name}`？

从命令行看起来像“ `adb uninstall com.my.project`”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:26:52.093

它实际上

```
adb uninstall packagename 
```

在android中，每个应用程序都由包名唯一标识，因此我们在这里指定包名。

但我不确定如何在配置中获取包名。在代码中，您可以从

```
getPackageManager().getPackageInfo(getPackageName(), 0).packageName 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T15:57:50.543

请参阅此站点以修复它...[这里](http://developer.android.com/tools/help/adt.html)和[这里。](http://developer.android.com/tools/sdk/eclipse-adt.html).

# sql-server - SQL 性能/从表中选择数据和从同一表上查看相同数据的优势

> ID：16082544
> 
> 赞同：0
> 
> 时间：2013-04-18T12:07:49.140
> 
> 标签：sql-server

为什么建议从特定表的视图中选择数据，而不是直接从表中选择。

例如。我有

```
select * from table1 --Not recommended

create view test (

select * from table1

) 

select * from view - Recommended. 
```

是因为锁定问题还是其他（使用 mssql 2008 R2）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:11:04.073

意见一般建议

*   隐藏基础表结构，即具有计算列或转换列等，
*   在粒度级别管理访问，即仅授予对表中某些列的访问权限

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:34:09.423

我从来没有见过这个推荐 - 一个来源会很好！

正如 Vikdor 所说，有理由使用视图 - 安全性，并抽象出围绕底层数据的逻辑；它们对性能没有影响。

实际上，您的示例将被视为反模式，因为视图不会自动识别基础表的更改；每次更改“table1”时，都必须重新创建视图。

我还看到了一些情况，其中查询优化器通过访问视图而有些困惑，并且生成的查询比查询基表要慢。这是高度特定于平台和版本的，但是对于复杂的查询，这可能是一个问题。

物化视图可能具有性能优势，尤其是在视图存储复杂计算时。

# mysql - INSERT INTO 与 SELECT 和 rand() 混淆变量

> ID：16082551
> 
> 赞同：1
> 
> 时间：2013-04-18T12:08:14.443
> 
> 标签：mysql, variables

我正在尝试将我的表 A 的一部分复制到表 B：

```
@t1 := 1
INSERT INTO B
SELECT x, y, (@t1:=@t1+1)
FROM A
WHERE z=1
ORDER BY rand()
LIMIT 10 
```

我想要的是在表 B（第三列）中获取从 1 到 10 的值，但它正在生成 12、124、45 等值......我想知道它是否首先执行变量，然后按 rand( ) 因为这些值永远不会超过表 A 中的行数。

有没有其他方法可以从 A 到 B 获得 10 个随机行并将它们标记在从 1 到 10 的第三列（排序列）中？在一个 mysql 语句中，我知道如何插入 10 次；-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:16:39.520

首先排序，然后计算从 order by/limit 返回的行的行号：

```
SET @t1 := 1;

INSERT INTO B
SELECT x, y, (@t1:=@t1+1)
FROM (
  SELECT x, y
  FROM A
  WHERE z=1
  ORDER BY rand()
  LIMIT 10) ten_rows 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:23:17.537

尝试使其成为嵌套查询：

```
INSERT INTO B
    SELECT x, y, (@t1:=@t1+1)
    FROM (
        SELECT x, y
        FROM A
        WHERE z=1
        ORDER BY rand()
        LIMIT 10
    ) A1
    WHERE @t1 := 1 
```

# serial-port - USB GSM 调制解调器的 COM 端口无法自动识别

> ID：16082552
> 
> 赞同：1
> 
> 时间：2013-04-18T12:08:18.080
> 
> 标签：serial-port, gsm, modem, virtual-serial-port

我有一个 D-Link USB GSM 调制解调器，我正在使用 C#`SerialPort`类和 AT 命令为它开发一个应用程序。一切，例如发送和接收消息，都可以正常工作。但是我有调制解调器初始化的问题。每次我将调制解调器连接到 USB 端口时，我都必须运行调制解调器自己的连接管理器程序，称为*D-Link 连接管理器*。否则，计算机的设备管理器和超级终端都不会识别它和它的 COM 端口。我相信*D-Link 连接管理器*会为调制解调器创建一个虚拟 COM 端口。我不希望我的应用程序一直依赖于*D-Link 连接管理器*。有没有人有建议让我可以自动识别调制解调器的 USB COM 端口（虚拟端口）？事先感谢您的帮助。

由于*D-Link 连接管理器*无法在 Linux 操作系统中使用，如果我尝试在 Linux 系统上使用此调制解调器，则会出现此问题。

PS：当我使用带有串行端口连接的旧 GSM 调制解调器时，不存在此问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:12:02.850

您应该能够在设备管理器中看到这样的虚拟 COM 端口。我不太了解 D-Link 调制解调器，但我知道对于 USB 连接的条形码扫描仪（Symbol/Motorola 或 Datalogic），有特殊的虚拟 COM 端口驱动程序可以创建这样的 COM 端口，以便可以访问 USB 连接的扫描仪通过 COM 端口。

虽然这可能不舒服，但它仍然是必要的，因为默认情况下无法通过 COM 端口访问 USB 连接的设备。

# wpf - WPF treeview 提供自定义数据输入视图

> ID：16082553
> 
> 赞同：0
> 
> 时间：2013-04-18T12:08:18.127
> 
> 标签：wpf, view, treeview

新手`WPF`我正在努力理解如何基于`TreeView`控件提供单个数据输入表单的概念。

简单来说，我有一个分成两列的窗口，在左边我有一个`TreeView`静态数据，如下所示

```
 <TreeView Name="treeView1" VerticalAlignment="Top"    SelectedItemChanged="TreeViewItem_Selected" >
        <TreeViewItem Header="Settings"  IsExpanded="True" IsSelected="True">
            <TreeViewItem Header="Status" IsExpanded="True" >
                    <TreeViewItem Header="Info"/>
                    <TreeViewItem Header="Connection"/>
                </TreeViewItem>
            <TreeViewItem Header="Settings" IsExpanded="True">
                    <TreeViewItem Header="Options"/>
                    <TreeViewItem Header="IP"/>
                </TreeViewItem>
             </TreeViewItem>
        </TreeViewItem>
    </TreeView> 
```

我在后面的代码中提供了选定的节点信息。

我需要在右侧列中有一个表格，该表格可能包含许多不同的控件，每个视图都是单独的，并根据从`TreeView` `SelectedItemChanged`

我认为我在理解模板等的上下文时遇到了问题，所以我只是不知道如何让它工作。我原以为这是一个主流模型，它应该很简单，但开始认为情况可能并非如此，应该使用 C++。

任何指针和/或示例代码都会有很大帮助。

非常感谢您的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:31:33.373

> 但开始认为情况可能并非如此，应该使用 C++。

不，不是真的，问题在于 WPF 需要与大多数 UI 框架完全不同的范式和“思维方式”。

这就是所谓的[MVVM](https://stackoverflow.com/questions/14381402/wpf-programming-methodology/14382137#14382137)

以下是我对您所描述的内容的看法：

```
<Window x:Class="MiscSamples.TreeUI"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:MiscSamples"
        Title="TreeUI" Height="300" Width="300">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition/>
        </Grid.ColumnDefinitions>

        <TreeView ItemsSource="{Binding}" MinWidth="200" x:Name="TreeView">
            <TreeView.ItemTemplate>
                <HierarchicalDataTemplate ItemsSource="{Binding Children}">
                    <TextBlock Text="{Binding DisplayName}"/>
                </HierarchicalDataTemplate>
            </TreeView.ItemTemplate>
        </TreeView>

        <ContentPresenter Grid.Column="1" Content="{Binding SelectedItem, ElementName=TreeView}">
            <ContentPresenter.Resources>
                <DataTemplate DataType="{x:Type local:TreeViewModelBase}">
                    <!-- Empty -->
                </DataTemplate>

                <DataTemplate DataType="{x:Type local:SettingsViewModel}">
                    <TextBlock Text="{Binding SomeSetting}"/>
                </DataTemplate>

                <DataTemplate DataType="{x:Type local:InfoViewModel}">
                    <StackPanel>
                        <TextBox Text="{Binding SomeInfoText}"/>
                        <ListBox ItemsSource="{Binding Infos}"/>
                    </StackPanel>
                </DataTemplate>
            </ContentPresenter.Resources>
        </ContentPresenter>
    </Grid>
</Window> 
```

后面的代码（样板，只是实例化层次结构以支持示例）：

```
 public partial class TreeUI : Window
    {
        public TreeUI()
        {
            InitializeComponent();

            DataContext = new List<TreeViewModelBase>
                              {
                                  new SettingsViewModel()
                                      {
                                          Children =
                                              {
                                                  new TreeViewModelBase()
                                                      {
                                                          DisplayName = "Status",
                                                          Children =
                                                              {
                                                                  new InfoViewModel(),
                                                                  new TreeViewModelBase() {DisplayName = "Connection"}
                                                              }
                                                      }
                                              }
                                      }
                              };
        }
    } 
```

视图模型：

```
public class TreeViewModelBase: PropertyChangedBase
    {
        public string DisplayName { get; set; }

        private List<TreeViewModelBase> _children;
        public List<TreeViewModelBase> Children
        {
            get { return _children ?? (_children = new List<TreeViewModelBase>()); }
        }
    }

    public class SettingsViewModel: TreeViewModelBase
    {
        public string SomeSetting { get; set; }

        public SettingsViewModel()
        {
            DisplayName = "Settings";
            SomeSetting = "This is Some Setting in the Settings section";
        }
    }

    public class InfoViewModel: TreeViewModelBase
    {
        public string SomeInfoText { get; set; }

        public List<string> Infos { get; set; } 

        public InfoViewModel()
        {
            DisplayName = "Info";
            SomeInfoText = "Welcome to the Info section!";
            Infos = Enumerable.Range(1, 100).Select(x => "Info Text " + x.ToString()).ToList();
        }
    } 
```

支持类 (PropertyChangedBase)

```
public class PropertyChangedBase:INotifyPropertyChanged
    {
        public event PropertyChangedEventHandler PropertyChanged;

        protected virtual void OnPropertyChanged(string propertyName)
        {
            Application.Current.Dispatcher.BeginInvoke((Action) (() =>
                {
                    PropertyChangedEventHandler handler = PropertyChanged;
                    if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
                }));
        }
    } 
```

结果：

![在此处输入图像描述](https://i.stack.imgur.com/cERAi.png)

有几点需要注意：

*   这些`TreeViewModelBase`派生类中的每一个都代表一个“小部件”。然后，您可以添加相关属性以在每个属性上存储实际的设置值。
*   `DataTemplates`这些使用XAML 中所示的正确方法呈现到屏幕的右侧部分。您还可以将每个“小部件视图”单独`UserControl`放置，以保持 MainWindow.XAML 干净。
*   在我的示例中，没有一个事件或一行代码可以操作 UI 元素。它只是*简单、简单的属性和`INotifyPropertyChanged`*. 这就是您在 WPF 中编程的方式。不需要`SelectedIndexChanged`或类似的东西。
*   为了支持双向绑定，您的属性必须`OnPropertyChanged("PropertyName");`.
*   如果您需要进一步的帮助，请告诉我。

# ssh - 可能的 SSH PAM PTY 分配问题

> ID：16082557
> 
> 赞同：6
> 
> 时间：2013-04-18T12:08:27.847
> 
> 标签：ssh, pam, pty

我有一个托管在 Amazon EC2 上的 linux ubuntu 服务器。在系统上创建了大约 3000 多个 linux 用户，用户 ID 为 user_1、user_2 等。

令人惊讶的是，直到 user_2685 的用户都能够通过 ssh 登录到服务器。不止于此。

我已将 /etc/ssh/sshd_config 中的 LogLevel 更改为 DEBUG3。粘贴相关内容。

1.  用户无法登录时的相关转储 - [http://pastebin.com/NS2jC8vg](http://pastebin.com/NS2jC8vg)

```
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18879]：调试 1：分配 pty。
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18879]：调试 3：mm_request_send 输入：类型 26
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18879]：调试 3：mm_pty_allocate：等待 MONITOR_ANS_PTY
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18879]：调试 3：mm_request_receive_expect 输入：类型 27
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18879]: debug3: mm_request_receive 进入
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18802]: debug3: mm_request_receive 进入
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18802]: debug3: monitor_read: 检查请求 26
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18802]: debug3: mm_answer_pty 进入
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18802]: debug2: session_new: allocate (allocated 0 max 10)
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18802]: debug3: session_unused: session id 0 未使用
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18802]: debug1: session_new: session 0
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18802]：调试 1：禁用 SELinux 支持
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18879]：调试 1：do_cleanup
4 月 18 日 10:18:00 domU-12-31-39-01-86-0C sshd[18879]: debug3: PAM: sshpam_thread_cleanup 进入

```

1.  用户成功登录时的相关转储 - [http://pastebin.com/vUXnpDsr](http://pastebin.com/vUXnpDsr)

```
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 1：分配 pty。
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 3：mm_request_send 输入：类型 26
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 3：mm_pty_allocate：等待 MONITOR_ANS_PTY
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 3：mm_request_receive_expect 输入：类型 27
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]: debug3: mm_request_receive 进入
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]: debug3: mm_request_receive 进入
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]: debug3: monitor_read: 检查请求 26
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]: debug3: mm_answer_pty 进入
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]: debug2: session_new: allocate (allocated 0 max 10)
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]: debug3: session_unused: session id 0 未使用
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]: debug1: session_new: session 0
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]：调试 1：禁用 SELinux 支持
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]：调试 3：mm_request_send 输入：类型 27
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18880]: debug3: mm_answer_pty: tty /dev/pts/37 ptyfd 4
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]: debug1: session_pty_req: session 0 alloc /dev/pts/37
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 1：忽略不支持的 tty 模式操作码 11 (0xb)
Apr 18 10:20:07 domU-12-31-39-01-86-0C sshd[18957]: debug1: 忽略不支持的 tty 模式操作码 17 (0x11)
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]: debug1: server_input_channel_req: channel 0 request shell reply 1
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]: debug1: session_by_channel: session 0 channel 0
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]: debug1: session_input_channel_req: session 0 req shell
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 2：fd 3 设置 TCP_NODELAY
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 2：通道 0：rfd 9 isatty
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]：调试 2：fd 9 设置 O_NONBLOCK
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18957]: debug3: fd 7 is O_NONBLOCK
Apr 18 10:20:07 domU-12-31-39-01-86-0C sshd[18958]: debug1: 使用 TIOCSCTTY 设置控制 tty。
Apr 18 10:20:07 domU-12-31-39-01-86-0C sshd[18958]: debug3: Copy environment: PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin :/usr/bin:/sbin:/bin:/usr/games
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C sshd[18958]：debug3：复制环境：LANG=en_US.UTF-8
4 月 18 日 10:20:07 domU-12-31-39-01-86-0C jk_chrootsh[18958]：现在为用户 user_1 (1001) 输入 jail /opt/users-rails-apps 参数

```

更新1：

以上转储来自服务器上的 /var/log/auth.log。以下是客户端上的转储。只需放置不同的转储的相关部分

登录成功

```
debug2：通道 0：请求 shell 确认 1
debug2：回调完成
debug2：通道 0：打开确认 rwindow 0 rmax 32768
debug2：channel_input_status_confirm：类型 99 id 0
debug2: 在通道 0 上接受 PTY 分配请求
debug2：通道 0：rcvd 调整 2097152
debug2：channel_input_status_confirm：类型 99 id 0
debug2：在通道 0 上接受了 shell 请求

```

登录失败

```
debug2：通道 0：请求 shell 确认 1
debug2：回调完成
debug2：通道 0：打开确认 rwindow 0 rmax 32768
debug1：通道 0：免费：客户端会话，nchannels 1
debug3：通道 0：状态：以下连接已打开：
  #0 客户端会话（t4 r0 i0/0 o0/0 fd 4/5 cc -1）

远程主机关闭与 www.codelearn.org 的连接。
与 www.codelearn.org 的连接已关闭。
已传输：发送 2488，接收 1472 字节，在 0.8 秒内
每秒字节数：发送 3043.4，接收 1800.6
debug1：退出状态-1

```

操作系统：Ubuntu 精确 12.04

Openssh 服务器：`OpenSSH_5.9p1 Debian-5ubuntu1.1, OpenSSL 1.0.1 14 Mar 2012`

SSH 客户端：没关系，因为我在 ubuntu 和 Mac 上都试过，而且行为是一样的。

更新 2：

顺便说一句 - 这不是 PAM 的问题，就像我可以做`su user_3000`的那样，新用户登录并获得 PTY。

同样在不要求 PTY`ssh -T user_3000@www.codelearn.org`的情况下执行 ssh 会登录用户。但它会停止登录后并且没有出现提示。可能那是因为一开始没有要求提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T10:36:22.683

您是否检查过您的`sshd_config`以确保没有发生最大化问题？

密切注意，提防，小心 `ClientAliveCountMax` `MaxSessions` `MaxStartups`

特别`MaxSessions`是因为您不成功的登录消息列出了一堆打开的连接作为原因。增加数量并检查行为。

你可以在这里阅读更多 - [http://www.manpagez.com/man/5/sshd_config/](http://www.manpagez.com/man/5/sshd_config/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T12:08:00.257

所以事实证明这是用户的 /etc/security/limits.conf 问题。

我猜 PAM 试图通过以用户身份查看 /etc/passwd 文件来进行身份验证。限制有一个字段 fsize 设置为 1000 。如果用户较早出现在 /etc/passwd - PAM 将能够找到并进行身份验证。如果他稍后出现，fsize 限制可能已经达到并且 PAM 退出。

将 fsize 从 1000 更改为 2000 解决了这个问题。

# spring - Spring -servlet.xml bean 访问

> ID：16082558
> 
> 赞同：0
> 
> 时间：2013-04-18T12:08:30.293
> 
> 标签：spring, spring-mvc

在 Spring 中，我通常使用 getBean() 方法访问 bean。例如：

ApplicationContext.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www... etc">
       <bean id="MyClass" class="ioc.beans.MyClass" /> 
</beans> 
```

爪哇：

```
ApplicationContext applicationContext = new ClassPathXmlApplicationContext("applicationContext.xml");
MyClass cl = applicationContext.getBean("MyClass", MyClass.class); 
```

现在我正在使用 Spring MVC，bean 是在带有后缀 -servlet 的 xml 文件中创建的，并且我没有 ClassPathXmlApplicationContext。

如果没有 getBeans 方法，我如何从控制器访问我的 java bean 以使用对象？（还考虑到这种方法——Spring 在任何入门教程中的首要特征——是一种不好的做法）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:38:27.407

可以使用Spring Dependency Injection(Constructor Injection Setter Injection)。

```
private WildAnimal wild;

@Autowired
  public void setWild(WildAnimal wild) {
    this.wild = wild;
  } 
```

在 XML

```
<bean id="wild" class="com.javapapers.spring.ioc.Wolf" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:49:28.180

如果您在 Web 应用程序中使用 Spring，则没有真正的理由以编程方式获取这样的 bean。

您应该使用显式构造函数/设置器注入或自动装配。在第一种情况下，所有 Spring 管理的 bean 都应该在您的 XML（或 JavaConfig，如果您正在使用它）中定义。其次，要自动装配的类应该在您的 XML/JavaConfig 中声明，或者应该在组件扫描路径上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:11:45.450

你可以使用

```
 @Autowired 
```

[注释](http://static.springsource.org/spring/docs/3.0.0.M3/reference/html/ch04s11.html)

# asp.net-mvc-3 - 与 mvc3 中的 ReturnUrl 概念相关的问题

> ID：16082561
> 
> 赞同：0
> 
> 时间：2013-04-18T12:08:34.417
> 
> 标签：asp.net-mvc-3, returnurl

我在 mvc3 中开发了一个使用 ReturnUrl 概念的网站。在此我们实现了授权，当用户未登录并尝试访问授权页面时，该用户将被重定向到登录页面。

例如，如果我们有一个 url [http://mydemosite.com/User/List](http://mydemosite.com/User/List)，并且访问该链接的用户没有登录。然后用户被重定向到登录页面，返回 url 为[http://mydemosite.com/帐户/登录/?ReturnUrl=%2fUser%2fList](http://mydemosite.com/Account/login/?ReturnUrl=%2fUser%2fList)。因此，现在当用户使用有效凭据登录时，网站将重定向到用户/列表页面。

我的问题是如果我浏览到以下网址

[http://mydemosite.com/Device/List/?ReturnUrl=%2fUser%2fList](http://mydemosite.com/Device/List/?ReturnUrl=%2fUser%2fList)

它向我显示 401 - 未授权错误。但是如果我将网址更改为

[http://mydemosite.com/User/List/?ReturnURL=%2fUser%2fList](http://mydemosite.com/User/List/?ReturnURL=%2fUser%2fList)

请注意，我将查询参数 ReturnUrl 更改为 ReturnURL，在此更改之后，我在身份验证完成后被重定向到请求的页面。

谁能让我知道为什么会出现这个问题？

# ios - 如何获取文件大小以知道是否下载？

> ID：16082563
> 
> 赞同：1
> 
> 时间：2013-04-18T12:08:40.827
> 
> 标签：ios, objective-c, progress-bar, download, file-handling

我正在使用以下代码从 url 下载 epub /pdf。我喜欢提供一个进度条，所以当我开始下载时它会显示进度，下载完成时会弹出一条消息。我该如何实施？

我的下载文件代码

```
-(void)Download
 {
    NSData *pdfData = [[NSData alloc] initWithContentsOfURL:[NSURL    URLWithString:@"http://www.feedbooks.com/book/3471.epub"]];

    //Store the Data locally as epub  File if u want pdf change the file extension  

    NSString *resourceDocPath = [[NSString alloc] initWithString:[[[[NSBundle mainBundle]  resourcePath] stringByDeletingLastPathComponent] stringByAppendingPathComponent:@"Documents"]];

    NSString *filePath = [resourceDocPath stringByAppendingPathComponent:@"3471.epub"];

    [pdfData writeToFile:filePath atomically:YES];
    NSLog(@"%@",filePath);
 } 
```

我在我的 .m 文件中使用此代码，但它不适合我

```
-(void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    _totalFileSize = response.expectedContentLength;
    responseData = [[NSMutableData alloc] init];
}

-(void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    _receivedDataBytes += [data length];
    MyProgressBar.progress = _receivedDataBytes / (float)_totalFileSize;
    [responseData appendData:data];
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:25:57.910

**使用 NSURLConnection**

**在 .h 文件中**

```
double datalength;
NSMutableData *databuffer;
UIProgressView *progress; 
```

**在 .m 文件中**

```
-(void)Download
{
      NSURLConnection *con=[[NSURLConnection alloc]initWithRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.feedbooks.com/book/3471.epub"]] delegate:self startImmediately:YES];
      [con start];
} 
```

**委托方法**

```
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response
{
    datalength = [response expectedContentLength];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    [databuffer appendData:data];
    progress.progress = (databuffer.length/datalength);
    self.HUD.detailsLabelText = [NSString stringWithFormat:@"Downloading  %.f  %%",(databuffer.length/datalength)*100];
}
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSString *resourceDocPath = [[NSString alloc] initWithString:[[[[NSBundle mainBundle]  resourcePath] stringByDeletingLastPathComponent] stringByAppendingPathComponent:@"Documents"]];
    NSString *filePath = [resourceDocPath stringByAppendingPathComponent:@"3471.epub"];
    [pdfData writeToFile:filePath atomically:YES];
    NSLog(@"%@",filePath);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:14:43.963

如果这样做`curl -vvv -o epub.pdf http://www.feedbooks.com/book/3471.epub`，您将看到以下行：

`Content-Length: 603244`

content-length 标头是您正在下载的数据的字节大小。您可以在编写数据时使用它来跟踪进度。

使用您当前的代码，您无法真正做您想做的事。您应该查看[此答案](https://stackoverflow.com/questions/2149929/how-to-know-when-nsdatas-initwithcontentsofurl-has-finished-loading)以获取更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:30:07.343

您可以检查`data`NSData 的长度。然后你会发现实际下载的数据。

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data;
{
    // append the new data to the receivedData

    [receivedData appendData:data];
} 
```

在这里，您将获得以字节为单位的数据长度。您可以根据需要进行转换。

它可能会帮助你。

# php - CArrayDataProvider 和 CGridView 分页 Yii

> ID：16082568
> 
> 赞同：2
> 
> 时间：2013-04-18T12:08:46.040
> 
> 标签：php, yii, cgridview

我正在尝试对`CGridView`using进行分页`CArrayDataProvider`（我`$rawData`是自定义数组 - 不是来自数据库/模型）。因此，在控制器的操作中具有以下内容：

```
$form = new SearchUser;//here I have SearchUser form that extends CFormModel with the following attributes: 'id', 'name', 'surname', 'phone', 'address'
$users = array();
if (isset($_POST['SearchUser'])) {
....//prepare users array from my custom source-> not from DB/models etc
}

$dataProvider=new CArrayDataProvider($users, array(
            'id'=>'id',
            'keys'=>array('name', 'surname', 'phone', 'address'),
            'sort'=>array(
                'attributes'=>array(
                    'name', 'surname', 'phone', 'address'
                ),
            ),
            'pagination'=>array(
                'pageSize'=>15,
            ),
        )); 
```

和：

```
$this->render('index', array('dataProvider'=>$dataProvider, 'form'=>$form)); 
```

在 index.php 我有：

```
...
<?php echo CHtml::link('Search','#',array('class'=>'search-button')); ?>
<div class="search-form" style="display:none">
<?php $this->renderPartial('_search',array(
'model'=>$form,
)); ?>
</div><!-- search-form -->
<?php

$this->widget('zii.widgets.grid.CGridView', array(
'dataProvider'=>$dataProvider,
'columns'=>array(

    array(
        'name' => 'Name',          
        'type' => 'raw',
        'value' => 'CHtml::encode(@$data["name"])'
    ),
    array(
        'name' => 'Surname',          
        'type' => 'raw',
        'value' => 'CHtml::encode(@$data["surname"])'
    ),/*
    array(
        'name' => 'Phone',          
        'type' => 'raw',
        'value' => 'CHtml::encode(@$data["phone"])'
    ),*/
    array(
        'name' => 'Address',          
        'type' => 'raw',
        'value' => 'CHtml::encode(@$data["address"])'
    ),
),
'enablePagination'=> true,
)); 
```

第一页显示正确，但是当我选择另一页时，我的过滤器丢失了，所有数据都显示在网格中，而不是“过滤”的数据。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:12:57.983

不确定它会解决您的问题，但是在您的 CArrayDataProvider 中，您使用`id`定义键字段的名称而不是`keyField`. 您可以尝试以下方法：

```
$dataProvider=new CArrayDataProvider($users, array(
    'id'=>'users',
    'keyField' => 'id', 
    'keys'=>array('id','name', 'surname', 'phone', 'address'),
    'sort'=>array(
        'attributes'=>array(
            'name', 'surname', 'phone', 'address'
        ),
    ),
    'pagination'=>array(
        'pageSize'=>15,
    ),
)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-25T09:50:59.433

> 用户型号：

```
 public function getAllList(){
        $sql = "SELECT * FROM users";
        $cmd = Yii::app()->db->createCommand($sql);
        return $cmd->queryAll();
    } 
```

> 用户控制器：

```
 public function actionIndex(){
        $model = Users::model()->getAllList();
        $dataProvider = new ArrayDataProvider($model, array(
            'keyField'          =>  'user_id',
            'pagination'        =>  array(
                'pageSize'  =>  5,
                ),
            )
        );
        $this->render('index',array(
            'dataProvider'  =>  $dataProvider,
            )
        );
    } 
```

> 用户浏览量：

```
index.php

    $this->widget('zii.widgets.CListView', array(
        'ajaxUpdate'        =>  true,
        'dataProvider'      =>  $dataProvider,
        'itemView'          =>  '_view',   // refers to the partial view named '_carList'
        'template'          =>  '<h4><span>{summary}</span></h4>{items}{summary}{pager}',
        'pagerCssClass'     =>  'pagination',
        'summaryText'       =>  '{start}-{end} of {count} Total Property ',
        'pager'             =>  array(
            'header'                =>  FALSE,
            'firstPageLabel'        =>  FALSE,
            'lastPageLabel'         =>  FALSE,
            'nextPageLabel'         =>  'Next',
            'prevPageLabel'         =>  'Previous',
            'selectedPageCssClass'  =>  'active',
            'maxButtonCount'        =>  '5'
        ),
        'beforeAjaxUpdate'      =>  'function(){
            //todo before
        }',
        'afterAjaxUpdate'       =>  'function(){
            //todo after
        }',
    ));

_view.php

    <p>
        <?php echo $data['user_id']; ?>
        <?php echo $data['user_name']; ?>
        <?php echo $data['user_pass']; ?>
    </p> 
```

# sql - SQL-搜索字符串时忽略大小写

> ID：16082575
> 
> 赞同：166
> 
> 时间：2013-04-18T12:09:13.093
> 
> 标签：sql, sql-server, case-insensitive, sql-like, ignore-case

我在表PriceOrderShipped
PriceOrderShippedInbound
PriceOrderShippedOutbound 中有以下数据

在 SQL 中我需要编写一个查询来搜索表中的字符串。在搜索字符串时，它应该忽略大小写。对于下面提到的 SQL 查询

```
SELECT DISTINCT COL_NAME FROM myTable WHERE COL_NAME LIKE '%PriceOrder%' 
```

给出所有上述数据，而

```
SELECT DISTINCT COL_NAME FROM myTable WHERE COL_NAME LIKE '%Priceorder%' 
```

不给。

例如。当我搜索 'PriceOrder' 或 'priceOrder' 时，它可以工作，但 'priceorder' 或 'Priceorder' 不起作用。我已经尝试使用 COLLATE 进行以下查询，但它不起作用。请让我知道我哪里出错了。

```
SELECT DISTINCT COL_NAME FROM myTable WHERE 
COL_NAME COLLATE latin1_general_cs LIKE '%Priceorder%' 
```

* * *

## 回答 #1

> 赞同：318
> 
> 时间：2013-04-18T12:23:41.710

使用这样的东西 -

```
SELECT DISTINCT COL_NAME FROM myTable WHERE UPPER(COL_NAME) LIKE UPPER('%PriceOrder%') 
```

或者

```
SELECT DISTINCT COL_NAME FROM myTable WHERE LOWER(COL_NAME) LIKE LOWER('%PriceOrder%') 
```

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2018-06-08T05:02:46.380

像这样。

```
SELECT DISTINCT COL_NAME FROM myTable WHERE COL_NAME iLIKE '%Priceorder%' 
```

在 PostgreSQL 中。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-04-18T12:12:40.830

请参阅此类似的问题和不区分大小写搜索的答案 - [SQL Server ignore case in a where expression](https://stackoverflow.com/questions/1224364/sql-server-ignore-case-in-a-where-expression)

尝试使用类似的东西：

```
SELECT DISTINCT COL_NAME 
FROM myTable 
WHERE COL_NAME COLLATE SQL_Latin1_General_CP1_CI_AS LIKE '%priceorder%' 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-18T12:10:35.717

您可能应该将`SQL_Latin1_General_Cp1_CI_AS_KI_WI`其用作排序规则。您在问题中指定的内容明确区分大小写。

[您可以在此处](http://msdn.microsoft.com/en-us/library/ms144250%28v=sql.105%29.aspx)查看排序规则列表。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-05-19T08:30:45.080

如果有人使用 ORACLE 可以在数据库级别本身进行更改

```
ALTER SESSION SET NLS_COMP=LINGUISTIC;  
ALTER SESSION SET NLS_SORT=BINARY_CI; 
```

注意：- 甲骨文

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2021-12-01T12:07:20.710

这是我使用的解决方案。

```
SELECT * FROM TABLE WHERE COLUMN ~* '.*search_keyword_any_case.*' 
```

这还将检查子字符串。总的来说，我从互联网上遇到的最佳解决方案。我使用相同的方法来实现对表列的子字符串不区分大小写搜索。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-05-18T05:32:31.617

在几乎所有 SQL 编译器中，like 运算符都不区分大小写。如果您仍然没有得到区分大小写的结果，请使用 iLike 运算符。您也可以通过使用 Upper() 方法更改大小写来比较它。

```
SELECT DISTINCT COL_NAME FROM myTable WHERE COL_NAME iLIKE '%PriceOrder%' 
```

或者

```
SELECT DISTINCT COL_NAME FROM myTable WHERE UPPER(COL_NAME) LIKE UPPER('%PriceOrder%')
SELECT DISTINCT COL_NAME FROM myTable WHERE LOWER(COL_NAME) LIKE LOWER('%PriceOrder%') 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-10-10T09:03:45.773

替代和最佳解决方案：
您还可以使用特定的“排序规则”，例如 utf8 > utf8_unicode_ci。然后所有查询将不区分大小写。但是在某些地方数据可能是大写的。因此，请确保没有可能存在不同情况的双胞胎（例如确保使用 UNIQUE 列）。

查询示例：
[https](https://prnt.sc/1vjwxd1)
://prnt.sc/1vjwxd1 使用的表格设计和整理：[https](https://prnt.sc/1vjx3h5) ://prnt.sc/1vjx3h5 。

“良好的数据库设计可以为您节省大量查询工作” - 我 :)

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-07-02T06:21:23.043

正如我在我的项目中所经历的那样，我喜欢区分大小写搜索的结果和不区分大小写的 LIKE 结果。我不知道这是如何工作的，但我在我的项目中经历过。使用休眠

用户

1.  约翰
2.  强尼
3.  杰哈姆斯

当我使用

```
from Users userName LIKE 'jh%' 
```

结果全部三个以及何时

```
 from Users userName like 'jh%' 
```

结果只有 jhon 和 jhonny

# wpf - wpf中用户控件内的数据网格中没有出现垂直滚动条

> ID：16082580
> 
> 赞同：6
> 
> 时间：2013-04-18T12:09:35.883
> 
> 标签：wpf, xaml, user-controls, scrollbar

我在 WPF 中有一个具有 DataGrid 的用户控件。我将此用户控件添加到 TabControl 的 TabItem 内的 Window 中。垂直滚动条不可见。我调整了窗口的大小，在考虑了 DataGrid 的高度之后，用户控件似乎正在占据它的完整高度。

如何使垂直滚动条出现并根据用户控件和窗口的高度可用的高度仍然保持 DataGrid 的高度为自动？

编辑：主窗口：

```
<Window>
  <Grid>
    <TabControl Name="tc"
                SelectionChanged="tc_SelectionChanged">
      <TabItem Header="ABC">
        <local:uc1 />
      </TabItem>
      <TabItem Header="DEF">
        <local:uc2 />
      </TabItem>
    </TabControl>
  </Grid>
</Window> 
```

用户控制：

```
<UserControl>
  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"></RowDefinition>
      <RowDefinition Height="30"></RowDefinition>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="2*"></ColumnDefinition>
      <ColumnDefinition Width="*"></ColumnDefinition>
    </Grid.ColumnDefinitions>

    <StackPanel Grid.Row="0"
                Grid.Column="0"
                Orientation="Vertical">
      <StackPanel Orientation="Horizontal">
        <Button>Add</Button>
        <Button>Remove</Button>
        <Button>Refresh</Button>
      </StackPanel>

      <Label Name="lblTopMessage">some message</Label>

      <DataGrid Name="dg"
                IsReadOnly="True">
        <DataGrid.Columns>
          <DataGridTextColumn Binding="{Binding Name}"
                              Header="Name"
                              Width="*"></DataGridTextColumn>
          <DataGridTextColumn Binding="{Binding Value}"
                              Header="Value"
                              Width="130"></DataGridTextColumn>
          <DataGridTextColumn Binding="{Binding List}"
                              Header="List"
                              Width="*"></DataGridTextColumn>
        </DataGrid.Columns>
      </DataGrid>

    </StackPanel>
    <Grid Grid.Row="0"
          Grid.Column="1"
          Name="gridTS">
      <Grid.RowDefinitions>
        <RowDefinition Height="Auto"></RowDefinition>
        <RowDefinition Height="Auto"></RowDefinition>
        <RowDefinition Height="Auto"></RowDefinition>
        <RowDefinition Height="Auto"></RowDefinition>
        <RowDefinition Height="Auto"></RowDefinition>
        <RowDefinition Height="Auto"></RowDefinition>
      </Grid.RowDefinitions>
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="100"></ColumnDefinition>
        <ColumnDefinition Width="*"></ColumnDefinition>
      </Grid.ColumnDefinitions>
      <TextBlock Name="lblNewSource"
                 Grid.Row="0"
                 Grid.ColumnSpan="2"
                 HorizontalAlignment="Center"
                 Padding="0 5 0 0"
                 FontWeight="Bold">New Source</TextBlock>
      <TextBlock Grid.Row="1"
                 Grid.Column="0"
                 Padding="10 10 0 0">Name:</TextBlock>
      <TextBlock Grid.Row="2"
                 Grid.Column="0"
                 Padding="10 10 0 0">Value:</TextBlock>
      <TextBlock Grid.Row="3"
                 Grid.Column="0"
                 Padding="10 10 0 0">List:</TextBlock>

      <TextBox Grid.Row="1"
               Grid.Column="1"
               Name="txtName"
               IsEnabled="False"></TextBox>
      <ComboBox Grid.Row="2"
                Grid.Column="1"
                Name="cbValue"></ComboBox>
      <ListBox Grid.Row="3"
               Grid.Column="1"
               Name="lbList">
        <ListBox.ItemTemplate>
          <DataTemplate>
            <CheckBox Margin="3 5 0 3"
                      Content="{Binding Name}"
                      IsChecked="{Binding IsActive}" />
          </DataTemplate>
        </ListBox.ItemTemplate>
      </ListBox>

      <Button Name="btnSave"
              Click="btnSave_Click"
              Grid.Row="4"
              Grid.Column="1">Save</Button>
      <TextBlock TextWrapping="WrapWithOverflow"
                 Name="lblMessage"
                 Grid.Row="5"
                 Grid.Column="1"
                 Margin="0 10 10 0"></TextBlock>
    </Grid>
  </Grid>
</UserControl> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T12:26:45.930

**更新：** 我刚刚将 DataGrid 从 StackPanel 中取出。试试这个代码：

```
<Grid>
  <Grid.RowDefinitions>
    <RowDefinition Height="45.361"></RowDefinition>
    <RowDefinition Height="102.639" />
    <RowDefinition Height="30"></RowDefinition>
  </Grid.RowDefinitions>
  <Grid.ColumnDefinitions>
    <ColumnDefinition Width="2*"></ColumnDefinition>
    <ColumnDefinition Width="*"></ColumnDefinition>
  </Grid.ColumnDefinitions>

  <StackPanel Grid.Row="0"
              Grid.Column="0"
              Orientation="Vertical">
    <StackPanel Orientation="Horizontal">
      <Button>Add</Button>
      <Button>Remove</Button>
      <Button>Refresh</Button>
    </StackPanel>

    <Label Name="lblTopMessage">some message</Label>

  </StackPanel>

  <DataGrid Grid.Row="1"
            Name="dg"
            IsReadOnly="True">
    <DataGrid.Columns>
      <DataGridTextColumn Binding="{Binding Name}"
                          Header="Name"
                          Width="*"></DataGridTextColumn>
      <DataGridTextColumn Binding="{Binding Value}"
                          Header="Value"
                          Width="130"></DataGridTextColumn>
      <DataGridTextColumn Binding="{Binding List}"
                          Header="List"
                          Width="*"></DataGridTextColumn>
    </DataGrid.Columns>
  </DataGrid>

  <Grid Grid.Row="0"
        Grid.Column="1"
        Name="gridTS"
        Grid.RowSpan="2">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"></RowDefinition>
      <RowDefinition Height="Auto"></RowDefinition>
      <RowDefinition Height="Auto"></RowDefinition>
      <RowDefinition Height="Auto"></RowDefinition>
      <RowDefinition Height="Auto"></RowDefinition>
      <RowDefinition Height="Auto"></RowDefinition>
    </Grid.RowDefinitions>
    <Grid.ColumnDefinitions>
      <ColumnDefinition Width="100"></ColumnDefinition>
      <ColumnDefinition Width="*"></ColumnDefinition>
    </Grid.ColumnDefinitions>
    <TextBlock Name="lblNewSource"
               Grid.Row="0"
               Grid.ColumnSpan="2"
               HorizontalAlignment="Center"
               Padding="0 5 0 0"
               FontWeight="Bold">New Source</TextBlock>
    <TextBlock Grid.Row="1"
               Grid.Column="0"
               Padding="10 10 0 0">Name:</TextBlock>
    <TextBlock Grid.Row="2"
               Grid.Column="0"
               Padding="10 10 0 0">Value:</TextBlock>
    <TextBlock Grid.Row="3"
               Grid.Column="0"
               Padding="10 10 0 0">List:</TextBlock>

    <TextBox Grid.Row="1"
             Grid.Column="1"
             Name="txtName"
             IsEnabled="False"></TextBox>
    <ComboBox Grid.Row="2"
              Grid.Column="1"
              Name="cbValue"></ComboBox>
    <ListBox Grid.Row="3"
             Grid.Column="1"
             Name="lbList">
      <ListBox.ItemTemplate>
        <DataTemplate>
          <CheckBox Margin="3 5 0 3"
                    Content="{Binding Name}"
                    IsChecked="{Binding IsActive}" />
        </DataTemplate>
      </ListBox.ItemTemplate>
    </ListBox>

    <Button Name="btnSave"
            Grid.Row="4"
            Grid.Column="1">Save</Button>
    <TextBlock TextWrapping="WrapWithOverflow"
               Name="lblMessage"
               Grid.Row="5"
               Grid.Column="1"
               Margin="0 10 10 0"></TextBlock>
  </Grid>
</Grid> 
```

我希望这会有所帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T13:13:15.740

使垂直滚动条出现并仍然保持 DataGrid 自动的高度。
答案是不。

只要高度是自动的，它就会增长为自动意味着我得到了我想要的所有高度。

```
<RowDefinition Height="Auto"></RowDefinition> 
```

如果您希望它使用可用空间，请使用 *

```
<RowDefinition Height="*"></RowDefinition> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:31:36.520

将[VerticalScrollBarVisibility](http://msdn.microsoft.com/en-us/library/system.windows.controls.datagrid.verticalscrollbarvisibility%28v=vs.95%29.aspx)设置为`Visible`。

```
<DaraGrid VerticalScrollBarVisibility="Visible" ... >
...
</DataGrid> 
```

默认值为`Auto`。

**更新**

在查看您的代码后，我发现，滚动条`visibility`不是您真正的问题。您的问题是*DataGrid 在 StackPanel 中没有固定高度*。它占用了显示所有项目所需的所有空间，`DataGrid`这就是为什么`ScrollBar`was not的原因`Visible`。正如我之前所说，`VerticalScrollBarVisibility`is的默认值`Auto`意味着：

> > **MSDN** : Auto - 当视口无法显示所有内容时，会出现 ScrollBar，并将 ScrollViewer 的尺寸应用于内容。

# xml - 合并 XML 文件 SSIS

> ID：16082581
> 
> 赞同：0
> 
> 时间：2013-04-18T12:09:41.693
> 
> 标签：xml, ssis

我有一组需要加载到数据库中的 XML 文件。第三方发送的 XML 文件都包含相同的信息，这些信息被拆分为 10 个或更多单独的格式良好的文件。XML 包含低至 4 个级别的子父元素。我开始使用 XML Source 类型并将每个元素类型输出到一个单独的文件中。XML 源组件为每个元素添加一个唯一标识符，以便以后可以重新建立子父关系。但是我遇到的问题是每个元素的自动生成标识符仅对每个文件都是唯一的，因此当我遍历它重复的文件时。

任何人都遇到过这个问题，它是如何解决的。我正在考虑的一个选项是将所有文件合并到一个 XML 文件中，这将如何在 SSIS 中发生，因为我需要删除重复的根元素。或者，我可以将文件名添加为额外的列来制作复合主键，但这很麻烦。

# c# - 嵌套的 ItemControls - 绑定到上层控件

> ID：16082582
> 
> 赞同：0
> 
> 时间：2013-04-18T12:09:42.663
> 
> 标签：c#, wpf, data-binding, itemscontrol

我有一个 Collection 包含一个 Collection 本身。现在我想通过 wpf 中的两个集合。我正在尝试将第二个集合的颜色属性绑定到第一个集合的依赖属性。但是直到现在，我还没有找到正确绑定它的方法。在 Visibility-Binding 的情况下，我通过将第二个 ItemsPanelTemplate 中画布布局的 Visibility-Property 绑定到想要的属性找到了解决方法。

这是一段代表我的情况的代码：

```
<ItemsControl x:Name="Itemcntrl10" ItemsSource="{Binding Collection1}" >
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <Canvas />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <ItemsControl x:Name="Itemcntrl12" ItemsSource="{Binding Collection2}"  > 
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <Canvas Visibility="{Binding Visibility, Converter={StaticResource BooleanToVisibilityConverter}}" />
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                            <Line X1="{Binding X}" Y1="{Binding Y}" 
                                                  X2="{Binding old.X}" Y2="{Binding old.Y}" 
                                                  StrokeThickness="{Binding Path=DataContext.StrokeThickness, ElementName=ThisMainWindow}" 
                                                   >
                                            <Line.Stroke>
                                                <SolidColorBrush  Color="Black" />
                                            </Line.Stroke>
                                        </Line>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl> 
```

任何想法如何处理这个问题？我考虑过 ElementBinding 到上层 ItemsControl 但这也没有解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:18:32.003

您可以使用`RelativeSource`绑定来访问 VisualTree 更上层的项目

例如，

```
Color="{Binding RelativeSource={RelativeSource AncestorType={x:Type Canvas}}, 
                Path=DataContext.SomeColorProperty}" 
```

这应该在您的 VisualTree 中查找最近的`Canvas`对象，这将是 中使用的对象，`Itemcntrl12`并且它将绑定到它的`DataContext`，这应该是您的第一个数据项`ItemsControl`。

如果您想上一层并绑定到第一个`ItemsControl`( `Itemcntrl10`) 的属性，您可以使用`AncestorLevel`绑定的属性来指定第二个 Canvas 而不是第一个。

# android - 使用 Python 进行移动应用程序开发时的挑战

> ID：16082586
> 
> 赞同：3
> 
> 时间：2013-04-18T12:09:54.493
> 
> 标签：android, python, ios, mobile, windows-phone

在过去的几个月里，我一直在通过 Python 学习编程，并且我已经涵盖了几乎所有的基础知识，而没有深入了解任何一个概念。

我现在想知道的是从哪里开始，我主要对移动设备上的应用程序开发感兴趣。

所以：

1.  最好的语言是什么，或者有充分的理由继续使用 python？

2.  我已经尝试过 Kivy 和 Python-for-android，它们在我现在的基本水平上运行良好，但是那里有经验的人如何看待使用 python 开发应用程序而不是使用其他语言（如 java 等）的局限性..？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T12:21:56.897

我认为对于使用 Python 和当前移动生态系统（iOS、Android）的“生产级”移动应用程序来说，有两个问题不容易克服

*   由于运行过长的动态模块导入堆栈，Python 应用程序启动缓慢。当您的应用程序变得复杂时，您基本上会碰壁。

*   Python 不能很好地集成到现有的应用程序打包模型中，这使得它总是比“纯”原生应用程序开发更棘手。最终，您需要混合并掌握原生开发和 Python 开发，从而为处理堆栈增加了额外的复杂性。

这是我很久以前写的一篇文章，但仍然适用[http://opensourcehacker.com/2008/02/21/building-commercial-grade-mobile-applications-with-python-for-series-60/](http://opensourcehacker.com/2008/02/21/building-commercial-grade-mobile-applications-with-python-for-series-60/)

不确定 Windows Phone 和 IronPython 如何协同工作。或者 IronPython 与 MonoTouch 或 MonoDroid。

有一些基于 JavaScript 的应用程序开发的成功案例，例如 Appcelerator，但这些案例有很多资金支持它们来平滑粗糙的边缘[http://www.appcelerator.com/developers/](http://www.appcelerator.com/developers/)

如果您不喜欢 Java 和 Objective-C 并且仍想在专业水平上进行移动开发，我建议您查看 C# 和 Xamarin 工具[http://xamarin.com/](http://xamarin.com/)

# xml - XSLT 执行身份转换并使用转换后的数据

> ID：16082588
> 
> 赞同：0
> 
> 时间：2013-04-18T12:09:57.127
> 
> 标签：xml, xslt

仍在摆弄 XSLT。通过使用 id-transformation 更改了我的解决方案方法，但无法退出，如何直接使用转换后的项目（如果可能）

源是两个列表，它们将通过 id-transformation 组合在一起。映射列表转换后的 xml，项目被导入到 $items 变量中。

```
<mapping>
    <sub id="1" item="a" group="a">
    <sub id="2" item="b" group="a">
    <sub id="3" item="d" group="b">
    <sub id="4" item="e" group="b">
    <sub id="5" item="f" group="c">
</mapping>

<items>
    <item id="a" val="OK"/> 
    <item id="b" val="ERROR"/>
    <item id="c" val="OK"/>
    <item id="d" val="OK"/>
    <item id="e" val="OK"/>
    <item id="f" val="OK"/>
</items> 
```

使用 id-transformation，我将子节点更改为 NewItem-nodes，从第二个列表中添加信息并添加所需的属性。

```
<xsl:template match="node() | @*">
    <xsl:copy>
        <xsl:apply-templates select="node() | @*"/>
    </xsl:copy>
</xsl:template>

<xsl:template match="sub">
    <xsl:element name="NewItem">
        <xsl:apply-templates select="@*"/>
        <xsl:apply-templates select="$items/item[@id = ./@item]/@group"/>
    </xsl:element>
</xsl:template> 
```

但在那之后，我似乎无法对生成的 NewItem 节点做任何事情。使用模板，按类型选择它们，没有任何效果，真的只能生成输出，而不是进一步处理吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:56:37.413

在 XSLT 1.0 中，如果您创建一个包含节点的变量，它就是一个结果树片段，您所能做的就是 do`xsl:copy-of`或`xsl:value-of`. 如果您想进一步处理或选择结果树片段中的节点，那么您需要使用扩展功能，`exsl:node-set`例如，如果您有`<xsl:variable name="items"><NewItems><xsl:apply-templates/></NewItems></xsl:variable>`并且想要将模板应用于您需要的结果树片段中的节点

```
<xsl:apply-templates select="exsl:node-set($items)/NewItems/NewItem"/> 
```

您在样式表中绑定的位置`xmlns:exsl="http://exslt.org/common"`。但是请注意，对于可移植样式表，您可能需要检查 XSLT 处理器的文档，它是否支持`node-set`EXSLT 命名空间中的函数或不同的函数（如 MSXML），在这种情况下，您需要检查`function-available`支持哪个函数并且编写`xsl:choose`检查以确保在`apply-templates`.

如果您可以迁移到 XSLT 2.0 处理器，您会发现限制已经消失，您可以像使用主输入树一样使用 XSLT 2.0 中的任何临时树，而无需使用任何扩展函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:50:53.897

使用 xslt version=1.0，您可以使用扩展名“未设置”。将新生成的内容放入变量中并使用它

```
 <xsl:apply-templates select="exsl:node-set($NewItem_var) /> 
```

要让它醒来，您必须添加以下行。

```
<xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
    xmlns:exsl="http://exslt.org/common"
    extension-element-prefixes="exsl"
    version="1.0"> 
```

# java - 文件已创建但返回 false

> ID：16082590
> 
> 赞同：1
> 
> 时间：2013-04-18T12:10:01.940
> 
> 标签：java, android, file, exists, creation

我不明白为什么我们不进入第二个 if。我首先检查文件是否存在（不，逻辑），然后创建它，然后再次检查，但它仍然返回 false。我试了一个小时才找到问题，我确信这是一个愚蠢的错误。对不起我糟糕的英语

这是代码：

```
package com.example.testcreatefileonclick;

import java.io.File;
import java.io.FileOutputStream;
import java.io.OutputStreamWriter;
import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class Main extends Activity implements android.view.View.OnClickListener{

    Button button;
    Button addTeam;
    Boolean append = true;

    String name = "nomFichier.txt";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        button = (Button)findViewById(R.id.button1);
        button.setOnClickListener((OnClickListener) this);
        addTeam = (Button)findViewById(R.id.button2);
        addTeam.setOnClickListener((OnClickListener) this);

    }

    @Override
    public void onClick(View v) {
        try {
            File fichier = new File(name);

            if (!fichier.exists()) {
                System.out.println("File doesn't exists");
            }

            FileOutputStream fOut = openFileOutput(name, MODE_WORLD_READABLE);
            OutputStreamWriter osw = new OutputStreamWriter(fOut); 
            osw.write("text");
            osw.flush();
            osw.close();

            //Why don't we go in this if ?
            if (fichier.exists()) {
                System.out.println("File exists");
            }

        } catch (Exception e) {
            // TODO: handle exception
        }
    }
} 
```

编辑：工作代码

```
package com.example.testcreatefileonclick;

import java.io.File;
import java.io.FileWriter;
import java.io.IOException;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;

public class Main extends Activity implements android.view.View.OnClickListener{

    Button button;
    Button addTeam;
    Boolean append = true;
    String name = "nomFichier.txt";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        button = (Button)findViewById(R.id.button1);
        button.setOnClickListener((OnClickListener) this);
        addTeam = (Button)findViewById(R.id.button2);
        addTeam.setOnClickListener((OnClickListener) this);

    }

    @Override
    public void onClick(View v) {
        try {
            String filePath = (this.getFilesDir().getPath().toString());
            File fichier = new File(filePath + name);

            if (!fichier.exists()) {
                System.out.println("File doesn't exists");
            }

            fichier.createNewFile();
            FileWriter file = new FileWriter(filePath + name);
            file.write("text");
            file.flush();
            file.close();

            if (fichier.exists()) {
                System.out.println("File exists");
            }

        } catch (IOException e) {
            System.out.println("Exception");
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:20:41.523

尝试替换这个：

```
FileOutputStream fOut = openFileOutput(name, MODE_WORLD_READABLE);
        OutputStreamWriter osw = new OutputStreamWriter(fOut); 
        osw.write("text");
        osw.flush();
        osw.close(); 
```

这样 ：

```
fichier.createNewFile();
FileWriter file = new FileWriter(name);
file.write("text");
file.flush();
file.close(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:17:30.017

```
// Why don't we go in this if ? 
```

最可能的原因（IMO）是`openFileOutput(name, MODE_WORLD_READABLE)`引发异常。

如果发生这种情况，您将不会因为这段骇人听闻的代码而知道它。

```
 } catch (Exception e) {
        // TODO: handle exception
    } 
```

为什么骇人听闻？

1.  您正在捕获`Exception`而不是您*希望*抛出的特定异常（例如`IOException`）。
2.  您正在“挤压”异常。你接住它，然后*默默地*扔掉它。

这些事情中的每一个都是*不好的做法*。一起做是......好吧......你*应该*为此浪费一个小时！

* * *

如果我对压扁异常的诊断不正确，那么还有另一种可能性。文档`openFileOutput`说：

> *“打开与此上下文的应用程序包关联的私有文件进行写入。”* .

目前尚不完全清楚该文件将在何处打开/创建，但有可能它位于与`File.exists`正在查找的位置不同的“位置”。您会注意到它`openFileOutput`不会将`File`对象作为其输出。

* * *

最后，还有一个更微妙的问题，在这种情况下不会伤害你，但*在*其他情况下会伤害你。你写了 ...

```
 if (!fichier.exists()) {
            System.out.println("File doesn't exists");
        }
        FileOutputStream fOut = openFileOutput(name, MODE_WORLD_READABLE); 
```

问题在于存在竞争条件。在调用`exists`和调用之间`openFileOutput`，有一个小的时间窗口，其他应用程序可以在其中跳入并创建文件。因此，当您再调用时`openFileOutput`，它可能会发现该文件已经创建。

显然，在这种情况下，它没有任何区别。但在其他情况下可能会。教训是调用`File.exists()`,`File.canWrite`等等来“保护”以下创建/打开文件的尝试是不可靠的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:18:51.690

如果不是下面的异常问题，它可能正在缓存您第一次调用 exists 方法的结果（不太可能）。您可以在调用后尝试创建一个新的文件对象来测试它。

如果我愿意，我将使用 createNewFile 方法，该方法将返回一个布尔值供您在逻辑中使用。如果存在，这将比必须询问 IO 两次要好。

```
public boolean createNewFile() throws IOException 
```

# c - 如何将整数值导出到c中的环境变量

> ID：16082593
> 
> 赞同：2
> 
> 时间：2013-04-18T12:10:05.163
> 
> 标签：c, environment-variables

我试过下面的程序将值导出到环境变量。我想将一个整数值导出到环境变量。下面的程序将值作为“a”而不是 1。如何将整数值导出到该环境变量。

```
#include<stdio.h>

void chnge_env_var(int a)
{
    char *name1="ENV_VAR";
    char *val=NULL;
    int status;
    status = putenv("ENV_VAR=a");
    printf("status %d\n",status);
    val = getenv(name1);
    printf("val %s\n",val);
}

int main()
{
    int a=1;
    chnge_env_var(a);
return 0;
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T12:12:56.150

环境只能保存字符串值。要存储整数，您必须将其转换为字符串然后存储。阅读时，您可以将字符串转换回整数。

```
int a = 10;
char env_var[20]; // length of 'ENV_VAR=' plus 12
sprintf(env_var, "ENV_VAR=%d", a);
putenv(env_var); 
```

正如“代码小丑”指出的那样，`snprintf`如果您不确定缓冲区的大小是否正确，则可以使用它：

```
snprintf(env_var, 20, "ENV_VAR=%d", a); 
```

# java - ephesoft 中不存在 webscanner.nocache.js

> ID：16082598
> 
> 赞同：1
> 
> 时间：2013-04-18T12:10:17.900
> 
> 标签：java, open-source, alfresco

我已经在我的系统上安装了 ephesoft 社区版本并尝试使用网络扫描仪。但是当我单击 webscaner 选项卡时，它会显示空白页和控制台错误，即

“网络错误：404 未找到 - 本地主机：8082/dcma/webscanner/webscanner.nocache.js”

.

我已经从 [https://code.google.com/p/ephesoft/](https://code.google.com/p/ephesoft/)下载了 epchesoft 的源代码， 并尝试在源代码文件夹中搜索 webscanner.nocache.js 并没有找到任何东西。

有什么解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-29T11:15:06.693

基于 Web 的扫描模块仅包含在企业版中。请参见下面的 url [Ephesoft 企业版和 Ephesoft 社区版比较](http://ephesoft.com/products/on-premise)

# ios - 像 UITableView 设计一样多列的可能方法。？

> ID：16082602
> 
> 赞同：1
> 
> 时间：2013-04-18T12:10:23.977
> 
> 标签：ios, ipad, uitableview, master-detail

我浏览了很多网站。但我没有办法实现它。到目前为止，我开始知道使用 UITableView 我们需要使用一些代码和一些自定义设计（如 GridView 等）来制作自定义单元格

> [https://github.com/tanin47/UIGridView](https://github.com/tanin47/UIGridView) [这里可以修改，但我实际上是在 1 个类文件中寻找]。

. 这实际上是我需要像下图那样进行设计。![在此处输入图像描述](https://i.stack.imgur.com/dFboU.png)

到目前为止，我已经使用[THIS LINK](http://www.mindfiresolutions.com/Grid-View-in-IPhone-using-UITableView-1665.php)完成了。但这对我没有用。

如果有人知道，请分享您的想法，任何帮助或建议都应该是可观的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:36:50.833

您可以创建自己的自定义 UITableViewCell 并以包含多个 UIButtons 水平排列并由分隔符图像分隔的方式对其进行设计。这里每个 UIButton 将代表一个单独的列，并且必须添加不同的选择器方法作为单元格内不同按钮的目标。在不同行中垂直对齐的 UIButton 必须具有相似的 Selector。为了区分按钮，您可以将它们的标签设置为相应行的 indexPath.row 。

我希望这可以解决你的问题:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T12:15:56.430

如果您正在寻找类似网格的视图，您可以很好地使用 UICollectionView 并对设计进行一些调整。

# java - docx4j 以错误的 html 格式转换 docx

> ID：16082612
> 
> 赞同：0
> 
> 时间：2013-04-18T12:10:51.220
> 
> 标签：java, html, docx, docx4j

我对 docx4j 样本有一些问题。我需要将 docx 中的文件转换为 html 格式并返回。我正在尝试编译 ConvertInXHTMLDocument.java 示例。它创建的 Html 文件很好，但是在尝试将其转换回 docx 时，会引发缺少关闭标记（META、img 等）的异常。有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T23:05:01.333

XHTMLImporter 要求其输入是格式良好的 XML。所以你需要确保你没有丢失关闭标签（META、img 等）；如果你这样做，请先运行 JTidy 或类似的。

docx4j 的 (X)HTML 输出可以是 HTML 或 XML。从 3.0 开始，属性 Convert.Out.HTML.OutputMethodXML 将控制哪个。

# windows-installer - 想要为 .net 应用程序创建一个将嵌入第三方工具的 msi

> ID：16082614
> 
> 赞同：-2
> 
> 时间：2013-04-18T12:10:53.083
> 
> 标签：windows-installer

想要为 .net 应用程序创建一个将嵌入第三方工具的 msi。

在执行此 msi 时，它应该复制所有文件，然后它应该启动第三方工具的安装程序并等待它完成，然后启动另一个第三方工具的安装程序并再次等待它完成然后完成安装。

这可能吗？如果是，如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:49:03.727

Windows-Installer 是一个 SDK、规范和安装服务，它是 Windows 的一部分。它不是真正的创作工具/套件。

您应该看看 WiX 和 InstallShield 等工具。两者都可以创建 MSI，并且都可以将 MSI / EXE 包链接在一起。WiX 将其称为 Burn，InstallShield 将其称为 Suite 安装程序。

# ruby-on-rails - Rails 的 QueryObject - 如何封装 ActiveRecord 上的一组操作

> ID：16082615
> 
> 赞同：4
> 
> 时间：2013-04-18T12:10:53.210
> 
> 标签：ruby-on-rails, activerecord

如何封装一组操作（其中大部分本质上是 .where(...)）并将其应用于不同的模型，以使某些模型可能无法实现某些操作并应返回空集合。（非必要代码跳过）

我设计的（但不满意）：

```
class ActivityFinder

  def self.find(query, limit = nil)
    activities = get_activities(query)
    activities = activities.sort_by(&:created_at).reverse // some-kind of merge-sort
    activities = activities.slice(0, limit) if limit.present?
    activities
  end

  private

  def self.get_activities(query)
    activities = []
    activities += query.apply(ModelA)
    activities += query.apply(ModelB)
    activities += query.apply(ModelC)
    activities
  end
end

class ActivityQuery

  def created_before(time)
    @created_before = time
    self
  end

  def created_after(time)
    @created_after = time
    self
  end

  def apply(activity)
    activity = activity.where("#{activity.table_name}.created_at < ?", @created_before) if @created_before.present?
    activity = activity.where("#{activity.table_name}.created_at >= ?", @created_after) if @created_after.present?
    // more operations, not all of them are suported by ModelC
  rescue NoMethodError
    return []
  end
end 
```

用法

```
query = ActivityQuery.new.created_before(last_time).with_hash(...)
activities = ActivityFinder.find(query) 
```

我不喜欢的：

*   NoMethodError 的救援
*   如果不同的模型对字段有不同的名称，则必须将其作为`case`查询中的语句处理，以这种方式将查询对象与每个模型耦合

所以我正在寻找更好实施的建议

**更新**

问题是我想传递从 ActiveModel 获得的任何对象，例如 ActiveRecord::Relation，所以我不能只用方法定义模块（并在需要时覆盖）并将其包含在我正在使用的模型中. 问题更多的是为干净的设计指明正确的方向，而不是关于实现细节，我会以某种方式弄清楚

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:34:28.747

为避免紧密耦合，请将模型特定代码放入模型中：

```
class ModelA < ActiveRecord::Base
  scope :created_before, ->(timestamp) { where("created_at < ?", timestamp) }
  scope :created_after, ->(timestamp) { where("created_at >= ?", timestamp) }
  scope :with_hash, ->(hash) { ... }
end

class ModelB < ActiveRecord::Base
  scope :created_before, ->(timestamp) { where("other_column < ?", timestamp) }
  scope :created_after, ->(timestamp) { where("other_column >= ?", timestamp) }
  scope :with_hash, where('false') # empty, chain-able collection
end 
```

现在你有了一个一致的接口，你可以针对它进行编程：

```
class ActivityQuery

  def apply(activity)
    activity = activity.scoped
    activity = activity.created_before(@created_before) if @created_before.present?
    activity = activity.created_after(@created_after) if @created_after.present?
    activity = activity.with_hash(@hash) if @hash.present?
    activity
  end

end 
```

无需拯救`NoMethodError`，也无需再摆弄模型的实现细节。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:19:53.337

您可以使用 ActiveRecord::Base#column_names

```
class Goodstuff < ActiveRecord::Base
  def self.find_x_greater_than_y(x,y)
    if (scope_attributes + column_names).inlcude?(x)
      where('x > y')
    else
      []
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-13T18:17:00.860

如果你想封装你的查询对象，我编写了一个微型库，它可以非常简单地将复杂的查询逻辑移到你的模型和控制器之外。

[https://github.com/ElMassimo/queryable](https://github.com/ElMassimo/queryable)

它负责使您的范围可链接，并委托方法如 each 并映射到实际查询。

您可以创建一个基础对象，在其中定义可用操作（或救援`NoMethodError`），然后在需要修改或更改任何范围时扩展查询对象。

```
ActivityFinder.find { |activities|
  activities.created_before(last_time).with_hash(...)
}

class ActivityQuery
  include Queryable::ActiveRecord

  # You can define the scopes as simple methods, which you can override in
  # subclasses.
  def created_before(time)
    where("created_at < ?", time)
  end

  # Rails-style scope syntax is also available
  scope(:created_after) { |time| where("created_at >= ?", time) }

  # You can add more methods to the query interface that just return self,
  # or none and then implement them in the more specific query subclasses.
  def with_hash(*args, &block)
    none
  end
end

class ModelAQuery < ActivityQuery
  # You can specify the collection that the query object works with by default.
  queryable ModelA

  # You can override a method defined in the superclass, since the scopes are
  # plain methods you could also share them with mixins.
  def created_before(time)
    where("measured_at < ?", time)
  end

  def with_hash(hash)
    where("timestamp = ?", hash[:timestamp])
  end

  # ...
end

# To solve that particular case you could pass a block to the find method
# and build the query.
class ActivityFinder
  ACTIVITIES = [ModelAQuery, ModelBQuery, ...]

  def self.find(limit=nil, &block)
    activities = get_activities(&block)
    # ...
  end

  def self.get_activities
    ACTIVITIES.map { |query_class| yield query_class.new }.flatten
  end
end 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-22T13:24:50.400

最初的想法是创建一些代理对象并将方法执行推迟到实际应用。我用更传统的方法做到了，每个操作都创建一个标准对象（在我的例子中，它称为 QueryOperation）并在稍后阶段应用。仍然存在相同的功能问题，但代码更清晰

```
class ActivityQuery

  def initialize
    @operations = []
    @operations.push(QueryOperationOrderBy.new('created_at', 'DESC'))
  end

  def for_user(user)
    @user = user
    self
  end

  def with_hash(hash)
    @operations.push(QueryOperationFindByHash.new(hash)) unless hash.blank?
    self
  end

  def limit(limit)
    @operations.push(QueryOperationLimit.new(limit))
    self
  end

  def created_before(time)
    @operations.push(QueryOperationLessThan.new('created_at', time))
    self
  end

  def created_after(time)
    @operations.push(QueryOperationGreaterThan.new('created_at', time))
    self
  end

  def apply(activity)
    @operations.each do |operation|
      activity = operation.apply(activity)
    end

    activity
  rescue NoMethodError
    return []
  end
end 
```

# winapi - 从 Excel XLL 创建小型转储

> ID：16082617
> 
> 赞同：1
> 
> 时间：2013-04-18T12:11:02.003
> 
> 标签：winapi, dll, crash

我有一个 Excel XLL 插件，它会在某些计算机上使 Excel 崩溃。为了排除故障，我在以下位置添加了此调用`DllMain`：

```
SetUnhandledExceptionFilter(MyExceptionFilter); 
```

和过滤器本身：

```
LONG WINAPI MyExceptionFilter(struct _EXCEPTION_POINTERS *lpTopLevelExceptionFilter) 
```

但是过滤器永远不会在崩溃时被调用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-17T15:58:55.957

这是一个老问题，但以防万一这可以帮助其他人：`SetUnhandledExceptionFilter()`设计不支持使用内部 XLL，引用来自[http://www.office-forums.com/threads/setunhandledexceptionfilter-in-的 Microsoft 员工 Jie Wang office-addin.2164345/](http://www.office-forums.com/threads/setunhandledexceptionfilter-in-office-addin.2164345/)

> 您观察到的行为是设计使然。
> 
> 第 3 方插件/dll 无法为 Office 2007 应用程序设置未处理的异常过滤器（至少不以受支持的方式）。MSO.DLL 明确设置过滤器本身，然后覆盖 API 以防止第 3 方在 MSO 设置过滤器后更改过滤器。它对所有 Office 应用程序（不仅仅是 Outlook）都是通用的。

因此，唯一官方支持的从 Excel 获取故障转储的方法是使用[WER](https://msdn.microsoft.com/en-us/library/bb513641.aspx)。

然而，在实践中，使用 MSVC 特定的`_set_se_translator()`功能确实有效。但它必须从所有应用程序线程中调用，这与 process-global 不同`SetUnhandledExceptionFilter()`。

# android - 检查标记是否在圆半径内

> ID：16082622
> 
> 赞同：15
> 
> 时间：2013-04-18T12:11:09.740
> 
> 标签：android, google-maps, android-maps-v2

我想知道给定的标记是否在圆半径内。

在 javascript 中，我可以执行以下操作：

```
google.maps.geometry.spherical.computeDistanceBetween(latLngCircleCenter, latLngPoint); 
```

但是在android中，使用maps-v2，我被卡住了。

![在此处输入图像描述](https://i.stack.imgur.com/E44Dz.jpg)

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2013-04-18T17:26:01.790

After a lot of research, i found a very simple solution:

```
float[] distance = new float[2];

Location.distanceBetween( marker.getPosition().latitude, marker.getPosition().longitude,
    circle.getCenter().latitude, circle.getCenter().longitude, distance);

if( distance[0] > circle.getRadius()  ){
    Toast.makeText(getBaseContext(), "Outside", Toast.LENGTH_LONG).show();
} else {
    Toast.makeText(getBaseContext(), "Inside", Toast.LENGTH_LONG).show();
} 
```

I'm testing this and it's working. Can someone test too and give the feedback here?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-11T10:46:34.330

您在 Javascript 中使用的相同 API 可在此处用于 Android：[https ://github.com/googlemaps/android-maps-utils/blob/master/library/src/com/google/maps/android/SphericalUtil.java](https://github.com/googlemaps/android-maps-utils/blob/master/library/src/com/google/maps/android/SphericalUtil.java)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:30:10.040

我认为可以找到圆的中心，您正在代码中定义与给定地理点相关的圆。您可以保存并稍后使用。然后尝试[Location.distanceBetween(..)](http://developer.android.com/reference/android/location/Location.html#distanceBetween%28double,%20double,%20double,%20double,%20float%5B%5D%29)

# file - 在网络服务器上处理数百万张照片

> ID：16082625
> 
> 赞同：0
> 
> 时间：2013-04-18T12:11:12.790
> 
> 标签：file, storage, social-networking

我正在设计一个社交网络。我有很多关于设计方法和数据库设计的问题，但根据 stackoverflow 的常见问题解答，最好将问题具体化和集中化。或者我将在一篇文章中列出所有问题。我的问题是：如果您在社交网络中有用户可以创建相册的功能，假设每个用户有 3 个相册，每个相册包含 10 张照片，这意味着每个用户有 30 张照片，每张照片将以 3 种不同尺寸存储大、中、小。

30 张照片 x 200000 个用户 = 6 000 000 M 张照片。这意味着数据库中的 6000 亿行对 MySQL 来说不是问题

**现在我的主要问题是如何让服务器处理图像数据。您是将它们分成文件夹还是简单地将它们全部添加到一个文件夹中……..任何专家都面临过这个问题。请提出建议……谢谢……？**

规格

MYSQL DB PHP 前 6 个月共享 Linux 主机。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:15:59.557

我不会为此任务使用经典文件系统。分层文件存储存在固有限制（文件夹深度、文件夹中的文件数、名称、会崩溃的自动索引等）。

直接在数据库中使用一些 blob。Bing Map 正在将他的所有数据存储到 blob 中；几张图片。

除此之外，这是在 Microsoft SQL 服务器上运行的，使用 mysql 你需要一些配置技巧。

# dojo - 如何使用 Dojo 动态创建 SwapView

> ID：16082627
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:11:20.290
> 
> 标签：dojo, ibm-mobilefirst

我正在使用带有 Worklight 的 Dojo v1.8；我想在 View 中动态创建一个 SwapView，但是我遇到了问题......

**HTML 代码：**

```
<div data-dojo-type="dojox.mobile.View" id="listeInscriptionView"
            data-dojo-props="selected:false,scrollDir:'vh'"
            style="background-image: url('images/bg-texture.jpg');" 
                            data-dojo-id="id">
    </div> 
```

**JavaScript 代码：**

```
var view = registry.byId(listeInscriptionView);
    alert(view);

    for(var i = 1; i < 3; i++ ){
        var swap = new dojox.mobile.SwapView({
            id: i, 
            selected:false 
        });

        var head = new dojox.mobile.Heading({
            label:'Swap' + i,
        });
        swap.addChield(head);
        view.addChield(swap);
        alert("test" + i);
    } 
```

以上不起作用。如何动态创建小部件 SwapView？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:47:38.227

那是您实际代码的副本吗？我还没有实际测试过，但有语法错误和拼写错误：

```
registry.byId(listeInscriptionView); 
```

应该

```
registry.byId("listeInscriptionView"); 
```

（缺少引号），和

```
swap.addChield(head);
view.addChield(swap); 
```

应该

```
swap.addChild(head);
view.addChild(swap); 
```

也许修复了这些错误会更好？

# linux - Linux - 数字排序然后覆盖文件

> ID：16082628
> 
> 赞同：5
> 
> 时间：2013-04-18T12:11:22.113
> 
> 标签：linux, sorting, awk

我有一个通用格式的 csv 文件

```
date,  
2013.04.04,
2013.04.04,
2012.04.02,
2013.02.01,
2013.04.05,
2013.04.02, 
```

我运行的脚本会将数据添加到该文件中，这些数据不一定按日期顺序排列。如何将文件按日期顺序排序（忽略标题）并覆盖现有文件而不是写入 STDOUT

我用过awk

```
awk 'NR == 1; NR > 1 {print $0 | "sort -n"}' file > file_sorted
mv file_sorted file 
```

有没有更有效的方法可以在不创建额外文件和移动的情况下做到这一点？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-18T12:17:50.717

您可以执行以下操作：

```
sort -n -o your_file your_file 
```

`-o`定义输出文件[并由 POSIX 定义](http://pubs.opengroup.org/onlinepubs/9699919799//utilities/sort.html)，因此可以安全使用（没有原始文件损坏）。

**输出**

```
$ cat s
date,  
2013.04.04,
2013.04.04,
2012.04.02,
2013.02.01,
2013.04.05,
2013.04.02,

$ sort -n -o s s

$ cat s
date,  
2012.04.02,
2013.02.01,
2013.04.02,
2013.04.04,
2013.04.04,
2013.04.05, 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T12:20:33.217

请注意，如果脚本和排序同时运行，则存在竞争条件。

如果文件头在数据之前排序，您可以使用*fedorqui*建议的`sort -o file file`安全解决方案（至少使用 GNU 排序，请参阅参考资料`info sort`）。

`sort`从内部运行`awk`似乎有点复杂，另一种选择是使用`head`and `tail`（假设 bash shell）：

```
{ head -n1 file; tail -n+2 file | sort -n; } > file_sorted 
```

现在，关于替换现有文件。AFAIK，你有两个选择，创建一个新文件并用你在问题中描述的新文件替换旧文件，或者你可以像这样`sponge`使用`moreutils`：

```
{ head -n1 file; tail -n+2 file | sort -n; } | sponge file 
```

请注意，`sponge`仍然会创建一个临时文件。

# c# - 使用预先存在的 RSA SSH 密钥解密 C# 中的文本

> ID：16082636
> 
> 赞同：1
> 
> 时间：2013-04-18T12:11:53.113
> 
> 标签：c#, encryption, rsa, bouncycastle, openssh

我有一对由 Linux 计算机中的 'ssh-keygen' 命令生成的 RSA 公钥/私钥。这台 Linux 计算机中有一个 Ruby 应用程序，它使用这个公钥加密一个字符串，我想用这个私钥解密一个 Windows C#/.Net 应用程序中的字符串。我看了一下 Bouncy Castle 库，但没有成功。任何示例或提示都会有所帮助。谢谢！

* * *

## 回答 #1

> 赞同：-3
> 
> 时间：2013-04-18T12:27:17.773

有理由使用 ssh 密钥吗？

任何 RSA 密钥都足够了。您需要提取 RSA 密钥来加密任何内容。如果该密钥不是 RSA，则您无法加密任何内容，因为 DSA 是仅签名算法。有公钥的 RFC：[http](http://www.ietf.org/rfc/rfc4716.txt) ://www.ietf.org/rfc/rfc4716.txt这不是您所需要的。但可能会帮助您了解如何提取每个部分。它应该只是 base64 编码的二进制块。

您可以尝试 PuTTY 源[http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html](http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html) keygen 可以生成和转换这些密钥。所以，如果你找到它提取 RSA 密钥的地方。然后使用任何加密库使用密钥和数据计算 RSA。使用正确的键，您将获得输入数据 + 填充。取决于 ruby​​ 程序使用的是公钥还是私钥。希望有帮助。

# javascript - 替代cordova.addConstructor？

> ID：16082637
> 
> 赞同：0
> 
> 时间：2013-04-18T12:11:55.167
> 
> 标签：javascript, cordova, phonegap-plugins

我正在使用 PhoneGap 插件，像这样注册自己

```
// Register the plugin

cordova.addConstructor(function () {
  window.pushNotification =  new PushNotification();
}); 
```

我需要在 2.5.0 版本中使用 CORDOVA，所以据我所知，cordova.addConstructor( 已在版本中删除。

哪个 API 更合适，而不是考虑必须与 CORDOVA VERSION 2.1.0 兼容的内容？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T18:49:47.047

您不再需要使用 addConstructor，只需执行以下操作：

```
 if (!window.plugins) {
            window.plugins = {};
        }
        window.plugins.pushNotification = new PushNotification(); 
```

或者我猜因为你似乎没有使用插件对象，只是 `window.pushNotification = new PushNotification()`

我在 2.0 和 2.5 上使用模拟应用程序对此进行了测试，并且两者都有效。

尽管您要求使用 2.5，但我只想指出，当您更新此插件以与 2.6 一起使用时，[建议将您的插件包装在一个模块](https://github.com/phonegap/phonegap-plugins/wiki/Defining-Your-Cordova-Plugin-As-A-Cordova-Module)中。

# php - 试图传递多维数组以使用 Codeigniter 查看？

> ID：16082640
> 
> 赞同：-2
> 
> 时间：2013-04-18T12:11:57.217
> 
> 标签：php, arrays, codeigniter, multidimensional-array

简单的事情，但我的大脑被阻塞了，我无法解决。这是在控制器中构建数组的内容：

```
foreach ($rows as $row)
{
  $slugs[] = $row->slug;
}

$data['slugs'] = $slugs;
print_r($data['slugs']); //returns array fine 
```

获取视图：

```
$this->load->view('pickcasino', $data); 
```

这在视图中不起作用：

```
print_r($slugs); 
```

我如何让它工作？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-18T12:30:40.170

你能检查一下`$this->load->view('pickcasino',$data);` 加载视图可能有问题吗

# android - Android SQLite 快速搜索之间的日期

> ID：16082641
> 
> 赞同：0
> 
> 时间：2013-04-18T12:11:57.267
> 
> 标签：android, database, performance, sqlite, date

当涉及到带有日期范围的 SQLite 查询时，我遇到了一个巨大的性能问题。

在我的应用程序中，我有一个包含数千条站点记录的数据库。这些网站是可访问的，但不是全年。这些站点中的每一个都可以定义最多三个可访问的范围。因此，我创建了一个包含以下列的 SQLite 表：*open1*、*close1*、*open2*、*close2*、*open3*和*close3*（以及其他）

应用程序用户可以输入他们想要访问站点的时间范围，例如 2014.01.01 - 2014.01.07

现在，当我在不限制时间的情况下执行搜索时，它非常快。但是当我使用打开时间作为搜索条件时，在快速模拟器上搜索最多需要 7 秒。我什至不想在真实设备上测试这个:)

*打开*和*关闭*列中的条目的类型为*DATETIME*，如下所示：*2014-01-01*

我目前的查询如下：

```
 SELECT open1,close1,open2,close2,open3,close3 FROM sites WHERE (
      ( ( strftime('%Y-%m-%d', '2014-01-01') BETWEEN open1 AND close1 ) AND ( strftime('%Y-%m-%d', '2014-01-07') BETWEEN open1 AND close1 ) )
      OR
      ( ( strftime('%Y-%m-%d', '2014-01-01') BETWEEN open2 AND close2 ) AND ( strftime('%Y-%m-%d', '2014-01-07') BETWEEN open2 AND close2 ) )
      OR
      ( ( strftime('%Y-%m-%d', '2014-01-01') BETWEEN open3 AND close3 ) AND ( strftime('%Y-%m-%d', '2014-01-07') BETWEEN open3 AND close3 ) )
    ) 
```

有没有简单的方法来提高性能？

注意：我尝试使用*长*格式的 utc 值进行*打开*和*关闭*，但这并不是真正可调试的。

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:26:55.393

我不确定它是否更有效，但简化查询并没有什么坏处：

```
( ( strftime('%Y-%m-%d', '2014-01-01') BETWEEN open1 AND close1 ) AND ( strftime('%Y-%m-%d', '2014-01-07') BETWEEN open1 AND close1 ) ) 
```

相当于：

```
( strftime('%Y-%m-%d', '2014-01-01') >= open1 AND strftime('%Y-%m-%d', '2014-01-07') <= close1 ) 
```

只要第一个日期（在这种情况下为“2014-01-01”）在第二个日期（“2014-01-07”）之前，即您有：

`open*`<= `first`<= `second`<=`close*`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:17:12.383

首先，您会发现真实设备的性能比模拟器好得多。

现在，进入问题的真正实质。`WHERE`您应该尝试为子句（`open1`、`close1`等）中使用的那些列创建索引。你可以找到很多关于如何做到这一点的教程。简而言之，索引帮助数据库引擎快速找到匹配的记录。

尝试类似：

```
CREATE INDEX visitableIndex ON sites (open1, close1, ...) 
```

# java - 可以制作数组的数组吗？

> ID：16082645
> 
> 赞同：-6
> 
> 时间：2013-04-18T12:12:05.647
> 
> 标签：java

是否可以制作数组的数组？我要做的基本上是制作一个没有重复的另一个数组的数组。

例如：

```
String[] colour ={"blue","blue","red","blue","red","red","orange","yellow","purple","green","blue"}; 
```

然后从 String[] color 创建一个新数组：

```
String[] uniqueColour = {"blue","red","orange","yellow","purple","green"} 
```

使用函数而不只是声明它？原因可以说我更改了 String[] Color 的所有值并将其变成

```
String[] Fruits = {"Apple","Banana","Orange","Tomato","Apple","Banana"} 
```

然后不做或改变任何其他功能应该创建

```
String[] uniqueColour ={"Apple","Banana","Orange","Tomato"} 
```

这样的事情存在吗？抱歉，添麻烦了。我也是java新手。

感谢任何可以贡献或帮助我的人。

编辑：好的，使用这个： - 感谢Doorknob的回答

```
Set<String> uniqueSet = new HashSet<String>(Arrays.asList(colour));
String[] uniqueColours = uniqueSet.toArray(new String[0]); 
```

然后我将如何尝试将其显示为：

```
Blue
Red
Yellow
Green
Purple
ect 
```

代替`[Blue,Red,Yellow,Green,Purple,etc]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:15:52.197

使用 a`Set`删除重复项：

```
Set<String> uniqueSet = new HashSet<String>(Arrays.asList(colour));
String[] uniqueColours = uniqueSet.toArray(new String[0]); 
```

要以您想要的方式显示它：

```
for (String s : uniqueColors) System.out.println(s); 
```

# iphone - UIRefreshControl 在横向模式下不工作

> ID：16082649
> 
> 赞同：0
> 
> 时间：2013-04-18T12:12:07.873
> 
> 标签：iphone, objective-c, ios6, uirefreshcontrol

**我的工作代码：**

```
-(void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
    if (self.collectionView.contentOffset.y < -80 && ![self.pullDownRefreshControl isRefreshing])
    {
        [self.pullDownRefreshControl beginRefreshing];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:25:54.390

根据这个 SO Question : [UIRefreshControl in Landscape](https://stackoverflow.com/questions/12710755/uirefreshcontrol-in-landscape?rq=1)，这是一个错误（请参阅**Dave DeLong**答案的评论），但是您可以尝试问题中给出的答案。

# combobox - 表单组合框在 Access 2007 查询中充当表列标题

> ID：16082654
> 
> 赞同：0
> 
> 时间：2013-04-18T12:12:25.220
> 
> 标签：combobox, ms-access-2007

我有一个带有未绑定组合框的表单，其中包含表 dbo_orderheader 的所有列标题。我想要做的是使用组合框字段作为表列标题，而不是将其硬编码为特定的表列标题，这样用户可以从他们选择的列上的表单中动态搜索，而不是拥有一个巨大的列表每个表格列的搜索框数。

请任何人都可以帮助在访问查询中执行此操作吗？我正在使用 Access 2007。

谢谢。

[见附图](http://tinypic.com/r/14ahik2/6)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:49:44.777

我很确定没有办法将表单引用作为列标题嵌入到*静态*查询设计中，但是您可以使用表单后面的代码来*动态*更新查询设计，然后打开查询，就像这样

```
Private Sub btnOpenQuery_Click()
Dim cdb As DAO.Database, qdf As DAO.QueryDef
Const queryName = "flexQuery"

Set cdb = CurrentDb
DoCmd.Close acQuery, queryName, acSaveNo
On Error Resume Next
DoCmd.DeleteObject acQuery, queryName
On Error GoTo 0
Set qdf = cdb.CreateQueryDef(queryName, _
        "SELECT URN, StyleNo, [" & Me.Combo3.Value & "] " & _
        "FROM dbo_OrderHeader " & _
        "WHERE [" & Me.Combo3.Value & "]=""" & Me.Text5.Value & """" _
    )
Set qdf = Nothing
Set cdb = Nothing
DoCmd.OpenQuery queryName, acViewNormal
End Sub 
```

注意：此示例代码*假定*“动态”列是一个文本列，因此在构造 SQL 语句时会`"`在周围放置字符。`Text5.Value`必须增强此代码以处理其他列类型（例如，数字列没有引号，`#`日期可能有分隔符）。

# vb.net - 订单号功能；找到共同点和差距

> ID：16082656
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:12:25.900
> 
> 标签：vb.net, vb6

我有一个 vb6 函数，最多需要 7 个数字，对它们进行排序，找到一个共同点。在这个数字序列中会有一个间隙。我还想找出丢失的号码。

示例输入是`19,17,20,and 16`. 输出应该是`16,17,18,19,20`这个顺序的数组。有什么帮助吗？我可能能够将 vb.net 代码解释为 vb6，但我更喜欢 vb6。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:16:27.917

以下是需要做的事情的概要：

*   找到最小和最大的数
*   创建一个包含足够条目的数组来保存从最小到最大的整个范围
*   用从最低到最高的数字填充数组。

请注意，您根本不需要对数字进行排序。你只需要找到极值。

这是VB6中的代码大纲：

```
Function RangeFrom(ParamArray Numbers() As Long) As Long()
    Dim Lowest As Long
    Dim Highest As Long
    Lowest = Numbers(0)
    Highest = Numbers(0)

    Dim Number As Long
    For Each Number In Numbers
        If Number < Lowest Then Lowest = Number
        If Number > Highest Then Highest = Number
    Next

    Dim Result(0 To Highest - Lowest) As Long

    Dim I As Long
    For I = 0 To Highest - Lowest
        Result(I) = Lowest + I
    Next

    FromRange = Result
End Function 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:26:20.020

由于您也标记了 VB.NET，这应该可以转换为 VB6（我已经避免使用 Linq）：

```
Public Shared Function FillGaps(input As Int32()) As Int32()
    Dim output = New List(Of Int32)
    Array.Sort(input)
    ' now we'll find the min/max-values at the first/last indices
    For i As Int32 = input(0) To input(input.Length - 1)
        output.Add(i)
    Next
    Return output.ToArray()
End Function 
```

按以下方式使用它：

```
Dim intArray = {19, 17, 20, 16}
intArray = FillGaps(intArray) 
```

请注意，这种方法会跳过重复项。

# javascript - 如何在 googlemaps url 中设置航点

> ID：16082660
> 
> 赞同：4
> 
> 时间：2013-04-18T12:12:39.213
> 
> 标签：javascript, jquery, google-maps-api-3

我有一个有地图的网站。我有一个文本字段，我在其中输入我想从已经设置的特定目的地旅行的城市名称。为了到达这个目的地，我在我的代码中硬编码了航路点。

所有这一切都很好，我现在有一个按钮，点击它会给我方向（文本格式），当我点击另一个按钮时，我会得到一个小地图，显示起点和终点。我也想将我的航点添加到这张地图上。

我希望它看起来像这样：http: [//img209.imageshack.us/img209/1121/whatiwant.png](http://img209.imageshack.us/img209/1121/whatiwant.png)

但我得到的是：http: [//img687.imageshack.us/img687/1554/whatigetm.png](http://img687.imageshack.us/img687/1554/whatigetm.png)

第二张图片的代码：

```
window.open("http://maps.google.com/maps?f=d&source=s_d&saddr=" + document.getElementById("fromAddress").value + "&mrad="+waypoints +"&daddr=<%=GetToAddress() %>&hl=sv&geocode=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=ls&sll=37.0625,-95.677068&sspn=47.167389,75.410156&ie=UTF8&z=7&layer=c&pw=2","mywindow"); 
```

在我进行更改之前的原始状态：

```
 window.open("http://maps.google.com/maps?f=d&source=s_d&saddr=" + document.getElementById("fromAddress").value +"&daddr=<%=GetToAddress() %>&hl=sv&geocode=XXXXXXXXXXXXXXXXXXXXXXX=37.0625,-95.677068&sspn=47.167389,75.410156&ie=UTF8&z=7&layer=c&pw=2","mywindow"); 
```

原始外观：http: [//img441.imageshack.us/img441/56/originalhd.png](http://img441.imageshack.us/img441/56/originalhd.png)

正如您在此处看到的，当我添加“mrad”属性时，我也会丢失方向文本。

我一直在以下链接上阅读这些属性： [http ://www.seomoz.org/ugc/everything-you-never-wanted-to-know-about-google-maps-parameters](http://www.seomoz.org/ugc/everything-you-never-wanted-to-know-about-google-maps-parameters) [http://mashupguide.net /1.0/html/ch02s05.xhtml](http://mashupguide.net/1.0/html/ch02s05.xhtml) [我应该在 Google 地图 URL 中使用哪些参数才能转到经纬度？](https://stackoverflow.com/questions/2660201/what-parameters-should-i-use-in-a-google-maps-url-to-go-to-a-lat-lon)

但我找不到如何将我的航点添加到地图上。

我基本上是在寻找如何将我的航点添加到地图上，同时又不会丢失最后一张图片中显示的方向文本。

我使用了 mrdad 属性，因为它似乎是最合乎逻辑的选择，因为它说：“mrad：让您指定一个额外的目标地址。”

我在这里误解了什么吗？也许缺少一些属性？

感谢您的回答！&如果有什么不清楚的地方就问！

//Ra3IDen

编辑：

给我所需路线的代码（当我单击“显示路线”按钮时执行）：

```
 function overlayDirections()
        {
            // reset the map
            if(waypoints.length >0){
            request = {
                origin: null,
                destination: null,
                waypoints: [],
                travelMode: google.maps.DirectionsTravelMode.DRIVING,
                optimizeWaypoints:true,
                avoidHighways:true,
                avoidTolls: true
            };

            for (var i = 0; i < markers.length; i++) {
                  markers[i].setMap(null);
                }

              markers = [];
              origin = null;
              destination = null;
              waypoints = [];
              directionsDisplay.setMap(null);
              directionsDisplay = new google.maps.DirectionsRenderer();
              directionsDisplay.setMap(mapdir);
              }

            $("#directions").text('');
             //$("#map_dir").empty();
            viaAddress = document.getElementById('viaAddress').value;
            fromAddress = document.getElementById("fromAddress").value;
            var language  = '<%=CurrentPage.LanguageBranch %>';

            <asp:PlaceHolder ID="Domestic" runat="server" visible="false">
                /*No ferry is needed*/
                var noOfPoints = 2;
                var waypoints = new Array(noOfPoints); 
                waypoints[0] = fromAddress;
                waypoints[1] = '<%=GetToAddress() %>';
            </asp:PlaceHolder>

            <asp:PlaceHolder ID="International" runat="server" visible="false">
                /*Ferry is required*/
                var vpM = fromAddress;
                if (viaAddress == 'Rostock')
                var wp1 = new google.maps.LatLng(55.357953,13.14894);
                else
                var wp1 = new google.maps.LatLng(55.37417,13.14731);
                addMarker(wp1);
                waypoints.push({ location: wp1, stopover: true });
                if(viaAddress != 'Rostock')
                var wp2 = new google.maps.LatLng(53.93406,10.841789);
                else
                var wp2 = new google.maps.LatLng(54.152747,12.098023);
                addMarker(wp2);
                waypoints.push({ location: wp2, stopover: true });
                destination =new google.maps.LatLng(<%=GetToAddress() %>);
                addMarker(destination);

            // set properties to a object
            </asp:PlaceHolder>
                request = {
                origin: vpM,
                destination: destination,
                waypoints: waypoints,
                travelMode: google.maps.DirectionsTravelMode.DRIVING,
                optimizeWaypoints:true,
                avoidHighways:false,
                avoidTolls: true
            };

            //displays the resutl
            directionsDisplay = new google.maps.DirectionsRenderer();
            directionsDisplay.setMap(mapdir);
            directionsDisplay.setPanel(document.getElementById("directions"));

            // draws the route       
            gdir.route(request, function(result, status) {
            if (status == google.maps.DirectionsStatus.OK) {
              directionsDisplay.setDirections(result);
            }
          });     
        } 
```

使用 via 属性并没有给我任何改变，但也许我以错误的方式使用它？：

```
 $('#print-directions').click(function(){
                if (document.getElementById("fromAddress").value != '')
                    window.open("http://maps.google.com/maps?f=d&source=s_d&saddr=" + document.getElementById("fromAddress").value + "&daddr=<%=GetToAddress() %>&hl=sv&geocode=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=ls&sll=37.0625,-95.677068&sspn=47.167389,75.410156&ie=UTF8&z=7&layer=c&pw=2","mywindow" + "&via="+ waypoints[1],waypoints[2]);
                else
                    alert('<%=GetKey("HotelPrintNoFromAddress") %>');
                return false;

            }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T14:55:10.487

好的，最后！

[以编程方式将多个地址添加到谷歌地图中](https://stackoverflow.com/questions/15719707/add-several-addresses-programatically-into-a-google-map)

这是这个问题的基本解决方案，我将在下面描述一些特殊的调整。Dr.Molle 公平地说，如果没有您的帮助，我永远不会解决这个问题，我会粘贴代码，如果您希望复制代码并将其作为解决方案发布，我会接受。

如果您查看评论，它将显示我花了一些时间来理解上述解决方案。Dr.Molle 所做的是将最终目的地设置为航路点 1！

所以我的最终目的地变成了航点 1，航点 1 变成了航点 2，我的最终目的地变成了航点 3。

检查图片以获得澄清：http: [//img6.imageshack.us/img6/8035/resulty.png](http://img6.imageshack.us/img6/8035/resulty.png)

A---起点

B--->(daddr) 航路点 1

C-------> 航路点 2

D-------> Waypoint 3（原来的最终目的地）

我还添加了属性“&dirflg=t”，因为它避免了道路通行费，并为我提供了一条通过渡轮旅行的路线。

编码 ：

```
 $('#print-directions').click(function(){
        if (document.getElementById("fromAddress").value != ''){
            window.open("http://maps.google.com/maps?f=d&source=s_d&saddr=" + document.getElementById("fromAddress").value + "&daddr=" + request.waypoints[0].location.toUrlValue() + "+" + "to:" + request.waypoints[1].location.toUrlValue()+ "+" + "to:"+"<%=GetToAddress()%>&hl=sv&geocode=XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX=ls&sll=37.0625,-95.677068&sspn=47.167389,75.410156&ie=UTF8&z=7&layer=c&pw=2" + "&dirflg=t","mywindow");
            }
        else
            alert('<%=GetKey("HotelPrintNoFromAddress") %>');
        return false;
    }); 
```

要查看其余代码，请查看我在 EDIT 下的问题。

非常感谢 Molle 博士，我希望我已经足够清楚地说明了这一点，以便其他人可以从中受益。

# java - 消息传递对象设计的 OOP 建议

> ID：16082661
> 
> 赞同：0
> 
> 时间：2013-04-18T12:12:40.827
> 
> 标签：java, oop, design-patterns, architecture

我的场景是这样的：

当您按消息类型将消息发送到不同的目的地时，我有一个消息传递系统。

这是我目前的设计：

```
Abstract class: MessageKindAbs

MessageKind1 extends MessageKindAbs  
MessageKind2 extends MessageKindAbs
MessageKind3 extends MessageKindAbs 
```

等等..

现在`MessageKind3`是一种特殊的。它的目的是发送内容`MessageKind1`或`MessageKind2`记录过程。

所以我在`MessageKind3`一个列表中创建了`MessageKind3Items`：

```
list<MessageKind3Item> MessageKind3ItemList... 
```

`MessageKind3Item`包括`MessageKind1`/`MessageKind2`用于记录目的的信息。

所以基本上发生的是每个`MessageKind3Item`还包括`MessageKindAbs`类型。

但这对我来说毫无意义。

例如：向数据库队列发送消息并记录`MessageKind1`持有和`MessageKind2`持有的信息。

所以我的 OOP 设计有点复杂。

任何人都可以帮我找到这里的路吗？

我本可以在`MessageKind3Item`另一个实例类型中创建，`MessageKindAbs`但我不确定它是否有意义。

谢谢，雷，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:23:07.330

让所有可以发送到日志进程的消息都实现一个接口。例如：

```
public interface Logable {

    void logTo(PrintWriter write);
} 
```

比`MessageKind3`只需要维护一个列表`Logable`。请注意，使用`PrintWriter`只是一个建议。您可能需要更精细的参数类型，以使接口实现中的日志记录更容易。

MessageKind3 将如下所示：

```
public class MessageKind3 extends MessageKindAbs {

    private List<Logable> logables;

    //...

    public List<Logable> getLogables() {
        return Collections.unmodifiableList(logables);
    }
} 
```

并且`logables`将包含`MessageKind1`或`MessageKind2`因为它们实现的实例`Logable`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:23:08.543

> 我本可以在 MessageKind3Item 中创建另一个 MessageKindAbs 实例类型，但我不确定它是否有意义。

你不能，它是抽象的。

* * *

由于 MessageKind3 用于记录，因此它的结构是已知的。因此对于 MessageKind3 项目创建一个特殊的 LogItem 类，它将被实例化为：

```
LogItem createLogItem(MessageKind1) {  return new LogItem(); }
LogItem createLogItem(MessageKind2) {  return new LogItem(); } 
```

并将这些项目附加到 MessageKind3。

您正试图将所有类与继承紧密耦合，这就是问题所在。

# call - 如何知道用户是否在 wp8 中拨打了电话？

> ID：16082663
> 
> 赞同：2
> 
> 时间：2013-04-18T12:12:44.890
> 
> 标签：call, windows-phone

我提示用户拨打电话

```
phoneCallTask.Show(). 
```

这将他带到了一个窗口是/否通知屏幕。

我需要知道用户是否选择拨打电话。

我怎么知道？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:58:24.060

没有办法确定。SDK 不会公开任何可以告诉您这一点的 API。

相反，您可以做的是跟踪用户离开应用程序和返回以查看是否进行了呼叫之间的时间量。

如果只是一两秒钟，那么几乎可以肯定没有打过电话。不过，任何其他结论都是主观的。如果订婚了怎么办？还是去接电话？这算作打电话吗？

# java - GWT + Spring + 没有定义名为“dispatch”的 bean

> ID：16082665
> 
> 赞同：0
> 
> 时间：2013-04-18T12:12:50.333
> 
> 标签：java, eclipse, spring, smartgwt, gwtp

在尝试使用 spring 依赖注入而不是**guice**时，出现以下错误

没有定义名为**“dispatch”的**bean

```
[WARN] /dispatch/
org.springframework.beans.factory.NoSuchBeanDefinitionException: No bean named 'dispatch' is defined
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBeanDefinition(DefaultListableBeanFactory.java:527)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getMergedLocalBeanDefinition(AbstractBeanFactory.java:1083)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:274)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:194)
    at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1079)
    at org.springframework.web.context.support.HttpRequestHandlerServlet.init(HttpRequestHandlerServlet.java:57)
    at javax.servlet.GenericServlet.init(GenericServlet.java:212)
    at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:433)
    at org.mortbay.jetty.servlet.ServletHolder.getServlet(ServletHolder.java:342)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:463) 
```

你能帮忙吗？

## web.xml 内容如下

```
<context-param>
<param-name>contextConfigLocation</param-name>
<param-value>classpath*:META-INF/applicationContext.xml</param-value>
</context-param>

<listener>
<listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
</listener>

<servlet>
<servlet-name>dispatch</servlet-name>
<servlet-class>org.springframework.web.context.support.HttpRequestHandlerServlet</servlet-class>
</servlet>

<servlet-mapping>
<servlet-name>dispatch</servlet-name>
<url-pattern>/dispatch/*</url-pattern>
</servlet-mapping> 
```

* * *

SeverModule 类是

```
package com.khush.util.server.spring;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.Import;

import com.gwtplatform.dispatch.server.actionvalidator.ActionValidator;
import com.gwtplatform.dispatch.server.spring.HandlerModule;
import com.gwtplatform.dispatch.server.spring.actionvalidator.DefaultActionValidator;
import com.gwtplatform.dispatch.server.spring.configuration.DefaultModule;
import com.khush.util.shared.action.RetrieveAccountsAction;

@Configuration
@Import(DefaultModule.class)
public class ServerModule extends HandlerModule {

  public ServerModule() {
  }

  @Bean
  public RetrieveAccountsHandler getRetrieveAccountsHandler() {
    return new RetrieveAccountsHandler();
  }

  @Bean
  public ActionValidator getDefaultActionValidator() {
    return new DefaultActionValidator();
  }

  protected void configureHandlers() {
      bindHandler(RetrieveAccountsAction.class, RetrieveAccountsHandler.class);
  }
} 
```

问候。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T15:06:45.613

你能在这里粘贴你的applicationContext.xml的内容吗？我想你忘了添加标签：

```
<context:component-scan base-package="package to scan..."/> 
```

如果没有这个标签，Spring 就无法检测到 XML 文件之外的 Bean。

# java - 如何使用 useDelimiter 过滤掉信息

> ID：16082667
> 
> 赞同：0
> 
> 时间：2013-04-18T12:13:04.417
> 
> 标签：java, arraylist, jcombobox

所以，我想做的是从文本文件中获取信息，

```
 For example, 134567H;Gabriel;24/12/1994;67;78;89 
```

然后我**只显示管理员编号，它是第一个而不是**下拉列表中的整行。所以这是我的代码：

```
 public static String[] readFile(){
    String file = "output.txt";
    ArrayList <String> studentList = new ArrayList <String> ();
    try{
    FileReader fr = new FileReader(file);
    Scanner sc = new Scanner(fr);
    sc.useDelimiter(";");

    while(sc.hasNextLine()){
        studentList.add(sc.nextLine());
    }

    fr.close();
    }catch(FileNotFoundException exception){
        System.out.println("File " + file + " was not found");
    }catch(IOException exception){
        System.out.println(exception);
    }
    return studentList.toArray(new String[studentList.size()]);
} 
```

这就是我填充下拉列表的方式：

```
 public void populate() {
    String [] studentList ;
    studentList = Question3ReadFile.readFile();

    jComboBox_adminNo.removeAllItems();

    for (String str : studentList) {
       jComboBox_adminNo.addItem(str);
    }
} 
```

但是，我现在的问题是下拉列表中的选项显示了文本文件中的整行。它不只显示管理员号码。我已经尝试使用 useDelimiter 了。我应该用那个吗？

任何帮助，将不胜感激。提前致谢。

**Rince帮助检查。**

```
 public class Question3ReadFile extends Question3 {

private String adminNo;

public Question3ReadFile(String data) {
    String[] tokens = data.split(";");
    this.adminNo = tokens[0];
}

public static String[] readFile(){
    String file = "output.txt";
    ArrayList <String> studentList = new ArrayList <String> ();
    try{
    FileReader fr = new FileReader(file);
    Scanner sc = new Scanner(fr);

    while(sc.hasNextLine()){
        studentList.add(new Question3ReadFile(sc.nextLine()));
    }

    fr.close();
    }catch(FileNotFoundException exception){
        System.out.println("File " + file + " was not found");
    }catch(IOException exception){
        System.out.println(exception);
    }
    return studentList.toArray(new String[studentList.size()]);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:16:21.950

hasNext 和 next 而不是 hasNextLine 和 nextLine

```
public static void main(String[] args) {
     String input = " For example, 134567H;Gabriel;24/12/1994;67;78;89";
     Scanner scanner = new Scanner(input);
     scanner.useDelimiter(";");
     String firstPart = null;
     while(scanner.hasNext()){
         firstPart = scanner.next();
         break;
     }

     String secondPart = input.split(firstPart)[1].substring(1);
     System.out.println(firstPart);
     System.out.println(secondPart);
     scanner.close();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:27:50.367

在这种情况下不要使用分隔符。我建议制作一个 Student 对象。

```
studentList.add(new Student(sc.nextLine)); 
```

并有学生课：

```
public class Student {
    private final String adminNo;

    public Student(String data) {
        String[] tokens = data.split(";");
        this.adminNo = tokens[0];
    }

    public String getAdminNo() {
        return adminNo;
    }
} 
```

然后您只需阅读稍后需要的字段（student.getAdminNo()）。

这种方法更漂亮，以后更容易扩展。

**upd：简单的方法**

或者不要为愚蠢的OO而烦恼，只需这样做：

```
studentList.add(sc.nextLine.split(";")[0]); 
```

# c# - 创建原子数据库和文件系统操作

> ID：16082669
> 
> 赞同：1
> 
> 时间：2013-04-18T12:13:21.100
> 
> 标签：c#, .net, sql-server, transactions

我正在使用 C# 4.0 和 SQL Server 2008 R2 开发 ASP.Net MVC 3 应用程序。我有一个场景：

1.  几个数据库行被插入到 SQL Server 数据库中。
2.  从这些行之一的内容构建的 xml 文件被写入文件系统。

目前，数据库操作包装在 TransactionScope 中，文件系统写入是调用 TransactionScope.Complete() 之前的最后一个操作。

我正在尝试将文件系统写入与数据库插入结合为单个原子操作。

在阅读了[类似的帖子后](https://stackoverflow.com/questions/5110494/how-to-write-a-file-to-disk-and-insert-a-database-record-in-a-single-transaction?rq=1)，我尝试使用 Transactional NTFS (TxF)，它似乎工作正常。然而，在与我合作的团队中，由于缺乏 TxF 的证据和经验，因此有些人不愿意使用它。

还有哪些其他不错的方法/模式可用于使组合的数据库和文件系统更改原子化？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:33:56.450

您使用的是 SQL Server 2008。您可以使用[FileStream 存储](http://msdn.microsoft.com/en-us/library/hh461480.aspx)。这与数据库更改一起包含在事务中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-17T13:53:04.010

无法使用事务性 NTFS 或 SQL 文件流存储我最终开发了一种两阶段提交。

1) 数据库被认为是文件系统的主控。
2) 暂存文件夹用作 TransactionScope 中的文件写入目标。
3) 一个单独的计划进程检查暂存文件夹中的任何文件。
4) 如果它找到任何它检查数据库是 consitant 这个文件。
5) 如果数据库包含该文件的记录，则将其移动到最终位置并且事务完成。
6) 如果数据库不包含文件的记录，则将其移出暂存文件夹并隔离在可以检查和/或删除的地方。

显然需要仔细考虑计划过程中的错误报告。

# algorithm - 如何根据社交分数创建评级

> ID：16082671
> 
> 赞同：1
> 
> 时间：2013-04-18T12:13:30.067
> 
> 标签：algorithm, rating

我有一千个食谱，每个食谱都有一条推文和 Facebook 之类的计数。我想要做的是根据这两个分数（也许还有其他社交网络计数）创建一个满分 100 的总体评分。

假设 facebook 和 twitter 的权重相同，我该怎么做。

对任何给定网络执行此操作的一种方法是这样的

this_recipes_facebook_count / max_facebook_count_in_db * 100.0

并将其与推特结果平均。

但是，如果有一个得分高得离谱的食谱会发生什么？它不公平地惩罚其他分数较低但仍相对较高的食谱。

我觉得我需要考虑标准偏差，也许是一些抑制功能......但自从我在高中学习统计数据以来已经 14 年了。

任何人都可以帮忙吗？我更喜欢简单而不是复杂，因为它毕竟只是食谱评级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:01:21.547

你可以做这样的事情，而不是线性增加受欢迎程度：(1-p^x)

其中 p 是预选值（例如 0.99），x 是提及次数。

最初提及次数的增加会大大提高得分。但一段时间后，效果变得越来越小。

# c - 在“for”条件下声明的变量的范围是什么？

> ID：16082678
> 
> 赞同：0
> 
> 时间：2013-04-18T12:13:44.107
> 
> 标签：c, c11

```
void main(void){
    for(int i;;);
    for(int i;;);
} 
```

这是有效的 C 代码吗？i的范围是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-26T19:27:38.083

C99 6.8.5.3 *for 语句*

> 该声明

```
for (clause-1 ;expression-2 ;expression-3 )statement 
```

> 行为如下： 表达式 expression-2 是在每次执行循环体之前计算的控制表达式。每次执行循环体后，表达式 expression-3 被评估为 void 表达式。**如果clause-1是一个声明，它声明的任何变量的范围是声明的其余部分和整个循环，包括其他两个表达式；**它在控制表达式的第一次评估之前按照执行顺序到达。如果 Clause-1 是一个表达式，则在第一次计算控制表达式之前，它会被计算为一个 void 表达式。

另请注意，此功能仅从 C99 开始有效。换句话说，您不能`for`在 C89 的循环中的第一条语句中声明变量。

# shared-hosting - 我们可以在像 GoDaddy 这样的共享主机环境上使用 LinqToExcel

> ID：16082680
> 
> 赞同：0
> 
> 时间：2013-04-18T12:13:44.660
> 
> 标签：shared-hosting, linq-to-excel

我打算使用 LinqToExcel 来读取我的 excels 文件，但我不确定它是否可以在像 GoDaddy 这样的共享主机环境上工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:58:30.607

它可能不起作用，因为必须在服务器上安装[Ace 数据库引擎](http://www.microsoft.com/en-us/download/details.aspx?id=13255)，以便 LinqToExcel 可以读取 excel 文件。而且我认为大多数共享托管服务提供商不会允许您安装它。

不过你可以试试，如果它确实有效，请告诉我。

# php - 循环时用另一个数组的值替换数组的键

> ID：16082686
> 
> 赞同：2
> 
> 时间：2013-04-18T12:13:56.740
> 
> 标签：php, arrays, multidimensional-array

我有两个多维数组。第一个`$properties`包含英文名称及其值。我的第二个数组包含翻译。一个例子

```
$properties[] = array(array("Floor"=>"5qm"));
$properties[] = array(array("Height"=>"10m"));

$translations[] = array(array("Floor"=>"Boden"));
$translations[] = array(array("Height"=>"Höhe")); 
```

（它们是多维的，因为它们包含更多元素，但它们现在不重要了）

现在我想翻译这个数组，所以我最后是这样的：

```
$properties[] = array(array("Boden"=>"5qm"));
$properties[] = array(array("Höhe"=>"10m")); 
```

我已经设法构建了 foreach 结构来循环遍历这些数组，但最后它没有被翻译，问题是，我如何告诉数组用值替换键。

我所做的是这样的：

```
//Translate Array
foreach ($properties as $PropertyArray) {
    //need second foreach because multidimensional array
    foreach ($PropertyArray as $P_KiviPropertyNameKey => $P_PropertyValue) {
        foreach ($translations as $TranslationArray) {
            //same as above
            foreach ($TranslationArray as $T_KiviTranslationPropertyKey => $T_KiviTranslationValue) {
                if ($P_KiviPropertyNameKey == $T_KiviTranslationPropertyKey) {
                    //Name found, save new array key
                    $P_KiviPropertyNameKey = $T_KiviTranslationValue;
                }
            }
        }
    }
} 
```

问题在于保存新密钥的行：

```
$P_KiviPropertyNameKey = $T_KiviTranslationValue; 
```

我知道这部分执行正确并包含正确的变量，但我相信这是分配新密钥的错误方式。

这是应该这样做的方式：

```
$properties[$oldkey] = $translations[$newkey]; 
```

所以我尝试了这个：

```
$PropertyArray[$P_KiviPropertyNameKey] = $TranslationArray[$T_KiviTranslationPropertyKey]; 
```

据我了解，上述行应该将 PropertyArray 的 P_KiviPropertyNameKey 更改为 Translation Array 的值，但我没有收到任何错误，也没有翻译名称。这应该如何正确完成？

感谢您的任何帮助！

**附加信息**

这是属性数组的一个活生生的例子

```
Array
(
    [0] => Array
        (
            [country_id] => 4402
        )

    [1] => Array
        (
            [iv_person_phone] => 03-11
        )

    [2] => Array
        (
            [companyperson_lastname] => Kallio
        )

    [3] => Array
        (
            [rc_lot_area_m2] => 2412.7
        )
    [56] => Array
        (
            [floors] => 3
        )

    [57] => Array
        (
            [total_area_m2] => 97.0
        )

    [58] => Array
        (
            [igglo_silentsale_realty_flag] => false
        )

    [59] => Array
        (
            [possession_partition_flag] => false
        )

    [60] => Array
        (
            [charges_parkingspace] => 10
        )

    [61] => Array
        (
            [0] => Array
                (
                    [image_realtyimagetype_id] => yleiskuva
                )

            [1] => Array
                (
                    [image_itemimagetype_name] => kivirealty-original
                )

            [2] => Array
                (
                    [image_desc] => makuuhuone
                )
        )
) 
```

这是翻译数组的一个活生生的例子

```
Array
(
    [0] => Array
        (
            [addr_region_area_id] => Maakunta
            [group] => Kohde
        )

    [1] => Array
        (
            [addr_town_area] => Kunta
            [group] => Kohde
        )

    [2] => Array
        (
            [arable_no_flag] => Ei peltoa
            [group] => Kohde
        )

    [3] => Array
        (
            [arableland] => Pellon kuvaus
            [group] => Kohde
        )
) 
```

我可以用另一种方式构建翻译数组。我这样做是因为在第二步中我必须检查密钥属于哪个组...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:33:22.683

试试这个 ：

```
$properties     = array();
$translations   = array();

$properties[]   = array("Floor"=>"5qm");
$properties[]   = array("Height"=>"10m");

$translations[] = array("Floor"=>"Boden");
$translations[] = array("Height"=>"Höhe");

$temp           = call_user_func_array('array_merge_recursive', $translations);

$result         = array();
foreach($properties as $key=>$val){
   foreach($val as $k=>$v){
       $result[$key][$temp[$k]] = $v;
   }  
}

echo "<pre>";
print_r($result); 
```

输出：

```
Array
(
    [0] => Array
        (
            [Boden] => 5qm
        )

    [1] => Array
        (
            [Höhe] => 10m
        )

) 
```

**请注意**：我将数组更改为`$properties[] = array("Floor"=>"5qm");`，删除了一级数组，我想这就是您需要构造数组的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T13:03:35.687

根据 和 的结构`$properties`，`$translations`你就知道它们是如何联系起来的了。数组的索引如何相互匹配有点模糊，这意味着 at index 中的值与`$properties`at index中`0`的翻译等效。`$translations``0`

我只是想知道为什么`$translations`数组需要与数组具有相同的结构（嵌套）`$properties`。在我看来，这个词`Height`只能`Höhe`用德语表示。将其表示为数组将表明可能有多种翻译。

因此，如果您可以将数组缩小`$translations`为一维数组，如下所示：

```
$translation = array(
  "Height"=>"Höhe",
  "Floor"=>"Boden"
); 
```

一个可能的循环是

```
$result = array();

foreach($properties as $i => $array2) {
  foreach($array2 as $i2 => $array3) {
    foreach($array3 as $key => $value) {
      $translatedKey = array_key_exists($key, $translations) ?
        $translations[$key]:
        $key;
      $result[$i][$i2][$translatedKey] = $value;
    }
  }
} 
```

（我看到每个人都发布了 2 个循环，这是一个`array,array,array`结构，而不是`array,array`..）

如果您不能将翻译数组缩小为一维数组，那么我只是想知道数组中的每个索引是否与`$properties`数组中的相同索引匹配`$translations`，如果是这样，通过添加索引（位置）是相同的技巧：

```
$translatedKey = $translations[$i][$i2][$key]; 
```

我使用过`array_key_exists`是因为我不确定翻译键是否总是存在。您必须自己为每个案例场景创建逻辑，以确定要检查或不检查的内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T13:24:03.897

这是一种完全递归的方法。

```
 /* input */
$properties[] = array(array("Floor"=>"5qm", array("Test"=>"123")));
$properties[] = array(array("Height"=>"10m"));

$translations[] = array(array("Floor"=>"Boden", array("Test"=>"Foo")));
$translations[] = array(array("Height"=>"Höhe"));

function array_flip_recursive($arr) {
    foreach ($arr as $key => $val) {
        if (is_array($val)) {
            $arr[$key] = array_flip_recursive($val);
        }
        else {
           $arr = @array_flip($arr);
       }
    }
    return $arr;
}

function array_merge_it($arr) {
    foreach ($arr as $key => $val) {
        if (is_array($val)) {
            $arr[$key] = array_merge_it($val);
        } else {
            if(isset($arr[$key]) && !empty($arr[$key])) {
              @$arr[$key] = $arr[$val];
            }
        }
     }
    return $arr;
}

function array_delete_empty($arr) {
    foreach ($arr as $key => $val) {
        if (is_array($val)) {
            $arr[$key] = array_delete_empty($val);
        }
        else {
           if(empty($arr[$key])) {
             unset($arr[$key]);
           }
       }
    }
    return $arr;
}

$arr = array_replace_recursive($properties, $translations);
$arr = array_flip_recursive($arr);
$arr = array_replace_recursive($arr, $properties);
$arr = array_merge_it($arr);
$arr = array_delete_empty($arr);

print_r($arr); 
```

[http://sandbox.onlinephpfunctions.com/code/d2f92605b609b9739964ece9a4d8f389be4a7b81](http://sandbox.onlinephpfunctions.com/code/d2f92605b609b9739964ece9a4d8f389be4a7b81)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-18T12:34:54.940

您必须以这种方式执行 for 循环。如果我理解你的正确（即）关联数组中的第一个键是相同的（一些索引）。

```
foreach($properties as $key => $values) {
    foreach($values as $key1 => $value1) {
        $propertyResult[] = array($translations[$key][$key1][$value1] => $properties[$key][$key1][$value1]);
    }
}

print_r($propertyResult); 
```

# javascript - 表单验证。单选按钮检查不起作用以及表单中的其他一些问题

> ID：16082689
> 
> 赞同：0
> 
> 时间：2013-04-18T12:14:08.377
> 
> 标签：javascript, validation

```
<!DOCTYPE html>
<html>
<head>
<title>SignUp</title>
<link rel="stylesheet" href="style/style.css">
<style type="text/css">
#signup{ 
    margin-left:200px;
    margin-top:90px;
}
#signup input{
    margin:2px 0px 20px 10px;
    background-color:#EAEAEA;
}

#signup button{
    font-size:16px;
margin-top:50px;
margin-left:150px;
width:100px;
height:31px;
background-color:#333333;
text-align:center;
color:#FFF;
}   
</style>
<script>
function signup()
{
var x1=document.forms["signUpForm"]["username"].value;

var x2=document.forms["signUpForm"]["email"].value;

var x3=document.forms["signUpForm"]["password1"].value;

var x4=document.forms["signUpForm"]["password2"].value; 

var x5="";                                                      /* document.forms[0].radios is an array filled with all radio buttons. Loop through all of                                                       them and see if it is checked. If one is, transfer the value of that radio button to                                                         user_input.*/
var atpos=x2.indexOf("@");
var dotpos=x2.lastIndexOf("."); 
if(document.getElementById('gender_Male').checked) {
    x5="Male";

}else if(document.getElementById('gender_Female').checked) {
  x5="Female";
}

if (x1==null || x1==""|| x2==null || x2==""||  x3==null || x3=="" || x4==null || x4=="" || x5=="")
  {
  alert("Please fill all the required fields");
  return false;
  }

else if (x3!=x4){
    alert("Psswords do not match");
  return false;
}

else if (atpos<1 || dotpos<atpos+2 || dotpos+2>=x2.length)
  {
  alert("Not a valid e-mail address");
  return false;

  }
else{

    return document.forms[0].action = "signupdata.php";
}
}

</script>

</head>
<body>
<?php include_once("template_pageTop.php"); ?>
<div id=signup>
<h2>Sign Up Here </h2>
<form  method="post" name="signUpForm" >
<table  border="0" cellpadding="2">
  <tr>
    <td >UserName:*</td>
    <td ><input type="text" name="username" size="30"  ></td>
  </tr>
  <tr>
    <td>Email:*</td>
    <td><input type="text" name="email" size="30" ></td>
  </tr>

  <tr>
    <td>Password:*</td>
    <td><input type="password" name="password1" size="30" ></td>
  </tr>
  <tr>
    <td>Confirm Password:*</td>
    <td><input type="password" name="password2" size="30" ></td>
  </tr>

  <tr>
    <td>Gender:*</td>
    <td ><input type="radio" name="gender" value="male" id="gender_Male">Male<br/>
        <input type="radio" name="gender" value="female" id="gender_Female">Female</td>
  </tr>

  <tr>
      <td><button  onclick= "signup()" >SignUp</button> </td>

      <td><button type="reset" >Cancel</button> </td>
  </tr>

</table>

</form>
</div>
</body>
</html> 
```

在这种形式下，我需要改进几件事。

1.  如果没有错误，如何使注册页面可见。（单击注册后我的会转到空白的 signupdata.php 页面。如何停止此操作）
2.  如何检查单选按钮（性别）是否已填写。我的表格没有检查。
3.  当一个字段未填充并且在弹出错误消息后所有填充区域（包括正确填充）消失。有没有办法阻止这种情况并保留所有正确填充的数据。

我对网页设计完全陌生。请提供任何帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:17:01.953

如果单选按钮是强制性的，默认情况下勾选其中一个单选按钮是很好的。

```
<input type="radio" name="gender" checked  value="male" >Male<br/>
        <input type="radio" name="gender" value="female">Female</td> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:27:03.900

```
 <input type="radio" name="gender" checked  value="male" id="male" >Male<br/>
    <input type="radio" name="gender" value="female" id="female">Female</td>

  if(document.getElementById('male').checked) {
      //Male radio button is checked
  }else if(document.getElementById('female').checked) {
      //Female is checked
  } 
```

# linux-kernel - GPU驱动程序的性能测试工具开源Mali/UMP

> ID：16082691
> 
> 赞同：1
> 
> 时间：2013-04-18T12:14:13.077
> 
> 标签：linux-kernel, gpu, linux-device-driver, device-driver, mali

我正在使用 ARMv7 电视板，具有板特定的 GPU 驱动程序 mali400x4（OpenGL ES 1.1、2.0 和 OpenVG 1.1）。我想知道任何测试项目套件来测试这个驱动程序的性能、压力、Lmbench。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-14T18:16:55.263

收集和 Piglit OpenGL 驱动程序测试工具

收集-> 1) 评估 OpenGL 的质量。Piglit -> 1) 通过回归测试帮助提高 openGL 驱动程序的质量。

Piglit OpenGL 驱动程序测试框架现在适用于 ARM Linux

阅读更多： [http ://www.cnx-software.com/2013/01/09/piglit-opengl-driver-testing-framework-now-works-with-arm-linux-opengl-es/](http://www.cnx-software.com/2013/01/09/piglit-opengl-driver-testing-framework-now-works-with-arm-linux-opengl-es/)

# ios - 从命令行创建 IPA 时，为什么不执行我的构建阶段脚本？

> ID：16082692
> 
> 赞同：11
> 
> 时间：2013-04-18T12:14:14.597
> 
> 标签：ios, xcode, bash, command-line, ipa

**问题 - 简短版本：**

`phase scripts`从命令行创建 IPA 时为什么不执行我的构建？当我运行`xcodebuild`创建 IPA 时，预定义的*构建阶段脚本*不会被执行。这是为什么？

* * *

**问题 - 冗长的版本：**

我有一个工作区，其中包含一个我想从命令行创建 IPA 的方案。

除了一件事，这很好用；我在目标的构建阶段有两个脚本，用于放置正确的应用程序版本 ( `CFBundleShortVersionString`) 和正确的 svn 修订号 ( `CFBundleVersion`)。这些脚本在从 xcode 归档时工作正常，但由于某种原因，从命令行归档时它们不会运行。首先这是为什么？

以下是正在运行的脚本（如果从 xCode 归档） ![在此处输入图像描述](https://i.stack.imgur.com/w4Zj1.png) ![在此处输入图像描述](https://i.stack.imgur.com/9Hngp.png)

从命令行归档和创建 IPA 时，我会做（要点）

```
# Building
xcodebuild ARCHS="armv7 armv7s" ONLY_ACTIVE_ARCH=NO -workspace MyWorkspace.xcworkspace/ -scheme MyScheme CONFIGURATION_BUILD_DIR=${PROJECT_BUILD_DIR} -configuration Release clean build

# Creating IPA
/usr/bin/xcrun -sdk iphoneos PackageApplication -v "${PROJECT_BUILD_DIR}/${APPLICATION_NAME}.app" -o "${IPA_OUTPUT_PATH}/${APPLICATION_NAME}.ipa" 
```

它可以工作并创建一个 IPA，但没有一个构建阶段脚本被执行，而修订号和版本号都保持不变。

感谢所有建议！

**更新由于 BDASH 的回答**

我没有进行干净的构建，而是将其安装为

```
xcodebuild install ARCHS="armv7 armv7s" ONLY_ACTIVE_ARCH=NO -workspace MyWorkspace.xcworkspace/ -scheme MyScheme CONFIGURATION_BUILD_DIR=${PROJECT_BUILD_DIR} -configuration Release 
```

预定义的脚本将在安装过程中执行（可以在项目版本号中看到）并且没有错误。但是，创建的 IPA 的大小约为 300 字节（而不是 ~10MB），并且无法安装在设备上。

在安装之前构建应用程序，即

```
# Building
xcodebuild clean build ARCHS="armv7 armv7s" ONLY_ACTIVE_ARCH=NO -workspace MyWorkspace.xcworkspace/ -scheme MyScheme CONFIGURATION_BUILD_DIR=${PROJECT_BUILD_DIR} -configuration Release 
# Installing
xcodebuild install ARCHS="armv7 armv7s" ONLY_ACTIVE_ARCH=NO -workspace MyWorkspace.xcworkspace/ -scheme MyScheme CONFIGURATION_BUILD_DIR=${PROJECT_BUILD_DIR} -configuration Release 
```

然后创建 IPA 将产生一个具有执行版本脚本且大小正确的 IPA，**但**无法将其安装在设备上。尝试将其放在设备上会显示错误消息
*“由于发生未知错误，您的 iPhone 设备“我的设备”上未安装程序“MyApp”。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-23T07:14:45.447

您已为至少一个脚本阶段选中“仅在安装时运行脚本”。仅在使用`build`操作时才会运行该阶段。`xcodebuild``install`

# wcf - 将 ChannelFactory 与 WorkflowServiceHost 一起使用

> ID：16082694
> 
> 赞同：3
> 
> 时间：2013-04-18T12:14:18.250
> 
> 标签：wcf, workflow-foundation-4, workflow-foundation

有没有办法对工作流定义 XAML 进行服务推断，以创建一个接口，该接口可以分发给客户端以与 ChannelFactory 一起使用，而不是主机公开 WSDL 并且客户端必须通过添加服务引用来生成服务定义?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:33:52.933

我分三步完成了这项工作：

1.  临时公开工作流服务中的元数据
2.  使用 svcutil 创建代理代码
3.  将配置改回不公开元数据

**详细地：**

*   在创建为“WCF 工作流服务应用程序”(DeclarativeServiceLibrary1) 的项目中包含定义服务的 XAMLX 文件
*   编译项目
*   将项目设置为启动项目
*   在解决方案资源管理器中选择 xamlx 文件
*   按 Ctrl-F5 -> WCF 测试客户端启动，您会看到您的服务已加载
*   右键单击 WCF 测试客户端中的 xamlx URL，选择复制地址（例如`http://localhost:56326/Service1.xamlx`）
*   打开一个 VS2010 管理控制台窗口
*   **使用svcutil.exe**创建代理代码：
    *   `cd /D %TEMP%`
    *   `svcutil http://localhost:56326/Service1.xamlx`
    *   这将创建两个文件，一个 *.cs 和一个 *.config，其中包含代理代码

我在创建代理代码的其他方法（在 VS2010 中）有很多问题，外部 svcutil 是最稳定的方法。希望这可以帮助。

# joomla - 替代布局应用于一篇文章但不是另一个

> ID：16082713
> 
> 赞同：0
> 
> 时间：2013-04-18T12:15:12.287
> 
> 标签：joomla, joomla2.5, joomla3.0

我正在使用 Joomla 3.x 并创建文章覆盖。它适用于某些文章。但是当我申请另一篇文章时，在单个文章菜单项中，它不起作用。

**更新**

这是我的整个覆盖文件：

```
<?php
/**
 * @package     Joomla.Site
 * @subpackage  com_content
 *
 * @copyright   Copyright (C) 2005 - 2013 Open Source Matters, Inc. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */

defined('_JEXEC') or die;

JHtml::addIncludePath(JPATH_COMPONENT . '/helpers');

// Create shortcuts to some parameters.
$params  = $this->item->params;
$images  = json_decode($this->item->images);
$urls    = json_decode($this->item->urls);
$canEdit = $params->get('access-edit');
$user    = JFactory::getUser();
$info    = $params->get('info_block_position', 0);
JHtml::_('behavior.caption');

?>
<div class="item-page<?php echo $this->pageclass_sfx?>">
    <?php if ($this->params->get('show_page_heading') && $params->get('show_title')) : ?>
    <div class="page-header">
        <h1> <?php echo $this->escape($this->params->get('page_heading')); ?> </h1>
    </div>
    <?php endif;
if (!empty($this->item->pagination) && $this->item->pagination && !$this->item->paginationposition && $this->item->paginationrelative)
{
    echo $this->item->pagination;
}
?>
    <?php if ($params->get('show_title') || $params->get('show_author')) : ?>
    <div class="page-header">
        <h2>
            <?php if ($this->item->state == 0) : ?>
                <span class="label label-warning"><?php echo JText::_('JUNPUBLISHED'); ?></span>
            <?php endif; ?>
            <?php if ($params->get('show_title')) : ?>
                <?php if ($params->get('link_titles') && !empty($this->item->readmore_link)) : ?>
                    <a href="<?php echo $this->item->readmore_link; ?>"> <?php echo $this->escape($this->item->title); ?></a>
                <?php else : ?>
                    <?php echo $this->escape($this->item->title); ?>
                <?php endif; ?>
            <?php endif; ?>
        </h2>
        <p class="date-created"><?php echo JText::sprintf('COM_CONTENT_CREATED_DATE_ON', JHtml::_('date', $this->item->created, JText::_('DATE_FORMAT_LC3'))); ?></p>
    </div>
    <?php endif; ?>
    <?php if (!$this->print) : ?>
        <?php if ($canEdit || $params->get('show_print_icon') || $params->get('show_email_icon')) : ?>
        <div class="btn-group pull-right">
            <a class="btn dropdown-toggle" data-toggle="dropdown" href="#"> <span class="icon-cog"></span> <span class="caret"></span> </a>
            <?php // Note the actions class is deprecated. Use dropdown-menu instead. ?>
            <ul class="dropdown-menu actions">
                <?php if ($params->get('show_print_icon')) : ?>
                <li class="print-icon"> <?php echo JHtml::_('icon.print_popup', $this->item, $params); ?> </li>
                <?php endif; ?>
                <?php if ($params->get('show_email_icon')) : ?>
                <li class="email-icon"> <?php echo JHtml::_('icon.email', $this->item, $params); ?> </li>
                <?php endif; ?>
                <?php if ($canEdit) : ?>
                <li class="edit-icon"> <?php echo JHtml::_('icon.edit', $this->item, $params); ?> </li>
                <?php endif; ?>
            </ul>
        </div>
        <?php endif; ?>
        <?php else : ?>
        <div class="pull-right">
        <?php echo JHtml::_('icon.print_screen', $this->item, $params); ?>
        </div>
    <?php endif; ?>
<?php $useDefList = ($params->get('show_modify_date') || $params->get('show_publish_date') || $params->get('show_create_date')
    || $params->get('show_hits') || $params->get('show_category') || $params->get('show_parent_category') || $params->get('show_author')); ?>
    <?php if ($useDefList && ($info == 0 || $info == 2)) : ?>
        <div class="article-info muted">
            <dl class="article-info">
            <!--<dt class="article-info-term"><?php echo JText::_('COM_CONTENT_ARTICLE_INFO'); ?></dt>-->

            <?php if ($params->get('show_author') && !empty($this->item->author )) : ?>
                <dd class="createdby">
                    <?php $author = $this->item->created_by_alias ? $this->item->created_by_alias : $this->item->author; ?>
                    <?php if (!empty($this->item->contactid) && $params->get('link_author') == true) : ?>
                        <?php
                        $needle = 'index.php?option=com_contact&view=contact&id=' . $this->item->contactid;
                        $menu = JFactory::getApplication()->getMenu();
                        $item = $menu->getItems('link', $needle, true);
                        $cntlink = !empty($item) ? $needle . '&Itemid=' . $item->id : $needle;
                        ?>
                        <?php echo JText::sprintf('COM_CONTENT_WRITTEN_BY', JHtml::_('link', JRoute::_($cntlink), $author)); ?>
                    <?php else: ?>
                        <?php echo JText::sprintf('COM_CONTENT_WRITTEN_BY', $author); ?>
                    <?php endif; ?>
                </dd>
            <?php endif; ?>
            <?php if ($params->get('show_parent_category') && !empty($this->item->parent_slug)) : ?>
                <dd class="parent-category-name">
                    <?php $title = $this->escape($this->item->parent_title);
                    $url = '<a href="'.JRoute::_(ContentHelperRoute::getCategoryRoute($this->item->parent_slug)).'">'.$title.'</a>';?>
                    <?php if ($params->get('link_parent_category') && !empty($this->item->parent_slug)) : ?>
                        <?php echo JText::sprintf('COM_CONTENT_PARENT', $url); ?>
                    <?php else : ?>
                        <?php echo JText::sprintf('COM_CONTENT_PARENT', $title); ?>
                    <?php endif; ?>
                </dd>
            <?php endif; ?>
            <?php if ($params->get('show_category')) : ?>
                <dd class="category-name">
                    <?php $title = $this->escape($this->item->category_title);
                    $url = '<a href="' . JRoute::_(ContentHelperRoute::getCategoryRoute($this->item->catslug)) . '">' . $title . '</a>';?>
                    <?php if ($params->get('link_category') && $this->item->catslug) : ?>
                        <?php echo JText::sprintf('COM_CONTENT_CATEGORY', $url); ?>
                    <?php else : ?>
                        <?php echo JText::sprintf('COM_CONTENT_CATEGORY', $title); ?>
                    <?php endif; ?>
                </dd>
            <?php endif; ?>

            <?php if ($params->get('show_publish_date')) : ?>
                <dd class="published">
                    <!--<span class="icon-calendar"></span>--> <?php echo JText::sprintf('COM_CONTENT_PUBLISHED_DATE_ON', JHtml::_('date', $this->item->publish_up, JText::_('DATE_FORMAT_LC3'))); ?>
                </dd>
            <?php endif; ?>

            <?php if ($info == 0) : ?>
                <?php if ($params->get('show_modify_date')) : ?>
                    <dd class="modified">
                        <!--<span class="icon-calendar"></span>--> <?php echo JText::sprintf('COM_CONTENT_LAST_UPDATED', JHtml::_('date', $this->item->modified, JText::_('DATE_FORMAT_LC3'))); ?>
                    </dd>
                <?php endif; ?>
                <?php if ($params->get('show_create_date')) : ?>
                    <dd class="create">
                        <!--<span class="icon-calendar"></span>--> <?php echo JText::sprintf('COM_CONTENT_CREATED_DATE_ON', JHtml::_('date', $this->item->created, JText::_('DATE_FORMAT_LC3'))); ?>
                    </dd>
                <?php endif; ?>

                <?php if ($params->get('show_hits')) : ?>
                    <dd class="hits">
                        <span class="icon-eye-open"></span> <?php echo JText::sprintf('COM_CONTENT_ARTICLE_HITS', $this->item->hits); ?>
                    </dd>
                <?php endif; ?>
            <?php endif; ?>
            </dl>
        </div>
    <?php endif; ?>

    <?php if (!$params->get('show_intro')) : echo $this->item->event->afterDisplayTitle; endif; ?>
    <?php echo $this->item->event->beforeDisplayContent; ?>

    <?php if (isset($urls) && ((!empty($urls->urls_position) && ($urls->urls_position == '0')) || ($params->get('urls_position') == '0' && empty($urls->urls_position)))
        || (empty($urls->urls_position) && (!$params->get('urls_position')))) : ?>
    <?php echo $this->loadTemplate('links'); ?>
    <?php endif; ?>
    <?php if ($params->get('access-view')):?>
    <?php if (isset($images->image_fulltext) && !empty($images->image_fulltext)) : ?>
    <?php $imgfloat = (empty($images->float_fulltext)) ? $params->get('float_fulltext') : $images->float_fulltext; ?>
    <div class="pull-<?php echo htmlspecialchars($imgfloat); ?> item-image"> <img
    <?php if ($images->image_fulltext_caption):
        echo 'class="caption"'.' title="' .htmlspecialchars($images->image_fulltext_caption) . '"';
    endif; ?>
    src="<?php echo htmlspecialchars($images->image_fulltext); ?>" alt="<?php echo htmlspecialchars($images->image_fulltext_alt); ?>"/> </div>
    <?php endif; ?>
    <?php
    if (!empty($this->item->pagination) && $this->item->pagination && !$this->item->paginationposition && !$this->item->paginationrelative):
        echo $this->item->pagination;
    endif;
    ?>
    <?php if (isset ($this->item->toc)) :
        echo $this->item->toc;
    endif; ?>
    <div class="article-text"><?php echo $this->item->text; ?></div>

    <?php if ($useDefList && ($info == 1 || $info == 2)) : ?>
        <div class="article-info muted">
            <dl class="article-info">
            <!--<dt class="article-info-term"><?php echo JText::_('COM_CONTENT_ARTICLE_INFO'); ?></dt>-->

            <?php if ($info == 1) : ?>
                <?php if ($params->get('show_author') && !empty($this->item->author )) : ?>
                    <dd class="createdby">
                        <?php $author = $this->item->created_by_alias ? $this->item->created_by_alias : $this->item->author; ?>
                        <?php if (!empty($this->item->contactid) && $params->get('link_author') == true) : ?>
                        <?php
                        $needle = 'index.php?option=com_contact&view=contact&id=' . $this->item->contactid;
                        $menu = JFactory::getApplication()->getMenu();
                        $item = $menu->getItems('link', $needle, true);
                        $cntlink = !empty($item) ? $needle . '&Itemid=' . $item->id : $needle;
                        ?>
                        <?php echo JText::sprintf('COM_CONTENT_WRITTEN_BY', JHtml::_('link', JRoute::_($cntlink), $author)); ?>
                        <?php else: ?>
                        <?php echo JText::sprintf('COM_CONTENT_WRITTEN_BY', $author); ?>
                        <?php endif; ?>
                    </dd>
                <?php endif; ?>
                <?php if ($params->get('show_parent_category') && !empty($this->item->parent_slug)) : ?>
                    <dd class="parent-category-name">
                        <?php   $title = $this->escape($this->item->parent_title);
                        $url = '<a href="' . JRoute::_(ContentHelperRoute::getCategoryRoute($this->item->parent_slug)) . '">' . $title . '</a>';?>
                        <?php if ($params->get('link_parent_category') && $this->item->parent_slug) : ?>
                            <?php echo JText::sprintf('COM_CONTENT_PARENT', $url); ?>
                        <?php else : ?>
                            <?php echo JText::sprintf('COM_CONTENT_PARENT', $title); ?>
                        <?php endif; ?>
                    </dd>
                <?php endif; ?>
                <?php if ($params->get('show_category')) : ?>
                    <dd class="category-name">
                        <?php   $title = $this->escape($this->item->category_title);
                        $url = '<a href="' . JRoute::_(ContentHelperRoute::getCategoryRoute($this->item->catslug)) . '">' . $title . '</a>';?>
                        <?php if ($params->get('link_category') && $this->item->catslug) : ?>
                            <?php echo JText::sprintf('COM_CONTENT_CATEGORY', $url); ?>
                        <?php else : ?>
                            <?php echo JText::sprintf('COM_CONTENT_CATEGORY', $title); ?>
                        <?php endif; ?>
                    </dd>
                <?php endif; ?>
                <?php if ($params->get('show_publish_date')) : ?>
                    <dd class="published">
                        <!--<!--<span class="icon-calendar"></span>-->-->
                        <?php echo JText::sprintf('COM_CONTENT_PUBLISHED_DATE_ON', JHtml::_('date', $this->item->publish_up, JText::_('DATE_FORMAT_LC3'))); ?>
                    </dd>
                <?php endif; ?>
            <?php endif; ?>

            <?php if ($params->get('show_create_date')) : ?>
                <dd class="create">
                    <!--<!--<span class="icon-calendar"></span>-->-->
                    <?php echo JText::sprintf('COM_CONTENT_CREATED_DATE_ON', JHtml::_('date', $this->item->modified, JText::_('DATE_FORMAT_LC3'))); ?>
                </dd>
            <?php endif; ?>
            <?php if ($params->get('show_modify_date')) : ?>
                <dd class="modified">
                    <!--<span class="icon-calendar"></span>-->
                    <?php echo JText::sprintf('COM_CONTENT_LAST_UPDATED', JHtml::_('date', $this->item->modified, JText::_('DATE_FORMAT_LC3'))); ?>
                </dd>
            <?php endif; ?>
            <?php if ($params->get('show_hits')) : ?>
                <dd class="hits">
                    <span class="icon-eye-open"></span> <?php echo JText::sprintf('COM_CONTENT_ARTICLE_HITS', $this->item->hits); ?>
                </dd>
            <?php endif; ?>
            </dl>
        </div>
    <?php endif; ?>

    <?php
if (!empty($this->item->pagination) && $this->item->pagination && $this->item->paginationposition && !$this->item->paginationrelative):
    echo $this->item->pagination;
?>
    <?php endif; ?>
    <?php if (isset($urls) && ((!empty($urls->urls_position) && ($urls->urls_position == '1')) || ($params->get('urls_position') == '1'))) : ?>
    <?php echo $this->loadTemplate('links'); ?>
    <?php endif; ?>
    <?php //optional teaser intro text for guests ?>
    <?php elseif ($params->get('show_noauth') == true && $user->get('guest')) : ?>
    <?php echo $this->item->introtext; ?>
    <?php //Optional link to let them register to see the whole article. ?>
    <?php if ($params->get('show_readmore') && $this->item->fulltext != null) :
        $link1 = JRoute::_('index.php?option=com_users&view=login');
        $link = new JURI($link1);?>
    <p class="readmore">
        <a href="<?php echo $link; ?>">
        <?php $attribs = json_decode($this->item->attribs); ?>
        <?php
        if ($attribs->alternative_readmore == null) :
            echo JText::_('COM_CONTENT_REGISTER_TO_READ_MORE');
        elseif ($readmore = $this->item->alternative_readmore) :
            echo $readmore;
            if ($params->get('show_readmore_title', 0) != 0) :
                echo JHtml::_('string.truncate', ($this->item->title), $params->get('readmore_limit'));
            endif;
        elseif ($params->get('show_readmore_title', 0) == 0) :
            echo JText::sprintf('COM_CONTENT_READ_MORE_TITLE');
        else :
            echo JText::_('COM_CONTENT_READ_MORE');
            echo JHtml::_('string.truncate', ($this->item->title), $params->get('readmore_limit'));
        endif; ?>
        </a>
    </p>
    <?php endif; ?>
    <?php endif; ?>
    <?php
if (!empty($this->item->pagination) && $this->item->pagination && $this->item->paginationposition && $this->item->paginationrelative) :
    echo $this->item->pagination;
?>
    <?php endif; ?>
    <?php echo $this->item->event->afterDisplayContent; ?> </div> 
```

**更新 2**

我发现了一件事：如果文章与菜单项（类型：类别列表）相关联，则替代布局有效。但是当文章关联一个菜单项（类型：Single Article）时，Alternative Layout 不起作用。在这两种情况下，替代布局如何发挥作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:04:10.617

**解决了！**

I 创建自定义菜单项类型。

更多信息在这里：[http ://docs.joomla.org/Layout_Overrides_in_Joomla_2.5](http://docs.joomla.org/Layout_Overrides_in_Joomla_2.5)

在这里：http: [//jure-stern.si/blog/custom-menu-item-types-in-joomla-with-xml-files/](http://jure-stern.si/blog/custom-menu-item-types-in-joomla-with-xml-files/)

# jquery - 在 testcomplete 中调用 jquery 时 VBscript 失败

> ID：16082714
> 
> 赞同：0
> 
> 时间：2013-04-18T12:15:18.463
> 
> 标签：jquery, vbscript, testcomplete

这发生在 testcomplete 版本 9.20 中，并针对 firefox 19.0.2 进行测试。

第一个脚本文件被调用`test`，它包含以下几行：

```
'USEUNIT CommonFunctions
Public Function test()
  Call expandTree()
End Function 
```

另一个名为的脚本文件`CommonFunctions`具有此功能：

```
Public Function expandTree()
  Set foo = Aliases.tree.contentDocument.Script.jQuery("li[data-nodeid='sites'] a.openClose").click()
End Function 
```

当我运行脚本时，自动化文件会出现以下错误：

```
Microsoft VBscript runtime error.

Object doesn't support this property or method:"contentDocument.Script.jQuery(...).Click''

Error location:
Unit:"ContentSuite\Content\Script\CommonFunctions"
Line:3972 Coloumn2 
```

如果我将 jquery 放在同一个文件中，则不会发生相同的错误。也就是说，如果我运行它，它将正常工作，并且点击会正常工作：

```
Public Function test()
  Set foo = Aliases.tree.contentDocument.Script.jQuery("li[data-nodeid='sites'] a.openClose").click()
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T05:27:16.393

我认为问题可能与您试图调用**jQuery**方法返回的对象的**click**方法有关。由于此方法返回一个集合，请在单击之前尝试获取特定对象：

 **```
Public Function expandTree()
  Aliases.tree.contentDocument.Script.jQuery("li[data-nodeid='sites'] a.openClose").get(0).click()
End Function 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T09:36:52.587

首先，你当前的代码使用的是 DOM`click`方法，它没有返回值，所以你需要移除`Set foo =`.

错误可能是 jQuery 选择器没有找到任何匹配的对象。尝试检查函数结果的`length`属性：`jQuery`

```
Set links = Aliases.tree.contentDocument.Script.jQuery("li[data-nodeid='sites'] a.openClose")
If links.length > 0 Then
  links.click
Else
  Log.Error "Object not found."
End If 
```

但实际上这里不需要使用 jQuery，因为 TestComplete 有内置[`QuerySelector`](http://support.smartbear.com/viewarticle/42163/)方法：

```
Set obj = Aliases.tree.QuerySelector("li[data-nodeid='sites'] a.openClose")
If Not obj Is Nothing Then
  obj.Click
Else
  Log.Error "Object not found."
End If 
```**

# java - 如何运行 Spring portlet

> ID：16082715
> 
> 赞同：0
> 
> 时间：2013-04-18T12:15:19.667
> 
> 标签：java, spring, jboss, portlet

我是 Spring portlet 的新手，我无法运行示例 spring portlet 项目。我正在尝试从 eclipse 运行项目，就像在 jboss 服务器上的服务器上运行一样。我的问题是 1\. 我们如何运行 portlet 项目。我需要某种 portlet 容器吗（我不知道这个容器，我只知道几个名字，比如 liferay 等）？我在任何地方都找不到完整的文档示例。在基于请求映射的 Spring mvc 中，我可以调用该专用控制器类，但在 Spring mvc portlet 中，我们如何调用此控制器（或 Portlet）。是否可以通过 url 直接调用 portlet？示例项目的部署没有任何错误，但我找不到调用或触发 portlet 的方法。任何帮助将不胜感激。谢谢恩科维

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:32:49.827

是的，您需要部署到像 Liferay 等的 portlet 容器或 uPortal。一旦您启动并运行了 portlet 容器，事情应该会变得更加明显。

关于您的其他问题，我强烈建议您阅读一些文档[——Spring portlet 文档](http://static.springsource.org/spring/docs/3.0.x/reference/portlet.html)还不错，尽管它们在注释方面有点落后。

# c# - 将字典值公开为基本类型的便捷方法

> ID：16082717
> 
> 赞同：3
> 
> 时间：2013-04-18T12:15:35.407
> 
> 标签：c#

我正在寻找是否有一种方法可以轻松地从 c# 类中公开我的容器，而不会泄露不必要的实现细节。我正在学习 C#，但我在其他 OO 语言方面经验丰富，所以我知道在可能的情况下，最好公开基类/接口而不是具体类型。我正在做的是在我的班级中存储密钥集合（对象集合）。我发现我可以轻松地将其公开为 IDictionary(key, 对象集合)，但我想要的是 IDictionary(key, IEnumerable(object))。希望一个简单的例子能让它更清楚。

```
class AddressBook
{
    public IDictionary<string, List<string>> Name2Addresses // ok, but I want IDictionary<string, IEnumerable<string>>
    {
        get { return name2Addresses; }
    }

    public IEnumerable<string> GetAddresses(string name)// ok, but I really just want the convenience of exposing container as a "one-liner"
    {
        return name2Addresses[name];
    }

    public AddressBook()
    {
        name2Addresses = new Dictionary<string,List<string>>();
        List<string> addresses = new List<string>(); // I'd prefer IList<string> addresses = ...
        name2Addresses.Add("Anne Best", addresses);
        addresses.Add("Home address");
        addresses.Add("Work address");
    }
    Dictionary<string, List<string>> name2Addresses;
} 
```

我知道在 OO 中将派生容器暴露为基容器是一个棘手的问题，因为例如，您可以通过容器基类添加不同的派生容器。但希望因为我想通过 IEnumerable 将容器公开为只读，所以可能有一种简单的方法可以做到这一点。这是我想要的代码。

```
 public IDictionary<string, IEnumerable<string>> Name2Addresses
    {
        get { return name2Addresses; }
    } 
```

我尝试添加一个演员，因为编译器抱怨没有演员

```
 public IDictionary<string, IEnumerable<string>> Name2Addresses
    {
        get { return (IDictionary<string, IEnumerable<string>>) name2Addresses; }
    } 
```

但后来我遇到了一个例外：

> 附加信息：无法将“System.Collections.Generic.Dictionary 1[System.String]]”类型的对象转换为“System.Collections.Generic.IDictionary `2[System.String,System.Collections.Generic.IList`1[System.String]]”类型`2[System.String,System.Collections.Generic.IEnumerable`。

有任何想法吗？我希望有一种简单/优雅的方式来做到这一点，因为总的来说，从较低级别的 OO 语言迁移到 C# 是一种乐趣，在 C# 中可以更快、更容易地将我想要的东西付诸实践。这无论如何都不是一个阻碍，因为我可以只显示 List 而不是 IEnum 并相信自己不会滥用 List，但我想正确地做事，特别是因为我希望有一天其他人使用我的代码.

PS 我记得在某处读到 C# 最近改进了对这类事情的支持。如果这有什么不同，我在 VS2010 上。

*编辑*

我在询问之前做了一些搜索，但经过更多搜索后，我发现以前有人问过这个问题，在稍微不同的上下文中，[为什么不能将 Dictionary<T1, List<T2>> 强制转换为 Dictionary<T1, IEnumerable<T2 >>?](https://stackoverflow.com/questions/8734272/why-cant-dictionaryt1-listt2-be-cast-to-dictionaryt1-ienumerablet2) . 所以我的问题可能会归结为是否有一种只读 IDictionary 的方法（另请参阅[Is there a read-only generic dictionary available in .NET?](https://stackoverflow.com/questions/678379/is-there-a-read-only-generic-dictionary-available-in-net)）

*另一个编辑*

正如 Alex G / code4life 所建议的那样，这将起作用：无需滚动我自己的只读字典类，我就可以创建一个新字典。例如

```
 public IDictionary<string, IEnumerable<string>> Name2AddressesNewDictionary
    {
        get
        {
            return name2Addresses.ToDictionary(na=>na.Key, na=>na.Value.AsEnumerable());
        }
    } 
```

这会导致每次访问时性能损失+创建新键值对（以及字典本身）的空间损失。加上额外的开发时间。一般来说，如果我正在使用一个属性（尤其是在幕后进行的工作），这似乎并不比公开一个列表更好。但作为一种方法/在其他情况下会很好。

*第三次编辑*

正如 Jens Kloster 建议的那样，将容器的定义更改为使用 IEnumerable 作为值

```
 Dictionary<string, IEnumerable<string>> name2Addresses; 
```

然后在你需要的时候强制执行。

```
 ((IList<string>)name2Addresses["Anne Best"]).Add("Alternative address"); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T12:39:41.150

由于[covariance/contravariance](http://msdn.microsoft.com/en-gb/library/ee207183.aspx)，您无法转换，但您可以使用 LINQ 以您想要的格式重新创建字典：

`using System.Linq; ...`

```
public IDictionary<string, IEnumerable<string>> Name2Addresses
{
    get
    {
        return name2Addresses.ToDictionary<string, IEnumerable<string>>(
            kvp => kvp.Key,
            kvp => kvp.Value.AsEnumerable());
    }
} 
```

注意：**这会创建一个新的字典对象！**

在更一般的设计相关说明上：任何时候你发现自己以这种方式组合数据结构时，通常值得定义自己的数据结构以提供清晰性并公开遍历结构和执行常见操作所需的必要方法操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T12:41:57.320

尝试更改字段以使用 IEnumerable 而不是 List。

```
Dictionary<string, IEnumerable<string>> name2Addresses; 
```

那么拥有这样的属性应该没有问题：

```
 public IDictionary<string, IEnumerable<string>> Name2Addresses
 {
   get { return name2Addresses; }
 } 
```

你仍然可以这样做：

```
 public AddressBook()
    {
        name2Addresses = new Dictionary<string,IEnumerable<string>>(); //changed ere
        List<string> addresses = new List<string>(); 
        name2Addresses.Add("Anne Best", addresses);
        addresses.Add("Home address");
        addresses.Add("Work address");
    } 
```

也 - 看看[这篇](https://stackoverflow.com/questions/678379/is-there-a-read-only-generic-dictionary-available-in-net)文章

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T12:46:57.537

我认为您只需要再次对字典进行 LINQ 化。

```
public IDictionary<string, IEnumerable<string>> Name2Addresses    
{
  get
  {
    return name2Addresses.ToDictionary(d => d.Key, d => d.Value.AsEnumerable());
  }
} 
```

相反，重新定义要使用的字典`IEnumerable`- 这可能是最好的方法。：

```
Dictionary<string, IEnumerable<string>> name2Addresses; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T12:21:59.843

您可以查看可通过 System.Linq 获得的 .AsEnumerable() 扩展方法：

[http://msdn.microsoft.com/en-us/library/bb335435.aspx](http://msdn.microsoft.com/en-us/library/bb335435.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T12:38:30.863

事实上，最好的出路是只读协变字典接口，但没有。但是，您可以轻松编写一个只读实现，`IDictionary`该实现将包装底层字典并将元素转换为`IEnumerable<T>`.

# sql-server - SQL Server 中 12 小时制到 24 小时制的转换

> ID：16082718
> 
> 赞同：0
> 
> 时间：2013-04-18T12:15:37.477
> 
> 标签：sql-server, type-conversion

```
 SELECT CONVERT(time ,' 00:00:12 PM') 
```

为什么上面的代码不起作用。怎么做才能让它工作。

由于某种原因，“00:00:00 PM”到“00:59:59 PM”无法转换为时间:(

"1:00:00 PM" 成功转换。

* * *

提前致谢。有人请帮帮我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:32:28.900

我认为 00:00 PM 不存在。现在是 12:00 AM 或 12:00 PM。00:00 仅以 24 小时格式存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:30:24.287

CONVERT 可以用作 CAST，但可以使用 FORMAT 作为日期，以使这个已经很好理解的文字成为特定格式。

但是，您想使用 PARSE 来获得这个可能不太容易理解的文字以成为日期时间或时间（没有格式）。为了告诉引擎如何解释我们输入 USING 的文字。

核实：

```
SELECT PARSE(' 00:00:12 PM' AS time USING 'en-US') 
```

# handle - Matlab GUIDE GUI 使用 Load() 函数后处理值的变化？

> ID：16082719
> 
> 赞同：0
> 
> 时间：2013-04-18T12:15:38.810
> 
> 标签：handle, matlab-guide, matlab-load

在我使用 Matlab 中的 GUIDE 制作的 GUI 中。我遇到了一个问题，在使用 Load() 函数加载 .MAT 文件时，我的所有句柄都会更改值。这意味着如果我有一个我想在我的 GUI 上使用的按钮。我的程序会相信它的句柄是例如

```
 handles.button1 =190.082 
```

实际上，我可以再访问该按钮的唯一方法是通过另一个未知的手柄。因此，如果它未知，让我们看看它的新句柄必须是什么。

```
findobj('Tag','button1') = 227.0093 
```

如您所见，这些数字完全不同。为什么句柄值会改变，这超出了我的理解。由于句柄发生了变化，我无法再使用之前代码部分中编写的 set() 函数。例如我必须改变

```
set(handles.button1, 'Enable', 'off');

to 

set(findobj('Tag','button1'),'Enable','off'); 
```

有没有人解释为什么在使用时会出现这个问题`Load()`？有没有可行的解决方案，而不是每次要使用对象时都必须找到它的句柄？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:47:40.450

.MAT 文件方便地还有一个句柄变量，它覆盖了我当前的句柄。

# iphone - 在 iPhone 和 iPad 上显示网站的整个宽度

> ID：16082725
> 
> 赞同：0
> 
> 时间：2013-04-18T12:15:54.523
> 
> 标签：iphone, ios, css, ipad

我很感谢精通 CSS 的人的一些建议。由于我无法确定的原因，我的网站只有右侧显示在 iPhone / iPad 浏览器中，而左侧的 1/3 甚至都看不到。

如果有人可以解释导致问题的原因以及如何解决问题，我将不胜感激。

这是设置布局的css部分：

```
body {
position:absolute;
width: 960px;
top: 0px;
left: 50%;
margin-left: -480px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:23:16.997

首先：尝试`position: absolute; width: 960px; top: 0px; left: 50%; margin-left: -480px;`从您的`body`.

第二：这是使页面居中的方法`width: 960px; margin: auto`，将其放在`#page`

因此，`body`删除了一些 css，下面的 css`#page`可能会更好

```
#page {
    width: 960px;
    margin: auto;
    overflow: hidden; /* to compensate for some element overflowing and messing up your layout */
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:26:07.467

您需要在每台设备上修改身体的宽度。您可以使用 @media 查询通过 css 来完成

```
/*  Ipad Landscape */
@media screen and (max-width: 1100px) {
  body {
    width: 80%;
    left: 0%;
    margin-left: 10%;
  }

}

/* iphone 5 landscape ipad portrait */
@media screen and (max-width: 800px) 
{
}

/* iphone 4 lanscape */
@media screen and (max-width: 500px) 
{
}

/* iphone 4- 5 portrait */
@media screen and (max-width: 400px) 
{
} 
```

# shell - ffmpeg - 元数据中的多行文本（注释标签）

> ID：16082729
> 
> 赞同：5
> 
> 时间：2013-04-18T12:16:03.650
> 
> 标签：shell, ffmpeg, mp3, m4a

我使用 ffmpeg 像这样更新元数据标签：

```
ffmpeg -i "in.m4a" -acodec copy -metadata artist="artist text"
-metadata comment="comment text" "out.m4a" 
```

好吧，“艺术家文本”和“评论文本”通常是纯文本，但评论字段允许放置多行文本。每行必须有*换行符*才能做到这一点。像这样的东西：

```
-metadata comment="source: lastfm \r\n tags: tag1, tag2 \r\n ..." 
```

但是我使用的所有字符 (\r\n, %nl%, ^N) 都没有结果。

我使用**shell_exec()**函数从**Windows上的****PHP**脚本运行**ffmpeg.exe**

 ******请高人帮忙，或者告诉我这真的可能吗？...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T17:34:53.727

You can do this with PowerShell using the ``n` for a newline and optionally ``r` for carriage return

```
ffmpeg -i in.m4a -metadata comment="hello`nworld" out.m4a 
```

Windows default shell is `cmd.exe` so you may need to invoke like this

```
powershell ffmpeg -i in.m4a -metadata comment="hello`nworld" out.m4a 
```

Output

```
Output #0, ipod, to 'out.m4a':
  Metadata:
    major_brand     : M4A
    minor_version   : 512
    compatible_brands: isomiso2
    comment         : hello
                    : world
    encoder         : Lavf55.1.100

```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-20T00:54:29.840

Linux的工作解决方案：

`ffmpeg ... -metadata comment='https://www.youtube.com/watch?v=text1'$'\n''https://www.youtube.com/watch?v=text2' ... output`

**vlc**和**bash**都显示`ffmpeg -i output`两行。******

# javascript - 无法通过 Javascript 向通过 XMLHttpRequest 接收的 DOM 对象添加属性

> ID：16082732
> 
> 赞同：2
> 
> 时间：2013-04-18T12:16:19.680
> 
> 标签：javascript, svg, internet-explorer-9, xmlhttprequest

我`<svg> ... </svg>`通过 JavaScript 生成 GET XMLHttpRequest 来获取 SVG DOM 对象 ()。我需要为接收到的对象添加一些属性，如下所示：

```
svgObject.prop = 5 
```

where`prop`应该由 JavaScript 创建为对象的新属性。

出于某种原因，这在 IE9 中是不可能的，我得到了错误：

> 对象不支持此属性或方法。

但是，这适用于 Firefox 和 IE10。有人遇到过这种行为吗？有人知道如何在 IE9 中绕过它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:45:45.730

在 Internet Explorer 10 之前，返回的对象`XMLHttpRequest`不是[本机对象](http://www.sitepoint.com/forums/showthread.php?476028-Adding-property-to-XMLHttpRequest-Object-in-IE)，因此该对象不允许扩展属性。微软[在 Internet Explorer 10 中修复了这个问题，](http://msdn.microsoft.com/en-us/library/ie/ms535874%28v=vs.85%29.aspx)并`XMLHttpRequest`返回了一个原生对象，以使其实现与其他浏览器更兼容。

# java - Java.util.Date vs Java.sql.Date - 日期值不同

> ID：16082735
> 
> 赞同：0
> 
> 时间：2013-04-18T12:16:24.963
> 
> 标签：java, date, jdbc, primefaces

我有一个包含字段的 Oracle 数据库`W_PLANNED_DATE: 19/03/2013 10:55:00 (Date)`

在 Java 中，我将此值放入一个变量中：

```
Date dteBeginOrWaitingItem = orWaitinglist.getWPlannedDate();

value: 2013-03-19 
```

现在，我的时间怎么了？我需要这个来填充primefaces的schedulecomponent。如何获得完整的日期和时间值

```
eventResourceAvailPerDay.addEvent(new DefaultScheduleEvent(reason, dteBeginOrWaitingItem, dteEndOrWaitingItem, "waitingitem")); 
```

此方法将事件置于`12:00 PM`没有其他时间或时间正好`00:00:00`

我知道如何使用 Calendar 类，但它只是让我设置日期，时间似乎是空的，但在数据库视图中我有一个日期时间值。

豆豆

```
import java.util.Date;
@ManagedBean(name="scheduleController")
@SessionScoped
public class ScheduleController implements Serializable {

private Date dteBeginOrWaitingItem, dteEndOrWaitingItem;

//methods
try
    {
        //eventWaitinglist.clear();
        OrWaitinglistDao orWaitinglistDao = new OrWaitinglistDaoImpl();
        waitingEvents = orWaitinglistDao.getOrWaitinglistKeysByResource(rKey);
        int i = 0;
        Iterator<OrWaitinglist> it2 = waitingEvents.iterator();
        while (it2.hasNext()) 
        {
            orWaitinglist = it2.next();
            dteBeginOrWaitingItem = (Date) orWaitinglist.getWPlannedDate();
            dteEndOrWaitingItem = orWaitinglist.getWPlannedDate();
            //dteEndOrWaitingItem = orWaitinglist.getWPlannedDate();
            reason = orWaitinglist.getWDescription();
            eventResourceAvailPerDay.addEvent(new DefaultScheduleEvent(reason, dteBeginOrWaitingItem, dteEndOrWaitingItem, "waitingitem"));

            i += 1;
            System.out.println("EventWaiting: " + i + " " + dteBeginOrWaitingItem + " " + dteEndOrWaitingItem + " " + reason);
        }
     }
    catch(java.util.EmptyStackException Ex)
    {
        System.out.println(Ex.getMessage());
    } 
```

**工作更新：** 豆：

```
try
    {
        //eventWaitinglist.clear();
        OrWaitinglistDao orWaitinglistDao = new OrWaitinglistDaoImpl();
        waitingEvents = orWaitinglistDao.getOrWaitinglistKeysByResource(rKey);
        int i = 0;
        Iterator<OrWaitinglist> it2 = waitingEvents.iterator();
        while (it2.hasNext()) 
        {
            orWaitinglist = it2.next();
            Long wPlannedDate = orWaitinglist.getWPlannedDate().getTime();
            if (wPlannedDate != 0) {
                Date wPlannedDateConverted = new Date(wPlannedDate);
                dteBeginOrWaitingItem = convertDate(0, 0, wPlannedDateConverted);
                dteEndOrWaitingItem = convertDate(orWaitinglist.getWDuration().intValue(), orWaitinglist.getWAdditionalTime().intValue(), wPlannedDateConverted);
            }
            reason = orWaitinglist.getWDescription();
            DefaultScheduleEvent newResourceEvent = new DefaultScheduleEvent(reason, dteBeginOrWaitingItem, dteEndOrWaitingItem, orWaitinglist);
            newResourceEvent.setStyleClass("waitingitem");
            eventResourceAvailPerDay.addEvent(newResourceEvent);
        }
     }
    catch(java.util.EmptyStackException Ex)
    {
        System.out.println(Ex.getMessage());
    }

public static Date convertDate(Integer wDuration, Integer wAdditionalTime, Date availDate)
{
    Calendar cal = Calendar.getInstance();
    Integer wAdditionalTimeHours, wAdditionalTimeMinutes;
    Integer wDurationHours, wDurationMinutes;

    if(wAdditionalTime != 0 || wDuration != 0) {
        if (wAdditionalTime !=0) {
            wAdditionalTimeHours = (int) Math.floor (wAdditionalTime / 60);
            wAdditionalTimeMinutes = wAdditionalTime - (wAdditionalTimeHours * 60);
            cal.setTime(availDate);
            cal.set(cal.get(Calendar.YEAR), cal.get(Calendar.MONTH), cal.get(Calendar.DATE), cal.get(Calendar.HOUR_OF_DAY), cal.get(Calendar.MINUTE), cal.get(Calendar.SECOND));
            cal.add(Calendar.MINUTE, wAdditionalTimeMinutes);
            cal.add(Calendar.HOUR_OF_DAY, wAdditionalTimeHours);
        }
        if (wDuration != 0) {
            wDurationHours = (int) Math.floor (wAdditionalTime / 60);
            wDurationMinutes = wAdditionalTime - (wDurationHours * 60);
            cal.setTime(availDate);
            cal.set(cal.get(Calendar.YEAR), cal.get(Calendar.MONTH), cal.get(Calendar.DATE), cal.get(Calendar.HOUR_OF_DAY), cal.get(Calendar.MINUTE), cal.get(Calendar.SECOND));
            cal.add(Calendar.MINUTE, wDurationMinutes);
            cal.add(Calendar.HOUR_OF_DAY, wDurationHours);
        }
    } else {
        cal.setTime(availDate);
        cal.set(cal.get(Calendar.YEAR), cal.get(Calendar.MONTH), cal.get(Calendar.DATE), cal.get(Calendar.HOUR_OF_DAY), cal.get(Calendar.MINUTE), cal.get(Calendar.SECOND));
    }
    return cal.getTime();
} 
```

模型更新：

```
<property name="WPlannedDate" type="timestamp">
  <column length="7" name="W_PLANNED_DATE">
    <comment>Planned date</comment>
  </column>
</property> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:30:27.687

java.sql.Date 不会返回时间组件，您应该在创建准备好的语句时使用 java.util.Date 或以任何其他方式查询数据库。

编辑：将 java.util.Date 与 sql 查询一起使用可能会很棘手，因为查询需要 java.sql.Date。它在春天对我有用。如果您不想使用它，那么您也可以使用 java.sql.Timestamp。

请参阅以下文档：

> 8.3.12 日期、时间和时间戳
> 
> 与时间相关的 JDBC 类型共有三种：
> 
> JDBC DATE 类型表示由日、月和年组成的日期。相应的 SQL DATE 类型在 SQL-92 中定义，但它仅由主要数据库的一个子集实现。一些数据库提供支持类似语义的替代 SQL 类型。JDBC TIME 类型表示由小时、分钟和秒组成的时间。相应的 SQL TIME 类型在 SQL-92 中定义，但它仅由主要数据库的一个子集实现。与 DATE 一样，一些数据库提供支持类似语义的替代 SQL 类型。JDBC TIMESTAMP 类型表示 DATE 加上 TIME 加上一个纳秒字段。对应的 SQL TIMESTAMP 类型在 SQL-92 中定义，但仅由极少数数据库实现。因为标准的Java 类java.util。Date 与这三种 JDBC 日期/时间类型中的任何一种都不完全匹配（它包括 DATE 和 TIME 信息，但没有纳秒），JDBC 定义了 java.util.Date 的三个子类来对应 SQL 类型。他们是：
> 
> java.sql.Date 用于 SQL DATE 信息。java.util.Date 基类的小时、分钟、秒和毫秒字段应设置为零。如果提供给 java.sql.Date 构造函数的毫秒数为负数，则驱动程序会将日期计算为 1970 年 1 月 1 日之前的毫秒数。否则，日期将计算为 1 月 1 日之后的指定毫秒数， 1970 年。
> 
> java.sql.Time 用于 SQL TIME 信息。java.util.Date 基类的年、月和日字段设置为 1970、一月和 1。这是 Java 纪元中的“零”日期。java.sql.Timestamp 用于 SQL TIMESTAMP 信息。此类通过添加纳秒字段来扩展 java.util.Date。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T13:56:54.527

编辑：如果您使用 .xml 进行休眠，则将类型更改为时间戳而不是日期。 `<property name="yourdate" column="YOUR_DATE" type="timestamp" />` 因此你有时间在你的数据库上，可以使用 simpledateformat

```
SimpleDateFormat dateFormat = new SimpleDateFormat("dd/MM/yyyy-HH:mm");
dateFormat.format(orWaitinglist.getWPlannedDate()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T15:32:56.020

而不是`java.sql.Date`,`java.sql.Timestamp`并且应该使用匹配方法。oracle 类型`DATE`等效于 JDBC 和 SQL 标准类型`TIMESTAMP`。

`get/setDate`JDBC 规范要求驱动程序在使用其中一种方法时排除时间部分。

# php - 数组和对象的 Codeigniter Datamapper ORM 问题？

> ID：16082737
> 
> 赞同：0
> 
> 时间：2013-04-18T12:16:31.200
> 
> 标签：php, codeigniter, codeigniter-datamapper

我有一个块代码：

```
 // Creat a object
    $privilege = new Privilege();

    // Get all privileges
    $privilege->get_iterated();
    $privileges = $privilege->all_to_array(array('id', 'name', 'description'));

    // Get user privileges
    $user_privileges = $privilege->get_user_privileges(array('id' => (int) $id), FALSE);

    // If user has the privilege which is marked as 1,
    // otherwise marked as 0
    foreach ($privileges as $key => $item) {
        foreach ($user_privileges as $value) {
            $privileges[$key]['has_privilege'] = (in_array($value, $item) == TRUE) ? 1 : 0;
        }
    } 
```

我的问题： **$privileges**包含 cms 中的所有权限，**$user_privileges**包含特定用户的权限。我将**$privileges**与**$user_privileges**进行比较：如果用户具有标记为 1 的权限，否则标记为 0，则我解析为视图

```
$this->_data['privileges'] = $privileges; 
```

鉴于，我必须使用**$privileges['...']** (array) 来显示结果，但我想使用：**$privileges->....(object)**来做到这一点。

我怎样才能做到这一点？非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:13:45.640

如果省略该`$privilege->all_to_array(...)`行，您仍然可以为创建的对象分配新属性。

只需更改 for 循环中的赋值语法，如下所示：

```
$privilege = new Privilege();
// IMPORTANT! 
// Don't use get_iterated if you want to iterate on the results more than once!
$privilege->get();
$user_privileges = $privilege->get_user_privileges(array('id' => (int) $id), FALSE);

foreach ($privileges as $privilege) {
    foreach ($user_privileges as $value) {
        // the individual $privilage instances wont be cloned for the iteration
        // so when we add has_privilage property they will "remember" it 
        // when you iterate on the same $privilages object once again in the vew
        $privilege->has_privilege = (in_array($value, $item) == TRUE) ? 1 : 0;
    }
} 
```

现在在视图中你可以这样写：

```
<?php foreach ($privileges as $privilege): ?>
    <?php print $privilege->name ?> 
    The user <?php print $privilage->has_privilage ? 'have it' : 'dont have it' ?>.
<?php endforeach; ?> 
```

# abap - 将日期运算的结果存储在字符串中

> ID：16082742
> 
> 赞同：3
> 
> 时间：2013-04-18T12:16:46.530
> 
> 标签：abap

以下代码应该从给定日期减去 10 天，将结果存储在字符串变量中并写入。

```
DATA str TYPE string.
DATA date TYPE d.

date = '20130418'. " 2013-04-18
str = date - 10.

WRITE str. 
```

我希望输出为 2013-04-08 或至少是未格式化的 20130408。但实际输出是一个非常神秘的数字，对我来说根本没有意义：

```
734967 
```

有人能解释一下这个数字是从哪里来的吗？

我已经找到了一种解决方法（只需将结果放入另一个 d 类型的变量中，然后将此变量分配给字符串），但我仍然对这个奇怪结果的解释感兴趣。

SAP_BASIS 版本是 702。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T13:40:57.187

看一下[转换规则](http://help.sap.com/SAPHELP_470/Helpdata/EN/fc/eb3434358411d1829f0000e829fbfe/content.htm)：对于减法，日期在内部转换为自 01.01.0001 以来的天数（源类型日期，目标类型 I），然后进行算术运算。如果结果是日期字段，则应用转换（源类型 I/Packed，目标类型 D）回到 YYYYMMDD 的形式。但是，转换 I/Packed 到字符串的定义不同 - 因此字符串包含结果日期和 01.01.0001 之间的天数。

# spring-security - Spring oauth2 验证令牌请求

> ID：16082743
> 
> 赞同：0
> 
> 时间：2013-04-18T12:16:47.093
> 
> 标签：spring-security, oauth-2.0, access-token

oauth2RestTemplate 或访问令牌提供程序是否支持验证令牌请求？

这是流程：

1.  Mobile/Web-App 从第三方认证服务器认证并获得 Access-Token。
2.  用户尝试访问受保护的资源，并按照协议的预期在请求中传递了访问令牌。

是否可以针对第三方服务器检查此令牌？

[我在这里](https://developer.linkedin.com/blog/tips-and-tricks-refreshing-access-token#) 以刷新令牌的形式发现了一些相似之处。

验证请求是 OAuth2 标准的一部分吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:52:21.967

不，OAuth2 不强制使用特定的令牌格式或 API 来验证令牌。这是必须在资源服务器和授权服务器之间独立决定的事情。

例如，使用 Spring Security OAuth2的[UAA项目使用签名的](https://github.com/cloudfoundry/uaa/)[JWT](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-json-web-token-06)令牌，因此资源服务器可以验证内容，而无需直接询问授权服务器。它还提供了一个`/check_token`端点，它将解码令牌并验证它没有过期。

# symfony - Symfony2：创建一个新的 SecurityIdentity

> ID：16082753
> 
> 赞同：2
> 
> 时间：2013-04-18T12:17:24.097
> 
> 标签：symfony, acl, symfony-2.1

我在 Symfony 2.1 中使用 ACL，我需要创建一个新的 SecurityIdentity，以便我的 ACL 可以设置为某种组的功能。

想象以下情况：有用户（具有不同角色）的组，每个组都有用户信息。在组 1 中，具有 ROLE_ADMIN 的用户不能编辑同一组中的其他用户的信息，但在组 2 中，具有 ROLE_ADMIN 的用户可以编辑其他信息。

所以基本上我的 ACL 的功能会根据用户所在的组而有所不同。

我想我会通过创建一个新的“GroupSecurityIdentity”来解决这个问题。然而，类本身是不够的，因为我在使用它时遇到了这个异常：

```
$sid must either be an instance of UserSecurityIdentity, or RoleSecurityIdentity. 
```

我的问题是：如何“注册”我的新 SecurityIdentity，以便可以将其用作 RoleSecurityIdentity 和 UserSecurityIdentity？

有什么更好的方法来实现与我想做的类似的系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:16:58.133

2年前我走上了这条路，结果证明这是一个糟糕的决定。修改 ACL 系统很困难，并且在更新 Symfony 时可能会导致问题。至少有 2 个更好的解决方案。我会将它们全部列出，以便您决定哪个最适合您的需求。

## 新的安全身份

我正在使用`GroupInterface`FOSUserBundle 中的，但我想您也可以使用自己的。需要添加以下文件：

*   [`AclProvider.php`](https://gist.github.com/kgilden/d892d91671209cbe56c2#file-aclprovider-php)

    更改方法是私有的 - 必须复制整个文件，但必须对[`hydrateObjectIdentities`](https://gist.github.com/kgilden/d892d91671209cbe56c2#file-aclprovider-php-L443)

*   [`GroupSecurityIdentity.php`](https://gist.github.com/kgilden/d892d91671209cbe56c2#file-groupsecurityidentity-php)

*   [`MutableAclProvider.php`](https://gist.github.com/kgilden/d892d91671209cbe56c2#file-mutableaclprovider-php)

    我们必须复制整个文件，因为它必须扩展`AclProvider`，但我们使用的是自定义文件，因此无法扩展库存`MutableAclProvider`。改变的方法是[`getInsertSecurityIdentitySql`](https://gist.github.com/kgilden/d892d91671209cbe56c2#file-mutableaclprovider-php-L502)和[`getSelectSecurityIdentityIdSql`](https://gist.github.com/kgilden/d892d91671209cbe56c2#file-mutableaclprovider-php-L572)。

*   [`SecurityIdentityRetrievalStrategy.php`](https://gist.github.com/kgilden/d892d91671209cbe56c2#file-securityidentityretrievalstrategy-php)

接下来：通过提供以下参数重新连接依赖注入容器：

```
<parameter key="security.acl.dbal.provider.class">
    Acme\Bundle\DemoBundle\Security\Acl\Dbal\MutableAclProvider
</parameter>
<parameter key="security.acl.security_identity_retrieval_strategy.class">
    Acme\Bundle\DemoBundle\Security\Acl\Domain\SecurityIdentityRetrievalStrategy
</parameter> 
```

是时候交叉手指，看看它是否有效。由于这是旧代码，我可能忘记了一些东西。

## 为组使用角色

这个想法是让组名对应于角色。

一种简单的方法是让您的`User`实体重新实现`UserInterface::getRoles`：

```
public function getRoles()
{
    $roles = parent::getRoles();

    // This can be cached should there be any performance issues
    // which I highly doubt there would be.
    foreach ($this->getGroups() as $group) {
        // GroupInterface::getRole() would probably have to use its
        // canonical name to get something like `ROLE_GROUP_NAME_OF_GROUP`
        $roles[] = $group->getRole();
    }

    return $roles;
} 
```

一个可能的实现`GroupInterface::getRole()`：

```
public function getRole()
{
    $name = $this->getNameCanonical();

    return 'ROLE_GROUP_'.mb_convert_case($name, MB_CASE_UPPER, 'UTF-8');
} 
```

现在只需按照[食谱文章](http://symfony.com/doc/current/cookbook/security/acl.html)中的说明创建所需的 ACE 。

## 创建选民

最后，您可以使用自定义投票器来检查特定组的存在以及用户是否有权访问所述对象。一个可能的实现：

```
<?php

namespace Acme\Bundle\DemoBundle\Authorization\Voter;

use Symfony\Component\Security\Core\Authentication\Token\TokenInterface;
use Symfony\Component\Security\Core\Authorization\Voter\VoterInterface;

class MySecureObjectVoter implements VoterInterface
{
    /**
     * {@inheritDoc}
     */
    public function supportsAttribute($attribute)
    {
        $supported = array('VIEW');

        return in_array($attribute, $supported);
    }

    /**
     * {@inheritDoc}
     */
    public function supportsClass($class)
    {
        return $class instanceof GroupableInterface;
    }

    /**
     * {@inheritDoc}
     */
    public function vote(TokenInterface $token, $object, array $attributes)
    {
        $result = VoterInterface::ACCESS_ABSTAIN;

        if (!$object instanceof MySecureObject) {
            return VoterInterface::ACCESS_ABSTAIN;
        }

        foreach ($attributes as $attribute) {
            if (!$this->supportsAttribute($attribute)) {
                continue;
            }

            // Access is granted, if the user and object have at least 1
            // group in common.
            if ('VIEW' === $attribute) {
                $objGroups = $object->getGroups();
                $userGroups = $token->getUser()->getGroups();

                foreach ($userGroups as $userGroup) {
                    foreach ($objGroups as $objGroup) {
                        if ($userGroup->equals($objGroup)) {
                            return VoterInterface::ACCESS_GRANTED;
                        }
                    }
                }

                return voterInterface::ACCESS_DENIED;
            }
        }
    }
} 
```

有关选民的更多详细信息，请参阅[食谱示例](http://symfony.com/doc/current/cookbook/security/voters.html)。

* * *

我会避免创建自定义安全身份。使用提供的其他两种方法。如果您将拥有大量记录并且每个记录都必须具有不同的访问设置，则第二种解决方案效果最好。投票者可用于设置简单的访问授权逻辑（大多数较小的系统似乎都属于这种情况）或需要灵活性时。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-12T17:11:41.183

我在这里写下我的答案以跟踪此错误消息。

我用 ACL 实现了组支持，我不得不破解一点 symfony 核心“MutableAclProvider.php”

```
protected function getSelectSecurityIdentityIdSql(SecurityIdentityInterface $sid)
{
    if ($sid instanceof UserSecurityIdentity) {
        $identifier = $sid->getClass().'-'.$sid->getUsername();
        $username = true;
    } elseif ($sid instanceof RoleSecurityIdentity) {
        $identifier = $sid->getRole();
        $username = false;
    }else {
        //throw new \InvalidArgumentException('$sid must either be an instance of UserSecurityIdentity, or RoleSecurityIdentity.');
        $identifier = $sid->getClass().'-'.$sid->getGroupname();
        $username = true;
    }

    return sprintf(
        'SELECT id FROM %s WHERE identifier = %s AND username = %s',
        $this->options['sid_table_name'],
        $this->connection->quote($identifier),
        $this->connection->getDatabasePlatform()->convertBooleans($username)
    );
} 
```

即使提供的对象不是 UserSecurityIdentity 或 RoleSecurityIdentity 的实例，它也会返回一个值。所以现在我可以使用自定义的“GroupSecurityIdentity”

这并不容易实施，但非常适合我的系统。

# r - 按条件将长列分成许多短列

> ID：16082756
> 
> 赞同：0
> 
> 时间：2013-04-18T09:46:45.900
> 
> 标签：r, function

我有一列很长的数字。我希望 R 每次值从零变化时创建一个新列。列的示例：

```
90.1194354 
87.94788274 
80.34744843 
64.06080347 
30.40173724 
0 
0 
0 
0 
0 
16.28664495 
23.88707926 
29.31596091 
48.85993485 
13.02931596 
0 
0 
0 
7.600434311 
20.62975027 
29.31596091 
32.5732899 
```

对于这个例子，我想得到 3 列。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:28:39.510

我不知道您如何期望拥有不同长度的列。用`NA`?

此解决方案使用`rle`并将向量拆分为 a `list`：

```
temp <- c(90.1194354, 87.94788274, 80.34744843, 64.06080347, 30.40173724, 
          0, 0, 0, 0, 0, 16.28664495, 23.88707926, 29.31596091, 48.85993485, 
          13.02931596, 0, 0, 0, 7.600434311, 20.62975027, 29.31596091, 
          32.5732899)

x <- rle(temp == 0)
split(temp, rep(seq_along(x$lengths), times = x$lengths))[c(TRUE, FALSE)]
# $`1`
# [1] 90.11944 87.94788 80.34745 64.06080 30.40174
# 
# $`3`
# [1] 16.28664 23.88708 29.31596 48.85993 13.02932
# 
# $`5`
# [1]  7.600434 20.629750 29.315961 32.573290 
```

# java - 除了模板特定的从搜索中排除页面之外，还有其他替代方法吗

> ID：16082763
> 
> 赞同：0
> 
> 时间：2013-04-18T12:17:48.963
> 
> 标签：java, jakarta-ee, search, content-management-system, aem

我已限制某些页面（例如管理页面）在搜索结果中不可见。使用以下代码

```
map.put("group.1_group.1_property","**jcr:content/cq:template**");
map.put("group.1_group.1_property.1_value","**/apps/MyApp/templates/SampleTemplate**");

map.put("group.1_group.1_property.and","true");
map.put("group.1_group.1_property.operation","unequals");

 final  Query finalQuery = builder.createQuery(PredicateGroup.create(map),
                    session); 
```

这意味着它是特定于模板的搜索过滤，意味着我告诉查询生成器不要显示具有上述指定模板的那些页面。但是**缺点**是，将来如果我们想限制更多页面，这些页面也必须映射到上面的模板。**因此，我们可以在 map 中放置任何其他属性，**而不是在 map 中指定模板，以便搜索限制不是特定于模板的。谢谢， 巴拉吉

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:45:35.853

您的页面还有哪些其他可用属性（特别是管理页面）？例如，如果您有一个特定的属性添加到您的管理页面或您可以排序的其他页面，这可能会起作用。在我工作的一个网站上，我们有一个属性，我们将其放入某些名为 hideInNav 的内容项中。因此，按照这些思路，这就是我的做法：

```
map.put("group.1_group.1_property","jcr:content/hideInNav");
map.put("group.1_group.1_property.1_value","/content/somepath/you/want");

map.put("group.1_group.1_property.and","true");
map.put("group.1_group.1_property.operation","unequals"); 
```

我希望这有助于理解它。我理解正确吗？如果没有，请澄清，我会尽力提供更多帮助。

- - - - - - - -编辑 - - - - - - - - - - - -

如果您没有自定义属性，但您知道这些页面所在的路径，可能还有它们共有的默认属性（如 jcr:title），您可以尝试这样做。像这样：

```
map.put(1_group.0_path","/content/yoursite");
map.put(2_group.0_type","cq:Page");
map.put(3_group.fulltext","test text");
map.put(3_group.fulltext.relPath","jcr:content/@jcr:title"); 
```

当您运行 CQ 时，您可以看到这将如何在本地查询调试器上运行：

```
http://localhost:4502/libs/cq/search/content/querydebug.html?_charset_=UTF-8&query=http%3A%2F%2Flocalhost%3A4502%2Fcontent%2Fsalesportal%2Fen%2Fmobile%2Fresources.assets.get.json%3Fp.limit%3D7%0D%0A1_group.0_path%3D%2Fcontent%2Fyoursite%0D%0A2_group.0_type%3Dcq%3APage%0D%0A3_group.fulltext%3Dtest+text%0D%0A3_group.fulltext.relPath%3Djcr%3Acontent%2F%40jcr%3Atitle 
```

希望这更有帮助。

**编辑#2**

这是我两个答案的摘要，希望也能回答您的最后评论。

为了更全面地回答你的问题（因为你还没有完全得到你想要的东西），我挖得更深一点来找到你需要的信息。作为参考，任何时候进行 XPath 查询时，这都是一个很好的工具：[JCR Query Usecases - jboss](http://docs.jboss.org/exojcr/1.12.13-GA/developer/en-US/html/ch-jcr-query-usecases.html#JCR.PropertyExistenceConstraint)

无论如何，您说您得到的结果不包括缺少“hideInNav”属性的项目。以下是获得这些结果的方法，特别是：

```
map.put("1_group.0_path","/content/yoursite");
map.put("2_group.0_type","cq:Page");
map.put("3_group.1_property","jcr:content/hideInNav");
map.put("3_group.1_property.1_value","not");
map.put("3_group.1_property.operation","not"); 
```

这样，您将在您想要的路径中搜索，获得您想要的结果类型（cq:Page，如果那是您真正要寻找的），并且您将获得没有该属性的结果'隐藏导航'。

# android - 在 Android 中列出列表是否出错？

> ID：16082765
> 
> 赞同：0
> 
> 时间：2013-04-18T12:17:50.817
> 
> 标签：android, list, int

我正在尝试做一些简单的事情，制作一个列表来存储一些整数值

```
public List<int> myList = new List<int>(); 
```

这是我制作列表的尝试，这是我的错误信息：

标记“int”上的语法错误，此标记后预期的尺寸

那么你如何在android中制作一个列表？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T12:20:24.257

```
public List<Integer> myList = new ArrayList<Integer>(); 
```

并且`List`是一个接口，因此您不能创建它的实例，而是使用`ArrayList`.

> 使用整数时出现此错误：无法实例化类型列表

确保您正在导入`java.lang.Integer`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T12:21:36.640

`List`是一个接口，所以你不能实例化。你必须使用`ArrayList`

```
List<Integer> myList = new ArrayList<Integer>(); 
```

# c# - 将 word 文档嵌入另一个 WITHOUT 图标

> ID：16082768
> 
> 赞同：1
> 
> 时间：2013-04-18T12:17:53.223
> 
> 标签：c#, ms-word, openxml, openxml-sdk

如何通过OpenXML SDK将一个word文档嵌入另一个word文档，但显示内容，而不是word的图标？例如，正如我们在 word 中手动执行的那样：从文件中插入对象 -> 不检查“显示为图标”？

我找到了这篇[文章](http://msdn.microsoft.com/en-us/library/office/ee355229%28v=office.12%29.aspx)，但它使用了一个图标。我也尝试使用 OpenXML SDK Productivity Tool，但只显示生成的二进制数据。

**编辑：** 我使用以下代码：

```
DrawAspect = OleDrawAspectValues.Content 
```

然后我添加图像部分：

```
var imagePart = mainDocumentPart.AddNewPart<ImagePart>("image/x-emf", imagePartId);
GenerateImagePart(imagePart); 
```

但我的图像部分 - 只是单词图标的字节数组。因此，在这种情况下会发生以下情况：当我打开生成的文档时，它会将嵌入的文档显示为图标，但是当我双击此嵌入的文档，对其进行编辑并保存更改时，嵌入的文档会显示为内容，所以它可能是可以在不编辑嵌入文档的情况下以某种方式显示此内容吗？我应该使用文档截图的字节数组而不是单词图标的字节数组吗？不确定我描述得很清楚，所以请询问

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T13:39:42.950

恐怕你所要求的几乎是不可能的。就文字文件而言，图标和嵌入文件之间的唯一区别是图像。当您几乎不使用图标 Word 时，只需截取您正在嵌入的文档的屏幕截图并将其插入到图标图形的位置。

我上传了一个从我制作的 Word 文件中获取的示例。在 .docx 文件的**/media**文件夹中找到了这个小宝石。

因此，基本上，如果您无法使用 Icon 来解决此问题，您唯一的选择是以某种方式获取您想要嵌入的 word 文件的图片并插入该图片而不是 Icon 图像。

你会怎么做那不可能是漂亮的。首先，open xml sdk 不包含这样的功能。我也尝试过使用办公室互操作，但没有运气。

我只看到了两种可能的方法来实现这一点。

第一个是通过互操作。您需要安装一个“假装打印机”，例如打印到 PDF 的打印机，而不是将其发送到打印机。然而，这个需要打印成图像格式。Media 文件夹中文件的格式是 .emf，但我不肯定这是一个要求。

无论如何，如果以上方法可行，您可以嵌入该图片，几乎使用您从 Microsoft 链接的示例，只需更改“图标”的大小，该“图标”现在将成为文档的图像。

第二种可能性是将word文档作为一个进程打开，将文档大小设置为72%（或者使文档成为桌面屏幕上唯一的一个），然后抓取一个打印屏幕并将其剪切成文档并将其用作嵌入的图像。

作为记录，我不建议您执行上述任何操作，但这些是我看到的唯一选项。

如果有人对此有更好的解决方案，我会全力以赴。

最后，如果您决定继续进行此操作，如果您回复并告诉我您愿意，我将很乐意编写选项 2 的示例。

*   卡斯帕

![在此处输入图像描述](https://i.stack.imgur.com/PHNyy.jpg)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T12:35:12.450

围绕 open xml 有一个很好的包装 API（Document Builder 2.2），专门设计用于合并文档，可以灵活地选择要合并的段落等。你可以从[这里](http://powertools.codeplex.com/releases/view/74771)下载。

使用此工具，您可以根据需要嵌入另一个 Word 文档的段落或整个 Word 文档。

有关如何使用它的文档和屏幕截图在[这里](http://openxmldeveloper.org/wiki/w/wiki/documentbuilder.aspx)。

希望这可以帮助。

# asp.net - 数据库中的数据行不显示在 rdlc 报告中

> ID：16082770
> 
> 赞同：0
> 
> 时间：2013-04-18T12:17:59.013
> 
> 标签：asp.net, dataset, rdlc

这是我的代码`

```
 protected void btnCreateBill_Click(object sender, EventArgs e)
{
    DisplayReport();

}
private DataTable TotalInfoData()
{
    try
    {
        // Open Sql Connection  
        SqlConnection SqlCon = new SqlConnection(@"Data Source=PRATIKPC;Initial Catalog=dbbilling2.0;Integrated Security=True");
        SqlCon.Open();

        // Create a Command  
        SqlCommand SqlComm = new SqlCommand();
        SqlComm.Connection = SqlCon;
        SqlComm.CommandType = CommandType.Text;
        SqlComm.CommandText = "select * from tblTotalFee where Class='" + ClassDropDownList.SelectedItem.Value + "'and StudentID='" + StudentNameDropDownList.SelectedItem.Value+"'";

        // Create instance of Northwind DataSetXSD  
        DataSet1.tblTotalFeeDataTable TotalInfoData = new DataSet1.tblTotalFeeDataTable();

        // Set a Data Commands  
        SqlDataAdapter SqlDa = new SqlDataAdapter(SqlComm);
        SqlDa.Fill(TotalInfoData); // Fill Data in NorthwindDataSet Object.  

        return TotalInfoData;

    }

    catch (Exception ex)
    {
        throw new Exception(ex.Message);
    }
}
private void DisplayReport()
{
    try
    {
        // Clear the Data Source   
        ReportingForPrintingReportViewer.LocalReport.DataSources.Clear();

        // Set a DataSource to the report  

        // First Parameter - Report DataSet Name  
        // Second Parameter - DataSource Object i.e DataTable  
        ReportingForPrintingReportViewer.LocalReport.DataSources.Add(new ReportDataSource("DataSet1", TotalInfoData()));

        // OR Set Report Path  
        ReportingForPrintingReportViewer.LocalReport.ReportPath = HttpContext.Current.Server.MapPath("~/Report.rdlc");

        // Refresh and Display Report  
        ReportingForPrintingReportViewer.LocalReport.Refresh();
    }
    catch (Exception ex)
    {
        throw new Exception(ex.Message);
    }
} 
```

为什么报告中没有任何输出？我的数据库中有行，但尚未返回。手术后我的报告是这样的。为什么不显示行？ ![在此处输入图像描述](https://i.stack.imgur.com/RKTNh.png)

这是我的数据集![在此处输入图像描述](https://i.stack.imgur.com/I8SvW.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T05:04:41.217

尝试在数据集名称之前添加架构名称。喜欢- `SchemaName_DataSet1`。

```
ReportingForPrintingReportViewer.LocalReport.DataSources.Add(new ReportDataSource("SchemaName_DataSet1", TotalInfoData())); 
```

# c++ - 整数的模

> ID：16082774
> 
> 赞同：1
> 
> 时间：2013-04-18T12:18:22.817
> 
> 标签：c++, int, switch-statement, modulo

我正在编写一个程序，该程序从输入中获取美元金额并以文字形式显示金额。此时无法使用字符串、数组或函数，所以我用 switch 结构解决了它，尽管它不是很有效。

但是，当我将输入从浮点数转换为整数并尝试使用模数找出小数点后的数字时，我的问题就出现了；由于某种原因，它没有返回正确的数字。

所以说 321.78 提取第一个小数（或 8）它返回一个 7。我不太确定为什么会发生这种情况，以及如何修复它。

这是我第一部分的代码

```
float number;
int digit1, digit2, digit3, decimals, decimal1, decimal2, int_number;

cout << "Enter a dollar amount from 0-1000: ";
cin >> number;

int_number = number * 100;

digit1 = (int_number % 1000)/100; //ones
digit2 = (int_number % 10000)/1000; //tens
digit3 = (int_number % 100000)/10000; // hundreds

decimal1 = int_number % 10;
decimal2 = (int_number % 100)/10; 
```

如果输入为 321.78，则 decimal1 应返回 8。我错过了什么吗？任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T12:29:43.050

首先，请收藏[每个计算机科学家应该知道的关于浮点运算的知识](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。

你的问题是浮点精度。试试下面的简单例子：

```
#include <iostream>

int main()
{
    float f;
    std::cin >> f;
    int x = f * 100;
    std::cout << x;
} 
```

你会看到它`x`有价值`32177`。这是因为浮点类型只有一定的精度。`321.78`与a最接近的`float`可表示值是`321.779998779296875`。如您所见，这略小于`321.78`. 当你将它乘以 100 时，你得到的东西比`32178`转换为`int`has value时的值要少一些`32177`。

这里的问题实际上是您正在向用户询问一个`float`值。由于您直接提取到 a`float`中，因此您对用户施加了限制，即他们只能输入可由`float`. 显然这是非常愚蠢的，因为您最终只会将该值转换为`int`. 想象一下自动取款机做到了这一点！会有很多丢失的便士。相反，这里的正确方法是将输入作为字符串读取并解析为适当的`int`值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:42:48.973

这是我的答案，基于 sftrabbit 的评论：

```
#include<cstring>
#include<iostream>
#include<algorithm>

using namespace std;

int main(){

  string str1;
  cout << "enter number:";
  cin  >> str1;

  //READ AS A STRING AND REMOVE '.'

  str1.erase(std::remove(str1.begin(), str1.end(), '.'), str1.end());

  //CAST STRING TO VALUE
  int value = atoi(str1.c_str());

  //LOOP THROUGH THE PROCESS YOUR WERE DOING BEFORE
  int divisor = 10;
  int  counter = 1;
  while(divisor < 10*value){

    cout << "Digit " << counter << " = " << value%divisor/(divisor/10) << endl;
    divisor *=10;
    counter++;
  }

  return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T12:34:03.100

任何精度有限的浮点类型都容易出现舍入错误（谷歌一下，你会得到关于这些问题的大量信息）。

有一些半生不熟的解决方案`floor (number * 100 + 0.5)`，但在特殊情况下仍然存在舍入错误和/或可能在不同平台上给出不同的结果。

对于小数点有限的货币，我不会费心使用浮点数并弄乱它们 - 只需将输入读取为字符串并首先正确解析它，省略与浮点数/双精度数及其问题相关的任何内容。它们只是不适合这项工作的数据类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T12:23:56.803

要逐个提取数字，您可以这样做： int_number = number * 100;

```
hundreds = int_number / 10000;
tens = (int_number - hundreds*10000) / 1000;
ones = (int_number - hundreds*10000 - tens * 1000) / 100
decimal1= (int_number - hundreds*10000 - tens * 1000 - ones * 100) / 10;
decimal2= int_number - hundreds*10000 - tens * 1000 - ones * 100 - decimal1 * 10; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T12:28:32.700

321.78 不能在浮点域中精确表示。你的演员表

```
int_number = number * 100; 
```

只是删除最后一位数字并且不执行四舍五入。尝试

```
int_number = static_cast<int> (floor (number * 100 + 0.5f)) 
```

反而。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T12:32:20.677

这就像将 1.5 转换为整数一样：结果类型没有足够的精度来准确地表示原始值。与 321.78 相同：浮点值不能准确表示该值，最终得到的值比您预期的略小，即 321.77#### 其中 #### 表示额外的十进制数字太繁琐在这里计算。当该值乘以 100 并转换为 int 时，它会被截断，并且 32177.#### 变为 32177。

编辑：忘了提及解决方案。

```
int dollars;
int cents;
char dp;
std::cin >> dollars;
std::cin >> dp;
std::cin >> cents;
cents += dollars * 100; 
```

错误检查留给读者作为练习。

# magento - 如何在 magento 中创建色板以及如何在产品详细信息页面中显示？

> ID：16082777
> 
> 赞同：1
> 
> 时间：2013-04-18T12:18:35.170
> 
> 标签：magento, magento-1.7

我正在使用**Magento 1.7.0.2**。我想在产品详细信息页面中显示**颜色样本。**我已经尝试了很多选择，但我没有得到解决方案。所以任何人都会指导我，我如何创建色板以及如何显示产品详细信息页面。我已经给出了我所需要的示例链接。（例如：[http](http://swatchesproductview.mangoextensions.com/colorswatches/configurable-product-color-and-size.html) ://swatchesproductview.mangoextensions.com/colorswatches/configurable-product-color-and-size.html ）

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T13:39:21.503

vanilla Magento 不支持色板。您将不得不购买扩展程序或编写自己的扩展程序。

如果您想编写自己的，您应该扩展选择属性类型以显示图像，以防您设置某个标志（您必须添加到管理员）。您还应该查看类`Mage_Catalog_Model_Product_Type_Configurable`（您可能必须扩展 getConfigurableAttributes 和 getConfigurableAttributesAsArray 函数以包含每个属性值的图像数据）和`js/varien/configurable.js`包含处理产品页面上属性下拉列表内容加载的 javascript 的文件（这是您必须扩展以显示图像而不是下拉列表的代码）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-07T12:43:18.660

看看这个扩展，它可能有用：

[http://www.magentocommerce.com/magento-connect/gala-color-swatches-free-9787.html](http://www.magentocommerce.com/magento-connect/gala-color-swatches-free-9787.html)

还要检查：

[https://www.magentocommerce.com/magento-connect/product-custom-option-plus-with-option-swatches.html](https://www.magentocommerce.com/magento-connect/product-custom-option-plus-with-option-swatches.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-10-04T10:45:17.540

查看高级产品选项扩展。它提供了色样的功能。 [http://www.magentocommerce.com/magento-connect/advanced-product-options.html](http://www.magentocommerce.com/magento-connect/advanced-product-options.html)

# java - 在 1.6 JVM 上运行的 Jetty 无法运行在 Java 1.6 上编译的 webapp

> ID：16082780
> 
> 赞同：5
> 
> 时间：2013-04-18T12:18:46.850
> 
> 标签：java, tomcat, jvm, jetty

我正在尝试在 Jetty (v9.0) 网络服务器上启动非常简单的 Java webapp。

我使用 maven 构建并创建了战争，从清单文件中可以看出，我使用 Java 1.6u43 在 OS X 上进行编译

META-INF/MANIFEST.MF 的内容

```
Manifest-Version: 1.0
Archiver-Version: Plexus Archiver
Created-By: Apache Maven
Built-By: irraju
Build-Jdk: 1.6.0_43 
```

我在 Ubuntu 上运行 Jetty，可以看出，我的 java 1.6.0_45 版本稍高。如果 java 向后兼容，我的 java 应用程序应该在 jetty 上运行，但由于次要版本不受支持而失败

```
root# java -version
java version "1.6.0_45"
Java(TM) SE Runtime Environment (build 1.6.0_45-b06)
Java HotSpot(TM) Client VM (build 20.45-b01, mixed mode, sharing)

root# java -DDEBUG -jar start.jar 
Exception in thread "main" java.lang.UnsupportedClassVersionError: org/eclipse/jetty/start/Main : Unsupported major.minor version 51.0
    at java.lang.ClassLoader.defineClass1(Native Method)
    at java.lang.ClassLoader.defineClassCond(ClassLoader.java:631)
    at java.lang.ClassLoader.defineClass(ClassLoader.java:615)
    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:141)
    at java.net.URLClassLoader.defineClass(URLClassLoader.java:283)
    at java.net.URLClassLoader.access$000(URLClassLoader.java:58)
    at java.net.URLClassLoader$1.run(URLClassLoader.java:197)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.net.URLClassLoader.findClass(URLClassLoader.java:190)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:306)
    at sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:301)
    at java.lang.ClassLoader.loadClass(ClassLoader.java:247)
Could not find the main class: org.eclipse.jetty.start.Main. Program will exit. 
```

互联网上的其他人在尝试在 1.6* JVM 上运行 Java 1.7 编译的应用程序时遇到了这个问题。我无法弄清楚为什么在我的情况下会发生这种情况，其中两个 ENV 都是 1.6* 并且部署 ENV 的 JVM 版本略高。

如果我在使用 java 1.6.0_45 的 Tomcat 上部署应用程序，它不会抱怨并且工作正常。我在这里错过了一些非常微不足道的东西吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T12:24:50.623

[根据此Jetty 版本列表，](http://www.eclipse.org/jetty/documentation/current/what-jetty-version.html#d0e75) Jetty 9 需要使用 Java 7 运行。

您可以尝试使用 Java 6 自己编译 Jetty 9，但这很可能行不通（否则，Jetty 开发人员也可能自己也这样做了）。

# c++ - 在多重继承中使用 enable_shared_from_this

> ID：16082785
> 
> 赞同：27
> 
> 时间：2013-04-18T12:19:08.000
> 
> 标签：c++, c++11, shared-ptr, multiple-inheritance, enable-shared-from-this

BI`enable_shared_from_this`在我的代码中使用，我不确定它的用法是否正确。这是代码：

```
class A: public std::enable_shared_from_this<A>
{
public:
    void foo1()
    {
        auto ptr = shared_from_this(); 
    }
};

class B:public std::enable_shared_from_this<B>
{
public:
    void foo2()
    {
        auto ptr = shared_from_this(); 
    }
};

class C:public std::enable_shared_from_this<C>
{
public:
    void foo3()
    {
        auto ptr = shared_from_this(); 
    }
};

class D: public A, public B, public C
{
public:
    void foo()
    {
        auto ptr = A::shared_from_this(); 
    }
}; 
```

`make_shared_from_this()`假设它们总是通过`shared_ptr`D调用，这些用法是否正确？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-04-18T12:53:47.127

确实你做错了。如果您有简单的继承，只需从`enable_shared_from this`基类中继承，派生类免费获得。（当然你需要降低结果）

如果你有多重继承（看起来），你必须使用[这里](https://stackoverflow.com/questions/15549722/double-inheritance-of-enable-shared-from-this)和[这里](https://stackoverflow.com/questions/14939190/boost-shared-from-this-and-multiple-inheritance)描述的技巧：

```
/* Trick to allow multiple inheritance of objects
 * inheriting shared_from_this.
 * cf. https://stackoverflow.com/a/12793989/587407
 */

/* First a common base class
 * of course, one should always virtually inherit from it.
 */
class MultipleInheritableEnableSharedFromThis: public std::enable_shared_from_this<MultipleInheritableEnableSharedFromThis>
{
public:
  virtual ~MultipleInheritableEnableSharedFromThis()
  {}
};

template <class T>
class inheritable_enable_shared_from_this : virtual public MultipleInheritableEnableSharedFromThis
{
public:
  std::shared_ptr<T> shared_from_this() {
    return std::dynamic_pointer_cast<T>(MultipleInheritableEnableSharedFromThis::shared_from_this());
  }
  /* Utility method to easily downcast.
   * Useful when a child doesn't inherit directly from enable_shared_from_this
   * but wants to use the feature.
   */
  template <class Down>
  std::shared_ptr<Down> downcasted_shared_from_this() {
    return std::dynamic_pointer_cast<Down>(MultipleInheritableEnableSharedFromThis::shared_from_this());
  }
}; 
```

然后你的代码变成：

```
class A: public inheritable_enable_shared_from_this<A>
{
public:
    void foo1()
    {
        auto ptr = shared_from_this(); 
    }
};

class B: public inheritable_enable_shared_from_this<B>
{
public:
    void foo2()
    {
        auto ptr = shared_from_this(); 
    }
};

class C: public inheritable_enable_shared_from_this<C>
{
public:
    void foo3()
    {
        auto ptr = shared_from_this(); 
    }
};

class D: public A, public B, public C
{
public:
    void foo()
    {
        auto ptr = A::downcasted_shared_from_this<D>(); 
    }
}; 
```

# java - JavaFX 中的关闭对话框

> ID：16082787
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:19:15.917
> 
> 标签：java, javafx-2, javafx

我在 JavaFX 中有这个简单的对话框：

```
Stage dialogStage = new Stage();
dialogStage.initModality(Modality.WINDOW_MODAL);
dialogStage.setScene(new Scene(VBoxBuilder.create()
                .children(new Text(text), new Button("Close")).alignment(Pos.CENTER).padding(new Insets(5)).build(), xSize, ySize, backgroundColor));
dialogStage.show(); 
```

我想在单击`Close`按钮时关闭对话框，因此我以这种方式修改了代码：

```
Stage dialogStage = new Stage();
dialogStage.initModality(Modality.WINDOW_MODAL);
dialogStage.setScene(new Scene(VBoxBuilder.create()
                .children(new Text(text), new Button("Close").setOnAction(new EventHandler<ActionEvent>() {
    @Override
    public void handle(ActionEvent e) {
        aboutDialog();
    }
})).alignment(Pos.CENTER).padding(new Insets(5)).build(), xSize, ySize, backgroundColor));
dialogStage.show(); 
```

但我在 Netbeans 中收到此错误消息：`'void' type not allowed here`

你能告诉他们使用`Close`按钮关闭对话框的正确方法是什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:25:21.777

代替

```
@Override
public void handle(ActionEvent e) {
  aboutDialog();
} 
```

尝试

```
@Override
public void handle(ActionEvent e) {
  dialogStage.hide();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:31:01.767

您有一个`'void' type not allowed here`，因为当您调用该`setOnAction`方法时，它会返回一个`void`对象。为避免此问题，您需要在构建器之外使用处理程序，如下所示：

```
Button but = new Button("Close");
but.setOnAction(new EventHandler<ActionEvent>() {
   @Override
   public void handle(ActionEvent e) {
      aboutDialog();
   }
});

Stage dialogStage = new Stage();
dialogStage.initModality(Modality.WINDOW_MODAL);
dialogStage.setScene(new Scene(VBoxBuilder.create()
                .children(new Text(text), but).alignment(Pos.CENTER).padding(new Insets(5)).build(), xSize, ySize, backgroundColor));
dialogStage.show(); 
```

# ruby - 如何确保用户不能从父引擎中重定向到子引擎中的另一个元素

> ID：16082791
> 
> 赞同：3
> 
> 时间：2013-04-18T12:19:34.100
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.1

我有一些引擎安装在另一个引擎中，因为这个引擎将由来自不同引擎的多个子元素组成。该引擎最终安装在主应用程序中。我的路线如下：

```
Rails.application.routes.draw do

  namespace :Parent_Engine, :path  => "/foo" do
    match "/", :to=>"parent_engine#index"

    resources :parent_engine , :only=>[:show] do
      mount Engine1::Engine => '/engine1'
      mount Engine2::Engine => '/engine2'
    end
  end
end 
```

现在，当我希望看到来自“engine1”的元素时，我只需将 url 作为

```
/parent_engine/:id/engine1/object_type/:id 
```

我面临的问题是我需要通过显式更新浏览器中的 url 来阻止用户访问 engine1 的另一个对象。例如：

从：

```
/parent_engine/1/engine1/object_type/1 
```

至：

```
/parent_engine/2/engine1/object_type/2 
```

我也不能检查已安装的引擎，因为这些引擎也单独安装在容器应用程序中。我只是不希望用户能够在父引擎的上下文中重定向到另一个对象实例。

感谢并提前向您提供任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T22:56:01.673

我不确定你到底想做什么，但我怀疑你可能能够使用路由约束：

```
Rails.application.routes.draw do

  namespace :Parent_Engine, :path  => "/foo" do
    match "/", :to=>"parent_engine#index"

    resources :parent_engine , :only=>[:show] do
      mount Engine1::Engine => '/engine1', :constraints => Engine1Contraint.new
      mount Engine2::Engine => '/engine2'
    end
  end
end 
```

`config/initializers/engine1_contraints.rb`然后你可以定义

```
class Engine1Contraint
  def matches?(request)
    request.path != 'something' || request.env['warden'].user == 'Admin'
  end
end 
```

或者您需要在那里调整的任何规则，从母引擎到控制子引擎。

# iphone - long long 类型定义

> ID：16082792
> 
> 赞同：0
> 
> 时间：2013-04-18T12:19:49.350
> 
> 标签：iphone, ios, objective-c, cocoa-touch, cocoa

我只有基本的objective-c知识。

我看到了一个 iOS 项目的代码片段，它对属性使用以下语句：

```
@interface Store : NSObject
{
}
@property (nonatomic) long long amount; // 2 long type? why?
...
@end 
```

为什么会有 long long 类型定义？

这是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:23:51.303

`long long`（来自 C）通常是一个 64 位整数。

# c# - 如何在 C# 中使用 listBox 将本地数据库项添加到文本框中

> ID：16082793
> 
> 赞同：1
> 
> 时间：2013-04-18T12:19:50.387
> 
> 标签：c#, database, textbox, local

如果有人知道，我有一个问题：我需要做什么才能使用“名字”+“姓氏”、“电子邮件”和“地址”将选定的列表框值添加回他们的文本框中？

这里的**代码**让我可以将我的 textBox 值添加到数据库中，但我喜欢做相反的事情。

```
private void button_add_Click(object sender, EventArgs e)
{
var insertSQL = "INSERT INTO Inimesed (Firstname, Lastname, Email, Address) VALUES (Firstname, Lastname, Email, Address)";

string connectionString = @"Data Source=myDatabase;Password=xxxxxx;";
using (var cn = new SqlCeConnection(connectionString))
using (var cmd = new SqlCeCommand(insertSQL, cn))
    {
         cn.Open();

        cmd.Parameters.Add("@Firstname", SqlDbType.NVarChar);
        cmd.Parameters.Add("@Lastname", SqlDbType.NVarChar);
        cmd.Parameters.Add("@Email", SqlDbType.NVarChar);
        cmd.Parameters.Add("@Address", SqlDbType.NVarChar);

        cmd.Parameters["Firstname"].Value = textBox1_Firstname.Text;
        cmd.Parameters["Lastname"].Value = textBox2_Lastname.Text;
        cmd.Parameters["Email"].Value = textBox3_Email.Text;
        cmd.Parameters["Address"].Value = textBox4_Address.Text;
        cmd.ExecuteNonQuery();

    }
} 
```

有大量关于“如何在 C# 中将文本框项目添加到本地数据库”的教程，但没有“如何将本地数据库项目添加到文本框”的教程。我得到了所有定义的值。我应该在“foreach”命令中使用“foreach”命令、“if”命令还是“if”命令？

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:33:17.190

您将如何决定要检索哪一行？

下面的内容应该根据电子邮件地址从数据库中检索一行，然后使用这些值填充文本框：

```
private void button_retrieve_Click(object sender, EventArgs e)
{
var selectSQL = "select Firstname, Lastname, Email, Address Inimesed where email = @email";

string connectionString = @"Data Source=myDatabase;Password=xxxxxx;";
using (var cn = new SqlCeConnection(connectionString))
using (var cmd = new SqlCeCommand(selectSQL, cn))
{
     cn.Open();

    cmd.Parameters.Add("@Email", SqlDbType.NVarChar);
    cmd.Parameters["Email"].Value = "emailaddresstofind";

    var rdr = cmd.ExecuteReader();
    try
    {
        if (rdr.Read())
        {
            textBox1_Firstname.Text = rdr.GetString(0);
            textBox2_Lastname.Text = rdr.GetString(1);
            textBox3_Email.Text = rdr.GetString(2);
            textBox4_Address.Text = rdr.GetString(3);
        }
        else
        {
            MessageBox.Show("Could not find record");
        }
    }    
    finally
    {
        rdr.Close();
        cn.Close();
    }
} 
```

}

# ios - 尽管我在主线程上发出警报，但屏幕闪烁

> ID：16082797
> 
> 赞同：0
> 
> 时间：2013-04-18T12:19:55.200
> 
> 标签：ios, multithreading, uialertview

我知道 UIKit 的东西应该在 mian 线程上完成，这就是为什么，我确保我的警报视图显示在主线程上。

```
-(void)showAlert:(NSString *)alertMessage{

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:alertMessage message:nil delegate:nil cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
    dispatch_async(dispatch_get_main_queue(), ^{
        [alert show];
    });

} 
```

但是，当我解除警报时，屏幕会闪烁。所以这并没有解决我的问题，我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:26:35.003

如果您从后台线程调用 show alert 方法，请尝试使用

```
 [self performSelectorOnMainThread:@selector(showAlert:) withObject:alertMessage waitUntilDone:YES]; 
```

对于方法调用并将您的 showAlert 方法更改为

```
UIAlertView *alert = [[UIAlertView alloc] initWithTitle:alertMessage message:nil delegate:nil cancelButtonTitle:nil otherButtonTitles:@"OK", nil];
    [alert show]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:45:21.093

为什么不将 UIAlertView 分配到主线程中？此外，您的解决方案还有内存泄漏。尝试这个：

```
-(void)showAlert:(NSString *)alertMessage{

    dispatch_async(dispatch_get_main_queue(), ^{
        UIAlertView *alert = [[UIAlertView alloc] initWithTitle:alertMessage message:nil delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil, nil];
        [alert show];
        [alert release]
    });

} 
```

在您的情况下，“确定”文本实际上应该是取消按钮。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:51:46.590

在您希望在 msgDict 中使用适当的 Title 和 Message 显示 UIAlertView 的位置编写以下代码。

```
 NSMutableDictionary *msgDict=[[NSMutableDictionary alloc] init];
    [msgDict setValue:@"Title for AlertView" forKey:@"Title"];
    [msgDict setValue:@"Message within the AlertView" forKey:@"Message"];

    [self performSelectorOnMainThread:@selector(showAlert:) withObject:msgDict  
                        waitUntilDone:YES]; 
```

然后程序控制到达 showAlert 方法内

```
 -(void)showAlert:(NSMutableDictionary *)msgDict
      {
           UIAlertView *alert=[[UIAlertView alloc] 
                       initWithTitle:[NSString stringWithFormat:@"%@",[msgDict objectForKey:@"Title"]] 
                             message:[NSString stringWithFormat:@"%@",[msgDict objectForKey:"Message"]]
                            delegate:nil 
                   cancelButtonTitle:nil 
                   otherButtonTitles:@"OK", nil];
           [alert show];
      } 
```

# git - 为什么 GitHub 认为我的代码有差异？

> ID：16082802
> 
> 赞同：0
> 
> 时间：2013-04-18T12:20:06.073
> 
> 标签：git, github, newline

当我添加...

```
# Auto detect text files and perform LF normalization
* text=auto 
```

...到我的配置文件，然后 GitHub 应用程序/客户端说存储库中的许多（如果不是全部？）文件已更改。对于他们中的许多人来说，它说*整个*文件已经改变了，尽管它显然没有改变。显然这是行尾的问题，但我不明白为什么会这样。

似乎只要您告诉 Git（通过配置文件）文件类型是文本，那么它就会引发差异。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:24:59.163

使用 text=auto，Git 想要以 LF 格式存储文件——它不会简单地将过滤器应用于那里的内容。因此，任何尚未以 LF 结尾存储的文件都将显示为被修改。您可能希望遵循[eol 转换](http://git-scm.com/docs/gitattributes#_end-of-line_conversion)部分[`gitattributes`手册页](http://git-scm.com/docs/gitattributes)上的建议并执行以下操作：

```
$ rm .git/index     # Remove the index to force Git to
$ git reset         # re-scan the working directory
$ git status        # Show files that will be normalized
$ git add -u
$ git add .gitattributes
$ git commit -m "Introduce end-of-line normalization" 
```

# c++ - 是否可以让现有的 C++ 代码与 Qt 一起使用？

> ID：16082803
> 
> 赞同：0
> 
> 时间：2013-04-18T12:20:06.270
> 
> 标签：c++, qt, qt4

我刚来这地方。我是 Qt 的初学者，但我是 C++ 的中级程序员。我以前用 C++ 和 STL 编写过一个程序（没有代码依赖于平台，整个程序被分成大约十个 .cpp/.h 文件）。现在如果我在 qt 中开发 A Gui，我可以将它链接到我的旧程序还是应该重写所有内容？例如，我使用 fstream 使用文件 IO。但是在 Qt 中我看到有 QFile 所以可以链接它。程序相当冗长。因此，要重写所有内容将非常困难。Gui 对我来说不是强制性的，但我认为它对演示很有好处。它适用于我的项目，所以请尽快回复。如果可能的话，请给我一些示例或站点以供参考。提前谢谢你... Manish

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:42:58.867

你可以为你的程序编写一个 Qt GUI：

一种选择是使用 GUI 创建一个单独的程序，将您的程序作为子进程启动，使用`QProcess`. GUI 程序将发送命令行参数，您可以与之通信。

另一种选择是重写程序的主要部分，使其成为另一个功能。您可以让您的 GUI 程序调用该函数。

`QFile`除非您想重写程序的那部分或使用 Qt 的某个功能，否则无需使用Qt 的其他部分。

# python - 如何使随机文本字符串 csv 与 python 一致？

> ID：16082804
> 
> 赞同：-2
> 
> 时间：2013-04-18T12:20:08.310
> 
> 标签：python

我有以下问题：

我有一个字符串，它是一个文本，有几个`\n`特殊的字符，比如`<>?;.,`

当我将它写入 cvs 文件（或其他文件）时，如何使这个字符串适合一行？

我希望这个字符串在一行中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:51:42.347

通过执行以下操作解决：

```
base64.b64encode(my_text) 
```

然后将其写入文件。

# sublimetext2 - 重新映射 Sublime Text 2 Ctrl-Q 以停止意外退出

> ID：16082805
> 
> 赞同：14
> 
> 时间：2013-04-18T12:20:10.633
> 
> 标签：sublimetext2

我一直在*Sublime Text 2*`Ctrl`中点击+ 。我可以重新映射*Quit*命令以使此键绑定不起作用或需要 ie + +吗？`Q`**`Ctrl``Q``Q`**

 **我已经尝试将它映射到 null -

```
[
    { "keys": ["ctrl+q"], "command": "" }
] 
```

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-08-12T17:38:54.617

最简单的方法是使用 Package Control 安装[Maybs Quit](https://sublime.wbond.net/packages/Maybs%20Quit)，它会重新映射`Ctrl+Q`以询问您是否要退出、关闭视图或窗口、保存或不执行任何操作：

![在此处输入图像描述](https://i.stack.imgur.com/IiBLo.png)

然后，您可以通过键入`Ctrl+Q`后跟 来退出`Enter`。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2014-02-05T10:38:47.503

这是一个老问题，但仍然：

在*MacOS* `Ctrl` (for `Ctrl`+ `Q`) 中`Super`，解决方案是这样的：

```
{ "keys": ["super+q"], "command": "noop" } 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-05-16T04:36:42.687

我将退出重新映射到`Super`++ `Alt`：`Q`

```
{ "keys": ["super+q"], "command": "noop" },
{ "keys": ["super+alt+q"], "command": "exit" } 
```

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2013-04-18T16:22:23.120

我相信你需要给它一些命令。带有空命令的条目将被忽略。尝试做

```
[
    { "keys": ["ctrl+q"], "command": "noop" }
] 
```**

# debugging - 一次调试多个浏览器

> ID：16082821
> 
> 赞同：0
> 
> 时间：2013-04-18T12:20:53.240
> 
> 标签：debugging, browser

是否有可用的工具可以同时提供多个浏览器调试？或者只是一个可以在所有浏览器上单独调试的工具。

单独使用每个浏览器调试工具既耗时又令人困惑，因为工具不同？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:23:11.203

一种方法是让 W3C 验证器验证代码。因此，导航器不必修复错误，它只会在任何地方读取相同的内容

# linux - 主机命令未使用辅助 dns 条目解析反向查找区域

> ID：16082824
> 
> 赞同：1
> 
> 时间：2013-04-18T12:21:15.560
> 
> 标签：linux, dns

我正在使用两个 dns 条目

```
nameserver x.x.x.x
nameserver y.y.y.y 
```

其中 xxxx 是 domain1 的 ip，yyyy 是 domain2 的 ip

我正在使用主机命令进行反向查找。

```
host domain1 gives 2 ip's a and b 
host domain2 gives 2 ip's c and d 
```

现在当我做

```
host a 
```

它给了我反向查找但是

```
host c 
```

才不是 。

主机命令反向查找是否仅适用于主 DNS 而不适用于辅助 DNS。我已经进行了wireshark 捕获，发现没有请求会针对失败的情况发送到辅助dns。

无论我读过什么 /etc/resolver 以下列方式工作：

您应该使用其中的主 dns 和转发器来解析所有要解析的 DC。从 DNS 你可以得到两种类型的错误 NXDOMAIN 超时 NXDOMAIN 是当你的 dns 权威地说我找不到这个域，然后它没有进一步搜索。当您从主 dns 解析器获得超时时，然后继续并尝试使用辅助 dns 进行解析。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:59:11.027

中指定的名称服务器的`/etc/resolv.conf`使用顺序未定义。通常会先使用第一个，如果前面的没有响应，则会使用后续的，但你不能指望这一点。

在任何情况下，您列出的每个解析器都`/etc/resolv.conf`应该具有相同的 DNS 视图，并且应该对给定问题产生相同的答案。

如果您的解析器只能解析某些域而不能解析其他域，则您应该解决该问题。

# hibernate - JPQL 查询 - 如何访问列表

> ID：16082831
> 
> 赞同：1
> 
> 时间：2013-04-18T12:21:42.873
> 
> 标签：hibernate, jpa, jpql

我正在使用 jpql。

但我无法创建查询，因为“tgDeclarationRglts”是一个“列表”。

如何在查询中访问此列表以检索“idDeclarationRglt”？

谢谢 ！

“DeclarationRglt”实体

```
@Id
@SequenceGenerator(name="DECREG_IDDECLARATION_RGLT", sequenceName="SID_DECLARATION_RGLT" , allocationSize = 1)
@GeneratedValue(strategy=GenerationType.SEQUENCE, generator="DECREG_IDDECLARATION_RGLT")
@Column(name="ID_DECLARATION_RGLT")
private long idDeclarationRglt; 
```

“LigneDipRec”实体

```
//bi-directional many-to-many association to TgDeclarationRglt
@ManyToMany(cascade = CascadeType.ALL)
@JoinTable(
    name="TG_DIP_RECOUVREMENT"
    , joinColumns={
        @JoinColumn(name="ID_LIGNE_DIP_REC")
        }
    , inverseJoinColumns={
        @JoinColumn(name="ID_DECLARATION_RGLT")
        }
    )
private List<DeclarationRglt> tgDeclarationRglts; 
```

这是我的查询：

```
select distinct ta3.idTitre from LigneTa3 ta3, DeclarationRglt dec where ta3.tgDeclarationRglt.idDeclarationRglt =:idDecReg and dec.tcTypeDeclarationRglt.cdTypeDeclaration =:typeDec 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-01T03:01:21.223

由于您的查询使用的是您未提供的名为 LigneTa3 的实体，因此很难理解您的问题。

如果我纯粹看你问题的这一部分：

> 如何在查询中访问此列表以检索“idDeclarationRglt”？

那么我认为您正在寻找的所有内容都基于：

```
SELECT d.idDeclarationRglt
FROM LigneDipRec l JOIN l.tgDeclarationRglts d 
```

这显示了访问集合的每个元素的一般方法，您始终可以在更大的查询中使用该方法。

# asp.net - 基于asp.net控件的角色授权配置

> ID：16082833
> 
> 赞同：0
> 
> 时间：2013-04-18T12:21:48.467
> 
> 标签：asp.net, configuration, authorization, roles

有没有办法配置 aspx/ascx 页面的一部分，比如根据角色将页面中的控件限制为用户，比如可以配置的部分级别访问？因此，如果下一次角色被赋予额外的访问权限来查看以前无法访问的部分，我们可以只配置角色而不是更改代码。这个可以配置吗？？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:43:25.773

您可以通过代码：

```
Panel.Visible = Roles.IsUserInRole(..); 
```

或者

```
Panel.Visible = this.User.Identity.IsInRole(".."); 
```

然后，当您将它们添加到角色时，面板变得可见。没有任何内置功能可以将控件绑定到角色，然后更改其可见性。但是，通过代码很容易做到。

# winforms - 使用 BarManager 正确处理快捷方式的策略

> ID：16082834
> 
> 赞同：1
> 
> 时间：2013-04-18T12:21:50.037
> 
> 标签：winforms, devexpress, shortcut, menubar

我们正在使用 DevExpress BarManager 来构建我们的菜单，但我知道下面描述的问题也发生在其他菜单处理组件中：

我们在使用 BarManager 时遇到了一个概念问题。我们有一个基本的表单类，我们所有的表单都从该类派生而来。这个基本表单有一个 BarManager，事实上，它处理出现的每个快捷方式，包括通常由当前焦点控件处理的快捷方式。这当然不是期望的行为。考虑这个例子：如果一个文本框被聚焦，按 CTRL + C 不会导致文本框将其文本值复制到剪贴板。相反，BarManager 将触发 BarItemClick 事件。

现在我们已经评估了几种以通用方式解决这个问题的策略。我们显然要求我们的框架完全处理问题，并且个别程序员或应用程序不关心它。因此，以下示例中建议的解决方案不适用，因为它取决于特定于应用程序的逻辑：[example](http://documentation.devexpress.com/#WindowsForms/CustomDocument5417)。

我们发现基本上有两种方法可以通用地解决这个问题：

1.  BarManager 始终在 BarItemClick 事件处理程序中处理快捷方式。如果一个控件被聚焦，如果可能的话，该控件被告知要处理快捷方式。如果控件无法处理快捷方式（例如，因为快捷方式是 CTRL + S），BarManager 会将事件传递给应用程序（例如，将当前文档保存在 CTRL + S 上）。
2.  BarManager 有一个 ShortcutItemClick 事件，只要出现快捷方式，就会触发该事件。在相应的事件处理程序中，询问焦点控件是否可以处理此快捷方式。如果是（例如 CTRL + C），BarManager 将取消处理快捷方式，并且控件将对快捷方式做出反应，就好像根本没有 BarManager 一样（例如，将控件内容复制到剪贴板）。如果没有（例如 CTRL + S），BarManager 将处理快捷方式，这意味着它会触发其 BarItemClick 事件，这将导致应用程序处理它（例如保存当前文档）。

现在，对于每个解决方案，我们都有几个想法，但它们的实现方式都不是令人满意的：

**对于解决方案 1：**

A) 在焦点控件上调用 BaseEdit.SendKey()。这将是最独立的解决方案，因为没有要实现的逻辑。问题是：调用 BaseEdit.SendKey() 并传递快捷键的键没有效果。例如 SendKey(new KeyEventArgs(Keys.Delete)) 不会删除焦点文本框的选择。我的问题是：为什么这个方法调用没有效果？

B) 定义一个接口 IShortcutHandler，它有一个方法 HandleShortcut()。所有使用的控件都通过以下方式实现接口：

```
public void HandleShortcut(KeyEventArgs args)
{
  base.OnKeyDown(args);
} 
```

这个方案也有调用OnKeyDown没有效果的问题，和A)一样。我的问题是：为什么会这样？

**对于解决方案 2：**

A) 调用控件上的方法，确定控件是否能够处理快捷方式。我的问题是：是否有这样的方法或帮助类或库或任何可以做出决定的东西？

您还有其他可以想到的策略或解决方案吗？

# python - 计算熊猫的中价

> ID：16082835
> 
> 赞同：2
> 
> 时间：2013-04-18T12:21:51.627
> 
> 标签：python, pandas

我正在处理 Pandas 中的盘中时间和报价数据，并努力寻找一种计算加权中间价的好方法。我目前将数据表示为四个数据帧（bid_price、bid_quantity、ask_price、ask_quantity），每个数据帧的列是单独的工具，索引是时间戳。（因此可以将单个投标价格引用为：

```
bid_price['AAPL'][datetime(2013,1,1,9,30,0,0)] 
```

我希望应用的中点公式取决于工具的买卖差价。如果当前价差大于最小刻度增量，则中点将是当时买入价和卖出价的简单平均值。如果点差等于最小值，则根据买卖数量对中点进行加权。

这是当前代码：

```
def get_midprice(bid_price, bid_quantity, ask_price, ask_quantity, tick_increment=0.01):
    if (ask_price - bid_price) > tick_increment:
        return (ask_price + bid_price) / 2
    else:
        return ((bid_price * ask_quantity) + (ask_price * bid_quantity)) / (bid_quantity + ask_quantity) 
```

这适用于单个数据点，并且在以前版本的 pandas 上，它在传递 4 个 DataFrame 时也有效。现在，4 个数据帧引发了异常：

```
raise ValueError("Cannot call bool() on DataFrame.")
ValueError: Cannot call bool() on DataFrame. 
```

我相信这是由于这种变化：[https ://github.com/pydata/pandas/pull/1073](https://github.com/pydata/pandas/pull/1073)

这个问题显然可以通过循环来解决，但是在大型数据集上，这非常慢。有没有更好的办法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T15:12:30.103

正如我试图在评论中传达的那样，您无法`if`按照您尝试的方式对分支进行矢量化，因此虽然代码过去不会引发异常，但几乎可以肯定它没有按照您的意愿进行操作至。这就是为什么`array`s（现在`DataFrame`是 s）在`bool()`被调用时会出错，以帮助避免这个错误。

解决这个问题的一种方法是一个 apply-elementwise 函数，它`DataFrame`通过在（有效）压缩的相应元素上应用一个函数来构建一个新函数。可能有一个，虽然我没用过。（我支持添加一个。有时它很方便，在我们自己开发的 n 维 C# 库中，我有一个 apply-to-matched-elements 函数。）

通常当我需要做这样的 pre-pandas 时，我只计算两个分支，然后合并结果（利用 False ~ 0 和 True ~ 1 的事实）：

```
>>> a = np.arange(10)
>>> a > 3
array([False, False, False, False,  True,  True,  True,  True,  True,  True], dtype=bool)
>>> w = a > 3
>>> (a**2) * w + (1000) * (1-w)
array([1000, 1000, 1000, 1000,   16,   25,   36,   49,   64,   81]) 
```

但在两者中`numpy`，`pandas`我们也可以使用`where`，因此您的代码的一个版本是：

```
def get_midprice(bp, bq, ap, aq, ti):

    above = (ap + bp)/2
    not_above = ((bp*aq) + (ap*bq))/(bq+aq)
    use_above = (ap - bp) > ti

    combined = not_above.where(use_above, above)

    return combined 
```

这种方法的缺点是您必须计算两个分支，并且它使用更多的内存。在实践中它很少给我带来问题，但是 YMMV。请注意，使用乘法的一个小优点（即使它有点慢）而不是`where`它在传递标量时也可以工作。

最后，您还可以考虑更改格式以将信息保持在一起，可能使用分层多索引，但我没有太多经验。

# assembly - 了解指令如何被翻译（计算机体系结构）

> ID：16082839
> 
> 赞同：12
> 
> 时间：2013-04-18T12:22:02.347
> 
> 标签：assembly, embedded, emulation, computer-architecture, 6502

有点令人困惑的问题。但我真的想学习一些低级编程。事情是，像 Arduino/Etc 这样的开发板。真的隐藏了很多正在发生的事情。

我花了一些时间学习计算机体系结构、逻辑/门/顺序逻辑等。（我什至学习了与这一切相关的半导体和电子学物理，只是为了知道到底发生了什么，因为以及如何使用 CMOS 晶体管等制造门）。

但这就是它结束的地方......而且我希望能够理解指令（如十六进制/或汇编/等代码）是如何通过尽可能简单的计算机移动的（我用过的很多书都去了直接从像盖茨到计算机......没有真正的介于两者之间）。甚至一些简单的事情，比如......将值存储在寄存器或内存位置（可能打印到像素？或其他东西）。

我认为有趣的事情甚至可能是最终编写一个模拟器。我有高级语言的经验，但我听说像 6502 这样的东西可能是一个好的开始，因为你使用了很多汇编，而且指令集不是太大。

有谁知道任何可能有帮助的资源/想法/书籍？我已经阅读了“计算系统要素”，虽然......这是一本好书，但我并不觉得它经历了真​​正发生的事情并看到它发生。这可能更像是一个 Electronics.stackexchange 问题，如果是这样，我深表歉意。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-06-25T14:35:54.970

# 概述

你真的有很多选择。我将总结我对如何翻译指令的看法，但我也会提供一些我刚开始时的选择。

# 我的看法

首先，从二进制输入的角度来思考是最容易的。假设您有一个 16 位微处理器。（也就是说，指令以 16 位二进制编码。）考虑一个将数字放入寄存器的汇编操作 SET。例如：

```
SET(R1, 12) // Stores 12 into register 1 
```

让我们任意选择（因为即使在任何标准架构中，选择也确实是任意的）选择将 SET 指令翻译成以下 16 位二进制值 I：

```
0001 0001 0000 1100 
```

基本上，我只是制定了一个约定。但这里是我如何分解它。我*选择*让位 I[15:12]（以[大端](http://en.wikipedia.org/wiki/Endianness)符号表示）表示特定指令。我*选择*让整数 1 对应指令 SET。现在我已经决定了那个约定，我可以说如果我有一个 SET 指令，让位 I[11:8] 对应于寄存器。（显然这意味着我将只有 16 个寄存器：4^2=16）。最后，我让位 I[7:0] 对应于我要存储在给定寄存器中的数据。让我们再看一下二进制的 SET(R1, 12) （为了清楚起见，我用换行符分隔每组四个）：

```
if I =  0001 0001 0000 1100
I[15:12] = 0001 (binary) = 1 (decimal) = SET instruction
I[11:8] = 0001 (binary) = 1 (decimal) = R1 since I[15:12] correspond to SET.
I[7:0] = 0000 1100 (8-bit binary) = 12 (decimal) = value to store in R1. 
```

如您所见，微处理器中的其他一切都变得非常简单。假设您在 RAM 中存储 4 行指令。你有一个附在时钟上的计数器。计数器通过 RAM 中的行计数。当时钟“滴答”时，一条新指令从内存中出来。（即*下一*条指令从 RAM 中出来——尽管在插入 JUMP 语句后这可能有点随意。） RAM 的输出通过多个位选择器。您选择位 I[15:12] 并将它们发送到控制单元 (CLU)，它会告诉您要传达的指令*。*即 SET、JUMP 等。然后根据找到的指令，您可以决定允许写入寄存器或添加寄存器，或者您选择在架构中包含的任何其他内容。

现在幸运的是，已经为您选择了机器指令二进制值的任意约定（如果您想遵循它们）。这*正是*指令集架构 (ISA) 所定义的。例如[MIPS](http://www.mrc.uidaho.edu/mrc/people/jff/digital/MIPSir.html)、[HERA](http://www.haverford.edu/computerscience/resources/software/HERA/HERA2_3_2.pdf)等。为了清楚起见，您在设计电路时创建的实际实现被称为*微架构*。

# 学习资源

## 文本

哈里斯和哈里斯的书是本科计算机体系结构课程最著名的教材之一。这是一个非常简单和有用的文本。整个事情都可以在[这里](https://www.uop.edu.jo/download/research/members/Digital_Design_and_Computer_Architecture.pdf)免费获得一些随机学校的PDF格式。（快速下载！）我发现它非常有帮助。它涵盖了基本电路、离散数学主题，当你读到第 7 章时，构建微处理器已经是小菜一碟了。读完那本书后，我花了大约 3 天时间完成了一个 16 位微处理器。（当然，我有离散数学的背景，但这并不是很重要。）

另一本超级有用且非常标准的书是[Hennessy 和 Patterson](http://vr.sdu.edu.cn/~gb/Architecture/courseware/Computer%20Architecture,%20Fifth%20Edition-%20A%20Quantitative%20Approach.pdf)的书，它*也*可以从一些随机学校以 PDF 格式提供。（快速下载！）哈里斯和哈里斯的书是基于这本书的简化。这本书讲得更详细。

## 开源微处理器

那里有大量的开源微处理器。当我构建我的第一个微处理器时，能够参考它们对我非常有帮助。带有 Logisim 文件的文件特别好用，因为您可以以图形方式查看它们，然后像​​这样单击并弄乱它们。以下是一些我最喜欢的网站和特定的国会议员：

4位：

*   [非常简单的微处理器](http://www.csit-sun.pub.ro/courses/vlsi/Very%20Simple%20microprocessor.pdf)- ISA 和设计

16 位：

*   [一些随机的俄罗斯人的微处理器](http://vng3333.wordpress.com/2011/09/06/my-16-bit-risc-processor/)- Logisim 文件
*   [Warren 的 CPU](http://minnie.tuhs.org/Programs/UcodeCPU/) - Logisim 文件
*   [初等微处理器](https://code.google.com/p/elementary-microprocessor/)- Logisim 文件

[Open Cores](http://opencores.org) - 我真的不明白这个网站。我申请了一个帐户，但他们还没有真正回来......不是一个大粉丝，但我想如果你有一个帐户，那一定很棒。

# 工具

## 逻辑西姆

如前所述，[Logisim](http://ozark.hendrix.edu/~burch/logisim/)是一个很好的资源。布局完全是图形化的，您可以通过选择一条线很容易地在任何时间点按位查看正在发生的事情。它是用 Java 编写的，所以我很确定它可以在您想要的任何机器上运行。这也是图形计算机编程语言的一个有趣的历史观点。

### 模拟

在 Logisim 中，您可以模拟正在运行的实际软件。如果您有一个编译器可以将二进制文件编译到您的目标 ISA，那么您可以简单地将二进制文件或十六进制文件加载到 Logisim RAM 中并运行程序。（如果你没有编译器，编写一个四行汇编程序并自己手动翻译它仍然是可能的，也是一个很好的练习。）模拟是整个过程中最酷和最令人满意的部分！:D Logisim 还提供了一个[CLI](http://ozark.hendrix.edu/~burch/logisim/docs/2.5.0/en/guide/verify/index.html)来以编程方式执行此操作。

## 高密度脂蛋白

生成/设计微架构的更现代形式是通过使用硬件描述语言 (HDL)。最著名的例子包括 Verilog 和 VHDL。这些通常（令人困惑！）以 Ada 和 C/C++ 等顺序语言为模型。然而，这是迄今为止首选的设计方法，因为模型/设计的验证得到了更好的定义。在我看来，推理文本表示比用图形检查要容易得多。正如程序员不能很好地组织代码一样，硬件开发人员也不能很好地组织微架构图形设计的图形布局。（尽管这个论点当然可以应用于 HDL。）以文本方式记录仍然比以图形方式记录更容易，并且通常使用 HDL 进行更模块化的设计。

如果您有兴趣学习这一点，这里有大量的本科硬件课程，包括开放课程和实验室工作，讨论和学习使用 HDL 描述电路和微架构。你可以通过谷歌搜索找到这些。或者您也可以尝试通过下一步学习 HDL - 将 C/C++ 代码转换为 HDL 的工具。如果您有兴趣，那么[Icarus Verilog](http://iverilog.icarus.com)是一个很好的 Verilog 开源编译器和模拟器。

### 模拟

使用 Icarus Verilog 之类的工具，您还可以轻松地模拟从二进制文件运行的真实程序。您只需将微处理器包装在另一个 Verilog 脚本中，该脚本通过某些总线将文件或字符串加载到 RAM 中。小菜一碟！:D

## HLS

近年来，高水平综合（HLS）也在市场上获得了[重要](http://cadlab.cs.ucla.edu/~cong/papers/j-83.pdf)的立足点。这是将 C/C++ 代码转换为实际电路的过程。这是非常不可思议的，因为现有的 C/C++ 可以（但不总是）转换为硬件。

（我说并非总是如此，因为并非所有 C/C++ 代码都是可*合成*的。在电路中，比特流同时存在于任何地方。在软件中，我们认为代码是顺序的。如果你正在尝试，这是一种糟糕的思考模式设计硬件！！）

但正如您可能猜到的那样，这种能力对于优化硬件上代码的某些方面（例如矩阵运算或一般数学）来说是不可思议的。但是，这与您相关，因为您可以使用 HLS 工具查看如何将点积的 C 实现（例如）转换为 HDL。我个人觉得这是一个很好的学习方式。

### 模拟

HLS 仿真与仿真 HDL 一样简单，因为高级代码只是简单地转换*为*HDL。然后，您可以完全按照我上面解释的方式对其进行模拟和运行测试。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-18T12:24:38.060

尝试构建自己的简单 CPU。它并不像看起来那么难： [LOGISIM](http://ozark.hendrix.edu/~burch/logisim/)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-19T00:57:57.387

这是一个非常简单的 6502 指令集模拟器的示例框架（因为您不止一次提到 6502）。它从一个简单的 6502 程序开始，这些是我将要演示的唯一说明，但即使使用这样的程序，您也可以理解并立即获得一些工作的满足感。

```
 and #$00
   ora #$01
 top:
   rol
   bcc top
   and #$00 
```

是的，我很清楚我没有正确启动模拟器。我假设这个二进制文件基于地址零，使用 xa65 汇编程序（apt-get install xa65）。组装后的二进制文件是：

```
hexdump -C a.o65 
00000000  29 00 09 01 2a 90 fd 29  00                       |)...*..).|
00000009 
```

这是简单的简化指令模拟器

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

FILE *fp;

#define MEMMASK 0xFFFF
unsigned char mem[MEMMASK+1];

unsigned short pc;
unsigned short dest;
unsigned char a;
unsigned char x;
unsigned char y;
unsigned char sr;
unsigned char sp;
unsigned char opcode;
unsigned char operand;

unsigned char temp;

int main ( void )
{
    memset(mem,0xFF,sizeof(mem)); //if we execute a 0xFF just exit

    fp=fopen("a.o65","rb");
    if(fp==NULL) return(1);
    fread(mem,1,sizeof(mem),fp);
    fclose(fp);

    //reset the cpu
    pc=0; //I know this is not right!
    a=0;
    x=0;
    y=0;
    sr=0;
    sp=0;
    //go
    while(1)
    {
        opcode=mem[pc];
        printf("\n0x%04X: 0x%02X\n",pc,opcode);
        pc++;
        if(opcode==0x29) //and
        {
            operand=mem[pc];
            printf("0x%04X: 0x%02X\n",pc,operand);
            pc++;
            printf("and #$%02X\n",operand);
            a&=operand;
            if(a==0) sr|=2; else sr&=(~2);
            sr&=0x7F; sr|=a&0x80;
            printf("a = $%02X sr = $%02X\n",a,sr);
            continue;
        }
        if(opcode==0x09) //ora
        {
            operand=mem[pc];
            printf("0x%04X: 0x%02X\n",pc,operand);
            pc++;
            printf("ora #$%02X\n",operand);
            a|=operand;
            if(a==0) sr|=2; else sr&=(~2);
            sr&=0x7F; sr|=a&0x80;
            printf("a = $%02X sr = $%02X\n",a,sr);
            continue;
        }
        if(opcode==0x2A) //rol
        {
            printf("rol\n");
            temp=a;
            a<<=1;
            a|=sr&0x01;
            sr&=(~0x01); if(temp&0x80) sr|=0x01;
            if(a==0) sr|=2; else sr&=(~2);
            sr&=0x7F; sr|=a&0x80;
            printf("a = $%02X sr = $%02X\n",a,sr);
            continue;
        }
        if(opcode==0x90) //bcc
        {
            operand=mem[pc];
            printf("0x%04X: 0x%02X\n",pc,operand);
            pc++;
            dest=operand;
            if(dest&0x80) dest|=0xFF00;
            dest+=pc;
            printf("bcc #$%04X\n",dest);
            if(sr&1)
            {
            }
            else
            {
                pc=dest;
            }
            continue;
        }
        printf("UNKNOWN OPCODE\n");
        break;
    }
    return(0);
} 
```

以及该简单程序的模拟器输出。

```
0x0000: 0x29
0x0001: 0x00
and #$00
a = $00 sr = $02

0x0002: 0x09
0x0003: 0x01
ora #$01
a = $01 sr = $00

0x0004: 0x2A
rol
a = $02 sr = $00

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0004: 0x2A
rol
a = $04 sr = $00

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0004: 0x2A
rol
a = $08 sr = $00

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0004: 0x2A
rol
a = $10 sr = $00

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0004: 0x2A
rol
a = $20 sr = $00

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0004: 0x2A
rol
a = $40 sr = $00

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0004: 0x2A
rol
a = $80 sr = $80

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0004: 0x2A
rol
a = $00 sr = $03

0x0005: 0x90
0x0006: 0xFD
bcc #$0004

0x0007: 0x29
0x0008: 0x00
and #$00
a = $00 sr = $03

0x0009: 0xFF
UNKNOWN OPCODE 
```

如果您从头开始编写完整的 6502 指令集，那么它是一个长周末的最低工作量，当您发现一些东西时，您可能最终会重新启动项目几次，非常自然。处理器的硬件（通常，不一定是 6502）在概念上与模拟器中发生的情况并没有太大的不同。您必须获取指令、解码指令、获取操作数、执行并保存结果。就像在软件中执行此操作一样，在硬件中，您可以创建有趣的方法来使其更快或更小，或者无论您的目标是什么。

如果你实现整个东西，6502仍然是一个大项目，没有z80那么大，但是像risc16这样的东西可能需要半个小时来理解和编写整个模拟器（然后再花半个小时来制作一个汇编器）。pic12、14 或 16 比 risc16 工作量更大，但也不会太多，可以快速完成它，并且是一种设计简单的教育体验。pdp11 和 msp430 毫无疑问在某种程度上是相关的，两者都有很好的记录（我提到的所有这些都有很好的记录）并且很好/大部分是正交的，并且类似 RISC 的解码与像 6502/z80/x86 这样的 cisc 是不同的体验。（gcc/gnu 工具原生支持 pdp11）。如果您可以围绕分支延迟槽运行算法，则 Mips 非常简单。

祝你好运，玩得开心……

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-06-22T01:28:11.750

麻省理工学院将其计算结构课程 6.004 的所有资源放到网上。它本质上是一个计算机体系结构简介课程，非常注重基于项目的学习。

OpenCourseWare 版本在[这里](http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-004-computation-structures-spring-2009/index.htm)。我将特别关注[实验室](http://ocw.mit.edu/courses/electrical-engineering-and-computer-science/6-004-computation-structures-spring-2009/labs/)，特别是 2、3、5 和 6，它们将带您从构建加法器到 ALU 一直到非常简单的处理器（Beta）。

最新课程资料的链接在[这里](http://6004.mit.edu/)。

我记得当我上这门课时，第一次在理解简单的逻辑门和电子元件如何转化为我用来模拟它的复杂机器方面，一切都“点击”了。强烈推荐的资源。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-04-18T17:29:48.507

*Noam Nisan 和 Shimon Schocken 2005 ISBN 9780262640688 所著的The Elements of Computing Systems*是一本可以让您逐步从大门到功能齐全的计算机甚至更远的文本。他们的网站位于[www.nand2tetris.org](http://www.nand2tetris.org)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-05-14T22:12:42.680

[《汇编语言的艺术](http://cs.smith.edu/~thiebaut/ArtOfAssembly/artofasm.html)》的前几章讨论了如何使用锁存器物理存储位，并介绍了如何使用锁存器来组装寄存器以保存数据字节，以及如何在硬件中实现诸如左/右移位之类的指令。可能没有你想要的那么深入，但是当我读到这些东西时，它真的让我大开眼界。

# php - if else 语句不正确的速记

> ID：16082841
> 
> 赞同：0
> 
> 时间：2013-04-18T12:22:06.410
> 
> 标签：php, codeigniter

我有以下三元运算符：

```
<?php (strcmp($activetab,'profile') == 0 ? echo "active" : '');  ?> 
```

不幸的是，它没有按预期工作。我希望如果条件为真，那`active`将得到回应，否则什么都没有。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T12:23:27.763

现在试试

```
<?php echo (strcmp($activetab,'profile') == 0) ?  "active" : '';  ?> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T12:38:38.497

`$comp ? $a : $b`语法**并不是**真正的简写

`if ( $comp ) { $a; } else { $b }`

它实际上是这样的：

`function ($comp, $a, $b) { if ( $comp ) { return $a; } else { return $b; } }`

所以确实尝试`echo (strcmp($activetab,'profile') == 0 ? "active" : '');`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T12:23:41.863

只需像这样更改您的代码：

```
<?php echo (strcmp($activetab,'profile') == 0 ?  "active" : '');  ?> 
```

# c# - 在组合框中显示特定值

> ID：16082844
> 
> 赞同：1
> 
> 时间：2013-04-18T12:22:17.237
> 
> 标签：c#, .net, winforms, combobox

这看起来像一个简单的问题，但我完全被卡住了 - 这是问题所在：

我有一个组合框`cmbConstriant`

```
if (!string.IsNullOrEmpty(m_link.ConstraintLayerLinkType))
{
    BindingList<MyConstraintObj> allConstraints = GetAllConstraintLinks(m_project.NetworkLayers);
    cmbConstriant.DataSource = allConstraints;
    cmbConstriant.DisplayMember = "Value";
    cmbConstriant.SelectedText=m_link.ConstraintLayerLinkType;  
}
else
{
    BindingList<MyConstraintObj> allConstraints = GetAllConstraintLinks(m_project.NetworkLayers);
    cmbConstriant.DataSource = allConstraints;
    cmbConstriant.DisplayMember = "Value";
} 
```

这些值正确绑定但何时`m_link.ConstraintLayerLinkType`为空。

当它有一些字符串时，它应该显示该值和其他值应该在下拉列表中。基本上`m_link.ConstraintLayerLinkType`是用户从下拉列表中选择的值。

两种情况都显示相同的结果

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:30:52.633

尝试

```
cmbConstriant.SelectedIndex = cmbConstriant.Items.IndexOf(m_link.ContraintLayerLinkType); 
```

编辑：

我看到您正在将类的项目添加`MyConstraintObj`到组合中。在`MyConstraintObj` 课堂上添加这个 -

```
public override bool Equals(object obj)
{
    String sCompareString = obj as String;
    if (sCompareString == null) return false;
    return ConstraintLayerLinkType == sCompareString;
} 
```

IndexOf 函数将您传递的项目（字符串）与组合框中的所有其他项目进行比较，但由于它们是 type `MyConstraintObj`，因此比较不正确，此函数将强制仅将变量`ConstraintLayerLinkType`与您传递的任何字符串值进行比较。

# c# - 在 C# 中从 facebook 获取好友列表（REST 服务）

> ID：16082848
> 
> 赞同：0
> 
> 时间：2013-04-18T12:22:30.103
> 
> 标签：c#, facebook, rest

我正在创建一项休息服务。在那我想从 facebook 获得我所有的朋友。我用下面的代码：

```
 string myAccessToken = "App ID";
        FacebookClient client = new FacebookClient(myAccessToken);

        var friendListData = client.Get("/me/friends");
        JObject friendListJson = JObject.Parse(friendListData.ToString());

        List<FbUser> fbUsers = new List<FbUser>();
        foreach (var friend in friendListJson["data"].Children())
        {
            FbUser fbUser = new FbUser();
            fbUser.Id = friend["id"].ToString().Replace("\"", "");
            fbUser.Name = friend["name"].ToString().Replace("\"", "");
            fbUsers.Add(fbUser);
        } 
```

在这里，我将 accesstoken 作为我的应用程序 ID 传递。我认为，它有问题。那么，我应该在那里通过什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:34:02.477

正如我在我的问题中提到的那样，传递访问令牌的值有问题。我从这里找到它：http: [//facebooksdk.net/docs/web/getting-started](http://facebooksdk.net/docs/web/getting-started) 生成访问令牌后，我可以获得好友列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T15:48:03.333

这可能看起来像一个愚蠢的响应，但你有没有在你的 JOBJECT 上设置一个断点来查看你是否从 FB 得到任何类型的响应？

# javascript - 如何将多个画布元素放入一个画布元素中？

> ID：16082849
> 
> 赞同：5
> 
> 时间：2013-04-18T12:22:35.707
> 
> 标签：javascript, html, canvas

我有多个由 JavaScript 创建的画布元素。我的问题是：“如何将多个画布元素放到一个画布元素中？”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T12:51:44.663

干得好;

[JSfiddle](http://jsfiddle.net/Allendar/UqxCY/)

*   它将抓取每个画布并将它们制作成 PNG
*   访问缓冲区画布并在其中写入PNG
*   将缓冲区画布写回 PNG 并将其发送到 IMG-tag

只需给`#buffer`画布元素`display: none;`，一切都会不可见（检查这里；[http://jsfiddle.net/Allendar/UqxCY/2/](http://jsfiddle.net/Allendar/UqxCY/2/)）。

**HTML**

```
<body onload="generatePNG()">
    <canvas id="c1"></canvas>
    <canvas id="c2"></canvas>
    <canvas id="c3"></canvas>

    <canvas id="buffer"></canvas>

    <div id="output">Empty</div>
</body> 
```

**CSS**

```
canvas[id^=c], div[id=output] {
    border: 1px solid red;
}

canvas[id=buffer] {
    border: 1px dotted green;
}

#output {
    padding: 15px;
}

#output img {
    border: 1px dotted blue;
} 
```

**JavaScript**

```
function generatePNG() {
    var b_canvas1 = document.getElementById("c1");
    var b_context1 = b_canvas1.getContext("2d");
    b_context1.fillRect(10, 50, 50, 50);
    var b_canvas2 = document.getElementById("c2");
    var b_context2 = b_canvas2.getContext("2d");
    b_context2.fillRect(80, 50, 50, 50);
    var b_canvas3 = document.getElementById("c3");
    var b_context3 = b_canvas3.getContext("2d");
    b_context3.fillRect(150, 50, 50, 50);

    var img1 = new Image();
    img1.src = b_canvas1.toDataURL("image/png");
    var img2 = new Image();
    img2.src = b_canvas2.toDataURL("image/png");
    var img3 = new Image();
    img3.src = b_canvas3.toDataURL("image/png");

    var buffer = document.getElementById("buffer");
    var buffer_context = buffer.getContext("2d");
    buffer_context.drawImage(img1, 0, 0);
    buffer_context.drawImage(img2, 0, 0);
    buffer_context.drawImage(img3, 0, 0);

    var buffer_img = new Image();
    buffer_img.src = buffer.toDataURL("image/png");

    var output = document.getElementById('output');
    output.innerHTML = '<img src="' + buffer_img.src + '" alt="Canvas Image" />';
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T15:52:19.200

画布的 drawImage 方法实际上可以使用另一个画布而不是图像 - 您不需要先将画布转换为图像。（请参阅[WhatWG 的文档](http://www.whatwg.org/specs/web-apps/current-work/multipage/timers.html#images)。）

我简化了 Allendar 的 JSFiddle 来演示：

[http://jsfiddle.net/7hEKL/](http://jsfiddle.net/7hEKL/)

基本上，您需要做的就是：

```
targetCanvas.drawImage(sourceCanvas, 0, 0); 
```

你应该很高兴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:41:03.667

也许像这样，将源画布导出到图像，将该图像绘制到目标画布（未经测试）：

```
function drawCanvasOnOtherCanvas(src, target) {
  var img = new Image();
  img.onload = function() {
    target.drawImage(img, 0, 0);
  };
  img.src = src.toDataURL('image/png');
} 
```

# ruby - Ruby mixins——获取和设置基类的类变量

> ID：16082850
> 
> 赞同：0
> 
> 时间：2013-04-18T12:22:42.740
> 
> 标签：ruby, mixins

在基类中设置类变量的最佳方法是什么？考虑以下代码片段，它定义了`CacheMixin`用于 ActiveRecord 模型的 a。对于每个模型，我希望能够定义存储缓存数据的表。有没有更好的方法可以在不使用`class_variable_set`and的情况下做到这一点`class_variable_get`？

```
require 'rubygems'
require 'active_support/concern'

module CacheMixin
    extend ActiveSupport::Concern

    module ClassMethods
        def with_cache_table(table)
            self.class_variable_set('@@cache_table', table)
        end
    end

    def fetch_data
        puts self.class.class_variable_get('@@cache_table')
    end

end

class TestClass
    include CacheMixin
    with_cache_table("my_cache_table")
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:45:45.900

由于您使用的是 Rails，我建议您查看该[`class_attribute`](http://apidock.com/rails/v3.2.13/Class/class_attribute)方法。

如果你想在没有 Rails 的情况下这样做，我建议直接在类对象上设置一个实例变量，而不是使用类变量（这通常被认为是坏消息）。

```
class Foo
  class << self
    attr_accessor :bar
  end
end

Foo.bar = 'hi'
p Foo.bar
#=> 'hi' 
```

# dynatree - 在 jquery dynatree 中，当我单击惰性节点时，节点的类被删除

> ID：16082855
> 
> 赞同：0
> 
> 时间：2013-04-18T12:23:03.997
> 
> 标签：dynatree, jquery-dynatree

我正在使用带有上下文菜单选项的 jquery-dynatree。

对于上下文菜单上的菜单项之一，我需要将整个子树显示为一个选择。即选定的节点及其所有子节点，我可以使用以下代码来做到这一点：

```
node.visit(function(childnode){
    $(childnode.span).addClass("copy");  // <== This works
}); 
```

现在我有两个问题：

1）第一个问题是我有惰性节点选项，所以每当我点击菜单项时，我需要将整个子树显示为选中状态，因为我正在使用下面的代码

```
node.visit(function(childnode){
    childnode.expand(true);  // <== This works
    $(childnode.span).addClass("copy"); // <== Does not work
}); 
```

但它不能完全工作，它只会将节点扩展至我已初始化的级别，并且在扩展后它不会将所需的 CSS 类“复制”添加到自身或子节点。

2）第二个问题是，一旦我手动展开所有节点并选择父节点，以便使用类“复制”显示整个子树，现在每当我单击任何父惰性节点以检索这些子节点时，“复制”类从那些选定的节点中删除

期待一些解决这个问题的技巧。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T05:25:51.820

I have got the solution now for 1st point, as I was trying to click on parent in collapsed mode, I had to first expand the node itself before expanding its children nodes.

```
 node.expand(true); // This line was missing, it made the things work
                node.visit(function(childnode){
                    childnode.expand(true);
                    $(childnode.span).addClass("copy");
                }); 
```

# json - Spring mvc 3 Jqgrid：如何将数据加载到对象列表中的选择类型

> ID：16082859
> 
> 赞同：0
> 
> 时间：2013-04-18T12:23:10.940
> 
> 标签：json, hibernate, spring-mvc, jqgrid

我有 2 个类， User.java 和 Bank.java 。每个用户都有对银行的引用。当我添加新用户时，我必须从银行列表中选择一家银行。所以我的问题是如何将对象列表（来自数据库）加载到 jqGrid 中的选择表单中，并且知道这个选定的数据将作为整数（引用银行表的外键）在数据库中注册，可以你告诉我这是怎么回事。

```
@Entity
public class Utilisateur {

@Id
@GeneratedValue(strategy = GenerationType.AUTO)
private Long idUser;
.
    .
@Autowired
@ManyToOne
private Agence agence;

@ManyToOne
private Banque banque; 
```

这是我的控制器

```
@RequestMapping(value = "/getall", method = RequestMethod.GET)
public @ResponseBody
CustomUserResponse getAll() {

    System.out.println("affichage");

    List<Utilisateur> users = utilisateurDao.getAllUsers();

List<Banque> banks=utilisateurDao.getAllBanks();

    CustomUserResponse response = new CustomUserResponse();
    response.setRows(users);

    response.setRecords(String.valueOf(users.size()));

    response.setPage("1");

    response.setTotal("10");

    return response;
}

    @RequestMapping(value = "/add", method = RequestMethod.POST)
public @ResponseBody
CustomGenericResponse add(

@RequestParam("nom") String nom, @RequestParam("prenom") String prenom,
        @RequestParam("nomAcces") String nomAcces,
        @RequestParam("typeAcces") TypeAcces typeAcces,
        @RequestParam("motPasse") String motPasse,
        @RequestParam("banque") Banque banque

) {

    logger.debug("Received request to add a new user");

    // Construct our new user object. Take note the id is not required.
    // Assign the values from the parameters
    Utilisateur user = new Utilisateur();

    user.setNom(nom);
    user.setPrenom(prenom);
    user.setNomAcces(nomAcces);
    user.setTypeAcces(typeAcces);
    user.setMotPasse(motPasse);
    user.setBanque(banque);
    // Do custom validation here or in your service

    // Call service to add
    Boolean success = utilisateurDao.save(user); 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:31:10.383

如果您查看有关文档

[http://www.trirand.com/jqgridwiki/doku.php?id=wiki:predefined_formatter](http://www.trirand.com/jqgridwiki/doku.php?id=wiki:predefined_formatter)

它们描述了如何生成将在编辑表单中使用的选择事件。

例如：（作为您在银行列的 colModel 中设置的一部分

```
formatter:'select', editoptions:{value:"1:One;2:Two"} 
```

银行的 ID 和名称将是您传递的值。您也可以让网格查询您的控制器来构建此列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T09:21:11.700

我找到了解决方案并且它有效，要生成选择表单，我必须插入一个有效的 html (

```
@RequestMapping(value = "/listBanks")
public @ResponseBody
String listBanques(String idbanq) {

    String select = null;
    String selectfinal = null;
    List<Banque> banks = utilisateurDao.getAllBanks();

    for (Banque b : banks) {

        select = select + "<option value=" + b.getIdBanque() + ">"
                + b.getNom() + "</option>"
    }
    selectfinal = "<select>" + select + "</select>";

    return selectfinal;

} 
```

在 ColModel 中：

```
${name:'idBanque',index:'banque',width:100, editable: true,edittype:"select",editoptions:{dataUrl:"/ConsultationArchive/med/crud/listBanks"}}, 
```

谢谢您的帮助， ：）

# javascript - 使用从 UIWebview 检索 HTML 标记

> ID：16082861
> 
> 赞同：0
> 
> 时间：2013-04-18T12:23:11.613
> 
> 标签：javascript, ios, uiwebview

我正在 iOS 上开发一个自定义 webview，它应该在选择网页上的某些元素时为用户提供特殊选项，因此我正在扩展 UIWebview 并将我自己的按钮添加到 sharedMenuController。因为显示的页面是由使用 xsl 设置样式的 xml 组成的，所以某些标签中有额外的数据，例如

```
<p data-type="MC"><img src="annotation.png"></p> 
```

选择图像时，会弹出 sharedMenuController，如果我按下 Action 按钮，我想接收包含 img 标签的标签。问题是使用 window.getSelection().innerHTML.toString() 给了我一个空字符串和 window.getSelection().getRangeAt(0).commonAncestorContainer.innerHTML.toString() 什么应该是 p-tag，给了我整个 html。

这是我的课：

```
@implementation UICustomWebView

+ (void)initialize
{
    [super initialize];
    UIMenuItem *itemA = [[UIMenuItem alloc] initWithTitle:@"Action" action:@selector(a:)];
    [[UIMenuController sharedMenuController] setMenuItems:[NSArray arrayWithObjects:itemA, nil]];    
}

-(BOOL)canPerformAction:(SEL)action withSender:(id)sender
{    
    if (action == @selector(defineSelection:))
    {
        return YES;
    }
    else if (action == @selector(translateSelection:))
    {
        return YES;
    }
    else if (action == @selector(copy:))
    {
        return NO;
    }
    else if ( action == @selector( a: ) )
    {
        return YES;
    }

    return [super canPerformAction:action withSender:sender];
}

-(void) a:(id)sender
{
    NSLog(@"a %@", [self stringByEvaluatingJavaScriptFromString:@"window.getSelection().getRangeAt(0).commonAncestorContainer.innerHTML.toString()"]);
}
@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:50:18.193

尝试这个：

```
 NSString *htmlString=[[webView stringByEvaluatingJavaScriptFromString:@"getSelectionHtml()"]mutableCopy]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T13:06:11.430

找出问题所在。显然，将单个对象放入 p-tag 会使您在选择对象时选择整个 p-tag。因此，返回完整的 html 是正确的，因为 p-tag 是 body 的子标签。我现在在我的 img 周围使用一个简单的自定义标签，并且我得到了正确的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T08:18:51.350

根据 Ajay 的回答找到了我正在寻找的真正答案：

NSString *htmlString=[[webView stringByEvaluatingJavaScriptFromString:@"getSelectionHtml()"]mutableCopy];

指向一个非本机函数，因此如果没有它调用的 javascript 函数，它是无用的。我在[http://snipplr.com/view.php?codeview&id=10912](http://snipplr.com/view.php?codeview&id=10912)找到了一个似乎可以满足我要求的功能。因此，通过从我的 xsl 将这个 JS 注入我的页面，我得到了获取数据所需的东西。

这是 JavaScript 函数：

```
function getSelectionHTML()
        {
            var userSelection;
            if (window.getSelection) 
            {
                // W3C Ranges
                userSelection = window.getSelection ();
                // Get the range:
                if (userSelection.getRangeAt)
                    var range = userSelection.getRangeAt (0);
                else 
                {
                    var range = document.createRange ();
                    range.setStart (userSelection.anchorNode, userSelection.anchorOffset);
                    range.setEnd (userSelection.focusNode, userSelection.focusOffset);
                }
                // And the HTML:
                var clonedSelection = range.cloneContents ();
                var div = document.createElement ('div');
                div.appendChild (clonedSelection);
                return div.innerHTML;
            } 
            else if (document.selection)
            {
                // Explorer selection, return the HTML
                userSelection = document.selection.createRange ();
                return userSelection.htmlText;
            } 
            else 
            {
                return '';
            }
        }; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T12:25:43.657

```
 NSString *htmlString = [webView stringByEvaluatingJavaScriptFromString:@"document.body.innerHTML"]; 
```

# python - Django中的ImageField与来自磁盘的图像

> ID：16082865
> 
> 赞同：2
> 
> 时间：2013-04-18T12:23:24.047
> 
> 标签：python, django, django-models

我正在 Django 上写一个画廊应用程序，我有一些问题。

我的目标是显示运行我的应用程序的计算机路径中的图像。

例如，我要显示的所有图像都位于“/usr/local/media/pictures”中

如果我在 MEDIA_ROOT 中设置我的路径“/usr/local/media/pictures”然后像这样显示我的图像 => (img src="/media/picture_1.jpg"/) 其中 picture_1.jpg 是没有问题的“/usr/local/媒体/图片”。

但现在我想使用一些直接从图像创建缩略图的应用程序（如 solr-thumbnail）。

我的问题是 solr-thumbnail 从 ImageField 创建缩略图，我不知道如何从路径创建 ImageField。

我已经在 ImageField 上搜索了一些文档，看起来我们需要在模型上声明 ImageField，但我不想将图像存储在我的数据库中。因为我的用户可以从他的文件资源管理器中删除/创建图像。我的应用程序没有上传。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:51:31.493

您可以在此处找到有关低级 api 的说明

[http://sorl-thumbnail.readthedocs.org/en/latest/examples.html#low-level-api-examples](http://sorl-thumbnail.readthedocs.org/en/latest/examples.html#low-level-api-examples)

或者，您可以构造一个 StaticFilesStorage 实例并使用它将 ImageFile 对象传递到您的模板中。

[http://sorl-thumbnail.readthedocs.org/en/latest/template.html#source](http://sorl-thumbnail.readthedocs.org/en/latest/template.html#source)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:54:33.343

> 我的应用程序没有上传。

在这种情况下，使用`ImageField`. 该类型与 a 的大部分区别在于`CharField`一些额外的代码，以使上传更容易。

`CharField`如果它总是在本地机器上，我会使用包含完整图像路径的。

TBH，听起来使用 Django 也没多大意义。如果您正在创建一个旨在对本地文件进行操作的应用程序，您最好使用[wxPython](http://www.wxpython.org/)或类似工具来做一个适当的 GUI。

# c# - LINQ to SQL stored procedures issue

> ID：16082867
> 
> 赞同：-4
> 
> 时间：2013-04-18T12:23:28.413
> 
> 标签：c#, sql-server, linq-to-sql, visual-studio-2012

I am trying to learn more about web development with C# and ASP.Net.

I am using LINQ to store values from a contact form in a database, however, the database also requires a 'Policy ID' that is generated by calling a stored procedure.

I have absolutely no idea how to about calling the stored procedure, obtaining the integer value generated and then using that value to set PolicyID in the table.

Could anybody provide me with a process that will work like so:

Execute SPROC, return POLICY ID. Get PolicyID, set as PolicyNo. add PolicyNo to db.PolicyID

I appreciate some of this information may appear quite amateurish, but I have never used LINQ nor Stored Procedures before. I have been a front end developer up until now.

Thanks in advance!

EDIT:

Here is the C# code used so far:

```
using (MagTestDataContext context = new MagTestDataContext())
    {
        //create new instance of tblPolicy object
        tblPolicy policy = new tblPolicy();
        var policyNo = context.spNextPolicyID();
        //add values to field
        policy.PolicyID = policyNo;
        policy.PolicyHolder = tbName.Text;
        policy.EMail = tbEmail.Text;
        policy.Telephone = tbTelephone.Text;
        policy.Address1 = tbAddressLine1.Text;
        policy.Address2 = tbAddressLine2.Text;
        policy.Address3 = tbAddressLine3.Text;
        policy.Address4 = tbAddressLine4.Text;
        policy.PostCode = tbPostcode.Text;
        policy.ExtraInfo10 = tbInsurer.Text;
        policy.ExtraInfo11 = ddReason.Text;
        policy.ExtraInfo12 = tbOther.Text;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:37:23.443

看起来您正在使用实体框架。如果是这样，那么您可以使用以下命令执行存储过程：

```
using (MagTestDataContext context = new MagTestDataContext())
{
    var policyid = db.ExecuteQuery<int>("DECLARE @ret INT; EXEC spNextPolicyID @ret OUTPUT; SELECT @ret").Single();
} 
```

# php - How to declare functions in PHP?

> ID：16082868
> 
> 赞同：0
> 
> 时间：2013-04-18T12:23:31.477
> 
> 标签：php, function

I want just to `declare` functions **without** the implementations. The implementations have to be in another file.

Is this possible and if so, is there some tricky in that? Is it common practice to do so? I'm curious because I'm coming from a C++.

Example:

----------------- declarations.php -----------

```
<?php
 function first($name, $age);
 function second($country);
?> 
```

----------------- implementations.php -----------

```
<?php 
include (declarations.php);

function first($name, $age)
{
 // here is the implementation
}

function second($country)
{
 // here is the other implementation
}
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T12:25:03.940

我认为您想要的是一个接口，尽管它必须在一个类中实现。

[http://php.net/manual/en/language.oop5.interfaces.php](http://php.net/manual/en/language.oop5.interfaces.php)

由于 PHP 是一种脚本语言，您仍然必须使用`include`. 没有像 C++ 这样的链接阶段。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:28:17.900

不，PHP 没有与头文件等效的头文件，您可以在其中声明一个全局函数并在某处实现它。

正如丹尼尔所写，有一些类似的东西，即接口，但它们的目的是描述所有实现类必须遵守的接口，而不是指示“函数占位符”。

此外，PHP 5.4 版不支持函数或方法重载，因此不能多次声明相同的函数或方法，即使使用不同的参数也是如此。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T12:30:20.947

你能用面向对象编程来解决这个问题吗？具有几个抽象方法的抽象类会做得很好。

```
// File: MyClass.php
abstract class AbstractClass {

    abstract public function first($arg);
    abstract public function second($arg, $arg2);

}

// File: core.php
require_once('MyClass.php');

class MyClass extends AbstractClass {

    public function first($arg) {
        // implementation goes here
    }

    public function second($arg, $arg2) {
        // implementation goes here
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T12:31:27.630

PHP和C++在这一点上有所不同。无需声明和单独实现您的函数。您必须同时执行此操作（在同一文件中声明和实现），然后在脚本中包含（include () 或 require_once ()）函数。

# iphone - Get text of label after Touch it [tableView]

> ID：16082870
> 
> 赞同：0
> 
> 时间：2013-04-18T12:23:34.870
> 
> 标签：iphone, ios, objective-c

I customized the tableView cell which I set a label of time & What I need if I touch/click the label it show the text of that label.

Here is the time label set:

```
cell.time.text = @"5 mins ago";
cell.time.tag = 1;
UITapGestureRecognizer* tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction:)];
[cell.time setUserInteractionEnabled:YES];
[cell.time addGestureRecognizer:tap]; 
```

So when I tapped the label must do the below

```
-(void)tapAction:(id)sender
{
    // I want to get the text of that label for above example must return

    // 5 mins ago
} 
```

Thanks in advance..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:41:46.147

您可以访问点击查看

```
-(void)tapAction:(id)sender
{
    UITapGestureRecognizer *tapRec = (UITapGestureRecognizer *)sender;
    UILabel *label = (UILabel *)tapRec.view;
    NSLog(@"%@",label.text);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:35:20.877

尝试这个

```
-(void)tapAction:(id)sender
{
    UITapGestureRecognizer *recognizer = (UITapGestureRecognizer *)sender;
    UILabel *label = (UILabel *)recognizer.view;
    NSString *text = label.text;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:28:10.430

你为什么不使用委托方法而不是在你的单元格上设置一个手势识别器呢？

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

} 
```

然后，您可以从 indexPath 中提取行，并知道选择了哪个单元格。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T12:28:35.807

使用下面的代码

```
cell.time.text = @"5 mins ago";
cell.time.tag = [indexpath.row];
UITapGestureRecognizer* tap = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(tapAction:)];
[cell.time setUserInteractionEnabled:YES];
[cell.time addGestureRecognizer:tap];

-(void)tapAction:(id)sender
{
 UIbutton *btn = (UIbutton *)sender
 Nsstring *str = [btn.text]
// I want to get the text of that label for above example must return

// 5 mins ago
} 
```

# c# - What is the C# equivalent to std::vector::iterators?

> ID：16082873
> 
> 赞同：2
> 
> 时间：2013-04-18T12:23:40.193
> 
> 标签：c#, c++, vector, iterator

The following code snippet shows an `iterator` from the `std::vector` C++ lib. What is the C# equivalent to this? Can I simply loop through each item in the vector considering its not a linked list? What exactly is the iterator doing here and how can I do the equivalent in C#? The full code is [here](http://pastebin.com/QAADyUAe).

```
 std::vector<KMeanCluster>::iterator closest_cluster = clusters.begin();

    // Figure out which cluster this color is closest to in RGB space.
    for (std::vector<KMeanCluster>::iterator cluster = clusters.begin();
        cluster != clusters.end(); ++cluster) {
      uint distance_sqr = cluster->GetDistanceSqr(r, g, b);

      if (distance_sqr < distance_sqr_to_closest_cluster) {
        distance_sqr_to_closest_cluster = distance_sqr;
        closest_cluster = cluster;
      }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T12:35:11.607

C++ 标准库迭代器的定义方式类似于遍历集合的指针。在 C# 中，每个实现`IEnumerable`的集合都可以`foreach`循环迭代。除此之外，您仍然可以使用 s 在 C# 中执行类似于 C++ 迭代器的操作`Enumerator`（这在大多数情况下会使事情变得更加困难）：

```
IEnumerable<int> myCollection = new List<int> { 1, 2, 3 };
var enumerator = myCollection.GetEnumerator();
while(enumerator.MoveNext())
    Console.WriteLine(enumerator.Current); 
```

实际上，上面是`foreach`循环如何遍历引擎盖下的集合。

```
foreach(int num in myCollection)
    Console.WriteLine(num); 
```

因此，就您的代码而言，这是确切的（但难以编码和理解）等价物：

```
IEnumerator<KMeanCluster> closest_cluster = clusters.GetEnumerator();
while (closest_cluster.MoveNext())
{
    uint distance_sqr = closest_cluster.Current.GetDistanceSqr(r, g, b);
    if (distance_sqr < distance_sqr_to_closest_cluster)
    {
        distance_sqr_to_closest_cluster = distance_sqr;
        closest_cluster = cluster;
    }
} 
```

这是最简单的等价物：

```
foreach(KMeanCluster closest_cluster in clusters)
{
    uint distance_sqr = closest_cluster.GetDistanceSqr(r, g, b);
    if (distance_sqr < distance_sqr_to_closest_cluster)
    {
        distance_sqr_to_closest_cluster = distance_sqr;
        closest_cluster = cluster;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T12:27:10.613

迭代器基本上是一个允许对容器进行串行、非随机访问的对象。无论如何：您可以在 C# 中使用普通循环。foreach 循环在语法上更接近 C++ 原始语法

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T12:28:01.247

在 C# 中，这可能看起来像：

```
var closest_cluster = clusters.FirstOrDefault();
foreach (var cluster in clusters)
{
    uint distance_sqr = cluster.GetDistanceSqr(r, g, b);
    if (distance_sqr < distance_sqr_to_closest_cluster)
    {
        distance_sqr_to_closest_cluster = distance_sqr;
        closest_cluster = cluster;
    }
} 
```

`foreach`运算符所做的是它在下面的用途，这`IEnumerator`相当于您的迭代器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-18T12:29:16.410

通用集合 -[`IEnumerator<T>`](http://msdn.microsoft.com/en-us/library/vstudio/78dfe2yb.aspx)

> 支持对泛型集合的简单迭代。

非通用集合 -[`IEnumerator`](http://msdn.microsoft.com/en-us/library/vstudio/system.collections.ienumerator.aspx)

> 支持对非泛型集合的简单迭代。

这些是接口，应该被继承和覆盖。`MoveNext`和 等方法`Reset`。然后您可以在循环中使用该类。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-18T12:31:43.720

C# 中有一个[`iterator`](http://msdn.microsoft.com/en-us/library/dscyy5s0%28v=vs.80%29.aspx)构造，但在这种情况下，您不需要直接访问它，而是使用[`foreach`](http://msdn.microsoft.com/en-us/library/ttw7t8t6%28v=vs.80%29.aspx)循环。代码可能看起来像这样。

```
Cluster closestCluster = clusters.firstOrDefault();

foreach (Cluster currentCluster in clusters)
{
   //Distance logic
   if (distanceSqr < distanceSqrToClosestCluster)
   {
        closestCluster = currentCluster;
   }
} 
```

在内部通过接口`foreach`访问迭代器[`IEnumerable<Cluster>`](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)

# ruby - Merge hash with array values to one array

> ID：16082876
> 
> 赞同：1
> 
> 时间：2013-04-18T12:23:42.213
> 
> 标签：ruby, merge

How to merge hash with array values to one array:

```
h = {
    one: ["one1", "one2"],
    two: ["two1", "two2"]
} 
```

after merge should be:

```
["one1","one2","two1","two2"] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:29:31.060

```
h.values.flatten
# => ["one1", "one2", "two1", "two2"] 
```

当然，您可以对键执行相同的操作。您在这里需要的唯一原因`flatten`是因为这些值本身就是数组，所以`h.values`单独返回`[["one1", "one2"], ["two1", "two2"]]`。

此外，作为仅供参考，`merge` [在 Ruby 中意味着不同（并且非常有用）的东西](http://ruby-doc.org/core-2.0/Hash.html#method-i-merge)。

如果您想确保它仅展平一个级别（根据@tokland 的评论），您可以提供一个可选参数，`flatten`例如 with `flatten(1)`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T12:59:52.690

```
h.flat_map &:last
=> ["one1", "one2", "two1", "two2"] 
```

# google-maps - jquery goMap 插件和谷歌地图 api V3 fitBounds 到一个国家

> ID：16082877
> 
> 赞同：0
> 
> 时间：2013-04-18T12:23:43.053
> 
> 标签：google-maps, jquery-plugins, google-maps-api-3

我正在使用[goMap jQuery 插件](http://www.pittss.lv/jquery/gomap/)来集成 Google Maps api v3。我在地图上重叠了一些外部控件 - 国家列表，我想将地图的边界设置为点击的国家。

goMap 具有 fitBounds 功能，但它只适合地图上标记的边界。[我在这里](https://stackoverflow.com/questions/2265055/how-to-get-google-maps-api-to-set-the-correct-zoom-level-for-a-country)找到了另一个关于如何使用 Google maps api v2 和 v3 将地图的边界拟合到国家/地区的问题和答案，但我不知道如何将其与 goMap 插件结合使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:39:44.497

我没有使用过 goMap，但您似乎可以使用`$.goMap.map`. 然后，您可以直接使用 Google API `fitBounds`（或其他）功能。同样，我不确定是否会有与 goMap 对象的状态相关的任何不良副作用。

# javascript - 表单验证向后兼容早期版本的 IE

> ID：16082882
> 
> 赞同：0
> 
> 时间：2013-04-18T12:24:02.120
> 
> 标签：javascript, html, internet-explorer, backwards-compatibility

我知道这在 IT 领域是一个持续存在的问题，不同机器之间使用不同版本的 IE，但我想知道是否有人可以建议我如何成功制作此代码（这适用于我的所有表单IE 10、FireFox、Chrome 等中的验证）在早期版本的 IE 中工作。我正在测试它的版本是 IE7。

```
function validate(form){
var p = form.getElementsByTagName("p");
var valid = true;
for(var i = 0; i < p.length; i++){
    var inputs = p[i].getElementsByTagName("*");
    if(p[i].className == "required" || p[i].className == "required error"){
        for(var n = 0; n < inputs.length; n++){
            switch(inputs[n].tagName){
            case "INPUT":
                if(inputs[n].value.trim() == "" || inputs[n].value == null){
                    if(+navigator.sayswho[1] < 9){
                        //JavaScript for IE version 8 and below
                    }
                    else{
                        inputs[n].className = inputs[n].className.replace( /(?:^|\s)error(?!\S)/ , "" );
                        inputs[n].className = inputs[n].className+" error";
                        p[i].className = "required error";
                    }
                    valid = false;
                }
                break;
            case "SELECT":
                if(inputs[n].options[inputs[n].selectedIndex].value == 0 || select.value == null){
                    if(+navigator.sayswho[1] < 9){
                        //JavaScript for IE version 8 and below
                    }
                    else{
                        inputs[n].className = inputs[n].className.replace( /(?:^|\s)error(?!\S)/ , "" );
                        inputs[n].className = inputs[n].className+" error";
                        p[i].className = "required error";
                    }
                    valid = false;
                }
                break;
            }
        }
    }
}
if(valid){
    var elements = form.getElementsByTagName("*");
    for(var i = 0; i < elements.length; i++){
        switch(elements[i].type){
        case "submit":
            elements[i].disabled = true;
            break;
        case "reset":
            elements[i].disabled = true;
            break;
        case "button":
            elements[i].disabled = true;
            break;
        }
    }
    return true;
}
return false; 
```

}

+navigator.sayswho[1] 是我在此处找到的另一个问题的值，它返回一个表示浏览器版本的 int（在本例中为 7）

表单域的一个示例是：

```
 <p class="required">
        <span>Required Field</span>
        <input type="text" id="username" name="username" class="logon_field" onfocus="clearError(this)" placeholder="Username" autofocus />
    </p> 
```

在表单的 onsubmit 属性中使用 validate(this) 调用该方法提前谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T22:29:03.693

啊..在这里做一些看SO。`getElementsByClassName`似乎和有一些问题`IE7`。

[IE7 中的 getElementsByName](https://stackoverflow.com/questions/278719/getelementsbyname-in-ie7)

我会通过将事情分成几个不同的部分来解决它，如下所示。

免费奖金，顺便说一句。'addClass' 'removeClass' 和 'hasClass'

最好将所需的属性（或类）放在输入字段本身上，而不是放在包装器上……尽管您可以设置包装器的类以显示该字段有误。

```
<doctype html>
<html>
<head>
<title>
Test  page
</title>

<script>

function hasClass(ele,cls) {
    return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
    if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
    if (hasClass(ele,cls)) {
        var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
        ele.className=ele.className.replace(reg,' ');
    }
}

function clearError(element) {
}

function validate(form) {
  var i, l;
  var input;
  // First, let's check the input fields
  var inputs = form.getElementsByTagName("input");
  for (i = 0; i < inputs.length; i++) {
    input = inputs[i];

    // Skip stuff we don't want.
    // You'll want password this list yet.
    if (input.type !== "text") {
      continue;
    }

    if (input.required || hasClass(input, "required")) {
    if (input.value == "") {
      alert(input.name + " is required");
      }
    }

  }
}

</script>

</head>
<body>
<form action="#" onsubmit="validate(this); return false">
  <p>
  <label for="username">Required Field</label>
  <input type="text" class="required" id="username" name="username" class="logon_field" onfocus="clearError(this)" placeholder="Username" autofocus />
  </p>

  <p>
  <label for="trivia">Trivia Question</trivia>
  <input type="text" id="trivia" name="trivia" class="" onfocus="clearError(this)" placeholder="Username" autofocus />
  </p>

  <input type="submit">
</form>

</body>
</html 
```

# java - 从句子中找到纯数字，而不是字母数字

> ID：16082883
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:24:07.407
> 
> 标签：java, regex, logic

我正在努力使正则表达式只能从句子中找到数字（纯数字，例如 55），而不是字母数字（第二个）

例如在句子“这是你的第一次测试，你得到了 66 分”所以它应该只找到“66”而不是第 1 次中的“1”。

我试过`Regex (\d+)`了，它找到了两个数字“66”和“1”，但**我只需要纯数字而不是字母数字。**

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T12:25:17.097

尝试检查单词边界：

```
\b\d+\b 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:29:09.853

您可以尝试这个简单的解决方案：

```
\s+\d+\s+ 
```

# css - How do I reduce the distance between the border-bottom and parts of text?

> ID：16082886
> 
> 赞同：1
> 
> 时间：2013-04-18T12:24:19.430
> 
> 标签：css, underline

I'm currently building my website and I've run into a problem. [Here is the webpage.](http://luk-e.com)

I want to add 3px underlines to only the links, like this:

![http://i.stack.imgur.com/KgRjL.png](https://i.stack.imgur.com/KgRjL.png)

The line height of the text is 56pt, so the border-bottom is far too far away from the links. `text-decoration: underline` is too thin, and way too close.

They need to be about half this distance. As negative padding doesn't exist, how should I go about fixing it?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T12:35:53.800

现在习惯了这段代码**（这是演示）**

**CSS**

```
.HomeText p a {
color: red;
text-decoration: none;
position: relative;
display: inline-block;
vertical-align: top;
}
.HomeText p a:hover:after{
    content:'';
    position:absolute;
    left:0;
    right:0;
    bottom:-3px;
    border-bottom:solid 1px red;

} 
```

**[演示链接](http://jsfiddle.net/rohitazad/anbs5/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-20T22:21:44.097

尝试添加以下内容：

```
display: inline-block;
height: 1.2em; 
```

尚未进行广泛测试，但似乎在现代浏览器中很好地缩小了差距。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:38:06.667

**答案 1：**接受 css 有限制并解决它们。

**答案 2：**我能做到这一点的唯一方法是使用 span 显示它是一个块，并在底部添加边框和填充 - 这个过程将打开另一个完整的蠕虫罐，尽管浮动块内联文本等。所以我会回去回答1。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-18T12:36:56.310

你试过这个吗？

```
 a {
    border bottom: 3px red;
    } 
```

# kinect - Kinect 到 BVH 数据

> ID：16082894
> 
> 赞同：0
> 
> 时间：2013-04-18T12:24:43.553
> 
> 标签：kinect, openni, kinect-sdk

是否有任何软件可以直接从 kinect 获取 BVH 数据？我在网上搜索并找到了 Kinect BVH MoCap（[http://tech.integrate.biz/kinect_mocap.htm](http://tech.integrate.biz/kinect_mocap.htm)），但它对我不起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:10:04.827

No. There is no built in mechanism to save Kinect data at all - no matter what format you want it in. The Kinect Studio does save off stream data, but I've not looked at the files to see what they look like internally.

You could look into the [Kinect Toolbox](http://kinecttoolbox.codeplex.com/), which provides functions to save off any of the 3 streams to a file. You can save the file and then manipulate it as necessary, perhaps write a parser to translate the data. Alternatively, you could manipulate the data before you save it off.

You could also write your own parser. The `Skeleton` objects are serializable, which means you could save them to a `List` (or some other array type object) along with a time stamp. When you are ready to save to the file, serialize the `List` and you will get a standard XML dump of the `List` and the `Skeleton` objects inside. Again, you could write a function that just translate it into the proper format before saving it as well.

# javascript - 更改页面后未触发页面显示

> ID：16082895
> 
> 赞同：2
> 
> 时间：2013-04-18T12:24:46.373
> 
> 标签：javascript, html, jquery-mobile, jquery

我正在使用 jQuery Mobile，我想在用户单击主页上的按钮后将浏览器重定向到另一个页面。为此，我写道：

```
$.mobile.changePage("album-search-results.html",{
               data:{area:searchArea, value:searchValue},
               transition: "pop"
           }); 
```

它工作正常，它加载了正确的页面，甚至在 URL 上放置了正确的值。不幸的是，没有触发 pageshow 事件：

```
 <!DOCTYPE html>
<html>
<head>

    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
</head>

<body>
    <div data-role = "page" data-theme = "d" id = "SearchResults">

        <div data-role = "header">
            <h1>Aggregator</h1>
        </div>

        <div data-role = "content">

        </div>
    </div>

    <script type="text/javascript">
        $("#SearchResults").on("pageshow",function(event, ui){
            console.log(ui.prevPage);

        });

    </script>
</body>
</html> 
```

当我从上一个页面加载此页面时，控制台始终为空。怎么了？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T13:09:06.773

# 解决方案

解决方案很简单，将脚本块移动到页面 div 内。在您的情况下，脚本块被丢弃。基本上改成这样：

**从 ：**

```
<body>
    <div data-role = "page" data-theme = "d" id = "SearchResults">

        <div data-role = "header">
            <h1>Aggregator</h1>
        </div>

        <div data-role = "content">

        </div>
    </div>

    <script type="text/javascript">
        $("#SearchResults").on("pageshow",function(event, ui){
            console.log(ui.prevPage);

        });

    </script>
</body> 
```

**至 ：**

```
<body>
    <div data-role="page" data-theme="d" id="SearchResults">
        <div data-role = "header">
            <h1>Aggregator</h1>
        </div>
        <div data-role = "content">

        </div>
        <script>
            $(document).on("pageshow","#SearchResults",function(event, ui){
                console.log(ui.prevPage);
            });
        </script>       
    </div>
</body> 
```

# 例子：

**索引.html**

```
<!DOCTYPE html>
<html>
    <head>
        <title>jQM Complex Demo</title>
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=no; target-densityDpi=device-dpi"/>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
        <script src="http://www.dragan-gaic.info/js/jquery-1.8.2.min.js"></script>      
        <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>    
        <script>
            $(document).on('click', '#change-page', function(){       
                $.mobile.changePage("album-search-results.html",{
                    data:{area:"asda", value:"1"},
                    transition: "pop"
                });
            });                 
        </script>
    </head>
    <body>
        <div data-role="page" id="index">
            <div data-theme="a" data-role="header">
                <h3>
                    First Page
                </h3>
                <a href="#second" class="ui-btn-right">Next</a>
            </div>

            <div data-role="content">
                <a data-role="button" id="change-page">Change Page</a>
            </div>

            <div data-theme="a" data-role="footer" data-position="fixed">

            </div>
        </div>    
    </body>
</html> 
```

**专辑搜索结果.html**

```
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
</head>
    <body>
        <div data-role="page" data-theme="d" id="SearchResults">
            <div data-role = "header">
                <h1>Aggregator</h1>
            </div>
            <div data-role = "content">

            </div>
            <script>
                $(document).on("pageshow","#SearchResults",function(event, ui){
                    console.log(ui.prevPage);
                });
            </script>       
        </div>
    </body>
</html> 
```

# java - CORS Java server side implementation

> ID：16082896
> 
> 赞同：7
> 
> 时间：2013-04-18T12:24:47.517
> 
> 标签：java, http, rest, jersey, cors

I need to implement [CORS](http://www.w3.org/TR/cors) support in Jersey based REST server. I've gone through some of the available [material](http://software.dzhuvinov.com/cors-filter.html) and informative [tutorials](http://www.html5rocks.com/en/tutorials/cors/) . I found two approaches people are using:

**Approach-1 :**

Simple and direct approach where implement one `HTTP` filter which adds `CORS` header to response (Jersey specific)

```
public class ResponseCorsFilter implements ContainerResponseFilter {

public ContainerResponse filter(ContainerRequest req, ContainerResponse contResp) {

        ResponseBuilder resp = Response.fromResponse(contResp.getResponse());
        resp.header("Access-Control-Allow-Origin", "*")
                .header("Access-Control-Allow-Methods", "GET, POST, OPTIONS");

        String reqHead = req.getHeaderValue("Access-Control-Request-Headers");

        if(null != reqHead && !reqHead.equals(null)){
            resp.header("Access-Control-Allow-Headers", reqHead);
        }

        contResp.setResponse(resp.build());
            return contResp;
    }
} 
```

**Approach-2 :**

Fully implement [CORS](http://www.w3.org/TR/cors) as per its specification i.e. preflight request handling and all header support. Inspected source code of one such open-source java implementation [cors-filter](http://software.dzhuvinov.com/cors-filter.html)

My question is which approach should be taken when? What could be the downside of approach-1 vs approach-2?

My use case is all origins/methods can be allowed and `Authorization` HTTP header would be part of all `REST` requests. I am inclined towards approach-1 as it seems most of the default CORS settings would suffice my use case but not sure if not having full CORS specs implemented at server side would create any issues whatsoever.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:58:51.610

出于您的目的，方法＃1 听起来就足够了。方法 #2 更适用于根据请求类型有不同响应的情况，或者您想要验证请求信息。如果您的响应在所有请求类型中都相同，则 #1 应该没问题。请注意，由于您的实现基本上允许所有请求成功，因此您应该进行自己的检查以确保请求有效。由于您允许 Authorization 标头，我假设您知道这一点，并且正在验证授权令牌？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-08T18:30:52.943

对于那些在 Play Framework 中遇到问题的人，这里有一个解决方案，大多数文本是葡萄牙语，但您可以使用谷歌翻译。

解决方案是一样的。

[http://www.igorcosta.com/habilitando-cors-no-play-framework-2-3-x/](http://www.igorcosta.com/habilitando-cors-no-play-framework-2-3-x/)

# ios - 如何将 NSString 存储在堆栈中

> ID：16082904
> 
> 赞同：1
> 
> 时间：2013-04-18T12:25:07.330
> 
> 标签：ios, objective-c, uitableview, stack

我在我的程序中创建了堆栈类，我想在其中存储 NSString 值。这是堆栈类：

```
@interface Stack : NSObject
- (void)push:(id)obj;
- (id)pop;
- (BOOL)isEmpty;
@end
@implementation Stack
{
    NSMutableArray *stack;
}
- (id)init
{
    self = [super init];   
    if(self!= nil){
        stack = [[NSMutableArray alloc] init];
    }
    return self;
}
- (void)push:(id)obj
{
    [stack addObject:obj];
}
- (id)pop
{
    id lastobj = [stack lastObject];
    [stack removeLastObject];
    return lastobj;
}
- (BOOL)isEmpty
{
    return stack.count == 0;
}
@end 
```

我还有另一个名称为：TableViewController 我想何时单击 TableViewController 存储单元格中从 URL 接收的 id 中的单元格

这是我的代码：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath

{
    // I want that xCode value with xCode2 value push in stack 

    NSLog(@"Row in Tab : %d",indexPath.row);

    if ([Folder containsObject:[All objectAtIndex:indexPath.row]]) {
        NSURL *url = [NSURL URLWithString:[NSString stringWithFormat:@"http://192.168.1.%d/mamal/filemanager.php?dir=%@&folder=%d&id",IP,xCode,indexPath.row]];
        NSURLRequest *request = [NSURLRequest requestWithURL:url];
        NSURLResponse *response = nil;
        NSError *err = nil;
        NSData *data = [NSURLConnection sendSynchronousRequest:request returningResponse:&response error:&err];
        NSString *responseString = [[NSString alloc] initWithBytes:[data bytes] length:[data length] encoding:NSUTF8StringEncoding];
        xCode2 = responseString;          //this is new cell's id.I want to push this value in stack
        NSLog(@"xcode : %@", xCode2);

        [self performSegueWithIdentifier:@"segue4" sender:self];
    }

    else
    {
        [self performSegueWithIdentifier:@"segue3" sender:self];

    }
} 
```

在顶部代码中，我想何时单击单元格推送堆栈中的两个值（xCode 和 xCode2），但我不知道要使用堆栈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:30:40.427

1.  你需要一个保存你的堆栈的变量..我会让它成为一个成员变量：

    ```
    @implementation TableViewController {
        Stack *_stack;
    }
    ... 
    ```

2.  然后当单击单元格时，按下值

    ```
    ...
    if(!_stack)
        _stack = [[Stack alloc] init];
    [_stack push:xcode2];
    ... 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T13:00:36.637

除了 Daij-Djan 的建议之外，请执行以下操作：

```
@interface Stack : NSMutableArray
- (void)push:(id)obj;
- (id)pop;
- (BOOL)isEmpty;
@end
@implementation Stack

- (id)init
{
    self = [super init];   
    if(self!= nil){
      // Perform any initialization here. If you don't then there is no point in implementing init at all. 
    }
    return self;
}
- (void)push:(id)obj
{
    [self addObject:obj];
}
- (id)pop
{
    id lastobj = [self lastObject];
    [self removeLastObject];
    return lastobj;
}
- (BOOL)isEmpty
{
    return [self count] == 0;
}
@end 
```

# javascript - Windows 商店应用程序 - 真/假滑块

> ID：16082913
> 
> 赞同：0
> 
> 时间：2013-04-18T12:25:28.527
> 
> 标签：javascript, windows-8, slider, windows-store-apps

我试图找到 Windows 真/假滑块元素，但没有任何成功。我尝试使用`input range`，但这不一样。我可以使用 0 - 1 值的复选框，但我真的需要这些滑块。

它们看起来像这样： ![在此处输入图像描述](https://i.stack.imgur.com/fGPd8.png)

如何在 JavaScript 应用程序中创建它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:33:56.323

该控件称为[ToggleSwitch](http://msdn.microsoft.com/en-us/library/windows/apps/hh701411.aspx)。像这样在 HTML 中创建它：

```
<div data-win-control="WinJS.UI.ToggleSwitch">
</div> 
```

或者像这样在 JavaScript 中：

```
var object = new WinJS.UI.ToggleSwitch(); 
```

# mysql - 如何使用存储过程设置新的触发器值？

> ID：16082918
> 
> 赞同：0
> 
> 时间：2013-04-18T12:25:41.843
> 
> 标签：mysql, sql, stored-procedures, triggers

如何使用存储过程设置新的触发器值？例如，在插入 myTable 之前，我想将 myTable.someColumn 的新值设置为给定值。尝试这样做时，我在尝试创建过程时收到 1193 错误。谢谢

```
DELIMITER $$

CREATE PROCEDURE `myProc` ()
BEGIN
    //How do I set NEW.someColumn of myTable?
    SET NEW.someColumn=123;
END$$

CREATE TRIGGER myTrig BEFORE INSERT ON myTable FOR EACH ROW
BEGIN
    //SET NEW.someColumn=123; //This works, but I want to do the setting within the stored procedure
    CALL myProc();
END$$

DELIMITER ;

INSERT INTO myTable(id,data) VALUES (1,"hello");
//Above "should" really do INSERT INTO myTable(id,data,someColumn) VALUES (1,"hello",123); 
```

> # 1193 - 未知系统变量“someColumn”

编辑。以下将起作用。

```
DELIMITER $$

CREATE PROCEDURE `myProc` (INOUT myID int)
BEGIN
    SET myID =123;
END$$

CREATE TRIGGER myTrig BEFORE INSERT ON myTable FOR EACH ROW
BEGIN
    CALL myProc(NEW.someColumn);
END$$

DELIMITER ; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T15:10:28.730

你不能完全按照你开始的方式去做。但是您可以通过让存储过程只给您一个值来实现您正在寻找的东西，然后在触发器中使用这个值：

```
delimiter //

CREATE PROCEDURE myProc (OUT param1 INT)
 BEGIN
   SET @value = 123;
 END//

delimiter ; 
```

然后你可以让你的触发器调用存储过程并使用它的值：

```
CREATE TRIGGER myTrig BEFORE INSERT ON myTable FOR EACH ROW
 BEGIN
    CALL myProc(@columnValue);
    SET NEW.someColumn = @columnValue;
END$$ 
```

我没有测试它，只是直接在我的脑海中打字。如果它不起作用，请告诉我，我会修改我的答案。

另外，如果这不是您想要的，或者不够完整，请告诉我，我会修改我的答案。

（ps 我不知道为什么有人认为这不是一个好问题。）

# c# - MVC4 和 ViewModel - 未显示验证消息

> ID：16082921
> 
> 赞同：0
> 
> 时间：2013-04-18T12:25:44.443
> 
> 标签：c#, asp.net-mvc, regex, viewmodel, validation

我正在使用 MVC 4 和实体框架开发 Web 应用程序。我正在使用代表要创建/编辑/删除的产品的 ViewModel。我创建了一个验证类，它检查条目并在必要时显示错误消息。

由于我使用的是 ViewModel，不幸的是错误消息不再显示？我应该如何进行？

这是我的 ViewModel ：

```
public class ProductViewModel
{

    public Product Product { get; set; }

    public ProductType ProductType { get; set; }

    public List<SelectListItem> ProductCompanies { get; set; }
} 
```

这是我的操作（例如创建）：

```
[HttpPost]
public ActionResult Create(ProductViewModel pvm)
{
    pvm.ProductCompanies = db.ProductCompanies.ToList().Select(s => new SelectListItem
    {
        Text = s.Name,
        Value = s.Id_ProductCompany.ToString()
    }).ToList();

    ViewBag.Id_ProductCompany = new SelectList(db.ProductCompanies, "Id_ProductCompany", "Name", pvm.ProductType.Id_ProductCompany);

    if (ModelState.IsValid)
    {

        ModelStateDictionary errors = Validator.isValid(pvm.ProductType);

        if (errors.Count > 0)
        {
            ModelState.Merge(errors);
            return View(pvm);
        }

        Product product = new Product
        {
            PurchaseDate = pvm.Product.PurchaseDate,
            SerialNumber = pvm.Product.SerialNumber,
            Id_ProductType = pvm.ProductType.Id_ProductType
        };

        ProductType productType = new ProductType
        {
            Model = pvm.ProductType.Model,
            CatalogPrice = pvm.ProductType.CatalogPrice,
            Id_ProductCompany = pvm.ProductType.Id_ProductCompany
        };

        db.ProductTypes.AddObject(productType);
        db.Products.AddObject(product);
        db.SaveChanges();
        return RedirectToAction("Index", "Person");    
    }

    return View(pvm);
} 
```

我自己的验证器：

```
public static ModelStateDictionary isValid(ProductType element)
{
    ModelStateDictionary errors = new ModelStateDictionary();

    if (!Regex.IsMatch(element.Model, @"^[a-zA-Z0-9\s][a-zA-Z-_0-9\s]+$"))
    {
        errors.AddModelError("Model", "Invalid name !");
    }

    return errors;
} 
```

以及应该显示消息的位置：

```
<div class="editor-label">
    Model : 
</div>
<div class="editor-field">
    @Html.TextBoxFor(model => model.ProductType.Model, new { maxlength = 50 })
    @Html.ValidationMessageFor(model => model.ProductType.Model)
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T12:29:05.687

也许将其更改为

```
Maybe `errors.AddModelError("ProductType.Model", "Invalid name !"); 
```

会解决你的问题。

顺便说一句，最好的解决方案是使用 DataAnnotations 并创建自己的`ValidationAttribute`：

```
public sealed class ValidNameAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        ....check regex here...
    }
} 
```

然后你应该`Name`用属性装饰`ValidName`属性。

**编辑：**

您还可以`IValidatableObject`在视图模型中实现接口。ASP.NET MVC 将拾取它并进行自动验证。

```
public class MyViewModel: IValidatableObject
{   
    public IEnumerable<ValidationResult> Validate(ValidationContext validationContext)
    {
        if (regexFails)
        {
            results.Add(new ValidationResult("Please enter valid name."));
        }
    }
} 
```

# java - 保存 JTable 的“视图”

> ID：16082928
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:26:00.617
> 
> 标签：java, swing, jtable

想象一个应用程序，其中一些数据显示在 JTable 中。应用程序开发人员为 JTable 设置了默认布局，用户可能不满意。如果用户通过交换一些列、调整其他列的大小等来编辑表格视图，是否有一个函数可以获取隐藏在文档中的视图参数，以便我可以获取它们并将它们保存以供重复使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T13:13:45.807

不，没有真正简单的方法。您可以使用 TableColumn 对象上的 get/setWidth 方法获取和设置列宽。您可以使用以下代码操作订单：

```
int columnIndex = jtable.convertColumnIndexToView(jtable.getColumn("colname").getModelIndex());
    jtable.getColumnModel().moveColumn(columnIndex, e.getValue()); 
```

不幸的是，没有简单的方法可以做到这一点。您只需要获取宽度和顺序，保存它，然后在稍后重新设置它（通常在您再次打开应用程序时）。

# mysql - MySQL - 将平均值从一个表更新到另一个表

> ID：16082929
> 
> 赞同：0
> 
> 时间：2013-04-18T12:26:01.077
> 
> 标签：mysql

我是 MYSQL/PHP 新手，我确信这是一个简单的问题。我正在尝试从一个表中计算几个问题和受访者的平均值，并使用该值更新组表。

例如，表答案由我想要的表 B 中的 (name, group_id, TaskClarity1, TaskClarity2, TaskClarity3) 组成 (group_id, avg(TaskClarity1,TaskClarity2,TaskClarity3))。

这就是我所拥有的...

```
$avg_task_clarity_1 = mysql_query("SELECT AVG(TaskClarity1) WHERE gruppid = '$group_id'");
$avg_task_clarity_2 = mysql_query("SELECT AVG(TaskClarity2) WHERE gruppid = '$group_id'");
$avg_task_clarity_3 = mysql_query("SELECT AVG(TaskClarity3) WHERE gruppid = '$group_id'");
$avg_task_clarity = ($avg_task_clarity_1+$avg_task_clarity_2+$avg_task_clarity_3)/3;
$print_task_clarity_1" UPDATE results SET results.TaskClarity = '$avg_task_clarity'"; 

if (mysql_query($print_task_clarity_1)) { echo $print_task_clarity_1; } else { echo "Error TaskClarity1: " . mysql_error(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T14:58:41.593

首先，mysql_query() 返回一个资源，然后您需要从中提取信息。您的查询不包含任何表名（我将其称为 MyTable）。此外，您可以通过一次查询获得所有三个平均值。

这是我将如何开始：

```
$table = "MyTable";
$sql = "SELECT AVG(TaskClarity1) AS avgClarity1,
               AVG(TaskClarity2) AS avgClarity2,
               AVG(TaskClarity3) AS avgClarity1
        FROM $table WHERE gruppid = '$group_id'";

$resource = mysql_query($sql);    //execute the query

if (! $resource = mysql_query($sql) ){
    echo "Error reading from table $table";
    die;
}

if (! mysql_num_rows($resource ) ){
    echo "No records found in $table";
}
else {
    $row = mysql_fetch_assoc($resource);   // fetch the first row
    $avg_task_clarity_1 = $row['avgClarity1'];
    $avg_task_clarity_2 = $row['avgClarity2'];
    $avg_task_clarity_3 = $row['avgClarity3'];
    $avg_task_clarity =
        ($avg_task_clarity_1+$avg_task_clarity_2+$avg_task_clarity_3)/3;

    //...
    // other stuff you want to do
} 
```

如果这还不够有用，请发表评论，我会修改我的答案。

# php - 使用 Wordpress 编写自定义 PHP

> ID：16082934
> 
> 赞同：0
> 
> 时间：2013-04-18T12:26:19.410
> 
> 标签：php, wordpress, content-management-system, themes

我有一个关于 PHP 和 Wordpress 的问题。

我最近开始将 Wordpress 用于一个简单的网站，但仍有一件事我不明白。假设我用 php 制作了一个很酷的网站，它还包含我的页眉、页脚和菜单。如何实现 Wordpress CMS，以便其他人可以在我制作的菜单栏中添加项目，而不是在其他人制作的主题中添加项目？我很难找到这样的教程，因为它们中的大多数都是为没有编程兴趣的人准备的，因此它们不会解释这些东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:56:33.370

如果您唯一关心的是如何将您的菜单连接到 wordpress 管理员，您可以查看此链接：[wp_nav_menu()](http://codex.wordpress.org/Function_Reference/wp_nav_menu)

然后，该 wordpress 功能将生成您在管理员中添加的菜单项列表。

例如，在您的主题上使用它来显示来自管理员的名为“主菜单”的菜单：

```
<div class="my-menu">
    <?php wp_nav_menu(array('menu' => 'Main Menu' )); ?>
</div> 
```

# php - Read file elements into array and use as html form elements

> ID：16082935
> 
> 赞同：0
> 
> 时间：2013-04-18T12:26:19.757
> 
> 标签：php, arrays, file, text

Hi guys I have been trying to do this for sometime. Would you please give me an insight on how to go about this. I have a text file containing questions and their respective multiple choice answer spaced using space bar between each element. I have been able to read and put the text file lines into arrays. But now what has prooved difficult to achieve is how to put each and every element to an html form element. these are my codes:

Text file:

Number Question (a) (b) (c) (d) 1 The most important feature of spiral model is requirement analysis. risk management. quality management. configuration management. 2 The worst type of coupling is Data coupling. control coupling. stamp coupling. content coupling. 3 One of the fault base testing techniques is unit testing. beta testing. Stress testing. mutation testing. 4 A fault simulation testing technique is Mutation testing Stress testing Black box testing White box testing 5 RS is also known as specification of White box testing Stress testing Integrated testing Black box testing

The page that reads the text file:

```
`html>
<head>
<title>read</title>
</head>
<body>
<b><u> QUESTIONS AND ANSWERS QUIZ</u></b <br /> 
<p>
<?php
$openFile = fopen("questionandanswers.txt", "r") or exit ("unable to open the text       file");
$fileContents = fread($openFile, filesize("questionandanswers.txt"));
fclose($openFile);
$delimiter = "  ";
$myArray = explode($delimiter, $fileContents);
print_r($myArray);
?>
</p>
</body>
</html>` 
```

THe print_r displays the following:

Array ( [0] => Number [1] => Question [2] => (a) [3] => (b) [4] => (c) [5] => (d) 1 [6] => The most important feature of spiral model is requirement analysis. [7] => risk management. [8] => quality management. [9] => configuration management. 2 [10] => The worst type of coupling is [11] => Data coupling. [12] => control coupling. [13] => stamp coupling. [14] => content coupling. 3 [15] => One of the fault base testing techniques is [16] => unit testing. [17] => beta testing. [18] => Stress testing. [19] => mutation testing. 4 [20] => A fault simulation testing technique is [21] => Mutation testing [22] => Stress testing [23] => Black box testing [24] => White box testing 5 [25] => RS is also known as specification of [26] => White box testing [27] => Stress testing [28] => Integrated testing [29] => Black box testing )

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T13:23:18.717

您`explode()`使用空格作为分隔符，这就是您将每个单词作为数组元素的原因。`explode()`只需使用您给它的字符并在遇到该字符时拆分字符串。

您的数据（文件）没有模式。所以你需要在文本中建立一些规则，否则你将无法分离你想要的信息：

我修改了你的文字，建立了一些规则：

1.  问题将以冒号（:) 结束。
2.  答案将以点 (.) 结尾，除了最后一个之外，所有答案都将使用问题的编号作为分隔符。
3.  问题或答案不包含任何数字 [0-9]，否则会混淆正则表达式。

这是我手动修改以使文本正常工作的结果文本：

```
$string = 'Number Question (a) (b) (c) (d) 1 The most important feature of spiral model is: requirement analysis. risk management. quality management. configuration management 2 The worst type of coupling is: Data coupling. control coupling. stamp coupling. content coupling 3 One of the fault base testing techniques is: unit testing. beta testing. Stress testing. mutation testing 4 A fault simulation testing technique is: Mutation testing. Stress testing. Black box testing. White box testing 5 RS is also known as: specification of White box testing. Stress testing. Integrated testing. Black box testing'; 
```

* * *

解决方案：之后我们可以使用一些代码来分离信息：

```
<html>
    <head>
    <title>read</title>
    </head>
    <body>
        <b><u> QUESTIONS AND ANSWERS QUIZ</u></b> <br />
<?php
$openFile = fopen("questionandanswers.txt", "r") or exit ("unable to open the text       file");
$string = fread($openFile, filesize("questionandanswers.txt"));

//Regex to get from the first number to the string's end, so we ignore the Number Question... bit;
preg_match('/\d.*/', $string, $match);

//We get all the strings starting with a number until it finds another number (which will be the beginning of another question;
preg_match_all('/\d\D*/', $match[0], $results);

$qas = array(); // We prepare an array with all the questions/answers
foreach($results[0] as $result){
    //Separating the answer from the string with all the answers.
    list($question, $all_answers) = explode(':', $result);

    //Separating the different answers
    $answers_array = explode('.', $all_answers);

    //Stuffing the question and the array with all the answers into the previously prepared array;
    $qas[] = array('question' => $question, 'answers' => $answers_array);
}

//Looping through the array and outputting all the info into a form;
foreach($qas as $k => $v){
    echo "<label>{$v['question']}</label><br/>";
    echo "<select>";

    //we loop through $v['answers'] because its an array within the array with all the answers.
    foreach($v['answers'] as $answer){
        echo "<option>$answer</option>";//the output
    }
    echo "</select>";
    echo "<br/><br/>";
}

?>
    </body>
</html> 
```

看起来很复杂，因为所有的评论，它们实际上不到 20 行文字

你可以在这里看到输出：[输出](http://aleation.com/test3.php)

* * *

**备注** 这样做只是为了练习，但下次尝试进行更多研究，并提出具体问题，否则人们会忽略/否决您的问题，请仔细阅读 Stackoverflow 的常见问题解答

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:49:58.673

您应该将数组格式化为多维数组，其中索引 0 是问题：

```
Array
(
    [0] = array
    (
        [0] = "This is the first question";
        [1] = "Answer A";
        [2] = "Answer B";
    )
    [1] = array
    (
        [0] = "This is the second question";
        [1] = "Answer A";
        [2] = "Answer B";
        [3] = "Answer C";
    )
) 
```

您现在可以通过以下方式包含它：

```
<form>
    <?php
        foreach($filecontent as $question)
        {
            echo '<p>' .$question[0] .'</p>';
            for($i = 1; $i < count($question); $i++)
            {
                echo '<input value="' .$question[$i] .'" />';
            }
        }
    ?>
</form> 
```

# java - Android EditText 内容为空，即使显示文本

> ID：16082944
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:26:49.490
> 
> 标签：java, android, onclick, android-edittext

我有一个代表 ID 号的 EditText 字段。该字段可以通过编程方式填充，使用基于刷卡结果的 IDField.setText(String)，也可以使用键盘手动填充。

填充文本后，两种方法（自动登录 - 基于滑动，或手动 - 基于按钮单击）都运行相同的登录脚本。但是，当我去获取 EditText 字段的内容时，如果我手动编辑文本，则会返回一个空字符串。如果文本是以编程方式设置的，那么它可以完美地工作。

这对我来说没有任何意义。是否有理由 editText.getText().toString() 不会返回文本框中明显显示的内容？

XML:

```
<Button
    android:id="@+id/btn_swipeCard"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBottom="@+id/signInID"
    android:layout_toLeftOf="@+id/textView1"
    android:onClick="SignInStudent"
    android:text="Swipe ID" /> 
```

按钮初始化：

```
IDField = (EditText) layout.findViewById (R.id.signInID);
LoginButton = (Button) findViewById(R.id.button1);
LoginButton.setOnClickListener(new OnClickListener() { public void onClick(View v) { SignInStudent(); } } ); 
```

刷卡：

```
// displays data from card swiping
private Runnable doUpdateTVS = new Runnable()
{
    public void run()
    {
        try
        {
            //Grab ID Number
            String[] splitMSG = strMsrData.split("=");
            //txtIDNumber.setText(splitMSG[2]);
            IDField.setText(splitMSG[2]);
            StringBuffer hexString = new StringBuffer();
            hexString.append("<");
            String fix = null;
            for (int i = 0; i < msrData.length; i++) {
                fix = Integer.toHexString(0xFF & msrData[i]);
                if(fix.length()==1)
                    fix = "0"+fix;
                hexString.append(fix);
                if((i+1)%4==0&&i!=(msrData.length-1))
                    hexString.append(' ');
            }
            hexString.append(">");
            myUniMagReader.WriteLogIntoFile(hexString.toString());

            SignInStudent();
        }
        catch(Exception ex)
        {
            ex.printStackTrace();
        }
    }
}; 
```

登录逻辑：

```
public void SignInStudent()
{
    String temp = "http://wwww.tempUrl.com/signIn?ID="+ IDField.getText().toString() + "&DeviceId="+KEY;
    webView.loadUrl(temp);
} 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-05-17T20:57:14.677

布局仅在循环的 onCreate 阶段更新。当调用 onResume 事件时会触发此事件，这解释了为什么在您锁定和解锁设备后字段会更新。有一些解决方法，例如进行更多的后台处理，然后创建具有正确值的新视图，或者使用允许在程序处于正常执行周期时进行绘图的表面视图。

对于我的应用程序，我要么进行后台处理，然后移至新视图，要么拥有一个不断调用自身以使 onCreate 事件再次触发的视图。解决方案取决于应用程序，但这就是问题发生的原因。

# c - 以编程方式在 Mac OS X 中获取首选域控制器（Active Directory）

> ID：16082949
> 
> 赞同：1
> 
> 时间：2013-04-18T12:27:00.427
> 
> 标签：c, macos, cocoa, dns, network-programming

我想在 Mac 上获得首选域控制器名称/地址，使用 C/Objective-C 以编程方式加入 Active Directory（带域控制器的 MS Windows 服务器）。目前更好的解决方案是解析`dsconfigad -show`命令行实用程序的输出，这些行在哪里：

```
Advanced Options - Administrative
  Preferred Domain controller    = 192.168.XXX.XXX 
```

[我已经按照此处](https://stackoverflow.com/questions/1756143/open-directory-directory-domain-name-on-mac-os-x)的建议尝试了 Open Directory API，但它无法访问远超过域名全名的节点：

```
// domainNode: "/Active Directory/MYDOMAIN/mydomain.local"
NSArray *domainSubNodes = [domainNode subnodeNamesAndReturnError:&err];
[domainSubNodes count]; // count is 0 
```

我是否需要执行某种授权才能访问域的子节点以及如何执行？是否有任何 posix/BSD 函数可以从纯 C 代码中获取域控制器名称？

# python - Python：如何按几个值对字典列表进行排序？

> ID：16082954
> 
> 赞同：63
> 
> 时间：2013-04-18T12:27:04.060
> 
> 标签：python, list, sorting

我想首先按一个值对列表进行排序，然后按第二个值排序。是否有捷径可寻？这是一个小例子：

```
A = [{'name':'john','age':45},
     {'name':'andi','age':23},
     {'name':'john','age':22},
     {'name':'paul','age':35},
     {'name':'john','age':21}] 
```

此命令用于按以下方式排序此列表`'name'`：

```
sorted(A, key = lambda user: user['name']) 
```

但是我怎样才能按第二个值对这个列表进行排序呢？就像`'age'`在这个例子中一样。

我想要这样的排序（首先排序`'name'`，然后排序`'age'`）：

```
andi - 23
john - 21
john - 22
john - 45
paul - 35 
```

谢谢！

* * *

## 回答 #1

> 赞同：91
> 
> 时间：2013-04-18T12:28:26.887

```
>>> A = [{'name':'john','age':45},
     {'name':'andi','age':23},
     {'name':'john','age':22},
     {'name':'paul','age':35},
     {'name':'john','age':21}]
>>> sorted(A, key = lambda user: (user['name'], user['age']))
[{'age': 23, 'name': 'andi'}, {'age': 21, 'name': 'john'}, {'age': 22, 'name': 'john'}, {'age': 45, 'name': 'john'}, {'age': 35, 'name': 'paul'}] 
```

这按两个属性的元组排序，以下是等效的并且更快/更清晰：

```
>>> from operator import itemgetter
>>> sorted(A, key=itemgetter('name', 'age'))
[{'age': 23, 'name': 'andi'}, {'age': 21, 'name': 'john'}, {'age': 22, 'name': 'john'}, {'age': 45, 'name': 'john'}, {'age': 35, 'name': 'paul'}] 
```

来自评论：@Bakuriu

> 我敢打赌两者之间没有太大区别，但避免`itemgetter`了一些开销，因为它`tuple`在单个操作码（其他字节码）最终调用下标（），构建并返回它......这对解释器来说还有很多工作。`CALL_FUNCTION``lambda``BINARY_SUBSCR``tuple`

总结一下：`itemgetter`保持执行完全在`C`水平上，所以它尽可能快。

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2013-04-18T12:28:35.633

```
from operator import itemgetter

sorted(your_list, key=itemgetter('name', 'age')) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-22T17:19:49.013

这是另一种通用解决方案 - 它按键和值对 dict 的元素进行排序。它的优点 - 无需指定键，如果某些字典中缺少某些键，它仍然可以工作。

```
def sort_key_func(item):
    """ helper function used to sort list of dicts

    :param item: dict
    :return: sorted list of tuples (k, v)
    """
    pairs = []
    for k, v in item.items():
        pairs.append((k, v))
    return sorted(pairs) 
```

# xcode - 无效的 info.plist - UIMainStoryboardFile 或 NSMainNibFile 将应用程序发送到应用商店时

> ID：16082955
> 
> 赞同：15
> 
> 时间：2013-04-18T12:27:04.550
> 
> 标签：xcode, submission

在将应用程序发送到应用程序商店时，我收到一条消息，说明：

```
"Invalid info.plist: the info.plist may contain either UIMainStoryboardFile or NSMainNibFile, but must not contain both keys" 
```

在谷歌搜索之后，似乎共识是将“主 nib 文件基本名称”设置为“ `MainWindow`”，并将“主情节提要文件基本名称”设置为“ `MainStoryboard_iPAd`”。我们已经拥有这两种选择。

该应用程序设计为在 iPad 和 iPhone 上运行，该应用程序包含两个故事板文件，一个用于 ipad，一个用于 iphone。即使我找到了正确的答案，我也找不到任何可见的 .nib 或 .xib 来操作。

是否有人对如何解决/修复此问题有任何提示，以便应用程序发送？

多谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2018-06-25T03:50:18.847

这是帮助我解决此问题的方法。删除 NIB 条目，只留下另一个条目。

[![在此处输入图像描述](https://i.stack.imgur.com/YnM3Y.jpg)](https://i.stack.imgur.com/YnM3Y.jpg)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-10-16T04:59:24.503

不幸的是，@verbumdei 的回答对我不起作用。

我试图在 iOS 7 中将一个仅限 iPhone 的项目转换为 Universal，但它不起作用。iPad的故事板没有被阅读。

发生的事情是 Xcode 在我的 .plist 中添加了一个键，即“主 nib 文件基本名称 (iPad)”。我必须删除该键并添加“主故事板文件基本名称（iPad）”，然后将文件名设置为我的故事板（即 Storyboard-iPad.storyboard）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-06-19T03:32:21.473

正如消息所示，您不应在 Info.plist 文件中同时设置 UIMainStorboardFile 和 NSMainNibFile 。我建议您删除 NSMainNibFile 条目。

由于您有两个故事板，一个用于 iPad，一个用于 iPhone，您可以在项目的“*摘要*”选项卡中将它们分别设置*为主故事板*：

 *![在此处输入图像描述](https://i.stack.imgur.com/sENCY.png)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-01-03T12:58:18.900

检查`info`->`custom IOS target properties`

检查`Main nib file base name(iPhone/iPad)`或`Main Storyboard file base name(iPhone/iPad)`

如果不存在，请添加它们并写下您的基本文件名。

这个对我有用。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-07-08T19:59:48.663

对于那些有问题的人，我没有创建新密钥就解决了，只是从现有密钥中删除了（iPad）

在主界面中，我选择了故事板，保存，清理了项目，瞧

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-10-17T19:15:25.447

从 Xcode 11 开始，转到`Info`-> `Custom iOS Target Properties`-> Find `Main nib file base name (iPad)`and leave value for this key empty。此外，在`General`-> `Deployment Info`->`Main interface`你的值应该是空的。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-02-01T10:23:07.120

以上解决方案都不适合我。
因此我所做的是我添加了一个`storyboard`属性`AppDelegate`并在下面设置它的值`- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`
是这个的代码：
AppDelegate.h

```
@property (strong, nonatomic) UIStoryboard* storyboard; 
```

AppDelegate.m

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

    if ([UIDevice currentDevice].userInterfaceIdiom == UIUserInterfaceIdiomPad) { // is iPad
        self.storyboard = [UIStoryboard storyboardWithName:@"Storyboard_ipad" bundle:Nil];
    } else {
        self.storyboard = [UIStoryboard storyboardWithName:@"Storyboard_iphone" bundle:Nil];
    }

    self.window.rootViewController = [self.storyboard instantiateInitialViewController];

    [self.window makeKeyAndVisible];

    return YES;
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-12-02T11:07:55.633

默认情况下，Xcode 在 info.plist 文件中创建“Main nib file base name (iPad)”，并为其分配 iPad 故事板的名称。

这是解决方法打开 Info.plist 文件-> 删除“主 nib 文件基本名称（iPad）”并添加另一个名为“主故事板文件基本名称（iPad）”的键，并为其分配 iPad 故事板文件的名称，即 Main_iPad don '不提供扩展。*

# java - 将全局变量挂接到JSP（Spring）中的最优雅的方法是什么

> ID：16082964
> 
> 赞同：0
> 
> 时间：2013-04-18T12:27:26.793
> 
> 标签：java, spring, jsp

我是 Spring 的新手，所以我需要一个简单的建议。我有一个打印今天日期的页脚。目前我使用代码：

```
<%@ page import="com.walladverts.helpers.DateHelper" %>
Today is <%=DateHelper.today()%> 
```

DateHelper 是我的类，它返回一个字符串，但我知道在视图中使用脚本和混合逻辑并不优雅。

我需要添加什么作为钩子以将变量添加到春季每个动作中的每个jsp页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:14:38.193

我会使用 JSTL 来完成。

使用此标题

```
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %> 
```

获取今天的日期

```
 <jsp:useBean id="today" class="java.util.Date"/> 
```

然后使用格式化程序打印

```
<fmt:formatDate value="${today}" dateStyle="long"/> 
```

它会打印这个`April 18, 2013`

这是标签[formatDate的文档](http://docs.oracle.com/javaee/5/jstl/1.1/docs/tlddocs/fmt/formatDate.html)

# vb.net - VB.net will not read text file correctly

> ID：16082969
> 
> 赞同：2
> 
> 时间：2013-04-18T12:27:46.867
> 
> 标签：vb.net, encoding

I've been trying to use `StreamReader` to read a log file. I cannot verify what it is encoded in, as when I open it in notepad++ and select ANSI encoding, I get this result:

![screenshot](https://i.stack.imgur.com/IFYgd.png)

I'm getting the characters needed when using ANSI but they are followed by things like [NULL][EOT][SOH][NUL][SI]

When I try and read the file in VB (using `StreamReader` or `ReadAll`) with ANSI encoding selected the resulting string I get back is completely wrong.

How could I read a file like this in VB.net?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:33:25.763

您可以使用[IO.File.ReadAllText("File Location", encoding as System.Text.Encoding)](http://msdn.microsoft.com/en-us/library/system.io.file.readalltext.aspx)方法，

```
Dim textFromFile as string = IO.File.ReadAllText("C:\Users\Jason\Desktop\login20130417.rdb", System.Text.Encoding.ASCII) 'Or Unicode, UFT32, UFT8, UFT7, BigEndianUnicode or default. Default is ANSI. 
```

如果使用默认编码 (ANSI) 仍然无法获得所需的文本，那么您可以随时尝试其他 6 种不同的编码方法。

**更新...**

看来您的文件已损坏，使用下面的代码我能够获得文件中任何内容的二进制表示，我得到了这个，

```
1111111111111101000001110000010000000000000001010000000000010011000000000000100000000000000111100000000000100110000000000011100000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000111111111111110100000111000001000000000000000101000000000001001100000000000010000000000000011110000000000010100000000000111111111111110100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 
```

大量的空数据表明文件已损坏，这也可以解释为什么我们在尝试读取文件时没有获得大量数据。

编码，

```
Dim fileData As String = IO.File.ReadAllText("C:\Users\Jason\Desktop\login20130417.rdb")
Dim i As Integer = 0
Dim binaryData As String = ""
Dim ch As String = ""
Do Until i = fileData.Length
   ch = fileData.Chars(i)
   bin = bin & System.Convert.ToString(AscW(ch), 2).PadLeft(8, "0")
   i = i + 1
Loop 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:46:59.157

正如@Daniel A. White 在他的评论中所建议的那样，该文件似乎不像“普通”文本文件那样被编码。A`StreamReader`在这种情况下不起作用。我会尝试使用[BinaryReader](http://msdn.microsoft.com/en-us/library/system.io.binaryreader.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T13:16:00.843

.rdb 文件？从来没有听说过。快速谷歌使其不太清楚 - n64 数据库文件，Darkbot 等......

但是考虑到您的名称以及打开文件的一般外观，我会说它是一个二进制文件。

如果您想在 vb.net 中阅读该文件，您将需要各种库，在您能够阐明文件可能是什么或它是用什么创建的之前，我无法为您提供帮助.

# mysql - 如果会话是 lang_code，则从 table = id 的表中选择

> ID：16082974
> 
> 赞同：1
> 
> 时间：2013-04-18T12:28:01.853
> 
> 标签：mysql

我正在尝试使用 if session 和我当前的 sql 表“查看代码”选择英文菜单标题

```
if($_SESSION['lang_code'] == 'en') {
    echo $courseCat['course_cat_title'];
} else 
    echo $courseCat['course_cat_title']; 
```

到目前为止它打印得很好，但只有荷兰语菜单标题，当我查看我的数据库时，我有一张显示语言国家 ID **course_cat_lang_country**的表格，现在我需要知道当页面为 www.yourdomain.nl 时如何打印英文标题/zh/。我现在使用的完整代码是这样的。

```
$QcourseCat = mysql_query("SELECT * FROM web_course_cat WHERE course_cat_id = 1");
$courseCat = mysql_fetch_assoc($QcourseCat);
echo "< h4>";

if($_SESSION['lang_code'] == 'en') { 
    echo $courseCat['course_cat_title'];  
} else 
    echo $courseCat['course_cat_title']; 

echo "< h4>"; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:40:43.663

您没有对结果进行排序以检查语言国家/地区 ID。你只得到第一行。您需要更改查询以获得所需的语言。或者循环查看您获得的结果，检查它们是哪种语言。

在您发布的代码中，您的`if`语句在每个分支中执行相同的操作。而且您永远不会使用它来选择数据。

此外，根据评论，您的查询使用 MYSQLi 或 PDO，因为不推荐使用 MYSQL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T14:43:02.493

这个怎么样：

```
if($_SESSION['lang_code'] == 'en') {
    $table='course_cat_eng'; 
}
else {
    $table='course_cat_title';
}

$sql = "SELECT * FROM $table WHERE course_cat_id = 1";
if (! $resource = mysql_query($sql) ){
    echo "Error reading from table $table";
}
else {
    if (!mysql_num_rows($resource ) ){
        echo "No records foin in $table";
    }
    else {
        $courseCat = mysql_fetch_assoc($resource);
        echo "<h4>";
        echo $courseCat['course_cat_title']; 
        echo "</h4>";
        //...
        // other stuff you might want to do
    }
} 
```

如果这不是您想要的，请发表评论，我会修改我的答案。

# syntax - INSERT INTO 语句中的语法错误 (Microsoft Access)

> ID：16082977
> 
> 赞同：-1
> 
> 时间：2013-04-18T12:28:17.180
> 
> 标签：syntax, insert, ms-access-2010

我正在使用连接到 Access 数据库 (2010) 的 Visual Studio 2010。

我创建了一个按钮来将文本框中的项目添加到数据库中，但出现错误“INSERT INTO 语句中的语法错误”

```
 protected void upload_Click(object sender, EventArgs e)
{
    if (FileUpload3.HasFile)
    {
        try
        {
            string filename = Path.GetFileName(FileUpload3.FileName);
            FileUpload3.SaveAs(Server.MapPath("images") + "/" + filename);
            Picture.Text = "images/" + filename;
            Label2.Text = "";
        }
        catch (Exception ex)
        {

            Label2.Text = "Upload status: The file could not be uploaded. The following error occured: " + ex.Message;
        }

    }
}

protected void addnewitem_Click(object sender, EventArgs e)
{

    AccessDataSource1.InsertCommand = "Insert into RAM (RAM Name, picture) values ('" + name.Text.ToString() + ",'" + Picture.Text.ToString() + "')";

    AccessDataSource1.Insert();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T12:32:19.357

尝试一下 SQL 注入：将单引号附加到您在“名称”文本框中输入的文本。

如果可行，则在查询中使用参数，而不是附加用户的文本。

进一步阅读：

[http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html](http://www.codinghorror.com/blog/2005/04/give-me-parameterized-sql-or-give-me-death.html)

[参数化查询如何帮助防止 SQL 注入？](https://stackoverflow.com/questions/5468425/how-do-parameterized-queries-help-against-sql-injection)

**更新**

还使用 Alberto Spelta 对原始问题的评论中的更正（在括号中包含包含空格的列名：“RAM Name”=>“[RAM Name]”）。这是另一个语法错误以及省略的单引号。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T12:33:01.493

您缺少单引号：

```
"... values ('" + name.Text.ToString() + "','" + Picture.Text.ToString() + "')"
                                          ^ 
```

但是您不应该像这样使用字符串连接 - 而是使用适当的参数化查询，并且您不会看到这些问题（或者当您的数据包含单引号时会遇到更危险的注入问题）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:03:56.703

尝试

```
([RAM Name], picture) 
```

代替

```
(RAM Name, picture) 
```

希望这可以帮助

# javascript - 为什么输入文本字段不出现

> ID：16082984
> 
> 赞同：0
> 
> 时间：2013-04-18T12:28:40.153
> 
> 标签：javascript, jquery

我目前正在调试一个更大的系统，但试图取出我认为会造成问题的部分。

我不太明白为什么输入文本字段没有附加到[这个 jsfiddle](http://jsfiddle.net/qygB2/104/)的 HTML 中。

JS代码：

```
 for (var counter = 0; counter < 20; counter++) {

    var anbox = $(document.createElement('input')).attr({
        type: 'text',
        class: 'anBox',
        size: '1',
        maxlength: '1'
    });
    anbox.appendTo('#answerLine_' + i);}; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T12:30:29.333

是的，是次要的。没有`i`定义变量，它应该是`counter`：

```
anbox.appendTo('#answerLine_' + counter); 
```

为了搜索此类问题，我建议您使用调试工具，例如 Chorme Developer Console 或 Firebug。

**演示：http:** [//jsfiddle.net/qygB2/106/](http://jsfiddle.net/qygB2/106/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T12:36:34.387

```
anbox.appendTo('#answerLine_' + i) 
```

更改 `i`为`counter`

```
anbox.appendTo('#answerLine_' + counter) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T12:33:05.730

我**来自**以下行：

```
anbox.appendTo('#answerLine_' + i);}; 
```

我认为您必须将其更改为：

```
anbox.appendTo('#answerLine_' + counter);}; 
```

我变了; 它奏效了；看：

[http://jsfiddle.net/qygB2/105/](http://jsfiddle.net/qygB2/105/)

# solr - Solr完全刷新而不删除索引

> ID：16082989
> 
> 赞同：0
> 
> 时间：2013-04-18T12:28:54.837
> 
> 标签：solr, solrj, solr4

我想在不删除索引的情况下进行 solr 完全刷新，以便在完全刷新完成之前可以访问数据。完全刷新完成后，必须删除旧索引。我该怎么做，请帮忙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T14:05:42.570

我建议在您的 Solr 实现中使用[多个内核。](http://wiki.apache.org/solr/CoreAdmin)一个“live”核心和一个“ondeck”核心，其中“live”是当前索引，“ondeck”是您将刷新的索引。（注意：您可以为核心命名任何对您有意义的名称）一旦刷新完成，您可以发出一个[SWAP 命令](http://wiki.apache.org/solr/CoreAdmin#SWAP)，该命令将实时切换两个核心，而不会对用户产生任何影响（例如，Solr 将管理正在为您在幕后对核心执行的搜索）。

我们已经在我现在的公司的其他几个指数上实施了这个确切的方案，并取得了非常好的成功。

# vim - vim，使用 vanilla Vim 在文件之间快速切换（无插件）

> ID：16082991
> 
> 赞同：113
> 
> 时间：2013-04-18T12:28:57.537
> 
> 标签：vim

我知道将自己限制在 vanilla Vim（不使用插件）会限制编辑器的功能，但是由于我经常在不同的机器之间切换，所以到处移动我的环境往往太麻烦了。我只想留在香草 Vim 中。

让我退缩的是能够在文件之间快速切换。我（至少相信）对*buffers*、*windows*、*tabs*以及 netrw ( `Vex`,`Ex`等) 有很好的理解。

但是在诸如[Sublime Text](https://www.sublimetext.com/)之类的编辑器中，我只需键入`ctrl`-`p`立即我就在文件中。

我知道我可以下拉到 shell，但我想知道是否还有其他“隐藏”的秘密可以在 Vim 中基于文件名之外的文件之间快速切换。

* * *

## 回答 #1

> 赞同：265
> 
> 时间：2013-04-18T13:29:28.967

与 ST2 的`Ctrl`+最接近的等价物（“最接近”，而不是“确切”）`P`是一个名为的插件，请准备好... [CtrlP](http://www.vim.org/scripts/script.php?script_id=3736)。还有其他类似的插件，例如[Command-T](http://www.vim.org/scripts/script.php?script_id=3025)或[FuzzyFinder](http://www.vim.org/scripts/script.php?script_id=1984)。

我使用 CtrlP 并且我喜欢它，但我全心全意地支持您选择“无插件”的决定。这不是最简单的方法，但从长远来看它会得到回报。

* * *

**打开文件**

打开文件最基本的方法是`:e /path/to/filename`. 值得庆幸的是，您获得了制表符补全和通配符：经典`*`的和特殊的`**`，代表“任何子目录”。

结合所有这些，您可以执行以下操作：

```
:e **/*foo<Tab> 
```

`foo`从工作目录下名称中包含的所有文件中进行选择，或者：

```
:e **/*foo/*bar<Tab> 
```

从名称中包含的所有文件中进行选择，该文件`bar`位于其名称中包含的任何子目录`foo`下，工作目录下的任何位置。

当然，这也适用于`:tabe[dit]`,`:sp[lit]`和`:vs[plit]`。

但是，这些命令仅限于一个文件。用于`:next`打开多个文件：

```
:next **/*.js 
```

看看`:help arglist`。

* * *

**在缓冲区之间跳转**

`:b[uffer]`是基本的缓冲区切换命令：

```
:b4         " switch to buffer number 4
:bn         " switch to next buffer in the buffer list
:bp         " switch to previous buffer in the buffer list
:bf         " switch to first buffer in the buffer list
:bl         " switch to last buffer in the buffer list
:b foo<Tab> " switch by buffer name with tab-completion
:b#         " switch to the alternate file 
```

请注意，其中许多命令及其相关命令都接受计数。

该`:ls`命令向您显示已加载缓冲区的列表。不过，它有点“特殊”：缓冲区在创建时被分配了一个数字，因此您可以拥有一个看起来像`1 2 5`删除缓冲区的列表。是的，这有点尴尬，这使得按其编号切换到缓冲区有点太麻烦了。更喜欢按部分名称`:b foo<Tab>`或循环切换`:bn :bp`。

无论如何，这是一个很酷的映射，它列出了所有加载的缓冲区并为您填充提示，等待您输入缓冲区的编号并按`<enter>`：

```
nnoremap gb :ls<CR>:b<Space> 
```

使用此映射，切换到另一个缓冲区非常简单：

```
gb
(quickly scanning the list)
3<CR> 
```

或者：

```
gb
(quickly scanning the list)
foo<tab><CR> 
```

这个想法来自这张[取自 Bairui 收集的 Vim 信息图表的](http://of-vim-and-vigor.blogspot.ro/p/vim-vigor-comic.html)图片：

![飞行与骑自行车](https://2.bp.blogspot.com/-d1GaUBk-Y10/TyFhskmCYRI/AAAAAAAAARQ/CIEx1V7FLqg/s1600/vim-and-vigor-004-flying_is_faster_than_cycling.png)

Vim 也有`<C-^>`（或`<C-6>`在某些键盘上）——相当于普通模式的`:b#`——在当前缓冲区和前一个缓冲区之间跳转。如果您经常在两个缓冲区之间交替使用它。

阅读所有关于缓冲区的内容`:help buffers`。

* * *

**前往申报**

在文件中，您可以使用`gd`或`gD`。

在项目中，Vim 的“标签”功能是您的朋友，但您需要一个外部代码索引器，如 ctags 或 cscope。最基本的命令是`:tag foo`和`<C-]>`将光标放在方法名称上。这两个工具都很好地集成到了 Vim 中：参见`:help tags`和。`:help ctags``:help cscope`

对于它的价值，我广泛使用标签导航在项目中移动（主要使用 CtrlP`:CtrlPTag`和`:CtrlPBufTag`命令，但也使用内置的），我最喜欢的“通用”缓冲区切换方法是按名称。

* * *

**部署你的配置**

许多 Vim 用户将他们的配置置于版本控制之下，这使得在新机器上安装自己的配置变得*非常快速和容易。*想想看。

* * *

***编辑***

几个月前，我不得不在一台装有过时 Vim 的远程机器上工作。我本可以安装一个合适的 Vim 并克隆我自己心爱的配置，但这次我决定轻装上阵，以“磨刀”。我很快建立了一个极简主义`.vimrc`，并重新审视了几个被遗忘的原生功能。在那次演出之后，我认为 CtrlP 没有那么必要并摆脱了它：本机功能和自定义映射并不那么性感，但它们可以在没有太多依赖的情况下完成工作。

* * *

**玩弄文件**

```
set path=.,**
nnoremap <leader>f :find *
nnoremap <leader>s :sfind *
nnoremap <leader>v :vert sfind *
nnoremap <leader>t :tabfind * 
```

`:find`只要你`set path`正确，这是一个真正伟大的命令。使用我的设置，`,ffoo<Tab>`将递归查找`foo`当前目录下包含的所有文件。它快速、直观且轻巧。当然，我受益于与`:edit`和朋友相同的完成和通配符。

为了使该过程更快，以下映射允许我跳过项目的整个部分并在当前文件的目录下递归查找文件：

```
nnoremap <leader>F :find <C-R>=expand('%:h').'/*'<CR>
nnoremap <leader>S :sfind <C-R>=expand('%:h').'/*'<CR>
nnoremap <leader>V :vert sfind <C-R>=expand('%:h').'/*'<CR>
nnoremap <leader>T :tabfind <C-R>=expand('%:h').'/*'<CR> 
```

**警告！该`path`选项*非常*强大。上面的值——<code>.,**——*对我*有用，*作为默认的后备值*。在现实世界中，选项的确切值会因项目/语言/框架/工作流程而异，因项目/语言/框架/工作流程而异，因此*正确的*值完全取决于*您的*需求。不要盲目地复制该行并期望它可以解决您的所有问题。**

* * *

**玩弄缓冲区**

```
set wildcharm=<C-z>
nnoremap <leader>b :buffer <C-z><S-Tab>
nnoremap <leader>B :sbuffer <C-z><S-Tab> 
```

上面的映射在“wildmenu”中列出了可用的缓冲区，提示为空，允许我导航菜单`<Tab>`或键入几个字母，然后`<Tab>`再次缩小列表范围。就像上面的文件映射一样，这个过程很快而且几乎没有摩擦。

```
nnoremap <PageUp>   :bprevious<CR>
nnoremap <PageDown> :bnext<CR> 
```

这些映射不言自明。

* * *

**玩弄标签**

```
nnoremap <leader>j :tjump / 
```

此映射使用正则表达式搜索而不是整个单词搜索，因此我可以`,jba<Tab>`找到 tag `foobarbaz()`。

是的，模糊匹配会让人上瘾，但没有它你也可以同样高效。并且只需一小部分成本。

* * *

***更多编辑***

一些额外的提示/技巧……</p>

* * *

**野菜单选项**

使用 启用的“wildmenu”`set wildmenu`使文件/缓冲区导航更容易。它的行为受一系列值得研究的选项控制：

`wildmode`告诉 Vim 你希望 "wildmenu" 如何表现：

```
set wildmode=list:full 
```

`wildignore`过滤掉所有杂物：

```
set wildignore=*.swp,*.bak
set wildignore+=*.pyc,*.class,*.sln,*.Master,*.csproj,*.csproj.user,*.cache,*.dll,*.pdb,*.min.*
set wildignore+=*/.git/**/*,*/.hg/**/*,*/.svn/**/*
set wildignore+=tags
set wildignore+=*.tar.* 
```

`wildignorecase`允许您搜索`foo`和查找`Foo`：

```
set wildignorecase 
```

* * *

**文件标记**

```
augroup VIMRC
  autocmd!

  autocmd BufLeave *.css  normal! mC
  autocmd BufLeave *.html normal! mH
  autocmd BufLeave *.js   normal! mJ
  autocmd BufLeave *.php  normal! mP
augroup END 
```

我最近在别人的`~/.vimrc`. 每当您离开缓冲区时，它都会在光标的确切位置创建一个文件标记，以便无论您身在何处，都可以`'J`跳转到您编辑的最新 JavaScript 缓冲区。惊人的。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-19T07:12:12.763

有时，按顺序浏览文件列表也很方便（例如，如果您做了类似`vim *.php`一次打开多个文件的操作）。然后，您可以使用`:n[ext]`（以及`:prev[ious]`、`:fir[st]`和`:la[st]`）进行导航（除了其他答案中建议的内容）。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-18T12:49:33.783

答案在很大程度上取决于您的偏好和情况。一些例子：

*   如果它主要是两个文件（例如 C 头文件和实现文件），`<C-^>`则非常方便。一般来说，*备用文件*是一个重要的概念。
*   如果你使用一个大的编辑器窗口，window `:split`s 将定位缓冲区的问题从定位窗口（一旦你打开了所有的缓冲区）。您可以使用`[N]<C-w><C-w>`它来快速切换。
*   如果你能记住（几个）缓冲区编号，`:[N]b[uffer]`and`:[N]sb[uffer]`命令就非常方便；`:ls`告诉你数字。

插件（或至少自定义映射）可以改善很多事情，在[vim.org](http://www.vim.org/)上有各种各样的主题。有多种机制可以分发你的配置（Pathogen + GitHub，Dropbox，...），或者你可以通过Vim 附带的*netrw插件远程编辑服务器文件。*

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-04-18T17:11:51.440

您可以在没有任何插件的情况下在命令行上完成通配符选项卡。例如

```
:e src/**/foo*<tab> 
```

将让您循环浏览 ./src 下目录树中以 'foo' 开头的所有文件，然后选择要编辑的文件。

如果您已经编辑了文件并且它仍在缓冲区中，那么您可以使用以下命令切换到它：

```
:b foo<tab> 
```

这将循环遍历路径中带有 'foo' 的所有缓冲区。您可能需要设置 wildmode 和 wildmenu 选项以获得您想要的行为。我有

```
wildmode=longest:full
wildmenu 
```

在我的 .vimrc 中。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-18T13:01:15.807

如果您在一个文件名上并想跳转到该文件，[`gf`](http://vim.wikia.com/wiki/Open_file_under_cursor)将为您执行此操作。我也喜欢使用[ctags](http://ctags.sourceforge.net/)，它不是插件；您只需构建标签，就可以轻松地在您的代码库中跳转。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-09-14T19:21:37.610

我对 Vim 也有同样的问题。

我想要的最后一件事是依赖插件来完成像文件切换这样平凡的任务。

我添加了以下几行`.vimrc`

```
set path+=**
set wildmenu 
```

还有 BAM！我现在`:find any/filename/in/any/folder/`只要 vim 在项目的根目录下就可以了。**标签完成工作。通配符有效！**

一旦文件已经打开，并且后台有大量缓冲区（您可以使用`:ls`查看所有缓冲区），运行`:b any/file <TAB>`将模糊搜索所有缓冲区并跳转到所需文件。如果它不是唯一的，将会有一个选项卡的通配*菜单*（因此是 .vimrc 中的第二行），可以使用选项卡进行选择。

我的答案来自这个很棒的视频
[https://www.youtube.com/watch?v=XA2WjJbmmoM&feature=youtu.be&t=489](https://www.youtube.com/watch?v=XA2WjJbmmoM&feature=youtu.be&t=489)
还有更多技巧，我建议您观看。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2015-11-28T11:47:53.540

如果您想在 vim 编辑器中切换文件，请参阅下面的答案

首先按`Esc`键退出编辑模式。

然后键入`:e`以检查当前文件路径。

如果你想去另一个文件然后`:e /path-of-file.txt/`使用这个你可以切换。

如果要转到上一个文件，只需键入`:e#`哪个切换到上一个文件路径。

# php - 将 Max Mind API 与 IP 变量一起使用

> ID：16082993
> 
> 赞同：0
> 
> 时间：2013-04-18T12:29:03.667
> 
> 标签：php, api

嗨，我正在使用 Max Mind API 来查询 IP 地址，现在如果我使用像下面这样的单个地址，效果很好。

```
$params = getopt('l:i:');
if (!isset($params['l'])) $params['l'] = 'key';
if (!isset($params['i'])) $params['i'] = '82.150.248.29';

$query = 'https://geoip.maxmind.com/e?' . http_build_query($params); 
```

但我想做的是使用已经存在的一段代码来捕获 IP 地址并将其放入变量中。但是我下面的代码不返回任何值，只是在数据库中插入一个空白行。

```
$params = getopt('l:i:');
$ip ='83.218.149.79';  //To simulate capturing the ip address
if (!isset($params['l'])) $params['l'] = 'key';
if (!isset($params['i'])) $params['i'] = '$ip';

$query = 'https://geoip.maxmind.com/e?' . http_build_query($params); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T12:39:08.003

```
if (!isset($params['i'])) $params['i'] = '$ip'; 
```

那条线是错误的。变量不属于引号之间。

```
if (!isset($params['i'])) $params['i'] = $ip; 
```

# sql - Potsgresql 查询具有重叠日期，多个数组

> ID：16082997
> 
> 赞同：0
> 
> 时间：2013-04-18T12:29:11.963
> 
> 标签：sql, postgresql

编辑：我已经编辑了这个问题以便更容易理解。请原谅我的任何误解。

我有一个带有列的临时表

```
zone_name, nodeid, nodelabel, nodegainedservice, nodelostservice
Zone1, 3, Windows-SRV1, "2012-11-27 13:10:30+08", "2012-11-27 13:00:40+08"
Zone1, 5, Windows-SRV2, "2012-12-20 13:10:30+08", "2012-12-18 13:00:40+08"
....
.... 
```

许多区域和许多节点以及多次获得服务和失去服务的相同节点。

`nodegainedservice`意义节点已激活，`nodelostservice`意义节点已关闭。

如何进行查询以获取一段时间内的每个区域可用性？

例如，Zone1 有 Windows-SRV1、Windows-SRV2。找出 Zone1 宕机的次数和时间。**这些服务器是复制服务器**，当区域中的所有服务器在某个时间关闭时，区域就会关闭，如果其中任何一个恢复运行，区域就会启动。

请使用以下示例数据

```
zonename nodeid  nodelabel  noderegainedservice  nodelostservice
Zone1  27  Windows-SRV1  2013-02-21 10:04:56+08  2013-02-21 09:48:48+08
Zone1  27  Windows-SRV1  2013-02-21 10:14:01+08  2013-02-21 10:09:27+08
Zone1  27  Windows-SRV1  2013-02-22 10:26:29+08  2013-02-22 10:24:20+08
Zone1  27  Windows-SRV1  2013-02-22 11:27:24+08  2013-02-22 11:25:15+08
Zone1  27  Windows-SRV1  2013-02-28 16:24:59+08  2013-02-28 15:52:59+08
Zone1  27  Windows-SRV1  2013-02-28 16:56:19+08  2013-02-28 16:40:18+08
Zone1  39  Windows-SRV2  2013-02-21 13:15:53+08  2013-02-21 12:26:04+08
Zone1  39  Windows-SRV2  2013-02-23 13:23:10+08  2013-02-22 10:21:14+08
Zone1  39  Windows-SRV2  2013-02-24 13:35:23+08  2013-02-23 13:33:32+08
Zone1  39  Windows-SRV2  2013-02-26 15:17:25+08  2013-02-25 14:25:51+08
Zone1  39  Windows-SRV2  2013-02-28 18:49:56+08  2013-02-28 15:43:01+08
Zone1  13  Windows-SRV3  2013-02-22 17:23:59+08  2013-02-22 10:19:13+08
Zone1  13  Windows-SRV3  2013-02-28 16:54:27+08  2013-02-28 16:13:48+08 
```

输出 zone_outages 如下，例如，

```
zonename duration from_time to_time

zone1 00:02:09 2013-02-22 10:24:20+08 2013-02-22 10:26:29+08 
zone1 00:02:09 2013-02-22 11:25:15+08 2013-02-22 11:27:24+08    
zone1 00:11:11 2013-02-28 16:13:48+08 2013-02-28 16:24:59+08 
zone1 00:14:09 2013-02-28 16:40:18+08 2013-02-28 16:54:27+08 
```

**注意：**可能有这样的条目

```
Zone2  24  Windows-SRV12  \n  \n 
```

在这种情况下，Zone2 Windows-SRV12 从未关闭，Zone2 可用性将是 100%。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-25T11:46:35.023

您是否考虑过 PG 9.2 的范围类型而不是两个单独的时间戳字段？

[http://www.postgresql.org/docs/9.2/static/rangetypes.html](http://www.postgresql.org/docs/9.2/static/rangetypes.html)

就像是：

```
CREATE TABLE availability (
    zone_name varchar, nodeid int, nodelabel varchar, during tsrange
);

INSERT INTO availability
VALUES (zone1, 3, 'srv1', '[2013-01-01 14:30, 2013-01-01 15:30)'); 
```

除非我弄错了，否则您将能够与工会、交叉口等一起工作，这应该会使您的工作更简单。可能有一些我不熟悉的聚合函数也适合后者。

如果需要，还可以使用语句和窗口函数查看更复杂的查询：

[http://www.postgresql.org/docs/9.2/static/tutorial-window.html](http://www.postgresql.org/docs/9.2/static/tutorial-window.html)

[http://www.postgresql.org/docs/9.2/static/functions-window.html](http://www.postgresql.org/docs/9.2/static/functions-window.html)

* * *

一些测试表明 sum() 不适用于 tsrange 类型。

话虽如此，后续查询中使用的 sql 模式：

```
drop table if exists nodes;

create table nodes (
    zone int not null,
    node int not null,
    uptime tsrange
);

-- this requires the btree_gist extension:
-- alter table nodes add exclude using gist (uptime with &&, zone with =, node with =); 
```

数据（与您的样本略有不同）：

```
insert into nodes values
    (1, 1,  '[2013-02-20 00:00:00, 2013-02-21 09:40:00)'),
    (1, 1,  '[2013-02-21 09:48:48, 2013-02-21 10:04:56)'),
    (1, 1,  '[2013-02-21 10:09:27, 2013-02-21 10:14:01)'),
    (1, 1,  '[2013-02-22 10:24:20, 2013-02-22 10:26:29)'),
    (1, 1,  '[2013-02-22 11:25:15, 2013-02-22 11:27:24)'),
    (1, 1,  '[2013-02-28 15:52:59, 2013-02-28 16:24:59)'),
    (1, 1,  '[2013-02-28 16:40:18, 2013-02-28 16:56:19)'),
    (1, 1,  '[2013-02-28 17:00:00, infinity)'),
    (1, 2,  '[2013-02-20 00:00:01, 2013-02-21 12:15:00)'),
    (1, 2,  '[2013-02-21 12:26:04, 2013-02-21 13:15:53)'),
    (1, 2,  '[2013-02-22 10:21:14, 2013-02-23 13:23:10)'),
    (1, 2,  '[2013-02-23 13:33:32, 2013-02-24 13:35:23)'),
    (1, 2,  '[2013-02-25 14:25:51, 2013-02-26 15:17:25)'),
    (1, 2,  '[2013-02-28 15:43:01, 2013-02-28 18:49:56)'),
    (2, 3,  '[2013-02-20 00:00:01, 2013-02-22 09:01:00)'),
    (2, 3,  '[2013-02-22 10:19:13, 2013-02-22 17:23:59)'),
    (2, 3,  '[2013-02-28 16:13:48, 2013-02-28 16:54:27)'); 
```

按顺序排列的原始数据（为清楚起见）：

```
select *
from nodes
order by zone, uptime, node; 
```

产量：

```
 zone | node |                    uptime                     
------+------+-----------------------------------------------
    1 |    1 | ["2013-02-20 00:00:00","2013-02-21 09:40:00")
    1 |    2 | ["2013-02-20 00:00:01","2013-02-21 12:15:00")
    1 |    1 | ["2013-02-21 09:48:48","2013-02-21 10:04:56")
    1 |    1 | ["2013-02-21 10:09:27","2013-02-21 10:14:01")
    1 |    2 | ["2013-02-21 12:26:04","2013-02-21 13:15:53")
    1 |    2 | ["2013-02-22 10:21:14","2013-02-23 13:23:10")
    1 |    1 | ["2013-02-22 10:24:20","2013-02-22 10:26:29")
    1 |    1 | ["2013-02-22 11:25:15","2013-02-22 11:27:24")
    1 |    2 | ["2013-02-23 13:33:32","2013-02-24 13:35:23")
    1 |    2 | ["2013-02-25 14:25:51","2013-02-26 15:17:25")
    1 |    2 | ["2013-02-28 15:43:01","2013-02-28 18:49:56")
    1 |    1 | ["2013-02-28 15:52:59","2013-02-28 16:24:59")
    1 |    1 | ["2013-02-28 16:40:18","2013-02-28 16:56:19")
    1 |    1 | ["2013-02-28 17:00:00",infinity)
    2 |    3 | ["2013-02-20 00:00:01","2013-02-22 09:01:00")
    2 |    3 | ["2013-02-22 10:19:13","2013-02-22 17:23:59")
    2 |    3 | ["2013-02-28 16:13:48","2013-02-28 16:54:27")
(17 rows) 
```

可用节点@ 2013-02-21 09:20:00:

```
with upnodes as (
select zone, node, uptime
from nodes
where '2013-02-21 09:20:00'::timestamp <@ uptime
)
select *
from upnodes
order by zone, uptime, node; 
```

产量：

```
 zone | node |                    uptime                     
------+------+-----------------------------------------------
    1 |    1 | ["2013-02-20 00:00:00","2013-02-21 09:40:00")
    1 |    2 | ["2013-02-20 00:00:01","2013-02-21 12:15:00")
    2 |    3 | ["2013-02-20 00:00:01","2013-02-22 09:01:00")
(3 rows) 
```

从 2013-02-21 00:00:00 包括到 2013-02-24 00:00:00 的可用节点不包括：

```
with upnodes as (
select zone, node, uptime
from nodes
where '[2013-02-21 00:00:00, 2013-02-24 00:00:00)'::tsrange && uptime
)
select * from upnodes
order by zone, uptime, node; 
```

产量：

```
 zone | node |                    uptime                     
------+------+-----------------------------------------------
    1 |    1 | ["2013-02-20 00:00:00","2013-02-21 09:40:00")
    1 |    2 | ["2013-02-20 00:00:01","2013-02-21 12:15:00")
    1 |    1 | ["2013-02-21 09:48:48","2013-02-21 10:04:56")
    1 |    1 | ["2013-02-21 10:09:27","2013-02-21 10:14:01")
    1 |    2 | ["2013-02-21 12:26:04","2013-02-21 13:15:53")
    1 |    2 | ["2013-02-22 10:21:14","2013-02-23 13:23:10")
    1 |    1 | ["2013-02-22 10:24:20","2013-02-22 10:26:29")
    1 |    1 | ["2013-02-22 11:25:15","2013-02-22 11:27:24")
    1 |    2 | ["2013-02-23 13:33:32","2013-02-24 13:35:23")
    2 |    3 | ["2013-02-20 00:00:01","2013-02-22 09:01:00")
    2 |    3 | ["2013-02-22 10:19:13","2013-02-22 17:23:59")
(11 rows) 
```

可用区域从 2013-02-21 00:00:00 incl 到 2013-02-24 00:00:00 excl'

```
with upnodes as (
select zone, node, uptime
from nodes
where '[2013-02-21 00:00:00, 2013-02-24 00:00:00)'::tsrange && uptime
),
upzones_max as (
select u1.zone, tsrange(lower(u1.uptime), max(upper(u2.uptime))) as uptime
from upnodes as u1
join upnodes as u2 on u2.zone = u1.zone and u2.uptime && u1.uptime
group by u1.zone, lower(u1.uptime)
),
upzones as (
select u1.zone, tsrange(min(lower(u2.uptime)), upper(u1.uptime)) as uptime
from upzones_max as u1
join upzones_max as u2 on u2.zone = u1.zone and u2.uptime && u1.uptime
group by u1.zone, upper(u1.uptime)
)
select zone, uptime, upper(uptime) - lower(uptime) as duration
from upzones
order by zone, uptime; 
```

产量：

```
 zone |                    uptime                     |    duration     
------+-----------------------------------------------+-----------------
    1 | ["2013-02-20 00:00:00","2013-02-21 12:15:00") | 1 day 12:15:00
    1 | ["2013-02-21 12:26:04","2013-02-21 13:15:53") | 00:49:49
    1 | ["2013-02-22 10:21:14","2013-02-23 13:23:10") | 1 day 03:01:56
    1 | ["2013-02-23 13:33:32","2013-02-24 13:35:23") | 1 day 00:01:51
    2 | ["2013-02-20 00:00:01","2013-02-22 09:01:00") | 2 days 09:00:59
    2 | ["2013-02-22 10:19:13","2013-02-22 17:23:59") | 07:04:46
(6 rows) 
```

如果您编写（或找到）对重叠范围类型求和的自定义聚合函数，则可能有更好的方法来编写后一个查询——我遇到的重要问题是隔离适当的 group by 子句；我最终解决了两个嵌套的 group by 子句。

也可以重写查询以适应您当前的模式，方法是用诸如 tsrange(start_date, end_date) 之类的表达式替换 uptime 字段，或者编写一个这样做的视图。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-27T13:10:52.450

```
DROP table if exists temptable;
CREATE TABLE temptable
(
  zone_name character varying(255),
  nodeid integer,
  nodelabel character varying(255),
  nodegainedservice timestamp with time zone,
  nodelostservice timestamp with time zone
);
INSERT INTO tempTable (zone_name, nodeid, nodelabel, nodegainedservice, nodelostservice) VALUES 
('Zone1',   27, 'Windows-SRV1', '2013-02-21 10:04:56+08',   '2013-02-21 09:48:48+08'),
('Zone1',   27, 'Windows-SRV1', '2013-02-21 10:14:01+08',   '2013-02-21 10:09:27+08'),
('Zone1',   27, 'Windows-SRV1', '2013-02-22 10:26:29+08',   '2013-02-22 10:24:20+08'),
('Zone1',   27, 'Windows-SRV1', '2013-02-22 11:27:24+08',   '2013-02-22 11:25:15+08'),
('Zone1',   27, 'Windows-SRV1', '2013-02-28 16:24:59+08',   '2013-02-28 15:52:59+08'),
('Zone1',   27, 'Windows-SRV1', '2013-02-28 16:56:19+08',   '2013-02-28 16:40:18+08'),
('Zone1',   39, 'Windows-SRV2', '2013-02-21 13:15:53+08',   '2013-02-21 12:26:04+08'),
('Zone1',   39, 'Windows-SRV2', '2013-02-23 13:23:10+08',   '2013-02-22 10:21:14+08'),
('Zone1',   39, 'Windows-SRV2', '2013-02-24 13:35:23+08',   '2013-02-23 13:33:32+08'),
('Zone1',   39, 'Windows-SRV2', '2013-02-26 15:17:25+08',   '2013-02-25 14:25:51+08'),
('Zone1',   39, 'Windows-SRV2', '2013-02-28 18:49:56+08',   '2013-02-28 15:43:01+08'),
('Zone2',   13, 'Windows-SRV3', '2013-02-22 17:23:59+08',   '2013-02-22 10:19:13+08'),
('Zone2',   13, 'Windows-SRV3', '2013-02-28 16:54:27+08',   '2013-02-28 16:13:48+08'),
('Zone2',   14, 'Windows-SRV4', '2013-02-22 11:02:56+08',   '2013-02-22 10:01:48+08');

with downodes as (
select zone_name, nodeid, nodelostservice, nodegainedservice
from temptable
WHERE (nodelostservice, nodegainedservice) OVERLAPS ('Wed Feb 20 00:00:00 +0800 2013'::TIMESTAMP, 'Fri Mar 01 00:00:00 +0800 2013'::TIMESTAMP)
),
donezones_max as(
select downodes1.zone_name, downodes1.nodeid, downodes1.nodelostservice, min(downodes2.nodegainedservice) as nodegainedservice
from downodes as downodes1
join downodes as downodes2 on downodes2.zone_name = downodes1.zone_name and ((downodes2.nodelostservice, downodes2.nodegainedservice) OVERLAPS (downodes1.nodelostservice, downodes1.nodegainedservice))
group by downodes1.zone_name, downodes1.nodeid, downodes1.nodelostservice
),
downzones as(
select downodes1.zone_name, downodes1.nodeid, max(downodes2.nodelostservice) as nodelostservice, downodes1.nodegainedservice
from donezones_max as downodes1
join donezones_max as downodes2 on downodes2.zone_name = downodes1.zone_name and  ((downodes2.nodelostservice, downodes2.nodegainedservice) OVERLAPS (downodes1.nodelostservice, downodes1.nodegainedservice))
group by downodes1.zone_name, downodes1.nodeid, downodes1.nodegainedservice 
),
zone_outages as(
SELECT 
    zone_name,
    nodelostservice,
    nodegainedservice,
    nodegainedservice - nodelostservice AS duration,
    CAST('1' AS INTEGER) as outage_counter
FROM downzones GROUP BY zone_name, nodelostservice, nodegainedservice HAVING COUNT(*) > 1 ORDER BY zone_name, nodelostservice)
select 
    zone_name,
    EXTRACT(epoch from (SUM(duration) / (greatest(1, SUM(outage_counter))))) AS average_duration_seconds,
    SUM(outage_counter) AS outage_count
FROM zone_outages GROUP BY zone_name ORDER BY zone_name 
```