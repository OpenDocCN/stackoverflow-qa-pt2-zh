# StackOverflow 问答 16088000-16088999

# facebook - Facebook Graph API 语言环境参数损坏？

> ID：16088002
> 
> 赞同：1
> 
> 时间：2013-04-18T16:10:54.953
> 
> 标签：facebook, facebook-graph-api, locale

这个 API URL 给了我 VitaminWater 的 Facebook 页面 ( [http://www.facebook.com/vitaminwater](http://www.facebook.com/vitaminwater) ) 的首页：

[https://graph.facebook.com/50540568485?fields=id,name,link,picture,posts.fields(message,picture,link,likes)&access_token=](https://graph.facebook.com/50540568485?fields=id,name,link,picture,posts.fields(message,picture,link,likes)&access_token=) ...

他们有很多针对德国人的内容，但无论我做什么，我都无法让 API 将其返回——它总是给我英文内容。[我已经尝试根据Facebook 的 API 参考文档](https://developers.facebook.com/docs/reference/api/locale/)设置参数“locale=de_DE” ，以及传递诸如“Accept-Language: de”和“Accept-Language: de-DE”之类的标头，这些都不起作用。这只是坏了，还是有其他方法可以检索我应该使用的特定语言环境的内容？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T08:51:12.427

我没有解决方案，但我可以确认 API 中的某些内容已损坏。我们正在使用来自不同供应商的监控工具，自 3 月 13 日以来，此问题一直存在且尚未得到解决。来自个人和粉丝页面的帖子仅以德语随机出现。

从其中一位工具提供商的信息中，我了解到他们正在与 FB 合作来识别和解决问题。所以也许等待令人沮丧，但这可能是更好的方法。

# asp.net - 参数化查询 '(@Physical_Address_Street varchar(50),@Physical_Address_Local va' 需要参数 '@Physical_Address_Street'

> ID：16088007
> 
> 赞同：0
> 
> 时间：2013-04-18T16:11:18.377
> 
> 标签：asp.net, sql-server-2008

我对 sql server 非常陌生，我正在创建一个 web 服务，并且使用下面的代码，我得到了上面的错误，我想知道我做错了什么？

```
<WebMethod()> _
Public Function GetAddresses(ByVal skip As Integer, ByVal take As Integer) As FuelStop()
    Dim resultList = New List(Of FuelStop)()
    Using sqlCon As New SqlConnection()
        sqlCon.ConnectionString = "Data Source=(local);Initial Catalog=DEV_DB;User ID=*****;Password=**********"
        Dim command As New SqlCommand("SELECT * FROM Gas_Stations WHERE Location_Type = 1 AND [ Physical_Address_Street] = @Physical_Address_Street AND [ Physical_Address_Local] = @Physical_Address_Local AND [Physical_Address_State] = @Physical_Address_State AND [ Physical_Address_Zip] = @Physical_Address_Zip AND [ Phone_Number] = @Phone_Number")
        command.Parameters.Add("@Physical_Address_Street", SqlDbType.VarChar, 50, "Physical_Address_Street")
        command.Parameters.Add("@Physical_Address_Local", SqlDbType.VarChar, 50, "Physical_Address_Local")
        command.Parameters.Add("@Physical_Address_State", SqlDbType.VarChar, 50, "Physical_Address_State")
        command.Parameters.Add("@Physical_Address_Zip", SqlDbType.VarChar, 50, "Physical_Address_Zip")
        command.Parameters.Add("@Phone_Number", SqlDbType.VarChar, 50, "Phone_Number")

        command.Connection = sqlCon
        sqlCon.Open()

        Using reader = command.ExecuteReader()
            While reader.Read()
                Dim addr = New FuelStop()
                addr.Physical_Address_Street = reader.GetString(0)
                addr.Physical_Address_Local = reader.GetString(1)
                addr.Physical_Address_State = reader.GetString(2)
                addr.Physical_Address_Zip = reader.GetString(3)
                addr.Phone_Number = reader.GetString(4)

                resultList.Add(addr)
            End While
        End Using
    End Using
    Return resultList.Skip(skip).Take(take).ToArray()
End Function 
```

我希望直接从数据库中提取查询中列出的列的值。我需要在 android 应用程序中显示所有地址信息。这将是只读情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:54:37.350

数据库中的列名可能不以空格开头，所以...

```
Dim command As New SqlCommand("SELECT * FROM Gas_Stations WHERE Location_Type = 1 AND [Physical_Address_Street] = @Physical_Address_Street AND [Physical_Address_Local] = @Physical_Address_Local AND [Physical_Address_State] = @Physical_Address_State AND [Physical_Address_Zip] = @Physical_Address_Zip AND [Phone_Number] = @Phone_Number") 
```

但是您可以利用 VB.NET XML 文字使其更易于阅读：

```
Dim sql = <sql>
        SELECT
            [Physical_Address_Street]
            , [Physical_Address_Local]
            , [Physical_Address_State]
            , [Physical_Address_Zip]
            , [Phone_Number]
        FROM Gas_Stations
        WHERE Location_Type = 1
            AND [Physical_Address_Street] = @Physical_Address_Street
            AND [Physical_Address_Local] = @Physical_Address_Local
            AND [Physical_Address_State] = @Physical_Address_State
            AND [Physical_Address_Zip] = @Physical_Address_Zip
            AND [Phone_Number] = @Phone_Number
        </sql>

Dim command As New SqlCommand()
command.CommandText = CStr(sql) 
```

请注意，我明确命名了要选择的列。这是为了确保您想要返回的列是您获得的列并且按照您想要的顺序。

至于预期的参数错误消息，您尚未为任何参数分配值。你可以这样做：

```
command.Parameters.Add("@Physical_Address_Street", SqlDbType.VarChar, 50).Value = physAddrStreet 
```

或像这样：

```
command.Parameters.Add("@Physical_Address_Street", SqlDbType.VarChar, 50)
command.Parameters("@Physical_Address_Street").Value = physAddrStreet 
```

编辑：因为你不需要所有这些参数，

```
Dim sql = <sql>
        SELECT
            [Physical_Address_Street]
            , [Physical_Address_Local]
            , [Physical_Address_State]
            , [Physical_Address_Zip]
            , [Phone_Number]
        FROM Gas_Stations
        WHERE Location_Type = 1
        </sql> 
```

并且不要做所有的`command.Parameters.Add(...)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:42:21.197

查看上面的查询，您似乎想要显示固定位置类型的一组动态属性（有时是街道，有时是邮政编码等）。

SQL Server 中的参数化查询旨在使用输入参数，而不是使用您希望在结果中看到的列。

如果您真的希望在结果中设置动态列，请查看有关如何执行此操作的[问题。](https://stackoverflow.com/questions/15420228/using-c-sharp-sql-parameterization-on-column-names)

相反，如果您正在寻找用户输入查询的地址、邮编等，那么您的查询会稍微倒退。它应该如下所示：

```
Dim command As New SqlCommand
   ("SELECT * FROM Gas_Stations 
      WHERE Location_Type = 1
            AND
            Physical_Address_Street = @Physical_Address_Street 
            AND 
            Physical_Address_Local = @Physical_Address_Local 
            AND 
            Physical_Address_State = @Physical_Address_State
            AND
            Physical_Address_Zip = @Physical_Address_Zip
            AND 
            Phone_Number = @Phone_Number
    ) 
```

注意：您需要为 VB.Net 清理上面的格式，我这样做是为了提高可读性。如果您想让这些字段可选地可搜索，还有[其他问题](https://stackoverflow.com/questions/205526/how-do-i-create-a-stored-procedure-that-will-optionally-search-columns)

# css - a:visited 在 JSF 1.2 中不能使用 h:commandLink

> ID：16088008
> 
> 赞同：0
> 
> 时间：2013-04-18T16:11:21.280
> 
> 标签：css, jsf-1.2

如果链接已被使用（单击），我们需要更改链接颜色。我们将 h:commandLink 与操作方法一起使用。下面是一个代码片段。

.xhtml 文件 -

```
<h:commandLink styleClass="changeLinkColor" action="#{bean.actionMethod}">
        <span><h:outputText value="UserName"/></span>
        </h:commandLink> 
```

.CSS 文件 -

```
.changeLinkColor
{
 color:#0000FF;
 text-decoration:none;
}
.changeLinkColor a:link
{
 color:blue;
 text-decoration:none;
}
.changeLinkColor a:visited
{
    color: black;
} 
```

除了 a:visited 之外，这里所有的样式都正常工作。但是，如果我们将 h:commandLink 更改为 h:outputLink，它就可以正常工作。但是后者没有动作方法属性。因此不能使用它。

如果您有任何解决方法可以使用 h:commandLink 标签更改链接颜色，请分享。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-10T22:39:05.747

当浏览器看到链接地址（href）被访问时，更改为访问颜色。

但是 commandLink 将生成一个带有 onclick 的链接，它将返回 false 以禁用 href 行为，例如：

```
<a onclick="return submitForm(x);" href="#">xx</a> 
```

所以这不是 JSF 问题，是 html 问题。

我们的解决方案是：

1.  创建一个不可见的 iframe
2.  将 href 覆盖为魔术路径
3.  覆盖onclick函数，让iframe先走魔道。

使用 jquery 示例：

```
 $(document).ready(function() {
      $("#linkDiv a").each(function(idx, elem)) {
        elem.href = '/dummy_' + elem.innerHTML + '.xhtml';
        var oldfunc = elem.onclick;
        $(elem).click(function(){
          invisibleFrame.location.href = elem.href;
          return oldfunc();
        });
      });
    }); 
```

# css - 复杂媒体查询

> ID：16088009
> 
> 赞同：0
> 
> 时间：2013-04-18T16:11:25.380
> 
> 标签：css, mobile, orientation, media-queries

一如既往，感谢您的帮助。

我正在尝试编写一个复杂的媒体查询，并且想知道那里是否有人可以提供帮助。

*   我想将 small.css 用于在任一方向上宽度或高度小于 640 像素的所有设备
*   我想对所有宽度和高度大于 640px 的设备使用 large.css

这是让我着迷的部分 - 我想打破上面的规则并使用

*   如果设备是横向且宽度大于 639px，则为 large.css
*   如果设备是纵向且宽度小于 640 像素，则为 small.css

这是我现在拥有的

```
 "only screen and (min-device-width:320px) and (max-device-width:639px)" 
  "only screen and (min-device-height:320px) and (max-device-width:639px)"
  "only screen and (min-device-width:640px)" 
```

任何帮助将不胜感激！

谢谢

富有的

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:49:55.763

首先，`(min|max)-device-width`这对设备的宽度没有帮助，而不是视口/浏览器窗口的像素宽度。然而，这个问题在手机/平板电脑上有所减少，因为浏览器几乎总是设备的整个宽度/高度。

此外，同时使用宽度/高度选项可能会导致一些冲突，尤其是在与设备方向一起使用时，因此拆分所有*关于方向*的查询可能会有所帮助。

这些应该给你一个起点：

```
 // small.css
    media="only screen and (max-width:639px) and (orientation: portrait)"

 // large.css  
    media="only screen and (min-width:640px) and (orientation: landscape)" 
```

由于设备/操作系统制造商的混合支持，媒体查询并不是一门精确的科学。如果您环顾网络，您会发现开发人员正在努力满足各种设备的需求。

值得查看以下内容以查找示例和可能的情况以及如何组合查询以更好地适应单个设备或更广泛的范围：

*   [Mozilla 开发者网络（CSS 媒体查询）](https://developer.mozilla.org/en/docs/CSS/Media_queries)
*   [W3C 媒体查询](http://www.w3.org/TR/css3-mediaqueries/#media1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:36:45.090

**设备是横向的，宽度大于 639px**

```
<link rel="stylesheet" media="screen and (orientation:landscape) and (min-device-width: 639px" href="large.css" /> 
```

**该设备是纵向的，宽度小于 640 像素**

```
<link rel="stylesheet" media="screen and (orientation:portrait) and (max-device-width: 640px" href="small.css" /> 
```

# sql-server - Sql Server 查询性能——Xml 列粉碎

> ID：16088010
> 
> 赞同：1
> 
> 时间：2013-04-18T16:11:25.663
> 
> 标签：sql-server, sql-server-2008, tsql

以下查询需要很长时间才能返回结果。我已经尝试了我能想到的一切来优化查询。使用这种结构存储了大约 10000 行 xml，大约需要 2.5 分钟才能返回结果。我在表上设置了一个主 xml 索引，并在表上设置了一个辅助（属性）索引。我已将索引设置为每 7 天重建一次。

我参考了这些位置

[XML 数据类型的性能优化](http://msdn.microsoft.com/en-us/library/ms345118%28v=sql.90%29.aspx)

[使用 xml 数据类型方法的指南](http://msdn.microsoft.com/en-us/library/ms175894.aspx)

[Xml 索引指南](https://www.simple-talk.com/sql/database-administration/getting-started-with-xml-indexes/)

[索引 XML](http://msdn.microsoft.com/en-us/library/ms191497.aspx)

[XML 最佳实践](http://msdn.microsoft.com/en-us/library/ms187508%28v=sql.90%29.aspx)

任何意见和建议将不胜感激。

对不起所有的代码，如果不需要，我可以把它拿出来。

我有一张桌子：

```
CREATE TABLE [dbo].[XmlTable](
    [XmlId] [int] IDENTITY(1,1) NOT NULL,
    [XmlDocument] [xml] NOT NULL,
 CONSTRAINT [PK_XmlTable] PRIMARY KEY CLUSTERED 
(
    [XmlId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]
) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]
GO 
```

带有属性二级索引

```
SET ARITHABORT ON
SET CONCAT_NULL_YIELDS_NULL ON
SET QUOTED_IDENTIFIER ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
SET NUMERIC_ROUNDABORT OFF

GO

CREATE XML INDEX [IXML_XmlTable_XmlDocument_Property] ON [dbo].[XmlTable]
(
    [XmlDocument]
)
USING XML INDEX [PXML_XmlTable_XmlDocument] FOR PROPERTY WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON)
GO 
```

带有主索引

```
SET ARITHABORT ON
SET CONCAT_NULL_YIELDS_NULL ON
SET QUOTED_IDENTIFIER ON
SET ANSI_NULLS ON
SET ANSI_PADDING ON
SET ANSI_WARNINGS ON
SET NUMERIC_ROUNDABORT OFF

GO

CREATE PRIMARY XML INDEX [PXML_XmlTable_XmlDocument] ON [dbo].[XmlTable]
(
    [XmlDocument]
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, DROP_EXISTING = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON)
GO 
```

使用这样的结构：

```
<dev:Doc xmlns:dev="http://www.w3.org/2001/XMLSchema" SchemaVersion="0.1" Settings="Testing" Title="Ordering">
  <dev:Base RevisionNumber="0" Baseid="34433" />
  <dev:Rev Time="2013-01-21T15:08:00">
    <dev:Person Name="Me" Systemid="54654" />
  </dev:Rev>
  <dev:Functions Id="A1">
    <dev:A1 Number="1">
      <dev:Codes>D</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Visitors>
        <dev:Visitor Name="Dev01" Location="STLRF">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
        <dev:Visitor Name="Dev02" Location="STLRF">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
        <dev:Visitor Name="Dev03" Location="FGRTY">
          <dev:Divisions>
            <dev:Division Number="1" Name="TFR3" Usage="Monitor">
              <dev:Description>Development Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="2" Name="DEF32" Usage="Monitor">
              <dev:Description>Testing Fundamentals</dev:Description>
            </dev:Division>
            <dev:Division Number="3" Name="DEP13" Usage="None">
              <dev:Description>Guided Fundamentals</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="FGY(14A)" />
      </dev:Senders>
    </dev:A1>
  </dev:Functions>
  <dev:Functions Id="A2">
    <dev:A2 Number="1">
      <dev:Codes>C</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Remarks>Support</dev:Remarks>
      <dev:Notes>Ready</dev:Notes>
      <dev:Visitors>
        <dev:Visitor Name="GHFF">
          <dev:Divisions>
            <dev:Division Number="0" Name="Trial" Usage="None">
              <dev:FromLocation>LOPO</dev:FromLocation>
              <dev:ToLocation>RDSS</dev:ToLocation>
              <dev:Description>Rich Filter</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="W33R" />
      </dev:Senders>
      <dev:IsReady>true</dev:IsReady>
      <dev:IsCall>false</dev:IsCall>
    </dev:A2>
    <dev:A2 Number="2">
      <dev:Codes>A</dev:Codes>
      <dev:Required>true</dev:Required>
      <dev:Informational>false</dev:Informational>
      <dev:Remarks>Loader Ready</dev:Remarks>
      <dev:Notes>Ready</dev:Notes>
      <dev:Visitors>
        <dev:Visitor Name="UDT">
          <dev:Divisions>
            <dev:Division Number="0" Name="Trial" Usage="None">
              <dev:FromLocation>TYUJ</dev:FromLocation>
              <dev:ToLocation>DETF</dev:ToLocation>
              <dev:Description>Web Enhance</dev:Description>
            </dev:Division>
          </dev:Divisions>
        </dev:Visitor>
      </dev:Visitors>
      <dev:Senders>
        <dev:Sender Name="RJ4" />
      </dev:Senders>
      <dev:IsReady>true</dev:IsReady>
      <dev:IsCall>false</dev:IsCall>
    </dev:A2>
  </dev:Functions>
</dev:Doc> 
```

和查询：

```
;WITH XMLNAMESPACES (Default 'http://www.w3.org/2001/XMLSchema' )
SELECT  

a.value('@RevisionNumber[1]', 'INT') AS Number,
b.value('@Id[1]', 'VARCHAR(10)') AS FunctionID,
c.value('@Number[1]', 'INT') AS Number,
d.value('@Name[1]', 'VARCHAR(10)') AS Visitor,
d.value('@Location[1]', 'VARCHAR(10)') AS Location,
e.value('@Name[1]', 'NVARCHAR(10)') AS Sender

From XmlTable as x

    CROSS APPLY xmlDocument.nodes('Doc/Base') As aa(a)
    CROSS APPLY xmlDocument.nodes('Doc/Functions') bb(b)
    CROSS APPLY b.nodes('*') cc(c)
    CROSS APPLY c.nodes('Visitors/Visitor') dd(d)
    CROSS APPLY c.nodes('Senders/Sender') ee(e) 
```

这是表格中的插入内容，为了测试我运行了 10000 次

```
INSERT INTO XmlTable(XMLDocument)
SELECT * FROM OPENROWSET(
   BULK 'C:\Users\123\Desktop\Practice.xml',
   SINGLE_BLOB) AS x;

Go 10000 
```

我最初是这个查询，但它比上面的查询慢 x3

```
;WITH XMLNAMESPACES (default 'http://www.w3.org/2001/XMLSchema')
SELECT  
    a.value('(Base/@RevisionNumber)[1]', 'INT') AS RevNumber,
    b.value('@Id[1]', 'VARCHAR(10)') AS FunctionID,
    c.value('@Number[1]', 'INT') AS Number,
    d.value('@Name[1]', 'VARCHAR(10)') AS Visitor,
    d.value('@Location[1]', 'VARCHAR(10)') AS Location,
    c.value('(Senders/Sender/@Name)[1]', 'VARCHAR(10)') AS Sender
FROM XmlTable
CROSS APPLY xmlDocument.nodes('Doc') As aa(a)
CROSS APPLY a.nodes('Functions') bb(b)
CROSS APPLY b.nodes('*') cc(c)
CROSS APPLY c.nodes('Visitors/Visitor') dd(d) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:28:01.403

首先，看起来你正在做很多交叉申请来切碎。你能不能仅仅扩展一个单一的交叉申请一个共同的分母并获得你的价值，比如：

```
a.value('/(element)/(element)[(expression)].value('(@thing)', '(type)'). 
```

我的想法是您拥有的语法很好，但是您以五次不同的方式创建了一个层次结构，然后多次交叉应用它。我没有做很多 xml 粉碎，但我知道多重交叉应用可能是杀手，因为你采用一个 3D 值并以不同方式填充参考五次可能是问题所在。您可以使用 '/(element)' 表示法进一步扩展元素。

我可能是错的，这可能很好。如果你必须做这么多的交叉应用，你可以先在临时表转储中做它们可能会加速它。然后，您可能也可以在临时表上创建 xml 索引。例如：

```
Select a.query('*')
into #NodeA
From XmlTable as x
    CROSS APPLY xmlDocument.nodes('Doc/Base') As aa(a) 
```

如果在删除临时表后性能仍然很慢，那么创建一个 xml 索引。不确定 xml 索引，因为我还没有完成它们。我知道您可以在临时表上删除和创建常规索引，所以我假设您可以使用 xml 索引来完成。

[http://msdn.microsoft.com/en-us/library/bb934097.aspx](http://msdn.microsoft.com/en-us/library/bb934097.aspx)

**编辑**

请记住，您还可以在粉碎 xml 时将“查询”语法与“值”语法混合使用，这对于查找树结构然后填充结果非常有用。我在 SSRS 报告服务器中粉碎 xml 时这样做，类似于：

```
Use ReportServer
GO

With a as 
                (
                Select 
                                c.Name as ReportName
                ,               cast(sub.ExtensionSettings as xml) XML
                ,               sub.ModifiedDate as SubscriptionModifiedDate
                ,               sub.Description
                ,               sub.LastRunTime
                from dbo.ReportSchedule rs (nolock) 
                                join dbo.Schedule s (nolock) on rs.ScheduleID = s.ScheduleID
                                join dbo.Subscriptions sub (nolock) on rs.SubscriptionID = sub.SubscriptionID
                                join dbo.Catalog c (nolock) on rs.ReportID = c.ItemID
                )
select 
                a.ReportName
,               a.SubscriptionModifiedDate
,               a.Description
,               t.query('/ParameterValues/ParameterValue[* = "Subject"]/Value').value('.', 'varchar(max)') as Subject
from a
    cross apply a.XML.nodes('//ParameterValues') as n(t) 
```

# ruby-on-rails - Rails - 对 engine_name 的调用似乎被忽略了

> ID：16088011
> 
> 赞同：4
> 
> 时间：2013-04-18T16:11:28.490
> 
> 标签：ruby-on-rails, rails-engines, ruby-on-rails-4

我想制作一个由两个命名空间隔离的引擎。也就是说，例如，我想制作一个引擎，其类都存在于：

```
Car::BMW 
```

因此，我的模型例如应该放在：

```
app/models/car/bmw/ 
```

我的表格应该以例如为前缀：

```
car_bmw_ 
```

我试图通过使用此代码来完成此操作`lib/car/bmw/engine.rb`

```
module Car
  module BMW
    class Engine < ::Rails::Engine
      isolate_namespace Car::BMW # This will call: engine_name 'car_bmw'
    end
  end
end 
```

但是，每当我生成模型时，使用此代码，模型都会放置在：

```
app/models/car 
```

该表的前缀为：

```
car_ 
```

我究竟做错了什么？我正在使用的导轨版本是`4.0.0.beta1`

* * *

## **编辑**

我在`Rails::Generators::NamedBase`

```
def namespaced_path
  @namespaced_path ||= namespace.name.split("::").map {|m| m.underscore }[0]
end 
```

如您所见，它只占用命名空间的第一部分。有人知道为什么吗？

**这是 Rails 中的错误还是我不应该让我的类具有双重命名空间？**

* * *

这是我用来修复发电机的快速破解方法。

```
require 'rails/generators'

Rails::Generators::NamedBase.class_eval do
  protected
    def namespaced_class_path
      @namespaced_class_path ||= [namespaced_path.split('/')] + @class_path
    end

    def namespaced_path
      @namespaced_path ||= namespace.name.split("::").map {|m| m.underscore }.join('/')
    end

    def class_name
      ([file_name]).map!{ |m| m.camelize }.join('::')
    end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T13:05:57.363

我不明白你为什么想要那个。如果你想在你的`Car`引擎之间共享功能，继承可能不是办法。如果你真的想要的话，你可能会拥有它的初始风格，即在汽车引擎中安装 BMW 引擎。

如果`Car`不是您想要添加功能并在其他子模块之间共享的模块，则将其删除。

如果您希望汽车引擎喜欢`Car::BMW`共享功能，那么您可以将其作为外部依赖项。您所有的汽车引擎都可能需要`ActsAsACar`宝石或其他东西。

我仍然很难弄清楚为什么要使用双重命名空间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-25T12:47:48.297

使用这样的类

```
module Car
  module BMW
    class Engine < ::Rails::Engine
      isolate_namespace Car::BMW # This will call: engine_name 'car_bmw'
      paths["app/models"] << "app/models/car/bmw"
    end
  end
end 
```

将允许您从您指定的子目录加载模型。不过，我不能说这是否会影响生成过程。

还有更多配置选项，请参见[此处](http://edgeapi.rubyonrails.org/classes/Rails/Engine.html#label-Paths)。编辑它们以满足您的需求。

# jquery - 使用 jquery 动态添加隐藏输入

> ID：16088012
> 
> 赞同：0
> 
> 时间：2013-04-18T16:11:30.503
> 
> 标签：jquery, events

我使用 jquery 动态添加一个隐藏的输入字段，该字段在选项选择时将值填充到我的表行中。该功能正在执行，但问题是在新选择上没有被每个选项覆盖，选择一个新的输入字段正在添加。另一个问题是每次我添加 2 个 ipnut 字段时。我的代码看起来像

```
 jQuery(".add_column").change('select',function(event){             
       var selected_column = $j(this).find(":selected").val();
       var selected_value  = $j(this).parent('tr').data('id');
       var column_type;
       $j(this).find("option:selected").each(function(){
            column_type = ($j(this).parent().attr("label") );                   
        });

       $j('<input/>',{type:'hidden',value:selected_value+'|'+selected_column , name:column_type+'[]'}).appendTo($j(this).parent('tr'));

    }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:30:17.057

出于安全原因，不要使用对象语法来构造元素。您可以使用字符串构造函数：

```
 $('<input name="inputs[]" type="hidden" value="'+value+'" />').appendTo('#inputs-content'); 
```

最好采用这种方法。

尝试： http: [//jsfiddle.net/zM8zy/](http://jsfiddle.net/zM8zy/) *（打开浏览器控制台并检查 DOM 元素以显示结果）*

# .net - WIF STS 实施检查与 ADSF 绑定的活动 ASP.NET 登录/会话

> ID：16088017
> 
> 赞同：0
> 
> 时间：2013-04-18T16:11:48.237
> 
> 标签：.net, wcf, wif

我计划实现一个面向外部的 ASP.NET Web 应用程序以及一个提供外部可用 API 的 Windows Communication Foundation (WCF) 服务。我将通过使用 Windows Identity Foundation (WIF) 滚动我自己的安全令牌服务 (STS) 来为 Web 应用程序和服务提供安全性。

这些文章描述了我打算如何实现这一点的基础知识：http: [//msdn.microsoft.com/en-us/magazine/ee335707.aspx](http://msdn.microsoft.com/en-us/magazine/ee335707.aspx) 和 [http://devproconnections.com/development/generating-saml-tokens -wif-part-2](http://devproconnections.com/development/generating-saml-tokens-wif-part-2)

结合 Vittorio Bertocci 关于该主题的优秀书籍提供的信息： [http ://www.amazon.com/Programming-Windows-Identity-Foundation-Dev/dp/0735627185/ref=sr_1_6?ie=UTF8&qid=1366300926&sr=8- 6&keywords=维托里奥+贝托奇](https://rads.stackoverflow.com/amzn/click/com/0735627185)

我应该拥有完成这项任务所需的所有工具和信息。该应用程序的用例如下：用户登录到我们拥有的 ASP .NET Web 应用程序，包括用户身份验证和授权机制。在此应用程序上，他们单击一个链接，该链接使用 SAML 单点登录 (SSO) 到第三方应用程序（与我们有紧密的业务关系）。在这个第三方应用程序上，用户可以透明地处理我们存储在我们组织内部的另一个应用程序上的文件。基本上，他们将对我的 Web 应用程序/WCF 服务执行透明/静默 SAML SSO，以便在登录到第三方 Web 应用程序时保存或检索文档。

就像我之前说的，我想我已经掌握了如何为这个过程实现授权和身份验证的基础知识。

但是，我的安全团队提出的一项要求是，我们确保从外部公开但完全归我们所有的原始 Web 应用程序登录到第三方站点的用户，具有与外部站点的活动会话. 简而言之，我们需要确保该用户实际登录到站点 A，正在使用站点 B，但希望通过确保他们实际上仍然登录到站点 A 来访问站点 C 上的资源。

我将如何获得有关该用户的这些信息？现在，我确实为站点 A 推出了自己的角色提供程序，但身份验证是通过表单身份验证使用较旧的用户名/密码机制执行的，该机制不包括使用 ASP .NET 2.0“标准”成员资格提供程序。因此，我无法使用 Security.Web.Membership。

最后，同样的过程将适用于我们活动目录上的内部用户，他们将从我们的内部网络登录到站点 B，然后再次使用站点 C。我相信我们将使用 ADFS v2 进行身份验证。在针对站点 C 进行身份验证之前确保所述用户在 AD 中处于活动状态的任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:43:39.373

跟踪网站用户是否仍处于活动状态的唯一合理方法是使用有效期较短（例如 10 分钟）的令牌，每次用户浏览网站时都会自动重置。有了这个，您可以说用户在过去 10 分钟内处于活动状态并登录。您需要在服务器上的持久存储中跟踪令牌，该令牌会随着最近用户操作/令牌重置的时间而更新，以便后端系统可以询问“此用户是否仍然处于活动状态？”，而您需要向 Web 客户端传递一些内容，以便他们可以在每个后续 Web 请求中将其传递回服务器，以保持会话处于活动状态。这通常是一个会话 cookie。cookie 可能与令牌相同，或者您可以将 cookie 设置为随机值，如果您不这样做，该值将映射到服务器内部的令牌 不希望浏览器应用程序知道真正的令牌。如果用户主动退出 Web 应用程序，那么您将在后端数据库中取消令牌。

其他技术可能涉及保持长时间运行的 http 连接打开（基于 ala web 的 irc 聊天），但这会消耗大量网络资源，特别是在您的服务器和防火墙上，并且它并不能真正提供任何更大的保证，即用户实际上仍在寻找在浏览器中的 Web 应用程序中。已打开 30 分钟但在 20 分钟内没有页面导航的会话听起来像是用户去吃午饭并保持浏览器窗口打开。如果您无论如何都必须跟踪页面导航，那么保持 http 连接打开并不会真正为您带来任何好处。

# android - AsyncTask 行为混淆

> ID：16088018
> 
> 赞同：1
> 
> 时间：2013-04-18T16:11:49.823
> 
> 标签：android, android-asynctask

我有这个项目：

我试图不明白问题出在哪里以及如何解决，但这一点我真的不知道问题出在哪里。我有一个按钮和一个 TextView。单击按钮时，将调用此过程：

```
android:onClick="pulsaboton" 
```

TextView 向我展示了输出。

这是 Main_Activity.java

```
package com.example.pruebasonidos;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.View;
import android.widget.TextView;

public class MainActivity extends Activity {
public String cadena1="", cadena2="";
public TextView tv;
@Override
protected void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    tv = (TextView) findViewById(R.id.textview01);
}
public class generamusica extends AsyncTask<String, Integer, Integer>
{
    @Override
    protected void onPreExecute(){
        tv.setText(tv.getText().toString()+"Pre Execute");  
    }

    @Override
    protected Integer doInBackground(String...strings) {

        String cadena=strings[0];
        tv.setText(tv.getText().toString()+cadena); 
        return null;
    }
    @Override
    protected void onPostExecute(Integer bytes){
        tv.setText(tv.getText().toString()+"Post Execute"); 
    }

}
public void pulsaboton(View v) {
cadena1="123"; cadena2="111";
tv.setText("");
new generamusica().execute(cadena1);
new generamusica().execute(cadena2);
}
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.main, menu);
    return true;
}

} 
```

当点击 pulsaboton 时，textview1 显示：

```
PreExecutePreExecute123111PostExecutePostExecute 
```

我想要这个输出：

```
PreExecute123PostExecutePreExecute111PostExecute 
```

错误是什么？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:18:31.080

首次引入时，AsyncTask 在单个后台线程上串行执行。从 DONUT 开始，这被更改为允许多个任务并行运行的线程池。**从 HONEYCOMB 开始，任务在单个线程上执行，以避免并行执行导致的常见应用程序错误。**.

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

您正在后台线程上更新 ui，这是不可能的。您需要在 ui 线程上更新 ui

在 doInBackground()

```
 runOnUiThread(new Runnable() //run on ui thread
             {
              public void run() 
              {       
                   String cadena=strings[0];
                   tv.setText(tv.getText().toString()+cadena); ;
             }
             }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:19:34.087

对于您所需的输出，请在 中调用这两行`onPostExecute`，

```
 cadena2="111";
    new generamusica().execute(cadena2); 
```

并且不要尝试在后台线程中更新 UI。

看到[这个](https://stackoverflow.com/a/12008663/792232)了解更多信息

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:16:40.687

警告：在 UI 线程之外执行的界面修改！

```
protected Integer doInBackground(String...strings) {
    ...
    tv.setText(tv.getText().toString()+cadena); 
    ...
} 
```

为什么你认为`AsyncTask`暴露`onPreExecute`和`onPostExecute`？您不能在`doInBackground`异步代码之前和之后完成所有界面工作吗？

在Android中，需要从主线程、**前台**线程访问UI；`doInBackground`没有**运行**。_

如果您需要在执行**期间**`AsyncTask`将更新发布到您的 UI ，请使用该`publishProgress`机制。

**编辑：**`onPreExecute` “正确”访问界面比仅使用and复杂得多`onPostExecute`。请参阅[此博客文章](http://blogactivity.wordpress.com/2011/09/01/proper-use-of-asynctask/)。也许你应该试试`Loader`API，它不那么麻烦。

# javascript - json web service 从动态参数的名称中获取值

> ID：16088019
> 
> 赞同：0
> 
> 时间：2013-04-18T16:11:55.377
> 
> 标签：javascript, web-services

请从我的 json Web 服务中获得以下输出：

```
 {"format":"json",
       "success":true,
       "errors":[],
       "result":
       {"**206**":
         {"player_name":"stagiaire",
           "M":{
                "6480":{"score":0,"answer":"cdgvbdbgd","category_name":"cdgvbdbgd"},
                "6481":{"score":0,"answer":"cdgvbdbgd","category_name":"cdgvbdbgd"},
                "6482":{"score":0,"answer":"cdgvbdbgd","category_name":"cdgvbdbgd"},
                "6483":{"score":0,"answer":"cdgvbdbgd","category_name":"cdgvbdbgd"},
               },

          "O":{
                 ..... },
      }
     }
    } 
```

我想要的是提取值（现在是 206，但它可以是另一个数字）。我正在寻求您的帮助以实现这一目标。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:15:15.387

如果生成的对象仅包含一个以该数字作为名称的属性，即

```
result = {
    206 : {
        ...
    }
    // no other properties here
} 
```

那么你可以使用类似的东西：

```
var num = Object.keys(result).shift();  // "206" 
```

检查**MDN**方法的[浏览器兼容性](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys#Browser_support)，并在需要时使用[shim 。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Object/keys#Compatibility)`Object.keys()`

 *** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:23:36.423

如果您要查找的对象始终具有玩家名称作为值，请尝试

```
for (var key in obj.result) if obj.result[key]["player_name") alert(key) 
```

或者使用 jQuery

```
$.each(data.result,function(key,val) {
  alert(key);
}); 
```**

# python - 我该如何解决; “TypeError：‘WikipediaItem’对象不支持项目分配”

> ID：16088022
> 
> 赞同：3
> 
> 时间：2013-04-18T16:12:00.350
> 
> 标签：python, web-scraping, scrapy, wikipedia

我对python和scrapy都很陌生。我想从维基百科上抓取数据，但没有成功。每次我做scrapy crawl wiki，我总是得到；“TypeError：‘WikipediaItem’对象不支持项目分配”。我该如何解决这个问题并让我成功地从维基百科中获取详细信息。

无论如何，这是我的代码：

```
from scrapy.spider import BaseSpider
from scrapy.selector import HtmlXPathSelector
from wikipedia.items import WikipediaItem

class WikipediaItem(BaseSpider):
    name = "wiki"
    allowed_domains = ["wikipedia.org"]
    start_urls = ["http://en.wikipedia.org/wiki/Main_Page"]

    def parse(self, response):
        hxs = HtmlXPathSelector(response)
        sites = hxs.select('//table[@id="mp-upper"]/tr')
        items = []
        for site in sites:
            item = WikipediaItem()
            item['title'] = site.select('.//a[@class="MainPageBG"]/text()').extract()
            item['link'] = site.select('.//a[@class="MainPageBG"]').extract()
            item['details'] = site.select('.//p/text()').extract()
            items.append(item)
        return items 
```

这是我得到的结果：

```
2013-04-18 23:56:54+0800 [scrapy] INFO: Scrapy 0.14.4 started (bot: wikipedia)
2013-04-18 23:56:54+0800 [scrapy] DEBUG: Enabled extensions: LogStats, TelnetConsole, CloseSpider, WebService, CoreStats, MemoryUsage, SpiderState
2013-04-18 23:56:54+0800 [scrapy] DEBUG: Enabled downloader middlewares: HttpAuthMiddleware, DownloadTimeoutMiddleware, UserAgentMiddleware, RetryMiddleware, DefaultHeadersMiddleware, RedirectMiddleware, CookiesMiddleware, HttpCompressionMiddleware, ChunkedTransferMiddleware, DownloaderStats
2013-04-18 23:56:54+0800 [scrapy] DEBUG: Enabled spider middlewares: HttpErrorMiddleware, OffsiteMiddleware, RefererMiddleware, UrlLengthMiddleware, DepthMiddleware    
2013-04-18 23:56:54+0800 [scrapy] DEBUG: Enabled item pipelines: 
2013-04-18 23:56:54+0800 [wiki] INFO: Spider opened
2013-04-18 23:56:54+0800 [wiki] INFO: Crawled 0 pages (at 0 pages/min), scraped 0 items (at 0 items/min)
2013-04-18 23:56:54+0800 [scrapy] DEBUG: Telnet console listening on 0.0.0.0:6023
2013-04-18 23:56:54+0800 [scrapy] DEBUG: Web service listening on 0.0.0.0:6080
2013-04-18 23:56:56+0800 [wiki] DEBUG: Crawled (200) <GET http://en.wikipedia.org/wiki/Main_Page> (referer: None)
2013-04-18 23:56:56+0800 [wiki] ERROR: Spider error processing <GET http://en.wikipedia.org/wiki/Main_Page>
    Traceback (most recent call last):
      File "/usr/lib/python2.7/dist-packages/twisted/internet/base.py", line 1178, in mainLoop
        self.runUntilCurrent()
      File "/usr/lib/python2.7/dist-packages/twisted/internet/base.py", line 800, in runUntilCurrent
        call.func(*call.args, **call.kw)
      File "/usr/lib/python2.7/dist-packages/twisted/internet/defer.py", line 368, in callback
        self._startRunCallbacks(result)
      File "/usr/lib/python2.7/dist-packages/twisted/internet/defer.py", line 464, in _startRunCallbacks
        self._runCallbacks()
    --- <exception caught here> ---
      File "/usr/lib/python2.7/dist-packages/twisted/internet/defer.py", line 551, in _runCallbacks
        current.result = callback(current.result, *args, **kw)
      File "/home/jean/wiki/wikipedia/spiders/wikipedia_spider.py", line 17, in parse
        item['title'] = row.select('.//a[@class="MainPageBG"]/text()').extract()
    exceptions.TypeError: 'WikipediaItem' object does not support item assignment
2013-04-18 23:56:56+0800 [wiki] INFO: Closing spider (finished)
2013-04-18 23:56:56+0800 [wiki] INFO: Dumping spider stats:
    {'downloader/request_bytes': 215,
     'downloader/request_count': 1,    
     'downloader/request_method_count/GET': 1,
     'downloader/response_bytes': 17762,
     'downloader/response_count': 1,
     'downloader/response_status_count/200': 1,
     'finish_reason': 'finished',
     'finish_time': datetime.datetime(2013, 4, 18, 15, 56, 56, 244255),    
     'scheduler/memory_enqueued': 1,
     'spider_exceptions/TypeError': 1,
     'start_time': datetime.datetime(2013, 4, 18, 15, 56, 54, 592948)}
2013-04-18 23:56:56+0800 [wiki] INFO: Spider closed (finished)
2013-04-18 23:56:56+0800 [scrapy] INFO: Dumping global stats:
    {'memusage/max': 28065792, 'memusage/startup': 28065792} 
```

这是我的 items.py

从 scrapy.item 导入项目、字段

类维基百科项目（项目）：

```
title = Field()

link = Field()

details = Field() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:22:38.407

您将刮板命名为与`WikipediaItem`导入的相同：

```
from wikipedia.items import WikipediaItem

class WikipediaItem(BaseSpider):
    # ... 
```

`parse`因此使用的是您的子`BaseSpider`类，而不是您在`wikipedia.items`. 也许您想重命名该类：

```
class WikipediaSpider(BaseSpider):
    # ... 
```

# clojure - 在哈希图中用零替换零值

> ID：16088023
> 
> 赞同：2
> 
> 时间：2013-04-18T16:12:03.347
> 
> 标签：clojure, hashmap, null

我在 clojure 中有一个哈希映射，其中包含一些 nil 值。我正在尝试对数据进行分组并对值求和，由于 nil 值，这给了我一个空指针。有人可以建议我如何遍历哈希映射并将所有 nil 值替换为整数 0 吗？

```
(def data [{:MEDAL "SILVER" :EMEA 1 :NA nil :ASPAC 3}
       {:MEDAL "GOLD" :EMEA 1 :NA 2 :ASPAC 3}
       {:MEDAL "GOLD" :EMEA nil :NA 2 :ASPAC nil}
       {:MEDAL "BRONZE" :EMEA nil :NA 2 :ASPAC 3}
       {:MEDAL "SILVER" :EMEA 1 :NA 2 :ASPAC 3}
       {:MEDAL "GOLD" :EMEA 1 :NA nil :ASPAC nil}
       {:MEDAL "BRONZE" :EMEA 1 :NA 2 :ASPAC 3}]) 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:29:43.107

```
(map (fn [m]
       (into {} 
         (map (fn [[k v]]
              [k (if (nil? v) 0 v)]) m)))
     data)
=> ({:EMEA 1, :NA 0, :MEDAL "SILVER", :ASPAC 3} 
    {:EMEA 1, :NA 2, :MEDAL "GOLD", :ASPAC 3} 
    {:EMEA 0, :NA 2, :MEDAL "GOLD", :ASPAC 0} 
    {:EMEA 0, :NA 2, :MEDAL "BRONZE", :ASPAC 3} 
    {:EMEA 1, :NA 2, :MEDAL "SILVER", :ASPAC 3} 
    {:EMEA 1, :NA 0, :MEDAL "GOLD", :ASPAC 0}
    {:EMEA 1, :NA 2, :MEDAL "BRONZE", :ASPAC 3}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:45:48.610

与其用零替换 nil 值，不如考虑使用`keep`. 例如：

```
(apply + (keep :NA data))
; 10
(apply + (keep (fn [m] (when (= (:MEDAL m) "SILVER") (:EMEA m))) data))
; 2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T06:31:43.447

你可以使用`fnil`.

```
(->> data
  (apply merge-with conj (zipmap [:EMEA :NA :MEDAL :ASPAC] (repeat [])))
  (reduce-kv #(assoc %1 %2 (reduce (fnil + 0 0) 0 %3)) {})) 
```

*显然：MEDAL 需要其他治疗。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T14:07:23.057

我假设您想按 :MEDAL 对数据进行分组，然后添加 EMEA、ASPAC 等，对吗？

```
;; Helper function
(defn batch-hashmaps
  "Applies operation on values of keys in maps. filterf filters valid values.
Example: (batch-hashmaps + [:b :c] number? {:a 30, :b 50, :c :cheese} {:b 30, :c 40})
=> {:b 80, :c 40}"
  [operation keys filterf & maps]
  (apply conj {} 
          (for [key keys]
            [key (apply operation (filter filterf (map #(key %) maps)))])))

(for [medal (set (map #(:MEDAL %) data))]
  (assoc (apply (partial batch-hashmaps + [:EMEA :NA :ASPAC] number?) (filter #(= medal (:MEDAL %)) data) ) :MEDAL medal)) 
```

这应该是期望的结果：

```
({:MEDAL "GOLD", :EMEA 2, :NA 4, :ASPAC 3}
{:MEDAL "SILVER", :EMEA 2, :NA 2, :ASPAC 6}
{:MEDAL "BRONZE", :EMEA 1, :NA 4, :ASPAC 6}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T17:43:47.247

这是另一个快速而肮脏的事情。

```
(defn sum-medal
[medal data]
(assoc (apply (partial merge-with (fn [& [_ _ :as vals]] (apply + (filter number? vals)))) (filter #(= (:MEDAL %) medal) data)) :MEDAL medal)) 
```

# html - 突破位置：相对*不*改变结构

> ID：16088025
> 
> 赞同：5
> 
> 时间：2013-04-18T16:12:08.323
> 
> 标签：html, css, position

一个简化的例子：

HTML：

```
<div id="A">
    <div id="B"></div>
    <div id="C"></div>
    <div id="D"></div>
</div> 
```

CSS：

```
#A,#B,#C,#D{width:100px;height:100px}
#A{position:relative;width:220px;top:20px;left:20px;background:#FF0000}
#B{position:absolute;top:0;left:0;background:#FFFF00}
#C{position:absolute;top:10px;left:80px;background:#00FF00}
#D{position:absolute;background:#00FFFF;top:0;right:0} 
```

作为小提琴：http: [//jsfiddle.net/h6BNz/](http://jsfiddle.net/h6BNz/)

OK 所以`C`是在前面`B`和后面`D`，并且相对于 定位`A`。我想将它相对于文档定位，但将它保持在 B 和 D 之间（在 z-index 和 tab 顺序中）。如果`C`的位置更改为`position:fixed`，它完全符合我的要求，除了（显然）不随页面滚动。

我已经看到很多解决方案涉及将 div 从其父级中分离出来以实现此目的，但这需要设置 z-indices 和 tab 顺序，这似乎是管理的噩梦（这是一个插件，所以周围的代码在外面我的控制）。

如何在不破坏or或改变结构的情况下给出`C`真正的绝对位置？JavaScript 可以很好地设置它，但我需要完美地舍入最终页面位置（如果您对为什么感兴趣，请参阅我的其他一些问题），所以我认为我不能使用方法。`B``D``absolutePosition - absolutePositionOfContainer`

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:19:32.957

如果里面`#A`有`position: relative`任何东西，它将相对于`#A`.

所以`#B` `#C`和`#D`都将被`#A`. 如果它在某个位置的内部，则不能相对于文档定位它。

您可以使用负边距将其放置在 之外`#A`，但前提`#A`是 has `overflow: visible`。

# asp.net-web-api - 应用程序池回收后无法重新连接 SignalR JS 客户端

> ID：16088026
> 
> 赞同：2
> 
> 时间：2013-04-18T16:12:11.150
> 
> 标签：asp.net-web-api, signalr, signalr-hub

当我为运行 SignalR 集线器的站点回收我的应用程序池时，javascript 客户端无法重新连接。但是，如果客户端在他的浏览器上进行刷新，一切都会好起来的。

在客户端控制台日志中，这些行在应用程序池重置后每秒重复多次：（我已将连接令牌替换为 abcd ）

```
LOGG: [15:51:19 UTC+0200] SignalR: Raising the reconnect event  
LOGG: [15:51:19 UTC+0200] SignalR: An error occurred using longPolling. Status = parsererror. undefined  
LOGG: [15:51:19 UTC+0200] SignalR: SignalR: Initializing long polling connection with server.  
LOGG: [15:51:19 UTC+0200] SignalR: Attempting to connect to 'http://lab/signalr/reconnect?transport=longPolling&connectionToken=abcd' using longPolling. 
LOGG: [15:51:19 UTC+0200] SignalR: Raising the reconnect event 
```

我尝试禁用集线器上的所有身份验证，但结果仍然相同。服务器和客户端都在 SignalR v1.0.1 上运行

客户端上的 hubconnection 设置如下：

```
var connection = $.hubConnection('http://lab:8097', { logging: true });
var proxy = connection.createHubProxy('task');
connection.start({ jsonp: true }).done(function () {
    proxy.invoke('OpenTask', id);
}); 
```

我还在服务器端集线器注册上使用跨域：

```
RouteTable.Routes.MapHubs(new HubConfiguration { EnableCrossDomain = true }); 
```

服务器运行在 IIS 7.5 上，客户端是 IE9。

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T23:48:28.123

此问题将在 1.1 RTW 中解决（尚未发布，目前只有 beta 版）。

供您参考，这里是修复：[https](https://github.com/SignalR/SignalR/issues/1809) ://github.com/SignalR/SignalR/issues/1809 。如果您想更早地进行修复，您可以实施问题中提到的更改。

最后，如果您确实选择实施修复，您将需要处理连接上的 .disconnected 事件并完全重新启动连接。

# python - 使用 F-Score、Precision 或 Recall 进行 LIBSVM 评估

> ID：16088034
> 
> 赞同：0
> 
> 时间：2013-04-18T16:12:36.400
> 
> 标签：python, libsvm

我是 Libsvm 的新手，我刚刚尝试使用 grid.py 进行交叉验证，它只给了我准确度评估。

如何让它显示 F-Score（首选）或 Precision 和 Recall？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T12:47:48.647

作者`libsvm`提供[了一个扩展](http://www.csie.ntu.edu.tw/~cjlin/libsvmtools/eval/index.html)，使您能够根据需要在交叉验证期间使用不同的评分机制。目前，它支持`precision`、`recall`、`fscore`和。`bac``auc`

不幸的是，设置它确实涉及一些手动工作，因此，如果您需要任何帮助，请告诉我。

# ruby-on-rails - 运行 rspec 测试时 Rails ActionView::Helpers::TextHelper 中的 ArgumentError (3 for 1)

> ID：16088039
> 
> 赞同：1
> 
> 时间：2013-04-18T16:13:01.513
> 
> 标签：ruby-on-rails, rspec, capybara, actionview, argument-error

我正在将我们的测试套件升级到 Capybara 2.1，并且在运行测试套件时遇到了最奇怪的问题。

## 使用：

*   红宝石 1.9.3p392
*   导轨 3.2.12
*   rspec 2.13.0
*   水豚 2.1.0

当我为整个套件运行测试时（使用描述性格式立即失败）：

```
rspec spec/acceptance/non-webdriver-dependent/ --fail-fast -f d 
```

抛出以下错误：

```
Failure/Error: within(".sidebar") do
 ArgumentError:
   wrong number of arguments (3 for 1) 
```

使用该`--backtrace`选项运行时，会报告以下内容：

```
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/actionpack-3.2.12/lib/action_view/helpers/text_helper.rb:51:in `concat'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/nokogiri-1.5.9/lib/nokogiri/xml/node.rb:159:in `evaluate'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/nokogiri-1.5.9/lib/nokogiri/xml/node.rb:159:in `block in xpath'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/nokogiri-1..9/lib/nokogiri/xml/node.rb:150:in `map'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/nokogiri-1.5.9/lib/nokogiri/xml/node.rb:150:in `xpath'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/nokogiri-1.5.9/lib/nokogiri/xml/node.rb:214:in `css'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/rack_test/browser.rb:85:in `find'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/rack_test/driver.rb:70:in `find_css'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/node/finders.rb:152:in `block in resolve_query'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/node/base.rb:77:in `synchronize'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/node/finders.rb:150:in `resolve_query'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/node/finders.rb:35:in `block in find'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/node/base.rb:81:in `synchronize'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/node/finders.rb:30:in `find'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/session.rb:354:in `block (2 levels) in <class:Session>'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/session.rb:221:in `within'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/capybara-2.1.0/lib/capybara/dsl.rb:51:in `block (2 levels) in <module:DSL>'
# ./spec/acceptance/non-webdriver-dependent/bronze/company_job_postings_index_sidebar_spec.rb:15:in `block (3 levels) in <top (required)>'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example.rb:114:in `instance_eval'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example.rb:114:in `block in run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example.rb:254:in `with_around_each_hooks'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example.rb:111:in `run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example_group.rb:390:in `block in run_examples'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example_group.rb:386:in `map'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example_group.rb:386:in `run_examples'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example_group.rb:371:in `run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example_group.rb:372:in `block in run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example_group.rb:372:in `map'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/example_group.rb:372:in `run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/command_line.rb:28:in `block (2 levels) in run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/command_line.rb:28:in `map'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/command_line.rb:28:in `block in run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/reporter.rb:34:in `report'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/command_line.rb:25:in `run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/runner.rb:80:in `run'
# /Users/steve/.rvm/gems/ruby-1.9.3-p392/gems/rspec-core-2.13.1/lib/rspec/core/runner.rb:17:in `block in autorun' 
```

但是，当我一次运行一项测试时，我没有任何问题。这对我来说令人难以置信，任何人对此可能有的任何见解都将受到高度赞赏！**重要的是要知道这只发生在使用默认驱动程序而不是 selenium 测试的验收测试中。此外，此错误仅在升级到 capybara 2.1.0 后发生。**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-26T20:57:39.123

我得到了同样的错误。就像有些人说的，问题是`include ActionView::Helpers::TextHelper`。就我而言，我将其包含在模型中。幸运的是，我可以将其从模型中删除，并且此错误已清除。

# c++ - 了解 C/C++ 中函数调用的堆栈框架？

> ID：16088040
> 
> 赞同：0
> 
> 时间：2013-04-18T16:13:03.900
> 
> 标签：c++, c, compiler-construction, stack

我也是 C/C++ 和汇编语言的新手。这也可能是非常基本的问题。我试图了解堆栈帧是如何构建的以及哪些变量（参数）以什么顺序被推送到堆栈？一些搜索结果表明...... C/C++ 的编译器根据函数内执行的操作来决定。例如，如果假设函数只是将传递的 int 参数的值增加 1 并返回（类似于 ++ 运算符），它将把函数的所有参数和局部变量放在寄存器中的函数中并执行加法。 ...想知道哪个寄存器用于返回/按值传递？....如何返回引用？.....b/w eax、ebx、ecx 和 edx 的区别。

请求一本书/博客/链接或任何类型的材料来理解寄存器，堆栈和堆引用在函数调用期间被使用/构建和销毁......以及如何存储主函数？提前致谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T16:18:19.730

你的问题在这里是临界的。[程序员](https://softwareengineering.stackexchange.com/)可能是一个更好的地方。

理解堆栈等概念的好书可能是 Queinnec 的[Lisp In Small Pieces](http://en.wikipedia.org/wiki/Lisp_in_Small_Pieces)（它很好地解释了 Lisp 的堆栈是什么）。此外，SICP[是](http://en.wikipedia.org/wiki/Structure_and_Interpretation_of_Computer_Programs) 一本好书[。](http://mitpress.mit.edu/sicp/)

[D.Knuth](http://en.wikipedia.org/wiki/Donald_Knuth)的书和[MMIX](http://www-cs-faculty.stanford.edu/~knuth/mmix.html)也不错。

仔细阅读 Wikipedia[调用堆栈](http://en.wikipedia.org/wiki/Call_stack)页面。

理论上，不需要调用堆栈，并且一些语言和实现（例如旧的 SML/NJ）不使用任何堆栈（而是在垃圾收集堆中分配调用帧）。请参阅 A.Appel 的旧论文[Garbage Collection Can be Faster than Stack Allocation](http://www.cs.princeton.edu/~appel/papers/45.ps)（并了解有关一般[垃圾收集](http://en.wikipedia.org/wiki/Garbage_collection_%28computer_science%29)的更多信息）。

通常 C 和 C++ 实现都有一个堆栈（并且经常使用硬件堆栈）。一些 C 局部变量可能没有任何堆栈位置（因为它们已经过优化，或者保存在寄存器中）。有时，C 局部变量的堆栈位置可能会改变（编译器会在某些情况下使用一个调用堆栈槽，而对同一局部变量的其他情况使用另一个调用堆栈槽）。当然，一些临时值可能会像您的局部变量一样编译（所以留在一个寄存器中，在一个堆栈槽中，然后在另一个堆栈槽中，等等......）。在优化编译器时，可能会用变量做一些奇怪的技巧。

^(在一些老机器[IBM/360](http://en.wikipedia.org/wiki/System/360)或 I [BM z/series](http://en.wikipedia.org/wiki/IBM_zSeries)上，没有硬件栈；C 编译器使用的堆栈是一种软件约定（例如，某些寄存器专用于该用途，没有特定的硬件支持）)

想想递归定义的函数的执行（或解释）（比如天真的*代码*）。阅读有关[递归](http://en.wikipedia.org/wiki/Recursion)（一般而言，[在计算机科学中](http://en.wikipedia.org/wiki/Recursion_%28computer_science%29)）、[原始递归函数](http://en.wikipedia.org/wiki/Primitive_recursive_function)、[lambda 演算](http://en.wikipedia.org/wiki/Lambda_calculus)、[指称语义](http://en.wikipedia.org/wiki/Denotational_semantics)、[堆栈自动机](http://en.wikipedia.org/wiki/Stack_automaton)、[寄存器分配](http://en.wikipedia.org/wiki/Register_allocation)、[尾调用](http://en.wikipedia.org/wiki/Tail_call)、[延续](http://en.wikipedia.org/wiki/Continuation)、[ABI](http://en.wikipedia.org/wiki/Application_binary_interface)、[中断](http://en.wikipedia.org/wiki/Interrupt)、[Posix 信号](http://en.wikipedia.org/wiki/Unix_signal)、[sigaltstack(2)](http://man7.org/linux/man-pages/man2/sigaltstack.2.html)、[getcontext(2)](http://man7.org/linux/man-pages/man2/getcontext.2.html)、[longjmp(3)](http://man7.org/linux/man-pages/man3/longjmp.3.html)等等……等等……

另请阅读有关[计算机体系结构](http://en.wikipedia.org/wiki/Computer_architecture)的书籍。在实践中，调用堆栈非常重要，以至于一些硬件资源（包括*堆栈指针*寄存器，通常是调用帧*基指针*寄存器，可能还有隐藏的机器，例如缓存相关）在公共处理器上专用于它。

您还可以查看 GCC 编译器使用的中间表示。然后使用`-fdump-tree-all`GCC [MELT 探针](http://gcc-melt.org/index.html#probe_id)。如果查看生成的程序集，请务必传递`-S -fverbose-asm`给您的`gcc`命令。

另请参阅[linux 程序集 howto](http://tldp.org/HOWTO/Assembly-HOWTO/)。

^(我给了很多链接。很难更好地回答，因为我不知道你的背景。)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T17:02:33.340

> 我试图了解堆栈帧是如何构建的以及哪些变量（参数）以什么顺序被推送到堆栈？

这取决于处理器的架构。但是，通常，堆栈从高地址向低地址增长（如果我们将内存地址视为数值）。一个堆栈帧是“这个函数放在堆栈上的任何东西”

放入堆栈的“东西”通常是：

*   将地址返回给调用函数。
*   一个帧指针，指向调用开始时的堆栈帧。
*   当此函数返回时，需要“保留”的已保存寄存器。
*   局部变量。
*   调用堆栈中“下一个”函数的参数。

> C/C++ 的编译器根据函数内执行的操作来决定。例如，如果假设函数只是将传递的 int 参数的值增加 1 并返回（类似于 ++ 运算符），它将把所有 ... 函数的参数和函数内的局部变量放在寄存器中并执行加法....想知道哪个寄存器用于返回/按值传递？....如何返回引用？

编译器有关于如何传递参数的规则，对于常规函数调用[即不是“内联”函数]，参数总是以相同的顺序传递，在寄存器和堆栈内存的相同组合中。如果不是这种情况，编译器在决定传递参数之前必须确切地知道函数做了什么。

不同的处理器架构有不同的规则。x86-32 通常有一个或两个用于输入参数的寄存器，并且通常有一个用于返回值的寄存器。x86-64 最多使用 5 个寄存器将前五个值传递给函数。任何进一步的参数都在寄存器中传递。

返回引用与返回任何其他值没有什么不同。值（在这种情况下是返回对象的地址）。在 x86-32 中，返回值在 EAX 中。在 x86-64 中，返回值在 RAX 中。在 ARM 中，R0 用于返回值。在 29K 中，R96 用于返回值。

# java - Arraylist 最后一个元素覆盖之前的元素

> ID：16088041
> 
> 赞同：0
> 
> 时间：2013-04-18T16:13:06.983
> 
> 标签：java, jsf, arraylist

我有一个代码允许老师添加学生并查看他们，但是每次我添加一个学生时，前一个学生也会被覆盖。

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:f="http://java.sun.com/jsf/core">

<h:body>
<h:form>
    <h1><label>Student Grades</label></h1>
    <hr />
    <h:dataTable value="#{course.studentList}" var="st" border="1" rendered="#{course.render}">
        <f:facet name="caption">#{course.courseCode} #{course.courseName}</f:facet>
        <h:column>
            <f:facet name="header">Student Name</f:facet>
            <h:outputText value="#{st.studentName}" />
        </h:column>
        <h:column>
            <f:facet name="header">Score</f:facet>
            <h:outputText value="#{st.studentScore}" />
        </h:column>
    </h:dataTable><br />
    <label>Student Name</label>
    <h:inputText id="studentName" label="Student Name" value="#{student.studentName}" required="true" requiredMessage="Please enter a student name">
    </h:inputText>
    <h:message for="studentName" /><br />
    <label>Student Score</label>
    <h:inputText id="studentScore" label="Student Score" value="#{student.studentScore}" required="true" converterMessage="You must enter a number">
    <f:validateDoubleRange minimum="0" maximum="100" />
    </h:inputText>
    <h:message for="studentScore" /><br />
    <h:commandButton value="Add Grade" action="#{course.add(student)}"/>
    <h:commandButton value="Submit" action="summary"/>
</h:form>
</h:body>
</html> 
```

下面是student.java

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean(name = "student")
@SessionScoped
public class Student {
private String studentName;
private Double studentScore;

public String getStudentName() {
    return studentName;
}

public void setStudentName(String studentName) {
    this.studentName = studentName;
}

public Double getStudentScore() {
    return studentScore;
}

public void setStudentScore(Double studentScore) {
    this.studentScore = studentScore;
}
} 
```

下面是 Course.java，它有一个学生数组列表。

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;
import javax.faces.context.FacesContext;
import java.util.ArrayList;

@ManagedBean(name = "course")
@SessionScoped
public class Course {
private String courseName;
private String courseCode;
private ArrayList<Student> studentList = new ArrayList<Student>();
private double courseAverage;
private boolean render;

public String getCourseName() {
    return courseName;
}

public void setCourseName(String courseName) {
    this.courseName = courseName;
}

public String getCourseCode() {
    return courseCode;
}

public void setCourseCode(String courseCode) {
    this.courseCode = courseCode;
}

public ArrayList<Student> getStudentList() {
    return studentList;
}

public void setStudentList(ArrayList<Student> studentList) {
    this.studentList = studentList;
}

public double getCourseAverage() {
    int i = 0;
    for (Student st : studentList) {
        courseAverage += st.getStudentScore();
        i++;
    }
    return courseAverage/i;
}

public void setCourseAverage(double average) {
    this.courseAverage = average;
}

public boolean isRender() {
    return render;
}

public void setRender(boolean render) {
    this.render = render;
}

public String add(Student student) {
    studentList.add(student);
    render = true;
    return null;
}

public String reset() {
    studentList = new ArrayList<Student>();
    courseName = "";
    courseCode= "";
    courseAverage = 0.0;
    render = false;
    FacesContext.getCurrentInstance().getExternalContext().invalidateSession();
    return "home";
}

public boolean renderable() {
    boolean render = false;
    for (Student st : studentList) {
        render = true;
    }
    return render;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:33:28.607

由于您的`Student`类被注释为`@SessionScoped` `@ManagedBean`，它将在整个用户的 HTTP 会话中创建和存储，即除非它无效或过期。因此，当您向列表添加一个值时，您基本上在任何地方都添加了一个非常相同的引用，您所做的只是修改`Student`曾经创建的对象的字段，然后它的字段被不断替换，因此，*每个*列表元素都包含一个对*同一* `Student`对象的引用也进行了修改。

`Student`您需要做的是创建一个要添加到列表中的全新对象，并为此从其中删除任何 bean 注释。

附带说明一下，在继续进行之前，请务必了解托管 bean 和模型/占位符之间的区别和用例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:42:53.090

在`Course.add`方法中添加参数的副本`student`。

原因：即使是请求范围的 bean 也可能被容器重复/重用。在任何情况下，它都更具防御性。

# symfony - Symfony2如何将img添加到error404页面

> ID：16088042
> 
> 赞同：0
> 
> 时间：2013-04-18T16:13:11.217
> 
> 标签：symfony, twig

我在 And It works 中创建了一个 404error.html.twig，`app/Resources/TwigBundle/views/Exception/error404.html.twig` 但我必须在错误页面中添加一个 img。我创建了一个 404.jpg 并放在 2 个地方。第一个 app/Resources/TwigBundle/views/images/404.jpg 和第二个`app/Resources/public/images/404.jpg` 在错误文件中我把这段代码

```
 <img src="../../../images/404.jpg" >
 <img src="../../../public/images/404.jpg" > 
```

我清除了缓存，运行assetic:dump，但img 仍然不显示

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:46:38.603

您不能将图像放在 app/Resources/public 中，就好像它是一个捆绑包一样。

您可以将其放在 /web/images 目录中并使用

```
<img src="{{ asset('images/404.jpg')}}"/> 
```

[看这里的 symfony 书](http://symfony.com/doc/current/book/templating.html#linking-to-assets)

# mysql - Mysql 只选择其他表中存在的记录

> ID：16088051
> 
> 赞同：0
> 
> 时间：2013-04-18T16:13:41.310
> 
> 标签：mysql

我有两张桌子：

```
LOGGINGTYPES
id
name

LOGFILES
id
type_id (linked to loggintypes.id)
client_ip
time
logcontent 
```

我对 MYSQL 很陌生，但我正在寻找一个查询，如果有链接到它的日志，它只从 loggingtypes 中选择 *。

使用“SELECT * FROM loggingtypes ORDER BY name”我得到了一切，我如何让它只选择链接到它的日志的行？

是

```
SELECT 
DISTINCT logging_types.id, loggingtypes.name 
FROM logging, logging_types 
WHERE logging.type_id = loggingtypes.id 
```

最好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:17:48.627

```
SELECT lt.*
FROM LOGGINGTYPES lt
INNER JOIN LOFGILES lf
ON lt.ID = lf.type_id 
```

INNER JOIN 会将您的 LOGGINGTYPES 列表限制为仅在 LOGFILES 中具有匹配项的记录

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:18:24.763

据我所知，您的查询是正确的。

一种替代方法是使用 Join：

```
select distinct 
    lt.id, lt.name
from 
    logging_types as lt
    inner join logging as l on lt.id = l.type_id 
```

# javascript - 到达“0”时停止倒计时

> ID：16088058
> 
> 赞同：3
> 
> 时间：2013-04-18T16:13:56.523
> 
> 标签：javascript

我想在计数器达到 0 时停止它，有人可以帮我吗？

```
function countdown() {
    var i = document.getElementById('counter');
    if (parseInt(i.innerHTML)<=0) {
    }
    i.innerHTML = parseInt(i.innerHTML)-1;
}
setInterval(function(){ countdown(); },1000); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:18:14.887

您使用 clearInterval 函数：

```
var id;
function countdown() {
    var i = document.getElementById('counter');
    if (parseInt(i.innerHTML)<=1) {
        clearInterval(id);
    }
    i.innerHTML = parseInt(i.innerHTML)-1;
}
id = setInterval(countdown,1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T17:53:25.807

```
<html >
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
</head>
<body>
<div id="counter">5</div>

<script type="text/javascript">
function countdown() {
    var i = document.getElementById('counter');
    i.innerHTML = parseInt(i.innerHTML)-1;
    if (parseInt(i.innerHTML)==0) {
       clearInterval(timerId);
    }
}
var timerId = setInterval(function(){ countdown(); },1000);
</script>
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:25:00.230

尝试这个

```
<div id="counter">10</div>

var i = document.getElementById('counter'),
    sId;

function countdown() {
    var count = parseInt(i.textContent, 10);

    if (count < 1) {
        clearInterval(id);
    }

    i.textContent = count - 1;
}

sId = setInterval(countdown, 1000); 
```

在[jsfiddle上](http://jsfiddle.net/Xotic750/N5eDF/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T16:28:04.383

单程;

```
function countdown() {
  var el = document.getElementById('counter');
  var value = parseInt(el.innerHTML, 10);

  var intervalId = setInterval(function() {
    el.innerHTML = --value;
    if (value === 0) {
       clearInterval(intervalId);      
    }
  }, 1000);
};

countdown(); 
```

# jquery - 在其他动画之后运行动画

> ID：16088059
> 
> 赞同：1
> 
> 时间：2013-04-18T16:13:57.407
> 
> 标签：jquery, animation, hover

有关工作示例， 请参阅[http://jsfiddle.net/BNMpC/ 。](http://jsfiddle.net/BNMpC/)

我基本上有这些在悬停时会增长和缩小的球体。我也让他们在其他球体周围“轻推”。当您一次完成一个动画并让所有动画都完成时，效果会很好。

问题是当您快速将鼠标悬停在许多上方时-“轻推”无法正常工作。我`.filter(':not(:animated)')`用来确保增长和收缩动画不会被打断，但我不确定这是否是正确的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:25:53.073

如果我的问题正确，请在回调函数中设置下一个动画

```
$(selector).animation('slow', function(){$(selector).animation();}); 
```

# android - 通过单击删除按钮使用列表视图从 SQLite 中删除数据

> ID：16088064
> 
> 赞同：0
> 
> 时间：2013-04-18T16:14:14.173
> 
> 标签：android, sqlite, android-sqlite

好的，所以我的主管希望我这样做：

*   第三个屏幕应该可以通过“查看全部”按钮访问。它应该显示所有添加的记录。然后在每个名称旁边，应该有一个删除按钮，用于从 SQLite 数据库中删除记录。

请参阅此链接以了解我在说什么，因为我不擅长用英语表达自己。

[![截屏](https://i.stack.imgur.com/Or9Qq.png)](https://i.stack.imgur.com/Or9Qq.png)

我已经找到了一种方法来显示保存在数据库中的所有数据，但是我真的不知道如何在数据旁边自动放置一个删除按钮并通过单击它来删除它。

这是我的代码：（如果您可以建议更多简单的代码，那么我会更高兴。）

```
public class CheckData extends ListActivity implements OnClickListener  {     
    TextView selection;
    public int idToModify; 
    DataManipulator dm;

    List<String[]> list = new ArrayList<String[]>();
    List<String[]> names2 =null ;
    String[] stg1;
    protected void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.check);
    dm = new DataManipulator(this);
    names2 = dm.selectAll();
    stg1=new String[names2.size()]; 
    int x=0;
    String stg;
    for (String[] name : names2) {
        stg = name[1];
        stg1[x]=stg;
        x++;
//ONCLICK
        View homeonviewall = findViewById(R.id.homeonviewall);
        homeonviewall.setOnClickListener(this);
        View newdataonviewall = findViewById(R.id.newdataonviewall);
        newdataonviewall.setOnClickListener(this);     

    }
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,android.R.layout.simple_list_item_1,stg1);
        this.setListAdapter(adapter);
    selection=(TextView)findViewById(R.id.selection);
   }      
@Override
    public void onClick(View v) {
                // TODO Auto-generated method stub
        switch(v.getId()){
            case R.id.homeonviewall:
                    Intent a = new Intent(this, Dbsample.class);  
                    startActivity(a);
                    break;
                    case R.id.newdataonviewall:
                    Intent b = new Intent(this, SaveData.class);  
                    startActivity(b);
                    break;

                        }
            }  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:26:30.503

1) 进行布局以显示名称和删除按钮。将布局传递给您当前使用的适配器，`android.R.layout.simple_list_item_1`例如

```
new ArrayAdapter<String>(this, R.layout.row_layout_delete, stg1); 
```

2）扩展您的适配器并覆盖`getView()`以将 OnClickListener 添加到您的按钮。里面`onClick()`干脆删除当前行。

我建议使用 CursorAdapter，例如[SimpleCursorAdapter](http://developer.android.com/reference/android/widget/SimpleCursorAdapter.html)，它们专门用于将数据库信息链接到 ListView。

* * *

这个答案涵盖了一个额外的主题，但我提供了有关如何扩展适配器和实现 OnClickListener 的详细信息：[如何将多个触摸操作附加到单个列表项？](https://stackoverflow.com/q/12431592/1267661)，“快速而肮脏”的答案应该对您有所帮助。您还应该观看 Google I/O 演示[Turbo-Charge Your UI](http://www.google.com/events/io/2009/sessions/TurboChargeUiAndroidFast.html)以充分利用您的适配器。

# android - FQL 查询错误：“发生未知错误。”

> ID：16088065
> 
> 赞同：2
> 
> 时间：2013-04-18T16:14:15.063
> 
> 标签：android, facebook, facebook-graph-api, facebook-fql, facebook-android-sdk

我已经开始面临 Facebook FQL 的一些问题，而我的代码没有任何更改。他们也得到了解决，没有任何改变！我收到这条烦人的消息，没有明确指出问题和可能的解决方案。

```
{
   "error": {
      "message": "An unknown error has occurred.",
      "type": "OAuthException",
      "code": 1
   }
} 
```

我一直在使用 FB-SDK for Android 并将其更改为从 url (GET) 解析内容，但问题仍然存在。我正在尝试触发这个简单的查询（在 Graph API Explorer 中有效）。

```
SELECT name,price_range,type,location,page_id FROM page WHERE page_id in (SELECT page_id,latitude,longitude FROM place WHERE distance(latitude, longitude, '-30.03852', '-51.17877') < 50000 LIMIT 20) AND (type='RESTAURANT/CAFE' OR type='LOCAL BUSINESS') 
```

使用的网址如下

```
https://graph.facebook.com/fql?q=SELECT name,price_range,type,location,page_id FROM page WHERE page_id in (SELECT page_id,latitude,longitude FROM place WHERE distance(latitude, longitude, '-30.03852', '-51.17877') < 50000 LIMIT 20) AND (type='RESTAURANT/CAFE' OR type='LOCAL BUSINESS')&access_token=ACCESS_TOKEN 
```

有什么帮助吗？？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:19:09.193

您的查询工作正常。我建议记录您的活动会话令牌并确保它在运行查询时处于打开状态。您可以使用 isOpened 方法检查会话的状态

```
activeSession.getState().isOpened() 
```

祝你好运:)

# html - 使用表单过滤搜索结果

> ID：16088068
> 
> 赞同：0
> 
> 时间：2013-04-18T16:14:24.813
> 
> 标签：html, forms

我有一个客户要求提供与此类似的页面 - [http://www.candlelighthomes.com/homedesigns.php](http://www.candlelighthomes.com/homedesigns.php) - 您可以在其中使用搜索表单过滤掉您在家庭计划中看到的结果类型。我以前从来没有做过这样的事情，老实说，我不知道从哪里开始。谁能告诉我使用什么类型的编码来做到这一点 - 它只是 javascript，还是 PHP？我试过用谷歌搜索它，但不确定如何表达我正在寻找的内容。我还查看了页面源代码，但无法完全说明是什么使它起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:28:22.307

我相信您会想研究 Ajax、PHP 和 Javascript 来解决这个问题。您可以使用 PHP 来操作和格式化您想要显示的数据（PHP 是一种服务器端脚本语言）。Ajax 用于在 javascript 和 php 脚本之间进行通信和发送数据，因此您可以使用它来获取数据。最后，编写一个 javascript 将您的数据放在网页中需要的位置。

我知道这听起来很复杂，但要做到这一点，您至少需要对 JavaScript、Ajax（使用 JQuery 搜索 Ajax）和 PHP 有基本的了解。我通过使用 W3 Schools 的示例来学习。这里有一些有用的链接可以帮助您入门。

[http://www.w3schools.com/js/default.asp](http://www.w3schools.com/js/default.asp)

[http://www.w3schools.com/jquery/jquery_ajax_intro.asp](http://www.w3schools.com/jquery/jquery_ajax_intro.asp)

[http://www.w3schools.com/php/default.asp](http://www.w3schools.com/php/default.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:23:34.820

使用 PHP 和 SQL 仅从数据库中获取符合条件的数据。

最后，您的查询应如下所示：

```
$sql = "SELECT * FROM properties WHERE price BETWEEN $minPrice AND $maxPrice"; 
```

# cordova - PhoneGap create.bat 失败

> ID：16088071
> 
> 赞同：1
> 
> 时间：2013-04-18T16:14:35.313
> 
> 标签：cordova

我正在尝试在新的 Windows 机器上设置 PhoneGap。下载和安装一切正常。在命令提示符中，我键入`java`, `adb`，`android`它们会正确响应，但是当我运行`ant`命令时，它会给我一个

`build.xml is missing`

错误。我不太确定从这里去哪里，因为我已经设置了我的 JAVA_HOME 和 ANT_HOME 变量。当我`create.bat`使用变量运行时

`<project_folder_path> <package_name> <project_name>`

它说我缺少 JDK、Android SDK 或 Apache Ant。这是使用PhoneGap 2.6 下载，eclipse，和Win7

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:01:11.703

文档没有说明这一点，但您可能需要手动安装 Apache Ant 和/或配置其他环境变量。有关说明和提示，请参阅[http://cleancodedevelopment-qualityseal.blogspot.com/2012/11/how-to-install-phonegap-for-android.html](http://cleancodedevelopment-qualityseal.blogspot.com/2012/11/how-to-install-phonegap-for-android.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:56:40.420

它说缺少 build.xml，因为您在没有 build.xml 文件的目录中运行 Ant 命令。尝试导航到`cordova-android/framework/`dir，然后键入`ant`以测试 ant 是否已安装并在您的 PATH 中正确列出。如果安装正确，它应该会打印出一堆东西。但是，这不是您应该创建 Cordova 项目的方式；相反，您应该导航到`cordova-android/bin`并键入`create ../myTestProject com.me.test TestProject`. 此外，如果您直接从 github 拉取代码，而不是使用 Phonegap 2.6 下载，那么创建脚本[会告诉您缺少什么依赖项。](https://github.com/apache/cordova-android/commit/36c33a58892f49067f4d3edf51b401b4a3c94259)

# ios - 暂时禁用 UITableView 中的删除按钮

> ID：16088073
> 
> 赞同：3
> 
> 时间：2013-04-18T16:14:39.027
> 
> 标签：ios, uitableview

我正在处理的应用程序上的删除按钮在点击时会进行服务器调用。

但是，当我们等待服务器响应时，我可以多次单击“删除”按钮，从而发出多个服务器请求。

我正在寻找解决方案，我想禁用删除按钮，直到我收到服务器的回复。这可能吗？或者有另一个优雅的解决方案吗？还是我一开始做错了什么。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T17:26:13.550

看来，当您在表格单元格中显示“删除”确认按钮，然后用户点击该按钮时，您可以在通常的`commitEditingStyle`委托方法中处理删除。

但这听起来也像是您启动了一个服务器请求，并且在它执行时，“删除”按钮仍在视图中。这意味着在服务器请求完成之前，您实际上不会删除该行。

如果是这种情况，那么你应该在你的`commitEditingStyle`方法中做的是立即重新加载被删除的行。这将删除删除按钮。然后启动服务器请求。服务器请求完成后，您将根据需要更新数据源，然后根据需要删除行或重新加载表或部分。

向单元格添加一个小活动指示器可能会很好，让用户知道正在处理该行。您可能还希望防止用户在服务器请求正在进行时再次在该行上滑动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:20:44.400

第一次点击时使用此方法：

```
[deleteButton setEnabled:NO]; 
```

然后在收到服务器响应时启用它。

# php - 如何以最短的执行时间从 PHP 将数组存储到 MySQL

> ID：16088078
> 
> 赞同：1
> 
> 时间：2013-04-18T16:15:05.490
> 
> 标签：php, mysql, arrays, store

我必须从 PHP 存储到 MySQL 中很多；通常要存储的内容我有数组。因此，我编写了一小部分帮助函数，为我节省了大量时间。

`store`这是存储`$array`到 MySQL中的主要函数`$table`：

```
function store($array, $table, $limit = 1000, $mode = '') {

    if (empty($array)) return FALSE;

    $sql_insert = "INSERT INTO `".$table."` (";

    $array_keys = array_keys($array);

    $keys = array_keys($array[$array_keys[0]]);

    foreach ($keys as $key) $sql_insert .= "`".$key."`,";

    $sql_insert = replaceEND($sql_insert, ') VALUES ', 1);

    $count = 1;

    $sql = $sql_insert;

    foreach ($array as $array_num => $row) {

        $sql .= '(';

        foreach ($row as $key => $value) {

            $string = $value;
            if (!is_null($value)) {
                $sql .= "'".str_replace("'", "\'", $string)."',";
            } else {
                $sql .= "NULL,";
            }

        }

        $sql = replaceEND($sql, '),', 1);

        $count = checkInsert($sql, $count, $limit);
        if ($count == 0) {
            if ($mode == 'PRINT') echo $sql.'<br />';
            $sql = $sql_insert;
        }
        $count++;

    }

    $last = lastInsert($sql);
    if ($last) {
        if ($mode == 'PRINT') echo $sql.'<br />';
    }

    return TRUE;

} 
```

我在这个函数中使用了以下助手 -

为语句字符串添加正确的结尾：

```
function replaceEnd($string, $replacer = ';', $number_of_chars = 1) { 
 return left($string, strlen($string) - $number_of_chars) . $replacer; 
} 
```

要检查，如果`$limit`达到这将导致语句的执行：

```
function checkInsert($sql, $sqlcount, $sql_limit) {

    if ($sqlcount >= $sql_limit) {

        $sql = replaceEND($sql);

        query($sql);

        $sqlcount = 0;

    }

    return $sqlcount;

} 
```

要在循环完成后检查最后一个插入：

```
function lastInsert($sql, $sql_insert = '') {

    if (right($sql, 1) != ';') {

        if ($sql != $sql_insert) {

            $sql = replaceEND($sql);

            query($sql);

            return TRUE;

        }

    }

    return FALSE;

} 
```

最后，执行我的语句：

```
function query($sql) {
    $result = mysql_query($sql);
    if ($result === FALSE) {
        ## Error Logging
    }
    return $result;
} 
```

基本上，这些功能没有任何问题。但是有一个问题，我无法解决：如您所见，`$limit`默认设置为 1000。这通常很好，但是当涉及到每行插入语句有很多内容/很多字符的插入语句时，我必须`$limit`手动减少以避免错误。我的问题：有没有人知道一种方法来自动检查当前插入语句是否已达到最大值以便正确执行而不会因为过早执行而浪费时间？这将同时解决两个问题： 1\. 我可以摆脱`$limit`2\. 将数组存储到 MySQL 所需的执行时间最小化。我只是没有找到任何方法来检查代表 MySQL 插入语句的字符串的最大可能长度，我可以在执行语句之前应用它......！？

# asp.net-mvc-3 - MVC 中的 JSON 日期格式问题

> ID：16088081
> 
> 赞同：0
> 
> 时间：2013-04-18T16:15:17.333
> 
> 标签：asp.net-mvc-3, knockout.js, knockout-2.0, knockout-mvc

ASP.NET-MVC 淘汰赛 MVC。屏幕应显示一个空文本框。用一个按钮。当用户单击按钮时，存储的日期应显示在文本框中。

屏幕加载时的 ATM 日期已存储在文本框“0001-01-01T00:00:00”中，但是当我按下按钮时，它变为：/Date(1366300981661)/。

任何人都知道它为什么这样做，以及如何让它只显示单击按钮时的日期。

请看下面的代码： **型号**

```
public class ClickCounterModel
    {
     public void ShowDates()
        {
            FirstDate = DateTime.Now;
        }
    } 
```

**控制器**

```
public class ClickCounterController : KnockoutController
    {
        public ActionResult ShowDates(ClickCounterModel model)
        {
            model.ShowDates();
            return Json(model);
        }
    } 
```

**看法**

```
@using PerpetuumSoft.Knockout
@model ClickCounter.Models.ClickCounterModel
@{
  var ko = Html.CreateKnockoutContext();
}

<div>Dates: @ko.Html.TextBox(m => m.FirstDate) </div>
@ko.Html.Button("Show", "ShowDates", "ClickCounter")  

@ko.Apply(Model) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:22:30.220

以 Json 格式获取结果后缺少日期格式。

**jQuery**

```
var MyDate_String_Value = "/Date(1366300981661)/";
var value = new Date
            (
                 parseInt(MyDate_String_Value.replace(/(^.*\()|([+-].*$)/g, ''))
            );
var dat = value.getMonth() + 
                         1 + 
                       "/" + 
           value.getDate() + 
                       "/" + 
       value.getFullYear(); 
```

**[点击这里查看结果 - 2013 年 4 月 18 日](http://jsfiddle.net/8zUED/)**

# jquery - jquery将数组传递给html表单

> ID：16088084
> 
> 赞同：0
> 
> 时间：2013-04-18T16:15:26.087
> 
> 标签：jquery, arrays, forms

我有一个二维数组：

如果我按如下方式“警告”输出，我会看到预期的结果：

```
alert(myArray[0][0]['test']); 
```

然后我将数组传递给 html 表单：

```
$('form#id1 #PassArray').val(myArray); 
```

然后我正在等待表单提交，如果我这样做：

```
var received=$('input#PassArray').val();

alert(received[0][0]['test']); 
```

我得到输出：未定义。

如果将数组传递给 html 表单，是否有必要以某种方式准备数组？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:21:25.120

IIRC，表单输入只能有一个字符串作为其值。

你也可以

1.  [使用$.param()](http://api.jquery.com/jQuery.param/)将数组序列化为字符串
2.  遍历您的数组以将值分配给各个表单字段。表单字段可以具有相同的名称`[]`并附加到末尾以将它们视为一个数组，即`<input name="array[]" />`
3.  只需使用 AJAX 发布数组

# c++ - 如何使用右移运算符将整数除以常数整数？

> ID：16088086
> 
> 赞同：0
> 
> 时间：2013-04-18T16:15:32.330
> 
> 标签：c++, language-agnostic, bit-manipulation, bit-shift

我对如何做到这一点很感兴趣，因为我刚刚发现您可以通过使用左移运算符轻松地进行整数乘法：

```
x * 25 = (x << 4) + (x << 3) + x 
```

其中以 2 为底的幂之和等于 25：2^4+2^3+2^0 = 25

`x / 25`右移如何解决？

编辑：我不会用这些移位运算符替换我的程序中的除法和乘法，以期提高速度；）

# python - python：如何在具有子目录的目录中跟踪新目录的创建

> ID：16088091
> 
> 赞同：0
> 
> 时间：2013-04-18T16:15:48.893
> 
> 标签：python, windows, directory

我想编写一个 python 脚本（并在后台在 windows 7 上 24/7 运行它）检查是否在 c:\Data\ 或 c:\Data 的子目录中创建了一个新目录（例如 c:\Data \1\2\3\ 或 c:\Data\1\test\2)

跟踪目录创建的最高效方式（在 Windows 7 上）是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:48:57.113

这是一个快速扫描工具，每 10 秒扫描一次更改：

```
>>> import os
>>> from time import sleep
>>> def build_dir_tree(base):
    all_dirs = []
    for root, dirs, files in os.walk(base):
        for dir_ in dirs:
            all_dirs.append(os.path.join(root, dir_))
    return all_dirs

>>> base = r'E:\CFM\IT\Dev\Python\test'
>>> old_dirs = build_dir_tree(base)
>>> while True:
    new_dirs = build_dir_tree(base)
    removed = [d for d in old_dirs if d not in new_dirs]
    added = [d for d in new_dirs if d not in old_dirs]
    print 'Added :', added, '- Removed:', removed
    old_dirs = new_dirs
    sleep(10)

Added : [] - Removed: []
Added : ['E:\\CFM\\IT\\Dev\\Python\\test\\hep'] - Removed: []
Added : [] - Removed: []
Added : ['E:\\CFM\\IT\\Dev\\Python\\test\\hop\\hap'] - Removed: []
Added : [] - Removed: ['E:\\CFM\\IT\\Dev\\Python\\test\\hep'] 
```

你只需要根据你的时间步长、时间显示等来调整它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:56:04.610

使用[pywin32](http://sourceforge.net/projects/pywin32/)连接到 windows api。然后使用其中一个[更改通知](http://msdn.microsoft.com/en-us/library/windows/desktop/aa365261%28v=vs.85%29.aspx)在更改发生时获取更改。这在 python 中会很痛苦，但它将是监视目录更改的最高效方式。请注意，这仅适用于本地文件系统，不适用于网络文件系统。

您唯一的其他选择是检查和睡觉，这充满了有趣的小惊喜和边缘情况。我最喜欢的是 windows*在写入文件内容之前写入*文件指针。如果有足够的时间，您将在文件存在之前“找到”一个文件，并且您的所有代码都会失败。而且你不能在看到它之后等待一个固定的时间，因为它可能没有写完。

数百兆文件的网络写入任何人？

# java - 对于带有 Derby db 的 Spring MVC 项目，我应该使用什么 ORM？

> ID：16088094
> 
> 赞同：1
> 
> 时间：2013-04-18T16:15:54.523
> 
> 标签：java, spring, orm, derby, ibatis

我正在开发一个使用 Spring MVC 和嵌入式 apache derby 的 Web 项目。该数据库包含一个用于用户、角色和用户角色的表。我必须做一个典型的 CRUD。由于这是我第一次使用德比。我尝试使用 java.sql.Connection、java.sql.ResultSet 等访问我的数据库。效果很好，是否需要手动连接数据库并在 java 类中编写 sql 代码？

有人推荐我使用 Spring jdbctemplate。我正在寻找像 Ibatis 这样的东西，它透明地映射对象和数据库实体。是否可以将 Spring JdbcTemplate 与 iBatis 一起使用？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:19:17.130

我推荐 Hibernate 只是因为它受到 Spring 的支持，并且 Spring 的事务管理非常好。还有大量关于 Spring with Hibernate 的文档。

Hibernate 还对 Derby 提供了强大的支持，您需要做的就是输入正确的方言。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:30:14.940

Spring 与 ORM、Hibernate 和 iBatis 都兼容。为了知道哪个最适合您，有一篇很好的文章比较了这两个框架。这是[链接](http://www.javaworld.com/javaworld/jw-07-2008/jw-07-orm-comparison.html)。其次，将 iBatis 与 Spring 集成，这里是一个[入门示例](http://www.javabeat.net/2007/11/spring-ibatis-integration/)。

# linux - 如何在 UNIX 中使用 awk 以不同方式打印来自多个文件的文本（通过 argc 中的文件名位置）？

> ID：16088098
> 
> 赞同：0
> 
> 时间：2013-04-18T16:16:05.540
> 
> 标签：linux, unix, awk

这就是我要做的：显示作为参数给出的文件的内容，如下所示：位置 1、3、5、... 上的文件将正常显示。位置 2, 4, 6, ... 上的文件以相反的顺序打印每一行的单词（最后一个单词首先显示，倒数第二个显示，等等）。

我尝试了很多方法，但我不知道如何验证文件名在 awk 参数列表中的位置。

```
if(j%2!=0){
    for(i=1;i<=NF;i++)
            print $i
       }
else
    for(i=NF;i=1;i--)
            print $i
    } 
```

这就是我可以从文件中打印行的方式。

```
BEGIN{
 for(j=1;j<ARGC;j++)
    a[j]=j
} 
```

在这里，我尝试列出一个包含参数数量的列表。

但是我如何将列表与 if 一起使用？或者我怎样才能以不同的方式做到这一点？

```
$ awk -f 2.awk 1.txt 2.txt 3.txt 
```

这是我使用的命令，其中 2.awk 是源文件。

文本文件示例：1.txt

```
1 2 3 4

a b c b 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:15:33.160

使用 ARGIND 的 GNU awk：

```
gawk '!(ARGIND%2){for (i=NF;i>1;i--) printf "%s ",$i; print $1; next} 1' file1 file2 ... 
```

与其他 awk 一起，只需通过在 FNR==1 块中增加一个变量来创建您自己的“ARGIND”，假设所有文件都不是空的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:56:28.923

好的，您可以根据需要进行按摩。这是一个 awk 可执行文件，您可以像这样运行：

```
awkex 1.txt 2.txt 3.txt 
```

可执行的 awkex 文件的内容是：

```
awk '
BEGIN {
    for( i = 1; i < ARGC; i++ )
        {
        if( i % 2 == 0 ) { even_args[ ARGV[ i ] ] = ARGV[ i ]; }
        else { odd_args[ ARGV[ i ] ] = ARGV[ i ]; }
        }
    }
{
    if( odd_args[ FILENAME ] != "" )
        {
        for( i = 1; i <= NF; i++ )
            printf( "%s ", $i );
        printf( "\n" );
        }
    else
        {
        for( j = NF; j > 0; j-- )
            printf( "%s ", $j );
        printf( "\n" );
        }
}
' $* 
```

假设每个 arg 都是一个文件名。奇数进入一张地图，偶数进入另一张地图。如果当前处理的 FILENAME 在奇数数组中，则做一件事，否则做另一件事。它还假设默认分隔符。您可以使用“awkex”文件中的 -F 标志来更改它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T19:54:56.790

这是使用 FNR 变量的最佳时机。如果 FNR==1 那么你在文件的第一行：

```
awk '
    FNR==1 {filenum++} 
    filenum%2==0 {
        # reverse the words of this line
        n = NF
        for (i=n; i>=1; i--) $(NF+1) = $i
        for (i=1; i<=n; i++) $i = $(n+i)
        NF = n
    } 
    1
' one two three four five six 
```

测试：

```
# here's the contents of my files:
$ for f in one two three four five six ; do printf "%s: %s\n" $f "$(<$f)"; done
one: words in file one
two: words in file two
three: words in file three
four: words in file four
five: words in file five
six: words in file six

$ awk '                           
    FNR==1 {filenum++} 
    filenum%2==0 {
        n = NF
        for (i=n; i>=1; i--) $(NF+1) = $i
        for (i=1; i<=n; i++) $i = $(n+i)
        NF = n
    } 
    1
' one two three four five six 
```

输出

```
words in file one
two file in words
words in file three
four file in words
words in file five
six file in words 
```

# python - 我这里的简单代码有什么问题？

> ID：16088099
> 
> 赞同：1
> 
> 时间：2013-04-18T16:16:05.600
> 
> 标签：python, python-2.7

嗨，我在编写这个简单的程序时遇到问题。我刚开始使用 Python，希望能得到一些帮助。当我在程序底部运行 start() 函数时，一切正常，直到第一个 raw_input() 之后。例如，如果用户键入“get coffee”，则打印字符串“Fair enough take a break”，但在此之后，与其像我想要的那样运行 coffee() 函数，它只是再次循环到 start() 函数.

请问有人可以帮忙吗？非常感谢。

```
def engine(next_scene):
    scenes = {"start":start(),"coffee":coffee(),"work":work()}
    return scenes[next_scene]

def start():
    print "you are in the office"
    print "you wonder what to do"
    action = raw_input("what do you do? Get coffee or work?")

    if action == "get coffee":
        print "Fair enough take a break"
        next_scene = "coffee"
        engine(next_scene)
    if action == "work":
        print "Good man, you are well on your way to being a coder"
        next_scene = "work"
        engine(next_scene)

def coffee():
    print "You walk out of the room"
    print "You head down the stairs and into the cafe"
    print "You order an espresso"
    print "You neck it down"
    print "Yumm"
    print "You are wired"
    action = raw_input("Now what? Work or go home? > ")

    if action == "work":
        print "You head back upstairs"
        next_scene = "work"
        engine(next_scene)
    if action == "go home":
        print "You lazy git"

def work():
    print "You beaver away and become a cool coder"
    next_scene = "start"
    engine(next_scene)

start() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:17:58.867

这个

```
scenes = {"start":start(),"coffee":coffee(),"work":work()} 
```

应该

```
scenes = {"start":start,"coffee":coffee,"work":work} 
```

您在字典定义中调用了函数，但您只想获取函数对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T10:05:40.907

你的引擎功能应该喜欢。

```
def engine(next_scene):
    scenes = {"start":start,"coffee":coffee,"work":work}
    scenes[next_scene]() 
```

# python - Python连接字符串和函数

> ID：16088101
> 
> 赞同：5
> 
> 时间：2013-04-18T16:16:11.303
> 
> 标签：python, string, function

Python中有没有办法对字符串和函数进行分类？

例如

```
def myFunction():
    a=(str(local_time[0]))
    return a

b="MyFunction"+myFunction 
```

我收到一个错误，无法连接“str”和“function”对象。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-18T16:21:07.340

有两种可能：

如果您正在寻找 的返回值`myfunction`，则：

```
print 'function: ' + myfunction() 
```

如果您正在寻找`myfunction`then 的名称：

```
print 'function: ' + myfunction.__name__ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T16:17:09.453

You need to call your function so that it actually returns the value you are looking for:

```
b="MyFunction"+myFunction() 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-08-30T21:17:40.450

You can use

```
var= "string" + str(function()) 
```

example

```
a="this is best"
s="number of chars. in a " + str(len(a))
print(s) 
```

# android - Zebra iMZ320 无法理解命令

> ID：16088103
> 
> 赞同：6
> 
> 时间：2013-04-18T16:16:18.150
> 
> 标签：android, zebra-printers, zpl

我正在尝试将标签从 Android 应用程序打印到 Zebra 打印机（iMZ 320），但它似乎不理解我的命令行。

当我尝试这个示例代码时，当我将所有命令发送到打印机时，打印机会将它们打印到纸上：

```
zebraPrinterConnection.write("^XA^FO50,50^ADN,36,20^FDHELLO^FS^XZ".getBytes()); 
```

我已经阅读了 Zebra 官方网站上的 ZPL 编程教程，但我无法弄清楚如何使用 ZPL 命令使我的打印机正常工作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-20T14:11:24.163

Zebra iMZ 可能以行打印模式发货。这意味着它不会解析和解释您提供的 ZPL 命令，而是打印它们。您需要将打印机配置为 ZPL 模式而不是行打印模式。以下命令应该这样做：

！U1 setvar "device.languages" "zpl"

**注意：**在某些情况下，您可能必须将语言设置为“hybrid_xml_zpl”而不仅仅是“zpl”

请注意，您需要在此命令的末尾包含一个换行符（或回车符）。您可以使用 Zebra Setup Utilities 通过其“通信”视角直接向打印机发送命令，点击主屏幕上的“通信”按钮即可使用。

Zebra 设置实用程序：[http ://www.zebra.com/us/en/products-services/software/manage-software/zebra-setup-utility.html](http://www.zebra.com/us/en/products-services/software/manage-software/zebra-setup-utility.html)

ZPL 手册第 705 页（详细命令，例如上面列出的命令）： https: [//support.zebra.com/cpws/docs/zpl/zpl_manual.pdf](https://support.zebra.com/cpws/docs/zpl/zpl_manual.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:43:53.673

如果您想打印简单的文本，您可以通过 BT 插座将正常的“原始”数据发送到 Zebra 打印机，它会打印出来！您不需要使用 Zebra 打印库。

只需在异步任务中运行此代码即可打印两行纯文本：

```
protected Object doInBackground(Object... params) {
    //bt address
    String bt_printer = "00:22:58:31:85:68";
    String print_this = "Hello Zebra!\rThis is second line";
    //vars
    BluetoothSocket socket = null;
    BufferedReader in = null;
    BufferedWriter out = null;
    //device from address
    BluetoothDevice hxm = BluetoothAdapter.getDefaultAdapter().getRemoteDevice(bt_printer);
    UUID applicationUUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB");
    try {
        //create & connect to BT socket
        socket = hxm.createRfcommSocketToServiceRecord(applicationUUID);
        socket.connect();
        in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
        out = new BufferedWriter(new OutputStreamWriter(socket.getOutputStream()));
        out.write(print_this);
        out.flush();
        //some waiting
        Thread.sleep(3000);
        //in - nothing, just wait to close connection
        in.ready();
        in.skip(0);
        //close all
        in.close();
        socket.close();
        out.close();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InterruptedException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }       
    return null;
} 
```

# jquery - 页面加载后自动执行 .on() 函数

> ID：16088106
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:16:26.230
> 
> 标签：jquery

我曾经`$("#container").on("click", contentEffects);`在 ajax 调用后让一些 jquery 代码再次工作。但是，我希望该`.on()`功能可以在页面加载后立即自动执行，并且没有`click`事件。那可能吗？

请查看我的网站和 javascript 文件：

[http://peters-playground.com/blog.html](http://peters-playground.com/blog.html)

[https://github.com/P233/p233.github.com/blob/master/js/script.js#L30-L78](https://github.com/P233/p233.github.com/blob/master/js/script.js#L30-L78)

当 ajax 加载新帖子时，我必须单击帖子内容以启用 javascript，并且我还需要单击两次按钮才能使其工作。这真的很烦人。我怎样才能避免这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T16:17:40.180

你可以在你的链中运行它：

```
// Anonymouse function passed into $ will be invoked
// When the document has loaded
$(function () {

    // Immediately after binding the click handler
    // We invoke the click event on #container
    $("#container").on("click", contentEffects).click();

}); 
```

听起来您应该考虑的是*event-delegation*，并将事件绑定到页面加载时出现的最近的静态祖先元素。例如，假设我们有一个由 AJAX 动态填充的项目列表：

```
<ul id="items">
    <li>First item on load.</li>
    <!-- More items will be loaded
         via AJAX later on --->
</ul> 
```

您可能希望列表项在单击它们时执行某些操作，因此您可能会将处理程序绑定到它们的单击事件：

```
$("#items li").on("click", function () {
    alert( $(this).html() );
}); 
```

这适用于*页面上已经*存在的任何列表项，但正如您所体验的那样，新项目不会与它们绑定，因此在您的 AJAX 之后，您将不得不将其重新绑定到所有新列表项。

我们可以不这样做，而是绑定到`ul`始终存在的元素，并简单地监听源自`li`元素的事件：

```
$("#items").on("click", "li", function () {
    alert( $(this).html() );
}); 
```

现在我们的事件永远不需要重新绑定，因为`#items`它是与页面一起加载的，并且永远不会去任何地方。任何从嵌套列表项冒泡到此元素的单击事件（无论它是否通过 AJAX 加载）都将被捕获和处理。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:27:54.820

使用此代码在页面加载后执行 .on 函数。

```
$(document).ready(function() {
         $("#container").on("click", function() {
         //Your Code
         });
}); 
```

# entity-framework - 实体框架多对多关系，具有相同的链接实体

> ID：16088107
> 
> 赞同：0
> 
> 时间：2013-04-18T16:16:35.710
> 
> 标签：entity-framework

我试图从一个包含多个实体之间的多对多关系数据的类中获得一些重用。

您可以很容易地做到这一点，其中关系只是使用 Map 的两个实体的 pk

```
class A{
   icollection<Item> Items
}    

class B{
   icollection<Item> Items
}

class Item{
   string Text
} 
```

然后在配置中你做这样的事情

```
Entity<A>().HasMany(e=>e.Items).WithMany().Map(..);
Entity<B>().HasMany(e=>e.Items).WithMany().Map(..); 
```

这将为 A 和 B 生成一个新的链接表

现在，我想在链接表上存储更多信息，但这很常见

```
class A{
   icollection<LinkItem> Items
}    

class B{
   icollection<LinkItem> Items
}

class LinkItem{
   int ExtraInfo
   Item Text
}

class Item{
   string Text
} 
```

这失败了，因为 LinkItem 是在单个表中创建的并且抱怨关系

“‘DataContext.LinkItem’中的实体参与‘A_Items’关系。找到了0个相关的‘A_Items_Source’。预计有1个‘A_Items_Keywords_Source’。”

您可以在 Map 方法中指定一个表，m.ToTable("AItems")，但这也失败了

“在模型中找不到指定的表'AItems'。确保已正确指定表名。”

我可以以某种方式重用我的 LinkItem 类吗？

（它不需要从 DataContext 中作为一个集合访问）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T09:05:17.703

我相信您想要的可以完成，我刚刚尝试使用 EF5，使用以下模型。

```
public class UsersContext : DbContext
{
    public DbSet<A> As { get; set; }
    public DbSet<B> Bs { get; set; }
    public DbSet<LinkItem> LinkItems { get; set; }
    public DbSet<Item> Items { get; set; }
}

public class A{
    public virtual int Id { get; set; }
    public virtual ICollection<LinkItem> Items { get; set; }
}    

public class B{
    public virtual int Id { get; set; }
    public virtual ICollection<LinkItem> Items { get; set; }
}

public class LinkItem{
    public virtual int Id { get; set; }
    public virtual DateTime ExtraInfo { get; set; }
    public virtual Item Text { get; set; }
}

public class Item{
    public virtual int Id { get; set; }
    public virtual string Text { get; set; }
} 
```

这导致了以下数据库模型

![在此处输入图像描述](https://i.stack.imgur.com/51xkr.png)

我没有添加任何自定义映射，只是使用了模型推断的内容。那对你有用吗？

如果您想避免 LinkItems 表上外键的扩散，您可以使用以下命令将其与实体 A 和 B 建立多对多关系，`DbModelBuilder`这将添加隐式链接表。

```
protected override void OnModelCreating(DbModelBuilder modelBuilder)
{
    modelBuilder.Entity<A>()
                .HasMany(t => t.Items)
                .WithMany();
    modelBuilder.Entity<B>()
                .HasMany(t => t.Items)
                .WithMany();
} 
```

# php - 使用 [0] 访问函数返回值时出现 PHP 语法错误

> ID：16088109
> 
> 赞同：0
> 
> 时间：2013-04-18T16:16:39.433
> 
> 标签：php

最初这段代码在我的个人开发服务器上工作：

```
$id = str_split(md5(mt_rand()), 16)[0]; 
```

但是在另一台服务器上，（Apache和PHP版本相同，不知道远程的php.ini长什么样子），代码抛出了这个错误：

```
Parse error: syntax error, unexpected '[' ... 
```

我通过将代码更改为：

```
$id = str_split(md5(mt_rand()), 16);
$id = $id[0]; 
```

后来又改回原来的代码，试图找出问题所在——但原来的代码有效！为什么第一行代码会抛出语法错误？我曾尝试寻找解释，但我不知道如何称呼这类问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T16:18:35.333

直到 PHP 5.4 才添加使用这样的直接数组取消引用。

您将必须分配给一个临时变量：

```
$arr = your_function();
$value = $arr[0]; 
```

请参阅此处的示例 #7：http: [//php.net/manual/en/language.types.array.php](http://php.net/manual/en/language.types.array.php)

# java - 如何在 JPA 2.0 中自动检测实体

> ID：16088112
> 
> 赞同：11
> 
> 时间：2013-04-18T16:16:45.643
> 
> 标签：java, spring, jakarta-ee, jpa

我很确定我过去在 JPA 2.0 中使用了某种自动检测带有 @Entity 注释的 bean，但我不知道如何。您如何做到这一点，而不是`class`在persistence.xml 的XML 元素中列出每个bean？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-04-18T16:21:21.700

您需要添加到`persistence.xml`下一行：

```
<exclude-unlisted-classes>false</exclude-unlisted-classes> 
```

例如

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence version="2.0" ...>
    <persistence-unit name="YourPU" ...>
        <exclude-unlisted-classes>false</exclude-unlisted-classes>
        <properties>
            <property name="eclipselink.logging.level" value="ALL"/>
            <property name="eclipselink.ddl-generation" 
                value="drop-and-create-tables"/>
        </properties>
    </persistence-unit>
</persistence> 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-18T16:26:36.707

从 Spring 3.1 开始，您还可以选择完全[忘记 persistence.xml](http://docs.spring.io/spring/docs/3.1.x/spring-framework-reference/html/new-in-3.1.html#new-in-3.1-jpa-without-xml)，并配置您的`EntityManagerFactory`using`packagesToScan`属性，类似于：

```
<bean id="entityManagerFactory" 
      class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean"
      p:dataSource-ref="dataSource"
      p:packagesToScan="${jpa.entity.packages}">

    <property name="jpaVendorAdapter">
        <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter"
              p:showSql="${hibernate.show_sql}"/>
    </property>

    <property name="jpaProperties">
        <props>
            <prop key="hibernate.format_sql">${hibernate.format_sql}</prop>
            <prop key="hibernate.hbm2ddl.auto">${hibernate.hbm2ddl.auto}</prop>
        </props>
    </property>
</bean> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T06:56:00.347

请参阅此处的 Pascal Thivent 答案：[我需要 <class> 元素在 persistence.xml 中吗？](https://stackoverflow.com/questions/1780341/do-i-need-class-elements-in-persistence-xml)

你有不同的方法来做到这一点，但 JPA 本身不支持自动扫描。引用实体恕我直言的最简单和最干净的方法是将模型打包在 jar 中并使用`<jar-file>MyModel.jar</jar-file>`

# actionscript-3 - 使用变量的内容作为标识符将数据分配给共享对象

> ID：16088115
> 
> 赞同：0
> 
> 时间：2013-04-18T16:16:52.177
> 
> 标签：actionscript-3, dynamic, shared-objects

在过去的几天里，我一直在思考这个问题，虽然我可以找到其他人遇到过与使用动态变量名有关的问题，但没有一个解决方案对我想要做的事情很有效。

我一直在使用共享对象（为此目的名称 sfSaveData）来创建本地保存文件。这个相同的系统已经在多个项目中使用得非常愉快，但是代码并不过分移植。也就是说，对于每个项目，我必须完全更改类文件以合并每个要存储的设置/数据。所以我有这个脑电波——而不是手动更改创建/更新本地保存文件的类，我将把必要的更改放在一个 XML 文件中，并有一个循环通过 XML 并在共享对象中创建必要数据的类.

我已经弄清楚了 XML 方面的问题，我的问题是让结果正确引用共享对象。这是我所拥有的正常工作的：

为了完整起见，这是从 XML 文件中提取的，目前为了使其正常工作，我只使用文件中的这一条目（在工作之前添加更多数据没有意义）

```
<dataField label = "dataField">
    <dataTitle label = "dataTitle">locationArray</dataTitle>
    <dataType label = "dataType">Array</dataLabel>
    <dataContent label = "dataContent">[true, true, true, true, true]</dataContent>
</dataField> 
```

注意：DataPass 是一个自定义事件，它允许通过事件传递数据。在本例中，它传递一个包含 XML 内容的变量。数据可通过变量 event.datPass 访问。这是正确传输。

这是在一个类文件 (SaveDataHandler) 中，包含共享对象的文件是 InGameSettings。SaveDataHandler 被创建为一个实例。InGameSettings 是一个由公共静态变量（包括 sfSaveData:SharedObject）填充的公共类。值得一提的是，文件夹结构是 /data/SaveDataHandler 和 /setting/InGameSettings。

```
function processSaveXML(event:DataPass):void {
    var outputString;
    for each (var dataField.XML in event.datPass) {
        outputString = (InGameSettings.sfSaveData.data." + dataField.dataTitle);
        /*
        * This is where it all goes wrong ;)
        * To access outputString's content as the variable name, I use "this".
        * I realise that this causes outputString to relate to the SaveDataHandler
        * class rather than the InGameSettings class - which is part of the problem
        */
        this[outputString] = dataField.dataContent;
        InGameSettings.sfSaveData.flush();
    } // for each loop
}  // function processSaveXML 
```

现在，如果我手动输入其中一个变量名称 - 例如

```
InGameSettings.sfSaveData.LocationArray = dataField.dataContent 
```

代替

```
this[outputString] = dataField.dataContent 
```

它工作正常。我的问题是我不知道如何获取 outputString 的内容以用作不同类上变量的标识符。我得到的是错误消息：

> ReferenceError：错误 #1056：无法在 data.SaveDataHandler 上创建属性 InGameSettings.sfSaveData.data.locationArray。

所以，如果你能指出我正确的方向，我将不胜感激。因为这个原因，我这周掉了很多头发，但我真的很想让这个工作来整理我的代码中的一个讨厌的 hack，所有这些都被硬编码到 SaveDataHandler 类中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:40:40.207

```
function processSaveXML(event:DataPass):void {
var outputString;
for each (var dataField.XML in event.datPass) {
    outputString = dataField.dataTitle;

    InGameSettings.sfSaveData.data[outputString] = dataField.dataContent;
    // the trick is here. You need to refer "data" of the SO, and then add
    // what's in brackets to make a dynamic property.
    InGameSettings.sfSaveData.flush();
} // for each loop
}  // function processSaveXML 
```

# c# - linq：ToDictionary 是否减少了返回的列数？

> ID：16088121
> 
> 赞同：4
> 
> 时间：2013-04-18T16:17:00.793
> 
> 标签：c#, linq

我有一个简单的`Linq`查询：

```
var dict = (from i in Customers select i).ToDictionary(i => i.Id1, i => i.Id2); 
```

尽管查询说，是否`Linq2sql`知道将选择减少到两个字段 ( ) ？`Id1, Id2``select i`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T16:20:06.610

不。[`Queryable`](http://msdn.microsoft.com/en-gb/library/system.linq.queryable.aspx)像 LINQ to SQL 这样的东西所依赖的类不包含声明`ToDictionary`（并且没有其他类具有合适的扩展方法），因此它最终使用实现[`Enumerable`](http://msdn.microsoft.com/en-gb/library/system.linq.enumerable.aspx)- 即 LINQ to Objects。这使用了一个普通的委托而不是一个表达式树，所以它真的没有明智的方法*可以*计算出需要什么。

为了使查询更有效，请使用匿名类型来捕获您在`Select`部件中需要的所有内容：

```
var dict = db.Customers
             // Here i is a full Customer, logically...
             .Select(i => new { i.Id1, i.Id2 })
             // But here p is just the pair of Id1, Id2
             .ToDictionary(p => p.Id1, p => p.Id2); 
```

另一种选择是自己作为扩展方法执行此操作 - 应该可以编写`ToDictionary`采用两个表达式树（以及到目前为止的查询）的重载，并将它们组合成一个新的表达式树以创建一个键/值对，然后将其传递给`Select`，然后调用正常`ToDictionary`。如果你只做一次，这可能不值得麻烦，但如果你在多个地方做这件事，它可能会很有用。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-18T16:21:16.990

没有 LINQToSQL 无法知道为您削减`Select`。您需要使用匿名类型。见下文。

```
var dict = (from customer in Customers select new { customer.Id1, customer.Id2 })
           .ToDictionary(d => d.Id1, d => d.Id2); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-18T16:19:47.373

据我所知，它没有。它将评估您的查询并检索表上的**所有**字段`Customers`。

你可以重写它，所以它做到了：

```
var dict = (
    from i in Customers
    select new
    {
        i.Id1,
        i.Id2
    })
    .ToDictionary(i => i.Id1, i => i.Id2); 
```

# html - what is the best practices for the markup structure for a pagination?

> ID：16088131
> 
> 赞同：0
> 
> 时间：2013-04-18T16:17:18.780
> 
> 标签：html

What should be the best precise markup for a pagination structure? should be tables?, div or span?, simple links or other?

**NAV STYLE**

```
<nav>
  <a href="#1">1</a>
  <a href="#1">2</a>
  <a href="#1">3</a>
</nav> 
```

**LIST STYLE**

```
<ul>
  <li>1</li>
  <li>2</li>
  <li>3</li>
</ul> 
```

**TABLE STYLE or other?**

```
<table>
   <tr>
     <td>1</td>
     <td>2</td>
     <td>3</td>
   </tr>
</table> 
```

I think now we have html5 should be `<nav>` plus `<a>` but I'm not sure...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:21:53.430

我用：

```
<nav>
    <ul>
        <li>
            ...
        </li>
    </ul>
</nav> 
```

它具有语义意义，并​​且很容易设置样式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:24:39.150

为了语义上的好处，`nav`用作外部标签。链接应该是`a`标签，但它们不需要是`nav`. 您可以使用列表、表格或普通链接；只要`a`在`nav`.

# ruby - Ruby 字符串拆分

> ID：16088137
> 
> 赞同：2
> 
> 时间：2013-04-18T16:17:44.977
> 
> 标签：ruby, string, split, x509

我有一个长字符串如下：

```
 MIIEpAIBAAKCAQEAyUe3zAACNX50XRvh6CsL05yjyXZRpMKFqlKFN4QfrbbkGoGfY7NlfnicccHg1Kux8+BI5TxoOVF28Qa7DRiZRz6HnYRxvMJkKLhkcZMGhApefSS3Swk2kNw6bzVqMo20fidIb/FuDzRSn0E9UIXlOWFCFOdFFs3h4bhKkEagkW8swSo6dwJHoEzECxtn3U7Z6qnYbBJzxfY2H0O8CerdHHisIrjj9bofvYx4dRKUq98X16YPWIgutxJFiJN5XrWJ1IpYbaBCSxfdVQUe06C/CS47hGUXhO2GuWynW9u08yZRPHO+cbSE8W5/cq3vZrYBOX/LAdRKMJP76BX0nxV/3wIDAQABAoIBAQC7wFZFyExHMenBYFzdgCnL/nUZW3DUy057jfYNzwTtuYgU4YyYJ6Mo0cC8rCjYuD+KSVA15J8juEXGloysrqFrv3wpBn5BoOJkyXuIJakSScnR2gnPyIxJm+Q2EBE7jssqUeJT6VTMgfX/748OKZekaoCFlyTvHKTzNED5S6hDf1SlUhstGYbNYH6PhbID+ssdjQRt7Ys1s3EFLAxJIJeAeLTPi4dJVrBjBVShhl9BTzRRQH3sik7bdDHEq7PU6/Y63ZEPc7z6pdEb+sx8C4DKtRpRiUae1EooH7Ifk1DdF97wjOzA3VGeQFspy1ipmS1Xp+668Z0vrs6yFEUWLtUhAoGBAO8YMJuYyO59Dh/c+Y/5g+bSgQr2GZ5cFLlTFQ4+v3VPbe4Zezd5L0/vse/1qKEILwwHxRC5t3KSIysEYLmHLwskGBofH7mDAw0wcOttXGTAWiqzMWKae8CNCX8jNw9A3bq7j+e0Im+Bee0nXjhMFcOqiEO+yjAsvhUCWI0F+vmdAoGBANeDDo6KHboPu69i5UiH5TfnkLLQoovdXYgEmBFawJnMEc5EM6UhG+YGadHR7oNT5OM5K4WK3Uif3vNqspaQ0mD6gG514SZyATuKWy3+bgqgPfV8YOHsoGdc8I58qVXpUrSE07PXaH+N7kRtn3i0NHATLKJ4OKaucNolf0NoCpSrAoGALWupAEYcFcJIBqGR/1nlRtpCjXSHFWBkx3gTDeu5r21xcsQAdl9dL5BXe0Bt0nmdhmmLdEvzn55HdAqW3Wfi9fjbY0r6WeGbmMvVB8R0wucPugDkpti2HbQtU6u67/jgpnKvOdMsn4Y3RWgvK/64O72PuV7rRg+Z5J/XdqLmNLkCgYAGqmQJ3pW6yn/Ilet3idR6HSxpi3BrmQYqjdHSP5dTam9mjM94HQUK4UnmlnKlFzQuHveMotXjSCaSKsupQoNvQnA0emrjUIVfPRFC4+qtY3VnIVixxCrV55b9ITfvk07ejHkrx87Qmygyb52OEyzIBp/LyqId7alJ5f0ArbgeDwKBgQDDONXscChQQLPAFO9xLVLTU2JSCWcJAt4Dh8xhfDkGtYg+AcRb75+pVGW7jpg3311N8suuF2Eq3RWoCdvzUHD+TLUNMQrw7IfpKhtL1Po6KA/+G6xwh00ZkXL5o6AbmQ/fZW6/Yk5yx5PRxuwhLYCn6zVGJnENWmzkhVtawtHHFw== 
```

我需要将其解连接/拆分回一个看起来像这样的块。即，将其恢复为正确的格式以用作 X509 证书。

```
-----BEGIN CERTIFICATE-----
MIIGNTCCBR2gAwIBAgIKYWYgXQABAAACazANBgkqhkiG9w0BAQUFADBDMRMwEQYK
CZImiZPyLGQBGRYDY29tMRcwFQYKCZImiZPyLGQBGRYHY2puZGVtbzETMBEGA1UE
AxMKY2puZGVtby1DQTAeFw0xMzA0MTIxNjM4MTVaFw0xNDAzMDgxMjM0NDhaMHwx
CzAJBgNVBAYTAkdCMRIwEAYDVQQIEwlCZXJrc2hpcmUxEDAOBgNVBAcTB1NFIFRl
YW0xDzANBgNVBAoTBlZlbmFmaTERMA8GA1UEAxMIbmV3Y2VydDQxIzAhBgkqhkiG
9w0BCQEWFGphc29uLmJvdXJuZUB2ZWQuY29tMIIBIjANBgkqhkiG9w0BAQEFAAOC
AQ8AMIIBCgKCAQEAv+ILegq1B81jOosGpySK+FO4+WQXJk4dyGWbC/MRw5JU2ShQ
Mjkpab8FDBgpZUmG6mvwrOBY8eK1NHvcognIPuHiQNm/c0YSqz/U8xTmBS0JRLd5
fDSkuhD5T7GKNa62Wg7dIPh3HtiKRTdC9HIBP3p/BFHz+jetgd8yM72Uzp0Lchpu
NJJDA5m0pgjbTOTlQ70tOq28kW8Hsko9p6cTQsVBOjxu7S6xSBq/g35NpgVZ3kic
jLEPAkdxAKWNORLOI3wD+AMiTp0DoV2fIw9do5a2XdbLy1QlTkRkXO+vM3LHCfAb
JfLZjrp11yP+wCz3NIJIi9lBDnYLo+6U2UOsZwIDAQABo4IC8DCCAuwwDgYDVR0P
AQH/BAQDAgWgMCkGA1UdJQQiMCAGCCsGAQUFBwMCBggrBgEFBQcDBAYKKwYBBAGC
NwoDBDAfBgNVHREEGDAWgRRqYXNvbi5ib3VybmVAdmVkLmNvbTAdBgNVHQ4EFgQU
SQCNiZ1456n8I0fi65oMWB8+MxEwHwYDVR0jBBgwFoAUmoUm8wJiYz+n+ZtdEoCU
i9XvXVgwgdMGA1UdHwSByzCByDCBxaCBwqCBv4aBvGxkYXA6Ly8vQ049Y2puZGVt   
by1DQSgxKSxDTj1XSU4tM0NGNDFOQlBUODUsQ049Q0RQLENOPVB1YmxpYyUyMEtl
eSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZpZ3VyYXRpb24sREM9Y2pu
-----BEGIN CERTIFICATE----- 
```

在 Ruby 中是否有内置方法，或者是否有简单的方法来做到这一点？

最好的祝福

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T16:29:27.750

这将为您提供一个数组：

```
my_long_string.scan(/.{64}/) 
```

如果你想用换行符把它放回去：

```
my_long_string.scan(/.{64}/).join("\n") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T18:49:42.530

您可以使用 Ruby 的[`Base64`](http://www.ruby-doc.org/stdlib/libdoc/base64/rdoc/Base64.html)模块对字符串进行重新编码。该模块将考虑正确的填充：

```
require "base64"

str = "MIIEpAIBAAKCAQEAyUe3zAACNX50XRvh6CsL05yjyXZRpMKFqlKFN4QfrbbkGoGfY7Nlf..."
b64 = Base64.encode64(Base64.decode64(str))
pem = "-----BEGIN CERTIFICATE-----\n" << b64 << "-----END CERTIFICATE-----\n"

puts pem
# -----BEGIN CERTIFICATE-----
# MIIEpAIBAAKCAQEAyUe3zAACNX50XRvh6CsL05yjyXZRpMKFqlKFN4Qfrbbk
# GoGfY7NlfnicccHg1Kux8+BI5TxoOVF28Qa7DRiZRz6HnYRxvMJkKLhkcZMG
# hApefSS3Swk2kNw6bzVqMo20fidIb/FuDzRSn0E9UIXlOWFCFOdFFs3h4bhK
# ...
# U2JSCWcJAt4Dh8xhfDkGtYg+AcRb75+pVGW7jpg3311N8suuF2Eq3RWoCdvz
# UHD+TLUNMQrw7IfpKhtL1Po6KA/+G6xwh00ZkXL5o6AbmQ/fZW6/Yk5yx5PR
# xuwhLYCn6zVGJnENWmzkhVtawtHHFw==
# -----END CERTIFICATE----- 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:29:16.587

您可以将它们每 64 个字符拆分一次，例如：

```
a = "MIIGNTCCBR2gAwIBAgIKYWYgXQABAAACazANBgkqhkiG9w0BAQUFADBDMRMwEQYKCZImiZPyLGQBGRYDY29tMRcwFQYKCZImiZPyLGQBGRYHY2puZGVtbzETMBEGA1UE"
p a.scan(/.{1,64}/) 
```

输出：

```
["MIIGNTCCBR2gAwIBAgIKYWYgXQABAAACazANBgkqhkiG9w0BAQUFADBDMRMwEQYK", "CZImiZPyLGQBGRYDY29tMRcwFQYKCZImiZPyLGQBGRYHY2puZGVtbzETMBEGA1UE"] 
```

然后`join`他们换行`\n`：

```
print a.scan(/.{1,64}/).join("\n") 
```

输出：

```
MIIGNTCCBR2gAwIBAgIKYWYgXQABAAACazANBgkqhkiG9w0BAQUFADBDMRMwEQYK
CZImiZPyLGQBGRYDY29tMRcwFQYKCZImiZPyLGQBGRYHY2puZGVtbzETMBEGA1UE 
```

# regex - 匹配 [g]awk 中的数字

> ID：16088141
> 
> 赞同：2
> 
> 时间：2013-04-18T16:17:55.837
> 
> 标签：regex, awk, posix-ere

我难住了！试图编写一个 awk 正则表达式来匹配一个字符串与 11 位数字。

我试过了：

```
if (var ~ /^[0-9]{11}$/ )
if (var ~ /^([0-9]){11}$/ )
if (var ~ /^([0-9]{11})$/ )
if (var ~ /^[0-9]{11}/ ) # altho I really do need to check the whole str
if (var ~ /[0-9]{11}/ ) 
```

如果我用这个......

```
if (var ~ /^[0-9]+/ ) 
```

然后我得到一个匹配 - 但我需要检查 11 位数字。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T17:27:23.547

You described your problem, but didn't tell us your awk version. It is an important information.

but this may work for your case:

```
if (var ~ /^[0-9]+$/ && length(var)==11) 
```

If we know the version, there could be simpler solution.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:31:38.533

如果您试图匹配字符串中某处的*11*个*连续数字：*

使用测试文件：

```
hi12345678910
hi1234 
```

windows版awk命令行：

```
awk --posix "{ if ($1 ~ /[0-9]{11}/) print}" testfile.txt 
```

它打印：

```
hi12345678910 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:30:12.947

Doh - 忘记了 RTM：

```
 Interval expressions are only available if either --posix or
              --re-interval is specified on the command line. 
```

# css - 如何在 SCSS 中找到所有硬编码的颜色？

> ID：16088144
> 
> 赞同：0
> 
> 时间：2013-04-18T16:17:58.907
> 
> 标签：css, colors, sass, color-scheme

我正在将丑陋的遗留 CSS 转换为 SCSS（请参阅[SASS](http://sass-lang.com/)。）

我想利用它对变量的支持并创建一个文件来管理我的整个配色方案，就像 Twitter 的 Bootstrap 一样（请参阅[Bootstrap 的 SCSS 版本的变量文件](https://github.com/jlong/sass-twitter-bootstrap/blob/master/lib/_variables.scss)）。

在旧的 CSS（数十个文件）中，颜色以不一致的方式编写，例如：

*   `#fff`
*   `#FFF`
*   `#FFFFFF`
*   `white`

并且有*很多*颜色。

你能想出一种方法（最好是自动化和简单的）来帮助识别（甚至可能替换）所有这些硬编码值与我的适当变量，看起来像`$colorGrayDark`？

# php - 连接关闭后的 PHP 重定向、Iptables 和数据

> ID：16088148
> 
> 赞同：1
> 
> 时间：2013-04-18T16:18:04.543
> 
> 标签：php, redirect, curl, http-headers, iptables

这是一个奇怪的问题。我们最近在我们的代码中发现了一个 3 个月大的错误，我们在 print_r 之后发布了一个 302 重定向标头。结果，浏览器将接收到字符串，而不是重定向到下一页。

这个 print_r 已经投入生产了很长时间，没有人提到它，这让我们相信这是生产和开发上的配置差异。最新的更改是对 IPtables 的更改，当我们恢复更改时，它似乎解决了问题。

奇怪的是，我们不能为了我们自己的启迪而重现这个问题。这让我想到了一个问题，IPtables 甚至可以影响 302 重定向吗？更不用说，关心数据是否在标头之前发送？根据我的研究，没有，但我想先 ping 无所不知的人。

几天前更改 IPtables 的人（我们恢复并以某种方式解决了问题）说这些是有问题的条目：

```
ACCEPT all -- 0.0.0.0/0 0.0.0.0/0 
ACCEPT all -- 0.0.0.0/0 0.0.0.0/0 state RELATED,ESTABLISHED 
```

第一个条目是什么，第二个条目是他将其更改为破坏站点的内容。恢复到第一个条目“已修复”。首先，我知道，超级安全……这是一个本地开发盒。

我尝试卷曲 url（现在可以正常工作，因为我们无法破坏它）以查看我能看到的内容，并且我注意到了这个问题的第二部分。curl 在 print_r 进入之前注册`* Closing connection #0`，当它进入时，它会在我的提示下进入：

```
< HTTP/1.1 302 Found
< Date: Thu, 18 Apr 2013 16:14:55 GMT
< Server: Apache/2.2.3 (Red Hat)
< X-Powered-By: PHP/5.3.3
< location: app.php?cart_item_id=1234567
< X-UA-Compatible: IE=Edge
< Content-Length: 17
< Connection: close
< Content-Type: text/html; charset=UTF-8
<
* Closing connection #0
<pre>before</pre>[user@localhost ~]$ 
```

是的。有什么想法吗？我的意思是，现在一切都很好，我只是想知道为什么...

Bass：好的，但是当我 curl 时，yahoo.com 我得到了这个：

```
[user@localhost~]$ curl yahoo.com -v
* About to connect() to yahoo.com port 80 (#0)
*   Trying 206.190.36.45...
* connected
* Connected to yahoo.com (206.190.36.45) port 80 (#0)
> GET / HTTP/1.1
> User-Agent: curl/7.24.0 (x86_64-redhat-linux-gnu) libcurl/7.24.0 NSS/3.13.5.0 zlib/1.2.5 libidn/1.18 libssh2/1.2.2
> Host: yahoo.com
> Accept: */*
>
< HTTP/1.1 301 Redirect
< Date: Fri, 19 Apr 2013 13:28:10 GMT
< Connection: close
< Server: YTS/1.20.13
< Cache-Control: no-store
< Content-Type: text/html
< Content-Language: en
< Location: http://www.yahoo.com/
< Content-Length: 211
<
<HEAD><TITLE>Redirect</TITLE></HEAD>
<BODY BGCOLOR="white" FGCOLOR="black">
<FONT FACE="Helvetica,Arial"><B>
 "<em>http://www.yahoo.com/</em>".<p></B></FONT>

<!-- default "Redirect" response (301) -->
</BODY>
* Closing connection #0
[user@localhost~]$ 
```

我得到了`* Closing connection #0`毕竟内容。有什么区别？

至于 iptables 规则，在该规则之后还有其他允许，端口 80 等。所以我猜……呃……嗯，我不知道……

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T05:25:58.433

正如巴斯所说，标题将在 print_r 之前发送。而且，iptables 不会做“深度包检测”，所以它看不到你的消息内容。

两行的区别在于，**第一行允许**从任何 ip 到任何 ip 的所有数据包，**第二行仅允许已建立连接**的数据包。

如果没有规则允许数据包进行新连接。没有一个数据包会被认为允许建立连接的规则流动。（有关 [连接跟踪](http://www.rigacci.org/wiki/lib/exe/fetch.php/doc/appunti/linux/sa/iptables/conntrack.html "看这里")的更多信息？）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T21:06:54.940

请参阅[http://php.net/manual/en/function.print-r.php](http://php.net/manual/en/function.print-r.php)除非您将返回参数设置为 true，否则 print-r 的结果将被缓冲。所以 print_r 不会触发发送 HTTP 标头。然后阅读[http://php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)：无论实际的 header() 调用是否是第一个，HTTP 状态标题行将始终是第一个发送到客户端的。除非已经发送了 HTTP 标头，否则可以随时通过使用新状态行调用 header() 来覆盖状态。

# visual-studio-2010 - 如何查找 SQL Server Management Studio 的服务器名称

> ID：16088151
> 
> 赞同：186
> 
> 时间：2013-04-18T16:18:15.027
> 
> 标签：visual-studio-2010, sql-server-2008, ssms

我安装了 Microsoft SQL Server 2008。

当我启动 SQL Server Management Studio (SSMS) 时，我得到`Connect to Server`一个带有空白文本框的登录窗口`Server name`。我尝试了很多名称，但我无法解决它。

如何查找/获取服务器名称？

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2013-04-18T17:07:01.507

打开`SQL Server Configuration Manager`（在开始菜单中搜索）。点击`SQL Server Services`。SQL Server 的实例名称在括号中与`SQL Server` 服务内联。如果它显示**MSSQLSERVER**，那么它就是默认实例。要在 Management Studio 中连接到它，只需键入`.`(dot) OR`(local)`并单击连接。如果实例名称不同，则使用`.\[instance name]`连接到它（例如如果实例名称是**SQL2008**，则连接到`.\SQL2008`）。

还要确保`SQL Server`服务`SQL Server Browser`正在运行，否则您将无法连接。

**编辑：**

这是它在我的机器上的样子的屏幕截图。在这种情况下，我安装了两个实例：`SQLExpress`和`SQL2008`.

![在此处输入图像描述](https://i.stack.imgur.com/Zq5M4.png)

* * *

## 回答 #2

> 赞同：101
> 
> 时间：2013-09-12T13:07:11.243

运行此查询以获取名称

> 选择@@服务器名称

* * *

## 回答 #3

> 赞同：64
> 
> 时间：2014-11-06T04:36:14.347

打开 CMD

运行这个

```
SQLCMD -L 
```

您将获得 SQL Server 实例列表

* * *

## 回答 #4

> 赞同：50
> 
> 时间：2013-04-18T16:37:06.900

默认服务器名称是您的计算机名称，但您可以使用“.” （点）而不是本地服务器名称。

您应该考虑的另一件事是您可能安装了 sql server express edition。在这种情况下，您必须输入“.\sqlexpress”作为服务器名称。

* * *

## 回答 #5

> 赞同：27
> 
> 时间：2017-06-23T19:27:08.970

正如@Khaneddy2013 所提到的， cmd **SQLCMD -L** 在我运行时不返回服务器名称。Bcz 我只安装了 SSMS（未安装本地数据库和服务器）。在尝试安装*SqlLocalaLDB*和*SQLEXPR32_x86_ENU*（32 位操作系统）后，我能够连接。现在 cmd 窗口也显示了服务器名称。 [![在此处输入图像描述](https://i.stack.imgur.com/SUNMp.png)](https://i.stack.imgur.com/SUNMp.png)

* * *

## 回答 #6

> 赞同：22
> 
> 时间：2017-08-21T04:48:50.867

上面提到的方法有很多。但是我使用了相当简单的方法（不像**SELECT @@SERVERNAME**那样简单）。当您启动 SQL Server Management Studio 时，您将在 GUI 下方提示

[![在此处输入图像描述](https://i.stack.imgur.com/sJnf8.png)](https://i.stack.imgur.com/sJnf8.png)

在那里 Server name 是您的服务器名称（可能有多个服务器根据您的开发环境选择正确的一个）。希望这可以帮助 ：）

* * *

## 回答 #7

> 赞同：19
> 
> 时间：2020-10-17T05:41:45.427

**注意：** 要连接到 SQL Server Management Studio(SSMS) 上的服务器，我们必须先安装 SQL Server。

所以要进行的步骤如下

**第 1 步**：下载并安装 [Microsoft SQL Server 2019](https://www.microsoft.com/en-us/sql-server/sql-server-downloads)

**第 2 步**：下载并安装[SQL Server Management Studio](https://docs.microsoft.com/en-us/sql/ssms/download-sql-server-management-studio-ssms?view=sql-server-ver15)

如果仍然无法在 SSMS 上看到服务器名称，请查看以下三个屏幕：

[![在此处输入图像描述](https://i.stack.imgur.com/Brpd0.png)](https://i.stack.imgur.com/Brpd0.png) [![在此处输入图像描述](https://i.stack.imgur.com/H2LGM.png)](https://i.stack.imgur.com/H2LGM.png) [![在此处输入图像描述](https://i.stack.imgur.com/n1flE.png)](https://i.stack.imgur.com/n1flE.png)

* * *

## 回答 #8

> 赞同：14
> 
> 时间：2016-02-29T18:21:23.253

start -> CMD -> (Write command) SQLCMD -L first line is Server name if Server name is (local) Server name is : YourPcName\SQLEXPRESS

* * *

## 回答 #9

> 赞同：10
> 
> 时间：2017-10-04T17:27:16.257

给出以下示例

*   SQL 实例名称：MSSQLSERVER
*   端口：1433
*   主机名：MyKitchenPC
*   IPv4：10.242.137.227
*   DNS 后缀：dir.svc.mykitchencompany.com

这是您可能的服务器名称：

*   本地主机\MSSQLSERVER
*   本地主机，1433\MSSQLSERVER
*   我的厨房PC,1433\MSSQLSERVER
*   10.242.137.227,1433\MSSQLSERVER
*   MyKitchenPC.dir.svc.mykitchencompany.com,1433\MSSQLSERVER

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2013-12-11T20:03:30.360

我也是第一次遇到这个问题。

在“连接到服务器”对话框中，验证默认设置，然后单击“连接”。要进行连接，服务器名称框必须包含安装 SQL Server 的计算机的名称。如果数据库引擎是命名实例，则服务器名称框还应包含格式为：computer_name\instance_name 的实例名称。

例如，我解决了这样的问题：我输入了服务器名称：Alex-PC\SQLEXPRESS

然后它应该工作。有关更多信息，请参阅[http://technet.microsoft.com/en-us/library/25ffaea6-0eee-4169-8dd0-1da417c28fc6](http://technet.microsoft.com/en-us/library/25ffaea6-0eee-4169-8dd0-1da417c28fc6)

* * *

## 回答 #11

> 赞同：5
> 
> 时间：2015-10-27T05:51:53.587

步骤 1：确保系统上安装了 SQLEXPRESS 和 LocalDB 转到 SQL SERVER 配置管理器 => SQL Server 服务

如果没有列出 SQL Server 服务，请安装以下组件（对于 64 位操作系统） 1\. SqlLocalDB 2\. SQLEXPR_x64_ENU 3\. SQLEXPRADV_x64_ENU 4\. SQLEXPRWT_x64_ENU

Step2：打开 Management Studios 进入 . （点）作为服务器名称并单击连接 [在此处输入图像描述][2] 否则输入 .\SQLEXPRESS 作为服务器名称并单击连接

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2019-10-25T15:39:52.677

只需键入 .\sqlexpress 作为服务器名称

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2019-11-05T17:47:26.707

打字`sp_helpserver`会给你一个清单。正如其他人所指出的那样，有多种方式，有些使用别名等。这个存储的过程可能会返回多行，但可以让你更接近你的答案。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-02-14T15:57:28.750

尝试使用 . 或 localhost 作为服务器名称，可能会工作几次。

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2020-12-16T07:49:31.240

确保您已安装 SQL Server。

如果没有，请点击此链接并下载。 [https://www.microsoft.com/en-us/sql-server/sql-server-downloads](https://www.microsoft.com/en-us/sql-server/sql-server-downloads)

成功安装 SQL Server 后。您将获得服务器名称。参考下图：

[![在此处输入图像描述](https://i.stack.imgur.com/XluRS.png)](https://i.stack.imgur.com/XluRS.png)

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2016-12-30T11:12:15.010

1.您可以运行以下命令。

EXEC xp_cmdshell 'reg query "HKLM\Software\Microsoft\Microsoft SQL Server\Instance Names\SQL"';
去

您可以使用注册表读取实例名称。英戈尔空值。

2.使用内置标准报告。

选择实例-->右键单击->报告-->标准报告-->服务器仪表盘[![在此处输入图像描述](https://i.stack.imgur.com/uXBy0.png)](https://i.stack.imgur.com/uXBy0.png)

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2019-04-03T10:27:58.767

[请从链接 ( SSDT](https://go.microsoft.com/fwlink/?linkid=2052454) )安装 SQL Server Data Tools

您也可以在安装 Visual Studio 时安装它，在安装 Visual Studio 时必须选择**“数据存储和处理”选项**

[![在此处输入图像描述](https://i.stack.imgur.com/mH6HM.png)](https://i.stack.imgur.com/mH6HM.png)

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2015-07-22T09:05:18.453

我的问题是，在添加引用向导中连接到 SQL 数据库时，要找到 SERVERNAME。我通过以下方式找到它：在 SQL 管理工作室中运行查询（SELECT @@SERVERNAME），reusl 是我的服务器名称。我把它放在我的服务器名称框中，它工作得很好。

# sql - SQL：如何使用 DateDiff + ORDER BY 和 INNER JOIN

> ID：16088152
> 
> 赞同：1
> 
> 时间：2013-04-18T16:18:15.147
> 
> 标签：sql, sql-server, inner-join, datediff

这是我现有的 SQL 语句：

```
SELECT TOP 10 Users.FirstName + ' ' + Users.LastName AS Name,
              Feeds.LogType,
              Feeds.LogDesc,
              Feeds.Timestamp = DATEDIFF(MINUTE, Feeds.Timestamp, CURRENT_TIMESTAMP)
FROM Feeds
INNER JOIN Users ON Feeds.UserID = Users.UserID
ORDER BY Feeds.Timestamp DESC 
```

我在第二行有错误，`Incorrect syntax near '='.`

任何想法如何解决这一问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:23:20.647

尝试

```
SELECT TOP 10 Users.FirstName + ' ' + Users.LastName AS NAME
    ,Feeds.LogType
    ,Feeds.LogDesc
    ,DATEDIFF(MINUTE, Feeds.TIMESTAMP, CURRENT_TIMESTAMP)
FROM Feeds
INNER JOIN Users ON Feeds.UserID = Users.UserID
ORDER BY DATEDIFF(MINUTE, Feeds.TIMESTAMP, CURRENT_TIMESTAMP) DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:25:16.170

Feeds.Timestamp = DATEDIFF(MINUTE, Feeds.Timestamp, CURRENT_TIMESTAMP) should be

```
DATEDIFF(MINUTE, Feeds.Timestamp, CURRENT_TIMESTAMP) AS Timestamp 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:26:29.143

而不是 = 尝试别名为，

```
SELECT TOP 10 Users.FirstName + ' ' + Users.LastName AS Name, Feeds.LogType,
    Feeds.LogDesc,
    DATEDIFF(MINUTE, Feeds.Timestamp, CURRENT_TIMESTAMP) [Timestamp]
FROM Feeds INNER JOIN Users ON Feeds.UserID = Users.UserID
ORDER BY Feeds.Timestamp DESC 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T08:42:29.280

您可以以“alias = value”的方式使用别名，但您不应该指定表名，所以

```
Timestamp = DATEDIFF(MINUTE, Feeds.Timestamp, CURRENT_TIMESTAMP) 
```

# machine-learning - 一类分类器训练

> ID：16088153
> 
> 赞同：4
> 
> 时间：2013-04-18T16:18:18.450
> 
> 标签：machine-learning, classification, weka, libsvm, outliers

我正在研究一个分类问题，其中我只有一个类的数据，所以我想在“目标”类与“异常值”类的所有其他可能性之间进行分类。因此，我打算使用 One Class Classifier 或 LibSVM 分类器。但这里的问题是：

我需要为“异常值”类提供训练数据吗？如果是的话，有什么办法可以解决这个问题，因为我只有关于 Target 类的数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T08:52:41.497

仅使用来自正类的样本来实现此目的的一种方法是[密度估计](http://en.wikipedia.org/wiki/Density_estimation)。您可以将参数模型拟合到您的数据（例如，多变量法线）或使用核密度估计器（有点像最近邻的一类版本，具有核化距离度量）。然后，评估新数据在学习模型下的概率，如果它足够低，则将其作为类成员拒绝。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-10T13:32:46.243

您可以使用 One Class Svm 进行新颖性检测，您只需在目标类上对其进行训练，它会将您的数据分类为与受过训练的类相似或不同您可以[在此处](http://scikit-learn.org/stable/auto_examples/svm/plot_oneclass.html)
阅读 One Class Svm 的 scikit 文档

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-03T10:53:00.180

一类分类器的要点是没有来自异常类的数据可用。所有 1C 算法都是基于这个假设设计的。使用 1C 分类器的常见情况是机器的健康预测。在这种情况下，通常只有来自健康类的数据，因为从故障类收集数据非常昂贵且难以准确获取，因为它需要破坏设备才能查看传感器的反应。

排除上述 1C-SVM 的可能算法有：

-神经网络自动编码器。在这种情况下，重构误差可用于量化输入是否不再属于某一类。这也可以扩展到变分自动编码器，以准确隔离潜在变量（异常的无监督分类）。

- 神经网络 1C 分类器。

-HELM-1C 网络

# php - 如何将 URL 链接插入 PHP 定义标签

> ID：16088165
> 
> 赞同：0
> 
> 时间：2013-04-18T16:18:51.290
> 
> 标签：php, url, text, hyperlink

我是 php 的绝对新手，所以请温柔一点。

我有以下行...

```
define('TEXT_INFORMATION', '<b>Note:</b> You can check their rate calculator here, and you are welcome to contact us.'); 
```

我想放置一个指向邮局网站的 html 链接，上面写着“这里”，还有一个链接到我的联系页面，上面写着“联系我们”。请问怎么办？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:21:06.370

这就是你要找的

```
define('TEXT_INFORMATION', '<b>Note:</b> You can check their rate calculator here, and you are welcome to <a href="your link">here</a>.'); 
```

在我放置“您的链接”的 href 标记中替换您与我们联系页面的链接

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:21:13.527

您可以将单词包装在 HTML 锚标记中，如下所示：

```
define('TEXT_INFORMATION', '... <a href="YOUR URL">here</a> ...' 
```

# c# - 如何分离此实体框架模型以防止内存错误？

> ID：16088168
> 
> 赞同：1
> 
> 时间：2013-04-18T16:18:57.823
> 
> 标签：c#, sql-server, database, entity-framework

我正在尝试使用旧应用程序中的一组数据并将其移动到 MSSQL 数据库中。我使用 EF 在 C# 中创建了一个应用程序来管理数据。类结构代表旧版应用程序中的旧 C 样式数组，但具有一些类顺序。

这是三个主要的类。还涉及其他属性，但我在这里只包含了主窗体和内存占用 (AccountDetails)。构建此结构后，它具有一个模拟 - 从 50 到 100 个帐户，然后每个帐户具有 1000 个或更多帐户详细信息对象。

如果我一次添加整个结构 - 并保存更改，我会收到内存错误。如何添加所有 AccountDetail 对象并将其链接为一个对象结构？我可以单独添加它们吗（尽管此处未包含所有详细信息，但我已正确设置了所有 ID 和一个到 Many 的设置）。

```
public class Simulation 
{
    public string Name { get; set; }
    public List<Account>     Accounts { get; set; }
}

public class Account
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int Type { get; set; }
    public List<AccountDetail>     Details { get; set; }
}
// trouble in here....
public class AccountDetail
{
    public int Id { get; set; }
    public int Type { get; set; }
    public int Scenario { get; set; }
    public double M01 { get; set; }
     ..... class has 60 doubles for 5 years of payments ....
    public double M60 { get; set; }
} 
```

谢谢，

K。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T20:51:00.847

好吧，既然你有所有的身份证。只需执行以下操作。

1.  创建模拟对象并仅使用非导航属性（如整数、双精度等）填充它。保存更改。

2.  创建一个 Accounts 列表并仅使用非导航属性填充它，但请确保填写 SimulationID（或用于将 Account 链接到模拟的外键）。保存更改。

3.  创建 AccountDetails 列表，仅使用非导航属性填充它，但确保填写 AccountID（或用于将 Account Details 链接到 Account 的外键）。

在实体框架中，您不需要所有对象都在内存中。重要的是外键。现在，您可以根据需要一次仅保存 10 个帐户来节省内存。但老实说，我还没有看到 EF 抱怨内存，所以这就提出了一个问题......你是否正确设置了所有内容？

# java - Scala 和 Java 互操作。未来的

> ID：16088169
> 
> 赞同：3
> 
> 时间：2013-04-18T16:19:00.687
> 
> 标签：java, scala, scala-collections, scala-2.10, scala-java-interop

在这个问题中，我必须调用一个第三方 Java 库，该库期望 a`java.util.concurrent.Future`具有来自 Scala 例程的结果`scala.concurrent.Future`，例如返回 a 。

```
def someScalaFunction(): scala.concurrent.Future[T]

def otherJavaMethod(arg: java.util.concurrent.Future[T]) = ... 
```

我会将 Scala-Future 包装到一个新的 Java-Future 中，但是没有办法以`def cancel(mayInterruptIfRunning: Boolean): Boolean`中断包装的 Scala-Future 的方式实现 Java-Future 方法（否则请告诉我）。

我怎么解决这个问题？这些是我想出的方法：

1.  无论如何都要编写包装器，然后忽略调用`cancel`（或抛出`NotImplementedError`）
2.  更改`someScalaFunction`为可能返回一个闭包，然后由调用者将其包装在 Scala 或 Java Future 中。

1\. 的问题是某些客户端可以依赖正确的实现，`cancel`但可能不是很关键。2.会导致一个非常丑陋的api。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:28:30.797

请注意，`cancel`仅尝试取消任务，根据 Javadoc 没有任何保证。因此，您实际上不必实现它来做某事——取决于未来的计算是什么，忽略`cancel`调用可能不会对整个应用程序产生后续影响。

如果您确实需要取消它，请参阅[此问题](https://stackoverflow.com/questions/16009837/how-to-cancel-future-in-scala/16010193)以获得半解决方案。

否则，您可以使用第二种解决方案——借助一些隐式转换，您可以使它看起来更好。

```
object JavaInterOp {
  implicit def f2future[F[_]](f: () => T): java.util.concurrent.Future[T] = fc(f)
} 
```

这样，导入控制您要提供的转换以及何时提供。

这样做的一个问题是，它可能会在您并不真正想要的地方进行转换——它可能会产生令人惊讶的效果。

# exception-handling - 找不到布局时如何在 Liferay Velocity 主题中捕获 NoSuchLayoutException？

> ID：16088170
> 
> 赞同：2
> 
> 时间：2013-04-18T16:19:02.763
> 
> 标签：exception-handling, liferay, velocity, liferay-6, liferay-velocity

我在速度模板主题中有以下代码：

```
#set($currLayout = $layoutLocalService.getFriendlyURLLayout($group_id, true, $currFriendlyUrl)) 
```

抛出一个

```
com.liferay.portal.NoSuchLayoutException
    at com.liferay.portal.service.impl.LayoutLocalServiceImpl.getFriendlyURLLayout(LayoutLocalServiceImpl.java:959) 
```

当匹配的布局不存在时。

我怎么能在我的速度模板中捕捉到这个异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-23T09:19:19.357

据我所知，不可能在速度模板中捕获异常。一般来说，有两种方法来处理这种情况：

*   处理使用模板的应用程序中的异常，例如 servlet
*   避免抛出异常；相反，让该方法始终返回一个有效的（默认）值，或者`null`如果这是不可能的

[速度手册](https://velocity.apache.org/tools/devel/creatingtools.html#Designing_Template-Friendly_Interfaces "速度——创建工具")建议尽可能使用第二个选项。

# javascript - 在使用 requireJS 优化器时，buildlayered javascript 的优势是什么？

> ID：16088183
> 
> 赞同：3
> 
> 时间：2013-04-18T16:19:37.900
> 
> 标签：javascript, optimization, build, requirejs, require

我正在尝试使用`requireJs optimizer`r.js（[此处](http://requirejs.org/docs/optimization.html)）为生产准备应用程序的第一次尝试。

我可以让一切正常工作，并且可以将我所有的 js 丑化到一个`main.js`文件中，但是一个文件，很多问题......

**基本问题**：

1.  Javascript buildlayer requireJs 在说什么？我的单个文件？

现在我只优化了一个模块`main.js`，它将所有依赖项捆绑到一个文件中（jquery、jquery-mobile 以及启动我的应用程序所需的所有其他内容）。

**高级问题**：
在一页上说我正在使用一个用[jqplot](http://www.jqplot.com/)完成的图表，它使用 xy 额外的 javascript 文件，我在我的应用程序的其他任何地方都不需要。

1.  我需要做些什么来防止这些文件出现在我的`main.built.js`文件中？
2.  我是否需要`graph`在使用图表的页面上定义一个新模块，然后优化此模块以将 xy 文件连接到 graph.built.js

**非常先进**：
我的页面是由小工具组成的 = HTML/JS/CSS 的自主块，我在整个应用程序中重复使用这些块，并且可以使用 JSON 对其进行自定义。

1.  如果通过插件加载小工具`requireJS !text`，我的 HTML 文件将在哪里“优化”为大型单个 HTML 文件？
2.  如果我只想在每个页面上加载我需要的小工具，我是否必须为每个页面创建一个包含每个小工具依赖项的模块，然后优化`module index_page`、`module page_with_graph`等以确保只加载需要的内容？
3.  如果这样做，是否会在每个页面上重新请求小工具而不是缓存？

感谢您提供一些见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-31T07:53:07.677

伟大的客人！

**基本问题：**

> Javascript buildlayer requireJs 在说什么？我的单个文件？

首先，我们把 buildlayer 改写为“bundle”，这样更客观。所以它的连接模块集。它可以是单一的——如果你将你的模块放在一个构建中，或者如果你想为某些页面构建指定的构建，它可以是几个。

**进阶问题：**

> 我需要做些什么来防止这些文件出现在我的 main.built.js 文件中？

首先，这是我在书签中的一个非常有用的链接 - [https://github.com/jrburke/r.js/blob/master/build/example.build.js](https://github.com/jrburke/r.js/blob/master/build/example.build.js)

简而言之，您可以在**r.js配置中配置****模块**部分，管理**包含**和**排除**规则以达到目标

 ******> 我是否需要在我正在使用图表的页面上定义一个新的模块图表，然后优化此模块以将 xy 文件连接到 graph.built.js

您可以只使用**shim**并在其他模块上按需请求

**非常先进：**

> 如果通过 requireJS !text 插件加载小工具，我的 HTML 文件将在哪里“优化”为大型单个 HTML 文件？

不，它将在 build.js 中。这个结果我通过 !text 加载模板

> 如果我只想在每个页面上加载我需要的小工具，我是否必须为每个页面创建一个包含每个小工具依赖项的模块，然后优化模块 index_page、模块 page_with_graph 等以确保只加载需要的内容？

您可以为每个页面构建自己的 buldle，但这不是最好的主意。当我有类似的问题时，我决定构建一个捆绑包，原因有两个 - 它加载了一个，更容易控制 CDN 上的缓存并减少可能的错误和错误。但是，如果您需要单独的捆绑包，请点击发布到**模块**部分的链接。

> 如果这样做，将在每个页面上重新请求小工具而不是缓存

因此，如果您加载页面并在 10 个模块中有**dep1**，则依赖文件将加载一次（如果您在 buld.js 中没有它），然后将其注入模块中。当您重新加载页面文件时，可能会从浏览器缓存中获取或根据浏览器配置再次加载。

希望它会有所帮助。******

# php - ajax 帖子上的内部 500 错误

> ID：16088186
> 
> 赞同：0
> 
> 时间：2013-04-18T16:19:42.817
> 
> 标签：php, javascript, ajax, jquery-ui

我正在尝试在我们的 ajax 上发布更新用户元数据的请求（这不是与 wordpress 相关的问题）。我这样做的方式是，我使用带有 .position 的 jquery 可拖动 UI 来检索 position.top 编号，在 stop() 处我调用了将值发布到 ajax 文件的函数。出于某种原因，它返回 500 内部错误并使我们的 ajax 文件对所有其他函数无效。

这是第一步 $(document).ready(function() {

```
 $(".top_image_roll").hide();

            $(".five img").draggable({
                axis: "y",
                // Find original position of dragged image.
                start: function(event, ui) {

                    // Show start dragged position of image.
                    var Startpos = $(this).position();
                },

                // Find position where image is dropped.
                stop: function(event, ui) {

                    // Show dropped position.
                    var Stoppos = $(this).position();
                    update_image_coords_1(Stoppos.top);

                }
            });
            });
            </script>
        <?php } else { ?>           
        <?php }?> 
```

这是功能

```
function update_image_coords_1(coordss) {

  $.post('http://xxx/xxx/xxx/xxx/ajax.php',
    {
      'action': 'update_image_coords_1',
      'coords': coordss,
      'user_id': '<?php echo $user_id; ?>'

    }
  );
} 
```

这是在ajax文件上

```
if( !empty($_REQUEST['action']) && $_REQUEST['action'] == 'update_image_coords_1' && !empty($_REQUEST['user_id']) && !empty($_REQUEST['coords'])) {

$coords = $_REQUEST['coords'];
update_user_meta($_REQUEST['user_id'], 'update_image_coords_1', $coords); 
die();
} 
```

有什么我做错了吗？还有其他建议吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:22:51.350

internal 500 可能意味着您的 PHP 代码中有语法错误/其他致命错误。
如评论中所述，您的`if`陈述在括号中。

您应该做的是**打开 Apache 错误日志**，问题会非常好地出现，供您修复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T16:34:24.293

您的 if 语句在`empty`调用后缺少几个右括号：

```
if( !empty( $_REQUEST['action']) && $_REQUEST['action'] == 'update_image_coords_1' && !empty($_REQUEST['user_id'] && !empty($_REQUEST['coords']) { 
```

应该：

```
if( !empty( $_REQUEST['action']) && $_REQUEST['action'] == 'update_image_coords_1' && !empty($_REQUEST['user_id']) && !empty($_REQUEST['coords'])) { 
```

# ios - iOS：仅更改 UIView 的外观（无子类）- 可能吗？

> ID：16088192
> 
> 赞同：1
> 
> 时间：2013-04-18T16:19:52.740
> 
> 标签：ios, uiappearance

我有一个包含许多视图控制器的项目，我希望它们都具有带有平铺背景图像的父视图。现在我可以做

```
[[UIView appearance] setBackgroundColor:
    [UIColor colorWithPatternImage:[UIImage imageNamed:@"BackgroundPattern"]]]; 
```

问题是，这也会设置所有其他`UIView`子类对象（`UIButtons`、、`UILabels`等）的背景。我能做些什么来改变`UIView`背景？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:24:49.170

如果您`appearance`在类级别使用代理，则别无选择。您将修改每个`UIView`子类。

我没有看到许多其他子类化选项`UIViewController`，仅更改该子类视图的外观，然后使所有其他`UIViewController`子类成为第一个子类。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-01-26T21:13:16.200

您可以在每种类型上创建类别，并添加一个设置角半径的 UIAppearance 选择器。

UIView+Appearance.h 文件：

```
#import <UIKit/UIKit.h>

@interface UIView (Appearance)
- (void)setCornerRadius:(CGFloat)cornerRadius UI_APPEARANCE_SELECTOR;

@end 
```

UIView+Appearance.m 文件：

```
#import "UIView+Appearance.h"

@implementation UIView (Appearance)
- (void)setCornerRadius:(CGFloat)cornerRadius {
    self.layer.cornerRadius = cornerRadius;
}

@end 
```

AppDelegate.m 文件：

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {
    // Override point for customization after application launch.

    [[UIView appearanceWhenContainedIn:[ViewController class], nil] setCornerRadius:5.0];

    return YES;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T16:25:20.207

you could create a subclass of UIViewController calling it something like MyTiledViewController and in the init/viewDidLoad method write this...

```
[self.view setBackgroundColor:[UIColor colorWithPatternImage:[UIImage imageNamed:@"BackgroundPattern"]]]; 
```

**EDIT:** looks like Gabriele Petronella beat me to it, same thing really.

# java - java -version 不适用于 SSH

> ID：16088193
> 
> 赞同：1
> 
> 时间：2013-04-18T16:19:52.993
> 
> 标签：java, ssh

我正在尝试以`java -version`下列方式使用 ssh 在远程 linux 机器上运行-

```
ssh ravi@192.168.3.90 "java -version" 
```

我越来越`bash: java: command not found`。但是 java 安装在远程机器上，我`JAVA_HOME`将文件 ie`/etc/profile`和`~/.bashrc`. 我可以`java -version`直接在它上面运行。

为什么？我的目标是获取 java 版本。在远程 linux 机器上获取已安装 java 的版本需要进行哪些更改？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:22:50.453

向你展示了什么`ssh ravi@192.168.3.90 "which java"`。似乎从 PATH 中找不到 java。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T16:25:26.597

这与 Java 无关。它主要是关于 SSH。当您使用 SSH 运行命令时，您实际上是使用特定环境连接到远程机器。在您的情况下使用 user `ravi`。我相信这个用户没有`java`在`PATH`他的配置文件脚本中定义他的变量（例如`.bachrc`）。

尝试运行`ssh ravi@192.168.3.90 "echo $PATH"`并查看 java 不存在。

现在的问题是你想要什么。如果您只想运行 java 使用绝对路径。如果您希望能够使用命令行运行 java，请将 java 添加到`PATH`您正在使用的用户帐户。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-08-01T13:49:51.473

我在为 java 应用程序构建 jenkins 管道时遇到了同样的问题，如下所示。

```
Jenkins-Machine-->Remote_server(Build server) 
```

当我试图从 jenkins 机器运行“which java”cmd 到远程服务器时，它会为我的应用程序构建 jar 文件。

```
$ ssh -i id_rsa ubuntu@REMOTE_MACHINE 'which java' 
```

它产生空响应。

当我在远程机器上 ssh 并输入以下命令时

```
$ which java
/usr/lib/jvm/jdk-12.0.2/bin/java 
```

然后我发现 jenkins 服务器正在远程服务器上寻找 /usr/bin/java ，我发现 /usr/bin/java 不存在。

所以我使用远程服务器上的 jdk 文件夹为 /usr/bin/java 创建了符号链接

```
$ sudo ln -s /usr/lib/jvm/jdk-12.0.2/bin/java /usr/bin/java 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T16:22:35.680

您需要该`java`命令`PATH`位于远程计算机上。如果不是，您将需要使用绝对文件路径运行它。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-08-21T06:59:08.720

如果在 .bashrc 和 .profile 或 /etc/bash.bashrc 中都设置了 JAVA_HOME 后它不起作用。您可以参考这个答案[How do I set $PATH such that `ssh user@host command`works?](https://stackoverflow.com/questions/940533/how-do-i-set-path-such-that-ssh-userhost-command-works)

在这个答案中，您实际上仅在 .bashrc 中设置了 JAVA_HOME，但在哪个位置，这很重要。在我的 Ubuntu16.04 中，它确实有效！

# ember.js - 如何使用 Ember Data 提供的钩子

> ID：16088195
> 
> 赞同：1
> 
> 时间：2013-04-18T16:19:59.817
> 
> 标签：ember.js, ember-data

我正在尝试利用通过 Ember Data 源代码注释的钩子，但我似乎无法以调用它们的方式实现这些方法。

我目前正在尝试使用`keyForPolyMorphicType`which is a hook in `DS.JSONSerializer`，这是`A hook you can use in your serializer subclass to customize how a polymorphic association's name is converted into a key for the type.`我目前的设置方式

```
var jsonSerializer = DS.JSONSerializer.extend({
  keyForPolymorphicType: function(name) {
    debugger
  }
})
var serializer = jsonSerializer.create()

DS.RESTAdapter.configure('ServerDemo.Component', {
  alias: 'component'
});

ServerDemo.Adapter = DS.RESTAdapter.extend({
  bulkCommit: false
  ,serializer: serializer
});

ServerDemo.Store = DS.Store.extend({
  revision: 12,
  adapter:  ServerDemo.Adapter.create()
}); 
```

如果有人可以提供有关如何使用散布在源代码中的钩子的指导，那将很有帮助

编辑

这是我的模型

```
ServerDemo.Note = DS.Model.extend
  title: DS.attr 'string'
  content: DS.attr 'string'
  index: DS.attr 'number'
  noteable: DS.belongsTo 'ServerDemo.Noteable'

ServerDemo.Noteable = DS.Model.extend
  note_ids: DS.hasMany 'ServerDemo.Note'

ServerDemo.Part = ServerDemo.Noteable.extend
  rack_pos: DS.attr 'number'
  server_config_id: DS.belongsTo 'ServerDemo.ServerConfig'
  partable: DS.belongsTo 'ServerDemo.Partable', { polymorphic: true }
  note_ids: DS.hasMany 'ServerDemo.Note'
  semanticRackPos: (->
    "rack_pos_#{this.get('rack_pos')}"
  ).property('rack_pos')

ServerDemo.Partable = DS.Model.extend
  part_ids: DS.hasMany 'ServerDemo.Part'

ServerDemo.Component = ServerDemo.Partable.extend
  back_image: DS.attr 'string'
  cols: DS.attr 'number'
  rows: DS.attr 'number'
  front_image: DS.attr 'string'
  name: DS.attr 'string' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:33:35.330

你在正确的轨道上。我建议继承 from`DS.RESTSerializer`而不是`DS.JSONSerializer`.

我的猜测是您正在针对未正确实现多态关联的模型测试您的代码。

看看这个测试：[https ://github.com/emberjs/data/blob/master/packages/ember-data/tests/integration/belongs_to_test.js#L119](https://github.com/emberjs/data/blob/master/packages/ember-data/tests/integration/belongs_to_test.js#L119)

在文件的顶部，您可以看到存储、适配器、序列化程序和模型是如何设置的。

更新（在你描述你的模型之后）。

需要注意的一件事是 REST 序列化程序 camelize/decamelize 属性。你没有这样做。( `server_config_id`-> `serverConfig`)

关联的属性有一个描述模型的名称，而不是 json ( `note_ids`-> `notes`)中 id 的属性

你可以这样工作：

```
ServerDemo.Note = DS.Model.extend
  title: DS.attr 'string'
  content: DS.attr 'string'
  index: DS.attr 'number'
  noteable: DS.belongsTo 'ServerDemo.Noteable', {polymorphic: true}

ServerDemo.Noteable = DS.Model.extend
  notes: DS.hasMany 'ServerDemo.Note'

ServerDemo.Part = ServerDemo.Noteable.extend
  rack_pos: DS.attr 'number'
  serverConfig: DS.belongsTo 'ServerDemo.ServerConfig'
  partable: DS.belongsTo 'ServerDemo.Partable', {polymorphic: true}
  semanticRackPos: (->
    "rack_pos_#{this.get('rack_pos')}"
  ).property('rack_pos')

ServerDemo.Partable = DS.Model.extend
  parts: DS.hasMany 'ServerDemo.Part'

ServerDemo.Component = ServerDemo.Partable.extend
  back_image: DS.attr 'string'
  cols: DS.attr 'number'
  rows: DS.attr 'number'
  front_image: DS.attr 'string'
  name: DS.attr 'string' 
```

我不清楚这种设计是否是您正在寻找的，因为目前不需要多态关联。您可以减少定义的模型数量。

# cakephp - Cakephp 2.3：如何不使用 'id' 作为 $belongsTo 的标签选项 我在使用 Cakephp 时经常遇到这种困境，我很确定这是我没有遵循/理解某处约定的结果。在任何种类的 belongsTo （hasAnd 或其他）中，我通常发现由于 id 往往是外键，它最终也会成为下拉菜单中显示的内容，这在语义上当然是无用的。这是我通常所做的一个例子；我希望有人能直截了当地告诉我：（我只是编造这些表，因为它们为一般问题提供了一个很好的模板。）假设：用户表有列 id|firstname|

> ID：16088196
> 
> 赞同：0
> 
> 时间：2013-04-18T16:20:00.180
> 
> 标签：cakephp, cakephp-2.0, cakephp-2.3

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:29:08.523

对于单列表，简单的 $displayField = 'column_name' 就是答案。

但是对于列的连接，涉及到更多的代码：

```
public $virtualFields = array("full_name"=>"CONCAT(first_name, ' ' ,last_name)");
public $displayField = 'full_name'; 
```

如果它是一个非常复杂的 $displayField，则可能需要一个 afterFind 解决方案，但对于大多数情况，这就是解决方案。

希望有帮助。

# magento - 将后端更改为使用 SSL，但我们的 SSL 无法正常工作。我需要改回来，但现在无法访问

> ID：16088200
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:20:13.673
> 
> 标签：magento, ubuntu, phpmyadmin

昨天，我进入了我的 Magento 后端。我进入 System>Configuration>Web 并将其更改为通过安全（Https）连接访问后端。但是，我们的 SSL 无法正常工作，现在我无法回到那里进行更改。我已经阅读了一些答案，人们说要使用 phpmyadmin 访问一些要更改的文件。但是我无法访问 phpmyadmin。我已经在服务器上下载并安装了它，但是当我转到 mysite/phpmyadmin 时，它说该 URL 在服务器上不可用？有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:27:03.447

您将需要使用 phpMyAdmin、MySQL 工作台或[命令行](http://www.linux.org/article/view/create-mysql-database-via-command-line)访问您的 MySQL 数据库，并修改您的`core_config_data`表

查看

```
select * from core_config_data where path = 'web/secure/base_url'; 
```

更新

```
UPDATE core_config_data
SET value = 'http://www.example.com'
WHERE value = 'https://www.example.com' 
```

或者

```
UPDATE core_config_data
SET value = 'http://www.example.com'
where path = 'web/secure/base_url' 
```

[移动到新服务器或更改域后，请](http://www.magentocommerce.com/wiki/1_-_installation_and_configuration/update_site_url_in_core_config_data)查看core_config_data 中的 @Update Site URL

# javascript - 将数据从 JavaScript 数组插入另一个数组

> ID：16088201
> 
> 赞同：1
> 
> 时间：2013-04-18T16:20:17.390
> 
> 标签：javascript, arrays, arraylist

我已经将两个 JavaScript 变量定义为数组，例如：

```
var myMondaysImpressionsData = new Array(['2013-01-21', 2015], ['2013-01-28', 2967], ['2013-02-04', 2419], ['2013-02-11', 1311], ['2013-02-18', 1398], ['2013-02-25', 86161], ['2013-03-04', 216865], ['2013-03-11', 105252], ['2013-03-18', 141978], ['2013-03-25', 4647], ['2013-04-01', 46339], ['2013-04-08', 19920]); 
```

和：

```
var myMondaysImpressionsPaidData = new Array([0], [0], [0], [0], [0], [69428], [186482], [74850], [107281], [0], [32781], [0]); 
```

使用这种形式有点强制性，因为它是为了进一步的范围。我的问题是我想获取在第二个数组中找到的值并像这样添加它们，例如：

```
var example = new Array(['2013-01-21', 2015, 0], ['2013-01-28', 2967, 0], ['2013-02-04', 2419, 0], ['2013-02-11', 1311, 0], ['2013-02-18', 1398, 0], ['2013-02-25', 86161, 69428], ['2013-03-04', 216865, 186482], ['2013-03-11', 105252, 74850], ['2013-03-18', 141978, 107281], ['2013-03-25', 4647, 0], ['2013-04-01', 46339, 32781], ['2013-04-08', 19920, 0]); 
```

在第一个数组中。就像我说的，我必须达到上面示例变量中显示的形式。这在 JavaScript 中怎么可能？在这种情况下应该使用什么方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:22:49.270

使用一个简单的循环：

```
for (var i = 0; i < myMondaysImpressionsData.length; i++) {
    if (i < myMondaysImpressionsPaidData.length) {
        myMondaysImpressionsData[i].push(myMondaysImpressionsPaidData[0]);
    }
} 
```

如果你想得到一个新的数组，那就是不改变第一个，只需复制它之前。在 JavaScript 中，这是使用

```
var copy = array.slice(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:25:04.857

One possible solution for modern browsers:

```
var example = myMondaysImpressionsData.slice().map(function(e, i) {
    return e.concat(myMondaysImpressionsPaidData[i]);
}); 
```

If you need old browsers support use [shim](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map#Compatibility) for `map()` method from **MDN**.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:52:25.957

使用 Array 的 concat 函数并假设您想创建一个包含最终结果的新对象，我会像这样解决它。

```
var example = [], length = myMondaysImpressionsPaidData.length, i;
for (i = 0; i < length; i++) {
    example.push(myMondaysImpressionsData[i].concat(myMondaysImpressionsPaidData[i]));
} 
```

# perl - Perl - 模板工具包 - 如何获取模板中的变量列表？

> ID：16088203
> 
> 赞同：5
> 
> 时间：2013-04-18T16:20:22.947
> 
> 标签：perl, templates, dancer

我正在使用 Perl[`Dancer`](https://metacpan.org/module/Dancer)和[`Template::Toolkit`](https://metacpan.org/module/Template::Toolkit)。

我正在尝试创建一个通用例程，该例程将传递一个模板和 HTTP GET/POST 参数。

我需要找到一种方法来获取模板中的变量列表，以便我可以从参数中检索它们，或者如果缺少一个或多个，则返回错误。

我可以走一条丑陋的正则表达式路线，但我希望有一种更好/更清洁的方式。

所有的模板都是 XML/SOAP，到处都有一些变量。

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T17:21:24.790

如果您`TRACE_VARS`在模板上下文中启用该选项，那么您可以使用该`variables`方法获取所有访问值的哈希值。

此代码显示了一个简短的示例

```
use strict;
use warnings;

use Template::Context;
use Data::Dump;

my $template = '[% person.name %] <[% person.email %]>';

my $context = Template::Context->new(TRACE_VARS => 1);
my $compiled = $context->template(\$template) or die $context->error;
my $variables = $compiled->variables;

dd $variables; 
```

**输出**

```
{ person => { email => {}, name => {} } } 
```

# authentication - Eclipse 中找不到 HttpServletRequest#login() 方法

> ID：16088204
> 
> 赞同：1
> 
> 时间：2013-04-18T16:20:24.303
> 
> 标签：authentication, servlets, login, glassfish-3

我试图让这个例子工作： http: [//jugojava.blogspot.de/2011/07/jsf-form-authentication-on-servlet-3.html](http://jugojava.blogspot.de/2011/07/jsf-form-authentication-on-servlet-3.html) 问题发生在：

```
request.login(username, password); 
```

Eclipse 说：“HttpServletRequest 类型的方法 login() 未定义”。我将 jdk 1.7 与 Mojarra 2.1.0 和 Glassfish 3.1 一起使用。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:42:57.260

[从 Servlet 3.0 开始](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServletRequest.html#login%28java.lang.String,%20java.lang.String%29)引入该方法。因此，仅当您针对 Servlet 3.0 兼容容器（例如 Glassfish 3.x）配置和开发项目时，它才可用。

但是，您似乎已经拥有 Glassfish 3.x。鉴于您在 Eclipse 中开发，还有其他可能导致此特定问题的原因：

*   Glassfish 未关联为项目的目标运行时。在项目的属性中，确保它已在*Targeted Runtimes*部分中被选中。这样 Eclipse 将自动将其库包含在项目的构建路径中。

    ![在此处输入图像描述](https://i.stack.imgur.com/8kaLN.png)

*   项目未配置为 Servlet 3.0 项目。在项目的属性中，确保在*Project Facets*部分中将*Dynamic Web Module*版本设置为 3.0 。这样 Eclipse 将自动构建版本 3.0 而不是较低的版本。

     *![在此处输入图像描述](https://i.stack.imgur.com/FqPOK.png)* 
**   您已经手动下载了完全不同的 servletcontainer 版本的任意文件`javaee.jar`和/或`servlet-api.jar`文件，并将其放在项目的 buildpath/classpath 中，通过`/WEB-INF/lib`它优先于 Glassfish 自己的库。这是完全错误的。你不应该那样做。撤消所有这些更改。如果您正确地将服务器指定为目标运行时，则这是不必要的。* 

 *### 也可以看看：

*   [如何在我的 Eclipse 项目中导入 javax.servlet API？](https://stackoverflow.com/questions/4076601/how-do-i-import-the-javax-servlet-api-in-my-eclipse-project/4076706#4076706)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:36:01.197

将`Servlet 3.0 API`jar 添加到类路径中，或使用支持`Servlet 3.0`.*

# apache - Way to stop a subdomain using the .htaccess of main directory?

> ID：16088206
> 
> 赞同：0
> 
> 时间：2013-04-18T16:20:35.043
> 
> 标签：apache, .htaccess, subdomain, rules

I have a subdomain on my server and I don't want it to use the .htaccess of the main directory, is this possible with .htaccess rules?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:31:56.870

`.htaccess`*规则是从父目录*继承的，但是 AFAIK 它们不应该在 Apache 中的不同虚拟主机之间交叉。

只要您的子域不植根于父域根文件夹内的文件夹中，就可以了。

# c# - 在 C# 中解析 JSON 的最有效方法

> ID：16088208
> 
> 赞同：9
> 
> 时间：2013-04-18T16:20:40.320
> 
> 标签：c#, asp.net, json

我想知道在 C# 中解析 JSON 的最有效方法是什么？我所说的高效是指响应时间较短的那个。我正在尝试使用几种方法解析大量数据，并且这两种方法的响应时间都很长。谁能告诉我以下方法之间的区别？是否有替代方法可以让我以较短的响应时间进行解析？

选项1：

```
HttpWebRequest request = WebRequest.Create(jsonURL) as HttpWebRequest;
using (HttpWebResponse response = request.GetResponse() as HttpWebResponse)
{
    if (response.StatusCode != HttpStatusCode.OK)
        throw new Exception(String.Format(
        "Server error (HTTP {0}: {1}).",
        response.StatusCode,
        response.StatusDescription));
    DataContractJsonSerializer jsonSerializer = new DataContractJsonSerializer(typeof(obj));
    object objResponse = jsonSerializer.ReadObject(response.GetResponseStream());
} 
```

选项 2：

```
var json = new WebClient().DownloadString(jsonURL);
using (MemoryStream ms = new MemoryStream(Encoding.Unicode.GetBytes(json)))
{
    DataContractJsonSerializer jsonSerializer = new DataContractJsonSerializer(typeof(obj));
    object objResponse = jsonSerializer.ReadObject(ms);
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-18T16:29:29.423

您可以在以下链接中找到比较。

测试的库：

[http://sagistech.blogspot.com/2010/03/parsing-twitter-json-comparing-c.html](http://sagistech.blogspot.com/2010/03/parsing-twitter-json-comparing-c.html)

*   Json.NET - 一个流行的 C# JSON 库。
*   Gapi.NET - Gapi.NET 不是 JSON 解析库，但它包含 JSON 解析例程。
*   Procurios - 另一个 C# JSON 库。另请参阅此博客文章如何使用它来解析 Twiter 数据。
*   JavaScriptSerializer - .NET 3.5 内置 JSON 解析器。
*   DataContractJsonSerializer - .NET 3.5 内置 JSON 解析器。
*   AjaxPro - AC# AJAX 库。

![在此处输入图像描述](https://i.stack.imgur.com/XEQ8y.png)

* * *

**更新：**

根据马特约翰逊的评论添加了此信息

[http://theburningmonk.com/2011/11/performance-test-json-serializers-part-ii/](http://theburningmonk.com/2011/11/performance-test-json-serializers-part-ii/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:30:24.833

第一种方法有机会制作更少的数据副本。但我很难相信这两种方法都会产生可衡量的差异。您的实际成本将是网络成本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-05T07:03:55.153

仍处于早期阶段，但我在 Json.NET 之上构建了一个代码生成器，它消除了反射并将反序列化速度提高了 4 倍。

签[出 CGbR JSON 目标](https://github.com/Toxantron/CGbR#json-datacontract-serializer)。

```
[DataContract]
public partial class Root
{
    [DataMember]
    public int Number { get; set; }

    [DataMember]
    public Partial[] Partials { get; set; }

    [DataMember]
    public IList<ulong> Numbers { get; set; }
} 
```

将生成一个部分类：

```
public Root FromJson(JsonReader reader)
{
    while (reader.Read())
    {
        // Break on EndObject
        if (reader.TokenType == JsonToken.EndObject)
            break;

        // Only look for properties
        if (reader.TokenType != JsonToken.PropertyName)
            continue;

        switch ((string) reader.Value)
        {
            case "Number":
                reader.Read();
                Number = Convert.ToInt32(reader.Value);
                break;

            case "Partials":
                reader.Read(); // Read token where array should begin
                if (reader.TokenType == JsonToken.Null)
                    break;
                var partials = new List<Partial>();
                while (reader.Read() && reader.TokenType == JsonToken.StartObject)
                    partials.Add(new Partial().FromJson(reader));
                Partials = partials.ToArray();
                break;

            case "Numbers":
                reader.Read(); // Read token where array should begin
                if (reader.TokenType == JsonToken.Null)
                    break;
                var numbers = new List<ulong>();
                while (reader.Read() && reader.TokenType != JsonToken.EndArray)
                    numbers.Add(Convert.ToUInt64(reader.Value));
                Numbers = numbers;
                break;

        }
    }

    return this;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-12-04T08:57:49.417

出于好奇，我有 JSON.NET 5.0 r8 和我自己的（只有约 500 行代码）玩具 JSON 解析器吃各种 JSON 文件大小，有或没有循环，从几十个字符球场到一个 180 mb JSON文件，例如，“真实”数据。

示例数据（包括 12mb JSON，但不包括可以在其他地方找到的 180mb JSON）以及附带的详细信息，例如从流解析以反序列化为 POCO（强类型）对象的示例，可以在此处找到：

[https://github.com/ysharplanguage/FastJsonParser](https://github.com/ysharplanguage/FastJsonParser)

'希望能帮助到你。

PS 好的链接，顺便说一句，Chamika 在他的评论中已经提供了。

*编辑*

在我忘记之前（或以防它被忽略），这是 IMO 必知/必读的一种，关于尽可能*不*强调 CLR 的大型对象堆的重要性，这要归功于对 JSON 代码的流式读取消费，尤其是在 Web 服务器环境的上下文中：

[http://insidethecpu.wordpress.com/2013/06/19/json-parsing/](http://insidethecpu.wordpress.com/2013/06/19/json-parsing/)

PPS（因此，Program.cs 中的最后一个测试是测试/展示我链接到的玩具解析器，上面）

'嗯！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T16:34:11.117

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Example
{
public static class JavascriptSerializator
{
    /// <summary>
    /// Serializes object to JSON from Microsoft
    /// </summary>
    /// <param name="objectForSerialization"></param>
    /// <returns></returns>
    public static string SerializeMJSON(this object objectForSerialization)
    {
        try
        {
            System.Web.Script.Serialization.JavaScriptSerializer s = new System.Web.Script.Serialization.JavaScriptSerializer();

            return s.Serialize(objectForSerialization);
        }
        catch (Exception ex)
        {
            /// Handle exception and throw it ...
        }

    }

    /// <summary>
    /// Deserializes object from Microsoft JSON string
    /// </summary>
    /// <typeparam name="T"></typeparam>
    /// <param name="str"></param>
    /// <returns></returns>
    public static T DeserializeMJSON<T>(this string str)
    {
        try
        {
            System.Web.Script.Serialization.JavaScriptSerializer s = new System.Web.Script.Serialization.JavaScriptSerializer();

            return s.Deserialize<T>(str);
        }
        catch (Exception ex)
        {
            //// Handle the exception here...
        }

    }
} 
```

}

# architecture - Architecture for the proper decoupling of OWL/RDF knowledge and (mostly numerical) facts

> ID：16088210
> 
> 赞同：2
> 
> 时间：2013-04-18T16:20:50.067
> 
> 标签：architecture, rdf, semantic-web, owl

I am working on an application dealing mainly with public health indicators. The related concepts and knowledge are kept in an OWL ontology. There will also be eventually a (potentially important) number of numerical facts (e.g. indicator for X has value Y), which will grow over time, as more data gets crunched and added to the application. Given that querying this system will imply manipulating concepts (from the ontology), but also (numerical) facts, I am wondering what could be (in broad terms) an ideal data model/storage architecture for it.

I've been contemplating for instance an hybrid architecture where the facts would be stored in a separate SQL database (i.e. using a pure relational model, not a RDF-over-relational one), and for which the querying would be decomposed in two phases: the second (SQL) being derived (or guided) from concepts retrieved from the first (ontology).

As I read however about robust triple stores being able to handle massive amounts of data (billion+ triples), it suggests that I could also try to keep my facts in an RDF store (perhaps implemented with a relational DB). This would have the benefit I suppose of offering a more unified query interface (as I could query simultaneously in the the schema and fact stores using a same API or query engine, instead of mixing SQL in the process as with my hybrid approach). On the other hand, I guess I'd also lose the data crunching capabilities of a relational DB (assuming a triple store is not optimized for operations like aggregation, reduction, etc.) which might be useful in my context. As a final piece of information, I have already invested some energy in beginning to learn the Jena framework, so I'd appreciate if the suggestions could take it into account.

(I already asked this question on [answers.semanticweb.com](https://web.archive.org/web/20130905073107/http://answers.semanticweb.com/questions/22172/architecture-for-the-proper-decoupling-of-knowledge-and-mostly-numerical-facts), to no avail.)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T17:40:42.140

您的应用程序的纯 RDF 解决方案似乎可行。正如您所注意到的，RDF 数据库正在迅速成熟，并且有很多高质量的开源和商业选项可供选择。大多数可以扩展到数十亿或数百亿的三元组，并支持核心 semweb 标准。

此外，许多选项针对一组特定的用例和规模进行了优化，因此如果您对第一个选项的性能不满意，您可以尝试多个选项。另外，不要在这里自己动手，你不会把性能比最差的 RDF 数据库更好的东西拼凑在一起。您还可能从使用本机 RDF 存储的数据库中获得更好的性能，而不是由关系数据库支持的数据库，至少根据我的经验，这是真的。

至于 Jena，这是一个合理的框架，我个人更喜欢 Sesame，但两者都很好用。但是，最好不要在 Jena（或 Sesame）上标准化，最好在 SPARQL 上标准化应用程序的 RDF 部分，成为它的一部分或全部。这具有与数据库和编程语言无关的好处。SPARQL 协议基于 HTTP，因此您可以使用几乎任何语言并能够与数据库对话，而且由于您使用的是 SPARQL 而不是自定义协议，因此您可以更轻松地随着需求的发展而更改数据库。如果您希望在组织内或网络上公开您的数据，它还可以让其他人轻松使用您的数据。

SPARQL 将为您提供一种非常类似于 SQL 的强大查询语言，其中包括聚合（在 SPARQL 1.1 中）。它可能不具备您的应用程序所需的一切，您可能需要构建一些自定义处理代码，但它应该可以让您站稳脚跟。RDF 数据库针对处理 SPARQL 查询进行了优化，因此通常无需担心性能，但 SPARQL 在复杂性方面是 PSPACE-complete 的，因此您*可以*编写一个不容易回答的查询。

最后，虽然混合架构会起作用，但我担心的是长期而言可能会造成过度的维护负担。如果您对 semtech 感到好奇，并认为它至少适合您的部分应用程序，您可以先尝试使用纯 semtech 解决方案，看看您能走多远。

祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T22:24:02.333

只是为了提供[迈克尔](https://stackoverflow.com/users/479610/michael)出色答案的替代方案。

**关于他基于 RDF 的解决方案：**

指标分析可能会使用 R 完成，因此如果您选择完整的 RDF/SPARQL 解决方案，您还可以考虑[SPARQL 的 R 包](https://code.google.com/p/r-sparql/)。您将在这里拥有一个集成良好且可维护的解决方案，从数据模型直接到处理。

**替代实现：**

我认为语义网络相关技术的选择很大程度上取决于您将对数据提出的查询类型。你打算对本体使用任何推理吗？它是一个复杂的知识库吗？将来您是否打算将这些数据与其他数据结合起来？您是否计划有一天向公众发布数据？如果是，那么在 OWL 或 RDF 中表示您的数据可能会很有趣，因此您可以利用语言的表达能力来制定您无法单独使用 SQL 完成的事情，并提供一个脚手架来共享您的信息。

如果您认为 SQL 查询足以检索您想要的所有数据，那么我会简单地将信息存储在关系数据库中：它快速、安全且经过测试。如果包含概念的 OWL 本体只是一个简单的词汇表，您可以将术语与其余术语一起存储在数据库中。

# javascript - WebAudio 使 iPad 的 Home 按钮崩溃

> ID：16088222
> 
> 赞同：0
> 
> 时间：2013-04-18T16:21:41.240
> 
> 标签：javascript, html, web-audio-api

我在 iPad 上尝试过 SoundJS 和 Howler JS。两者都使用 WebAudio 来播放声音。它在浏览器中工作得非常好，但是，如果我将它添加到主屏幕并作为网络应用程序从主屏幕运行，一旦我播放声音，或者有时在播放声音一段时间后，我的主页按钮就会崩溃并且不起作用了。整个应用程序运行良好，性能没有任何缓慢，但主页按钮不再工作。唯一的方法是强制关闭，这需要很长时间才能重新启动。以前有人遇到过这个问题吗？

谢谢， 弗拉达斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-07T22:37:06.177

SoundJS 团队已将此问题追溯到 Web 应用程序进入全屏模式时使用：

`<meta name="apple-mobile-web-app-capable" content="yes" />`

向苹果报告了一个错误（参考 #15133492）。

目前除了不进入全屏模式外，我们没有其他解决方法。

# regex - 用于选择多行的正则表达式

> ID：16088225
> 
> 赞同：0
> 
> 时间：2013-04-18T16:21:52.083
> 
> 标签：regex, visual-studio-2010, visual-studio, notepad++

我有一个特定格式的文本文件..

```
!c_xyz|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyz
asdasda........................................................
asddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
!c_abc|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyz... 
```

我需要一个正则表达式来使用 Find and Replace - Visual Studio 重新格式化此文件。Desc 字段值已溢出到下一行。我需要将它们移回实际线。最后的字符串应该像

```
 !c_xyz|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyzsdasda.........asdddddd..
    !c_abc|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyz... 
```

我需要一个 RE 来表示“desc=”，然后是任何内容，直到下一个！象征

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:38:11.787

正如@X3074861X 的评论中提到的，您可以使用记事本++。

输入：

```
!c_xyz|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyz
asdasda........................................................
asddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
!c_abc|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyz... 
```

对于查找和替换，选择模式`Regular expression`与选项如下：

`Find what`：`\r\n[^!]`

留空`Replace with`。

输出：

```
!c_xyz|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyzsdasda........................................................sddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddd
!c_abc|crby=112|crdate=12jun11|mdby=112|mddate=12jun11|Desc=xyz... 
```

截屏：

![在此处输入图像描述](https://i.stack.imgur.com/nHGdi.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:39:02.080

find `Desc=([^\|\r\n]+)[\r\n](([^!\r\n][^\r\n]+[\r\n])*)`， replace with`Desc=\1\2`并重复，直到每一行都以开头`!`（您可以将`^[^!]`其用作搜索 expr 进行测试，它应该什么也找不到）。

或者 find `[\r\n]+`，替换为空字符串。此后查找`!`，替换为`\r\n!`. 这个建议有两个缺点。它会暂时产生很长的行，您的编辑器（尤其是 vs）可能会或可能不会遇到困难，并且处理包含`!`不正确的描述。

附录：您的输入似乎是该`Desc`部分的固定格式。如果确实如此，您可以应用替代方法 #2，步骤 1，然后使用`(!.{53}\|Desc=)`/进行搜索/替换运行`[\r\n]\1`。

# java - 实现一个调用接口方法的类？

> ID：16088226
> 
> 赞同：0
> 
> 时间：2013-04-18T16:21:52.320
> 
> 标签：java, generics, interface, abstraction

我真的在寻找这个问题的答案。我想创建一个只遍历目录树的通用代码。也许它只是一个包含一个方法的静态类。没问题。对于每个不是目录的文件，它都会做*一些*. 我认为为这个*东西*定义一个接口是要做的事情（我现在称之为`FileActionInterface.performAction()`），但我不确定如何编写目录walker代码来调用这个接口方法（它还不存在）。我已经看到并使用过其他 Java 类，它们有一个“添加接口处理程序（）”的方法，然后该类将运行您实现的接口。如果你什么都不丢进去，什么都不会发生。

很抱歉在这里抓住了正确的词。如何编写此目录遍历器代码以调用抽象代码？

PS所有这些都是很好的答案，我已经将它们标记为这样。当一个类对类有一个类似“addInterfaceHandler()”的方法时，他们是如何做到的？我猜这个类有它自己的接口实现，但它可能是空的。然后，当您调用 add() 方法时，您要么替换类的实现，要么像接口实现数组一样添加到它。

我将开始尝试您的不同解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:28:49.870

```
class DirIterator

  interface Callable
    method callback(file) // abstract
  end interface 

  method iterate (dir, callable) {
    for each file in dir
      if (file is Folder) then iterate(file, callable)
      else callable.callback(file)
  }

  // example use
  method main() {
    callable = new Callable{callback(file) {print(file.name)}}; // specify cb for this iteration
    dirIterator.iterate("root_dir_to_iterate/", callable); // start iteration
  }
end class 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:35:29.723

作为一个简单的静态方法：

```
static public walkTree(File dir, Visitor vis) {
    for(File fil: dir.getFiles()) {
        if(fil.isDirectory()) { walkTree(f,vis);      }
        else                  { vis.performAction(f); }
        }
    } 
```

（假设 Visitor 有 performAction 方法。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:48:48.177

你会写两种类型。第一个是一个接口，它声明了一个方法，如果他们想使用你的walker，他们必须实现。

```
public interface FileAction {

  void perform(File file) throws IOException;

} 
```

另一个是walker本身：

```
public final class FileWalker {

  public void scan(File directory, FileAction action) throws IOException {
    if (!directory.isDirectory())
      throw new IllegalArgumentException("Not a directory.");
    File[] sub = directory.listFiles();
    if (sub == null)
      throw new FileNotFoundException("Failed to list directory contents.");
    for (File f : sub) {
      if (f.isDirectory())
        scan(f, action);
      else
        /* This is where you invoke the implementation of the interface. */
        action.perform(f);
    }
  }

} 
```

您的用户将实现您声明的接口。它可以在`perform()`方法的实现中做任何他们需要的事情，这将由你的文件遍历器调用：

```
final class SizeCalculator implements FileAction {

  private long total = 0;

  @Override
  public void perform(File file) {
    total += file.length();
  }

  long getTotal() {
    return total;
  }

} 
```

然后他们会一起使用他们的对象和你的对象：

```
final class Test {

  public static void main(String[] argv) throws IOException {
    SizeCalculator sizer = new SizeCalculator();
    FileWalker walker = new FileWalker();
    File cwd = new File("");
    walker.scan(cwd, sizer);
    System.out.printf("Directory contains %d bytes.%n", sizer.getTotal());
  }

} 
```

如果您使用的是 Java 7，并且您的应用程序实际上是在遍历文件树，那么您应该使用[NIO.2 API](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#walkFileTree%28java.nio.file.Path,%20java.nio.file.FileVisitor%29)来遍历文件树。这里，要实现的[`FileVisitor`](http://docs.oracle.com/javase/7/docs/api/java/nio/file/FileVisitor.html)接口是核心Java库声明的接口。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T16:26:19.277

您将传入一个实现所述接口的对象。

步行方法将调用该对象上的方法。

类似于[Files.walkFileTree](http://docs.oracle.com/javase/7/docs/api/java/nio/file/Files.html#walkFileTree%28java.nio.file.Path,%20java.util.Set,%20int,%20java.nio.file.FileVisitor%29)与[FileVisitor](http://docs.oracle.com/javase/7/docs/api/java/nio/file/FileVisitor.html)的工作方式。

非常粗略：

```
public class Walker {
    private Visitor v;
    public Walker(Visitor v) { this.v = v; }
    public walk(File dir) {
        // pseudo-code
        for (File f : dir.getFiles()) {
            if (f.isDir()) {
                walk(f);
            } else {
                v.performAction(f);
            }
        }
    }
} 
```

# c# - Entity Framework Code First - 根据子 TPH 类的类型进行选择

> ID：16088233
> 
> 赞同：4
> 
> 时间：2013-04-18T16:22:16.990
> 
> 标签：c#, entity-framework, linq-to-entities, table-per-hierarchy

我目前正在使用 Entity Framework 4 处理一个项目，该项目使用 Table Per Hierarchy 来表示使用单个表的一组类。其工作方式是该表表示状态，并且不同的状态与不同的其他类相关联。

所以你可能会想象它看起来像这样，忽略所有州共享的公共字段：

```
InactiveState 
  has a -> StateStore

ActiveState 
  has a -> ActivityLocation

CompletedState
  has a -> CompletionDate 
```

每个状态都有属于它的所有 InventoryItems 的集合。

现在我的库存中的每个项目都有许多状态，历史中的最后一个是当前状态。为了保存在列表中，我有一个快捷方式字段指向我的库存当前状态：

```
public class InventoryItem : Entity
{

    // whole bunch of other properties

    public virtual ICollection<InventoryState> StateHistory { get; set; }

    public virtual InventoryState LastState { get; set; }

} 
```

我遇到的第一个问题是，例如，当我想查找所有处于该`Active`状态的 InventoryItems 时。

事实证明[Linq-To-Entities 不支持 GetType()](https://stackoverflow.com/questions/3232426/filtering-derived-classes-in-entity-set-by-oftype-and-getting-exception)所以我不能使用像`InventoryRepository.Get().Where( x => x.LastState.GetType() == someType )`. 我*可以*使用`is`运算符，但这需要一个固定的类型，所以不能有这样的方法：

```
 public ICollection<InventoryItem> GetInventoryItemsByState( Type state )
 {
     return inventoryRepository.Get().Where( x => x.LastState is state );
 } 
```

在进行 Linq 查询之前，我必须根据类型运行某种 if 语句，这感觉不对。InventoryItem 列表可能会变大，因此我需要在 EF 级别执行此操作，例如，我无法将整个列表拉入内存并使用 GetType()。

在这种情况下，我有两个问题，它们之间的联系足够紧密，我认为它们可以结合起来，因为它们可能反映了我缺乏理解：

*   是否可以使用 Linq To Entities 找到共享子表类型的项目列表？
*   鉴于我没有使用延迟加载，是否可以`Include`使用 TPH 为子表类型关联项目，例如，如果我有一个 InactiveState 作为我的 InventoryItem 的子项，我可以为该 InactiveState 预加载 StateStore？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T17:47:35.163

> 是否可以使用 Linq To Entities 找到共享子表类型的项目列表？

我认为除了使用 if/switch 检查类型并使用`is T`or构建过滤器表达式之外，不可能有其他方式`OfType<T>`。您可以将此逻辑封装到扩展方法中，例如拥有一个可维护的位置和一个可重用的方法：

```
public static class Extensions
{
    public static IQueryable<InventoryItem> WhereIsLastState(
        this IQueryable<InventoryItem> query, Type state)
    {
        if (state == typeof(InactiveState))
            return query.Where(i => i.LastState is InactiveState);
        if (state == typeof(ActiveState))
            return query.Where(i => i.LastState is ActiveState);
        if (state == typeof(CompletedState))
            return query.Where(i => i.LastState is CompletedState);

        throw new InvalidOperationException("Unsupported type...");
    }
} 
```

像这样使用：

```
public ICollection<InventoryItem> GetInventoryItemsByState(Type state)
{
   return inventoryRepository.Get().WhereIsLastState(state).ToList();
} 
```

我不知道是否可以使用 .NET API 并基于传递到方法中`i => i.LastState is XXX`手动构建表达式。（老实说，我也会感兴趣，但我几乎不知道如何自己回答这个问题。）`Expression``Type`

> 鉴于我没有使用延迟加载，是否可以使用 TPH 包含子表类型的相关项，例如，如果我有一个 InactiveState 作为我的 InventoryItem 的子项，我可以为该 InactiveState 预加载 StateStore？

我不确定我是否理解正确但通常急切的加载`Include`不支持对特定包含的子项的任何过滤或附加操作。

规避此限制并仍然在单个数据库往返中获得结果的一种方法是使用如下所示的投影：

```
var result = context.InventoryItems
    .Select(i => new
    {
        InventoryItem = i,
        LastState = i.LastState,
        StateStore = (i.LastState is InactiveState)
            ? (i.LastState as InactiveState).StateStore
            : null
    })
    .AsEnumerable()
    .Select(x => x.InventoryItem)
    .ToList(); 
```

如果查询是跟踪查询（在上面的示例中）并且关系不是多对多的（它们不在您的示例中），那么当实体加载到上下文中时，上下文将修复关系，即is`InventoryItem.LastState`和`InventoryItem.LastState.StateStore`(if `LastState`is of type `InactiveState`) 将被设置为加载的实体（*就好像*它们已经被预先加载加载一样）。

# java - 如何将 java.sql.Timestamp 转换为基于 UTC 的字符串？

> ID：16088235
> 
> 赞同：1
> 
> 时间：2013-04-18T16:22:19.173
> 
> 标签：java, clojure

当你调用`.toString`一个`java.sql.Timestamp`实例时，你会得到一个本地时区的格式化字符串。我想要一个基于 UTC 的格式化字符串，就像我在表示中看到的那样。我怎样才能从代表那里得到那个？

```
user> (def timestamp (doto (java.sql.Timestamp. 1366156869000) (.setNanos 42)))
#'user/timestamp
user> timestamp
#inst "2013-04-17T00:01:09.000000042-00:00"
user> (str timestamp)
"2013-04-16 20:01:09.000000042" 
```

我知道我可以使用 a `DateFormat`，但大概这是一个常见问题，所以我想知道是否还有其他问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:14:05.987

阅读本文：[在 Java 中将本地时间戳转换为 UTC 时间戳](https://stackoverflow.com/questions/2609360/converting-local-timestamp-to-utc-timestamp-in-java)

或者您也可以使用 Joda 时间将本地时间转换为 UTC，这可能是一种更好的方法。

# ios - iOS - UIViewControllers 共享一个屏幕

> ID：16088238
> 
> 赞同：1
> 
> 时间：2013-04-18T16:22:20.220
> 
> 标签：ios, uiviewcontroller, interface-builder

我正在编写一个包含两个部分的应用程序，如下所示：

![在此处输入图像描述](https://i.stack.imgur.com/4np79.png)

这个想法是在上半部分我正在创建一个请求，在底部我正在显示结果。随着我的`UIViewController`子类不断增长，我认为将其分成两个`UIViewController`s 可能是个好主意。（所以我想要做的是类似于 a `UISplitViewController`）。

虽然我知道以编程方式是可能的，但我想将两个`UIViewController`s 从 Interface Builder 放在屏幕中，以便我可以在那里管理自动布局和设计。拖放在那里不起作用。

那可能吗？更重要的是 - 这是一个好的设计还是我应该坚持“一个屏幕一个视图控制器”的规则？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:03:09.293

您可以使用自定义容器视图控制器来实现您想要的。看：

*   WWDC 2011 #102 关于[UIViewController Containment](https://developer.apple.com/videos/wwdc/2011/?id=102)（需要 Apple 开发人员 ID）

*   *View Controller Programming Guide*的[包含](http://developer.apple.com/library/ios/featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW12)部分

**   *UIViewController 参考*文档的包含[部分](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81)* 

 **简而言之，从 iOS 5 开始，您不再需要一个视图控制器。只要确保您拨打了必要的收容相关电话即可。iOS 6 使用“容器视图”对象可以更轻松地为自定义容器设计故事板。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:09:47.257

Apple 已经声明（WWDC 2012，View Controllers 的演变，我认为）“screenful”不再合适。视图控制器应该管理一个独立的功能块。

从 iOS5 开始，您可以使用视图控制器包含（`addChildViewController:`等等）来组成多个视图控制器的界面。从 iOS6 开始，您可以在界面构建器中使用容器和包含 segues 来执行此操作。

您当然需要一个视图控制器来保存您的两个子视图控制器 - 这*将*保存一屏内容，并且通常会在两个孩子之间执行任何协调。**

# jquery - ASP.NET MVC 4 不适用于 jquery datepicker

> ID：16088241
> 
> 赞同：2
> 
> 时间：2013-04-18T16:22:25.563
> 
> 标签：jquery, asp.net, jquery-ui, asp.net-mvc-4

我是 asp.net jquery 和 html5 的初学者，我正在开发一个 asp.net mvc 4 站点，其中有一个包含两个日期字段的表单。我不想手动插入日期，所以我尝试使用这个解决方案来实现一个简单的日期选择器：

```
 <fieldset>
    <legend>RangeDateViewModel</legend>
    <div class="editor-label">
        Start Date
    </div>
    <div class="editor-field">
        @Html.TextBoxFor(model => model.StartDate,  new{ @class = "date" })
        @Html.ValidationMessageFor(model => model.StartDate)
    </div>

    <div class="editor-label">
        End Date
    </div>
    <div class="editor-field">
        @Html.TextBoxFor(model => model.EndDate,  new{ @class = "date" })
        @Html.ValidationMessageFor(model => model.EndDate)
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>

   }

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
@Scripts.Render("~/bundles/jqueryval")

@Scripts.Render("~/bundles/jqueryui")
@Styles.Render("~/Content/themes/base/css")

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-1.5.1.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery-ui-1.8.11.min.js")" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        $(".date").datepicker();
    });
</script>
} 
```

代码运行良好，但如果我选择从每月 13 日到 30/31 日的日期，我总是会收到相同的警告：“字段 StartDate 必须是日期。” 和“字段 EndDate 必须是日期。”

编辑：我按要求添加了我的 ViewModel：

```
public class RangeDateViewModel
{
    public DateTime StartDate { get; set; }

    public DateTime EndDate { get; set; }

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T16:24:01.947

您需要告诉 DatePicker 您没有使用月份第一日期格式：

```
$.datepicker.setDefaults({
    dateFormat: "dd/mm/yy"
}); 
```

但是，这可能不是您的问题的重要部分（并且根据您的浏览器文化，日期选择器可能已经使用了第一个日期格式）。

首日日期格式和[jQuery 验证](https://stackoverflow.com/questions/12053022/mvc-datetime-validation-uk-date-format)以及[MVC 绑定](https://stackoverflow.com/questions/9821407/mvc3-en-gb-dates-in-get)也存在问题。[这是我坚持使用年份首日期格式 (yyyy-mm-dd)](http://xkcd.com/1179/)的主要原因之一，因为它被所有各种库正确解析。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:06:32.687

JQuery 是一种选择，但您可以采用 .NET 方法。我假设 StartDate 和 EndDate 来自 ViewModel 并且属于 DateTime 类型？

只需使用`@Html.EditorFor`intead，`@Html.TextBoxFor`您的控件就会立即变成 DatePickers。

您还可以通过在 ViewModel DateTime 上指定数据注释属性来设置有关日期如何显示和行为的特定规则。例如，这可能是您的 StartDate Viewmodel 属性：

```
[DisplayFormat(NullDisplayText = "", DataFormatString = "{0:d}")]
[Display(Name = "Start Date")]
public DateTime? StartDate{ get; set; } 
```

不确定如何进一步使用 C# 格式化您的日期选择器？没问题，继续使用 JQuery：

```
$(':input[data-datepicker]').datepicker({ dateFormat: 'dd/mm/yy' }); 
```

# c# - 对象引用未设置为对象的实例 (int)

> ID：16088254
> 
> 赞同：0
> 
> 时间：2013-04-18T16:22:57.207
> 
> 标签：c#, object, reference, set, instance

这个错误不断出现，我似乎无法弄清楚它来自哪里。

```
if (!IsPostBack)
{
    DataTable LocalCart = new DataTable();
    LocalCart = (DataTable)Session["cart"];
    int LocalCartItemCount = (int) Session["CartItemCount"];
    Decimal LocalCartAmount = (Decimal)Session["CartAmount"];

    if (LocalCart.Rows.Count == 0)
    {
        titleLabel.Text = "Your shopping cart is empty!";
        GridCart.Visible = false;
        updateButton.Enabled = false;
        checkoutButton.Enabled = false;
        totalAmountLabel.Text = String.Format("{0:c}", 0);
    }
    else
    {
        GridCart.DataSource = LocalCart;
        GridCart.DataBind();
        titleLabel.Text = "These are the products in your shopping cart:";
        GridCart.Visible = true;
        updateButton.Enabled = true;
        checkoutButton.Enabled = true;
        totalAmountLabel.Text = String.Format("{0:c}", LocalCartAmount);
    } 
```

这是说错误在这里->`int LocalCartItemCount = (int) Session["CartItemCount"];`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:51:48.467

好吧，第一个问题`Session["CartItemCount"]`很可能是空的。由于您尝试在强制转换中使用此 null 值，因此您会收到对象引用错误。

这可以用 C# 的`??`运算符纠正：

```
int LocalCartItemCount = (int)(Session["CartItemCount"] ?? 0); 
```

该行基本上是这个的简写：

```
int LocalCartItemCount;
if(Session["CartItemCount"] != null)
    LocalCartItemCount = Session["CartItemCount"];
else
    LocalCartItemCount = 0; 
```

这应该有效，只要`Session["CartItemCount"]`它始终是一个整数。但是，如果它不是整数，您可能会收到以下错误之一：

*   `Specified cast is not valid`
*   `Cannot unbox 'Session["CartItemCount"]' as 'int'`

如果存在上述这些错误的风险，那么您可能必须将其扩展为如下内容：

```
int LocalCartItemCount = 0;
if (Session["CartItemCount"] != null) 
{
    Int32.TryParse(Session["CartItemCount"].ToString(), out LocalCartItemCount);
} 
```

通常，虽然，我不喜欢`TryParse`在布尔表达式之外使用，但它仍然可以。

请记住，您需要对来自会话的任何对象进行类似的空检查。因此，`LocalCart.Rows.Count == 0`例如，对于评论中提到的支票，我会将其更改`if`为：

```
if(LocalCart != null && LocalCart.Rows.Count == 0)
{
    // do stuff here
} 
```

或者，您可以使用上述`??`运算符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:36:04.737

您没有检查密钥是否`"CartItemCount"`存在于 Session 中。如果它不存在，则结果`Session["CartItemCount"]`将返回 null 并在尝试将 null 强制转换为`(int)`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:36:22.443

如果会话对象不存在，它将返回 null，这将破坏强制转换。您应该考虑使用 int.tryparse。如果成功，它将更新整数，如果不成功，它将不会爆炸。

试试下面的代码

```
int LocalCartItemCount;
int.TryParse(Session["CartItemCount"].ToString(), out LocalCartItemCount); 
```

b计划

```
int LocalCartItemCount = (int)(Session["CartItemCount"] ?? 0); 
```

# java - 字符串类与其他类有何区别？

> ID：16088255
> 
> 赞同：3
> 
> 时间：2013-04-18T16:23:00.013
> 
> 标签：java, string

我们能做的：

`String string = "ourstring";`

但是我们不能为用户定义的类创建这样的对象：

`UserClass uc="";`

Java 是如何只允许我们直接为`java.lang.String`类设置值的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:27:25.380

`java.lang.String`是一个特殊的班级。

随意阅读[http://docs.oracle.com/javase/7/docs/api/java/lang/String.html](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)

它说

> String 类表示字符串。Java 程序中的所有字符串文字，例如“abc”，都是作为此类的实例实现的。
> 
> ...
> 
> Java 语言为字符串连接运算符 ( + ) 以及将其他对象转换为字符串提供了特殊支持。字符串连接是通过 StringBuilder（或 StringBuffer）类及其 append 方法实现的。字符串转换是通过 toString 方法实现的，由 Object 定义并由 Java 中的所有类继承。有关字符串连接和转换的更多信息，请参阅 Gosling、Joy 和 Steele，Java 语言规范。

没有其他类具有 Java 语言的这种特殊支持。

你应该非常小心它的`+`特性：它被广泛讨论为对性能和内存不安全。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T16:24:46.760

`""``String`是用于从实习字符串池返回对象的语法糖。

将其视为例外而不是规则。常规对象分配需要采取形式

```
MyObject myObject = new MyObject(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:26:40.460

有关此主题的详细信息，请查看在线 Javadoc：[http ://docs.oracle.com/javase/6/docs/api/java/lang/String.html](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)

Java 中的字符串很好用。它们获得了像原语一样使用的好处，但在内部是对象。有一个内部“内部字符串池”可以为您跟踪字符串对象。这样做主要是为了提高效率，但抽象足够简洁，您可以假装 String 只是一个原始类型，如 int 或 char。

请记住避免像大多数对象一样使用构造函数手动创建字符串！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T16:38:24.583

实际上 String string="ourstring" 调用了 String 类的默认构造函数 new String(char value[])。如果您还看不到，建议您阅读 String.clss

this is String.class descipe /** *`String`类表示字符串。Java 程序中的所有 * 字符串文字，例如`"abc"`，都作为此类的实例实现。*

* 字符串是常量；* 创建后它们的值不能更改。字符串缓冲区支持可变字符串。* 因为 String 对象是不可变的，所以它们可以被共享。例如： *

> ```
>  
>  * 字符串 str = "abc";
>  *
> ```

* 等价于：*

> ```
>  
>  * 字符数据[] = {'a', 'b', 'c'};
>  * 字符串 str = 新字符串（数据）；
>  *
> ```

* 下面是一些如何使用字符串的示例：*

> ```
>  
>  * System.out.println("abc");
>  * 字符串 cde = "cde";
>  * System.out.println("abc" + cde);
>  * 字符串 c = "abc".substring(2,3);
>  * 字符串 d = cde.substring(1, 2);
>  *
> ```

*

*/

# perl - perl fileparse 并推入多个数组

> ID：16088256
> 
> 赞同：0
> 
> 时间：2013-04-18T16:23:00.770
> 
> 标签：perl, perl-data-structures

我有一个包含文件路径的数组。我想拆分数组给我文件名、目录名和扩展名。我正在尝试使用 File::Basename perl 模块。

有人可以帮我实现这一目标：

```
foreach (@files) {
    push((@file_basename,@dir_name,@ext), fileparse($_));
} 
```

我知道我在做什么是不对的。有人可以帮我修复上面的代码吗？

我知道我可以这样做：

```
$filename = basename($file); 
```

然后将此值推送到数组中。同样对 dir 和扩展名做同样的事情。只是在寻找更好的方法。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:42:43.687

看起来您缺少`fileparse`. 哪个是`@suffixes`

在[perldoc](http://perldoc.perl.org/File/Basename.html)中说明，您要查找的内容应如下所示：

```
my($filename, $directories, $suffix) = fileparse($path, @suffixes); 
```

如果您没有后缀列表，则可以执行以下操作：

```
fileparse("/foo/bar/baz.txt", qr/\.[^.]*/); 
```

哪个应该匹配任何扩展名。

然后你可以像这样修复推送：

```
for my $file (@l){
    my ($name, $path, $suffix) = fileparse($file, qr/\.[^.]*/);

    push @name_list, $name;
    push @path_list, $path;
    push @suffix_list, $suffix;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T16:49:08.833

这是一个有趣的问题。最简单的解决方案就是把它全部写出来：

```
for (@files) {
  my ($name, $path, $suffix) = fileparse($_);
  push @file_basename, $name;
  push @dir_name,      $path;
  push @ext,           $suffix;
} 
```

* * *

我们可以抛开所有的清晰性并循环遍历数组引用，将相应的标量推到末尾：

```
my @collectors = \(@file_basename, @dir_name, @ext);
for (@files) {
  my @parse = fileparse($_);
  push @{ $collectors[$_] }, $parse[$_] for 0 .. $#collectors;
} 
```

* * *

或者我们可以定义一个`push3`函数：

```
sub push3 (\@\@\@@) { # use (+++@) prototype on p5v14 or later
  my @arrays = splice @_, 0, 3;
  ARG: while (1) {
     for (@arrays) {
       push @$_, shift;
       @_ or last ARG;
     }
  }
} 
```

或者更一般的`multipush`：

```
sub multipush($@) { # maybe use (+@) on p5v14 or later
   my $arrays = shift;
   ARG: while (1) {
     for (@$arrays) {
       push @$_, shift;
       @_ or last ARG;
     }
   }
} 
```

然后：

```
for (@files) {
  push3 @file_basename, @dirname, @ext, fileparse($_);
} 
```

或者

```
for (@files) {
   multipush [\( @file_basename, @dirname, @ext )], fileparse($_);
} 
```

但我认为这种解决方案不优雅、不灵活，并且会提倡使用第一个明确的解决方案。

* * *

要真正从 中获取后缀而不是空字符串`fileparse`，您必须指定匹配后缀（扩展名）的正则表达式，例如`qr/\.[^.]+\z/`.

# c# - 在 Windows 资源管理器中删除后，我的 System.IO.File.WriteAllText 编码不会创建文件

> ID：16088257
> 
> 赞同：1
> 
> 时间：2013-04-18T16:23:01.713
> 
> 标签：c#, .net

**文章底部的结论**

我是 C# 的新手，才刚刚开始使用 System.IO，但无法找到有关我的问题的信息，所以想在这里问这些人：

我有一个程序，它在运行时创建一个目录，然后将某个变量的最新值写入 .txt 文件，这样如果程序中断或计算机断电，重新启动程序将检索存储的.txt 文件中的编号。

我只是这样做了：

```
 string INSTATR = LastValue.ToString();
    System.IO.File.WriteAllText(@"C:\\DotTempFiles\\"+Instrument.Name+"ATR.txt", INSTATR); 
```

我第一次运行这个程序时，创建了文件，我发现在每个循环中，文件中的数字都被覆盖为我想要的最后一个有效数字。

但是，一旦我进入 DotTempFiles 目录并使用 Shift+Del 删除了 .txt 文件，该文件在运行程序时从未像我想象的那样返回。如果我删除整个目录并运行程序，则会重新创建目录但仍然不是文件。

如果我使用不同的 Instrument.Name 运行程序，则该新文件会按预期创建，但我曾经手动删除的原始文件仍然没有显示，即使在计算机重新启动后也是如此。

我在网上找不到任何信息线索，所以有人有想法吗？谢谢！

**编辑（更多信息）：** 人们问了几个问题，所以我添加了更多信息（谢谢）

没有报告错误。它编译得很好，并且在运行时，有一个输出窗口通常会提醒我出现错误，比如我引用了一个空对象，或者尝试从一个空文件中读取，等等。没有发生这样的错误。

有关该程序的更多背景信息。有一个名为 NinjaTrader 的股票交易程序，它有自己的基于 C# 的 API。他们不会支持我的问题，因为这超出了他们打算让人们使用的脚本开发的正常范围，这对我来说没问题。该程序本身是在 NinjaTrader 中运行的交易策略，它公开了对以下两个主要方法的默认程序员访问权限：

初始化（）

protected override void OnBarUpdate() //这是程序的主要部分，每次股票图表上的一根柱发生变化时都会调用它。

在变量声明部分我有这个：

```
 System.IO.DirectoryInfo di = Directory.CreateDirectory(@"C:\\DotTempFiles"); 
```

在 OnStartUp() 我有这个：

```
 //Set up ReadMe file in the temp directory in case people wonder why it keeps appearing
    string README = "This DotTempFiles directory is created by the strategy every time it is run, and temporary text files with the name [instrumentsymbol]ATR.txt are written into it containing the last highest ATRStopValue for the strategy, which if it is stopped and restarted with an open position, it will read from that file to get back the best value instead of recalculating it with possibility of a lower unwanted value.";
    System.IO.File.WriteAllText(@"C:\\DotTempFiles\\README.txt", README); 
```

每次调用 OnBarUpdate()（最多每秒几次）时，它首先计算一个名为 LastValue 的 double，它是一个与股票价格相关的数字，然后将其转换为字符串 INSTATR，然后将其写入.txt 文件。

```
 string INSTATR = LastValue.ToString();
    System.IO.File.WriteAllText(@"C:\\DotTempFiles\\"+Instrument.Name+"ATR.txt", INSTATR); 
```

这是我与这个问题相关的每一段代码。正如我上面提到的，它是第一次创建该文件，但由于我在 Windows 资源管理器中删除了该文件，因此无法重新创建它。但是，删除目录并重新启动策略程序确实会重新创建该目录。

OnTermination() 不用于以任何方式关闭或删除文件（以防万一人们想问）——除了已经显示的代码之外，我没有使用任何其他代码与文件交互。谢谢！

**编辑2（阅读评论后更新）：** 谢谢你们的评论和帮助。当我回到家时，我会尝试用一个只包含这些代码行的空程序重新创建它的最小版本，看看结果是什么，我会以任何一种方式发布更新。

**编辑3**：谢谢史蒂夫，这是一个非常好的主意，我应该从现在开始使用这些东西。

**编辑 4（结论）：** 嗯，我发现我忽略了一些关于我自己的代码逻辑的简单内容。我将 File.WriteAllText 设置为在 Double 变量值增加时触发，而不是在每次调用 OnBarUpdate 方法时触发。因此，除非每隔几个小时左右一次，否则不会写入文件，现在我看到一切正常。我很抱歉让所有这些人阅读这篇文章，因为它是基于我自己的另一个问题。然而，我非常感谢大家的评论帮助我走到了这一步，感谢史蒂夫和马克拉卡塔的建议，我从中学到了一些新的好东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:45:16.183

我发现文件创建没有任何问题，事实上我的编码逻辑调用它的频率远低于我想象的（每隔几个小时一次 vs 每秒几次）

# configuration - 添加站点页面时自动从访客角色中删除查看权限

> ID：16088258
> 
> 赞同：3
> 
> 时间：2013-04-18T16:23:05.833
> 
> 标签：configuration, liferay, liferay-6, administration

在 Liferay 中，当页面添加到站点时，默认情况下它会`VIEW`授予访客角色权限。

![站点页面的权限窗口](https://i.stack.imgur.com/ch3KQ.jpg "站点页面的权限窗口")

是否有任何方法（通过配置或通过钩子或其他方式）禁用此功能，以便`VIEW`在将新页面添加到站点时默认禁用访客角色的权限？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T06:23:33.543

好吧，虽然页面 [Layout-in Liferay low level context] 被添加为公共页面，Liferay 将默认权限分配给在Layout 模型`GUEST`中定义的角色。`sites.xml`

基本上有两种方法可以通过ext开发避免它：

1.  删除访客默认权限`sites.xml`
2.  `LayoutLocalServiceImpl`通过将布尔值`addLayout`设置为.`addGroupPermissions``false`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-19T10:32:37.910

有一些方法（通过 liferay 配置和 Ext）可以限制那些没有明确拥有该权限的用户查看站点公共页面。

***第一种方法***

所以这可以通过`false`在portal-ext.properties中设置这个属性来实现：

```
permissions.check.guest.enabled=false 
```

但是通过设置此属性，将会发生的情况是访客角色仅对未登录的用户有意义，一旦用户登录，即使访客对页面或资产有 VIEW 权限，用户也不会除非用户具有该权限，否则可以查看它。

因此，即使您将所有权限授予来宾角色，来宾角色也会完全无用。

对于尚未登录的用户，您可以通过一些逻辑将他们发送到登录页面。

***第二种方法***

1) 更新 EXT-plugin 中的 site.xml 以在添加站点页面时禁用`VIEW`访客的默认权限。

通过在添加站点页面时这样做，默认情况下访客角色的查看权限未选中。

# c - 如何编译适用于 libcrypto.so.0.9.8 和 libcryto.so.1.0.0 的二进制文件？

> ID：16088261
> 
> 赞同：7
> 
> 时间：2013-04-18T16:23:16.983
> 
> 标签：c, openssl, autotools, libssl

我有一个 autotools C 项目。

如何编译适用于 libcrypto.so.0.9.8 和 libcryto.so.1.0.0 的二进制文件？（即 Ubuntu 9.10 和 12.04）

根据我进行构建的操作系统的年龄，二进制文件需要一个版本或另一个版本。

有没有办法让它不在乎，或者 libcryto 版本之间的差异是不可克服的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-28T14:28:36.340

在我看来，你想使用 libcrypto.so.0.9.8 的一些功能和 libcryto.so.1.0.0 的一些功能。如果大多数功能需要 1.0.0 或首选，则链接 libcrypto.so.1.0.0。

您可能需要 libcrypto.so.0.9.8 中的一些功能，或者您可能有其他充分的理由使用 libcrypto.so.0.9.8。

在我看来，如果你从两个库链接，你会得到链接器错误（重复的符号，因为两个库都包含相同的符号）。

如果您需要使用 0.9.8，则使用 dlopen 动态加载它并获取要与 dlsym 一起使用的函数回调。

这可以通过以下方式完成：

```
void * handle;
/*reqd_callback is the callback of required function.*/
reqd_callback cb;

handle = dlopen ("libcrypto.so.0.9.8", RTLD_LAZY);
cb     = (reqd_callback)dlsym(handle, "reqd_function");
//Call the cb
cb (parameters);

//Close the library.
dlclose(handle); 
```

我认为这可能会解决您的目的。如果首选项是相反的，则在链接和通过程序加载时反转库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-28T22:40:28.453

您能否创建一个“指向”libcrypto.so.0.9.8 或 libcryto.so.1.0.0 的软链接。给它一个通用名称然后使用它，那么链接“指向”的任何版本的库都会被拾取吗？在应用安装时，您将软链接设置为指向可用的库版本。如果 lib 足够向后兼容，您的软件可能会被测试到 1.0.0，也就是说，您不依赖 1.0.0 中的某些东西，而 0.9.8 中没有，您可以。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-29T03:12:46.713

您可以重建 ssl-0.9.8（不是 1.x，因为它包含一些在旧版本上不起作用的东西）并更改 makefile 中它执行最终共享库链接并嵌入 SONAME 的行

使用从 libssl.so.0.9.8 更改为 libssl.so.0 的 SONAME 重新编译它

它看起来像：`-Wl,-soname,libssl.so.0.9.8` 将其更改为：`-Wl,-soname,libssl.so.0`

现在，当您针对此库进行编译时，针对它构建的二进制文件将查找 libssl.so.0（在两个版本中都包含为符号链接）

# java - java中的算法比较：测试程序不起作用

> ID：16088265
> 
> 赞同：0
> 
> 时间：2013-04-18T16:23:26.097
> 
> 标签：java, algorithm, quicksort, hybrid

我正在尝试比较 QuickSort 的 java 实现及其混合版本的执行（对小于整数 k 的分区使用 InsertionSort）。我编写了一个测试类来分析算法对某些值 ok k (1 <= k <= 25) 的行为。对于 k 的每个值，该类针对不同大小的输入数组比较两种算法。

我无法为数组大小的某些值运行程序，例如大于 4000 的值。执行达到一些不同的值然后冻结，一段时间后它将完成但我没有计算输出。（我正在使用日食）。
可能是什么问题呢？我希望对从 10 到 10000（至少）的数组大小进行两种算法的比较。
代码如下：

```
public class Main {

private static final int MAX_K = 25;
private static final int MAX_SIZE = 4500;
private static final int ADD_SIZE = 100;
private static int size = 10;

private static QuickSort qSort;
private static HybridSort hSort;

private static void initArray(int[] A) {
    Random rand = new Random();
    for (int i = 0; i < A.length; i++) {
        // A[i] = (int)(Math.random()*100000);
        A[i] = rand.nextInt();

    }
}

private static int[] A = new int[10];
private static int[] B = new int[10];

public static void main(String[] args) {

    try {

        FileWriter fstream = new FileWriter("out.txt");
        BufferedWriter out = new BufferedWriter(fstream);
        out.write("Init file");

        qSort = new QuickSort();
        hSort = new HybridSort();

        /************************************************/
        /* Comparison */
        /************************************************/

        for (int i = 1; i <= MAX_K; i++) {
            hSort.setK(i);

            int p = 0;
            for (int j = size; j <= MAX_SIZE; j = j + ADD_SIZE) {

                A = new int[j];
                B = new int[j];
                initArray(A);
                initArray(B);

                long sTime = System.nanoTime();
                qSort.quickSort(A, 0, A.length - 1);
                long qDuration = System.nanoTime() - sTime;

                sTime = System.nanoTime();
                hSort.hybridSort(B, 0, B.length - 1);
                long hDuration = System.nanoTime() - sTime;

                out.append(/* "\nA: " +printArray(A)+ */"K: " + i + " A["
                        + j + "]\tQ = " + qDuration + " H = " + hDuration
                        + "\n");

                String h = Long.toString(hDuration);
                String q = Long.toString(qDuration);

                if (h.length() < q.length()) {
                    p++;
                    out.append("\t#OUTPERM for K: "
                            + i
                            + "\t\t"
                            + hDuration
                            + "\t\t < \t\t "
                            + qDuration
                            + "\t\t\t\t| A[]\t\t"
                            + A.length
                            + ((q.length() - h.length()) == 2 ? "\t Magn. 2"
                                    : "") + "\n");
                }
            }
            if (p > 0)
                out.append("#P= " + p + " for K= " + i + "\n\n");
        }
        out.append("Close file");
        out.close();
    } catch (IOException e) {

    }
}

} 
```

算法类：

```
public class QuickSort {

public void quickSort(int[] A, int left, int right){
    if (left < right) {
        int m = Partition(A, left, right);
        quickSort(A, left, m-1);
        quickSort(A, m, right);
    }
}

private int Partition(int[] A, int left, int right){
    int pivot = A[right];
    int i = left;
    int j = right;

    while (true) {
        while ( (A[j] > pivot)) {
            j--;
        }
        while ((A[i] < pivot)) {
            i++;
        }
        if (i < j){
            int swap = A[j];
            A[j] = A[i];
            A[i] = swap;
        }else{
            return i;
        }
    }
}

} 
```

```
public class HybridSort {

int k;
int m;
InsertionSort iSort;

public HybridSort() {
    k = 3;
    iSort = new InsertionSort();
}

public void hybridSort(int[] A, int left, int right) {
    if (left < right) {
        if ((right - left) < k) {
                                    iSort.sort(A,left,right);
        } else {                
            m = Partition(A, left, right);
            hybridSort(A, left, m - 1);
            hybridSort(A, m, right);
        }
    }
}

private int Partition(int[] A, int left, int right) {
    int pivot = A[right];
    int i = left;
    int j = right;

    while (true) {
        while ((A[j] > pivot) && (j >= 0)) {
            j--;
        }
        while ((A[i] < pivot) && (i < A.length)) {
            i++;
        }
        if (i < j) {
            int swap = A[j];
            A[j] = A[i];
            A[i] = swap;
        } else {
            return i;
        }
    }
}

public void setK(int k) {
    this.k = k;
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:27:34.997

一些提示/可能的解决方案？：

我还没有阅读您的 QuickSort 或 HybridSort 实现，但我假设它们是正确的。

1.  如果您要比较两种算法的性能，您绝对应该将它们的性能与相同的输入进行比较。目前您正在生成两个随机数组（尽管大小相同）。这不一定是一个准确的测试，因为我可以很容易地找到一个测试用例，其中如果随机生成器要欺骗你，一种算法将优于另一种算法。

2.  在我看来，你比较这两种算法的逻辑有点奇怪和不正确。为什么要比较时间字符串的长度？根据您的逻辑，1 与 9 相同，1,000,000,000 与 9,999,999,999 相同，这显然是不正确的。一种算法几乎是另一种算法的 10 倍。

3.  此外，没有输出的一个原因可能是您仅在混合排序优于快速排序而不是相反时输出的原因。我相信还有其他原因，但这可能是一个容易引起注意的原因（如果您的实现不正确）。

    我确实注意到您关闭了输出流，这很好，因为这是没有输出的一个非常常见的原因。但是，您应该在 try-catch 部分关闭蒸汽，`finally`因为这样它们就保证会关闭。您可能会收到 IOException，在您的情况下，这也不会关闭输出组，因此不会导致文件中没有输出。

这是我在进行任何比较测试时会遵循的示例结构。它易于阅读且易于调试，具有足够的输出，可以让您找出哪种算法性能更好。这只是一个建议。

```
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintWriter;
import java.util.Random;

public class Tester {

  private static int[] initArray(int size) {
    Random rand = new Random();
    int[] arr = new int[size];
    for (int i = 0; i < arr.length; i++) {
      arr[i] = rand.nextInt();
    }
    return arr;
  }

  public static void main(String[] args) {
    final int MAX_ITERATIONS = 25;
    final int INITIAL_ARRAY_SIZE = 10;
    final int MAX_ARRAY_SIZE = 4500;
    final int ARRAY_SIZE_INCREMENT = 100;

    long start;
    int[] score = null;

    PrintWriter out = null;
    try {
      out = new PrintWriter(new FileOutputStream("out.txt"));
      for (int arraySize = INITIAL_ARRAY_SIZE; arraySize <= MAX_ARRAY_SIZE; arraySize += ARRAY_SIZE_INCREMENT) {
        // score[0] is for quickSort and score[1] is for hybridSort
        score = new int[2];
        for (int iteration = 0; iteration < MAX_ITERATIONS; iteration++) {
          int[] testArray = initArray(arraySize);
          int[] testArrayCopy = new int[arraySize];
          System.arraycopy(testArray, 0, testArrayCopy, 0, arraySize);

          start = System.nanoTime();
          // Do quicksort here using testArray
          long qSortfinish = System.nanoTime() - start;

          System.arraycopy(testArray, 0, testArrayCopy, 0, arraySize);
          start = System.nanoTime();
          // Do hybridsort here using testArrayCopy
          long hybridSortfinish = System.nanoTime() - start;

          // Keep score
          if (qSortfinish < hybridSortfinish)
            score[0]++;
          else if (qSortfinish > hybridSortfinish) {
            score[1]++;
          } else {
            score[0]++;
            score[1]++;
          }
        }
        out.println("Array Size: " + arraySize + " QuickSort: " + score[0] + " HybridSort: " + score[1]);
      }
    } catch (FileNotFoundException e) {
      e.printStackTrace();
    } finally {
      if (out != null)
        out.close();
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:05:26.853

您的实施`Partition`不正确。考虑下面的小测试（我`Partition` `static`为方便起见）。

两个`while`循环都不会执行，因为`A[i] == A[j] == pivot`. 此外，`i<j`, 所以这两个元素将被交换，从而产生完全相同的数组。因此，外`while`循环变为无限。

对于第一个和最后一个元素相同的任何数组，都会出现同样的问题。

```
public class Test {
    public static void main(String[] args) {
        int[] A = {1, 1};
        Partition(A, 0, 1);
    }

    private static int Partition(int[] A, int left, int right){
        int pivot = A[right];
        int i = left;
        int j = right;

        while (true) {
            while ( (A[j] > pivot)) {
                j--;
            }
            while ((A[i] < pivot)) {
                i++;
            }
            if (i < j){
                int swap = A[j];
                A[j] = A[i];
                A[i] = swap;
            }else{
                return i;
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T17:06:13.467

您是否尝试过增加内存设置以使您的代码在 Eclipse 中运行。您可能会发现此[设置从 Eclipse 运行的 Java 程序的内存](https://stackoverflow.com/questions/4175188/setting-memory-of-java-programs-that-runs-from-eclipse)很有帮助。

# javascript - 如何将选择设置为具有所选选项的宽度

> ID：16088266
> 
> 赞同：-2
> 
> 时间：2013-04-18T16:23:27.660
> 
> 标签：javascript, jquery, html, css, select

我有一个带有更多选项的选择元素。选择具有最长选项文本大小的宽度。如何将选择设置为具有所选选项的宽度？当我单击选择时，它应该具有相同的宽度（所选选项的），但其余选项应该具有最长选项文本大小的宽度。

期待感谢！

**编辑**

我发布了一个错误的问题。实际上，我正在寻找最简单的方法。CSS / JS / jQuery。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:58:34.907

只是我得到了选定的文本并将其包装在 a`span`中以获得它的长度，然后调整大小`select`

试试这个例子：

```
 <select id="sel">
         <option value="aaaa">aaaa</option>
         <option value="aaaaaaaa">aaaaaaaa</option>
         <option value="aaaaaaaaaaaa">aaaaaaaaaaaa</option>
         <option value="aaaaaaaaaaaaaaaa">aaaaaaaaaaaaaaaa</option>
         <option value="aaaaaaaaaaaaaaaaaaaa">aaaaaaaaaaaaaaaaaaaa</option>
     </select>

     <span id="hidnSpan">

     <span>

<script>

$(document).ready(function()
{
    $('#sel').change(function()
    {
        $('#sel').width( $('#hidnSpan').html($('#sel').find(":selected").text()).width())
    });
});

</script> 
```

# java - Android DroidDao 数据库管理器：我的代码还是他们的？

> ID：16088273
> 
> 赞同：0
> 
> 时间：2013-04-18T16:23:41.203
> 
> 标签：java, android

我在我的 Android 应用程序中使用 DroidDao 作为持久性 SQLite 数据库。

我有一个连接表：

```
PART_ID
GPS_ID
SAND_ID 
```

我在这个库中的两个函数有问题：

```
 /**Get an Object by clause*/
    public T getByClause(String clause, String[] clauseArgs) {
        T object = null;
        Cursor cursor = database.query(getTableName(), getArrayColumns(), 
                            clause, clauseArgs, null, null, "1");
        if(cursor.moveToFirst()){
            try {
                object = buildDataFromCursor(cursor);
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        if(! cursor.isClosed()){
            cursor.close();
        }               
        return object; 
    } 
```

和：

```
 /**List items by clause*/
    public List<T> getAllbyClause(String clause, String[] clauseArgs, String groupBy, String having, String orderBy) {              
            List<T> objectList = new ArrayList<T>();
            Cursor cursor = database.query(getTableName(), getArrayColumns(), 
                            clause, clauseArgs, groupBy, having, orderBy);
            if(cursor.moveToFirst()){
                    try {
                            do{
                                    T object = buildDataFromCursor(cursor);
                                    if(object != null){
                                            objectList.add(object);
                                    }
                            }
                            while(cursor.moveToNext());

                    } catch (Exception e) {
                            e.printStackTrace();
                    }
            }
            if(! cursor.isClosed()){
                    cursor.close();
            }               
            return objectList;
    } 
```

我像这样使用它们：

```
Connection connection = myApp.getDataManager().getConnectionDao().getByClause("PART_ID = ?", new String[]{"44"});
List<Connection> connections = myApp.getDataManager().getConnectionDao().getAllbyClause("PART_ID = ?", new String[]{"44"}, null, null, null); 
```

这两个函数都为 PART_ID、GPS_ID 和 SAND_ID 返回 0。即使我插入了一个不正确的 ID，函数应该返回 NULL，它仍然返回一个带有零的对象。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:58:06.940

好吧，我通过跟踪代码弄清楚了。

我想： buildDataFromCursor(cursor); 是来自 android 数据库导入的函数，但它是来自 DroidDao.java 的方法。我的问题是我的 Connection 对象中没有 SETTERS，其中 buildDataFromCursor(cursor); 使用 setter 将数据加载到对象中。

您的二传手需要具有以下结构：

```
Column name:
PART_ID

Setter:
void setPart_id(int value)... 
```

# linux - epoll 中被监视的文件描述符的数量

> ID：16088274
> 
> 赞同：5
> 
> 时间：2013-04-18T16:23:44.330
> 
> 标签：linux, epoll

我正在寻找一种方法来检查 epoll 实例正在监视的文件描述符的当前数量。我使用以下内容创建和填充 epoll 实例

```
epoll_create
epoll_ctl 
```

平台是 Gnu/Linux。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-29T08:35:34.487

据我所知，没有可用的系统调用可以提供 epoll 监视的文件描述符的计数。您可以通过维护一个计数器变量来实现这一点。使用 epoll_ctl() 成功将文件描述符添加/删除到 epoll 后，递增/递减此变量。

# python - 在scrapy中记录到特定的错误日志文件

> ID：16088279
> 
> 赞同：9
> 
> 时间：2013-04-18T16:24:07.990
> 
> 标签：python, logging, web-scraping, scrapy, scrapy-spider

我通过这样做来运行scrapy的日志：

```
from scrapy import log
class MySpider(BaseSpider):
  name = "myspider"  

  def __init__(self, name=None, **kwargs):
        LOG_FILE = "logs/spider.log"
        log.log.defaultObserver = log.log.DefaultObserver()
        log.log.defaultObserver.start()
        log.started = False
        log.start(LOG_FILE, loglevel=log.INFO)
        super(MySpider, self).__init__(name, **kwargs)

    def parse(self,response):
        ....
        raise Exception("Something went wrong!")
        log.msg('Something went wrong!', log.ERROR)

        # Somehow write to a separate error log here. 
```

然后我像这样运行蜘蛛：

```
scrapy crawl myspider 
```

这会将所有 log.INFO 数据以及 log.ERROR 存储到`spider.log`.

如果发生错误，我还想将这些详细信息存储在一个名为`spider_errors.log`. 这将更容易搜索发生的错误，而不是尝试扫描整个`spider.log`文件（可能很大）。

有没有办法做到这一点？

**编辑：**

尝试使用 PythonLoggingObserver：

```
def __init__(self, name=None, **kwargs):
        LOG_FILE = 'logs/spider.log'
        ERR_File = 'logs/spider_error.log'

        observer = log.log.PythonLoggingObserver()
        observer.start()

        log.started = False     
        log.start(LOG_FILE, loglevel=log.INFO)
        log.start(ERR_FILE, loglevel=log.ERROR) 
```

但我明白了`ERROR: No handlers could be found for logger "twisted"`

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-18T20:31:40.200

让[日志记录](http://docs.python.org/2/library/logging.html)完成这项工作。尝试使用`PythonLoggingObserver`而不是`DefaultObserver`：

*   直接在 python 中或通过 fileconfig 或通过 dictconfig配置两个记录器（一个用于消息`INFO`，一个用于消息）（请参阅[文档](http://docs.python.org/2/library/logging.config.html)）`ERROR`
*   在蜘蛛中启动它`__init__`：

    ```
    def __init__(self, name=None, **kwargs):
        # TODO: configure logging: e.g. logging.config.fileConfig("logging.conf")
        observer = log.PythonLoggingObserver()
        observer.start() 
    ```

如果您在配置记录器方面需要帮助，请告诉我。

编辑：

另一种选择是在以下位置启动两个文件日志观察器`__init__.py`：

```
from scrapy.log import ScrapyFileLogObserver
from scrapy import log

class MySpider(BaseSpider):
    name = "myspider"  

    def __init__(self, name=None, **kwargs):
        ScrapyFileLogObserver(open("spider.log", 'w'), level=logging.INFO).start()
        ScrapyFileLogObserver(open("spider_error.log", 'w'), level=logging.ERROR).start()

        super(MySpider, self).__init__(name, **kwargs)

    ... 
```

# php - 将字符串加载到 simplexmlelement

> ID：16088281
> 
> 赞同：0
> 
> 时间：2013-04-18T16:24:18.367
> 
> 标签：php

我正在尝试将一些数据发布到 Web 服务。显然我这边出了点问题，所以他们给我发了一些示例代码。该示例允许我手动输入数据并将其提交到他们的服务中。它工作并发送一个充满 XML 数据和一个用户/ID 的文本区域。我已经有一个页面设置来轮询我的数据库并提取未完成的订单。我正在尝试将 txnid 从贝宝发送到新页面，以便它可以编译 xml 并发送它。我想我可以删除用于失败方法的相同代码。xml 格式正确，但是当我尝试使用 SimpleXMLElement 函数时出现问题。这以前从文本字段传递的数据并且工作正常。现在我得到这个错误：

PHP 致命错误：未捕获的异常“异常”，消息“字符串无法解析为 XML”

这是给出错误的代码

```
include('connect-db.php');                                  

// get the records from the database
if ($result = $mysqli->query("SELECT * FROM paypal_payment_info WHERE txnid = '" .$_GET['txnid']. "'"))
{
    // display records if there are records to display
   if ($result->num_rows > 0)
    {
        $row = $result->fetch_object();

        // set up a row for each record

        $webOrderXML = "<WorkOrder>
                  <OrderID>127834</OrderID>
                  <OrderType>test</OrderType>
                  <ProjectCode> </ProjectCode>
                  <ProjectShipDate></ProjectShipDate>
                  <RetailerPO></RetailerPO>
                  <LineItems>
                    <LineItem>
                      <LineNumber>1</LineNumber>
                      <ProductCode>3PF-DD-SLPGZ6</ProductCode>
                      <ProductUPC></ProductUPC>
                      <ItemDescription>Filename</ItemDescription>
                      <Quantity>1</Quantity>
                      <ItemSSCC></ItemSSCC>
                      <FileList>
                <Source>/images/" . $row->itemname. str_replace(' ', "", str_replace('"', "", $row->os0)).  str_replace('"', "", $row->os1) . str_replace('"', "", $row->os2). ".jpg </Source>
                      </FileList>
                    </LineItem>
                  </LineItems>
                  <CustomerBillingInfo>
                  </CustomerBillingInfo>
                  <CustomerShippingInfo>
                    <Name>".$row->firstname. " " . $row->lastname."</Name>
                    <Address1>".$row->street."</Address1>
                    <Address2> </Address2>
                    <City>".$row->city."</City>
                    <State>".$row->state. "</State>
                    <PostalCode>".$row->zipcode."</PostalCode>
                    <Country>".$row->country."</Country>
                    <ShippingMethod>UPS</ShippingMethod>
                    <ShipAccountNum></ShipAccountNum>
                    <ShipType>MTH</ShipType>
                    <DC> </DC>
                  </CustomerShippingInfo>
                  <OrderProperties>
                  </OrderProperties>
                </WorkOrder>";                                      

    }
    // if there are no records in the database, display an alert message
    else
    {
            echo "No results to display!";
    }

}
// show an error if there is an issue with the database query
else
{
        echo "Error: " . $mysqli->error;
}

// close database connection
$mysqli->close();

//$WebOrderXML = $_POST['webOrderXML'];//orderxml

$sxml = new SimpleXMLElement($WebOrderXML); 

$orderidx = $sxml->OrderID; 
```

文字是一样的。我可以将生成的字符串复制并粘贴到其他表单中并发布。这很好用，但在某处我遗漏了一些东西，因为该函数不喜欢那个字符串。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:40:48.130

注意，如果您没有任何记录`$WebOrderXML`值，则`null`显示此异常

**致命错误**：未捕获的异常“异常”，消息“字符串无法解析为 XML”

因为`SimpleXMLElement()` `NULL`让步。你可以 用那个不是检查`$WebOrderXML`值， 你可以把控制异常 放在里面`empty()``$WebOrderXML``NULL``SimpleXMLElement()``try` `catch`

```
if(!empty($WebOrderXML)){
  try{
      $sxml = new SimpleXMLElement($WebOrderXML);
  }catch(Exception $e){
      //show error or do some work
  }
} 
```

# c - gcc中有128位整数吗？

> ID：16088282
> 
> 赞同：67
> 
> 时间：2013-04-18T16:24:21.670
> 
> 标签：c, gcc, x86-64, bigint, 128-bit

我想要一个 128 位整数，因为我想存储两个 64 位数字相乘的结果。gcc 4.4 及更高版本中有这样的东西吗？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2019-02-21T19:43:27.083

128 位整数类型**仅在 64 位目标上可用**，因此即使您已经检测到最近的 GCC 版本，您也需要检查可用性。理论上 gcc*可以*在需要 4 个 32 位寄存器来保存一个的机器上支持 TImode 整数，但我认为在任何情况下都不会。

* * *

**GCC 4.6 及更高版本将`__int128`/`unsigned __int128`定义为内置类型。** 用来
**`#ifdef __SIZEOF_INT128__`**检测它。

**GCC 4.1 及更高版本将`__int128_t`和定义`__uint128_t`为内置类型**。（你也不需要`#include <stdint.h>`这些[。Godbolt 上的](https://godbolt.org/#z:OYLghAFBqd5TKALEBjA9gEwKYFFMCWALugE4A0BIEAZugHZEDKqAhgDbYgCMALOQCse5dq3qhUAUgBMAIRmzyAZ2ydURAg2rZ6mAMLp2AVwC29EAGYAbOR2YAMgXrYAcqYBG2UsIAO6JcSa9AbGZpY2fgEaDI7Obiae3tzKqtjqQUxErKREIabm1ilq0fSZ2USxrh5ewkpZOXlhhXXllfGJPACUyuhGpKhcAOQA%2BsNGTkTc0gAcw0QA1HToEBPzAB6d85IA7LLzpNhEffTrkhby2wAig93sIIMArIPk5oMADM/o93oKCvNKvX62C20gs3GeRHuH063QA1pZpAA6B5WN5vB4ATj40jRNjug14zxMCMROO40wsvGmVlB0weFmkLyhn3uzyUIDe5Eh7xu5DgsBQGBMPgInAoVAgQpFYpAwF4U3INFFRC87Ig7mZ5HcTmyAE97uDyEKTDoiAB5ejsfU88g4ExiYCcTWEA7pABu2HZNuwazSRhVBueE1UmvYBHcpD1Bhwga5pAIxMG4O6dEYLA4XD4gmEonEaF%2BchE4fZkG66B8JS9AFozRY2al0loIHZGuZknY2tUkuRIoEGK3fP4%2B/ROwkaskVMUMvVcoZ8rUGyUyjlRx0JzOB%2BvWk4qmOkt0AX0Bl0RPcnkybV9BmtqVWrLx5sBUKh5rxEdxSfMIPhiGQQWDyHmAxhVFLx/24TYfjkBQIWZGFyCQbBWBwbwIFue5CXIYkrG2RFtgxaZuCsB5uAsbYrD4HCLw%2BcgrzZDkuTguESRRNFMWxXFT0GOtqJZQZYJ5bp%2BWQNB0BAsVKGoKVQO8YAMUZJV2BVUg1Q1G1tXoPVY2NU0LStZ1sHtcQnRtF00g0D0vRon0/QDJMg0YEMbTDCMoywIZDSIeNE2TRUGGYNgnSzIQLBEB182gwsXJLNDaIrIJq1respybFs5zCBUOx3doan4XsSk3Rl8qCVdcqKczp3KQrysbUoZ1K7x%2BBaBp0rbRlmoqbKuxAXgD0BY8IK489Xhoq8bysO8HyfF8MU/b9CBIUhwMA4DpTAmQLAsSCC1kAToWYiwHjwh5pjeCxpmkKwMQxCx5P4fFMOJbg0V42jWWUBjuWhPlEAgQUxLW8UpIBmS0FzOSXsU5TVM1DStPso0xJNRg9OtGi7QdEz0YIV0LM9TUbNQf0PIclV8RolzI1IXVoxJuME0DFN/PTIL%2BCERlwYi%2BQouLeAy3ihhEoseYq3tfokDOS4lFhXVRFhbBkoq1LdE3WxdAawcoiCVXipiLq9wXFK6qq1rDaV42V31tdlA3U2t0tuJusGw8gRPfFhs1Mbb3veZUHB%2BZZreRE3i/H9FuWoCQbFf9pG2yLdsYwTukQ5Cali%2BEwURKxCIxN5pBO06Hl4bZyK4zCRr4%2BjOS%2Bm50MGaQiR4F6K7e/jE/28gPRUoIeqAA%3D%3D)证明。）

我[在 Godbolt 编译器资源管理器上](https://godbolt.org/#g:!((g:!((g:!((h:codeEditor,i:(j:1,lang:c%2B%2B,source:'%23include+%3Cstdint.h%3E%0A%0A%23define+uint128_t+__uint128_t%0A//%23define+uint128_t+unsigned+__int128%0A%0Auint128_t+mul64(uint64_t+a,+uint64_t+b)+%7B%0A++++return+(uint128_t)a+*+b%3B%0A%7D%0A%0A%23ifdef+__SIZEOF_INT128__%0Aint+detected_ok()%7Breturn+1%3B%7D%0A%23endif%0A'),l:'5',n:'0',o:'C%2B%2B+source+%231',t:'0')),k:33.32694763729248,l:'4',m:100,n:'0',o:'',s:0,t:'0'),(g:!((g:!((h:compiler,i:(compiler:g412,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'1',trim:'1'),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!((name:boost,ver:'167')),options:'-xc+-O3',source:1),l:'5',n:'0',o:'x86-64+gcc+4.1.2+(Editor+%231,+Compiler+%231)+C%2B%2B',t:'0')),header:(),k:33.3397190293742,l:'4',m:56.14564870956661,n:'0',o:'',s:0,t:'0'),(g:!((h:compiler,i:(compiler:icc1301,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'1',trim:'1'),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!((name:boost,ver:'167')),options:'-xc+-O3+-xHOST',source:1),l:'5',n:'0',o:'x86-64+icc+13.0.1+(Editor+%231,+Compiler+%232)+C%2B%2B',t:'0')),header:(),l:'4',m:43.8543512904334,n:'0',o:'',s:0,t:'0')),k:33.3397190293742,l:'3',n:'0',o:'',t:'0'),(g:!((h:compiler,i:(compiler:clang30,filters:(b:'0',binary:'1',commentOnly:'0',demangle:'0',directives:'0',execute:'1',intel:'0',libraryCode:'1',trim:'1'),fontScale:1.2899450879999999,lang:c%2B%2B,libs:!((name:boost,ver:'167')),options:'-xc+-O3',source:1),l:'5',n:'0',o:'x86-64+clang+3.0.0+(Editor+%231,+Compiler+%233)+C%2B%2B',t:'0')),k:33.33333333333333,l:'4',m:100,n:'0',o:'',s:0,t:'0')),l:'2',n:'0',o:'',t:'0')),version:4)测试了第一个版本的编译器以支持这 3 个东西（在 x86-64 上）。Godbolt 只回溯到 gcc4.1、ICC13 和 clang3.0，所以我使用 <= 4.1 表示实际的第一次支持可能更早。

```
 legacy               recommended(?)    |  One way of detecting support
        __uint128_t   |  [unsigned]  __int128   |  #ifdef __SIZEOF_INT128__
gcc        <=  4.1    |       4.6               |     4.6
clang      <=  3.0    |       3.1               |     3.3
ICC        <=  13     |     <= 13               |     16\.  (Godbolt doesn't have 14 or 15) 
```

**如果您针对 ARM 或 x86 等 32 位架构进行编译，`-m32`则即使这些编译器的最新版本也不支持 128 位整数类型。** 因此，您*需要*在使用之前检测支持，如果您的代码在没有它的情况下完全可以工作。

我知道用于检测它的唯一直接 CPP 宏是`__SIZEOF_INT128__`，但不幸的是，一些旧的编译器版本支持它而没有定义它。（并且没有宏`__uint128_t`，只有 gcc4.6 风格`unsigned __int128`）。 [如何知道 __uint128_t 是否已定义](https://stackoverflow.com/questions/18531782/how-to-know-if-uint128-t-is-defined)

有些人仍然在 RHEL（RedHat Enterprise Linux）上使用古老的编译器版本，如 gcc4.4，或类似的老旧系统。如果你关心过时的 gcc 版本，你可能想坚持使用`__uint128_t`. 并且可能检测 64 位作为未定义`sizeof(void*) == 8`的后备。`__SIZEOF_INT128__`（我认为 GNU 系统总是有`CHAR_BIT==8`）。这将对 64 位 ISA（如 x86-64 Linux x32 或 AArch64 ILP32）上的 ILP32 ABI 产生误报，但这对于使用未定义`__SIZEOF_INT128__`.

可能有一些 64 位 ISA，其中 gcc 没有定义`__int128`，甚至可能有一些 32 位 ISA，其中 gcc*确实*定义`__int128`了，但我不知道。

* * *

正如对此处另一个答案的评论所指出的那样，GCC 内部是整数 TI 模式。（四整数 = 的 4 倍宽度`int`，与 DImode = 双倍宽度与 SImode = plain `int`。）正如[GCC 手册所指出的](https://gcc.gnu.org/onlinedocs/gcc/_005f_005fint128.html)，`__int128`在支持 128 位整数模式 (TImode) 的目标上受支持。

```
// __uint128_t is pre-defined equivalently to this
typedef unsigned uint128 __attribute__ ((mode (TI))); 
```

* * *

随机事实：ICC19 和 g++/clang++`-E -dM`定义：

```
#define __GLIBCXX_TYPE_INT_N_0 __int128
#define __GLIBCXX_BITSIZE_INT_N_0 128 
```

@MarcGlisse 评论说*，这是您告诉 libstdc++ 处理额外整数类型的方式（重载 abs、专门类型特征等）*

`icpc`即使使用（编译为 C，而不是 C++）也定义了这一点`-xc`，而 g++ -xc 和 clang++ -xc 则没有。但是使用实际编译`icc`（例如在 Godbolt 下拉菜单中选择 C ​​而不是 C++）并没有定义这个宏。

* * *

测试功能是：

```
#include <stdint.h>   // for uint64_t

#define uint128_t __uint128_t
//#define uint128_t unsigned __int128

uint128_t mul64(uint64_t a, uint64_t b) {
    return (uint128_t)a * b;
} 
```

支持它的编译器都可以有效地编译它，以

```
 mov       rax, rdi
    mul       rsi
    ret                  # return in RDX:RAX which mul uses implicitly 
```

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-04-18T16:31:29.550

啊，大整数不是 C 的强项。

GCC 确实有一个`unsigned __int128`/`__int128`类型，从版本 4.something 开始（这里不确定）。但是，我似乎确实记得`__int128_t`在那之前有一个定义。

这些仅在 64 位目标上可用。

（编者注：这个答案曾经声称 gcc 定义了`uint128_t`和`int128_t`。我在 Godbolt 编译器资源管理器上测试的所有版本都没有定义那些没有前导的类型`__`，从 gcc4.1 到 8.2 ，或者 clang 或 ICC。）

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-04-18T16:28:08.897

您可以使用处理任意或大精度值的库，例如[GNU MP Bignum Library](http://gmplib.org/)。

# r - 在 R 中将 pspline 项添加到 coxph 模型更改汇总表

> ID：16088283
> 
> 赞同：1
> 
> 时间：2013-04-18T16:24:23.117
> 
> 标签：r, knitr, spline, xtable, survival-analysis

我正在尝试使用 knitr/xtable 从报告中的 coxph() 对象生成表格。当我在模型中不包含 pspline 项时，一切都按预期工作。在单个块中：

```
<<results = 'asis'>>=
require(survival, quietly = T)
require(xtable, quietly = T)
data(cancer,  package = "survival")
fit0 <- coxph(Surv(time, status) ~ meal.cal + ph.ecog + age, cancer)
# construct data frame for tables - no spline
fit0table <- data.frame(Variable = c("Calories Consumed", "ECOG Performance Score","Age"), RiskRatio = summary(fit0)$conf.int[,1], Lower = summary(fit0)$conf.int[,3],   Upper = summary(fit0)$conf.int[,4], Pval = summary(fit0)$coeff[,5])
# print latex table
print(xtable(fit0table, digits = 3), include.rownames = F)
@ 
```

但是当我包含一个惩罚样条项时，summary() 对象的结构会发生变化，并且`$conf.int`and`$coeff`插槽不再可用。

```
> fit1 <- coxph(Surv(time, status) ~ meal.cal + ph.ecog + pspline(age, 3), cancer)
> str(summary(fit0))
List of 14
$ call        : language coxph(formula = Surv(time, status) ~ meal.cal + ph.ecog + age, data = cancer)
$ fail        : NULL 
$ na.action   :Class 'omit'  Named int [1:48] 3 5 12 13 14 16 23 25 33 44 ...
  .. ..- attr(*, "names")= chr [1:48] "3" "5" "12" "13" ...
$ n           : int 180
$ loglik      : num [1:2] -574 -567
$ nevent      : num 133
$ coefficients: num [1:3, 1:5] 3.84e-05 4.00e-01 1.10e-02 1.00 1.49 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:3] "meal.cal" "ph.ecog" "age"
  .. ..$ : chr [1:5] "coef" "exp(coef)" "se(coef)" "z" ...
$ conf.int    : num [1:3, 1:4] 1 1.491 1.011 1 0.671 ...
  ..- attr(*, "dimnames")=List of 2
  .. ..$ : chr [1:3] "meal.cal" "ph.ecog" "age"
.. ..$ : chr [1:4] "exp(coef)" "exp(-coef)" "lower .95" "upper .95"
$ logtest     : Named num [1:3] 13.2142 3 0.0042
..- attr(*, "names")= chr [1:3] "test" "df" "pvalue"
$ sctest      : Named num [1:3] 13.46468 3 0.00373
..- attr(*, "names")= chr [1:3] "test" "df" "pvalue"
$ rsq         : Named num [1:2] 0.0708 0.9983
..- attr(*, "names")= chr [1:2] "rsq" "maxrsq"
$ waldtest    : Named num [1:3] 13.28 3 0.00407  
..- attr(*, "names")= chr [1:3] "test" "df" "pvalue"
$ used.robust : logi FALSE
$ concordance : Named num [1:2] 0.6061 0.0291
..- attr(*, "names")= chr [1:2] "concordance.concordant" "se.std(c-d)"
- attr(*, "class")= chr "summary.coxph"

> str(summary(fit1))
Call: 
coxph(formula = Surv(time, status) ~ meal.cal + ph.ecog + pspline(age, 
3), data = cancer)

n= 180, number of events= 133 
(48 observations deleted due to missingness)

                        coef     se(coef) se2      Chisq DF   p     
meal.cal                3.65e-05 0.000228 0.000228 0.03  1.00 0.8700
ph.ecog                 3.98e-01 0.131938 0.131738 9.10  1.00 0.0026
pspline(age, 3), linear 1.07e-02 0.010694 0.010694 1.00  1.00 0.3200
pspline(age, 3), nonlin                            2.90  2.07 0.2500

          exp(coef) exp(-coef) lower .95 upper .95
meal.cal       1.00     1.0000     1.000      1.00
ph.ecog        1.49     0.6717     1.150      1.93
ps(age)3       1.75     0.5717     0.473      6.47
ps(age)4       3.03     0.3302     0.365     25.14
ps(age)5       4.49     0.2228     0.395     50.96
ps(age)6       4.65     0.2150     0.405     53.43
ps(age)7       3.96     0.2526     0.363     43.12
ps(age)8       3.84     0.2604     0.360     41.01
ps(age)9       4.44     0.2250     0.413     47.84
ps(age)10      5.39     0.1855     0.486     59.82
ps(age)11      7.94     0.1260     0.599    105.23
ps(age)12     12.25     0.0816     0.537    279.91

Iterations: 4 outer, 12 Newton-Raphson
     Theta= 0.836 
Degrees of freedom for terms= 1.0 1.0 3.1 
Concordance= 0.616  (se = 0.029 )
Rsquare= 0.092   (max possible= 0.998 )
Likelihood ratio test= 17.5  on 5.06 df,   p=0.00389
Wald test            = 15.9  on 5.06 df,   p=0.0073
 NULL

> coefficients(fit1) # doesn't give p-values
meal.cal      ph.ecog     ps(age)3     ps(age)4     ps(age)5     ps(age)6         ps(age)7     ps(age)8 
3.647054e-05 3.980039e-01 5.590767e-01 1.108052e+00 1.501557e+00 1.537249e+00     1.375833e+00 1.345564e+00 
ps(age)9    ps(age)10    ps(age)11    ps(age)12 
1.491454e+00 1.684622e+00 2.071641e+00 2.505932e+00 

> confint(fit1) # getting closer
                  2.5 %       97.5 %
meal.cal  -0.0004104346 0.0004833757
ph.ecog    0.1394097867 0.6565980826
ps(age)3  -0.7493022459 1.8674555679
ps(age)4  -1.0084545140 3.2245588375
ps(age)5  -0.9278798219 3.9309933396
ps(age)6  -0.9038092211 3.9783071434
ps(age)7  -1.0122388810 3.7639051908
ps(age)8  -1.0226368192 3.7137644105
ps(age)9  -0.8849251510 3.8678337954
ps(age)10 -0.7221442743 4.0913878825
ps(age)11 -0.5129062130 4.6561876883
ps(age)12 -0.6226068259 5.6344701023 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:13:47.593

我认为没有一个数字（甚至两个或三个）可以有意义地描述适合包含在表格中的惩罚样条项的置信区间，我当然会（编辑：意思是说*不是*）认为 confint 产生的一长串区间是有意义的。（没有`confint.coxph.penal`功能。）当 7 年前在 R-help 上提出类似的问题（尽管是要求图形显示）时，Terry Therneau 发布了这段代码，用于显示他认为有意义的内容，我已将其修改为适合您的姓名并显示“年龄”的适合度和 CI：

```
fit1 <- coxph(Surv(time, status) ~ meal.cal + ph.ecog + pspline(age, 3), na.omit(cancer) )
temp <- predict(fit1, type='terms', se=TRUE) 
matplot(na.omit(cancer)$age, exp(cbind( temp$fit[, 3], 
                                  temp$fit[,3] - 2* temp$se.fit[,3], 
                                  temp$fit[,3] + 2* temp$se.fit[,3])), 
        log='y', xlab="Age", ylab="Estimated Relative Risk", col=c('red',"blue","blue") ) 
```

![在此处输入图像描述](https://i.stack.imgur.com/H2XVH.png)

`summary(fit0)`顺便说一句： except没有返回任何内容`invisible()`，因此您所看到的只是通过调用`str(summary(fit1))`发送到控制台的输出，然后是那个孤独的 little 。如果您怀疑我的真实性，只需使用.`cat``NULL``getAnywhere(summary.coxph.penal)`

# gradle - 在哪里下载 Netflix Astyanax 依赖项？

> ID：16088286
> 
> 赞同：0
> 
> 时间：2013-04-18T16:24:31.090
> 
> 标签：gradle, astyanax

我想将 Astyanax 包含在我的项目中。我从 github 签出代码并用“gradlew build”编译它。我不熟悉gradle。

我将 Astyanx jar 文件手动包含到我的项目中。当我运行它时，它抱怨缺少 Jar。

我想知道，在哪里可以下载 Astyanax 的所有依赖包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T03:24:40.287

Java 库项目通常不为其依赖项提供单个下载位置。相反，您通常会为您自己的项目使用支持 Maven 存储库（例如 Maven 或 Gradle）的构建工具，然后该工具会在后台自动下载所需的依赖项。

如果您确实想获取 Astyanax 项目的所有依赖项，请尝试将以下内容添加到其`build.gradle`：

```
task copyLibs(type: Copy) {
    from configurations.runtime
    into "libs"
} 
```

然后运行`gradlew copyLibs`应该将所有（编译和运行时）依赖项复制到`libs`目录中。

# c# - 发出 http post 请求以在 WP7 中发送 JSON 文件

> ID：16088288
> 
> 赞同：2
> 
> 时间：2013-04-18T16:24:35.897
> 
> 标签：c#, windows-phone-7, post, http-headers, httpwebrequest

我想发一个`JSON file from my WP7 device to my local server`。在 iOS 上，我使用了该`ASIHttpRequest`库，我所做的是：

```
//send json file , using ASIHttpClass
NSURL *url = [NSURL URLWithString:urlStr];
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
request.timeOutSeconds = TIME_OUT_SECONDS;
[request setRequestMethod:@"PUT"];

NSString *credentials= [self encodeCredentials];
[request addRequestHeader:@"Authorization" value:[[NSString alloc] initWithFormat:@"Basic %@",credentials]];
[request addRequestHeader:@"Content-Type" value:@"application/json; charset=utf-8"];        

[request appendPostData:[jsonString dataUsingEncoding:NSUTF8StringEncoding]];
[request startSynchronous];

if([request responseStatusCode]==200){
   return true;
} else {
     return false;
    } 
```

如何在我的 WP7 应用程序中实现相同的功能？

到目前为止我发现了什么，我想我已经接近了：

```
//Making a POST request using WebClient.

Function()
{    
  WebClient wc = new WebClient();

  var URI = new Uri("http://your_uri_goes_here");

  wc.Headers["Authorization"] = "Basic (here goes my credentials string which i have)";

  wc.Headers["Content-Type"] = "application/json; charset=utf-8";

 wc.UploadStringCompleted += new UploadStringCompletedEventHandler(wc_UploadStringCompleted);

 wc_cart_session.UploadStringAsync(URI,"POST","Data_To_Be_sent");    

} 
```

在哪里 ：

```
void wc__UploadStringCompleted(object sender, UploadStringCompletedEventArgs e)
{  
  try            
  {          
     MessageBox.Show(e.Result); 
//e.result fetches you the response against your POST request.
 }
  catch(Exception exc)         
  {             
     MessageBox.Show(exc.ToString());            
  }
} 
```

我想“Data_to_be_Sent”应该是utf8编码的jsonString？

## 编辑

* * *

我注意到这`"Data_To_Be_sent"`是一个字符串。然而这应该是UTF8编码吧？所以它应该是一个 UTF8 格式的字节数组。但是我只能在那里放置一个字符串。我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T12:44:18.887

该类`WebClient`具有和方法使用的[Encoding](http://msdn.microsoft.com/en-us/library/system.net.webclient.encoding%28v=vs.95%29.aspx)属性。在那里设置你的编码。`UploadStringAsync``DownloadStringAsync`

```
wc.Encoding = Encoding.UTF8;

wc.UploadStringCompleted += new UploadStringCompletedEventHandler(wc_UploadStringCompleted);   

wc.UploadStringAsync(URI,"POST","Data_To_Be_sent"); 
```

# django - Django Tastypie 反序列化多部分/表单数据以上传文件

> ID：16088289
> 
> 赞同：2
> 
> 时间：2013-04-18T16:24:37.240
> 
> 标签：django, tastypie

我正在尝试通过 Multipart/Form-Data 表单和 Tastypie API 上传文件，但遇到了一些问题：

我的模型：

```
class Client(models.Model):
    account = models.ForeignKey(Account)
    client_image = models.FileField(upload_to=client_image_path, default="/assets/img/default-user-image.png", blank=True, null=True)
    client_image_thumb = models.FileField(upload_to=client_image_thumb_path, default="/assets/img/default-user-image.png", blank=True, null=True) 
```

我正在使用 Tastypie Issue#42 中概述的自定义反序列化方法：

```
class MultipartResource(object):
    def deserialize(self, request, data, format=None):
        if not format:
            format = request.META.get('CONTENT_TYPE', 'application/json')

        if format == 'application/x-www-form-urlencoded':
            return request.POST

        if format.startswith('multipart'):
            data = request.POST.copy()
            data.update(request.FILES)
            return data

        return super(MultipartResource, self).deserialize(request, data, format)

    def put_detail(self, request, **kwargs):
        if request.META.get('CONTENT_TYPE').startswith('multipart') and \
                not hasattr(request, '_body'):
            request._body = ''

        return super(MultipartResource, self).put_detail(request, **kwargs) 
```

这是我对应的ModelResource：

```
class ClientResource(MultipartResource, ModelResource):
    account = fields.ForeignKey(AccountResource, 'account')

    class Meta():
        queryset = Client.objects.all()
        always_return_data = True
        resource_name = 'account/clients/client-info'
        authorization = AccountLevelAuthorization()
        list_allowed_methods = ['get','post','put','delete','patch']
        detail_allowed_methods = ['get', 'post', 'put', 'delete','patch']
        authentication = ApiKeyAuthentication()
        filtering = {
            'username': ALL,
        } 
```

如果我使用内容类型应用程序/JSON 进行 POST 并且不包含 client_image 字段，它将成功创建一个新的客户端对象。这表明模型/资源正在正常工作。

但是，当我尝试使用 Multipart/Form-Data 内容类型时，我可以看到它通过此有效负载适当地通过了我的反序列化器：

```
------WebKitFormBoundaryp0Q7Q9djlsvVGwbb
Content-Disposition: form-data; name="{%0D%0A%22account%22"

"/api/v1/account/account-info/21/",

------WebKitFormBoundaryp0Q7Q9djlsvVGwbb
Content-Disposition: form-data; name="client_image"; filename="donavan.jpg"
Content-Type: image/jpeg

------WebKitFormBoundaryp0Q7Q9djlsvVGwbb-- 
```

我在调试时也看到了这个 QueryDict，它正确显示了 InMemoryUploadedFile：

```
<QueryDict: {u'client_image': [<InMemoryUploadedFile: donavan.jpg (image/jpeg)>], u'{%0D%0A%22account%22': [u'"/api/v1/account/account-info/21/"']}> 
```

但我不断收到此错误：

> { error_message：“”回溯：“回溯（最近一次通话最后一次）：文件“/Users/stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/resources.py”，第 202 行，在包装响应 = 回调（请求，*args，**kwargs）文件“/Users/stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/resources.py”，第 440 行, 在 dispatch_list 返回 self.dispatch('list', request, **kwargs) 文件 "/Users/stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/resources.py",第 472 行，在调度响应 = 方法（请求，**kwargs）文件“/Users/stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/resources.py”中，第 1328 行，在 post_list updated_bundle = self.obj_create(bundle, **self.remove_api_resource_names(kwargs)) 文件“/Users/stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/resources.py”，第 2104 行，在 obj_create bundle = self.full_hydrate(bundle)文件“/Users/stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/resources.py”，第 890 行，full_hydrate 值 = field_object.hydrate(bundle) 文件“/Users/ stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/fields.py”，第 732 行，水合物值 = super(ToOneField, self).hydrate(bundle) 文件“/Users/ stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/tastypie/fields.py”，第 165 行，水合物 elif self.attribute 和 getattr(bundle.obj, self.attribute, None)：文件“/Users/stevewirig/Documents/www/vu/venv/lib/python2.7/site-packages/django/db/models/fields/related.py”，第 343 行，在**得到**提高 self.field.rel.to.DoesNotExist DoesNotExist " }

有什么想法可以打破吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-13T22:28:06.547

当我在未提供必要字段的情况下发布数据时，这发生在我身上。发布时必须提供那些不能为空的字段。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-21T11:52:35.013

初始化序列化器如下：

`serializer = Serializer(formats=['json'])`

# c++ - 带有repl的C++ IDE？

> ID：16088295
> 
> 赞同：16
> 
> 时间：2013-04-18T16:24:49.850
> 
> 标签：c++, ide, read-eval-print-loop

我正在寻找带有 REPL 的优秀 C++ IDE。视觉工作室中的那个不是......好吧，大多数时候如果我在源代码中复制/粘贴一行，REPL 会拒绝它，即使它是我放置断点或跳过的行。

C++ 有没有好的 IDE 或 REPL？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-18T16:34:53.240

## 紧贴

### 什么是紧贴？

Cling 是一个交互式 C++ 解释器，构建在 LLVM 和 Clang 库之上。与标准解释器相比，它的优势在于它具有命令行提示符并使用即时 (JIT) 编译器进行编译。这类软件应用程序的许多开发人员（例如 Mono 在他们的项目中称为 CSharpRepl）将它们命名为交互式编译器。

Cling 的主要目标之一是在 ROOT 项目 - CINT 中提供当前 C++ 解释器的现代、高性能替代方案。与 CINT 的向后兼容性是开发过程中的主要优先事项。

[http://root.cern.ch/drupal/content/cling](http://root.cern.ch/drupal/content/cling)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-18T16:33:47.750

## CINT

### 什么是 CINT？

CINT 是 C 和 C++ 代码的解释器。例如，对于快速开发比执行时间更重要的情况，它很有用。使用解释器可以大大减少编译和链接周期，从而促进快速开发。CINT 使 C/C++ 编程变得愉快，即使是兼职程序员也是如此。

CINT 本身是用 C++ 编写的，代码行数略少于 400,000 行。它被银行、集成设备甚至游戏环境中的多家公司用于生产，当然还有ROOT，使其成为全球大量高能物理学家的默认解释器。

[http://www.hanno.jp/gotom/Cint.html](http://www.hanno.jp/gotom/Cint.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-04-30T14:28:28.967

CLing should be independant of Clang and abble to compile on any platform, recent works of CERN tend to separate Cling from Clang and it's good trends.

What I don't under is mostly the existence of Clipp in C++ allowing to parse javascript embedded in my C++ code and can't find a version of Clipp for just C++ / Boost / Eigen / Quantlib.

Another thing I don't understand is why TinyCC with a 200ko size is abble to parse windows.h without a problem and LLVM team complaining about Clang on windows.H detonate on tarmac.

All in all, with fusion, spirit, wave and the so many people wishing for a C++ REPL, why after 2 decade there is not even small version of it.

Here is my solutions

Forget about REPL C++ and stick to REPL C, use tinyCC and expose only the functionnal action of method by using pointer function A.function(toto t) -> function(A *, toto t). To make it works with object method you can also use declaration as struct __declspec(novtable) A { };

This will allow binary align compatibility between tinyCC struct understanding and your true object. True you will have to split the tuple of data and the tuple of method, but after all, that should have always be the case in first place. Object design should have split data and method into a dual model rather than a mixed model good for bug. In many case, the compiler will split the object into dual model anyway. This will provide extrem fast prototyping even for scientist and user of Cling/Cint.

Second solution, rather than REPL statement, use the dynamic load/unload pair, you setup a chain of compilation ( incremental build or not ) and auto relink compiled library when the source change. It isn't slow at all. This give the advantage to do it on any supported dynamic library OS and it's very EASY to do.

Third solution, the most easiest way, boot a linux based vm ( install llvm tool chain), and use Cling on the vm. That won't work in a firm full windowOSed but it seems LLVM are windows OS haters.

# php - 如果不是从包含运行的代码，则运行代码

> ID：16088300
> 
> 赞同：2
> 
> 时间：2013-04-18T16:25:02.843
> 
> 标签：php

page1.php：

```
include 'page2.php';
echo $info; 
```

page2.php：

```
$info = "some info";
if(!included){
  echo 'Why are you on this page?';
} 
```

的目标`if(!included){`是确定是否`page2.php`通过`include`in加载`page1.php`，或者用户是否直接请求该页面。文档中没有返回此类值的函数。我怎样才能创建这样的功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T16:27:04.727

你基本上有两个选择：

a) 检查`debug_backtrace`您是否被包括在内

```
$bt = end(debug_backtrace()); // supposing that you don't include in functions / from other included files etc...
if (!empty($bt) && in_array($bt["function"], array("include", "include_once", "require", "require_once"))) {
    // you're being included!
} 
```

b) 在 page1.php 中定义一些常量、变量等并检查 page2.php 是否存在（`defined`或`isset`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:30:41.713

```
if (__FILE__ == $_SERVER['SCRIPT_FILENAME']) {
   echo "wild and free!";
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:32:04.223

窃取/同意 bwoebi，您可以定义。

在 page1.php 中：

```
define("PAGE1_NOT_USER", true); 
```

在 page2.php 中，对于您只想在用户请求上运行的代码：

```
if(!defined("PAGE1_NOT_USER"))
{
    <code here>
} 
```

我的 PHP 生锈了，但这应该可以解决问题。调试选项涵盖了所有基础：我的只是涵盖了这个（以及您可能使用定义的任何其他地方）。

# opencv - What is the difference between the fundamental, essential and homography matrices?

> ID：16088301
> 
> 赞同：36
> 
> 时间：2013-04-18T16:25:02.813
> 
> 标签：opencv, transform, homography, perspectivecamera, projective-geometry

I have two images that are taken from different positions. The 2nd camera is located to the right, up and backward with respect to 1st camera.

**So I think there is a perspective transformation between the two views and not just an affine transform since cameras are at relatively different depths**. Am I right?

I have a few corresponding points between the two images. I think of using these corresponding points to determine the transformation of each pixel from the 1st to the 2nd image.

I am confused by the functions [findFundamentalMat](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#findfundamentalmat) and [findHomography](http://docs.opencv.org/modules/calib3d/doc/camera_calibration_and_3d_reconstruction.html#findfundamentalmat). Both return a 3x3 matrix. **What is the difference between the two?**

Is there any condition required/prerequisite to use them (when to use them)?

Which one to use to transform points from 1st image to 2nd image? In the 3x3 matrices, which the functions return, do they include the rotation and translation between the two image frames?

From [Wikipedia](http://en.wikipedia.org/wiki/Fundamental_matrix_%28computer_vision%29), I read that the fundamental matrix is a relation between corresponding image points. In an SO answer [here](https://stackoverflow.com/questions/10386382/use-fundamental-matrix-to-compute-coordinates-translation-using-opencv?rq=1), it is said the essential matrix E is required to get corresponding points. But I do not have the internal camera matrix to calculate E. I just have the two images.

How should I proceed to determine the corresponding point?

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-05-28T13:14:20.417

如果没有对世界场景几何的任何额外假设，**您无法确定两个视图之间存在射影变换**。仅当场景是平面时才适用。关于该主题的一个很好的参考是Hartley 和 Zisserman 所著[*的《计算机视觉中的多视图几何》一书。*](http://www.robots.ox.ac.uk/~vgg/hzbook/index.html)

如果世界场景不是平面的，你绝对不应该使用 findHomography 函数。您可以使用 findFundamentalMat 函数，该函数将为您提供基本矩阵 F 的估计。该矩阵描述了两个视图之间的对极几何。您可以使用 F 来校正您的图像，以便应用立体算法来确定密集对应图。

我假设您使用“透视变换”一词来表示“投影变换”。据我所知，透视变换是**世界到图像**的映射，而不是图像到图像的映射。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-06-21T20:29:00.523

只有两种情况下两个视图之间的变换是投影变换（即单应性）：场景是平面的，或者两个视图是由围绕其中心旋转的相机生成的。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-06-06T07:10:11.660

基本矩阵的关系 **是 x'Fu = 0** ，其中一个图像中的 x 和另一个图像中的 u 如果 x 和 u 是同一 3d 点的投影。**l = Fu**还 定义了一条线 ( **lx' = 0** )，其中 u 的对应点必须在其中，因此它可用于限制对应关系的搜索空间。

Homography 将平面的一个投影上的点映射到平面的另一个投影。 **x = 胡**

# show-hide - jQuery toggle show/hide - div shows but does not expand

> ID：16088303
> 
> 赞同：0
> 
> 时间：2013-04-18T16:25:05.983
> 
> 标签：show-hide, jquery

I have a little menu that should expand to reveal the HTML below, which is hidden at present.

Following jQuery:

```
$('.mobileMenu').click(function(e) {
    $(this).toggleClass('arrowDown').next().slideToggle('slow');
}); 
```

This piece of code works great on [this page](http://www.haselden.co.uk/rttest/inner.html) (click the "hide" feature on the left col)

However I need to utilise the same feature with my menu for "mobile width".

If you resize your browser down to 320 or so and go [here](http://www.haselden.co.uk/rttest/index.html) you'll see the menu is just +menu (bit smashy at the mo but working). Click it, and the menu does expand to show the links, the first being "shop online" but for some reason they are hidden/not showing. Ideally the green `navigation` div should expand

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:44:16.307

其余的菜单项需要`display: block`，目前只有最上面的项目有它。

# forms - Autopopulate a form using hyperlink

> ID：16088305
> 
> 赞同：0
> 
> 时间：2013-04-18T16:25:08.123
> 
> 标签：forms, auto-populate

I'm looking to autopopulate a search form entry using just a hyperlink. I do not have access to site in question and when the form is filled in manually the link is [http://siteinquestion.com/search](http://siteinquestion.com/search)

As an example it would be a case of adding a link to google.com that then automatically searched for the term I put in the link e.g. [http://www.google.com/mysearchterm](http://www.google.com/mysearchterm)

Any advice appreciated.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:35:44.373

**更新，这不适用于相关网站。如果您尝试这样做，请记住清除您的历史记录并使用隐私浏览。叹。

好的，一旦我意识到自动填充是一个标签，就找到了答案。答案可以在这里找到：

[在目标页面上创建一个自动填充字段的链接](https://stackoverflow.com/questions/8252222/create-a-link-that-automatically-fills-a-field-on-the-target-page)

简而言之，使用 firebug 或等效工具来查找表单的输入 ID。然后使用查询字符串完成表单。

在这种情况下，它看起来像这样：

[http://www.somesite.com/search?quickSearchText=texttosearchwith](http://www.somesite.com/search?quickSearchText=texttosearchwith)

其中 quickSearchText 是输入 ID

# python - 如果在 Python 中使用“打印”打开文件，则无需关闭文件？

> ID：16088307
> 
> 赞同：3
> 
> 时间：2013-04-18T16:25:11.463
> 
> 标签：python, file

我通常使用：

```
f = open(path,'w')
print >> f, string
f.close() 
```

但是，我在其他代码中看到：

```
print >> open(path,'w'), string 
```

也很好用。

那么，如果使用“打印”打开文件，我们不必关闭文件？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T16:26:09.123

是的，您仍然需要关闭文件。*与print*没有区别。

关闭文件会将数据刷新到磁盘并释放文件句柄。

*在 CPython 中，当f*的引用计数降至零时，系统将为您执行此操作。在 PyPy、IronPython 和 Jython 中，您需要等待垃圾收集器运行（用于自动关闭文件）。与其采用依赖内存管理器自动关闭的脆弱做法，不如让您控制文件的关闭。

由于显式关闭文件是一种最佳实践，Python 为文件对象提供了一个上下文管理器，这使得它非常容易：

```
with open(path, 'w') as f:
    print >> f, string 
```

[当您离开with-statement](http://www.python.org/dev/peps/pep-0343/)的主体时，这将关闭您的文件。

# sql - Bulk Import of CSV into SQL Server

> ID：16088311
> 
> 赞同：1
> 
> 时间：2013-04-18T16:25:15.783
> 
> 标签：sql, sql-server, csv

I am having a .CSV file that contain more than 1,00,000 rows.

I have tried the following method to Import the CSV into table "Root"

```
BULK INSERT  [dbo].[Root] 
FROM 'C:\Original.csv'
WITH
(
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n'
) 
```

But there are so many errors like check your Terminators.

I opened the CSV with Notepad.

There is no Terminator `,` or `\n`. I find at end of the row a square box is there.

please help me to import this CSV into table.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:36:08.497

[http://msdn.microsoft.com/en-us/library/ms188609.aspx](http://msdn.microsoft.com/en-us/library/ms188609.aspx)

SQL Server 大容量导入操作不支持逗号分隔值 (CSV) 文件。但是，在某些情况下，可以将 CSV 文件用作将数据批量导入 SQL Server 的数据文件。请注意，CSV 文件的字段终止符不必是逗号。要用作批量导入的数据文件，CSV 文件必须符合以下限制：

*   数据字段从不包含字段终止符。
*   数据字段中的任何值或所有值都用引号 ("") 括起来。

注意：可能还有其他看不见的字符需要从源文件中删除。VIM (command ":set list") 或 Notepad++(View > Show Symbol > Show All Characters) 是两种检查方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:53:34.283

如果您熟悉 Java，我已经编写了一组用于 CSV 操作的工具，包括导入器和导出器。该项目已在 Github.com 上发布：

[https://github.com/carlspring/csv-db-tools](https://github.com/carlspring/csv-db-tools)

进口商在这里：

[https://github.com/carlspring/csv-db-tools/tree/master/csv-db-importer](https://github.com/carlspring/csv-db-tools/tree/master/csv-db-importer)

有关如何使用导入器的说明，请查看：

[https://github.com/carlspring/csv-db-tools/blob/master/csv-db-importer/USAGE](https://github.com/carlspring/csv-db-tools/blob/master/csv-db-importer/USAGE)

您将需要制作一个简单的映射文件。可以在这里看到一个例子：

[https://github.com/carlspring/csv-db-tools/blob/master/csv-db-importer/src/test/resources/configuration-large.xml](https://github.com/carlspring/csv-db-tools/blob/master/csv-db-importer/src/test/resources/configuration-large.xml)

# ios - iOS 交互式地图应用程序？

> ID：16088317
> 
> 赞同：0
> 
> 时间：2013-04-18T16:25:23.280
> 
> 标签：ios, map, mapkit, interactive

我正在尝试制作一个应用程序，它是我高中的地图，用户可以在其中单击按钮来搜索房间或储物柜......我的目标是让房间/储物柜号码对应于Nib文件/显示器上不同区域的几个隐藏“数字行”上的一个点，当收到某个输入时，相应的数字会亮起或显示其位置（即我不必输入每个储物柜位置例如，每个走廊中只有第一个和最后一个，并且在我输入的值之间生成的数字线将代表中间的所有储物柜）。

如果有帮助，我正在使用 Xcode 4.3.3.... 结构方面，我想使用选项卡式应用程序模板，并有一个用于实际地图的选项卡，一个用于输入您正在寻找的储物柜，一个用于输入你想找哪个房间。我是 iOS 编程新手，所以我不知道是否有更好的方法来完成这样的事情，我愿意接受任何建议或建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:34:15.470

您可以将[MapKit](https://developer.apple.com/library/ios/#documentation/MapKit/Reference/MapKit_Framework_Reference/_index.html)与您自己的数据库结合起来，您可以在其中定义房间、储物柜等的坐标。请参阅[位置感知编程指南](http://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/LocationAwarenessPG/)，其中展示了如何将地图集成到应用程序中。我可以想象你可以[`MKOverlay`](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKOverlay_protocol/Reference/Reference.html)为房间和储物柜范围定义对象。或者您可以简单地[`MKAnnotation`](http://developer.apple.com/library/ios/#documentation/MapKit/Reference/MKAnnotation_Protocol/Reference/Reference.html)为兴趣点（自助餐厅等）定义对象。

但是使用 MapKit 的一些覆盖和注释的组合似乎是一个合乎逻辑的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T20:37:48.073

您也可以使用[MapBox iOS SDK以及](http://mapbox.com/mobile)[http://mapbox.com/tilemill/docs/crashcourse/tooltips/](http://mapbox.com/tilemill/docs/crashcourse/tooltips/)中所述的交互层来执行此操作

# java - Android：在 SherlockActivity 中调用了 onOptionsItemSelected()，但在 SherlockFragmentActivity 中没有

> ID：16088318
> 
> 赞同：1
> 
> 时间：2013-04-18T16:25:23.930
> 
> 标签：java, android

SherlockFragmentActivity 中的 onOptionsItemSelected() 有问题。调用了 onCreateOptionsMenu() 并且完美地构建了选项菜单，但是当我单击选项项目时，不会调用 onOptionsItemSelected() 。

我在使用 SherlockActivity 的测试项目中尝试了相同的以下代码，并且它可以工作：

```
 @Override
    public boolean onCreateOptionsMenu(Menu menu) {

    menu.add(0, 1, 0, "hi").setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM | MenuItem.SHOW_AS_ACTION_WITH_TEXT);
    menu.add(0, 1, 0, "ha").setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER | MenuItem.SHOW_AS_ACTION_NEVER);

    return true;
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        if (item.getItemId() == 1) {
            // Do someting!

        }
        return true;
    } 
```

在这两种情况下，都会完成以下导入：

```
 import com.actionbarsherlock.app.ActionBar;
   import com.actionbarsherlock.view.Menu;
   import com.actionbarsherlock.view.MenuItem; 
```

有谁知道帮助？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:42:23.120

我认为这是因为您没有设置[MenuItemClickListener](http://developer.android.com/reference/android/view/MenuItem.html#setOnMenuItemClickListener%28android.view.MenuItem.OnMenuItemClickListener%29)（您在代码中创建项目）。但是，如果您[从 xml 定义菜单，](http://developer.android.com/guide/topics/ui/menus.html#xml) Android 将设置侦听器并在单击时触发 onOptionsItemSelected。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:23:21.383

谢谢！现在我复制了项目并重建了我的 SherlockFragmentActivity 并发现了问题。我的类已经包含公共布尔 onMenuItemSelected(int featureId, MenuItem item)，这将被调用而不是 onOptionsItemSelected。我需要这个，因为操作栏左上角的后退按钮。

# asp.net-mvc - ASP.NET MVC4 Unity - 解决对另一个项目的依赖关系

> ID：16088323
> 
> 赞同：1
> 
> 时间：2013-04-18T16:25:39.037
> 
> 标签：asp.net-mvc, dependency-injection, unity-container

我的项目 MVC4 Unity 中有这个配置和驱动程序的通用配置。

引导程序.cs

```
namespace MyProyect.Web
{
    public static class Bootstrapper
    {
        public static void Initialise()
        {
            var container = BuildUnityContainer();
            ServiceLocator.SetLocatorProvider(() => new UnityServiceLocator(container));
            DependencyResolver.SetResolver(new UnityDependencyResolver(container));
            GlobalConfiguration.Configuration.DependencyResolver = new Unity.WebApi.UnityDependencyResolver(container);
        }

        private static IUnityContainer BuildUnityContainer()
        {
            var container = new UnityContainer();

            container.RegisterType<MyProyect.Model.DataAccessContract.ICountryDao, MyProyect.DataAccess.CountryDao>();
            container.RegisterType<MyProyect.Model.DataAccessContract.IContactDao, MyProyect.DataAccess.ContactDao>();

            return container;
        }
    }
} 
```

全球.asax：

```
 protected void Application_Start()
    {
        ...  
        Bootstrapper.Initialise();
        ...  
    } 
```

GenericModelBinder.cs：

```
namespace MyProyect.Web.ModelBinder
{
    public class GenericModelBinder : DefaultModelBinder//, IValueProvider
    {
        protected override object CreateModel(ControllerContext controllerContext, ModelBindingContext bindingContext, Type modelType)
        {
            var resolver = (Unity.Mvc4.UnityDependencyResolver)DependencyResolver.Current;
            if (modelType == null)
            {
                return base.CreateModel(controllerContext, bindingContext, null);
            }

            return resolver.GetService(modelType);
        }
    }
} 
```

现在我需要解决解决方案中另一个项目中的依赖关系。我的问题是如何才能识别另一个项目中的 Unity 设置？我目前有这个类，但当前配置没有引入 MVC 项目。

```
namespace MyProyect.Model.ListData
{
    public abstract class ListDataGenericResolver
    {
        protected T ResolverType<T>()
        {
            IUnityContainer container = new UnityContainer();
            UnityServiceLocator locator = new UnityServiceLocator(container);
            ServiceLocator.SetLocatorProvider(() => locator);

            //return unity.Resolve<T>();
            return (T)container.Resolve(typeof(T));
        }
    }
} 
```

这是一个如何使用的例子`ListDataGenericResolver`：

```
namespace MyProyect.Model.ListData.Types
{
    public class CountryListData : ListDataGenericResolver, IGetListData
    {
        private readonly ICountryDao countryDao;
        private string defaultValue;

        public CountryListData(object defaultValue)
        {
            // Resolver
            this.countryDao = this.ResolverType<ICountryDao>();
            this.defaultValue = defaultValue == null ? string.Empty : defaultValue.ToString();
        }

        public IList<SelectData> GetData()
        {
            var data = this.countryDao.GetAllCountry(new Entity.Parameters.CountryGetAllParameters());
            return data.Select(d => new SelectData
                {
                    Value = d.CountryId.ToString(),
                    Text = d.Description,
                    Selected = this.defaultValue == d.CountryId.ToString()
                }).ToList();
        }
    }
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:43:58.023

这是我如何做到这一点的。

在 Application_Start 中，我创建了统一容器。我有一个自定义库，用于我通过 NuGet 导入的所有 MVC 项目，所以我调用它的 configure 方法，然后调用另一个项目的 Configure() 方法。您可以简单地省略自定义库并在此处添加该代码。所有这些都让我的 Application_Start 保持整洁。

```
protected void Application_Start()
{
    // Standard MVC setup
    // <removed>

    // Application configuration 
    var container = new UnityContainer();
    new CompanyName.Mvc.UnityBootstrap().Configure(container);
    new AppName.ProjectName1.UnityBootstrap().Configure(container);
    new AppName.ProjectName2.UnityBootstrap().Configure(container);

    // <removed>
} 
```

这是自定义 MVC 库的 UnityBootstrap 类的代码

```
namespace CompanyName.Mvc
{
    /// <summary>
    /// Bootstraps <see cref="CompanyName.Mvc"/> into a Unity container.
    /// </summary>
    public class UnityBootstrap : IUnityBootstrap
    {
        /// <inheritdoc />
        public IUnityContainer Configure(IUnityContainer container)
        {
            // Convenience registration for authentication
            container.RegisterType<IPrincipal>(new InjectionFactory(c => HttpContext.Current.User));

            // Integrate MVC with Unity
            container.RegisterFilterProvider();
            DependencyResolver.SetResolver(new UnityDependencyResolver(container));

            return container;
        }
    }
} 
```

然后，在其他项目中，我有一个 UnityBootstrap，它是从 Application_Start 调用的：

项目名称1：

```
namespace AppName.ProjectName1
{
    public class UnityBootstrap : IUnityBootstrap
    {
        public IUnityContainer Configure(IUnityContainer container)
        {
            return container.RegisterType<IDocumentRoutingConfiguration, DocumentRoutingConfiguration>();
        }
    }
} 
```

ProjectName2: - 你可以在这里看到，这个依赖于另一个库中的一些其他项目，它正在调用它们的 Configure() 方法来设置它们......

```
namespace AppName.ProjectName2
{
    public class UnityBootstrap : IUnityBootstrap
    {
        public IUnityContainer Configure(IUnityContainer container)
        {
            new CompanyName.Security.UnityBootstrap().Configure(container);
            new CompanyName.Data.UnityBootstrap().Configure(container);

            container.RegisterSecureServices<AuthorizationRulesEngine>(typeof(UnityBootstrap).Assembly);

            return container
                .RegisterType<IAuthorizationRulesEngine, AuthorizationRulesEngine>()
                .RegisterType<IDateTimeFactory, DateTimeFactory>()
                .RegisterType<IDirectoryInfoFactory, DirectoryInfoFactory>()
                .RegisterType<IDirectoryWrapper, DirectoryWrapper>()
                .RegisterType<IEmailService, EmailService>()
                .RegisterType<IEntryPointService, EntryPointService>();
        }
    }
} 
```

这是上面代码中使用的 IUnityBootstrap 接口（供您参考）

```
/// <summary>
/// Defines a standard interface for bootstrapping an assembly into a Unity container.
/// </summary>
public interface IUnityBootstrap
{
    /// <summary>
    /// Registers all of the assembly's classes to their public interfaces and performs any other necessary configuration.
    /// </summary>
    /// <param name="container">The Unity container instance to configure.</param>
    /// <returns>The same IUnityContainer object that this method was called on.</returns>
    IUnityContainer Configure(IUnityContainer container);
} 
```

我希望这能够帮到你。

# php - php - 对文本进行两次 utf8 编码。会不会有什么负面影响？

> ID：16088324
> 
> 赞同：1
> 
> 时间：2013-04-18T16:25:47.470
> 
> 标签：php, mysql, utf-8, character-encoding

MySQL 数据库返回`utf8`编码文本。基本上，我使用了`PDO`属性`MYSQL_ATTR_INIT_COMMAND`并通过了：

```
SET CHARACTER SET utf8 
```

它返回`utf8`编码文本。但是数据库中的一些文本是普通的`utf8`，类似的东西`&alum;`是按原样返回的。

所以我需要`utf8_encode`在 php 中再次调用以获取实际的`utf8`字符。它工作正常。

我想知道，它是否会对文本进行两次编码有任何负面影响，或者除了像上面那样对非编码文本进行编码之外，它不会影响其他任何东西？

谢谢！

**编辑：**

我正在使用以下代码来获取正确的字符：

```
 $val = utf8_encode(addslashes(html_entity_decode(strip_tags($val)))); 
```

所以它的作用是将以下文本从：

```
<font color=\"#222222\" face=\"arial, sans-serif\" size=\"2\"> Test Event  &nbsp; &nbsp;</font><span style=\"color: rgb(34, 34, 34); font-family: arial, sans-serif; font-size: 13px;\">Pers&ouml;nlichkeit Universit&auml;t&quot;</span> 
```

（此文本来自数据库，调用后`SET CHARACTER SET utf8`）

至：

```
Test Event Persönlichkeit Universität\" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:39:35.660

`&auml;`是一个 html 实体，它可能一开始就不应该进入您的数据库。它与 UTF-8 无关。

如果你调用`utf8_encode`什么`"&auml;"`都不会发生，因为 ISO-8859-1 和 UTF-8 的编码是相同的。您将在浏览器中看到它所代表的字符，因为它被解释为 html。

作为普通的 Web 应用程序开发人员，您永远不应该调用`utf8_encode`. 您实际上不需要将 ISO-8859-1 转换为 UTF-8，首先是因为浏览器和 MySQL 不支持它。为了兼容性，它们将 Latin1 和 ISO-8859-1 别名为 Windows-1252。其次，您可以使浏览器和数据库以 UTF-8 格式发送它们的数据，因此它已经是 UTF-8 并且不需要转换。

您也不应该转换为 html 实体 - 这是不必要的，因为 UTF-8 可以表示所有字符。

数据库中的数据不应该与 html 有任何关系——那里的数据应该是数据的规范权威原样表示。现在，数据是否真的是字面意思`&auml;`还是`ä`会导致这样的问题存在混淆：

![在此处输入图像描述](https://i.stack.imgur.com/yCuEp.jpg)

图片来自[TheDailyWTF](http://thedailywtf.com/Articles/Rock-amp8216n-Bowl-Champion.aspx)

# mysql - 在 CREATE TRIGGER 的 ALTER TABLE 中使用查询

> ID：16088326
> 
> 赞同：0
> 
> 时间：2013-04-18T16:25:57.890
> 
> 标签：mysql, alter-table

我正在尝试创建一个动态 ALTER TABLE 命令，但某些命令将从查询中生成。问题是我想在触发器中使用它！

尝试1：

```
ALTER TABLE `redinfomanager` CHANGE `Unterkategorie` `Unterkategorie` ENUM(("SELECT GROUP_CONCAT(CONCAT('\'', REPLACE(`Unterkategorien`, '\r\n', '\',\''), '\'') SEPARATOR  ',') FROM `kategorien` GROUP BY '1'")) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL; 
```

尝试2：

```
SELECT @tmp:=GROUP_CONCAT(CONCAT('\'', REPLACE(`Unterkategorien`, '\r\n', '\',\''), '\'') SEPARATOR  ',') FROM `kategorien` GROUP BY '1';
SET @query=CONCAT('ALTER TABLE `redinfomanager` CHANGE `Unterkategorie` `Unterkategorie` ENUM(', @tmp, ') CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL');
PREPARE stmt FROM @query;
EXECUTE stmt; 
```

尝试 3：

```
SET @kat = (SELECT GROUP_CONCAT(CONCAT('\'', REPLACE(`Unterkategorien`, '\r\n', '\',\''), '\'') SEPARATOR  ',') FROM kategorien GROUP BY '1');
PREPARE stmt FROM 'ALTER TABLE redinfomanager CHANGE Unterkategorie Unterkategorie ENUM(?) CHARACTER SET latin1 COLLATE latin1_swedish_ci NOT NULL';
EXECUTE stmt USING @kat; 
```

它告诉我：

> 1064 - 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 '; 附近使用的正确语法。在第 1 行从 'ALTER TABLE `redinfomanager`CHANGE `Unterkategorie`'Unte' 准备stmt

我怎么能那样做？

这个错误代表什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T21:15:21.200

似乎您在`ENUM`第一个表上每次插入后都在更改第二个表上的值？为什么不直接将其[设为外键约束](http://dev.mysql.com/doc/refman/5.6/en/create-table-foreign-keys.html)。这将要求您要放入表 2 中的任何值都必须具有表 1 中的值。它也会更有效率：

只是一个例子（[sqlfiddle 链接](http://www.sqlfiddle.com/#!2/41bea)）：

```
CREATE TABLE category (
  id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
  description VARCHAR(50)
);

CREATE TABLE thing (
  id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
  cat_id INTEGER,
  description VARCHAR(50),
  FOREIGN KEY (cat_id) REFERENCES category(id)
);

INSERT INTO category (description) 
VALUES 
   ('Category 1')
  ,('Category 2');

INSERT INTO thing (cat_id, description)
VALUES 
   (1, 'Thing 1')
  ,(1, 'Thing 2')
  ,(2, 'Thing 3');

INSERT INTO thing (cat_id, description)
VALUES
   (3, 'Imma Fail!') 
```

如果你运行它，第三次插入将失败，因为表`id`中没有 3 `category`。

# cocoa - NSDataDetector 识别的所有 tld 是什么？

> ID：16088329
> 
> 赞同：2
> 
> 时间：2013-04-18T16:26:11.770
> 
> 标签：cocoa, nstextview, tld, nsdatadetector

在测试 Cocoa 数据检测器时，我发现它`forecast.io`没有被拾取，而是被`www.forecast.io`拾取`forecast.com`。

NSDataDetector 发现的所有顶级域都没有前缀`www.`吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:48:06.570

我写了关于[如何选择一个对 Apple 友好的 TLD](http://stevemoser.org/blog/2013/04/21/how-to-pick-an-apple-friendly-tld/)，我的发现如下所述。

我刚刚[从 ICANN 获取了文本文件，](http://data.iana.org/TLD/tlds-alpha-by-domain.txt)并在所有扩展名前加上了“示例”。并且至少在我的语言环境（美国）中检测到的唯一的是这些：

大写：

```
example.com
example.EDU
example.EU
example.GOV
example.LY
example.NET
example.ORG 
```

小写：

```
example.ar
example.at
example.au
example.be
example.br
example.ca
example.ch
example.cn
example.de
example.dk
example.edu
example.es
example.eu
example.fi
example.fr
example.gov
example.gr
example.hk
example.hu
example.il
example.is
example.it
example.jp
example.kr
example.lu
example.ly
example.ma
example.mx
example.net
example.nl
example.no
example.nz
example.org
example.pt
example.ru
example.se
example.sg
example.th
example.tn
example.tr
example.tw
example.ua
example.uk
example.us 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-01T23:17:54.270

根据我自己的测试，看起来`www.`前面的任何东西都会被检测到。

作为史蒂夫回答的更新，以下是截至 2016 年 11 月 1 日为我检测到的小写顶级域名：

```
example.ar
example.at
example.au
example.cc
example.ch
example.cn
example.co
example.com
example.de
example.dk
example.edu
example.es
example.eu
example.fi
example.fm
example.fr
example.gov
example.gr
example.hk
example.hr
example.hu
example.ie
example.il
example.info
example.io
example.is
example.it
example.kr
example.lu
example.ly
example.ma
example.me
example.mx
example.net
example.nl
example.no
example.nz
example.org
example.pt
example.pw
example.rs
example.ru
example.se
example.sg
example.si
example.th
example.tn
example.tr
example.tw
example.ua
example.uk
example.us 
```

# php - 添加正文类wordpress错误

> ID：16088333
> 
> 赞同：0
> 
> 时间：2013-04-18T16:26:20.577
> 
> 标签：php, wordpress

我正在使用此代码根据页面向正文添加类：

```
 <?php

    // add a custom body class
    add_action( 'body_class', 'ilwp_add_my_bodyclass');
    function ilwp_add_my_bodyclass( $classes ) {
        if ( is_page( '12' ))
            {
                $classes[] = 'login';
                return $classes;
            }
        else if ( is_page( '9' ))
            {
                $classes[] = 'homepage';
                return $classes;
            }   
    }

    ?> 
```

**当我通过静态页面导航**时它可以工作，但是当我转到单个帖子时，我收到此错误：

*警告：join() [function.join]：在第 389 行的 /Users/diego/Sites/bb/wp-includes/post-template.php 中传递的参数无效 class="">*

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:56:38.390

您忘记了“其他”声明。让 if-else 语句中的“返回”。也许你需要这样做：

```
<?php add_action( 'body_class', 'ilwp_add_my_bodyclass');
function ilwp_add_my_bodyclass( $classes ) {
    if ( is_page( '12' ))
        {
            $classes[] = 'login';
         }
    else if ( is_page( '9' ))
        {
            $classes[] = 'homepage';
        }   
    return $classes
} ?> 
```

# r - 以 R 中的第一个实例为条件的子集数据

> ID：16088349
> 
> 赞同：4
> 
> 时间：2013-04-18T16:27:09.007
> 
> 标签：r, subset

数据：

```
row A B 
 1  1 1
 2  1 1
 3  1 2
 4  1 3
 5  1 1
 6  1 2
 7  1 3 
```

大家好！我正在尝试做的（上面的示例）是将 A 列中的这些值相加，但仅当 B 列 = 1 时（所以从一个简单的子集行开始 - 下面）。

```
sum(data$A[data$B==1]) 
```

但是，我只想在**第**一次出现这种情况时执行此操作，直到值切换为止。如果该情况稍后在列中再次出现（示例中的第 5 行），我对此不感兴趣！

我非常感谢您在这个（我怀疑很简单）问题上的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:45:45.337

这是一种相当复杂的方法：

```
data$counter = cumsum(data$B == 1)
sum(data$A[(data$counter >= 1:nrow(data) - sum(data$counter == 0)) &
           (data$counter != 0)]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:00:50.830

其他方式：

```
idx <- which(data$B == 1)
sum(data$A[idx[idx == (seq_along(idx) + idx[1] - 1)]])
# [1] 2

# or alternatively
sum(data$A[idx[idx == seq(idx[1], length.out = length(idx))]])
# [1] 2 
```

* * *

想法：首先获取 1 的所有索引。这里是`c(2,3,5)`. 从 start index = "2" 开始，您想获取所有连续（或连续，即`c(2,3,4,5...)`）的索引。因此，从`2`取那么多连续数字并将它们等同起来。当它们不连续时，它们将不相等。也就是说，一旦出现不匹配，后面的所有其他数字也会出现不匹配。因此，匹配相等的前几个数字只会是“连续”的数字（这是您想要的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T23:53:43.687

使用`data.table`语法优雅，您可以使用`rle`来完成此操作

```
library(data.table)
DT <- data.table(data)
DT[ ,B1 := {
  bb <- rle(B==1)
  r <- bb$values
  r[r] <- seq_len(sum(r))
  bb$values <- r
  inverse.rle(bb)
} ]

DT[B1 == 1, sum(a)]
# [1] 2 
```

# javascript - 如何使用javascript将各种线程文本框的所有内容复制到indesign中的另一个文本框？

> ID：16088351
> 
> 赞同：0
> 
> 时间：2013-04-18T16:27:16.307
> 
> 标签：javascript, adobe-indesign

我需要将所有文本、格式和图像复制到另一个文本框。我尝试过使用文本，但它只复制第一个文本框，而不是线程文本框中的所有文本。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T03:29:04.283

这是一个简单的解决方案：

```
var doc = app.activeDocument;

var page = doc.pages[0];

var frame1 = page.textFrames[0];
var frame2 = page.textFrames[1];

frame1.texts.everyItem().select();
app.copy();

frame2.texts.everyItem().select();
app.paste(); 
```

# mime-types - .ini 文件的内容类型是什么？

> ID：16088354
> 
> 赞同：11
> 
> 时间：2013-04-18T16:27:25.103
> 
> 标签：mime-types

我想让一个动态生成的`.ini`文件可供下载，文件的值是否有标准化`Content-Type`值`.ini`？

我找到了一些地方说它是`text/plain`，但我有点怀疑。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-18T16:47:37.860

检查[IANA 的 MIME 媒体类型列表](http://www.iana.org/assignments/media-types)向我们展示了`.ini`未在媒体类型列表中列出的内容（特别是在[文本媒体类型列表中](http://www.iana.org/assignments/media-types/text)。）

此外，关于[文件](http://en.wikipedia.org/wiki/INI_file)[的 Wikipedia 条目`.ini`](http://en.wikipedia.org/wiki/INI_file)解释说`.ini`文件实际上只是*“简单的文本文件”。*

验证这些发现的一种方法是在给定`.ini`文件上运行以下命令（至少在 *nix 中）：

```
$ file --mime-type php.ini.default 
```

这给了我们以下结果：

```
php.ini.default: text/plain 
```

# c++ - 奇数除以余数时总是返回底数吗？

> ID：16088357
> 
> 赞同：5
> 
> 时间：2013-04-18T16:27:27.550
> 
> 标签：c++

我可以确定 C++ 中的奇数在以有余数的方式进行除法时应该总是返回结果的下限，还是有任何例外？我是说：

```
int x = 5;
x = x/2;
cout<<x;      //2 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-18T16:39:03.503

是的。你可以在 c++ 中确定这一点

**ISO/IEC N3485**（工作草案）在 5.6.4 中说

```
The binary / operator yields the quotient, and the binary % operator yields 
the remainder from the division of the ﬁrst expression by the second.
   If the second  operand of / or % is zero the behavior is undeﬁned. 
For integral operands the / operator yields the algebraic quotient with any 
fractional part discarded;81 if the quotient a/b is representable in the type 
of the result, (a/b)*b + a%b is equal to a; otherwise, the behavior of both 
a/b and a%b is undeﬁned. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T16:29:34.967

整数除法在 C/C++ 中作为地板运算处理。

你得到了上面的例子，因为无法表示`2`真正的答案。`2.5`

[这里有一些更详细的答案](https://stackoverflow.com/questions/3602827/what-is-the-behavior-of-integer-division-in-c)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T16:48:28.783

是的; 整数之间的除法在 C++中*始终是整数除法：*

> `[C++11 5.6/4]:`二元`/`运算符产生商，二元`%`运算符产生第一个表达式除以第二个表达式的余数。如果`/`or的第二个操作数`%`为零，则行为未定义。**对于整数操作数，`/`运算符产生代数商，其中任何小数部分被丢弃；**如果商`a/b`在结果类型中是可表示的，`(a/b)*b + a%b`则等于`a`。

# c++ - 哪个 C++ 强制转换类型是等效于的 C 强制转换

> ID：16088358
> 
> 赞同：3
> 
> 时间：2013-04-18T16:27:33.040
> 
> 标签：c++, c, types, casting

我猜 C 只是一个重新解释的演员，位模式保持原样。

我试图了解当我将更广泛的有符号值转换为更窄的有符号值时会发生什么。是否保留符号，或者只是将较窄宽度中的值解释为有符号值。

感谢您的任何帮助。

编辑——这是针对 C99 编译的 c 代码。问题不在于 C++ 编译器将如何处理草率的旧样式转换，而是是否有任何关于 C 做什么的定义。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:32:23.140

如果您只关心 C，您实际上不需要询问 C++，但在您的示例中，C++ 和 C 仍然做同样的事情；

C++ 谈到了这些积分转换：

> 如果目标类型是有符号的，则如果它可以在目标类型（和位域宽度）中表示，则该值不变；否则，该值是实现定义的。

C99 谈到了这些积分转换：

> 否则，新类型是有符号的，值不能在其中表示；结果是实现定义的，或者引发了实现定义的信号。

如果可能，将较大的整数值转换为较小的有符号整数值将产生相同的值，否则会给出实现定义的（即不可移植的）行为。

* * *

§ 5.4/4 状态

> 执行的转换
> 
> *   一个 const_cast (5.2.11),
> *   一个 static_cast (5.2.9),
> *   一个 static_cast 后跟一个 const_cast，
> *   reinterpret_cast (5.2.10)，或
> *   一个 reinterpret_cast 后跟一个 const_cast，
> 
> 可以使用显式类型转换的强制转换表示法来执行。

[...]

> 如果转换可以用以上列出的一种以上方式解释，则使用列表中第一个出现的解释，即使由该解释产生的强制转换是格式错误的。

C++ 被定义为与 C 兼容；也就是说，C 类型转换在 C++ 中的作用与它们在 C 中的作用相同。这意味着 C 中的类型转换实际上会根据类型转换做不同的事情。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T16:29:28.110

没有等效的演员表。

C 强制转换可以像所有 C++ 强制转换一样运行（除了`dynamic_cast`）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T16:31:44.507

C 强制转换最终会导致 C++ 强制转换（除了`dynamic_cast`）。这是第一个成功的演员表：

*   const_cast
*   static_cast
*   static_cast，然后是 const_cast
*   reinterpret_cast
*   重新解释_cast，然后是 const_cast

# html - MSN网站上的css3过渡效果

> ID：16088359
> 
> 赞同：0
> 
> 时间：2013-04-18T16:27:40.763
> 
> 标签：html, css, transition, msn

我刚刚看到他们有一个过渡：[http ://t.uk.msn.com/?rd=1&ucc=GB&dcc=GB&opt=0](http://t.uk.msn.com/?rd=1&ucc=GB&dcc=GB&opt=0)

当您单击一个元素时，它会向后推一点！（仅适用于 IE10）

你到底是怎么做到的？我看过内联样式但我不明白代码？

```
 transition-property: transform; 
        transition-duration: 0.22s; 
        transition-timing-function: ease; 
        transition-delay: 0s; 
        transform-origin: right 50%; 
```

我发现如果我添加：

```
 transform:rotateY(20deg); 
```

它可以很好地旋转它，但是现在当用户在不使用 javascript 的情况下鼠标按下它时，我该如何应用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:45:10.380

知道了！所以你需要过渡的东西，但也需要旋转的东西。这似乎做得很好！

```
 <element>:active
    {
        transition-property: transform; 
        transition-duration: 0.22s; 
        transition-timing-function: ease; 
        transition-delay: 0s; 
        transform-origin: left 50%;
        transform:rotateY(30deg);
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T14:46:17.000

您还应该在 CSS 中添加以下内容：

```
background-visibility: visible;
transition-origin: 0% 50%;
transform: perspective(50px) rotateY(2deg); 
```

这为效果增加了一点缩进。

# regex - 使用正则表达式删除表

> ID：16088360
> 
> 赞同：0
> 
> 时间：2013-04-18T16:27:41.980
> 
> 标签：regex, vim, text

不是一个真正的具体问题，因为我知道的不够多——更多的是关于如何解决这个问题的问题。

示例文件如下所示：

```
 LOADING CONDITION :   4-Homogenous cargo 98% 1.018t/m3, draught 3.35m   
                       - outgoing               

                               ITEMS OF LOADING        
 -------------------------------------------------------------------------------
 CAPA  ITEM REFERENCE    X1      X2     WEIGHT    KG     LCG      YG       FSM  
  No                     (m)     (m)      (t)     (m)    (m)      (m)     (t.m) 
 -------------------------------------------------------------------------------
  13 No2 CARGO TK P      1.650  29.400   609.04  2.745  15.525  -3.384    483.49
  14 No2 CARGO TK S      1.650  29.400   603.61  2.745  15.525   3.384    483.49
  15 No1 CARGO TK P     29.400  56.400   587.23  2.745  42.900  -3.384    470.42
  16 No1 CARGO TK S     29.400  56.400   592.45  2.745  42.900   3.384    470.42
  17 MGO tank aft       21.150  23.400    23.42  6.531  22.275  -0.500     15.70
  18 TO storage tank    21.150  23.400     2.68  7.225  22.275   2.300      0.00
  19 MGO fore tank      33.150  35.400    25.90  6.643  34.275  -0.212      0.00
 -------------------------------------------------------------------------------
 DEADWEIGHT                             2444.34  2.828  29.007  -0.005   1923.52

                               SUMMARY OF LOADING      

                                        WEIGHT    KG     LCG      YG       FSM  
                                          (t)     (m)    (m)      (m)     (t.m) 
 -------------------------------------------------------------------------------
        DEADWEIGHT                      2444.34  2.828  29.007  -0.005   1923.52
        LIGHT SHIP                       634.00  3.030  28.654   0.000      0.00
 -------------------------------------------------------------------------------
        TOTAL WEIGHT                    3078.34  2.869  28.935  -0.004   1923.52

 LOADING CONDITION :   4-Homogenous cargo 98% 1.018t/m3, draught 3.35m   
                       - outgoing               
 Damage Case         : 1bott: all cargo & void3                          
 Flooding Percentage : 100 %
 Flooded Volumes     :   No.3 Void space P  No.3 Void space S  No2 CARGO TK P   
                         No2 CARGO TK S     No1 CARGO TK P     No1 CARGO TK S   

 -------------------------------------------------------------------------------
                            WEIGHT     KG      LCG      YG       FSM     CORR.KG
                              (t)      (m)     (m)      (m)     (t.m)       (m) 
 -------------------------------------------------------------------------------
 TOTAL WEIGHT               3078.34   2.869   28.935   -0.004    1923.52   3.494
 RUN-OFF WEIGHTS               0.00   0.000    0.000    0.000       0.00   0.000
 -------------------------------------------------------------------------------
 DAMAGE CONDITION           3078.34   2.869   28.935   -0.004    1923.52   3.494

 EQUILIBRIUM NOT FOUND ON STARBOARD                                             

 LOADING CASE :                                                                 
      4-Homogenous cargo 98% 1.018t/m3, draught 3.35m - outgoing                

 -------------------------------------------------------------------------------
                            WEIGHT     KG      LCG      YG       FSM     CORR.KG
                              (t)      (m)     (m)      (m)     (t.m)       (m) 
 -------------------------------------------------------------------------------
 TOTAL WEIGHT               3078.34   2.869   28.935   -0.004    1923.52   3.494

                    SUMMARY OF RESULTS OF DAMAGE STABILITY                      
 -------------------------------------------------------------------------------
       DAMAGE CASE               %  R  HEEL   GM     FBmin   GZ>0  GZmax  Area  
                                      (deg)   (m)     (m)   (deg)   (m)  (m.rad)
 -------------------------------------------------------------------------------
 1bott: all cargo & void3       100 0 EQUILIBRIUM NOT FOUND                     

 %     : Flooding percentage.                                                   
 R     : R=1 if run-off weights considered, R=0 if no run-off.                  
 HEEL  : Heel at equilibrium (negative if equilibrium is on port).              
 GM    : GM at equilibrium.                                                     
 FBmin : Minimum distance of margin line, weathertight or non-weathertight      
         points from waterline.                                                 
 GZ>0  : Range of positive GZ limited to immersion of non-weathertight openings.
 GZmax : Maximum GZ value. 
```

它是其中之一，它们可能会有所不同，但它们都可以归结为文本形式的表格。在将它们粘贴到报告中之前，我需要清理其中的一些项目。

所以我想知道 - 删除某个表的文本方式是什么。例如，*SUMMARY OF LOADING*（它从包含“SUMMARY OF LOADING”的行开始，到包含“TOTAL WEIGHT”的行结束）。

如何匹配该表并删除它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:36:06.177

在 vim 中尝试以下操作

```
:g/SUMMARY OF LOADING/, /TOTAL WEIGHT/d 
```

sed 的工作方式相同：

```
sed '/SUMMARY OF LOADING/, /TOTAL WEIGHT/d' input_with_tables.txt 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T06:25:40.350

`:g`如果您需要删除*所有*此类表，Fredrik Pihl 的解决方案效果很好。对于更具体的编辑，您可以使用我的[CountJump 插件](http://www.vim.org/scripts/script.php?script_id=3130)通过定义开始和结束模式（如`SUMMARY OF LOADING`和`TOTAL WEIGHT`在您的情况下）来创建自定义动作和文本对象，然后快速跳转到下一个表并使用快速映射删除一个表。

# algorithm - Red-Black Trees中存储颜色信息时如何节省内存？

> ID：16088364
> 
> 赞同：9
> 
> 时间：2013-04-18T16:27:59.463
> 
> 标签：algorithm, data-structures, binary-tree, binary-search-tree, red-black-tree

我在 Coursera 算法课程之一中遇到了这个问题，并意识到我不知道该怎么做。但是，我仍然对此有一些想法。我首先想到的是使用优化的位集（如 Java 的`BitSet`）来获取映射节点的`key -> color`. 因此，我们只需要为整棵树分配一个比特集并将其用作颜色信息源。如果树中没有重复的元素 - 它应该可以工作。

很高兴看到其他人对此任务的想法。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2015-07-26T02:49:54.540

只需修改 BST。对于黑色节点，什么都不做。而对于红色节点，交换它的左孩子和右孩子。在这种情况下，一个节点可以根据其右孩子是否大于其左孩子来调整为红色或黑色。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-04-18T16:36:26.823

使用节点中一个指针的最低有效位来存储颜色信息。在大多数平台上，节点指针应该包含偶数地址。[在此处](http://bannalia.blogspot.com/2008/11/optimizing-red-black-tree-color-bits.html)查看详细信息。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:53:07.380

一种选择是使用需要较少记账的树，例如[展开树](http://en.wikipedia.org/wiki/Splay_tree)。但是，展开树尤其不适合迭代（它们在随机查找方面要好得多），因此它们可能不适合您正在工作的领域。

您也可以根据节点位置为整个红黑树使用一个 BitSet，例如根是第 0 位，根的左分支是第 1 位，右分支是第 2 位，左分支的左分支是第三位等；这样，是否存在重复元素无关紧要。在遍历树时，记下您所在的位。

就空间而言，为树使用一个位集而不是为每个节点分配一个布尔值会更有效；每个布尔值将占用至少一个字节，并且可能会占用一个字，具体取决于对齐方式，而位集将仅占用每个节点的一位（加上 2x 位以考虑最短分支长度的一半的最大不平衡树）最长的分支）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-07-27T10:58:18.577

我们可以将红色节点定义为将孩子放在错误位置的节点，而不是在孩子上使用布尔属性。

如果我们这样做，所有叶子节点都保证是黑色的，我们应该在插入新节点时将父节点与他的兄弟节点交换（使他成为红色）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-26T13:49:12.037

我们可以使用 2 条规则：

1.  因为根节点总是黑色的，所以红色节点总是有一个父节点。

2.  RB BST 的顺序总是 left_child < parent < right_child

然后我们将这样做：

1.  保持黑色节点不变。

2.  对于红色节点，我们称其为 R，我们假设它为其父节点 P 的左子节点。

将红色节点值从 更改`R` 为`R'`，而`R' = P + P - R`

现在`R' > P`，但是因为它是左子树，我们会发现顺序不匹配。

如果我们发现订单不匹配，那么我们就会知道它是一个红色节点。而且很容易回到原来的样子`R = P + P - R'`

# objective-c - PrepareForSegue Tableview 问题

> ID：16088365
> 
> 赞同：3
> 
> 时间：2013-04-18T16:27:59.790
> 
> 标签：objective-c, xcode, uistoryboardsegue

单击单元格并尝试将我的日期转移到 DetailViewController 时，我遇到了 segue 问题

我没有在这里找到我的问题的答案，所以我在这里问。

这是我的方法：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

//    NSLog(@"Source Controller = %@", [segue sourceViewController]);
//    NSLog(@"Destination Controller = %@", [segue destinationViewController]);
//    NSLog(@"Segue Identifier = %@", [segue identifier]);

        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
       if (indexPath){
        lastNews *item = [news objectAtIndex:indexPath.row];
        [segue.destinationViewController setDetail:item];
        NSLog(@"%@", item.title);

   }

} 
```

如果我只删除 if 条件并留下我的代码，如下所示：

```
 - (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    //    NSLog(@"Source Controller = %@", [segue sourceViewController]);
    //    NSLog(@"Destination Controller = %@", [segue destinationViewController]);
    //    NSLog(@"Segue Identifier = %@", [segue identifier]);

            NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
            lastNews *item = [news objectAtIndex:indexPath.row];
            [segue.destinationViewController setDetail:item];
            NSLog(@"%@", item.title);

    } 
```

我的数据可以传输，但只能传输第一个单元格。

如果我像这样实现它：

```
- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender {

    if ([[segue identifier] isEqualToString:@"detailNews"]) {
        NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
       //if (indexPath){
        lastNews *item = [news objectAtIndex:indexPath.row];
        [segue.destinationViewController setDetail:item];
        NSLog(@"%@", item.category);

   }

} 
```

它会发送但始终是新闻标题，并且始终来自第一个新闻。（NSLOG 仅用于检查）

我知道它接收所有值，我已经通过 NSLOG 检查了它，而不仅仅是标题。

为了您的信息，我总是从网站上解析出最新的 20 条新闻，这是有效的，我的单元格中充满了新闻标题。

你能建议我哪里错了吗？

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T16:47:50.547

如果“发件人”是调用它的单元格，您可以执行以下操作：

```
NSIndexPath *indexPath = [[self tableView] indexPathForCell:sender];
lastNews *item = [news objectAtIndex:indexPath.row];
[segue.destinationViewController setDetail:item]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T14:02:45.027

好的，我想我解决了我的最后一个问题。我忘记将我的 IBOUTLET Tableview 连接到我的视图控制器。而已

# mysql - 复制大型数据库很慢。我怎样才能加快这个过程？

> ID：16088367
> 
> 赞同：1
> 
> 时间：2013-04-18T16:28:03.603
> 
> 标签：mysql, javadb

我正在将数据库从 Java DB 复制到 MySQL。MySql中所有的表都设置正确，我写了一个复制数据库的方法。

该方法没有错误，它在大小有限的表上完美运行。但是对于大表来说太慢了。复制 7937 条记录大约需要 5 分 29 秒！由于一张表有 230 万条记录，我将不得不等待超过 26 小时......

我在 Netbeans 中运行它，我的输出在这里：(batch size = 2000)

```
跑：
------ 复制表币 ------
需要复制26行
为货币执行批处理，插入最后 26 个元素
------ 完成抄表币 ------

------ 复制表交换 ------
需要复制31行
执行批量交换，插入最后 31 个元素
------ 完成拷贝表交换 ------

------ 复制牌桌市场 ------
需要复制82行
为市场执行批处理，插入最后 82 个元素
------ 完成复制表市场 ------

------ 跟单交易 ------
2303371行需要复制
执行批量交易，插入2000个元素共复制了2000/2303371行，0%
执行批量交易，插入2000个元素共复制了4000/2303371行，0%
执行批量交易，插入2000个元素共复制了6000/2303371行，0%
BUILD STOPPED（总时间：5 分 29 秒）

```

所以当我看到这需要比预期更长的时间时，我停止了执行。

```

/**
     *
     * @param javadb 连接到源数据库
     * @param mysql 连接目标数据库
     * @param orderedTables 表名按照它们被复制的顺序（所以不会发生外键约束错误）
     */
    public static void copyFromJavaDBtoMySQL(Connection javadb, Connection mysql, String[] orderedTables, int batchSize){
        声明 javadb_stmnt = null;
        PreparedStatement mysql_stmnt = null;

        尝试 {
           for (int i = 0; i < orderedTables.length; i++){
                //打印出一些关于正在复制哪个表以及该表包含多少行的信息。
                System.out.println("------ 复制表 " + orderedTables[i] + " ------ ");
                int numberRows = DataBase.executeCountQuery(orderedTables[i], null); //获取表中行的辅助方法
                System.out.println(numberRows + "需要复制的行数"); 

                int totalNumberCopied = 0;

 `//Get resultset from source table
            String selectQuery = "select * from " + orderedTables[i];
            javadb_stmnt = javadb.createStatement();
            ResultSet rs_select = javadb_stmnt.executeQuery(selectQuery);

            //Creating insert query for target table. Query will be 'insert into <tablename> values (?, ?, ..., ?)'
            int colCount = rs_select.getMetaData().getColumnCount();
            String insert_query = "insert into " + orderedTables[i] + "( ";
            String valuesSubstring = "values (";
            for (int j = 0; j < colCount-1; j++){
                insert_query += rs_select.getMetaData().getColumnName(j+1) + ", ";
                valuesSubstring += "?, ";
            }
            insert_query += rs_select.getMetaData().getColumnName(colCount) + ") ";
            insert_query += valuesSubstring + "?)";

            //Use prepared statement with batches
            mysql_stmnt = mysql.prepareStatement(insert_query);            
            int counter = 0;

            //Iterate over resultset from source table
            while (rs_select.next()){
                //Add batch to insert statement from the current row in result set
                for (int j = 1; j <= colCount; j++){
                    Object obj = rs_select.getObject(j);
                    mysql_stmnt.setObject(j, obj);
                }
                mysql_stmnt.addBatch();   
                //If I have added enough inserts, execute the batch insert
                if (++counter == batchSize){
                    int[] arr = mysql_stmnt.executeBatch();
                    //Print out some progressinformation
                    totalNumberCopied += arr.length;                        
                    double progress = (1.0*totalNumberCopied) / (1.0*numberRows) * 100;
                    DecimalFormat df = new DecimalFormat("#");
                    System.out.print("Executed batch for "+orderedTables[i]+", inserted " + arr.length + " elements");
                    System.out.println("\t Have copied a total of " + totalNumberCopied + "/" + numberRows + " rows, " + df.format(progress) + "%");
                    //Reset counter for batch size
                    counter = 0;
                }                
            }
            //Insert the last elements
            int[] arr = mysql_stmnt.executeBatch();
            System.out.println("Executed batch for "+orderedTables[i]+", inserted the last " + arr.length + " elements");
            System.out.println("------    Finished copying table " + orderedTables[i] + " ------ \n");
        }            
    } catch (SQLException ex) {
        Logger.getLogger(DataBaseCopier.class.getName()).log(Level.SEVERE, null, ex);
    } finally {
        try {
            javadb.close();
            mysql.close();
        } catch (SQLException ex) {
            Logger.getLogger(DataBaseCopier.class.getName()).log(Level.SEVERE, null, ex);
        }
    }` 

}

```

# javascript - window.getselection() 在 FF 和 chrome 中不起作用

> ID：16088372
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:28:12.783
> 
> 标签：javascript, events, textbox, onmouseup

我的页面中有 texbox，我正在尝试从文本框中获取长度。我知道如何在 IE 中获取长度，但以下代码在 FF 和 chrome 中不起作用。

```
<!DOCTYPE html>
<html>
<head>
<script>
function myFunction(obj)
{
alert("mouse up");
var r=window.getSelection().createRange();
alert(r.text.length);

}
</script>
</head>
<body>

<textarea id="myArea" cols="30" spellcheck="false" onmouseup=myFunction(this)>Select some text within this field.</textarea>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:37:12.650

文本区域和文本输入具有与主文档选择不同的选择 API。textarea/input 的使用`selectionStart`和`selectionEnd`属性。

```
function myFunction(obj) {
    var selectedText = obj.value.slice(obj.selectionStart, obj.selectionEnd);
    alert(selectedText);
} 
```

如果您需要对 IE <= 8 的支持，那么还有一个不同的 API。请参阅[textarea 中的插入符号位置，以字符开头](https://stackoverflow.com/questions/263743/how-to-get-caret-position-in-textarea/3373056#3373056)

# eclipse - Eclipse Project Explorer 在 Vim 中突出显示带有编译错误的文件？

> ID：16088373
> 
> 赞同：0
> 
> 时间：2013-04-18T16:28:13.853
> 
> 标签：eclipse, vim, compiler-errors

我的意思是：

![在此处输入图像描述](https://i.stack.imgur.com/5EEqp.jpg)

如果任何源文件中有错误，Eclipse 会以非常好的方式突出显示有问题的文件。这是我在使用 Vim 时一直缺少的东西。所以我的问题是，有没有复制这种行为的 vim 插件？也许是 NerdTree 的一些扩展？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:23:50.070

Vim 有一个不同的机制，称为`quickfix`列表。基本上你运行的`:make`命令取决于你的缓冲区运行什么`'makeprg'`设置。结果被放入`quickfix`列表中。然后，您可以使用`:cnext`,`:cprev`在错误之间移动。您可以使用`:cnfile`和`:cpfile`转到列表中的下一个和上一个文件。您还可以通过查看列表`:copen`。

我推荐使用 Tim Pope 出色的[vim-unimpaired](https://github.com/tpope/vim-unimpaired)插件，它提供了一些不错的映射，例如：`[q`和，在列表`]q`中移动的映射。`quickfix`

如需更多帮助，请参阅：

```
:h :make
:h 'makeprg'
:h quickfix
:h :cn
:h :cnf 
```

# javascript - 自定义 JQuery 延迟处理程序

> ID：16088375
> 
> 赞同：4
> 
> 时间：2013-04-18T16:28:14.373
> 
> 标签：javascript, jquery, deferred

不确定这是否可能，但我会试一试。我有一个延迟函数，它调用服务器来创建或更新和对象。例如：

```
var createOrUpdate = function(item) {
    var self = this;
    var deferred;

    if (item.id && item.id > 0) {
        updated = true;
        deferred = update.call(self, params);
    } else {
        deferred = create.call(self);
    }

    return deferred;
}; 
```

create 和 call 方法返回延迟的地方。这将允许我打电话

```
foo.createOrUpdate(bar).then(function(response) {
    // something happened
}); 
```

但是我希望能够添加一些自定义延迟处理程序，以便我可以做到这一点

```
foo.createOrUpdate(bar).created(function(response) {
    // an item was created
}).updated(function(response) {
    //an item was updated
}); 
```

首先，这是否可能。其次，如果是这样，我将如何去做。

基本上我想创建一个自定义的延迟处理程序。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:18:11.013

没有真正测试过：

```
var createOrUpdate = function(item) {
  return {
    isUpdated : item.id && item.id > 0,
    created   : function(cb) {
      if (! this.isUpdated)
        create.call(self).then(cb);
      return this;
    },  
    updated   : function(cb) {
      if (this.isUpdated)
        update.call(self, params).then(cb);
      return this;
    }   
  };  
};  

foo.createOrUpdate(bar)
  .created(function(response) {
    // an item was created
  })
  .updated(function(response) {
    //an item was updated
  }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T19:12:37.960

一种解决方案是制作自己的`$.Deferred`对象，并使用`.resolve`发送一个参数来说明它是哪种方法。

例如：

```
function create(){
    var deferred = new $.Deferred;

    $.post('/your/AJAX/call', {your: data}, function(retData){
        deferred.resolve('create', retData);
    });

    return deferred.promise();
}

function update(params){
    var deferred = new $.Deferred;

    $.post('/your/AJAX/call', {your: data, also: params}, function(retData){
        deferred.resolve('update', retData);
    });

    return deferred.promise();
} 
```

保持`createOrUpdate`不变，您可以使用`.then`，并且您将从`.resolve`.

```
foo.createOrUpdate(bar).then(function(method, response) {
    switch(method){
        case 'update':
            break;
        case 'create':
            break;
    }
}); 
```

这是一个小演示：http: [//jsfiddle.net/U5jyJ/](http://jsfiddle.net/U5jyJ/)

# java - DefaultHttpClient 超时

> ID：16088378
> 
> 赞同：8
> 
> 时间：2013-04-18T16:28:27.570
> 
> 标签：java, android, timeout, httpclient

我对 DefaultHttpClient 中的超时如何工作感到有些困惑。

我正在使用这段代码：

```
private DefaultHttpClient createHttpClient() {
        HttpParams my_httpParams = new BasicHttpParams();

        HttpConnectionParams.setConnectionTimeout(my_httpParams, 3000);
        HttpConnectionParams.setSoTimeout(my_httpParams, 15000);

        SchemeRegistry registry = new SchemeRegistry();
        registry.register(new Scheme("http", PlainSocketFactory.getSocketFactory(), 80));
        ThreadSafeClientConnManager multiThreadedConnectionManager = new ThreadSafeClientConnManager(my_httpParams, registry);

        DefaultHttpClient httpclient = new DefaultHttpClient(multiThreadedConnectionManager, my_httpParams);

        return httpclient;
} 
```

.

```
String url = "http://www.example.com";

DefaultHttpClient httpclient = createHttpClient();
HttpGet httpget = new HttpGet(url);

try {
    HttpResponse response = httpclient.execute(httpget);
    StatusLine statusLine = response.getStatusLine();
    mStatusCode = statusLine.getStatusCode();

    if (mStatusCode == 200){
        content = EntityUtils.toString(response.getEntity());
    }

} catch (ClientProtocolException e) {
    e.printStackTrace();
} catch (IOException e) {
    e.printStackTrace();
} catch (IllegalStateException e){
    e.printStackTrace();
} 
```

当 15 秒过去了，还没有收到所有数据，就会抛出异常，对吧？但在哪种方法上？我认为这是`.execute(httpget)`一种方法，但那个方法只告诉我它会抛出`ClientProtocolException`and `IOException`。谁能帮我澄清一下？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-18T16:40:48.517

它确实在`execute()`. 的父级`SocketTimeoutException`是一个`IOException`. catch 块处理`IOException`将能够同时捕获两者。

尝试执行此代码。

```
HttpParams my_httpParams = new BasicHttpParams();
HttpConnectionParams.setConnectionTimeout(my_httpParams, 3000);
HttpConnectionParams.setSoTimeout(my_httpParams, 1);
DefaultHttpClient defaultHttpClient = new DefaultHttpClient(my_httpParams);
HttpGet httpGet = new HttpGet("http://google.com");
defaultHttpClient.execute(httpGet); 
```

它导致此异常。

```
java.net.SocketTimeoutException: Read timed out
    at java.net.SocketInputStream.socketRead0(Native Method)
    at java.net.SocketInputStream.read(Unknown Source)
    ...
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:805)
    at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:784) 
```

您始终可以选择通过捕获并`IOException`稍后处理来选择性地处理异常。

```
try
{
    // Your code
}
catch (SocketTimeoutException e)
{
    // handle timeouts
    e.printStackTrace();
}
catch (IOException e)
{
    // handle other IO exceptions
    e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:43:25.937

如果您查看[http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#d5e249](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#d5e249)上的 Apache 文档，它会注意到连接超时异常是 IOException 子类。

更具体地说，我相信如果无法在您配置的连接超时内建立连接，他们将要么是[ConnectTimeoutExceptions ，要么是](http://hc.apache.org/httpcomponents-client-ga/httpclient/apidocs/org/apache/http/conn/ConnectTimeoutException.html)[SocketTimeoutExceptions](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/SocketTimeoutException.html)，如果它已设置但没有收到您配置的 SO 超时的数据。

# symfony - 在 Symfony2 标准版中实现 Sylius

> ID：16088381
> 
> 赞同：1
> 
> 时间：2013-04-18T16:28:34.833
> 
> 标签：symfony, sylius

海，

我正在尝试将 Sylius 电子商务捆绑包实施到新的 Symfony 2.2.2 标准版中。

从命令行运行 sylius:install 命令时，我不断收到以下错误：

```
The class 'Sylius\Bundle\CartBundle\Model\CartItemInterface' was not found in
the chain configured namespaces Sylius\Bundle\CoreBundle\Entity,
Sylius\Bundle\SettingsBundle\Entity, Sylius\Bundle\CartBundle\Entity,
Sylius\Bundle\AssortmentBundle\Entity, Sylius\Bundle\TaxationBundle\Entity,
Sylius\Bundle\ShippingBundle\Entity, Sylius\Bundle\PaymentsBundle\Entity,
Sylius\Bundle\PromotionsBundle\Entity, Sylius\Bundle\AddressingBundle\Entity,
Sylius\Bundle\SalesBundle\Entity, Sylius\Bundle\InventoryBundle\Entity,
Sylius\Bundle\TaxonomiesBundle\Entity, FOS\UserBundle\Entity 
```

捆绑包是通过导入的`Composer`，通过激活`AppKernel.php`的，我已经从普通`Sylius`安装迁移了依赖项和配置，实际上不知道这个错误来自哪里。我刚刚注意到，它试图在 Entiy-Namespace 中找到一个模型，这是不对的。

任何人的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T22:34:38.320

我们遇到了同样的问题，我们正在使用 symfony 2.1。我通过重新排序应用程序 Kernel.php 文件中的捆绑注册来修复它。

在这个文件中，我将 syliusCart 捆绑注册放在所有其他 sylius 捆绑和教义注册之前​​。

我真的不知道是什么原因造成的，也不知道为什么这对我有用……但我希望这对你有用。

干杯!

# grails - 如何在循环一定次数时执行grails

> ID：16088382
> 
> 赞同：0
> 
> 时间：2013-04-18T16:28:42.353
> 
> 标签：grails

我怎样才能在 gsp 的 grails/groovy 中只踢 n 次 while 循环？这是我目前的做法：

```
%{-- <%= "It's groovy, man".take(88)    %> --}%

    <g:set var="i" value="${messages.size()}"/>
    <g:set var="x" value="<%= i - 3 %>/>"
    <g:while test="${i > x}">
    <g:set var="i" value="${i-1}"/>
      ... fancy html here
      <%= messages[i].name %>
    </g:while> 
```

**解决方案：**

```
 <g:set var="i" value="${messages.size()}"/>
    <g:set var="k" value="${i-3}"/>
    <g:while test="${i > k}"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T18:17:56.413

你也可以这样做：

```
<g:each var="foo" in="${ ((i-k)..k) }">
    ...
</g:each> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-30T22:54:03.120

所以这就是我要做的。这是假设您想获取列表中的最后 X 个项目，这就是我认为您要问的，尽管不是很清楚。这也假设消息是一个列表。

```
<g:set var="length" value="${messages.size()}" />
<g:each in="${messages.getAt((Math.min(length,3)*-1)..-1)}" var="message">
... fancy html here
      <%= message.name %>
</g:each> 
```

以下是我为确认这一点所做的测试：

```
def list = [1,2]
def x = list.size()
assert [1,2] == list.getAt((Math.min(x,3)*-1)..-1)
list = [1,2,3]
x = list.size()
assert [1,2,3] == list.getAt((Math.min(x,3)*-1)..-1)
list = [1,2,3,4]
x = list.size()
assert [2,3,4] == list.getAt((Math.min(x,3)*-1)..-1) 
```

# css - IE7 和 IE6 中浮动 div 的问题

> ID：16088384
> 
> 赞同：0
> 
> 时间：2013-04-18T16:28:48.653
> 
> 标签：css

我在我的网站标题中浮动了两个元素，它们是`<div id="twitter">`和`<div id ="navbar>`，但是当我在 IE6 和 IE7 中查看它们时，外观会出现偏差。我相信我要么需要清除浮动元素，要么应用 clearfix，但我不确定在哪里。

这是 IE6 和 IE7 中问题的图像：

![在此处输入图像描述](https://i.stack.imgur.com/KIDcE.jpg)

这是在现代浏览器中出现的理想结果。

![在此处输入图像描述](https://i.stack.imgur.com/34LWA.png)

这是网页的链接：[http ://www.bestcastleintown.co.uk/pg/](http://www.bestcastleintown.co.uk/pg/)

CSS：

```
#twitter {
    background: red;
    float: right;
    height: 40px;
    margin-bottom: 40px;
    width: 200px;
}

#navbar {
    font-size: 2.2em;
    float:right;
} 
```

HTML：

```
<div id="main_header">
    <div id="inner_main_header">
        <div>
            <div id="main_logo">
                <div class="home_page_logo left">
                    <a href="index.php"><img src="PG_awards_logo.gif"></a>
                </div>
            </div>
            <div>
                <div id ="twitter" class="padall">
                    Follow us
                </div>
                <div id ="navbar" class="right">
                    <ul class="nav NG">
                        <li>home</li>
                        <li>enter</li>
                        <li>categories</li>
                        <li>judging</li>
                        <li>sponsorship</li>
                        <li>contact</li>
                    </ul>   
                </div>
            </div>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:00:20.720

`#navbar`将样式更改为：

```
#navbar{
    font-size: 2.2em;
    float: right;
    width: 60%;
    overflow: auto;
} 
```

只需给出`#navbar`一些宽度和溢出而不是可见的。

# asp.net - 在 RadGrid 中更改视觉拖放线索？

> ID：16088386
> 
> 赞同：0
> 
> 时间：2013-04-18T16:28:50.420
> 
> 标签：asp.net, telerik-grid

当从 RadGrid 拖放时，它会显示随着鼠标移动而被拖动的列，这可以很好地拖动一个或几个项目，但如果你拖动更多，那么它看起来很丑陋并占用大量空间，可能会阻止你看到你正在掺杂的元素？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:28:50.420

答：我在项目中遇到过这个解决方案，解决方案是：

1) 将 GridCreated 事件附加到您的 RadGrid

```
<ClientSettings AllowRowsDragDrop="True">
       <Selecting AllowRowSelect="True" EnableDragToSelectRows="true"></Selecting>
       <ClientEvents OnGridCreated="GridCreated" />
</ClientSettings> 
```

2）编写javascript函数来改变视觉轨迹：

```
function rowDragging(sender, eventArgs) {
           var row = sender._draggedRow;
           row.innerHTML = "<div style='color:green;width:60px;margin-left:10px;'>  Drop on Element</div>";
           row.style.width = 0 + "px";
           row.style.height = 0 + "px";
       } 
```

问候

# dtd - 为 IE10 更新我的网站

> ID：16088389
> 
> 赞同：0
> 
> 时间：2013-04-18T16:28:52.177
> 
> 标签：dtd, internet-explorer-10

以下 html（取自 Windows 7 上 IE10 上的调试器）

```
<td id="newTextIcon">
    <a class="Menu" onmouseout="delayhidemenu();" onclick="return dropdownmenu(this, event, menuNewCode, "80px");" href="javascript:void(0)" target="_top">
        <img width="16" height="16" align="left" class="MenuImg" alt="New" src="images/new.gif" border="0"/>
        New 
        <img width="6" height="3" align="MIDDLE" alt="" src="images/sort_down.gif" border="0" vspace="4"/> 
```

呈现为

![在此处输入图像描述](https://i.stack.imgur.com/Zx1PE.jpg)

导致 HTML 以不同方式呈现的潜在思维变化是什么 - 这样我就可以修复它，以便在 Document Mode: Standard 下运行时，按钮看起来像右边？

# ios6 - Apple apns 推送通知 i iOS 6

> ID：16088390
> 
> 赞同：1
> 
> 时间：2013-04-18T16:28:55.333
> 
> 标签：ios6, push-notification, apple-push-notifications

我正在尝试为我的新应用程序设置推送通知，我听说每次启动应用程序时 ios 6 设备令牌都会更改！

是真的吗？

谁能告诉我在 iOS 6 中我对 Apns 的更改是什么？

非常感谢您的帮助。（我已经谷歌了，别担心）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:42:08.677

这不是真的。设备令牌很少更改（通常仅在您更改 iOS 版本或从备份恢复设备时才会更改）。实际上，同一设备上的所有应用程序都具有相同的设备令牌。而这些东西在 iOS6 中并没有改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:12:30.867

无论设备令牌是否更改，最好在每次启动应用程序时重新注册以处理更改的可能性（在某些情况下可能发生）。

在您的应用程序中：didFinishLaunchingWithOptions: 您应该使用此代码来避免由于设备令牌更改而可能出现的任何问题：

```
UIRemoteNotificationType types = [[UIApplication sharedApplication] enabledRemoteNotificationTypes];
if (types != UIRemoteNotificationTypeNone){
    [[UIApplication sharedApplication] registerForRemoteNotificationTypes: UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound | UIRemoteNotificationTypeAlert];
} 
```

# ruby - 在 rails 4 中的 Active 记录上定义 method_missing 会引发 SystemStackError: stack level too deep on attributes

> ID：16088392
> 
> 赞同：3
> 
> 时间：2013-04-18T16:29:00.630
> 
> 标签：ruby, ruby-on-rails-4, method-missing

我最近将我的应用程序升级到 rails 4.0 和 ruby​​ 2.0 我无法理解为什么我的`method_missing`定义不起作用。我很确定我没有做任何与以前不同的事情。

`belongs_to`具体来说，我正在尝试创建一个方法，让 ActiveRecord 对象通过多态关系响应对它的对象的调用。

这是我的课程：

歌曲.rb

```
class Song < ActiveRecord::Base
    has_many :events, :as => :eventable
end 
```

事件.rb

```
class Event < ActiveRecord::Base

    belongs_to :eventable, :polymorphic => true

    def method_missing(meth, *args, &block)
       if meth.to_s ==  self.eventable_type
          self.eventable
       else
          super
       end
    end

end 
```

我希望能够`event.song`在 eventable_type 的 event == 'Song' 时调用问题出在 上`self.eventable_type`，这会触发堆栈溢出。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:36:56.353

似乎在触发`eventable_type`时该方法尚未定义`method_missing`（Rails 中的某些方法在`method_missing`您第一次调用它们时动态定义）。

我会尝试不同的方法来获得你想要的价值；也许`self.attributes["eventable_type"]`会起作用？

# c++ - 将 char“数字”转换为真正的 int

> ID：16088393
> 
> 赞同：1
> 
> 时间：2013-04-18T16:29:04.617
> 
> 标签：c++

我想接受用户的输入（数学表达式）并将其推入堆栈。然后我想通过一些规则来运行它，询问它是一个'（'，一个数字还是一个运算符'+'。我的问题是到目前为止我不知道如何判断，特别是在while循环中首先说明if声明，如果一个字符“实际上”是一个数字。有什么建议吗？

```
#include <stack>

int main()
{
    std::stack<char> myStack;    // initializing the stack
    char line[40]; 
    cin.getline(line, 40);       // this and the proceeding line get the input

    for (int i = 0; i < 40; i++)
        myStack.push(line[i]);   //pushing all of the char onto the stack.

    while (!myStack.empty()) {
        if (myStack item = a number) {
        // ^ this is where it doesn't compile.
        //   I need to figure out how to find out if a char is a number
            cout << item << endl;
        }
        else if (myStack.empty()) {
            myStack.push(item);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:35:43.110

C++中有一个叫做isdigit的函数，它检查一个字符是否是十进制数字。

```
if(isdigit(your_char)) //Then it's a number 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:37:23.327

在 stdlib 中有一个函数`isdigit()`可以为你回答这个问题。

然而，它没有魔法。ASCII 中的数字正好`chars`在 range `48-57`、`48`being`'0'`和`57`being 中`'9'`。

```
char isdigit(char d) {
    return (d >= 48) && (d <= 57);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T17:30:52.853

使用**isdigit**函数：

```
isdigit(x) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T16:36:43.390

根据您的问题，如果您只想查找 char 是否为数字。请将其转换为 int 并检查它是否在 48 和 57 的 ascii 值之间，两者都包括在内。

```
bool CheckIfNum(char chartToCheck)
{
    int aciiOfChar = (int) charToCheck;

    if (asciiOfChar >= 48 && asciiOfChar <= 57)
        return true;

    return false;
} 
```

你也可以使用 std::isdigit 函数

# rest - Spring 3 和 JAXB

> ID：16088396
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:29:09.683
> 
> 标签：rest, spring-mvc, jaxb

我已经使用 Spring 实现了一个基本的 mvc 应用程序，我将我的类注释如下

我已将 Spring oxm 添加到我的 pom 中，但未添加 jaxb 或 json 处理程序。

我的配置几乎是空的。

所以我的问题是，当我在控制器中调用 GET 并在 xml 中返回以下对象时，spring 如何产生 xml 输出。

它在哪里找到 xml 编组器，它在 spring-oxm 中吗？有默认吗？

这是httpmessageconverters吗？我将我的控制器设置为以下内容：

```
@RequestMapping(value= "/state",  method = RequestMethod.GET, produces={MediaType.TEXT_XML_VALUE  })
public ResponseEntity<GameState> getGameState(.. response,... request) {..} 
```

我的对象：

```
@XmlRootElement(name = "door")
public class GameState {

    private int id;

    private String state;

    public GameState() {
        super();
    }

    public GameState(int id, String state) {
        this.id = id;
        this.state = state;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getState() {
        return state;
    }

    public void setState(String state) {
        this.state = state;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:37:57.143

Java 6 在发行版中内置了 JAXB，您正在指定您通过

> @XmlRootElement(name = "门")

如果您需要有关 JAXB 捆绑的更多信息，请参阅[API 文档](http://docs.oracle.com/javase/6/docs/api/index.html?javax/xml/bind/JAXB.html)。

# wix - 组件内的多个文件会出现问题

> ID：16088399
> 
> 赞同：1
> 
> 时间：2013-04-18T16:29:16.787
> 
> 标签：wix

如何在 WiX 中使用组件内的多个文件？

```
<DirectoryRef Id='v5.0' >
   <Component Id='V5.0Ref' Guid='7c9e6679-83F1-4F22-985B-FDB3C8ABD471'>
     <File Id='SimpleMvvmToolkitCommon.dll' Name='SimpleMvvmToolkit-Common.dll' DiskId='1' Source='Source\Binaries\Silverlight\v5.0\SimpleMvvmToolkit-Common.dll' KeyPath='yes'>
     </File>        
   </Component>
 </DirectoryRef> 
```

当我在组件内添加超过文件时，我遇到了问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:41:12.930

将多个文件添加到 a`Component`只是添加子`File`元素的问题。例如，以下将来自同一源位置的a 添加`file.txt`到相同的位置：`Component`

```
<DirectoryRef Id='v5.0' >
  <Component Id='V5.0Ref' Guid='7c9e6679-83F1-4F22-985B-FDB3C8ABD471'>
    <File Id='SimpleMvvmToolkitCommon.dll' Name='SimpleMvvmToolkit-Common.dll' DiskId='1' Source='Source\Binaries\Silverlight\v5.0\SimpleMvvmToolkit-Common.dll' KeyPath='yes' />
    <File Id='file2.txt' Name='file2.txt' DiskId='1' Source='Source\Binaries\Silverlight\v5.0\file2.txt' />
  </Component>
</DirectoryRef> 
```

需要注意的是，只能`File`标记一个元素`KeyPath='yes'`。

# jquery - 使用 .off 删除事件处理程序

> ID：16088400
> 
> 赞同：1
> 
> 时间：2013-04-18T16:29:18.653
> 
> 标签：jquery, events, event-handling

我无法使用 .off 删除事件处理程序。

单击一个框后，我需要删除该框的事件处理程序，目前我已经制作了钩子“.clickable”并删除了该类并尝试删除事件处理程序，然后将事件处理程序应用回所有具有“类”的框。盒子”。

```
 $('.clickable').off('click','**').on("click", function(event){

        if( !$('.box').is(':animated') ) {

            var position = $(this).position()
            ,   targetPosition =  $('.target').position();

            $(this)
                .clone() //clone element
                .addClass('cloned') //add class to cloned element
                .css({
                    'position' : 'absolute'
                ,   'top' : position.top 
                ,   'left' : position.left 
                })
                .appendTo('body'); //append to the document

                animate(position,targetPosition);

                $(this)
                    .removeClass('clickable')
                    .addClass('notActive');

        };

    }); 
```

**感谢大家的建议和帮助，如果有人想看到最终的演示“工作”，这里是一个小提琴**

[工作版](http://cdpn.io/sIxba)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:36:00.737

更正您的代码，尚未测试，但应该可以工作

```
$(document).on("click", '.clickable', function(event){
    if( !$('.box').is(':animated') ) {
        var position = $(this).position();
        var targetPosition =  $('.target').position();
        $(this)
            .clone() //clone element
            .addClass('cloned') //add class to cloned element
            .css({
                'position' : 'absolute'
            ,   'top' : position.top 
            ,   'left' : position.left 
            })
            .appendTo('body'); //append to the document
            animate(position,targetPosition);
            $(this)
                .removeClass('clickable')
                .addClass('notActive')
                .off('click');
    };
}); 
```

# javascript - 修复偏离中心的广播文本

> ID：16088406
> 
> 赞同：0
> 
> 时间：2013-04-18T16:29:33.533
> 
> 标签：javascript, css, radio-button

![在此处输入图像描述](https://i.stack.imgur.com/RU9iv.png)

我正在尝试在heroku（主要是javascript）上制作一个调查网络应用程序，而这些单选按钮上的偏离中心的文本相当烦人。有什么简单的方法可以让它居中并稍微滑到一边？格式化现在都是用 CSS 完成的。目前我如何格式化这些无线电输入是这样的......

```
.radio-input{
    background: #D4E7ED;
    padding:20px 10px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:47:44.010

您可以使用`vertical-align: middle`标签*和*单选*按钮*与*标签*对齐文本和单选按钮`padding-top: 1%`：

 *```
label {
    vertical-align: middle;
    padding-top: 1%;
}
.rdo{
    vertical-align:middle;
} 
```

**[演示](http://jsfiddle.net/AuqkE/1/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T18:36:08.167

这是我使用 Coder 概述的类似方法创建的示例。它包括您指定的背景颜色，并将单选按钮和文本包装在 div 中。它对我来说似乎表现得很好：

的CSS：

```
.radio-input {
    padding-top:20px;
    vertical-align:top;
}
.radio-input-text {
    vertical-align:bottom;
}
.background {
    background: #D4E7ED;
    width:300px;
} 
```

的HTML：

```
<div class="background">
    <div class="radio-input">
        <input type="radio" value="Great" id="Great" /><span class="radio-input-text">Great</span>
    </div>
    <div class="radio-input">
        <input type="radio" value="Okay" id="Okay" /><span class="radio-input">Okay</span>
    </div>
    <div class="radio-input">
        <input type="radio" value="Very Bad" id="VeryBad" /><span class="radio-input">Very Bad</span>
    </div>
</div> 
```

[演示](http://jsfiddle.net/ewilansky/nknL2/1/ "jsfiddle 演示")*

# database - 如何在运行时更改 Play 2 Framework DB 配置？

> ID：16088411
> 
> 赞同：5
> 
> 时间：2013-04-18T16:29:44.517
> 
> 标签：database, configuration, playframework, playframework-2.0

我们正在使用 Play 2.1.1 及其内置的 JPA 集成（JPA.em() 等）。

*   我们如何动态更改 db.pass 属性？Play.application().configuration() 从 Play 2.1 开始似乎是不可变的。（或者我们至少不知道突变器）
*   如果我们能够更改 db.pass，我们如何重新加载 DB 配置以便 JPA.em() 使用新密码返回 EntityManager？

我们试图避免的是必须使用 EntityManagerFactory 重新创建 EntityManager。我们希望继续让 Play 在 JPA 助手类中管理它。

***背景***

系统具有用于在本地运行的默认数据库配置。部署到服务器时，使用以下脚本在正在运行的应用程序上动态设置数据库密码：

```
#!/bin/bash 
stty -echo 
read -p "Password: " PASS 
stty echo 
curl -k https://127.0.0.1:8443/someUrl/pwd --data "password=$PASS" 
```

应用程序接收此数据，然后重新创建 Hibernate SessionFactory。我们的新 Play 应用将需要执行类似的操作。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-06-18T06:37:18.463

关键是使用 ConfigFactory 创建一个新的 Config 条目。这个新配置包含一个密码条目，其值来自您对密码服务的 http 调用。

使用新配置创建一个新配置，而新配置又从原始配置回退到原始配置。

基本上，新密码条目会取代原来的密码条目。

当你说它时听起来很啰嗦，但代码非常可读。

```
public class Global extends GlobalSettings {

    // inject http client to make call for password

    @Override
    public Configuration onLoadConfig(Configuration configuration, File file, ClassLoader classLoader) {
        final Config config = ConfigFactory.parseString(String.format("db.default.user=%s", callPasswordService()));

        return new Configuration(config.withFallback(configuration.getWrappedConfiguration().underlying()));
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-20T18:49:43.997

为了回答我自己的问题，首先我们通过使用以下内容覆盖 Configuration.onLoadConfig 来解决在运行时更新不可变配置的问题：

1.  如果配置表明 production.level 是 PROD
2.  从标准输入读取密码
3.  通过将旧配置转换为地图并使用 ConfigFactory.parseMap 构建新配置来创建新配置，同时使用新参数
4.  返回 super.onLoadConfig

但是，这仍然没有解决重新加载数据库配置的问题。最后，我的同事创建了一个 Play！插件，它本质上是一些 JPA 类的副本，具有重新加载配置属性映射的附加功能。

**更新**

“钩子”是插件添加到 JPA 类的附加静态方法（例如 reloadWithProperties）。此方法创建一个新的数据源，然后在 JNDI 中重新绑定。

# c# - 实体框架：列表 绑定到 DataGridView 添加回已删除对象以查看

> ID：16088412
> 
> 赞同：0
> 
> 时间：2013-04-18T16:29:47.330
> 
> 标签：c#, entity-framework, datagridview, entity-framework-5

删除绑定数据行后如何恢复绑定数据行（将行添加回 DataGridView）？

当我单击 DataGridView 左侧的删除键时，会触发 UserDeletingRow 事件，我可以捕获从列表中删除的实体对象 (AnswerTable)。

```
private void visitorHostDataGridView_UserDeletingRow (object sender, DataGridViewRowCancelEventArgs e)
  {

  if (e.Row.DataBoundItem is VisitorHost)
    {
    DatatoDelete datatoDelete = new DatatoDelete (e.Row, e.Row.DataBoundItem as VisitorHost);
    visitorHostsDataRowToDelete.Add (datatoDelete);
    SetModified (); // turns on save and cancel buttons
    }
} 
```

稍后我在保存发生时进行删除

```
public override void OnSave ()
{

    if (visitorHostsDataRowToDelete.Count > 0)
    {
        foreach (DatatoDelete item in visitorHostsDataRowToDelete)
        {
            _context.AnswerTables.DeleteObject (item.VisitorHostRecord as VisitorHost);
        }
    }

    visitorhostBindingSource.EndEdit ();

    _context.SaveChanges ();
    ClearModified (); // turns off save and cancel
    MessageBox.Show ("Saved");
} 
```

同样，我的问题是如何恢复已删除的行（取消我的删除）并将对象添加回 DataGridView - 在我单击删除之后。（我不需要确认，我说的是我已经做了一些工作并意识到我犯了一个错误并想重新开始）我不想回到数据库，我不应该需要我有所有的数据，只是不知道如何使用它。

**更新：**

我自己试过 List.Add(EntityObject) 没有运气（见下文）。由于评论再次尝试。按以下顺序用这三件事更新了我的代码：

```
this.visitorhostBindingSource.DataSource = null;
this.visitorhostBindingSource.DataSource = _hosts;
this.visitorHostsDataGridView.Refresh (); 
```

似乎解决了我遇到的问题，单独添加并没有让它显示在屏幕上。但不知道为什么我需要做我正在做的步骤。任何额外的想法都会很有用。

```
public override void OnCancel () // called from on click event of cancel button
 {

 foreach (DatatoDelete dataGridViewRow in visitorHostsDataRowToDelete)
  {
  _hosts.Add (dataGridViewRow.VisitorHostRecord);
  }
 visitorHostsDataRowToDelete.Clear();
 _hosts.Sort ();
 this.visitorhostBindingSource.DataSource = null;
 this.visitorhostBindingSource.DataSource = _hosts;
 this.visitorHostsDataGridView.Refresh ();

 ClearModified (); //disable save and cancel buttons
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-23T14:44:26.147

如问题所述，我自己尝试了 List.Add(EntityObject) 没有运气（见下文）。由于评论再次尝试。按以下顺序用这三件事更新了我的代码：

```
this.visitorhostBindingSource.DataSource = null;
this.visitorhostBindingSource.DataSource = _hosts;
this.visitorHostsDataGridView.Refresh (); 
```

似乎解决了我遇到的问题，单独添加并没有让它显示在屏幕上。但不知道为什么我需要做我正在做的步骤。任何额外的想法都会很有用。

```
public override void OnCancel () // called from on click event of cancel button
 {

 foreach (DatatoDelete dataGridViewRow in visitorHostsDataRowToDelete)
  {
  _hosts.Add (dataGridViewRow.VisitorHostRecord);
  }
 visitorHostsDataRowToDelete.Clear();
 _hosts.Sort ();
 this.visitorhostBindingSource.DataSource = null;
 this.visitorhostBindingSource.DataSource = _hosts;
 this.visitorHostsDataGridView.Refresh ();

 ClearModified (); //disable save and cancel buttons
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T08:47:22.427

在您的事件处理程序方法中使用`return`只会退出此方法，而不是整个事件处理程序链。`DataGridView`在调用处理程序之前和之后（从 中删除您的行`BindingSource`）做一些事情。

要声明你真的想取消你必须使用的整个事件**`e.Cancel = true;`**。

因此，要取消在调用处理程序后完成的所有内容，请编写：

```
if(answerTableDataGridView.SelectedRows.Count>1)
    {
        // multiselect is false so we should never hit this.
        MessageBox.Show ("only one delete at a time allowed,\n Rows removed from view but NOT DELETED from the database.");
        e.Cancel = true;
        return;
    } 
```

[CancelEventArgs.Cancel 文档](http://msdn.microsoft.com/en-us/library/system.componentmodel.canceleventargs.cancel.aspx)

# javascript - XMLHTTPRequest 不适用于 IIS 集成模式

> ID：16088413
> 
> 赞同：2
> 
> 时间：2013-04-18T16:29:48.767
> 
> 标签：javascript, .net, ajax, iis, iis-7.5

在经典模式下运行代码工作正常......但在集成模式下运行时失败。

这是代码： -

```
function callAjax(method, request, callback) {
    http = newHTTP();
    http.open('POST', url, true);
    setupHeaders(http, method);
    http.onreadystatechange = function () { http_onreadystatechange(http, callback); }
    http.send(JSON.stringify(request));
    return request.id; 
    }

function newHTTP() {
if (typeof (window) != 'undefined' && window.XMLHttpRequest)
return new XMLHttpRequest(); /* IE7, Safari 1.2, Mozilla 1.0/Firefox, and Netscape 7 */
else
return new ActiveXObject('Microsoft.XMLHTTP'); /* WSH and IE 5 to IE 6 */
} 

function http_onreadystatechange(sender, callback) {
if (sender.readyState == /* complete */4) {
var response = sender.status == 200 ?
JSON.parse(sender.responseText) : {};
response.xmlHTTP = sender;
callback(response);
}
if (sender.readyState == 2 || sender.readyState == 3) {
}
} 

 function setupHeaders(http, method) {
http.setRequestHeader('Content-Type', 'text/plain; charset=utf-8');
http.setRequestHeader('X-JSON-RPC', method);
} 
```

在经典模式下运行时返回以下响应：-

```
"{"id":0,"result":{"serverInfo":{"totalCount":2,"serviceName":"FluorineFx.PageableResult","version":1,"cursor":1,"id":null,"columnNames":["ApplicationId","ApplicationParentID","ParentApp","ChildApp"],"initialData":[[1158,1153,"Apps","App_Application1"],[3159,3161,"Databases","DB_Database1"]]}}}" 
```

而在集成模式下运行时，它会返回以下内容：-

```
"

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

<head><title>

</title></head>

<body>

    <form method="post" action="xxxxx...." id="form1">

<div class="aspNetHidden">

<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEXXXXLTE2MTY2ODcyMjlkZLGuNeIyaZaly9gcTafYavVTQG2payFqxE2OaB+1PjxT" />

</div>

    <div>

    </div>

    </form>

</body>

</html>

" 
```

由于上述响应，它在这一行的 http_onreadystatechange() 方法内失败：-

```
var response = sender.status == 200 ?
JSON.parse(sender.responseText) : {}; 
```

我的问题是为什么它在集成模式下运行时返回奇怪的响应？

# clojure - 如何部分展平clojure中的列表？

> ID：16088414
> 
> 赞同：3
> 
> 时间：2013-04-18T16:29:49.923
> 
> 标签：clojure

假设我有一个像这样的数据结构：

```
[[1 2 3] [4 5 6] [[7 8 9] [10 11 12]]] 
```

我想要结束的是：

```
[[1 2 3] [4 5 6] [7 8 9] [10 11 12]] 
```

有没有自动执行此操作的功能？

基本上我正在将 SQL 结果集转换/转换为 CSV，并且有一些行将转换为 CSV 中的 2 行。所以我的 map 函数在正常情况下会返回一个向量，但有时会返回一个向量的向量。Clojure.data.csv 只需要一个向量列表，所以我需要展平旋转的行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:32:41.617

Mapcat 对于每个元素都可以扩展为 0 个或多个输出元素的映射很有用，如下所示：

```
(mapcat #(if (vector? (first %)) % [%]) data) 
```

虽然我不确定是否`(vector? (first %))`对您的数据进行了充分的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:14:48.437

使用树序列的另一种方法：

```
(def a [[1 2 3] [4 5 6] [[7 8 9] [10 11 12]]])

(filter (comp not vector? first) 
   (tree-seq (comp vector? first) seq a)) 
```

我在这里伸展以使用树序列。有更多经验的人会评论是否有更好的方法只返回孩子而不是使用有效的过滤器（不是分支？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T21:30:04.873

[Clojure：半展平嵌套序列](https://stackoverflow.com/a/5236875/625403)回答了您的问题，但我不想将此问题标记为该问题的重复，因为您实际上问的是与他不同的问题；我想知道是否可以将他的答案移到这里。

# php - 设置一个 Mysql 查询以特定顺序显示数字列？

> ID：16088416
> 
> 赞同：-3
> 
> 时间：2013-04-18T16:29:58.090
> 
> 标签：php, mysql, sql

我有一个用户输入框，在我的 SQL 数据库中查询一列数字，例如：

```
2.0
3.0
4.0
5.0
6.0
7.0
8.0 
```

用户必须输入一个数字，然后填充数字列表的特定顺序以响应用户的输入。因此，如果用户输入是 4.0，那么我希望显示数据库查询

```
4.0,3.0,5.0,2.0,6.0,7.0,8.0\. 
```

为了分解结果，我希望结果模式显示与输入最接近的数字（4.0）的数据库结果，然后下一个结果（如果可用）降低 1 度（3.0），然后升高 1 度(5.0)，然后降低两度 (2.0)，再升高两度 (6.0)。7.0 和 8.0 数字以数字形式显示，因为没有与之匹配的低点。

如何为这种结果模式设置查询？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:33:20.047

```
SELECT  *
FROM    mytable
ORDER BY
        ABS(value - 4.0), SIGN(value - 4.0) 
```

请参阅[SQLFiddle](http://sqlfiddle.com/#!2/acca2/3)

# html - 使用 json2html 显示 Google 电子表格数据

> ID：16088426
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:30:16.880
> 
> 标签：html, json

我有兴趣使用 json2html 在网站上显示 Google 电子表格数据。

具体来说，要在页面上显示此提要的内容：

[https://spreadsheets.google.com/feeds/list/0Am0zfph_qjJMdEJrOTQxQ3A1N2xneU9ac003Szd2MVE/od6/public/basic?alt=json-in-script](https://spreadsheets.google.com/feeds/list/0Am0zfph_qjJMdEJrOTQxQ3A1N2xneU9ac003Szd2MVE/od6/public/basic?alt=json-in-script)

在 json2html 网站的“示例”选项卡下，有一个用于显示 NHL 提要的示例。这几乎就是我想要完成的工作，但我不完全确定哪个 json 标记会在脚本标记中的位置。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:45:42.193

取决于您希望如何显示数据（以及哪些数据）。现在我假设您要显示单元格条目。这是让您入门的东西（请注意，您也可以使用具有相同转换的 jquery 插件）

```
 var transform = 
        {"tag": "li", "children": [
            {"tag":"p", "html":"${content.$t}"},    
        ]};

    var data = json2html.transform(gData.feed.entry,transform);

    document.write('<ul>'+ data + '<ul>'); 
```

# oracle - Resin + Oracle + [Spring] + XA 事务 REQUIRES_NEW – 内部事务提交失败

> ID：16088428
> 
> 赞同：1
> 
> 时间：2013-04-18T16:30:19.577
> 
> 标签：oracle, datasource, spring-transactions, distributed-transactions, resin

您能否帮助解决 Resin + Oracle 上的 XA 事务问题：

我们有 WebApp，它必须执行涉及 Oracle 11.2.0.1 和 Ehcache 2.7 的业务事务。（实际上可能有各种组合——两个不同的 Oracle 数据源（不同的模式）有/没有 Ehcache 等）。这就是从普通 JDBC 使用切换到 JTA 事务划分的原因。

我们使用： - 使用 Spring 3.2.1 装饰的 Resin JTA 实现，以简化事务挂起并利用编程方法来定义事务边界（“手动”使用 TransactionManager 来挂起/恢复也会产生问题），如下所示：

```
public void doOuterTransaction() throws Throwable {
    DefaultTransactionDefinition def = new DefaultTransactionDefinition();
    def.setName("myTx");
    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRES);
    TransactionStatus status = txManager.getTransaction(def);
    Connection connection = null;
    Cache cache = null;
    try {
        cache = ...; // get cache from CacheManager
        connection = myDataSource.getConnection(); // or "DataSourceUtils.getConnection(myDataSource)" to guarantee same dbConnection from Spring
        // some business logic
        doInnerTransaction();
        // some business logic
        txManager.commit(status);
    } catch (Throwable ex) {
        txManager.rollback(status);
        throw ex;
    } finally {
        if (connection!=null) {
            connection.close();
        }
    }
}

public void doInnerTransaction() throws Throwable {
    DefaultTransactionDefinition def = new DefaultTransactionDefinition();
    def.setName("myTx");
    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRES_NEW);
    TransactionStatus status = txManager.getTransaction(def);
    Connection connection = null;
    Cache cache = null;
    try {
        cache = ...; // get cache from CacheManager
        connection = myDataSource.getConnection(); // or "DataSourceUtils.getConnection(myDataSource)" to guarantee same dbConnection from Spring
        // some business logic
        txManager.commit(status);
    } catch (Throwable ex) {
        txManager.rollback(status);
        throw ex;
    } finally {
        if (connection!=null) {
            connection.close();
        }
    }
} 
```

*   带有配置了“XA”事务支持的缓存的 Ehcache。
*   Resin 连接池与 Oracle 驱动程序“oracle.jdbc.xa.client.OracleXADataSource”，通过resin.conf 配置如下

    ```
    <database>
    <name>my_xa_datasource</name>
    <jndi-name>jdbc/my_xa</jndi-name>
    <driver>
        <type>oracle.jdbc.xa.client.OracleXADataSource</type>
        <url>${MY_DB_URL}</url>
        <user>${MY_DB_USERNAME}</user>
        <password>${MY_DB_PASSWORD}</password>
    </driver>
    <max-connections>50</max-connections>
    <max-idle-time>60s</max-idle-time>
    <max-active-time>24h</max-active-time>
    <max-overflow-connections>15</max-overflow-connections>
    <ping>true</ping>
    <ping-table>DUAL</ping-table>
    <ping-interval>240s</ping-interval>
    <transaction-timeout>24h</transaction-timeout>
    <xa>true</xa>
    </database> 
    ```

具有传播级别 REQUIRED 的任何受影响资源组合的所有事务开箱即用。但是当我们遇到外部事务“REQUIRED”和内部事务“REQUIRES_NEW”的情况时——暂停外部事务会导致问题，内部事务无法提交。甚至更多 - 已经在运行内部事务，我们可以看到来自外部事务的未提交更改，这看起来完全错误。

行为取决于外部和内部事务涉及哪些资源。我们有以下情况： 1\. 在内部和外部事务中只有 Ehcache 访问可以正常工作，即使内部事务使用 REQUIRES_NEW。

1.  即使对内部事务使用 REQUIRES_NEW，在外部事务中访问 Ehcache 并且仅在内部事务中访问 DB 也可以正常工作。

2.  在外部事务或两个事务中访问数据库的情况（无论涉及多少数据源，即使数据源的使用不与事务边界重叠）在提交内部事务时会出现以下错误：

_

```
ch.sc.common.ShortAGRuntimeException: org.springframework.transaction.TransactionSystemException:
JTA failure on commit; nested exception is com.caucho.transaction.SystemExceptionWrapper:
XA_RMERR: Resource manager error.
at ch.sc.glibs.mytest.MyTestServlet.doGet(MyTestServlet.java:34)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:120)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:97)
at com.caucho.server.dispatch.ServletFilterChain.doFilter(ServletFilterChain.java:109)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at com.caucho.server.security.SecurityFilterChain.doFilter(SecurityFilterChain.java:132)
at com.caucho.server.webapp.WebAppListenerFilterChain.doFilter(WebAppListenerFilterChain.java:114)
at com.caucho.server.webapp.WebAppFilterChain.doFilter(WebAppFilterChain.java:156)
at com.caucho.server.webapp.AccessLogFilterChain.doFilter(AccessLogFilterChain.java:95)
at com.caucho.server.dispatch.ServletInvocation.service(ServletInvocation.java:289)
at com.caucho.server.http.HttpRequest.handleRequest(HttpRequest.java:838)
at com.caucho.network.listen.TcpSocketLink.dispatchRequest(TcpSocketLink.java:1309)
at com.caucho.network.listen.TcpSocketLink.handleRequest(TcpSocketLink.java:1265)
at com.caucho.network.listen.TcpSocketLink.handleRequestsImpl(TcpSocketLink.java:1249)
at com.caucho.network.listen.TcpSocketLink.handleRequests(TcpSocketLink.java:1157)
at com.caucho.network.listen.TcpSocketLink.handleAcceptTaskImpl(TcpSocketLink.java:956)
at com.caucho.network.listen.ConnectionTask.runThread(ConnectionTask.java:117)
at com.caucho.network.listen.ConnectionTask.run(ConnectionTask.java:93)
at com.caucho.network.listen.SocketLinkThreadLauncher.handleTasks(SocketLinkThreadLauncher.java:169)
at com.caucho.network.listen.TcpSocketAcceptThread.run(TcpSocketAcceptThread.java:61)
at com.caucho.env.thread2.ResinThread2.runTasks(ResinThread2.java:173)
at com.caucho.env.thread2.ResinThread2.run(ResinThread2.java:118)
Caused by: org.springframework.transaction.TransactionSystemException:
JTA failure on commit; nested exception is com.caucho.transaction.SystemExceptionWrapper:
XA_RMERR: Resource manager error.
at org.springframework.transaction.jta.JtaTransactionManager.doCommit(JtaTransactionManager.java:1025)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
at ch.sc.glibs.mytest.MyTxTest.test3(MyTxTest.java:155)
at ch.sc.glibs.mytest.MyTxTest.doMainComplexTx(MyTxTest.java:81)
at ch.sc.glibs.mytest.MyTxTest.doTxTest(MyTxTest.java:50)
at ch.sc.glibs.mytest.MyTxTest__ResinScopeProxy.doTxTest(Unknown Source)
at ch.sc.glibs.mytest.MyTestServlet.doGet(MyTestServlet.java:32)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:120)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:97)
at com.caucho.server.dispatch.ServletFilterChain.doFilter(ServletFilterChain.java:109)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at com.caucho.server.security.SecurityFilterChain.doFilter(SecurityFilterChain.java:132)
at com.caucho.server.webapp.WebAppListenerFilterChain.doFilter(WebAppListenerFilterChain.java:114)
at com.caucho.server.webapp.WebAppFilterChain.doFilter(WebAppFilterChain.java:156)
at com.caucho.server.webapp.AccessLogFilterChain.doFilter(AccessLogFilterChain.java:95)
at com.caucho.server.dispatch.ServletInvocation.service(ServletInvocation.java:289)
at com.caucho.server.http.HttpRequest.handleRequest(HttpRequest.java:838)
at com.caucho.network.listen.TcpSocketLink.dispatchRequest(TcpSocketLink.java:1309)
at com.caucho.network.listen.TcpSocketLink.handleRequest(TcpSocketLink.java:1265)
at com.caucho.network.listen.TcpSocketLink.handleRequestsImpl(TcpSocketLink.java:1249)
at com.caucho.network.listen.TcpSocketLink.handleRequests(TcpSocketLink.java:1157)
at com.caucho.network.listen.TcpSocketLink.handleAcceptTaskImpl(TcpSocketLink.java:956)
at com.caucho.network.listen.ConnectionTask.runThread(ConnectionTask.java:117)
at com.caucho.network.listen.ConnectionTask.run(ConnectionTask.java:93)
at com.caucho.network.listen.SocketLinkThreadLauncher.handleTasks(SocketLinkThreadLauncher.java:169)
at com.caucho.network.listen.TcpSocketAcceptThread.run(TcpSocketAcceptThread.java:61)
at com.caucho.env.thread2.ResinThread2.runTasks(ResinThread2.java:173)
at com.caucho.env.thread2.ResinThread2.run(ResinThread2.java:118)
Caused by: com.caucho.transaction.SystemExceptionWrapper: XA_RMERR: Resource
manager error.
at com.caucho.transaction.TransactionImpl.heuristicException(TransactionImpl.java:1040)
at com.caucho.transaction.TransactionImpl.commitResources(TransactionImpl.java:931)
at com.caucho.transaction.TransactionImpl.commit(TransactionImpl.java:886)
at com.caucho.transaction.TransactionManagerImpl.commit(TransactionManagerImpl.java:324)
at com.caucho.transaction.UserTransactionImpl.commit(UserTransactionImpl.java:363)
at com.caucho.transaction.UserTransactionProxy.commit(UserTransactionProxy.java:171)
at org.springframework.transaction.jta.JtaTransactionManager.doCommit(JtaTransactionManager.java:1009)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
at ch.sc.glibs.mytest.MyTxTest.test3(MyTxTest.java:155)
at ch.sc.glibs.mytest.MyTxTest.doMainComplexTx(MyTxTest.java:81)
at ch.sc.glibs.mytest.MyTxTest.doTxTest(MyTxTest.java:50)
at ch.sc.glibs.mytest.MyTxTest__ResinScopeProxy.doTxTest(Unknown Source)
at ch.sc.glibs.mytest.MyTestServlet.doGet(MyTestServlet.java:32)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:120)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:97)
at com.caucho.server.dispatch.ServletFilterChain.doFilter(ServletFilterChain.java:109)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at com.caucho.server.security.SecurityFilterChain.doFilter(SecurityFilterChain.java:132)
at com.caucho.server.webapp.WebAppListenerFilterChain.doFilter(WebAppListenerFilterChain.java:114)
at com.caucho.server.webapp.WebAppFilterChain.doFilter(WebAppFilterChain.java:156)
at com.caucho.server.webapp.AccessLogFilterChain.doFilter(AccessLogFilterChain.java:95)
at com.caucho.server.dispatch.ServletInvocation.service(ServletInvocation.java:289)
at com.caucho.server.http.HttpRequest.handleRequest(HttpRequest.java:838)
at com.caucho.network.listen.TcpSocketLink.dispatchRequest(TcpSocketLink.java:1309)
at com.caucho.network.listen.TcpSocketLink.handleRequest(TcpSocketLink.java:1265)
at com.caucho.network.listen.TcpSocketLink.handleRequestsImpl(TcpSocketLink.java:1249)
at com.caucho.network.listen.TcpSocketLink.handleRequests(TcpSocketLink.java:1157)
at com.caucho.network.listen.TcpSocketLink.handleAcceptTaskImpl(TcpSocketLink.java:956)
at com.caucho.network.listen.ConnectionTask.runThread(ConnectionTask.java:117)
at com.caucho.network.listen.ConnectionTask.run(ConnectionTask.java:93)
at com.caucho.network.listen.SocketLinkThreadLauncher.handleTasks(SocketLinkThreadLauncher.java:169)
at com.caucho.network.listen.TcpSocketAcceptThread.run(TcpSocketAcceptThread.java:61)
at com.caucho.env.thread2.ResinThread2.runTasks(ResinThread2.java:173)
at com.caucho.env.thread2.ResinThread2.run(ResinThread2.java:118)
Caused by: oracle.jdbc.xa.OracleXAException
at oracle.jdbc.xa.OracleXAResource.checkError(OracleXAResource.java:1110)
at oracle.jdbc.xa.client.OracleXAResource.end(OracleXAResource.java:436)
at com.caucho.sql.DisjointXAResource.end(DisjointXAResource.java:105)
at com.caucho.env.dbpool.ManagedPoolItem.endResource(ManagedPoolItem.java:1017)
at com.caucho.env.dbpool.ManagedPoolItem.commit(ManagedPoolItem.java:957)
at com.caucho.transaction.TransactionImpl.commitResources(TransactionImpl.java:924)
at com.caucho.transaction.TransactionImpl.commit(TransactionImpl.java:886)
at com.caucho.transaction.TransactionManagerImpl.commit(TransactionManagerImpl.java:324)
at com.caucho.transaction.UserTransactionImpl.commit(UserTransactionImpl.java:363)
at com.caucho.transaction.UserTransactionProxy.commit(UserTransactionProxy.java:171)
at org.springframework.transaction.jta.JtaTransactionManager.doCommit(JtaTransactionManager.java:1009)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
at ch.sc.glibs.mytest.MyTxTest.test3(MyTxTest.java:155)
at ch.sc.glibs.mytest.MyTxTest.doMainComplexTx(MyTxTest.java:81)
at ch.sc.glibs.mytest.MyTxTest.doTxTest(MyTxTest.java:50)
at ch.sc.glibs.mytest.MyTxTest__ResinScopeProxy.doTxTest(Unknown Source)
at ch.sc.glibs.mytest.MyTestServlet.doGet(MyTestServlet.java:32)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:120)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:97)
at com.caucho.server.dispatch.ServletFilterChain.doFilter(ServletFilterChain.java:109)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at ch.sc.common.http.filters.RegexpFilteringProxyFilter.doFilter(RegexpFilteringProxyFilter.java:65)
at com.caucho.server.dispatch.FilterFilterChain.doFilter(FilterFilterChain.java:89)
at com.caucho.server.security.SecurityFilterChain.doFilter(SecurityFilterChain.java:132)
at com.caucho.server.webapp.WebAppListenerFilterChain.doFilter(WebAppListenerFilterChain.java:114)
at com.caucho.server.webapp.WebAppFilterChain.doFilter(WebAppFilterChain.java:156)
at com.caucho.server.webapp.AccessLogFilterChain.doFilter(AccessLogFilterChain.java:95)
at com.caucho.server.dispatch.ServletInvocation.service(ServletInvocation.java:289)
at com.caucho.server.http.HttpRequest.handleRequest(HttpRequest.java:838)
at com.caucho.network.listen.TcpSocketLink.dispatchRequest(TcpSocketLink.java:1309)
at com.caucho.network.listen.TcpSocketLink.handleRequest(TcpSocketLink.java:1265)
at com.caucho.network.listen.TcpSocketLink.handleRequestsImpl(TcpSocketLink.java:1249)
at com.caucho.network.listen.TcpSocketLink.handleRequests(TcpSocketLink.java:1157)
at com.caucho.network.listen.TcpSocketLink.handleAcceptTaskImpl(TcpSocketLink.java:956)
at com.caucho.network.listen.ConnectionTask.runThread(ConnectionTask.java:117)
at com.caucho.network.listen.ConnectionTask.run(ConnectionTask.java:93)
at com.caucho.network.listen.SocketLinkThreadLauncher.handleTasks(SocketLinkThreadLauncher.java:169)
at com.caucho.network.listen.TcpSocketAcceptThread.run(TcpSocketAcceptThread.java:61)
at com.caucho.env.thread2.ResinThread2.runTasks(ResinThread2.java:173)
at com.caucho.env.thread2.ResinThread2.run(ResinThread2.java:118) 
```

在内部，我们在准备提交阶段看到 ORA-25352“无当前事务”“用户会话未附加到任何事务”（调用 Oracle JAVA_XA.prepare 返回错误代码）。看起来好像在内部事务提交应用程序期间由于某种原因涉及外部事务中受影响的资源（数据源），这似乎是不正确的，因为在内部事务中没有使用数据库，我们预计不会调用 Oracle。

最糟糕的是，使用 Apache DBCP 池而不是 Resin 池实现解决了问题……使用 Atomikos（TransactionManager 实现和 Connections Pool 实现）也可以正常工作。但是两个提到的实现都有自己的问题。

目前我们假设我们在 DB 池或 XA 驱动程序配置方面存在问题……这个问题是否与使用本地事务而不是全局事务等任何增强相关联？我们尝试了各种资源定义（数据库，resource-ref），使用“xa-forbid-same-rm”，关闭 spring 事务同步，尝试手动使用 TransactionManager 来暂停/恢复事务等 - 一切都没有运气。

欢迎任何想法/解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:03:22.917

Resin/Spring/Oracle/XA Transactions 组合完美运行。这里的关键是正确使用数据库连接。

所有数据库连接都必须在您的事务内打开。在这种情况下，该资源将被隐式地征入事务。我们的示例代码就是这样做的。

问题是我们在开始新事务时离开了数据库连接。这意味着 Resin 的数据库池（又名 UserConnection）提供的数据库连接在开始新事务之前没有返回到池中。由于某种原因，Resin TransactionManager 实现隐式地将 UNreturned db 连接添加到内部事务中使用的资源列表中。并且内部事务的提交失败，因为 Oracle 知道数据库连接已经在外部未提交的事务中使用。

可以安全地将数据库连接返回到池中。执行内部事务后（因为树脂会在新事务中为您提供新的数据库连接，所以看不到所有未提交的更改）您可能会再次要求外部事务中的数据库连接，此数据库连接将与开始内部事务之前的完全相同，因此您将看到所有未提交的更改。因此，将从树脂的连接池中提供与当前 UserTransaction 关联的连接。

更重要的一件事 - 如果您使用 Spring 从数据源 (DataSourceUtils) 获取连接，则必须在开始内部事务之前使用 DataSourceUtils 释放连接，以让 Spring 知道连接已返回。实际上 Spring 的另一个优点是您可以拥有自己的附加 TransactionSynchronization 逻辑。您也可以直接使用数据源（不使用 Spring），在这种情况下，您可以调用 connection.close() 将其返回到连接池。

最后，外部事务（任何事务）的代码应如下所示：

```
public void doOuterTransaction() throws Throwable {
    DefaultTransactionDefinition def = new DefaultTransactionDefinition();
    def.setName("myTx");
    def.setPropagationBehavior(TransactionDefinition.PROPAGATION_REQUIRES);
    TransactionStatus status = txManager.getTransaction(def);
    Connection connection = null;
    Cache cache = null;
    try {
        try {
            cache = ...; // get cache from CacheManager
            connection = DataSourceUtils.getConnection(myDataSource);
            // some business logic
        } finally {
            DataSourceUtils.releaseConnection(connection, myDataSource);
        }

        doInnerTransaction();

        try {
            cache = ...; // get cache from CacheManager
            connection = DataSourceUtils.getConnection(myDataSource);
            // some other business logic 
        } finally {
            DataSourceUtils.releaseConnection(connection, myDataSource);
        }
    } catch (Throwable ex) {
        txManager.rollback(status);
        throw ex;
    }

    txManager.commit(status);
} 
```

所以不要害怕获取和释放数据库连接。你有连接池 - 它很快。在连接上调用 close() 只会将其返回到池中（方法名称“释放”要好得多！）。在您明确调用 commit() 之前，活跃的 UserTransaction 不会提交您的更改。

谢谢大家的帮助！

# jquery - 如何使用 jQuery 为 Pseudo 类设置动画或计时

> ID：16088431
> 
> 赞同：1
> 
> 时间：2013-04-18T16:30:31.000
> 
> 标签：jquery, css, jquery-animate, pseudo-class

假设我有一个元素，我想在悬停状态下更改它。

使用一个`Pseudo`类，它看起来像这样：

```
#element:before { background-position: 0px -50px; }
#element:hover:before { background-position: -50px -50px; } 
```

我可以`animation`为它实现一个 jQuery 函数吗？或者我可以确定它的过渡时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:55:52.267

这在 jQuery 中是不可能的。

> :after 或 :before 创建的内容不是 DOM 的一部分，因此无法选择或修改。
> - *（[来源](https://stackoverflow.com/a/8969048/1344955)）*

您可以在 CSS 中使用它来实现过渡效果，但这在旧浏览器中不起作用：

```
#element:before {
    -webkit-transition: background-position 1s linear;
    -moz-transition: background-position 1s linear;
    -o-transition: background-position 1s linear;
    -ms-transition: background-position 1s linear;
    transition: background-position 1s linear;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T18:55:24.597

你能用`.prev()`吗？

```
$(".block").prev().animate(); 
```

示例：http: [//jsfiddle.net/charlescarver/EkW4z/](http://jsfiddle.net/charlescarver/EkW4z/)

# ios - 加载存储在 plist 中的数组

> ID：16088433
> 
> 赞同：0
> 
> 时间：2013-04-18T16:30:37.557
> 
> 标签：ios, objective-c, arrays, plist

我有一个 plist，其中包含节点的每个字典信息。每个节点都有经度、纬度和与其他节点的连接。这是 plist 的一小部分。

```
<array>
    <dict>
        <key>connections</key>
        <array>
            <integer>1</integer>
            <integer>3792</integer>
        </array>
        <key>latitude</key>
        <real>45.43876</real>
        <key>longitude</key>
        <real>12.3213</real>
    </dict>
    <dict>
        <key>connections</key>
        <array>
            <integer>0</integer>
            <integer>3793</integer>
        </array>
        <key>latitude</key>
        <real>45.43887</real>
        <key>longitude</key>
        <real>12.32122</real>
    </dict> 
```

我还有一个名为 IGNode 的类来存储信息，请参见此处的 .m 实现。我认为这里不需要显示标题。

```
#import <Foundation/Foundation.h>

@interface IGNode : NSObject

@property double lon;
@property double lat;
@property(nonatomic,strong) NSMutableArray *links;

@end 
```

到目前为止，我已经加载了工作的纬度和经度。但是我不知道如何从 plist 中获取连接数组。我查看了很多关于 stackoverflow 的示例，但我无法将它们转化为我必须做的事情。

这就是我到目前为止所拥有的。

```
for (int i=0; i<plistData.count; i++) {
    NSDictionary *nodeDict = plistData[i];

    IGNode *node = [self.nodes objectAtIndex:i];

    node.lon = [[nodeDict valueForKey:@"longitude"] doubleValue];
    node.lat = [[nodeDict valueForKey:@"latitude"] doubleValue];

    // handle connections
    // ?

} 
```

如何将连接数组存储在 node.links 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:44:41.910

你有没有试过这个......

```
NSString *plistPath = [[NSBundle mainBundle] pathForResource:@"Configs" ofType:@"plist"];
NSArray *tmpDicts = [[NSArray alloc] initWithContentsOfFile:plistPath]; 
```

然后，您可以枚举 tmpDicts 数组并从每个数组中提取连接数组。

```
IGNode *node;
for (NSDictionary *dict in tmpDicts)
{
    node = [[IGNode alloc]init];
    node.lon = [[dict valueForKey:@"longitude"] doubleValue];
    node.lat = [[dict valueForKey:@"latitude"] doubleValue];
    node.links = [[dict valueForKey:@"connections"]mutableCopy];

    // Do something with the node (like add it to an array?)
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:39:33.353

尝试

```
for (NSDictionary *nodeDict in plistData) {

    IGNode *node = [self.nodes objectAtIndex:i];

    node.lon   = [nodeDict[@"longitude"] doubleValue];
    node.lat   = [nodeDict[@"latitude"] doubleValue];
    node.links = [nodeDict[@"connections"] mutableCopy];

} 
```

# php - 我应该跨域发送 POST 数据吗？

> ID：16088434
> 
> 赞同：2
> 
> 时间：2013-04-18T16:30:38.000
> 
> 标签：php, html, cross-domain

这样的最佳做法是什么？我有一个带有表单的 iframe，当它提交时它会更新父页面。目前它通过 GET 发送表单内容，因此父页面 url 反映了这一点。我可以通过 POST 来做同样的事情，但我想知道这是否令人不悦，是否有时会被阻止/无法使用。

欢迎任何帮助和建议

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:32:30.020

跨域使用 POST 不会引起任何问题（至少没有在同一域上使用 POST 或在不同域上使用 GET 不会得到的问题）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:52:53.473

将表单提交到不同的域没有问题，除非通过 javascript。

要记住的一个问题是验证。您需要注意表单出现错误时会发生什么，因为如果他们错过了“姓名”之类的内容，您不希望他们丢失他们输入的信息。服务器应该是验证的最后一道防线，但您需要确保表单的客户端验证与服务器的验证匹配，并适当地通知用户他们（或服务器的）错误。

另一个可能阻止表单通过 post 提交的事情是需要身份验证令牌的表单。许多不同的框架使用这些来防止 CSRF（跨站点请求伪造）攻击，并确保表单是从同一网站域提交的。

# coffeescript - 为什么我们需要使用除非和“？” 一起而不是单独

> ID：16088437
> 
> 赞同：5
> 
> 时间：2013-04-18T16:30:46.973
> 
> 标签：coffeescript

使用除非和“？”有什么需要？在这种情况下，如果您可以一起使用

```
unless person.present? 
```

相当于

```
if person.present 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T16:48:53.987

它们不是等价的。

`doSomeThing() unless person.present?``person.present`仅当is 时才会执行`null`

`doSomeThing() unless person.present` 如果`person.present`是一个`false`值，将执行

`doSomeThing() if person.present` 如果`person.present`是一个`true`值，将执行

检查[编译的 javascript](http://coffeescript.org/#try:alert('person.present%20is%20null')%20unless%20person.present%3F%0A%0Aalert('person.present%20is%20a%20false%20value')%20unless%20preson.present%0A%0Aalert('person%20present')%20if%20person.present)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:09:06.137

您也可能屈服于问题中的错字。除非你有一个' per *sent* ' 属性`person`，否则它总是未定义的，这是错误的。

# html - 使 JwPlayer 始终播放以附加模式录制的视频的最后 5 秒部分

> ID：16088438
> 
> 赞同：1
> 
> 时间：2013-04-18T16:30:52.813
> 
> 标签：html, video, streaming, jwplayer, red5

`Append`假设我们以模式从媒体服务器录制一些视频。

我们如何让`JwPlayer`（或其他视频播放器）寻找并播放（假设）持续 5 秒的视频？

谢谢，

# excel - worksheet_change VBA代码中具有不同宏调用的多个目标

> ID：16088439
> 
> 赞同：2
> 
> 时间：2013-04-18T16:30:52.710
> 
> 标签：excel, syntax-error, worksheet-function, vba

如果 cell1 更改，我想使用 worksheet_change() 运行 macro1，如果 cell2 更改，则使用 macro2 等。我知道 worksheet_change() 只允许 target 和 sh，并且只能使用一个 sub。我以为我可以运行类似的东西：

```
Private Sub Targets(ByVal Target As Range)
Select Case Target.Address
Case "cell1"
Call SheetChange.macro1
Case "cell2"
Call SheetChange.macro2
Case "cell3"
Call SheetChange.macro3
End Select
End Sub 
```

但是，显然我不能！我也试过

```
Private Sub Targets(ByVal Target As Range)
If Target.Address="cell1" Then
Call SheetChange.macro1
ElseIf Target.Address="cell2" Then
Call SheetChange.macro2
Elseif Target.Address="cell3" Then
Call SheetChange.macro3
End If
End Sub 
```

但那里也没有运气。有什么帮助吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:41:19.097

请参阅此示例。您必须使用`Intersect`来检查特定单元格是否已更改。我以`A1`,`A2`和`A3`

我还建议您查看此[链接](https://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640)，该链接告诉您在使用时需要注意什么`Worksheet_Change`

```
Private Sub Worksheet_Change(ByVal Target As Range)
    On Error GoTo Whoa

    Application.EnableEvents = False

    If Not Intersect(Target, Range("A1")) Is Nothing Then
        '~~> Run Macro here
    ElseIf Not Intersect(Target, Range("A2")) Is Nothing Then
        '~~> Run Macro here
    ElseIf Not Intersect(Target, Range("A3")) Is Nothing Then
        '~~> Run Macro here
    End If

Letscontinue:
    Application.EnableEvents = True
    Exit Sub
Whoa:
    MsgBox Err.Description
    Resume Letscontinue
End Sub 
```

您可能还想处理用户复制和粘贴多个单元格的情况。在这种情况下，使用它来检查它并采取适当的行动。

```
 '~~> For Excel 2003
    If Target.Count > 1 Then

    End If

    '~~> For Excel 2007 +        
    If Target.CountLarge > 1 Then

    End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:38:58.110

这是一种方法：

```
Private Sub Worksheet_Change(ByVal Target As Range)
If Target.Address = "$A$1" Then
    MsgBox Target.Address
    Exit Sub
End If

If Target.Address = "$A$2" Then
    MsgBox Target.Address
    Exit Sub
End If

If Target.Address = "$A$3" Then
    MsgBox Target.Address
    Exit Sub
End If

If Target.Address = "$A$4" Then
    MsgBox Target.Address
    Exit Sub
End If
End Sub 
```

或者，如果您更喜欢 select case 语法，您可以走这条路线：

```
Private Sub Worksheet_Change(ByVal Target As Range)
Select Case Target.Address
    Case "$A$1"
        MsgBox Target.Address
    Case "$A$2"
        MsgBox Target.Address
    Case "$A$3"
        MsgBox Target.Address
    Case "$A$4"
        MsgBox Target.Address
End Select
End Sub 
```

# c# - 在 C# 中是否有一种优雅的方式将方差应用于 lambda 表达式？

> ID：16088441
> 
> 赞同：1
> 
> 时间：2013-04-18T16:30:59.337
> 
> 标签：c#, lambda, predicatebuilder

我的应用程序使用 Predicate Builder 促进了多标准搜索。假设这些标准之一允许用户指定他们想要在房子里有多少个浴室。

我可以使用 Predicate Builder 并从具有与用户指定的卧室数量相等的数据库房屋中检索：

```
predicate = predicate.And(x => x.NumberOfBathrooms == viewModel.NumberOfBathrooms); 
```

假设我想返回用户输入的带有多个浴室 +/- 1 的房屋。因此，如果输入 2，将应用具有 1、2 和 3 浴室的房屋。

以下是可以实现的唯一方法吗？

```
predicate = predicate.And(x => x.NumberOfBathrooms == viewModel.NumberOfBathrooms
&& x.NumberOfBathrooms == viewModel.NumberOfBathrooms - 1
&& x.NumberOfBathrooms == viewModel.NumberOfBathrooms + 1); 
```

或者上述甚至可以工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T20:21:46.680

这可能是一个不错的方法：

```
var y = x.NumberOfBathrooms;
predicate = predicate.And(x => new List<int>{y-1, y, y+1}.Contains(x)); 
```

# c++ - 如何判断 wchar_t 是否有代理项（UTF-16）？

> ID：16088447
> 
> 赞同：1
> 
> 时间：2013-04-18T16:31:08.483
> 
> 标签：c++, unicode, utf-16, wchar-t, multibyte-functions

我已经看过有关此问题的其他一些帖子，但无法找到有关如何以编程方式确定代码点是否使用超过一个 2 字节（在 Windows 上）wchar_t 的任何详细信息。

一个例子：

```
const wchar_t* s2 = L"\U0002008A"; // The "Han" character
std::wstring in(s2);               // length() == 2 
```

我想知道如何确定一个字符何时长度（）> 1。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:42:49.473

任何高于 U+FFFF 的代码点都在其 UTF-16 编码中使用代理项。替代值在 D800-DFFF 范围内。

# android - 如何检索添加到联系人数据库的新联系人数量

> ID：16088450
> 
> 赞同：1
> 
> 时间：2013-04-18T16:31:24.543
> 
> 标签：android, contacts

联系人数据库中是否有一列指示添加到基础的日期或最后修改日期，因为我想要一个用于检索新添加的方法我找到了几个方法但我不明白，我是 android 新手

编辑：表示如何获取新更新的联系人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:40:28.707

你想从什么时候开始检索新联系人的数量？

如果您使用应用程序添加联系人，则只需在添加任何联系人之前获取联系人数量并保存该值。然后在用户添加联系人后再次获取号码并找到之前联系人数量之间的差异。这将是新联系人的数量，但最好的方法是保留一个内部计数器来记录用户何时添加联系人。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:58:02.803

我认为您正在寻找类似的东西，您想要获取更新的联系人。看看这里....

[联系人 ContentObserver 随机调用](https://stackoverflow.com/questions/8452252/contacts-contentobserver-called-randomly)

[Android 在电话簿更新时通知（内容观察者）](https://stackoverflow.com/questions/10426555/android-notify-when-phone-book-is-updatedcontent-observer)

[用于监听联系人变化的 ContentObserver](https://stackoverflow.com/questions/14707475/contentobserver-for-listening-contact-changes)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-05-25T07:28:29.527

只需对光标查询进行此更改

```
 Cursor cursor = getActivity().getContentResolver().query(ContactsContract.Contacts.CONTENT_URI, null, null, null, "_id DESC"); 
```

# opengl - Assimp 样本启动错误

> ID：16088457
> 
> 赞同：2
> 
> 时间：2013-04-18T16:31:45.363
> 
> 标签：opengl, assimp

我在 Windows 上安装了 Assimp 库，并且喜欢这些文件，然后只是复制粘贴 SimpleOpenGL 示例并删除了结构词（其中大部分）以清除我遇到的错误。

现在，我没有任何错误，但是每当我尝试运行它时程序都会告诉我：

```
The application was unable to start correctly (0xc0150002).Click OK to close the application. 
```

解决此问题的任何想法（我在项目文件夹中拥有来自 assimp 的所有 dll。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-08T11:49:22.460

只需使用重命名的 Assimp32.dll 为 Assimp32d.dll

# java - 使用java更新xml文件的问题？

> ID：16088458
> 
> 赞同：0
> 
> 时间：2013-04-18T16:31:46.260
> 
> 标签：java, xml, parsing, jakarta-ee, xml-parsing

//**在 NodeList nList = doc.getElementsByTagName(e); 下面是我的 xml 内容我正在尝试删除 xml 文件中存在的类似标签。nList 显示为空。如何解决问题？

**

```
 public class DelElement {
public static String parent;
public static void main(String[] args) {

    try {

        File file = new File("D:/vodafone/parse.xml");

        DocumentBuilder dBuilder = DocumentBuilderFactory.newInstance()
        .newDocumentBuilder();

        Document doc = dBuilder.parse(file);

        System.out.println("Root element :" + doc.getDocumentElement().getNodeName());
        parent=doc.getDocumentElement().getNodeName();
        if (doc.hasChildNodes()) {

            printNote(doc,doc.getChildNodes());

        }

    } catch (Exception e) {
        System.out.println(e.getMessage());
    }

}

private static void printNote(Document doc, NodeList nodeList) throws TransformerException {

    String file = "D:/vodafone/parse.xml";

    for (int count = 0; count < nodeList.getLength(); count++) {

        Node tempNode = nodeList.item(count);

        // make sure it's element node.
        if (tempNode.getNodeType() == Node.ELEMENT_NODE) {

            // get node name and value
            System.out.println("\nNode Name =" + tempNode.getNodeName() + " [OPEN]");
            System.out.println("Node Value =" + tempNode.getTextContent());

            if(tempNode.getNodeName()!=parent){

                System.out.println("----------------------------");

                if (tempNode.getChildNodes().getLength()>1){
                    NodeList nodeMap=tempNode.getChildNodes();
                    System.out.println("inside del");

                    for (int i=0;i<nodeMap.getLength();i++){

                        String e = "'"+(String)nodeMap.item(i).getNodeName()+"'";

                        System.out.println("inside del node:"+e);
                        NodeList nList = doc.getElementsByTagName(e);

                        if (nList.getLength()>1){

                            for (int con=1;i==nList.getLength()-1;con++){

                                Element el = (Element)nList.item(con);
                                System.out.println("element"+el);
                                System.out.println("parent"+el.getParentNode());
                                el.getParentNode().removeChild(el);
                            }
                            TransformerFactory transformerFactory = TransformerFactory.newInstance();

                            Transformer transformer = transformerFactory.newTransformer();
                            transformer.setOutputProperty(OutputKeys.INDENT, "yes");
                            DOMSource source = new DOMSource(doc);
                            StreamResult result = new StreamResult(new File(file));
                            transformer.transform(source, result);
                        }
                    }}}

            if (tempNode.hasChildNodes()) {

                // loop again if has child nodes
                printNote(doc, tempNode.getChildNodes());

            }

            System.out.println("Node Name =" + tempNode.getNodeName() + " [CLOSE]");

        }

    }

}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:44:14.617

问题似乎出在您试图删除节点的“for循环”中。您的循环说：“for (int con=1;i==nList.getLength()-1;con++){” ...根据您的代码，打破循环的条件“i==nList.getLength( )-1" 总是正确的，所以它永远不会进入那个块......

我相信，这就是你应该做的（仍然觉得做一件很小的工作有点复杂；但我猜你只是分享谜题的一部分......见下文；这将删除节点.. .

```
 for (int con=nList.getLength()-1; con>=0; con--) {
                            Element el = (Element)nList.item(con);
                            System.out.println("element"+el);
                            System.out.println("parent"+el.getParentNode());
                            el.getParentNode().removeChild(el);
                        }
                        /*
                        for (int con=1;i==nList.getLength()-1;con++){

                            Element el = (Element)nList.item(con);
                            System.out.println("element"+el);
                            System.out.println("parent"+el.getParentNode());
                            el.getParentNode().removeChild(el);
                        }
                        */ 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T00:35:39.320

使用 Xpath：

```
 Document doc = ...
    XPath xp = XPathFactory.newInstance().newXPath();
    NodeList nodes = (NodeList) xp.evaluate("//sai/test | //dinesh/test", doc, XPathConstants.NODESET);
    for (int i = 0; i < nodes.getLength(); ++i) {
        Node node = nodes.item(i);
        node.getParentNode().removeChild(node);
    }

    TransformerFactory tf .... 
```

更新：

上面的代码只是您可以做的一个示例：另一种方法是查找具有多个 <test> 子节点的所有元素节点，然后进行一些进一步的处理以删除重复项：

```
 NodeList nodes = (NodeList) xp.evaluate("//node()[count(./test) > 1", doc, XPathConstants.NODESET);
    for (int i = 0; i < nodes.getLength(); ++i) {
        Node parent= nodes.item(i);
        checkAndRemoveDuplicates(parent);
    } 
```

重点在于 XPath 是一个强大的工具，可以帮助您用更少的代码解决问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T17:33:15.983

看起来像你打电话的时候

```
doc.getElementsByTagName(e); 
```

e 的值类似于“'test'”。然而，XML 中的元素名称本身只是“测试”（没有单引号）。这可能是你的罪魁祸首

# if-statement - bat：列出空目录，for 语句中的 if/else 语句？

> ID：16088461
> 
> 赞同：0
> 
> 时间：2013-04-18T16:32:07.883
> 
> 标签：if-statement, batch-file, file-management

我正在尝试编写一个脚本，列出指定文件夹中的每个文件名，并在该文件夹为空时通知用户。到目前为止，我有：

```
for /r "O:\Mail\5-Friday" %%d in (*.pdf) do (
    dir /a /b "%%~fd" 2>nul | findstr "^" >nul && echo %%~nd || echo Empty: Friday
) 
```

但我不知道将 if 和 else 运算符放在哪里。

有没有一种方法可以根据用户输入指定一个文件夹，而无需为每个文件夹重写每个函数？所以而不是：

```
if /i {%ANS%}=={thursday} (goto :thursday)
if /i {%ANS%}=={friday} (goto :friday)
:thursday
    <do stuff>
:friday
    <do the same stuff as thursday, but a different directory> 
```

等等，我可以用变量代替路径编写一个函数，将目录分配给一个变量，并根据需要在代码中轻松添加/删除文件夹？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:50:17.807

为了解决您问题的第一部分，“在哪里放置 if，else 运算符”......

```
command | findstr >nul && echo success || echo fail 
```

... 是简写

```
command | findstr >nul
if ERRORLEVEL 1 (
    echo fail
) else (
    echo success
) 
```

发生的神奇之处在于[条件执行运算](http://ss64.com/bash/syntax-execute.html)符`&&`and `||`。如果`findstr`以状态零退出，则找到匹配项。因此，执行之后的东西`&&`。否则，状态不为零，没有找到匹配，所以执行之后的东西`||`。看看它是如何工作的？

* * *

对于第二部分，这是提示用户根据有限数量的选择提供条目的典型方式。

```
@echo off
setlocal

:begin
set /p "day=What day? "
for %%I in (monday tuesday wednesday thursday friday) do (
    if /i "%day%" equ "%%I" goto %%I
)
goto begin

:monday
call :getdirs "O:\Mail\1-Monday"
goto :EOF

:tuesday
call :getdirs "O:\Mail\2-Tuesday"
goto :EOF

:wednesday
call :getdirs "O:\Mail\3-Wednesday"
goto :EOF

:thursday
call :getdirs "O:\Mail\4-Thursday"
goto :EOF

:friday
call :getdirs "O:\Mail\5-Friday"
goto :EOF

:getdirs <path>
setlocal enabledelayedexpansion
for /f "delims=" %%I in ('dir /b /s /ad "%~1"') do (
    dir /b "%%I" 2>NUL | findstr "^" >NUL || echo %%I has no files
)
goto :EOF 
```

* * *

或者，甚至更骇人听闻，我会做一些你可能没想到的事情。我将让脚本[打开一个文件夹选择对话框](https://stackoverflow.com/questions/15885132)，以允许用户选择要扫描的目录。这是一个批处理/JScript 混合脚本。

如果您愿意，可以通过更改倒数第二行的最后一个参数，将文件夹浏览器的根目录设置为[ShellSpecialConstants 文件夹。](http://msdn.microsoft.com/en-us/library/windows/desktop/bb774096%28v=vs.85%29.aspx)使用值`0x11`使您的系统驱动器成为根目录。没有值或值`0x00`使根为“桌面”。或者让脚本保持原样，将根设置为“O:\Mail”。

```
@if (@a==@b) @end /*

:: fchooser2.bat
:: batch portion

@echo off
setlocal

set initialDir="O:\Mail"

for /f "delims=" %%I in ('cscript /nologo /e:jscript "%~f0" "%initialDir%"') do (
    call :getdirs "%%I"
)

exit /b

:getdirs <path>
setlocal enabledelayedexpansion
for /f "delims=" %%I in ('dir /b /s /ad "%~1"') do (
    dir /b "%%I" 2>NUL | findstr "^" >NUL || (

        rem This is where you put code to handle empty directories.
        echo %%I has no files

    )
)
goto :EOF

:: JScript portion */

var shl = new ActiveXObject("Shell.Application");
var hint = 'Double-click a folder to expand, and\nchoose a folder to scan for empty directories';
var folder = shl.BrowseForFolder(0, hint, 0, WSH.Arguments(0));
WSH.Echo(folder ? folder.self.path : ''); 
```

* * *

**编辑**由于显然 BrowseForFolder 接受绝对目录，因此使用 PowerShell / C# 确实没有任何好处。混合批处理/PowerShell/C# 脚本今后将[退出修订历史](https://stackoverflow.com/posts/16088826/revisions)。

这很好玩！

# wordpress - 如何在响应式 WordPress 主题中取消浮动并将其移动到内容下方

> ID：16088462
> 
> 赞同：0
> 
> 时间：2013-04-18T16:32:12.617
> 
> 标签：wordpress, themes, responsive-design

我正在开发我的第一个响应式自定义主题，我遇到了一些障碍，但最重要的是这个。

我有一个侧面，我向右浮动，以便主要内容将围绕它流动。但是，在移动版本上，我需要将旁边放在内容下方。

我怎么做？

这是页面：[http ://digitaldemo.net/landmark/whats-in-it-for-you](http://digitaldemo.net/landmark/whats-in-it-for-you)

非常感谢！

辛西娅

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T02:49:29.907

链接不起作用。

无论如何，响应式使用媒体查询 + 流动边距/填充和宽度。您实际上可以执行一些媒体查询，例如：

```
@media only screen and (min-width: 480px) { aside { float:none; } } 
```

您可以使用媒体查询。

# javascript - 在 Knockout 中编写转义/未转义的 Observable

> ID：16088468
> 
> 赞同：0
> 
> 时间：2013-04-18T16:32:28.390
> 
> 标签：javascript, knockout.js, observable

我有一个问题，我想将所有内容存储为带引号的字符串，并在表单中显示所有未引用的内容。我的第一个解决方案是只创建两个额外的 bindingHandler 来执行此操作，一个用于值，一个用于文本。

```
ko.bindingHandlers.escapedValue = {
    init : function (element, valueAccessor, allBindingsAccessor) {
        var $element = $(element),
            contentObservable = valueAccessor(),
            currentTxt = ko.utils.unwrapObservable(contentObservable);

        if (currentTxt) {
            $element.val(unescape(currentTxt));
        }

        $element.change(function (e) {
            contentObservable(escape($element.val()));
        });
    }
};

ko.bindingHandlers.escapedText = {
    init : function (element, valueAccessor, allBindingsAccessor) {
        var $element = $(element),
            contentObservable = valueAccessor(),
            currentTxt = ko.utils.unwrapObservable(contentObservable);

        if (currentTxt) {
            $element.text(unescape(currentTxt));
        }

        contentObservable.subscribe(function (newValue) {
            $element.text(unescape(newValue));
        });
    }
}; 
```

但是，这给了我两个问题 1）我在按下键后不再进行实时更新 2）当我对例如字符长度的值进行一些验证时，它会检查引用字符串的长度。

我怎样才能写出像 ko.escapedObservable() 或 ko.subscribable.fn.escaped() 这样的东西

我已经更近了，但似乎无法正确保存。所以现在它正确显示并正确进行比较但是当我保存它时，值仍然是 unescped

```
ko.escapedObservable = function (initialValue) {
    var observableVal = ko.observable(initialValue),

    result = ko.computed({
        read: function () {
            return unescape(observableVal());
        },
        write: function (newValue) {
            return observableVal(escape(newValue));
        }
    });

    this.toJSON = function () {
        return escape(observableVal());
    };

    return result;
}; 
```

====EDIT==== 使用两个可观察对象的解决方案 // Escape 和 Unescape 一个文本值

```
ko.escapedObservable = function (initialValue) {
    var observableVal = ko.observable(initialValue),

    result = ko.computed({
        read: function () {
            return observableVal();
        },
        write: function (newValue) {
            observableVal(newValue);
        }
    });

    result.unescaped = ko.computed({
        read: function () {
            return unescape(observableVal());
        },
        write: function (newValue) {
            observableVal(escape(newValue));
        }
    });

    return result;
}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-04T00:44:58.650

```
ko.escapedObservable = function (initialValue) {
    var observableVal = ko.observable(initialValue),

    result = ko.computed({
        read: function () {
            return observableVal();
        },
        write: function (newValue) {
            observableVal(newValue);
        }
    });

    result.unescaped = ko.computed({
        read: function () {
            return unescape(observableVal());
        },
        write: function (newValue) {
            observableVal(escape(newValue));
        }
    });

    return result;
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:51:49.583

我很难弄清楚你在问什么。但是，我相信你真的只需要一个[计算出的 observable](http://knockoutjs.com/documentation/computedObservables.html)：[**[示例]**](http://jsfiddle.net/GqvEY/)[](http://jsfiddle.net/GqvEY/)

 **```
function viewModel() {
    this.test = ko.observable('\"Something\"');

    this.escapedTest = ko.computed(function () {
        return escape(this.test());
    }, this);

    this.unescapedTest = ko.computed(function () {
        return unescape(this.escapedTest());
    }, this);
} 
```**

# c++ - 在for循环c ++中计算出现次数

> ID：16088469
> 
> 赞同：1
> 
> 时间：2013-04-18T16:32:28.460
> 
> 标签：c++, arrays, visual-c++

我是 C++ 的新手，我想做的是计算一个字母与一段文本或段落一起出现的次数，并将其存储到一个称为频率数组的数组中。

下面的代码在一定程度上起作用，如果用户键入 hello frequencyarray stores 11121，如果用户键入 aaba frequencyarray stores 1213，我不想要运行总数，我希望数组存储 1121 和 31。因此，如果出现相同的字母，它会将 1 添加到数组中。

谢谢大卫

```
#include <iostream> //for cout cin
#include <string>   //for strings
#include <fstream>  //for files

using namespace std;

int main()
{       
    string text;

    int frequencyarray [26]={0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0};

    cout << "Enter Word: ";
    cin >> text;

//***************************COUNT OCCURANCES************************

    for (int i(0); i < text.length(); i++)
    {
        char c = text[i];

        c = toupper(c);
        c -= 65;

        if (c < 26 || c >=0)
        {
            frequencyarray[c]++;
            cout << frequencyarray[c];
        }
    }

    system ("pause");

return(0);

}` 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:35:32.600

如果您不想要运行总数，请不要`cout << freqencyarray[c];`在循环内部计算出现次数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:46:14.593

尝试这个

```
#include <iostream> //for cout cin
#include <string>   //for strings
#include <fstream>  //for files
#include <algorithm>

using namespace std;

int main()
{       
    string text;

    int frequencyarray [26]={0};

    cout << "Enter Word: ";
    cin >> text;

//***************************COUNT OCCURANCES************************

    for (int i(0); i < text.length(); i++)
    {
        char c = text[i];

        c = toupper(c);
        c -= 65;

        if (c < 26 || c >=0)
        {
            frequencyarray[c]++;
        }
    }

    std::for_each(std::begin(frequencyarray), std::end(frequencyarray), [](int i)
    {
         std::cout << i << ",";
    });
    std::cout << "\n";
    system ("pause");

return(0);

} 
```

# c# - 时间：2019-04-01 标签：c#gettingaconfigurableequatablemethod

> ID：16088474
> 
> 赞同：0
> 
> 时间：2013-04-18T16:32:47.243
> 
> 标签：c#, .net, equality, predicate, iequalitycomparer

我有一个用 C# 构建的简单工厂，它实例化和配置在 ASP.net 和 JavaScript 中构建的验证器。我想要一种方法来测试我是否意外尝试在同一个控件上设置验证器两次（例如，有两个`RequiredValueValidator`s 不是一个好主意，可能会导致 ui/ux 问题），但我也希望确保保留使用相同构建机制但方式不同的验证器（例如`RegularExpressionValidator`使用不同 RE 的两个 s，但*不是*使用相同 RE 的两个）。

我尝试了几种不同的可能技术，我将在下面详细说明这些技术 - 但本质上我需要一种技术来传递关于如何比较相同基本类型的两个验证器以辨别它们是否相等的描述（**NB' equal' 不是 'identical'**，它们可能具有不同的 ID（等），但仍然执行相同的工作。）在运行时可解释并且我的 c# .dll 的其他区域可以访问以实际运行检查。

我的答案将是社区维基，目的是让社区编辑/纠正/讨论我陷入的错误/陷阱，*而不是仅仅因为最初不正确而被否决*，这样其他人就不会遭受同样的命运.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:44:41.820

我还尝试在我的工厂中创建一个小型静态开关盒方法，该方法将能够简单地输出另一个由开关盒创建的小型配置类。这本质上比上一个问题要简单得多，但也不是没有问题。例如，我无法正确定义我的返回和参数类型，以便 a`RegularExpressionValidator`可以在与检查相同的代码块中检查它是否正确`ValidDateValidator`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:32:47.243

我曾经尝试过的一种尝试是将谓词设置为我的工厂中构建验证器的方法的属性。然后将通过在其他地方使用反射来访问它，然后用于比较两个潜在的验证器。

这方面的一个主要缺陷是您不能将谓词（或代表）设置为属性。

[一种可能的解决](http://social.msdn.microsoft.com/Forums/en-US/vcsharp2008prerelease/thread/0d18c410-07b0-41cc-9c7f-9494633ca101/)方法是您提供一个单独的属性（包含谓词委托或`IEquatable<>`实现，然后检索它 - 但是在比较验证器时需要考虑很多不同的事情（什么类型，配置，它是否依赖于其他控件等等......）所以除非你可以创建一个可以处理不同类型的基类或接口，`IEquatable<ValidatorType>`这也是不可能的......

# php - 表格不会填充数据

> ID：16088480
> 
> 赞同：0
> 
> 时间：2013-04-18T16:33:08.023
> 
> 标签：php, phpmyadmin

我是编程新手，我一直在 localhost 上使用 phpmyadmin。我正在网页上制作一个简单的表格来显示数据。问题是每次我加载页面时它只显示表格而不加载表格。这是我的代码：

```
<?php
require('../model/database.php');
require('../model/product_db.php');

$products = get_products(); 

if (isset($_POST['action'])) {
    $action = $_POST['action'];
} else if (isset($_GET['action'])) {
    $action = $_GET['action'];
} else {
    $action = 'under_construction';
}

 // Display the product list
    include('view-productList.php');

?> 
```

这是 view-productList.php：

```
<?php include '../view/header.php'; ?>

<div id="main">

    <h1>Product List</h1>

   <div id="content">
        <!-- display a table of products -->
        <h2><?php echo $name; ?></h2>
        <table>
            <tr>
                <th>Code</th>
                <th>Name</th>
                <th class="right">Version</th>
                <th>&nbsp;</th>
            </tr>

            <?php foreach ($products as $product) : ?>
            <tr>
                <td><?php echo $product['productCode']; ?></td>
                <td><?php echo $product['name']; ?></td>
                <td class="right"><?php echo $product['version']; ?></td>
                <td><form action="." method="post">
                    <input type="hidden" name="action"
                           value="delete_product" />
                    <input type="hidden" name="product_id"
                           value="<?php echo $product['productID']; ?>" />
                    <input type="hidden" name="category_id"
                           value="<?php echo $product['categoryID']; ?>" />
                    <input type="submit" value="Delete" />
                </form></td>
            </tr>
            <?php endforeach; ?>
        </table>
        <p><a href="?action=show_add_form">Add Product</a></p>
    </div>

</div>
<?php include '../view/footer.php'; ?> 
```

查询页面：

```
<?php
function get_products() {
    global $db;
    $query = 'SELECT * FROM products
              ORDER BY productID';
    $products = $db->query($query);
    return $products;
}

function get_products_by_category($category_id) {
    global $db;
    $query = "SELECT * FROM products
              WHERE products.categoryID = '$category_id'
              ORDER BY productID";
    $products = $db->query($query);
    return $products;
}

function get_product($product_id) {
    global $db;
    $query = "SELECT * FROM products
              WHERE productID = '$product_id'";
    $product = $db->query($query);
    $product = $product->fetch();
    return $product;
}

function delete_product($product_id) {
    global $db;
    $query = "DELETE FROM products
              WHERE productID = '$product_id'";
    $db->exec($query);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:47:59.360

product_db.php 不应该被注释掉一个 - 假设它是包含“查询页面：”内容的文件。

```
$products = get_products(); 
```

应该在包含之后立即出现。

并且您的 for 循环需要获取结果而不仅仅是产品资源：

```
<?php foreach ($products->fetch() as $product) : ?> 
```

假设 fetch() 与此类资源相关，因为我们看不到您的 db 类。

# java - 为什么我的 ButtonGroup 给我一个“ 预期”错误？

> ID：16088483
> 
> 赞同：0
> 
> 时间：2013-04-18T16:33:19.593
> 
> 标签：java, swing, compiler-errors, jradiobutton, buttongroup

我正在通过创建一个包含三个单选按钮、一个文本框和一个“开始”按钮的对话框来自学 Java 的 Swing 组件。我已经到了添加单选按钮的地步，并且我的代码遇到了错误。我有一个类调用构造函数来显示对话框。文本字段和“开始”按钮还没有功能；他们只是占位符。

当我运行下面发布的代码时，会按预期显示一个对话框，但我可以同时选择所有三个单选按钮。阅读[Oracle 的`JButton`](http://docs.oracle.com/javase/7/docs/api/javax/swing/JRadioButton.html)和“[如何使用单选按钮](http://docs.oracle.com/javase/tutorial/uiswing/components/button.html#radiobutton)”文档和教程，看来我需要将 a 应用`ButtonGroup`到 my `JRadioButtons`，它会自动将它们分组为一个单选关系。

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
//
public class CreateButtonSel {
    public static void main(String[] args) {
        ButtonSel thisButtonSel = new ButtonSel();
        final int WIDTH = 250;
        final int HEIGHT = 250;
        thisButtonSel.setSize(WIDTH,HEIGHT);
        thisButtonSel.setVisible(true);
    }
} 
```

然而，当我在`ButtonSel`课堂上取消注释时，尽管似乎遵循教程中提到的语法，在我的语句的打开和关闭括号下使用克拉`ButtonGroup`返回。来自搜索堆栈的这个错误似乎与不正确地声明变量有关，或者在类中的错误位置。我无法发现那个错误。应该让我访问所有 Button 构造函数，对吗？还有一个我应该加入吗？`error: <identifier> expected``...Button.add(...)``import javax.swing.*`

我在这里想念什么？

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
//
public class ButtonSel extends JFrame {
    JLabel buttonSelLabel = new JLabel("Select One");
    JRadioButton oneButton = new JRadioButton("One", true);
    JRadioButton twoButton = new JRadioButton("Two", false);
    JRadioButton threeButton = new JRadioButton("Three", false);
/*    comment out the following; it runs fine.
 *    uncomment, and I get the following error: 
 *
 *    error: <identifier> expected with carats under the open and close 
 *    parens of my ...Button.add(...) statements. 
 *
    ButtonGroup groupOfRadioButtons = new ButtonGroup();
    groupOfRadioButtons.add(oneButton);
    groupOfRadioButtons.add(twoButton);
    groupOfRadioButtons.add(threeButton);   
*/
    JButton approveButton = new JButton("Go");
    JTextField textDisplay = new JTextField(18);
     //
    JPanel timerPanel = new JPanel();
    JPanel radioPanel = new JPanel(new GridLayout(0, 1));
     //
    public ButtonSel() {
        super("ButtonTest");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setLayout(new FlowLayout());
        add(buttonSelLabel);
        add(oneButton);
        add(twoButton);
        add(threeButton);
        add(textDisplay);
        add(approveButton);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:35:18.653

您正在尝试在此处执行*语句*，但它们不在方法或构造函数中：

```
ButtonGroup groupOfRadioButtons = new ButtonGroup();
groupOfRadioButtons.add(oneButton);
groupOfRadioButtons.add(twoButton);
groupOfRadioButtons.add(threeButton); 
```

一个类只直接包含方法、构造函数和嵌套类型声明，以及初始化块。

您应该将声明后的三个语句放入构造函数中 - 您*可以*使用初始化程序块，但在可读性方面通常不是很好。

```
public class ButtonSel extends JFrame {
    ... other fields ...

    // Note: it's a good idea to make all fields private
    private ButtonGroup groupOfRadioButtons = new ButtonGroup();

    public ButtonSel() {
        super("ButtonTest");
        ...
        groupOfRadioButtons.add(oneButton);
        groupOfRadioButtons.add(twoButton);
        groupOfRadioButtons.add(threeButton);
    }
} 
```

# php - 有没有办法将实体框架与 mysql 和 php 一起使用？

> ID：16088486
> 
> 赞同：4
> 
> 时间：2013-04-18T16:33:22.493
> 
> 标签：php, entity-framework

我想知道有什么方法可以`Entity Framework`与`mysql`and一起使用`php`。是否需要任何连接器或特殊程序。你能给我介绍一些参考资料吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:53:55.697

Entity Framework 是 .NET 的 ORM，它不是 php 或类似的“端口”，即使在这种情况下，我怀疑它会比当前的 PHP ORM 框架更好。

如果您想将 ORM 与 PHP 一起使用，那么您有很多选择，您应该阅读一些有关替代方案的信息并选择 ORM。

就个人而言，我使用 Doctrine 框架[http://www.doctrine-project.org/](http://www.doctrine-project.org/)

# caching - IIS 在访问之间不缓存图像

> ID：16088487
> 
> 赞同：0
> 
> 时间：2013-04-18T16:33:23.253
> 
> 标签：caching, iis

我正在尝试在 IIS 中缓存静态图像。它部分工作 - 单击站点时请求之间的图像缓存。但是如果我去一个不同的网站（比如谷歌）然后回来，我可以看到图像再次重新加载。

我没有进行硬刷新，只是将 url 粘贴到位置栏中并按 [ENTER]。

这是我在 web.config 中的缓存设置：

```
<system.webServer>
  <staticContent>
    <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="5.00:00:00" />
  </staticContent>
  ... 
```

当我`curl --head ...`在我的图像上运行时，这就是我得到的：

```
HTTP/1.1 200 OK
Cache-Control: max-age=432000
Content-Length: 10199
Content-Type: image/png
Last-Modified: Mon, 21 Jan 2013 21:58:43 GMT
Accept-Ranges: bytes
ETag: "fbaa7c7a22f8cd1:0"
Server: Microsoft-IIS/7.0
Set-Cookie: SessionId=14ab46aa-7633-412f-95c3-a3ce0667eb25; expires=Tue, 18-Apr-2113 16:17:54 GMT; path=/
X-Powered-By: ASP.NET
Date: Thu, 18 Apr 2013 16:17:54 GMT 
```

我希望浏览器读取缓存直到它过期。任何想法为什么它不使用缓存？

# android - 如何将 ImageView 设置为任何容器的背景？

> ID：16088491
> 
> 赞同：0
> 
> 时间：2013-04-18T16:33:40.907
> 
> 标签：android

我需要将一个设置`ImageView`为`background`一个让我们说`LinearLayout`。有可能这样做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:38:37.877

我希望你写更多关于你需要什么的细节。如果这只是关于设置图像背景，您可以使用`android:background`. `LinearLayout`但是，要直接回答您的问题，可以使用以下方式将一个视图放在另一个视图后面`FrameLayout`：

```
<FrameLayout>
    <ImageView/>
    <LinearLayout>
        ...
        ...
    </LinearLayout>
</FrameLayout> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-18T16:39:30.870

是的，这应该是可能的。在布局 xml 中，尝试将 ImageView 包装在 LinearLayout 中。然后在 Activity OnCreate 函数中将 xml 设置为内容布局。

# android - 在使用 CursorLoader 填充列表视图之前显示进度指示器

> ID：16088499
> 
> 赞同：6
> 
> 时间：2013-04-18T16:34:12.597
> 
> 标签：android, android-cursorloader, android-loader

当我的列表视图没有填充数据库数据时，有什么更好的方法来显示进度指示器？

我找到了一些如何使用 assynctask 执行此操作的示例，但就我而言，我使用的是`Loader`/ `CursorLoader`。

```
public class TestActivity extends SherlockFragmentActivity implements
    LoaderCallbacks<Cursor> {

SimpleCursorAdapter mAdapter;
ListView mListView;

private static final String[] UI_BINDING_FROM = new String[] {
        TestDBAdapter.KEY_NAME, TestDBAdapter.KEY_ICON };

private static final int[] UI_BINDING_TO = new int[] { R.id.text, R.id.icon };

@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_Test);

    mListView = (ListView) findViewById(R.id.listview);

    mAdapter = new TestAdapter(getApplicationContext(),
            R.layout.list_item_Test, null, UI_BINDING_FROM,
            UI_BINDING_TO, 0);

    mListView.setAdapter(mAdapter);

    getSupportLoaderManager().initLoader(0, null, this);

}

@Override
public Loader<Cursor> onCreateLoader(int id, Bundle args) {

    Uri uri = ContentProviderTest.CONTENT_URI;

    CursorLoader cursorLoader = new CursorLoader(
            this, 
            uri,
            null,
            null,
            null,
            null);

    return cursorLoader;

}

@Override
public void onLoadFinished(Loader<Cursor> loader, Cursor data) {
    mAdapter.swapCursor(data);
}

@Override
public void onLoaderReset(Loader<Cursor> loader) {
    mAdapter.swapCursor(null);
}
} 
```

一个可能的解决方案是创建一个扩展`ListFragment`并使用该`setListShown()`方法的新类，但我不知道这是否是解决此问题的最佳方法。

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-18T18:12:43.357

将一个小的 ProgressBar 添加到您的布局文件中，其可见性设置为“已消失”。在创建 CursorLoader 之前，将其可见性设置为“可见”。它会出现。在 onLoadFinished 中，将 ProgressBar 可见性设置为“已消失”。它会消失，你的 ListView 会加载。

我会使用小型进度条。要了解更多信息，请参阅 android.widget.ProgressBar 的参考文档。

顺便说一句，可见性由 View.setVisibility 控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-24T20:49:40.067

除了正确答案之外：`onLoadFinished()`进行此检查是个好主意：

```
if (cursor.getCount() > 0) {
  getView().findViewById(R.id.loadingPanel).setVisibility(View.GONE);
  getView().findViewById(android.R.id.list).setVisibility(View.VISIBLE);
} 
```

否则，如果依靠您的自定义`Service`来用数据填充数据库，则光标可能为空，结果将是没有进度条，也没有显示项目的列表。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-30T21:23:52.780

我在 listView 中有一个 costumCursorAdapter。

当数据库中的数据发生更改时，我还有一个 cursorLoader 来交换 costumCursorAdapter。DB 数据由用户发起的搜索输入。

这些建议都没有奏效，谷歌也无济于事——一旦设置为可见，就没有什么能阻止进度条了—— `i.e. progress_bar.setVisibility(View.Gone);`

最终，作为一个简单且“仅限于现在”的解决方案——

1.  我创建了一个全局变量来充当计数器`int count = 0`。每次搜索都将其重置为 0（以`onClick`按钮的方法）。
2.  在`bindView`customAdapter 的底部，在这个代码块的底部，我用 启动了计数`count ++`。
3.  在代码块的顶部，我检查计数是否达到 4。如果是，我隐藏进度条：

    ```
     if (count==4){
            pb.setVisibility(View.GONE);
        } 
    ```

4.  这样，当 customAdapter 绑定第四个视图时，我知道停止进度条是合理的。

5.  我的清单上从来没有少于 4 个项目。

希望这可以帮助某人。

# c# - ListView SelectedItem 在 ListView 被清除后不更新 UI

> ID：16088500
> 
> 赞同：0
> 
> 时间：2013-04-18T16:34:15.393
> 
> 标签：c#, windows-store-apps, winrt-xaml, caliburn.micro

我在 Windows 应用商店应用程序上使用 Caliburn Micro。

我有一个 ListView，它有一个 SelectedItem，在我第一次使用它时就可以使用。但是，当我清除 ListView 并将其重新绑定到另一个 Collection 时，所选项目不再显示为选中状态。

selectedItem 属性设置正确，因为我可以命中断点，并且一切正常，只是在我清除集合后，视图没有用所选项目更新。

有什么问题？

谢谢。

编辑：

查看代码：

```
<ListView x:Name="DetailNotes"
          ItemsSource="{Binding DetailNotes}"
          SelectedItem="{Binding SelectedDetailNote}"                                  
          ItemTemplate="{StaticResource Notes600ItemTemplate}"
          IsItemClickEnabled="True"
          caliburn:Message.Attach="[Event ItemClick] = [DetailNoteSelected($eventArgs)]"/> 
```

视图模型代码：

```
(...)
private Note selectedDetailNote;

public Note SelectedDetailNote
{
    get { return this.selectedDetailNote; }
    set 
    { 
        this.selectedDetailNote = value; 
        this.NotifyOfPropertyChange(() => this.SelectedDetailNote); 
    }
}

(...)

public void DetailNoteSelected(ItemClickEventArgs eventArgs)
{
    Note n = (Note)eventArgs.ClickedItem;
    this.SelectedDetailNote = n;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:38:38.920

对不起！问题是我的显式绑定。我刚刚离开 Caliburn 做他的工作，现在它可以工作了！解决方案如下：

查看代码：

```
<ListView x:Name="DetailNotes"
          ItemTemplate="{StaticResource Notes600ItemTemplate}"/> 
```

视图模型代码：

```
private Note selectedDetailNote;

public Note SelectedDetailNote
{
    get { return this.selectedDetailNote; }
    set 
    { 
        this.selectedDetailNote = value; 
        this.NotifyOfPropertyChange(() => this.SelectedDetailNote); 
    }
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-06-12T09:36:54.793

我知道已经晚了，但你的问题是绑定模式。您应该将其设置为 TwoWay：

```
 SelectedItem="{Binding SelectedDetailNote, Mode=TwoWay}" 
```

在 WinRT XAML 中，默认值为 OneWay。

# google-geocoding-api - Google Maps API v3 地理编码网络服务，带有监控使用情况的密钥

> ID：16088501
> 
> 赞同：0
> 
> 时间：2013-04-18T16:34:15.670
> 
> 标签：google-geocoding-api

我正在尝试使用 C# 中的给定地址实现对地理编码的服务器端调用。我了解地理编码网络服务不需要 API 密钥即可工作。我也知道传感器参数是必需的。我把所有这些都检查好了。我去谷歌控制台请求一个服务器端密钥，希望我可以跟踪我的应用程序中所有 Web 服务地理编码调用的使用情况，这是基于 IP 地址的。

所以，这是请求，[http ://maps.googleapis.com/maps/api/geocode/xml?address=21274+WOODMERE+DRIVE+LEONARDTOWN+MD&sensor=false&key=aaaaaaaaaaaaaaaa](http://maps.googleapis.com/maps/api/geocode/xml?address=21274+WOODMERE+DRIVE+LEONARDTOWN+MD&sensor=false&key=aaaaaaaaaaaaaaaa)

其中 aaaaaaaaaaaaa 是实际密钥。我从正确的服务器初始化了这个调用。但我仍然每次都得到一个 REQUEST_DENIED 状态。

所以我的问题是，我如何实现能够通过 Google Maps API 地理编码网络服务从 Google 控制台检查使用情况的目标？或者由于它不是客户端 API，因此无法跟踪地理编码 Web 服务？

谢谢你，希望你能给我一些启示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-08T10:13:17.980

目前，地理编码请求中不支持 api 密钥，这似乎是根据 api 文档有意的。当前参数是 V2 的遗留参数，并且在 api 控制台中没有用于地理编码 api 的可用服务。

[https://developers.google.com/maps/documentation/geocoding/?hl=en#Limits](https://developers.google.com/maps/documentation/geocoding/?hl=en#Limits)

所以，坚持无钥匙请求，如果你想监控你的使用情况，你应该记录自己并观察 OVER_QUERY_LIMIT 响应。

# delphi - Delphi中如何使用BDE的TSession类？

> ID：16088502
> 
> 赞同：4
> 
> 时间：2013-04-18T16:34:17.517
> 
> 标签：delphi, bde

我正在使用 ODBC 进行多重连接。在整个项目中，我使用相同的连接，但创建、使用和销毁 TQuery 对象。现在我将在线程中使用连接，并了解到 Delphi BDE 为此提供了 TSession 类。我想知道如何使用 TSession 进行并发操作，如果可能，请提供代码示例。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-18T17:52:17.273

虽然我同意 BDE 是旧的，但可以使用 BDE 和 TSessions 创建对数据库的线程安全访问。

考虑一下。当同一应用程序的两个副本同时运行时，数据库引擎或数据库服务器会区分这两个实例，以达到记录和表锁定的目的。这种区别是可能的，因为每个应用程序都使用单独的连接，或者在 BDE 的情况下，会话。

会话由 TSession 实例表示。在单线程项目中，为您创建了 TSession。如果你想用两个或更多线程连接到 BDE，每个线程都应该有自己的 TSession。

这里演示了使用多个 TSession，在我挖掘的这个非常旧的代码示例中（它很旧，我今天会以不同的方式做，但你要求它）。诀窍是每个会话都需要具有相同的网络目录并具有唯一的私有目录。这是 TThread 后代：

```
 type
  TWriteData = class(TThread)
  private
    FSQL: String;
    FFileName: String;
  protected
    procedure Execute; override;
  public
    constructor Create(CreateSuspended: Boolean; const SQL: String;
      const FileName: String); override; overload;
  end; 
```

这是重写的构造函数：

```
constructor TWriteData.Create(CreateSuspended: Boolean; 
 const SQL: String; const FileName: String);
begin
  inherited Create(True);
  FSQL := SQL;
  FFileName := String;
end; 
```

这是执行方法。重要的是，TSession.PrivateDir 设置为唯一的目录名称（基于 ThreadID）。也可以使用 GUID 或其他值，只要它是唯一的。另请注意，Session1 是数据模块上的 TSession 组件，而 Query1 是使用 TDatabase (Database1) 的 TQuery，而后者又使用 Session1。Session 是在 Bde.DBTables 单元中声明的变量。此变量指的是 BDE 为在主执行线程中处于活动状态的 BDE TDataSet 创建的默认 TSession。

```
procedure TWriteData.Execute;
var
  DataMod: TDataModule1;
  AppDir: String;
begin
  AppDir := ExtractFilePath(Application.ExeName);
  DataMod := TDataModule1.Create(nil);
  try
    with DataMod do
      begin
        //All sessions need a unique private directory
        Session1.PrivateDir := AppDir + IntToStr(Self.ThreadID);
        //All sessions share a common network control file
        Session1.NetFileDir := Session.NetFileDir;
        ForceDirectories(Session1.PrivateDir);
        try
          Query1.SQL.Text := FSQL;
          ClientDataSet1.Open;
          ClientDataSet1.SaveToFile(AppDir + FFileName);
          ClientDataSet1.Close;
        finally
          SysUtils.RemoveDir(Session1.PrivateDir);
        end; //try
      end; //begin
  finally
    DataMod.Free;
  end;
end; 
```

我希望这有帮助。

# java - lucene 索引查找查询比基于 where 子句的查询更慢

> ID：16088504
> 
> 赞同：1
> 
> 时间：2013-04-18T16:34:20.883
> 
> 标签：java, neo4j, cypher, spring-data-neo4j

我面临的问题是 start 子句中的 lucene 索引查找比 where 子句慢。例如

我在带有 java 进程的 mac 上运行 neo4j 1.9.M05，该进程具有 4 GB 堆、150 万个节点、500 万个关系和 500 万个属性。

查询如下所示......基本上它具有匹配和其他 where 条件。我们试图通过索引查找来优化大量查询，因此更改没有索引查找的现有查询，但看起来索引查找速度较慢

```
CYPHER 1.8 START a=node(21102),
cu=node:myindex(id="020513_1359970281348_1360024480338_2") 
MATCH cu<-[:cp_in]-(cp),
(out)<-[:ap]-(cp),
(out)-[:ac]->(path0_child)-[:acp*0..10]->(path0)
,(out)<-[:ahp]-(a) 
WHERE path0.id! =~'(?i)^\\Qtest\\E$' 
RETURN DISTINCT out SKIP 0 LIMIT 50 
```

我们正在使用spring数据并且放置索引查找缓存似乎没有帮助

```
Index<Node> index = template.getGraphDatabase().getIndex("myindex");
((LuceneIndex<Node>) index).setCacheCapacity("id", 30000000); 
```

非常感谢任何线索或建议

问候

赛

# python - 覆盖 OpenERP 约束

> ID：16088505
> 
> 赞同：1
> 
> 时间：2013-04-18T16:34:23.550
> 
> 标签：python, openerp

我想编写一个模块来覆盖模型对象上的一个约束，但仅仅覆盖约束方法是行不通的。我对方法的覆盖永远不会被调用，因为 OpenERP 使用它自己的继承机制。

我正在尝试在模块中使有关登录/退出操作的规则更加灵活，`hr_timesheet_sheet`以便员工可以在今天登录后记录前一天的工作时间。为此，我想覆盖字段`hr.attendance`上的约束`action`并允许任何更改，然后在时间表级别执行检查，以确保所有出勤操作都符合逻辑顺序。

我找到了[`hr.attendance`约束](http://bazaar.launchpad.net/~openerp/openobject-addons/6.1/view/7200/hr_attendance/hr_attendance.py#L66)。

```
def _altern_si_so(self, cr, uid, ids, context=None):
    """ Alternance sign_in/sign_out check.
        Previous (if exists) must be of opposite action.
        Next (if exists) must be of opposite action.
    """
    for att in self.browse(cr, uid, ids, context=context):
        # search and browse for first previous and first next records
        prev_att_ids = self.search(cr, uid, [('employee_id', '=', att.employee_id.id), ('name', '<', att.name), ('action', 'in', ('sign_in', 'sign_out'))], limit=1, order='name DESC')
        next_add_ids = self.search(cr, uid, [('employee_id', '=', att.employee_id.id), ('name', '>', att.name), ('action', 'in', ('sign_in', 'sign_out'))], limit=1, order='name ASC')
        prev_atts = self.browse(cr, uid, prev_att_ids, context=context)
        next_atts = self.browse(cr, uid, next_add_ids, context=context)
        # check for alternance, return False if at least one condition is not satisfied
        if prev_atts and prev_atts[0].action == att.action: # previous exists and is same action
            return False
        if next_atts and next_atts[0].action == att.action: # next exists and is same action
            return False
        if (not prev_atts) and (not next_atts) and att.action != 'sign_in': # first attendance must be sign_in
            return False
    return True

_constraints = [(_altern_si_so, 'Error: Sign in (resp. Sign out) must follow Sign out (resp. Sign in)', ['action'])] 
```

我尝试在我的模块中覆盖约束方法，但我的版本从未被调用。

```
def _altern_si_so(self, cr, uid, ids):
    """ Implementing this logic at the attendance level doesn't work, so
    we skip it, and check at the whole time sheet level. 's all good!"""
    return True 
```

我也尝试在同一个字段上添加我自己的约束，但随后它调用了两个版本，并且基本模块的约束可能会拒绝保存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:34:23.550

我[在启动板上发现了一个错误](https://bugs.launchpad.net/openobject-server/+bug/700451)，描述了我遇到的问题和修复。事实证明，您现在可以覆盖约束，但这非常繁琐。您必须在与基本模块具有*相同函数名称的**同一字段*上声明自己的约束。然后，只有这样，它才会调用您的约束而不是基本版本。

 *这是[我的模块](http://bazaar.launchpad.net/~zaber/openobject-addons/zaber-custom/view/head:/zaber_custom/hr.py#L136)，它覆盖了`hr_attendance`对操作的约束并允许任意组合。

```
class hr_attendance(osv.osv):
    _inherit = 'hr.attendance'

    def _altern_si_so(self, cr, uid, ids):
        """ Implementing this logic at the attendance level doesn't work, so
        we skip it, and check at the whole time sheet level. 's all good!"""
        return True

    _constraints = [(_altern_si_so, 
                     'Error: You should never see this message.', 
                     ['action'])] 
```*

# android - 如何正确自动启动APP

> ID：16088508
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:34:29.220
> 
> 标签：android, service, boot, autostart

我的应用程序的自动启动功能有问题。

我搜索了论坛，看到了很多建议，似乎没有一个有效，我不知道为什么。

这是**BootUpReciver.java**

```
package com.???.???;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;
import android.util.Log;
import android.widget.Toast;

public class BootUpReciver extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    if ("android.intent.action.BOOT_COMPLETED".equals(intent.getAction())) {
        //Intent pushIntent = new Intent(context, BackgroundService.class);
        //context.startService(pushIntent);

        Toast.makeText(context, "Device Booted", Toast.LENGTH_LONG).show();
        Log.d("TAG","Device Booted");

    }
}
} 
```

这是我的**清单**文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.???.???"
android:versionCode="1"
android:versionName="1.0" >

<uses-permission android:name="android.permission.VIBRATE"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />

<uses-sdk
    android:minSdkVersion="14"
    android:targetSdkVersion="17" />

<application
    android:theme="@android:style/Theme.Holo"
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name" >

    <receiver android:name=".BootUpReciver">
        <intent-filter>
            <action android:name="android.intent.action.BOOT_COMPLETED" />

            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </receiver>

    <activity
        android:name="com.???.???.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application> 
```

当我重新启动手机时，我什至看不到 Toast，为什么？我应该怎么办？我需要自动启动以获取一些 sharedprefs 并在每次启动时将值写入文件。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:40:27.383

在测试时，我发现如果我在 onReceive 中显示 toast，那么它没有显示。但是，如果我在 onReceive 中启动一个活动，那么它就可以工作。所以你也可以检查一下。开始一项活动或服务并在那里执行您的任务。

# mysql - 使用子查询链接 MySQL 以进行删除

> ID：16088519
> 
> 赞同：0
> 
> 时间：2013-04-18T16:35:21.110
> 
> 标签：mysql, subquery

我们有一个即将推出的订购系统，但是，我们需要清除其中一位客户的所有测试数据。由于需要设置的方式，网关部分容纳了多个客户端（即，网关服务于与其对话的几个不同的网站安装）。

在这样做时，我需要最终遍历并删除许多表的数据，但订单是让我绊倒的地方。我们对大多数表都有 client_id，但不是所有的......因此是问题所在。

期待`SELECT * FROM orders WHERE client_id = 1001`。然后，对于其中的每一个，我们需要`SELECT * FROM order_authorizations WHERE orders.order_id = order_authorizations.order_id`.

**到目前为止我正在使用的内容：**

```
SELECT * FROM order_authorizations
    WHERE 
        order_id IN (
            SELECT order_id FROM orders
        WHERE 
            order_authorizations.order_id = orders.order_id AND 
            orders.client_id = 1001
    )
; 
```

我不是子查询的天才，也许我做错了，但今天早上我已经浏览了许多其他线程和网站，无论如何，我一直得到“零结果”返回......所以我的方法有些不对劲。有任何想法吗？

**带结果的示例查询：**

```
SELECT order_id, client_id FROM `orders` WHERE client_id = 1001 LIMIT 0, 30 ; 
Rows: 10

order_id    client_id
1237    1001
1236    1001
1235    1001
1234    1001
1233    1001
1232    1001
1231    1001
1230    1001
1229    1001
1228    1001 
```

* * *

```
SELECT order_id
FROM  `order_authorizations` 
WHERE order_id =1237
LIMIT 0 , 30

MySQL returned an empty result set (i.e. zero rows). ( Query took 0.0001 sec ) 
```

* * *

问题是，我当然可以看到 order_id 列中有一个匹配 1237 的值。我在 phpMyAdmin 中直观地看到它，但查询显然与我们的测试不匹配。

**架构详细信息：**

```
CREATE TABLE IF NOT EXISTS `orders` (
  `order_id` int(11) NOT NULL AUTO_INCREMENT,
  `client_id` int(11) NOT NULL,
  `gateway_id` int(11) NOT NULL,
  `customer_id` int(11) DEFAULT '0',
  `subscription_id` int(11) NOT NULL,
  `card_last_four` varchar(4) NOT NULL,
  `amount` varchar(11) NOT NULL,
  `coupon_id` int(11) DEFAULT NULL,
  `customer_ip_address` varchar(14) DEFAULT NULL,
  `status` tinyint(1) NOT NULL DEFAULT '0',
  `timestamp` datetime NOT NULL,
  `refunded` tinyint(3) NOT NULL,
  `refund_date` datetime DEFAULT NULL,
  PRIMARY KEY (`order_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1238 ; 
```

* * *

```
CREATE TABLE IF NOT EXISTS `order_authorizations` (
  `order_authorization_id` int(11) NOT NULL AUTO_INCREMENT,
  `order_id` varchar(200) NOT NULL,
  `tran_id` varchar(255) NOT NULL,
  `authorization_code` varchar(200) NOT NULL,
  `security_key` varchar(200) NOT NULL,
  PRIMARY KEY (`order_authorization_id`)
) ENGINE=MyISAM  DEFAULT CHARSET=utf8 AUTO_INCREMENT=16 ; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:37:35.850

您可以进一步将其转换为`JOIN`,

```
SELECT  DISTINCT a.*
FROM    order_authorizations a
        INNER JOIN orders b
            ON a.order_id = b.order_id 
WHERE   b.client_id = 1001 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)

* * *

这是`DELETE`声明，

```
DELETE  a
FROM    order_authorizations a
        INNER JOIN orders b
            ON a.order_id = b.order_id 
WHERE   b.client_id = 1001 
```

# c# - 如何从 Facebook API 获取结果？

> ID：16088520
> 
> 赞同：0
> 
> 时间：2013-04-18T16:35:26.110
> 
> 标签：c#, json, facebook

我的代码在这里遇到了问题，现在我在谷歌上搜索了大约 3 个小时。

我只是在做一个 FQL 查询，我正在尝试读取结果。但不幸的是。我不知道怎么做。

```
var fbclient = new FacebookClient(accessToken);

            dynamic result = (IDictionary<string, object>)fbclient.Get("fql", new
            {
                q = new[]
                {
                    "SELECT name FROM user WHERE uid = me()",
                    "SELECT unread_count FROM mailbox_folder WHERE folder_id = 4 AND viewer_id = me()",
                    "SELECT is_unread FROM notification WHERE recipient_id = me()",
                    "SELECT unread FROM friend_request WHERE uid_to = me()"
                }
            });

            string name = "";

            foreach (dynamic data in result.data)
            {
                name = data.name;
            } 
```

最后一部分 ( `foreach`) 不起作用 - 只是我尝试的最后一件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-02T15:57:55.040

出色地。现在回答我自己的问题。花了一段时间，但我终于想出了如何从 FQL-Multi-Query 中获取信息。对于那些搜索相同的人：

```
dynamic result = fbclient.Get("fql", new
        {
            q = new[]
        {
            "SELECT unread_count FROM mailbox_folder WHERE folder_id = 0 AND viewer_id = me()",
            "SELECT is_unread FROM notification WHERE recipient_id = me()",
            "SELECT unread FROM friend_request WHERE uid_to = me()"
        }
        });

        var unread_messages = result["data"][0]["fql_result_set"][0]["unread_count"];
        var notifications = result["data"][1]["fql_result_set"];
        var open_friendRequests = result["data"][2]["fql_result_set"]; 
```

这就是我一直想要的;o)

此致，

丹尼

# yii - 如何直接从 Yii 中的模块调用控制器动作和视图？

> ID：16088523
> 
> 赞同：0
> 
> 时间：2013-04-18T16:35:38.200
> 
> 标签：yii, yii-extensions

我正在 Yii 中构建我的第一个模块（又一个 CMS 模块），以了解有关 Yii 及其功能的更多信息。下一步是我想在我所有页面的顶部添加一个“DEV 栏”。在我的布局中，我添加了以下内容：

```
<?php echo Yii::app()->getModule('cms')->toolbar(); ?> 
```

在我的 CmsModule 文件中，我添加了一个名为 toolbar() 的函数，但我不确定从这里去哪里。基本上，我想将我的 Page 模型发送到 CMS 工具栏，然后呈现 CMS 工具栏视图。我的工具栏应该有链接来编辑当前页面元和页面内容。为了遵循 Yii 和 MVC 的最佳实践，如何才能最好地实现？在 CmsModule 中，我会得到 PageModel，如果是，我将如何呈现 CMS 视图？我尝试使用 $this->render()，但出现错误：

```
 Using $this when not in object context 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:13:47.307

我不确定您所说的“页面模型”是什么意思，因为这不是 Yii 术语。所以我真的不能帮你。

但我想你误解了 Yii 中的模块是什么：它就像一个子应用程序，有自己的控制器、视图甚至模型。仅当您从该模块调用操作时，该模块才处于活动状态。

`getModule('cms')`如果该模块根本不活动，则获取模块的新实例没有多大意义。相反，您想要的可能是一个可以包含在主布局中的小部件。从该小部件中，您将呈现带有指向您的 CMS 模块的链接的顶部栏菜单。`component`如果您想将 CMS 相关代码放在一起，您也可以将该小部件放入模块的目录中。

# java - Java Weka：java.lang.ClassCastException

> ID：16088527
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:35:47.600
> 
> 标签：java, weka, cross-validation

我在 Weka 上做这个简单的实验。我试图做简单的交叉验证，我得到了这个错误。以下是从输出生成的错误消息。

```
java.lang.ClassCastException: java.lang.Integer cannot be cast to weka.classifiers.evaluation.output.prediction.AbstractOutput
at weka.classifiers.Evaluation.evaluateModel(Evaluation.java:1471)
at assg.Assg.crossValidation(Assg.java:171)
at assg.Assg.main(Assg.java:160) 
```

下面是我的编码

```
public static void crossValidation() throws Exception
{
    eval.evaluateModel(cls, training, 10, new Random(1));
    System.out.println(eval.toSummaryString());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:43:40.623

您是否阅读过错误消息和您正在调用的函数的文档？

```
 /**
   * Evaluates the classifier on a given set of instances. Note that
   * the data must have exactly the same format (e.g. order of
   * attributes) as the data used to train the classifier! Otherwise
   * the results will generally be meaningless.
   *
   * @param classifier machine learning classifier
   * @param data set of test instances for evaluation
   * @param forPredictionsPrinting varargs parameter that, if supplied, is
   * expected to hold a weka.classifiers.evaluation.output.prediction.AbstractOutput
   * object
   * @return the predictions
   * @throws Exception if model could not be evaluated
   * successfully
   */
  public double[] evaluateModel(Classifier classifier,
                                Instances data,
                                Object... forPredictionsPrinting) 
```

您将原始 int （自动装箱到`java.lang.Integer`）作为参数传递给期望`weka.classifiers.evaluation.output.prediction.AbstractOutput`. 由于类型不兼容，您显然会遇到转换错误。

# php - PHP 警告：非法字符串偏移

> ID：16088530
> 
> 赞同：5
> 
> 时间：2013-04-18T16:35:52.533
> 
> 标签：php, string, offset

我是 PHP 新手。一个 PHP 今天从 5.3.3 迁移到 5.4.4 版本（Debian Squeeze 到 Debian Wheezy），之后，我从 Apache 日志中得到这个错误：

**> PHP 警告：xyz 中的非法字符串偏移 'phptype'**

该行是：

```
self::$conn[$dsn['phptype']] = $mdb2; 
```

我需要帮助来恢复系统。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:49:52.743

```
<?php
$a = 'Hello';
echo $a['whatever'];
?> 
```

正如评论中的一些人所说，这样做可能会导致该错误。正如您在上面的示例中看到的那样，`$a`它是一个字符串而不是一个数组。这意味着您无法使用密钥访问它（但是，如果您想获取字符串中的第三个字母，则可以这样做`$a[2]`）。

您需要检查它实际上是数组而不是字符串`self::$conn`。`$dsn`正如 Álvaro G. Vicario 在评论中所说，您可以通过转储变量来做到这一点：

`var_dump(self::$conn, $dsn)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:39:32.953

当您尝试使用对象或数组作为索引键访问数组索引时，会发生非法偏移类型错误。检查您的阵列是否正确。

# sql - SQL：不是单个组函数....不是 GROUP BY 表达式

> ID：16088531
> 
> 赞同：1
> 
> 时间：2013-04-18T16:35:52.897
> 
> 标签：sql, oracle, oracle11g, aggregate-functions, min

我有许多表格，详细说明了商店的客户和销售情况等。

我想找到最低销售价格；即 SQL 表达式返回的单个结果。

为了使结果有意义，我还想将 customer_sale 表与 customer 表连接起来（这样有问题的客户也将返回他/她的姓名）。

使用以下代码

```
SELECT CUST_ORDER.CUST_ID, CUSTOMER.FNAME, CUSTOMER.LNAME, MIN(SALE_PRICE)
FROM CUST_ORDER
INNER JOIN CUSTOMER
ON CUST_ORDER.CUST_ID = CUSTOMER.CUST_ID
GROUP BY CUST_ORDER.CUST_ID
HAVING MIN(SALE_PRICE) = (SELECT MIN(SALE_PRICE) FROM CUST_ORDER GROUP BY CUST_ID) 
```

在 Oracle 11g 中抛出以下错误：

> 第 1 行出现错误：ORA-00979：不是 GROUP BY 表达式

这是有道理的，因为它只返回一个结果。

但是删除 GROUP BY 子句会导致 dbms 抛出以下错误：

```
SELECT CUST_ORDER.CUST_ID, CUSTOMER.FNAME, CUSTOMER.LNAME, MIN(SALE_PRICE)
FROM CUST_ORDER
INNER JOIN CUSTOMER
ON CUST_ORDER.CUST_ID=CUSTOMER.CUST_ID
HAVING MIN(SALE_PRICE) = (SELECT MIN(SALE_PRICE) FROM CUST_ORDER) 
```

> 第 1 行出现错误：ORA-00937：不是单组组函数

为了让语句正确执行，我需要做一些额外的嵌套吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:45:48.563

如果你真的只是得到整张桌子的最小值，也许就是这样：

```
SELECT DISTINCT CUST_ORDER.CUST_ID, CUSTOMER.FNAME, CUSTOMER.LNAME, SALE_PRICE
FROM CUST_ORDER
INNER JOIN CUSTOMER
ON CUST_ORDER.CUST_ID=CUSTOMER.CUST_ID
WHERE SALE_PRICE = (SELECT MIN(SALE_PRICE) FROM CUST_ORDER) 
```

我不确定您是否需要`DISTINCT`，或者您的数据看起来如何。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:45:41.760

在您的第一个查询中，您似乎需要另外 GROUP BY 客户的名字和姓氏，因为您还选择选择它们：

```
SELECT CUST_ORDER.CUST_ID, CUSTOMER.FNAME, CUSTOMER.LNAME, MIN(SALE_PRICE)
FROM CUST_ORDER
INNER JOIN CUSTOMER
ON CUST_ORDER.CUST_ID = CUSTOMER.CUST_ID
GROUP BY CUST_ORDER.CUST_ID, CUSTOMER.FNAME, CUSTOMER.LNAME
HAVING MIN(SALE_PRICE) = (SELECT MIN(SALE_PRICE) FROM CUST_ORDER) 
```

# java - Apache TelnetClient，InputStream 无法使用 Apache IOUtils 转换为字符串

> ID：16088541
> 
> 赞同：1
> 
> 时间：2013-04-18T16:36:09.020
> 
> 标签：java, telnet

我在 telnet 会话中的 InputStream 遇到了一些问题。我已经建立了连接，我可以通过 telnet 成功发送命令，并且使用 System.out.println，我可以看到我收到了正确的响应。

我需要将会话的响应作为字符串返回，因为我需要对其执行正则表达式来验证测试的值。

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.io.PrintStream;
import java.io.Reader;
import java.io.StringWriter;
import java.io.Writer;
import java.net.SocketException;

import org.apache.commons.io.IOUtils;
import org.apache.commons.net.telnet.TelnetClient;

public class TelnetService {

private final String server;
private final int port;
private TelnetClient telnet = new TelnetClient();
private InputStream dataIn;
private PrintStream dataOut;
private String prompt = "~$";

public TelnetService(String server, int port) {
    this.server = server.replace("http://", "");
    this.port = port;
}

    private void startTelnetSession() throws SocketException, IOException {
    telnet.connect(server, port);
    dataIn = telnet.getInputStream();
    dataOut = new PrintStream(telnet.getOutputStream());
}

public String getTelnetSessionAsString() {
    try {
        startTelnetSession();
        loginUser();
        readUntil(prompt);
        write("this_command");
        readUntil(prompt);
        StringWriter writer = new StringWriter();
        IOUtils.copy(dataIn, writer, "UTF-8");
        dataOut.flush();
        dataIn.close();
        dataOut.close();
        String received = writer.toString();
        telnet.disconnect();
        return received;
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
}

private void loginUser() {
    readUntil("login:");
    write("foo");
    readUntil("Password:");
    write("bar");
}

private void write(String value) {
    try {
        dataOut.println(value);
        dataOut.flush();
        System.out.println(value);
    } catch (Exception e) {
        e.printStackTrace();
    }

}

private String readUntil(String pattern) {
    try {
        char lastChar = pattern.charAt(pattern.length() - 1);
        StringBuffer buffer = new StringBuffer();
        char ch = (char) dataIn.read();
        while (true) {
            System.out.print(ch);
            buffer.append(ch);
            if (ch == lastChar) {
                if (buffer.toString().endsWith(pattern)) {
                    return buffer.toString();
                }
            }
            ch = (char) dataIn.read();
        }
    } catch (Exception e) {
        e.printStackTrace();
    }
    return null;
}
} 
```

事实上，每当调用这个类的测试运行时，它似乎在

```
IOUtils.copy(dataIn, writer, "UTF-8"); 
```

我敢肯定，我缺少一些非常简单的东西。有没有人可以提供帮助？将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T10:28:45.957

碰巧我能够解决这个问题 - 不完全是我希望的，但它足够适合简单的测试功能。

我将 telnet inputStream 写入文件而不是 System.out.print 中。这使我可以从文件中读回字符串。

我仍然希望解决这个问题——我想这是一个线程问题，我仍然不是初学者，所以还没有解决过类似的问题。

# wcf - NetMessagingBinding 轮询间隔和并发

> ID：16088542
> 
> 赞同：2
> 
> 时间：2013-04-18T16:36:10.163
> 
> 标签：wcf, azure, appfabric, servicebus

我正在实施服务总线客户端来接收队列消息，并且需要估计每月的使用费用。

根据我阅读的内容，我可以使用[QueueClient直接控制轮询](http://msdn.microsoft.com/en-us/library/microsoft.servicebus.messaging.queueclient.aspx)

或者我可以通过 netMessagingBinding 使用 WCF 模型。

据我了解，netMessagingBinding 确实会进行轮询，但是我无法找到关于它轮询频率的明确答案。另外，它保留了多少并发连接？

任何人都可以帮助我回答或将我指向详细描述此问题的正确文章吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-27T00:36:50.717

netMessagingBinding 遵循与操作超时相同的默认值，因此与在循环中调用 Receive() 的体验类似。目前，单次通话需要 60 秒，如果整个月都没有找到消息，那么这将增加大约 14 美分的费用。

# emacs - 格式化数据：将列设置为行（以及其他方式）

> ID：16088545
> 
> 赞同：5
> 
> 时间：2013-04-18T16:36:18.430
> 
> 标签：emacs, elisp

考虑这种情况：我有一些看起来像这样的数据：

> 1.9170000E+03 $ 1.6909110E+00
> 1.4550000E+03 $ 1.7775459E+00 1.1800000E + 03
> $ 1.8771469E+00
> 1.0000000E+ 00 1.0000000E+03 2.5585915e+00

请注意，分隔两列的美元符号可以是任何字符（范围从一定数量的空格、\t（制表符）字符、逗号或几乎任何唯一用于分隔列的字符。另请注意数据可能有两列以上。

现在我想重新格式化数据块，以便某一列中的所有项目都列在一行中（由我在上面的示例中标记为 $ 的字符分隔）：第 0 列中的项目填充第 0 行，第 1 列中的项目填充第 1 行，依此类推。

是否有预定义的 emacs 函数可以做到这一点？或者如果没有，是否有一些“自卷”功能来实现这一目标？

此外，我对执行相反操作的函数非常感兴趣，即取一些行并将它们放入列结构中。

任何帮助深表感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T16:49:06.943

您可以使用`csv-mode`（可从`package.el`）。这是一个简单的转置操作。为此，请自定义 to 的值，`csv-separators`然后`'("$")`使用`C-c C-t`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T21:32:32.813

只是为了练习：

```
(defun transpose-table (begin end &optional numcols)
  (interactive "r\nP")
  (save-excursion
    (goto-char begin)
    (move-beginning-of-line 1)
    (let ((separators
           (if numcols
               (loop for i from 0 upto
                     (if (numberp numcols) numcols (car numcols))
                     for sep =
                     (read-string
                      (format "%d'th column separator (RET to terminate): " i))
                     until (string= sep "")
                     collect sep)
             (let ((x (list " "))) (nconc x x))))
          (end (save-excursion
                 (goto-char end)
                 (move-end-of-line 1)
                 (point))) lines)
      (loop while (< (point) end)
            for start = (point)
            for line = (buffer-substring 
                        start 
                        (progn (move-end-of-line 1) (point)))
            for numlines from 0
            with numrows = 0
            with longest-word = 0
            collect (loop for i from 0 below (length line)
                          with last-pos = 0
                          with rows = 0
                          with sep = separators
                          for sep-length = (length (car sep))
                          if (and (< (+ sep-length i) (length line))
                                  (string= (car sep)
                                           (substring line i (+ i sep-length))))
                          collect (substring line last-pos i) into words
                          and do (setf longest-word (max longest-word (- i last-pos))
                                       last-pos (+ i sep-length)
                                       sep (cdr sep) rows (1+ rows))
                          end
                          finally (return
                                   (progn
                                     (setf numrows (max rows numrows))
                                     (if (< last-pos (length line))
                                         (append words (list (substring line last-pos)))
                                       words))))
            into lines
            collect longest-word into word-lengths
            do (unless (eobp) (forward-char))
            finally 
            (loop initially (delete-region begin end)
                  for i from 0 to numrows do
                  (loop for line on lines 
                        for cell-length in word-lengths do
                        (if (caar line)
                            (let ((insertion (caar line)))
                              (insert insertion
                                      (make-string
                                       (- cell-length (length insertion) -1) ?\ ))
                              (rplaca line (cdar line)))
                          (insert (make-string (1+ cell-length) ?\ ))))
                  (insert "\n")))))) 
```

也许使用 from`csv-mode`实际上会更好，但无论如何你都可以尝试这个:)

它是如何工作的：如果您将其称为`M-x``transpose-table`，那么它将假定表格列由单个空格分隔，但是，如果您使用数字参数调用它（例如，`M-3``M-x``transpose-table`，那么它将提示您收集 3 个列分隔符。您也可以将其称为，并在被要求提供额外分隔符时`C-u``C-u``M-x``transpose-table`选择不提供所有 16 个分隔符。`RET`

我找不到正确的数字功能的序数打印......所以，对不起“1'th”和“2'th”英文:)

# html - 在 li 列表之间制作一个断路器 li

> ID：16088549
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:36:29.743
> 
> 标签：html, css

我正在尝试制作一个动态列表，我想在其中的某个位置制作一个断路器列表，但我不知道如何设置特定 li 的样式？

这是我想要完成的事情：

```
<ul id="games">
    <li class="myturn">Test 1</li>
    <li class="myturn">Test 2</li>
    <li class="breaker" style="height:3px;"></li>
    <li class="theirturn">Test 3</li>
    <li class="theirturn">Test 4</li>
    <li class="theirturn">Test 5/li>
    <li class="theirturn">Test 6</li>
</ul> 
```

这可以做到吗？我无法让它工作。任何帮助表示赞赏并提前感谢:-)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:40:02.387

CSS：

```
.breaker{
    list-style-type: none;
    border:1px #000 solid
} 
```

小提琴：http: [//jsfiddle.net/bB52W/1/](http://jsfiddle.net/bB52W/1/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:42:19.477

不要用标记来做。您正在使用标记进行样式设置，这是一个诺诺。只需将一个类添加到最后一个 myturn 元素并添加 margin-bottom: 10px;

```
<ul id="games">
    <li class="myturn">Test 1</li>
    <li class="myturn breaker">Test 2</li>
    <li class="theirturn">Test 3</li>
    <li class="theirturn">Test 4</li>
    <li class="theirturn">Test 5</li>
    <li class="theirturn">Test 6</li>
</ul>

.breaker{
  margin-bottom: 10px;
} 
```

[演示](http://jsfiddle.net/bB52W/3/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:49:14.887

```
<style>

#games li {
   /* your style for all LI's */
}

#games .myturn, #games .theirturn {
}

#games .breaker { 
    height: 3px;
}

</style> 
```

你也可以只`<li>`用`<hr>` 它来填充你的水平线，仍然可用`html5`且有用。平时是这样的。。

* * *

默认情况下它有`display:block;`。

# mysql - SQL - 检查可用性

> ID：16088550
> 
> 赞同：2
> 
> 时间：2013-04-18T16:36:30.480
> 
> 标签：mysql, sql

我计划开发一个酒店管理系统，其中每家酒店都有/拥有特定天数的价格。速率值存储在另一个很好的表中。

表如下。

![在此处输入图像描述](https://i.stack.imgur.com/vtkD3.jpg)

我用来检查特定日期范围内是否存在现有费率的 SQL 查询。

```
SELECT * FROM `hotel_rate` 
WHERE 
(from_date <= '2013-04-18' AND to_date <= '2013-04-22') OR
(from_date >= '2013-04-18' AND to_date >= '2013-04-22') OR
(from_date >= '2013-04-18' AND to_date <= '2013-04-22') OR
(from_date <= '2013-04-18' AND to_date >= '2013-04-22') 
```

我想要做的是将日期范围从“2013-04-18”添加到“2013-04-22”。从“2013-04-20”到“2013-04-23”的日期范围已经添加了费率。因此，我想通知正在添加费率的管理员，他/她选择的特定时期已经应用了费率。

问题是我的 SQL 查询从数据库中获取所有行，因为我只想获取速率重叠的特定行。在我的示例结果集中应该只包含 id = 4 的行。

鉴于据我所知，在添加费率之前，我应该检查以下 4 个条件。两条黑线显示酒店的现有价格。黄线显示​​可能的重叠场景。在任何给定的集合中，第一条黄线是 from_date，第二条黄线是 to_date。

![在此处输入图像描述](https://i.stack.imgur.com/zKRd7.png) 我怎样才能解决这个问题 ？我怎样才能得到重叠率行？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:41:45.397

我不太确定我是否在关注，但您似乎想确定是否有任何记录与输入的两个日期有某种重叠。如果是这样的话，我会建议这个

```
SELECT * FROM `hotel_rate`
WHERE
  from_date BETWEEN ? AND ?
  OR to_date BETWEEN ? AND ? 
```

当然，这`?`是你的两个约会。发生重叠所需要的只是记录的 from_date 或记录的 to_date 落在输入日期（包括输入日期）之间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:44:21.560

我认为您想要以下内容：

```
WHERE (from_date <= '2013-04-18' AND to_date >= '2013-04-18') OR
 (from_date <= '2013-04-22' AND to_date >= '2013-04-22') OR
 (from_date >= '2013-04-18' AND to_date <= '2013-04-22') 
```

前两个检查围绕从或到日期的任何范围。最后一次检查是针对 2 内的任何范围。

# html - 如何根据用户在页面上向上或向下滚动的距离使对象出现和消失？

> ID：16088554
> 
> 赞同：2
> 
> 时间：2013-04-18T16:36:42.917
> 
> 标签：html, css, effects, jquery-effects

我正在尝试制作一个固定在页面顶部的标题，只有在用户向下滚动到页面顶部的其他内容（即我的“黑盒”div）时才会出现。如果我能让标题也能正常工作，我可能想对网站上的其他一些东西使用同样的效果，但我们会看到的。

```
.header{
background:yellow; 
width:100%;
height:70px;
position:fixed;
top:0px;
box-shadow: 2px 5px 10px rgba(0,0,0,0.2);
z-index: 10;
}

.blackbox{
background:black;
width:100%;
height:350px;
top:60px;
overflow:hidden;
position:fixed;
z-index:3;
}

.homespace{
width:100%;
background:green;
height:700px;
position:relative;
margin-top:0px;
z-index:8;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:58:06.040

您可以使用 JQUERY。

假设您正在滚动页面。

```
$(document).scroll(function(){
    if($(document).scrollTop()>"100")
      //after you've scrolled 100 pixels...
      $("#something").show();
}); 
```

[**现场演示**](http://jsfiddle.net/wkgHe/)

更多关于：[.scroll()](http://api.jquery.com/scroll/) [.scrollTop()](http://api.jquery.com/scrollTop/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:54:49.603

您可以为此使用 jQuery。

```
$(document).ready(function(){
    $(window).scroll(function () {
       $('.blackbox').fadeIn();
        if($(this).scrollTop()==0){
         $('.blackbox').fadeOut();
        }
    });
}); 
```

这是 JSFiddle 上的一个示例 - **[LIVE DEMO](http://jsfiddle.net/yqHpE/1/)**（滚动右下角窗口以查看实际演示）

[.scroll()](http://api.jquery.com/scroll/)和[scrollTop()](http://api.jquery.com/scrollTop/)等 jQuery 方法就是您所需要的。他们会让你的生活变得轻松。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:57:34.023

参考这篇文章：

[如何获取用户向下滚动页面的像素数？](https://stackoverflow.com/questions/4081064/how-to-get-the-num-of-pixels-a-user-has-scrolled-down-the-page)

基本上确定用户滚动了多远，将该值与“黑盒”的高度进行比较，然后让 JS 应用一个类或使用 jQuery 之类的东西来隐藏（）或显示（）。

# c# - 如何在自定义会员提供程序中实现 oAuth

> ID：16088557
> 
> 赞同：2
> 
> 时间：2013-04-18T16:36:45.153
> 
> 标签：c#, asp.net-mvc

我正在使用`nhibernate`不同的数据库（取决于项目）来保存数据。因此，我使用`custom membership provider`用户和角色来`authenticate`登录和`authorize`访问某些页面。

现在我想为我的新用户和当前用户提供使用他们的`social network account`.

我知道`asp.net mvc4`自带的内置`simplemembership provider`处理此登录开箱即用，但我必须升级我的自定义成员资格提供程序，因为我已经解释过（许多数据库，不仅仅是`microsoft sql`）。

您会推荐我使用哪种解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:27:26.780

Open App_Start\AuthConfig.cs and enable whatever social media authorization that you'd like.

For more details, see [http://blogs.msdn.com/b/webdev/archive/2012/08/15/oauth-openid-support-for-webforms-mvc-and-webpages.aspx?PageIndex=2](http://blogs.msdn.com/b/webdev/archive/2012/08/15/oauth-openid-support-for-webforms-mvc-and-webpages.aspx?PageIndex=2)

# geocoding - 将地址转换为坐标

> ID：16088560
> 
> 赞同：1
> 
> 时间：2013-04-18T16:37:01.717
> 
> 标签：geocoding, street-address

如何在坐标（纬度和经度）中转换大量地址（带有街道地址、城市和街道号码）？

...无需一次做一个？有没有剧本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:48:18.870

听起来您正在寻找的是地理编码 - 获取地址并将其转换为相应的纬度和经度坐标。如果您的所有地址都在一个列表中，您可以使用提供批处理的服务，这样您就不必一次上传一个地址。或者，您可以通过循环脚本来处理每个地址（一次一个，但速度非常快）；为此，您需要一个提供 API 的服务，让您以编程方式处理地址。

如果您可以首先标准化和验证地址，您将从地理编码中获得更准确的结果——基本上，只需通过将地址与一组已知的有效数据进行比较来确保地址是真实的。这就是我的专长所在；我在[SmartyStreets](http://smartystreets.com)工作。

您可以使用多种不同的服务进行地理编码，每种服务都会为您提供略有不同的结果。最好的地理编码数据似乎来自 GoogleMaps 和 Bing，但他们的服务条款禁止您存储他们的地理编码或将数据用于除显示在他们的地图上之外的任何其他用途。以下是对一般地理编码数据可能会发现的质量的一个很好的解释：http: [//smartystreets.com/kb/faq/how-accurate-is-your-geocoding-data](http://smartystreets.com/kb/faq/how-accurate-is-your-geocoding-data)

SmartyStreets 专注于验证和地理编码地址。我们提供名为[LiveAddress](http://smartystreets.com/products/liveaddress-lists)的服务，让您可以上传地址列表或使用我们的 API，我们将处理它们并返回大量数据——包括纬度和经度。它速度超快，可为您提供有关每个地址的更多信息。

一些注意事项：对于许多地址来说，这不是一个完全免费的选项，但价格可能是您能找到的此类服务的最佳价格。SmartyStreets（以及列表的 LiveAddress）也只能提供美国地址的信息；因此，如果您要对全球地址进行地理编码，我们将无法为所有这些地址提供帮助。

就像我说的，有很多服务可以用来获取地理编码数据。我建议查看一些不同的选项并找到对您最有用的选项。使用“地址验证”等术语的 Google 搜索将为您提供一个很好的选项列表供您选择。

# networking - 如何使用 OpenBSD 中的数据包过滤器根据标志过滤 TCP 数据包

> ID：16088564
> 
> 赞同：2
> 
> 时间：2013-04-18T16:37:13.230
> 
> 标签：networking, filtering, firewall, flags, openbsd

好吧，我并不确切知道如何提出这个问题，但我知道您可以使用关键字*flags*来指定要过滤的标志。

根据数据包过滤器的文档：

> 为了让 PF 在评估规则期间检查 TCP 标志，flags 关键字与以下语法一起使用：
> 
> 标志检查/屏蔽
> 标志任何
> 
> 掩码部分告诉 PF 只检查指定的标志，而检查部分指定标头中必须“打开”哪些标志才能发生匹配。使用 any 关键字允许在标题中设置任​​何标志组合。
> 
> 传入 fxp0 proto tcp 从任何到任何端口 ssh 标志 S/SA
> 传入 fxp0 proto tcp 从任何到任何端口 ssh
> 
> 由于默认设置了标志 S/SA，因此上述规则是等效的，这些规则中的每一个都通过设置了 SYN 标志的 TCP 流量，而只查看 SYN 和 ACK 标志。带有 SYN 和 ECE 标志的数据包将匹配上述规则，而带有 SYN 和 ACK 或仅 ACK 的数据包则不会。

所以，我理解了这个例子以及为什么带有标志 S 和 E 的数据包可以通过（因为由于掩码 SA 不考虑 E 标志）以及为什么只有 Ack 标志的数据包不能通过防火墙。

我不明白的是为什么带有标志 S 和 A 的数据包不能通过规则 S/SA，如果标志 S 在数据包头中为“on”。也许文档是模棱两可的？对不起，如果这是一个愚蠢的问题或英语误解。

我想它只有在必须**只有**标志 S 的情况下才能通过。在集合算术中将是这样的：

**标头中的标志必须为“开”** ->**标志属于掩码子集**[pf doc]
**只有标头中的标志必须为“开”** ->**标志与被屏蔽的子集**[我从给出的例子中理解的]

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T20:36:37.503

> 我不明白的是为什么带有标志 S 和 A 的数据包不能通过规则 S/SA，如果标志 S 在数据包头中为“on”。也许文档是模棱两可的？

来自 pf.conf(5) 中的标志部分

> 旗帜 (A)/(B) | 任何
> 
> 此规则仅适用于标志 (A) 设置为集合 (B) 的 TCP 数据包。

如果 (B) := SA 和 (A) := S -> 此规则仅适用于在设置的 SA 中设置了标志 S 的 TCP 数据包。

这意味着它没有 A 集。稍微解释一下：

> 此规则仅适用于具有完全不同的标志 (A) 设置 (B) 的 TCP 数据包

或者正如手册页稍后澄清的那样：

> 标志 S/SA
> 
> 这是有状态连接的默认设置。
> 
> 在 SYN 和 ACK 之外，可以设置正好 SYN

# c# - VS 2012 Designer 无法显示

> ID：16088565
> 
> 赞同：1
> 
> 时间：2013-04-18T16:37:15.527
> 
> 标签：c#, winforms, visual-studio-2012, devexpress

我有一个`Employee_EmployeeKeyOneRelationUC`继承自`RelationUC`该继承自`RelationBase`该继承自的 UserControl 类`System.Window.Forms.UserControl`

当我尝试`Employee_EmployeeKeyOneRelationUC`在设计器中打开我的时，出现此错误：

`The designer could not be shown for this file because none of the classes within it can be designed. The designer inspected the following classes in the file: Employee_EmployeeKeyOneRelationUC --- The base class 'AstusFMS.Content.RelationUC' could not be loaded. Ensure the assembly has been referenced and that all projects have been built.`

但是当我打开`RelationUC`并且`RelationBase`两者都正确显示时。

我的程序仍在编译，但为什么这让我感到困扰？因为我有一个`EmployeeForm`使用很多`UserControl`（如`Employee_EmployeeKeyOneRelationUC`）的表单，当我尝试编辑此表单中的某些内容时，表单中包含的每个继承自的 UserControl 都将`UserControleBase`被删除（左：TFS 服务器，右：本地）：

![EmployeeForm.Designer.cs 的差异（左：TFS 服务器，右：本地）  ](https://i.stack.imgur.com/QPlG0.jpg)

这个差异表明设计师删除了我所有的`ucEmployee*`对象。仅仅因为我更改了 ComboBox 的名称（组合框与其中一个 UC 无关）。

我注意到，当我创建一个新的 UserControl 文件时，显示的默认代码有一个错误： ![默认用户控件有错误](https://i.stack.imgur.com/ggXJ1.jpg)

但它就在`Using System.Windows.Forms;`那里。如果我改变它的`UserControl`工作`System.Windows.Forms.UserControl`原理。

我可能不够清楚，所以如果你有问题，我会整天回答和测试。

用 VS2010、VS2012 更新 1、VS2012 更新 2 在 3 台不同的计算机上测试

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T17:45:20.823

在 Form 或 Usercontrol 中使用泛型时，建议您放置一个定义 Generic 类型的空类。您当前的 Form 然后派生自该类。

我把那个类放在同一个文件中。它必须在实际的表单代码之后，如下所示：

```
 public partial class Employee_EmployeeKeyOneRelationUC
    : Employee_EmployeeKeyOneRelation_GenericUC
  { ... }

  public class Employee_EmployeeKeyOneRelation_GenericUC
    : RelationUC<MyObject>
  { } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-03T02:09:43.607

VS2013 has a a bug with the form designer if you load in from VS2010 a C++ CLR Winforms app. "The designer could not be shown for this file because none of the classes within it can be designed. "

If you change and save the source file then the form designer starts to work again. But it fails again on loading in the project again. Looks like a race between loading the source file and the form designer parsing the code.

# unit-testing - AngularJS - 具有值依赖注入的单元测试服务

> ID：16088567
> 
> 赞同：4
> 
> 时间：2013-04-18T16:37:26.147
> 
> 标签：unit-testing, angularjs, angularjs-service

我目前正在尝试使用 AngularJS。我创建了一个简单的服务，它是从一些遥远的数据初始化的。url 作为应用程序值传递。

```
//App declaration
angular.module('myApp', ['myApp.services']).value('someUrl', 'http://www.example.com');

//Service declaration
angular.module('myApp.services', ['someUrl']).factory('MyService', function(someUrl) {
    var data;
    "Do stuff"  
    return data;
}); 
```

现在，我正在尝试对此进行单元测试，但我无法正确设置“someUrl”参数。我尝试过这样的事情，但没有成功：

```
angular.module('myApp', ['myApp.services']).value('someUrl', 'test/test.json');

describe('Services', function() {
    beforeEach(module('myApp.services'));

    describe('MyService', function() {
        it('should return {success: true}', inject(function() {
            expect(data).toEqual({success: true});
        }));
    });
}); 
```

但是，我总是收到“无模块：someUrl”错误。在单元测试期间初始化应用程序值的正确语法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T18:44:55.067

您将值设置为“myApp”模块并正在测试“myApp.services”模块。您应该更改`module('myApp.services')`为`module('myApp')`.

无论如何，有一个更好的方法可以做到这一点。您可以使用 mock`module`进行注入`$provide`，这样您就可以覆盖任何依赖项。

这就是您的规范的样子：

```
describe('Services', function() {
  // here we load the module myApp and load an additional one that
  // allows you to override your dependency
  beforeEach(module('myApp', function($provide) {
    $provide.value('someUrl', 'test/test.json');
  }));

  describe('MyService', function() {
    it('should return {success: true}', inject(function() {
        expect(data).toEqual({success: true});
    }));
  });
}); 
```

# django - OpenShift 上的 Django：“没有这样的表”

> ID：16088568
> 
> 赞同：0
> 
> 时间：2013-04-18T16:37:29.867
> 
> 标签：django, sqlite, openshift

当我尝试加载任何页面时出现这种错误。

运行`sqlall`throw the ssh 显示数据库 shema 正常。

我有这样一个设置文件：

```
if ON_OPENSHIFT:
    # os.environ['OPENSHIFT_MYSQL_DB_*'] variables can be used with databases created
    # with rhc cartridge add (see /README in this git repo)
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',  # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
            'NAME': os.path.join(os.environ['OPENSHIFT_DATA_DIR'], 'sqlite3.db'),  # Or path to database file if using sqlite3.
            'USER': '',                      # Not used with sqlite3.
            'PASSWORD': '',                  # Not used with sqlite3.
            'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
            'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
        }
    }
else:
    DATABASES = {
        'default': {
            'ENGINE': 'django.db.backends.sqlite3',  # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
            'NAME': os.path.join(PROJECT_DIR, 'sqlite3.db'),  # Or path to database file if using sqlite3.
            'USER': '',                      # Not used with sqlite3.
            'PASSWORD': '',                  # Not used with sqlite3.
            'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
            'PORT': '',                      # Set to empty string for default. Not used with sqlite3.
        }
    } 
```

我在 /data 目录中有我的数据库的副本。

另外，我有这样的启动钩子：

```
source $OPENSHIFT_HOMEDIR/$cartridge_type/virtenv/bin/activate

if [ ! -f $OPENSHIFT_DATA_DIR/sqlite3.db ]
then
    echo "Copying $OPENSHIFT_REPO_DIR/wsgi/openshift/sqlite3.db to $OPENSHIFT_DATA_DIR"
    cp "$OPENSHIFT_REPO_DIR"wsgi/openshift/sqlite3.db $OPENSHIFT_DATA_DIR
    python "$OPENSHIFT_REPO_DIR".openshift/action_hooks/secure_db.py | tee ${OPENSHIFT_DATA_DIR}/CREDENTIALS
else
    echo "Executing 'python $OPENSHIFT_REPO_DIR/wsgi/openshift/manage.py syncdb --noinput'"
    python "$OPENSHIFT_REPO_DIR"wsgi/openshift/manage.py syncdb --noinput
fi

echo "Executing 'python $OPENSHIFT_REPO_DIR/wsgi/openshift/manage.py collectstatic --noinput'"
python "$OPENSHIFT_REPO_DIR"wsgi/openshift/manage.py collectstatic --noinput 
```

所以一切似乎都很好。

（但是，在我看来，启动挂钩尚未启动。）

**编辑**：我不知道为什么，但是在手动将数据库复制到 /data 之后 - 它**工作正常**！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:26:56.437

您是使用快速入门还是构建这些？要检查的一些事情是确保添加的挂钩是可执行的（chmod +x）。这些 echo 语句应该显示在您的 git push 日志/输出中，因为那是执行这些构建/部署挂钩的时间。
很高兴现在对你有用。

# antlr4 - 类 JSON 语言的语法

> ID：16088572
> 
> 赞同：0
> 
> 时间：2013-04-18T16:37:49.087
> 
> 标签：antlr4

我正在尝试为类似 JSON 的语言设计语法。主要区别在于属性名称不需要双引号（尽管可以），并且数字只是整数（没有浮点数）。

这是一个例子：

```
{
  "property1": "string value",
  property2: 321,
  arr: [1,2,3]
} 
```

这是我的（尝试）语法：

```
grammar Command;

command: object;

object:   '{' pair (',' pair)* '}' ;

pair: name ':' value ;

name
   : '"' ID '"'
   | ID
   ;

value
    :   string
    |   integer
    |   object
    |   array
    |   bool
    ;

array: '[' value (',' value)* ']' ;

string: STRING ;

integer
      : ZERO
      | NONZERO 
      ;

bool
   : 'true' 
   | 'false' 
   ;

ID : [a-zA-Z0-9_]+ ;
STRING: '"' (ESC | .)*? '"' ;
fragment ESC: '\\"' | '\\\\' ;

ZERO: '0' ;
NONZERO: '-'? [1-9] [0-9]* ; 
WS  :   [ \t\n\r]+ -> skip ; 
```

但是，尝试在我的示例输入上运行 TestRig，我得到

```
line 2:2 no viable alternative at input '"property"'
line 3:10 no viable alternative at input '321'
line 4:8 no viable alternative at input '1'
line 4:10 no viable alternative at input '2'
line 4:12 no viable alternative at input '3' 
```

有什么想法我哪里出错了吗？

谢谢你的时间！

托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:09:57.813

*   词法分析器正在为 创建单个`STRING`标记`"property"`，因此您应该调整`name`规则：

    ```
    name : STRING | ID; 
    ```

*   您需要在和`ID`之后移动规则。由于您的数字也符合词法分析器规则，因此将根据语法中出现的第一条规则为它们分配标记类型。您希望第一条规则是or ，目前它在哪里。（由于您的所有数字当前都生成标记，并且不允许作为，因此您会收到语法错误。）`ZERO``NONZERO``ID``ZERO``NONZERO``ID``ID``ID``value`

# sql-server - 基于字典的查询的查询索引

> ID：16088576
> 
> 赞同：1
> 
> 时间：2013-04-18T16:38:10.230
> 
> 标签：sql-server

查询和索引以下内容的最有效方法是什么：

```
SELECT * Persons.LastName A-D
SELECT * Persons.LastName E-L
SELECT * Persons.LastName M-R
SELECT * Persons.LastName S-Z 
```

我正在使用以下效率极低且难以索引的内容：

```
WHERE LastName LIKE '[a-d]%' 
```

关于更好的解决方法的任何想法？我认为这对于过滤索引来说可能是一个很好的场景，但是 where 子句需要更加可搜索。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:12:34.447

正如 Sam 所说，`LIKE '[a-d]%'`是 SARGable（几乎）。几乎是因为没有优化`Predicate`（更多信息见下文）。

示例 #1：如果您在[AdventureWorks2008R2](http://msftdbprodsamples.codeplex.com/releases/view/59211)数据库中运行此查询

```
SET STATISTICS IO ON;
SET NOCOUNT ON;

PRINT 'Example #1:';
SELECT  p.BusinessEntityID, p.LastName
FROM    Person.Person p
WHERE   p.LastName LIKE '[a-a]%' 
```

然后，您将获得基于`Index Seek`运算符的执行计划（优化谓词：绿色矩形，非优化谓词：红色矩形）： ![在此处输入图像描述](https://i.stack.imgur.com/ifX1q.png) 输出`SET STATISTICS IO`为

```
Example #1:
Table 'Person'. Scan count 1, logical reads 7 
```

这意味着服务器必须从缓冲池中读取 7 个页面。此外，在这种情况下，索引`IX_Person_LastName_FirstName_MiddleName`包括和子句所需的所有列：LastName 和 BusinessEntityID。如果表具有聚集索引，则所有非聚集索引都将包含聚集索引键中的列（BusinessEntityID 是 PK_Person_BusinessEntityID 聚集索引的键）。`SELECT``FROM``WHERE`

但：

1) 您的查询必须显示所有列，因为`SELECT *`（这是一种*不好*的做法）：BusinessEntityID、LastName、FirstName、MiddleName、PersonType、...、ModifiedDate。

2) 索引（`IX_Person_LastName_FirstName_MiddleName`在前面的示例中）不包括所有必需的列。这就是为什么对于这个查询，这个索引是一个非覆盖索引的原因。

现在，如果您执行下一个查询，那么您将获得差异。[实际] 执行计划（SSMS，Ctrl + M）：

```
SET STATISTICS IO ON;
SET NOCOUNT ON;

PRINT 'Example #2:';
SELECT  p.*
FROM    Person.Person p
WHERE   p.LastName LIKE '[a-a]%';
PRINT @@ROWCOUNT;

PRINT 'Example #3:';
SELECT  p.*
FROM    Person.Person p
WHERE   p.LastName LIKE '[a-z]%';
PRINT @@ROWCOUNT;

PRINT 'Example #4:';
SELECT  p.*
FROM    Person.Person p WITH(FORCESEEK)
WHERE   p.LastName LIKE '[a-z]%';
PRINT @@ROWCOUNT; 
```

结果：

```
Example #2:
Table 'Person'. Scan count 1, logical reads 2805, lob logical reads 0
911

Example #3:
Table 'Person'. Scan count 1, logical reads 3817, lob logical reads 0 
19972

Example #4:
Table 'Person'. Scan count 1, logical reads 61278, lob logical reads 0
19972 
```

执行计划： ![在此处输入图像描述](https://i.stack.imgur.com/yKh9N.png)

另外：查询将为您提供在“Person.Person”上创建的每个索引的页数：

```
SELECT i.name, i.type_desc,f.alloc_unit_type_desc, f.page_count, f.index_level FROM sys.dm_db_index_physical_stats(
    DB_ID(), OBJECT_ID('Person.Person'), 
    DEFAULT, DEFAULT, 'DETAILED' ) f 
INNER JOIN sys.indexes i ON f.object_id = i.object_id AND f.index_id = i.index_id
ORDER BY i.type

name                                    type_desc    alloc_unit_type_desc page_count index_level
--------------------------------------- ------------ -------------------- ---------- -----------
PK_Person_BusinessEntityID              CLUSTERED    IN_ROW_DATA          3808       0
PK_Person_BusinessEntityID              CLUSTERED    IN_ROW_DATA          7          1
PK_Person_BusinessEntityID              CLUSTERED    IN_ROW_DATA          1          2
PK_Person_BusinessEntityID              CLUSTERED    ROW_OVERFLOW_DATA    1          0
PK_Person_BusinessEntityID              CLUSTERED    LOB_DATA             1          0
IX_Person_LastName_FirstName_MiddleName NONCLUSTERED IN_ROW_DATA          103        0
IX_Person_LastName_FirstName_MiddleName NONCLUSTERED IN_ROW_DATA          1          1

... 
```

现在，如果你比较`Example #1`and `Example #2`（都返回 911 行）

```
`SELECT p.BusinessEntityID, p.LastName ... p.LastName LIKE '[a-a]%'`
vs.
`SELECT * ... p.LastName LIKE '[a-a]%'` 
```

然后你会看到两个差异：

a) 7 次逻辑读取与 2805 次逻辑读取和

b) `Index Seek`(#1) 与`Index Seek`+ `Key Lookup`(#2)。

*您可以看到`SELECT *`(#2) 查询的性能最差（7 页与 2805 页）。*

现在，如果你比较`Example #3`and `Example #4`（都返回 19972 行）

```
`SELECT * ... LIKE '[a-z]%`
vs.
`SELECT * ... WITH(FORCESEEK) LIKE '[a-z]%` 
```

然后你会看到两个差异：

a) 3817 次逻辑读取 (#3) 与 61278 次逻辑读取 (#4) 和

b）`Clustered Index Scan`（PK_Person_BusinessEntityID 有 3808 + 7 + 1 + 1 + 1 = 3818 页）与`Index Seek`+ `Key Lookup`。

*您可以看到`Index Seek`+ `Key Lookup`(#4) 查询的性能最差（3817 页与 61278 页）。*在这种情况下，您可以看到 and `Index Seek`on`IX_Person_LastName_FirstName_MiddleName`加上`Key Lookup`on `PK_Person_BusinessEntityID`（聚集索引）会给您带来比“聚集索引扫描”更低的性能。

所有这些糟糕的执行计划都是可能的，因为`SELECT *`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:46:49.273

你的谓词是sargable。

如果在索引字段上运行此查询：

```
SELECT  *
FROM    persons
WHERE   last_name >= 'a'
        AND last_name < 'e' 
```

它产生以下计划：

```
 |--Nested Loops(Inner Join, OUTER REFERENCES:([MYDB].[dbo].[PERSONS].[ID]) OPTIMIZED)
       |--Index Seek(OBJECT:([MYDB].[dbo].[PERSONS].[IX_PERSONS_LAST_NAME]), SEEK:([MYDB].[dbo].[PERSONS].[LAST_NAME] >= 'a' AND [MYDB].[dbo].[PERSONS].[LAST_NAME] < 'E'),  WHERE:([MYDB].[dbo].[PERSONS].[LAST_NAME] like '[a-d]%') ORDERED FORWARD)
       |--Clustered Index Seek(OBJECT:([MYDB].[dbo].[PERSONS].[IX_PERSONS_LAST_NAME]), SEEK:([MYDB].[dbo].[PERSONS].[ID]=[MYDB].[dbo].[PERSONS].[ID]) LOOKUP ORDERED FORWARD) 
```

这相当于运行此查询：

```
SELECT  *
FROM    persons
WHERE   last_name >= 'a'
        AND last_name < 'e' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T17:04:54.587

我会查看您的解释计划并打开 STATISTICS IO 和 STATISTICS 时间，看看是否有什么突然出现在您身上。

# mysql - MySQL合并重复行

> ID：16088578
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:38:13.033
> 
> 标签：mysql

我正在努力解决我必须为程序进行的查询：

这是我的表的结构（示例列名）：

一个 ID 和名称可以有多个系数，例如：

```
ID-名称-系数
1-NameHere-0.5
1-NameHere-0.6
1-NameHere-0.7
```

这就是我希望查询结果的样子：

```
1-NameHere-0.5-0.6-0.7
```

所以所有重复的系数，我想要在单独的列中，但都在一行中。

实现此查询的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:41:31.283

在 SQL 中不能有可变的列数，但可以将值连接在一列中：

```
SELECT  id, name, GROUP_CONCAT(coefficient)
FROM    mytable
GROUP BY
        id, name 
```

这将返回类似

```
0.5,0.6,0.7 
```

在第三列中，您稍后可以在客户端上解析。

# ruby-on-rails - 如何计算有条件的对象？

> ID：16088579
> 
> 赞同：0
> 
> 时间：2013-04-18T16:38:19.600
> 
> 标签：ruby-on-rails, ruby-on-rails-3

**社区**has_many :codes
**代码** belongs_to :community

**用户**has_many :codes
**Code** belongs_to :user

```
@community.codes.users.count 
```

这将返回其代码属于社区的用户数。

**代码**有名为的列`visible`布尔值的列

如果我只想计算代码为 true on 的用户数`visible`，那是属于社区的用户数怎么办？

可以这样算吗？

我的意思是，我想获得像下面这样计算的计数。
我想要它在一行中。

```
@community.codes.each do |code|
    if code.visible && code.user
        count = count + 1
    end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:26:38.590

This line is equivalent to what you need. It will give the exact result.

```
User.joins(:codes => :community).where("codes.visible=? AND communities.id=?", true, @community.id).count 
```

There is also another better aproach. You should use namedscope for such types queries so that you can use it multiple times where you need:

In User model:

```
scope :visible_in_community, (lambda do |community_id|
  joins(:codes => :community).where("codes.visible=? AND communities.id=?", true, community_id) 
end) 
```

And you can call anywhere

```
User.visible_in_community(@community.id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T16:56:46.423

希望这对你有用。

```
@community.codes.where('visible = ? AND user_id IS NOT NULL', true).count 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:57:02.473

以下行等效于您问题的最后一段代码，但效率更高，因为在单个 SQL 请求中：使用 a 获取可见的计数`Code`并且`User`属于`@community`

```
Code.where('visible = ? AND community_id = ? AND user_id IS NOT NULL', true, @community.id).count 
```

# c# - 如何展平 C# Lambda 表达式中嵌套拆分的结果

> ID：16088580
> 
> 赞同：2
> 
> 时间：2013-04-18T16:38:24.017
> 
> 标签：c#, lambda

给定字符串“a:b;c:d,e;f:g,h,i”，我想将字符串拆分为一个包含两列的平面列表，每一列用于键（在冒号的左侧) 和值（逗号分隔在冒号的右侧）。结果应该是这样的。

```
{
    Key: "a",
    Value: "b"
},
{
    Key: "c",
    Value: "d"
},
{
    Key: "c",
    Value: "e"
},
{
    Key: "f",
    Value: "g"
},
{
    Key: "f",
    Value: "h"
},
{
    Key: "f",
    Value: "i"
} 
```

问题是我无法在所有键上展平第二次拆分逗号的结果，因此我返回一个 KeyValue 列表，而不是 KeyValue 列表的列表。

```
public class KeyValue {
    public string Key { get; set; }
    public string Value { get; set; }
}

List<KeyValue> mc = "a:b;c:d,e;f:g,h,i"
    .Split(';')
    .Select(a =>
    {
        int colon = a.IndexOf(':');
        string left = a.Substring(0, colon);
        string right = a.Substring(colon + 1);
        List<KeyValue> result = right.Split(',').Select(x => new KeyValue { Key = left, Value = x }).ToList();
        return result;
    })
    .ToList(); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:43:39.320

```
List<KeyValue> mc = "a:b;c:d,e;f:g,h,i"
    .Split(';')
    .Select(a =>
    {
        int colon = a.IndexOf(':');
        string left = a.Substring(0, colon);
        string right = a.Substring(colon + 1);
        return new KeyValue() { Key = left, Value = right };
    })
    .ToList(); 
```

**编辑：**

只是为了澄清`Select`项目列表到新类型; 它已经`List`为您处理了创建。因此，您要求 a `List`of`List`对象。在这种情况下，您只需要询问对象`KeyValue`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:01:22.600

你*非常*亲近。展平序列序列的方法是`SelectMany`。我们可以在现有代码的末尾添加一个，但由于它已经以 a 结尾`Select`，我们实际上可以将其更改为 a `SelectMany`，我们就完成了：

```
List<KeyValue> mc = "a:b;c:d,e;f:g,h,i"
    .Split(';')
    .SelectMany(a =>
    {
        int colon = a.IndexOf(':');
        string left = a.Substring(0, colon);
        string right = a.Substring(colon + 1);
        List<KeyValue> result = right.Split(',')
            .Select(x => new KeyValue { Key = left, Value = x }).ToList();
        return result;
    })
    .ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:46:23.240

您无需返回新的`List<KeyValue> result`. 您只想返回`KeyValue`如下

```
string data = "a:b;c:d,e;f:g,h,i";

var mc = data
    .Split(';')
    .Select(a =>
    {
        int colon = a.IndexOf(':');
        string left = a.Substring(0, colon);
        string right = a.Substring(colon + 1);
        return new KeyValue() { Key = left, Value = right };
    }).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T16:53:20.130

与往常一样，它可以通过 Linq 执行：

```
string s = "a:b;c:d,e;f:g,h,i";
string Last = "";
var Result = s.Split(';', ',').Select(x =>
{
    if (x.Contains(":"))
    {
        Last = x.Split(':')[0];
        return new { Key = x.Split(':')[0], Value = x.Split(':')[1] };
    }
    else return new { Key = Last, Value = x };
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T17:09:43.870

```
string data = "a:b;c:d,e;f:g,h,i";

var mc = data
    .Split(';')
    .SelectMany(x => {
        int separatorIndex = x.IndexOf(':');
        var key = x.Substring(0, separatorIndex);
        var values = x.Substring(separatorIndex + 1).Split(',');

        return values.Select(v => new KeyValuePair<string,string>(key, v));
    }); 
```

![变换结果](https://i.stack.imgur.com/31Y3t.jpg)

# django - 使用 django-crispy-forms 编辑选择小部件的 emtpy_value 属性

> ID：16088583
> 
> 赞同：0
> 
> 时间：2013-04-18T16:38:33.180
> 
> 标签：django, widget, django-crispy-forms

我试图弄清楚如何使用 django-crispy-forms 在 django 中将“选择”元素的空值设置为“选择您的位置”而不是“--------”。有没有人对最好的方法有任何建议？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:07:56.727

Turns out since I was using choices in a CharField, I could just add a default blank value with my label and set blank=False on my model. The answer is documented [here](https://stackoverflow.com/a/739286/1124580), but it's somewhat hidden in the question, which is about ForeignKeys.

# codeigniter - Codeigniter 和多个并发登录

> ID：16088587
> 
> 赞同：4
> 
> 时间：2013-04-18T16:38:45.277
> 
> 标签：codeigniter, security, session, login

我来自安全背景，我是一名信息安全顾问，并测试了 web 应用程序的漏洞。我刚开始从事 webdev 工作，我正忙于我的第一个项目，用 Codeigniter 编写。

我正在尝试解决多个并发登录的问题，其中用户可以有两个（或更多）同时有效且活动的并发会话。我知道如何做到这一点，但我对 CI 没有经验，所以我想知道是否有更好或更“官方”的方式。它还涉及对数据库的 ci_sessions 表进行更改，不确定 CI 将如何处理它。

目前我正在使用数据库进行会话数据，我的计划是在 ci_sessions 表中添加一个额外的 coloum，该表存储用户的电子邮件地址（身份验证后）。换句话说，在用户成功登录之前它将为 NULL，此时用户的电子邮件地址将被存储在其中。

计划是确认登录期间提供的凭据的有效性，如果它们正确，则在会话表中搜索与同一电子邮件地址对应的其他会话并删除它们。删除用户的其他会话后，将设置指示有效已验证会话的电子邮件和会话数据。

这是最好的方法吗？

编辑：当然，当 CI 为当前会话创建新会话 id 而不是更新时，这将不起作用，因为 CI 不会将电子邮件地址设置为新会话。我必须对源代码进行修改...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:58:02.697

我正在查看 Sessions.php 的源代码，并在 sess_update() 的末尾找到了这一行，只有在使用 DB 会话时才会调用它：

```
$this->CI->db->query($this->CI->db->update_string($this->sess_table_name, array('last_activity' => $this->now, 'session_id' => $new_sessid), array('session_id' => $old_sessid))); 
```

换句话说，当前 session_id 用新的 session_id 更新，而不是插入新条目，而保留所有其他信息（除了 last_activity）不变。然后我决定尝试我原来的计划，我在默认为 NULL 的表（而不是电子邮件）中添加了一个 user_id 列。登录时，我检查凭据并返回（除其他外）指定电子邮件地址的 user_id。然后，我删除 user_id 列中具有该特定 ID 的所有会话，并更新与当前 session_id 关联的行以包含该用户的 user_id。

我已经通过使用 Chrome 登录然后使用 Safari 进行了测试，并且 Chrome 会话被终止。我仍然需要进行更多测试以确保没有漏洞，但看起来这解决了我的问题。

非常感谢您的建议。Samutz，我相信你的方法会奏效，我只是发现我的开销更少。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:07:57.077

这是我在我的一个应用程序上执行此操作的方式：

在您的用户表中创建一个 session_id 字段。成功用户登录后，生成一个新的、唯一的 session_id。

（不要为此使用 CI 的 session_id，因为尽管会话相同，但它可能会根据您的会话配置而改变。想法是拥有自己的 id，只要会话存在，它就会持续存在。）

将新的 session_id 存储在用户的记录和会话数据中。在使用活动会话重复访问时，检查用户记录中的匹配 id。

现在，当该用户从另一台计算机登录时，他们将获得一个具有新 ID 的新会话，并在用户记录中更新他们的 ID。旧计算机将在下一页加载时注销，因为该计算机的会话 ID 与其用户记录中的会话 ID 不匹配。

虽然我没有将会话存储在我的数据库中（无法让它工作，所以我使用加密的会话 cookie），所以如果你将会话存储在数据库中，我不知道这将如何工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:49:09.990

在你的配置文件中设置：

```
$config['sess_match_ip'] = true; 
```

读取会话数据时会匹配用户的IP地址

参考[http://ellislab.com/codeigniter/user-guide/libraries/sessions.html](http://ellislab.com/codeigniter/user-guide/libraries/sessions.html)

希望能帮助到你！

# ruby-on-rails - Rails 与“root”参数的关联

> ID：16088596
> 
> 赞同：0
> 
> 时间：2013-04-18T16:39:29.940
> 
> 标签：ruby-on-rails, ruby, database, ruby-on-rails-3

在rails中找到被调用方法的“根”参数的最佳方法是什么？

```
User.first.comments # => [#<Comment id: "1", name: "First comment" ... 
```

我需要这样的东西：

```
User.first.comments #<User id:1, name:"First User", comments: [
  #<Comment id: "1", name: "First comment" ..., #<Comment ... ] 
```

需要序列化..谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:50:24.557

反过来说：

```
user = User.includes(:comments).first
# SQL queries
# => #<User ...> 
```

现在您可以在没有其他数据库访问权限的情况下访问评论：

```
user.comments
# => [#<Comment ...>, #<Comment ...>] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T17:10:54.730

要知道，这个问题其实很可能与`includes`. 是否使用 N + 1 查询检索到用户的评论是无关紧要的。

我认为您可能需要的是[RABL 之](https://github.com/ccocchi/rabl-rails)类的东西。我用过它，它很棒。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T16:41:48.037

`User.first.includes(:comments)`?

# gwt - 如何清除和重绘整个地图

> ID：16088598
> 
> 赞同：1
> 
> 时间：2013-04-18T16:39:31.627
> 
> 标签：gwt, google-maps-api-3

我正在使用 GWt 和[Google Maps API V3。](https://github.com/branflake2267/GWT-Maps-V3-Api)我能够在覆盖自定义形状的简单面板内渲染地图。如果提供了新查询，我想清除面板并再次呈现地图。

```
public ResultsPanel(ScolopaxController _controller,
        ScolopaxConstants _constants) {
    super();
    controller = _controller;
    layout = new SimplePanel();
    paging = new HorizontalPanel();
    paging.setWidth("100%");
    paging.setSpacing(0);
    layout.add(paging);
    this.setWidget(paging);

}
//After processing the values in the server this method is called
public void setPlots(PlotSetOutput result) {
    this.page = 1;
    this.loadMapApi(result);
    controller.getScolopaxGUI().addResultsTab();
}

private void loadMapApi(final PlotSetOutput result) {
    paging.clear(); // does not work
    // load all the libs for use in the maps
    ArrayList<LoadLibrary> loadLibraries = new ArrayList<LoadApi.LoadLibrary>();
    loadLibraries.add(LoadLibrary.ADSENSE);
    loadLibraries.add(LoadLibrary.DRAWING);
    loadLibraries.add(LoadLibrary.GEOMETRY);
    loadLibraries.add(LoadLibrary.PANORAMIO);
    loadLibraries.add(LoadLibrary.PLACES);
    loadLibraries.add(LoadLibrary.WEATHER);
    loadLibraries.add(LoadLibrary.VISUALIZATION);
    Runnable onLoad = new Runnable() {
        @Override
        public void run() {
            draw(result);
        }
    };

    LoadApi.go(onLoad, loadLibraries, sensor);
}

private void draw(PlotSetOutput result) {
    drawHeatMap(result);
}

private void addMapWidget(Widget widget) {
    paging.add(widget);
}

private void drawHeatMap(PlotSetOutput result) {
    displayOnMap wMap = new displayOnMap(result);
    addMapWidget(wMap);
} 
```

这是 displayOnMap 方法

```
 private final VerticalPanel pWidget;
    private MapWidget mapWidget;
    private static Rectangle rectangle;
    private static final LatLng USCENTER = LatLng.newInstance(33.68,-116.17);

    public displayOnMap(PlotSetOutput result) {
        pWidget = new VerticalPanel();
        initWidget(pWidget);
        draw(result);
    }

    private void draw(PlotSetOutput result) {
        MapOptions mapOpts = MapOptions.newInstance();
        mapOpts.setZoom(4);
        mapOpts.setCenter(USCENTER);
        mapOpts.setMapTypeId(MapTypeId.TERRAIN);
        mapWidget = new MapWidget(mapOpts);
        pWidget.add(mapWidget);
        mapWidget.setSize("800px", "800px");
.... } 
```

当服务器调用 SetPlots 方法时，我试图清除分页面板。我试图清除 pWidget 面板，但没有任何效果。调用第二个查询时，我的输出如下所示 ![在此处输入图像描述](https://i.stack.imgur.com/hYX1k.png)

# arrays - 这个数组数据结构叫什么名字？

> ID：16088606
> 
> 赞同：7
> 
> 时间：2013-04-18T16:39:50.297
> 
> 标签：arrays, algorithm, data-structures

有一个对研究项目有用的数据结构的想法，并想看看它是否已经有一个名称或 STL 等价物：

创建一个大小`n`为`sqrt(n)`指针数组的稀疏数组。

要在 处插入项目`i`，请转到 处的指针`i/sqrt(n)`。如果该指针是`null`，则将其分配给一个新的大小数组`sqrt(n)`。将您的项目插入新数组的位置`i mod sqrt(n)`。

优点很简单：它允许您创建一个最初只`O(sqrt(n))`占用空间的大型数组。您可以在恒定时间内访问任何元素，它允许您填充数组的某些部分，而无需为所有`n`位置分配空间。

这可能已经用于哈希表分桶，并且我想到了另一个应用程序（在非常大的 DNA 序列中记忆重叠群）。我的问题是：这个有名字吗？我可以使用任何常见的实现吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-18T18:14:43.237

[该数据结构与哈希数组树 (HAT)](http://en.wikipedia.org/wiki/Hashed_array_tree)数据结构密切相关。散列数组树的结构与您在上面描述的一样 - 您有一个大小为 √n 的顶级数组，其中每个条目都是指向具有 √n 个元素的数组的指针。这使得插入和查找相当快，并且与传统动态数组的 O(n) 内存开销相比，只有 O(√n) 内存开销。

您的结构在几个方面与 HAT 不同。对于初学者来说，如果您需要更多空间，您的结构似乎没有办法扩大结构，而 HAT 被设计为可增长的。此外，您的结构允许随机插入，而 HAT 是为顺序插入而设计的。也就是说，没有根本原因 HAT 必须以这种方式运行，因此您可以将数据结构视为对 HAT 的轻微修改。事实上，您可能想查看 HAT 如何增长，以使您的数据结构支持增长。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T16:41:42.420

好吧，我称之为*带有行向量的方阵。*如果没有完全填充，它是一个带有行向量的*稀疏*方阵。^(1.)

这里有两个优化工作。一是稀疏内存分配，二是行下标计算[强度降低。](http://en.wikipedia.org/wiki/Strength_reduction)对于超大规模 CPU 的乱序执行指令，以及在编译器经常进行全局流优化的时代，这种优化可能并不那么重要。

但它确实允许通过指针取消引用而不是乘以行大小来进行行索引。

* * *

^(1\. 然而，在数值分析中，稀疏矩阵是一个大部分为零的矩阵，因此稀疏数据结构在形式上具有相同的定义。在这种情况下，它更像是一种*部分*数据结构，但据我所知，这些东西还没有被接受的术语。)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:50:32.747

这是一组桶。

Java 的 hastable 实现就是这样一个“基于桶的哈希表”。[这是此类存储桶](http://en.wikipedia.org/wiki/Hash_table)
的图形

还有其他结构，如四叉树，也使用这种桶。

在您的情况下，您有 sqrt(n) 存储桶。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T17:02:30.267

我称之为分段数组。我在将句柄映射到指针时使用这些。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T18:11:10.617

它也与[Van Emde Boas Tree](http://en.wikipedia.org/wiki/Van_Emde_Boas_tree)的第一层非常相似。

Van Emde Boas 树在第一级存储 sqrt(n) 指针，但在较低级别有额外的树，而不是这个问题中的简单数组。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T18:40:30.840

它本身不是数据结构。似乎这种技术可以用于其他集合类型的数据结构。

编辑：这绝对是一种存储或组织数据的机制，但我总是将数据结构与存储/检索（读/写）机制相关联。

# c# - 连接到 .net 中的 wsdl

> ID：16088609
> 
> 赞同：0
> 
> 时间：2013-04-18T16:40:02.663
> 
> 标签：c#, .net, web-services, wsdl

我正在尝试连接以下服务：

[http://api.affiliatewindow.com/v4/AffiliateService?wsdl](http://api.affiliatewindow.com/v4/AffiliateService?wsdl)

我做了以下事情：

1.  创建了一个新的空 Web 应用程序（c#visual studio 2010）

2.  右键单击解决方案 -> 添加服务引用

3.  按下“开始”

4.  将名称更改为 AffWinAPI 并按 OK

我收到以下错误：“无法为服务引用 'AffWinAPI' 生成代码。请查看其他错误和警告消息以获取详细信息。”

我尝试了以下建议的解决方案，但它仍然没有为我工作。

[服务引用错误：无法为服务引用生成代码](https://stackoverflow.com/questions/3977560/service-reference-error-failed-to-generate-code-for-the-service-reference)

[此 WCF 错误是什么意思：“自定义工具警告：无法导入 wsdl:portType”](https://stackoverflow.com/questions/1872865/what-does-this-wcf-error-mean-custom-tool-warning-cannot-import-wsdlporttype)

有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:53:04.367

是的，我遇到了同样的错误，但设法将其添加为 WebService

```
Add Service Reference/Advanced/Add Web Reference 
```

如果它要求保存，则将其保存到文件夹并使用该文件添加参考

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:05:17.887

我过去添加 Web 服务的方式是通过这种方法：

[http://msdn.microsoft.com/en-us/library/bb628649.aspx](http://msdn.microsoft.com/en-us/library/bb628649.aspx)

请注意使用高级按钮进入显示添加 Web 参考的屏幕。这将为您提供使用 Web 服务所需的 asmx 文件和类参考。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:52:35.243

我做了你上面描述的步骤，使用VS2012没有任何错误。检查您的互联网连接和防火墙配置。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T16:58:35.990

在 Visual Studio 添加服务引用的高级对话框中，有一个复选框“在引用的程序集中重用类型”。您可以取消选中它并尝试再次添加服务吗？

# javascript - 将数据保存在 javascript 中后隐藏表单

> ID：16088610
> 
> 赞同：1
> 
> 时间：2013-04-18T16:40:03.583
> 
> 标签：javascript, forms, html, onclick, hide

嗨，我已经做了很多搜索，但找不到任何具体的东西，或者我可以在我的示例中工作。想知道是否有人可以提供帮助。我以前从未使用过 javascript，但有人要求我进行评估以编写一个软件来跟踪十针保龄球游戏中的得分。我正在尽可能多地阅读，但有一些事情我仍在努力。我已经为玩家制作了一个表格来输入他们的名字，我希望能够在他们输入名字后隐藏表格，从而使界面看起来不那么混乱。尝试了很多方法，但似乎没有一个对我有用，我尝试将表单放在 div 中并使用 onClick 事件隐藏 div，但它似乎无法识别 div 等，正在寻找一些指针，

```
<!DOCTYPE html>
<html>
<head>
<script class="jsbin" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
<script class="jsbin" src="http://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js"></script>
<meta charset=utf-8 />
<title>JS Bin</title>
<style>
article, aside, figure, footer, header, hgroup, 
menu, nav, section { display: block; }
</style>

<style id="jsbin-css">

</style>
<script>
function myFunction()
{
document.getElementById("formy").innerHTML="My First JavaScript Function";
}
</script>
</head>
<body>
<p id="formy"><form>
<h1>Please enter player names!</h1>

<input id="player1" type="text" placeholder="Player 1" />

<input id="player2" type="text" placeholder="Player 2" />

<input id="player3" type="text" placeholder="Player 3" />

   <input id="player4" type="text" placeholder="Player 4" />

   <input id="player5" type="text" placeholder="Player 5" />

   <input id="player6" type="text" placeholder="Player 6" />
<input type="button" value="Save/Show" onclick="insert(),close.this", />
</form></p>
<div id="display"></div>
<script>
var titles  = [];
var names   = [];
var tickets = [];

var player1Input  = document.getElementById("player1");
var player2Input   = document.getElementById("player2");
var player3Input = document.getElementById("player3");
var player4Input = document.getElementById("player4");
var player5Input = document.getElementById("player5");
var player6Input = document.getElementById("player6");

var messageBox  = document.getElementById("display");

function insert ( ) {
 titles.push( player1Input.value );
 names.push( player2Input.value );
 tickets.push( player3Input.value );

 clearAndShow();
}

function clearAndShow () {
    // Show our output
  messageBox.innerHTML = "";

  messageBox.innerHTML += "<td>*" + player1Input.value + "<br/><td/>";
  messageBox.innerHTML += "*" + player2Input.value + "<br/>";
  messageBox.innerHTML += "*" + player3Input.value +"<br/>";
  messageBox.innerHTML += "*" + player4Input.value + "<br/>";
  messageBox.innerHTML += "*" + player5Input.value + "<br/>";
  messageBox.innerHTML += "*" + player6Input.value;

// Clear fields
titleInput.value = "";
nameInput.value = "";
ticketInput.value = "";

}
</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:48:36.393

在表单上放置一个 id。单击按钮时隐藏表单。[在这里](http://jsbin.com/ecutuk/1/)测试一下。

```
<html>
<form id="b">
<textarea>hey</textarea>
<button onclick="hide(); return false;">click me</button>
</form>
<script>
function hide()
{
    document.getElementById('b').style.display='none';
}
</script>
</html> 
```

您可以获取元素然后设置`style.display='none'`为隐藏它。我放入 a`return false;`以防止表单发布，并将该功能添加到 a`<script>`以提高可读性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:49:34.150

在你的一个函数中，尝试这个隐藏 p 标签中的所有内容：

```
document.getElementById("formy").style.display = "none"; 
```

另外，我不确定您在 onclick 上尝试使用 'close.this' 执行什么操作 - 我会亲自更改它，以便您*只需*调用函数（如果您的 onclick 属性有错误，则该函数可能不会叫做）：

```
<input type="button" value="Save/Show" onclick="insert()" /> 
```

# php - 使用 PHP 起草带有附件的 IMAP 电子邮件

> ID：16088612
> 
> 赞同：3
> 
> 时间：2013-04-18T16:40:10.143
> 
> 标签：php, email, imap, email-attachments

我正在尝试将附件添加到我起草但似乎无法正常工作的电子邮件中。我尝试按照[此处](http://geekology.co.za/article/2009/06/how-to-send-emails-with-attachments-using-php-mail-function)和[此处](https://stackoverflow.com/questions/690430/attnnnnn-txt-attachments-when-e-mail-is-received-in-outlook)的示例进行操作，但没有成功。

到目前为止，这是我能做的：

1.  连接到 Exchange 服务器
2.  打开邮箱
3.  起草 html 电子邮件
4.  将电子邮件附加到邮箱并让它正确呈现 html。（当使用 text/html 作为内容类型时）。使用其他任何内容都会将 html 显示为纯文本。

作为附加说明，在起草后，电子邮件会附加到 Exchange 2010 服务器上的邮箱中，然后通过 Outlook 2010 进行查看然后发送。

下面是我的邮件类和起草电子邮件的代码。

邮件程序.php

```
<?php

class mailer
{
    const USER      =   'user';
    const PASSWORD  =   'pass';
    const MAILBOX   =   '{conn}DRAFTS';

    // STRING ORDER: $content-type . $from . $to . $cc . $subject . "\r\n\r\n" . $message
    public $message;
    public $imap_conn;
    public $boundary;

    function __construct()
    {
        // Open the message property so we can start appending strings.
        $this->message = '';

        // Open the IMAP connection
        $this->imap_conn = imap_open(self::MAILBOX,self::USER,self::PASSWORD);
    }

    public function content_type($string_type)
    {
        $this->message .= "Content-type:{$string_type}\r\n";
    }

    public function from($string_from)
    {
        $this->message .= "From:{$string_from}\r\n";
    }

    public function to($string_to)
    {
        $this->message .= "To:{$string_to}\r\n";
    }

    public function cc($string_cc)
    {
        $this->message .= "Cc:{$string_cc}\r\n";
    }

    public function mime($float_mime_version)
    {
        $this->message .= "MIME-Version:{$float_mime_version}\r\n";
    }

    public function subject($string_subject)
    {
        $this->message .= "Subject:{$string_subject}\r\n\r\n";
    }

    public function message($string_message)
    {
        $this->message .= "{$string_message}\r\n";
    }

    public function set_boundary($string_boundary)
    {
        $this->boundary = $string_boundary;
    }

    public function append()
    {
        imap_append($this->imap_conn,self::MAILBOX,$this->message,"\\Draft");
        imap_close($this->imap_conn);
    }
}

?> 
```

代码草案

```
// A random hash used for the boundary
$rh = md5(date('c',time()));
$data = chunk_split(base64_encode('Testing'));

$m = new mailer;
$m->set_boundary('--PHP-mixed-' . $rh);
$m->content_type('multipart/mixed; boundary="' . $m->boundary . '"');
$m->mime('1.0');
$m->from('from@mail.com');
$m->to('to@mail.com');
$m->cc('cc1@mail.com,cc2@mail.com');
$m->subject('A new email');
$m->message("
    {$m->boundary}
    Content-Type: text/html; charset=\"utf-8\"
    Content-Transfer-Encoding: base64

    Testing my <b>HTML</b>
    </br>
    {$m->boundary}
    Content-Type: application/octet-stream; name=\"test.txt\"
    Content-Transfer-Encoding: base64
    Content-Disposition: attachment; filename=\"test.txt\"

    {$data}
    {$m->boundary}--
    "));
$m->append(); 
```

附加前的消息

```
Content-type:multipart/mixed; boundary="--PHP-mixed-b408f941593cf92b5a8bd365abb4e64f"
MIME-Version:1.0
From:from@mail.com
To:to@mail.com
Cc:cc1@mail.com
Subject:New Message

            --PHP-mixed-b408f941593cf92b5a8bd365abb4e64f
            Content-Type: text/html; charset="utf-8"
            Content-Transfer-Encoding: "base64"

            My <b>html</b> content

            --PHP-mixed-b408f941593cf92b5a8bd365abb4e64f
            Content-Type: application/octet-stream; name="test.txt"
            Content-Transfer-Encoding: base64
            Content-Disposition: attachment; filename="test.txt"

            --PHP-mixed-b408f941593cf92b5a8bd365abb4e64f-- 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:49:43.527

问题：如何通过 IMAP 向使用 PHP 起草的电子邮件添加附件？

答：简而言之，问题出在两个地方。

1.  换行符放置不当 (\r\n)。一个换行符应该在每个标题之后，两个换行符应该在一个部分的每个结束标题之后。请参见图 1。

2.  界线不当。边界应以 -- 开头，后跟一个唯一的字符串。消息的结束边界应该以 -- 开始和结束 -- 参见图 2

图1

```
Content-Type: text/html\r\n
Content-Encoding: base64\r\n\r\n
"Message text here."\r\n 
```

图 2

```
--unique
Content-Type: text/html\r\n
Content-Encoding: base64\r\n\r\n
HTML stuff here.\r\n
--unique
Content-Type: application/octet-stream\r\n
Content-Disposition: attachment; filename=\"logs.csv\"\r\n
Content-Transfer-Encoding: base64\r\n\r\n
Attachment(s)\r\n
--unique-- 
```

我计划对此进行更深入的撰写，因为我花了*很*长时间才把它弄好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T19:27:23.293

到目前为止，了解有关调试的更多信息会很有帮助。文件读取成功了吗？有什么东西能送到邮箱吗？它还可以帮助我在最终追加之前查看完整消息的输出。

我不知道这是否会解决它，但是从我成功的代码和您的第二个示例中，您的消息应该有一个额外的文件名属性，并且值用引号括起来。

```
Content-Type: application/octet-stream; name="test.txt"
Content-Transfer-Encoding: base64
Content-Disposition: attachment; filename="test.txt" 
```

# ios - 想要 UITableView “捕捉到单元格”

> ID：16088615
> 
> 赞同：21
> 
> 时间：2013-04-18T16:40:19.510
> 
> 标签：ios, objective-c, uitableview, uiscrollviewdelegate

我在`UITableView`. 当用户滚动时，我希望表格视图始终在中间捕捉最中心的照片。也就是说，当桌子处于静止状态时，它总会有一个`UITableViewCell`对齐到中心的位置。

如何做到这一点？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-04-18T16:51:40.663

您可以使用以下`UIScrollViewDelegate`方法`UITableView`来执行此操作：

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate {
    // if decelerating, let scrollViewDidEndDecelerating: handle it
    if (decelerate == NO) {
        [self centerTable];
    }
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView {
    [self centerTable];
}

- (void)centerTable {
    NSIndexPath *pathForCenterCell = [self.tableView indexPathForRowAtPoint:CGPointMake(CGRectGetMidX(self.tableView.bounds), CGRectGetMidY(self.tableView.bounds))];

    [self.tableView scrollToRowAtIndexPath:pathForCenterCell atScrollPosition:UITableViewScrollPositionMiddle animated:YES];
} 
```

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2013-04-18T16:59:11.763

有一个 UIScrollView 委托方法专门为此！

编辑：如果您只想要代码，请查看以下基于此构建的答案。

`- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset`当用户停止滚动时，将调用表格视图（滚动视图） 。您可以设置操作`targetContentOffset`以确保它最终到达您想要的位置，并且它将减速到该位置结束（就像分页 UIScrollView 一样）。

例如，如果你的单元格都是 100 点高，你可以这样做：

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset {
    targetContentOffset->y = 100 * (int)targetContentOffset->y/100;
} 
```

当然，您也可以检查`targetContentOffset`传入的内容以查看它要降落的位置，然后找到其中的单元格并进行适当的更改。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-03-26T21:24:20.847

扩展上面@jesse-rusak 的答案，如果您有高度可变的单元格，这是您需要添加到 UITableViewController 子类的代码。这将避免接受答案中的双滚动问题。

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset {
    NSIndexPath *pathForTargetTopCell = [self.tableView indexPathForRowAtPoint:CGPointMake(CGRectGetMidX(self.tableView.bounds), targetContentOffset->y)];
    targetContentOffset->y = [self.tableView rectForRowAtIndexPath:pathForTargetTopCell].origin.y;
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2013-10-21T23:21:37.257

根据@jszumski 发布的内容构建，如果您希望在拖动中发生快照，请使用以下代码：

```
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate {
    [self centerTable];
}

- (void)scrollViewWillBeginDecelerating:(UIScrollView *)scrollView {
    [self centerTable];
}

- (void)centerTable {
    NSIndexPath *pathForCenterCell = [self.tableView indexPathForRowAtPoint:CGPointMake(CGRectGetMidX(self.tableView.bounds), CGRectGetMidY(self.tableView.bounds))];

    [self.tableView scrollToRowAtIndexPath:pathForCenterCell atScrollPosition:UITableViewScrollPositionMiddle animated:YES];
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2018-11-12T15:07:27.330

扩展@mikepj 答案（这反过来又扩展了@JesseRusak 的出色答案），此代码可让您捕捉到一个单元格，即使单元格具有可变（或未知）高度，并且如果您愿意，它将捕捉到下一行滚动到行的下半部分，使其更“自然”。

**原始 Swift 4.2 代码：（**为方便起见，这是我开发和测试的实际代码）

```
func scrollViewWillEndDragging(_ scrollView: UIScrollView, withVelocity velocity: CGPoint, targetContentOffset: UnsafeMutablePointer<CGPoint>) {
    guard var scrollingToIP = table.indexPathForRow(at: CGPoint(x: 0, y: targetContentOffset.pointee.y)) else {
        return
    }
    var scrollingToRect = table.rectForRow(at: scrollingToIP)
    let roundingRow = Int(((targetContentOffset.pointee.y - scrollingToRect.origin.y) / scrollingToRect.size.height).rounded())
    scrollingToIP.row += roundingRow
    scrollingToRect = table.rectForRow(at: scrollingToIP)
    targetContentOffset.pointee.y = scrollingToRect.origin.y
} 
```

**（翻译）Objective-C 代码：（**因为这个问题被标记`objective-c`）

```
- (void)scrollViewWillEndDragging:(UIScrollView *)scrollView withVelocity:(CGPoint)velocity targetContentOffset:(inout CGPoint *)targetContentOffset {
    NSIndexPath *scrollingToIP = [self.tableView indexPathForRowAtPoint:CGPointMake(0, targetContentOffset->y)];
    if (scrollingToIP == nil)
        return;
    CGRect scrollingToRect = [table rectForRowAtIndexPath:scrollingToIP];
    NSInteger roundingRow = (NSInteger)(round(targetContentOffset->y - scrollingToRect.origin.y) / scrollingToRect.size.height));
    scrollingToIP.row += roundingRow;
    scrollingToRect = [table rectForRowAtIndexPath:scrollingToIP];
    targetContentOffset->y = scrollingToRect.origin.y;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-02-25T10:56:31.850

对于快速窥视

```
override func scrollViewDidEndDragging(_ scrollView: UIScrollView, willDecelerate decelerate: Bool) 
{
   if decelerate == false
   {
       self.centerTable()
   }
 }

override func scrollViewDidEndDecelerating(_ scrollView: UIScrollView) {
    self.centerTable()
}

func centerTable()
{
   let midX:CGFloat = self.tableView.bounds.midX
   let midY:CGFloat = self.tableView.bounds.midY
   let midPoint:CGPoint = CGPoint(x: midX, y: midY)

   if let pathForCenterCell:IndexPath = self.tableView .indexPathForRow(at: midPoint)
    {
      self.tableView.scrollToRow(at: pathForCenterCell, at: .middle, animated: true)
    }
}//eom 
```

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2013-08-12T21:51:49.523

UITableView 扩展了 UIScrollView...

```
myTableView.pagingEnabled = YES 
```

# mono - 未找到 mod_mono / apache 上的 servicestack 服务

> ID：16088616
> 
> 赞同：1
> 
> 时间：2013-04-18T16:40:23.633
> 
> 标签：mono, servicestack, mod-mono, xsp

我有一个简单的 ServiceStack Web 服务，我用 xsp 在我的 Macbook 上工作。使用浏览器，我可以查看元数据页面并且服务正在运行。

我刚刚在 Fedora 14 机器上安装了 mono、mod_mono、xsp。我可以看到 mono_module 是由 apache 加载的。

我将 myservice 复制到 /var/www/html/myservice。使用浏览器时，我无法像在 Mac 上使用 xsp 一样打开元数据页面，当然也无法访问 Web 服务。

从 xsp 到 apache/mod_mono 需要改变什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T15:54:44.720

ServiceStack 用于创建一个 RESTful Web 服务，它可以通过 URI 而不是带有扩展名的文件访问。mod_mono 的自动配置添加了所有的 mime 类型和文件扩展名，但没有添加到 Web 服务的简单路径 (URI)。

解决方案：我将这些行添加到我的 httpd.conf 以创建虚拟路径并将其配置为与 mod_mono 一起使用。

```
Alias /info "/var/www/html/myService"
MonoApplications "/info:/var/www/html/myService"
<Location /info>
    SetHandler mono
</Location> 
```

现在`http://localhost:8080/metadata`工作得很好。

# visual-c++ - 使用 luajit 和 lua-iup 库编译时出错 [visual c++ 2012]

> ID：16088618
> 
> 赞同：0
> 
> 时间：2013-04-18T16:40:27.717
> 
> 标签：visual-c++, compilation, lua, luajit

我用 luajit 和 lua-iup 编写了一个应用程序，并将我的应用程序与静态库链接起来。但我收到以下错误：

```
------ Build started: Project: ConsoleApplication1, Configuration: Release Win32 ------
     Creating library C:\Users\root\Documents\Visual Studio 2012\Projects\ConsoleApplication1\Release\ConsoleApplication1.lib and object C:\Users\root\Documents\Visual Studio 2012\Projects\ConsoleApplication1\Release\ConsoleApplication1.exp
iup.lib(iupwindows_main.obj) : error LNK2001: unresolved external symbol _main
C:\Users\root\Documents\Visual Studio 2012\Projects\ConsoleApplication1\Release\ConsoleApplication1.exe : fatal error LNK1120: 1 unresolved externals
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我是否缺少一些库以及对此有何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T09:37:58.027

这是IUP作者的答案，希望对遇到和我一样问题的人有所帮助

> 您似乎正在构建一个控制台应用程序。这意味着您需要一个“主要”功能。如果您尝试在没有控制台的情况下构建 Windows 应用程序，那么 IUP 将为您实现 WinMain 函数并调用您的“main”函数。在这两种情况下，您都需要“主要”功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T21:55:36.013

据我所知，IUP 的 Lua 绑定部分是用 Lua 编写的。这通常不是问题，除了 Lua 部分作为预编译字节码编译到库中。Lua 字节码和 LuaJIT 字节码是不同的。

正确的答案是更改 IUP 以便它使用编译的 Lua 源而不是字节码来构建。可以想象，这会减慢 IUP 应用程序的启动速度，但它会使交叉编译 IUP 变得更容易，并使得使用 LuaJIT 代替标准 Lua 成为可能。

# apache-flex - Flex - Parsley - 事件不会从结果处理程序中的方法分派

> ID：16088623
> 
> 赞同：0
> 
> 时间：2013-04-18T16:40:35.600
> 
> 标签：apache-flex, events, flexbuilder, dispatcher, parsley

我有一个执行服务调用的命令。在结果处理程序中，我正在根据结果数据执行一些逻辑。如果逻辑符合特定标准，我将显示一个确认弹出窗口。如果用户单击确认弹出窗口中的继续按钮，我将调用一个方法，该方法将调度 Parsley 事件。Parsley 事件没有被捕获。但是，如果我从 result 方法内部调度 Parsley 事件，它就会被捕获。知道为什么从结果方法外部调度事件时没有捕获事件吗？

例如...

```
[MessageDispatcher]
[Bindable]
public var dispatcher:Function; 
```

我从命令内部执行一些服务调用：

```
public function execute(event:SomeEvent):AsyncToken
{
return service.callService(event.type, false);
} 
```

我现在有一个这样的结果处理程序：

```
public function result(data:Object):void
{
if (add some logic here based off data)
AlertHelper.showContinueQuestion(onSelection, "Are you sure you want to continue?");
} 
```

如果用户单击确认弹出窗口上的 Continue 按钮，它会调用 onSelection 方法：

```
private function onSelection():void
{
dispatcher(new SomeEvent(SomeEvent.UPLOAD));
} 
```

Parsley 事件 SomeEvent 没有被捕获。但是，如果我在 if 语句之后调度该事件，它就会被捕获并且工作正常。知道为什么从结果处理程序外部调度它时没有被捕获吗？我也尝试过其他命令，它做同样的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:02:53.920

在 Spicefactory 网站上找到这个，按设计工作。我最终更新了模型中的标志，而不是调度事件。然后我有一个 BindSetter 监听模型中该标志的更改。当该标志设置为 true 时，将调度 Parsley 事件。

命令对象生命周期

除了对执行方法和结果处理程序进行分组之外，DynamicCommand 还为命令对象引入了一种特殊的生命周期管理。在发送匹配的消息之前，不会创建对象。然后，它仅在命令执行期间成为容器管理对象。**调用结果或错误处理程序后，它将立即从上下文中删除。**但在其生命周期内，它是一个完全托管的对象，可以注入其依赖项，甚至可以在命令执行期间参与消息传递。但这将是一种相当罕见的情况，最常见的使用场景可能是命令对象只是接收执行命令所需的所有依赖项。

# javascript - requirejs 异步加载我的 jquery 插件

> ID：16088624
> 
> 赞同：0
> 
> 时间：2013-04-18T16:40:39.450
> 
> 标签：javascript, asynchronous, requirejs, jamjs

我有一个**函数通过首先用****RequireJS**加载插件来调用**jquery插件函数**，问题是requirejs中的插件函数只有在我的函数已经返回后才会执行，所以hasMessageParent总是返回null。我真的很困惑，因为这之前工作正常，我不知道发生了什么变化和坏了。如何修复 myMsg 在继续之前设置为函数返回？

 **```
hasMessageParent: function() {
    var myMsg = null;
    var ctrl = '#myDiv';
    require(["my_msgcheck"], function() {
        // this gets executed after the return already happened, it returns true
        myMsg = $(ctrl).msg_check('hasMessage');
    });
    // this always returns null because the require jquery plugin function is executed after the return already happened
    return myMsg ;
}, 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:54:50.120

您无法通过单独修改函数来解决此问题，您必须将“my_msgcheck”添加到模块的定义调用中。

如果您真的只想在该函数中加载它，另一种选择是使用回调。但这可能是错误代码结构的标志。

```
var hasMessageParent = function(callback) {
    var myMsg = null;
    var ctrl = '#myDiv';
    require(["my_msgcheck"], function() {
        // this gets executed after the return already happened, it returns true
        myMsg = $(ctrl).msg_check('hasMessage');
        callback(myMsg);
    });
};
hasMessageParent(function (msg) {
    // ...
}); 
```**

# python - 图标和 SQL 安全性

> ID：16088626
> 
> 赞同：0
> 
> 时间：2013-04-18T16:40:41.297
> 
> 标签：python, django

我有一个网络应用程序，它允许用户输入搜索查询，然后检索符合此搜索条件的模型。这是我的方法：

```
@staticmethod
def searchBody(query):
    '''
    Return all entries whose body text contains the query.
    '''
    return Entry.objects.get(text__icontains=query)

@staticmethod
def searchTitle(query):
    '''
    Return all entries whose title text contains the query.
    '''
    return Entry.objects.get(title__icontains=query)

@staticmethod
def searchAuthor(query):
    '''
    Return all entries whose author text contains the query.
    '''
    return Entry.objects.get(author.icontains=query) 
```

我的问题很简单：这是否安全？换句话说，是否`incontains`执行了必要的字符串转义操作，这样一个人就不能将 SQL 或 Python 代码注入到查询中来发起攻击？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:49:56.283

是的，Django ORM 保护您免受 SQL 注入。

当然，您永远无法完全确定应用程序中没有安全漏洞。尽管如此，ORM 是负责保护您免受 SQL 注入的组件，因此您应该假设它是安全的并**保持您的 django 安装是最新的**！

* * *

在不相关的注释中，有一个错字`Entry.objects.get(author.icontains=query)`。

此外， using`.get`会在这里抛出很多错误（只要对象不存在，或者存在多个）。它也不像您的文档字符串所说的那样。

您可能想`.filter`改用。

# java - 如何从 servlet 获取客户端机器的操作系统名称？

> ID：16088630
> 
> 赞同：0
> 
> 时间：2013-04-18T16:40:54.370
> 
> 标签：java, jsp, servlets

我想从我的 servlet 中获取客户端机器的操作系统名称。我试过 request.getHeader("user-agent") 它没有给我正确的名字。告诉我其他方法...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:47:30.327

交付一个带有[确定操作系统的 JavaScript](https://stackoverflow.com/questions/9514179/how-to-find-the-operating-system-version-using-javascript)的 HTML 页面。然后可以将其发送到服务器。没有 java 类能够访问客户端 PC，只有浏览器发送的标头可以被利用。

# c++ - 用户定义的隐式转换运算符和重载决议

> ID：16088636
> 
> 赞同：3
> 
> 时间：2013-04-18T16:41:18.303
> 
> 标签：c++

今天，我在用户定义的隐式转换运算符中遇到了一个有趣的行为。

我们来看这段代码：

```
struct Widget {
    Widget(uint64_t) {

    }

    Widget(const std::string &) {

    }

    operator uint64_t() {
        return static_cast<uint64_t>(123456789UL);
    }

    operator std::string() {
        return std::string("Hello");
    }
}; 
```

可以隐式转换为 uint64_t 或 std::string 的基本结构。

现在，尝试通过 std::cout 打印出一个 Widget 实例：

```
#include <iostream>

int main() {
    using std::cout;
    Widget w(123456);

    cout << w;
} 
```

无论出于何种原因，Widget 将始终转换为 uint64_t。起初，我希望调用是模棱两可的，并且符合标准的显式转换为 compile ：

```
int main() {
    using std::cout;
    Widget w(123456);

    cout << static_cast<uint64_t>(w); 
```

}

但由于我现在忽略的原因，选择了 operator uint64_t。我试图查看 C++ 规范，但找不到任何有用的东西来回答我的问题。

谁能帮我弄清楚编译器对重载解析做了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:48:46.417

`uint64_t`转换是首选。原因很简单，它`<<`被重载为`strings`(basic_strings) 的模板。在重载决议上，编译器总是更喜欢精确匹配而不是模板。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T16:51:31.500

当然，您可以在 C++ 规范中找到它。

在和中读取*过载解决方案*`§13.3.1/2``§13.3.1/3`

> 重载解析选择函数在语言内的七个不同上下文中调用...

> *   首先，选择候选函数的子集（具有适当数量的参数并满足某些其他条件的函数）以形成一组可行的函数（13.3.2）。
> *   然后根据将每个参数与每个可行函数的相应参数匹配所需的隐式转换序列 (13.3.3.1) 选择最佳可行函数。

简而言之，编译器首先列出要使用的候选者，然后尝试找到最合适和更有效的重载。

# django - 同时发布多个美味派资源

> ID：16088638
> 
> 赞同：0
> 
> 时间：2013-04-18T16:41:20.520
> 
> 标签：django, django-models, tastypie

这是我正在尝试做的事情：

用户在我的应用程序中创建了一个事件。这是模型：

```
class Event(models.Model):
    name = models.CharField(max_length=40)
    organizer = models.ForeignKey(UserProfile)
    description = models.TextField(null=True)
    place = models.TextField(null=True)
    confirmed = models.BigIntegerField(null=True)
    organizer_part = models.BooleanField(default=True)
    slug = models.SlugField() 
```

之后，它会发布受邀参加此活动的不同人员，以及用户选择的不同日期。以下是型号：

```
class EventDate(models.Model):
    """Correspondances date-event"""
    event = models.ForeignKey(Event)
    date = models.BigIntegerField()

class EventPeople(models.Model):
    """Correspondances personne-event"""
    event = models.ForeignKey(Event)
    phone_number = models.PositiveIntegerField()
    name = models.CharField(max_length=32)
    answer = models.BooleanField()
    participation = models.NullBooleanField() 
```

我只想在一个请求中填写这三个模型。到目前为止，我必须提出三个请求。我看不出我怎么可能做到这一点。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T00:12:32.270

应该与您的模型一起使用的资源是：

```
class EventResource(ModelResource):
    event_dates = fields.ToManyField(EventDateResource, 'event_dates')
    event_peoples = field.ToManyField(EventPeopleResource, 'event_peoples')
    class Meta:
          queryset = Event.objects.all() 
```

您还必须创建简单的 EventDateResource 和 EventPeopleResource。

你的模型再一变化，你需要添加related_names：

```
class EventDate(models.Model):
    """Correspondances date-event"""
    event = models.ForeignKey(Event, related_name='event_dates')
    date = models.BigIntegerField()

class EventPeople(models.Model):
    """Correspondances personne-event"""
    event = models.ForeignKey(Event, related_name='event_peoples')
    phone_number = models.PositiveIntegerField()
    name = models.CharField(max_length=32)
    answer = models.BooleanField()
    participation = models.NullBooleanField() 
```

# arrays - 如何用 ls 创建正确的数组？

> ID：16088639
> 
> 赞同：0
> 
> 时间：2013-04-18T16:41:24.980
> 
> 标签：arrays, for-loop, ls

我已经知道我可以使用`array=( $( ls . ) )`，但我对这段代码有下一个问题：

```
array=( $( ls ./COS/cos*.txt ) )
for ((  i = 0 ;  i <= ${#array[*]}-1;  i++  ))
do
    sed 's/$'"/`echo \\\r`/" ${array[$i]} > ./COS/temp.txt
    mv ./COS/temp.txt ${array[$i]}
done 
```

我在整个脚本中有更多的循环，具有不同的目录，sed 和 mv 的各自指令没有问题，但是我对这部分代码有问题，似乎命令 ls 将整个结果保存在第一个位置数组，即如果COS目录有cos1.txt、cos2.txt和cos3.txt，而不是将cos1.txt保存在${array[0]}中，cos2.txt保存在${array[1]}和cos3中。 ${array[2]} 中的 txt 正在保存：

cos1.txt cos2.txt cos3.txt in ${array[0]}，数组位置 0 的整个列表。你知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:40:46.927

目前尚不清楚您的实际问题是什么，但您应该编写如下代码：

```
# Don't use ls. Just let the glob expand to the list of files
array=( ./COS/cos*.txt )
# Don't iterate over array indices; just iterate over the items themselves
for fname in "${array[@]}"; do
do
    # Are you trying to add a carriage return to the end of each line?
    sed "s/\$/$'\r'/" "$fname" > ./COS/temp.txt
    mv ./COS/temp.txt "$fname"
done 
```

你甚至不需要数组；您可以简单地将 glob 放在 for 循环中：

```
for fname in ./COS/cos*.txt; do
   ...
done 
```

# c# - SetWindowHookEx 在 C# 应用程序运行时失败

> ID：16088641
> 
> 赞同：1
> 
> 时间：2013-04-18T16:41:29.533
> 
> 标签：c#, .net, winapi, hook, setwindowshookex

我正在构建一个应用程序使用钩子，我想启动另一个应用程序，在我构建我的应用程序之后，应用程序将获得另一个应用程序和 setwindowhook 的自动化窗口句柄。但我做不到。请帮助我:(。我的英语

当我得到所有应用程序时，变量窗口是 hwnd 是 windowform 正在运行

```
private bool AddWnd(int hwnd, int lparam)
{
    if (IsWindowVisible(hwnd))
    {
        StringBuilder sb = new StringBuilder(255);
        string className = GetClassName((IntPtr)hwnd).ToString();
        if (className.Length > 10)
        {
            string getSubStringClassName = className.Substring(0, 11);
            if (getSubStringClassName.Equals("WindowsForm") && IsWindow(hwnd)!=0)
            {
                GetWindowText(hwnd, sb, sb.Capacity);
                window = hwnd;
            }
        }
    }
    return true;
}

HookProc HookProcedure;
private const int WH_CBT = 5;

public void startHook()
{
    if (hHook == 0)
    {
        HookProcedure = new HookProc(CbtHookProc);
        int threadID = GetWindowThreadProcessId((IntPtr)window, out processHandle);
        IntPtr hMod = System.Runtime.InteropServices.Marshal.GetHINSTANCE(typeof(Form1).Module);
        hHook = SetWindowsHookEx(WH_CBT, HookProcedure, hMod, threadID);
        if (hHook == 0)
        {
            MessageBox.Show("SetWindowsHookEx Failed");
            return;
        }
    }
    else
    {
        bool ret = UnhookWindowsHookEx(hHook);
        //If the UnhookWindowsHookEx function fails.
        if (ret == false)
        {
            MessageBox.Show("UnhookWindowsHookEx Failed");
            return;
        }
        hHook = 0;
        button1.Text = "Set Windows Hook";   
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-28T22:42:04.737

您可以从托管 .NET 应用程序安装的挂钩只有两种类型：低级键盘 ( `WH_KEYBOARD_LL`) 和低级鼠标 ( `WH_MOUSE_LL`) 挂钩。不同的是，这两个钩子的回调函数是由你自己的程序实现的。所有其他类型的钩子都需要在 DLL 中实现回调函数，该 DLL 可以实际注入到钩子进程中。这不适用于托管代码，因为托管 DLL 无法安全地注入到非托管进程中。

所以无论你做什么来修复你的 C# 代码，这将永远不会起作用。`WH_CBT`永远不能从 C# 应用程序或 DLL 安装基于计算机的培训挂钩 ( )。您将需要切换到不同的语言来编写您的钩子 DLL；C 和 C++ 是常见的选择。

或者，如果您只关心在另一个应用程序创建窗口时接收通知，您可以改用可访问性 API，它在托管应用程序中工作。开始调查[`SetWinEventHook`功能](http://msdn.microsoft.com/en-us/library/windows/desktop/dd373640.aspx)。您需要指定`WINEVENT_OUTOFCONTEXT`标志以确保将通知传递到您的进程；否则需要一个可注入的 DLL，我们已经知道它是行不通的。`EVENT_OBJECT_CREATE`和/或`EVENT_OBJECT_SHOW`事件是您要监视的事件。

# php - 如何使用 jquery mobile 将页面幻灯片添加到动态创建的列表中？

> ID：16088643
> 
> 赞同：0
> 
> 时间：2013-04-18T16:41:31.690
> 
> 标签：php, html, jquery-mobile

这是我填充的列表视图的 html。我也从 php 脚本中获取了链接。我会在哪里将页面滑动功能放在点击事件上。它不允许我在脚本中使用 html

```
 <div data-role="content">
<script type="text/javascript">
                            $(document).on("pagebeforeshow", "#index1", function() {
                                $(function(){
                                    var items="";
                                    $.getJSON("check-events.php",function(data){
                                    $.each(data,function(index,item) 
                                    {
                                    items+="<li><a href="+item.col1+"?eventid="+item.id+">"+item.col2+"<p></p><p>"+item.col3+"</p></li>";
                                     });

                                    $("#contacts").append(items); 
                                     $("#contacts").listview("refresh");
                                    });
                                });
                            });  
                        </script>

            <div data-role="fieldcontain">
                        <ul id="contacts" data-role="listview" data-divider-theme="b" data-inset="true">
                     <li data-role="list-divider" role="heading">
                 List view
                </li> 
            </ul>
            </div> 
```

我会在哪里添加这段代码。当我像这样添加它时它不断产生错误

```
items+="<li><a href="+item.col1+"?eventid="+item.id+" data-transition="slide">"+item.col2+"<p></p><p>"+item.col3+"</p></li>"; 
```

有任何想法吗

工作解决方案php

```
$data = array();
        while($rowa = mysql_fetch_array($a, MYSQL_ASSOC)) 
            { 
            $row_array['id'] = $rowa['eventid'];
            $row_array['col1'] = "index.html";
            $row_array['col2'] = $rowa['eventname'];
            $row_array['col3'] = date("D jS F Y",strtotime($rowa[enddate]));
            $row_array['col4'] = "slide";
            array_push($data,$row_array);

            }
        echo json_encode($data);
} 
```

改变了html

```
items+="<li><a href=\""+item.col1+"?eventid="+item.id+"\" data-transition=\""+item.col4+"\">"+item.col2+"<p></p><p>"+item.col3+"</p></li>";}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:45:54.550

输入变量时需要转义引号 ( `\"`)

```
items+="<li><a href=\""+item.col1+"?eventid="+item.id+"\" data-transition=\""slide"\">"+item.col2+"<p></p><p>"+item.col3+"</p></li>"; 
```

但是，附带说明一下，您应该让 JQuery 为您创建元素。请参阅：[https ://stackoverflow.com/a/4158203/1178781](https://stackoverflow.com/a/4158203/1178781)

# java - 在“>”上拆分长字符串

> ID：16088644
> 
> 赞同：1
> 
> 时间：2013-04-18T16:41:32.590
> 
> 标签：java, regex, coldfusion, split

我正在尝试使用`split()`方法来拆分包含重复标签的长字符串（包含 CFML 代码的文本文档的内容），每个标签都以这两个字符结尾：`">`和换行符。

我无法弄清楚如何做到这一点，尝试多个正则表达式没有运气，在提到的标签内可以嵌套其他标签（请不要问为什么:-)），并且这些嵌套标签上的拆分中断，即使它们不包含`">`

例子：

```
<cfset code = "Text text text <table style='width:538px; [... more text stripped ...] </table>">
<cfset another_code = "Text text text">
... 
```

任何线索将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:47:39.813

要使用纯正则表达式，我会使用`str.split(Pattern.quote("\">"))`.

但是，您应该考虑使用 XML 解析器，例如 SAX、StAX、DOM 解析器等。无需重新发明轮子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:10:53.127

我不确定您要做什么，但是如果您想拆分，`">(new line)`则可以使用`split("\">\r?\n")`. 但也许你想在`">`以前的新线标记上分割？在这种情况下，您可以使用后视机制，例如`split("(?<=\">)\r?\n")`

# c++ - 何时用单例替换全局 std::unique_ptr

> ID：16088650
> 
> 赞同：10
> 
> 时间：2013-04-18T16:41:45.587
> 
> 标签：c++

一位同事坚持对所有全局指针变量使用 Meyer 的 Singleton，因为“不能保证全局的构造`unique_ptr`不会抛出”。所以而不是：

```
#include <memory>

std::unique_ptr<Foo> ptr(nullptr); // Apparently this isn't safe.

int main(/*blah*/)
{
    ptr.reset(new Foo());
} 
```

我们现在有

```
unique_ptr<Foo> singleton
{ 
    try 
    { 
        static unique_ptr<Foo> ptr(); 
        return ptr; 
    } 
    catch (...) 
    { 
        std::cerr << "Failed to create single instance\n"; 
        exit(1); 
    } 
    return unique_ptr<Type>(); 
}

int main()
{
} 
```

对我来说，这似乎是寻找问题的解决方案。他有道理吗？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-18T16:47:25.857

您的同事不正确（或者可能只是过时，预标准版本`unique_ptr`可能不同）。的`nullptr_t`构造函数`unique_ptr`保证不抛出（20.7.1.2）：

```
constexpr unique_ptr (nullptr_t) noexcept : unique_ptr() {} 
```

由于它也是`constexpr`（并且因为`nullptr`是常量表达式），因此需要在常量初始化期间对其进行初始化（3.6.2/2）。因此控制初始化顺序（Meyers 单例可能有用的另一个原因）也不适用于此处。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T16:45:26.790

> “不能保证全局 unique_ptr 的构造不会抛出”

如果它抛出，会发生什么？应用程序被终止，尽管标准没有指定如果您没有捕获异常，堆栈是否会展开（作为全局变量，没有地方可以捕获异常）。我不清楚提议的解决方案如何明显改进。

# java - 每个 ID 的 Java 单独记录器配置

> ID：16088651
> 
> 赞同：1
> 
> 时间：2013-04-18T16:41:47.587
> 
> 标签：java, slf4j, java.util.logging

我期待实际配置一个应该为不同 ID 创建的记录器。

我的应用程序非常庞大，一次有近 20 个用户访问该应用程序，因此当他们遇到任何异常时，很难在日志中检查实际出了什么问题。

所以我想创建一个记录器，使其在我提供的 ids（唯一）上生成日志。（即，我的意思是每个 ID 都有单独的记录器）

任何人都可以帮助我如何实现这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T21:14:02.283

Logback 的[SiftingAppender](http://logback.qos.ch/manual/appenders.html#SiftingAppender)就是为此目的量身定制的。

# dojo - 如何使用dojo字典对象和dojo.mixin()函数？

> ID：16088659
> 
> 赞同：0
> 
> 时间：2013-04-18T16:42:17.553
> 
> 标签：dojo

我有一个像这样的函数，我需要覆盖它。

myfunction.getExtraConfig=function() { 返回 {}; };

我需要传入一个对象并让它返回多个值。

我如何使用字典来做到这一点 {prop1: 1, prop2: 3}？

如何使用 dojo.mixin() 添加返回值？

有没有我可以参考的示例代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:34:55.423

Dojo's mixin function only mixes objects' properties. The return value in your `getExtraConfig` function is not an object property.

I'm not sure this is what you want, but one way to alter the return value from `getExtraConfig` is to use dojo/aspect:

```
define(["dojo/_base/lang", "dojo/aspect"], function(lang, aspect){
  //...
  aspect.after(myfunction, "getExtraConfig", function(original){
      return lang.mixin(original, {prop1: 1, prop2: 3});
  });
  //...
}); 
```

# apache - Apache mod_rewrite 到 Nginx 重写规则

> ID：16088663
> 
> 赞同：0
> 
> 时间：2013-04-18T16:42:24.343
> 
> 标签：apache, mod-rewrite, nginx

我的站点在 Nginx 上运行，我正在尝试在站点的子目录中添加一个使用 Apache 的 mod_rewrite 规则的软件。例如 www.mydomain.com/mySubfolder

这是 Apache .htaccess

```
#Options -Indexes
<ifModule mod_rewrite.c>
    RewriteEngine On
    RewriteCond %{REQUEST_URI} ^/system.*
    RewriteRule ^(.*)$ index.php?/$1 [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.+)$ index.php?/$1 [L]
</ifModule> 
```

到目前为止，我设法让主页正常工作，但是在请求登录页面时，它会导致 URL 重定向循环。例如 www.myDomain.com/login 用这个：

```
location /mySubfolder {
if (!-e $request_filename) {
rewrite ^(.*)$ /mySubfolder/index.php?q=$1 last;
break;
}
} 
```

我一直在阅读并尝试学习如何将 Apache 转换为 Nginx，甚至使用了我在[http://winginx.com/htaccess](http://winginx.com/htaccess)找到的 .htaccess 到 Nginx 转换器，但该工具似乎无法识别 %{REQUEST_URI} ^ /system.* 部分。经过我的研究和研究，我想出了：

```
location /mySubfolder {
if ($request_uri ~ "^/(system.*)$") {
rewrite ^/(.*)$ index.php?/$1 last;
}
if (!-e $request_filename) {
rewrite ^(.+)$ /mySubfolder/index.php?q=$1 last;
break;
}
} 
```

我对此完全是个菜鸟，甚至想知道我是否接近完成这种转换为工作。请帮忙。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T00:14:27.620

> 甚至想知道我是否接近完成这种转变为工作

您在 Nginx 中使用的方法基本上是错误的。

虽然很自然地假设 Apache 中的重写规则将映射到 Nginx 中的重写，但事实并非如此。相反，它们大多映射到位置规则。

您的块`mySubfolder`应该如下所示：

```
location ^/mySubfolder {
    try_files /mySubfolder/index.php?$args =404;
} 
```

你实际上并没有重写任何东西——你只是告诉 nginx 任何以 /MySubfolder 开头的请求都应该由`try_files`. 顺便说一句，您必须告诉 Nginx 传递正在`args`执行的查询字符串。

`$_SERVER['REQUEST_URI']`您可以附加原始 URL（我认为），尽管在脚本中使用它可能更容易。

我相信您对相同起始 URI 的重写规则导致 /mySubFolder 保持匹配。

在 Nginx 中，仅当您希望外部 URL 路径由不同的内部 url 提供服务时才使用重写，并且通常重写规则不在位置块内。

例如，我有一个文件服务器，它提供图像和其他文件。我在服务器块中有这些重写规则：

```
rewrite  ^/image/(\d+)/(\w+)/(.+)\.([^\.]*)$ /proxy/proxyImage.php?typeID=$1&mode=$2&imagePath=$3.$4&resizeAllowed=TRUE&type=image last;
    rewrite  ^/image/(\d+)/(.+)\.([^\.]*)$ /proxy/proxyImage.php?typeID=$1&imagePath=$2.$3&resizeAllowed=TRUE  last;
    rewrite  ^/file/(\d+)/(.+)\.([^\.]*)$ /proxy/proxyFile.php?typeID=$1&imagePath=$2.$3&resizeAllowed=FALSE last; 
```

使外部 URL 看起来不错。但是它们都由 location 块提供服务：

```
location ~* ^/proxy  {
        try_files $uri =404;
        fastcgi_pass   unix:/opt/local/var/run/php54/php-fpm-images.sock;
        include       /documents/projects/intahwebz/intahwebz/conf/fastcgi.conf;
    } 
```

位置块不需要知道 URL 重写，因为它们是在遇到位置块之前完成的。

# java - 杰克逊映射关系

> ID：16088664
> 
> 赞同：2
> 
> 时间：2013-04-18T16:42:25.150
> 
> 标签：java, json, jersey, jackson

我正在使用泽西岛，并且希望将 POST 作为一个实体。然而 thst POST 也将包含`UUID`其关系之一：

泽西资源：

```
@POST
public WorkstationEntity save (WorkstationEntity workstationEntity) {
            //WorkflowProcessEntity workflowProcessEntity = workflowProcessService.findByUUID();

    workstationService.save(workstationEntity);
    return workstationEntity;
} 
```

如何调整以下映射以便识别关系并正确保存？目前`workflow_process_id`保存时为NULL，我必须手动查询实体。

正在发布的 JSON 是...`{name: Workstation 1; workflow_process_id: 1}`

```
private WorkflowProcessEntity workflowProcess;

@ManyToOne
@JoinColumn(name = "workflow_process_id", referencedColumnName = "id")
public WorkflowProcessEntity getWorkflowProcess() {
    return workflowProcess;
}

public void setWorkflowProcess(WorkflowProcessEntity workflowProcess) {
    this.workflowProcess = workflowProcess;
} 
```

**工作站服务**

```
@Transactional
public void save(WorkstationEntity workstationEntity) {
    workstationRepository.save(workstationEntity);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T15:38:41.173

如果我理解问题是返回的 json 对于附加的 WorkstationProcessEntity id 字段有一个空 id。当您在返回分离的实体之前尝试持久/合并未提交事务的实体时，这很可能是一个问题。如果您使用持久化，请确保您提交事务，否则 id 将为空。否则，如果您使用合并，这通常会解决问题。

```
protected T persist(T obj) {
    EntityManager em = ThreadLocalPersistenceManager.getEntityManager();

    EntityTransaction tx = em.getTransaction();
    try {
        if (! tx.isActive()) {
            tx.begin();
        }

        em.persist(obj);
    } finally {
        if (!tx.getRollbackOnly()) {
            tx.commit();
        }
    }

    return obj;
} 
```

另一个可能的原因是您的 fetch 未设置为 eager，因此数据存储区只会在实体被访问时获取实体，而当您从帖子返回时，未附加子实体。这是导致您的问题的最可能原因。您应该尝试在关闭实体管理器之前访问工作站实体 getWorkflowProcess。否则附加的实体将为空。或者添加 FetchType.Eager 注解，在访问父实体时从数据库中获取子实体。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T15:19:10.973

你能显示代码`workstationService`吗？你在使用`Hibernatr`还是简单`jdbc`或任何其他`orm tool`？

我认为在里面`workstationService.save(workstationEntity);`你需要附加`workstationEntity`到会话（在 Hibernate Hibernate Session 的情况下）。然后`save`它..

# c++ - 能够用 boost 序列化但不能反序列化 std::shared_ptr

> ID：16088665
> 
> 赞同：2
> 
> 时间：2013-04-18T16:42:25.410
> 
> 标签：c++, serialization, boost

提升序列化

```
namespace boost { 

  namespace serialization {

    template <class Archive, class T>
    inline void save
        (Archive &archive, 
        const std::shared_ptr<T> subtree,  
        const unsigned int file_version)
    {
        // only the raw pointer has to be saved
        const T *const  subtree_x = subtree.get();

        archive << subtree_x;
    }

    template <class Archive, class T>
    inline void load
        (Archive &archive, 
        std::shared_ptr<T> subtree, 
        const unsigned int file_version)
    {

        T *p_subtree;

        archive >> p_subtree;

        #if BOOST_WORKAROUND(BOOST_DINKUMWARE_STDLIB, == 1)
            subtree.release();
            subtree = std::shared_ptr< T >(p_subtree);
        #else
            subtree.reset(p_subtree);
        #endif
    }

    template <class Archive, class T>
    inline void serialize
        (Archive &archive, 
        std::shared_ptr<T> subtree,  // no const or else get compile-time error
        const unsigned int file_version)
    {
        boost::serialization::split_free(archive, subtree, file_version);
    }

  } // namespace serialization
} // namespace boost 
```

树类

```
class Tree{

private:

class TreeNode{

public:

    std::shared_ptr<TreeNode> node_factory(const T &new_key, const long &new_index)
    {
        return std::shared_ptr<TreeNode>(new TreeNode(new_key, new_index)); 
    }

    friend class Tree;

private:

    friend class boost::serialization::access;
    template<class Archive>
    void serialize(Archive &archive, const unsigned int /* file_version */){
        archive & key;
        archive & index;
        archive & left;
        archive & right;
    }

    T key;
    long index;

    std::shared_ptr<TreeNode> left;
    std::shared_ptr<TreeNode> right;

};  // End Tree Node Class Definition

friend class boost::serialization::access;
template <class Archive>
void serialize(Archive &archive, const unsigned int version){
    archive & root;
}
 }; 
```

作家

```
bool save(std::shared_ptr<Tree> &tree, const std::string &search_tree_file_name)
{
    // create and open a binary archive for output
    std::ofstream writer(search_tree_file_name, std::ofstream::out | std::ofstream::binary);

    if(writer){
        boost::archive::binary_oarchive serial_writer(writer);
        //set_flags(0, true);
        // write class instance to archive
        serial_writer << *tree;
        // archive and stream closed when destructors are called

    }else if(writer.fail()){
        writer.clear();
    }
    return true;
} 
```

读者

```
enter code here bool load(std::shared_ptr<Tree> &tree, const std::string &search_tree_file_name)
{
    // create and open a binary archive for output
    std::ifstream reader(search_tree_file_name, std::ifstream::in | std::ifstream::binary);

    if(reader){
        boost::archive::binary_iarchive serial_reader(reader);
        // read class state from archive
        serial_reader >> *tree;
        // archive and stream closed when destructors are called

    }else if(reader.fail()){
        reader.clear();
    }

    return true;
} 
```

我已经写入并验证了对文件的成功序列化，但未能从可用对象反序列化到可用对象。

无论我是用文本还是二进制编写，我都可以验证序列化输出是否正确，但由于某种原因，序列化输出不会反序列化，并且在加载时留下一个空对象。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T06:26:46.870

看看这些链接，可能会为您提供一些线索。 [http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/shared_ptr.html](http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/shared_ptr.html) & [http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/shared_ptr2。 html](http://www.boost.org/doc/libs/1_49_0/libs/serialization/doc/shared_ptr2.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T11:49:57.497

尽管`@Arun`提供了对使用有用的大量文档参考`std::shared_ptr`，但我选择使用`boost::shared_ptr`boost::serialization 并且它解决了我的反序列化问题。

# python - PIL ImageDraw.textsize 返回不正确的高度

> ID：16088666
> 
> 赞同：9
> 
> 时间：2013-04-18T16:42:25.660
> 
> 标签：python, python-imaging-library

我遇到了 PIL 的 ImageDraw 模块的问题，特别是`Draw.textsize`方法。这个方法应该接受一个字符串和一个字体，并返回该字符串在以该字体呈现时所占据的宽度和高度。不过，它似乎对它返回的高度有一个下限：我无法说服它返回任何低于`43`. 这是一个示例（[链接](http://i.stack.imgur.com/nndzX.png)）来显示我正在查看的内容（基于返回的宽度和高度在文本周围绘制的边界框），这是生成它的代码：

```
from PIL import Image, ImageDraw, ImageFont # PIL 1.1.7; Python 2.6.6

im = Image.open(r'C:\test\blank.png').convert('RGB')
draw = ImageDraw.Draw(im)

TEXTCOLOR = (0, 0, 0)
X = 10
Y = 3

for fontsize in xrange(8, 51):
    # Other fonts behave the same way
    font = ImageFont.truetype('Arial.ttf', fontsize)

    text = 'Hello, World! Size %d' % fontsize

    width, height = draw.textsize(text, font=font)
    print 'Font size %d: %d x %d' % (fontsize, width, height)

    bbox = [(X, Y), (X+width, Y+height)]
    draw.rectangle(bbox, outline=TEXTCOLOR)
    draw.text((X, Y), text, font=font, fill=TEXTCOLOR)
    Y += height + 3

im.show() 
```

一旦字体大小达到 38 左右，边界框就会拉伸以正确匹配它，但在此之前，它被设置为 static `43`。问题是，有谁知道为什么 ImageDraw 会这样，有谁知道修复它的方法吗？我目前正在通过设置解决这个问题：

```
width = min(width, fontsize+1) 
```

...但这显然不是有史以来最强大的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T13:51:19.953

基本问题似乎是 PIL 是超级错误，基本上不再受支持。这里提到的问题并不是最糟糕的（例如，没有人能够复制它，因为它甚至很难安装......）。

鉴于 PIL 1.1.7 中似乎很猖獗的所有问题，最好的解决方案似乎是简单地安装[Pillow](https://pypi.python.org/pypi/Pillow/2.0.0#downloads)并继续前进。它不需要对已经运行 PIL 的代码进行代码更改（它是一个 PIL 分支，因此它安装了“PIL”库），而且它似乎更加友好（并且仍然有效）。正如该问题的评论者所证实的那样，这是一个简单、无故障的安装，并且实际上可以正常工作。

# javascript - 如何使用高图表更改工具提示

> ID：16088672
> 
> 赞同：1
> 
> 时间：2013-04-18T16:42:55.630
> 
> 标签：javascript, datetime, highcharts, tooltip

我已经使用 High Chart 成功创建了一个图表来比较患者的预期时间和到达时间。

但是，我现在遇到了`label`列的问题；这是显示时间`milliseconds`。

下面的屏幕截图显示了该问题：

![在此处输入图像描述](https://i.stack.imgur.com/MBBju.jpg)

如何更改标签以格式显示时间 (H:M:S)

代码：

```
<script type="text/javascript">
        function drawChart(){
            var chart = new Highcharts.Chart({
                chart: {
                    renderTo: 'divforchart',
                    type:'column',
                },
                xAxis: {
                    name:'patients',
                    categories: [<?php
                    echo "'".$names[0]."'";
                    for($i = 1; $i < sizeof($names); $i++){
                        echo ",'".$names[$i]."'";
                    }
                    ?>]
                },
                yAxis: {
                    type: 'datetime',
                    dateTimeLabelFormats: { 
                        //force all formats to be hour:minute:second
                        second: '%H:%M:%S',
                        minute: '%H:%M:%S',
                        hour: '%H:%M:%S',
                        day: '%H:%M:%S',
                        week: '%H:%M:%S',
                        month: '%H:%M:%S',
                        year: '%H:%M:%S'
                    },
                    min: <?php echo "Date.UTC(".gmdate("Y,m,d,H",strtotime($minDate)).")";?>
                },

                series: [
                    {
                        name: 'Arrival time',
                        data: [<?php
                            echo "['".$names[0]."',Date.UTC(".gmdate("Y,m,d,H,i,s",strtotime($Arrival_time[0])).")]";
                            for($i = 1; $i < sizeof($names); $i++){
                                echo "
                                ,['".$names[$i]."',Date.UTC(".gmdate("Y,m,d,H,i,s",strtotime($Arrival_time[$i])).")]";
                            }
                        ?>]
                    },
                    {
                        name: 'Expected time',
                        data: [<?php
                            echo "['".$names[0]."',Date.UTC(".gmdate("Y,m,d,H,i,s",strtotime($Expected_time[0])).")]";
                            for($i = 1; $i < sizeof($names); $i++){
                                echo "
                                ,['".$names[$i]."',Date.UTC(".gmdate("Y,m,d,H,i,s",strtotime($Expected_time[$i])).")]";
                            }
                        ?>]
                    }
                ]
            });
        }
    </script>
    </head>
    <body onLoad="drawChart()">
     <div id="divforchart" style="height: 400px"></div>
    </body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:56:21.703

尝试：

```
Highcharts.dateFormat(values) 
```

见这里：[http ://api.highcharts.com/highcharts#Highcharts.dateFormat%28%29](http://api.highcharts.com/highcharts#Highcharts.dateFormat%28%29)

如果您想在系列中使用它，或者您可以更改工具提示。

```
series: [{
        dataLabels: {
            enabled: true,
            formatter:function() {
                return Highcharts.dateFormat('%H:%M:%S',this.y);
            },
            style:{color:"black"}
        },
        data: [data]
    }] 
```

工具提示：

```
tooltip:{
    formatter:function() {
        return Highcharts.dateFormat('%H:%M:%S',this.y);
    }
} 
```

您的代码必须如下所示：

```
chart: {
                    renderTo: 'divforchart',
                    type:'column',
                },
tooltip: { ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:00:24.200

从外观上看，您指的是工具提示，而不是 dataLabel。您可以使用 formatter 函数正确格式化日期：

[http://api.highcharts.com/highcharts#tooltip.formatter](http://api.highcharts.com/highcharts#tooltip.formatter)

（如果您实际上是在谈论 dataLabel，您仍然可以做同样的事情：http: [//api.highcharts.com/highcharts#plotOptions.series.dataLabels.formatter](http://api.highcharts.com/highcharts#plotOptions.series.dataLabels.formatter)）

我认为默认值是 numberFormat y 轴值，但您将希望在格式化程序中使用 dateFormat 函数：

[http://api.highcharts.com/highcharts#Highcharts.dateFormat%28%29](http://api.highcharts.com/highcharts#Highcharts.dateFormat%28%29)

如果您需要帮助实现，请创建一个 jsfiddle ( [http://jsfiddle.net/](http://jsfiddle.net/) ) 并回发

# vb.net - 在 vb 中播放声音

> ID：16088680
> 
> 赞同：1
> 
> 时间：2013-04-18T16:43:24.123
> 
> 标签：vb.net, visual-studio-2010, audio

好的，所以我使用 Visual Studio 2010 几乎完善了一款名为lucky 7 的游戏。我想在赢得游戏时播放声音（在三个插槽之一中获得 7）。这是代码：

```
Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click

    For i = 0 To 2
        slots(i) = rand.Next(10)
    Next

    Label1.Text = (slots(0).ToString)
    Label2.Text = (slots(1).ToString)
    Label3.Text = (slots(2).ToString)

    If slots(0) = 7 Or slots(1) = 7 Or slots(2) = 7 Then
        score = score + 100 'REM 10 points for each win 
        Label4.Text = (score.ToString)
        PictureBox1.Visible = True 'REM If you have a PictureBox
        PlaySound "C:\WINDOWS\MEDIA\TADA.WAV",
    Else
        PictureBox1.Visible = False
    End If

    If score = 500 Then

        MsgBox("You Scored 500 Points!", vbInformation)
    End If

End Sub 
```

问题是，我在“playsound”语句中遇到错误，我真的很想在玩家赢得比赛时播放那个声音！

我还尝试创建一个重置按钮，它将分数和所有三个插槽设置回 0，但是当我单击它时，什么也没有发生。这是重置按钮的代码：

```
 Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
    score = 0
    PictureBox1.Visible = False
End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:47:12.620

尝试使用 My.Computer.Audio.Play

您是否浏览过代码以确保按钮单击事件没有发生任何事情？单击“score = 0”行的最左侧将设置一个断点。这将在您运行代码时暂停代码。您可以将鼠标悬停在变量分数上，它会显示它的值。按 [F8] 将执行它，您可以将鼠标悬停在它上面并看到它已更改。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:34:12.003

从您的重置按钮事件中，您的分数被重置为 0，但不是文本。您的 3 个插槽的文本也没有变化。

```
Private Sub Button2_Click(sender As System.Object, e As System.EventArgs) Handles Button2.Click
  Label1.Text = "0"
  Label2.Text = "0"
  Label3.Text = "0"
  Label4.Text = "0"
  score = 0
  PictureBox1.Visible = False
End Sub 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T00:16:21.030

正如有人提到的，声音文件可能不会出现在每台计算机上。您应该考虑使用系统哔声，可以对其进行修改以发出一些奇怪的铃声。我玩得很开心...

至于您的重置按钮...您尚未对要重置的标签文本进行编码。我猜你只想要视觉上的改变，因为当你再次玩时这些值仍然会改变。但是，作为一个重置按钮，我想您可能希望将每个标签文本重置为 string.empty 或其他内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-04T13:53:58.287

你应该试试这个来播放 .wav 声音文件：

```
My.Computer.Audio.Play("C:\WINDOWS\MEDIA\TADA.WAV",AudioPlayMode.Background) 
```

# jsf - 我被困在 p:Tabmenu 帮助请

> ID：16088685
> 
> 赞同：-3
> 
> 时间：2013-04-18T16:43:39.423
> 
> 标签：jsf, primefaces

我正在使用 p:tabMenu 组件。我有 4 个菜单项，每个菜单项都重定向到不同的 jsf 页面，但问题是该页面在不更改 activeindex 的情况下返回，并且 activeindex 保持与初始值为 0 相同。

此代码位于所有页面的模板页面上

```
<h:form>
    <p:tabMenu activeIndex="0">
        <p:menuitem value="Home" url="Menu.jsf" icon="ui-icon-star" />
        <p:menuitem value="Fabricants" url="/pagess/pagesFabricant/Fabricant.jsf" icon="ui-icon-wrench"  />  
        <p:menuitem value="Composants" url="/pagess/pagesComposant/Composant.jsf" icon="ui-icon-search"  />  
        <p:menuitem value="Dossier d'equivalence" url="DEQ.jsf" icon="ui-icon-document"  />  
    </p:tabMenu> 
    </h:form> 
```

**知道应该自动更改，我该如何解决这个问题？**

我将托管 bean 托盘它不起作用

```
public class LoginBean {
    private int activeindex=0;
public int getActiveindex() {
        return activeindex;
    }

    public void setActiveindex(int activeindex) {
        this.activeindex = activeindex;
    }  

   public void Dirige(int a){

       activeindex=a;
   }}..

<p:tabMenu activeIndex="#{loginBean.activeindex}" > 
        <p:menuitem value="Home" url="Menu.jsf" icon="ui-icon-star"  action="#{loginBean.Dirige(0)}"/>  
        <p:menuitem value="Fabricants" url="/pagess/pagesFabricant/Fabricant.jsf" icon="ui-icon-wrench" action="#{loginBean.Dirige(1)}"/>
    </p:menuitem> 
```

它也不起作用

**我尝试为 everu menuitem 添加 update="@all" 。它是一样的 :(**

* * *

我忘了告诉你。这个组件在模板页面上..所有使用这个模板的页面！！！当页面在浏览器上收费时的问题，它具有模板的属性，在模板上的代码是

```
<h:form>
    <p:tabMenu activeIndex="0">
        <p:menuitem value="Home" url="Menu.jsf" icon="ui-icon-star" />
        <p:menuitem value="Fabricants" url="/pagess/pagesFabricant/Fabricant.jsf" icon="ui-icon-wrench"  />  
        <p:menuitem value="Composants" url="/pagess/pagesComposant/Composant.jsf" icon="ui-icon-search"  />  
        <p:menuitem value="Dossier d'equivalence" url="DEQ.jsf" icon="ui-icon-document"  />  
    </p:tabMenu> 
    </h:form> 
```

它在 0 上显示活动索引，为此我认为所有重定向的页面都没有同步活动索引.. 请问有什么问题吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T18:28:20.007

我认为只能在操作方法中更新组件树。

您可以在动作方法中动态修改组件并同样设置活动索引。

这是 tabMenu 组件 api，供进一步参考。

[http://www.primefaces.org/docs/api/3.5/org/primefaces/component/tabmenu/TabMenu.html](http://www.primefaces.org/docs/api/3.5/org/primefaces/component/tabmenu/TabMenu.html)

```
public void getFooClientId(int activeIndex) {
    FacesContext context = FacesContext.getCurrentInstance();
    UIViewRoot root = context.getViewRoot();

    final String componentId = "foo";
    UIComponent c = findComponent(root, componentId);
    TabMenu t = (TabMenu)c;
    t.setActiveIndex(activeIndex);

  }

  /**
   * Finds component with the given id
   */
  private UIComponent findComponent(UIComponent c, String id) {
    if (id.equals(c.getId())) {
      return c;
    }
    Iterator<UIComponent> kids = c.getFacetsAndChildren();
    while (kids.hasNext()) {
      UIComponent found = findComponent(kids.next(), id);
      if (found != null) {
        return found;
      }
    }
    return null;
  } 
```

# php - 将数据从服务器发送到客户端？

> ID：16088691
> 
> 赞同：11
> 
> 时间：2013-04-18T16:44:01.173
> 
> 标签：php, ajax, performance, session

我有一个 php 服务器文件和一个 HTML 客户端文件，HTML 文件向服务器发送 ajax 请求以检索每个数据`500 ms`，尽管这按预期工作，但会导致客户端设备上的内存和 CPU 使用率很高。

PHP

```
if(isset($_POST['id']) && $_POST['id'] != '' )
{
    $id     = $_POST['id'];
    $select = $con->prepare("SELECT * FROM data WHERE id=?");
    $select->bind_param('s', $id);
    $select->execute();
    $result = $select->get_result();
    while($row = $result->fetch_assoc())
    {
        echo $row['column 1'] . "\t" . $row['column 2'] . "\n";
    }
} 
```

AJAX

```
function send(){
    var formdata = new FormData(),
        id       = document.getElementById('id').value;
    formdata.append('id', id);
    var xhr = (window.XMLHttpRequest) ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
    xhr.open('post', 'server.php', true);
    xhr.send(formdata);
    xhr.onreadystatechange = function(){
        if(xhr.readyState == 4 && xhr.status == 200){
            console.log(xhr.responseText);
        }
    }
}
setInterval(function(){send()}, 500); 
```

我想找到一个 ajax 的替代解决方案，而不是大多数时候向服务器发送大量请求并检索相同的数据，如果服务器可以与客户端进行数据更改或更新交互，效率会更高。

我不能使用 PHP`Socket`或`HttpRequest`方法，因为它们没有安装在我的托管服务器上，我不确定后者是否有效。我能想到的唯一方法是使用`SESSIONS`.

根据[此](https://stackoverflow.com/questions/675913/looping-through-all-a-servers-sessions-in-php)PHP 服务器将所有用户会话存储在服务器上的同一目录中，因此可以直接在文件上更改特定用户的会话变量。然而问题是这些文件中的数据是序列化的，我不确定如何反序列化数据并重新序列化它们，然后保存新数据！

即使我能够找到一种在会话文件上存储更新的方法，我仍然需要使用 setInterval 来监听会话的变量更改，尽管它并不理想，但它比使用内存和 CPU 使用率`500ms`要好得多`XMLHttpRequest`.

那么最好的方法是什么？任何帮助将非常感激。

* * *

**更新：**

我意识到这`SESSION`不起作用，因为它只能由服务器而不是客户端读取，因此我必须向服务器发送 ajax 请求以获取我试图避免的变量。

我尝试了长轮询，但我遇到了很多问题，在我的服务器`flush`上`ob_flush()`不起作用，我无法更改`ini`设置。尝试无限循环时，我无法让它在数据更改时中断：

```
if(isset($_GET['size']) && $_GET['size'] != '')
{
    $size = (int)$_GET['size'];
    $txt = "logs/logs.txt";
    $newsize = (int)filesize($txt);    
    while(true) {
        if($newsize !== $size) {
            $data = array( "size" => filesize($txt), "content" => file_get_contents($txt));
            echo json_encode($data);
            break;
        }
        else{
            $newsize = (int)filesize($txt);
            usleep(400000);
        }
    }

} 
```

它一直在继续，即使`logs.txt`尺寸增加也不会破裂！我怎样才能让它打破并回显大小增加的数据？

**更新 2：**

结果是调用方法时php缓存了文件大小，`filesize()`因此上述循环将无限期运行，解决方案是使用`clearstatcache()`清除文件大小的存储缓存的方法，允许循环在文件大小更改时中断。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T18:38:10.880

好的，经过多次测试和长期研究，我得出的结论是 PHP 服务器永远不能直接与指定的客户端交互，除非客户端首先向服务器发送请求。

我发现唯一可靠的解决方案是使用只会在数据更改时中断的无限循环，这将大大降低对服务器的 ajax 请求频率，从而提高性能并减少客户端设备上内存和 CPU 的使用，这是怎么回事：

PHP 1（处理数据更新或新数据插入数据库）：

```
$process = $_POST['process'];
$log = "/logs/logs.txt";

if($process == 'update'){
    //execute mysqli update command and update table.
    $str = "Update on " . date('d/m/Y - H:i:s') . "\n";//add some text to the logs file (can be anything just to increase the logs.text size)
    file_put_content($log, $str, FILE_APPEND);//FILE_APPEND add string to the end of the file instead or replacing it's content
}
else if($process == 'insert'){
    //execute mysqli insert command and add new data to table.
    $str = "Added new data on" . date('d/m/Y - H:i:s') . "\n";
    file_put_content($log, $str, FILE_APPEND);
} 
```

上面的代码将插入/更新数据，`log.txt`如果文件不存在则创建文件，并在每个请求中添加额外的文本。`log.txt`稍后将在“下面”的无限循环中使用，当它的大小改变时会中断循环。

PHP 2（处理读取数据请求）：

```
if(isset($_POST['id']) && $_POST['id'] != '' && isset($_POST['size']) && $_POST['size'] != '')
{
    $id         = (string)$_POST['id'];
    $init_size  = (int)$_POST['count'];
    $size       = file_exists('logs/logs.txt') ? (int)filesize('logs/logs.txt') : 0;//$size is logs.txt size or 0 if logs.txt doesn't exist(not created yet).

    $select = $con->prepare("SELECT * FROM data WHERE id=?");
    $select->bind_param('s', $id);

    while(true){ //while(true) will loop indefinitely because condition true is always met
        if($init_size !== $size){
            $select->execute();
            $result = $select->get_result();
            while($row = $result->fetch_assoc())
            {
                $data['rows'][] = array(
                                  "column 1" => $row['column 1'],
                                  "column 2" => $row['column 2'],
                                  );

            }
            $data['size'] = $size;
            echo json_encode($data);
            break; //break the loop when condition ($init_size != $size) is met which indicates that database has been updated or new data has been added to it.
        }
        else{
            clearstatcache(); //clears the chached filesize of log.txt
            $size = file_exists('logs/logs.txt') ? (int)filesize('logs/logs.txt') : 0;
            usleep(100000) //sleep for 100 ms
        }
    }
} 
```

阿贾克斯：

```
var size = 0; //declares global variable size and set it's initial value to 0

function send(s){
    var formdata = new FormData(),
        id       = document.getElementById('id').value;
    formdata.append('id', id);
    formdata.append('size', s);
    var xhr = (window.XMLHttpRequest) ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');
    xhr.open('post', 'server.php', true);
    xhr.timeout = 25000; //set timeout on xmlhttprequest to 25 sec, some servers has short execution tiemout, in my case it's 27 sec so i set the value to 25 sec.
    xhr.send(formdata);
    xhr.onreadystatechange = function(){
        if(xhr.readyState == 4 && xhr.status == 200){
            var data = JSON.parse(xhr.responseText);
            size = data.size;
            console.log(data.rows);
            setTimeout(function(){send(size)}, 100); //re-initiate the request after receiving data 
        }
    }
    xhr.ontimeout = function(){
        xhr.abort(); //abort the timed out xmlhttp request
        setTimeout(function(){send(size)}, 100);
}
send(size); 
```

这不是理想的解决方案，但它将我的 xmlhttp 请求从 2/sec 减少到低至 1/25 sec，希望有人能够提出更好的解决方案。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T18:59:08.803

在我们能够在浏览器中使用套接字之前，我们使用了长轮询。基本思想是浏览器不会定期发出请求，而是浏览器会向服务器发出请求，但服务器不会响应，直到有值得分享的内容返回给浏览器。这意味着请求可以保持打开状态 10 毫秒或几个小时。

在服务器响应某些内容后，浏览器的工作就是发出新的 ajax 请求。这样，总是有一条线路向服务器开放。

有关更多信息，请参阅[此问题](https://stackoverflow.com/questions/333664/simple-long-polling-example-code)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:55:16.683

*回答您关于直接编辑会话的部分问题...*

要直接操作用户的会话，我假设您知道并可以跟踪任何用户的会话 ID（可能在登录时在您的数据库中）。

当您需要直接在服务器上编辑用户的会话时：

1.  从数据库中检索用户的最后一个已知会话。
2.  调用`session_close()`以关闭当前会话（如果有）。
3.  使用会话 ID 调用 `session_name($sessionId)'。
4.  调用`session_open()`以打开该会话。`$_SESSION`应填充会话数据。您不需要反序列化任何内容。
5.  对会话进行编辑。
6.  调用`session_close()`以重新序列化数据。

或者，您*可以*直接打开会话文件`unserialize()`，编辑数据，然后重新`serialize()`手动操作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T17:00:15.890

您可以向 php 脚本创建一个 ajax 请求，该脚本仅在有任何新数据时才返回数据。只要没有新数据，脚本就会一直循环运行，直到有。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-11-16T09:43:38.403

我认为今天这个问题的答案是使用**Websocket**阅读它。无需请求服务器，您可以获取数据，如果有东西将其更改为服务器

见[链接](https://www.websocket.org/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-05-21T14:33:41.787

您可以使用[SSE](https://www.w3schools.com/html/html5_serversentevents.asp)或[Websocket](https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API)来实现这一点。

# mysql - 在 MySQL 中将字符转换为 UTF8（Ã© 到 é）

> ID：16088694
> 
> 赞同：4
> 
> 时间：2013-04-18T16:44:19.247
> 
> 标签：mysql, utf-8, character, diacritics, latin

我有一个 MySQL 问题。除了我的数据库之外，我的整个网站都是 UTF8 格式的。我最近刚刚尝试使用各种命令将其转换为 UTF8，但主要问题仍然存在：

口音不起作用。而不是é，我有é。è 也一样，还有另一种奇怪的字符。

是否有一个简单的转换所有这些字符的方法，比如说 é，到 é，在基地？

多谢。

（顺便说一下，数据库在latin1）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:52:12.723

在这种情况下，`Ã©`被`é`解释为 LATIN1 并转换为 UTF-8。可能是您的数据库试图提供帮助并转换为不需要转换的 UTF-8。

您是否尝试过切换数据库表上的字符集？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-10-01T08:47:09.513

你可以试试这个功能：

```
CREATE TABLE `utf8decodemap` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `encoded` VARCHAR(128) NOT NULL,
  `decoded` VARCHAR(128) NOT NULL,
  UNIQUE KEY urlcodemapUIdx1(encoded),
  PRIMARY KEY (`id`)  
);

INSERT INTO utf8decodemap (decoded,encoded) VALUES ("â","Ã¢");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("é","Ã©");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("è","Ã¨");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ê","Ãª");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ë","Ã«");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("î","Ã®");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ï","Ã¯");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ô","Ã´");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ö","Ã¶");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ù","Ã¹");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("û","Ã»");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ü","Ã¼");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("ç","Ã§");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("œ","Å?");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("€&quot;,"â¬");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("°","Â°");
INSERT INTO utf8decodemap (decoded,encoded) VALUES ("à","Ã");

DELIMITER $$
CREATE FUNCTION `utf8decoder`(str VARCHAR(4096)) RETURNS VARCHAR(4096) DETERMINISTIC
BEGIN
               DECLARE X  INT;               
               DECLARE chr VARCHAR(256);
               DECLARE chrto VARCHAR(256);
               DECLARE result VARCHAR(4096);
               SET X = 1;
               WHILE X  <= (SELECT MAX(id) FROM utf8decodemap) DO
                   SET chr = (SELECT `encoded` FROM utf8decodemap WHERE id = X);
                   SET chrto = (SELECT `decoded` FROM utf8decodemap WHERE id = X);                
                           SET str = REPLACE(str,chr,chrto);
                           SET  X = X + 1;                           
               END WHILE;
               RETURN str;
       END$$

DELIMITER ; 
```

例如：从 MYtable 中选择 utf8decoder(MyCol)

# ios - 来自 char* 的 CFStringRef 不提供编码类型

> ID：16088696
> 
> 赞同：0
> 
> 时间：2013-04-18T16:44:22.217
> 
> 标签：ios, utf-8, utf-16, cfstring, nsstringencoding

我有一个 C 字符串：

```
unsigned char* contents = readInFile(path); //sting bytes in some unknown NSStringEncoding encoding. 
```

我想知道`NSStringEncoding`内容的当前值。我想在不使用`NSString usedEncoding`方法的情况下做到这一点。

我需要一个`CFStringRef`来自内容而不引入新的字符串编码。

```
NSString* contentsString = [NSString stringWithCString:(char *)contents]; 
```

引入了默认编码，所以搞砸了。如何`CFStringRef`直接从内容创建？

一旦我有了这个，我可以：

```
CFStringEncoding cfStringEncoding = CFStringGetFastestEncoding((CFStringRef)contentsString);
NSStringEncoding encoding = CFStringConvertEncodingToNSStringEncoding(cfStringEncoding); 
```

# c# - ASP 页面命名和重定向

> ID：16088704
> 
> 赞同：0
> 
> 时间：2013-04-18T16:44:42.003
> 
> 标签：c#, asp.net, response.redirect

我有一个非常奇怪的场景，我以前没有遇到过。

我只有一个超链接，网址硬编码为 www.mywebsite.com/StoreLoc.aspx

我的应用程序有两个我们关心的页面。

1.  存储.aspx
2.  StoreLoc.aspx

即使超链接被硬编码为转到 StoreLoc.aspx，**有时**（一旦超出范围）超链接将直接指向 Store.aspx。

我不是第一个使用此应用程序的人，因此很可能已经重命名了 aspx 文件。这会导致这个问题吗？

谢谢大家的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:09:08.830

您可能在 Global.asax 文件的 OnSesssionStart 函数中有一些东西，它执行 Response.Redirect 到 Store.aspx。

在 x 分钟不活动后，您的会话可能会被终止。这将导致会话重新开始，然后被重定向到起始页面。

您可能希望在 Visual Studio 解决方案中搜索 Respose.redirect 或 Server.Transfer。

希望这可以帮助。

# javascript - Javascript 范围——var vs global

> ID：16088712
> 
> 赞同：1
> 
> 时间：2013-04-18T16:45:13.787
> 
> 标签：javascript, scope

对于`currentUnknownBox`，如果我使用“var”，则预期的功能不会按预期工作（currentUnknownBox 成为单击的第一个元素）。如果我删除 var，它会按预期工作。我假设这与全局范围有关。有人可以向我解释一下吗？

```
jQuery(".box.unknown").live('click',function()
{
    var currentUnknownBox = this;

    //if we are NOT on mobile, use jQuery UI dialog
    if (!Drupal.settings.is_mobile)
    {
        jQuery("#letter-input-dialog").dialog();

        jQuery('#letter_input_form').submit(function()
        {
            var letter = jQuery("#letter_input").val();
            jQuery("#letter-input-dialog").dialog('close');
            jQuery("#letter_input").val('');
            that.validateAndSaveLetter(currentUnknownBox, letter);
            //Do not let the form actually submit
            return false;
        });
    }
    else
    {
        var letter = prompt('Please enter a letter to use in your guess');
        that.validateAndSaveLetter(that.currentUnknownBox, letter);
    }
}); 
```

编辑：问题是我每次都重新声明我的提交功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:55:46.450

问题是每次单击其中一个时，您都会向表单添加一个*新*的提交事件处理程序。但第一个总是先开火。当您不声明 var 时，您将覆盖第一个处理程序正在查看的变量。但错误是每次都添加一个新的处理程序。我会这样做：

```
var currentUnknownBox;
jQuery('#letter_input_form').submit(function()
    {
        var letter = jQuery("#letter_input").val();
        jQuery("#letter-input-dialog").dialog('close');
        jQuery("#letter_input").val('');
        that.validateAndSaveLetter(currentUnknownBox, letter);
        //Do not let the form actually submit
        return false;
    });
jQuery("#letter-input-dialog").dialog({autoOpen: false});

jQuery(".box.unknown").live('click',function(){
    currentUnknownBox = this;

    //if we are NOT on mobile, use jQuery UI dialog
    if (!Drupal.settings.is_mobile)
     {
       jQuery("#letter-input-dialog").dialog('open');
      } else {
        var letter = prompt('Please enter a letter to use in your guess');
       that.validateAndSaveLetter(currentUnknownBox, letter);
      }   
}); 
```

顺便说一句，`.live`已弃用。你应该[`.on`](http://api.jquery.com/on/)改用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:54:03.590

每当您使用`var`时，您都在声明变量的范围。如果你省略它，那么 JavaScript 会假定最兼容的选项是全局的。技术术语是“[吊装](http://www.adequatelygood.com/JavaScript-Scoping-and-Hoisting.html)”。更准确地说，JavaScript 具有所谓的函数作用域，因此即使您在 for 循环中声明变量，JavaScript 也会将其“提升”到最近的函数的顶部。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:48:51.350

您忘记声明 var 'that'。我认为您需要在“if”语句之前执行此操作

```
var that = this; 
```

# javascript - 在 jQuery 中动画长序列

> ID：16088713
> 
> 赞同：0
> 
> 时间：2013-04-18T16:45:16.883
> 
> 标签：javascript, jquery, animation

我必须用 jQuery 制作一个长动画，充满淡出、淡入、幻灯片、...

我遇到的问题是我的代码看起来很难看，而且充满了回调。
另外，如果我想停止动画一段时间，例如：`slideOut->wait 5 seconds->slideIn`我必须使用延迟，我不确定这是否是最佳做法。

**示例**：

```
/* Slides */
var slide1 = $('div#slide1'),
    slide2 = $('div#slide2'),
    slide3 = $('div#slide3');

$(document).ready(function(){
    slide1.fadeIn(function(){
        slide2.fadeIn(function(){
            slide3.fadeIn().delay(3000).fadeOut(function(){
                slide2.fadeOut(function(){
                    slide1.fadeOut();
                });
            });
        });
    });
}); 
```

**JSFIddle：http:** [//jsfiddle.net/ZPvrD/6/](http://jsfiddle.net/ZPvrD/6/)

**问题**：有没有其他方法可以在 jQuery 中构建动画，甚至可能有一些很棒的插件来帮助我解决这个问题？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T20:03:15.863

这是您正在寻找的插件:) 做同样的事情，但比您现有的代码更灵活[http://jsfiddle.net/ZPvrD/11/](http://jsfiddle.net/ZPvrD/11/)

```
(function($){
    $.fn.fadeInOut = function(middleDelay) {
        middleDelay = middleDelay || 0; 
        var index = 0,
            direction = 1, // 1: fading in; -1: fading out        
            me = this,
            size = me.size();
        function nextAnimation() {
            // Before the first element, we're done
            if (index === -1 )  { return; }

            var currentEl = $(me.get(index)),
                goingForward = direction === 1,
                isLastElement = index === (size - 1);

            // Change direction for the next animation, don't update index
            // since next frame will fade the same element out
            if (isLastElement && goingForward) {
                direction = -1;
            } else {
                index += direction;
            }

            // At the last element, before starting to fade out, add a delay 
            if ( isLastElement && !goingForward) {
                currentEl.delay(middleDelay);
            }
            if (goingForward) {
                currentEl.fadeIn(nextAnimation);
            } else {
                currentEl.fadeOut(nextAnimation);                    
            }
        }
        nextAnimation();
        return this;
    }        
})(jQuery); 
```

你称之为

```
$('div.slideWrapper>div.slide').fadeInOut(3000); 
```

这个上下遍历 jQuery 元素列表以等待每个动画完成的过程可以被抽象化，以便它可以用于除`fadeIn`和之外的其他事情`fadeOut`。如果你喜欢冒险，我会把它留给你试试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:48:44.270

尝试这个：

```
 /* Slides */
 var slide = $('div[id*="slide"]');

 $( function(){

      slide.each( function( k ){

            $( this ).delay( 500 * k ).fadeIn();
      });
  }); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-18T16:53:15.913

JQuery 动画有两个参数（最大值），持续时间和完成，持续时间是您希望动画完成多长时间的时间（以毫秒为单位），或者您可以使用“慢”或“快”，第二个参数完成是回调功能。

如果不想使用延迟，可以让之前的动画变慢。

例如

```
slide1.fadeIn(5000, function(){
    slide2.fadeIn();
}; 
```

# c# - 声明一个文本框数组

> ID：16088727
> 
> 赞同：1
> 
> 时间：2013-04-18T16:45:58.023
> 
> 标签：c#, arrays, visual-studio-2010, textbox, instantiation

我正在尝试将数组 Scores 声明为文本框数组。它没有尺寸。我还需要将其声明为实例变量，并在 CreateTextBoxes 方法中对其进行实例化。我不断收到错误消息，“分数是一个字段，但用作类型。”

```
namespace AverageCalculator
{
    public partial class AverageCalculator : Form
    {

    private TextBox[] Scores;

    public AverageCalculator()
    {
        InitializeComponent();
    }

    private void AverageCalculator_Load(object sender, EventArgs e)
    {
        btnCalculate.Visible = false;
    }

    private void btnOK_Click(object sender, EventArgs e)
    {
        int intNumTextBoxes;

        intNumTextBoxes = Convert.ToInt32(txtNumScores.Text);

        this.Height = 500;
        btnCalculate.Visible = true;
        btnOK.Enabled = false;

    }

    private void CreateTextBoxes(int number)
    {
        Scores[number] = new Scores[number];

        int intTop = 150;

        for (int i = 0; i < 150; i++)
        {

        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:48:24.790

您需要实例化 TextBox 但*数字应该是常量您可以***[在此处](http://msdn.microsoft.com/en-us/library/aa691346%28v=vs.71%29.aspx)**阅读有关数组创建表达式的更多信息。如果您想要可变大小，最好使用[List而不是数组。](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)

```
Scores = new TextBox[number]; 
```

使用列表

```
List<TextBox> Scores= new List<TextBox>(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-18T16:49:33.790

你`CreateTextBoxes`可能应该是这样的：

```
private void CreateTextBoxes(int number)
{
    Scores = new TextBox[number];

    for (int i = 0; i < number; i++)
    {
        Scores[i] = new TextBox();
    }
} 
```

正如 Adil 所建议的，`List<TextBox>`在这种情况下， a 可能更好。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:51:44.877

问题出在

```
private void CreateTextBoxes(int number)
    {
        Scores[number] = new Scores[number];

        int intTop = 150;

        for (int i = 0; i < 150; i++)
        {

        }
    } 
```

当您尝试初始化数组时，您正在使用字段名称，因为它们键入并包含字段名称的索引。只需将新类型更改为 TextBox 并删除索引访问器，如下所示：

```
private void CreateTextBoxes(int number)
    {
        Scores = new TextBox[number];

        int intTop = 150;

        for (int i = 0; i < 150; i++)
        {

        }
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T16:48:17.067

您的代码应为：

```
Scores = new TextBox[number];
// do things with this array 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T16:52:01.237

你不能这样做。

```
Scores[number] = new Scores[number]; 
```

使用`TextBox`.

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T16:48:02.270

将第 1 行替换为第 2 行

```
 Scores[number] = new Scores[number];
 Scores[number] = new TextBox(); 
```

# internet-explorer-9 - script16386 no such interface supported 在 IE9 浏览器中出现错误

> ID：16088728
> 
> 赞同：2
> 
> 时间：2013-04-18T16:46:01.950
> 
> 标签：internet-explorer-9

到目前为止，我们的应用程序都使用 IE8。最近得到了IE9浏览器需要升级。这些功能在 IE9 中无法正常工作。当我选择一个单选按钮时，应该启用一个按钮。但它不会发生在 IE9 浏览器中。我还观察到当我单击单选按钮时出现 java 脚本错误“script16386 不支持此类接口”。希望这个 java 脚本错误是导致问题的原因。我的应用程序是一个 JSF 应用程序。该应用程序将从 IFrame 标记内调用。我搜索了所有可能的解决方案，但没有任何进展。将 Richfaces-impl、richfaces-ui、richfaces-api jar 从 3.3.2.SR1 替换为 3.3.3 版本。没用。还按照链接中的以下步骤操作：http: [//vsomani.blogspot.com/2011/12/a4j-and-ie-9-issues-with.html](http://vsomani.blogspot.com/2011/12/a4j-and-ie-9-issues-with.html)- 没有工作:(该项目是一个ANT项目。任何人都可以帮助解决这个问题。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-06T22:36:01.873

正如 vsomani 所说，这是一个**IE9 错误**。只需将此行添加到页面的标题：

```
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE8"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T08:19:47.820

我遇到了同样的问题。对我来说，错误发生在 AJAX.js 的第 1402 行，其中调用了 window.document.importNode。

IE9 对 importNode 的支持似乎不完整，并且对于某些 DOM 文档会引发错误。

我进一步修补了 AJAX.js，并在第 495 行替换了：

```
if((typeof(document.importNode) == "undefined") && Sarissa._SARISSA_IS_IE){ 
```

经过

```
if((typeof(document.importNode) == "undefined") && Sarissa._SARISSA_IS_IE || Sarissa._SARISSA_IS_IE9 ){ 
```

它似乎为我解决了这个问题。此更改也为 IE9 手动定义了 Sarissa importNode。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-06T18:01:07.260

我没有提供修复程序，而是您可以尝试的解决方法。

使用 IE 8 的回退机制，添加以下元标记。

元 http-equiv="X-UA-Compatible" 内容="IE=8"

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-09T12:54:36.833

我遇到了同样的问题，可以追溯到这个 Javascript 源代码行，它在 Firefox 和 Chrome 上运行得很好：

```
var xmlDoc = document.implementation.createDocument(null, "File"); 
```

根据[Mozilla 文档](https://developer.mozilla.org/en-US/docs/Web/API/DOMImplementation/createDocument)，这个调用有一个*可选*的第三个参数。但是，IE 开发工具控制台说缺少一个不是可选的参数。

这两个实验试图有意义地填充第三个参数，但没有奏效：

```
var xmlDoc = document.implementation.createDocument(null, "File", "text/xml");
var xmlDoc = document.implementation.createDocument(null, "File", ""); 
```

有关这些尝试修复的 IE 开发工具控制台错误消息是：**script16386 no such interface**。

解决方法是将第三个参数显式填充为 null：

```
var xmlDoc = document.implementation.createDocument(null, "File", null); 
```

不过，不知道与错误消息的文本有什么关系。谷歌搜索脚本编号未显示来自 microsoft.com 的信息。

顺便说一句，我的应用程序是控制一流的 60.000 欧元的实验室设备，我真的很摸不着头脑，为什么我们应该坚持使用标准 windows 内置 IE 浏览器，而不是选择性能同样一流的浏览器，如 Chrome 或 Explorer . 我不应该把所有这些时间都花在修复 IE 问题上。

# php - 在 Outlook 和 Android Gmail 中未显示图像的 PHP 电子邮件

> ID：16088731
> 
> 赞同：0
> 
> 时间：2013-04-18T16:46:13.803
> 
> 标签：php, email

我正在发送一封带有 php 的电子邮件。正如我被建议做的那样，我有 3 张图像作为表格背景。问题是我在 Outlook 和 Adroid Gmail 应用程序中查看电子邮件图像时看不到它。

这是使用的代码：

```
$headers = "From:  Furniture \r\n";
$headers .= "Reply-To: info@furniture.com \r\n";
$headers .= "MIME-Version: 1.0\r\n";
$headers .= "Content-Type: text/html; charset=ISO-8859-1\r\n";

$message = '<html><body style="margin: 0;">';
$message .= '<table background="http://mysite.com/emailfinal1.jpg" border="0" width="650" height="506" style="font-family: arial, tahoma;color: black; margin: 0;">
<tr height="308" width="650"><td width="450"></td><td></td></tr>
<tr height="16" width="650" style="font-size:12px;"><td width="450">&nbsp;</td><td align="left" valign="bottom">'. $first_name . ' ' . $last_name . '</td></tr>
<tr height="16" width="650" style="font-size:12px;"><td width="450">&nbsp;</td><td align="left" valign="bottom">'. $email . '</td></tr>
<tr height="16" width="650" style="font-size:12px;"><td width="450">&nbsp;</td><td align="left" valign="bottom">'. $nextdate . '</td></tr>
<tr height="134" width="650"><td width="450"></td><td></td></tr>
</table>
<table background="http://mysite.com/emailfinal2.jpg" border="0" width="650" height="133" style="font-family: arial, tahoma;color: #29468a; margin: 0;">
<tr height="10" width="650"><td width="175"></td><td></td></tr>
<tr height="123" width="650" style="font-size:13px;"><td width="175">&nbsp;</td><td align="left" valign="baseline"><a href="http://www.mysite.com/unsubscribe.php" target="_blank" style="text-decoration: none;color: #29468a;">UNSUBSCRIBE</a> | <a href="http://www.mysite.com/Terms-And-Conditions.aspx" target="_blank" style="text-decoration: none;color: #29468a;">TERMS & CONDITIONS</a></td></tr>
</table>
<table background="http://mysite.com/emailfinal3.jpg" border="0" width="650" height="60" style="font-family: arial, tahoma;color: #29468a; margin: 0;">
<tr height="20" width="650"><td width="526"></td><td></td></tr>
<tr height="40" width="650" style="font-size:11px;"><td width="526">&nbsp;</td><td align="left" valign="baseline"><a href="http://www.mysite.com/Contact-Us.aspx" target="_blank" style="text-decoration: none;color: #29468a;">Contact Us</a></td></tr>
</table>';
$message .= "</body></html>"; 
```

有什么建议吗？我走错方向了吗？我想让电子邮件默认显示图像。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-11T13:07:18.713

许多邮件客户端默认不显示像您这样的电子邮件中外部链接的图像。这样做是出于安全原因（因此，如果我打开垃圾邮件，它不会自动向垃圾邮件发送者的站点发出 http 请求以获取图像，因为这将允许垃圾邮件发送者跟踪我）。

大多数邮件客户端确实为用户提供了稍后加载邮件的选项，但这并不总是理想的（而且很多用户不打扰——我通常不这样做）。

解决方案是将图像嵌入电子邮件本身，因此它们是消息的一部分。大多数阻止外部图像的邮件客户端都会愉快地显示嵌入的图像。这是使用专门构建的多部分消息完成的，但我不建议您尝试自己构建它。

如果您还没有这样做（看起来不像），那么我建议使用像 phpMailer 或 Swiftmailer 这样的像样的邮件程序类，而不是原始的 PHP`mail()`函数。您将获得更多功能，包括将图像嵌入邮件的功能。这应该可以帮助您解决问题。（作为奖励，它也可能使您的代码更清晰，更易于使用）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:52:21.237

开发电子邮件以在多个电子邮件客户端之间实现兼容性是很困难的，因为它们每个都有自己对 HTML 和 CSS 的支持。在开发电子邮件时，您可能需要强烈考虑使用电子邮件预览工具。您可能只是阻止了您的图像（这是当今许多电子邮件客户端的默认设置）。基本上我的建议是不要依赖图像来进行布局或电子邮件的可读性。

这是一篇包含几个电子邮件预览工具链接的文章：

[http://www.smartinsights.com/email-marketing/email-creative-and-copywriting/email-preview-tools/](http://www.smartinsights.com/email-marketing/email-creative-and-copywriting/email-preview-tools/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T17:04:39.050

通常，出于安全/隐私原因，电子邮件客户端会阻止对外部图像的访问。确保您已将发件人的电子邮件地址添加到白名单中。

如果是您的情况，您将无能为力，因为这是客户方面的问题。更好的方法是使用如下文本提供指向您网站的超链接：

> 如果您无法查看下面的图片，请单击此处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-11T12:59:25.830

首先你必须在你的应用程序中安装 phpmailer 库，然后在你的图像标签 src 中添加 cid:image1,cid:image2,cid:image3。然后调用如下所示的邮件发送功能，它将在所有浏览器中显示图像，而不会出现垃圾邮件问题。

```
 $mail             = new PHPMailer();
        $body             = $body;
        $body             = eregi_replace("[\]",'',$body);
        $mail->Host       = "";      // sets GMAIL as the SMTP server
        $mail->Port       = 25;                   // set the SMTP port for the GMAIL server
        $mail->Username   = "";  // GMAIL username
        $mail->Password   = '';            // GMAIL password
        $mail->SetFrom($fr_email, ');
        $mail->AddReplyTo("");
        $mail->Subject    = $sub;
        $mail->AltBody    = "To view the message, please use an HTML compatible email viewer!"; // optional, comment out and test

        $mail->MsgHTML($body);
        $address = $to;
        $mail->AddAddress($address, "");
        $mail->AddAddress('rikinadhyapak@gmail.com', "");      
        $notificationpos1 = strpos(strtolower($sub), 'notification');
        $notificationpos2 = strpos(strtolower($sub), 'lead');      
        if($notificationpos1 === false && $notificationpos2 === false){
            //Attach an image file
            $mail->AddEmbeddedImage('images/image1.jpg','image1');
            $mail->AddEmbeddedImage('images/image1.jpg','image2');      
            $mail->AddEmbeddedImage('images/image2.jpg','image3');      
           // attach file logo.jpg, and later link to it using identfier logoimg
        }
            if(!$mail->Send()) {
              echo "Mailer Error: " . $mail->ErrorInfo;
            } else {
              echo "Message sent!";
            } 
```

# xml - 使用此模式的有效示例 xml 是什么

> ID：16088735
> 
> 赞同：1
> 
> 时间：2013-04-18T16:46:23.200
> 
> 标签：xml, xsd, schema

我从供应商那里收到了这个模式，并试图弄清楚它里面有什么。

```
<schema targetNamespace="http://abc.com:9080/product/services/12WebService/types/" xmlns="http://www.w3.org/2001/XMLSchema">
    <import namespace="http://schemas.xmlsoap.org/soap/encoding/"/>
    <element name="Message">
        <complexType>
            <sequence>
                <any minOccurs="0"/>
            </sequence>
        </complexType>
    </element>
</schema> 
```

我可以`<types:Message>`在下面的示例中合法地将什么放入元素中。

```
<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:types="http://abc.com:9080/product/services/12WebService/types/">
   <soapenv:Header/>
   <soapenv:Body>
      <types:Message>
           <!-- What can go here -->
      </types:Message>
   </soapenv:Body>
</soapenv:Envelope> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:25:08.197

您可以在`message`其中放置一个任意元素 - 即在任何命名空间中具有任何名称的元素：

```
<Message xmlns="http://abc.com:9080/product/services/12WebService/types/">
  <something xmlns="some namespace" . . more attributes here . . .>
     . . . more sub-elements here . . 
  </something>
</Message> 
```

空`message`也是有效的（由于`minOccurs="0"`）：

```
<Message xmlns="http://abc.com:9080/product/services/12WebService/types/">
</Message> 
```

您不能放入`message`多个元素 - 这是无效的：

```
<Message xmlns="http://abc.com:9080/product/services/12WebService/types/">
  <something1 xmlns="some namespace">
  </something1>
  <something2 xmlns="some namespace">
  </something2>
</Message> 
```

请注意，由于未指定`processContents`属性`any`，它默认为`strict`- 这意味着如果没有架构，则验证**失败**`some namespace`- 或者如果`something`元素与该架构不匹配。

`any` [请参阅此处](http://msdn.microsoft.com/en-us/library/ms256043.aspx)的文档。

# authentication - 如何使用 AWS Identity and Access Management 进行身份验证和授权？

> ID：16088736
> 
> 赞同：0
> 
> 时间：2013-04-18T16:46:31.257
> 
> 标签：authentication, amazon-web-services, authorization, amazon-iam

我正在用 Java 编写自己的报告软件，并计划使用 RDS 进行数据存储。我想用 AWS IAM 做 AA。是否有任何您可能知道并与我分享的使用 AWS Identity and Access Management 进行身份验证和授权的示例？

我不是在研究如何从亚马逊的控制台设置用户或如何发出控制台命令。相反，我希望看到一些 Java 代码如何识别用户是否使用他/她的凭据（用户 ID、密码组合）进行了身份验证，以及该人是否有权访问特定报告。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-12T22:12:48.030

AWS IAM 并非旨在使用您自己的应用程序对用户进行身份验证。AWS IAM 旨在使用*AWS 服务*对用户进行身份验证。

查看用户是否是真实用户（身份验证）以及该用户是否被授权的唯一方法是实际进行 AWS API 调用。

例如，您可以创建如下所示的策略并将其附加到用户/组：

```
{
   "Statement":[{
      "Effect":"Allow",
      "Action":["rds:CreateDBSecurityGroup",
                "rds:DeleteDBSecurityGroup",
                "rds:DescribeDBSecurityGroup",
                "rds:AuthorizeDBSecurityGroupIngress",
                "rds:RevokeDBSecurityGroupIngress"],
      "Resource":"*"
      }
   ]
} 
```

拥有此策略的用户或组只能进行这些 API 调用，而不能进行其他 API 调用。

请参阅此处：[http ://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAM.html](http://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/UsingWithRDS.IAM.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-29T16:33:34.687

亚马逊有一个叫做 Cognito 的东西，它旨在跨移动设备同步应用程序配置文件。不过，适用于您的问题的是，它还允许用户通过 Google、Facebook 或 Amazon 进行身份验证（它使用 OAuth）。

[http://aws.amazon.com/cognito/](http://aws.amazon.com/cognito/)

# jquery - 通过重叠项目管理点击事件

> ID：16088738
> 
> 赞同：0
> 
> 时间：2013-04-18T16:46:41.923
> 
> 标签：jquery, events, slideshow, overlapping

我在幻灯片组件中遇到了 javascript 重叠问题。我想添加一个图标来删除幻灯片中的一张图片，这个图标在每张图片的右上角。

问题是：图标（和他的点击事件）在一个大的空白 div 下（在屏幕截图上为蓝色）。此 div 用于转到下一张图片。

是否有解决方案来触发图标事件并阻止幻灯片事件？

![](https://i.stack.imgur.com/XVoPP.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T08:10:08.910

Here is the clean code

```
<html>
<head>
    <style>
        #slideshowController1
        {
            position: absolute;
            left: 50%;
            top: 0;
            width: 50%;
            height: 100%;
            z-index: 98;
            border: 1px solid blue;
        }

        #slideshowController2
        {
            position: absolute;
            left: 0;
            top: 0;
            width: 50%;
            height: 100%;
            z-index: 98;
            border: 1px solid green;
        }

        #pic1
        {
            height: 400px;
            width: 400px;
            border: 1px solid red;
        }

        #delete1
        {
            float: right;
            width: 24px;
            height: 24px;
            margin-top: 0px;
            background-color: black;
        }

        .swipe
        {
            overflow: hidden;
            visibility: hidden;
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            text-align: center;
        }

        .swipe-wrap
        {
            overflow: hidden;
            position: relative;
        }

        #slideShow
        {
            position: relative;
            overflow: hidden;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <div id="slideShow">

        <div id="slideshowController1" class="slideshowController" onclick="alert('right');">
        </div>
        <div id="slideshowController2" class="slideshowController" onclick="alert('left');">
        </div>
        <div id="mySwipe" class="swipe" style="visibility: visible;">
            <div class="swipe-wrap" id="swipe-gallery" style="width: 2500px;">
                <div id="pic1">
                    <div id="delete1" class="thumbDelete" style="z-index: 100;" onclick="alert('delete');">
                        <img src="../../img/delete.png" width="100%">
                    </div>
                </div>
            </div>
        </div>

    </div>

    </div>
</body>
</html> 
```

if I put z-index:100 on mySwipe, it's work but only out side of the picture... its a partial solution !

But this is not the desired operation, only the icon must be over...

Any ideas ?

# concurrency - Go 并发切片访问

> ID：16088740
> 
> 赞同：3
> 
> 时间：2013-04-18T16:46:51.920
> 
> 标签：concurrency, go

我正在 Go 中进行一些流处理，并试图弄清楚如何在没有锁的情况下以“Go 方式”执行此操作。

这个人为的例子显示了我面临的问题。

*   我们一次得到一个`thing`。
*   有一个 goroutine 将它们缓冲到一个名为`things`.
*   当`things`变满时`len(things) == 100`，它会以某种方式处理并重置
*   有`n`许多并发 goroutines 需要`things`在它满之前访问
*   从其他 goroutine访问“不完整”`things`是不可预测的。
*   既不需要`doSomethingWithPartial`也不`doSomethingWithComplete`需要变异`things`

代码：

```
var m sync.Mutex
var count int64
things := make([]int64, 0, 100)

// slices of data are constantly being generated and used
go func() {
  for {
    m.Lock()
    if len(things) == 100 {
      // doSomethingWithComplete does not modify things
      doSomethingWithComplete(things)
      things = make([]int64, 0, 100)
    }
    things = append(things, count)
    m.Unlock()
    count++
  }
}()

// doSomethingWithPartial needs to access the things before they're ready
for {
  m.Lock()
  // doSomethingWithPartial does not modify things
  doSomethingWithPartial(things)
  m.Unlock()
} 
```

1.  ~~我知道切片是不可变的，这是否意味着我可以删除互斥锁并期望它仍然有效（我假设没有）~~。

2.  我如何重构它以使用通道而不是互斥锁。

**编辑：**这是我想出的不使用互斥锁的解决方案

```
package main

import (
    "fmt"
    "sync"
    "time"
)

func Incrementor() chan int {
    ch := make(chan int)
    go func() {
        count := 0
        for {
            ch <- count
            count++
        }
    }()
    return ch
}

type Foo struct {
    things   []int
    requests chan chan []int
    stream   chan int
    C        chan []int
}

func NewFoo() *Foo {
    foo := &Foo{
        things:   make([]int, 0, 100),
        requests: make(chan chan []int),
        stream:   Incrementor(),
        C:        make(chan []int),
    }
    go foo.Launch()
    return foo
}

func (f *Foo) Launch() {
    for {
        select {
        case ch := <-f.requests:
            ch <- f.things
        case thing := <-f.stream:
            if len(f.things) == 100 {
                f.C <- f.things
                f.things = make([]int, 0, 100)
            }
            f.things = append(f.things, thing)
        }
    }
}

func (f *Foo) Things() []int {
    ch := make(chan []int)
    f.requests <- ch
    return <-ch
}

func main() {

    foo := NewFoo()

    var wg sync.WaitGroup
    wg.Add(10)

    for i := 0; i < 10; i++ {
        go func(i int) {
            time.Sleep(time.Millisecond * time.Duration(i) * 100)
            things := foo.Things()
            fmt.Println("got things:", len(things))
            wg.Done()
        }(i)
    }

    go func() {
        for _ = range foo.C {
            // do something with things
        }
    }()

    wg.Wait()
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-19T02:51:01.337

应该注意的是，“Go way”可能只是为此使用互斥锁。弄清楚如何使用通道来做这件事很有趣，但是对于这个特定问题，互斥锁可能更简单、更容易推理。

# pandas - Pandas：向多索引列数据框添加一列

> ID：16088741
> 
> 赞同：91
> 
> 时间：2013-04-18T16:46:56.630
> 
> 标签：pandas, multi-index

我想将一列添加到多索引列数据框的第二级。

```
In [151]: df
Out[151]: 
first        bar                 baz           
second       one       two       one       two 
A       0.487880 -0.487661 -1.030176  0.100813 
B       0.267913  1.918923  0.132791  0.178503
C       1.550526 -0.312235 -1.177689 -0.081596 
```

直接赋值的常用技巧不起作用：

```
In [152]: df['bar']['three'] = [0, 1, 2]

In [153]: df
Out[153]: 
first        bar                 baz           
second       one       two       one       two 
A       0.487880 -0.487661 -1.030176  0.100813
B       0.267913  1.918923  0.132791  0.178503
C       1.550526 -0.312235 -1.177689 -0.081596 
```

如何将第三行添加到“栏”下？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2013-04-18T17:11:37.177

它实际上很简单（FWIW，我最初想按照你的方式去做）：

```
df['bar', 'three'] = [0, 1, 2]
df = df.sort_index(axis=1)
print(df)

        bar                        baz          
        one       two  three       one       two
A -0.212901  0.503615      0 -1.660945  0.446778
B -0.803926 -0.417570      1 -0.336827  0.989343
C  3.400885 -0.214245      2  0.895745  1.011671 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2017-07-19T11:37:42.587

如果我们要添加多级列：

来源 DF：

```
In [221]: df
Out[221]:
first        bar                 baz
second       one       two       one       two
A      -1.089798  2.053026  0.470218  1.440740
B       0.488875  0.428836  1.413451 -0.683677
C      -0.243064 -0.069446 -0.911166  0.478370 
```

**选项1**：添加除法结果：`bar / baz`作为新`foo`列

```
In [222]: df = df.join(df[['bar']].div(df['baz']).rename(columns={'bar':'foo'}))

In [223]: df
Out[223]:
first        bar                 baz                 foo
second       one       two       one       two       one       two
A      -1.089798  2.053026  0.470218  1.440740 -2.317647  1.424980
B       0.488875  0.428836  1.413451 -0.683677  0.345873 -0.627250
C      -0.243064 -0.069446 -0.911166  0.478370  0.266761 -0.145172 
```

**选项 2**：添加具有三个“子列”的多级列：

```
In [235]: df = df.join(pd.DataFrame(np.random.rand(3,3),
     ...:                           columns=pd.MultiIndex.from_product([['new'], ['one','two','three']]),
     ...:                             index=df.index))

In [236]: df
Out[236]:
first        bar                 baz                 new
second       one       two       one       two       one       two     three
A      -1.089798  2.053026  0.470218  1.440740  0.274291  0.636257  0.091048
B       0.488875  0.428836  1.413451 -0.683677  0.668157  0.456931  0.227568
C      -0.243064 -0.069446 -0.911166  0.478370  0.333824  0.363060  0.949672 
```

# android - 活动调用自身时的异常

> ID：16088742
> 
> 赞同：0
> 
> 时间：2013-04-18T16:46:59.560
> 
> 标签：android, android-intent

我的应用程序中有一个 activty，它使用 putextra(int) 方法在启动 aactivty 时首先传递值 0。然后在按下下一个按钮时，它会传递 6，然后是 12，依此类推。但问题在于第二次按下时我发现使用 getextras 方法收到的索引值为 0。是不是因为我是从自身调用活动。这是代码片段：

```
package com.movie;

 import android.app.Activity;
 import android.content.Intent;
 import android.os.Bundle;
 import android.util.Log;
 import android.view.View;
 import android.view.View.OnClickListener;
 import android.view.Window;
  import android.view.WindowManager;
 import android.widget.Button;
 import android.widget.Toast;

 public class movielist extends Activity implements OnClickListener{

Button bm[] = new Button[6];
Button nxt,prev;
String namesdb[]=new String[50];
databaseconnect db;
String lang;
int start,index,end;
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    requestWindowFeature(Window.FEATURE_NO_TITLE);
    getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, 
                            WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.mallu_list);
    db = new databaseconnect(this);
    db.open();

    start=this.getIntent().getExtras().getInt("index");
     lang =this.getIntent().getExtras().getString("lang");

     Toast.makeText(this, start+"", Toast.LENGTH_SHORT).show();
     Log.i("info",start+"");

    if(!db.isdata(lang))
    {
        Toast.makeText(this, "No data in Database", Toast.LENGTH_SHORT).show();
        finish();
        return;
    }
    end=start+6;
    bm[0] = (Button) findViewById(R.id.bm1);
    bm[1] = (Button) findViewById(R.id.bm2);
    bm[2] = (Button) findViewById(R.id.bm3);
    bm[3] = (Button) findViewById(R.id.bm4);
    bm[4] = (Button) findViewById(R.id.bm5);
    bm[5] = (Button) findViewById(R.id.bm6);

    nxt = (Button) findViewById(R.id.nxt);
    prev = (Button) findViewById(R.id.prev);
    if(start==0)
    {
//      prev.setBackgroundResource(0);
//      prev.setText("");
    }
    else
        prev.setOnClickListener(this);

    namesdb = db.getmovie("",lang);
    for (int i = 0; start+i < namesdb.length && i<6; i++) {
        bm[i].setText(namesdb[start+i]);
        bm[i].setOnClickListener(this);
    }
    int flag=0;
    int i=namesdb.length;
    Log.i("info",i+"");
        Toast.makeText(this, i+"", Toast.LENGTH_SHORT).show();
        for(int j=5;j>=i-start;j--)
        {
            bm[j].setBackgroundResource(0);
            flag=1;
        }
    if(flag==1)
    {
//      nxt.setBackgroundResource(0);
//      nxt.setText("");
    }
    else
        nxt.setOnClickListener(this);
  }
 @Override
public void onBackPressed() {
    // TODO Auto-generated method stub
    super.onBackPressed();
    Intent myint2 = new Intent(this, list.class);

    startActivity(myint2);
}

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    switch (v.getId()) {
    case R.id.bm1:
        call(namesdb[start],start,lang);
        break;
    case R.id.bm2:
        call(namesdb[start+1],start,lang);
        break;
    case R.id.bm3:
        call(namesdb[start+2],start,lang);
        break;
    case R.id.bm4:
        call(namesdb[start+3],start,lang);
        break;
    case R.id.bm5:
        call(namesdb[start+4],start,lang);
        break;
    case R.id.bm6:
        call(namesdb[start+5],start,lang);
        break;

    case R.id.nxt:
        int i=namesdb.length;
        Intent myint2 = new Intent(this,movielist.class);

    myint2.putExtra("index",end);
    myint2.putExtra("lang",lang);
    startActivity(myint2);
    case R.id.prev:
        if(start==0)
        {
            prev.setBackgroundResource(0);
        }
        else
        {
         myint2 = new Intent(this,movielist.class);

    myint2.putExtra("index",start-6);
    myint2.putExtra("lang",lang);
    startActivity(myint2);}
        break;

    }

}

public void call(String name,int start2,String lang) {

    Intent myint = new Intent(this, detail.class);
    myint.putExtra("nameid", name);
    myint.putExtra("index", start2);
    myint.putExtra("lang", lang);

    startActivity(myint);
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:36:28.183

这是你的问题。声明的这一部分`switch`：

```
case R.id.nxt:
    int i=namesdb.length;
    Intent myint2 = new Intent(this,movielist.class);
    myint2.putExtra("index",end);
    myint2.putExtra("lang",lang);
    startActivity(myint2); 
```

最后缺少一个`break`。所以它一直到下一个`case`，它以不同的额外内容开始活动。

# sql-server - 资源池“内部”中的系统内存不足，无法运行此查询

> ID：16088743
> 
> 赞同：0
> 
> 时间：2013-04-18T16:47:02.900
> 
> 标签：sql-server, sql-server-2008, sql-server-2008-r2

我正面临标题错误。我在谷歌上搜索了这个问题，发现很多人都面临同样的问题，但他们都不符合我的情况。

我有一个简单的查询，但有 100,000 个条件。查询看起来像。

```
SELECT TEXT,LANG,PLANTCODE FROM DROP_VALUE WHERE FIELDNAME='PROFIT_CTR' AND PLANTCODE IN ('953306843','469940529','293294653',......100,000 conditions) 
```

我正在使用 eclipse JUNO 和（在同一台本地机器上）sql server 2008 r2 企业版。
Windows 7 专业
版 8 GB RAM
i3 处理器。
为 JVM 分配 3gb 内存。

请建议我可能的原因。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:07:02.127

如果可以的话，将条件移动到一个表结构中并加入它。

# php - 使用 Cakemail 发送电子邮件超时

> ID：16088745
> 
> 赞同：0
> 
> 时间：2013-04-18T16:47:18.753
> 
> 标签：php, cakephp, cakephp-2.0

我正在尝试使用 CakeMail 发送电子邮件。我正在使用 Wamp 服务器，好吗？

我的 email.php 是这样的：

```
public $gmail = array(
    'host' => 'ssl://smtp.gmail.com',
    'from' => array('support@xxx.com' => 'xxx'),
    'port' => 465,
    'transport' => 'Smtp',
    'username' => 'igorpoxxx@gmail.com',
    'password' => 'xxx',

); 
```

在我的控制器中：

```
App::uses('CakeEmail', 'Network/Email');
$Email = new CakeEmail('gmail');
$Email->to('igor.ces@sotreq.com');
$Email->subject('About');
$Email->send('My message'); 
```

我得到超时！

**致命错误错误：超过 30 秒的最大执行时间
文件：C:\wamp\www\societario\lib\Cake\Network\CakeSocket.php
行：190**

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T14:13:02.267

解决了。

我在另一个网络中测试了该应用程序，并且工作正常。尽管出于某种原因，第一个拥有 Internet 的网络无法正常工作。是某种网络问题。谢谢

# statistics - Scipy Guassian_kde 规范化

> ID：16088746
> 
> 赞同：1
> 
> 时间：2013-04-18T16:47:19.047
> 
> 标签：statistics, scipy, kernel-density, statsmodels

我一直在使用 scipy.stats.gausian_kde 但对其输出有一些疑问。我在同一张图上绘制了归一化直方图和 gaussian_kde 图。为什么 y 值差异如此之大？我的理解是 gaussian_kde 图应该大致触及直方图的尖端。使用 scipy.integrate.quad 函数，我确定图表下方的面积为 0.7，而不是 1.0，这是我的预期。

实际上我真正想要的是让 gaussian_kde 代表非标准化直方图，有谁知道我该怎么做？![图表在这里](https://i.stack.imgur.com/vIz5q.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:57:21.770

你的期望有点偏离。每个 KDE 峰下的面积应大致等于其相应条形中的面积。在我看来，这似乎成立。具有全局带宽估计（如`scipy.stats.gaussian_kde`）的非自适应 KDE 倾向于扩大具有尖峰的多峰分布。

至于对 KDE 下总面积的低估，我不能说没有您用来进行集成的数据和代码。

为了使 KDE 近似于未归一化的直方图，您需要乘以`(bin_width*N)`where`N`是数据点的总数。

# .net - 混合语言的声纳 .net 插件失败

> ID：16088758
> 
> 赞同：0
> 
> 时间：2013-04-18T16:47:56.007
> 
> 标签：.net, vb.net, code-analysis, sonarqube

我正在尝试在 .net 解决方案上运行 Sonar，该解决方案主要包含 c# 项目，以及一个遗留的 vb.net 项目。声纳无法运行并显示以下错误消息：

**未找到键为“vbnet”的语言。**

我尝试使用 **sonar.skippedModules**在配置文件中排除该项目 ，但这没有帮助。

到目前为止，我发现的唯一解决方案是 Vb.Net[插件](http://www.sonarsource.com/products/plugins/languages/vb-net/)，它要花很多钱。

非常感谢您在解决/解决此问题方面的任何帮助。

谢谢， 奥马尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T10:43:24.950

我刚刚尝试了一个包含 C# 和 VB.NET 项目的示例解决方案，并且使用“sonar.skippedModules”效果很好。有一个[关于在 .NET 解决方案中使用此属性排除模块的特定常见问题解答](http://docs.codehaus.org/display/SONAR/Running+an+Analysis+on+a+C%23+Solution#RunninganAnalysisonaC#Solution-Settingexclusions)，您可能尚未阅读，它肯定会帮助您解决问题。

# android - Python 中的 Android 音频 API

> ID：16088764
> 
> 赞同：1
> 
> 时间：2013-04-18T16:48:06.830
> 
> 标签：android, python, kivy

我正在尝试用 Python 编写节拍器应用程序，并且打算发布适用于 Android 和 iOS 的应用程序。我发现了一些像 Kivy 这样的跨平台框架，但缺乏对音频的支持。更具体地说，我需要非常精确的音频计时，我不能依赖线程计时或事件。我想将音频数据直接写入设备的音频输出，或者创建一个可以即时播放的 MIDI 文件。问题是，我找不到*任何*适合这项任务的框架。

我知道很多游戏都是用 Python 为 Android 编写的，而且这些游戏的声音计时非常出色且精确。我需要帮助找到：

1.  一种使用 Python 在 Android 中即时创建和播放 MIDI 文件的方法，
2.  适用于 Android 的 Python 框架，具有合适的音频 API，可将声音直接写入音频设备，或者至少以非常准确的时间播放音频。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T20:42:45.393

我正在寻找同样的东西。我也在看基维。我可以看到音频的可能解决方案是将 3rd 方应用程序作为 Kivy 中的“配方”挂钩。

有 aubio，显然可以为 iOS/Android 编译（请参阅有关此的 stackoverflow 问题），但我相信您必须为它获取自己的音频源，这可能由 kivy 中的音频流子项目处理。

Kivy/audiostream 导入它出现的核心 libpd 项目，因此您可以使用 libpd python 绑定。我认为这是阻力最小的路径，但是在尝试运行示例时遇到了问题。

我认为这两种方法都*可以*，但都需要一些努力才能开始使用。

# ios - 检查getter中的CGRect是否为空

> ID：16088766
> 
> 赞同：25
> 
> 时间：2013-04-18T16:48:10.730
> 
> 标签：ios, ios6, null, cgrect, cgrectmake

我正在尝试检查 a`CGRect`是否`null`在我的属性 getter 中，如果是，则默认加载一个值，但是，在我的 init 方法中，当我使用该属性时，它对所有值都返回零。

这是我的吸气剂：

```
- (CGRect)frame
{
    if(CGRectIsNull(_frame))
        _frame = CGRectMake(0,0,60,60);
    return _frame;
}

- (id)init
{
    self = [super initWithFrame:self.frame];
    if(self)
    {
        //do something
    }
    return self;
} 
```

我不确定发生了什么以及在哪里看。任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-04-18T16:55:50.033

当您创建类的实例时，即使在调用方法`_frame`之前，实例变量也会自动初始化。`init`由于`_frame`是一个 C-struct ( `CGRect`)，它的内存被清零。这导致 a`CGRect`的值全为零。

`CGRectNull`是一个特殊的非零`CGRect`。所以你的支票使用`CGRectIsNull()`永远不会是真的。

使用`CGRectIsEmpty`是一个更合适的检查。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-18T16:52:10.197

尝试

```
- (CGRect)frame
{
    if (CGRectIsEmpty(_frame)) 
    _frame = CGRectMake(0,0,60,60);

    return _frame;
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-02-06T20:09:49.080

这是 Swift 4 的更新答案。您现在可以简单地使用 CGRect 的`isNull`布尔属性来检查 CGRectNull：

```
let someRect = CGRect.null
print(someRect.isNull) // true 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-22T13:14:19.427

首先，需要了解空矩形和宽度和高度为零的矩形是不同的。

在 Swift 5.0 及更高版本中-

要检查矩形是否为空 - 使用`isNull`矩形上的属性。假设矩形变量的标识符是“myFrame”。然后执行以下操作 -

```
if !myFrame.isNull{
    //do sth if the frame is not nul
} 
```

对于 .zero(width = 0, height = 0) 框架的矩形，请按以下方式检查 -

```
if !myFrame.isEmpty{
    // do sth is the frame has height or width
} 
```

# jquery - YouTube API：开始播放嵌入视频的自定义按钮

> ID：16088767
> 
> 赞同：0
> 
> 时间：2013-04-18T16:48:14.970
> 
> 标签：jquery, youtube-api, embedding, youtube-javascript-api

我在网站中嵌入了一个 YouTube 视频，但我想通过单击播放器外部的自定义按钮开始播放它。

在网络上进行了一些研究后，我尝试了这段 js：

```
$(document).ready(function() {
    $.getScript('http://www.youtube.com/player_api');

    $('#playvideo').click( function() {
         thevid=document.getElementById('thevideo'); thevid.style.display='block'; this.style.display='none'; $('#video').playVideo();
    });
}); 
```

其中#playvideo 是按钮，#video 是 YouTube iframe。

这是嵌入的html代码：

```
<iframe id="video" width="266" height="150" src="http://www.youtube-nocookie.com/embed/uJnHiN-GsZM?rel=0&showinfo=0&controls=2&enablejsapi=1" frameborder="0" allowfullscreen></iframe> 
```

但它不适用于任何浏览器，并且我收到此 JS 错误：

**未捕获的类型错误：对象 [object Object] 没有方法“playVideo”**

谁能给我一些建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T20:25:26.470

You are referencing the video with an ID of `thevideo` here:

`document.getElementById('thevideo')`

But you later try referencing the video with an ID of `video` here:

`$('#video').playVideo();`

Make sure all of your IDs and references are correct. Then let us know if the problem persists.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T20:18:49.897

`player = YT.Player('player'); player.playVideo();`请改用var

# php - 使用 php adodb 库执行具有复杂类型输出参数的 Oracle 存储过程

> ID：16088771
> 
> 赞同：0
> 
> 时间：2013-04-18T16:48:19.717
> 
> 标签：php, oracle, stored-procedures, parameters, plsql

使用以下代码，我收到一条错误消息，指出参数数量无效。

```
 $stmt = $this->db->PrepareSP("DECLARE SONUC VREPORT_ARRAY; BEGIN ZDS.ADMIN_REPORT(:SORGU_TARIH,:SONUC); END;");
        $this->db->InParameter($stmt,$DATA['SORGU_TARIH'],'SORGU_TARIH');
        $this->db->OutParameter($stmt,$output,'SONUC');
        $rs = $this->db->Execute($stmt); 
```

第二个名为 SONUC 的参数是 VARRAY / TABLE 类型。我不能确定这种返回类型是 unsopperted 还是我遗漏了其他东西。我正在使用 adodb 库进行数据库操作。

编辑：以下是我运行过程调用的错误消息。

```
oci8 error: [6550: ORA-06550: line 1, column 36: PLS-00306: wrong number or types of arguments in call to 'ADMIN_REPORT' ORA-06550: line 1, column 36: PL/SQL: Statement ignored] in EXECUTE("Array") 
```

编辑2：经过大量试验和浪费时间，它仍然无法正常工作。应用程序有其他语句成功调用存储过程（它们都没有返回输出参数）。它们都是直接通过 Execute 方法执行的。PrepareSP 和 InParameter/OutParameter 从未使用过。

# mongodb - 用于迁移大数据的 AWS（或其他云解决方案）？

> ID：16088779
> 
> 赞同：1
> 
> 时间：2013-04-18T16:48:41.853
> 
> 标签：mongodb, amazon-web-services, azure-storage, amazon-dynamodb, cloud-storage

我已经组织了文件系统和 SQL 数据库中的非关系数据。有一个应用程序可以查询这两个来源。

存储这些数据（大约 1TB）的云解决方案是什么？我希望能够将此数据迁移到云解决方案中并更改应用程序以查询云中的数据。

到目前为止，我已经研究了 AWS 选项：SimpleDB、DynamoDB 和 MongoDB，在一个带有 EBS 的 EC2 实例上增加了存储。

我还研究了 Azure 的表存储。

SimpleDB 有 10GB 的限制。DynamoDB 在 SSD 上，可能对我的需求有点过分。我错过了什么？AWS 上的 MongoDB 或 Azure 表存储是合适的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:21:36.913

我认为解决方案在很大程度上取决于您的数据访问模式。

我使用过 Azure 表存储，它对很多事情都非常有用。我使用过 DynamoDB，它也适用于很多事情。两者都是很好的表存储，但都对读取索引、查询和事务有限制。这有时是一个表演的终结者。两者都需要对您的数据和所有相关应用程序进行重组。

对于您的文件存储：

1.  （最便宜、最慢）将文件迁移到 Blob 存储（Azure Blob 存储或 AWS S3）并将它们保留在那里。使用 S3 作为文件访问驱动器。这很慢，但很便宜。
2.  （高性能）使用带有 EBS 驱动器的 EC2 实例并将您的文件存储在那里。访问本地文件系统上的数据。这是耐用且高性能的。

对于您的关系数据，将其保留为关系数据并将其存储在云关系数据库服务器中。（RDS+MySQL、RDS+SQL Server、SQL Azure 等）。

无需更改您的应用程序及其数据模式，即可迁移到云端。

# php - JQuery AJAX 更新另一个文本框上的文本框 textchanged

> ID：16088788
> 
> 赞同：0
> 
> 时间：2013-04-18T16:49:02.617
> 
> 标签：php, jquery, ajax, post

当我在另一个输入文本类型 (id="textbox1") 中输入内容时，我想更新我的输入文本类型 (id="textbox2")。

这是我的初始代码：

```
$("#textbox1").keyup(function(){
       $.ajax({
            type: "POST",
            url: "idgetter.php",
            data: 'id='+$("#textbox1").val(),
            success: function(n) {
                $('#textbox2').val(n);
            },
            error: function(n) {
                $('#textbox2').val(n);
            } 
       }); 
    }); 
```

还有我的 idgetter.php ：

```
include("inc/conn.php");
$q = mysql_query("SELECT name FROM jurnalis WHERE userid = '".$_POST['id']."'")or trigger_error("SQL", E_USER_ERROR);
if(mysql_num_rows($q)<=0) return "none";
else{
$r = mysql_fetch_array($q);
return $r["name"]; 
```

长话短说，这不起作用，知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:51:51.987

在 idgetter.php 中，使用 return 代替返回

```
echo "none"; 
```

和

```
echo $r["name"]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:57:08.080

您应该尝试 echo 而不是 return：

您的代码将是这样的：

```
include("inc/conn.php");
$q = mysql_query("SELECT name FROM jurnalis WHERE userid = '".$_POST['id']."'")or    trigger_error("SQL", E_USER_ERROR);
if(mysql_num_rows($q)<=0) echo "none";
else{
$r = mysql_fetch_array($q);
echo $r["name"]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T17:06:54.310

认为您的 php 中需要进行一些修改：

1.  将返回更改为回声（如其他答案中所述）

2.  将您的 if 语句更改为

    if(mysql_num_rows($q)==0){ echo 'none'; }else{ $r = mysql_fetch_assoc($q); 回声 $r['name']; }

那应该有希望地做到这一点。另外作为一个仅供参考，值得尝试避免将 $_POST[''] 项目直接添加到 SQL 语句中，因为它容易发生 SQL 注入漏洞。

# c++ - 调试使用 __stdcall 和 pragma 链接器的 DLL

> ID：16088798
> 
> 赞同：0
> 
> 时间：2013-04-18T16:49:19.793
> 
> 标签：c++, windows, linker, pragma

我想调试一个DLL。此 DLL 导出一些函数和 void：

这是标题：

```
#ifdef CODEC_EXPORTS
#define CODEC_API __declspec(dllexport)
#else
#define CODEC_API __declspec(dllimport)
#endif

extern "C" CODEC_API int __stdcall SpxInit(void);
extern "C" CODEC_API int __stdcall SpxEncode(unsigned char* inBuf, unsigned char* outBuf, unsigned int inlen);
extern "C" CODEC_API int __stdcall SpxEncodeNormal(void);
extern "C" CODEC_API int __stdcall SpxDecode(unsigned char* DinBuf, float* DoutBuf,     unsigned int Dinlen);
extern "C" CODEC_API int __stdcall SpxFree(void);

#pragma comment(linker, "/export:SpxEncode=_SpxEncode@12")
#pragma comment(linker, "/export:SpxEncodeNormal=_SpxEncodeNormal@0")
#pragma comment(linker, "/export:SpxDecode=_SpxDecode@12")
#pragma comment(linker, "/export:SpxInit=_SpxInit@0")
#pragma comment(linker, "/export:SpxFree=_SpxFree@0") 
```

我在我的解决方案中添加了一个新项目，并简单地添加了以下 cpp 文件：

```
#include "stdafx.h"
#include "codec.h"

int _tmain(int argc, _TCHAR* argv[])
{
    return 0;
} 
```

现在在尝试其他任何事情之前，我只是想编译新项目，但 VC2010 告诉我

```
"error LNK2001" Unresolved external symbol "_SpxDecode@12"
"error LNK2001" Unresolved external symbol "_SpxEncode@12" 
```

ETC...

所以我想我错过了一些东西，但我没有看到什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:59:06.377

您需要添加[对](http://msdn.microsoft.com/en-us/library/vstudio/ez524kew%28v=vs.100%29.aspx)您的 dll 项目
Project properties->Common Properties->References的引用

# c# - 如何从基类调用派生类方法？

> ID：16088799
> 
> 赞同：22
> 
> 时间：2013-04-18T16:49:22.353
> 
> 标签：c#, derived-class, base-class

我已经阅读了几个类似的问题，但似乎没有一个可以解决我面临的问题。典型的答案是强制转换为派生类，但我不能，因为我不知道派生类的类型。

这是我的例子：

```
class WireLessDevice { // base class
    void websocket.parsemessage(); // inserts data into the wireless device object
}

class WiFi : WireLessDevice { // derived class
    GPSLoc Loc;
} 
```

无线设备也可以派生为蓝牙、Wi-Max、蜂窝等设备，因此我不知道哪种类型的无线设备将接收数据。

当在基类的 websocket 上收到 GPS 数据包时，我需要更新派生设备的位置。

我想也许可以通过队列发送消息或创建事件处理程序并在事件参数中发送位置，但是当数据保留在类中时，这些似乎有点笨拙。

语言中是否有内置的东西可以让我在不知道类型的情况下从基类调用派生设备？

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-04-18T16:51:54.647

正确的方法是在基类中添加一个方法 DoSomeMagic() ，默认实现，或者抽象。派生类应该重写它来发挥它的魔力。

可能是这样的：

```
public class WireLessDevice
{ // base class
    protected virtual void ParseMessage()
    {
        // Do common stuff in here
    }
}

public class WiFi : WireLessDevice
{ // derived class
    override void ParseMessage()
    {
        base.ParseMessage();//Call this if you need some operations from base impl.
        DoGPSStuff();
    }
    private void DoGPSStuff()
    {
        //some gps stuff
    }
    GPSLoc Loc;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-18T17:02:56.857

[虚拟方法](http://msdn.microsoft.com/en-us/library/aa645767%28v=vs.71%29.aspx)将是一个很好的解决方案。您在基类中创建一个方法，该方法`ParseMessage`处理每个派生类型共有的所有内容，然后覆盖特定设备。

为了仍然能够处理其他消息类型，您需要根据需要调用 `base.ParseMessage`：

```
class WireLessDevice
{
    protected virtual bool ParseMessage(byte[] message)
    {
        // Inspect message and handle the known ones
        return true; // Only if message parsed, otherwise false
    }
}

class WiFi : WireLessDevice
{
    GPSLoc Loc;

    protected override bool ParseMessage(byte[] message)      
    {
        bool messageParsed = base.ParseMessage(message)
        if (!messageParsed)
        {
            // Handle device specific message with GPSLoc
            Loc = ...
        }
        else
        {
            return false;
        }
    }
} 
```

如果您的基类不处理任何其他消息，则代码可能会更简单（并且使用[`abstract`](http://msdn.microsoft.com/en-us/library/aa664435%28v=vs.71%29.aspx)）。但是，在这种情况下，我会考虑将 Web 套接字代码移至派生类。

# qt - QTableWidget::setCellWidget() 禁用来自 QTableWidget 的信号？

> ID：16088800
> 
> 赞同：1
> 
> 时间：2013-04-18T16:49:22.460
> 
> 标签：qt, signals-slots, qwidget, qtablewidget

我有一个 QTableWidget 实例，其 cellEntered(int,int) 信号与插槽 X 相关联（突出显示包含单元格的行）。我还有一列包含复选框。

问题是使用 QTableWidget::setCellWidget() 方法将复选框添加到表格的单元格中：

```
QTableWidgetItem *checkBoxItem = new QTableWidgetItem("");
ui->tableWidget->setItem(rowCount, column, checkBoxItem);
QCheckBox* checkBox = new QCheckBox();
ui->tableWidget->setCellWidget(rowCount, column, checkBox);
connect(checkBox, SIGNAL(clicked(bool)),
    this, SLOT(checkbox_clicked(bool))); 
```

当光标位于该列中的单元格上时，不会调用插槽 X。

该问题不仅针对复选框，也针对其他类型的小部件。

我在一些帖子中阅读了有关 SignalMapper 类的内容，但该类似乎有助于将信号从小部件映射到插槽。相反，我的问题与表中的信号有关。

有什么建议吗？

干杯，

巴勃罗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:42:21.220

为什么不使用 QTableWidgetItem 并使用[QTableWidgetItem::setCheckState(Qt::CheckState state)](http://harmattan-dev.nokia.com/docs/library/html/qt4/qtablewidgetitem.html#setCheckState)将其设置为可检查？

```
QTableWidgetItem *check_item = new QTableWidgetItem;
check_item->setCheckState(Qt::Unchecked); 
```

你也可以用标志来做。

```
check_item->setFlags(Qt::ItemIsUserCheckable); 
```

将[QTableWidget::itemChanged(QTableWidgetItem * item)](http://qt-project.org/doc/qt-4.8/qtablewidget.html#itemChanged)信号连接到一个插槽，并检查该项目是否在那里被选中。

# jquery - jQuery 不工作 .bind、.on、.click 可能的冲突？

> ID：16088808
> 
> 赞同：0
> 
> 时间：2013-04-18T16:49:37.720
> 
> 标签：jquery

[我在这里](http://jsfiddle.net/ExyNG/1/)有一个 jQuery 工作块的 jsfiddle 。基本上，我使用 jQuery 来隐藏或显示基于选择单选按钮的下拉菜单。

一切都可以在 jsfiddle 中运行，但是当我将它集成到我的网站时却没有。如果已经通过插件分配了点击功能，那么防止冲突的最佳方法是什么？

我试过了， .on ('click', .bind( , .click( 没有任何效果。

[http://jsfiddle.net/ExyNG/](http://jsfiddle.net/ExyNG/)

的HTML：

```
<div class="foxyshop_variations">
    <label class="variation-8-wide" for="403_1">8' Wide</label>
    <select class="variation-8-wide" id="403_1" name="8'_Wide">
        <option value="Select 8' Wide Kit||c9a7aebec7e7384386231888176bd47864d248a88c2922aed00fba45d8a714ad">Select 8' Wide Kit</option>
        <option pricechange="+0" value="8x8{p+0.00lw-75lc+RS88G}||b7b2c2d752e830d8ca803aa2a0f25dba6081baf2ff4a75e4c8a5dbb382549f51">8x8 (+$0.00)</option>
        <option pricechange="+7000" value="8x10{p+70.00|w-85lc+RS810G}||593e367aab31f5540b068bd1f3404762394538807a137624419389f0d9302fcf">8x10 (+$70.00)</option>
        <option pricechange="+13500" value="8x12{p+135.00|w-95lc+RS812G}||ed2f781d9f9fd7738157ea31c0f552f912f929c960bb73e36ca1d24bba62ffcf">8x12 (+$135.00)</option>
        <option pricechange="+20500" value="8x14{p+205.00|w-105lc+RS814G}||0f528bdd6d6987630a7023b79fd9cf4ac35856199ae824ed1101d8226f6e7fb5">8x14 (+$205.00)</option>
        <option pricechange="+23500" value="8x16{p+235.00|w-115lc+RS816G}||49595b16c4e506f0b936521d82c283cd2dcc15bd85b6a5d3d8e45cc81f3da427">8x16 (+$235.00)</option>
        <option pricechange="+23500" value="8x18{p+235.00|w-125lc+RS818G}||c2a0d4ffa51343cae6a4eba706b448baf1922dcd6827f13a6523fe8bb71d5062">8x18 (+$235.00)</option>
        <option pricechange="+23500" value="8x20{p+235.00|w-135lc+RS820G}||820a5ab4534c2039c25091b0d9ad8c869fa81c28a98a96ccfe344ea009010658">8x20 (+$235.00)</option>
    </select>
    <div class="clr"></div>
    <label class="variation-10-wide" for="403_2">10' Wide</label>
    <select class="variation-10-wide" id="403_2" name="10'_Wide">
        <option value="Select 10' Wide Kit||998d37aa429bbe3570d8e2b58962acd56fff7982a018f34e3ca0c9c88fc5ab47">Select 10' Wide Kit</option>
        <option pricechange="+0" value="10x8{p+0.00|w-110lc+RS108G}||94c9190a6fd9036a48734d8bfa2610702f122f999ee0381419efb7ba6663c411">10x8 (+$0.00)</option>
        <option pricechange="+7000" value="10x10{p+70.00|w-125lc+RS1010G}||9767c842283d2323b09ef69e293659429b041a6fd8695a569d0a4fb25f05179a">10x10 (+$70.00)</option>
        <option pricechange="+13500" value="10x12{p+135.00|w-140lc+RS1012G}||cc1b9825f63e04382881bbf6fd278ab51bd53d052a312c7958cb21d7706cc8f8">10x12 (+$135.00)</option>
        <option pricechange="+20500" value="10x14{p+205.00|w-75.5lc+RS1014G}||6992dcd2f27f9d61d04ba330250966baa245124dbf851f72169064dea6bda315">10x14 (+$205.00)</option>
        <option pricechange="+23500" value="10x16{p+235.00|w-85lc+RS1016G}||62e66d53bd8412bea5ca6c6e149e8ab8c52fcd72275f852cc106320e5d2cf227">10x16 (+$235.00)</option>
        <option pricechange="+23500" value="10x18{p+235.00|w-92.5lc+RS1018G}||4ac77aff339ecda405853c7ced04ebcd330d3a7efeab53428651578a054117c3">10x18 (+$235.00)</option>
        <option pricechange="+23500" value="10x20{p+235.00|w-100lc+RS1020G}||43aade4c64edd6855fddbd8c9234df0de876c62e3430c20e1af5e744588fad12">10x20 (+$235.00)</option>
    </select>
    <div class="clr"></div>
    <div class="foxyshop_radio_wrapper">
        <div class="foxyshop_radio_title">Check One</div>
        <div class="foxyshop_short_element_holder">
            <input type="radio" checked="checked" class="variation-check-one" id="403_3_0" value="8' Wide||250cb4d758d5c0f482b9d48009b03653b8e8d41e6fee682f5578a9b5e4d32abf" name="Check_One">
        </div>
        <label class="variation-check-one foxyshop_no_width" for="403_3_0">8' Wide</label>
        <div class="clr"></div>
        <div class="foxyshop_short_element_holder">
            <input type="radio" class="variation-check-one" id="403_3_1" value="10' Wide||e502477417a1f9d94aa0bd90e4116c485911296d434602822663a3e13df476c0" name="Check_One">
        </div>
        <label class="variation-check-one foxyshop_no_width" for="403_3_1">10' Wide</label>
        <div class="clr"></div>
    </div>
    <div class="clr"></div>
    <label for="quantity_403" class="foxyshop_quantity">Quantity</label>
    <input type="text" class="foxyshop_quantity" value="1" id="quantity_403" name="quantity||203d4bc6421ae54a22598d6ac0e45e8a3d7434c2395a4a4bf2eeeca368532660||open">
    <div class="clr"></div> 
```

jQuery：

```
$("#403_3_0").click(function () {

    $("#403_2, .variation-10-wide").hide("fast");
    $("#403_1, label.variation-8-wide").show("fast");
});

$("#403_3_1").click(function () {

    $("#403_1, label.variation-8-wide").hide("fast");
    $("#403_2, .variation-10-wide").show("fast");
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:00:40.680

这不是冲突问题。

您只是没有针对正确的元素。在您的网站上，元素 ID 是

`#403_1_0`和`#403_1_1`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:57:39.460

用于`jQuery noConflict`避免与插件的冲突问题：

```
<script type="text/javascript" href="path_to_js"></script>

var j = jQuery.noConflict();

j.on("click", function(){

...

}); 
```

# python - Python：比较几个文件

> ID：16088809
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:49:39.930
> 
> 标签：python, csv, comparison

我用 Python 编写了一个比较 3 个 excel 文件的脚本。我有很多文件要使用此脚本，并且我希望它们以三个一组的形式使用。到目前为止，它大致是这样的：

```
#!/usr/bin/env python

import sys
import csv

#lots of functions

resultsdir = "."
#bla

filename1=sys.argv[1]
filename2=sys.argv[2]
filename3=sys.argv[3]
out = open(sys.argv[4],"w")

#filename1,filename2,filename3="CNVB_reads.403476","CNVB_reads.403447","CNVB_reads.403478"
#these are the 3 files it uses at the moment

file1=open(resultsdir+"/"+filename1+".csv")
file2=open(resultsdir+"/"+filename2+".csv") 
file3=open(resultsdir+"/"+filename3+".csv")

file1.readline()    
file2.readline()
file3.readline()

#lots of other irrelevant stuff
#the output goes into an excel file as well 
```

一般来说，我是编程新手，我希望当我试图解释我想做的事情时我是有意义的。为任何帮助干杯！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T12:22:17.697

我会`glob`用来获取所有文件名，对它们进行排序，然后循环遍历它们（就像我[在这里](https://stackoverflow.com/questions/16285500/python-loop-through-several-csv-files/)回答的那样）

```
# other imports
from glob import glob

# lots of functions

resultsdir = "."
counter = 0
outname = sys.argv[1]
files = sorted(glob(resultsdir+'/*.csv')) # get and sort .csv files
while len(files) >= 3: # Are there another 3 files?
    out = open(outname+'_'+str(counter)+'.csv',"w") # open an output file with an increasing number in name
    counter += 1 # increase output file number
    file1=open(files.pop(0)) # get and remove first file from the list
    file2=open(files.pop(0)) # get the next file from the list (is now the first)
    file3=open(files.pop(0))

    # do something with the files

    # close the files 
```

**第二种选择**是使用（如评论中所述）使用

```
files = sorted(sys.argv[2:]) 
```

要获取文件，您必须像这样调用脚本：

```
program.py output_name *.csv 
```

然后程序获取与通配符 ( `*.csv`) 匹配的所有文件的列表作为参数

# php - 如何将 MySQL 选择查询值放入 PHP 变量中？

> ID：16088810
> 
> 赞同：2
> 
> 时间：2013-04-18T16:49:42.530
> 
> 标签：php, mysql, sql

我知道我需要使用 MySQL fetch 来防止在我的变量中获取资源 ID，但我想知道你是否可以帮助我如何做到这一点。我从几个教程中看到他们使用循环，但我只想选择一个字符串到一个变量中。这是我的代码：

```
$img = mysql_query('SELECT pname FROM photos WHERE pphotoid=21');
echo $img; 
```

我基本上想`$img`在数据库中包含`Resource id #3`当前显示的字符串。我写的东西也容易被 SQL 注入吗？

学习 MySQL，所以任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:53:10.103

```
$img=mysql_fetch_assoc(mysql_query('SELECT pname FROM photos WHERE pphotoid=21'));
      echo $img["pname"]; 
```

会更好

```
$img=mysqli_fetch_assoc(mysqli_query($link,'SELECT pname FROM photos WHERE pphotoid=21'));
echo $img["pname"]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:52:02.450

```
$handle = mysql_query('SELECT pname FROM photos WHERE pphotoid=21');
$row = mysql_fetch_row($handle);
echo $img[0]; 
```

[http://pl1.php.net/mysql_fetch_row](http://pl1.php.net/mysql_fetch_row)

此代码将为您工作。

为了防止 SQL 注入，你应该使用像 mysql_escape_string() 这样的转义函数，你还应该检查你的输入是什么并验证它

在这里你会学到更多

[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

最好使用 PDO，因为 mysql_* 自 PHP 5.5.0 起已被弃用，并且将来会被删除。

这是学习使用 PDO 连接到 db 的教程

[http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)

您在 PDO 中的代码（假设您已连接到 db）将如下所示： $id = intval(21); //这里的代码是没有意义的，但是如果你得到 21 例如通过 $_GET 它会将它转换为整数并防止注入

```
$stmt = $db->prepare("SELECT pname FROM photos WHERE pphotoid=?");
$stmt->execute(array($id));
$row = $stmt->fetch(PDO::FETCH_ASSOC);
echo $row['pname']; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-05T15:48:26.327

我喜欢以下内容：

连接.php：

```
//All the $*_db variables are pulled from a file kept outside of the document root directory but referenced here to connect to the database
include('/path/to/file/not/in/docroot/connection_info.php');

$DBi = mysqli_connect($hostname_db, $username_db, $password_db, $database_db);
if($mysqli->connect_error) {
    //Do something for errors here...
}; 
```

文件.php

```
include('connection.php');

$q_myQuery = "SELECT `pname` FROM `photos` WHERE `pphotoid` = 21";
$rsmyQuery = mysqli_query($DBi, $q_myQuery) or die(mysqli_error($DBi));
$row_rsmyQuery = mysqli_fetch_assoc($rsmyQuery);

$img = $row_rsmyQuery['pname']; 
```

那是使用`mysqli*`功能，而不是`mysql*`已弃用的功能。更多信息在这里：[http ://us3.php.net/manual/en/mysqlinfo.api.choosing.php](http://us3.php.net/manual/en/mysqlinfo.api.choosing.php)

# java - Java中链表的栈操作

> ID：16088811
> 
> 赞同：-3
> 
> 时间：2013-04-18T16:49:44.943
> 
> 标签：java, linked-list, stack

我必须编写一个应该使用链表实现堆栈的类。但是，它应该从列表的尾部而不是头部执行推送和弹出操作。此外，它不应该维护对列表尾节点的引用。

在不保留对最后一个节点的引用的情况下，我究竟如何实现这一目标？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:56:22.037

你*可以*这样做，但效率很低，因为每次你想做某事时都必须遍历整个列表。当所有操作都在尾部执行时，您确实没有任何理由要保留对头部的引用。

但无论如何我都会这样做：

```
class Entry<E> {
    E object;
    Entry<E> next;
    public Entry(E obj) {
        object = obj;
    }
}

class StackList<E> {
    Entry<E> head;
    public void push(E element) {
        if (head == null) {
            // first
            head = new Entry<E>(element);
            return;
        }
        Entry<E> node = head;
        while (node != null && node.next != null) {
            node = node.next;
        }
        // node is now the tail
        Entry<E> newEntry = new Entry<E>(element);
        node.next = newEntry;
    }
    public E pop() {
        if (head == null) {
            // empty
            return null;
        }
        Entry<E> node = head, previousNode = null;
        while (node.next != null) {
            previousNode = node;
            node = node.next;
        }
        // node is now the tail
        // previousNode is the next-to-last
        if (previousNode != null) {
            previousNode.next = null;
        } else {
            // there was only one thing
            head = null;
        }
        return node.object;
    }
} 
```

# c++ - QVector 和 std::vector 的大小方法

> ID：16088815
> 
> 赞同：4
> 
> 时间：2013-04-18T16:49:52.837
> 
> 标签：c++, qt, types, vector

is的 size 方法`QVector`属于 type `int`，但 is 中的方法`std::vector`相同`unsigned`。为什么有区别。无符号类型不是保持大小的正确方法，因为它不能为负数吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T17:02:34.790

因为[他们在 1999 年对其进行了讨论，](http://web.archive.org/web/20070222073355/http://lists.trolltech.com/qt-interest/1999-03/thread00251-0.html)并得出了`int`一个更好的选择的结论，因为返回的函数数量`uint`相对较少，并且他们对警告感到不满：

> ```
> Subject: Re: killing uint as return type in Qt.
> From: Alex Sandro Queiroz e Silva <asandro@xxxxxxxxxxxxx>
> Date: Wed, 17 Mar 1999 15:29:37 -0300 (EST)
> Cc: qt-interest@xxxxxxxx
> To: Arnt Gulbrandsen <arnt@xxxxxxxx> 
> ```
> 
> 1999 年 3 月 17 日，Arnt Gulbrandsen 写道：
> 
> > Qt 中大约 0.15% 的函数返回 uint。其中大部分被称为 QMumble::size() 或 QMumble::count()。这些函数永远不需要返回负数，所以实际上，uint 是它们返回的正确类型。
> > 
> > 但这很麻烦，至少对我来说。我一直将它们与整数进行比较，将它们放入可以包含负数的变量中，等等。我写过
> > 
> > ```
> >  if ( blah->count() < i ) 
> > ```
> > 
> > 并且已经多次收到编译器警告。
> > 
> > 所以我正在考虑在 Qt 2.0 中将这些函数的返回类型更改为 int。你怎么看？你是用户——你想要正确性和完全向后兼容性还是更方便？
> > 
> > --Arnt
> 
> 我认为这次的便利性更好，我们现在都可能从这种方法中得到什么样的结果，所以...
> 
> -- 亚历克斯 asandro@lcg.dc.ufc.br

# java - Java 垃圾收集和年轻代大小

> ID：16088818
> 
> 赞同：2
> 
> 时间：2013-04-18T16:49:56.697
> 
> 标签：java, performance, garbage-collection

我最近遇到了性能问题，我在 tomcat 上运行的 Java webapp 会短时间挂起，导致流量积压，这可能使 webapp 在几分钟内不可用，我怀疑这与垃圾收集有关。

我是一个垃圾收集菜鸟，所以需要一些帮助。

我启用了并发标记清除垃圾收集器，希望这将消除暂停，但我还没有发现这是否已经解决了问题。

我还同时启用了详细的 GC 日志记录。

当前的java选项如下

```
-XX:MaxPermSize=128m -XX:+CMSClassUnloadingEnabled -XX:+UseConcMarkSweepGC -Xms4g -Xmx4g -Xss256k -verbose:gc -XX:+PrintGCDetails 
```

通过检查 GC 输出，我注意到年轻代空间非常低，只有 243MB，并且很快就会耗尽，而在检查一段时间的输出时，我在 10 秒内计算了 23 个年轻代收集。

与此同时，总堆消耗量稳步上升，接近最大值，随后进行了完整的垃圾收集，将其从大约 3.5gb 降至 260mb，然后该模式再次自我重复。

完整 GC 的示例输出

```
[GC [ParNew: 232750K->12960K(249216K), 0.0160890 secs] 3836696K->3616934K(4166656K), 0.0162110 secs] [Times: user=0.12 sys=0.01, real=0.02 secs] 
[GC [ParNew: 234528K->11391K(249216K), 0.0127970 secs] 3838502K->3615402K(4166656K), 0.0129370 secs] [Times: user=0.12 sys=0.00, real=0.01 secs] 
[GC [ParNew: 232959K->10253K(249216K), 0.0097850 secs] 3836970K->3614841K(4166656K), 0.0098850 secs] [Times: user=0.11 sys=0.00, real=0.01 secs] 
[GC [1 CMS-initial-mark: 3604588K(3917440K)] 3615964K(4166656K), 0.0096810 secs] [Times: user=0.01 sys=0.00, real=0.01 secs] 
[CMS-concurrent-mark: 0.196/0.196 secs] [Times: user=1.44 sys=0.03, real=0.20 secs] 
[CMS-concurrent-preclean: 0.013/0.014 secs] [Times: user=0.04 sys=0.00, real=0.01 secs] 
[GC [ParNew: 231821K->6718K(249216K), 0.0090430 secs] 3836409K->3611789K(4166656K), 0.0091460 secs] [Times: user=0.08 sys=0.01, real=0.01 secs] 
[CMS-concurrent-abortable-preclean: 0.176/0.390 secs] [Times: user=0.97 sys=0.04, real=0.39 secs] 
[GC[YG occupancy: 124723 K (249216 K)][Rescan (parallel) , 0.0698120 secs][weak refs processing, 0.0038070 secs][class unloading, 0.0170180 secs][scrub symbol & string tables, 0.0098050 secs] [1 CMS-remark: 3605071K(3917440K)] 3729794K(4166656K), 0.1070920 secs] [Times: user=0.78 sys=0.02, real=0.11 secs] 
[GC [ParNew: 228286K->6428K(249216K), 0.0079910 secs] 3755282K->3534155K(4166656K), 0.0080720 secs] [Times: user=0.07 sys=0.00, real=0.01 secs] 
[GC [ParNew: 227996K->6880K(249216K), 0.0085010 secs] 3332282K->3111216K(4166656K), 0.0085990 secs] [Times: user=0.08 sys=0.00, real=0.01 secs] 
[GC [ParNew: 228448K->12440K(249216K), 0.0108230 secs] 2721177K->2505200K(4166656K), 0.0109290 secs] [Times: user=0.13 sys=0.00, real=0.01 secs] 
[GC [ParNew: 234008K->8251K(249216K), 0.0073110 secs] 2358432K->2132792K(4166656K), 0.0074120 secs] [Times: user=0.07 sys=0.00, real=0.00 secs] 
[GC [ParNew: 229819K->5170K(249216K), 0.0071920 secs] 2056138K->1831867K(4166656K), 0.0072880 secs] [Times: user=0.07 sys=0.01, real=0.01 secs] 
[GC [ParNew: 226738K->11119K(249216K), 0.0106230 secs] 1589903K->1374447K(4166656K), 0.0107180 secs] [Times: user=0.11 sys=0.00, real=0.01 secs] 
[GC [ParNew: 232687K->8624K(249216K), 0.0078450 secs] 1273082K->1049051K(4166656K), 0.0079440 secs] [Times: user=0.09 sys=0.00, real=0.01 secs] 
[GC [ParNew: 230192K->10130K(249216K), 0.0083440 secs] 733461K->513411K(4166656K), 0.0084420 secs] [Times: user=0.11 sys=0.00, real=0.01 secs] 
[GC [ParNew: 231698K->10655K(249216K), 0.0092440 secs] 544833K->323816K(4166656K), 0.0093450 secs] [Times: user=0.11 sys=0.00, real=0.01 secs] 
[CMS-concurrent-sweep: 4.481/4.569 secs] [Times: user=13.24 sys=0.49, real=4.57 secs] 
[CMS-concurrent-reset: 0.008/0.008 secs] [Times: user=0.02 sys=0.00, real=0.01 secs] 
[GC [ParNew: 232223K->9791K(249216K), 0.0095050 secs] 495665K->273758K(4166656K), 0.0096020 secs] [Times: user=0.11 sys=0.00, real=0.01 secs] 
[GC [ParNew: 231359K->7434K(249216K), 0.0080890 secs] 495326K->271660K(4166656K), 0.0082230 secs] [Times: user=0.09 sys=0.00, real=0.01 secs] 
[GC [ParNew: 229002K->5732K(249216K), 0.0053690 secs] 493228K->269993K(4166656K), 0.0054630 secs] [Times: user=0.06 sys=0.00, real=0.01 secs] 
[GC [ParNew: 227300K->4017K(249216K), 0.0060080 secs] 491561K->268433K(4166656K), 0.0061010 secs] [Times: user=0.07 sys=0.00, real=0.00 secs] 
```

我想了解这种模式是否正常，以及我可以做些什么来优化和改进 thisC.

我已经阅读了有关增加年轻代大小但对垃圾收集不太熟悉的信息，我不确定这是否是正确的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:10:23.830

这看起来确实像您的年轻代大小太小 - 频繁的收集并不是真正的问题（这只是意味着您有一个内存密集型程序），但是您有很多内存被提升到下一代是有问题的. 一些东西：

1.  您是否有任何可以池化的资源，例如您可以使用 ThreadPoolExecutor 而不是创建新的 Thread 对象，或者您可以池化您的数据库连接？这将减慢您的内存消耗 - 汇集的资源将保留在您的成熟空间中，您不必继续在年轻空间中重新分配它们。

2.  如果这不是一个选项，或者如果这不会减少您的成熟空间消耗，那么增加您的年轻代大小。这样做的目的不是减少年轻代收集的数量（如果你将年轻代的大小加倍，那么你将减少一半的收集数量，但每个收集的成本可能会增加一倍**，所以你没有得到任何东西） ，而是这样做的目的是让您的年轻对象有更多时间超出范围，以免它们被提升到成熟空间。您想要进行的比较是完整收集的频率 - 如果在增加年轻代大小后您的完整收集较少，那么您已经成功，否则将您的年轻代大小减少回默认值。

** 这并不完全正确，因为年轻代收集器是一个复制收集器——它将活动对象复制到成熟空间，然后清除年轻空间。这意味着收集器运行的时间与活动对象的数量成正比，而不是与对象的总数成正比（就像标记扫描收集的情况一样）。理想情况下，通过增加年轻代的大小，您将减少活动对象的数量并加快收集时间以及减少成熟空间消耗。

# go - 来自statthat的treap包重叠？

> ID：16088820
> 
> 赞同：4
> 
> 时间：2013-04-18T16:50:00.420
> 
> 标签：go

根据此[链接](https://groups.google.com/forum/?fromgroups=#!topic/golang-nuts/x9bXQ9gKvZg)stathat 使用与他们的[treap](http://www.stathat.com/src/treap)重叠：

> GoLLRB 很棒，您没有理由切换。我们认为 treaps 背后的想法是解决我们问题的优雅方案，因此我们实现了它。我们喜欢 GoLLRB 提供的接口，所以我们在实现中模仿了它。
> 
> 我们添加到 treap 包中的一件事是允许您使用重叠函数进行迭代，例如，您可以获得 [3,9) 中的所有键。我们经常使用它，通常以结构作为键。
> 
> 帕特里克

我正在使用以下代码，不知道如何继续：

```
package main

import(
    "reflect"
    "fmt"
    "github.com/stathat/treap"
)

func IntLess(p, q interface{}) bool {
        return p.(int) < q.(int)
}

func BucketOverlap(a, b interface{}) bool {
    return false
}

func main() {
    tree := treap.NewOverlapTree(IntLess, BucketOverlap)
    tree.Insert(5, "a")
    tree.Insert(7, "b")
    tree.Insert(2, "c")
    tree.Insert(1, "d")

    for v := range tree.IterateOverlap([]int{2,5}) {
        fmt.Printf("val: %v\n", v)
    }
} 
```

假设我想获得范围内的键`[2,5]`=>`[c,a]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T16:20:25.023

我要开始的第一个地方是 stathat treap 代码的测试： [https ://github.com/stathat/treap/blob/master/treap_test.go#L164](https://github.com/stathat/treap/blob/master/treap_test.go#L164)

似乎您正在做的是在期望一个键时尝试传递一个键。您还尝试对标量（即 int）值进行矢量运算（即范围重叠）。

也许我误解了重叠的点，但我的理解是它的用途是作为区间树：

```
key1 := []int{1, 3}
key2 := []int{2, 4}
key3 := []int{5, 6} 
```

这些是间隔（低和高）。key1 与 key2 重叠，反之亦然。既不重叠key3。在这种情况下，重叠将很有用（即`IterateOverlap([]int{2,3})`会给我 key1 和 key2，而`IterateOverlap([]int{3,5})`将返回所有）。

我不确定您将如何迭代这些条目。也许是这样：

```
for i := 2; i <= 5; i++ {
  fmt.Printf("val: %v\n", tree.Get(i))
} 
```

再说一次，我没有使用过这个实现，所以如果我叫错了树，请原谅我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T04:27:38.207

我找到了使用[GoLLRB](https://github.com/petar/GoLLRB)的解决方案：

```
package main

import (
    "fmt"
    "github.com/petar/GoLLRB/llrb"
)

type Item struct {
    key     int
    value   string
}

func lessInt(a, b interface{}) bool {
    aa := a.(*Item)
    bb := b.(*Item)
    return aa.key < bb.key
}

func main() {
    tree := llrb.New(lessInt)
    tree.ReplaceOrInsert(&Item{5, "a"})
    tree.ReplaceOrInsert(&Item{7, "b"})
    tree.ReplaceOrInsert(&Item{2, "c"})
    tree.ReplaceOrInsert(&Item{1, "d"})
    //tree.DeleteMin()

    c := tree.IterRangeInclusive(&Item{key: 2}, &Item{key: 5})
    for item := <-c; item != nil; item = <-c {
        i := item.(*Item)
        fmt.Printf("%s\n", i.value)
    }
} 
```

我仍然想知道这是否也可以使用 stathat's treap。

# node.js - 使用 Express.js 服务静态文件和 app.get 冲突

> ID：16088824
> 
> 赞同：8
> 
> 时间：2013-04-18T16:50:16.757
> 
> 标签：node.js, express

我在这里有这段代码：

```
var express = require('express')
  , http = require('http')

var app = express();
var server = app.listen(1344);
var io = require('socket.io').listen(server);

app.use(express.static(__dirname + '/public'));
app.use(express.bodyParser());
app.use(express.cookieParser());
app.use(express.session({secret: 'secret'}));

app.get('/', function(req, res){
    if(req.session){
        console.log(req.session);
    }
    console.log('ok');

}); 
```

回调中的代码`app.get()`没有被调用。如果我注释掉该`app.use(express.static(__dirname + '/public'))`行，则回调有效。我试过改变顺序，但这就像彩票一样！我更想知道这里出了什么问题。

我确信这与我缺乏关于如何调用中间件的知识有关。有人可以帮我理解这个问题吗？

基本上，我只想在提供文件并将 index.html 加载到浏览器之前执行一些逻辑。顺便把`app.get()`前面的`app.use(express.static())`线，不成功！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-18T16:52:24.757

您的静态文件中间件应该首先使用。

```
app.use(express.static(__dirname + '/public'));
app.use(express.bodyParser());
app.use(express.cookieParser());
app.use(express.session({secret: 'secret'})); 
```

您还应该为 app.router 添加一个用途。

```
app.use(express.static(__dirname + '/public'));
app.use(express.bodyParser());
app.use(express.cookieParser());
app.use(express.session({secret: 'secret'}));
app.use(app.router); 
```

中间件按顺序处理每个请求。因此，如果您`index.html`的静态文件中有一个，那么请求`yourdomain.com/`将永远不会到达，`app.router`因为它们将由静态文件处理程序提供服务。删除`index.html`，然后该请求将流向您的`app.router`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-10-25T08:33:23.533

将您的 index.html 文件重命名为其他名称。就是这么简单

```
app.use(express.static(__dirname + '/public'));

app.get('/', function(req, res){
    if(req.session){
        console.log(req.session);
    }
    console.log('ok');
    res.sendfile(new_index_file);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-02-09T12:07:22.893

我相信，您在这里有 3 个选择：

1）在静态中间件之前挂载您的`app.get('/')`路由（可能使用`app.router`），以便它们优先。首先挂载的中间件，首先处理匹配的请求。

2）为您的静态路径使用路径前缀，例如`app.use('/static', express.static('public'));`，以便从提供静态信息`example.com/static/...`

3) 想表现得聪明一点，然后朝自己的腿开枪吗？:) 有时人们使用`Accept`标头和内容协商在不同情况下从同一个 url 提供 2 种不同的内容类型。您可以让静态中间件检查`Accept`标头中的特定内容类型并处理请求，前提是请求的`Accept`标头需要正确的类型。否则，它会将处理向下传递给您`/`查看。[您可以在req.accepts](https://expressjs.com/en/4x/api.html#req)中自定义您的静态中间件内容协商。

# ruby-on-rails - 在 rails 的子目录中引用模型

> ID：16088825
> 
> 赞同：0
> 
> 时间：2013-04-18T16:50:16.713
> 
> 标签：ruby-on-rails, ruby, model-view-controller

我正在编写一个 Rails 应用程序。

我的模型树看起来像这样：

```
models/
|-  user.rb
|-  ...
|-  forum/
  |- thread.rb
  |- forum.rb 
```

一个用户有很多线程。

当我尝试这个时：

```
has_many :forum_threads 
```

尝试引用它时出现以下错误：

```
uninitialized constant User::ForumThread 
```

但是，当我尝试这个时：

```
has_many :threads 
```

我收到以下错误：

```
undefined method `scoped' for Thread:Class 
```

我做错了什么？这可能是什么原因造成的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:26:51.523

I've managed to solve it. I only had to add a :class_name specifier to the `has_many` decleration:

```
has_many :forum_threads, class_name: 'Forum::Thread' 
```

# mysql - Laravel：是否可以使用 Fluent 或 Eloquent 进行联合查询？

> ID：16088827
> 
> 赞同：1
> 
> 时间：2013-04-18T16:50:19.047
> 
> 标签：mysql, laravel, fluent, eloquent

我有一个复杂的联合查询，我想使用 Laravel 的 Fluent 查询构建器或 Eloquent 将它从 MS SQL 转换为 MySQL（只是猜测只有 Fluent 可以处理它）。另一种选择是简单地给我们一个 DB Raw 查询，但这似乎不是很 Laravelish。

我这样做是作为重复事件引擎的一部分，以将过去的事件历史表与保存重复模式的期货表连接起来。如果你有兴趣，这里是查询。

```
qry = "SELECT clients.p_client_id,contacts.last_name, contacts.first_name, "
qry = qry & "resource_information.last_name as res_last_name, resource_information.first_name as res_first_name, "
qry = qry & "assets.d_name, "
qry = qry & "services.service_name, " 
qry = qry & "service_recurring.id, service_recurring.client_id, service_recurring.partner_id, "
qry = qry & "service_recurring.asset_id, service_recurring.resource_id, service_recurring.service_id, "
qry = qry & "service_recurring.begin_on, service_recurring.window_beg, "
qry = qry & "service_recurring.window_end, service_recurring.rate, "
qry = qry & "service_recurring.discount, service_recurring.res_cost, service_recurring.recurring, service_recurring.id as schedule_id  "
qry = qry & "FROM service_recurring "
qry = qry & "INNER JOIN clients ON service_recurring.client_id = clients.id "
qry = qry & "INNER JOIN contacts ON service_recurring.client_id = contacts.client_id "
qry = qry & "AND contacts.primary_contact = 1 "
qry = qry & "INNER JOIN assets ON service_recurring.asset_id = assets.id "
qry = qry & "INNER JOIN resource_information ON service_recurring.resource_id = resource_information.id "
qry = qry & "INNER JOIN services ON service_recurring.service_id = services.id "
qry = qry & "WHERE service_recurring.partner_id = '" & partner_id & "' "
qry = qry & "AND NOT EXISTS (SELECT * FROM service_recurring_exception WHERE rid = service_recurring.id AND exception_date = '" & thisDate & "' AND pid = '" & partner_id & "') "
qry = qry & "AND service_recurring.begin_on <= '" & thisDate & "' "
qry = qry & "AND (service_recurring.end_on >= '" & thisDate & "' OR service_recurring.end_on is null) "
qry = qry & todayis
qry = qry & "UNION "
qry = qry & "SELECT clients.p_client_id,contacts.last_name, contacts.first_name, "
qry = qry & "resource_information.last_name as res_last_name, resource_information.first_name as res_first_name, "
qry = qry & "assets.d_name, "
qry = qry & "services.service_name, "
qry = qry & "service_history.id, service_history.client_id, service_history.partner_id, "
qry = qry & "service_history.asset_id, service_history.resource_id, service_history.service_id, "
qry = qry & "service_history.begin_on, service_history.window_beg, "
qry = qry & "service_history.window_end, service_history.rate, "
qry = qry & "service_history.discount, service_history.res_cost, service_history.recurring, service_history.id as schedule_id  "
qry = qry & "FROM service_history "
qry = qry & "INNER JOIN clients ON service_history.client_id = clients.id "
qry = qry & "INNER JOIN contacts ON service_history.client_id = contacts.client_id "
qry = qry & "AND contacts.primary_contact = 1 "
qry = qry & "INNER JOIN assets ON service_history.asset_id = assets.id "
qry = qry & "INNER JOIN resource_information ON service_history.resource_id = resource_information.id "
qry = qry & "INNER JOIN services ON service_history.service_id = services.id "
qry = qry & "WHERE service_history.begin_on = '" & thisDate & "' AND service_history.partner_id = '" & partner_id & "' "
qry = qry & "AND service_history.delete_r <> 1 "
qry = qry & "ORDER BY res_last_name, d_name" 
```

# html - background-color 属性不占用整个 li

> ID：16088828
> 
> 赞同：1
> 
> 时间：2013-04-18T16:50:19.223
> 
> 标签：html, navigationbar

我有这个 HTML5 代码：

```
<div id = 'nav'>
    <ul>
        <a href = ''>
            <li>HOME</li>
        </a>
        <a href = ''>
            <li class = 'final_nav'>FAQ</li>
        </a>
    </ul>
</div> 
```

这个 CSS 样式表：

```
#nav {
    border: 1px solid #000;
    padding: 5px;
    background-color: #E5E5E5;
}
#nav li {
    border-left: 1px solid #000;
    padding: 22px;
    display: inline;
}
#nav li:hover{
    background-color: #A9A9A9;
}
.final_nav {
    border-right: 1px solid #000;
}
#nav a {
    display: inline-block;
}
#nav a:hover {
    text-decoration: none;
} 
```

但是当我将鼠标悬停在 a 上时`nav li`，该`the background-color: #A9A9A9`属性无法按我的意愿工作： ![在此处输入图像描述](https://i.stack.imgur.com/rJMjd.png)

如何更改 CSS 以使深灰色背景占据整个`li`而不是边框​​？
谢谢

**编辑**：

抱歉，我意识到这段代码单独运行时可以完美运行，但是当我包含父 div 时，代码会产生上述错误。这是整个标题代码：

HTML：

```
<div id = 'header'>
    <h1>CONTEST CODING</h1>
    <p>The free programming competition for everyone</p>
    <div id = 'nav'>
        <ul>
            <a href = ''>
                <li>HOME</li>
            </a>
            <a href = ''>
                <li class = 'final_nav'>FAQ</li>
            </a>
        </ul>
    </div>
</div> 
```

CSS：

```
body {
    margin: auto;
    width: 960px;
    font-family: Helvetica, sans-serif;
    font-size: 16px;
}
#header {
    text-align: center;
}
#nav {
    border: 1px solid #000;
    padding: 5px;
    background-color: #E5E5E5;
}
#nav li {
    border-left: 1px solid #000;
    padding: 22px;
    display: inline;
}
#nav li:hover{
    background-color: #A9A9A9;
}
.final_nav {
    border-right: 1px solid #000;
}
#nav a:hover {
    text-decoration: none;
} 
```

现在有人可以帮我解决我的`background-color`问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:58:39.490

由于您`display: inline;`在`<li>`项目上使用，因此 HTML 中它们之间的空格（或换行符）被呈现为好像所有文本一样。

如果您将 HTML 更改为在 之间没有空格`<li>`并将 也放在`<a>`内部`<li>`，则背景颜色应在悬停时填充每个项目。

```
<div id = 'nav'>
    <ul>

            <li><a href = ''>HOME</a></li><li class = 'final_nav'><a href = ''>FAQ</a></li>

    </ul>
</div> 
```

看到这个[代码笔](http://codepen.io/anon/pen/fvIiL)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:14:02.513

据我所知，`<li>`在 ancor 标签中包装元素并不是最好的方法。这是相反的方式。如果你切换它，那么你所有的 CSS 都可以正常工作。

```
<div id = 'nav'>
    <ul>
        <li>
            <a href = ''>HOME</a>
        </li>
        <li class="final_nav">
            <a href = ''>FAQ</a>
        </li>
    </ul>
</div> 
```

[JSFiddle](http://jsfiddle.net/DJDavid98/xZQ6E/)

# sas - 在文件引用中使用通配符生成授权不足消息

> ID：16088833
> 
> 赞同：0
> 
> 时间：2013-04-18T16:50:27.090
> 
> 标签：sas

是否存在 SAS 系统选项、配置参数或其他可能禁止在 fileref 中使用通配符的方案？以下代码有效：

```
FILENAME THEFILE "/sasrep/POC/UNGMPW.PRO" ;
data _null_;
    infile thefile;
    input;
run; 
```

而下面的代码：

```
FILENAME THEFILE "/sasrep/POC/UNGMP?.PRO" ;
data _null_;
    infile thefile;
    input;
run; 
```

生成此错误消息：

```
ERROR: Insufficient authorization to access /sasrep/POC/UNGMP?.PRO. 
```

这是在 UNIX 上使用 SAS 9.1.3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T09:26:42.943

我认为为了使用通配符将多个文件分配到一个文件引用中，您需要将文件括在括号中......例如

```
文件名多 ("myfiles*.txt")
```

# dataset - 使用 ODBC 将 MAINFRAME 上的 SAS 连接到另一个数据库

> ID：16088839
> 
> 赞同：0
> 
> 时间：2013-04-18T16:50:51.153
> 
> 标签：dataset, odbc, sas, mainframe

我的公司在大型机上安装了 SAS 9.1。主机也有 SAS/CONNECT 和 SAS/SHARE。

目前，我们使用 9.1 SAS for PC 连接到 Sybase 数据库（通过 ODBC 连接），然后我们将提取的数据上传到 SAS 大型机。

是否可以通过 ODBC 将大型机连接到另一个数据库？我们正在尝试将大型机连接到 Sybase Replication 数据库。Sybase 数据库当前位于 Unix 服务器中。

有谁知道我们正在尝试做的事情是否可行？如果是这样，任何见解都会很棒！

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:59:04.173

您似乎无法在大型机或 Unix 服务器上使用 ODBC。

[http://www.sas.com/offices/europe/uk/support/sas-hints-tips/ht1.html](http://www.sas.com/offices/europe/uk/support/sas-hints-tips/ht1.html)

您可能需要联系您的 SAS 代表以确认这没有改变（或者总体上没有错误）。如果可以在大型机上使用 ODBC，您需要获得许可，因此您的 SAS 销售代表应该能够告诉您这是否可行。

# jsf - java.lang.NoClassDefFoundError：无法初始化类 org.omnifaces.config.WebXml

> ID：16088840
> 
> 赞同：2
> 
> 时间：2013-04-18T16:50:57.520
> 
> 标签：onmifaces, jsf, omnifaces

我最近在我的 pom 中添加了omnifaces 1.4.1 以使用一些转换器。

```
 <dependency>
    <groupId>org.omnifaces</groupId>
    <artifactId>omnifaces</artifactId>
    <version>1.4.1</version>
</dependency> 
```

现在，对应用程序的每个请求都会引发一个异常，该异常开始于

```
java.lang.NoClassDefFoundError: Could not initialize class org.omnifaces.config.WebXml 
```

我正在使用的 omnifaces.SelectItemsIndexConverter 工作正常，但是每个请求都会引发此异常；即使在不包含[onmifaces](/questions/tagged/onmifaces "显示标记为“onmifaces”的问题")组件的页面上。

我的环境如下：

*   雄猫 7.0.37
*   莫哈拉 2.1.10
*   PrimeFaces 3.4.2
*   PrimeFaces 扩展 0.6.1

除了添加到 pom 之外，是否还需要一些额外的设置？

```
Apr 18, 2013 11:35:06 AM org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [Faces Servlet] in context with path [/MyApp] threw exception [Servlet execution threw an exception] with root cause
java.lang.NoClassDefFoundError: Could not initialize class org.omnifaces.config.WebXml
    at org.omnifaces.context.OmniPartialViewContext$OmniPartialResponseWriter.startDocument(OmniPartialViewContext.java:253)
    at org.primefaces.context.PrimePartialResponseWriter.startDocument(PrimePartialResponseWriter.java:133)
    at com.sun.faces.context.AjaxExceptionHandlerImpl.handlePartialResponseError(AjaxExceptionHandlerImpl.java:199)
    at com.sun.faces.context.AjaxExceptionHandlerImpl.handle(AjaxExceptionHandlerImpl.java:123)
    at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:119)
    at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
    at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.primefaces.webapp.filter.FileUploadFilter.doFilter(FileUploadFilter.java:79)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:311)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:116)
    at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:101)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:113)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.rememberme.RememberMeAuthenticationFilter.doFilter(RememberMeAuthenticationFilter.java:146)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:45)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:150)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:182)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:87)
    at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:323)
    at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:173)
    at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.springframework.orm.hibernate3.support.OpenSessionInViewFilter.doFilterInternal(OpenSessionInViewFilter.java:198)
    at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:936)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1004)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:589)
    at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
    at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:09:15.830

> java.lang.NoClassDefFoundError：无法初始化类 org.omnifaces.config.WebXml

当[配置枚举](http://omnifaces.org/docs/javadoc/current/org/omnifaces/config/WebXml.html)在初始化期间未能解析 webapp 的和/或(s) 时[，就会发生这种情况。`WebXml`](http://omnifaces.org/docs/javadoc/current/org/omnifaces/config/WebXml.html)然而，这应该引发一个运行时异常。我会检查它为什么被吞下。它可能是 Tomcat 特定的。`web.xml``web-fragment.xml`

至于在您的特定情况下引发的运行时异常，

> java.lang.ClassNotFoundException: avax.faces.application.ViewExpiredException

这表明你有类似的`web.xml`东西：

```
<error-page>
    <exception-type>avax.faces.application.ViewExpiredException</exception-type>
    ...
</error-page> 
```

虽然它真的应该是[`javax.faces.application.ViewExpiredException`](http://docs.oracle.com/javaee/6/api/javax/faces/application/ViewExpiredException.html)。相应地修复它，然后`WebXml`将成功解析`web.xml`.

# php - Zend Framework - 整数验证器

> ID：16088845
> 
> 赞同：0
> 
> 时间：2013-04-18T16:51:31.077
> 
> 标签：php, zend-framework

Zend Framework 似乎有一个验证整数的功能（为此目的检查了库中的 /Validate/Int.php），它可以正确地将浮点数验证为整数，而我想在给出浮点数时显示错误。

这是我的表单中的一个片段：

```
 $form['my_int'] = new Zend_Form_Element_Text('my_int');
  $form['my_int']->setLabel('My Int')
                 ->setRequired(true)
                 ->addFilter('StringTrim')
                 ->addDecorator('Errors', array('placement'=>'prepend', 
                                                'class'=>'my-err'))
                 ->addValidator('NotEmpty', true, array('messages' => 
                     array('isEmpty' => 'Please provide data')))
                 ->addValidator('int', true, array(
                     'locale' => 'en_US', 
                     'messages' => array(
                          'intInvalid' => 'Please provide valid data',
                          'notInt' => 'Please provide valid data'
                     )
                 )); 
```

因此，当我提供不同于字符串、整数或浮点数的内容时，会触发“intInvalid”错误并显示我的自定义消息。当提供像 1.23 这样的浮点数时，会显示“notInt”错误。问题是当您提供例如 1.00 时，验证器会检查“！Zend_Locale_Format::isInteger($value, array('locale' => $this->_locale))”并确定输入是整数并且当您尝试在数据库中的整数字段中添加浮点数，您会得到错误。

我应该如何组织我的表单验证，以便在提供浮点数时，无论如何，向用户显示错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T19:07:07.800

您应该将 Int 过滤器添加到该元素。

```
$element->addFilter(new Zend_Filter_Int()); 
```

# python - 如何翻译动态表单选择

> ID：16088849
> 
> 赞同：1
> 
> 时间：2013-04-18T16:51:43.480
> 
> 标签：python, django, python-2.7, django-i18n

我正在使用相同的表格并更改选择。

所有选项都有翻译。

我需要在表格中指定一些内容吗？

# 表格.py

```
class QuestionForm(forms.Form):
    selection = forms.ChoiceField(widget=forms.RadioSelect()) 
```

# 视图.py

```
from django.utils.translation import ugettext as _
form = QuestionForm(request.POST)
choices = [(_(i.choice), i.choice) for i in question.choices.all()]
form.fields['selection'].choices = choices 
```

# 模板

```
<form method="post">{% csrf_token %}
    {{ form.selection }}
    <input type="submit" value="Submit" class="btn"/>
</form> 
```

我试过

```
{% trans form.selection %} 
```

但得到了错误”

```
'BoundField' object has no attribute 'replace' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:59:33.530

`(_(i.choice), i.choice)`顺序错误，您将看不到翻译。这是显示的**第二个**项目，因此您希望拥有：`(i.choice, _(i.choice))`.

* * *

此外，如果您想要一个动态表单，您应该使用表单工厂创建一个动态表单。

创建表单后不要使用它。

在您的代码中的某处：

```
def make_question_form_class(question):
     choices = [(_(i.choice), i.choice) for i in question.choices.all()]

     class _QuestionForm(forms.Form):
         selection = forms.ChoiceField(choices = choices, widget=forms.RadioSelect())

     return _QuestionForm 
```

在您看来：

```
form_class = make_question_form_class(question)
form = form_class(request.POST) 
```

* * *

有关更多可能性，请参阅[James Bennett 本人的这篇文章！](http://www.b-list.org/weblog/2008/nov/09/dynamic-forms/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T17:07:21.070

翻译需要在模板渲染时进行。为此，您需要在运行时设置正确的语言（如何实现这一点取决于代码运行的确切上下文）：

```
choices = [(_(i.choice), i.choice) for i in question.choices.all()] 
```

或者改为使用`ugettext_lazy`，它不会翻译选项，而是将翻译推迟到渲染时间：

```
from django.utils.translation import ugettext_lazy as _
choices = [(_(i.choice), i.choice) for i in question.choices.all()] 
```

在模板中，始终使用：

```
<form method="post">{% csrf_token %}
    {{ form.selection }}
    <input type="submit" value="Submit" class="btn"/>
</form> 
```

`form.selection`对象是对象，`BoundField`不能直接翻译。

# sql-server-2008 - 将数字附加到以 0 开头的字符串前面

> ID：16088850
> 
> 赞同：1
> 
> 时间：2013-04-18T16:51:43.913
> 
> 标签：sql-server-2008, tsql, append, prefix

如何正确用“M”替换第一个字符？假设您有一个 PATIENT_ID_NONNUM = 'M001'，我们想要 1001 作为结果。

```
UPDATE [HIMC_I2B2_LZ-PROD].[dbo].[I2B2_SRC_BIOMETRICS]
SET PATIENT_ID = CONVERT(NUMERIC(22,0),'1' + CONVERT(NVARCHAR(50),PATIENT_ID))
WHERE SUBSTRING(PATIENT_ID_NONNUM, 1, 1) = 'M' 
```

编辑：

```
UPDATE [HIMC_I2B2_LZ-PROD].[dbo].[I2B2_SRC_MEDICATION]
SET PATIENT_ID = CONVERT(NUMERIC(22,0),CONVERT(NVARCHAR(50),'1') + CONVERT(NVARCHAR(50),SUBSTRING(PATIENT_ID_NONNUM, 2, LEN(PATIENT_ID_NONNUM))))
WHERE SUBSTRING(PATIENT_ID_NONNUM, 1, 1) = 'M' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T19:06:34.350

我发现[`STUFF()`](http://msdn.microsoft.com/en-us/library/ms188043.aspx)（一个经常被忽视的功能）并且`LEFT()`更具可读性，但其他人可能不同意：

```
UPDATE [HIMC_I2B2_LZ-PROD].[dbo].[I2B2_SRC_BIOMETRICS]
SET PATIENT_ID = CAST(STUFF(PATIENT_ID_NONNUM, 1, 1, '1') AS NUMERIC(22,0))
WHERE LEFT(PATIENT_ID_NONNUM, 1) = 'M' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:02:11.777

我会建议这样的事情：

```
UPDATE [HIMC_I2B2_LZ-PROD].[dbo].[I2B2_SRC_BIOMETRICS]
SET PATIENT_ID = CAST(('1' + SUBSTRING(PATIENT_ID_NONNUM, 2, LEN(PATIENT_ID_NONNUM) - 1)) AS NUMERIC(22,0))
WHERE SUBSTRING(PATIENT_ID_NONNUM, 1, 1) = 'M' 
```

这将找到第一个字符所在的所有记录，并将第一个字符`M`替换为`1`. 我没有对此进行测试，但我相信它应该可以正常工作。

我还建议不要在生产数据库上运行这种类型的操作作为测试，我认为这是`-PROD`您的目录名称中的代表。

编辑：由于此查询以 NUMERIC(22,0) 形式出现的 PATIENT_ID 似乎很重要，因此我添加了必要的 CAST。

# html - 如何使用短网址嵌入谷歌地图

> ID：16088852
> 
> 赞同：1
> 
> 时间：2013-04-18T16:51:45.817
> 
> 标签：html, google-maps, iframe, google-maps-api-3

我有一张针对不同地方的简短谷歌网址表，例如，

```
ID|URL
------
1|http://goo.gl/maps/7nps
2|http://goo.gl/maps/wZlPp 
```

取决于 URL 中的参数我需要在浏览器中显示该位置的嵌入式地图。

因此，要嵌入第二张地图，我使用谷歌给我的 iframe html 脚本：

```
<iframe width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://maps.google.com/?ie=UTF8&amp;t=h&amp;ll=40.408791,-3.692586&amp;spn=0.002859,0.00456&amp;z=17&amp;output=embed"></iframe><br /><small><a href="http://maps.google.com/?ie=UTF8&amp;t=h&amp;ll=40.408791,-3.692586&amp;spn=0.002859,0.00456&amp;z=17&amp;source=embed" style="color:#0000FF;text-align:left">View Larger Map</a></small> 
```

它有效，但它使用长网址：[http ://maps.google.com/?ie=UTF8&t=h&ll=40.408791,-3.692586&spn=0.002859,0.00456&z=17&output=embed](http://maps.google.com/?ie=UTF8&t=h&ll=40.408791,-3.692586&spn=0.002859,0.00456&z=17&output=embed)

当我尝试用较短的链接替换它时，它不起作用：

```
<iframe width="425" height="350" frameborder="0" scrolling="no" marginheight="0" marginwidth="0" src="http://goo.gl/maps/wZlPp"></iframe><br /> 
```

怎么可能在那里使用短链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:01:32.650

当您查看开发人员控制台时，您会得到如下信息：

```
Load denied by X-Frame-Options: https://maps.google.com/?ie=UTF8&ll=48.858151,2.293611&spn=0.00648,0.021973&t=h&z=16 does not permit cross-origin framing. 
```

所以问题是[同源策略](https://en.wikipedia.org/wiki/Same_origin_policy)。在这种情况下，不能使用短链接。

# php - 从第三方域设置 cookie

> ID：16088854
> 
> 赞同：1
> 
> 时间：2013-04-18T16:51:49.430
> 
> 标签：php, javascript, web-applications

所以基本上，我正在尝试构建一个简单的跟踪器作为学习跟踪器如何工作的方法。我偶然发现了我的第一个问题。场景是这样的：

*   **域 A**，从域 B 加载 JS（跟踪器）
*   **域 B**，托管跟踪器和后端

用户加载域A，JS加载成功。域 B 向用户发送 Set-Cookie（名称、值、路径、到期）请求，用户接收它（我检查了它）。但是，它实际上并没有在浏览器中设置 cookie。我尝试做同样的事情，但所有内容都在同一个域中并且有效，所以问题是它们是不同的域。

最好的解决方法是什么？使用 iframe，也许？从JS读取服务器响应设置cookie？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:35:59.857

把这个扔到你的 http 标头中

```
P3P CP="NOI COR NID CUR OUR NOR" 
```

P3P是关键，其余是价值

你可能想复习一下 P3P 实际上是什么 [http://www.w3.org/P3P/](http://www.w3.org/P3P/)

或者只是谷歌“P3P”

在这个线程中，他们说 P3P 已经死了..但它仍然可以在 IE 上运行。不知道 chrome & FF 在这个问题上的立场。 [对 p3p 策略编辑器有什么建议吗？](https://stackoverflow.com/questions/7712327/any-recommendation-for-p3p-policy-editor)

# java - 为什么java Iterator接口应该实现为内部类？

> ID：16088860
> 
> 赞同：9
> 
> 时间：2013-04-18T16:52:02.220
> 
> 标签：java, iterator, inner-classes

我最近读了一本书“Java 教程”第 3 版。如图所示，它讨论了内部类的实现。

在第 3 段中，它说“Stack 类本身不应该实现 Iterator 接口，因为......”。

我找不到任何 Stack 类不应该实现 Iterator 的原因。给出的理由并不普遍。

你能解释一下吗？

![内部类](https://i.stack.imgur.com/Wb3go.png) ![内部类](https://i.stack.imgur.com/rjyGo.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-18T16:56:31.997

从根本上说，迭代器是有状态的——它需要知道*它*在集合中指向的位置。这不属于集合本身的一部分——给出的解释是正确的……完全有可能有两个独立的迭代器对象，迭代同一个集合对象。如果集合本身实现了 Iterator 接口，您将如何建模？这是*可能*的（例如，创建一个集合的新实例，该实例又持有对原始集合的引用），但这真的很难看。

这里有单独的问题：

*   数据的收集
*   位于集合中的光标

单独的关注点=>单独的类。

说服自己这一点的最简单方法可能是尝试实现自己的集合 - 然后拥有多个迭代器。例如，您可能想尝试：

```
List<String> foo = new MyListImplementation<String>();
foo.add("a");
foo.add("b");

// The enhanced for loop uses Iterable/Iterator for non-arrays
for (String x : foo) {
    for (String y : foo) {
        System.out.println(x + " " + y);
    }
} 
```

那*应该*打印出来：

```
a a
a b
b a
b b 
```

尝试在没有两个类的情况下实现它，看看你是怎么做的，记住关注点分离。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-18T16:58:02.967

堆栈不应该实现 Iterator 本身，因为那样您一次只能有一个迭代器，并且迭代堆栈会更改堆栈。

对于后一个问题，请注意嵌套类有一个“currentItem”字段。该字段需要在“堆栈”中，并且在调用 next() 时会更改。迭代集合不应该改变集合。

第一个问题更严重：假设两个人在堆栈上进行迭代（或者一个方法希望在堆栈上创建两个迭代器）。然后如果`iterator()`返回`this`，这两个迭代器将是同一件事。召唤`next()`一个会移动另一个。混乱。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T16:55:37.203

A`Stack`不能是它自己的`Iterator`，因为 Stack 支持多个 Iterator。

您可能希望多次迭代堆栈。这些迭代可能发生在不同的时间，甚至是同一时间。同时多次迭代显然需要多个对象。不同时间的多次迭代需要多个对象，因为 Iterator 接口不支持返回起点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-18T16:59:09.577

我能想到的原因有两个。

### 多种*类型*的迭代器

您可能需要以不同方式迭代的多种类型的迭代器。例如，前向迭代器和后向迭代器（从容器的末尾迭代到开头）。

### 迭代器的多个*实例*

如果你有一个多遍算法和/或嵌套循环，每个循环可能需要它自己的迭代器来跟踪它在容器中的位置，独立于其他迭代器。

* * *

`Iterator`使用类中实现的接口来支持这些功能即使不是不可能也很困难`Stack`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-31T21:10:30.807

只是为了补充讨论，内部类将有权访问 Stack 类的私有数据，因此通过这种方式，Stack 类将设法处理客户端程序员一个对象或多个对象（迭代器和仍然这些对象将能够访问该类并提供对集合的单独迭代。

# macos - opencv 在 mac osx 中不显示视频

> ID：16088862
> 
> 赞同：1
> 
> 时间：2013-04-18T16:52:07.017
> 
> 标签：macos, opencv, video

我刚刚用 OSX 10.8.3 在我的 Mac 上安装了 opencv，我用 brew 安装了它：

```
brew install opencv 
```

版本是 2.4.3

```
>>> ls /usr/local/Cellar/opencv
2.4.3 
```

我尝试显示视频。格式是.asf，编解码器是MJPG（我只能用VLC打开，看截图）

帧数（如果在 opencv 中打印出来或在 VLC 中看到）是相同的。

但是如果我运行 opencv 程序，只显示第一帧。另一个不是..为什么？

这是opencv代码

```
#include <iostream> 
#include <string> 
#include <sstream>

#include <opencv2/core/core.hpp> 
#include <opencv2/imgproc/imgproc.hpp> 
#include <opencv2/highgui/highgui.hpp> 

using namespace std;
using namespace cv;

int main(int argc, char *argv[]) {

    Mat frame;
    int numframe = 0;

    if (argc != 2) {
        cout << "Not enough parameters" << endl;
        return -1;
    }

    const string source = argv[1];
    VideoCapture capture(source);
    namedWindow("video", CV_WINDOW_AUTOSIZE);

    if (!capture.isOpened()) {
        cout  << "Could not open " << source << endl;
        return -1;
    }

    for(;;) {
        capture >> frame;
        numframe++;
        if (frame.empty()) {
            cout << "frame empty.." << endl;
            break;
        }
        cout << numframe << endl;
        imshow("video", frame);
    }

    return 0;
} 
```

![在此处输入图像描述](https://i.stack.imgur.com/2QeK7.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:42:18.757

尝试在启用 FFMPEG 支持的情况下编译 OpenCV，以便访问更多编解码器。如果brew做不到，用brew安装ffmpeg和cmake，然后在github上抓取OpenCV的源码，重新编译。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T18:50:51.103

后：

```
imshow("video", frame); 
```

称呼：

```
waitKey(10); 
```

必须调用[`cv::waitKey()`](https://stackoverflow.com/a/5493668/176769)才能显示窗口。该参数是窗口将保持打开状态的毫秒数。此函数返回在此期间按下的键的 ASCII 码。

理想情况下，您将替换`10`为使其以正确的 FPS 显示帧的数字。换句话说：`cv::waitKey(1000 / fps);`

# hadoop - Pig map减少工作以将值放置在适当的范围内

> ID：16088863
> 
> 赞同：2
> 
> 时间：2013-04-18T16:52:07.537
> 
> 标签：hadoop, mapreduce, apache-pig

我有一个值列表作为一个数据源和第二个数据集，其中包含与一个值相关的范围。

```
Dataset 1:
3
4
6
20
25
38

Dataset 2:
1|3|A
4|10|B
11|20|C
21|30|D
31|31|E
32|38|F
39|40|G

Result:
3,A
4,B
6,B
20,C
25,D
38,F 
```

我想创建某种类型的“JOIN”来将数据集 1 中的值与数据集 2 中的字符联系起来。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T01:23:45.997

主要问题是 MapReduce 进行连接的方式要求键完全匹配，并且它在分区器中随机存储事物（默认情况下）。使用 Java MapReduce 可能有很多棘手的方法可以做到这一点。在 Pig 中我能想到的最直接的两个如下。不确定哪个会更快……这取决于数据的性质。

* * *

使用叉积：

```
C = CROSS A, B;
D = FILTER C BY $1 >= $2 AND $1 <= $3; 
```

这可能很慢！但它可以完成工作！

* * *

炸毁范围，然后加入

```
B2 = FOREACH B GENERATE FLATTEN(explode_range_udf($1, $2, $3));
C = JOIN A by $1, B2 by $1; 
```

这是您编写一个 udf 调用的地方`explode_range_udf`，它接受三个值并返回一个包含范围内每个可能元素的元组包。例如：

```
explode_range_udf(1,3,A)   ->   {(1,A),(2,A),(3,A)} 
```

`FLATTEN`对包中的每件物品进行记录。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T16:55:06.493

如果 Donald Miner 的任何一个建议对您来说足够快，我就会这样做，但为了使其更快，如果 DataSet 2 只有 250K-500K 条目，您应该能够将整个内容放入内存中。因此，您可以：编写一个将 DataSet 2 存储到内存中的 udf（`getCacheFiles`有关如何将 hdfs 文件存储到 DistributedCache 的信息，请参阅。然后编写一个`EvalFunc`采用 DataSet A 的单个项目，二进制搜索它在 DataSet 2 中的位置，并返回你想要的答案。

```
ANSWER = FOREACH DATASET1 GENERATE myBinarySearchUdf(number) 
   as myResult:Tuple(originalNumber:int, dataSet2Id:chararray); 
```

# java - 从代码创建 JAR 文件并调用函数

> ID：16088866
> 
> 赞同：0
> 
> 时间：2013-04-18T16:52:16.653
> 
> 标签：java, groovy, jar, compilation

我正在学习 Java，并且在尝试将以下代码从 Victor Angelier（[链接到 Victor 的帖子](http://victorangelier.blogspot.com/2013/02/eliptic-curve-cryptography-java-ecc.html)）转换为 Jar 文件然后从 groovy 调用其函数时遇到了麻烦。

问题是，作为 java 的新手，我不确定这些错误是否意味着我错误地构建了 .jar 以不正确地调用它。我的猜测是可能两者兼而有之。

**感谢您的耐心和帮助**

例如，当从 groovy 脚本调用 jar 中的函数时，我收到消息“groovy.lang.MissingMethodException：没有方法签名：ecencryption.ECEncryptDecrypt.Encrypt() 适用于参数类型：(java.lang.字符串）值：[1](http://victorangelier.blogspot.com/2013/02/eliptic-curve-cryptography-java-ecc.html) “

我正在采取以下步骤来创建 jar

1.  `javac ECEncryptDecrypt.java`使用包含的 apache.commons 和 bouncycastle 源创建类文件。

2.  将 .class 文件移动到名为 ecencryption 的子目录

3.  创建罐子`jar cf ECC.jar ecencryption/ECEncryptDecrypt.class`

4.  从 groovy 拨打电话，看看我是否能找到该功能

    ```
    import ecencryption.*;
    result = new ECEncryptDecrypt().Encrypt('1') 
    ```

我试图转换为 .jar 的代码：

```
/*
 * Coder: Victor Angelier
 * E-mail: vangelier@hotmail.com
 */

package ecencryption;

import java.math.BigInteger;
import java.security.*;
import java.security.interfaces.ECPrivateKey;
import java.security.interfaces.ECPublicKey;
import java.security.spec.ECFieldFp;
import java.security.spec.ECParameterSpec;
import java.security.spec.EllipticCurve;
import java.security.spec.KeySpec;
import java.security.spec.PKCS8EncodedKeySpec;
import java.security.spec.X509EncodedKeySpec;
import javax.crypto.Cipher;
import javax.crypto.KeyAgreement;
import javax.crypto.SecretKeyFactory;
import javax.crypto.spec.DESKeySpec;
import org.apache.commons.codec.binary.Base64;
import org.bouncycastle.jce.ECPointUtil;
import org.bouncycastle.util.encoders.Hex;

/**
 *
 * @author Linus
 */
public class ECEncryptDecrypt {
 KeyPairGenerator kpg;
 EllipticCurve curve;
 ECParameterSpec ecSpec;
 KeyPair aKeyPair;
 KeyAgreement aKeyAgree;
 KeyPair bKeyPair;
 KeyAgreement bKeyAgree;
 KeyFactory keyFac;

 public ECEncryptDecrypt(){
  try{
   this.kpg = KeyPairGenerator.getInstance("ECDH", "BC");     
   this.curve = new EllipticCurve(
     new ECFieldFp(
      new BigInteger(
       "883423532389192164791648750360308885314476597252960362792450860609699839")), // q
     new BigInteger(
      "7fffffffffffffffffffffff7fffffffffff8000000000007ffffffffffc",
      16), // a
     new BigInteger(
      "6b016c3bdcf18941d0d654921475ca71a9db2fb27d1d37796185c2942c0a",
      16) //b
    );

   this.ecSpec = new ECParameterSpec(
     curve,
     ECPointUtil.decodePoint(
      curve,
      Hex.decode("020ffa963cdca8816ccc33b8642bedf905c3d358573d3f27fbbd3b3cb9aaaf")), // G
     new BigInteger(
      "883423532389192164791648750360308884807550341691627752275345424702807307"), // n
      1); // h

   this.kpg.initialize(ecSpec, new SecureRandom());
   GenerateKeyPair();

  }catch(Exception err){
   log(err.toString());
  }
 }

 public void GenerateKeyPair(){
  try
  {
   //
   // a side
   //
   aKeyPair = this.kpg.generateKeyPair();
   aKeyAgree = KeyAgreement.getInstance("ECDH", "BC");
   aKeyAgree.init(aKeyPair.getPrivate());

   //
   // b side
   //   
   bKeyPair = this.kpg.generateKeyPair();
   bKeyAgree = KeyAgreement.getInstance("ECDH", "BC");
   bKeyAgree.init(bKeyPair.getPrivate());

   aKeyAgree.doPhase(bKeyPair.getPublic(), true);
   bKeyAgree.doPhase(aKeyPair.getPublic(), true);
  }
  catch(Exception err){
   log(err.toString());
  }
 }

 public void log(String data){
  System.out.println(data);
 }

 public String Encrypt(byte[] data){
  try
  {

   log(Base64.encodeBase64String(bKeyAgree.generateSecret()));
   log(Base64.encodeBase64String(aKeyAgree.generateSecret()));

   BigInteger k1 = new BigInteger(aKeyAgree.generateSecret());
   BigInteger k2 = new BigInteger(bKeyAgree.generateSecret());
   if (!k1.equals(k2)) {
    log(" 2-way test failed");
   }

   byte[] aBys = aKeyAgree.generateSecret(); 
   KeySpec aKeySpec = new DESKeySpec(aBys);
   SecretKeyFactory aFactory = SecretKeyFactory.getInstance("DES");
   Key aSecretKey = aFactory.generateSecret(aKeySpec);

   Cipher aCipher = Cipher.getInstance(aSecretKey.getAlgorithm());   
   aCipher.init(Cipher.ENCRYPT_MODE, aSecretKey);  
   byte[] encText = aCipher.doFinal(data);

   log(Base64.encodeBase64String(encText));
   return Base64.encodeBase64String(encText);
  }
  catch(Exception err){
   log(err.toString());
   return "";
  }
 }

 public String Decrypt(byte[] data){
  try
  {
   byte[] bBys = bKeyAgree.generateSecret(); 
   KeySpec bKeySpec = new DESKeySpec(bBys);
   SecretKeyFactory bFactory = SecretKeyFactory.getInstance("DES");
   Key bSecretKey = bFactory.generateSecret(bKeySpec);

   Cipher bCipher = Cipher.getInstance(bSecretKey.getAlgorithm());   
   bCipher.init(Cipher.DECRYPT_MODE, bSecretKey);   

   byte[] decText =  bCipher.doFinal(Base64.decodeBase64(data)); 
   String text = new String(decText);
   log(text);
   return text;   
  }
  catch(Exception err){
   log(err.toString());
   return "";
  }
 }

 public void pubKeyEncodingTest(){
  try
  {
   //
   // public key encoding test
   //
   byte[] pubEnc = aKeyPair.getPublic().getEncoded();
   keyFac = KeyFactory.getInstance("ECDH", "BC");
   X509EncodedKeySpec pubX509 = new X509EncodedKeySpec(pubEnc);
   ECPublicKey pubKey = (ECPublicKey) keyFac.generatePublic(pubX509);

   if (!pubKey.getW().equals(((ECPublicKey) aKeyPair.getPublic()).getW())) {
     System.out.println(" expected " + pubKey.getW().getAffineX()
      + " got "
      + ((ECPublicKey) aKeyPair.getPublic()).getW().getAffineX());
     System.out.println(" expected " + pubKey.getW().getAffineY()
      + " got "
      + ((ECPublicKey) aKeyPair.getPublic()).getW().getAffineY());
     log("ECDH" + " public key encoding (W test) failed");
   }

   if (!pubKey.getParams().getGenerator()
    .equals(
     ((ECPublicKey) aKeyPair.getPublic()).getParams()
      .getGenerator())) {
     log("ECDH" + " public key encoding (G test) failed");
   }
  }
  catch(Exception err){
   log(err.toString());
  }
 }

 public void PrivateKeyEncodingTest(){
  try
  {
   //
   // private key encoding test
   //
   byte[] privEnc = aKeyPair.getPrivate().getEncoded();
   PKCS8EncodedKeySpec privPKCS8 = new PKCS8EncodedKeySpec(privEnc);
   ECPrivateKey privKey = (ECPrivateKey) keyFac.generatePrivate(privPKCS8);

   if (!privKey.getS().equals(
    ((ECPrivateKey) aKeyPair.getPrivate()).getS())) {
     log("ECDH" + " private key encoding (S test) failed");
   }

   if (!privKey.getParams().getGenerator().equals(
    ((ECPrivateKey) aKeyPair.getPrivate()).getParams()
     .getGenerator())) {
     log("ECDH" + " private key encoding (G test) failed");
   }
  }
  catch(Exception err){

  }
 }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:28:04.790

Encrypt 方法的签名是

```
public String Encrypt(byte[] data) 
```

您正在尝试使用字符串 '1' 调用它，因此出现错误。根据签名，您应该使用字节数组。您的调用将变为：

```
result = new ECEncryptDecrypt().Encrypt([1] as byte[]) 
```

**注意**：字符串`'1'`不会转换为字节`1`。在[ASCII](http://www.ascii.cl/) `1`中实际上转换为`49`，但我不想让你太困惑。

# c++ - codelite 5.1 找不到

> ID：16088873
> 
> 赞同：0
> 
> 时间：2013-04-18T16:52:37.313
> 
> 标签：c++, qt, include, codelite

在 Ubuntu 12.10 上使用 CodeLite 5.1：

创建了一个最小的 QTGui 应用程序。构建并**运行**良好。

```
#include <QApplication> 
#include <QButton> 
```

由向导插入到 main.cpp 文件中 - 没问题。我补充说：

```
#include <QString> 
```

根据 QT 文档，预处理器告诉我它找不到 QString。我检查了项目的包含设置 -

```
../qt4 
```

和

```
../qt4/qt4GUI 
```

是否正确。我试过：

```
#include <qt4/QString> 
```

有不同的大小写排列 - 一切都没有。

怎么了？（也发布在 CodeLite 论坛上）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T19:04:21.103

虽然`QApplication`和`QButton`是 Qt GUI 模块`QString`的一部分，但也是 Qt Core 模块的一部分。GUI 依赖于 Core，因此 Core 库已经链接，这不是问题。

问题似乎是您的包含路径仅包含 Qt 顶层以及 GUI 子目录。Qt 的头文件以模块为结构，每个模块有一个目录。这意味着`<QApplication>`和`<QButton>`头文件在`../qt4/qt4GUI`其中，因此可以被编译器找到。

但是，`QString`放置在`../qt4/qt4Core`^((1))中，因此要么包含在`#include <QtCore/QString>`^((2))中，它将在正确的模块子目录中查找，或者通过将子目录添加到项目配置中的包含路径（推荐），所以`#include <QString>`有效也。

* * *

^((1))我认为这应该是`../qt4/QtCore`，对于 Qt GUI `../qt4/QtGui`，但你在问题中写了一些不同的东西......

^((2))在 Qt 内部，其他模块的类是这样包含的，即相对于 Qt 顶级包含路径，所以如果您包含一个使用的类`QString`（`QApplication`作为一个示例），它可以在不添加另一个包含的情况下工作。

# php - PHP PDO num_rows 问题

> ID：16088874
> 
> 赞同：-1
> 
> 时间：2013-04-18T16:52:37.753
> 
> 标签：php, pdo

当我尝试使用现有帐户登录时，代码运行正常，但是当我尝试使用不存在的帐户登录时，它应该执行`else`部分和`echo`消息，但它仍然执行块中定义的`if`部分。为什么？

欢迎任何其他提示

```
$sql = "SELECT email,password,id FROM user WHERE email=? AND password=?";
$stm = $db->prepare($sql);
$stm->execute(array($email,$password));
$row = $stm->fetch(PDO::FETCH_ASSOC);
$number_of_rows = $stm->fetchColumn();

if(count($number_of_rows)==1){
    $_SESSION['id']=$row['id'];
    header('Location: cpanel/#welcome');
}else{
    echo "<font style='background-color: #F9C5CA'>Error: Your email and/or password are incorrect. Please try again.</font>";
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T16:55:54.033

`fetchColumn()`不计算行数，它会从结果集中的下一条记录中返回特定的列值（或者`false`如果您位于结果集的末尾）。如果您使用的是 MySQL，您可以使用它`rowCount()`来计算结果集中的行数（但是，此方法不支持`SELECT`跨所有数据库类型的语句）。

或者，由于您似乎只关心返回的一行，您可以简单地评估`$row`. 如果是，`false`那么您没有收到返回的记录。我可能会建议`LIMIT 1`在您的查询中添加一个显式，以便代码的读者清楚地知道查询只能返回 0 或 1 条记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T18:18:56.337

### 如果您已经拥有数据，则无需额外验证

因此，检查`$row`就足够了。但是，请求电子邮件和密码（您已经拥有）也没有任何意义。
因此，您可以使用 fetchColumn()，但不使用 fetch：

```
$sql = "SELECT id FROM user WHERE email=? AND password=?";
$stm = $db->prepare($sql);
$stm->execute(array($email,$password));
$id = $stm->fetchColumn();

if ($id) {
    $_SESSION['id']=$id;
    header('Location: cpanel/#welcome');
    exit;
} else {
    echo "<font style='background-color: #F9C5CA'>Error: Your email and/or password are incorrect.  Please try again.</font>";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T16:56:39.690

PDO 中有一个漂亮的函数，称为`rowCount()`您应该使用它，以了解您的查询是否返回任何行，在这种情况下，`1`是真还是`0`假。

你可以像这样使用它；

```
$stmt = $conn->prepare("SELECT  user, pass FROM foo WHERE username =? 
                         AND password = ?");
$stmt->execute(array($user,$pass)); 
```

现在，到计数。

```
if($stmt->rowCount() > 0){echo 'username found';}else {
echo 'wrong login details.';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T16:57:07.287

根据[文档](http://www.php.net/manual/en/pdostatement.fetchcolumn.php) `fetchColumn()`返回一个字符串，因此`count` 将始终返回`1`。你真正需要的是[`PDOStatement::rowCount`](http://www.php.net/manual/en/pdostatement.rowcount.php)：

```
$stm->rowCount(); 
```

# python - 将 htaccess 设置转换为 BaseHTTPServer 设置

> ID：16088875
> 
> 赞同：0
> 
> 时间：2013-04-18T16:52:39.007
> 
> 标签：python, .htaccess, iframe, basehttpserver

所以我想要做的是允许用户在他们的网站上嵌入图像，然后该图像会自动替换为带有按钮的 iframe。原因是为了方便用户避免在不允许的网络上使用 js 或其他代码。

这在带有 PHP 的 apache 中是可能的，但是在 python 中执行此操作的方法对我来说并不是特别明显。

原始htaccess： `Redirect /embed.jpg http://somesite.com/embed.php`

但是在python中，它并没有真正起作用（这个例子不起作用）。

服务器.py：

```
#!/usr/bin/env python

import BaseHTTPServer
import getopt
import socket
import sys

ADDR = ["", 8080]

def usage(f = sys.stdout):
    print >> f, "Usage: %s [ADDRESS [PORT]]" % sys.argv[0]

class Handler(BaseHTTPServer.BaseHTTPRequestHandler):
    def do_GET(self):
        if self.path == "/":
            self.send_response(200)
            self.send_header("Content-type", "text/html; charset=utf-8")
            self.end_headers()
            print >> self.wfile, """\
<!DOCTYPE html>
<body bgcolor=dodgerblue>
<img src="x.png" width=200 height=200>
</body>
"""
            return
        if self.path == "/x.png":
            self.send_response(302)
            self.send_header("Content-type", "image/png")
            self.send_header("Location", "x.html")
            self.end_headers()
            return
        if self.path == "/x.html":
            self.send_response(200)
            self.send_header("Content-type", "text/html; charset=utf-8")
            self.end_headers()
            print >> self.wfile, """\
<!DOCTYPE html>
<body bgcolor=slateblue>
Inner HTML.
</body>
"""

        self.send_response(404)
        self.send_header("Content-type", "text/html; charset=utf-8")
        self.end_headers()
        print >> self.wfile, """\
<!DOCTYPE html>
Not found.
"""

class Server(BaseHTTPServer.HTTPServer):
    allow_reuse_address = True

opts, args = getopt.gnu_getopt(sys.argv[1:], "h", ["help"])
for o, a in opts:
    if o == "-h" or o == "--help":
        usage()
        sys.exit(0)

if len(args) >= 1:
    ADDR[0] = args[0]
if len(args) >= 2:
    ADDR[1] = args[1]
if len(args) >= 3:
    usage(sys.stderr)
    os.exit(1)

server = Server(tuple(ADDR), Handler)
print "Listening on %s:%d." % (server.server_name, server.server_port)
server.serve_forever() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:07:53.833

我可以用该代码看到两个问题......

首先，这`<img src="x.png" width=200 height=200>`意味着浏览器应该期望返回图像数据，但是您将它们重定向到另一个返回 HTML 数据的 URL。

其次，我认为您在该行之前的 -block 中缺少`return`a `if`...

```
self.send_response(404) 
```

我认为在不修改 JavaScript 中的 DOM 的情况下，不可能用标签替换`<img>`标签。`<iframe>`

# forms - 内容类型表单模板

> ID：16088877
> 
> 赞同：0
> 
> 时间：2013-04-18T16:52:49.397
> 
> 标签：forms, drupal-7

我希望仅当 GET 变量在一次性密码列表中匹配时才显示 drupal 表单。也就是说，用户将通过电子邮件收到一个包含一次性密码的 drupal 表单的 URL，如果密码有效，他们可以提交到该 drupal 表单。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T03:57:53.470

我不知道你会如何调节一次性的、看似随机的 URL，但你可以创建一个带有密码字段的内容类型，然后将带有该密码的 URL 发送给任何你想访问它的人，然后插入这个在模板中：

示例网址：mysite.com/form?key=1234567

```
if(isset($_GET['key']) && $_GET['key'] == render($content['field_password'])) {
    //do whatever here
} else {
print 'You do not have access.';
} 
```

如果这还不能解决问题，请查看“一次性登录”模块，该模块允许您向您的网站发送一次登录网址，然后在一段时间后终止该帐户。

[http://drupal.org/project/login_one_time](http://drupal.org/project/login_one_time)

# matlab - 无法绘制隐式定义的曲面

> ID：16088879
> 
> 赞同：0
> 
> 时间：2013-04-18T16:52:58.537
> 
> 标签：matlab, wolfram-mathematica

我有以下功能，有点复杂：

```
 X1=Function[{r,\[Theta],l},4Re[(N[Integrate[E^(-(r^2+R^2)+2 I R l/r) (r+I R)^(2 l) 
(LaguerreL[1/2 (-l+n),l,(r^2+R^2)])^2 ,{R,-\[Infinity],\[Infinity]}]])]]; 
```

其中函数在 [Theta] 中是常数，假设该函数通过方程 X1(r, [Theta], l)=0.08 定义一个表面（或多或少是圆柱形）。

问题是我无法使用以下命令绘制它：ContourPlot3D，Mathematica 的 ListContourPlot3D，在 matlab 中我无法处理 Laguerre 广义多项式来绘制等值面 :_(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T18:31:37.830

假设*n*定义了拉盖尔多项式的阶，并且*r*是 3 维向量*(x,y,z)*的长度，我从您的方程中得到等高线图。

为了使计算更有效率，我将您的积分定义为备忘录函数：

```
fx1nl[n_, l_] := 
 fx1nl[n, l] = 
  4 Re[(N[Integrate[
       E^(-(r^2 + R^2) + 2 I R l/r) (r + I R)^(2 l) (LaguerreL[
           1/2 (-l + n), 
           l, (r^2 + R^2)])^2, {R, -\[Infinity], \[Infinity]}]])] 
```

（我不知道如何在该定义中加入对*r*的依赖，因此请改用以下 hack：

```
fx1[rp_, n_, l_] := fx1nl[n, l] /. r -> rp 
```

然后你可以继续

ContourPlot3D[ fx1[Sqrt[x^2 + y^2 + z^2], 1, 1] == 0.08, {x, 0, 1}, {y, 0, 1}, {z, 0, 1} ]

... 例如。

我没有太多运气来评估*n*和*l*的其他值的函数，所以也许你需要在去那里之前计算出这些积分。

# javascript - 对象停止所有 Javascript

> ID：16088885
> 
> 赞同：0
> 
> 时间：2013-04-18T16:53:15.417
> 
> 标签：javascript, object

学习 Javascript 并遇到一个我似乎无法解决的问题。我创建了一个对象和几个实例，并对它们做了一些 document.write。问题是，他们不会工作。进一步的问题是，它会阻止*所有*Javascript 工作。当我在一开始就放入一个 window.alert 以确保我将它链接到我的 HTML 时，这也不起作用（但是当对象被注释掉时 window.alert 确实有效）。有人愿意解释我在这里做错了什么吗？

```
window.alert("TEST!!!");

function car(seats, engine, theradio) {
this.seats = seats;
this.engine = engine;
this.theradio = theradio;
}

var work_car = new car("cloth", "V-6", "tape deck");
var fun_car = new car("leather", "V-8", "CD Player");
var engine_type = work_car.engine;
var seat_type = fun_car.seats;
var radio_type = fun_car.theradio;

document.write("I want a car with " + seat_type + " seats." <br />);
document.write("Oh, and it should have " + engine_type + " and a " + radio_type "."); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T16:56:45.227

第`<br />`一个内部`document.write`是引号之外的。即抛出错误。

另一个问题是 之后没有任何`+`迹象`radio.type`。

但是，您应该使用`console.log`而不是`document.write`.

如果你真的需要将它附加到 html 页面，你应该使用`appendChild`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T16:56:45.563

尝试使用

```
document.write("I want a car with " + seat_type + " seats.<br />");
document.write("Oh, and it should have " + engine_type + " and a " + radio_type + "."); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T16:58:22.333

您的代码中有一些语法错误。查看此类错误的最简单方法是使用大多数浏览器内置的调试控制台。例如，以下是启动 chrome 调试器的方式：

[如何在 Google Chrome 中启动 JavaScript 调试器？](https://stackoverflow.com/questions/66420/how-do-you-launch-the-javascript-debugger-in-google-chrome)

# fortran - Fortran 编译错误 - 未定义的引用

> ID：16088892
> 
> 赞同：9
> 
> 时间：2013-04-18T16:53:32.473
> 
> 标签：fortran

我正在尝试编译一个使用一堆模块的 fortran 程序。编译时出现错误，这让我发疯。该错误是由添加一个子程序引起的，并且在我尝试重新编译程序时发生：

主程序包含这两行：

--

```
call read_step(nStepOne,molOne)
call read_step(nStep,mol) 
```

--

这是调用文件“fileio.f90”中的子例程之一：

--

```
subroutine read_step(n,tape)

implicit none

integer, intent(in) :: tape
integer, intent(out) :: n

character(len=6) :: dum

rewind(tape)
read (tape,*)
read (tape,*) dum, n
rewind(tape)
return
!
end subroutine read_step 
```

--

当我尝试编译它时，会出现以下错误：

```
ifort -o SpIdMD.x *.o -static-intel -openmp 
SpIdMD.o: In function `MAIN__':
SpIdMD.f90:(.text+0x3b2): undefined reference to `read_step_'
SpIdMD.f90:(.text+0x3c5): undefined reference to `read_step_'
make: *** [SpIdMD.x] Error 1 
```

对同一模块中的子例程的其他调用没有给出任何错误，我只是看不出对“旧子例程”的调用与我刚刚创建的调用之间有任何区别。

这些“旧子程序”之一的示例，它没有给出任何抱怨，是：

在主程序中：

```
call get_dim(n_atom,nSnap,mol) 
```

在文件io.f90 中：

```
subroutine get_dim(n,n_snap,tape)

implicit none

integer,intent(in) :: tape
integer,intent(out) :: n, n_snap
integer :: m

rewind(tape)
read (tape,*,err=1,end=2) n
rewind(tape)

m = 0
do while (.true.)
   read (tape,*,err=1,end=3)
   m = m +1
end do
3   n_snap = m/(n + 2)
if (m.ne.(n_snap*(n + 2))) stop  'unexpected end of input file'

rewind(tape)

return
!
1   stop 'error in input file'
2   stop 'unexpected end of input file'
end subroutine get_dim 
```

我完全不知道为什么会出现这种行为。如果有人能帮助我解决这个噩梦，我将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-18T21:02:19.113

如果子程序 read_step 的定义在一个模块中，那么你要么忘记在主程序顶部添加该模块的 USE 语句，要么模块中的相关程序不是 PUBLIC。

对于该编译器（和其他一些），模块过程的链接器名称通常由模块名称后跟“ *mp* ”（大小写可能不同）后跟过程名称组成，并带有不同数量的前导和尾随下划线。您的链接器错误没有任何“修饰”，这表明在使用过程引用编译范围时，编译器认为该过程不是模块过程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-28T18:03:01.290

更具体地说，我将展示如何使用另一个答案中提到的 USE 和 PUBLIC 语句。

我像这样包装了我的 F77 函数：

```
 module mod
  contains
  FUNCTION FUNC(PARAM)
  ...
  END
  end module mod 
```

虽然旧代码（1986）是*大写*的，而我的代码是*小写*的。这编译得很好。您可以在和`public func`之间添加。但这似乎是默认的，所以你不需要它。`module``contains`

链接时，您需要像这样传递您的程序和库：（`gfortran -o prog prog.for mod.for`或者`.o`如果之前编译过）。

# c# - 在 asp.net mvc3 应用程序中更改密码似乎失败

> ID：16088900
> 
> 赞同：0
> 
> 时间：2013-04-18T16:53:58.347
> 
> 标签：c#, asp.net-mvc-3

我正在编程更改 asp.net mvc 3 中的密码的选项，并且我有以下用于帐户控制器的代码：

```
[Authorize]
[HttpPost]
public ActionResult CambiarContraseña(CambioContraseña model)
{
    if (ModelState.IsValid)
    {
        // ChangePassword will throw an exception rather
        // than return false in certain failure scenarios.
        bool cambioContraseñaCorrecto = true;
        try
        {
            MembershipUser usuarioActual = Membership.GetUser(User.Identity.Name, true /* userIsOnline */);
            cambioContraseñaCorrecto = usuarioActual.ChangePassword(model.ContraseñaVieja, model.ContraseñaNueva);
        }
        catch (Exception)
        {
            cambioContraseñaCorrecto = false;
        }
        if (cambioContraseñaCorrecto)
        {
            return RedirectToAction("CambioContraseñaCorrecto");
        }
        else
        {
            ModelState.AddModelError("", "La actual contraseña es inválida o la nueva contraseña es incorrecta.");
        }
    }
    // If we got this far, something failed, redisplay form
    return View(model);
} 
```

问题是 bool var "CambioContraseñaCorrecto" 总是错误的，我不明白为什么会这样。所以总是在我测试时，应用程序会向我打印 ModelStat 的消息，并且无法更改密码。有什么解决办法吗？

# zend-framework - ZF1 路由：路由参数默认值可以引用 URI 变量吗？

> ID：16088901
> 
> 赞同：0
> 
> 时间：2013-04-18T16:54:02.007
> 
> 标签：zend-framework

如果我的 application.ini 配置文件中的一条路由如下所示： resources.router.routes.internal.chains.params.type = "Zend_Controller_Router_Route" resources.router.routes.internal.chains.params.route = "/: controller/:action/:id*" resources.router.routes.internal.chains.params.defaults.controller = "index" resources.router.routes.internal.chains.params.defaults.action = "index"

有什么办法可以做这样的事情：resources.router.routes.internal.chains.params.defaults.controllerAction = :controller-:action

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T16:57:34.713

您必须在插件中执行此操作。

# javascript - 使用 Jquery 移动 div 后表单提交不起作用

> ID：16088903
> 
> 赞同：3
> 
> 时间：2013-04-18T16:54:04.583
> 
> 标签：javascript, jquery, html

我有一个 div，我在其中放置了带有提交按钮的 textarea。我需要将 textarea 放在每个帖子下，让用户发表评论。

这是我的文本区域的形状

```
<div id="textarea_wrap">
   <div id="textarea_12" class="txtarea">
   <form name="post_comment" action="reply.php" method="post"> 
   <input type="hidden" name="post_title" value="Post Title" />
   <input type="hidden" name="post_id" value="12455" />
   <textarea class="textarea" id="txt_12"></textarea>
   <input type="submit" class="button" value="Submit Comment />
   </form>
   </div>
</div> 
```

当我得到 div textarea_wrap 的 innerHtml 并使用 Jquery 将其移动到其他 div 时，它停止工作。

例如

```
 var txtarea = $("#textarea_wrap").html();
  $("#comment_10").html(txtarea); 
```

它将`textarea_wrap`div的内部html`#comment_10 div`成功移动，当我使用jquery移动div后查看源代码时，它看起来像这样

```
<div id="comment_10">
   <div id="textarea_12" class="txtarea">
   <form name="post_comment" action="reply.php" method="post"> 
   <input type="hidden" name="post_title" value="Post Title" />
   <input type="hidden" name="post_id" value="12455" />
   <textarea class="textarea" id="txt_12"></textarea>
   <input type="submit" class="button" value="Submit Comment />
   </form>
   </div>
</div> 
```

但它不起作用，当我点击“提交评论”按钮时，什么也没有发生。如果我在不通过 jquery 的情况下使用此代码，它可以正常工作。无法理解为什么它在通过 jquery 移动后不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:01:13.427

鉴于已克隆的表单与之前的名称相同，当您尝试提交表单时，这会在 DOM 中产生错误。

**建议：**每次克隆时更改表单名称。

**解决方案（jQuery）：**

*从*

```
var txtarea = $("#textarea_wrap").html();
$("#comment_10").html(txtarea); 
```

*至*

```
var txtarea = $("#textarea_wrap").html();
$("#comment_10").html(txtarea).find('form').attr('name','post_comment'+(Math.floor(Math.random()*10000))); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-18T16:59:45.120

不过不确定..检查是否可以像这样提交

```
$('.button').live('click',function({
    $('#give your form Id').submit();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-18T17:05:08.240

这可能是问题的一部分，也可能不是问题的一部分，但是您的提交按钮定义中有语法错误。记得关闭 value 属性**value="Submit Comment的引号**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T17:03:40.187

两种形式都具有相同的名称“post_comment”。表单名称应该是唯一的。

# php - PHP CURL Soap 请求打印响应

> ID：16088904
> 
> 赞同：0
> 
> 时间：2013-04-18T16:54:06.680
> 
> 标签：php, soap, curl, xmlhttprequest

您好，我正在尝试向 powerpay.biz 发送 Soap 请求，但没有收到回复，而且当我使用我的测试 URL 时

[https://gkicmerchants.com/admin/classes/soap-request.xml](https://gkicmerchants.com/admin/classes/soap-request.xml)

我得到这个错误

```
Warning: SimpleXMLElement::__construct() [simplexmlelement.--construct]: Entity: line 1: parser error : Start tag expected, '<' not found in /home/content/g/k/i/gkic1848/html/admin/classes/submit_applicant.class.php on line 299 
```

这是我的代码：

```
$username = 'user';
$password = 'password';
$credentials = $username.":".$password; 
$url = "http://gkicmerchants.com/admin/classes/soap-server.php";

$soap_request = '<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
            <soap:Body>
            ....
            </soap:Body>
            </soap:Envelope>';

$header = array(
"Content-type: text/xml;charset=\"utf-8\"",
"Accept: text/xml",
"Cache-Control: no-cache",
"Pragma: no-cache",
"SOAPAction: '".$url."'",
"Content-length: ".strlen($soap_request),
);

$curl = curl_init(); 

curl_setopt($curl, CURLOPT_HTTPAUTH, CURLAUTH_BASIC ) ; 
curl_setopt($curl, CURLOPT_USERPWD, $credentials); 
curl_setopt($curl, CURLOPT_SSLVERSION,3); 
curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, FALSE); 
curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, 2); 
curl_setopt($curl, CURLOPT_HEADER, true); 
curl_setopt($curl, CURLOPT_POST, 1); 
curl_setopt($curl, CURLOPT_POSTFIELDS, $soap_request );
curl_setopt($curl, CURLOPT_HTTPHEADER,     $header);
curl_setopt($curl, CURLOPT_FOLLOWLOCATION, 1);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
curl_setopt($curl, CURLOPT_USERAGENT, "Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)"); 
curl_setopt($curl, CURLOPT_URL, $url); 

// perform the request

$xml_result = curl_exec($curl);
// check for errors
if ($xml_result === false) {
$error_occurred = true;
}
else {

    $xml = new SimpleXMLElement($xml_result);

    print_r($xml);
} 
```

curl_setopt 选项有问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T20:09:53.690

不要在输出中包含响应标头。删除这一行：

```
curl_setopt($curl, CURLOPT_HEADER, true); 
```

# html - DIV位置绝对导致div后面的其他元素被隐藏

> ID：16088907
> 
> 赞同：0
> 
> 时间：2013-04-18T16:54:26.007
> 
> 标签：html, css

我有一个具有以下样式的 div

```
#holder{
    margin-top: 1px;
    background-color: #DCE1E5;
    position:absolute;
    left:0;
    right:0;
    display:block;
    padding:8px;
} 
```

我的问题是，我在这个 div 标签之后输入的任何元素都隐藏在 div 后面，例如

```
<div id="holder">My Stuff here of</div>
<div id="somethingelse">This will be hidden behind the top div</div> 
```

关于如何解决此问题并使其与 IE7 兼容的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:02:28.313

**位置：绝对；**从盒子模型定义的流中移除元素。任何比该**持有人**更小的元素都将被它隐藏。解决方法是不要使用**position: absolute;** 对于这种情况，因为我知道您并不真正想要可以通过此实现的目标。

我建议您花点时间了解一下什么是盒子模型：[http ://www.w3.org/TR/CSS2/box.html](http://www.w3.org/TR/CSS2/box.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:03:00.237

当您绝对定位一个元素时，它会从正常的文档流中移除并放置在您指定的位置。所有其他项目继续遵循文档的正常流程，这意味着它们中的一些可能与绝对定位元素位于同一位置。

要解决此问题，您可以采用以下两种方法之一：

不要绝对定位`#holder`。这将允许它保留在正常的文档流中并与其他元素很好地配合。

或者

提供适当的边距以使其他元素远离`#holder`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T17:14:15.670

IE7 必须为具有相对位置或绝对位置的任何元素设置 z-index 属性。

**CSS**

```
#holder{
position:absolute;
left:0;
right:0;
display:block;
padding:8px;
margin-top: 1px;
background-color: #DCE1E5;
z-index: 1;}

#somethingelse {
position: relative;
top: 40px;
z-index: 1000; 
```

}

演示在这里：http: [//jsfiddle.net/B3jZ5/2/](http://jsfiddle.net/B3jZ5/2/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-18T17:20:18.193

如果位置是绝对的，则将顶部添加到其他元素。

top : #holder 的高度

或 margin-top : #holder 元素的高度，如果 #holder 元素像 float:left 或 right 一样浮动；

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T17:02:03.213

您应该为绝对元素指定 top 和 left。 `somethingelse`元素在你的后面`holder`。

删除背景颜色以查看`#somethingelse`或为两个元素分配 z-index。然后你可以看到两个元素是重叠的。您也可以添加不透明度或使持有人位置相对。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T17:02:12.977

当您将#holder DIV 更改为具有“绝对”位置时，这意味着您将其从页面上的常规元素流中移除。因此，所有其他元素将向上流动以取代它。根据您的最终目标，可能有许多解决方案。但是，仅凭您给我们的内容，您可以通过将位置更改为“相对”来解决问题。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-18T17:01:24.543

您应该`position: relative;`在下一个 div 中尝试而不是绝对。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-18T17:01:39.727

这是一个 z 索引问题。您可以通过为各种元素分配 z-index 值来覆盖此行为。并且预先警告，IE7 为任何具有“位置”样式的元素分配 z-index 值，因此可能需要一些测试才能使其正常工作。您通常必须将 z-index 分配给父元素才能使其正常工作。

# java - Jboss 中的加载程序约束冲突

> ID：16088911
> 
> 赞同：1
> 
> 时间：2013-04-18T16:54:39.260
> 
> 标签：java, jboss, cxf

我在 JBoss 5.1.0 中运行 Web 服务客户端，我收到以下异常

```
java.lang.LinkageError: loader constraint violation: loader (instance of <bootloader>) previously initiated loading for a different type with name "javax/xml/stream/XMLStreamReader" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T17:10:53.950

这是一个类加载问题。您的应用程序包中很可能有 JDK 或 JBoss 提供的类/jar，或者您有重复的 jar/类。

# php - 正则表达式：查找所有包含标签 img 的 div 标签

> ID：16088915
> 
> 赞同：1
> 
> 时间：2013-04-18T16:55:01.683
> 
> 标签：php, regex, html-parsing

我需要查找并替换所有包含标签 img 的 div 标签，我尝试了一些没有成功的正则表达式:(这是我尝试的正则表达式的一个示例： `/(<div class="indicator"[^<]*>.*<img[^>]*>[^<]*</div>)/g` 请帮助

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:05:02.463

如果您有可能像dystroy 所说的那样嵌套div div 图像，那么它不能用正则表达式正确完成，因为它实际上不是正则语言。可能你应该使用 DOM。这是相关的： [您如何在 PHP 中解析和处理 HTML/XML？](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-xml)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:13:47.220

最好不要尝试使用 RegEx 解析 HTML，这很容易出错。使用[**DOM**](http://php.net/manual/en/book.dom.php)你可以：

```
$doc = new DOMDocument();
libxml_use_internal_errors(true);
$doc->loadHTML($html); // loads your html
$nodeList = $doc->getElementsByTagName('div');
for($i=0; $i < $nodeList->length; $i++) {
    $node = $nodeList->item($i);
    $children = $node->childNodes; 
    foreach ($children as $child) { 
       if ($child->nodeName == 'img') {
          echo "DIV tag contains IMG tag\n";
          break;
       }
    }
} 
```

# ruby-on-rails-3 - Rails 教程第 5 章练习 3 - 原来的 full_title 函数做了什么？

> ID：16088921
> 
> 赞同：4
> 
> 时间：2013-04-18T16:55:23.603
> 
> 标签：ruby-on-rails-3, rspec-rails, railstutorial.org

我对[这里](http://ruby.railstutorial.org/chapters/filling-in-the-layout#sec-layout_exercises)的第 5 章练习 3 感到困惑，它取代了对 full_title 测试助手的需求

规范/支持/实用程序.rb：

```
def full_title(page_title)
  base_title = "Ruby on Rails Tutorial Sample App"
  if page_title.empty?
    base_title
  else
    "#{base_title} | #{page_title}"
  end
end 
```

还有一个同名的 rails 辅助函数：

```
module ApplicationHelper
  # Returns the full title on a per-page basis.
  def full_title(page_title)
    base_title = "Ruby on Rails Tutorial Sample App"
    if page_title.empty?
      base_title
    else
      "#{base_title} | #{page_title}"
    end
  end
end 
```

通过创建一个应用程序助手来直接测试函数：spec/helpers/application_helper_spec.rb

```
require 'spec_helper'

describe ApplicationHelper do

 describe "full_title" do
   it "should include the page title" do
     full_title("foo").should =~ /foo/
   end

   it "should include the base title" do
     full_title("foo").should =~ /^Ruby on Rails Tutorial Sample App/
   end

   it "should not include a bar for the home page" do
     full_title("").should_not =~ /\|/
   end
  end
end 
```

这很好，它直接测试 rails 辅助函数，但我认为utilities.rb 中的完整标题函数用于 Rspec 代码。因此，为什么我们可以在utilities.rb中去掉上面的代码并替换为：

```
include ApplicationHelper 
```

我进行了交换，一切仍然有效。我期待 Rspec 代码，虽然我正在使用 rspec 函数，如下所示，但它没有：

```
it "should have the right links on the layout" do
  visit root_path
  click_link "About"
  page.should have_selector 'title', text: full_title('About Us')
  ... 
```

上面的函数调用是否总是指向实际的 rails 函数而不是 respec 函数？如果我能够消除它，它首先是为了什么？我觉得我在这里错过了一些东西。谢谢你的帮助。当我的目标是学习 Rails 时，我不明白进行更改似乎是个坏主意。

谢谢，马克

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-20T13:22:27.780

`full_title`在规范中**总是从***spec/support/utilities.rb*调用。

在用 替换代码之前`include ApplicationHelper`，`full_title`在规范中调用了*实用程序*.rb 中的函数：

```
def full_title(page_title)
  base_title = "Ruby on Rails Tutorial Sample App"
  if page_title.empty?
    base_title
  else
    "#{base_title} | #{page_title}"
  end
end 
```

通过将代码替换为

```
include ApplicationHelper 
```

要清楚，你实际上包括

```
module ApplicationHelper 
```

来自*helpers/application_helper.rb*。

This has **nothing** to do with `describe ApplicationHelper` in *spec/helpers/application_helper_spec.rb*

What really happens is that the `full_title` function from `module ApplicationHelper` is now [**mixed in** (see Mixins)](http://www.ruby-doc.org/docs/ProgrammingRuby/html/tut_modules.html) to *utilities.rb*. Hence, *utilities.rb* gains access to the function `full_title` from `module ApplicationHelper`*(helpers/application_helper.rb)*.

So, when the specs call the `full_title` function, it is called from *utilities.rb*, which is possible because the function has been mixed in via the use of `include ApplicationHelper`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-05T14:31:38.187

Unfortunately, the exercise says:

> Eliminate the need for the full_title test helper in Listing 5.29 by writing tests for the original helper method, as shown in Listing 5.41\. (You will have to create both the spec/helpers directory and the application_helper_spec.rb file.) Then include it into the test using the code in Listing 5.42.

...which is completely wrong.

Some preliminaries:

The full_title() method in app/helpers/application_helper.rb is a method that is available to regular code throughout the application--not the rspec tests. The full_title() method in spec/support/utilities.rb was added so that the rspec tests could call it.

Terminology:

**application helper** = the full_title method in app/helpers/application_helper.rb

**rspec helper** = the full_title method in spec/support/utilities.rb

Writing tests for the application helper does not eliminate the need for the rspec helper--because writing a test for one method does not magically eliminate the need for some other method. What the text should say is something like this:

> You can eliminate the need for the rspec helper, which is a duplicate of the application helper, by replacing the rspec helper with the following include statement:

```
include ApplicationHelper 
```

> For the time being, you can pretend that including a module inserts the methods in the module at the point of the include statement. The application helper happens to be defined inside a module named ApplicationHelper--open the file app/helpers/application_helper.rb and take a look.
> 
> Next, write tests for the application helper to ensure that it works correctly.

# spring-security - GWT spring安全登录

> ID：16088924
> 
> 赞同：1
> 
> 时间：2013-04-18T16:55:36.543
> 
> 标签：spring-security, gxt, gwt-mvp

我正在使用 GWT 和 MVP 以及 2.4 和 Spring 安全性来保护我的应用程序。但不想使用 JSP 登录页面（默认页面）。我想使用我的适当页面。这是我的securitydemo.xml：

logtest 是我的项目的名称，我使用 lohtest.html 像默认页面

我有这样的消息：控制台和页面消息中的访问被拒绝，例如：GWT模块'logtest'可能需要（重新）编译

如果您对这些问题有一些想法，请

```
<!-- HTTP security configurations -->
<http auto-config='true'>

    <intercept-url pattern="/logtest.html" access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <intercept-url pattern="/resources/favicon.ico" access="IS_AUTHENTICATED_ANONYMOUSLY" />

    <form-login login-page="/Logtest.html" />

    <logout logout-success-url="/logtest.html" />

    <session-management invalid-session-url="/logtest.html"

        session-authentication-error-url="/logtest.html"

        session-fixation-protection="newSession">

        <concurrency-control max-sessions="1"
            error-if-maximum-exceeded="false" />
    </session-management>
</http>

<authentication-manager alias="authenticationManager">
    <authentication-provider>
        <password-encoder hash="sha" />
        <jdbc-user-service data-source-ref="dataSource"
            users-by-username-query="
              select username,password, enabled 
              from users where username=?"

            authorities-by-username-query="
              select u.username, ur.authority from users u, user_roles ur 
              where u.user_id = ur.user_id and u.username =?  " />
    </authentication-provider>
</authentication-manager> 
```

# android - 将 2 个 ImageView 之一设置为透明/不可见，显示白屏

> ID：16088926
> 
> 赞同：0
> 
> 时间：2013-04-18T16:55:41.707
> 
> 标签：android, imageview, visibility, transparent

我是一个新手，现在已经为此工作了几天，但没有任何成功。有人的帮助将不胜感激。

我有两个 ImageView，在 Activity 中一个在另一个之后。我想让第一个（顶部的那个）不可见或透明，所以我可以在我的代码内部使用它。第二个（底部的那个）应该保持可见，以便用户可以与之交互。我尝试先将画布设置为透明，然后设置 TOP ImageVIew，这会导致屏幕显示白色，而不是在后面显示 ImageView（底部的）。有人可以请解释一下为什么会这样，并建议我用更好的方法来实现我的目的吗？提前致谢。

这是我的 .java 代码：

```
public class MainActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        final ImageView imageView = (ImageView) findViewById(R.id.imageView1);
        imageView.setVisibility(View.INVISIBLE);

        imageView.setOnTouchListener(new ImageView.OnTouchListener(){
            public boolean onTouch(View v, MotionEvent event) {
                if(event.getAction() == MotionEvent.ACTION_DOWN) {
                    Drawable imgDrawable = ((ImageView)imageView).getDrawable();
                    Bitmap mutableBitmap = Bitmap.createBitmap(imageView.getWidth(), imageView.getHeight(), Bitmap.Config.ARGB_8888);
                    Canvas canvas = new Canvas(mutableBitmap);
                    imgDrawable.draw(canvas);
                    int pixel = mutableBitmap.getPixel((int)event.getX(), (int)event.getY());
                    Log.i("PIXEL COLOR", ""+pixel);

                    int alpha = Color.alpha(pixel);
                    int red = Color.red(pixel);
                    int blue = Color.blue(pixel);
                    int green = Color.green(pixel);
                    String color = String.format("#%02X%02X%02X%02X", alpha, red, green, blue);
                    Log.i("RGB", color);

                    float[] hsv = new float[3];
                    Color.RGBToHSV(red, green, blue, hsv);
                    Log.i("HSV_H", "Hue=" + hsv[0]);
                    Log.i("HSV_H", "Saturation=" + hsv[1]);
                    Log.i("HSV_H", "Value=" + hsv[2]);
               }
               return true;
            }
        });
} 
```

}

这是我的 .xml 代码：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:scaleType="fitXY"
        android:src="@drawable/lapices" />

   <ImageView
        android:id="@+id/imageView2"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:scaleType="fitXY"
        android:src="@drawable/lapices" />

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:03:49.720

我真的不明白你想要达到什么目的。它应该存在一种更好的方式，但据我所知，如果您将 LinearLayout 转换为 RelativeLayout 并更改图像视图的顺序，它应该可以工作。

顺便说一下一些代码。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >
 <ImageView
        android:id="@+id/imageView2"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:scaleType="fitXY"
        android:src="@drawable/ic_launcher" />

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:scaleType="fitXY"
        android:visibility="invisible"
        android:src="@drawable/ic_action_search" />

</RelativeLayout> 
```

# regex - VBScript 注册。表达式在其他地方测试时不起作用

> ID：16088932
> 
> 赞同：0
> 
> 时间：2013-04-18T16:55:56.443
> 
> 标签：regex, asp-classic, vbscript

我采用了通用密码验证注册。来自 RegExr 的表达式模式，并针对字符范围对其进行了轻微修改。[在http://gskinner.com/RegExr/](http://gskinner.com/RegExr/)的同一站点上很好地测试此模式

我的问题是，当我在同一个测试字符串上的 CLASSIC ASP 脚本中使用它时，它似乎返回了错误，并且我一生都无法弄清楚为什么会这样。

据我所知，VBScript 正则表达式系统使用与 Javascript 相同的正则表达式风格，还是我的想法错了，需要修改 vbscript 的模式？

经典 ASP 中的模式和代码测试

```
Set objRegExpr = New regexp
    objRegExpr.IgnoreCase = false
    objRegExpr.Multiline = false
    objRegExpr.Global = false

    objRegExpr.Pattern = "^(?=[\x21-\x7E]*[0-9])(?=[\x21-\x7E]*[A-Z])(?=[\x21-\x7E]*[a-z])(?=[\x21-\x7E]*[\x21-\x2F|\x3A-\x40|\x5B-\x60|\x7B-\x7E])[\x21-\x7E]{8,12}$"

    str = "lA@d$awdw456"
    reMtch = objRegExpr.Test(str)
    Response.Write str & " = " & reMtch 
```

# java - 在 JTextArea 中选择文本不显示任何选择颜色

> ID：16088933
> 
> 赞同：2
> 
> 时间：2013-04-18T16:56:00.343
> 
> 标签：java, swing, jtextarea, keylistener

我有这段代码，其中 a`JTextArea`添加到 a`JFrame`中。每当用户按下`↑</kbd> key the content of the `JTextArea` should be selected.`

这是代码

```
import javax.swing.*;
import java.awt.event.KeyEvent;
import java.awt.event.KeyAdapter;

public class SelectionTest extends KeyAdapter
{
    final JTextArea jTextArea;
    public static void main(String[] args)
    {
        new SelectionTest();
    }

    SelectionTest()
    {
        JFrame jFrame=new JFrame();
        jFrame.setLocationRelativeTo(null);
        jFrame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        jTextArea = new JTextArea("Test 1-2-3");
        jTextArea.addKeyListener(this);
        jFrame.add(jTextArea);
        jFrame.pack();
        jFrame.setVisible(true);
    }

    @Override
    public void keyPressed(KeyEvent e)
    {
        if( e.getKeyCode() != KeyEvent.VK_UP ) return;
        jTextArea.selectAll();
    }
} 
```

但是我观察到按下时没有选择任何内容`↑</kbd> key, instead if I slightly change the method `keyPressed` to the following, it works.`

```
@Override
public void keyPressed(KeyEvent e)
{
    if( e.getKeyCode() != KeyEvent.VK_UP ) return;
    SwingUtilities.invokeLater(new Runnable()
    {
        @Override
        public void run()
        {
            jTextArea.selectAll();
        }
    });
} 
```

我想知道这种行为的原因。是线程问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T17:23:36.907

`JTextArea`使用箭头键移动插入符号。你可能在干扰它。这就是为什么有`invokeLater()`帮助。

此外，您必须确保组件可聚焦且具有焦点。键监听器是一个较低级别的接口。正如上面评论中已经提到的，最好使用键绑定。有关详细信息和示例，请参阅如何[使用键绑定](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。

这是一个基于使用键绑定的发布代码的示例：

```
import javax.swing.*;

import java.awt.event.ActionEvent;
import java.awt.event.KeyEvent;
import java.awt.event.KeyAdapter;

public class SelectionTest extends KeyAdapter
{
    final JTextArea jTextArea;
    public static void main(String[] args)
    {
        new SelectionTest();
    }

    SelectionTest()
    {
        JFrame jFrame=new JFrame();
        jFrame.setLocationRelativeTo(null);
        jFrame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        jTextArea = new JTextArea("Test 1-2-3");

        Action someAction = new AbstractAction() {
            public void actionPerformed(ActionEvent e) {
                jTextArea.selectAll();
            }
        };
        jTextArea.getInputMap().put(
                KeyStroke.getKeyStroke(KeyEvent.VK_UP, 0), "someAction");
        jTextArea.getActionMap().put("someAction", someAction);

        jFrame.add(jTextArea);
        jFrame.pack();
        jFrame.setVisible(true);
    }
} 
```

另请注意，如果文本区域失去焦点，它可能不会显示选择。因此，您可能需要`jTextArea.requestFocusInWindow()`在更改选择之前添加。您也可以在那里`selectAll()`选择所有文本。请参阅错误[4320295：select 和 selectAll 在 JTextArea 上不起作用以](http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4320295)获取一些详细信息。

# javascript - RadGrid 条件行回发

> ID：16088935
> 
> 赞同：1
> 
> 时间：2013-04-18T16:56:06.500
> 
> 标签：javascript, asp.net, telerik, webforms, radgrid

我在页面上有一个 RadGrid，当您单击该行时会回发，配置如下：

```
<ClientSettings EnablePostBackOnRowClick="true">
    <Selecting AllowRowSelect="true" />
    <ClientEvents OnRowClick="RowClick" />
</ClientSettings> 
```

我试图通过以下方式停止事件的传播来停止回发：

```
function RowClick(sender, e) {
    var masterTable = sender.get_masterTableView();
    var hasReport = masterTable.getCellByColumnUniqueName(e.get_item(), "HasReport").innerHTML;

    if (hasReport.trim() == "No") {
        e.get_domEvent().preventDefault();
        e.get_domEvent().stopPropagation();
    }
} 
```

但这不起作用；回发仍然发生。我有一个包含两条记录的网格，只有当字段的值为“是”时，我才需要它回发，但我无法让它工作。我确信它达到了 no 条件，但即使在停止传播之后，事件仍然会触发。知道如何停止回发吗？我不能使用 RowSelecting 因为它永远不会触发，因为我在行点击时发回消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T18:50:23.657

删除 EnablePostBackOnRowClick - 将其设置回 false。添加一个 RadAjaxManager（如果您还没有的话）并手动触发 PostBack。尝试这样的事情：

```
<telerik:RadAjaxManager runat="server" ID="ajaxMgr"></telerik:RadAjaxManager>
<script type="text/javascript">

function rowClick(sender, args) {
    var mastertable = sender.get_masterTableView();
    var id = mastertable.getCellByColumnUniqueName(args.get_item(), "Id").innerHTML;

    if (id == "1") {
        var ajaxMgr = $find("<%= ajaxMgr.ClientID %>");
        ajaxMgr.ajaxRequestWithTarget("<%= grid.UniqueID %>", id);
    }

}

</script> 
```

然后，您需要在代码隐藏中处理 RaisePostBackEvent 方法：

```
protected override void RaisePostBackEvent(IPostBackEventHandler sourceControl, string eventArgument)
{
     // Do something interesting
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-16T21:08:45.293

您所要做的就是在`OnRequestStart`满足您的条件时阻止事件的 ajax 调用。为此，您必须：

如果您的行刚刚被点击，请听`OnRequestStart`并返回：`false`

在你的 js 中：

```
var myRowHaveBeenClicked = false;

function OnRequestStart(){
    if(myRowHaveBeenClicked){
        myRowHaveBeenClicked = false;
        return false;
    }
} 
```

在您的 ASP 中：

```
<telerik:RadAjaxManager runat="server" ID="ajaxmanager">
    <clientevents onRequeststart="OnRequestStart" />
    ....... 
```

剩下要做的就是`myRowHaveBeenClicked`在 rowClick 函数中设置标志。

在您的 RowClick 函数中：

```
function RowClick(sender, e) {
    var masterTable = sender.get_masterTableView();
    var hasReport = masterTable.getCellByColumnUniqueName(e.get_item(), "HasReport").innerHTML;

    myRowHaveBeenClicked = hasReport.trim() == "No";
} 
```

该`RowClick`事件发生在 之前`RequestStart`，因此，在那一刻您可以设置一个标志，指示不应发生回发。

解决方案远非干净或优雅，但它有效且非常简单。

希望能帮助到你 ：）

# objective-c - 从segued意见回家

> ID：16088937
> 
> 赞同：0
> 
> 时间：2013-04-18T16:56:21.673
> 
> 标签：objective-c, ios6, xcode4.5

我已经使用情节提要并从主菜单到经销商列表，以打开发票列表到发票详细信息。

有没有办法放置一个名为 Home 的按钮，它可以将用户返回到主菜单，这意味着以编程方式在 Invoice 详细信息中调用返回按钮，然后在打开的发票列表中再次调用返回按钮，再次在经销商列表中调用返回按钮并发送用户到主菜单

感谢您的投入谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:58:58.657

在 Storyboard 中制作您的按钮，然后将 IBAction 连接到它以执行以下操作：

```
- (IBAction)homeButtonPressed:(id)sender {
[[self navigationController] popToRootViewControllerAnimated:YES]
} 
```

# ruby - 新用户无法使用 RVM 和 Ruby

> ID：16088942
> 
> 赞同：0
> 
> 时间：2013-04-18T16:56:25.443
> 
> 标签：ruby, bash, rvm

我已经为一个用户安装了 RVM（它安装了 Ruby 2），然后我还使用 RVM 为同一个用户安装了 JRuby。第一个用户是我通常工作（开发）的用户。

我的应用程序在它自己的用户下运行。我创建了应用程序用户，但发现第一个用户可用的 rvm、ruby、jruby 和 gem 对第二个用户不可用（例如：rvm:command not found）。

我相信这与 PATH 和 env 变量有关，但无法在搜索中找到我的解决方案。

任何帮助表示赞赏。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T16:59:24.247

rvm 默认安装在执行用户的主目录中。此外，默认情况下，其他用户无权访问所述主目录。解决方案是在新用户的主目录下安装 rvm 并在他们的 .profile 中对其进行初始化。

有一个[多用户](https://rvm.io/rvm/install/)选项，您可以在其中安装它并将用户添加到`rvm`组中，但这不是安装[rvm](http://rvm.io)的推荐方式。但是，这似乎确实是您需要做的。

# c - 理解 C 反汇编调用

> ID：16088946
> 
> 赞同：6
> 
> 时间：2013-04-18T16:56:33.973
> 
> 标签：c, assembly, x86-64, calling-convention, att

我想了解 C 调用约定。为此，我编写了以下代码：

```
#include <stdio.h>
#include <stdlib.h>

struct tstStruct
{
    void *sp;
    int k; 
};

void my_func(struct tstStruct*);

typedef struct tstStruct strc;

int main()
{
    char a;
    a = 'b';
    strc* t1 = (strc*) malloc(sizeof(strc));
    t1 -> sp = &a;
    t1 -> k = 40; 
    my_func(t1);
    return 0;   
}

void my_func(strc* s1)
{
        void* n = s1 -> sp + 121;
        int d = s1 -> k + 323;
} 
```

然后我使用 GCC 和以下命令：

```
gcc -S test3.c 
```

并提出了它的组装。我不会显示我得到的整个代码，而是粘贴函数 my_func 的代码。它是这个：

```
my_func:
.LFB1:
.cfi_startproc
pushq   %rbp
.cfi_def_cfa_offset 16
.cfi_offset 6, -16
movq    %rsp, %rbp
.cfi_def_cfa_register 6
movq    %rdi, -24(%rbp)
movq    -24(%rbp), %rax
movq    (%rax), %rax
addq    $121, %rax
movq    %rax, -16(%rbp)
movq    -24(%rbp), %rax
movl    8(%rax), %eax
addl    $323, %eax
movl    %eax, -4(%rbp)
popq    %rbp
.cfi_def_cfa 7, 8
ret
.cfi_endproc 
```

据我了解，情况是这样的：首先将调用者的基指针压入堆栈，并将其堆栈指针设为新的基指针，以便为新函数设置堆栈。但是其他的我不明白。据我所知，参数（或指向参数的指针）存储在堆栈中。如果是这样，第二条指令的目的是什么，

```
movq        -24(%rbp), %rax 
```

这里，%rax 寄存器的内容被移动到距离寄存器 %rbp 中地址 24 个字节的地址。但是 %rax 中有什么？？？？最初什么都没有存储在那里？？？我想我很困惑。请帮助了解此功能的工作原理。提前致谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-18T17:01:09.197

您将 AT&T 语法与 Intel 语法混淆了。

```
movq -24(%rbp), %rax

```

在英特尔语法中，它将是

```
mov rax,[rbp-24]

```

所以它将数据移动`rbp`到`rax`，反之亦然。操作数的顺序在 AT&T 语法中是 src、dest，而在 Intel 语法中是 dest、src。

然后，为了摆脱 GAS 指令以使反汇编更易于阅读，我使用 gcc 简单地组装代码`gcc test3.c`并使用`ndisasm -b 64 a.out`. 请注意，`my_func`下面由 NDISASM 生成的函数的反汇编采用 Intel 语法：

```
000005EF 55 推送 rbp
000005F0 4889E5 移动 rbp,rsp ; 创建堆栈帧。
000005F3 48897DE8 mov [rbp-0x18],rdi ; s1 到一个局部变量中。
000005F7 488B45E8 mov rax,[rbp-0x18] ; rax = s1（它是一个指针）
000005FB 488B00 移动拉克斯，[拉克斯]；取消引用 rax，存储到 rax。
000005FE 4883C079 添加 rax,byte +0x79 ; 拉克斯 = 拉克斯 + 121
00000602 488945F8 mov [rbp-0x8],rax ; 无效* n = s1 -> sp + 121
00000606 488B45E8 移动拉克斯，[rbp-0x18]；rax = 指向 s1 的指针
0000060A 8B4008 移动 eax,[rax+0x8] ; 取消引用 rax+8，存储到 eax。
0000060D 0543010000 添加 eax,0x143 ; eax = eax + 323
00000612 8945F4 移动 [rbp-0xc],eax ; 诠释 d = s1 -> k + 323
00000615 5D pop rbp
00000616 C3 RET

```

有关 Linux x86-64 调用约定 (System V ABI) 的信息，请参阅[What are the calling conventions for UNIX & Linux system calls on x86-64 的](https://stackoverflow.com/questions/2535989/what-are-the-calling-conventions-for-unix-linux-system-calls-on-x86-64)答案。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-18T18:34:19.447

该函数是这样分解的（我忽略了不必要的行）：

首先，保存前一个堆栈帧：

```
pushq   %rbp
movq    %rsp, %rbp 
```

在这里，旧`%rbp`的被压入堆栈以存储直到函数结束。然后，将`%rbp`其设置为新的值`%rsp`（它是保存`%rbp`为`push`发生的下一行）。

```
movq    %rdi, -24(%rbp) 
```

在这里你首先要知道[i386 system V ABI](http://www.sco.com/developers/devspecs/abi386-4.pdf)和[amd64 system V ABI](http://www.cs.tufts.edu/comp/40/readings/amd64-abi.pdf)之间的主要区别之一。

在 i386 System V ABI 中，函数参数通过堆栈（并且仅通过堆栈）传递。相反，在 amd64 System V ABI 中，参数首先通过寄存器传递（如果是整数，`%rdi`如果是浮点数`%rsi`，则为to ）。一旦寄存器的数量用完，剩下的参数就会像 i386 一样被压入堆栈。`%rdx``%rcx``%r8``%r9``%xmm0``%xmm7`

所以，在这里，机器只是将函数的第一个参数（它是一个整数）临时加载到堆栈上。

```
movq    -24(%rbp), %rax 
```

因为您不能直接将数据从一个寄存器传输到另一个寄存器，所以 的内容`%rdi`随后被加载到`%rax`. 所以，`%rax`现在存储这个函数的第一个（也是唯一的）参数。

```
movq    (%rax), %rax 
```

该指令只是取消引用指针并将结果存储回`%rax`.

```
addq    $121, %rax 
```

我们将 121 添加到指定的值。

```
movq    %rax, -16(%rbp) 
```

我们将获得的值存储到堆栈中。

```
movq    -24(%rbp), %rax 
```

我们再次加载函数的第一个参数`%rax`（请记住，我们将第一个参数存储在`-24(%rbp)`）。

```
movl    8(%rax), %eax
addl    $323, %eax 
```

如前所述，我们取消引用指针并将获得的值存储在其中`%eax`，然后将 323 添加到它并放回`%eax`.

请注意，这里我们从 切换`%rax`到 是`%eax`因为我们正在处理的值不再`void*`像以前那样是（64 位），而是`int`（32 位）。

```
movl    %eax, -4(%rbp) 
```

最后，我们将这个计算的结果存储到堆栈中（这在这里似乎没有用，但编译器在编译时没有检测到它可能是不必要的）。

```
popq    %rbp
ret 
```

最后两条指令只是在将手交还给`main`函数之前恢复先前的堆栈帧。

我希望这能让这种行为现在更清楚。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-10-26T21:07:19.383

您可以通过输入以下命令更改为 intel 语法：

```
$ gcc -S -masm=intel test3.c -o test3.s 
```

# java - 如何对 JPA 查询进行分页

> ID：16088949
> 
> 赞同：29
> 
> 时间：2013-04-18T16:56:40.550
> 
> 标签：java, jpa, orm, pagination, criteria

我有一个提交表，其中包含 , 等列以及`ID`其他属性。我的要求是根据提到的属性搜索记录并返回一个分页集。`Name``Code`

这是我正在寻找的伪代码：

```
searchSubmission(searchFilter sf,pageIndex,noOfRecords) {
   query = 'from submisssion where code=sf.code or id=sf.id order by id start_from (pageIndex*noOfRecords) limit noOfRecords'
   return result();
} 
```

似乎有很多选项，例如`CriteriaBuilder`,`NamedQuery`等。在这种情况下，哪个是最有效的选项？

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-04-18T18:55:46.073

对于所有 JPA 查询对象（本地 SQL 查询除外），您将通过 setMaxResults(int) 和 setFirstResult(int) 方法使用分页。例如：

```
 return em.createNamedQuery("yourqueryname", YourEntity.class)
      .setMaxResults(noOfRecords)
      .setFirstResult(pageIndex * noOfRecords)
      .getResultList(); 
```

JPA 将为您执行分页。

命名查询只是预定义的并且可以被缓存，而其他类型是动态创建的。
所以选择是使用 JPQL，如：

```
Query query = em.createQuery("SELECT s FROM Submission s WHERE s.code = :code or s.id = :id ORDER BY s.id", Submission.class); 
```

或 CriteriaBuilder api 形成类似的查询：

```
 CriteriaBuilder qb = em.getCriteriaBuilder();
    CriteriaQuery<Submission> cq = qb.createQuery(Submission.class);

    Root<Submission> root = cq.from(Submission.class);
    cq.where( qb.or( 
        qb.equal(root.get("code"), qb.parameter(String.class, "code")),
        qb.equal(root.get("id"), qb.parameter(Integer.class, "id"))
    ));
    Query query = em.createQuery(cq); 
```

例如，不要忘记使用 query.setParameter("id", sf.id) 设置参数值。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2018-01-09T00:47:29.120

您可以`Pageable`在存储库方法中使用`Spring`

```
@Repository
public interface StateRepository extends JpaRepository<State, Serializable> {

@Query("select state from State state where state.stateId.stateCode = ?1")
public State findStateByCode(String code, Pageable pageable); 
```

}

而在服务层，你可以创建`Pageable`对象：

```
@Autowire
StateRepository stateRepository;

public State findStateServiceByCode(String code, int page, int size) {
    Pageable pageable = new PageRequest(page, size);
    Page<Order> statePage = stateRepository.findStateByCode(code, pageable);
    return statePage.getContent();
} 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-10-09T15:47:19.907

您可以将 JPA 分页用于实体查询和本机 SQL。

为了限制底层查询`ResultSet`大小，JPA`Query`接口提供了该[`setMaxResults`](https://docs.oracle.com/javaee/7/api/javax/persistence/Query.html#setMaxResults-int-)方法。

浏览下一页需要将结果集定位到最后一页结束的位置。为此，JPA`Query`接口提供了该[`setFirstResult`](https://docs.oracle.com/javaee/7/api/javax/persistence/Query.html#setFirstResult-int-)方法。

将分页与 JPQL 查询结合使用如下所示：

```
List<Post> posts = entityManager.createQuery("""
    select p
    from Post p
    order by p.createdOn
    """)
    .setFirstResult(10)
    .setMaxResults(10)
    .getResultList(); 
```

Criteria API 是一样的，因为你需要`Query`从`CriteriaQuery`:

```
CriteriaBuilder qb = em.getCriteriaBuilder();
CriteriaQuery<Post> cq = qb.createQuery(Post.class);

Root<Post> root = cq.from(Post.class);
cq.orderBy(qb.asc(root.get("createdOn")));

List<Post> posts = em.createQuery(cq)
    .setFirstResult(10)
    .setMaxResults(10)
    .getResultList(); 
```

# c++ - GCC 编译得很好，但 Solaris 编译器不行？

> ID：16088950
> 
> 赞同：0
> 
> 时间：2013-04-18T16:56:42.790
> 
> 标签：c++, compiler-errors, solaris, exiv2

来源：svn checkout svn://dev.exiv2.org/svn/trunk (rev: 3019)

我的平台：Fedora 17 64 位

以下命令有效：

```
./configure CXX=/opt/oracle/solarisstudio12.3/bin/CC \
     CC=/opt/oracle/solarisstudio12.3/bin/cc CXXFLAGS="-v -library=stlport4" 
```

但是当我做时，我得到了错误：

```
libtool: compile:  /opt/oracle/solarisstudio12.3/bin/CC -v -library=stlport4 -    
xldscope=hidden -I. -DEXV_LOCALEDIR=\"/usr/local/share/locale\" -I../include -funsigned-
char -DNDEBUG=1 -DEXV_HAVE_STDINT_H=1 -c XML_Node.cpp >/dev/null 2>&1
CC: Warning: Option -funsigned-char passed to ld, if ld is invoked, ignored otherwise
/opt/oracle/solarisstudio12.3/prod/lib/amd64/crt1x.o: In function `_start':
fsr.s:(.text+0x3b): undefined reference to `main'
make[1]: *** [XML_Node.o] Error 2
make[1]: Leaving directory `/home/Wani/GSoC/exiv2-trunk/trunk/xmpsdk/src'
make: *** [xmpsdk] Error 2
[Wani@Linux trunk]$ 
```

谁能告诉这里的确切问题是什么？

使用 GCC 编译时相同的源代码没有错误并且编译成功。

# c++ - 强制用户声明对象 const

> ID：16088962
> 
> 赞同：3
> 
> 时间：2013-04-18T16:57:14.943
> 
> 标签：c++

有没有办法强制类的用户根据构造函数`const`使用的数据构造对象？

例如，考虑一个围绕某个缓冲区的小型包装类，它可以是`const`或非`const`

```
class Wrapper {
  public:
    Wrapper(const char*);
    Wrapper(char*);
}; 
```

现在，如果用户提供 a `const`，我可以强制他们声明对象`const`在编译时。那是

```
// you have to do this if the input is const 
const char* a; 
// this will not compile 
Wrapper w(a); 
// but this will 
const Wrapper(a); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-18T17:01:48.543

您不能在构造函数中执行此操作，但您可以创建一个返回 const 对象引用或指针的工厂。但是，您将需要禁用复制和复制构造，并且可能不会提供任何值。

# excel - 在最后一张之后添加一张纸并复制最后一张值而不是公式

> ID：16088963
> 
> 赞同：0
> 
> 时间：2013-04-18T16:57:16.897
> 
> 标签：excel, vba

我正在尝试仅复制最后一张表的值（而不是公式）并将新表命名为“游戏”。我正在使用这个：

```
Sub CreateColumn()
ActiveSheet.Copy
Cells.Copy
Range("A1").PasteSpecial Paste:=xlPasteValues
Application.CutCopyMode = False

 ActiveSheet.Name = "Games"
 Application.ScreenUpdating = False

End Sub 
```

但它正在创建一个新的工作簿，而不是最后一个工作表之后的新工作表。有人可以帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-18T17:41:49.163

您需要先添加工作表。就像是：

```
Sheets.Add After:=Sheets(Sheets.Count)
Sheets("Sheet4").Select
Sheets("Sheet4").Name = "Games" 
```

然后激活它以复制到。

# sql - 用于返回 Group By 中多个列的“最常见值”的 SQL 函数

> ID：16088964
> 
> 赞同：2
> 
> 时间：2013-04-18T16:57:31.593
> 
> 标签：sql, sql-server

我正在寻找最简单的方法来返回分组的 select 语句的多列结果中最常见的值。我在网上找到的所有内容都指向选择中单个项目的排名，或者在 GROUP BY 之外单独处理每一列。

样本数据：

```
SELECT 100 as "auser", 
'A' as "instance1", 'M' as "instance2" 
union all select 100, 'B', 'M' 
union all select 100,'C', 'N' 
union all select 100, 'B', 'O'
union all select 200,'D', 'P' 
union all select 200, 'E', 'P' 
union all select 200,'F', 'P' 
union all select 200, 'F', 'Q' 
```

样本数据结果：

```
auser   instance1   instance2
100     A           M
100     B           M
100     C           N
100     B           O
200     D           P
200     E           P
200     F           P
200     F           Q 
```

查询逻辑（我如何在脑海中看到它）：

```
SELECT auser, most_common(instance1), most_common(instance2)
FROM datasample
GROUP BY auser; 
```

期望的结果：

```
100     B           M
200     F           P 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T17:59:52.043

这种解决此问题的方法使用嵌套窗口函数。最里面的子查询计算每列的计数。下一个子查询对这些进行排名（使用`row_number()`）。然后，外部查询使用条件聚合来获得您想要的结果：

```
select auser, MAX(case when seqnum1 = 1 then instance1 end),
       MAX(case when seqnum2 = 1 then instance2 end)
from (select t.*,
             ROW_NUMBER() over (partition by auser order by cnt1 desc) as seqnum1,
             ROW_NUMBER() over (partition by auser order by cnt2 desc) as seqnum2
      from (select t.*,
                   count(*) over (partition by auser, instance1) as cnt1,
                   COUNT(*) over (partition by auser, instance2) as cnt2
            from t
           ) t
     ) t
group by auser 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:21:00.823

我不确定是否能找到更优雅的东西，但如果您使用的是 SQL 2005+（因为我使用的是[排名函数](http://msdn.microsoft.com/en-us/library/ms189798.aspx)和[CTE](http://msdn.microsoft.com/en-us/library/ms190766.aspx)），这可能会做到：

```
with instance1 as (
    select auser, instance1
        , row_number() over (partition by auser order by count(*) desc, instance1) as row_num
    from datasample
    group by auser, instance1
), instance2 as (
    select auser, instance2
        , row_number() over (partition by auser order by count(*) desc, instance2) as row_num
    from datasample
    group by auser, instance2
)
select a.auser, a.instance1, b.instance2
from instance1 as a 
    join instance2 as b on a.auser = b.auser
where a.row_num = 1
    and b.row_num = 1
order by a.auser; 
```

我不确定您希望如何处理空值，并且将 row_num 等效项移动到连接条件不会更改我的盒子上的执行计划。

如果您使用的是 SQL Server 2000，那么您可以用派生表替换这些 CTE，并通过使用 count 和[“三角连接”](http://www.sqlservercentral.com/articles/T-SQL/61539/)来伪造 row_number() 。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-06T12:25:20.330

只需简单

```
Select auser, instance1, instance2 FROM datasample GROUP BY auser,instance1, instance2 ; 
```

# javascript - JSON.parse 在带有数组的 for 循环中给出 SyntaxError

> ID：16088969
> 
> 赞同：0
> 
> 时间：2013-04-18T16:57:43.150
> 
> 标签：javascript, json, google-maps, google-maps-api-3

我有一个带有方向渲染器 json 的数组，它是字符串化的。

```
array[1].direction = '{\"routes\":[{\"bounds\":\"\....'
array[1].direction = '{\"routes\":[{\"bounds\":\"\....'
.
. 
```

这就是我在我的地图上渲染这些 json 所做的。

```
for (var x=2; x<array.length; x++) {

        renderDirections(array[x].direction);
    }

function renderDirections(result){

     var directionRenderer = new google.maps.DirectionsRenderer();

       myDirections = JSON.parse(result, function(name, value){

         if(/^LatLngPlaceHolder\(/.test(value)) { 
                    var match = /LatLngPlaceHolder\(([^,]+),([^,]+)\)/.exec(value);
                    return new google.maps.LatLng(match[1], match[2]);
                } 
         else{
           return value;
         }
        });

      directionRenderer.setMap(map);
      directionRenderer.setDirections(myDirections);
      directionRenderer.setOptions({suppressMarkers:true,preserveViewport:true});
    } 
```

这样做会`"Uncaught SyntaxError: Unexpected token \"`在 JSON.parse 行出现错误。

但是，如果我这样做：

```
for (var x=2; x<array.length; x++) {

        var examplejson = '{\"routes\":[{\"bounds\":\"\....'; //note that its an example json which i logged from `array[x].direction`
        renderDirections(examplejson);
    } 
```

它呈现 json。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T16:59:20.283

仅当`\`您在要解析为对象的字符串中创建 JSON 时才需要。从你的第一个例子中删除`\`，你会有更好的运气。

```
array[1].direction = {"routes":[{"bounds":".... 
```

`\`告诉解析器“不要将引号视为终止符，而是将其视为字符” 。在带引号的字符串之外，它是不正确的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-18T17:36:31.703

您不必以这种方式创建方向对象。如果您正在构建动态 json，那么您应该执行以下操作：

```
var array = [];
var obj = {
   key: "value",
   key2: "value2",
   key3: 3
};
array.push(obj); 
```

如果您从服务器接收到 key 和 key2 的值​​，那么您可以将硬编码字符串替换为包含该值的变量。以上述方式编码对象也更容易维护。编写手动编码的 json 对象是可怕的。当你编辑它们时，你永远不会知道会出现什么错误。**如果您需要序列化该数组以进行存储，您可以只使用 JSON.stringify(array)**，这将返回一个 json 编码的字符串，您可以通过网络传输甚至存储在 localStorage 中。

使用我向您展示的方法，您根本不需要 JSON.parse，因此您可以避免在不必要的循环中调用 JSON.parse。如果您有不同的原因像您一样创建 json 对象，您可能应该在您的问题中说明这一点。但无论哪种方式，你都不应该这样做。

# r - ggplot2世界地图中的图例大小

> ID：16088981
> 
> 赞同：4
> 
> 时间：2013-04-18T16:58:37.793
> 
> 标签：r, ggplot2

我正在使用 Maps.R 库中的 worldmap 函数。它在 ggplot2 中运行。

我想让传说更大一点。我在用

```
theme(legend.key.size = unit(measure, "units")) 
```

我的 R 终端返回：

```
could not find function "unit" 
```

关于这里发生了什么的任何线索？我相信这是 ggplot2 中调整图例大小的正确语法。

非常感谢，bfb

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-18T20:55:32.590

该功能`unit`在`grid`包中。您需要显式加载它并将其添加到您的搜索路径

```
library("grid") 
```

至于您在评论中的后续问题，因为`ggplot2`需要`grid`，`grid`在加载时`ggplot2`已加载，其功能可用于`ggplot2`. 但是，它没有添加到全局搜索路径中，因此`grid`当您尝试直接调用它们时，找不到它的 ('s) 函数。调用`library()`(or `require()`) 可以找到它们。

他们的文档中描述了这两个函数之间的区别

> `library(package)`并且`require(package)`都使用 name 加载包`package`。`require`设计用于其他功能；如果包不存在，它会返回`FALSE`并给出警告（而不是默认情况下的错误）。`library()`

在另一个问题中：[require() 和 library() 有什么区别？](https://stackoverflow.com/q/5595512/892313)

# css - 根据屏幕尺寸加载各种视网膜图形

> ID：16088984
> 
> 赞同：0
> 
> 时间：2013-04-18T16:58:48.577
> 
> 标签：css, layout, responsive-design, media-queries, retina-display

我的设置是我有几个版本的网站。在大屏幕上有幻灯片放映，在手机和其他小屏幕上只有滚动浏览网站。这两个版本的站点加载不同的图形。

我一直对如何有条件地加载视网膜图形感到困惑。我需要为具有足够大屏幕以进行幻灯片放映的视网膜设备加载第一组视网膜图形，但如果您在手机上，则不应加载第一组视网膜图形，而第二组视网膜图形应覆盖用于滚动站点的第二组图像。

我正在使用它来触发并用视网膜替换普通图形：

```
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) { 
```

那是我媒体查询的开始，并替换了桌面站点的图像。然后我有几个部分专门用于调整布局：

```
@media all and (min-width: 1024px) and (max-width: 1099px){

@media all and (min-width: 768px) and (max-width: 1023px) {

@media all and (max-width: 767px) {
// This query is for the small phone sized layout.

@media all and (max-width: 767px) and ((-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi)) { 
```

最后一个查询是我尝试仅为电话站点交换视网膜图像。这是行不通的，我尝试过的任何安排都没有奏效。

想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T09:05:38.983

如果您也想根据屏幕分辨率提供不同的图像，我建议为此 eG Retina.js 或 response.js 使用 jQuery 插件。

这样，您只需上传标准分辨率的图像和文件扩展名前带有@2x 的视网膜显示器。（retina.js、response.js 更强大，但需要你做更多的工作）

另外我认为您需要使用不同的媒体查询来解决 iphone 4 问题。

-webkit-min-device-pixel-ratio: 1,5 应该可以解决问题。

# twitter-bootstrap - 无法在远程 Twiitter Bootstrap 模式中使用淘汰赛

> ID：16088992
> 
> 赞同：1
> 
> 时间：2013-04-18T16:59:11.267
> 
> 标签：twitter-bootstrap, knockout.js

我正在使用 twitter 引导程序、mvc 和淘汰赛。我有一个模式，我从一个指向处理上传的页面的远程 url 打开。

我这样做是这样的：

```
<a class="btn btn-mini" data-toggle="modal"  data-bind="attr: { href: modalHref }" data-target="#UploadModal" >Uploads</a>

<div id="UploadModal" class="modal hide" style="display: none; " aria-hidden="true">
<div class="modal-header">
    <button data-dismiss="modal" class="close" type="button">×</button>
    <h3>Upload</h3>
</div>
<div class="modal-body form-horizontal" style="padding:0;">
</div>
<div class="modal-footer">
    <a data-dismiss="modal" class="btn" href="#" data-bind="click: saveCount">Save</a>
</div>
</div> 
```

模态加载很好，里面的一切都很好。基本上我有一个文件上传器控件，用户可以在其中向我发布文件，我处理它，然后我返回列标题来处理它们。这是我在表单上的 ajax 函数：

```
function uploadSubmit() {
$.ajax({
    url: '/Upload/UserSaveFileInfo/',
    type: 'post',
    async: false,
    data: ko.toJSON({
        UploadName: $("#uploadName").val(),
        UploadDescription: $("#uploadDescription").val(),
        Id:  $('#uploadId').val()
    }),
    contentType: 'application/json',
    success: function (result) {
        $("#uploader").hide();
        for( var i = 0; i < result.length; i++)
        {
            viewModel.RetRows.push({
                Id: ko.observable(result[i].Id),
                Header: ko.observable(result[i].Header),
                MatchedTo: ko.observable(result[i].MatchedTo),
                Values: ko.observable(result[i].Values),
                ColumnNumber: ko.observable(result[i].ColumnNumber)
            });
        }
        $("#matcher").show();
    },
    error: function (jqXHR, textStatus, errorThrown) {
        console.log(data);
        alert(textStatus);
    }
}); 
```

}

这一切都有效，但是在我的远程加载模式中，我有一些代码试图从返回的数据中呈现一系列文本框/跨度，但它不起作用。我试图只查看模态中的其他 ko 变量，但它们没有显示出来，因此模态似乎不知道存在敲除或敲除无法访问模态内容...有没有办法使远程模态和ko同步？

```
<!-- ko foreach: RetRows -->
        <div class="control-group">
            <label class="control-label">
                Column <span data-bind="text: $data.ColumnNumber"></span>
            </label>
            <div class="controls">
                <input data-bind="value: $data.MatchedTo" />
                <span class="help-block" data-bind="text: $data.value"></span>
            </div>
        </div>
    <!-- /ko --> 
```

我把它放在父页面中，一切都出现了。所以这似乎是模态中远程加载的内容的问题。有想法该怎么解决这个吗？也许有一种方法可以通过 bindingHandler 附加远程内容？感谢任何人都可以提供的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T17:01:22.183

您需要将绑定应用到该模式。

```
ko.applyBindings(viewModel, document.getElementById("remote_modal")); 
```

# java - 使用 BubbleSort 对 int 数组进行排序

> ID：16088994
> 
> 赞同：12
> 
> 时间：2013-04-18T16:59:11.903
> 
> 标签：java

为什么我打印出来的数组没有在下面的代码中排序？

```
public class BubbleSort {

   public void sortArray(int[] x) {//go through the array and sort from smallest to highest
      for(int i=1; i<x.length; i++) {
         int temp=0;
         if(x[i-1] > x[i]) {
            temp = x[i-1];
            x[i-1] = x[i];
            x[i] = temp;
         }
      }
   }

   public void printArray(int[] x) {
      for(int i=0; i<x.length; i++)
        System.out.print(x[i] + " ");
   }

   public static void main(String[] args) {
      // TestBubbleSort
      BubbleSort b = new BubbleSort();
      int[] num = {5,4,3,2,1};
      b.sortArray(num);
      b.printArray(num);   
   }
} 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-04-18T17:01:59.737

您需要两个循环来实现冒泡排序。

示例代码：

```
public static void bubbleSort(int[] numArray) {

    int n = numArray.length;
    int temp = 0;

    for (int i = 0; i < n; i++) {
        for (int j = 1; j < (n - i); j++) {

            if (numArray[j - 1] > numArray[j]) {
                temp = numArray[j - 1];
                numArray[j - 1] = numArray[j];
                numArray[j] = temp;
            }

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-04-18T17:04:53.700

你只通过你的阵列一次！冒泡排序要求你*一直循环*，直到你发现你不再做任何交换；因此 O(n^2) 的运行时间。

试试这个：

```
public void sortArray(int[] x) {
    boolean swapped = true;
    while (swapped) {
       swapped = false;
       for(int i=1; i<x.length; i++) {
           int temp=0;
           if(x[i-1] > x[i]) {
               temp = x[i-1];
                x[i-1] = x[i];
                x[i] = temp;
                swapped = true;
            }
        }
    }
} 
```

一旦`swapped == false`在循环结束时，您已经完成了整个传递，但没有找到任何实例`x[i-1] > x[i]`，因此您知道数组已排序。只有*这样*你才能终止算法。

你也可以`while`用for循环替换外部循环`n+1`，这样可以保证数组是有序的；但是，`while`循环具有在好于最坏的情况下提前终止的优势。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-18T17:02:46.137

你的排序逻辑是错误的。这是冒泡排序的伪代码：

```
for i = 1:n,
    swapped = false
    for j = n:i+1, 
        if a[j] < a[j-1], 
            swap a[j,j-1]
            swapped = true
    → invariant: a[1..i] in final position
    break if not swapped
end 
```

有关所有各种排序方法的优秀教程，请参阅此[排序网站](http://www.sorting-algorithms.com/bubble-sort)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-25T13:04:08.130

我使用这种方法进行冒泡排序

```
public static int[] bubbleSort (int[] a) {
    int n = a.length;
    int j = 0;
    boolean swap = true;
    while (swap) {
        swap = false;
        for (int j = 1; j < n; j++) {
            if (a[j-1] > a[j]) {
                j = a[j-1];
                a[j-1] = a[j];
                a[j] = j;
                swap = true;
            }
        }
        n = n - 1;
    }
    return a;
}//end bubbleSort 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-18T17:04:02.943

这不是冒泡排序算法，你需要重复，直到你没有东西可以交换：

```
public void sortArray(int[] x) {//go through the array and sort from smallest to highest
  for(;;) {
      boolean s = false;
      for(int i=1; i<x.length; i++) {
         int temp=0;
         if(x[i-1] > x[i]) {
            temp = x[i-1];
            x[i-1] = x[i];
            x[i] = temp;
            s = true;
         }
      }
      if (!s) return;
  }
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-18T17:05:05.183

冒泡排序嵌套循环应该这样写：

```
int n = intArray.length;
int temp = 0;

for(int i=0; i < n; i++){
   for(int j=1; j < (n-i); j++){                        
       if(intArray[j-1] > intArray[j]){
            //swap the elements!
            temp = intArray[j-1];
            intArray[j-1] = intArray[j];
            intArray[j] = temp;
       }                    
   }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-12-25T16:45:56.870

```
public static void BubbleSort(int[] array){
        boolean swapped ;
        do {
            swapped = false;
            for (int i = 0; i < array.length - 1; i++) {
                if (array[i] > array[i + 1]) {
                    int temp = array[i];
                    array[i] = array[i + 1];
                    array[i + 1] = temp;
                    swapped = true;
                }
            }
        }while (swapped);
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-20T06:37:52.413

```
public class Bubblesort{

  public static int arr[];

  public static void main(String args[]){

    System.out.println("Enter number of element you have in array for performing bubblesort");

    int numbofele = Integer.parseInt(args[0]);

    System.out.println("numer of element entered is"+ "\n" + numbofele);

    arr= new int[numbofele];

    System.out.println("Enter Elements of array");

    System.out.println("The given array is");

    for(int i=0,j=1;i<numbofele;i++,j++){

      arr[i]=Integer.parseInt(args[j]);

      System.out.println(arr[i]);

    }

    boolean swapped = false;

    System.out.println("The sorted array is");

    for(int k=0;k<numbofele-1;k++){

      for(int l=0;l+1<numbofele-k;l++){

        if(arr[l]>arr[l+1]){

          int temp = arr[l];
          arr[l]= arr[l+1];
          arr[l+1]=temp;
          swapped=true;

        } 

      }

         if(!swapped){

            for(int m=0;m<numbofele;m++){

       System.out.println(arr[m]);

    }

      return;

      }

    }

    for(int m=0;m<numbofele;m++){

       System.out.println(arr[m]);

    }

  }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2018-07-07T19:54:49.700

冒泡排序算法是对数组元素进行排序的一种最简单的方法。大多数其他算法比冒泡排序算法效率更高。最坏情况和平均情况的时间复杂度为 (n^2)。让我们考虑如何实现冒泡排序算法。

```
class buble_sort{
  public static void main(String a[]){

    int[] num={7,9,2,4,5,6,3};
    int i,j,tmp;

    for(i=0;i<num.length;i++){
        for(j=0;j<num.length-i;j++){
            if(j==(num.length-1)){
                break;
            }
            else{
                if(num[j]>num[j+1]){
                    tmp=num[j];
                    num[j]=num[j+1];
                    num[j+1]=tmp;
                }
            }
        }
    }

    for(i=0;i<num.length;i++){
        System.out.print(num[i]+"  ");
    }
} 
```

}

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-02-04T03:53:39.657

开始了

```
static String arrayToString(int[] array) {
    StringBuilder stringBuilder = new StringBuilder();
    for (int i = 0; i < array.length; i++) {
      stringBuilder.append(array[i]).append(",");
    }
    return stringBuilder.deleteCharAt(stringBuilder.length()-1).toString();
  }

  public static void main(String... args){
    int[] unsorted = {9,2,1,4,0};
    System.out.println("Sorting an array of Length "+unsorted.length);
    enhancedBubbleSort(unsorted);
    //dumbBubbleSort(unsorted);
    //bubbleSort(unsorted);
    //enhancedBubbleSort(unsorted);
    //enhancedBubbleSortBetterStructured(unsorted);
    System.out.println("Sorted Array: "+arrayToString(unsorted));

  }

  // this is the dumbest BubbleSort
  static int[] dumbBubbleSort(int[] array){
    for (int i = 0; i<array.length-1 ; i++) {
      for (int j = 0; j < array.length - 1; j++) {
        if (array[j] > array[j + 1]) {
          // Just swap
          int temp = array[j];
          array[j] = array[j + 1];
          array[j + 1] = temp;
        }
      }
      System.out.println("After "+(i+1)+" pass: "+arrayToString(array));
    }
    return array;
  }

  //this "-i" in array.length - 1-i brings some improvement.
  // Then for making our bestcase scenario better ( o(n) , we will introduce isswapped flag) that's enhanced bubble sort

  static int[] bubbleSort(int[] array){
    for (int i = 0; i<array.length-1 ; i++) {
      for (int j = 0; j < array.length - 1-i; j++) {
        if (array[j] > array[j + 1]) {
          int temp = array[j];
          array[j] = array[j + 1];
          array[j + 1] = temp;
        }
      }
      System.out.println("After "+(i+1)+" pass: "+arrayToString(array));
    }
    return array;
  }

  static int[] enhancedBubbleSort(int[] array){
    int i=0;
    while (true) {
      boolean swapped = false;
      for (int j = 0; j < array.length - 1; j++) {
        if (array[j] > array[j + 1]) {
          int temp = array[j];
          array[j] = array[j + 1];
          array[j + 1] = temp;
          swapped =true;
        }
      }
      i++;
      System.out.println("After "+(i)+" pass: "+arrayToString(array));
      if(!swapped){
        // Last iteration (of outer loop) didnot result in any swaps. so stopping here
        break;
      }
    }
    return array;
  }

  static int[] enhancedBubbleSortBetterStructured(int[] array){
    int i=0;
    boolean swapped = true;
    while (swapped) {
      swapped = false;
      for (int j = 0; j < array.length - 1; j++) {
        if (array[j] > array[j + 1]) {
          int temp = array[j];
          array[j] = array[j + 1];
          array[j + 1] = temp;
          swapped = true;
        }
      }
      i++;
      System.out.println("After "+(i)+" pass: "+arrayToString(array));
    }
    return array;
  } 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2019-03-21T19:05:53.823

这是一个**bubbleSort**的例子，时间复杂度是 O(n)。

```
 int[] bubbleSort(int[] numbers) {
        if(numbers == null || numbers.length == 1) {
            return numbers;
        }

        boolean isSorted = false;

        while(!isSorted) {
            isSorted = true;
            for(int i = 0; i < numbers.length - 1; i++) {
                if(numbers[i] > numbers[i + 1]) {
                    int hold = numbers[i + 1];
                    numbers[i + 1] = numbers[i];
                    numbers[i] = hold;
                    isSorted = false;
                }
            }
        }

        return numbers;
    } 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2019-04-01T01:45:45.497

真的没有得到[`bubble sort`](https://en.wikipedia.org/wiki/Bubble_sort)，这可以更恰当地称为下沉排序，因为它实际上是在大多数答案**中将更大/更重的东西下沉到底部。**最典型的例子之一是

```
private static void sortZero(Comparable[] arr) {
    boolean moreSinkingRequired = true;
    while (moreSinkingRequired) {
        moreSinkingRequired = false;
        for (int j = 0; j < arr.length - 1; ++j) {
            if (less(arr, j + 1, j)) { 
                exch(arr, j, j + 1);
                moreSinkingRequired = true;
            }
        }
    }
} 
```

顺便说一句，您必须多穿越一次才能提前停止。

但是当我看到它冒泡时

```
private static void sortOne(Comparable[] arr) {
    for (int i = 0; i < arr.length - 1; ++i) {
        for (int j = arr.length - 1; j > i; --j) { // start from the bottom
            if (less(arr, j, j - 1)) {
                exch(arr, j - 1, j);
            }
        }
    }
} 
```

您必须知道这种方法实际上更好，因为它跟踪*终点*以`j > i`与`[0, i-1]`已经排序的比较。

我们也可以添加更早的终止，但它会变得冗长为

```
private static void sortTwo(Comparable[] arr) {
    boolean moreBubbleRequired = true;
    for (int i = 0; i < arr.length - 1 && moreBubbleRequired; ++i) {
        moreBubbleRequired = false;
        for (int j = arr.length - 1; j > i; --j) {
            if (less(arr, j, j - 1)) {
                exch(arr, j - 1, j);
                moreBubbleRequired = true;
            }
        }
    }
} 
```

* * *

用于使流程简洁的实用程序是

```
public static boolean less(Comparable[] arr, int i, int j) {
    return less(arr[i], arr[j]);
}

public static boolean less(Comparable a, Comparable b) {
    return a.compareTo(b) < 0;
}

public static void exch(Comparable[] arr, int i, int j) {
    Comparable t = arr[i];
    arr[i] = arr[j];
    arr[j] = t;
} 
```

* * *

## 回答 #13

> 赞同：-1
> 
> 时间：2015-10-28T06:57:00.750

```
public class SortingArray {
public static void main(String[] args) {

int[] a={3,7,9,5,1,4,0,2,8,6};
int temp=0;

boolean isSwapped=true;

System.out.println(" before sorting the array: ");

for(int i=0;i<a.length;i++)
{
    System.out.print(a[i]);
}
System.out.println("");

do
{

isSwapped=false;

for(int i=0;i<a.length-1;i++)

{

    if(a[i]>a[i+1])

    {

        temp=a[i];

        a[i]=a[i+1];

        a[i+1]=temp;

    }

}

}while(isSwapped);

System.out.println("after sorting the array: ");

    for(int array:a)

    {

        System.out.print(array);

    }
  }
} 
```

* * *

## 回答 #14

> 赞同：-1
> 
> 时间：2015-11-08T16:22:45.473

```
public class BubbleSort {

    public void sorter(int[] arr, int x, int y){

            int temp = arr[x];
            arr[x] = arr[y];
            arr[y] = temp;

    }

    public void sorter1(String[] arr, int x, int y){

        String temp = arr[x];
        arr[x] = arr[y];
        arr[y] = temp;

    }

    public void sertedArr(int[] a, String[] b){
        for(int j = 0; j < a.length - 1; j++){
            for(int i = 0; i < a.length - 1; i++){
                if(a[i] > a[i + 1]){
                    sorter(a, i, i + 1);
                    sorter1(b, i, i + 1);
                }
            }
        }
        for(int i = 0; i < a.length; i++){
            System.out.print(a[i]);
        }
        System.out.println();
        for(int i = 0; i < b.length; i++){
            System.out.print(b[i]);
        }
        // 
    }
    public static void main(String[] args){
        int[] array = {3, 7, 4, 9, 5, 6};
        String[] name = {"t", "a", "b", "m", "2", "3"};
        BubbleSort bso = new BubbleSort();
            bso.sertedArr(array, name);
    }
} 
```

* * *

## 回答 #15

> 赞同：-1
> 
> 时间：2016-11-10T18:38:58.417

爪哇代码

```
public void bubbleSort(int[] arr){   

    boolean isSwapped = true;

    for(int i = arr.length - 1; isSwapped; i--){

        isSwapped = false;

        for(int j = 0; j < i; j++){

            if(arr[j] > arr[j+1]}{
                int temp = arr[j];
                arr[j] = arr[j+1];
                arr[j+1] = temp;
                isSwapped = true;
            }
        }

    }

} 
```

* * *

## 回答 #16

> 赞同：-2
> 
> 时间：2016-07-28T20:43:27.320

Java中的标准冒泡排序实现：

```
//Time complexity: O(n^2)
public static int[] bubbleSort(int[] arr) {

    if (arr == null || arr.length <= 1) {
        return arr;
    }

    for (int i = 0; i < arr.length; i++) {
        for (int j = 1; j < arr.length - i; j++) {
            if (arr[j - 1] > arr[j]) {
                arr[j] = arr[j] + arr[j - 1];
                arr[j - 1] = arr[j] - arr[j - 1];
                arr[j] = arr[j] - arr[j - 1];
            }
        }
    }

    return arr;
} 
```

# wcf - 从 WSO2 ESB 中的 WCF 服务代理将二进制转换为 OutSequence 中的 XML

> ID：16088997
> 
> 赞同：0
> 
> 时间：2013-04-18T16:59:24.453
> 
> 标签：wcf, wso2, wso2esb, xelement

我在 REST api 和 WCF 服务之间使用 WSO2 ESB 中的代理服务。我正在调用的 WCF 服务接受并返回一个 XElement 对象。当 WCF 服务的响应进入代理的出序列时，结果是二进制的。

```
<?xml version='1.0' encoding='utf-8'?>
    <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
        <soapenv:Body>
            <axis2ns43:binary xmlns:axis2ns43="http://ws.apache.org/commons/ns/payload"></axis2ns43:binary>
        </soapenv:Body>
    </soapenv:Envelope> 
```

肥皂正文中的消息应该类似于

```
<?xml version='1.0' encoding='utf-8'?>
    <soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/">
        <soapenv:Body>
            <Location><Result>Success</Result></Location>
        </soapenv:Body>
    </soapenv:Envelope> 
```

如何将二进制消息转换为它应该是的实际 XML？我猜我需要使用格式化或构建器调解器来完成此操作，我只是不确定如何。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T16:43:24.463

ESB 4..6.0，默认情况下它使用直通传输，它不会构建消息..但是使用您的二进制输出，我可以确认 ESB 没有收到任何消息..（即：“成功”消息）如果它收到了，你可以看到，类似的东西；

```
 <axis2ns43:binary xmlns:axis2ns43="http://ws.apache.org/commons/ns/payload">6Ly9zY2hlbWFzLnhtbHNvY</axis2ns43:binary> 
```

您能否切换回 NIO 传输（您需要在 axi2.xml 中启用传输发送方和接收方），看看您实际接收的是什么？