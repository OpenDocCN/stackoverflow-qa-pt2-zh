# StackOverflow 问答 15821000-15821999

# iphone - AVAudioSession 阻塞系统音频

> ID：15821000
> 
> 赞同：3
> 
> 时间：2013-04-04T20:22:40.683
> 
> 标签：iphone, objective-c, avaudioplayer, avaudiosession

我正在编写一个播放背景音乐的应用程序，为此我正在使用 AVAudioSession，如下所示：

```
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryPlayback error:nil];
[[AVAudioSession sharedInstance] setActive:YES error:nil];
NSData *data = [NSData dataWithContentsOfFile:[[NSBundle mainBundle] pathForResource:@"song" ofType:@"mp3"]];
player = [[AVAudioPlayer alloc] initWithData:data error:NULL];
player.delegate = self;
[player setVolume:1.0];
...
[player prepareToPlay];
[player play]; 
```

然后，稍后，用户可以选择禁用音乐。如果他们选择这样做，则运行以下代码：

```
[[AVAudioSession sharedInstance] setActive:NO error:nil];
[player stop]; 
```

这成功地停止了音乐的播放。但是，如果音乐应用程序（或其他，如 Spotify）中的音乐启动，然后切换到应用程序，用户的音乐将淡出并暂停。我的应用程序的音乐不会播放，因为它仍然被禁用，所以用户会保持沉默。

如何防止我的应用暂停用户的音乐？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T20:37:31.610

当用户选择删除音频时，您必须执行以下操作：

```
[player stop];
[[AVAudioSession sharedInstance] setCategory:AVAudioSessionCategoryAmbient error:nil]; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T20:36:41.913

您需要设置音频会话类别

```
NSError *categoryError = nil;
[audioSession setCategory: AVAudioSessionCategoryAmbient error: &categoryError]; 
```

如果您将其设置为 AVAudioSessionCategorySoloAmbient （这是默认设置），它会终止背景音乐并让您的应用程序接管，即使您没有播放音乐。当您确实打算播放音乐时，最好将其设置为 SoloAmbient，并在用户禁用音乐时将其设置为 Ambient。

# regex - 正则表达式忽略记事本++中的查找和替换

> ID：15821001
> 
> 赞同：1
> 
> 时间：2013-04-04T20:22:43.257
> 
> 标签：regex, notepad++

我正在寻找一种方法来使用正则表达式命令来查找带有一些随机数的字符串，更改其中一些并保持其他不变。

```
BEFORE: textureFile(A)[(B)] = INFO;

AFTER:  textureFile(A)[(B)] = NEWINFO 
```

在此示例中，我想更改 INFO，同时保持 A 和 B 不变。

我有这个要找到：

```
textureFile..\[.\] = .*; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:29:18.253

尝试这个：`(textureFile\S+\s+=\s+)([^;]+);`

用。。。来代替：`\1NEWINFO;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:29:43.440

根据您的简单示例，搜索以下内容就足够了`=`：

**寻找**

```
(= ).* 
```

**代替**

```
\1NEWINFO; 
```

请注意，我在替换中包含了分号，但它不在查找中。`.*`搜索时会吃掉分号，因此您需要将其添加回替换中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:57:12.323

更具体的解决方案是：

找什么：

```
(textureFile\(.*\)\[\(.*\)\] = )(.*) 
```

用。。。来代替：

```
$1NEWINFO 
```

`. matches newline`禁用该选项。

# android - oAuth 2.0 适用于 2.2 但不适用于 4.1

> ID：15821002
> 
> 赞同：1
> 
> 时间：2013-04-04T20:22:49.980
> 
> 标签：android, oauth-2.0

我现在对 oAuth 有一点问题。它是我一直在弄乱的示例代码，它在 2.2 上完美运行，但是当我在 4.1 上测试它时，我得到了强制关闭错误。

这是我一直在弄乱的示例代码：

```
 public class OAuthAccessTokenActivity extends Activity {

final String TAG = getClass().getName();

private SharedPreferences prefs;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    Log.i(TAG, "Starting task to retrieve request token.");
    this.prefs = PreferenceManager.getDefaultSharedPreferences(this);

    // new OAuthRequestTokenTask(this).execute();

}

@Override
protected void onResume() {
    super.onResume();
    WebView webview = new WebView(this);
    webview.getSettings().setJavaScriptEnabled(true);
    webview.setVisibility(View.VISIBLE);
    setContentView(webview);

    String authorizationUrl = new GoogleAuthorizationRequestUrl(
            OAuth2ClientCredentials.CLIENT_ID,
            OAuth2ClientCredentials.REDIRECT_URI,
            OAuth2ClientCredentials.SCOPE).build();

    /* WebViewClient must be set BEFORE calling loadUrl! */
    webview.setWebViewClient(new WebViewClient() {

        @Override
        public void onPageStarted(WebView view, String url, Bitmap bitmap) {
            System.out.println("onPageStarted : " + url);

        }

        @Override
        public void onPageFinished(WebView view, String url) {

            if (url.startsWith(OAuth2ClientCredentials.REDIRECT_URI)) {
                try {

                    if (url.indexOf("code=") != -1) {

                        String code = extractCodeFromUrl(url);

                        AccessTokenResponse accessTokenResponse = new GoogleAuthorizationCodeGrant(
                                                                                new NetHttpTransport(),
                                                                                new JacksonFactory(),
                                                                                OAuth2ClientCredentials.CLIENT_ID,
                                                                                OAuth2ClientCredentials.CLIENT_SECRET,
                                                                                code, OAuth2ClientCredentials.REDIRECT_URI)
                                                                                .execute();

                        CredentialStore credentialStore = new SharedPreferencesCredentialStore(prefs);
                        credentialStore.write(accessTokenResponse);
                        view.setVisibility(View.INVISIBLE);
                        startActivity(new Intent(OAuthAccessTokenActivity.this,AgentPortalActivity.class));

                    } else if (url.indexOf("error=") != -1) {
                        view.setVisibility(View.INVISIBLE);
                        new SharedPreferencesCredentialStore(prefs).clearCredentials();
                        startActivity(new Intent(OAuthAccessTokenActivity.this,LatitudeApiSample.class));
                    }

                } catch (IOException e) {
                    e.printStackTrace();
                }

            }
            System.out.println("onPageFinished : " + url);

        }

        private String extractCodeFromUrl(String url) {
            return url.substring(
                    OAuth2ClientCredentials.REDIRECT_URI.length() + 7,
                    url.length());
        }
    });

    webview.loadUrl(authorizationUrl);
}   
 } 
```

这是我的日志：

```
 04-04 13:04:50.407: E/AndroidRuntime(20119): FATAL EXCEPTION: main

 04-04 13:04:50.407: E/AndroidRuntime(20119): android.os.NetworkOnMainThreadException

 04-04 13:04:50.407: E/AndroidRuntime(20119):   at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1118)

 04-04 13:04:50.407: E/AndroidRuntime(20119):   at java.net.InetAddress.lookupHostByName(InetAddress.java:385)

 04-04 13:04:50.407: E/AndroidRuntime(20119):   at java.net.InetAddress.getAllByNameImpl(InetAddress.java:236)

 04-04 13:04:50.407: E/AndroidRuntime(20119):   at java.net.InetAddress.getAllByName(InetAddress.java:214)

 04-04 13:04:50.407: E/AndroidRuntime(20119):   at libcore.net.http.HttpConnection.<init>(HttpConnection.java:70)

 04-04 13:04:50.407: E/AndroidRuntime(20119):   at libcore.net.http.HttpConnection.<init>(HttpConnection.java:50)

 04-04 13:04:50.407: E/AndroidRuntime(20119):   at libcore.net.http.HttpConnection$Address.connect(HttpConnection.java:340)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpConnectionPool.get(HttpConnectionPool.java:87)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpConnection.connect(HttpConnection.java:128)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpEngine.openSocketConnection(HttpEngine.java:315)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.makeSslConnecti(HttpsURLConnectionImpl.java:461)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpsURLConnectionImpl$HttpsEngine.connect(HttpsURLConnectionImpl.java:433)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpEngine.sendSocketRequest(HttpEngine.java:289)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpEngine.sendRequest(HttpEngine.java:239)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpURLConnectionImpl.connect(HttpURLConnectionImpl.java:80)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpURLConnectionImpl.getOutputStream(HttpURLConnectionImpl.java:188)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at libcore.net.http.HttpsURLConnectionImpl.getOutputStream(HttpsURLConnectionImpl.java:281)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at com.google.api.client.http.javanet.NetHttpRequest.execute(NetHttpRequest.java:78)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at com.google.api.client.http.HttpRequest.execute(HttpRequest.java:361)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at com.google.api.client.auth.oauth2.draft10.AccessTokenRequest.executeUnparsed(AccessTokenRequest.java:457)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at com.google.api.client.auth.oauth2.draft10.AccessTokenRequest.execute(AccessTokenRequest.java:473)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at com.jetdelivery.mobile.OAuthAccessTokenActivity$1.onPageFinished(OAuthAccessTokenActivity.java:95)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at android.webkit.CallbackProxy.handleMessage(CallbackProxy.java:389)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at android.os.Handler.dispatchMessage(Handler.java:99)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at android.os.Looper.loop(Looper.java:137)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at android.app.ActivityThread.main(ActivityThread.java:4918)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at java.lang.reflect.Method.invokeNative(Native Method)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at java.lang.reflect.Method.invoke(Method.java:511)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)

04-04 13:04:50.407: E/AndroidRuntime(20119):    at dalvik.system.NativeStart.main(Native Method) 
```

似乎崩溃发生在第 95 行，即“.execute();”

谁能给我一些关于我应该做什么的建议？谢谢！

# c++ - 用于文件/运行时权限的 Unix/Linux API

> ID：15821003
> 
> 赞同：0
> 
> 时间：2013-04-04T20:23:02.497
> 
> 标签：c++, c, linux, api, unix

我想写入内存，`/proc/$pid/mem`但我认为这需要超级用户 root 权限。是否有 API 来测试程序是否有权编辑这些文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:28:27.540

您可以在输出`stat()`的路径名和`st_mode`字段中`struct stat`包含权限位。有关详细信息，请参见手册页`stat(2)`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:55:17.157

```
int access(const char *path, int amode); 
```

其中 path 是您的文件名，amode 是要检查的访问权限的按位或。

R_OK、W_OK 和 X_OK 分别保存用于检查读取、写入和搜索/执行权限的模式值。

```
int readable, readwritable;

//checking for read access
readable = access("/usr/bin/file", R_OK);

//checking for read and write access
readwritable = access("/usr/bin/file", R_OK|W_OK); 
```

有关 access() 的完整描述，请查看手册页。

# c# - c#执行shell命令并获取结果

> ID：15821016
> 
> 赞同：15
> 
> 时间：2013-04-04T20:23:40.730
> 
> 标签：c#, shell, command, output, prompt

我正在执行命令提示符命令，如下所示：

```
string cmd = "/c dir" ; 
System.Diagnostics.Process proc = new System.Diagnostics.Process(); 
proc.StartInfo.FileName = "cmd.exe";
proc.StartInfo.Arguments = cmd; 
proc.StartInfo.UseShellExecute = false;
proc.StartInfo.RedirectStandardOutput = true; 
proc.Start(); 
```

如何获得命令的输出？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-04T20:25:59.453

试试这个

```
string output = proc.StandardOutput.ReadToEnd(); 
```

# c# - 如何将图像从 SQL Server 转换为字符串？

> ID：15821020
> 
> 赞同：0
> 
> 时间：2013-04-04T20:24:08.130
> 
> 标签：c#, sql-server, winforms, entity-framework

我在一个项目（Winforms 和 Web 服务项目）中各有两个数据库，并且我使用 Entity Framework 进行查询以将数据从项目 1 发送到项目 2。我的问题是如何将图像从第一个数据库转换为字符串通过查询发送？

这是我的网络服务代码：

```
// Entity Framework
Person sd = new Person(); 
// Method to get data from winforms app
public void GetData(string name,string picture)
{
    sd.name= name;
    sd.picture= ImageToByteArray(picture);
    context.AddToPerson(sd);
    context.SaveChanges();
}

//Method to save the image into database
private Byte[] ImageToByteArray(string source)
{
    FileInfo fInfo = new FileInfo(source);
    long sizeByte = fInfo.Length;
    FileStream fs = new FileStream(source, FileMode.Open, FileAccess.Read);
    BinaryReader br = new BinaryReader(fs);
    byte[] data = br.ReadBytes((int)sizeByte);
    return data;
} 
```

这是我的 Winforms 代码：

```
WebService3SD.Service1SoapClient oService = new WebService3SD.Service1SoapClient();

private void SendData()
{
    Driver dr = context.Drivers.FirstOrDefault(d => d.name == "name1");
    oService.GetData(dr.name,????);//here i have no idea what i have to do ?!
} 
```

为此，我需要一种将图像转换为字符串的方法，所以如果有人对此有任何想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:42:26.097

您可能希望将图像编码为 Base64 以进行传输。现在您的代码正在尝试读取服务器文件系统。看代码如下：

在您发出请求的应用程序中：

```
private void btnEncode_Click(object sender, EventArgs e)
{
  if (!string.IsNullOrEmpty(txtInFile.Text))
  {
    FileStream fs = new FileStream(txtInFile.Text, 
                                   FileMode.Open, 
                                   FileAccess.Read);
    byte[] filebytes = new byte[fs.Length];
    fs.Read(filebytes, 0, Convert.ToInt32(fs.Length));
    string encodedData = 
        Convert.ToBase64String(filebytes,                 
                               Base64FormattingOptions.InsertLineBreaks);
    txtEncoded.Text = encodedData; 
  }
} 
```

在接收方：

```
private void btnDecode_Click(object sender, EventArgs e)
{
  if (!string.IsNullOrEmpty(txtOutFile.Text))
  {
    byte[] filebytes = Convert.FromBase64String(txtEncoded.Text);
    FileStream fs = new FileStream(txtOutFile.Text, 
                                   FileMode.CreateNew, 
                                   FileAccess.Write, 
                                   FileShare.None);
    fs.Write(filebytes, 0, filebytes.Length);
    fs.Close(); 
  }
} 
```

# c - 绕过 Nios II 处理器中的数据缓存

> ID：15821022
> 
> 赞同：0
> 
> 时间：2013-04-04T20:24:11.677
> 
> 标签：c, caching, temporal, nios

我有以下 C 源文件，需要删除一些代码并添加一些代码以绕过 Nios_2_r2c 处理器上的数据缓存。我不知道该怎么做。

### 文件：switch.c

```
#include "system.h"
#include "pio_regs.h"
#include "bsu_macros.h"
#include "switches.h"

static struct pio_regs *SW = (struct pio_regs *)SWITCH_BASE;
static REGISTER SH_SW;

bits get_RUN ( void ) {
    SH_SW = SW->data;
    return getbit(SH_SW, 17);
} 
```

### 文件：ledr.c

```
#include "system.h"
#include "pio_regs.h"
#include "bsu_macros.h"
#include "ledr.h"

static struct pio_regs *LEDR = (struct pio_regs *)LEDR_BASE;
static REGISTER SH_LEDR;

void LEDR_Init ( void ) {
    SH_LEDR = 0;
    LEDR->data = 0;
}

void show_RUN ( bits RUN ) {
    SH_LEDR = putbit (SH_LEDR, RUN, 12);
    LEDR->data = SH_LEDR;
} 
```

通过使用 I/O 读取和写入的内联汇编获得它：

### 文件：switch.c

```
#include "system.h"
#include "pio_regs.h"
#include "bsu_macros.h"
#include "switches.h"

static struct pio_regs *SW = (struct pio_regs *)SWITCH_BASE;
static REGISTER SH_SW;

bits get_RUN ( void ) {
    //SH_SW = SW->data;
    __asm("ldwio %0, %1" : "=r"(SH_SW) : "m"(SW->data));
    return getbit(SH_SW, 17);
} 
```

### 文件：ledr.c

```
#include "system.h"
#include "pio_regs.h"
#include "bsu_macros.h"
#include "ledr.h" 

static struct pio_regs *LEDR = (struct pio_regs *)LEDR_BASE;
static REGISTER SH_LEDR;

void LEDR_Init ( void ) {
    SH_LEDR = 0;
    //LEDR->data = 0;
    __asm("stwio %0, %1" : "=r"(SH_LEDR) : "m"(SW->data));
}

void show_RUN ( bits RUN ) {
    SH_LEDR = putbit (SH_LEDR, RUN, 12);
    //LEDR->data = SH_LEDR;
    __asm("stwio %0, %1" : "=r"(SH_SW) : "m"(SW->data));
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-08-24T17:44:22.287

您可以使用`-mno-cache-volatile`并将变量声明为`volatile`. 事实上，通过读/写某些寄存器实现的 MMIO**必须**始终是易失的。

> *   `-mno-cache-volatile`
> *   `-mcache-volatile`
>     
>     
>     
>     易失性内存访问使用加载和存储指令的 I/O 变体绕过缓存。默认是不绕过缓存。
>     
>     
> 
> [https://gcc.gnu.org/onlinedocs/gcc/Nios-II-Options.html](https://gcc.gnu.org/onlinedocs/gcc/Nios-II-Options.html)

另一种选择是始终绕过缓存`-mbypass-cache`

看

*   [C/C++ 中的内存映射寄存器](https://wiki.osdev.org/Memory_mapped_registers_in_C/C++)
*   [对寄存器使用 volatile](https://stackoverflow.com/q/49039977/995714)
*   [为什么在 C 中需要 volatile？](https://stackoverflow.com/q/246127/995714)
*   [使用内存映射 I/O 管理缓存](https://stackoverflow.com/q/38366109/995714)
*   [NIOS II 中的缓存绕过](https://forums.intel.com/s/question/0D50P00003yyIyuSAE/cache-bypass?language=en_US)

# qt - QML 中继器项不工作

> ID：15821026
> 
> 赞同：3
> 
> 时间：2013-04-04T20:24:35.307
> 
> 标签：qt, grid, repeater, qml

*我已经使用转发器*定义了一个如下所示的网格

 *```
Grid {
    id: grid
    x: 8;y:8
    clip: true
    smooth: false
    rows: 6; columns: 6; spacing: 3
    Repeater {
        id:table
        model:36
        Cell {     //an item created by me
            clip:true
            color:"blue"
              }
    }
} 
```

我想获取网格中任何**单元***格*的位置。为此，在 QML 文件的某处，我写了 x:table.itemAt(3).Center

但是**itemAt**不起作用。事实上，当我在写表的时候。QT 没有在建议工具提示中显示**itemAt**。该怎么办？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-11T16:27:37.047

QML Grid Element 不提供 itemAt 方法。但是，似乎，这就是你要找的东西：

```
Item::childAt ( real x, real y ) 
```

返回位于此项目坐标系中的点 (x, y) 处的可见子项目，如果没有此类项目，则返回 null。看[这里](http://qt-project.org/doc/qt-5.0/qtquick/qml-qtquick2-item.html)*

# python - python/pyqt中的交互式实时绘图

> ID：15821032
> 
> 赞同：-4
> 
> 时间：2013-04-04T20:24:50.070
> 
> 标签：python, qt, real-time

我正在尝试实现一个以实时方式绘制数据的应用程序。我已经尝试了在[这个问题](https://stackoverflow.com/questions/4129697/how-do-i-display-real-time-graphs-in-a-simple-ui-for-a-python-program)中找到的一些代码，但它不起作用。该图在循环之前绘制了一个结果，在`for`循环`for`完成后绘制了一个结果

这是从 Python 解释器在 Ubuntu 中运行的。

我指的代码：

```
import numpy as np
import matplotlib.pyplot as plt

plt.ion()
mu, sigma = 100, 15
fig = plt.figure()
x = mu + sigma*np.random.randn(10000)
n, bins, patches = plt.hist(x, 50, normed=1, facecolor='green', alpha=0.75)
for i in range(50):
    x = mu + sigma*np.random.randn(10000)
    n, bins = np.histogram(x, bins, normed=True)
    for rect,h in zip(patches,n):
        rect.set_height(h)
    fig.canvas.draw() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T04:52:27.003

问题是由于后端而出现的。我有`Qt4Agg`并且在将其更改为`TkAgg`有效之后..不知道为什么 Qt4Agg 不值得...

要更改后端，我必须编辑 /etc/matplotlibrc 文件

编辑：

找到关于 Qt4Agg 的信息而不是调用`draw()`它应该暂停，只要调用需要`pause(0.001)`，这里它暂停 1ms。

这方面的信息

[https://github.com/matplotlib/matplotlib/issues/177](https://github.com/matplotlib/matplotlib/issues/177)

# html - html dom 文本节点

> ID：15821034
> 
> 赞同：0
> 
> 时间：2013-04-04T20:24:52.823
> 
> 标签：html, dom, dhtml

我目前正在自学 HTML DOM，并且我了解到（为了创建 HTML 元素）我必须使用`document.create`& `document.createTextNode`。我的问题是是否所有 HTML 元素都需要一个文本节点？不显示文本的图像标签、表单字段或其他 HTML 元素是否具有 textnode 值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:26:17.237

不需要。只有在元素中需要文本（通过属性提供的内容除外，例如`HTMLInputElement.value`）时，才需要文本节点。

# java - 创建一个新对象并调用一个方法spring配置

> ID：15821037
> 
> 赞同：4
> 
> 时间：2013-04-04T20:25:12.997
> 
> 标签：java, spring

是否有捷径可以在 Spring xml 配置文件中实现以下功能。

```
new MyObject().getData() 
```

代替

```
Object obj = new MyObject();
obj.getData(); 
```

我知道如何在第二种情况下做到这一点。

```
<bean id="obj" class="MyObject" />

<bean id="data" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
      <property name="targetObject"><ref local="obj" /></property>
      <property name="targetMethod"><value>getData</value></property>
 </bean> 
```

我确信必须有一种方法可以在一个定义中做到这一点。请建议。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T20:46:58.970

您是否考虑过在您的`MethodInvokingFactoryBean`.

```
<bean id="data" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
    <property name="targetObject"><bean class="MyObject" /></property>
    <property name="targetMethod"><value>getData</value></property>
</bean> 
```

这基本上等同于您所拥有的，除了没有中间 bean 定义这一事实。不过，我不确定该`MyObject`实例是否会在您的`ApplicationContext`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:34:35.597

您可以尝试使用`@Autowire`.

在需要**MyObject** bean 的类中，您可以使用如下内容：

```
public class MyClass {

      @Autowire
      MyObject myObject;

      public void myMethodofMyClass(){
         myObject.oneMethodOfMyObject();
      }

} 
```

[您可以在弹簧参考手册](http://static.springsource.org/spring/docs/3.0.x/spring-framework-reference/pdf/spring-framework-reference.pdf)（第 54 页）中找到更多信息。

# jakarta-ee - 如何使用 maven 访问 Jboss 中的 InitialContext？

> ID：15821041
> 
> 赞同：0
> 
> 时间：2013-04-04T20:25:34.083
> 
> 标签：jakarta-ee, maven-2, jboss7.x

我曾尝试寻找依赖项来导入它们，但到目前为止还没有任何运气。我找到了这个

```
<dependency>
   <groupId>javax.naming</groupId>
   <artifactId>jndi</artifactId>
   <version>1.2.1</version>
</dependency> 
```

但是 maven 无法解决依赖关系。我正在尝试使用 JNDI 访问本地会话 bean。

我正在尝试在我的 servlet 中做这样的事情

```
MyBean myBean = (MyBean) IntitialContext.lookup("java:module/MyBean"); 
```

当然是进口的`javax.naming.InitialContext`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T02:27:13.123

请尝试使用[JBoss-JavaEE-Specs](https://github.com/jboss/jboss-javaee-specs)

```
<dependency>
    <groupId>org.jboss.spec</groupId>
    <artifactId>jboss-javaee-6.0</artifactId>
    <version>3.0.2.Final</version>
    <type>pom</type>
    <scope>provided</scope>
</dependency> 
```

无论如何，如果您想启用其中的一些，[JBoss Java EE 6 Specification APIs](https://planet.jboss.org/post/jboss_java_ee_6_specification_apis)正式网站也向我们展示了以下内容：-

```
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>org.jboss.spec</groupId>
            <artifactId>jboss-javaee-6.0</artifactId>
            <version>3.0.0.Final</version>
            <scope>import</scope>
            <type>pom</type>
        </dependency>
    </dependencies>
</dependencyManagement>

<dependencies>    
    <!-- javax.enterprise -->
    <dependency>
        <groupId>javax.enterprise</groupId>
        <artifactId>cdi-api</artifactId>
        <scope>provided</scope>
    </dependency>
    <!-- javax.persistence -->
    <dependency>
        <groupId>org.hibernate.javax.persistence</groupId>
        <artifactId>hibernate-jpa-2.0-api</artifactId>
        <scope>provided</scope>
    </dependency>
    <!-- javax.ejb -->
    <dependency>
        <groupId>org.jboss.spec.javax.ejb</groupId>
        <artifactId>jboss-ejb-api_3.1_spec</artifactId>
        <scope>provided</scope>
    </dependency>
    <!-- javax.jms -->
    <dependency>
        <groupId>org.jboss.spec.javax.jms</groupId>
        <artifactId>jboss-jms-api_1.1_spec</artifactId>
        <scope>provided</scope>
    </dependency>
    ...
</dependencies> 
```

我希望这可能会有所帮助。

# jquery - 未捕获的 Sys.ParameterCountException：Sys.ParameterCountException：参数计数不匹配。

> ID：15821043
> 
> 赞同：0
> 
> 时间：2013-04-04T20:25:42.880
> 
> 标签：jquery, ajax, google-maps-api-3, google-api

我正在使用 Google 的免费距离矩阵 API 来计算两个地址之间的英里数。我从地址传入和传给地址，它返回英里但抛出一个错误，说参数计数异常错误。

```
function calculateMiles(from, to) {
            $.ajax({
                type: "GET",
                url: "http://maps.googleapis.com/maps/api/distancematrix/json?origins=" + from + "&destinations=" + to + "&mode=driving&sensor=false&units=imperial"
            }).done(function(response) {
                var miles;
                $.each(response.rows, function() {
                    $.each(this.elements, function() {
                        miles = this.distance.text;
                        return false;
                    });
                    return false;
                });  
                $('#miles').val(miles);
            }).fail(function(response) {
                alert(response);
            });
        } 
```

# css - CSS - 按钮有时无法点击？

> ID：15821046
> 
> 赞同：5
> 
> 时间：2013-04-04T20:25:49.550
> 
> 标签：css, button, hover, margin

我有多个锚元素。偶尔单击它们没有任何作用，所有 CSS 动画都可以工作，但链接没有打开任何页面/触发任何操作。我必须稍微移动光标，然后再次单击。

我确定这是一个 CSS 问题，但我在我的 CSS 中找不到任何问题。我认为问题可能在于边距（4px 下边距但 4px 上边距 on :active）但我在许多网站上都看到了这一点，并且按钮工作得很好......

这是按钮。单击它们，大约 20 次单击中的一次不起作用（但有时它会在第一次单击时发生）：

[http://jsfiddle.net/4nz4v/](http://jsfiddle.net/4nz4v/)（注意按钮在点击后没有获得 .active 类，在最新的 Opera 和 Chrome 中测试过）

这是CSS：

```
.button {
    display: inline-block;
    vertical-align: top;
    color: #000;
    background: #aaa;
    text-shadow: 1px 1px 1px #fff;
    border: 0;
    padding: 0.6em 1.2em;
    margin: 0 0 4px 0;
    text-decoration: none;  
    border-radius: 6px;
}

.button:hover {
    color: #fff;
    text-shadow: none;
}

.button:active {
    margin: 4px 0 0 0;
}

.active {
    background: #fff;
    text-shadow: none;
    color: #000;
} 
```

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:32:26.647

正如您所怀疑的那样，这似乎确实是一个保证金问题。

```
.button:active {
    margin: 4px 0 0 0;
} 
```

删除上面的代码可以解决问题。我会删除此代码并向其父级添加填充以获得更一致的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:37:21.003

找到了解决方案：使用`mouseup`or`mousedown`代替`click`：

```
$('.button').mouseup(function () {
    $(this).siblings().removeClass('active');
    $(this).addClass('active');
}); 
```

[http://jsfiddle.net/4nz4v/3/](http://jsfiddle.net/4nz4v/3/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-08T10:13:02.287

这是一个错误。这是非常一致的：您只需要找到不可点击的行。再次检查您的 JSFiddle，找到文本下方 2 或 3 像素的行。那是您根本无法单击它的地方。如果找不到，请将光标从按钮底部缓慢移动到顶部，一次一个像素，单击每个像素。

不可点击区域横向一致；整个像素行是不可点击的。如果修改了顶部和底部填充，我发现每个按钮最多有两个不可点击的像素行。

当按钮或链接的填充/边距/边框在状态上被修改时，似乎会发生该错误`:active`。

这应该与您的 JSFiddle 一起在此处报告：

*   [https://bugs.webkit.org/enter_bug.cgi](https://bugs.webkit.org/enter_bug.cgi)
*   [https://code.google.com/p/chromium/issues/list](https://code.google.com/p/chromium/issues/list) -> '新问题'。

# c# - 更新Access数据库c#中的一个布尔字段

> ID：15821047
> 
> 赞同：0
> 
> 时间：2013-04-04T20:25:54.083
> 
> 标签：c#, database

我一直在撞墙并不断收到一个模糊的错误“UPDATE语句中的语法错误”。谁能告诉我我的更新声明有什么问题？

```
try 
{
    OleDbConnection ECon = new OleDbConnection(@"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=C:\zoofari\zoofari\zoofari\bin\Debug\MainData.accdb");
    OleDbDataAdapter EdAdapt = new OleDbDataAdapter();
    EdAdapt.UpdateCommand = new OleDbCommand("UPDATE tbl_Results SET @Q1-Easy WHERE Username = '" +txtUname.Text+ "'", ECon);
    EdAdapt.UpdateCommand.Parameters.Add("@Q1-Easy", OleDbType.Boolean).Value = true;

    ECon.Open();
    EdAdapt.UpdateCommand.ExecuteNonQuery();
    ECon.Close();
}
catch (Exception ex)
{
    MessageBox.Show(ex.Message);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:28:15.520

要更新的字段名称在哪里？更新命令所需的语法是

```
UPDATE <tablename> SET <Field> = <value> WHERE <keyfield> = <value> 
```

您的查询没有要更新的字段

```
 EdAdapt.UpdateCommand = new OleDbCommand("UPDATE tbl_Results" + 
                        " SET FIELDNAME= @Q1-Easy WHERE Username = '" +txtUname.Text+ "'", ECon);
                              ^^^^^^^^^^ 
```

另请注意，您永远不应该使用字符串连接来构建 sql 命令。
始终使用参数化查询。（您在此查询中已经有一个参数，为什么不使用另一个？）

在下面看到您对字段名称的评论，那么您的代码可以通过这种方式进行更改

```
string sqlText = "UPDATE tbl_Results SET [Q1-Easy] = ? WHERE Username = ?";
using(OleDbConnection ECon = new OleDbConnection(.....))
using(OleDbCommand cmd = new OleDbCommand(sqlText, ECon))
{
   ECon.Open();
   cmd.Parameters.Add("@Q1Value", OleDbType.Boolean).Value = true;
   cmd.Parameters.Add("@uname", OleDbType.VarChar).Value = txtUname.Text;
   cmd.ExecuteNonQuery();
} 
```

我添加了 using 语句以确保连接已关闭并在完成后处理，并且我已将字段名称括在方括号中，因为我不确定它`-`是否被接受为字段名称的有效字符。

另请注意，在 OleDb 中，参数占位符可能是一个简单的 ? 但是根据占位符在文本中出现的顺序将它们添加到集合中非常重要。OleDb 无法按名称识别参数占位符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:28:07.333

不确定@Q1-Easy 是字段名称还是值，但您需要将字段设置为：

```
UPDATE table SET field = value WHERE field = value; 
```

您的第一个“field = value”部分错误。

# python - 为什么 Python ** 运算符在数组和标量上的行为不同

> ID：15821054
> 
> 赞同：1
> 
> 时间：2013-04-04T20:26:40.947
> 
> 标签：python

我不明白 Python 中 ** 运算符的以下行为的理由。这将返回一个浮点数：

```
>>> 10**-1
0.1 
```

这将返回整数：

```
>>> y=np.array([10,10,10])
>>> y
array([10, 10, 10])
>>> y**-1
array([0, 0, 0]) 
```

为什么？！

以下工作，但上述似乎非常错误。

```
>>> y**-1.0
array([ 0.1,  0.1,  0.1]) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:31:56.040

为了提高效率，numpy 数组被限制为指定的类型，例如你的：

```
>>> y=np.array([10,10,10])
>>> y.dtype
dtype('int64') 
```

因为 int 不能代表小数部分，所以它被丢弃了。如果你使用这样的浮点数组，结果就是你所期望的：

```
>>> y=np.array([10,10,10], dtype='float32')
>>> y.dtype
dtype('float32')
>>> y**-1
array([ 0.1,  0.1,  0.1], dtype=float32) 
```

此外，如果您传入的列表最初包含`float`类型，`dtype`则默认为`float64`：

```
>>> y=np.array([10.0 ,10.0 ,10.0])
>>> y.dtype
dtype('float64')
>>> y**-1
array([ 0.1,  0.1,  0.1]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:28:57.257

numpy 实现它 ST**任何**涉及两个 int 的数学都会导致 int .... 至少这在很大程度上是我的经验

# java - 没有排序方法按字母顺序排序

> ID：15821055
> 
> 赞同：-1
> 
> 时间：2013-04-04T20:26:41.590
> 
> 标签：java, methods, sorting

除了“Collections.Sort(list)”方法之外，他们是另一种对用户在输出框中单独输入的名称列表进行排序的方法吗？

```
import java.util.*;

public class UserInput 
{
public static void main(String[] args) {
List<String> list = new ArrayList<String>();
Scanner stdin = new Scanner(System.in);

do {
    System.out.println("Enter a name: ");
    String strin = stdin.next();
    if (isNumeric(strin)) {
        System.out.println("Please add a non numeric value");
    } else {
        list.add(strin);
    }

    Collections.sort(list);
    System.out.println("Current list is " + list);
    System.out.println("Add more? (y/n)");

} while (stdin.next().startsWith("y"));

System.out.println("List is " + list);
String[] arr = list.toArray(new String[0]);
System.out.println("Array is " + Arrays.toString(arr));
}

public static boolean isNumeric(String str) {
return str.matches("-?\\d+(\\.\\d+)?");
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:28:59.617

您可以使用 a[`TreeSet`](http://docs.oracle.com/javase/6/docs/api/java/util/TreeSet.html)来存储名称。`Comparator`如果您需要自定义排序顺序，您也可以提供它。

**编辑**

正如@jahroy 评论的那样，它会起作用，因为元素（在 a 中`TreeSet`）在插入时会进行排序，因此之后无需执行任何排序。

# gradle - 如何为 gradle sonar-runner 插件指定 cobertura 报告路径？

> ID：15821060
> 
> 赞同：1
> 
> 时间：2013-04-04T20:26:53.590
> 
> 标签：gradle, sonarqube, sonar-runner

我正在尝试将我的配置从旧的 gradle 'sonar' 插件转换为 gradle 1.5 的新 gradle 'sonar-runner' 插件。

由于我切换到了 sonar-runner 插件，所以 sonar 不再重用我的 cobertura coverage.xml 来计算单元测试覆盖率。[我在sonar-runner 用户指南](http://www.gradle.org/docs/current/userguide/sonar_runner_plugin.html)中找不到任何示例来说明如何配置它。以前我使用 sonar.project.coberturaReportPath 来指定我的coverage.xml 的位置。

我的声纳实例是 v.3.4。我正在使用 gradle cobertura 插件来生成我的coverage.xml。

这是我的声纳运行器配置：

```
sonarRunner {
    sonarProperties{
        property "sonar.host.url", "http://sonar"
        property "sonar.jdbc.url", "jdbc:mysql://sonar:3306/sonar"
        property "sonar.jdbc.driverClassName", "com.mysql.jdbc.Driver"
        property "sonar.username", "username"
        property "sonar.password", "password"
        property "sonar.language", "grvy"
        property "sonar.coberturaReportPath", file("$buildDir/reports/cobertura/coverage.xml") //not sure if this is right!
    }
} 
```

这是我的旧声纳配置（有效！）：

```
sonar {
    server {
        url = "http://sonar"
    }
    database {
        url = "jdbc:mysql://sonar:3306/sonar"
        driverClassName = "com.mysql.jdbc.Driver"
        username = "username"
        password = "password"
    }
    project {
        language = "grvy"
        coberturaReportPath = file("$buildDir/reports/cobertura/coverage.xml")
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:43:30.077

您必须确保使用正确的声纳属性。来自[http://docs.codehaus.org/display/SONAR/Code+Coverage+by+Unit+Tests+for+Java+Project](http://docs.codehaus.org/display/SONAR/Code+Coverage+by+Unit+Tests+for+Java+Project)：

```
sonarRunner {
    ...
    sonarProperty "sonar.java.coveragePlugin", "cobertura"
    sonarProperty "sonar.cobertura.reportPath", file(...)
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-29T10:45:24.487

我正在使用：

*   摇篮 1.5
*   声纳 3.4.1
*   [声纳 Groovy 插件](http://docs.codehaus.org/display/SONAR/Groovy+Plugin)0.6

我无法让它工作。Sonar 显示的是“-”而不是覆盖代码的百分比。

我发现这个[JIRA](http://jira.codehaus.org/browse/SONARPLUGINS-2127)应该在[Sonar Groovy Plugin](http://docs.codehaus.org/display/SONAR/Groovy+Plugin) 1.0 中修复，如果您遇到与我相同的问题并且 1.0 已经发布，更新可能会解决问题。

否则，[本主题](http://forums.gradle.org/gradle/topics/code_coverage_reports_cobertura_jacoco_are_not_being_pushed_to_sonar)中讨论了一种解决方法：

*   下载Sonar Groovy 插件的[Spantree fork](https://github.com/Spantree/sonar-groovy)
*   解压缩并构建（`mvn install`在`sonar-groovy-master`项目的根目录中）
*   复制`sonar-groovy-plugin-1.0-spantree-SNAPSHOT.jar`到您的 Sonar 安装目录的`extensions/plugins`子目录中
*   删除或更改旧的扩展名`sonar-groovy-plugin-0.6.jar`
*   `gradle sonarRunner`重新启动声纳并重试

# office-interop - 区分 Excel.Workbook.SaveAs() 中的错误路径和取消输入

> ID：15821061
> 
> 赞同：0
> 
> 时间：2013-04-04T20:26:53.753
> 
> 标签：office-interop, excel-interop

在我的应用程序中，我以编程方式创建一个 Excel 文件，然后保存到预定路径。在一个（可能是常见的）实例中，文件可能已经存在并且 SaveAs() 会弹出一个对话框，询问用户是否要覆盖或取消。另一个（不太可能，但实际上刚刚发生）选项是文件通常保存到的目录 DNE。取消“覆盖？” 对话框和错误的路径名都引发了== 0x800a03ec的`System.Runtime.InteropServices.COMException`异常。`ErrorCode`我想区分这两种情况，这样我就可以默默地取消，或者给用户另一个机会分别将文件保存在其他地方。我在异常中看不到任何其他可以为我提供更多信息的信息。还有别的地方吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T12:43:00.823

我最终测试了文件是否存在，如果它不存在，那么我会弹出一个`SaveFileDialog`窗口让用户选择一个有效的位置。

# wordpress - 如何在彼此的wordpress中连接多个帖子？

> ID：15821062
> 
> 赞同：0
> 
> 时间：2013-04-04T20:27:01.077
> 
> 标签：wordpress, wordpress-theming

有人可以帮助我吗？我想创建一个页面名称库，并且在该页面中有多个帖子，在每个帖子中也有多个帖子与之相连。例如在画廊页面有帖子标题世界末日在世界末日有10或20个帖子连接......谁能给我一些想法或参考。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:43:07.070

如果我做对了，您需要一个显示来自特定类别的帖子的页面。

要正确执行此操作，您需要制作自定义页面模板，设置 div 并将此代码放入这些 div 中：

```
<?php $posts = get_posts('category=3&orderby=rand&numberposts=5');
foreach($posts as $post) { ?>
<a href="<?php the_permalink() ?>" target="_parent">
<?php the_title(); ?></a>
<?php } ?> 
```

正如您在第一行代码中看到的，您可以更改类别、顺序和帖子数量的值。根据您的要求编辑它。

在其他 div 中使用相同的代码，以便能够在同一页面中放置更多帖子类别（及其相应的帖子）。

# java - 使用 EasyMock 对扩展存储过程的 java 类进行单元测试

> ID：15821064
> 
> 赞同：1
> 
> 时间：2013-04-04T20:27:09.407
> 
> 标签：java, easymock, java-stored-procedures

当我尝试对扩展 StoredProcedure 的以下类进行单元测试时，我在以下行收到 NullPointerException：`return (Map) execute(csc, new CallableStatementCallback()`in `JDBCTemplate`class。`execute`我嘲笑了在方法中传递的 bean `DataSource`，以及 sql。

```
public class MyStoredProc extends StoredProcedure {
    /**
     * Constructor - sets SQLParameters for the stored procedure.
     * 
     * @param ds - DataSource
     */
    public MyStoredProc(DataSource dataSource, String sql) {
        super(dataSource, sql);
        declareParameter(new SqlOutParameter("return",Types.NUMERIC));
        declareParameter(new SqlParameter("BATCH_ID",Types.NUMERIC));
        declareParameter(new SqlParameter("PROCESS_TYPE",Types.VARCHAR));

        complie(); 
    }

    public BigDecimal execute(MyBean bean){
        BigDecimal returnValue = BigDecimal.valueOf(-1);

        Map in = new HashMap();

        in.put("BATCH_ID", bean.getBatchID());
        in.put("PROCESS_TYPE", bean.getProcessType());

        Object obj = execute(in);
        if (obj != null) {
            Object output = ((HashMap) obj).get("return"); 

            if( output instanceof BigDecimal) {
                returnValue = (BigDecimal)output;
            }
        }
        return bigDec; 
    }
} 
```

测试用例：PS - 当我调试这个测试用例时，根本没有使用 StoredProcedure 模拟。而是使用了实际的实现。

```
public class MyStoredProcTest {
private MyStoredProc mysp;
private DataSource dataSource;
private String sql;
@Before
public void setUp() {
    dataSource = EasyMock.createMock(DataSource.class);
    sql = "Testing";
    mysp = new MyStoredProc(dataSource, sql);
}

@Test
public void testExecute() {

    StoredProcedure storedProcedure = EasyMock
            .createMock(StoredProcedure.class);
    HashMap map = new HashMap();
    map.put("return", BigDecimal.ONE);
    expect(storedProcedure.execute(EasyMock.anyObject(Map.class))).andReturn(map);

    Connection con = EasyMock.createMock(Connection.class);
    expect(dataSource.getConnection()).andReturn(con);   
    MyBean bean = EasyMock.createMock(MyBean.class);

    expect(bean.getBatchID()).andReturn(BigDecimal.valueOf(.0001))
            .anyTimes();
    expect(bean.getProcessType()).andReturn("Process Type").anyTimes();

    replay(bean, dataSource, storedProcedure, con);
    BigDecimal returnValue = null;
    try {
        returnValue = mysp.execute(bean);
    } catch (Exception e) {
        System.out.println("exception" + e.getStackTrace());//  the Null pointer from JDBCTemplate is caught here.
    }
    Assert.assertEquals(BigDecimal.valueOf(-1), returnValue);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T15:48:22.987

你的一些模拟没有被使用，因为你没有重播它们。你应该修改`replay(bean)`为`replay(bean, datasource, storedProcedure)`

另一方面，`map`不需要嘲笑。当您期望调用时，`storedProcedure.execute(...)`您可以返回预先填充的`map`.

# jquery - 使用 Jquery 覆盖 Nivo Slider 样式的 nivo-control

> ID：15821067
> 
> 赞同：0
> 
> 时间：2013-04-04T20:27:22.667
> 
> 标签：jquery, wordpress, nivo-slider

我在 Wordpress 中使用 Nivo 插件。我想做的是使用 jQuery 根据轮播中的图像数量应用动态缩略图宽度。我遇到的问题是 jQuery 脚本没有得到尊重。我认为 Slider 插件脚本是在我调用我的脚本后加载的，所以它永远不会真正被执行。

这是脚本：

```
<script type="text/javascript">
    jQuery(document).ready(function() {
    // Nivo Pagination
    var imageCount = jQuery(".nivoSlider").children().length;
    var nivoEntry = 824 / imageCount;
    jQuery(".nivo-control").css("width",nivoEntry);
});
</script> 
```

调试时，我尝试将不同的 css 样式应用于 .nivoSlider 类中的不同选择器，但没有成功。这就是为什么我认为这是一个授权问题。我什至尝试将脚本排入函数队列以强制仅最后加载此代码段而没有运气。有没有办法强制它进入 .nivo-control 类？

# hibernate - 在 SELECT 中使用构造函数表达式的 JPQL/Hibernate 限制

> ID：15821074
> 
> 赞同：4
> 
> 时间：2013-04-04T20:27:50.140
> 
> 标签：hibernate, select, jpa, constructor, jpql

根据我对 JPA 2.0 规范的阅读，以下内容应该是有效的：

```
select e.employeeId, new com.foo.Custom(e.employeeName, e.employeeCity) from Employee e 
```

然而，Hibernate 抱怨这个查询，引用了第一个逗号。如果我颠倒所选表达式的顺序，它仍然会抱怨：

```
select new com.foo.Custom(e.employeeName, e.employeeCity), e.employeeId from Employee e 
```

但是如果我只选择构造函数表达式，它会起作用：

```
select new com.foo.Custom(e.employeeName, e.employeeCity) from Employee e 
```

尽管 JPA 2.0 规范中的语法似乎允许使用构造函数表达式，但我在 JPQL 查询的 Web 上搜索了这些示例，但这些示例不是 SELECT 子句中的唯一表达式。除了创建一个将所有数据封装在选定记录中的不同的整体自定义类之外，有没有人知道解决方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-27T07:05:38.483

在 Hibernate-JPA ( `org.hibernate.hql.internal.ast.QuerySyntaxException`) 和 EclipseLink (OK) 上尝试了您的查询。

接下来，我在 Hibernate 上发现了[类似的 2008 年 bug 。](https://hibernate.atlassian.net/browse/HHH-3082)这些查询也可以在 EclipseLink 上运行。

我认为，这是 Hibernate (HQL) 的一个错误。

文档[说](https://docs.jboss.org/hibernate/orm/4.2/devguide/en-US/html_single/#d5e2677)，

> JPQL 是一个深受 HQL 启发的子集。JPQL 查询始终是有效的 HQL 查询，但反之则不然。

事实上，Hibernate 使用与 HQL 相同的语法/解析器来解析 JPQL 查询。

接下来，查看[源文件](https://github.com/hibernate/hibernate-orm/blob/6ffbf8f3f3d22a2e65017e4b6a1717a1297a17b9/hibernate-core/src/main/antlr/hql.g#L333)（HQL ANTLR 语法），我看到了：

```
selectClause
: SELECT^   // NOTE: The '^' after a token causes the corresponding AST node to be the root of the sub-tree.
    { weakKeywords(); } // Weak keywords can appear immediately after a SELECT token.
    (DISTINCT)? ( selectedPropertiesList | newExpression | selectObject )
;

newExpression
: (NEW! path) op:OPEN^ {#op.setType(CONSTRUCTOR);} selectedPropertiesList CLOSE!
; 
```

所以，现在很清楚，为什么 Hibernate 会抛出`QuerySyntaxException`. 使用 Hibernate JPQL 时，我们被迫选择以下三个选项之一：

*   属性列表（即`e.employeeName, e.employeeCity`）
*   构造函数表达式（即`new com.foo.Custom(e.employeeName, e.employeeCity)`）
*   来自“FROM”子句的对象标识符（即`e`）

# jquery - Fancybox jQuery：iframe 与 ajax

> ID：15821076
> 
> 赞同：1
> 
> 时间：2013-04-04T20:27:53.323
> 
> 标签：jquery, fancybox

有人可以解释通过 iframe 与 Ajax 将内容加载到 Fancybox 之间的区别吗？

此外，是否可以拥有一个包含 iframed 或 Ajax 内容的画廊（例如 rel="gallery"）？

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:06:04.450

当您使用`iframe`模式时，打开的页面作为与调用页面完全分离和独立的页面，它可能具有自己的结构、功能和样式。您可以跳过以在 fancybox 中打开页面并在新窗口/选项卡中打开它。

另一方面，使用`ajax`模式，打开的内容成为调用页面 DOM 结构的一部分（通常作为 html 元素，如 a `<div>`），并且可以继承调用页面的样式、功能和属性。

关于 ：

```
is it possible to have a gallery (e.g. rel="gallery") with either 
iframed or Ajax'ed content? 
```

... 答案是**肯定**的。您可以**在同一个**fancybox 库、图像、swf 对象、内联内容（来自隐藏的`<div>`）、youtube 视频、ajax 内容、iframed 页面、pdf 文档和脚本内的硬编码自定义内容中组合。

这[是一个](http://jsfiddle.net/VNPzA/)结合图像和 youtube 视频的画廊示例。

# sql-server - 如何将自定义数据库合并到 Drupal？

> ID：15821077
> 
> 赞同：0
> 
> 时间：2013-04-04T20:27:55.830
> 
> 标签：sql-server, drupal

我对 MSSQL 完全陌生，需要将我们在 ASP.net 中开发的新闻站点中的数据库合并到新的 Drupal 服务器。我已经在网上找了几天了，还没有找到任何有用的结果或教程。[这个问题](https://stackoverflow.com/questions/8158494/importing-and-exporting-data-from-an-asp-net-based-web-app-to-drupal "这个问题")有点相关，但我只需要对数据进行一次单向传输。如何将旧数据导出并重新映射到 Drupal 的布局中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:06:12.860

没有“简单”的方法。

这两个模块可能是您最好的选择。

1.  [迁移模块](http://drupal.org/project/migrate)
2.  [饲料](http://drupal.org/project/feeds)

所以首先按照您想要的方式安装和设置 Drupal。然后使用上述两个或任何一个模块将 MSSQL 数据库的各个部分传输到 Drupal，您将需要阅读这两个模块的文档以决定您应该如何做。

# java - 我必须从 excel 文件（xlsx 格式）中读取数据，然后操作该数据

> ID：15821078
> 
> 赞同：-1
> 
> 时间：2013-04-04T20:28:01.910
> 
> 标签：java

我正在为班级做一个项目，需要这部分的帮助。我只需要知道是否有一种方法可以逐行读取 excel 文件并操作该数据。具体来说，我正在创建一个“客户”对象，excel 文件中的每一行都是客户的数据（姓名、地址等）。我不能使用任何第三方库或类似的东西。

有没有办法使用 BufferReader 或 FileInputStream 来做到这一点。这些是我们在课堂上阅读过的文件的仅有的两种读取方式。我也尝试将其保存为 CVS 文件，但它不允许我这样做。或者扫描仪使用分隔符？

我可以将所有内容复制到记事本中并从那里进行操作吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:33:45.927

好吧，不使用任何第三方库作为家庭作业将非常困难。我强烈推荐使用[Apache POI](http://poi.apache.org/)

[这](http://www.avajava.com/tutorials/lessons/how-do-i-write-to-an-excel-file-using-poi.html)是一个从 POI 开始的好教程。

# asp.net - 快速关闭和打开 CustomErrors 以进行生产和开发

> ID：15821085
> 
> 赞同：2
> 
> 时间：2013-04-04T20:28:17.167
> 
> 标签：asp.net, web-services, exception-handling, custom-error-pages, custom-errors

我开发了很多 ASP.NET Web 表单。在测试期间，我关闭了 customErrors，然后在将表单移入生产环境时出现了 ResponseRedirect 自定义错误。

我想知道是否可以通过更改设置值来简化我的开发。

我想要的只是将我的 Properties.Settings.Default.TestMode 值从**开发人员**更改为**生产**，然后打开 customError。

所以我在想我的 Global.asax.cs 代码可能看起来像：

```
protected void Application_Error(object sender, EventArgs e) {
  if (Properties.Settings.Default.TestMode == "production") {
    Server.ClearError();
    Response.Redirect("errorpage.htm");
  } 
  else {
    // Not sure what it would do here. Nothing?
  }
} 
```

但后来我不确定我的 Web.config 文件中会出现什么。CustomErrors 如下所示。

```
<!--<customErrors mode="Off" />-->
<customErrors mode="On" defaultRedirect="ErrorPage.htm" redirectMode="ResponseRedirect"/> 
```

现在我只是注释掉/在我需要做出改变的地方。我觉得我一直都在这样做，让我创建的 TestMode 设置完成所有工作会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:53:31.663

您想查看**Web.Config Transformation**。它允许您独立设置开发和生产的特定设置。

这是 Microsoft 的一个很好的介绍：[如何：在部署 Web 应用程序项目时转换 Web.config](http://msdn.microsoft.com/en-us/library/dd465318%28v=vs.100%29.aspx)

# asp.net - 在 webmatrix 中注册后无需电子邮件验证即可登录

> ID：15821089
> 
> 赞同：0
> 
> 时间：2013-04-04T20:28:37.677
> 
> 标签：asp.net, webmatrix

我已经使用网页（webmatrix）而不是 MVC 设置了一个网站。我希望用户在注册后无需进行电子邮件验证即可登录，我该如何实现？我问这个是因为我的 smtp 设置为 WebMail.SmtpServer = "smtp.gmail.com"; 和验证电子邮件要么不发送到 hotmil 或实时电子邮件，要么发送得很晚，因此可能会让用户感到沮丧。不过它很快就转到了gmail，

所以我决定用户可以在没有电子邮件验证的情况下登录，请帮我这样做。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-26T13:12:13.553

WebSecurity.CreateAccount() 方法需要三个参数来创建会员账户

*   **用户名**
*   **密码**
*   **requireConfirmationToken** [可选参数]

要在没有用户验证电子邮件的情况下创建帐户，只需设置 requireConfirmationToken = false。默认为假。你的代码应该是这样的

```
WebSecurity.CreateAccount(email, password, false); 
```

该代码只是告诉 Websecurity 类不要期望来自用户的令牌。

# javascript - 即使在调试之后也不会运行的简短 Java 脚本代码

> ID：15821103
> 
> 赞同：0
> 
> 时间：2013-04-04T20:29:37.680
> 
> 标签：javascript

我一直在做这个作业，将伪代码转换为 java 脚本。

我有信心我正确地拥有它，但是当我尝试执行它时，我只会得到一个空白的白色屏幕。

我将它通过沙箱并设法纠正了大多数可能使其无法运行的语法错误，但它仍然拒绝工作或显示任何内容。

我仍在学习，我不知道如果没有沙箱来帮助调试我的代码我会做什么，但是当它找不到任何进一步的东西时，我会被困在做什么。

有什么建议可以为一个完整的新手调试 java 脚本代码吗？

这是代码：

```
<html>
<body>
<script type="text/javascript">

// Declare variables
var username;           // potential username entered by user
var char1;              // one character extracted from username
var anyDigits = False;  // variable to signify presence of digits
var index;              // loop variable for extracting characters
var BR = "<br />";
var ES = "";

// Display program heading and requirements and ask for username
document.write("This program helps you set up a valid username." + BR);
document.write("Your username must be at least 8 characters long," + BR);
document.write("   start with a letter, and contain at least 1 digit." + BR);
username = prompt("Please enter your name: ", ES);

// Check for length of username
while (username.length < 8) {
    document.write("ERROR...your username must be at least 8 characters long." + BR);
    username = prompt("Please enter your new username: ", ES);
}

// Check that first character is a letter
// Substring function has three arguments: string, starting position, and ending position
char1 = username.substr(0, 0);
while (char1 !== isLetter()) {
    document.write("ERROR: the first character of your username must be a letter." + BR);
    username = prompt("Please enter your new username: ", ES);
}

// Check that there's at least one digit in the username
while (anyDigits !== True) {
    // Check each character, set anyDigits to true if a digit
    for (index = 1; index < username.substr(index, index); index++) {
        char1 = username.substr(index, index);
        if (isNumeric(char1)) {
            anyDigits = True;
        }
    }

// If anyDigits is still false, no digits were present
    if (anyDigits !== True) {
        document.write("ERROR:...your username must include at least 1 digit." + BR);
        username = prompt("Please enter your new username: ", ES);
    }
}

// Thank the user and end the program
document.write("Thank you! Your new username is: " + username);

</script>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:31:22.823

true 和 false 区分大小写。

将 True 更改为 true 并将 False 更改为 false

您也可以使用调试器，如 firebug（firefox 的插件）或 chrome，只需按 F12 键即可。对于上述情况，您肯定会在控制台中收到错误消息。

javascript 中没有称为 isNumeric() 或 isLetter() 的此类函数。你可以试试这个

```
if(isNaN(parseInt(char1))) 
{
    //it is a string  
}
else
{
    //it is a number
} 
```

# c - 许多 for 循环总结为一个循环

> ID：15821108
> 
> 赞同：0
> 
> 时间：2013-04-04T20:29:58.813
> 
> 标签：c, loops, for-loop, iteration

我正在设计一个效率极低的幻方求解器，它会告诉您3x3 正方形的解数*。*本质上，我必须将 3x3 数组中的每个元素填充到某个数字（例如 16），然后重置，移动到下一个元素并像两位数增加一样填充它们。我已经设法通过使用 9 个 for 循环来实现这一点，每个元素一个。但是如果我想做一个 5x5 的正方形，我必须写 25 个循环吗？

代码的 for 循环部分如下。有没有办法通过for循环来总结这个和for循环？

```
for (sq9=1; sq9<17 ; sq9++) {
     for (sq8=1; sq8<17 ; sq8++) {
          for (sq7=1; sq7<17 ; sq7++) {
               for (sq6=1; sq6<17 ; sq6++) {
                    for (sq5=1; sq5<17 ; sq5++) {
                          for (sq4=1; sq4<17 ; sq4++) {
                               for (sq3=1; sq3<17 ; sq3++) {
                                    for (sq2=1; sq2<17 ; sq2++) {
                                         for (sq1=1; sq1<17 ; sq1++) {
                                              if  ( check_the_square() ) count++;
                                                            }}}}}}}}}} 
```

`*** EDIT ***`

问这个问题 7 年后，我是一家大公司的首席工程师，领导着一个敬业的团队。感谢那些在这里……温柔的人。谢谢你对我的耐心，你的好意走了很长一段路

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:47:58.893

有不止一种方法可以将所有这些概括为任意数量的正方形，但我想到的第一个方法是将所有正方形存储在一个数组中，并像递增一个用数字写出的数字一样递增它们。

首先，让我们用一些易于编辑的常量抽象出正方形的数量及其值的范围：

```
#define NUM_SQUARES 9
#define MIN_VAL     1
#define MAX_VAL     16 
```

现在，在您正在执行所有这些操作的任何函数中，声明一个 s 数组`int`并将它们全部设置为`MIN_VAL`：

```
int squares[NUM_SQUARES];
for (int i=0; i<NUM_SQUARES; i++) {
    squares[i] = MIN_VAL;
} 
```

现在，我们将如何增加正方形？简单：在第一个值上加一个；如果溢出`MAX_VAL`，将其设置为`MIN_VAL`并继续下一个方块。如果它没有溢出，停止，我们可以检查当前的配置。如果所有的方格都溢出并且我们移过了数组的末尾，我们知道我们已经处理了所有可能的方格配置，我们可以结束整个事情。

这在代码中会是什么样子？像这样的东西：

```
int i = 0;
do {
    if (check_the_square()) count++;
    for (i=0; i<NUM_SQUARES; i++) {
        squares[i]++;
        if (squares[i] > MAX_VAL) {
            squares[i] = MIN_VAL;
        } else {
            break;
        }
    }
} while (i < NUM_SQUARES); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:57:10.953

有一些库可以生成所有排列，但如果你想自己做，你可以通过一个值数组来管理它，从所有值开始为 0 并以所有值结束为 16。

```
const int SIZE = 3;
const int START_VALUE = 1;
const int FINAL_VALUE = 16;
int elements[3][3] = {START_VALUE}; 
```

然后定义一组函数来处理该数组。

```
// Will return false when all combinations have been tried.
bool has_next_permutation(int array[SIZE][SIZE]) {
    for (int i = 0; i < SIZE; ++i) {
        for (int j = 0; j < SIZE; ++j) {
            if (array[i][j] != START_VALUE) {
                // We're not back to all elements being 0, so we're not done.
                return true;
            }
        }
    }
    return true;
}

// Gets the next permutation.
// Increase the first element by 1, and if it hits 17, reset it and
// increase the second element by 1, etc.
void get_next_permutation(int array[SIZE][SIZE]) {
    for (int i = 0; i < SIZE; ++i) {
        for (int j = 0; j < SIZE; ++j) {
            array[i][j]++;
            if (array[i][j] <= FINAL_VALUE) {
                // Hasn't reached the final value yet.
                return;
            }
            array[i][j] = 0;
        }
    }
} 
```

然后在循环中使用它，例如：

```
do {
    check_the_square();
    get_next_permutation(elements);
} while (has_next_permutation(elements)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:47:27.670

使用一个数组来替换你的`sq#`和一个计算下一次迭代的小算法......在这里你基本上需要一个 +1 运算符来用 9 位数编写的 base-17 中的数字......

```
 char sq[9] = { 1, 1, 1, 1, 1, 1, 1, 1, 1 };
  int l = 8;
loop:
  if (l==-1) goto end;
  if (++sq[l]==18) { sq[l--]=1; goto loop; }
  check_the_square();
  l = 8;
  goto loop;
end:
  ... 
```

# javascript - 使用 jQuery UI 将 div 堆叠成金字塔

> ID：15821111
> 
> 赞同：7
> 
> 时间：2013-04-04T20:30:09.747
> 
> 标签：javascript, jquery, jquery-ui, jquery-ui-sortable, jquery-ui-draggable

我正在尝试使用 jquery 将元素堆叠成金字塔，但我看不到它是否正确。

例如，我想要一个包含 3 个项目（苹果、香蕉、奇多）的列表。使用 droppable 或 sortable，我想将这些项目移动到不同的元素，并将它们堆叠在金字塔中。

[…………][奇多][…………]

[苹果][…………][香蕉]

到目前为止，我已经能够组合列表元素和空元素，因此它们都是可排序的，我可以将列表项放入金字塔元素中。这行得通。

问题是无法将物品堆叠成金字塔以外的配置，例如，将苹果、香蕉和奇多插入顶行。

我还希望将移动的元素实际移动到 DOM 中。我认为这意味着可拖动/可放置功能不适用于此应用程序，但我可能错了。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T12:58:19.490

我为您的问题做了简单的小提琴[http://jsfiddle.net/QXwyk/6/](http://jsfiddle.net/QXwyk/6/) 基本概念是通过 css 将 ul 列表更改为 pytamid。虽然添加元素效果很好，但不幸的是在金字塔中移动元素时它搞砸了。也许这会对您有所帮助，或者它可能是进一步测试的好地方。

html

```
<ul id="pyramid" class="pyramid sortable">
</ul>

<ul id="fruits" class="fruits sortable">
    <li>cheeto</li>
    <li>apple</li>
    <li>banana</li>
    <li>kiwi</li>
    <li>strawberry</li>
    <li>limon</li>
</ul> 
```

JS

```
$("#fruits, #pyramid").sortable({
    connectWith: ".sortable",
    placeholder: "ui-state-highlight",
    cursor: "move",
}).disableSelection(); 
```

# internet-explorer-9 - ie9 与 ie10 的兼容性

> ID：15821113
> 
> 赞同：2
> 
> 时间：2013-04-04T20:30:11.770
> 
> 标签：internet-explorer-9, internet-explorer-10

我们的网站目前在 ie9 中运行，我们正在考虑我们需要做些什么来确保它在 ie10 中运行。基于此，我有 2 个问题

1>如果我升级到ie10，f12 ie 9 浏览器模式是否足以替代ie9？或者我是否必须有一个单独的带有 ie9 的虚拟机才能绝对确保它看起来不错。

2>我应该在 ie 9 中工作但在 ie 10 中不起作用的 HTML 代码中特别寻找什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-03T14:24:59.823

我遇到的一个问题是 IE10 兼容模式在设置非标准元素属性时会中断。

记录在这里：[http](http://bugs.jquery.com/ticket/12577) ://bugs.jquery.com/ticket/12577 和这里：[https ://connect.microsoft.com/IE/feedback/details/774078](https://connect.microsoft.com/IE/feedback/details/774078)

这意味着这样的代码会导致`member not found`错误，因为 IE7 不支持 'placeholder' 属性。如果使用 jQueryUI，这是一个主要问题

```
var input = jQuery( "<input>" )
            .appendTo( 'body')
            .val("Look at me")
            .attr("placeholder", "type something"); //setting placeholder attr will error 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-03T14:29:15.547

作为一般规则，如果它可以在旧版本的 IE 中运行而不使用 hack，那么它也可以在新版本中运行。

IE的兼容模式已经改进了一些，所以现在它实际上会假装不支持你设置的浏览器模式的东西（比如不支持`border-radius`IE8模式，或者`JSON`IE7模式），所以我认为这是一个“足够好”代替。但是，毫无疑问，您无法确定这一点，因此如果可以的话，我建议您使用 IE9 设置 VM。

旁注：一定要包括`<meta http-equiv="X-UA-Compatible" content="IE=edge" />`以避免令人讨厌的惊喜。

# java - jxls 无法读取电子表格电子邮件超链接上的单元格

> ID：15821114
> 
> 赞同：0
> 
> 时间：2013-04-04T20:30:31.067
> 
> 标签：java, excel, apache-poi, jxls

您好我正在使用 jxls 将数据从 excel 文件读取到 java bean。映射时遇到问题。电子表格中有一个名为 email 的列 F2，它是一个电子邮件超链接。当我尝试运行时，我得到 net.sf.jxls.reader.XLSDataReadException: Can't read cell F2 on Subscribers 电子表格，我的单元格映射是 subscriber.email 。与映射有关系吗？你能告诉我如何摆脱这个例外吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T20:05:36.407

映射文件中的单元格 F2 用于subscriber.heightInInches，我认为它是一个整数。如果这在您的电子表格中包含电子邮件地址，则 JXLS 无法将其加载到 int 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-21T05:17:51.813

您只需通过评论电子邮件列（F2）来检查它是否会解析，然后检查模型类或 xml 文件中是否存在不匹配的内容

# python - 如何在python中测量knn分类器的准确性

> ID：15821116
> 
> 赞同：9
> 
> 时间：2013-04-04T20:30:36.943
> 
> 标签：python, python-2.7, machine-learning, scikit-learn, knn

我使用 knn 对我的数据集进行分类。但是我不知道如何衡量训练好的分类器的准确性。scikit 是否有任何内置功能来检查 knn 分类器的准确性？

```
from sklearn.neighbors import KNeighborsClassifier
knn = KNeighborsClassifier()
knn.fit(training, train_label)    
predicted = knn.predict(testing) 
```

感谢所有的帮助。谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-04T20:47:47.257

使用[`sklearn.metrics.accuracy_score`](http://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html)：

```
acc = accuracy_score(test_label, predicted) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2019-07-05T18:09:23.723

您可以使用此代码直接开始。它使用 IRIS 数据集。iris 数据集中有 3 个类可用，`Iris-Setosa, Iris-Virginica, and Iris-Versicolor`.

使用此代码。这给了我`97.78%`准确性

```
from sklearn import neighbors, datasets, preprocessing
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score
from sklearn.metrics import classification_report
from sklearn.metrics import confusion_matrix

iris = datasets.load_iris() 
X, y = iris.data[:, :], iris.target
Xtrain, Xtest, y_train, y_test = train_test_split(X, y, stratify = y, random_state = 0, train_size = 0.7)

scaler = preprocessing.StandardScaler().fit(Xtrain)
Xtrain = scaler.transform(Xtrain)
Xtest = scaler.transform(Xtest)

knn = neighbors.KNeighborsClassifier(n_neighbors=3)
knn.fit(Xtrain, y_train)
y_pred = knn.predict(Xtest)

print(accuracy_score(y_test, y_pred))
print(classification_report(y_test, y_pred))
print(confusion_matrix(y_test, y_pred)) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-05T14:33:00.450

另一种选择是计算混淆矩阵，它会告诉您两个类的准确性以及 alpha 和 beta 误差：

```
from sklearn.metrics import confusion_matrix
con_mat = confusion_matrix(true_values, pred_values, [0, 1]) 
```

如果您的标签是 0 和 1。如果您想要一个好的输出，您可以添加以下代码：

```
from numpy import np
import math
total_accuracy = (con_mat[0, 0] + con_mat[1, 1]) / float(np.sum(con_mat))
class1_accuracy = (con_mat[0, 0] / float(np.sum(con_mat[0, :])))
class2_accuracy = (con_mat[1, 1] / float(np.sum(con_mat[1, :])))
print(con_mat)
print('Total accuracy: %.5f' % total_accuracy)
print('Class1 accuracy: %.5f' % class1_accuracy)
print('Class2 accuracy: %.5f' % class2_accuracy)
print('Geometric mean accuracy: %.5f' % math.sqrt((class1_accuracy * class2_accuracy))) 
```

# magento - 找到一个magento方法定义，特别是getOptionList()

> ID：15821118
> 
> 赞同：0
> 
> 时间：2013-04-04T20:30:39.610
> 
> 标签：magento, magento-1.7

我一直在将 Magento 的愿望清单模块重新用于我自己的版本，并且在重新跟踪它的每个部分是如何组合在一起方面取得了很大的成功。

在**app/design/frontend/package/theme/template/wishlist/options_list.phtml**中是愿望清单显示产品选项和配置的方式。它调用`$this->getOptionList()`返回与该产品关联的选项/配置数组。我无法追踪此方法的来源，因此我搜索了整个**app/code/core/**目录，但没有发现与愿望清单相关的内容！

这种方法从何而来？我想在愿望清单模块的其他地方使用它，但它似乎是该特定类独有的，但它没有在任何地方定义，所以我完全糊涂了。

Magento 1.7

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:00:24.297

**tl;dr**：`setOptionList`通过一种魔术方法调用，该方法生成一个名为`option_list`. 这可以通过`getOptionList`稍后检索。

*首先，让我们从模板开始：*

模板文件 options_list.phtml 使用`Mage_Wishlist_Block_Customer_Wishlist_Item_Options`块类。该类扩展`Mage_Wishlist_Block_Abstract`，扩展`Mage_Catalog_Block_Product_Abstract`。该类文件又扩展`Mage_Core_Block_Abstract`了 ，它最终是`Varien_Object`.

这些类都没有名为 的属性或方法`options_list`。那么它是从哪里来的呢？

**这是 Magento 的 ORM 的一部分，**它为对象中的某些数据提供**魔术 getter 和 setter**。对象的属性通过下划线分隔，并且很多时候与数据库表的列名相关。许多对象直接与数据库表相关。例如，`base_tax_amount`在 sales_flat_order 中通过 调用`getBaseTaxAmount()`。

但是，如何`option_list`填充？简单的。在`Mage_Wishlist_Block_Customer_Wishlist`第 178 行：

```
 return $block->setTemplate($template)
        ->setOptionList($helper->getOptions($item))
        ->toHtml(); 
```

这种行为是通过`__call`PHP 中的一个内置功能实现的，它允许您在引用不存在的类方法时路由方法调用：

[http://php.net/manual/en/language.oop5.magic.php](http://php.net/manual/en/language.oop5.magic.php)

**现在怎么办？我需要扩展这个！**

好消息，你可以。`Mage_Wishlist_Block_Customer_Wishlist_Item_Options`像往常一样扩展或重写该类并添加以下方法：

```
public function getOptionList()
{
  $options = parent::getOptionList();
  //your functionality here
  return $options;
} 
```

当通过 option_list.phtml 模板调用时，将找到您的新方法，并且您的方法将引用父级 - 我们知道它不存在。这将回退到`__call`，这将返回`option_list`您对象的属性。**最后别忘了回来`$options`**！

*补充阅读：*

这可能有助于您了解 Magento 核心的 Varien 对象系统：

[http://alanstorm.com/magento_varien_object_debugging](http://alanstorm.com/magento_varien_object_debugging)

# javascript - 使用 Internet Explorer 时发出警报

> ID：15821119
> 
> 赞同：-3
> 
> 时间：2013-04-04T20:30:41.667
> 
> 标签：javascript, jquery, internet-explorer

我试图让我的用户远离 IE。如果用户使用任何版本的 IE 来使用 Firefox 或 Chrome，我想显示警报。我尝试了不同的 jQuery 方法，但没有任何效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:42:49.227

[这篇文章](https://stackoverflow.com/questions/13478303/correct-way-to-use-modernizr-to-detect-ie)将帮助您检测浏览器。它指出，虽然 Modernizr 将帮助您执行各种特定于浏览器的操作，但它不会帮助您检测浏览器。它还显示了如何做到这一点。

除此之外，如果您正在使用 jQuery 并且愿意使用 jQuery UI，您可以创建一个[对话框](http://jqueryui.com/dialog/)来指示用户他们正在使用 IE，并就他们应该如何以及为什么迁移提出建议。

也许这不是重点，但作为一名 Web 开发人员，我认为支持现有技术是我工作的一部分，并且会担心（充其量）混淆和（最坏情况）通过告诉用户他们不应该使用特定的浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:32:30.373

使用[条件注释](http://msdn.microsoft.com/en-us/library/ms537512%28v=vs.85%29.aspx)

```
<!--[if IE ]>
<script LANGUAGE="javascript">
alert("Congratulations! You are running Internet Explorer");
</script> 
```

但是根据[MSDN是的](http://msdn.microsoft.com/en-us/library/ms537512%28v=vs.85%29.aspx)

> 重要 从 Internet Explorer 10 开始，标准模式不再支持条件注释

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T20:34:59.573

检查这个

```
if(navigator.userAgent.toLowerCase().indexOf("msie") > -1)
{
    alert("You are using IE")
} 
```

# python - 使用 IDLE 时的工作目录是什么？

> ID：15821121
> 
> 赞同：33
> 
> 时间：2013-04-04T20:30:55.023
> 
> 标签：python, python-idle

因此，我正在学习 Python，并想创建一个简单的脚本来从 Internet 下载文件，然后将其写入文件。但是，我正在使用 IDLE，不知道 IDLE 中的工作目录是什么或如何更改它。如果我不知道工作目录或如何更改它，如何在 IDLE 中处理文件系统？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-04-04T20:33:34.280

您可以使用以下方法轻松检查自己[`os.getcwd`](http://docs.python.org/3/library/os.html#os.getcwd)：

```
>>> import os
>>> os.getcwd()
'C:\\Program Files\\Python33' 
```

那是在我的Windows机器上，所以它可能是Python本身的安装目录。

您可以在运行时使用以下命令更改该目录[`os.chdir`](http://docs.python.org/3/library/os.html#os.chdir)：

```
>>> os.chdir('C:\\Users\\poke\\Desktop\\')
>>> os.getcwd()
'C:\\Users\\poke\\Desktop'
>>> with open('someFile.txt', 'w+') as f:
        f.write('This should be at C:\\Users\\poke\\Desktop\\someFile.txt now.') 
```

这将——毫不奇怪——在我的桌面上创建文件。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-04T20:32:06.780

您可以使用以下方法检查`os.getcwd()`：

```
In [1]: import os

In [2]: os.getcwd()
Out[2]: '/home/monty'

In [7]: os.chdir("codechef")    #change current working directory

In [8]: os.getcwd()
Out[8]: '/home/monty/codechef' 
```

**`os.chdir()`**：

```
In [4]: os.chdir?
Type:       builtin_function_or_method
String Form:<built-in function chdir>
Docstring:
chdir(path) 
```

**`os.getcwd()`**：

```
Change the current working directory to the specified path.

In [5]: os.getcwd?
Type:       builtin_function_or_method
String Form:<built-in function getcwd>
Docstring:
getcwd() -> path

Return a string representing the current working directory. 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-04-04T20:35:26.713

这将取决于操作系统以及 IDLE 的执行方式。

要更改 Windows 中的（默认）CWD，请右键单击快捷图标，转到“属性”并更改“开始于”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-04T20:36:25.890

这是来自[usfca.edu的摘录](http://msan501.cs.usfca.edu/home/idleworkingdirectory)

> 如果您希望能够在 IDLE 中轻松导入文件，则需要确保 IDLE 的工作目录设置为包含所有代码的文件夹。例如，我的课堂代码位于目录/Users/sjengle/Desktop/Code，所以要更改IDLE的工作目录，我需要运行以下两个命令：

```
import os
os.chdir("/Users/sjengle/Desktop/Code") 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-09-09T18:04:00.927

我知道的老问题，但也许 OP 的问题没有得到回答？如果希望 Idle 的 File Open/Save/Save As 菜单项与特定文件夹交互，则需要在启动 Idle*之前设置 CWD。*因此，假设您在 Windows 上有一个文件夹“C:\Users<username>\Documents\python\my_project”，然后在 cmd 提示符下键入`cd C:\Users\<username>\Documents\python\my_project`，然后启动 Idle

# c - 从C中的数组中删除元素

> ID：15821123
> 
> 赞同：30
> 
> 时间：2013-04-04T20:30:58.000
> 
> 标签：c, arrays, subtraction

我只是对 C 中的数组有一个简单的问题

从数组中删除元素并在此过程中使数组更小的最佳方法是什么。

即数组是 n 大小，然后我从数组中取出元素，然后数组变小了我从中删除它的数量。

基本上，我将阵列视为一副纸牌，一旦我从纸牌的顶部取出一张卡片，它就不应该再存在了。

编辑：我要在一天结束之前让自己发疯，感谢所有帮助我尝试价值交换的东西，但它不能正常工作。

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

enum faces{Ace = 0, Jack = 10, Queen, King};
char * facecheck(int d); 
int draw(int deck, int i); 
int main() 
{ 
    int deck[52], i, n;
    char suits[4][9] = 
    {
        "Hearts",
        "Diamonds",
        "Clubs",
        "Spades"};

    n = 0;

    for(i = 0; i<52; i++)
    {
        deck[i] = n;
        n++;
     };

    for(i=0; i<52; i++)
    {       
        if(i%13 == 0 || i%13 == 10 || i%13 == 11 || i%13 == 12)
            printf("%s ", facecheck(i%13) );
        else printf("%d ", i%13+1);
        printf("of %s \n", suits[i/13]);
    }

    draw(deck, i);

    return 0; 
}  

char * facecheck(int d)
{
    static char * face[] = 
    {
        "Ace",
        "Jack",
        "Queen",
        "King" };

    if(d == Ace)
        return face[0];
    else
    {
        if(d == Jack) 
            return face[1];
        else
        {
            if(d == Queen)
                return face[2];
            else 
            { 
                if(d == King)
                    return face[3];
            }
        }
    } 
}

int draw(int deck,int i ) 
{ 
    int hand[5], j, temp[j];

    for(i=0; i<52; i++)
    {
             j = i
             }; 

    for(i = 0; i < 5; i++)
    {
          deck[i] = hand[]; 
          printf("A card has been drawn \n");
          deck[i] = temp[j-1];
          temp[j] = deck[i];
          };

          return deck;
} 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-04-04T21:07:57.793

确实有两个不同的问题。首先是保持数组元素的正确顺序，以便在删除元素后没有“洞”。第二个实际上是调整数组本身的大小。

C 中的数组被分配为固定数量的连续元素。没有办法实际删除数组中单个元素使用的内存，但可以移动元素以填充删除元素造成的空洞。例如：

```
void remove_element(array_type *array, int index, int array_length)
{
   int i;
   for(i = index; i < array_length - 1; i++) array[i] = array[i + 1];
} 
```

静态分配的数组无法调整大小。动态分配的数组可以使用 realloc() 调整大小。这可能会将整个数组移动到内存中的另一个位置，因此必须更新指向数组或其元素的所有指针。例如：

```
remove_element(array, index, array_length);  /* First shift the elements, then reallocate */
array_type *tmp = realloc(array, (array_length - 1) * sizeof(array_type) );
if (tmp == NULL && array_length > 1) {
   /* No memory available */
   exit(EXIT_FAILURE);
}
array_length = array_length - 1;
array = tmp; 
```

如果请求的大小为 0，或者有错误，realloc 将返回一个 NULL 指针。否则它返回一个指向重新分配的数组的指针。临时指针用于在调用 realloc 时检测错误，因为除了退出之外，还可以将原始数组保持原样。当 realloc 无法重新分配数组时，它不会改变原始数组。

请注意，如果数组很大或删除了很多元素，这两个操作都会相当慢。如果优先考虑高效的插入和删除，还可以使用其他数据结构，如链表和散列。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-04T20:37:33.000

您真的不想在每次删除某些内容时重新分配内存。如果你知道你的*牌*组的粗略大小，那么为你的数组选择一个合适的大小，并保留一个指向当前列表*末尾*的指针。这是一个[堆栈](http://www.cs.bu.edu/teaching/c/stack/array/)。

如果你不知道你的牌组的大小，并且认为它可能会变得非常大并且不断改变大小，那么你将不得不做一些更复杂的事情并实现一个[链表](http://en.wikipedia.org/wiki/Linked_list)。

在 C 中，您有两种简单的方法来声明数组。

1.  在堆栈上，作为静态数组

    ```
    int myArray[16]; // Static array of 16 integers 
    ```

2.  在堆上，作为动态分配的数组

    ```
    // Dynamically allocated array of 16 integers
    int* myArray = calloc(16, sizeof(int)); 
    ```

标准 C 不允许调整这两种类型的数组的大小。您可以创建一个特定大小的新数组，然后将旧数组的内容复制到新数组，或者您可以按照上述建议之一来获取不同的抽象数据类型（即：链表、堆栈、队列、 ETC）。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-02-24T05:51:48.187

有趣的是，数组可以通过索引随机访问。并且随机删除一个元素也可能会影响其他元素的索引。

```
 int remove_element(int*from, int total, int index) {
            if((total - index - 1) > 0) {
                      memmove(from+i, from+i+1, sizeof(int)*(total-index-1));
            }
            return total-1; // return the new array size
    } 
```

请注意，`memcpy`由于内存重叠，在这种情况下将不起作用。

删除一个随机元素的一种有效方法（比内存移动更好）是与最后一个元素交换。

```
 int remove_element(int*from, int total, int index) {
            if(index != (total-1))
                    from[index] = from[total-1];
            return total; // **DO NOT DECREASE** the total here
    } 
```

但是删除后顺序会发生变化。

同样，如果删除是在循环操作中完成的，那么重新排序可能会影响处理。内存移动是在删除数组元素的同时保持顺序的一种昂贵的替代方法。在循环中保持顺序的另一种方法是推迟删除。它可以通过相同大小的有效性数组来完成。

```
 int remove_element(int*from, int total, int*is_valid, int index) {
            is_valid[index] = 0;
            return total-1; // return the number of elements
    } 
```

它将创建一个稀疏数组。最后，通过重新排序，可以使稀疏数组变得紧凑（不包含两个有效元素之间包含无效元素）。

```
 int sparse_to_compact(int*arr, int total, int*is_valid) {
            int i = 0;
            int last = total - 1;
            // trim the last invalid elements
            for(; last >= 0 && !is_valid[last]; last--); // trim invalid elements from last

            // now we keep swapping the invalid with last valid element
            for(i=0; i < last; i++) {
                    if(is_valid[i])
                            continue;
                    arr[i] = arr[last]; // swap invalid with the last valid
                    last--;
                    for(; last >= 0 && !is_valid[last]; last--); // trim invalid elements
            }
            return last+1; // return the compact length of the array
    } 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2020-03-26T12:32:00.120

您需要什么解决方案取决于您是否希望阵列保持其顺序。

通常，您永远不会只有数组指针，还有一个保存其当前逻辑大小的变量，以及一个保存其分配大小的变量。我还假设`removeIndex`是在数组的范围内。有了这个，删除很简单：

### 订单无关

```
array[removeIndex] = array[--logicalSize]; 
```

而已。您只需将最后一个数组元素复制到要删除的元素上，`logicalSize`在此过程中递减数组的 。

如果`removeIndex == logicalSize-1`，即最后一个元素要被删除，这会降级为最后一个元素的自赋值，但这不是问题。

### 保留订单

```
memmove(array + removeIndex, array + removeIndex + 1, (--logicalSize - removeIndex)*sizeof(*array)); 
```

稍微复杂一点，因为现在我们需要调用`memmove()`来执行元素的移动，但仍然是单行的。同样，这也会更新`logicalSize`过程中的数组。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-03-26T12:01:13.507

我通常这样做并且总是工作。

* * *

/*试试这个*/

```
for (i = res; i < *size-1; i++) { 

    arrb[i] = arrb[i + 1];
}

*size = *size - 1; /*in some ides size -- could give problems*/ 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-08T04:44:14.320

试试这个简单的代码：

```
#include <stdio.h>
#include <conio.h>
void main(void)
{ 
    clrscr();
    int a[4], i, b;
    printf("enter nos ");
    for (i = 1; i <= 5; i++) {
        scanf("%d", &a[i]);
    }
    for(i = 1; i <= 5; i++) {
        printf("\n%d", a[i]);
    }
    printf("\nenter element you want to delete ");
    scanf("%d", &b);
    for (i = 1; i <= 5; i++) {
        if(i == b) {
            a[i] = i++;
        }
        printf("\n%d", a[i]);
    }
    getch();
} 
```

# mysql - SugarCRM 慢查询（在 MySQL 上）

> ID：15821125
> 
> 赞同：3
> 
> 时间：2013-04-04T20:31:12.080
> 
> 标签：mysql, sugarcrm, filesort

我们将 SugarCRM 与 MySQL 5.5 数据库一起使用，并且发现频繁出现的查询性能不佳。

不幸的是，由于 SugarCRM 的性质，无法重新排序查询。我已经尝试通过索引进行优化，但还没有走得很远。也就是说，我也不是很擅长这样做。

您能否建议任何替代索引来改善我们的结果并避免文件排序？

询问：

```
SELECT DISTINCT cases.id, cases.case_number, cases.status, cases.name,
   cases.date_entered, 
   cases.assigned_user_id, cases.system_id
FROM cases
INNER JOIN team_sets_teams tst ON tst.team_set_id = cases.team_set_id
INNER JOIN team_memberships team_memberships ON tst.team_id = team_memberships.team_id
  AND team_memberships.user_id = 'f09ab586-986c-a6f6-0c2e-4d1f1432b6ec' 
  AND team_memberships.deleted=0
ORDER BY cases.case_number DESC
LIMIT 0,11; 
```

解释结果：

```
select_type table             type possible_keys                                   key                 ref                               rows Extra
SIMPLE      team_memberships  ref  team_id,user_id,idx_team_membership             idx_team_membership const                             26   Using where; Using index; Using temporary; Using filesort
SIMPLE      tst               ref  idx_ud_set_id,idx_ud_team_id,idx_ud_team_set_id idx_ud_team_id      sugarcrm.team_memberships.team_id 7    Using where
SIMPLE      cases             ref  idx_cases_tmst_id,idx_cases_created             idx_cases_tmst_id   sugarcrm.tst.team_set_id          5    Using where 
```

表定义：

```
CREATE TABLE `cases` (
`id` char(36) NOT NULL,
`name` varchar(255) DEFAULT NULL,
`date_entered` datetime DEFAULT NULL,
`date_modified` datetime DEFAULT NULL,
`modified_user_id` char(36) DEFAULT NULL,
`created_by` char(36) DEFAULT NULL,
`description` text,
`deleted` tinyint(1) DEFAULT '0',
`assigned_user_id` char(36) DEFAULT NULL,
`team_id` char(36) DEFAULT NULL,
`case_number` int(11) NOT NULL AUTO_INCREMENT,
`type` varchar(255) DEFAULT NULL,
`status` varchar(100) DEFAULT NULL,
`priority` varchar(100) DEFAULT NULL,
`resolution` text,
`system_id` int(11) DEFAULT NULL,
`work_log` text,
`account_id` char(36) DEFAULT NULL,
`portal_viewable` tinyint(1) DEFAULT '0',
`team_set_id` char(36) DEFAULT NULL,
`parent_id` char(36) DEFAULT NULL,
`parent_type` varchar(255) DEFAULT 'Cases',
PRIMARY KEY (`id`),
UNIQUE KEY `casesnumk` (`case_number`),
UNIQUE KEY `case_number` (`case_number`,`system_id`),
KEY `idx_case_name` (`name`),
KEY `idx_account_id` (`account_id`),
KEY `idx_cases_stat_del` (`assigned_user_id`,`status`,`deleted`),
KEY `idx_cases_tmst_id` (`team_set_id`),
KEY `date_modified` (`date_modified`),
KEY `modified_user_id` (`modified_user_id`),
KEY `idx_cases_created` (`team_set_id`,`date_entered`),
KEY `team_id` (`team_id`),
KEY `idx_cases_del` (`deleted`),
KEY `idx_cases_date_entered` (`date_entered`),
KEY `idx_cases_status` (`status`),
KEY `idx_cases_parent_id` (`parent_id`),
KEY `idx_cases_priority` (`priority`)
) ENGINE=InnoDB

CREATE TABLE `team_sets_teams` (
`id` char(36) NOT NULL,
`team_set_id` char(36) DEFAULT NULL,
`team_id` char(36) DEFAULT NULL,
`date_modified` datetime DEFAULT NULL,
`deleted` tinyint(1) DEFAULT '0',
PRIMARY KEY (`id`),
KEY `idx_ud_set_id` (`team_set_id`,`team_id`),
KEY `idx_ud_team_id` (`team_id`),
KEY `idx_ud_team_set_id` (`team_set_id`),
KEY `idx_tst_deleted` (`deleted`)
) ENGINE=InnoDB

CREATE TABLE `team_memberships` (
`id` char(36) NOT NULL,
`team_id` char(36) DEFAULT NULL,
`user_id` char(36) DEFAULT NULL,
`explicit_assign` tinyint(1) DEFAULT '0',
`implicit_assign` tinyint(1) DEFAULT '0',
`date_modified` datetime DEFAULT NULL,
`deleted` tinyint(1) DEFAULT '0',
PRIMARY KEY (`id`),
KEY `date_modified` (`date_modified`),
KEY `team_id` (`team_id`),
KEY `user_id` (`user_id`),
KEY `idx_team_membership` (`user_id`,`team_id`,`deleted`)
) ENGINE=InnoDB 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T12:31:42.383

从 Ubuntu 10.04 服务器切换到 12.04 时，我遇到了类似的问题。因为 InnoDB 作为 Ubuntu 12.04 中打包的较新 MySQL 版本的默认引擎。我对 MySQL 服务器设置进行了一些尝试，例如 query_cache_size、innodb_buffer_pool_size、innodb_log_buffer_size，它显着提高了性能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-16T21:44:37.953

尝试以下索引：

```
mysql> show indexes from team_memberships;
+------------------+------------+------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table            | Non_unique | Key_name               | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+------------------+------------+------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| team_memberships |          0 | PRIMARY                |            1 | id          | A         |         665 |     NULL | NULL   |      | BTREE      |         |               |
| team_memberships |          1 | idx_team_membership    |            1 | user_id     | A         |         665 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_memberships |          1 | idx_team_membership    |            2 | team_id     | A         |         665 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_memberships |          1 | idx_teammemb_team_user |            1 | team_id     | A         |         665 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_memberships |          1 | idx_teammemb_team_user |            2 | user_id     | A         |         665 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_memberships |          1 | idx_team_deleted_user  |            1 | user_id     | A         |         665 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_memberships |          1 | idx_team_deleted_user  |            2 | deleted     | A         |         665 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_memberships |          1 | idx_team_deleted_user  |            3 | team_id     | A         |         665 |     NULL | NULL   | YES  | BTREE      |         |               |
+------------------+------------+------------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+

mysql> show indexes from cases;
+-------+------------+--------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table | Non_unique | Key_name           | Seq_in_index | Column_name      | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+-------+------------+--------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| cases |          0 | PRIMARY            |            1 | id               | A         |           6 |     NULL | NULL   |      | BTREE      |         |               |
| cases |          0 | casesnumk          |            1 | case_number      | A         |           6 |     NULL | NULL   |      | BTREE      |         |               |
| cases |          0 | case_number        |            1 | case_number      | A         |           6 |     NULL | NULL   |      | BTREE      |         |               |
| cases |          0 | case_number        |            2 | system_id        | A         |           6 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | idx_case_name      |            1 | name             | A         |           6 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | idx_account_id     |            1 | account_id       | A         |           6 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | idx_cases_stat_del |            1 | assigned_user_id | A         |           3 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | idx_cases_stat_del |            2 | status           | A         |           6 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | idx_cases_stat_del |            3 | deleted          | A         |           6 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | idx_cases_tmst_id  |            1 | team_set_id      | A         |           3 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | deleted            |            1 | deleted          | A         |           3 |     NULL | NULL   | YES  | BTREE      |         |               |
| cases |          1 | team_id            |            1 | team_id          | A         |           3 |     NULL | NULL   | YES  | BTREE      |         |               |
+-------+------------+--------------------+--------------+------------------+-----------+-------------+----------+--------+------+------------+---------+---------------+

mysql> show indexes from team_sets_teams;
+-----------------+------------+--------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| Table           | Non_unique | Key_name           | Seq_in_index | Column_name | Collation | Cardinality | Sub_part | Packed | Null | Index_type | Comment | Index_comment |
+-----------------+------------+--------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+
| team_sets_teams |          1 | idx_ud_set_id      |            1 | team_set_id | A         |          13 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_sets_teams |          1 | idx_ud_set_id      |            2 | team_id     | A         |          13 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_sets_teams |          1 | idx_ud_team_id     |            1 | team_id     | A         |          13 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_sets_teams |          1 | deleted            |            1 | deleted     | A         |           2 |     NULL | NULL   | YES  | BTREE      |         |               |
| team_sets_teams |          1 | idx_ud_team_set_id |            1 | team_set_id | A         |          13 |     NULL | NULL   | YES  | BTREE      |         |               |
+-----------------+------------+--------------------+--------------+-------------+-----------+-------------+----------+--------+------+------------+---------+---------------+ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T19:11:53.193

大部分时间都花在将临时表复制到磁盘上。当临时表中的数据太大以至于 MySQL 无法根据其配置设置保存在 RAM 中时，就会发生这种情况。

尝试增加您`tmp_table_size`和`max_heap_table_size`MySQL 的设置。这应该可以防止将临时表移动到磁盘，从而加快查询速度（如果您的服务器有足够的 RAM 来处理它；这将取决于您在 SugarCRM 中同时拥有多少用户）。

这里的瓶颈现在看起来是您的磁盘 i/o - 将服务器升级到我们的 SSD 也将具有性能优势，如果不是针对此查询（增加上述设置）而是针对整个 SugarCRM。如果您无法增加上述设置以将临时表保留在 RAM 中，那么获得 SSD 将是下一个最佳选择。

# android - 自定义 ScrollView NoSuchMethodException

> ID：15821134
> 
> 赞同：0
> 
> 时间：2013-04-04T20:31:57.730
> 
> 标签：android, scrollview

我有这个自定义视图类作为内部类：

```
public class GraphFragment extends SherlockFragment {
[...]
    public class FlingableScrollView extends ScrollView {
        public FlingableScrollView(Context context, AttributeSet attrs,
                int defStyle) {
             super(context, attrs, defStyle);
        }

        public FlingableScrollView(Context context, AttributeSet attrs) {
             super(context, attrs);
        }

         public FlingableScrollView(Context context) {
             super(context);
         }

         @Override
         public boolean dispatchTouchEvent(MotionEvent ev) {
             super.dispatchTouchEvent(ev);
             return gestureListener.onTouch(this, ev);
         }
     }
} 
```

在我的 XML 布局中：

```
 <view
        android:id="@+id/scrollView1"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.example.GraphFragment$FlingableScrollView" > 
```

由于此错误，它不起作用：

> 04-04 20:04:41.001: E/AndroidRuntime(2011): 由: java.lang.NoSuchMethodException: [class android.content.Context, interface android.util.AttributeSet]

为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:38:57.963

在这个问题中提出了类似的问题。看看有没有帮助。

[实现扩展/自定义视图为构造函数抛出 NoSuchMethod](https://stackoverflow.com/questions/11655347/implementing-extended-custom-view-throws-nosuchmethod-for-constructor)

# jquery - 在 jQuery.ajax 中弃用成功参数？

> ID：15821141
> 
> 赞同：27
> 
> 时间：2013-04-04T20:32:09.497
> 
> 标签：jquery, ajax

今天听说 jQuery.ajax 函数中的 success-Parameter 已弃用。我理解正确吗？还是我误解了什么？

例如，这在未来将不起作用：

```
 $.ajax({

            url: 'ax_comment.php',              
            type: 'POST',
            data: 'mode=view&note_id='+noteid+'&open='+open+'&hash='+hash,
            success: function(a) {
            ...

            }   

    }); 
```

我必须使用这个？

```
$.ajax({

            url: 'ax_comment.php',

            type: 'POST',
            data: 'mode=view&note_id='+noteid+'&open='+open+'&hash='+hash,
            success: function(a) {
            ...

            }   

    }).done(function(a){.....}; 
```

来源：[http](http://api.jquery.com/jQuery.ajax/) ://api.jquery.com/jQuery.ajax/ （向下滚动到**弃用通知**）

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2013-04-04T20:35:30.850

**Ajax 成功回调方法**之间有区别：

```
$.ajax({}).success(function(){...}); 
```

以及 Ajax 成功**本地回调事件**（即 Ajax 参数和属性）：

```
$.ajax({
    success: function(){...}
}); 
```

不推荐使用**成功回调方法**（第一个示例）。但是，**成功的本地事件**（第二个示例）不是。

本地事件是 Ajax 属性（即参数）。jQuery 文档进一步解释了[本地事件](https://api.jquery.com/Ajax_Events/) *是一个回调，您可以在 Ajax 请求对象中订阅它*。

因此，将来，您可以执行以下任一操作：

```
$.ajax({}).done(function(){...}); 
```

或者

```
$.ajax({
    success: function(){...}
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-21T01:47:31.683

是的，从 jQuery 1.8 开始，它已被弃用。您应该使用`.done()`和使用`.fail()`来捕获错误。

```
$.ajax({
    url: 'URL',
    type: 'POST',
    data: { // Your Data },
    datatype: 'json'
})
.done(function (data) { // AJAX Success })
.fail(function (jqXHR, textStatus, errorThrown) { // AJAX Failure }); 
```

# javascript - Highcharts - 使用三角形而不是条形的条形图

> ID：15821152
> 
> 赞同：1
> 
> 时间：2013-04-04T20:32:39.773
> 
> 标签：javascript, highcharts

我正在尝试在 highcharts 中创建一个类似于条形图但使用三角形而不是矩形条的图表（即三角形越长，它代表的值越大）。

我已经设法使用面积图破解了一些东西，并在每个三角形中绘制了 3 个点（三角形底为 0，峰值为实际值）

见[http://jsfiddle.net/83jXA/2/](http://jsfiddle.net/83jXA/2/)

```
chart: { type: 'area' },
series: [{
        name: '2010',
        data: [0, 3, 0, null, null, null, null],           
    }, {
        name: '2011',
        data: [null, null, null, null, 0, 6, 0],
    }], 
```

但是，我想知道是否存在更接近我需要的东西，所以我不必绘制这些假 0 和空值。我没有设法在文档中找到任何内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T07:11:54.907

您所做的是获得三角形条形图的唯一方法。我在条形图上使用了类似的技术，我希望条形看起来具有特定的方式，并且效果很好。

我担心性能，但我们没有问题，即使图表每秒更新几次。

# html - contenteditable 边距应用于其他绝对定位的元素

> ID：15821154
> 
> 赞同：0
> 
> 时间：2013-04-04T20:32:52.417
> 
> 标签：html, google-chrome, css

我有一个 contenteditable div，并在它上面放置了另一个绝对定位的元素（一个小框）。

奇怪的事情：在 Chrome 中，该`padding-right`属性一直应用于小盒子，即使它不在 CSS 中。此外，填充不会应用于 contenteditable。

*   **[http://jsfiddle.net/xBU7D/](http://jsfiddle.net/xBU7D/)**

这是 Chrome 错误吗？我很确定我做对了：

```
<div contenteditable=true>hello</div>
<div id=closer></div> 
```

和

```
 div[contenteditable] {
        border:1px solid #900;
        width:200px;  
        overflow:hidden;
        white-space:nowrap;
        padding-right:20px; /* <- the wascawwy wabbit */
    }
    #closer {
        position:absolute;
        border:1px solid #090;
        width:20px;
        height:20px;
        top:0px;
        left:180px;
    }
    body {padding:0;margin:0;} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:40:12.867

`padding-right`实际上并没有应用于看起来像它的小盒子。

增加了您的 contenteditable div的`padding-right`宽度，使其`220px`变宽。

您的小 div 绝对定位，其宽度为`20px`，其左侧`180px`导致`20px`右侧有间隙 - 但这不是`padding-right`. 您只需要更改您的小盒子上的 to 或更改`left: 180px`您的 contenteditable div的to 。`left: 200px``width: 180px``width: 160px`

[http://jsfiddle.net/xBU7D/2/](http://jsfiddle.net/xBU7D/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:43:59.597

`padding-right:20px`你在那里实际上使你的 200px contenteditable div 为 220px 。因此，如果您将第二个 div 设置为左​​侧 200 像素而不是 180 像素，则它会完美排列。

[**http://jsfiddle.net/xBU7D/3/**](http://jsfiddle.net/xBU7D/3/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T23:02:10.363

接受 Horen 的回答作为感谢您提供的解释，让我意识到发生了什么。

我的代码没有做我认为应该做的事情的*真正原因是该死的盒子模型更改。*我[在那个 quirksmode.org 上，](http://quirksmode.org/css/user-interface/boxsizing.html) W3C 盒子模型`content-box`对我来说是违反直觉的。`padding`应该在内容的内部。

[http://jsfiddle.net/xBU7D/4/](http://jsfiddle.net/xBU7D/4/) 使用`border-box`，一切都很好。

# chef-infra - 带有递归目录的厨师模板

> ID：15821156
> 
> 赞同：6
> 
> 时间：2013-04-04T20:33:07.190
> 
> 标签：chef-infra

我对 Chef 很陌生，正在尝试找出模板（这看起来真的很酷）。在我的旧部署结构中，我有一个目录，我只是想复制它。它有许多配置参数分散在目录中的文件中。我已经开始尝试将这些参数抽象到一个属性文件中（更干净），但是在使用 Chef 安装它时遇到了麻烦。我已将所有带有 ERB 的文件的扩展名修改为以 .erb 结尾（我来自 Rails 背景，所以这对我来说似乎很自然）。例如，我有一个名为 run.conf 的文件，现在它被命名为 run.conf.erb。

理想情况下，我希望在配方中有一个模板块，它只复制目录中的所有文件并使用我提供的变量更新那些 .erb 文件（删除 .erb 扩展名）。这是我目前所处位置的一个示例：

```
template "#{node["dcm4chee"]["home"]}" do
  source "server/"
  variables(
    "java_mem_opts" => node["dcm4chee"]["java_mem_opts"],
    "db_username" => node["dcm4chee"]["admin"]["username"],
    "db_password" => node["dcm4chee"]["admin"]["password"],
    "db_hostname" => node["mysql"]["hostname"],
    "db_port" => node["mysql"]["port"]
)
end 
```

我在模板/默认下放置了一个名为 server 的文件夹，该文件夹包含我想要模板化的文件。#{node["dcm4chee"]["home"]} 变量是我想在目标机器上放置文件的位置。理想情况下，我希望在不命名配方中的特定文件的情况下执行此操作，因为这样如果我修改服务器目录的内容以进行部署，我就不必触及配方。

这可能吗？如果是这样，我做错了什么？如果没有，我的选择是什么。

谢谢

编辑

在考虑了这一点之后，我尝试使用一些自定义 ruby​​ 代码来执行此操作。这是我当前的尝试，它在 ruby​​_block 中的初始调用中引用 tempate_dir 的 NoMethodError 失败。

```
def template_dir(file)
  Dir.foreach("server") do |file|
    if File.file?(file)
      template "#{node["dcm4chee"]["home"]}/#{file}" do
        source "server/#{file}"
          variables(
            "java_mem_opts" => node["dcm4chee"]["java_mem_opts"],
            "db_username" => node["dcm4chee"]["admin"]["username"],
            "db_password" => node["dcm4chee"]["admin"]["password"],
            "db_hostname" => node["mysql"]["hostname"],
           "db_port" => node["mysql"]["port"]
          )
      end
    else
      directory "#{node["dcm4chee"]["home"]}/#{file}" do
        action :create
      end
      template_dir(file)
    end
  end
end

ruby_block "template the whole server directory" do
  block do
    template_dir("server")
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-06T20:44:33.983

你可以`template_dir`在你的内部`ruby_block`而不是在顶层定义——这样就可以了。

`find`是 Ruby 标准库的一部分，将递归遍历一个目录。使用它会导致一些更清洁的东西：

```
ruby_block "recursive templating" do
    block do
        require 'find'
        root = 'server'
        Find.find(root) do |file|
            if File.file?(file)
                template "#{node["dcm4chee"]["home"]}/#{file}" do
                    source file
                    variables(
                        "java_mem_opts" => node["dcm4chee"]["java_mem_opts"],
                        "db_username" => node["dcm4chee"]["admin"]["username"],
                        "db_password" => node["dcm4chee"]["admin"]["password"],
                        "db_hostname" => node["mysql"]["hostname"],
                        "db_port" => node["mysql"]["port"]
                    )
                end
            end
        end
    end
end 
```

一般来说，如果您正在编写任何稍微复杂的逻辑，您应该考虑编写 LWRP 而不是将其放入您的配方中。两阶段编译/执行的事情会导致很多不直观的行为（例如块无法查找的事实`template_dir`），并且因为编写 LWRP 可以让您验证输入、编写测试并更好地确保幂等性。

另外，我对您拥有的“服务器”字符串有些困惑——我不确定在什么环境下会解析到您的`templates`目录。无论如何，如果您想访问食谱中所有模板的列表，这里有一个可用的数组：`run_context.cookbook_collection[cookbook_name].template_filenames`

# c++ - C++：链接器子系统

> ID：15821157
> 
> 赞同：2
> 
> 时间：2013-04-04T20:33:07.543
> 
> 标签：c++, visual-c++, borland-c++

我是 C++ 的初学者，我是来学习的。

首先，我在学校用 Borland C++ 编写了一些程序，但我的学校没有 Visual C++，也没有人教我如何用 Visual C++ 编程。

问题是，当我尝试将链接器子系统（项目设置）更改为 Windows（/SUBSYSTEM:WINDOWS）时，我在输出窗口中得到了这个：

```
1>------ Build started: Project: hew, Configuration: Debug Win32 ------
1>  main.cpp
1>c:\users\mxmike\documents\visual studio 2010\projects\hew\main.cpp(1): fatal
error C1083: Cannot open include file: 'iostream.h': No such file or directory
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

我的代码非常简单：

```
#include <iostream.h>
#include <stdlib.h>

int main(int f)
{
    int i=1;
    return 1;
} 
```

我只是不明白。有人会这么好心给我解释吗？
感谢您的阅读！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:33:53.120

没有`<iostream.h>`标题。I/O 的标准库头文件是`<iostream>`. 没有一个 C++ 标准库头文件以`.h`.

确实存在的以结尾的头文件`.h`来自 C 标准库。因此，例如，`<stdlib.h>` *是*一个 C 标准库头文件。C++ 标准确实使这些头文件可用，但它也提供了自己的替代品，其内容几乎相同。只需删除并在开头`.h`添加一个。`c`所以 C++ 版本`<stdlib.h>`是`<cstdlib>`.

你是否真的需要其中的内容`<stdlib.h>`或者`<cstdlib>`是另一回事。大多数功能都改进了 C++ 特定标头中的 C++ 对应项。例如，这些 C 头文件提供`malloc`，但您应该`new`在 C++ 中使用 - 表达式。

另请注意，返回通常是失败的标志`1`。`main`要指示成功执行，请`return 0;`改为执行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:38:47.403

C++ 中有两种标准类型的头文件。那些从 C 派生的，例如 <stdlib.h>，它在 C++ 中应该包含在 <cstdlib> 中（去掉 .h 并以 ac 为前缀）和那些像 <iostream> 这是一个替换 C++ 的 C++ 头文件<stdio.h>。

你想要的是：

```
#include <cstdio>
#include <cstdlib> 
```

或者

```
#include <iostream>
#include <cstdlib> 
```

取决于您在代码中调用的功能/功能（如果您不提供任何功能，那么两者都应该工作）。

问候，

杰森·波西特

# iphone - 隐藏状态栏

> ID：15821160
> 
> 赞同：0
> 
> 时间：2013-04-04T20:33:40.283
> 
> 标签：iphone, xcode, statusbar, viewcontroller

我有一个带有一些按钮的起始页，当按下一个按钮时，它会使用 Navcontroller 滑动到下一个 ViewController。我希望状态栏从一开始就可见，并且对于大多数不同的 ViewControllers，但对于其中一个我希望隐藏状态栏的视图控制器。我试试这个并将代码放在实现文件中的 -(void)viewDidLoad 中。

```
[[UIApplication sharedApplication] setStatusBarHidden:YES withAnimation:NO]; 
```

是的，状态栏是隐藏的，但是返回时它仍然是隐藏的，我不明白如何让它重新出现。在我一起重新启动应用程序之前，它似乎是隐藏的。如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:36:12.293

当您返回到其他视图控制器时，您需要确保状态栏可见。您可以调用`[[UIApplication sharedApplication] setStatusBarHidden:NO withAnimation:NO];`其他每个视图控制器的`viewDidAppear`方法或其他合适的位置。

# .net - 具有嵌入式互操作的 .NET 程序集中的 TypeLoadException

> ID：15821161
> 
> 赞同：4
> 
> 时间：2013-04-04T20:33:43.177
> 
> 标签：.net, com, vsto, com-interop

我开发了一个具有以下特点的 .NET 类库：

*   .NET 4.0，任何 CPU
*   `adodb.dll`.NET Primary Interop Assembly 文件夹中的引用
*   设置为 true的构建`Embed Interop Type`（默认）
*   公开 ADODB.RecordSet 以供 COM 使用。

我通过 VSTO 插件将程序集公开给 VBA。它在我的机器上运行良好，但在客户端机器上，我的程序集`System.TypeLoadException`在尝试访问 a 的`Fields`属性时会抛出 a `RecordSet`。

```
public Recordset Test() {
    Recordset result = new Recordset();
    result.CursorLocation = CursorLocationEnum.adUseClient;
    Fields resultFields = result.Fields; // EXCEPTION THROWN HERE.
    ...
} 
```

异常消息：

`Could not load type 'ADODB.FieldsToInternalFieldsMarshaler' from assembly 'MyCompany.MyProduct.Interop.Com`.

失败的客户端：Win XP/32、Win 7/64。两者都没有本地管理员权限。两者都有 .NET 4.0

* * *

***更新***：[这篇文章](https://stackoverflow.com/questions/5666265/adodbcould-not-load-type-adodb-fieldstointernalfieldsmarshaler-from-assembly)描述了我的问题。接受的答案（后期绑定）对我不起作用，但鲍勃的答案对我有用（不要嵌入互操作）。

一旦我设置`Embed Interop Types`为`False`，一切都开始像魔术一样工作。

所以我的问题变成了“为什么嵌入互操作不起作用？” 我认为这是避免客户端机器出现问题的最佳做法。

# python - 使用python（foursquare API）解析json文件中的较低级别？

> ID：15821165
> 
> 赞同：2
> 
> 时间：2013-04-04T20:33:49.043
> 
> 标签：python, json, parsing, foursquare

因为我刚刚开始使用 python，所以我认为我还没有很好地掌握解析 json 响应的概念，并且当我尝试只打印出 json 文件的某些部分时会遇到同样的问题。在下面的代码中，我使用foursquare checkins API 端点来返回我的签入历史（为简洁起见，省略了身份验证过程）：

```
 from rauth import OAuth2Service
    import json
    import pprint

    fs_checkins = session.get(endpoint, params = query_params)
    fs_checkin_data = json.loads(fs_checkins.content)

    pprint.pprint(fs_checkin_data) 
```

这会产生如下所示的 json 响应：

```
 {u'response': {u'checkins': {u'count': 74,
                                 u'items': [{u'photos': {u'count': 0,
                                                         u'items': []},
                                             u'posts': {u'count': 0,
                                                        u'textCount': 0},
                                             u'source': {u'name': u'foursquare for iPhone',
                                                         u'url': u'https://foursquare.com/download/#/iphone'},
                                             u'timeZoneOffset': -240,
                                             u'type': u'checkin',
                                             u'venue': {u'beenHere': {u'count': 1,
                                                                      u'marked': False},
                                                        u'canonicalUrl': u'https://foursquare.com/v/nitehawk-cinema/4da491f6593f8eec9a257e35',
                                                        u'categories': [{u'icon': {u'prefix': u'https://foursquare.com/img/categories_v2/arts_entertainment/movietheater_',
                                                                                   u'suffix': u'.png'},
                                                                         u'id': u'4bf58dd8d48988d17f941735',
                                                                         u'name': u'Movie Theater',
                                                                         u'pluralName': u'Movie Theaters',
                                                                         u'primary': True,
                                                                         u'shortName': u'Movie Theater'}],
                                                        u'contact': {u'formattedPhone': u'(718) 384-3980',
                                                                     u'phone': u'7183843980'},
                                                        u'id': u'4da491f6593f8eec9a257e35',
                                                        u'like': False,
                                                        u'likes': {u'count': 114,
                                                                   u'groups': [{u'count': 114,
                                                                                u'items': [],
                                                                                u'type': u'others'}],
                                                                   u'summary': u'114 likes'},
                                                        u'location': {u'address': u'136 Metropolitan Ave.',
                                                                      u'cc': u'US',
                                                                      u'city': u'Brooklyn',
                                                                      u'country': u'United States',
                                                                      u'crossStreet': u'btwn Berry St. & Wythe Ave.',
                                                                      u'lat': 40.716219932353624,
                                                                      u'lng': -73.96228637176877,
                                                                      u'postalCode': u'11211',
                                                                      u'state': u'NY'},
                                                        u'name': u'Nitehawk Cinema',
                                                        u'stats': {u'checkinsCount': 11566,
                                                                   u'tipCount': 99,
                                                                   u'usersCount': 6003},
                                                        u'url': u'http://www.nitehawkcinema.com',
                                                        u'venuePage': {u'id': u'49722288'},
                                                        u'verified': True}}]}}} 
```

我只想解析`'canonicalUrl'`并`'name'`嵌套在下面`'venue'`并理解结构如下：

```
 response
       checkins
          items
             venue
                canonicalUrl                 
                name 
```

我尝试循环`fs_checkin_data['response']['checkins']`将`'items'`blob 附加到一个空列表中：

```
 items = []

    for item in fs_checkin_data['response']['checkins']:
        info = {}
        info['items'] = item['items']
        items.append(info) 
```

认为我将能够 for 循环遍历*该*空列表以将 blob 附加`'venue'`到另一个空列表中，最后只能打印出`'canonicalUrl'`and `'name'`（为我即兴创作的丑陋的黑客逻辑道歉，因为我不知道获得相同结果的另一种方法）。

但是，上面的代码导致了这个错误：

```
 info['items'] = item['items']
    TypeError: string indices must be integers 
```

自从我做以来我不明白

```
 for item in fs_checkin_data['response']['checkins']: 
       pprint.pprint(item) 
```

通过 json 文件的那部分没有问题。

我知道必须有更好的方法来做到这一点，但我似乎无法找到一个简单、有效的解决方案，因此我们将不胜感激任何帮助。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:36:20.293

您需要循环`items`：

```
for item in fs_checkin_data['response']['checkins']['items']:
    venue = item['venue']
    print venue['canonicalUrl'], venue['name'] 
```

`checkins`本身仍然是一个只有两个键的字典，`items`并且`count`. 遍历`checkins`字典会遍历键，因此在您的代码`item`中设置为`'count'`, then `'items'`（反之亦然）。`items`另一方面，它是一个字典列表，因此遍历该列表可让您访问每个单独的项目。

# php - PHP事务不回滚

> ID：15821167
> 
> 赞同：1
> 
> 时间：2013-04-04T20:33:50.467
> 
> 标签：php, mysql, transactions

我有一些 PHP 代码使用 PHPExcel 读取电子表格并将数据导入 MySQL 数据库。(innoDB) 如果导入在数据库中遇到重复记录，它应该会失败并回滚所有先前的插入。回滚不起作用，我编写了这个功能相同的小程序。

```
$conn = null;
try {

$conn=new mysqli("myServer","user","password", "moveforward");
$conn->autocommit(FALSE);

$sql="insert into series (seriesLocation,seriesName,seriesDate) values('1','2','2013-05-21')";
echo "Executing query 1<br>";
$conn->query($sql);
if($conn->error!="") {
    $sqlError=$conn->error;
    $conn->rollback();
    echo "Rollback complete<br>";
    throw new Exception($sqlError);
}

//This will throw a duplicate exception
echo "Exceuting query 2<br>";
$conn->query($sql);
if($conn->error!="") { 
    $sqlError=$conn->error;
    $conn->rollback();
    echo "Rollback complete<br>";
    throw new Exception($sqlError);
}
echo "You shouldn't be here<br>";

$conn->commit();
echo "Transactions comitted<br>";

} catch (Exception $e) {
    echo "Exception: " . $e->getMessage() . "<br>";
}
$conn->close();
echo "Done<br>"; 
```

在查看 php 手册并检查此处的其他帖子时，这看起来应该可以工作。当我运行它时，我得到了这个：

```
Executing query 1
Exceuting query 2
Rollback complete
Exception: Duplicate entry '2' for key 'seriesName'
Done 
```

然而，当我检查数据库时，第一个插入的数据就在那里。

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:39:03.157

猜你的桌子没有使用合适的引擎

[http://php.net/mysqli.autocommit](http://php.net/mysqli.autocommit)

> 此函数不适用于非事务表类型（如 MyISAM 或 ISAM）。

但是，它更容易使用`INSERT IGNORE`（或`REPLACE`取决于正确的行为）。在这种情况下，重复的行将被忽略（或替换现有的 ( `REPLACE`)）。当然，如果您想知道哪些是重复项，这不起作用。

# ruby-on-rails - 如何设置条件控制器视图？

> ID：15821169
> 
> 赞同：1
> 
> 时间：2013-04-04T20:33:52.863
> 
> 标签：ruby-on-rails, ruby, view, controller

我在 routes.rb 上设置了我的主控制器的默认视图。当新用户到来时，我需要控制器使用不同的视图。像这样的东西：

```
def set_view
  if @new_user
    render 'tutorial'
  else
    render 'index'
  end
end 
```

我就是不能让它工作。这里的任何见解都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:55:42.027

您的操作中只能调用一个“渲染”。只需将视图名称保留在变量中并在最后将其提供给“渲染”即可。

```
view = @new_user ? 'tutorial' : 'index'
render view 
```

# php - 在字符串中的两个变量之间放置点

> ID：15821172
> 
> 赞同：-2
> 
> 时间：2013-04-04T20:33:55.693
> 
> 标签：php

如何在mysql中的两个变量之间加一个点？像这样的东西，但它不起作用：

```
$query_filename->execute(array(".$value.".".$ext.", $key)); 
```

因此该表将显示为（例如）：file.txt

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:40:41.743

“file.txt”（或任何变体）甚至不是远程有效的 SQL。这不是一个查询，只是一个文件名。

在 PHP 中，然后要实现您想要的，请尝试：

```
array($value . '.' . $ext,$key); 
```

在 MySQL 中，您的查询应包括

```
CONCAT(value,".",ext) 
```

# asp.net - 在 Asp.Net 中使用带有 var 关键字的 Eval

> ID：15821175
> 
> 赞同：0
> 
> 时间：2013-04-04T20:34:07.377
> 
> 标签：asp.net, eval

后台代码：

```
var count = msgInfo.Count().ToString(); 
```

我在前端尝试了什么：

```
<span><%#Eval("count")%></span> 
```

但是，我的价值没有显示在前端。有谁知道我怎么能用 C# 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:36:35.903

将计数声明为页面类的属性：

```
public partial class Default : System.Web.UI.Page
{
    protected string count {get; set;}

    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T20:36:45.023

您可能需要计算 CodeBehind 类的字段或属性

```
public string count; 
```

不是方法中的局部变量，而是 CodeBehind 类中的字段/属性

然后你可以在其他任何地方设置它的值。

```
count  = msgInfo.Count().ToString(); 
```

您将能够在标记中访问它

```
<span><%= count %> </span> 
```

`Eval`通常用于评估数据绑定表达式

# php - 潮汐dk包括php

> ID：15821178
> 
> 赞同：1
> 
> 时间：2013-04-04T20:34:23.270
> 
> 标签：php, tidesdk

我做了我的研究，但找不到任何关于如何在标题中包含 php 文件并从 html 正文中的 include 调用函数的主题或示例。

这些例子都展示了如何在头部包含一个函数。

我的理解是这样的。

```
<script type="text/php" src="test.php"></script> 
```

在 test.php 中，我使用 echo 'test' 进行功能测试，而不使用 php 标签。

有人可以发布一个小例子，如何在潮汐dk中包含 php 并在正文中回显它吗？

我在应用程序配置中启用了 PHP。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T20:03:12.573

@hek2mgl 你好。您将在此处找到最近的德语教程，该教程应该可以为您说明这一点。

[http://www.phpgangsta.de/mit-tidesdk-und-webtechniken-konnen-wir-desktop-applikationen-bauen](http://www.phpgangsta.de/mit-tidesdk-und-webtechniken-konnen-wir-desktop-applikationen-bauen)

较旧但相关的第二个教程在这里：

[http://www.sanisoft.com/blog/2011/01/03/introduction-to-creating-desktop-applications-with-php-and-titanium](http://www.sanisoft.com/blog/2011/01/03/introduction-to-creating-desktop-applications-with-php-and-titanium)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-23T03:25:20.493

这是我在示例 hello world of tidesdk 中所做的更改以使其正常工作。

1.  清单中的更改：`app://index.html`到`index.php`
2.  添加`<?php echo "test"; ?>`到页面
3.  开启 PHP

在此之后，它起作用了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T17:07:57.417

首先，您必须忘记您正在使用 PHP 作为服务器端语言来呈现页面并向客户端发送响应。在 TideSDK 中，PHP 可以用作 Javascript（如 Ruby 或 Python）的替代品，这意味着 echo 可能与 JS 的 console.log 一样。

您的 php 文件必须像任何其他 javascript 文件一样处理 DOM 和事件，最后，您用 jQuery 替换 DIV 内容的解决方案和您的脚本按预期工作，您可以使用完整的 JS 框架，如 Knockout在您的 PHP 脚本的帮助下。此链接将为您提供更多示例来利用该功能。

[https://github.com/TideSDK/TideSDK/wiki/Using-TideSDK-with-PHP](https://github.com/TideSDK/TideSDK/wiki/Using-TideSDK-with-PHP)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-11T12:06:37.083

我自己也在努力解决 TideSDK，我想我明白了：

根据我[在 TideSDK 中使用 PHP 指南的](http://tidesdk.multipart.net/docs/user-dev/generated/#!/guide/using_php)第 10 次阅读...

PHP 预处理 - 使其“类似于 Apache 服务器上的 PHP 代码”的东西，“在浏览器呈现内容之前将脚本内容替换为脚本输出” -**只有**在以下情况下才会发生：

1.  您的外部 PHP 代码被 <?php 和 ?> 标签包围
2.  它在一个扩展名为 .php 的文件中
3.  如果用作包含，则必须通过**include**或**require**命令引用，而不是

如果您确实使用 <script type="text/php" src=""... 方法来包含文件，则包含的 .php 文件*不能*用 <?php 和 ?> 括起来。有点奇怪的系统，嗯？

# java - JTable中的MS Access DB，其中带有日期的单元格只有日期而没有时间

> ID：15821179
> 
> 赞同：0
> 
> 时间：2013-04-04T20:34:23.820
> 
> 标签：java, swing, date, jtable, tablecellrenderer

我在这里阅读了一些问题，但我仍然不明白如何“修剪”日期，即 JTable 单元格（列）将只有没有时间的日期。现在我在单元格中有日期和时间，但在 DB 中只有日期，这就是为什么我到处都有**2013-04-02 00:00:00.0**，但我想要**02-04-2013**

```
try {
        Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
        String Base = "jdbc:odbc:Driver={Microsoft Access Driver (*.mdb)}; DBQ=SL2.mdb";
        con = DriverManager.getConnection(Base,"","");
        st = con.createStatement();
        res2 = st.executeQuery("SELECT * FROM Apmeklejumi");
        rsmd = res2.getMetaData();
        int column = rsmd.getColumnCount();
        columnNames.addElement("ID");
        columnNames.addElement("Iestašanas datums");
        columnNames.addElement("Sūdzības");
        columnNames.addElement("Diagnoze");
        columnNames.addElement("Rekomendācijas");
        columnNames.addElement("Pacienta ID");
        while(res2.next()) {
            Vector row = new Vector(column);
            row.addElement(res2.getObject("ID"));               
            row.addElement(res2.getObject("Ies_dat")); // <--- date
            row.addElement(res2.getObject("Sudz"));
            row.addElement(res2.getObject("Diag"));
            row.addElement(res2.getObject("Rekom"));
            row.addElement(res2.getObject("Pacienta_ID"));              
            data.addElement(row);
        }
        st.close();
        con.close();
    } catch(Exception e) {
        e.printStackTrace();
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:44:02.383

*   默认情况下，关于 Jtable 的所有内容都在 Oracle 教程[How to Use Tables中进行了描述](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html)

*   用于[XxxTableCellRenderer](http://docs.oracle.com/javase/tutorial/uiswing/components/table.html#renderer)`DateFormat DATE_FORMAT = new SimpleDateFormat("dd/MM/yyyy");` _

例如

```
private static class DateRenderer extends DefaultTableCellRenderer {

    private static final long serialVersionUID = 1L;

    @Override
    public Component getTableCellRendererComponent(JTable table, Object value, 
             boolean isSelected, boolean hasFocus, int row, int column) {
        super.getTableCellRendererComponent(table, value, isSelected, 
             hasFocus, row, column);
        if (!(value instanceof Date)) {
            return this;
        }
        setText(DATE_FORMAT.format((Date) value));
        return this;
    }
} 
```

编辑

![在此处输入图像描述](https://i.stack.imgur.com/cwyKL.jpg)

```
import java.awt.GridLayout;
import java.text.SimpleDateFormat;
import java.util.Date;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.table.DefaultTableCellRenderer;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableColumnModel;
import javax.swing.table.TableModel;

public class SimpleTableDemo extends JPanel {

    private static final long serialVersionUID = 1L;
    private boolean DEBUG = false;
    private JTable table;
    private JButton okButton;
    private String[] columnNames = {"First Name", "Last Name", "Sport", "# of Years", "Vegetarian", "Date"};
    private Object[][] data = {{"Kathy", "Smith", "Snowboarding", new Integer(5), (false), new Date()},
        {"John", "Doe", "Rowing", new Integer(3), (true), new Date()},
        {"Sue", "Black", "Knitting", new Integer(2), (false), null},
        {"Jane", "White", "Speed reading", new Integer(20), (true), new Date()},
        {"Joe", "Brown", "Pool", new Integer(10), (false), new Date()},};
    private TableModel model = new DefaultTableModel(data, columnNames) {
        private static final long serialVersionUID = 1L;

        @Override
        public Class<?> getColumnClass(int column) {
            return getValueAt(0, column).getClass();
        }
    };

    public SimpleTableDemo() {
        super(new GridLayout(1, 0));
        table = new JTable(model);
        table.setRowHeight(20);
        table.setPreferredScrollableViewportSize(table.getPreferredSize());
        table.setFillsViewportHeight(true);
        TableColumnModel m = table.getColumnModel();
        m.getColumn(5).setCellRenderer(new SubstDateRenderer());
        JScrollPane scrollPane = new JScrollPane(table);
        add(scrollPane);
    }

    private static void createAndShowGUI() {
        JFrame frame = new JFrame("SimpleTableDemo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        SimpleTableDemo newContentPane = new SimpleTableDemo();
        newContentPane.setOpaque(true); // content panes must be opaque
        frame.setContentPane(newContentPane);
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                createAndShowGUI();
            }
        });
    }

    class SubstDateRenderer extends DefaultTableCellRenderer {

        private static final long serialVersionUID = 1L;
        private Date dateValue;
        private SimpleDateFormat sdfNewValue = new SimpleDateFormat("dd.MMMM.yyyy");
        private String sdfNewValueString = "";

        public SubstDateRenderer() {// formating TableCell
            super();
            setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        }

        @Override
        public void setValue(Object value) {
            if ((value != null) && (value instanceof Date)) {
                dateValue = (Date) value;
                sdfNewValueString = sdfNewValue.format(dateValue);
                value = sdfNewValueString;
            }
            super.setValue(value);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T23:30:05.713

请参阅[表格格式渲染器](http://tips4java.wordpress.com/2008/10/11/table-format-renderers/)。给出了一个仅显示日期的简单示例。

编辑：

例如，您可以使用：

```
SimpleDateFormat format = new SimpleDateFormat("yy/MM/dd");
TableCellRenderer renderer = new FormatRenderer( format );
TableColumnModel tcm = table.getColumnModel();
tcm.getColumn(???).setCellRenderer(renderer); 
```

从我上面给你的链接不要忘记点击“相关阅读”部分中的链接。

# sql-server - 在 SQL Server 中，如何配置全文搜索以索引 1/2、1/3、1/4 等

> ID：15821180
> 
> 赞同：1
> 
> 时间：2013-04-04T20:34:27.170
> 
> 标签：sql-server, tsql, search, indexing, full-text-search

我为以下内容创建了替换词库条目：

```
Pair: 1/2, half
Pair: 1/3, third
Pair: 1/4, quarter
Pair: 1/8, eighth 
```

当我使用诸如“1/2 英寸管道”之类的搜索词进行搜索时，我应该得到包含“1/2”和“一半”的行。我有两个这样的行。但是，使用开箱即用的默认全文搜索，似乎“1/2”不包含在相关列的全文索引结果中。

我还没有找到关于什么、在哪里、如何配置全文列的重新索引以使全文搜索条件包括允许 1/2、1/3 等的明确答案。就此而言，我在全文搜索中也需要单个数字。

如果有人可以指导我阅读一些文档，其中涵盖了我可以完成此任务的步骤，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-09T00:44:27.903

sys.dm_fts_parser 是一个很棒的 DMF，可以让您了解全文如何解析句子以及将哪些单词存储在内部索引中。对于您的第一个示例，我看到以下输出 -

```
select * from sys.dm_fts_parser(N'"Pair: 1/2, half"', 1033, 0, 0)

keyword group_id    phrase_id   occurrence  special_term    display_term    expansion_type  source_term
0x0070006100690072     1    0   1   Exact Match pair    0   Pair: 1/2, half
0x0031                 1    0   2   Noise Word  1       0   Pair: 1/2, half
0x006E006E0031         1    0   2   Noise Word  nn1     0   Pair: 1/2, half
0x0032                 1    0   3   Noise Word  2       0   Pair: 1/2, half
0x006E006E0032         1    0   3   Noise Word  nn2     0   Pair: 1/2, half
0x00680061006C0066     1    0   4   Exact Match half    0   Pair: 1/2, half 
```

FT 分解“1/2”并将其索引为 1、nn1、2 和 nn2（'nn' 是数值的内部表示）。在这种情况下，将使用默认停止列表，这还会导致这些值被标记为噪声词，因此它们不会添加到索引中。通过从停止列表中删除条目或创建新的空白停止列表并将其与索引相关联，可以轻松规避这一点。

到目前为止，根本没有任何方法可以让 FT 忽略在这种情况下它被视为单词分隔符的“/”符号。

**编辑**- 显然，有一种解决方法，它涉及创建自定义字典，如此[处详述](http://technet.microsoft.com/library/cc263242.aspx)。因此，对于英语，我在 Binn 目录中创建了一个“Custom0009.lex”文件，并为“/”添加了一个条目。这样做会显示 sys.dm_fts_parser 的以下输出（不要忘记重新启动 fdhost） -

```
select * from sys.dm_fts_parser(N'"Pair: 1/2, half"', 1033, NULL, 0)

keyword             group_id    phrase_id   occurrence  special_term    display_term    expansion_type  source_term
0x0070006100690072  1   0   1   Exact Match pair    0   Pair: 1/2, half
0x0031              1   0   2   Exact Match 1       0   Pair: 1/2, half
0x006E006E0031      1   0   2   Exact Match nn1     0   Pair: 1/2, half
0x002F              1   0   3   Exact Match /       0   Pair: 1/2, half
0x0032              1   0   4   Exact Match 2       0   Pair: 1/2, half
0x006E006E0032      1   0   4   Exact Match nn2     0   Pair: 1/2, half
0x00680061006C0066  1   0   5   Exact Match half    0   Pair: 1/2, half 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:48:45.713

我最好的猜测是全文搜索不支持“/”字符。我建议使用 LIKE，虽然速度较慢。

# elasticsearch - 在 ElasticSearch 中结合范围和直方图过滤器

> ID：15821184
> 
> 赞同：1
> 
> 时间：2013-04-04T20:34:43.130
> 
> 标签：elasticsearch

考虑存储在 ElasticSearch 中的事件日志。事件看起来像这样

```
{
  "timestamp": "2013-04-04T15:38:17Z",
  "color": "red"
}

{
  "timestamp": "2013-04-04T17:51:21Z",
  "color": "green"
} 
```

我想为每种颜色绘制频率时间线。我知道我可以通过以下两个查询获得时间表：

```
{
  "query": {
    "match": {
      "color": "red"
    }
  },
  "size": 0,
  "facets": {
    "freq": {
      "date_histogram": {
        "interval": "day",
        "field": "timestamp"
      }
    }
  }
} 
```

第二个查询将`"match": { "color": "green" }`.

我可以将这些查询合二为一吗？

*   计数（颜色）/天/桶
*   还是每种颜色一个面，包含该颜色的直方图？

对于两种颜色，单独的查询可以正常工作，但您可能会怀疑这是一个人为的例子。我真的要处理十多种颜色，此时单个查询会非常好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T01:02:27.960

[您可以使用facet_filter](http://www.elasticsearch.org/guide/reference/api/search/facets/)将不同颜色的构面组合到同一个请求中：

```
{
    "facets": {
        "freq_red": {
            "date_histogram": {
                "interval": "day",
                "field": "timestamp"
            },
            "facet_filter": {
                "term": {
                    "color": "red"
                }
            }
        },
        "freq_green": {
            "date_histogram": {
                "interval": "day",
                "field": "timestamp"
            },
            "facet_filter": {
                "term": {
                    "color": "green"
                }
            }
        }
    }
} 
```

# wpf - 在哪里放置 MVVM CustomControl ViewModels/Classes WPF

> ID：15821185
> 
> 赞同：2
> 
> 时间：2013-04-04T20:34:44.610
> 
> 标签：wpf, mvvm, custom-controls, code-organization

我目前在 MVVM 中工作，并为我的自定义样式 searchTextBox 控件创建了一个 xaml“TargetType”类。

问题是，我想知道如何将这些文件放在哪里/如何调用文件夹，以便我的项目保持整洁。我严格遵守[该组的 ResourceDictionary 组织的项目结构](http://projekt202.com/blog/2010/xaml-organization/)，但我希望看到一个大纲，其中包含一些示例文件，这些示例文件基于其他团队使用他们的 CustomControl 类所做的事情。他们将它们称为 ViewModel 吗？它们在单独的 ControlLibrary 中吗？等等

有没有人有任何易于阅读的资源？令人惊讶的是，我真的没有找到我想要的东西。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:28:16.023

如果你真的想严格使用 MVVM，你的自定义控件不能成为主 ViewModel 的一部分。这就是为什么您必须将它们分开在（控制）库中并添加到您的项目中作为参考。*（MVVM 的主要目标：图形专家可以独立地在前端层（在这种情况下使用 xaml 视图）工作，同时程序员可以在后端层（在这种情况下是模型）工作。程序员可以在这些层之间创建连接（视图模型）。这就是为什么严格的 MVVM 不允许代码隐藏。）*所以回到你的问题，“它们在单独的 ControlLibrary 中吗？” - 是的，它可以是一个解决方案。但最重要的是：如果您将自定义元素放在控件库中，您可以（轻松地）与多个 WPF 应用程序共享您的工作。

有一本书：[http](https://rads.stackoverflow.com/amzn/click/com/1430272058) : //www.amazon.com/Pro-WPF-2010-Presentation-Foundation/dp/1430272058 您需要的是第 18 章 - 自定义元素。有一个很长的“解释”为什么你应该使用控制库以及特殊情况等等......（对不起我的英语）

# c - 如何用 | 转换表达式 （或）在 AST 中？

> ID：15821186
> 
> 赞同：1
> 
> 时间：2013-04-04T20:34:44.750
> 
> 标签：c, tree, antlr, grammar, multiplication

我的语法中有这个表达式：

```
 function_expr  (('*'|'/'|'%') multiplicative_expression)* 
```

我正在尝试在 AST 中形成它，但是使用“|” 符号我不知道该怎么做。我正在尝试做这样的事情：

```
 function_expr  (('*'|'/'|'%') multiplicative_expression)* -> ^('*' ^(FUNC_EXPR function_expr) multiplicative_expression) 
```

当然是不正确的。最好的方法是：

```
 function_expr  (('*'^|'/'^|'%'^) multiplicative_expression)* 
```

不幸的是，我还需要定义一些令牌。请问有人有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:48:47.040

试试这个：

```
your_rule
 : (function_expr                                -> ^(FUNC_EXPR function_expr))
                 ( '*' multiplicative_expression -> ^('*' $your_rule multiplicative_expression)
                 | '/' multiplicative_expression -> ^('/' $your_rule multiplicative_expression)
                 | '%' multiplicative_expression -> ^('%' $your_rule multiplicative_expression)
                 )* 
 ; 
```

# html - 如何防止 Web 应用程序上的水平滚动？

> ID：15821188
> 
> 赞同：0
> 
> 时间：2013-04-04T20:34:48.160
> 
> 标签：html, css, twitter-bootstrap, responsive-design

当我将浏览器的宽度减小到尽可能小的量时，我仍然看到用户可以水平滚动。鉴于我使用的是 Twitter Bootstrap，我预计情况并非如此。如何防止此页面上发生这种情况：

[http://warm-chamber-7399.herokuapp.com/](http://warm-chamber-7399.herokuapp.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:42:07.830

您可以使用

```
body{ overflow-x: hidden;} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:39:35.160

这就是你需要的——

```
.navbar-wrapper {
    max-width:100%;
    //your other CSS
} 
```

不要将它应用于身体或其他元素，因为它会搞砸。

# matlab - 是否可以在matlab中为二进制图像的单个连接分量着色？

> ID：15821193
> 
> 赞同：2
> 
> 时间：2013-04-04T20:35:14.820
> 
> 标签：matlab

我一直想知道您是否可以给我一些建议，将颜色添加到二进制图像的单个连接组件，这就是我所做的；首先，为了使用 matlab 的 bwlabel 功能，我将我的 RGB 图像转换为二进制，然后我编写了一个程序来询问用户他/她想要哪个组件。现在的问题是我们的 TA 要求我们为选定的组件着色然后显示结果。但我不知道它是否可能，如果它是如何做到这一点..提前感谢您的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:15:57.707

为此，您可以使用 RGB 颜色空间。由于您没有提供任何示例数据，我将使用`bwlabel`MATLAB 中的示例进行解释。

```
BW = logical([1 1 1 0 0 0 0 0
              1 1 1 0 1 1 0 0
              1 1 1 0 1 1 0 0
              1 1 1 0 0 0 1 0
              1 1 1 0 0 0 1 0
              1 1 1 0 0 0 1 0
              1 1 1 0 0 1 1 0
              1 1 1 0 0 0 0 0]);
L = bwlabel(BW,4);    %Result
imshow(L); 
```

![在此处输入图像描述](https://i.stack.imgur.com/MAYHS.png)

现在 L 将是：

```
 1     1     1     0     0     0     0     0
 1     1     1     0     2     2     0     0
 1     1     1     0     2     2     0     0
 1     1     1     0     0     0     3     0
 1     1     1     0     0     0     3     0
 1     1     1     0     0     0     3     0
 1     1     1     0     0     3     3     0
 1     1     1     0     0     0     0     0 
```

假设我想分别对组件 1,2 和 3 使用红色、绿色和蓝色：

```
[m, n] = size(L);
result_image = zeros(m, n, 3);
result_image(:,:,1) = (L==1);
result_image(:,:,2) = (L==2);
result_image(:,:,3) = (L==3);
imshow(result_image); 
```

![在此处输入图像描述](https://i.stack.imgur.com/0CyQU.png)

如果你有，比如说，另一个连接的组件 4（甚至更多），你可以使用类似的东西：

```
result_image(:,:,1) = result_image(:,:,1) + (L==4)*1;
result_image(:,:,2) = result_image(:,:,2) + (L==4)*0.5;
result_image(:,:,3) = result_image(:,:,3) + (L==4)*0; 
```

对于不同的颜色，只需使用相乘的值（此处为 1、0.5 和 0）。

# python - Pandas 下采样问题

> ID：15821194
> 
> 赞同：0
> 
> 时间：2013-04-04T20:35:19.477
> 
> 标签：python, pandas, downsampling

我有一个包含日期和 0 或 1 的两列的 csv 文件，如下所示：

```
17/08/2012 07:47:16 0
17/08/2012 07:54:31 1
17/08/2012 08:02:31 0
17/08/2012 09:22:33 0
17/08/2012 09:58:05 0
17/08/2012 12:26:59 1
17/08/2012 20:56:00 0
18/08/2012 10:04:06 0
18/08/2012 10:42:52 0
20/08/2012 07:22:02 0
20/08/2012 07:54:28 0
20/08/2012 08:01:58 0
20/08/2012 08:16:31 1
20/08/2012 08:26:38 0
20/08/2012 08:55:19 1
20/08/2012 09:00:09 0 
20/08/2012 09:26:11 0
20/08/2012 09:50:10 0
20/08/2012 10:33:37 0
20/08/2012 10:39:13 0
20/08/2012 10:39:35 1
20/08/2012 11:15:07 1
20/08/2012 11:19:15 0
20/08/2012 11:21:01 0 
```

我将此文件加载到 DataFrame 中`raw_data`，然后将索引更改为 Timestamp ：

```
ts_data=raw_data.set_index(pd.to_datetime(raw_data.when_created,dayfirst=True)) 
```

然后我尝试使用以下方法对数据进行下采样：

```
daily_conversions=ts_data.resample('D',how='sum') 
```

它适用于所有日子（有超过 7 个月的日期，这里我只包括一个子集），除了我得到这个输出的一天：

```
2012-08-20     NaN 
```

从数据中可以看出，这没有意义。有趣的是，如果我使用像“h”这样的更高频率进行下采样，我会在特定的日子得到正确的结果。我得到不存在的小时的空值 0 存在但只有 0 的小时和存在但 ==1 的小时的正确总和。请问有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T06:32:09.083

在上面的有用评论之后，我意识到出了什么问题。这只是标签的问题。所以实际上应该返回 NaN 的日期是 19 日，但默认设置是 label='right' 所以它显示为 20 日。当我添加 label='left' 时，它工作正常。谢谢

# javascript - 频道网址 Facebook

> ID：15821196
> 
> 赞同：2
> 
> 时间：2013-04-04T20:35:26.043
> 
> 标签：javascript, facebook, facebook-login, channel

我正在我的网站中实现 Facebook 登录，其格式为 mysite.anotherdomain.org。我在 JavaScript SDK 的文档中做了所有解释，但是由于我有一些问题，我想知道错误是否来自频道 URL。

我应该为频道文件写什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-09T00:26:56.940

频道文件基本上修复了某些浏览器的某些跨域问题。以下是 Facebook 确定的三个：

*   包含跨框架通信的代码的页面可能会导致社交插件在没有 channelUrl 的情况下显示为空白。*   如果未提供 channelUrl 并且页面包含自动播放的音频或视频，则用户可能会听到两个音频流，因为该页面已在后台第二次加载以进行跨域通信。*   通道文件将防止在您的服务器端日志中包含额外的命中。如果您未指定 channelUrl，则应从日志中删除包含 fb_xd_bust 或 fb_xd_fragment 参数的页面查看，以确保正确计数。

您在文件中需要的只是

```
<script src="//connect.facebook.net/en_US/all.js"></script> 
```

[您可以从https://developers.facebook.com/docs/reference/javascript/#channel](https://developers.facebook.com/docs/reference/javascript/#channel)了解更多信息

# ruby - Ruby Sinatra - 通过身份验证保护路由

> ID：15821200
> 
> 赞同：1
> 
> 时间：2013-04-04T20:35:31.410
> 
> 标签：ruby, authentication, routes, sinatra

我有一个 Ruby 类，它基本上对 LDAP 目录的用户进行身份验证，如下所示。该类`DirectoryUser`正在使用 net/ldap gem 来执行此操作。调用该类时，如果用户已通过身份验证，则返回“true”，否则返回“false”。

```
>>DirectoryUser.authenticate('user', 'password')
  #True 
```

我想使用这种机制来保护多个用户在基本 Sinatra 应用程序中的路由。

1.  有没有推荐的遵循最佳实践的方法来做到这一点？
2.  有人可以展示如何实现这一目标吗？

我正在考虑在允许访问路由之前设置一个变量并检查变量的状态。但是，我不禁想到这里可能会遗漏一些安全隐患！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:44:47.960

它在[Sinatra 常见问题解答中。](http://www.sinatrarb.com/faq.html#auth)

基本上，您需要创建一个辅助方法，如果用户未通过身份验证，该方法将引发异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-01-01T21:44:43.893

由于您已经在使用 LDAP 库进行身份验证，因此最佳实践是使用[Warden](https://github.com/hassox/warden)之类的东西进行授权。我们使用多种身份验证方法（基本身份验证、twitter 身份验证、LDAP 身份验证）很好地利用了这个应用程序。

# sql - SQL、更新和插入

> ID：15821204
> 
> 赞同：1
> 
> 时间：2013-04-04T20:35:55.107
> 
> 标签：sql, updates

嘿，所以我应该编写一个 AddSaleDetail 程序，它将为所购买的书籍添加销售详细信息，并使用该书籍信息更新销售。需要传入的数据是销售编号、ISBN 和数量。对于我已经完成的以下事情，我必须 RaiseErrors。ISBN 和销售编号无效 ISBN 已在该销售中。

如果没有任何错误，我必须将销售细节记录插入 SaleDetail 表。售价将是该 ISBN 的建议价格。

现在我所拥有的一切，直到接下来需要完成的两件事，这是我无法继续的地方。

更新 Title 表中的图书以减少库存数量 更新 Sale 表中的 Sale 记录小计、总计和 GST 字段以包括所购买图书的销售金额。

这是我所拥有的： **原始**

```
Create Procedure AddSaleDetail
(
@salenumber int,
@ISBN char(10),
@Quantity int,
@NumberInStock smallint
)
AS

SELECT sale.saleNumber, title.ISBN, saledetail.quantity,NumberInStock
FROM   sale INNER JOIN
   saledetail ON sale.saleNumber = saledetail.saleNumber INNER JOIN
   title ON saledetail.ISBN = title.ISBN

IF @ISBN is null or @salenumber is null
BEGIN
RAISERROR ('Please enter valid ISBN and Sale Number',16,1) 
END

Else
BEGIN
declare @sellingprice money
select  @sellingprice= suggestedprice from title where ISBN=@ISBN
declare @amount money = @quantity * @sellingprice

If exists (select * from saledetail where ISBN=@ISBN)
BEGIN 
RAISERROR ('ISBN already exists',16,1)

END
ELSE 
    if not exists (select * from saledetail where saleNumber=@salenumber)
    BEGIN
    RAISERROR ('Sale Number Does not exist',16,1)
    END

        ELSE
        BEGIN
            INSERT INTO saledetail(ISBN,saleNumber, sellingprice)
            values (@ISBN,@salenumber,@sellingprice )           
        END
        END
            Else
            BEGIN
            Update title(NumberInStock =@NumberInStock - @Quantity where    ISBN=@ISBN) 
```

**当前的**

```
Create Procedure AddSaleDetail
(
@salenumber int,
@ISBN char(10),
@Quantity int,
@NumberInStock smallint
)
AS

SELECT sale.saleNumber, title.ISBN, saledetail.quantity,NumberInStock
FROM   sale INNER JOIN
   saledetail ON sale.saleNumber = saledetail.saleNumber INNER JOIN
   title ON saledetail.ISBN = title.ISBN

IF @ISBN is null or @salenumber is null
BEGIN
RAISERROR ('Please enter valid ISBN and Sale Number',16,1) 
END

Else
BEGIN
declare @sellingprice money
select  @sellingprice= suggestedprice from title where ISBN=@ISBN
declare @amount money = @quantity * @sellingprice

 If exists (select * from saledetail where ISBN=@ISBN)

BEGIN 
RAISERROR ('ISBN already exists',16,1)

END
ELSE 
    if not exists (select * from saledetail where saleNumber=@salenumber)
    BEGIN
    RAISERROR ('Sale Number Does not exist',16,1)
    END

    ELSE
        Begin Transaction
        BEGIN 
            INSERT INTO saledetail(ISBN,saleNumber, sellingprice)
            values (@ISBN,@salenumber,@sellingprice )   
            if @@Error<>0       
            Begin
            Raiserror ('insert failed',16,1)

            Rollback Transaction 
            END 

    Else
            Begin
            UPDATE Title
            SET NumberInStock = NumberInStock - @Quantity 
            WHERE ISBN = @ISBN
            if @@Error<>0
                Begin
                Raiserror('Update failed',16,1)
                Rollback Transaction
                End

    Else
            begin
            Commit Transaction
            END 
        END 
    END
END 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:43:29.743

这次更新怎么样：

```
UPDATE Title
SET NumberInStock = NumberInStock - @Quantity 
WHERE ISBN = @ISBN 
```

NumberInStock 是一列，而不是@ 参数。

此外，您也可以这样做，但您必须创建 @total 和 @GST 变量：

```
UPDATE Sale
SET subtotal = @amount,
total = @total,
GST = @GST
WHERE sale.saleNumber = @salenumber 
```

我认为您的第一个 SELECT 查询不是很有用。您的程序将打印出所有内容。但是你已经有了你需要的参数，对吧？它们是输入参数。我希望这有帮助？

# python - Python 脚本对导出为空的 csv 文件进行排序

> ID：15821205
> 
> 赞同：0
> 
> 时间：2013-04-04T20:35:56.863
> 
> 标签：python, csv, python-2.7

我当前的 csv 文件

客户端.csv：

```
RecNo,AdultNo,NoChild,ClientName,CAT  
1,1,5,Fred Flintstone,0  
2,10,2,Georia OKeefe,5  
3,2,4,Joe BLow,6  
4,2,5,Cher,0 
```

所需的输出是按 NoChild 分组，然后按 ClientName 升序排序，然后将组导出到单独的 csv 文件。

因此对于 Client.csv 文件，我将拥有

1.csv - 空

2.csv
2,10,2,Georia OKeefe,5

3.csv - 空

4.csv
3,2,4,乔 BLow,6

5.csv
4,2,5,Cher,0 1,1,5
,Fred Flintstone,0

我得到所有 5 个 csv 文件，但它们是空的。我错过了什么？

下面是我的 Python 2.7 代码：

```
import csv

counter = ("1","2","3","4","5")
for variablefile  in counter:
    inputCSVFile = "C:\\Test\\Client.csv"
    variable_CSV = "C:\\Test\\" + variablefile + ".csv"

    with open(variable_CSV , 'wb') as f:
        with open(inputCSVFile) as test:
            reader = csv.DictReader(test)
            for row in reader:
                mylist = tuple([row["NoChild"] for row in reader])
                print mylist
                if mylist == variablefile:
                    print mylist
                    f.write((sorted("ClientName")) + '\n')
                else:
                    exit 
```

我一直在破解各种语法，但得到了相同的结果。我在这里想念什么？如果您有解决方案，请提供代码建议。我难住了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:40:33.413

据我所知，我怀疑`mylist == variablefile`ever return `True`since `mylist`is a `tuple`and is a string。`variablefile`

`TypeError`这也解释了为什么在尝试将列表添加到字符串时没有得到 a ：

```
(sorted("ClientName")) + '\n' 
```

而且，`sorted("ClientName")`会回来

```
['C', 'N', 'a', 'e', 'e', 'i', 'l', 'm', 'n', 't'] 
```

这可能也不是你的意思......

# language-agnostic - 依赖注入、延迟加载、代理和循环依赖

> ID：15821213
> 
> 赞同：3
> 
> 时间：2013-04-04T20:36:22.180
> 
> 标签：language-agnostic, dependency-injection, lazy-loading, factory, proxy-pattern

这是一个独立于语言的问题，但我用 PHP 编写示例代码。

我们有两个类：

1.  **用户**类
2.  **UserRepository**类

UserRepository 类处理与 DB 的交互并将所需的 User 加载到 User 对象中并返回它。

在 User 类中，假设有一个 email 属性一开始就没有加载，它会在需要时从数据库中延迟加载。但是**User**类不应该知道**UserRepository**类，所以我们在这里创建一个电子邮件代理。它知道**UserRepository**并且无论需要电子邮件，它都会从**UserRepository**询问它。

所以这是到目前为止的代码：

## 用户类

```
class User
{
    private $username;
    private $email_proxy;
    public function __construct($username,EmailProxy $email_proxy)
    {
        $this->username = $username;
        $this->email_proxy = $email_proxy;
    }

    public function get_username()
    {
        return $this->username;
    }

    public function get_email()
    {
        return $this->email_proxy->get_email($this->get_username());
    }
} 
```

## UserRepository 类

```
class UserRepository
{
    private $db;
    public function __construct($db)
    {
        $this->db = $db;
    }

    /**
     * @param string username
     * @return string email , email address of the user
     */
    public function get_email_by_username($username)
    {
        // interaction with DB, ...
        return $user_email;
    }
} 
```

## 电子邮件代理类

```
class EmailProxy
{
    private $user_repository;
    public function __construct(UserRepository $repository)
    {
        $this->user_repository = $repository;
    }
    public function get_email($username)
    {
        return $this->user_repository->get_email_by_username($username);
    }
} 
```

这是使用示例：

```
$user_repository = new UserRepository($db_instance);
$email_proxy = new EmailProxy();
$user = new User('my_username', $email_proxy); 
```

到目前为止，一切都很好。但这是我需要你帮助的棘手部分。从本质上讲，UserRepository 应该负责从 DataBase 中获取 User 对象，构造 User 对象并返回它。如下所示：

```
class UserRepository
{
    private $db;
    public function __construct($db)
    {
        $this->db = $db;
    }

    public function get_email_by_username($username)
    {
        // interaction with DB, ...
        return $user_email;
    }

    public function get_user_by_username($username)
    {
        // fetch the User from DB and ...
        return new User($fetched_username) // missing the EmailProxy
    }
} 
```

所以我的问题是如何将 EmailProxy 传递**给由****UserRepository**创建的**User**对象？

 ***   您是否将 UserProxy 实例注入到 UserRepository 以便可以将其注入到新创建的 User 对象中？

*   你会为此使用依赖注入容器吗？

*   你会用工厂吗？

### 编辑

> **EmailProxy**已经知道**UserRepository**，如果我们也将**EmailProxy**传递给**UserRepository**，那将是一个循环依赖。

任何代码/评论将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T17:20:11.497

这是一个棘手的问题，我很想听听人们如何处理它。与此同时，这就是我自己的想法。

我会将`User`和`UserRepository`类的创建放在工厂中

```
class ServiceFactory
{
    private $instances=[];
    public function createUser($data)
    {
        return new User($data)
            ->setEmailProxy($this->createEmailProxy());

    }

    public function createEmailProxy()
    {
        if (!isset($this->instances['EmailProxy'])) {
            $this->instances['EmailProxy'] = new EmailProxy(
                $this->createUserRepository()
            );
        }
        return $this->instances['EmailProxy'];
    }

    public function createUserRepository()
    {
        if (!isset($this->instances['UserRepository'])) {
            $this->instances['UserRepository'] = new UserRepository(
                $db, 
                $this->createDtoFactory()
               );
        }
        return $this->instances['UserRepository'];
    }

    public function createDtoProvider()
    {
        return new DtoProvider($this);
    }

} 
```

这是`DtoProvider`类的代码

```
class DtoProvider
{
    private $serviceFactory;

    public function __construct($factory) 
    {
        $this->serviceFactory = $factory;
    }

    public function createUser($data)
    {
        return $this->serviceFactory->createUser($data);
    }

    public function createOtherStuff($data)
    {
        return $this->serviceFactory->createOtherStuff($data);
    }
} 
```

此类的目的是对服务隐藏工厂。你只为他们提供他们需要的东西。

现在您的 UserRepository 应该看起来像这样

```
class UserRepository
{
    private $db;
    private $services;
    public function __construct($db, $serviceProvider)
    {
        $this->db = $db;
        $this->services = $serviceProvider;
    }

    public function get_email_by_username($username)
    {
        // interaction with DB, ...
        return $user_email;
    }

    public function get_user_by_username($username)
    {
        // fetch the User from DB and ...
        return $this->services->createUser($data)
    }
} 
```

这似乎有点矫枉过正（它可能是），但它允许你很容易地重构你的代码，这有利于长期应用。

我想这完全取决于您是喜欢易于阅读的代码还是易于（快速）编写的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T23:13:17.627

也许是对您方法中的`User`对象的引用。`UserRepository::get_email_by_username()`

就像是：

```
public function get_email_by_username(&$username)
{
    // interaction with DB, ...
    $username->setEmail($email_proxy);
} 
```

[http://php.net/manual/en/language.references.pass.php](http://php.net/manual/en/language.references.pass.php)

* * *

在回复您的评论时，您可以在创建用户时简单地调用 UserRepository 方法：

```
public function get_user_by_username($username)
{
    $email_proxy = this->get_email_by_username($username);
    return new User($fetched_username, $email_proxy);
} 
```

但是，这似乎是一个太明显的答案，我怀疑您问的问题与发布的完全不同。您可能想改写您的问题：

> 所以我的问题是如何将 EmailProxy 传递给由 UserRepository 创建的 User 对象？**

# javascript - 扩展设置器默认对象

> ID：15821225
> 
> 赞同：2
> 
> 时间：2013-04-04T20:37:06.283
> 
> 标签：javascript, this, defineproperty

就像你们都知道一个按钮就是一个按钮......点击，向上，向下，做这个，做那个。所以我写了一些默认的按钮行为“类/对象”。

外部默认按钮.js：

```
function Button(parent) {
    var self = this;
    this.enabled = true;
    this.visible = true;
    ...

    this.initialized = false;

    f_createButton(parent, self);

    this.initialized = true;
    ...
}

Button.prototype = {
    get initialized () { 
        return this._initialized; 
    },
    set initialized(bool){ 
        this._initialized = bool
        if(this.initialized === true) {
            ... do default stuff
        }
    },
    get enabled(){
        return this._enabled;
    },
    set enabled(bool){
        this._enabled = bool;
        if(document.getElementById(this.id)) { // is button defined?
            var mClassName = document.getElementById(this.id).children[0].className;
            document.getElementById(this.id).className = (this.enabled === false) ? "button button-Gray_disabled" : "button button-" + this.defaultStyle;
            document.getElementById(this.id).children[0].className = (this.enabled === false) ?  mClassName + "_disabled" : mClassName.replace("_disabled","");
        }
    }
}

function f_createButton("", obj) {
    .... create DOM element 
} 
```

在 html 中包含 button.js 并扩展按钮“类/对象”：

```
Object.defineProperty(Button.prototype,"buttonStyle", {
    get : function() {
        return this._buttonStyle;
    },
    set : function(str) {
        this._buttonStyle = str;
        if(this.id !== "undefined" && document.getElementById(this.id)) { // is button defined?
            document.getElementById(this.id).style.backgroundImage = 'url(Images/'+this.buttonStyle+'/buttons.png)';
        }
    }
}); 
```

这几乎可以工作，但它会杀死初始化的原始 Button。

```
Object.defineProperty(Button.prototype,"initialized", {
    set : function( bool ) {
        this._initialized = bool;
        if(this.initialized === true) {
            this.buttonStyle = "NONE";
        }
    }
}); 
```

如何扩展原始设置器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T17:30:07.620

你问的似乎不寻常，但让我们试试。首先，考虑这个基类，它将在您的外部 js 文件中：

```
// Constructor
function Button() {
    var self = this;
    var _initialized = false; // 'private' property manipulated by the accessors

    this.initialized = false;
    this.createButton();
    this.initialized = true;
}

// Default prototype
Button.prototype = { 
    createButton: function() {
        console.log(' create DOM element ');  
    }  
}

// Default getter/setter on prototype
Object.defineProperty(Button.prototype,"initialized", {
    set : function( bool ) {
        console.log('this is the original setter');
        this._initialized = bool;
        if(this._initialized === true) {
            console.log('do default stuff')
        }
    },

    get : function() {
        return this._initialized; 
    },

    configurable : true // IMPORTANT: this will allow us to redefine it
}); 
```

如果我理解您的要求，您想重新定义`initialized`访问器（getter/setter），但仍然引用旧的访问器。也许有更好的方法可以做到这一点，但是您可以将原始访问器复制到新访问器中，然后重新定义它：

```
// Keep reference to the old accessors
var original = Object.getOwnPropertyDescriptor(Button.prototype, 'initialized');
Object.defineProperty(Button.prototype, "oldInitialized", {
    set : original.set,
    get : original.get
});

// Redefine getter and setter
Object.defineProperty(Button.prototype, "initialized", {
    set : function( bool ) {
        console.log('this is the new setter');
        this.oldInitialized = bool;
    },

    get : function() {
        return this._initialized; 
    }
}); 
```

这是工作中的代码：http: [//jsfiddle.net/aTYh3/](http://jsfiddle.net/aTYh3/)。

# javascript - html变化之间的过渡

> ID：15821228
> 
> 赞同：1
> 
> 时间：2013-04-04T20:37:11.750
> 
> 标签：javascript, jquery, css, css-transitions, transitions

我有这两个功能，一个从页面中删除所有内容，一个将其添加回来。删除所有内容后，会显示一个黑色的屏幕，中间有一个加载徽标。

```
Base.showLoading = function () {
    var r = false;
    if (!$('body').hasClass('overlay')) {
        Obj.tempHtml = $('body').html();
        $('body').html('');
        $('body').addClass('overlay');
        r = true;
    }
    return r;
};

Base.hideLoading = function () {
    var r = false;
    if ($('body').hasClass('overlay')) {
        $('body').html(Obj.tempHtml);
        delete Obj.tempHtml;
        $('body').removeClass('overlay');
        r = true;
    }
    return r;
}; 
```

和 CSS 类`overlay`：

```
.overlay
{
    background-color: #111;
    background-position: center;
    background-image: url('../img/loading_black.gif');
    background-repeat: no-repeat;
    background-attachment: fixed;
    background-position: center;
    width: 100%;
    height: 100%;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 999;
} 
```

现在，我如何才能在两者之间平稳过渡？

现在它只是直接进入黑屏并且看起来不正确。我不知道该怎么做。

JS/jQuery 或 CSS 解决方案都很好:)。虽然首选 CSS。谢谢 ：）

我知道这样做会删除所有绑定等，但我已经考虑到了这一点，`hideLoading`就像从未使用过一样，是的:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:40:39.140

无需执行 .html('') 和 .html(string)，只需分离元素即可。

```
Base.showLoading = function () {
    var r = false;
    if (!$('body').hasClass('overlay')) {
        Obj.bodyElements = $('body').children().fadeOut(200);
        Obj.bodyElements.promise().done(function(){
            Obj.bodyElements.detach();
            $('body').addClass('overlay');
        });        
        r = true;
    }
    return r;
};

Base.hideLoading = function () {
    var r = false;
    if ($('body').hasClass('overlay')) {
        $(Obj.bodyElements.get()).appendTo('body');
        $('body').removeClass('overlay');
        $('body').children().fadeIn(200);
        r = true; 
    }
    return r;
}; 
```

我还添加了如何使用`.fadeOut(200)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:40:44.693

使用 CSS3 过渡：

```
body {
    -webkit-transition: 0.5s background ease;
    -moz-transition: 0.5s background ease;
    -o-transition: 0.5s background ease;
    transition: 0.5s background ease;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:41:58.560

不要将主体设置为具有覆盖类。

相反，创建一个覆盖主体的 div，它始终具有该类。该类应具有“显示：无；”

当你想杀死你的页面时，你可以使用 jQuery 来做到这一点：

```
$('#overlay').show(500); 
```

然后你可以替换下面的内容，你可能想要这样做，在覆盖显示之后，然后隐藏覆盖，如下所示：

```
$('#overlay').show(500, function() {
    // replace the page contents here
}).hide(500); 
```

# ios - YouTube Data API 的视频上传隐私设置

> ID：15821229
> 
> 赞同：0
> 
> 时间：2013-04-04T20:37:15.933
> 
> 标签：ios, youtube-api

我正在研究使用 YouTube 数据 API 从 iOS 应用上传视频。

我希望这些视频存在于专门为应用程序制作的频道中。我还希望所有上传的视频都是私有的，并且只能通过“秘密” URL 可见（就像 Dropbox 通过公共 URL 提供您的私有文件一样）。我听说这在 YouTube API 中是可能的。

我的问题是：在进行 HTTP 请求上传视频时，是否可以将视频设置为私有？如果是这样，是否有可能在响应中有一个“秘密”URL？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T07:26:18.813

是的……这很简单。您唯一需要注意的是您要使用的 API 版本。如果您使用第 2 版，那么当您上传视频时，您将发送一个包含元数据的 XML 数据包——该数据包必须包含该`<yt:private/>`元素。通过 API 对私有视频的所有更新都必须包含该元素，否则该视频随后将设置为公开。使用 API 的 v2 成功上传将返回一个 Atom 提要，其中包含有关视频的信息，包括其 ID、嵌入代码等，从而满足您的第二个要求。

在 API 的 v3 中，您将向 RESTful 端点发送一个 json 数据包，并且在上传（以及后续更新）时必须包含此属性：

```
"status": {
    "privacyStatus": "private"
  } 
```

同样，它将返回您的视频对象的 json 表示，其中包括 ID 和嵌入代码，因此您可以获得私人视频的 URL。

更多信息可以在这里找到：

[https://developers.google.com/youtube/2.0/developers_guide_protocol#Uploading_Videos](https://developers.google.com/youtube/2.0/developers_guide_protocol#Uploading_Videos)（适用于 v2）

和这里：

[https://developers.google.com/youtube/v3/docs/videos/insert](https://developers.google.com/youtube/v3/docs/videos/insert)（适用于 v3）

# spring-batch - 在 Spring 批处理上访问 ItemProcessor 上的 jobParameter

> ID：15821231
> 
> 赞同：0
> 
> 时间：2013-04-04T20:37:17.250
> 
> 标签：spring-batch

我是 Spring Batch 的新手，在我的开发过程中，我遇到了一个需要访问 ItemProcessor 上的 jobParameter 的场景。我已经在阅读器上完成了此操作（MultiresourceReader 和 StaxeventItemReader 也使用了我构建的 CustomReader）并且它成功了，我可以检索 jobParameter 但不能使用 ItemProcessor。

这是我的片段。

```
<bean id="myProcessor" class="com.......MyCustomProcessor" scope="step">
    <property name="myBean" ref="customBean"/>
</bean>
<bean id="customBean" class="...................MyCustomBean" scope="step">
    <property name="file" value="#{jobParameters['FILE']}/fileName.txt"/>
</bean> 
```

它正在产生一个lazyBinding 异常。关于如何在项目处理器上检索 jobParameter 的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-10T15:41:01.477

根据我在您的代码段中看到的内容，您尝试从 customBean 访问作业参数...而不是*ItemProcessor*！。

Spring 中的常规 bean 不理解*step*范围。Spring bean 的范围是单例、原型、请求或会话！

如果你移动你的

```
<property name="file" value="#{jobParameters['FILE']}/fileName.txt"/> 
```

到*ItemProcessor*它应该可以工作。

我假设您在处理器内部使用 customBean？如果是这样，那么您将能够在*ItemProcessor*中设置 jobParameter 的值。

# ios - App Store 提交，验证错误

> ID：15821236
> 
> 赞同：0
> 
> 时间：2013-04-04T20:37:43.967
> 
> 标签：ios, app-store

在过去的 17 小时左右，我一直在尝试向 App Store 提交新的应用程序。这不是第一个提交的。如果我单击**管理器窗口上的****分发**按钮将二进制文件提交到**App Store**，我会收到一条错误消息，指出**应用程序代码签名验证失败。****签名无效，包含不允许的权利，或者未使用 iPhone 分发证书签名**。我已经阅读了十几个有关此错误的主题。到目前为止我所拥有的是

 ******![在此处输入图像描述](https://i.stack.imgur.com/s1XPn.jpg)

1.  我有正确的分销证书。
2.  构建配置设置为“发布”。
3.  顺便说一句，我一开始没有任何权利。
4.  选择正确的代码签名身份以及应用程序。另外，我有正确的用户名和密码来连接 iTunes Connect。
5.  我已经下载并重新安装了相关应用程序的分发证书。
6.  我什至创建了一个新的 App ID 和一个包标识符来以不同的名称提交这个应用程序。我得到了同样的验证错误。

你知道我做错了什么吗？我已经没有选择了。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:19:47.120

我知道了。解决方案是删除垃圾文件。我使用了以下链接中描述的终端命令。 [https://superuser.com/questions/319553/mac-terminal-script-to-remove-hidden-files](https://superuser.com/questions/319553/mac-terminal-script-to-remove-hidden-files)******

# html - 使用 css 和 html 上的文本向每个 LI 添加不同的图像作为按钮

> ID：15821237
> 
> 赞同：0
> 
> 时间：2013-04-04T20:37:45.437
> 
> 标签：html, css, html-lists

我试图做到这一点，我可以向每个 LI 添加一个图像，而不是一个项目符号图像，而是一个表示按钮本身的图像，并且我希望能够在 html 中使用文本。我已经尝试过#glass_menu ul li.shard1,.shard1 我无法弄清楚有人可以帮忙！

CSS：

```
#glass_menu {
width:984px;
text-align:center;
text-decoration:none;
display:inline;
position:relative;
bottom:-20px;
}
#glass_menu ul li{
padding: 0 40px 0 40px;
display: inline;
}

.shard1{
background-image:url(glasshard1.png);
background-repeat: no-repeat;
width:30px;
height:30px;

}
.shard2{
background-image:url(glasshard2.png);
background-repeat: no-repeat;
width:30px;
height:30px;    
}
.shard3{

}
.shard4{

}
.shard5{ 

}
.shard6{

} 
```

html:

```
<div id="glass_menu">
<ul class="menu">
<li class="shard1"><a href="index.php">home</a></li>
<li class="shard2"><a href="Estimate.php"><span>Estimate</span></a></li>
<li class="shard3"><a href="why-should-you-choose-us.html"><span>help</span></a></li>
<li class="shard4"><a href="Contact.php"><span>Contact Us</span></a></li>
<li class="shard5"><a href="affiliates.html"><span>Affiliates</span></a></li>
<li class="shard6"><a href="Location.html"><span>Location</span></a></li>
</ul>
</div><!--end glass_menu div--> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:15:33.303

1) 重置您的列表：

```
#glass_menu ul li {
    list-style:none;
    margin:0;
    padding:0;
} 
```

2) 不要设置 LI 的样式，除了定位/浮动。

```
#glass_menu li {
    float:left
} 
```

3) 为 LINK 设置样式并使用`display:block`. 删除 SPAN，它没有理由在那里。

```
.shard1 a {
    background-image:url(glasshard1.png);
    background-repeat: no-repeat;
    width:30px;
    display:block;
    padding-left: 30px; <--- you need this to move your text to the right to uncover the background image.
} 
```

4）阅读我的教程：[我喜欢列表。](http://preview.moveable.com/jm/ilovelists/)

# html - 单个元素上的 CSS 多个动画，没有 javascript

> ID：15821245
> 
> 赞同：7
> 
> 时间：2013-04-04T20:38:21.640
> 
> 标签：html, css, animation, css-animations

我正在尝试仅使用 CSS 而没有 Javascript 创建图像幻灯片。

我在这里有一个几乎可以工作的例子：http: [//codepen.io/k/pen/Dkhei](http://codepen.io/k/pen/Dkhei)。问题是当我停止将鼠标悬停在其元素上时，“上一个”功能的动画不会暂停。

我在一个元素上定义了两个动画，其类名为“imageContainer”。我很想知道我的语法是否错误，或者我想要做的事情是不可能的。

HTML：

```
<div class='carouselContainer'>
<div class='directionSelector previous'>Previous</div>
<div class='directionSelector next'>Next</div>
<div class='imagesContainer'>
  <img class='visible' src='http://ibmsmartercommerce.sourceforge.net/wp-content/uploads/2012/09/Roses_Bunch_Of_Flowers.jpeg'/>
  <img class='hidden' src='http://houseoflowers.com/wp-content/uploads/2013/03/Splendid-flowers-wallpaper-wallpapers-1920x1200-mrwallpaper-com.jpg'/>
  <img class='hidden test' src='http://wallzpoint.com/wp-content/gallery/flower-4/flower-flowers-31723005-1600-1200.jpg'/>
  <img class='hidden' src='http://images2.layoutsparks.com/1/179204/no-idea-t5-flowers.jpg'/>
  <img class='hidden' src='http://3.bp.blogspot.com/-Ca_H0XQYQI4/UQFMSauQxTI/AAAAAAAABik/WHzskd_HqqU/s1600/flowers.jpg'/>
</div>
</div> 
```

CSS：

```
.carouselContainer{
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border: 1px solid grey;
  width: 450px;
  height: 300px; 
  position: relative;
  background-color: grey;
  margin: auto;
  overflow: hidden;
}

.directionSelector{
  width: 60px;
  height: 1.5em;
  line-height: 1.5em;
  top: 150px !important;
  position: absolute;
  cursor: pointer;
  background-color: rgba(1,1,1,.7);
  color: white;
  text-align: center;
  border-radius: 5px;
}
.previous{
  top: 0;
  left: 5px;
}
.next{
  top: 0;
  right: 5px;
}
img{
  width: 100%;
  height: 300px;
  float: left;
}
.imagesContainer{
  width: 100%;
  background-color: yellow;
  -webkit-animation-name: showImagesPrev,showImagesNext;
  -webkit-animation-duration: 5s,5s;
  -webkit-animation-play-state: paused,paused;
  -webkit-animation-fill-mode: forwards,forwards;

  -moz-animation-name: showImagesPrev,showImagesNext;
  -moz-animation-duration: 5s,5s;
  -moz-animation-play-state: paused,paused;
  -moz-animation-fill-mode: forwards,backwards;

  animation-name: showImagesPrev,showImagesNext;
  animation-duration: 5s,5s;
  animation-play-state: paused,paused;
  animation-fill-mode: forwards,backwards;

}
.previous:hover ~ div.imagesContainer{
  -webkit-animation-name: showImagesPrev;
  -webkit-animation-play-state: running; 

  -moz-animation-name: showImagesPrev;
  -moz-animation-play-state: running; 

  animation-name: showImagesPrev;
  animation-play-state: running; 
}
.next:hover ~ div.imagesContainer{
  -webkit-animation-name: showImagesNext;
  -webkit-animation-play-state: running;

  -moz-animation-name: showImagesNext;
  -moz-animation-play-state: running;

  animation-name: showImagesNext;
  animation-play-state: running;
}
@-webkit-keyframes showImagesPrev{
  from{
    margin-top: 0px;
  }
  to{
    margin-top: -1200px;
  }
}
@-moz-keyframes showImagesPrev{
  from{
    margin-top: 0px;
  }
  to{
    margin-top: -1200px;
  }
}
@keyframes showImagesPrev{
  from{
    margin-top: 0px;
  }
  to{
    margin-top: -1200px;
  }
}
@-webkit-keyframes showImagesNext{
  from{
    margin-top: -1200px;
  }
  to{
    margin-top: 0px;
  }
}
@-moz-keyframes showImagesNext{
  from{
    margin-top: -1200px;
  }
  to{
    margin-top: 0px;
  }
}
@keyframes showImagesNext{
  from{
    margin-top: -1200px;
  }
  to{
    margin-top: 0px;
  }
} 
```

感谢您的帮助 ：）

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-15T08:50:56.693

根据 W3C`animation-name`属性[链接](http://www.w3.org/TR/css3-animations/#animation-name-property)

> 如果多个动画试图修改同一个属性，则最接近名称列表末尾的动画获胜。

在您的示例`showImagesPrev`中，首先引用并且`showImagesNext`是最后一个，因此它按照 W3C 正常工作。如果您交换这两个参考，`Previous`将正常工作，而`Next`按钮重现问题。一个工作[示例](http://jsfiddle.net/bWxmq/1/)

# php - 如何在添加到另一个表时从一个表中减去一个值？

> ID：15821251
> 
> 赞同：0
> 
> 时间：2013-04-04T20:38:59.883
> 
> 标签：php, mysql, sql

所以，我有 2 个脚本在同一个数据库上运行，但每个脚本都有自己的表（如用户、帖子等），并且它们有积分系统。

现在，我想做的是使点从一个发送到另一个成为可能。我创建了一个简单的表单，其中包含要填写的名称和点数，然后在提交时将发送到另一个处理信息的页面，从用户那里取走给定的金额（将检查会话），然后将其发送到给定的名称（在另一个脚本中注册）。

好的，当它处理时，积分被带走（如果积分不足，则给出“积分不足”错误），但积分不会记入另一个帐户。有可能解决这个问题吗？

下面是代码片段：

```
// Start session management
$user->session_begin();
$auth->acl($user->data);
$user->setup('mods/points'); 
$pointst1 = request_var('pointst', 0);
$bsname1 = request_var('bsname', 0);

if ( $user->data['user_points'] < $pointst1 ){
echo "<b>You don't have enough points</b>";
}

else {
remove_points($user->data['user_id'], $pointst1);
mysql_query("UPDATE users SET points = (points + $pointst1) WHERE name = '$bsname'");
echo "<b>Points tranferred!</b>";
};

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:00:05.397

几件事。

首先，我建议您查看有关处理 SQL 提交的网站。这将有助于确保您不会从一个用户那里删除积分，并且不会将它们添加到另一个用户。这可能发生在您当前的代码示例中

[http://php.net/manual/en/mysqlnd-ms.transaction.php](http://php.net/manual/en/mysqlnd-ms.transaction.php)

其次，这部分似乎将 php 变量作为文本传递

> mysql_query("UPDATE users SET points = (points + $pointst1) WHERE name = '$bsname'"); echo "**积分转移了！** "

您可能想将其更改为

```
mysql_query("UPDATE users SET points = (points + {$pointst1} ) WHERE name = {$bsname}");
echo "<b>Points tranferred!</b>" 
```

我不是 PHP 程序员，所以你可以在这里查看我的逻辑：http: [//php.net/manual/en/language.operators.string.php](http://php.net/manual/en/language.operators.string.php)

希望能帮助到你

# c++ - 在opencv中将三个灰度[R，G，B]图像合并为单色图像

> ID：15821253
> 
> 赞同：6
> 
> 时间：2013-04-04T20:39:07.043
> 
> 标签：c++, image, opencv, image-processing

我有 3 个使用拆分功能创建的灰度图像。现在我想重新生成彩色图像。我尝试了以下代码，但没有成功。我得到的结果图像仍然是灰度的。

```
 cv::Mat R = cv::imread("/home/r/secret_R.png",0);
        cv::Mat G = cv::imread("/home/r/secret_G.png",0);
        cv::Mat B = cv::imread("/home/r/secret_B.png",0);
        std::vector<cv::Mat> array_to_merge;
        array_to_merge.push_back(R);
        array_to_merge.push_back(G);
        array_to_merge.push_back(B);
        cv::Mat color;
        cv::merge(array_to_merge, color); 
```

于是我尝试了 cvtColor 函数：

```
 cv::Mat color_converted;
        cv::cvtColor(color, color_converted, CV_GRAY2BGR);
        cv::imwrite("/home/r/color_secret.png",color_converted); 
```

但显然，它只适用于只有一个通道的源图像。我通过了我的一张灰度图像：

```
cv::cvtColor(R, color_converted, CV_GRAY2BGR); 
```

但我仍然无法恢复彩色图像。结果图像仍然是灰度的

我究竟做错了什么 ？如何恢复我的彩色图像？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-05T02:32:04.233

我看不出你的代码有什么问题。我怀疑它可能是源数据，或者进口商如何处理它。加载图像后，是否可以打印出图像元数据以查看 OpenCV 正在读取哪些属性？它们都必须具有相同的尺寸和单个通道。

```
std::cout << "Red:   " << R.size().width << " x " << R.size().height << " x " << R.channels() << std::endl;
std::cout << "Green: " << G.size().width << " x " << G.size().height << " x " << G.channels() << std::endl;
std::cout << "Blue:  " << B.size().width << " x " << B.size().height << " x " << B.channels() << std::endl; 
```

我刚刚运行了你的程序，只是添加了标题和主要内容。我做了一个小改动，以 B、G、R 顺序合并（默认）。我在 Mac OS X 10.8 上编译它：

```
g++ -o merge merge.cpp -lopencv_core -lopencv_highgui 
```

针对 OpenCV 2.4.3 版。

```
#include <opencv2/highgui/highgui.hpp>
#include <opencv2/core/core.hpp>

int main(int argc, char* argv[])
{
    cv::Mat R = cv::imread("chan_dest_red.png", 0);
    cv::Mat G = cv::imread("chan_dest_green.png", 0);
    cv::Mat B = cv::imread("chan_dest_blue.png", 0);

    std::vector<cv::Mat> array_to_merge;

    array_to_merge.push_back(B);
    array_to_merge.push_back(G);
    array_to_merge.push_back(R);

    cv::Mat color;

    cv::merge(array_to_merge, color);

    imwrite("merged.png", color);

    return 0;
} 
```

我有一些来自另一个项目的单通道图像已经分割成文件，我只是将它们合并成一个单色图像，它工作得很好。源文件信息如下：

```
Red:   500 x 333 x 1
Green: 500 x 333 x 1
Blue:  500 x 333 x 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T01:49:52.877

一种方法是使用**cvtColor从一个通道创建彩色图像，然后使用****at**函数在循环中逐像素替换其他两种颜色。可能有一种方法可以使用矩阵运算符更轻松地做到这一点，但我对 openCV 还不够熟悉，无法确定。

# c# - 使用反射调用 FindBy 方法，该方法采用存储库上的表达式

> ID：15821254
> 
> 赞同：0
> 
> 时间：2013-04-04T20:39:09.480
> 
> 标签：c#, reflection, entity-framework-5

所以我有一个方法，我需要从我的 Bucket 中获取存储库的集合，遍历这些存储库并找到存储库中需要过期的所有记录，然后将它们过期。我在弄清楚如何使用 Func 执行 Invoke 时遇到问题。有什么想法吗？我走错路了吗？

```
 public void DeactivateNonTransversableExpiredRecords()
    {
        databucket = new AdminBucket(PublishingFactory.AuthoringContext);

        IEnumerable<Tuple<dynamic, Type>> nonTransversableList = this.GetNonTransversableRepositories(databucket);

        foreach (Tuple<dynamic, Type> repository in nonTransversableList)
        {
            Type repoType = repository.Item1.GetType(); // RepositoryType
            var method = repoType.GetMethod("FindBy"); // Method
            var entityType = repository.Item2; // EntityType

            // Not working
            IQueryable recordsToExpire = method.Invoke(new Func<BaseEntity, bool>((x) => x.IsActive));

            foreach (var row in recordsToExpire)
            {
                ((BaseEntity) row).IsActive = false;
                repository.Item1.Edit((BaseEntity) row);
            }
        }
    }` 
```

**编辑：解决方案...** @Eduard 的贡献对于解决这一挑战非常宝贵。我会投票赞成他的贡献，但是，这不是实施的实际解决方案。

通过贡献的代码，我发现在尝试将记录保存回数据库时，像我所做的那样将 IQueryable 返回给动态变量会导致问题。如果您要使用只读集，那么@Eduard 的解决方案将非常有效。

我最终在模型的 BaseRepository 中创建了一个特定于发布的方法，该`.FindBy()`方法调用同一存储库中的方法。此发布特定方法返回`IList<T>`发布应用程序。这允许动态变量在枚举集合和执行时正常工作，`.Edit()`而不必担心什么类型进入什么存储库。使用默认`.FindBy()`返回的 a`IQueryable<T>`导致 EF5 吐出“不允许新事务，因为会话中正在运行其他线程”。

这是一个工作示例

模型的 BaseRepository 代码

```
public IList<T> GetItemsToExpire(DateTime date)
{
    return this.GetActive(x => x.ExpirationDate <= date).ToList<T>();
}

public virtual IQueryable<T> GetActive(Expression<Func<T, bool>> predicate)
{
    return this.GetActive().Where(predicate);
}

public virtual new IQueryable<T> GetActive()
{
    return this.FindBy(entity => entity.IsActive)
} 
```

出版服务代码

```
public void DeactivateNonTransversableExpiredRecords()
{
    databucket = new AdminBucket(PublishingFactory.AuthoringContext);

    IEnumerable<dynamic> nonTransversableRepositories = this.GetNonTransversableRepositories(databucket);

    foreach (dynamic repository in nonTransversableRepositories)
    {
        dynamic activeRecordsReadyToExpire = repository.GetItemsToExpire(DateTime.Now.AddDays(-1));  
        foreach (var record in activeRecordsReadyToExpire)
        {
            ((BaseEntity)record).IsActive = false;
            repository.Edit(record, true);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:49:27.573

我将根据我的直觉做出一个假设，并说我在您的代码中看到了 2 个问题。

首先，您的 FindBy 方法肯定是实例方法，而不是静态方法。因此，除了您愿意传递的参数（Func）之外，您还需要传递应该调用“FindBy”方法的实例。另外：您需要彻底尊重 Invoke 方法的签名：一个对象用于实例，一个对象数组用于参数。

第二，您可能会很好地使用 DLR 并在语法上调用希望的方法。

请注意我的小修改：

```
 Type repoType = repository.Item1.GetType(); // RepositoryType
        var method = repoType.GetMethod("FindBy"); // Method
        var entityType = repository.Item2; // EntityType

        // Should work
        IQueryable recordsToExpire = method.Invoke(
             repository.Item1, 
             new object[] { (Expression<Func<BaseEntity, bool>>)((x) => x.IsActive) }
        ) as IQueryable; 
```

如果您查看 MethodInfo 类的 Invoke 方法，您会注意到第一个参数是“this”参数。所以你正在做的是试图在 Func < T, ReturnType > 委托类型上调用“FindBy”（它没有一个名为“FindBy”的方法）

更美观的方法是顺其自然，使用 DLR，使用“动态”类型的强大功能，如下所示：

```
 //Type repoType = repository.Item1.GetType(); // RepositoryType
        //var method = repoType.GetMethod("FindBy"); // Method
        var entityType = repository.Item2; // EntityType

        // Should work
        dynamic someDynamicResult = repository.Item1.FindBy ((Expression<Func<BaseEntity, bool>>)((x) => x.IsActive));
        IQueryable whichAtRuntimeShouldActuallyBeAnIQueryable = someDynamicResult; 
```

**大编辑**

如果您需要**动态创建显式**的“IsActive” lambda，您可以这样做：

```
public class SomeClass
{
    private static MethodInfo methodOf_CreateLambdaGeneric = 
        typeof(SomeClass).GetMethod("CreateIsActiveLambdaGeneric");

    public static Expression<Func<T, bool>> CreateIsActiveLambdaGeneric<T>() where T : BaseEntity {
        return x => x.IsActive;
    }
    public static LambdaExpression CreateIsActiveLambda(Type type) {
        MethodInfo particularized = methodOf_CreateLambdaGeneric.MakeGenericMethod(type);
        object theLambda = particularized.Invoke(null, null);
        return theLambda as LambdaExpression;
    }
    } 
```

然后像这样使用这些辅助方法：

```
 //Type repoType = repository.Item1.GetType(); // RepositoryType
        //var method = repoType.GetMethod("FindBy"); // Method
        var entityType = repository.Item2; // EntityType

        // Should work
        LambdaExpression compatibleIsActiveLambda = SomeClass.CreateIsActiveLambda(entityType);
        dynamic someDynamicResult = repository.Item1.FindBy (compatibleIsActiveLambda as dynamic);
        IQueryable whichAtRuntimeShouldActuallyBeAnIQueryable = someDynamicResult; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:48:49.463

`FindBy`期待`Expression<Func<TEntity, bool>>`你给它一个`Func<TEntity, bool>`

您是否尝试过放下这`Func<`件作品而只是做`method.Invoke((x) => x.IsActive)`？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T05:13:44.450

请参阅问题中的解决方案，了解我的情况。此外，如果您不担心写回数据库，那么@EduardDumitru 解决方案将非常有效。

# asp.net-mvc - 如何将 JSON 子元素映射和操作到模型属性（使用 JsonConvert）？

> ID：15821257
> 
> 赞同：0
> 
> 时间：2013-04-04T20:39:30.427
> 
> 标签：asp.net-mvc, json, mapping

我正在尝试从 JSON 填充模型。我正在使用 Newtonsoft.Json.JsonConvert。

```
 HttpWebRequest httpWebRequest = (HttpWebRequest)WebRequest.Create(urlhere);
    httpWebRequest.Credentials = new NetworkCredential("un", "pw");
    httpWebRequest.Method = "Get";
    httpWebRequest.ContentType = "application/json";
    HttpWebResponse response = (HttpWebResponse)httpWebRequest.GetResponse();
    Stream stream = response.GetResponseStream();
    StreamReader streamReader = new StreamReader(stream);
    string incomingItemAsJson = streamReader.ReadToEnd();    // should be the json response as a string

    MyObject myObject= JsonConvert.DeserializeObject<MyObject>(incomingItemAsJson); 
```

我正在努力访问（并遍历）Json 中的子元素。

```
{
"field1": "blah blah",
"field2": "blah blah",
"field3": [(2)
    {
    "field3Item1Id": "xxx",
    "field3Item1Value": "Goo"
    },-
    {
    "field3Item2Id": "xxx",
    "field3Item2Value": "Foo"
    }-
    ],-
"field4": {
    "field4Id": xxx,
    "field4Value": "Moo"
    }-
} 
```

我想将此信息映射到模型，如下所示：

```
public class MyObject 
{
    public string field1 {get;set;}  //blah blah
    public string field2 {get;set;}  //blah blah
    public string field3 {get;set;}  //Goo, Foo
    public string field4 {get;set;}  //Moo
} 
```

Field1 和 field2 被分配给 MyObject 中的字符串属性 - 没有问题。

**我的问题：**

*字段3*

如何将每个项目的值部分连接成一个字符串，例如：“Goo, Foo”？

*字段4*

field4 中只会有一个子元素。

有没有一种简单的方法来仅提取 Value 部分并将其映射到 MyObject 中的字符串属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T07:27:27.400

牛顿的 JSON 只是简单地创建映射，如果在这种情况下您没有类似的结构化对象，则可能无法更改 JSON 的结构，因为它可能来自其他来源，因此您可以更改 Model 类，例如..

```
public class MyObject 
{
    public string field1 {get;set;}  
    public string field2 {get;set;}  
    public Dictionary<string, string> field3 {get;set;}
    public Dictionary<string, string> field4 {get;set;}
} 
```

这应该够了吧...

# jquery - ajax 将内容加载到 div 脚本中不起作用（一个是一个不是）

> ID：15821259
> 
> 赞同：0
> 
> 时间：2013-04-04T20:39:32.700
> 
> 标签：jquery, ajax, scripting, load

之前确实问过，但注意到了一些东西。有一个主页，它`DIV`使用以下代码将外部 PHP 加载到一个中：

```
$(document).ready(function() {
// Stuff to do as soon as the DOM is ready;
$('#content').load('pages/index.php');

// Handle Clicks
$('ul.nav li a').click(function() {
    var page = $(this).attr('href');

    $('#content').hide().load('pages/' + page + '.php').fadeIn('normal');

    //Wont Redirect
    return false;

});
// /

   }); 
```

页面加载正常`DIV`，但 JavaScript 正在播放。顶部的不起作用，底部的起作用。两者都使用

```
 $(function() {
 <script>

    $(function() {

        var target = $('.fademe');
        var targetHeight = target.outerHeight();
        $(document).scroll(function(e){
            var scrollPercent = (targetHeight - window.scrollY) / targetHeight;
            if(scrollPercent >= 0){
                target.css('opacity', scrollPercent);
            }
        });

    });

    </script>

    <script>
    $(function () {
        $.scrollUp();
    });
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:54:00.367

查看您的两个`pastie`文件，您似乎在`fademe`稍后加载的 HTML 中包含了带有类的 HTML 元素，而不是在最初在页面上的 HTML 中。因此，您的第一个函数将不起作用，因为 jQuery 不会找到任何具有`fademe`.

为了使您的功能正常工作，它需要包含在 load 中`callback`。

```
$('#content').load('pages/index.php', function() {

    var target = $('.fademe');
    var targetHeight = target.outerHeight();
    $(document).scroll(function(e){
        var scrollPercent = (targetHeight - window.scrollY) / targetHeight;
        if(scrollPercent >= 0){
            target.css('opacity', scrollPercent);
        }
    });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:22:08.830

似乎您正在将事件处理程序附加到一个不存在的（尚未）DOM 元素，因为您是一个 ajax 内容，所以默认情况下 ajax 是异步的，并且您的 DOM 还没有收到服务器响应。

您可以使用委托来附加事件处理程序，例如：

```
$('body').on('click', 'ul.nav li a', function() {
    var page = this.href;

    $('#content').hide().load('pages/' + page + '.php').fadeIn('normal');

    //Wont Redirect
    return false;
}); 
```

或将事件处理程序附加到 ajax 的成功回调函数上。

希望能帮助到你。

# mysql - mysql_result 到 mysqli 等价物

> ID：15821262
> 
> 赞同：1
> 
> 时间：2013-04-04T20:39:37.490
> 
> 标签：mysql

我正在尝试将一些代码更新为 mysqli，但我被卡住了一部分。

我有一个带有 MySQL_result 的 foreach 循环，我无法弄清楚如何将该部分更新为 mysqli 替代品。

```
<?php
function WA_AuthenticateUser($WA_Auth_Parameter){

    $UserAuthenticated = false;
    mysqli_select_db($WA_Auth_Parameter["connection"], $WA_Auth_Parameter["database"]);
    $WA_Auth_loginSQL = "SELECT `".implode('`,`', $WA_Auth_Parameter["sessionColumns"])."` FROM `".$WA_Auth_Parameter["tableName"]."` WHERE ";

    for($idx=0;$idx<count($WA_Auth_Parameter["columns"]);$idx++){
        $WA_Auth_loginSQL = sprintf($WA_Auth_loginSQL.(($idx!=0)?" AND ":" ")."`%s`=%s ", $WA_Auth_Parameter["columns"][$idx], WA_GetSQLValueString($WA_Auth_Parameter["columnValues"][$idx], $WA_Auth_Parameter["columnTypes"][$idx]));
    }
    $WA_Auth_RS = mysqli_query($WA_Auth_Parameter["connection"], $WA_Auth_loginSQL) or die(mysqli_error($WA_Auth_Parameter["connection"]));
    $WA_Auth_Rows = mysqli_num_rows($WA_Auth_RS);

    if($WA_Auth_Rows){
        $UserAuthenticated = true;

        $idx = 0;
// --------------------------------------------------------------------------------------------
        foreach ($WA_Auth_Parameter["sessionNames"] as $sessionName){
            $_SESSION[$sessionName] = mysql_result($WA_Auth_RS,0,$WA_Auth_Parameter["sessionColumns"][$idx]);
            $idx++;
        }
// --------------------------------------------------------------------------------------------

        if($blah!=""){
            header("Location: ".$blah);
            exit();
        }
    }

    if($blah2!=""){
        header("Location: ".$blah2);
        exit();
    }
}
?> 
```

编辑 -

所以也许如果我在现有函数之上添加这个函数

```
function mysqli_result($res, $row, $field) { 
    $res->data_seek($row); 
    $datarow = $res->fetch_array(); 
    return $datarow[$field]; 
} 
```

然后像这样改变那个foreach循环......

```
foreach ($WA_Auth_Parameter["sessionNames"] as $sessionName){
            $_SESSION[$sessionName] = mysqli_result($WA_Auth_RS,0,$WA_Auth_Parameter["sessionColumns"][$idx]);
            $idx++;
        } 
```

这会正常工作，还是我会出错？

# c# - Xeround 可靠性

> ID：15821266
> 
> 赞同：1
> 
> 时间：2013-04-04T20:39:40.997
> 
> 标签：c#, php, amazon-ec2, database-connection, xeround

我最近扩展了我的应用程序，它使用 C#/.NET 前端和 PHP 脚本作为 Web 爬虫作为后端。我的应用程序的双方都与 Xeround MySQL 数据库交互（我目前正在使用 Xeround Basic，但正在考虑迁移到 Xeround Pro）。我有两个有关不可靠访问数据库的相关问题。

1.  有时我会在我的 C# 代码中运行 use_db 调用来在我设置的两个数据库之间切换。偶尔会发生这个调用但没有执行，后续的 SQL 调用会失败。更频繁地，我会遇到“连接必须有效且打开”的消息，并且必须重新启动应用程序。有时这是因为应用程序闲置了好几个小时，但大多数时候这似乎是由于我过度使用应用程序造成的（这很奇怪，因为我只使用了大约 20-30% 的可用 Xeround 连接）。
2.  更复杂的问题是，如果我一次不运行多个例程（浏览器窗口），我的 PHP 脚本将在接近 100% 的时间返回目标结果，但如果我一次运行多个例程，则会经常失败。这是由于过度使用 Xeround（即调用 use_db 但失败）造成的吗？是否有一些我可以使用的 PHP 设置将每个例程视为使用独立服务器（我没有使用任何全局变量，所以这不是罪魁祸首）。

我想问题 1 更容易冒险回答，但对这些问题的任何反馈将不胜感激！

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T15:15:12.433

[请在http://support.xeround.com/tickets/new](http://support.xeround.com/tickets/new)打开支持票 我们非常乐意为您提供帮助。

# html - 为什么 IE10 的输入验证对于这个必需的 select & optgroup 结构失败

> ID：15821267
> 
> 赞同：10
> 
> 时间：2013-04-04T20:39:41.433
> 
> 标签：html, internet-explorer-10

我不明白为什么 IE10 认为索引 1 和 6 的选项无效？我期望索引 0 处的唯一选项应该失败并阻止表单提交。

```
<select required="required">
    <option value="">Select</option>
    <optgroup label="First">
        <option value="A">1</option>
        <option value="B">2</option>
        <option value="C">3</option>
        <option value="D">4</option>
    </optgroup>
    <optgroup label="Second">
        <option value="1">A</option>
        <option value="2">B</option>
        <option value="3">C</option>
        <option value="4">D</option>
    </optgroup>
</select> 
```

jsfiddle在这里：http: [//jsfiddle.net/J3wFx/](http://jsfiddle.net/J3wFx/)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-05-06T19:04:59.750

我们遇到了同样的问题。

在一天的大部分时间里都在与此作斗争后，我们的一位开发人员（克里斯·麦克唐纳 - 必须在应得的情况下给予信用）通过`value="0"`在选项组标签中添加 a 来找到解决此问题的方法。

这是有问题的原始代码：http: [//jsfiddle.net/PHEej/1/](http://jsfiddle.net/PHEej/1/)

```
<form id="addToCart" class="trackForm" method="post" action="/socks/jmx">

<div id="purchase" price=" $13.99 - $14.99">
<ol>
    <li id="purchase_promotion" class="price" price=" $13.99 - $14.99">
        <label class="retailPrice required" for="purchase_promotion"></label>
        <span itemprop="offers" itemscope itemtype="http://schema.org/Offer">
            <span itemprop="price"> $13.99 - $14.99</span>
        </span>
    </li>
    <li id="purchase_sizes" class="size">
        <label for="purchase_sizes" class="required">Shoe Size</label>
        <select id="purchase_sizes" name="purchase[sizes]" required="required" class="size">
            <option value="">Choose a shoe size</option>
            <optgroup label="men - us">
                <option value="1">5.5 to 8.5 - $13.99</option>
                <option value="2">9 to 12.5 - $13.99</option>
                <option value="3">13 to 15 - $14.99</option>
            </optgroup>
            <optgroup label="women - us">
                <option value="4">6.5 to 10 - $13.99</option>
                <option value="5">10.5 to 13 - $13.99</option>
            </optgroup>
        </select>
    </li>
    <li id="purchase_color"><label for="purchase_color" class="required">Colors</label><select
                id="purchase_color" name="purchase[color]" required="required">
            <option value="">Choose your color</option>
            <option value="93">White/platinum</option>
            <option value="92">White/navy</option>
        </select></li>
    <li id="purchase_quantity"><label for="purchase_quantity" class="required">Quantity</label><select
                id="purchase_quantity" name="purchase[quantity]" required="required">
            <option value="">Choose a quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
        </select></li>
    <input type="hidden" id="purchase_slug" name="purchase[slug]" value="jmx"/>
    <input type="hidden" id="purchase__token" name="purchase[_token]"  value="26dcd00e64754376fadefb38a534df85996ce4d3"/>
</ol>
</div>
<button id="submitButton" type="submit" class="cartButton buttonBlock trackForm"
        data-ga_params="Add to Cart|Add to Cart Submit|">
    <span class="icon-cart-after">Add to cart</span>
</button>
</form> 
```

在此示例中，如果您选择鞋码中的第一项或最后一项，则在提交表单时将无法识别该选择。

这是允许我们跳过它的“固定”代码：http: [//jsfiddle.net/PHEej/3/](http://jsfiddle.net/PHEej/3/)

```
<form id="addToCart" class="trackForm" method="post" action="/socks/jmx">

<div id="purchase" price=" $13.99 - $14.99">
<ol>
    <li id="purchase_promotion" class="price" price=" $13.99 - $14.99">
        <label class="retailPrice required" for="purchase_promotion"></label>
        <span itemprop="offers" itemscope itemtype="http://schema.org/Offer">
            <span itemprop="price"> $13.99 - $14.99</span>
        </span>
    </li>
    <li id="purchase_sizes" class="size">
        <label for="purchase_sizes" class="required">Shoe Size</label>
        <select id="purchase_sizes" name="purchase[sizes]" required="required" class="size">
            <option value="">Choose a shoe size</option>
            <optgroup value="0" label="men - us">
                <option value="1">5.5 to 8.5 - $13.99</option>
                <option value="2">9 to 12.5 - $13.99</option>
                <option value="3">13 to 15 - $14.99</option>
            </optgroup>
            <optgroup  value="0" label="women - us">
                <option value="4">6.5 to 10 - $13.99</option>
                <option value="5">10.5 to 13 - $13.99</option>
            </optgroup>
        </select>
    </li>
    <li id="purchase_color"><label for="purchase_color" class="required">Colors</label><select
                id="purchase_color" name="purchase[color]" required="required">
            <option value="">Choose your color</option>
            <option value="93">White/platinum</option>
            <option value="92">White/navy</option>
        </select></li>
    <li id="purchase_quantity"><label for="purchase_quantity" class="required">Quantity</label><select
                id="purchase_quantity" name="purchase[quantity]" required="required">
            <option value="">Choose a quantity</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
            <option value="8">8</option>
            <option value="9">9</option>
            <option value="10">10</option>
            <option value="11">11</option>
            <option value="12">12</option>
            <option value="13">13</option>
            <option value="14">14</option>
            <option value="15">15</option>
        </select></li>
    <input type="hidden" id="purchase_slug" name="purchase[slug]" value="jmx"/>
    <input type="hidden" id="purchase__token" name="purchase[_token]"  value="26dcd00e64754376fadefb38a534df85996ce4d3"/>
</ol>
</div>
<button id="submitButton" type="submit" class="cartButton buttonBlock trackForm"
        data-ga_params="Add to Cart|Add to Cart Submit|">
    <span class="icon-cart-after">Add to cart</span>
</button>
</form> 
```

这似乎是一个可行的解决方案，因为无论如何选项组都是不可选择的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-08T21:50:57.410

这个问题（幸运的是？）比你想象的更容易预测。初步测试表明，当所选选项的索引与兄弟元素中`optgroup`其父级的索引匹配时，会发现表单无效。`optgroup`

本质上，组 0 中的项目 0 是无效的。第 1 组中的第 1 项也无效。而且，幸运的是，第 4 组中的第 4 项也是无效的（见模式？）。这肯定看起来像是某种错误。当`select`具有`multiple`布尔属性时，情况并非如此。

你可以在这里看到我对你的表格的修改：http: [//jsfiddle.net/jonathansampson/c86eY/](http://jsfiddle.net/jonathansampson/c86eY/)

# jquery - 使用 jquery 创建一个逗号分隔的单击元素列表

> ID：15821268
> 
> 赞同：4
> 
> 时间：2013-04-04T20:39:43.397
> 
> 标签：jquery, csv

我正在尝试将逗号分隔的列表注入到 DOM 中，用户可以将其复制并粘贴到另一个应用程序中。现在我完全被困在如何处理前面没有逗号的第一个元素上。

现在，用户单击一个元素，jquery 获取该元素的 ID 以构建列表。用户应该能够打开和关闭他们的选择。我还需要按照用户选择项目的顺序生成列表。

HTML

```
Comma separated list here: <span id="list"></span>
<br />
<a id="1" class="clickme" href="#"><li>One</li></a>
<a id="2" class="clickme" href="#"><li>Two</li></a>
<a id="3" class="clickme" href="#"><li>Three</li></a>
<a id="4" class="clickme" href="#"><li>Four</li></a>
<a id="5" class="clickme" href="#"><li>Five</li></a>
<a id="6" class="clickme" href="#"><li>Six</li></a> 
```

CSS

```
.selected {
    background-color: #99CCFF;    
} 
```

JS - 加载 jquery

```
$('.clickme').click(function (e) {
        e.preventDefault();
        var book_id = $(this).attr('id'); 
        $(this).children('li').toggleClass("selected");
        var list_container = $("#list");
        if ($(this).children('li').is(".selected")) {
            if (list_container.text().length > 0) {
                list_container.append("," + book_id);
            } else {
                list_container.append(book_id);
            }
        } else {
            list_container.text(list_container.text().replace("," + book_id, ""));          
        }
}); 
```

这非常适合构建逗号分隔的列表，并且非常适合关闭列表中除第一个值之外的所有值。问题是插入的第一个值没有前面的逗号，因此替换函数无法匹配它。如果我从替换函数中删除逗号，那么我会留下一堆不需要的逗号。如果我两者都匹配，那么我冒着匹配 ID 的一部分的风险......即在 3 关闭时替换 13 中的 3。

我尝试了很多变化，但找不到任何有效的方法。

产生预期结果的唯一解决方案是使用 CSS 注入逗号并用 span 元素包装注入的 ID。

CSS 技巧

```
#list span { display: inline; }
#list span:after { content: ","; }
#list span:last-child:after { content: ""; } 
```

工作得很好......除了这个的实际目的。我需要用户能够复制和粘贴生成的字符串。当您使用 CSS 生成内容时，大多数浏览器中的 DOM 级剪贴板都看不到它。IE 复制了您在浏览器中看到的字符串，FF 和 Safari 都复制了没有附加 CSS 逗号的字符串。

[小提琴在这里](http://jsfiddle.net/rYu6m/1/)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T20:46:17.120

看来您已经使这个问题复杂化了。只需简单地制作一组选定的书籍 ID，然后将`.join(',')`它们显示为逗号分隔的列表。

```
$('.clickme').click(function (e) {
    e.preventDefault();
    $(this).children('li').toggleClass("selected");

    var list_container = $("#list");
    var book_ids = $('.clickme:has(li.selected)').map(function(){
        return this.id;
    }).get();

    list_container.text(book_ids.join(','));
}); 
```

演示：http: [//jsfiddle.net/rYu6m/2/](http://jsfiddle.net/rYu6m/2/)

编辑：你说你想保持元素被点击的顺序。在这种情况下，您需要在单击处理程序之外声明该数组，然后`.push`将元素添加到它或`.splice`将其取出。使用数组比使用字符串要容易得多。

```
var book_ids = [];
$('.clickme').click(function (e) {
    e.preventDefault();
    $(this).children('li').toggleClass("selected");

    var list_container = $("#list");

    var index = $.inArray(this.id, book_ids);
    if(index === -1){
        // Not in array, add it
        book_ids.push(this.id);
    }
    else{
        // In the array, remove it
        book_ids.splice(index, 1);
    }

    list_container.text(book_ids.join(','));
}); 
```

演示：http: [//jsfiddle.net/rYu6m/4/](http://jsfiddle.net/rYu6m/4/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:51:00.830

Rocket Hazmat 的解决方案非常相似，可能更好，但我还是会发布我的：

```
$('.clickme').click(function (e) {
    e.preventDefault();
    $(this).toggleClass('selected');
    var l = [];
    $('.selected').each(function(){
        l.push($(this).attr('id'));
    });
    $('#list').text(l.join(','));
}); 
```

[http://jsfiddle.net/rYu6m/3/](http://jsfiddle.net/rYu6m/3/)

# android - 在android中的谷歌地图上显示当前位置和其他位置

> ID：15821269
> 
> 赞同：0
> 
> 时间：2013-04-04T20:39:46.330
> 
> 标签：android, google-maps, android-intent, google-maps-api-3, gps

我的代码分开但在我集成时崩溃！

如果我硬编码当前的值，这部分工作

```
Intent is = new Intent(android.content.Intent.ACTION_VIEW,Uri.parse("http://maps.googleapis.com/maps/api/staticmapcenter="+current+"&zoom=11&size=600000x400000&maptype=roadmap&markers=color:blue%7Clabel:A%7C49.264081,-123.170326&markers=color:green%7Clabel:B%7C49.227741,-122.997605&markers=color:yellow%7Clabel:C%7C49.322642,-123.099007&markers=color:purple%7Clabel:E%7C49.267501,-123.000693&markers=color:red%7Ccolor:red%7Clabel:D%7C49.193767,-123.083017&sensor=false"));
startActivity(is); 
```

这部分工作并给出当前位置

```
 googlemap.setMyLocationEnabled(true);
             LocationManager lm = (LocationManager) getSystemService(LOCATION_SERVICE);
             String provider = lm.getBestProvider(new Criteria(), true);
             Log.v(provider, "this is provider");
             if (provider == null){
                 onProviderDisabled(provider);
             }
             Location loc = lm.getLastKnownLocation(provider);
             Log.v(loc.toString(),"this is loc");
             if(loc != null) {
                 onLocationChanged(loc); 
```

但是这个是集成的，崩溃了

```
 googlemap.setMyLocationEnabled(true);
     LocationManager lm = (LocationManager) getSystemService(LOCATION_SERVICE);
     String provider = lm.getBestProvider(new Criteria(), true);
     Log.v(provider, "this is provider");
     if (provider == null){
         onProviderDisabled(provider);
     }
     Location loc = lm.getLastKnownLocation(provider);
     Log.v(loc.toString(),"this is loc");
     if(loc != null) {
         onLocationChanged(loc);
         String current= loc.toString();
                Intent is = new Intent(android.content.Intent.ACTION_VIEW, Uri.parse("http://maps.googleapis.com/maps/api/staticmap?center="+current+"&zoom=11&size=600000x400000&maptype=roadmap&markers=color:blue%7Clabel:A%7C49.264081,-123.170326&markers=color:green%7Clabel:B%7C49.227741,-122.997605&markers=color:yellow%7Clabel:C%7C49.322642,-123.099007&markers=color:purple%7Clabel:E%7C49.267501,-123.000693&markers=color:red%7Ccolor:red%7Clabel:D%7C49.193767,-123.083017&sensor=false"));
                startActivity(is); 
```

LOGCAT: 04-04 20:58:34.765: W/dalvikvm(1082): threadid=11: 线程以未捕获的异常退出 (group=0x40a71930) 04-04 20:58:34.805: E/AndroidRuntime(1082): FATAL EXCEPTION : AsyncTask #1 04-04 20:58:34.805: E/AndroidRuntime(1082): java.lang.RuntimeException: 执行 doInBackground() 04-04 20:58:34.805 时出错: E/AndroidRuntime(1082):在 android.os.AsyncTask$3.done(AsyncTask.java:299) 04-04 20:58:34.805: E/AndroidRuntime(1082): 在 java.util.concurrent.FutureTask.finishCompletion(FutureTask.java:352) 04 -04 20:58:34.805: E/AndroidRuntime(1082): 在 java.util.concurrent.FutureTask.setException(FutureTask.java:219) 04-04 20:58:34.805: E/AndroidRuntime(1082): 在 java .util.concurrent.FutureTask.run(FutureTask.java:239) 04-04 20:58:34.805: E/AndroidRuntime(1082): 在 android.os.AsyncTask$SerialExecutor$1。运行（AsyncTask.java:230）04-04 20:58:34.805：E/AndroidRuntime（1082）：在 java.util.concurrent.ThreadPoolExecutor.runWorker（ThreadPoolExecutor.java:1080）04-04 20:58:34.805： E/AndroidRuntime(1082): 在 java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573) 04-04 20:58:34.805: E/AndroidRuntime(1082): 在 java.lang.Thread.run (Thread.java:856) 04-04 20:58:34.805: E/AndroidRuntime(1082): 由: java.lang.NullPointerException 04-04 20:58:34.805: E/AndroidRuntime(1082): at com. example.distancemap.MainActivity.ShowMap(MainActivity.java:94) 04-04 20:58:34.805: E/AndroidRuntime(1082): at com.example.distancemap.MainActivity$TestGoogleMaps.doInBackground(MainActivity.java:67) 04 -04 20:58:34.805: E/AndroidRuntime(1082): 在 com.example.distancemap.MainActivity$TestGoogleMaps.doInBackground(MainActivity.java:1) 04-04 20:58:34.805: E/AndroidRuntime(1082): 在 android.os.AsyncTask$2.call(AsyncTask.java:287) 04-04 20:58:34.805: E/AndroidRuntime(1082):在 java.util.concurrent.FutureTask.run(FutureTask.java:234) 04-04 20:58:34.805: E/AndroidRuntime(1082): ... 4 更多

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:13:24.150

问题很清楚。您的代码中有 NPE：

```
E/AndroidRuntime(1082): Caused by: java.lang.NullPointerException 04-04 
20:58:34.805: E/AndroidRuntime(1082): at 
com.example.distancemap.MainActivity.ShowMap(MainActivity.java:94) 
```

猜猜这是你的第 94 行：

```
Log.v(loc.toString(),"this is loc"); 
```

# python - 如何合并文件夹中的所有xml文件？

> ID：15821273
> 
> 赞同：1
> 
> 时间：2013-04-04T20:39:55.283
> 
> 标签：python, xml, merge

例如，我有一个文件夹，其中包含多个具有相同数据结构的 xml 文件。我想通过以下方式将它们组合到一个 xml 文件中：

xml 1：

```
<root>
  <child>
    <child1 state="1">
    <Name>name1</Name>
    <Count>1</Count>
    <Title>title1</Title>
    </child1>
  </child>
</root> 
```

xml2：

```
<root>
  <child>
    <child1 state="2">
    <Name>name2</Name>
    <Count>2</Count>
    <Title>title2</Title>
    </child1>
  </child>
</root> 
```

预期结果：

```
<root>
  <child>
    <child1 state="1">
    <Name>name1</Name>
    <Count>1</Count>
    <Title>title1</Title>
    </child1>
    <child1 state="2">
    <Name>name2</Name>
    <Count>2</Count>
    <Title>title2</Title>
    </child1>
  </child>
</root> 
```

我想使用 Python。[我从命令行](https://stackoverflow.com/questions/9004135/merge-multiple-xml-files-from-command-line)阅读了这个Merge multiple XML files ，但它给出的并不完全是我想要的:(

谁能帮我解决这个问题？

# html - 如何使 html 页面显示来自另一个 url 的内容

> ID：15821278
> 
> 赞同：16
> 
> 时间：2013-04-04T20:40:29.020
> 
> 标签：html, hyperlink

我想制作一个类似于 google 缓存的 html 页面。

比如说在我的主页HOME，我有一个链接A到一个网站B，当我点击A时，出来的页面会显示另一个页面的内容，顶部有一个浮动条，有一些我自己选择的功能.

例如，我希望我的链接显示 google.com，但我还想向该 google.com 添加一个按钮（浮动条，任何东西），以便在按下时返回我自己的网页。

有人可以为我提供一些有用的资源，或者更好的解决方案模板吗？:)

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T20:41:50.147

您可以使用 an`<iframe>`来在您的网页中显示外部网页。只需将要显示的网页的网址放在`src`属性的引号内即可。

```
<iframe src="http://www.webpage.com" width="400" height="400"></iframe> 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-04T20:43:56.170

iframe 听起来可能是您需要的，但在阅读了您的描述后，我不确定 100%。iframe 将在您的页面中显示来自另一个 URL 的内容。一旦你有了这些，你需要做的就是设置页面样式并使用 CSS/JavaScript 来添加描述的功能。

看看这个： [http ://www.w3schools.com/tags/tag_iframe.asp](http://www.w3schools.com/tags/tag_iframe.asp)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T20:44:04.390

这是一般的想法：

HTML：

```
<a href="#" id="link">Click Here</a>
<iframe id="frame" src="http://www.w3schools.com" scrolling="yes"></iframe> 
```

一些 jQuery（未测试）：

```
$(document).ready(function() {
    $('#frame').hide();

    $('#link').click(function () {
        $('#frame').show();
    })
}) 
```

根据需要设置样式

**注意**- 这个答案绝不支持 w3schools.com :-)。请参阅[w3fools.com/](http://w3fools.com/)

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-04T20:45:36.943

要么使用 iframe，要么通过 AJAX 将站点加载到 div 中（例如使用 jQuerys`load()`方法）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-01-24T19:47:37.873

我发现 Kevin Gourney 的回答是最直接和最有帮助的。我正在使用它来解决 Adob​​e Spark 的域限制，并创建了一个简单的单行 index.html 文件并调整代码如下：

```
<iframe src="PasteAdobeSparkPageLinkHere" width=100% height=100%></iframe> 
```

# android - 列表 日志 = 新的 ArrayList ();

> ID：15821287
> 
> 赞同：1
> 
> 时间：2013-04-04T20:40:52.220
> 
> 标签：android, listview, arraylist

我一直在尝试使用`ArrayList.add`，当`.add("some data")`我尝试分配 id 时，它工作正常 -`.add(1, "some data");`当我尝试运行应用程序时，我一直收到错误 - “应用程序 MobileApp（进程 com.example.mobileapp）已意外停止。 请再试一次。”。

这是我正在运行的下一个代码：

```
 List<String> log = new ArrayList<String>();
    log.add(1, "some data"); 
```

这工作正常：

```
 List<String> log = new ArrayList<String>();
    log.add("some data"); 
```

我想由此实现的目标：

1.  `ListView`将有项目列表，每个项目都有特定的“id”。
2.  单击此“id”将被拾取，并且用户将移动到不同的布局，其中在具有选定“id”的项目上显示更多信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:46:32.773

您正在尝试在索引 1 处添加一个不存在的项目。您需要先更改代码以插入 0 位置。

```
List<String> log = new ArrayList<String>();
log.add(0, "some data"); 
```

如果您需要与索引不对应的特定 ID，您可能需要考虑使用[Map](http://docs.oracle.com/javase/6/docs/api/java/util/Map.html)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T20:45:43.603

试试这个

```
List<String> log = new ArrayList<String>();
log.add(0, "some data");//Changed from 1 to 0 
```

我认为您需要从 0 开始。如果我们在第 0 位没有数据，则无法插入 1。

# python - 在 django 中添加模板目录

> ID：15821290
> 
> 赞同：0
> 
> 时间：2013-04-04T20:40:57.260
> 
> 标签：python, django

我只是想了解一些关于在 django 中添加模板文件夹的信息。这是包含我的模板文件夹的代码，django 方便地为我制作：

```
TEMPLATE_DIRS = (
    # This includes the templates folder
    os.path.join(os.path.dirname(__file__), '..', 'templates').replace('\\','/'),
) 
```

我不明白的是 的部分`'templates'`，为什么不是`'/templates'`，甚至`\\templates`在基于 Unix 的情况下？看完这篇[文章](http://www.djangobook.com/en/2.0/chapter04.html)，特别是关于*模板加载*的部分，我来到这里。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:42:38.697

`os.path.join`正在根据正在使用的操作系统构建绝对路径。

在这里，Django 通过获取路径来计算模板目录。在这里，windows 将包含 a `\\`，因此`.replace`

[你可以在这里](http://docs.python.org/2/library/os.path.html#os.path.join)阅读更多关于它的信息

# java - 有人说“结果不是线程安全的”是什么意思

> ID：15821293
> 
> 赞同：3
> 
> 时间：2013-04-04T20:40:58.627
> 
> 标签：java, multithreading, hbase

当我阅读此文档时，我正在为 Java HBase API 编写一个特定于应用程序的包装器：

[http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Result.html](http://hbase.apache.org/apidocs/org/apache/hadoop/hbase/client/Result.html)

它说`This class is **NOT THREAD SAFE**.`

不是线程安全的到底是什么意思。我基本上是一个 C++ 程序员，如果有人说这个函数`strtok()`不是线程安全的，我不会在多线程环境中使用它。它类似于`strtok()`使用静态变量并由两个不同的线程调用此函数不是一个好主意。

JAVA也一样吗？

我有一个功能：

```
public String get(String key, String family) {
    Get get = new Get(key.getBytes());
    get.addFamily(family.getBytes());

    Result result = null;
    try {
        result = _table.get(get);
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
    return "";
} 
```

函数 get 可能被多个线程调用。它是否使 Result 以某种方式使用不安全？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:43:28.147

> 不是线程安全的到底是什么意思。

这意味着如果给定的类对象是通过各种访问的，`Threads`那么在其中调用它的方法`Threads`可能会导致不可预测的结果，因为各种`Threads`. 这种不可预知的结果的根本原因是`data`各种`object`之间的共享`threads`。您可以在此处查看[Wikipedia 文章](http://en.wikipedia.org/wiki/Thread_safety)以了解有关线程安全的更多信息。

浏览完您的代码后，我看到您`_table`在 line中使用了一个成员变量`result = _table.get(get);`。所以，很可能不是`Thread-safe`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-04T20:49:35.757

如果一个类是“非线程安全的”，则它的方法不能被多个线程调用（在同一个实例上）而无需额外的同步。例如，您不能同时在一个线程中迭代 ArrayList，并在另一个线程中修改其内容。

在您的情况下，这应该不是问题，因为在每次调用函数时都会创建 Result 的新实例，因此这些线程对不同的 Result 对象进行操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T09:40:25.420

当您阅读 Result 不是线程安全的时，这意味着如果您遇到多个线程可以访问此结果对象的情况，您需要确保使用是同步的（有关同步访问的方法列表，请参见[此处）。](http://docs.oracle.com/javase/tutorial/essential/concurrency/sync.html)

如果您的代码保持原样，即每次调用 get 都会生成自己的新 Result 实例，那么您就可以了。如果您在对象中的调用之间保留此 Result 实例，并且它将在多个调用中使用，则您需要保护对该 Result 对象的访问

# java - Java - 将控制台游戏转换为小程序

> ID：15821296
> 
> 赞同：-1
> 
> 时间：2013-04-04T20:41:04.370
> 
> 标签：java, applet, console, converter

我最近用相当多的代码制作了一个 Java 控制台游戏，有没有办法将其转换为小程序**或**在互联网上播放而无需下载应用程序？

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:25:37.050

> ..有没有办法将其转换为小程序..

将基于控制台的游戏转换为基于富客户端（或 Web 应用程序）的游戏的任务取决于游戏概念和结构与 UI（在本例中为控制台）分离的清晰程度。

如果游戏可以包含在文本控制台和 2 或 3 个其他控件中，请查看[消息控制台](http://tips4java.wordpress.com/2008/11/08/message-console/)的输出。

![在此处输入图像描述](https://i.stack.imgur.com/NAByQ.jpg)

（屏幕截图来自 Rob Camick 的“Java Tips Weblog”中的链接文章。）

顺便说一句 - 即使从 Internet 部署，最好将其包装在 a 中`JFrame`并使用[Java Web Start](https://stackoverflow.com/tags/java-web-start/info)进行部署。

> ..或无需下载应用程序即可在互联网上播放？

将其转换为 JSP/Servlet（使其成为 Web 应用程序。）。

请注意，基于控制台的应用程序、小程序、应用程序。与 JWS 一起启动 - 都需要“下载”该应用程序。（到用户的本地磁盘），但最后两个对用户来说基本上是不可见的，这通常是开发人员说“不下载”时的意思。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:46:22.483

一种简单的方法是调整[JTextArea](http://docs.oracle.com/javase/6/docs/api/javax/swing/JTextArea.html)以像控制台 UI 一样工作。作为一个 Swing 组件，很容易将其包装在 Java Applet 中。这些可能会给你一些想法：

*   [jTextArea 作为 IO 控制台](https://stackoverflow.com/questions/15017148/jtextarea-as-io-console)
*   [使用 JTextArea 模拟文本控制台](https://stackoverflow.com/questions/3886513/using-jtextarea-to-simulate-a-text-console)
*   [在 JTextArea 而不是控制台上显示数据](https://stackoverflow.com/questions/9680318/show-data-on-a-jtextarea-instead-of-console)

# jquery - 如何使用 jQuery 和 Modernizr 根据屏幕大小添加/删除菜单项？

> ID：15821303
> 
> 赞同：0
> 
> 时间：2013-04-04T20:41:45.467
> 
> 标签：jquery, responsive-design, media-queries, modernizr

我在这里阅读了很多关于 Modernizr 的问题，这些问题涉及 Modernizr、jquery 和调整大小的超时。我和他们中的许多人一起玩过，他们倾向于做到这一点，所以当你调整大小时，菜单项会反复添加，一遍又一遍，直到你淹没在新的导航项目中。

如果屏幕尺寸发生变化，我只想添加然后从主导航中删除链接。当大小低于 768px 时添加它，然后当它是 768 及以上时将其删除。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:56:31.833

为什么不尝试 CSS 媒体查询而不是 jQuery

确保将元标记放在头部

```
<meta name="viewport" content="width=device-width, initial-scale=1.0">

@media (min-width : 769px) {
  .main-nav .myLink {display:none;}
}

@media (max-width : 768px) {
  .main-nav .myLink {display:block;}
} 
```

# python - 如何远程运行 python 脚本但在本地使用结果列表？

> ID：15821305
> 
> 赞同：0
> 
> 时间：2013-04-04T20:41:52.683
> 
> 标签：python, ssh

我有 3 个或更多节点，并且我想使用基于 RSSI 之间的每个节点之间距离的估计来执行定位。

为此，我尝试在它接收的 RSSI 的每个节点上创建一个列表，然后在所有节点之间共享这些列表。我有一个 python 脚本，它将所有 RSSI 以及接收和发送节点捕获到列表的子列表中。

代码如下：

```
import subprocess

def matching_line(lines, keyword):
    """Returns the first matching line in a list of lines. See match()"""
    for line in lines:
        matching=match(line,keyword)
        if matching!=None:
            return matching
    return None

def match(line,keyword):
    """If the first part of line (modulo blanks) matches keyword,
    returns the end of that line. Otherwise returns None"""
    line=line.lstrip()
    length=len(keyword)
    if line[:length] == keyword:
        return line[length:]
    else:
        return None

neighbour = [] #list of local node and neighbour's addresses
scanned = {}    # dictionary containing iwlist scan results Address: RSSI
single_localisation = [[],[],[]] #list of iwlist scan results at a single node. Node's address, transmitting node's address, RSSI 
all_localisation = [[],[],[]] #list of iwlist scan results from all nodes. Receiving node's address, transmitting node's address, RSSI 

#Save batctl o to file - batctl o shows all the nodes nearby participating in the mesh
Proc=subprocess.Popen("batctl o > bato.txt", shell=true)
Proc.wait()

#Populate neighbour list with addresses of neighbouring nodes
with open("bat.txt") as fd:
    fd.readline() #skip column headings
    for line in fd:
        neighbour.append(line.split()[0])

#Add local node's Address to neighbour list for later comparison
neigbour.append( subprocess.check_output("ip link show wlan0 | grep link | awk '{print $2}'",shell=True).strip())

#Scan wlan2 and save to file
Proc=subprocess.Popen("iwlist wlan2 scan | awk '/ESSID/ {print $1} /level/ {print $3}' > rssi.txt", shell=true)
Proc.wait()

#Populate scanned list with all MAC addresses and RSSIs from file
cells=cells[1:]

with open("rssi.txt") as fd:
    for line in fd:
        cell_line = match(line,"Cell ")
        if cell_line != None:
            cells.append([])
            line = cell_line[-27:]
        cells[-1].append(line.rstrip())

for cell in cells:
    level.append(matching_line(cell,"Quality=").split()[2].split('=')[1])
    address.append(matching_line(cell,"Address: "))

scanned=dict(zip(address, level))

#Test if MAC address in scanned list matches MAC address in neighbour list (and is therefore a meshed node)
for s in scanned:
    if s in neighbour:
    #if it does make an entry in localisation for it
        localisation[0].append( subprocess.check_output("ip link show wlan0 | grep link | awk '{print $2}'",shell=True).strip())
        localisation[1].append(s)
        localisation[2].append(scanned[s]) 
```

所以

*   localisation[0] 包含本地节点的 MAC
*   localisation[1] 包含发送节点的 MAC
*   localisation[2] 包含 [0] 从 [1] 接收到的信号强度

我想以某种方式合并所有节点上的所有本地化列表，以创建一个每个节点都有的大列表。

有没有一种方法可以使用 paramiko（或替代方法）通过 SSH 共享生成的列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:03:33.483

> 有没有一种方法可以使用 paramiko（或替代方法）通过 SSH 共享生成的列表？

是的，您可以使用`paramiko`它。[源代码分发版中的API 文档](http://www.lag.net/paramiko/docs/)[`demo_sftp.py`](https://github.com/paramiko/paramiko/blob/master/demos/demo_sftp.py)应向您展示如何操作。在各个主机上正确设置您的主机密钥和授权密钥，然后每个远程主机只需要创建一个并调用它。`SFTPClient``put`

这是否是*最好*的设计完全取决于您的网络是如何设置的以及您的逻辑是什么样的。如果可行，最简单的解决方案是将数据存储在所有主机都可以访问的网络文件系统（NFS、SMB 等）上。或者，也许您想设置一个套接字服务器或 0MQ 或其他任何东西，以便每个主机可以直接上传其数据，而不是首先将其存储在文件中（这也意味着可以在接收到数据时直接触发目标，而不必设置文件系统监视或其他东西）。或者……真的，有很多选择。

您还应该考虑您是在尝试构建客户端服务器系统（每个人都上传到一个“主”，然后将更新发送到所有“从”主机）还是 p2p 系统（每个人都上传给其他人） . 对于后者，您最好使用简单的 DHT 设计，而不是试图让每个人都保持同步。

# javascript - jQuery .change() 没有触发？

> ID：15821310
> 
> 赞同：-5
> 
> 时间：2013-04-04T20:42:12.057
> 
> 标签：javascript, jquery

我有一个 jQuery .change() 事件，用于识别何时选择/更改了单选按钮。

这是单选按钮代码：

```
<input type="radio" name="joint" value="0" class="who" data-entity="me"/>
<input type="radio" name="joint" value="1" class="who" data-entity="me and partner"/> 
```

我检测变化的javascript是这样的：

```
$('input[name=joint]').bind('change', function(){
    alert('changed');
    $('.jointWho').html('Cover for '+$('option:selected',this).data('entity'));
}); 
```

但是，当我选择/更改单选按钮时，甚至不会触发，并且我没有看到警报。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:00:52.870

它应该在 onLoad 事件中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:49:03.830

您的问题可能是您缺少 document.ready 调用。如果您尝试在加载 HTML 之前绑定内容，它们似乎会通过，但实际上并没有完成绑定（因为如果未加载 HTML，则不存在任何元素）。所以试试这个，像这样包装你的绑定。

```
$(document).ready(function () {
  // Your code
}) 
```

这将确保 HTML 完全加载并且您的绑定在正确的时间得到应用。

# php - 进行多个排序 MySQL 查询的最有效方法

> ID：15821313
> 
> 赞同：0
> 
> 时间：2013-04-04T20:42:30.357
> 
> 标签：php, mysql

我有一个从 MySQL 表中提取的主题公园列表。默认查询是

```
try
{
$sql = 'SELECT park_id, name, town, state, country
FROM tpf_parks ORDER BY name ASC';
$result = $pdo->query($sql);
}
catch (PDOException $e)
{
$error = 'Error fetching parks: ' . $e->getMessage();
//include 'error.html.php';//
exit();
} 
```

并按名称 ASC 排序。我想要上面的链接，这些链接将按州和国家（并最终评级）对列表进行排序。我还想要只显示主题公园、水上乐园、“其他”和“全部显示”的链接。

我的看法是，我需要为每个查询创建一个新的 php 页面，但这意味着 16 个不同的 PHP 页面，每个查询一个。有没有办法将所有内容保留在一个页面中，以便 16 个查询都在一个页面中运行，单击链接只会加载新排序的列表来替换旧列表？

最重要的是，我还想要一个 AZ 的链接，单击一个可以将页面向下跳转到排序方法的字母，例如主题公园列表按状态排序，单击“K”将向下跳转到页面中的公园堪萨斯。我正在考虑使用 html 锚点的这些链接，但是我将如何将结果回显到 26 个卡盘（每个字母 AZ 一个）。

对不起，冗长的问题，但我很难过。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:56:45.113

```
 //make a function  

function orderby($select, $var){
$sth = $dbh->prepare('SELECT {$select} FROM tpf_parks ORDER BY {$var}');
$sth->execute();
$result = $sth->fetchAll();
echo $result;
}
// run a function    
orderby ("park_id, name, town, state, country","name ASC");
//make all the functions you need like this 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:45:56.460

也许最好使用排序功能仅通过某些脚本进行输出。（[http://tablesorter.com/](http://tablesorter.com/)等）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:02:57.057

试试这个功能：

```
 function getQueryOrder($field,$order){
      $query="";
      switch ($field){
         case "park_id":
             $query="SELECT park_id, name, town, state, country FROM tpf_parks ORDER BY park_id ".$order;
             break;
         }
         case "name":
             $query="SELECT park_id, name, town, state, country FROM tpf_parks ORDER BY name ".$order;
             break;
         }
         case [Other-field]:
             ..... 
             break;
         }
      }
      return $query;
   } 
```

然后使用它：

```
try{
   $sql = getQueryOrder('park_id','ASC');// select the field park_id and order ASC
   $result = $pdo->query($sql);
} 
```

# java - JSON验证休息服务

> ID：15821317
> 
> 赞同：0
> 
> 时间：2013-04-04T20:42:41.577
> 
> 标签：java, rest, jakarta-ee, jersey, jackson

**环境：Java，Jersey with Jackson，Tomcat。**

我有一个从客户端获取 JSON 输入的休息服务。我想验证输入，如果它是 JSON，然后是 JSON，那么 JSON 输入中的键是否符合预期。如果是，那么它应该产生 HTTP 400-Bad 请求。

例如-

```
// 休息服务
    @邮政
    @Path("登录")
    @Consumes(MediaType.APPLICATION_JSON)
    @Produces(MediaType.APPLICATION_JSON)
    公共响应登录（凭据登录，
            @Context HttpServletRequest httpRequest) {

        如果（登录 == 空）
            // 返回 sendBadRequest(HTTP 400);

        String userName = (String) login.getUsername();
        String passWord = (String) login.getPassword();

        如果（用户名 == 空）
            // 返回 sendBadRequest(HTTP 400);
        else if (passWord == null)
            // 返回 sendBadRequest(HTTP 400);

    ......
}

// 凭据.java
@JsonIgnoreProperties(ignoreUnknown=true)
公共类凭证{

    私人字符串用户名；

    私人字符串密码；

// getter 和 setter...
}

```

例如 - 非 json 输入，如

```
{“键”：“值”
```

应该产生 HTTP 400。以及带有不正确值的输入，例如

```
{“用户名”：“abc”，“密码”：“abc”}
```

应该产生 HTTP 400。

我的代码适用于提到的案例 2，但我希望它也适用于案例 1。当存在非 json 输入时，我希望它将 Credential 对象设置为 null，然后我可以将“if”中的 null 对象返回 HTTP 400。但事实并非如此。休息框架是否为这种情况提供了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-08T21:21:19.887

经过长时间的研究，我设法找到了答案。我们必须在 rest 框架中使用 @Provider 来处理这个错误。

这是一个例子：

```
@Provider
公共类 JsonParseExceptionHandler 实现
        异常映射器 {

    公共响应到响应（JsonParseException 异常）{
        ResponseStatus 状态 = 新的 ResponseStatus();
        客户端响应客户端响应 = 新客户端响应（）；

        status.setCode(Status.BAD_REQUEST.getStatusCode());
        status.setMessage(Status.BAD_REQUEST.name());
        status.setFieldName("JSON 解析异常");
        status.setFieldDescription(exception.getMessage());

        clientResponse.setStatus(status);

        返回响应
                .status(Response.Status.INTERNAL_SERVER_ERROR.getStatusCode())
                .entity(clientResponse).build();
    }

}

```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-04T21:50:02.537

您可以使用 gson 将您的 JSON 转换为 java 对象，然后您可以验证

[https://code.google.com/p/google-gson/](https://code.google.com/p/google-gson/)

或者你可以使用 Json Lib

[http://json-lib.sourceforge.net/index.html](http://json-lib.sourceforge.net/index.html)

以下方法会有所帮助

[http://json-lib.sourceforge.net/apidocs/jdk15/net/sf/json/util/JSONUtils.html#mayBeJSON(java.lang.String)](http://json-lib.sourceforge.net/apidocs/jdk15/net/sf/json/util/JSONUtils.html#mayBeJSON(java.lang.String))

# xslt - 如何使用 xpath 从多组计算值中获取最大值或最小值

> ID：15821319
> 
> 赞同：1
> 
> 时间：2013-04-04T20:42:51.097
> 
> 标签：xslt, xpath, xslt-2.0, xpath-2.0

我需要三种三种值的最大值。我有一个类似的结构。

注意：前两个答案基于前面的示例 xml（在晚上的第 2 组中，最大值高于平均值为 8）。这很令人困惑，所以我将其更改为 7。

```
<data>
    <record>
        <max>60</max>
    </record>
    <day>
        <set>
            <average>49</average>
            <max-above-average>3</max-above-average>
        </set>
        <set>
            <average>45</average>
            <max-above-average>9</max-above-average>
        </set>
    </day>
    <night>
        <set>
            <average>50</average>
            <max-above-average>5</max-above-average>
        </set>
        <set>
            <average>52</average>
            <max-above-average>7</max-above-average>
        </set>
    </night>
</data> 
```

现在我需要最大的记录，白天和黑夜。这将是最大值：60，本例中记录的值：60 = 60, > 49 + 3, 45 +9, 50 + 5, 52+7。需要计算白天和黑夜的最大值。因为这

> max(//record/max | //day/set/(average + max-above-average)) | //晚上/设置/（平均+最大高于平均））

不起作用。|-符号仅适用于节点。它给出以下错误：

> '|' 的第二个操作数的必需项类型 是节点（）；提供的值具有项目类型 xs:double

我正在使用 xpath 2.0 和 xslt 2.0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T05:01:46.447

**下面是需要的两个 XPath 2.0 表达式**（分别用于生成“max”和“min”值）：

```
max(/*/(day|night)/*/(average+max-above-average)) 
```

**和**

```
min(/*/(day|night)/*/(average -min-above-average)) 
```

**基于 XSLT 2.0 的验证**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
 xmlns:xs="http://www.w3.org/2001/XMLSchema">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
 max: <xsl:text/>
  <xsl:sequence select=
    "max(/*/(day|night)/*/(average+max-above-average))"/>
 min: <xsl:text/>
  <xsl:sequence select=
    "min(/*/(day|night)/*/(average -min-above-average))"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<data>
    <record>
        <min>40</min>
        <max>60</max>
    </record>
    <day>
        <set>
            <average>49</average>
            <max-above-average>3</max-above-average>
            <min-above-average>15</min-above-average>
        </set>
        <set>
            <average>45</average>
            <max-above-average>9</max-above-average>
            <min-above-average>2</min-above-average>
        </set>
    </day>
    <night>
        <set>
            <average>50</average>
            <max-above-average>5</max-above-average>
            <min-above-average>6</min-above-average>
        </set>
        <set>
            <average>52</average>
            <max-above-average>8</max-above-average>
            <min-above-average>11</min-above-average>
        </set>
    </night>
</data> 
```

**计算两个 XPath 表达式，并将这些计算的结果复制到输出**：

```
 max: 60
 min: 34 
```

**更新**：

OP 在评论中说他想要“最大的日夜和记录”——我真的不明白他的意思。

***这是我猜测*的尝试：**

```
max(
      (/*/record/max, 
       /*/(day|night)/*/(average+max-above-average, average+min-above-average)
       )
    ) 
```

**当植入 XSLT 转换（上图）时，会产生：**

```
 max: 64 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:22:08.997

XSLT 1.0 方法：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text" indent="yes" omit-xml-declaration="yes"/>

  <xsl:template match="/*">
    <xsl:variable name="recordMax" select="record/max" />
    <xsl:variable name="dayMax">
      <xsl:apply-templates select="day" mode="max" />
    </xsl:variable>
    <xsl:variable name="nightMax">
      <xsl:apply-templates select="night" mode="max" />
    </xsl:variable>

    <xsl:call-template name="Max">
      <xsl:with-param name="v1" select="$recordMax" />
      <xsl:with-param name="v2">
        <xsl:call-template name="Max">
          <xsl:with-param name="v1" select="$dayMax"  />
          <xsl:with-param name="v2" select="$nightMax" />
        </xsl:call-template>
      </xsl:with-param>
    </xsl:call-template>
  </xsl:template>

  <xsl:template match="*[set]" mode="max">
    <xsl:apply-templates select="set" mode="max">
      <xsl:sort select="average + max-above-average"
                data-type="number"
                order="descending" />
    </xsl:apply-templates>
  </xsl:template>

  <xsl:template match="set" mode="max">
    <xsl:if test="position() = 1">
      <xsl:value-of select="average + max-above-average" />
    </xsl:if>
  </xsl:template>

  <xsl:template name="Max">
    <xsl:param name="v1" />
    <xsl:param name="v2" />

    <xsl:choose>
      <xsl:when test="not($v2 > $v1)">
        <xsl:value-of select="$v1" />
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="$v2" />
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>
</xsl:stylesheet> 
```

在您的示例输入上运行时，结果是：

```
60 
```

# ruby - 一些 Capistrano 部署挂钩不起作用

> ID：15821321
> 
> 赞同：10
> 
> 时间：2013-04-04T20:42:57.550
> 
> 标签：ruby, deployment, capistrano

我正在使用`Capistrano v2.14.2`并尝试使用`before`and`after`钩子`deploy:create_symlink`，但它们似乎都没有触发......

我收到了这个警告：

`[Deprecation Warning] This API has changed, please hook 'deploy:create_symlink' instead of 'deploy:symlink'.`

所以我更新了我的代码以使用`deploy:create_symlink`而不是`deploy:symlink`

这是我的一个片段`deploy.rb`

```
namespace :foo do
    task :start do
        puts "starting foo..."
    end

    task :stop do
        puts "stoping foo..."
    end
end

before('deploy:create_symlink', "foo:stop")
after('deploy:create_symlink', "foo:start") 
```

这是输出的片段：

```
 * 2013-04-04 13:34:27 executing `deploy:symlink'
  * executing "rm -f /web/example.com/current && ln -s /web/example.com/releases/20130404203425 /web/example.com/current"
    servers: ["app1"]
    [app1] executing command
    command finished in 467ms 
```

没有钩子被称为...

Hooks for `deploy:finalize_update`and `deploy:update_code`all 似乎都在正常工作，没有任何问题。

能够使用`before`和`after`钩子发生了`deploy:create_symlink`什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-10T20:06:53.173

I'm running into a similar issue, using the same version of Capistrano. I'm also using capistrano-multistage, and I'm curious if that is causing the issue some how (haven't tested a plain Capistrano setup yet).

Basically, if you hook into a before/after trigger on deploy:symlink, it tells you to use deploy:create_symlink, but deploy:symlink is what actually runs. If I trigger on either of those, it doesn't fire.

I ran across this article, which got me thinking that i should trigger on "after deploy" instead, since symlink is the last step in deploy for me:

[http://blog.rememberlenny.com/2013/03/04/deploying-wordpress-with-capistrano-symlink-issue-fix/](http://web.archive.org/web/20130620001048/http://blog.rememberlenny.com/2013/03/04/deploying-wordpress-with-capistrano-symlink-issue-fix/)

Here is how I resolved my deployment:

*   Moved my "before deploy:symlink" trigger to "after deploy:finalize_update" (since that was the previous task and it actually triggers)
*   Moved my "after deploy:symlink" trigger to "after deploy"

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-07T15:28:43.067

改变

```
"after deploy:symlink" 
```

至

```
"after deploy" 
```

# magento - 无法访问自定义属性

> ID：15821322
> 
> 赞同：0
> 
> 时间：2013-04-04T20:43:02.967
> 
> 标签：magento

我一直在寻找这个问题的答案。我已经使用 Magento 大约一个星期了，我正在修复一堆我们搞砸的模板。无论如何，我现在处于一个应该很容易但它不起作用的地方。我需要访问和自定义属性……此代码有效。

标准属性

```
$_product->getName() 
```

但是这段代码不会......“设计师”的自定义属性</p>

```
$_product->getDesigner() 
```

开发人员的原始代码有这个..但是这个代码也不起作用哈哈

```
$_helper->productAttribute($_product, $_product->getDesigner(), 'designer'); 
```

任何帮助都会非常感谢你们！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:14:49.423

你如何获得 $_product？也许你需要做一个负载。

$_product = Mage::getModel("目录/产品")->load($_product->getId());

Magento 在您进行加载之前不会加载模型的所有属性。

尝试通过执行 Mage::log($_product->getData()) 将所有数据记录在产品中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:48:15.403

确保它`$_product`是 的一个实例`Mage_Catalog_Model_Product`，或将其设置为一个`$_product = Mage::getModel("catalog/product")->load($_product->getId())`

除了`$_product->getDesigner()`你可以使用的“魔法”吸气剂之外`getData()`：

```
$_product = Mage::getModel("catalog/product")->load($_product->getId());
$_designer = $_product->getData('designer'); 
```

# c# - 如何异步检查客户端是否断开连接？

> ID：15821323
> 
> 赞同：0
> 
> 时间：2013-04-04T20:43:10.453
> 
> 标签：c#

我有一个异步套接字项目，我需要知道客户端何时断开连接，以便我可以将其从连接的客户端列表中删除。

有什么方法可以异步检查吗？

在我看来，我可以创建一个线程，在其中循环遍历所有客户端并检查是否 !Client.Connected 然后我将关闭套接字，但也许还有另一种方法可以做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:00:17.093

以下问题可能会为您提供一些指导，帮助您了解如何最好地解决您的问题以及如何处理具有多个客户端的套接字

[异步服务器套接字多个客户端](https://stackoverflow.com/questions/5815872/asynchronous-server-socket-multiple-clients)

# actionscript-3 - AS3 补间光循环停止

> ID：15821331
> 
> 赞同：1
> 
> 时间：2013-04-04T20:43:45.273
> 
> 标签：actionscript-3, loops, gsap

我有一个循环动画停止并给我一个参数错误。我用几种不同的方式重做了编码，但无济于事。这是我的代码：

```
contactbox.addEventListener(MouseEvent.MOUSE_OVER, Scroll);

function Scroll(evt:MouseEvent){
TweenLite.to(
    btnwave, 2, {
    x:-115.5, ease:Linear.easeNone, overwrite:true, onComplete:Switch});
}
function Switch(){
TweenLite.to(
    btnwave, 0, {
        x:184.6, ease:Linear.easeNone, overwrite:true, onComplete:Scroll});
} 
```

这是它给我的错误：

```
ArgumentError: Error #1063: Argument count mismatch on Main/Scroll(). Expected 1, got 0.
at Function/http://adobe.com/AS3/2006/builtin::apply()
at com.greensock.core::TweenCore/complete()
at com.greensock::TweenLite/renderTime()
at com.greensock::TweenLite()
at com.greensock::TweenLite$/to()
at Main/Switch()
at Function/http://adobe.com/AS3/2006/builtin::apply()
at com.greensock.core::TweenCore/complete()
at com.greensock::TweenLite/renderTime()
at com.greensock.core::SimpleTimeline/renderTime()
at com.greensock::TweenLite$/updateAll() 
```

我正在努力提高我的补间技能，以准备一些即将到来的工作。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:49:59.167

您收到错误是因为 TweenLite 没有将 MouseEvent 实例传递给 Scroll()。Scroll() 当前要求将 MouseEvent 对象传递给它，因为它是一个事件处理程序。您可以通过将 Scrolls 第一个参数设为可选来解决此问题，如下所示：

```
function Scroll(evt:MouseEvent=null){ 
```

这样，当 TweenLite 调用 Scroll() 时，MouseEvent 将默认为 null。

# android - 取消选中单选按钮

> ID：15821334
> 
> 赞同：4
> 
> 时间：2013-04-04T20:43:58.503
> 
> 标签：android, if-statement, radio-button

该应用程序是一个步进音序器应用程序，具有 16 个无线电组，每组有 8 个按钮。它工作得很好，除非一旦一个组选择了一个按钮，除非我使用我创建的清除按钮来清除所有无线电组，否则我无法将其关闭。我想添加的是一些代码，当再次选择选定的单选按钮时，它会像切换按钮一样关闭。我尝试使用切换，但该方法出现了其他问题。下面是一个尝试，但我猜它离题了

```
final RadioGroup radioGroup1 = (RadioGroup)findViewById(R.id.RadioGroup1);
RadioButton lC1 = (RadioButton)findViewById(R.id.RadioButtonlowC1);

Button D1 = (Button)findViewById(R.id.RadioButtonD1);
        D1.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                PdBase.sendFloat("D1", 74);
                int selectedTypeId = radioGroup1.getCheckedRadioButtonId();
                RadioButton D1 = (RadioButton) findViewById(selectedTypeId);
                if(radioGroup1 != null) // This will be null if none of the radio buttons are selected
                       radioGroup1.clearCheck(); 
                PdBase.sendFloat("D1", 0);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:51:55.657

这是一个如何创建单选组、单选按钮以及如何在 Java 代码中使用的示例。希望它能给你完整的图片

**XML 文件：**

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <RadioGroup
        android:id="@+id/maptype"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/line1"
        android:orientation="horizontal" >

        <RadioButton
            android:id="@+id/map"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:checked="true"
            android:drawableRight="@drawable/ic_launcher"/>

        <RadioButton
            android:id="@+id/satellite"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:drawableRight="@drawable/ic_launcher"/>
    </RadioGroup>

</LinearLayout> 
```

**在 Java 代码中**

```
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);

    RadioGroup rgrpMapType = (RadioGroup) findViewById(R.id.maptype);
    int selectedTypeId = rgrpMapType.getCheckedRadioButtonId();
    RadioButton rbMapType = (RadioButton) findViewById(selectedTypeId);
    if(rbMapType != null) // This will be null if none of the radio buttons are selected
           rgrpMapType.clearCheck(); 
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:47:41.700

您需要将按钮放在一个单选组中，然后清除该组。单选按钮不能直接取消选中，因为其想法是始终选中组中的一个选项。

# .htaccess - htaccess 允许通过重定向访问页面，但不能直接访问

> ID：15821341
> 
> 赞同：1
> 
> 时间：2013-04-04T20:44:19.050
> 
> 标签：.htaccess, mod-rewrite, referer

我以为我的设置正确，但我还没有找到一个“完美”的解决方案，想看看是否有人做过类似的设置。

我有一个页面，根据星期几将重定向到其他页面（未公开链接）。我不希望用户能够在不通过指定推荐人的情况下到达最终页面，这样用户就无法在星期五添加书签和拉起星期一页面。如果他们这样做，他们将被重定向，说他们无法通过书签访问它。

主页是 www.example.com/AB/ 访问该页面后，用户会自动重定向到 www.example.com/AB/123 或 www.example.com/AB/123

我想要完成的是阻止对最终页面的访问，如果它们没有从父页面中引用。但是，可以从任何地方访问父页面（引荐来源网址无关紧要）。

想法？

谢谢！

## 编辑：

@olaf - 这就是我所在的地方......

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !mysite\.com [NC]
RewriteRule ^/?q/? http://mysite.com/sorry-no-bookmarks/ [R=302,L] 
```

无论日期或时间，如果“/q/...”下的子页面不是来自 mysite.com 上的某个地方（任何地方），则应将其重定向到“无书签”页面。此外，我想保留任何在“/n/...”下的子页面，可以从任何地方自由访问（包括外部引用者）。chrome 基本上可以正常工作，但 Firefox 和 IE 无论如何都会阻止事情。娱乐时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:12:19.740

由于您留在同一台服务器上，因此我不会重定向而是进行内部重写

```
RewriteEngine on

RewriteCond %{TIME_WDAY} 1
RewriteRule ^AB/?$ /AB/monday.html [L]

RewriteCond %{TIME_WDAY} 2
RewriteRule ^AB/?$ /AB/tuesday.html [L]

# and so on ... 
```

或将每日文件命名`1.html`为星期一，`2.html`星期二，......并按照一条规则进行

```
RewriteEngine on
RewriteRule ^AB/?$ /AB/%{TIME_WDAY}.html [L] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:58:37.757

您的意思是将用户链接到的滥用文本重定向到`/AB/$dynamic`不是来自其中的用户`/AB/`吗？试试这个：

```
RewriteCond %{HTTP_REFERER} !example.com/AB/?$ [NC]
RewriteCond ^/AB/([a-z0-9-_]+)/? abuse.txt 
```

# matlab-figure - 如何在同一个图上绘制多天的数据

> ID：15821342
> 
> 赞同：0
> 
> 时间：2013-04-04T20:44:27.520
> 
> 标签：matlab-figure

我有一些数据在上午 8:00 到上午 11:00 期间收集了 6 天。我需要在同一个图上绘制所有数据。我现在的做法：

```
hold on
 plot(y1,x1,':b*','MarkerEdgeColor','k')
 plot(y2,x2,':r*','MarkerEdgeColor','k')
 plot(y3,x3,':y*','MarkerEdgeColor','k')
 plot(y4,x4,':g*','MarkerEdgeColor','k')
 plot(y5,x5,':c*','MarkerEdgeColor','k')
 plot(y6,x6,':w*','MarkerEdgeColor','k')
 datetick('x','HH:MM:SS')
hold off 
```

其中 x1 到 x6 具有 y 轴数据，而 y1 到 y6 具有

```
y(i) = datenum(Year(1:5), Month(1:5), Input_Vector(1:5,2), Input_Vector(1:5,3), Input_Vector(1:5,4), Input_Vector(1:5,5)); 
```

当我使用上面的绘图时，我得到了附加的图像 ![在此处输入图像描述](https://i.stack.imgur.com/exRUO.png)

但是我需要通过观察它们来找到模式。所以我需要在 x 轴 8:00:00 到 11:00:00 之间有一个高于其他的东西

我需要类似的东西，我通过将 DAY 参数设置为恒定日期来获得它。

![在此处输入图像描述](https://i.stack.imgur.com/o2k6K.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-06T09:58:11.687

如果您想将一天绘制在另一天上，那么您用来制作第二张图表的方法 - 丢弃/替换日期时间的日期部分 - 可能是最好的方法。它与图表回答的概念性问题很好地匹配，即：“一天中的时间和旅程持续时间之间是否存在联系，无论它是在哪一天进行的？”

如果您仍想保留日期信息，您始终可以使用不同的线规格执行多个绘图，并让图例显示哪条线对应于哪一天。

如果上面的问题 - 寻找时间和旅程持续时间之间的联系 - 是你想要做的，而不是绘制那种特定类型的图表，我也会尝试这样的事情：

1.  将您的一天分成半小时或一刻钟时段，并取每个块中所有数据点的平均值。这为每个半小时/四分之一小时跨度提供了一个值。
2.  将其绘制为带有显示标准误差的误差线的条形图（这可以使用`bar`和来完成`errorbars`）
3.  如果我看到任何东西，请尝试使用合适的模型对其进行拟合并检查拟合优度。在您的情况下，这可能是一个高斯模型，因为您的数据看起来在 9:20 左右达到峰值。

# windows - 下载或生成msvcp71.dll？

> ID：15821343
> 
> 赞同：13
> 
> 时间：2013-04-04T20:44:28.817
> 
> 标签：windows, gcc, windows-7, mingw

我在 Windows XP 上编写了一个大型而复杂的 C 应用程序。现在我在 64 位 Windows 7 机器上重新编译。当我运行某些可执行文件时，我收到此错误：

> 程序无法启动，因为您的计算机中缺少 MSVCP71.dll。尝试重新安装程序以解决问题。

显然，这是一个 .dll，过去是 Windows 附带的，但现在没有（特别参见这个[MSDN 论坛](http://social.msdn.microsoft.com/forums/en-US/windowsgeneraldevelopmentissues/thread/7f5a39ee-e089-4330-a67c-e8e24090939c/)和这个[以前的堆栈溢出](https://stackoverflow.com/questions/2036397/msvcr71-dll-msvcp71-dll-missing)问题。）

假设我应该从 Microsoft Visual C++ 生成这个 DLL 并“从合并模块中提取 DLL”。但是，我正在使用 gcc、mingw 和 make，我宁愿避免使用 Visual Studio。

可以从 Internet 上未经验证的来源下载此 dll 的许多副本，但没有一个可直接从 Microsoft 下载。我该怎么办？我需要安装 Microsoft Visual C++ 吗？有没有办法用 gcc 和 mingw 做到这一点？

* * *

**更新：** @Sheng Jiang 蒋晟的提示至关重要。我没有意识到我对 MSVCP71.dll 的依赖只是由于链接到第三方 DLL 而产生的。我能够识别第三方 DLL 并找到运行在具有该 DLL 的另一个系统上的 MSVCP71.dll 的副本。现在我可以将 MSVCP711.dll 与第三方 DLL 一起包含进来，一切运行顺利。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T23:15:13.173

此文件没有可下载的可再发行版本。CD 上仅提供合并模块。程序员应该将这些合并模块嵌入到他们的安装程序中，或者将文件提取到他们程序的安装文件夹中。[此文件不适用于 System32，因为它违反了 Windows 徽标要求](http://msdn.microsoft.com/en-us/library/aa984684%28v=vs.71%29.aspx)。

由于您没有使用 Visual C++ 工具链，MS-STL 依赖项带有第三方组件，其作者没有提供正确的安装程序。虽然您可以从其他产品获取 dll，但是，您需要一个明确授予您重新分发权限的产品，以便能够将文件重新分发给您的客户。此类再分发权利随 Visual C++ 2003 以及可能的 InstallShield X 和其他安装包创作软件提供。

对于评估建议，您可以从其他依赖该文件的产品中获取该组件的文件，例如 SQL Server 2005、.Net 1.1 运行时或其 SDK、Crystal Report 10 等。请注意版本不匹配。如果组件需要 SP1 或更高版本的 MSVCP71.dll，它可能不适用于 RTM 版本。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-04T21:25:04.857

我没有来自 Microsoft 的链接，但您可以从[这里](http://www.dll-files.com/dllindex/dll-files.shtml?msvcp71)下载（链接已修复，现在指向正确的文件）。

现在将其移至`C:/Windows/SysWOW64` *（64 位）*或`C:/Windows/System32` *（32 位）*

这是另一个可用的下载：http: [//www.addictivetips.com/windows-tips/fix-msvcp71-dll-and-msvcr71-dll-missing-error-in-windows-7/](http://www.addictivetips.com/windows-tips/fix-msvcp71-dll-and-msvcr71-dll-missing-error-in-windows-7/)

不确定这是否可行，但也许重新安装或更新 MS VC++ *Runtime*可以解决这个问题（[Microsoft 下载中心](http://www.microsoft.com/en-us/download/confirmation.aspx?id=5555)）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-01-22T14:33:27.983

MS Office、Oracle 客户端和 sql developer 都有 msvcp71.dll。我已经在我的电脑上找到了一份副本。无需从不受信任的网站下载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-25T14:35:00.267

如果我们从 C:\ORACLE\product\10.2.0\Client_4\oui\lib\win32\msvcp71.dll 复制文件 msvcp71.dll 并将文件粘贴到文件夹 C:\winnt\system32 中，则它可以工作。

# java - javascript中的代码java

> ID：15821347
> 
> 赞同：-6
> 
> 时间：2013-04-04T20:44:39.317
> 
> 标签：java, javascript

我正在尝试将代码 java 放入警报 javascript 中：

```
try
{
  table(out, Integer.parseInt(num));
}
catch (NumberFormatException e)
{
   %>
   <script language="javascript" >
     alert("Error." + <%= e.getMessage() %>);
   </script>
   <%
} 
```

但不工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:47:07.203

你的引号有问题。试试这个：

```
%>
    <script language="javascript" >
        alert("Error. <%= e.getMessage() %>");
    </script>
<% 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:48:08.680

它不会因为 Javascript 在客户端运行，这意味着它由用户的浏览器运行，而 Java 运行服务器。为了让客户端 javascript 与后端 Java 交互，您需要向服务器发出请求。

# redis - 如何备份 Redis 服务器 RDB 和 AOF 文件以进行恢复，以确保将数据丢失降至最低？

> ID：15821348
> 
> 赞同：4
> 
> 时间：2013-04-04T20:44:40.333
> 
> 标签：redis, persistence, backup-strategies, redis-rdb

# 目的：

我正在尝试每 X 次备份一次 dump.rdb 和每 Y 次 appendonly.aof，所以如果文件由于某种原因（或者甚至只是 AOF 的 appendonly.aof 文件）损坏，我可以从转储中恢复我的数据。 rdb.backup 快照，然后随着我拥有的最新副本 appendonly.aof.backup 发生任何其他变化。

# 情况：

我每 5 分钟备份一次 dump.rdb，每 1 秒备份一次 appendonly.aof。

# 问题：

1）由于子进程正在后台将dump.rdb写入临时文件-子进程创建新图像时发生的关键更改会发生什么？我知道无论后台写入如何，AOF 文件都会继续追加，但是新的 dump.rdb 文件是否也包含关键更改？

2）如果dump.rdb 不包含关键更改，有没有办法找出子进程被分叉的确切点？这样我就可以跟踪 AOF 文件将拥有最新信息的时间点。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T09:05:03.623

通常，人们使用 RDB 或 AOF 作为持久性策略。拥有这两个是相当昂贵的。每 5 分钟运行一次转储，每秒复制一次 aof 文件听起来非常频繁。除非 Redis 实例只存储少量数据，否则您可能会杀死您机器的 I/O 子系统。

现在，关于您的问题：

**1）RDB机制的语义**

转储机制利用现代操作系统内核在克隆/分叉过程中实现的写时复制机制。分叉完成后，系统只是通过复制页表来创建后台进程。页面本身在两个进程之间共享。如果 Redis 进程对某个页面进行了写操作，操作系统会透明地复制该页面（这样 Redis 实例就有自己的版本，而后台进程是之前的版本）。因此，后台进程保证了内存结构保持不变（因此是一致的）。

结果是任何在分叉后开始的写操作都不会被转储。转储是在分叉时拍摄的一致快照。

**2) 跟踪分叉点**

可以通过运行 INFO 持久化命令并计算 rdb_last_save_time - rdb_last_bgsave_time_sec 来估计分叉时间戳，但它不是很准确（仅第二个）。

为了更准确（毫秒），您可以解析 Redis 日志文件以提取以下行：

```
[3813] 11 Apr 10:59:23.132 * Background saving started by pid 3816 
```

您至少需要“通知”日志级别才能看到这些行。

据我所知，没有办法将 AOF 中的特定条目与 RDB 的 fork 操作相关联（即不可能 100% 准确）。

# ruby-on-rails - Rails：多个数据库，相同的模式

> ID：15821349
> 
> 赞同：0
> 
> 时间：2013-04-04T20:44:40.990
> 
> 标签：ruby-on-rails, database, database-connection

我在一个虚构的场景项目中，我允许公司的多个用户登录、创建记录等，他们都连接到一个数据库。他们都可以记录缺勤记录、考勤记录等。

然而，我想做的是使用相同的模式，但将其扩展为允许多家**公司**使用相同的模式拥有自己的数据库。所以每个公司都会有自己的数据，但是所有公司都使用相同的数据模型。换句话说，所有公司都可以创建缺勤记录，但他们每个人都只能访问他们自己创建的缺勤记录。

我怎样才能做到这一点？

我只需要两三个文件就可以了，我不会将其用于商业用途，以防你们认为我在偷工减料，损害了别人的利益！

像 if-else 这样简单的东西决定使用哪个文件对我来说非常有用，所以如果存在这样的代码行，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:39:00.057

我认为您做错了（除非您有充分的理由为每家公司都拥有一个数据库），因为您似乎在一遍又一遍地重复您的数据模型，同时为您的代码引入了不必要的复杂性。

尝试将所有公司放在一个数据库/表中，并用`company_id`.

例如：数据结构如下

```
companies table
id
name

users table
id
user_name
company_id 
```

但是，如果您真的想连接到多个数据库，请查看这个[SO question](https://stackoverflow.com/questions/1825844/multiple-databases-in-rails)。

# search - 来自菜鸟的 VBS 问题

> ID：15821350
> 
> 赞同：-2
> 
> 时间：2013-04-04T20:44:41.427
> 
> 标签：search, vbscript, criteria

我是 vbs 的新手，需要知道如何在列中搜索某些条件，然后将匹配该条件的任何行复制到新的电子表格中。我有几个类别的数据，我从一个电子表格中提取所有数据，但它需要在此列上进行大量过滤，在此列上过滤，在另一列中关注此条件，如果匹配则复制并粘贴该行到适当的类别”。我基本上想承担所有这些手动工作并将其自动化。

我的第二个问题是在某些列中搜索我有日期时，我需要找到符合“21 天或更接近当前日期”标准的行。如何指定脚本来查看日期并复制和粘贴距当前日期不超过 21 天的所有行？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:13:23.550

有两种方法可以自动处理电子表格（Excel？）数据：两者都从用普通/自然语言指定您的任务开始（例如，'复制所有行 ??-date 21 days greater/greater equal/smaller/smaller equal than当前日期从工作表 ?? (row/col?) 到工作表 ?? (row/col?)' 然后

1.  使用宏记录器获取 VBA 代码来解决任务并将其“移植”到 VBScript
2.  将任务描述转换为 SQL 语句并在与电子表格的 ADO 连接上执行它们

第一种还是第二种方式更适合你，取决于你的知识和技能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:15:09.523

您对使用 VBS 创建自定义宏感兴趣吗？在 Development/Visual Basic 下添加 VB 文件，您可以处理行和列。

```
Sub CountX(pRowStart As Integer, pRowStop As Integer, pColStart As Integer, pColStop As Integer, pObjGrp As String)
            Dim x As Integer
            Dim xRow As Integer
            Dim xCol As Integer
            Dim wSht As Worksheet

            x = 0
            '**** create object reference to worksheet object.
            Set wSht = Worksheets("Sheet1")

            '**** set cell control values
            xRow = 1
            xCol = 3        
            Do While xRow < pRowStop + 1
                Do While xCol < pColStop + 1
                    If UCase(ActiveSheet.Cells(xRow, xCol)) = "X" Then
                        x = x + 1
                    End If
                    xCol = xCol + 1
                Loop
                xCol = pColStart
                xRow = xRow + 1
            Loop
    End Sub 
```

您还可以将此添加到您的代码中以激活另一张工作表并将值设置为第 1 行第 3 列

```
Sheets(psSheetName).Activate 
ActiveSheet.Cells(1, 3).Value = "value" 
```

# android - 如何在 tabhost 中将变量从一个页面放到另一个页面？

> ID：15821353
> 
> 赞同：0
> 
> 时间：2013-04-04T20:44:48.690
> 
> 标签：android

事实上，我正在开发一个 android 项目，我有一个事件列表，当我单击一个事件时，我可以传递事件的名称及其图像，但我不能将描述放在 tabhost 中我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:58:37.403

**选项 1：** 您可以尝试在存储描述的每一行上使用 setTag 方法。

```
setTag(Object tag) 
```

设置与此视图关联的标记。

**选项 2：**

我的项目中有类似的情况。这就是我实现的方式

1.  当我创建列表时，我创建了字符串对象数组。我把它作为一个全局对象保存在 MYProjectApplication.java 文件中。所以它无处不在。
2.  单击列表时，我得到位置并从全局字符串数组中引用相应的描述。

# c# - TransformedBitmap 缩放模式

> ID：15821358
> 
> 赞同：2
> 
> 时间：2013-04-04T20:45:13.197
> 
> 标签：c#, wpf, image, scaling

我正在使用一个`TransformedBitmap`类将缩放图像绘制到`Bitmap`using `TransformedBitmap.CopyPixels`. 有没有办法指定使用的缩放模式？`RenderOptions.SetBitmapScalingMode`似乎没有任何影响。我想使用最近邻，但它似乎使用某种双线性滤波器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T01:32:03.463

*   无法指定缩放算法，这是设计使然。
*   RenderOptions.SetBitmapScalingMode 仅适用于渲染，例如，您有一个 32*32 图标并希望以 256*256 显示它，但仍以块状方式（最近邻）

**更新**

关于如何克服这个问题的几种方法：

自己做： http: [//tech-algorithm.com/articles/nearest-neighbor-image-scaling/](http://tech-algorithm.com/articles/nearest-neighbor-image-scaling/)

使用表格： [https ://stackoverflow.com/a/1856362/361899](https://stackoverflow.com/a/1856362/361899)

自定义绘图： [如何指定 WPF 图像使用的图像缩放算法？](https://stackoverflow.com/questions/2913060/how-to-specify-the-image-scaling-algorithm-used-by-a-wpf-image)

也有 AForge ，但这可能对您的需求有点过分。

**更新 2**

WriteableBitmapEx 可能会为您轻松完成这项工作：[http ://writeablebitmapex.codeplex.com/](http://writeablebitmapex.codeplex.com/)

您可以调整 WriteableBitmap 的大小，指定插值模式和最近邻。

TransformedBitmap 和 WriteableBitmapEx 都继承自 BitmapSource，您可能根本不需要对现有代码进行任何更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-29T14:18:49.190

```
 public static class Extensions
{
    public static BitmapFrame Resize(this
BitmapSource photo, int width, int height,
BitmapScalingMode scalingMode)
    {

        var group = new DrawingGroup();
        RenderOptions.SetBitmapScalingMode(
            group, scalingMode);
        group.Children.Add(
            new ImageDrawing(photo,
                new Rect(0, 0, width, height)));
        var targetVisual = new DrawingVisual();
        var targetContext = targetVisual.RenderOpen();
        targetContext.DrawDrawing(group);
        var target = new RenderTargetBitmap(
            width, height, 96, 96, PixelFormats.Default);
        targetContext.Close();
        target.Render(targetVisual);
        var targetFrame = BitmapFrame.Create(target);
        return targetFrame;
    }
} 
```

取自[http://weblogs.asp.net/bleroy/resizing-images-from-the-server-using-wpf-wic-instead-of-gdi](http://weblogs.asp.net/bleroy/resizing-images-from-the-server-using-wpf-wic-instead-of-gdi)

# c# - 检测鼠标点击多边形的节点

> ID：15821359
> 
> 赞同：0
> 
> 时间：2013-04-04T20:45:20.617
> 
> 标签：c#, winforms, polygon, system.drawing

我正在创建一个 WindowsForms 应用程序。在这个应用程序中，我需要使用带有多边形顶点（节点）坐标的数组来绘制多边形。

当用户单击多边形的一个节点时，我需要检测选择了哪个节点，以建议用户删除该节点。

我正在使用 WindowsForms、PictureBox 和 Graphics.DrawPolygon 来绘制多边形。

如果用户单击了其中一个节点，我如何检测？有没有比 WindowsForm 和 PictureBox 更适合绘制多边形的方法？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:46:37.907

请参阅：[在 Windows 窗体应用程序 (.net) 中单击图像的 X/Y 坐标](https://stackoverflow.com/questions/975468/x-y-coordinates-of-click-on-an-image-in-a-windows-forms-application-net)

您需要获取坐标，然后对多边形进行测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:36:17.127

您必须通过运行节点点并测试它们是否在用户单击的位置来检查图片框何时被单击。

```
Point[] listOfNodes = new Point[1];
private void pictureBox1_MouseClick(object sender, MouseEventArgs e)
{
    foreach (Point item in listOfNodes)
    {
        if (item == e.Location)
        {
            //The node was clicked.
        }
    }
} 
```

# gwt - 什么时候在 GWT 编辑器框架中为 ValueAwareEditors 调用“onPropertyChange”？

> ID：15821364
> 
> 赞同：0
> 
> 时间：2013-04-04T20:45:35.117
> 
> 标签：gwt

ValueAwareEditor 有一个方法`void onPropertyChange(java.lang.String... paths)`，javadoc 说：“通知编辑器一个或多个值属性已更改。”

这个方法到底是什么时候调用的？调用此方法是 EditorDriver 的职责吗？还是我必须自己实现调用此方法的代码？

或者它根本没有实现，这是由这个问题提出的：[GWT editor onPropertyChange](https://stackoverflow.com/questions/10062207/gwt-editor-onpropertychange)。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:08:10.933

两个内置的编辑器驱动程序永远不会调用该方法（`git grep onPropertyChange`仅返回方法声明），所以我想我们可以说这是“根本没有实现”。

请注意，这`EditorDelegate#subscribe()`是在`RequestFactoryEditorDriver`使用替代方法来传达更改时实现的：它将侦听`EntityProxyChange`事件并`RequestFactory#find()`在更改时将代理返回，然后就地更新编辑器`ValueAwareEditor`，*通过*它们`LeafValueEditor`的. 是.*`setValue()`
`subscribe()``SimpleBeanEditorDriver`*

# android - EditText：如何在键入时显示数字？

> ID：15821370
> 
> 赞同：1
> 
> 时间：2013-04-04T20:45:49.057
> 
> 标签：android, android-widget

我的应用程序中有三个 EditText 小部件，其中一个的 XML 如下所示。它们大部分都可以工作，但问题是实际的小部件位于我的设备屏幕底部。当我点击小部件并显示数字键盘时，它完全覆盖了文本输入窗口，我看不到我正在输入的数字。我可以修改 TextView 以便在我的设备上显示小键盘时，它还显示我当前正在输入的数字吗？

```
<EditText
    android:id="@+id/EditTextPrices"            android:layout_width="100dip"
    android:layout_height="wrap_content"        android:inputType="number|numberDecimal"
    android:singleLine="true"                   android.imeOptions="actionDone"/> 
```

另一个问题是，当我输入完一个数字后，它并没有将我返回到主活动屏幕，而是为下一个 TextEdit 小部件打开了数字键盘。我不希望这种情况发生。我曾认为设置 android.imeOptions="actionDone" 会导致键盘消失并在我输入完数字后完成，但事实并非如此。如何阻止“下一个”窗口出现？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:49:09.817

将 android:windowSoftInputMode=”adjustPan” 添加到 Activity 的清单中。这将导致活动向上滚动，以便焦点编辑文本始终在屏幕上。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T20:54:24.203

考虑将[android:windowSoftInputMode](http://developer.android.com/guide/topics/manifest/activity-element.html#wsoft)添加到清单文件中。“adjustPan”，因为它的值可能是您想要的，尽管我发现它有时无法考虑在您输入内容时，猜词条在软键盘上方所占用的空间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T20:54:56.323

使用 adjustPan 的另一个建议很好，另一个想法是将布局放在滚动视图中。

关于你的第二个问题，你是如何处理 actionDone 的？

例如，这就是我隐藏键盘的方式（或者当他们按下完成时做任何你想做的事情）。

```
final EditText editTextPrices = (EditText) findViewById(R.id.editTextPrices);
editTextPrices.setOnEditorActionListener(new OnEditorActionListener() {
    @Override
    public boolean onEditorAction(TextView view, int actionID, KeyEvent event) {
        if (actionID == EditorInfo.IME_ACTION_DONE) {
            InputMethodManager imm = (InputMethodManager) MyClass.this.getSystemService(Context.INPUT_METHOD_SERVICE);
            imm.hideSoftInputFromWindow(bugemailaddress.getWindowToken(), 0);
            // DO OTHER HANDLING OF INPUT HERE
            return true;
        }
        return false;
    }
 }); 
```

# c# - WIF IDP 和 SimpleSamlPHP 作为 SP

> ID：15821371
> 
> 赞同：1
> 
> 时间：2013-04-04T20:45:50.983
> 
> 标签：c#, single-sign-on, wif, saml-2.0, windows-identity

我有一个用 WIF 制作的自定义 STS，它作为 IDP 工作，现在我需要将 SSO 配置为用 SimpleSamlPHP 制作的服务提供者。（SP 仅支持 Post Binding 和 Web Browser SSO Profile。）

任何，关于我应该如何处理这个要求的想法？WIF 是否支持 Post Binding 和 SAML 2.0？

任何想法将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:08:56.390

WIF对绑定没有限制，只是一套Api，让Idps和Spses的开发更加容易。人们通常做的是在服务提供者上实现重定向绑定，在身份提供者上实现后绑定——我读过的所有书籍和教程都是这样的。这意味着服务提供者应该使用**wa=wsignin1.0**重定向到身份提供者，并且身份提供者使用包含发布给服务提供者的令牌的表单进行响应。

但是，我看不到任何明显的原因，您将无法为双方实施后绑定。

据我所知，除了多年未更新的 ctp 之外，仍然没有对 WIF 的 SAML2 协议支持。如果您的服务需要 saml2，则必须查看一些商业实现，例如来自 componentspace 的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T22:05:21.627

根据@Wiktor，WIF 中没有 SAML 支持。

但是您需要 SAML 堆栈的服务器端而不是客户端。

您最好的选择可能是将 ADFS v2.0 放在中间并将其用作提供 SAML 支持的代理。

如果您需要 SAML 支持，请[在此处投票](https://connect.microsoft.com/VisualStudio/feedback/details/781848/net-4-5-windows-identity-foundation-should-include-samlp-support)。

# oracle - 隐式插入语句

> ID：15821372
> 
> 赞同：0
> 
> 时间：2013-04-04T20:45:55.057
> 
> 标签：oracle

我无法将一些值插入到表的副本中。这是我的代码：

```
INSERT INTO copy_d_events
VALUES (110, 'Ayako Anniversary',
        07-Jul-04, 
        'Party for 50, sixties dress, decorations', 
        'Not Determined', 
        245, 79, 240, 6655); 
```

Oracle 给了我这个错误：

> ORA-00984: 此处不允许列

有人帮一个人吗？

@TheEwook 我也试过：

```
INSERT INTO copy_d_events
(ID, Name, Event_ Date, Description, Cost, Venue_ID, Package_ Code ,Theme_Code ,Client_ Number) VALUES (110, 'Ayako Anniversary',07-Jul-04,'Party for 50, sixties dress, decorations',245, 79, 240, 6655); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:49:17.713

日期有问题`07-Jul-04`。你不能这样写日期。

您可以尝试使用[to_date](http://www.techonthenet.com/oracle/functions/to_date.php)函数：

```
INSERT INTO copy_d_events
VALUES (110, 'Ayako Anniversary',to_date('01/07/2004','dd/mm/yyyy'), 'Party for 50, sixties dress, decorations', 'Not Determined', 245, 79, 240, 6655); 
```

强烈建议您在数据库中插入数据时指定列名。

```
INSERT INTO table_name (column1, column2, column3,...)
VALUES (value1, value2, value3,...) 
```

文档：[http ://www.w3schools.com/sql/sql_insert.asp](http://www.w3schools.com/sql/sql_insert.asp)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:50:57.410

尝试使用[to_date](http://www.techonthenet.com/oracle/functions/to_date.php)函数：

```
INSERT INTO copy_d_events
VALUES (110, 'Ayako Anniversary',
        to_date('2004/07/07 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), 
        'Party for 50, sixties dress, decorations', 
        'Not Determined', 
        245, 79, 240, 6655); 
```

> 该`to_date`函数允许您定义日期/时间值的格式

**编辑**

```
ID  NAME                EVENT_DATE  DESCRIPTION                             COST     VENUE_ID PACKAGE_CODE  THEME_CODE CLIENT_NUMBER 
100 Peters Graduation   14-MAY-04   Party for 200, red, white, blue motif   8000    100 112 200 5922 105    Vigil wedding   28-APR-04   Black tie at Four Season hotel  10000   220 200 200 6133 
```

根据您发布的列数据，我认为问题在于`'Not Determined'`价值。如果它是一个数字列，您可能必须这样查询：

```
INSERT INTO copy_d_events
VALUES (110, 'Ayako Anniversary',
        to_date('2004/07/07 00:00:00', 'yyyy/mm/dd hh24:mi:ss'), 
        'Party for 50, sixties dress, decorations', 
        0, 
        245, 79, 240, 6655); 
```

# xcode - 将实现方法移动到头文件中的 Xcode 快捷方式

> ID：15821376
> 
> 赞同：2
> 
> 时间：2013-04-04T20:45:59.137
> 
> 标签：xcode, refactoring, shortcut

有谁知道 xcode 中是否有一种快捷方式可以突出显示 .m 文件中的方法并自动将其复制到 .h 文件中（从而将其公开）？

目前必须复制每种方法是一件很麻烦的事。上网查了一下，没找到，所以想来这里看看。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:53:37.427

Xcode 没有内置这个快捷方式——一般来说，其他 IDE 提供的许多更高级的重构功能是 Xcode 所缺乏的。如果您有问题，我强烈建议您[提交 Radar](https://bugreport.apple.com)（然后在[Open Radar](http://openradar.appspot.com/)上发布以供他人欺骗）。

不过，目前[JetBrains 的 AppCode](http://www.jetbrains.com/objc/)提供了此功能以及其他一些重构技巧。

# mysql - 在日期/时间范围之间选择数据

> ID：15821379
> 
> 赞同：93
> 
> 时间：2013-04-04T20:46:11.620
> 
> 标签：mysql, datetime

如何在 MySQL 中的日期范围之间选择数据。我的`datetime`专栏采用 24 小时祖鲁时间格式。

```
select * from hockey_stats 
where game_date between '11/3/2012 00:00:00' and '11/5/2012 23:59:00' 
order by game_date desc; 
```

尽管在这些时间段之间有数据，但不返回任何内容。我是否必须强制*“from”*和*“to”*字段中的值`datetime`输入查询？

* * *

## 回答 #1

> 赞同：160
> 
> 时间：2013-04-04T20:48:18.480

您需要更新日期格式：

```
select * from hockey_stats 
where game_date between '2012-03-11 00:00:00' and '2012-05-11 23:59:00' 
order by game_date desc; 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-04-04T20:49:33.607

这是使用日期函数的简单方法：

```
select *
from hockey_stats
where date(game_date) between date('2012-11-03') and date('2012-11-05')
order by game_date desc 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2017-08-08T21:01:50.747

**一个简单的方法：**

```
select  * from  hockey_stats 
where  game_date >= '2012-03-11' and game_date  <= '2012-05-11' 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-04T20:59:45.987

您可能需要使用[STR_TO_DATE](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)函数：

```
select * from hockey_stats 
where
  game_date between STR_TO_DATE('11/3/2012 00:00:00', '%c/%e/%Y %H:%i:%s')
                and STR_TO_DATE('11/5/2012 23:59:00', '%c/%e/%Y %H:%i:%s') 
order by game_date desc; 
```

（如果 game_date 是一个字符串，您可能需要在其上使用 STR_TO_DATE）

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2018-02-01T14:41:34.217

以一种简单的方式可以查询为

```
select * from hockey_stats 
where game_date between '2018-01-01' and '2018-01-31'; 
```

如果时间不是问题，这很有效。

考虑时间也遵循以下方式：

```
select * from hockey_stats where (game_date between '2018-02-05 01:20:00' and '2018-02-05 03:50:00'); 
```

请注意，这是针对 MySQL 服务器的。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2015-07-17T15:52:12.687

MySQL 日期格式是这样的：YMD。您正在使用 Y/M/D。那是错误的。修改您的查询。

如果您插入 Y/M/D 等日期，它将在数据库中插入空值。

如果您使用的是 PHP 并且您从表单中获取的日期是这样的 Y/M/D，您可以使用语句替换它。

```
out_date=date('Y-m-d', strtotime(str_replace('/', '-', $data["input_date"]))) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2018-02-23T16:33:21.227

您可以使用[STR_TO_DATE](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_str-to-date)函数并根据您发布的格式传递您自己的日期参数：

```
select * from hockey_stats where game_date 
  between STR_TO_DATE('11/3/2012 00:00:00', '%c/%e/%Y %H:%i:%s')
  and STR_TO_DATE('11/5/2012 23:59:00', '%c/%e/%Y %H:%i:%s') 
order by game_date desc; 
```

或者只使用 MySQL 处理日期的格式 YYYY:MM:DD HH:mm:SS 并将查询设置为

`select * from hockey_stats where game_date between '2012-03-11 00:00:00' and'2012-05-11 23:59:00' order by game_date desc;`

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2018-06-19T14:21:20.853

您必须搜索日期保护您如何在数据库中插入该 game_date 数据。例如，如果您在长日期或短日期上插入日期值。

```
SELECT * FROM hockey_stats WHERE game_date >= "6/11/2018" AND game_date <= "6/17/2018" 
```

您还可以使用*BETWEEN*：

```
SELECT * FROM hockey_stats WHERE game_date BETWEEN "6/11/2018" AND "6/17/2018" 
```

就那么简单。

# com - Windows XP SP3 上的错误 0x800706F7“存根收到错误数据”

> ID：15821387
> 
> 赞同：5
> 
> 时间：2013-04-04T20:46:43.987
> 
> 标签：com, vb6, windows-xp, ada, windows-xp-sp3

在我的 VB6 应用程序中，我多次调用我的团队从 Ada 项目（使用 GNATCOM）创建的 COM 服务器。COM 服务器上基本上有 2 种可用的方法。他们在 VB 中的原型是：

```
Sub PutParam(Param As Parameter_Type, Value)
Function GetParam(Param As Parameter_Type) 
```

其中**Parameter_Type**是一个枚举类型，它区分了我可以从 COM 服务器输入/获取的许多参数，而“Value”是一个**Variant**类型变量。PutParam() 接收一个变体，GetParam() 返回一个变体。（我真的不知道为什么在 VB6 对象浏览器中没有对 COM 服务器接口上的 Variant 类型的引用......）。

该项目的产品多年来一直以这种方式连续使用，在装有 Windows XP SP2 的计算机上，此界面没有任何问题。在装有 WinXP SP3 的计算机上，当尝试将参数设置为“长”类型时，我们会收到错误 0x800706F7“存根收到错误数据”。

有没有人知道可能导致这种情况的原因？COM 服务器仍在使用 SP2 的系统中构建。在带有 SP3 的系统上构建它应该有什么不同吗？（就像我们在 X64 系统中为 X64 构建时一样）。

导致问题的调用之一如下（更改了一些 var 名称）：

```
Dim StructData As StructData_Type

StructData.FirstLong = 1234567
StructData.SecondLong = 8901234
StructData.Status = True

ComServer.PutParam(StructDataParamType, StructData) 
```

其中 StructData_Type 的定义是：

```
Type StructData_Type
    FirstLong As Long
    SecondLong As Long
    Status As Boolean
End Type 
```

（以下已在问题首次发布后添加）

IDL中COM服务器接口的原语调用定义如下：

```
// Service to receive data
HRESULT PutParam([in] Parameter_Type Param, [in] VARIANT *Value);

//Service to send requested data
HRESULT GetParam([in] Parameter_Type Param, [out, retval] VARIANT *Value); 
```

我试图通过的结构的定义是：

```
struct StructData_Type
{
   int FirstLong;
   int SecondLong;
   VARIANT_BOOL Status;
} StructData_Type; 
```

我发现奇怪的是，这里的定义使用“int”作为 FirstLong 和 SeconLong 的类型，当我检查 VB6 对象资源管理器时，它们的类型是“Long”。顺便说一句，当我从 COM 服务器中提取 IDL（使用特定实用程序）时，这些参数被定义为 Long。

**更新：**

我已经使用为 Windows 7 编译的 COM 服务器版本（不同版本的 GNAT，相同的 GNATCOM 版本）测试了相同的代码，它可以工作！我真的不知道这里发生了什么。我将继续尝试找出 WinXP SP3 上的问题，但很高兴知道它在 Win7 上有效。如果您有类似的问题，最好尝试迁移到 Win7。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-10T09:49:24.493

我将重点解释错误的含义，问题中的提示太少，无法提供简单的答案。

当您跨执行边界进行调用时，在 COM 中使用“存根”。问题中没有明确说明，但您的 Ada 程序可能是 EXE 并实现了进程外 COM 服务器。在 Windows 中跨越进程之间的边界是很困难的，因为它们具有很强的隔离性。这是在 Windows 中通过 RPC（远程过程调用）来完成的，这是一种用于跨边界进行调用的协议，典型的例子是网络。

要进行 RPC 调用，必须将函数的参数序列化为网络数据包。COM 不知道如何做到这一点，因为它对函数的实际参数知之甚少，它需要*代理*的帮助。一段*确实*知道参数类型是什么的代码。在接收端是一段非常相似的代码，它的作用与代理的作用完全相反。它反序列化参数并进行内部调用。这是存根。

这可能失败的一种方法是当存根接收到网络数据包并且它包含比函数参数值所需的数据更多或更少的数据时。显然，它不知道如何处理该数据包，没有明智的方法将其转换为 StructData_Type 值，并且它将因“存根收到错误数据”错误而失败。

所以要考虑的这个错误的第一个解释是 DLL Hell 问题。代理和存根之间不匹配。如果这个应用程序已经稳定了很长时间，那么这不是一个令人愉快的解释。

您的代码片段的另一个方面可能会导致此问题。结构是软件中非常麻烦的野兽，它们的成员是*对齐的*到它们的自然存储边界和对齐规则由各自的编译器解释。您引用的结构肯定就是这种情况。它需要 10 个字节来存储字段，4 + 4 + 2 并且它们自然对齐。但该结构实际​​上是 12 字节长。最后填充两个字节以确保当结构存储在数组中时整数仍然对齐。这也使 COM 的工作变得非常困难，因为 COM 隐藏了实现细节并且结构对齐是一个巨大的细节。它需要帮助来复制一个结构，即 IRecordInfo 接口的工作。当找不到该接口的实现时，存根也会失败。

我将谈谈代理、存根和IRecordInfo。生成代理/存根对有两种基本方式。一种方法是用一种称为 IDL（接口描述语言）的语言来描述接口，然后用 MIDL 编译它。该编译器能够自动生成代理/存根代码，因为它知道函数参数类型。您将获得一个需要在客户端和服务器上注册的 DLL。您的服务器可能正在使用它，我不知道。

第二种方式是 VB6 使用的，它利用了内置于 Windows 中的通用代理。称为 FactoryBuffer，其 CLSID 为 {00000320-0000-0000-C000-000000000046}。它通过使用类型库来工作。类型库是 COM 服务器中函数的机器可读描述，足以让 FactoryBuffer 弄清楚如何序列化函数参数。这个类型库也是提供 IRecordInfo 需要了解结构成员如何对齐的信息的类型库。我不知道它在服务器端是如何完成的，以前从未听说过 GNATCOM。

所以对这个问题的一个强有力的解释是你的类型库有问题。在 VB6 中尤其棘手，因为您无法直接控制它使用的 guid。当您进行微不足道的更改时，它喜欢生成新的，避免它的唯一方法是选择二进制兼容性选项。它使用类型库的旧副本，并尝试使新副本尽可能兼容。如果您没有打开该选项，那么确实会遇到麻烦，尤其是对于结构的指导。Kaboom 如果它发生了变化并且另一端仍在使用旧的 guid。

只是一些关于从哪里开始寻找的提示。不要以为这是 SP3 引起的问题，这个 COM 基础结构已经很长时间没有改变了。但是由于安装了新的操作系统版本并且必须重新注册所有内容，因此肯定会出现这种问题。SysInternals 的 ProcMon 是一个很好的实用程序，可以查看程序使用注册表来查找代理、存根和类型库。而且您肯定会从 COM Spy 类型的实用程序中获得帮助，尽管这些天很难找到它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T12:29:01.777

我还建议问题是由于您的结构中的填充问题。我不知道您是否可以使用#pragma 来控制它，但可能值得查看您的文档。

我认为尝试修补您的结构是个好主意，以便生成的类型库结构是四（或八）的倍数。您的 Status 成员占用 2 个字节，所以也许您应该在 Status 之前或之后插入一个相同类型的虚拟值 - 这应该使它达到 12 个字节（如果打包到 8 个字节，这必须是三个虚拟变量） .

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-09T13:46:53.417

如果它突然停止在 XP 上愉快地工作，我要寻找的第一个罪魁祸首是类型不匹配。此类系统上的“long”现在可能是 64 位，而您的 Ada COM 代码（和/或您的 C int）可能需要 32 位。对于传统编译的系统，编译器会为您检查这一点，但是您使用 COM 的额外间接性使这变得困难。

您在那里写的关于“当我们为 64 位系统编译时”的内容让我特别怀疑。你知道，64 位编译可能会改变许多 C 类型的大小。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-10T08:52:12.117

This [Related Post](https://stackoverflow.com/questions/65097/windows-server-2008-com-error-0x800706f7-the-stub-received-bad-data?rq=1)建议您需要在结构中进行填充，因为编组代码可能需要比您实际发送的数据更多的数据（当然，这是一个错误）。您的结构包含 9 个字节（假设每个 ints/long 有 4 个字节，布尔值有 1 个字节）。尝试添加填充，以便您的结构包含 4 个字节的倍数（或者，如果失败，则为 8 的倍数，因为帖子的预期大小不清楚）

# jquery - 切换复选框状态更改的文本

> ID：15821388
> 
> 赞同：0
> 
> 时间：2013-04-04T20:46:46.923
> 
> 标签：jquery, toggle

我不想做任何花哨的事情......只是希望“noshowuntilchangevelocity”类的内容在特定复选框状态更改时在显示和隐藏之间切换。

```
$(document).ready(function()
    {

     $("input#velocity").change(function()
        {
            $('#noshowuntilchangevelocity').toggle();
        });

 });
<input id="velocity" name="velocity" type="checkbox"value="Y" checked>
<div id="noshowuntilchangevelocity"style="display: hidden;">
<p class="bolder">You are changing this selection</p>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T20:02:54.327

我想我会回过头来解释这个问题，因为每个人的答案和我的原始代码都运行良好。结果我两次包含引导文件 - 一次在模式中，一次在原始页面中。一旦我把它拉出来，它就恢复了行为:)

感谢大家的帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:49:26.030

我认为你有两个小错误：

*   您需要在`id="noshowuntilchangevelocity"`和之间添加一个空格`style="display:none;"`
*   你需要使用`display:none;`而不是`display:hidden;`

这是一个正确的版本：

```
<input id="velocity" name="velocity" type="checkbox" value="Y" checked>
<div id="noshowuntilchangevelocity" style="display: none;">
    <p class="bolder">You are changing this selection</p>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:50:31.740

```
$(document).ready(function()
    {
    $('#noshowuntilchangevelocity').hide()
     $("input#velocity").change(function()
        {
            $('#noshowuntilchangevelocity').toggle();
        });

 });
<input id="velocity" name="velocity" type="checkbox" value="Y" checked>
<div id="noshowuntilchangevelocity">
    <p class="bolder">You are changing this selection</p>
</div> 
```

或者史蒂夫的解决方案也很好用。

# python - 按值Python对元组列表进行排序

> ID：15821390
> 
> 赞同：-3
> 
> 时间：2013-04-04T20:46:49.200
> 
> 标签：python

我有一个元组列表作为示例：

```
result = [(1, 6.06), (2, 6.23), (3, 7.03), (4, 6.88), (5, 6.43), (6, 6.57)] 
```

如何按值按降序对列表进行排序？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:48:05.563

大概是这样的：

```
result.sort(key=lambda x:x[1],reverse=True) 
```

或者有些人更喜欢

```
from operator import itemgetter
result.sort(key=itemgetter(1),reverse=True) 
```

...

或者也许只是：

```
result.sort(reverse=True) 
```

取决于你的意思`value`。

如果您不想就地对列表进行排序，则始终可以`sorted`以几乎相同的方式使用。当然，如何在 python 中排序的规范指南可以在以下链接中找到：[“Sorting Mini-HOW TO”](http://wiki.python.org/moin/HowTo/Sorting/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:51:11.313

与其他答案类似，但`lambda`您可以使用[`operator.itemgetter(1)`](http://docs.python.org/2/library/operator.html#operator.itemgetter)：

```
from operator import itemgetter
result.sort(key=itemgetter(1), reverse=True) 
```

# javascript - 从输入字段中获取值并存储到变量或 asp 标签控件中

> ID：15821393
> 
> 赞同：-1
> 
> 时间：2013-04-04T20:47:05.950
> 
> 标签：javascript, jquery, asp.net, jquery-ui

我需要从使用 jquery 日期选择器的输入字段中获取值并将其存储到变量或 ASP 控件中。实现这一目标的最佳方法是什么？

这是 aspx 文件的代码部分：

```
<asp:Panel ID="AppointmentPNL" runat="server" GroupingText="Appointments" CssClass="module">
                    <table>
                        <tr>
                            <td>
                                <asp:Label ID="ScheduleLBL" runat="server">Appointment Date:</asp:Label>
                            </td>
                            <td>
                                <input type="text" id="datepicker" />
                                <asp:TextBox ID="ScheduleTXT" runat="server" Visible="False"></asp:TextBox>
                                <asp:RegularExpressionValidator ID="ScheduleDateRV" runat="server" 
                                    ErrorMessage="Date format incorrect." Display="Dynamic" 
                                    ValidationGroup="Schedule" 
                                    ValidationExpression="((^(10|12|0?[13578])([/])(3[01]|[12][0-9]|0?[1-9])([/])((1[8-9]\d{2})|([2-9]\d{3}))$)|(^(11|0?[469])([/])(30|[12][0-9]|0?[1-9])([/])((1[8-9]\d{2})|([2-9]\d{3}))$)|(^(0?2)([/])(2[0-8]|1[0-9]|0?[1-9])([/])((1[8-9]\d{2})|([2-9]\d{3}))$)|(^(0?2)([/])(29)([/])([2468][048]00)$)|(^(0?2)([/])(29)([/])([3579][26]00)$)|(^(0?2)([/])(29)([/])(1[89][0][48])$)|(^(0?2)([/])(29)([/])([2-9][0-9][0][48])$)|(^(0?2)([/])(29)([/])(1[89][2468][048])$)|(^(0?2)([/])(29)([/])([2-9][0-9][2468][048])$)|(^(0?2)([/])(29)([/])(1[89][13579][26])$)|(^(0?2)([/])(29)([/])([2-9][0-9][13579][26])$))" 
                                    ControlToValidate="ScheduleTXT"></asp:RegularExpressionValidator>
                            </td>
                            <td>
                                <asp:Button ID="ScheduleBTN" runat="server" Text="Schedule" CssClass="submitButton"
                                    OnClick="ScheduleBTN_Click" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <asp:Label ID="ScheduleStatusLBL" runat="server">Appointment Status:</asp:Label>
                            </td>
                            <td>
                                <asp:Button ID="AppointmentCompletedBTN" runat="server" Text="Complete" 
                                    CssClass="submitButton" onclick="AppointmentCompletedBTN_Click" />
                                <asp:Button ID="NoShowBTN" runat="server" Text="No Show" 
                                    CssClass="submitButton" onclick="NoShowBTN_Click" />
                            </td>

                        </tr>
                    </table>
                </asp:Panel> 
```

这是将值从文本框存储到数据库的代码：

```
UpdateArchProcSDS.UpdateParameters["ScheduledCall"].DefaultValue = ScheduleTXT.Text; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T20:57:51.223

像这样的东西

```
<input type="text" name="datepicker" id="datepicker" /> 
```

然后你可以像这样得到它

```
Request.Form["datepicker"] 
```

或者，如果您使用的是`runat="server"`属性，`input`那么您可以简单地使用它的 Id 获取

```
<input type="text" name="datepicker" id="datepicker" runat="server" clientidmode="Static"/> 
```

背后的代码

```
string value = datepicker.Value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:02:34.683

我知道的最好方法是执行以下操作：

在 head 标记中使用正确的 jquery js 引用将其也放在头部：

```
<script type="text/javascript">

    $(function () {
        $("#<%=datepicker.ClientID %>").datepicker();
    });

</script> 
```

将文本框控件添加到页面：

```
<asp:TextBox ID="datepicker" runat="server"> 
```

就是这样。当您单击文本框时，它将显示日历，选择后将在文本框中显示值。

如果需要获取文本框的值：

```
function GetValue()
{
  var selectedDate = $("#<%= datepicker.ClientID %>").val();
} 
```

希望这可以帮助！

# ios - iOS 和 Maps：如何拦截触摸手势、获取坐标和检索国家名称

> ID：15821395
> 
> 赞同：2
> 
> 时间：2013-04-04T20:47:08.700
> 
> 标签：ios, mapkit, google-maps-sdk-ios, mkreversegeocoder, mapbox

我正在开发一个游戏，用户必须在世界地图上选择一个国家。

我因此想知道：

1.  显示交互式地图的最佳方法是什么？[我在 Web http://mousebird.github.com/WhirlyGlobe/](http://mousebird.github.com/WhirlyGlobe/)上找到了这个框架/组件，但我也在评估 MapKit、MapBox 和 Google Maps 框架。根据您的意见和您自己的经验，最好的选择是什么？

2.  给定一些 GPS 坐标，我如何检索国家名称？（我只对国名感兴趣，仅此而已）

3.  是否有实现此类应用程序的示例代码或教程？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T10:50:13.710

在适用于 iOS 的 Google Map SDK 中，您必须尝试使用​​此委托方法。

它为您提供用户点击的坐标。

```
- (void)mapView:(GMSMapView *)mapView
didTapAtCoordinate:(CLLocationCoordinate2D)coordinate
{
    NSLog(@"You tapped at %f,%f", coordinate.latitude, coordinate.longitude);
} 
```

通过这个特定的坐标，您可以找到国家。

我想你必须[检查一下](http://jonathanfield.me/jons-blog/clgeocoder-example.html)。它会帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:12:03.343

您还应该查看 MapBox。iOS SDK 支持完整的、可配置的交互性。有一个示例应用程序用于将点击转换为所点击国家/地区的名称/国旗。

[https://github.com/mapbox/mapbox-ios-example](https://github.com/mapbox/mapbox-ios-example)

# ios - 为什么 TabBarControl 的 NavBar 在页面大小时出现剪切？

> ID：15821396
> 
> 赞同：0
> 
> 时间：2013-04-04T20:47:15.467
> 
> 标签：ios, xcode, ipad, uitabbarcontroller

当我将 a 显示`UITabBarController`为具有`PageSheet`大小的模态时，`NavBar`会在中间出现水平切割。

重现步骤：

1.  创建一个新项目（`iPad`）；
2.  把一个`UITabBarController`和另外两个`ViewControllers`放在`Storyboard`;
3.  将`UITabBarController's`大小设置为`Page Sheet`;
4.  将`UITabBarController`两者联系起来`ViewControllers`；
5.  在 main 中添加一个按钮`ViewController`，然后添加一个动作以打开`UITabBarController`模态；
6.  在 ladscape 模式下启动应用程序，然后点击按钮打开`UITabBarController`；
7.  旋转设备并触摸 中的项目`UITabBarController`。

我已经向 Apple 提交了关于此问题的错误。

测试项目在这里： [项目示例](http://www.siteecia.net/temp/ios/test.zip)

和截图： ![截屏](https://i.stack.imgur.com/ZPJqg.png)

*我还做了一个视频：[youtube video](http://youtu.be/IQweu5QbLoc)

# perl - 将参数传递给脚本，得到：“使用未初始化的值 $ARGV[0]”

> ID：15821397
> 
> 赞同：5
> 
> 时间：2013-04-04T20:47:16.910
> 
> 标签：perl, argv

**问题：** Windows XP 没有将命令行参数传递给 perl 脚本。

**症状：**一个简单的命令，如：

```
say "Argument 1 (\$ARGV[0]) is: $ARGV[0], argument 2 (\$ARGV[1]) is: $ARGV[1]."; 
```

结果：

```
Use of uninitialized value $ARGV[0] in concatenation (.) or string at... 
```

**解决方案：**

根本问题出在 Windows XP 中。启动 perl 的默认方法只传递第一个变量，即脚本名称。结果是 $ARGV[0] 未初始化。

修复方法是在以下位置编辑 Windows 注册表：

```
\HKEY_CLASSES_ROOT\Perl\shell\Open\command 
```

并输入：

```
"C:\Perl\bin\perl.exe"  %* 
```

结果是：

```
C:\whatever>perl argtest.pl 1 2
Argument 1 ($ARGV[0]) is: 1, argument 2 ($ARGV[1]) is: 2. 
```

特别感谢 David W，他为我指明了正确的方向。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:03:15.950

请注意， Perl 与C 中`@ARGV`的不太一样。`argv`

```
 C          Perl

Name of the program        argv[0]        $0
1st argument               argv[1]      $ARGV[0]
2nd argument               argv[2]      $ARGV[1]
n-th argument              argv[n]      $ARGV[n-1] 
```

因此，如果您向 Perl 脚本提供一个命令行参数，它将在`$ARGV[0]`. `$ARGV[1]`将未初始化。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:31:27.053

Windows 知道它应该使用 Perl 执行程序的方式有两种。

1.  命令行以 perl 可执行文件开头，要运行的脚本的名称作为命令行参数提供。这也是它在 Unix 和其他环境中的工作方式。
2.  您的系统将一个或多个扩展名（例如 、 和/或）与 Perl 应用程序相关联`.pl`，`.pm`当`.cgi`您在 Windows 资源管理器中键入具有这些扩展名之一的文件名或单击具有这些扩展名之一的文件时，Windows 将启动 Perl。

您已经简单地调用了您的脚本

```
argtest 1 2 
```

而不是其中之一

```
perl argtest 1 2
argtest.pl 1 2 
```

这让我觉得 Perl 不是第一个查看`argtest`. 可能有一个文件叫做`argtest.bat`或者`argtest.exe`它的任务是让 Perl 运行你的 Perl 代码。由于某种原因，这个中间程序没有将您提供的命令行参数传递给 Perl 应用程序。

提供此中间文件的代码，我们可以提供更多帮助。

* * *

**更新：** David W 提出了第三种方法——将`PATHEXT`环境变量设置为包含文件并从命令行`.pl`调用——请参阅他的答案。`argtest`然后，如果 Window 与扩展名的文件关联`.pl`被搞砸了，比如说，设置为`C:\Dwimperl\perl\bin\perl`“而不是”，`C:\Dwimperl\perl\binperl %*`那么 OP 就会得到他描述的行为。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T23:09:24.347

下载[Cygwin](http://www.cygwin.com/)并在 Cygwin 环境中测试您的代码。我敢打赌这是一个 Windows 问题。（如果您是 Unix 负责人，您会喜欢 Cygwin，因为它在您的 Windows 机器上为您提供了类似 Unix/Linux 的环境。没有它我不会使用 Windows。）

Windows 使用后缀来确定哪些程序打开了哪些文件。你的 Perl 脚本是`argtest`,`argtest.bat`还是`argtest.pl`?

在 Windows 上，确保所有 Perl 脚本都使用该`*.pl`后缀，因此 Windows 将使用任何 Perl 参数来执行它们。Windows 不使用[shebang](http://en.wikipedia.org/wiki/Shebang_%28Unix%29)。

另一个可能的问题：在 Windows XP 上，我遇到了带有参数的 Perl 脚本的问题，因为 Windows 将其作为执行字符串：

```
 perl %1 
```

这将使用我的脚本执行 Perl 程序，但忽略参数。我不得不将其更改为：

```
 perl %* 
```

不幸的是，Windows Vista 到 Windows 8 改变了这种设置方式。但是，我有 Windows 7 并且没有这个问题。我确实确保安装 Perl，`C:\Perl`而不是`C:\Program Files\Perl`因为目录名称中的空格。我还安装了草莓 Perl。

有一个特殊的 Windows 环境变量称为`PATHEXT`. 这允许您输入`foo`而不是`foo.pl`. 如果 Windows 看不到如何执行您的文件，Windows 会检查`%PATHEXT`并尝试附加各种后缀，直到找到一个有效的后缀。您可能希望附加`.PL`到该环境变量，因此您可以输入`foo`而不是`foo.pl`一直输入。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T20:52:02.640

在`perl`文件名中不是参数数组的一部分。至少在我做的测试中，你必须删除`ARGV[2]`或传递三个参数，比如`argtest 1 2 3`

# c++ - 是否可以创建 *CCAnimation 对象的 std::map ？

> ID：15821398
> 
> 赞同：1
> 
> 时间：2013-04-04T20:47:22.253
> 
> 标签：c++, cocos2d-iphone

在我创建它们的那一刻，它们似乎都自动释放了 =s

```
void SceneView::createAnimation(KillerRabbit* killerRabbit, std::string animation) {
    CCArray* animFrames = CCArray::createWithCapacity(15);
    int first = std::stoi(killerRabbit->spriteSheetMap[animation]["FIRST"]);
    int last = std::stoi(killerRabbit->spriteSheetMap[animation]["LAST"]);
    char str[100] = {0};
    for (int i = first; i <= last; i++) {
        // Obtain frames by alias name
        sprintf(str, (killerRabbit->spriteSheetMap[animation]["KEY"]+"[%d].png").c_str(), i);
        CCSpriteFrame* frame = sharedSpriteFrameCache->spriteFrameByName(str);
        animFrames->addObject(frame);
    }

    spriteAnimationsMap[killerRabbit->spriteName][animation] = CCAnimation::createWithSpriteFrames(animFrames, 0.1f);
    // 14 frames * 1sec = 14 seconds
    rabbitSprites[killerRabbit->spriteName][animation]->
    runAction(CCRepeatForever::create(CCAnimate::create(spriteAnimationsMap[killerRabbit->spriteName][animation])));
} 
```

如果我省略这部分代码：

```
rabbitSprites[killerRabbit->spriteName][animation]->
runAction(CCRepeatForever::create(CCAnimate::create(spriteAnimationsMap[killerRabbit->spriteName][animation]))); 
```

并尝试访问对象：

```
spriteAnimationsMap[killerRabbit->spriteName][animation] 
```

在使用另一种方法的代码的后面部分中，该地图内的对象将被自动释放，我如何保留它以便以后可以使用存储在其中的不同动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:45:36.053

哦，愚蠢的我，我不得不这样做：

```
spriteAnimationsMap[killerRabbit->spriteName][animation]->retain(); 
```

# jdbc - MysqlConnectionPoolDataSource 或 c3p0 之类的库？

> ID：15821399
> 
> 赞同：5
> 
> 时间：2013-04-04T20:47:23.147
> 
> 标签：jdbc, connection-pooling, c3p0, apache-commons-dbcp, bonecp

MysqlConnectionPoolDataSource 和 C3p0、BoneCP 或 dbcp 库用于连接池有什么区别？如果 mysql 连接器提供连接池，我不明白为什么要使用库。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T07:51:51.083

A`ConnectionPoolDataSource`不是连接池（或至少：它不应该是），它旨在供提供池的 a 使用**（**`DataSource`例如，来自应用程序服务器）。A`ConnectionPoolDataSource`提供将保存在连接池中的物理连接。除了创建这些物理连接之外，`ConnectionPoolDataSource`不应该做任何其他事情。

因此，如果您在应用程序服务器中工作，请使用应用程序服务器提供的池`DataSource`。如果您在一个独立的应用程序或不自己提供数据源的服务器中，请使用第三方连接池，如 BoneCP、c3p0 或 Apache DBCP。如果 MySQL 还提供了一个`DataSource`提供池的法线，那么您可以使用它。

# javascript - 多个 input.files 上的 jQuery 循环

> ID：15821402
> 
> 赞同：7
> 
> 时间：2013-04-04T20:47:32.223
> 
> 标签：javascript, jquery

我需要在多文件输入上循环这个：

```
 var reader = new FileReader();

    reader.onload = function (e) {
        $('#pprev_0')
        .attr('src', e.target.result);
    };

    reader.readAsDataURL(input.files[0]); 
```

我试过这个，但它不起作用：

```
var fileCount = 0;
$("input[name='files[]']").each(function() {

    var reader = new FileReader();

    reader.onload = function (e) {
        $('#pprev_'+fileCount)
        .attr('src', e.target.result)
        .css("display","block");
    };

    reader.readAsDataURL(input.files[fileCount]);

    fileCount++;
}); 
```

fileCount 输出上的 alert() 是多个文件选择的一次性 0。没有进一步的警报。如果我在代码中使用数字而不是 fileCount var，它会在位置上工作。rg input.files[2] ...

任何的想法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-04T21:30:55.293

当你这样做时：`$("input[name='files[]']").each(function() {`你实际上得到了与选择器匹配的任何元素。在这种情况下，您将获得单个多文件输入（这就是为什么您只看到 1 个警报的原因。您想要做的是遍历文件。

这个页面的代码几乎完全符合您的要求。我建议你检查一下：

[http://www.html5rocks.com/en/tutorials/file/dndfiles/](http://www.html5rocks.com/en/tutorials/file/dndfiles/)

要将其应用于您的情况，您可以执行以下操作：

```
var files = $('#files')[0].files; //where files would be the id of your multi file input
//or use document.getElementById('files').files;

for (var i = 0, f; f = files[i]; i++) {

    var reader = new FileReader();

    reader.onload = function (e) {
        $('#pprev_'+fileCount)
        .attr('src', e.target.result)
        .css("display","block");
    };

    reader.readAsDataURL(f);

} 
```

# angularjs - Angularjs 路由具有未更改的数据，避免为该路由的控制器重新渲染模板？

> ID：15821406
> 
> 赞同：1
> 
> 时间：2013-04-04T20:47:52.757
> 
> 标签：angularjs, angularjs-service, angularjs-routing

如果我正在更改路由，并且该路由的数据没有更改，我可以避免为该路由的控制器重新渲染我的模板吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-30T19:42:37.310

谢谢斯图。我认为我不需要 ui-router。我认为我的问题不够简单（我刚刚简化了）-对此感到抱歉，再次感谢您的回答。

我实际上可以使用重新加载搜索功能。这确实需要我更改我的网址，这并不理想，但这是一个可以接受的折衷方案，可以轻松获得我想要的东西：

请参阅：[您可以在不重新加载 AngularJS 中的控制器的情况下更改路径吗？](https://stackoverflow.com/questions/14974271/can-you-change-a-path-without-reloading-the-controller-in-angularjs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-29T19:21:41.063

> 1）如果我正在更改路由，并且该路由的数据没有更改，我可以避免为该路由的控制器重新渲染我的模板吗？

我无法完全了解您的用例的所有细节，但您可能想查看[ui-router](http://github.com/angular-ui/ui-router "ui路由器")。每个状态可以有嵌套状态（美化路线）和多个视图（模板），这可能有助于避免重新加载页面的某些部分。

# java - 泛型类缺少类型参数 其中 T 是类型变量

> ID：15821407
> 
> 赞同：10
> 
> 时间：2013-04-04T20:47:53.613
> 
> 标签：java, generics, java-7

我使用 Oracle JDK 7，当我构建项目时，我收到了这条消息：

```
missing type arguments for generic class Class<T> where T is a type-variable: 
T extends Object declared in class Class 
```

这是课程：

```
public class Among {
private static final Class<?>[] EMPTY_PARAMS = new Class[0]; //warning line 
```

任何想法如何解决它。它在很多地方使用，我有很多警告。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-04T20:51:06.533

```
private static final Class<?>[] EMPTY_PARAMS = new Class<?>[0]; 
```

注意`<?>`数组的实例化。

# c++ - C++ 到 MIPS - if 语句的小问题

> ID：15821416
> 
> 赞同：0
> 
> 时间：2013-04-04T20:48:36.163
> 
> 标签：c++, mips

**C++程序：**

```
 int main()
{
   char string[256];
   int i=0;
   char *result = NULL;  // NULL pointer 

   // Obtain string from user
   scanf("%255s", string);

   // Search string for letter t.
   // Result is pointer to first t (if it exists)
   // or NULL pointer if it does not exist
   while(string[i] != '\0')
   {
      if(string[i] == 't')
      {
         result = &string[i]; 
         break; // exit from while loop early
      }
      i++;
   }

   if(result != NULL)
      printf("Matching character is %c\n", *result);
   else
      printf("No match found\n");
} 
```

**我拥有的 MIPS 代码：**

```
 .globl main

        .text 

# main 
main:

        li $v0,4                # Load value 4 
        la $a0, msg0            # Load array
        syscall                 

        li $v0,8                # Load value 8
        la $a0,string           # Load array
        syscall                 # Syscall

        li $v0,4                # Load immediate value 4 
        la $a0, string          # Load array
        syscall                 # Syscall

        la $t0, string          # array    
        la $t1, result          # array
        lb $t2, result          # array

while:
        lb $t3, 0($t0)          
        beq $t3, $0, if2        # if !=0
        beq $t3, 't', if        # If = "t"
        addi $t0, $t0,1         # i++

        j while                 # Jump to While

if:
        sw $t3, result          # Save result to memory
        li $v0,4                # Load value 4 
        la $a0, found           # Load array
        syscall                 # Syscall
        j exit

        j if2                   # Jump to if2

if2:

        li $v0,4                # Load value 4 
        la $a0, notfound        # Load array
        syscall                 # Syscall
        j exit

exit: 

        li $v0, 10
        syscall # Exit

        .data
        msg0: .asciiz "Enter Word: "
        string: .byte 0:256
        i: .word 0
        result: .word 0
        found: .asciiz "Found!"
        notfound: .asciiz "Not Found" 
```

我编写的 MIPS 代码似乎可以工作，但我认为它没有遵循上面的 C++ 代码结构。我还认为我用 if 语句搞砸了一些东西，但不知道是什么以及如何解决它。有什么建议可以改进吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:22:27.180

我认为 mips 代码非常接近 C 代码。主要区别在于它实际上将函数末尾的测试内联到分支中以优化分支。虽然循环在汇编中看起来不直观。它们通常被编译成看起来更像：

```
if(test) {
    do {
         body;
    } while(test);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T06:33:16.010

就像@user2229152 所说，您已经删除了最后的检查 ( `if(result != NULL)`) 并将打印移动到您的`if`和`if2`块。

所以你的汇编代码基本上对应于：

```
while(string[i] != '\0')
{
   if(string[i] != 't')
   {
      i++;
   } else
   {
      result = &string[i]; 
      printf("Found!");
      goto exit;
   }
}

printf("Not found");

exit: 
```

# arrays - 如何计算数组中自然数范围之间重复数字的数量

> ID：15821418
> 
> 赞同：1
> 
> 时间：2013-04-04T20:48:40.023
> 
> 标签：arrays, matlab, repeat

我有一个排序（上升趋势）数组作为

```
[1 1 1 1 1 1.2 1.6 2 2 2 2.4 2.4 2.4 2.6 3 3.5 3.6 3.8 3.9 4 4.3 4.3 4.6 5 5.02 6 7] 
```

我想检查并打印每个“自然数”之间的重复数字的数量。

例如：

1到2之间：0（不重复）

在 2 和 3 之间：3 与 2.4 重复

3 点到 4 点之间：0

4 到 5 之间：2 重复 4.3

5 点到 6 点之间：0

6 点到 7 点之间：0

MATLAB 中是否有任何函数可以执行此任务？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:55:22.293

您可以使用[`tabulate`](http://www.mathworks.com/help/stats/tabulate.html)，甚至不需要对数组进行排序。然后只需使用逻辑条件选择适当的元素。例如：

```
A=[1 1 1 1 1 1.2 1.6 2 2 2 2.4 2.4 2.4 2.6 3 3.5 3.6 3.8 3.9 4 4.3 4.3 4.6 5 5.02 6 7]
M=tabulate(A)                  % get frequency table
id1=mod(M(:,1),1)>0;           % get indices for non integer values
id2=M(:,2)>1;                  % get indices for more than one occurrence
idx=id1 & id2;                 % get indices that combines the two above
ans=[M(idx,1) , M(idx,2)]      % show value , # of repeats

ans =
    2.4000    3.0000
    4.3000    2.0000 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T08:32:51.553

另一种方法是使用`histc`. 因此，如果您的向量存储在一个 then

```
h = histc(a,a); % count how many times the number is there, the a should be sorted
natNumbers = (mod(a,1)==0) .* h;
nonnatNum = (mod(a,1)>0).*h;
indNN = find(natNumbers>0);
indNNN = find(nonNatNumbers>1);
resultIndex = sort([indNN indNNN]);
result = [a(resultIndex);h(resultIndex)] 
```

然后您可以通过检查自然数之间是否有任何数字来处理结果矩阵

# mysql - PHP，函数调用后出错

> ID：15821423
> 
> 赞同：-4
> 
> 时间：2013-04-04T20:48:52.443
> 
> 标签：mysql, php

今天我把我的网站搬到了新的虚拟主机上，然后

```
 Parse error: syntax error, unexpected '[' in /data/web/virtuals/41994/virtual/www/application/theme/admin-template/header.php on line 45 
```

我不知道，user::get('user_name')[0] 有什么问题，我在旧的虚拟主机上没有任何问题。我只想得到它的第一个字符（如果我使用 substr，我没有问题，但我有很多，我想知道为什么:)）

PS：与此类似的问题：

```
$test = mysql_fetch_array(mysql_query('SELECT test FROM test'))['test']; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T20:52:33.797

您可能正在使用 php 5.3。直到 5.4+ 才允许使用此语法。

改用这个：

```
$row = mysql_fetch_array(mysql_query('SELECT test FROM test'));
$test = $row['test']; 
```

忽略这个`mysql_query`洞......这是一个单独的问题。

# c# - 如何限制对 C# 中特定类的访问？

> ID：15821424
> 
> 赞同：1
> 
> 时间：2013-04-04T20:48:59.853
> 
> 标签：c#, proxy, internal

我有 2 个项目，一个网站和一个代理库 (dll)

代理项目有..

```
public class Client
{
}

public class Proxy
{
    public Client GetClient()
    {
        return new Client();
    }
} 
```

如何阻止网站创建新的 Client 实例但允许它创建 Proxy 实例并仍然运行 GetClient？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T20:52:22.667

您可以将客户端更改为：

```
internal class Client
{
} 
```

这样网站项目甚至看不到 Client 类，或者你可以这样做：

```
public class Client
{
   internal Client()
   {

   }
} 
```

这样网站可以看到它并与之交互，但实际上并不能构建实例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T20:53:06.920

1.  创建一个公共接口`IProxy`。确保它具有`Proxy`您希望公开的所有方面。

2.  有`Proxy`器`IProxy`。

3.  制作`Proxy` `internal`（甚至是私有的，以及 的嵌套类`Client`，如果适用）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T20:52:30.000

如果您不想创建新的 Client 实例，请考虑将 Client 设为静态或使用 Singleton 模式

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-04T20:53:36.800

您可以使用单例模式，也可以`internal`在 Client 类中声明构造函数

# variables - 来自用户定义的 GUI 的全局

> ID：15821425
> 
> 赞同：0
> 
> 时间：2013-04-04T20:49:05.337
> 
> 标签：variables, user-interface, global, maya

所以我认为我的问题是我对全局变量和子程序的理解。加上开头的列表这是我的代码：

[https://gist.github.com/anonymous/ff1b16aa4093a2929896](https://gist.github.com/anonymous/ff1b16aa4093a2929896)

如果我将它放入 Maya 中，突出显示它并按下播放图标。它可以工作并且 GUI 会打开，我可以从 GUI 运行整个过程。但是，如果我保存它并尝试将其作为模块导入，它就无法正常工作并且重置按钮消失，我得到了这个：

# NameError: 未定义全局名称“Reset”#

编辑：我会将 Reset 放在变量中，但出于某种原因，出于该过程。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T22:05:31.223

查看[optionVar](http://download.autodesk.com/us/maya/2011help/Commands/optionVar.html)命令。

一般来说，Maya 的整个用户界面都是开源的。如果您想知道某些东西是如何工作的，您可以简单地找到实现它的脚本。也尽量不要避免学习 MEL。

# django - Django 在未来的某个时间发送信号

> ID：15821428
> 
> 赞同：0
> 
> 时间：2013-04-04T20:49:14.433
> 
> 标签：django, django-models, scheduled-tasks, crontab, django-signals

我有一个需要`expires_at`时间场的模型。从某种意义上说，用户可以设置条目无效的时间。那时，我需要执行特定的操作，例如发送电子邮件和/或更改模型中的参数。

具体来说，假设我有一个模型：

```
class SomeModel(models.Model):
    ... #Code here ...
    expires_at = models.DateTimeField() 
```

现在，当模型被保存时，字段中将设置一个时间`expires_at`，即未来的某个时间。当这个时间发生时，我需要发送一封电子邮件。

我看过 django 的信号功能，但不是很成功。我不想求助于运行不断轮询数据库或其他东西的 cronjobs。有人可以指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T01:17:02.760

```
class SomeModel(models.Model):
    ... #Code here ...
    expires_at = models.DateTimeField()

def your_signal(sender, instance, created, **kwargs):
    if created:
        instance.expires_at =       <---set time here
        instance.save()

        #do other stuff

post_save.connect(your_signal, sender=SomeModel) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:10:35.343

[APScheduler](http://pythonhosted.org/APScheduler/)可以解决问题 - 请参见此处：[http ://pythonhosted.org/APScheduler/dateschedule.html](http://pythonhosted.org/APScheduler/dateschedule.html)

# servicestack - ServiceStack Razor - 如何将验证错误返回到表单？

> ID：15821429
> 
> 赞同：2
> 
> 时间：2013-04-04T20:49:15.637
> 
> 标签：servicestack

我试图弄清楚是否可以使用 ServiceStack Razor 进行老式的服务器端表单验证。

例如：对 url 的 GET 会返回带有表单的 razor 模板。当用户发布表单时，请求 DTO 被验证，如果有错误，用户会看到相同的表单，原始值重新填充为错误的字段，并且以某种方式标记错误。另一方面，如果请求 DTO 有效，则服务会将用户重定向到另一个页面。

这种情况可能吗？

如果是这样，人们将如何实施它？我想我必须为此编写某些过滤器或功能才能工作，但是我想知道哪种策略需要最少的编码。

（我知道 javascript 验证是可能的，但是我的问题特别是是否可以通过服务器端验证来往返表单）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-15T15:26:15.727

查看 ss-validation.js，它可用于根据 ServiceStack 的 ResponseStatus 将验证错误应用于您的表单。

所以我们使用 FluentValidation 编写我们所有的验证代码服务器端，然后在往返 ss-validation 读取 ResponseStatus 并应用标记。

开箱即用的是假设 Bootstrap 样式验证，但它很容易修改以满足您的需要，例如我们修改为显​​示内联图标工具提示而不是内联/阻止消息，并提供错误摘要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T16:56:22.220

在对 ServiceStack 代码库进行了大量探索之后，似乎理论上可以实现所需的场景。

代码已经包含`ModelMetadata`和`ModelMetadataProviders`类，并且一些 HTML 帮助程序是从`System.Web.Mvc`.

可悲的是，这些课程并没有完全连线，所以我想这需要大量的工作才能让一切如预期的那样正常工作。

# configuration - [Run] 部分中带引号的 Inno Setup 参数

> ID：15821436
> 
> 赞同：26
> 
> 时间：2013-04-04T20:49:35.240
> 
> 标签：configuration, inno-setup

我使用`[Run]`部分来修改一些`commandmerit.exe`支持命令行的编解码器的优点值。

所以语法是：

```
Commandmerit.exe "{E2B7DF46-38C5-11D5-91F6-00104BDB8FF9}" "0x800000" 
```

`{E2B7DF46-38C5-11D5-91F6-00104BDB8FF9}`是编解码器的 CLSID 并且 `0x800000`是新优点的值，但是当我将这一行放在`[Run]`section 中时：

```
Filename: "{app}\Commandmerit.exe"; Parameters: ""{F8FC6C1F-DE81-41A8-90FF-0316FDD439FD}" "0x10000000""; WorkingDir: "{app}" 
```

显示流动错误：

> 参数上的引号不匹配或放错了位置。

如果我把这一行：

```
Filename: "{app}\Commandmerit.exe"; Parameters: """{F8FC6C1F-DE81-41A8-90FF-0316FDD439FD}" "0x10000000"""; WorkingDir: "{app}" 
```

显示流动错误：

> 未知常数......使用两个连续的“{”如果......

如果我把这一行：

```
Filename: "{app}\Commandmerit.exe"; Parameters: """{{F8FC6C1F-DE81-41A8-90FF-0316FDD439FD}}" "0x10000000"""; WorkingDir: "{app}" 
```

然后没有显示错误但似乎`commandmerite.exe`不理解参数，所以安装程序完成后优点仍然没有改变。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-04-05T10:10:13.110

要将引号添加到参数，您必须将每个引号加倍，然后在整个值周围加上引号。

您的第二次尝试很接近，但您忘记了中间的尝试。

```
Filename: "{app}\Commandmerit.exe"; Parameters: """{F8FC6C1F-DE81-41A8-90FF-0316FDD439FD}"" ""0x10000000"""; WorkingDir: "{app}" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-04T21:04:08.220

我可以在您的*问题*中看到两件不同的事情。

首先，`{`在 inno setup 中具有特殊含义，因为它是常量的开始。所以，你必须`{`通过加倍来逃避，例如`{{`。不需要转义右括号，因为只有当它是该常量的开始时，它才会被视为常量的结尾。

其次，是你试图`"`作为字符串的一部分传递，但在这种情况下似乎没有必要，因为`"`命令行参数中字符的目的是允许在单个参数中使用空格，但没有你的参数有空格。

综上所述，您必须尝试像这样编写命令：

```
[run]
Filename: "{app}\Commandmerit.exe"; Parameters: {{F8FC6C1F-DE81-41A8-90FF-0316FDD439FD} 0x10000000; WorkingDir: "{app}" 
```

# java - Android GCM 适用于 ICS 但不适用于姜饼

> ID：15821438
> 
> 赞同：3
> 
> 时间：2013-04-04T20:49:43.840
> 
> 标签：java, android, android-4.0-ice-cream-sandwich, google-cloud-messaging, android-2.3-gingerbread

我的 GCM 服务有问题。

我的应用程序可以在 android >= 4.0 设备上正常工作，但不能（例如）在姜饼上工作。

我认为问题出在清单上，但似乎是正确的

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.maptest"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <uses-permission android:name="android.permission.INTERNET" />
    <permission android:name="com.example.maptest.permission.C2D_MESSAGE" android:protectionLevel="signature" />
    <uses-permission android:name="com.example.maptest.permission.C2D_MESSAGE" />
    <uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" />
    <uses-permission android:name="android.permission.INTERNET" /> 
    <uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" />

    <!-- GCM requires a Google account. -->
    <uses-permission android:name="android.permission.GET_ACCOUNTS" />
    <!-- Keeps the processor from sleeping when a message is received. -->
    <uses-permission android:name="android.permission.WAKE_LOCK" /> 

       <!-- Network State Permissions to detect Internet status -->
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <!-- Permission to vibrate -->
    <uses-permission android:name="android.permission.VIBRATE" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <uses-library android:name="com.google.android.maps"/>
              <activity
            android:name=".RegisterActivity"
            android:label="@string/app_name" >
        </activity>
        <activity
            android:name="com.example.maptest.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

            <receiver android:name="com.google.android.gcm.GCMBroadcastReceiver" android:permission="com.google.android.c2dm.permission.SEND" >

          <intent-filter>
    <action android:name="com.google.android.c2dm.intent.RECEIVE" />
    <action android:name="com.google.android.c2dm.intent.REGISTRATION" />
    <category android:name="MapTest" />
  </intent-filter>

    </receiver>

              <service android:name="com.example.maptest.GCMIntentService" android:enabled="true"/>
    </application>

</manifest> 
```

还有我的课

```
public class GCMIntentService extends GCMBaseIntentService {

    private static final String TAG = "GCMIntentService";

    public GCMIntentService() {
        super(SENDER_ID);
        Log.d(TAG,"CREATO IL Servizio");
    }

    /**
     * Method called on device registered
     **/
    @Override
    protected void onRegistered(Context context, String registrationId) {
        Log.i(TAG, "Device registered: regId = " + registrationId);
        displayMessage(context, "Your device registred with GCM");
        Log.d("NAME", MainActivity.name);
        ServerUtilities.register(context, MainActivity.name, MainActivity.email, registrationId);
        /*TODO*/
        MainActivity.regId=registrationId;
    }

    /**
     * Method called on device un registred
     * */
    @Override
    protected void onUnregistered(Context context, String registrationId) {
        Log.i(TAG, "Device unregistered");
        displayMessage(context, getString(R.string.gcm_unregistered));
        ServerUtilities.unregister(context, registrationId);
    }

    /**
     * Method called on Receiving a new message
     * */
    @Override
    protected void onMessage(Context context, Intent intent) {
        Log.i(TAG, "Received message");
        String message = intent.getExtras().getString("price");

        displayMessage(context, message);
        // notifies user
        generateNotification(context, message);
    }

    /**
     * Method called on receiving a deleted message
     * */
    @Override
    protected void onDeletedMessages(Context context, int total) {
        Log.i(TAG, "Received deleted messages notification");
        String message = getString(R.string.gcm_deleted, total);
        displayMessage(context, message);
        // notifies user
        generateNotification(context, message);
    }

    /**
     * Method called on Error
     * */
    @Override
    public void onError(Context context, String errorId) {
        Log.i(TAG, "Received error: " + errorId);
        displayMessage(context, getString(R.string.gcm_error, errorId));
    }

    @Override
    protected boolean onRecoverableError(Context context, String errorId) {
        // log message
        Log.i(TAG, "Received recoverable error: " + errorId);
        displayMessage(context, getString(R.string.gcm_recoverable_error,
                errorId));
        return super.onRecoverableError(context, errorId);
    }

} 
```

在 LogCat 中没有显示任何内容。

有人能帮我吗 ？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:07:19.207

如果这是`com.example.maptest`您的包名称，它应该是您在清单文件中声明的名称

```
<category android:name="MapTest" /> 
```

变成这样

```
<category android:name="com.example.maptest" /> 
```

# jakarta-ee - @Embeddable 和 @EmbeddedId 仅包含复杂类

> ID：15821439
> 
> 赞同：2
> 
> 时间：2013-04-04T20:49:48.260
> 
> 标签：jakarta-ee, jpa

我有以下问题：

我的一个实体必须使用一个复杂的类作为 ID。（为了解决这个问题，我使用@EmbeddedId）

复杂类具有其他 2 个复杂类的组合主键 [我收到以下错误：原因：org.hibernate.AnnotationException：model.IElementKey 没有持久 id 属性：model.impl.Element.id]。

问题是如何在不向 ID 类添加非复杂类型的情况下解决这个问题。

编辑：我必须只使用 JPA [javax.persistence.*]

Edit2：小代码示例（为简单起见，省略了获取器/设置器）

```
@Embeddable
public class EntityKey implements IEntityKey, Serializable {

    private static final long   serialVersionUID    = 1L;

    @ManyToOne(targetEntity = Entity1.class, optional = false)
    private IEntity1                entity1             = null;

    @ManyToOne(targetEntity = Entity2.class, optional = false)
    private IEntity2                entity2             = null;

}

@Entity
public class MixEntity implements IMixEntity {

    @EmbeddedId
    private IEntityKey  id              = null;

}

@Entity
public class Entity1 implements IEntity1 {

    @Id
    private Long id = null;

    @OneToMany(targetEntity = MixEntity.class, mappedBy = "id.entity1")
    private List<IMixEntity>    mixEntities = new ArrayList<IMixEntity>();

}

@Entity
public class Entity2 implements IEntity2 {

    @Id
    private Long id = null;

    @OneToMany(targetEntity = MixEntity.class, mappedBy = "id.entity2")
    private List<IMixEntity>    mixEntities = new ArrayList<IMixEntity>();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-03-29T16:23:26.067

可能有点晚了。但也许它仍然会帮助其他人：

我知道写起来似乎很简单 `@EmbeddedId(targetEntity = SomeClass.class)`

但由于它对您的错误没有影响，请尝试 `@Target`Annotation。

它会完成这项工作。

```
@Entity
public class MixEntity implements IMixEntity {

    @EmbeddedId
    @Target(EntityKey.class)
    private IEntityKey  id              = null;

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-25T16:10:57.020

在这种情况下，我的建议是使用具体类而不是抽象类或接口。原因是 JPA 、 Hibernate 等在幕后使用反射，在这种情况下需要具体的类，例如 this 并检索信息以自动生成查询。如果在 framekork 调用 clazz.instance() 时使用抽象类，则会出现异常。

出于这个原因，您应该使用具体类。

我希望这可以帮助

# authentication - web.config 中的 IIS 身份验证

> ID：15821440
> 
> 赞同：0
> 
> 时间：2013-04-04T20:49:48.263
> 
> 标签：authentication, iis, web-config, applicationhost

在我们的项目中，用户可以将文档上传到目录。问题是用户无法通过 URL 访问这些文件。

在 IIS 中使用权限后，我能够通过更改文件（或文件夹）的权限以允许 IIS_IUSRS“读取”来下载文件。我的问题是这些文件夹也是动态生成的，我不想手动必须通过并更改每个文件夹的权限。

我正在尝试获取 web.config 文件以允许读取这些文件，但我无法获得正确的配置。

在网站的 web.config 文件中，我有：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
    <location path="path/to/upload/directory">
        <system.webServer>
            <security>
                <authentication>
                    <windowsAuthentication enabled="false" />
                    <anonymousAuthentication enabled="true" />
                </authentication>
            </security>
        </system.webServer>
    </location>
</configuration> 
```

但是，再次访问该文件时，我收到 500.19 错误：

> **AnonymousAuthenticationModule**
> 此配置部分不能用于此路径。当该部分锁定在父级别时会发生这种情况。默认情况下锁定 ( `overrideModeDefault="Deny"`)，或者由带有`overrideMode="Deny"`或 legacy的位置标记显式设置`allowOverride="false"`。

按照[这个](https://stackoverflow.com/a/4813716)答案，我在 applicationHost.config 中设置`AnonymousAuthenticationModule`为`lockItem="false"`,并`anonymousAuthentication`重新`Allow`启动服务器。毕竟，我仍然得到相同的 500.19 错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:04:51.457

当您说文件夹是动态生成的时，您的意思是通过代码生成的吗？如果是这样，您可以确保父目录具有所需的权限，然后将其子目录的权限设置为“继承”。对于文件，它将是

```
Dim perms = File.GetAccessControl(targetFile)
perms.SetAccessRuleProtection(False, False)
File.SetAccessControl(targetFile, perms) 
```

我希望你能找到一个目录的等价物。

# javascript - 链接内的按钮单击事件触发两次

> ID：15821442
> 
> 赞同：0
> 
> 时间：2013-04-04T20:49:56.657
> 
> 标签：javascript, jquery, html, ajax, twitter-bootstrap

我正在使用引导程序来创建堆叠药丸导航控件。控件中的每个条目都是一个链接，并且该链接元素还包含一个按钮。可以单击该按钮来删除列表条目，或者可以单击列表条目本身来对其执行某些操作。

每个列表条目的 html 如下所示：

```
<li>
    <a href="#" id="launch_me">Some title
        <button class="my-class" id="remove_me">
             <i class="icon-remove"></i>
        </button>

    </a>
</li> 
```

这些项目是根据来自服务器的响应动态添加的。jquery 然后通过以下方式添加点击处理程序：

```
$("#launch_me").click((function (info) {
    return function () {
        launch(info);
    };
})(myInfo));

$("#remove_me").click((function (info) {
    return function () {
        remove(info);
    };
})(myInfo)); 
```

当我单击按钮删除条目时，会触发“删除”单击例程，然后是启动例程。

我怎样才能使它单击删除按钮只会导致删除单击处理程序正在运行？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:54:45.443

尝试这个：

```
$("#remove_me").click((function (info) {
    return function (e) {
        e.stopPropagation();
        remove(info);
    };
})(myInfo)); 
```

[http://api.jquery.com/event.stopPropagation/](http://api.jquery.com/event.stopPropagation/)

这将防止`click`“删除我”按钮的事件冒泡到其父“启动我”容器并执行其`click`处理程序。

你之前：http: [//jsfiddle.net/HVExt/](http://jsfiddle.net/HVExt/)

之后我的：http: [//jsfiddle.net/HVExt/1/](http://jsfiddle.net/HVExt/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T20:54:45.013

MyInfo 对我来说看起来很狡猾。我会跳过它并添加；反而。但后来我不知道你的代码的其余部分......

# .htaccess - 使用 .htaccess 更改端口和主机

> ID：15821444
> 
> 赞同：4
> 
> 时间：2013-04-04T20:50:07.113
> 
> 标签：.htaccess, mod-rewrite, apache2, subdomain, portforwarding

我正在尝试使用`mod_rewrite`基本上将子域上的端口转发到另一个 IP 上的另一个端口。

像这样：

```
sub.website.com:2000 --> 123.45.67.891:3000 
```

如何使用带有 的`.htaccess`文件 来实现这一点`mod_rewrite`？

我尝试了以下但无济于事：

```
RewriteCond %{HTTP_HOST} ^sub.website.com$ [NC]
RewriteCond %{SERVER_PORT} ^2000$
RewriteRule ^(.*)$ https://123.45.67.891:3000/$1 [L,R=302] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:17:35.333

根据您的规则，我发现其中`HTTP_HOST`包括端口号。所以规则应该看起来像

```
RewriteCond %{HTTP_HOST} ^sub.website.com:2000$ [NC]
RewriteCond %{SERVER_PORT} ^2000$
RewriteRule ^(.*)$ https://123.45.67.891:3000/$1 [L,R=302] 
```

如果您想单独测试服务器名称，您可以使用`%{SERVER_NAME}`评论中建议的@faa

```
RewriteCond %{SERVER_NAME} ^sub.website.com$ [NC] 
```

# javascript - 将随机字节转换为整数范围 - 如何？

> ID：15821447
> 
> 赞同：10
> 
> 时间：2013-04-04T20:50:24.740
> 
> 标签：javascript, node.js

我试图通过从 crypto.randomBytes() 读取来获得一个范围内的随机整数。

现在，我的问题是我不知道如何从该字节流中读取整数。我想生成一个范围只是“扔掉”不在范围内的整数的问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-04T21:04:30.397

`crypto.randomBytes`您可以使用下面的代码获得一个 32 位整数。如果您需要多个字节，则可以请求更多字节`crypto.randomBytes`，然后用于`substr`单独选择和转换每个整数。

```
crypto.randomBytes(4, function(ex, buf) {
  var hex = buf.toString('hex');
  var myInt32 = parseInt(hex, 16);
}); 
```

话虽如此，您可能只想使用`Math.floor(Math.random() * maxInteger)`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2020-11-05T06:48:39.903

在 NodeJS 的区间（即与 相同）中获取**加密安全且均匀分布**的值`[0,1)``Math.random()`

```
const random = crypto.randomBytes(4).readUInt32LE() / 0x100000000;
console.log(random); //e.g. 0.9002735135145485 
```

或在浏览器中

```
const random = window.crypto.getRandomValues(new Uint32Array(1))[0] / 0x100000000;
console.log(random);
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2021-04-04T22:44:34.897

```
const { randomInt } = await import('crypto');

const n = randomInt(1, 7);
console.log(`The dice rolled: ${n}`); 
```

现在它在节点本身中实现 [​​https://nodejs.org/api/crypto.html#crypto_crypto_randomint_min_max_callback](https://nodejs.org/api/crypto.html#crypto_crypto_randomint_min_max_callback)

# php - PHP - 替换引号内的引号 - 正则表达式

> ID：15821450
> 
> 赞同：-4
> 
> 时间：2013-04-04T20:50:32.017
> 
> 标签：php, regex

我有这段文字：

```
$var = 'bundle:a AND id:9 _query_:" bundle:b AND _query_:"bundle:c AND _query_:"bundle:d" " "'; 
```

并希望得到以下输出：

```
bundle:a AND id:9 _query_:" bundle:b AND _query_:\"bundle:c AND _query_:\"bundle:d\" \"" 
```

编辑 1：

我试过：

```
preg_replace('/(?<!_:|_: )"(?=[^"]*?"(( [^:])|([,}])))/', '\\"', $var ) 
```

谢谢 =)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:00:33.500

没有正则表达式：

```
str_replace("\"", "\\\"", $var) 
```

使用正则表达式：

```
preg_replace("/\"/", "\\\"", $var) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:28:44.710

像这样的东西：

```
$var = 'bundle:a AND id:9 _query_:" bundle:b AND _query_:"bundle:c AND _query_:"bundle:d" " "';

$start = strpos($var, '"');
$end = strrpos($var, '"');

$result = substr($var, 0, $start + 1) . 
          str_replace('"', '\\"', substr($var, $start + 1, $end - $start - 1)) . 
          substr($var, $end); 
```

**警告！**我不建议在生产中使用此代码，只是试图展示这个想法。

# ios - iOS 将 Sendy API 集成到应用程序中

> ID：15821452
> 
> 赞同：0
> 
> 时间：2013-04-04T20:50:41.943
> 
> 标签：ios, api, networking

我正在制作一个需要与[Sendy API](http://sendy.co/api)通信的 iPhone 应用程序。我*相信*它使用某种 JSON，但我不太确定，也不知道从哪里开始。我对`subscribe`API 的部分特别感兴趣。**基本上，我需要知道如何从我的应用程序中与 Sendy API 对话。**

任何帮助表示赞赏。

我的代码：

```
- (IBAction)submitButtonPressed:(id)sender
{
    self.data = [[NSMutableData alloc] initWithLength:0];
    NSMutableURLRequest *request = [[NSMutableURLRequest alloc] initWithURL:[NSURL URLWithString:@"http://www.erwaysoftware.com/sendy/subscribe"]];
    [request setHTTPMethod:@"POST"];
    [request setValue:@"john@test.com" forHTTPHeaderField:@"email"];
    [request setValue:@"john" forHTTPHeaderField:@"name"];
    [request setValue:@"LxxxxxxxxxxxxxxxxxxxxQ" forHTTPHeaderField:@"list"];
    [request setValue:@"true" forHTTPHeaderField:@"boolean"];

    NSURLConnection *conn = [NSURLConnection connectionWithRequest:request delegate:self];
    [conn start];

}
- (void)connection:(NSURLConnection *)connection didReceiveResponse:(NSURLResponse *)response {
    [self.data setLength:0];
}

- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)d {
    [self.data appendData:d];
}

- (void)connection:(NSURLConnection *)connection didFailWithError:(NSError *)error {
    [[[UIAlertView alloc] initWithTitle:NSLocalizedString(@"Error", @"")
                                 message:[error localizedDescription]
                                delegate:nil
                       cancelButtonTitle:NSLocalizedString(@"OK", @"")
                       otherButtonTitles:nil] show];
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection {
    NSString *responseText = [[NSString alloc] initWithData:self.data encoding:NSUTF8StringEncoding];

    // Do anything you want with it

    NSLog(@"%@", responseText);
} 
```

当日志发生时，字符串为空。我通过断点知道调用了最后一个方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:01:56.490

查看 API，它只是纯文本响应。

由于它是 POST，因此您可以使用 an`NSURLConnection`来编写请求。有关格式化响应的信息，请参阅[此问题](https://stackoverflow.com/questions/5537297/ios-how-to-perform-a-http-post-request)。

另一种方法是使用[AFNetworking](http://www.afnetworking.com)或[RestKit 之](http://www.restkit.org)类的东西，如果您使用 API 做更多工作，它们可能会更友好一些。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-02T05:29:51.993

我猜你已经解决了这个问题，但万一其他人被困在这里（就像我一样），我想我会发布我所做的以使其正常工作。

您需要做的第一件事是创建一个名为 NSString+URLEncoding（或其他）的类别，它将从 blah@blah.com 获取您的电子邮件和姓名字段并将其转换为 blah%40blah.com。[我从这里](http://madebymany.com/blog/url-encoding-an-nsstring-on-ios)找到的方便的博客文章中修改了这个

```
@interface NSString (URLEncoding)
-(NSString *)urlEncodeUsingEncoding:(NSStringEncoding)encoding;
@end

#import "NSString+URLEncoding.h"

@implementation NSString (URLEncoding)
-(NSString *)urlEncodeUsingEncoding:(NSStringEncoding)encoding {
return (NSString *)CFBridgingRelease(CFURLCreateStringByAddingPercentEscapes(NULL,
                                                           (CFStringRef)self,
                                                           NULL,
                                                           (CFStringRef)@"!*'\"();:@&=+$,/?%#[]% ",
                                                                             CFStringConvertNSStringEncodingToEncoding(encoding)));}
@end 
```

好的，现在只需导入 NSString+URLEncoding.h 并添加以下代码，您就可以开展业务了。这篇[文章](http://kemal.co/index.php/2012/02/fetching-data-with-getpost-methods-by-using-nsurlconnection/)帮助我完成了这部分

```
- (IBAction)submitButtonPressed:(id)sender
{
NSMutableURLRequest *newRequest = [[NSMutableURLRequest alloc]initWithURL:[NSURL URLWithString:@"http://stashdapp.com/sendy/subscribe"]];
[newRequest setHTTPMethod:@"POST"];
[newRequest setValue:@"application/x-www-form-urlencoded; charset=utf-8" forHTTPHeaderField:@"Content-Type"];

NSString *email = @"name@domain.com";
NSString *name = @"First Lastname";
NSString *list = @"XXXXXXXXXXXXXXXXXX";

NSString *postData = [NSString stringWithFormat:@"email=%@&boolean=true&name=%@&list=%@", [email urlEncodeUsingEncoding:NSUTF8StringEncoding],[name urlEncodeUsingEncoding:NSUTF8StringEncoding],list];

[newRequest setHTTPBody:[postData dataUsingEncoding:NSUTF8StringEncoding]];

NSURLConnection *conn = [NSURLConnection connectionWithRequest:newRequest delegate:self];
[conn start];
} 
```

您仍然包括您在问题中引用的委托方法。

希望它可以帮助某人！

# java - 如何模拟存储和计算云之间的加密通信

> ID：15821453
> 
> 赞同：2
> 
> 时间：2013-04-04T20:50:42.830
> 
> 标签：java, cloud, aes

我从我的同学那里知道这不是家庭作业的网站，但是各位尊敬的人的任何帮助或指点都会很棒。

使用[CloudAnalyst](http://www.cloudbus.org/cloudsim/)我需要模拟以下内容：

必须对一个文件执行一项操作，该文件将显示存储和计算云之间的通信，在该文件中通信也将被加密（操作示例可以是计算单词或其他更好的方法）。

CloudAnalyst 部分应如下所示：

1.  在模拟窗口中创建了一个名为“文件配置”的新选项卡</li>
2.  在 File to Operate 中，我们选择要应用加密技术的文件。
3.  在文件加密策略中，用户可以一次应用 AES 128 位或使用 AES 算法的选择性加密。

我得到了以下文章：[http](http://clean-clouds.com/2012/02/08/how-to-run-and-configure-cloudanalyst/) ://clean-clouds.com/2012/02/08/how-to-run-and-configure-cloudanalyst/ 但它没有多大帮助，希望你们中的任何人都会。

提前致谢。

# javascript - 用javascript计算投资价值

> ID：15821461
> 
> 赞同：0
> 
> 时间：2013-04-04T20:51:25.207
> 
> 标签：javascript

我目前正在学习javascript。我创建了一个计算器来查找投资未来价值。当它显示时，它给了我一个不正确的值`future value`。我已经检查了几次公式，但它仍然给我一个错误。此外，如果兴趣小于`0`或大于`20`但没有显示任何内容，我已经设置了警报。必要时如何正确显示正确的未来值和警报？[例子](http://webprolearner2346.zxq.net/calculator/future_value.html)

**Javascript**

```
var $ = function (id) {
    return document.getElementById(id);
}

var calculate_click = function () {
    var investment = parseFloat( $("investment").value );
    var annualRate = parseFloat( $("rate").value ) /100;
    var years = parseInt( $("years").value );

    $("futureValue").value = "";

    if (isNaN(investment) || investment <= 0) {
        alert("Investment must be a valid number\nand greater than zero.");
    } else if(isNaN(annualRate) || annualRate <= 0 || annualRate > 20) {
        alert("Annual rate must be a valid number\nand less than or equal to 20.");
    } else if(isNaN(years) || years <= 0 || years > 50) {
        alert("Years must be a valid number\nand less than or equal to 50.");
    } else {
        //var monthlyRate = annualRate / 12;
        //var months = years * 12;
        var futureValue = 0;

        for ( i = 1; i <= years; i++ ) {

            futureValue = ( futureValue + investment ) *
                ( 1 + annualRate );

        }
        $("futureValue").value = futureValue.toFixed(2);
    } 
}

var clear_click = function () {
    $("investment").value = "";
    $("rate").value = "";
    $("years").value = "";
    $("futureValue").value = "";
}

window.onload = function () {
    $("calculate").onclick = calculate_click;
    $("investment").focus();
    $("clear").onclick = clear_click;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:54:16.007

使用`.value`不正确，它的javascript，虽然这是jquery，但尝试`#`在前面添加a并`.val()`改为使用。

它与此类似：

[jquery 函数 val() 不等同于 "$(this).value="?](https://stackoverflow.com/questions/4524702/jquery-function-val-is-not-equivalent-to-this-value)

编辑

他没有使用jquery，忽略这个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:30:07.597

如果我正确地记住了未来值，那么您就是在弄乱公式，这就是为什么您没有得到预期值的原因。

改变：

```
 for ( i = 1; i <= years; i++ ) {
        futureValue = ( futureValue + investment ) *
            ( 1 + annualRate );
    } 
```

到：

```
futureValue = investment*Math.pow((1+annualRate), years); 
```

不太清楚你为什么每年都要循环，但它应该基于年数的权力（再次，如果我没记错的话）

# python - 在 python 中覆盖 OptionParser 的 add_option 函数

> ID：15821463
> 
> 赞同：2
> 
> 时间：2013-04-04T20:51:43.223
> 
> 标签：python, optparse

我已经为optparse编写了一个子类`Option`。`OptionParser`我正在重写`add_option`OptionParser 中的函数以使其解析新关键字。以下是我的代码。

```
from optparse import Option, OptionError, OptionParser

class MyOptionParser(OptionParser):
    def add_option(self,*args,**kwargs):
    ##add the new keyword "deft". If deft="some value", kwargs[default] = deft
    ##else process args to get deft
        if kwargs.has_key["deft"]:
            newDef = kwargs["deft"]
            del kwargs["deft"]
        else:
            newDef = process_args_for_deft(args)
        if newDef!= None
            kwargs["default"] = newDef
        modOpt = OptionParser.add_option(self,*args,**kwargs)

class MyOption(Option):
    def _set_opt_strings(self, largs, rargs, values):
        #overridden method over here 
```

现在，如果我这样做，它工作正常。

```
parser = MyOptionParser()
parser.add_option("-f", "--file", dest="filename",
                 help="write report to FILE", metavar="FILE", deft ="xyz") 
```

但是，如果我这样做（我想这样做），它会给我一个错误： MyOption instance has no attribute ' **getitem** ' if def 没有指定并且如果`def`指定它给我一个错误，说 no type like `def`.

```
parser = MyOptionParser()
parser.add_option(MyOption("-f", "--file", dest="filename",
                 help="write report to FILE", metavar="FILE", def ="xyz")) 
```

我认为问题是我在使用 MyOption (opts,args) 时传递了一个对象，因此它无法访问 args/kwargs。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:07:30.900

`add_option`基本上直接调用构造函数`option_class`（这是构造函数的默认参数`OptionParser`，默认为`optparse.Option`）。

因此，您可能应该只覆盖`MyOption.__init__`（不覆盖`OptionParser.add_option`）：

```
class MyOption(Option):
    def __init__(self, *args, **kwargs):
        if 'deft' in kwargs:
            newDef = kwargs.pop('deft')
        else:
            newDef = process_args_for_deft(args)
        if newDef is not None:
            kwargs["default"] = newDef

        Option.__init__(self, *args, **kwargs) 
```

如果您希望能够支持类似的语法

```
parser.add_option("-f", "--file", dest="filename",
             help="write report to FILE", metavar="FILE", deft ="xyz") 
```

然后确保`option_class`在制作时进行设置`OptionParser`：

```
parser = MyOptionParser(option_class=MyOption) 
```

# python - 如何通过 unittest setUp 在 python 中正确使用 mock

> ID：15821465
> 
> 赞同：77
> 
> 时间：2013-04-04T20:51:47.390
> 
> 标签：python, unit-testing, mocking

在我尝试学习 TDD 时，尝试学习单元测试并在 python 中使用 mock。慢慢掌握它，但不确定我是否正确执行此操作。预先警告：我坚持使用 python 2.4，因为供应商 API 是作为预编译的 2.4 pyc 文件提供的，所以我使用的是 mock 0.8.0 和 unittest （不是 unittest2 ）

鉴于“mymodule.py”中的此示例代码

```
import ldap

class MyCustomException(Exception):
    pass

class MyClass:
    def __init__(self, server, user, passwd):
        self.ldap = ldap.initialize(server)
        self.user = user
        self.passwd = passwd

    def connect(self):
        try:
            self.ldap.simple_bind_s(self.user, self.passwd)
        except ldap.INVALID_CREDENTIALS:
            # do some stuff
            raise MyCustomException 
```

现在在我的测试用例文件“test_myclass.py”中，我想模拟 ldap 对象。ldap.initialize 返回 ldap.ldapobject.SimpleLDAPObject，所以我认为这是我必须模拟的方法。

```
import unittest
from ldap import INVALID_CREDENTIALS
from mock import patch, MagicMock
from mymodule import MyClass

class LDAPConnTests(unittest.TestCase):
    @patch('ldap.initialize')
    def setUp(self, mock_obj):
        self.ldapserver = MyClass('myserver','myuser','mypass')
        self.mocked_inst = mock_obj.return_value

    def testRaisesMyCustomException(self):
        self.mocked_inst.simple_bind_s = MagicMock()
        # set our side effect to the ldap exception to raise
        self.mocked_inst.simple_bind_s.side_effect = INVALID_CREDENTIALS
        self.assertRaises(mymodule.MyCustomException, self.ldapserver.connect)

    def testMyNextTestCase(self):
        # blah blah 
```

引导我提出几个问题：

1.  这看起来对吗？:)
2.  这是尝试和模拟在我正在测试的类中实例化的对象的正确方法吗？
3.  可以在 setUp 上调用 @patch 装饰器还是会导致奇怪的副作用？
4.  无论如何都可以模拟引发 ldap.INVALID_CREDENTIALS 异常而不必将异常导入我的测试用例文件？
5.  我应该改用 patch.object() 吗？如果是，怎么做？

谢谢。

* * *

## 回答 #1

> 赞同：83
> 
> 时间：2014-05-12T20:29:04.690

您可以[`patch()`](https://docs.python.org/3/library/unittest.mock.html#unittest.mock.patch)用作类装饰器，而不仅仅是函数装饰器。然后，您可以像以前一样传入模拟函数：

```
@patch('mymodule.SomeClass')
class MyTest(TestCase):

    def test_one(self, MockSomeClass):
        self.assertIs(mymodule.SomeClass, MockSomeClass) 
```

请参阅：[对每个测试方法应用相同的补丁](https://docs.python.org/3/library/unittest.mock-examples.html#applying-the-same-patch-to-every-test-method)（其中还列出了替代方法）

如果您希望对所有测试方法进行修补，那么在 setUp 上以这种方式设置修补程序更有意义。

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2016-12-20T23:21:06.870

`patch()`我将从回答您的问题开始，然后我将详细举例说明如何`setUp()`交互。

1.  我认为它看起来不正确，有关详细信息，请参阅我对此列表中问题 #3 的回答。
2.  是的，对 patch 的实际调用看起来应该模拟您想要的对象。
3.  不，你几乎不想`@patch()`在`setUp()`. 你很幸运，因为对象是在`setUp()`测试方法中创建的，并且永远不会被创建。
4.  我不知道有什么方法可以让模拟对象引发异常而不将该异常导入您的测试用例文件。
5.  我认为这里没有任何必要`patch.object()`。它只是让您修补对象的属性，而不是将目标指定为字符串。

为了扩展我对问题 #3 的回答，问题是`patch()`装饰器仅在装饰功能运行时适用。一旦`setUp()`返回，补丁就会被删除。在您的情况下，这是可行的，但我敢打赌，这会使查看此测试的人感到困惑。如果您真的只希望补丁在 期间发生`setUp()`，我建议使用该`with`声明来明确补丁将被删除。

以下示例有两个测试用例。`TestPatchAsDecorator`表明装饰类将在测试方法期间应用补丁，但不会在`setUp()`. `TestPatchInSetUp`展示了如何应用补丁，使其在`setUp()`测试方法和测试方法中都到位。调用`self.addCleanUp()`确保补丁将在`tearDown()`.

```
import unittest
from mock import patch

@patch('__builtin__.sum', return_value=99)
class TestPatchAsDecorator(unittest.TestCase):
    def setUp(self):
        s = sum([1, 2, 3])

        self.assertEqual(6, s)

    def test_sum(self, mock_sum):
        s1 = sum([1, 2, 3])
        mock_sum.return_value = 42
        s2 = sum([1, 2, 3])

        self.assertEqual(99, s1)
        self.assertEqual(42, s2)

class TestPatchInSetUp(unittest.TestCase):
    def setUp(self):
        patcher = patch('__builtin__.sum', return_value=99)
        self.mock_sum = patcher.start()
        self.addCleanup(patcher.stop)

        s = sum([1, 2, 3])

        self.assertEqual(99, s)

    def test_sum(self):
        s1 = sum([1, 2, 3])
        self.mock_sum.return_value = 42
        s2 = sum([1, 2, 3])

        self.assertEqual(99, s1)
        self.assertEqual(42, s2) 
```

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2018-08-24T04:03:57.927

我想指出一个接受的答案的变体，其中一个`new`参数被传递给`patch()`装饰器：

```
from unittest.mock import patch, Mock

MockSomeClass = Mock()

@patch('mymodule.SomeClass', new=MockSomeClass)
class MyTest(TestCase):
    def test_one(self):
        # Do your test here 
```

请注意，在这种情况下，不再需要在`MockSomeClass`每个测试方法中添加第二个参数 , ，这样可以节省大量代码重复。

可以在[https://docs.python.org/3/library/unittest.mock.html#patch](https://docs.python.org/3/library/unittest.mock.html#patch)找到对此的解释：

> 如果`patch()`用作装饰器并且省略*new*，则创建的模拟将作为额外参数传递给装饰函数。

最重要的答案省略了*new*，但包含它会很方便。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2015-03-30T15:20:55.527

如果你有很多补丁要应用，并且你希望它们应用到在 setUp 方法中初始化的东西上，也试试这个：

```
def setUp(self):
    self.patches = {
        "sut.BaseTestRunner._acquire_slot": mock.Mock(),
        "sut.GetResource": mock.Mock(spec=GetResource),
        "sut.models": mock.Mock(spec=models),
        "sut.DbApi": make_db_api_mock()
    }

    self.applied_patches = [mock.patch(patch, data) for patch, data in self.patches.items()]
    [patch.apply for patch in self.applied_patches]
    .
    . rest of setup
    .

def tearDown(self):
    patch.stopall() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-02-28T13:51:11.467

您可以创建一个修补的内部函数并从`setUp`.

如果您的原始`setUp`功能是：

```
def setUp(self):
    some_work() 
```

然后，您可以通过将其更改为来修补它：

```
def setUp(self):
    @patch(...)
    def mocked_func():
        some_work()

    mocked_func() 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-11-08T17:34:51.840

解决这个问题的另一种方法是在类之外定义补丁，然后重用它来装饰类以及 setUp 和 tearDown 方法，如下所示（重用 Don Kirkby 的示例）：

```
import unittest
from mock import patch

my_patch = patch('__builtin__.sum', return_value=99)

@my_patch
class TestPatchAsDecorator(unittest.TestCase):
    @my_patch
    def setUp(self):
        s = sum([1, 2, 3])

        self.assertEqual(99, s)

    def test_sum(self, mock_sum):
        s1 = sum([1, 2, 3])
        mock_sum.return_value = 42
        s2 = sum([1, 2, 3])

        self.assertEqual(99, s1)
        self.assertEqual(42, s2) 
```

# jquery - Jquery 对话框被发布在表单之外，但我需要在对话框按钮上提交表单单击

> ID：15821466
> 
> 赞同：0
> 
> 时间：2013-04-04T20:51:50.967
> 
> 标签：jquery, asp.net-mvc

这越来越棘手，我无法在 Dailog 框点击中发布到我的表单。对话框一旦打开就在表单外发布，因此在对话框内单击按钮不会将表单提交到服务器。我尝试将对话框附加回表单，但表单会自动发布。当用户单击对话框上的任一按钮时，我只需要发布到表单。提前感谢您的帮助

**主视图**

```
@using (Html.BeginForm("Create", "RunLogEntry", FormMethod.Post, new { id = "form", enctype = "multipart/form-data" }))
{
    <div id="main">
        @Html.Partial("_RunLogEntryPartialView", Model)
    </div>
} 
```

**局部视图**

```
<button name="submit" class="art-button" type="submit" value="Upload" onclick="test();return false;"
    style="width: 100px">
    Upload</button>

 function test() {
        var UploadDialog;

        UploadDialog = $("#uploadConfirmation").dialog({
            title: "Yes or No",
            resizable: false,
            modal: false,
            buttons: {
                "Yes": function () {
                    $(this).dialog("close");
                    $("#hiddenInput").val("Normal");
                    $("#form").submit();
                },
                "No": function () {
                    $(this).dialog("close");
                    $("#hiddenInput").val("Buffer");
                }
            }
        });

        //        UploadDialog.closest("div.ui-dialog").appendTo("#form");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:24:37.233

无需考虑从对话框和原始表单中发布数据，只需使用那里的表单值来填充原始表单上的值，关闭对话框，然后通过“是”按钮操作通过帖子发布原始表单。

如果您有很多值要处理，您可以简单地序列化对话框中的字段，然后使用 each 将它们发布回您的原始表单。如果您不希望用户在原始表单中看到您在对话框中的值，请将它们作为隐藏字段包含在内，或者简单地使用对话框和帖子中表单中的序列化值。

或者，您也可以在对话框上设置与原始表单不同的表单，然后提交两个序列化值以处理表单。这实际上可能是涉及最少的方法。

您可能需要考虑的一件事是，使用对话框来中断填写表单的体验并不被认为是一种很好的用户模式。将对话视为进程的关键中断，理想情况下，仅当您出于特定原因（例如警告）必须停止用户时才使用该对话。简单地让他们通过对话框添加更多信息可以通过可扩展区域以更简单的方式完成，例如使用显示/隐藏。

# jquery - 循环函数

> ID：15821475
> 
> 赞同：-2
> 
> 时间：2013-04-04T20:52:16.630
> 
> 标签：jquery, function, loops

我想制作一个java脚本，它每5秒自动循环一次我的函数这是我的代码

```
function showlisten() {
   document.getElementById('listen').style.display = "block";
   document.getElementById('review').style.display = "none";
   document.getElementById('earn').style.display = "none";
   document.getElementById('listen-text').style.display = "block";
   document.getElementById('review-text').style.display = "none";
   document.getElementById('earn-text').style.display = "none";
}
function showreview() {
   document.getElementById('listen').style.display = "none";
   document.getElementById('review').style.display = "block";
   document.getElementById('earn').style.display = "none";
   document.getElementById('listen-text').style.display = "none";
   document.getElementById('review-text').style.display = "block";
   document.getElementById('earn-text').style.display = "none";
}
function showearn() {
   document.getElementById('listen').style.display = "none";
   document.getElementById('review').style.display = "none";
   document.getElementById('earn').style.display = "block";
   document.getElementById('listen-text').style.display = "none";
   document.getElementById('review-text').style.display = "none";
   document.getElementById('earn-text').style.display = "block";
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T20:54:29.163

这个很简单。

```
var clearToken = window.setInterval(function () {
    showlisten(); showreview(); showearn();
}, 5000); 
```

感谢 QuickSilver 博士发现了需求的真实性质。更新如下：

```
function showlisten(){
    document.write("listen<br />");
}
function showreview(){
    document.write("review<br />");
}
function showearn(){
    document.write("earn<br />");
}

showlisten();
window.setInterval(function () {
    showlisten();
}, 15000);
window.setTimeout(function () {
    showreview();
    window.setInterval(function(){
        showreview();        
    }, 15000);
}, 5000);
window.setTimeout(function () {
    showearn();
    window.setInterval(function () {
        showearn();
    }, 15000);
}, 10000); 
```

我更喜欢 QuickSilver 的方法，但复制样式将是多余的，因此我采用了不同的方法来为您提供两种解决方法。

我为它创建了一个小提琴，但该网站现在似乎正在为我播放：http: [//jsfiddle.net/jdjE5/](http://jsfiddle.net/jdjE5/)希望该链接对您有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-09T06:23:21.183

你想让它处于'listen'状态5秒，然后'review'状态5秒，然后'earn'状态5秒，然后循环吗？

如果是这样，您需要 3 个 setTimeouts 链：

```
function dolisten() {
   showlisten();
   setTimeout(doreview,5000);
}
function doreview() {
   showreview();
   setTimeout(doearn,5000);
}
function doearn() {
   showearn();
   setTimeout(dolisten,5000);
} 
```

你也可能`setIntervals`在 15 秒的时钟上有 3 个不相关的，但我不确定它们是否会保持同步，而且这并不简单。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T20:53:42.287

你正在寻找 setInterval() ;)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-04T21:06:38.883

我应该缓存 DOM 元素，例如：

```
function loopFunctions(){
   var elemListen = document.getElementById('listen'),
      elemReview = document.getElementById('review'),
      elemEarn = document.getElementById('earn'),
      elemListenText = document.getElementById('listen-text'),
      elemReviewText = document.getElementById('review-text'),
      elemEarnText = document.getElementById('earn-text'),
      functions = [
         function(){
            elemListen.style.display = "block";
            elemReview.style.display = "none";
            elemEarn.style.display = "none";
            elemListenText.style.display = "block";
            elemReviewText.style.display = "none";
            elemEarnText.style.display = "none";
         },
        function(){
            elemListen.style.display = "none";
            elemReview.style.display = "block";
            elemEarn.style.display = "none";
            elemListenText.style.display = "none";
            elemReviewText.style.display = "block";
            elemEarnText.style.display = "none";
         },
         function(){
            elemListen.style.display = "none";
            elemReview.style.display = "none";
            elemEarn.style.display = "block";
            elemListenText.style.display = "none";
            elemReviewText.style.display = "none";
            elemEarnText.style.display = "block";
         } 
      ],
      idInterval = setInterval(function(){
         for (var i = functions.length; i >= 0; i--) {
            functions[i]();
         };
      }, 5000);
} 
```

# c - madvise 管理内存映射文件

> ID：15821476
> 
> 赞同：2
> 
> 时间：2013-04-04T20:52:21.683
> 
> 标签：c, mmap

我有一个程序可以处理由大量（300+）大内存（40MB+）映射文件组成的大型数据集。尽管以顺序方式访问所有文件，但它们都需要一起使用。目前我正在对文件进行内存映射，然后使用`madvise`with`MADV_SEQUENTIAL`因为我不希望这个东西比它需要的更占用内存（没有任何`madvise`消费成为问题）。程序运行速度比系统磁盘慢得多（如慢 50 倍）的问题表明它应该运行，并且比线性运行速度更快。随着涉及的文件数量增加。处理 100 个文件的速度比 300 个文件快 10 倍以上，尽管数据量只有 3 倍。我怀疑每次跨越 4kb 页面时内存映射文件都会产生页面错误，最终结果磁盘寻道时间大于磁盘传输时间。

任何人都可以想出比使用`madvise`with`MADV_WILLNEED`和`MADV_DONTNEED`时常使用更好的方法吗？如果这是最好的方法，有什么想法可以展望未来吗？

# vba - word 2007 - 以编程方式为宏添加快速访问图标，或为宏添加快速快捷键

> ID：15821477
> 
> 赞同：0
> 
> 时间：2013-04-04T20:52:21.713
> 
> 标签：vba, ms-word

我正在尝试通过 vba 代码将宏添加到快速访问工具栏。
我也想知道如何通过 vba 代码添加宏键快捷方式。

这一切都适用于 Windows 2007。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:16:20.347

对于键盘快捷键，使用：

[应用程序.OnKey](http://msdn.microsoft.com/en-us/library/office/aa195807%28v=office.11%29.aspx)

要添加到快速访问工具栏，首先，您需要对功能区本身的引用。我有一个项目，我给我的自定义功能区一个自定义“onload”函数，然后在该函数中捕获功能区对象。然后，使用该对象进行更改。可悲的是，有时这个对象在 VBA 中“消失”，除了备份对象引用之外，您无能为力，而且通常其中一个仍然处于活动状态。

有关加载项方法，请参阅此链接：

[为开发人员自定义 2007 Office Fluent 功能区（第 1 部分，共 3 部分）](http://word.mvps.org/FAQs/Customization/Customising%20the%20Ribbon%20-%20Advanced.htm)

我在我的项目中使用了这个[功能区编辑器。](http://www.andypope.info/vba/ribboneditor.htm)

以下是我使用自定义 onload 函数捕获功能区对象的方法：

```
'Callback for customUI.onLoad
Sub RibbonLoaded(ribbon As IRibbonUI)
    Set myRibbon = ribbon
    Set myRibbonBackup = ribbon
End Sub 
```

我建议尽可能多地使用我提供给您的功能区编辑器工具，而不是尝试使用 VBA 编辑功能区——这可能非常困难。我从来没有使用 VBA 来修改快速访问工具栏。

# spring - 在 Grails 中保存对属性文件的更改

> ID：15821478
> 
> 赞同：0
> 
> 时间：2013-04-04T20:52:21.943
> 
> 标签：spring, grails, groovy, grails-2.0

我有一个从属性文件中读取的 grails 应用程序。我创建了一个管理页面，允许用户查看此文件中的设置。我想允许用户更新各种属性并使用 Grails 将它们保存回属性文件。

我的问题是我似乎无法弄清楚如何将更改保存回属性文件。

这是我从文件中读取并更改属性的代码：

```
 def env = params.getAt("environment");
    if (env != null){
     //Read from Property file based on user selection
        def props = new Properties()
        def cl = Thread.currentThread().contextClassLoader
        def filepath = env+'.properties'
        props.load  servletContext.getResourceAsStream("/WEB-INF/"+ filepath)

        Enumeration e = props.propertyNames();
        while (e.hasMoreElements()) {
            String key = (String) e.nextElement();
            def input = params.getAt(key)
            if (input != null){
                props.setProperty(key,input)
            }
        }
         //props.store(propFile.newWriter(), null)

    } 
```

关于如何保存/覆盖 /WEB-INF/example.properties 中的 example.properties 文件的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T23:18:00.947

我认为您可能正在寻找*ServletContext* [http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRealPath(java.lang.String)中的](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html#getRealPath(java.lang.String))*getRealPath*方法

 *向您展示如何使用它的简单示例

```
http://82.157.70.109/mirrorbooks/javaservletjspcookbook/0596005725_jsvltjspckbk-chp-14-sect-7.html 
```*

# python - Python 3.3 - urllib.request - 导入错误

> ID：15821480
> 
> 赞同：3
> 
> 时间：2013-04-04T20:52:25.033
> 
> 标签：python, urllib, pycharm, python-3.3

当我尝试在 PyCharm 2.7 中的 OS X 10.8 上运行以下 Python 3.3 代码时（或使用 Python 3.3/2.7.3 启动器运行 .py 文件）：

```
import urllib.request
f = urllib.request.urlopen('http://www.python.org/')
print(f.read(300)) 
```

我收到以下错误消息：

```
/System/Library/Frameworks/Python.framework/Versions/3.3/bin/python3 /Users/username/PycharmProjects/urllib/urllib.py
Traceback (most recent call last):
  File "<frozen importlib._bootstrap>", line 1512, in _find_and_load_unlocked
AttributeError: 'module' object has no attribute '__path__'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/username/PycharmProjects/urllib/urllib.py", line 3, in <module>
    import urllib.request
  File "/Users/username/PycharmProjects/urllib/urllib.py", line 3, in <module>
    import urllib.request
ImportError: No module named 'urllib.request'; urllib is not a package

Process finished with exit code 1 
```

我可以成功运行代码的唯一方法是通过 Python shell。

关于如何解决这个问题的任何想法？

谢谢。

* * *

我将文件名更改为 url.py，现在它在 PyCharm 中成功执行。

但是当通过 Python Launcher 3.3 执行文件时，它给了我以下错误：

```
 File "/Users/username/PycharmProjects/urllib/url.py", line 3, in <module>
import urllib.request
ImportError: No module named request 
```

为什么代码在 PyCharm (3.3) 中运行良好，但在使用 Python Launcher (3.3) 启动时出现错误？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-04T20:54:21.560

您命名了您的文件`urllib`，它隐藏了标准库包。重命名您的文件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2020-04-05T12:38:35.283

在 mac 中，VSCode 使用的是 Python 2。如果你打印`urllib`模块，你会发现这个模块是为 Python 2 准备的。

所以，我添加了一条评论来选择 Python 版本：

```
#!/usr/local/bin/python3
from urllib.request import urlopen 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-07T17:26:31.633

就我而言，它解决了在命令面板中激活 (shift+commant+p) Linting: E​​nable Linting **: on**并在 VMStudio Settings (Preferences => Settings) 中选择 flake8 in Python:linter => Linter 用作 flake8。

# java - 将 pdf 文件编码为 JSON 字符串时出错

> ID：15821484
> 
> 赞同：0
> 
> 时间：2013-04-04T20:52:43.613
> 
> 标签：java, json, utf-8, jackson

我想读取 pdf 文件的内容并以 JSON 字符串将其发送到服务器。我使用 google guava 库将 pdf 文件的内容读入字符串。然后我使用了 jettison JSON 库来转义会与 JSON 冲突的所需字符。

```
String content = Files.toString(new File("C:/Users/Sudhagar/Desktop/GAME.pdf"), Charset.defaultCharset());

String escapedContent = org.codehaus.jettison.json.JSONObject.quote(content); 
```

我将 JVM 的默认字符集设置为 UTF-8。

生成的 JSON 字符串创建如下，

```
String respStr = "{\n";
respStr = respStr + "\"mimetype\" : \"" + "text/plain" + "\",\n";
respStr = respStr + "\"value\" : " + escapedContent + "\n";
respStr = respStr + "}\n";
System.out.println(respStr);
StringEntity entity = new StringEntity(respStr);
httpput.setEntity(entity); 
```

当我将此 JSON 发送到服务器时，我得到一个异常，

```
org.codehaus.jackson.JsonParseException: Invalid UTF-8 middle byte 0xfc  at [Source: [B@5733c2; line: 3, column: 25] 
```

我想知道这种方法或针对此问题的任何其他方法是否有任何错误。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T20:55:15.490

我认为 PDF 文件应该被视为不透明的二进制数据，就像图像或加密数据一样。

*不要*把它当作纯文本文件来阅读。像对待其他二进制数据一样对待它——这可能意味着为了 JSON 对它进行 base64 编码。

# sql - Postgresql 9.1 的非重音扩展返回空行

> ID：15821485
> 
> 赞同：1
> 
> 时间：2013-04-04T20:52:51.253
> 
> 标签：sql, postgresql, unaccent

我在 postgresql 数据库上创建了扩展名“unaccent”，但是当我使用“unaccent”运行选择时，它总是返回 1 行但有一个空行。

```
select ts_lexize('unaccent', 'Hôtel');
ts_lexize
-----------

(1 row) 
```

根据[文档](http://www.postgresql.org/docs/9.1/static/unaccent.html)预期：

```
select ts_lexize('unaccent','Hôtel');
ts_lexize
-----------
{Hotel}
(1 row) 
```

当我跑步时：

```
SELECT unaccent('unaccent', 'Hôtel'); 
```

表明：

```
unaccent
----------
Hôtel
(1 row) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T00:49:22.317

我刚刚发现问题在于使用编码的数据库`SQL_ASCII`编码，所以我删除了数据库，重新创建它，`UTF-8`然后它开始正常工作。似乎`unaccent`不适用于`SQL_ASCII`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T18:34:29.730

它取决于 Postgres 编辑器或操作系统。您可能正在使用 MacOS 或 Linux 来显示结果。我同意了狼蛛。如果您将编码数据库更改为UTF-8，它会好得多。

尝试在 Postgres Windows 编辑器中执行此选择。和我一起工作。“空白”结果出现了。

汞 =)

# ios - 以编程方式将按钮添加到集合视图单元格

> ID：15821486
> 
> 赞同：2
> 
> 时间：2013-04-04T20:52:58.710
> 
> 标签：ios, objective-c, xcode, uicollectionview, uicollectionviewcell

我在 Xcode 4.6 中有一个应用程序。在一个视图控制器中，我有一个集合视图。通过用户与视图的交互将单元格添加到视图中。这工作正常。然后，我想向每个单元格添加一个按钮（以编程方式），以允许删除该单元格。我希望按钮位于每个单元格的右上角。问题是按钮出现在集合视图第一行中所有单元格的每个单元格内的所需位置（再次，右上角），但随后出现在第一行之后的所有单元格的单元格之外。见下图：![在此处输入图像描述](https://i.stack.imgur.com/yt99G.png)

我的按钮创建方法是：

```
-(CollectionViewCellButton *)makeDeleteButtonForCell:(UICollectionViewCell *)cell
{
  CollectionViewCellButton *button = [CollectionViewCellButton buttonWithType:UIButtonTypeCustom];
  CGSize newImageSize = CGSizeMake(cell.frame.size.width/2.5, cell.frame.size.height/2.5);
  UIImage *image = [SeeYourAlbumViewController imageWithImage:[UIImage imageNamed:@"delete"] scaledToSize:newImageSize];

  CGFloat width = image.size.width;
  CGFloat height = image.size.height;
  CGFloat X = cell.frame.size.width - width;
  CGFloat Y = cell.frame.origin.y;

  button.frame = CGRectMake(X, Y, width, height);
  [button setImage:image forState:UIControlStateNormal];
  [button addTarget:self
           action:@selector(deleteCollectionViewCell:)
   forControlEvents:UIControlEventTouchUpInside];

  return button; 
```

}

上面的方法在我的cell创建方法中调用如下：

```
-(UICollectionViewCell *)collectionView:(UICollectionView *)collectionView
             cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
  UICollectionViewCell *cell = [collectionView
                              dequeueReusableCellWithReuseIdentifier:@"newCell"
                              forIndexPath:indexPath];

  //CALLED HERE!!
  CollectionViewCellButton *cellButton = [self makeDeleteButtonForCell:cell]; 

  cellButton.indexPath = indexPath;
  [cell addSubview:[self.pictures objectAtIndex:indexPath.row]]; 
  [cell addSubview:cellButton];

  return cell;
} 
```

谁能建议我可能做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:18:52.773

该按钮被添加为单元格的子视图。它应该使用单元格的坐标系（边界），而不是单元格的超级视图（框架）的坐标系。在您的情况下，由于按钮位于单元组的顶部

```
CGFloat Y = 0; 
```

# c - 向上搜索包括层次结构

> ID：15821489
> 
> 赞同：1
> 
> 时间：2013-04-04T20:53:04.690
> 
> 标签：c, eclipse

是否有一种简单的方法可以对包含树上的 ac 文件进行文本搜索（包括包含搜索位置中的文件）？最好在日食中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:00:30.050

检查 ctags，Ctags 生成在源文件中找到的语言对象的索引（或标记）文件，允许文本编辑器或其他实用程序快速轻松地找到这些项目。

[http://en.wikipedia.org/wiki/Ctags](http://en.wikipedia.org/wiki/Ctags)

[http://ctags.sourceforge.net/](http://ctags.sourceforge.net/)

# c# - 扫描文本框内的条形码并触发 textboxChanged asp.net

> ID：15821493
> 
> 赞同：0
> 
> 时间：2013-04-04T20:53:26.017
> 
> 标签：c#, asp.net, textchanged

我在更新面板中有一个文本框：

```
<asp:TextBox ID="txtInsert" 
             runat="server" Font-Size="Large" MaxLength="13" 
             Width="150px" onkeyup="doPostBack(this);" AutoPostBack="True"
             OnTextChanged="txtInsert_TextChanged"></asp:TextBox> 
```

这个文本框应该通过扫描条形码获得值。所有条形码都有 13 位数字。在 txtInsert_TextChanged 方法中，我检查是否在表格内扫描的值并显示一条消息并删除文本框值。

问题是有时它只能读取 1 个字符或 4 个字符，有时我有 13 个数字，但它们是由 2 个条码组合而成的。

基本上我认为我必须以某种方式增加按键时间，因为它只读取部分条形码，然后将其与第二个条形码读取结合......

顺便说一句：doPostBack(this) 方法在这里：

```
<script type="text/javascript">
    function doPostBack(o) {
        __doPostBack(o.id, '');
    }
</script> 
```

有任何想法吗 ？

PS：扫描仪最后没有输入 ENTER ......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:55:27.510

该`textchanged`事件将在`text`属性更改时触发，因此单个字符更改将触发该事件。

我建议您检查一下您是如何填充文本框的，以及您是否可以切换到一次性将整个条形码编号放入文本框中，这样您只需触发一次事件。

如果在事件处理程序中失败，您可以只检查文本的大小，并且仅在字符数正确时处理它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:02:39.953

`Enter`扫描仪在读取整个代码后可能会抛出一个。在它旁边放一个提交按钮或捕获键 13。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T21:04:19.873

由于您的条形码阅读器在客户端计算机上，当您调用`__dopostback`浏览器时，再次加载相同的页面，并且在此期间，条形码阅读器模拟的所有键盘事件都不会传输到文本框。

因此，只有在文本框中有 13 个字符时才需要进行回发。

您可以修改您的 javascript 以执行以下操作：（不是实际的 javascript）

```
if (this.value.length == 13) __dopostback(this); 
```

# database - Oracle 直方图对嵌套集没有用

> ID：15821494
> 
> 赞同：1
> 
> 时间：2013-04-04T20:53:28.217
> 
> 标签：database, oracle, histogram, nested-sets, peoplesoft

我们使用仁科。它使用针对自引用树的连接来实现行级查询安全性。这是使用嵌套集完成的。如您所见，叶子节点只返回一行，而在树的更远处，它返回一个长列表。这是有大量行是返回的一行的倾斜数据。不幸的是，树中使用的大多数项目实际上是返回的大集合。由于这是一个嵌套集合，它始终是范围查询，而不是相等查询。根据我的阅读，Oracle 的直方图仅适用于相等条件。

这会导致非常低效的查询计划，对数千行的集合使用“合并连接笛卡尔”计划。树的连接是作为交付视图实现的，所以我在基数提示上所做的所有尝试都失败了。

有没有一种方法可以帮助它更好地估计基数，以便制定合理的查询计划？

# r - 在字符串matlab中测试重复和顺序

> ID：15821496
> 
> 赞同：0
> 
> 时间：2013-04-04T20:53:34.720
> 
> 标签：r, matlab, statistics

我在 400 次护理期间观察了护士，并记录了每次护理的表面接触顺序。

我将表面按 1:5 分为 5 组，并计算了触摸 1:5 中任何一个的概率密度函数 (PDF)。

```
PDF=[ 0.255202629   0.186199343 0.104052574 0.201533406 0.253012048] 
```

然后我使用以下方法预测了大约 1000 个序列：

```
for i=1:1000 % 1000 different nurses
    seq(i,1:end)=randsample(1:5,max(observed_seq_length),'true',PDF);
end 
```

例如。

```
 seq =     1     5     2     3     4     2     5     5     2     5

stairs(1:max(observed_seq_length),seq) hold all 
```

![在此处输入图像描述](https://i.stack.imgur.com/wmLUk.png)

我想将我的经验序列与我的预测序列进行比较。您认为最好的策略或属性是什么？

问候，

编辑：我把`r`它作为一个标签，因为由于问题的性质而不是 matlab 代码，这很容易属于该类别。

# variables - 批处理脚本中的@非@命令有什么区别？

> ID：15821497
> 
> 赞同：0
> 
> 时间：2013-04-04T20:53:35.967
> 
> 标签：variables, batch-file, command

批处理脚本中的@非@命令有什么区别？例如，@IF 和 IF 之间有什么区别

还有一个问题：批处理脚本中的 % 和 %% 有什么区别？例如，%G 和 %%G 有什么区别

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:23:25.390

`@`在一行的开头将执行该行但不将其写入输出。这就像`echo off`只为那条线转弯。请参阅[Windows 批处理脚本中的 @ 是什么意思？](https://stackoverflow.com/questions/15551768/what-does-mean-in-windows-batch-scripts/15551853#15551853)

`%%`用于`for`批处理文件内的循环以转义要“声明”的变量名。例如：

```
for %%a in (*.txt) do ( echo %%a ) 
```

如果您编写相同的`for`循环但不在批处理文件中，则不会加倍`%`：

```
for %a in (*.txt) do ( echo %a ) 
```

我一直不明白为什么，我只知道事情就是这样。:-) 也许其他人可以详细说明。

# java - 模拟检查 MethodInvocation

> ID：15821505
> 
> 赞同：0
> 
> 时间：2013-04-04T20:54:09.960
> 
> 标签：java, proxy, mockito, interceptor

我想检查是否使用 mockito 使用特定参数调用了该方法。

我的代码，每次`unit.permission().someCommand()`被调用时，拦截器的方法`invoke`都会被调用。`invoke`方法如下所示：

```
void invoke(MethodInvocation methodInvocation) .. 
```

这是一个测试，我检查拦截器的方法是否被调用。

```
@Test
public void permission() throws Throwable {
    unit.permission().someCommand();

    verify(mockedMethodInterceptor, times(1)).invoke(any(MethodInvocation.class));
} 
```

如您所见，在此测试中，我使用了 MethodInvocation 的任何实例。

问题：

有没有办法检查特定的 MethodInvocation 实例以确保使用正确的参数调用了 invoke() 方法？此调用方法应保存有关 someCommand() 方法的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:24:06.390

是的。

对于这个简单的情况，在测试中使用值本身可能是可以的：

```
@Test
public void permission() throws Throwable {
    MethodInvocation expectedInvocation = makeItHoweverYouDo();
    unit.permission().someCommand();

    verify(mockedMethodInterceptor, times(1)).invoke(expectedInvocation);
} 
```

让它*成为*你的代码实际调用的那个可能需要你在生产代码的某个地方注入这个值。您可能需要进行更改才能使之成为可能。

如果您在通话中使用了`Matcher`s，则必须在任何地方使用它们。`verify`为此，有一个匹配器 ( `eq`) 用于匹配一个值：

```
 verify(mockedMethodInterceptor, times(1)).invoke(eq(expectedInvocation)); 
```

你在这里不需要它，但如果你的方法有另一个参数，你想使用`any`匹配器，你就需要它。

# jsp - 检索存储为请求属性的数组元素属性的正确 EL 语法是什么？

> ID：15821506
> 
> 赞同：0
> 
> 时间：2013-04-04T20:54:15.000
> 
> 标签：jsp, el

我将 ArrayList 设置为 jsp 页面的请求属性。数组列表由我的 servlet 填充。我使用数组列表来填充页面上正常运行的下拉列表。当用户在下拉列表中选择一个项目时，我想使用选择的索引从数组列表中的相应元素中检索一个值，并将该值显示在另一个页面元素（名为“limit”）中。我想我只是无法正确使用 EL 语法。

JSP 中的下拉菜单（正确显示选项）：

```
<span>                                  

<select id="dropdown1" name="coveragelist" onchange="displaylimit(this)">
<option>Select coverage</option>
<c:forEach items="${coveragelist}" var="coverage">
<option value="${coverage.coverageCode}" />
<c:out value="${coverage.coverageCodeDesc}" />
</c:forEach>
</select>

</span> 
```

JS函数：

```
<script>
function displaylimit(coveragedropdown)
{
var index = coveragedropdown.selectedIndex;
limit = "${requestScope.coveragelist[index].coverage.coverageLimit}";
document.getElementById("limit").innerHTML = limit;

}
</script> 
```

该数组包含 Coverage 对象，这些对象具有由 coverageCode、coverageCodeDesc 和 coverageLimit 定义的属性。

索引字段确实包含下拉列表中所选项目的正确值（尽管我可能需要从中减去 1 - 我必须检查）。我只是无法从覆盖列表的特定元素中获得限制值，我无法弄清楚我做错了什么。这可能很简单。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T19:32:36.680

您尝试`index`在服务器端解析表达式中使用客户端运行时 JavaScript 变量。

我想你会得到 JspException 只是试图服务器那个`<script>`片段。

一种方法是`coverageLimits`在服务器上构建 JavaScript 数组并将其嵌入到`displaylimit`函数中

这是执行此操作的一种方法：

```
function displaylimit(coveragedropdown)
{
  var index = coveragedropdown.selectedIndex;

  // Build the list on a server
  // I am not a JavaScript expert, so you may need to
  // do some escaping/quoting here
  var coverageLimits = [
    <c:forEach items="${coveragelist}" var="coverage">
      ${fn:escapeXml( coverage.coverageLimit )},
    </c:forEach>
  ];

  var limit = coverageLimits[index];
  document.getElementById("limit").innerHTML = limit;
} 
```

# php - 自定义 Prestashop Paypal Express 结帐订单详细信息

> ID：15821510
> 
> 赞同：1
> 
> 时间：2013-04-04T20:54:28.323
> 
> 标签：php, paypal, prestashop, express-checkout

我正在尝试破解 paypal 模块以更改通过 Express Checkout API 发送的订单详细信息。

使用 PS 1.5.4 和最新的 Paypal 模块，paypal 页面如下所示：

```
Item Name                    Amount + Tax
Item Description
Item Number
Item Price + Tax
Quantity

...

Item Total                   Total + Tax
Shipping And Handling        Shipping + Tax
Total                        Total 
```

我宁愿让它显示税前价格，然后只有这样的总税线：

```
Item Name                    Amount
Item Description
Item Number
Item Price
Quantity

...

Item Total                   Total
Shipping And Handling        Shipping
Total Tax                    Total Tax

Total                        Total 
```

我已经对 process.php 进行了修改，但我必须遗漏一些东西，因为我的“被黑” process.php 出现错误。当我将其切换回默认值时，它可以正常工作。

这是 github repo 上原始 process.php 文件的链接： [https ://github.com/PrestaShop/PrestaShop-modules/blob/master/paypal/express_checkout/process.php](https://github.com/PrestaShop/PrestaShop-modules/blob/master/paypal/express_checkout/process.php)

我被黑的 process.php 的差异和原始文件的备份：

```
Comparing files process.php and PROCESS.PHP.BAK
***** process.php
private function setProductsList(&$fields, &$index, &$total) {
...
    $fields['L_PAYMENTREQUEST_0_AMT'.$index] = Tools::ps_round($product['price'], $this->decimals);
    $fields['L_PAYMENTREQUEST_0_QTY'.$index] = $product['quantity'];

    $product_tax = $product['price_wt'] - $product['price'];
    $total = $total + (($fields['L_PAYMENTREQUEST_0_AMT'.$index] + $product_tax) * $product['quantity']);
***** PROCESS.PHP.BAK
private function setProductsList(&$fields, &$index, &$total) {
...
    $fields['L_PAYMENTREQUEST_0_AMT'.$index] = Tools::ps_round($product['price_wt'], $this->decimals);
    $fields['L_PAYMENTREQUEST_0_QTY'.$index] = $product['quantity'];
*****
***** process.php
private function setPaymentValues(&$fields, &$index, &$total, &$taxes){
...
    else
            $shipping_cost_wt = $this->context->cart->getTotalShippingCost(null, false);
***** PROCESS.PHP.BAK
private function setPaymentValues(&$fields, &$index, &$total, &$taxes){
...
    else
        $shipping_cost_wt = $this->context->cart->getTotalShippingCost();
*****
***** process.php
private function setPaymentValues(&$fields, &$index, &$total, &$taxes) {
...
        $fields['PAYMENTREQUEST_0_AMT'] = $total + $fields['PAYMENTREQUEST_0_SHIPPINGAMT'];
        $fields['PAYMENTREQUEST_0_TAXAMT'] =   $this->context->cart->getOrderTotal() - $this->context->cart->getOrderTotal(
false);
    }
***** PROCESS.PHP.BAK
private function setPaymentValues(&$fields, &$index, &$total, &$taxes) {
...
        $fields['PAYMENTREQUEST_0_AMT'] = $total + $fields['PAYMENTREQUEST_0_SHIPPINGAMT'];
    }
***** 
```

这是我得到的错误。

```
Error occurred:
Please try to contact the merchant:
PayPal response:
TIMESTAMP -> 2013-04-04T09:09:42Z
L_ERRORCODE0 -> 10413
L_SHORTMESSAGE0 -> Transaction refused because of an invalid argument. See additional error messages for details.
L_LONGMESSAGE0 -> The totals of the cart item amounts do not match order amounts.
L_SEVERITYCODE0 -> Error 
```

任何人都有任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:40:57.633

`PAYMENTREQUEST_0_ITEMAMT`将总和添加`$fields['L_PAYMENTREQUEST_0_AMT'.$index]`到您的 API 调用中。

当我开始添加运费时，我遇到了这个问题，这与您发生的情况`PAYMENTREQUEST_0_AMT`不**完全一样。**

我最好的建议是，`PAYMENTREQUEST_0_ITEMAMT`只要项目成本的总和不同于`PAYMENTREQUEST_0_AMT`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-23T14:47:17.503

好的，我终于修好了。我可以写出具体的代码修复，但我觉得它对我的情况和这个版本的 prestashop 来说太专业了。如果有人要求，我会添加它。

更重要的部分是我是如何发现这个错误的。由于模块发送请求，然后必须从响应中找出是否有错误，因此无法调试 var_dump 或 echo。

相反，我编写了一个简单的自定义日志文件来将值转储到该过程中。我已经读到由于潜在的锁定问题，在 apache 日志中这样做是不受欢迎的。

所以 TLDR：使用 PHP 文件函数并将总数和其他变量记录到同一目录中的文件中。

# jquery - 克隆表并修改克隆会修改原始元素

> ID：15821512
> 
> 赞同：0
> 
> 时间：2013-04-04T20:54:32.727
> 
> 标签：jquery, clone

我有一个巨大的表，我想克隆并将克隆分成 2 个单独的表，保持原始表不变。

假设原始表名为#MainTable，有 10 列

我创建了一个克隆#CloneTable，它最初还包含#MainTable 的所有 10 列

现在，我更改#CloneTable，这样#CloneTable 有前5 列，另一个表#RemainingClone 有剩余的5 列

现在，这里发生的情况是，我的原始表 #MainTable 突然也丢失了 5 列并更新为仅保留 #CloneTable 具有的那些列。

#MainTable 不应该不受对#CloneTable 所做更改的影响吗？

编辑 1：我正在使用 jquery clone()，如标签所示。

### 编辑2：这是一些代码 -

```
 $("#MainTable").clone().attr('id', 'CloneTable').appendTo("#printingDiv");
 splitTable();

function splitTable() {
     var divider = 5;
     var $tableOne = $('table').attr('id','CloneTable');
     var $tableTwo = $tableOne.clone().attr('id','RemainingClone').appendTo('#printingDiv');

     // number of rows in table
     var numOfRows = $tableOne.find('tr').length;

     // select rows of each table
     var $tableOneRows = $tableOne.find('tr');
     var $tableTwoRows = $tableTwo.find('tr');

     // loop through each row in table one.
     // since table two is a clone of table one,
     // we will also manipulate table two at the same time.
     $tableOneRows.each(function(index){
         // save row for each table
         var $trOne = $(this);
         var $trTwo = $tableTwoRows.eq(index);

         // remove columns greater than divider from table one
         $trOne.children(':gt('+divider+')').remove();
         $trTwo.children(':lt('+(divider+1)+')').remove();
    });
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:15:00.983

在`splitTable()`您调用的函数中：

```
var $tableOne = $('table').attr('id','CloneTable'); 
```

这会将*所有* `<table>`元素的 ID 设置为“CloneTable”，包括最初克隆它的那个，即“MainTable”，并引用这两个 DOM 元素。对此 jQuery 对象的所有更改现在都将影响这两个表。要获取克隆的表，您可以在创建 ID 时使用以下内容：

```
var $tableOne = $('table#CloneTable'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:12:45.583

这是一个小提琴，它显示了一种做你描述的方式：[DEMO](http://jsfiddle.net/Wa8Wh/5/)。我没有看到您描述的行为（即原始版本及其一些克隆被修改）。

**JS**

```
$(function() {
    var firstFive = $('#main').clone();
    var secondFive = $('#main').clone();
    $('body').append(firstFive);
    $('body').append(secondFive);
    firstFive.find('tr').each(function() { 
        $(this).find('td:gt(4)').remove()
    });
    secondFive.find('tr').each(function() { 
        $(this).find('td:lt(5)').remove()
    });
}) 
```

**HTML**

```
<table id="main">
    <tr>
        <td>1.1</td>
        <td>1.2</td>
        <td>1.3</td>
        <td>1.4</td>
        <td>1.5</td>
        <td>1.6</td>
        <td>1.7</td>
        <td>1.8</td>
        <td>1.9</td>
        <td>1.10</td>
    </tr>
    <tr>
        <td>2.1</td>
        <td>2.2</td>
        <td>2.3</td>
        <td>2.4</td>
        <td>2.5</td>
        <td>2.6</td>
        <td>2.7</td>
        <td>2.8</td>
        <td>2.9</td>
        <td>2.10</td>
    </tr>
</table> 
```

希望能帮助到你。

**编辑：**这是在代码示例之前发布的。

# c - 机器的实际价值——C中的“细节”

> ID：15821513
> 
> 赞同：0
> 
> 时间：2013-04-04T20:54:39.287
> 
> 标签：c

我一直在阅读[C++ Primer](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)，因为所有关于 C++11 语言变得多么可用的说法。这本书可能还不错，但它仍然让我每隔几页就想知道代码的真正作用。结果我最终在[谷歌上搜索](https://stackoverflow.com/questions/4244311/gcc-width-of-long-int-on-different-architectures/4244405#4244405) [了很多](https://stackoverflow.com/questions/5254051/the-difference-of-int8-t-int-least8-t-and-int-fast8-t/5254157#5254157) [很多](https://stackoverflow.com/questions/11656241/how-to-print-uint128-t-number-using-gcc)[东西](http://gcc.gnu.org/bugzilla/show_bug.cgi?id=54342) [......](http://c-faq.com/struct/align.esr.html)只是最终得到了一些类似“机器特定”或“实现定义”等[的](https://stackoverflow.com/questions/7016861/null-pointer-in-c-and-c)[东西。](http://c-faq.com/null/)

我意识到这意味着什么，以及可移植代码的重要性。

但我确实想知道，“普通”64 位 x86 PC 的这些细节的实际值是多少？由于 GCC、Visual Studio 等实际上并没有询问在所有这些情况下要做什么，而只是编译代码（它可以工作！），似乎有一些针对桌面的合理默认设置。

是否有涵盖这些细节的文档（以非编译器编写者可以理解的方式，例如我链接到的页面）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T20:59:32.277

大多数 Unix 或 Linux 系统，您可以登录并发出命令

定位limits.h

它会找到一些包含文件，其中列出了编译器使用的值的“限制”。Linux 内核代码中的许多限制文件都是特定于体系结构的，这是您特别感兴趣的

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:46:04.653

坦率地说，便携性很难达到 100%。我已经编程了 30 年，除了 100% 可移植的简单程序外，我从未见过任何东西。鉴于 PC 无处不在，我认为您不应该关心可移植性而不是功能。因此，您找到的所有引用都是“定义的实现”。

在一个完美的世界里，程序应该是可移植的。在现实世界中，操作系统制造商添加功能以与其他操作系统制造商甚至他们自己竞争（Win 95、98、2000、XP、7、Vista）（和 Linux 发行版存在差异）。因此，便携性——在我的经验中——意味着你不愿意做出权衡：太慢、太笨重、太多的开发时间、太多的测试等等。如果你寻求便携性，你需要问为什么，是否值得。即使您决定这样做，您也会发现自己会根据您的环境添加编译时选项，并且最终可能会得到特定且不可移植的整个文件。

当我为 Atmel Mega16 编写代码时，我不会考虑是否要移植该代码。在这种情况下，您没有无限的 CPU 周期和无限的内存来考虑便携式解决方案——我们正试图从一个小微型中挤出所有的汁液。

同样，您通常需要优化汇编程序中的例程，以便获得更多功能的 CPU 周期。（就像一个运行 DFT 的 DSP——当你第一次发布它时它在 C 中是可以的，但最终你需要将它减少到 ASM 以取回一堆 CPU 周期，以便你的老板希望你在明天早上之前添加另外 23 个功能。该死的便携性。）

所以，是的，很多都是特定于实现的。在 PC 世界中，您拥有更多的奢侈，但如果您正在编写与硬件接口的代码，您通常会被迫创建不可移植的代码。我可以继续讨论这个问题，但我有一个需要优化的循环......

# apache - 在本地服务器上测试移动应用程序

> ID：15821517
> 
> 赞同：0
> 
> 时间：2013-04-04T20:54:47.467
> 
> 标签：apache, mobile, apache2, mobile-safari

我有一个简单的问题，我开始在我的本地机器上使用 PHP 开发一个移动应用程序，我使用 Ubuntu 和 apache2 服务器，问题是我如何在我的笔记本电脑上测试我的移动模板，就像我在移动设备上看到它一样（iphone ,...)，对于简单的页面，我们使用firefox或IE浏览器，但对于移动寺庙，尺寸不同。移动应用程序的开发人员如何在本地对其进行测试。

操作系统：Ubuntu 11.10，服务器：apache2，IDE：netbeans。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T18:37:07.773

我找到了一个解决方案，这里有一个模拟器列表：[http ://www.mobilexweb.com/emulators](http://www.mobilexweb.com/emulators)

# c - 检查数组是否包含来自C中另一个数组的所有数组值

> ID：15821519
> 
> 赞同：0
> 
> 时间：2013-04-04T20:54:51.497
> 
> 标签：c, arrays, if-statement, contains

我试图制作一个程序来检查一个数组是否包含另一个数组中的所有数组值。因此，如果这是真的，程序将使用它的值返回 1。如果不正确，它将返回 0（我将其命名为 p）。不过我没能做那个程序。请你帮助我好吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-16T16:06:47.883

```
#include <stdio.h>

int isSubset(int arr1[], int arr2[], int m, int n)
{
    int i = 0;
    int j = 0;
    for (i=0; i<n; i++)
    {
        for (j = 0; j<m; j++)
        {
           if(arr2[i] == arr1[j])
              break;
        }

        /* If the above inner loop was not broken at all then
           arr2[i] is not present in arr1[] */
        if (j == m)
           return 0;
    }

    /* If we reach here then all elements of arr2[] 
      are present in arr1[] */
    return 1;
}

int main()
{
    int arr1[] = {11, 1, 13, 21, 3, 7};
    int arr2[] = {11, 2, 7, 1};

    int m = sizeof(arr1)/sizeof(arr1[0]);
    int n = sizeof(arr2)/sizeof(arr2[0]);

    if(isSubset(arr1, arr2, m, n))
      printf("arr2[] is subset of arr1[] ");
    else
      printf("arr2[] is not a subset of arr1[]");      

    getchar();
    return 0;
} 
```

**Ideone 链接启动并运行**：http: [//ideone.com/4u9oQm](http://ideone.com/4u9oQm)

# asp.net - ASP.NET 中的自动语言文化选择和回退算法

> ID：15821521
> 
> 赞同：1
> 
> 时间：2013-04-04T20:54:55.913
> 
> 标签：asp.net, asp.net-mvc, internationalization

我们正在建立一个支持多种语言的网站。我们创建了支持 fr、de 和 en-US 的资源，默认使用 en-US。我已经添加了：

```
<system.web>
    <globalization 
        uiCulture="auto" culture="auto" 
        requestEncoding="utf-8" 
        responseEncoding="utf-8" 
        enableClientBasedCulture="true" />
    ...
</system.web> 
```

到我的`web.config`档案。如果我在 IE 或 Chrome 中将语言设置为 fr、de 或 en-US，我会得到预期的语言。如果我将语言设置为 ar-EG，我会得到 en-US，也如预期的那样。

如果我将我的语言设置为 fr-FR，但在接受的语言列表中不包括 fr，则站点返回 fr 页面，即使我告诉浏览器我更喜欢接受 de 而不是通用 fr（而不是 fr-FR ）。这似乎违反了 RFC，但并不奇怪，因为 IE 在法国默认为 fr-FR，在德国默认为 de-DE，并且不适用于不会自动概括文化的站点。

但是，如果我告诉浏览器我接受 ar-EG 和 fr，则站点默认为 en-US——即使 Accept-Language 标头指定我将接受具有更高优先级的 fr。我在浏览器中捕获了请求标头，以确保我请求的所有语言都以正确的优先级发送。

似乎 ASP.NET 只查看 Accept-Language 标头中指定的第一种语言。是否在任何地方指定了 ASP.NET 语言匹配算法？有没有办法指定 ASP.NET/MVC 应检查 Accept-Language 列表中的所有语言以确定最佳语言？还是我必须编写自己的语言匹配代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:47:12.573

好吧，由于没有其他人回答，我提出我的建议。肯定有更好或至少更漂亮的解决方案，但对于我的需要来说已经足够了。只需在`Application_AcquireRequestState()`活动中设置文化：

```
protected void Application_AcquireRequestState()
{
    var language = "whatever"; // default fall back
    if (request.UserLanguages.Length > 0)
    {
        var acceptedLangs = new List<string> {"de", "en"};
        var langs = request.UserLanguages.Where(l => acceptedLangs.Any(al => al.Equals(l.Substring(0, 2))));
        language = langs.FirstOrDefault();
    }

    // TODO: may be better inside a try..catch block
    var culture = new CultureInfo(language);
    Thread.CurrentThread.CurrentUICulture = culture;
    Thread.CurrentThread.CurrentCulture = culture;
} 
```

# http - 即时修改 HTML 内容 => SLOW

> ID：15821523
> 
> 赞同：0
> 
> 时间：2013-04-04T20:54:57.317
> 
> 标签：http, networking, header, proxy, protection

我们正在开发基于代理的保护软件。它捕获用户的 http 请求，做代理工作，捕获 http 响应，修改其内容并将其发送回原始用户。

我们尝试了 2 次：

1.  SQUID 代理和 SQUID 的 PHP 外皮。很有希望，但是在 PHP 流中，我们不知道预期的响应数据的长度，所以每次都超时 => SLOW

2.  现在，我们编写了一个 .net 应用程序。它可以完成我们需要的一切，而且速度非常快，甚至不修改内容。如果我们需要 GZIP/GUNZIP，或者只是修改内容，就会变得很慢。

你可以帮我们吗？

我们在匈牙利的大学为这个项目工作了将近一年。我们编写了一个自动的、自学习的全语义分析引擎，它可以对所有语言进行分析和解释，并且可以检测和筛选目标内容。我们还构建了一个图像识别软件，它可以在所有图像中以 90% 的置信度检测目标对象。

所以一切都准备好了，但是我们的代理应用程序被卡住了。

我们也可以支付这份工作的费用，如果有人愿意写的话。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T10:40:38.650

感谢您的回复！

首先：我们的 PHP 非常快，fsockopen 很慢，因为它不知道何时关闭来自 SQUID 的响应连接。

这是我们的代码：

```
$buffer = socket_read($client, 4096);
    if ( !($handle = fsockopen(HOST, SQUIDPROXYPORT, $errno, $error, 1)) ) {
        Log::write($this->log, 'Errno: ' . $errno . ' Error: ' . $error . "\n" . $buffer);
        exit('Nem sikerült csatlakozni! ' . $errno . ':' . $error);
    }
    stream_set_timeout($handle, 0, 100000);

    fwrite($handle, $buffer);

    $result = '';
    do {
        $tmp = fgets($handle, 1024);
        if ( $tmp ) {
            $result .= $tmp;
        }
    } while ( !feof($handle) && $tmp != false );

    socket_write($client, $result, strlen($result));

    fclose($handle);
    socket_close($client); 
```

同样，它是如何工作的：

1.  客户端向我们发送 HTTP 请求
2.  我们的 PHP 获取请求，并将其标头发送到 SQUID 代理
3.  Squid 完成它的工作，并将响应数据发送回我们的 PHP
4.  我们的 PHP 通过 fsockopen 获取 squid 的响应数据
5.  我们分析响应数据，或修改它
6.  我们将其发回给客户

但是：当我们等待响应数据时，我们会收到它，但我们不知道什么时候关闭 PHP 和 SQUID 之间的连接。这导致工作缓慢，并且几乎每次都超时。

如果您有任何想法，请与我们分享！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:18:58.467

我花了很多时间在 PHP 上编程——是的，作为一种解释性语言，它可能很慢——而且有大量写得不好的代码可用——但即使在你开始接触代码之前，调整环境也可以减少执行时间5-10 倍。然后更改代码可以使其运行得更快；最大的胜利来自对架构和数据结构的良好选择（任何语言都是如此——不仅仅是 PHP）。

我不知道您从哪里开始，但令人惊讶的是，您无法处理相对于生成内容并通过网络发送内容所花费的时间量的流。让它超时是非常错误的。（您不是在尝试使用 XML 解析器之一解析 HTML 吗？）。内容的长度应该对脚本的性能几乎没有影响，除非您试图同时将其全部映射到 PHP 的地址空间中。

然而 AFAIK，不可能使用 PHP 直接在 Squid 中实现内容过滤器（如果你这样做了，我很想知道你是如何做到的，如果你已经实现了 ICAP，那也很有趣）。我猜您正在使用 URL 重定向器通过用 PHP 编写的代理脚本来路由请求。

可以用 C/C++ 编写 ECAP 模块。

图像识别和自然语言处理在编程中不是微不足道的练习——所以你的团队中必须有一些优秀的程序员。真正解决您的问题超出了堆栈溢出答案的范围，并且吹捧承包商绝对是题外话。

# html - 打印时如何修复 IE 表格、单选和复选框怪癖？

> ID：15821524
> 
> 赞同：0
> 
> 时间：2013-04-04T20:55:00.790
> 
> 标签：html, css, internet-explorer, printing, css-tables

我需要在 IE8、IE9 和 Chrome 中打印页面。它在 Chrome 中完美打印，在 IE8 中效果不佳（尚未测试 IE9）。

我现在使用 IE 面临的 3 个主要问题是：

1.  复选框和单选按钮宽度搞砸了，它有一个边框
2.  整个表单的额外填充，尤其是标签和字段之间
3.  内部表格边框不显示，第一列应隐藏

请参阅下面的屏幕截图。为什么会这样？我似乎无法修复它，我已经尝试过多次更改 css。我知道它正在阅读 CSS。

**复选框：** ![复选框宽度搞砸了，它有一个边框](https://i.stack.imgur.com/A5Bed.png)

**到处都有额外的填充：**

![整个表单的额外填充](https://i.stack.imgur.com/2fyI5.png)

**没有内部表格边框：** ![内部表格边框不显示 + 第一列应隐藏](https://i.stack.imgur.com/P2ul9.png)

**更新：**

表单在 Chrome 和 IE 中都能正确显示（显示表格边框、填充正确等）。它在 Chrome 中正确打印。它不能在 IE 中正确打印。

请不要告诉我以其他方式打印表格。我已经做出了从浏览器打印它的设计决定：这对我的项目来说是最好的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:02:08.830

1：你可能有类似的东西

```
input {border: ...; width: ...} 
```

这会影响您的复选框和收音机。至少在 Internet Explorer 中。您可以通过使用来解决此问题

```
input[type=radio], input[type=checkbox] {alternating styles} 
```

或通过分配特定的类：

```
input.radio, input.checkbox {alternating styles} 
```

2：您可以通过同时提供输入表单和旁边的标签来消除填充

```
text-align: vertical 
```

3：要解决边框，您应该为此提供 CSS ;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:04:56.843

我在页面中添加了一个带有边框的简单表格，以测试 IE 是否不显示表格边框，或者我的 css 是否被覆盖。当它起作用时，我意识到我的表被它的 ID 选择在其他地方（并删除了它的边框）。当我尝试添加用于打印的边框时，我选择的是表的类名而不是 ID。

我还意识到 jquery.jqprint 插件不包括它正在打印的 iframe 中的 doctype。现在，它在 IE8 中完美打印。

# mysql - 获取任何表的当前 AUTO_INCREMENT 值

> ID：15821532
> 
> 赞同：343
> 
> 时间：2013-04-04T20:55:27.940
> 
> 标签：mysql, auto-increment

如何获取 MySQL 中表的当前 AUTO_INCREMENT 值？

* * *

## 回答 #1

> 赞同：654
> 
> 时间：2013-04-04T20:56:09.240

您可以使用以下查询获取所有表数据：

```
SHOW TABLE STATUS FROM `DatabaseName` WHERE `name` LIKE 'TableName' ; 
```

您可以使用以下查询准确获取此信息：

```
SELECT `AUTO_INCREMENT`
FROM  INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = 'DatabaseName'
AND   TABLE_NAME   = 'TableName'; 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-01-16T09:33:20.267

如果您只想知道数字，而不是在查询中获取它，那么您可以使用：

```
SHOW CREATE TABLE tablename; 
```

您应该在底部看到 auto_increment

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2013-04-04T21:03:43.577

我相信您正在寻找 MySQL 的[LAST_INSERT_ID()](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_last-insert-id)函数。如果在命令行中，只需运行以下命令：

```
LAST_INSERT_ID(); 
```

您还可以通过 SELECT 查询获取此值：

```
SELECT LAST_INSERT_ID(); 
```

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2017-08-20T21:31:03.580

即使如果您手动运行查询， *methai*的答案是正确的，但当 2 个并发事务/连接在生产运行时实际执行此查询时（例如），就会出现问题。

刚刚在 MySQL 工作台中手动尝试，***同时打开了 2 个连接***：

```
CREATE TABLE translation (
  id BIGINT PRIMARY KEY AUTO_INCREMENT
);
# Suppose we have already 20 entries, we execute 2 new inserts: 
```

**交易一：**

```
21 = SELECT `AUTO_INCREMENT` FROM INFORMATION_SCHEMA.TABLES
     WHERE TABLE_SCHEMA = 'DatabaseName' AND TABLE_NAME = 'translation';

insert into translation (id) values (21); 
```

**交易2：**

```
21 = SELECT `AUTO_INCREMENT` FROM INFORMATION_SCHEMA.TABLES
     WHERE TABLE_SCHEMA = 'DatabaseName' AND TABLE_NAME = 'translation';

insert into translation (id) values (21);

# commit transaction 1;
# commit transaction 2; 
```

*   插入事务 1 正常
*   插入事务 2 出错：错误代码：1062。密钥“PRIMARY”的重复条目“21”。

一个好的解决方案是*jvdub*的答案，因为每个事务/连接的 2 个插入将是：

**交易一：**

```
insert into translation (id) values (null);
21 = SELECT LAST_INSERT_ID(); 
```

**交易2：**

```
insert into translation (id) values (null);
22 = SELECT LAST_INSERT_ID();

# commit transaction 1;
# commit transaction 2; 
```

但是我们必须在插入之后执行*last_insert_id()*！我们可以重用该 id 以插入到其他需要外键的表中！

此外，我们无法执行以下 2 个查询：

```
insert into translation (id) values ((SELECT AUTO_INCREMENT FROM
    information_schema.TABLES WHERE TABLE_SCHEMA=DATABASE()
    AND TABLE_NAME='translation')); 
```

因为我们实际上有兴趣在其他表中获取/重用该 ID 或返回！

**编辑：2021 年 2 月 8 日，检索值**

要实际检索应用程序中的值（在 Java 中使用 MyBatis 完成的示例）：

```
@Mapper
public interface ClientMapper {
    @Select("select last_insert_id()")
    Long getLastInsertedId();

    @Insert({...})
    void insertClientInfo(ClientInfo client);
} 
```

然后在存储库中

```
public void insertClientInfo(ClientInfo clientInfo) {
    mapper.insertClientInfo(clientInfo);
    Long pk = mapper.getLastInsertedId();
    clientInfo.setId(pk);
} 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2015-05-05T14:38:22.833

**mysqli 可执行示例代码：**

```
<?php
    $db = new mysqli("localhost", "user", "password", "YourDatabaseName");
    if ($db->connect_errno) die ($db->connect_error);

    $table=$db->prepare("SHOW TABLE STATUS FROM YourDatabaseName");
    $table->execute();
    $sonuc = $table->get_result();
    while ($satir=$sonuc->fetch_assoc()){
        if ($satir["Name"]== "YourTableName"){
            $ai[$satir["Name"]]=$satir["Auto_increment"];
        }
    }
    $LastAutoIncrement=$ai["YourTableName"];
    echo $LastAutoIncrement;
?> 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2020-02-28T11:01:26.650

查询以检查一个给定模式的所有表的 AUTO_INCREMENT 百分比“使用”（除了类型为*bigint unsigned*的列）：

```
SELECT 
  c.TABLE_NAME,
  c.COLUMN_TYPE,
  c.MAX_VALUE,
  t.AUTO_INCREMENT,
  IF (c.MAX_VALUE > 0, ROUND(100 * t.AUTO_INCREMENT / c.MAX_VALUE, 2), -1) AS "Usage (%)" 
FROM 
  (SELECT 
     TABLE_SCHEMA,
     TABLE_NAME,
     COLUMN_TYPE,
     CASE 
        WHEN COLUMN_TYPE LIKE 'tinyint(1)' THEN 127
        WHEN COLUMN_TYPE LIKE 'tinyint(1) unsigned' THEN 255
        WHEN COLUMN_TYPE LIKE 'smallint(%)' THEN 32767
        WHEN COLUMN_TYPE LIKE 'smallint(%) unsigned' THEN 65535
        WHEN COLUMN_TYPE LIKE 'mediumint(%)' THEN 8388607
        WHEN COLUMN_TYPE LIKE 'mediumint(%) unsigned' THEN 16777215
        WHEN COLUMN_TYPE LIKE 'int(%)' THEN 2147483647
        WHEN COLUMN_TYPE LIKE 'int(%) unsigned' THEN 4294967295
        WHEN COLUMN_TYPE LIKE 'bigint(%)' THEN 9223372036854775807
        WHEN COLUMN_TYPE LIKE 'bigint(%) unsigned' THEN 0
        ELSE 0
     END AS "MAX_VALUE" 
   FROM 
     INFORMATION_SCHEMA.COLUMNS
     WHERE EXTRA LIKE '%auto_increment%'
   ) c

   JOIN INFORMATION_SCHEMA.TABLES t ON (t.TABLE_SCHEMA = c.TABLE_SCHEMA AND t.TABLE_NAME = c.TABLE_NAME)

WHERE
 c.TABLE_SCHEMA = 'YOUR_SCHEMA' 
ORDER BY
 `Usage (%)` DESC; 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2017-08-02T08:28:49.660

如果列在 sql server 中自动递增，那么要查看当前的自动递增值，并且如果要编辑该列的值，请使用以下查询。

```
-- to get current value
select ident_current('Table_Name')

-- to update current value
dbcc checkident ('[Table_Name]',reseed,"Your Value") 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2020-02-19T01:42:24.893

我一直在寻找相同的方法，并最终在 Helper 类中创建了一个静态方法（在我的例子中，我将其命名为 App\Helpers\Database）。

**方法**

```
/**
 * Method to get the autoincrement value from a database table
 *
 * @access public
 *
 * @param string $database The database name or configuration in the .env file
 * @param string $table    The table name
 *
 * @return mixed
 */
public static function getAutoIncrementValue($database, $table)
{
    $database ?? env('DB_DATABASE');

    return \DB::select("
        SELECT AUTO_INCREMENT 
        FROM information_schema.TABLES 
        WHERE TABLE_SCHEMA = '" . env('DB_DATABASE') . "' 
        AND TABLE_NAME = '" . $table . "'"
    )[0]->AUTO_INCREMENT;
} 
```

要调用该方法并获取 MySql AUTO_INCREMENT，只需使用以下命令：

```
$auto_increment = \App\Helpers\Database::getAutoIncrementValue(env('DB_DATABASE'), 'your_table_name'); 
```

希望能帮助到你。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2021-12-25T03:09:55.113

列出 dbname 所有 tabename 和 AUTO_INCREMENT

```
SELECT `AUTO_INCREMENT`,`TABLE_NAME`
FROM  INFORMATION_SCHEMA.TABLES
WHERE TABLE_SCHEMA = 'dbname' ORDER BY AUTO_INCREMENT desc 
```

# objective-c - SplitViewController中TableView的宽度？

> ID：15821533
> 
> 赞同：0
> 
> 时间：2013-04-04T20:55:29.683
> 
> 标签：objective-c, xcode, ipad, uitableview, uisplitviewcontroller

所以我正在努力将我的 iPhone 应用程序转换为通用的。对于我的 UISplitViewController 中的 MasterController，它基本上与我的应用程序上的 TableViewController 相同，我试图在没有条目时将图像添加到 tableview 的中间。我仍在使用 Spring 和 Struts 而不是 AutoLayout。

但是，当我在 iPad 上加载 tableview 时，它会偏离中心。

我做了一个 NSLog`frame = [self.tableview frame]`并得到了值：

`[6148:c07] Width: 748.000000 [6148:c07] Height: 1024.000000 [6148:c07] X: 20.000000 [6148:c07] Y: 0.000000` 它基本上给出了整个 iPad 尺寸......我对一个带有主/详细信息的空 iPad 应用程序做了这个，它做同样的事情......奇怪

为什么宽度是748？

在我的 iPad 故事板中，它显示宽度 320 和高度 704？

谢谢！

# c++ - unique_ptr 成员，私有复制构造函数与移动构造函数

> ID：15821535
> 
> 赞同：4
> 
> 时间：2013-04-04T20:55:37.623
> 
> 标签：c++, c++11, unique-ptr, g++-4.7

给定多个派生类的基类，目标是创建一个包装类，允许 STL 容器查看具有基接口的对象，尽管实际上可能将不同的派生类添加到容器中。（请参阅[从异构 std::list 中检索数据](https://stackoverflow.com/q/15796341/315052)）。

经过一番修改，我想出了一个新的派生类，它是`unique_ptr`基类的包装器。但是，移动构造函数让我感到困惑。

```
class Base {
    friend class BaseWrapper;
    virtual Base * clone () const = 0;
public:
    virtual ~Base () {}
    //... public interface
};

class Derived : public Base {
    //... specific members for derived class
    Base * clone () const { return new Derived(*this); }
public:
    //... implement public interface
};

class BaseWrapper : public Base {
    std::unique_ptr<Base> ptr_;
    Base * clone () const { return ptr_->clone(); }
public:
    BaseWrapper (const Base &b) : ptr_(b.clone()) {}
    //... implement public interface by forwarding to ptr_
};

typedef std::list<BaseWrapper> BaseList;

int main () {
    BaseList l;
    l.push_back(Derived());
} 
```

[这不能与 g++ 4.7.2 一起编译](http://ideone.com/IFjkuo)。

现在，为了使用`BaseWrapper`，我可以像这样实现一个公共移动构造函数：

```
 BaseWrapper (BaseWrapper &&bw) { ptr_.swap(bw.ptr_); } 
```

[这很好用](http://ideone.com/w9FW9W)。但是，如果我将其设为私有，[它将无法编译](http://ideone.com/uHmkTP)。

但是，我发现除了上面的之外，[我可以定义一个私有的“复制”构造函数](http://ideone.com/uZe9hm)（当然，使其公开也可以）：

```
 BaseWrapper (BaseWrapper &bw) { ptr_.swap(bw.ptr_); } 
```

有人可以告诉我这是否应该工作，为什么或为什么不？如果它应该工作，为什么我不能将移动构造函数设为私有？

您可以点击[此链接](http://ideone.com/ZPeEoi)以更完整地说明上述内容的玩具程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:10:26.497

[删除错误诊断]

这实际上是在 gcc 4.8 上编译的。似乎 gcc 4.7 将`BaseWrapper (const Base &)`其作为复制构造函数（实际上不是），并隐式删除了移动构造函数（如果它确实是复制构造函数，这将是预期的行为）。

# c# - 调试底层 C++ DLL 中的问题

> ID：15821536
> 
> 赞同：1
> 
> 时间：2013-04-04T20:55:41.480
> 
> 标签：c#, c++, debugging, dll

我有一个主应用程序（在 C# 中），它解析图像数据库，然后将这些图像通过管道传输到 C++ DLL 中进行分析。现在由于某种原因，每 200 张左右的图像就会引发一个错误。它并不总是在同一张图像上引发错误，而只是在随机图像上引发错误（有时图像会通过分析，其他时候会引发错误）。

我能否以某种方式让我的 DLL 向 C# GUI 抛出异常，并提供有关 C++ 代码中错误源自何处的信息？代码本身应该可以正常运行，但我找不到错误的来源，所以我需要 DLL 的帮助来确定它至少发生在哪里。

任何帮助将不胜感激，到目前为止我没有找到任何帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:28:52.730

只需使用调试器来诊断。使用 Project + Properties 的 Debug 选项卡启用非托管调试器，勾选“启用非托管代码调试”选项。

“它会引发错误”太模糊，无法给出具体建议。但是您需要检查 Debug + Exceptions 对话框中的 Throw 复选框。根据抛出的异常类型，勾选“C++ 异常”和/或“Win32 异常”。如果您不知道，请勾选所有选项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:28:04.370

如果您在调试时无法获得错误，请在您的 C++ dll 中写入以输出您所在的函数。

例如，如果您在 dll 中有 func1、func2、func3，则每次进入和退出每个函数时都写下它们的名称。当您运行程序时，您将能够将其缩小到导致异常的函数，然后您可以在函数的每一行之后添加类似的输出以查找引发异常的代码。

# html - 为什么我的 HTML 签名在 Thunderbird 中正确显示，但在 Outlook 中显示不正确？

> ID：15821539
> 
> 赞同：2
> 
> 时间：2013-04-04T20:55:52.860
> 
> 标签：html, outlook, thunderbird

我编写了一些小的 HTML 代码用作 Thunderbird 中的签名。显示完美，Thunderbird 收到的电子邮件可以正常工作。但是，当在 Outlook 中收到我的电子邮件时，缺少颜色信息。

这是我的 HTML 代码（替换了名称和识别信息）

```
<html>
  <div class="Section1">
    <p><b><span style="font-size: 10pt;
          font-family:Arial,sans-serif; color: rgb(35, 53,
          64);padding-left: 10px;">
          <!--  NAME  -->
          First </span>
          <span style="font-size: 10pt;
          font-family:Arial,sans-serif; color: rgb(223, 93,
          39);"> Last <br>
        </span></b> 
        <span style="font-size: 9pt; font-family:
        Arial,sans-serif; color: rgb(35, 53, 64);padding-left:
        10px;">
        <!--    Job Title   -->
        Mobile App Developer
        &nbsp;<br>
      </span>
      <!--COMPANY NAME--> <b><span style="font-size: 11pt;
          font-family: Arial,sans-serif; color: rgb(223, 93,
          39);padding-left: 10px;">Company</span></b><b><span
          style="font-size: 11pt; font-family: Arial,sans-serif;
          color: rgb(35, 53, 64);">Name &reg;</span></b></p>
    <p>
      </span> <span style="font-size: 9pt; font-family:
        Arial,sans-serif; color: rgb(35, 53, 64);padding-left:
        10px;"><a class="moz-txt-link-abbreviated"
          href="mailto:email@email.com" style="color: rgb(35,
          53, 64);text-decoration:none;">
          <!--EMAIL ADDRESS--> email@email.com</a></span> | <span
        style="font-size: 9pt; font-family: Arial,sans-serif; color:
        rgb(223, 93, 39);">My.Name &nbsp;Skype</span><br>
      <b><span style="font-size: 10pt; font-family:
          Arial,sans-serif; color: rgb(35, 53, 64);padding-left:
          10px;"><a class="moz-txt-link-abbreviated"
            href="http://www.google.com" style="color: rgb(35, 53,
            64); text-decoration:none;">
            <!--WEBSITE URL--> www.google.com</a></span></b></p>
  </div>
  </body>
</html> 
```

外表：

![外表](https://i.imgur.com/lIFAYLQ.png)

雷鸟：

![雷鸟](https://i.imgur.com/nQ0jvbA.png)

我不确定问题是什么，因为我对 HTML 的经验很少。我从其他人的签名块中获取了大部分代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T21:01:12.723

尝试使用十六进制代码而不是`rgb(r, g, b)`. 例如，将出现次数替换`rgb(35, 53, 64)`为`#233540`。

您可以使用[http://www.javascripter.net/faq/rgbtohex.htm](http://www.javascripter.net/faq/rgbtohex.htm)找出十六进制代码。

# android - NetworkOnMainThread 异常 android。获取服务器响应

> ID：15821544
> 
> 赞同：0
> 
> 时间：2013-04-04T20:56:13.237
> 
> 标签：android, asynchronous

当我尝试使用以下代码时，出现异常 android.os.NetworkOnMainThreadException：

```
public class CheckServer  extends Activity{

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
        Runnable runn = null;
        HttpTask.execute(runn);

    }
    private class HttpTask extends AsyncTask<String, String, String>
    {

        @Override
        protected String doInBackground(String... params) {
            // TODO Auto-generated method stub
            HttpURLConnection urlConnection = null;

            URL theURL = null;
            try {
                theURL = new URL("http://192.168.2.8/parkme/Client/clientquery.php?ticket=66t");
            } catch (MalformedURLException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            try {
                urlConnection = (HttpURLConnection) theURL.openConnection();
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            String response = null;
            try {
                response = readInputStream(urlConnection.getInputStream());
            } catch (IOException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
            return response;

        }

        private String readInputStream(InputStream is) {
            // TODO Auto-generated method stub
            String line = "";
            StringBuilder total = new StringBuilder();
            BufferedReader rd = new BufferedReader(new InputStreamReader(is));
            try {
                while ((line = rd.readLine()) != null) {
                    total.append(line);
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
            return total.toString();

        }
        @Override
        protected void onPostExecute(String result) {
            // TODO Auto-generated method stub
            Toast.makeText(getApplicationContext(), result, Toast.LENGTH_LONG).show();
        }
}} 
```

如果可能的话，有人可以告诉我如何在异步任务中使用它并获得输出吗？我试过了，但似乎无处可去。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T20:58:49.680

好的，让我们一步一步来...

1）创建私有类扩展`AsyncTask`

```
private class HttpUrlConnectionTask extends AsyncTask { 
```

2）覆盖`doInBackground()`方法，这将做繁重的负载

```
@Override
protected Object doInBackground(Object... params) {
// your HttpUrlConnection code goes here

return response; 
```

3）一旦工作完成并返回，该`onPostExecute()`方法将被调用。该`result`参数包含 -so`doInBackground()`响应的返回值。

```
@Override
protected void onPostExecute(Object result) { 
```

在此方法中，您可以更新您的 UI。

4）最后让我们看看`HttpUrlConnection`代码

```
HttpURLConnection urlConnection = null;

URL theURL = new URL(url);
urlConnection = (HttpURLConnection) theURL.openConnection();
String response = readInputStream(urlConnection.getInputStream());
return response; 
```

希望这可以帮助。快乐编码！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T21:00:16.017

NetworkOnMainThread 发生异常是因为您在主 UI 线程上运行网络相关操作。这仅针对针对 Honeycomb SDK 或更高版本的应用程序抛出

您应该使用异步任务。

[http://developer.android.com/reference/android/os/AsyncTask.html](http://developer.android.com/reference/android/os/AsyncTask.html)

在 onCreate()

```
 new TheTask().execute(); 
```

您还可以将 url 等参数传递给 AsyncTask 的构造函数，并在 doInBackground() 中使用相同的参数

```
 class TheTask extends AsyncTask<Void,Void,Void>
 {
  protected void onPreExecute()
  {           super.onPreExecute();
            //display progressdialog.
  } 

   protected void doInBackground(Void ...params)//return result here
  {  
        //http request. do not update ui here

        return null;
  } 

   protected void onPostExecute(Void result)//result of doInBackground is passed a parameter
  {     
            super.onPostExecute(result);
            //dismiss progressdialog.
            //update ui using the result returned form doInbackground()

  } 

  } 
```

当一个异步任务被执行时，任务会经过 4 个步骤：

1.  onPreExecute()，在任务执行之前在 UI 线程上调用。此步骤通常用于设置任务，例如通过在用户界面中显示进度条。

2.  doInBackground(Params...)，在 onPreExecute() 完成执行后立即在后台线程上调用。**此步骤用于执行可能需要很长时间的后台计算。异步任务的参数传递到这一步。计算的结果必须由这一步返回，并将传递回最后一步。**此步骤还可以使用 publishProgress(Progress...) 来发布一个或多个进度单元。这些值在 UI 线程上的 onProgressUpdate(Progress...) 步骤中发布。

3.  onProgressUpdate(Progress...)，在调用 publishProgress(Progress...) 后在 UI 线程上调用。执行的时间是不确定的。此方法用于在后台计算仍在执行时在用户界面中显示任何形式的进度。例如，它可用于动画进度条或在文本字段中显示日志。

4.  onPostExecute(Result)，**在后台计算完成后在 UI 线程上调用。后台计算的结果作为参数传递给该步骤。**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T21:05:34.897

@Raghunandan 很好地解释了 AsyncTask 的工作原理

干得好：

```
public static class InitializeTask extends MyAsyncTask<String, String, String> {

private Activity activity;
private ProgressDialog dialog;

public InitializeTask(Activity activity) {
    this.activity = activity;
}

@Override
protected void onPostExecute(String result) {
        Toast.makeText(activity, result, Toast.LENGTH_SHORT).show();
}

@Override
protected String doInBackground(String... params) {
    HttpClient httpclient = new DefaultHttpClient();
    HttpGet httpget = new HttpGet("http://192.168.2.8/localhost/parkme/Client/clientquery.php?ticket=");
    try {
        HttpResponse response = httpclient.execute(httpget);
        if(response != null) {
            String line = "";
            InputStream inputstream = response.getEntity().getContent();
            return convertStreamToString(inputstream);
        } else {
            return "Unable to complete your request";
        }
    } catch (ClientProtocolException e) {
        return "Caught ClientProtocolException";
    } catch (IOException e) {
        return "Caught IOException";
    }
}

private String convertStreamToString(InputStream is) {
    String line = "";
    StringBuilder total = new StringBuilder();
    BufferedReader rd = new BufferedReader(new InputStreamReader(is));
    try {
        while ((line = rd.readLine()) != null) {
            total.append(line);
        }
    } catch (Exception e) {
        return "Stream Exception";
    }
    return total.toString();
}
} 
```

附带一点说明，通常认为只捕获异常是错误的代码，因为它会捕获任何东西，而您没有考虑到它是什么。

要在 Activity 中使用 AsyncTask，请执行以下操作：

```
InitializeTask task = new InitializeTask(this)
task.execute() 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-04T21:08:36.223

正如它所说的那样，在活动运行的线程上不允许网络活动。将代码移动到 Asynctask 是正确执行此操作的方法。虽然如果你只是想让你的概念仍然有效，你可以这样做......

```
//lazy workaround with newer than gingerbread
//normally UI thread can't get Internet.
if(Build.VERSION.SDK_INT >= 9){
    StrictMode.ThreadPolicy policy = new StrictMode.ThreadPolicy.Builder().permitAll().build();
    StrictMode.setThreadPolicy(policy);
} 
```

然后UI线程实际上可以。但是，我不会发布这样的东西，我什至没有尝试过。这只是我经常使用的懒惰调试动作。

# python - Python：使用用户输入通配符正则表达式字典

> ID：15821545
> 
> 赞同：0
> 
> 时间：2013-04-04T20:56:29.990
> 
> 标签：python, regex, python-3.x, wildcard, file-handling

我希望能够使用用户输入通配符在 Python 中搜索字典。

我发现了这个：

```
import fnmatch
lst = ['this','is','just','a','test', 'thing']
filtered = fnmatch.filter(lst, 'th*') 
```

这符合这个和事情。现在，如果我尝试输入整个文件并搜索

```
with open('testfilefolder/wssnt10.txt') as f:
 file_contents = f.read().lower()
 filtered = fnmatch.filter(file_contents, 'th*') 
```

这不匹配任何东西。不同之处在于，在我正在读取的文件中，我是一个文本文件（莎士比亚戏剧），所以我有空格，它不是一个列表。我可以匹配诸如单个字母之类的东西，所以如果我只有“t”，那么我会得到一堆 t。所以这告诉我我正在匹配单个字母 - 但是我想要匹配整个单词 - 但更重要的是，要保留通配符结构。

因为我想要发生的是用户输入文本（包括将成为通配符的内容），我可以将其替换为 'th*' 所在的位置。外卡会做它应该做的事情。这就引出了一个问题，我可以只插入一个变量来保存“th*”的搜索文本吗？经过一番调查，我想知道我是否应该以某种方式翻译“th*”，并找到了以下内容：

```
regex = fnmatch.translate('th*')
print(regex) 
```

哪个输出 `th.*\Z(?ms)`

这是做这件事的正确方法吗？我不知道是否需要。

什么是“传递正则表达式”的最佳方法，以及我在代码中的错误的想法，因为它没有像它那样对第二组代码中的传入文本字符串进行操作（正确）在第一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:15:10.510

如果问题只是你“有空格而且它不是一个列表”，为什么不把它变成一个列表呢？

```
with open('testfilefolder/wssnt10.txt') as f:
 file_contents = f.read().lower().split(' ') # split line on spaces to make a list
 filtered = fnmatch.filter(file_contents, 'th*') 
```

# php - 每行 HTML 和 PHP 5 个状态

> ID：15821547
> 
> 赞同：0
> 
> 时间：2013-04-04T20:56:36.600
> 
> 标签：php, html, count, rows

我想要一份州列表和它下面的城市。我希望每行有 5 个州，其下有记录的城市，然后我希望它开始新的一行。我开始试图弄清楚，我已经走了几个小时，我的大脑很痛。任何人都可以帮忙吗？

这是我现在拥有的：

```
$lookup = "SELECT state, city, count(city) as num FROM needs WHERE country IS NULL AND 

status='posted' GROUP BY state, city ORDER BY state, city";
if ($result = mysql_query($lookup)) {
        $num_rows = mysql_num_rows($result);

        echo "<table>";
        $i = 1;
        $cols = 3;
        $prev = '';
        while ($frows = mysql_fetch_array($result)) {
                $fcity = $frows['city'];
                $fstate = $frows['state'];
                $fcitycount = $frows['num'];  // num is holding your count by city

if ($fstate != $prev) {
echo "<tr><td><h2>$fstate</h2></td>";
$prev = $fstate;
}

echo "<tr><td><a href='browseresults.php?city=$fcity&state=$fstate'>$fcity, $fstate ($fcitycount)</a></td></tr>";

}
echo "</table>";
} 
```

***编辑：***

它应该如下所示：

```
Arkansas               Tennessee           Missouri
Searcy, AR (1)         Bartlett, TN (1)    St. Louis, MO (4)
Little Rock, AR (4)    Memphis, TN (3)     Perry, MO (3)
Benton, AR (2)                             Branson, MO (1)
                                           Shell, MO (2) 
```

除了它会做 5 次而不是 3 次

***编辑2：***

这是我尝试过的代码，但仍然无法正常工作：-/

```
$lookup = "SELECT state, city, count(city) as num FROM needs WHERE country IS NULL AND status='posted' GROUP BY state, city ORDER BY state, city";
if ($result = mysql_query($lookup)) {
        $num_rows = mysql_num_rows($result);

        echo "<table><td>";
        $i = 1;
        $j = 1;
        $cols = 5;
        $prev = '';
        while ($frows = mysql_fetch_array($result)) {
                $fcity = $frows['city'];
                $fstate = $frows['state'];
                $fcitycount = $frows['num'];  // num is holding your count by city

if ($fstate != $prev) {
echo "<tr><h2>$fstate</h2></tr>";
$prev = $fstate;
}

echo "<tr><a href='browseresults.php?city=$fcity&state=$fstate'>$fcity, $fstate ($fcitycount)</a><br></tr>";

if ($fstate != $prev) {
echo "</td><td>";
}

}
echo "</td></table>";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T02:38:07.073

根据您当前的代码尝试，这是一种方法。该州及其所有城市都在同一个单元格内。

```
echo "<table>";
     $i = 1;
     $cols = 3;  // of cells per row
     $prev = '';
echo "<tr>";   // start the first row  
while ($frows = mysql_fetch_array($result)) {
        $fcity = $frows['city'];
        $fstate = $frows['state'];
        $fcitycount = $frows['num'];  // num is holding your count by city

        if ($fstate != $prev) {

            if($i>$cols){  // check if we have reached our # of $cols
                echo "</td></tr><tr>";  // end cell/row and start new row
                $i=1; //reset counter
            }
            elseif ($prev != '') {  // if not the first cell/state
                echo "</td>";  // end cell before starting new cell/state
            }
            echo "<td><h2>$fstate</h2>";
            $prev = $fstate;
            $i++;
        }

        echo "<a href='browseresults.php?city=$fcity&state=$fstate'>$fcity, $fstate ($fcitycount)</a><br />";

}
echo "</td></tr>"; //end the last cell/row
echo "</table>"; 
```

通过更改`$cols`值（即`$cols=5`，您可以更改每行的单元格数。
请参阅 phpfiddle 中的示例 - [http://phpfiddle.org/main/code/pkg-90i](http://phpfiddle.org/main/code/pkg-90i)

这会创建一个像这样的表 -
![示例快照](https://i.stack.imgur.com/ln4WI.png)

# java - 更改颜色后如何恢复按钮的原始外观颜色？

> ID：15821549
> 
> 赞同：-3
> 
> 时间：2013-04-04T20:56:42.247
> 
> 标签：java, swing, jbutton, look-and-feel, uimanager

我改变了按钮的颜色。现在我想要它原来的外观和感觉。我想一次将颜色更改为我喜欢的颜色。之后，我希望按钮恢复其原始外观。

我怎么做 ？

这是更改颜色的代码 -

```
JButton but = JButton("Press now to up vote"); // :)
but.setBackground(Color.orange); 
//code to remove this color and get the original look back ??? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:02:15.533

```
Color oldColor = myButton.getBackground();
myButton.setBackground(Color.RED);
// ... do stuff
myButton.setBackground(oldColor); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T21:21:16.553

> 我希望按钮恢复其原始外观。

*   这段代码应该只是`button.setBackground(null);`

> 有没有办法找出旧颜色的名称/代码

*   默认`Colors`没有名字，只有安全`Colors(blue, red, orange ....)`

*   `old color`不是[JButton 有颜色数组](https://stackoverflow.com/a/5845007/714968)

*   UIManager 返回`javax.swing.plaf.ColorUIResource[r=xxx, g=xxx, b=xx]`, 包含数组`Colors`和`Insets`

# scala - 一阶逻辑的普遍存在量词

> ID：15821555
> 
> 赞同：32
> 
> 时间：2013-04-04T20:57:03.203
> 
> 标签：scala, functional-programming, logic

我正在学习 Scala 编程课程。有一次，导师说：

> 函数*blah*和*bladdy*是一阶逻辑的普遍和存在量词。

有人可以将“*一阶逻辑的普遍和存在量词*”翻译成英文吗？

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-04-04T21:07:35.763

那句话充满了行话。您可以[在此处](http://www.cse.lehigh.edu/~heflin/courses/ai-2002/quantify-q.html)`universal`找到对量词和`existential`逻辑量词的描述。

1.  A`Universal Quantifier`是适用于集合中所有元素的逻辑语句。
2.  An`Existential Quantifier`是适用于集合中至少一个元素的逻辑语句。

您还可以[在此处](http://en.wikipedia.org/wiki/First-order_logic)`first-order`查看逻辑的快速描述。该术语旨在与`first-order`逻辑`higher-order`分开：

1.  `First-order`逻辑语句是通常的语句；它们作用于集合的成员。
2.  `Higher-order`逻辑语句作用于其他逻辑语句；将它们视为元逻辑。

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2013-04-04T22:09:50.820

教科书[Language Proof and Logic](https://rads.stackoverflow.com/amzn/click/com/1575866323)为 Odersky 教授提到的全称量词和存在量词提供了这些英语表达方式。

全称量词∀

> 用于表达普遍的主张，我们用英语表达的那些用量化的短语，比如*everything* *、everything*、all *things*和*anything*。

 ***存在量词 ∃

> 用于表达存在性主张，我们用英语表达的主张使用诸如*某事*、*至少一件事*、*一个*和*一个*这样的短语。

这些术语的提及可能与使用高阶函数的集合操作相关或导致操作。`forall`在 Scala 中，通过集合上的and`exists`操作，从逻辑到代码的转换是非常自然的。这些类似于上面给出的普遍和存在的定义。一些简单的例子有助于说明这一点：

```
scala> val l = 1 to 10
l: scala.collection.immutable.Range.Inclusive = Range(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)

scala> l.forall(x => x > 0)
res0: Boolean = true

scala> l.forall(x => x > 1)
res1: Boolean = false 
```

这两个`forall`陈述只是询问这个集合的**所有**元素是否符合标准。

```
scala> l.exists(x => x < 1)
res2: Boolean = false

scala> l.exists(x => x < 2)
res3: Boolean = true 
```

这两个`exists`陈述只是询问这个集合的**任何**元素是否符合标准。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-04T22:13:34.057

要完全理解该陈述，您可能必须研究一些逻辑。但这是基本要点：

“量词”是您在逻辑语句中赋予*变量含义的方式。*如果我说“{something about `x`}”，它本身并没有太大的意义。你必须知道`x`它是真话还是假话。但是，如果我通过说“对于所有{关于}的事情”或“存在一个这样的{关于}的事情”来*量化*变量，那么我正在做出一个对或错的单一陈述。`x``x``x``x``x`

在“所有人`x`”的情况下，我是说“{something about `x`}”对于您可以选择的*任何内容都是正确的；* `x`这是普遍的量化。例如“对于所有`x`，`x`是偶数”是错误的陈述。

在“存在`x`这样一个”的情况下，我是说有一个可能的选择，`x`因此“{something about `x`}”是真的（我不是说那个选择是什么，只是有一个）。这是存在量化。`x`例如，“存在`x`一个偶数”是一个真实的陈述。

它们是对偶的，因为“对于所有`x`{something about `x`}”的含义与“存在一个`x`这样的事情是不真实的 {something about `x`}”和“存在一个`x`这样的事情 {something about `x`}”的意思与“it is NOT true that for all `x`it is not true that {something about `x`}”的含义相同。如果你仔细想想，希望这在直觉上是合理的。

如果您告诉我们函数`blah`和`bladdy`是什么，我们可以解释它们对应于全称和存在量词的方式，这可能对帮助您理解讲师的观点更有帮助。***

# ruby-on-rails - 将已删除的范围与设计身份验证一起使用

> ID：15821560
> 
> 赞同：1
> 
> 时间：2013-04-04T20:57:15.673
> 
> 标签：ruby-on-rails, devise, warden, soft-delete

我正在使用 Devise 处理 Rails 应用程序中的身份验证，并且正在使用 Permanent_records 软删除用户。我的 User 模型的默认范围是未删除的用户。如果用户删除（停用）他的帐户，我希望他能够通过登录重新激活他的帐户，类似于 Facebook 的做法。问题是，由于 Devise 不知道查找已删除的用户，因此找不到帐户。我考虑过覆盖 session#create 方法

```
 def create
    self.resource = warden.authenticate!(auth_options)
    set_flash_message(:notice, :signed_in) if is_navigational_format?
    sign_in(resource_name, resource)
    respond_with resource, :location => after_sign_in_path_for(resource)
  end 
```

但由于这是由 Warden 处理的，看来我很不走运。我担心如果我开始挖得太深，我会开始破坏东西。

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:09:23.100

你需要：

1.  覆盖`find_for_authentication`用户模型中的方法以允许查找任何用户[https://github.com/plataformatec/devise/blob/master/lib/devise/models/authenticatable.rb#L229](https://github.com/plataformatec/devise/blob/master/lib/devise/models/authenticatable.rb#L229)

2.  在您的模型中重新定义`after_database_authentication`方法以在此处删除已删除的标志[https://github.com/plataformatec/devise/blob/master/lib/devise/models/database_authenticatable.rb#L98](https://github.com/plataformatec/devise/blob/master/lib/devise/models/database_authenticatable.rb#L98)

就是这样，我相信。无需触摸控制器动作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-21T04:08:34.523

这适用于偏执狂宝石：

```
class << self
  def find_for_authentication(conditions)
    User.unscoped do
      user = super(conditions)
      user.restore!(recursive: true) if user.deleted?
      user
    end
  end
end 
```

# windows - 将摘要报告和磁盘信息添加到 VB 脚本

> ID：15821561
> 
> 赞同：0
> 
> 时间：2013-04-04T20:57:16.527
> 
> 标签：windows, vbscript

我希望有人可以帮助我处理这段代码。我想在这个脚本中添加两件事，但似乎根本无法让它工作。

该脚本工作正常，但不起作用的是尝试添加磁盘信息并尝试创建磁盘总大小的摘要报告。

最后，我试图输出什么

```
wmic diskdrive list brief /format:list 
```

会给你。

像这样的东西：

```
Caption=WDC WD2500BEKT-75PVMT1
DeviceID=\\.\PHYSICALDRIVE0
Model=WDC WD2500BEKT-75PVMT1
Partitions=1
Size=250056737280 
```

这是到目前为止的脚本

```
Option Explicit

const strComputer = "."
const strReport = "c:\path\to\file"

Dim objWMIService, objItem, colItems 
Dim strDriveType, strDiskSize, txt

Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set colItems = objWMIService.ExecQuery("Select * from Win32_LogicalDisk WHERE        DriveType=3")
txt = "Drive" & vbtab & "Size" & vbtab & "Used" & vbtab & "Free" & vbtab & "Free(%)" & vbcrlf
For Each objItem in colItems

DIM pctFreeSpace,strFreeSpace,strusedSpace

pctFreeSpace = INT((objItem.FreeSpace / objItem.Size) * 1000)/10
strDiskSize = Int(objItem.Size /1073741824) & "Gb"
strFreeSpace = Int(objItem.FreeSpace /1073741824) & "Gb"
strUsedSpace = Int((objItem.Size-objItem.FreeSpace)/1073741824) & "Gb"
txt = txt & objItem.Name & vbtab & strDiskSize & vbtab & strUsedSpace & vbTab & strFreeSpace & vbtab & pctFreeSpace & vbcrlf

Next

writeTextFile txt, strReport
wscript.echo "Report written to " & strReport & vbcrlf & vbcrlf & txt

' Procedure to write output to a text file
private sub writeTextFile(byval txt,byval strTextFilePath)
Dim objFSO,objTextFile

set objFSO = createobject("Scripting.FileSystemObject")

set objTextFile = objFSO.CreateTextFile(strTextFilePath)

objTextFile.Write(txt)

objTextFile.Close
SET objTextFile = nothing
end sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T23:03:30.523

调用和你的`wmic`脚本做完全不同的事情。前者查询[`Win32_DiskDrive`](http://msdn.microsoft.com/en-us/library/aa394132)类以收集有关*物理磁盘*的信息，而后者查询[`Win32_LogicalDisk`](http://msdn.microsoft.com/en-us/library/aa394173)类以收集有关*卷*的信息。

您可以使用以下内容重现`wmic`命令的输出：

```
Set wmi = GetObject("winmgmts://./root/cimv2")
For Each disk In wmi.ExecQuery("SELECT * FROM Win32_DiskDrive")
  WScript.Echo "Caption=" & disk.Caption & vbNewLine _
    & "DeviceID=" & disk.DeviceID & vbNewLine _
    & "Model=" & disk.Model & vbNewLine _
    & "Partitions=" & disk.Partitions & vbNewLine _
    & "Size=" & disk.Size
Next 
```

但是，此查询返回的大小是物理磁盘的原始容量。在此级别，您无法区分块是“空闲”还是“已使用”。这些是适用于文件系统的概念。在该级别上，扇区包含或不包含一个或多个文件或文件片段。当它不包含任何文件时它是“免费的”，否则是“使用的”。但是，在该级别上，您不会获得有关“分区”的任何信息，因为它们存在于较低级别（分区包含文件系统）。

您需要做的是确定您实际想要报告的信息，然后从相关的 WMI 类中选择适当的属性。

# laravel - 以 JSON 形式返回多个 Laravel Eloquent 模型

> ID：15821563
> 
> 赞同：3
> 
> 时间：2013-04-04T20:57:21.507
> 
> 标签：laravel, laravel-4

我的“用户”模型与“图像”模型具有多重关系。

只返回用户就像“return Response::eloquent($user);”一样简单。我想返回一个 JSON 数组 {user: {id:…}, images: [{id:…},{id:…}]} 或者，也许更好，{id:…, images: [{ id:…},{id:…}]}

安排和运送这些模型的最佳方式是什么？我是不是该

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-05T12:52:22.230

您需要做的第一件事是确保您的模型设置正确：

```
class Users extends Eloquent {

    public function images()
    {
        return $this->hasMany('Image');
    }

}

class Image extends Eloquent {

    public function user()
    {
        return $this->belongsTo('User');
    }

} 
```

然后在您的路线中，您应该能够执行以下操作：

```
Route::any('userinfo/{$userId}', function($userId)
{
    return Response::json(User::with('images')->find($userId));

    //or

    return User::with('images')->find($userId)->toJson();
}); 
```

# .net - 自定义组件的设计器代码隐藏中的额外注释行

> ID：15821567
> 
> 赞同：1
> 
> 时间：2013-04-04T20:57:34.760
> 
> 标签：.net, code-behind, windows-forms-designer

我在 .NET 中创建了一个组件，在设计器代码隐藏中，将组件拖放到表单上后，该组件有三个额外的注释行。一个普通的 MS 组件如下所示：

```
///
/// myComponentClass1
///
//properties for the component set in the designer here 
```

但我的看起来像这样：

```
///
/// myComponentClass1
///
///
///
///
//properties for the component set in the designer here 
```

关于如何阻止 Visual Studio 添加这些额外的注释行的任何想法？

# html - 如何修复 HTML 中的重叠框

> ID：15821570
> 
> 赞同：0
> 
> 时间：2013-04-04T20:57:46.490
> 
> 标签：html, overlapping

我正在为我的视频制作网站，并且正在设置类似于视频缩略图的图片。我希望每“行”有 2 张图片。但这就是它的样子：

```
 -----
                       |   |
                       -----
                              -----
                              |   |
                              ----- 
```

我“画”出的每一个盒子都是一个带有图片和一些文字的盒子。

这是CSS：

```
#videoList{
width: 480px;
margin: 15px;
background: #DBDBDC;
float: left;
clear: both;
text-align: center;
text-indent: 20px;
}
#videoList2{
width: 480px;
margin: 15px;
background: #DBDBDC;
float: right;
clear: both;
text-align: center;
text-indent: 20px;
} 
```

这是 HTML：

```
<div id="videoList">
                <p>
                <a href="something.html">video title</a>
                </p>
                <img src="images/img.jpeg" />
            </div>

<div id="videoList2">
                <p>
                <a href="something.html">video title</a>
                </p>
                <img src="images/img.jpeg" />
            </div> 
```

有什么办法可以让两个盒子上线吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:41:06.853

试试这个：CSS>>>

```
#videoList{
width: 480px;
margin: 15px;
background: #DBDBDC;
float: left;
text-align: center;
text-indent: 20px;
}

#videoList2{
width: 480px;
margin: 15px;
background: #DBDBDC;
float: left;
text-align: center;
text-indent: 20px;
}
#videoContainer{width: 1020px; height: 300px; background-color: pink} 
```

`

这是 HTML：

```
<div id="videoContainer">
    <div id="videoList">
     <p>
         <a href="something.html">video title</a>
     </p>
     <img src="images/img.jpeg" />
    </div>

   <div id="videoList2">
    <p>
     <a href="something.html">video title</a>
    </p>
    <img src="images/img.jpeg" />
   </div>  
</div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:42:12.980

如果窗口足够大以使两个框可以放在同一行上，这将起作用：

```
<div id="videoList">
            <p>
            <a href="something.html">video title</a>
            </p>
            <img src="images/img.jpeg" />
        </div>
<div id="videoList">
            <p>
            <a href="something.html">video title</a>
            </p>
            <img src="images/img.jpeg" />
        </div> 
```

CSS：

```
 #videoList{
       display: block-inline;
       width: 480px;
       margin: 15px;
       background: #DBDBDC;
       float: left;
       text-align: center;
       text-indent: 20px;
       } 
```

我添加了“显示：块内联；” 并删除了您的“清除：两者；” “明确：两者；” 类似于“浮动”，但倾向于将事情推到下面

显示：块内联；与使事物表现为文本有关，并且文本将显示在整个页面上，而不是在页面下方。

# java - 可以从构造函数参数的泛型类型推断出泛型类型吗？

> ID：15821574
> 
> 赞同：4
> 
> 时间：2013-04-04T20:57:57.973
> 
> 标签：java, generics, constructor

我想知道一个类的泛型类型是否可以由作为参数传递的另一个对象的泛型类型来定义？

我正在研究的是一个线程安全的迭代器，因此多个线程可以安全地迭代一个列表，而没有两个线程获得相同的对象。它以目前的形式运作良好，但我认为它可以做得更好。

```
import java.util.Iterator;
public class AtomicIterator implements Iterator<Object>
{
    private Iterator<?> it;

    public AtomicIterator(Iterable<?> iterable)
    {
        it = iterable.iterator();
    }

    public Object next()
    {
        synchronized(it)
        {
            if(it.hasNext())
                return it.next();
            else
                return null;
        }
    }
} 
```

一些代码已被省略，但这应该可以理解。目前要获得下一个对象，您总是被迫转换返回的对象，这似乎效率低下。

```
ArrayList<String> someList = new ArrayList<String>;
AtomicIterator it = new AtomicIterator(someList);
String example = (String)it.next(); 
```

问题显然是在我想要的地方`it.next()`返回类型`Object`，在这个例子中，它返回类型`String`

简单的解决方案是给`AtomicIterator`它自己的泛型类型，结果是这样的

```
ArrayList<String> someList = new ArrayList<String>();
AtomicIterator<String> it = new AtomicIterator<String>(someList);
String example = it.next(); 
```

然而，这对我来说似乎是多余的，`someList`已经明确定义了它的泛型类型`String`，我想要的是从给它的对象中`AtomicIterator`推断出它的泛型类型。`Iterable`

我真正想要的是这样的

```
import java.util.Iterator;
public class AtomicIterator implements Iterator<E>
{
    private Iterator<E> it;

    public <E> AtomicIterator(Iterable<E> iterable)
    {
        it = iterable.iterator();
    }

    public E next()
    {
        synchronized(it)
        {
            if(it.hasNext())
                return it.next();
            else
                return null;
        }
    }
} 
```

从那里可以做类似的事情

```
ArrayList<String> someList = new ArrayList<String>();
AtomicIterator it = new AtomicIterator(someList);
String example = it.next(); 
```

但这不起作用，因为泛型类型`E`只存在于构造函数的范围内。

有谁知道一个干净的方法来做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-04T21:00:06.423

将泛型类型添加到 AtomicIterator，以及（如果在 Java 6 下运行）静态工厂方法，因此它默认解析泛型类型

```
public class AtomicIterator<T> implements Iterator<T>
{
    private Iterator<T> it;

    public AtomicIterator(Iterable<T> iterable)
    {
        it = iterable.iterator();
    }

    public static <T> AtomicIterator<T> create ( Iterable<T> iterable )
    {
        return new AtomicIterator( iterable )
    }

    public T next()
    {
        synchronized(it)
        {
            if(it.hasNext())
                return it.next();
            else
                return null;
        }
    }
} 
```

这是用法：

```
ArrayList<String> someList = new ArrayList<String>;
AtomicIterator<String> it = AtomicIterator.create(someList); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:08:15.627

泛型的问题`AtomicIterator`在于构造函数本身是泛型的，并且具有与类的泛型类型参数不同的泛型类型。`<E>`in定义了与类泛型参数不同的`public <E> AtomicIterator`泛型参数，即使两者都是`E`. 在我最初尝试编译它时，我得到了一个相当混乱的错误：

```
AtomicIterator.java:8: incompatible types
found   : java.util.Iterator<E>
required: java.util.Iterator<E>
        it = iterable.iterator();
                              ^ 
```

解决方法：让构造函数的泛型参数`Iterable<E>`使用*类的*泛型参数'E'，方法是去掉`<E>`后面的 from`public`并将其添加到类中，因此泛型类型的范围`E`是整个类：

```
public class AtomicIterator<E> implements Iterator<E>
//                          ^ Added here 
```

...

```
public AtomicIterator(Iterable<E> iterable)
//    ^ Remove here 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:21:29.600

Java 7 钻石推理 -

```
AtomicIterator<String> it = new AtomicIterator<>(someList); 
                                               ^ 
                                               no need to repeat String here

public class AtomicIterator<E> implements Iterator<E>

    public AtomicIterator(Iterable<E> iterable) 
```

如果您不想显式编写 的完整类型`it`，请让编译器推断类型，例如

```
var it = new ...;   // the type of `it` is inferred from right hand side 
```

不幸的是，Java 还没有这个特性，而且暂时不会有。

# phpmyadmin - 重新安装 Wamp 时备份数据库和用户

> ID：15821575
> 
> 赞同：1
> 
> 时间：2013-04-04T20:57:59.190
> 
> 标签：phpmyadmin, wamp, wampserver

有没有比通过 phpmyadmin 手动备份所有数据库、用户和权限等更简单的方法来备份 WAMP 中的所有数据库、用户和权限等。Apache 正在使用大量 CPU（即使我知道没有发生任何事情，它也会跳动很多）所以我想卸载它并重新安装。

我有大约 10-15 个数据库，每个数据库都有自己的用户，我想保留其中的大部分。（除非首先有那么多数据库是问题的原因，但我会对此感到惊讶）。

我正在使用 Windows 7。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:06:10.447

从 phpmyadmin 的主页，您可以导出所有数据库，只需单击选项卡导出。用户存储在 Mysql DB 表 users

我建议只选择你的dbs来导出而不是全部导出，因为如果你尝试通过phpmyadmin导入系统mysql dbs你会遇到麻烦

表用户存储在“mysql”数据库中。用户权限存储在 information_schema 数据库中的表“USER_PRIVILEGES”和“mysql”数据库中的表“db”中

您应该以 root 身份登录以查看系统数据库。

当导出系统表使用自定义方法时，在“转储数据时使用的功能”下拉列表中使用“REPLACE”而不是“INSERT”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:07:12.110

您可以使用 mysqldump（确保您有正确的 mysqldump 路径）：

# 对于名为 foo 的数据库

C:\wamp\bin\mysql\mysqlX.XX\bin\mysqldump -uroot -p foo > c:\path\foo.sql

# 转储一个名为 bar 的表（在 foo db 中）

C:\wamp\bin\mysql\mysqlX.XX\bin\mysqldump -uroot -p foo bar > c:\path\foo-bar.sql

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T09:25:02.067

通常我只是复制mysql的数据文件夹，然后在另一个系统上替换这个数据文件夹，所以很容易移动所有的数据库

# html - 将边距应用于所有元素的问题

> ID：15821578
> 
> 赞同：1
> 
> 时间：2013-04-04T20:58:02.393
> 
> 标签：html, css, css-float, margin

我有一个问题，我有一个包装器 div，里面有一个 div，其中包含另一个 div，它浮动到左边并有一个`margin-left: 30px;`这就是现在的样子

![在此处输入图像描述](https://i.stack.imgur.com/wnrW9.png)

但是我想拥有它，所以在第一列和第二列之后只有边距（所以第一列将处于正常位置）

应该看起来像这样（忽略边距大小的差异，这只是一个快速图像）

![在此处输入图像描述](https://i.stack.imgur.com/RMXPO.png)

我将如何实现这一目标？

**HTML**

```
<div clas="wrapper">
   <div class="container">
      <div class="box">box 1</div>
      <div class="box">box 2</div>
      <div class="box">box 3</div>
      <div class="box">box 4</div>
      <!-- etc... -->
   </div>
</div> 
```

**CSS**

```
.wrapper {
  width: 1280px;
  margin: 0 auto;
}

.container {
  overflow: hidden;
}

.box {
  float: left;
  margin-left: 30px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:03:59.520

好吧，它实际上并没有删除边距，但您可以对容器应用负边距：

```
.container {
  overflow: hidden;
  margin-left: -30px;
} 
```

或使用 position: relative 用于相同目的：

```
.container {
  overflow: hidden;
  position: relative;
  left: -30px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:12:45.083

根据您的浏览器支持要求，您可以使用 CSS3`:nth-of-type`伪选择器：

```
.box:nth-of-type(3n + 1) {
    margin-left: 0;
} 
```

这是一个使用边框（用于演示目的）而不是边距的示例：http: [//jsfiddle.net/PdFjt/](http://jsfiddle.net/PdFjt/)

# apache - EC2 无论哪个域都加载第一个虚拟主机

> ID：15821579
> 
> 赞同：0
> 
> 时间：2013-04-04T20:58:10.630
> 
> 标签：apache, amazon-ec2, vhosts

我在 EC2 上运行了新安装的 Ubuntu。除了我一次不能加载多个虚拟主机之外，一切都运行良好。这两个域也在我的主机文件中设置。

我有以下运行：

```
 NameVirtualHost *:80
 <VirtualHost *:80>
    #template vhost container
    DocumentRoot /var/www/domain.co.uk/docroot
    ServerName domain.co.uk
</VirtualHost>
 <VirtualHost *:80>
    #template vhost container
    DocumentRoot /var/www/domain2.co.uk/docroot
    ServerName domain1.co.uk
</VirtualHost> 
```

我将安全组设置设置为：

```
 80 (HTTP)  0.0.0.0/0

domain.co.uk loads domain.co.uk
domain1.co.uk loads domain.co.uk 
```

在我看来，这应该可行，这就是为什么我确信它与 EC2 的安全端口设置有关......

# search - 如何阻止 Silverstripe SearchContext 抛出 Version Table_Live 错误

> ID：15821580
> 
> 赞同：0
> 
> 时间：2013-04-04T20:58:11.890
> 
> 标签：search, silverstripe

考虑以下 Silverstripe 页面类

```
<?php

class Page extends SiteTree{

static $has_many = array('OtherDataObjects' => 'DataObjectClass');

public function getSearchContext() {

    $fields = new FieldSet(

        new TextField('Title', 'Tour'),
        new DropdownField('OtherDataObjects', 'Other Data Object', array('data', 'value')
    );

    $filters = array(
      'Title' => new PartialMatchFilter('Title'),
      'OtherDataObjects' => new PartialMatchFilter('OtherDataObjects.Title')
    );
    return new SearchContext(
      'Page', 
      $fields, 
      $filters
   );
  }
} 
```

将此搜索表单添加到前端表单并发布搜索表单总是会导致 [用户错误] 并在末尾包含类似这样的 SQL 错误。

```
AND ("DataObjectClass_Live"."DataObjectClass_Live" LIKE 'title') ORDER BY "Sort" LIMIT 25 OFFSET 0 Table 'database DataObjectClass_Live' doesn't exist 
```

每次我尝试对 has_many 关系运行搜索时，我的 searchcontext 搜索都会引发错误。版本化扩展似乎是罪魁祸首，因为无论基类是否具有版本化扩展，它都会向所有表添加 _live 我在 SilverStripe 版本 2.4.x 和最新的 3.0.x 版本中遇到相同的错误。

任何帮助或指示将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T08:17:19.293

也许尝试使用 sqlQuery。就像是

```
function SearchResults() {
  $select = array('*');
  $from = array('OtherDataObjects');
  $where = array('OtherDataObjects:PartialMatch' => '%' . $data['Title'] . '%');
  $sqlQuery = new SQLQuery($select, $from, $where);
  $results = $sqlQuery->execute();
  return $results;
} 
```

`$data['Title']`是来自搜索文本框的值

部分匹配参考：[http ://doc.silverstripe.org/framework/en/topics/datamodel](http://doc.silverstripe.org/framework/en/topics/datamodel)

sql查询参考：[http ://doc.silverstripe.org/framework/en/reference/sqlquery](http://doc.silverstripe.org/framework/en/reference/sqlquery)

# python - Django：如何从数据库刷新或重新加载模型

> ID：15821581
> 
> 赞同：0
> 
> 时间：2013-04-04T20:58:16.507
> 
> 标签：python, django, django-models, django-forms, django-views

我在数据库中的一些表是由 Django 之外的几个 python 脚本定期更新的。结果，Django 的视图不知道数据库中的最新数据，而是显示旧数据。我在网上尝试了很多建议，但除了在使用模型之前调用 connection.close() 之外没有任何效果。

**这是我尝试过的方法，没有任何效果。**

```
from django.views.decorators.cache import never_cache

@never_cache # <=====
def GetData(request):
    data = Table.objects.get(id=1) # Still giving outdated data

    template = loader.get_template('data/data.html')
    context = Context({
        'lp': lp,
    })
    return HttpResponse(template.render(context)) 
```

* * *

```
data = Data.objects.get(id=1)
data = data.objects.get(id=data.id) # data is still old 
```

* * *

```
from django.core.cache import cache
cache.clear() 
```

**行之有效的方法。**：

```
from django.db import connection
def GetData(request):
    # Add this before accessing the model.
    # This also connection.close() prevents the 
    # MySQL 2006, 'MySQL server has gone away' error.
    connection.close()

    data = Table.objects.get(id=1) # Giving outdated data

    template = loader.get_template('data/data.html')
    context = Context({
        'lp': lp,
    })
    return HttpResponse(template.render(context)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T05:00:37.517

将“transaction-isolation = READ-COMMITTED”添加到 my.cnf。此处有更多详细信息：[如何强制 Django 忽略任何缓存并重新加载数据？](https://stackoverflow.com/questions/3346124/how-do-i-force-django-to-ignore-any-caches-and-reload-data)

# javascript - Highcharts + Highslide：打开新的 highslide 弹出窗口或单击其他任何位置时，关闭所有以前打开的弹出窗口

> ID：15821582
> 
> 赞同：0
> 
> 时间：2013-04-04T20:58:23.420
> 
> 标签：javascript, jquery, highcharts, highslide

因此，我发现当您将 highslides 与 highcharts 数据结合使用时，可以继续单击新数据点并弹出无数的模态窗口。我想构建一些东西，如果你打开一个新的 highslide 或者如果你点击其他任何地方，无论是在屏幕上还是在过滤器上，都会关闭现有的 highslide 弹出窗口。

我编写了这个小函数并将其添加到我的开头语句中，但它不起作用。

```
<body onclick="javascript:parent.window.hs.close();"> 
```

这是我的完整示例：问题是，有人可以向我展示一个可以完成上述行为的示例吗？

```
$(function () {
        $('#container').highcharts({
            chart: {
                type: 'scatter',
                zoomType: 'xy'
            },
            title: {
                text: 'Q1 Eanings and Outlook Forecast',
                x: -100
            },
            subtitle: {
                text: 'professional',
                x:-100
            },
            xAxis: {
                title: {
                    enabled: false,
                    text: 'Future Outlook'
                },
                labels:{formatter: function() {}  },
                startOnTick: true,
                endOnTick: true,
                showLastLabel: true
            },
            yAxis: {
                title: {
                    enabled:false,
                    text: 'Current Quarter'
                },
                    labels: {
        formatter: function() {
            //return this.value + ' ';
        }
    },

            },
           legend: {
                layout: 'vertical',
                align: 'right',
                verticalAlign: 'top',
           //     x: 100,
                y: 70,
                floating: false,
                backgroundColor: '#FFFFFF',
                borderWidth: 1
            },            

                        load: function() {
                var legend = $('#container .highcharts-legend');
                var x = legend.position().left;
                var y = legend.position().top - (this.chartHeight - this.plotTop - this.plotHeight - this.options.chart.spacingBottom);

                legend.attr({
                    transform: 'translate(' + x + ',' + y + ')'
                });
            },

            plotOptions: {
                scatter: {
                    marker: {
                        radius: 5,
                        states: {
                            hover: {
                                enabled: true,
                                lineColor: 'rgb(100,100,100)'
                            }
                        }
                    },
                    states: {
                        hover: {
                            marker: {
                                enabled: true
                            }
                        }
                    },
                    tooltip: {
                        headerFormat: '<b>{series.name}:</b><br>',
                        pointFormat: '{point.hover}<br><br><b>Current Q: </b>{point.y}/100<br><b>Outlook: </b>{point.x}/100<br><br><div style="text-align:center;">(click for more detail)</div>'
                    },

    cursor: 'pointer',
            point: {
                events: {
                        click: function(event) {
                            hs.htmlExpand(null, {
                                pageOrigin: {
                                    x: this.pageX,
                                    y: this.pageY
                                },
                                headingText: this.ticker,
                                maincontentText: '<b>Detail:</b> ' + this.info,
                                width: 250
                            });

                                hs.Expander.prototype.onBeforeClose = function(sender) {

}                   

                        },

                }
            },

                        events: {
                legendItemClick: function(event) {

                    if (!this.visible)
                        return true;

                    var seriesIndex = this.index;
                    var series = this.chart.series;
                    for (var i = 0; i < series.length; i++)
                    {
                        if (series[i].index != seriesIndex)
                        {
                            series[i].visible ? series[i].hide() : series[i].show();
                        } 
                    }

                    return false;
                }

            },

                }
            },

                    series: [{
                    name: 'Weak Outlook (24)',color: 'red',data: [
            {x: 40,y:10,ticker:'Michael Kors: (KORS)',info: 'O,.pyjxkne<br>1Q xjkxqs', hover:'Gtext<br>1Qlotatt<br><a href="">read more</a>'},
            {x: 20,y:50,ticker:'Soeuoeuoeu',info:'Doeuoeuoeull...<br><br><a href="">read more</a>'},
            {x:0,y:0,ticker:'Zynga: (ZNGA)'},
            {x:3,y:4,ticker:'Avid: (AVID)'},
            {x:30,y:10,ticker:'JCPenny: (JCP)'},
            {x:29,y:25,ticker:'Deckers Outdoor: (DECK)'},
            {x:25,y:5,ticker:'Zynga: (ZNGA)'},
            {x:6,y:34,ticker:'Avid: (AVID)'},
            {x:8,y:27,ticker:'JCPenny: (JCP)'},
            {x:14,y:35,ticker:'Deckers Outdoor: (DECK)'},
            {x:35,y:23,ticker:'Nutrisystem Corp: (NTRI)'},
            ]},

            {name:'Strong Outlook (25)',color:'green',data:[
        {x:100,y:100,ticker:'The Gap: (GPS)'},
        {x:72,y:82,ticker:'Sodastream Intl: (SODA)'},
        {x:82,y:74,ticker:'Under Armour: (UA)'},
        {x:71,y:90,ticker:'Intuitive Surgical: (ISRG)'},
        {x:88,y:69,ticker:'McDonalds: (MCD)'},
        {x:95,y:87,ticker:'Lumber Liquidators: (LL)'},
        {x:77,y:91,ticker:'Apple: (AAPL)'},
        {x:96,y:78,ticker:'Walgreen Company: (WAG)'},       {x:100,y:100,ticker:'The Gap: (GPS)'},
        {x:73,y:72,ticker:'Sodastream Intl: (SODA)'},
        {x:84,y:74,ticker:'Under Armour: (UA)'},
        {x:91,y:80,ticker:'Intuitive Surgical: (ISRG)'},
        {x:68,y:93,ticker:'McDonalds: (MCD)'},
        {x:95,y:67,ticker:'Lumber Liquidators: (LL)'},
        {x:76,y:67,ticker:'Apple: (AAPL)'},
        {x:79,y:84,ticker:'Walgreen Company: (WAG)'},

        ]},

        {name:'Inline Company Performance (23)',color:'darkgrey',data:[
        {x:40,y:44,ticker:'GIII'},
        {x:53,y:43,ticker:'BNNY'},
        {x:55,y:49,ticker:'SNE'},
        {x:57,y:58,ticker:'WTW'},
        {x:60,y:60,ticker:'LULU'},
        {x:70,y:66,ticker:'FB'},
        {x:51,y:24,ticker:'GIII'},
        {x:45,y:26,ticker:'FB'},
        {x:43,y:53,ticker:'BNNY'},
        {x:47,y:59,ticker:'SNE'},
        {x:51,y:48,ticker:'WTW'},
        {x:56,y:40,ticker:'LULU'},
        {x:59,y:52,ticker:'FB'},
        {x:0,y:100,ticker:'Nutrisystem Corp: (NTRI)'},
        ]},

        ]

        });
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:50:30.043

如果`allowMultipleInstances`设置为`false`，打开的扩展器将在您单击打开另一个扩展器时关闭。在包含的 highslide.config.js 文件之后添加这个：

```
<script type="text/javascript">
   hs.allowMultipleInstances = false;
</script> 
```

# r - 根据浓度和空间值计算浓度梯度

> ID：15821591
> 
> 赞同：0
> 
> 时间：2013-04-04T20:59:17.987
> 
> 标签：r

看起来很简单，但我在这里遇到了一个小问题。我有浓度和位置（x）数据。我想从数据集中找到梯度（dc/dx）。

数据集可以在[https://www.dropbox.com/s/xgo3cx8i3xz27w3/concentration.csv上找到](https://www.dropbox.com/s/xgo3cx8i3xz27w3/concentration.csv)

此处给出了示例数据：

```
 x      conc
1    0.0 1.0000000
2    0.5 1.0000000
3    1.0 1.0000000
4    1.5 1.0000000
5    2.0 1.0000000
6    2.5 1.0000000
7    3.0 1.0000000
8    3.5 1.0000000
9    4.0 1.0000000
10   4.5 1.0000000
11   5.0 1.0000000
12   5.5 1.0000000
13   6.0 1.0000000
14   6.5 1.0000000
15   7.0 1.0000000
16   7.5 1.0000000
17   8.0 1.0000000
18   8.5 1.0000000
19   9.0 1.0000000
20   9.5 1.0000000
21  10.0 1.0000000
22  10.5 1.0000000
23  11.0 1.0000000
24  11.5 1.0000000
25  12.0 1.0000000
26  12.5 1.0000000
27  13.0 1.0000000
28  13.5 1.0000000
29  14.0 1.0000000
30  14.5 1.0000000
31  15.0 1.0000000
32  15.5 1.0000000
33  16.0 1.0000000
34  16.5 1.0000000
35  17.0 1.0000000
36  17.5 1.0000000
37  18.0 1.0000000
38  18.5 0.9999999
39  19.0 0.9999999
40  19.5 0.9999999
41  20.0 0.9999999
42  20.5 0.9999999
43  21.0 0.9999999
44  21.5 0.9999999
45  22.0 0.9999999
46  22.5 0.9999999
47  23.0 0.9999998
48  23.5 0.9999998
49  24.0 0.9999998
50  24.5 0.9999998
51  25.0 0.9999998
52  25.5 0.9999997
53  26.0 0.9999997
54  26.5 0.9999997
55  27.0 0.9999996
56  27.5 0.9999996
57  28.0 0.9999995
58  28.5 0.9999995
59  29.0 0.9999994
60  29.5 0.9999994
61  30.0 0.9999993
62  30.5 0.9999992
63  31.0 0.9999991
64  31.5 0.9999990
65  32.0 0.9999989
66  32.5 0.9999988
67  33.0 0.9999987
68  33.5 0.9999986
69  34.0 0.9999984
70  34.5 0.9999982
71  35.0 0.9999981
72  35.5 0.9999979
73  36.0 0.9999976
74  36.5 0.9999974
75  37.0 0.9999971
76  37.5 0.9999969
77  38.0 0.9999965
78  38.5 0.9999962
79  39.0 0.9999958
80  39.5 0.9999954
81  40.0 0.9999950
82  40.5 0.9999945
83  41.0 0.9999940
84  41.5 0.9999934
85  42.0 0.9999928
86  42.5 0.9999921
87  43.0 0.9999913
88  43.5 0.9999905
89  44.0 0.9999896
90  44.5 0.9999887
91  45.0 0.9999876
92  45.5 0.9999865
93  46.0 0.9999853
94  46.5 0.9999839
95  47.0 0.9999825
96  47.5 0.9999809
97  48.0 0.9999792
98  48.5 0.9999773
99  49.0 0.9999754
100 49.5 0.9999732 
```

梯度可以通过以下公式找到

dc/dx = (c2-c1)/(x2-x1)

所以，第一个值没有梯度，我需要使用上面的公式找到其余点的梯度。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:22:40.097

假设这是一个`data.frame`，称为`df`

```
df$gradient <- c(NA, diff(df$c)/diff(df$x)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-11-20T12:44:07.257

具有中心有限差分，其中 x 是向量（浓度）res，点之间的距离（分辨率，在您的情况下为 0.5）dx 梯度

该方法使用此公式计算极值之间的值

dx(n) = (x(n+1)-x(n-1))/(res(n+1) - res(n-1))

并且使用正向方法计算极值

dx(n) = (x(n+1)-x(n))/(res(x+1)-res(x)) dx(m) = (x(m) - x(m-1)) /res(m) - res(m-1))

```
center_finite_diff <- function(x, res) {
    dx <- vector(mode="numeric",length=length(x))
    m <- end(x)
    dx[1] <- diff(x[1:2])/res
    dx[m[1]] <- diff(x[(m[1]-1):m[1]])/res
    dx[2:(m[1]-1)] <- diff(x, 2)/(2*res)
    return(dx)
} 
```

# java - 尝试部署程序

> ID：15821594
> 
> 赞同：0
> 
> 时间：2013-04-04T20:59:37.353
> 
> 标签：java, deployment, drm

我在这里遇到了一个问题：我创建了一个应用程序，它就像我今年学校年鉴的计算机化/数字化版本。我想只向那些购买了这本书的人提供这个程序。该程序是用java编程的，我可以做键码/序列号/cd键，但我不知道该怎么做。我不希望没有购买年鉴的人访问该程序，也不希望购买了年鉴的人将密码/代码提供给他们的朋友以便他们使用。

我们可以建立一个在线交易，以防想要一本年鉴但没有购买它的人可以以更便宜的价格获得该程序，但我们希望那些购买了实际书籍的人免费。这是一个挑战，但我们可以在程序内部和在线创建数据库，但我不确定。

我想过尝试的事情：

*   加密文件
*   光盘
*   用户名密码
*   CD 上的“自毁”文件
*   和其他几个

但是我们所有的想法都不能满足我们的需求。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:21:57.647

不确定它是否有帮助，但最近的一些游戏已经实现了在线实时客户端/服务器验证，以确保许可证是合法的，即使在单人游戏中也是如此（例如，ubisoft 的定居者 7 初始版本）。您至少可以保证当时只使用了一份软件副本。

可能有帮助的主题：

[https://stackoverflow.com/questions/5039395/copy-protection-and-license-expiration](https://stackoverflow.com/questions/5039395/copy-protection-and-license-expiration)

[制作商业 Java 软件 (DRM)](https://stackoverflow.com/questions/2466424/making-commercial-java-software-drm)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:23:24.343

想到的最简单的方法（虽然从可用性的角度来看不是很好）：

*   该应用程序需要互联网访问才能安装*和*运行。
*   每次应用程序安装时，它都会为当前计算机生成一个唯一的 id 并将其发送到服务器。
*   每次应用程序运行时，它都会将服务器上的 id 与当前计算机的 id 进行比较。
*   如果两者匹配，则运行；否则它会通知用户该软件已安装在另一台 PC 上。
*   每次用户安装软件时，您都会覆盖服务器上的 ID（您监控的是安装，而不是卸载）。
*   这样，最后一个安装的人可以运行，但会将其他人踢出去。

人们仍然可以作弊，但它要求他们每次想要运行软件时都反复重新安装软件，这很烦人。烦恼杀死盗版:)

奖励积分：

*   每次软件检测到 ID 不匹配时，都会以“X 美元的低价”购买许可证。如果产品足够好，价格足够低，人们就会买单。

# xml - 使用 StreamingMarkupBuilder 生成名为“属性”的 xml 元素

> ID：15821599
> 
> 赞同：1
> 
> 时间：2013-04-04T21:00:04.000
> 
> 标签：xml, groovy

我需要生成一些包含名为“属性”的元素的 xml。当我尝试以下操作时，我注意到 groovy 正在尝试获取我的类的属性，正如它对`getSomething`. 相反，它应该只生成一个名为“properties”的元素。

```
class XMLGen
{
    public String getSomething() {
        println "Got something"
    }

    public String genXml()
    {
        def myProps = ['a':1, 'b':2]

        def xml = new groovy.xml.StreamingMarkupBuilder().bind{
            rootTag{
                properties{ // ???
                    myProps.each{ prop ->
                        property(key: prop.key, value: prop.value)
                    }
                }
            }
        }
        return groovy.xml.XmlUtil.serialize(xml)
    }
}

println new XMLGen().genXml() 
```

输出：

```
Got something
<?xml version="1.0" encoding="UTF-8"?><rootTag>
  <properties>
    <property key="a" value="1"/>
    <property key="b" value="2"/>
  </properties>
</rootTag> 
```

我将如何明确地“告诉”groovy 将在线方法调用（标记为???）传递给标记生成器？

（问这个问题并自己回答，因为我在任何地方都找不到解决方案，但最终“猜到”了正确的答案）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:04:12.017

解决方法是在“properties”前加上“delegate”，如下：

```
delegate.properties{ // ??? 
```

您还可以向`bind`闭包添加参数并调用`.properties`它，如下所示：

```
def xml = new groovy.xml.StreamingMarkupBuilder().bind{ smb ->
    ...
    smb.properties{ // ??? 
```

# javascript - Twitter Bootstrap，词缀，如何让导航在移动布局的顶部保持静态

> ID：15821601
> 
> 赞同：1
> 
> 时间：2013-04-04T21:00:05.497
> 
> 标签：javascript, css, twitter-bootstrap

twitter bootstrap 文档站点，左侧导航固定在移动布局的顶部。例如：http: [//twitter.github.com/bootstrap/javascript.html](http://twitter.github.com/bootstrap/javascript.html)

我想在不使用 ...docs.css 的情况下做同样的事情，就像在 Bootstrap 站点中所做的那样。

目前，我面临的问题是，当您滚动浏览内容时，“附加导航”会停留在移动维度的内容之上。

```
<div class="row">
<div class="span3">
    <div data-spy="affix">
        <ul class="nav nav-list nav-stacked">
            <li><a href="#objective"> Objective </a>
            </li>
            <li><a href="#experience"> Experience </a>
            </li>
            <li><a href="#skills"> Skills </a>
            </li>
            <li><a href="#education"> Education </a>
            </li>
        </ul>
    </div>
</div>
<div class="span9">
    <section id="objective">
        <div class="page-header">
             <h1>
                Objective: <small> Do good </small>
            </h1>

        </div>
    </section>
    <section id="experience">
        <div class="page-header">
             <h1>
                Exprience: <small> I worked at a bit </small>
            </h1>

        </div>
    </section>
    <section id="skills">
        <div class="page-header">
             <h1>
                skills: <small> my skillz </small>
            </h1>

        </div>
    </section>
    <section id="education">
        <div class="page-header">
             <h1>
                education: <small> I went to school </small>
            </h1>
        </div>
    </section>
</div> 
```

[http://jsfiddle.net/gPsWe/1/](http://jsfiddle.net/gPsWe/1/)

我希望使用最新的引导程序 v2.3.1 将“附加导航”固定在移动布局的顶部。我该怎么做？有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:07:07.000

移动屏幕的菜单并不总是最容易使用的东西。

使用您开始使用的布局，这是一个简单的想法，您可以删除移动屏幕的附加行为：http: [//jsfiddle.net/panchroma/ZuELd/](http://jsfiddle.net/panchroma/ZuELd/)。这样做会将菜单返回到正常流程，这样内容就会很好地落入下方。

您可能需要微调菜单链接，甚至[将它们更改为移动屏幕的水平列表](http://jsfiddle.net/panchroma/BQ2R6/)，但这很容易从这里完成。

**CSS**

```
@media (max-width: 767px){
.affix{
    position:static;
}

} 
```

祝你好运！

# bash - 如何在 sed 中正确转义引号？

> ID：15821611
> 
> 赞同：1
> 
> 时间：2013-04-04T21:00:32.640
> 
> 标签：bash, sed

我有一个 CSV，其中的值用分号分隔。我需要将该 CSV 中的数据获取到 MongoDB 数据库中的现有集合中，如果出现此问题，这实际上是无关的。

为了更容易，我将只使用该 CSV 中的一个示例行：

```
echo '1243;firstName' | sed "s:\([0-9]*\)\;\(.*\):mongo localhost/test --eval \\\\'db.test.update({_id\: \1}, {name\: \"\2\"})\\\\':" | xargs -I {} sh -c "{}"

MongoDB shell version: 2.2.0
connecting to: localhost/test
Thu Apr  4 22:50:10 ReferenceError: firstName is not defined (shell eval):1 
```

问题是，当查询到达 MongoDB 解释器时，它是未转义的。

我已经尝试在每个引用前添加多达 3 个反冲，但没有任何改变。我应该如何正确地转义引号，以便在查询到达 MongoDB 解释器之前它们会一直留在那里？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T23:05:47.707

直接调用`mongo`比尝试将引用的所有内容传递给要简单得多`xargs`：

```
while IFS=';' read id firstName; do
    mongo localhost/test \
      --eval "db.test.update({_id: $id}, {name: \"$firstName\"})"
done < file.csv 
```

# python - 使用正则表达式查找字符串追加到列表中的所有小写字母。Python

> ID：15821613
> 
> 赞同：2
> 
> 时间：2013-04-04T21:00:34.830
> 
> 标签：python, regex, string, lowercase, findall

我正在寻找一种从同时具有大写字母和可能小写字母的字符串中获取小写值的方法

这是一个例子

```
sequences = ['CABCABCABdefgdefgdefgCABCAB','FEGFEGFEGwowhelloFEGFEGonemoreFEG','NONEARELOWERCASE'] #sequences with uppercase and potentially lowercase letters 
```

这就是我想要输出的

```
upper_output = ['CABCABCABCABCAB','FEGFEGFEGFEGFEGFEG','NONEARELOWERCASE'] #the upper case letters joined together
lower_output = [['defgdefgdefg'],['wowhello','onemore'],[]] #the lower case letters in lists within lists
lower_indx = [[9],[9,23],[]] #where the lower case values occur in the original sequence 
```

所以我希望 lower_output 列表是 SUBLISTS 的列表。SUBLISTS 将包含所有小写字母字符串。

我正在考虑使用正则表达式。. .

```
import re

lower_indx = []

for seq in sequences:
    lower_indx.append(re.findall("[a-z]", seq).start())

print lower_indx 
```

对于我尝试的小写列表：

```
lower_output = []

for seq in sequences:
    temp = ''
    temp = re.findall("[a-z]", seq)
    lower_output.append(temp)

print lower_output 
```

但这些值不在单独的列表中（我仍然需要加入它们）

```
[['d', 'e', 'f', 'g', 'd', 'e', 'f', 'g', 'd', 'e', 'f', 'g'], ['w', 'o', 'w', 'h', 'e', 'l', 'l', 'o', 'o', 'n', 'e', 'm', 'o', 'r', 'e'], []] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:05:34.337

听起来（我可能误解了你的问题）你只需要捕获小写字母的*运行*，而不是每个单独的小写字母。这很简单：只需将`+`量词添加到您的正则表达式中。

```
for seq in sequences:
    lower_output.append(re.findall("[a-z]+", seq)) # add substrings 
```

量词指定您想要前面表达式的`+`“至少一个，并且尽可能多地在一行中找到”（在这种情况下`'[a-z]'`）。因此，这将在一组中捕获所有小写字母的完整运行，这将使它们按照您希望的方式出现在输出列表中。

如果你想保留你的列表结构并获取索引，它会变得有点丑陋，但它仍然非常简单：

```
for seq in sequences:
    matches = re.finditer("[a-z]+", seq) # List of Match objects.
    lower_output.append([match.group(0) for match in matches]) # add substrings
    lower_indx.append([match.start(0) for match in matches]) # add indices

print lower_output
>>> [['defgdefgdefg'], ['wowhello', 'onemore'], []]

print lower_indx
>>> [[9], [9, 23], []] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:04:15.690

除了正则表达式，您还可以`itertools.groupby`在此处使用：

```
In [39]: sequences = ['CABCABCABdefgdefgdefgCABCAB','FEGFEGFEGwowhelloFEGFEGonemoreFEG','NONEARELOWERCASE'] #sequences with uppercase and potentially lowercase letters

In [40]: lis=[["".join(v) for k,v in groupby(x,key=lambda z:z.islower())] for x in sequences]

In [41]: upper_output=["".join(x[::2]) for x in lis]

In [42]: lower_output=[x[1::2] for x in lis]

In [43]: upper_output
Out[43]: ['CABCABCABCABCAB', 'FEGFEGFEGFEGFEGFEG', 'NONEARELOWERCASE']

In [44]: lower_output
Out[44]: [['defgdefgdefg'], ['wowhello', 'onemore'], []]

In [45]: lower_indx=[[sequences[i].index(y) for y in x] for i,x in enumerate(lower_output)]

In [46]: lower_indx
Out[46]: [[9], [9, 23], []] 
```

# opengl - LWJGL - OpenGL - 相机旋转

> ID：15821616
> 
> 赞同：1
> 
> 时间：2013-04-04T21:00:55.727
> 
> 标签：opengl, matrix, camera, rotation, lwjgl

我试图创建一个第一人称相机。我拿了我 XNA 项目的一段代码，并试图将它转换成 java (LWJGL)。

```
Matrix4f mx = Matrix4f.rotate(pitch, new Vector3f(1, 0, 0),
            new Matrix4f(), null);

   Matrix4f my = Matrix4f.rotate(yaw, new Vector3f(0, 1, 0),
            new Matrix4f(), null);

    Matrix4f rotationMatrix = Matrix4f.mul(mx, my, null);

    Vector4f tmp = Matrix4f.transform(rotationMatrix, new Vector4f(0, 0,
            -1, 0), null);

    target = new Vector3f(position.x + tmp.x, position.y + tmp.y,
            position.z + tmp.z);

    GLU.gluLookAt(this.position.x, this.position.y, this.position.z,
            this.target.x, this.target.y, this.target.z, 0, 1.0f, 0); 
```

如果我移动鼠标，俯仰和偏航将增加/减少。在开始运行我的游戏时，它运行良好，但经过一些动作后，我无法向下或向上看。如果我的位置 < 0 会发生这种情况吗？

完美运行的 XNA 代码：

```
 Matrix rotationMatrix = Matrix.CreateRotationX(pitch) * Matrix.CreateRotationY(yaw);

        camera.Target = Vector3.Transform(Vector3.Forward, rotationMatrix) + camera.Position;
        this.viewMatrix = Matrix.CreateLookAt(this.position, this.target, Vector3.Up); 
```

## 编辑

所以我发现 LWJGL 和 XNA 在旋转矩阵方面有些不同。

爪哇：

```
Matrix4f mx = Matrix4f.rotate(1.2345f, new Vector3f(1,0,0),new Matrix4f(),null); 
```

结果：

{1.0 0.0 0.0 0.0} {0.0 0.3299931 -0.9439833 0.0}{0.0 0.9439833 0.3299931 0.0}{0.0 0.0 0.0 1.0}

XNA

```
Matrix.CreateRotationX(1.2345f) 
```

结果：

{1,0,0,0} {0,0.3299931,0.9439833,0} {0,-0.9439833,0.3299931,0} {0,0,0,1}

区别是 -0.9439833 和 +0.9439833 ...有人可以解释一下为什么会有不同的结果吗？不是一样的功能吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T12:48:42.527

原来如此。好吧，这就是与众不同。最后我解决了我的问题。问题是 LWJGL 中的“转换”方法。那是我最后的工作代码。也许我可以优化它？

```
 public static Matrix4f createRotationX(float pitch) {
    Matrix4f mX = new Matrix4f();
    mX.m00 = 1;
    mX.m10 = 0;
    mX.m20 = 0;
    mX.m30 = 0;
    mX.m01 = 0;
    mX.m11 = (float) Math.cos(pitch);
    mX.m21 = (float) Math.sin(pitch);
    mX.m02 = 0;
    mX.m03 = 0;
    mX.m12 = (float) -Math.sin(pitch);
    mX.m22 = (float) Math.cos(pitch);
    mX.m23 = 0;
    mX.m03 = 0;
    mX.m13 = 0;
    mX.m23 = 0;
    mX.m33 = 1;
    return mX;
}

public static Matrix4f createRotationY(float yaw) {
    Matrix4f mY = new Matrix4f();
    mY.m00 = (float) Math.cos(yaw);
    mY.m10 = 0;
    mY.m20 = (float) -Math.sin(yaw);
    mY.m30 = 0;
    mY.m01 = 0;
    mY.m11 = 1;
    mY.m21 = 0;
    mY.m31 = 0;
    mY.m02 = (float) Math.sin(yaw);
    mY.m12 = 0;
    mY.m22 = (float) Math.cos(yaw);
    mY.m23 = 0;
    mY.m03 = 0;
    mY.m13 = 0;
    mY.m23 = 0;
    mY.m33 = 1;
    return mY;
}

public static Vector3f getNewTarget(Vector3f position,float pitch, float yaw){

    Matrix4f mx = MathUtil.createRotationX(pitch);
    Matrix4f my = MathUtil.createRotationY(yaw);      

    Matrix4f rotationMatrix = Matrix4f.mul(mx, my, null);

    Matrix4f def = new Matrix4f();
    def.m20 = -1;
    def.m00 = 0;
    def.m11 = 0;
    def.m22 = 0;
    def.m33 = 0;

    Matrix4f v4 = Matrix4f.mul(def,rotationMatrix,null);

    return new Vector3f(v4.m00+position.x, v4.m10+position.y, v4.m20+position.z);
} 
```

# jenkins - Jenkins NUnit 测试报告未在电子邮件中呈现

> ID：15821623
> 
> 赞同：1
> 
> 时间：2013-04-04T21:01:26.740
> 
> 标签：jenkins, continuous-integration, nunit, hudson, email-ext

我在我的 Jenkins 上安装了以下插件：

1.  [单元](https://wiki.jenkins-ci.org/display/JENKINS/NUnit+Plugin)
2.  [xUnit](https://wiki.jenkins-ci.org/display/JENKINS/xUnit+Plugin)
3.  [电子邮件分机](https://wiki.jenkins-ci.org/display/JENKINS/Email-ext+plugin)

然后我在插件设置中指出了我的 NUnit 报告 *.xml 的路径（我尝试了 Nunit 和 xUnit 插件）。构建后，我可以在 Jenkins 网页中看到测试报告，但我无法在电子邮件中实现。

我没有成功地尝试做的事情：

1.  在 email-ext 插件配置中呈现 ${FAILED_TESTS} 值。它呈现为“没有运行测试”。

2.  将 ${SCRIPT, template="groovy-html-larry.template"} 设置为模板并添加以下行：

-

```
<%
    if(build.testResultAction) {
    %>
    There are some tests
    <% } else { %>
    Nothing
    <% } %> 
```

不幸的是，它被渲染为“无”。

所以我在电子邮件中看不到测试结果的问题（但它在网页中可用）。有人解决过这样的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T18:00:11.837

找到了解决方法。当我使用自由样式项目（不是我以前使用的多配置项目）时，一切正常。这似乎是插件或 Jenkins 的错误。

# python - 在类定义中从另一个调用 python 脚本失败

> ID：15821625
> 
> 赞同：0
> 
> 时间：2013-04-04T21:01:33.473
> 
> 标签：python, exec

我有一个名为 的脚本`insertPrintCode.py`，它可以独立运行。我想从另一个 python 脚本中调用它

```
def main():
    execfile("insertPrintCode.py")

def execfile(filename):
    exec(compile(open(filename).read(), filename, 'exec')) 
```

`insertPrintCode.py`这在第一次使用时失败了

```
newSearch = FileSearch() 
```

和

> NameError：未定义全局名称“FileSearch”

FileSearch 是在同一个文件中定义的一个类。

# jquery - 如何处理日期选择器控件？

> ID：15821627
> 
> 赞同：2
> 
> 时间：2013-04-04T21:01:41.317
> 
> 标签：jquery, jquery-ui, datepicker

我`datepicker`在文本框上使用 jquery ui 控件，同时我使用`onblur`事件进行验证。现在的问题是当单击文本框并出现日历时，当您在其中选择日期时，将在文本框上执行验证。我试图处理它，但它仍然出现了一秒钟。

这是代码

```
$(document).ready(function () {

    $("#date").datepicker({
        onSelect: function () {
            $("#span1").css("display", "none")
        }
    });
});

function check() {
    if ($("#date").val() == "") $("#span1").css("display", "inline-block");
} 
```

为了更好地理解这里是[jsFiddle 链接](http://jsfiddle.net/4Vp9D/)

编辑：最终解决方案：接受最接近的答案首先提出。

```
$("#date").datepicker({
    onClose: function() {
        check();
    }
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:23:42.130

您也可以在日期选择器关闭时调用检查，而不是输入框的模糊。

```
$("#date").datepicker({
    onSelect: function () {
        $("#span1").css("display", "none")
    },
    onClose: function() {
        check();
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:52:44.753

使用[`setTimeout`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)：

```
$(document).ready(function () {
    $("#date").datepicker({
        onSelect: function () {
            $("#span1").css("display", "none")
        }
    });
});

function check() {
    setTimeout(function(){
        if ($("#date").val() == "") 
            $("#span1").css("display", "inline-block")
            }, 100);
} 
```

演示：http: [//jsfiddle.net/dirtyd77/4Vp9D/26/](http://jsfiddle.net/dirtyd77/4Vp9D/26/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T21:09:40.867

我可以建议使用这个轻量级插件，而不是自己发明轮子吗？ [http://digitalbush.com/projects/masked-input-plugin/](http://digitalbush.com/projects/masked-input-plugin/)

它也可以很好地与 jQuery UI DatePicker 配合使用，并且可以让您不必对日期格式进行自己的验证。

# c# - CollectionAssert.AreEquivalent 失败......无法弄清楚为什么

> ID：15821628
> 
> 赞同：2
> 
> 时间：2013-04-04T21:01:42.210
> 
> 标签：c#, unit-testing, testing, mocking

我有一个注入接口，我正在单元测试。有问题的方法有效，但我正在尝试编写一个单元测试来确认返回的样本数据是完整且准确的。我的测试对我来说看起来是正确的，甚至结果看起来都是一样的，但测试失败并显示“CollectionAssert.AreEquivalent failed。预期的集合包含 1 次出现。实际的集合包含 0 次出现。”

```
[TestMethod]
    public void Should_Get_All_Amenities()
    {
        var amenitiesRep = _ninjectKernel.Get<IAmenityRepository>();

        var amenities = amenitiesRep.GetAmenities();

        var expected = new List<Amenity>
        {
            new Amenity() {Id = 1, Name = "Pool", Category = "resort"},
            new Amenity() {Id = 2, Name = "Hottub", Category = "resort"},
            new Amenity() {Id = 3, Name = "Steamroom", Category = "unit"}
        };

        Assert.IsNotNull(amenities);
        Assert.IsTrue(amenities.Count() == 3);
        CollectionAssert.AreEquivalent(expected, amenities);
    } 
```

（来自我的TestRepository的相关代码）

```
 var amenities = new List<Amenity>
        {
            new Amenity() {Id = 1, Name = "Pool", Category = "resort"},
            new Amenity() {Id = 2, Name = "Hottub", Category = "resort"},
            new Amenity() {Id = 3, Name = "Steamroom", Category = "unit"}
        };

        var mockAmenitiesRep = new Mock<IAmenityRepository>();
        mockAmenitiesRep.Setup(_m => _m.GetAmenities()).Returns(amenities);
        Kernel.Bind<IAmenityRepository>().ToConstant(mockAmenitiesRep.Object); 
```

我可以确认在 CollectionAssert 中正确填充了所有数据，每个字段似乎都匹配 1 到 1、相同数量的对象、相同的对象类型，所以我只是迷失了测试失败的原因。

（编辑：代码失败的行是 CollectionAssert）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-04T21:11:25.437

这是因为 Amenity 是一个引用类型，所以 CollectionAssert.AreEquivalent 通过引用地址检查相等性。由于预期集合中的项目与您从 GetAmenities() 方法获得的对象不同，因此它返回 false。您必须覆盖 Amenity 类中的相等比较器。

```
public override bool Equals(object obj)
{
    var other = obj as Amenity;
    if(other == null)
    {
        return false;
    }

    return Id = other.Id && Name == other.Name && Category == other.Category;
}

public override int GetHashCode()
{
    return Id.GetHashCode(); //assumes Id is immutable
} 
```

**更新：**

请记住，这种方法不是很好，因为它会导致[平等污染](http://xunitpatterns.com/Test%20Logic%20in%20Production.html#Equality%20Pollution)。Alexander Stepaniuk 在评论中发布了一个更好的选择。

# c++ - C++，带有对象列表的对象：'operator=='不匹配

> ID：15821630
> 
> 赞同：0
> 
> 时间：2013-04-04T21:01:44.663
> 
> 标签：c++, list, if-statement, iterator

我有一个名为“订单”的课程，还有一个名为“订单簿”的课程。

订单簿包含订单列表。我想做的是查找订单簿中是否已经存在某个订单值（order.security）。

为此，我创建了一个迭代器，它应该循环遍历列表以查找该值是否存在。但是我一定在某处做错了，因为我收到以下 g++ 错误：

错误：'__first.std::_List_iterator<_Tp>::operator*() == __val'中的'operator=='不匹配|

注意：功能尚未完成

```
void matchOrder(order &orderEntry, orderbook &genericBook);

void fillBook(order &orderEntry, orderbook &bookBUY, orderbook &bookSELL)
{
    if (orderEntry.side == "S")
        {
            //Check if any buy can be fulfilled
            matchOrder(orderEntry, bookSELL);
        }
}

void matchOrder(order &orderEntry, orderbook &genericBook)
{
    //scan book, if find a matching SECURITY, check order type and quantity (and price)

    list<order>::iterator pos;

    pos = find (genericBook.myList.begin(), genericBook.myList.end(), orderEntry);

    if (pos !=  genericBook.myList.end())
        cout << "\n\n   FOUND ONE!!!!!";
} 
```

供参考，以下是我的订单类：

```
class order{

public:
    void getOrderData(int j, DATA fullData);

    string security;
    string type;
    int quantity;
    double price;
    string name;
    string side;
}; 
```

和我的订单簿类：

```
class orderbook
{

public:

    list<order> myList;
    list<order>::iterator it;
    void printItOut();

}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:07:35.060

```
pos = find (genericBook.myList.begin(), genericBook.myList.end(), orderEntry); 
```

为了使它`find`工作，`genericBook.myList`需要某种方法来检查两个`order`s 是否相等。它通过使用`operator ==`. 您的`order`班级应该提供此运算符以使 find 正常工作。

您可以通过重载`== operator`for`order`类来解决它。

# symfony - 在主页中包含 FOSUser 登录表单

> ID：15821631
> 
> 赞同：1
> 
> 时间：2013-04-04T21:01:50.543
> 
> 标签：symfony, controller, twig, fosuserbundle

我有一个关于在其他布局中包含 FOSUserBundle 的登录表单的问题。在某种程度上，我想要两个登录表单：

*   一个登录表单，没有扩展，我可以在任何地方包含，例如在我的主页中
*   一种扩展我的基本布局的登录表单，例如在您调用 /login 时显示

我尝试了一些东西，但我有这个错误：

在第 15 行的 rSWelcomeBundle:Homepage:index.html.twig 中呈现模板（“未找到“GET Security:LoginBisAction”的路由”）时引发异常。

我有两个捆绑包：一个 WelcomeBundle 和一个扩展 FOSUserBundle 的 UserBundle。

在 rs/WelcomeBundle 我有我的主页，并在右侧块中包含登录表单：

```
{% extends "rsWelcomeBundle::layout.html.twig" %}

{% block title "Page d'accueil" %}

{%  block body %}
    <div class="span6">
        <div class="well">
            <h2>Présentation du site</h2>
            <p>Rejoignez nous, parce que ceci cela...etc ! </p>
            <p><a href="{{ path('fos_user_registration_register') }}" class="btn ">Je m'inscris !</a></p>
        </div>
    </div>
    <div class="span6">
        <div class="well">
            {% render 'FOSUserBundle:Security:LoginBisAction' %}
        </div>
    </div>

{% endblock %} 
```

在 rs/UserBundle 的根目录下，在 rsUserBundle.php 中，我扩展了 FOSUserBundle ：

```
<?php

namespace rs\UserBundle;

use Symfony\Component\HttpKernel\Bundle\Bundle;

class rsUserBundle extends Bundle
{
    public function getParent()
    {
        return 'FOSUserBundle';
    }
} 
```

在 rs/UserBundle/Ressources/views/layout.html.twig ：

```
{% extends "rsWelcomeBundle::layout.html.twig" %}

{% block body %}
  <div class="span4 offset4">
    <div class="well">
      {% for key, message in app.session.flashbag.all() %}
          <div class="alert alert-{{ key }}">
              {{ message|trans({}, 'FOSUserBundle') }}
          </div>
      {% endfor %}

      {% block fos_user_content %}
      {% endblock fos_user_content %}
    </div>
  </div>
{% endblock %} 
```

在 rs/UserBundle/Ressources/views/Security/login.html.twig ：

```
{% extends "FOSUserBundle::layout.html.twig" %}

{% block fos_user_content %}
{% if error %}
    <div>{{ error|trans({}, 'FOSUserBundle') }}</div>
{% endif %}

{% include "UserBundle:Security:login_content.html.twig" %}

{% endblock fos_user_content %} 
```

在 rs/UserBundle/Ressources/views/Security/login_content.html.twig ：

```
<form action="{{ path("fos_user_security_check") }}" method="post">
    <input type="hidden" name="_csrf_token" value="{{ csrf_token }}" />

    <label for="username">{{ 'security.login.username'|trans({}, 'FOSUserBundle') }}</label>
    <input type="text" id="username" name="_username" value="{{ last_username }}" />

    <label for="password">{{ 'security.login.password'|trans({}, 'FOSUserBundle') }}</label>
    <input type="password" id="password" name="_password" />

    <input type="checkbox" id="remember_me" name="_remember_me" value="on" />
    <label for="remember_me">{{ 'security.login.remember_me'|trans({}, 'FOSUserBundle') }}</label>

    <input type="submit" id="_submit" name="_submit" value="{{ 'security.login.submit'|trans({}, 'FOSUserBundle') }}" />
</form> 
```

在 rs/UserBundle/Controller/ 我只有一个文件 UserController.php ：

```
<?php

namespace rs\UserBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Response;
use FOS\UserBundle\Controller\SecurityController as SecurityController;

use rs\UserBundle\Entity\User;

/**
 * Description of UserController
 *
 */
class UserController extends SecurityController {

    public function LoginBisAction()
    {
        $csrfToken = $this->container->get('form.csrf_provider')->generateCsrfToken('authenticate');

        return $this->container->get('templating')->renderResponse('FOSUserBundle:Security:login_content.html.twig', array(
            'last_username' => null,
            'error'         => null,
            'csrf_token'    => $csrfToken
        ));
    }
} 
```

怎么了，我必须在某处创建路线吗？为什么当我转到我的主页时找不到我的 loginAction？为什么我有这个错误：

在第 15 行的 rSWelcomeBundle:Homepage:index.html.twig 中呈现模板（“未找到“GET Security:LoginBisAction”的路由”）时引发异常。

非常感谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T23:44:52.183

如错误消息中所示：`"No route found for "GET Security:LoginBisAction""`. 所以你被称为不存在的路线（完全不存在的控制器动作）。请注意，没有`LoginBisAction`原始`Security`FOSUser 捆绑包。尝试调用您的扩展控制器操作：

```
{% render 'rsUserBundle:User:LoginBisAction' %} 
```

# java - 有没有办法在 Java 中使 READY .png 图像变暗？

> ID：15821633
> 
> 赞同：2
> 
> 时间：2013-04-04T21:01:57.320
> 
> 标签：java, graphics, colors, icons, png

我有一个 READY 图像（图像的颜色是灰色的，它是 GIVEN 的，即我不在 Java 中创建它，否则我会简单地动态更改颜色）。图像的形状很奇怪，即它不是一个矩形。我有一个透明部分和“图像内容”部分（常规 .png 样式）。我只需要使“图像内容”部分变得更暗。我尝试了以下方法：

```
public class ImageDarkener extends JFrame {
private JButton button;
private JLabel myImage;
public ImageDarkener()
{
createImageDarkener();
}
private void createImageDarkener() {
Container contentPane = getContentPane();
contentPane.setBackground(Color.WHITE);
contentPane.setLayout(null);

contentPane.setSize(900,600);

myImage = new JLabel();
myImage.setIcon(new ImageIcon("myImage.png"));
myImage.setBounds(403,31,200,200);
contentPane.add(myImage);

button = new JButton("Go darker");
button.setBounds(90,400, 100, 100);
contentPane.add(button);
button.addActionListener(
    new ActionListener()
    {
    public void actionPerformed(ActionEvent event) {
    buttonActionPerformed(event);
    }
}
);

setTitle("Image gets darker");
setSize(900,600);
setVisible(true);
setLocationRelativeTo(null);

}

private void buttonActionPerformed(ActionEvent event) {
myImage.darker();
     // Here I am stuck...I tried many combinations with darker().....etc. 
I need to be able to click the button and myImage should get darker and darker
until it is completely black...
}

public static void main(String args[]) {
ImageDarkener img = new ImageDarkener();
img.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
}

} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T21:47:37.203

我相信，这是您所期望的：

```
public class ImageDarkener extends JFrame {
    private JButton button;
    private JLabel myImage;

    public ImageDarkener() {
        createImageDarkener();
    }

    private void createImageDarkener() {
        Container contentPane = getContentPane();
        contentPane.setBackground(Color.WHITE);
        contentPane.setLayout(null);

        contentPane.setSize(900, 600);

        myImage = new JLabel();
        myImage.setIcon(new ImageIcon("myImage.png"));
        myImage.setBounds(403, 31, 200, 200);
        contentPane.add(myImage);

        button = new JButton("Go darker");
        button.setBounds(90, 400, 100, 100);
        contentPane.add(button);
        button.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent event) {
                buttonActionPerformed(event);
            }
        });

        setTitle("Image gets darker");
        setSize(900, 600);
        setVisible(true);
        setLocationRelativeTo(null);

    }

    private void buttonActionPerformed(ActionEvent event) {
        Image img = ((ImageIcon) myImage.getIcon()).getImage();

        BufferedImage buffered = new BufferedImage(img.getWidth(null),
        img.getHeight(null), BufferedImage.TYPE_INT_ARGB);
        buffered.getGraphics().drawImage(img, 0, 0, null);

        for (int i = 0; i < buffered.getWidth(); i++) {
            for (int j = 0; j < buffered.getHeight(); j++) {                    
                int rgb = buffered.getRGB(i, j);
                int alpha = (rgb >> 24) & 0x000000FF;
                Color c = new Color(rgb);
                if (alpha != 0) {
                    int red = (c.getRed() - 10) <= 0 ? 0 : c.getRed() - 10;
                    int green = (c.getGreen() - 10) <= 0 ? 0
                        : c.getGreen() - 10;
                    int blue = (c.getBlue() - 10) <= 0 ? 0 : c.getBlue() - 10;
                    c = new Color(red, green, blue);
                    buffered.setRGB(i, j, c.getRGB());
                }
            }
        }
        myImage.setIcon(new ImageIcon(buffered));
    }

    public static void main(String args[]) {
        ImageDarkener img = new ImageDarkener();
        img.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    }

} 
```

# .net - 查找性能：数组、列表还是字典？

> ID：15821634
> 
> 赞同：4
> 
> 时间：2013-04-04T21:01:57.867
> 
> 标签：.net, arrays, performance, list, dictionary

我有一个字符串被分成一个整数数组。该数组的大小可以是 1 项，最多 100,000 项（或更大）。顺序并不重要。

目标是稍后使用该对象来确定该值是否存在。一个单独的循环将针对该对象进行测试以查看该项目是否存在（循环将迭代超过`testmeInt`数组中的项目数）。

**方式一：数组**

尝试选择整数，捕获错误

**方式2：字典**

```
var testme = "12,23".Split(',');
int[] testmeInt = Array.ConvertAll<string, int>(testme, int.Parse);
Dictionary<int, int> TestMeDict = new Dictionary<int, int>();

foreach (int item in testmeInt)
{
    TestMeDict.Add(item, 0);
}

for (int i = 1; i <= 50000000; i++)
{
    if (TestMeDict.ContainsKey(i) == true) {  
        //It Exists
    }
} 
```

我的猜测是使用 Dictionary 的 Way2 将是最快的。这个[问题](https://stackoverflow.com/questions/8307222/dictionary-list-or-array)与我的类似，但不涵盖我的确切用例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:03:58.267

假设这些值是唯一的，那么由于哈希查找，字典通常是检查集合中是否存在项目的最快方法。

整个存储项（值）不需要直接相等性检查，只需键即可，这在引擎盖下由字典作为哈希处理。

* * *

正如 Jon Skeet 所提到的，如果您只是存储整数并且不需要直接基于键的查找，那么 HashSet 是一种更好的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T03:41:23.313

谢谢大家的提示。研究 HashSet 我遇到了下面的帖子，它直接回答了我的问题。

根据我的技术要求，HashSet 就是答案。但是，下面博客中的性能测试表明，我的 Way 2 Dictionary.Key 方法与 Hashset (0 ms) 具有相同的性能。

[http://theburningmonk.com/2011/03/hashset-vs-list-vs-dictionary/](http://theburningmonk.com/2011/03/hashset-vs-list-vs-dictionary/)

[HashSet<T> 与 Dictionary<K, V> wrt 搜索时间以查找项目是否存在](https://stackoverflow.com/questions/2728500/hashset-versus-dictionaryt-k-w-r-t-searching-time-to-find-if-an-item-exists)

# php - 如何根据位置拆分字符串

> ID：15821635
> 
> 赞同：-1
> 
> 时间：2013-04-04T21:01:58.650
> 
> 标签：php

我想根据字符的位置拆分一个变量。生成的第一个字符串应具有指定位置之前的先前位置，而另一个字符串应包含其他部分。

假设如果我有一个`$var = "2013AD";` 我想要的变量

`$var1 = 2013`和`var2 = 'AD'`。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T21:04:22.390

嗯...要去occam的剃刀这里，但是[substr](http://php.net/manual/en/function.substr.php)？

```
$var1 = substr($var, 0, 4);
$var2 = substr($var, 4); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-04T21:05:54.070

你可以简单地使用`sscanf`

```
$var = "2013AD";
list($var1, $var2) = sscanf($var, "%4d%2s");
echo $var1, ":", $var2; 
```

输出

```
2013:AD 
```

如果您正在使用`date`它，请这样对待：

```
$var = "2013AD";
$date  = DateTime::createFromFormat("Y\A\D",$var);
echo $date->format("Y"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T21:10:28.537

```
<?php

function py_slice($input, $slice) {
    $arg = explode(':', $slice);
    $start = intval($arg[0]);
    if ($start < 0) {
        $start += strlen($input);
    }
    if (count($arg) === 1) {
        return substr($input, $start, 1);
    }
    if (trim($arg[1]) === '') {
        return substr($input, $start);
    }
    $end = intval($arg[1]);
    if ($end < 0) {
        $end += strlen($input);
    }
    return substr($input, $start, $end - $start);
}

print py_slice('abcdefg', '2') . "\n";
print py_slice('abcdefg', '2:4') . "\n";
print py_slice('abcdefg', '2:') . "\n";
print py_slice('abcdefg', ':4') . "\n";
print py_slice('abcdefg', ':-3') . "\n";
print py_slice('abcdefg', '-3:') . "\n";

?> 
```

示例的输出：

*   C
*   光盘
*   cdefg
*   A B C D
*   A B C D
*   电子烟

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T21:06:24.727

你可以使用 substr 函数

```
$var1 = substr($var, 0, 4);
$var2 = substr($var, 4); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-14T08:06:33.280

您还可以使用`preg_split()`with`\K`在字符串中的零宽度位置展开，以便在拆分时不会丢失任何字符。 `\K`告诉正则表达式引擎忘记之前匹配的一位或多位数字。 `2`用于将输出中的元素数量限制为最多 2 个。

代码：（[演示](https://3v4l.org/3rlMf)）

```
$var = "2013AD";

[$year, $jesusStatus] = preg_split('~\d+\K~', $var, 2);

var_export($year);
echo "\n";
var_export($jesusStatus); 
```

输出：

```
'2013'
'AD' 
```

# ajax - 带有 grails 和 ajax 的引导弹出窗口

> ID：15821641
> 
> 赞同：0
> 
> 时间：2013-04-04T21:02:49.933
> 
> 标签：ajax, grails, twitter-bootstrap, popover

只是试图在 BS 弹出窗口中使用 ajax formRemote。一个简单的表单可以工作，但 ajax 实现不行：

1）gsp代码

```
 <div id="addfolder">
            <a href="#" class="btn" id="nrfolder" rel="popover">
            <i class="icon-folder-close icon-large"></i></a><%--<g:message code="folder"  args="[entityName]" default="New Folder"/>--%></a>
        </div>
        <div id="newRootFolder" style="display:none;">
        <form class="form-inline" style="width:280px;">
        <g:formRemote name="createRootFolder" url="[controller:'folders',action:'create']" onLoading="showModalSpinnerNewFolder();" onComplete="hideModalSpinnerNewFolder();" onSuccess="doResponseNewFolder(data);" >
              <g:textField  name="folderName" class="input-small" type="text" placeholder="New folder"/>
              <input type="submit" value="Create" class="btn btn-info" />
              <a href="#" class="btn"  onclick="$('#nrfolder').popover('hide')"/>Cancel</a>
        </g:formRemote>
</g:formRemote>
    </form>
    </div> 
```

2) 使用 jquery 的弹出框调用

```
$('#nrfolder').popover({placement:'right',title:'New Root Folder',html:true,content: function() { return $('#newRootFolder').html();} }); 
```

3）jquery成功事件：doResponseNewFolder函数

```
function doResponseNewFolder(data) {
        alert('toto' + data.success);
        if (data.success == 'true') {
            var msg = data.msg;
            // reload tree view
            $('#tree').dynatree('getTree').reload();
        } else {
            var msg = $('<ul class="errors">');
            for (var i = 0; i < data.errorList.length; i++) {
                msg.append('<li>' + data.errorList[i] + "</li>");
            }
        }
        $('#new_folder_msg').html(msg);
        $('#new_folder_msg').show();
    } 
```

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:47:18.327

看起来你搞砸了表单，让我解释一下：Grails'`g:formRemote`是制作 ajax Web 表单的助手，所以如果你查看生成的 HTML，就会在调用时生成一个表单。

事实上，您已经打开了一个表单，它不是有效的 HTML 语法。第一种形式不应该存在。您可以将其属性赋予您的`g:formRemote`但 Grails 会将它们传递给您生成的`form`：

```
<g:formRemote class="form-inline" style="width:280px;" name="createRootFolder" url="[controller:'folders',action:'create']" onLoading="showModalSpinnerNewFolder();" onComplete="hideModalSpinnerNewFolder();" onSuccess="doResponseNewFolder(data);" >
      <g:textField  name="folderName" class="input-small" type="text" placeholder="New folder"/>
      <input type="submit" value="Create" class="btn btn-info" />
      <a href="#" class="btn"  onclick="$('#nrfolder').popover('hide')"/>Cancel</a>
</g:formRemote> 
```

这一点，没有其他形式重叠，就足够了。

# ruby-on-rails - 跑步者的路径是什么——无论何时——Ruby

> ID：15821642
> 
> 赞同：1
> 
> 时间：2013-04-04T21:02:51.763
> 
> 标签：ruby-on-rails, ruby, whenever

我正在尝试使用 'runner' 选项执行模型，但似乎找不到正确的路径。

我的`cronjobs.rb`文件在`/app/models/`：

```
class Cronjobs
  def tryCron
    notificacion = Notificacion.new

    notificacion.idNotificacion = '1'
    notificacion.idUser = '1'
    notificacion.notification_type = 'cron_job'
    notificacion.text ='cronojob'
    notificacion.href = 'cron'
    notificacion.state = 'done'
    notificacion.date_created = Time.zone.now.to_datetime - 3.hours
    notificacion.save
  end 
end 
```

这是我的 schedule.rb

```
set :output, 'log/cron.log'

every 5.minutes do
  runner "Cronjobs.tryCron"
end 
```

在日志上它说'tryCron'它是该类的未定义方法`Cronjobs:Class`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:11:06.993

```
class Cronjobs
  def self.tryCron 
```

我认为它应该有所帮助，顺便说一下，不要用骆驼命名方法，使用下划线 try_cron

# struts2 - 将 StrutsSpringObjectFactory 设置为我当前的 ObjectFactory

> ID：15821643
> 
> 赞同：1
> 
> 时间：2013-04-04T21:02:52.980
> 
> 标签：struts2, opensymphony

我正在开发一个使用 openSymphony 2.1.2 和 struts 2.3.8 的项目。

但是，在该代码库上，我正在尝试应用为旧版本的 openSymphony 和 struts 编写的片段代码。

这是那段代码：

[http://www.lischke-online.de/index.php/java/action-unit-testing-with-struts-2-0-part-2](http://www.lischke-online.de/index.php/java/action-unit-testing-with-struts-2-0-part-2)

（作为旁注，我需要该代码以便能够在基于不同框架的系统中模拟从我继承的项目中运行 struts 操作。）

我对以下段落有疑问：

```
final StrutsSpringObjectFactory ssf = new StrutsSpringObjectFactory("auto", "true", servletContext);
ObjectFactory.setObjectFactory(ssf); 
```

在第二行，我收到错误：`The method setObjectFactory(StrutsSpringObjectFactory) is undefined for the type ObjectFactory`

但是，当我查看[ObjectFactory 的 javadoc 时](http://www.jarvana.com/jarvana/view/com/opensymphony/xwork-core/2.1.6/xwork-core-2.1.6-javadoc.jar!/com/opensymphony/xwork2/ObjectFactory.html)，我没有看到可以让我设置特定`ObjectFactory`（例如`StrutsSpringObjectFactory`）的替代方法，因为`ObjectFactory`在执行操作时将使用该方法。那么如何`ObjectFactory`使用新的 API 设置这样的特定值呢？

**更新代码：**

```
static {
    sessionMap = new HashMap<String, Object>();

    // Create fake back end here.
    // ...

    // ===== Struts setup:
    // Create and use a file system resource loader otherwise Tiles will not find
    // our configuration file. The default resource loader is able to find struts.xml
    // if it is in the classpath, but not tiles.xml.
    final FileSystemResourceLoader loader = new FileSystemResourceLoader();

    final String[] config = new String[] { "WEB-INF/classes/struts.xml" };

    servletContext = new MockServletContext(loader);
    final XmlWebApplicationContext appContext = new XmlWebApplicationContext();

    // Link the servlet context and the Spring context.
    appContext.setServletContext(servletContext);
    appContext.setConfigLocations(config);
    appContext.refresh();
    servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE,
        appContext);

    servletContext.addInitParameter(BasicTilesContainer.DEFINITIONS_CONFIG, "WEB-INF/tiles.xml");

    // Creating the tiles listener statically (not via class loader).
    final StrutsTilesListener tilesListener = new StrutsTilesListener();
    final ServletContextEvent event = new ServletContextEvent(servletContext);
    tilesListener.contextInitialized(event);

    // Use spring as the object factory for Struts
    //this code not working anymore with struts 2.3.2:
    //final StrutsSpringObjectFactory ssf = new StrutsSpringObjectFactory("auto", "true", servletContext);
    //ObjectFactory.setObjectFactory(ssf);

    //my change: (original note working with newer version of struts)
    //StrutsSpringObjectFactory.setObjectFactory(ssf);

    //(*) original location.

    // Dispatcher is the guy that actually handles all requests. Pass in
    // an empty. Map as the parameters but if you want to change stuff like
    // what config files to read, you need to specify them here
    // (see Dispatcher's source code)
    dispatcher = new Dispatcher(servletContext, new HashMap<String, String>()); 
    dispatcher.init();
    Dispatcher.setInstance(dispatcher);

    //(*) moved to here:
    //http://stackoverflow.com/questions/15821643/setting-strutsspringobjectfactory-as-my-current-objectfactory?noredirect=1#comment22519072_15821643
    final StrutsSpringObjectFactory ssf = new StrutsSpringObjectFactory("auto", "true", "false", servletContext, "false", dispatcher.getContainer());

} 
```

从 webapp（部署的战争）中调用测试时，我在该代码上获得的堆栈跟踪：

```
08:50:28,471 WARNING [javax.enterprise.resource.webcontainer.jsf.lifecycle] (http--127.0.0.1-8080-1) #{accountLookupBean.lookupAccounts()}: java.lang.ExceptionInInitial
izerError: javax.faces.FacesException: #{accountLookupBean.lookupAccounts()}: java.lang.ExceptionInInitializerError
        at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:118) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
        at javax.faces.component.UICommand.broadcast(UICommand.java:315) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
        at javax.faces.component.UIData.broadcast(UIData.java:1093) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
        at javax.faces.component.UIData.broadcast(UIData.java:1093) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
        at javax.faces.component.UIData.broadcast(UIData.java:1093) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
        at javax.faces.component.UIViewRoot.broadcastEvents(UIViewRoot.java:794) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
        at javax.faces.component.UIViewRoot.processApplication(UIViewRoot.java:1259) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
        at com.sun.faces.lifecycle.InvokeApplicationPhase.execute(InvokeApplicationPhase.java:81) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
        at com.sun.faces.lifecycle.LifecycleImpl.execute(LifecycleImpl.java:118) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:593) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0.Final]
        at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.10.Final.jar:]
        at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.10.Final.jar:]
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:275) [jbossweb-7.0.10.Final.jar:]
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:161) [jbossweb-7.0.10.Final.jar:]
        at org.jboss.as.web.security.SecurityContextAssociationValve.invoke(SecurityContextAssociationValve.java:154) [jboss-as-web-7.1.0.Final.jar:7.1.0.Final]
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:155) [jbossweb-7.0.10.Final.jar:]
        at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.10.Final.jar:]
        at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.10.Final.jar:]
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.10.Final.jar:]
        at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.10.Final.jar:]
        at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.10.Final.jar:]
        at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.10.Final.jar:]
        at java.lang.Thread.run(Thread.java:662) [rt.jar:1.6.0_29]
Caused by: javax.faces.el.EvaluationException: java.lang.ExceptionInInitializerError
        at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:102) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.
0.Final]
        at com.sun.faces.application.ActionListenerImpl.processAction(ActionListenerImpl.java:102) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
        ... 23 more
Caused by: java.lang.ExceptionInInitializerError
        at com.myapp.services.AccountLookupServiceImpl.getRows(AccountLookupServiceImpl.java:38) [classes:]
        at com.myapp.beans.AccountLookupBean.lookupAccounts(AccountLookupBean.java:39) [classes:]
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) [rt.jar:1.6.0_29]
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39) [rt.jar:1.6.0_29]
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25) [rt.jar:1.6.0_29]
        at java.lang.reflect.Method.invoke(Method.java:597) [rt.jar:1.6.0_29]
        at org.apache.el.parser.AstValue.invoke(AstValue.java:262) [jbossweb-7.0.10.Final.jar:]
        at org.apache.el.MethodExpressionImpl.invoke(MethodExpressionImpl.java:278) [jbossweb-7.0.10.Final.jar:]
        at com.sun.faces.facelets.el.TagMethodExpression.invoke(TagMethodExpression.java:105) [jsf-impl-2.1.5-jbossorg-1.jar:2.1.5-SNAPSHOT]
        at javax.faces.component.MethodBindingMethodExpressionAdapter.invoke(MethodBindingMethodExpressionAdapter.java:88) [jboss-jsf-api_2.1_spec-2.0.0.Final.jar:2.0.0
.Final]
        ... 24 more
Caused by: org.springframework.beans.factory.BeanDefinitionStoreException: IOException parsing XML document from ServletContext resource [/WEB-INF/classes/struts.xml];
nested exception is java.io.FileNotFoundException: Could not open ServletContext resource [/WEB-INF/classes/struts.xml]
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:341) [spring-beans-3.2.1.RELEASE.jar:3.2.1.REL
EASE]
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:302) [spring-beans-3.2.1.RELEASE.jar:3.2.1.REL
EASE]
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:174) [spring-beans-3.2.1.RELEASE
.jar:3.2.1.RELEASE]
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:209) [spring-beans-3.2.1.RELEASE
.jar:3.2.1.RELEASE]
        at org.springframework.beans.factory.support.AbstractBeanDefinitionReader.loadBeanDefinitions(AbstractBeanDefinitionReader.java:180) [spring-beans-3.2.1.RELEASE
.jar:3.2.1.RELEASE]
        at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:125) [spring-web-3.2.1.RELEASE.jar:3.2.1.R
ELEASE]
        at org.springframework.web.context.support.XmlWebApplicationContext.loadBeanDefinitions(XmlWebApplicationContext.java:94) [spring-web-3.2.1.RELEASE.jar:3.2.1.RE
LEASE]
        at org.springframework.context.support.AbstractRefreshableApplicationContext.refreshBeanFactory(AbstractRefreshableApplicationContext.java:130) [spring-context-
3.2.1.RELEASE.jar:3.2.1.RELEASE]
        at org.springframework.context.support.AbstractApplicationContext.obtainFreshBeanFactory(AbstractApplicationContext.java:537) [spring-context-3.2.1.RELEASE.jar:
3.2.1.RELEASE]
        at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:451) [spring-context-3.2.1.RELEASE.jar:3.2.1.RELEASE]
        at com.myapp.softgems.ActionBaseTestCase.<clinit>(ActionBaseTestCase.java:70) [classes:]
        ... 34 more
Caused by: java.io.FileNotFoundException: Could not open ServletContext resource [/WEB-INF/classes/struts.xml]
        at org.springframework.web.context.support.ServletContextResource.getInputStream(ServletContextResource.java:140) [spring-web-3.2.1.RELEASE.jar:3.2.1.RELEASE]
        at org.springframework.beans.factory.xml.XmlBeanDefinitionReader.loadBeanDefinitions(XmlBeanDefinitionReader.java:328) [spring-beans-3.2.1.RELEASE.jar:3.2.1.REL
EASE]
        ... 44 more 
```

**更新 2：**

我希望能够测试一个动作的原因不仅仅是能够从项目资源管理器中右键单击它，而不是右键单击“以 Junit 身份运行”。我实际上想将测试作为我的 Web 应用程序的一部分运行。

这就是我的意思：我试图从我的一个服务类中调用以下代码：

```
DataTest test = new DataTest("testDataAction");

JUnitCore jUnitCore = new JUnitCore();
jUnitCore.run(test); 
```

因为，在 DataTest 中我尝试执行（） DataAction。该操作调用一些混乱的数据库逻辑并最终返回一些数据。我需要这些数据来提供服务。与其试图弄清楚 Action 究竟做了什么，我只想简单地执行（）它并获取数据。我试图做到这一点的方式是运行一个将执行（）动作的测试。

我的 struts.xml 并不直接在我正在构建的项目中。这是我的情况：让我们将我的新项目称为项目A；以及我依赖的遗留 struts 项目，项目 B。项目 A 正在由其他框架（JSF 和 Spring）构建。项目 B 为 UI 使用了 struts。但是它的动作写得如此凌乱，以至于很多数据库访问逻辑都直接写在动作中。因此，如果我想使用项目 B 中的逻辑而不是重写它，一个临时解决方案（我正在尝试完成）将是使用相应的请求数据从项目 B 执行一个动作。这样做的方法是在 A 的服务类中对 B 的 Action 运行测试。

由于项目 B 被打包为一个 war 文件，我在项目 A 中使用 Maven 重用它的方法是将其定义为项目 A 中的覆盖。项目 B 的类路径中的类和其他资源被打包到一个 jar 中。然后在项目 AI 中依赖于那个 jar。所以 struts.xml 存在于包含项目 B 的类和 xml 的 jar 中。在编译时，项目 A 只能看到项目 A 的 jar 中的 struts.xml。

只有当我打包项目A时，war B被解包，它的内容（包括struts.xml）被复制到项目A的目标文件夹中，然后A+B一起打包为war。（在最后的战争中，struts.xml 将在 jar B 中，并且在最后的战争中的 WEB-INF/classes 中。

所以实际上，如果我尝试通过右键单击测试来运行测试并且它们“以 junit 身份运行”，它不应该在我的类路径的某些 WEB-INF/类中找到 struts.xml - 首先在我的工作空间，只在创造的战争中。其次，我只尝试在战争中运行测试（如上所示）。那个时候有WEB-INF/classes/struts.xml，为什么找不到呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T08:47:25.353

只需创建新实例，`StrutsSpringObjectFactory`但在创建`Dispatcher`.

```
final StrutsSpringObjectFactory ssf = new StrutsSpringObjectFactory("auto",
      "true", "false", servletContext, "false", dispatcher.getContainer()); 
```

但是看看 struts2-junit-plugin 以测试 Struts2 动作。它有`StrutsSpringJUnit4TestCase`方便的方法，所以你不需要自己做所有的事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T08:03:46.723

您需要包含 Struts2-Spring-plugin(*.jar)

[http://struts.apache.org/release/2.3.x/docs/spring-plugin.html](http://struts.apache.org/release/2.3.x/docs/spring-plugin.html)

> Spring 插件通过覆盖 Struts ObjectFactory 来增强核心框架对象的创建。当一个对象被创建时，它使用 Struts 配置中的 class 属性来对应 Spring 配置中的 id 属性。如果没有找到，该类将尝试照常创建，然后由 Spring 自动装配。对于 Actions，Spring 2 的 bean 范围特性可用于将 Action 实例范围限定为会话、应用程序或自定义范围，在默认的每个请求范围之外提供高级自定义。

# actionscript-3 - addChild() 复制 MovieClip 而不是从父级删除

> ID：15821647
> 
> 赞同：0
> 
> 时间：2013-04-04T21:03:26.153
> 
> 标签：actionscript-3, flash, actionscript, air

当`addChild()`与 .fla 中添加到舞台的对象一起使用时，该对象仍然是其原始父级的子级（减去在 AS 中添加的任何内容），新父级包含该对象的副本（以及在 AS 中添加的任何内容） ）。`removeChild()`使用或添加到同一个父级时会发生同样的事情。

我怎样才能阻止它离开副本？

# linux - 在每次系统调用时插入 kprobes

> ID：15821649
> 
> 赞同：3
> 
> 时间：2013-04-04T21:03:30.860
> 
> 标签：linux, linux-kernel, linux-device-driver, kprobe

如何在每个系统调用点插入内核探针？我需要跟踪程序进行的所有系统调用。我设法检测了一些例程，但不是实际的系统调用。

谢谢

# python - Django 保存日期

> ID：15821650
> 
> 赞同：0
> 
> 时间：2013-04-04T21:03:31.577
> 
> 标签：python, django, django-models, python-2.7, django-views

目前我有一个脚本可以查询 TS3 服务器，然后将它们的 SID 和玩家数量存储在数据库表中，Django 可以使用该表来呈现图表。一切正常，包括图表的渲染，但是我无法在保存时从日期中删除秒数。我有一个名为“startTime”的变量来获取日期和时间。这有效并给出了类似“04-04-2013 16:58”的输出，但是当将其保存到数据库时，我得到类似“04-04-2013 16:58:32”的输出。这就是我用来获取日期和时间的方法。

```
startTime = datetime.now().strftime("%d-%m-%Y %H:%M") 
```

关于如何在保存之前甚至之后通过更新数据库中的行来删除秒的任何想法？我正在使用 Charfield 来存储日期。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:25:04.113

[像这样使用 datetime.replace 方法](http://docs.python.org/2/library/datetime.html#datetime.datetime.replace)：`datetime.now().replace(second=0, microsecond=0)`

# ios - NSIncrementalStore 子类中的乐观锁定支持

> ID：15821652
> 
> 赞同：5
> 
> 时间：2013-04-04T21:03:37.453
> 
> 标签：ios, ipad, core-data, optimistic-locking, nspersistentstore

我正在实现一个自定义*NSIncrementalStore*子类，它使用关系数据库进行持久存储。我仍然在努力解决的一件事是对乐观锁定的支持。

* * *

***（请随意跳过这个冗长的描述，直接回答我下面的问题）***

我分析了 Core Data 的 SQLite 增量存储是如何通过检查它产生的 SQL 日志来解决这个问题的，并得出以下结论：

*   数据库中的每个实体表都有一个**Z_OPT**列，该列指示该实体（行）的特定实例已被修改的次数，从 1（初始插入）开始。

*   每次修改托管对象时，其相应数据库行中的**Z_OPT**值都会增加。

*   *存储维护NSIncrementalStoreNode*实例的缓存（在 Core Data 文档中称为*行缓存*） ，每个实例都有一个**版本**属性，该值等于先前对托管对象行的**SELECT**或**UPDATE SQL 查询返回的****Z_OPT**值。

********   当一个托管对象从*NSManagedObjectContext*返回时（例如，通过对其执行*NSFetchRequest*），MOC 创建包含该**版本**号的该对象的快照。

    *   当对象被修改或删除时，Core Data 通过比较缓存行和对象快照的版本来确保它没有在上下文之外被修改或删除。所有这些都发生在对象所属的上下文中调用**-save:时。**如果版本不同，则根据设置的合并策略检测和处理合并冲突。******* 

 *****保存 MOC 时，为每个修改/删除的对象调用**-newValuesForObjectWithID:withContext:error:**方法，该方法又返回带有版本号的*NSIncrementalStoreNode 。*然后将此版本与快照的版本进行比较，如果它们不同，则保存失败并出现适当的合并冲突（至少使用默认合并策略）。

这个简单的用例适用于我的商店，因为**-newValuesForObjectWithID:withContext:error:**首先检查行缓存，如果对象在其他上下文中使用相同的商店实例同时修改就足够了。如果是这种情况，则缓存包含具有更高版本号的更新行，足以检测到冲突。

但是，我如何才能检测到底层数据库是否已在我的商店之外被修改，可能是由其他应用程序或其他商店实例使用相同的数据库文件？我知道这是一个不常见的边缘情况，但 Core Data 可以正确处理它，我更愿意这样做。

Core Data 的存储使用这些 SQL 查询来更新/删除对象的行：

```
UPDATE ZFOO SET Z_OPT=Y, (...) WHERE (...) AND Z_OPT=X
DELETE FROM ZFOO WHERE (...) AND Z_OPT=X 
```

其中：
**X** - 存储区最后知道的版本号（来自缓存）
**Y** - 新版本号

如果这样的查询失败（没有行受到影响），该行将在存储的缓存中更新，并将其版本与先前缓存的版本进行比较。

* * *

**我的问题是**：自定义*NSIncrementalStore*如何通知核心数据某些更新/删除/锁定的对象发生乐观锁定失败？只有商店才能知道当它处理传递给它的*NSSaveChangesRequest时，它的***-executeRequest:withContext:error:**方法。

如果存储下的底层数据库没有更改，那么会检测到冲突，因为 Core Data在对存储执行保存更改请求之前对每个修改/删除/锁定的对象调用**-newValuesForObjectWithID:withContext:error:。**我无法找到任何方法让*NSIncrementalStore*通知 Core Data 在它开始处理保存请求**后**发生了乐观锁定失败。有没有一些无证的方法可以做到这一点？在这种情况下， Core Data 似乎抛出*了一些*异常，然后神奇地转换为失败的保存请求，其中 NSError 列出了所有冲突。我只能通过从**-executeRequest:withContext:error 返回 nil 来部分模仿这一点：**并自己创建错误消息。我认为在这种情况下也必须有一种方法可以使用标准的 Core Data 冲突处理机制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T11:17:30.537

我意识到这不是您问题的答案，但我会尝试向您提供我对 CoreData 和与数据库的相关性的观点：

（一级缓存）
NSPsistentStoreCoordinator + NSPersistentStore == 单个数据库连接

（二级缓存）
NSManagedObjectContext == 缓存在保持更改的连接上

因此，据我了解，您的问题是您与商店有多个连接，每个都进行更改，但您对记录没有中央版本控制。您的商店将收到一个`-executeRequest:withContext:error:`with`NSSaveRequestType`
然后您将负责验证记录版本是否匹配，如果您发现连接级别（级别 1）存在冲突，则报告上下文（级别 2）和协调器之间的版本不匹配。
您需要报告您的连接（级别 1）和您的商店之间的版本不匹配。
为了能够做到这一点，您的商店必须报告它的所有连接上的更改（ConnectionManager），或者它可能会提供对它执行的更改的挂钩。
我不是 SQLite 专家，但 SQLite API 确实在该领域提供了一些东西：
[更新挂钩](http://www.sqlite.org/c3ref/update_hook.html)
[提交挂钩](http://www.sqlite.org/c3ref/commit_hook.html)
[更改](http://www.sqlite.org/c3ref/changes.html)
[总更改](http://www.sqlite.org/c3ref/total_changes.html)
（我没有设置此类挂钩的经验，但如果 CoreData 使用它们，它将不会显示在调试日志中）

您可以通过设置错误指针 (NSError**) 并设置其内部数据以匹配 CoreData 协调器正在设置的数据来报告这些错误（创建合并冲突并根据需要在其中设置信息）

请注意，乐观锁定失败只会发生在`-executeRequest:withContext:error:` （除非您与商店有恶意连接，经理不跟踪该连接。
为了支持这种行为，您的经理可能需要在提交保存时验证每条记录[巨大性能成本]，或者在最近对记录所做的更改中使用一些挂钩）

要处理到您的商店的多个连接，您可能需要有一个 NSIncrementalStoreNode 的共享缓存，以商店 url 为键：
static @{
url1 : actualCacheMapping1,
url2 : actualCacheMapping2,
...
}
每个保存到商店的连接都将再次验证存储 url 实际缓存。

希望这对你有一些意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-24T03:35:20.030

> 我的问题是：自定义 NSIncrementalStore 如何通知 Core Data 一些更新/删除/锁定对象发生乐观锁定失败？只有商店才能知道当它处理传递给它的 NSSaveChangesRequest 时，它的 -executeRequest:withContext:error: 方法。

在 an`NSIncrementalStore`中，`NSIncrementalStoreNode`s 表示存储快照。节点的`version`属性是乐观锁定原语。持久存储负责在存储级别检测乐观锁定失败，而托管对象上下文可以在更高的位置检测它们。如果存储正在与之交谈的系统被其他东西更改，并且该系统的状态与持久存储中的状态表示之间存在冲突，则可能会发生存储级别的乐观锁定失败。例如，如果商店正在与 Web 服务通信并且 Web 服务数据被另一个用户更改，等等。

如果在保存期间在您的商店实现中检测到乐观锁定失败，您的商店负责创建`NSMergeConflict`描述它的对象。这些将由`NSPersistentStoreCoordinator`.

```
[[NSMergeConflict alloc] initWithSource:managedObject newVersion:newVersion oldVersion:oldVersion cachedSnapshot:inMemorySnapshot persistedSnapshot:storedSnapshot]; 
```

快照字典应包括所有建模的属性属性名称作为键及其值。这不包括关系。对于某些商店，使用来自引用对象或 NSIncrementalStoreNodes 的值可能就足够了，只要它们只包含建模的属性属性名称作为键（并且这些很容易从实体描述中获取）。

`NSError`创建这些对象后，`NSCocoaErrorDomain`使用代码创建一个`NSPersistentStoreSaveConflictsError`。userInfo 对象应包含`NSPersistentStoreSaveConflictsErrorKey`应包含对象数组的键`NSMergeConflict`。从保存请求中返回它，然后`NSPersistentStoreCoordinator`将负责寻找解决方案。请记住，您不应该为存储中的对象状态之间的冲突生成合并冲突`NSManagedObjectContext`，仅针对存储中的任何内存或缓存状态与保存或持久化数据的位置之间的冲突（如 Web 服务，或数据库等）*****

# android - requestLocationUpdates 不适用于服务

> ID：15821653
> 
> 赞同：0
> 
> 时间：2013-04-04T21:03:37.763
> 
> 标签：android, location, android-service, locationmanager, android-context

我的应用正在使用**requestLocationUpdates**（来自 GPS 和网络，以先到者为准）。

我的代码：

```
LocationManager lm = (LocationManager) context
                .getSystemService(Context.LOCATION_SERVICE);
lm.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0,
                    myLocationListenerInstance);

timeout = new Timer();
timeout.schedule(myGetLastKnownLocationInstance, TIMEOUT); 
```

myGetLastKnownLocationInstance 正在使用**getLastKnownLocation**。

我的问题：

从当前正在运行的 Activity 调用此代码时，myLocationListenerInstance 会在不到 TIMEOUT 秒内收到通知。

但是，当从后台服务调用时，我会超时，并且输出是通过最后一个已知位置。最糟糕的是，在调查测量的位置时，时间戳小于**TIMEOUT**！

即使将 TIMEOUT 设置为一分钟，我也会遇到这种行为。

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:16:02.617

如果我对您的理解正确，它在您的 Activity 运行时工作，但是一旦您的 Activity 关闭，并且您希望后台服务正在运行，您的代码就不会按计划在后台服务中工作。

你确定你的后台服务正在运行吗？

您可能需要使用 AlarmManager、start sticky、唤醒锁和/或 startForeground 来确保在您希望代码运行时服务正在运行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-28T20:30:57.263

> 我的问题：
> 
> 从当前正在运行的 Activity 调用此代码时，myLocationListenerInstance 会在不到 TIMEOUT 秒内收到通知。

根据[requestLocationUpdates (String provider, long minTime, float minDistance, LocationListener listener)](http://developer.android.com/reference/android/location/LocationManager.html#requestLocationUpdates(java.lang.String,%20long,%20float,%20android.location.LocationListener))，第二个参数允许您设置*位置更新之间的最小时间间隔，以毫秒为单位*。

从上面提到的 android API 文档中：

> 可以使用 minTime 参数控制位置更新间隔。位置更新之间的经过时间永远不会小于 minTime，尽管它可能更多取决于位置提供程序的实现和其他应用程序请求的更新间隔。

您可以设置`minTime`（`0`在您的情况下）`TIMEOUT`并完全放弃`Timer`，除非您的计时器在其他地方使用。

# ios - 如何通过拖动手指在两个视图之间执行翻转动画？

> ID：15821654
> 
> 赞同：4
> 
> 时间：2013-04-04T21:03:41.043
> 
> 标签：ios, animation, view

当用户从屏幕右侧拖动手指时，我想执行翻转动画。动画的状态应该受到拖动长度的影响，并且不应该自动工作。

我用过这样的东西：

```
if (transitionBegan) {

    flipTransition = CATransform3DIdentity;
    flipTransition.m34 = 1.0 / -500;
    flipTransition = CATransform3DRotate(flipTransition, degree * M_PI / 180.0f,0.0f, 1.0f, 0.0f);
    self.view.layer.transform = flipTransition;
} 
```

但是现在不知道怎么实现视图之间的转换，让视图A消失，视图B出现。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T22:29:31.387

You can write a gesture recognizer that does the `transform` for you. For example, assuming you're able to flip both left and right, you could do something like the following. But the idea is that you transform the current view if you're less than half way through the flip, and transform the next view if more than half way through it:

```
- (void)handlePan:(UIPanGestureRecognizer *)gesture
{
    static UIView *currentView;
    static UIView *previousView;
    static UIView *nextView;

    if (gesture.state == UIGestureRecognizerStateBegan)
    {
        // Set the three view variables here, based upon the logic of your app.
        // If there is no `previousView` or `nextView`, then set them to `nil`
        // as appropriate.

        // I happen to be choosing views for child view controllers for my 
        // custom container, but I'll spare you that in case you're not using
        // custom container controller.
    }

    // lets set the "percent" rotated as the percent across the screen the user's
    // finger has travelled

    CGPoint translation = [gesture translationInView:gesture.view.superview];
    CGFloat percent = translation.x / gesture.view.frame.size.width;
    CGFloat rotationPercent = percent;

    // let's use the var to keep track of which view will be rotated

    UIView *viewToTransform = nil; 

    if (percent < -0.5 && nextView)
    {
        // if user has moved finger more than half way across the screen to
        // the left, and there is a `nextView`, then we're showing the second
        // half of flip to the next screen

        currentView.hidden = YES;
        nextView.hidden = NO;
        previousView.hidden = YES;
        rotationPercent += 1.0;
        viewToTransform = nextView;
    }
    else if (percent > 0.5 && previousView)
    {
        // if user has moved finger more than half way across the screen to
        // the right, and there is a `previousView`, then we're showing the second
        // half of flip to the previous screen

        currentView.hidden = YES;
        nextView.hidden = YES;
        previousView.hidden = NO;
        rotationPercent -= 1.0;
        viewToTransform = previousView;
    }
    else if ((percent < 0 && nextView) || (percent > 0 && previousView))
    {
        // otherwise we're in the first half of the flip animation, so we're
        // showing the `currentView`

        currentView.hidden = NO;
        nextView.hidden = YES;
        previousView.hidden = YES;
        viewToTransform = currentView;
    }

    // do the flip `transform`

    CATransform3D transform = CATransform3DIdentity;
    transform.m34 = 1.0 / -800;
    viewToTransform.layer.transform = CATransform3DRotate(transform, M_PI * rotationPercent, 0.0, 1.0, 0.0);

    // if we're all done, let's animate the completion (or if we didn't move far enough,
    // the reversal) of the pan gesture

    if (gesture.state == UIGestureRecognizerStateEnded ||
        gesture.state == UIGestureRecognizerStateCancelled ||
        gesture.state == UIGestureRecognizerStateFailed)
    {
        // I'm personally using an index of my custom container child views, so I'm
        // just updating my index appropriately; your logic may obviously differ
        // here.

        if (percent < -0.5 && nextView)
            self.currentChildIndex++;
        else if (percent > 0.5 && previousView)
            self.currentChildIndex--;

        // and animate the completion of the flip animation

        [UIView animateWithDuration:0.25
                              delay:0.0
                            options:UIViewAnimationOptionCurveEaseInOut
                         animations:^{
                             previousView.transform = CGAffineTransformIdentity;
                             currentView.transform = CGAffineTransformIdentity;
                             nextView.transform = CGAffineTransformIdentity;
                         }
                         completion:NULL];
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T22:16:52.763

您应该能够在`UIPanGestureRecognizer`（正在监听手指拖动的手势识别器）的帮助下做到这一点，您将能够获得 Pan 的长度，并从那里计算您`CATransform3D`的 -based 平移和缩放跟随进度的平移。

（内置动画在那里没用，你必须在`CoreAnimation`这里使用，它很有趣，我可以告诉你;-)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:25:51.743

使用`UIView animateWithDuration: animations: completion:`方法将当前视图设置为动画到过渡点，然后在完成块中删除当前视图，添加新视图并在新视图上启动另一个类似的动画。

# javascript - 在 ie 8 中打印浮点图

> ID：15821657
> 
> 赞同：4
> 
> 时间：2013-04-04T21:03:54.890
> 
> 标签：javascript, jquery, html, flot

我目前正在使用[http://www.flotcharts.org/](http://www.flotcharts.org/)作为图形插件。我正在尝试实现从被内容包围的页面上打印浮动图的能力。我正在尝试打开一个新窗口并打印一个画布对象，这样我就可以只打印浮动图，我已经成功地做到了。但是，要做到这一点，我需要将画布制作成图像，以便可以在新窗口中打开它，因为我无法让 flot 在新窗口上工作。

```
canvas.toDataURL(); 
```

在 Internet Explorer 8 中，我收到没有方法 toDataURL() 的错误。我相信这是因为 Internet Explorer 8 不支持 canvas 标签，并且 flot 必须使用解决方法。那么如何在新浏览器和 Internet Explorer 8 中打印页面中的浮动图？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:08:29.800

当我尝试打印浮动图表时，我遇到了同样的问题。打开新窗口的另一种方法是将画布移动到页面顶部并隐藏其他所有内容，打印，然后将所有内容放回原处。这应该适用于现代浏览器以及 IE8。此外，这将使您的外部样式和库（jquery/flot）保持引用，因为它在同一页面上。

使用html结构：

```
<body>
    <div id="wrapper">
        <div id="some-element></div>
        <canvas id="my-canvas"></canvas>
        <button type="button" id="print-button">PRINT</button>
        <div id="some-other-element></div>
    </div>
</body> 
```

和javascript函数：

```
function printContent(whatToPrint, priorSibling, afterSibling) 
{

    $('#wrapper').hide();//hide content wrapper inside of body

    //take what to print out of wrapper and place directly inside body
    $(whatToPrint).appendTo('body');

    window.print();//print the window

    //put everything back
    $('#wrapper').show();

    if (priorSibling != null) 
    {
        $(whatToPrint).insertAfter(priorSibling);
    }
    else if (afterSibling != null)
    {
        $(whatToPrint).insertBefore(afterSibling);
    }

} 
```

和 javascript 打印按钮事件

```
$('#print-button').click(function(){

    printContent($('#my-canvas'), $('#some-element'), null);

}); 
```

注意：在不使用系统对话框打印的情况下以 chrome 打印，可能会弄乱您的样式。这只是铬。如果有人对此有解决方案，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T04:09:49.863

您可能还想尝试 Flashcanvas (flashcanvas.net) 而不是 Excanvas；它应该支持 toDataURL。

# asp.net - 在gridview中排序表达式多标题

> ID：15821661
> 
> 赞同：1
> 
> 时间：2013-04-04T21:04:01.657
> 
> 标签：asp.net, vb.net, gridview

我的网格视图中有 2 个标题。我在事件后面的代码中插入第二个标题，`RowCreated`该事件将插入到`<asp:BoundField>`行上方。我已经`SortExpression`为每个`BoundField`. 当我运行应用程序时，`SorExpression`将在每个`BoundField`未插入的标头上创建超链接（这在逻辑上是正确的）。但我想对插入的标题行进行排序表达式。我怎样才能做到这一点？

下面我正在解释我所做的步骤

ASPX

```
<asp:GridView ID="gvInitiavtives" runat="server" Width="100%" CssClass="Grid" 
       RowStyle-Width="30px" AutoGenerateColumns="false" HeaderStyle-CssClass="GridHeader" RowStyle-CssClass="GridItem" AlternatingRowStyle-CssClass="GridAltItem"  DataKeyNames="InitiativeIdx"  >
      <Columns>
      <asp:BoundField DataField="BusinessUnit" HeaderText="" HeaderStyle-Wrap="false" HeaderStyle-HorizontalAlign="NotSet" SortExpression='BusinessUnit' />
      <asp:BoundField DataField="IFunction" HeaderText="" HeaderStyle-Wrap="false" HeaderStyle-HorizontalAlign="NotSet" SortExpression='IFunction'/>
      <asp:BoundField DataField="SubFunction" HeaderText="" HeaderStyle-Wrap="false" HeaderStyle-HorizontalAlign="NotSet" SortExpression='SubFunction' />         
    ..... 
```

代码背后

```
 Private Sub gvInitiavtives_RowCreated(sender As Object, e As System.Web.UI.WebControls.GridViewRowEventArgs) Handles gvInitiavtives.RowCreated
        If e.Row.RowType = DataControlRowType.Header Then
            Dim HeaderGrid As GridView = DirectCast(sender, GridView)
            Dim HeaderGridRow As New GridViewRow(0, 0, DataControlRowType.Header, DataControlRowState.Insert)

            Dim HeaderCell As New TableHeaderCell()
            HeaderCell.Text = "BU"
            HeaderGridRow.Cells.Add(HeaderCell)

            HeaderCell = New TableHeaderCell()
            HeaderCell.Text = "Function"

            HeaderGridRow.Cells.Add(HeaderCell)

            HeaderCell = New TableHeaderCell()
            HeaderCell.Text = "Sub - Function"
            HeaderGridRow.Cells.Add(HeaderCell)
    ....
    .... 
       gvInitiavtives.Controls(0).Controls.AddAt(0, HeaderGridRow)

    End If
End Sub 
```

浏览器

![在此处输入图像描述](https://i.stack.imgur.com/JF2l3.png)

HTML

```
 <table class="Grid" cellspacing="0" rules="all" border="1" id="Body_gvInitiavtives" style="width:100%;border-collapse:collapse;">
            <tr class="GridHeader">
                <th>BU</th><th>Function</th><th>Sub - Function</th><th>Initiative Name</th><th>Location</th><th>Cost Center</th><th colspan="2">Estimated Cost Savings</th><th colspan="2">Estimated Personnel Savings</th>
            </tr>
<tr class="GridHeader">
            <th scope="col" style="white-space:nowrap;"><a href="javascript:__doPostBack(&#39;ctl00$Body$gvInitiavtives&#39;,&#39;Sort$BusinessUnit&#39;)"></a></th><th scope="col" style="white-space:nowrap;"><a href="javascript:__doPostBack(&#39;ctl00$Body$gvInitiavtives&#39;,&#39;Sort$IFunction&#39;)"></a></th><th scope="col" style="white-space:nowrap;"><a href="javascript:__doPostBack(&#39;ctl00$Body$gvInitiavtives&#39;,&#39;Sort$SubFunction&#39;)"></a></th><th scope="col">&nbsp;</th><th scope="col" style="white-space:nowrap;">&nbsp;</th><th scope="col" style="white-space:nowrap;">&nbsp;</th><th scope="col" style="white-space:nowrap;">Low</th><th scope="col" style="white-space:nowrap;">High</th><th scope="col" style="white-space:nowrap;">Low</th><th scope="col" style="white-space:nowrap;">High</th>
    </tr>
    <tr class="GridItem" style="width:30px;">
   <td>UNKNOWN</td><td>UNKNOWN</td><td>UNKNOWN</td><td> 
```

帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-06T07:08:00.203

You can add sort expression on header row each column, in which column you not need for sorting then make sort expression empty like

SortExpression="" - in which column you not want to apply sorting

# gcc - gnu-make 中的 -lrt 标志是什么？

> ID：15821663
> 
> 赞同：12
> 
> 时间：2013-04-04T21:04:08.667
> 
> 标签：gcc, gnu-make

在 gnu-make 过程的后期阶段，gmake 发送了一个类似于以下内容的命令：

```
gcc -static foo.so.0 bar.o bizz.o buzz.o -pthreads -lrt 
```

在该命令中，-lrt 是什么意思？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-04T21:30:05.487

那与制作无关；make 永远不会自己添加这样的标志。编写您的 makefile 的人将自己将该标志添加到链接行。那是一个编译命令，`-lrt`是一个传递给编译器的标志。该`-l`标志指定您应该与一个库链接，并且该库的名称紧随其后；所以`-lrt`它的意思是“与`rt`图书馆的链接”。这会导致链接器去寻找名为`librt.a`or的库`librt.so`（对于共享库）并将它们与输出文件链接。

# android - 从另一个活动中删除行

> ID：15821664
> 
> 赞同：2
> 
> 时间：2013-04-04T21:04:11.640
> 
> 标签：android, listview, android-arrayadapter, listadapter, notifydatasetchanged

我有一个由自定义数组适配器膨胀的列表视图，onclick 将其带到另一个活动，其中包含与该行相关的数据。单击删除后，它应该从列表中删除项目并返回列表。

我为此使用下面的代码：

```
int deleteposition=CustomizedListView.deleteposition;
CustomizedListView.list.removeViewAt(deleteposition);
CustomizedListView.adapter.notifyDataSetChanged();

finish(); 
```

**但是这一行有一个错误：**

```
 CustomizedListView.list.removeViewAt(deleteposition); 
```

请告诉我如何解决它？

日志猫详细信息：

```
java.lang.UnsupportedOperationException: removeViewAt(int) is not supported in AdapterView
at android.widget.AdapterView.removeViewAt(AdapterView.java:511)
    at com.example.androidhive.openedmsg$1.onClick(openedmsg.java:35)
    at android.view.View.performClick(View.java:3549)
    at android.view.View$PerformClick.run(View.java:14393)
    at android.os.Handler.handleCallback(Handler.java:605)
    at android.os.Handler.dispatchMessage(Handler.java:92)
    at android.os.Looper.loop(Looper.java:154)
    at android.app.ActivityThread.main(ActivityThread.java:4945)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
    at dalvik.system.NativeStart.main(Native Method) 
```

整个代码：

CustomizedListView.class

```
public class CustomizedListView extends Activity {
    // All static variables
    static final String URL = "https://itunes.apple.com/us/rss/topalbums/limit=20/json";
    // XML node keys
    static final String KEY_SONG = "song"; // parent node
    static final String KEY_ID = "id";
    static final String KEY_TITLE = "title";
    static final String KEY_ARTIST = "artist";
    static final String KEY_DURATION = "duration";
    static final String KEY_THUMB_URL = "thumb_url";

    static ListView list;
    static LazyAdapter adapter;

    HashMap<String, String> map;

    public static  String newactivityno;

    public static int deleteposition;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        ArrayList<HashMap<String, String>> songsList = new ArrayList<HashMap<String, String>>();

        JSONObject json = JSONfunctions.getJSONfromURL(URL);

        try {
            JSONObject arr2 = json.getJSONObject("feed");
            JSONArray arr = arr2.getJSONArray("entry");

            for (int i = 0; i < arr.length(); i++) {
                JSONObject e1 = arr.getJSONObject(i);

                JSONArray arr3 = e1.getJSONArray("im:image");

                JSONObject arr8 = e1.getJSONObject("im:name");

                JSONObject arr10 = e1.getJSONObject("im:artist");

                    JSONObject e12 = arr3.getJSONObject(0);

            // creating new HashMap
             map = new HashMap<String, String>();

            map.put(KEY_THUMB_URL,  e12.getString("label"));

            map.put(KEY_ARTIST, arr8.getString("label"));
            map.put(KEY_TITLE, arr10.getString("label"));
            // adding HashList to ArrayList
            songsList.add(map);
            }

        } catch (JSONException e) {
            // Log.e("log_tag", "Error parsing data "+e.toString());
            Toast.makeText(getBaseContext(),
                    "Network communication error!", 5).show();
        }

        list=(ListView)findViewById(R.id.list);

        // Getting adapter by passing xml data ArrayList
        adapter=new LazyAdapter(this, songsList);        
        list.setAdapter(adapter);

        // Click event for single list row
        list.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> parent, View view,
                     int position, long id) {

                                @SuppressWarnings("unchecked")
                                HashMap<String, String> o= (HashMap<String, String>) list.getItemAtPosition(position);

                           //   Toast.makeText(CustomizedListView.this, "ID '" + o.get("title") + "' was clicked.", Toast.LENGTH_SHORT).show(); 

                                deleteposition=position;
                             newactivityno= o.get("title");
                             Intent ii= new Intent(getBaseContext(),newactivity.class); 
                                startActivity(ii);

            }
        });     
    }   
} 
```

新活动类

```
public class newactivity extends Activity{

     @Override
        public void onCreate(Bundle savedInstanceState) {
            super.onCreate(savedInstanceState);
            setContentView(R.layout.newlayout);

            TextView tv1=(TextView)findViewById(R.id.textView11);
            TextView tv2=(TextView)findViewById(R.id.textView12);

            Button bn=(Button)findViewById(R.id.button1);

            tv2.setText(CustomizedListView.newactivityno);

            bn.setOnClickListener(new OnClickListener() {

                @Override
                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    int deleteposition=CustomizedListView.deleteposition;
                    CustomizedListView.list.removeViewAt(deleteposition);
                    CustomizedListView.adapter.notifyDataSetChanged();

                    finish();

                }
            });
}

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:06:52.960

您以错误的方式处理此问题。无需从 AdapterView 中删除视图，只需从数据集中删除数据并调用`notifyDataSetChanged()`. （这将自动删除不需要的视图。）

# delphi - Delphi 窗口在自定义拖动后失去焦点

> ID：15821670
> 
> 赞同：2
> 
> 时间：2013-04-04T21:04:28.687
> 
> 标签：delphi, drag-and-drop

我有这段代码可以在我拖动时移动我的主窗口`MyThingThatDragsIt`

```
procedure TMainForm.ApplicationMessage(var Msg: TMsg; var Handled: Boolean);
var
  ScreenPt : TPoint;
  DragControl : TControl;

begin
  inherited;
  if Msg.message = WM_LBUTTONDOWN then
  begin

    ScreenPt := ScreenToClient(Msg.pt);
    DragControl := FindDragTarget(Msg.pt , false);
    if Assigned(DragControl) and
      ((DragControl = MyThingThatDragsIt)
      ) then
    begin
      ReleaseCapture;
      self.Perform(WM_SYSCOMMAND, SC_MOVE or $0002, 0 );
    end;
  end
end; 
```

这工作正常，但是当我放手时，我的程序失去了焦点，我必须在表单上单击一次才能单击任何其他按钮。

知道这里有什么问题吗？我按照[这个问题的步骤](https://stackoverflow.com/questions/3976610/moving-a-caption-less-window-by-using-a-drag-area)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:37:41.293

告诉 VCL 你已经处理了这个消息：

```
 ...
  Perform(WM_SYSCOMMAND, SC_MOVE or $0002, 0 );
  Handled := True;
  ... 
```

# ios - FB.login() phonegap facebook 插件中的错误

> ID：15821672
> 
> 赞同：2
> 
> 时间：2013-04-04T21:04:29.437
> 
> 标签：ios, facebook, cordova, sencha-touch, facebook-javascript-sdk

当我使用 Settings/facebook 中设置的帐户在 ios 6 设备中运行 fb.login() 时，我得到以下信息

```
operation couldn't be completed (com.facebook.sdk error 2) 
```

在 ios 5 中，该应用程序运行良好，问题是本机登录

请帮忙 ！这是我的代码

这是脸书初始化

```
 this.appId = appId;
    var me = this;

    document.addEventListener('deviceready', function() {
                                  try {

                                  FB.init({ appId: "294003447379425", status: true, cookie: true, nativeInterface: CDV.FB, useCachedDialogs: false });

                                  } catch (e) {
                                  console.log(e);
                                  }
                                  }, false);

    if (!this.appId) {
        Ext.Logger.error('No Facebook Application ID set.');
        return;
    }

    var me = this;
    me.hasCheckedStatus = false;

    FB.Event.subscribe('auth.logout', function() {
        // This event can be fired as soon as the page loads which may cause undesired behaviour, so we wait
        // until after we've specifically checked the login status.
        if (me.hasCheckedStatus) {
            me.fireEvent('logout');
        }
    });

    // Get the user login status from Facebook.
    FB.getLoginStatus(function(response) {

        me.fireEvent('loginStatus');

        clearTimeout(me.fbLoginTimeout);
        me.hasCheckedStatus = true;

        if (response.status == 'connected') {
            me.fireEvent('connected');

        Ext.Viewport.add(Ext.create('CinePass.view.Main'));

        } else {
            me.fireEvent('unauthorized');
            console.log('noconectado');

            Ext.Viewport.add(Ext.create('CinePass.view.LoggedOut'));
        }
    });

    // We set a timeout in case there is no response from the Facebook `init` method. This often happens if the
    // Facebook application is incorrectly configured (for example if the browser URL does not match the one
    // configured on the Facebook app.)
    me.fbLoginTimeout = setTimeout(function() {
        me.fireEvent('loginStatus');
        me.fireEvent('exception', {
            type: 'timeout',
            msg: 'The request to Facebook timed out.'
        });
        Ext.Msg.alert('CinePass', 'Existe un problema con Facebook, se iniciará la aplicación sin conexión a Facebook.', Ext.emptyFn);
         Ext.Viewport.add(Ext.create('CinePass.view.Main'));
    }, me.fbTimeout); 
```

这是登录

```
 FB.login(
                     function(response) {
                     if (response.session) {
                      alert(response.session);

                     } else {
                  alert(response.session);
                     }
                     },
                     { scope: "email,user_about_me,user_activities,user_birthday,user_hometown,user_interests,user_likes,user_location,friends_interests" }
                     ); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T10:36:38.733

遇到同样的问题，我花了几天时间才弄清楚，原因有很多：

1）第一次启动应用，如果拒绝“你允许这个应用使用你的facebook权限”，你会得到这个错误，你需要做的是，去设置>通用> Facebook>转在您的应用程序上或转到设置 > 常规 > 重置 > 重置位置和隐私（这将重置并再次询问您“您是否允许此应用程序使用您的 Facebook 权限”以用于所有应用程序。

2）慢速/没有互联网会导致错误

3）再次创建您的证书，然后转到 build.phonegap.com，为 IOS 创建一个新密钥并更改 IOS 密钥（这对我有用，我不知道它是如何工作的，但确实如此，我注意到一个重要的应用程序文件我使用新的 IOS 密钥后大小增加）

4) 如果您的应用程序处于沙盒模式，并且您的 IOS 当前 Facebook 帐户不是应用程序测试员，您也会收到错误消息。我只是禁用沙盒模式并且它可以工作，确保您的 Facebook 应用设置具有正确的捆绑 ID，如果您的应用仍在开发中，请将 0 放入应用商店 ID。

# jquery - 计算每个鼠标滚轮滚动并输出到变量

> ID：15821676
> 
> 赞同：3
> 
> 时间：2013-04-04T21:04:34.943
> 
> 标签：jquery, scroll, blur

我正在尝试将此 jQuery [MouseWheel](https://github.com/brandonaaron/jquery-mousewheel)插件与此[Canvas Image Blur](http://www.quasimondo.com/StackBlurForCanvas/StackBlurDemo.html)插件一起使用，以便使用鼠标滚轮使全屏图像模糊或重新聚焦（无需实际滚动页面）。

我已经玩了几个小时了，但我的运气为零。我目前的代码是：

```
$(document).mousewheel(function(event, delta) {
                        var o = 70;
                        if (delta > 0)
                            o = o+1;
                        else if (delta < 0)
                            o = o-1;

                        if( o != '' )
                            log( o );
                        return false; // prevent default
                    });

                function log(blurRadius) {
                    stackBlurImage( 'photosrc', 'canvas', blurRadius, false );
                }; 
```

我希望图像以设置为 70 的模糊开始。但是此代码目前仅根据滚动将其更改为 69 或 71，因为它仅检查滚动是向上还是向下。我想要它做的是将每个单独的滚动输出到变量 - 类似于滑块上方的画布图像模糊示例中如何动态调整模糊。

如果有人能指出我正确的方向，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:10:42.990

您只需将变量声明 ( `var o = 70`) 移到函数外部。

如果在鼠标滚轮的事件处理程序中声明了变量，则每次事件发生时都会重置它。如果您改为在外部声明它，它将在页面加载后声明，然后在每个事件上更改为 +1 或 -1。

您也可以更改`o = o + 1;`为`o++;`以使您的代码更简单。

实例：http: [//jsfiddle.net/mKtvQ/2/](http://jsfiddle.net/mKtvQ/2/)

*（注意：我没有包含模糊代码，因为您没有包含在 OP 中。）*

# sql-server-2008 - 如何批量插入每天更改名称的文件？

> ID：15821683
> 
> 赞同：1
> 
> 时间：2013-04-04T21:05:06.533
> 
> 标签：sql-server-2008, bulkinsert

我有一个静态文件夹，其中有一个每日 txt 文件进入该文件夹。文件名是日期。如果文件名每天都具有相同的名称，则一切正常。有没有办法让我的脚本拉出文件夹中的任何 txt 文件？（注意，文件进来，得到处理，然后我有一个自动传输，在文件被插入到处理的文件夹后移动文件）。所以文件夹中一次只有一个文件。我希望这是有道理的。

这是批量插入的脚本：

```
Bulk Insert Mydata.dbo.cust_adj 
From 'C:\MyData\FlatFiles\UnprocessedAdjReport\importformat.txt' 
With 
(
FieldTerminator= '|', 
Rowterminator= '\n' 
) 
Go 
```

（顺便说一句，我已将此保存为存储过程）

所以“importformat”只是我在设置脚本时使用的名称，以后它将在 中`bb-yyyy-mmdd-hhmmnnnn.txt`，一旦插入文件，我将文件从未处理的文件夹移动到已处理的文件夹。每天只有一个文件。

如果有人对此有任何建议或帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T15:35:55.440

查看链接，它可能是您正在寻找的内容：

[http://www.kodyaz.com/articles/how-to-extract-filename-from-path-using-sql-functions.aspx](http://www.kodyaz.com/articles/how-to-extract-filename-from-path-using-sql-functions.aspx)

或者

[http://sqljourney.wordpress.com/2010/06/08/get-list-of-files-from-a-windows-directory-to-sql-server/](http://sqljourney.wordpress.com/2010/06/08/get-list-of-files-from-a-windows-directory-to-sql-server/)

或者可能

[http://www.codeproject.com/Articles/38850/An-Easy-Way-to-Get-a-File-Name-or-a-File-Extension](http://www.codeproject.com/Articles/38850/An-Easy-Way-to-Get-a-File-Name-or-a-File-Extension)

高温高压

# java - 如何在 pom 中设置不编译测试？

> ID：15821684
> 
> 赞同：8
> 
> 时间：2013-04-04T21:05:12.647
> 
> 标签：java, maven, testing, pom.xml

如何在 pom 中设置不在 Maven 中编译测试？我试过了：

```
<properties>
  <skipTests>true</skipTests>
</properties> 
```

但在这种情况下，Maven 编译测试但不运行它们。我需要 Maven 不要编译我的测试。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T21:16:47.627

您必须将 maven.test.skip 定义为 true。

```
<properties>
    <maven.test.skip>true</maven.test.skip>
</properties> 
```

[http://maven.apache.org/surefire/maven-surefire-plugin/examples/skipping-test.html](http://maven.apache.org/surefire/maven-surefire-plugin/examples/skipping-test.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:08:48.337

如果您正在使用`surefire-plugin`执行测试，您可以将其配置为根据命名模式跳过它们：

```
<project>
  [...]
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <version>2.14</version>
        <configuration>
          <includes>
            <include>%regex[.*[Cat|Dog].*Test.*]</include>
          </includes>
        </configuration>
      </plugin>
    </plugins>
  </build>
  [...]
</project> 
```

但是，这要求测试文件名符合所需的模式。在工作中，我们正在使用这种方法，并让我们的测试以`..UnitTest`or结尾`..IntegrationTest`，这样我们就可以通过修改相应构建配置文件中的正则表达式来轻松关闭它们中的每一个。

看看[Apache](http://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html)关于surefire 插件的文档。您可能会发现一些更有用或更适合您的情况的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:18:38.207

配置 maven-compiler-plugin 以跳过编译。再一次，我不推荐它。

```
<project>
  <properties>
    <maven.test.skip>true</maven.test.skip>
  </properties>
  [...]
  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>3.0</version>
        <configuration>
        <executions>
          <execution>
            <id>default-testCompile</id>
            <phase>test-compile</phase>
            <goals>
              <goal>testCompile</goal>
            </goals>
            <configuration>
              <skip>${maven.test.skip}</skip>
            </configuration>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
  [...]
</project> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-07-04T20:39:49.257

在我的情况下，一个解决方案是将测试放在配置文件中（例如 runTests），所以当我想运行这些测试时，我添加了参数`-PrunTests`. 感谢您的回复。

# vba - 438 运行时错误

> ID：15821686
> 
> 赞同：1
> 
> 时间：2013-04-04T21:05:28.487
> 
> 标签：vba, excel, runtime-error

我正在尝试这样做，以便当我的代码中的一个特定单元格发生更改时，它将显示一条消息，但我收到以下错误消息“运行时错误 438 对象不支持此属性或方法”。不太确定这意味着什么。有人可以帮我理解。这是代码：

```
 Private Sub Worksheet_Change(ByVal Target As Range)

 If Target.Adress = "F48,I48,L48,F50,I50,L50,I52,L52,N52" Then
     MsgBox "You are about to change an AP-42 Emision Factor"

 End If
 End Sub 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:17:11.203

**1，**如评论中所述，使用`Target.Address`正确的属性名称。

**第二，**你的`if`陈述永远不会返回真实。`Target.Address`将始终返回类似这样的内容：`$E$2`， `$E$3:$E$4`，等等...在您的情况下，您应该使用类似`Intersect`or`Union`方法。

使用`Union`方法编辑-可能的解决方案：

```
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim rngTMP As Range
    Set rngTMP = Range("F48,I48,L48,F50,I50,L50,I52,L52,N52")

If Union(Target, rngTMP).Address = Union(rngTMP, rngTMP).Address Then
        MsgBox "Ok"
End If
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T22:12:01.877

这是你正在尝试的吗？

```
Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Range("F48,I48,L48,F50,I50,L50,I52,L52,N52")) Is Nothing Then
        MsgBox "You are about to change an AP-42 Emision Factor"
    End If
End Sub 
```

**值得一读**：[vba 代码运行时 MS Excel 崩溃](https://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-05T14:47:13.023

悉达多的代码创造了奇迹，非常感谢。我遇到了麻烦，因为我试图通过以下方式编写代码来制作两个 Worksheet_Change 事件：

```
Private Sub Worksheet_Change(ByVal Target As Range)

If Target.Address = "$D$8" Then
    Toggle_Rows
End If
End Sub

Private Sub Worksheet_Change(Byval Target As Range)
    If Not Intersect(Target, Range("F48,I48,L48,F50,I50,L50,I52,L52,N52")) Is Nothing Then
        MsgBox "You are about to change an AP-42 Emision Factor"
    End If
End Sub 
```

正如您可以想象的那样，这不起作用，给了我一个模棱两可的名称错误。因此，经过一番研究，以下是将这两个函数写成一个的方式：

```
Private Sub Worksheet_Change(ByVal Target As Range)

If Target.Address = "$D$8" Then
    Toggle_Rows
End If

    If Not Intersect(Target, Range("F48,I48,L48,F50,I50,L50,I52,L52,N52")) Is Nothing Then
        MsgBox "You are about to change an AP-42 Emision Factor"
    End If
End Sub 
```

谢谢各位的帮助！

# c# - WCF - 接收对 http://xxxxx/Service/ 的 HTTP 响应时出错

> ID：15821687
> 
> 赞同：8
> 
> 时间：2013-04-04T21:05:30.417
> 
> 标签：c#, wcf, entity-framework, ef-code-first

我正在我的 WCF 服务中进行此调用：

```
public User GetStudentRecord(string userName)
    {
        try
        {
            return new DashboardFacade().GetStudentRecord(userName);
        }
        catch (Exception ex)
        {
            ServiceFault fault = new ServiceFault();
            fault.Operation = "GetStudentRecord";
            fault.Reason = "Who knows...";
            fault.Message = ex.Message;
            throw new FaultException<ServiceFault>(fault, fault.Message, new FaultCode(fault.Reason), fault.Operation);
        }
    } 
```

DashboardFacade().GetStudentRecord(..) 定义如下：

```
public User GetStudentRecord(string userName)
{
    User user = ctx.Users.Where(x => x.ADUserName == userName).SingleOrDefault();
    return user;
} 
```

ctx 是我的 DbContext。我首先使用实体​​框架代码。用户对象如下所示：

```
public class User
{
    public User()
    {
        //UserDetails = new UserDetail();
    }
    [Key]
    public Guid MasterKey { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public string Email { get; set; }
    public string ADUserName { get; set; }
    public string UserType { get; set; }
    public virtual UserDetail UserDetails { get; set; }
    public Nullable<DateTime> LastModifiedDate { get; set; }
} 
```

最后，您可能需要查看 WCF 应用程序上的 web.config：

```
<?xml version="1.0"?>
    <configuration>
      <connectionStrings>
        <add name="NotMyDBContextDB" connectionString="[omitted]" providerName="System.Data.SqlClient"/>
        <add name="ApplicationContext" connectionString="Data Source=.;Initial Catalog=MyApp;Integrated Security=True;Pooling=False" providerName="System.Data.SqlClient"/>
      </connectionStrings>
   <system.web>
     <compilation debug="true" targetFramework="4.0"/>
   </system.web>
   <system.serviceModel>
     <behaviors>
       <serviceBehaviors>
          <behavior>
             <serviceMetadata httpGetEnabled="true"/>
             <serviceDebug includeExceptionDetailInFaults="true"/>
          </behavior>
        </serviceBehaviors>
      </behaviors>
      <serviceHostingEnvironment multipleSiteBindingsEnabled="true"/>
  </system.serviceModel>
<system.webServer>
<modules runAllManagedModulesForAllRequests="true"/>
<directoryBrowse enabled="true"/>
</system.webServer>
</configuration> 
```

谁能指出我在这里出错的地方？

这是我得到的确切错误：

```
An error occurred while receiving the HTTP response to http://localhost:5843/MyService.svc. This could be due to the service endpoint binding not using the HTTP protocol. This could also be due to an HTTP request context being aborted by the server (possibly due to the service shutting down). See server logs for more details.

Inner Exception:
The underlying connection was closed: An unexpected error occurred on a receive.

Inner Exception:
Unable to read data from the transport connection: An existing connection was forcibly closed by the remote host.

Inner Exception:
An existing connection was forcibly closed by the remote host 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-04T22:21:27.203

经过大量的咒骂和思考外面的天气有多好，找到了根本原因。我从 User 对象内的 UserDetails 对象中删除了 virtual 关键字。

现在它起作用了！

至于为什么这会导致问题，我的假设是序列化或 DbContext 问题，但我将不得不更多地研究它，不确定。

我现在要去外面。

因此，作为参考，如果您在这里结束并且不知道发生了什么，那么您应该查看的所有其他内容（大小、超时等）：

```
Check to see if your object has virtual keyword on it. 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-05-08T17:54:07.843

我遇到了这个问题，就我而言，问题是 WCF 服务正在返回一个类，该类的属性只有一个 getter 而没有 setter。我试图阻止接收者修改该属性。要解决此问题，请参阅此...

[WCF 服务和对象构造函数](https://stackoverflow.com/questions/15571902/wcf-services-and-object-constructors)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-17T19:08:42.927

我有同样的错误。

在我的情况下，我有一个带有名为 OEM 的 int 列的表。在模型层中，我有一个类（DTO），该列由枚举表示。表中有一行 OEM 列中的值无效。当我尝试使用 LINQ 获取所有数据时，出现了 VisualStudio 未捕获的错误。当 WCF 尝试检索消息时引发该错误。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-06-12T14:55:04.017

我有同样的例外，但上面的答案都没有给我一个解决方案。我通过在 web.config 中定义跟踪找出了错误：

```
<system.diagnostics>
<sources>
  <source propagateActivity="true" name="System.ServiceModel" switchValue="Information, ActivityTracing">
    <listeners>
      <add type="System.Diagnostics.DefaultTraceListener" name="Default">
        <filter type="" />
      </add>
      <add initializeData="C:/temp/tracelog.svclog" type="System.Diagnostics.XmlWriterTraceListener" name="traceListener">
        <filter type="" />
      </add>
    </listeners>
  </source>
</sources>
</system.diagnostics> 
```

我在本地运行网站，触发了一些失败的调用，然后打开了选择失败条目的跟踪日志，在该条目中我看到了这个异常：

**无法在 LINQ to Entities 查询中构造实体或复杂类型“Person”。**

在查询之外构建人员解决了这个问题，而不是：

```
 var persons = (from p in db.Persons
                  select new Person
                  {
                      Id = p.Id,
                      Name = p.Name,
                      LastName = p.LastName,
                      Email = p.Email
                  }
              ).AsEnumerable();

  return persons; 
```

我必须做 ：

```
var persons = (from p in db.Persons
                  select new 
                  {
                      Id = p.Id,
                      Name = p.Name,
                      LastName = p.LastName,
                      Email = p.Email
                  }
              ).AsEnumerable()
                //construct the complex type outside of DB  (to prevent the exception that model cannot be constructed in linq to entities)
                .Select(item =>

                    new Person
                    {
                        Id = item.Id,
                        Name = item.Name,
                        LastName = item.LastName,
                        Email = item.Email
                    }).ToList(); 

            return persons; 
```

如果异常消息更全面，我可以节省很多时间，从本主题中概述的所有不同原因来看，我想人们会同意我的观点。

无论如何，这就是我解决问题的方式，希望这对其他人有帮助

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-18T10:08:21.410

这些方法都不适合我。我所做的是在从 WCF 测试客户端运行时调试服务，我能够找到我的问题。这与服务库缺少 app.config 中的连接字符串有关。

如果有人尝试了所有其他方法但仍然无法找到问题，请发布。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-11-10T09:01:13.210

也许您需要禁用延迟加载和代理创建，如下所示：

```
 db.LazyLoadingEnabled = false;
  db.ProxyCreationEnabled = false; 
```

这样做你的 wcf 服务应该可以工作。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-08-17T15:32:17.943

Webservice 的情况更糟。

我返回了一个带有**Enum 属性**的简单 POCO 对象。

属性中返回的**数值**不在**Enum values**的集合中，因此，我得到了那个误导性错误。

这不是我第一次遇到与 .NET 中的 Enum 值相关的问题......

所以简而言之，请确保您在 WebService 中的响应不会这样做：

```
enum exampleEnum
    {
        A = 1
    }

    class webService
    {
        public object foo() // Suppose WebService method
        {
            // Bad, make sure the Enum value is in the list defined!
            return new { age = 12, A = (exampleEnum)2 };
        }
    } 
```

# django - Django：如何从视图中引用模型的对象

> ID：15821692
> 
> 赞同：0
> 
> 时间：2013-04-04T21:05:35.913
> 
> 标签：django, django-models, django-views

我有一个销售珠宝的 django 电子商务网站。我有一个`Product`模型，带有一个`show_product`由`product.html`模板显示的关联视图。

我现在想为我的珠宝提供可定制的魅力。为此，我创建了一个`Charm`模型，它定义了魅力的名称、图像、SKU 等。我还修改了我的`Product`模型以包含一个`allows_charms`布尔值，因为每个魅力都可用于任何首先允许魅力的产品。换句话说，我不必担心关系映射，因为只要产品允许魅力，它就允许所有魅力。

我的问题出现在`show_product`视图中。如何设置一个`charms`包含所有`Charm`模型对象的变量，然后我可以在模板中引用它，代码如下：

```
{% for ch in charms %}
<div class="charm_thumb">
     <img src="{{ MEDIA_URL }}images/charms/{{ ch.image }}" alt="{{ ch.name }}" />
     <p id="charm_name">{{ ch.name }}</p>
     <p id="charm_price">${{ ch.price }}</p>
</div>
{% endfor %} 
```

如果我从产品模型对象的 M2M 关系中获取相关魅力列表，我会知道如何执行此操作，但我不知道如何获取给定模型中的每个对象？

为了明确我的最终目标，我希望这样的非功能代码能够工作：

```
from mystore import Charms
charms = Charms.all() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:07:58.577

`Model.objects.all()`返回给定模型的所有对象，例如`Charm.objects.all()`.

*   [检索所有对象](https://docs.djangoproject.com/en/dev/topics/db/queries/#retrieving-all-objects)（数据库查询指南）
*   [全部方法](https://docs.djangoproject.com/en/dev/ref/models/querysets/#all)
*   [查询集 API 参考](https://docs.djangoproject.com/en/dev/ref/models/querysets/#)

# include - 如何将 html 或模板文件包含到 .html 文件中？

> ID：15821693
> 
> 赞同：2
> 
> 时间：2013-04-04T21:05:40.080
> 
> 标签：include

有可能吗，或者我怎么能做到这一点，我可以将我的 topbar 文件包含到我的页面中，我不希望它与 php 一起使用，因为我还没有与 localhost 挂钩。

提前感谢所有帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-07-22T01:14:53.260

HTML5 现在允许您包含 html 文件，就像您已经可以通过导入包含 css 文件一样。但是，这只会在您的开发阶段有所帮助，而不是最终的生产版本，因为该功能目前仅在 Chrome 中可用，其他浏览器需要时间才能采用：[http ://www.html5rocks.com/en /教程/webcomponents/imports/](http://www.html5rocks.com/en/tutorials/webcomponents/imports/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:12:46.733

如果您不想使用 PHP 或任何其他服务器端脚本语言，您可以使用已弃用的标签，或者使用动态嵌入 HTML 页面的 Javascript 执行 AJAX 请求`<iframe>`。`<frameset>`由于现代浏览器中的 XSS 保护，仅当您尝试附加的页面位于同一域中时，第二种方法才有效。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-04T21:17:04.593

可以这么说，它更像是服务器，因此您将不得不更多地依赖服务器。因为，您不能简单地使用静态脚本（如 HTML）来执行此操作。没有“内置函数”可以做到这一点，这不是 HTML 的东西。

我的意思是，服务器将为您提供多个选项，例如：

你可以：

1.  如果服务器支持，请使用 SSI（[服务器端包含）。](http://en.wikipedia.org/wiki/Server_Side_Includes)

2.  使用 PHP 或 ASP 包含。

3.  否则，您可以为此使用[AJAX](http://docs.jquery.com/Ajax/load)，不会像上述选项那样花费您。

如果您通过说“topbar”来表示“标题”，我认为使用 iframe 不是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T21:15:09.517

据我所知，真正是 HTML 解析文件的文件不能包含另一个文件。

如果您的 Web 服务器将解析 php，您只需将主文件的扩展名更改为 .php 并 include() 顶部栏文件：

mv index.html index.php index.php：

include_once("topbar.html");

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-08-19T10:21:07.143

`<!--#include file="footer_text.html" -->` 在 html 页面内使用。请检查以下网址了解详情。 [https://www.lifewire.com/include-html-file-in-another-3469529](https://www.lifewire.com/include-html-file-in-another-3469529)

# objective-c - UITableView 和数据源

> ID：15821696
> 
> 赞同：0
> 
> 时间：2013-04-04T21:05:49.553
> 
> 标签：objective-c

我正在尝试在 UITableView 中添加数据源。我尝试了以下方法，但不幸的是它没有用：

```
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView {
    return 8;
}

// Customize the appearance of table view cells.
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Set the data for this cell:

    cell.textLabel.text = [_classCellview objectAtIndex:indexPath.row];
    cell.detailTextLabel.text = @"One";
     cell.detailTextLabel.text = @"Two";

    // set the accessory view:
    cell.accessoryType =  UITableViewCellAccessoryDisclosureIndicator;

    return cell;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:16:21.513

> `cell.textLabel.text = [_classCellview objectAtIndex:indexPath.row];`

您告诉表格有 8 个部分，但是`section`当您填充单元格时，您没有将索引路径考虑在内。索引路径（在表格视图的情况下）有两个值： a`section`和 a `row`。您需要他们都知道您正在处理的单元格。因此，您可能会在表格的每个部分中重复相同的内容。（不过，如果您确切地告诉我们问题出在哪里，那会有所帮助。）

# php - Cake 无法连接到数据库。XAMPP

> ID：15821702
> 
> 赞同：0
> 
> 时间：2013-04-04T21:06:18.977
> 
> 标签：php, mysql, cakephp

我正在 XAMPP 1.8.1 上开发并遇到 CakePHP 无法连接到数据库的问题。我环顾四周，其他人建议确保 pdo 已启用，并且确实如此。我知道我的数据库设置是正确的。我已经检查并重新检查了它们，但我仍然得到：

```
Cake is NOT able to connect to the database.
Database connection "Mysql" is missing, or could not be created. 
```

我之前已经多次设置 CakePHP，即使使用 XAMPP，我也从未遇到过这个问题。

我的数据库设置如下：

```
public $default = array(
    'datasource' => 'Database/MySQL',
    'persistent' => false,
    'host' => 'localhost',
    'login' => 'cakeuser',
    'password' => '*****',
    'database' => 'cake',
    'prefix' => '',
    //'encoding' => 'utf8',
); 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T12:39:10.053

检查你的 phpinfo() 的输出。是否有标题为 PDO 驱动程序的行？它说什么？

# tinymce - tinymce - 如何同时保存富文本和纯文本版本

> ID：15821709
> 
> 赞同：4
> 
> 时间：2013-04-04T21:06:26.570
> 
> 标签：tinymce, rte

我想让用户用tinymce制作富文本并将其保存在数据库中，但我也想保存纯文本版本。

tinymce 是否提供这样的选项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-09T12:35:29.547

不，tinymce 旨在创建 HTML/富文本。但是您可以自由地对 tinymce 编辑器的纯文本内容进行分级并自己保存。

你去：

```
var plain_text = $(ed.getBody()).text(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-08T08:11:57.617

您可以使用以下代码获取纯文本：

```
var plainText = tinyMCE.activeEditor.getBody().textContent; 
```

您还可以使用以下内容获取 html 文本：

```
var richText = tinyMCE.getInstanceById('textAreaID').getContent(); 
```

# cakephp - CakePHP 将语言参数添加到 URL

> ID：15821710
> 
> 赞同：0
> 
> 时间：2013-04-04T21:06:28.667
> 
> 标签：cakephp, internationalization, url-routing, cakephp-2.3

我[在本文中](http://nuts-and-bolts-of-cakephp.com/2008/11/28/cakephp-url-based-language-switching-for-i18n-and-l10n-internationalization-and-localization/)实施了解决方案。

" `beforeFilter`" 和 " `_setLanguage`" 工作正常。如果 URL 有语言参数，我可以成功设置 cookie/会话变量。并在控制器之间使用它。

该解决方案还包括`url()`向`AppHelper`.

```
class AppHelper extends Helper {
   function url($url = null, $full = false) {
        if(!isset($url['language']) && isset($this->params['language'])) {
          $url['language'] = $this->params['language'];
        }
        return parent::url($url, $full);
   }
} 
```

但是我的视图文件中有许多 URL 是在不使用`HtmlHelper`. 像这样：

```
// myfile.ctp
<a href="/mypage/">click me plase<a> 
```

所以看起来 AppHelper::url 解决方案不能解决我的问题。将语言前缀添加到 URL 有什么更好的选择？

我想像这样定义一个全局变量：

```
// AppController::_beforeFilter()
if ($this->request->params['language'] != "")
{
   Configure::write('URLprefix', '/'.$this->request->params['language']);
} else {
   Configure::write('URLprefix', '');
} 
```

然后像这样更改视图文件：

```
// myfile.ctp
<a href="<?php echo URLprefix; ?>/mypage/">click me plase<a> 
```

但这似乎不是一个好方法。有没有更好的方法来为 URL 添加前缀。还是我应该手动添加到所有链接？

相关：在 CakePHP [CakePHP 2.x i18n 路由](https://stackoverflow.com/questions/14427391/cakephp-2-x-i18n-route)[CakePHP 2.1 URL 语言参数](https://stackoverflow.com/questions/10132465/cakephp-2-1-url-language-parameter)
[中为每个 URL 添加前缀](https://stackoverflow.com/questions/1794412/adding-a-prefix-to-every-url-in-cakephp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:25:24.723

您应该使用[`HtmlHelper::link()`](http://book.cakephp.org/2.0/en/core-libraries/helpers/html.html#HtmlHelper%3a%3alink)和生成应用程序中的所有链接和 URL[`HtmlHelper::url()`](http://book.cakephp.org/2.0/en/core-libraries/helpers/html.html#HtmlHelper%3a%3aurl)

这将确保在生成 URL 时考虑您的路由（*反向路由*）

例如，如果您决定为 定义一个“友好”的 URL 路由`/logout`，`/users/logout`那么：

```
echo $this->Html->link('Log out', array(
    'controller' => 'users', 
    'action' => 'logout'
)); 
```

将创建此链接：

```
<a href='/logout'>Log out</a> 
```

如果您稍后决定修改`/sign-out`注销 URL 的“友好”URL 路由 ( )，则应用程序中的所有链接都将自动调整。

对 HtmlHelper的**相同**调用现在将输出：

```
<a href='/sign-out'>Log out</a> 
```

在此处阅读有关此主题的更多信息：

[反向路由](http://book.cakephp.org/2.0/en/development/routing.html#reverse-routing)

# heroku - 如何 pg_restore 从 heroku 生成的转储文件到我的本地 postgres 8 数据库？

> ID：15821715
> 
> 赞同：2
> 
> 时间：2013-04-04T21:06:47.313
> 
> 标签：heroku, postgresql-9.0, pg-restore

我使用以下命令将我最新的备份文件从 heroku 下载到本地驱动器：

```
$ heroku pgbackups:capture
$ curl -o latest.dump `heroku pgbackups:url` 
```

然后我尝试恢复：

```
$ pg_restore --verbose --clean --no-acl --no-owner -h localhost -U myuser -d mydb latest.dump 
```

我收到了这个错误信息：

```
pg_restore: [archiver] unsupported version (1.12) in file header 
```

经过一番谷歌搜索，我发现问题是版本不匹配。Heroku postgres 版本是 9.0.13，但我的本地开发数据库是 8.0 版本。

我有点犹豫将我的本地版本升级到 9.0，因为我之前在安装 postgres 时遇到了问题。有没有更简单的方法从heroku下载数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T13:20:06.037

我知道你不想这样做，但我认为你真正应该做的是升级你的本地 postgres。特别是如果您进行任何本地开发。你真的想要两个环境之间的平等。在某些平台上安装 Postgres 有更简单的方法 - 例如OS X 上的[Postgres.app 。](http://postgresapp.com/)

# google-app-engine - 如何编辑 jdoconfig.xml 和 persistence.xml 以便 JPA 保存到 appengine 数据存储区

> ID：15821716
> 
> 赞同：2
> 
> 时间：2013-04-04T21:06:49.517
> 
> 标签：google-app-engine, jpa-2.0, google-eclipse-plugin

使用 Google Eclipse 插件，我的项目会自动在 META-INF 文件夹中包含两个文件：`jdoconfig.xml`和`persistence.xml`. 根据[https://developers.google.com/appengine/docs/java/datastore/jpa/overview](https://developers.google.com/appengine/docs/java/datastore/jpa/overview)上的说明，我的持久性文件应该具有以下用于 jpa 数据存储存储的行：

```
<provider>org.datanucleus.store.appengine.jpa.DatastorePersistenceProvider</provider> 
```

但是当我打开持久性文件时，我发现

```
<?xml version="1.0" encoding="UTF-8" ?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
        http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">

    <persistence-unit name="transactions-optional">
        <provider>org.datanucleus.api.jpa.PersistenceProviderImpl</provider>
        <properties>
            <property name="datanucleus.NontransactionalRead" value="true"/>
            <property name="datanucleus.NontransactionalWrite" value="true"/>
            <property name="datanucleus.ConnectionURL" value="appengine"/>
        </properties>
    </persistence-unit>
</persistence> 
```

`jdoconfig.xml`文件是

```
<?xml version="1.0" encoding="utf-8"?>
<jdoconfig xmlns="http://java.sun.com/xml/ns/jdo/jdoconfig"
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:noNamespaceSchemaLocation="http://java.sun.com/xml/ns/jdo/jdoconfig">

   <persistence-manager-factory name="transactions-optional">
       <property name="javax.jdo.PersistenceManagerFactoryClass"
           value="org.datanucleus.store.appengine.jdo.DatastoreJDOPersistenceManagerFactory"/>
       <property name="javax.jdo.option.ConnectionURL" value="appengine"/>
       <property name="javax.jdo.option.NontransactionalRead" value="true"/>
       <property name="javax.jdo.option.NontransactionalWrite" value="true"/>
       <property name="javax.jdo.option.RetainValues" value="true"/>
       <property name="datanucleus.appengine.autoCreateDatastoreTxns" value="true"/>
   </persistence-manager-factory>
</jdoconfig> 
```

使用这些默认内容，JPA 并没有保存到我的数据存储中。所以我编辑`persistence.xml`文件看起来像这样

```
<?xml version="1.0" encoding="UTF-8" ?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
        http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd" version="1.0">

    <persistence-unit name="transactions-optional">
        <provider>org.datanucleus.store.appengine.jpa.DatastorePersistenceProvider</provider>
        <properties>
            <property name="datanucleus.NontransactionalRead" value="true"/>
            <property name="datanucleus.NontransactionalWrite" value="true"/>
            <property name="datanucleus.ConnectionURL" value="appengine"/>
        </properties>
    </persistence-unit>
</persistence> 
```

我应该如何更改`jdoconfig.xml`文件？现在，随着我的更改，`persistence`但`jdoconfig`原样，我得到了一个巨大的错误跟踪。

编辑错误：

```
java.lang.ExceptionInInitializerError
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:169)
    at com.google.appengine.tools.development.agent.runtime.RuntimeHelper.checkRestricted(RuntimeHelper.java:70)
    at com.google.appengine.tools.development.agent.runtime.Runtime.checkRestricted(Runtime.java:64)

…
…
...

Caused by: javax.persistence.PersistenceException: No persistence providers available for "transactions-optional" after trying the following discovered implementations: org.datanucleus.api.jpa.PersistenceProviderImpl
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:180)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:70) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T06:53:49.027

对于 JPA 2.0，提供程序是`org.datanucleus.api.jpa.PersistenceProviderImpl`请注意，这`persistence.xml`是 JPA 使用的配置文件，`jdoconfig.xml`如果您想使用 JDO，则使用它。

您首先需要决定要使用哪种持久性机制，我假设它的 JPA 所以实际上，您可以删除`jdoconfig.xml`.

话虽如此，请确保 Datanucleus 所需的所有库都在您的 CLASSPATH 中，最重要的是，persisence.xml 必须在您的 CLASSPATH 的根目录中。

我添加了成功 JPA 2 / Datanucleus 持久性所需的库的图片。

还要确保您的增强器配置正确。

仅供参考：我永远无法让 Google Eclipse 插件与 JPA 2 一起使用，实体增强从未起作用，所以我使用了 maven。有几种方法可以增强你的类，maven 就是其中之一。

这是我的pom。

```
 <properties>
            <!-- Convenience property to set the GWT version -->
            <gwtVersion>2.5.0</gwtVersion>
            <gxtVersion>2.2.5</gxtVersion>
            <gae.version>1.7.5</gae.version>
            <datanucleus.version>3.1.3</datanucleus.version>
            <!-- GWT needs at least java 1.5 -->
            <webappDirectory>${project.build.directory}/${project.build.finalName}</webappDirectory>
            <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        </properties>

    <!-- DN -->
        <dependency>
            <groupId>com.google.appengine.orm</groupId>
            <artifactId>datanucleus-appengine</artifactId>
            <version>2.1.2</version>
        </dependency>
        <dependency>
            <groupId>org.datanucleus</groupId>
            <artifactId>datanucleus-core</artifactId>
            <version>${datanucleus.version}</version>
            <scope>runtime</scope>
        </dependency>

        <dependency>
            <groupId>org.datanucleus</groupId>
            <artifactId>datanucleus-api-jpa</artifactId>
            <version>${datanucleus.version}</version>
        </dependency>

        <dependency>
            <groupId>org.datanucleus</groupId>
            <artifactId>datanucleus-api-jdo</artifactId>
            <version>${datanucleus.version}</version>
        </dependency>
        <dependency>
            <groupId>javax.jdo</groupId>
            <artifactId>jdo-api</artifactId>
            <version>3.0.1  </version>
        </dependency>
        <dependency>
            <groupId>org.apache.geronimo.specs</groupId>
            <artifactId>geronimo-jpa_2.0_spec</artifactId>
            <version>1.0</version>
        </dependency>

    <dependency>
  <groupId>com.google.appengine</groupId>
  <artifactId>appengine-jsr107cache</artifactId>
  <version>${gae.version}</version>
</dependency>

    <dependency>
  <groupId>com.google.appengine</groupId>
  <artifactId>appengine-endpoints</artifactId>
  <version>${gae.version}</version>
</dependency>

    <dependency>
  <groupId>net.sf.jsr107cache</groupId>
  <artifactId>jsr107cache</artifactId>
  <version>1.1</version>
</dependency> 
```

对于增强功能，请将以下内容添加到 pom 的插件部分：

```
<plugin>
                <groupId>org.datanucleus</groupId>
                <artifactId>maven-datanucleus-plugin</artifactId>
                <version>${datanucleus.version}</version>
                <configuration>
                    <api>JPA</api>
                    <verbose>true</verbose>             
                     <mappingIncludes>**/entity/*.class</mappingIncludes>
                     <fork>false</fork>
                     <log4jConfiguration>${basedir}/log4j.properties</log4jConfiguration>
                </configuration>
                <executions>
                    <execution>
                        <phase>process-classes</phase>
                        <goals>
                            <goal>enhance</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin> 
```

更改`<mappingIncludes>**/entity/*.class</mappingIncludes>`为放置实体的包。

在我自己的情况下，DataNucleus Enhancer 将在名为`entity`.

祝你好运

巴巴吉德

![在此处输入图像描述](https://i.stack.imgur.com/ABMpI.png)

# clojure - 如何在 core.logic 中解构地图？

> ID：15821718
> 
> 赞同：3
> 
> 时间：2013-04-04T21:07:02.357
> 
> 标签：clojure, clojure-core.logic

我相信我在解构 core.logic 中的地图时遇到了麻烦。我有以下代码：

```
... used clojure.core.logic 
... required clojure.core.logic.arithmetic as logic.arithmetic. 

(def hand ({:rank 9, :suit :hearts} 
           {:rank 13, :suit :clubs} 
           {:rank 6, :suit :spades} 
           {:rank 8, :suit :hearts} 
           {:rank 12, :suit :clubs}))

(run* [q]
  (fresh [v w x y z]  ;;cards
    (== q [v w x y z])
    (membero v hand)
    (membero w hand)
    (membero x hand)
    (membero y hand)
    (membero z hand)
    (fresh [a b c d e]  ;;ranks
      (== {:rank a} v)
      (== {:rank b} w)
      (== {:rank c} x)
      (== {:rank d} y)
      (== {:rank e} z)
      (logic.arithmetic/>= a b)
      (logic.arithmetic/>= b c)
      (logic.arithmetic/>= c d)
      (logic.arithmetic/>= d e))
    (distincto q))) 
```

它返回空列表（），表明它没有找到匹配项。我相信这是代码的 (== {:rank a} v) 部分的问题。我试图简单地返回 q，其中 q 是按 :rank 降序排列的地图向量。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-05-10T16:45:54.817

现在可以使用最新的 core.logic 版本 0.8.3 编写更简洁的解决方案：

```
(ns cards
  (:refer-clojure :exclude [==])
  (:use [clojure.core.logic])
  (:require [clojure.core.logic.fd :as fd]))

(def hand
  [{:rank 9, :suit :hearts} 
   {:rank 13, :suit :clubs} 
   {:rank 6, :suit :spades} 
   {:rank 8, :suit :hearts} 
   {:rank 12, :suit :clubs}])

(defn ranko [card rank]
  (featurec card {:rank rank}))

(run* [v w x y z :as q]
  (permuteo hand q)
  (fresh [a b c d e]
    (ranko v a) (ranko w b) (ranko x c)
    (fd/>= a b) (fd/>= b c)
    (ranko y d) (ranko z e)
    (fd/>= c d) (fd/>= d e))) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:15:42.060

显然，您必须在地图上进行精确匹配。这意味着您可以创建垃圾变量来捕获您不感兴趣的任何内容的值。看起来很奇怪，但没关系。

```
(run* [q]
  (fresh [v w x y z]  ;;cards
    (== q [v w x y z])
    (membero v hand)
    (membero w hand)
    (membero x hand)
    (membero y hand)
    (membero z hand)
    (fresh [a b c d e, f g h i j]  ;;ranks, garbage
      (== {:rank a :suit f } v)
      (== {:rank b :suit g } w)
      (== {:rank c :suit h } x)
      (== {:rank d :suit i } y)
      (== {:rank e :suit j } z)
      (logic.arithmetic/>= a b)
      (logic.arithmetic/>= b c)
      (logic.arithmetic/>= c d)
      (logic.arithmetic/>= d e))
      (distincto q))) 
```

最后，这里有一个稍微更简洁、更快、更乱码的版本。

```
(run* [q]
  (fresh [v w x y z]  ;;cards
    (permuteo hand q)
    (== q [v w x y z])
    (fresh [a b c d e, f g h i j]  ;;ranks, garbage
      (== {:rank a :suit f } v)
      (== {:rank b :suit g } w)
      (logic.arithmetic/>= a b)
      (== {:rank c :suit h } x)
      (logic.arithmetic/>= b c)
      (== {:rank d :suit i } y)
      (logic.arithmetic/>= c d)
      (== {:rank e :suit j } z)
      (logic.arithmetic/>= d e)))) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-10T16:30:57.680

如果你不需要引用逻辑变量，你实际上不需要命名它：

```
(== {:rank a :suit (lvar)} v) 
```

我发现自己使用`(lvar)`的越来越多。它通常使代码比一次性未使用的变量更清晰，但我确实希望有更好的方法来表达这一点。

# ruby-on-rails - S3 使用雾读取进度

> ID：15821721
> 
> 赞同：0
> 
> 时间：2013-04-04T21:07:06.057
> 
> 标签：ruby-on-rails, ruby, amazon-s3, fog

我正在尝试使用雾从 s3 下载一个大（> 500mb）文件。我想检查进度，但似乎多次下载文件。

我在用着：

```
connction = Fog::Storage.new(
  provider: 'AWS',
  aws_access_key_id: key_id,
  aws_secret_access_key: secret_key,
  region: 'eu-west-1',
)

connection.get_object(bucket, obj_key) do |chunk, remaining_bytes, total_bytes|
  file.write(chunk)
  p "Writing file: #{remaining_bytes} / #{total_bytes} remaining"
end 
```

整个过程似乎重复了很多次，几乎下载了所有数据，但是当剩下 1 兆字节时，它又开始重新下载！

大约 4 次循环后，它会引发错误：

```
negative argument (ArgumentError) (Excon::Errors::SocketError) 
```

任何建议都非常感谢！

**更新：** 宝石版本：

```
excon (0.20.1)
    fog (1.10.1)
    builder
    excon (~> 0.20)
    formatador (~> 0.2.0)
    mime-types
    multi_json (~> 1.0)
    net-scp (~> 1.1)
    net-ssh (>= 2.1.3)
    nokogiri (~> 1.5.0)
    ruby-hmac 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T14:00:46.853

我想知道这是否是 Excon gem 的问题。您使用的是哪个版本的 Excon、Fog 和 Ruby？

您可能还想尝试使用 EXCON_DEBUG=true 重新运行脚本。希望你能得到一些更好的信息。

# javascript - document.onload 没有图像或其他元素（只是 HTML）

> ID：15821722
> 
> 赞同：1
> 
> 时间：2013-04-04T21:07:08.433
> 
> 标签：javascript, html

我需要触发一个`document.onload`事件，但我希望它仅在 HTML 完全加载时触发，而无需等待图像或其他元素。

我一直在四处寻找，但找不到类似的东西。有什么办法吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:09:37.973

您可以在要执行的代码`<script>`之前在底部放置一个带有代码的标签。`</body>`

没有什么可以保证图像*不会*被加载。但它肯定不会等到它们*被*加载后再运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:11:46.147

使用`DOMContentLoaded`事件：

[https://developer.mozilla.org/en-US/docs/DOM/Mozilla_event_reference/DOMContentLoaded](https://developer.mozilla.org/en-US/docs/DOM/Mozilla_event_reference/DOMContentLoaded)

> DOMContentLoaded 事件在文档完全加载和解析后触发，无需等待样式表、图像和子框架完成加载（加载事件可用于检测完全加载的页面）。

（只是为了它，但使用 jQuery `$(document).ready(function () {});`：）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:14:08.217

我不记得具体的事件，但您可以通过将其放在最后一个结束 html 标记之前来触发您的事件：

```
...
    <script type="text/javascript">
        html_loaded(); // Custom function call
    </script>
</html> 
```

对于任何目的，这都应该非常有效。

高温高压

弗朗西斯科

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T21:17:49.847

@Ian 提出的`DOMContentLoaded`事件会起作用，但它在 HTML5 规范中，因此不受 IE8 等旧版浏览器的支持。

否则，我认为@Chris Farmiloe 的脚本解决方案是最好的方法。

# jquery - jcarousel如何垂直居中项目

> ID：15821726
> 
> 赞同：0
> 
> 时间：2013-04-04T21:07:32.503
> 
> 标签：jquery, css, asp.net-mvc-3, jcarousel

我正在接管一个使用 jQuery（对我来说都是新技术）的 ASP.NET MVC 3 C# Razor 网站的维护工作。我的 jcarousel 中的项目是各种大小的缩略图。我希望它们在旋转木马中垂直居中，但我无法弄清楚如何实现这一点。

我尝试`vertical-align: middle;`在各个地方进行以下放置，但没有效果。我想问题是我对 Web 开发非常陌生，并且缺少一些明显的东西，但是我已经做了几个小时，所以终于向这个出色的社区寻求帮助！

如何让我的图像在轮播中垂直居中？

在我看来，这是我的代码：

```
<ul id="screenshot-carousel" class="jcarousel-skin-tango">
  @{ string[,] screenshots = ViewBag.Screenshots; }
  @for (int i = 0; i < screenshots.GetLength(0); i++)
  {
    <li><a class="screenshot" href="@Url.Content("~/Content/images/map-creator/" + screenshots[i, 0] + ".jpg")" title="@screenshots[i, 1]">
      <img src="@Url.Content("~/Content/images/map-creator/" + screenshots[i, 0] + "_t.jpg")" width="@screenshots[i, 2] " height="@screenshots[i, 3] " alt="@screenshots[i, 1]" /></a></li>
  }
</ul>
@section HtmlHead
{
  <style type="text/css">
/**
 * Overwrite for having a carousel with dynamic width.
 */
.jcarousel-skin-tango .jcarousel-container-horizontal {
    width: 85%;
}

.jcarousel-skin-tango .jcarousel-clip-horizontal {
    width: 100%;
}

.jcarousel-skin-tango .jcarousel-item {
    width: auto;
    height: auto;
}

.jcarousel-skin-tango .jcarousel-item-horizontal {
    margin-left: 0;
    margin-right: 3px;
}

    a.screenshot img {
      border: 1px solid #aaa;
    }
  </style>
  <script type="text/javascript">
      $(document).ready(function () {
          $('#screenshot-carousel').jcarousel();

          $(".screenshot").colorbox({
              rel: 'screenshot',
              width: "1200",
              height: "600",
              current: "{current} of {total}"
          });
      });    
  </script> 
```

这是 jcarousel\tango\skin.css 中的非按钮轮播内容（请注意，其中一些也出现在视图中的代码中，我假设这意味着视图中的代码会覆盖此代码）：

```
.jcarousel-skin-tango .jcarousel-container {
    -moz-border-radius: 10px;
    -webkit-border-radius: 10px;
   border-radius: 10px;
    background: #F0F6F9;
    border: 1px solid #346F97;
}

.jcarousel-skin-tango .jcarousel-direction-rtl {
    direction: rtl;
}

.jcarousel-skin-tango .jcarousel-container-horizontal {
    width: 245px;
    padding: 20px 40px;
}

.jcarousel-skin-tango .jcarousel-container-vertical {
    width: 75px;
    height: 245px;
    padding: 40px 20px;
}

.jcarousel-skin-tango .jcarousel-clip {
    overflow: hidden;
}

.jcarousel-skin-tango .jcarousel-clip-horizontal {
    width:  245px;
    height: 75px;
}

.jcarousel-skin-tango .jcarousel-clip-vertical {
    width:  75px;
    height: 245px;
}

.jcarousel-skin-tango .jcarousel-item {
    width: 75px;
    height: 75px;
}

.jcarousel-skin-tango .jcarousel-item-horizontal {
    margin-left: 0;
    margin-right: 10px;
}

.jcarousel-skin-tango .jcarousel-direction-rtl .jcarousel-item-horizontal {
    margin-left: 10px;
    margin-right: 0;
}

.jcarousel-skin-tango .jcarousel-item-vertical {
    margin-bottom: 10px;
}

.jcarousel-skin-tango .jcarousel-item-placeholder {
    background: #fff;
    color: #000;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T18:33:22.757

我在我的视图文件中更改了以下 css，它适用于 Chrome。设置 line-height 和 vertical-align 似乎就是这样做的。仍然无法在 IE10 上运行，所以我开始认为 IE10 是不可能的。如果有人有更好的答案，请发布，我会接受它而不是我的！

```
.jcarousel-skin-tango .jcarousel-clip-horizontal {
    width: 100%;
    height: 100%;
}

.jcarousel-skin-tango .jcarousel-item {
    width: auto;
}

.jcarousel-skin-tango .jcarousel-item-horizontal {
    margin-left: 0;
    margin-right: 3px;
    height: auto;
    line-height: 80px;
}

a.screenshot img {
  border: 1px solid #aaa;
  vertical-align: middle;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T20:19:24.660

我留下我的其他答案以防它对某人有帮助，但我现在找到了一个更好的答案，适用于 IE10 和 Chrome（虽然在 Chrome 上居中可能并不完美，但对我来说已经足够接近了）。`line-height`我没有设置和属性，而是`vertical-align`在我的 img 中设置了适当的上边距，即 (LARGEST_IMAGE_HEIGHT - IMAGE_HEIGHT) / 2。我在控制器中计算该值并将该值传递给每个图像的视图。

所以视图中的修复是将样式添加到 img 元素：

```
<img src="@Url.Content("~/Content/images/map-creator/" + screenshots[i, 0] + "_t.jpg")" width="@screenshots[i, 2]" alt="@screenshots[i, 1]" style="margin-top:@screenshots[i, 4]" /> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-11T22:23:45.373

我知道这是相当古老的，甚至 jcarousel 也发生了重大变化，但我会推荐好的 ol' `display: table-cell`。

```
ul#screenshot-carousel {
    display: table;
    width: auto;
}

ul#screenshot-carousel &gt; li {
    display: table-cell;
    vartical-align: middle;
} 
```

# .net - 部署 asp.net mvc 4 Web 应用程序

> ID：15821729
> 
> 赞同：0
> 
> 时间：2013-04-04T21:07:36.637
> 
> 标签：.net, asp.net-mvc, iis

我目前正在使用 asp.net mvc 4 开发一个 Web 应用程序，它使用 SQL 数据库。我的问题是，我怎样才能将它部署在我的机器上以便可以从互联网上访问它？我真的只想将它部署在我的机器上，这样我就不必迁移我的数据库加上它不是用于生产的，我的老板只想从不在我本地网络上的计算机上访问 Web 应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:30:15.653

1.  使用不在桌面上运行的网络服务器（即 IIS 而不是 Cassini。我不确定 IIS Express 是否是一个好主意 - 我个人更喜欢正版文章。顺便说一句，Cassini 不允许外部连接。 )
2.  其次，确保您的计算机可以从您老板的位置访问。如果您在办公环境中，那么您可能在 NAT 之后，您需要让您的网络管理员设置到您机器的端口转发 - 他们可能会拒绝转发端口 80 的请求，所以请1024 以上的端口。您需要配置 IIS 和本地计算机的防火墙以接受该转发端口上的连接，并将绑定添加到 IIS 中的网站。
3.  [从WhatIsMyIP.com](http://www.WhatIsMyIP.com)（或我个人最喜欢的：[MoanMyIP.com](http://www.MoanMyIP.com)）等服务获取您的 Internet 可见 IP 地址。
4.  然后，您的老板将需要进入`http://yourIPAddress:yourForwardedPort/someAppPath`以访问您的应用程序。

# jquery - JQuery .click .hide div 里面有 div

> ID：15821730
> 
> 赞同：-1
> 
> 时间：2013-04-04T21:07:38.467
> 
> 标签：jquery

当用户点击#homepage-alpha时，我试图让脚本隐藏#homepage和其中的3个div

```
#alpha { display:none; }

$("#homepage-alpha").click(function(){ 
   $("#homepage").hide(); 
   $("#alpha").show(); 
});

<div id="homepage">
   <div id="homepage-alpha"></div>
   <div id="homepage-bravo"></div>
   <div id="homepage-charlie"></div>
</div>

<div id="alpha">
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:11:18.487

如评论中所述：

```
 #alpha { display:none; }

    <div id="homepage">
       <div id="homepage-alpha"></div>
       <div id="homepage-bravo"></div>
       <div id="homepage-charlie"></div>
    </div>

    <div id="alpha">
    </div>

    <script>       
    $("#homepage-alpha").click(function(){ 
       $("#homepage").hide(); 
       $("#alpha").show(); 
    });
    </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:14:16.137

试试这个：

```
 <html>
 <head>
 <style>
  #alpha { display:none; }
 </style>
 </head>
    <body>
    <div id="homepage">
       <div id="homepage-alpha"></div>
       <div id="homepage-bravo"></div>
       <div id="homepage-charlie"></div>
    </div>

    <div id="alpha">
    </div>

    <script>       
    $("#homepage-alpha").click(function(){ 
       $("#homepage").hide(); 
       $("#alpha").show(); 
    });
    </script>
  </body>
  </html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:16:03.650

你应该做

```
 ...
    <script>       
      $(document).ready(function(){
       $("#homepage-alpha").on('click',function(){ 
       $("#homepage").hide(); 
       $("#alpha").show(); 
      });
   });
   </script> 
```

即使您将脚本放在正文之前，它也肯定会在 DOM 准备好之后运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T21:17:24.103

你的 html 和 js 代码很好，只要用对了。

```
<div id="homepage">
   <div id="homepage-alpha"></div>
   <div id="homepage-bravo"></div>
   <div id="homepage-charlie"></div>
</div>

<div id="alpha"> 
```

```
<script> 
$(function() {
  $("#homepage-alpha").click(function(){ 
     $("#homepage").hide(); 
     $( "#alpha" ).show(); 
  });
});
</script> 
```

检查这个工作示例 [Jsfiddle](http://jsfiddle.net/naCPv/1/)

# c++ - C++：如何验证已删除的指针

> ID：15821733
> 
> 赞同：1
> 
> 时间：2013-04-04T21:07:42.217
> 
> 标签：c++

我目前正在大学学习 C++ 中的指针。我编写了一个程序，它是一个指向子对象链表的对象二叉树。如果我的措辞正确的话。无论如何，我的程序似乎工作正常，但我无法解决如何测试指针删除的问题。

例如，我对二叉树的单个对象的删除函数是：

```
 void EmployeeRecord::destroyCustomerList()
    {
        if(m_oCustomerList != NULL)
        {
            delete m_oCustomerList;
            m_oCustomerList = NULL;           
        }
    } 
```

打印我的树时，所有内容都会填充并正确移除（这意味着树在每次删除节点时都保持完整）......但是我如何确认释放的内存会发生什么？我知道，由于我将指针 *m_oCustomerList 设置为 NULL，因此我可以在先前填充的对象上测试 NULL 值，但是实际内存会发生什么？

我正在使用 Visual Studio/C++ 并且已经读到调试器将使用从 0xCC 开始的代码来释放内存......但我似乎无法弄清楚如何使用该信息。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T21:18:00.313

请注意，您的代码

```
 void EmployeeRecord::destroyCustomerList()
    {
        if(m_oCustomerList != NULL)
        {
            delete m_oCustomerList;
            m_oCustomerList = NULL;           
        }
    } 
```

简化为：

```
 void EmployeeRecord::destroyCustomerList()
    {
        delete m_oCustomerList;
        m_oCustomerList = NULL;
    } 
```

`delete`在 C++ 中对空指针调用运算符是安全的。它什么也不做。换句话说，对 null 的检查已经“内置”了。

一旦你删除了一个对象，它就不再存在了，指向那个对象的指针变成了不确定的值（所以把那个指针的所有副本都清空并不是一个坏主意）。

*在实际的 C++ 实现中，内存真正*发生的事情，而不是抽象意义上的，是它继续存在于同一地址，但被标记为空闲，以便可以为其他目的分配它。来自程序（可能是完全不相关的模块）或可能来自系统中的另一个程序的分配请求可以获得该内存以供自己使用。

指向不再存在的对象的指针的任何使用都是“未定义的行为”。确实存在用于安全验证此类指针的函数，但它们非常特定于平台并且很少完美。

问题是，虽然一个实现确认一个指针是坏的并不是特别困难，但不可能确认一个指针是好的。我们可以遍历内存分配器的内部内存数据结构，以确定某个指针指向空闲存储。但是如果存储随后被分配怎么办？然后指针不再指向空闲存储。但它也不是指分配的原始对象！这被称为“ABA 歧义”：因为一些 A 变成了 B，然后又变成了 A，与原来的 A 没有区别。

存在解决 ABA 歧义的方法（如果不是完全，至少是部分）。例如，指针变得“胖”，因此它们除了地址位之外还有一个额外的字段。该字段可以包含一个序列号，用于标记从分配器返回的指针。现在，当一个对象被删除并重新分配时，指向同一位置的新指针具有不同的序列号：我们有 ABA'。指针 A 坏了，变成了 B，但是当它复活时，它又变成了 A'。如果我们要求系统验证 A，它会正确地确定 A 是坏的，因为它没有预期的序列号。指向对象的正确有效指针是 A'，它与 A 不匹配。

但是，序列号字段只有这么多位宽，它们最终会回绕。所以ABA问题并没有真正解决。好与坏指针的验证只会变得更加可靠。为了彻底解决 ABA 问题，系统必须始终分发不等于任何仍可使用的指针的新指针。这意味着永远不要真正释放任何东西（从而耗尽内存）或实施垃圾收集。（这意味着`delete`实际上什么都不做：被删除的对象被销毁，但会一直留在内存中，直到它们被垃圾回收，当程序不再记住指针的任何副本时会发生这种情况。此时，程序不再记得 A，并且所以可以重新引入A，不存在ABA问题。）

要使*所有*指针“变胖”，您必须更改整个工具链和运行时：编译器、库等。由于大型程序往往具有多个内存分配器，因此存在进一步的困难。如果你问错误的分配器“这个指针是否有效”，它只能说“这个指针不是来自我的竞技场”。您可以做的另一种方法是发明自己的指针并将它们实现为 C++ 中的智能指针。您的指针可以支持一种`is_valid`尽可能可靠的方法（以某种方式处理 ABA 问题：部分使用一些序列号等，或者通过实施您自己的垃圾收集方案。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T21:12:25.767

访问已删除的内存是标准未定义的行为。例如，如果这是一个多线程应用程序（或某些其他进程已将线程注入您的应用程序），那么新分配可能会在您能够“验证”之前分配您刚刚释放的内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T22:06:02.513

一旦你删除了你的内存并将你的指针设置为 NULL，即使你想要它，你也无法再访问该内存。因此，无法验证它是否真的消失了。但是，如果您做错了什么并且内存从未被删除，它将包含内存泄漏，这会导致您的程序增加它使用的内存量，您可以将此视为指针未正确处理的症状。

稍后您可能会了解到，您不必担心指针的删除，因为`std::shared_ptr`当指针超出范围时会删除您的对象。稍后会更安全，因为您可能会了解到异常会导致您的析构函数永远不会触发而导致内存泄漏。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-04T21:13:53.137

```
...
... 
delete m_oCustomerList;

// Try using the deleted pointer here
// This should cause a runtime exception
// which means you did free the pointer
m_oCustomerList->someStrMemberVariable = "This will fail"
...
... 
```

不用说，不要在实际代码中这样做。希望这可以帮助。

# android - 在创建时检查 ListView (ListActivity) 中的项目

> ID：15821736
> 
> 赞同：0
> 
> 时间：2013-04-04T21:07:47.890
> 
> 标签：android, listview, checkbox

我需要有类似设置 ListView 和复选框的东西，但必须动态添加内容，而不是从 XML（从文件夹加载文件名）。

如何让 ListActivity 带有记住设置的复选框？像这样
[ListView + CheckBox](https://stackoverflow.com/questions/12821663/listview-checkbox) ![ListView 来自上面的帖子](https://i.stack.imgur.com/b2GWf.png) （长答案）的列表看起来不错，但我不知道如何**检查 onCreate()**。我想保存字符串`SharedPreferences`，当应用程序关闭并再次重新加载时，它会检查之前检查过的内容。

或者，有没有更好的方法来做到这一点？

非常感谢您的回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T11:43:58.677

您需要做的只是在您检查某个项目时设置它的偏好。然后在重新创建活动后，根据偏好设置 listview 适配器和**setChecked(true)为 listview_row 上的复选框**

# java - 使用 JAXB&MOXy 将 JPA 实体转换为 XML 并再次转换回来

> ID：15821738
> 
> 赞同：2
> 
> 时间：2013-04-04T21:07:54.090
> 
> 标签：java, xml, jpa, moxy

考虑到 MOXy，我陷入了（我猜）一个非常微不足道的问题。将像这个示例（[pastebin](http://pastebin.com/2t1PPqW0)）这样的类转换为 XML 没有问题，将其转换回来也没有任何错误。但是，引用另一个（或更多）的字段`Person`将导致空值。

有什么方法可以在不失去关系的情况下完成这项工作？我的猜测是这是由于仅通过 ID 引用，因为 JAXB 无法知道其他现有对象。我尝试过使用`@XmlInverseReference`，尽管每次尝试都会导致无限循环。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-06T12:29:23.773

[**EclipseLink MOXy**](http://www.eclipse.org/eclipselink/moxy.php)`@XmlInverseReference`用于解决无限循环问题。我将在下面使用基于您的模型的示例进行演示：

**人**

```
package forum15821738;

import java.io.Serializable;
import java.util.List;
import javax.xml.bind.annotation.*;

import org.eclipse.persistence.oxm.annotations.XmlInverseReference;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class Person implements Serializable {

    private String name;

    @XmlInverseReference(mappedBy="children")
    private Person parent;

    @XmlElementWrapper
    @XmlElement(name="child")
    private List<Person> children;

    public Person getParent() {
        return parent;
    }

    public List<Person> getChildren() {
        return children;
    }

    // OTHER GETTERS AND SETTERS

} 
```

**jaxb.properties**

要将 MOXy 指定为您的 JAXB 提供程序，您需要包含一个`jaxb.properties`在与域模型相同的包中调用的文件，其中包含以下条目（请参阅： [http ://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as -你的.html](http://blog.bdoughan.com/2011/05/specifying-eclipselink-moxy-as-your.html) )

```
javax.xml.bind.context.factory=org.eclipse.persistence.jaxb.JAXBContextFactory 
```

**演示**

```
package forum15821738;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Person.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum15821738/input.xml");
        Person person = (Person) unmarshaller.unmarshal(xml);

        for(Person child : person.getChildren()) {
            System.out.println(child.getParent());
        }

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(person, System.out);
    }

} 
```

**输入输出**

```
forum15821738.Person@5893a012
forum15821738.Person@5893a012
<?xml version="1.0" encoding="UTF-8"?>
<person>
   <name>Jane</name>
   <children>
      <child>
         <name>Bobbie</name>
      </child>
      <child>
         <name>Sue</name>
      </child>
   </children>
</person> 
```

**了解更多信息**

*   [http://blog.bdoughan.com/2010/07/jpa-entities-to-xml-bidirectional.html](http://blog.bdoughan.com/2010/07/jpa-entities-to-xml-bidirectional.html)
*   [http://blog.bdoughan.com/2013/03/moxys-xmlinversereference-is-now-truly.html](http://blog.bdoughan.com/2013/03/moxys-xmlinversereference-is-now-truly.html)

# iphone - 仅在页面加载后，如何在应用启动后显示 UIWebView？

> ID：15821743
> 
> 赞同：0
> 
> 时间：2013-04-04T21:08:26.517
> 
> 标签：iphone, objective-c, xcode, ios4

我试图仅在页面加载后加载 UIWebView。在页面准备好之前，我只希望显示启动画面。我尝试遵循此页面上的第一个答案（[XCode 防止 UIWebView 在 Launch Image 后闪烁白屏](https://stackoverflow.com/questions/11376495/xcode-prevent-uiwebview-flashing-white-screen-after-launch-image)），但它似乎不起作用......启动画面加载并且 UIWebView 永远不会加载。

有什么建议吗？

视图控制器.h

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController{

IBOutlet UIWebView *webView;

}

@property (nonatomic, retain) IBOutlet UIWebView *webview;
@property(nonatomic, strong) UIImageView *loadingImageView;
@end 
```

视图控制器.m

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController;

@synthesize webview;
@synthesize loadingImageView;

- (void)viewDidLoad
{
    [super viewDidLoad];

    //**************** Set website URL for UIWebView
    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://http://warm-chamber-7399.herokuapp.com/"] cachePolicy:NSURLCacheStorageAllowed timeoutInterval:20.0]];

    //**************** Add Static loading image to prevent white "flash" ****************/
    UIImage *loadingImage = [UIImage imageNamed:@"Default.png"];
    loadingImageView = [[UIImageView alloc] initWithImage:loadingImage];
    loadingImageView.animationImages = [NSArray arrayWithObjects:
                                        [UIImage imageNamed:@"Default.png"],
                                        nil];
    [self.view addSubview:loadingImageView];

}

- (void)webViewDidFinishLoad:(UIWebView *)webView {

    // Remove loading image from view
    [loadingImageView removeFromSuperview];

}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

@end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-05T04:12:28.520

尝试这个，

```
@interface ViewController () <UIWebViewDelegate>

 {
    UIWebView * webView;
    UIImageView * imageView;
 }

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    imageview = [[UIImageView alloc]init];
    [imageview setFrame:CGRectMake(0.0, 0.0, 320.0, 460.0)];
    [imageview setImage:[UIImage imageNamed:@"Red.png"]];
    [self.view addSubview:imageview];

    webView = [[UIWebView alloc]initWithFrame:CGRectMake(0.0, 0.0, 320.0, 460.0)];
    [webView setDelegate:self];
    [webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.apple.com"]]];

    // Do any additional setup after loading the view, typically from a nib.
}

// UIWebView Delegate

- (void)webViewDidFinishLoad:(UIWebView *)webView
{
    [imageView removeFromSuperview];
    [self.view addSubview:webView]; 
}

@end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:43:10.467

你设置了代表`webView`吗？如果不进行设置，您的`webViewDidFinishLoad:`方法将永远不会触发。

```
webView.delegate = self; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T05:51:59.717

为什么不直接将启动图像添加到 .plist 文件中

# plsql - 使用 FOR-ALL 进行更新

> ID：15821748
> 
> 赞同：0
> 
> 时间：2013-04-04T21:08:45.910
> 
> 标签：plsql, oracle11g, procedure

我有以下代码

```
TYPE t_dc IS TABLE OF TEMP_DC%ROWTYPE INDEX BY PLS_INTEGER;
o_u_dc t_dc;
n_index_update_dc BINARY_INTEGER := 0; 
```

然后在脚本的结尾我有

```
 IF n_index_update_dc > 0
            THEN
                FORALL dc IN o_u_dc.first..o_u_dc.last SAVE EXCEPTIONS
                    UPDATE TEMP_DC
                    SET COL1 = o_u_dc(n_index_update_dc).col1
                    WHERE COLPK = o_u_dc(n_index_update_dc).COLPK;
            END IF;
            COMMIT; 
```

我收到错误`116 7 PLS-00435: DML statement without BULK In-BIND cannot be used inside FORALL`

我尝试在 oracle 文档上在线查找，但我不明白我缺少什么。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-05T02:00:50.843

我不知道你从哪里得到的`n_index_update_dc` ，但你应该使用的代码是：

```
 IF n_index_update_dc > 0 THEN
                FORALL dc IN o_u_dc.first..o_u_dc.last SAVE EXCEPTIONS
                    UPDATE TEMP_DC
                    SET COL1 = o_u_dc(dc).col1
                    WHERE COLPK = o_u_dc(dc).COLPK;
            END IF;
            COMMIT; 
```

这也取决于你如何填满`o_u_dc`。也许这不是你想要实现的。

# python - 如何在 python scikit-learn 随机森林中使用虚拟变量来表示分类数据

> ID：15821751
> 
> 赞同：4
> 
> 时间：2013-04-04T21:08:54.827
> 
> 标签：python, scikit-learn, scikits, dummy-data

我正在为 scikit-learn 的随机森林分类器生成特征向量。特征向量代表9个蛋白质氨基酸残基的名称。有 20 个可能的残基名称。因此，我使用 20 个虚拟变量来表示一个残基名称，对于 9 个残基，我有 180 个虚拟变量。

例如，如果滑动窗口中的 9 个残基是： ARNDCQEGH（每个字母代表一个蛋白质残基的名称），我的特征向量将是：

```
"True\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tFalse\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tFalse\tFalse\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tFalse\tFalse\tFalse\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tFalse\tFalse\tFalse\tFalse\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tFalse\tFalse\tFalse\tFalse\tFalse\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\t
False\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tTrue\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\tFalse\n" 
```

另外，我尝试使用 (1,0) 替换 (True,False)

在训练和测试 Scikit 的随机森林分类器模型后，我发现它完全不起作用。但是 Scikit 的随机森林可以与我的其他数值数据一起使用。

Scikit 的随机森林可以处理分类变量或虚拟变量吗？如果是这样，你能提供一个例子来说明它是如何工作的。

这是我设置随机森林的方法：

```
clf=RandomForestClassifier (n_estimators=800, criterion='gini', n_jobs=12, max_depth=None, compute_importances=True, max_features='auto', min_samples_split=1,  random_state=None) 
```

提前非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T12:11:39.797

使用编码为 0 和 1 的布尔特征应该可以工作。如果即使您的森林中有大量决策树，预测准确性也很差，则可能是您的数据太嘈杂，以至于学习算法无法提取任何有趣的想法。

您是否尝试过拟合线性模型（例如逻辑回归）作为此数据的基线？

**编辑**：在实践中，对分类变量使用整数编码往往适用于许多随机决策树模型（例如 scikit-learn 中的 RandomForest 和 ExtraTrees）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T07:48:31.983

Scikits 随机森林分类器可以使用虚拟变量，但也可以直接使用分类变量，这是首选方法。只需将您的字符串映射为整数。假设您的特征向量是 ['a' ,'b', 'b', 'c']

```
vals = ['a','b','b','c']
#create a map from your variable names to unique integers:
intmap = dict([(val, i) for i, val in enumerate(set(vals))]) 
#make the new array hold corresponding integers instead of strings:
new_vals = [intmap[val] for val in vals] 
```

new_vals 现在保存值 [0, 2, 2, 1]，您可以直接将其提供给 RF，无需进行虚拟化

# html - Perl HTML 文件上传问题。文件大小为零

> ID：15821756
> 
> 赞同：0
> 
> 时间：2013-04-04T21:09:13.067
> 
> 标签：html, perl, upload, size, zero

我有一个 perl CGI 脚本，它可以将文件从 PC 上传到 Linux 服务器。

当我以自己的 HTML 表单编写对 CGI 的调用然后执行时，它完全按预期工作，但是当我将相同的调用放入现有应用程序时，文件在服务器上创建，但没有获取数据，它大小为零。

我已经比较了环境变量（我可以从中提取的那些`%ENV`），没有任何东西看起来像一个原因。我实际上尝试将我自己的 HTML 脚本中的几个 ENV 更改为现有应用程序正在使用的值，但这并没有揭示问题。

日志中没有给我任何线索，上传操作认为它是成功的。两个测试的用户都是相同的。如果权限是一个问题，那么该文件甚至不会在服务器上创建。

IE 中的结果与 Chrome 中的结果相同（来自我自己的 HTML 脚本，而不是来自应用程序）。

我应该查看哪些具体设置进行比较？

这是上传代码：

```
if (open(UPLOADFILE, ">$upload_dir/$fname")) {
    binmode UPLOADFILE;

    while (<$from_fh>) {
        print UPLOADFILE;
    }
    close UPLOADFILE;
    $out_msg = "Done with Upload: upload_dir=$upload_dir fname=$fname";
}
else {
    $out_msg = "ERROR opening for upload: upload_dir=$upload_dir filename=$filename";
} 
```

我确实验证了

*   从应用程序内部运行时，它不会进入 while 循环。
*   当从我自己的 HTML 脚本调用时，它确实进入了 while 循环。

两次运行的值`$from_fh`相同。以下块中使用的所有值对于两次运行都完全相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T02:02:29.357

我的猜测是，基于您将其嵌入另一个应用程序的事实，所有输入都已被其他应用程序的某些功能读取。例如，如果我尝试将此程序用作 CGI 脚本的一部分，并且我使用了 CGI.pm 中的 param() 函数，那么整个文件上传就已经被读取了。因此，如果我自己的代码再次尝试读取该文件，它将收到零数据，因为数据已经准备好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:22:12.857

你可以检查你打开的错误结果吗？

```
my $err;
open(my $uploadfile, ">", "$upload_dir/$fname") or $err = $!;
if (!$uploadfile) {
  my $out_msg = "ERROR opening for upload: upload_dir=$upload_dir filename=$filename: $err";
}
else {
  ### Stuff
  ...;
} 
```

# android - 如何将 arrayadapter 传递给另一个活动？

> ID：15821757
> 
> 赞同：0
> 
> 时间：2013-04-04T21:09:22.017
> 
> 标签：android

基本上我正在制作一个带有消息系统的战舰游戏。因此，我有另一个活动，用户可以来回切换。因此，如果电话 1 向电话 2 发送消息，电话 2 会将消息添加到数组适配器，然后在用户进入消息页面时将其传递给新活动。我希望这是有道理的。

如何将我的阵列适配器发送到另一个活动？是不是有点像`intent.putExtra(etc);`。我是否需要将其保存到数组列表并将其转换为新活动中的数组适配器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:10:58.877

我会说你应该简单地将基础数据传递给另一个 Activity，并让 arrayadapter 重新加载数据。ArrayAdapter 使用加载它的 Activity 的上下文进行初始化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:19:18.620

您可以做的最简单的事情是使 ArrayAdapter 可序列化。只需实现接口。

# mfc - Winsock 发送 recv 缓冲区大小

> ID：15821759
> 
> 赞同：2
> 
> 时间：2013-04-04T21:09:27.910
> 
> 标签：mfc, winsock, winsock2, winsockets

我正在编写一个 MFC 应用程序来实现客户端/服务器方案并为此使用 Win 套接字。我可以发送/接收一条小消息，例如“你好”。另外，我尝试使用大小为 1000 的缓冲区。但是，当我进一步增加其大小时，它只是挂起。甚至不会抛出任何错误。

关于问题可能是什么的任何想法？我可以在winsock中发送/接收的缓冲区的最大大小是否有任何限制？我是这方面的新手，以前从未使用过winsock。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-18T22:30:46.230

icabod的以下[评论回答了这个问题。](https://stackoverflow.com/questions/15821759/winsock-send-recv-buffer-size#comment22873372_15821759)

[“我对这个问题的回答](https://stackoverflow.com/questions/15925158/c-winsock-recv-buffer-junk/16016994#16016994)涵盖了您收到一部分数据，然后是其余部分的事实。这基本上是 TCP 的工作方式。-icabod”

# api - neo4j REST API 获取 HTML 响应而不是 JSON

> ID：15821768
> 
> 赞同：1
> 
> 时间：2013-04-04T21:09:57.903
> 
> 标签：api, rest, neo4j

我正在尝试从 Apache Flex 前端使用 neo4j 的 REST API。当我的 Flex 应用程序连接到基本 URL ( `http://localhost:7474/db/data/`) 以发现其他服务 URL 时，它会以 HTML 而不是 JSON 格式返回回复（就像我在浏览器中输入基本 URL 一样）。

在 Flex HTTP 请求中，我将*Content-Type*和*Accept*标头都设置为“application/json”，但并没有什么不同。我也尝试过*GET*和*POST*请求方法。

我已经验证 neo4j 能够通过一个简单的 telnet 窗口发送 JSON 响应，因此它必须根据 HTTP 请求中的某些内容“智能地”格式化响应。不过，我认为*Content-Type*和*Accept*标头会处理它。

我意识到这个问题在技术上不在于 neo4j，而是在 Flex 的 HTTPService（和支持）类中的某个地方，但我在解决明显的错误/限制方面一直没有成功。

有没有办法简单地强制来自 neo4j 的所有此类响应仅采用 JSON 格式？

谢谢，

克里斯

*** 编辑 ***

根据下面的要求，这是我在 Flex 应用程序中得到的确切回复：

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><title>Root</title><meta content="text/html; charset=utf-8" http-equiv="Content-Type">
<link href='http://resthtml.neo4j.org/style/rest.css' rel='stylesheet' type='text/css'>
<script type='text/javascript' src='/webadmin/htmlbrowse.js'></script>
</head>
<body onload='javascript:neo4jHtmlBrowse.start();' id='root'>
<div id='content'><div id='header'><h1><a title='Neo4j REST interface' href='/'><span>Neo4j REST interface</span></a></h1></div>
<div id='page-body'>
<table class="root"><caption>Root</caption>
<tr class='odd'><th>relationship_index</th><td><a href="http://localhost:7474/db/data/index/relationship">http://localhost:7474/db/data/index/relationship</a></td></tr>
<tr><th>node_index</th><td><a href="http://localhost:7474/db/data/index/node">http://localhost:7474/db/data/index/node</a></td></tr>
</table>
<div class='break'>&nbsp;</div></div></div></body></html> 
```

如果我只是手动将基本 URL 放入我的 Web 浏览器并以这种方式检索它，这与我得到的结果相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T20:43:00.680

我想到了。当我将 Flex 应用程序编译为基于浏览器的应用程序并将其运行时，它使用浏览器的本机功能来请求 URL，从而消除了我自定义的 Content-Type 和 Accept 标头。

当我编译并作为 Adob​​e Air 桌面应用程序运行时，它运行良好，并且我收到了正确的 JSON 响应。

这可能是 Flash Player 中的一个错误，因为 Flex HTTPService 类的文档对在浏览器和 Air 中运行时更改 Content-Type 或其他标头没有任何限制。

-克里斯

# php - 通过 php 的分隔符本身拆分字符串

> ID：15821771
> 
> 赞同：3
> 
> 时间：2013-04-04T21:10:17.380
> 
> 标签：php, regex, string

我正在尝试从一个长文件中提取 php 代码。我希望丢弃不在 PHP 标签中的代码。例子

```
<html>hello world, its a wonderful day</html>
<?php echo $user_name; ?> Some more text or HTML <?php echo $datetime; ?> 
I just echoed the user_name and datetime variables. 
```

我想返回一个数组：

```
array(
    [1] =>  "<?php echo $user_name; ?>"
    [2] =>  "<?php echo $datetime; ?>"
) 
```

我想我可以用正则表达式做到这一点，但我不是专家。有什么帮助吗？我用 PHP 写这个。:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-04T21:18:47.140

您必须查看源代码才能看到结果，但这是我想出的：

```
$string = '<html>hello world, its a wonderful day</html>
<?php echo $user_name; ?> Some more text or HTML <?php echo $datetime; ?> 
I just echoed the user_name and datetime variables.';

preg_match_all("/<\?php(.*?)\?>/",$string,$matches);

print_r($matches[0]); // for php tags
print_r($matches[1]); // for no php tags 
```

**更新：**正如[Revent 所述](https://stackoverflow.com/users/1570024/revent)，您可以使用`<?=`速记 echo 语句。可以更改您的内容`preg_match_all`以包括以下内容：

```
$string = '<html>hello world, its a wonderful day</html>
<?php echo $user_name; ?> Some more text or HTML <?= $datetime; ?> 
I just echoed the user_name and datetime variables.';

preg_match_all("/<\?(php|=)(.*?)\?>/",$string,$matches);

print_r($matches[0]); // for php tags
print_r($matches[1]); // for no php tags 
```

另一种选择是检查`<?`(space) 的速记 php 语句。您可以包含一个空格 ( `\s`) 来检查这一点：

```
preg_match_all("/<\?+(php|=|\s)(.*?)\?>/",$string,$matches); 
```

我想这取决于你想要的“严格”程度。

**Update2：** [MikeM](https://stackoverflow.com/users/1565512/mikem)确实提出了一个很好的观点，即注意换行符。您可能会遇到标签运行到下一行的实例：

```
<?php 
echo $user_name; 
?> 
```

这可以通过使用`s`修饰符来轻松解决`skip linbreaks`：

```
preg_match_all("/<\?+(php|=|\s)(.*?)\?>/s",$string,$matches); 
```

# android - Android ADT 21 NoClassDefFoundError

> ID：15821772
> 
> 赞同：0
> 
> 时间：2013-04-04T21:10:22.043
> 
> 标签：android, salesforce

我正在使用 Salesforce SOAP API 来做一个简单的登录和注销程序。我遵循[http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_calls_login.htm](http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_calls_login.htm)上的示例代码。

此代码在桌面上运行良好。

然后，我使用`sforce-client.jar`基于我的 WSDL 文件和`wsc.jar`.

但是，当我运行它时，出现以下错误，

> 找不到类“com.sforce.soap.enterprise.EnterpriseConnection”

从方法引用`salesforceAccess.SalesforceAccess.login`

您知道是什么原因造成的以及如何解决吗？

十分感谢你的帮助。

艾达

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-05T19:57:48.923

您是否将 jar 文件添加到“libs”目录并选中属性下的“订购和导出”复选框？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T23:13:10.573

如果您遵循从 WSDL 构建 jar 的默认说明，则需要将生成的 jar 和用于生成 jar 的 wsc.jar 添加到您的 android libs 文件夹中。从错误中听起来您缺少用于生成 jar 的 wsc.jar。或者，您可以`-Dstandalone-jar=true`在生成 jar 时将其设置为选项，然后所有内容都将在该生成的 jar 中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-06T07:20:29.343

最后，我解决了这个问题！

步骤是， 1\. 从 github.com/forcedotcom/wsc 构建正确的 wsc-xxx.jar 文件（谢谢，Superfell！） 2\. 使用上面的 wsc-xxx.jar 从 wsdl 生成 jar 文件。注意：使用 jdk1.6 生成目标 1.6 jar。（或任何与 Android SDK 级别匹配的东西！！） 3\. 将 jar 导入 Android 项目。

我被卡住了，因为我使用 jdk1.7 来生成 jar 文件。但是，就像这个线程（[Android emulator crash: "Dx bad class file magic" / ClassNotFoundException on startup?](https://stackoverflow.com/questions/8748977/android-emulator-crash-dx-bad-class-file-magic-classnotfoundexception-on-st)）所说，Android SDK 级别为 1.6（我尝试更改为 1.7，项目将无法编译） . 因此，wsdl生成的jar文件将无法打包进去！

eclipse 和 ADT 没有给我任何警告或错误告诉我。我必须从命令行构建 Android 项目（请参阅[http://randomsamples.info/blog/phil/android-adt-2101-javalangnoclassdeffounderror-rdimen](http://randomsamples.info/blog/phil/android-adt-2101-javalangnoclassdeffounderror-rdimen)）并注意到警告，

```
[dx] trouble processing:
       [dx] bad class file magic (cafebabe) or version (0033.0000)
       [dx] ...while parsing com/sforce/soap/enterprise/EnterpriseConnection.cla
ss
       [dx] ...while processing com/sforce/soap/enterprise/EnterpriseConnection. class 
```

什么过程！！

# c# - 如何在内存缓存中创建缓存/交换/

> ID：15821777
> 
> 赞同：1
> 
> 时间：2013-04-04T21:10:29.833
> 
> 标签：c#, windows, caching

我想实现[FancyCache](http://www.romexsoftware.com/en-us/fancy-cache/)或[SuperCache 之](http://www.superspeed.com/desktop/supercache.php)类的东西。

该软件创建一个交换文件。磁盘 IO 是瓶颈。我需要在 RAM 中有一些文件，因为我需要它们快速。

我不需要完整的文件，只需要一些块。我没有将整个文件放在 RAM 磁盘中，因为它大约 40GB。但是这个文件有一些块需要在内存中。

我提到的软件使用最常见的文件来执行此操作。但我只需要用一个文件来做。

这适用于虚拟化环境。

您是否有关于如何创建这种模拟 Windows 交换文件的缓存的指南？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:11:52.223

您正在描述*持久的内存映射文件*。该文件将被映射到您的虚拟内存中，由操作系统从物理驱动器读取和缓存项目。

在 MSDN 上阅读更多内容：[内存映射文件](http://msdn.microsoft.com/en-us/library/dd997372.aspx)

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-04T21:50:21.770

我要做的是从这样的课程开始：

```
public class SwapData
{
    public const int BlockSize = 1024;

    private int HotCount {
        get;
        set;
    }

    private long Offset {
        get;
        set;
    }

    private byte[] Data {
        get;
        set;
    }

    private string FileName {
        get;
        set;
    }
}

public class SwapFile
{
    private List<SwapData> _swapData;

    public string SwapFileName
    { get; set; }

    public byte[] ReadData(string fileName, long offset, int numBytes)
    {
        if (!Cached(fileName, offset))
        {
            return StoreCache(fileName, offset);
        } else return Cache(fileName, offset, numBytes);
    }

    private bool Cached(string fileName, long offset)
    {
        return _swapData.Any(z => z.FileName.ToLower().Equals(fileName.ToLower()) && z.Offset >= offset);
    }

    private byte[] StoreCache(string fileName, long offset)
    {
        using (var bw = new BinaryReader(File.Open(fileName, FileMode.Open))) 
        {
            bw.BaseStream.Seek(offset, SeekOrigin.Begin);
            var sd = new SwapData();
            sd.HotCount = 0;
            sd.Office = offset;
            sd.FileName = fileName;
            sd.Data = bw.ReadBytes(sd.BlockSize);
            _swapData.Add(sd);
            return sd.Data;
        }
    }

    private byte[] Cache(string fileName, long offset, int numBytes)
    {
        byte[] data = _swapData.FirstOrDefault(z => z.FileName.ToLower().Equals(fileName.ToLower()) && z.Offset >= offset).Data;

        byte[] target = new byte[numBytes];
        Array.Copy(data,target,numBytes);
        return target;
    } 
```

我还没有测试过，但它会像这样^^^

# c# - 不能在“SetterBaseCollection”中使用“MultiBinding”

> ID：15821781
> 
> 赞同：1
> 
> 时间：2013-04-04T21:10:43.423
> 
> 标签：c#, wpf, datatemplate

我刚开始在 C# 中编程并收到以下错误消息“不能在 'SetterBaseCollection' 集合中使用'MultiBinding'。只能在 DependencyObject 的 DependencyProperty 上设置'MultiBinding'”。我的想法是禁用一些与给转换器的输入值相关的组合框。稍后在 xaml 文件中使用相同的转换器并且没有错误..

```
 <DataTemplate x:Key="ComboBoxDirectionCellDataTemplate">
         <Canvas>
            <ComboBox Name="DirectionBi" ItemsSource="{Binding Source={StaticResource DirectionBiList}}" SelectedItem="{Binding Direction, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Background="#FFCDCDCD" />
            <ComboBox Name="DirectionOut" ItemsSource="{Binding Source={StaticResource DirectionOutList}}" SelectedItem="{Binding PinFunctionOptions[SelectedPinFunctionIdx].SupportedDirections, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Background="#FFCDCDCD" />
            <ComboBox Name="DirectionIn" ItemsSource="{Binding Source={StaticResource DirectionOutList}}" SelectedItem="{Binding PinFunctionOptions[SelectedPinFunctionIdx].SupportedDirections, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Background="#FFCDCDCD" />
        </Canvas>
        <DataTemplate.Triggers>
            <DataTrigger Value="In">
                <MultiBinding Converter="{StaticResource FunctionToGroupConverter}">
                    <Binding Path="PinFunctionOptions"/>
                    <Binding Path="SelectedPinFunctionIdx"/>
                </MultiBinding>
                <Setter TargetName="DirectionBi" Property="Visibility" Value="Hidden"/> 
```

感谢帮助！！！！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:40:56.970

我可能是错的-我目前无法检查...

我想你想要的是以下......

```
<DataTrigger ...>
<DataTrigger.Binding>
    <MultiBinding Converter="{StaticResource FunctionToGroupConverter}">
        <Binding Path="PinFunctionOptions"/>
        <Binding Path="SelectedPinFunctionIdx"/>
    </MultiBinding>
</DataTrigger.Binding>
</DataTrigger> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-04T21:14:44.160

`DataTemplate.Triggers`期待一个集合，`Setter`你为什么要`MultiBinding`在里面放一个？

你得到的例外是这个的结果。

我不完全确定您正在尝试什么，`MultiBinding`但您可能会通过在各个元素上单独执行绑定来做得更好。

# mysql - mysql 在插入多对多时触发

> ID：15821782
> 
> 赞同：2
> 
> 时间：2013-04-04T21:10:46.183
> 
> 标签：mysql, triggers, insert, many-to-many

我有两张具有多对多关系的表。这些表是

```
table user
idUser
name

table right
idRight
type

table user_has_right
idUser
idRight 
```

当我插入一个具有我希望他拥有的权限的用户时，显然中间表（user_has_right）也必须有一些插入。假设我想插入 id = 1 和 name = 'test' 和 right = 'boss' 的用户，其中 boss 已经是 id = 1 表中的一行。中间表必须插入 (1,1)。我知道如何以编程方式执行此操作，但这可以通过插入触发器来完成吗？

谢谢你。

//我面临的问题是如何找到类型'boss'的idRight。也许是触发器内的嵌套选择？

//这个任务甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-17T04:40:03.470

我遇到了这个老问题。如果您仍然对答案感兴趣，那么这里就是

```
CREATE TRIGGER tg_user_insert
AFTER INSERT ON `user`
FOR EACH ROW
  INSERT INTO user_has_right (idUser, idRight)
  SELECT NEW.idUser, idRight
    FROM `right`
   WHERE type = 'boss'; 
```

这是**[SQLFiddle](http://sqlfiddle.com/#!2/4a847/3)**演示

# python - 使用 Beautiful Soup 进行 Html 解析返回空列表

> ID：15821789
> 
> 赞同：2
> 
> 时间：2013-04-04T21:11:24.440
> 
> 标签：python, django, parsing, beautifulsoup

我现在知道为什么这段代码不适用于这个特定的站点。在其他情况下，它工作正常。

```
 url = "http://www.i-apteka.pl/search.php?node=443&counter=all"
    content = requests.get(url).text
    soup = BeautifulSoup(content)

    links = soup.find_all("a", class_="n63009_prod_link")
    print links 
```

在这种情况下，它打印“[]”，但显然有一些链接。任何想法？：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:53:43.343

您在使用的任何解析器中都发现了一个错误。

我不知道您使用的是哪个解析器，但我知道这一点：

Python 2.7.2（来自 Apple）、BS 4.1.3（来自 pip）、libxml2 2.9.0（来自 Homebrew）、lxml 3.1.0（来自 pip）得到与您完全相同的错误。我尝试的所有其他东西——包括与上面相同的东西，除了 libxml2 2.7.8（来自 Apple）——都有效。如果您不指定其他任何内容，并且`lxml`是 BS 将首先尝试的默认设置（至少从 4.1.3 开始）。我还看到了 libxml2 2.9.0 的其他意外错误（其中大部分已在主干上修复，但尚未发布 2.9.1）。

因此，如果这是您的问题，您可能希望降级到 2.8.0 和/或从树顶构建它。

但如果不是......它绝对适用于我的 2.7.2 和 stdlib `html.parser`，并且在聊天中你测试了与 2.7.1 相同的想法。虽然`html.parser`（尤其是在 2.7.3 之前）缓慢而脆弱，但对您来说似乎已经足够了。因此，最简单的解决方案是这样做：

```
soup = BeautifulSoup(content, 'html.parser') 
```

… 而不是让它选择它最喜欢的解析器。

有关详细信息，请参阅[指定要使用的解析器](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#specifying-the-parser-to-use)（以及上方和下方的部分）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-24T19:35:48.563

我遇到了同样的问题，在本地 Beautiful Soup 正在工作并且在我的 ubuntu 服务器上一直返回一个空列表。我在链接 [1] 之后尝试了许多解析器并尝试了许多依赖项

最后对我有用的是：

*   删除漂亮的肥皂安装
*   删除其所有依赖项（由 apt-get install python-bs4 指向）
*   使用下面的命令再次安装它

命令：

```
sudo apt-get install python-bs4

pip install beautifulsoup4 
```

我正在使用以下代码：

```
soup = BeautifulSoup(my_html_content, 'html.parser') 
```

[ [http://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-a-parser][1]](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#installing-a-parser][1])

# r - 股票的月末贝塔计算

> ID：15821791
> 
> 赞同：0
> 
> 时间：2013-04-04T21:11:30.033
> 
> 标签：r

我有大量数据的市场回报和股票回报，我试图在每个月末计算股票的贝塔。

例如，我有以下数据：

```
dateoffset  relian       niftyreturns
20000103    0.034484    0.075484
20000104    0.019205    0.029205
20000105    -1.026179   -0.026179
20000106    0.413661    0.013661
20000107    -0.002658   -0.002658
20000110    0.01218     0.01248
20000111    -0.037019   -0.037019
20000112    0.033259    0.133259
20000113    -0.002093   -0.002093
20000114    0.000833    0.000833 
```

假设我需要计算`var(niftyreturns)`日期`20000103-20000131`并再次计算`var(niftyreturns)`日期`20000201-20000229`等等。高度赞赏所有帮助..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:42:58.050

假设这是一个`data.table`：

```
dt[, list(variance = var(niftyreturns)),
     by = list(year_month = as.integer(dateoffset/100))] 
```

# android - 是否可以在 Galaxy Tab 或 ipad 等移动设备上安装 xampp？

> ID：15821792
> 
> 赞同：9
> 
> 时间：2013-04-04T21:11:39.443
> 
> 标签：android, xampp, tablet

想知道您是否可以在三星 Galaxy Tab 10.1 或 ipad 上安装 xampp 和 notepad++？没有试过运气，有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-04T21:17:49.143

您可能正在寻找[Paw server](http://paw-android.fun2code.de/)。

Paw server 是一个用于 android 的 Web 服务器，它也有一个 PHP 插件。对于开发，有很多可用的选项，只需搜索[Google Play](https://play.google.com/store/search?q=PHP%20editor&c=apps)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-09-27T16:35:32.780

我使用 BitWeb 服务器，它有点像，但使用的是 lighttpd 而不是 apache。我什至得到了一个 Zend 实现在它下工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-03-06T19:46:05.347

我可以推荐 Palapa Server.. Mysql, Php 并且效果很好.. 免费，而且非常可定制。

# c# - 实现逻辑以提供基于角色的视图数据

> ID：15821796
> 
> 赞同：0
> 
> 时间：2013-04-04T21:11:52.753
> 
> 标签：c#, asp.net-mvc

在过去的几天里，我一直在思考这个问题，并且想知道其他人对此有何看法。我想实现一些基于用户所属角色的内容。我们的应用程序使用 HTTP 标头来接收角色信息。在 MVC 中，我应该让控制器处理角色检测，然后将布尔值传递给视图模型。

视图模型：

```
public class ProductViewModel
{
    public Product MyProduct { get; set; }
    public bool IsAdmin { get; set; }
    public bool IsSuperAdmin { get; set; }
} 
```

控制器：

```
public class ProductController : Controller
{
    public ActionResult Info()
    {
        //get product information here

        ProductViewModel pvm = new pvm();
        pvm.Product = theProduct;
        pvm.IsAdmin = checkAdminAccess(); //This would return a bool if they had access
        pvm.IsSuperAdmin = checkSuperAdminAccess();//This would return a bool if they had access

        return View(pvm);
    }
} 
```

看法：

```
@if(Model.IsAdmin == true || Model.IsSuperAdmin == true)
{
    //Render Content for admin (Either directly or via Partial View)
}
@if(Model.IsSuperAdmin == true)
{
    //Render Superadmin content (Either directly or via Partial View)
}
//Implement other Product Stuff Here 
```

或者创建一个局部视图并处理视图中的逻辑会更好。这似乎涉及的工作较少。

```
@if (Request.Headers.AllKeys.Contains("role")){
    ViewBag.Role = Request.Headers["role"].ToString();
}
...
@if(ViewBag.Role == "Admin" || ViewBag.Role == "SuperAdmin")
{
    @Html.Partial("AdminPartial")//Or Render Code Directly?
    if(ViewBag.Role == "SuperAdmin")
    {
        @Html.Partial("SuperAdminPartial")//Or Render Code Directly?
    }
}
//Implement other Product Stuff Here 
```

以一种或另一种方式做这件事有什么额外的好处，我应该直接渲染内容还是使用部分视图，还是没关系？还是我错过了其他应该完成的方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T00:39:43.110

您可以使用 AuthorizeAttribute 来限制对控制器操作的访问/使用：

```
[Authorize(Roles = "Admin, Customer")]
public class ProductController : Controller
{
    public ActionResult Info()
    {
        //get product information here

        ProductViewModel pvm = new pvm();

        return View(pvm);
    }

[Authorize(Roles = "Admin")]
public ActionResult EditInfo()
    {
        //get product information here

        EditProductViewModel epvm = new epvm();

        return View(epvm);
    }
} 
```

这是限制调用者访问操作方法的最基本方法。但是，对于具有许多角色/控制器/操作的大型应用程序，注释和跟踪所有属性可能会变得很困难。

有一个名为[Fluent Security](http://www.fluentsecurity.net/)的产品，它允许在一个中心位置指定安全性，并摆脱前面提到的问题。

还有单一责任原则的问题，看看[达林](https://stackoverflow.com/questions/14259063/user-isinrole-work-in-mvc-c-sharp-class/14259214#14259214)对这个问题的回答——他解释得很好。

# java - 在 Android 中显示当前连接的 SSID

> ID：15821797
> 
> 赞同：0
> 
> 时间：2013-04-04T21:11:56.673
> 
> 标签：java, android, textview, wifi, ssid

我想捕获当前连接的 SSID - 并将其显示在 TextView 中 - 如何做到这一点？

据我所知，我需要使用以下内容：

```
 public void run() {
        WifiManager wifi = (WifiManager) getSystemService(Context.WIFI_SERVICE);
        WifiInfo info = wifi.getConnectionInfo();
        String nameEt = info.getSSID();
    } 
```

但是当我尝试实现它时 - 我似乎无法在屏幕上显示它。

爪哇：

```
import android.app.Activity;
import android.app.AlertDialog;
import android.content.Context;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.AsyncTask;
import android.os.Bundle;
import android.view.ViewGroup;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.FrameLayout;
import android.widget.TextView;
import android.widget.TimePicker;
import java.text.DecimalFormat;

public class AddEditDevice extends Activity {

    private long rowID;
    private EditText nameEt;
    private EditText capEt;
    private EditText codeEt;
    private TimePicker timeEt;
    private TextView ssid;

    // DecimalFormat df = new DecimalFormat ("00");
    // public String minutes = df.format(min);
    // @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.add_country);
        nameEt = (EditText) findViewById(R.id.nameEdit);
        capEt = (EditText) findViewById(R.id.capEdit);
        codeEt = (EditText) findViewById(R.id.codeEdit);
        timeEt = (TimePicker) findViewById(R.id.timeEdit);
        Bundle extras = getIntent().getExtras();
        if (extras != null) {
            rowID = extras.getLong("row_id");
            nameEt.setText(extras.getString("name"));
            capEt.setText(extras.getString("cap"));
            codeEt.setText(extras.getString("code"));
            String time = extras.getString("time");
            String[] parts = time.split(":");
            timeEt.setCurrentHour(Integer.valueOf(parts[0]));
            timeEt.setCurrentMinute(Integer.valueOf(parts[1]));
            timeEt.setIs24HourView(false);
        }
        Button saveButton = (Button) findViewById(R.id.saveBtn);
        saveButton.setOnClickListener(new OnClickListener() {

            public void onClick(View v) {
                if (nameEt.getText().length() != 0) {
                    AsyncTask<Object, Object, Object> saveContactTask = 
                            new AsyncTask<Object, Object, Object>() {

                        @Override
                        protected Object doInBackground(Object... params) {
                            saveContact();
                            return null;
                        }

                        @Override
                        protected void onPostExecute(Object result) {
                            finish();
                        }
                    };
                    saveContactTask.execute((Object[]) null);
                } else {
                    AlertDialog.Builder alert = new AlertDialog.Builder(
                        AddEditDevice.this);
                    alert.setTitle(R.string.errorTitle);
                    alert.setMessage(R.string.errorMessage);
                    alert.setPositiveButton(R.string.errorButton, null);
                    alert.show();
                }
            }
        });
    }

    public void run() {
        WifiManager wifi = (WifiManager) getSystemService(Context.WIFI_SERVICE);
        WifiInfo info = wifi.getConnectionInfo();
        String ssid = info.getSSID();
        TextView ssidTextView = (TextView) findViewById(R.id.wifiSSID);
        ssidTextView.setText(ssid);
    }

    private void saveContact() {
        DatabaseConnector dbConnector = new DatabaseConnector(this);
        if (getIntent().getExtras() == null) {
            dbConnector.insertContact(nameEt.getText().toString(), capEt
                .getText().toString(), timeEt.getCurrentHour().toString() + ":"
                + timeEt.getCurrentMinute().toString(), codeEt.getText()
                .toString());
        } else {
            dbConnector.updateContact(rowID, nameEt.getText().toString(), capEt
                .getText().toString(), timeEt.getCurrentHour().toString() + ":"
                + timeEt.getCurrentMinute().toString(), codeEt.getText()
                .toString());
        }
    }
} 
```

XML:

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_weight="1" >

    <LinearLayout
        android:id="@+id/linearLayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical"
        android:padding="5dp" >

        <EditText
            android:id="@+id/nameEdit"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:ems="10"
            android:hint="@string/name_hint"
            android:imeOptions="actionNext"
            android:inputType="textPersonName|textCapWords" />

        <TextView
            android:id="@+id/wifiSSID"
            style="@style/StyleText"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />

        <EditText
            android:id="@+id/capEdit"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:ems="10"
            android:hint="@string/cap_hint"
            android:imeOptions="actionNext"
            android:inputType="textPersonName|textCapWords" >

            <requestFocus />
        </EditText>

        <TextView
            android:id="@+id/textView3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Data Limit"
            android:textAppearance="?android:textAppearanceMedium"
            android:textColor="#ffffff" />

        <SeekBar
            android:id="@+id/seekBar1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="left"
                android:text="Unlimited Data"
                android:textColor="#ffffff" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="right"
                android:text="10MB"
                android:textColor="#ffffff" />
        </LinearLayout>

        <TextView
            android:id="@+id/textView3"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:text="Bandwidth Limit"
            android:textAppearance="?android:textAppearanceMedium"
            android:textColor="#ffffff" />

        <SeekBar
            android:id="@+id/seekBar1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="left"
                android:text="Unlimited Bandwidth"
                android:textColor="#ffffff" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="right"
                android:text="10kbs"
                android:textColor="#ffffff" />
        </LinearLayout>

        <EditText
            android:id="@+id/codeEdit"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_weight="1.0"
            android:ems="10"
            android:gravity="center"
            android:hint="@string/code_hint"
            android:imeOptions="actionNext"
            android:inputType="textUri"
            android:lines="1" />

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="Parental Controls"
                android:textColor="#ffffff" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="Block Streaming"
                android:textColor="#ffffff" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="horizontal" >

            <ToggleButton
                android:id="@+id/ToggleButton03"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="ToggleButton" />

            <ToggleButton
                android:id="@+id/ToggleButton03"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="ToggleButton" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:orientation="horizontal" >

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="Block File Type/Size"
                android:textColor="#ffffff" />

            <TextView
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="Banned Music/Video"
                android:textColor="#ffffff" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="fill_parent"
            android:layout_height="fill_parent"
            android:orientation="horizontal" >

            <ToggleButton
                android:id="@+id/ToggleButton02"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="ToggleButton" />

            <ToggleButton
                android:id="@+id/ToggleButton02"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1.0"
                android:gravity="center"
                android:text="ToggleButton" />
        </LinearLayout>

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:gravity="center"
            android:orientation="horizontal" >
        </LinearLayout>

        <TextView
            android:id="@+id/TextView02"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:textAppearance="?android:textAppearanceSmall" />

        <TextView
            android:id="@+id/TextView02"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center"
            android:layout_marginBottom="8dp"
            android:layout_weight="1.0"
            android:text="WiFi Time Limit"
            android:textAppearance="?android:textAppearanceMedium"
            android:textColor="#ffffff" />

        <TimePicker
            android:id="@+id/timeEdit"
            android:layout_width="286dp"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_weight="1.0" />

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="left"
            android:orientation="horizontal" >
        </LinearLayout>

        <Button
            android:id="@+id/saveBtn"
            android:layout_width="199dp"
            android:layout_height="wrap_content"
            android:layout_gravity="center_horizontal"
            android:layout_marginTop="15dp"
            android:text="@string/save_btn" />
    </LinearLayout>

</ScrollView> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:15:59.980

您没有从任何地方调用 run() ，并且该方法也没有尝试更新文本视图。尝试在您的 run 方法中执行此操作。

```
TextView ssidTextView = (TextView) findViewById(R.id.<your_textview_id>);
ssidTextView.setText(nameEt); 
```

然后确保在要更新 TextView 中的 ssid 时调用 run()。

# c# - 强制转换 SQL 返回

> ID：15821799
> 
> 赞同：-6
> 
> 时间：2013-04-04T21:12:16.410
> 
> 标签：c#, sql, casting

我正在尝试转换从 SQL 查询中返回的内容，但出现错误。

```
SqlCommand myCommand = "Select * from DB", xavierConnection);
SqlDataReader reader = null;
reader = myCommand.ExecuteReader();
while (reader.Read())
{
    _accountNumber = (int)reader["Account Number"];
    _callReportCode = (string)reader["Call Report Code"];
    _GLbalance = (double)reader["Bank Owned Principal Assets"];
} 
```

我应该改变什么才能使演员成功？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:14:00.907

演员阵容失败的是哪一行？如果它在 int 或 double 上失败，请检查数据库字段是否不可为空。如果是，请尝试分别转换为 (int?) 和 (double?)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:14:10.560

改变：

```
_accountNumber = (int)reader["Account Number"];
_callReportCode = (string)reader["Call Report Code"];
_GLbalance = (double)reader["Bank Owned Principal Assets"]; 
```

到：

```
_accountNumber = int.Parse(reader["AccountNumber"].ToString());
_callReportCode = reader["CallReportCode"].ToString());
_GLbalance = double.Parse(reader["BankOwnedPrincipalAssets"].ToString()); 
```

请注意，如果来自数据库的任何值是`null`它们将引发运行时异常。我留给你处理...

# highcharts - HighCharts 3.0.0 动画

> ID：15821803
> 
> 赞同：2
> 
> 时间：2013-04-04T21:12:25.730
> 
> 标签：highcharts

我今天升级到 HighCharts 3.0.0 版，但在动画方面遇到了一些问题。我正在开发的 Web 应用程序是为 IE 9 构建的。我在 IE 中没有动画，但是在运行 chrome 时，动画仍然会为我的应用程序呈现。但是，我可以在官方网站上查看带有完整动画的 IE 9 中的 highcharts 演示。

```
 chartVar = document.createElement('div');
        chartVar.setAttribute('id', 'container');
        chartVar.style.width = '400px';
        chartVar.style.height = '200px';
        document.getElementById('quad0').appendChild(chartVar);
        $(function () {
            $('#container').highcharts({
                chart: {
                },
                xAxis: {
                    categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                },

                series: [{
                    data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]        
                }]
            });
        }); 
```

# cuda - 使用易失性共享内存的 CUDA 原子函数

> ID：15821805
> 
> 赞同：0
> 
> 时间：2013-04-04T21:12:39.410
> 
> 标签：cuda, atomic, shared, volatile

*我有一个 CUDA 内核，需要在易失性*共享整数内存上使用原子函数。但是，当我尝试将共享内存声明为 volatile 并在原子函数中使用它时，我收到一条错误消息。

下面是一些重现错误的极简代码。请注意，下面的内核什么都不做，并且严重滥用了为什么您想将共享内存声明为易失性（甚至根本不使用共享内存）。但它*确实*重现了错误。

该代码在共享内存上使用原子函数，因此，要运行它，您可能需要使用“arch12”或更高版本进行编译（在 Visual Studio 2010 中，右键单击您的项目并转到“属性 -> 配置属性 -> CUDA C /C++ -> Device”并在“代码生成”行中输入“compute_12,sm_12”）。否则代码应按原样编译。

```
#include <cstdlib>
#include <cuda_runtime.h>

static int const X_THRDS_PER_BLK = 32;
static int const Y_THRDS_PER_BLK = 8;

__global__ void KernelWithSharedMemoryAndAtomicFunction(int * d_array, int numTotX, int numTotY)
{
              __shared__ int s_blk[Y_THRDS_PER_BLK][X_THRDS_PER_BLK]; // compiles
   //volatile __shared__ int s_blk[Y_THRDS_PER_BLK][X_THRDS_PER_BLK]; // will not compile

   int tx = threadIdx.x;
   int ty = threadIdx.y;

   int mx = blockIdx.x*blockDim.x + threadIdx.x;
   int my = blockIdx.y*blockDim.y + threadIdx.y;
   int mi = my*numTotX + mx;

   if (mx < numTotX && my < numTotY)
   {
      s_blk[ty][tx] = d_array[mi];

      __syncthreads();

      atomicMin(&s_blk[ty][tx], 4); // will compile with volatile shared memory only if this line is commented out

      __syncthreads();

      d_array[mi] = s_blk[ty][tx];
   }
}

int main(void)
{
   // Declare and initialize some array on host
   int const NUM_TOT_X = 4*X_THRDS_PER_BLK;
   int const NUM_TOT_Y = 6*Y_THRDS_PER_BLK;

   int * h_array = (int *)malloc(NUM_TOT_X*NUM_TOT_Y*sizeof(int));

   for (int i = 0; i < NUM_TOT_X*NUM_TOT_Y; ++i) h_array[i] = i;

   // Copy array to device
   int * d_array;
   cudaMalloc((void **)&d_array, NUM_TOT_X*NUM_TOT_Y*sizeof(int));

   cudaMemcpy(d_array, h_array, NUM_TOT_X*NUM_TOT_Y*sizeof(int), cudaMemcpyHostToDevice);

   // Declare block and thread variables
   dim3 thdsPerBlk;
   dim3 blks;

   thdsPerBlk.x = X_THRDS_PER_BLK;
   thdsPerBlk.y = Y_THRDS_PER_BLK;
   thdsPerBlk.z = 1;

   blks.x = (NUM_TOT_X + X_THRDS_PER_BLK - 1)/X_THRDS_PER_BLK;
   blks.y = (NUM_TOT_Y + Y_THRDS_PER_BLK - 1)/Y_THRDS_PER_BLK;
   blks.z = 1;

   // Run kernel
   KernelWithSharedMemoryAndAtomicFunction<<<blks, thdsPerBlk>>>(d_array, NUM_TOT_X, NUM_TOT_Y);

   // Cleanup
   free    (h_array);
   cudaFree(d_array);

   return 0;
} 
```

无论如何，如果您注释掉内核顶部的“s_blk”声明并取消注释紧随其后的注释掉的声明，那么您应该得到以下错误：

```
error : no instance of overloaded function "atomicMin" matches the argument list 
```

我不明白为什么将共享内存声明为 volatile 会影响其类型，因为（我认为）此错误消息表明，也不明白为什么它不能与原子操作一起使用。

任何人都可以提供任何见解吗？

谢谢，

亚伦

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:39:50.950

只需替换
`atomicMin(&s_blk[ty][tx], 4);`
为
`atomicMin((int *)&s_blk[ty][tx], 4);`.

它进行类型转换`&s_blk[ty][tx]`，因此它与`atomicMin(..)`.

# android - OpenGL ES 中圆角矩形的最佳实践

> ID：15821806
> 
> 赞同：5
> 
> 时间：2013-04-04T21:12:41.187
> 
> 标签：android, graphics, opengl-es, rounded-corners, nine-patch

使用 OpenGL ES，圆角矩形似乎有两个可行的选项：

1.  使用 trig 手动绘制形状。（这就是我目前正在做的事情。）
2.  使用适当缩放的纹理或纹理组，例如[9-Slice Scaling](http://www.centigrade.de/en/blog/article/modern-user-interface-design-tools-part-2-graphical-approach-of-gui-design-tools/ "9 切片缩放")

第一个选项的问题是抗锯齿不是免费的，如果您的目标是与各种设备兼容，则不能指望 OpenGL 抗锯齿提示在硬件上实际工作。所以你留下了看起来不连贯的圆角矩形，特别是对于小的圆角矩形，以及进行另一个顶点数组绘制调用的性能开销。我想摆脱这个

第二个选项（9-Slice 或 9-Patch）似乎是 UI 圆角矩形元素的首选方法，但令人惊讶的是，关于在 OpenGL ES 中实现 9-patching 的信息很少。

我想要的是：一种在 OpenGL ES 中渲染具有可调节边框宽度、边框颜色和填充颜色的抗锯齿圆角矩形的有效策略。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-04-17T19:27:05.247

您想要的本质上是一种称为*Edge Anti-Aliasing*的技术。

在这个答案中描述得很好：[OpenGL ES iPhone - drawing anti aliased lines](https://stackoverflow.com/questions/1813035/opengl-es-iphone-drawing-anti-aliased-lines)

只需在矩形的最外边界应用透明顶点即可。

# sql - 按列和最大日期分组时如何选择单行？

> ID：15821811
> 
> 赞同：5
> 
> 时间：2013-04-04T21:12:57.747
> 
> 标签：sql, oracle

我有以下要过滤的数据，因此我仅根据第一列的分组得到一行并选择最大日期

co2 包含唯一值

```
col1 | col2 | date

 1   |  123 | 2013
 1   |  124 | 2012
 1   |  125 | 2014
 2   |  213 | 2011
 2   |  214 | 2015
 2   |  215 | 2018 
```

所以我想要的结果是：

```
 1   |  125 | 2014
 2   |  215 | 2018 
```

我尝试使用我在这里找到的一些示例（如下）以及其他 group by / distinct / max(date) 但没有运气

```
select t.*
from (select t.*,
             row_number() over (partition by col1, col2 order by date desc) as seqnum
      from t
     ) t
where seqnum = 1 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:14:42.557

将分区更改`row_number()`为仅分区，`col1`但保持顺序`date desc`：

```
select col1, col2, date
from 
(
  select col1, col2, date,
    row_number() over (partition by col1 
                       order by date desc) as rn
  from yourtable
) x
where rn = 1 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!4/87390/2)。

由于您同时进行了分区，`col1`并且`col2`您获得了每一行的唯一值。所以它不会返回具有最大日期的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:21:43.477

我更喜欢 bluefeet 的方法，但这里是使用 MAX 的等效方法：

```
SELECT t.col1, t.col2, t.date
FROM yourtable t
    JOIN (
        SELECT col1, MAX(date) maxDate
        FROM yourtable
        GROUP BY col1
    ) t2 on t.col1 = t2.col1 AND t.date = t2.maxDate 
```

[SQL Fiddle Demo](http://www.sqlfiddle.com/#!4/87390/9)（借自其他帖子）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T05:19:42.643

```
 Select * from yourtable where date in 
(select max(date) from tab group by col1); 
```

# ruby-on-rails - 页面中的语法错误#home

> ID：15821813
> 
> 赞同：0
> 
> 时间：2013-04-04T21:13:10.547
> 
> 标签：ruby-on-rails, ruby, localhost, syntax-error

*当我保存 Sublime 文本并刷新 localhost:3000 时，我不断收到此错误。我该怎么办？

* * *

显示 /Users/Matt/code/omrails/app/views/layouts/application.html.erb 其中**第 21**行提出：

```
/Users/Matt/code/omrails/app/views/layouts/application.html.erb:21: syntax error, unexpected keyword_ensure, expecting keyword_end
/Users/Matt/code/omrails/app/views/layouts/application.html.erb:23: syntax error, unexpected $end, expecting keyword_end 
```

提取的源代码（在**#21**行附近）：

```
18:         </div>
19:     </body>
20: </html> 
```

模板包含的痕迹：app/views/layouts/application.html.erb

* * *

这就是我的*application.html.erb*文件的样子：

```
<!DOCTYPE html>
<html>
<head>
  <title>One Month Rails</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>
<body>
    <%= render "layouts/header" %>

    <div class="container">
        <% flash.each do |name, msg| %>
            <%= content_tag(:div, msg, class: "alert alert-#{name}") %>
        <%= yield %>

        <%= render "layouts/footer" %>
    </div>
</body> 
```

* * *

# 我做错什么了？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:15:06.320

```
<% flash.each do |name, msg| %>
    <%= content_tag(:div, msg, class: "alert alert-#{name}") %>
<% end %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:15:36.563

你忘`end`了`flash.each do`

即右视图是下一个

```
<!DOCTYPE html>
<html>
<head>
  <title>One Month Rails</title>
  <%= stylesheet_link_tag    "application", :media => "all" %>
  <%= javascript_include_tag "application" %>
  <%= csrf_meta_tags %>
</head>
<body>
    <%= render "layouts/header" %>

    <div class="container">
        <% flash.each do |name, msg| %>
            <%= content_tag(:div, msg, class: "alert alert-#{name}") %>
        <% end %>
        <%= yield %>

        <%= render "layouts/footer" %>
    </div>
</body> 
```

# laravel - Laravel 如何创建数据透视表？

> ID：15821822
> 
> 赞同：50
> 
> 时间：2013-04-04T21:13:43.917
> 
> 标签：laravel, pivot-table, laravel-4, eloquent

[在 Laravel 4 中，当使用4.2 文档](https://laravel.com/docs/4.2/eloquent#many-to-many)中描述的多对多关系时，我如何才能真正让 Laravel 为我创建数据透视表？

我需要在我的迁移中为所涉及的两个模型添加一些东西吗？我需要手动为数据透视表创建迁移吗？或者 Laravel 是如何知道创建数据透视表的？

到目前为止，我所做的只是将`belongsToMany`信息添加到两个各自的模型中，即

```
class User extends Eloquent 
{
    public function roles()
    {
         return $this->belongsToMany('Role');
     }
 } 
```

但是，这不会触发数据透视表的创建。我错过了什么步骤？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-04-05T12:30:27.407

看起来好像确实需要手动创建数据透视表（即 Laravel 不会自动执行此操作）。这是如何做到的：

1.) 创建一个新的迁移，使用*按字母顺序排列的**单数*表名（默认）：

 *```
php artisan make:migration create_alpha_beta_table --create --table=alpha_beta 
```

2.) 在新创建的迁移中，将 up 函数更改为：

```
public function up()
{
    Schema::create('alpha_beta', function(Blueprint $table)
    {
        $table->increments('id');
        $table->integer('alpha_id');
        $table->integer('beta_id');
    });
} 
```

3.) 如果需要，添加外键约束。（我还没有做到这一点）。

* * *

现在要播种，比如说，alpha 表，使用 beta 中的键，您可以在 AlphaTableSeeder 中执行以下操作：

```
public function run()
{
    DB::table('alpha')->delete();

    Alpha::create( array( 
        'all'           =>  'all',
        'your'          =>  'your',
        'stuff'         =>  'stuff',
    ) )->beta()->attach( $idOfYourBeta );
} 
```

* * *

## 回答 #2

> 赞同：43
> 
> 时间：2014-02-15T16:59:21.990

我使用 Jeffrey Way 的[Laravel-4-Generators](https://github.com/JeffreyWay/Laravel-4-Generators)或[Laravel-5-Generators-Extended](https://github.com/laracasts/Laravel-5-Generators-Extended)。

那么你可以使用这个工匠命令：

```
php artisan generate:pivot table_one table_two 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2013-06-03T06:22:05.707

为了扩展本的答案（我试图编辑它，但评论家说它添加了太多）：

要添加外键约束，请确保 alpha id 是无符号的，alpha_id 在数据透视表中也是无符号的。此迁移将在 Ben 的答案中的 (2) 之后运行，因为它会更改当时创建的表。

```
public function up()
{
    Schema::table('alpha_beta', function(Blueprint $table)
    {
        $table->foreign('alpha_id')->references('id')->on('alpha');
        $table->foreign('beta_id')->references('id')->on('beta');
    });
} 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2016-04-07T07:08:19.520

对于多对多关系，您可以像这样手动创建数据库的迁移文件：

```
use Illuminate\Database\Migrations\Migration;
use Illuminate\Database\Schema\Blueprint;

class CreateAccountTagTable extends Migration
{

    /**
     * Run the migrations.
     *
     * @return void
     */
    public function up()
    {
        Schema::create('account_tag', function (Blueprint $table) {
            // $table->timestamps(); // not required
            // $table->softDeletes(); // not required

            $table->integer('account_id')->unsigned();
            $table->foreign('account_id')->references('id')->on('accounts');

            $table->integer('tag_id')->unsigned()->nullable();
            $table->foreign('tag_id')->references('id')->on('tags');
        });
    }

    /**
     * Reverse the migrations.
     *
     * @return void
     */
    public function down()
    {
        Schema::drop('account_tag');
    }
} 
```

**注意**：如果您`timestamps`在数据透视表上有，您必须`withTimestamps`像这样设置两端的关系：

```
return $this->belongsToMany(\Mega\Modules\Account\Models\Tag::class)->withTimestamps(); 
```

.

```
return $this->belongsToMany(\Mega\Modules\Account\Models\Account::class)->withTimestamps(); 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2019-10-24T11:06:02.607

1.  创建新的迁移：

```
php artisan make:migration create_alpha_beta_table --create=alpha_beta 
```

2.  在新创建的迁移中：

```
public function up() {
    Schema::create('alpha_beta', function(Blueprint $table) {
            $table->increments('id');
            $table->unsignedBigInteger('alpha_id');
            $table->unsignedBigInteger('beta_id');
            // foreign keys
            $table->foreign('alpha_id')->references('id')->on('alphas');
            $table->foreign('beta_id')->references('id')->on('betas');
     });
} 
```

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2021-02-27T08:36:30.650

除了以上所有答案

*   数据透视表不需要 AI 索引。它由其 touple (key1,key2) 唯一定义。
*   主键应该是组合（key1，key2）。好处是 touples 是唯一的，并且所有查询都得到了最佳优化。

所以这里有一个真实的例子：

```
Schema::create('bill_user', function (Blueprint $table) {
    // unsigned is needed for foreign key
    $table->integer('user_id')->unsigned();
    $table->integer('bill_id')->unsigned();

    $table->primary(['user_id', 'bill_id']);

    $table->foreign('user_id')
        ->references('id')->on('users')
        ->onDelete('cascade');

    $table->foreign(bill_id')
        ->references('id')->on('bills')
        ->onDelete('cascade');
}); 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2021-11-04T17:23:55.233

对于最新的 Laravel 版本：

```
composer require --dev laracasts/generators

php artisan make:migration:pivot table1 table2 
```*

# python - 在 h5py 或类似的分层数据库中快速搜索

> ID：15821830
> 
> 赞同：0
> 
> 时间：2013-04-04T21:14:08.347
> 
> 标签：python, database, h5py

我需要一个用于在线目录的数据库；如果每个产品可能有一个数据集。和一个简单的数据库；这就是我喜欢 h5py 的原因。

分组的方法`visititems`对于大文件来说并不快。

```
 import h5py

#in memory database. Not relevant for this question, same speed. Yes.
database = h5py.File('db01h5', driver='core', backing_store=False)

#example of 10000 datasets with a deep of 4 group, file/x10/x10/x10/x10dset
for v1 in ('abcdefghij'):
    for v2 in ('abcdefghij'):
        for v3 in ('abcdefghij'):
            for v4 in ('0123456789'):

                database['/' + v1 + '/' + v2 + '/' + v3 + '/' + 'dset' + v4] = (1, 2, 3)

def fu01(a1, a2):
    pass

#visititems applies function fu01(name, object) to each group and dataset 
database.visititems(fu01) 
```

使用不评估任何内容的函数（通过）“database.visititems(fu01)”需要 5 秒。使用基本参数进行过滤需要 x2。

我的问题是如何搜索一个大型或非常大的 h5py 数据库按特征过滤，并且非常快（10.000 个产品不到 0.1 秒）。

h5py/hdf5 是正确的方法，还是需要像 sqlite3 这样的 sql 数据库？

或者，当需要速度时，所有这些都必须在同一个数据集中？以树路径为一个元素。例如：

```
database['dataset'] = [['root/categorie/subcategorie/productname'], ['2'], ['10$'], ['blue']] 
```

然后按一个“列”（高级切片）过滤所有产品。

我是数据库新手，目前我对在内存中工作的数据库不感兴趣，比如 reddis 或类似的；因为很难同步数据的变化。但是如果没有其他解决方案...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-27T14:38:07.867

这不是`hdf`优化要做的事情。它旨在有效地存储少量非常大的数据集，并偶然发现大量非常小的数据集。

我认为您最好使用某种实际的数据库，无论是关系型的还是非关系型的。

您可能还想构建自己的树实现，缓慢的`visititems`是遍历 hdf 文件的组/数据集树。

# c# - 使用文件选择器 windows 8 连接到 sqlite db

> ID：15821831
> 
> 赞同：0
> 
> 时间：2013-04-04T21:14:09.440
> 
> 标签：c#, windows-8, sqlite, microsoft-metro, windows-runtime

为什么在使用文件保存选择器创建 SQLite 数据库后无法连接到它？

以下代码用于使用文件保存选择器创建一个 sqlite 数据库。我必须先在 app 文件夹中创建 db，然后复制到选择器文件。

```
 var savePicker = new FileSavePicker
{
    SuggestedStartLocation = PickerLocationId.DocumentsLibrary,
    CommitButtonText = "Create new project"
};
        savePicker.FileTypeChoices.Add("Data files", new List<string> { ".db" });
        savePicker.DefaultFileExtension = ".db";

        pickedFile = await savePicker.PickSaveFileAsync();

        if (pickedFile != null)
        {
            Windows.Storage.AccessCache.StorageApplicationPermissions.FutureAccessList.Add(pickedFile);

            var dbLocalPath = Path.Combine(ApplicationData.Current.LocalFolder.Path, "temp.db");

            var db = new SQLiteAsyncConnection(dbLocalPath);
            await db.CreateTableAsync<myTable>();

            await db.ExecuteAsync("INSERT INTO myTable (Record) VALUES ('1')");

            Debug.WriteLine(dbLocalPath);

            var db2 = new SQLiteAsyncConnection(dbLocalPath);
            var allRecords = await db2.QueryAsync<qvdb>("SELECT * FROM myTable");
            var countRecords = allRecords.Any() ? allRecords.Count : 0;
            Debug.WriteLine("There are " + countRecords);  // this works

            var localFile = await ApplicationData.Current.LocalFolder.GetFileAsync("temp.db");
            if (localFile != null) await localFile.CopyAndReplaceAsync(pickedFile);  // this works can open and see table in SQLite db browser

            Debug.WriteLine(pickedFile.Path);  // path is correct

            var db3 = new SQLiteAsyncConnection(pickedFile.Path);

            // ERROR //

            //   A first chance exception of type 'myApp.SQLiteException' occurred in myApp.exe
            //   A first chance exception of type 'myApp.SQLiteException' occurred in mscorlib.dll
            //   myApp.SQLiteException: Could not open database file: C:\Users\Gary\Documents\sql1.db (14)
            //   at myApp.SQLiteConnection..ctor(String databasePath) in c:\Users\Gary\Desktop\Current\myApp\SQLite.cs:line 108
            //   at myApp.SQLiteConnectionWithLock..ctor(SQLiteConnectionString connectionString) in c:\Users\Gary\Desktop\Current\myApp\SQLiteAsync.cs:line 441
            //   at myApp.SQLiteConnectionPool.Entry..ctor(SQLiteConnectionString connectionString) in c:\Users\Gary\Desktop\Current\myApp\SQLiteAsync.cs:line 373
            //   at myApp.SQLiteConnectionPool.GetConnection(SQLiteConnectionString connectionString) in c:\Users\Gary\Desktop\Current\myApp\SQLiteAsync.cs:line 406
            //   at myApp.SQLiteAsyncConnection.GetConnection() in c:\Users\Gary\Desktop\Current\myApp\SQLiteAsync.cs:line 44
            //   at myApp.SQLiteAsyncConnection.<>c__DisplayClass26`1.<QueryAsync>b__25() in c:\Users\Gary\Desktop\Current\myApp\SQLiteAsync.cs:line 255
            //   at System.Threading.Tasks.Task`1.InnerInvoke()
            //   at System.Threading.Tasks.Task.Execute()
            //--- End of stack trace from previous location where exception was thrown ---
            //   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)
            //   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)
            //   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()
            //   at myApp.Pages.MainPage.<btnStartNew_Click>d__c3.MoveNext() in c:\Users\Gary\Desktop\Current\myApp\Pages\MainPage.xaml.cs:line 1587
        } 
```

# javascript - 通过搜索 src 结果找到父 div id

> ID：15821835
> 
> 赞同：0
> 
> 时间：2013-04-04T21:14:30.130
> 
> 标签：javascript, jquery

让我们坐下来，我试图搜索这段代码：

```
<div id="ad_creative_1" class="ad-div mastad" style="z-index: 1;">
<script>(function() {var loaded = function() {return yt && yt.www && yt.www.home && yt.www.home.ads;};window.masthead_ad_creative_iframe_1_workaround = function() {if (loaded()) {yt.www.home.ads.workaroundIE(this);}};window.masthead_ad_creative_iframe_1_onload = function() {if (!loaded()) {setTimeout(masthead_ad_creative_iframe_1_onload, 50);return;}yt.www.home.ads.workaroundLoad();};})();</script>

      <iframe id="ad_creative_iframe_1" src="http://ad-g.doubleclick.net/N4061/adi/com.ythome/_default;sz=970x250;tile=1;plat=pc;dc_dedup=1;kage=18;kar=3;kbsg=HPUS130404;kcr=us;kga=1001;kgender=m;kgg=1;klg=en;kmyd=ad_creative_1;"
              height="250" width="970"
              scrolling="no" frameborder="0" style="z-index: 1"
              onload="masthead_ad_creative_iframe_1_onload();"
              onmouseover="masthead_ad_creative_iframe_1_workaround(this)"
              onfocus="masthead_ad_creative_iframe_1_workaround(this)"></iframe>
        <script>
    (function() {
          var ord = Math.floor(Math.random() * 10000000000000000);
          var adIframe = document.getElementById("ad_creative_iframe_1");
          adIframe.src = "http://ad-g.doubleclick.net/N4061/adi/com.ythome/_default;sz=970x250;tile=1;plat=pc;dc_dedup=1;kage=18;kar=3;kbsg=HPUS130404;kcr=us;kga=1001;kgender=m;kgg=1;klg=en;kmyd=ad_creative_1;ord=" + ord + "?";
    })();
  </script>

    </div> 
```

我想在此代码中搜索“doubleclick.net”，并在不知道父 div ID 的情况下找到父 div“ad_creative_1”。

我试过这个：

```
var container = document.getElementById.$('[src*="doubleclick.net"]').parent().getAttribute('id');
        container.innerHTML = '<center><iframe src="http://somesite.com/" width="478" height="70" scrolling="no" /></center>';
        container.id = "randomshithere"; 
```

我想用 container.innerHTML 替换整个 div

如果我取出选择器，然后只为 getElementId 放入 ad_creative_1，它可以正常工作并且可以满足我的需要，但是选择器给我带来了实际获取 div ad_creative_1 的问题

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:16:20.377

您可以使用[`.closest()`](http://api.jquery.com/closest/)获取 div：

```
var parentDivElement = $('[src*="doubleclick.net"]').closest("div");
parentDivElement.html("<b>Whatever you'd like </b>"); 
```

# android - StateListDrawable 之上的 TextView

> ID：15821840
> 
> 赞同：0
> 
> 时间：2013-04-04T21:14:57.217
> 
> 标签：android, textview, imageview, statelistdrawable

我试图让我的 TextViews 和 ImageView 显示在我添加了 StateListDrawable 的 LinearLayout 之上。我像这样创建我的按钮：

```
 protected StateListDrawable generateButton(String[] colors, String[] selectColors, String strokeColor, int strokewidth)
{
    int[] iColors = CurrentTheme.getIntColorArrayFromStringArray(colors);

    GradientDrawable gd = new GradientDrawable(Orientation.TL_BR, iColors);
    gd.setCornerRadius(10);
    gd.setStroke(strokewidth, Color.parseColor(strokeColor));

    int[] iSelectColors = CurrentTheme.getIntColorArrayFromStringArray(selectColors);

    GradientDrawable sgd = new GradientDrawable(Orientation.TL_BR, iSelectColors);
    sgd.setCornerRadius(10);
    sgd.setStroke(strokewidth, Color.parseColor(strokeColor));

    StateListDrawable slDrawable = new StateListDrawable();
    slDrawable.addState(new int[] { android.R.attr.state_pressed }, sgd);
    slDrawable.addState(StateSet.WILD_CARD, gd);    

    return slDrawable;
} 
```

在我的活动中，我将此可绘制对象添加到线性布局，如下所示：

```
_topMenuButton.setBackgroundDrawable(_theme.getPrimaryButtonDrawable()); 
```

布局包含在我的 Activity 的内容视图中的以下行中：

```
<include layout="@layout/inc_button_menu" android:id="@+id/second_menu_button" /> 
```

其中又包括一个 LinearLayout，其中有一个 ImageView 和两个 TextView。

当我尝试从 LinearLayout 获取 TextViews（我在我的 Activity 中添加了 StateListDrawable）并向它们添加 Text 时，文本不会显示。ImageView 也是如此。我不确定如何让这些视图显示出来。

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-20T07:59:01.417

事实证明，这不是背后的代码，而是包含的布局中的代码。由于该代码之前将布局文件用作可绘制文件，因此我认为它不是此代码。问题是我在其中一项上使用了 android:weight="1" 。

# cluster-computing - Websphere MQ 集群

> ID：15821841
> 
> 赞同：5
> 
> 时间：2013-04-04T21:14:57.503
> 
> 标签：cluster-computing, ibm-mq

我对 websphere MQ 很陌生，所以如果我没有使用正确的术语，请原谅我。我们正在做一个项目，我们需要在其中设置一个 MQ 集群以实现高可用性。

客户端应用程序为订阅者和发布者维护与队列管理器的连接池。假设我们在托管同名队列的集群中有两个队列管理器。每个队列都有自己的一组订阅者和发布者，这些订阅者和发布者由客户端应用程序缓存。假设其中一个队列管理器出现故障，该队列管理器上的队列的订阅者和发布者将死亡，从而使客户端应用程序上的对象失效。

在这种情况下，可以处理以下场景吗？

1]当第一个QueueManager崩溃时，其队列上的消息被转移到集群中的其他queuemanager

2]当QueueManager再次出现时，是否有任何机制可以恢复发布者和订阅者。目前我们已经在客户端应用程序中编写了一个自动恢复线程，它试图重新连接失败的发布者和订阅者。但是在集群设置的情况下，我们担心发布者和订阅者会重新连接到另一个正在运行的 qmanager。并且当崩溃的队列管理器被恢复时，它不会有发布者和订阅者。

谁能解释一下如何处理上述两种情况？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-05T04:25:56.297

WMQ 集群是一个高级主题。在尝试任何事情之前，您必须首先对 WMQ 进行大量阅读并了解 WMQ 世界中的集群意味着什么。

WMQ 集群在许多方面与传统集群不同。与传统集群不同，比如在主动/被动集群中，数据将在应用程序的主动和被动实例之间共享。在任何时间点，应用程序的活动实例都将处理数据。当主动实例宕机时，被动实例接管并开始处理。在 WMQ 集群中情况并非如此，其中集群中的队列管理器是唯一的，因此由这些队列管理器托管的队列/主题不共享。您可能在两个队列管理器中拥有相同的队列/主题，但由于队列管理器不同，因此不会共享消息、主题、订阅等。

回答您的问题。
1) 不。消息，如果持久，将保留在崩溃的队列管理器中。它们不会被转移到其他队列管理器。由于队列管理器本身不可用，因此在启动队列管理器之前无法进行任何操作。
2）没有。队列管理器不能这样做。检查队列管理器的可用性并重新连接是应用程序的职责。WMQ 提供自动客户端重新连接功能，当 WMQ 客户端库检测到连接中断错误时，它们会自动重新连接到队列管理器。此功能可从带有 C 和 Java 客户端的 WMQ v7.x 及更高版本中获得。C# 客户端支持 v7.1 中的功能。

对于您的高可用性要求，您可以考虑使用 WMQ 的多实例队列管理器功能。此功能启用在两台不同机器上运行的同一队列管理器的主动/被动实例。队列管理器的活动实例将处理客户端连接，而被动实例将处于睡眠模式。两个实例都将共享数据和日志。一旦主动实例关闭，被动实例就会变为主动。您将有权访问活动队列管理器关闭之前队列中的所有持久消息。

阅读 WMQ 信息中心，了解有关多实例队列管理器的更多信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-07T13:56:37.777

要添加到 Shashi 的答案，要充分利用 WMQ 集群，您需要在消息的发送者和接收者之间建立一个网络跃点。WMQ 集群是关于 QMgrs 之间如何对话。它与客户端应用程序如何与 QMgrs 对话无关，也不复制消息。在集群中，当消息必须从一个 QMgr 传递到另一个 QMgr 时，集群会确定将其路由到何处。如果单个目标队列有多个集群实例，则消息有资格被路由到其中的任何一个。如果发送方和接收方之间没有网络跳跃，则消息不需要离开本地 QMgr，因此永远不会调用 WMQ 集群行为，即使所涉及的 QMgr 可能参与集群。

在传统的 WMQ 集群架构中，接收者都侦听同一队列的多个实例，具有相同的名称，分布在多个 QMgrs 中。发送者有一个或多个 QMgrs，他们可以在其中连接和发送请​​求（即发即弃），可能等待回复（请求-回复）。由于消息的接收者提供一些服务，我称他们的 QMgrs 为“服务提供者 QMgrs”。消息发送者所在的 QMgrs 是“服务消费者”QMgrs，因为这些应用程序是服务的消费者。

下面的幻灯片来自我在 WMQ 架构咨询活动中使用的演示文稿。

![WebSphere MQ 的 SOA 架构](https://i.stack.imgur.com/nElEW.png)

请注意，服务的消费者 - 发送请求消息的事物 - 故障转移。监听服务端点队列并提供服务的事物不会故障转移。这是因为需要确保始终为每个活动的服务端点队列提供服务。通常，每个应用程序实例都拥有两个或更多队列实例的输入句柄。这样，QMgr 可以关闭并且所有应用程序实例保持活动状态。如果一个应用程序实例出现故障，其他一些应用程序实例会继续为其队列提供服务。如果需要，服务提供者与特定 QMgrs 的这种亲和性还支持 XA 事务性。

我发现解释 WMQ HA 的最佳方式是 IMPACT 会议的幻灯片：

![WebSphere MQ 高可用性选项](https://i.stack.imgur.com/a769w.png)

WebSphere MQ 集群确保服务保持可用，即使集群队列的实例可能不可用。集群中的新消息将路由到剩余的队列实例。硬件集群或多实例 QMgr (MIQM) 提供对现有消息的访问。*当主动/被动对的一侧出现故障时，只有在发生故障转移时，该 QMgr 才会*短暂中断，然后辅助节点接管并使队列上的任何消息再次可用。结合了 WMQ 集群和硬件集群/MIQM 的网络可提供最高级别的可用性。

请记住，这些配置中都没有跨节点复制的消息。WMQ 消息总是有一个物理位置。有关这方面的更多信息，请参阅[*灾难恢复思考*](https://t-rob.net/2012/10/24/thoughts-on-disaster-recovery/)。

# jquery - 当用户点击按钮外部时隐藏菜单？

> ID：15821842
> 
> 赞同：0
> 
> 时间：2013-04-04T21:15:00.473
> 
> 标签：jquery, html, css

我尝试了许多不同的解决方案，但都没有奏效。我这样做的方式与其他人的方式有些不同，我认为这就是为什么他们的方式不适合我的原因。

我有这个：

```
 function toggle_visibility(id) {
   var e = document.getElementById(id);
   if(e.style.display == 'block')
      e.style.display = 'none';

   else
      e.style.display = 'block';

    } 
```

我想让下拉菜单不仅在您再次单击按钮关闭它时消失，而且在您单击外部任何其他位置时也消失。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:20:47.037

试试这个，我希望它对你有用：

```
 $('body').not($('#menu').find('*'))
         .bind('click',function(){
            $("#menu").css('top', '-1000px');
            $("#menu").css('left', '-1000px');
         }); 
```

让我们处理身体上的点击，如果点击不在菜单上的任何地方，请隐藏

# jquery - 使用Jquery每个循环间隔停止

> ID：15821849
> 
> 赞同：0
> 
> 时间：2013-04-04T21:15:20.003
> 
> 标签：jquery, dom, append

我有一个列表项网格（大约 40`li`秒），每个项都包含一个像这样的图像：

```
<ul id="grid">
    <li><img src="images/source.jpg"></li>
    <li><img src="images/source.jpg"></li>
</ul> 
```

我想使用 jQuery 在第 8、第 14 和第 23 个列表项（或任意序列的任意数字）之后插入一个新的列表项。

新的列表项已经存在于 DOM 中的不同无序列表中，如下所示：

```
<ul id="toBeAppended">
    <li class="dataBlock d0">
            <a href="#dataDummy" class="fancybox">
               <div>
                   <h3>44<span>%</span></h3>
                   <span>Lorem ipsum dolor sit amet</span>
               </div>
            </a>
     </li>
</ul> 
```

这个无序列表是隐藏的。我想使用 jQuery`li.d0`从上面的第 8 个列表项之后抓取并插入它，然后抓取下一个列表项`#toBeAppended`并将其插入到第 14 行之后，依此类推。

我猜我会将要插入新列表项的数字存储到一个数组中，如下所示：

```
var splashArray = [8,14,23];
$("grid li").each(function(i){
 //not sure what to do here in order to stop the the loop at each interval
  i++
}); 
```

我将如何使用 jQuery 来做这件事？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:17:13.410

不是循环遍历 li，而是遍历数组。

```
var $lis = $("#grid li");
var $newlis = $("#toBeAppended li");
$.each([8,14,23],function(i,val){
    $lis.eq(val).after($newlis.eq(i));
}); 
```

# sql - 具有包含和条件的 ActiveRecord 查询未给出预期的 SQL

> ID：15821857
> 
> 赞同：3
> 
> 时间：2013-04-04T21:15:53.787
> 
> 标签：sql, ruby-on-rails, ruby, ruby-on-rails-3, rails-activerecord

好的，这就是我遇到的问题。我有一个模型，它在直通表中的条件下设置了两个关系。

```
has_one :link_resource, through: :resource_contexts, source: :resource, conditions: ['resource_contexts.question_id = ? ', -1]
has_many :sample_plans, through: :resource_contexts, source: :resource, conditions: ['resource_contexts.question_id = ? ', -2] 
```

然后，在我的控制器中，我尝试使用

```
@funder_templates = FunderTemplate.find(:all, include: [:sample_plans, :link_resource], conditions: {active: true}) 
```

但是由于某种原因，sql 是这样出来的

```
ResourceContext Load (0.2ms)  SELECT `resource_contexts`.* FROM `resource_contexts` WHERE (`resource_contexts`.funder_template_id IN (2,3,4,5,6,7,8,9,10,11,12,13,14,20,21,22,23,24,25,26,27,30,40) AND (resource_contexts.question_id = -2 )) 
```

请注意，它只查找第一个关系的条件，而不是第二个关系。我不知道我正在做的事情是否太复杂以至于 ActiveRecord 无法处理，或者我只是写错了。任何帮助，将不胜感激。

导轨 3.0.20

红宝石 1.9.2

编辑：澄清一下，真正搞砸的部分是@funder_templates.sample_plans 是正确的，但@funder_templates.link_resource 也是示例计划！没有包含，关系工作正常，只是没有优化。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T23:01:18.090

Did you try ? @funder_templates = FunderTemplate.where(active: true).includes([:sample_plans, :link_resource])

I think, it should work

# jquery - 使用 jquery 移动 div 框并检查浏览器屏幕大小

> ID：15821858
> 
> 赞同：0
> 
> 时间：2013-04-04T21:15:54.990
> 
> 标签：jquery

我正在尝试使用 jquery 使 div 框在页面上移动。我将 mouseover 函数与 pagex 和 pagey 一起使用，然后我使用 animate 函数根据 pagex 和 y 更改 top 和 left 属性。我想知道是否有一种方法可以检查浏览器窗口的大小，并且该框是否超出了这些约束，以另一种方式对其进行动画处理，因为现在我的 div 正在使浏览器窗口滚动。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:31:30.427

you can use

```
 $(window).height()
  $(window).width() 
```

EDIT:

by the way you may need to check `$('body').scrollTop` and `$('body').scrollLeft` properties

# javascript - PhoneGap中以同步方式（esp）的异步Javascript

> ID：15821867
> 
> 赞同：0
> 
> 时间：2013-04-04T21:16:10.887
> 
> 标签：javascript, jquery, cordova, asynchronous, promise

我对在 Phonegap 中使用的 JS 异步编程有点陌生。我有一个函数调用

```
window.requestFileSystem(LocalFileSystem.PERSISTENT, 0,onFSWin , onFSFail);

var onFSWin = function(fileSystem) {        
  fileSystem.root.getDirectory("Icenium Demo", {create: false, exclusive: false}, onGetDirectoryWin, onGetDirectoryFail);
} 
```

这个回调有效，但是当有 4-5 个调用链时，它开始变得非常混乱。我试过这个

```
window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, 
function(filesystem){
        fileSystem.root.getDirectory("Icenium Demo", {create: false, exclusive: false},    onGetDirectoryWin, onGetDirectoryFail); 
       }, onFSFail); 
```

但它认为文件系统是未定义的，所以有几个问题：

1.  错误Phonegap不以这种方式接受匿名函数吗
2.  我正在查看 Jquery 中的承诺和回调，但我正在努力解决它。谁能给我一个使用 defer 对象的例子。我见过使用管道的例子，但不推荐使用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T19:44:07.647

嗨，我认为延迟模式不适用于 Phonegap，它不会返回延迟对象。然而，该视频在解释承诺模式方面非常有用。这是我为它的价值而工作的一些基本代码

```
var step1 = $.getJSON('/test1.txt', function (data) {
return data;
});

var step2 = $.getJSON('/test2.txt', function (data) {
return data;
});

var processStep1 = function (data) {
var d1 = data.one;
alert(d1);
return $.getJSON('/test2.txt', function (data) {
    return data;
}); 
```

}

```
var processStep2 = function (data) {
$.each(data, function (key, val) {
    alert(val);
});
}

step1.then(processStep1).then(processStep2); 
```

# java - 无法从 JOD 转换器启动 Open Office

> ID：15821871
> 
> 赞同：0
> 
> 时间：2013-04-04T21:16:34.043
> 
> 标签：java, openoffice.org, jodconverter

尝试从 JOD Converter 连接到 Open Office 时出现以下异常：

javax.servlet.ServletException: org.artofsolving.jodconverter.office.OfficeException: 无法启动和连接 org.apache.struts.chain.ComposableRequestProcessor.process(ComposableRequestProcessor.java:286) org.apache.struts.action.ActionServlet.process (ActionServlet.java:1913) org.apache.struts.action.ActionServlet.doPost(ActionServlet.java:462) javax.servlet.http.HttpServlet.service(HttpServlet.java:710) javax.servlet.http.HttpServlet.service (HttpServlet.java:803) org.jboss.web.tomcat.filters.ReplyHeaderFilter.doFilter(ReplyHeaderFilter.java:96)

我已经经历了[Jodconverter 异常：无法在 Windows 中启动和连接](https://stackoverflow.com/questions/12910548/jodconverter-exception-failed-to-start-and-connect-in-windows) 并按照步骤操作，但每次我仍然遇到相同的异常。OO 服务在端口 8100 上运行，我也尝试在 2002 上运行它，但没有运气。任何帮助都深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T10:12:29.280

我在使用 LibreOffice（= OpenOffice 克隆）时遇到了同样的问题，对我有用的是将以下路径添加到 PATH 环境变量中：

```
C:\Program Files (x86)\LibreOffice 4.0\URE\bin 
```

并重新启动 Windows！

在你的情况下，它可能应该是这样的（这里不确定，你必须检查你的机器）：

```
C:\Program Files (x86)\OpenOffice.org 3\URE\bin 
```

# javascript - 检查多个单词

> ID：15821875
> 
> 赞同：0
> 
> 时间：2013-04-04T21:16:39.810
> 
> 标签：javascript, testing, words

当我向 titleIs Var 添加多个单词时，这段代码有一个问题，它不会触发 if 语句。上面的一个不起作用，即如果一个单词在 Var titleIs 中并且在 var 单词中，则触发 if 语句。

感谢您的帮助！

```
var titleIs = ['Knit', 'Main'];
var words = ['Woven', 'Main'];
var regex = new RegExp('^(' + words.join('|') + ')$');
if (regex.test(titleIs)) {
alert("true")
} 
```

这两个工作：

```
var titleIs = ['Woven'];
var words = ['Woven', 'Main'];
var regex = new RegExp('^(' + words.join('|') + ')$');
if (regex.test(titleIs)) {
alert("true")
}

var titleIs = ['Main'];
var words = ['Woven', 'Main'];
var regex = new RegExp('^(' + words.join('|') + ')$');
if (regex.test(titleIs)) {
alert("true")
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:24:48.077

`test`方法接受单个字符串。（实际上，当您发送一个只有一个元素的数组时，它会考虑该元素）。

您需要一个新的方法`testAny`来定义，如下所示：

```
RegExp.prototype.testAny = function (arr){
    for(var i=0; i<arr.length; i++){
        if (this.test(arr[i])) return true;
    }
    return false;
} 
```

（实际上`matchesAny`是一个更好的名字——在我看来——但是使用了上面的名字来保持它与现有`test`方法的一致）

然后用在你的`if`代替。

```
if(regex.testAny(titleIs)) ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:20:33.650

RegExp 需要一个字符串，而不是一个数组。

所以一个一个地检查每个单词：

```
var titleIs = ['Knit', 'Main'];
var words = ['Woven', 'Main'];
var regex = new RegExp('^(' + words.join('|') + ')$');
for(var i=0; i<titleIs.length; i++){
    if (regex.test(titleIs[i])) {
        alert("true")
    }
} 
```

它仅适用于 Array 中的单个项目的原因是 Javascript 将您的数组强制转换为 String `"Knit"`。列表中有两个项目，它被强制输入`"Knit,Main"`，并且中间的逗号不再与您的正则表达式匹配。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:22:38.193

您应该测试数组中的每个字符串，而不是将整个数组放入 regex.test

```
var titleIs = ['Knit', 'Main'];
var words = ['Woven', 'Main'];
var regex = new RegExp('^(' + words.join('|') + ')$');
for(var i=0;i<titleIs.length;i++)
if (regex.test(titleIs[i])) {
alert("true")
break;
} 
```

# compiler-construction - 编程语言与操作系统的交互

> ID：15821882
> 
> 赞同：1
> 
> 时间：2013-04-04T21:16:58.477
> 
> 标签：compiler-construction, programming-languages, operating-system

这是关于编程语言和操作系统的计算机科学问题。

我的问题是，编程语言和操作系统之间的基本交互是什么？我确实对操作系统的 IFE 周期有所了解，但不确定编程语言如何适应。

我已经阅读了这篇文章，但它没有任何帮助

[关于编译程序如何与操作系统交互的问题](https://stackoverflow.com/questions/4989419/questions-on-how-compiled-programs-interact-with-the-operating-system)

编辑：

通过编程语言，我的意思是包括他们各自的编译器/VM

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T23:38:40.053

在机器代码级别，程序必须进行系统调用。

不同的处理器有不同的方法可用于进行系统调用。每个操作系统都必须为给定的处理器架构选择系统调用约定。例如，对于 x86 处理器，Linux 曾经使用软件中断指令`INT 0x80`来执行其系统调用——但是（根据下面的评论）它现在使用了一条`SYSENTER`指令，该指令专门为此目的引入了体系结构。

系统调用约定并不是真正特定于编程语言本身，但它们必须写入给定语言和操作系统的最基本的标准库中。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-04T21:28:57.150

编程语言不与操作系统交互，因为它是一种语言，一种抽象概念，它不是任何类型的（交互）参与者。它只是一个系统，可以用来表达程序和算法，使用它的词汇元素，符合它的语法和规则等等。

可以与操作系统交互的是程序。作为程序的编程语言的解释器和编译器与操作系统交互。编译后的程序与操作系统交互。语言没有。它们不是程序。

# c - 指针数组上的 MergeSort 实现

> ID：15821883
> 
> 赞同：-1
> 
> 时间：2013-04-04T21:17:00.323
> 
> 标签：c, mergesort

我有一个大学的任务来编写一个程序，该程序接收一个整数数组及其大小，并返回一个指向原始数组值的排序数组。排序必须使用 mergeSort 算法来完成，我不允许触摸原始数组，只能更改指针数组。

谁能帮我吗？这是我的代码：

```
void sortedPointerArray (int **arr1[], int size1, int **arr2[], int size2, int **arr3[])
{
    int read1, read2, writeind;

    read1 = read2 = writeind = 0;
    while( (read1<size1) && (read2 < size2))
    {
            if (*(arr1[read1]) < *(arr2[read2]))
            {
                    arr3[writeind] = arr1[read1];
                    writeind++;
                    read1++;
            }
            else
            {
                    arr3[writeind] = arr2[read2];
                    writeind++;
                    read2++;
            }

    }
    while (read1 < size1)
    {
            arr3[writeind] = arr1[read1];
            writeind++;
            read1++;
    }
    while (read2 < size2)
    {
            arr3[writeind] = arr2[read2];
            writeind++;
            read2++;
    }
}

void mergeSort (int **arr, int size)
{
    int temp, i;

    if(size <=1)
            return;
    else
    {
            mergeSort(arr, size/2);
            mergeSort(arr+(size/2), size-(size/2));
            int** temp = (int **)malloc(size*sizeof(int *));
            sortedPointerArray(arr,size/2,arr+(size/2),size-(size/2),temp);
            for (i=0; i<size; i++)
                    (*arr)[i] = (*temp)[i];
            free(temp);
    }
} 
```

由于某些未知原因，我无法编译它并且它不起作用......任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:57:02.983

`sortedPointerArray`只需要接收 int[]，而不是`int**[]`. 目前它在合并排序数组时比较指针而不是整数。`mergeSort`应该更改调用代码指向的数组，因此需要`int**`（或`int*&`在 C++ 中）。`mergeSort`还应该避免释放完全排序的数组。

在不相关的说明中，我认为您的代码可以使用更好的变量名。例如，arr1、arr2 和 arr3 可以分别替换为 in1、in2 和 out。您还可以对数组进行注释，`const`以减少意外更改输入数组的风险。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T22:09:20.180

```
#include <stdlib.h>
#include <stdio.h>

void mergeSort (int **arr, size_t size);
void sortedPointerArray (int **arr1, size_t size1, int **arr2, size_t size2, int **arr3);

void sortedPointerArray (int **arr1, size_t size1, int **arr2, size_t size2, int **arr3)
{
    size_t read1, read2, writeind;

    for(read1=read2=writeind=0; read1 < size1 && read2 < size2; )
            arr3[writeind++] = (*arr1[read1] < *arr2[read2])
                   ? arr1[read1++]
                   : arr2[read2++]
                   ;

    while (read1 < size1)
            arr3[writeind++] = arr1[read1++];

    while (read2 < size2)
            arr3[writeind++] = arr2[read2++];
}

void mergeSort (int **arr, size_t size)
{
    size_t idx;
    int **temp ;

    if(size < 2) return;

    mergeSort(arr, size/2);
    mergeSort(arr+(size/2), size-(size/2));

    temp = malloc(size*sizeof *temp);
    sortedPointerArray(arr,size/2,arr+(size/2),size-(size/2),temp);
    for (idx=0; idx<size; idx++)
            arr[idx] = temp[idx];
    free(temp);
}

#define COUNTOF(a) (sizeof a/ sizeof a[0])
int array[] = { 3,2,4,5,9,8,7,1,6,0};

int *ptrs[COUNTOF( array)];

int main(void)
{
unsigned idx;

for(idx=0; idx < COUNTOF( array); idx++ ) ptrs[idx] = array+idx;

mergeSort(ptrs, COUNTOF(ptrs) );

for(idx=0; idx < COUNTOF(ptrs); idx++ ) {
        printf("%u: %p %d\n", idx, (void*) ptrs[idx], *ptrs[idx] );
        }
return 0;
} 
```

输出：

```
0: 0x601064 0
1: 0x60105c 1
2: 0x601044 2
3: 0x601040 3
4: 0x601048 4
5: 0x60104c 5
6: 0x601060 6
7: 0x601058 7
8: 0x601054 8
9: 0x601050 9 
```

评论/更改：

*   删除了令人困惑（和*错误*）的额外间接级别
*   删除了多余的括号
*   删除了 malloc 不需要的演员表
*   压缩合并循环以使用`dst[aaa++] = src[bbb++];`
*   将所有索引更改为无符号 (size_t) 类型。
*   之后删除了其他部分`if (size <2) return;`
*   添加了一个驱动程序。
*   去掉大括号并引入三元运算符来挫败老师

# monodevelop - 在 Xamarin Studio 中隐藏某些警告

> ID：15821888
> 
> 赞同：6
> 
> 时间：2013-04-04T21:17:14.040
> 
> 标签：monodevelop, xamarin, xamarin-studio

有没有一种方法可以在 Xamarin Studio 的构建过程中隐藏某些警告？我故意在我的解决方案中包含了某些已弃用的类成员，我厌倦了每次编译时都被提醒。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T21:38:51.850

右键单击您的项目 -> 选项 -> 构建/编译器，然后调整警告级别或在“忽略警告”文本框中列出您不想被告知的警告。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-12-10T19:00:52.767

要查看警告代码，请单击`Errors`右下角的并在每个警告行的末尾，您会看到它。 [![在此处输入图像描述](https://i.stack.imgur.com/njoBn.png)](https://i.stack.imgur.com/njoBn.png)

# ocaml - 在模块下的类型访问

> ID：15821893
> 
> 赞同：0
> 
> 时间：2013-04-04T21:17:31.020
> 
> 标签：ocaml

我向你解释我的问题

我有一个这样的模块：

毫升

```
module A = struct 
type t = int * int
end 
```

a.mli

```
module A :sig
type t = int * int
end 
```

主文件

```
let test = A.t(8, 9) 
```

我该如何解决这个错误：

```
Error: Unbound value A.t 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T19:08:44.120

`A.t`是一种类型，因此`A.t (8,9)`没有什么意义。这与模块无关，您将获得相同的结果：

```
# type t = int*int;;
type t = int * int
# t (1,2);;
Error: Unbound value t 
```

# haskell - 从依赖包的测试套件中导入模块

> ID：15821894
> 
> 赞同：4
> 
> 时间：2013-04-04T21:17:32.697
> 
> 标签：haskell, cabal

我想为我的包编写一些测试，这些测试依赖于一个包`foo`，我想导入一些为`foo`'s编写的代码`test-suite`，但这些代码没有导出或暴露在`foo.cabal`.

换句话说我的依赖`foo.cabal`有这个部分

```
Test-Suite tests
  Type:               exitcode-stdio-1.0
  Build-Depends:      base, text, parsec >= 3, etc
  Main-Is:            Test/TestRunner.hs
  GHC-Options:        -fhpc -W -Wall -fno-warn-name-shadowing
  CPP-Options:        -DTESTING 
```

我想导入一些导入的模块`Test/TestRunner.hs`。我也想用 cabal-dev 来做这件事。

有没有办法在不修改的情况下做到这一点`foo`？`foo`如果不是，那么修补以支持它的好方法是什么？

也许我的问题的一个更一般的版本是：*我可以告诉 cabal 让我访问另一个包中未导出的代码吗？*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:51:00.007

正如 Daniel Fischer 所暗示的，这对阴谋集团来说可能是一件愚蠢的事情。相反，我可能想分叉库并导出我需要的东西。也许 git 子模块会在这里有所帮助。

# java - 如何在 tomcat 7.0.37 中设置“Http11NioProtocol”？

> ID：15821895
> 
> 赞同：1
> 
> 时间：2013-04-04T21:17:36.907
> 
> 标签：java, tomcat, tomcat7

我在配置 tomcat 以使用“Http11NioProtocol”时遇到问题。server.conf 具有以下设置：

```
<Connector
    protocol="org.apache.coyote.http11.Http11NioProtocol"
    port="80"
    redirectPort="8443"
    connectionTimeout="20000"
    compression="on" /> 
```

当我们启动 tomcat 并打开应用程序时，我们看到图像发生了变化，例如在图片销售中出现的项目的图像等。CSS很好，但图像的内容是错误的。如果我们关闭浏览器并重新打开图像加载正常。也尝试了其他浏览器，同样的事情发生了。

这会在tomcat中进行任何其他配置吗？

# facebook - 共享 URL 时未显示博客文章图片

> ID：15821896
> 
> 赞同：0
> 
> 时间：2013-04-04T21:17:40.080
> 
> 标签：facebook, image, blogs, share, tumblr

我经营一个音乐网站（[AlreadyHeard](http://AlreadyHeard.com/)）当我们/用户在 Facebook 上分享链接时，它很少显示用于该特定帖子的图像。

关于如何解决这个问题的任何想法？这将有助于改善我们的用户体验。

我目前在我的网站代码中有这个：

```
<meta property="fb:admins" content="212601048836856" />
<meta property="fb:admins" content="502049012" />
<meta property="og:description" content="Already Heard covers the latest news, interviews, features & reviews in rock, punk, hardcore, pop-punk, emo, indie & more. " /> 
<meta property="og:url" content="{Permalink}"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:28:07.753

您必须使用正确的 Facebook Open Graph 标签来提示 Facebook 服务器在共享站点链接时要显示哪些图像/内容/等。完整的文档可以在这里找到：[https ://developers.facebook.com/docs/opengraph/](https://developers.facebook.com/docs/opengraph/)

您要用于图像的标签是`<meta property="og:image" content="http://example.com/images/picture.jpg"/>`. 有关您可以使用的其他标签的更简单指南，请查看：[http ://davidwalsh.name/facebook-meta-tags](http://davidwalsh.name/facebook-meta-tags)

# css - Firefox CSS 选择 OPTION 样式

> ID：15821899
> 
> 赞同：3
> 
> 时间：2013-04-04T21:17:47.527
> 
> 标签：css, firefox, select, cross-browser, option

从我所看到的情况来看，您无法设置框的样式，因为它是特定于操作系统的，除非您使用 javascript 进行编辑，否则无法破坏...

我的例子在这里：

[http://www.promilitarybusinessnetwork.com/continueSearch.asp?categoryID=1270](http://www.promilitarybusinessnetwork.com/continueSearch.asp?categoryID=1270)

我今天刚刚重新设计了页面。与以前相比有了巨大的改进。

在 Chrome 和 Safari 中看起来很完美……Firefox 给我带来了问题。

1.  在 Firefox 中，文本不居中。
2.  我不能使用 -moz-appearance:none; 摆脱右边的盒子。
3.  由于我的 chrome 和 safari 的 CSS，这些项目变成了白色。这仅适用于 SELECT 文本，但在我喜欢的浏览器中仍然保持黑色。在 Firefox 中，它变成白色......

我能做些什么来改变这个......？

```
.select{
width:361px;
height:44px;
color:#FFF;
font-size:14px;
padding-left:10px;
font-weight:bolder;
font-family:Verdana, Geneva, sans-serif;
background-image:url(images/baseselect_up.png);
display:block;
position:absolute;
-webkit-appearance: none;
-moz-appearance: none;
}
.select:hover{
background-image:url(images/baseselector_down.png);
}

<form method="post" action="newSearch.asp">
<select class="select" name="baseID" >  

<% do while not BaseRs.eof %>
<option value="<%=baseRs("baseID")%>"><%=baseRs("base")%></option>
loop %>                                         
</select> <br><br>
<input type="hidden" name="CategoryID" value="<%=sqlFilter(request("categoryID"))%>">
<div style="position:relative; top:14px; left: 264px;"><input type="submit"     value="Continue >>>"></div>
</form> 
```

有什么方法可以编辑 Mozilla 以使 OPTION 文本变为白色，并隐藏 SELECT 外观和中心文本...？

还是因为每个操作系统的运行方式而我搞砸了？

我在办公室运行 MAC，在家里运行 PC，所以我还没有在 PC 上看到我的网站，因为我今天做了这些新的改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:23:23.780

SELECT/OPTION 的基于 Javascript 的替换更加可靠和灵活，尤其是如果您希望跨浏览器保持一致性。你会发现有些事情是使用原生样式和标签无法做到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-09T06:49:25.920

实际上，如果您不想使用其他插件，最简单的方法是使用如下代码：

```
<label for="upload" class="upFile">Attach file</label>
<input style="display: none;" type="file" id="upload" accept="image/*" name="Change"> 
```

您可以删除内联 css ofc，也可以样式标签以完全符合您的要求。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-04T21:24:28.960

```
select{
width:333px;
height:44px;
color:#FFF; 
```

尝试以下选项颜色的答案

[HTML <select> 选择的选项 background-color CSS 样式](https://stackoverflow.com/questions/2402146/html-select-selected-option-background-color-css-style)

[http://www.456bereastreet.com/lab/styling-form-controls-revisited/select-multiple-option/](http://www.456bereastreet.com/lab/styling-form-controls-revisited/select-multiple-option/)

# magento - Magento Soap - 一键获取详细的产品列表

> ID：15821910
> 
> 赞同：4
> 
> 时间：2013-04-04T21:18:33.523
> 
> 标签：magento, soap, magento-1.7, soap-client

我目前正在使用一种名为“catalogProductList”（[http://www.magentocommerce.com/api/soap/catalog/catalogProduct/catalog_product.list.html](http://www.magentocommerce.com/api/soap/catalog/catalogProduct/catalog_product.list.html)）的SOAP 方法来检索catalogProductEntity 数组。

问题是它`catalogProductEntity`没有像“价格”和“描述”这样的属性。问题是：是否有任何（已经实现的）SOAP 方法可以通过一次调用为我提供这些信息？

如果没有，我如何/在哪里可以将此字段添加到返回值？我的意思是，更改服务器端的 php 代码以在一次调用中获取此“产品详细列表”。

我试图避免对每种产品进行多次查询以获取此信息。

PS：我使用的是 Magento 1.7。

* * *

**已编辑**

按照@Mat 提示，我编辑了 \app\code\core\Mage\Catalog\Model\Product\Api.php 文件，我的方法`items`是这样的：

```
public function items($filters = null, $store = null)
{
    $collection = Mage::getModel('catalog/product')->getCollection()
        ->addStoreFilter($this->_getStoreId($store))
        ->addAttributeToSelect('price')
        ->addAttributeToSelect('description')
        ->addAttributeToSelect('name');

    /** @var $apiHelper Mage_Api_Helper_Data */
    $apiHelper = Mage::helper('api');
    $filters = $apiHelper->parseFilters($filters, $this->_filtersMap);
    try {
        foreach ($filters as $field => $value) {
            $collection->addFieldToFilter($field, $value);
        }
    } catch (Mage_Core_Exception $e) {
        $this->_fault('filters_invalid', $e->getMessage());
    }
    $result = array();
    foreach ($collection as $product) {
        $result[] = array(
            'product_id' => $product->getId(),
            'sku'        => $product->getSku(),
            'price'      => $product->getData('price'),
            'description'=> $product->getData('description'),
            'name'       => $product->getName(),
            'set'        => $product->getAttributeSetId(),
            'type'       => $product->getTypeId(),
            'category_ids' => $product->getCategoryIds(),
            'website_ids'  => $product->getWebsiteIds()
        );
    }
    error_log(print_r($result, true) . "\n", 3, "c:\log.txt");
    return $result;
} 
```

日志文件输出以下结果：

```
 Array
(
    [0] => Array
        (
            [product_id] => 3
            [sku] => sim12ple1235
            [price] => 99.9500
            [description] => Simple Description
            [name] => Simple Product
            [set] => 4
            [type] => simple
            [category_ids] => Array
                (
                )
            [website_ids] => Array
                (
                    [0] => 1
                )
        )
) 
```

请注意，价格和描述在 $result 变量中，但我在客户端应用程序中得到的 xml 响应是：

```
<?xml version="1.0" encoding="UTF-8"?>
<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:ns1="urn:Magento" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
<SOAP-ENV:Body>
<ns1:catalogProductListResponse>
<storeView SOAP-ENC:arrayType="ns1:catalogProductEntity[1]" xsi:type="ns1:catalogProductEntityArray">
<item xsi:type="ns1:catalogProductEntity">
<product_id xsi:type="xsd:string">3</product_id>
<sku xsi:type="xsd:string">sim12ple1235</sku>
<name xsi:type="xsd:string">Simple Product</name>
<set xsi:type="xsd:string">4</set>
<type xsi:type="xsd:string">simple</type>
<category_ids SOAP-ENC:arrayType="xsd:string[0]" xsi:type="ns1:ArrayOfString"/>
<website_ids SOAP-ENC:arrayType="xsd:string[1]" xsi:type="ns1:ArrayOfString">
<item xsi:type="xsd:string">1</item>
</website_ids>
</item>
</storeView>
</ns1:catalogProductListResponse>
</SOAP-ENV:Body>
</SOAP-ENV:Envelope> 
```

我的问题是：是否有任何 xml 架构或其他指定输出的配置文件？我在服务器端还有什么需要编辑的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:35:09.373

要获取产品信息，您必须使用[catalog_product.info](http://www.magentocommerce.com/api/soap/catalog/catalogProduct/catalog_product.info.html)

您在获取列表之前，然后在列表中循环以获取产品详细信息。

```
$list = $proxy->catalogProductList($sessionId, $filters);
for($i = 0; $i < count($list); $i ++){
  $current = $list[$i];
  $product = $proxy->catalogProductInfo($sessionId, $current['product_id']);
} 
```

//// 更新 ////

更改目录产品列表代码转到

```
\app\code\core\Mage\Catalog\Model\Product\Api.php 
```

并添加您需要的参数

```
public function items 
```

在循环之前做这样的事情

```
$collection = Mage::getModel('catalog/product')->getCollection()
        ->addStoreFilter($this->_getStoreId($store))
        ->addAttributeToSelect('name'); 
```

你必须在哪里添加

```
->addAttributeToSelect('what_you_need'); 
```

到

```
 foreach ($collection as $product) {
        $result[] = array(
            'product_id' => $product->getId(),
            'sku'        => $product->getSku(),
            'name'       => $product->getName(),
            'set'        => $product->getAttributeSetId(),
            'type'       => $product->getTypeId(),
            'category_ids' => $product->getCategoryIds(),
            'website_ids'  => $product->getWebsiteIds(),
            'what_you_need' => $product->getData('what_you_need')

        );
    } 
```

//// 更新 /// （感谢@matheusjardimb）

最后你必须添加

```
what_you_need 
```

元素到

```
app/code/core/mage/catalog/etc/wsdl.xml 
```

在这部分 xml

```
<complexType name="catalogProductEntity">
            <all>
                <element name="product_id" type="xsd:string"/>
                <element name="sku" type="xsd:string"/>
                <element name="name" type="xsd:string"/>
                <element name="set" type="xsd:string"/>
                <element name="type" type="xsd:string"/>
                <element name="category_ids" type="typens:ArrayOfString"/>
                <element name="website_ids" type="typens:ArrayOfString"/>
                <element name="**what_you_need**" type="xsd:string"/>
            </all>
        </complexType> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-05T16:14:42.743

问题是在应用 php 更改后，它在文件 app/code/core/Mage/Catalog/etc/wsdl.xml 中缺少此字段（价格和描述）。

```
...
<complexType name="catalogProductEntity">
<all>
    <element name="product_id" type="xsd:string"/>
    <element name="sku" type="xsd:string"/>
    <element name="name" type="xsd:string"/>
    <element name="set" type="xsd:string"/>
    <element name="type" type="xsd:string"/>
    <element name="category_ids" type="typens:ArrayOfString"/>
    <element name="website_ids" type="typens:ArrayOfString"/>

    <element name="price" type="xsd:string"/>
    <element name="description" type="xsd:string"/>
</all>
</complexType>
... 
```

**并且不要忘记清理缓存！**

# java - JButton - 设置按下时显示的颜色？

> ID：15821925
> 
> 赞同：0
> 
> 时间：2013-04-04T21:19:40.380
> 
> 标签：java, swing, jbutton

我想在按下 JButton 时改变它的外观。我不希望将背景设为深灰色（默认），而是将其设为蓝色。我查看了这篇文章，发现它使用了 JButton.setPressedIcon(Icon image) -[使图像按钮看起来在 Swing 中被按下/单击](https://stackoverflow.com/questions/11351728/making-image-button-look-pressed-clicked-in-swing)

我不想改变图像。我只想在按下按钮时将背景颜色更改为非默认值。

**我怎样才能做到这一点 ？是否可以在不覆盖或创建新类的情况下做到这一点？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-04T21:25:21.683

`paintButtonPressed()`您可以在自定义中覆盖`ButtonUI`。[在这里](https://stackoverflow.com/a/5755124/230513)可以看到一个相关的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:24:37.300

同样的情况，有解决方案。见链接：

[http://www.coderanch.com/t/346459/GUI/java/JButton-onClick-change-background-color](http://www.coderanch.com/t/346459/GUI/java/JButton-onClick-change-background-color)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-05-25T16:26:49.323

```
public class CustomMetalButtonUI extends MetalButtonUI {
    @Override
    protected Color getSelectColor() {
        return new Color(166, 66, 66); // Color
    }
} 
```

或者...

```
public class CustomMetalButtonUI extends BasicButtonUI {
    @Override
    protected void paintButtonPressed(Graphics g, AbstractButton b) {
        if (b.isContentAreaFilled()) {
            Dimension size = b.getSize();
            g.setColor(new Color(166, 66, 66)); // Color
            g.fillRect(0, 0, size.width, size.height);
        }
    }
} 
```

# php - 如何将javascript变量数据发送到php

> ID：15821926
> 
> 赞同：1
> 
> 时间：2013-04-04T21:19:42.370
> 
> 标签：php, javascript, jquery, html, css

我想发送一个包含图像 base64 (png) 值的 javascript 变量（对于 GET 请求来说太大）。我如何将此base64值发送到php页面（POST请求）以便解码base64然后保存它。

```
var base64 = this.tobase64(); // store base64 value to this variable

        $.post('/js/uploadify/handler.php', {basevalue: base64});

                });

    window.location = "http://localhost/file/handler.php"; 
```

我尝试了上面的代码，但它不起作用，

我想通过按钮（不是提交按钮）上的 onclick 事件发送值。我没有使用表格。

**PHP代码**

```
$val = $_POST['basevalue'];
echo $val; 
```

我收到通知：未定义的索引：基值错误

谢谢！。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:31:40.930

等待成功`$.post()`。

```
function wl(){
 window.location = "http://localhost/file/handler.php";
}
var base64 = this.tobase64(); // store base64 value to this variable
$.post('/js/uploadify/effectsuploadify.php',{
  basevalue: base64,
  success: wl,
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:37:56.783

POST 仅将表单字段的值发送到下一页。为了将您的图像发送到下一页，请将其分配给隐藏字段的值并使用 java 脚本提交表单。

```
var form = document.createElement("form");
form.setAttribute("method", "POST");
form.setAttribute("action", "http://localhost/file/handler.php");

var hiddenField = document.createElement("input");
hiddenField.setAttribute("type", "hidden");
hiddenField.setAttribute("name", "image");
hiddenField.setAttribute("value", base64);

form.appendChild(hiddenField);
document.body.appendChild(form);
form.submit(); 
```

# r - 基于 R 中的字段对数据进行分组

> ID：15821928
> 
> 赞同：2
> 
> 时间：2013-04-04T21:20:02.957
> 
> 标签：r

我正在使用 R 来完成以下任务。我有一个看起来像这样的数据集：

```
Item Category Price
aaa      1    10.00
bbb      2    5.00
ccc      3    20.00
ddd      1    25.00
eee      3    5.00
fff      2    15.00 
```

是否可以按类别对项目进行分组并计算一些汇总统计数据（例如价格的平均值或总和）？

所以本质上，我正在尝试创建这样的东西：

```
Cateogry AveragePrice
    1    17.50
    2    10.00
    3    12.50 
```

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:31:35.060

假设这是一个`data.table`（这将为您提供最佳性能和语法）：

```
library(data.table)
DT <- data.table(myDF) # where myDF is the original data.frame

DT[, list(AveragePrice = mean(Price),
          SumOfPrices = sum(Price)),
     by = Category] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-05T04:35:11.567

充实@Roman Lustrik的建议，从而`R`为简单起见保持基础：

```
df1 <- data.frame(
 Category=c(1,2,3,1,3,2),
 Price= c(10,5,20,25,5,15)
 )
aggregate(df1,by=list(df1[,"Category"]),FUN=mean) 
```

给出：

```
 Group.1 Category Price
1       1        1  17.5
2       2        2  10.0
3       3        3  12.5 
```

或者

```
tapply(df1[,"Price"], df1[,"Category"], mean) 
```

给出：

```
 1    2    3 
17.5  10.0 12.5 
```

（请注意`df1[,"Price"]==df1$Price`，可以使用任何一种样式）。就个人而言，我更喜欢输出，`aggregate()`而且速度更快，尽管在小型数据集上这是相当学术的：

```
require(microbenchmark)
microbenchmark( aggregate(df1,by=list(df1[,"Category"]),FUN=mean) )
microbenchmark( tapply(df1[,"Price"], df1[,"Category"], mean) ) 
```

给出（为清楚起见而简化）：

```
 min       lq    median       uq      max
2.233209 2.268719  2.311002 2.362932 4.018134
771.361 792.0915   807.2805 829.2435 1201.581 
```

最后，如果您希望输出与问题中的示例完全相同：

```
a1 <- aggregate(df1,by=list(df1[,"Category"]),FUN=mean )
a1 <- a1[,-1] # remove 1st column
a1[,2] <- format(a1[,2],nsmall=2) # give 2 decimal places
colnames(a1)[2] <- "AveragePrice" # assign name to 2nd column 
```

给出：

```
 Category AveragePrice
1        1        17.50
2        2        10.00
3        3        12.50 
```

# jsf-2 - 如何从 jsf 页面获取 BackingBean 的参数

> ID：15821929
> 
> 赞同：2
> 
> 时间：2013-04-04T21:20:04.247
> 
> 标签：jsf-2, primefaces

我的xhtml：

```
<ui:repeat value="#{c.voices}" var="v"> 
    <h:form enctype="multipart/form-data">  
        <p:fileUpload fileUploadListener="#{AddNote.handleFileUpload}"
            converterMessage="converterMessage"
            mode="advanced"  
            update="messages"  
            sizeLimit="100000"                                                 
            allowTypes="/(\.|\/)(gif|jpe?g|png)$/">
        </p:fileUpload>  
        <p:growl id="messages" showDetail="true"/>                                     
    </h:form> 
</ui:repeat> 
```

我的BackingBean：

```
 public void handleFileUpload(FileUploadEvent event) {
    //int v.id= here i need to know the v.id value from ui:repeater
    FacesMessage msg = new FacesMessage("Succesful", event.getFile().getFileName() + " is uploaded.");
    FacesContext.getCurrentInstance().addMessage(null, msg);
} 
```

**c.voices**是对象列表。每个对象都有属性**id**。我需要知道**handelFileUpload**中的**id**我怎样才能做到这一点？

 *** * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:18:30.243

我会简单地放入`v.id`一个隐藏字段：

你的xhtml：

```
<ui:repeat value="#{c.voices}" var="v">
    <h:form enctype="multipart/form-data">
        <input type="hidden" name="vid" value="#{v.id}" />
        <p:fileUpload fileUploadListener="#{AddNote.handleFileUpload}"
            converterMessage="converterMessage"
            mode="advanced"
            update="messages"
            sizeLimit="100000"
            allowTypes="/(\.|\/)(gif|jpe?g|png)$/">
        </p:fileUpload>
        <p:growl id="messages" showDetail="true"/>
    </h:form> 
</ui:repeat> 
```

然后使用`FacesContext`：

你的BackingBean：

```
public void handleFileUpload(FileUploadEvent event) {
    HttpServletRequest request = (HttpServletRequest) 
        FacesContext.getCurrentInstance().getExternalContext().getRequest();
    request.getParameter("vid"); // <= Here you are!
} 
```

**更新**

正如评论中所述，每次迭代都将拥有它自己`<h:form`的`<input type="hidden" name="vid"`。上传文件时，`handleFileUpload`将使用封闭表单的数据触发，因此`vid`将使用正确的参数发送`#{v.id}`

**更新 2**

正如 BalusC 评论的那样，您最好以`vid`这种方式获取参数：

```
public void handleFileUpload(FileUploadEvent event) {
     FacesContext.getCurrentInstance().getExternalContext()
        .getRequestParameterMap().get("vid") // <= Here you are!
} 
```**

# c# - 如何在侧面文本框中显示百分比（％）叹息

> ID：15821930
> 
> 赞同：-2
> 
> 时间：2013-04-04T21:20:05.467
> 
> 标签：c#, asp.net-mvc-3

我想通过使用带有属性的 DisplayFormat 属性在侧面文本框中显示百分比 (%) 符号。

我正在使用 MVC3

> **我的模型是**

```
public class CommodityParticularInfo : EntityBase
{
    private decimal? _standardReceived;
    public decimal? StandardReceived
    {
        get { return _standardReceived; }
        set { _standardReceived = value; }
    }
} 
```

> **视图是**

```
@Html.TextBoxFor(m => m.StandardReceived, new { @class = "textboxreadonly", @style = "width:100%", @ReadOnly = "ReadOnly" }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:34:00.523

尝试使用 0'%' 作为 DisplayFormatString，（单引号中的百分比）这应该有助于实现将百分比符号附加到您的数字。所以你得到33%。

您可以尝试的另一件事可能是 0\% （不确定它是否有效），但应该可以达到您想要的 33%。

[显示格式字符串，int 到百分比](https://stackoverflow.com/questions/9391851/display-format-string-int-to-percent)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:34:38.020

尝试：

```
 [DisplayFormat(DataFormatString = "{0:P2}")]     
 public decimal? StandardReceived
 {
       get { return _standardReceived; }
       set { _standardReceived = value; }
 } 
```

# javascript - 如何在 Web Worker 之间有效地共享状态？

> ID：15821931
> 
> 赞同：6
> 
> 时间：2013-04-04T21:20:07.200
> 
> 标签：javascript, html, concurrency, web-worker

我正在考虑将游戏移植到 HTML5，但遇到了一些问题。

游戏大量使用多线程，渲染在主线程上运行，脚本在工作线程上运行。多个脚本可以（并且经常）同时运行。它有相当数量的全局数据，任何脚本都可以访问，主要是读取，但偶尔也会写入。有机制确保线程安全不是问题。

看起来 HTML 5 Web Workers 可用于设置多线程，但让全局数据工作将是一个大问题，因为似乎没有任何简单的方法可以在工作人员之间共享数据。理论上，我可以将所有全局数据放在一个共享工作程序中，并让每个脚本工作程序向它发送消息以获取和设置数据，但是访问很常见，消息传递开销会完全破坏性能，特别是因为简单的读取会很远比写入更昂贵，并且可能需要某种 CPS 实现才能使其工作。

有什么好的方法可以将这样的架构移植到 HTML5 和 JavaScript 上吗？

# python - 在 Linux 中获取和设置 X11 剪贴板

> ID：15821932
> 
> 赞同：2
> 
> 时间：2013-04-04T21:20:07.520
> 
> 标签：python, linux, shell, x11, autokey

我在 Ubuntu 12.04 上的 WINE 中运行 Foxit Reader。我想将文本复制并粘贴到书签中，但我需要将其大写（例如，fusion 变为 Fusion）。我想按 F5 并运行 python 脚本。我知道 Autokey 可以做到这一点，但后者的剪贴板处理有一个[记录在案的错误。](https://code.google.com/p/autokey/issues/list?can=2&q=clipboard&colspec=ID%20Type%20Status%20Priority%20Milestone%20Owner%20Summary&cells=tiles)

所以，现在我正在寻找 Autokey 的剪贴板替代品。如果我的 python 脚本运行一个 shell，也许 shell 可以访问剪贴板？xclip 似乎很有希望，但它的文档说，“从标准文件中读取，或者从一个或多个文件中读取，并将数据作为 X 选择提供，以便粘贴到 X 应用程序中。” 我不需要标准或文件；我需要正确的 X11 剪贴板（又名选择）。

简而言之，python 或 shell 如何读取现有的 X11 剪贴板？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T22:05:41.903

```
xclip -o | sed 's/^./\U&/g' | xclip -i 
```

这将读取 X 剪贴板，将内容大写并覆盖它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:53:10.710

我意识到`-o`参数读取一个选择，但您必须指定您需要的：

```
xclip -selection clipboard -o 
```

从那里，我使用了这个[StackOverflow 答案](https://stackoverflow.com/questions/785078/getting-python-system-calls-as-string-results)。它工作得很好。

```
#read clipboard, avoid autokey's get_selection bug
tag = subprocess.Popen(["xclip","-selection", "clipboard", "-o"],stdout=subprocess.PIPE).communicate()[0]

#https://stackoverflow.com/questions/764360/a-list-of-string-replacements-in-python
mapping = { "'":'', ',':'', '"':'', ';':'', '(':'', ')':'', '.':'', '-':' '}
for k, v in mapping.iteritems():
    tag = tag.replace(k, v)

#Camelcase, remove spaces, and append Caesar tag
tag=tag.title().replace(' ','')+"_" 
```

# java - Java 从 Web 目录读取属性文件

> ID：15821933
> 
> 赞同：1
> 
> 时间：2013-04-04T21:20:15.533
> 
> 标签：java, netbeans, applet

我正在尝试`config.properties`从我的 JAR 本地目录中读取一个文件，该目录是从网站运行的。我尝试了一堆不同的代码，从 Streaming it 到获取类路径等。最后我现在尝试的是以下代码：

```
 FileInputStream f = new FileInputStream("./config.properties");
        if(f != null) {
            prop.load(f);
            db = prop.getProperty("database");
            dbuser = prop.getProperty("dbuser");
            dbpass = prop.getProperty("dbpass");
            host = prop.getProperty("host");
            iloc = prop.getProperty("iloc");
        } 
```

这在从 Netbeans 内部测试和运行时完美评估，但是第二次我将它放在网络上并运行它，它不再找到配置文件，即使它是同一个目录中的同一个文件。我试过有`./`没有，还是一样的结果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T21:52:21.767

你必须有一些绝对值或一些运行时参数。我们所做的是将应用程序主页作为系统属性。因此，当在 Windows 上启动 java 时它的 /app1 但在服务器上它的 /etc/app1

启动 java 或 javaw 时使用 -D

```
java -Dapp.home=/etc/app1 -Dapp.other=somevalue my.package.AppMain 
```

然后在我们的应用程序中，我们有一个 FileUtils 类，它在静态 init 中读取它并为其提供一个静态 getter。

样本

```
public class FileUtils{
    private static File appHome = null;
    static{
        String home = System.getProperty("app.home");//-D that you specify or some standard that java has see javadoc
        if(home == null){
            //logger as needed
            home = "/app1";

        }
        appHome = new File(home);
    }

    public static File getAppHome(){
        return appHome;
        }

    ... 
```

一个网站 - 运行 java 作为 Web 服务器/应用程序服务器也有一个文件系统。如果您无权访问它，那么您也无法编辑配置，对吗？如果您知道配置的路径但无法更改 java 命令，您可以执行以下操作：

**建议 1** 在您的开发系统上创建一个像 /dev/randome4343433Name.txt 这样的任意文件，如果该文件存在，您知道您在开发中，并使用该路径，否则转到服务器中的路径。

**建议2** 或者使用服务器上的路径。即使服务器是 linux 而 dev 是 windows，您也可以这样做，只需使用这个斜杠 / 并在 dev 驱动器中创建相同的文件系统，但不要在代码中提及驱动器号。所以如果在服务器上它位于 /etc/app1/config.txt 然后在本地驱动器上你开始创建一个 etc\app1 文件夹并将配置放在那里并且 uin 代码使用“/etc/app1/config.txt”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T22:07:13.203

对于 java.applet.Applet 或 JApplet 使用 获取嵌入此小程序的文档的 URL。然后创建一个新的 URL 添加到 config.txt 的路径，打开 URL 上的输入流，您可以在客户端读取文件。

请记住，您所做的一切都是在客户端上进行的，因此除非您在服务器上有一个 jsp 页面并使用小程序中的某些安全性（密码）连接到该页面，否则您无法回信

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-05T08:36:40.907

在 commons-configurations jar 中有这个类：

PropertiesConfiguration cfg = new PropertiesConfiguration("filePath");

只需检查一下

# c++ - 从 Netbeans 中的应用程序项目生成 .dll

> ID：15821935
> 
> 赞同：2
> 
> 时间：2013-04-04T21:20:23.373
> 
> 标签：c++, netbeans, dll

我在 NetBeans 中有一个应用程序项目 (C++)。当我构建它时，它会生成 .exe 程序。有没有办法生成.dll，或者我必须创建一个动态库项目并将我所做的一切复制到其中。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T22:06:50.663

1.  转到项目的“项目属性”。
2.  选择左侧的“构建”。
3.  单击“配置类型”并选择“动态库”。

您还可以通过按管理配置按钮添加用于构建动态库的新配置。

# javascript - 为什么两个函数定义的结果用逗号连接？

> ID：15821940
> 
> 赞同：10
> 
> 时间：2013-04-04T21:20:52.823
> 
> 标签：javascript, return-value, anonymous-function

为什么以下代码会发出警报`2`？

```
var f = (function x(){ return 1; }, function y(){ return 2; })();
alert(f); 
```

我能看到的是，`y`函数正在以某种方式被执行并且`x`函数被忽略了。（我确保我把`alert`两个函数都放进去，只有`alert`in`y`被调用，这让我相信这个`x`函数根本没有被调用）

如果我删除该`y`功能，那么它会发出警报`1`。

这是怎么回事？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-04T21:22:11.243

好的，让我们稍微分解一下。

```
(function x(){ return 1; }, function y(){ return 2; }) 
```

是两个函数字面量。接下来使用[逗号运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)。它计算表达式（两个函数）并返回最后一个。这个表达式的结果是：`function y(){ return 2; }`

这意味着剩下的表达式是：`var f = (function y(){ return 2; })();`

我们接下来要做的是调用它（使用`()`），它将 2 返回到变量中`f`；

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-04T21:24:14.200

当您使用[逗号运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)时，返回的值是最后一个元素的值，在您的情况下，函数`y()`（返回 2）

来自 Mozilla 文档：

> 逗号运算符计算其两个操作数（从左到右）并返回第二个操作数的值。
> 
> 当您想在需要单个表达式的位置包含多个表达式时，可以使用逗号运算符。此运算符最常见的用法是在 for 循环中提供多个参数。

# c++ - 收到此错误时如何实现非托管线程安全集合： 使用 /clr 编译时不支持

> ID：15821942
> 
> 赞同：30
> 
> 时间：2013-04-04T21:21:00.850
> 
> 标签：c++, multithreading, thread-safety, c++-cli, mutex

我有一个 C++ 应用程序，它由非托管 C++、托管 C++ 和 c# 组成。在非托管部分，我尝试使用 std::mutex 创建线程安全集合。

但是，当我使用互斥锁时，出现以下错误；

> 错误 C1189：#error : <mutex> 在使用 /clr 或 /clr:pure 编译时不受支持。

知道为什么我不能使用互斥锁吗？有人可以推荐一个替代品，以便我可以创建一个线程安全的非托管集合吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-04T22:12:40.427

不支持它，因为 std::mutex 实现使用 GetCurrentThreadId()。这是一个不应在托管代码中使用的 winapi 函数，*因为*它可能在不使用线程来实现线程的自定义 CLR 主机上运行。

这是一个很好的问题，它表明您正在构建错误的代码。您的本机 C++ 正在使用 /clr 进行编译。效果太好了，所有符合 C++03 的代码都可以编译为 MSIL 并在运行时即时编译，就像托管代码一样。您不希望这种情况发生，您的本机 C++ 代码应该编译为机器代码并获得编译时代码优化器的喜爱。

在您的项目中关闭此源代码文件以及可能的其他文件的 /clr 选项。右键单击 + 属性，常规。如果`mutex`.h 文件中出现您必须 #include 在 C++/CLI 源文件中，那么您遇到了更大的问题，请使用接口或 pimpl 隐藏实现细节。

# azure - 测试平板电脑上 Azure Compute Emulator 中托管的 Win8 应用

> ID：15821950
> 
> 赞同：0
> 
> 时间：2013-04-04T21:21:37.497
> 
> 标签：azure, azure-compute-emulator

我在 Windows Azure Compute Emulator 中运行的 Visual Studio 2012 中有两个 Web 应用程序（使用 IIS Web 服务，而不是 Express）。此外，我在另一个使用两个 Azure Web 应用程序的 Visual Studio 实例中有一个 Windows 8 应用程序。这种组合在同一台机器上运行良好。

出于演示目的，我想在 Windows RT 平板电脑上运行该应用程序。因此，我使用远程调试工具在平板电脑上运行应用程序。运行应用程序不是问题。但我没有找到从平板电脑连接到 Web 应用程序的可能性。azure Emulator 生成类似 127.0.0.X:81 的 URL，但平板电脑无法解析此地址。

有解决我的问题的解决方法吗？一种使用我的开发机器的 IP 地址运行天蓝色应用程序的方法？或者是否可以创建一种在开发机器上运行的代理，将来自平板电脑的请求转发到 azure 应用程序？

我已经看到了将提琴手作为反向代理运行的可能解决方案。这对我不起作用，因为提琴手似乎只在一个端口上监听。但我需要两个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-08T18:39:02.823

另一种可能性是配置 Azure 模拟器终结点。

查看[此 SO 答案](https://stackoverflow.com/questions/16778456/accessing-azure-emulator-from-another-device)以获取更多信息。

# python - mysql和python日期时间

> ID：15821953
> 
> 赞同：2
> 
> 时间：2013-04-04T21:21:54.773
> 
> 标签：python, mysql, insert, sqlalchemy

我正在尝试通过使用包将记录插入`mysql`数据库。`python``sqlalchemy`

我有`datetime`在 mysql 中输入的列，这些列已经通过加载表内联命令接受了以下格式的数据：

```
'2013-04-03 00:05:00-05:00' 
```

请注意，这是由`pytz`python 中的模块生成的。`load table inline <file_name>`使用命令通过 mysql 控制台加载具有完全相同格式的日期时间戳的 600,000 行没有问题。MySql 在加载时接受它们，但我不确定它是否维护时区信息。这对我来说真的没关系，因为我还有 3 个其他列，它们代表我感兴趣的其他时区的日期时间。所以我知道哪一列代表 EST/EDT 或 CST/CDT，如果我愿意，我可以根据它进行查询. 我不会在 mysql 中进行任何时区转换，因为我已经有代表感兴趣时区的列。

这是按照mysql的文档：

```
The DATETIME type is used for values that contain both date and time parts. MySQL
retrieves and displays DATETIME values in 'YYYY-MM-DD HH:MM:SS' format. The supported
range is '1000-01-01 00:00:00' to '9999-12-31 23:59:59'. 
```

问题是该`pytz`模块在我尝试插入的日期时间戳中提供有关时区的信息。我实际上有 4 列`(EST, UTC, EST/EDT and CST/CDT)`，所以它们的时区信息都嵌入在日期时间戳中。

注意我没有使用自定义`INSERT`查询。这是 sqlalchemy 执行多次插入的默认方式：

执行插入的函数如下所示：

```
def insert_data(data_2_insert, table_name):
    # Connect to database using SQLAlchemy's create_engine()
    engine = create_engine('mysql://blah:blah@localhost/db_name')
    # Metadata is a Table catalog. 
    metadata = MetaData()
    my_table = Table(table_name, metadata, autoload=True, autoload_with=engine)
    column_names = tuple(c.name for c in my_table.c)
    final_data = [dict(zip(column_names, x)) for x in data_2_insert]
    ins = my_table.insert()
    conn = engine.connect()
    conn.execute(ins, final_data)
    conn.close() 
```

错误信息：

```
 Traceback (most recent call last):
      File "script.py", line 191, in <module>
        main()
      File "script.py", line 39, in main
        insert_data(file_csv, table_name)
      File "script.py", line 58, in insert_data
        conn.execute(ins, final_data)
      File "/usr/lib/python2.6/site-packages/sqlalchemy/engine/base.py", line 824, in execute
        return Connection.executors[c](self, object, multiparams, params)
      File "/usr/lib/python2.6/site-packages/sqlalchemy/engine/base.py", line 874, in _execute_clauseelement
        return self.__execute_context(context)
      File "/usr/lib/python2.6/site-packages/sqlalchemy/engine/base.py", line 894, in __execute_context
        self._cursor_executemany(context.cursor, context.statement, context.parameters, context=context)
      File "/usr/lib/python2.6/site-packages/sqlalchemy/engine/base.py", line 960, in _cursor_executemany
        self._handle_dbapi_exception(e, statement, parameters, cursor, context)
      File "/usr/lib/python2.6/site-packages/sqlalchemy/engine/base.py", line 931, in _handle_dbapi_exception
        raise exc.DBAPIError.instance(statement, parameters, e, connection_invalidated=is_disconnect)
    sqlalchemy.exc.OperationalError: (OperationalError) (1292, "Incorrect datetime value: '2013-04-03 00:05:00-05:00' for column 'rtc_date_est' at row 1") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-20T02:04:10.960

似乎 SQLAlchemy 不尊重 MySQL DATETIME 格式。SQLAlchemy 正在尝试将时区感知格式放入 MySQL DATETIME 中，该格式不支持基于每行的时区 AFAIK。

解决方案是从您的日期时间对象中删除时区信息。将它们转换为与 MySQL 默认值（UTC、EST 等）匹配的时区后，执行以下操作：

```
date_value = date_value.replace(tzinfo=None) 
```

其中 date_value 是最终传递给 SQLAlchemy 对象的日期时间对象。

# config - 序列化 Typesafe Config 对象

> ID：15821961
> 
> 赞同：30
> 
> 时间：2013-04-04T21:22:20.793
> 
> 标签：config, typesafe-stack

我想将 Config 对象（[https://github.com/typesafehub/config](https://github.com/typesafehub/config)）作为序列化字符串（可能是 JSON ??）保存，并在需要时将其读回。但是，我没有在支持的 Config api 文档上找到任何 API。对此的任何帮助表示赞赏。

我试过

```
config.toString 
```

但结果看起来像

配置（SimpleConfigObject（{...data}））

* * *

## 回答 #1

> 赞同：67
> 
> 时间：2013-05-25T03:33:20.600

试试这个：

```
config.root().render(ConfigRenderOptions.concise()) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-08-06T15:30:55.893

当然你也可以调整一些参数，例如：

```
val renderOptions = ConfigRenderOptions
  .defaults()
  .setOriginComments(false)
  .setComments(false)
  .setFormatted(true)

println(config.root().render(renderOptions)) 
```

# opengl - 修改OpenGL顶点缓冲区的正确方法是什么？

> ID：15821969
> 
> 赞同：38
> 
> 时间：2013-04-04T21:22:36.677
> 
> 标签：opengl

我在 OpenGL 中设置了一个顶点缓冲区，如下所示：

```
int vboVertexHandle = glGenBuffers();
glBindBuffer(GL_ARRAY_BUFFER, vboVertexHandle);
glBufferData(GL_ARRAY_BUFFER, vertexData, GL_DYNAMIC_DRAW); 
```

稍后，如果我想向“vertexData”添加或删除顶点，那么正确的方法是什么？甚至可能吗？我假设我不能直接修改数组而不将其重新发送到 GPU。

如果我修改了 vertexData 数组，那么再次调用它：

```
glBindBuffer(GL_ARRAY_BUFFER, vboVertexHandle);
glBufferData(GL_ARRAY_BUFFER, vertexData, GL_DYNAMIC_DRAW); 
```

...这会用我的新数据覆盖旧缓冲区吗？还是我也必须删除旧的？有没有更好的办法？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-04-05T00:09:14.687

任何 OpenGL 缓冲区对象的大小都是在您调用`glBufferData`. 也就是说，OpenGL 将分配您在第二个参数中指定的内存量`glBufferData`（OP 中没有列出）。事实上，如果你调用，例如`glBufferData( GL_ARRAY_BUFFER, bufferSize, NULL, GL_DYNAMIC_DRAW );`OpenGL 将创建一个*未初始化数据*`bufferSize`字节的缓冲区。

 *`glBufferSubData`您可以使用、`glMapBuffer`或任何其他用于传递数据的例程加载任意数量的数据（最多为缓冲区的大小） 。调整缓冲区大小的唯一方法是`glBufferData`使用相同缓冲区 id 的新大小（从 返回的值`glGenBuffers`）调用。

也就是说，您始终可以使用缓冲区中的数据子集（这类似于删除顶点），并且如果您使用 渲染`glDrawElements`，则可以随机访问缓冲区中的元素。将顶点添加到缓冲区需要分配更大的缓冲区，然后您需要重新加载缓冲区中的所有数据。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-04T23:03:57.137

[http://www.opengl.org/wiki/GLAPI/glBufferData](http://www.opengl.org/wiki/GLAPI/glBufferData)

> glBufferData 为当前绑定到目标的缓冲区对象创建一个新的数据存储。任何预先存在的数据存储都将被删除。

这解释了调用`glBufferData`将“重新分配”数据，缓冲区将具有新的大小。所有旧数据都将丢失。如果您只想写入缓冲区的一部分，请`glBufferSubData`改用。

[http://www.opengl.org/wiki/GLAPI/glBufferSubData](http://www.opengl.org/wiki/GLAPI/glBufferSubData)

编辑：`glBufferSubData`仅当您要替换数据时；要调整缓冲区大小，您必须调用`glBufferData`.

此外，您不必先销毁缓冲区并生成一个新缓冲区。请记住，GLuint 只是 OpenGL 的一种“指针”。它不是实际的存储，因此重用相同的“指针”是完全可以的（当然，如果你还没有删除它）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-04-25T12:05:19.837

1 通过使用 glMapBuffer

```
void mapBuffer(uint &id, void *data, uint size, uint type) {
    glBindBuffer(type, id);
    // get pointer
    void *ptr = glMapBuffer(type, GL_WRITE_ONLY);
    // now copy data into memory
    memcpy(ptr, data, size);
    // make sure to tell OpenGL we're done with the pointer
    glUnmapBuffer(type);
} 
```

2 通过使用 glBufferSubData

```
 void updateBuffer(uint &id, uint offset, void *data, uint size, uint type) {
        glBindBuffer(type, id);
        glBufferSubData(type, offset, size, data);
    } 
```

指定要替换的数据存储区域的大小（以字节为单位）

```
mapBuffer(vbo, vertex.data(), sizeof(uint)*vertex.size(), GL_ARRAY_BUFFER);
resetBuffer(vbo, vertex.data(), sizeof(uint)*vertex.size(), GL_ARRAY_BUFFER);
updateBuffer(vbo, 0, vertex.data(), sizeof(uint)*vertex.size(), GL_ARRAY_BUFFER); 
```

如果你想要你也可以使用 `glBufferData`-> 但它会删除所有旧数据并重用相同的缓冲区 `glInvalidateBufferSubData`-> 它在所有地方都设置为 NULL，现在你可以提供自己的数据。*

# shell - Shell脚本移动同名文件

> ID：15821974
> 
> 赞同：-2
> 
> 时间：2013-04-04T21:22:41.357
> 
> 标签：shell

我想制作一个定期运行的 shell 脚本来检查和移动我的视频文件（如果它们有关联的字幕）

有点像这样：

```
sourceDir = "/volume/mount/Videos";
destinationDir = "/volume/mount/VideosWithSubtitles";
validExtensions = ["avi", "mkv", "mp4"]

for every file in sourceDir that has a "validExtension"
check if a file with the same name but with a ".srt" extension exists
if it does, move both of them to "destinationDir" 
```

我不熟悉 shell 脚本，因此感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T09:20:42.597

快速而肮脏，改变以满足您的需求

```
destinationDir=/tmp/dest
sourceDir=/tmp/src
set -x
cd $sourceDir
for i in *.mp4 *.mkv *.avi; do  
    if [ -f "${i%.*}.srt" ]; then 
        mv $i $destinationDir
        mv ${i%.*}.srt $destinationDir
    fi
done

set +x 
```

输出：

```
hvn@lappy: /tmp () $ bash myscript.sh
+ cd /tmp/src
+ for i in '*.mp4' '*.mkv' '*.avi'
+ '[' -f ghk.srt ']'
+ for i in '*.mp4' '*.mkv' '*.avi'
+ '[' -f xyz.srt ']'
+ for i in '*.mp4' '*.mkv' '*.avi'
+ '[' -f abc.srt ']'
+ mv abc.avi /tmp/dest
+ mv abc.srt /tmp/dest
+ set +x 
```

在此处阅读有关 %.* 的更多信息： [在 Bash 中提取文件名和扩展名](https://stackoverflow.com/questions/965053/extract-filename-and-extension-in-bash)

# vba - 在 VBA 中捕获“数据范围太复杂”错误

> ID：15821977
> 
> 赞同：0
> 
> 时间：2013-04-04T21:22:55.803
> 
> 标签：vba, excel, excel-2007

在我正在处理的 excel 宏中，我将过滤后的数据复制到新工作表以删除隐藏的行。这使我可以对用户过滤的数据运行更复杂的公式。对于经过复杂过滤的大型数据集，复制操作不再只获取过滤后的数据，而是复制所有数据。

手动复制过程时，当我尝试复制过滤的数据时，Excel 给了我“数据范围太复杂”的错误。这很容易通过排序然后过滤来解决，但是我不知道如何在 VBA 中捕获这个错误。我想知道复制操作是否正常工作（并允许宏继续）或者选择是否太复杂（并停止宏并提醒用户先尝试排序）。

知道我该怎么做吗？任何帮助，将不胜感激。

相关代码如下：

```
 Select Case Range("GDT_Filtered").Value
    Case "Filtered Data"
        Worksheets.Add after:=Worksheets(Worksheets.Count)
        Set wRaw = ActiveSheet
        Sheets("Raw Data").Select
        lastRow = Range("A1").End(xlDown).Row
        Range("A1:S" & lastRow).Copy Destination:=wRaw.Range("A1")

    Case "All Data"
        Set wRaw = Sheets("Raw Data")
        On Error Resume Next
        wRaw.ShowAllData
        On Error GoTo 0
    End Select 
```

谢谢！

山姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T14:42:29.773

好吧，我想出了一个可管理的解决方法。

假设原始数据存储在工作表 wOne 中，并将过滤后的数据复制到工作表 wTwo，以下代码将通过检查过滤和每个工作表中的行数来发现错误：

```
' Excel can't copy too many discontinuous sections. If it happens it won't throw
' an error but will copy ALL data instead of just filtered data. This checks that
' such an error has not occurred.
If wOne.AutoFilter.FilterMode = True Then
    If wOne.range("A1").End(xlDown).Row = wTwo.Range("A1").End(xlDown).Row Then
        MsgBox "Filtering has produced too many discontinuous selections. " & _ 
                "Try removing the filters, sorting data by the variables " & _ 
                "you wish to filter with, reapplying the filters, and " & _
                "trying again. Good luck!"
        GoTo 1
    End If
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T21:28:03.587

使用 OnError

```
sub 

   On Error Goto 1

   do the copy, if it fails, code will jump to 1.

   On Error Goto 0 'zero means you are not doing any treatment for further errors

   continue the code

   exit sub 'you don't want the code to do error treatment below if there's no error

   1 Do what you need if error occurs

end sub 
```

# maven - CATALINA_HOME 和 Maven + LOG4J

> ID：15821978
> 
> 赞同：2
> 
> 时间：2013-04-04T21:22:56.663
> 
> 标签：maven, log4j

我在 log4j 中有这一行：

**log4j.appender.FILE.File=${catalina.home}/logs/debug.log**

当我从 IntelliJ 运行项目时完美运行。

但是当我尝试运行 TestNG 测试（来自 maven）时，它失败了：

**log4j:ERROR setFile(null,true) 调用失败。java.io.FileNotFoundException: /logs/debug.log (没有这样的文件或目录)**

我可以硬编码路径，一切都会好的。但我不想要那个解决方案，因为我可以部署在 ${catalina.home} 位于不同位置的各种系统上。

我在 mac 上开发并在 freebsd 和 centos 上部署。Tomcat 一直在不同的地方。我可以使用 /var/log/myapp.log 但是......

有什么方法可以用日志文件路径定义一个公共变量（在 IntelliJ 和运行 maven 测试时可用）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-05T01:35:34.487

请尝试使用不存在时将激活[的 Maven Profile以及](http://maven.apache.org/guides/introduction/introduction-to-profiles.html)[Maven Surefire Plugin:Using System Properties](http://maven.apache.org/surefire/maven-surefire-plugin/examples/system-properties.html)。`${env.catalina.home}`

```
<profile>
   <id>mock-catalina-home</id>
   <activation>
      <property>
         <name>!env.catalina.home</name>
      </property>
   </activation>
    <build>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-surefire-plugin</artifactId>
                <version>2.14</version>
                <configuration>
                    <encoding>UTF-8</encoding>
                    <systemProperties>
                        <property>
                            <name>catalina.home</name>
                            <value>PATH_TO_CATALINA_HOME</value>
                        </property>
                    </systemProperties>
                </configuration>
            </plugin>
        </plugins>
    </build>
</profile> 
```

请注意，[Maven 属性](http://www.sonatype.com/books/mvnref-book/reference/resource-filtering-sect-properties.html)`PATH_TO_CATALINA_HOME`也可以引用它。例如

```
<systemProperties>
    <property>
        <name>PATH_TO_CATALINA_HOME</name>
        <value>${my.dev.catalina.home}</value>
    </property>
</systemProperties> 
```

这将帮助我们定义`${my.dev.catalina.home}`不同的值。

我希望这可能会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T23:09:01.513

为了使 log4j 属性文件在从 maven 运行测试时获得 ${catalina.home} 的正确值，它需要位于由 maven 过滤的文件中（src/main/resources 是这样的文件的目录）。此外，变量 'catalina.home' 需要在 maven 中设置。您可以创建一个使用环境变量的变量 AKA maven 属性，以便您可以为每台机器上的 tomcat 安装定义不同的位置：

```
<properties>
  <catalina.home>${env.catalina.home}</catalina.home>
<properties> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-05-22T04:08:58.947

您还可以指定与您的用户帐户的主目录相关的日志文件的位置。

在 log4j 中，这将使用以下格式：${user.home}/weblogs/log4j1.log

在 log4j 2 中，这将使用以下格式：${sys:user.home}/weblogs/log4j2Rolling.log

log4j 2 可以使用 Java 系统属性、环境变量或 Maven 属性

# google-drive-api - 使用搜索查询列出文件会返回超出范围的结果（drive.files.list 调用，使用 drive.files 范围）

> ID：15821979
> 
> 赞同：1
> 
> 时间：2013-04-04T21:23:00.917
> 
> 标签：google-drive-api

我在使用 Google Drive SDK 时遇到了一个奇怪的问题——我不确定这是设计行为还是范围界定中的错误。

快速背景：我们正在使用“drive.files”范围开发应用程序（例如，仅由我们的应用程序创建的文件/文件夹）并且我们想要列出由我们的应用程序创建的所有文件夹。所以我们使用 drive.files.list 方法调用（使用 Javascript 客户端 API），并查询驱动文件夹 mimeType：

```
mimeType = 'application/vnd.google-apps.folder' 
```

**问题**：返回的是用户云端硬盘帐户中*所有*文件夹的列表，而不仅仅是我们的应用程序创建的文件夹。

这不是公然违反范围吗？据我所知，文档并没有说明我们是否应该期望看到搜索查询返回的超出范围的文件。

可以使用 Google API 资源管理器重复此行为：

1.  打开 Google API[资源管理器：Google API 资源管理器：drive.files.list，查询为空](https://developers.google.com/apis-explorer/#s/drive/v2/drive.files.list?_h=3&)
2.  将 OAuth 授权打开，仅使用 drive.file 授权。
3.  使用空查询单击“执行”。结果列表应为空。
4.  现在，在“q”参数框中输入文件夹查询：

    mimeType = '应用程序/vnd.google-apps.folder'

5.  单击“执行”。结果列表显示用户云端硬盘帐户中*尚未*由 API Explorer 应用程序创建的文件夹。

我在这里错过了什么吗？这是预期的行为吗？如果是这样 - 有没有更好的方法来获取仅由我们的应用程序创建的文件夹列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T22:25:54.390

Thanks for the report. The issue has been fixed and should work as expected now.

# ios - 如何更改同一视图中显示的图表？

> ID：15821980
> 
> 赞同：0
> 
> 时间：2013-04-04T21:23:11.027
> 
> 标签：ios, xcode

如何更改同一视图中显示的图表？

我在视图控制器中有一个视图。这个视图里面有另一个视图，我已经分配了一个自定义类（子类 UIView）。此自定义类具有在此视图中绘制交互式图表的代码。交互代码由主视图中的滑块操作。我在界面生成器中拥有所有这些。

如果我想在这个视图中绘制一个完全不同的图表怎么办？我希望能够使用一组不同的绘图代码为这个视图分配一个新类？但是怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:55:27.447

有很多方法可以做到这一点，但[不建议](https://stackoverflow.com/questions/8512793/objective-c-how-to-change-the-class-of-an-object-at-runtime)在运行时[更改类](https://stackoverflow.com/questions/211616/hidden-features-of-objective-c/679866#679866)

这里有一些建议：

1 / 将 customView1 替换为与您的第一个视图相同位置的正确类型的不同视图实例...

```
 self.customView2 = [[CustomView2 alloc] initWithFrame:self.customView1.frame];
   [self.view addSubView:self.customView2];
   [self.customView1 removeFromSuperView]; 
```

此示例为每个交换的子视图使用不同的属性，但您可以使用单个属性来引用当前子视图 - 这可以帮助链接您的滑块以对图表执行正确的操作。如果你做了很多这样的事情，你将需要考虑内存问题——当 customView1 消失时，你会重用它吗？您可以将其保留在（强）属性中（更快，需要更多内存），或者每次都创建一个新属性（更慢，需要更少内存）。

2 / 如果你想在它们之间切换，你可以将它们放在 Interface Builder 中并切换它们的`hidden`属性或它们在视图层次结构（`self.view.subviews`数组）中的顺序。无需不断地重新创建视图。

3（更好...）/保留 UIView 的单个子类并使用属性来影响绘制的图表...

```
 //CustomView.h

 @property (nonatomic,assign) BOOL drawDiagram1;
 @property (nonatomic, assign) BOOL drawDiagram2;

 //CustomView.m

 - (void)drawRect {
    if (drawDiagram1) [self drawDiagram1];
    if (drawDiagram2) [self drawDiagram2];
 }

- (void) drawDiagram1 { 
     //drawDiagram1 code here
}

- (void) drawDiagram2 {
     //drawDiagram2 code here
} 
```

# c# - WPF内存问题

> ID：15821983
> 
> 赞同：1
> 
> 时间：2013-04-04T21:23:20.403
> 
> 标签：c#, wpf, memory, memory-management, memory-leaks

我正在尝试使用以下代码加载图片：

```
void LoadPictures(int s)
{
    grdScene.Children.Clear();
    TabControl tab = new TabControl();
    for (int i = s; i <= s+3; i++)
    {
        System.Drawing.Bitmap bmp = new System.Drawing.Bitmap("C:\\img\\" + i + ".png");
        TabItem tabItem = new TabItem();
        tabItem.Header = "Scene " + i;
        var bitmapSource = System.Windows.Interop.Imaging.CreateBitmapSourceFromHBitmap(bmp.GetHbitmap(),
                                                                    IntPtr.Zero,
                                                                    Int32Rect.Empty,
                                                                    BitmapSizeOptions.FromEmptyOptions());
        Image image = new Image();
        image.Source = bitmapSource;
        tabItem.Content = image;
        tab.Items.Add(tabItem);
    }
    grdScene.Children.Add(tab);//grdScene is Grid
} 
```

它工作正常，但每次我运行此方法时，内存都会增加。然后我尝试将所有项目设置为`null`，但没有成功。这是代码：

```
foreach (var child in grdScene.Children)
{
    TabControl tab1 = (TabControl)child;
    foreach (TabItem item in tab1.Items)
    {
        Image img = (Image)item.Content;
        img = null;
    }
    tab1 = null;
} 
```

我试过`GC.Collect()`但没有任何改变。我应该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T21:26:52.843

你为什么要通过代码隐藏来做到这一点？

从您的代码的外观来看，选项卡项完全由图像填充。

您可以将选项卡控件绑定到图像路径集合并使用样式来描述您所追求的外观，这会简单得多，然后 WPF 核心将负责图像加载和内存管理本身。

* * *

如果这对您不可用，那么您的问题来自您如何加载图像，您是通过不安全的互操作方法进行的，不会为您释放内存，您必须自己处理位图`.Dispose()`

你最好这样做：[在 WPF 中加载 BitmapImage 的源代码？](https://stackoverflow.com/questions/11771223/loading-the-source-of-a-bitmapimage-in-wpf)

`BitmapImage`如果您想继续在代码隐藏而不是互操作方法中进行操作，使用可能是更好的方法。

所以：

```
 void LoadPictures(int s)
    {
        grdScene.Children.Clear();
        TabControl tab = new TabControl();
        for (int i = s; i <= s + 3; i++)
        {
            BitmapImage bmp = new BitmapImage(new Uri("C:\\img\\" + i + ".png"));
            TabItem tabItem = new TabItem();
            tabItem.Header = "Scene " + i;
            tabItem.Content = new Image(){Source = bmp};
            tab.Items.Add(tabItem);
        }
        grdScene.Children.Add(tab);
    } 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T21:27:26.143

尝试在所有s 上调用*Dispose*`IDisposable`，例如`System.Drawing.Bitmap`或更好地使用`using`..

```
using(var bmp = new System.Drawing.Bitmap("C:\\img\\" + i + ".png"))
{
     .....
} 
```

# c - 在 C 中调用结构

> ID：15821989
> 
> 赞同：-1
> 
> 时间：2013-04-04T21:23:36.133
> 
> 标签：c, struct

我有以下代码：

```
typedef struct {
   double x, y;
} point_t ;

typedef struct {
    point_t a, b, c;
} triangle_t;

int read_point(point_t * const point) {
    int status = scanf(" (&lf,&lf)", &point_t.x, &point_t.y);
    return(status);
} 
```

我正在尝试读取用户为三角形的顶点输入的 x 和 y 坐标（点 a、b 和 c）。但是，我在 scanf 函数中强调两个“point_t”实例时遇到了一个奇怪的错误.

> 不允许使用类型名称。

这是怎么回事？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-04T21:26:12.257

将其更改为：

```
int status = scanf(" (%lf,%lf)", &(point->x), &(point->y)); 
```

记住使用变量名`point`，而不是类型名`point_t`。同样重要的是要注意您必须`->`在指针类型上使用运算符（这相当于取消引用它然后使用成员运算符 [ `p->x == (*p).x`]）。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-04-04T21:32:00.533

试试这个代码

```
typedef struct {
   double x;
   double y;
} point_t ;

typedef struct {
    point_t a;
    point_t b
    point_t c;
} triangle_t;

int read_point(point_t * point) {
    int status = scanf(" (&lf,&lf)", point->x, point->y);
    return(status);
} 
```

我认为在结构中，你应该用它的类型声明每个字段；多个声明 as`int x,y`不起作用。其次，您正在传递一个指针，因此要访问您应该以这种方式使用您的参数的名称（“point”是这种情况）`point->field`或`(*point).field`不使用`&point`！

# python - 如何在 MySQL Workbench 中使用 Python 脚本执行 SQL 查询

> ID：15821995
> 
> 赞同：5
> 
> 时间：2013-04-04T21:23:56.803
> 
> 标签：python, mysql, mysql-python, mysql-workbench, database-administration

我想从 MySQL Workbench 中的 Python 脚本环境执行 SQL 查询。我查看[了 grt 模块的 MySQL Workbench 文档](http://mysqlworkbench.org/workbench/doc/globals/classdb__query___editor.html#ad52e9a8a82cbe53845b4b820e4897ae8)并找到了 executeScript 方法，但我似乎无法使用它来进行查询。

执行此 Python 代码：

```
import grt

querystring = "select * from Purchases WHERE PurchaseAmount > 600 and PurchaseAmount < 2500"
executeScript(querystring) 
```

产生以下错误消息：

```
Uncaught exception while executing [filepath]runquery.py:

File "[filepath]runquery.py", line 10, in <module>

executeScript(querystring)

NameError: name 'executeScript' is not defined 
```

我不明白 virtual *grt::ListRef executeScript ( const std::string & sql )*是什么意思，所以我无法正确格式化我的查询，但是，错误消息似乎表明 executeScript 方法无论如何都不存在。我查看的大多数文档都有格式正确的函数调用示例，但我似乎找不到任何用于 executeScript 的文档。

我想做的只是在 MySQL Workbench Python 脚本环境中将我的字符串作为 SQL 查询运行。

谢谢！

我是 Python 和 SQL 的新手，所以请耐心等待。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-02-21T11:39:47.403

要运行 executeScript 函数，您需要与 sqleditor 对象进行交互。为了进行测试，请在 MS Windows 上使用示例数据库执行以下操作：

1.  启动 MySQLWorkbench
2.  连接到本地数据库
3.  从 SCHEMAS 中选择 sakila
4.  使用 Tools->scripting shell 或 (Ctrl+F3) 启动脚本 shell
5.  添加新的python脚本（test.py）
6.  使用以下内容保存脚本
7.  在脚本外壳中运行脚本

脚本内容：

```
import grt

result = grt.root.wb.sqlEditors[0].executeScript("select * from actor limit 10;")

for col in result[0].columns:
    print col.name 
```

要了解如何在脚本中引用对象，很容易使用 Globals Tree 面板的类浏览器并使用鼠标右键单击对象并选择“Copy Path for Python”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-12T17:22:42.790

如果您需要在 Windows 中从命令行运行脚本，您可以运行类似以下命令：

```
"C:\Program Files\MySQL\MySQL Workbench 6.1 CE\MySQLWorkbench.exe" -query "Local instance MySQL56" -run-python "execfile('c:\Users\Root\AppData\Roaming\MySQL\Workbench\scripts\script.py')" -log-to-stderr -v 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T21:57:41.560

（第一个）问题似乎是您使用了一个名为 executeScript() 的函数，该函数尚未定义或从任何地方获取。如果它在 grt 模块中（我不熟悉），则必须按以下方式进行：

```
from grt import executeScript

querystring = "select * from Purchases WHERE PurchaseAmount > 600 and PurchaseAmount < 2500"
executeScript(querystring) 
```

# android - 如何在 appwidget 中更改 Android TextView Drawable

> ID：15821996
> 
> 赞同：1
> 
> 时间：2013-04-04T21:23:58.080
> 
> 标签：android, android-appwidget

我有一个 Android AppWidget，它在 textview 的左侧使用 Drawable。我想在某些时候用不同的图像更新该 Drawable，但看不到使用 RemoveViews 的方法。这可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2016-09-22T18:53:20.690

从 API 16 开始，您可以使用`remoteView.setTextViewCompoundDrawables(int, int, int, int);`，但它只接受来自资源的可绘制对象，而不接受位图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-04T21:28:18.897

如果您的意思是在 RemoteView 上使用 drawableLeft，我认为没有办法。

您需要修改布局并使图像成为单独的对象，例如使用 ImageView 并将其放置在 TextView 旁边。

然后打电话...

```
remoteView.setImageViewBitmap(R.id.imageViewId, myBitmap); 
```

# sql - 大表大小的 SQL 查询

> ID：15821999
> 
> 赞同：1
> 
> 时间：2013-04-04T21:24:11.860
> 
> 标签：sql

需要帮助在 SQL 数据库中查找相似值。表结构如：

```
 id         |        item_id_nm |      height |    width |     length |     weight
    ----------------------------------------------------------------------------------
    1          |       00000000001 |      1.0    |     1.0  |        1.0 |         1.0
    2          |       00000000001 |      1.1    |     1.0  |        0.9 |         1.1
    3          |       00000000001 |      2.0    |     1.0  |        1.0 |         1.0
    4          |       00000000002 |      1.0    |     1.0  |        1.0 |         1.0
    5          |       00000000002 |      1.0    |     1.1  |        1.1 |         1.0
    6          |       00000000002 |      1.0    |     1.0  |        1.0 |         2.0 
```

id 显然不能有重复项， item_id_nm 可以有重复项（实际上可以发生多次，也就是 > 2）。

您将如何形成 SQL 以查找重复的 item_id_nm，但仅当高度或宽度或长度或重量的值相差 > 30% 时才查找重复的 item_id_nm。

我知道它需要遍历表，但是我该如何进行检查。谢谢您的帮助。

编辑：包括 %30 差异的示例。id = 3 与 id 1 和 2 的 1.0（或 1.1）有 200% 的高度差异。很抱歉不清楚，但高度、宽度、长度或重量的每个值都可能有 30% 的差异，并且如果其中一个有 30% 的差异，它将被视为与其他的重复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:37:29.367

这应该为您提供与平均值相差 30% 或更多的行：

```
SELECT t1.*
FROM tbl t1
INNER JOIN (
    SELECT
         item_id_nm,
        AVG(width) awidth, AVG(height) aheight, 
        AVG(length) alength, AVG(weight) aweight
    FROM tbl
    GROUP BY item_id_nm ) t2
USING (item_id_nm)
WHERE 
    width > awidth * 1.3 OR width < awidth * 0.7
    OR height > aheight * 1.3 OR height < aheight * 0.7
    OR length > alength * 1.3 OR length < alength * 0.7
    OR weight > aweight * 1.3 OR weight < aweight * 0.7 
```

这应该为您提供相差 30% 的行对：

```
SELECT t1.*,t2.*
FROM tbl t1
INNER JOIN tbl t2
USING (item_id_nm)
WHERE 
     (t1.width > t2.with * 1.3 OR t1.width < t2.width * 0.7)
    OR (t1.height > t2.height * 1.3 OR t1.height < t2.height * 0.7)
    OR (t1.length > t2.length * 1.3 OR t1.length < t2.length * 0.7)
    OR (t1.weight > t2.weight * 1.3 OR t1.weight < t2.weight * 0.7) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T21:27:30.267

我认为你可以使用这样的东西：

```
SELECT item_id_nm
FROM yourtable
GROUP BY item_id_nm
HAVING
  MIN(height)*1.3 < MAX(height) OR
  MIN(width)*1.3 < MAX(width) OR
  MIN(length)*1.3 < MAX(length) OR
  MIN(weight)*1.3 < MAX(weight) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-04T21:38:04.150

```
SELECT
    *
FROM
    TableName
WHERE
   (height > 1.3 * width OR height < 0.7 width) OR
   (length > 1.3 * width OR length < 0.7 width)
GROUP BY
    item_id_nm
HAVING
    COUNT(item_id_nm) > 1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-04T23:26:26.053

我会使用：

```
SELECT s1.id AS id1, s2.id AS id2
, s1.height AS h1, s2.height as h2
, s1.width as width1, s2.width as width2
, s1.length as l1, s2.length as l2
, s1.weight as weight1, s2.weight as weight2
FROM stack s1
INNER JOIN stack s2
ON s1.item_id_nm = s2.item_id_nm
WHERE s1.id != s2.id
AND s1.id < s2.id
AND (abs(100-((s2.height*100)/s1.height)) > 30
OR abs(100-((s2.width*100)/s1.width)) > 30
OR abs(100-((s2.length*100)/s1.length)) > 30
OR abs(100-((s2.weight*100)/s1.weight)) > 30) 
```

使用 PostgreSQL ( [http://sqlfiddle.com/#!12/e5f25/15](http://sqlfiddle.com/#!12/e5f25/15) )。此代码不会返回重复的行。