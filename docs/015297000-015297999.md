# StackOverflow 问答 15297000-15297999

# php - 从 URL 获取重定向的 URL

> ID：15297000
> 
> 赞同：2
> 
> 时间：2013-03-08T15:03:45.243
> 
> 标签：php, curl, google-places-api, http-status-code-302

标题非常神秘，但基本上发生的事情是我正在使用以下 url 调用 Google Places Photo API

[https://maps.googleapis.com/maps/api/place/photo?key=123456789&photoreference=CnRvAAAAV_35nLjUhcQXkoVdwN2YGP58Z3trNMDCRXznXqR2_0FbxXv60ssT2JN0ryI_ZP9-371u3JycqlH5oxLy8-bo2IkbkAfWD7fjyiytcEtWmk76Cseyxj9OlDozspXy8Cu7NFphl4N1AXSnj6QadSy6fxIQvc6Kiai-6HxMphQ7WCmYpBoUwxVnwEHl5zo0EbuoWCObJYTmAuA&maxwidth=400&maxheight=400&sensor=false](https://maps.googleapis.com/maps/api/place/photo?key=123456789&photoreference=CnRvAAAAV_35nLjUhcQXkoVdwN2YGP58Z3trNMDCRXznXqR2_0FbxXv60ssT2JN0ryI_ZP9-371u3JycqlH5oxLy8-bo2IkbkAfWD7fjyiytcEtWmk76Cseyxj9OlDozspXy8Cu7NFphl4N1AXSnj6QadSy6fxIQvc6Kiai-6HxMphQ7WCmYpBoUwxVnwEHl5zo0EbuoWCObJYTmAuA&maxwidth=400&maxheight=400&sensor=false)

（我更改了我的 API 密钥）

通过浏览器访问此链接时，它会重定向到不同的 url：

[https://lh3.googleusercontent.com/-WjnhIv4ry4I/T6Wg4kRb4kI/AAAAAAAuqqc/t6yVdN-jcC0/s1600-w220-h151/City%2BRestaurant](https://lh3.googleusercontent.com/-WjnhIv4ry4I/T6Wg4kRb4kI/AAAAAAAuqqc/t6yVdN-jcC0/s1600-w220-h151/City%2BRestaurant)

我需要一种使用 PHP 获取第二个 URL 的方法。使用 cURL 会给我一个 302“文档已移至此处”消息。

任何人都知道我如何通过 PHP 获取第二个 url？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:13:25.730

使用 curl 发出请求，`curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);`这将导致 curl 跟随重定向。

然后，您可以使用`curl_getinfo($ch, CURLINFO_EFFECTIVE_URL);`which 将为您提供 curl 获取的最后一个有效 URL。

或者，您可以设置`CURLOPT_FOLLOWLOCATION`为`false`，然后设置`CURLOPT_HEADERS`为`true`，然后使用简单的正则表达式自己解析重定向位置。

# c++ - boost::asio 中 async_read() 中的 EOF

> ID：15297001
> 
> 赞同：13
> 
> 时间：2013-03-08T15:03:53.260
> 
> 标签：c++, boost-asio, tcpclient

当 async_read_some() 返回 EOF 异常时，是表示服务器停止发送数据还是表示连接已关闭。我很困惑，因为我找不到一种方法来知道客户端是否已从服务器接收到所有数据。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-08T16:22:01.133

它表示连接已关闭。尽管在其他地方记录[了](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/basic_stream_socket/receive/overload1.html)它仍然适用：

> 错误代码`boost::asio::error::eof`表示连接已被对等方关闭。

如果客户端需要知道已经从服务器接收到所有数据，那么考虑在通信协议中支持成帧。Boost.Asio 提供了更高级别的操作来帮助简化此操作。例如[，async_read_until()](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/async_read_until.html)可用于使用特定字符集指示消息结束的协议，而[async_read()](http://www.boost.org/doc/libs/1_53_0/doc/html/boost_asio/reference/async_read.html)可用于固定长度协议或具有固定长度标头的可变长度协议。

# javascript - 让 slideToggle() 直接在其上方显示内容，而不是在其下方？

> ID：15297004
> 
> 赞同：0
> 
> 时间：2013-03-08T15:04:10.890
> 
> 标签：javascript, jquery

* * *

**问题总结：我不需要做代码当前通常做的事情——显示按钮下方的内容——我需要它来显示其*上方*的内容。**

* * *

首先，我在任何意义上都不精通 jQuery/Javascript，所以如果我要求代表我做太多事情，那么请说出来并暗示解决方案。

现在，进入问题：

```
$('.drop_down_title').click(function() {
     $(this).next('.toggle_panel').slideToggle('slow', function () { });
     $(this).find('.arrow_drop_down').toggleClass('selected', function () { });
}); 
```

上面的代码非常适合在标题下方显示内容（例如在侧边栏中可以隐藏/显示各种“相关”块）。

但是，我还计划使用相同的机制来隐藏按钮上方的部分内容，如下所示：

[http://i.stack.imgur.com/B91DC.png](http://i.stack.imgur.com/B91DC.png)

单击按钮以显示更多摘要或项目符号的位置。

我尝试将代码调整为看起来合乎逻辑的东西，例如：

```
$(this).previous('.toggle_panel') 
```

希望它查找相关课程的页面，但仍然没有骰子。

感谢您的时间; 任何建议、帮助或解决方案将不胜感激。

请求的 HTML（用于当前的工作幻灯片**）**：

```
<html>

<div class="slidebox">

    <div class="drop_down_title">
        <a class="arrow_drop_down">Button Click</a>
    </div>

    <div class="toggle_panel">
        <p>This is some example content that should be hidden when the above button is clicked!</p>
    </div>

</div>
</html> 
```

**我试图得到它，以便交换 div“drop_down_title”和“toggle_panel”。这样内容就会显示在按钮上方。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:18:55.243

也许 .prev() 是您真正需要的。不是.previous。请参阅[JQuery 文档](http://api.jquery.com/prev/)

# c# - 从 TextBox 更新第二列 listView 已更改 - c#

> ID：15297007
> 
> 赞同：1
> 
> 时间：2013-03-08T15:04:27.567
> 
> 标签：c#, winforms, listview, textbox

使用此代码，我可以填充我的列表视图：

```
foreach (string elements in Properties.Settings.Default.Items)
{
    ListViewItem lvi = new ListViewItem();

    var txt = elements;

    if (!listView1.Items.ContainsKey(txt))
    {
        lvi.Text = txt;

        lvi.Name = txt;

        lvi.SubItems.Add("");
        lvi.SubItems.Add("1.0");

        listView1.Items.Add(lvi);
    }
} 
```

这是结果：

![在此处输入图像描述](../Images/0b6bf6e70ad7eb360f867d3e04dff3d9.png)

如何从文本框更改事件中仅更新第二列（总价）？（Windows 窗体，Visual Studio 2012）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:34:23.230

一些属性

```
 listView1.HideSelection = false;
        listView1.MultiSelect = false;
        listView1.FullRowSelect = true;
        listView1.View = View.Details; 
```

我认为这就是你所要求的：

```
 private void textBox1_TextChanged(object sender, EventArgs e)
    {
        TextBox txt_sender = (TextBox)sender;

        if (listView1.SelectedItems.Count > 0)
        {
            listView1.SelectedItems[0].SubItems[1].Text = txt_sender.Text;
        }
    } 
```

我还可以建议：（只允许数字和一个。）

```
 private void textBox1_KeyPress(object sender, KeyPressEventArgs e)
    {
        TextBox txt_sender = (TextBox)sender;

        if (!char.IsControl(e.KeyChar) &&
            !char.IsDigit(e.KeyChar) &&
            !((e.KeyChar == '.') && !(txt_sender).Text.Contains('.')))
        {
            e.Handled = true;
        }
    } 
```

# php - array_rand 带种子

> ID：15297008
> 
> 赞同：4
> 
> 时间：2013-03-08T15:04:28.180
> 
> 标签：php, arrays, random, seed

我在一个数组中有多个图像文件名，并且想生成固定一整天的随机图像，因此我想使用 date("Ymd") 在同一天使用固定种子，并且该种子将每天更改，从而每天产生新的独特种子。

问题是 array_rand 不接受种子作为参数。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:11:03.490

计算由 date("Ymd") 返回的人类可读字符串的哈希值，您将获得每天唯一的种子

就像是：

```
$seed = md5(date("Ymd")); 
```

用你的日种子初始化你的 rand 函数：

```
srand((int)$seed); 
```

您的新数组索引将是：

```
$random_array_index = $rand() % $array_size; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:12:37.917

拥有相同的种子并不能保证您每次都会获得相同的数字。我会创建一些伪随机函数，例如依赖于年、月和日，但不依赖于小时、分钟、秒，它只会从这些值中给出相同的结果，例如

```
function pseudorandom_day_image_index($array_of_pictures){
   $year=date('Y');
   $month=date('m');
   $day=date('d');
   return ($year*$month*$day) % count($array_of_pictures);
} 
```

这将为您提供图片的恒定（一天）索引

# ruby-on-rails - 后期处理中的零类错误

> ID：15297009
> 
> 赞同：2
> 
> 时间：2013-03-08T15:04:32.343
> 
> 标签：ruby-on-rails, ruby, post, omniauth

```
class IdentitiesController < ApplicationController
  def new
    @identity = Identity.new
    # @identity = env['omniauth.identity']
  end
end 
```

我的注册表单是：

```
=simple_form_for( :identity, url: "/auth/identity/register", :html => { id: :signup_form, class: 'form-horizontal' }) do |f|

  = f.error_notification

  .form-inputs
    .control-group
      .controls
        .input-prepend
          span.add-on
            i.icon-user
          input#name placeholder="name" type="text" f.name

    .control-group
      .controls
        .input-prepend
          span.add-on
            i.icon-envelope
          input#email placeholder="email" type="text" f.email 

    .control-group
      .controls
        .input-prepend
          span.add-on
            i.icon-key
          input#password placeholder="password" type="password"

    .control-group
      .controls
        .input-prepend
          span.add-on
            i.icon-key
          input#password_confirmation placeholder="password confirmation" type="password"

  .form-actions
    .control-group
      .controls
        = f.button :submit, :class => 'btn-primary' 
```

我的身份模型

```
class Identity
  include Mongoid::Document
  include OmniAuth::Identity::Models::Mongoid

  field :name,              type: String
  field :email,             type: String
  field :password_digest,   type: String

  validates_presence_of :name
  validates_presence_of :email
  validates_uniqueness_of :email
  validates_format_of :email, :with => /^[-a-z0-9_+\.]+\@([-a-z0-9]+\.)+[a-z0-9]{2,4}$/i
  validates_length_of :password, minimum: 8, maximum: 16
end 
```

我使用omniauth-identity gem。我的身份模型、identities_controller 和身份/新视图，如上所示。当我点击注册按钮时，它给出了`undefined method 'empty?' for nil:NilClass`错误。我查看了控制台和值帖子。表明

```
NoMethodError (undefined method `empty?' for nil:NilClass):
  omniauth-identity (1.1.0) lib/omniauth/identity/secure_password.rb:71:in `password=' 
```

我怎么解决这个问题？我等你的想法。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-01T03:25:39.973

看起来您可能正在使用旧版本的omniauth-identity。大约一年前，omniauth github 页面上有一个提交，似乎解决了您遇到的问题。

[https://github.com/intridea/omniauth-identity/commit/7efa2ae9fd44f27df09e167b5a93a62332512e0c](https://github.com/intridea/omniauth-identity/commit/7efa2ae9fd44f27df09e167b5a93a62332512e0c)

尝试将 gem 更新到最新版本，看看它是否效果更好。

# javascript - 删除特定范围的元素 JQuery

> ID：15297010
> 
> 赞同：1
> 
> 时间：2013-03-08T15:04:34.460
> 
> 标签：javascript, jquery, html

html:

```
<select id ="combooptions">
          <option id="combostart" value=""></option>
 </select> 
```

js：

```
var str = "";
if (combonews.length > 0)
        for (var i in combonews) {
            str += "<option value='" + combonews[i][0] + "'>" + combonews[i][1] + "</option>";
        }
    jQuery("#combooptions").append(str); 
```

它工作正常，但现在我想删除那些附加的，留下最初的 1 选项标签，如上所示。我试过：

```
jQuery("#combooptions").html('');
 //or
jQuery("#combooptions").append('');
//or
jQuery("#combostart").append('');
//or
jQuery("#combostart").html(''); 
```

但没有成功。

请帮忙谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:11:35.223

要缩小选择列表，您还可以减少选项的数量：

```
document.getElementById("combooptions").length = 1; 
```

使用 jQuery：

```
$("#combooptions")[0].length = 1; 
```

删除“除第一个之外的所有”的更通用的想法：

```
$("#combooptions :not(:first-child)").remove(); 
```

示例：http: [//jsfiddle.net/kVRpy/](http://jsfiddle.net/kVRpy/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T15:12:20.043

由于您给了第`option`一个唯一 ID，因此只需执行以下操作：

```
$('#combostart ~ option').remove(); 
```

[“~”（波浪线/波浪线/旋转）CSS 选择器是什么意思？](https://stackoverflow.com/q/10782054/901048)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:12:09.850

您可以选择所有选项，然后从您的选择中删除带有 id combostart 的选项。然后调用[.remove()](http://api.jquery.com/remove/)删除不需要的选项。

```
$('#combooptions option').not('#combostart').remove(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T15:17:55.130

试试这个：

```
$('#combooptions').html("<option id='combostart' value=''></option>"); 
```

# c++ - 使用 C++ fstreams 读取文件的“正确”方法是什么？

> ID：15297016
> 
> 赞同：2
> 
> 时间：2013-03-08T15:04:52.397
> 
> 标签：c++, file-io, iostream

我正在使用标准的 C++ fstreams 库，我想知道使用它的*正确*方法是什么。根据经验，我想出了一个小的使用协议，但我不太确定。为简单起见，假设我只想读取一个文件，例如，过滤其内容并将其放在另一个文件中。我的套路大致如下：

*   我声明了一个局部`istream i("filename")`变量来打开文件；
*   我检查`i.good()`或`i.is_open()`处理打开时出现问题的情况，例如，因为文件不存在；之后，我假设该文件存在并且我没问题；
*   我打电话`i.peek()`，然后再次`i.good()`或`i.eof()`排除文件为空的情况；之后，我假设我实际上有一些东西要读；
*   我使用`>>`或其他任何东西来读取文件的内容，并`eof()`检查我是否结束了；
*   我没有明确关闭文件 - 我依赖 RAII 并尽可能保持我的方法简短和连贯。

这是一个理智的（正确的，最小的）例行程序吗？在消极的情况下，你将如何解决它？请注意，我**不**考虑种族 - 同步是另一回事。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:24:04.740

我会消除 peek/good/eof （你的第三步）。只需尝试读取您的数据，并检查尝试读取是成功还是失败。同样，在第四步中，只需检查您尝试读取是否成功。

典型的代码类似于：

```
std::ifstream i("whatever");

if (!i)
    error("opening file");

while (i >> your_data)
    process(your_data);

if (!i.eof())
   // reading failed before end of file 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T15:23:28.857

它比您描述的要简单。前两个步骤很好（但如果您遵循我的其余建议，则不需要第二个步骤）。然后您应该尝试提取，但将提取用作循环或`if`语句的条件。例如，如果文件被格式化为一系列相同格式的行（或其他分隔序列），您可以这样做：

```
std::string line;
while (std::getline(i, line)) {
  // Parse line
} 
```

只有当行提取有效时，循环体才会执行。当然，您需要检查循环内行的有效性。

如果您要对流进行特定系列的提取或其他操作，则可以将它们置于如下`if`条件：

```
if (i >> some_string &&
    i.get() == '-' &&
    i >> some_int) {
  // Use some_string and some_int
} 
```

如果第一次提取失败，则`i.ignore()`由于 的短路评估而无法执行`&&`。只有当两次提取都成功时，语句的主体`if`才会执行。如果你有两个提取在一起，你当然可以链接它们：

```
if (i >> some_string >> some_int) {
  // Use some_string and some_int
} 
```

如果第一次失败，链中的第二次提取将不会发生。提取失败会使流处于所有后续提取也自动失败的状态。

出于这个原因，也可以将流操作放在`if`条件之外，然后检查流的状态：

```
i >> some_string >> some_int;
if (i) {
  // Use some_string and some_int
} 
```

使用这两种方法，您不必检查流的某些问题。检查流`eof()`并不一定意味着下一次读取将失败。一个常见的情况是人们使用以下*不正确*的提取循环：

```
// DO NOT DO THIS
while (!i.eof()) {
  std::getline(i, line)
  // Do something with line
} 
```

大多数文本文件都以文本编辑器隐藏的额外新行结尾。当您从文本文件中读取行时，对于最后一次迭代，您还没有到达文件末尾，因为还有 a`\n`需要读取。所以循环继续，尝试提取下一行不存在并搞砸了。人们经常将此视为“两次读取文件的最后一行”。

# svn - Logging Nant Output

> ID：15297017
> 
> 赞同：0
> 
> 时间：2013-03-08T15:04:52.530
> 
> 标签：svn, nant, nantcontrib

I am currently using a tag to log Nant output to a log file `OUTPUT.log`. I want to save the Nant output to a different file, depending on part of the `target`. I currently am using:

```
<record name="C:\\Nant\Logoutput\**output.log**" level="Info" action="Start" failonerror="false" /> 
```

I want to be able to save the target to its own file, where the file name is equal to the target.

Examples:

With output of `<Target="abc">` save to `abc.log`
With output of `<Target="xyz">` save to `xyz.log`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:32:40.503

Use the [target::get-current-target](http://nant.sourceforge.net/nightly/latest/help/functions/target.get-current-target%28%29.html) function.

# jquery - 如果我从 Jquery Ui 对话框中单击 OK 按钮，想要继续显示

> ID：15297019
> 
> 赞同：0
> 
> 时间：2013-03-08T15:04:56.253
> 
> 标签：jquery, html

我创建了这样的 jQuery UI 对话框：

```
$("<div></div>").dialog({
           autoOpen: true, //for info, true is default
           modal: true,
           title: ':' + Id,
           width: '340',
           minHeight: '200',

           open: function () {

           },
           close: function () {
               $(this).dialog('destroy');
           }
       }); 
```

在此，我想设置 OK 按钮，如果我按下 OK 按钮，它将通过以下 ajax 方法：

```
$.ajax({
            url: "Home.aspx/DeleteProject",
            type: "POST",
            dataType: 'json',
            contentType: 'application/json; charset=utf-8',
            data: "{'projectSoid': '" + Id + "'}",
            async: false,
            success: function (data) {

                if (data.d == "")
                {
                    ProjectCarousel();
                }
            },
            error: function (xhr) {
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:06:33.683

```
$("<div></div>").dialog({
           autoOpen: true, //for info, true is default
           modal: true,
           title: ':' + Id,
           width: '340',
           minHeight: '200',
            buttons: {
           "Ok":function() {
                 callAjaxHere();
            }
           },    
           open: function () {

           },
           close: function () {
               $(this).dialog('destroy');
           } 
```

# sql-server - SSIS 2012 项目连接管理器错误

> ID：15297023
> 
> 赞同：8
> 
> 时间：2013-03-08T15:05:07.940
> 
> 标签：sql-server, ssis, sql-server-2012

**基本上**：
我有一个包含 4 个包的项目。它们都有不同的连接管理器，除了一个在 2 个包之间共享的连接管理器，所以我将其设为项目连接管理器。

*   如果我尝试构建项目，我会收到以下错误。
*   如果我将项目 CM 更改为包 CM，则构建良好

所以很明显，我有一个项目 CM 是问题所在。

*我能错过什么？*

```
Error   21  System.ArgumentException: An item with the same key has already been added.  
   at System.ThrowHelper.ThrowArgumentException(ExceptionResource resource)   
   at System.Collections.Generic.Dictionary`2.Insert(TKey key, TValue value, Boolean add)  
   at Microsoft.SqlServer.Dts.Runtime.ReferenceId.ReferenceMap.Add(String key, String value, Boolean isExternal)  
   at Microsoft.SqlServer.Dts.Runtime.ReferenceId.RefIdProducer.AddRefIdAttribute(XmlElement element, String objectName, String objectId, ReferenceParserState state)   
   at Microsoft.SqlServer.Dts.Runtime.ReferenceId.RefIdProducer.GenerateRefId(XmlElement element, ReferenceParserState state)    
   at Microsoft.SqlServer.Dts.Runtime.ReferenceId.RefIdProducer.ProcessElement(XmlElement element, ReferenceParserState state)    
   at Microsoft.SqlServer.Dts.Runtime.ReferenceId.RefIdConverter.MapRefIds(IDTSPackage100 package, IDTSInfoEvents100 events, XmlDocument document)    
   at Microsoft.SqlServer.Dts.Runtime.DTSManagedXmlSerializationHelper.AfterSavePackageToXML(IDTSPackage100 package, IDTSInfoEvents100 events, String& packageXml)     
   at Microsoft.SqlServer.Dts.Runtime.Wrapper.IDTSPackagePersist100.ClonePackageToXML(Object& pvDestination, Boolean vbReturnDOM, IDTSEvents100 pEvents)    
   at Microsoft.SqlServer.Dts.Runtime.Project.SavePackage(IProjectStorage storage, Package package, String streamName, Boolean preserveVersionGuid)    
   at Microsoft.SqlServer.Dts.Runtime.Project.SavePackage(Package package, String streamName, Boolean preserveVersionGuid)   
   at Microsoft.DataTransformationServices.Project.DataTransformationsProjectBuilder.IncrementalBuildThroughObj(IOutputWindow outputWindow)  
   at Microsoft.DataTransformationServices.Project.DataTransformationsProjectBuilder.BuildIncremental(IOutputWindow outputWindow) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2014-11-11T00:53:07.333

当您有两次相同的连接管理器（例如：在 2 个包之间复制）并且您将其中一个提升为项目连接时，就会发生这种情况。

第一个包将显示“（项目）remoteSystem”的连接管理器。第二个包仍然会显示“remoteSystem”，并且不会显示新的项目级连接。

如果您删除第二个包中的包级连接，您将 a) 解决错误，并且 b) 项目级连接管理器将变得可见。

然后，您必须检查所有引用了您删除的连接管理器的组件，并将它们重新定向到新的项目级连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-11T13:32:51.110

将 CM 移回一个包，然后返回到项目中，将其解决到我可以构建的位置。

# python - 如何使用 Python 在 JSON 中的 HTML 标记中转义关闭“/”？

> ID：15297028
> 
> 赞同：5
> 
> 时间：2013-03-08T15:05:25.430
> 
> 标签：python, html, django, escaping

注意：这个问题非常接近[Embedding JSON objects in script tags](https://stackoverflow.com/questions/4176511/embedding-json-objects-in-script-tags)，但对该问题的回答提供了我已经知道的内容（在 JSON `/`==中`\/`）。我想知道如何进行转义。

`<script>`HTML 规范禁止在元素中的任何位置使用封闭的 HTML 标记。因此，这会导致解析错误：

```
<script>
var assets = [{
  "asset_created": null, 
  "asset_id": "575155948f7d4c4ebccb02d4e8f84d2f", 
  "body": "<script></script>"
}];
</script> 
```

就我而言，我通过在 Django 模板中呈现 JSON 字符串来生成无效情况，即：

```
<script>
var assets = {{ json_string }};
</script> 
```

我知道 JSON 解析`\/`与 相同`/`，所以如果我可以在 JSON 字符串中转义我的结束 HTML 标记，我会很好。但是，我不确定执行此操作的最佳方法。

我天真的方法就是这样：

```
json_string = '[{"asset_created": null, "asset_id": "575155948f7d4c4ebccb02d4e8f84d2f", "body": "<script></script>"}]'
escaped_json_string = json_string.replace('</', r'<\/') 
```

有没有更好的办法？或者我忽略的任何问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T15:12:00.883

**更新的答案**

好吧，我错误地假设了一些事情。为了转义 JSON，[simplejson](https://pypi.python.org/pypi/simplejson/)库有一个[JSONEncoderForHTML](http://simplejson.readthedocs.org/en/latest/#simplejson.JSONEncoderForHTML)方法可以使用。如果代码不起作用，`pip`您可能需要安装它。`easy_install`然后你可以做这样的事情：

```
import simplejson
asset_json=simplejson.loads(json_string)
encoded=simplejson.encoder.JSONEncoderForHTML().encode(assets_json) 
```

这`encoded`会给你这个：

```
'{"asset_id": "575155948f7d4c4ebccb02d4e8f84d2f", "body": "\\u003cscript\\u003e\\u003c/script\\u003e", "asset_created": null}' 
```

这是一个比斜杠替换更全面的解决方案，因为它也处理其他编码警告。

该`loads`部分是 JSON 已编码的副作用。如果可能的话，可以通过不使用 DJango 来生成 JSON 而使用 simplejson 来避免这种情况：

```
simplejson.dumps(your_object_to_encode, cls=simplejson.encoder.JSONEncoderForHTML) 
```

**旧答案**

尝试将脚本包装在[CDATA](http://en.wikipedia.org/wiki/CDATA)中：

```
<script>
//<![CDATA[
var assets = [{
  "asset_created": null, 
  "asset_id": "575155948f7d4c4ebccb02d4e8f84d2f", 
  "body": "<script></script>"
}];
//]]>
</script> 
```

它的目的是在这类事情上标记解析器。否则，您将需要使用已经提到的字符转义。

# javascript - 如何创建包含 JavaScript 代码的作业？

> ID：15297030
> 
> 赞同：1
> 
> 时间：2013-03-08T15:05:29.940
> 
> 标签：javascript, api, crowdflower

我正在使用[CrowdFlower 构建器 API](https://crowdflower.com/docs/api)。

当我尝试使用属性`CrowdFlower`中的 JavaScript 代码创建一个发送 HTTP POST 请求的作业时，会创建该作业但*JavaScript 代码未正确解析*。`'js'``CrowdFlower`

 *我意识到问题在于`CrowdFlower`不解析`';'`字符。
即使是简单的变量赋值，我也有这个问题。

我尝试`HTTP POST`从我的 Java 代码以及[RESTClient](https://addons.mozilla.org/es/firefox/addon/restclient/)发送请求，但它不起作用。

`CrowdFlower`有人在使用构建器 API时设法包含 JavaScript 代码吗？*

# mule - 用于近实时处理的 Mule 3 Quartz 定时器校准

> ID：15297034
> 
> 赞同：0
> 
> 时间：2013-03-08T15:05:33.647
> 
> 标签：mule, mule-studio

我有一个处理链需要在第二个顶部输出数据，即

```
System.currentTimeMillis() % 1000 == 0 
```

在 +/- 100 毫秒内。所以，我设置了一个石英定时器如下；

```
<quartz:inbound-endpoint repeatInterval="1000" responseTimeout="10000" doc:name="Quartz" jobName="publisher" startDelay="900">
    <quartz:event-generator-job/>
</quartz:inbound-endpoint> 
```

我注意到时间间隔以 1 秒的间隔相当稳定，但一秒内的对齐是随机的，可能取决于计时器第一次启动的时间。例如，我上次测试运行的输出时间

```
System.currentTimeMillis() % 1000 == 449 
```

我推测 startDelay 仅适用于第一个间隔。我还猜测如果我插入一个使用 Thread.sleep 偶尔调整它的自定义拦截器，我可能会调整计时器对齐。即，如果它在 449 唤醒，则 Thread.sleep(451)。或者，我可以将石英设置为每 50 毫秒触发一次，并使用自定义拦截器过滤掉我想要的时间范围之外的事件。

是否有更清洁的“纯粹”方法让 Mule 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:58:38.297

替换`repeatInterval`为每秒钟触发一次的 Cron 表达式。

根据[用户指南](http://www.quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger)中描述的 Quartz 支持的语法，以下应该可以工作：`0/1 * * ? * *`

# php - 如何检查发布到同一页面的用户输入

> ID：15297044
> 
> 赞同：0
> 
> 时间：2013-03-08T15:06:13.153
> 
> 标签：php, html, validation

所以我有一个使用 PHP 发布到同一页面的 html 表单。这很酷，但是为了阻止 PHP 在每次打开页面时抛出错误，如果添加了一个检查 post 变量是否为空的系统（这是用户第一次加载页面时，因为他们没有机会输入任何内容）。我的问题是，有没有更好的方法来做到这一点？因为加载表单时加载了 PHP 脚本，所以我收到消息“您没有输入任何内容”。我不希望它在页面首次加载时出现，仅在必要时出现..

这是代码：

```
<form action="" method="post">
<table align="center">
<tr> 
    <td>Enter a word to hash:  </td>
    <td><input type="text" name="input" size="20" maxlength="20"></td>
    <td><input type="submit" value="Hash"> </td>
</tr>

</table>

</form>

<?php
if(empty($_POST['input']))
{
    echo 'You didnt type anything!';
    exit;
}

$input = $_POST['input'];
$input=trim($input);
    echo md5($input);

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:08:32.700

是的，检查[`REQUEST_METHOD`](http://php.net/manual/en/reserved.variables.server.php).

```
if( $_SERVER['REQUEST_METHOD'] == 'POST' && empty($_POST['input']) ) {
    ...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:09:26.067

`if($_SERVER['REQUEST_METHOD'] == 'POST' && empty($_POST['input']))`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:09:46.050

尝试`isset`任一 than `empty`，因为在第一页加载`$_POST['input']`不应该存在。

```
<?php
if(isset($_POST['input']) && empty($_POST['input']) )
{
    echo 'You didnt type anything!';
    exit;
} else {
//check
}

?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T15:17:33.047

如果这是你想要的：

*   始终显示表格
*   如果有人提交了表单，则打印 MD5 哈希

你可以像这样完成它。它说如果有一个带有键**输入**的 POST 值，然后修剪任何前导和尾随空格并打印该值的 MD5 哈希。

```
<?php

if (!empty($_POST['input']))
{
    echo md5(trim($_POST['input']));
}

?> 
```

# jquery - 如何创建淡入淡出和动画悬停

> ID：15297046
> 
> 赞同：0
> 
> 时间：2013-03-08T15:06:24.280
> 
> 标签：jquery, fadein, fade, fadeout, muse

我只是在 Adob​​e Muse 中为文本创建了一个很棒的悬停效果。

在此处查看示例：http: [//dash.com.pl/test/test.html](http://dash.com.pl/test/test.html)

但是现在我需要通过使用html/css和js来获得与传统方法相同的效果。

我不知道该怎么办。

有人在这里，谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:20:01.660

是的，这可以使用 HTML、CSS 和 JavaScript - 在 jQuery 库和 jQuery UI（用于褪色效果）的帮助下。

[工作示例](http://jsfiddle.net/sfk35/)！

**Javascript：**

```
var speed = 200;
var line_width = $(".wrapper span").width();
var initial_colour = $(".wrapper span").css("color");

$("span").hover(function() {

    $(this)
        .not(":animated")
        .animate({color:"#0c0"}, speed);

    $(".line", this)
        .not(":animated")
        .animate(
            {
                "width": line_width,
                "background-color":"#0c0"
            },
            speed);

}, function() {

    $(this)
        .not(":animated")
        .animate(
            {
                color:initial_colour
            },
            speed);

    $(".line", this)
    .not(":animated")
    .animate(
        {
            "width":"0px",
            "background-color":initial_colour
        },
        speed);

}); 
```

# python - psycopg2 枚举类型

> ID：15297050
> 
> 赞同：0
> 
> 时间：2013-03-08T15:06:35.853
> 
> 标签：python, postgresql, psycopg2

我在 postgres 9.2 中有以下类型：

```
CREATE TYPE profile_categories AS ENUM
(
    'particulier',
    'professionel',
    'assureur',
    'manager'
); 
```

所以我想注册它：

`psycopg2.extras.register_composite('profile_categories', conn, globally=True)`

但后来我得到了一个错误：

`psycopg2.ProgrammingError: PostgreSQL type 'profile_categories' not found`

我所有的 ENUM 类型都未能正确注册，而其他类型的注册很好，例如：

```
CREATE TYPE _result AS
(
    id                  TEXT,
    msg                 TEXT
); 
```

如何注册 ENUM TYPEs？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T03:46:01.367

您的语句失败，因为 enum 不是**复合**类型。我浏览了文档，但找不到与枚举类型相关的任何内容。我可能会将其视为文本并捕获错误。

看起来注册过程（来自文档）在可能需要额外处理时使用，因此您可以处理点类型、几何类型、元组类型等。从数据库接收到 ENUM 类型时不需要处理，所以这个会有意义。

# jaxb - JAXWS wsimport 目录以解决“元素”已定义错误

> ID：15297051
> 
> 赞同：1
> 
> 时间：2013-03-08T15:06:38.303
> 
> 标签：jaxb, jax-ws, xjc, catalog, wsimport

我们正在尝试使用由第三方托管的 Web 服务。当我尝试使用 wsimport 生成 artifcats 和 JAXB 类时，我遇到了以下错误。请注意，这两个 xsd 文件内容完全相同（不知道为什么会这样做），包括名称空间。但是最后一部分 servdocoid 是不同的。wsdl 和 schema 的结构将遵循。

```
[ERROR] 'ElementX' is already defined
  line # of http:/....:port/wsdl/schema1.xsd?serviceoid=123&servdocoid=<b>5</b>

[ERROR] (related to above error) the first definition appears here
  line # of http:/....:port/wsdl/schema1.xsd?serviceoid=123&servdocoid=<b>1</b> 
```

我想我知道问题出在哪里，我正在尝试找到一种解决方法，将 `-catalog 与 wsimport 一起使用（不确定这是否是正确的做法），但仍然会出错。

wsdl 结构如所述，我只突出显示了关键部分，忽略了 wsdl 定义的其余部分

```
<wsdl:definitions targetNamespace="http:/xyz.com" xmlns:soap12="http:/schemas.xmlsoap.org/wsdl/soap12/ xmlns:wsdl="http:/schemas.xmlsoap.org/wsdl/" xmlns:xsd="http:/www.w3.org/2001/XMLSchema">
...
<!-- relevant -->
<xsd:schema targetNamespace="http://schema1" xmlns:wsdl="http:/schemas.xmlsoap.org/wsdl/" xmlns:xsd="http:/www.w3.org/2001/XMLSchema xmlns:soap12="http:/schemas.xmlsoap.org/wsdl/soap12/>
  <xsd:include schemaLocation="http:/domain.com:port/wsdl/schema1.xsd?serviceoid=123&servdocoid=1" />
</xsd:schema>
...............
</wsdl:definitions> 
```

上面 wsdl 中使用的模式是嵌套的，这意味着它反过来导入多个模式，这些模式又可以导入多个模式。假设它是一个链条。

**schema1.xsd**

```
<xsd:schema elementFormDefault="qualified" targetNamespace="http:/schema1" xmlns:tns1="http:/schema1" xmlns:tns2="http:/schema2" xmlns:tns3="http:/schema3" xmlns:xsd="http:/www.w3.org/2001/XMLSchema">
....
<!-- relevant -->
<xsd:import namespace="http:/schema2" schemaLocation="http:/domain.com:port/wsdl/schema2.xsd?serviceoid=123&servdocoid=2" /> 
  <xsd:import namespace="http://schema3" schemaLocation="http:/domain.com:port/wsdl/schema3.xsd?serviceoid=123&servdocoid=3" /> 
...
</xsd:schema> 
```

**schema2.xsd**

```
<xsd:schema elementFormDefault="qualified" targetNamespace="http:/schema2" xmlns:tns2="http:/schema2" xmlns:tns4="http://schema4"  xmlns:xsd="http:/www.w3.org/2001/XMLSchema">
...
<!-- relevant -->
 <xsd:import namespace="http:/schema4" schemaLocation="http:/domain.com:port/wsdl/schema4.xsd?serviceoid=123&servdocoid=4" /> 
...
</xsd:schema> 
```

**schema4.xsd**

```
<xsd:schema elementFormDefault="qualified" targetNamespace="http:/schema4" xmlns:tns4="http:/schema2" xmlns:tns1="http:/schema1"  xmlns:xsd="http:/www.w3.org/2001/XMLSchema">
...
<!-- relevant -->
 <xsd:import namespace="http:/schema1" schemaLocation="http:/domain.com:port/wsdl/schema1.xsd?serviceoid=123&servdocoid=5" /> 
...
</xsd:schema> 
```

所以这里的关键模式是 schema1.xsd 和 schema4.xsd。两者具有完全相同的内容，但具有不同的链接。话虽如此，我正在尝试使用 -catalog 文件让 wsimport 知道对于所有命名空间“http:/schema1”始终解析为一个链接 http:/domain.com:port/wsdl/schema1.xsd?serviceoid =123&servdocoid=1 但我仍然无法让它工作。

# javascript - 脚本仅在第一次有效，在 IE8 中刷新后无效

> ID：15297052
> 
> 赞同：0
> 
> 时间：2013-03-08T15:06:38.817
> 
> 标签：javascript, google-maps, internet-explorer-8

嗨，我的页脚中有这段代码，它在除 IE8 之外的所有浏览器中都可以正常工作，在 IE8 中，它仅在直接页面加载时工作正常，如果我进入域并按 Enter，它就像一个魅力，但如果我点击刷新，我得到一个“对象Expekted”，因为“google.maps”变成了一个空对象，例如：JSON.stringify(google.maps) == '[]'

知道什么是错的吗？（如果我删除缓存并直接转到该页面，它仍然可以正常工作。）

```
<script type='text/javascript' src='http://www.google.com/jsapi?ver=3.2.1'></script>
<script type="text/javascript"> 
 google.setOnLoadCallback(function(){
      jQuery( ".all-map" ).each(function( index ) {
        var obj = jQuery.parseJSON(jQuery(this).val());
        var allMap = new google.maps.Map(document.getElementById(obj.mapId), {
        zoom: obj.zoom,
        center: new google.maps.LatLng(obj.centerLat, obj.centerLong),
        mapTypeId: google.maps.MapTypeId.SATELLITE
        }
        );

        var locations = eval(obj.locations);
    var infowindow = new google.maps.InfoWindow();
    var marker, i;
    for (i = 0; i < locations.length; i++) {  
       marker = new google.maps.Marker({
       position: new google.maps.LatLng(locations[i][1], locations[i][2]),
       map: allMap
       }); 
     google.maps.event.addListener(marker, 'click', (function(marker, i) {
        return function() {
          jQuery('#'+obj.mapId).parent().siblings().eq(i).click();
          infowindow.setContent(locations[i][0]);
          infowindow.open(allMap, marker);
        }
      })(marker, i));
    }

  });

 });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T20:13:59.717

我仍然不知道出了什么问题，但我做了一些重组和什么时候

```
$(document).ready(function() {
    google.load("maps", "3",  {
        callback: initialize , 
        other_params: "sensor=false"
    });
}); 
```

现在它也适用于 IE8，感谢 4 的帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:41:08.640

这是一个竞赛条件。当信息已经在 IE 的缓存中时，google onload 事件处理程序在 DOM 渲染之前运行（页面 onload 事件）并且地图对象在 DOM 中不存在，因此 document.getDocumentById 找不到它。您需要等待文档加载以及 google 脚本 onload 事件触发。

# pandas - 如何将数据框的单个值除以月平均值？

> ID：15297053
> 
> 赞同：22
> 
> 时间：2013-03-08T15:06:39.983
> 
> 标签：pandas, time-series, average, resampling

我有以下 15 分钟的数据作为`dataframe`3 年。前两列是索引。

```
2014-01-01 00:15:00  1269.6      
2014-01-01 00:30:00  1161.6      
2014-01-01 00:45:00  1466.4      
2014-01-01 01:00:00  1365.6      
2014-01-01 01:15:00  1362.6      
2014-01-01 01:30:00  1064.0      
2014-01-01 01:45:00  1171.2      
2014-01-01 02:00:00  1171.0      
2014-01-01 02:15:00  1330.4      
2014-01-01 02:30:00  1309.6      
2014-01-01 02:45:00  1308.4      
2014-01-01 03:00:00  1494.0 
```

我曾经`resample`得到第二个系列的月平均值。

```
data_Monthly = data.resample('1M', how='mean') 
```

如何将最后一列中的值除以其月平均值，结果仍然是 15 分钟粒度的时间序列？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-08T18:35:03.990

先做一个石斑鱼：

```
import pandas as pd

In [1]: grouper = pd.Grouper(freq="1M") 
```

然后制作你的新专栏：

```
In [2]: df['normed'] = df.groupby(grouper).transform(lambda x: x/x.mean()) 
```

通过将 grouper 传递给`groupby`方法，您可以将数据分组为一个月的块。在每个块中，您将 15 分钟间隔数据除以该月的平均值。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2017-07-05T17:46:58.923

我认为通常建议使用 Grouper 而不是 TimeGrouper。看看[这个](https://pandas.pydata.org/pandas-docs/stable/generated/pandas.Grouper.html "石斑鱼文档")。例如，如果您的列名为 Date，请使用

```
grouper = pd.Grouper(key='Date', freq='M') 
```

而不是使用 TimeGrouper ，然后按照@Zelazny7 的建议继续。如果您的列不是日期时间索引，则使用

```
df['Date'] = pd.to_datetime(df['Date']) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-08-30T13:01:42.787

这可以在一行中完成：

```
df.groupby([df.index.year, df.index.month]).transform(lambda x: x/x.mean()) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-04-12T12:19:17.567

> `data_Monthly = data.resample('M',on='Date').mean()`

# android - 手机和电脑之间的安卓聊天

> ID：15297057
> 
> 赞同：2
> 
> 时间：2013-03-08T15:07:09.573
> 
> 标签：android, sockets, chat, inputstream, outputstream

我在我的 PC 上运行了一个简单的套接字服务器，我为 PC 制作了一个客户端来与自己对话，但是我想将它调整为适用于 Android，但它不断崩溃，告诉我 closeChat() 方法有问题，但我无法弄清楚什么。这是我的代码：

```
 package com.jister13.chattest;

import java.io.EOFException;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.net.InetAddress;
import java.net.Socket;

import android.app.Activity;
import android.os.Bundle;
import android.os.Handler;
import android.text.Editable;
import android.text.TextWatcher;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.Toast;

public class ChatRoom extends Activity
{
    String ip;

    EditText userText;
    EditText chatWindow;
    Button send;

    private ObjectOutputStream output;
    private ObjectInputStream input;
    private String message = "";
    private String serverIP;
    private Socket connection;

    private Handler handler;

    protected void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);
        Bundle extras = getIntent().getExtras();
        if(extras != null)
        {
            ip = extras.getString("IP");
            serverIP = ip;
        }
        setContentView(R.layout.chat_room);
        setRequestedOrientation(1);

        handler = new Handler();

        userText = (EditText) findViewById(R.id.editText_UserText);
        chatWindow = (EditText) findViewById(R.id.editText_ChatWindow);
        chatWindow.addTextChangedListener(new TextWatcher(){
            public void afterTextChanged(Editable s) {
            }
            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
            }
            public void onTextChanged(CharSequence s, int start, int before, int count) {
                Toast.makeText(ChatRoom.this, "Updated", Toast.LENGTH_LONG).show();
            }
        });
        send = (Button) findViewById(R.id.button_Send);
        send.setOnClickListener(new View.OnClickListener() {
            public void onClick(View v) {
                sendMessage("You: " + userText.getText().toString() + "\n");
                userText.setText("");
            }
        });

        startRunning();
    }
    public void startRunning()
    {
        try{
            connectToServer();
            setupStreams();
            whileChatting();
        }catch(EOFException eofException){
            showMessage("\n Chat Session Closed");
        }catch(IOException ioException){
            ioException.printStackTrace();
        }finally{
            closeChat();
        }
    }
    private void connectToServer() throws IOException
    {
        showMessage("Starting Connection...");
        connection = new Socket(InetAddress.getByName(serverIP), 0511);
        showMessage("\n Connection Established: "+connection.getInetAddress().getHostName());
    }
    private void setupStreams() throws IOException
    {
        output = new ObjectOutputStream(connection.getOutputStream());
        output.flush();
        input = new ObjectInputStream(connection.getInputStream());
        showMessage("\n Chatting streams are now enabled...");
    }
    private void whileChatting() throws IOException 
    {
        ableToType(true);
        do{
            try{
                message = (String) input.readObject();
                showMessage("\n "+message);
            }catch(ClassNotFoundException classNotFoundException){
                showMessage("\n Some Error Occured");
            }
        }while(!message.equals("SERVER - END"));
    }
    private void closeChat()
    {
        showMessage("\n Closing Application...");
        ableToType(false);
        try{
            input.close();
            output.close();
            connection.close();
        }catch(IOException e){
            e.printStackTrace();
        }
    }
    private void sendMessage(String text)
    {
        try{
            output.writeObject("Else: "+text);
            output.flush();
            showMessage("You: "+text+"\n");
        }catch(IOException e){
            chatWindow.append("\n An Error Occured *See ChatRoom.java -> sendMessage()*");
        }
    }
    private void showMessage(final String message)
    {
        handler.post(new Runnable(){
            public void run(){
                chatWindow.append(message);
            }
        });
    }
    private void ableToType(final boolean TorF)
    {
        //userText.setEditable(TorF);
    }
} 
```

[http://www.mediafire.com/view/?hr441qalu6b6d7s](http://www.mediafire.com/view/?hr441qalu6b6d7s) 这是错误缩小到的图像。

这是整个 PrintStackTrace：

```
03-08 11:02:43.595: E/AndroidRuntime(3959): FATAL EXCEPTION: main
03-08 11:02:43.595: E/AndroidRuntime(3959): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.jister13.chattest/com.jister13.chattest.ChatRoom}: java.lang.NullPointerException
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2088)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2113)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.ActivityThread.access$700(ActivityThread.java:139)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1224)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.os.Handler.dispatchMessage(Handler.java:99)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.os.Looper.loop(Looper.java:137)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.ActivityThread.main(ActivityThread.java:4918)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at java.lang.reflect.Method.invokeNative(Native Method)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at java.lang.reflect.Method.invoke(Method.java:511)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:1004)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:771)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at dalvik.system.NativeStart.main(Native Method)
03-08 11:02:43.595: E/AndroidRuntime(3959): Caused by: java.lang.NullPointerException
03-08 11:02:43.595: E/AndroidRuntime(3959):     at com.jister13.chattest.ChatRoom.closeChat(ChatRoom.java:115)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at com.jister13.chattest.ChatRoom.startRunning(ChatRoom.java:82)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at com.jister13.chattest.ChatRoom.onCreate(ChatRoom.java:69)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.Activity.performCreate(Activity.java:5048)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1094)
03-08 11:02:43.595: E/AndroidRuntime(3959):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2052)
03-08 11:02:43.595: E/AndroidRuntime(3959):     ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:50:13.007

简单地说，`input`就是null。

当它运行时：

```
public void startRunning()
{
    try{
        connectToServer();
        setupStreams();
        whileChatting();
    }catch(EOFException eofException){
        showMessage("\n Chat Session Closed");
    }catch(IOException ioException){
        ioException.printStackTrace();
    }finally{
        closeChat();
    }
}

private void connectToServer() throws IOException
{
    showMessage("Starting Connection...");
    connection = new Socket(InetAddress.getByName(serverIP), 0511);
    showMessage("\n Connection Established: "+connection.getInetAddress().getHostName());
}

private void setupStreams() throws IOException
{
    output = new ObjectOutputStream(connection.getOutputStream());
    output.flush();
    input = new ObjectInputStream(connection.getInputStream());
    showMessage("\n Chatting streams are now enabled...");
} 
```

如果你在`input`被赋值之前的任何地方出现异常`setupStreams()`，当你`finally`调用它时它将为空`closeChat()`。由于您没有在那里检查 null ，因此它会翻转。

我的建议？在使用它们之前对它们进行空检查：

```
private void closeChat()
{
    ...
    if(input != null)
        input.close();
    if(output != null)
        output.close();       
    if(connection != null)
        connection.close();
    ....
} 
```

# file-upload - 使用 Rails 4、强参数和 Carrierwave 上传文件

> ID：15297058
> 
> 赞同：6
> 
> 时间：2013-03-08T15:07:18.630
> 
> 标签：file-upload, carrierwave, nested-forms, ruby-on-rails-4, strong-parameters

我正在将一个使用 Carrierwave 的应用程序移植到 Rails 4，但是我遇到了强参数的问题。我有一个模型

```
accepts_nested_attributes_for :photos 
```

以下是上传图片的传递方式：

```
{
    # ...
    "model"=>
    {
        # ...
        "photos_attributes"=>
        {
            "1362752177921"=>
            {
                "image"=>"test.jpg",
            }
        }
    }
} 
```

但是我似乎无法弄清楚如何编写接受的参数`photos_attributes`。

我已经尝试过`.permit(photos_attributes: [])`，但它只是跳过它们，当我使用 时`permit!`，`uuid`它是在保存之前创建的，不会出现在 SQL 中，这是第二个问题：

```
photos.uuid may not be NULL: INSERT INTO "photos" ("created_at", "model_id", "image", "title", "updated_at") VALUES (?, ?, ?, ?, ?) 
```

这里缺少强参数的文档，我什至不知道如何进行。

**更新** 这适用于嵌套属性：

```
params.permit( ..., :photos_attributes => ['id', 'title', 'image', '_destroy']) 
```

但看起来应该首先为 Rails 4 更新 Carrierwave 或 Nested Form。它只是试图一直保存一个空图像。相同的代码（没有 strong_params）适用于 Rails 3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T05:48:17.703

这适用于嵌套属性：

```
params.permit( ..., :photos_attributes => ['id', 'title', 'image', '_destroy']) 
```

但看起来应该首先为 Rails 4 更新 Carrierwave 或 Nested Form。它只是试图一直保存一个我有点消除的空图像`:reject_if`，但它仍然不是 100 工作。

# mysql - MySQL - SUM 连接表列

> ID：15297061
> 
> 赞同：0
> 
> 时间：2013-03-08T15:07:46.847
> 
> 标签：mysql

我正在尝试做一个稍微复杂的查询，我几乎拥有我需要的东西，除了我的一个连接我没有得到预期的数据。

**我的尝试**

```
SELECT email.*, email_type.*, email_subtype.*, email_dailytotal.*, SUM(email_dailytotal.fullconversions - (email_dailytotal.duplicates + email_dailytotal.invalids)) as validleads, email_week.*, SUM(adjustment) as total_adjustment, email_costmethod.*
FROM email 
LEFT JOIN email_type on email.type = email_type.type_id
LEFT JOIN email_subtype on email_subtype.type_id = email_type.type_id 
LEFT JOIN email_dailytotal on email_dailytotal.email_id = email.email_id 
LEFT JOIN email_week on email_week.email_id = email.email_id 
LEFT JOIN email_costmethod on email_costmethod.costmethod_id = email.costmethod
WHERE email.email_id = '12163'
AND business IN ("group", "dead") 
AND agency="MFC" 
AND start_date >="2013-02-01" 
GROUP BY email.email_id, email_dailytotal.oeyearno
ORDER BY email.email_id DESC 
```

我几乎得到了我想要的，除非我`email_dailytotal`加入`email`：

```
LEFT JOIN email_dailytotal on email_dailytotal.email_id = email.email_id 
```

因为我只从该`email_dailytotal`广告系列的所有行中获取其中一行而不是所有行。

我可以用这个基本查询来做到这一点：

```
SELECT SUM(fullconversions) FROM email_dailytotal WHERE email_id = 12163 
```

结果在哪里，`27`但在我的整体查询中，我得到的第一行恰好是`1`.

的最小化结构`email_dailytotal`是：

```
email_id | fullconversions  | summarydate | 
```

因此，它包含活动每一天的数据：

```
12163 |  1 | 2013-02-27
12163 | 10 | 2013-02-26
12163 | 15 | 2013-02-25
12163 |  1 | 2013-02-22 
```

所以在我的加入中，我得到了最后一行而不是总和。

谁能指出我哪里出错了？

PS我为这个问题的混乱道歉，我试图制作一个sqlfiddle，但因为我的构建模式超过8000个字符它不起作用，如果它有助于任何人回答，我将它包含在下面。

我通常会展示表格的结构，但我需要几个小时才能将其格式化为合理的标准。

**数据**

[http://pastebin.com/NV0nAwrp](http://pastebin.com/NV0nAwrp)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:10:29.733

基本问题是你的`SELECT`条款和你的`GROUP BY`条款不一致。

对于初学者，尝试如下更改它们：

```
SELECT email.email_id,
  SUM(email_dailytotal.fullconversions - (email_dailytotal.duplicates + email_dailytotal.invalids)) as validleads, 
  SUM(adjustment) as total_adjustment
...
GROUP BY email.email_id 
```

我还建议使用[`ONLY_FULL_GROUP_BY`](http://mechanics.flite.com/blog/2013/02/12/why-i-use-only-full-group-by/)sql_mode，这样 MySQL 就不会让你执行这样的查询。

# objective-c - 删除 NSWindowController

> ID：15297062
> 
> 赞同：0
> 
> 时间：2013-03-08T15:07:52.063
> 
> 标签：objective-c, cocoa, automatic-ref-counting, nswindow, nswindowcontroller

我有一个无边框窗口，我通过附加到此操作的菜单栏项关闭它（在窗口控制器中）：

```
- (void)closeMenuBar
{
    [[self window] close];
    [[NSApp delegate] closeMenubar];
} 
```

然后 appdelegate 简单地将带有窗口控制器引用的 NSMutableArray 设置为 nil。（我正在使用ARC）。

然而，在窗口关闭后，窗口控制器似乎仍在运行（从 NSLog 语句可以看出）。我究竟做错了什么？如何在启用 ARC 的情况下立即移除此控制器？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T00:56:41.253

确保您在其他地方没有任何强烈的引用。

如果您无法追踪它们，请尝试在 Instruments with Allocations 中运行以了解它被保留的位置。您可以检查它保留的每个位置的堆栈跟踪。

# c# - 如何正确使用 try-catch 语句

> ID：15297065
> 
> 赞同：1
> 
> 时间：2013-03-08T15:07:58.373
> 
> 标签：c#, exception, exception-handling, try-catch

自从我上次编程练习以来已经有一段时间了，所以这是一个相当基本的问题。但是我还没有找到任何具体的答案。

假设我定义了一个可能导致异常的方法。该方法看起来像这样（相当伪代码）：

```
public int Calculate(int x, int y) 
{
  try 
  {
    doSomeCalc();
  }
  catch (SomeException ex) 
  {
    doExceptionHandling();
  }

  return result;
} 
```

现在如果应用程序的另一部分想要使用这个方法，它应该使用另一个 try-catch 块吗？

```
public MyMainApp() {
  try 
  {
    Calculate(1, 2);
  } 
  catch (SomeException ex) 
  {
    doExceptionHandling();
  }
} 
```

所以这里的问题是我应该在哪里使用 try-catch 以及它在哪里是多余的？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T15:11:05.250

**通常，只有在 catch 中有可以做的事情时，才应该使用 try-catch。**您能否重试失败的连接或以其他方式帮助用户继续？是否要记录异常？

如果您无法恢复或正常降级，那么捕获异常是没有意义的。只需让它冒泡到应用程序顶部的某个位置（例如，在 Web 应用程序的基本页面中的 Page_Error 事件中）并在那里处理 UI。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:11:27.527

**一般来说，当你需要处理某些语句执行引起的错误时，应该使用try-catch。**

例如，在 Db 连接的情况下，`SqlException`会引发可能包含与错误相关的信息，例如`Wrong Password`，`Invalid Database`...

```
try
{
    //try connect to db
}
catch (SqlException ex)
{
    // information of database related exception
}
catch (Exception ex)
{
    // catch any other error
} 
```

* * *

`Exception Handling`时间并不像看起来那么简单。

请阅读这篇文章（我个人从中学到了很多）[：.NET 中的异常处理最佳实践](http://www.codeproject.com/Articles/9538/Exception-Handling-Best-Practices-in-NET)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T15:15:03.360

如果`Calculate`已经捕获异常并处理它，为什么还要`MyMainApp`关心它呢？如果它没有抓住它，`MyMainApp`可能想要处理它。**如果它没有以有用的**方式处理它（至少记录异常），它不应该捕获它。

最佳实践是尽快抛出有意义的异常，例如（假设负值会导致错误的结果或异常）：

```
public int Calculate(int x, int y)
{
    if (x <= 0)
        throw new ArgumentException("X has to be positive", "x");
    if (y <= 0)
        throw new ArgumentException("Y has to be positive", "y");

    // now the calculation should be safe without any side-effects
    // ...
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T15:10:16.957

这取决于`SomeException`类型。如果它是所有异常的基类，则不，在您的第二个块中不需要它。但是，如果它只处理一种特定类型的异常并且可能发生其他异常，则需要第二个块。为什么只需要处理一个特定的异常？如果需要，您可以自行查找 :)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-08T15:10:23.757

经验法则是，你只捕捉到你将要做什么的地方，除了例外。例如，记录特定异常或重试调用。

为了维护堆栈跟踪，您通常使用重新抛出异常`throw;`，然后在全局处理错误的进程顶部有一些机制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T15:10:15.593

尝试将 try 和 catch 放入其中，`event functions`因为只会从事件函数调用普通函数。如果`rollbacks`要执行某些函数，则仅在其他层函数中使用 try。希望能帮助到你....

# web-services - ReST 什么时候变成 SOAP？

> ID：15297069
> 
> 赞同：0
> 
> 时间：2013-03-08T15:08:11.293
> 
> 标签：web-services, rest, soap

假设我在某处有一台服务器，它接受 HTTP 获取并返回 JSON 响应。

很明显是一个 ReST 服务，对吧？

现在假设它返回 XML。仍然很安静，对吧？

好的，现在假设它是一个带有返回 XML 的 XML 负载的 HTTP POST。

我们还假设其中有一个定义服务的 WSDL。

然后让我们说 XML 不是真正的消息（我猜 SOAP 和 ReST 都很方便），而更像是传递对象/本体。

然后假设人类从不去那个 URL 看任何东西，它只被应用程序、浏览器、机器人等使用。

我的 ReSTful 服务在什么时候变成了 SOAP 服务？

是否有一个共同的地方来划线，还是更像是一种一般的感觉？

是否有比我提到的标准更好的因素可以确定这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:15:45.163

WSDL 文件的存在显然是 SOAP 的标志。您提到的所有其他点都不违反 REST 原则。

# widget - org.eclipse.swt.SWTExecption: Widget 已处理

> ID：15297071
> 
> 赞同：1
> 
> 时间：2013-03-08T15:08:17.860
> 
> 标签：widget, swt

我的用户从主应用程序工作区中选择数据。数据存储在可写列表中。然后用户继续打开对话框以在表格中显示所选数据。当我的用户第一次打开对话框时。一切都很好，一切都按计划进行。但是当他们关闭对话框然后重新打开它时。我收到以下错误。

![在此处输入图像描述](../Images/44d136504b340a60f10c4a6cd9adf73e.png)

他们可以关闭对话框并选择更多数据。然后再次打开对话框以查看旧数据和新数据。

代码使用到错误的步骤顺序。

```
 protected Control createDialogArea(Composite parent) {
    Composite composite = (Composite) super.createDialogArea(parent);  
    Label line = new Label(parent, SWT.SEPARATOR | SWT.HORIZONTAL);
    line.setLayoutData(new GridData(SWT.FILL, SWT.END, true, true));
    final GridLayout gridLayout = new GridLayout();

    gridLayout.marginWidth = 15;
    gridLayout.marginHeight = 10;
    composite.setLayout(gridLayout);

    GridData gridData = new GridData(SWT.FILL, SWT.FILL, true, true);
    composite.setLayoutData(gridData);
    createTopButtons(composite);
    createTableViewer(composite);
    createRemoveButtons(composite);
    updateTableViewer();
    return composite;
 } 
```

在错误中，我们可以看到它来自 updateTableViewer

```
public void updateTableViewer() {
  setRemoveButtonVisibility();
  setRemoveAllButtonVisibility();
  setPlotButtonVisibility();
  setPDFButtonVisibility();
} 
```

在错误中，我们看到它来自 setRemoveButtonVisibility();

```
public void setRemoveButtonVisibility() {
  if (AplotDataModel.getInstance().getSize() > 0) {
     removeButton.setVisible(true);
  }
  else {
     removeButton.setVisible(false);
  }
} 
```

这是它指向的行：

```
removeButton.setVisible(true); 
```

if 条件是检查存储用户选择的数据的可写列表。如果列表为空，则不显示按钮，如果有数据，则显示按钮。

下面是关闭对话框按钮的代码：

```
protected void createButtonsForButtonBar(Composite parent) {
  Button okButton = createButton(parent, OK, "Close Aplot", true);
  okButton.addSelectionListener(new SelectionAdapter() {
     public void widgetSelected(SelectionEvent e) {
        viewer = null;
        close();
     }
  });
} 
```

有什么想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:36:28.443

不使用`close()`，而是使用`getShell().setVisible(false)`隐藏对话框。因为您正在重复使用同一个对话框，所以不应关闭它。如果您关闭对话框，而后者又将其关闭，您应该在每次需要打开它时创建一个新对话框。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-13T14:13:55.510

确保您在关闭 shell 后没有尝试读取任何信息。例子：

```
System.out.println(combo.getText())
shlUpload.close();
ImportGroup window = new ImportGroup();
window.open(combo.getText()); 
```

一旦您关闭 shlUpload，这将不起作用，它不再看到对象“组合”。奥斯汀

# cocoa - 如何在矩阵中获得正确数量的按钮？

> ID：15297078
> 
> 赞同：1
> 
> 时间：2013-03-08T15:08:30.197
> 
> 标签：cocoa, xcode4

Xcode 4.6。我需要在 2 列中放置 5 个单选按钮，在第一列中放置 3 个，在第二列中放置两个。我没有足够的空间将它们放在一栏中。如果我选择 2 列，我会得到偶数个按钮。我确定我错过了一些非常简单的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:17:35.517

您没有显示如何填充单元格，但您只需要在最后一个位置添加一个*空白单元格：*

```
NSCell *blankCell = [[NSCell alloc] init];
blankCell.enabled = NO;
[_matrixView putCell:blankCell atRow:row column:column]; 
```

# google-custom-search - Google 自定义搜索 (CSE) API 返回错误代码 500 ({"error": {"code": 500, "message": null } })

> ID：15297079
> 
> 赞同：2
> 
> 时间：2013-03-08T15:08:30.953
> 
> 标签：google-custom-search

我使用谷歌自定义搜索 API。网址示例；

[https://www.googleapis.com/customsearch/v1?key=Api_Key&cx=Client_ID&q=Search_Keyword&alt=json&sort=date-sdate:d&lr=lang_tr&cr=countryTR](https://www.googleapis.com/customsearch/v1?key=Api_Key&cx=Client_ID&q=Search_Keyword&alt=json&sort=date-sdate:d&lr=lang_tr&cr=countryTR)

此网址一年正常工作，但自上周以来返回错误代码 500。这个错误的原因是什么。任何人都可以帮助我吗？

注意：没有未清发票

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-11T08:38:56.350

我们也遇到过这个问题。谷歌似乎在 2013 年 3 月 6 日稍微改变了它的自定义搜索 API。

我们曾经让**cx ID**指向 Google Custom Search API**项目 ID**。这不再有效，现在给出了这个无用的*500 Internal Server Error*响应：

```
{
 "error": {
  "code": 500,
  "message": null
 }
} 
```

根据我们的测试，您可以通过以下方式解决问题：

1.  [在http://www.google.com/cse/all](http://www.google.com/cse/all)创建一个新的 CSE 引擎。
2.  配置它：启用图像搜索，如果需要，检查是否使用整个网络
3.  单击搜索引擎*设置*部分下的搜索**引擎 ID**按钮。新的搜索引擎 ID 采用 [~15 个数字]:[~10 个字母和数字] 的形式（例如*09238519823059291357:vsdoijv7svdkij7*）。
***   将此搜索引擎 ID 用作API 查询中的**cx参数，它应该可以工作。****

 **我希望这有帮助！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-23T07:51:24.113

如果帐户已过期错误再次为 500

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-17T12:08:54.883

老问题，但是，记录一下：当我遇到一个错误时，我得到了同样的结果，它`$`在 URL 中创建了一个字符作为参数分隔符，而不是`&`. 因此，格式错误的查询似乎也可能导致返回此错误。**

# magento - Magento 产品系列 选择所有属性

> ID：15297084
> 
> 赞同：4
> 
> 时间：2013-03-08T15:08:54.787
> 
> 标签：magento, magento-1.7

我正在尝试创建一个选择特定产品及其所有属性的模型。

```
$products = Mage::getModel('catalog/product')->getCollection()->addAttributeToSelect('*'); 
```

但遗憾的是，尽管我之前已经这样做了数百次，但我们正在经历一个 Magento 时刻......

```
echo $products->getSelect()->__toString(); 
```

表明 ->addAttributeToSelect 忽略了我。

```
SELECT `e`.* FROM `catalog_product_entity` AS `e` 
```

当然，在典型的 Magento 方式中，没有任何类型的异常或错误。

我在我自己的 Adminhtml Grid 块中调用这些方法，缓存被禁用（即使我知道 Magento 在禁用缓存时仍然缓存一些模型数据（我删除了 var/cache）。

我什至做不到：

```
->addAttributeToSelect('name'); 
```

我真的开始对这个平台失去耐心了，我已经使用它 4 个月了，它似乎浪费的时间多于节省的时间。任何帮助都可以挽救生命！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-08T16:35:17.857

您需要深入研究 Magento 以了解 Magento ORM 的工作原理（[EAV 结构](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-7-advanced-orm-entity-attribute-value)是什么以及[集合](http://www.magentocommerce.com/knowledge-base/entry/magento-for-dev-part-8-varien-data-collections)实际如何工作）。

为了获得所有产品属性，这是正确的：

```
$collection = Mage::getModel('catalog/product')->getCollection()->addAttributeToSelect('*'); 
```

您缺少的是，当您这样做时，Magento 不会为您提供集合的所有相关查询：

```
echo $collection->getSelect()//note: you don't need __toString(), read about OOP in PHP5 
```

当您运行代码只是为了获取集合时，Magento 将只运行以下查询：

```
SELECT `e`.* FROM `catalog_product_entity` AS `e` 
```

当您开始遍历集合时：

```
$collection = Mage::getModel('catalog/product')->getCollection()->addAttributeToSelect('*');
foreach($collection as $p) {
    echo $p->getName()."\n";//you can use in here any getCustomAttribute method
} 
```

Magento 将运行额外的查询来获取所有的属性和值：

```
SELECT `main_table`.`entity_type_id`, `main_table`.`attribute_code`, `main_table`.`attribute_model`, `main_table`.`backend_model`, `main_table`.`backend_type`, `main_table`.`backend_table`, `main_table`.`frontend_model`, `main_table`.`frontend_input`, `main_table`.`frontend_label`, `main_table`.`frontend_class`, `main_table`.`source_model`, `main_table`.`is_required`, `main_table`.`is_user_defined`, `main_table`.`default_value`, `main_table`.`is_unique`, `main_table`.`note`, `additional_table`.* FROM `eav_attribute` AS `main_table`
 INNER JOIN `catalog_eav_attribute` AS `additional_table` ON additional_table.attribute_id = main_table.attribute_id WHERE (main_table.entity_type_id = 10)

SELECT `t_d`.`entity_id`, `t_d`.`attribute_id`, `t_d`.`value` AS `default_value`, `t_s`.`value` AS `store_value`, IF(t_s.value_id IS NULL, t_d.value, t_s.value) AS `value` FROM `catalog_product_entity_text` AS `t_d`
 LEFT JOIN `catalog_product_entity_text` AS `t_s` ON t_s.attribute_id = t_d.attribute_id AND t_s.entity_id = t_d.entity_id AND t_s.store_id = 1 WHERE (t_d.entity_type_id = 10) AND (t_d.entity_id IN (16, 17, 18, 19, 20, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 41, 42, 44, 45, 46, 47, 48, 49, 51, 52, 53, 54, 74, 75, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166)) AND (t_d.attribute_id IN ('496', '507', '531', '97', '494', '509', '499', '492', '498', '104', '495', '497', '936', '500', '476', '506')) AND (t_d.store_id = 0) UNION ALL SELECT `t_d`.`entity_id`, `t_d`.`attribute_id`, `t_d`.`value` AS `default_value`, `t_s`.`value` AS `store_value`, IF(t_s.value_id IS NULL, t_d.value, t_s.value) AS `value` FROM `catalog_product_entity_int` AS `t_d`
 LEFT JOIN `catalog_product_entity_int` AS `t_s` ON t_s.attribute_id = t_d.attribute_id AND t_s.entity_id = t_d.entity_id AND t_s.store_id = 1 WHERE (t_d.entity_type_id = 10) AND (t_d.entity_id IN (16, 17, 18, 19, 20, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 41, 42, 44, 45, 46, 47, 48, 49, 51, 52, 53, 54, 74, 75, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166)) AND (t_d.attribute_id IN ('272', '510', '875', '877', '903', '501', '935', '952', '904', '102', '513', '110', '859', '862', '508', '863', '525', '502', '107', '860', '273', '274', '526', '861')) AND (t_d.store_id = 0) UNION ALL SELECT `t_d`.`entity_id`, `t_d`.`attribute_id`, `t_d`.`value` AS `default_value`, `t_s`.`value` AS `store_value`, IF(t_s.value_id IS NULL, t_d.value, t_s.value) AS `value` FROM `catalog_product_entity_decimal` AS `t_d`
 LEFT JOIN `catalog_product_entity_decimal` AS `t_s` ON t_s.attribute_id = t_d.attribute_id AND t_s.entity_id = t_d.entity_id AND t_s.store_id = 1 WHERE (t_d.entity_type_id = 10) AND (t_d.entity_id IN (16, 17, 18, 19, 20, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 41, 42, 44, 45, 46, 47, 48, 49, 51, 52, 53, 54, 74, 75, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166)) AND (t_d.attribute_id IN ('100', '960', '503', '943', '99', '567', '270', '101')) AND (t_d.store_id = 0) UNION ALL SELECT `t_d`.`entity_id`, `t_d`.`attribute_id`, `t_d`.`value` AS `default_value`, `t_s`.`value` AS `store_value`, IF(t_s.value_id IS NULL, t_d.value, t_s.value) AS `value` FROM `catalog_product_entity_varchar` AS `t_d`
 LEFT JOIN `catalog_product_entity_varchar` AS `t_s` ON t_s.attribute_id = t_d.attribute_id AND t_s.entity_id = t_d.entity_id AND t_s.store_id = 1 WHERE (t_d.entity_type_id = 10) AND (t_d.entity_id IN (16, 17, 18, 19, 20, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 41, 42, 44, 45, 46, 47, 48, 49, 51, 52, 53, 54, 74, 75, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166)) AND (t_d.attribute_id IN ('940', '571', '271', '562', '878', '106', '879', '906', '873', '703', '105', '103', '942', '941', '96', '836', '931', '874', '876', '905', '109', '880', '493', '881', '481', '570')) AND (t_d.store_id = 0) UNION ALL SELECT `t_d`.`entity_id`, `t_d`.`attribute_id`, `t_d`.`value` AS `default_value`, `t_s`.`value` AS `store_value`, IF(t_s.value_id IS NULL, t_d.value, t_s.value) AS `value` FROM `catalog_product_entity_datetime` AS `t_d`
 LEFT JOIN `catalog_product_entity_datetime` AS `t_s` ON t_s.attribute_id = t_d.attribute_id AND t_s.entity_id = t_d.entity_id AND t_s.store_id = 1 WHERE (t_d.entity_type_id = 10) AND (t_d.entity_id IN (16, 17, 18, 19, 20, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 41, 42, 44, 45, 46, 47, 48, 49, 51, 52, 53, 54, 74, 75, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166)) AND (t_d.attribute_id IN ('572', '573', '704', '705', '568', '569')) AND (t_d.store_id = 0) 
```

要了解有关在各种上下文中运行哪些查询的更多信息，请创建一个空脚本，仅加载`Mage::app()`并使用集合并将 $_logAllQueries 设置为 true in `Varien_Db_Adapter_Pdo_Mysql`。附加信息：[这里](http://blog.nexcess.net/2011/04/15/logging-database-queries-in-magento/)。

# jquery - 在 Ruby on Rails 表单中获取 HTML5 范围值

> ID：15297085
> 
> 赞同：7
> 
> 时间：2013-03-08T15:09:00.450
> 
> 标签：jquery, ruby-on-rails, html, forms, slider

我正在尝试更改标准的 Ruby on Rails 表单以让用户输入 HTML5 范围的值。我不知道应该如何替换标准的“<%= f.text_field :W1 %>”。

我有一个滑块：

```
<input class="slide" type="range" min="0" max="200" id="slider1"> 
```

显示值：

```
<text id="W1">100</text> 
```

感谢阿贾克斯：

```
 $("#slider1").change(function () {                    
   var newValue = $('#slider1').val();
   $("#W1").html(newValue);
}); 
```

我不知道应该在哪里以及如何获取输入值来设置 W1 ？

编辑：HTML5 范围是 Ruby 中的 range_field 形式 herlper。我仍在寻找正确的实施方式，因此将不胜感激

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-08T18:21:34.763

我有！我不得不更换

```
<input class="slide" type="range" min="0" max="200" id="slider1"> 
```

经过

```
<%= f.range_field :w1, :min=>0, :max=>200, :class=>"slide", :id=>"slider1"%> 
```

感谢那些帮助过我的人！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:01:02.540

```
$("#W1").val(newValue); 
```

这应该这样做。

# jquery - 在 jQuery 中分配点击监听器的不同方法

> ID：15297087
> 
> 赞同：0
> 
> 时间：2013-03-08T15:09:09.640
> 
> 标签：jquery, event-handling

只是想知道有什么区别：

```
$("#some_div").click(customFunction); 
```

和

```
$("#some_div").click(function() { customFunction(); }); 
```

...

```
function customFunction() {

    console.dir(this);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:10:26.557

在第二个中，您定义了两个函数，一个是匿名函数，另一个是 customFunction，首先您只有一个匿名函数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:10:58.243

应该没什么区别吧。除了在第一个选项中，您只声明了一个函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T15:16:56.940

在实践中，它可能不会有所作为（如果它目前可以双向工作）。

然而，理论上，有很大的不同。

1.  所有事件处理程序都有一个`event`参数。在您的第一种情况下，这被传递给`customFunction`，在第二种情况下，它不是。这意味着第一个参数的值将是`undefined`.
2.  jQuery 调用事件处理程序，事件的目标为`this`. 但是`this`，在`customFunction`执行您的第二种情况时，将指向`window`.
3.  `customFunction`您可以在附加事件处理程序和执行事件处理程序之间更改变量的值。如果您这样做，您的第一个案例将执行旧函数，但是，第二个案例将“尊重”新值`customFunction`并执行它。

一般来说，第二种情况更灵活（但也会带来额外的嵌套函数调用的开销）。如果您确实需要在不牺牲（第 1 点和第 2 点）的情况下增加灵活性（参见第 3 点），请使用以下构造：

```
$("#some_div").click(function() { customFunction.apply(this, arguments); }); 
```

这将使用原始参数以及`this`（外部函数的）内部函数（ ）调用，但仍然允许您在事件处理程序执行时`customFunction`换出实现。`customFunction`

# java - 如何在 Java 中遍历 JSON？

> ID：15297090
> 
> 赞同：0
> 
> 时间：2013-03-08T15:09:13.633
> 
> 标签：java, json, gson, loops

在尝试理解和学习 JSON 时，我遇到了一个问题：

```
{
"items": [
    {
        "id": "353453",
        "count": 2,
        "amount": 50
    },
    {
        "id": "3534534",
        "count": 1,
        "amount": 1.9
    },
    {
        "id": "23423423",
        "count": 2,
        "amount": 1.1
    },
    {
        "id": "2342234",
        "count": 3,
        "amount": 32.9
    }
],
"oid": 1000000009
} 
```

这就是我到现在为止的编码：

```
public class Test {

    public static void main(String... args) throws Exception {

        String json = "{\"items\":[{\"id\":\"353453\",\"count\":2,\"amount\":50.00},{\"id\":\"3534534\",\"count\":1,\"amount\":1.90},{\"id\":\"23423423\",\"count\":2,\"amount\":1.10},{\"ean\":\"2342234\",\"count\":3,\"amount\":32.90}],\"oid\":1000000009}";

   System.out.println(dojObject.getItems().get(0).getID());

    }

}

class DataOrderJson {

    private List<ItemDetails> items;
    private Long oid;

    public DataOrderJson() {

    }

    public Long getOid() {
        return oid;
    }

    public List<ItemDetails> getItems() {
        return items;
    }

    public void setOid(Long oid) {
        this.oid = oid;
    }

    public void setItems(List<ItemDetails> items) {
        this.items = items;
    }

    @Override
    public String toString() {
        return String.format("{items:%s,oid:%s}", items, oid);
    }

}

class ItemDetails {
    private String id;
    private Long count;
    private Float amount;

    public ItemDetails() {

    }

    public String getID() {
        return id;
    }

    public Long getCount() {
        return count;
    }

    public Float getAmount() {
        return amount;
    }

    public void setID(String id) {
        this.ean = ean;
    }

    public void setCount(Long count) {
        this.count = count;
    }

    public void setAmount(Float amount) {
        this.amount = amount;
    }

    @Override
    public String toString() {
        return String.format("{id:%s,count:%s,amount:%s}", id, count, amount);
    }

} 
```

按预期输出：353453

现在我想检查一个 id 是否是 json 字符串的一部分。我很难将 json 对象的 lsit 转换为 java 对象的列表。如何将 json 对象放入列表并遍历该列表？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:20:13.113

你需要创建两个 java 对象：

```
class Order {

    private List<Item> items;
    private Long orderid;
    Order(){}
} 
```

和

```
Class Item {
    private String ean;
    private Long count;
    private Float amount;
    Item(){}
} 
```

然后只需调用：

```
 Order jobj = new Gson().fromJson(json, Order.class); 
```

为了能够解析 json，您需要与 json 对象具有相同属性名称的对象。

# google-apps-script - 使用应用脚本从 BLOB 创建文件

> ID：15297092
> 
> 赞同：0
> 
> 时间：2013-03-08T15:09:23.647
> 
> 标签：google-apps-script

我想从另一个文档生成的 BLOB 在 Google Drive 中创建一个文档。我试过这个简单的例子：

```
 var doc = DocumentApp.openByUrl("https://docs.google.com/document/d/[My document]/edit");
  var docContentBlob = doc.getBlob();

  var newDocBlob = Utilities.newBlob(
    docContentBlob.getDataAsString(),
    "application/vnd.google-apps.document",
    "TEST DOC BLOB"); 
```

该脚本创建了一个文档，但我无法打开它（当我尝试打开文档时它显示“正在加载，请稍候”并且它永远不会打开。

为什么这个脚本不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-15T14:07:57.603

您需要设置文件的 MIME 类型，以便 Google 知道如何显示/打开它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T17:31:13.237

也不确定（正如 Corey 已经说过的那样）您要尝试做什么，但是当您有一个来自文档的 blob（在这种情况下是指 Google 文档）时，您只能（至少我现在正在考虑）使用 DocsList从那个blob中创建一些“新”的东西......它不会是一个谷歌文档，而是一个pdf文件！

如果您想获取文档的副本，只需使用 docsList 服务中的 makeCopy 即可。

这是一段代码来说明这两种可能性：

```
function myFunction() {
  var doc = DocumentApp.openByUrl("https://docs.google.com/document/d/[My document ID]/edit");
  var docContentBlob = doc.getBlob();
  var copyofDoc = DocsList.getFileById(doc.getId()).makeCopy('new copy of '+doc.getName());// this will create a copy (google doc format)
  var newDocfromBlob = DocsList.createFile(docContentBlob);// this will create a pdf version of your doc
} 
```

# dynamics-crm-2011 - 从 TeamMembership CRM 2011 检索 SystemUser 信息

> ID：15297094
> 
> 赞同：1
> 
> 时间：2013-03-08T15:09:35.727
> 
> 标签：dynamics-crm-2011, dynamics-crm, dynamics-crm-4

我正在尝试从中获取`SystemUser`信息`TeamMembership`。我一直在尝试使用这些片段，但第一个片段是创建一个新实体，但不要检索用户的所有信息，如电子邮件地址、电话号码等......

```
foreach (TeamMembership user in teamMembers)
{
    sysUser.Id = user.SystemUserId.Value; 
    if (sysUser.InternalEMailAddress != string.Empty)
    {
        ActivityParty toParty = new ActivityParty();
        toParty.PartyId = new EntityReference(SystemUser.EntityLogicalName, user.SystemUserId.Value);
        toPartyList.Add(toParty);
    }    
} 
```

然后我尝试了这个，但它没有返回任何东西！

```
// Get the Team Entity from the Workflow input parameter
Guid team = TeamName.Get<EntityReference>(executionContext).Id;
List<SystemUser> users =
    (from user in datacontext.CreateQuery<SystemUser>()
     join teamMembership in datacontext.CreateQuery<TeamMembership>()
     on user.SystemUserId.Value equals teamMembership.SystemUserId
     join thisteam in datacontext.CreateQuery<Team>() on teamMembership.TeamId.Value equals thisteam.TeamId.Value
     where thisteam.Name == TeamName.Get<EntityReference>(executionContext).Name
     select user).ToList();  

foreach(SystemUser user in users)
{
    if (user.InternalEMailAddress != null)
        LoggerObj.WriteLog("User " + user.FirstName + " Email:" + user.InternalEMailAddress);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T19:21:39.863

由于技术原因，我没有运行您的代码（阅读：我有点懒），但我想到您应该放宽 LINQ 语句中的条件。然后，一旦您进入**任何** *SystemUser*实例，您就可以再次收紧它。如果即使在完全放松之后你什么也得不到，那你就会遇到另一个问题。:)

# ios - iOS解析中的JSON

> ID：15297095
> 
> 赞同：0
> 
> 时间：2013-03-08T15:09:37.787
> 
> 标签：ios, json

```
NSString *responseString = [request responseString];
NSDictionary *dictionary=[responseString JSONValue];
NSArray *dic=[dictionary valueForKey:@"data"];

 for (int a=0; a<dic.count; a++) {
        NSInteger z=(NSInteger)a;
        NSLog(@"%@",[[dic objectAtIndex:a] objectForKey:@"nom"]);
    } 
```

这是文件

```
{"data":[ "",{"id":"1","nom":"hello","message":["",{"id":1,"nom":"dad"}]}, {"id":"2","nom":"hi","message":["",{"id":"1","nom":"marie"},{"id":"2","nom":"bob‌​"}]} ] } 
```

当我想解析我的 json 文件时，我看到了变量“a”的问题，`objectAtIndex`因为它是一个整数，但如果我尝试值 5 为例，它的工作就完美了。

你能帮我吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:34:15.953

看看你的`data`数组......第一个对象是一个空字符串。所以，你试图向`objectForKey:`它发送一条消息（相信那是一本字典）并且你遇到了崩溃。您应该删除您的对象或实现一个在尝试提取值之前尝试检查每个对象的逻辑。

# php - 多个 WHERE 查询

> ID：15297098
> 
> 赞同：0
> 
> 时间：2013-03-08T15:09:47.750
> 
> 标签：php, mysql

我正在制作一个像 Facebook、Twitter 或任何其他社交媒体网站一样的新闻提要页面。

我的问题是我需要获取每个用户朋友的所有用户 ID，然后使用所有这些值来查询另一个包含所有新更新的表。

所以，假设我有 3 个朋友 (1,2,3)。我想在同一个查询中使用 WHERE 子句中的所有 3 个值来搜索另一个表，以便我可以按日期对其进行排序。

到目前为止，我所做的方式将所有 id 放入一个数组中，并使用一个 foreach 循环来查询我的数据库以获取我拥有的每个值，但这会根据数组中用户 id 的顺序对所有结果进行分组，所以我的结果像这样 11111,222222,333333 而不是更新的时间。因此，即使 3 在 1 或 2 天之前进行了更新，它总是会在 2 天之后进行。

我知道这可能不是最好的方法，但到目前为止，这是我能想到的唯一方法。

请您提供的任何帮助将不胜感激。

我的代码：

```
$id = $_SESSION['id'];
$update = mysql_query("
    SELECT profile_id FROM `fiends` 
    WHERE `my_fiend_id` = '$id'
    ");
$result = $update;
$fiends = array();

while (($row = mysql_fetch_assoc($result)) !== false) {
    $fiends[] = array(
        'id' => $row['profile_id'],
);}

foreach($fiends as $fiend) {
    $fiend_id = $fiend['id'];
    $update_select = mysql_query("          
        SELECT * FROM `update` 
        WHERE `NU_id` = '$fiend_id'                 
        ORDER BY `time` DESC
        ");

$result = $update_select; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:11:31.947

你应该把它变成一个查询

```
SELECT `update`.*
FROM `update`
INNER JOIN `fiends` ON update.`NU_id` = fiends.`my_fiend_id`
WHERE `my_fiend_id` = '$id'              
ORDER BY `time` DESC 
```

或者，您可以使用`IN ()`语句

```
"SELECT * FROM `update` WHERE `NU_id` = IN ('".join(',', $fiend_id)."')" 
```

你的最后陈述看起来像这样

```
WHERE `NU_id` IN (11111,222222,333333) 
```

如果`NU_ID`是 varchar 列，请确保在值周围使用引号

```
WHERE `NU_id` IN ('11111','222222','333333) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:12:59.963

我建议您在 SQL 查询中使用内部联接，而不是使用 PHP 循环。MySQL 比 PHP 循环更快。

先试试这个更简单的版本

```
SELECT friends.profile_id, update.* 
FROM `fiends`, `update` 
WHERE `my_fiend_id` = '$id'
AND `NU_id` = `my_fiend_id`                 
ORDER BY `time` DESC 
```

# git-tfs - 有什么方法可以在初始快速克隆后检索更多变更集？

> ID：15297110
> 
> 赞同：4
> 
> 时间：2013-03-08T15:10:18.513
> 
> 标签：git-tfs

我已经使用快速克隆命令克隆了一个 TFS 存储库，该命令为我提供了所有最近的变更集。有没有办法在这个现有的存储库中进一步检索到某个版本的旧变更集？如果可以的话，我真的不想克隆一个新的存储库。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T12:58:28.193

该`quick-clone`命令默认签出最后一个修订版，但也许您想使用`-c`带有 TFS 变更集编号的标志...

供您参考，每个命令都有一个带有 flag 的集成帮助`--help`，例如： `git tfs quick-clone --help`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-09T18:45:27.183

不幸的是，没有办法做到这一点。

提交了一个[GitHub 问题，该问题询问，](https://github.com/git-tfs/git-tfs/issues/28)*是否可以在快速克隆变更集之前将早期的 TFS 变更集拉入 git 存储库？*其中一位维护者[回应](https://github.com/git-tfs/git-tfs/issues/28#issuecomment-880421)说，不仅该功能没有实现，而且由于 Git 的运行方式，实现它是不可行的：

> 不，不是。或者，至少，不容易。由于 git 的 sha1 事情，如果您将父提交“P”添加到提交“A”，A 将获得一个新的 sha1 id。所以 git-tfs 不能在快速克隆提交之前回填。

# wpf - WPF 错误处理多语言

> ID：15297111
> 
> 赞同：1
> 
> 时间：2013-03-08T15:10:19.173
> 
> 标签：wpf, mvvm

**情况**：

我想在我的 WPF MVVM 应用程序中实现多种语言的错误处理。我在互联网上做了一些研究，偶然发现了这篇文章：

*   [使用 ViewModel 提供有意义的验证错误消息](http://joshsmithonwpf.wordpress.com/2008/11/14/using-a-viewmodel-to-provide-meaningful-validation-error-messages/)

**问题一**：

*你不能把错误处理移到一个地方吗？在 de Viewmodel 或模型中，但我看不出这两个类都有一些错误处理的原因......*

**问题 2**：

*在他的示例中，错误消息是在模型类中设置的，这是一种好习惯吗？对我来说，它看起来有点“糟糕的编码”......还是我错了？*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-03T16:08:56.613

问题 1：要记住的是 MVVM 模式的每个部分的作用。模型中需要进行一定量的错误处理，但应该只与业务逻辑相关。这些错误需要传达给模型的“客户端”或视图模型。类似地，视图模型中可能会发生一些错误处理，但应仅限于视图模型的角色（即，它需要独立于视图）。

问题 2：我不喜欢在模型中设置错误消息，也不喜欢在视图模型中设置错误消息。错误信息需要传递到可以正确格式化和翻译的视图。这允许为不同的语言创建视图，而无需更改视图模型（或模型）中的任何代码。

我犹豫说“从不”，但我认为模型需要了解其语言环境的情况很少见。

我们使用以下内容来支持多语言：

[http://www.codeproject.com/Articles/35159/WPF-Localization-Using-RESX-Files](http://www.codeproject.com/Articles/35159/WPF-Localization-Using-RESX-Files)

这允许我们传递可以在视图中翻译的错误键。

希望这可以帮助！

# c# - 列表框中的选择未保持选中状态

> ID：15297116
> 
> 赞同：1
> 
> 时间：2013-03-08T15:10:26.783
> 
> 标签：c#, asp.net, listbox

我有一个列表框，其中包含在页面加载时填充的多个项目。列表框中的每一项都可以毫无问题地选择，除了最后一项。单击该选项时，选择会自动跳转到上面的两个项目。我似乎无法理解为什么会发生这种情况。它仅在选择最后一项时发生。列表框位于 ajax 选项卡容器内的更新面板中，但我不明白为什么会有所作为。我真的希望我没有遗漏一些明显的东西......

列表框：

```
 <asp:ListBox ID="availableServicesListBox" 
    runat="server" 
    class="formListBox" 
    AutoPostBack="True" 
    onselectedindexchanged="availableServicesListBox_SelectedIndexChanged"> 
 </asp:ListBox> 
```

页面加载事件：

```
if (!Page.IsPostBack)         
{
      //populate from database    
} 
```

selectedIndex 更改事件（用于自动回发）：

```
protected void availableServicesListBox_SelectedIndexChanged(object sender, EventArgs e)
{
   if (availableServicesListBox.SelectedValue.Length > 10)
   {
      servicePanel.Visible = true;
      activePanel.Visible = true;                
   }

   else
   {
      servicePanel.Visible = false;
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:59:06.930

检查您的值列表并确保您没有任何重复项。我过去看到的是您在列表的后面选择了一个值，但它是列表中前面项目的重复值。所以发生的事情是选择简单地应用于第一个匹配项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:31:13.933

如果可能的话，我建议您使用客户端 javascript/Jquery 来执行此操作，您可以将 onChange 事件添加到您的 listBox 并使用 jquery .Show()、.Hide() 方法来显示或隐藏您的面板。它也快得多。唯一的问题是面板在视图中隐藏，同时使用 servicePanel.Visible = false; 面板根本没有出现在页面上。

# json - 将 JSON 数据对象从 jquery ajax 传递到 asp.net webmethod

> ID：15297117
> 
> 赞同：4
> 
> 时间：2013-03-08T15:10:27.300
> 
> 标签：json, jquery, webmethod

我有类似这样的数据：

```
var data = {
        email: $("#txtEmail").val(),
        password: $("#txtPassword").val()
    }
    data = JSON.stringify(data); 
```

我使用 jquery ajax 并将这些数据传递给我的 web 方法。如果我的 webmethod 是这样的，这一切都有效：

```
[WebMethod]
    public static Response TryLogin(string email, string password) {..} 
```

但我正在尝试将数据传递给如下所示的 Web 方法：

```
[WebMethod]
    public static Response TryLogin(LoginData data) {..} 
```

我的 LoginData 类看起来与此类似：

```
public class LoginData
        {
            public string email { get; set; }
            public string password { get; set; }
        } 
```

当我尝试这样做时，我收到以下错误：

错误：500：{“消息”：“无效的 Web 服务调用，参数缺失值：\u0027data\u0027。

我该如何正确地做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:12:31.067

```
data = JSON.stringify({data: data}); 
```

详细地说，您当前正在发送 2 个参数，而您的 Web 方法只需要一个（命名数据）。

# jquery - 按日期触发 jquery 选项卡

> ID：15297123
> 
> 赞同：0
> 
> 时间：2013-03-08T15:10:47.110
> 
> 标签：jquery, date, tabs, jquery-tabs

我正在使用 jquery 选项卡来过滤一周内发生的一些事件。 [http://jqueryui.com/tabs/](http://jqueryui.com/tabs/)

所以我有标签

```
 <div id="tabs">
  <ul>
    <li><a href="#tabs-1">1st June 2013</a></li>
    <li><a href="#tabs-2">2nd June 2013</a></li>
    <li><a href="#tabs-3">3rd June 2013</a></li>
  </ul>
  <div id="tabs-1">
    <p>Proin elit arcu, rutrum commodo, vehicula tempus, commodo a, risus. Curabitur nec arcu. Donec sollicitudin mi sit amet mauris.</p>
  </div>
  <div id="tabs-2">
    <p>Morbi tincidunt</p>
  </div>
  <div id="tabs-3">
    <p>Mauris eleifend est et turpis.</p>
    <p>Duis cursus.</p>
  </div>
</div> 
```

例如，我希望 tab-1 在 2013 年 6 月 1 日打开，然后在 6 月 2 日到来时，tab-2 将成为页面加载时的活动选项卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:13:59.223

您可以使用 `jQuery.now()` 获取当前日期

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:17:48.447

有点奇怪。你可以这样做。

```
<li><a href="#tabs-1" data-date="2013-06-01">1st June 2013</a></li>
<li><a href="#tabs-2" data-date="2013-06-02">2nd June 2013</a></li>
<li><a href="#tabs-3" data-date="2013-06-03">3rd June 2013</a></li> 
```

页面加载后，您可以使用：

```
$(document).ready(function(){
    var today = (new Date()).getFullYear() + "-" + ((new Date()).getMonth()+1) + "-" + (new Date()).getDate();
    $('[data-date="' + today + '"]').click();
}); 
```

您将打开当天的标签。

### 小提琴：http: [//jsfiddle.net/praveenscience/f2Mav/](http://jsfiddle.net/praveenscience/f2Mav/)

# vba - 如果在表单的第一条/最后一条记录处，如何禁用导航按钮

> ID：15297128
> 
> 赞同：2
> 
> 时间：2013-03-08T15:10:59.297
> 
> 标签：vba, ms-access, navigation

在 MS Access 2007 中，我希望能够禁用表单上的导航按钮。

伪代码如下

```
If at the first record Then
Disable Previous button

ElseIf at the last record Then
Disable the Next button 
```

我认为这与当前事件有关。虽然我只是不确定具体的逻辑。

有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:39:44.973

默认情况下，如果您位于记录集的开头或结尾，Access 会禁用普通导航窗格上的上一个和下一个按钮。

如果您使用自定义导航按钮，那么您可以使用

```
Private Sub Form_Current()
    cmdPrevious.Enabled = Not (CurrentRecord = 1)
    cmdNext.Enabled = Not (CurrentRecord = DCount(AnyField, RecordSource))
End Sub 
```

# ember.js - ember.js：我只能在路由中渲染吗？

> ID：15297134
> 
> 赞同：1
> 
> 时间：2013-03-08T15:11:07.547
> 
> 标签：ember.js, ember-router

我需要一些关于 ember.js 的“概念性”建议。

`transitionTo`我想我理解当 URL 更改（手动或使用）时，事情是如何处理直接情况的。该路由负责加载相应的模型并将模板渲染到父级的插座中。

**我不明白的是**：在某些情况下您想更改应用程序的状态但您不想（或不能）更改 URL。

假设我有一个带有两个出口的模板：

```
<div id='dashboard'>
  <div id='top'>{{outlet top}}</div>
  <div id='bottom'>{{outlet bottom}}</div>
</div> 
```

`top`和`bottom`仪表板的一部分是相互独立的。最初，应用程序可能会转换到一个`/dashboard`路由，该路由呈现出口的初始状态`top`并`bottom`进入出口。但那会发生什么呢？如果我想更改`top`插座的内容，我应该在哪里渲染和插入该内容（因为不涉及路由）？我可以在控制器中渲染吗？我是否必须设置自定义视图容器以及如何以及在何处呈现？

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:53:24.350

不确定这是否是最好的方法，但我在玩，让它像这样工作：

[**完整来源**](http://jsfiddle.net/schawaska/jMYQn/)| [**跑**](http://jsfiddle.net/schawaska/jMYQn/show/#/dashboard)

**JavaScript**：

```
App.DashboardView = Em.View.extend({
    starActive: true,
    userActive: false,
    heartActive: false,
    resetDisplay: function() {
        this.set('starActive', false);
        this.set('userActive', false);
        this.set('heartActive', false);
    },
    star: function() { 
        console.log('star'); 
        this.resetDisplay();
        this.set('starActive', true);
    },
    user: function() {
        console.log('user'); 
        this.resetDisplay();
        this.set('userActive', true);
    },
    heart: function() {
        console.log('heart'); 
        this.resetDisplay();
        this.set('heartActive', true);
    }
}); 
```

**车把**：

```
<script type="text/x-handlebars" data-template-name="_navDashboard">
    <ul class="nav-list">
        <li class="nav-header">Actions</li>
        <li>
            <a {{action star target="view"}}><i class="icon-star"></i> One</a>
        </li>

        <li>
            <a {{action user target="view"}}><i class="icon-user"></i> Two</a>
        </li>
        <li>
            <a {{action heart target="view"}}><i class="icon-heart"></i> Three</a>
        </li>
    </ul>
</script>

<script type="text/x-handlebars" data-template-name="dashboard/user">
    <h3>User</h3>
</script>

<script type="text/x-handlebars" data-template-name="dashboard/star">
    <h3>Star</h3>
</script>

<script type="text/x-handlebars" data-template-name="dashboard/heart">
    <h3>Heart</h3>
</script>

<script type="text/x-handlebars" data-template-name="dashboard">
    <div class="row-fluid">
        <h2>Dashboard</h2>
    </div>
    <div class="row-fluid">
        <div class="span3">
            <div class="well sidebar-nav">
              {{partial navDashboard}}
            </div>
        </div>
        <div class="span7">
            {{#if view.starActive}}
                {{render "dashboard/star"}}
            {{/if}}
            {{#if view.userActive}}
                {{render "dashboard/user"}}
            {{/if}}
            {{#if view.heartActive}}
                {{render "dashboard/heart"}}
            {{/if}}
        </div>
    </div>
</script> 
```

我不确定这个解决方案，因为它让开发人员负责管理何时渲染或不渲染某个模板或视图；根据复杂性，可能会更容易出错并同时留下多个视图显示，甚至显示错误的视图，但这就是我目前得到的。

# mysql - 使用 Hibernate /MySQL 归档过时行的策略

> ID：15297138
> 
> 赞同：0
> 
> 时间：2013-03-08T15:11:19.467
> 
> 标签：mysql, hibernate, hibernate-envers

在我们的 Web 应用程序中，我们有一个 MySQL 表，用于存储发送给用户的通知的详细信息。这些通知一旦被用户阅读，就会被标记为“已关闭”，并且不太可能再次查看，但我们无法永久删除它们。会有很多通知，所以我们需要定期将它们移出“实时”表。我们正在使用 Hibernate Envers。我们似乎可以使用两种策略：

1.  定期从“实时”表中删除“已关闭”通知；这些将通过 Hibernate Envers 在 Notification_AUD 表中存档。这使得在需要时可以直接找到过时的通知，并且符合我们的审计策略，但随着时间的推移 Notification_AUD 表会变得庞大。

2.  维护定期生成的表，用于存储某个日期范围内的过时通知。例如，Notifications_2013_01、Notifications_2013_02 等。这具有不让表变得庞大的优点，但违背了使用诸如 Hibernate Envers 之类的库的目的，因为我们正在滚动我们自己的解决方案。此外，Hibernate 似乎不太支持将单个实体类映射到多个表的概念，因此我们需要使用原生 MySQL 查询，或者可能是一些元数据表才能找到要查找的正确表例如，给定日期范围内的通知。

如果有人有任何智慧可以通过实施任何类似的事情来传授，那么很高兴收到您的来信，或者对您有用的替代策略。

谢谢理查德

# jquery - jQuery 淡入淡出切换

> ID：15297143
> 
> 赞同：0
> 
> 时间：2013-03-08T15:11:30.560
> 
> 标签：jquery, tooltip, fadein, fadeout

我正在尝试使用 jquery fadetoggle 来平滑淡入和淡出。除了一件事，一切都很好。当你悬停段落时，工具提示会淡入，当你离开段落时，工具提示会淡出，但是当你悬停段落时，然后你悬停工具提示，它会很快淡出并淡入。我怎样才能摆脱这个动画？我的意思是当我悬停它时工具提示不应该淡入。如果我悬停该段落，它应该只淡入

css

```
p{position: relative; cursor: default;}
#tooltip{display: none; position: absolute; top: -28px; left: 0px; padding: 1px 10px; border-radius: 13px; background: #3DD13D; color: #fff;} 
```

html

```
<p>Text which has meta info when hovered<span id="tooltip">Hi im meta info</span></p> 
```

js

```
$(document).ready(function(){   
    $('p').hover(function(){
        $('#tooltip').fadeToggle("500", "linear", "true")
    })
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:15:33.703

在切换之前添加一个[停止动画：](http://api.jquery.com/stop/)

```
$('#tooltip').stop().fadeToggle("500", "linear", "true") 
```

[在这里](http://jsfiddle.net/soyuka/G6xzh/)看小提琴。

# c# - 如何防止旧数据在表单重新提交时显示？

> ID：15297156
> 
> 赞同：0
> 
> 时间：2013-03-08T15:12:29.723
> 
> 标签：c#, asp.net

我有一个表单，当用户单击比较按钮时，根据比较模式设置为“完整”还是“部分”，不同的代码将执行并在 GridView 中显示数据。

![在此处输入图像描述](../Images/b0587b2313b332cb736b87596cb460d6.png)

这是在 if/else 块中设置的。我有两个 GridView，一个显示“部分”比较的结果，一个显示“完整”比较的结果。一切正常，除非用户更改比较模式并再次单击比较按钮（即不关闭窗口并重新运行程序），两个 GridView 会立即显示，即使它们在单独的块中绑定到 DataTable（一个在if, the other in the else) ，因此*不应该同时出现*。

![](../Images/a00a16929e411967732a036fe0cbc00e.png)

I tried hiding the other gridview using `gridview1.Visible = false;`so that, for example, the gridview for full compare is invisible when the partial compare option is selected, and vice versa. 这不起作用 - 它使两者都看不见，所以你什么都看不到！

```
protected void Run_Comparison(object sender, EventArgs e)
{
    DataTable dt = new DataTable();

    if (CompareMode.SelectedValue.Equals("Partial"))
    {
        gridview2.Visible = false; // trying to make full compare gridview invisible

        // populate dt and execute partial compare  

        gridview1.DataSource = dt;
        gridview1.DataBind();
    }
    else if (CompareMode.SelectedValue.Equals("Full"))
    {
        gridview1.Visible = false; // trying to make partial compare gridview invisible

        // populate dt and execute full compare  

        gridview2.DataSource = dt;
        gridview2.DataBind();
    }
} 
```

我查看了回发，但仍然不确定如何处理这个问题，甚至不知道如何为这个问题命名。有任何想法吗？

# php - PHP – 从扩展插入中检索自动递增的值

> ID：15297160
> 
> 赞同：4
> 
> 时间：2013-03-08T15:12:38.603
> 
> 标签：php, mysql, insert-id

我目前正在使用`$mysqli->insert_id`在插入新行时从 MySQL 表中检索自动分配的主键。这适用于单个插入。这是一个简单的案例

```
$result = $mysqli->query($query);
$NewPrimaryKey = $mysqli->insert_id; 
```

但是，我（实际上是从这个站点）了解到，使用扩展插入可以更好地完成多个插入：

```
insert into table (name1,name2,name3) values 
('blah1','blah2',blah3'), 
('blah1','blah2',blah3'), 
('blah1','blah2',blah3')) 
```

这也很有效——除非我想知道哪些键是自动分配的。

PHP手册说：

> 在具有 AUTO_INCREMENT 字段的表上运行扩展插入时，mysqli_insert_id() 的值将等于插入的*第一* 行的值。

我的测试似乎证实了这一点。

**注意：**我不想要第一个或最后一个。

我不想为了获得单独的 auto_allocated 键而不得不恢复到数千个单次插入。

有谁知道一种方法来进行扩展插入并取回所有分配的键（大概在一个数组中）？

我确实想到在进行扩展写入之前只读取并保留最新的现有密钥，然后计算分配密钥的预期值，但这似乎有点夸张。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:16:43.987

我不认为您可以获得所有新插入的行 ID，但如果`insert_id`返回第*一个*ID，您可以假设插入的 ID 是该 ID 到插入次数的范围（应该是这种情况，除非出了点问题，但是整个插入应该失败，因为它是原子的）。您还可以选择所有大于或等于 new 的 auto_increment ID `insert_id`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-08T15:18:14.117

你可以计算密钥，不是吗？

```
$keys=array();
for($id=mysqli_insert_id();$id<=$id+$totalRecords;$id++)
   $keys[]=$id; 
```

或者使用类似 ORM 的学说

# ruby - 如何使用 Ruby 的“self”关键字

> ID：15297161
> 
> 赞同：3
> 
> 时间：2013-03-08T15:12:38.777
> 
> 标签：ruby, self

我无法理解`self`关键字。

我了解它是如何用于区分实例方法和类方法的，但是当它从方法内部使用时呢？

就像是：

```
def self.name
  self.name = "TEXT"
end 
```

或者

```
def name2
  self.name = "TEXT2"
end 
```

或者

```
class Array
  def iterate!(&code)
    self.each_with_index do |n, i|
      self[i] = code.call(n)
    end
  end
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:34:35.833

通常，`self`由于可以省略接收器，在这种情况下，通常最好这样做。但是，在某些情况下，省略`self`使代码具有其他含义。

*   一种这样的情况是，如在您的示例`self.name = ...`中，使用 setter 方法。Ruby 的语法在方法和变量调用之间是模棱两可的，当可以解释为变量或方法的内容后跟 时`=`，将其解释为局部变量赋值具有优先权。

*   另一种情况是当您要调用方法时`class`。还有关键字`class`，`class`as关键字的解释优先于方法。

*   还有一种情况是当您想使用该方法时`[]`。这种表示法也用于数组字面量，将其解释为数组优先于作为方法。

在每种情况下，您都必须使表达式明确地成为方法调用。一种方法是显式写入接收器，即使它是`self`. 另一种方法是写`()`在方法之后。

关于你的例子`self.each_with_index ...`，`self`可以省略，不这样做不是推荐的做法。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T15:29:22.653

`self`与实例方法和类方法之间的区别绝对没有任何关系。事实上，它们之间甚至*没有*区别，因为 Ruby 没有*类*方法。Ruby 只有实例方法。

`self`在 Ruby 中，与其他所有面向对象语言中的（或有时称为）*完全相同：它是对当前对象的引用。*就是这样。它实际上只是一个指向“我自己”的指针。`self``this`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:15:41.530

`self`实际上在 Ruby 中定义了您的范围。当您从模块切换到类，从类切换到方法等等时，范围会不断变化......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T15:15:16.197

类方法（因为`self`对类的引用）：

```
class MyClass
  def self.myMethod
    "hello"
  end
end

MyClass.myMethod 
```

而没有的方法`self`是实例方法：

```
class MyClass
  def myMethod
    "hello"
  end
end

c = MyClass.new
c.hello 
```

对于变量，它也是一个作用域。如果你的类有访问器，你可以使用`self`. 不使用`self`通常意味着你想从你的方法的范围内访问一个局部变量（假设没有给出魔法）。

```
class MyClass
  attr_accessor :var

  def myMethod
    self.var # => "hello"
    var # => undefined
  end
end 
```

# printing - 如何打印 OpenTK (OpenGL) 或更改设备上下文？

> ID：15297164
> 
> 赞同：0
> 
> 时间：2013-03-08T15:12:53.333
> 
> 标签：printing, opentk

使用 OpenTK / OpenGL，我可以在 Winforms 上进行绘制。但是我如何在打印机上绘图？

我在甘特图上工作[并](http://ganttchart.codeplex.com/)使用这段代码进行打印，但我不确定如何让设备上下文进入 GLControl。

```
private void print_click(object sender, EventArgs e)
{
    dialog.Document = new PrintDocument();
    using (var dialog = new PrintDialog())
    {
        if (dialog.ShowDialog() == System.Windows.Forms.DialogResult.OK)
        {
            dialog.Document.BeginPrint += new System.Drawing.Printing.PrintEventHandler(Document_BeginPrint);
            dialog.Document.EndPrint += new System.Drawing.Printing.PrintEventHandler(Document_EndPrint);
            dialog.Document.PrintPage += new System.Drawing.Printing.PrintPageEventHandler(Document_PrintPage);
            dialog.Document.Print();
        }
    }
}

void Document_PrintPage(object sender, System.Drawing.Printing.PrintPageEventArgs e)
{
    // This code does not work!
    // something to do with e.Graphics.GetHdc() ???
    var nullWindow = OpenTK.Platform.Utilities.CreateWindowsWindowInfo(IntPtr.Zero);
    // Exception of type 'OpenTK.Graphics.GraphicsContextException' was thrown.
    var printcontext = new OpenTK.Graphics.GraphicsContext(new ContextHandle(e.Graphics.GetHdc()), nullWindow);
    printcontext.MakeCurrent(nullWindow);
    // GL.Begin(...)
    // ...
    // GL.End()
    // printcontext.SwapBuffers()? Should be single-buffered?
}

void Document_EndPrint(object sender, System.Drawing.Printing.PrintEventArgs e)
{

}

void Document_BeginPrint(object sender, System.Drawing.Printing.PrintEventArgs e)
{

} 
```

我还注意到了`OpenTK.Graphics.GraphicsContext (ContextHandle handle, IWindowInfo window)`构造函数，但我不确定要为 IWindowInfo 放置什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T14:21:40.130

我刚刚考虑的一种解决方法是拍摄渲染图像的位图快照，就像这里[http://www.opentk.com/doc/graphics/save-opengl-rendering-to-disk](http://www.opentk.com/doc/graphics/save-opengl-rendering-to-disk)

# random - 随机发生器和CUDA

> ID：15297168
> 
> 赞同：5
> 
> 时间：2013-03-08T15:12:58.570
> 
> 标签：random, cuda

我对 CUDA 中的随机生成器有疑问。我正在使用 Curand 使用以下代码生成随机数：

```
__device__ float priceValue(int threadid){

    unsigned int seed = threadid ;
    curandState s;
    curand_init (seed , 0, 0, &s);

    float randomWalk = 2;
    while (abs(randomWalk)> 1) {
        randomWalk = curand_normal(&s);
    }
    return randomWalk; 
} 
```

我多次尝试重新启动这段代码，我总是有相同的输出。我找不到这段代码有什么问题。线程给出相同的 ID，但 curand_normal 函数应该在每次启动时改变，对吧？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T16:09:18.467

每次请求随机值时，您都在运行 init。相反，您应该`curand_init()`在代码开头的单独内核中运行一次。然后，当您想要一个新的随机值时，只需调用`curand_normal()`. 然后，每次调用设备函数时，这些值都会改变。

例如，请参阅我的答案[here](https://stackoverflow.com/questions/15247522/cuda-random-number-generation/15252202#15252202)。

如果您想将时间用作种子而不是线程 ID，则传递返回[的值](http://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#time-function)`clock()`或您最喜欢的时间函数：

```
unsigned int seed = (unsigned int) clock64(); 
```

# c# - C# Visual Studio 2012 白色边栏

> ID：15297172
> 
> 赞同：3
> 
> 时间：2013-03-08T15:13:04.170
> 
> 标签：c#, visual-studio-2012

我正在使用带有深色主题的 Visual Studio 2012，并且我有一个白色侧边栏，我想将其隐藏或更改为较暗的颜色。这是带有侧边栏的图像，因此您可以看到

![在此处输入图像描述](../Images/ea2df43729f84677509b9f376ad90888.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T16:57:53.880

那是您可以在工具|选项下更改颜色的指标边距。然后在环境|字体和颜色下。转到指标保证金显示项。您可以在那里更改背景颜色。

![在此处输入图像描述](../Images/b9ac94503afac704cb3598f4afcb713a.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T17:12:46.663

如果您使用的是[Visual Studio 2012 颜色主题编辑器](http://visualstudiogallery.msdn.microsoft.com/366ad100-0003-4c9a-81a8-337d4e7ace05)扩展，那么您可以将值设置为您想要的任何颜色。`Tools->Customize Colors`首先通过选择菜单打开编辑器。将鼠标悬停在您的自定义主题上（如果您还没有创建一个）并选择`Edit Theme`. 选择`Show All Elements`顶部的图标并搜索“指标”。编辑颜色`Text Editor -> Indicator Margin -> Background`并单击“保存并应用”图标。

# jquery - HighCharts / Highstock 如何建立 100% 堆积面积图

> ID：15297174
> 
> 赞同：0
> 
> 时间：2013-03-08T15:13:10.043
> 
> 标签：jquery, highcharts, highstock

是否可以在 High Charts 或 High Stock 中完成 100% 堆积面积图？该图表需要显示一段时间内的数据，并且每个日期的总和必须达到 100%。我已经尝试构建一个 Highstock 面积图，但它确实不是我需要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:35:20.030

我发现您可以将以下内容添加到图表的绘图选项中

```
plotOptions: { area: { stacking: 'percent'} } 
```

# email - 在 Textarea 中使用撇号时的反斜杠

> ID：15297175
> 
> 赞同：0
> 
> 时间：2013-03-08T15:13:23.397
> 
> 标签：email, encoding, expressionengine, apostrophe

我在这个页面上有一个邀请朋友的表格：http: [//backtochurch.com/emailafriend/friends](http://backtochurch.com/emailafriend/friends)

我有一个文本区域，其中包含一些预填充的文本，最后一行带有“it's”一词。撇号在发送的电子邮件中不断被编码，撇号前面有一个反斜杠。

我正在使用 ExpressionEngine 并且 Magic Quotes 已关闭

我试过使用：

```
\\\' &#146; &apos; 
```

我已经为此寻找答案，但这些解决方案都不适合我。

有任何想法吗？

# colors - highcharts 图例颜色定制

> ID：15297178
> 
> 赞同：1
> 
> 时间：2013-03-08T15:13:28.543
> 
> 标签：colors, highcharts, customization, legend

我正在寻找一种在 Highcharts 中自定义图例字体的方法。

我尝试了不同的方法，这些方法看起来不错，但没有任何效果。

感谢您的帮助。

这是我的代码：

```
$(function () {
var chart = new Highcharts.Chart({

    chart: {
        renderTo: 'container'
    },

    xAxis: {
        categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
    },

    legend: {
        layout: 'horizontal',
        itemStyle: {
            paddingBottom: '10px'
        },
        //style: {
        color: '#FF0000', fontFamily: 'Arial', fontSize: '24px'
        //}
    },

    series: [{
        data: [29.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4]
    }, {
        data: [129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4, 29.9, 71.5, 106.4]
        }]

    });
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:47:11.790

您需要指定 itemStyle。例如

```
itemStyle:{'font-size':'30px'} 
```

根据您要使用的 css，您可能还必须设置“useHTML”。从文档中：

```
Using HTML allows for advanced formatting, images and reliable bi-directional text rendering. 
```

# uiactivityviewcontroller - UIActivityViewController xcode警告

> ID：15297179
> 
> 赞同：2
> 
> 时间：2013-03-08T15:13:34.760
> 
> 标签：uiactivityviewcontroller

当我点击我的 barButtomItem 以将我的应用程序中的内容共享到 FB、Tw、微博和邮件时，我在调试区域收到此消息。iOS6 XCode 4.5.1

> 2013-03-08 15:59:31.609 细胞学[2088:1cd03] 启动服务：注册未知应用标识符 com.apple.mobilemail 失败 2013-03-08 15:59:31.610 细胞学[2088:1cd03] 启动服务：无法查找应用标识符 com.apple.mobilemail

这是我的代码：

```
-(IBAction)shareButtonPressed:(id)sender {
    NSLog(@"shareButton pressed");

    NSString *texttoshare = _txt;
    UIImage *imagetoshare = _img;
    NSArray *activityItems = @[texttoshare, imagetoshare];    
    UIActivityViewController *activityVC = [[UIActivityViewController alloc] initWithActivityItems:activityItems applicationActivities:nil];
    activityVC.excludedActivityTypes = @[UIActivityTypeAssignToContact, UIActivityTypePrint];
    [self presentViewController:activityVC animated:TRUE completion:nil];
} 
```

尽管有编译警告消息，我还是能够成功发布和发送邮件......我读到了一些关于使用外部库的内容，但我不喜欢这个解决方案。我确定我错过了一些明显的东西。

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-01T03:38:26.543

根据我的阅读，社交框架和模拟器存在问题。你试过**真机**吗？

或者

可能是因为模拟器**没有邮件应用**。

# jquery - jQuery 循环图像和文本

> ID：15297180
> 
> 赞同：0
> 
> 时间：2013-03-08T15:13:35.683
> 
> 标签：jquery

我正在使用 jquery`cyclyer`使用`next`和`previous`按钮在图像之间循环。我正在骑自行车的图片位于我页面的中心。除了图片，还有文字（与图片匹配），当图片循环时应该改变。可以在[这里](http://www.pizzeriamarcello.sk/ibk/index.html)看到一个例子。

我不能`alt=''`在图像上使用而只显示该文本，因为我希望将一些样式应用于`div`显示文本的位置。有没有办法使用 jQuery 来完成这种文本更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:20:49.587

如果您使用 jQuery Cycle，您可以使用`div`s 或`figure`s 将图像和文本全部包装在一个块级容器中；该插件会将每个容器视为一张幻灯片。请参阅[示例](http://jquery.malsup.com/cycle/int2.html)（或Cycle2 的[此示例](http://jquery.malsup.com/cycle2/demo/non-image.php)）。

```
<div id="slideshow2" class="pics">
    <figure>
        <a href="images/1.jpg" rel="lightbox"><img src="images/1m.jpg"></a>
        <figcaption>Text text text text</figcaption>
    </figure>
    <figure>
        <a href="images/2.jpg" rel="lightbox"><img src="images/2m.jpg"></a>
        <figcaption>Text text text text</figcaption>
    </figure>
    <figure>
        <a href="images/3.jpg" rel="lightbox"><img src="images/3m.jpg"></a>
        <figcaption>Text text text text</figcaption>
    </figure>
</div> 
```

然后通过使用 CSS 定位，您可以将其`figcaption`放置在您想要的页面上的任何其他位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:22:12.390

您可以创建一个可能的文本数组，并更新文本框中的文本...

```
var textArray = [];
textArray[0] = "This is the text for the first image";
textArray[1] = "This is the text for the second image";
textArray[2] = "This is the text for the third image"; 
```

然后给每个图像一个唯一的标识符，例如：

```
<img id="image_0" src="picture1.jpg" />
<img id="image_1" src="picture2.jpg" />
<img id="image_2" src="picture3.jpg" /> 
```

当图像循环时，做一个简单的查找和替换

```
//get the identifier from the image ID, assuming that 'this' 
//refers to the image you just cycled

    var text_index = this.id.replace('image_','');

    $("p#text_box").html(textArray[text_index]); 
```

您可以使用 CSS 设置 p#text_box 的样式

# iphone - 使用 UIView 动画时处理、删除和添加 UILabel

> ID：15297181
> 
> 赞同：0
> 
> 时间：2013-03-08T15:13:35.533
> 
> 标签：iphone, ios, scroll, uilabel, uiviewanimation

我的时间轴应用程序控件出现了另一个问题。

我的 TimelineView 上有一定数量的 UILabel 继承自 UIView。

我实现了一个滚动功能，它工作得很好。当一个元素到达底部时，它会被删除，并在第一个元素上方添加另一个 UILabel，反之亦然。Classes 委托中有一个标签数组，其中存储和删除所有 UIlabels(TimeLabels)。（对于以后的实现很重要小时/天等 - 动态加载，以便内存使用率低）

现在我想在释放触摸手势（通过 touchesEnded）后以一定的速度做一个缓出动画，这是正确计算的。它与 UIView 动画配合得很好：

```
speed/=3;
for(TimeLabel *movingLabel in self.delegate.labels){
    NSLog(@"%i",movingLabel.time);
    [UIView beginAnimations:@"" context:NULL];
    [UIView setAnimationDuration:2.0];
    [UIView setAnimationCurve:UIViewAnimationCurveEaseOut];

    CGRect movingFrame = [[movingLabel.layer presentationLayer] frame];
    NSLog(@"%f",movingFrame.origin.y);

    movingLabel.frame = CGRectMake(7, movingLabel.frame.origin.y+speed, 200, 25);

    [UIView commitAnimations];

} 
```

所有标签的动画都正确完成。

**但是**当我想扩展我的方法（上面未显示）时，当标签的位置低于应用程序的框架高度时，它不会被丢弃（即使使用presentationLayer，根据其他人的说法，它有可能获得当前位置动画时。但它只在记录时显示每个标签的结束位置......）。

所以我的问题是：甚至可以通过在制作动画时检查它的位置来删除 UILabel 吗？和这个问题一样重要：是否可以插入一个新的 UILabel 并添加删除的标签层，以便开始的动画可以用新的动画恢复？

如果这些事情是不可能的：是否有另一种方法可以在不实现全新动画的情况下实现这样的缓动动画？

很难解释它应该是什么样子，但我希望我能正确描述我的问题，并且有人能够帮助我。

问候，

斯加罗斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:52:39.983

听起来您只是希望动画在某些情况下在不同的 y 位置完成。做到这一点的简单方法（如果我正确理解了这个问题）是计算要删除标签的 y 位置，动画到那里，然后添加......

```
[UIView setAnimationDidStopSelector:@selector(removeFromSuperview)]; 
```

你说“低于框架高度”。那是标签超级视图的框架高度吗？如果是这样，将结束位置设置`label.frame.origin.y`为`label.superview.bounds.size.height`

# qt - 调整 QMainWindow 大小时，QTableView 不扩展/缩小

> ID：15297182
> 
> 赞同：1
> 
> 时间：2013-03-08T15:13:37.197
> 
> 标签：qt, qtableview, qmainwindow

我有一个 QMainWindow。

在 QMainWindow 内，我有一个中央小部件。

对于中央小部件，我有一个 QVBoxLayout。

在这个 QVBoxLayout 中，我添加了 3 个小部件。一个是带有一些标签的小部件，它有一个 QGridLayout。另一条是水平线。

第三个是QTableView。问题是，当我尝试扩展 QMainWwindow 时，无论我设置（或未设置）任何调整大小策略，TableView 都不会扩展，并且它会在扩展的 QMainWindow 的其余部分留下一个笨拙的空白区域。

谁能告诉我如何在调整窗口大小时使表格扩展/调整大小。

这是相关的代码。

`

```
statInfoWidget = new Static_Info(TagN);
QWidget *widget = new QWidget;
setCentralWidget(widget);
QFrame *hor_line = new QFrame();
hor_line->setFrameShape( QFrame::HLine );
QVBoxLayout *layout = new QVBoxLayout();
layout->setMargin(2);

layout->addWidget(statInfoWidget);
layout->addWidget( hor_line );
Table = new QTableView(this);
 temp = Table;
 t = new TableLayout(statInfoWidget);
 Table->setModel(t);
 Table->verticalHeader()->hide();
 Table->horizontalHeader()->hide();
 Table->setShowGrid(false);
 Table->setContextMenuPolicy(Qt::CustomContextMenu);
 //Table->setColumnWidth(2,290);
// Table->setColumnWidth(0,25);
// if(num_version == 1)
//     Table->setColumnWidth(1,0);
// else
//   Table->setColumnWidth(1,43);
// Table->setColumnWidth(3,210);
// Table->setColumnWidth(4,170);
// Table->setColumnWidth(5,50);
 statInfoWidget->setStyleSheet("background: rgb(153,185,193);color:rgb(0,0,0); font-family:Tahoma;font-size:19px; border: 0px outset rgb(255,255,255);gridline-color: #669933;"
                       "selection-background-color: qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 #486909, stop: 1 white);");
 Table->setStyleSheet("background: rgb(153,185,193);color:rgb(0,0,0); font-family:Tahoma;font-size:15px; font-weight:bold; border: 0px outset rgb(255,255,255);gridline-color: #669933;"
                       "selection-background-color: qlineargradient(x1: 0, y1: 0, x2: 0, y2: 1,stop: 0 transparent, stop: 1 white);");
// layout->addWidget(button1);
 QSizePolicy policy = Table->sizePolicy();
 policy.setVerticalStretch(1); 
 policy.setHorizontalStretch(1); 
 Table->setSizePolicy(policy);
 layout->addWidget(Table);
 widget->setLayout(layout); 
```

`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T16:05:32.103

您可以考虑以下几点：

```
Table->horizontalHeader()->setResizeMode(QHeaderView::Stretch); 
```

您可能还想调整表中单个列的大小，这可以通过传递列索引来完成：

```
Table->horizontalHeader()->setResizeMode(columnIndex, QHeaderView::Stretch); 
```

# django - gunicorn、nginx (v 1.3.14)、django 和 gevent-socket.io，在 dotcloud 上

> ID：15297184
> 
> 赞同：13
> 
> 时间：2013-03-08T15:13:47.877
> 
> 标签：django, nginx, gunicorn, dotcloud, gevent-socketio

我正在尝试在 dotcloud 上的 nginx (v 1.3.14) 后面部署 gunicorn + gevent。我有几个问题。我的目标是改编[python-on-dotcloud](https://github.com/kencochrane/python-on-dotcloud)示例。到目前为止，我还不能让 websockets 部分使用这个设置。换句话说，我必须手动刷新我的页面以获取更新，而不是通过 socket.io。这对我来说都是全新的，所以这可能是一个完全的菜鸟错误。这是一个[相关的问题](https://stackoverflow.com/questions/13681183/serve-static-files-with-nginx-and-custom-service-dotcloud/13687373#13687373)。

以下是我对 python-on-dotcloud 示例所做的更改。

1.  显然[nginx（从 1.3.13 版开始）支持 web sockets](http://blog.martinfjordvald.com/2013/02/websockets-in-nginx/)。我更新了 python-on-dotcloud 示例中的构建器脚本以指向此开发版本：`nginx_download_url="http://nginx.org/download/nginx-1.3.14.tar.gz"`

2.  我将 gunicorn 设置为绑定到 unix 套接字，然后从 nginx.conf 设置 proxy_pass 以将流量上游发送到`proxy_pass http://appserver;`我定义了 appserver 的 gunicorn。

3.  我正在运行一个带有 gevent-socket.io 的 django 应用程序，它可以在没有运行 nginx 的情况下正常工作。（我只是将 gunicorn 绑定到 dotcloud.yml 中的 0.0.0.0:$PORT_WWW）

我的问题是这些。

1.  我是否试图解决一个非问题？

    一个。我已经阅读了大量建议将 gunicorn 放在 nginx 后面的内容。在 dotcloud 的负载均衡器在一线的背景下，这仍然是真的吗？

    湾。如果我不希望我会受到 DoS 攻击，那么将 gunicorn 放在 nginx 后面仍然很重要吗？

2.  是否可以像我尝试设置的那样通过 unix 套接字运行 websockets？

3.  unix 套接字会破坏 dotcloud 上的缩放吗？

4.  如果我需要改用端口，如何设置？我不认为我可以在同一个应用程序中分配两个 http 端口。如果我将它分成两个应用程序，那么我不确定如何将 PORT_WWW 环境变量从 gunicorn 应用程序传递到 nginx 应用程序，以便它最终可用于 nginx 安装后脚本，从而在生成的 nginx.conf 中可用。

5.  关于为什么这不能按原样工作的任何想法？

我在下面包含了三个配置文件。让我知道其他人是否会提供帮助。谢谢！

**点云.yml**

```
www:
    type: custom
    buildscript: python/builder
    systempackages:
        # needed for the Nginx rewrite module
        - libpcre3-dev
        # needed to support python versions 2.7, 3.1, 3.2.
        - python3-all
    ports:
        www: http
    processes:
        nginx: nginx
        app: /home/dotcloud/env/bin/gunicorn -c /home/dotcloud/gunicorn.conf -b unix:/tmp/gunicorn.sock wsgi:application
        #app: /home/dotcloud/env/bin/gunicorn -c /home/dotcloud/gunicorn.conf -b 0.0.0.0:$PORT_WWW wsgi:application
    config:
        # python_version can have one of the following values (2.6, 2.7, 3.1, 3.2). 2.6 is the default if no value is entered.
        python_version: 2.7
data:
  type: redis
db:
  type: postgresql 
```

**nginx.conf.in**（与常规的 nginx.conf 相同，只有 PORT_WWW 等待交换真实端口号）

```
# template for nginx.conf file.
# the file will be processed by the postinstall script
# it will insert the correct value for PORT_WWW and then put this
# file in /home/dotcloud/nginx/conf/nginx.conf when done.

# nginx will be managed by supervisord when it starts so we don't need daemon mode
daemon off;

worker_processes    1;

events {
    worker_connections  1024;
}

http {

 include       mime.types;
 default_type  application/octet-stream;

 sendfile        on;
 #tcp_nopush     on;

 keepalive_timeout  65;

 log_format combined-realip '$remote_addr ($http_x_real_ip) - $remote_user [$time_local] "$request" $status $body_bytes_sent "$http_referer" "$http_user_agent"';
 access_log  /var/log/supervisor/nginx_access.log combined-realip;
 error_log  /var/log/supervisor/nginx_error.log error;

 gzip  on;

    upstream appserver {
        server unix:/tmp/gunicorn.sock;
        # For a TCP configuration:
        # server 192.168.0.7:8000 fail_timeout=0;
    }

  server {
    # PORT_WWW value is added via postinstall script.
    listen  @PORT_WWW@ default;

    server_name localhost;

    root    /home/dotcloud/current/;

    location / {
        if ( -f /home/dotcloud/current/maintenance) {
            return 503;
        }
        proxy_pass http://appserver;
        proxy_http_version 1.1;
        proxy_set_header upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

    }

    error_page 404 @404;
    error_page 500 @500;
    error_page 502 @502;
    error_page 503 @503;
    error_page 504 @504;

    location @404 {
        rewrite ^ /static/404.html;
    }
    location @500 {
        rewrite ^ /static/500.html;
    }
    location @502 {
        rewrite ^ /static/502.html;
    }
    location @503 {
        rewrite ^ /static/503.html;
    }
    location @504 {
        rewrite ^ /static/504.html;
    }

    location /static {
        alias /home/dotcloud/current/static;
    }

    location /robots.txt {
        alias /home/dotcloud/current/static/robots.txt;
    }

    location /favicon.ico {
        alias /home/dotcloud/current/static/favicon.ico;
    }

  }
} 
```

**gunicorn.conf**

```
workers = 1
worker_class = 'socketio.sgunicorn.GeventSocketIOWorker'
pidfile = '/tmp/gunicorn.pid'
debug = True
loglevel = 'debug'
errorlog = '/var/log/supervisor/gunicorn.log'
django_settings='/home/dotcloud/settings.py'

def post_fork(server, worker):
    from psycogreen.gevent import patch_psycopg
    patch_psycopg()

# MySQL
#def post_fork(server, worker):
#    import pymysql
#    pymysql.install_as_MySQLdb() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-12T13:42:19.140

我在上面问了 5 个相关问题，我将在这里尝试回答前 3 个问题。（我对 dotcloud 基础的了解不足以回答最后两个问题）。我还希望大多数人发现这个问题主要集中在带有 gunicorn 和 nginx 的 websockets 上（而不是 dotcloud 细节）。对于这些人，您可以在此处跳转到参考设置：[gunicorn deployment scheme with nginx](http://docs.gunicorn.org/en/19.3/deploy.html)

> 1.  我是否试图解决一个非问题？
>     
>     
>     
>     一个。我已经阅读了大量建议将 gunicorn 放在 nginx 后面的内容。在 dotcloud 的负载均衡器在一线的背景下，这仍然是真的吗？
>     
>     
>     
>     湾。如果我不希望我会受到 DoS 攻击，那么将 gunicorn 放在 nginx 后面仍然很重要吗？

从上面 Ken Cochrane 的评论来看，我相信 dotcloud 基础设施本身提供了 nginx 通常在 DIY 设置中提供的安全性。因此，在这种特殊情况下，这确实是一个“不成问题”。但是，一般来说，您确实希望在 nginx 后面使用 gunicorn，并且您绝对可以使用该设置运行 websockets。

> 2.  是否可以像我尝试设置的那样通过 unix 套接字运行 websockets？

是的。[这是关于使用 nginx](http://docs.gunicorn.org/en/19.3/deploy.html)的 gunicorn 部署方案的一个很好的参考。对于 websockets，请务必阅读整个部分并包括`proxy_buffering off;`

> 3.  unix 套接字会破坏 dotcloud 上的缩放吗？

我的理解是套接字和端口都应该同样好用。

# c# - Unity：如何注入具有两个接口的单例，其中一种类型映射需要命名？

> ID：15297187
> 
> 赞同：0
> 
> 时间：2013-03-08T15:14:00.587
> 
> 标签：c#, dependency-injection, unity-container

我的问题是对此的一个变体：[Unity 将两个接口注册为一个单例](https://stackoverflow.com/questions/1394650/unity-register-two-interfaces-as-one-singleton)

在我的例子中，注入的单例组件有两个接口，但其中一个接口用于映射多个命名的具体类型。

例如，我的组件需要一组（命名的）IEventSources 和一个 IEventManager（它本身也是一个 IEventSource）作为依赖项：

```
 public interface IEventManager { }

  public interface IEventSource { }

  public class EventManager : IEventManager, IEventSource { }

  public class EventSourceA : IEventSource { }

  public class EventSourceB : IEventSource { }

  public class Component
  {
    public Component(IEventManager eventManager, IEventSource[] eventSources)
    {
      Debug.Assert(eventSources.Contains((IEventSource) eventManager));
    }
  }

  class Program
  {
    static void Main()
    {
      var container = new UnityContainer();
      container.RegisterType<IEventManager, EventManager>(new ContainerControlledLifetimeManager());
      container.RegisterType<IEventSource, EventManager>("EventManager", new ContainerControlledLifetimeManager());
      container.RegisterType<IEventSource, EventSourceA>("EventSourceA");
      container.RegisterType<IEventSource, EventSourceB>("EventSourceB");
      container.RegisterType(typeof(Component));

      container.Resolve<Component>();
    }
  } 
```

或者，因为我最终需要从 app.config 进行配置：

```
 <unity xmlns="http://schemas.microsoft.com/practices/2010/unity">
    <container>
      <register type="IEventManager" mapTo="EventManager">
        <lifetime type="singleton" />
      </register>
      <register name="EventManager" type="IEventSource" mapTo="EventManager">
        <lifetime type="singleton" />
      </register>
      <register name="EventSourceA" type="IEventSource" mapTo="EventSourceA" />
      <register name="EventSourceB" type="IEventSource" mapTo="EventSourceB" />
      <register type="Component" />
    </container>
  </unity> 
```

这里创建了两个 EventManager 实例，断言失败。我想确保同一个实例满足两个组件依赖项。

我可以让组件只接受 IEventSource 实例，并在运行时从该集合中拉出单个 IEventManager 实例，但这对我来说似乎很脆弱并且闻起来很糟糕。有没有办法用 Unity 解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:40:56.957

如果您在 Main 中更改您的注册码，如下所示，您断言将通过。够了吗？

```
 var container = new UnityContainer();

        var manager = container.Resolve<EventManager>();
        container.RegisterInstance<IEventManager>(manager, new ContainerControlledLifetimeManager());
        container.RegisterInstance<IEventSource>("EventManager", manager, new ContainerControlledLifetimeManager());

        container.RegisterType<IEventSource, EventSourceA>("EventSourceA");
        container.RegisterType<IEventSource, EventSourceB>("EventSourceB");
        container.RegisterType(typeof(Component));

        container.Resolve<Component>(); 
```

# python - 远程运行 python 脚本的更好方法

> ID：15297189
> 
> 赞同：4
> 
> 时间：2013-03-08T15:14:16.000
> 
> 标签：python, ssh

我在远程机器上有一个 python 脚本，我想从我的本地机器上执行它。它需要一些参数，如果我要在那台机器上运行它，这就是我将如何运行它。

```
python python_parallel.py --num=10 --ssh=/home/user1/path/file.txt 
```

目前，我的本地机器中有一个运行上述脚本的 python 代码：

```
from optparse import OptionParser
parser.add_option("-n", "--num", type="int", dest="num_spice",help="Enter the number")
parser.add_option("-s", "--ssh", dest="ssh_txt",help="Enter the path to the text file")
num_spice=options.num_spice
ssh_txt=options.ssh_txt

(options, args) = parser.parse_args()

os.system('ssh user1@10.100.10.201 python /home/user1/path/python_parallel.py --num=%s --ssh=%s' %(num_spice, ssh_txt) ) 
```

有没有更好的方法来做到这一点？[我在此链接](https://stackoverflow.com/questions/8783009/how-to-execute-a-script-remotely-in-python-using-ssh)上尝试了解决方案，但它给了我一个错误“ImportError：没有名为 ssh 的模块”

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T15:22:32.003

我建议你看一下[铅锤](https://pypi.python.org/pypi/plumbum)模块来做这样的事情。

这是运行本地命令的一种非常酷且简单的方法，您可以很容易地使用远程命令（使用上下文管理器）执行相同操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:49:48.207

你考虑过使用[Fabric](http://docs.fabfile.org/en/1.6/)吗？它真的很容易使用。

# c++ - 为什么这段代码没有缩窄转换，导致报错？

> ID：15297191
> 
> 赞同：5
> 
> 时间：2013-03-08T15:14:21.107
> 
> 标签：c++, c++11

`g++`with`-std=c++11`似乎接受它：

```
#include <vector>
#include <initializer_list>

std::vector<float> vf={1,2,3}; // Isn't this narrowing (i.e., an error)?

int main() {} 
```

似乎带有注释的行应该出错，但事实并非如此。

**更新**

感谢 Jesse 指出了定义为什么这样的标准（8.5.4 p7）。以下是一些示例代码，有助于阐明标准定义的行为：

```
const int v5=5;
int v6=6;

vector<double> vd1={1,2,3,4};       // OK
vector<double> vd2={1,2,3,4,v5};    // Still OK, v5 is const
vector<double> vd3={1,2,3,4,v5,v6}; // Error, narrowing conversion, because v6 
                                    // is non-const
vector<double> vd4={1,2,3,4,v5,static_cast<const int>(v6)}; // Also errors on 
                                    // gcc 4.7.2, not sure why. 
```

我希望我刚刚介绍的示例将帮助其他人在使用初始化列表时克服一些狭窄的问题。

如果有人知道为什么最后一个案例违反了标准定义，请发表评论。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T15:18:51.010

规则在 8.5.4 p7 中，不包括您的示例

> 从整数类型或无作用域枚举类型到浮点类型，*除非源是常量表达式并且转换后的实际值将适合目标类型并且在转换回原始类型时将产生原始值*，或…

^(（强调我的）)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-08T15:18:09.713

我不明白为什么这会出错，因为所有三个整数都可以精确表示为`float`.

也就是说，`g++`如果我包含一个不适合 a 的常量，我可以给我一个警告`float`：

```
warning: narrowing conversion of '2112112112' from 'int' to 'float' inside { } [-Wnarrowing] 
```

# c# - 创建多级 MemberExpression

> ID：15297192
> 
> 赞同：3
> 
> 时间：2013-03-08T15:14:30.720
> 
> 标签：c#, linq

我知道如何创建一个`MemberExpression`例如`entity.Property`

```
// Expression: "entity"
var parameter = Expression.Parameter(entityType, "entity");

// Expression: "entity.Property"
var property = Expression.MakeMemberAccess(parameter, entityType.GetProperty(propertyName)); 
```

但我想创建一个`MemberExpression`访问子属性的，例如`entity.Property.SubProperty`

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:33:16.120

```
 var parameter = Expression.Parameter(entityType, "entity");

   // Expression: "entity.Property"
   var property = Expression.Property(parameter, propertyName);
   var subProperty = Expression.Property(property, subPropertyName); 
```

# jsf-2 - primefaces 3.5 fileuploauder 表单在其他表单中不起作用

> ID：15297194
> 
> 赞同：0
> 
> 时间：2013-03-08T15:14:36.083
> 
> 标签：jsf-2, primefaces

在这种情况下，它工作正常，上传文件没有问题（在我编辑 web.xml 添加过滤器和 faces-confing 添加依赖项之前）：

```
<h:form id="form1">
    <p:messages id="messages" showDetail="true" autoUpdate="true" />
    <p:panel header="Iniciar sesión" style="width:300px;height:150px;">

        <h:panelGrid columns="2" id="matchGrid">
            <h:outputLabel for="pwd1" value="Usuario: *" />
            <p:inputText id="pwd1" value="#{loginMB.usuario}" label="usuario"
                required="true" />

            <h:outputLabel for="pwd2" value="Clave: *" />
            <p:password id="pwd2" value="#{loginMB.clave}" label="clave"
                required="true" />
        </h:panelGrid>

        <p:commandButton id="saveButton" action="#{loginMB.login}"
            update="matchGrid" value="Entrar" />
    </p:panel>
</h:form>

<h:form enctype="multipart/form-data">

    <p:messages showDetail="true" />

    <p:fileUpload value="#{contratosMB.fileContrato}" mode="simple" />

    <p:commandButton value="Submit" ajax="false"
        actionListener="#{contratosMB.upload}" />

</h:form> 
```

但是当我把它放在另一个表单中时它不起作用，为什么？

```
<h:form id="form3sd">
    <h:form id="form1">
        <p:messages id="messages" showDetail="true" autoUpdate="true" />
        <p:panel header="Iniciar sesión" style="width:300px;height:150px;">

            <h:panelGrid columns="2" id="matchGrid">
                <h:outputLabel for="pwd1" value="Usuario: *" />
                <p:inputText id="pwd1" value="#{loginMB.usuario}" label="usuario"
                    required="true" />

                <h:outputLabel for="pwd2" value="Clave: *" />
                <p:password id="pwd2" value="#{loginMB.clave}" label="clave"
                    required="true" />
            </h:panelGrid>

            <p:commandButton id="saveButton" action="#{loginMB.login}"
                update="matchGrid" value="Entrar" />
        </p:panel>
    </h:form>

    <h:form enctype="multipart/form-data">

        <p:messages showDetail="true" />

        <p:fileUpload value="#{contratosMB.fileContrato}" mode="simple" />

        <p:commandButton value="Submit" ajax="false"
            actionListener="#{contratosMB.upload}" />

    </h:form>
</h:form> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:04:51.143

您不能在 JSF 中嵌套表单。在 HTML 中这样做是无效的，因此在 JSF 中是无效的，因为它被转换为 HTML。

无论您是否删除“主”表单，您都没有内部表单，并且您的站点上有 2 个表单。

### 也可以看看

*   [如何在 JSF 页面中使用 <h:form>？单一形式？多种形式？嵌套表格？](https://stackoverflow.com/q/7371903/686036)，尤其是这个[答案](https://stackoverflow.com/a/7372315/686036)很好地解释了它

# sqlite - CentOS 6.3 上的 SQLite 写入性能比 MacOSX 10.8.2 慢约 10 倍

> ID：15297195
> 
> 赞同：1
> 
> 时间：2013-03-08T15:14:48.997
> 
> 标签：sqlite, centos, ext3

摘要：与 MacOSX 10.8.2 相比，CentOS 6.3 上的插入/删除/更新事务花费的时间是 MacOSX 10.8.2 的 10-15 倍

我正在使用 Perl (DBD::SQLite 1.37) 中的 SQLite (3.7.12)。我的应用程序有很多地方在事务中进行多次写入（删除、更新和插入）。

我一直在比较 3 台机器之间的时间：

*   MBP：2010 MacBook Pro 带普通磁盘
*   MBA：2011 年配备 SSD 的 MacBook Air
*   CentOS 6.3 服务器（AMD Opteron 3250，1TB 软件 RAID，4 核，8GB RAM）

与 MBP 和 MBA 相比，CentOS 服务器上的事务花费大约 10 到 15 倍的时间。正如预期的那样，MBA 更快一些，因为它有一个 SSD。如果我关闭 pragma 同步，它就像预期的那样又好又快。

我们每次都运行完全相同的测试序列，并最终得到相同的数据库。在测试运行时，CentOS 机器上几乎没有其他（值得注意的）运行。

以低级磁盘写入性能为基准，CentOS 机器优于其他机器。我接下来应该看哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:59:55.667

我会开始减少依赖。

尝试[在内存数据库](http://www.sqlite.org/inmemorydb.html)上运行测试。

尝试在直接 C 中运行它，以确保它不是 perl。我有点怀疑，但应该很容易模拟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T23:56:34.153

这个问题原来是在 /etc/fstab 中配置 ext3 文件系统的方式。

我最终做了很多实验和性能测试以更好地理解这一点，我在服务器故障上写道：

> [https://serverfault.com/questions/486677/should-we-mount-with-data-writeback-and-barrier-0-on-ext3](https://serverfault.com/questions/486677/should-we-mount-with-data-writeback-and-barrier-0-on-ext3)

总之，文件系统是用**barrier=1**挂载的；将其更改为**barrier=0**，并结合**data=ordered**，恢复了我们“缺失”的性能。

# c# - 多个属性的搜索条件c#

> ID：15297197
> 
> 赞同：2
> 
> 时间：2013-03-08T15:14:55.400
> 
> 标签：c#, .net

我想对多个属性执行搜索条件，但是我遇到了问题。如果某些属性为空或不属于搜索条件的 null，请帮助我..这是以下代码：

```
public List<AccountDto> getSearchedAccount(int accountid,int userid,String holdername,String type,double balance,String status)
{
    List<AccountDto> results = new List<AccountDto>();
    for (int i = 0; i < list.Count; i++)
    {
        AccountDto dto = (AccountDto)list[i];
        if ((dto.Accountid == accountid) && (dto.Userid==userid) && (dto.Holdername.Equals(holdername)) && (dto.Balance == balance) && (dto.Status.Equals(status)) )
        {
            results.Add(dto);
        }

    }

    return results;
} 
```

请告诉我正确的 if 语句是否某些字段为空或空，而这些字段不在搜索条件中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:21:33.237

它会是这样的：

```
 if (accountid < 0 || dto.Accountid == accountid) 
     && ... 
     && (string.IsNullOrEmpty(holdername) || dto.Holdername.Equals(holdername)) 
     && ... )
    {
        results.Add(dto);
    } 
```

如果未设置值或比较很重要，则为每个条件引入一个或。例如，如果 holdername 为 null 或为空，则不会评估 Holdername 的 Equals。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T15:22:23.510

你为什么不为此创建一个方法？在该方法中，您可以检查属性是否为`null`空或其他任何内容。

```
private bool CheckAccount(AccountDto dto, int accountid, int userid, String holdername, string type, double balance, String status){
 bool isTrue = true;
 ...
 if(holdername != null){
    if(!dto.Holdername.Equals(holdername))
          return false;
 }
 ...
 return true; //all properties are true
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T17:10:39.830

```
/*** Answer with the comments in code ***/ 
// don't create a class to represent your criteria
// Dictionary is enough for use and supported by Linq
// don't use a lot of `&&` or `if`; one `if` is enough
// all the rules is in deferred execution, only executes when it really needs 
// evaluated and the order to put where clauses matters, don't make it changed
// it performs like short-circuit evaluation

/// <summary>
/// declared as partial for easily coexists with original code
/// if not used(e.g already declared) then not paste to file
/// </summary>
partial class AccountDto /* known members */ {
    public int Accountid;
    public int Userid;
    public String Holdername;
    public int Balance;
    public String Status;
}

/// <summary>
/// declared as partial for easily coexists with original code
/// if getSearchedAccount is declared with another class name
/// then just rename the partial class to that name and remove 
/// all `static`(if that class is non-static) 
/// the class initializer, then become constructor; remember to 
/// match the name of class and constructor
/// </summary>
partial class AccountDto {
    /// <summary>
    /// declare as static for this demo; 
    /// not necessarily be static if it's declared in another 
    /// class where list is declared
    /// </summary>
    public static List<AccountDto> getSearchedAccount(
        int accountid, int userid,
        String holdername, String type,
        double balance,
        String status
        ) {
        var results=new List<AccountDto>();

        // make a copy of IgnoreRules and clear; equivalent to 
        // var matchRules=new Dictionary<String, Func<AccountDto, bool>>();
        // IgnoreRules is not changed with these two statement
        // just prevent to see too many angle braces
        var matchRules=IgnoreRules.ToDictionary(x => x.Key, x => x.Value);
        matchRules.Clear();

        // the parameters only known in this method thus can only added here
        matchRules.Add("accountid", x => accountid==x.Accountid);
        matchRules.Add("userid", x => userid==x.Userid);
        matchRules.Add("holdername", x => holdername==x.Holdername);
        matchRules.Add("balance", x => balance==x.Balance);
        matchRules.Add("status", x => status==x.Status);

        for(int i=0; i<list.Count; i++) {
            var dto=(AccountDto)list[i];

            if((from ignoreRule in IgnoreRules
                from matchRule in matchRules
                where ignoreRule.Key==matchRule.Key
                where !ignoreRule.Value(dto)
                select matchRule.Value(dto)).All(x => x))
                results.Add(dto);
        }

        return results;
    }

    /// <summary>
    /// criteria for `don't test for matching`
    /// </summary>
    public static Dictionary<String, Func<AccountDto, bool>> IgnoreRules {
        get;
        set;
    }

    /// <summary>
    /// use class initializer to add common IgnoreRules
    /// </summary>
    static AccountDto() {
        IgnoreRules=new Dictionary<String, Func<AccountDto, bool>>();
        IgnoreRules.Add("accountid", x => 0==x.Accountid);
        IgnoreRules.Add("userid", x => 0==x.Userid);
        IgnoreRules.Add("holdername", x => String.IsNullOrEmpty(x.Holdername));
        IgnoreRules.Add("balance", x => 0==x.Balance);
        IgnoreRules.Add("status", x => String.IsNullOrEmpty(x.Status));
    }

    /// <summary>
    /// declare as static for this demo; 
    /// not necessarily be static if it's declared in another 
    /// class where getSearchedAccount is declared
    /// </summary>
    public static List<AccountDto> list=new List<AccountDto>();
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T15:22:32.607

我认为这可能是您正在寻找的：[C# Coalesce](http://onlytalkingsense.wordpress.com/2006/07/07/coalesce-goes-c/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T15:30:55.693

您可以在搜索条件中构建聚合过滤器。我认为下面的帖子与您正在寻找的内容相同。[尝试这个](https://stackoverflow.com/questions/13293511/how-to-ignore-null-properties-in-the-search-criteria)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T15:46:09.813

我可能会检查*default(type)*和*string.IsNullOrEmpty(...)*

所以你可以有：

```
public List<AccountDto> getSearchedAccount(int accountid, int userid, string holdername, string type, double balance, string status)
{
    var results = new List<AccountDto>();

    for (int i = 0; i < list.Count; i++)
    {
        AccountDto dto = (AccountDto)list[i];

        if (accountid != default(int) && accountid != dto.Accountid)
            continue;
        if (userid != default(int) && userid != dto.Userid)
            continue;
        if (!string.IsNullOrEmpty(holdername) && !holdername.Equals(dto.Holdername))
            continue;
        if (!string.IsNullOrEmpty(type) && !type.Equals(dto.Type))
            continue;
        if (balance != default(double) && balance != dto.Balance)
            continue;
        if (!string.IsNullOrEmpty(status) && !status.Equals(dto.Status))
            continue;

        results.Add(dto);
    }

    return results;
} 
```

或者使用表达式树

```
public List<AccountDto> getSearchedAccount(int accountid, int userid, string holdername, string type, double balance, string status)
{
    IQueryable<AccountDto> query = list.AsQueryable();

    if (accountid != default(int))
        query = query.Where(i => i.Accountid.Equals(accountid));
    if (userid != default(int))
        query = query.Where(i => i.Userid.Equals(userid));
    if (!string.IsNullOrEmpty(holdername))
        query = query.Where(i => i.Holdername.Equals(holdername));
    if (!string.IsNullOrEmpty(holdername))
        query = query.Where(i => i.Type.Equals(type));
    if (balance != default(double))
        query = query.Where(i => i.Balance.Equals(balance));
    if (!string.IsNullOrEmpty(holdername))
        query = query.Where(i => i.Status.Equals(status));

    return query.Select(i => i).ToList<AccountDto>();
} 
```

几个想法

*   我确定您的意思是使用小数来表示货币价值而不是双倍。
*   创建一个对象来表示您的标准，这样您就不必在每次决定添加新字段时更改方法签名

    公共列表 getSearchedAccount(AccountSearchCritera 条件) { ... }

# eclipse - System.out.println 不在 Eclipse 控制台中打印任何内容

> ID：15297198
> 
> 赞同：2
> 
> 时间：2013-03-08T15:15:00.057
> 
> 标签：eclipse

晚上好，我遇到了一个奇怪的问题，我尝试在我的 servlet 中打印一些东西，`System.out.println();` 但控制台中没有任何内容，尽管控制台首选项窗口中的所有复选框都已选中！以前有人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:31:34.440

通过单击控制台视图中控制台图标旁边的小向下箭头，检查您是否正在查看正确的控制台。在那里，您将拥有工作区的所有控制台，请务必选择正确的控制台（通常是您的 webapp 服务器的控制台）。

# java - JPA如何在双向ManyToOne中保持父级

> ID：15297200
> 
> 赞同：0
> 
> 时间：2013-03-08T15:15:06.313
> 
> 标签：java, hibernate, jpa

我有与帐户具有双向多对一关系的付款实体。

```
@Table(name="account")
public class Account implements Serializable { 

    //bi-directional many-to-one association to Payment
    @OneToMany(mappedBy="account",fetch=FetchType.EAGER)
    private List<Payment> payments;

@Table(name="payment")
public class Payment implements Serializable { 

    //bi-directional many-to-one association to Account
    @ManyToOne(cascade={CascadeType.MERGE},fetch=FetchType.EAGER)
    @JoinColumn(name="idAcc")
    private Account account; 
```

帐户实体已保留。我在浏览器和数据库中看到了相关信息：

> 账户 [idAcc=475, 账户=12345678901230, isLock=N, rest=10000.5]

然后我需要坚持孩子（支付实体）并同时更改帐户实体（更改帐户休息）。我使用此代码。

```
 public class GenericDaoImpl<T> implements GenericDao<T> {

        protected Class<T> type; 
        protected EntityManagerFactory emf = null;

        public GenericDaoImpl(Class<T> type, EntityManagerFactory emf) { 
            this.emf = emf;
            this.type = type;       
        } 

        @Override
        public void create(T entity) throws Exception { 
            EntityManager em = null; 
            try { 
                em = getEntityManager();
                em.getTransaction().begin();  
                em.persist(entity); 
                em.getTransaction().commit(); 
            } 
...
@Override
    public T findById(String id) {
         EntityManager em = getEntityManager();
            try {
                Query query = em.createNamedQuery(type.getSimpleName()+".findByName");
                query.setParameter("id", id);
                return (T)query.getSingleResult();
            } finally {
                em.close();
            }
    } 
```

和

```
daoPayments = new GenericDaoImpl(Payment.class,factory); 
            Payment payment = null;
                try {
                    payment = new Payment();
                    payment.setDescription("Shop 'Pirasmani'");
                    payment.setSumm(50.25);
                        Account account = (Account)daoAccount.findById(listAccount.get(0).getIdAcc());
                        account.setRest(account.getRest()-payment.getSumm());
                        payment.setAccount(account);
                        account.getPayments().add(payment);

                    daoPayments.create(payment);
                    //print result 
                    Payment paymentMerged = (Payment)daoPayments.read(payment);
                    out.println(paymentMerged.toString()+"<br>"); 
```

然后我在浏览器中看到帐户余额已更改：

> 付款 [idPmnt=91, description=Shop 'Pirasmani', summ=50.25, account=Account [idAcc=475, account=12345678901230, isLock=N, rest=9950.25]]

但是在数据库中，帐户休息没有变化。它的钢是=10000.5。我究竟做错了什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:39:05.450

您不应该在 DAO 方法中启动和停止事务。最后一节中的所有代码都应该在一个事务中，这样您就可以

*   处理附加实体，并自动保留对帐户所做的所有更改
*   `cascade={CascadeType.MERGE}`删除关联上不必要的
*   让数据库保持连贯状态，而不是像现在这样处于付款已创建但其余部分未减少的状态（这就是我们首先使用交易的原因）。

也就是说，您坚持付款。为什么这会导致对其帐户的任何修改？您拥有的唯一级联是 MERGE，并且您没有在代码中进行任何合并。

# asp.net - ASP.Net 中使用表单身份验证的 Web 服务器权限

> ID：15297201
> 
> 赞同：1
> 
> 时间：2013-03-08T15:15:06.703
> 
> 标签：asp.net, forms-authentication, security

我正在通过 WebMatrix.WebData.WebSecurity 使用 Forms Authentification 运行 asp.net 应用程序。

一旦通过身份验证，当前线程主体就是我的表单身份验证用户。访问 Web 服务器上的文件时，主体没有特定帐户，也不属于任何组，因此默认为“所有人”用户。

我正在使用的第三方报告引擎需要根虚拟目录的执行权限。我不想将执行权限授予“所有人”组。

我正在寻找一种允许经过身份验证的用户访问应用程序池上下文下的文件的配置。我该如何配置？

我的主机只允许我为两个用户“ASP.Net”（应用程序池）和每个人配置文件安全。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T11:56:27.123

问题是由我们的第 3 方报告引擎引起的。引擎在运行时动态编译 dll，然后调用 CodeDomProvider.CompileAssemblyFromSource([...])。据我所知，这是导致问题的原因。

第 3 方提供编译为 dll 并将其作为参考的选项。我们使用了那个解决方案。

# python - numpy.loadtxt 的分析结果差异

> ID：15297206
> 
> 赞同：4
> 
> 时间：2013-03-08T15:15:18.720
> 
> 标签：python, numpy

我试图理解为什么`numpy.loadtxt`在函数中使用和独立使用时我会得到非常不同的分析/计时数字。

# 设置要读取/配置文件的数据

*   1个26列1000行的文件，文件中的每一项都是随机浮点数
*   文件是空格分隔的
*   文件中的第一行是一个空格分隔的标题，有 26 个列名
*   有关如何生成此数据的代码，请参见下文

## 单独分析 numpy.loadtxt

假设我有一个名为“test.out”的文件，具有上述属性：

```
>>> f = open('test.out', 'r');f.readline()
'a b c d e f g h i j k l m n o p q r s t u v w x y z\n'
>>> %timeit -n 1 np.loadtxt(f, unpack=True)
1 loops, best of 3: 30 us per loop 
```

## 在函数内部分析 numpy.loadtxt

现在我想`numpy.loadtxt`分析一个函数内部（使用line_profiler）和`%lrpun`ipython中的魔法：

```
>>> %lprun -f file_to_numpy_ordered_dict file_to_numpy_ordered_dict('test.out')
Timer unit: 1e-06 s

Function: file_to_numpy_ordered_dict at line 88
Total time: 0.085642 s

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    88                                           def file_to_numpy_ordered_dict(filename):
    89                                               """
    90                                               Read a space-separated-value file as a dict of columns, keyed by
    91                                               column header where each column (dict value) is a numpy array.
    92                                               """
    93                                           
    94         1          430    430.0      0.5      with open(filename, 'r') as file_obj:
    95         1          363    363.0      0.4          headers = file_obj.readline().split()
    96                                           
    97                                                   # unpack=True b/c want data organized as column based arrays, not rows
    98         1        84634  84634.0     98.8          arrs = np.loadtxt(file_obj, unpack=True)
    99                                           
   100         1           66     66.0      0.1      ret_dict = collections.OrderedDict()
   101        27           34      1.3      0.0      for ii, colname in enumerate(headers):
   102        26          114      4.4      0.1          ret_dict[colname] = arrs[ii]
   103                                           
   104         1            1      1.0      0.0      return ret_dict 
```

## 为什么？

为什么单独调用 numpy.loadtxt 只需要 30us 而在这个函数中调用它大约需要 0.085 秒？我觉得我在这里遗漏了一些明显的东西，但看起来函数在每个场景中被调用的参数完全相同，等等。

这是因为我正在使用`%timeit`和而产生的一些奇怪的区别`%lprun`吗？也许由于某种原因无法比较这些数据？

## 随机数据创建的详细信息

*   使用以下代码生成文件数据： def generate_test_data(column_names, row_count, filename): """ 生成大小为 (row_count, len(column_names)) 的随机测试数据文件

    ```
    column_names - List of column name strings to use as header row
    row_count - Number of rows of data to generate
    filename - Name of file to write test data to
    """

    col_count = len(column_names)
    rand_arr = np.random.rand(row_count, col_count)
    header_line = ' '.join(column_names)
    np.savetxt(filename, rand_arr, delimiter=' ', fmt='%1.5f',
                  header=header_line, comments='') 
    ```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T17:01:10.933

仅供参考，这个问题的“答案”与我**如何**`numpy.loadtxt`进行分析有关，而不是在函数中对变慢或变快的实际调用。

1.  请注意以下参数`%timeit`：

    -n：循环执行给定语句的次数。如果未给出该值，则选择拟合值。

    -r：重复循环迭代次数并取最佳结果。默认值：3

请注意，我指定`-n 1`强制`%timeit`只运行`numpy.loadtxt`代码 1 次。然而，`-n 1`这还不够。您还必须指定`-r 1`强制代码的评估只发生**一次**。

所以，我的电话`%timeit`有效地评估了`numpy.loadtxt`3 次电话。第一次调用实际上会读取所有文件并占用总运行时间的大部分。接下来的两个调用将没有数据要读取，因为传递给的文件句柄`numpy.loadtxt`没有数据要读取。因此，三分之二的电话没有任何**实际**工作要做，几乎**不花时间**。

1.  小心报告的时间是什么`%timeit`意思。

`%timeit`请注意作为其输出的一部分报告的调用，1 个循环，**最好的 3**：每个循环 30 us。由于我的三个电话中的两个有效地没有工作，这两个电话之一将是**最好的 3**。

因此，通过比较我的原始调用`%timeit`，`%lprun`我有效地比较了`numpy.loadtxt`查看空/已完成文件句柄所需的时间以及`numpy.loadtxt`真正打开和读取完整 208k 数据所需的时间。

当使用正确的论点`%timeit`更有意义时，真正的时间安排：

```
>>> f = open('test.out', 'r');f.readline()
'a b c d e f g h i j k l m n o p q r s t u v w x y z\n'
>>> %timeit -n 1 -r 1 np.loadtxt(f, unpack=True)
1 loops, best of 1: 31.1 ms per loop

Function: file_to_numpy_ordered_dict at line 88
Total time: 0.083706 s

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    88                                           def file_to_numpy_ordered_dict(filename):
    89                                               """
    90                                               Read a space-separated-value file as a dict of columns, keyed by
    91                                               column header where each column (dict value) is a numpy array.
    92                                               """
    93                                           
    94         1          583    583.0      0.7      with open(filename, 'r') as file_obj:
    95         1          313    313.0      0.4          headers = file_obj.readline().split()
    96                                           
    97                                                   # unpack=True b/c want data organized as column based arrays, not rows
    98         1        82417  82417.0     98.5          arrs = np.loadtxt(file_obj, unpack=True)
    99                                           
   100         1          226    226.0      0.3      ret_dict = collections.OrderedDict()
   101        27           35      1.3      0.0      for ii, colname in enumerate(headers):
   102        26          131      5.0      0.2          ret_dict[colname] = arrs[ii]
   103                                           
   104         1            1      1.0      0.0      return ret_dict 
```

**31 毫秒与 83 毫秒**更有意义。这些数字足够接近，我假设差异仅仅是因为我只运行了一次这种相对快速的操作。为了有效地比较这些，最好取一堆运行的平均值。

# android - 如何在没有 ListView 的情况下为 Android 实现文件资源管理器

> ID：15297208
> 
> 赞同：1
> 
> 时间：2013-03-08T15:15:22.587
> 
> 标签：android, file, listview, explorer

我将在 Android 上开发我的文件资源管理器。

在大多数示例和教程中，它是通过 ListView 完成的。

我的问题是：

是否可以在没有 ListView 的情况下查看文件？可能有更专业的方法来做到这一点。

我的文件浏览器应该简单但功能齐全。功能是滚动，上下文菜单，多选支持......

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T17:21:19.530

您可以不使用 ListView 以任何方式进行操作：

*   您可以设置网格布局并使用表示目录和文件的图标图块
*   你可以让它看起来像 Linux 终端并用简单的文本打印所有内容
*   您可以制作 90 年代初黑客电影中的 3D 环境，并将您的文件系统可视化为未来城市
*   您可以创建 SurfaceView 或 ImageView 并使用 Canvas 在其上绘制所有内容
*   等等

# c# - 将参数从 Silverlight 中的 xaml 传递给构造函数

> ID：15297213
> 
> 赞同：3
> 
> 时间：2013-03-08T15:15:42.823
> 
> 标签：c#, silverlight

我从启用 Silverlight 的 WCF 服务获取数据并将其绑定到 DataGrid ItemSource。但是我的 ViewModel 的构造函数正在获取一个参数。我正在使用 MVVM。我想将参数从 xaml 传递给构造函数。我必须在这里添加什么？这是我在 xaml 中设置页面的 DataContext 的部分。

```
<navigation:Page.DataContext>
    <vms:StudentViewModel />
</navigation:Page.DataContext> 
```

这是类的构造函数：

```
 public StudentViewModel(string type)
    {
        PopulateStudents(type);
    } 
```

另外，这是错误：

> 类型“StudentViewModel”不能用作对象元素，因为它不是公共的或未定义公共无参数构造函数或类型转换器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:36:07.480

如错误消息所示，您只能`WPF`使用默认的无参数构造函数来实例化对象。所以你最好的选择是制作'Type' a`DependencyProperty`并为其设置绑定，然后在设置时调用你的`PopulateStudents()`方法。

```
public class StudentViewModel : DependencyObject
{
    // Parameterless constructor
    public StudentViewModel()
    {
    }

    // StudentType Dependency Property
    public string StudentType
    {
        get { return (string)GetValue(StudentTypeProperty); }
        set { SetValue(StudentTypeProperty, value); }
    }

    public static readonly DependencyProperty StudentTypeProperty =
        DependencyProperty.Register("StudentType", typeof(string), typeof(StudentViewModel), new PropertyMetadata("DefaultType", StudentTypeChanged));

    // When type changes then populate students
    private static void StudentTypeChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var studentVm = d as StudentViewModel;
        if (d == null) return;

        studentVm.PopulateStudents();
    }

    public void PopulateStudents()
    {
        // Do stuff
    }

    // Other class stuff...
} 
```

Xaml

```
<navigation:Page.DataContext>
    <vms:StudentViewModel StudentType="{Binding YourBindingValueHere}" />
</navigation:Page.DataContext> 
```

# javascript - 如何在 2 列中显示文本

> ID：15297214
> 
> 赞同：0
> 
> 时间：2013-03-08T15:15:44.337
> 
> 标签：javascript, jquery, html

我在 ModX CMS 中使用 TinyMCE。

您知道如何在 2 列中显示所见即所得的文本，如果可能的话，库伦的高度应该相同，宽度必须相同。

没有使用 TinyMCE 插入表格的选项（按钮）。

1 选项是单击 html 图标并创建具有 2 列的表格，但管理内容的人将无法执行此操作。

我认为它可能是 JavaScript，也许是 jQuery。但是我将如何计算文本并将其拆分在正确的位置。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:34:44.460

您可以使用以下内容放置外部按钮：

```
<button onclick="tinyMCE.activeEditor.execCommand('mceInsertContent',false,'<table><tr><td>TEXT</td><td>TEXT</td></tr></table>');return false;">Insert table</button> 
```

这将在光标位置插入代码。您也可以在这里查看更多信息：

[TinyMCE 命令标识符](http://www.tinymce.com/wiki.php/Command_identifiers)

# sql - SQL - 多个注册条件查询

> ID：15297216
> 
> 赞同：3
> 
> 时间：2013-03-08T15:15:47.080
> 
> 标签：sql, ms-access

我有以下表结构：

```
ID       COMPANY       PROJECT      ACTIVITY     TYPE
1        A             1            A1.1         NORMAL
2        A             1            A1.2         NORMAL
3        A             1            A1.3         NORMAL
4        A             2            A2.1         DUMMY
5        A             2            A2.2         DUMMY
6        A             2            A2.3         DUMMY
7        A             3            A3.1         NORMAL
8        A             3            A3.2         DUMMY
9        A             3            A3.3         NORMAL 
```

我的目标是检索所有活动（在组合公司 x 项目内）都是虚拟的公司和项目。

我写了下面的SQL：

```
SELECT COMPANY, PROJECT
FROM TABLE
GROUP BY COMPANY, PROJECT
HAVING TYPE = 'DUMMY' 
```

但是它不仅带来了 Company A 和 Project 2（这是唯一满足我条件的），还带来了 Company 3 Project 3（只有一个 DUMMY 类型）。

你们能帮我修正一下声明吗？

谢谢！！！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:17:20.530

你离成功很近了。利用`MAX`和`MIN`功能。

```
SELECT  COMPANY, PROJECT
FROM    TABLE
GROUP   BY COMPANY, PROJECT
HAVING  MAX(TYPE) = MIN(TYPE) AND
        MAX(TYPE) = 'DUMMY' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:55:06.277

You can use an `EXISTS` statement to get the answer you're looking for:

```
SELECT DISTINCT COMPANY, PROJECT
FROM TABLE t
WHERE EXISTS (
  SELECT 1
  FROM TABLE tDummy
  WHERE tDummy.COMPANY = t.COMPANY
  AND tDummy.PROJECT = t.PROJECT
  AND tDummy.[TYPE] = 'DUMMY')
AND NOT EXISTS (
  SELECT 1
  FROM TABLE tNotDummy
  WHERE tNotDummy.COMPANY = t.COMPANY
  AND tNotDummy.PROJECT = t.PROJECT
  AND (
    tNotDummy.[TYPE] <> 'Dummy'
    OR tNotDummy.[TYPE] IS NULL)); 
```

This assumes that if `TYPE` is null, you don't count it as 'DUMMY'.

# java - Spring MVC 为什么我的模型中的数据没有显示在 output.jsp 中？

> ID：15297217
> 
> 赞同：1
> 
> 时间：2013-03-08T15:15:53.227
> 
> 标签：java, spring, spring-mvc

我正在使用 Spring MVC。为什么我的模型中的数据没有显示在 output.jsp 中？我正在研究一个非常简单的数据示例，该示例显示在一页上并在第二页显示。我检查了数据是否在模型中，但我不知道为什么第二个 JSP 没有显示它。

这是我的控制：

```
@Controller
public class RequestController {

    private static final Logger LOGGER = getLogger(RequestController.class);

    @RequestMapping(value = "/request" , method = RequestMethod.GET)
       public ModelAndView displayRequestPage(@ModelAttribute("inputForm") InputForm inputForm) {

        return new ModelAndView("input");

    }

    @RequestMapping(value = "/request" , method = RequestMethod.POST)
    public ModelAndView displayOutputPage(@ModelAttribute("inputForm") InputForm inputForm) {

        Map<String, Object> model = new HashMap<String, Object>();
        model.put("inputForm", inputForm);

        return new ModelAndView("display", model);

    }

} 
```

这是我的输出 JSP：

```
<%@ taglib prefix="fn" uri="http://java.sun.com/jsp/jstl/functions" %>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form" %>

<html>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>JQuery Validation Engine</title>
</head>
<body>
 <center>
<h2>JQuery Examples</h2>
 </center>
        <p>Name: <c:out value="${inputForm.name}"/>
        <p>Phone(xxx)xxx-xxxxx: <c:out value="${inputForm.phone}"/>
        <p>Email: <c:out value="${inputForm.email}"/>

    <p>
     <b>Please  <a href="./request">click here</a>  to restart</b>
    </p>

</body>
</html> 
```

这就是我得到的输出：

```
Name: ${inputForm.name}

Phone(xxx)xxx-xxxxx: ${inputForm.phone}

Email: ${inputForm.email}

Please click here to restart 
```

这是我的 Spring MVC.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:p="http://www.springframework.org/schema/p"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:mvc="http://www.springframework.org/schema/mvc"
    xmlns:context="http://www.springframework.org/schema/context"

    xsi:schemaLocation="http://www.springframework.org/schema/mvc
                        http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
                        http://www.springframework.org/schema/beans
                        http://www.springframework.org/schema/beans/spring-beans.xsd
                        http://www.springframework.org/schema/context
                       http://www.springframework.org/schema/context/spring-context-3.0.xsd">

  <mvc:annotation-driven />

    <bean id="messageSource" class="org.springframework.context.support.ResourceBundleMessageSource"
          p:basenames="messages" />

    <!-- Declare the Interceptor -->
    <mvc:interceptors>
        <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor"
              p:paramName="locale" />
    </mvc:interceptors>

    <mvc:resources mapping="/static/**" location="/WEB-INF/static/"/>

    <bean id="viewResolver"
        class="org.springframework.web.servlet.view.UrlBasedViewResolver">
        <property name="viewClass"
            value="org.springframework.web.servlet.view.JstlView" />
        <property name="prefix" value="/WEB-INF/jsp/" />
        <property name="suffix" value=".jsp" />
    </bean>

</beans> 
```

我让它工作但改变了我的 web.xml .. 下面是工作 web.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         id="WebApp_ID" version="2.5">

  <display-name>JQuery Example Web Application</display-name>

    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/root-config.xml</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>spring</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value></param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>spring</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
</web-app> 
```

这是不起作用的 web.xml：

```
<!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" >

<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
         id="WebApp_ID" version="2.5">

  <display-name>JQuery Example Web Application</display-name>

    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>

    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/spring/root-config.xml</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <servlet>
        <servlet-name>spring</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value></param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>spring</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>
</web-app> 
```

有人可以告诉我为什么更改 web.xml 使它起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:27:04.637

您的模型仅用于 POST 请求（在 中`displayOutputPage`），但您的 JSP 中没有任何地方提交表单。因此，您只需要调用`displayRequestPage`而不提供模型（a`<a href`创建 GET 请求）。

此外，由于您没有提交 a `<form>`，因此您`inputForm`将不会在其中包含任何数据。

要检查这一点，您始终可以设置断点并查看调用了哪个方法。

编辑：

我做出上述假设是因为您有以下链接可以重新启动该过程：

```
<b>Please  <a href="./request">click here</a>  to restart</b> 
```

而且由于您的映射`displayRequestPage`是`/request`...至于未评估的 EL，可能只是因为您没有模型，因为`inputForm`您没有模型，因此 EL 不评估它只是按原样打印文本。

编辑2：

EL 表达式以前对您不起作用，因为 Servlet Spec 2.3 不支持 EL（在 2.4 中引入）。正如您声明您`web.xml`使用的是规范 2.3，它只是关闭了解析 EL 的开销。

编辑3：

只是为了澄清这条线

线

```
<!DOCTYPE web-app PUBLIC
 "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"
 "http://java.sun.com/dtd/web-app_2_3.dtd" > 
```

告诉您的 servlet 容器使用规范 2.3

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:42:37.487

尝试向您的控制器方法添加一个`model`参数并尝试填充该模型而不是创建一个新模型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T15:30:52.420

另请参阅：[基本 Spring MVC 数据绑定](https://stackoverflow.com/questions/10198335/basic-spring-mvc-data-binding)

有几件事可能是错误的：

*   确保 InputForm 具有 getter/setter 和无参数构造函数
*   尝试使用 Spring 的[绑定标签](http://static.springsource.org/spring/docs/1.1.5/taglib/tag/BindTag.html)或表单标签。
*   尝试手动将 InputForm 添加到模型中（即 model.put()）。

如果您期望 InputForm 将数据绑定到您可能需要使用的请求`@Valid`......您不应该这样做，但它不会受到伤害。

最后，在成功的 POST 上，您几乎总是希望重定向而不是直接提供响应。如果它是一个错误，您应该提供响应。

# javascript - 与 Cucumber.js 一起使用的 CasperJS 的替代品

> ID：15297222
> 
> 赞同：14
> 
> 时间：2013-03-08T15:16:07.187
> 
> 标签：javascript, cucumber, bdd, phantomjs

经过大量研究和反复试验，我选择了以下堆栈进行前端 BDD 测试：

*   黄瓜.js
*   CasperJS（通过 SpookyJS）
*   幻影JS

我想避免 CasperJS 运行队列并直接（通过[phantom-proxy](https://github.com/sheebz/phantom-proxy)）使用 PhantomJS，并在每个步骤中使用回调：

```
@World = (cb) ->
    @phantom = require "phantom-proxy"
    cb()

@Before (cb) ->
    self = this
    @phantom.create {}, (proxy) ->
        self.proxy = proxy
        self.page = proxy.page
        cb()

@After (cb) ->
    @proxy.end ->
        cb()

@When /^I go to url "([^"]*)"$/, (url, cb) ->
    @page.open url, ->
        cb() 
```

使整体更具逻辑性和 BDD 式。

此外，SpookyJS 没有为 CasperJS 提供完整的 API。

然而，PhantomJS API 是相当低级的。是否有任何其他工具可以在不使用运行队列的情况下为 Node.js 提供类似 CasperJS 的功能（单击、等待元素等）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-07-25T22:55:51.647

[Mocha-PhantomJS](https://github.com/metaskills/mocha-phantomjs)可能正是您正在寻找的。

或者，[WebdriverJS](http://webdriver.io/)支持黄瓜测试。

如果你想更底层，你可以尝试直接与[selenium-webdriver](https://code.google.com/p/selenium/wiki/WebDriverJs)交互。这是github上的一个[演示。](https://github.com/keithamus/WebCumberNode)

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-24T14:41:35.797

我推荐[Mocha](http://visionmedia.github.io/mocha/)，它有一个[黄瓜语法插件（mocha-cakes）](https://github.com/quangv/mocha-cakes)和/或 chai，它是插件[chai-jquery](https://github.com/chaijs/chai-jquery)和[chai-timers](http://chaijs.com/plugins/chai-timers)。

此外， [Karma](http://karma-runner.github.io/)通过插件[karma-cucumber](https://www.npmjs.org/package/karma-cucumber)提供黄瓜语法支持。

Karma 和 Mocha 都允许您使用例如用于 saucelabs 或 browserstack 的启动器针对真实设备运行测试。

希望能帮助到你。

# php - Woocommerce 自定义字段未保存

> ID：15297223
> 
> 赞同：2
> 
> 时间：2013-03-08T15:16:10.403
> 
> 标签：php, wordpress

我在 woocommerce 中有 3 个自定义字段：

案件参考编号、发票编号和律师处理案件（代码接下来，如果您不想看到它只需向下滚动，它并不那么重要）

```
add_action('woocommerce_after_order_notes', 'matter_reference_number_func');

function matter_reference_number_func( $checkout ) {

    echo '<div id="matter_ref"><h3>'.__('Matter reference number').'</h3>';

    woocommerce_form_field( 'matter_reference_number', array(
        'type'          => 'text',
        'class'         => array('my-field-class form-row-wide'),
        'placeholder'       => __('Matter reference number'),
        ), $checkout->get_value( 'matter_ref_num' ));

    echo '</div>';

}

add_action('woocommerce_after_order_notes', 'invoice_number_func');

function invoice_number_func( $checkout ) {

    echo '<div id="inv_num"><h3>'.__('Invoice number').'</h3>';

    woocommerce_form_field( 'invoice_number', array(
        'type'          => 'text',
        'class'         => array('my-field-class form-row-wide'),
        'placeholder'       => __('Invoice number'),
        ), $checkout->get_value( 'invoice_num' ));

    echo '</div>';

}

add_action('woocommerce_after_order_notes', 'sol_deal_func');

function sol_deal_func( $checkout ) {

    echo '<div id="sol_deal"><h3>'.__('Solicitor dealing with matter').'</h3>';

    woocommerce_form_field( 'matter_reference_number', array(
        'type'          => 'text',
        'class'         => array('my-field-class form-row-wide'),
        'placeholder'       => __('Solicitor dealing with matter'),
        ), $checkout->get_value( 'sol_deal' ));

    echo '</div>';

} 
```

但是，现在当我尝试保存值时，它们不会出现在发给客户的电子邮件中，也不会出现在管理员中，甚至不会出现在确认页面上。根据[文档，](http://docs.woothemes.com/document/tutorial-customising-checkout-fields-using-actions-and-filters/ "文档")这应该足以做到这一点；但它不是。

```
/**
 * Update the order meta with field value
 **/
add_action('woocommerce_checkout_update_order_meta', 'matter_ref_num_checkout_field_update_order_meta');

function matter_ref_num_checkout_field_update_order_meta( $order_id ) {
    if ($_POST['matter_ref_num']) update_post_meta( $order_id, 'Matter Reference Number', esc_attr($_POST['matter_ref_num']));
}

/**
 * Update the order meta with field value
 **/
add_action('woocommerce_checkout_update_order_meta', 'invoice_num_checkout_field_update_order_meta');

function invoice_num_checkout_field_update_order_meta( $order_id ) {
    if ($_POST['invoice_num']) update_post_meta( $order_id, 'Invoice Number', esc_attr($_POST['invoice_num']));
}

/**
 * Update the order meta with field value
 **/
add_action('woocommerce_checkout_update_order_meta', 'sol_deal_checkout_field_update_order_meta');

function sol_deal_checkout_field_update_order_meta( $order_id ) {
    if ($_POST['sol_deal']) update_post_meta( $order_id, 'Solicitor Dealing With Matter', esc_attr($_POST['sol_deal']));
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T03:16:51.170

您正在使用挂钩来更新帖子元（作为帖子 ID 和订单 ID）。如果您检查您的数据库，您应该能够在相应的帖子 ID 元数据下看到这些字段。

如果您想将它们添加到电子邮件中，您还需要使用另一个钩子：

woocommerce_email_order_meta_keys

以下是来自 woocommerce 文档的参考：

```
/**
 * Add the field to order emails
 **/
add_filter('woocommerce_email_order_meta_keys', 'my_custom_checkout_field_order_meta_keys');

function my_custom_checkout_field_order_meta_keys( $keys ) {
    $keys[] = 'My Field';
    return $keys;
} 
```

你真的只需要每个动作使用一个钩子并将你的代码放在那里，例如：

```
/**
 * Update the order meta with field value
 **/
add_action('woocommerce_checkout_update_order_meta', 'custom_checkout_field_update_order_meta');

function custom_checkout_field_update_order_meta( $order_id ) {
    if ($_POST['matter_ref_num']) update_post_meta( $order_id, 'Matter Reference Number', esc_attr($_POST['matter_ref_num']));
    if ($_POST['invoice_num']) update_post_meta( $order_id, 'Invoice Number', esc_attr($_POST['invoice_num']));
    if ($_POST['sol_deal']) update_post_meta( $order_id, 'Solicitor Dealing With Matter', esc_attr($_POST['sol_deal']));
} 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-20T09:20:27.657

接受的答案对我不起作用。我不得不删除 update_post_meta 函数的第二个参数：

```
add_action( 'woocommerce_checkout_update_order_meta', 'custom_checkout_fields_update_order_meta' );
function custom_checkout_fields_update_order_meta( $order_id ) {
  if ($_POST['_billing_vat_number']) update_post_meta( $order_id, '_billing_vat_number', sanitize_text_field( $_POST['_billing_vat_number'] ) );
} 
```

我还使用了 wordpress 形式的清理功能，但这不是问题。

# javascript - 访问已下载的数据

> ID：15297225
> 
> 赞同：5
> 
> 时间：2013-03-08T15:16:13.663
> 
> 标签：javascript, html

我需要通过`XmlHttpRequest`. 数据来自第三方，我想在下载内容时逐渐显示内容。

所以我认为以下方法会起作用：

```
var req = new XMLHttpRequest();
req.open( "GET", mirror.url, true );
req.responseType = "arraybuffer";

req.onload = function( oEvent ) {
    console.log( "DONE" );
};
var current_offset = 0;
req.addEventListener("progress", function(event) {
    if( event.lengthComputable ) {
        var percentComplete = Math.round(event.loaded * 100 / event.total);
    }
    var data = req.response;
    // Fails here: req.response is null till load is called

    var dataView = new DataView( data );
    while( current_offset < dataView.byteLength ) {
        // do work
        ++current_offset;
    }

    console.log( "OFFSET " + current_offset + " [" + percentComplete + "%]" );

}, false);
try {
    req.send( null );
} catch( er ) {
    console.log( er );
} 
```

遗憾的是，根据规范，`.response`不可用。

有没有什么方法可以访问已经下载的数据，而不需要像使用这样可怕的解决方法`Flash`？

编辑：

找到至少一个适用于 Firefox 的非标准解决方案：

```
responseType = "moz-chunked-arraybuffer"; 
```

另请参阅：[WebKit 等效于 Firefox 的“moz-chunked-arraybuffer”xhr responseType](https://stackoverflow.com/questions/15185499/webkit-equivalent-to-firefoxs-moz-chunked-arraybuffer-xhr-responsetype)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:11:36.520

一种解决方案是使用范围请求仅下载文件的一部分以仅下载文件的一部分。有关详细信息，请参阅以下博客文章[HTTP 状态：206 部分内容和范围请求](http://benramsey.com/blog/2008/05/206-partial-content-and-range-requests/)。

如果您可以控制服务器，您还可以在服务器端拆分文件并下载它的块。这样，您就可以在收到不同的块时访问响应。

第三种方法是使用[WebSockets](http://en.wikipedia.org/wiki/WebSocket)下载数据。

如果您无法控制要从中下载的服务器，并且其他选项都不起作用，那么您可能需要实现一个代理服务，该服务将充当中间件并只允许您下载其中的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:46:36.017

您是否考虑过为此使用库？

我从来没有用它来加载一个 100MB 的文件，但是[PreloadJS](http://createjs.com/#!/PreloadJS)非常适合加载各种资产。

# javascript - 使用 Datatables jQuery 插件提高更新 DOM 的性能

> ID：15297227
> 
> 赞同：2
> 
> 时间：2013-03-08T15:16:21.267
> 
> 标签：javascript, jquery, performance, dom, datatables

`fnUpdate`我想知道在将函数应用于多行时是否有任何方法可以加速函数。就我而言，我使用它来更新例如 10 个不同行的 10 个单元格，我注意到它并没有预期的那么快。它有点滞后。

[我已经看到](http://devongovett.wordpress.com/2009/12/08/jquery-dom-manipulation-at-lighting-speeds/)，在更新 DOM 时提高性能的一种常用技术是立即完成而不是循环。这样，浏览器只会重排页面一次，并且会加快流程。

有没有办法在[fnUpdate 函数](http://www.datatables.net/api)的数据表插件制作中做到这一点？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-02-24T21:01:49.427

尝试 fnUpdate 的第 4 和第 5 个选项可能会有所帮助，这会在更新单元格后立即禁用更新整个表。完成所有更改后，您可以进行整个表更新。

> for(i = 0; i < rows ; i++)
> {
> dataTable.fnUpdate( "样本数据", i, 3, false, false );
> }
> 数据表.fnDraw();

# app-store - App Store 和外部链接

> ID：15297228
> 
> 赞同：0
> 
> 时间：2013-03-08T15:16:25.953
> 
> 标签：app-store, appmobi

我对此有点困惑。我正在使用 Appmobi 开发照片应用程序。客户从他的设备上传了一些照片并订购了几份（这是为当地一家小型照片店准备的）

好吧，我看到如果我想在应用程序内支付订单，Apple 获得了其中的 30%（这家商店获得了 15% 左右），所以这种模式是不可能的。我发现我可以从应用程序启动一个外部链接（在 Appmobi 框架中通过 AppMobi.device.launchExternal 或 AppMobi.device.showRemoteSite）我可以在服务器上下订单并启动一个带有 Paypal 信息的外部链接，但是。 ..有谁知道这是否违反了Apple TOS？这家商店出售实物（照片），所以我认为这是允许的。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T11:16:53.523

据我了解

如果您的手机可以使用一项服务（数字/虚拟商品等），那么您的付款方式就会受到限制。（Apple 几乎总是要求您使用 IAP 支付或根本不提供支付系统（即用户将在网站上充值，但应用程序不能有指向用户的链接。结帐 Kindle、Skydrive 等.)

如果不能在手机本身上使用一项服务（打印照片等实物），那么您就不能使用 IAP 进行付款，并且必须使用外部支付提供商，例如 Paypal 等。

如果[我在我的 iPhone 应用程序中使用 PayPal 网关，Apple 会批准它吗？](https://stackoverflow.com/questions/7005929/if-i-use-the-paypal-gateway-in-my-iphone-app-will-apple-approve-it)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:20:47.957

你很难获得这样的批准。Apple 非常不愿意批准与 Paypal 或其他外部支付提供商的任何链接，即使是提供本地商品的小企业也是如此。相反，您可以做的是让客户为商店中的照片付费，或者提高价格以弥补苹果 30% 的折扣。我没有销售这样的本地商品的经验，但我相当肯定苹果不会允许这样做。不过，您可以随时尝试！

# java - 模拟文本输入的关键事件？

> ID：15297236
> 
> 赞同：1
> 
> 时间：2013-03-08T15:16:42.583
> 
> 标签：java, events, gwt

如何模拟文本输入的按键事件。

我有一个`GWT.TextArea`并且在某种情况下我想`KeyEvent`在文本框中模拟一个。为了测试，我尝试像这样模拟左箭头键：

```
Sysout("SIMULATE");
Event event = Document.get().createKeyDownEvent(false, false, false, false, KeyCodes.KEY_LEFT).cast();
textArea.onBrowserEvent(event);
textArea.getElement().dispatchEvent(event); 
```

我得到的是系统输出，但不是模拟的关键事件。为什么？

# android - 是否有用于自定义 android 构建的 Google Cloud Messaging 的替代品？

> ID：15297246
> 
> 赞同：10
> 
> 时间：2013-03-08T15:17:01.090
> 
> 标签：android, push-notification, google-cloud-messaging

我们有一个自定义的 android 版本，刚刚发现 Google Cloud Messaging (GCM) 可能是非 Google 认证版本的问题。

假设是这种情况，有没有 GCM 的替代品？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T15:34:47.663

在 android 中实现推送通知的最简单方法是[解析](http://parse.com)

只需注册自己，创建新的 android 应用程序。

结帐[演示](https://www.parse.com/docs/downloads)代码

集成您的**ApplicationID**和**Client key**。

运行您的应用程序，一切就绪！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-08T15:21:13.150

你可以试试 [xtify](http://developer.xtify.com/display/support/Xtify+Developer+Documentation+Site)

或者

[小推车](http://www.pushlets.com/)

或者

[城市飞艇](https://docs.urbanairship.com/display/DOCS/Client%3A+Android%3A+Push)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-11-07T08:53:11.953

[Paho](http://www.eclipse.org/paho/)项目是一个[iot.eclipse.com](http://iot.eclipse.com)项目，基于 MQTT 的服务器的开源客户端。

您可以查看 android 应用程序演示[示例](http://www.eclipse.org/paho/clients/android/sample/)。

它将连接到 Eclipse 免费托管的基于 MQTT 的沙箱服务器以测试此应用程序。请[在此处查看此服务器详细信息](http://iot.eclipse.org/sandbox.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-08T06:04:46.317

借助 Urbran Air Ship 文档中显示的步骤，我在 Android 中实现了 Push Notification [ Using Urban Air Ship] 应用程序

[http://urbanairship.com/docs/android_client.html](http://urbanairship.com/docs/android_client.html) ,

它以一种很好的方式工作，当我的提要更新时，我也收到了通知。这是已经完成的步骤。

Step1：在 Urban Air Ship 中创建一个账户， [https://go.urbanairship.com/](https://go.urbanairship.com/)

第2步：从这里下载android_push.jar [https://github.com/urbanairship/android-push-library/downloads](https://github.com/urbanairship/android-push-library/downloads)

Step3：在关闭应用程序标记文件之前，在 AndroidManifest.xml 中注册接收器，如下所示

```
<application>
:
:
:

<receiver android:name="com.urbanairship.push.IntentReceiver">
<intent-filter>
<action android:name="com.urbanairship.airmail.END_REGISTER"></action>
<action android:name="com.urbanairship.airmail.ACCEPT_PUSH"></action>
<action android:name="com.urbanairship.airmail.NOTIFY"></action>
</intent-filter>
</receiver>
</application> 
```

第 4 步：登录您的帐户，在他们的网站上注册您的应用程序。对于您帐户中的单击应用程序选项。

Step5：点击应用程序图标后，您可以看到添加您的应用程序选项，如下图所示

Step6：输入您的应用名称并单击推送通知支持，然后输入您的包名称。并单击创建您的应用程序按钮，一个新窗口将为您提供应用程序密钥。

第七步：在 res 文件夹下的 raw 文件夹下创建一个名为 ua.properties 的文件，即 res/raw/ua.properties 文件

Step8：将您在Urban AirShip中注册应用程序后获得的应用程序密钥以及您的应用程序的指纹输入到ua.properties文件中，如下所示。

> debug=true debug.app_key=j9kRTqaCRR-E0xf-iu2XEA production.app_key=9D:54:23:3F:F3:25:AB:0B:DC:8E:D9:C8:B3:F4:96:F9

第 9 步：创建一个应用程序类，如下所示

```
import com.urbanairship.push.APIDReceiver; import
 com.urbanairship.push.AirMail; import
 com.urbanairship.push.PushReceiver;

 import android.app.Application; import android.content.Intent; import
 android.util.Log;

 public class PushNotification extends Application { public void
 onCreate(){ AirMail am = AirMail.getInstance(); am.acceptPush(this,
 new PushReceiver() { @Override public void onReceive(String message,
 String payload){ Log.d("push", "Got message '" + message +"' and
 payload '" + payload + "'"); }

 @Override public void onClick(String message, String payload){
 Log.d("push", "User clicked the notification, got message and payload:
 "
 + message + ", " + payload); /* In this example, we fire up our MainActivity class when the
 * user clicks the Status Bar Notification. Note that we *must*
 * use the flag Intent.FLAG_ACTIVITY_NEW_TASK to start a new
 * activity because this callback is fired from within a
* BroadcastReceiver.
**/ Intent intent = new Intent("android.intent.action.MAIN"); intent.setClass(PushNotification.this,MainActivity.class);
 intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
 PushNotification.this.startActivity(intent); } });

 am.setAPIDReceiver(this, new APIDReceiver() { @Override public void
 onReceive(String apid, boolean valid){ if(valid){ Log.d("push", "Got
 apid: " + apid); } else { Log.d("push", "Application registration
 invalid!"); } }

 @Override public void onAirMailInstallRefusal() {
 Rss_Feed_Grid.register = false; Log.d("push", "AirMail Install
 Refused!"); } }); } } 
```

第 10 步：在您的 Activity 中检查以下注册码

```
 protected static boolean register = true;

 if(register){ AirMail am = AirMail.getInstance(); am.register(this); } 
```

第 11 步：更新您的清单以注册您的应用程序

```
 <application android:icon="@drawable/icon"
 android:label="@string/app_name" android:name=".PushNotification"> 
```

Step12：现在点击Push Notification，然后点击Urbran Air Ship中的feed按钮，然后feed要监控的url

而已..

有关更多信息，请参阅我的博客 [http://sankarganesh-info-exchange.blogspot.sg/p/push-notification-in-android-using.html](http://sankarganesh-info-exchange.blogspot.sg/p/push-notification-in-android-using.html)

# sql - SQL - OVER 子句范围在 2 次之间

> ID：15297251
> 
> 赞同：2
> 
> 时间：2013-03-08T15:17:16.047
> 
> 标签：sql, range, sql-server-2012, between, over-clause

我正在尝试使用 over 函数来计算在所有行的当前行的开始日期和结束日期之间开始的事件数。即并发计数器。最终，我将寻找每天或每小时的最大并发事件等。

```
select   FingerPrint
        ,StartDate
        ,EndDate
        ,Num_ConCurrent =   count(FingerPrint) over (
                                                    partition by StartDate
                                                    order by StartDate  
                                                    range between StartDate PRECEDING and EndDate following 
        )
from    #File
group by     FingerPrint
            ,StartDate
            ,Enddate 
```

不幸的是，这似乎不起作用。虽然我知道我可以简单地使用自联接，但我认为可能有一种带有 over 子句的替代方法。

非常感谢任何帮助。

注意：错误信息

消息 102，级别 15，状态 1，第 7 行“开始日期”附近的语法不正确。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T18:42:10.743

over 子句中的 Range 参数正在查找整数值，而不是列引用。可能有一种方法可以使用 over 子句，但我也无法让它工作。

以我的经验，在一个范围内的日期上自我加入非常慢，而且我还没有找到合适的索引集来加速它。在这种情况下，我只会在内联子查询中使用。

```
select  FingerPrint,
        StartDate,
        EndDate,
        (select count(FingerPrint)
         from #File F2
         where F2.StartDate between F.StartDate and F.EndDate
        ) 
        as Num_ConCurrent 
        )
from    #File F 
```

对我拥有的一些约会数据进行了一些测试，并使用这种方法立即执行了 32,000 行约会。在我停止之前，自我加入运行了 15 秒。

# grails - 引起：com.sun.org.apache.xerces.internal.impl.io.MalformedByteSequenceException：1字节UTF-8序列的字节1无效

> ID：15297252
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:17.757
> 
> 标签：grails, invocationtargetexception

在 windows 7 64bits 中，使用 JDK 1.7 update 17，控制台中的 Grails 2.2.1：

1 - 当输入“grails create-app helloworld”工作正常时。2- cd "helloworld" 工作正常 3- grails | 加载 Grails 2.2.1 | 错误 java.lang.reflect.InvocationTargetException

原因：com.sun.org.apache.xerces.internal.impl.io.MalformedByteSequenceException：1 字节 UTF-8 序列的字节 1 无效。

现在使用相同的软件，但在具有 Windows 8、64 位、JDK 1.7 更新 17、Grails 2.2.1 的机器上工作正常。

装有 Windows 7 的机器中的某些软件会导致该问题。我没有在 Windows 8 和 Windows 7 中设置 ANT 环境，那么这不是问题所在。

任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T20:11:22.613

很可能您在某处有图书馆冲突。我将首先检查您的类路径中是否有任何其他版本的 xerces。它可能不是直接的 xerces，而是它使用的一些通用库。

# html - 更改搜索栏的背景/文本颜色

> ID：15297254
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:23.077
> 
> 标签：html, css, twitter-bootstrap

我的导航栏中有一个搜索栏（使用 Bootstrap）：

```
<li>
    <form class="navbar-search pull-right">
        <input type="text" class="search-query offset1" placeholder="Search">
    </form>
</li> 
```

我想更改默认的背景颜色和文本颜色，所以我实现了以下 CSS：

```
input .search-query {
    background-color:#f47443;
    color:white;
} 
```

然而颜色保持不变——黑色和白色。我缺少的表单/输入背景颜色和字体颜色有什么特别之处吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:18:39.643

你要：

```
input.search-query {
    /* css */
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/SYCwT/)。

如果没有空格，它会选择`input`一个类为`search-query`;的元素。*用*空格分隔术语`input`，`.search-query`浏览器正在元素内部查找`input`具有该类的*后代*元素。`search-query`

顺便说一句，你写的选择器：

```
input .search-query {
    /* css */
} 
```

永远*无法*匹配任何元素，因为`input`（与`img`元素一样）无效元素，因为它们不能包含后代元素甚至文本。

参考：

*   [CSS 选择器（第 3 级），W3.org](http://www.w3.org/TR/selectors/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:19:34.207

```
input .search-query {
    background-color:#f47443;
    color:white;
} 
```

>

```
input.search-query {
    background-color:#f47443;
    color:white;
} 
```

删除空间。

# sql - 单行当月和上月数据

> ID：15297255
> 
> 赞同：-4
> 
> 时间：2013-03-08T15:17:23.470
> 
> 标签：sql, sql-server, sql-server-2008

下表具有如下数据类型：

ItemName varchar、Date Date、Amt varchar、status varchar

```
ItemName        Date        Amt     

    ABC       1/02/2012     500     
    ABC       8/03/2012     250 
```

预期结果

```
ItemName    LastMonthAmt    CurrentMonthAmt

ABC          500             250 
```

请帮我写这个问题的查询。

提前致谢。

我尝试过的如下：

```
declare @T table
(
  id varchar(2),
  [Date] datetime,
  [Amt] varchar(5),
  [Status] varchar(5)
)

insert into @T
select '01',   '1/02/12',  '125',   'LM' union all
--select '01',   '1/02/12',  '200',   'Exit' union all
select '01',   '2/02/12',  '250',   'CM' union all
--select '01',   '2/02/12',  '150',  'CM' union all
select '02',   '1/02/12',  '300',   'LM' union all
--select '02',   '1/02/12',  '350',   'CM' union all
--select '02',   '2/02/12',  '220',   'LM' union all
select '02',   '2/02/12',  '140',  'CM'

select id,
       --convert(varchar(8), [Date], 1) as [Date],
       [Amt] as [CM],
      [Amt] as [LM]
from
  (
    select distinct id,
           [Amt],
           row_number() over(partition by id order by [Date] asc) as rn1,
           row_number() over(partition by id order by [Date] desc) as rn2
    from @T
  ) as T
where T.rn1 = 1 or
      T.rn2 = 1
group by id, [Amt] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:23:16.247

您可以使用具有`CASE`类似于以下表达式的聚合函数：

```
select itemname,
  sum(case when month(date) = month(getdate()) -1 then amt else 0 end) LastMonthAmt,
  sum(case when month(date) = month(getdate()) then amt else 0 end) CurrentMonthAmt
from yourtable
group by itemname; 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!3/26591/4)

# php - 从 phpMyAdmin 填充 ListView

> ID：15297256
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:25.677
> 
> 标签：php, android, json

我在 phpMyAdmin 中有一个数据库。我想从表格中获取信息并使用它来填充`ListView`我的 Android 应用程序。

我创建了一个 PHP 文件：

```
<?php

$host="localhost";
$user="root";
$pass="";
$dbname="ltc";

$con= mysql_connect($host,$user,$pass);
$BD= mysql_select_db($dbname, $con);

$query=mysql_query("select * from posts");
$num=mysql_num_rows($query);

if($num==1)
{
    while($list=mysql_fetch_assoc($query))
    {
        $output=$list;
        echo json_encode($output);
    }
        mysql_close();
    }
?> 
```

我`ListView`在 Android 中创建了一个。如何获取信息并将其放入列表中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:36:27.683

您可以使用以下方法调用您的 php 页面：

```
 public static String getWebData(String url) {
            HttpParams httpParameters = new BasicHttpParams();
            // Set the timeout in milliseconds until a connection is established.
            // The default value is zero, that means the timeout is not used. 
            int timeoutConnection = 3000;
            HttpConnectionParams.setConnectionTimeout(httpParameters, timeoutConnection);
            // Set the default socket timeout (SO_TIMEOUT) 
            // in milliseconds which is the timeout for waiting for data.
            int timeoutSocket = 5000;
            HttpConnectionParams.setSoTimeout(httpParameters, timeoutSocket);

             // Create a new HttpClient and Post Header
            HttpClient httpclient = new DefaultHttpClient(httpParameters);

            HttpGet httpgett = null;

                httpgett = new HttpGet(url);

        String result="";
            try {

                // Execute HTTP Post Request
                HttpResponse response = httpclient.execute(httpgett);
                int status = response.getStatusLine().getStatusCode();
                result = EntityUtils.toString(response.getEntity());

            } catch (ClientProtocolException e) {
                // TODO Auto-generated catch block
                System.out.println("--->" + "ClientProtocolException" + e.getMessage());
                return "";
            } catch (IOException e) {
                // TODO Auto-generated catch block
                return "";
            } catch (Exception e) {
                // TODO Auto-generated catch block
                return "";
            }

                return result;
            } 
```

一个你有你的数据，你可以把它放到你的 ListView

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:33:20.453

假设您的 PHP 文件输出正确的 JSON；您的下一步将调用 URL 以使用 HttpGet 访问此 JSON。这将为您返回一个响应，即 JSON 作为字符串。

您必须解析此响应。您可以为此使用“gson”。因此，您可以填充一些列表、对象或数据库并使用它来填充您的 ListView。

# image - 背景图片 - 我的代码有什么问题？

> ID：15297257
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:25.640
> 
> 标签：image, css, background-image

我根本无法让这段代码工作。我想在每个页面上放置不同的背景图像。我认为我应该通过创建不同的类选择器来做到这一点，然后将它们放在每个页面的正文标签中，而不是使用内联样式元素。

这是我的 CSS 类选择器：

```
 .contact-grad
{
        background-image:url('images/Backgrounds/contact-grad.png');
        position:absolute;
        left:0px;
        top:0px;
        z-index:-1;
} 
```

在这里，我将其放在 html 中以供联系：

```
<body id="contact-grad"> 
```

如您所见，它不起作用。

让我知道发布整个 html 和 css 是否对我有帮助。我无法让任何背景图像工作。我将我的代码放入 w3 验证器，并得到一个“解析”错误。嗯……

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:20:01.957

身体有一个 id 'contact-grad' 但你在 css 中的选择器在一个类上（这就是点的作用）。尝试改用哈希“#”。如在

```
#contact-grad
{
    background-image:url('images/Backgrounds/contact-grad.png');
    position:absolute;
    left:0px;
    top:0px;
    z-index:-1;
} 
```

**附录**： [此](http://net.tutsplus.com/tutorials/html-css-techniques/the-30-css-selectors-you-must-memorize/)资源是 CSS 选择器的良好入门。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:20:31.497

`.contact-grad`用于课程，`#contact-grad`用于您的`id="contact-grad"`.

您不应该将身体作为绝对位置，最好在身体内使用 div ;)。

# javascript - document.onmouseover 和 onmouseout 事件参数在 IE 8 和 IE7 中未定义

> ID：15297262
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:38.897
> 
> 标签：javascript, internet-explorer, internet-explorer-8

参数 e 在 Chrome、FF 和 IE 9 中是正确的事件，但在 IE 8 和 IE 7 中是“未定义”。使用 F12 devtools 在 IE 9 中可重现浏览器模式：IE 8 和文档模式：IE 8。

注意：该函数被正确调用，我的“唯一”问题是 e 未定义......

```
<script>
    document.onmouseover = function(e) {
    // parameter e is the correct event in Chrome, FF and IE 9
    // but 'undefined' in IE 8 and IE 7\. Reproducable in IE 9 using F12 devtools
    // Browser Mode: IE 8 and Document Mode: IE 8 also.
    // NOTE: The function is called properly my 'only' problem that e is undefined

    ... work with parameter e here
}
</script> 
```

有任何想法吗？你提前

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:21:17.520

IE 以不同的方式处理事件，因此它为什么不起作用。

```
document.onmouseover = function(e) {
  e = e || window.event;
} 
```

# php - php通过键对关联数组进行排序，这些键存在于其他数组中

> ID：15297263
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:40.500
> 
> 标签：php, arrays, associative

我有这个数组

```
$myArray=array(

'a'=>array('id'=>1,'text'=>'blabla1'),
'b'=>array('id'=>2,'text'=>'blabla2'),
'c'=>array('id'=>3,'text'=>'blabla3'),
'd'=>array('id'=>4,'text'=>'blabla4'),

); 
```

我想通过存在于另一个数组中的键 a、b、c、d 对上述数组进行排序：

```
$tempArray=array('c','a','d','b'); 
```

我怎么能这样做，所以 $myArray

看起来像这样：

```
$myArray=array(

'c'=>array('id'=>3,'text'=>'blabla3'),
'a'=>array('id'=>1,'text'=>'blabla1'),
'd'=>array('id'=>4,'text'=>'blabla4'),
'b'=>array('id'=>2,'text'=>'blabla2'),

); 
```

谢谢你帮助我！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:20:59.190

最简单且可能最有效的方法是迭代保存排序顺序的数组并创建一个新的排序数组：

```
$sorted = array();

foreach ($tempArray as $order) {
  if (isset($myArray[$order])) {
    $sorted[$order] = $myArray[$order];
  }
}

print_r($sorted); 
```

这是有效的，因为关联数组隐含地具有将元素添加到数组中的顺序。

[看到它工作](http://codepad.org/J3KCbQYG)

* * *

*编辑*

任何涉及排序功能的解决方案都可能比这效率低得多。这是因为为了做到这一点，您需要使用一个接受回调的函数——这已经隐含了函数调用的开销。

排序功能也通过比较项目来工作，这意味着任何这些解决方案的复杂性都将大于该解决方案的复杂性（该解决方案的复杂性只是`O(n)`）。此外，为了导出排序函数的返回值，您需要检查目标数组，找到每个被比较键的位置，对于每次比较，这会增加更多的复杂性。

# c# - 是否可以使用已知用户和密码执行身份验证？

> ID：15297268
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:52.183
> 
> 标签：c#, .net, oauth, openid, oauth-2.0

**给定一个有效的用户名和密码，我可以使用OAuth**、**OAuth2**或**OpenId**执行身份验证（基本上是为了知道用户和密码是否正常）吗？

我需要调用身份验证服务器以了解用户和密码**是否有效**。

## 更新

实际上我找到了一个[文档](http://www.dotnetopenauth.net/documentation/securityscenarios/)，其中解释了 OAuth2 支持这种机制：

> 尽管如此，**OAuth2 也支持用户告诉客户端他的用户​​名和密码的场景**。在这种情况下，客户端将此信息以及客户端 ID 和客户端密码以及所需范围传输到授权服务器，然后直接获取所需令牌而无需再次调用。

那么，下一个问题是，请您提供一个可行的示例吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T22:19:24.883

The OAuth 2.0 spec defines several different use cases or workflows targeted to different kinds of applications or authorization scenarios.

One of the authorization workflows, and the one most commonly associated with Oauth, is when a client application requests access to a protected resource but does not obtain the end user's credentials directly - the access request redirects to present the end user with a login screen owned by the authorization system, not owned by the client application. When the user presents credentials and agrees to allow the client app's request for access, then the authorization server returns an authorization code to the client app and the client app can use that code to obtain an access token to access the end user's protected resources.

That's called the authorization code grant, and it's detailed in section 4.1 of the OAuth2 spec.

There is another authorization workflow in which the client app does have possession of user credentials or some other form of shared secret. The client application includes the user credentials or shared secret when requesting an access token. This is called a client credentials grant, and is detailed in [section 4.4 of the Oauth2 spec](https://www.rfc-editor.org/rfc/rfc6749#section-4.4).

The client credentials grant may be closest to your scenario.

# c++ - 在另一台计算机上运行使用 Visual Studio 构建的 EXE 文件的问题

> ID：15297270
> 
> 赞同：23
> 
> 时间：2013-03-08T15:17:57.230
> 
> 标签：c++, visual-studio, visual-studio-2008, visual-c++, exe

我使用 Visual Studio 在 C++ 中创建了一个客户端服务器应用程序。

现在我想在另一台计算机（没有安装 Visual Studio）上运行客户端 EXE 文件，但是当我尝试运行 EXE 文件时，它会给出以下错误消息：

> 此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。

如何在不在计算机上安装任何东西的情况下运行 EXE 文件？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-08T15:28:52.423

使用 Visual Studio 构建的应用程序依赖于 Visual C++ Redistibutable (VCRedist)。当程序被动态链接时，您的二进制文件将需要 `MSVCR**.dll`（Microsoft C 运行时库）。

在 MSDN 上，有一篇很好的文章，名为*[Redistributing Visual C++ Files (for Visual Studio 2008)](https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/ms235299(v=vs.90))*，指出在*未安装所需的 Visual C++ 库*的情况下存在*潜在的运行时错误：*

 *> *根据您尝试运行应用程序的 Windows 版本，您可能会收到以下错误消息之一：*
> 
> *   *应用程序未能正确初始化 (0xc0000135)。*
> *   ***此应用程序无法启动，因为应用程序配置不正确。重新安装应用程序可能会解决此问题。***
> *   *系统无法执行指定的程序。*

基本上你有两个选择：

*   最简单的可能解决方案是将运行时库的动态链接更改为静态链接。转到项目属性并在*C/C++ → 代码生成*下，您将找到*运行时库*选项。您需要将其从*Multi-threaded DLL (/MD)*更改为*Multi-threaded (/MT)*。
*   另一种可能的解决方案是确保在目标机器上安装了正确版本的 Microsoft VC++ Redistributable Package。

但是您的应用程序也可能依赖于其他 DLL 文件。如果您想找出程序的依赖项是什么，有一个名为[**Dependency Walker**](http://en.wikipedia.org/wiki/Dependency_Walker)的强大实用程序可以在这种情况和许多其他情况下为您提供帮助 :)

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-08T15:41:23.893

**背景：**

*   C++ 应用程序*需要*运行时程序集（DLL 文件）才能在任何 Windows 计算机上运行。
*   通常这些运行时程序集位于 C:\Windows\Winsxs 目录中。
*   默认情况下，所有 Windows 操作系统都带有几个运行时程序集。
*   但是，如果您的应用程序是在较新版本的运行时汇编环境中开发的，那么目标计算机也需要相同版本的运行时才能存在于那里。
*   安装 Visual Studio 时，大多数较新版本的运行时程序集都会安装到您的计算机上。

**解决方案：**

最后无论如何，目标计算机应该具有确切的运行时程序集。有几种方法可以做到这一点（有关更多详细信息，请在 Google 中搜索）。

1.  将运行时程序集与您的应用程序静态链接（对于大型应用程序来说很麻烦）。
2.  在目标计算机上安装 C++ 再分发环境（最简单的方法）。
3.  创建安装项目以在安装应用程序时在目标计算机上部署运行时（还不错）。
4.  要将运行时程序集部署为私有程序集（专业），请参阅[此处](http://helgeklein.com/blog/2010/03/deploying-visual-c-runtime-files-as-private-assemblies/)了解更多详细信息

**条件：**

*   您不得在应用程序中使用 .NET 框架。
*   您不得为您的应用程序使用公共语言运行时支持

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-03-11T16:05:31.507

我在发布而不是调试中部署了我的程序，并且 EXE 文件现在可以在另一台计算机上运行。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-08T15:24:34.413

我以前没有见过那个特定的错误。通常这是缺少 DLL（Windows 可再发行组件）的错误。假设配置实际上没有问题，您有两种选择：

1.  将编译模式从*Multithreaded DLL*更改为*Multithreaded*。这可以从代码生成下项目属性的 C++ 部分完成。在多线程模式下，您的二进制文件将静态链接到 Windows 可再发行组件。这可能就是你想要的。

2.  在目标机器上安装 Windows 可再发行组件。这可能不行，因为您声明您不想在目标机器上安装任何东西。

关于选项 1 的警告：不同版本的 Windows 具有不同版本的可再发行组件。可能会遇到高度专业化的环境，其中静态链接的程序不会按预期运行。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-08T15:21:55.320

看起来您缺少一些 DLL 文件。请务必将适当的 DLL 文件与 EXE 文件一起复制。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-02T22:29:52.283

我正在运行 Visual Studio 2019，我发现了一个非常有用的配置属性来解决将简单应用程序移动到另一台没有安装包的计算机的问题。

*   打开项目属性页。
*   选择此更改应应用于哪些配置，我使用“所有配置”。
*   在左侧窗口中单击以展开名为“配置属性”的顶部节点。
*   点击“高级”。在右侧窗口中查找名为“Copy C++ Runtime to OutDir”的属性并将其设置为“yes”。
*   单击“确定”关闭“属性”窗口。

重建你的项目。所有必要的 dll 都将被复制到项目的输出目录中。将您的 exe 和所有 dll 复制到另一台计算机。exe 应该找到运行所需的一切。*

# cordova - 构建后phonegap上传问题

> ID：15297271
> 
> 赞同：0
> 
> 时间：2013-03-08T15:17:58.850
> 
> 标签：cordova

```
 function getImage() {
        Retrieve image file location from specified source
        navigator.camera.MediaType.ALLMEDIA
        navigator.camera.getPicture(uploadPhoto, function(message) {
        alert('File Not Selected');
    },{
        quality: 50, 
        destinationType: navigator.camera.DestinationType.FILE_URI,
        sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY,
        mediaType: navigator.camera.MediaType.ALLMEDIA
    }
        );

    }

    function uploadPhoto(imageURI) {
        var options = new FileUploadOptions();
        options.fileKey="uploaded";
        options.fileName=imageURI.substr(imageURI.lastIndexOf('/')+1);
        options.mimeType="image/jpeg";

        var params = new Object();
        params.value1 = "test";
        params.value2 = "param";

        options.params = params;
        options.chunkedMode = false;

        var ft = new FileTransfer();
        ft.upload(imageURI, "abc.php", win, fail, options);
    }

    function win(r) {
        console.log("Code = " + r.responseCode);
        console.log("Response = " + r.response);
        console.log("Sent = " + r.bytesSent);
        alert(r.response);
    }

    function fail(error) {
        alert("An error has occurred: Code = " +error.code);
    } 
```

这可以通过 eclipse 在 android 模拟器上正常工作。当按下上传按钮并要求上传文件时；当在设备上运行 phonegap 创建 apk 文件时，它会失败，没有上传按钮工作。我还必须删除 phonegap.js。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-21T03:14:01.413

是否将相机插件添加到 config.xml 中？

```
<plugin name="Camera" value="org.apache.cordova.CameraLauncher" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-23T01:13:08.893

你说你必须删除 phonegap.js ？

如果这样做，您将无法访问任何设备 API，因为它们依赖于应用程序中特定于设备的 phonegap.js。这将在 PhoneGap Build 的构建时注入。

# asp.net - 使用 SessionID 访问 Asp.net 会话数据

> ID：15297277
> 
> 赞同：1
> 
> 时间：2013-03-08T15:18:31.890
> 
> 标签：asp.net, session

我正在做一个非常奇怪的技巧来在跨域的 php 页面中使用 asp.net。我有很多问题，但我以某种方式解决了所有问题。现在最后一个问题：

我需要读取仅具有 SessionID 的 asp.net 会话数据。

我已经在这里尝试了 swfupload 的作者的建议：http://web.archive.org/web/20120415034411/http: [//swfupload.org/forum/generaldiscussion/98](http://web.archive.org/web/20120415034411/http://swfupload.org/forum/generaldiscussion/98)

这减少了：

```
Dim cookie As HttpCookie = HttpContext.Current.Request.Cookies.Get("ASP.NET_SessionId")
cookie.Value = "mySessionID"
HttpContext.Current.Request.Cookies.Set(cookie) 
```

但是如果我在这之后检查 Session.SessionID 我仍然得到旧的会话值。我读过我应该使用“响应”在客户端上设置 cookie，但即使这样也不起作用：

```
Response.Cookies("ASP.NET_SessionId").Value = "mySessionID" 
```

在此之后仍然得到相同的 SessionID。

SessionID 是只读的，我不能用普通的 Session.SessionID = "myid" 覆盖它

即使这样，我也尝试过（但失败了）：

```
Dim ctx = HttpContext.Current
ctx.Response.Cookies.Remove("ASP.NET_SessionId")
ctx.Response.Cookies.Add(New HttpCookie("ASP.NET_SessionId", "mySessionID")) 
```

我怎样才能做到这一点？

**编辑**：我添加了另一个失败测试

```
Dim a, b As Boolean
Dim SM As New SessionIDManager
SM.InitializeRequest(HttpContext.Current, False, True)
SM.RemoveSessionID(HttpContext.Current)
SM.SaveSessionID(HttpContext.Current, "mySessionID", a, b) 
```

# perl - 对作为哈希键

> ID：15297279
> 
> 赞同：8
> 
> 时间：2013-03-08T15:18:37.137
> 
> 标签：perl, list, hash

有谁知道如何用成对的字符串作为 perl 中的键来制作散列？

就像是...

```
{
    ($key1, $key2) => $value1;
    ($key1, $key3) => $value2;
    ($key2, $key3) => $value3; 
```

ETC....

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T15:21:59.283

您不能将一对标量作为散列键，但可以创建多级散列：

```
my %hash;
$hash{$key1}{$key2} = $value1;
$hash{$key1}{$key3} = $value2;
$hash{$key2}{$key3} = $value3; 
```

如果你想一次定义它：

```
my %hash = ( $key1 => { $key2 => $value1, $key3 => $value2 },
             $key2 => { $key3 => $value3 } ); 
```

或者，如果它适用于您的情况，您可以将您的密钥连接在一起

```
$hash{$key1 . $key2} = $value1;   # etc 
```

或者添加分隔符来分隔键：

```
$hash{"$key1:$key2"} = $value1;   # etc 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T17:02:28.357

您可以使用[不可见的分隔符](http://en.wikipedia.org/wiki/Mapping_of_Unicode_characters#Mathematical_invisibles)来加入坐标：

> 主要用于数学，不可见分隔符 ( `U+2063`) 提供字符之间的分隔符，其中可以省略标点符号或空格，例如在二维索引`i⁣j`中。

```
#!/usr/bin/env perl

use utf8;
use v5.12;
use strict;
use warnings;
use warnings qw(FATAL utf8);
use open qw(:std :utf8);
use charnames qw(:full :short);

use YAML;

my %sparse_matrix = (
    mk_key(34,56) => -1,
    mk_key(1200,11) => 1,
);

print Dump \%sparse_matrix;

sub mk_key { join("\N{INVISIBLE SEPARATOR}", @_) }

sub mk_vec { map [split "\N{INVISIBLE SEPARATOR}"], @_ } 
```

```
~/tmp> perl mm.pl |xxd
0000000: 2d2d 2d0a 3132 3030 e281 a331 313a 2031 ---.1200...11: 1
0000010：0a33 34e2 81a3 3536 3a20 2d31 0a .34...56：-1。
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:20:40.177

我这样做：

```
{ "$key1\x1F$key2" => $value, ... } 
```

通常使用辅助方法：

```
sub getKey() {
    return join( "\x1F", @_ );
}

{ getKey( $key1, $key2 ) => $value, ... } 
```

**- - - 编辑 - - -**

[根据上面@chepner](https://stackoverflow.com/questions/15297279/pairs-as-hash-keys/15297310#comment21590632_15297343)的建议，更新了上面的代码以使用 ASCII 单元分隔符

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-08T16:22:57.610

*用法*：哈希中*单个值*的多个*键*可用于实现*2D 矩阵*或*N 维矩阵*！

 ***```
#!/usr/bin/perl -w
use warnings;
use strict;
use Data::Dumper;

my %hash = ();

my ($a, $b, $c) = (2,3,4);
$hash{"$a, $b ,$c"} = 1;
$hash{"$b, $c ,$a"} = 1;

foreach(keys(%hash) )
{
    my @a = split(/,/, $_);
    print Dumper(@a);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-09T04:50:14.467

使用[$;](http://perldoc.perl.org/perlvar.html#%24SUBSCRIPT_SEPARATOR) 隐式（或显式）在您的哈希键中，用于多维仿真，如下所示：

```
my %hash;
$hash{$key1, $key2} = $value; # or %hash = ( $key1.$;.$key2 => $value );
print $hash{$key1, $key2} # returns $value 
```

你甚至可以设置 $; 到 \x1F 如果需要（默认为 \034，来自 awk 中的 SUBSEP）：

```
local $; = "\x1F"; 
```***

# javascript - onfocus 在第二次点击后触发

> ID：15297281
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:18:44.210
> 
> 标签：javascript, jquery, html, popup, focus

我有一个输入字段，在它的焦点上应该看到一个注释。

```
<input type="text" name="contact_email" id="contact_email" onfocus="craateUserJsObject.showContactEmailNote();"/>
<div id="contact_email_note" class="info_box">Contact email note</div> 
```

jQuery代码是：

```
showContactEmailNote : function () {
                    var ContactEmail = jQuery('#contact_email');
                    if (typeof ContactEmail.focus(function()
                        {
                           {
                               $("#contact_email_note").show("slow");
                           }
                        }
                    ));
                    if (typeof ContactEmail.focusout(function()
                        {
                           {
                               $("#contact_email_note").hide("slow");
                           }
                        }
                    ));

                 } 
```

问题是 onfocus 事件仅在第二次单击输入字段后加载注释。onclick 事件也是如此。它如何加载到该领域的第一个焦点上？

谢谢，杜桑

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:25:48.740

用这个...

```
$('#contact_email').on('focus blur', function(){
    $("#contact_email_note").toggle("slow");
}); 
```

看看这个[**演示**](http://jsfiddle.net/yyuz6/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:25:53.547

您应该使用更简单的代码，例如：

**jQuery**

```
$('#contact_email').focusin(function() {
    $("#contact_email_note").show("slow");
}).focusout( function() {
    $("#contact_email_note").hide("slow");
}); 
```

请参阅工作[小提琴演示](http://jsfiddle.net/soyuka/wHdjq/)。

**编辑以仅显示一次注释**

```
var noteHasBeenShown = false;
$('#contact_email').focusin(function() {
    if(!noteHasBeenShown) {
        $("#contact_email_note").show("slow");
        noteHasBeenShown = true;
    }
}).focusout( function() {
    $("#contact_email_note").hide("slow");
}); 
```

**编辑以显示注释并且不隐藏它**

```
$('#contact_email').focusin(function() {
    $("#contact_email_note").show("slow");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:26:35.280

如果你试图发现一个事件的类型，你应该使用对象`type`的属性`event`，你在滥用`typeof`操作符，一个简单的事件监听器就可以了。

```
$('#contact_email').on('focus blur', function(event){
    $("#contact_email_note").toggle(event.type === 'focus');
}) 
```

# java - 协议缓冲区挑战

> ID：15297283
> 
> 赞同：4
> 
> 时间：2013-03-08T15:18:53.623
> 
> 标签：java, protocol-buffers

我正在开发一个使用协议缓冲区作为序列化程序的应用程序。我的应用程序将是服务器的客户端。要求是在发送 protobuf 数据之前，我必须在 protobuf 数据的大小前面加上 4 个字节。我使用 Netty 作为我的套接字库。我使用了 netty 的内置 protocolbuffer 编码器和解码器，但仍然没有得到正确的结果。这是我正在运行的代码：管道代码

```
public class SmpPipelineFactory implements ChannelPipelineFactory {

    private final Logger logger = LoggerFactory.getLogger(getClass());

    /**
     * 
     */
    public SmpPipelineFactory() {
    }

    @Override
    public ChannelPipeline getPipeline() throws Exception {
        ChannelPipeline p = pipeline();

        // Add Decoders
        p.addLast("frameDecoder", new ProtobufVarint32FrameDecoder());      
        //p.addLast("frameDecoder",  new LengthFieldBasedFrameDecoder(1048576, 0, 4, 0, 4));        
        p.addLast("protobufDecoder", new ProtobufDecoder(Pdu.getDefaultInstance()));

        // Add encoders
        p.addLast("frameEncoder", new ProtobufVarint32LengthFieldPrepender());
        //p.addLast("frameEncoder", new LengthFieldPrepender(4));
        p.addLast("protobufEncoder", new ProtobufEncoder());

        p.addLast("handler", new SmpChannelConnector());

        return p;
    }

} 
```

任何帮助都会有所帮助 谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T16:27:43.327

您需要更多地解释什么不适合您。如果我查看 protobuf RPC java 库 ( [https://code.google.com/p/protobuf-rpc-pro/](https://code.google.com/p/protobuf-rpc-pro/) ) 中的代码，则该类是 DuplexTcpClientPipelineFactory 或 DuplexTcpServerPipelineFactory，这与您的代码基本相同，并且它“作品”。也许 protobuf-rpc-pro 库已经可以满足您的需求。

```
public ChannelPipeline getPipeline() throws Exception {
    ChannelPipeline p = pipeline();

    RpcSSLContext ssl = bootstrap.getSslContext();
    if ( ssl != null ) {
            p.addLast(Handler.SSL, new SslHandler(ssl.createClientEngine()) );
    }

    p.addLast(Handler.FRAME_DECODER, new ProtobufVarint32FrameDecoder());
    p.addLast(Handler.PROTOBUF_DECODER, new ProtobufDecoder(DuplexProtocol.WirePayload.getDefaultInstance(),bootstrap.getExtensionRegistry()));

    p.addLast(Handler.FRAME_ENCODER, new ProtobufVarint32LengthFieldPrepender());
    p.addLast(Handler.PROTOBUF_ENCODER, new ProtobufEncoder());

    // the connectResponseHandler is swapped after the client connection
    // handshake with the RpcClient for the Channel
    p.addLast(Handler.CLIENT_CONNECT, new ClientConnectResponseHandler());

    return p;
} 
```

你的服务器是 netty 服务器，还是只是一个 netty 客户端？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T22:47:28.720

我已经解决了这个问题。我所做的是根据要交换的 protobuf 数据编写自己的编码器和解码器。这里的主要问题是通道上字节的字节序。

# php - 如何从文件中动态删除问号垃圾数据？

> ID：15297285
> 
> 赞同：2
> 
> 时间：2013-03-08T15:18:56.387
> 
> 标签：php, html, regex, perl, garbage

我有未知数量的文件散布着垃圾数据，我想动态删除所述垃圾数据，可能使用正则表达式。

在浏览器的 HTML 文件中，它通常看起来像这样：

> 这是文件的开头，��

在文件中，它将如下所示：

> 这是文件的开头，**xE2** **xA0**

我尝试使用正则表达式编辑器将其删除，但无济于事，它根本找不到它。如何删除这些垃圾数据？同样，一些文件具有各种 HTML 标记。

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:20:31.157

这些出现是因为您网站上的字符集有问题。

例如，您的文件以 Unicode 格式存储，但您的 Content-Type 设置为`text/html; charset=ISO-8859-1`. 问题也可能是文本如何存储在您的数据库中，或者文本如何在您的编程语言内部表示。

与其尝试去除它们，不如让字符集正确。这通常是一个令人沮丧的过程，因为有很多地方可能会引入问题。

你没有说你使用什么技术。一般可以通过“字符集问题mysql”等具体技术搜索如何解决字符集问题，找到解决方法。

我建议使用命令行工具，例如`file`检查文本文件存储在哪个字符集中`iconv`，并将文本文件从一个字符集转换为另一个字符集。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T16:28:50.097

有两种可能性。第一个不太可能是`0xe2 0xa0 ...`因为文档中有[盲文模式](http://www.utf8-chartable.de/unicode-utf8-table.pl?start=10240&number=128&names=-&utf8=0x)。

至于第二种可能性，`0xa0`是[`NBSP`](http://en.wikipedia.org/wiki/Non-breaking_space)。`0xe2`让我想起[ISO-8859-5](http://en.wikipedia.org/wiki/ISO/IEC_8859-5)。

是否有人从某些软件包的俄语版本中复制和粘贴内容？

此外，您可以[在 Windows 上获取和使用 iconv](http://en.wikipedia.org/wiki/Iconv#Ports)。

# json - 控制器不会将 json 转换为 viewmodel

> ID：15297288
> 
> 赞同：0
> 
> 时间：2013-03-08T15:19:09.563
> 
> 标签：json, asp.net-mvc-4, viewmodel

我将两个对象传递给我的控制器：

```
[HttpPost]
public ActionResult GetSelectedQuote(CarQuoteRequestViewModel carModel, QuoteViewModel quoteModel)
 {
      return PartialView("_QuoteSelected", quoteModel);
 } 
```

AJAX 调用如下（我对 JSON 字符串进行了硬编码，因此您可以看到它的外观，但通常我会使用 ser $.ajax("getSelectedQuote", {

```
 //data: ko.toJSON({ model: self.selectedQuote, model1: $("#etape").serializeArray() }),
            data:  ko.toJSON({"quoteModel":{"ProductName":"Classic","MonthPrice":98.19,"QuarterPrice":291.64,"BiannualPrice":577.37,"YearPrice":1142.94,
    "CoverQuotesViewModel":[
    {"ProductName":"Classic","Label":"ResponsabilitÃ© Civile","IsVisible":false,"IsMandatory":false,"IsSelected":false,"YearPrice":338.17,"BiannualPrice":170.83,"QuarterPrice":86.29,"MonthPrice":29.05},        
    {"ProductName":"Classic","Label":"PremiÃ¨re Assistance 24h/24 (GRATUITE)","IsVisible":false,"IsMandatory":false,"IsSelected":false,"YearPrice":0,"BiannualPrice":0,"QuarterPrice":0,"MonthPrice":0},
    {"ProductName":"Classic","Label":"Dommage (DM TCC 0%)","IsVisible":false,"IsMandatory":false,"IsSelected":false,"YearPrice":717.47,"BiannualPrice":362.44,"QuarterPrice":183.07,"MonthPrice":61.64},
    {"ProductName":"Classic","Label":"Individuelle Circulation","IsVisible":false,"IsMandatory":false,"IsSelected":false,"YearPrice":67.9,"BiannualPrice":34.3,"QuarterPrice":17.33,"MonthPrice":5.83},
    {"ProductName":"Classic","Label":"Protection Juridique","IsVisible":false,"IsMandatory":false,"IsSelected":false,"YearPrice":19.4,"BiannualPrice":9.8,"QuarterPrice":4.95,"MonthPrice":1.67}
    ]},

"carModel": [
        {"name":"DriverInfoViewModel.DriverInfo.NoClaimsDegree","value":"1"},
            {"name":"DriverInfoViewModel.DriverInfo.DrivingLicenceDate","value":"2013-03-02"},
            {"name":"DriverInfoViewModel.DriverInfo.DisasterHistory","value":"MoreThanTwoDisasters"},
            {"name":"CarInfoViewModel.CarInfo.CarValue","value":"15000"},
            {"name":"CarInfoViewModel.CarInfo.AudioValue","value":"1000"},
            {"name":"CarInfoViewModel.CarInfo.EngineCapacity","value":"1500"},
            {"name":"CarInfoViewModel.CarInfo.AdditionalSeats","value":"1"},
            {"name":"CarInfoViewModel.CarInfo.FirstRegistration","value":"2013-03-02"}
       ]}),
            type: "post", contentType: "application/json",
            success: function (result) {
                $("#custom").html(result);
                $("#etape").formwizard("show", "customize");
            }
        }); 
```

奇怪的是，当控制器被击中时，QuoteViewModel 完全重建。但是 CarQuoteRequestViewModel 对象不是。属性为空。

ViewModel 对象如下：

```
public class CarQuoteRequestViewModel : QuoteRequestViewModel
{       
    public CarInfoViewModel CarInfoViewModel { get; set; }
    public DriverInfoViewModel DriverInfoViewModel { get; set; }

    public CarQuoteRequestViewModel()
    {
        CarInfoViewModel = new CarInfoViewModel();
        DriverInfoViewModel = new DriverInfoViewModel();
    }
}

public class QuoteViewModel
{
    public string ProductName { get; set; }
    public decimal MonthPrice { get; set; }
    public decimal QuarterPrice { get; set; }
    public decimal BiannualPrice { get; set; }
    public decimal YearPrice { get; set; }

    public List<CoverQuoteViewModel> CoverQuotesViewModel { get; set; }
} 
```

我暂时不发布所有嵌套对象，因为它适用于 QuoteViewModel。您知道来自 JSON 的 CarQuoteRequestViewModel 映射可能有什么问题吗？

**编辑**

根据 Darin 的建议，我已将 JSON 更改为：

```
 data: ko.toJSON({ "model": { "ProductName": "Classic", "MonthPrice": 98.19, "QuarterPrice": 291.64, "BiannualPrice": 577.37, "YearPrice": 1142.94,
                "CoverQuotesViewModel": [
    { "ProductName": "Classic", "Label": "ResponsabilitÃ© Civile", "IsVisible": false, "IsMandatory": false, "IsSelected": false, "YearPrice": 338.17, "BiannualPrice": 170.83, "QuarterPrice": 86.29, "MonthPrice": 29.05 },
    { "ProductName": "Classic", "Label": "PremiÃ¨re Assistance 24h/24 (GRATUITE)", "IsVisible": false, "IsMandatory": false, "IsSelected": false, "YearPrice": 0, "BiannualPrice": 0, "QuarterPrice": 0, "MonthPrice": 0 },
    { "ProductName": "Classic", "Label": "Dommage (DM TCC 0%)", "IsVisible": false, "IsMandatory": false, "IsSelected": false, "YearPrice": 717.47, "BiannualPrice": 362.44, "QuarterPrice": 183.07, "MonthPrice": 61.64 },
    { "ProductName": "Classic", "Label": "Individuelle Circulation", "IsVisible": false, "IsMandatory": false, "IsSelected": false, "YearPrice": 67.9, "BiannualPrice": 34.3, "QuarterPrice": 17.33, "MonthPrice": 5.83 },
    { "ProductName": "Classic", "Label": "Protection Juridique", "IsVisible": false, "IsMandatory": false, "IsSelected": false, "YearPrice": 19.4, "BiannualPrice": 9.8, "QuarterPrice": 4.95, "MonthPrice": 1.67 }
    ]
            },

                "model1":
        { "DriverInfoViewModel.DriverInfo.NoClaimsDegree" : "1",
            "DriverInfoViewModel.DriverInfo.DrivingLicenceDate" : "2013-03-02",
             "DriverInfoViewModel.DriverInfo.DisasterHistory" : "MoreThanTwoDisasters",
            "CarInfoViewModel.CarInfo.CarValue": "15000",
            "CarInfoViewModel.CarInfo.AudioValue" : "1000",
            "CarInfoViewModel.CarInfo.EngineCapacity" : "1500",
            "CarInfoViewModel.CarInfo.AdditionalSeats" : "1",
            "CarInfoViewModel.CarInfo.FirstRegistration" : "2013-03-02"
        }
            }), 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:22:17.100

在您的 JSON 中，您正在传递具有属性`Name`和的对象的集合（注意方括号） `Value`：

```
"carModel": [ ... ] 
```

但是您的控制器操作需要一个`CarQuoteRequestViewModel`.

因此，要么修复您的 JSON 请求，要么如果您想发送多辆汽车，请确保您在控制器操作中使用正确的类型。

我在您的 上看不到任何 Name 和 Value 属性`CarQuoteRequestViewModel`，因此即使您更改控制器操作以收集`CarQuoteRequestViewModel`它也不太可能起作用。您传递的 JSON 必须符合您的模型。

如果你想保留你的`CarQuoteRequestViewModel`，你应该修复你的 JSON：

```
"carModel": {
    "carInfoViewModel": {
        ...
    },
    "driverInfoViewModel": {
        ...
    }
} 
```

* * *

更新：

看起来您正试图将某些表单元素 ( `$('#etape')`) 序列化为 JSON。您不应该使用该`serializeArray`方法，因为正如我已经解释过的那样，该方法会生成不正确的 JSON。你得到一个名称/值集合。您可以使用中`serializeObject`所示的方法[`this post`](https://stackoverflow.com/a/1186309/29407)。

# python - 如何使用线程和队列处理聊天客户端？

> ID：15297296
> 
> 赞同：0
> 
> 时间：2013-03-08T15:19:57.700
> 
> 标签：python, multithreading, chat

我现在遇到的问题是关于这个聊天客户端的问题，我已经尝试了好几天了。应该是我原来的聊天客户端的升级版，只有先收到消息才能回复人。

因此，在四处询问和研究人员后，我决定使用 select.select 来处理我的客户。

问题是它和往常一样有同样的问题。

****循环在接收时卡住了，直到它接收到一些东西才会完成****

这是我到目前为止写的：

```
import select
import sys #because why not?
import threading
import queue

print("New Chat Client Using Select Module")

HOST = input("Host: ")
PORT = int(input("Port: "))

s = socket(AF_INET,SOCK_STREAM)

print("Trying to connect....")
s.connect((HOST,PORT))
s.setblocking(0)
# Not including setblocking(0) because select handles that. 
print("You just connected to",HOST,)

# Lets now try to handle the client a different way!

while True:
    #     Attempting to create a few threads
    Reading_Thread = threading.Thread(None,s)
    Reading_Thread.start()
    Writing_Thread = threading.Thread()
    Writing_Thread.start()

    Incoming_data = [s]
    Exportable_data = []

    Exceptions = []
    User_input = input("Your message: ")

    rlist,wlist,xlist = select.select(Incoming_data,Exportable_data,Exceptions)

    if User_input == True:
        Exportable_data += [User_input] 
```

您可能想知道为什么我在那里有线程和队列。

那是因为人们告诉我我可以通过使用线程和队列来解决问题，但是在阅读了文档之后，寻找与我的案例相匹配的视频教程或示例。我仍然完全不知道如何使用它们来使我的客户工作。

有人可以帮我吗？我只需要找到一种方法让客户尽可能多地输入消息，而无需等待回复。这只是我尝试的方法之一。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:26:15.983

通常你会创建一个函数，你的`While True`循环在其中运行并可以接收数据，它可以将数据写入主线程可以访问的某个缓冲区或队列。

您需要同步对此队列的访问以避免数据竞争。

我对 Python 的线程 API 不太熟悉，但是创建一个在线程中运行的函数并不难。让我找一个例子。

事实证明，您可以创建一个具有该类派生自的函数的类`threading.Thread`。然后你可以创建你的类的一个实例并以这种方式启动线程。

```
class WorkerThread(threading.Thread):

    def run(self):
        while True:
            print 'Working hard'
            time.sleep(0.5)

def runstuff():
    worker = WorkerThread()
    worker.start() #start thread here, which will call run() 
```

您还可以使用更简单的 API 并创建一个函数并调用`thread.start_new_thread(fun, args)`它，这将在线程中运行该函数。

```
def fun():
    While True:
        #do stuff

thread.start_new_thread(fun) #run in thread. 
```

# c# - 如何在 C# 程序中访问 LINQ 中 Select 实例的输出值

> ID：15297297
> 
> 赞同：0
> 
> 时间：2013-03-08T15:19:59.807
> 
> 标签：c#, sql, linq, c#-4.0

我是编写存储过程的新手。所以我写了下面的程序，想在我的程序中访问输出值，很热。

我的存储过程：

```
Create Procedure [dbo].[STP_ExecCarInDriver_SelectByCarCode]
@CarCode nchar(10)
As
Begin

SELECT DISTINCT
[MachineName]
,[FirstName]
,[LastName]
FROM [RoadTrs].[dbo].[ViewExecCarInDriver]
WHERE [CarCode]=@CarCode

End 
```

并尝试使用以下代码实例化 MachineName、FirstName 和 Last Name 参数：

```
var Results = rt.STP_ExecCarInDriver_SelectByCarCode(txtCarCode.Text);
string MachineName= Results(0). 
```

但它不起作用！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:35:44.750

如果您使用的是 LinqtoSql，我建议您完全不要使用存储的过程（它们会成为管理恕我直言的麻烦）

而是使用数据上下文来获取项目

```
int carcode = 0; //input your code here

var ctx = new RoadTrsDataContext();
var item - ctx.ViewExecCarInDriver.Where(x=>x.CarCode == carcode).FirstOrDefault();
ctx.Dispose();

if(item!= null)
{
var name = item.FirstName;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:28:42.703

使用以下：

```
 var Results = rt.STP_ExecCarInDriver_SelectByCarCode(txtCarCode.Text).FirstOrDefault();//Use .List() if query return more than one result.
        string MachineName = Results.MachineName;
        string FirstName = Results.FirstName;
        string LastName = Results.LastName; 
```

# android - Onclick 时谷歌地图崩溃

> ID：15297319
> 
> 赞同：1
> 
> 时间：2013-03-08T15:21:00.163
> 
> 标签：android, crash, onclick, maps

我目前正在编码一个谷歌地图应用程序。我有一个带有地图片段和 MapActivity 的 XML 文件。如果用户单击地图，我尝试添加标记，但应用程序崩溃。

我试图解决这个问题几个小时，但我只是没有任何线索。

最好的问候迈克尔

```
package de.arvidg.exampleactionbartabs;

import java.util.ArrayList;
import java.util.List;

import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.GooglePlayServicesUtil;
import com.google.android.gms.maps.CameraUpdateFactory;
import com.google.android.gms.maps.GoogleMap;
import com.google.android.gms.maps.GoogleMap.OnMapLongClickListener;
import com.google.android.gms.maps.MapFragment;
//import com.google.android.gms.maps.SupportMapFragment;
import com.google.android.gms.maps.GoogleMap.OnMapClickListener;
import com.google.android.gms.maps.model.LatLng;
import com.google.android.gms.maps.model.MarkerOptions;
import com.google.android.maps.MapActivity;
import com.google.android.maps.MapView;
import com.google.android.maps.Overlay;

import android.app.Activity;
import android.app.AlertDialog;
import android.app.FragmentManager;
import android.location.Location;
import android.os.Bundle;
//import android.support.v4.app.FragmentActivity;
//import android.support.v4.app.FragmentManager;
import android.view.Menu;
import android.view.MenuItem;
import android.widget.TextView;
import android.widget.Toast;

public class MapFrag extends MapActivity implements OnMapClickListener{

    private GoogleMap myMap;

    private MapFragment mapView;

    private MyItemizedOverlay myItemizedOverlay = null;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.map);

        GoogleMap map = ((MapFragment) getFragmentManager().findFragmentById(
                R.id.map)).getMap();

        mapView=((MapFragment) getFragmentManager().findFragmentById(
                R.id.map));

        map.setMyLocationEnabled(true);

        map.setTrafficEnabled(true);

        map.addMarker(new MarkerOptions()
        .position(new LatLng(40.417325, 40.417325))
        .title("Hello!"));

        map.setOnMapClickListener(this);
    }   

    @Override
    protected boolean isRouteDisplayed() {
        // TODO Auto-generated method stub
        return false;
    }

    @Override
    public void onMapClick(LatLng point) {
        myMap.addMarker(new MarkerOptions().position(point).title("jojoa"));

    }

} 
```

日志输出：

```
03-08 16:20:38.500: I/Adreno200-EGL(10598): Build Date: 07/31/12 Tue
03-08 16:20:38.500: I/Adreno200-EGL(10598): Local Branch: 
03-08 16:20:38.500: I/Adreno200-EGL(10598): Remote Branch: quic/master
03-08 16:20:38.500: I/Adreno200-EGL(10598): Local Patches: NONE
03-08 16:20:38.500: I/Adreno200-EGL(10598): Reconstruct Branch: AU_LINUX_ANDROID_JB.04.01.01.00.036 +  NOTHING
03-08 16:20:38.540: D/OpenGLRenderer(10598): Enabling debug mode 0
03-08 16:20:38.550: I/MapActivity(10598): Handling network change notification:CONNECTED
03-08 16:20:38.550: E/MapActivity(10598): Couldn't get connection factory client
03-08 16:20:38.920: D/dalvikvm(10598): GC_FOR_ALLOC freed 3301K, 46% free 6748K/12288K, paused 29ms, total 29ms
03-08 16:20:38.930: W/CursorWrapperInner(10598): Cursor finalized without prior close()
03-08 16:20:40.050: D/AndroidRuntime(10598): Shutting down VM
03-08 16:20:40.050: W/dalvikvm(10598): threadid=1: thread exiting with uncaught exception (group=0x40d71300)
03-08 16:20:40.060: E/AndroidRuntime(10598): FATAL EXCEPTION: main
03-08 16:20:40.060: E/AndroidRuntime(10598): java.lang.NullPointerException
03-08 16:20:40.060: E/AndroidRuntime(10598):    at de.arvidg.exampleactionbartabs.MapFrag.onMapClick(MapFrag.java:75)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at com.google.android.gms.maps.GoogleMap$6.onMapClick(Unknown Source)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at com.google.android.gms.internal.t$a.onTransact(Unknown Source)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at android.os.Binder.transact(Binder.java:326)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at com.google.android.gms.maps.internal.IOnMapClickListener$Stub$Proxy.onMapClick(IOnMapClickListener.java:93)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at maps.i.s.b(Unknown Source)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at maps.y.v.c(Unknown Source)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at maps.y.bf.onSingleTapConfirmed(Unknown Source)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at maps.d.v.onSingleTapConfirmed(Unknown Source)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at maps.d.j.handleMessage(Unknown Source)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at android.os.Handler.dispatchMessage(Handler.java:99)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at android.os.Looper.loop(Looper.java:137)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at android.app.ActivityThread.main(ActivityThread.java:4978)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at java.lang.reflect.Method.invokeNative(Native Method)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at java.lang.reflect.Method.invoke(Method.java:511)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
03-08 16:20:40.060: E/AndroidRuntime(10598):    at dalvik.system.NativeStart.main(Native Method)
03-08 16:20:41.240: I/Process(10598): Sending signal. PID: 10598 SIG: 9 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:32:52.653

`GoogleMap map = ((MapFragment)getFragmentManager().findFragmentById(R.id.map)).getMap()`正在引发 NullPointerException，当它被单击时。

确保使用的 id 与 XML 文件中定义的相同。

# image - 更改位图的像素颜色

> ID：15297320
> 
> 赞同：8
> 
> 时间：2013-03-08T15:21:01.017
> 
> 标签：image, delphi

如果它是白色的，我正在尝试更改位图的像素颜色。我写了以下代码。但它非常慢！我想检查一个像素的颜色是否为白色，如果是白色，请将颜色更改为黑色。

有人可以提出更好的方法吗？

```
procedure TForm1.Button1Click(Sender: TObject);
var
  BitMap1 : TBitmap;
  X, Y, Size : Integer;

  P: Cardinal;
begin
  BitMap1 := TBitmap.Create;
  bitMap1.LoadFromFile('image1.bmp');

  for Y := 0 to Bitmap1.Height - 1 do
  begin
    for X := 0 to Bitmap1.width  * size - 1 do
    begin
    p := BitMap1.Canvas.Pixels[X,Y];
    if p = 255 then
      BitMap1.Canvas.Pixels[X,Y] := 0;

    end;
  end;

  Image1.Picture.Assign(BitMap1);
end; 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T15:28:43.717

请务必使用该属性来访问位图像素，因为您正在使用访问速度较慢[`ScanLine`](http://docwiki.embarcadero.com/Libraries/XE7/en/Vcl.Graphics.TBitmap.ScanLine)的大量像素。[`Pixels`](http://docwiki.embarcadero.com/Libraries/XE7/en/Vcl.Graphics.TCustomCanvas.Pixels)为了用支持 24 位和 32 位位图来替换您选择的颜色，我会使用这样的东西：

```
procedure ReplaceColor(ABitmap: TBitmap; ASource, ATarget: TColor);
type
  TRGBBytes = array[0..2] of Byte;
var
  I: Integer;
  X: Integer;
  Y: Integer;
  Size: Integer;
  Pixels: PByteArray;
  SourceColor: TRGBBytes;
  TargetColor: TRGBBytes;
const
  TripleSize = SizeOf(TRGBBytes);
begin
  case ABitmap.PixelFormat of
    pf24bit: Size := TripleSize;
    pf32bit: Size := SizeOf(TRGBQuad);
  else
    raise Exception.Create('Bitmap must be 24-bit or 32-bit format!');
  end;

  for I := 0 to TripleSize - 1 do
  begin
    // fill the array of bytes with color channel values in BGR order,
    // the same would do for the SourceColor from ASource parameter:
    // SourceColor[0] := GetBValue(ASource);
    // SourceColor[1] := GetGValue(ASource);
    // SourceColor[2] := GetRValue(ASource);
    // but this is (just badly readable) one liner
    SourceColor[I] := Byte(ASource shr (16 - (I * 8)));
    // the same do for the TargetColor array from the ATarget parameter
    TargetColor[I] := Byte(ATarget shr (16 - (I * 8)));
  end;

  for Y := 0 to ABitmap.Height - 1 do
  begin
    // get a pointer to the currently iterated row pixel byte array
    Pixels := ABitmap.ScanLine[Y];
    // iterate the row horizontally pixel by pixel
    for X := 0 to ABitmap.Width - 1 do
    begin
      // now imagine, that you have an array of bytes in which the groups of
      // bytes represent a single pixel - e.g. the used Pixels array for the
      // first 2 pixels might look like this for 24-bit and 32-bit bitmaps:

      // Pixels   [0][1][2]     [3][4][5]
      // 24-bit    B  G  R       B  G  R
      // Pixels   [0][1][2][3]  [4][5][6][7]
      // 32-bit    B  G  R  A    B  G  R  A

      // from the above you can see that you'll need to multiply the current
      // pixel iterator by the count of color channels to point to the first
      // (blue) color channel in that array; and that's what that (X * Size)
      // is for here; X is a pixel iterator, Size is size of a single pixel:          

      // X * 3    (0 * 3)       (1 * 3)
      //           ⇓             ⇓
      // Pixels   [0][1][2]     [3][4][5]
      // 24-bit    B  G  R       B  G  R

      // X * 4    (0 * 4)       (1 * 4)
      //           ⇓             ⇓
      // Pixels   [0][1][2][3]  [4][5][6][7]
      // 32-bit    B  G  R  A    B  G  R  A

      // so let's compare a BGR value starting at the (X * Size) position of
      // the Pixels array with the SourceColor array and if it matches we've
      // found the same colored pixel, if so then...
      if CompareMem(@Pixels[(X * Size)], @SourceColor, TripleSize) then
        // copy the TargetColor color byte array values to that BGR position
        // (in other words, replace the color channel bytes there)
        Move(TargetColor, Pixels[(X * Size)], TripleSize);
    end;
  end;
end; 
```

以及用法：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  Bitmap: TBitmap;
begin
  Bitmap := TBitmap.Create;
  try
    Bitmap.LoadFromFile('d:\Image.bmp');
    ReplaceColor(Bitmap, clWhite, clBlack);
    Image1.Picture.Assign(Bitmap);
  finally
    Bitmap.Free;
  end;
end; 
```

* * *

对于纯 GDI 和最多具有 256 种颜色的位图，您可以使用该[`CreateMappedBmp`](http://docwiki.embarcadero.com/Libraries/XE7/en/Vcl.Graphics.CreateMappedBmp)函数。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-08T15:29:15.540

您应该为此使用扫描线。例子：

```
procedure ChangeWhiteToBlack(var Bitmap: TBitmap);
var
  scanline: PRGBTriple;
  y: Integer;
  x: Integer;
begin
  Assert(Bitmap.PixelFormat = pf24bit);
  for y := 0 to Bitmap.Height - 1 do
  begin
    scanline := Bitmap.ScanLine[y];
    for x := 0 to Bitmap.Width - 1 do
    begin
      with scanline^ do
      begin
        if (rgbtBlue = 255) and (rgbtGreen = 255) and (rgbtRed = 255) then
          FillChar(scanline^, sizeof(TRGBTriple), 0);
      end;
      inc(scanline);
    end;
  end;
end; 
```

试试这个：

```
procedure TForm5.FormCreate(Sender: TObject);
var
  bm: TBitmap;
begin
  bm := TBitmap.Create;
  try
    bm.LoadFromFile('C:\Users\Andreas Rejbrand\Desktop\test.bmp');
    ChangeWhiteToBlack(bm);
    bm.SaveToFile('C:\Users\Andreas Rejbrand\Desktop\test2.bmp');
  finally
    bm.Free;
  end;
end; 
```

**更新：**您只需要对代码进行非常小的修改即可使其在 32 位位图上工作：

```
procedure ChangeWhiteToBlack32(var Bitmap: TBitmap);
var
  scanline: PRGBQuad;
  y: Integer;
  x: Integer;
begin
  Assert(Bitmap.PixelFormat = pf32bit);
  for y := 0 to Bitmap.Height - 1 do
  begin
    scanline := Bitmap.ScanLine[y];
    for x := 0 to Bitmap.Width - 1 do
    begin
      with scanline^ do
      begin
        if (rgbBlue = 255) and (rgbGreen = 255) and (rgbRed = 255) then
          FillChar(scanline^, sizeof(TRGBQuad), 0);
      end;
      inc(scanline);
    end;
  end;
end; 
```

事实上，你可以做

```
procedure ChangeWhiteToBlack24(var Bitmap: TBitmap);
var
  scanline: PRGBTriple;
  y: Integer;
  x: Integer;
begin
  Assert(Bitmap.PixelFormat = pf24bit);
  for y := 0 to Bitmap.Height - 1 do
  begin
    scanline := Bitmap.ScanLine[y];
    for x := 0 to Bitmap.Width - 1 do
    begin
      with scanline^ do
      begin
        if (rgbtBlue = 255) and (rgbtGreen = 255) and (rgbtRed = 255) then
          FillChar(scanline^, sizeof(TRGBTriple), 0);
      end;
      inc(scanline);
    end;
  end;
end;

procedure ChangeWhiteToBlack32(var Bitmap: TBitmap);
var
  scanline: PRGBQuad;
  y: Integer;
  x: Integer;
begin
  Assert(Bitmap.PixelFormat = pf32bit);
  for y := 0 to Bitmap.Height - 1 do
  begin
    scanline := Bitmap.ScanLine[y];
    for x := 0 to Bitmap.Width - 1 do
    begin
      with scanline^ do
      begin
        if (rgbBlue = 255) and (rgbGreen = 255) and (rgbRed = 255) then
          FillChar(scanline^, sizeof(TRGBQuad), 0);
      end;
      inc(scanline);
    end;
  end;
end;

procedure ChangeWhiteToBlack(var Bitmap: TBitmap);
begin
  case Bitmap.PixelFormat of
    pf24bit: ChangeWhiteToBlack24(Bitmap);
    pf32bit: ChangeWhiteToBlack32(Bitmap);
  else
    raise Exception.Create('Pixel format must be pf24bit or pf32bit.');
  end;
end; 
```

如果您不想制作一个同时适用于 24 位和 32 位位图的过程，就像`TLama`以前那样。[拥有两个独立程序的一个好处是这些简短的程序更易于阅读（和维护）。]

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-10-13T18:25:01.767

```
procedure TForm1.Button1Click(Sender: TObject);
var
  BitMap1,
  BitMap2 : TBitmap;
  X, Y, Size : Integer;

  P: Cardinal;
begin
  BitMap1 := TBitmap.Create;
  BitMap1.LoadFromFile('image1.bmp');
  BitMap1.Transparent := true;
  BitMap1.TransparentColor := clWhite; // old color

  BitMap2 := TBitMap.Create;
  BitMap2.Height := BitMap1.Height;
  BitMap2.Width := BitMap1.Width;
  BitMap2.Canvas.Brush.Color := clBlack; // new color
  BitMap2.Canvas.FillRect(
   Rect(
     0,
     0,
     BitMap2.Width,
     BitMap2.Height
    )
  );

  BitMap2.Canvas.Draw(BitMap1);

  Image1.Picture.Assign(BitMap2);

  BitMap1.Free;
  BitMap2.Freel
end; 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-03-01T10:01:42.403

```
 private void btnLoad2_Click(object sender, System.EventArgs e)
    {
        Bitmap myBitmap= new Bitmap(openFileDialog1.FileName);
        Bitmap myBitmap1 = new Bitmap("C:\\Documents and Settings\\Lalji\\Desktop\\image.png");
        for (int x = 0; x < myBitmap.Width; x++)
        {
            for (int y = 0; y < myBitmap.Height; y++)
            {
                // Get the color of a pixel within myBitmap.
                Color pixelColor = myBitmap.GetPixel(x, y);
                string pixelColorStringValue =
                    pixelColor.R.ToString("D3") + " " +
                    pixelColor.G.ToString("D3") + " " +
                    pixelColor.B.ToString("D3") + ", ";
                if (pixelColor.R.Equals(0) && pixelColor.G.Equals(0) && pixelColor.B.Equals(0))
                {
                    //MessageBox.Show("black pixel");
                }

                else if (pixelColor.R.Equals(255) && pixelColor.G.Equals(255) && pixelColor.B.Equals(255))
                {
                    //MessageBox.Show("white pixel");
                    myBitmap1.SetPixel(x, y, Color.White);
                }
                //switch (pixelColorStringValue)
                //{
                //    case "255 255 255":
                //        {
                //            // white pixel
                //            MessageBox.Show("white pixel");
                //            break;
                //        }
                //    case "000 000 000,":
                //        {
                //            // black pixel
                //           MessageBox.Show("black pixel");
                //            break;
                //        }
                //}
            }
        }

        myBitmap1.Save("C:\\Documents and Settings\\Lalji\\Desktop\\image1.png");
        MessageBox.Show("Process done");
    } 
```

# python-2.7 - 等到 Jenkins 构建完成

> ID：15297322
> 
> 赞同：10
> 
> 时间：2013-03-08T15:21:14.563
> 
> 标签：python-2.7, jenkins

我正在使用 Python 2.7 和 Jenkins。

我正在用 Python 编写一些代码，这些代码将执行签入并等待/轮询以完成 Jenkins 作业。我想对我是如何实现它的一些想法。

1.  在 Perforce 中创建签入的 Python 函数-> 这可以很容易地完成，因为 P4 有 CLI
2.  用于检测何时触发构建的 Python 代码 -> 我有更改列表和作业编号。如何轮询构建日志的 Jenkins API 以检查它是否具有适当的更改列表？此步骤的输出是执行作业的构建 url
3.  我如何等到詹金斯的工作完成？

我可以使用来自 Jenkins Rest API 或 Python Jenkins 模块的片段吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-08-27T00:12:29.390

如果您需要知道作业是否完成，则 buildNumber 和 buildTimestamp 是不够的。

这是我如何确定工作是否完成的要点，我在 ruby​​ 中有它，但在 python 中没有，所以也许有人可以将它更新为真正的代码。

```
lastBuild = get jenkins/job/myJob/lastBuild/buildNumber
get jenkins/job/myJob/lastBuild/build?token=gogogo

currentBuild = get jenkins/job/myJob/lastBuild/buildNumber
while currentBuild  == lastBuild 
  sleep 1 

thisBuild = get jenkins/job/myJob/lastBuild/buildNumber
buildInfo = get jenkins/job/myJob/[thisBuild]/api/xml?depth=0

while buildInfo["freeStyleBuild/building"] == true
  buildInfo = get jenkins/job/myJob/[thisBuild]/api/xml?depth=0
  sleep 1 
```

IE。我发现我需要 A）等到构建开始（新版本号）和 B）等到构建完成（构建是错误的）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-11T13:59:57.573

您可以查询上次构建时间戳以确定构建是否完成。将其与触发构建之前的状态进行比较，并查看它何时发生变化。要获取时间戳，请添加`/lastBuild/buildTimestamp`到您的工作 URL

事实上，在你的 Jenkins 中，添加`/lastBuild/api/`到任何 Job 中，你都会看到很多 API 信息。它甚至有 Python API，但我不熟悉，所以不能进一步帮助你

但是，如果您使用的是 XML，则可以在 XML 中添加`lastBuild/api/xml?depth=0`和查看`<changeSet>`触发构建的修订/提交消息列表的对象

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-02-26T10:04:14.003

*使用invoke*和*block_until_complete*方法的简单解决方案（使用 Python 3.7 测试）

```
import jenkinsapi
from jenkinsapi.jenkins import Jenkins

...

server = Jenkins(jenkinsUrl, username=jenkinsUser,
                 password=jenkinsToken, ssl_verify=sslVerifyFlag)

job = server.create_job(jobName, None)
queue = job.invoke()
queue.block_until_complete() 
```

受到 pycontribs 中的[一种测试方法的启发](https://github.com/pycontribs/jenkinsapi/blob/master/jenkinsapi_tests/systests/test_invocation.py#L51)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-31T11:46:13.263

此代码段开始构建作业并等待作业完成。

开始工作很容易，但我们需要某种逻辑来知道工作何时完成。首先，我们需要等待作业 ID 被应用，然后我们可以查询作业以获取详细信息：

```
from jenkinsapi import jenkins

server = jenkins.Jenkins(jenkinsurl, username=username, password='******')
job = server.get_job(j_name)
prev_id = job.get_last_buildnumber()
server.build_job(j_name)
while True:
    print('Waiting for build to start...')
    if prev_id != job.get_last_buildnumber():
        break
    time.sleep(3)
print('Running...')
last_build = job.get_last_build()
while last_build.is_running():
    time.sleep(1)
print(str(last_build.get_status())) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-08-27T20:01:34.387

不知道在提问时这是否可用，但 jenkinsapi 模块的 Job.invoke() 和/或 Jenkins.build_job() 返回一个 QueueItem 对象，该对象可以是 block_until_building() 或 block_until_complete()

```
jobq = server.build_job(job_name, job_params)
jobq.block_until_building()
print("Job %s (%s) is building." % (jobq.get_job_name(), jobq.get_build_number()))
jobq.block_until_complete(5) # check every 5s instead of the default 15
print("Job complete, %s" % jobq.get_build().get_status()) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-07-27T11:46:48.303

正在经历同样的问题，这对我有用，使用`python3`and `python-jenkins`.

```
while "".join([d['color'] for d in j.get_jobs() if d['name'] == "job_name"]) == 'blue_anime':
        print('Job is Running')
        time.sleep(1)

print('Job Over!!') 
```

工作 Github 脚本：[链接](https://github.com/Chandan-Nayak/stackoverflow-files/blob/master/15297322.py)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2018-07-17T21:26:13.487

这对我有用

```
#!/usr/bin/env python

import jenkins
import time

server = jenkins.Jenkins('https://jenkinsurl/', username='xxxxx', password='xxxxxx')

j_name = 'test'
server.build_job(j_name, {'testparam1': 'test', 'testparam2': 'test'})
while True:
    print('Running....')
    if server.get_job_info(j_name)['lastCompletedBuild']['number'] == server.get_job_info(j_name)['lastBuild']['number']:
        print "Last ID %s, Current ID %s"  % (server.get_job_info(j_name)['lastCompletedBuild']['number'], server.get_job_info(j_name)['lastBuild']['number'])
        break
time.sleep(3)
print('Stop....')

console_output = server.get_build_console_output(j_name, server.get_job_info(j_name)['lastBuild']['number'])
print console_output 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-01-26T17:59:29.227

build_job 不返回作业编号的问题主要问题，返回队列项目的编号（仅持续 5 分钟）。所以诀窍是

1.  build_job
2.  获取队列号，
3.  使用队列号获取 job_number
4.  现在我们知道了工作的名称和工作编号
5.  get_job_info 并循环这些工作，直到我们找到一个带有我们工作编号的工作
6.  检查状态

所以我用time_out为它做了一个函数

```
import time
from datetime import datetime, timedelta
import jenkins

def launch_job(jenkins_connection, job_name, parameters={}, wait=False, interval=30,  time_out=7200):
    """
    Create a jenkins job and waits for the job to finish
    :param jenkins_connection: jenkins server jenkins object
    :param job_name: the name of job we want to create and see if finish string
    :param parameters: the parameters of the job to build directory
    :param wait: if we want to wait for the job to finish or not bool
    :param interval: how often we want to monitor seconds int
    :param time_out: break the loop after certain X seconds int
    :return: build job number int
    """
    # we lunch the job and returns a queue_id
    job_id = jenkins_connection.build_job(job_name, parameters)
    # from the queue_id we get the job number that was created
    queue_job = jenkins_connection.get_queue_item(job_id, depth=0)
    build_number = queue_job["executable"]["number"]
    print(f"job_name: {job_name} build_number: {build_number}")
    if wait is True:
        now = datetime.now()
        later = now + timedelta(seconds=time_out)

        while True:
            # we check current time vs the timeout(later)
            if datetime.now() > later:
                raise ValueError(f"Job: {job_name}:{build_number} is running for more than {time_out} we"
                                 f"stop monitoring the job,  you can check it in Jenkins")
            b = jenkins_connection.get_job_info(job_name, depth=1, fetch_all_builds=False)
            for i in b["builds"]:
                loop_id = i["id"]
                if int(loop_id) == build_number:
                    result = (i["result"])
                    print(f"result: {result}")  # in the json looks like null
                    if result is not None:
                        return i
                        # break
            time.sleep(interval)
        # return result

    return build_number 
```

在我们要求詹金斯构建作业>获取队列#>获取作业#>循环信息并获取状态直到从无变为其他内容之后。if works 将返回包含该作业信息的目录。（希望詹金斯库可以实现这样的东西。）

# android - 自定义游标适配器多次调用 bindView

> ID：15297323
> 
> 赞同：10
> 
> 时间：2013-03-08T15:21:15.053
> 
> 标签：android, android-gridview, android-cursoradapter

我已经为这个问题困扰了好几个月（但现在我正在调整性能）。但是，我现在迫切需要知道为什么我的适配器觉得有必要`bindView`在唱片上运行多达 4 次。

我有一个填充网格视图的自定义光标适配器。

一些调试以显示发生了什么：

```
03-08 14:46:47.980: I/AdapterCursorGrid(20724): newView()
03-08 14:46:48.470: I/AdapterCursorGrid(20724): bindView()
03-08 14:46:48.570: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:48.570: I/AdapterCursorGrid(20724): bindView() Record Id: 1
03-08 14:46:48.570: I/AdapterCursorGrid(20724): bindView() Cursor Position: 0
03-08 14:46:48.570: I/AdapterCursorGrid(20724): bindView() View Type: 0
03-08 14:46:48.570: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:48.600: D/AdapterCursorGrid(20724): bindView() Avatar empty...
03-08 14:46:48.690: D/AdapterCursorGrid(20724): bindView() Picture creation...
03-08 14:46:49.490: I/AdapterCursorGrid(20724): bindView()
03-08 14:46:49.501: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:49.501: I/AdapterCursorGrid(20724): bindView() Record Id: 1
03-08 14:46:49.501: I/AdapterCursorGrid(20724): bindView() Cursor Position: 0
03-08 14:46:49.501: I/AdapterCursorGrid(20724): bindView() View Type: 0
03-08 14:46:49.501: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:49.521: D/AdapterCursorGrid(20724): bindView() Avatar empty...
03-08 14:46:49.521: D/AdapterCursorGrid(20724): bindView() Picture creation...
03-08 14:46:50.320: I/AdapterCursorGrid(20724): newView()
03-08 14:46:51.170: I/AdapterCursorGrid(20724): bindView()
03-08 14:46:51.180: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:51.180: I/AdapterCursorGrid(20724): bindView() Record Id: 1
03-08 14:46:51.180: I/AdapterCursorGrid(20724): bindView() Cursor Position: 0
03-08 14:46:51.190: I/AdapterCursorGrid(20724): bindView() View Type: 0
03-08 14:46:51.190: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:51.190: D/AdapterCursorGrid(20724): bindView() Avatar empty...
03-08 14:46:51.200: D/AdapterCursorGrid(20724): bindView() Picture creation...
03-08 14:46:51.870: I/AdapterCursorGrid(20724): bindView()
03-08 14:46:51.896: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:51.896: I/AdapterCursorGrid(20724): bindView() Record Id: 1
03-08 14:46:51.900: I/AdapterCursorGrid(20724): bindView() Cursor Position: 0
03-08 14:46:51.900: I/AdapterCursorGrid(20724): bindView() View Type: 0
03-08 14:46:51.900: I/AdapterCursorGrid(20724): --------------------------
03-08 14:46:51.900: D/AdapterCursorGrid(20724): bindView() Avatar empty...
03-08 14:46:51.900: D/AdapterCursorGrid(20724): bindView() Picture creation... 
```

“Avatar empty...”和“Picture creation...”只是简单的调试，告诉我它正在处理和更新 2 个特定`ImageView`的 s。

为什么 o 为什么`bindView`运行这么多次？这是什么原因，我能做些什么来解决这个问题？

从逻辑上讲，我希望`bindView`运行一次（每次更新适配器时运行一次），我这样想错了吗？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-08T15:30:28.430

操作系统可能会调用`bindView`多次，以便正确测量和布局列表。这不是一个错误，而是它必须的方式。这与滚动的平滑性一起，是`bindView`实现需要尽可能高效的原因。[您可以在Android 开发者页面](http://developer.android.com/training/improving-layouts/smooth-scrolling.html)上详细使用一些不错的提示和技巧。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-06-10T11:23:02.683

我还发现 bindView 的调用次数比预期的要多得多。我的 ListView 高度设置为 wrap_content。将其更改为 match_parent 后，调用次数急剧减少。

这个解决方案的功劳归功于这个问题的答案[Custom CursorAdapater's bindView called 77 times...我做错了什么吗？](https://stackoverflow.com/questions/16991450/custom-cursoradapaters-bindview-called-77-times-have-i-done-something-wrong)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-26T10:52:09.660

我发现的一件事`ImageView`是更改图像会导致`ImageView`请求布局，除非新图像和旧图像的大小完全相同。

在内部`ImageView`使用`getIntrinsicWidth()`并`getIntrinsicHeight()`确定是否请求布局。

尝试这样的事情（尽管在从后台返回之前将当前宽度/高度发送到异步负载并调整位图大小会更有意义）：

```
public void replaceBitmap(ImageView iv, Bitmap bitmap) {
    Drawable current = iv.getDrawable();
    if (bitmap.getWidth() != current.getIntrinsicHeight()
            || bitmap.getHeight() != current.getIntrinsicHeight()) {
        bitmap = Bitmap.createScaledBitmap(bitmap,
            current.getIntrinsicWidth(), current.getIntrinsicHeight(), true);
    }
    iv.setImageBitmap(bitmap);
} 
```

# android - Worklight 应用程序的页面在启动画面后无法加载

> ID：15297330
> 
> 赞同：1
> 
> 时间：2013-03-08T15:21:24.280
> 
> 标签：android, splash-screen, ibm-mobilefirst

在闪屏显示后显示我的 Worklight 主页时出现问题。（有关信息，我的应用程序之前运行良好）。

在 res/drawable(s) 文件夹中添加许多 spashscreen.png 文件后，我更新了 .java 主页类中的 java 代码：

```
super.setIntegerProperty("splashscreen", R.drawable.splashscreen);
super.loadUrl(getWebMainFilePath(), 5000); 
```

然后我在我的 .html 主页中添加了以下内容：

```
<script type="text/javascript">
$(document).ready(function(){
// hide splash-screen
    navigator.spashscreen.hide();
    }
</script> 
```

启动画面显示良好，5 秒后屏幕变黑。

这是来自我的 htc 设备的错误日志：

```
03-08 16:08:08.354: E/libEGL(2722): call to OpenGL ES API with no current context (logged once per thread)
03-08 16:08:08.354: E/SurfaceTexture(1446): [SurfaceView] abandon: surfaceTexture(0x0x9df580) has been abandoned!
03-08 16:08:08.724: E/SurfaceTexture(1446): [Starting com.Maquette] abandon: SurfaceTexture(0x0xa1ca18) has been abandoned!
03-08 16:08:08.744: E/SurfaceTexture(1446): [com.htc.launcher/com.htc.launcher.Launcher] abandon: SurfaceTexture(0x0xa5ce18) has been abandoned!
03-08 16:08:13.068: E/SurfaceTexture(1446): [com.Maquette/com.Maquette.Maquette] abandon: SurfaceTexture(0x0x9df580) has been abandoned! 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-10T04:35:31.637

您可能想尝试@user2124658 在此线程中给出的答案：[Android 上的 Worklight 应用程序启动画面](https://stackoverflow.com/questions/15496704/worklight-app-splash-screen-on-android)

如果您使用的是 Worklight 5.0.5.x，请尝试以下操作：

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    super.loadUrl(getWebMainFilePath());  // yes, this is an extra invocation
    super.setIntegerProperty("splashscreen", R.drawable.splash);
    super.loadUrl(getWebMainFilePath(), 5000);
} 
```

如果您使用的是 Worklight 5.0.6.x，请尝试以下操作：

```
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    super.setIntegerProperty("splashscreen", R.drawable.splash);
    super.bindBrowser(appView);
    super.loadUrl(getWebMainFilePath(), 5000);
} 
```

# php - 在亚马逊 EC2 上启动并运行纯 Python 服务器最轻松的方法是什么？

> ID：15297331
> 
> 赞同：0
> 
> 时间：2013-03-08T15:21:24.403
> 
> 标签：php, apache, amazon-web-services, bottle, web-development-server

我最近用 Apache + php 启动了一个 linux EC2 实例。我的 php 代码最终淡化为仅从 shell 调用 python，仅此而已。这是一个非常丑陋的解决方案，但它有效。所以，基本上我的问题是：

1.  有一个反复调用 exec(python my_script.py) 的 php 代码而不是一个更原生于 python 的解决方案是多么糟糕/低效/愚蠢？我假设它是浪费的，但我试图了解我是否应该为此烦恼或继续咕咕咕咕。
2.  我设法让bottle.py 启动并运行，并且即将用一个持续运行的bottle 脚本替换我的“愚蠢”解决方案，这似乎更自然。但我未能通过 mod_wsgi 将此解决方案与 Apache 集成，我认为这与我不愿处理的 python 版本不兼容问题有关。
3.  考虑到（2），完全绕过 Apache 并简单地调用带有“运行”命令的瓶子脚本来监听所有传入通信的后果是什么？它看起来很丑陋，但它是否效率低下或不好？如果不是，我将继续称其为我的解决方案......但我担心人们可能有理由与 Apache 集成。

任何输入将不胜感激。一个已经运行 python 2.7 并默认通过 python 处理传入请求的像样的亚马逊 AMI 会很好。有人权威地说我不应该搞乱整个 apache/mod_wsgi 业务，最好将“瓶子”称为脚本 :-)

**编辑**：我有 python 2.7 运行瓶和粘贴作为我的网络服务器。我有什么**真正**的理由更喜欢 apache 而不是这个解决方案吗？当我在做的时候，有没有人有在这个环境中启用 ssl 的经验？

干杯，乌里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:18:55.323

为什么不直接用 Python 启动一个 Beanstalk 实例，让 Amazon 处理这些细节呢？Beanstalk 在 EC2 上运行。当亚马逊已经为您制作通心粉伏特加时，制作自己的意大利面很愚蠢！撇开蹩脚的比喻不谈，我认为你会为自己省去额外的压力，并且不需要混合 PHP/Python。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T20:02:08.083

免责声明：我为 OpDemand 工作。

最轻松的方法是使用预卷的 AMI，但这些变得无法管理。

如果您正在寻找更灵活的东西，[OpDemand](http://www.opdemand.com/)为您可以一键部署的 Python 应用程序提供 EC2 模板。它们是普通的 Ubuntu 12.04 LTS 盒子，在[Procfile](http://ddollar.github.com/foreman/)定义的网络工作者面前带有 Nginx。它很像 Heroku，但都用完了你自己的 EC2 帐户。[示例 Python 应用程序](https://github.com/opdemand/example-python-flask)使用Flask，但切换到 Bottle 很简单。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T19:46:49.763

如果您需要更新 beanstalk 上的 python 版本，我会推荐两个选项：

1.  基于 beanstalk 的标准 ami 创建自定义 ami。好文章在这里：[http ://blog.jetztgrad.net/2011/02/how-to-customize-an-amazon-elastic-beanstalk-instance/](http://blog.jetztgrad.net/2011/02/how-to-customize-an-amazon-elastic-beanstalk-instance/)

2.  借助弹性 beanstalk 配置文件自定义实例。看看这里：[http](http://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers.html) ://docs.aws.amazon.com/elasticbeanstalk/latest/dg/customize-containers.html 。

# tsql - t-sql 查询填充空值

> ID：15297337
> 
> 赞同：1
> 
> 时间：2013-03-08T15:21:43.980
> 
> 标签：tsql, sql-server-2012, cascade

我是 sql server 2012 的新手，想了解如何使用 t-sql 创建以下输出。有很多俱乐部号码，所以必须有一个循环或光标。请帮忙！！

表

```
club_number  name                                             number
---------- -------------------------------------------------- -----------
355292     NULL                                               NULL
NULL       Giviton Mbunge                                     355308
NULL       Etero Aaron                                        355317
NULL       Evason Banda                                       355326
NULL       Kachibobo Batoni                                   355335
NULL       Kashamba Nkhani                                    355344
355353     NULL                                               NULL
NULL       Daniel Banda                                       355362
NULL       James Aaron                                        355371
NULL       Amson Kamanga                                      355380
NULL       Gostino George                                     355399
355405     NULL                                               NULL
NULL       Yohane Zimba                                       355414
NULL       Haward M.Chilembwe                                 355423
NULL       Zikiele Blangete                                   355432
355441     NULL                                               NULL 
```

**结果：我想看到上面的表如下，哪个查询可以做到？请帮忙**

```
club_number  name                                             number
---------- -------------------------------------------------- -----------
355292       NULL                                               NULL
355292       Giviton Mbunge                                     355308
355292       Etero Aaron                                        355317
355292       Evason Banda                                       355326
355292       Kachibobo Batoni                                   355335
355292       Kashamba Nkhani                                    355344
355353       NULL                                               NULL
355353       Daniel Banda                                       355362
355353       James Aaron                                        355371
355353       Amson Kamanga                                      355380
355353       Gostino George                                     355399
355405       NULL                                               NULL
355405       Yohane Zimba                                       355414
355405       Haward M.Chilembwe                                 355423
355405       Zikiele Blangete                                   355432
355441       NULL                                               NULL 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:37:49.973

```
SELECT club_number = MAX(club_number) OVER 
    (
      ORDER BY COALESCE(club_number, number)
      ROWS UNBOUNDED PRECEDING
    ), 
  name, number
FROM dbo.your_table
ORDER BY club_number; 
```

# php - 使用 PHP PDO 和 MySQL 的非对象错误

> ID：15297339
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:21:51.373
> 
> 标签：php, mysql, database, pdo, fatal-error

几天来我一直在为此挠头，但我仍然无处可去。我正在尝试通过 PHP PDO 从 MySQL 数据库中提取一小组值；我知道 PDO 的工作原理是我在其他地方使用它时的工作原理，并且我的代码基于以前工作的代码。

```
function custom_sub_cat_list($db_details, $cat_id) { //ln21
$subcat = NULL;
try {
    $h = new PDO("mysql:host=".$db_details['host'].";dbase=".$db_details['db'],$db_details['user'],$db_details['pass']);
    $h->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
} catch(PDOException $ex) {
    return false;
}
try {
    $q = $h->prepare("SELECT category FROM :tbl WHERE parentid = :catid;");
    $q->bindValue(":tbl", $db_details['tbl'], PDO::PARAM_STR);
    $q->bindValue(':catid', $cat_id, PDO::PARAM_STR);
    $q->execute();
    while($row = $_query->fetch()) {
        $subcat['id'][] = $row['categoryid'];
        $subcat['name'][] = $row['category'];
    };
    return $subcat;
} catch(PDOException $ex) {
    return false;
}
}//ln49 
```

我在 bindValue 上得到“调用非对象上的成员函数 bindValue()”，并被如下调用。

```
$cat_id     = 123;
$db_details = array(
    "host"  => $sql_host,
    "db"    => $sql_db,
    "user"  => $sql_user,
    "pass"  => $sql_password,
    "tbl"   => $sql_tbl['categories']
);
custom_sub_cat_list ($db_details, $cat_id) 
```

我确信这是非常明显的事情，但我看不到问题所在，我想要一双新的眼睛。

**以下工作版本**

非常非常感谢你！对于所有帮助过的人，我也学到了一些东西 :-) 那里有一些我忽略的愚蠢错误，我只是责怪看了两天扎实的东西。

```
function custom_sub_cat_list($db_details, $cat_id) {
$subcat = NULL;
try {
    $h = new PDO("mysql:host=".$db_details['host'].";dbname=".$db_details['db'].";charset=utf8",$db_details['user'],$db_details['pass']);
    $h->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    $h->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $q = $h->prepare("SELECT category, categoryid FROM ".$db_details['table']." WHERE parentid = :cid;");
    $q->bindParam(':cid', $cat_id, PDO::PARAM_INT);
    $q->execute();
    while($row = $q->fetch()) {
        $subcat['id'][] = $row['categoryid'];
        $subcat['name'][] = $row['category'];
    };
    $h = NULL;
    return $subcat;
} catch(PDOException $ex) {
    print_r($ex->getMessage());
    print_r($ex->getTrace());
    //return false;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:24:46.173

**你不需要一双新鲜的眼睛**

您不是画家，而是程序员（据说）。
因此，您不必查看您的代码，而是必须*运行*它。并启用错误报告。

哦，刚刚发现它
**当然，你不应该堵嘴错误信息！**

```
} catch(PDOException $ex) {
    return false;
} 
```

@ 运算符的现代版本。
请摆脱代码中的所有块，并在[了解它们的用途](https://stackoverflow.com/a/15276004/285587)`try..catch`后才开始使用它们。

所以，为了解决这个问题以及未来的许多其他问题

1.  摆脱代码中的所有 try..catch 块。
2.  启用 PDO 的错误报告，如我在评论中链接到的标签 wiki 中所述。
3.  不要对标识符使用占位符，而是按照我链接到的标签 wiki 中的描述格式化它们
4.  `display_errors`如果您不想显示错误，请关闭设置（我能想到的抑制错误消息的唯一原因）。

此外，您不应在每个函数调用中打开单独的连接。
在脚本的开头创建一个连接，然后在函数中使用 if，使用

```
global $h; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:52:47.980

```
$q = $h->prepare("SELECT category FROM :tbl WHERE parentid = :catid;"); 
```

您不能在 SQL 中对表名使用绑定参数。

当您尝试像这样准备无效的 SQL 语句时，prepare() 返回`false`，而不是 PDOStatement 对象。

```
$q->bindValue(":tbl", $db_details['tbl'], PDO::PARAM_STR); 
```

然后你尝试在 $q 上调用 bindValue() 方法，但是标量值`false`没有方法，所以这是一个致命错误。

您还试图捕获异常，但您没有将 PDO 配置为在出错时引发异常。所以 PDO 函数默认只通过返回来报告错误`false`。

正如@Arkh 所示，您需要告诉 PDO 抛出异常：

```
$h->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-08T15:45:24.947

因此，您的错误告诉您 $q 不是对象。这意味着`$h->prepare("SELECT category FROM :tbl WHERE parentid = :catid;");`失败了。

阅读[PDO::prepare](http://php.net/manual/en/pdo.prepare.php)文档时，您可以阅读以下内容：

> 返回值
> 
> 如果数据库服务器成功准备语句，PDO::prepare() 返回一个 PDOStatement 对象。如果数据库服务器无法成功准备语句，则 PDO::prepare() 返回 FALSE 或发出 PDOException（取决于错误处理）。

由于您尚未设置 PDO 以引发异常，因此您应该这样做以获得良好的错误消息或检查 $q 的值并获取最后报告的错误。第一种方法：

```
function custom_sub_cat_list($db_details, $cat_id) { //ln21
$subcat = NULL;
try {
    $h = new PDO("mysql:host=".$db_details['host'].";dbase=".$db_details['db'],$db_details['user'],$db_details['pass']);
    $h->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $h->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    $q = $h->prepare("SELECT category FROM :tbl WHERE parentid = :catid;");
    $q->bindValue(":tbl", $db_details['tbl'], PDO::PARAM_STR);
    $q->bindValue(':catid', $cat_id, PDO::PARAM_STR);
    $q->execute();
    while($row = $_query->fetch()) {
        $subcat['id'][] = $row['categoryid'];
        $subcat['name'][] = $row['category'];
    };
    return $subcat;
} catch(PDOException $ex) {
    echo $ex->getMessage();
    return false;
}
}//ln49 
```

这给出了错误：

> SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以获取在 '? 附近使用的正确语法。哪里父母=？在第 1 行

第二种方法：

```
function custom_sub_cat_list($db_details, $cat_id) { //ln21
$subcat = NULL;
    $h = new PDO("mysql:host=".$db_details['host'].";dbase=".$db_details['db'],$db_details['user'],$db_details['pass']);
    $h->setAttribute(PDO::ATTR_EMULATE_PREPARES, false);
    $q = $h->prepare("SELECT category FROM :tbl WHERE parentid = :catid;");
    if ($q === false) {
        print_r($h->errorInfo());
        return false;
    }
    $q->bindValue(":tbl", $db_details['tbl'], PDO::PARAM_STR);
    $q->bindValue(':catid', $cat_id, PDO::PARAM_STR);
    $q->execute();
    while($row = $_query->fetch()) {
        $subcat['id'][] = $row['categoryid'];
        $subcat['name'][] = $row['category'];
    };
    return $subcat;
}//ln49 
```

结果：

> Array ( [0] => 42000 [1](http://php.net/manual/en/pdo.prepare.php) => 1064 [2] => 您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，以了解在 '? WHERE parentid = ?' 附近使用的正确语法在第 1 行）

您的问题是您不能为 :tbl （或 SQL 字符串的其他非值部分）使用绑定值。所以你必须这样做：

```
$q = $h->prepare("SELECT category FROM ".$db_details['tbl']." WHERE parentid = :catid;"); 
```

# ruby-on-rails - 设计不带会话 cookie 的 token_authenticable

> ID：15297344
> 
> 赞同：4
> 
> 时间：2013-03-08T15:22:01.343
> 
> 标签：ruby-on-rails, devise, session-cookies, access-token

我正在使用 Rails 3，并且我已经成功构建了一个 web api。对于一堆控制器需要登录，所以我决定使用 Devise 和 token_authenticable。它正在工作，但并不完全符合我的预期：虽然我需要为每个请求提供我的登录令牌，但它看起来只需要一次，然后系统在响应中创建一个 cookie，就像正常的浏览器会话一样。我想实现像 facebook graph api 这样的东西，每个请求都需要提交会话令牌才能工作。

如果我使用 web api，是否可以设置任何标志来指示 Devise 不发送会话 cookie，如果我使用浏览器则发送会话 cookie？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T16:47:09.083

我有同样的问题。

我的 API 的 Sessions 控制器中有一行：

```
 warden.authenticate!(:scope => resource_name, :recall => "#{controller_path}#failure") 
```

它正在登录用户并创建一个会话（一开始我没有注意到）

解决方案是使用与此类似的东西（在博文中找到[）](http://matteomelani.wordpress.com/2011/10/17/authentication-for-mobile-devices/)：

```
@user=User.find_by_email(email.downcase)
if @user.nil?
  render :status=>401, :json=>{:message=>"Invalid email or password."}
  return
end

# http://rdoc.info/github/plataformatec/devise/master/Devise/Models/TokenAuthenticatable
@user.ensure_authentication_token!

if not @user.valid_password?(password)
  logger.info("User #{email} failed signin, password \"#{password}\" is invalid")
  render :status=>401, :json=>{:message=>"Invalid email or password."}
else
  render :status=>200, :json=>{:token=>@user.authentication_token}
end 
```

基本上不是登录用户，而是检索令牌。除注销外，应用程序的其他部分工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-10T00:25:26.640

我使用 `protect_from_forgery with: :null_session`了这样的会话被忽略。

# android - 在 Ubuntu 12.04 中没有为 Kivy 设置 Android SDK 环境

> ID：15297345
> 
> 赞同：5
> 
> 时间：2013-03-08T15:22:05.547
> 
> 标签：android, python, ubuntu-12.04, android-sdk-tools, kivy

我使用 Python 和 Kivy 为 Android 编写了一个游戏。我已下载`android-sdk-linux`并将其路径添加到`.bashrc`. 我还克隆了该`python-for-android`项目以创建我的程序的 apk 包。但是当我按照 Kivy 手册中的说明编写以下命令时，出现错误：

```
./distubute.sh -m "kivy"

error:
    Check build dependencies for Ubuntu
    Check enviromnent
    No ANDROIDSDK environment set, abort 
```

为什么？

这是我的`./android.sh`照片`$android-sdk-linux/tools`：

![截屏](../Images/ce55c1453af0aa101ad03890b879f0ea.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-09T18:43:22.770

真诚地阅读[文档](http://python-for-android.readthedocs.org/en/latest/prerequisites/)。特别要注意页面底部提到的需要设置的环境变量。

希望有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-07-12T02:15:53.467

我知道这个问题有点老了，但是：

```
export ANDROIDSDK="/path/to/android-sdk-linux"
export ANDROIDNDK="/path/to/android-ndk-rY" #change Y here
export ANDROIDNDKVER=rY #same here
export ANDROIDAPI=X #change X here
export PATH=$PATH:$ANDROIDNDK:$ANDROIDSDK/platform-tools:$ANDROIDSDK/tools 
```

您必须将 Y 更改为 ndk 版本，将 X 更改为 API id。

您可以将其添加到您的 ~/.bashrc。

它为我解决了这个问题。

# ssh - ssh 到 ec2 时权限被拒绝（公钥）

> ID：15297347
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:22:12.187
> 
> 标签：ssh, amazon-ec2

我创建了一个 EC2 实例并且能够正确地 ssh 进入它。

然后我停止了实例

再次启动后出现以下错误

```
Aloks-MacBook-Pro:AWS alokmandloi$  ssh -i working_key.pem ubuntu@ec2-184-73-22-113.compute-1.amazonaws.com 
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the RSA key sent by the remote host is
3d:f2:79:cc:38:66:83:71:1b:86:6c:7e:36:ad:27:bc.
Please contact your system administrator.
Add correct host key in /Users/alokmandloi/.ssh/known_hosts to get rid of this message.
Offending RSA key in /Users/alokmandloi/.ssh/known_hosts:11
RSA host key for ec2-184-73-22-113.compute-1.amazonaws.com has changed and you have requested strict checking.
Host key verification failed. 
```

我查找了一个解决方案，发现[http://www.thegeekstuff.com/2010/04/how-to-fix-offending-key-in-sshknown_hosts-file/](http://www.thegeekstuff.com/2010/04/how-to-fix-offending-key-in-sshknown_hosts-file/)

这建议我删除 known_hosts 中的第 11 个条目。这样做之后，我收到以下错误

```
Aloks-MacBook-Pro:AWS alokmandloi$  ssh -v -i working_key.pem ubuntu@ec2-184-73-22-113.compute-1.amazonaws.com 
OpenSSH_5.9p1, OpenSSL 0.9.8r 8 Feb 2011
debug1: Reading configuration data /etc/ssh_config
debug1: /etc/ssh_config line 20: Applying options for *
debug1: Connecting to ec2-184-73-22-113.compute-1.amazonaws.com [184.73.22.113] port 22.
debug1: Connection established.
debug1: identity file working_key.pem type -1
debug1: identity file working_key.pem-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_5.3
debug1: match: OpenSSH_5.3 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_5.9
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-ctr hmac-md5 none
debug1: kex: client->server aes128-ctr hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Server host key: RSA 3d:f2:79:cc:38:66:83:71:1b:86:6c:7e:36:ad:27:bc
debug1: Host 'ec2-184-73-22-113.compute-1.amazonaws.com' is known and matches the RSA host key.
debug1: Found key in /Users/alokmandloi/.ssh/known_hosts:10
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Trying private key: working_key.pem
debug1: read PEM private key done: type RSA
debug1: Authentications that can continue: publickey
debug1: No more authentication methods to try.
Permission denied (publickey). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:09:45.067

如果您停止了实例，您是尝试连接到新 IP 地址还是旧 IP 地址？停止 ec2 中的实例将导致实例在重新启动时获得新的 IP 地址。

# java - 创建 JSONObject 时如何避免在字符串值周围加上引号

> ID：15297349
> 
> 赞同：1
> 
> 时间：2013-03-08T15:22:15.983
> 
> 标签：java, json, mongodb

我正在尝试为 MongoDB 创建 JSON 查询字符串，为了支持正则表达式，我需要创建具有不带引号的值的 JSON 字符串。如何在java中实现这一点，

这是我正在尝试做的示例，

```
 JSONObject obj= new JSONObject();
  String title = "gro";
  obj.put("title", "/.*" + title + ".*/"); 
```

结果是

```
 {"title ":"/.*gro.*/"} 
```

以上不再被 MongoDB 视为正则表达式。我想要的是，

```
 {"title ":/.*gro.*/} 
```

这样 MongoDB 将其视为正则表达式。有没有办法在java中完成这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:30:29.570

定界正`/`则表达式语法是一种 JavaScript 构造。在[Java](http://docs.mongodb.org/ecosystem/drivers/java-types/#regular-expressions)中，你必须`java.util.regex.Pattern`像这样使用：

```
BasicDBObject query = new BasicDBObject("title", Pattern.compile(".*gro.*")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:47:49.343

尝试这个，

```
 JSONObject obj= new JSONObject();
  String title = "gro";
  String startExpr = "/.*";
  String endExpr = ".*/";

  obj.put("title", startExpr  + title + endExpr ); 
```

# office-2010 - 从 Office 2003 到 Office 2010

> ID：15297352
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:22:26.430
> 
> 标签：office-2010

我安装了 Office 2010，我想知道是否有转换所有文件的技巧（.docx 中的 .doc 等）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:26:44.627

目前还不清楚你为什么要这样做。`.doc`Office 2010 具有向后兼容性，并且它在读取您的文件时没有问题。如果您只想将这些文件转换为`.docx`格式，您可以在 Office 2010 中打开它们并使用该`Save As..`选项。

# javascript - 图像悬停 - 更改效果

> ID：15297356
> 
> 赞同：0
> 
> 时间：2013-03-08T15:22:36.990
> 
> 标签：javascript, html, css

当有人将鼠标悬停在图像上时，我实际上想更改图像。

假设我有一张图片：

```
<img src="image.png"/> 
```

我想用以下悬停效果来改变它：

*   图片应该是可点击的，所以它应该是一个将用户重定向到另一个页面的链接
*   图像的背景应该是黑色的，不透明
*   在图像上，它应该在中间出现另一个图像

怎么可能呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:28:02.343

我建议你创建一个链接`<a class="my-image">foo</a>`并使用 css 来获得翻转效果。CSS翻转教程很容易通过谷歌搜索找到，这个解决方案将是你可以实现的最优雅、语义和seo友好的解决方案——无需使用javascript。

[来自http://css-tricks.com/snippets/css/basic-link-rollover-as-css-sprite/](http://css-tricks.com/snippets/css/basic-link-rollover-as-css-sprite/)的示例代码

```
a {
       display: block;
       background: url(sprite.png) no-repeat;
       height: 30px;
       width: 250px;
}

a:hover {
       background-position: 0 -30px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:29:51.790

你可以这样：

```
<a class="superimage" href="http://yourlink.com"></a> 
```

和CSS：

```
.superimage {
    background-image: url(superimage.jpg) no-repeat 0 0;
    display: block; //or inline-block
    height: (image height)px;
    width: (image width)px;
    opacity: 0.8;
}

.superimage:hover {
    background-image: url(superimageonhover.jpg) no-repeat 0 0;
    display: block; //or inline-block
    height: (image height)px;
    width: (image width)px;
} 
```

更多帮助？问问

# javascript - 在益智游戏中检查获胜者

> ID：15297357
> 
> 赞同：1
> 
> 时间：2013-03-08T15:22:38.377
> 
> 标签：javascript

我做了一个 15 的滑动图像游戏，到目前为止一切正常。但是，我无法弄清楚如何通过按顺序排列所有图像（编号 1 到 15）来确定用户何时赢得游戏。现在我只是想弄清楚如何确定用户是否按顺序排列了前 4 个数字，因为如果我能完成，休息应该很容易。我将在下面发布我的代码，如果有人对如何做到这一点有任何想法或建议，那就太好了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:39:04.637

验证函数的一种解决方案是遍历`<img>`表中的所有元素并评估源属性是否与循环中的点匹配。伪编码它可能看起来像：

```
IMAGES = get all image tags from table
for i = 1 to IMAGES.length {
    if IMAGES[i-1].source != "Buttons\\"+i+".png" return false;
}

return true; // Puzzle solved 
```

一个实际可能的解决方案是这样的（使用 myTable 作为 ID）。这将简单地提醒它找到的每个图像。用您的检查逻辑替换里面的警报：

```
var myTable = document.getElementById("myTable");
if (myTable) {
    var images = myTable.getElementsByTagName("img");
    if (images && images.length > 0) {
        for (var i=0; i<images.length; i++) {
            alert("Image " + i + ": " + images[i].src);
        }
    }
} 
```

# c# - GraphicsPath 的高效投影

> ID：15297359
> 
> 赞同：1
> 
> 时间：2013-03-08T15:22:39.347
> 
> 标签：c#, winforms, rendering, gdi+

我正在 Windows 窗体中绘制一些带有阴影的图形路径。

我这样做的方式基本上是：

```
var matrix = new Matrix();  
matrix.Translate(3, 3);
graphicsPath.Transform(matrix);

g.DrawPath(shadowPen, graphicsPath);

graphicsPath.Transform(new Matrix());

g.DrawPath(normalPen, graphicsPath); 
```

但是，绘制路径似乎效率很低，并且对我的应用程序有一些性能影响。有没有更有效的方法来达到同样的效果？

我可以用普通笔以某种方式缓存 DrawPath 的结果，然后用不同的画笔和变换重绘相同的东西吗？

# javascript - 如何在javascript中退出调用函数

> ID：15297360
> 
> 赞同：0
> 
> 时间：2013-03-08T15:22:42.863
> 
> 标签：javascript

有没有办法退出调用当前正在执行的函数的函数？

一个例子是：

```
function doOneTwoThree(){

    doStuff(1, print);

    doStuff(2, print);

    doStuff(3, print);

}

function doStuff(parameter, aFunction){

    if(parameter === 2) {
        //exit from doOneTwoThree
    }

    aFunction(parameter);
}

function print(something){

    console.log(something);

} 
```

另一种选择是在每次调用时返回错误`doStuff`并检查该错误。但我不想每次都检查它......`doOneTwoThree``doStuff`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:28:29.207

您可以使用`throw`并捕获错误抛出`doOneTwoThree`：

```
function doStuff(parameter, aFunction) {
    if (parameter === 2) {
        throw "error";
    }
}

function doOneTwoThree() {
    try {
        doStuff(1, print);
        doStuff(2, print);
    }
    catch (error) { /* handle here */ }
} 
```

*但是*，如果您没有抛出实际的错误/异常，则不应*使用*它来控制代码流。相反，您应该检查调用的返回值`doStuff`以确认您可以继续。如果这对您来说听起来不干净，您还可以执行链`doStuff`调用之类的操作，或者在循环中调用它们，您可以根据`doStuff`返回值将其中断。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:29:45.070

试试这样的东西？返回一个令牌/魔法值？（像 'eek' 这样的字符串可能是一个不好的标记，但它让我很开心，请改用 int ）

```
function doOneTwoThree(){

    if (doStuff(1, print) === "eek") return;

    doStuff(2, print);

    doStuff(3, print);

}

function doStuff(parameter, aFunction){

    if(parameter === 2) {
        return "eek";
    }

    aFunction(parameter);
} 
```

# google-app-engine - Google App Engine 1.7.5 - org.datanucleus.exceptions.ClassNotResolvedException

> ID：15297363
> 
> 赞同：2
> 
> 时间：2013-03-08T15:22:50.600
> 
> 标签：google-app-engine, jpa

我使用 Google 应用引擎 -GAE 创建了一个示例 GWT 应用程序，我创建了一个实体并将其保存在服务层上，工作正常，数据存储。

所以我开始在我的服务层上添加小部件和更多类，当我尝试创建 EntityManager 时，我得到：

`org.datanucleus.exceptions.ClassNotResolvedException`对于非实体类，例如小部件，我不知道为什么 Datanucleus 试图增强没有 @Entity 注释的类。

我在 ORM 下配置了 Google Plugin Eclipse 以仅增强 dto 包中的 bean 并删除 /src 条目。

它永远不会起作用，我只需要能够告诉 DN 不要只增强它看到其 CLASSPATH 的每个类。

任何帮助将不胜感激。

我正在使用 GAE 1.7.5 版和 GWT 2.5 和 GXT 2.5.5。

例外：

```
Initializing App Engine server
Mar 8, 2013 5:07:51 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'C:\dev\projects\org\me\workspace\lottoshop\war' is not an EAR directory. File C:\dev\projects\org\me\workspace\lottoshop\war\appengine-application.xmlappengine-application.xml not detected.
Mar 8, 2013 5:07:51 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'C:\dev\projects\org\me\workspace\lottoshop\war' is not an EAR directory. File C:\dev\projects\org\me\workspace\lottoshop\war\appengine-application.xmlappengine-application.xml not detected.
Mar 8, 2013 5:07:51 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'C:\dev\projects\org\me\workspace\lottoshop\war' is not an EAR directory. File C:\dev\projects\org\me\workspace\lottoshop\war\appengine-application.xmlappengine-application.xml not detected.
Mar 8, 2013 5:07:51 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'C:\dev\projects\org\me\workspace\lottoshop\war' is not an EAR directory. File C:\dev\projects\org\me\workspace\lottoshop\war\appengine-application.xmlappengine-application.xml not detected.
Mar 8, 2013 5:07:51 PM com.google.apphosting.utils.config.AppEngineWebXmlReader readAppEngineWebXml
INFO: Successfully processed C:\dev\projects\org\me\workspace\lottoshop\war\WEB-INF/appengine-web.xml
Mar 8, 2013 5:07:51 PM com.google.apphosting.utils.config.AbstractConfigXmlReader readConfigXml
INFO: Successfully processed C:\dev\projects\org\me\workspace\lottoshop\war\WEB-INF/web.xml
Mar 8, 2013 5:07:51 PM com.google.appengine.tools.development.SystemPropertiesManager setSystemProperties
INFO: Overwriting system property key 'java.util.logging.config.file', value 'C:\dev\tools\gae\appengine-java-sdk-1.7.5\appengine-java-sdk-1.7.5\config\sdk\logging.properties' with value 'WEB-INF/logging.properties' from 'C:\dev\projects\org\me\workspace\lottoshop\war\WEB-INF\appengine-web.xml'
Mar 8, 2013 5:07:51 PM com.google.apphosting.utils.jetty.JettyLogger info
INFO: Logging to JettyLogger(null) via com.google.apphosting.utils.jetty.JettyLogger
Mar 8, 2013 5:07:55 PM com.google.apphosting.utils.jetty.JettyLogger info
INFO: jetty-6.1.x
Mar 8, 2013 5:07:57 PM com.google.apphosting.utils.jetty.JettyLogger info
INFO: Started SelectChannelConnector@0.0.0.0:8888
Mar 8, 2013 5:07:57 PM com.google.appengine.tools.development.AbstractServer startup
INFO: Server default is running at http://localhost:8888/
Mar 8, 2013 5:07:57 PM com.google.appengine.tools.development.AbstractServer startup
INFO: The admin console is running at http://localhost:8888/_ah/admin
Mar 8, 2013 5:07:57 PM com.google.appengine.tools.development.DevAppServerImpl start
INFO: Dev App Server is now running
mozilla/5.0 (windows nt 6.1; wow64) applewebkit/537.22 (khtml, like gecko) chrome/25.0.1364.152 safari/537.22
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.shared.SearchResponse was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.shared.FieldVerifier was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.LottoType was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class com.extjs.gxt.samples.resources.client.TestData was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.server.LottoShopDAOServiceImpl was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.resources.Resources was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.LottoShopServiceAsync was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class com.extjs.gxt.samples.resources.client.model.Customer was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.shared.SearchRequest was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.GameTypes was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class com.extjs.gxt.samples.resources.client.icons.ExampleIcons was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.server.LottoShopServiceImpl was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.LottoShopDAOServiceAsync was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.Lottoshop was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.AppEvents was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.server.EMF was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.LottoShopService was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.shared.Constants was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.shared.MultiplePlayersFoundException was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class com.extjs.gxt.samples.resources.client.images.ExampleImages was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.LottoShopDAOService was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.resources.TestData was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class com.extjs.gxt.samples.resources.client.Resources was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM org.datanucleus.metadata.MetaDataManager loadPersistenceUnit
WARNING: Class co.za.fwc.webapp.lottery.client.icons.ExampleIcons was specified in persistence-unit transactions-optional but not annotated, so ignoring
Mar 8, 2013 5:15:57 PM com.google.appengine.tools.development.ApiProxyLocalImpl log
SEVERE: javax.servlet.ServletContext log: Exception while dispatching incoming RPC call
com.google.gwt.user.server.rpc.UnexpectedException: Service method 'public abstract co.za.fwc.webapp.lottery.shared.dto.Player co.za.fwc.webapp.lottery.client.LottoShopDAOService.find(java.lang.String) throws co.za.fwc.webapp.lottery.shared.MultiplePlayersFoundException' threw an unexpected exception: java.lang.ExceptionInInitializerError
    at com.google.gwt.user.server.rpc.RPC.encodeResponseForFailure(RPC.java:389)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:579)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processCall(RemoteServiceServlet.java:208)
    at com.google.gwt.user.server.rpc.RemoteServiceServlet.processPost(RemoteServiceServlet.java:248)
    at com.google.gwt.user.server.rpc.AbstractRemoteServiceServlet.doPost(AbstractRemoteServiceServlet.java:62)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:637)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:717)
    at org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)
    at com.google.appengine.api.socket.dev.DevSocketFilter.doFilter(DevSocketFilter.java:74)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.ResponseRewriterFilter.doFilter(ResponseRewriterFilter.java:123)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.HeaderVerificationFilter.doFilter(HeaderVerificationFilter.java:34)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.api.blobstore.dev.ServeBlobFilter.doFilter(ServeBlobFilter.java:61)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.apphosting.utils.servlet.TransactionCleanupFilter.doFilter(TransactionCleanupFilter.java:43)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.StaticFileFilter.doFilter(StaticFileFilter.java:125)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at com.google.appengine.tools.development.BackendServersFilter.doFilter(BackendServersFilter.java:97)
    at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)
    at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)
    at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
    at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
    at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)
    at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)
    at com.google.appengine.tools.development.DevAppEngineWebAppContext.handle(DevAppEngineWebAppContext.java:94)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at com.google.appengine.tools.development.JettyContainerService$ApiProxyHandler.handle(JettyContainerService.java:409)
    at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
    at org.mortbay.jetty.Server.handle(Server.java:326)
    at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
    at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:938)
    at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:755)
    at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)
    at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
    at org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)
    at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
Caused by: java.lang.ExceptionInInitializerError
    at java.lang.Class.forName0(Native Method)
    at java.lang.Class.forName(Class.java:169)
    at com.google.appengine.tools.development.agent.runtime.RuntimeHelper.checkRestricted(RuntimeHelper.java:70)
    at com.google.appengine.tools.development.agent.runtime.Runtime.checkRestricted(Runtime.java:64)
    at co.za.fwc.webapp.lottery.server.LottoShopDAOServiceImpl.find(LottoShopDAOServiceImpl.java:42)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.appengine.tools.development.agent.runtime.Runtime.invoke(Runtime.java:115)
    at com.google.gwt.user.server.rpc.RPC.invokeAndEncodeResponse(RPC.java:561)
    ... 38 more
Caused by: javax.persistence.PersistenceException: Explicit persistence provider error(s) occurred for "transactions-optional" after trying the following discovered implementations: org.datanucleus.api.jpa.PersistenceProviderImpl from provider: org.datanucleus.api.jpa.PersistenceProviderImpl
    at javax.persistence.Persistence.createPersistenceException(Persistence.java:242)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:184)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:70)
    at co.za.fwc.webapp.lottery.server.EMF.<clinit>(EMF.java:7)
    ... 49 more
Caused by: org.datanucleus.exceptions.NucleusUserException: Errors were encountered when loading the MetaData for the persistence-unit "transactions-optional". See the nested exceptions for details
    at org.datanucleus.metadata.MetaDataManager.loadPersistenceUnit(MetaDataManager.java:979)
    at org.datanucleus.api.jpa.JPAEntityManagerFactory.initialiseNucleusContext(JPAEntityManagerFactory.java:754)
    at org.datanucleus.api.jpa.JPAEntityManagerFactory.initialise(JPAEntityManagerFactory.java:417)
    at org.datanucleus.api.jpa.JPAEntityManagerFactory.<init>(JPAEntityManagerFactory.java:380)
    at org.datanucleus.api.jpa.PersistenceProviderImpl.createEntityManagerFactory(PersistenceProviderImpl.java:91)
    at javax.persistence.Persistence.createEntityManagerFactory(Persistence.java:150)
    ... 51 more
Caused by: org.datanucleus.exceptions.ClassNotResolvedException: Class "com.extjs.gxt.samples.resources.client.model.MailItem" was not found in the CLASSPATH. Please check your specification and your CLASSPATH.
    at org.datanucleus.JDOClassLoaderResolver.classForName(JDOClassLoaderResolver.java:245)
    at org.datanucleus.JDOClassLoaderResolver.classForName(JDOClassLoaderResolver.java:410)
    at org.datanucleus.metadata.MetaDataManager.loadPersistenceUnit(MetaDataManager.java:954)
    ... 56 more

com.google.gwt.user.client.rpc.StatusCodeException: 500 The call failed on the server; see server log for details
    at com.google.gwt.user.client.rpc.impl.RequestCallbackAdapter.onResponseReceived(RequestCallbackAdapter.java:209)
    at com.google.gwt.http.client.Request.fireOnResponseReceived(Request.java:287)
    at com.google.gwt.http.client.RequestBuilder$1.onReadyStateChange(RequestBuilder.java:395)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessagesWhileWaitingForReturn(BrowserChannelServer.java:338)
    at com.google.gwt.dev.shell.BrowserChannelServer.invokeJavascript(BrowserChannelServer.java:219)
    at com.google.gwt.dev.shell.ModuleSpaceOOPHM.doInvoke(ModuleSpaceOOPHM.java:136)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNative(ModuleSpace.java:571)
    at com.google.gwt.dev.shell.ModuleSpace.invokeNativeObject(ModuleSpace.java:279)
    at com.google.gwt.dev.shell.JavaScriptHost.invokeNativeObject(JavaScriptHost.java:91)
    at com.google.gwt.core.client.impl.Impl.apply(Impl.java)
    at com.google.gwt.core.client.impl.Impl.entry0(Impl.java:242)
    at sun.reflect.GeneratedMethodAccessor37.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at com.google.gwt.dev.shell.MethodAdaptor.invoke(MethodAdaptor.java:103)
    at com.google.gwt.dev.shell.MethodDispatch.invoke(MethodDispatch.java:71)
    at com.google.gwt.dev.shell.OophmSessionHandler.invoke(OophmSessionHandler.java:172)
    at com.google.gwt.dev.shell.BrowserChannelServer.reactToMessages(BrowserChannelServer.java:293)
    at com.google.gwt.dev.shell.BrowserChannelServer.processConnection(BrowserChannelServer.java:547)
    at com.google.gwt.dev.shell.BrowserChannelServer.run(BrowserChannelServer.java:364)
    at java.lang.Thread.run(Thread.java:662) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-15T20:37:41.833

我遇到了类似的问题，我正在使用 GAE-1.7.7、GWT-2.5.1 和 Hibernate Validator。一旦我打开验证，客户端验证运行良好，但服务器端持久性搞砸了，显示类似的 ClassNotResolvedException 异常

在构建 EntityManager 时，在扫描类时出现了一些问题。解决方案是禁用实体的自动扫描，并在构建 PersistenceUnit 时明确告知要加载哪些类

`<provider>`请修改您的 persistence.xml 并在标签下方添加以下行

```
<persistence-unit name="transactions-optional">
    <provider>org.datanucleus.jpa.PersistenceProviderImpl</provider>
    <class>your.package.Entity1</class>
    <class>your.package.Entity2</class>
    <exclude-unlisted-classes>true</exclude-unlisted-classes> 
```

这应该有效。

# c# - 如何在 MVC 的一个页面上显示来自多个表的数据？

> ID：15297365
> 
> 赞同：5
> 
> 时间：2013-03-08T15:23:04.733
> 
> 标签：c#, asp.net, asp.net-mvc-4

如何在 MVC 的一个页面上显示来自多个表的数据？

我的模型：

这是页面模型

```
public class PageModel
    {
        [Key]
        [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
        public int PageId { get; set; }

        public string PageTitle { get; set; }

        public string PageSubject { get; set; }

        public DateTime CreateDate { get; set; }

        public DateTime UpdateDate { get; set; }

        public int ParentId { get; set; }

        public bool IsActive { get; set; }

        public IList<PageContentModel> PageContentModels { get; set; }
        public IList<CommentModel> CommentModels { get; set; }
    } 
```

这是内容模型

```
 public class PageContentModel
    {
        [Key]
        [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
        public int ContentId { get; set; }

        public int PageId { get; set; }
        public virtual PageModel PageModel { get; set; }

        [Required]
        [DataType(DataType.MultilineText)]
        [MaxLength(1024)]
        public string Content { get; set; }
    } 
```

这个评论模型

```
public class CommentModel
        {
            [Key]
            [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
            public int CommentId { get; set; }

            public string CommentAuthor { get; set; }

            public string CommentContent { get; set; }

            public DateTime CreateDate { get; set; }

            public bool IsActive { get; set; }

            public int PageId { get; set; }
            public virtual PageModel PageModel { get; set; }
        } 
```

我写了以下

但是在注册评论时会出现错误消息

错误消息：没有为此对象定义无参数构造函数

```
@model Tuple<DynamicWebsite.Models.PageModel, DynamicWebsite.Models.CommentModel>
@helper GetParentTitle(int id)
{
    if (id != 0)
    {
        DynamicWebsite.DataLayer.EFDbContext x = new DynamicWebsite.DataLayer.EFDbContext();
        var item = x.PageModels.Find(id);
        x.Dispose();
    @GetParentTitle(item.ParentId);
    <span>| </span><a href="@item.PageId">@item.PageTitle</a>

    }
    else
    {
    @Html.ActionLink("Home", "Index", "Home")}
}
@GetParentTitle(Model.Item1.PageId)
@if (Model.Item1.IsActive)
{

    ViewBag.Title = Model.Item1.PageTitle;

    <fieldset>
        <legend>PageModel</legend>

        <div class="display-label">
            Page Subject:<h2>@Model.Item1.PageSubject</h2>
        </div>
        <p>
            @foreach (var item in Model.Item1.PageContentModels)
            {
                @item.Content
            }
        </p>
        @if (Model.Item1.UpdateDate > Model.Item1.CreateDate)
        {
            <h5>Create Date: @String.Format("{0:g}", Model.Item1.CreateDate)</h5>
            <h5>UpdateDate: @String.Format("{0:g}", Model.Item1.UpdateDate)</h5>
        }
        else
        {
            <h5>Create Date: @String.Format("{0:g}", Model.Item1.CreateDate)</h5>
        }
        @foreach (var item in Model.Item1.CommentModels)
        {
            if (item.IsActive)
            {
            <h3>@item.CommentAuthor said:</h3>
            <p>@item.CommentContent</p>
            <h5>Create Date: @String.Format("{0:g}", item.CreateDate)</h5>
            }
        }
    </fieldset>

    using (Html.BeginForm())
    {
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>CommentModel</legend>
            <div class="editor-label">
                @Html.LabelFor(model => model.Item2.CommentAuthor)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.Item2.CommentAuthor)
                @Html.ValidationMessageFor(model => model.Item2.CommentAuthor)
            </div>

            <div class="editor-label">
                @Html.LabelFor(model => model.Item2.CommentContent)
            </div>
            <div class="editor-field">
                @Html.EditorFor(model => model.Item2.CommentContent)
                @Html.ValidationMessageFor(model => model.Item2.CommentContent)
            </div>
        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
    }

}
else
{
    ViewBag.Title = "Deactive";
    <p>This page deactive.</p>
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:27:30.573

创建新模型错误已更正

```
public class PageViewModel
    {
        public PageModel PageModel { set; get; }
        public CommentModel CommentModel { set; get; }
    } 
```

# php - PHP上的实时控制弹出框消息

> ID：15297366
> 
> 赞同：-2
> 
> 时间：2013-03-08T15:23:05.467
> 
> 标签：php, javascript, json

我正在开发一个小型实时项目，我正在寻找一些东西来发送实时公告/弹出消息（我可以控制）以将管理员控制的消息推送给网页上的所有用户。

我在互联网上遇到了一个叫做[实时播音员](http://codecanyon.net/item/realtime-announcements-bar-no-reloading-required/300845)的东西，但由于公司政策，代码必须由我们自己编写。

现在我做了什么，我在数据库“CTrealtimeUpdates”上创建了一个表，它将保存更新，在.php页面上我想创建一些东西，只有当表是时才会激活一个带有来自数据库的回显消息的javascript弹出框更新最后 10 秒的任何新闻（这适用于页面上的活跃用户）和最后 5 分钟的任何刚刚访问过该页面的人。

数据库表：

日期： 时间： 公告： 播音员：

我创建的只是表格，我被困在页面上应该做什么代码。

感谢您的帮助。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:27:10.363

PHP 不能向客户端推送任何内容。您要做的是设置一个定期运行的 javascript，以检查是否有任何要显示的公告。

//jk

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:28:17.757

检查这个： [如何用 PHP 实现 COMET](http://www.zeitoun.net/articles/comet_and_php/start)

# c# - 无法从 C# 中的 Oracle 存储过程中检索出参数

> ID：15297367
> 
> 赞同：0
> 
> 时间：2013-03-08T15:23:08.290
> 
> 标签：c#, oracle, stored-procedures, output-parameter

这是我的存储过程（使尝试隔离问题变得简单，所以我现在要做的就是设置 OUT 参数）：

PROCEDURE DequeuePPLPlatformMsg (msgType OUT VARCHAR2, msgBody OUT VARCHAR2) 开始

```
 msgType := 'TESTTYPE';
    msgBody := 'TESTBODY';

END DequeuePPLPlatformMsg; 
```

这是我调用存储过程并尝试获取 OUT 参数中的值的 C# 代码：

```
 OConn = new OracleConnection();
            OConn.ConnectionString = "Password=mypw; User ID=myid; Data Source=devdb;";
            OConn.Open();
            OComm = new OracleCommand(StoredProc, OConn);
            OComm.CommandType = System.Data.CommandType.StoredProcedure;

        OComm.Parameters.Add("msgType", OracleDbType.Varchar2, 255, System.Data.ParameterDirection.Output);
        OComm.Parameters.Add("msgBody", OracleDbType.Varchar2, 255, System.Data.ParameterDirection.Output);

                int Result = OComm.ExecuteNonQuery();

                OConn.Close();

                String msgType = OComm.Parameters["msgType"].Value.ToString();
                String msgBody = OComm.Parameters["msgBody"].Value.ToString(); 
```

当我查看参数中的值时，它们包含空字符串。

有任何想法吗？谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-27T18:36:14.270

对不起，这里是详细信息...

这是存储过程：

PROCEDURE DequeuePPLPlatformMsg (msgType OUT VARCHAR2, msgBody OUT VARCHAR2) 开始

```
msgType := 'TESTTYPE';
msgBody := 'TESTBODY'; 
```

END DequeuePPLPlatformMsg;

这是 C# 代码：

```
 OConn = new OracleConnection();
        OConn.ConnectionString = "Password=mypw; User ID=myid; Data Source=devdb;";
        OConn.Open();
        OComm = new OracleCommand(StoredProc, OConn);
        OComm.CommandType = System.Data.CommandType.StoredProcedure;

        OracleParameter msgTypeParam = new OracleParameter("msgType", OracleDbType.Varchar2);
        msgTypeParam.Direction = System.Data.ParameterDirection.Output;
        msgTypeParam.Value = "";
        msgTypeParam.Size = 255;
        OComm.Parameters.Add(msgTypeParam);

        OracleParameter msgBodyParam = new OracleParameter("msgBody", OracleDbType.XmlType);
        msgBodyParam.Direction = System.Data.ParameterDirection.Output;
        OComm.Parameters.Add(msgBodyParam);

            int Result = OComm.ExecuteNonQuery();

            OConn.Close();

            String msgType = msgTypeParam.Value.ToString(); 
```

msgType 是 String.Empty

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:38:21.173

您是否尝试过简单地按值访问它？

```
Dim retValParam As New OracleClient.OracleParameter("p_retVal", OracleClient.OracleType.VarChar)

retValParam.Direction = ParameterDirection.Output
retValParam.Size = 100
retValParam.Value = ""
command.Parameters.Add(retValParam)

command.ExecuteNonQuery()
retVal = retValParam.Value 
```

# nhibernate - Fluent NHibernate 父/子关系中的奇数映射问题

> ID：15297375
> 
> 赞同：0
> 
> 时间：2013-03-08T15:23:31.050
> 
> 标签：nhibernate, fluent-nhibernate, nhibernate-mapping

我有一个 Foo 类，它可以有一个父 Foo、许多子 Foo 和许多 Snafu。NHibernate 正在 Foo 和 Snafu 表中生成 Foo_id 和 ParentFoo_id。重复字段不仅浪费内存，而且当其中一个重复引用最终为 NULL 时也会导致问题。这是使用 SQL Server 2012。

为什么会发生这种情况，我怎样才能让它生成一个 Foo_id？

Foo 类和映射：

```
public class Foo {
  public int Id { get; set; }
  public Foo ParentFoo { get; set; }
  public IList<Foo> ChildFoos { get; set; }
  public IList<Snafu> Snafus { get; set; }
}
public class FooMap : ClassMap<Foo> {
  public FooMap() {
    Id(x=>x.Id);
    References(x=>x.ParentFoo);
    HasMany(x=>x.ChildFoos);
    HasMany(x=>x.Snafus);
  }
}

----Resulting Foo Table----
Id (PK, int, not null)
Foo_id (FK, int, null)        <- refers to ParentFoo
ParentFoo_id (FK, int, null)  <- also refers to ParentFoo 
```

Snafu 类和映射：

```
public class Snafu {
  public int Id { get; set; }
  public Foo Foo { get; set; }
  public string Value { get; set; }
}
public class SnafuMap : ClassMap<Snafu> {
  public SnafuMap() {
    Id(x=>x.Id);
    References(x=>x.Foo);
    Map(x=>x.Value);
  }
}

----Resulting Snafu Table----
Id (PK, int, not null)
Foo_id (FK, int, null)        <- refers to Foo
ParentFoo_id (FK, int, null)  <- refers to same Foo
Value (nvarchar(255), null) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T02:29:20.977

父 foo 应该是反向的，并且您需要为两个映射指定列。所以正确的映射应该如下所示

```
References(x => x.ParentFoo)
    .Column("PARENT_FOO_ID");

HasMany(x => x.ChildFoos)
    .Inverse() // Important!
    .KeyColumn("PARENT_FOO_ID"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T16:43:12.273

也许尝试在引用映射中明确指定列名？我猜，但这就是我为类似情况完成一些映射的方式。

```
public class FooMap : ClassMap<Foo> {
  public FooMap() {
    Id(x=>x.Id);
    References(x=>x.ParentFoo, "ParentFoo_id");
    HasMany(x=>x.ChildFoos);
    HasMany(x=>x.Snafus);
  }
} 
```

# ios - iOs 模态转换，如 Mailboxapp

> ID：15297379
> 
> 赞同：4
> 
> 时间：2013-03-08T15:23:46.727
> 
> 标签：ios, modal-dialog, transition, uipageviewcontroller

几天前，我开始为我的雇主开发一个 iOs 应用程序。他们希望获得像 MailBox 应用程序这样的转换流程。我已经想出了如何在左侧进行拆分菜单，但我不知道如何在您点击电子邮件时进行从后面传来的模态转换。进入电子邮件后，您可以滑回收件箱。这可能是由 PageViewController 实现的吗？如果没有，有人知道如何达到这样的效果吗？

非常感谢你 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T10:23:21.983

我也在寻找一些模态过渡动画并找到了这两个框架： [https://github.com/mikefrederick/MFFadeBackModalAnimation](https://github.com/mikefrederick/MFFadeBackModalAnimation) [https://github.com/ucu072/HCPushBackAnimation](https://github.com/ucu072/HCPushBackAnimation)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:32:07.897

我认为您指的是您可能在此处找到的自定义控件：http: [//www.cocoacontrols.com](http://www.cocoacontrols.com)或 Github。如果不一样，您会发现类似的东西，或者您必须自己创建它:)

# time-limiting - CodeChef 上的时间限制是如何计算的？

> ID：15297381
> 
> 赞同：2
> 
> 时间：2013-03-08T15:23:50.297
> 
> 标签：time-limiting

在 CodeChef 的 3 月挑战赛中，“随机递减函数”问题的 Java 解决方案已被接受，耗时超过 30 秒，但给定的时间限制为 2 秒。这远远超过 Java 允许的两倍（四秒）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-01-13T08:26:34.320

指定的时间限制仅适用于一个测试文件。有许多测试文件，您提交的最后时间是通过所有测试文件所需的总时间。

引用[CodeChef 常见问题页面](http://www.codechef.com/wiki/faq)：

> ## 我的提交显示的执行时间是什么意思？
> 
> CodeChef 可能会使用不同的输入文件多次测试您的代码。如果您的代码在每个输入文件的时间限制内给出了正确答案，则显示的执行时间是每个测试用例花费的总时间。
> 
> 如果您的代码未正确传递输入文件，则时间限制将是所有输入文件的总时间，包括您失败的文件，但不包括任何其他文件。
> 
> 一个例子：假设有 5 个输入文件，每个文件的时间限制为 2 秒。您的程序在每个输入文件上运行 1 秒钟并产生正确的答案。显示的总时间为 5 秒 - 这很好，因为时间限制仅适用于每个输入文件。
> 
> 另一方面，假设前 2 个输入文件在 1 秒内正确，第三个在 1.5 秒内不正确。您报告的时间为 3.5 秒。
> 
> 人们经常在很快改变到超出时间限制的时间内被错误的答案弄糊涂。这是因为第一个输入文件很小；错误答案意味着不包括大型输入文件的时间。

# .net - 可以从 Access 2010 调用 .NET 4.5 程序集吗？

> ID：15297383
> 
> 赞同：0
> 
> 时间：2013-03-08T15:23:54.417
> 
> 标签：.net, ms-access, vba, .net-4.5

基本上，问题就在标题中！我已经尝试过寻找这个并且什么都没有想出。

我需要知道的是，MS Access 2010 是否能够调用 .NET 4.5 dll？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:25:28.943

没有理由不会。你只需要让你的 DLL COM 可见，然后在机器上注册它。然后，您可以在 Access 2010 中通过 COM 从 VBA 实例化和调用组件。

如果您以前从未这样做过，我建议您开始查看这里的资源：

[向 COM 公开 .NET Framework 组件](http://msdn.microsoft.com/en-us/library/zsfww439.aspx)

# geolocation - 如何在地图上找到北、南、东、西的方向？

> ID：15297384
> 
> 赞同：0
> 
> 时间：2013-03-08T15:23:59.617
> 
> 标签：geolocation, geometry, bing, bing-maps

几天前我开始在地图上工作。我想得到一张图片并能够确定方向或者是以下值： **北，南，东，西**......但是我不知道如何计算......我很确定我的问题太简单了对大多数人来说。希望我的愚蠢问题惹恼了任何人^ ^

这是我的问题的图片。我知道中间的原始位置。

谁知道有一个**实用的公式来确定**北、南、东和西的方向？**或者是否可以通过默认向北移动**来要求生成地图？我使用必应地图肥皂服务

先感谢您

![在此处输入图像描述](../Images/78651d5bab7492cb54444315e4b7fac9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:37:18.240

使用 Bing Maps REST Imagery 服务时，图像的标题始终为北 = 图像顶部。

看，没有参数可以让你改变标题：http: [//msdn.microsoft.com/en-us/library/ff701724.aspx](http://msdn.microsoft.com/en-us/library/ff701724.aspx)

# php - PHP，正则表达式，反向引用

> ID：15297386
> 
> 赞同：3
> 
> 时间：2013-03-08T15:24:01.763
> 
> 标签：php, regex, backreference

我试图理解以下段落（来自 Php.net: [Link](http://php.net/manual/en/regexp.reference.back-references.php)）：

> 但是，如果反斜杠后面的十进制数小于 10，则始终将其作为反向引用，并且仅当整个模式中没有那么多捕获左括号时才会导致错误。换句话说，对于小于 10 的数字，引用的括号不必位于引用的左侧。当涉及重复并且右侧的子模式参与了较早的迭代时，“向前向后引用”可能有意义.

据我所知，如果小数小于 10，则计算模式的所有左括号，如果数字大于 10，则仅计算我使用参考时的左括号（例如 \13） .

例如：

假设我们有这个简单的模式：

```
'/^(a)(b)(c)(d)\6(e)(f)(g)(h)(i)(j)(k)(l)(m)(n)$/';

This is the string we testing: abcdfefghikjklmn 
```

所以有 php.net 说：

> 换句话说，对于小于 10 的数字，引用的括号不必位于引用的左侧

因此，如示例所示，引用的括号在右侧，并且引用编号小于 10，那么为什么 preg_match 返回 0？

如果有人可以帮助理解这一段，谢谢大家，祝你有美好的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:39:31.230

> 在字符类之外，后跟大于 0 的数字（可能还有更多数字）的反斜杠是对模式中较早（即其左侧）捕获子模式的反向引用，前提是之前存在许多捕获左括号。
> 
> 但是，如果反斜杠后面的十进制数小于 10，则始终将其作为反向引用，并且仅当整个模式中没有那么多捕获左括号时才会导致错误。换句话说，对于小于 10 的数字，引用的括号不必位于引用的左侧。当涉及重复并且右侧的子模式参与了较早的迭代时，“向前向后引用”可能有意义.

`\n`解释（`n > 0`总是）：

*   `n <= 9`: 始终是对第 th 组的反向引用`n`（无论捕获组在哪里）。`n`如果捕获组少于 ，则会导致错误。
*   `n >= 10`：如果在它之前至少有`n`多个捕获组（开始），则只有一个反向引用。否则，它是一个转义序列，就像在常规字符串中一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:40:07.553

> 换句话说，对于小于 10 的数字，引用的括号不必位于引用的左侧。当涉及重复并且右侧的子模式参与了较早的迭代时，“向前向后引用”可能有意义.

这意味着这样的事情是有效的：

```
(0\2|(112*))+ 
```

如您所见，甚至在遇到`\2`第二个左括号之前就声明了对第二个捕获组的反向引用。`(`

[**演示**](http://www.regex101.com/r/cI5uG2)（忽略regex101的错误，分析没有处理这种情况）

另一个有效的例子：

```
^(^a|aa\1)*$ 
```

此正则表达式将匹配任何仅包含`a`长度为平方数的字符串，否则拒绝。这是被引用的括号内的反向引用示例。

[**演示**](http://www.regex101.com/r/zL1jN2)

# javascript - IE7 Ajax 内存不足错误

> ID：15297388
> 
> 赞同：4
> 
> 时间：2013-03-08T15:24:04.920
> 
> 标签：javascript, jquery, internet-explorer-7

我正在处理的脚本进行 ajax 调用，它在 Firefox、chrome 和 IE8+ 上运行良好。但是在 IE7 上，我遇到了内存不足的错误。内存高达 120MB。我正在使用 jQuery 1.8.3。该错误也发生在 jQuery 1.9 和 1.7 中。

来源：

```
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: 'data.asmx/GetChildren',
    data: '{parent:"program","child":"office","id":' + this.Item_id + '}',
    dataType: 'json',
    success: function (r) {
        var data = r.d.data;
    }
}); 
```

这是我为 IE7 获得的配置文件：

![](../Images/17e3a86725820b22a9c20f45383779f1.png)

编辑：用源代码更新编辑：终于有时间再次解决这个问题。原来是一个简单的循环问题。不是 jQuery ajax 的错。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T12:44:29.887

如果孩子的数量更多，那么返回的值`var data`会更多。

JSON 字符串的最大长度。默认值为 2097152 个字符，相当于 4 MB 的 Unicode 字符串数据。[来源微软](http://msdn.microsoft.com/en-us/library/system.web.script.serialization.javascriptserializer.maxjsonlength.aspx)

所以大小不是问题，但是字符如果超过那就是​​一个问题。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-15T21:48:21.527

您是否尝试发送 JSON.stringify 而不是 Object，并在服务器端解码？

```
https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T09:24:51.393

如果已禁用虚拟内存，则可能会出现此问题。
要启用虚拟内存，请执行以下步骤：

单击开始按钮，指向设置，然后单击控制面板。双击系统图标。在性能选项卡上，单击虚拟内存。单击“让 Windows 管理我的虚拟内存设置（推荐）”选项。或者，如果您必须使用自己的虚拟内存设置，请为最大大小留出尽可能多的空间。单击确定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T13:58:11.137

```
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: 'data.asmx/GetChildren',
    data: '{parent:"program","child":"office","id":' + this.Item_id + '}',
    dataType: 'text',
    success: function (r) {
        var data = (eval("[" + r + "]")[0]).d.data;
    }
}); 
```

*   将数据类型更改为“文本”。
*   使用 eval("[" + textJson + "]")[0] 获取对象数据。
*   *   如果仍然失败，将“var data = ...”行替换为“var data = r;” 并报告是否也失败了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-15T16:34:15.243

根据 jQuery 文档，您可以传递纯对象，因此我建议改用对象。您也可以尝试像这样使用Id，看看它是否有任何区别。

```
var id = this.Item_id; //
$.ajax
({
    type: "POST",
    url: 'data.asmx/GetChildren',
    data: {"parent":"program","child":"office","id": id},
    dataType: 'json',
    success: function (r) 
    {
        //Please use console.log(r) and see what is coming back here
    }
}); 
```

或者干脆

```
var id = this.Item_id; //
$.post("data.asmx/GetChildren", 
{
    "parent":"program",
    "child":"office",
    "id": id
}, function(r)
{
    //console.log(r);
},"json"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T15:34:07.783

不知道这是否与您的问题有关，但有两件事使您的数据成为无效的 JSON。

`parent`必须用引号括起来，就像`id`值一样（您只是关闭和重新打开字符串）。

所以，它应该是这样的：

```
$.ajax({
        type: "POST",
        contentType: "application/json; charset=utf-8",
        url: 'data.asmx/GetChildren',
        data: '{"parent":"program","child":"office","id":"' + this.Item_id + '"}',
        dataType: 'json',
        success: function (r) {
            var data = r.d.data;
        }
}); 
```

# python - 在 Python 中导入 PyQGIS 模块时出现问题

> ID：15297391
> 
> 赞同：1
> 
> 时间：2013-03-08T15:24:23.173
> 
> 标签：python, shell, batch-file, qgis

由于我之前的问题已经结束，我正在努力改进它，让社区了解它可能对广大用户有用。我找到了一个 SHELL LAUNCHER，它允许以“传统方式”绕过系统环境设置来集成 python 和 QGIS（即使用 PyQGIS）。原始版本完美运行（在[http://inasafe.linfiniti.com/html/id/developer-docs/platform_windows.html](http://inasafe.linfiniti.com/html/id/developer-docs/platform_windows.html)找到它）。我一直在尝试修改它以让任何人使用他自己喜欢的 IDE（而不是像原来的那样使用 Windows 命令提示符）。因此，我进行了修改并最终使用了这个命令启动器：

```
@echo off
SET OSGEO4W_ROOT=C:\QUANTU~1
call "%OSGEO4W_ROOT%"\bin\o4w_env.bat
call "%OSGEO4W_ROOT%"\apps\Python27\Lib\idlelib\idle.pyw # this is the IDE I wanna use, but You can freely point to whatever You'd like
@echo off
SET GDAL_DRIVER_PATH=%IDLE%\bin\gdalplugins\1.9
path %PATH%;%OSGEO4W_ROOT%\apps\qgis\bin
path %PATH%;%OSGEO4W_ROOT%\apps\grass\grass-6.4.2\lib
path %PATH%;"%OSGEO4W_ROOT%\apps\Python27\Scripts\"

set PYTHONPATH=%PYTHONPATH%;%OSGEO4W_ROOT%\apps\qgis\python;
set PYTHONPATH=%PYTHONPATH%;%OSGEO4W_ROOT%\apps\Python27\Lib\site-packages
set QGIS_PREFIX_PATH=%OSGEO4W_ROOT%\apps\qgis

start "Quantum GIS Shell" /B "cmd.exe" %* 
```

无论如何，当我运行它时，它会打开 idle.pyw 但我无法导入模块，就像系统变量仍然没有正确设置一样，尽管它们似乎是通过调查 sys.path 来实现的。导入（例如）“qgis.core”模块时出现的错误是：

```
ImportError: DLL load failed: Impossibile trovare il modulo specificato # (impossible to import the specified module) 
```

我的操作系统是 Windows XP sp3，Python 是 2.7.3，QGIS 是 Lisboa v.1.8。我希望有人可以帮助我，这可能有助于解决导入 PyQGIS 模块的常见问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:23:39.213

最终我设法拥有了个人 shell 发射器！诀窍是调查`o4w_env.bat`文件，以了解第二行的“调用”实际上做了什么。

所以我尝试并成功了：

1.  将`idle.pyw`（或您要使用的 IDE）复制到`Quantum GIS`主文件夹（在我的情况下是`C:/Quantum_GIS_Lisboa`）

2.  复制 SHELL LAUNCHER（见第 3 点），扩展名为`.bat`“\bin”

3.  运行这个 SHELL LAUNCHER（简单的双击）：

    ```
    @echo off

    SET OSGEO4W_ROOT=C:\QUANTU~1

    call "%OSGEO4W_ROOT%"\bin\o4w_env.bat

    @echo off

    SET GDAL_DRIVER_PATH=%IDLE%\bin\gdalplugins\1.9
    path %PATH%;%OSGEO4W_ROOT%\apps\qgis\bin
    path %PATH%;%OSGEO4W_ROOT%\apps\grass\grass-6.4.2\lib
    path %PATH%;"%OSGEO4W_ROOT%\apps\Python27\Scripts\"

    set PYTHONPATH=%PYTHONPATH%;%OSGEO4W_ROOT%\apps\qgis\python;
    set PYTHONPATH=%PYTHONPATH%;%OSGEO4W_ROOT%\apps\Python27\Lib\site-packages
    set QGIS_PREFIX_PATH=%OSGEO4W_ROOT%\apps\qgis

    start "Quantum GIS Shell" /B "idle.pyw" %* # This is where you specify the IDE 
    # you want to use, mine is "idle.pyw", but if You copy another one (as in point 1), 
    # you should replace "idle.pyw" with "<YOUR_IDE>" 
    ```

希望这可以帮助任何人。干杯!

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2017-03-08T04:50:49.943

# 运行 Qgis 并打开 python 控制台输入以下内容

1.  导入系统
2.  系统路径

    ### 现在复制此路径并在顶部包含 python 代码的 sys 路径。

现在运行该代码。

# php - Mysql查询返回错误的行

> ID：15297392
> 
> 赞同：0
> 
> 时间：2013-03-08T15:24:29.627
> 
> 标签：php, mysql, sql, phpmyadmin

我有一个简单的 mysql 数据库，其中用户有自己的事件表和受邀事件表。

```
User-->>Own events (user_id is foreign key )
User and Own events-->>Invited Events(user_id is foreign key, event id is foreign key) 
```

我想从等于某个数字的地方获取`OWN EVENT`详细信息`Invited Events``user_id`

例子：

![在此处输入图像描述](../Images/0d971ae68328fda91ae0a4b3aa5e3cfe.png)

我尝试：

```
$user_id = $_POST["user_id"];
$stmt = $mysqli->query("SELECT A1.event_id,A1.root_folder,A1.event_name,A1.date,A1.location,A2.user_id FROM OWN_EVENTS A1, INVITED_EVENTS A2 WHERE A2.user_id=$user_id");

$rows = array();
while($r = mysqli_fetch_assoc($stmt)) {
    $rows[]=$r;
} 
```

这应该给我（一行）事件详细信息`event_id=3` ，`user_id=58` 但这会返回`OWN_EVENTS`表中的所有行。

我究竟做错了什么 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:26:34.293

目前，您查询返回笛卡尔积。

您需要告诉优化器这两个表是如何相互连接的。

```
SELECT  A1.event_id,A1.root_folder,A1.event_name,A1.date,A1.location,A2.user_id 
FROM    OWN_EVENTS A1 
        INNER JOIN INVITED_EVENTS A2 
           ON A1.columnName = A2.columnsName  // columns that defines their relationship
WHERE   A2.user_id=$user_id 
```

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

# sql-server - 从选择查询修改 SQL 结果

> ID：15297404
> 
> 赞同：0
> 
> 时间：2013-03-08T15:25:11.860
> 
> 标签：sql-server, tsql, sql-server-2005

我想获取以下查询的结果并对 NAME_UD_AFFILIATIONS 执行更新并将 Member_Status 字段设置为 N。

我正在使用 SQL Server Management Studio 2005 Ver。Windows 7 上的 9.0

```
SELECT *
FROM NAME
INNER JOIN Name_UD_Affiliations ON NAME.ID=Name_UD_Affiliations.ID
WHERE 
NAME_UD_AFFILIATIONS.Member_Status='R' and 
Name.Join_Date > '2012-9-1' and 
Name.Paid_Thru > '2013-09-01' 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:26:41.757

使用 SQL-Server 你可以做到

```
UPDATE Name_UD_Affiliations 
SET Member_Status = 'N'
FROM NAME
 INNER JOIN Name_UD_Affiliations ON NAME.ID=Name_UD_Affiliations.ID
WHERE NAME_UD_AFFILIATIONS.Member_Status='R'
AND Name.Join_Date > '2012-9-1'
AND Name.Paid_Thru > '2013-09-01' 
```

# java - 在声明 cassandra 系列时指定 column_metadata 总是一个好主意吗？

> ID：15297406
> 
> 赞同：0
> 
> 时间：2013-03-08T15:25:19.783
> 
> 标签：java, cassandra, astyanax

我知道 column_metadata 可用于为任何列提供配置，但通常情况下，我不需要特定于列的配置。在这种情况下，创建家庭时使用 column_metadata 有什么好处吗？

具体来说，写作有什么好处：

```
create column family session
    with comparator = UTF8Type
    and column_metadata =
    [{
        column_name : account,
        validation_class : UTF8Type
    }
]; 
```

代替

```
create column family session
    with comparator = UTF8Type; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T04:26:19.797

这是关于 Comparators 或 Validation_class 的问题吗？这两个 AFAIK 有两个非常不同的含义。

在你上面的例子中，我读它的方式是

1）您的 Column_names 将是 UTF8Type 字符串。2) 您没有定义任何 default_validation_class，因此每个 column_value 都使用字节类型进行验证（即没有验证） 3) 您希望“帐户”列具有 UTF8 类型的值。如果您要存储其中没有字母的帐号，您可以指定一个 Long 类似这样的东西。

```
**创建列族会话
    比较器 = UTF8Type
    和 column_metadata =
    [{
        列名：帐户，
        验证类：长
    }
];**

```

在此之后，在您的帐户栏中，您只能存储数字。

简而言之，Comparator 是 Column_Name 的数据类型。Validation_class 用于列的值，对于不同的列可以不同。希望这可以帮助。

# asp.net-mvc-4 - MVC 验证在 Knockoutjs 帖子中丢失

> ID：15297410
> 
> 赞同：3
> 
> 时间：2013-03-08T15:25:24.497
> 
> 标签：asp.net-mvc-4, knockout.js, validation, asp.net-mvc-viewmodel

我正在使用 MVC4 和淘汰赛。我在页面上有一个强类型为视图模型的表单。在该视图模型中，我定义了一些验证，例如：

```
[Required(ErrorMessage = "Title is required")]
public string Title { get; set; } 
```

如果我在未填写必填字段的情况下向表单发送标准帖子，我的操作会看到模型无效并返回视图，并且会显示一条主要验证消息，因为我`@Html.ValidationSummary`的表单中有。单个字段也被标记为无效（带有消息），因为我已`@Html.ValidationMessageFor`与该字段相关联

所以然后我添加了淘汰赛，而不是仅仅发布我现在调用的表格`ko.utils.postJson($("form")[0], self);`。现在大部分工作正常，如果我发布未填充必填字段的表单，我的操作会检测到模型无效并返回视图，但现在没有显示单独的验证消息。

帖子前填写的字段也丢失了。我试图通过读取 mvc 视图模型并将变量设置为这些值来解决这个问题。

```
var model = @Html.Raw(Json.Encode(Model)); 
```

然后在我的淘汰赛视图模型中设置该值

```
self.Title = ko.observable(model.Title); 
```

但是当我输入'1'时，当失败的帖子返回时，它会用'“1”'填写该字段。

这不是一个太复杂的表单，所以如果可以避免的话，我不想引入一些新的验证层。我不介意有一个验证帖子。

谢谢，丹

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T22:01:15.553

我问什么。在过去的两周里，我一直在探索这个话题。（如果您愿意，请查看我最近几天的问题）。**我得出的结论是，不幸**的是，数据注释和流利的验证在使用淘汰赛的客户端上不起作用。因此，您*必须*引入另一层验证。

好消息是它经过良好测试并且与淘汰赛一样标准。

您主要有三个选择：

*   [淘汰赛验证](https://github.com/ericmbarnard/Knockout-Validation)
*   [敲敲](https://github.com/Enome/knockknock)
*   [jQuery 验证](https://github.com/jzaefferer/jquery-validation)

我期待社区倾向于建议使用 jQuery one，但显然主流的淘汰赛验证是那里的首选。它的行为与数据注释非常相似，但显然是在剔除视图模型字段上完成的。

希望这会有所帮助（不要射击信使:)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-17T17:37:43.047

我目前正在研究类似的情况，正在做一个混合 web api / MVC 项目。只有详细信息页面从控制器接收任何数据。休息由淘汰赛处理。到目前为止我可以看到的选项（一些经过测试，一些合格的猜测）：

1.  通过 ViewModel 和 Knockout Clientside ViewModel 复制您的验证逻辑（最好使用上面建议的 Knockout-Validation）。我本能地觉得很时髦。
2.  使用 jquery 不显眼的验证将您的表单设置为常规的 mvc 强类型表单。

1,2：使用敲除/jquery处理事件（当表单被认为有效时）。如果 async post 包含错误，则返回并显示它们（一些 css / less / sass 框架，如 bootstrap 已经准备好 alertbox 类，例如将错误放入）。

1.  查看[MVC 控制工具包 clientblock](https://mvccontrolstoolkit.codeplex.com/wikipage?title=Client%20Block%20complete%20example)。我计划自己测试这个选项，看起来很有希望。
2.  试试[KnockoutMvc](http://knockoutmvc.com/)，这似乎也能帮助解决这个问题。

# python - 如何将函数的python代码打印到终端？

> ID：15297413
> 
> 赞同：3
> 
> 时间：2013-03-08T15:25:28.257
> 
> 标签：python, function, terminal

我有一个系统，我在其中不断试验函数的内容，然后运行程序。由于我经常打开很多终端窗口，所以有时我并不确切知道哪个版本的功能属于哪个终端窗口。

有没有办法将特定功能的源代码打印到终端？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:07:37.923

好吧。感谢 Hoopdady 在 Stackoverflow 上提供了类似的问题。只是为未来的读者提供解决方案。我需要使用检查模块，并使用它的方法“getsource”我可以简单地将方法或函数的源打印到命令行。

```
import inspect
import mymodule
print inspect.getsource(mymodule.sayHello) 
```

谢谢哈普达迪！

# c# - 以编程方式添加控件 - 并访问它的参数

> ID：15297416
> 
> 赞同：0
> 
> 时间：2013-03-08T15:25:33.683
> 
> 标签：c#, .net, user-controls, dynamic-usercontrols

我有以下控制：

```
public partial class Controls_ProductPanel : System.Web.UI.UserControl
{
    private int _ProductID;
    public int ProductID
    {
        get
        {
            return _ProductID;
        }
        set
        {
            _ProductID = value;
        }
    }

    protected void Page_Load(object sender, EventArgs e)
    {

    }
} 
```

我希望能够将它添加到这样的页面：

```
Controls_ProductPanel panel = new Controls_ProductPanel();
panel.ProductID = 2;
Page.Controls.Add(panel); 
```

但 Visual Studio 似乎并没有协调`Controls_ProductPanel`

我得到：

```
 The type or namespace name 'Controls_ProductPanel' could not be found. (Are you missing a using directive or an assembly reference?) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:48:58.507

为了解决这个问题，我不得不将注册标签放在 .aspx 页面上。这使我可以访问它的类型。

```
 <%@ Register TagName="ProductPanel" TagPrefix="uc" Src="~/Controls/ProductPanel.ascx" %> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-08T15:28:35.420

看看这个线程：

> [找不到类型或命名空间名称](https://stackoverflow.com/questions/4764978/the-type-or-namespace-name-could-not-be-found)

希望能帮助到你

# jquery - 将推文添加到 JQuery 列表中，出现刷新问题

> ID：15297417
> 
> 赞同：0
> 
> 时间：2013-03-08T15:25:35.260
> 
> 标签：jquery, cordova, jquery-mobile, twitter

我很难弄清楚 A) 如果这是解析 Twitter JSON 响应并将其放入 jquery 列表的最佳方式。B）为什么`<li>`当我刷新页面时项目会分崩离析。

这是我加载推文的方式

```
var _url = 'https://api.twitter.com/1/statuses/user_timeline/tortugatruck.json?callback=?&include_rts=1&count=3';
$.getJSON(_url,function(data){
for(var i = 0; i< data.length; i++){
        var tweet = '<p>'+data[i].text;
        var created = parseDate(data[i].created_at);
        var createdDate = created.getDate()+'-'+(created.getMonth()+1)+'-'+created.getFullYear()+' at '+created.getHours()+':'+created.getMinutes();
        tweet = tweet.parseURL().parseUsername().parseHashtag();
        tweet += '<div><div><a href="https://twitter.com/#!/CypressNorth" target="_blank" class="black">@CypressNorth</a></div><div class="right"><a href="https://twitter.com/#!/CypressNorth/status/'+data[i].id_str+'">'+createdDate+'</a></div></div>'
        //$("#twitter-feed").append('<p>'+tweet+'<p>');
        $("#twitter-feed").append($("<li><a href='#'>"+tweet+"</a></li>"));
        //$('#twitter-feed').listview('refresh');
    }
}); 
```

这是我的标记

```
 <div data-role="content">
        <ul data-role="listview" data-inset="true" id="twitter-feed">
            <li><a href="#">Tweets on a page</a></li>
        </ul>
    </div> 
```

我第一次导航到页面时它看起来不错（没有样式，但您可以看到各个列表项）。
![定义的列表项](../Images/fd833025c28ebc485060159b34432dfa.png)

但是如果刷新页面，我会失去列表项样式和导航能力。
![无法区分推文](../Images/167b05995bd9c44686b8d057c17b4a1e.png)

# ios - PFQueryTableViewController 与云功能一起使用

> ID：15297418
> 
> 赞同：0
> 
> 时间：2013-03-08T15:25:38.460
> 
> 标签：ios, objective-c, parse-platform

有我创建的云功能。

现在，如果我使用 PFQueryTableViewController 那么它有方法调用 queryForTable，我们可以通过它加载表。当我们尝试使用云功能时会出现问题。

我将如何使用云功能，它将与 PFQueryTableViewController 一起使用并提供它的内置功能，如刷新表和 loadMore 功能。

```
- (PFQuery *)queryForTable
{
PFQuery *query = [PFQuery queryWithClassName:self.className];
.....

return query;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:09:46.937

由于它是 a `PFQueryTableViewController`，它依赖于从 a 获取结果`PFQuery`。如果您`UITableViewController`的数据源不是`PFQuery`.

# r - 删除有很多零的列

> ID：15297419
> 
> 赞同：1
> 
> 时间：2013-03-08T15:25:39.980
> 
> 标签：r

我正在完善我的数据框以消除无用的变量。我做的第一步是使用以下命令删除具有超过一半行作为 NA 值的列：

```
limit <- nrow(mydata)/2
mydata <- mydata[, which(as.numeric(colSums(!is.na(mydata))) > limit)] 
```

我期待为零做同样的事情，但我找不到像“is.zero()”这样的函数，我该怎么做？

我期待做的另一件事是删除任何重复任何值超过“限制”次数的列（如果存在这样的命令，那将是理想的！）

非常感谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:26:25.430

做就是了：

```
mydata <- mydata[, which(as.numeric(colSums(mydata != 0)) > limit)] 
```

至于删除重复任何值超过“限制”次数的列，您可以使用`table`、`any`和`apply`：

```
mydata <- mydata[, which(apply(mydata, 2, function(col) !any(table(col) > limit)))] 
```

最后，请注意这两种情况`which`都是可选的，而`as.numeric`在您的第一种情况下是不必要的。你可以简单地做：

```
mydata <- mydata[, colSums(mydata != 0) > limit] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:26:30.067

要查找非零，只需替换`!is.na(mydata)`为`mydata != 0`.

要获得最频繁元素的计数，您可以使用：

```
> mydata <- c(1,2,3,4,1,1,1,2,1,3)
> sort(table(mydata), decreasing=T)[[1]]
[1] 5 
```

要查看重复次数最多的实际值：

```
> names(sort(table(mydata), decreasing=T)[1])
[1] "1" 
```

如果您不关心保留该值，则可以使用`max()`代替`sort()`：

```
> max(table(mydata))
[1] 5 
```

# sql - Oracle SQL：在 LEFT JOIN 的 t2 中使用 distinct(t1.field)

> ID：15297421
> 
> 赞同：1
> 
> 时间：2013-03-08T15:25:49.877
> 
> 标签：sql, oracle, left-join

我有一个 select 语句，它给出了一个时间范围内的活动。例如

```
Hour | Action | Count
---------------------
 00  | a1     | 23
 00  | a2     | 48
 01  | a1     | 16
 02  | null   | null
 03  | a1     | 5
 04  | a2     | 2 
```

您会看到，由于产生了这个结果的分组，所以没有计数 01 小时、动作 02 等等。我想要的是以下内容：

```
Hour | Action | Count
---------------------
 00  | a1     | 23
 00  | a2     | 48
 01  | a1     | 16
 01  | a2     | 0
 02  | a1     | 0
 02  | a2     | 0
 03  | a1     | 5
 03  | a2     | 0
 04  | a1     | 0
 04  | a2     | 2 
```

为此，我正在考虑确定行操作的不同值，然后将其与同一个表连接起来。这在 SQL 代码中是这样的：

```
select distinct(t2.action) as action 
from t2 as t1 
left join (select hour, action, count from <whatever to get the table>) as t2 
  on t1.action = t2.action 
```

但是如果我这样做，我可以理解地得到表 t2 在 t1 的 select 语句中无效的错误。

请帮助我提供任何建议以完成此操作。但我不想在原始表上做不同的（它有 5000 万个条目）。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:58:12.397

您可以使用外部联接+分区子句：

```
select hours.hour, t2.action, nvl(t2.count, 0)
  from (select distinct hour from t2) hours
       left outer join (select * from t2) t2
       partition by (t2.action)
                    on hours.hour = t2.hour
 where t2.action is not null
 order by hour, action; 
```

或者，如果您想生成 0-23 小时，无论行是否在表/视图中：

```
with hours as (select to_char(rownum-1, 'fm00') r from dual connect by level <= 24)
select hours.r, t2.action, nvl(t2.count, 0)
  from hours
       left outer join (select * from t2) t2
       partition by (t2.action)
                    on hours.r = t2.hour
 where t2.action is not null
 order by r, action; 
```

小提琴：[http ://sqlfiddle.com/#!4/27a40/1](http://sqlfiddle.com/#!4/27a40/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:48:25.610

您需要在内部查询中添加 group by 并在 distinct 周围删除 ()。这对我有用 - 类似于您的查询，但不包括计数：

```
SELECT distinct rm.user_id as user_id  -- rm.user_id comes from inner query
  FROM Readings r 
 LEFT JOIN  
 (
  SELECT r2.user_id, r2.reading_time, r2.x, r2.y
  FROM Readings r2
  ) rm   
 ON rm.user_id=r.user_id 
/ 
```

# ajax - YII中的AJAX查询字符串不匹配

> ID：15297423
> 
> 赞同：0
> 
> 时间：2013-03-08T15:25:58.537
> 
> 标签：ajax, url, yii, query-string

我在页面中有一个带有 AJAX 脚本的 YII 视图

```
 <script>
            $(".tasks-add").click(function(){
                $.ajax({
                    type: 'get',
                    url: '<?php echo $this->createUrl('field')?>',
                    data: {
                        index: 1
                          },
                    });
                });
        </script> 
```

现在这个 JS 正在以普通的 URL 样式（`http://myapp/task/field?index=1`）进行调用，尽管我已经使用 YII urlManager 来优化 URL 的“路径”样式，使用：

```
'urlManager'=>array(
              'urlFormat'=>'path',
              'showScriptName'=>false, 
```

我收到“错误请求错误”，因为 AJAX 请求的 URL 是旧的丑陋**?arg=value1 样式**。有没有办法让 AJAX 调用 URL 没有像`?index=1`但像这样的查询字符串`http://myapp/task/field/index/1`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T16:37:52.640

YII 方式

```
<script>
        $(".tasks-add").click(function(){
            $.ajax({
                type: 'get',
                url: '<?php echo $this->createUrl('field',array('index'=>1));?>'
            });
    </script> 
```

或者

```
<script>
        $(".tasks-add").click(function(){
            <?php echo CHtml::ajax(array(
                 'url'=>array('field','index'=>1),
                 'type'=>'get',
              ));?>
            });
    </script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:28:17.570

只需连接 URL 字符串。默认情况下，jQuery ajax 将在使用 GET 并包含数据时附加查询字符串参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:29:50.807

是的。手动完成。

```
 <script>
        $(".tasks-add").click(function(){
            $.ajax({
                type: 'get',
                url: '<?php echo $this->createUrl('field')?>'+'/index/1'
            });
    </script> 
```

# regex - 如何创建 RegEx 以从移动流量中分割平板电脑流量？

> ID：15297425
> 
> 赞同：0
> 
> 时间：2013-03-08T15:25:59.910
> 
> 标签：regex, google-analytics

到目前为止，我有这个： (1\d|[7-9])\d\d+x.*

问题是，它仍在拉动具有高屏幕分辨率的高端智能手机。
谁能想到任何可以过滤掉智能手机的附加功能？也许用这个 RegEx 过滤掉另一个维度？

谢谢！

*这个问题的解决方案会很好，但任何线索将不胜感激！

以下是一些示例数据：

```
Mobile Device Info  Screen Resolution
Apple iPad  768x1024
Apple iPhone    320x480
Apple iPhone    320x568
Apple iPod  320x480
(not set)   320x480
(not set)   720x1280
Motorola MOTXT912B Droid Razr 4G    540x960
Samsung GT-I9300 Galaxy S3  720x1280
(not set)   320x568
Samsung SGH-T999 Galaxy S3  720x1280
Samsung SGH-I747 Galaxy S3  720x1280
(not set)   1080x1920
Samsung SPH-L710 Galaxy S3  720x1280
Apple iPod  320x568
(not set)   1440x900
(not set)   540x960
DoCoMo SC-06D Galaxy SIII LTE   720x1280 
```

在这些情况下，Galaxy S3 正在被匹配，但我无法在不匹配所有其他平板电脑的情况下找到匹配它的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T16:17:18.317

当我查看高级细分时，我可以选择“平板电脑流量”（而不是“包括平板电脑的移动设备”）作为过滤器（如果我理解正确，这将使您的正则表达式变得不必要）。

# symfony - 在 Doctrine/Bundle/MongoDBBundle/DependencyInjection/Configuration.php 中找不到“MongoCursor”

> ID：15297427
> 
> 赞同：1
> 
> 时间：2013-03-08T15:26:09.677
> 
> 标签：symfony, doctrine, phpunit, symfony-2.1, mongodb-php

我正在为我的 Symfony2 项目中的一些服务编写一些单元测试。我需要通过服务容器访问服务，我正在使用这种方法：

```
class DummyTest extends \PHPUnit_Framework_TestCase
{
   protected static $kernel;
   protected static $container;

   public static function setUpBeforeClass()
   {
      self::$kernel = new \AppKernel('test', true);
      self::$kernel->boot();
      self::$container = self::$kernel->getContainer();
   }

  //test cases
} 
```

当*$kernel->boot()*被调用时，我得到以下错误：*'MongoCursor' not found in Doctrine/Bundle/MongoDBBundle/DependencyInjection/Configuration.php*。我查看了 Configuration.php 并没有提到*MongoCursor*。这是Bundle的版本问题吗？

**环境**： *Symfony2.1.6*和*DoctrineMongoDBundle 的 2.0.1 版本*。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T09:31:55.557

由于一个愚蠢的错误，我遇到了同样的问题——我没有启用 mongodb 扩展。

# architecture - 硬件中数字的 n 补码

> ID：15297430
> 
> 赞同：0
> 
> 时间：2013-03-08T15:26:10.860
> 
> 标签：architecture, numbers, hardware, mips, digits

你知道一种算法或一种方法来找出以 N 为底的数字的补码吗？

```
 For example number 001112 which is in base 3 . 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:47:36.920

对于具有 k 位数字的数字，从 (N ^k ) [N]中减去它（当然，执行以 N 为底的减法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:40:15.473

有关补码的定义，请参见[http://www.enggpedia.com/computer-engineering-encyclopedia/dictionary/dgital-logic-design/1603-complements-types-of-complements-radix-a-diminished-radix-complement](http://www.enggpedia.com/computer-engineering-encyclopedia/dictionary/dgital-logic-design/1603-complements-types-of-complements-radix-a-diminished-radix-complement) .
~~在您的示例中，补码为 3^6 - 001112(base 3) = (333333+1-001112)(base 3) = (332221+1)(base 3) = 332222。~~

编辑：

下面的评论当然是对的。很抱歉发布这样一个错误的例子。让我尝试重新表述我想说的话（如果我再次错了，请纠正我）：

你的例子，以基数 3 表示，是：

```
 1000000
- 001112
--------
= 221111 
```

问题是是否应该添加最后一个 1。
如果只有无符号数，则不需要加 1，但补码没有算术意义。
如果一个有符号数，补码可以解释为原数的一种负数，而不是负数本身。以 2为底的示例：
如果`n = 01101`，则*1 的补码*是。如果我们将两者相加，结果当然不为零。因此， 的*1 的补码*是NOT 。但是如果我们加上一个最终的 1，我们得到，即零。因此，构建*1 的补码*并添加 1 的结果称为*2 的补码*`n``10010``11111`*`n``-n``00000`**, 这可以解释为`-n`.
我认为对于任何基地都是如此。***

# r - 基于 row.names 合并数据框中的行

> ID：15297433
> 
> 赞同：3
> 
> 时间：2013-03-08T15:26:16.563
> 
> 标签：r, aggregate

抱歉，如果这个问题已经得到回答，但所有信息。我已经能够找到与合并数据框本身或以不同方式合并有关。我真的很感激任何想法。

我有一个非常大但非常简单的数据框，大约。22500 行和 48 列。我想根据行名合并数据框中的一些行，并且想知道是否有任何方法可以做到这一点。

数据框的一部分如下所示：

```
 Treatment1 Treatment2 Treatment3 Treatment4 Treatment5
    Nasvi2EG000001t1         28         43         33         25         64
    Nasvi2EG000002t2          0          3          0          0          4
    Nasvi2EG000002t5          0          0          0          0          0
    Nasvi2EG000002t6          0          0          0          0          0
    Nasvi2EG000004t1          1          0          0          0          0
    Nasvi2EG000009t1          0          4          2          0          4
    Nasvi2EG000013t1         21          8         17         19          7
    Nasvi2EG000014t1          0          3          0          0          4
    Nasvi2EG000014t2          0          4          0          0          3 
```

如您所见，第 2、3 和 4 行的名称相同，直到“t”后面的数字和第 8 行和第 9 行相同。我想将名称相似的行合并在一起......

我想结束的是：

```
 Treatment1 Treatment2 Treatment3 Treatment4 Treatment5
    Nasvi2EG000001t1         28         43         33         25         64
    Nasvi2EG000002            0          3          0          0          4
    Nasvi2EG000004t1          1          0          0          0          0
    Nasvi2EG000009t1          0          4          2          0          4
    Nasvi2EG000013t1         21          8         17         19          7
    Nasvi2EG000014            0          7          0          0          7 
```

对已合并的行中的值求和。

将非常感谢任何想法。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:32:30.847

假设您`data.frame`的名称为“SODF”，请从 中创建一个向量，该向量从 的末尾去除“ `row.names`t + some digit”`row.names`并将其用作您的聚合变量。

```
> aggvar <- gsub("(t[0-9]+$)", "", rownames(SODF))
> aggregate(. ~ aggvar, SODF, sum)
          aggvar Treatment1 Treatment2 Treatment3 Treatment4 Treatment5
1 Nasvi2EG000001         28         43         33         25         64
2 Nasvi2EG000002          0          3          0          0          4
3 Nasvi2EG000004          1          0          0          0          0
4 Nasvi2EG000009          0          4          2          0          4
5 Nasvi2EG000013         21          8         17         19          7
6 Nasvi2EG000014          0          7          0          0          7 
```

# php - PHP：类或全局中的数据库连接

> ID：15297438
> 
> 赞同：2
> 
> 时间：2013-03-08T15:26:27.950
> 
> 标签：php, database, class

我正在为学校做一个项目（截止日期在六月；有足够的时间^^）。

目前 conf.php 中有一个数据库（每个其他 .php 都包括这个；它有一个引用 mysqli 对象的变量），我正在通过“global $db_conn;”在类的每个方法中访问数据库。 ”。问题是，如果我只打开 class.php，它不包含 conf.php 并且会引发错误。所以我考虑为每个对象添加一个私有实例/静态变量。这不起作用（意外的 T_NEW）：

```
class foo{
    private static $db_conn = new mysqli("", "", "", "");
} 
```

你如何处理数据库连接？您将如何处理这个具体问题？

提前谢谢^^

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:28:46.367

您可以`include_once`在其他文件和类文件中使用 conf.php 文件。这样你总是有内容（和数据库参考）。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-08T15:38:12.670

如果您将 db 连接设置为[Singleton](http://en.wikipedia.org/wiki/Singleton_pattern)类*并且*您有一个 [`__autoload()`](http://php.net/autoload)函数，那么您可以在构建期间设置的每个类中都有一个 dbconnection 属性。

例如

```
class DBConnection{

  private static $instance;

  private function __construct(){
    //make your db connnection
  }

  public static function get_connection(){
    if(empty self::$instance) self::$instance = new DBConnection;
    return self::$instance;
  }
}

class Foo {

  private $db;

  function __construct(){
    $this->db=DBConnection::get_connection();
  }
} 
```

# open-source - 源文件头中的版权信息

> ID：15297451
> 
> 赞同：0
> 
> 时间：2013-03-08T15:26:57.597
> 
> 标签：open-source, licensing

我想开源一些代码。我应该在文件头中写什么？只是版权声明或许可文本？如果其他方为项目做出贡献，是否应将其版权声明添加到标题中？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T16:15:38.283

> 我应该在文件头中写什么？

这取决于许多事情，例如适用于文件的许可证、作者及其要求。

我将开始在该文件所属的软件的文件之上编写。就像软件的名字一样。你有名字吗？

> 只是版权声明或许可文本？

你或多或少可以自由选择。保持标题简短是常见的，因此您通常不会将完整的许可证文本放入每个源文件中。相反，通常将其放入`LICENSE`项目根目录中的一个文件中。

> 如果其他方为项目做出贡献，是否应将其版权声明添加到标题中？

但是，如果他们所做的贡献属于他们可能想要的版权，则无需放置实际的版权行来使其受版权保护。这是不需要的（在伯尔尼公约下不再需要 - 曾经是某个时候）。

要记录作者身份，签名补丁是跟踪事物的更好方法。现代源代码版本控制系统使这变得容易。

但是，您可能想在某处给予学分，因此您可以根据需要保留`AUTHORS`并`CONTRIBUTORS`归档。想想你想如何在你的项目中处理它并预先提供信息，以便贡献者知道你打算如何做这些事情。

# android - Android MediaPlayer 在哪里/如何缓存渐进式下载

> ID：15297456
> 
> 赞同：4
> 
> 时间：2013-03-08T15:27:10.780
> 
> 标签：android, media-player, progressive-download

默认情况下，我需要知道 MediaPlayer 在通过渐进式下载“流式传输”时缓存音频/视频内容的位置/方式。

我们正在评估 Android 媒体播放器应用程序的选项。值得关注的一项是防止内容被复制（在可能的范围内）。渐进式下载有很多好处，但我们需要确保采取合理的措施来保护媒体。我一定是在错误的地方进行了错误的搜索，因为我无法找到这方面的任何细节。我已经搜索了我们的测试设备的文件系统，试图从我们的测试渐进式下载应用程序中找到任何缓存的文件——但无济于事（这对我们来说可能很好）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T16:32:19.303

在 Android 中，`MediaPlayer`是一个抽象底层播放器引擎的顶级类。在 中`MediaPlayer`，整体处理分为 3 个主要部分：

```
MediaTrack ==> OMXCodec / ACodec ==> Sink 
```

解析器引擎基于哪`MediaTrack`一个轨道特定的实现。`MediaExtractor`

`MediaExtractor``DataSource`用抽象输入源的 a 进行初始化。对于您的渐进式下载，实现`DataSource`将是主要焦点，因为这将为下游组件提供缓冲区。由于Android平台工作在**拉**模型上，`DataSource`将控制提供数据的速率。

在 AOSP 中，您可以参考[http://androidxref.com/4.2.2_r1/xref/frameworks/base/media/java/android/media/MediaPlayer.java#2132](http://androidxref.com/4.2.2_r1/xref/frameworks/base/media/java/android/media/MediaPlayer.java#2132)中的示例实现。有关`HTTPSource`实施的更多信息，请[参阅 http://androidxref.com/4.2.2_r1/xref/frameworks/av/media/libstagefright/HTTPBase.cpp#47](http://androidxref.com/4.2.2_r1/xref/frameworks/av/media/libstagefright/HTTPBase.cpp#47)

# api - 理解和使用 Facebook API、Twitter API 等的正确指南

> ID：15297457
> 
> 赞同：0
> 
> 时间：2013-03-08T15:27:14.607
> 
> 标签：api, facebook-graph-api, twitter, google-api

我想为 Facebook、Twitter 等创建和处理各种 API。例如，为 Facebook 创建一个 APP，使用 facebook 自定义登录按钮（如按钮等）将其托管在我的网站上...

我需要了解像 Facebook、Twitter 或 Google 开发人员一样工作所需的所有基础知识。

我具有电气 Engg 背景，对我来说，通过直接浏览他们各自的开发人员网站很难理解这些概念。因为这些网站有各种语言的代码，我很难理解。所以我打算先弄清楚所需的基础知识，然后再研究 API。

有人可以建议一些循序渐进的指导方针，以便我可以继续深入了解所需的基础知识。（我有 C、C++、Java 和 Python 方面的编码知识。虽然处于中级水平，但不是专家。）

我想在这里问一下，因为完美的编码员只能完美地指导我。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:31:16.913

这门课程很简短，很重要，试一试： http: [//www.codecademy.com/tracks/apis](http://www.codecademy.com/tracks/apis)

# c# - 如何将文本框中的用户输入添加到数组或数组列表中

> ID：15297460
> 
> 赞同：1
> 
> 时间：2013-03-08T15:27:24.330
> 
> 标签：c#, arrays, arraylist

我正在创建一个礼品卡应用程序，用户将收件人信息输入到文本框中。该应用程序允许用户添加另一张礼品卡（最多 5 次）。我正在尝试找到一种方法将文本框输入添加到我可以稍后调用的数组或数组列表中，并将该信息显示在他们的“购物车”中。该应用程序在 C# 中，在 Visual Studio 2012 中有一个 webform 平台。到目前为止，对于 arraList，我有：

```
private ArrayList arrayList = new ArrayList();

protected void Page_Load(object sender, EventArgs e)
{
}

protected void btnEnter_Click(object sender, EventArgs e)
{
   arrayList.Add(txtFName.Text);

   if (arrayList.Count == 1)
   {
      lblFName.Text = arrayList[0].ToString();
   }

   if (arrayList.Count == 2)
   {
      lblFName.Text = arrayList[0].ToString();
      lblFName1.Text = arrayList[1].ToString();
   }
} 
```

我相信我只需要一种方法来增加数组中的输入，但我不知道该怎么做。任何有关其他途径的帮助或建议将不胜感激

这是收件人信息面板和购物车面板的代码。//

## 收件人信息：

需要提供将收到 Visa 预付卡的人的姓名。名字会出现在卡片上。

*名字：

中间名首字母：

*姓：

后缀：Jr. Sr. II III IV    

名字、中间名首字母、姓氏和后缀的组合不能超过 26 个字符。

## 礼品卡信息：

必须是 25.00 美元到 500.00 美元之间的整数，不带美元符号或小数。

*输入金额：

个性化消息：所有最好的一路顺风祝贺你毕业好运周年快乐生日快乐因为刚刚结婚圣诞快乐季节问候谢谢你

**或选择**   
自定义消息：

*   取消
*   背部
*   继续

//

```
 //<asp:Panel ID="pnlCart" runat="server" Width="100%" Visible="false">
        <asp:Panel ID="Panel1" runat="server" GroupingText="Card Choice 1" ForeColor="DarkBlue" Font-Bold="True" BorderStyle="NotSet" BorderColor="#E0E0E0">
            <div class="container">
                <div class="pair">
                    <div class="labelLeftBold">
                        Amount:
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartAmount" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                    <div class="labelLeftBold">
                        Card Design: 
                    </div>
                    <div class="imgCard">
                        <asp:Image ID="imgCardChoice1" runat="server" />
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartDesign" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                    <div class="labelLeftBold">
                        Name on Card: 
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartName" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                    <div class="labelLeftBold">
                        Message on Card: 
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartMessage" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                </div>
            </div>
        </asp:Panel>
        <br />
        <div class="container1">
            <asp:Panel ID="Panel2" runat="server" GroupingText="Card Choice 2" ForeColor="DarkBlue" Font-Bold="True" BorderStyle="NotSet" BorderColor="#E0E0E0">
                <div class="pair">
                    <br />
                    <div class="labelLeftBold">
                        Amount: 
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartAmount1" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                    <div class="labelLeftBold">
                        Card Design: 
                    </div>
                    <div class="imgCard">
                        <asp:Image ID="imgCardChoice2" runat="server" />
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartDesign1" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                    <div class="labelLeftBold">
                        Name on Card: 
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartName1" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                    <div class="labelLeftBold">
                        Message on Card: 
                    </div>
                    <div class="fieldRight">
                        <asp:Label ID="lblCartMessage1" runat="server" Font-Bold="true"></asp:Label>
                    </div>
                    <br />
                    <br />
                </div>
           // </asp:Panel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:35:01.257

如果只有 5 个值，那么你可以这样做。

```
string[] values = new string[5];

values[0] = lblFName.Text;
values[1] = lblFName2.Text; // etc 
```

然后设置文本框值使用这个

```
lblFName.Text = values[0];
lblFName2.Text = values[1]; 
```

values[i] 是否等于 null 并不重要，因为 string 可以是 null 值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:35:30.733

为什么不使用`List`?

```
private void button1_Click(object sender, EventArgs e)
{
   Control[] aryCtrl = new Control[] { textBox1, textBox2, textBox3, dropdownlist1, dropdownlist2, dropdownlist3 };
   List<string> list = new List<string>();

   foreach (Control ctrl in aryCtrl)
   {
      list.Add(textbox1.Text);
      list.Add(textbox2.Text);
      list.Add(textbox3.Text);
      list.Add(dropdownlist1.Text);
      list.Add(dropdownlist2.Text);
      list.Add(dropdownlist3.Text);
   }
} 
```

我创建一个`Control[]`数组：

```
Control[] aryCtrl = new Control[] { textBox1, textBox2, textBox3, comboBox1, comboBox2, comboBox3 }; 
```

我在我的`foreach`循环中使用它。接下来，正如我在原始答案中提到的，我创建了一个`List`对象来存储来自文本框/下拉列表的数据。最后，使用循环，我在数组`foreach`中旋转并添加每个控件的值。`Control[]``.text`

已编辑。这应该对你有用，OP！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T17:49:19.800

好的。我想我明白你在这里想要做什么。

创建一个简单的类来存储数据。

```
 Class Recipient
 {
      string Name { get; set; }
      string CreditCardName { get; set; }
      string Amount { get; set; }
      string Message { get; set; }
 } 
```

显然，您可以将数据类型更改为您想要的任何类型（即 Amount 可以是双精度）。

现在您拥有了您的控制数组（从技术上讲，您甚至不需要）和在`button1_Click`事件之外声明的收件人列表。

```
Control[] aryCtrl = new Control[] { 
                                   txtName, 
                                   cbxCreditCardName, 
                                   txtAmount, 
                                   txtMessage };

var recipients = new List<Recipient>();

private void button1_Click(object sender, EventArgs e)
{
    if (recipients.Count < 5)
    {
       var recipient = new Recipient();

       recipient.Name = txtName.Text;
       recipient.CreditCardName = cbxCreditCardName.SelectedValue;
       recipient.CreditCardNumber = txtCreditCardNumber.Text;
       recipient.Amount= txtAmount.Text;
       recipient.Message= txtMessage.Text;

       recipients.Add(recipient);
    }
    else {
         //Provide user with message telling them that they can only have up to 5 recipients.
    }
} 
```

有办法从列表中删除收件人也是一个好主意。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T20:05:36.033

感谢所有帮助过的人。我使用 ViewState 和其他一些修改解决了这个问题。

```
public partial class Test : System.Web.UI.Page
{
    [Serializable]
    class Recipient
    {
        public string name { get; set; }
    }

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void btnEnter_Click(object sender, EventArgs e)
    {
        Recipient recipients = new Recipient();

        List<string> recipient = (List<string>)ViewState["recipientList"];

        if (recipient == null)
        {
            recipient = new List<string>();
        }
        recipients.name = txtFName.Text.Trim();
        recipient.Add(recipients.name);
        ViewState["recipientList"] = recipient;

        if (recipient.Count == 1)
        {
            lblFName.Text = recipient[0];
        }

        if (recipient.Count == 2)
        {
            lblFName1.Text = recipient[1];
        }

    } 
```

# asp.net-mvc-3 - MVC 控制器操作在抛出异常时给出 302

> ID：15297463
> 
> 赞同：0
> 
> 时间：2013-03-08T15:27:40.160
> 
> 标签：asp.net-mvc-3

我有一个 ASP.NET MVC 3 应用程序。这个应用程序有一些返回 JSON 的控制器操作。如果出现错误，我想把它扔回给用户。我的一项操作的一般结构如下所示：

```
[AcceptVerbs(HttpVerbs.Get)]
public ActionResult DoSomething()
{
  try
  {
    // Do something here
    return Json(new { statusCode = StatusCodes.SUCCESS }, JsonRequestBehavior.AllowGet);
  }
  catch (Exception ex)
  {
     // Log it
     LogException(ex);

     // Toss it
     throw ex;
  }
} 
```

我的问题是，当遇到异常时，我在 Fiddler 中注意到生成了 302。我相信这是我在 web.config 中使用自定义错误作为设置的结果，如下所示：

```
<system.web>
  ...
  <customErrors mode="On" defaultRedirect="/error" />
  ...
</system.web> 
```

我相信这是因为我在 Fiddler 中看到的位置价值。我正在使用自定义错误来执行实际返回视图的操作。无论如何，有没有办法让我绕过我要返回的操作中的自定义错误设置`JsonResult`？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T04:50:51.337

这是可能的，但您必须调整 Global.asax 文件以重定向错误，如下所示：[asp.net MVC3 上的自定义错误页面](https://stackoverflow.com/questions/5226791/custom-error-pages-on-asp-net-mvc3)

然后你可以根据它是什么控制器或动作或请求类型来做不同的事情。

# matlab - 你能在 unix 命令行上运行一个 simulink 模型吗？

> ID：15297464
> 
> 赞同：1
> 
> 时间：2013-03-08T15:27:41.567
> 
> 标签：matlab, simulink

我开发了一个头部跟踪 simulink 模型，想知道是否有可能在没有任何窗口管理器的基于 unix 的操作系统上以某种方式运行它？只需从命令行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T01:00:03.870

您可以在没有桌面的情况下从 unix 提示符启动 matlab

% matlab -nodesktop

然后你可以通过加载它来模拟模型，

```
>> load_systm('myModel');
>> sim('myModel'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T19:03:15.367

你可以使用 matlab -r "[matlab statements]" 来运行你的代码吗？

# php - 如何在 MODx Revo 的主页上添加帖子缩略图？

> ID：15297466
> 
> 赞同：0
> 
> 时间：2013-03-08T15:27:43.387
> 
> 标签：php, thumbnails, modx, modx-revolution

我是 MODx 的新手。添加帖子缩略图会为每个帖子或页面创建视觉关联。如何在主页上添加帖子缩略图？如何在主页上将帖子中的第一张图片显示为缩略图？

作为 WordPress：

![在此处输入图像描述](../Images/086bb2c9cf0c9d24ce8bd3d610064fa5.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:46:34.713

如果您尝试将 modx 用作博客平台，您应该查看安装 Articles、Archivist 和 phpthumbof - 这些软件包将提供完成此操作所需的所有工具和片段。[如果不是 Vasis 的解决方案会容易得多]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T16:01:05.807

这里有两个解决方案

1.  创建图像电视，每次创建资源时手动设置图像。

2.  创建一个输入过滤器并将其应用于内容字段 -

片段`get_first_image`：

```
<?php
preg_match('/<img[^<>]+src=[\'"](?P<src>.+)[\'"][^<>]*>/i', $input, $image);
return $image['src']; 
```

并在主页模板中获取图像：

```
<img src="[[+content:get_first_image]]"> 
```

# bash - 如何在目录bash .sh中获取文件

> ID：15297467
> 
> 赞同：0
> 
> 时间：2013-03-08T15:27:44.403
> 
> 标签：bash, wget

我需要通过 wget 命令复制文件。

这是我的 bash 脚本，我需要将文件放到这个目录中：

/home/用户/公共/文件夹/

```
#!/bin/bash
dir=$(/home/user/public/folder/ --file-selection --directory)
wget -O $dir/file.txt "https://www.website.com/file.txt" 
```

但我无法获取该目录中的文件，有什么问题？

任何帮助表示赞赏。

现在正在获取数据，但正在逐行添加一个空行。

```
Data1   Data1   Data1   Data1

Data2   Data2   Data2   Data2

Data3   Data3   Data3   Data3 
```

原文是：

```
Data1   Data1   Data1   Data1
Data2   Data2   Data2   Data2
Data3   Data3   Data3   Data3 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:40:11.593

可能是因为：`dir=$(/home/user/public/folder/ --file-selection --directory)`失败了。

你为什么不直接使用：

```
#!/bin/bash
dir=/home/user/public/folder
wget -O $dir/file.txt "https://www.website.com/file.txt" 
```

# silverlight - HubTile 通知字体大小

> ID：15297475
> 
> 赞同：0
> 
> 时间：2013-03-08T15:28:02.077
> 
> 标签：silverlight, xaml, windows-phone, silverlight-toolkit

您知道如何更改字体大小，或者使通知文本块调整大小以适应文本内容吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T08:46:14.170

查看默认的 HubTile 控制模板，通知文本配置如下：

```
...
<TextBlock x:Name="NotificationBlock" Grid.Row="0"
    Margin="8,8,0,6"
    Text="{TemplateBinding Notification}"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeLarge}"
    Foreground="{TemplateBinding Foreground}"
    TextWrapping="NoWrap"
    LineStackingStrategy="BlockLineHeight"
    LineHeight="32"/>
... 
```

如果要更改字体大小，则需要复制控制模板并更改相关属性。

实现这一目标的最简单方法是使用 Expression Blend 编辑控制模板。

# javascript - Jquery手风琴更改事件不会触发

> ID：15297481
> 
> 赞同：2
> 
> 时间：2013-03-08T15:28:18.130
> 
> 标签：javascript, jquery, events, accordion

这不起作用：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link rel="stylesheet" type="text/css" href="css/smoothness/jquery-ui-1.10.1.custom.css" />
    <script type="text/javascript" src="js/jquery-1.9.1.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.10.1.custom.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            $("#accordion").accordion({
                change: function (event, ui) { alert('test'); }
            });

        });
    </script>

</head>
<body>

    <div id="accordion">
        <h2><a href="#">Header1</a></h2>
        <div>
            <p>content 1</p>
        </div>
        <h2><a href="#">Header2</a></h2>
        <div>
            <p>content 2</p>
        </div>
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-08T15:33:10.577

`change`在最新版本的 jQuery UI 中，手风琴小部件不公开事件。

您可以改为绑定到[激活](http://api.jqueryui.com/accordion/#event-activate)事件：

```
$("#accordion").accordion({
    activate: function(event, ui) {
        alert(ui.newHeader.text());  // For instance.
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:30:42.773

您是否确保并包含对 [jQuery](http://jqueryui.com/)库的正确引用？

试试这个

```
<script type='text/javascript' src='http://ajax.googleapis.com/ajax/libs/jqueryui/1.9.1/jquery-ui.js'></script> 
```

# twitter-bootstrap - 推文分享按钮不会在登录/注销时呈现

> ID：15297482
> 
> 赞同：3
> 
> 时间：2013-03-08T15:28:24.190
> 
> 标签：twitter-bootstrap, twitter, meteor

我在一个应用程序上使用 Meteor 的`accounts-ui`包，`accounts-twitter`该应用程序由带有数据库内容的缩略图组成。每个缩略图还有一个推文分享按钮。我面临一个特殊的问题，即当用户登录或退出应用程序时，推文按钮不会呈现。

在页面加载时，tweet 按钮呈现良好，但是当用户单击登录或注销时，元素消失或样式消失并只留下文本。

登录或注销时没有事件处理代码。我在[这里](https://gist.github.com/kvprashant/5117204)添加了要点。

是否与页面不刷新有关？以前是否注意到过这种行为？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T19:06:31.870

twitter 加载的 js 代码将推文按钮转换为 iframe。我通过在检查器中查看生成的 iframe 然后更改我的代码来解决这个问题，因此我在检查器中找到了一个带有 URL 的 iframe 标记，而不是具有数据属性的锚标记。它也有一个模式，所以你应该能够制作一个模板来呈现具有不同 url 的不同按钮。

我认为按照你现在的方式（我一开始也是这样做的）这样做的问题是，将推文按钮转换为 iframe 的 twitter 代码只运行一次，即使你多次加载脚本. 因此，如果您在 twitter 代码已经运行后创建一个 tweet 标签，它不会被转换为 iframe，也不会工作或看起来像一个 tweet 按钮。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T07:26:52.453

尝试更换使用`rendered`

```
Template.twitter.rendered = function() {
  return !function(d,s,id) {
           var js,fjs = d.getElementsByTagName(s)[0];
           if(!d.getElementById(id)){
             js=d.createElement(s);
             js.id=id;
             js.src="http://platform.twitter.com/widgets.js";
             fjs.parentNode.insertBefore(js,fjs);
           }
   }(document,"script","twitter-wjs");
} 
```

不要担心多次重新渲染添加 twitter 的 api 脚本，那里有一个检查以允许它运行多次并且只有在它的 js 被删除时才起作用。

我怀疑重新渲染（在注销/更改反应变量时）正在破坏由 js 为该共享按钮的 twitter api 创建的 css 链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T09:41:28.763

根据@zorlak 的回答，这就是我所做的：

**HTML**：

```
<template name="listings">
  {{twitter "@MeteorAtSO"}}
</template>

<template name="twitter">
  <iframe allowtransparency="true" frameborder="0" scrolling="no" 
     src="http://platform.twitter.com/widgets/tweet_button.1362636220.html#_=1363023601135&amp;
       count=none&amp;id=twitter-widget-0&amp;
       lang=en&amp;original_referer=http://localhost:3000&amp;
       text=Check out {{this}}!&amp;
       url=http://localhost:3000"&amp;size=m 
     class="twitter-share-button twitter-count-none" 
     style="width: 58px; height: 20px;" 
     title="Twitter Tweet Button" 
     data-twttr-rendered="true">
  </iframe>
</template> 
```

**Javascript**：

```
Template.twitter.rendered = function() {
  return !function(d,s,id) {
           var js,fjs = d.getElementsByTagName(s)[0];
           if(!d.getElementById(id)){
             js=d.createElement(s);
             js.id=id;
             js.src="//platform.twitter.com/widgets.js";
             fjs.parentNode.insertBefore(js,fjs);
           }
   }(document,"script","twitter-wjs");
} 
```

结果非常好！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-31T00:53:29.200

只是为了建立这里的解决方案，您可以使用以下内容进一步自定义您的可共享按钮

```
Template.listings.twitterDetails = function() {
    return {
        text: "What do you want to say?"
        , url: "what link do you want to share?"
        , referer: "yoursite.com"
        , id: Random.id()
    };
}; 
```

和

```
{{#with twitterDetails}}
    {{>twitter}}
{{/with}} 
```

和

```
<template name="twitter">
  <iframe allowtransparency="true" frameborder="0" scrolling="no" 
    src="http://platform.twitter.com/widgets/tweet_button.{{id}}.html#_={{id}}&count=none&id=twitter-widget-0&lang=en&original_referer={{referer}}&text={{text}}&url={{url}}&size=l"
     class="twitter-share-button twitter-count-none" 
     style="width: 77px; height: 28px;" 
     title="Twitter Tweet Button" 
     data-twttr-rendered="true">
  </iframe>
</template> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-04T09:13:25.763

我已经设法在没有“iframe”的情况下显示 twitter 按钮，方法如下：[../twitter-buttons-in-meteor.html](http://ondrej-kvasnovsky.blogspot.cz/2013/06/twitter-buttons-in-meteor.html)

# django - 通过 django 的管理面板分配子用户

> ID：15297497
> 
> 赞同：1
> 
> 时间：2013-03-08T15:29:11.357
> 
> 标签：django

我在 django.db 导入模型的 models.py 中有以下内容

```
class LabName(models.Model):
labsname=models.CharField(max_length=30)
def __unicode__(self):
 return self.labsname

class ComponentDescription(models.Model):
   lab_Title=models.ForeignKey('Labname')
    component_Name = models.CharField(max_length=30)
   description = models.CharField(max_length=20)
   purchased_Date = models.DateField()
   status = models.CharField(max_length=30)
   to_Do = models.CharField(max_length=30,blank=True) 
   remarks = models.CharField(max_length=30)

   def __unicode__(self):
   return self.component 
```

我的 admin.py 中有以下内容

```
from django.contrib import admin
from Lab_inventory.models import ComponentDescription,LabName
class ComponentDescriptionAdmin(admin.ModelAdmin):
list_display=('lab_Title','component_Name','description','qty','purchased_Date','status','to_Do','remarks')
   list_filter=('lab_Title','status','purchased_Date')
admin.site.register(LabName)
admin.site.register(ComponentDescription,ComponentDescriptionAdmin) 
```

如何为每个实验室名称分配不同的子用户？？？？

# javascript - JSFiddle 使用什么来调整 4 个代码内容区域的大小？

> ID：15297498
> 
> 赞同：4
> 
> 时间：2013-03-08T15:29:14.803
> 
> 标签：javascript, jsfiddle

这个问题是关于 jsFiddle 本身的；特别是区域如何调整大小。

jsFiddle 使用 4 个可独立调整大小的区域，它们之间有一个边框，边框中有这个图形：

![边框大小调整手柄](../Images/e2f0545cf7acdf220ac13f704bb9d798.png)

如果需要，这些调整大小的句柄会导致 iframe 滚动；它的光滑。我搜索[了 jQueryUI Resizable](http://jqueryui.com/resizable/)认为就是这样。没有...

我真的只知道jQueryUI。这是他们用来实现这一目标的不同图书馆吗？您能否识别和/或将我链接到他们用来调整大小的内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:51:39.040

JSFiddle 使用[CodeMirror](http://codemirror.net/)以及一个名为[LayoutCM.js](http://code.google.com/p/raphael4gwt/source/browse/trunk/raphael4gwt/doc/raphaeltut/images/Edit+this+Fiddle+-+jsFiddle_files/LayoutCM.js?r=74)的布局插件。您可以分解代码以弄清楚它是如何处理的，但实际上拖动事件正在更新面板的宽度和高度（百分比）。jQuery 解决方案可能是使用[jQuery Splitter Plugin](http://methvin.com/splitter/)。

# javascript - 对象中数组的长度不匹配

> ID：15297501
> 
> 赞同：5
> 
> 时间：2013-03-08T15:29:17.797
> 
> 标签：javascript, jquery, json, d3.js

我正在尝试使用 D3 中的树层次结构并卡住了。我以为我正在正确构建 JSON，但是当我查看开发人员工具中的对象时，我看到以下内容：

[![铬合金](../Images/145bed0503b2747464fb00c0fa762760.png)](https://i.stack.imgur.com/bkvUH.png)

请注意，第一行显示依赖数组的长度为 0，但展开后，您可以清楚地看到依赖数组有 3 个对象。当我对它进行字符串化时，我得到以下信息：

```
{"attributes":{"id":0,"name":"root"},"dependents":[]} 
```

知道有什么问题吗？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T15:30:54.007

当您在记录后更改对象时通常会发生此问题，因为 Chrome 在您记录该对象时不会深度复制该对象，而只是存储一个引用。

树不是立即构建的，而是仅在需要时构建，有时它基于更新的值。

如果您的对象足够轻，如果您真的想在记录时查看值，则可以自己克隆它：

```
console.log(JSON.parse(JSON.stringify(myobject))); 
```

如果您的对象很大或递归，您可能会发现克隆它有点困难。我个人有自己的工具[JSON.prune.log](http://dystroy.org/JSON.prune/)。

由于忽略浏览器的优化是有代价的，如果你想确定它们的日志记录时间值，你通常应该简单地考虑这种行为并只记录原语......

# python - 如何从几个 python 文件构建单个二进制文件

> ID：15297503
> 
> 赞同：0
> 
> 时间：2013-03-08T15:29:28.473
> 
> 标签：python, pyinstaller

我在一个文件夹中有几个简单的脚本。像这样的东西：

```
prject_root/moduleA.py
prject_root/moduleB.py
prject_root/moduleC.py
prject_root/moduleD.py
prject_root/config.py
prject_root/run.py 
```

所以`run.py`将它们全部导入，而每个模块都导入配置文件（并且可以自己运行）。我想创建一个模拟调用的可执行文件，`python run.py`并将保存由`run.py`. 我将如何使用`pyinstaller`或类似系统执行此操作，二进制文件将在`Linux`（Debian）下执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T16:41:40.050

如果您想拥有一个即使用户没有 python 也可以运行的二进制文件，并且您不介意二进制文件相对较大，您可以使用该`freeze.py`程序。`freeze.py`应该随你的 python 安装一起提供，所以在你的系统上找到它，然后运行：

```
python /your/path/to/freeze.py /your/path/to/project_root/run.py 
```

这会将您的所有代码以及运行代码所需的 python 部分打包成可执行文件，`run`然后您可以使用和分发。

[可以在此处找到](http://wiki.python.org/moin/Freeze)有关冻结的更详细说明。

# java - 在java中逐像素绘制图像

> ID：15297504
> 
> 赞同：1
> 
> 时间：2013-03-08T15:29:33.180
> 
> 标签：java, image

我还没有进入图像处理。我想在 JAVA 中读取 .jpeg 图像文件并根据颜色值在画布上绘制像素。即首先绘制所有黑色像素，然后绘制所有灰色像素，依此类推......最后是白色像素。

我还想在绘制的每个像素之间引入一个非常小的间隙，以便我可以看到图像是如何绘制的。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:40:47.770

这是一个简短的、精简的说明示例，可以帮助您入门。此代码分解图像中的 RGB 值。然后，您可以对数据做任何您需要做的事情。

```
public static BufferedImage exampleForSO(BufferedImage image) {
    BufferedImage imageIn = image;
    BufferedImage imageOut = 
    new BufferedImage(imageIn.getWidth(), imageIn.getHeight(), BufferedImage.TYPE_4BYTE_ABGR);
    int width = imageIn.getWidth();
    int height = imageIn.getHeight();
    int[] imageInPixels = imageIn.getRGB(0, 0, width, height, null, 0, width);
    int[] imageOutPixels = new int[imageInPixels.length];
    for (int i = 0; i < imageInPixels.length; i++) {
        int alpha = (imageInPixels[i] & 0xFF000000) >> 24;
        int red = (imageInPixels[i] & 0x00FF0000) >> 16;
        int green = (imageInPixels[i] & 0x0000FF00) >> 8;
        int blue = (imageInPixels[i] & 0x000000FF) >> 0;

        // Make any change to the colors.
        if (  conditionCheckerForRedGreenAndBlue  ){
            // bla bla bla
        } else {
            // yada yada yada
        }

        // At last, store in output array:
        imageOutPixels[i] = (alpha & 0xFF) << 24
                        | (red & 0xFF) << 16
                        | (green & 0xFF) << 8
                        | (blue & 0xFF);

    }
    imageOut.setRGB(0, 0, width, height, imageOutPixels, 0, width);
    return imageOut;
} 
```

# excel - 单元格中的数据过多，无法在用户表单列表框中显示

> ID：15297508
> 
> 赞同：0
> 
> 时间：2013-03-08T15:29:44.307
> 
> 标签：excel, vba, userform

我在 Excel 2007 的用户窗体中有一个列表框。

我的工作表中的某些单元格包含超过 10 行（带有 ALT ENTER 的数据）。

我正在尝试清理和显示数据。我不想将列宽更改为 1000，但我想使用鼠标悬停框来显示所有单元格数据。

还有其他可行的想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:01:39.970

用鼠标悬停是可能的，但我认为这很复杂。这里我有另一个更简单的想法：在列表框中双击时，将显示一个带有选定列表项数据的多行文本框。此文本框与列表框具有相同的位置和大小。在用户表单上单击文本框隐藏。这是一些示例代码，要对其进行测试，您需要带有名为“ListBox1”的列表框的表单：

```
Option Explicit

Public ListItemInfo As Control

Private Sub UserForm_Initialize()
    Set ListItemInfo = Me.Controls.Add("Forms.TextBox.1", "ListItemInfo", False)
    With Me.ListItemInfo
        .Top = Me.ListBox1.Top
        .Left = Me.ListBox1.Left
        .Width = Me.ListBox1.Width
        .Height = Me.ListBox1.Height
        .MultiLine = True
    End With
End Sub

Private Sub ListBox1_Change()
    Me.ListItemInfo.text = GetSelectedItemsText
End Sub

Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    SwitchListItemInfo
End Sub

Private Sub UserForm_Click()
    SwitchListItemInfo
End Sub

Private Function GetSelectedItemsText() As String
    Dim text As String
    Dim i As Integer
    For i = 0 To Me.ListBox1.ListCount - 1
        If Me.ListBox1.Selected(i) Then
            text = text & Me.ListBox1.List(i) & vbNewLine
        End If
    Next i
    GetSelectedItemsText = text
End Function

Private Sub SwitchListItemInfo()
    If Me.ListItemInfo.text = "" Then Exit Sub
    Me.ListItemInfo.Visible = Not Me.ListItemInfo.Visible
    Me.ListBox1.Visible = Not Me.ListBox1.Visible
End Sub 
```

![在此处输入图像描述](../Images/d9883eaebb3cf250239e5d0d5fe611b7.png)

# groovy - 有没有一种函数式编程方法来检索集合的第一个元素？

> ID：15297513
> 
> 赞同：1
> 
> 时间：2013-03-08T15:29:55.163
> 
> 标签：groovy

该列表可以为空。我想要做 ：

```
def value = "";
def list = getList()
if (!list.isEmpty()){
   value = list.first().foo 
} 
```

例如我发现了这种方式：

```
assert ( [].find()?.foo?:"empty" ) == "empty"
assert ([[foo:"notEmpty1"], [foo:"notEmpty2"]].find()?.foo?:"empty") == "notEmpty1" 
```

有没有更好的办法 ？

谢谢！:)

编辑：

我通过使用得到了很好的答案`[0]`

```
assert ( [][0]?.foo?:"empty" ) == "empty"
assert ([[foo:"notEmpty1"], [foo:"notEmpty2"]][0]?.foo?:"empty") == "notEmpty1" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T07:48:12.183

我从推特上得到了答案。声明：

```
def value = "";
def list = getList()
if (!list.isEmpty()){
   value = list.first().foo 
} 
```

可以写：

```
def value = list[0]?.foo?:"" 
```

`find`如果列表可以包含空值，则可以使用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:45:56.427

如果`List`只是尝试

```
if (!list?.isEmpty()){
    list.get(0);
} 
```

如果列表元素不能为空，则不需要`?`

如果它是一个集合，则有几种形​​式可以检索它。看看这个帖子

[Java：从集合中获取第一个项目](https://stackoverflow.com/questions/1671378/java-get-first-item-from-a-collection)

# facebook - Facebook 应用中心 - 需要列出的应用 ID

> ID：15297517
> 
> 赞同：1
> 
> 时间：2013-03-08T15:30:10.563
> 
> 标签：facebook, facebook-graph-api, facebook-opengraph

我可以使用 app id 和 Graph API 获取应用程序的详细信息。

例如[https://graph.facebook.com/](https://graph.facebook.com/) **2439131959** /insights/application_active_users?since=1329724800&until=1329984000

但是，有没有办法获取应用程序列表及其 ID，以便我可以使用上面的查询和访问令牌来获取应用程序信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-11T07:49:45.107

Facebook 用户对象具有称为“帐户”的连接对象。使用它可以获得当前用户拥有的 facebook 应用和页面。为了通过图形 api 获取这些详细信息，您需要“manage_pages”权限。这将返回包含帐户名称、access_token、类别和 ID 的对象数组。

```
 https://graph.facebook.com/me/accounts 
```

[结帐 fb 文档](https://developers.facebook.com/docs/reference/api/user/)

# html - 如何为div制作动态高度

> ID：15297519
> 
> 赞同：0
> 
> 时间：2013-03-08T15:30:16.593
> 
> 标签：html, css

是否有可能具有取决于其他 div 大小的 div 高度？

这是示例

```
<div id="wrapper" style="height:400px;background-color:green;">

   <div id="content1" style="height:auto;min-height:50%;background-color: limegreen;">
       Content 1
   </div>

   <div id="content2" style="min-height:20%;background-color:lightblue;">
        Content  2
</div>

<div id="content3" style="min-height:20%;background-color:blue;">
      Content 3 
</div>

</div> 
```

你也可以在这里看到它：http: [//jsfiddle.net/kXfsY/28/](http://jsfiddle.net/kXfsY/28/)

您可以看到，div 包装器没有与其他 div 重叠。我想让 div content1 的高度至少为 div 包装器的 50% 或更高，因此整个 div 包装器将重叠。div 内容 2 和 3 的大小将是动态的，取决于里面有多少项目。或者 div content 2 或 div content 3 可能是空的，那么如果 div content1 会增加并且将使用 div 包装器的完整高度会很好。

那可能吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:57:29.503

您可以使用`display: table`和来做到这一点`display: table-row`。您可以删除`#content2`/`#content3`元素或将它们设为空标签。`#content1 元素无论如何都会占用所有剩余空间。

[http://codepen.io/cimmanon/pen/pHAcJ](http://codepen.io/cimmanon/pen/pHAcJ)

```
#wrapper {
  height:400px;
  background-color:green;
  display: table;
  width: 100%;
  table-layout: fixed;
}

#content1 {
  min-height:50%;
  background-color: limegreen;
  display: table-row;
}

#content2, #content3 {
  height:20%;
  display: table-row;
}

#content2:empty, #content3:empty {
  display: none;
}

#content2 {
  background-color:lightblue;
}

#content3 {
  background-color:blue;
} 
```

# django - 骨干网实现

> ID：15297524
> 
> 赞同：-4
> 
> 时间：2013-03-08T15:30:29.330
> 
> 标签：django, backbone.js

我使用 Python 和 HTML 制作了一个 Django 应用程序。并且使用 Hijax 方案，我已经编写了服务器端逻辑，但现在我希望使用 Javascript 的 Backbone 框架来维护客户端代码。我尝试搜索几个使用 Backbone 设计它的教程，但我不清楚如何处理它。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:35:02.470

我建议您查看GitHub 上提供的[这个项目。](https://github.com/mpuig/hijax)另请阅读Dugan Chen 的[这篇文章](http://duganchen.ca/single-page-web-app-architecture-done-right/)。两者都使用**Backbone.js、Django 和 Hijax 方案**。

# java - java中的字符串args []是否实现为可变参数？

> ID：15297526
> 
> 赞同：0
> 
> 时间：2013-03-08T15:30:32.197
> 
> 标签：java, main, variadic-functions, args

是如何实现`public static void main(String args[])`的`String args[]`？它被实施为`varargs`？

我问这个是因为`args.length`只给出了传递的参数数量，这意味着它没有在任何地方定义`String args[] = new String[30]`。这个数组是如何实现的？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-08T15:32:37.640

它完全按照它的外观实现 - 作为一个字符串数组。另一方面，可变参数是作为数组实现的——`String...`只是`String[]`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T16:31:24.747

它已声明（未实现）但是*您*说它已声明。使用 varargs 声明函数是完全合法的：

```
public static void main(String... argv) 
```

编译器采用可变参数声明并将其转换为`String[]`字节码。这发生在*所有*使用可变参数的函数上。

当 JVM 开始运行您的程序时，它会创建一个与命令行参数数量完全相同的数组（不包括`-D`为 JVM 本身准备的任何参数）。然后它在指定的类中搜索一个主函数并调用它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T15:31:57.397

它只是一个字符串数组，它使用启动时传递给进程的参数值进行初始化。它不是一个可变参数列表。

# macos - 即使我添加了请求更改共享首选项的权利，可可沙盒也不总是有效

> ID：15297528
> 
> 赞同：1
> 
> 时间：2013-03-08T15:30:40.510
> 
> 标签：macos, cocoa, sandbox

我开发了一个沙盒应用程序。它的功能之一是对 /Users/username/Library/Preferences com.apple.finder.plist 进行一些更改。因此，为了做到这一点，我在 entitlement.plist 中添加了以下内容：

```
<key>com.apple.security.temporary-exception.shared-preference.read-write</key>
<array>
    <string>com.apple.finder</string>
</array>
<key>com.apple.security.temporary-exception.apple-events</key>
<array>
    <string>com.apple.finder</string>
    <string>com.apple.systemevents</string>
</array> 
```

如果我关闭沙盒，我的应用程序可以正常工作，但是，如果我启用沙盒，有时我的应用程序可以运行，但大多数时候我的应用程序无法运行。

我所做的是，1\. 我使用 NSAppleScript 对 finder.plist 进行更改，然后 2\. 告诉“finder”退出并重新启动。“退出”和重新启动部分工作得很好：

```
tell application "Finder" to quit
set inTime to current date
    repeat
tell application "System Events"
    if "Finder" is not in (get name of processes) then exit repeat
end tell
if (current date) - inTime is greater than 10 then exit repeat
    delay 0.2
end repeat

tell application "Finder" to activate 
```

（来自[如何重新启动 finder 应用程序](https://stackoverflow.com/questions/10225215/how-to-relaunch-finder-application)）

然而，不断变化的 finder.plist 似乎并不总是有效。（没有错误）但是如果我关闭沙盒，它就可以了。

所以我的结论是，沙盒会破坏我的代码，但我真的不知道如何解决这个问题，因为我已经添加了权利？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-09T09:31:39.170

可能您希望启用沙盒以使 App Store 符合条件的应用程序。我认为您将很难（不可能）让您的应用程序获得临时豁免批准，尤其是系统事件和查找器。

如果您获得了这些临时豁免，您几乎可以做任何不需要 root 访问权限的事情，例如删除文件等。这违背了沙盒的目的。

绝对不允许从您的应用程序重新启动 Finder。我建议你找到另一种方法来做你需要做的事情。

# python - 确定 ndarray 子类上的 __array_wrap__ 是从一元 ufunc 还是二进制 ufunc 调用

> ID：15297534
> 
> 赞同：6
> 
> 时间：2013-03-08T15:30:58.890
> 
> 标签：python, numpy

有没有办法判断 ndarray 子类[`__array_wrap__`](http://docs.scipy.org/doc/numpy/user/basics.subclassing.html#array-wrap-for-ufuncs)是用一元函数还是二元函数调用的？（另一个[参考](http://docs.scipy.org/doc/numpy/reference/arrays.classes.html#numpy.__array_wrap__)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:53:30.407

这只是部分答案：

ufunc 的参数作为元组传递给`context`. 表格是：

```
(ufunc, ufunc_args, ufunc_domain) 
```

您可以检查 的长度`ufunc_args`以查看是否有 1 个或 2 个参数。作为旁注，我*不知道*是什么`ufunc_domain`（在我的测试中，它似乎总是`0`）...

```
import numpy as np
class Tester(np.ndarray):
    def __array_wrap__(self,output,context=None):
        print context[0].__name__,'is binary' if len(context[1]) > 1 else 'is unary'
        return np.ndarray.__array_wrap__(self,output,context)

a = np.zeros(10)
b = a.view(Tester)
print (type(b))

-b
np.sqrt(b)
b+b 
```

我想这就是你如何`__array_wrap__`判断它是二进制还是一元ufunc。不幸的是，当我一开始问这个问题时，我希望知道这个 ufunc 调用是否是一*元运算符*的结果。我没有想到像函数这样的`np.abs`东西。`np.sqrt``unary`

# c# - 使用 IQueryable.Count 带有 IEnumerable 范围

> ID：15297544
> 
> 赞同：15
> 
> 时间：2013-03-08T15:31:24.917
> 
> 标签：c#, linq, ienumerable, iqueryable

想象一个类，假设分页可以与 an`IList<T>`或 an一起使用`IQueryable<T>`。

该类将具有一个`int TotalItems`属性，它将（并不奇怪）获取/设置可查询或可枚举参数的计数。

如果我`IEnumerable<T>`用作参数，

```
//simplified
public Pagination(IEnumerable<T> query)
    {
        TotalItems = query.Count();
    } 
```

该`Count()`方法将是（**如果我没记错的话，这就是重点**）`Enumerable.Count()`。因此，即使查询是一个`IQueryable<T>`（继承自`IEnumerable<T>`），它也会被枚举（这显然不是“数据库查询”所希望的）。

那么当我实际上是一个时，有没有办法使用`Queryable.Count()`方法，或者我是否必须改变我的设计，例如在这种情况下，有 2 ctor`IEnumerable<T>``IQueryable<T>`

```
//simplified
public Pagination(IEnumerable<T> query)
    {
         TotalItems = query.Count();
    }
public Pagination(IQueryable<T> query)
    {
         TotalItems = query.Count();
    } 
```

**编辑** 我确实理解`IQueryable<T>`继承与具有相同名称的扩展方法`IEnumerable<T>`这一事实无关，`IEnumerable<T>`并且`IQueryable<T>`扩展方法具有相同的名称是很好的，“看起来它们做的一样”，但我认为它仍然有时会混淆...

**好奇心的一般问题**

它们是否是框架中具有相同“架构”的其他示例：继承+扩展方法的通用名称？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T16:33:39.893

正如问题中所示，您应该有两个构造函数重载。这由调用者决定是否要使用`IQueryable`方法或要使用的`IEnumerable`方法。

如果有人这样做：

```
Pagination pager = new Pagination(query.AsEnumerable()); 
```

然后他们显然希望将对象处理为`IEnumearble`，而不是`IQueryable`。也许他们知道这一点`Skip`并且`Take`没有由他们的查询提供程序实现，因此分页将失败，并且需要将其评估为 Linq-to-objects。

通过使用这两个重载，您可以让您的类的用户做出明智的决定，无论他们是在处理内存中的序列还是查询，而不是试图自己弄清楚。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:37:46.943

好吧，你可以这样做：

```
TotalItems = enumerable.AsQueryable().Count(); 
```

这将直接将查询提供程序的`Count`实现用于本机可查询，或者回退到 LINQ to Objects（使用 时会产生一些开销`EnumerableQuery`），否则。

另一种解决方案（可能更有效）：

```
var queryable = enumerable as IQueryable<T>;
TotalItems = queryable != null ? queryable.Count() : enumerable.Count(); 
```

但是，请注意，如果您的可查询实现`ICollection`或`ICollection<T>`有效（如某些查询提供程序的情况），即使您现有的解决方案也可能会因为 LINQ 中的优化而工作良好（它`Count`尽可能使用这些接口中的属性）。对于您的`IList<T>`，它将始终使用此优化，因为它实现了`ICollection<T>`.

# sql - SQL / SSRS 将用户名添加到报告使用表

> ID：15297547
> 
> 赞同：1
> 
> 时间：2013-03-08T15:31:28.937
> 
> 标签：sql, reporting-services, sql-server-2008-r2, reportingservices-2005

我的情况如下：

`ReportUse`如果用户运行报表，我想在具有 3 个字段/列的表中插入一行：

`User, date, reportname`.

目前我`Insert`在报告存储过程的末尾有一个声明，即：

```
INSERT INTO ReportUse (date, reportname)
SELECT GETDATE(), 'StaffReport' 
```

这将插入日期和报告名称，我不确定如何将用户名添加到其中，这将是他们的 Windows 用户 ID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:40:42.597

如果您在数据源中使用 Windows 身份验证连接到数据库，只需将*User*列设置为默认值`SUSER_NAME()`.

[在线图书的 SUSER_NAME](http://msdn.microsoft.com/en-us/library/ms187934.aspx)。

或者，您可以将内置字段`User!UserID`作为参数传递给存储过程。这将适用于 SSRS 2005。

[内置全局和用户参考](http://msdn.microsoft.com/en-us/library/dd255216.aspx)。

**评论后编辑：**

如果用户名尚不存在，则将参数添加到*用户名的存储过程。*

将参数的值设置为`=User!UserID`。

在存储过程中，在插入语句中使用*用户名参数。*

# php - Drupal 7 以编程方式保存用户图片

> ID：15297551
> 
> 赞同：3
> 
> 时间：2013-03-08T15:31:49.863
> 
> 标签：php, drupal, drupal-7

我找到了这个脚本[http://d.danylevskyi.com/node/7](http://d.danylevskyi.com/node/7)，我用它作为下面代码的启动器。

目标是能够保存用户图片：

```
<?php
define('DRUPAL_ROOT', getcwd());

require_once DRUPAL_ROOT . '/includes/bootstrap.inc';
drupal_bootstrap(DRUPAL_BOOTSTRAP_FULL);

$uid = 99;
$account = user_load($uid);

// get image information
$image_path = 'public://avatars/upload/b8f1e69e83aa12cdd3d2babfbcd1fe27_4.gif';
$image_info = image_get_info($image_path);

// create file object
$file = new StdClass();
$file->uid = $uid;
$file->uri = $image_path;
$file->filemime = $image_info['mime_type'];
$file->status = 0; // Yes! Set status to 0 in order to save temporary file.
$file->filesize = $image_info['file_size'];

// standard Drupal validators for user pictures
$validators = array(
    'file_validate_is_image' => array(),
    'file_validate_image_resolution' => array(variable_get('user_picture_dimensions', '85x85')),
    'file_validate_size' => array(variable_get('user_picture_file_size', '30') * 1024),
);

// here all the magic :) 
$errors = file_validate($file, $validators);
if (empty($errors)) {

    file_save($file);
    $edit['picture'] = $file;
    user_save($account, $edit);
}
?> 
```

在sites/default/files/pictures/中创建一张图片，名称为picture-99-1362753611.gif

file_managed 表中的一切似乎都是正确的，除了：

1.  文件名字段为空
2.  uri 字段显示 public://avatars/upload/b8f1e69e83aa12cdd3d2babfbcd1fe27_4.gif
3.  状态字段设置为 0（临时）

users 表中的图片字段将使用上述条目的 fid 进行更新。

我猜想 file_managed 表应该存储最终文件（在站点/默认/图片中）而不是原始文件信息，并且用户表也应该链接到该文件。

知道如何实现吗？我对 Drupal API 很陌生。谢谢你。

**编辑：**

我了解我将原始文件提供给 file_save 和 user_save 函数。但是哪一个实际上在 sites/default/pictures/ 中创建了文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:49:32.813

尝试将以下内容添加到您的代码中：

```
$file->filename = drupal_basename($image_path);
$file->status   = FILE_STATUS_PERMANENT;
$file = file_save($file);  // Use this instead of your current file_save 
```

这有帮助吗？

- - - - - - - - - 编辑 - - - - - - - - -

如果要将文件的副本保存在新位置，可以将上面的第三行替换为类似

```
// Save the file to the root of the files directory.
  $file = file_copy($file, 'public://'); 
```

# wordpress - WordPress WP Query $arg 用于显示当前帖子/页面

> ID：15297552
> 
> 赞同：0
> 
> 时间：2013-03-08T15:31:53.223
> 
> 标签：wordpress

这听起来像是一个非常愚蠢的问题和/或可能有一个我忽略的非常简单的解决方案，但是是否有一个 WP Query $arg 用于显示当前帖子/页面的内容？（即，如果您在页面[http://www.example.com/?p=1](http://www.example.com/?p=1)上，wp 查询将返回 id=1 的帖子/页面的内容）。请不要问为什么或提供替代解决方案。这是一个很长的故事，我只是想知道它是否可能。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:34:49.523

WordPress 默认获取当前页面/帖子的内容。如果您在重置之前编辑了 WordPress 查询`wp_reset_query();`

重置后，您可以再次循环浏览当前页面/帖子的内容。

来源：[http ://codex.wordpress.org/Function_Reference/wp_reset_query](http://codex.wordpress.org/Function_Reference/wp_reset_query)

# spring - 从类路径加载文件

> ID：15297557
> 
> 赞同：12
> 
> 时间：2013-03-08T15:32:04.760
> 
> 标签：spring, file, classpath

我有一行代码是：`File file = new File(getFile())`在java类中`HandleData.java`

方法 -`getFile()`获取属性的值`fileName`。并`fileName`通过 `application_context.xml`类的一个 bean 部分进行注入 - HandleData 如下：

```
 <bean id="dataHandler" class="com.profile.transaction.HandleData">
 <property name="fileName" value="DataFile.xml"></property>
 </bean> 
```

我成功构建了项目并检查了 -`DataFile.xml`是否存在于`WEB-INF/classes`. HandleData.class 存在于`WEB-INF/classes/com/profile/transacon`

但是当我运行它时，它会抛出 filenotfound 异常。如果我注入绝对路径（`C:\MyProjectWorkspace\DataProject\target\ProfileService\WEB-INF\classes\DataFile.xml`它会成功找到文件。）。

有人可以帮助找出要注入的正确路径，以便从类路径中获取文件吗？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2014-11-12T18:14:39.810

虽然注入 a`File`通常是首选方法，但您也可以利用 Spring 的 ResourceLoader 来动态加载资源。

通常，这就像将 注入`ResourceLoader`Spring bean 一样简单：

```
@Autowired
private ResourceLoader resourceLoader; 
```

然后从类路径加载：

```
resourceLoader.getResource("classpath:myfile.txt"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T15:36:10.340

由于OP是通过spring只注入文件名，还是想通过代码创建文件对象，你应该使用ClassLoadeer来读取文件

尝试这个

```
InputStream is =  HandleData.class.getClassLoader().getResourceAsStream(getFile())); 
```

**编辑**

这是代码的其余部分，用于读取文件

```
BufferedInputStream bf = new BufferedInputStream(is);
DataInputStream dis = new DataInputStream(bf);

while (dis.available() != 0) {
    System.out.println(dis.readLine());
} 
```

**编辑 2**

由于您希望它作为文件对象，因此要掌握 FileInputStream

尝试这个

```
 FileInputStream fisTargetFile = new FileInputStream(new File(HandleData.class.getClassLoader().getResource(getFile()).getFile())); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-08T15:35:41.053

你应该有：

```
<property name="fileName" value="classpath:DataFile.xml" /> 
```

它应该被注入`org.springframework.core.io.Resource`类似于[这个答案](https://stackoverflow.com/a/7486582/516433)

# html - 内联文本内的浮动元素

> ID：15297560
> 
> 赞同：0
> 
> 时间：2013-03-08T15:32:13.607
> 
> 标签：html, css

我有以下代码：

```
<div>
  <div id="dynamic" style="float:left;height:50px;background-color:#aaa;">
    floated block which will be dynamically increase
  </div>
  <div id="static" style="height:50px;background-color:#FC3;">
    Hello guys
  </div>
</div> 
```

我想`static`随着`dynamic`div 宽度的变化移动 div。上面的代码可以按我的意愿工作，但我不知道上面的方式是否正确？

内联文本中的浮动 div 是否正确？是跨浏览器吗？

此代码是否会影响其他任何内容，例如其下方的内容或移动到`static`div 下方？

为什么浮动 div 不移动到内联内容下方，而是将其与内联文本对齐？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:40:03.710

你也可以使用`float:left`。`<div id="static">`在您的动态 div 宽度 + 静态 div 宽度达到窗口宽度之前，我没有看到任何问题。

这 >> [http://jsfiddle.net/gxpBL/](http://jsfiddle.net/gxpBL/) 就是我要说的。

# html - 使用嵌入式 iframe google 表单在页面加载时跳转的网站

> ID：15297561
> 
> 赞同：1
> 
> 时间：2013-03-08T15:32:15.100
> 
> 标签：html

当有人导航到带有谷歌网络表单的特定页面时，浏览器会自动跳到页面底部附近的谷歌网络表单。

[网址](http://liff2013.com/sugarman)

关于如何将其保持在页面顶部的任何想法？

谢谢！杰夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:36:40.957

这是由于表单中的字段获得焦点，如果您可以停止它不会跳下来。

我看过谷歌表单，看起来没有办法将其配置为不设置焦点，您可以尝试一些自定义 javascript 来阻止它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-15T01:53:31.623

我可以从共享的 URL 中看到，原始用户的问题现在已经解决，但是对于寻求解决方案的其他人来说，如果 Google 表单是通过 iFrame 嵌入的，或者您正在使用自定义 HTML 表单来发布对 Google 表单的答案通过`target`iFrame 的 ，并且发生这种跳转，`src=''`将 iFrame 的更改`src='about:blank'`为消除任何页面跳转的一种处理方式。

# html - 有没有办法使用 facebook 脚本将网站验证为 html4？

> ID：15297562
> 
> 赞同：0
> 
> 时间：2013-03-08T15:32:15.650
> 
> 标签：html, facebook-like, w3c-validation

我在我的网站上使用 Facebook Like 框和 Facebook Comments，但是当我在[http://validator.w3.org/](http://validator.w3.org/)使用验证器时，我收到以下错误：

> 一般实体“appId”未定义且没有默认实体
> 
> 对无法为其生成系统标识符的实体“appId”的引用

我已经看到将 DOCTYPE 声明为 HTML5，这些错误消失了，但出现了一堆其他错误，有没有办法解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:44:41.950

> 一般实体“appId”未定义且没有默认实体。对无法为其生成系统标识符的实体“appId”的引用

这通常意味着`&`当它表示“字符引用或实体的开始”时，您正在使用 as 数据。如果你`&`想说`&amp;`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:37:23.813

如果您想让您的 HTML 有效，那么我建议您使用`HTML5`doctype：`<!DOCTYPE html>`这会更容易，并且对于 facebook like box、twitter stream 等插件会更好。

然而，为什么一开始就这么担心 HTML 验证呢？这没什么大不了的。

# php - 文本缩进到多级数组？

> ID：15297563
> 
> 赞同：0
> 
> 时间：2013-03-08T15:32:19.417
> 
> 标签：php

我正在尝试构建一个解析器，该解析器应该将文本缩进（TAB KEY）转换为多级 php 数组（我对编程很陌生）

我有一个使用这种格式编写的 txt 文件：

```
test1
    test2
        blah3
    blah4
    blah5
        more content
some more
    and more content 
```

解析后它应该返回一个数组，如：

```
$myarray[0]['c']                   = "test1";
$myarray[0]['s'][0]['c']           = "test2";
$myarray[0]['s'][0]['s'][0]['c']   = "blah3";
$myarray[0]['s'][1]['c']           = "blah4";
$myarray[0]['s'][2]['c']           = "blah5";
$myarray[0]['s'][2]['s'][0]['c']   = "more content";
$myarray[1]['c']                   = "some more";
$myarray[1]['s'][0]['c']           = "and more content"; 
```

可以在php中构建这样的功能吗？

在你问我不能使用 xml 之前，因为我已经有了必须先转换为 xml 的 txt 文件

非常感谢您的回答

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:37:14.330

当然你可以写一个这样的解析器。您要做的实际上是构建一个树数据结构，该结构存储为数组数组，其中叶节点是文本值，分支由 TAB 确定。

你需要做的是：

*   逐行读取输入文本文件
*   使用变量来保持当前缩进
*   对于每一行，确定前导制表符的数量（缩进）
*   如果缩进与前一行的缩进匹配，则将该行上的其余文本作为同级添加到当前数组
*   如果它比当前缩进大 1，则添加一个分支（另一个子数组）
*   小于当前缩进，对应设置当前数组

如果您需要对这些步骤中的任何一个进行更多说明，请告诉我。

**更新**

这里有一些建议。

您可以使用以下内容逐行读取文件：

```
$file_handle = fopen("myfile", "r");
while (!feof($file_handle)) {
   $line = fgets($file_handle);

   // process line here

}
fclose($file_handle); 
```

您可以使用如下代码检测每行中前导 TAB 的数量：

```
$numTabs = 0;
while(substr($line, $numTabs, 1) == "\t")
{
    $numTabs++;
} 
```

[然后使用对substr](http://www.php.net/manual/en/function.substr.php)的另一个调用来获取该行的其余部分：

```
$lineValue = substr($line, $numTabs); 
```

要测试一行是否为空白，您可以使用[trim](http://www.php.net/manual/en/function.trim.php)：

```
if(trim($line) == ""){
   // line is blank.. just skip it!
} 
```

# rvm - 如何从 Chef 和 Vagrant 调试 RVM 设置？

> ID：15297564
> 
> 赞同：0
> 
> 时间：2013-03-08T15:32:20.307
> 
> 标签：rvm, chef-infra, vagrant

我在 Vagrant VM 上使用 Chef-solo 设置了 RVM 就好了，但是我对为什么`bundler`在 rails 项目中找不到它感到困惑。

因此，配置后我看到：

```
上次登录时间：2012 年 10 月 4 日星期四 15:23:58 从 10.0.2.2
vagrant@vm:~$ ruby​​ -v
ruby 1.9.3p327（2012-11-10 修订版 37606）[x86_64-linux]
vagrant@vm:~$ 宝石列表

*** 当地宝石 ***

大十进制 (1.1.0)
捆绑器 (1.3.2)
daemon_controller (1.1.1)
快速线程（1.0.7）
io 控制台 (0.3)
json (1.5.4)
迷你测试（2.5.1）
乘客 (3.0.18)
机架 (1.5.2)
耙子 (10.0.3, 0.9.2.2)
rdoc (3.9.4)
rubygems 捆绑器 (1.1.1)
rvm (1.11.3.6)

```

转到我看到的项目目录：

```
vagrant@vm:~$ cd /www/vm/rails/current/
==================================================== ==============================
= 通知 =
==================================================== ==============================
= RVM 在当前目录中遇到了新的或修改过的 .rvmrc 文件 =
= 这是一个 shell 脚本，因此可能包含任何 shell 命令。=
= =
= 仔细检查该文件的内容以确保内容是 =
= 在信任它之前是安全的！（选择下面的v[iew]查看内容）=
==================================================== ==============================
您希望信任此 .rvmrc 文件吗？(/www/vm/rails/current/.rvmrc)
y[es], n[o], v[iew], c[ancel]> y
mkdir：无法创建目录`/usr/local/rvm/gems/ruby-1.9.3-p327@vm'：权限被拒绝
gemset vm 不存在，正在创建。
mkdir：无法创建目录`/usr/local/rvm/gems/ruby-1.9.3-p327@vm'：权限被拒绝
mkdir：无法创建目录`/usr/local/rvm/gems/ruby-1.9.3-p327@vm'：权限被拒绝

```

但是现在，再也找不到捆绑软件了，而且我在激活 RVM 时也遇到了问题……有什么想法可以调试吗？

```
$ rvm 使用 ruby​​-1.9.3-p327
请注意 `rvm gem ...` 已被删除，请尝试使用 `gem ` 或 `rvm all do gem `。（见：'rvm用法'）

```

PS我的节点json基本上是这样的：[https ://github.com/mulderp/chef-rails-stack](https://github.com/mulderp/chef-rails-stack)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:36:53.817

对于调试，我使用[https://github.com/mpapis/rvm-binary/blob/master/cookbooks/binary/recipes/default.rb#L11](https://github.com/mpapis/rvm-binary/blob/master/cookbooks/binary/recipes/default.rb#L11)：

```
class Chef::Resource::Script
  def log_code command
    if Chef::Config[:log_level] == :debug
      code "{ #{command}; _ret=$?; echo \"Exit status was $_ret.\"; exit $_ret; } 2>&1 |
tee /var/log/#{@command.to_s.gsub(/ /,"_")}.log; exit ${PIPESTATUS[0]}"
    else
      code command
    end
  end
end 
```

然后代替`code`使用`log_code`，它将保存登录`/var/log/#{@command.to_s.gsub(/ /,"_")}.log`

至于 RVM 与 Chef 的轻松集成，请查看[https://gist.github.com/sevos/5076747](https://gist.github.com/sevos/5076747)：

```
deploy_user = node[:deploy][:user]
deploy_user_home = File.join('/', 'home', deploy_user)
rvm_version = "head"

execute "install_rvm_for_deploy_user" do
  user deploy_user
  command "curl -L https://get.rvm.io | bash -s #{rvm_version}"
  environment "HOME" => deploy_user_home
  creates "#{deploy_user_home}/.rvm"
end

node['buildpack']['ruby_versions'].each do |ruby_version|
  execute "install_rvm_ruby_#{ruby_version}" do
    user deploy_user
    environment "HOME" => deploy_user_home
    command "#{deploy_user_home}/.rvm/bin/rvm install #{ruby_version} --autolibs=3"
  end
end

file "#{deploy_user_home}/.rvmrc" do
  content 'export rvm_trust_rvmrcs_flag=1'
  owner deploy_user
  mode 0644
end 
```

# javascript - 修复 Firefox 在 setInterval 上抛出错误。

> ID：15297569
> 
> 赞同：1
> 
> 时间：2013-03-08T15:32:40.150
> 
> 标签：javascript, google-chrome, firefox

为什么 `setInterval(fetchData(), 1000*60);`在 Chrome 中工作而在 Firefox 中抛出错误；我想将一个变量传递给 fetchdata。

```
 function fetchData(var) {
        .....
    };

    fetchData(var); //run once
    setInterval(fetchData(var), 1000*60); //then repeat 
```

堆栈跟踪：

```
[10:26:49.764] Error: useless setInterval call (missing quotes around argument?)
userController@http://localhost:8000/mainx.js:169
invoke@http://localhost:8000/lib/angular.js:2809
instantiate@http://localhost:8000/lib/angular.js:2819
@http://localhost:8000/lib/angular.js:4639
applyDirectivesToNode/nodeLinkFn/<@http://localhost:8000/lib/angular.js:4218
forEach@http://localhost:8000/lib/angular.js:117
nodeLinkFn@http://localhost:8000/lib/angular.js:4203
compositeLinkFn@http://localhost:8000/lib/angular.js:3851
publicLinkFn@http://localhost:8000/lib/angular.js:3763
bootstrap/</<@http://localhost:8000/lib/angular.js:932
Scope.prototype.$eval@http://localhost:8000/lib/angular.js:7840
Scope.prototype.$apply@http://localhost:8000/lib/angular.js:7920
bootstrap/<@http://localhost:8000/lib/angular.js:930
invoke@http://localhost:8000/lib/angular.js:2802
bootstrap@http://localhost:8000/lib/angular.js:929
angularInit@http://localhost:8000/lib/angular.js:904
@http://localhost:8000/lib/angular.js:14527
p.Callbacks/k@http://localhost:8000/lib/jquery-1.8.2.min.js:2
p.Callbacks/l.fireWith@http://localhost:8000/lib/jquery-1.8.2.min.js:2
.ready@http://localhost:8000/lib/jquery-1.8.2.min.js:2
D@http://localhost:8000/lib/jquery-1.8.2.min.js:2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:34:17.997

采用

```
setInterval(function() {fetchData(var)}, 1000*60); //then repeat 
```

您所做的实际上根本没有通过您的论点。您需要将其包装在**[匿名函数](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope)**中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:34:30.900

此语法不正确。您不能使用 setTimeout 或 setInterval 传递这样的变量。

```
setInterval(fetchData(var), 1000*60); //then repeat 
```

请改用以下内容。

```
setInterval(function() {
    fetchData(var);
}, 1000*60); 
```

# wordpress - WordPress有私人日历插件吗？

> ID：15297574
> 
> 赞同：1
> 
> 时间：2013-03-08T15:32:59.637
> 
> 标签：wordpress, plugins, calendar, private

我正在寻找一个可以完全私密的日历。到目前为止，我只找到了可以有私人活动的日历。我需要一个日历在会员专用部分，所以整个日历必须能够是私人的。

我意识到这可能不存在，因为我已经在互联网上搜索了一个小时关于这个主题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:09:05.287

在任何日历插件中，它应该很容易只允许登录用户访问：这些看起来很不错：

[http://wordpress.org/extend/plugins/all-in-one-event-calendar/screenshots/](http://wordpress.org/extend/plugins/all-in-one-event-calendar/screenshots/)
[http://wordpress.org/extend/plugins/calendar/screenshots/](http://wordpress.org/extend/plugins/calendar/screenshots/)

然后您必须将以下代码放入合适的挂钩中以强制登录，即完全私人访问。8)

```
if ( ! is_user_logged_in())
{
    wp_redirect(wp_login_url());
    exit;
} 
```

# ios - ABPersonViewController 无法访问通讯录

> ID：15297575
> 
> 赞同：0
> 
> 时间：2013-03-08T15:33:02.183
> 
> 标签：ios, cocoa-touch, addressbook, abpersonviewcontroller, addressbookui

我正在实现一个应用程序，用户应该能够从通讯录中导入联系人或自己提供联系人。我使用[https://github.com/soffes/sspersonviewcontroller](https://github.com/soffes/sspersonviewcontroller)实现了一切。新联系人已添加到通讯录中，一切正常。通过使用 ABPersonViewController 等，我拥有所有字段和编辑功能......

但是现在客户坚持不应该将联系人存储在地址簿中，而是在应用程序中，并且除了导入之外，永远不应该要求用户授予对地址簿的访问权限。

[我通过使用 ABRecordRef 的序列化程序（来自https://github.com/nvrooij/Let-s-Share/blob/master/Classes/ABRecordSerializer.h](https://github.com/nvrooij/Let-s-Share/blob/master/Classes/ABRecordSerializer.h)）使“将联系人导入应用程序”工作

但我最大的问题是，ABNewPersonViewController 和 ABPersonViewController 坚持要求用户访问地址簿。

**所以我需要：**

*   无需访问地址簿即可创建联系人的视图。它应该将 ABRecordRef 返回给一个人，这样我就可以在某个地方对其进行序列化（atm 我将它存储到 NSUserDefaults）

*   无需访问地址簿即可编辑联系人的视图。

**我已经尝试过：** 按照[如何在不连接到地址簿的情况下使用 ABPersonViewController](https://stackoverflow.com/questions/4209997/how-to-use-a-abpersonviewcontroller-without-connecting-to-addressbook)我设置了 displayPerson - 但“授权访问弹出窗口”仍然出现。

从 ABNewPersonViewController 和 ABPersonViewController 的文档中，我得到的印象是，在所有情况下，子类化和覆盖地址簿的 getter 以返回 nil 都可以，我最终会看到没有地址簿的视图。但是在那里的某个地方（我假设视图本身）再次创建了地址簿，我无法摆脱这个电话。

**你可以如何提供帮助_**

任何指向 ABPersonViewController 重新实现的指针（包括编辑功能）或任何其他提示都非常受欢迎。

任何关于如何创建具有所有好东西（国家选择、字段添加等）的创建用户视图控制器的想法也非常受欢迎。

如果您认为我的方法完全不正确，请也发表评论。我一直在寻找不同的角度，可能对整个通讯簿灾难挖得太深了。

我希望用于创建和编辑联系人的控制器与地址簿完全分离，并返回 ABRecordRef 而不是访问地址簿。就我而言，这将大大简化我的任务（一个人可以梦想）。

一切顺利，iosGoblin

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-10T15:30:48.157

我解决/规避了以下问题：我放弃了编辑功能，并创建了一个类似于 ABNewPersonViewController 的视图控制器（只有一些特定的字段，如姓名、确定姓名、电话号码、地址）。从输入中我创建了一个 ABRecordRef（有用的代码在[http://www.modelmetrics.com/tomgersic/iphone-programming-adding-a-contact-to-the-iphone-address-book/](http://www.modelmetrics.com/tomgersic/iphone-programming-adding-a-contact-to-the-iphone-address-book/)）。我使用 ABRecordSerializer 将此联系人序列化为 NSUserDefaults （我的问题中的链接）

如果用户导入一个联系人，我只需将我从 ABPeoplePickerNavigationController 返回的联系人序列化到 NSUserDefaults 中。

如果联系人存储在 NSUserDefaults 中，我会反序列化并显示它。

回顾：

*   我重新实现了 ABNewPersonViewController 的简化版本
*   我使用序列化程序（上面的链接）将联系人存储在 NSUserDefaults 中（来自我的视图控制器或从导入的视图控制器，一旦它被序列化，我就不再关心了）
*   我将联系人反序列化并显示

一切顺利，iosGoblin

# mysql - 从崩溃的 mysql 表中检索数据

> ID：15297580
> 
> 赞同：1
> 
> 时间：2013-03-08T15:33:14.343
> 
> 标签：mysql, mysqldump, corrupt

我正在尝试从标记为已崩溃的 mysql 表中检索一些数据。我正在处理机器的恢复备份，所以我不需要担心任何事情。

当我尝试 mysqldump 表时（仅供参考，我正在使用 --where 指定我需要哪些记录），我收到一个错误：

```
mysqldump: Got error: 144: Table './[db]/[table]' is marked as crashed and last (automatic?) repair failed when doing LOCK TABLES 
```

如果我使用 --lock-tables=false 我会得到同样的错误（但在执行 SHOW FIELDS 时失败）。

如果我尝试从表中选择第一条记录，我会得到同样的错误。

如果我运行 CHECK TABLE [table]，我会收到以下警告/错误：

```
warning  | 1 client is using or hasn't closed the table properly |
warning  | Size of indexfile is: 1991678976      Should be: 1024 |
error    | Record-count is not ok; is 30030697   Should be: 0    |
warning  | Found 141967876 deleted space.   Should be 0          |
warning  | Found 3101578 deleted blocks       Should be: 0       |
warning  | Found 34721783 key parts. Should be: 0                |
error    | Corrupt                                               | 
```

这意味着如果我做一个修复表，我将丢失所有数据！那里应该有30030697条记录......

我有什么方法可以获取这些数据吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:44:39.207

要修复有问题的表，请发出命令

`myisamchk --recover /var/lib/mysql/DATABASENAME/TABLE_NAME.myi`

（其中 DATABASENAME 是您正在使用的数据库的名称，而 TABLE_NAME 是要检查的表的名称。）

如果这不能完全恢复表，您可以重新运行将 –recover 替换为 –safe-recover 的命令，该命令更慢且更彻底。

如果在行级锁定或错误写入（坏扇区）期间存在严重冲突，它们只会进行这样的转储。

# php - 获取拆分为两部分的 PHP 数组的所有可能组合

> ID：15297586
> 
> 赞同：2
> 
> 时间：2013-03-08T15:33:31.403
> 
> 标签：php, arrays

我正在研究生成运动队的代码。我有一个包含球员列表的数组，并希望将所有可能的团队组合存储在另一个数组中。

为简单起见，让我们想象一场网球比赛，其中有 4 名球员将被分成两队。

`$players = array("Federer","Del Potro","Nadal","Murray");`

输出数组应如下所示：

```
$combinations[0][0] = "Federer","Del Potro";
$combinations[0][1] = "Nadal","Murray";

$combinations[1][0] = "Federer","Nadal";
$combinations[1][1] = "Del Potro","Murray";

$combinations[2][0] = "Del Potro","Nadal";
$combinations[2][1] = "Federer","Murray"; .. and so forth.. 
```

有什么帮助吗？

提前致谢！

/// - 编辑

这是我到目前为止的代码。所有玩家也有一个分数，我存储这个分数供以后使用。它不是很重要。我想我已经让它工作了，但我不确定这段代码是否能得到所有可能的组合。我所做的是循环“玩家计数”时间并开始建立团队，在建立团队后，我将列表中的第二个玩家移动到数组的底部并再次循环。

```
 //-- Get the Max Players and the Array of Player Names
    $max_players = count($players)/2;
    $p = array_keys($players);

    for($i=0;$i<=(count($p));$i++){
        $tmp = array();
        $t=0;

        //-- Loop and start placing players into a team. When the max is reached, start placing on the other team.
        foreach($p as $player) {
            //-- Store player on Team
            $tmp[$t][] = $player;
            if(count($tmp[$t])==$max_players) {
                $t++;
            }
        }
        //-- Get the second player and move it to the bottom of the list.
        $second = $p[1];
        unset($p[1]);
        $p[] = $second;
        $p = array_values($p);

        //-- Loop thru teams and add the score of each player
        foreach($tmp as $key=>$eq) {
            $score = 0 ;
            foreach($eq as $jug) {
                //-- Add Score for each player
                $score +=  floatval($players[$jug]["score"]);
            }
            //-- Store the sum of scores of all players in team
            $tmp[$key]["score"] = $score;
        }
        //-- Store the Difference between team scores in this "team set"
        $tmp["diff"] = abs(round($tmp[0]["score"]-$tmp[1]["score"],2));
        $teams[] = $tmp;
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:42:26.470

刚刚用谷歌搜索并从 stackoverflow.com 找到了这些结果

[获取 PHP 数组的所有组合](https://stackoverflow.com/questions/10222835)

[算法将采用数字或单词并找到所有可能的组合](https://stackoverflow.com/questions/1679605/)

[PHP：如何获得一维数组的所有可能组合？](https://stackoverflow.com/questions/10834393/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-10T11:19:52.517

$player_combination = []; $match_combination = [];

```
 $players = array("Federer","Del Potro","Nadal","Murray");
  for($i = 0; $i< count($players);$i++){
      for($j=$i+1;$j<count($players);$j++){
        $player_combination[] = [$players[$i],$players[$j]]; 
       }
  }

  for($i = 0; $i< count($player_combination);$i++){
      for($j=$i+1;$j<count($player_combination);$j++){
        if(($player_combination[$i][0] !== $player_combination[$j][0]) &&  ($player_combination[$i][0] !== $player_combination[$j][1])&& ($player_combination[$i][1] !== $player_combination[$j][0]) && ($player_combination[$i][1] !== $player_combination[$j][1]))
        $match_combination[] = [$player_combination[$i],$player_combination[$j]]; 
       }
  } 
```

我的网站是[9amobile.com](https://9amobile.com)

# java - 在 Struts 1.x JSP 中填充多个表单

> ID：15297587
> 
> 赞同：3
> 
> 时间：2013-03-08T15:33:31.913
> 
> 标签：java, jsp, struts, struts-1

有没有办法用 Struts 填充多个表单并使它们可用于 JSP 页面？

我正在构建一个页面，上面有两种不同的表单，需要从数据库中预先填充自定义数据。两种形式必须在同一页面上。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T17:30:11.663

当您调用 struts 动作时，框架会创建唯一的一个表单。它是与动作相关联的表单。此表单可通过`execute`方法提供的参数获得。

但是，JSP 可能包含多个表单来执行多个操作。如果动作分派到 JSP，那么只有一个表单将被处理以将标记映射到表单 bean 的属性。

但是，没有什么可以阻止您在操作中创建其他表单实例并通过 EL 表达式在 JSP 中手动处理它。表单 bean 的实例可以通过表单名称更好地放置在请求或会话中，因此可以通过 EL 表达式轻松访问它。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-08T15:45:43.113

是的，这是可能的。

您可以为此问题指定多个`ActionForm`实现（首选）或仅使用一个 - 无论如何。

```
<nested:root name="myFirstForm">
    <nested:form action="/MyAction.do?method=foo" method="post">
        <%-- some code --%>
    </nested:form>
    <nested:form action="/MyAction.do?method=bar" method="post">
        <%-- some code --%>
    </nested:form>
</nested:root>
<nested:root name="mySecondForm">
    <nested:form action="/MyAction.do?method=foobar" method="post">
        <%-- some code --%>
    </nested:form>
</nested:root> 
```

来自 Apache Struts[新手常见问题解答](http://struts.apache.org/development/1.x/faqs/newbie.html)：

> 问：我是否必须为每个 HTML 表单设置一个单独的 ActionForm bean？
> 
> 答：这是一个有趣的问题。作为一个新手，为每个动作序列创建一个新的 ActionForm 是一个很好的做法。

# python - 改进编码保存如何在 Python 中检查两条线段是否相交

> ID：15297590
> 
> 赞同：4
> 
> 时间：2013-03-08T15:33:46.210
> 
> 标签：python, coding-style, geometry, line

考虑以下交叉线示例：

```
l1 = ((20,5),(40,20))
l2 = ((20,20),(40,5))
l3 = ((30,30),(30,5)) # vertical line 
```

我开发了以下代码来计算交叉点的 x,y（参见理论细节）

```
def gradient(l):
    """Returns gradient 'm' of a line"""
    m = None
    # Ensure that the line is not vertical
    if l[0][0] != l[1][0]:
        m = (1./(l[0][0]-l[1][0]))*(l[0][1] - l[1][1])
        return m

def parallel(l1,l2):
    if gradient(l1) != gradient(l2):
        return False
    return True

def intersect(l):
    """Returns intersect (b) of a line using the equation of
    a line in slope and intercepet form (y = mx+b)"""
    return l[0][1] - (gradient(l)*l[0][0])

def line_intersection(l1,l2):
    """Returns the intersection point (x,y) of two line segments. Returns False
    for parallel lines"""
    # Not parallel
    if not parallel(l1,l2):
        if gradient(l1) is not None and gradient(l2) is not None:
            x = (1./(gradient(l1) - gradient(l2))) * (intersect(l2) - intersect(l1))
            y = (gradient(l1)*x) + intersect(l1)
        else:
            if gradient(l1) is None:
                x = l1[0][0]
                y = (gradient(l2)*x) + intersect(l2)
            elif gradient(l2) is None:
                x = l2[0][0]
                y = (gradient(l1)*x) + intersect(l1)
        return (x,y)
    else:
        return False 
```

示例会话：

```
>>> line_intersection(l1,l2)
(30.0, 12.5)
>>> line_intersection(l2,l3)
(30, 12.5) 
```

在长度有限的线段的情况下，我希望以一种有效的方式改进我的代码，并且它们实际上可能不会相交。

```
l1 = ((4,4),(10,10)) 
l2 = ((11,5),(5,11))
l3 = ((11,5),(9,7))

line_intersection(l1,l2) #valid
(8.0, 8.0)
line_intersection(l1,l3) # they don't cross each other
(8.0, 8.0)
line_intersection(l2,l3) #line parallel
False 
```

我**不优雅**的解决方案如下。

```
def crosses(l1,l2):
    if not parallel(l1,l2):
        x = line_intersection(l1,l2)[0]
        xranges = [max(min(l1[0][0],l1[1][0]),min(l2[0][0],l2[1][0])),min(max(l1[0][0],l1[1][0]),max(l2[0][0],l2[1][0]))]
        if min(xranges) <= x <= max(xranges):
            return True
        else:
            return False
    else:
        return False

crosses(l1,l2)
True
crosses(l2,l3)
False 
```

我正在寻找是否可以改进我在 python 中的函数样式

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-09T04:20:23.543

在我的书中，任何返回正确答案的代码都非常棒。做得好。

这里有一些建议：

```
def parallel(l1,l2):
    if gradient(l1) != gradient(l2):
        return False
    return True 
```

可以写成

```
def parallel(l1,l2):
    return gradient(l1) == gradient(l2) 
```

相似地，

```
if min(xranges) <= x <= max(xranges):
    return True
else:
    return False 
```

可以写成

```
return min(xranges) <= x <= max(xranges) 
```

* * *

尽可能避免使用整数索引，尤其是像`l1[0][0]`.

单词或变量名比整数索引更容易阅读和理解。

整数索引的一种方法是使用“元组解包”：

```
(x1, y1), (x2, y2) = l1 
```

然后`l1[0][0]`变成`x1`。这可以提高`gradient`和`crosses`函数中代码的可读性。

* * *

线平行时有两种情况。如果线不共线，则它们永远不会相交。但如果这些线是共线的，它们就会到处相交。

说的好像不太准确

```
line_intersection(line, line) 
```

是`False`当线条共线时。当有问题的行是完全相同的行时，它似乎更加错误（如果这样的事情是可能的:)）。

`None`如果线条共线，并且线条平行但不共线，我建议返回任意交点。

* * *

比较浮点数是否相等时会出现一个错误：

```
 In [81]: 1.2 - 1.0 == 0.2
    Out[81]: False 
```

这不是 Python 中的错误，而是[由浮点数的内部表示引起的问题，](http://effbot.org/pyfaq/why-are-floating-point-calculations-so-inaccurate.htm)它会影响以任何语言完成的所有浮点计算。它可以在任何试图比较浮点数是否相等的代码中引入一个错误——比如这里：

```
def parallel(l1,l2):
    if gradient(l1) == gradient(l2): ... 
```

因此，我们可以做的最好的不是比较浮点数的相等性，而是测试两个浮点数是否在一定的容差范围内彼此靠近。例如，

```
def near(a, b, rtol=1e-5, atol=1e-8):
    # Essentially borrowed from NumPy 
    return abs(a - b) < (atol + rtol * abs(b))

def parallel(l1,l2):
    if near(gradient(l1), gradient(l2)): ... 
```

* * *

PEP8[风格指南说](http://www.python.org/dev/peps/pep-0008/#names-to-avoid)，

> 切勿使用字符“l”（小写字母 el）、“O”（大写字母 oh）或“I”（大写字母 eye）作为单字符变量名。
> 
> 在某些字体中，这些字符与数字 1 和 0 无法区分。

所以而不是`l1`我建议`line1`。

* * *

现在，正如@george 指出的那样，代码在许多地方将垂直线处理为特例（`if gradient is None`。）如果我们使用线的参数形式，我们可以以相同的方式处理*所有*线。代码会更简单，因为数学会更简单。

如果你知道一条线上的两个点`(x1, y1)`和`(x2, y2)`，那么这条线的参数形式是

```
l(t) = (x1, y1)*(1-t) + (x2, y2)*t 
```

标量在哪里`t`。随着`t`变化，您会在线上获得不同的点。请注意有关参数形式的一些相关事实：

*   当 时`t = 1`，右边的**第一**`(x2, y2)`项退出，所以你剩下。

*   当 时`t = 0`，右边的**第二**`(x1, y1)*(1-0) = (x1, y1)`项退出，所以你剩下。

*   等式的右边**线性**依赖于`t`。没有`t**2`项或任何其他非线性依赖`t`。**所以参数形式描述了一条线**。

* * *

**为什么线的参数形式强大？**

*   线段 (x1, y1) 到 (x2, y2) 内的点对应于 `t`0 和 1（含）之间的值。的所有其他值`t` 对应于线段之外的点。

*   还要注意，就参数形式而言，垂直线并没有什么特别之处。您不必担心无限的斜坡。*每一行都可以用同样的方式处理*。

* * *

**我们如何利用这一事实？**

如果我们有两条参数形式的线：

```
l1(t) = (x1, y1)*(1-t) + (x2, y2)*t

l2(s) = (u1, v1)*(1-s) + (u2, v2)*s 
```

（将 x1, y1, x2, y2, u1, v1, u2, v2 视为给定的常数），那么当这些线相交时

```
l1(t) = l2(s) 
```

现在，`l1(t)`是一个二维点。`l1(t) = l2(s)`是一个二维方程。有一个用于`x`- 坐标的方程和一个用于 - 坐标的`y`方程`l1(t) = l2(s)`。所以我们真的有两个方程和两个未知数（`t`和`s`）。我们可以解决这些方程`t`和`s`！（希望。如果线不相交，则`t`和没有解决方案`s`。

* * *

所以让我们做一些数学:)

```
l1(t) = (x1, y1) + (x2-x1, y2-y1)*t
l2(s) = (u1, v1) + (u2-u1, v2-v1)*s 
```

`l1(t) = l2(s)`意味着两个标量方程：

```
x1 + (x2-x1)*t = u1 + (u2-u1)*s
y1 + (y2-y1)*t = v1 + (v2-v1)*s

(x2-x1)*t - (u2-u1)*s = u1-x1
(y2-y1)*t - (v2-v1)*s = v1-y1 
```

我们可以将其重写为矩阵方程：

![在此处输入图像描述](../Images/d5d838c9c022f41e840822f8822c787a.png)

使用[克莱默法则](http://en.wikipedia.org/wiki/Cramer%27s_rule#Explicit_formulas_for_small_systems)，我们可以求解`t`和`s`：如果

![在此处输入图像描述](../Images/fd27c6e41f1682255f3b70dab6bd19c2.png)

然后

![在此处输入图像描述](../Images/e1f5e9a8f0d5c62e47ecb7702aadd6af.png)

![在此处输入图像描述](../Images/92a266183c613ce45f0b97294d838eeb.png)

请注意，从数学的角度来看，Cramer 规则是有效的（并且易于编码），但它[的数值属性很差](http://en.wikipedia.org/wiki/System_of_linear_equations#Cramer.27s_rule)（另请参阅[GEPP 与 Cramer 规则](https://books.google.com/books?id=5tv3HdF-0N8C&pg=PA13&lpg=PA13&dq=numerical+instability+Cramer%27s+rule&source=bl&ots=IGq1WXdbU7&sig=U8DiFxdyjWJhwYRXXRRDZkBpPsw&hl=en&sa=X&ei=xh-hVZn7HoafNruzg4gI&ved=0CDYQ6AEwAw#v=onepage&q=numerical%20instability%20Cramer%27s%20rule&f=false)）。对于严肃的应用程序，请使用[LU 分解](http://en.wikipedia.org/wiki/LU_decomposition#Solving_linear_equations)或 LAPACK（可通过 NumPy 获得）。

* * *

所以我们可以将其编码如下：

```
def line_intersection(line1, line2):
    """
    Return the coordinates of a point of intersection given two lines.
    Return None if the lines are parallel, but non-collinear.
    Return an arbitrary point of intersection if the lines are collinear.

    Parameters:
    line1 and line2: lines given by 2 points (a 2-tuple of (x,y)-coords).
    """
    (x1,y1), (x2,y2) = line1
    (u1,v1), (u2,v2) = line2
    (a,b), (c,d) = (x2-x1, u1-u2), (y2-y1, v1-v2)
    e, f = u1-x1, v1-y1
    # Solve ((a,b), (c,d)) * (t,s) = (e,f)
    denom = float(a*d - b*c)
    if near(denom, 0):
        # parallel
        # If collinear, the equation is solvable with t = 0.
        # When t=0, s would have to equal e/b and f/d
        if near(float(e)/b, float(f)/d):
            # collinear
            px = x1
            py = y1
        else:
            return None
    else:
        t = (e*d - b*f)/denom
        # s = (a*f - e*c)/denom
        px = x1 + t*(x2-x1)
        py = y1 + t*(y2-y1)
    return px, py

def crosses(line1, line2):
    """
    Return True if line segment line1 intersects line segment line2 and 
    line1 and line2 are not parallel.
    """
    (x1,y1), (x2,y2) = line1
    (u1,v1), (u2,v2) = line2
    (a,b), (c,d) = (x2-x1, u1-u2), (y2-y1, v1-v2)
    e, f = u1-x1, v1-y1
    denom = float(a*d - b*c)
    if near(denom, 0):
        # parallel
        return False
    else:
        t = (e*d - b*f)/denom
        s = (a*f - e*c)/denom
        # When 0<=t<=1 and 0<=s<=1 the point of intersection occurs within the
        # line segments
        return 0<=t<=1 and 0<=s<=1

def near(a, b, rtol=1e-5, atol=1e-8):
    return abs(a - b) < (atol + rtol * abs(b))

line1 = ((4,4),(10,10)) 
line2 = ((11,5),(5,11))
line3 = ((11,5),(9,7))
line4 = ((4,0),(10,6)) 

assert all(near(a,b) for a,b in zip(line_intersection(line1,line2), (8.0, 8.0)))
assert all(near(a,b) for a,b in zip(line_intersection(line1,line3), (8.0, 8.0)))
assert all(near(a,b) for a,b in zip(line_intersection(line2,line3), (11, 5)))

assert line_intersection(line1, line4) == None # parallel, non-collinear
assert crosses(line1,line2) == True
assert crosses(line2,line3) == False 
```

# c# - 控制台应用程序中的WriteableBitmapEx？

> ID：15297603
> 
> 赞同：1
> 
> 时间：2013-03-08T15:34:28.317
> 
> 标签：c#, console-application, writeablebitmap, writeablebitmapex

我想知道是否可以在普通的 C# 控制台应用程序中使用 WriteableBitmap 类/WriteableBitmapEx 框架？我试图通过 nuget 添加它，并且还包含了 System.Windows.Media.Imaging 的 using 语句，但该类型未被识别。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:40:20.420

System.Windows.Media.Imaging 命名空间位于 PresentationCore.dll 中。在您的项目资源管理器中，右键单击 References 并选择“Add Reference...”，然后选择 PresentationCore。

# mysql - 从 Magento 数据库中的序列化字段获取数据

> ID：15297605
> 
> 赞同：1
> 
> 时间：2013-03-08T15:34:30.930
> 
> 标签：mysql, magento

我正在尝试通过 mysql 创建在我们的 Magento 商店中订购的分组项目的报告。不幸的是，该数据存储在 sales_flat_order_item.product_options 中的序列化数组中，如下所示：

```
a:2:{s:15:"info_buyRequest";a:1:{s:20:"super_product_config";a:2:{s:12:"product_type";s:7:"grouped";s:10:"product_id";s:3:"563";}}s:20:"super_product_config";a:3:{s:12:"product_code";s:12:"product_type";s:12:"product_type";s:7:"grouped";s:10:"product_id";s:3:"563";}} 
```

我需要的是该数组中的 product_id 。有没有简单的方法通过mysql做到这一点？我必须将该 ID 重新返回到查询中，以便从产品表中获取 SKU。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:21:12.043

你只需要[反序列化](http://www.php.net/manual/en/function.unserialize.php)它

# php - 在 Ajax 加载的 php 模块中使用 javascript，即使请求成功也返回错误值

> ID：15297617
> 
> 赞同：0
> 
> 时间：2013-03-08T15:34:55.280
> 
> 标签：php, javascript, ajax

我有一个用 php 编写的主页，我使用 Ajax 在给定的`div`. 当然，我删除了一些代码，但我认为主要的东西在那里：调用`load()`，检查成功（或不成功）ajax请求以及检查从php“返回”的js变量（我会稍后再解释）；这是javascript：

```
var ajax_error = ""; //i use this to catch load errors

//.....//

$("#div_target").load("loadmodule.php", {'module':module_number}, function(response, status, xhr)
{
  if (status == "error") //this is for ajax-related errors
  {
    alert('Failed loading module. Error: '+xhr.status + " " + xhr.statusText);
  }
  else 
  {
    //this checks if the variable has been set by the php module to represent an error
    if (ajax_error !== "")
    {
      $("#div_target").html(ajax_error); //show the error instead of the module
      ajax_error = ""; //we reset the variable for future uses
    }
    else
    {
      //do something with the correctly loaded module..
    }
  }
}); 
```

那个“loadmodule.php”是后续的（同样，代码被减少了）：

```
//check for the post value, that should be a positive number as well as check for the file to exist
if ( 
  isset($_POST['module']) 
  && is_numeric($_POST['module']) 
  && ($_POST['module'] > 0) 
  && file_exists("module_" . $_POST['module'] . ".php")
)
{
  //include module
  include("module_{$_POST['module']}.php");
}
else
{
  //error retrieving module
  ?>
  <script type="text/javascript">
    ajax_error = "Cannot load module." ;
  </script>
  <?php
} 
```

这样，如果在检查 时出现任何错误`$_POST['module']`，我们可以通过设置变量“告诉”javascript 发生了错误，该变量`ajax_error`将在 ajax 成功完成请求后“捕获”。一切正常（这个变量的上下文`ajax_error`是正确的，即使它看起来不是这样，在这里的剥离代码中：P），但是..

..我的问题是（是）：这种方法正确吗？这样做有什么问题吗？有没有什么看起来不像解决方法的东西？还是我只是在这种情况下尽我所能？

PS：我发现很难给我的问题起个标题，希望没问题:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:42:18.517

是的，这可能有效，但对我来说似乎很难看。我建议不要使用 $obj.load，而是使用[$.get](http://api.jquery.com/jQuery.get/)。服务器脚本 (loadmodule.php) 不会返回纯 HTML，而是带有两个值的 JSON：一个布尔标志确定模块是否存在，第二个是 HTML 内容。

然后，如果标志告诉该模块不存在，成功处理程序将决定是否将某些内容放入所需的位置或显示错误消息。

# c# - Request.UserHostAddress 返回负载均衡器的 IP 地址

> ID：15297620
> 
> 赞同：9
> 
> 时间：2013-03-08T15:35:06.927
> 
> 标签：c#, request, load-balancing

我的站点中有一行关键代码在我们的开发环境中工作，但在生产环境中没有。好吧，我说它在开发中有效，但事实是它给出`::1`了 IPv6 环回地址。

无论如何，我想做的是捕获访问该站点的用户的 IP 地址。因此，我曾经`Request.UserHostAddress`这样做过。正如我所说，在开发过程中，它给了我回送地址，这是正确的，因为我是从我的机器上运行该站点的。在现场，它做了一些完全不同的事情。它总是返回负载均衡器的地址。

我想了解的是这个。使用 Request.UserHostAddress 捕获用户的 IP 地址是我错了，还是我们的网络设置有问题或其他问题？

谢谢，

萨钦

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-08T15:41:48.760

在您自己的应用程序中，如果没有其他任何措施可以帮助您，那么您就会陷入困境。这是您可以获得的尽可能多的信息。

如果幸运的话，您的负载均衡器已配置为添加一个或多个额外的标头，其中包含有关原始请求的信息。

一种常见的解决方案是[`X-Forwarded-For`](http://en.wikipedia.org/wiki/X-Forwarded-For)标题：

> X-Forwarded-For (XFF) HTTP 标头字段是一个事实上的标准，用于识别通过 HTTP 代理或负载平衡器连接到 Web 服务器的客户端的原始 IP 地址。

然后您将通过该`Request.Headers`属性访问。

但是发现这个（或另一个）标头是否可用不是我们可以提供的帮助 - 您需要与为您的组织配置负载均衡器的人员交谈。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-04-20T22:12:52.560

参考[@Damien_The_Unbeliever](https://stackoverflow.com/users/15498/damien-the-unbeliever)的[答案](https://stackoverflow.com/a/15297750/75500)，这是完整的解决方案：

```
public static string GetIpAddress()
{
  var request = HttpContext.Current.Request;
  // Look for a proxy address first
  var ip = request.ServerVariables["HTTP_X_FORWARDED_FOR"];

  // If there is no proxy, get the standard remote address
  if (string.IsNullOrWhiteSpace(ip)
      || string.Equals(ip, "unknown", StringComparison.OrdinalIgnoreCase))
    ip = request.ServerVariables["REMOTE_ADDR"];
  else
  {
    //extract first IP
    var index = ip.IndexOf(',');
    if (index > 0)
      ip = ip.Substring(0, index);

    //remove port
    index = ip.IndexOf(':');
    if (index > 0)
      ip = ip.Substring(0, index);
  }

  return ip;
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-03-09T19:52:23.683

使用此代码检查生产环境......它对我有用：

```
 System.Web.HttpRequest oRequest = System.Web.HttpContext.Current.Request;

    string header;
    string ip;

    header = "HTTP_X_FORWARDED_FOR";
    ip = oRequest.ServerVariables[header];
    Response.Write(string.Format("{0} - {1}", header, ip) + Environment.NewLine);

    header = "REMOTE_ADDR";
    ip = oRequest.ServerVariables[header];
    Response.Write(string.Format("{0} - {1}", header, ip) + Environment.NewLine);

    header = "HTTP_CLIENT_IP";
    ip = oRequest.ServerVariables[header];
    Response.Write(string.Format("{0} - {1}", header, ip) + Environment.NewLine);

    header = "Request.UserHostAddress";
    ip = oRequest.UserHostAddress;
    Response.Write(string.Format("{0} - {1}", header, ip) + Environment.NewLine); 
```

# javascript - 预览我的网站时——它很完美，但在线上传时——我的滑块不起作用。

> ID：15297623
> 
> 赞同：0
> 
> 时间：2013-03-08T15:35:11.840
> 
> 标签：javascript, jquery, image, slider, image-uploading

我对 Java 和 HTML/CSS 有点陌生，我想知道是否有人可以帮助我解决这个问题。我已经建立了我的整个投资组合网站，当我在 Safari 和 Firefox 中预览它时，它看起来很棒。但是，当我将它放到网上时，它显示图像仍在加载，并且由于“加载”图标，滑块无法正常工作。

如果有人可以帮助我，我将不胜感激。我整晚都在看我得到的滑块的常见问题解答，但找不到我的交易是什么......我还尝试使用 jquery 文件的原始版本来查看我编辑了错误，但仍然发现没有答案。

非常感谢！

我的网站是 www.shelbylynnebaker.com，如果您想深入了解 HTML/CSS 编码，它已上传且无法正常工作

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:38:36.510

找不到图片：

```
"NetworkError: 404 Not Found - http://www.shelbylynnebaker.com/images/1.jpg"
"NetworkError: 404 Not Found - http://www.shelbylynnebaker.com/images/2.jpg" 
```

等等

您可能忘记上传它们了？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:39:52.650

看起来您正在获取一些未加载的图像，这可能与它有关：“blank.png”和“1.png”未加载。

此外，您尝试使用的 Google 字体似乎也存在问题。

在安装了 Firebug 的 Firefox 中打开您的站点，然后查看 Net 选项卡。

# prolog - 如何等到在序言中断言一个术语？

> ID：15297624
> 
> 赞同：1
> 
> 时间：2013-03-08T15:35:12.073
> 
> 标签：prolog

我希望我的序言程序之一在线程 2 中运行。当我在主线程中断言某些内容时，线程 2 中的程序将监视断言并相应地执行不同的事情。我怎样才能做到这一点？

我写了这样的东西，但它真的很糟糕，因为它需要很多 cpu！

```
read_action(Act) :-
    open('action.txt', read, Stream),
    (can(go_next) ->
        read_line_to_codes(Stream, Act),
        write(Act),
        close(Stream)
        ;
        close(Stream),
        read_action(Act)),
    retractall(can(_)). 
```

我正在使用 Swipl

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:13:47.857

关于线程通信的[页面](http://www.swi-prolog.org/pldoc/doc_for?object=section%283,%278.3.1%27,swi%28%27/doc/Manual/threadcom.html%27%29%29)，它明确说明了要使用的原语：消息队列。

thread_get_message 锁定等待（可能）特定术语。

# jquery - JQuery Mobile 按钮的颜色不会改变颜色

> ID：15297625
> 
> 赞同：0
> 
> 时间：2013-03-08T15:35:15.907
> 
> 标签：jquery, css, jquery-mobile

我创建了一个小型 JQuery 移动应用程序，其中包含三个选项卡按钮，一个按钮用于访问不同的页面。通过使用预先配置的 data-theme="a"，按下的按钮会在按下并加载相关页面时变为蓝色。这适用于第一次单击按钮，但是当第二次单击按钮以再次访问同一页面（从另一个页面）时，按钮不会再次变为蓝色，但仍为深灰色。有谁知道这个问题的解决方案可能在哪里？作为演示，其中一页的代码如下所示。提前致谢

```
<div data-role="page" data-theme="b" id="chart">
    <div data-role="header" data-position="fixed" data-fullscreen="true" class="headerBar" data-theme="a">
       <a href="#busstat" data-icon="arrow-l" data-iconpos="left" data-transition="slide" data-direction="reverse" class="back-button">Back</a>
        <div align="center" style="vertical-align:middle; margin-top:10px; margin-bottom:10px;">
            Cars
        </div>
    </div>
    <div data-role="content" data-fullscreen="true" style="width:100%; height:100%;">
        <div id="container" class="container"></div>
    </div>
    <div data-role="footer" data-position="fixed" data-fullscreen="true" class="footerBar">
        <div data-role="navbar">
            <ul>
                <li><a href="#chartYear" data-role="tab" class="ui-btn-active footer-button" data-transition="slideup" >Last Year</a></li>
                <li><a href="#chartMonth" data-role="tab" class="footer-button" data-transition="slideup">Last Month</a></li>
                <li><a href="#charWeek" data-role="tab" class="footer-button" data-transition="slideup">Last 7 Days</a></li>
            </ul>
        </div>
    </div>

</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-10T15:57:40.580

将类 'ui-state-persist' 添加到选定的选项卡可以完成这项工作：

```
<li><a href="#chartYear" data-role="tab" class="ui-btn-active footer-button ui-state-persist" data-transition="slideup" >Last Year</a></li> 
```

# android - 在尝试检索位置修复时等待“x”时间后如何切换提供商？

> ID：15297626
> 
> 赞同：1
> 
> 时间：2013-03-08T15:35:17.977
> 
> 标签：android, networking, gps, locationmanager, google-maps-android-api-2

我正在构建一个 GPS Android 应用程序，它可以根据用户的当前位置检索最近的地点。首先，我同时检测 GPS 和网络以查看它们是否已启用。如果两者都启用，我会首先使用 GPS，因为它是最准确的，并且对于我的应用程序来说，假设它们在外面是安全的，因此，检索 GPS 应该不会花费太长时间。然而，总有 GPS 需要很长时间的情况。因此，如果 GPS 接管（例如，2 分钟），我该如何实现切换到 NETWORK_PROVIDER 的方法？

这是我现在的代码：

我检查是否启用了 GPS 或互联网。

```
if(!GPSEnabled && !networkEnabled)
{
    Toast.makeText(this, "Error: This application requires a GPS or network connection",
            Toast.LENGTH_SHORT).show();
}
else
{
    if(GPSEnabled)
    {
        locManager.requestLocationUpdates(LocationManager.GPS_PROVIDER, 0, 0, this);
    }
    else if(networkEnabled)
    {
        System.out.println("Getting updates from network provider");
        locManager.requestLocationUpdates(LocationManager.NETWORK_PROVIDER, 0, 0, this);
    }
} 
```

这就是`onLocationChanged`方法。我得到 lat/lng 值，然后将它们发送到我的服务器，然后用它做适当的事情。

```
public void onLocationChanged(Location location)
{
    //Get coordinates
    double lat = (location.getLatitude());
    double lng = (location.getLongitude());
    Log.d("MainActivity", "got location: " + lat + ": " + lng);
    //get nearest locations
    new GetLocations().execute(SharedVariables.root + SharedVariables.locationsController + SharedVariables.getNearestMethod + lat + "/" + lng); 

    // Zoom in, animating the camera after the markers have been placed
    map.animateCamera(CameraUpdateFactory.newLatLngZoom(new LatLng(lat, lng), 10));
    System.out.println("lat = " + lat + ", lng = " + lng);

     //Stop listening for updates. We only want to do this once. 
     locManager.removeUpdates(this);
} 
```

如果任一时间太长，我需要添加什么才能切换到网络或 GPS？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:01:07.350

我建议同时使用这两个提供程序并使用例如本文中的 isBetterLocation() 函数确定更准确的位置：http: [//developer.android.com/guide/topics/location/strategies.html](http://developer.android.com/guide/topics/location/strategies.html)。在这种情况下，如果 GPS 速度较慢，用户无需等待 2 分钟即可使用您的应用。首先，您将使用网络更新，然后在获得 GPS 定位时，使用更准确的位置。

# android - Eclipse 的 Android 调试问题

> ID：15297628
> 
> 赞同：4
> 
> 时间：2013-03-08T15:35:21.647
> 
> 标签：android, eclipse, debugging

我知道这个问题之前已经发布过很多次，并且我已经搜索了几乎所有建议的解决方案，但是当我尝试通过 Eclipse 在我的 Android 手机上调试我的 Android 应用程序时，我仍然遇到问题。在设备上以发布模式运行可以正常工作，但是在尝试调试时我一直遇到以下错误：

> 无法为调试器绑定到本地 8700
> 
> 启动错误：无法连接到远程 VM。连接超时。

我尝试更改 DDMS 端口（例如 8600、8601、8602、8610、8700 等），在每次更改之间我关闭 Eclipse，结束 adb.exe，断开我的手机，然后重新启动 Eclipse。我已将超时时间延长至 15000。我已选择“使用 ADBHOST”。我已经禁用了我的 AVG 和防火墙。我已经从手机上卸载了 AVG。我已经重新启动了我的机器两次。我什至尝试查看 Windows 主机文件 (C:\Windows\System32\Hosts) 并检查本地主机是否设置为 127.0.0.1。似乎没有任何效果。

奇怪的是，几乎每 20 次，它就会成功连接并开始调试（我可以逐行逐步执行应用程序）。但是，如果我完成调试然后再次尝试调试而不更改任何内容，则会产生上述错误。

我的计算机运行的是 Windows 8 64 位，但我不认为这会是导致此问题的 Windows 8 错误。此外，我的 Android 手机是三星 Galaxy S3（也不要认为这会导致任何问题）。

请帮忙！:)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:42:25.430

这对我有用：

*   关闭 Eclipse。
*   移除 USB。
    *   转到任务管理器，然后删除所有“eclipse.exe”（在我的情况下，我有 4-5 个实例）。
    *   同时删除“adb.exe”。
    *   重新启动 Eclipse。
    *   重新连接 USB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-08T14:31:00.123

由于我安装了 AVG Antivirus，我遇到了同样的问题，您可以将其删除，调试器应该可以正常工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-02T17:42:34.047

问题肯定是 AVG .. 我最近升级到新版本，它破坏了调试.. 只要你卸载 AVG 它就可以工作..

尝试关闭 AVG 中的所有内容并禁用 20 分钟，但它仍然破坏了它..

# c# - 需要 OAuth 令牌的单元测试 API

> ID：15297631
> 
> 赞同：12
> 
> 时间：2013-03-08T15:35:37.347
> 
> 标签：c#, unit-testing, oauth, yahoo

我正在尝试编写一套自动化集成测试来测试我的 C# 客户端库对[Yahoo Fantasy Sports API](http://developer.yahoo.com/fantasysports/guide/)的调用。几个 API 调用需要 OAuth 令牌，这是我遇到的一些困难。我可以使用 Web 浏览器生成访问密钥和秘密，然后将它们传递到我的测试代码中，但是令牌会在一小时后过期，因此我需要在任何时候手动重新生成这些并更新我的测试配置运行测试。

当需要 OAuth 令牌时，是否有编写 API 集成测试的最佳实践？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-05-27T17:50:37.133

通常此类 api 提供了一种无需使用浏览器即可获取身份验证令牌的方法。我不确定雅虎体育是否是其中之一。

通常你必须创建一个应用程序来访问 OAuth2 系统，然后他们给你一个 ClientID 和 ClientSecret，然后你点击一个令牌 URL 并接收到一个小时有效的访问令牌。

不过，您可能要考虑根本不进行集成测试。如果我是你，我会简单地模拟 Api 响应并在你的测试中使用它。因此， gt 每个调用的响应样本，然后简单地创建一个假响应，只要您点击它就会返回该响应。然后你仍然可以运行你的测试。

您需要回答的问题是：我到底在测试什么？您是在测试第三方 API 还是想要测试自己的代码。

另外，不要忘记每个 api 允许在特定时间窗口内被点击特定次数。我想说的还有一个伪造它的理由

# javascript - 在 JavaScript 中将字符串转换为数组数组

> ID：15297633
> 
> 赞同：0
> 
> 时间：2013-03-08T15:35:41.823
> 
> 标签：javascript, arrays, string

我正在寻找最短的方法来转换一个字符串

```
"str1,str2,str3,..." 
```

进入数组数组，如：

```
[["str1"], ["str2"], ["str3"]] 
```

我可以使用循环或每个，但我想知道是否有更优雅的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:40:11.170

您可以像这样`split()`使用：`map()`

```
// This could be turned into 1 line but is split here for readibility 
var array = string.split(',');

array = array.map(function(value){
    return [value];
}); 
```

**注意：** `map()`并非在所有实现中都存在，请查看[本文](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map)以获取更多信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:41:52.790

如果您的目标是支持 ES5 的浏览器，您可以使用[Array.map](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/map)。

```
var array = "str1,str2,str3".split(",").map(function(token) {
     return [token]
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:41:34.493

[汤姆沃尔特的回答](https://stackoverflow.com/a/15297721/546661)很好，但如果你不想使用`map`：

```
var str = "str1,str2,str3";
var arr = str.split(",");
var arrOfarrs = [];
for(var i = 0; i < arr.length; i++) {
  arrOfarrs.push([arr[i]]);
} 
```

或者，您可以添加一个`map`polyfill 以添加对旧浏览器的支持：

```
Array.prototype.map = Array.prototype.map || function(fn) {
  var arr = [];
  for(var i = 0; i < this.length; i++) {
    arr.push(fn(this[i]));
  }
  return arr;
}; 
```

这将允许你做

```
var arr = str.split(",").map(function(val) {
  return [val];
}); 
```

# android - jQuery移动选择选项动态批量数据？

> ID：15297635
> 
> 赞同：1
> 
> 时间：2013-03-08T15:35:48.450
> 
> 标签：android, cordova, jquery-mobile

这是我想要添加的数据，但是当在 Android 中看到选择时的白屏显示时，问题是数据太大，如果它不在屏幕上，它会变成白屏，所以任何人都可以帮助我

```
 <label for="select-choice-min" style="margin-left:10px" class="select">Shipping method:</label> 
    <select name="select-choice-min" id="select-choice-min" data-native-menu="false" data-mini="true"> 
   <option value=""></option> 
                <option value="United States">United States</option> 
                <option value="United Kingdom">United Kingdom</option> 
                <option value="Afghanistan">Afghanistan</option> 
                <option value="Aland Islands">Aland Islands</option> 
                <option value="Albania">Albania</option> 
                <option value="Algeria">Algeria</option> 
                <option value="American Samoa">American Samoa</option> 
                <option value="Andorra">Andorra</option> 
                <option value="Angola">Angola</option> 
                <option value="Anguilla">Anguilla</option> 
                <option value="Antarctica">Antarctica</option> 
                <option value="Antigua and Barbuda">Antigua and Barbuda</option> 
                <option value="Argentina">Argentina</option> 
                <option value="Armenia">Armenia</option> 
                <option value="Aruba">Aruba</option> 
                <option value="Australia">Australia</option> 
                <option value="Austria">Austria</option> 
                <option value="Azerbaijan">Azerbaijan</option> 
                <option value="Bahamas">Bahamas</option> 
                <option value="Bahrain">Bahrain</option> 
                <option value="Bangladesh">Bangladesh</option> 
                <option value="Barbados">Barbados</option> 
                <option value="Belarus">Belarus</option> 
                <option value="Belgium">Belgium</option> 
                <option value="Belize">Belize</option> 
                <option value="Benin">Benin</option> 
                <option value="Bermuda">Bermuda</option> 
                <option value="Bhutan">Bhutan</option> 
                <option value="Bolivia, Plurinational State of">Bolivia, Plurinational State of</option> 
                <option value="Bonaire, Sint Eustatius and Saba">Bonaire, Sint Eustatius and Saba</option> 
                <option value="Bosnia and Herzegovina">Bosnia and Herzegovina</option> 
                <option value="Botswana">Botswana</option> 
                <option value="Bouvet Island">Bouvet Island</option> 
                <option value="Brazil">Brazil</option> 
                <option value="British Indian Ocean Territory">British Indian Ocean Territory</option> 
                <option value="Brunei Darussalam">Brunei Darussalam</option> 
                <option value="Bulgaria">Bulgaria</option> 
                <option value="Burkina Faso">Burkina Faso</option> 
                <option value="Burundi">Burundi</option> 
                <option value="Cambodia">Cambodia</option> 
                <option value="Cameroon">Cameroon</option> 
                <option value="Canada">Canada</option> 
                <option value="Cape Verde">Cape Verde</option> 
                <option value="Cayman Islands">Cayman Islands</option> 
                <option value="Central African Republic">Central African Republic</option> 
                <option value="Chad">Chad</option> 
                <option value="Chile">Chile</option> 
                <option value="China">China</option> 
                <option value="Christmas Island">Christmas Island</option> 
                <option value="Cocos (Keeling) Islands">Cocos (Keeling) Islands</option> 
                <option value="Colombia">Colombia</option> 
                <option value="Comoros">Comoros</option> 
                <option value="Congo">Congo</option> 
                <option value="Congo, The Democratic Republic of The">Congo, The Democratic Republic of The</option> 
                <option value="Cook Islands">Cook Islands</option> 
                <option value="Costa Rica">Costa Rica</option> 
                <option value="Cote D'ivoire">Cote D'ivoire</option> 
                <option value="Croatia">Croatia</option> 
                <option value="Cuba">Cuba</option> 
                <option value="Curacao">Curacao</option> 
                <option value="Cyprus">Cyprus</option> 
                <option value="Czech Republic">Czech Republic</option> 
                <option value="Denmark">Denmark</option> 
                <option value="Djibouti">Djibouti</option> 
                <option value="Dominica">Dominica</option> 
                <option value="Dominican Republic">Dominican Republic</option> 
                <option value="Ecuador">Ecuador</option> 
                <option value="Egypt">Egypt</option> 
                <option value="El Salvador">El Salvador</option> 
                <option value="Equatorial Guinea">Equatorial Guinea</option> 
                <option value="Eritrea">Eritrea</option> 
                <option value="Estonia">Estonia</option> 
                <option value="Ethiopia">Ethiopia</option> 
                <option value="Falkland Islands (Malvinas)">Falkland Islands (Malvinas)</option> 
                <option value="Faroe Islands">Faroe Islands</option> 
                <option value="Fiji">Fiji</option> 
                <option value="Finland">Finland</option> 
                <option value="France">France</option> 
                <option value="French Guiana">French Guiana</option> 
                <option value="French Polynesia">French Polynesia</option> 
                <option value="French Southern Territories">French Southern Territories</option> 
                <option value="Gabon">Gabon</option> 
                <option value="Gambia">Gambia</option> 
                <option value="Georgia">Georgia</option> 
                <option value="Germany">Germany</option> 
                <option value="Ghana">Ghana</option> 
                <option value="Gibraltar">Gibraltar</option> 
                <option value="Greece">Greece</option> 
                <option value="Greenland">Greenland</option> 
                <option value="Grenada">Grenada</option> 
                <option value="Guadeloupe">Guadeloupe</option> 
                <option value="Guam">Guam</option> 
                <option value="Guatemala">Guatemala</option> 
                <option value="Guernsey">Guernsey</option> 
                <option value="Guinea">Guinea</option> 
                <option value="Guinea-bissau">Guinea-bissau</option> 
                <option value="Guyana">Guyana</option> 
                <option value="Haiti">Haiti</option> 
                <option value="Heard Island and Mcdonald Islands">Heard Island and Mcdonald Islands</option> 
                <option value="Holy See (Vatican City State)">Holy See (Vatican City State)</option> 
                <option value="Honduras">Honduras</option> 
                <option value="Hong Kong">Hong Kong</option> 
                <option value="Hungary">Hungary</option> 
                <option value="Iceland">Iceland</option> 
                <option value="India">India</option> 
                <option value="Indonesia">Indonesia</option> 
                <option value="Iran, Islamic Republic of">Iran, Islamic Republic of</option> 
                <option value="Iraq">Iraq</option> 
                <option value="Ireland">Ireland</option> 
                <option value="Isle of Man">Isle of Man</option> 
                <option value="Israel">Israel</option> 
                <option value="Italy">Italy</option> 
                <option value="Jamaica">Jamaica</option> 
                <option value="Japan">Japan</option> 
                <option value="Jersey">Jersey</option> 
                <option value="Jordan">Jordan</option> 
                <option value="Kazakhstan">Kazakhstan</option> 
                <option value="Kenya">Kenya</option> 
                <option value="Kiribati">Kiribati</option> 
                <option value="Korea, Democratic People's Republic of">Korea, Democratic People's Republic of</option> 
                <option value="Korea, Republic of">Korea, Republic of</option> 
                <option value="Kuwait">Kuwait</option> 
                <option value="Kyrgyzstan">Kyrgyzstan</option> 
                <option value="Lao People's Democratic Republic">Lao People's Democratic Republic</option> 
                <option value="Latvia">Latvia</option> 
                <option value="Lebanon">Lebanon</option> 
                <option value="Lesotho">Lesotho</option> 
                <option value="Liberia">Liberia</option> 
                <option value="Libya">Libya</option> 
                <option value="Liechtenstein">Liechtenstein</option> 
                <option value="Lithuania">Lithuania</option> 
                <option value="Luxembourg">Luxembourg</option> 
                <option value="Macao">Macao</option> 
                <option value="Macedonia, The Former Yugoslav Republic of">Macedonia, The Former Yugoslav Republic of</option> 
                <option value="Madagascar">Madagascar</option> 
                <option value="Malawi">Malawi</option> 
                <option value="Malaysia">Malaysia</option> 
                <option value="Maldives">Maldives</option> 
                <option value="Mali">Mali</option> 
                <option value="Malta">Malta</option> 
                <option value="Marshall Islands">Marshall Islands</option> 
                <option value="Martinique">Martinique</option> 
                <option value="Mauritania">Mauritania</option> 
                <option value="Mauritius">Mauritius</option> 
                <option value="Mayotte">Mayotte</option> 
                <option value="Mexico">Mexico</option> 
                <option value="Micronesia, Federated States of">Micronesia, Federated States of</option> 
                <option value="Moldova, Republic of">Moldova, Republic of</option> 
                <option value="Monaco">Monaco</option> 
                <option value="Mongolia">Mongolia</option> 
                <option value="Montenegro">Montenegro</option>
                <option value="Montserrat">Montserrat</option> 
                <option value="Morocco">Morocco</option> 
                <option value="Mozambique">Mozambique</option> 
                <option value="Myanmar">Myanmar</option> 
                <option value="Namibia">Namibia</option> 
                <option value="Nauru">Nauru</option> 
                <option value="Nepal">Nepal</option> 
                <option value="Netherlands">Netherlands</option> 
                <option value="New Caledonia">New Caledonia</option> 
                <option value="New Zealand">New Zealand</option> 
                <option value="Nicaragua">Nicaragua</option> 
                <option value="Niger">Niger</option> 
                <option value="Nigeria">Nigeria</option> 
                <option value="Niue">Niue</option> 
                <option value="Norfolk Island">Norfolk Island</option> 
                <option value="Northern Mariana Islands">Northern Mariana Islands</option> 
                <option value="Norway">Norway</option> 
                <option value="Oman">Oman</option> 
                <option value="Pakistan">Pakistan</option> 
                <option value="Palau">Palau</option> 
                <option value="Palestinian Territory, Occupied">Palestinian Territory, Occupied</option> 
                <option value="Panama">Panama</option> 
                <option value="Papua New Guinea">Papua New Guinea</option> 
                <option value="Paraguay">Paraguay</option> 
                <option value="Peru">Peru</option> 
                <option value="Philippines">Philippines</option> 
                <option value="Pitcairn">Pitcairn</option> 
                <option value="Poland">Poland</option> 
                <option value="Portugal">Portugal</option> 
                <option value="Puerto Rico">Puerto Rico</option> 
                <option value="Qatar">Qatar</option> 
                <option value="Reunion">Reunion</option> 
                <option value="Romania">Romania</option> 
                <option value="Russian Federation">Russian Federation</option> 
                <option value="Rwanda">Rwanda</option> 
                <option value="Saint Barthelemy">Saint Barthelemy</option> 
                <option value="Saint Helena, Ascension and Tristan da Cunha">Saint Helena, Ascension and Tristan da Cunha</option> 
                <option value="Saint Kitts and Nevis">Saint Kitts and Nevis</option> 
                <option value="Saint Lucia">Saint Lucia</option> 
                <option value="Saint Martin (French part)">Saint Martin (French part)</option> 
                <option value="Saint Pierre and Miquelon">Saint Pierre and Miquelon</option> 
                <option value="Saint Vincent and The Grenadines">Saint Vincent and The Grenadines</option> 
                <option value="Samoa">Samoa</option> 
                <option value="San Marino">San Marino</option> 
                <option value="Sao Tome and Principe">Sao Tome and Principe</option> 
                <option value="Saudi Arabia">Saudi Arabia</option> 
                <option value="Senegal">Senegal</option> 
                <option value="Serbia">Serbia</option> 
                <option value="Seychelles">Seychelles</option> 
                <option value="Sierra Leone">Sierra Leone</option> 
                <option value="Singapore">Singapore</option> 
                <option value="Sint Maarten (Dutch part)">Sint Maarten (Dutch part)</option> 
                <option value="Slovakia">Slovakia</option> 
                <option value="Slovenia">Slovenia</option> 
                <option value="Solomon Islands">Solomon Islands</option> 
                <option value="Somalia">Somalia</option> 
                <option value="South Africa">South Africa</option> 
                <option value="South Georgia and The South Sandwich Islands">South Georgia and The South Sandwich Islands</option> 
                <option value="South Sudan">South Sudan</option> 
                <option value="Spain">Spain</option> 
                <option value="Sri Lanka">Sri Lanka</option> 
                <option value="Sudan">Sudan</option> 
                <option value="Suriname">Suriname</option> 
                <option value="Svalbard and Jan Mayen">Svalbard and Jan Mayen</option> 
                <option value="Swaziland">Swaziland</option> 
                <option value="Sweden">Sweden</option> 
                <option value="Switzerland">Switzerland</option> 
                <option value="Syrian Arab Republic">Syrian Arab Republic</option> 
                <option value="Taiwan, Province of China">Taiwan, Province of China</option> 
                <option value="Tajikistan">Tajikistan</option> 
                <option value="Tanzania, United Republic of">Tanzania, United Republic of</option> 
                <option value="Thailand">Thailand</option> 
                <option value="Timor-leste">Timor-leste</option> 
                <option value="Togo">Togo</option> 
                <option value="Tokelau">Tokelau</option> 
                <option value="Tonga">Tonga</option> 
                <option value="Trinidad and Tobago">Trinidad and Tobago</option> 
                <option value="Tunisia">Tunisia</option> 
                <option value="Turkey">Turkey</option> 
                <option value="Turkmenistan">Turkmenistan</option> 
                <option value="Turks and Caicos Islands">Turks and Caicos Islands</option> 
                <option value="Tuvalu">Tuvalu</option> 
                <option value="Uganda">Uganda</option> 
                <option value="Ukraine">Ukraine</option> 
                <option value="United Arab Emirates">United Arab Emirates</option> 
                <option value="United Kingdom">United Kingdom</option> 
                <option value="United States">United States</option> 
                <option value="United States Minor Outlying Islands">United States Minor Outlying Islands</option> 
                <option value="Uruguay">Uruguay</option> 
                <option value="Uzbekistan">Uzbekistan</option> 
                <option value="Vanuatu">Vanuatu</option> 
                <option value="Venezuela, Bolivarian Republic of">Venezuela, Bolivarian Republic of</option> 
                <option value="Viet Nam">Viet Nam</option> 
                <option value="Virgin Islands, British">Virgin Islands, British</option> 
                <option value="Virgin Islands, U.S.">Virgin Islands, U.S.</option> 
                <option value="Wallis and Futuna">Wallis and Futuna</option> 
                <option value="Western Sahara">Western Sahara</option> 
                <option value="Yemen">Yemen</option> 
                <option value="Zambia">Zambia</option> 
                <option value="Zimbabwe">Zimbabwe</option>
    </select> 
```

这是动态应用到 div 的数据，但数据太长，Android 手机和模拟器中也出现白屏，所以任何人都可以帮助解决这个问题 :(

# math - 将长方形切成2块

> ID：15297638
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:35:52.453
> 
> 标签：math, polygon

假设您必须覆盖一个 2 英尺宽和 12 英尺长的开口。你所拥有的只是一张 3 英尺宽、8 英尺长的胶合板。你怎么能把床单切成两块，完美地盖住洞？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:52:50.367

```
OOOOXXXXXXXX
OOOOOOOOXXXX

xxxxxxxx
ooooxxxx
oooooooo 
```

这会做到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:48:06.093

因此，如果您查看这些区域，它们是相同的。你能做的就是砍掉一只脚，所以你有一个 1'x8' 和 2'x8' 的部分。然后你把较小的一块切成两半，你有三块，两块 1'x4' 和一个 2'x8'。找到一种方法来支撑它，你就完成了。

# jquery - 在悬停时更改导航文本而不是更改回原始文本

> ID：15297639
> 
> 赞同：0
> 
> 时间：2013-03-08T15:35:55.553
> 
> 标签：jquery, cufon

我正在使用 cufon，我试图弄清楚如何更改导航文本`hover/mouse over`然后更改回原始文本`mouse out/hover off`。现在，当我将鼠标悬停在我希望文本更改的导航选项卡上时，它会更改但不会更改回原始文本、颜色或字体。

这是我的小提琴的链接：http: [//jsfiddle.net/jsavage/4fPw6/](http://jsfiddle.net/jsavage/4fPw6/)

基本上，当用户悬停或鼠标悬停时，我需要导航中的“下降”更改为“即将推出”，当用户悬停或鼠标悬停时，文本将变回“下降”

任何帮助将不胜感激！非常感谢你们！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:54:59.743

有一种[仅使用 CSS](http://jsfiddle.net/4fPw6/3/)的方法（虽然有点 hacky）：

```
.fall:hover:before {
    content: 'coming soon';
    font-size: 0.875em;
    color: #fff;
    text-transform:uppercase;
}
.fall:hover a {
    display: none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:56:42.230

首先，您的脚本标签应该在 HTML 中，并且您需要包含 JQuery 以使用它的功能。

您还修改了`.fall`li 元素且不包含任何文本的文本。您必须定位`<a>`其中包含要修改的文本的标签。

这[是小提琴](http://jsfiddle.net/jsavage/4fPw6/)

# c++ - 函数原型和函数实现签名可以不一致地使用 const 吗？

> ID：15297644
> 
> 赞同：9
> 
> 时间：2013-03-08T15:36:18.657
> 
> 标签：c++, c, header, constants, function-prototypes

我喜欢尽可能声明偶数值参数`const`，通过搜索 SO，我发现这[并不少见](https://stackoverflow.com/questions/117293/use-of-const-for-function-parameters)。像这样：

```
int add(const int a, const int b)
{
    ...
} 
```

但我想知道：`const`因为**值**是我的函数的实现细节，而不是它的接口的一部分。所以把它放到原型中似乎没有必要。

上述函数的这个原型似乎工作得很好：

```
int add(int a, int b); 
```

然而，我听说过一些问题，例如将 main 函数的 argc 声明为 const 会导致问题：

```
int main(const int argc, const char* const argv[]) 
```

那么这是否意味着`int add(int a, int b)`并且`int add(const int a, const int b)`毕竟不相同？

如果技术上没问题，那是我应该做的吗？我也可以在原型中省略变量名，但我没有，所以也许我也不应该省略`const`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-08T15:39:10.040

*函数类型*不同是不行的，但是你需要知道什么是函数类型的一部分，什么不是。在您的情况下，`const`for 参数并不重要，因此函数类型是相同的，尽管*声明*看起来与*定义*不同。

在你的情况下

> ### 8.3.5 函数[dcl.fct]
> 
> ⁵一个名称可用于单个范围内的多个不同功能；这是函数重载（第 13 条）。函数的所有声明都应在返回类型和参数类型列表中完全一致。使用以下规则确定函数的类型。每个参数的类型（包括函数参数包）由其自己的 decl-specifier-seq 和声明符确定。在确定每个参数的类型后，将“T的数组”或“返回T的函数”类型的任何参数分别调整为“指向T的指针”或“返回T的函数的指针”。在生成参数类型列表后，任何修改参数类型的顶级 cv 限定符都会在形成函数类型时被删除。转换后的参数类型的结果列表以及省略号或函数参数包的存在与否是函数的参数类型列表。[ 注意：此转换不影响参数的类型。例如，`int(*)(const int p, decltype(p)*)`并且`int(*)(int, const int*)`是相同的类型。——尾注]

看起来，它需要一些解释，所以我们开始吧： 在我们的例子中，重要的一句话是：*在生成参数类型列表之后，在形成函数类型时，任何修改参数类型的顶级 cv 限定符都将被删除。*

这意味着所有*顶级*cv 限定符都被删除。为了解释顶级的含义，我将以非法的方式编写类型来强调 a`const`所指的内容：

*   `const int`= `(const (int))`-> 这是顶级的`const`
*   `const int*`= `((const (int))*)`-> 不是顶级，是二级
*   `const int* const`= `(((const (int))*) const)`-> 第二个`const`在顶层
*   `const int&`= `((const (int))&)`-> 不是顶级的

我希望这能消除对函数类型的一些误解。

对于您的其他问题：我建议保持声明和定义相同，因为它可能会使人们感到困惑（就像这个问题所证明的那样；）。

对于`main`您给出的示例：

```
int main( const int argc, const char* const argv[] ) 
```

是，根据标准的上述引用，相当于：

```
int main( int argc, const char* const* argv ) 
```

因此添加`const`的 for`argv`最终不会作为顶层`const`被删除，因此它是一个格式错误的函数类型 for `main`，它期望：

```
int main( int argc, char** argv ) 
```

关于省略参数名称的最后一个问题：我不会这样做，因为对我来说，它们是函数*文档的一部分。*它们传达函数的意图和语义（如果您明智地选择它们）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T17:00:57.987

`const`在函数的声明和定义之间为函数参数设置不同的顶层应该是可以的，但请注意，并非所有编译器都没有错误。例如，Oracle Sun 编译器有一个[长期存在的问题](http://docs.oracle.com/cd/E24457_01/html/E21987/glnzd.html#gkgak)，即它的错误`int f(int)`和`int f(const int)`不同之处。

为了避免您真正打算通过`const`引用传递的任何混淆的可能性，我通常建议避免在公共函数声明中使用顶层`const`，并为了避免可能的编译器问题，我也会在函数定义中避免它。

（请注意，在参数列表中更改`char **`为`const char* const argv[]`不是添加顶级常量，而是真正的签名更改。`char**`仅相当于`char** const`在函数参数列表中。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T15:39:17.850

> const for values 是我的函数的实现细节，而不是它的接口的一部分。

这就是你的想法的缺陷，当谈论引用和指针 `const`与接口有关的一切时，它告诉使用接口的程序员你传递的内容不会被函数改变。它告诉编译器同样的事情，并将程序员绑定到这个合约。

带参数的函数和不带`const`参数的`const`函数是不同的。

*但是，按值传递将复制参数，在这种情况下更改它们不是问题。* 你`int`的 s 是按值传递的，这`const`不会有太大的区别。

但是，我个人认为这不是滥用接口不一致的原因，并且使接口在一个地方与另一个地方不同。

虽然通过 ref 传递，但 ref to`const`与 ref to non- 完全不同`const`。

# android - gridview 中的图像在滚动时被替换

> ID：15297645
> 
> 赞同：0
> 
> 时间：2013-03-08T15:36:20.400
> 
> 标签：android, android-gridview

我已经编码以在 gridview 中显示一些图像。图片是从网址显示的。我面临的问题是，当我滚动时图像会被替换。一旦开始，图像的顺序就会不断变化。如果我单击网格中的任何图像，这会导致完整图像的显示延迟。请帮忙！

**代码 ：**

```
public class ImageAdapter extends BaseAdapter {

    private Context mContext;
    private TextView txtUrl;
    private String response;
    public ImageView imageView;
    public static String[] mThumbIds;
    public ImageAdapter(Context c,String resp) {
        mContext = c;
        response = resp.trim();
        mThumbIds = resp.split(",");
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    // create a new ImageView for each item referenced by the Adapter
    public View getView(int position, View convertView, ViewGroup parent) {

        if (convertView == null) {  // if it's not recycled, initialize some attributes
            imageView = new ImageView(mContext);
            imageView.setLayoutParams(new GridView.LayoutParams(95, 95));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(6, 6, 6, 6);
        } else {
            imageView = (ImageView) convertView;
        }

        try {
             new LoadImageGrid(imageView).execute(mThumbIds[position]);

        } catch(Exception e) {
            txtUrl.setText("Error: Exception");
        }

        return imageView;

    }

class LoadImageGrid extends AsyncTask<String, Void, Drawable>
{

    ImageView imageView;
    public LoadImageGrid(ImageView im){
        imageView = im;
    }
    @Override
    protected Drawable doInBackground(String... args) {
        String url = args[0];
        Drawable d = null;
        try {
            d = Drawable.createFromStream((InputStream) new URL(url).getContent(), "src");
        } catch (MalformedURLException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        return d;

    }

    @Override
    protected void onPostExecute(Drawable d) {
        imageView.setImageDrawable(d);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:38:12.010

当您滚动网格视图时，不可见的图像视图将作为 convertView 参数返回到 getView()。但是您的 asyncTask 并没有停止，而是调用

```
imageView.setImageDrawable(d); 
```

导致将下载的图像应用于错误位置的视图。因为现在你重用了相同的 imageView。快速修复是不使用 convertView。但这会稍微减慢您的应用程序的速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:33:15.560

这似乎与转换视图有关。当您使用转换视图重用图像空间时，您应该在该范围内使用 Imageview。我建议在你当前的类代码中通过它的 id 找到 imageview，然后填充它。

# javascript - 下拉 JavaScript onClick 事件未在 Chrome/IE 中触发

> ID：15297649
> 
> 赞同：-2
> 
> 时间：2013-03-08T15:36:28.680
> 
> 标签：javascript, html, google-chrome

这在 chrome 和 IE 中不起作用。我不太擅长 Javascripting，所以我不知道要寻找什么。那么我能做些什么来完成这项工作呢？我在这里搜索以找到一些解决方案，但没有运气。

Javascript代码：

```
function show(id) {
    var element = document.getElementById(id);
    element.style.display = "";
}

function hide(id) {
    var element = document.getElementById(id);
    element.style.display  = "none";
}

function hideAll() {
    hide('child1');
    hide('child2');
    hide('child3');
    hide('child4');
    hide('child5');
} 
```

HTML 代码

```
 <select name="parent" id="parent">
<option value="0" selected>Please choose</option>
<option value="1" onclick="hideAll(); show('child1');">Parent 1</option>
<option value="2" onclick="hideAll(); show('child2');">Parent 2</option>
<option value="3" onclick="hideAll(); show('child3');">Parent 3</option>
<option value="4" onclick="hideAll(); show('child4');">Parent 4</option>
<option value="5" onclick="hideAll(); show('child5');">Parent 5</option>
</select>
</p>
<select name="child1" id="child1" style="display:none">
<option value="1">Child1 - 1</option>
<option value="2">Child1 - 2</option>
<option value="3">Child1 - 3</option>
<option value="4">Child1 - 4</option>
<option value="5">Child1 - 5</option>
</select>
<select name="child2" id="child2" style="display:none">
<option value="1">Child2 - 1</option>
<option value="2">Child2 - 2</option>
<option value="3">Child2 - 3</option>
<option value="4">Child2 - 4</option>
<option value="5">Child2 - 5</option>
</select>
<select name="child3" id="child3" style="display:none">
<option value="1">Child3 - 1</option>
<option value="2">Child3 - 2</option>
<option value="3">Child3 - 3</option>
<option value="4">Child3 - 4</option>
<option value="5">Child3 - 5</option>
</select>
<select name="child4" id="child4" style="display:none">
<option value="1">Child4 - 1</option>
<option value="2">Child4 - 2</option>
<option value="3">Child4 - 3</option>
<option value="4">Child4 - 4</option>
<option value="5">Child4 - 5</option>
</select>
<select name="child5" id="child5" style="display:none">
<option value="1">Child5 - 1</option>
<option value="2">Child5 - 2</option>
<option value="3">Child5 - 3</option>
<option value="4">Child5 - 4</option>
<option value="5">Child5 - 5</option>
</select> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:44:00.630

您需要使用 onchange 而不是 onclick

这是一个完整的解决方案，它不关心 IDS 是什么，只要父选择的值与要隐藏和显示的选择的 ID 匹配

[演示](http://jsfiddle.net/mplungjan/pg6Lp)

```
window.onload=function() {
  document.getElementById("disc").onchange=function() {
    hideAll(this); 
    var id = this.value;
    if (id) show(id);
  }
}

function show(id) {
    var el = document.getElementById(id);
    if (el) el.style.display = "block";
    else alert("No such ID as "+id);
}

function hide(id) {
    var el = document.getElementById(id);
    el.style.display  = "none";
}

function hideAll(sel) {
  var allSels=document.getElementsByTagName("select");
  for (var i=0;i<allSels.length;i++) {
      if (allSels[i]!=sel) {
          console.log(allSels[i].id)
          allSels[i].style.display='none';
      }    
  }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:38:28.070

试试这个

```
 <select name="parent" id="parent" onChange="showHide(this.id)">

      function showHide(id)
     {
        hideAll();
       var elementId = document.getElementById(id).value ;
       document.getElementById("child"+elementId).style.display= "block";

     } 
```

# java - 从 ASyncResult 获取状态

> ID：15297651
> 
> 赞同：0
> 
> 时间：2013-03-08T15:36:33.797
> 
> 标签：java, junit, playframework-2.0, functional-testing

无论如何，我可以从中提取`status`吗`AsyncResult`？我正在编写一个功能测试，以确保所有`routes`的工作都需要输出`status`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T19:14:15.833

[您可以使用转换](http://www.playframework.com/documentation/api/2.1.0/scala/index.html#play.api.mvc.AsyncResult)方法检查状态（但不返回）：

```
Async {
  concurrent.future(Ok("ok"))
} transform { result =>
  println(result.header.status)
  result
} 
```

# ios - 如何在 imagePickerController 中获取 Imageview 标签以更新正确的 ImageView

> ID：15297652
> 
> 赞同：0
> 
> 时间：2013-03-08T15:36:36.170
> 
> 标签：ios, uiimagepickercontroller, uiactionsheet

我有 6 个带有标签的图像视图。在图像视图上单击一下，我调用 UIActionSheet 以显示按钮“拍照”和“选择图片”。这一切都很好。在我最终设置所选图像的 imagePickerController 中，我如何知道要更新图片的 Imageview。请让我知道如何传递我的标签值来更新正确的点击图像。

这是我的代码。

viewDidLoad

```
UITapGestureRecognizer *tapGestureRecognizer = [[UITapGestureRecognizer alloc]
                                             initWithTarget:self
                                             action:@selector(tappedImage:)];

tapGestureRecognizer.numberOfTapsRequired = 1;
[self.photo1 addGestureRecognizer:tapGestureRecognizer];
[self.photo2 addGestureRecognizer:tapGestureRecognizer];
[self.photo3 addGestureRecognizer:tapGestureRecognizer];
[tapGestureRecognizer setDelegate:self]; 
```

轻拍图像

```
- (void)tappedImage:(UIGestureRecognizer *)sender {
{

    UIActionSheet *actionSheet = [[UIActionSheet alloc]
                              initWithTitle:@"Add a Picture"
                              delegate:self
                              cancelButtonTitle:@"Cancel"
                              destructiveButtonTitle:nil
                              otherButtonTitles:@"Take Picture",@"Select Picture", nil];
            [actionSheet showInView:self.view];

} 
```

}

图像选择器控制器

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo {
[picker dismissModalViewControllerAnimated:YES];
[photo1 setImage:image]; 
```

}

目前所有图像都设置为 Photo1 Imageview。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:46:12.707

将实例变量添加到您的类以存储所选图像。然后在你的`tappedImage:`方法中你这样做：

```
_selectedImage = (UIImageView *)sender.view; 
```

`_selectedImage`您的实例变量类型在哪里`UIImageView *`。

然后在该`imagePickerController`方法中，您可以执行以下操作：

```
- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingImage:(UIImage *)image editingInfo:(NSDictionary *)editingInfo {
    [picker dismissModalViewControllerAnimated:YES];
    [_selectedImage setImage:image];
} 
```

# iphone - 在 iphone 中使用 UICollectionView

> ID：15297658
> 
> 赞同：1
> 
> 时间：2013-03-08T15:36:59.460
> 
> 标签：iphone, objective-c, cocoa-touch

我有一个包含 10 个条目的数组。我想在 UICollectionView 上将它们显示为每行 3 个，这样它们就会像

```
A B C
D E F
G H I
J 
```

现在我正在使用以下代码

```
#pragma mark - UICollectionView Datasource

- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath
{

}

- (NSInteger)collectionView:(UICollectionView *)view numberOfItemsInSection:(NSInteger)section
{
    return 3;
}

- (NSInteger)numberOfSectionsInCollectionView: (UICollectionView *)collectionView
{
    return [self.btnArray count];
}

- (UICollectionViewCell *)collectionView:(UICollectionView *)cv cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
     UICollectionViewCell *cell = [cv dequeueReusableCellWithReuseIdentifier:@"Cell" forIndexPath:indexPath];

    Buttons *btn = [self.btnArray objectAtIndex:(indexPath.section * indexPath.row)];
    NSURL* aURL = [NSURL URLWithString:btn.imagePath];
    NSData* data = [[NSData alloc] initWithContentsOfURL:aURL];

    cell.backgroundColor = [UIColor colorWithPatternImage:[UIImage imageWithData:data]];
    return cell;
}

#pragma mark – UICollectionViewDelegateFlowLayout

// 1
- (CGSize)collectionView:(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout sizeForItemAtIndexPath:(NSIndexPath *)indexPath
{
    CGSize retval =  CGSizeMake(75, 75);
    return retval;
}

// 3
- (UIEdgeInsets)collectionView:
(UICollectionView *)collectionView layout:(UICollectionViewLayout*)collectionViewLayout insetForSectionAtIndex:(NSInteger)section
{
    return UIEdgeInsetsMake(50, 20, 50, 20);
} 
```

但是当我打

```
 UICollectionViewCell *cell = [cv dequeueReusableCellWithReuseIdentifier:@"Cell" forIndexPath:indexPath]; 
```

它给了我错误

```
NSInternalInconsistencyException', reason: 'could not dequeue a view of kind: UICollectionElementKindCell with identifier Cell - must register a nib or a class for the identifier or connect a prototype cell in a storyboard' 
```

怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:50:10.267

正如错误所说，您需要为具有该标识符的单元格注册一个 nib 或类。设置视图时执行一次。

请参阅 UICollectionView 文档了解这两种方法：

```
– registerClass:forCellWithReuseIdentifier:
– registerNib:forCellWithReuseIdentifier: 
```

# java - 在 OSGi 中，传递服务引用是一种好的做法，还是应该由包自己查找？

> ID：15297661
> 
> 赞同：1
> 
> 时间：2013-03-08T15:37:13.580
> 
> 标签：java, service, osgi, bundle, blueprint-osgi

我有这些捆绑：

*   **Comm Service**提供通信服务。
*   **通信**是使用`Comm Service`发送/接收消息的通信包。
*   **Poll**以多播模式发送轮询消息。

捆绑包已经饱和，我的`Communication`方法是为特定操作实现其他捆绑包——*投票*捆绑包将负责发送民意调查，*明信片*捆绑包用于发送明信片等（只是一些示例）。

当捆绑需要委派其发送投票/明信片/消息的工作时，是否将`Comm Service`服务作为输入参数传递给捆绑？`Poll``Communication`

下面的片段是否正确？

*通讯包代码*：

```
PollBundle p = new PollBundleImpl();
p.sendPoll(String pollQuestion, CommService cs); 
```

还是让`Poll`/捆绑包自行`Postcard`检索服务的更好方法？`Comm Service`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-08T20:04:25.793

**不得**在包之间传递服务对象；如果您这样做，那么 OSGi 框架将失去对哪些捆绑包具有服务可见性的控制，因此它无法在该服务需要离开时通知全套捆绑包。

因此，轮询包必须为自己找到 CommService。有很多方法可以做到这一点。我强烈建议使用OSGi 规范中的**声明式服务**。与[bnd 注释](http://www.aqute.biz/Bnd/Components)结合使用，您将能够编写 Poll 包的代码，如下所示：

```
@Component
public class Polling {

    private CommService commService;

    @Reference
    public void setCommService(CommService cs) {
        this.commService = cs;
    }

    public void someMethodThatUsesCommService() {
         sendPoll(cs);
         // ...
    }
} 
```

我推荐这种方法而不是 Jacek Laskowski 在他的回答中描述的 Blueprint 解决方案，因为它不需要编写冗长且非类型安全的 XML 文件，并且它具有与 OSGi 服务的生命周期相匹配的更好的生命周期特征。然而，Declarative Services 和 Blueprint 方法肯定比使用低级 OSGi API（例如`ServiceTracker`）更安全`ServiceListener`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T17:54:33.960

我强烈建议利用[依赖注入](http://en.wikipedia.org/wiki/Dependency_injection)来解耦捆绑包`OSGi Blueprint`（请参阅[OSGi Service Platform Enterprise Specification](http://www.osgi.org/Download/Release5)中的**Blueprint Container Specification**，但请注意它适用于 V5 版本）。

使用规范，您可以使用单独的 xml 文件声明捆绑包的依赖关系 - `OSGI-INF/blueprint/*.xml`（默认设置，但可以使用`Bundle-Blueprint`标头更改）。

因此，在您的情况下，您将开发`Comm Service`其服务是该捆绑包的依赖项的`Communication`捆绑包。还有`Poll`可能`Postcard`注册服务的同一服务接口的捆绑包，以便它们可以成为`Communication`捆绑包的依赖项。

在这样的配置中，`Communication`传递`Comm Service`捆绑/服务的不是捆绑，而是在初始化期间`Poll`和`Postcard`捆绑获得它们的`Comm Service`服务依赖关系。

这是捆绑包的假设蓝图配置`Poll`。

```
<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">
  <bean id="PollSenderBean" class="pl.japila.osgi.poll.PollSender">
    <argument ref="commService" />
  </bean>
  <service id="PollSenderBeanService" ref="PollSenderBean" 
           interface="pl.japila.osgi.Sender">
    <service-properties>
      <entry key="type" value="poll" />
    </service-properties>
  </service>
  <reference id="commService" interface="pl.japila.osgi.comm.CommService" />
</blueprint> 
```

捆绑包将`Postcard`是相似的。请注意 的`entry`值，`poll`以便在需要此类查询时获得特定服务。

捆绑包的蓝图配置`Communication`如下：

```
<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">
  <reference-list activation="lazy" member-type="service-object"
                  id="Sender" interface="pl.japila.osgi.Sender" />
</blueprint> 
```

参考规范，也许还有[Apache Aries Blueprint 模块](http://aries.apache.org/modules/blueprint.html)来学习和学习解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T16:56:15.557

除非你需要`CommService`在不同的调用中使用不同的`p.sendPoll(String pollQuestion..)`我会说，让我们自己`PollBundle`找到`CommService`。

基本上这减少了耦合。您只需要知道`PollBundle`发送投票。这实际上取决于您的架构，但总的来说，您需要移动的对象越少，接口越简单越好。

# c# - 使用 ORM 仅检索一些列

> ID：15297667
> 
> 赞同：1
> 
> 时间：2013-03-08T15:37:27.620
> 
> 标签：c#, .net, entity-framework

我将[实体框架](http://msdn.microsoft.com/en-us/data/ef.aspx)和 SQL Server 2008 与[数据库优先](http://msdn.microsoft.com/en-us/data/jj206878)方法一起使用。

我的问题是：

我有一些包含很多列（~100）的表，当我尝试检索很多行时，它需要很长时间才能返回结果，即使有时我只需要使用该表中的 3 或 4 列.

我在 Stackoverflow 中度过了半天，试图找到解决这个问题的方法，我想出了两个解决方案：

*   使用存储过程检索包含我想要的列的数据。
*   编辑 .edmx (xml) 和 .cs 文件以删除我不会使用的列。

我的问题又是：

*   如果我使用存储过程来检索包含我想要的列的数据，Entity Framework 会失去它的好处，我可以使用 ADO.NET 代替它并直接调用存储过程......

*   我不能采用第二种解决方案，因为每次我在数据库中进行更改时，我都必须重新生成 .edmx 文件并且我会丢失之前所做的更改:'(

有没有办法在实体框架中以某种方式做到这一点？*这可能*吗！

我知道存在其他 ORM，例如[NHibernate](https://community.jboss.org/wiki/NHibernateForNET)或[Dapper](https://github.com/SamSaffron/dapper-dot-net)，但我不知道他们是否可以提供此功能而不会造成很多痛苦。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:43:21.370

您不必每次都返回每一列。您可以指定所需的列。

```
var query  = from t in db.Table
             select new { t.Column1, t.Column2, t.Column3 }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:45:39.127

通常，如果您将数据投影到不同的 poco 中，它将在 EF / L2S 等中自动执行此操作：

```
var slim = from row in db.Customers 
           select new CustomerViewModel {
             Name = row.Name, Id = row.Id }; 
```

我希望它只能阅读 2 列。

对于像 dapper 这样的工具：因为你控制 SQL，只指定你想要的列 - 不要使用`*`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-08T15:42:01.170

您可以使用代码优先的 DbContext、POCO 和返回所需列子集的映射创建第二个项目。

这是一个剪切和粘贴代码的例子，但它会给你你需要的东西。

您可以只创建类并将数据投影到其中，但我不确定您是否可以使用此方法进行更新。您可以在单个方法中使用匿名类型，但您需要实际的类在方法之间传递。

另一种选择是转向代码优先开发。

# python - 如何在 Python 的 for 循环中将我正在迭代的行传递给排序/排序函数？

> ID：15297672
> 
> 赞同：0
> 
> 时间：2013-03-08T15:37:51.637
> 
> 标签：python, sorting, for-loop, parameters, key

我正在尝试遍历多个日志文件，并且需要对正在循环的所有文件中的文件条目（行）进行排序

这就是我正在做的事情：

```
import glob

f = glob.glob('logs/')
for line in sorted(fileinput.input(f), key=stringsplit(line)):
  print line 
```

所以，我正在打开所有文件，然后想使用 stringssplit 函数（从文件条目中提取日期）作为排序标准。

问题是，这样做会给我一个错误说：

```
name 'line' is not defined 
```

**问题：**
不能将`line`被循环作为参数传递给排序函数吗？如何才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:43:54.617

试试`key=lambda line: stringsplit(line)`。

排序是在您开始迭代 for 循环之前完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:43:07.470

`key`关键字必须是可调用的。输入序列中的*每个*条目都会调用它。

A`lambda`是创建这样一个可调用对象的简单方法：

```
sorted(..., key=lambda line: stringsplit(line)) 
```

不过，我会*非常*谨慎地对`fileinput`许多大文件的输出进行排序。`sorted()` *必须将**所有*行读入内存才能对它们进行排序。如果您的文件很多和/或很大，您将用完所有内存，最终导致`MemoryError`异常。

首先使用不同的方法对日志进行预排序。您可以使用 UNIX 工具`sort`，或者使用[外部排序技术](https://stackoverflow.com/questions/14465154/sorting-text-file-by-using-python/14465236#14465236)。

如果您的输入文件已经排序，您可以使用相同的键合并它们：

```
import operator

def mergeiter(*iterables, **kwargs):
    """Given a set of sorted iterables, yield the next value in merged order"""
    iterables = [iter(it) for it in iterables]
    iterables = {i: [next(it), i, it] for i, it in enumerate(iterables)}
    if 'key' not in kwargs:
        key = operator.itemgetter(0)
    else:
        key = lambda item, key=kwargs['key']: key(item[0])

    while True:
        value, i, it = min(iterables.values(), key=key)
        yield value
        try:
            iterables[i][0] = next(it)
        except StopIteration:
            del iterables[i]
            if not iterables:
                raise 
```

然后传入你*打开*的文件对象：

```
files = [open(f) for f in glob.glob('logs/*')]
for line in mergeiter(*files, key=lambda line: stringsplit(line)):
    # lines are looped over in merged order. 
```

但是您需要确保*函数*返回的`stringsplit()`值按照输入日志文件中的顺序返回。

# ruby-on-rails - Aptana“内容辅助”未正常完成

> ID：15297674
> 
> 赞同：2
> 
> 时间：2013-03-08T15:37:57.133
> 
> 标签：ruby-on-rails, aptana

我对 Aptana Studio 3 有疑问。

这是一个全新的安装。我已经导入了一个 Ruby on Rails - 之前用文本编辑器编辑过的项目。我想使用 Aptana 进行更舒适的开发，但 Content Assist 失败。

如果我尝试使用 Content Assist，它会抛出以下异常并将其写入控制台：

```
[2013-03-08 16:34:40] An error occurred while processing the invoke block for the command ERb Content Assist in C:\Users\Chris\Aptana Rubles\rails.ruble\commands\content_assist.rb: (NoMethodError) undefined method `getInstance' for Java::ComAptanaIndexCore::IndexManager:Class
org.jruby.exceptions.RaiseException: (NoMethodError) undefined method `getInstance' for Java::ComAptanaIndexCore::IndexManager:Class
    at Rails::ContentAssistant.index_manager(C:/Users/Chris/Aptana Rubles/rails.ruble/lib/content_assistant.rb:87)
    at Rails::ContentAssistant.gem_indices(C:/Users/Chris/Aptana Rubles/rails.ruble/lib/content_assistant.rb:79)
    at org.jruby.RubyProc.call(org/jruby/RubyProc.java:274)
    at org.jruby.RubyProc.call(org/jruby/RubyProc.java:229)
    at Java::JavaUtil::Collection.each(C:/Users/Chris/AppData/Local/Aptana Studio 3/plugins/org.jruby_1.6.4.1331328108/lib/ruby/site_ruby/shared/builtin/java/java.util.rb:7)
    at org.jruby.RubyEnumerable.collect(org/jruby/RubyEnumerable.java:706)
    at Rails::ContentAssistant.gem_indices(C:/Users/Chris/Aptana Rubles/rails.ruble/lib/content_assistant.rb:79)
at Rails::ContentAssistant.gem_and_project_indices(C:/Users/Chris/Aptana Rubles/rails.ruble/lib/content_assistant.rb:74)
at Rails::ContentAssistant.assist(C:/Users/Chris/Aptana Rubles/rails.ruble/lib/content_assistant.rb:31)
at #<Class:0x101f95cf6>.define_content_assist(C:\Users\Chris\Aptana Rubles\rails.ruble\commands\content_assist.rb:7)
at org.jruby.RubyProc.call(org/jruby/RubyProc.java:274)
at org.jruby.RubyProc.call(org/jruby/RubyProc.java:233) 
```

Aptana 日志文件包含以下消息：

```
!ENTRY org.eclipse.ui 4 4 2013-03-08 16:34:40.465
!MESSAGE "Content Assist" did not complete normally.  Please see the log for more information.

!ENTRY org.eclipse.ui 4 0 2013-03-08 16:34:40.465
!MESSAGE (Errno::EINVAL) =::
!STACK 0
org.jruby.exceptions.RaiseException: (Errno::EINVAL) =::
    at org.jruby.RubyHash.replace(org/jruby/RubyHash.java:1623) 
```

我不知道如何处理这个错误。我是否必须安装其他任何东西才能在 Ruby on Rails 中使用 Content Assist？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-13T13:49:08.697

我在[https://jira.appcelerator.org/browse/APSTUD-2718找到了一个解决方案](https://jira.appcelerator.org/browse/APSTUD-2718)

> 作为一种解决方法：
> 
> 1) Commands > Rails Bundle > Edit this Bundle 将获取新代码的副本

这为我删除了错误消息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:58:18.127

我找到了这个链接，它将我的问题描述为“未解决”（报告于 2012 年 9 月 12 日）：

[https://jira.appcelerator.org/browse/APSTUD-7406](https://jira.appcelerator.org/browse/APSTUD-7406)

但这是“Aptana Studio 3.2.2”，我有版本 3.3.3，我不敢相信这个问题没有解决。

其他使用 Aptana 的人知道这个问题吗？

# css - CSS 如何在内部处理浮点数？

> ID：15297682
> 
> 赞同：3
> 
> 时间：2013-03-08T15:38:24.277
> 
> 标签：css, css-float

它是否将其视为绝对定位（参考其父容器）的块级元素？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:40:47.767

浮动元素取自正常流程，并放置在其容器的左侧或右侧，文本和内联元素将环绕它

来源：[https ://developer.mozilla.org/en-US/docs/CSS/float](https://developer.mozilla.org/en-US/docs/CSS/float)

因此，它与定位元素不同：[https ://developer.mozilla.org/en-US/docs/CSS/position](https://developer.mozilla.org/en-US/docs/CSS/position)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:48:26.967

你说对了，浮动元素创建了一个新的块格式化上下文，并从文档流中取出，就像绝对定位元素一样。

但是，左浮动元素放置在其父元素内的最左侧并被视为块元素（可以具有宽度和底部/顶部边距）。其他内容直接从元素流出（尊重它的尺寸）。类似于右浮动。这是与绝对元素不同的地方。

绝对定位元素的定位基于第一个祖先的位置，而不是静态的。

有几个含义，您可以[在 w3c 规范中阅读](http://www.w3.org/TR/CSS2/visuren.html#propdef-float)。

与绝对定位元素一样，由于它从正常元素流中取出，父元素会“崩溃”，因此您必须清除浮动或`overflow`在父元素上声明属性。

# node.js - Node.js & Express：需要根据 POST 值重定向到特定页面（使用 MongoDB）

> ID：15297683
> 
> 赞同：0
> 
> 时间：2013-03-08T15:38:25.987
> 
> 标签：node.js, mongodb, express, mongoose

我正在用 Node、Express 和 MongoDB 创建一个博客。我正在使用 Mongoose 连接到 MongoDB。

我有一个创建新帖子表单，可以很好地在 MongoDB 中创建和保存新帖子。

创建帖子时，您可以将帖子标记为已发布或不选中该选项。当您保存帖子时，我希望您：

A) 如果帖子已发布，则重定向到主页，或 B) 如果帖子未标记为已发布，则重定向到帖子的编辑/更新页面。

这是我试图用来完成上述操作的视图中的代码：

```
addPost: function(req, res) {
  return new Post(req.body.post).save(function() {
    if (req.body.published === true) {
      return res.redirect("/");
    } else {
      return res.redirect("/office/post/" + [NEED OBJECT ID HERE] + "/edit");
    }
  });
} 
```

这是发送 POST 数据的相应视图：

```
form.web-form(method="post", action="/post/new")
  fieldset.fieldset
    label.form-label(for="title") Title
    input.text-input(id="title", type="text", name="post[title]", placeholder="Post title")

    input.text-input(id="alias", type="hidden", name="post[alias]")

    label.form-label(for="subhead") Subhead
    input.text-input(id="subhead", type="text", name="post[subhead]", placeholder="Post subhead")

    label.form-label(for="preview") Preview
    textarea.text-area(id="preview", name="post[preview]", rows="4", placeholder="Preview")

    label.form-label(for="post-body") Body
    textarea.text-area(id="post-body", name="post[body]", rows="5", placeholder="Main content")

    input.check-box(onclick="changeButton()", id="published", type="checkbox", name="post[published]")
    label.inline-label(for="published") Publish

    input.btn-submit(id="submit-post", type="submit", value="Save!")

    a.btn-cancel(href="/") Cancel 
```

任何帮助是极大的赞赏！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:43:03.897

像这样？

```
addPost: function(req, res) {
  // strip 'post[' and ']' from submitted parameters
  var params = {};
  for (var k in req.body)
  {
    params[k.substring(5, k.length - 1)] = req.body[k];
  };
  var post = new Post(params);
  return post.save(function() {
    if (params.published === true) {
      return res.redirect("/");
    } else {
      return res.redirect("/office/post/" + post._id + "/edit");
    }
  });
} 
```

# python - CPLEX Python API 性能开销？

> ID：15297685
> 
> 赞同：5
> 
> 时间：2013-03-08T15:38:28.623
> 
> 标签：python, performance, cplex

# 更新

这个问题已经在我交叉发布的[OR exchange](https://www.or-exchange.org/questions/7565/cplex-python-api-performance-overhead)上进行了彻底的讨论和更新。

# 原始问题

当我从命令行运行 CPLEX 12.5.0.0 时：

```
cplex -f my_instance.lp 
```

在 19056.99 个刻度中找到了一个最优整数解。

但是通过 Python API，在同一个实例上：

```
import cplex
problem = cplex.Cplex("my_instance.lp")
problem.solve() 
```

现在所需的时间为 97407.10 个滴答声（慢了 5 倍多）。

在这两种情况下，模式都是并行的、确定的、最多 2 个线程。想知道这种糟糕的性能是否是由于一些 Python 线程开销造成的，我尝试了：

```
problem = cplex.Cplex("my_instance.lp")
problem.parameters.threads.set(1)
problem.solve() 
```

需要 46513.04 滴答（即，使用一个内核比使用两个内核快两倍！）。

作为 CPLEX 和 LP 的新手，我发现这些结果非常令人困惑。有没有办法提高 Python API 的性能，或者我应该切换到一些更成熟的 API（即 Java 或 C++）？

# 附件

以下是 2 线程解决方案的完整详细信息，首先是（通用）序言：

```
Tried aggregator 3 times.
MIP Presolve eliminated 2648 rows and 612 columns.
MIP Presolve modified 62 coefficients.
Aggregator did 13 substitutions.
Reduced MIP has 4229 rows, 1078 columns, and 13150 nonzeros.
Reduced MIP has 1071 binaries, 0 generals, 0 SOSs, and 0 indicators.
Presolve time = 0.06 sec. (18.79 ticks)
Probing fixed 24 vars, tightened 0 bounds.
Probing time = 0.08 sec. (18.12 ticks)
Tried aggregator 1 time.
MIP Presolve eliminated 87 rows and 26 columns.
MIP Presolve modified 153 coefficients.
Reduced MIP has 4142 rows, 1052 columns, and 12916 nonzeros.
Reduced MIP has 1045 binaries, 7 generals, 0 SOSs, and 0 indicators.
Presolve time = 0.05 sec. (11.67 ticks)
Probing time = 0.01 sec. (1.06 ticks)
Clique table members: 4199.
MIP emphasis: balance optimality and feasibility.
MIP search method: dynamic search.
Parallel mode: deterministic, using up to 2 threads.
Root relaxation solution time = 0.20 sec. (91.45 ticks) 
```

命令行的结果：

```
GUB cover cuts applied:  1
Clique cuts applied:  3
Cover cuts applied:  2
Implied bound cuts applied:  38
Zero-half cuts applied:  7
Gomory fractional cuts applied:  2

Root node processing (before b&c):
  Real time             =    5.27 sec. (2345.14 ticks)
Parallel b&c, 2 threads:
  Real time             =   35.15 sec. (16626.69 ticks)
  Sync time (average)   =    0.00 sec.
  Wait time (average)   =    0.00 sec.
                          ------------
Total (root+branch&cut) =   40.41 sec. (18971.82 ticks) 
```

Python API 的结果：

```
Clique cuts applied:  33
Cover cuts applied:  1
Implied bound cuts applied:  4
Zero-half cuts applied:  10
Gomory fractional cuts applied:  4

Root node processing (before b&c):
  Real time             =    6.42 sec. (2345.36 ticks)
Parallel b&c, 2 threads:
  Real time             =  222.28 sec. (95061.73 ticks)
  Sync time (average)   =    0.01 sec.
  Wait time (average)   =    0.00 sec.
                          ------------
Total (root+branch&cut) =  228.70 sec. (97407.10 ticks) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-12T19:40:24.637

您可以尝试在这两种情况下禁用预求解器和切割。然后重新运行实验以测试 Python API 本身是否会限制性能。如果禁用剪切后性能匹配，则查看 Python 剪切参数调整和默认值。

在我看来，C++ 在性能方面是首选，但它会增加开发时间。不过只是我的看法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-02T23:42:29.943

与此相关，我注意到在调用 variables.add 和 linear_constraints.add 之后，python API 需要更长的时间来构建问题。似乎从 CPXLgetcolindex 调用的 strcmp 占用了大部分配置文件，也许字符串 id 正在使用通过数组的线性搜索来处理？在 C++ 中，问题的产生是瞬时的。

# php - 为什么我无法提交表单，即使不是也始终需要值

> ID：15297686
> 
> 赞同：0
> 
> 时间：2013-03-08T15:38:30.060
> 
> 标签：php, validation, symfony-1.4, symfony-forms

我的`_form.php`模板中有这段代码（省略了一些不相关的字段）：

```
<?php echo $form['correo_madre'] ?>
<?php echo $form['correo_madre']->renderError() ?> 
```

在我的 AlumnosForm.class.php 中有这个：

```
public function configure() {
   $this->validatorSchema['correo_padre'] = new sfValidatorEmail(array(), array('invalid' => 'La dirección de correo no es válida'));
   $this->validatorSchema['correo_madre'] = new sfValidatorEmail(array(), array('invalid' => 'La dirección de correo no es válida'));

   $this->validatorSchema->setPostValidator(new sfValidatorCallback(array('callback' => array($this, 'checkFields'))));
}

public function checkFields($validator, $values) {
  if ((!empty($values['alumnos_nombre_padre']) &&    
       !empty($values['alumnos_apellidos_padre']) &&
       !empty($values['alumnos_rut_padre']) &&
       !empty($values['alumnos_telefono_padre']) &&
       !empty($values['alumnos_direccion_padre']) &&
       !empty($values['alumnos_correo_padre'])) ||
       (!empty($values['alumnos_nombre_madre']) &&
       !empty($values['alumnos_apellidos_madre']) &&
       !empty($values['alumnos_rut_madre']) &&
       !empty($values['alumnos_telefono_madre']) &&
       !empty($values['alumnos_direccion_madre']) &&
       !empty($values['alumnos_correo_madre']))) {
            return $values;
        } else {
            throw new sfValidatorError($validator, 'Los datos de uno de los dos padres son requeridos!!!');
   }
} 
```

我还检查了 BaseAlumnosForm.class.php 并且验证器中不需要字段：

```
'correo_madre' => new sfValidatorString(array('max_length' => 100, 'required' => false)) 
```

当我尝试提交表单过程失败时

> 必需的

留言，为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T16:30:30.680

`configure()`由于您在of 中重新定义了验证器，因此内部`AlumnosForm`的定义`BaseAlumnosForm`被覆盖。

所以你应该关注里面的验证器`AlumnosForm` *（你是在这个类中定义了两次还是只是一个错字？）*

默认情况下，[需要验证器](http://trac.symfony-project.org/browser/branches/1.4/lib/validator/sfValidatorBase.class.php#L32)：

> required： `true`如果值是必需的，`false`否则**（默认为`true`）**

这就是为什么 Base 内部的那个明确地位于`false`. 在您的情况下，覆盖的定义将其删除，`false`因为您没有定义它。

强制它，它应该可以解决您的问题：

```
$this->validatorSchema['correo_padre'] = new sfValidatorEmail(
    array('required' => false),
    array('invalid'  => 'La dirección de correo no es válida')
); 
```

# c++ - Winsock 函数的执行时间太长

> ID：15297692
> 
> 赞同：0
> 
> 时间：2013-03-08T15:39:05.463
> 
> 标签：c++, windows, winsock

我有一个在 Windows XP 平台（i7 2.1 Ghz 处理器）上运行的应用程序。此应用程序是主节点和从节点之间通过 UDP 进行的基于主/从的通信。主节点发送请求，从节点发送响应（突发模式），每 5 ms 发送一个数据包，每个数据包长 1300 字节，包括标头。

回到主节点，主线程接收数据并将其写入队列，触发并行线程从线程中读取。

问题：Winsock API 在读取下一个数据包时执行时间很长，因此缓冲区中的数据正在丢失。

执行时间：Recvfrom() - 200 - 400 微秒。

```
Open_Sock ()
{
    socket();
    //Error check

    connect ();
    //Error Check
}

Receivethread()
{
    sock again:

    select(socket, read,write,excep,(0,0));
    //error check

    rc = recvfrom(socket,buf,len,0,&s_addr,&cln_alen)
    if(rc>0) {
        enqueue(queue,buf);
    }
} 
```

我确信 Winsock API 不需要这么长时间来获取下一个数据包。但我找不到任何关于实际执行时间的信息。在这个方向上的任何帮助都非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T08:14:32.687

如果丢失数据包是一个问题，请使用 TCP。使用 TCP，我在不太现代的机器上实现了不到一毫秒的响应时间，用于简单的环回连接。那里有一些重要的点：

*   等待流量时将 WSAEventSelect() 与 WaitForMultipleObjects() 结合使用。我不确定这与 select() 相比是否有很大的不同，但如果你想用一个额外的事件来停止线程，它会使处理更容易。
*   在等待输入之前分配一个缓冲区，这仍然可以减少延迟。
*   尽量不要为每个数据包创建一个线程，而是让线程已经在等待，即使用线程池。
*   尝试发送尽可能少的数据包，即尝试将整个数据组装到内存中并通过一次调用发送。这避免了稍后组装的多个数据包的网络 IO 开销。
*   另请查看 Nagle 算法，您可能希望为 TCP 关闭该算法。Nagle 算法与延迟确认相结合会严重影响您的延迟。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T10:56:19.363

您可能遇到了发送/接收缓冲区大小和操作系统调度程序问题的组合。在 Windows 平台上，线程之间的上下文切换不是太频繁，因此您可以使用两个选项：

1.  增加服务器进程的优先级

    这将减少您的服务器应用程序停留在队列中的时间。

2.  增加接收缓冲区大小

    你需要在两端都这样做。您可以将**setsockopt**与**SO_RCVBUF**选项一起使用：

    ```
    int size = 1 * 1024 * 1024;
    setsockopt(socket, SOL_SOCKET, SO_RCVBUF, (const char*)&size, sizeof(int)); 
    ```

# java - 内部递归正则表达式java

> ID：15297696
> 
> 赞同：1
> 
> 时间：2013-03-08T15:39:13.183
> 
> 标签：java, regex

我有以下 sql 查询，我希望能够将它们组合成一个正则表达式：

`CREATE INDEX blah_idx ON blah (id ASC)`

`CREATE INDEX blah2_idx ON blah2 (foo ASC, id DEC)`

我希望能够使用 java 正则表达式对这些进行分组，以便获得：

`blah_idx, blah, id, ASC`

`blah2_idx, blah2, foo, ASC, id, DEC`

我可以得到第一个，`CREATE INDEX (\\\w+) ON (\\\w+) \\((\w+) (\w+) \\)`但我也希望能够对第二个进行分组，但我看不到`\\((\w+) (\w+) \\)`重复匹配的定义。

这甚至可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:42:52.717

让我想起了我曾经问过的一个问题：

[如何使用正则表达式（递归？）匹配嵌套函数调用（括号对）](https://stackoverflow.com/questions/12584124/recursive-regular-expression-matching)

不幸的是，在包括 Java 在内的大多数正则表达式语言中都是不可能的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:46:48.827

为了便于阅读，我省略了一些括号。空格可以是`\\s+`or `*`。

```
"CREATE INDEX \\w+ ON \\w+ \\((\\w+ (ASC|DESC)(, \\w+ (ASC|DEC))*))\\)"
                              1     2        23       4       43 21 
```

允许嵌套组`( ( ) )`，并且从左到右编号。有关检索，请参阅 javadoc。

```
 final String[] sqls = {
        "CREATE INDEX blah_idx ON blah (id ASC)",
        "CREATE INDEX blah2_idx ON blah2 (foo ASC, id DEC)",
        "CREATE INDEX blah2_idx ON blah2 (foo ASC, id DEC, name ASC)",
    };

    final Pattern createIndexPattern = Pattern.compile(
      "CREATE INDEX (\\w+) ON (\\w+) \\(((\\w+) (ASC|DESC)(, (\\w+) (ASC|DEC))*)\\)");
    for (String sql : sqls) {
        System.out.println("SQL: " + sql);
        Matcher m = createIndexPattern.matcher(sql);
        if (!m.matches()) {
            System.out.println("No match!");
        } else {
            System.out.println("Match!");
            int groupCount = m.groupCount();
            for (int groupI = 1; groupI <= groupCount; ++groupI) {
                System.out.printf("[%d] %s%n", groupI, m.group(groupI));
            }
            String[] fieldsWithOrdering = m.group(3).split(",\\s*");
            System.out.println(Arrays.toString(fieldsWithOrdering));
        }
    } 
```

# python - django 选择形式行为

> ID：15297698
> 
> 赞同：0
> 
> 时间：2013-03-08T15:39:15.743
> 
> 标签：python, django

我在 Django 1.4 中遇到了以下奇怪的问题：

```
#forms.py
from django import forms
class MyForm(forms.Form):
    my_choices = forms.ChoiceField()

# views.py
def my_view(request):
    vchoices = (('a', 'AAAA'),
               ('b', 'BBBB'),)

    form = MyForm()
# version1:
    form.my_choices=choices
# version2:
    form.my_choices.choices=vchoices

    context={'form': form}
    return render(request,index.html", {'form': form}) 
```

考虑上面的代码：如果我使用版本 1，我可以正确渲染输出，当然选择框中没有选择。如果我使用 version2，我会收到以下错误：

> MyForm 对象没有属性“my_choices”

怎么会这样？？？在版本 1 中，'my_choices' 属性似乎存在，至少 django 没有抱怨。

第二个问题是：如果我按以下方式设置我的 forms.py

```
#forms.py
from django import forms
class MyForm(forms.Form):
    my_choices = forms.ChoiceField()
    my_choices.choices=(('a','aaaa'),('b','bbbb')) 
```

表单正确呈现，下拉框包含选项。

知道如何解释这一点，或者如何在 views.py 中设置 my_choices 的属性选择吗？

非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:49:53.410

像这样的表单字段`my_choices`不会成为表单实例的属性。相反，他们成为`form.fields`字典的成员。您可以从`form.fields['my_choices']`.

然而，通常的方法是通过表单的`__init__`方法：

```
class MyForm(forms.Form):
    my_choices = forms.ChoiceField()

    def __init__(self, *args, **kwargs):
        choices = kwargs.pop('choices')
        super(MyForm, self).__init__(*args, **kwargs)
        self.fields['my_choices'] = choices 
```

并使用 . 实例化您的表单`form = MyForm(choices=my_choices)`。

# r - R 中 read.table 的大两列文件，如何使用“行 X 没有 2 个元素”自动删除行？

> ID：15297701
> 
> 赞同：0
> 
> 时间：2013-03-08T15:39:21.230
> 
> 标签：r

我有一个大文件，由两列组成，我想读入。在这样做时，`read.table`我遇到了这个：

```
> x <- read.table('lindsay.csv')
Error in scan(file, what, nmax, sep, dec, quote, skip, nlines, na.strings,  :
  line 493016 did not have 2 elements 
```

不幸的是，该行仅占文件的 2%。所以要找到所有那些有一点损坏的行真的很难。有没有办法`read.table`自动跳过那些没有 2 个元素的行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:34:46.073

对于初学者，使用 read.csv() 或使用 sep="," 和 read.table() 如果实际上您正在使用逗号分隔的值文件。

```
x <- read.csv('lindsay.csv') 
```

或者

```
x <- read.table('lindsay.csv', sep=",") 
```

如果这仍然不起作用，您真的应该找出这些行的特殊之处并预处理文本以修复它们。这可能意味着要么删除它们，要么纠正错误，或者其他我没有想到的东西。

# objective-c - scheduleOnce 如何使用选择器和参数工作？

> ID：15297707
> 
> 赞同：0
> 
> 时间：2013-03-08T15:39:40.943
> 
> 标签：objective-c, cocos2d-iphone

Xcode 在 YES 之前期待一个 ')'

`[_creep scheduleOnce:@selector(removeFromParentAndCleanup:YES) delay:2.0f];`

对不起，如果它看起来很基本......我刚开始使用ObjectiveC。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T17:15:11.563

因为 Cocos API 将您限制为一个带有 1 个参数 (ccTime) 的选择器，所以请编写您自己的方法，将给定的参数传递给正确的函数：

```
-(void)doneWithSomething {
    [self scheduleOnce:@selector(removeAndCleanup:) delay:2.0f];
}

-(void)removeAndCleanup:(ccTime)delta {
    [ _creep removeFromParentAndCleanup:YES];
} 
```

您不能在`@selector()`指令中传递参数，因为它直接与 vTable（用于常用方法）中的条目或 ObjC sel 缓存中的条目相关，因此编译器认为您正在尝试调用一个名为`-removeFromParentAndCleanup:YES`

# android - 每次在 Android 中创建新的 Pending Intent

> ID：15297710
> 
> 赞同：17
> 
> 时间：2013-03-08T15:39:46.880
> 
> 标签：android, android-pendingintent

如何每次都创建待处理的意图？目前，我现有的待定意图正在被新的意图所取代。我尝试使用`FLAG_ONE_SHOT`as well，`CANCEL_CURRENT`但它没有用。

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-03-23T15:28:40.483

在请求代码中添加一个随机数，如下所示：

```
Intent intent = new Intent(context, YourClassname.class);
intent.putExtra("some data", "txt");  // for extra data if needed..

Random generator = new Random();

PendingIntent i=PendingIntent.getActivity(context, generator.nextInt(), intent,PendingIntent.FLAG_UPDATE_CURRENT); 
```

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-03-08T16:00:44.840

> FLAG_CANCEL_CURRENT - 如果描述的 PendingIntent 已经存在，则在生成新的之前取消当前的。
> 
> FLAG_NO_CREATE - 如果所描述的 PendingIntent 尚不存在，则只需返回 null 而不是创建它。
> 
> FLAG_ONE_SHOT - 这个 PendingIntent 只能使用一次。
> 
> FLAG_UPDATE_CURRENT - 如果描述的 PendingIntent 已经存在，则保留它，但用这个新 Intent 中的内容替换其额外数据。
> 
> 如果您确实需要同时激活多个不同的 PendingIntent 对象（例如用作同时显示的两个通知），那么您将需要确保它们有所不同，以便将它们与不同的待定意图。这可能是 考虑的任何 Intent 属性`Intent.filterEquals`，或提供给的不同请求代码整数`getActivity(Context, int, Intent, int), getActivities(Context, int, Intent[], int), getBroadcast(Context, int, Intent, int), or getService(Context, int, Intent, int).`

# php - 替换行 php

> ID：15297714
> 
> 赞同：0
> 
> 时间：2013-03-08T15:39:52.680
> 
> 标签：php, xml-parsing, str-replace

我在 XML 中有一个标签，如下所示：

```
<element name="bar">content</element>
<element name="student">xyz</element> 
```

由于许多原因，我必须修改这个 XML。

我正在尝试修改以下代码：

```
<bar>content</bar>
<student>xyz</student> 
```

有可能`str_replace()`吗？

我只能做一小部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:23:26.477

您可以像这样获取各种元素、属性等：

```
<?php
$obj = new SimpleXMLElement('<xml><element name="bar">content</element><element name="student">xyz</element></xml>');

foreach($obj as $node){
        foreach($node->attributes() as $a => $b){
                //you should make a SimpleXMLElement here probably
                //But here is your data :)
                echo "<$b>";
                echo $node;
                echo "</$b>";
        }
} 
```

运行此输出

```
<bar>content</bar><student>xyz</student> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-08T15:45:05.997

请检查此伪代码以处理您的问题：

```
newXml = ''  
oldXml = '<element name="bar">content</element><element name="student">xyz</element>'  
for each element in oldXml  
    newXml += '<' + element.name + '>' + element.content + '<' + element.name + '>' 
```

这段代码当然不会编译，但你可以理解它的原理。

# ios - 表格视图控制器 cs193p iTunesU 9 课

> ID：15297716
> 
> 赞同：0
> 
> 时间：2013-03-08T15:39:55.103
> 
> 标签：ios, objective-c, cocoa-touch, uipopover, cs193p

嗨，我正在学习关于表格视图的 iTunesU CS193P 第 9 课，编译器向我报告此错误 NSInternalInconsistencyException'，原因：'-[__NSCFArray removeObjectAtIndex:]: mutating method sent to immutable object'

我的模拟器是 iPad 6.1

所以我有

一个名为 GraphViewController.m 的类

```
#define FAVORITE_KEY @"GraphViewController.Favorite"
- (IBAction)addFavorite:(id)sender
{
    NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
    NSMutableArray *favorites = [[defaults objectForKey:FAVORITE_KEY] mutableCopy];
    if (!favorites) favorites = [NSMutableArray array];
    [favorites addObject:self.program];
   // NSLog(@"contenuto favorites %@",favorites);
    [defaults setObject:favorites forKey:FAVORITE_KEY];
    [defaults synchronize];
}

-(void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    if ([segue.identifier isEqualToString:@"GraphTableView"]) {
        NSArray *program = [[NSUserDefaults standardUserDefaults]objectForKey:FAVORITE_KEY];
        [segue.destinationViewController setPrograms:program];
    }
} 
```

（setPrograms 是设置器，我有数据要在我的 tableviewcontroller 上发送，称为 CalculatorTVC.m）

一个名为 CalculatorTVC.m 的类

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [self.programs count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"cellTable";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    // Configure the cell...
    id program = [self.programs objectAtIndex:indexPath.row];

    cell.textLabel.text = [@"y = " stringByAppendingString:[CalculatorBrain descriptionProgram:program]];
    NSLog(@"contenuto di program %@",program);  

    return cell;
} 
```

（programs 是一个公共属性，我将 GraphViewController.m 中的数据放入其中）

在我的故事板中，我有一个拆分视图...在 MasterViewController 中，我有带有条形按钮项目的工具栏，它与弹出框样式标识符中的表格视图控制器（CalculatorTVC.m）相连

the error is *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: '-[__NSCFArray removeObjectAtIndex:]: mutating method sent to immutable object' *** First throw call stack: (0x1ca1012 0x10dee7e 0x1ca0deb 0x1d21c4f 0x1d21911 0x4a5b 0x8f65 0xdd8fb 0xdd9cf 0xc61bb 0xd6b4b 0x732dd 0x10f26b0 0x229dfc0 0x229233c 0x22a0238 0x6b6e3 0x4f1476 0x870989a 0x4f2555 0x489ef9 0x46ab99 0x46ac14 0x10f2705 0x262c0 0x262a64 0x10f2705 0x262c0 0x26258 0xe7021 0xe757f 0xe66e8 0x55cef 0x55f02 0x33d4a 0x25698 0x1bfcdf9 0x1bfcad0 0x1c16bf5 0x1c16962 0x1c47bb6 0x1c46f44 0x1c46e1b 0x1bfb7e3 0x1bfb668 0x22ffc 0x24bd 0x23e5) libc++abi.dylib: terminate called throwing an exception ( lldb)

请帮我

感谢您的耐心问候

* * *

好的，我找到它崩溃的地方....

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"cellTable";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];

    // Configure the cell...
    id program = [self.programs objectAtIndex:indexPath.row];

    cell.textLabel.text = [@"y = " stringByAppendingString:[CalculatorBrain descriptionProgram:program]];
    NSLog(@"contenuto di program %@",program);  

    return cell;
} 
```

线上的崩溃

cell.textLabel.text = [@"y = " stringByAppendingString:[CalculatorBrain descriptionProgram:program]];

如果我将 NSLOG 放在此行之前，我会在输出 NSLOG 结果中看到...但是如果我将 NSLOG 放在此之后，我在输出中看不到任何内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:11:01.987

```
 NSArray *program = [[NSUserDefaults standardUserDefaults]objectForKey:FAVORITE_KEY];
[segue.destinationViewController setPrograms:program]; 
```

在这里，您将一个不可变数组传递给目标视图控制器。如果它期望一个可变数组并尝试修改它，那么您将遇到崩溃。你在这里也需要 mutableCopy 。

如果属性*应该*是一个可变数组，你应该得到编译器警告。不要忽视这些！

顺便说一句，你在删除而不是添加时崩溃了，所以你没有在你的问题中包含正确的代码。启用异常断点以查找您正在崩溃的行。

# entity-framework - Linq to Entities 无法识别 System.DateTime.. 方法，并且无法将其转换为存储表达式

> ID：15297718
> 
> 赞同：3
> 
> 时间：2013-03-08T15:40:02.547
> 
> 标签：entity-framework, linq-to-entities

我有一个问题需要我数周才能解决，但我一直没能解决。

我有一堂课，我有两种方法。以下应该从数据库中获取最新日期。该日期代表客户对“某事”所做的最新付款：

```
public DateTime getLatestPaymentDate(int? idCustomer)
{
    DateTime lastDate;

    lastDate = (from fp in ge.Payments
                from cst in ge.Customers
                from brs in ge.Records.AsEnumerable()
                where (cst.idCustomer == brs.idCustomer && brs.idHardBox == fp.idHardbox
                       && cst.idCustomer == idCustomer)
                select fp.datePayment).AsEnumerable().Max();

    return lastDate;
}//getLatestPaymentDate 
```

在这里我有另一种方法，它应该调用前一个方法来完成一个 Linq 查询并将其传递给一个 Crystal Report：

```
//Linq query to retrieve all those customers'data who have not paid their safebox(es) annuity in the last year.
public List<ReportObject> GetPendingPayers()
{
    List<ReportObject> defaulterCustomers;

      defaulterCustomers = (from c in ge.Customer
                            from br in ge.Records
                            from p in ge.Payments

                            where (c.idCustomer == br.idCustomer
                                   && br.idHardBox == p.idHardBox)

                            select new ReportObject
                            {
                                CustomerId = c.idCustomer,
                                CustomerName = c.nameCustomer,
                                HardBoxDateRecord = br.idHardRecord,
                                PaymentDate = getLatestPaymentDate(c.idCustomer),
                            }).Distinct().ToList();
}//GetPendingPayers 
```

这里没有抛出编译错误，但是当我运行应用程序并且第二种方法尝试调用该字段中的第一个方法`PaymentDate`时，会出现标题中提到的错误：

`Linq to Entities does not recognize the method System.DateTime.. and cannot translate this into a store expression`

请任何有有用输入的人让我摆脱这个混乱的错误？任何帮助将不胜感激 ！

非常感谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:04:33.723

看看这些其他问题：

[LINQ to Entities 无法识别该方法](https://stackoverflow.com/questions/7259567/linq-to-entities-does-not-recognize-the-method)

[LINQ to Entities 无法识别方法“System.DateTime Parse(System.String)”方法](https://stackoverflow.com/questions/10384862/linq-to-entities-does-not-recognize-the-method-system-datetime-parsesystem-str)

基本上，您不能在 C# 端使用值并将其转换为 SQL。第一个问题提供了更彻底的解释；第二个为您的问题提供了一个简单的解决方案。

**编辑 ：**

简而言之：EF 要求 SQL 服务器执行该`getLatestPaymentDate`方法，但它对此一无所知。您需要在程序端执行它。

只需先执行查询，将结果放入列表中，然后`Select`在内存列表中执行：

```
 List<ReportObject> defaulterCustomers;

  var queryResult = (from c in ge.Customer
                        from br in ge.Records
                        from p in ge.Payments

                        where (c.idCustomer == br.idCustomer
                               && br.idHardBox == p.idHardBox)).Distinct().ToList();

defaulterCustomers = from r in queryResult
                     select new ReportObject
                        {
                            CustomerId = r.idCustomer,
                            CustomerName = r.nameCustomer,
                            HardBoxDateRecord = r.idHardRecord,
                            PaymentDate = getLatestPaymentDate(r.idCustomer),
                        }).Distinct().ToList(); 
```

显然，我无权访问您的代码，所以请尝试一下并告诉我它是否适合您！你最终会得到一个内存列表

# javascript - 如何让每个 div 变成屏幕的大小？

> ID：15297725
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:40:18.677
> 
> 标签：javascript, html

假设我有以下内容：

```
<div class="a" background-color="orange">
</div>
<div class="a" background-color="blue">
</div>
<div class="a" background-color="red">
</div> 
```

我怎么能做到这样......

这三个 div 以某种方式每个都获得浏览器视图的大小）保持与查看器的浏览器窗口相同的大小，这样当用户向下滚动时，他们只会看到一种颜色？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:42:30.653

使用 CSS 并设置`height: 100%`如下：

```
html, body {
    height: 100%;
}

div {
    height: 100%;
} 
```

**演示**

[http://jsfiddle.net/wsraN/](http://jsfiddle.net/wsraN/)

**演示 2 与颜色**

[http://jsfiddle.net/KFuYM/](http://jsfiddle.net/KFuYM/)

**笔记**

如评论中所述，使用一个类来应用背景颜色。您可以在第二个演示中看到一个示例：

```
div.orange {
    background: orange;
} 
```

和：

```
<div class="orange"></div> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:46:42.073

您可能希望使用 CSS 而不是 html 已弃用的属性。你的 CSS 可能是：

```
html, body {
width: 100%;
height: 100%;
margin: 0;
padding: 0;
}

.boxes {  
width: 100%;
height: 100%;
margin: 0;
}

.orange {
background-color: orange;
}

.blue {
background-color: blue;
}

.red {
background-color: red;
} 
```

虽然您的 HTML：

```
<div class="boxes orange"></div>
<div class="boxes blue"></div>
<div class="boxes red"></div> 
```

有很多方法可以做到这一点。我会说我的代码是最简单的代码之一。

# javascript - 当用户单击 fancybox IMG 时，在新选项卡中打开外部网站

> ID：15297726
> 
> 赞同：0
> 
> 时间：2013-03-08T15:40:18.897
> 
> 标签：javascript, html, fancybox

已将 Fancybox 设置为向首次访问者弹出。Fancybox 包含一个图像，我想要该图像中的链接。因此，当用户单击它时，会打开一个带有 href 的新选项卡。

```
 <div id="usplayers" class="fancybox" style="max-width:500px;overflow:none;display: inline- block;">
    <a href="External URL" target="_blank">
        <img src="/folder/img.gif"> </a>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        $(".fancybox").fancybox();
    });
</script>
<script type="text/javascript">
    function popit() {
        setTimeout(function () {
            $("#usplayers").trigger('click');
        }, 2000);
    }
    $(document).ready(function () {
        var visited = $.cookie('hello');
        if (visited == 'yes') {
            nothing();
        } else {
            popit();
        }
        $.cookie('hello', 'yes', {
            expires: 15
        });
    });
</script> 
```

但它不适用于外部链接，以某种方式打开它的唯一方法是单击鼠标滚动。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T18:02:18.573

您可以做的是在以外部 URL 为目标的`wrap`锚标记内的 fancybox 中打开的图像。`<a>`

首先，您必须正确构建您的 html 才能绑定 fancybox：

```
<a class="fancybox" href="{the image that you want to open in fancybox}">
  <img src="{the thumnail that users see on your page}" alt="" />
</a> 
```

...如果访问者单击您的缩略图，fancybox 将`href`在标签的属性中显示您定位的图像`<a>`（这也将由您的`popit()`函数触发）。

然后，您将需要对`wrap`打开的图像使用 fancybox 回调，另一个`<a>`标签将在新选项卡中打开外部 URL .... 所以您的代码应如下所示：

```
<script type="text/javascript">
function popit() {
    setTimeout(function () {
        $("#usplayers").trigger('click');
    }, 2000);
}
$(document).ready(function () {
    var visited = $.cookie('hello');
    if (visited == 'yes') {
        // nothing(); // this is not defined
        return false; // use this instead
    } else {
        popit();
    }
    $.cookie('hello', 'yes', {
        expires: 15
    });
    $(".fancybox").fancybox({
        // here you wrap the opened image
        afterShow: function () {
            $(".fancybox-image").wrap("<a href='http://jsfiddle.net' target='_blank' />");
        }
    });
});
</script> 
```

见**[JSFIDDLE](http://jsfiddle.net/CXuyu/)**

**编辑**：

根据@blachawk 的评论，如果您有多个元素要显示在 fancybox 中，并且每个元素都应该链接到不同的外部 URL，您可以使用 (HTML5)`data-*`属性动态传递每个 URL，例如：

```
<a id="usplayers" data-url="jsfiddle.net" title="fire fancybox" class="fancybox" href="http://fancyapps.com/fancybox/demo/1_b.jpg"><img src="http://fancyapps.com/fancybox/demo/1_s.jpg" alt=""/></a> 
```

...然后，在同一个回调中，获取`data-url`属性的值并设置`href`包装`<a>`标签的值，如：

```
$(".fancybox").fancybox({
    afterShow: function () {
        var url = "http://" + $(this.element).data("url");
        $(".fancybox-image").wrap("<a href='"+url+"' target='_blank' />");
    }
}); 
```

当然，请参阅更新**[的 JSFIDDLE](http://jsfiddle.net/CXuyu/1/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:45:01.677

改变：

```
<a href="External URL" target="_blank">
<img   src="/folder/img.gif" </a> 
```

到：

```
<a href="External URL" target="_blank">
    <img src="/folder/img.gif" alt="" />
</a> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T16:08:34.430

你不能用fancyBox 做到这一点。该代码旨在在您所在页面顶部的弹出窗口中弹出图像，而不是打开新选项卡以显示有关您刚刚打开的图像的信息。

# facebook - 警告：curl_setopt() [function.curl-setopt]：facebook_base.php 中的 curl 配置选项无效

> ID：15297730
> 
> 赞同：0
> 
> 时间：2013-03-08T15:40:26.010
> 
> 标签：facebook, facebook-php-sdk

一周前，我开始注意到 php sdk 文件存在问题 - facebook_base.php

有时，当连接的 facebook 成员访问该站点并且自动登录触发器时，我会收到 2 个错误，有时只有第一个错误（这就是我在问题标题中使用它的原因）+ 站点显示但没有显示该用户已连接。

刷新后没有显示错误，并且显示了已连接成员的站点。

我已经尝试过新版本的 php API 以及旧版本，但仍然存在问题。

有什么想法会导致问题吗？

更新：在这里发现了类似的问题：[https ://developers.facebook.com/bugs/207087046099691?browse=search_512a0e37e7ecf6136191651](https://developers.facebook.com/bugs/207087046099691?browse=search_512a0e37e7ecf6136191651)

这是错误：

```
Warning: curl_setopt() [function.curl-setopt]: Invalid curl configuration option in /home/admin/domains/mydomain.com/public_html/includes/base_facebook.php on line 970

Warning: curl_setopt_array() [function.curl-setopt-array]: Array keys must be CURLOPT constants or equivalent integer values in /home/admin/domains/mydomain.com/public_html/includes/base_facebook.php on line 946 
```

# macos - POSIX 文件错误 - 多余的双引号？

> ID：15297731
> 
> 赞同：1
> 
> 时间：2013-03-08T15:40:38.363
> 
> 标签：macos, applescript

这个applescript有效

```
set myFile to (POSIX path "/Users/fred/Documents/data.dat") 
```

这个小程序不起作用

```
set myFileName to "/Users/fred/Documents/data.dat"
set myFile to (POSIX path myFileName) 
```

它因错误而失败

```
 get POSIX file "/Users/fred/Documents/data.dat"
    --> error number -1728
Result:
error "iTunes got an error: Can’t get POSIX file \"/Users/fred/Documents/data.dat\"." number -1728 from file "Macintosh HD:Users:drew:Desktop:Music:DIY:DIY-01.mp3" 
```

看起来好像在使用变量时，POSIX 路径包含双引号作为文件名中的显式字符。我究竟做错了什么？

下面的脚本重现了该问题。

```
tell application "Finder"
    set newFileName to "/Users"
    set newFile to POSIX file newFileName
end tell 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T17:27:24.930

好的 - 我已经知道我应该做什么了。

下面的脚本有效 - 您只需要强制变量而不是将其传递给`POSIX file`

```
tell application "Finder"
    set newFileName to "/Users"
    set newFile to (newFileName as POSIX file)
end tell 
```

结果...

```
file "Macintosh HD:Users" 
```

感谢你的协助。

安德鲁

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T16:34:41.737

“/Users/fred/Documents/data.dat”已经是posix路径

```
tell application "Finder" to open POSIX file "/Users/fred/Documents/data.dat" 
```

或者

```
tell application "System Events" to open "/Users/fred/Documents/data.dat" 
```

以下是 iTunes 的示例：

```
tell application "Finder" to set myFile to (POSIX file "/Users/John/Desktop/08 5150.mp3")
tell application "iTunes" to set resultTrack to add myFile to playlist "test" 
```

# java - 如何让扫描仪与阵列一起使用

> ID：15297734
> 
> 赞同：0
> 
> 时间：2013-03-08T15:40:44.353
> 
> 标签：java

在 id 为 0、1、2 ...9 的数组中创建 10 个账户，初始余额为 50 美元。系统提示用户输入一个id。如果 id 输入错误，要求用户输入正确的 id

这就是我到目前为止所坚持的关于如何让扫描仪与阵列一起工作的问题

```
package Object_1_Programs;
import java.util.Scanner;
/**
 *
 * 
 */
public class Accounts_Test {
    public static void main(String [] args){
        //declare arrays
        int [] a=new int[9];

        double balance=50;

        Scanner input=new Scanner(System.in);
        System.out.print("Enter Your ID:");
        a[id]=input.nextInt();

    }

} 
```

任何帮助都会谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:48:22.260

首先，您需要将 ID 放入 var：

```
int id = input.nextInt(); 
```

然后，您需要遍历数组以比较每个元素是否等于您收到的 id，例如

```
boolean idFound = false;
for(int arrayID : a)
{
  if (arrayID == id)
  {
    idFound=true;
    // found id in the array ... do your logic here
  }
}
if (!idFound)
{
  // ID not found...ask about new id
} 
```

# php - Twitter Bootstrap Datetimepicker 使用普通按钮进入日期

> ID：15297735
> 
> 赞同：1
> 
> 时间：2013-03-08T15:40:45.740
> 
> 标签：php, jquery, button, twitter-bootstrap, datepicker

我正在使用 bootstrap、php 和 jquery 开发计划器，我想使用 datetimepicker ( [http://www.eyecon.ro/bootstrap-datepicker/](http://www.eyecon.ro/bootstrap-datepicker/) ) 在计划器上转到不同的日期并查看那天的任务。我想使用普通按钮来触发日期选择器。然后，每当用户选择一个日期时，使用 GET 创建一个链接，如 index.php?page=planner&date=2013-08-03。我试图不使用输入字段，但只要可能，只要单击日期以立即创建 GET 链接..

**示例图片：**

如何创建一个像这样工作的按钮？ [![例子](../Images/55b855612067eb5e4bf41f10aee1c2bc.png)](https://i.stack.imgur.com/9TznK.png)

**我正在使用以下 HTML：**

```
<a id="diff-date" class="btn btn-large btn-primary" href="#">Date <i class="icon-calendar icon-white"></i></a> 
```

**以下 JQuery：**

```
$(function() {
    $('#diff-date').datetimepicker({
      pickTime: false
    });
  }); 
```

到目前为止没有成功..我希望有人能提供帮助！

**编辑**

**通常我使用这个 HTML：**

```
<label>Datum:</label>
<div id="datum" class="input-append">
     <input data-format="dd-MM-yyyy" type="text" name="datum" placeholder="Kies een     datum..." /><span class="add-on"><i data-date-icon="icon-calendar"></i></span>
</div> 
```

**而这个jQuery：**

```
$(function() {
    $('#datum').datetimepicker({
      pickTime: false
    });
}); 
```

**为达到这个：**

[![示例 2](../Images/b257f0ca6afd35a9dfe30ac032aa30d2.png)](https://i.stack.imgur.com/TRQa8.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-28T21:59:59.700

你很困惑：

[http://tarruda.github.io/bootstrap-datetimepicker/](http://tarruda.github.io/bootstrap-datetimepicker/)

有了这个：

[http://www.eyecon.ro/bootstrap-datepicker/](http://www.eyecon.ro/bootstrap-datepicker/)

他们不一样。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:57:58.800

尝试这个 ：

```
$(document).ready(function() {
    $('#diff_date').datepicker().on('changeDate', function(ev){
      var choosenDate = ev.date;
      //Add a specific treatment for the date here...
      $('#diff-date').datepicker('hide');
    });
    $('#diff_date').click(function() {
        $('#diff-date').datepicker('show');
    });
} 
```

并更改链接的 html，例如：

```
<a id="diff-date" class="btn btn-large btn-primary" href="#" data-date-format="yyyy-mm-dd" data-date="2012-02-20">Date <i class="icon-calendar icon-white"></i></a> 
```

仅供参考，这是[网站](http://www.eyecon.ro/bootstrap-datepicker/)中用于与日历建立链接的代码：

```
var startDate = new Date(2012,1,20);
var endDate = new Date(2012,1,25);
$('#dp4').datepicker()
    .on('changeDate', function(ev){
        if (ev.date.valueOf() > endDate.valueOf()){
                    $('#alert').show().find('strong').text('The start date can not be greater then the end date');
        } else {
            $('#alert').hide();
            startDate = new Date(ev.date);
            $('#startDate').text($('#dp4').data('date'));
        }
        $('#dp4').datepicker('hide');
    }); 
```

以及用于此的 Html

```
Start date<a href="#" class="btn small" id="dp4" data-date-format="yyyy-mm-dd" data-date="2012-02-20">Change</a> 
```

# c# - ServiceStack 验证并不总是触发

> ID：15297745
> 
> 赞同：16
> 
> 时间：2013-03-08T15:41:08.110
> 
> 标签：c#, .net, servicestack

因此，我尝试使用 RavenDB 和 ServiceStack 构建端到端集成测试套件，但遇到了一个非常奇怪的问题，即验证无法在某些请求上运行。这真的很奇怪，我不确定我做错了什么。我正在使用 NCrunch。有时测试通过，有时失败。

希望这是一个简单的解决方法，并且我正在做一些令人头疼的事情。

[您可以在http://github.com/khalidabuhakmeh/endtoend](http://github.com/khalidabuhakmeh/endtoend)上下载整个项目

除了启用 VS2012 和 NuGet 包还原之外，您不需要任何其他东西。

**更新：我决定在 NCrunch 和 Resharper Test Runner 中运行它，并且都给出相同的结果 [见下图]。**

**更新更新：我认为它可能是 XUnit，所以我尝试使用 NUnit。不，仍然是同样的问题。**

![从 NCrunch 和 Resharper 测试运行](../Images/0415f31a22b50f0b4f0b12b3c0ac4243.png)

**另一个更新：根据 user1901853 的请求放入控制台写入。这就是结果。”

![试运行 2](../Images/475515d762760a7649395dafc10efc53.png)

**最新更新：RequestFilters 被消灭了，我不知道为什么。似乎它可能是一个线程问题，但我看不出在哪里。**

我的 AppHost 正在使用 AppHostListenerBase。

```
 using EndToEnd.Core;
    using Funq;
    using Raven.Client;
    using ServiceStack.ServiceInterface.Validation;
    using ServiceStack.WebHost.Endpoints;

    namespace EndToEnd
    {
        public class TestAppHost
            : AppHostHttpListenerBase
        {
            private readonly IDocumentStore _documentStore;

            public TestAppHost(IDocumentStore documentStore)
                : base("Test AppHost Api", typeof(TestAppHost).Assembly)
            {
                _documentStore = documentStore;
            }

            public override void Configure(Container container)
            {
                ServiceStack.Text.JsConfig.EmitCamelCaseNames = true;

                // Register RavenDB things
                container.Register(_documentStore);
                container.Register(c =>
                {
                    var db = c.Resolve<IDocumentStore>();
                    return db.OpenSession();
                }).ReusedWithin(ReuseScope.Request);

                Plugins.Add(new ValidationFeature());
                container.RegisterValidators(typeof(CreateWidgetValidator).Assembly);

                // todo: register all of your plugins here
                AuthConfig.Start(this, container);
            }
        }
    } 
```

我所有测试的基础测试类如下所示：

```
 using Raven.Client;
    using Raven.Client.Indexes;
    using Raven.Tests.Helpers;
    using ServiceStack.Authentication.RavenDb;
    using ServiceStack.ServiceClient.Web;
    using ServiceStack.ServiceInterface.Auth;

    namespace EndToEnd
    {
        public abstract class ServiceStackTestBase
            : RavenTestBase
        {
            protected IDocumentStore DocumentStore { get; set; }
            protected TestAppHost Host { get; set; }
            protected JsonServiceClient Client { get; set; }

            protected const string ListeningOn = "http://localhost:1337/";

            protected string Username { get { return "testuser"; } }
            protected string Password { get { return "password"; } }

            protected ServiceStackTestBase()
            {
                DocumentStore = NewDocumentStore();
                IndexCreation.CreateIndexes(typeof(ServiceStackTestBase).Assembly, DocumentStore);
                IndexCreation.CreateIndexes(typeof(RavenUserAuthRepository).Assembly, DocumentStore);

                Host = new TestAppHost(DocumentStore);
                Host.Init();
                Host.Start(ListeningOn);

                Client = new JsonServiceClient(ListeningOn)
                {
                    AlwaysSendBasicAuthHeader = true,
                    UserName = Username,
                    Password = Password
                };

                RegisterUser();

                WaitForIndexing(DocumentStore);
            }

            private void RegisterUser()
            {
                Client.Send(new Registration
                {
                    UserName = Username,
                    Password = Password,
                    DisplayName = "Test User",
                    Email = "test@test.com",
                    FirstName = "test",
                    LastName = "user"
                });
            }

            public override void Dispose()
            {
                DocumentStore.Dispose();
                Host.Dispose();
            }
        }
    } 
```

我的测试类如下所示：

```
 using System;
    using EndToEnd.Core;
    using FluentAssertions;
    using ServiceStack.FluentValidation;
    using ServiceStack.ServiceClient.Web;
    using ServiceStack.ServiceInterface.Auth;
    using Xunit;

    namespace EndToEnd
    {
        public class RegistrationTests
            : ServiceStackTestBase
        {
            [Fact]
            public void Throws_validation_exception_when_bad_widget()
            {
                var validator = Host.Container.Resolve<IValidator<CreateWidget>>();
                validator.Should().NotBeNull();

                try
                {
                    var response = Client.Post(new CreateWidget
                    {
                        Name = null
                    });
                    // It get's here every once in a while
                    throw new Exception("Should Not Get Here!");
                }
                catch (WebServiceException wex)
                {
                    wex.StatusCode.Should().Be(400);
                    wex.ErrorMessage.Should().Be("'Name' should not be empty.");
                }
            }
        }
    } 
```

我的服务代码如下所示：

```
 using System;
    using Raven.Client;
    using ServiceStack.FluentValidation;
    using ServiceStack.ServiceHost;
    using ServiceStack.ServiceInterface;
    using ServiceStack.ServiceInterface.ServiceModel;

    namespace EndToEnd.Core
    {
        [Authenticate]
        public class WidgetsService
            : Service
        {
            private readonly IDocumentSession _session;

            public WidgetsService(IDocumentSession session)
            {
                _session = session;
            }

            public CreateWidgetResponse Post(CreateWidget input)
            {
                var widget = new Widget { Name = input.Name };
                _session.Store(widget);
                _session.SaveChanges();

                return new CreateWidgetResponse { Widget = widget };
            }
        }

        [Route("/widgets", "POST")]
        public class CreateWidget : IReturn<CreateWidgetResponse>
        {
            public string Name { get; set; }
        }

        public class CreateWidgetResponse
        {
            public CreateWidgetResponse()
            {
                ResponseStatus = new ResponseStatus();
            }

            public Widget Widget { get; set; }
            public ResponseStatus ResponseStatus { get; set; }   
        }

        public class Widget
        {
            public Widget()
            {
                Created = DateTimeOffset.UtcNow;
            }

            public string Id { get; set; }
            public string Name { get; set; }
            public DateTimeOffset Created { get; set; }
        }

        public class CreateWidgetValidator : AbstractValidator<CreateWidget>
        {
            public CreateWidgetValidator()
            {
                RuleFor(m => m.Name).NotEmpty();
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-11T17:45:29.130

我无法复制您的环境，但在 VS2010 中运行时，使用 .NET 4、NUnit 和 ReSharper Test Runner 我无法重现您的“验证未触发”问题。我已经运行了你的测试 30 多次。我认为验证未触发的几个原因是未添加插件或插件未注册验证过滤器。`if statements`如果我列出的任何一个案例都是问题，下面的 2可能会给你一些“内省”。希望这有点帮助。

```
if (!TestAppHost.Instance.Plugins.Any(x => x.GetType() == typeof(ValidationFeature)))
{
    Console.Write("Validation Plugin is not added");
    //TestAppHost.Instance.Plugins.Add(new ValidationFeature());
}

if (!TestAppHost.Instance.RequestFilters.Any(x => x.Target.ToString() == "ServiceStack.ServiceInterface.Validation.ValidationFilters"))
{
    Console.Write("No validation request filter");
   //TestAppHost.Instance.Container.RegisterValidators(typeof(CreateWidgetValidator).Assembly);
} 
```

以下是我的 packages.config，因此您可以看到我们环境中的差异。

```
<packages>
  <package id="FluentAssertions" version="2.0.1" targetFramework="net40" />
  <package id="NUnit" version="2.6.2" targetFramework="net40" />
  <package id="RavenDB.Client" version="2.0.2261" targetFramework="net40" />
  <package id="RavenDB.Database" version="2.0.2261" targetFramework="net40" />
  <package id="RavenDB.Embedded" version="2.0.2261" targetFramework="net40" />
  <package id="RavenDB.Tests.Helpers" version="2.0.2261" targetFramework="net40" />
  <package id="ServiceStack" version="3.9.38" targetFramework="net40-Client" />
  <package id="ServiceStack.Authentication.RavenDB" version="3.9.35" targetFramework="net40" />
  <package id="ServiceStack.Common" version="3.9.38" targetFramework="net40-Client" />
  <package id="ServiceStack.OrmLite.SqlServer" version="3.9.39" targetFramework="net40-Client" />
  <package id="ServiceStack.Redis" version="3.9.38" targetFramework="net40-Client" />
  <package id="ServiceStack.Text" version="3.9.38" targetFramework="net40-Client" />
  <package id="xunit" version="1.9.1" targetFramework="net40" />
</packages> 
```

# r - R，按名称访问矩阵的列向量

> ID：15297746
> 
> 赞同：23
> 
> 时间：2013-03-08T15:41:21.113
> 
> 标签：r, matrix, attributes

在 RI 中，可以通过以下方式访问列矩阵的列向量中的数据：

```
mat2[,1] 
```

的每一列`mat2`都有一个名称。如何使用 name 属性而不是从第一列检索数据`[,1]`？

例如，假设我的第一列名为“saturn”。我想要类似的东西

`mat2[,1] == mat2[saturn]`

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-08T15:42:54.553

以下应该做到这一点：

```
mat2[,'saturn'] 
```

例如：

```
> x <- matrix(1:21, nrow=7, ncol=3)
> colnames(x) <- paste('name', 1:3)
> x[,'name 1']
[1] 1 2 3 4 5 6 7 
```

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-03-08T15:53:27.890

奖金信息（添加到第一个答案）

```
x[,c('name 1','name 2')] 
```

将返回两列，就像您已经完成一样

```
x[,1:2] 
```

最后，可以使用相同的操作对行进行子集化

```
x[1:2,] 
```

如果行被命名...

```
x[c('row 1','row 2'),] 
```

请注意逗号在括号内的位置以及相对于索引的位置。

# cocoa - 将垂直滚动条添加到基于文档的 Mac 应用程序的窗口

> ID：15297751
> 
> 赞同：1
> 
> 时间：2013-03-08T15:41:51.987
> 
> 标签：cocoa, scrollbar, nswindow, nsdocument

我在 Interface Builder 中查看 MyDocument.xib，但我终生无法找到如何添加垂直滚动条。

它设置为 768x756 最小尺寸和 768x1024 最大尺寸。它以最小尺寸开始（以支持使用具有 800 像素高屏幕的旧 MacBook 的学校），但内容确实占据 1024 高度。所以我需要一个垂直滚动条来将应用程序窗口的其余内容滚动到视图中。

我尝试设置窗口 contentSize，但这只会使窗口变大。

就像在世界上所有其他环境中一样，这有点令人困惑，不一定是 IDE，这是一个打勾的问题......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:44:39.983

在 Interface Builder 中选择您的文档视图对象，然后选择 Editor->Embed In->Scroll View。

或者你可以从对象面板中拖一个 NSScrollView 到你的窗口中。

# c# - C# Excel 打印边距

> ID：15297753
> 
> 赞同：1
> 
> 时间：2013-03-08T15:41:54.303
> 
> 标签：c#, excel, margins

我想调整我用 C# 制作的程序生成的 Excel 文件的打印设置。我希望设置为：“适合（或适合）一页的页面”。（在荷兰语中，它是 Blad passend maken voor 1 pagina）：p 您可以在以下位置选择此选项：[screenshot](http://imgur.com/sQg6dv0)。

我知道边距是通过`PageSetup`对象设置的，但我只是找不到如何做到这一点。

请在这里帮助我:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T21:03:52.320

这可能有帮助吗？

```
osheet.PageSetup.PrintArea = "$A$5:$G$" & curLine + 1
osheet.PageSetup.PrintTitleColumns = "$A:$A"
osheet.PageSetup.PrintTitleRows = "$1:$4"
osheet.PageSetup.Orientation = XlPageOrientation.xlLandscape
osheet.PageSetup.CenterFooter = "SomeText"
obook.CustomViews.Add("Print Top Left", True, True) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:58:51.600

您可以使用[Office 主互操作程序集来操作 Excel 设置](http://msdn.microsoft.com/en-us/library/15s06t57.aspx)

更具体地说，[此链接](http://msdn.microsoft.com/en-us/library/ms280798%28v=office.11%29.aspx)告诉您如何使用 Excel 互操作（Office PIA 的一部分）操作页面设置

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-18T05:27:02.103

尝试这个：

```
sheet.PageSetup.TopMargin = 1;
sheet.PageSetup.BottomMargin = 1;
sheet.PageSetup.LeftMargin = 1;
sheet.PageSetup.RightMargin = 1; 
```

# c++ - 用于构建执行管道的 C++ 库

> ID：15297755
> 
> 赞同：6
> 
> 时间：2013-03-08T15:42:04.040
> 
> 标签：c++, pipeline

我一直在寻找 C++ 中可重用的执行管道库（作业调度程序库？）。[我在Boost](http://boost.org)中找不到任何东西。所以我最终找到了两个候选人：

*   [谷歌并发库](http://code.google.com/p/google-concurrency-library/wiki/PipelineExecutionFramework)
*   [库管道](http://libpipeline.nongnu.org/)

我错过了其他候选人吗？有人用过吗？它们在并行 io 和多​​线程方面有多好？这些库似乎仍然缺少依赖项处理。例如，我似乎不清楚如何编写如下内容：

```
$ cat /dev/urandom | tr P Q | head -3 
```

在这个非常简单的例子中，管道是自下而上的，当进程停止拉动时，第一个`cat`停止执行。`head`

但是，在以下情况下，我看不到如何从多线程和/或并行 io 中受益：

```
$ cat /raid1/file1 /raid2/file2 | tr P Q > /tmp/file3 
```

我无法说：`tr`当 8 个处理器可用时在 7 个线程上执行。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-01T21:54:00.893

您正在寻找的是一个*数据流*框架。管道是一种特殊形式的数据流，其中所有组件都有 1 个消费者和 1 个生产者。

Boost 支持数据流，但不幸的是，我对 Boost 并不熟悉。这是链接：[http ://dancinghacker.com/code/dataflow/dataflow/introduction/dataflow.html](http://dancinghacker.com/code/dataflow/dataflow/introduction/dataflow.html)

无论如何，您应该将组件编写为单独的程序并使用 Unix 管道。特别是，如果您的数据特征是（或可以轻松转换为）行/文本。

还有一种选择是编写自己的数据流事物。这并不难，尤其是当您有限制时（我的意思是管道：1-消费者/1-生产者），您不应该实现完整的数据流框架。管道只是将某种函数绑定在一起，将一个结果传递给下一个 arg。数据流框架是关于组件接口/模式和绑定技术的。（很有趣，我写了一个。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-04T17:27:05.170

我会给线程构建块[http://threadingbuildingblocks.org/](http://threadingbuildingblocks.org/)一个尝试。它是开源和跨平台的。维基百科的文章很不错：[http ://en.wikipedia.org/wiki/Intel_Threading_Building_Blocks](http://en.wikipedia.org/wiki/Intel_Threading_Building_Blocks)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-05-31T16:44:55.810

我今天刚读到[RaftLib](http://raftlib.io)，它使用模板和类来创建称为“内核”的管道元素。除了并行数据流之外，它还允许像您展示的 Bash 示例一样使用串行管道。来自首页的[Hello world 示例](https://gist.github.com/jonathan-beard/6a2fe1d9796cb7bb102cb8b34800fff1#file-hello_world-cpp)：

```
#include <raft>
#include <raftio>
#include <cstdlib>
#include <string>

class hi : public raft::kernel
{
public:
    hi() : raft::kernel()
    {
       output.addPort< std::string >( "0" ); 
    }

    virtual raft::kstatus run()
    {
        output[ "0" ].push( std::string( "Hello World\n" ) );
        return( raft::stop ); 
    }
};

int
main( int argc, char **argv )
{
    /** instantiate print kernel **/
    raft::print< std::string > p;
    /** instantiate hello world kernel **/
    hi hello;
    /** make a map object **/
    raft::map m;
    /** add kernels to map, both hello and p are executed concurrently **/
    m += hello >> p;
    /** execute the map **/
    m.exe();
    return( EXIT_SUCCESS );
} 
```

# java - ElasticSearch：xerial.snappy 错误 FAILED_TO_LOAD_NATIVE_LIBRARY

> ID：15297759
> 
> 赞同：3
> 
> 时间：2013-03-08T15:42:16.700
> 
> 标签：java, elasticsearch, snappy

我正在尝试运行 ElasticSearch 客户端并收到 xerial.snappy 错误 FAILED_TO_LOAD_NATIVE_LIBRARY。

我正在使用弹性搜索 v. 0.20.5：

```
<dependency>
  <groupId>org.elasticsearch</groupId>
  <artifactId>elasticsearch</artifactId>
  <version>0.20.5</version>
</dependency> 
```

并且还在我的依赖项中添加了 snappy v.1.0.4.1（但它也没有帮助）：

```
<dependency>
  <groupId>org.xerial.snappy</groupId>
  <artifactId>snappy-java</artifactId>
  <version>1.0.4.1</version>
</dependency> 
```

这是我得到的错误（我的应用程序继续运行，但我怀疑压缩库未在使用中）

```
INFO  Log4jESLogger.internalInfo - [Human Top II] loaded [], sites [] 
DEBUG Log4jESLogger.internalDebug - using [UnsafeChunkDecoder] decoder 
DEBUG Log4jESLogger.internalDebug - failed to load xerial snappy-java 
org.xerial.snappy.SnappyError: [FAILED_TO_LOAD_NATIVE_LIBRARY] null
    at org.xerial.snappy.SnappyLoader.load(SnappyLoader.java:229)
    at org.xerial.snappy.Snappy.<clinit>(Snappy.java:44)
    at org.elasticsearch.common.compress.snappy.xerial.XerialSnappy.<clinit>(XerialSnappy.java:42)
    at org.elasticsearch.common.compress.CompressorFactory.<clinit>(CompressorFactory.java:58)
    at org.elasticsearch.client.transport.TransportClient.<init>(TransportClient.java:161)
    at org.elasticsearch.client.transport.TransportClient.<init>(TransportClient.java:109) 
```

我产生此问题的代码：

```
 public static void main(String[] args)
  {
    // Error happens during client creation...
    Client client = new TransportClient().addTransportAddress(new InetSocketTransportAddress("localhost", 9300));
    try
    { 
      SearchResponse res = client.prepareSearch().execute().actionGet();
      SearchHits hits = res.getHits();
    }
    finally
    {
      client.close();
    }
  } 
```

任何人都可以阐明这个问题吗？如何快速加载本机库？我目前在 Win7-64 上，但想在 AWS（centOS、RH 等）上运行

# android - 使用 webservice api 的 AutoCompleteText 视图在 Android 中给我错误

> ID：15297760
> 
> 赞同：0
> 
> 时间：2013-03-08T15:42:17.447
> 
> 标签：android, web-services, api, android-layout, autocompletetextview

我正在尝试执行 autocompleteTextView。我正在尝试 Wiki 示例。对于 Wiki，它可以工作。但是对于我自己的 api 它不起作用。我正在尝试按姓氏打电话。我尝试使用 jSonObject。但看起来我犯了一些错误。这是我的代码。

```
public class WikiSuggestActivity extends Activity {
public String data;
public List<String> suggest;
public AutoCompleteTextView autoComplete;
public ArrayAdapter<String> aAdapter;
/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    suggest = new ArrayList<String>();
    autoComplete = (AutoCompleteTextView) findViewById(R.id.autoCompleteTextView1);
    autoComplete.addTextChangedListener(new TextWatcher(){

        public void afterTextChanged(Editable editable) {
            // TODO Auto-generated method stub

        }

        public void beforeTextChanged(CharSequence s, int start, int count, int after) {
            // TODO Auto-generated method stub

        }

        public void onTextChanged(CharSequence s, int start, int before, int count) {
            String newText = s.toString();
            new getJson().execute(newText);
        }

    });

}
   class getJson extends AsyncTask<String,String,String>{

@Override
protected String doInBackground(String... key) {
    String newText = key[0];
    newText = newText.trim();
    newText = newText.replace(" ", "+");
    try{
        HttpClient hClient = new DefaultHttpClient();
//      HttpGet hGet = new HttpGet("http://en.wikipedia.org/w/api.php?action=opensearch&search="+newText+"&limit=8&namespace=0&format=json");

            HttpGet hGet = new HttpGet("http://api.xyz.com?response_format=json&version=2.0&name="+newText);
        ResponseHandler<String> rHandler = new BasicResponseHandler();
        data = hClient.execute(hGet,rHandler);
        suggest = new ArrayList<String>();
        JSONArray jArray = new JSONArray(data);
        JSONObject mJsonObject = new JSONObject();
        for(int i=0;i<jArray.getJSONArray(1).length();i++){
        String SuggestKey = jArray.getJSONArray(1).getString(i);
//          mJsonObject = jArray.getJSONObject(i);
//          mJsonObject.getString("lastname");
        suggest.add(SuggestKey);
        }

    }catch(Exception e){
        Log.w("Error", e.getMessage());
    }

    return null;
}
   public void onPostExecute(Void result) {
       aAdapter = new ArrayAdapter<String>(getApplicationContext(),R.layout.item,suggest);
       autoComplete.setAdapter(aAdapter);
       aAdapter.notifyDataSetChanged();
   }

   }
} 
```

这是我的 JSON，它是一个有效的 JSON

```
{
"body": {
    "players": [
        {
            "firstname": "abc",
            "lastname": "def"
        },
        {
            "firstname": "xyz",
            "lastname": "abc"
        },
  ]
},
"statusCode": 200 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:05:29.423

编辑：

像这样解析你的json

```
JSONObject obj=new JSONObject(data);
JSONObject obj2=obj.getJSONObject("body");
JSONArray array=obj2.getJSONArray("players");
for(int i=0;i<array.length();i++)
{
JSONObject playerinfo=array.getJSONObject(i);
String lastname=playerinfo.getString("lastname");
suggest.add(lashname);
} 
```

* * *

您可以通过返回结果从 doInBackGround 捕获结果并在 onPostExecute 中使用它。

您正在尝试从非 UI 线程更新 UI，因为 doInBackground 未在 UI 线程中运行。

把这个代码放在 onPostExecute

```
 aAdapter = new ArrayAdapter<String>(getApplicationContext(),R.layout.item,suggest);
             autoComplete.setAdapter(aAdapter);
             aAdapter.notifyDataSetChanged(); 
```

您可以通过返回 doInBackground 中的值来获得建议

获取 ArrayList 类型的 doInBackground 并返回建议

您将在 onPostExecute 中建议作为方法参数，将其传递给适配器

# django - django - 降价和 codehilite

> ID：15297769
> 
> 赞同：1
> 
> 时间：2013-03-08T15:42:42.013
> 
> 标签：django, markdown

我不确定我是否做错了什么，但我无法让 codehilite 正确生成代码，例如：

```
from markdown import markdown
self.content_html = markdown(self.content, ['codehilite']) 
```

我正在使用来自维基百科的这个 C# 来测试

```
public class GenericList<T>
{
    void Add(T input) { }
}

class TestGenericList
{
    private class ExampleClass { }
    static void Main()
    {
        // Declare a list of type int.
        GenericList<int> list1 = new GenericList<int>();

        // Declare a list of type string.
        GenericList<string> list2 = new GenericList<string>();

        // Declare a list of type ExampleClass.
        GenericList<ExampleClass> list3 = new GenericList<ExampleClass>();
    }
} 
```

结果是

```
<p>public class GenericList<T>
{
    void Add(T input) { }
}</p>
<p>class TestGenericList
{
    private class ExampleClass { }
    static void Main()
    {
        // Declare a list of type int.
        GenericList<int> list1 = new GenericList<int>();</p>
<div class="codehilite"><pre>    <span class="c1">// Declare a list of type string.</span>
    <span class="nx">GenericList</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span> <span class="n">list2</span> <span class="o">=</span> <span class="nb">new</span> <span class="nx">GenericList</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="p">();</span>

    <span class="c1">// Declare a list of type ExampleClass.</span>
    <span class="nx">GenericList</span><span class="o">&lt;</span><span class="nx">ExampleClass</span><span class="o">&gt;</span> <span class="n">list3</span> <span class="o">=</span> <span class="nb">new</span> <span class="nx">GenericList</span><span class="o">&lt;</span><span class="nx">ExampleClass</span><span class="o">&gt;</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>

<p>}</p> 
```

可以看到，它没有标记前几行，然后开始注释 有 `// Declare a list of type string.`什么问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:56:04.943

你应该使用[pygments](http://pygments.org/)。

然后尝试在`:::<language>`代码块之前在您的降价中添加一个块，[以便它知道如何解释它](http://pythonhosted.org/Markdown/extensions/code_hilite.html#colons)。

我写了一篇关于[使用 markdown pygments 创建一个 django 博客](http://www.yaconiello.com/blog/part-1-creating-blog-system-using-django-markdown/)的文章系列，这也可能会有所帮助。

## 编辑（这是我认为的）

您需要在每行代码前留 4 个空格，以便 codehilite 能够识别它。此外，第一行和最后一行代码需要`\n`前后，您的代码不能与常规文本对接（不缩进 4 个空格）。此外，您的代码不能嵌入到项目符号列表中

# jquery - 如何捕获 raphael.js 对象的标题以供以后使用？

> ID：15297770
> 
> 赞同：0
> 
> 时间：2013-03-08T15:42:42.123
> 
> 标签：jquery, click, raphael, title

我知道以前有人问过这个问题，我一直在尝试使用为其他人的问题提供的解决方案，但我运气不佳。我正在使用 raphael.js 为 Battletech 构建星图。该地图列出了超过 2100 颗星。当用户将鼠标悬停在星上时，它会显示星系统的名称并将光标变为指针。当用户点击星星时，我会打开一个新的 div，其中包含有关该星星系统的信息。我无法完成的是确定用户单击了哪个星，以便我可以提供适当的信息。我一直在使用以下 URL 作为指南： [如何访问 Raphael 中任何元素的 id 属性](https://stackoverflow.com/questions/4454593/how-to-access-id-attribute-of-any-element-in-raphael)

很难列出我到底尝试了什么。如果我尝试检索 id、name 或 title，我会得到未定义。我认为我定义点击事件的方式存在问题。

```
var flare = starfieldGlow.circle(cX, cY, 2).attr({'fill' : starMatch , 'stroke' : '#000000' , 'title' : worldList[i][0] , 'cursor' : 'pointer'});
flare.node.setAttribute('id',"star"+i);
flare.click(function() { starClickReturn() });
glowHolder.push(flare);

function starClickReturn() {
    $('#starExplorer').show();
    alert(this.id);   -   Tried many variants here.
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:17:30.377

使用 jQuery 创建您的[数据对象](http://api.jquery.com/jQuery.data/)并将它们与每个星相关联。然后在点击函数过程中显示具体数据。此过程与[jQuery each](http://api.jquery.com/jQuery.each/)结合使用，可能对您有用。

# ios - OpenGL ES iOS 绘图性能在使用 VBO 时比没有时慢很多

> ID：15297773
> 
> 赞同：4
> 
> 时间：2013-03-08T15:42:44.690
> 
> 标签：ios, performance, opengl-es, vbo

我最近将当前项目中的绘图从内存阵列的标准绘图更改为 VBO。令我惊讶的是，帧速率从 60fps 显着下降到 30fps，绘制了 1200verts 的模型 8 次。进一步分析表明，与从内存中绘图相比，使用 VBO 时 glDrawElements 花费的时间是使用时的 10 倍。

我真的很困惑为什么会这样。有谁知道性能下降的原因可能是什么？

我正在运行 iOS 6.1.2 的 iPhone 5 上进行测试。

我已经将我的 VBO 处理隔离到一个函数中，在该函数中，我在函数顶部静态创建顶点/索引缓冲区。我可以使用 #ifdef USE_VBO 在正常渲染和 VBO 渲染之间切换

```
- (void)drawDuck:(Toy*)toy reflection:(BOOL)reflection
{
    ModelOBJ* model = _duck[0].model;
    int stride = sizeof(ModelOBJ::Vertex);

#define USE_VBO
#ifdef USE_VBO
    static bool vboInitialized = false;
    static unsigned int vbo, ibo;
    if (!vboInitialized) {
        vboInitialized = true;

        // Generate VBO
        glGenBuffers(1, &vbo);
        int numVertices = model->getNumberOfVertices();
        glBindBuffer(GL_ARRAY_BUFFER, vbo);
        glBufferData(GL_ARRAY_BUFFER, stride*numVertices, model->getVertexBuffer(), GL_STATIC_DRAW);
        glBindBuffer(GL_ARRAY_BUFFER, 0);

        // Generate index buffer
        glGenBuffers(1, &ibo);
        int numIndices = model->getNumberOfIndices();
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ibo);
        glBufferData(GL_ELEMENT_ARRAY_BUFFER, sizeof(unsigned short)*numIndices, model->getIndexBuffer(), GL_STATIC_DRAW);
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);
    }
#endif

    [self setupDuck:toy reflection:reflection];

#ifdef USE_VBO
    // Draw with VBO
    glBindBuffer(GL_ARRAY_BUFFER, vbo);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, ibo);

    glEnableVertexAttribArray(GC_SHADER_ATTRIB_POSITION);
    glEnableVertexAttribArray(GC_SHADER_ATTRIB_NORMAL);
    glEnableVertexAttribArray(GC_SHADER_ATTRIB_TEX_COORD);

    glVertexAttribPointer(GC_SHADER_ATTRIB_POSITION, 3, GL_FLOAT, GL_FALSE, stride, (void*)offsetof(ModelOBJ::Vertex, position));
    glVertexAttribPointer(GC_SHADER_ATTRIB_TEX_COORD, 2, GL_FLOAT, GL_FALSE, stride, (void*)offsetof(ModelOBJ::Vertex, texCoord));
    glVertexAttribPointer(GC_SHADER_ATTRIB_NORMAL, 3, GL_FLOAT, GL_FALSE, stride, (void*)offsetof(ModelOBJ::Vertex, normal));
    glDrawElements(GL_TRIANGLES, model->getNumberOfIndices(), GL_UNSIGNED_SHORT, 0);

    glBindBuffer(GL_ARRAY_BUFFER, 0);
    glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, 0);
#else
    // Draw with array
    glEnableVertexAttribArray(GC_SHADER_ATTRIB_POSITION);
    glEnableVertexAttribArray(GC_SHADER_ATTRIB_NORMAL);
    glEnableVertexAttribArray(GC_SHADER_ATTRIB_TEX_COORD);

    glVertexAttribPointer(GC_SHADER_ATTRIB_POSITION, 3, GL_FLOAT, GL_FALSE, stride, model->getVertexBuffer()->position);
    glVertexAttribPointer(GC_SHADER_ATTRIB_TEX_COORD, 2, GL_FLOAT, GL_FALSE, stride, model->getVertexBuffer()->texCoord);
    glVertexAttribPointer(GC_SHADER_ATTRIB_NORMAL, 3, GL_FLOAT, GL_FALSE, stride, model->getVertexBuffer()->normal);
    glDrawElements(GL_TRIANGLES, model->getNumberOfIndices(), GL_UNSIGNED_SHORT, model->getIndexBuffer());
#endif
} 
```

ModelOBJ::Vertex 对于 pos、texcoord、normal 来说只是 3,2,3 浮点数。指数是超短的。

**更新：**我现在已经将绘图设置（即属性绑定调用）包装到 VAO 中，现在性能还可以，甚至比从主内存中绘图稍好。所以我的结论是，没有 VAO 的 VBO 支持在 iOS 上被破坏了。这个假设正确吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T21:26:11.523

驱动程序很可能回退到软件顶点提交（CPU 从 VBO 复制到命令缓冲区）。这可能比在客户端内存中使用顶点数组更糟糕，因为我们通常缓存客户端内存，而 VBO 内容通常在 iOS 上的写入组合内存中。

在 Instruments 中使用 CPU 采样器时，您会在 gleRunVertexSubmitARM 中的 glDrawArrays/glDrawElements 下看到大量时间。

回退到 SW CPU 提交的最常见原因是未对齐的属性（当前 iOS 设备要求每个属性对齐 4 个字节），但对于您显示的 3 个属性，情况似乎并非如此。之后，下一个最常见的原因是在单个顶点数组配置中混合客户端数组和缓冲区对象。

在这种情况下，您可能有一个杂散的顶点属性绑定：其他一些数组元素可能仍处于启用状态并指向客户端数组，从而导致所有内容都脱离硬件 DMA 路径。通过创建 VAO，您要么切换到错误配置的默认 VAO，要么尝试启用客户端 VAO，但由于客户端阵列已折旧并且在与 VAO 一起使用时不起作用（引发 INVALID_OPERATION 错误）而被保存.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T16:30:43.593

当您使用 填充索引缓冲区时`glBufferData`，第二个参数应该是`2*numIndices`而不是`stride*numIndices`。

由于您的索引缓冲区比它需要的大得多，这可以解释您的性能问题。

# c++ - 在 C++ 中检查空格？

> ID：15297776
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:42:54.897
> 
> 标签：c++, spaces

我正在为课堂编写一个加密程序。我需要能够跟踪字符串中空格的位置，以及将 13 添加到字符串每个字符的 ASCII 值。我在第 46 行不断收到错误，我看不出我做错了什么。

```
/*
program 4

use an array to store the string
convert decimal values to ASCII, add 13 to the ASCII values, 
convert back to decimal
the character for the space shoud be determined by the character 
that came before it.
The character before it should have 4 added to it and 
placed after itself to act as the space.
*/

#include <iostream>
#include <fstream>
#include <string>
#include <conio.h>

using namespace std;

int valueChange(string array), length(string array);
int spacePosition[0]; 
string message[0], encrypt[0];

int main()
{

cout << "Please enter your message."; //start with this
cin >> message[0];

int value = length(message[0]);
int count=0;

/*

store message as an array

loop through array, adding 13 to each value, use tolower() on each value
if value is 

*/
for (int i=0; i < value; i++)
{
    valueChange(message[i]);

    if (message[i] == ' ') //checks for spaces in the string
    {
        spacePosition[count] = i + 1; //records the placement of spaces
                                      //in the string

    //have the array cast the i value to a new int value
    //store space positions in an array

    count++;
    }
 }

 cout << "&";
 cout << "Message encrypted and transmitted."; //final message

 getch();
 return 0;
}

int valueChange(int array[])
{
array[0] += 13;

if (array[0] > 122)
{
 array[0] - 122;
 }

 return (array[0]);
}

int length(string array)
{
return (array.length() - 1);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:49:21.950

如果您需要搜索空格，您可以使用`string::find_first_of(string)`. 你只需要写`

```
std::string yourstring; 
yourstring.find_first_of(" "); 
```

` 那么你需要使用迭代器遍历整个字符串。

* * *

如果长度为零，为什么要清除数组？您可以简单地使用简单的 std::string 类。如果您不允许，那么只需使用`find_first_of(....)`标准库中可用的功能。它基本上将迭代器返回到第一个匹配元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:48:23.363

```
int spacePosition[0];  
string message[0], encrypt[0]; 
```

可能希望那些是 1……或者根本不使用数组。但是您要声明长度为 0 的数组，所以是的，当您尝试写入它们时会出现段错误。

# jquery - 选择标签 .change -> if value == 3 -> 删除另一个选择的 attr 'disabled'

> ID：15297778
> 
> 赞同：1
> 
> 时间：2013-03-08T15:42:57.697
> 
> 标签：jquery, select

我有 6 个选择标签。

> FIRST：选择值 =
> 2、3、4、5 SECOND & THIRST：选择没有属性“禁用”
> 第四、第五、第六：选择有属性“禁用”

我需要：

> 如果选择值 == 3 -> FORTH 删除属性“禁用”
> 如果选择值 == 4 -> FORTH & FIFTH 删除属性“禁用”
> 如果选择值 == 5 -> FORTH & FIFTH 和 SIXTH 删除属性“禁用”
> ，否则选择值 == 2 -> FORTH、FIFTH、SIXTH：添加属性“禁用”

这是我的脚本

```
<select id="FIRST">
  <option value="1">One</option>
  <option value="2">Two</option>
  <option value="3">Three</option>
  <option value="4">Four</option>
  <option value="5">Five</option>
</select>

<select id="SECOND">
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
</select>

<select id="THIRST">
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
</select>

<select id="FORTH" disabled>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
</select>

<select id="SIXTH" disabled>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
</select>

<select id="FIFTH" disabled>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
  <option value=" ">Something</option>
</select>

<script>
$(document).ready(function(){
    $('#FIRST').change(function(event) {
    if ($(this).val() == 3) {
        $('#FORTH').removeAttr('disabled');
    }
    else if $(this).val() == 4) {
        $('#FORTH, #FIFTH').removeAttr('disabled');
    }
    else if ($(this).val() == 5) {
        $('#FORTH, #FIFTH, #SIXTH').removeAttr('disabled');
    }
    else {
        $('#FORTH, #FIFTH, #SIXTH').attr('disabled');
    };
        });
});
 </script> 
```

那是对的吗？那不运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:57:21.293

如前所述，您有 2 个语法错误，一个在第一`else if`行，一个在倒数第二行，其中缺少右括号`)`

虽然这不是你要问的，但这是一个完美的例子，说明何时使用 switch case 来避免丑陋、低效的代码，请参见下面的示例：

```
$('#FIRST').change(function (event) {
    switch (+$(this).val())
    {
        case 3: $('#FORTH').prop('disabled', false); break;
        case 4: $('#FORTH, #FIFTH').prop('disabled', false); break;
        case 5: $('#FORTH, #FIFTH, #SIXTH').prop('disabled', false); break;
        default: $('#FORTH, #FIFTH, #SIXTH').prop('disabled', true); break;
    }
}); 
```

编辑 - 您的标记也有一个令人困惑的排序问题，其中 SIXTH 和 FIFTH 以错误的方式进行，我修复了这个（并将 THIRST 重命名为 THIRD），您可以看到上述代码的工作演示与修改后的标记一起工作[JSFiddle](http://jsfiddle.net/2WNre/1/)

为了实现 Derek Henderson 的评论中描述的内容，可以将上面的代码更新为如下所示：

```
$('#FIRST').change(function (event) {
    switch (+$(this).val())
    {
        case 3: $('#FORTH').prop('disabled', false); $('#FIFTH, #SIXTH').prop('disabled', true); break;
        case 4: $('#FORTH, #FIFTH').prop('disabled', false); $('#SIXTH').prop('disabled', true); break;
        case 5: $('#FORTH, #FIFTH, #SIXTH').prop('disabled', false); break;
        default: $('#FORTH, #FIFTH, #SIXTH').prop('disabled', true); break;
    }
}); 
```

这是一个在[JSFiddle](http://jsfiddle.net/2WNre/2/)上工作的例子。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:48:59.613

您的代码中有 2 个语法错误，您缺少`})`关闭`change`处理程序和`(`其中一个`else if`语句。

```
$(document).ready(function(){
    $('#FIRST').change(function(event) {
       if ($(this).val() == 3) {
           $('#FORTH').prop('disabled', false);
       }
       else if ($(this).val() == 4) { // here
           $('#FORTH, #FIFTH').prop('disabled', false);
       }
       else if ($(this).val() == 5) {
           $('#FORTH, #FIFTH, #SIXTH').prop('disabled', false);
       }
       else {
           $('#FORTH, #FIFTH, #SIXTH').prop('disabled', true);
       }
   }) // and here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T15:49:41.050

您缺少一个 (. 更改：

```
 else if $(this).val() == 4) {
    $('#FORTH, #FIFTH').prop('disabled', false);
} 
```

至

```
 else if ($(this).val() == 4) {
    $('#FORTH, #FIFTH').prop('disabled', false);
} 
```

# android - SharedPreferences 不保存强制关闭应用程序

> ID：15297779
> 
> 赞同：1
> 
> 时间：2013-03-08T15:42:59.093
> 
> 标签：android, save, sharedpreferences

我有一个带有复选框的登录表单，让应用程序记住电子邮件`LoginActivity`。如果我按下登录按钮，电子邮件应该`SharedPreferences`使用类存储`AppPreferences`。

如果我通过按主页按钮并按返回返回主屏幕，该应用程序会记住电子邮件。

但是如果我强制关闭应用程序会显示方法中定义的默认值`Preferencemanager.getString("value", "default_value");`。

我已经尝试了很多人们在 SO 上提出的建议，但不幸的是，这些解决方案都没有奏效。我什至试图通过将所有`SharedPreferences`代码放在一个单独的类中来解决它（参见[这个问题](https://stackoverflow.com/questions/15251942/sharedpreferences-makes-app-force-close)）。

下面我放了与问题相关的尽可能多的代码。所以类`LoginActivity`和`AppPreferences`. LogCat 没有给出错误消息。

在带有 Android 4.2.2 Cyanogenmod 10.1 和几个不同仿真器的三星设备 I9100 和 P3110 上都会出现此问题。（我读到一些带有 HoneyComb 的三星 S 设备无法正确保存 SharedPreferences？）

* * *

**编辑：** 正如我忘记提到的，该项目针对 API 17 和 minSdkVersion = 11。我只在单击登录按钮时保存凭据。
**编辑 2：**如果手机重新启动，也会出现此问题

* * *

`LoginActivity`班级：

```
public class LoginActivity extends Activity
{
    private static final String PREF_REMEMBER_EMAIL = "LoginCredentialsRememberEmail";
    private static final String PREF_EMAIL = "LoginCredentialsEmail";

    private String mEmail;

    private EditText mEmailView;
    private CheckBox cbRememberEmail;   

    private AppPreferences appPreferences;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_login);

        appPreferences = new AppPreferences(LoginActivity.this);

        loadUserCredentials();
    }
    @Override
  protected void onResume() {       
        super.onResume();
        loadUserCredentials();
    }

    @Override
    protected void onStart() {
        super.onStart();
        loadUserCredentials();
    }

    private void loadUserCredentials() {
        String rememberEmail = appPreferences.getPreferenceString(PREF_REMEMBER_EMAIL);
        String email = appPreferences.getPreferenceString(PREF_EMAIL);
        mEmailView = (EditText) findViewById(R.id.email);
        mEmailView.setText((rememberEmail == "1") ? email : "");
        cbRememberEmail = (CheckBox) findViewById(R.id.cbRememberEmail);
        cbRememberEmail.setChecked(rememberEmail == "1" ? true : false);
        mEmail = mPassword = "";
    }
    private void saveUserCredentials() {        
        try {
        String rememberemail = (((CheckBox) findViewById(R.id.cbRememberEmail)).isChecked()) ? "1" : "0";
        appPreferences.setPreferenceString(PREF_REMEMBER_EMAIL, rememberemail);
        String email = (rememberemail == "1") ? mEmail : "";
        appPreferences.setPreferenceString(PREF_EMAIL, email);
    }

    public void cbRememberEmailClick(View view) {
        boolean checked = ((CheckBox) findViewById(R.id.cbRememberEmail)).isChecked();
        if (checked) {
            new AlertDialog.Builder(this).setTitle(R.string.remember_email_notification_title).setMessage(R.string.remember_email_notification_message).setPositiveButton(R.string.yes, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    ((CheckBox) findViewById(R.id.cbRememberEmail)).setChecked(true);
                }
            }).setNegativeButton(R.string.no, new DialogInterface.OnClickListener() {
                public void onClick(DialogInterface dialog, int which) {
                    ((CheckBox) findViewById(R.id.cbRememberEmail)).setChecked(false);
                }
            }).show();
        }
    }
// ...
} 
```

`AppPreferences`班级：

```
public class AppPreferences {
    Context context;

    private SharedPreferences settings = null;

    private static String LOGIN_CREDENTIALS = "com.example.login.credentials";
    private static String DEFAULT_STRING = "";

    public AppPreferences(Context context) {
        this.context = context;
        settings = PreferenceManager.getDefaultSharedPreferences(context);
    }

    private String getKey(String key) {
        return LOGIN_CREDENTIALS + "." + key;
    }

    public String getPreferenceString(String key) {
        return settings.getString(getKey(key), DEFAULT_STRING);
    }
    public void setPreferenceString(String key, String value) throws Exception {
        SharedPreferences.Editor editor = settings.edit();
        editor.putString(getKey(key), (String) value);
        editor.commit();
    }
// ...
} 
```

任何帮助都非常感谢，我被困了好几天，现在真的很沮丧。

提前致谢。

专注

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:46:39.393

您没有显示调用`saveUserCredentials`. 你应该调用它`onPause`：

```
@Override
protected void onPause() {
    super.onPause();
    saveUserCredentials();
} 
```

如果你在后面的生命周期方法之一中调用它（例如`onDestroy`），如果应用程序在后台被强制关闭，它将不会被调用。`onStop`（如果您仅针对 Honeycomb 及更高版本，则可以推迟此操作。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-19T09:03:15.193

`rememberEmail`我通过将字段更改为 a`Boolean`而不是包含 a 的字符串来修复它`1`or `0`。我不知道为什么这不起作用，但我更高兴的是，经过 11 天的挫折之后，这不再是问题了。

我也删除了文件夹中的所有首选项文件`/data/data/com.example/shared_prefs/`

更改了代码`LoginActivity`

```
// ....
private void loadUserCredentials() {
    Boolean rememberEmail = appPreferences.getPreferenceBoolean(PREF_REMEMBER_EMAIL);
    String email = appPreferences.getPreferenceString(PREF_EMAIL);
    mEmailView = (EditText) findViewById(R.id.email);
    mEmailView.setText(rememberEmail ? email : "");
    cbRememberEmail = (CheckBox) findViewById(R.id.cbRememberEmail);
    cbRememberEmail.setChecked(rememberEmail);
}
private void saveUserCredentials() {        
    try {
    Boolean rememberEmail = ((CheckBox) findViewById(R.id.cbRememberEmail)).isChecked();
    appPreferences.setPreferenceBoolean(PREF_REMEMBER_EMAIL, rememberEmail);
    String email = (rememberEmail) ? mEmail : "";
    appPreferences.setPreferenceString(PREF_EMAIL, email);
}
// .... 
```

并且在`AppPreferences`

```
// ....
private String getKey(String key) {
    key = key.toLowerCase();
    return LOGIN_CREDENTIALS + "." + key;
}
// newly added methods below
public String getPreferenceBoolean(String key) {
    return settings.getBoolean(getKey(key), DEFAULT_BOOLEAN);
}
public void setPreferenceBoolean(String key, Boolean value) throws Exception {
    SharedPreferences.Editor editor = settings.edit();
    editor.putBoolean(getKey(key), (Boolean) value);
    editor.commit();
}
// .... 
```

我希望你不会犯和我一样的错误；）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:45:28.137

我建议你，将 save 方法放入 onDestroy 方法

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-11T10:36:58.590

如果您`saveUserCredentials();`在选中复选框时调用，这应该可以正常工作。还尝试在应用程序启动时初始化首选项 obj

# r - 将动物园聚合函数应用于时间序列的问题

> ID：15297780
> 
> 赞同：0
> 
> 时间：2013-03-08T15:43:01.917
> 
> 标签：r, return, time-series, zoo

我们有以下函数来计算每日一系列价格的月收益：

```
PricesRet = diff(Prices)/lag(Prices,k=-1)
tail(PricesRet)
# Monthly simple returns
MonRet = aggregate(PricesRet+1, as.yearmon, prod)-1
tail(MonRet) 
```

问题是它返回了错误的值，例如 2013 年 2 月的简单返回，该函数返回 -0.003517301，而它应该是 -0.01304773。

为什么会这样？

以下是最新的价格观察：

```
> tail(Prices,30)
                 Prices
2013-01-22      165.5086
2013-01-23      165.2842
2013-01-24      168.4845
2013-01-25      170.6041
2013-01-28      169.7373
2013-01-29      169.8724
2013-01-30      170.6554
2013-01-31      170.7210
2013-02-01      173.8043
2013-02-04      172.2145
2013-02-05      172.8400
2013-02-06      172.8333
2013-02-07      171.3586
2013-02-08      170.5602
2013-02-11      171.2172
2013-02-12      171.4126
2013-02-13      171.8687
2013-02-14      170.7955
2013-02-15      171.2848
2013-02-19      170.9482
2013-02-20      171.6355
2013-02-21      170.0300
2013-02-22      169.9319
2013-02-25      170.9035
2013-02-26      168.6822
2013-02-27      168.5180
2013-02-28      168.4935
2013-03-01      169.6546
2013-03-04      169.3076
2013-03-05      169.0579 
```

以下是价格回报：

```
> tail(PricesRet,50)
              PricesRet
2012-12-18  0.0055865274
2012-12-19 -0.0015461900
2012-12-20 -0.0076140194
2012-12-23  0.0032656346
2012-12-26  0.0147750923
2012-12-27  0.0013482760
2012-12-30 -0.0004768131
2013-01-01  0.0128908541
2013-01-02 -0.0047646818
2013-01-03  0.0103372029
2013-01-06 -0.0024547278
2013-01-07 -0.0076920352
2013-01-08  0.0064368720
2013-01-09  0.0119663301
2013-01-10  0.0153828814
2013-01-13  0.0050590540
2013-01-14 -0.0053324785
2013-01-15 -0.0027043105
2013-01-16  0.0118840383
2013-01-17 -0.0005876459
2013-01-21 -0.0145541598
2013-01-22 -0.0013555548
2013-01-23  0.0193624621
2013-01-24  0.0125802978
2013-01-27 -0.0050807744
2013-01-28  0.0007959058
2013-01-29  0.0046096266
2013-01-30  0.0003844082
2013-01-31  0.0180603867
2013-02-03 -0.0091473127
2013-02-04  0.0036322298
2013-02-05 -0.0000390941
2013-02-06 -0.0085320734
2013-02-07 -0.0046591956
2013-02-10  0.0038517581
2013-02-11  0.0011412046
2013-02-12  0.0026607502
2013-02-13 -0.0062440496
2013-02-14  0.0028645616
2013-02-18 -0.0019651341
2013-02-19  0.0040206637
2013-02-20 -0.0093543648
2013-02-21 -0.0005764665
2013-02-24  0.0057176118
2013-02-25 -0.0129979321
2013-02-26 -0.0009730782
2013-02-27 -0.0001453191
2013-02-28  0.0068911863
2013-03-03 -0.0020455332
2013-03-04 -0.0014747845 
```

该函数的结果是：

```
> tail(data.frame(MonRet))
               MonRet
ott 2012 -0.000848156
nov 2012  0.009833881
dic 2012  0.033406884
gen 2013  0.087822700
feb 2013 -0.023875638
mar 2013 -0.003517301 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:10:32.273

你的回报是错误的。2013-01-23 的回报应该是：

```
> 165.2842/165.5086-1
[1] -0.001355821 
```

但你有`0.0193624621`。我怀疑这是因为`Prices`是 xts 对象，而不是 zoo 对象。 `lag.xts`打破了暗示(t+1) 的“滞后”的惯例`lag.ts`，因为更常见的惯例是使用来暗示 (t-1) 的“滞后”。`lag.zoo``k=1``k=1`

# .net - 如何在我正在变成 dll 的项目中包含 dll。

> ID：15297787
> 
> 赞同：0
> 
> 时间：2013-03-08T15:43:13.853
> 
> 标签：.net, visual-studio-2010, dll

我有一个项目，我想变成一个 dll。这个项目已经在使用一些 dll。当我将此项目转换为 dll 时，我想将这些其他 dll 与此捆绑在一起（新 dll / 项目被转换为 dll）。因此，当我使用新创建的 dll 时，我不必添加新的 dll 在变成 dll 之前使用的其他 dll。

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:46:52.340

您可以尝试使用 ilmerge 将引用的程序集合并到您的程序集中。

有关 ilmerge 的更多信息，请查看此[codeproject 文章](http://www.codeproject.com/Articles/9364/Merging-NET-assemblies-using-ILMerge)

# solr - 如何在查询中覆盖 Solr 的相关性

> ID：15297788
> 
> 赞同：0
> 
> 时间：2013-03-08T15:43:15.883
> 
> 标签：solr, lucene

我正在将化学结构搜索与 Solr 集成。为此，我正在创建一个 Solr 插件。结构搜索返回结构 ID 和它的分数。分数是介于 100 和 0 之间的值（可能永远不会看到 0）我使用它来创建 Solr 查询以提取所有具有结构 ID 的文档。我希望搜索结果按结构搜索分数排序，而不是 Solr 相关性。

我生成一个如下所示的查询：+structure_id:(28760263^95 OR 30392284^82 OR 47390042^70)

问题是，在我的简单测试用例中，Solr 最后返回了与 structure_id 28760263 匹配的记录。它已为其分配了最低的相关性（4.6609402E-6）！我编写了一个函数来基本上将分数放大很多，这显然确实解决了问题，但我认为放大不是必要的。我正在使用 Solr 3.5。是否有一些我缺少的配置？目前我使用的 Solr 几乎是开箱即用的。我唯一改变的是添加我的插件，我编辑了示例文档为我的测试用例添加了 structure_ids。

有没有办法用结构搜索的分数完全覆盖 lucene 评分？我们还有其他原因想要控制 Solr 的得分，并且知道如何做到这一点会很有用

# junit - Jenkins 工作中 Junit 的构建步骤是什么？

> ID：15297790
> 
> 赞同：0
> 
> 时间：2013-03-08T15:43:21.213
> 
> 标签：junit, jenkins

我正在使用 Jenkins CI 来测试一个 Java 项目。我已经编写了测试并在 Eclipse 中运行它们，一切都很好。但是，我不知道在 Jenkins Job 的构建步骤中要写什么。

我的存储库是这样的：（Junit 测试在 TestDFA.java 中）

```
D:\GIT\CFLOW
│   Main.java
│   PreProcessor.java
│
├───cflow
│   │   DFA.java
│   │
│   ├───exceptions
│   │       DeadState.java
│   │       InvalidStateException.java
│   │       InvalidTransitionException.java
│   │
│   └───tests
│           TestDFA.java
│
└───libs
        junit.jar 
```

我还有另一份 Python 工作，我需要写的只是“python testDFA.py”，但使用 Java 很难

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T16:28:15.813

[您应该尝试使用Maven](http://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html)或[ant](http://tutorials.jenkov.com/java-unit-testing/running-tests-with-ant.html)脚本运行您的测试用例。应该有一个 Jenkins 插件，或者只是从命令行构建步骤调用 ant/maven。

# angularjs - 我们什么时候应该使用指令编译函数的`preLink`？

> ID：15297797
> 
> 赞同：37
> 
> 时间：2013-03-08T15:43:53.830
> 
> 标签：angularjs, angularjs-directive

angularjs 指令的`compile`功能有两个功能：`preLink`和`postLink`.

> ## 预链接功能
> 
> 在链接子元素之前执行。进行 DOM 转换是不安全的，因为编译器链接函数将无法找到正确的链接元素。
> 
> ## 后链接功能
> 
> 在子元素链接后执行。在 post-linking 函数中进行 DOM 转换是安全的。

It tells what we should not do in `preLink`, I wonder what and when should I use `preLink`? For most of time I just used `postLink`. Is there any case that we must use it?

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-29T11:40:13.757

您几乎不需要使用`preLink`. 可行的情况是当您需要在执行函数（以及其他指令）*之前操作范围内***的数据，而不是 DOM**时。 *`link`*

 *正如 jacob 评论的那样，您也可以随时从控制器中执行此操作，但有时将代码放在指令本身中更合适。

有一篇关于指令如何工作的优秀文章，其中很好地解释了链接顺序：[http ://www.jvandemo.com/the-nitty-gritty-of-compile-and-link-functions-inside-angularjs-directives/](http://www.jvandemo.com/the-nitty-gritty-of-compile-and-link-functions-inside-angularjs-directives/)

如果您需要一个很好的例子来说明为什么有时需要预链接，我建议您查看角度指令本身的代码。例如[https://github.com/angular/angular.js/blob/master/src/ng/directive/ngModel.js](https://github.com/angular/angular.js/blob/master/src/ng/directive/ngModel.js)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-01-11T15:49:34.710

当`preLink`指令想要将某些东西放入**共享**范围时使用函数，以便其他指令在其`postLink`函数中使用它。

例如，Angular 的表单指令创建一个包含所有输入条目的对象。自定义指令可以在`postLink`函数中安全地访问此对象。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-09-20T13:12:44.470

在创建包含其他指令的自定义指令时，我不得不使用 preLink。在我的例子中，我的指令包含一个模板，该模板将 Angular UI Bootstrap 的 Typeahead 指令应用于它的一些元素，并使用它自己的范围变量来初始化 Typeahead 功能。

例如：

```
...
template:
    "<select ng-show='dropdown' class='form-control' ng-model='ngModel' ng-options='s for s in suggestions'></select>"
    + "<textarea ng-show='!dropdown' class='form-control' ng-model='ngModel' typeahead='s for s in suggestions |filter:$viewValue' typeahead-min-length='0' typeahead-editable='{{editable}}'></textarea>",
... 
```

在这种情况下，Angular 将子指令链接在父指令之前，因此我需要使用 preLink 来设置预输入。当我在指令 postLink 函数中初始化 $scope.dropdown 和 $scope.editable 变量时，我发现当 typeahead 指令被链接时它们没有被初始化，我不得不将它们的初始化移动到 preLink 以使该指令正常工作。*

# php - CakePHP 中的可重用内容块

> ID：15297800
> 
> 赞同：0
> 
> 时间：2013-03-08T15:44:07.097
> 
> 标签：php, cakephp, cakephp-1.3

我想问一下在 CakePHP 1.3 中创建可重用内容块的最佳方法。

在可重用内容块下，我指的是用于构建页面的部分视图。例如，在 eshop 应用程序中，迷你购物车摘要可以被视为可重复使用的内容块 - 它显示在每个页面标题上。

在 CakePHP 1.3 中有两种可能性（两者都有严重的缺点）：

*   **创建元素 /app/plugins/myeshop/elements/minicart.ctp 并用于`$this->element('minicart)`加载此可重用内容，例如在标题中。****缺点是**这会将 Cart 实体的业务分成很多地方。Minicart 只是 Cart 实体的一些表示，其视图由控制器 /app/plugins/myeshop/controllers/carts_controller.php 处理。那么为什么要把它从控制器中取出并保留在元素中呢？元素可以很好地保留一些通用的可重用内容，例如页眉、页脚、interactive_map ……与应用程序业务对象/实体无关的东西。

*   **创建具有相应视图的方法 CartsController::minicart() 并`$this->requestAction('/myeshop/carts/minicart')`用于加载此可重用内容，例如在标题中。****优点是**现在 Cart 实体的所有业务和视图都由 CartsController 处理。元素中没有隐藏侧面逻辑和侧面视图。这种方法的**缺点很**明显 - 使用 requestAction() 会花费大量时间。

在这一点上我必须说我完全同意 requestAction() 必须非常小心地使用。用它来调用控制器的一些程序/业务逻辑是糟糕的应用程序设计。这种逻辑不应该放在控制器中，而应该放在模型中。尽管如此，**恕我直言，调用控制器操作来获取部分/可重用的内容（视图）**并将实体业务保持在一个地方是合法的。

CakePHP 对此有一些最佳解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:52:11.700

如果可能的话，我会将它创建为一个元素。我假设您的控制器将计算迷你购物车的内容并在视图中显示它？

如果是这样，使用元素很好。正如您所说，您当然不想要额外的 HTTP 请求。

但是，元素应该只显示内容，它应该执行任何业务逻辑。您需要将其包含在控制器或组件中，并为视图设置必要的元素。

如果您只在某些页面上需要它，您可以创建一个包含迷你购物车的新 layout.ctp 文件，然后在这些页面上使用此布局。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:18:24.043

我强烈建议走元素/requestActions 的路线。

这是 CakePHP Master Mark Story 的一篇精彩文章： [“如何使用 requestAction 提高我网站的性能”](http://mark-story.com/posts/view/how-using-requestaction-increased-performance-on-my-site)

我们已经使用 CakePHP 构建了许多大型、高流量的网站，并且到处使用 requestActions，而且我们的网站加载速度非常快。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T16:32:54.560

如果这只是在每个页面上显示购物车的内容，我推荐这个解决方案：将购物车写入会话，如果用户未登录并将其与数据库同步登录。如果用户返回并登录，则从保存的购物车中恢复会话。

在您的 AppController::beforeFilter() 中读取会话数据并将其设置到视图中，或者如果它只是被读取，请使用您的 minicart 元素中的会话助手读取它。您不会有额外的 requestAction() 调用或任何额外的数据库查询。

我已经像这样实现了我的购物车，你可以在这里看看。[https://github.com/burzum/cart](https://github.com/burzum/cart)还提供了一个工作示例应用程序[https://github.com/burzum/CartSampleApp](https://github.com/burzum/CartSampleApp)

# sql - Creating a SQL view that contains columns which have different data types

> ID：15297801
> 
> 赞同：0
> 
> 时间：2013-03-08T15:44:12.070
> 
> 标签：sql, types, sqldatatypes

I am trying to create a SQL view which contains columns from different tables; the columns are different data types.

For example;

I have table a with a column that contains usernames. The data type of this column is nvarchar.

I then have table b, which has a column that contains whether a document was printed in colour or not – the data is either yes or no. The data type of this column is bit.

I want the view to show both the above columns side by side, so I can then pull the information into Excel for reporting purposes.

I am pretty new to SQL so I am learning as I go along.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:53:10.977

就像 PM77-1 所说的那样，您必须有一些方法将两张桌子绑在一起。例如，如果您的表 b 还具有打印文档的人的用户 ID，则您的表将如下所示：

```
Table A                                    Table B
----------------------------               -----------------------------------
userID        userName                     docID    docName     inColor userID
----------------------------               -----------------------------------
1             userName1                    1        docName1    1       1
2             userName2                    2        docName2    0       2
3             userName3                    1        docName1    1       2
                                           3        docName3    0       1
                                           3        docName3    1       2
                                           2        docName2    1       3 
```

您的查询可能如下所示：

```
SELECT a.userName, b.docName, b.inColor FROM a INNER JOIN b ON a.userID = b.userID ORDER BY a.userName, b.inColor; 
```

# javascript - 将 localStorage 的内容显示到 div 中

> ID：15297804
> 
> 赞同：2
> 
> 时间：2013-03-08T15:44:39.450
> 
> 标签：javascript, jquery, local-storage

我有这个基本功能：

```
pid = 1;
$(function() {
    if (localStorage["key"+pid] != null) {
        var contentsOfDiv = localStorage.getItem("key"+pid);
        $("#Div").html(contentsOfdDiv);
    }
}); 
```

问题是该`pid`值最终会改变，我不想覆盖`key`.

如何继续堆叠为我保存的所有`Div`内容？`localStorage`

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T15:47:14.703

您可以像在任何对象属性上一样迭代 localStorage 条目：

```
for (var key in localStorage) {
    console.log(key, localStorage[key]);
} 
```

所以你的代码可能是：

```
$(function() {
    var lines = [];
    for (var key in localStorage) {
        if (/^key/.test(key)) { // does the key start with "key"
           lines.push(key.slice(3) + ' = ' + localStorage[key]);
        }
    }
    $("#Div").html(lines.join('<br>'));
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:08:58.393

如果我理解得很好，您想使用 pid 来循环对象。

执行此操作并避免链中原型问题的最佳方法如下：

（我认为对于这种情况，您最好使用数组而不是对象）

[http://jsfiddle.net/hqkD9/](http://jsfiddle.net/hqkD9/)

```
 var localStorage = ['aaaa', 'bbbbb', 'cccc', 'dddd'];   // don't forget to declare with var

    var html_string = '';
    $.each(localStorage, function(index, value) {
        html_string += value + '<br>';
    });

    $('#my_div').html(html_string); 
```

# sql - Access- 带有下拉列表输入的参数化 SQL 语句

> ID：15297807
> 
> 赞同：0
> 
> 时间：2013-03-08T15:44:48.857
> 
> 标签：sql, database, ms-access

我有一个参数化的 SQL 语句，它接受一个字符串作为输入。

相反，为了避免手动输入错误，我希望用户能够从下拉列表中选择参数值。我希望下拉列表的值等于列中的不同值。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:04:08.990

创建一个包含组合、确定命令按钮和取消命令按钮的表单。
在您的查询条件下参考该组合（如果您在执行此操作时遇到问题，请使用向导）。
让 Ok 按钮打开查询，并让 Cancel 按钮关闭其父窗体。
组合 RowSource 应包含您的`SELECT DISTINCT`.

# sql - SQL转置全表

> ID：15297809
> 
> 赞同：24
> 
> 时间：2013-03-08T15:44:51.337
> 
> 标签：sql, sql-server, pivot, unpivot

我需要在 MS SQL 中进行以下转置

从：

```
Day  A  B 
---------
Mon  1  2
Tue  3  4
Wed  5  6
Thu  7  8
Fri  9  0 
```

到以下：

```
Value Mon Tue Wed Thu Fri 
--------------------------
A      1   3   5   7   9
B      2   4   6   8   0 
```

我知道`PIVOT`当只有一列（A）时该怎么做，但是当有多列要转置（A，B，...）时，我不知道怎么做

要转置的示例代码：

```
select LEFT(datename(dw,datetime),3) as DateWeek, 
  sum(ACalls) as A, 
  Sum(BCalls) as B 
from DataTable
group by LEFT(datename(dw,datetime),3) 
```

表结构：

```
Column DataType
DateTime Datetime
ACalls int
BCalls int 
```

任何帮助都感激不尽。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-08T15:48:21.580

为了将数据转置为您想要的结果，您需要同时使用 the[`UNPIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)和[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)函数。

该`UNPIVOT`函数采用`A`and`B`列并将结果转换为行。然后，您将使用该`PIVOT`函数将`day`值转换为列：

```
select *
from
(
  select day, col, value
  from yourtable
  unpivot
  (
    value
    for col in (A, B)
  ) unpiv
) src
pivot
(
  max(value)
  for day in (Mon, Tue, Wed, Thu, Fri)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/58c2c/2)。

如果您使用的是 SQL Server 2008+，那么您可以使用`CROSS APPLY`with`VALUES`来取消透视数据。您的代码将更改为以下内容：

```
select *
from
(
  select day, col, value
  from yourtable
  cross apply
  (
    values ('A', A),('B', B)
  ) c (col, value)
) src
pivot
(
  max(value)
  for day in (Mon, Tue, Wed, Thu, Fri)
) piv 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/58c2c/5)。

编辑#1，将您当前的查询应用到上述解决方案中，您将使用类似于以下内容的内容：

```
select *
from
(
  select LEFT(datename(dw,datetime),3) as DateWeek,
    col, 
    value
  from DataTable 
  cross apply 
  (
    values ('A', ACalls), ('B', BCalls)
  ) c (col, value)
) src
pivot
(
  sum(value)
  for dateweek in (Mon, Tue, Wed, Thu, Fri)
) piv 
```

# swt - 避免在部分展开后调整树大小

> ID：15297810
> 
> 赞同：1
> 
> 时间：2013-03-08T15:44:51.633
> 
> 标签：swt, eclipse-rcp

我有一个问题，我有一段时间自己无法解决。

我有一个包含两个部分的 RCP ViewPage。这些部分位于 SashForm 内，以便用户能够调整展开部分的大小。在底部有一个初始化后为空的树。通过用户交互（即删除过滤器），树被填满并包含大量数据。如果用户现在折叠底部视图并再次展开它，则树会调整大小，这会导致我的表单中出现 ScrollBars。我想要的是树视图中的滚动条。

以下是视图的构建方式：

```
- ScrolledForm
  - Form Body
    - Sash
      - Section 1
        - Composite
          - Some View
      - Section 2
        - Composite
          - Tree 
```

我希望你明白我想要达到的目标。

更新：这是一些可以使用的源代码。它使用表而不是树，但会产生相同的问题。

```
public class MyPersonPageEditor extends FormPage {

    public static final String ID = "some.ID"; 

    TableViewer tableViewer;

    public MyPersonPageEditor(FormEditor editor) {
        super(editor, ID, "Some Title");
    }

    @Override
    protected void createFormContent(IManagedForm managedForm) {
        FormToolkit toolkit = managedForm.getToolkit();
        ScrolledForm form = managedForm.getForm();
        Composite formBody = form.getBody();
        formBody.setLayout(new GridLayout());

        form.setText("Some Title");
        toolkit.decorateFormHeading(form.getForm());

        SashForm sfForm = new SashForm(formBody, SWT.VERTICAL);
        sfForm.setLayout(new GridLayout());
        sfForm.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));

        Section topSection = new Section(sfForm, Section.TITLE_BAR | Section.EXPANDED | Section.TWISTIE);
        topSection.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
        topSection.setText("Section 1 Title");
        Composite topSectionComposite = toolkit.createComposite(topSection);
        topSectionComposite.setLayout(new GridLayout());
        toolkit.createLabel(topSectionComposite, "Just some content. Doesn't need to be much");
        Button btn = toolkit.createButton(topSectionComposite, "Create Table Content", SWT.PUSH);
        btn.addSelectionListener(new SelectionListener() {
            @Override
            public void widgetSelected(SelectionEvent e) {
                for (int i = 0 ; i < 10 ; i++) {
                    tableViewer.add("Element " + i);
                }
            }

            @Override
            public void widgetDefaultSelected(SelectionEvent e) {

            }
        });
        topSection.setClient(topSectionComposite);

        Section bottomSection = new Section(sfForm, Section.TITLE_BAR | Section.EXPANDED | Section.TWISTIE);
        bottomSection.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
        bottomSection.setText("Section 2 Title");
        Composite bottomSectionComposite = toolkit.createComposite(bottomSection);
        bottomSectionComposite.setLayout(new GridLayout());
        bottomSectionComposite.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
        bottomSection.setClient(bottomSectionComposite);
        Table table = toolkit.createTable(bottomSectionComposite, SWT.BORDER | SWT.MULTI | SWT.FULL_SELECTION | 
                 SWT.V_SCROLL | SWT.H_SCROLL | SWT.RESIZE);
        table.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
        table.setHeaderVisible(true);

        tableViewer = new TableViewer(table);
        tableViewer.add("New Element");
        new TableColumn(table, SWT.LEFT).setText("Spalte 1");

        TableLayout layoutDefault = new TableLayout();
        layoutDefault.addColumnData(new ColumnWeightData(1));
        table.setLayout(layoutDefault);

        form.reflow(true);
    }
} 
```

如果您在启动后单击按钮，则表格看起来像左图。折叠并展开第二部分后，它看起来像正确的部分。

![在此处输入图像描述](../Images/f1aa21cbd63b9e753ab6a56c5033cf00.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T13:09:25.167

这是有效的代码：您只需调整树/表的大小并确保它不会跨越垂直空间：

```
public void createPartControl(Composite parent) {

    FormToolkit toolkit = new FormToolkit(parent.getDisplay());
    final ScrolledForm form = toolkit.createScrolledForm(parent);
    Composite formBody = form.getBody();
    formBody.setLayout(new GridLayout());
    form.setText("Some Title");
    toolkit.decorateFormHeading(form.getForm());

    SashForm sfForm = new SashForm(formBody, SWT.VERTICAL);
    sfForm.setLayout(new GridLayout());
    sfForm.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));

    //top section
    Section topSection = new Section(sfForm, Section.TITLE_BAR | Section.EXPANDED | Section.TWISTIE);
    topSection.setLayout(new GridLayout());
    topSection.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
    topSection.setText("Section 1 Title");
    Composite topSectionComposite = toolkit.createComposite(topSection);
    topSectionComposite.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
    topSectionComposite.setLayout(new TableWrapLayout());

    toolkit.createLabel(topSectionComposite, "Just some content. Doesn't need to be much");
    Button btn = toolkit.createButton(topSectionComposite, "Create Table Content", SWT.PUSH);
    btn.addSelectionListener(new SelectionListener() {

        @Override
        public void widgetSelected(SelectionEvent e) {
            for (int i = 0 ; i < 10 ; i++) {
                tableViewer.add("Element " + i);
            }
            form.reflow(true);
        }

        @Override
        public void widgetDefaultSelected(SelectionEvent e) {

        }
    });
    topSection.setClient(topSectionComposite);

    //bottom section
    Section bottomSection = new Section(sfForm, Section.TITLE_BAR | Section.EXPANDED | Section.TWISTIE);
    bottomSection.setLayout(new GridLayout());
    bottomSection.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
    bottomSection.setText("Section 2 Title");
    Composite bottomSectionComposite = toolkit.createComposite(bottomSection);
    bottomSectionComposite.setLayoutData(new GridData(SWT.FILL, SWT.FILL, true, true));
    bottomSectionComposite.setLayout(new TableWrapLayout());

    Table table = toolkit.createTable(bottomSectionComposite, SWT.BORDER | SWT.MULTI | SWT.FULL_SELECTION | 
            SWT.V_SCROLL | SWT.H_SCROLL | SWT.RESIZE);

    TableWrapData ttd222 = new TableWrapData(TableWrapData.FILL_GRAB, TableWrapData.FILL_GRAB);
    ttd222.maxHeight =200;
    table.setLayoutData(ttd222);
    table.setHeaderVisible(true);

    tableViewer = new TableViewer(table);
    tableViewer.add("New Element");
    new TableColumn(table, SWT.LEFT).setText("Spalte 1");

    TableLayout layoutDefault = new TableLayout();
    layoutDefault.addColumnData(new ColumnWeightData(1));
    table.setLayout(layoutDefault);

    bottomSection.setClient(bottomSectionComposite);
    form.reflow(true);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T13:33:16.973

- 确保 Tree 具有 SWT.H_SCROLL 样式（如果我没记错的话），即具有最小尺寸（例如，使用 GridLayout 和 GridData 将 minHeight 设置为 X 或使用 TableWrapLayout 和 TableData heightHint 设置为 X） - 如果你不这样做'无法让它工作只需告诉我，我会尝试制作代码；另外，带有布局的图片会很棒

# r - 在绘图表达式中包含文本控制字符

> ID：15297814
> 
> 赞同：11
> 
> 时间：2013-03-08T15:45:01.480
> 
> 标签：r, graphics, plot, expression, plotmath

有什么方法可以获取文本字符串的控制字符，例如在绘图表达式`"\n"`中进行`newline`评估，反之亦然。在下面的例子中，我想结合：

*   一些字符文本
*   文本控制字符（换行符）
*   替换变量名
*   包括一个绘图表达式

读完[这个问题](https://stackoverflow.com/q/15290417/1478381)后，我可以用替代品来解决大部分问题，但`newline`没有评估这个角色。我现在绕着圈子，把自己与,`plotmath`和混淆了。在plotmath的[帮助页面中，它说](http://finzi.psych.upenn.edu/R/library/grDevices/html/plotmath.html)`parse``bquote``substitute`

> 与正常绘图不同，控制字符（例如 \n）不会在 plotmath 的字符串中解释。

这是否意味着它真的不可能？

```
lab = "some data"
form = "Exponential"
x = 1:10
y = x^2

plot( x , y , type = "b" )
title( main = substitute( paste( "Plot of " , phi , " of: "  , lab , "\nFunctional form: " , form ) , list(lab = lab , form = form ) ) , adj = 0 ) 
```

![在此处输入图像描述](../Images/98d9b94d9c89c077c4528a0f183a337d.png)

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-08T18:05:56.397

As you have figured `plotmath` does not support newlines within, but you can use `mtext` with `bquote`, to write each line. For example I create a list of lines :

```
Lines <- list(bquote(paste( "Plot of " , phi , " of: "  , .(lab))),
              bquote(paste("Functional form: " , .(form)))

mtext(do.call(expression, Lines),side=3,line=1:0) 
```

![enter image description here](../Images/17769bd37e209ec47fdb26c58d0d3b63.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-09T08:11:05.577

为了完整起见，这是另一个使用 unicode 且没有表达式的解决方案（改编自[here](https://stackoverflow.com/questions/13198170/combining-expression-with-n/)和[here](https://stackoverflow.com/questions/13192984/displaying-a-greater-than-or-equal-sign/13196615#13196615)）：

```
plot(x, y, type="b")
title(main=paste("Plot of \u03A6 of:", lab, "\nFunctional form:", form), adj=0) 
```

![在此处输入图像描述](../Images/81c576b0fed1df974c87966b94fb6761.png)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-09T08:39:29.773

如果您使用网格图形，则[以下 grob](https://gist.github.com/baptiste/2732693)可用于根据线条的高度间隔线条，

```
library(devtools)
source_gist(2732693)
grid.expr(as.expression(Lines)) 
```

（使用 agstudy 的台词）

# objective-c - 动态更改自定义单元格的高度不起作用

> ID：15297819
> 
> 赞同：0
> 
> 时间：2013-03-08T15:45:06.793
> 
> 标签：objective-c, cocoa-touch, uitableview, height

我想根据标签的高度动态设置单元格的高度。

我创建了单元格：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
static NSString *simpleTableIdentifier = @"ORDStepsCell";

UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

UILabel *stepsLabel;
UILabel *stepsNumberLabel;
UIImageView *bulletImageView;
UIImageView *cellBackgroungImage;

if (cell == nil) {
    cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleValue1 reuseIdentifier:simpleTableIdentifier];

    CGRect stepsLabelFrame = CGRectMake(20, 0, 253, 21);
    CGRect bulletImageViewFrame = CGRectMake(281, 25, 29, 29);;
    CGRect stepsNumberLabelFrame = CGRectMake(3, 3, 21, 21);
    CGRect cellBackgroungImageFrame = CGRectMake(0, 0, 320, 80);

    cellBackgroungImage = [[UIImageView alloc] initWithFrame:cellBackgroungImageFrame];
    cellBackgroungImage.image = [UIImage imageNamed:@"list-item"];

    stepsLabel = [[UILabel alloc] initWithFrame:stepsLabelFrame];
    stepsLabel.textAlignment = UITextAlignmentRight;
    stepsLabel.tag = 0;

    bulletImageView = [[UIImageView alloc] initWithFrame:bulletImageViewFrame];
    bulletImageView.image = [UIImage imageNamed:@"step-bullet"];

    stepsNumberLabel = [[UILabel alloc] initWithFrame:stepsNumberLabelFrame];
    stepsNumberLabel.textAlignment = UITextAlignmentCenter;
    stepsNumberLabel.textColor = [UIColor whiteColor];
    stepsNumberLabel.backgroundColor = [UIColor clearColor];
    stepsNumberLabel.font = [UIFont boldSystemFontOfSize:17.0];
    stepsNumberLabel.tag = 1;

    [cell.contentView addSubview:cellBackgroungImage];
    [cell.contentView addSubview:stepsLabel];
    [cell.contentView addSubview:bulletImageView];
    [bulletImageView addSubview:stepsNumberLabel];

} else {
    stepsLabel = (UILabel *)[cell viewWithTag:0];
    stepsNumberLabel = (UILabel *)[cell viewWithTag:1];
}

stepsLabel.text = [preperationSteps objectAtIndex:indexPath.row];
[stepsLabel setBackgroundColor:[UIColor redColor]];
[stepsLabel setNumberOfLines:0];
[stepsLabel sizeToFit];

NSLog(@"cellHeight = %f", cell.frame.size.height);

stepsLabel.frame = CGRectMake(20, (cell.frame.size.height - stepsLabel.frame.size.height) / 2, 253, stepsLabel.frame.size.height);

stepsNumberLabel.text = [NSString stringWithFormat:@"%d", indexPath.row + 1];

[cell setSelected:NO];
[cell setSelectionStyle:UITableViewCellEditingStyleNone];

return cell;

} 
```

然后我计算了标签的高度：

```
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath {
UILabel *cellLabel = [[UILabel alloc] initWithFrame:CGRectMake(0, 0, 253, 30)];
NSString *labelText = [preperationSteps objectAtIndex:indexPath.row];
cellLabel.text = labelText;
[cellLabel setNumberOfLines:0];

[cellLabel sizeToFit];

cellLabel.frame = CGRectMake(0, 0, 253, cellLabel.frame.size.height);
CGFloat cellLabelHeight = cellLabel.frame.size.height;
NSLog(@"cellLabelHeight = %f", cellLabelHeight + 20);
return cellLabelHeight + 20;
} 
```

在日志中：

```
2013-03-08 17:37:18.161 Recipe[37547:c07] cellLabelHeight = 125.000000
2013-03-08 17:37:18.161 Recipe[37547:c07] cellLabelHeight = 62.000000
2013-03-08 17:37:18.161 Recipe[37547:c07] cellLabelHeight = 41.000000
2013-03-08 17:37:18.162 Recipe[37547:c07] cellLabelHeight = 41.000000
2013-03-08 17:37:18.162 Recipe[37547:c07] cellLabelHeight = 41.000000
2013-03-08 17:37:18.162 Recipe[37547:c07] cellLabelHeight = 41.000000
2013-03-08 17:37:18.163 Recipe[37547:c07] cellLabelHeight = 62.000000
2013-03-08 17:39:34.852 Recipe[37581:c07] cellHeight = 44.000000
2013-03-08 17:39:34.852 Recipe[37581:c07] cellHeight = 44.000000
2013-03-08 17:39:34.853 Recipe[37581:c07] cellHeight = 44.000000
2013-03-08 17:39:34.853 Recipe[37581:c07] cellHeight = 44.000000
2013-03-08 17:39:34.854 Recipe[37581:c07] cellHeight = 44.000000
2013-03-08 17:39:34.854 Recipe[37581:c07] cellHeight = 44.000000
2013-03-08 17:39:34.855 Recipe[37581:c07] cellHeight = 44.000000 
```

如您所见，即使从 heightForRowAtIndexPath 返回的值不同，单元格的高度也是固定的 44。我知道在 cellForRowAtIndexPath 之前调用了 heightForRowAtIndexPath （如日志中所示），那么如何更改高度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:04:34.633

您给出的高度就是`heightForRowAtIndexPath`显示的高度。将此代码粘贴到您的控制器中，然后查看您实际显示的高度。

```
-(void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
    NSLog(@"%f", cell.frame.size.height);
} 
```

您登录的`cellForRowAtIndexPath`高度只是单元格的默认高度。高度在`cellForRowAtIndexPath`被调用后被分配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T12:37:05.907

对我来说解决问题的是使用and方法计算标签的文本长度`sizeWithFont:constrainedToSize:lineBreakMode:` ，然后使用计算的大小设置标签的框架。 如果它对任何人有任何帮助，我将发布代码。`cellForRowAtIndexPath``heightForRowAtIndexPath``cellForRowAtIndexPath`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T16:44:01.367

> 我想根据标签的高度动态设置单元格的高度。

您可能想要这样，但您没有在`-tableView:cellForRowAtIndexPath:`方法中的任何位置设置单元格高度。`-tableView:heightForRowAtIndexPath:`不会为您设置单元格的高度 - 您需要在以前一种方法配置单元格时执行此操作。后一种方法的原因是桌子可以确定自己的高度。每当它重新加载数据时，它都会向代理询问每一行的高度，并使用该信息来计算表格的总高度。每次为给定行提供单元格时，您仍然必须设置单元格高度。

# vector - 向量中的采样点

> ID：15297821
> 
> 赞同：0
> 
> 时间：2013-03-08T15:45:16.533
> 
> 标签：vector, 3d, geometry, mesh, sampling

我有一个包含 (x,y,z) 值的向量**_pts**，即 3D 中的一个点。从 _pts[0] 开始，我想选择那些先前选择的点之间的距离大于**sampleRadius**的点。

这是我的代码，但显然出了点问题，因为选择了很多点而不是只选择了几个点。谁能看到我做错了什么？可能您需要更多代码来查看可能遗漏的内容，但我也很感激有关如何实现这一点的任何想法。

```
float distance;
bool distanceIsOk;

//PICK A POINT IN VECTOR _pts
for (int cPIdx = 0; cPIdx < _pts.size(); cPIdx++) {
    distanceIsOk = true;
    //CHECK DISTANCE AGAINST PREVIOUSLY PICKED POINTS
    for (int dPIdx = 0; dPIdx < indeces.size(); dPIdx++) {
        distance = sqrt(
                        (_pts[cPIdx].v[0] - _pts[dPIdx].v[0])*(_pts[cPIdx].v[0] - _pts[dPIdx].v[0]) +
                        (_pts[cPIdx].v[1] - _pts[dPIdx].v[1])*(_pts[cPIdx].v[1] - _pts[dPIdx].v[1]) +
                        (_pts[cPIdx].v[2] - _pts[dPIdx].v[2])*(_pts[cPIdx].v[2] - _pts[dPIdx].v[2])
                        );
        //IF DISTANCE IS <= SUBSAMPLERADIUS FOR AT LEAST ONE PREVIOUSLY SELECTED POINT
        if (distance <= subsampleRadius) {
            //DISCARD THE POINT
            distanceIsOk = false;
            dPIdx += indeces.size();
        }
    }
    //OTHERWISE INCLUDE THAT POINT
    if (distanceIsOk == true) {
        indeces.push_back(cPIdx);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T15:11:07.680

发现错误。代替

```
 distance = sqrt(
                        (_pts[cPIdx].v[0] - _pts[dPIdx].v[0])*(_pts[cPIdx].v[0] - _pts[dPIdx].v[0]) +
                        (_pts[cPIdx].v[1] - _pts[dPIdx].v[1])*(_pts[cPIdx].v[1] - _pts[dPIdx].v[1]) +
                        (_pts[cPIdx].v[2] - _pts[dPIdx].v[2])*(_pts[cPIdx].v[2] - _pts[dPIdx].v[2]) 
```

它应该是

```
 distance = sqrt(
                        (_pts[cPIdx].v[0] - _pts[indeces[dPIdx]].v[0])*(_pts[cPIdx].v[0] - _pts[indeces[dPIdx]].v[0]) +
                        (_pts[cPIdx].v[1] - _pts[indeces[dPIdx]].v[1])*(_pts[cPIdx].v[1] - _pts[indeces[dPIdx]].v[1]) +
                        (_pts[cPIdx].v[2] - _pts[indeces[dPIdx]].v[2])*(_pts[cPIdx].v[2] - _pts[indeces[dPIdx]].v[2]) 
```

# php - 如果字段匹配 PHP，则覆盖 JSON

> ID：15297824
> 
> 赞同：0
> 
> 时间：2013-03-08T15:45:26.403
> 
> 标签：php, json, file

我正在尝试写入 json 文件，并且希望能够在某些字段匹配时覆盖对象。现在，我的代码可以获取 JSON 文件中当前的内容，但这只是将最新的对象添加到它的末尾。我需要做的是，如果消息字段匹配，那么我需要用较新的条目替换条目。明白我的意思了吗？

谢谢您的帮助！

**PHP：**

```
$file = file_get_contents('test.json');
$data = json_decode($file);
unset($file);//prevent memory leaks for large json.
//insert data here
$data[] = array("message" => $name, "latitude" => $lat, "longitude" => $lon, "it" => $it);
//save the file
file_put_contents('test.json',json_encode($data));
echo json_encode($data);
unset($data);//release memory 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:54:56.090

您可以使用`array_filter`来查找具有匹配名称的元素并就地更新它。但是，这不会为您删除任何现有的重复项。

```
$datum = array_filter($data, function (&$elem) use ($name, $lat, $lon, $it) {
    if ($elem['message'] === $name) {
       $elem = array('message' => $name /* snip */)
       return true;
    }
});
if (!$datum) { /* append array */ } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:55:18.433

假设我理解正确，您只需要根据`$data`消息检查数组中的两个元素是否相等。最简单的方法是使用数据数组的键，然后将其重置。所以类似于：

```
$file = file_get_contents('test.json');
$data = json_decode($file);
unset($file);//prevent memory leaks for large json.
//insert data here
$data[$message] = array("message" => $name, "latitude" => $lat, "longitude" => $lon, "it" => $it);

//save the file
$data = array_values($data);
file_put_contents('test.json',json_encode($data));
echo json_encode($data);
unset($data);//release memory 
```

这将增加内存消耗，因此您可以使用`md5()`for 键来保持较低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T16:15:32.843

如果您使用 json_decode($string, true)，您将获得关联数组或数值数组。这个数组可以用标准的 php 数组方法来操作。

```
$array = json_decode($string, true);
if(md5($data['message']) != md5($newMessage)) {
    $array['message'] = $newMessage; 
} 
```

我使用了 md5，因为我不知道消息的结构。

# .net - 如何对整个捕获组应用负前瞻？

> ID：15297833
> 
> 赞同：3
> 
> 时间：2013-03-08T15:45:59.707
> 
> 标签：.net, regex, lookahead, regex-lookarounds, negative-lookahead

给定以下正则表达式和主题文本，为什么负前瞻仅适用于命名捕获组的最后一个字符`URL`？

```
// Regex
(?<URL>(?<Protocol>\w+):\/\/(?<Domain>[\w@][\w.:@]+)\/?[\w\.?=%&=\-@/$,]*)(?!'|"|(</a))

// Subject text
<p><a href="http://example.com">http://example.com</a> and http://example.com</p> 
```

这个正则表达式有一个否定的前瞻`(?!"|(</a))`，它试图不匹配`<a>`标签内的 URL。这是通过检查 URL 是否后跟引号 (`'`或`"`) 或结束`</a`标记来完成的。

我得到以下结果

```
http://example.co  
http://example.co  
http://example.com 
```

我预计负前瞻适用于整个捕获组，而不仅仅是最后一个字符。这可能吗？我究竟做错了什么？我希望只匹配`http://example.com`要捕获的最后一个实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T15:56:38.103

因为当负前瞻失败时，量词（以及任何其他可能的）将回溯，直到找到匹配项。

[您可以使用原子组](http://msdn.microsoft.com/en-us/library/bs2twtah%28v=vs.110%29.aspx#nonbacktracking_subexpression) 强制表达式不回溯`(?>expression)`：

```
(?<URL>(?>(?<Protocol>\w+):\/\/(?<Domain>[\w@][\w.:@]+)\/?[\w\.?=%&=\-@/$,]*))(?!'|"|(</a)) 
```

# python - 无限棋盘：康威的人生游戏 - Python

> ID：15297834
> 
> 赞同：0
> 
> 时间：2013-03-08T15:46:04.423
> 
> 标签：python, conways-game-of-life

我被分配了这个项目，说明如下：

> 生命游戏是为一个无限大的网格定义的。在第 2 章中，我们将 Life Grid ADT 定义为使用固定大小的网格，用户可以在其中指定网格的宽度和高度。这足以说明使用二维数组来实现生命游戏。但是完整的实现应该允许无限大小的网格。使用类似于用于实现稀疏矩阵的方法来实现稀疏生命网格 ADT。

老实说，我不太了解这个概念。您能否给我一个外行可以理解的简短描述（如果不是简短的代码）？我会很感激。

稀疏生命网格.py

```
""" My initial GameOfLife code
    Feb 27, 2013
    Sparse Matrix code specially designed for Game of Life
"""
class SparseLifeGrid:

    def __init__(self):
        """
        "pass" just allows this to run w/o crashing.
        Replace it with your own code in each method.
        """
        pass 

    def minRange(self):
        """
        Return the minimum row & column as a list.
        """
        pass

    def maxRange(self):
        """
        Returns the maximum row & column as a list.
        """
        pass 

    def configure(self,coordList):
        pass 

    def clearCell(self,row, col):
        pass 

    def setCell(self,row, col):
        pass 

    def isValidRowCol(val1,val2):
        pass 

    def isLiveCell(self,row, col):
        pass 

    def numLiveNeighbors(self, row,col):
        pass 

    def __getitem__(self,ndxTuple):
        pass 

    def __setitem__(self,ndxTuple, life):
        """
        The possible values are only true or false:
        True says alive, False for dead.
        """
        pass 

    def _findPosition(self,row,col):
        pass 

    def __repr__(self):
        pass 

    def __str__(self):
        """
        This method will only print the non-empty values,
        and a row and column outside the non-empty values.
        """
        pass 

    def evolve(self):
        """
        Return the next generation state.
        """
        pass 

    def hasOccurred(self):
        """
        Check whether  this current state has already occured.
        If not, return False.  If true, return which generation number (1-10).
        """
        pass 

    def __eq__(self,other):
        """
        This is good method if we want to compare two sparse matrices.
        You can just use sparseMatrixA == sparseMatrixB because of this method. 
        """
        pass

    def printLifeGrid(lifeGrid):
        """
        Print a column before and after the live cells
        """
        s=""
        maxRange=lifeGrid.maxRange()
        minRange=lifeGrid.minRange()
        for i in range(minRange[0]-1,maxRange[0]+2):
            for j in range(minRange[1]-1,maxRange[1]+2):
                s+=" "+str(lifeGrid[i,j])
            s+="\n"
        print(s)

class _GoLMatrixElement:
    """
    Storage class for one cell
    """
    def __init__(self,row,col):
        pass 

    def __str__self(self):
        pass 

    def __eq__(self,other):
        pass 
```

这是我的主文件

```
""" Marcus Brown's  initial GameOfLife code
    Feb 27, 2013
"""
from SparseLifeGrid_Key import SparseLifeGrid
import sys

# You'll probably need to add some other stuff like global variables

""" ####################################################
        Don't change anything below this line: readPoints or main
""" ####################################################

def readPoints(lifeGrid):
    """
    Reads the locations of life and set to the SparseMatrix
    """
    print("1\. Enter positions of life with row,col format (e.g., 2,3).")
    print("2\. Enter empty line to stop.")

    life=input()
    coordList=[]
    while life:
        points=life.split(",")
        try:    
            coord=[int(points[0]),int(points[1])]
            coordList.append(coord)
        except ValueError:
            print("Ignored input:" + life+ ", row, col not valid numbers")
        except:
                print("Unexpected error:", sys.exc_info()[0])
        print("added, keep entering or enter empty line to stop.")
        life=input()
    print("Thanks, finished entering live cells")
    lifeGrid.configure(coordList)

def main():
    """
    Runs for ten generations if a stable (repeating) state is not found.
    """
    lifeGrid= SparseLifeGrid()
    readPoints(lifeGrid)
    lifeGrid.printLifeGrid()
    patterns=0
    i=0
    while i <10 and patterns == 0:
        """
        Evolve to the next generation
        """
        lifeGrid.evolve()
        """
        Check whether this generation is a repetition of any of the
        previous states.
        If yes return the previous matching generation (1-10).
        """
        patterns=lifeGrid.hasOccurred()
        if patterns != -1:
            break
        i+=1
        lifeGrid.printLifeGrid()

    if i==10:
        print("No pattern found")
    else: 

        print("Pattern found at: " + str(i)+ " of type: " + str(patterns))

main() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:54:44.910

A sparse matrix is a representation of a matrix where only the locations of values not equal to the default (usually 0) are stored in memory. A simple way to represent such a matrix in Python is to use a dictionary where the key is a tuple of coordinate `(x, y)` and the value is the matrix values.

For example, this matrix:

```
0 0 0 0
0 0 0 0
0 1 0 0
0 0 0 0 
```

could have the following representation:

```
matrix = [[0, 0, 0, 0], [0, 0, 0, 0], [0, 1, 0, 0], [0, 0, 0, 0]]
sparse_matrix = {(1, 2): 1} 
```

and you would access the values like that:

```
for x in xrange(4):
  for y in xrange(4):
      assert matrix[y][x] == sparse_matrix.get((x, y), 0) 
```

This should be enough to get you started. Your exercise want you to wrap such a sparse matrix in a class that will give it the same interface as a traditional matrix.

There are more advanced way to store such [sparse matrix](http://en.wikipedia.org/wiki/Sparse_matrix), each doing a different trade off between complexity, memory usage, ...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-09T00:45:26.317

这是 Python 2.x 中一个简单的基于稀疏矩阵的生命游戏解决方案。您可以将大小设置为系统可以处理的最大大小。它在 x 和 y 方向上环绕：

```
class Cell():
    def __init__(self, x, y, live=True):
        self.x, self.y = x, y
        self.live = live
        self.around = 0

    def __eq__(self, other):
        return (self.x, self.y) == (other.x, other.y)

    def spawn(self):
        self.live = True
        self.around = 0
        return self

class Grid():
    def __init__(self, width, height):
        self.xMax = width
        self.yMax = height
        self.cells = []
        self.deltas = [(-1, -1), (0, -1), (1, -1), (1, 0),
                      (1, 1), (0, 1), (-1, 1), (-1, 0)]

    def tick(self):
        newCells = self.cells[:]
        ''' create potential new cells '''
        for cell in self.cells:
            for dx, dy in self.deltas:
                newCell = Cell((cell.x+dx)%self.xMax,
                               (cell.y+dy)%self.yMax, live=False)
                if newCell not in newCells:
                    newCells.append(newCell)
                newCells[newCells.index(newCell)].around += 1
        ''' spawn new cells for next grid '''
        self.cells = []
        for cell in newCells:
            if (cell.live and cell.around in [2, 3]
            or not cell.live and cell.around == 3):
                self.cells.append(cell.spawn())

    def show(self):
        for y in range(self.yMax):
            print ''.join('X|' if Cell(x, y) in self.cells
                     else ' |' for x in range(self.xMax))
        print 
```

用法：

```
>>> glider = [Cell(2,0), Cell(2,1), Cell(2,2), Cell(1,2), Cell(0,1)]
>>> g = Grid(7, 7)
>>> glider = [Cell(2,0), Cell(2,1), Cell(2,2), Cell(1,2), Cell(0,1)]
>>> g.cells = glider
>>> g.show()
 | |X| | | | |
X| |X| | | | |
 |X|X| | | | |
 | | | | | | |
 | | | | | | |
 | | | | | | |
 | | | | | | |

>>> g.tick()
>>> g.tick()
>>> g.show()
 | |X| | | | |
 | | |X| | | |
 |X|X|X| | | |
 | | | | | | |
 | | | | | | |
 | | | | | | |
 | | | | | | |

>>> g.tick()
>>> g.tick()
>>> g.show()
 | | | | | | |
 | | |X| | | |
 |X| |X| | | |
 | |X|X| | | |
 | | | | | | |
 | | | | | | |
 | | | | | | | 
```

# solr - 是否可以在 geodist 中使用多值字段

> ID：15297835
> 
> 赞同：2
> 
> 时间：2013-03-08T15:46:09.787
> 
> 标签：solr, lucene, geospatial

我在 schema.xml (Solr 4.1) 中有以下字段定义：

```
<field name="locationCoordinates" type="location_rpt" indexed="true" stored="true" multiValued="true" /> 
```

现在我想基本上做以下查询：

过滤坐标是否在地理点的给定距离内（这部分已经工作）并返回到最近点的距离。

或者在现实生活中：

我们有文章。每篇文章都可以在多个商店购买（仅保存为地理位置）（N:N，但我们只有使用 Solr 建模的文章）。现在我想查询给定点范围内的文章，如果它们也返回到该点的距离。

我怎样才能使用 Solr-Queries 实现这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-10T19:27:01.810

如果我理解正确，您需要的是地理排序，对吗？

为了达到同样的效果，您必须使用 Lucene 中的自定义排序功能。

如果按分数、id、字段排序还不够，Lucene 允许您通过提供自己的 FieldComparatorSource 抽象基类的子类来实现自定义排序机制。

脚步：

1) Sort 对象在实例化过程中接受 FieldComparatorSource 类型的实例。

2) 扩展 FieldComparatorSource

3）您必须在 setNextReader() 的 FieldComparatorSource 中使用 FieldCache 加载坐标

4) 对于每个文档，您可以计算与原点的距离并返回 {-1, 0, 1} 之一

实际上，整个示例在以下链接中给出。但是您必须注册免费试用。

[Lucene in Action 2 一书中的自定义排序链接](http://my.safaribooksonline.com/book/web-development/seo/9781933988177/extending-search/ch06lev1sec1)

# database - 数据库中的生日悖论（计算碰撞概率）

> ID：15297838
> 
> 赞同：2
> 
> 时间：2013-03-08T15:46:13.393
> 
> 标签：database, collision-detection, probability, collision, probability-theory

根据`Birthday paradox`：

如果我将它应用于数据库（如果我错了请纠正我）：如果我们需要`UNIQUE`在数据库中存储散列数据并且我们有一个可以生成 365 个唯一散列值的散列算法，则有 50% 的机会发生数据冲突将在前 23 个数据条目后发生，并且在前 75 个数据库条目后发生 99.9%(!) 的冲突几率。

我们的算法可以生成的唯一哈希的数量和数据条目的数量可以呈指数增长，但冲突的概率将保持不变。如果这对吗？

我有一张巨大的交易表（用于电子商务），并且我将“收据”字段设置为唯一。实际的收据号码让我很困扰。

收据编号示例：`BHF2Z47E`仅大写 AZ/0-9，长度为 8 个符号。

**更新：**

[生日悖论](http://en.wikipedia.org/wiki/Birthday_problem)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:55:37.003

The birthday paradox just states that if you randomly generate values in a space of `n`, there is a rapid phase transition from no collisions to collisions when you store `sqrt(n)` values - that's where the probability increases to over 50%.

In your example you have an alphabet of 26 + 10 characters, and 8 digits; so that's `36^8` or about 2.8 trillion possible keys; you can expect to have more than a 50% collision probability after about 1.6 million entries; that's not very good. There is a decent chance of collision at even a fraction of that.

As a comparison, let's say you generated a 160-bit random key for each receipt (`2^160` possible values); then you would need to generate about `2^80` receipts (around `10^24`) to reach the same probability of collision. You could sell your product as a very large company for your whole life and probably still not see any. Another perspective is that your hard disk or computer will fail before you observe a collision.

[The table in this article](http://en.wikipedia.org/wiki/Birthday_problem#Probability_table) gives some concrete numbers for you. For example, with a 256-bit hash value and `10^31` values inserted, you would get a collision probability of `10^-15`. According to that article, that is around the uncorrectable error rate of your hard disk. That's probably the magnitude of what you should be aiming for with your receipts to avoid overwriting them. It's not to hard to make the values just a little bigger.

Of course, this depends on the fact that you seed your PRNG properly with random data; otherwise you could get the same key easily :)

# android - 用gson解析Json不起作用

> ID：15297839
> 
> 赞同：1
> 
> 时间：2013-03-08T15:46:16.923
> 
> 标签：android, json, gson

这是我的 JSON 字符串：

```
[{"BranchID":1,"SecurityCode1":13,"SecurityCode2":14,"PrintHeight":10,"PrintWidth":10,"Active":true}] 
```

这是我用来解析 JSON 的代码：

```
Type t = new TypeToken<List<Setting>>() {
}.getClass();

String json =  ServiceHelper.getJSON(response); 
List<Setting> list = (List<Setting>) gson.fromJson(json, t); 
    //list is null which it souldnt 
```

这是 Setting 类，Entity 是 ORMDroid 实体类：

```
public class Setting extends Entity {

@Column(name = "id", primaryKey = true)
@SerializedName("BranchID")
public int BranchID;

public int securityCodeLPK;
public int securityCodeSDK;

@SerializedName("PrintHeight")
public int PrintHeight;

@SerializedName("PrintWidth")
public int PrintWidth;

@SerializedName("Active")
public String Active;

@SerializedName("SecurityCode1")
public String SecurityCode1;

@SerializedName("SecurityCode2")
public String SecurityCode2;

public Setting(int BranchID, int height, int width, String active, String securityCode1, String securityCode2) {
    super();
    BranchID = BranchID;
    PrintHeight = height;
    PrintWidth = width;
    Active = active;
    SecurityCode1 = securityCode1;
    SecurityCode2 = securityCode2;
}

public Setting () {
    super();
}

} 
```

似乎没问题，但是 gson.FromJson 之后的列表为空。这段代码有什么问题？

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:44:23.037

您应该使用`getType()`而不是`getClass()`.

```
Type t = new TypeToken<List<Setting>>() {}.getType(); 
```

# android - 从对象的arraylist填充listview

> ID：15297840
> 
> 赞同：23
> 
> 时间：2013-03-08T15:46:20.303
> 
> 标签：android, listview, listactivity

我有一个列表活动，它将显示人员姓名和地址列表以及来自对象数组列表的数据。这是到目前为止填充列表视图的方法..

```
private void fillData(ArrayList<Person> messages) {
    //populating list should go here
} 
```

人员类是存储人员的姓名和地址。

```
public class Person {
   String name;
   String address;
} 
```

虽然我的列表视图的列表项由两个文本视图组成，如下所示：

```
<TwoLineListItem xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:minHeight="?android:attr/listPreferredItemHeight"
android:mode="twoLine"
android:clickable="false"
android:paddingBottom="9dp"
android:paddingTop="5dp" >

<TextView
    android:id="@+id/display_name"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginLeft="10dp"
    android:textAppearance="?android:attr/textAppearanceLarge" />

<TextView
    android:id="@+id/display_number"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignLeft="@+id/display_name"
    android:layout_below="@+id/display_name"
    android:textAppearance="?android:attr/textAppearanceSmall" /> 
```

我希望我的列表视图中的每个项目都显示每个人的姓名和地址。有人可以帮忙吗？

提前谢谢，对不起我的英语不好......

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-08T15:55:00.043

**In your activity**

```
AdapterPerson adbPerson;
ArrayList<Person> myListItems  = new ArrayList<Person>();

//then populate myListItems  

adbPerson= new AdapterPerson (youractivity.this, 0, myListItems);
listview.setAdapter(adbPerson); 
```

**Adapter**

```
public class AdapterPerson extends ArrayAdapter<Person> {
    private Activity activity;
    private ArrayList<Person> lPerson;
    private static LayoutInflater inflater = null;

    public AdapterPerson (Activity activity, int textViewResourceId,ArrayList<Person> _lPerson) {
        super(activity, textViewResourceId, _lProducts);
        try {
            this.activity = activity;
            this.lPerson = _lPerson;

            inflater = (LayoutInflater) activity.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        } catch (Exception e) {

        }
    }

    public int getCount() {
        return lPerson.size();
    }

    public Product getItem(Product position) {
        return position;
    }

    public long getItemId(int position) {
        return position;
    }

    public static class ViewHolder {
        public TextView display_name;
        public TextView display_number;             

    }

    public View getView(int position, View convertView, ViewGroup parent) {
        View vi = convertView;
        final ViewHolder holder;
        try {
            if (convertView == null) {
                vi = inflater.inflate(R.layout.yourlayout, null);
                holder = new ViewHolder();

                holder.display_name = (TextView) vi.findViewById(R.id.display_name);
                holder.display_number = (TextView) vi.findViewById(R.id.display_number);

                vi.setTag(holder);
            } else {
                holder = (ViewHolder) vi.getTag();
            }

            holder.display_name.setText(lProducts.get(position).name);
            holder.display_number.setText(lProducts.get(position).number);

        } catch (Exception e) {

        }
        return vi;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T16:13:38.703

这是我对自定义列表适配器问题的解决方案。首先是一个自定义数组适配器：

```
public class MemoListAdapter extends ArrayAdapter<MemoEntry> {

private int layoutResourceId;

private static final String LOG_TAG = "MemoListAdapter";

public MemoListAdapter(Context context, int textViewResourceId) {
    super(context, textViewResourceId);
    layoutResourceId = textViewResourceId;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {
    try {
        MemoEntry item = getItem(position);
        View v = null;
        if (convertView == null) {
            LayoutInflater inflater = (LayoutInflater) getContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

            v = inflater.inflate(layoutResourceId, null);

        } else {
            v = convertView;
        }

        TextView header = (TextView) v.findViewById(R.id.list_memo_item_header);
        TextView description = (TextView) v.findViewById(R.id.list_memo_item_text);

        header.setText(item.getHeader());
        description.setText(item.getValue());

        return v;
    } catch (Exception ex) {
        Log.e(LOG_TAG, "error", ex);
        return null;
    }
} 
```

}

在活动的 onCreate 方法中：

```
adapter = new MemoListAdapter(this, R.layout.list_memo_item_layout); // the adapter is a member field in the activity
setContentView(R.layout.activity_view_memo_layout);
ListView lv = (ListView) findViewById(R.id.view_memo_memo_list);
lv.setAdapter(adapter); 
```

然后我用这样的调用填充适配器：

```
ArrayList<MemoEntry> memoList = new ArrayList<MemoEntry>(); //here you should use a list with some content in it
adapter.addAll(memoList); 
```

因此，为了适应您的解决方案，创建您自己的 customadapter，而不是我的对象 MemoryEntry，使用您的 Person 类。在 getView 方法中，根据您的需要进行更改。这和我正在做的事情差不多，所以不应该太难。

希望这对您有所帮助！

# assembly - Intel X86-64 组装教程或书籍

> ID：15297842
> 
> 赞同：8
> 
> 时间：2013-03-08T15:46:30.257
> 
> 标签：assembly, x86-64, intel

我试图通过示例或一本好书搜索有关英特尔 x64 汇编教程的信息，但我什至在英特尔网站上都没有找到。

所以，你能给我推荐一本好的教程或书吗？我在linux上使用nasm。

谢谢

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-08T17:06:30.320

诚然，您*更喜欢*如何学习编程是个人偏见。

但特别是就汇编语言而言，我发现一种对我来说比阅读指令集参考手册和/或汇编语言书籍（如果存在的话）更有用的方法。

在我尚未使用过的操作系统平台上，我通常要弄清楚组装如何在我尚未使用的操作系统平台上为我未知的新 CPU/CPU 工作是利用开发人员工具链。像那样：

*   为自己的目标 CPU 安装一个（交叉）编译器和反汇编器。`gcc`这些天来，GNU gcc/binutils 无处不在通常意味着`objdump -d`.

*   创建一堆小程序/小段源代码，例如：

```
extern int funcA(int arg);
extern int funcB(int arg1, int arg2);
extern int funcC(int arg1, int arg2, int arg3);
extern int funcD(int arg1, int arg2, int arg3, int arg4);
extern int funcE(int arg1, int arg2, int arg3, int arg4);
extern int funcF(int arg1, int arg2, int arg3, int arg4, int arg5);
extern int funcG(int arg1, int arg2, int arg3, int arg4, int arg5, int arg6);
extern int funcH(int arg1, int arg2, int arg3, int arg4, int arg5, int arg6,
                 int arg7);

int main(int argc, char **argv)
{
    printf("sum of all funcs: %d\n",
        funcA(1) + funcB(2, 3) + funcC(4, 5, 6) + funcD(7, 8, 9, 10) +
        funcE(11, 12, 13, 14, 15) + funcF(16, 17, 18, 19, 20, 21) +
        funcG(22, 23, 24, 25, 26, 27, 28) + funcH(29, 30, 31, 32, 33, 34, 35));
    return 12345;
}
```

*   *使用编译器优化*编译这些并反汇编生成的目标代码。
    代码的结构很简单，足以演示*ABI*的行为方式。*函数调用*，传递*参数*和*返回值*，*管理寄存器空间*wrt。进行函数调用时保留/易失的寄存器。它还将向您展示一些用于初始化常量数据的基本汇编代码，以及诸如堆栈访问和管理之类的“粘合”。

*   将此扩展为简单的 C 语言结构，如循环和`if`/`else`或`switch`语句。始终保留对外部未定义函数的一些调用，因为这样做会阻止编译器优化器抛出所有“测试代码”，并且当您使用`if()`的测试时`switch()`，谓词`argc`（或其他函数参数），因为编译器无法预测（并因此“奇怪地”优化代码的构建块）。

*   扩展它以使用`struct {}`和`class {}`包含不同原始数据类型序列的定义，以了解编译器如何在内存中安排这些，哪些汇编指令用于访问字节/字/整数/长整数/浮点数等。
    所有这些测试您可以故意改变代码（例如，使用与 不同的操作`+`），和/或使代码更复杂，以便更多地了解指令集和 ABI 的特定部分。

完成此操作并查看输出后，找到*Platform ABI*的副本（电子版或非电子版） 。其中包含有关如何完成上述操作/为什么这样做的规则手册，它将帮助您了解为什么这些规则适用于特定平台。了解上述内容至关重要，因为当您编写自己的汇编代码时，您必须将其与其他非汇编代码接口（除非是纯演示）。这就是你需要遵守规则的地方，所以即使你不知道它们，至少知道规则手册在哪里。

只有在那之后，我才建议您实际跟踪特定平台的指令集参考。

那是因为当你首先经历了上述内容时，你已经获得了足够的经验/你已经看到了足够的经验，可以从一个小的 C 程序开始，将其编译为汇编源代码，稍作修改，汇编并链接它，然后看看你的修改是否做了它应该做的事情。

在那个阶段尝试使用一些更不常见/专门的指令会容易得多，因为您已经了解了函数调用的工作原理，需要什么样的胶水代码才能将您的程序集与程序的其他部分接口，您'已经使用过工具链，因此您不再需要完全从头开始。

即，总而言之，我的建议是*从上到下*而不是*自下而上*学习组装。

**边注：**

为什么我建议在为这些简单示例分析编译器生成的汇编代码时使用*编译器优化？*
好吧，答案是因为，与某些人的直觉相反，生成的汇编代码*要简单得多*如果你让编译器优化一切。如果没有优化，编译器通常会创建“愚蠢”的代码，例如将所有变量放入堆栈，从那里保存和恢复它们，你看不到任何原因，寄存器保存/恢复/初始化只是为了覆盖该 reg 下一条指令和许多更多这样的事情。因此，发出的代码量要大得多。它充满了杂乱无章，更难理解。编译器优化会强制将这些杂乱无章的东西精简到最本质的部分，这是您想要了解的平台 ABI 和汇编的内容。因此，使用编译器优化。

# php - Wordpress - 在数据库中保存数据

> ID：15297846
> 
> 赞同：-1
> 
> 时间：2013-03-08T15:46:35.480
> 
> 标签：php, wordpress

你会怎么做：

*   您在站点中有一个输入字段，要求输入电子邮件地址（例如订阅时事通讯）
*   您想将引入的数据保存在 DB 中（最好在新表中），并且希望在新页面的管理区域中显示它

做这个的最好方式是什么？值得为此做一个插件吗？每一个想法都值得赞赏！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:49:08.930

使用重力形式。它是有史以来最好的插件之一。[http://www.gravityforms.com/](http://www.gravityforms.com/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:52:31.920

我不会创建一个新表，而是将数据保存在`wp_options`或者，如果您想收集电子邮件，只需将它们保存为`custom post type`可能。

无论如何，如果您真的想使用自己的表，请查看[`$wpdb`global](http://codex.wordpress.org/Class_Reference/wpdb)，它提供了一种与数据库交互的简单且安全的方式。首先使用该`prepare`方法创建您的查询，然后使用该`query`方法执行它。

# java - JCS编辑磁盘辅助缓存DiskPath

> ID：15297855
> 
> 赞同：5
> 
> 时间：2013-03-08T15:46:56.403
> 
> 标签：java, caching, jcs

我正在开发一个带有 JCS 1.3 缓存的 Web 应用程序。

我需要在运行时从 JVM 属性编辑索引磁盘辅助缓存的 DiskPath。

你知道这样做的方法吗？

我设法创建了 AuxiliaryCache 对象，但我不知道如何将它与我在 cache.ccf 中定义的所有区域连接起来。

这是创建磁盘缓存的代码：

```
IndexedDiskCacheAttributes indexedCacheAttr = new IndexedDiskCacheAttributes();

indexedCacheAttr.setMaxKeySize(10000);
indexedCacheAttr.setMaxRecycleBinSize(10000);
indexedCacheAttr.setMaxPurgatorySize(10000);
indexedCacheAttr.setOptimizeAtRemoveCount(5000);

String cacheDir = System.getProperty("xxxxx");

if (cacheDir == null || cacheDir.trim().length() == 0) {
log.error("error:JCSManager xxxx.");
} else {          
indexedCacheAttr.setDiskPath(cacheDir);
}

IndexedDiskCacheManager indexedCacheManager = 
IndexedDiskCacheManager.getInstance(indexedCacheAttr); 

// instance du cache disque 
AuxiliaryCache auxCache = indexedCacheManager.getCache(region); 
```

要获得一个区域，我使用以下内容：

```
JCS cache = JCS.getInstance(region); 
```

请给个主意？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-11T08:52:49.157

我们最终从 Web 应用程序的类路径中提取了 JCS conf 文件 (cache.ccf)。

我为这个文件添加了一个 JVM 属性。在访问 JCS 区域之前，我会加载属性，然后使用 CompositeCacheManager 类来配置 JCS。

```
String jcsConfFile = System.getProperty("XXXXXX");

if (jcsConfFile == null || jcsConfFile.trim().length() == 0) {
  log.error("error:JCSManager .........");
} else {
  Properties props = new Properties();

  try {
    // load a properties file
    props.load(new FileInputStream(jcsConfFile));
  } catch (IOException e) {
    log.error("error:JCSManager ........", e);
  }

  CompositeCacheManager ccm = CompositeCacheManager.getUnconfiguredInstance();

  ccm.configure(props);
}

//....
// later, ask for the region
JCS cache = JCS.getInstance(region); 
```

[解决方案的来源](https://stackoverflow.com/questions/10733681/how-to-change-jcs-cache-ccf-files-path)

# asp.net - 数据绑定 - 数据绑定控件

> ID：15297860
> 
> 赞同：0
> 
> 时间：2013-03-08T15:47:18.300
> 
> 标签：asp.net, .net, vb.net, entity-framework-4.1

我有一个详细信息视图，并且我将一个特定字段转换为我正在使用下拉列表的模板。现在我创建了另一个下拉列表来过滤详细信息视图中的下拉列表，但是我收到错误消息。

> Eval()、XPath() 和 Bind() 等数据绑定方法只能在数据绑定控件的上下文中使用。

```
 <InsertItemTemplate>
                                    <asp:DropDownList ID="DropDownList12" runat="server" DataSourceID="ddd" 
                                         DataTextField="FullName" DataValueField="Emp_id"
                                         SelectedValue='<%# Bind("Employee_Personal_InfoEmp_id") %>' 
                                        AutoPostBack="True">
                                    </asp:DropDownList>
                        </InsertItemTemplate> 
```

更改数据源从而启用过滤的方法

```
Protected Sub Button1_Click(ByVal sender As Object, ByVal e As EventArgs) Handles Button1.Click
    Dim ddl5 As DropDownList = DetailsView1.FindControl("DropDownList12")
    ddl5.DataSourceID = ""
    ddl5.DataSource = FilterDataSource
    ddl5.DataBind()
End Sub 
```

如果我起飞

```
 **SelectedValue='<%# Bind("Employee_Personal_InfoEmp_id") %>'** 
```

过滤器会起作用。有什么解决方法吗？我需要绑定。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:58:33.023

为了让它以您想要的方式工作，您将需要在 itemDataBound 事件中找到控件，然后创建一个事件处理程序以分配给 itemdataBound 事件中下拉框 ctl 的地址。

# java - 将多个正则表达式组合成一个自动机

> ID：15297863
> 
> 赞同：11
> 
> 时间：2013-03-08T15:47:27.977
> 
> 标签：java, regex, automaton

假设我有一个正则表达式列表（从外部源读取 - 文件、数据库等）。我想检查字符串匹配这些正则表达式中的哪一个。

我可以创建遍历所有这些正则表达式并匹配它们，但列表可能很大，这是一个关键操作。

我可以将所有这些正则表达式组合成一个（在它们之间有 |），但问题是我只能识别第一个匹配的正则表达式，而不是全部。

另一个想法可能是为所有这些正则表达式创建一个自动机，并用相应的正则表达式的索引来标记最终状态。我正在查看[http://cs.au.dk/~amoeller/automaton/](http://cs.au.dk/~amoeller/automaton/)，一个似乎能够使用正则表达式和自动机的库，但不确定它是否可以扩展来解决我的问题。

你还有其他建议吗？

为了澄清一些评论，我添加了一个代码示例：

```
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class PatternTest {
    public static void main(String[] args) {
        Pattern p = Pattern.compile("(a(?:b|c)a)|((?:a|b)ba)|(ab(?:a|c))");     
        Matcher m = p.matcher("aba");
        System.out.println(m.matches());
        System.out.println(m.groupCount());
        for (int i = 0, n = m.groupCount(); i < n; i++) {
            System.out.println(m.group(i));
        }
    }
} 
```

将打印出来

```
true
3
aba
aba
null 
```

如您所见，只有第一组匹配，而我看不到匹配其他两组的方法。

更多发现 - 使用上面的自动机库，问题将简化为：如果连接两个或多个自动机，如何识别最终状态与原始自动机中的哪一个对应？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-10-20T17:14:57.097

我基于 dk.brics.automaton 实现了这样一个解决方案，你可以在这里找到它。 [https://github.com/fulmicoton/multiregexp](https://github.com/fulmicoton/multiregexp)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-09T15:12:05.150

对于明确的答案（如果有的话），我们需要更多信息，例如：

1.  你说正则表达式的列表很大；你可以说得更详细点吗？数千？百万？数十亿和数十亿？

2.  谁编写了这些正则表达式，他们知道自己在做什么吗？正则表达式在添加到列表之前是否经过彻底测试（正确性**和性能）？**

3.  在您的示例代码中，您使用该`matches()`方法，该方法需要正则表达式来描述整个字符串。就好像正则表达式确实
    `\A(?:(a(?:b|c)a)|((?:a|b)ba)|(ab(?:a|c)))\z`
    匹配`"aba"`但不匹配`"aaba"`or `"abaa"`。如果您在使用 Java 之前在其他工具或语言中使用过正则表达式，那么这种行为可能会让您感到惊讶。传统上，如果正则表达式描述字符串中的任何子字符串，甚至是零长度子字符串，则字符串总是被称为“匹配”正则*表达式*。要在 Java 中获得这种行为，您必须使用 Matcher 的`find()`方法。

4.  您是否可以从列表中的所有正则表达式中提取任何共同因素，例如最小或最大长度、公共子字符串或共享字符子集？例如，与您的示例模式之一匹配的任何字符串也必须匹配`[abc]{3}`。如果有，您可能希望基于它们创建过滤器（可能是正则表达式，也可能不是），以便在严重匹配开始之前运行。（如果您使用的是 Perl，我不建议这样做，它是 choc-a-bloc 已经进行了类似的优化，但 Java 并不太自豪接受一点帮助。☺）

但我觉得建议您使用单独的正则表达式而不是将它们全部连接成一个非常安全。Frankenregex 不一定会表现得更好，而对其进行故障排除将是一场噩梦！您可以预编译所有 Pattern 对象，并且可以提前创建一个 Matcher 对象并将其重用于所有匹配项，如下所示：

```
m.reset(s).usePattern(p); 
```

这是一个[**演示**](http://ideone.com/icjxW9)。我无法做出任何保证（一方面，你仍然受制于编写正则表达式的人），但如果解决方案可行，我认为这是最有希望的方法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-09T15:24:18.167

[dk.brics.automaton](http://www.brics.dk/automaton/)不直接支持这一点，但您可以概括自动机的表示（以及相关的自动机操作）以区分不同种类的接受状态。例如，首先将一个 int 字段添加到[State](https://github.com/cs-au-dk/dk.brics.automaton/blob/master/src/dk/brics/automaton/State.java)类，并在设置了“accept”时使用此字段。

# qt5 - QT5如何安装QT3d？

> ID：15297870
> 
> 赞同：6
> 
> 时间：2013-03-08T15:47:35.810
> 
> 标签：qt5, qt3d

我正在尝试在 Qt5 上安装 Qt3d。当我安装 QT5 时，在安装文件夹中有一个 src 文件夹。在此文件夹中，存在 qt3d 库。

如果我理解正确，我必须构建它才能使用各种头文件。

但我想要最新的消息来源。因此，为了下载 qt3d 的源代码以使用 QT5 构建，我单击此[https://qt.gitorious.org/qt/qt3d](https://qt.gitorious.org/qt/qt3d)上的 master然后我下载 master.tar.gz，我将其保存在我所在的文件夹中想要构建 qt3d 库。

然后我按照使用 QT sdk[页面](http://doc-snapshot.qt-project.org/qt3d-1.0/qt3d-building.html)构建 qt3d 上给出的所有步骤单击构建时，出现以下错误

```
16:28:14: Running steps for project qt3d...
16:28:14: Starting: "C:\Qt\Qt5.0.1\5.0.1\msvc2010\bin\qmake.exe" C:\libraries\qt3d\qt-qt3d_tdk\qt3d.pro -r -spec win32-msvc2010 "CONFIG+=debug"Reading C:/libraries/qt3d/qt-qt3d_tdk/src/src.pro [C:/libraries/qt3d/Debug/src]
Reading C:/libraries/qt3d/qt-qt3d_tdk/src/threed/threed.pro [C:/libraries/qt3d/Debugsrc/threed]
'perl.exe' is not recognized as an internal or external command,operable program or batch file.
Project MESSAGE: C:\Qt\Qt5.0.1\5.0.1\msvc2010\bin\syncqt.bat -module Qt3D-mkspecsdirC:\Qt\Qt5.0.1\5.0.1\msvc2010/mkspecs -outdir C:/libraries/qt3d/Debug /librariesqt3d/qt-qt3d_tdk
Project ERROR: Failed to run: C:\Qt\Qt5.0.1\5.0.1\msvc2010\bin\syncqt.bat -module Qt3D -mkspecsdir C:\Qt\Qt5.0.1\5.0.1\msvc2010/mkspecs -outdir C:/libraries/qt3d/Debug C:/libraries/qt3d/qt-qt3d_tdk
16:28:15: The process "C:\Qt\Qt5.0.1\5.0.1\msvc2010\bin\qmake.exe" exited with code 3.Error while building/deploying project qt3d (kit: Desktop Qt 5.0.1 MSVC2010 32bit) 
```

执行步骤“qmake”时

我感到困惑的是，为什么在 src.pro 和 threed.pro 中都找不到文件 perl.exe 时，编译器会说 perl.exe 无法识别。perl 是如何出现的。

另外，我使用的是 master.tar.gz，因为如果我尝试使用 GIT gui 使用克隆存储库，它会显示一条错误消息，指出该目录存在。老实说，我完全迷失了所有这些 GIT 的东西。

任何建议都会有所帮助。

提前谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-18T21:18:37.153

我整天在互联网上搜索有关在 Windows 上安装插件以安装 QT 的帮助，而无需从源代码重新编译 QT。我已经开始工作了（无论如何，到目前为止。我只测试了一个示例，它运行并加载了 gui 没有任何错误）这是使用 qtlocation 但我正在 quessing qt3d 是相同的过程。搏一搏。

要求：获取并安装最新版本的 QT（我使用的是 QT 5.1.1（Mingw32 位），但我确信这适用于 VSS 安装 perl（我安装了 Activeperl 5.18 64 位）获取一个 git 客户端（我在我的 MAC 上使用了客户端） (XCODE))

==使用 Git 客户端获取完整的 Git 克隆存储库。[从https://qt.gitorious.org/qt/qtlocation](https://qt.gitorious.org/qt/qtlocation)下载的存档不会这样做，它不包括所有需要的文件 == **sudo git clone git://gitorious.org/qt/qtlocation.git** 这应该下载到名为 qtlocation 的目录 将下载的 GIT Flat 文件复制到您的 Windows 操作系统（例如复制到 C:\qtlocation）

==在您的 Windows 操作系统上 === 从 Windows。将 Perl 路径添加到 QT 命令行。我通过编辑 C:\Qt\Qt5.1.1\5.1.1\mingw48_32\bin\qtenv.bat 并将以下内容添加到路径 C:\Perl64\site\bin;C:\Perl64\bin; 来做到这一点 所以它读取 set PATH=C:\Perl64\site\bin;C:\Perl64\bin;C:\Qt\Qt5.1.1\5.1.1\mingw48_32\bin;C:\Qt\Qt5.1.1/Tools/ mingw48_32\bin;%PATH%

（后来 mingw32-make.exe 需要 perl）。

现在通过转到 **开始 -> 所有程序 -> -> -> -> Qt 5.1.1 for Desktop（MinGw 版本）启动 Qt 5.1.1 for Desktop，使用 QT 路径启动命令提示符**

将 CD 放入您将 qtlocation git 文件放入的文件夹中，例如**cd c:\qtlocation** 然后运行

**qmake**

在这次运行之后

**mingw32-make.exe**

这将需要几分钟才能完成。此时 .dll 被编译。

===让 QT 识别 DLL=== 我确信可能有一个更简单的过程，但我将文件复制到我认为可能需要它们的位置。我通过在安装 QT 5.1.1 期间首先安装“插件”来做到这一点。（一个示例插件是 qtsensor - 但您不需要这样做）。这样我就可以看到传感器插件自己安装的所有文件夹然后我进入了我的 qt mingw 文件夹中的每个文件夹。

例如 C:\Qt\Qt5.1.1\5.1.1\mingw48_32 和任何我看到对传感器插件的引用的地方，我都将类似的文件从 qtlocation 文件夹复制到其中。基本上我复制了以下内容（您可以在命令提示符下执行此操作）

复制 C:\qtlocation\include\QtPositioning C:\Qt\Qt5.1.1\5.1.1\mingw48_32\include 复制 C:\qtlocation\examples*.* C:\Qt\Qt5.1.1\5.1.1\mingw48_32\示例复制 C:\qtlocation\mkspecs\modules*.* C:\Qt\Qt5.1.1\5.1.1\mingw48_32\mkspecs\modules 复制 C:\qtlocation\plugins\position C:\Qt\Qt5.1.1\5.1 .1\mingw48_32\plugins 复制 C:\qtlocation\lib\cmake\Qt5Positioning C:\Qt\Qt5.1.1\5.1.1\mingw48_32\lib\cmake 复制 C:\qtlocation\lib\pkgconfig*.* C:\ Qt\Qt5.1.1\5.1.1\mingw48_32\lib\pkgconfig 复制 C:\qtlocation\lib*.a C:\Qt\Qt5.1.1\5.1.1\mingw48_32\lib 复制 C:\qtlocation\lib*. prl C:\Qt\Qt5.1.1\5.1.1\mingw48_32\lib 复制 C:\qtlocation\lib*.dll C:\Qt\Qt5.1.1\5.1.1\mingw48_32\bin

就是这样。我确定我不需要复制上面所做的所有文件，但我认为 Id 是彻底的，而不是反复试验来找出需要的文件。

在此之后，Fireup QT。并加载 qtlocation 附带的示例之一。

PS 使用 VSS 来做到这一点，我想你会换成“mingw32-make.exe”“nmake install”？？我认为。

我猜上述过程也适用于 QT 的任何插件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:51:22.257

您还需要遵循[从 Git 构建 Qt5](http://qt-project.org/wiki/Building_Qt_5_from_Git "从 Git 构建 Qt 5")的说明。Qt5 源代码构建的配置步骤需要 Perl，这是通过 Perl 脚本完成的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-11-07T15:37:22.930

我想补充一点，因为我比 thedorkknight 走得更远，但仍然有问题。在我安装 ActivePerl 并将 perl bin 目录添加到我的 %PATH% 之后，我能够从源代码构建 Qt3D 存储库（使用 QtCreator）。我现在遇到问题的部分是“make install”部分。我尝试手动将文件复制到我的 Qt 目录并从头开始构建 qmldir 文件，它使 QtCreator “看到” Qt3D 库，但它仍然拒绝加载 .dll。错误说：

```
C:/Qt/5.1.1/msvc2010/qml/Qt3D/qthreedqmlplugin.dll: The specified module could not be found. 
```

我安装了 MinGW 并尝试从构建目录执行“mingw32-make install”，但失败了。即使那个文件肯定在那里。还有什么想法吗？或者其他让 Qt3D 在 Windows 中工作的途径？

编辑：我发现，因为我使用 MSVC 作为编译器，所以我还需要使用 Visual Studio 命令提示符并使用 nmake install，而不是按照 Linux 的 Qt3D 安装说明进行 make install。现在它起作用了！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-01-10T17:12:55.830

我从这个链接按照以下步骤操作：http: [//qt-project.org/forums/viewthread/38263](http://qt-project.org/forums/viewthread/38263)

这是该页面的摘录

> 终于，我成功了！所以，首先我下载了​​最新版本的 Qt，Qt 5.2.1 我使用 git 客户端从 git 存储库下载了 Qt3D 的源代码到文件夹“C:\qt3d”，终端为“Qt 5.2.1 for Desktop (MinGW) 4.8 32 位）” cd C:\qt3D qmake mingw32-make.exe 安装
> 
> “安装”很重要，以便将所有文件复制到 Qt 配置文件夹中。然后，在 .pro 文件中，添加 QT += 3d 并在 main.qml 文件中： import QtQuick 2.0 import Qt3D 2.0 import Qt3D.Shapes 2.0

我遇到麻烦的主要原因是我使用 git 中的下载按钮下载了 Qt3D。但是，这会将源文件复制到适当的文件中。所以最好使用 git 客户端使用 - git clone 下载源代码。

# ios - 正确：返回 nil 的有效数据？

> ID：15297872
> 
> 赞同：0
> 
> 时间：2013-03-08T15:47:37.370
> 
> 标签：ios, objective-c

需要澄清：我写了这个类方法来加载图像。如果图像不存在，是返回`nil`处理返回值的方式还是返回未初始化的`UIImage`（仍然为零但更清晰）更清晰？

```
+ (UIImage*)loadImageByName:(NSString*)name
{
    NSString *documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString *imagePath = [documentsPath stringByAppendingPathComponent:name];
    BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:imagePath];

    if (fileExists){
        UIImage* tmpImage = [UIImage imageWithContentsOfFile:imagePath];
        return tmpImage;
    }
    return nil;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:54:31.427

返回 nil，这是表示操作无法完成的正确方式……那么下面的代码就起作用了：

```
UIImage * someImage;
if ((someImage = [YourClass loadImageByName:@"donkey"]))
{
//do something
}else{
//failure
} 
```

如果你愿意，你也可以包括一些反馈

```
+ (UIImage*)loadImageByName:(NSString*)name error:(NSError **)err
{
    NSString *documentsPath = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
    NSString *imagePath = [documentsPath stringByAppendingPathComponent:name];
    BOOL fileExists = [[NSFileManager defaultManager] fileExistsAtPath:imagePath];

    if (fileExists){
        UIImage* tmpImage = [UIImage imageWithContentsOfFile:imagePath];
        return tmpImage;
    }else{
        if(err)
         {
             *err = [NSError someErrorMethodHere...];
         }
    }
    return nil;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:56:16.540

这很正常。许多 Foundation 和 UIKit 方法都是这样做的。只需记录该方法在出错时返回`nil`. [`NSData dataWithContentsofFile:`例如](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSData_Class/Reference/Reference.html)。

作为建议，为了防止可能出现目录，您可以使用此方法（[ref](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSFileManager_Class/Reference/Reference.html)）：

```
- (BOOL)fileExistsAtPath:(NSString *)path isDirectory:(BOOL *)isDirectory; 
```

前任：

```
BOOL isdir;

if ( [[NSFileManager defaultManager] fileExistsAtPath:imagePath isDirectory:&isdir] && (! isdir) )
    // file exists and not a directory
else
    // handle error like mentioned in another answer 
```

# validation - LiveCode 字段级输入验证

> ID：15297875
> 
> 赞同：4
> 
> 时间：2013-03-08T15:48:00.093
> 
> 标签：validation, livecode

在桌面应用程序的某些字段中键入时，如何将用户输入限制为仅数字（允许小数）？

〜罗杰

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T22:17:51.650

请注意，本的回答并不涵盖所有情况

*   不允许负数
*   未检测到您键入“。”的情况 并且已经有一个尾随的“。” 在该领域
*   不处理粘贴到字段中。

你可以做所有这些

```
local sExisting

on openfield
   put the text of me into sExisting
end openfield

on textChanged
   put the selectedText && sExisting && the text of me into msg
   if the text of me is a number or me is empty then
      put the text of me into sExisting
   else
      put sExisting into me
   end if
end textChanged 
```

NB - 如果您键入无效字符，输入光标将移动到行首；如果您想做任何不同的事情，那么您可以锁定屏幕（作为“textChanged”中的第一个操作）并在完成后解锁。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-08T15:57:44.700

每次用户按下一个键时，都会向您的字段发送一个 keydown 消息：

```
on keydown pKey
  -- check the input --
  -- pass on the keydown message --
end keydown 
```

添加以下代码以检查键入的键是否为“。”的数字。并且该字段尚未包含“。”：

```
on keydown pKey
   if pKey is a number then 
      pass keydown
   else if pKey is "." then
      set the itemdel to "."
      if the number of items of me < 2 then
         pass keydown
      end if
   end if
end keydown 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-09T20:02:55.910

亚历克斯，我喜欢你的剧本，但它也没有涵盖所有情况。如果您想输入负数（如果您在空白字段中以“-”符号开头），则它不起作用。所以下面是更正的脚本，我希望这次涵盖所有情况，但是如果您输入不允许的字符，它会丢失选择（还有一些事情要做）。

```
local sExisting, sSelected

on openfield
   put the text of me into sExisting
end openfield

on textChanged
   --put the selectedText && sExisting && the text of me into msg
   put the selectedChunk into sSelected
   if the text of me is a number or me is empty or me is "-" then
      put the text of me into sExisting
   else
      put sExisting into me
   end if
   select sSelected
end textChanged 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-10T18:13:02.703

我发现将其添加为单独的答案比编辑我之前的答案更容易并且可能更好。这需要 Marek 的改进，增加了一个领先的“。”。并且通常还允许前导和尾随空格，而不是仅在输入数字之后。

它还会在尝试键入或粘贴其他字符失败后恢复选择/插入点（选择无法完全恢复，但插入点应始终在任何先前选择之后立即完成。

请注意，我们肯定会以易于理解为代价换取更多的完整性......

我们仍然没有完全涵盖插入科学记数法（例如 1.2e34）的情况，因为在这种情况下**最终**值是有效的，但中间状态之一（1.2e）不是。

```
local sExisting

on openfield
   put the text of me into sExisting
end openfield

on textChanged
   local tMe, tChunk, tDeltaLength, tWhere
   put the selectedChunk of me into tChunk
   put word 1 to -1 of the text of me into tMe    -- strip leading/trailing spaces
   if tMe is a number or tMe = "-" or tMe = "." or tMe is empty then
      put the text of me into sExisting
   else
      -- calculate how many characters were inserted, 
      --      and move the insertion point back to there
      put the number of chars in me - the number of chars in sExisting into tDeltaLength
      put sExisting into me
      put word 4 of tChunk - tDeltaLength into tWhere
      put tWhere into  word 4 of tChunk
      put tWhere into  word 2 of tChunk
      do ("select after " & tChunk & " of me")
   end if
end textChanged 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-17T07:01:39.540

使用“是一个数字”怎么样？唯一的特殊情况是您需要在开头允许“-”：

```
on KeyDown theKey
   if (the text of me & theKey) is a number then
      pass keyDown
   else if the text of me is empty and theKey is "-" then
      pass keyDown
   end if
end KeyDown 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-22T16:55:02.137

亚历克斯，

如果出现以下情况，您的脚本将无法正常工作：

1.  您在输入开始时输入“-”符号（当字段为空且没有任何数字时）
2.  正如你提到的，当输入无效字符时，输入光标移动到行首

请检查：

```
local sExisting, sSelected, sSelected1

on openField
   put the text of me into sExisting
end openField

on selectionChanged
   put the selectedChunk into sSelected1
   put "sSelected1: " & sSelected1 into line 1 of msg
end selectionChanged

on arrowKey
   send "selectionChanged" to me in 0
   pass arrowKey
end arrowKey

on textChanged
   local tMinus, tDot
   put empty into tDot
   put empty into tMinus
   --
   put the selectedChunk into sSelected
   put "sSelected: " & sSelected into line 2 of msg
   --
   get matchChunk (me, "^(-?)[0-9]*(\.)?([0-9]*)$", tMinus, tMinus, tDot, tDot)
   if it then
      switch tDot
         case 2
            if tMinus = 1 then put "-0." & char 3 to -1 of me into me  
            put (word 2 of sSelected) + 1 into word 2 of sSelected
            put (word 4 of sSelected) + 1 into word 4 of sSelected             
            break
         case 1
            put "0." & char 2 to -1 of me into me
            put (word 2 of sSelected) + 1 into word 2 of sSelected
            put (word 4 of sSelected) + 1 into word 4 of sSelected
            break
         default
      end switch
      send "selectionChanged" to me in 0
      put me into sExisting
   else
      if not (me is empty) then
         put sExisting into me
         put sSelected1 into sSelected
      end if
   end if
   select sSelected
end textChanged 
```

它可能并不完美，但粘贴后的选择和任何字符输入（甚至不允许）应该是正确的。您可以从“-”或“.”开始输入。此外，使用“自动更正” - 如果您键入“.34”或“-.34”，您将被更正为“0.34”或“-0.34”。

您可以通过箭头更改光标位置，粘贴不允许的字符串后，它不会更改光标位置。粘贴正确的字符串后，新的光标位置在粘贴字符串的末尾。

已知错误我不喜欢缺少删除前导零（可能也应该删除尾随）。

如果您发现一些错误，请告诉我，所以我会尝试修复它（很高兴）。脚本有点长，昨天看到了一些bug，不过这几天没时间，所以决定放在那里让别人玩。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-12-08T19:41:22.047

这实际上比看起来更棘手。但这有效：

```
on keyDown pKey
   if pKey = "-" and me  <> "" then exit keyDown
   if pKey = "." and "." is in me then exit keyDown
   if pKey is in "-0123456789."  then pass keydown
end keyDown 
```

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2016-12-08T15:55:17.227

这也可以工作：

如果 pKey 在“0123456789”字符中，则在 KeyDown pKey 上。并且（我的长度）< 15 然后通过 keyDown end Keydown

# c# - c# 正则表达式模式

> ID：15297880
> 
> 赞同：1
> 
> 时间：2013-03-08T15:48:22.470
> 
> 标签：c#, regex

类似于我昨天的问题： [C# Regex Pattern Conundrum](https://stackoverflow.com/questions/15275688/c-sharp-regex-pattern-conundrum)

同样的问题，不同的正则表达式模式。[在http://sourceforge.net/projects/regextester/](http://sourceforge.net/projects/regextester/)和[http://www.RegexLib.com](http://www.RegexLib.com)中测试时，正则表达式模式返回所需的匹配 但是，当在 .NET 中执行模式时，没有返回匹配。

```
string SampleText = @"\r\n99\. Sample text paragraph one.\r\n100\. Sample text here paragraph two.\r\n101\. Sample text paragraph three.\r\n";
string RegexPattern = @"(?<=\\r\\n\d+\.\s)([^.]+?)here.*?(?=\\r\\n)";
Regex FindRegex = new Regex(@RegexPattern, RegexOptions.Multiline | RegexOptions.Singleline);
Match m = FindRegex.Match(SampleText); 
```

所需的匹配项是“此处的示例文本第 2 段”。

和昨天一样，我不确定问题是我的正则表达式模式还是我的代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T15:51:08.333

您还需要转义特殊的正则表达式字符：

```
string RegexPattern = @"(?<=\\r\\n\d+\.\s)([^.]+?)here.*?(?=\\r\\n)"; 
```

或者：

```
string RegexPattern = "(?<=\\\\r\\\\n\\d+\\.\\s)([^.]+?)here.*?(?=\\\\r\\\\n)"; 
```

不要忘记 - 您处于 C# 字符串上下文中，因此您需要确保将正确的字符串传递给正则表达式引擎。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:13:14.177

我想到了。

在 RegexTester 和 RegexLib.com 中进行测试时，我从立即窗口复制并粘贴了我的源文本，该窗口将控制返回换行符转换为它们的文本表示形式 \r\n。

所以，我的正则表达式在测试环境中工作。但是，在实际运行时，源文本包含控制返回换行符，而不是 \r\n 作为文本。这就解释了为什么我的模式在测试环境中有效，但在运行时无效。

我改变了我的模式`@"(?<=\n\d+\.\s)([^.]+?)here.*?(?=\n)"`，它工作得很好。

尴尬的实现。感谢您的帮助奥德。

# sed - 用 sed 替换，但只保留部分行

> ID：15297883
> 
> 赞同：1
> 
> 时间：2013-03-08T15:48:25.453
> 
> 标签：sed

我想为 sed 运行就地命令以仅在文件中保留某些行。`-i`这与使用带有替换命令的 sed 用于就地替换文件行的通常用法不同。例如，假设我有这个文件：

```
> cat file.txt
fox
rabbit
fox
fox
wolf 
```

我只想保持与狐狸匹配的线条。我的想法是：

`sed -inr '/fox/p' file.txt`

但这并没有按预期工作。我错过了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-09T15:36:40.917

您错过了“-i”采用可选参数的事实，因此-inr 与-i -n -r 不同，它与-i“nr”相同。尝试：

```
sed -i -nr '/fox/p' file 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:57:16.663

试试这一行：

```
sed -i '/fox/!{s/.//g}' file 
```

这将通过不删除它们来**清空**那些不匹配的行。因此，`fox`线路停留在他们的位置。

如果您只想删除那些不匹配的行：

```
sed -i '/fox/!d' file 
```

# c# - 使用表达式树构造 LINQ GroupBy 查询

> ID：15297884
> 
> 赞同：8
> 
> 时间：2013-03-08T15:48:26.153
> 
> 标签：c#, linq, expression-trees

我在这个问题上坚持了一周，没有找到解决方案。

我有一个如下所示的 POCO：

```
public class Journal {
    public int Id { get; set; }
    public string AuthorName { get; set; }
    public string Category { get; set; }
    public DateTime CreatedAt { get; set; }
} 
```

我想知道在特定日期范围内（按月或年分组）按作者姓名或类别计算的期刊数量。

在我将查询的对象发送到 JSON 序列化器之后，然后生成如下 JSON 数据（只是使用 JSON 来演示我想要获取的数据，如何将对象序列化为 JSON 不是我的问题）

```
data: {
    '201301': {
        'Alex': 10,
        'James': 20
    },
    '201302': {
        'Alex': 1,
        'Jessica': 9
    }
} 
```

或者

```
data: {
    '2012': {
         'C#': 230
         'VB.NET': 120,
         'LINQ': 97
     },
     '2013': {
         'C#': 115
         'VB.NET': 29,
         'LINQ': 36
     }
} 
```

我所知道的是以“方法方式”编写一个 LINQ 查询，例如：

```
IQueryable<Journal> query = db.GroupBy(x=> new 
    {
        Year = key.CreatedAt.Year,
        Month = key.CreatedAt.Month
    }, prj => prj.AuthorName)
    .Select(data => new {
        Key = data.Key.Year * 100 + data.Key.Month, // very ugly code, I know
        Details = data.GroupBy(y => y).Select(z => new { z.Key, Count = z.Count() })
    }); 
```

按月或年、AuthorName 或Category 分组的条件将通过两个字符串类型的方法参数传递。我不知道如何在 GroupBy() 方法中使用“魔术字符串”参数。经过一番谷歌搜索，似乎我无法通过传递像“AuthorName”这样的魔术字符串来对数据进行分组。我应该做的是构建一个表达式树并将其传递给 GroupBy() 方法。

任何解决方案或建议都值得赞赏。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-03-08T18:09:19.330

哦，这看起来是个*有趣*的问题：）

所以首先，让我们设置我们的人造源，因为我手边没有你的数据库：

```
// SETUP: fake up a data source
var folks = new[]{"Alex", "James", "Jessica"};
var cats = new[]{"C#", "VB.NET", "LINQ"};
var r = new Random();
var entryCount = 100;
var entries = 
    from i in Enumerable.Range(0, entryCount)
    let id = r.Next(0, 999999)
    let person = folks[r.Next(0, folks.Length)]
    let category = cats[r.Next(0, cats.Length)]
    let date = DateTime.Now.AddDays(r.Next(0, 100) - 50)
    select new Journal() { 
        Id = id, 
        AuthorName = person, 
        Category = category, 
        CreatedAt = date }; 
```

好的，现在我们有了一组数据可以使用，让我们看看我们想要什么......我们想要一些“形状”的东西，比如：

```
public Expression<Func<Journal, ????>> GetThingToGroupByWith(
    string[] someMagicStringNames, 
    ????) 
```

这与（在伪代码中）具有大致相同的功能：

```
GroupBy(x => new { x.magicStringNames }) 
```

让我们一次一个地剖析它。首先，我们到底是如何动态地做到这一点的？

```
x => new { ... } 
```

编译器通常为我们做了魔法——它所做的是定义一个 new `Type`，我们也可以这样做：

```
 var sourceType = typeof(Journal);

    // define a dynamic type (read: anonymous type) for our needs
    var dynAsm = AppDomain
        .CurrentDomain
        .DefineDynamicAssembly(
            new AssemblyName(Guid.NewGuid().ToString()), 
            AssemblyBuilderAccess.Run);
    var dynMod = dynAsm
         .DefineDynamicModule(Guid.NewGuid().ToString());
    var typeBuilder = dynMod
         .DefineType(Guid.NewGuid().ToString());
    var properties = groupByNames
        .Select(name => sourceType.GetProperty(name))
        .Cast<MemberInfo>();
    var fields = groupByNames
        .Select(name => sourceType.GetField(name))
        .Cast<MemberInfo>();
    var propFields = properties
        .Concat(fields)
        .Where(pf => pf != null);
    foreach (var propField in propFields)
    {        
        typeBuilder.DefineField(
            propField.Name, 
            propField.MemberType == MemberTypes.Field 
                ? (propField as FieldInfo).FieldType 
                : (propField as PropertyInfo).PropertyType, 
            FieldAttributes.Public);
    }
    var dynamicType = typeBuilder.CreateType(); 
```

所以我们在这里所做的是定义一个自定义的一次性类型，它为我们传入的每个名称都有一个字段，它与源类型上的（属性或字段）类型相同。好的！

现在我们如何给 LINQ 它想要的东西？

首先，让我们为我们将返回的函数设置一个“输入”：

```
// Create and return an expression that maps T => dynamic type
var sourceItem = Expression.Parameter(sourceType, "item"); 
```

我们知道我们需要“新建”一种新的动态类型......

```
Expression.New(dynamicType.GetConstructor(Type.EmptyTypes)) 
```

我们需要使用来自该参数的值来初始化它......

```
Expression.MemberInit(
    Expression.New(dynamicType.GetConstructor(Type.EmptyTypes)),
    bindings), 
```

但是我们到底要用来做什么`bindings`呢？嗯...好吧，我们想要一些绑定到源类型中相应属性/字段的东西，但将它们重新映射到我们的`dynamicType`字段...

```
 var bindings = dynamicType
        .GetFields()
        .Select(p => 
            Expression.Bind(
                 p, 
                 Expression.PropertyOrField(
                     sourceItem, 
                     p.Name)))
        .OfType<MemberBinding>()
        .ToArray(); 
```

哎呀......看起来很讨厌，但我们还没有完成 - 所以我们需要为`Func`我们通过表达式树创建的声明一个返回类型......如果有疑问，请使用`object`！

```
Expression.Convert( expr, typeof(object)) 
```

最后，我们将它绑定到我们的“输入参数” via `Lambda`，形成整个堆栈：

```
 // Create and return an expression that maps T => dynamic type
    var sourceItem = Expression.Parameter(sourceType, "item");
    var bindings = dynamicType
        .GetFields()
        .Select(p => Expression.Bind(p, Expression.PropertyOrField(sourceItem, p.Name)))
        .OfType<MemberBinding>()
        .ToArray();

    var fetcher = Expression.Lambda<Func<T, object>>(
        Expression.Convert(
            Expression.MemberInit(
                Expression.New(dynamicType.GetConstructor(Type.EmptyTypes)),
                bindings), 
            typeof(object)),
        sourceItem); 
```

为了便于使用，让我们将整个混乱包装为一个扩展方法，所以现在我们得到了：

```
public static class Ext
{
    // Science Fact: the "Grouper" (as in the Fish) is classified as:
    //   Perciformes Serranidae Epinephelinae
    public static Expression<Func<T, object>> Epinephelinae<T>(
         this IEnumerable<T> source, 
         string [] groupByNames)
    {
        var sourceType = typeof(T);
    // define a dynamic type (read: anonymous type) for our needs
    var dynAsm = AppDomain
        .CurrentDomain
        .DefineDynamicAssembly(
            new AssemblyName(Guid.NewGuid().ToString()), 
            AssemblyBuilderAccess.Run);
    var dynMod = dynAsm
         .DefineDynamicModule(Guid.NewGuid().ToString());
    var typeBuilder = dynMod
         .DefineType(Guid.NewGuid().ToString());
    var properties = groupByNames
        .Select(name => sourceType.GetProperty(name))
        .Cast<MemberInfo>();
    var fields = groupByNames
        .Select(name => sourceType.GetField(name))
        .Cast<MemberInfo>();
    var propFields = properties
        .Concat(fields)
        .Where(pf => pf != null);
    foreach (var propField in propFields)
    {        
        typeBuilder.DefineField(
            propField.Name, 
            propField.MemberType == MemberTypes.Field 
                ? (propField as FieldInfo).FieldType 
                : (propField as PropertyInfo).PropertyType, 
            FieldAttributes.Public);
    }
    var dynamicType = typeBuilder.CreateType();

        // Create and return an expression that maps T => dynamic type
        var sourceItem = Expression.Parameter(sourceType, "item");
        var bindings = dynamicType
            .GetFields()
            .Select(p => Expression.Bind(
                    p, 
                    Expression.PropertyOrField(sourceItem, p.Name)))
            .OfType<MemberBinding>()
            .ToArray();

        var fetcher = Expression.Lambda<Func<T, object>>(
            Expression.Convert(
                Expression.MemberInit(
                    Expression.New(dynamicType.GetConstructor(Type.EmptyTypes)),
                    bindings), 
                typeof(object)),
            sourceItem);                
        return fetcher;
    }
} 
```

现在，要使用它：

```
// What you had originally (hand-tooled query)
var db = entries.AsQueryable();
var query = db.GroupBy(x => new 
    {
        Year = x.CreatedAt.Year,
        Month = x.CreatedAt.Month
    }, prj => prj.AuthorName)
    .Select(data => new {
        Key = data.Key.Year * 100 + data.Key.Month, // very ugly code, I know
        Details = data.GroupBy(y => y).Select(z => new { z.Key, Count = z.Count() })
    });    

var func = db.Epinephelinae(new[]{"CreatedAt", "AuthorName"});
var dquery = db.GroupBy(func, prj => prj.AuthorName); 
```

该解决方案缺乏“嵌套语句”的灵活性，例如“CreatedDate.Month”，但只要有一点想象力，您就可以扩展这个想法以处理任何自由形式的查询。

# php - 遍历多维数组

> ID：15297887
> 
> 赞同：1
> 
> 时间：2013-03-08T15:48:34.663
> 
> 标签：php, arrays, multidimensional-array

有下面的数组并需要访问 id 但无法使其工作。不知道如何访问第三级数组。

```
Array
(
[0] => Array
    (
        [0] => Array
            (
                [id] => 1
            )

    )

[1] => Array
    (
        [0] => Array
            (
                [id] => 2
            )

    )

[2] => Array
    (
        [0] => Array
            (
                [id] => 3
            )

    )

[3] => Array
    (
    )

[4] => Array
    (
        [0] => Array
            (
                [id] => 5
            )

    )
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T15:52:38.217

在您的示例中，它看起来好像`id`总是在一个单独的数组中，带有`key of 0`;

1、硬编码：

```
foreach($array as $value){
    echo isset($value[0]['id']) ? $value[0]['id'] : '';
} 
```

2，遍历第二个数组：

```
foreach($array as $key=>$value){
    if(is_array($value)){
        foreach($value as $v){
            if(isset($v['id'])){
                echo $v['id'];
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T15:51:39.930

您可以通过以下方式执行此操作：`$a[0][0]["id"]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T15:50:50.800

你可以这样做：

```
echo $array[0][0]['id']; 
```

并将它们全部打印出来：

```
foreach ($array as $arr) {
   echo $arr[0]['id'];
} 
```

那应该可以。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-08T15:52:19.877

第一的：

```
$multiArr = array ( [0] => array ( [0] => array ( ['id'] => 1 ))); 
```

和：

```
echo $multiArr[0][0]['id']; //or $multiArr['0']['0']['id'] 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-08T15:52:24.290

你试过了`Array[index of array 1][index of array 2][index of array 3]`吗？

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T15:53:42.520

```
for ($i=0;$i<count($inputarray);$i++) {
    echo "ID=".$inputarray[$i][0]['id']."<br />";
} 
```

循环遍历主数组，由于您的子数组始终是元素元素 0，而您的第 3 级始终是元素 id，因此它会拉取它。

现在，如果您的子数组包含多个元素，那么如果您知道它总是在同一个地方，那么您将不得不重复循环或直接引用

# html - 在具有相同属性的不同元素上应用不同的 css

> ID：15297903
> 
> 赞同：0
> 
> 时间：2013-03-08T15:49:10.493
> 
> 标签：html, css

假设我有两个 HTML 元素：*element1*和*element2*。它们是动态创建的，所以我不能使用 ID：

```
<element1 class='class1' selected="true" ...[other_attributes]...>
<element1 class='class1' selected="true" ...[other_attributes]...>
<element1 class='class1' selected="false"...[other_attributes]...>
.................................................................
{other <element1> elements}
.................................................................
<element2 class='class2' selected="true" ...[other_attributes]...>
<element2 class='class2' selected="false"...[other_attributes]...>
.................................................................
{other <element2> elements} 
```

现在，我想做的是对 element1 和 element2 使用相同的属性（已选择），并且当 element1 上的 selected="true" 具有一个 css 时，当 element2 上的 selected="true" 具有不同的 css 时。也许是这样的：

```
[selected=true]
{
  color.red
}

[selected = true]
{
    color.green
} 
```

除了，我想以一种方式使 HTML 能够识别在不同元素上分配什么 css。

我希望我足够清楚。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:51:09.547

如果它与您使用的元素相同，那么这`classes`就是`IDs`：

```
<element id="ID1" class="red" selected="true">
<element id="ID2" class="green" selected="true"> 
```

使用`IDs`：

```
element#ID1[selected=true]
{
    color:red;
}

element#ID2[selected=true]
{
    color:green;
} 
```

使用`classes`：

```
element.red[selected=true]
{
    color:red;
}

element.green[selected=true]
{
    color:green;
} 
```

请注意，它`IDs`必须是**唯一的**，而`classes`可以用于任意数量的元素。

**编辑：**根据您修改后的问题：

```
element.class1[selected=true]
{
    color:red;
}

element.class2[selected=true]
{
    color:green;
} 
```

或者，您可以基于他们的父母（如果他们不同）：

```
parent#ID1 element[selected=true] { ... }
parent#ID2 element[selected=true] { ... } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:57:50.210

*自从您更新示例代码后进行了编辑，我将原始答案保留在下面以供参考*

像这样混合类和属性选择器：

**HTML**

```
<input class="class1" name="input" />
<input class="class1" />
<input class="class1" name="input" />

<input class="class2" name="input" />
<input class="class2" /> 
```

**CSS**

```
.class1[name=input]
{
    border: 1px solid red;
}

.class2[name=input]
{
    border: 1px solid green;
} 
```

* * *

*原始答案*

在 CSS3 中你有`:nth-of-type(n)`选择器，像这样使用：

**HTML**

```
<input name="test" value="First element">

<input name="test" value="Second element"> 
```

（请注意，上面的示例标记很糟糕，不应该在现实生活中使用！）

**CSS**

```
<style>

    [name=test]:nth-of-type(1)
    {
        color: red;
    }

    [name=test]:nth-of-type(2)
    {
        color: green;
    }

</style> 
```

更多信息请访问[http://www.w3schools.com/cssref/sel_nth-of-type.asp](http://www.w3schools.com/cssref/sel_nth-of-type.asp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-08T16:09:24.747

用这个：

```
element1[selected="true"]
              {
  color:red
}

element2[selected="true"]
             {
color:green
} 
```

# razor - 序列化 DataTable 以在 RAZOR 中使用

> ID：15297907
> 
> 赞同：0
> 
> 时间：2013-03-08T15:49:28.043
> 
> 标签：razor, asp.net-mvc-4, lambda

我有一个使用 RAZOR 的 ASP.NET MVC 4 应用程序。我的控制器操作将数据加载到 DataTable 中（我继承了代码）。我需要在我的视图中将该数据呈现为 JSON。我尝试使用这里推荐给我的方法：[Writing JSON via MVC and RAZOR](https://stackoverflow.com/questions/15281647/writing-json-via-mvc-and-razor)。

我相信 DataTable 会导致我的问题。同时，我不知道该怎么办。如何从视图中呈现为 JSON 的 DataRow 元素中获取某些列？目前，我的控制器操作中有以下内容：

```
DataTable results = GetFromDatabase();
ViewBag.Results = results; 
```

然后，在我看来，我有：

```
@{
    var serializer = new JavaScriptSerializer();
    var resultsJson = serializer.Serialize(Enumerable.Select(ViewBag.Results, result => new { id = result["ID"], name = result["Name"] }));
    Html.Raw(resultsJson);
} 
```

当我尝试这样做时，我收到一条错误消息： *无法使用 lambda 表达式作为动态分派操作的参数，而无需先将其转换为委托或表达式树类型*

我不确定如何解决这个问题。

# iphone - 使用下载的 sqlite3 文件

> ID：15297908
> 
> 赞同：-2
> 
> 时间：2013-03-08T15:49:31.687
> 
> 标签：iphone, ios, sqlite

我正在开发一个从服务器下载 sqlite3 文件并在以后随时使用它的应用程序，但下载后我无法读取它的数据

我使用此代码下载：

```
myConnection = [[NSURLConnection alloc] initWithRequest:request delegate:self];
[myConnection start]; 
```

我使用此代码获取数据：

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data
{
    [myMutableData appendData:data];
} 
```

我使用此代码保存文件：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    [myMutableData writeToFile:kPath atomically:YES]
} 
```

保存文件后，我尝试通过以下代码使用它：

```
{
    const char *SQL = [@"SELECT * from table1" UTF8String];
    sqlite3 *database = NULL;
    NSString *file = kPath;
    if (sqlite3_open([file UTF8String], &database) == SQLITE_OK)
        sqlite3_exec(database, SQL, myCallback, (__bridge void*)myArray, NULL);
    sqlite3_close(database);
} 
```

我的回调函数是：

```
static int myCallback(void *context, int count, char **values, char **columns) {
    // "count" is always zero !!

    return SQLITE_OK;
} 
```

我的问题是：回调函数中的“计数”始终为零！

请帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T18:43:05.407

几个问题：

1.  您的数据库路径应该：

    *   大概应该由[`NSSearchPathForDirectoriesInDomains`](https://developer.apple.com/library/ios/documentation/cocoa/reference/foundation/miscellaneous/foundation_functions/reference/reference.html#//apple_ref/c/func/NSSearchPathForDirectoriesInDomains);

    *   `connectionDidFinishLoading`在as中应该是一样的`sqlite3_open`；

    *   就编程风格而言，您可能希望使用与 不同的变量名`kPath`，这可能表明它是一个常量，而显然不是。

2.  您应该检查调用的结果`writeToFile`以确保它被正确保存。

3.  如果在模拟器上运行，您应该在下载后检查文件（手动在 Mac OS Finder 中，而不是通过您的应用程序......它应该在`~/Library/Application Support/iPhone Simulator/...`）导航到模拟器的文件夹并检查下载的文件。查看文件大小并查看您的服务器值是否与下载的值匹配。

4.  更微妙的问题之一是，如果您的数据库 URL 使用的是 HTTP 协议并且未找到，您将不会`didFailWithError`从您`NSURLConnection`的 . 通过手动检查生成的文件确保下载成功。

    如果您`NSURLConnection`通过 HTTP 使用和下载并希望以编程方式确保您没有收到错误，您可以使用`didReceiveResponse`：

    ```
    - (void)connection:(NSURLConnection*)connection didReceiveResponse:(NSURLResponse *)response
    {
        if ([response isKindOfClass:[NSHTTPURLResponse class]])
        {
            NSHTTPURLResponse *httpResponse = (id)response;

            NSInteger statusCode = [httpResponse statusCode];

            if (statusCode == 200)
            {
                // everything is ok
            }
            else if (statusCode >= 400)
            {
                // something went wrong, such as statusCode == 404 or something like that
            }
        }
    } 
    ```

5.  您没有向我们展示`myMutableData`. 我假设你已经做到了。您正在追加，但如果您忽略初始化该变量，它将继续进行而不会发生意外，但永远不会保存文件：

    ```
    myMutableData = [[NSMutableData alloc] init]; 
    ```

6.  `sqlite3_open`前面的问题很隐蔽，因为如果数据库不存在，执行过程将创建数据库。我在打开数据库时经常使用`sqlite3_open_v2`，所以如果数据库不存在，我会收到错误消息（或者，最好`NSFileManager`先用于检查文件是否存在）。您可能想要重置您的模拟器（或从您的设备中删除该应用程序），以便删除`sqlite3_open`为您创建的任何空白数据库。

7.  与您的直接问题无关，但顺便说一句，您的`NSURLConnection`代码正在将整个数据库加载到 RAM 中。如果它不是太大，你可以摆脱它，但最好将它流式传输到持久存储，以最大限度地减少下载过程的内存占用。在设备（而不是模拟器）上运行您的应用程序时尤其如此。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-09T06:46:59.743

我解决了！

我的错误是：我已经在本地更新了数据库文件，但我忘记在我的服务器愚蠢的错误中更新它！

感谢大家尝试提供帮助。

# spring - 使用蓝图加载 Spring 上下文并导出 Spring bean 引用

> ID：15297914
> 
> 赞同：1
> 
> 时间：2013-03-08T15:49:52.390
> 
> 标签：spring, fuseesb, blueprint-osgi, aries

我是 OSGI 的新手。我们公司决定使用 Fuse ESB 作为我们的部署容器和蓝图作为 IOC。我面临的问题是我们在各种弹簧技术中有一堆弹簧应用程序，为简洁起见，让我们考虑弹簧批处理。我们已经习惯了 spring batch dsl 及其工作方式。有没有办法我可以使用相同的spring应用程序并通过蓝图加载它（Aries蓝图不是Gemini）并且还引用一个spring bean并通过蓝图导出它？这是一个公然的“不”，或者即使可能，考虑到一个 IoC 容器在另一个容器中是一种非常糟糕的做法，我们根本不应该尝试这样做？或者，如果有人尝试过，发现成功，如果可行，请提供一些指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T19:11:17.850

当您说spring batch dsl时，您的意思是spring xml命名空间。例如，它在 spring xml 文件中的 xml 标签？如果是这样，我认为 spring 批处理中的命名空间处理程序*仅*支持 Spring，因此您不能在蓝图 xml 文件中使用该命名空间 dsl。

为此，Spring Batch 项目还需要提供 Blueprint XML DSL。例如，这就是我们为 Apache Camel 所做的，为 Camel DSL 提供 Spring XML 和 Blueprint XML。

使用 Fuse ESB，您还可以使用 Spring XML。因此，您仍然可以使用 Spring XML（在 OSGi 容器的底层使用 spring-dm），而不是使用蓝图。因此，这将允许您使用 Spring Batch XML DSL。

# django - 打开一个新的浏览器窗口，其中包含从 Python Pisa 返回的 PDF 内容

> ID：15297921
> 
> 赞同：1
> 
> 时间：2013-03-08T15:50:14.900
> 
> 标签：django, pdf, pisa

我有一个 Javascript 应用程序。当我单击一个按钮时，使用 POST 请求将一个 JSON 对象发送到 Django-Pisa 远程服务器，以从 JSON 对象创建一个 PDF 文件。我必须使用 POST，因为 JSON 长度超过了 GET 允许的长度。

这是我的 Django 渲染函数

```
@csrf_exempt
def render_to_pdf(request):
  request_data = ast.literal_eval(request.POST.keys()[0])
  template_src = templates_map.TEMPLATES_MAP[request_data['intervention']]
  context_json = request_data['data']
  template = get_template(template_src)
  context = Context(context_json)
  html  = template.render(context)
  result = StringIO.StringIO()

  pdf = pisa.pisaDocument(StringIO.StringIO(html), result,link_callback=fetch_resources)

  if not pdf.err:
    return HttpResponse(result.getvalue(), content_type='application/pdf')
  return HttpResponse('We had some errors<pre>%s</pre>' % escape(html)) 
```

在 javascript 方面，这是点击事件

```
try {
  jQuery.post('http://pdfgen-server/pdfgen', JSON.stringify(requestData), 
    function(data) {
      var w = window.open();
      w.document.write(data);
    });
}
catch (err) {
  ; //error handling
} 
```

当我单击时，我得到的是一个新窗口，内容，而不是呈现的 PDF 文件，实际上是 PDF 内容（就像我打开记事本查看 PDF 文件一样）。新浏览器窗口中的前几行：

> %PDF-1.4 % ReportLab 生成的 PDF 文档[http://www.reportlab.com](http://www.reportlab.com) % 'BasicFonts': class PDFDictionary 1 0 obj % 标准字体字典 << /F1 2 0 R /F2 3 0 R /F3 4 0 R /F4 5 0 R >> endobj % 'F1': 类 PDFType1Font 2 0 obj % Font Helvetica << /BaseFont /Helvetica /Encoding /WinAnsiEncoding /Name /F1 /Subtype /Type1 /Type /Font >> endobj % 'F2' : class PDFType1Font 3 0 obj % Font Times-Roman << /BaseFont /Times-

请让我知道如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T18:41:53.920

我实际上不确定这会起作用，但试试看 -

```
try {
  jQuery.post('http://pdfgen-server/pdfgen', JSON.stringify(requestData), 
    function(data) {
      window.open("data:application/pdf," + escape(data));
    });
}
catch (err) {
  ; //error handling
} 
```

（如果它确实有效，那么归功于[这个问题](https://stackoverflow.com/questions/2805330/opening-pdf-string-in-new-window-with-javascript)）

# ios - 在 iPhone 5 / iPad 第 4 代（ARM v7s 指令集）上安装 R（统计计算项目）

> ID：15297924
> 
> 赞同：1
> 
> 时间：2013-03-08T15:50:23.350
> 
> 标签：ios, r, ios6, iphone-5, armv7

我有一台越狱 (evasi0n) 第四代 iPad，带有 iOS 6.1.2 固件。

按照[本](http://rwiki.sciviews.org/doku.php?id=getting-started:installation:iphone)教程，我尝试在 iPad 上安装 R。
我已经在 Cydia [http://leafmoon.users.sourceforge.net/cydia/./](http://leafmoon.users.sourceforge.net/cydia/./)中添加了这个存储库， 并且我已经安装了*R 统计语言*包。

安装成功完成，没有任何问题。
但是当在移动终端中我输入：

```
R 
```

我明白了

```
Illegal instruction: 4 
```

我很确定问题与[此处](https://stackoverflow.com/questions/14710849/get-gnu-c-compiler-working-on-ios-6-x)解释的问题类型相同，即该软件包不提供 ARMv7s 支持。

显然，R 可以手动安装，但我不知道在这种特定情况下如何完成。
根据上面引用的文档，我阅读了必须为 R 安装的构建依赖项是：

*gettext, pcre, readline, png, tiff, x11*

和

*com.ech0chrome.libbz2、com.ech0chrome.libjpeg、com.ech0chrome.xzutils、com.ech0chrome.libgfortran、com.ech0chrome.iphone-gccplus*

我认为*Illegal instruction: 4*错误是由于（至少）这些最后的 .deb 文件之一，必须为 ARMv7s 重新编译。但不幸的是，我对这个问题的了解到此为止：这就是我请求您帮助的原因。

如何重新编译这个 .deb 文件？
是否有其他解决方案可以在配备 Apple A6/A6X 芯片的 iOS 设备上安装 R？

**PS**
1) 我已经在 iPad 上正确安装了[GNU C 编译器。](http://iphonesdkdev.blogspot.de/2013/02/illegal-instruction-4.html)
2) 我是一名 iOS 开发人员，所以我的机器上安装了 XCode (v. 4.5)。
3) 在我的 iPhone 4S (iOS 5.1.1) R 工作正常。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-23T07:41:34.710

If you have gnu sed in iOS, you should patch R 2.x (after installation in A6/A6X CPU such as iPhone 5 / iPad 4 and also A7 CPU such as iPhone 5s / iPad Air / iPad Mini Retina) as below

```
sed -i'' 's/\x00\x30\x93\xe4/\x00\x30\x93\xe5/g;s/\x00\x30\xd3\xe4/\x00\x30\xd3\xe5/g;' /usr/local/lib/R/bin/exec/R 
```

R 3.0.2 package is now here [http://code.google.com/p/apiexplorer/downloads/detail?name=RPackage.tgz](http://code.google.com/p/apiexplorer/downloads/detail?name=RPackage.tgz)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T16:10:23.623

更好的方法可能是在另一台计算机上运行某种 R 服务器并从您的 iPad 访问它，而不是尝试直接在 iPad 上运行 R。Rstudio 有一个可用的服务器，在谷歌上搜索 Rstudio 和 iPad 会引发一些讨论（一些问题可能到目前为止可能还没有解决），但你可能会有更多的人一起工作，并且通过这种方式获得更多成功的希望。

# c# - 转换为值类型“Double”失败，因为具体化值为 null

> ID：15297925
> 
> 赞同：28
> 
> 时间：2013-03-08T15:50:23.653
> 
> 标签：c#, entity-framework

**代码：**

```
double cafeSales = db.InvoiceLines
    .Where(x =>
        x.UserId == user.UserId &&
        x.DateCharged >= dateStart &&
        x.DateCharged <= dateEnd)
    .Sum(x => x.Quantity * x.Price); 
```

**错误：**

转换为值类型“Double”失败，因为具体化值为 null。结果类型的泛型参数或查询必须使用可为空的类型。

**我已经看到的：**

[转换为值类型“Int32”失败，因为具体化值为 null](https://stackoverflow.com/questions/6864311/the-cast-to-value-type-int32-failed-because-the-materialized-value-is-null)

[转换为值类型“十进制”失败，因为具体化值为 null](https://stackoverflow.com/questions/10819475/the-cast-to-value-type-decimal-failed-because-the-materialized-value-is-null)

**我尝试过的：**

```
double cafeSales = db.InvoiceLines
    .Where(x =>
        x.UserId == user.UserId &&
        x.DateCharged >= dateStart &&
        x.DateCharged <= dateEnd)
    .DefaultIfEmpty()
    .Sum(x => x.Quantity * x.Price); 
```

和：

```
double? cafeSales = db.InvoiceLines
    .Where(x =>
        x.UserId == user.UserId &&
        x.DateCharged >= dateStart &&
        x.DateCharged <= dateEnd)
    .Sum(x => x.Quantity * x.Price); 
```

这些都不起作用。我知道问题的原因是该表中没有我传入的 UserId 的行。在这种情况下，我宁愿 Sum() 只返回一个 0 给我。有任何想法吗？

* * *

## 回答 #1

> 赞同：70
> 
> 时间：2013-10-22T06:26:20.707

最佳解决方案

```
double cafeSales = db.InvoiceLines
                     .Where(x =>
                                x.UserId == user.UserId &&
                                x.DateCharged >= dateStart &&
                                x.DateCharged <= dateEnd)
                     .Sum(x => (double?)(x.Quantity * x.Price)) ?? 0; 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-08T15:54:44.143

You can check if the collection has any correct results.

```
double? cafeSales = null;
var invoices = db.InvoiceLines
    .Where(x =>
        x.UserId == user.UserId &&
        x.DateCharged >= dateStart &&
        x.DateCharged <= dateEnd
    )
    .Where(x => x.Quantity != null && x.Price != null);
if (invoices.Any()) {
    cafeSales = invoices.Sum(x => x.Quantity * x.Price);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-07-23T07:46:13.650

我知道这有点旧，但以防万一它对任何人都有帮助。

@Matt 我想该`DefaultIFEmpty()`方法应该适合您，以防万一您为要应用的列传递默认值`Sum`。此方法有一些您可能想要检查的重载，如果重载不支持您的要求，我建议进行类型转换。

```
 (query).DefaultIfEmpty(0) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-08T15:59:17.723

`Quantity`这应该可以解决问题（如果任一或`Price`不可为空，您可能必须删除其中一个条件）：

```
var cafeSales = db.InvoiceLines
    .Where(x =>
        x.UserId == user.UserId &&
        x.DateCharged >= dateStart &&
        x.DateCharged <= dateEnd &&
        x.Quantity != null &&
        x.Price != null);

double cafeSalesTotal = 0;

if (cafeSales.Any())
{
    cafeSalesTotal = cafeSales.Sum(x => x.Quantity * x.Price);
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-02-11T07:06:05.080

```
join sim in ctx.EF.Collaterals on new { id = ini.cam.id, Type = 0 } equals new 
{ id = sim.CampaignId == null ? new Guid() : sim.CampaignId, sim.Type } 
into tempcoll
from sim in tempcoll.DefaultIfEmpty() 
```

此解决方案有效。实际上，您需要使用三元运算符检查值并在第二列和第二个表中插入 Guid 如果为 null。它会起作用。“转换为值类型'Double'失败，因为物化值为空”将得到解决谢谢

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-08T15:56:14.530

```
 var cafeSales = db.InvoiceLines
.Where(x =>
    x.UserId == user.UserId &&
    x.DateCharged >= dateStart &&
    x.DateCharged <= dateEnd)
.Sum(x => x.Quantity * x.Price);

double i;
if(cafeSales==null) ? i=0 : i=(double)cafeSales.First(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-06-11T08:47:34.097

上面的解决方案对我不起作用。我的问题是相似的。我确信没有返回任何行，但 Sum 的行为有些奇怪。所以我决定在调用 lambda 表达式之前添加一个检查，在这里我检查 lambda 返回的行的计数属性。如果它大于零，那么我调用 sum 表达式。这对我有用。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-02-23T16:32:52.463

.NET 4.0，Nullable 有一个“GetValueOrDefault()”方法。因此，如果您将查询转换为 Nullable，那么您可以在完成时得到正确的类型。此方法还将生成正确的单个 SQL SELECT SUM 查询，并且比其他通过 linq 将整个记录集返回到以后求和的解决方案更快

```
decimal result = ((decimal?)query.Where(w => w.Customer =="ABC").Sum(s =>  (decimal?)s.Amount)).GetValueOrDefault(); 
```

# css - Rails 内联形式

> ID：15297926
> 
> 赞同：0
> 
> 时间：2013-03-08T15:50:43.540
> 
> 标签：css, ruby-on-rails, forms

我在这样的 Rails 项目中有一个导航栏

```
<nav>
    <%= link_to "Home", root_url %> |
    <%= form_tag "/posts", :method => 'get' do %>
        <%= search_field_tag 'search', nil, :placeholder => 'Find...' %>
    <% end %>
    <%= link_to "Sign Up", new_user_url %> |
    <%= link_to "Sign In", sign_in_url %>
</nav> 
```

我希望它全部显示在一行中。它目前在其自己的行上与搜索栏一起呈现，其他链接在其下方。当我检查表单元素时，它似乎占据了整个页面宽度。我尝试将表单标签包装在一个 div 中`display: inline`并手动设置其宽度，但都不起作用。我怎样才能强迫他们出现在同一条线上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:59:44.597

尝试：

```
<nav>
  <div style= "display:inline">
    <%= link_to "Home", root_url %> |
  </div>

  <div style= "display:inline">
    <%= form_tag "/posts", :method => 'get' do %>
      <%= search_field_tag 'search', nil, :placeholder => 'Find...' %>
    <% end %>
  </div>

     <%= link_to "Sign Up", new_user_url %> |
     <%= link_to "Sign In", sign_in_url %>
</nav> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:08:57.237

添加`ul li`您的`view`并添加`css`如下内容

## 看法：

```
 <nav>
      <ul>
        <li>
          <%= link_to "Home", root_url %>
        </li>
        <li>
          <%= form_tag "/posts", :method => 'get' do %>
            <%= search_field_tag 'search', nil, :placeholder => 'Find...' %>
          <% end %>
        </li>
        <li>
          <%= link_to "Sign Up", new_user_url %>
        </li>
        <li>
          <%= link_to "Sign In", sign_in_url %>
        </li>
      </ul>
    </nav> 
```

在这种情况下，您不想`|`在标记的末尾添加一个。`CSS`会做那件事。这是 HTML 5 语义和在菜单之间设置分隔符的正确方法。

## CSS：

```
ul li {
    display: inline;
    overflow: hidden;
    float: left;
    border-right: 1px solid gray;
    padding: 0 10px;
}

li:last-child { border-right:none; } 
```

# java - 用于此设置的 Java 中的简单协议概念

> ID：15297928
> 
> 赞同：0
> 
> 时间：2013-03-08T15:50:44.340
> 
> 标签：java, sockets, client-server

我需要一些关于为此类系统实施任何简单/易于使用的设置的想法/建议：

![在此处输入图像描述](../Images/7957bbae9addfc83879069d031021bff.png)

我有两台机器，其中一台将发送命令（可以是命令、配置文件、文本、xml 等）（我必须决定命令应该以哪种方式工作），另一台将执行这些命令。然而，这不是一个完全交互式的终端应用程序，发送者只需要知道它是否执行得很好。

RPC也不是一个选项，我只是通过实现客户端/服务器套接字概念来实现吗？
是否有任何知名的库可以帮助在 Java 中实现这种场景？或者可能是一些基于 Web 服务器和 http 的通信？

对于开源库实现这种场景有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T17:20:29.713

如果您使用套接字或任何其他 TCP 消息服务，您将获得有保证的消息传递，然后您只需在服务器端编写响应并将其发送回来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:47:15.613

[Apache MINA](http://mina.apache.org/)项目。MINA 的 API 级别较低且非常复杂。即使是最简单的客户端/服务器也需要编写更多代码。MINA 也没有与强大的序列化框架集成，并且本质上不支持 RMI。

Priobit项目是 NIO[之上](https://code.google.com/p/pyronet/)的最小层。它提供 TCP 网络，但没有更高级别的功能。Priobit 要求所有网络通信都发生在单个线程上。

[Java Game Networking 项目](https://code.google.com/p/jgn/)是一个更高级别的库。JGN 没有那么简单的 API。

[KryoNet](https://code.google.com/p/kryonet/)是一个 Java 库，它为使用 NIO 的高效 TCP 和 UDP 客户端/服务器网络通信提供了简洁的 API。

# jquery - 如果表头具有特定字符串，则应用 id

> ID：15297934
> 
> 赞同：-2
> 
> 时间：2013-03-08T15:51:08.870
> 
> 标签：jquery

我想将 id 应用于标题中具有特定字符串的表。该表没有任何 css 标签，如果不动态添加，我无法添加它们。这是我的桌子：

```
<div id="primary" class="page">
<div class="inside">
<table border="10">
<tr><th>You may search for materials using the following:</th></tr>

<tr><td align="center"><a href="#">NAME</a></td></tr>
<tr><td align="center"><a href="#">TITLE</a></td></tr>
<tr><td align="center"><a href="#">SUBJECT</a></td></tr>
<tr><td align="center"><a href="#">WORD</a></td></tr>
<tr><td align="center"><a href="#">ISBN</a></td></tr>
<tr><td align="center"><a href="#">ISSN</a></td></tr>
</table> 
```

我想将#mytable 的ID 应用于在我尝试使用.addClass 的表头中包含字符串“您可以搜索材料”的任何表，但我感到困惑。我会很感激任何帮助，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:56:03.160

我建议：

```
$('table th:contains("You may search for materials using the following")')
    .closest('table').addClass('myTable'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/rx7qU/)。

请注意，我添加的是`class`name 而不是`id`，因为您的问题暗示页面上可能有多个元素与给定条件匹配。

我进一步建议*不要*为此使用 a `table`，因为它显然*不是*表格数据，而是一个列表，因此使用 a`ul`似乎更合适：

```
<ul>
    <li class="header">You may search for materials using the following:</li>
    <li><a href="#">NAME</a></li>
    <li><a href="#">TITLE</a></li>
    <li><a href="#">SUBJECT</a></li>
    <li><a href="#">WORD</a></li>
    <li><a href="#">ISBN</a></li>
    <li><a href="#">ISSN</a></li>
</ul> 
```

使用以下 CSS 来近似`table`演示文稿的外观：

```
ul {
    width: 50%;
    border: 10px groove #666;
    margin: 0;
    padding: 0;
}

li {
    padding: 0;
    margin: 0.2em;
    list-style-type: none;
    text-align: center;
    border: 1px solid #aaa;
}

li.header {
    font-weight: bold;
}

ul.myTable li.header {
    color: #f00;
} 
```

并改编了 jQuery：

```
$('li.header:contains("You may search for materials using the following")')
    .closest('ul').addClass('myTable'); 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/rx7qU/2/)。

参考：

*   [`addClass()`选择器](http://api.jquery.com/addClass/)。
*   [`closest()`选择器](http://api.jquery.com/closest/)。
*   [`:contains()`选择器](http://api.jquery.com/contains-selector/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:56:28.447

您可以像这样使用高级选择器：

```
$('th:contains("You may search for materials")').closest('table')
                                                .addClass('mytable'); 
```

使用她的类作为 ID 必须是唯一的。

**注意：** `contains()`区分大小写。

# java - Java 请求仅在以下情况下有效

> ID：15297935
> 
> 赞同：0
> 
> 时间：2013-03-08T15:51:09.417
> 
> 标签：java, http, post, request

这是我的代码：

```
String httpURL = "http://codespeed_server:8000/result/add/";
URL myurl = new URL(httpURL);
HttpURLConnection con = (HttpURLConnection) myurl.openConnection();
con.setDoOutput(true);
DataOutputStream output = new DataOutputStream(con.getOutputStream());
output.writeBytes(query); 
```

谁能告诉我为什么这只在我追踪它时才有效：

```
con.getResponseCode(); 
```

? 当我调用*getResponseCode()*时，服务器只会获取新条目。这是正常行为吗？还是服务器端的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T16:08:54.357

`URLConnection`直到调用`getResponse*`,方法之一（或其他需要响应数据的`getInputStream`方法）才建立连接（或`connect()`）。

# mysql - 反转列内容以利用索引？

> ID：15297937
> 
> 赞同：0
> 
> 时间：2013-03-08T15:51:11.850
> 
> 标签：mysql, optimization

根据我现在正在运行的查询，我认为这是一个白日梦：

我在包含字符串 id 的列上有一个索引。这些 ID 最后有一个标识符，所以要捕获我需要的数据，我需要像这样进行模式匹配：

```
key LIKE '%racecar' 
```

由于您不能利用通配符开始字符串的索引，我希望我能做到这一点：

```
reverse(key) LIKE 'racecar%' 
```

但是，这意味着 MySQL 必须查看并在每一行上执行一个函数，对吗？除了更改命名约定之外，还有其他解决此问题的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:55:38.867

This smells like bad DB design. Split the string and the id into two separate columns and the problem(and many other problems) will be automatically solved.

I also doubt the order of the string and the id will make difference to MYSQL with respect to performance.

Also keep in mind you have an index over key, but this does not mean you have an index over the reverse of `key` which is the reason you get no speedup at all. I believe that given the situation the performance is beyond salvation.

# java - 引用 src 目录外的属性文件

> ID：15297938
> 
> 赞同：0
> 
> 时间：2013-03-08T15:51:17.660
> 
> 标签：java, properties

如果我有以下目录结构，

+src
++com.foo.util
+++FooProperties.java
+foo.properties

如何在 中`foo.properties`作为资源流引用`FooProperties`？我已经尝试将它添加到类路径并引用它，

```
FooProperties.class.getResourceAsStream("/foo.properties") 
```

但我得到一个`NullPointerException`. 我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-08T16:05:40.383

如果您想将`properties`文件保留在`src`（与 相同级别`src`）之外，那么您可以通过`properties`以下方式获取文件：-

```
try {
    InputStream fileStream = new FileInputStream(new File(
            "test.properties"));
    Properties props = new Properties();
    props.load(fileStream);
    String myPropValue = (String) props.get("test.prop");
    System.out.println(myPropValue);
} catch (FileNotFoundException e) {
} catch (IOException e) {
} 
```

希望能帮助到你。您甚至可以使用上述方法编辑属性文件（不需要绝对路径）。

# c# - 使用 excel 插件防止单个对象的多个实例

> ID：15297942
> 
> 赞同：2
> 
> 时间：2013-03-08T15:51:24.800
> 
> 标签：c#, excel, excel-dna

我有两项可以插入 excel 的技术。

一种是实现 IDTExtensibility2 接口的 COM 插件。另一个是通过 Excel-DNA 实现的 RTD 服务器。

这两个对象都是由 excel 实例化的。他们每个人都需要在运行时访问第三个对象以从中获取数据并将其推送到 excel。

因为我不能把这个对象交给 excel 插件，所以我把它做成了一个单例，希望它们每个都可以共享同一个实例。

不幸的是，在运行代码时，他们每个人都看不到另一个人创建的单例对象的实例。

如何让两个插件引用同一个对象？

让我们假设两个插件都需要保留，我宁愿不进行进程间通信设置。

TL/DR 两个 excel 插件需要共享第三个对象，但是将第三个对象设为单例不起作用，因为每个 excel 插件都看不到另一个插件创建的第三个对象的实例。

这种问题的解决方案是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-09T12:38:41.130

您的加载项正在单独的 AppDomain 中加载。一种选择是将 COM 加载项集成到 Excel-DNA 加载项中。这可能很简单：

1.  将您的 COM 插件代码添加到您的 Excel-DNA 项目中，
2.  将您的加载项类更改为从`ExcelComAddIn`（而不是`IDTExtensibility2`）派生，
3.  将该类加载到您的`AutoOpen`via`ExcelComAddInHelper.LoadComAddIn(...)`中。

否则，您将需要某种 AppDomain 间通信。您可以设置一个 Marshal-By-Reference 对象，将其设置为与加载的加载项对应`Object`的对象的属性`COMAddIn`，并使用 Excel-DNA 加载项中的 COM 接口检索该对象。

# sql-server - 添加新列并设置外键关系

> ID：15297947
> 
> 赞同：7
> 
> 时间：2013-03-08T15:51:39.743
> 
> 标签：sql-server, tsql

我想在 CDRLive 中添加一个新列“IPkey”，它是 ACIPin 中的主键“pkey”。pkey 是 bigint，而不是 null。

```
ALTER TABLE CDRLive ADD IPkey bigint NOT NULL
go
ALTER TABLE CDRLive
ADD CONSTRAINT CDRLive_IPkey FOREIGN KEY(IPkey) REFERENCES ACIPin(pkey) 
```

失败的。错误：

```
Msg 4901, Level 16, State 1, Line 2
ALTER TABLE only allows columns to be added that can contain nulls, or have a DEFAULT     definition specified, or the column being added is an identity or timestamp column, or alternatively if none of the previous conditions are satisfied the table must be empty to allow addition of this column. Column 'IPkey' cannot be added to non-empty table 'CDRLive' because it does not satisfy these conditions.
 Msg 1769, Level 16, State 1, Line 1

 Foreign key 'CDRLive_IPkey' references invalid column 'IPkey' in referencing table 'CDRLive'.
 Msg 1750, Level 16, State 0, Line 1
 Could not create constraint. See previous errors. 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-08T16:25:16.320

如果您希望列具有`NOT NULL`约束，则需要按以下顺序进行。

1.  `ALTER TABLE CDRLive ADD IPkey bigint NULL go`
2.  用您喜欢的数据填充该列。
3.  `ALTER TABLE CDRLive ADD IPkey bigint NOT NULL go`
4.  `ALTER TABLE CDRLive ADD CONSTRAINT CDRLive_IPkey FOREIGN KEY(IPkey) REFERENCES ACIPin(pkey)`

# ios - 如何在 iOS 中实现“贪睡”？

> ID：15297949
> 
> 赞同：0
> 
> 时间：2013-03-08T15:51:42.880
> 
> 标签：ios, push-notification, apple-push-notifications, uilocalnotification, alarm

我想开发一个闹钟应用程序并实现“贪睡”功能。

首先，用户使用 datePicker 设置时间。当用户忽略通知时，

它会在 5 分钟后再次推送通知。

所以我使用 UILocalNotification 并设置 repeatInterval = NSDayCalendarUnit

然后我可以每天收到通知，但我不知道如何实现“贪睡”

仅当用户忽略第一个通知时。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-08T15:59:47.100

您最多可以安排 64 个本地通知。

因此，以 5 分钟的间隔安排它们。

如果用户忽略通知（没有打开您的应用程序），下一个通知将在 5 分钟后关闭。

如果他真的打开了你的应用程序，你可以通过

```
[[UIApplication sharedApplication] scheduledLocalNotifications]; 
```

并通过取消所有这些

```
[[UIApplication sharedApplication] cancelLocalNotification]; 
```

然后以 5 分钟的间隔重新安排下一个警报。

# javascript - jQuery 中 $("p + p") 的反义词是什么？

> ID：15297951
> 
> 赞同：1
> 
> 时间：2013-03-08T15:51:49.993
> 
> 标签：javascript, jquery

这听起来像是一个非常简单的问题，但我在 jQuery 文档中找不到任何内容。基本上，我需要知道 jQuery 的[Next Adjacent Selector](http://api.jquery.com/next-adjacent-selector/)的对立面是什么。

这是我为下一个相邻选择器所拥有的：

`$("#newsSlider p.active + p").addClass("active");`

这就是我试图扭转的情况：

`$("#newsSlider p.active - p").addClass("active");`

显然，它不起作用，那么我该怎么做才能反转 Next Adjacent Selector 呢？如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-08T15:53:07.940

你在找`.prev()`对面的`.next()`吗？

```
$("#newsSlider p.active").prev('p').addClass("active"); 
```

# javascript - 传递的变量变为未定义的javascript

> ID：15297952
> 
> 赞同：0
> 
> 时间：2013-03-08T15:51:55.363
> 
> 标签：javascript, parameters

我有 2 个功能可以做同样的事情。一种有效，一种无效。

```
function showHideRedrawAttendanceAvg(chart, dataType)
{
    $("#attendanceCount").addClass("hide");
    $("#attendanceAvg").removeClass("hide");
    redrawAttendance(chart, dataType);//Parameters are defined
}

function redrawAttendance(chart, dataType) //Parameters are passed and are defined
{
    //Some logic
}

//I tried change the parameter name several times to make sure it was unique
function showHideRedrawAttendanceCount(agagfadfg)
{
    $("#attendanceAvg").addClass("hide");
    $("#attendanceCount").removeClass("hide");
    redrawAttendanceTree(agagfadfg);//Parameter is defined
}

function redrawAttendanceTree(agagfadfg)//Parameter becomes undefined
{
    //Some logic
} 
```

我不知道为什么这两个函数的行为不同。我什至从文件中删除了我所有的 javascript，只留下了 showHideRedrawAttendanceCount 和 redrawAttendanceCount 函数，但它仍然不起作用。

```
<ul class="dropdown-menu">
    <li class="dropdown-submenu">
        <a href="#">Attendance Average</a>
        <ul class="dropdown-menu">
            <li><a data-toggle="tab" href="#attendance" onclick="showHideRedrawAttendanceAvg(attendance, 'Weekly')">Weekly</a></li>
            <li><a data-toggle="tab" href="#attendance" onclick="showHideRedrawAttendanceAvg(attendance, 'Monthly')">Monthly</a></li>
            <li><a data-toggle="tab" href="#attendance" onclick="showHideRedrawAttendanceAvg(attendance, 'Quarterly')">Quarterly</a></li>
            <li><a data-toggle="tab" href="#attendance" onclick="showHideRedrawAttendanceAvg(attendance, 'Yearly')">Yearly</a></li>
        </ul>
    </li>
    <li class="dropdown-submenu">
        <a href="#">Attendance Total</a>
        <ul class="dropdown-menu">
            <li><a data-toggle="tab" href="#attendance" onclick="">Weekly</a></li>
            <li><a data-toggle="tab" href="#attendance" onclick="showHideRedrawAttendanceCount('Monthly')">Monthly</a></li>
            <li><a data-toggle="tab" href="#attendance" onclick="showHideRedrawAttendanceCount('Quarterly')">Quarterly</a></li>
            <li><a data-toggle="tab" href="#attendance" onclick="showHideRedrawAttendanceCount('Yearly')">Yearly</a></li>
        </ul>
    </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:56:23.007

你打电话时

```
redrawAttendanceTree(agagfadfg); 
```

该`redrawAttendanceTree`函数未在您提供的代码示例中定义，因此会出错，指出您正在尝试调用不存在的函数。

`drawAttendanceTree`在您提供的代码示例中从未调用过。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:02:25.097

Javascript 中的函数重载不像其他语言那样工作。在 Javascript 中，仅仅因为你在函数中有一个参数 less 并不意味着它有不同的签名，而是它的名字很重要。

这边走

```
function showHideRedrawAttendanceCount(agagfadfg) 
```

永远不会被调用。

为了仍然实现您正在尝试的内容，请尝试[这个线程](https://stackoverflow.com/questions/456177/function-overloading-in-javascript-best-practices)，了解如何在 Javascript 中最好地重载函数。

# android - 分配跟踪器中的 DDMS 缺少列

> ID：15297955
> 
> 赞同：2
> 
> 时间：2013-03-08T15:52:07.893
> 
> 标签：android, eclipse, ddms

在 Eclipse 的 DDMS 视图中，我缺少分配跟踪器第二部分的所有列......

我可以看到一个带有“alloc order”和“alloc size”等的列表，但是点击列表中的任何项目都不会在屏幕的后半部分给我更多信息......

在网上的屏幕截图中，我可以看到它应该告诉我哪个文件甚至行号正在分配内存，而不是我得到 4 或 5 个项目，例如“at Java.lang.Objec ...”以省略号结尾，但无法扩展它列显示整行...

我已经重新启动了几次，并且正在使用最新的工具、ADT 和 SDK ......

有人遇到过这样的问题吗？这使得寻找 OOM 错误变得非常困难......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T15:55:47.717

This also happened with me.

The allocation tracker and logcat both had missing columns.

This seems to be happening with IDE with outdated Developer tools.

Make sure you check for updates for the Android Developer tools ([https://dl-ssl.google.com/android/eclipse/](https://dl-ssl.google.com/android/eclipse/))

```
Help > Check for Updates 
```

**Current version**

21.1.0.v201302060044

**After that make sure the tools are updates:**

Open Android SDK manager and make sure your SDK tools are up to date.

```
Window > Android SDK Manager 
```

And make sure the *Status* columns displays *"Installed"* and not *"Update available"* for The Tools.

Current versions are:

*   Android SDK Tools rev. 21.1
*   Android SDK Platform-tools rev. 16.02

**EDIT:** I'm terribly sorry. It seems I missed the part where you said you already tried the above. These things worked for me and fixed the problem so I was pretty sure this is the solution.

It seems re-installing Eclipse might be the next step. (Which I never had to do)

# java - 代码 400，无法识别的字段“客户”未标记为可忽略

> ID：15297956
> 
> 赞同：0
> 
> 时间：2013-03-08T15:52:11.397
> 
> 标签：java, rest, jax-ws, restkit

我的问题：

我已经用restkit 0.20在我的iphone应用程序中构建了一个rest客户端。我的 RESTService 是用 jax-rs 构建的，包括 jackson。

有一个名为“客户”的类，我保存我的客户数据。

```
@XmlRootElement                                
public class Customer extends BaseEntity {

private int customer_id;
private String appell;
private String firstname;
private String lastname;
private Date birthday;
private String street;
private String streetnr;
private String zipcode;
private String place;

public int getCustomer_id() {
    return customer_id;
}

public void setCustomer_id(int customer_id) {
    this.customer_id = customer_id;
}

public String getAppell() {
    return appell;
}

public void setAppell(String appell) {
    this.appell = appell;
}

public String getFirstname() {
    return firstname;
}

public void setFirstname(String firstname) {
    this.firstname = firstname;
}

public String getLastname() {
    return lastname;
}

public void setLastname(String lastname) {
    this.lastname = lastname;
}

public Date getBirthday() {
    return birthday;
}

public void setBirthday(Date birthday) {
    this.birthday = birthday;
}

public String getStreet() {
    return street;
}
public void setStreet(String street) {
    this.street = street;
}
public String getStreetnr() {
    return streetnr;
}
public void setStreetnr(String streetnr) {
    this.streetnr = streetnr;
}
public String getZipcode() {
    return zipcode;
}
public void setZipcode(String zipcode) {
    this.zipcode = zipcode;
}
public String getPlace() {
    return place;
}
public void setPlace(String place) {
    this.place = place;
} 
```

我能做些什么？为什么在 RestKit 中总是记录此错误：

```
Expected status code in (200-299), got 400" UserInfo=0x956e2f0 {NSLocalizedRecoverySuggestion=Unrecognized field "customer" (Class customer.model.Customer), not marked as ignorable 
```

我没有名为客户的字段。

这是我的 POST 方法：

```
@POST
@Path("/insert")
@Consumes(MediaType.APPLICATION_JSON)
public Response insertCustomer(Customer customer) {
    String result = "Customer inserted " + customer.getLastname();
    customer.createEntity();
    return Response.status(201).type(MediaType.APPLICATION_JSON).entity(result).build();
} 
```

这是在我的 ios 应用程序中调用 @GET 方法时生成的 JSON 对象 (Jackson) 的示例。

```
 {
"appell": "Frau",
"birthday": "1991-10-01T00:00:00+01:00",
"customer_id": "3",
"firstname": "Max",
"lastname": "Mustermann",
"place": "München",
"street": "Einsteinweg",
"streetnr": "19",
"zipcode": "81858" 
```

}

这是 JSON 对象的一个​​示例，当我的 ios 应用程序调用显示的 @POST 方法时：

```
{"customer":{"streetnr":"19",
 "zipcode":"81829",
 "customer_id":0,
 "place":"München",
 "appell":"Herr",
 "firstname":"Heinrich",
 "birthday":"1991-10-01T00:00:00+01:00",
 "lastname":"Maier",
 "street":"Lehrer-Wirth-Str.19"}} 
```

我是使用 restkit 和 jax-rs 的绝对新手。

我刚刚添加了一个 @GET 方法来请求 xml 格式。在这里你可以看到它：

```
@GET
@Path("/listallcustomers")
@Produces(MediaType.APPLICATION_XML)
public ArrayList<Customer> showAllCustomers() {
    ArrayList<Customer> list = DBAccess.getInstance().getAllCustomers();
    return list;
} 
```

这是结果：

```
<customers>
  <customer>
  <appell>Frau</appell>
  <birthday>1991-10-01T00:00:00+01:00</birthday>
  <customer_id>3</customer_id>
  <firstname>Max</firstname>
  <lastname>MUstermann</lastname>
  <place>München</place>
  <street>Einsteinstr.</street>
  <streetnr>19</streetnr>
  <zipcode>82838</zipcode>
</customer>
  ... 
```

我创建 JSON 对象的 @GET 方法如下：

```
@GET
@Path("/listall")
@Produces(MediaType.APPLICATION_JSON)
public ArrayList<Customer> showAllJsonCustomers() {
    ArrayList<Customer> list = DBAccess.getInstance().getAllCustomers();
    return list;
} 
```

这是它创建的 JSON 对象的示例：

```
{
"lastname": "Müller",
"customer_id": 6,
"appell": "Herr",
"firstname": "pupsi",
"birthday": "1986-10-16",
"street": "Lehrer-Wirth-Str",
"streetnr": "19",
"zipcode": "81829",
"place": "München"
},
... 
```

# java - 通过 AppEngine 调整 Jersey 的加载时间

> ID：15297961
> 
> 赞同：9
> 
> 时间：2013-03-08T15:52:22.723
> 
> 标签：java, google-app-engine, jersey, java-ws

由于 Jersey 扫描库所花费的时间过长，我的应用程序服务甚至无法启动或响应预热请求。

我已经创建了应用程序并硬编码了球衣资源的所有路径。

```
<servlet-name>Jersey REST Service</servlet-name>
<servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
<init-param>
<param-name>javax.ws.rs.Application</param-name>
<param-value>com.livily.rest.JerseyApplication</param-value>
</init-param> 
```

Jersey Application 有所有的类

```
public Set<Class<?>> getClasses()
{
Set<Class<?>> s = new HashSet<Class<?>>();
s.add(com.livily.rest.visitor.UserRatingUtil.class);
} 
```

然而，泽西正在扫描许多供应商

```
Mar 8, 2013 3:39:40 PM com.sun.jersey.core.spi.component.ProviderServices getServiceClasses
CONFIG:     Provider found: class com.sun.jersey.server.impl.model.parameter.multivalued.StringReaderProviders$StringConstructor 
```

它正在做大约 50-100 次，然后

```
Mar 8, 2013 3:39:41 PM com.sun.jersey.server.impl.modelapi.annotation.IntrospectionModeller createResource
FINEST: A new abstract resource created by IntrospectionModeler: AbstractResource("/current-status", - CurrentStatus: 1 constructors, 0 fields, 0 setter methods, 1 res methods, 0 subres methods, 0 subres locators ) 
```

每一个人

总共花费的时间约为 4-10 秒，appengine 不喜欢这样，因为它希望快速完成加载；否则它会开始给出奇怪的 500 错误（即使是静态文件）。

我被难住了；任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-17T17:48:04.623

我使用 packages 属性来命名应扫描的包，如下所示...

```
 <init-param>
         <param-name>com.sun.jersey.config.property.packages</param-name>
         <param-value>com.foo.myproviders</param-value>
    </init-param> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-25T15:01:21.123

设置**`jersey.config.disableAutoDiscovery`**。有关详细信息，请参阅[配置属性](https://jersey.java.net/documentation/latest/appendix-properties.html)。

```
<init-param>
    <param-name>jersey.config.disableAutoDiscovery</param-name>
    <param-value>true</param-value>
</init-param> 
```

# c# - Expression.Bind() - 它实际上是做什么的？

> ID：15297964
> 
> 赞同：16
> 
> 时间：2013-03-08T15:52:29.977
> 
> 标签：c#, .net, reflection, expression, expression-trees

所以我最近一直在玩动态构建表达式树，遇到了这种方法，这似乎有点奇怪。起初我想“哦，这正是我所需要的”在不断地按照

```
var left = member is FieldInfo ? Expression.Field(instance, (FieldInfo)member) : Expression.Property(instance, (PropertyInfo)member);
var right = ...
var assign = Expression.Assign(left, right); 
```

是的，我知道有`Expression.PropertyOrField()`电话，但它确实往返反射以按名称查找成员，因为我通常已经有`MemberInfo`实例。

所以无论如何，我认为`Expression.Bind()`这对我有用，但它做了一些我不太了解的事情。给定以下代码：

```
void Main()
{
    var m = typeof(Foo).GetField("Bar");
    Expression.Bind(m, Expression.Constant("")).Dump();
}

public class Foo
{
    public string Bar;
} 
```

它产生`MemberAssignment`表达式`Bar = ""`。但是没有实例，也没有静态引用。我将如何将此表达式应用于 的实例`Foo`？我找不到任何使用这种方法的例子。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-08T16:09:12.573

**对象初始化表达式**。

假设你有：

```
public class Foo
{
    public int Property { get; set; }
} 
```

然后你可以这样做：

```
var parameter = Expression.Parameter(typeof(int), "i");
var newExpr = Expression.New(typeof(Foo));
var bindExprs = new[]
    {
        Expression.Bind(typeof(Foo).GetProperty("Property"), parameter)
        // You can bind more properties here if you like.
    };

var body = Expression.MemberInit(newExpr, bindExprs);
var lambda = Expression.Lambda<Func<int, Foo>>(body, parameter); 
```

这类似于：

```
i => new Foo { Property = i } 
```

# 老的：

~~我无法帮助您解决您决心解决的“性能问题”（使用 Expression.PropertyOrField 真的会在您的应用程序中引入瓶颈吗？我有点怀疑。您应该在过早优化之前确定这一点）~~（**编辑**：道歉错误地假设这是一个性能优化，并且正如您自己发现的那样，Expression.MakeMemberAccess 是您所需要的），但我*可以*告诉您什么`Expression.Bind`是有用的。

# xna - 试图在 XNA 中的相机上画一个字符串，但是当相机移动时它保持静止

> ID：15297966
> 
> 赞同：0
> 
> 时间：2013-03-08T15:52:37.970
> 
> 标签：xna, camera, position

我正在尝试在我的游戏中绘制一个字符串（使用 XNA）（该字符串是一个 FPS 计数器）。我试图让它跟随相机。但是，当我绘制字符串时，相机移动时它会保持在同一个位置。我必须使用矩阵和变换吗？

谢谢，

刘易斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T16:02:58.990

如果相机正在移动并且您不希望字符串移动，只需使用第二个 spritebatch 来绘制与相机无关且不在屏幕上移动的 gui 元素。

移动 GUI 元素以跟上相机似乎没有必要。

```
spriteBatch.Begin(cameraTransform)
//camera related game elements
spriteBatch.End()

spriteBatch.Begin()
//draw GUI elements
spriteBatch.End() 
```

# jquery - 如何使用实时功能在 div 上显示（父鼠标悬停）？

> ID：15297969
> 
> 赞同：2
> 
> 时间：2013-03-08T15:52:40.720
> 
> 标签：jquery

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T16:08:01.227

这可以在**没有 JavaScript**的情况下使用*纯*CSS 来完成。

```
div a {
    display: none;
}

div:hover a {
   display: block;
} 
```

演示 - [http://jsfiddle.net/TjVkS/](http://jsfiddle.net/TjVkS/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:57:37.997

从 jQuery 1.7 开始，[该`live()`方法已弃用](http://api.jquery.com/live/)。改为使用`on()`。它对我来说非常有效，如下所示：

`[**Working demo**](http://jsbin.com/iwevam/3/edit)`

# deployment - capistrano：当服务器是 localhost 时不使用 ssh 执行

> ID：15297971
> 
> 赞同：5
> 
> 时间：2013-03-08T15:52:45.110
> 
> 标签：deployment, capistrano

我正在使用带有多级扩展的 capistrano，以便在登台和生产服务器上轻松部署。

我实现了很多任务，在服务器上进行设置。对于不同的阶段，我有 deploy/staging.rb 或 deploy/production.rb 之类的文件，只有一些主机名和用户名更改。

当我使用此设置创建阶段“localhost”时：

```
set :server, "localhost" 
```

一切都在我的本地计算机上正确执行。但它是用 ssh 执行的。我有同事，他们的计算机上没有运行 ssh 服务器。所以问题是：

我如何告诉 capistrano 执行由`run`或`capture`不由 ssh 调用的所有命令执行？我不想用`run_locally`.

# php - 将列表视图项数组从 android 保存到 MySQL

> ID：15297975
> 
> 赞同：0
> 
> 时间：2013-03-08T15:52:50.713
> 
> 标签：php, android

我有一个应用程序，当用户单击按钮时，在列表视图上单击的项目将保存到 MySQL 数据库中。我创建了一个数组，还编写了一个类来执行异步 http post 操作。但是，没有任何内容被发布到数据库中，并且我得到了一个响应，即得到一个无效的 json 解析异常

下面是代码：

```
//array to hold the data
ArrayList <String>friends = new ArrayList<String>();

  //listview click event
    ListView lv = getListView();
    lv.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            // getting values from selected ListItem
            String pid = ((TextView) view.findViewById(R.id.pid)).getText()
            .toString();
          friends.add(pid);
            }
     // Button to save array
   Button fr=(Button)findViewById(R.id.savefriends);
    fr.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View arg0) {
            // TODO Auto-generated method stub

            }
         new SaveFriends().execute();

    }

});          
     // Asynch Class To Store Array

    class SaveFriends extends AsyncTask<String, String, String> {

    /**
     * Before starting background thread Show Progress Dialog
     * */
    @Override
    protected void onPreExecute() {
        super.onPreExecute();
        pDialog=ProgressDialog.show(AllFriends.this, "", "Saving Friends List. Please wait...", true, false);
    }

    /**
     * Creating friendlist
     * */
    protected String doInBackground(String... args) {
        String user_id ="23";
        String friend_id =friends.toString();

        // Building Parameters
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        params.add(new BasicNameValuePair("user_id", user_id));
        params.add(new BasicNameValuePair("friend_id", friend_id));
                    // getting JSON Object
                    JSONObject json = jParser.makeHttpRequest(url_create_friends,
                "POST", params);

        // check log cat fro response
        Log.d("Create Response", json.toString());

        // check for success tag
        try {
            int success = json.getInt(TAG_SUCCESS);

            if (success == 1) {
                // successfully created product
                Intent i = new Intent(getApplicationContext(), FriendsList.class);
                startActivity(i);

                // closing this screen
                finish();
            } else {
                // failed to create friends
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;
    }

    /**
     * After completing background task Dismiss the progress dialog
     * **/
    protected void onPostExecute(String file_url) {
        // dismiss the dialog once done
        pDialog.dismiss();
    }

}
   //JSONParser Class For HttpRequests
      public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static String json = "";

// constructor
public JSONParser() {

}

// function get json from url
// by making HTTP POST or GET method
public JSONObject makeHttpRequest(String url, String method,
        List<NameValuePair> params) {

    // Making HTTP request
    try {

        // check for request method
        if(method == "POST"){
            // request method is POST
            // defaultHttpClient
            DefaultHttpClient httpClient = new DefaultHttpClient();
            HttpPost httpPost = new HttpPost(url);
            httpPost.setEntity(new UrlEncodedFormEntity(params));

            HttpResponse httpResponse = httpClient.execute(httpPost);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();

        }else if(method == "GET"){
            // request method is GET
            DefaultHttpClient httpClient = new DefaultHttpClient();
            String paramString = URLEncodedUtils.format(params, "utf-8");
            url += "?" + paramString;
            HttpGet httpGet = new HttpGet(url);

            HttpResponse httpResponse = httpClient.execute(httpGet);
            HttpEntity httpEntity = httpResponse.getEntity();
            is = httpEntity.getContent();
        }           

    } catch (UnsupportedEncodingException e) {
        e.printStackTrace();
    } catch (ClientProtocolException e) {
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(
                is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;
        while ((line = reader.readLine()) != null) {
            sb.append(line + "\n");
        }
        is.close();
        json = sb.toString();
    } catch (Exception e) {
        Log.e("Buffer Error", "Error converting result " + e.toString());
    }

    // try parse the string to a JSON object
    try {
        jObj = new JSONObject(json);
    } catch (JSONException e) {
        Log.e("JSON Parser", "Error parsing data " + e.toString());
    }

    // return JSON String
    return jObj;

}

  //php script 
 <?php       
  // array for JSON response
  $response = array();

  // check for required fields
 if (isset($_POST['user_id']) && isset($_POST['friend_id'])) {

  $user_id = $_POST['user_id'];
  $friend_id = $_POST['friend_id'];

// include db connect class
require_once __DIR__ . '/db_connect.php';

// connecting to db
$db = new DB_CONNECT();

// mysql inserting a new row
  foreach($_POST['friend_id'] as $val) {

$result = mysql_query("INSERT INTO friends(primary_friend,friend_id)       
 VALUES('$user_id', '$val')");
    }
// check if row inserted or not
if ($result) {
    // successfully inserted into database
    $response["success"] = 1;
    $response["message"] = "Product successfully created.";

    // echoing JSON response
     echo json_encode($response);
       } else {
      // failed to insert row
      $response["success"] = 0;
      $response["message"] = "Oops! An error occurred.";

      // echoing JSON response
    echo json_encode($response);
   }
 } else {
// required field is missing
 $response["success"] = 0;
 $response["message"] = "Required field(s) is missing";

// echoing JSON response
echo json_encode($response);
  }
  ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-08T15:56:30.473

```
method == "POST" 
```

将不起作用，因为您正在尝试比较字符串。改为使用`method.equals("POST")`。

* * *

为了确保这样的错误不会再次出现，我建议您开始遵循我使用的约定，而不是比较字符串，而应该使用数字比较。让我演示一下：

```
 private static final int METHOD_POST = 1;
 private static final int METHOD_GET = 2;

 public JSONObject makeHttpRequest(String url, int method, List<NameValuePair> params) {

    if (method == METHOD_POST) {

    }

    else if (method == METHOD_GET) {

    }

}

 makeHttpRequest("url", METHOD_POST, params); 
```

为什么使用数字是因为它不易出错，因为数字是数字，而字符串通常包含更多字符。在我看来，它看起来也更专业。

# c# - Reactive Extensions 中的递归/扇出

> ID：15297977
> 
> 赞同：4
> 
> 时间：2013-03-08T15:52:56.420
> 
> 标签：c#, .net, system.reactive

我正在尝试拼凑一个工作原理如下的 Rx 管道：

1.  我编写了一个函数，它接受一个 IObservable，为我提供包含有关公司信息的配置文件
2.  我查询各种数据源以查找可能相关的公司资料，所有这些都是并行的。我将其合并到一个 IObservable 的公司简介中。
3.  当我取回这些可能相关的配置文件时，我会将它们与我已经观察到的配置文件进行比较，如果它们的相关性 > 80% 并且与我已经观察到的任何配置文件都不相同，我认为它们是匹配的。
4.  我想将匹配的公司返回到第 1 步，以便我可以搜索这些新匹配配置文件的相关数据。

我使用一些已知的良好配置文件引导该过程。

最终，没有更多尚未看到的匹配配置文件，因此该过程结束。

我在编程时遇到了麻烦。如果我使用 Subject 允许管道的尾端将其配置文件发送到工作流的开头，那么没有人会调用 OnCompleted 并且我永远不会发现该过程已经结束。如果我用递归来开发它，我似乎总是以堆栈溢出结束，因为我试图用自己的返回值调用一个函数。

谁能帮助我以我可以确定该过程已结束的方式完成此任务？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-09T04:21:32.643

听起来您想要这样的数据流：

```
seed profiles --> source --> get related --> output
                     ^                    |
                     |                    v
                     -<--- transform <----- 
```

这似乎是解决一般问题比解决特定问题更容易或更容易的情况，因此我将提出一个通用的“反馈”函数，它应该为您提供所需的构建块：

*编辑：固定功能完成*

```
IObservable<TResult> Feedback<T, TResult>(this IObservable<T> seed,
                                          Func<T, IObservable<TResult>> produce,
                                          Func<TResult, IObservable<T>> feed)
    {
        return Observable.Create<TResult>(
                obs =>
                {
                    var ret = new CompositeDisposable();
                    Action<IDisposable> partComplete = 
                        d =>
                        {
                            ret.Remove(d);
                            if (ret.Count == 0) obs.OnCompleted();
                        };
                    Action<IObservable<T>, Action<T>> ssub =
                        (o, n) =>
                        {
                            var disp = new SingleAssignmentDisposable();
                            ret.Add(disp);
                            disp.Disposable = o.Subscribe(n, obs.OnError, () => partComplete(disp));
                        };
                    Action<IObservable<TResult>, Action<TResult>> rsub =
                        (o, n) =>
                        {
                            var disp = new SingleAssignmentDisposable();
                            ret.Add(disp);
                            disp.Disposable = o.Subscribe(n, obs.OnError, () => partComplete(disp));
                        };

                    Action<T> recurse = null;
                    recurse = s =>
                              {
                                  rsub(produce(s),
                                       r => 
                                       {
                                           obs.OnNext(r);
                                           ssub(feed(r), recurse);
                                       });
                              };

                    ssub(seed, recurse);
                    return ret;
                });
    } 
```

在您的情况下，`T`并且`TResult`看起来是相同`feed`的，身份功能也是如此。 `produce`将是用于实现步骤 2 和 3 的函数。

我测试了这个函数的一些示例代码：

```
void Main()
{
    var seed = new int[] { 1, 2, 3, 4, 5, 6 };
    var found = new HashSet<int>();
    var mults = seed.ToObservable()
                    .Feedback(i =>
                              {
                                  return Observable.Range(0, 5)
                                         .Select(r => r * i)
                                         .TakeWhile(v => v < 100)
                                         .Where(v => found.Add(v));
                              },
                              i => Observable.Return(i));

    using (var disp = mults.Dump())
    {
        Console.WriteLine("Press any key to stop");
        Console.ReadKey();
    }
    Console.WriteLine("Press any key to exit");
    Console.ReadKey();
}

static IDisposable Dump<T>(this IObservable<T> source)
{
    return source.Subscribe(item => Console.WriteLine(item),
                            ex => Console.WriteLine("Error occurred in dump observable: " + ex.ToString()),
                            () => Console.WriteLine("Dump completed"));
} 
```

# c# - 获取组合框项目标签

> ID：15297978
> 
> 赞同：0
> 
> 时间：2013-03-08T15:52:57.463
> 
> 标签：c#, winforms, visual-studio-2010

对我收到此错误的原因感到困惑：

`Combobox`项目：

```
private readonly string[] cbTexts = new string[] { "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday", "(Cleare)" }; 
```

动态`comboboxes`：

```
private void comboOptions()
        {
            cmb = new ComboBox[countWaiters];
            int width = 100;
            int height = 20;
            for (int i = 0; i <= 3; ++i)
            {
                newBox = new ComboBox();         
                newBox.Text = "(Request)";          
                newBox.Size = new Size(width, height);
                newBox.Location = new Point(0, (i * height));
                cmb[i] = newBox;
                cmb[i].SelectedIndexChanged += new EventHandler(cmb_SelectedIndexChanged);
                foreach (string cbText in cbTexts)
                {
                    cmb[i].Items.Add(cbText);
                }

                pnlRequests.Controls.Add(newBox);
            }            
        } 
```

`SelectedIndexChanged`事件`comboboxes`：

```
void cmb_SelectedIndexChanged(object sender, EventArgs e)
        {

            ComboBox senderCmb = (ComboBox)sender;

           int row = (int)senderCmb.Tag;
           //this is where the program crashes
           //more code located here that does something
         } 
```

错误：注意：此图像中的某些方法名称已更改，但没有任何影响 ![在此处输入图像描述](../Images/e4518d15b1ca61fa978a5760e4406228.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T15:58:30.550

您尚未`Tag`在给定代码中的任何位置设置该属性，我不明白您为什么需要这样做。我怀疑你想得到电流`SelectedIndex`：

```
int row = senderCmb.SelectedIndex; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T16:01:48.440

我错过了一条线，犯了愚蠢的错误：

```
cmb[i].Tag = i; 
```

# android - 对于小于 11 的 api 级别，ScaleGestureDetector.getCurrentSpanX() 等效于什么？

> ID：15297979
> 
> 赞同：0
> 
> 时间：2013-03-08T15:52:57.747
> 
> 标签：android, android-view

当我只在水平轴上捏时，我需要放大我的视图。我`ScaleGestureDetector.getCurrentSpanX()`在我的代码中实现了。从 API doc 它的作用是：

`Return the average X distance between each of the pointers forming the gesture in progress through the focal point.`

但仅适用于 API 级别 11 或更高级别。此类中的其他一些类似方法也需要 API 级别 11：

```
 getCurrentSpanX ()
    getCurrentSpanY ()
    getPreviousSpanX ()
    getPreviousSpanY () 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-08T16:55:33.740

我想最好的解决方案是使用`ScaleGestureDetector`Android 4.1.2（最新版本）中的类。你可以在这里找到它：

[http://grepcode.com/file_/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/view/ScaleGestureDetector.java/?v=source](http://grepcode.com/file_/repository.grepcode.com/java/ext/com.google.android/android/4.1.2_r1/android/view/ScaleGestureDetector.java/?v=source)

您将需要进行一些小的修改：

1）添加进口

```
import android.view.MotionEvent;
import android.view.ViewConfiguration; 
```

2) 删除此行 (143 - 148)

```
/**
 * Consistency verifier for debugging purposes.
 */
private final InputEventConsistencyVerifier mInputEventConsistencyVerifier =
        InputEventConsistencyVerifier.isInstrumentationEnabled() ?
                new InputEventConsistencyVerifier(this, 0) : null; 
```

还有这个 (169 - 171)

```
if (mInputEventConsistencyVerifier != null) {
    mInputEventConsistencyVerifier.onTouchEvent(event, 0);
} 
```

瞧，享受您的新 ScaleGestureDetector！与 API 8 及更高版本兼容的完整源代码在这里：

```
/*
 * Copyright (C) 2010 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package eu.bioport.tests;

import android.content.Context;
import android.util.FloatMath;
import android.view.MotionEvent;
import android.view.ViewConfiguration;

/**
 * Detects scaling transformation gestures using the supplied {@link MotionEvent}s.
 * The {@link OnScaleGestureListener} callback will notify users when a particular
 * gesture event has occurred.
 *
 * This class should only be used with {@link MotionEvent}s reported via touch.
 *
 * To use this class:
 * <ul>
 *  <li>Create an instance of the {@code ScaleGestureDetector} for your
 *      {@link View}
 *  <li>In the {@link View#onTouchEvent(MotionEvent)} method ensure you call
 *          {@link #onTouchEvent(MotionEvent)}. The methods defined in your
 *          callback will be executed when the events occur.
 * </ul>
 */
public class ScaleGestureDetector {
    private static final String TAG = "ScaleGestureDetector";

    /**
     * The listener for receiving notifications when gestures occur.
     * If you want to listen for all the different gestures then implement
     * this interface. If you only want to listen for a subset it might
     * be easier to extend {@link SimpleOnScaleGestureListener}.
     *
     * An application will receive events in the following order:
     * <ul>
     *  <li>One {@link OnScaleGestureListener#onScaleBegin(ScaleGestureDetector)}
     *  <li>Zero or more {@link OnScaleGestureListener#onScale(ScaleGestureDetector)}
     *  <li>One {@link OnScaleGestureListener#onScaleEnd(ScaleGestureDetector)}
     * </ul>
     */
    public interface OnScaleGestureListener {
        /**
         * Responds to scaling events for a gesture in progress.
         * Reported by pointer motion.
         *
         * @param detector The detector reporting the event - use this to
         *          retrieve extended info about event state.
         * @return Whether or not the detector should consider this event
         *          as handled. If an event was not handled, the detector
         *          will continue to accumulate movement until an event is
         *          handled. This can be useful if an application, for example,
         *          only wants to update scaling factors if the change is
         *          greater than 0.01.
         */
        public boolean onScale(ScaleGestureDetector detector);

        /**
         * Responds to the beginning of a scaling gesture. Reported by
         * new pointers going down.
         *
         * @param detector The detector reporting the event - use this to
         *          retrieve extended info about event state.
         * @return Whether or not the detector should continue recognizing
         *          this gesture. For example, if a gesture is beginning
         *          with a focal point outside of a region where it makes
         *          sense, onScaleBegin() may return false to ignore the
         *          rest of the gesture.
         */
        public boolean onScaleBegin(ScaleGestureDetector detector);

        /**
         * Responds to the end of a scale gesture. Reported by existing
         * pointers going up.
         *
         * Once a scale has ended, {@link ScaleGestureDetector#getFocusX()}
         * and {@link ScaleGestureDetector#getFocusY()} will return focal point
         * of the pointers remaining on the screen.
         *
         * @param detector The detector reporting the event - use this to
         *          retrieve extended info about event state.
         */
        public void onScaleEnd(ScaleGestureDetector detector);
    }

    /**
     * A convenience class to extend when you only want to listen for a subset
     * of scaling-related events. This implements all methods in
     * {@link OnScaleGestureListener} but does nothing.
     * {@link OnScaleGestureListener#onScale(ScaleGestureDetector)} returns
     * {@code false} so that a subclass can retrieve the accumulated scale
     * factor in an overridden onScaleEnd.
     * {@link OnScaleGestureListener#onScaleBegin(ScaleGestureDetector)} returns
     * {@code true}.
     */
    public static class SimpleOnScaleGestureListener implements OnScaleGestureListener {

        public boolean onScale(ScaleGestureDetector detector) {
            return false;
        }

        public boolean onScaleBegin(ScaleGestureDetector detector) {
            return true;
        }

        public void onScaleEnd(ScaleGestureDetector detector) {
            // Intentionally empty
        }
    }

    private final Context mContext;
    private final OnScaleGestureListener mListener;

    private float mFocusX;
    private float mFocusY;

    private float mCurrSpan;
    private float mPrevSpan;
    private float mInitialSpan;
    private float mCurrSpanX;
    private float mCurrSpanY;
    private float mPrevSpanX;
    private float mPrevSpanY;
    private long mCurrTime;
    private long mPrevTime;
    private boolean mInProgress;
    private int mSpanSlop;

    public ScaleGestureDetector(Context context, OnScaleGestureListener listener) {
        mContext = context;
        mListener = listener;
        mSpanSlop = ViewConfiguration.get(context).getScaledTouchSlop() * 2;
    }

    /**
     * Accepts MotionEvents and dispatches events to a {@link OnScaleGestureListener}
     * when appropriate.
     *
     * <p>Applications should pass a complete and consistent event stream to this method.
     * A complete and consistent event stream involves all MotionEvents from the initial
     * ACTION_DOWN to the final ACTION_UP or ACTION_CANCEL.</p>
     *
     * @param event The event to process
     * @return true if the event was processed and the detector wants to receive the
     *         rest of the MotionEvents in this event stream.
     */
    public boolean onTouchEvent(MotionEvent event) {

        final int action = event.getActionMasked();

        final boolean streamComplete = action == MotionEvent.ACTION_UP ||
                action == MotionEvent.ACTION_CANCEL;
        if (action == MotionEvent.ACTION_DOWN || streamComplete) {
            // Reset any scale in progress with the listener.
            // If it's an ACTION_DOWN we're beginning a new event stream.
            // This means the app probably didn't give us all the events. Shame on it.
            if (mInProgress) {
                mListener.onScaleEnd(this);
                mInProgress = false;
                mInitialSpan = 0;
            }

            if (streamComplete) {
                return true;
            }
        }

        final boolean configChanged =
                action == MotionEvent.ACTION_POINTER_UP ||
                action == MotionEvent.ACTION_POINTER_DOWN;
        final boolean pointerUp = action == MotionEvent.ACTION_POINTER_UP;
        final int skipIndex = pointerUp ? event.getActionIndex() : -1;

        // Determine focal point
        float sumX = 0, sumY = 0;
        final int count = event.getPointerCount();
        for (int i = 0; i < count; i++) {
            if (skipIndex == i) continue;
            sumX += event.getX(i);
            sumY += event.getY(i);
        }
        final int div = pointerUp ? count - 1 : count;
        final float focusX = sumX / div;
        final float focusY = sumY / div;

        // Determine average deviation from focal point
        float devSumX = 0, devSumY = 0;
        for (int i = 0; i < count; i++) {
            if (skipIndex == i) continue;
            devSumX += Math.abs(event.getX(i) - focusX);
            devSumY += Math.abs(event.getY(i) - focusY);
        }
        final float devX = devSumX / div;
        final float devY = devSumY / div;

        // Span is the average distance between touch points through the focal point;
        // i.e. the diameter of the circle with a radius of the average deviation from
        // the focal point.
        final float spanX = devX * 2;
        final float spanY = devY * 2;
        final float span = FloatMath.sqrt(spanX * spanX + spanY * spanY);

        // Dispatch begin/end events as needed.
        // If the configuration changes, notify the app to reset its current state by beginning
        // a fresh scale event stream.
        final boolean wasInProgress = mInProgress;
        mFocusX = focusX;
        mFocusY = focusY;
        if (mInProgress && (span == 0 || configChanged)) {
            mListener.onScaleEnd(this);
            mInProgress = false;
            mInitialSpan = span;
        }
        if (configChanged) {
            mPrevSpanX = mCurrSpanX = spanX;
            mPrevSpanY = mCurrSpanY = spanY;
            mInitialSpan = mPrevSpan = mCurrSpan = span;
        }
        if (!mInProgress && span != 0 &&
                (wasInProgress || Math.abs(span - mInitialSpan) > mSpanSlop)) {
            mPrevSpanX = mCurrSpanX = spanX;
            mPrevSpanY = mCurrSpanY = spanY;
            mPrevSpan = mCurrSpan = span;
            mInProgress = mListener.onScaleBegin(this);
        }

        // Handle motion; focal point and span/scale factor are changing.
        if (action == MotionEvent.ACTION_MOVE) {
            mCurrSpanX = spanX;
            mCurrSpanY = spanY;
            mCurrSpan = span;

            boolean updatePrev = true;
            if (mInProgress) {
                updatePrev = mListener.onScale(this);
            }

            if (updatePrev) {
                mPrevSpanX = mCurrSpanX;
                mPrevSpanY = mCurrSpanY;
                mPrevSpan = mCurrSpan;
            }
        }

        return true;
    }

    /**
     * Returns {@code true} if a scale gesture is in progress.
     */
    public boolean isInProgress() {
        return mInProgress;
    }

    /**
     * Get the X coordinate of the current gesture's focal point.
     * If a gesture is in progress, the focal point is between
     * each of the pointers forming the gesture.
     *
     * If {@link #isInProgress()} would return false, the result of this
     * function is undefined.
     *
     * @return X coordinate of the focal point in pixels.
     */
    public float getFocusX() {
        return mFocusX;
    }

    /**
     * Get the Y coordinate of the current gesture's focal point.
     * If a gesture is in progress, the focal point is between
     * each of the pointers forming the gesture.
     *
     * If {@link #isInProgress()} would return false, the result of this
     * function is undefined.
     *
     * @return Y coordinate of the focal point in pixels.
     */
    public float getFocusY() {
        return mFocusY;
    }

    /**
     * Return the average distance between each of the pointers forming the
     * gesture in progress through the focal point.
     *
     * @return Distance between pointers in pixels.
     */
    public float getCurrentSpan() {
        return mCurrSpan;
    }

    /**
     * Return the average X distance between each of the pointers forming the
     * gesture in progress through the focal point.
     *
     * @return Distance between pointers in pixels.
     */
    public float getCurrentSpanX() {
        return mCurrSpanX;
    }

    /**
     * Return the average Y distance between each of the pointers forming the
     * gesture in progress through the focal point.
     *
     * @return Distance between pointers in pixels.
     */
    public float getCurrentSpanY() {
        return mCurrSpanY;
    }

    /**
     * Return the previous average distance between each of the pointers forming the
     * gesture in progress through the focal point.
     *
     * @return Previous distance between pointers in pixels.
     */
    public float getPreviousSpan() {
        return mPrevSpan;
    }

    /**
     * Return the previous average X distance between each of the pointers forming the
     * gesture in progress through the focal point.
     *
     * @return Previous distance between pointers in pixels.
     */
    public float getPreviousSpanX() {
        return mPrevSpanX;
    }

    /**
     * Return the previous average Y distance between each of the pointers forming the
     * gesture in progress through the focal point.
     *
     * @return Previous distance between pointers in pixels.
     */
    public float getPreviousSpanY() {
        return mPrevSpanY;
    }

    /**
     * Return the scaling factor from the previous scale event to the current
     * event. This value is defined as
     * ({@link #getCurrentSpan()} / {@link #getPreviousSpan()}).
     *
     * @return The current scaling factor.
     */
    public float getScaleFactor() {
        return mPrevSpan > 0 ? mCurrSpan / mPrevSpan : 1;
    }

    /**
     * Return the time difference in milliseconds between the previous
     * accepted scaling event and the current scaling event.
     *
     * @return Time difference since the last scaling event in milliseconds.
     */
    public long getTimeDelta() {
        return mCurrTime - mPrevTime;
    }

    /**
     * Return the event time of the current event being processed.
     *
     * @return Current event time in milliseconds.
     */
    public long getEventTime() {
        return mCurrTime;
    }
} 
```

# ruby-on-rails - Rails 4 移除测试生成器（尤其是 test_unit）

> ID：15297981
> 
> 赞同：8
> 
> 时间：2013-03-08T15:53:03.130
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, generator

如何删除 test_unit 生成器以使它们从`rails generate`列表中消失？

我已经尝试了一些**对我不起作用的**方法：

```
config.generators do |g|
  g.test_framework nil
end 
```

`-T`使用选项创建应用程序。

我的`rails g`输出：

```
[a lot of other generators skipped]

    TestUnit:
      test_unit:controller
      test_unit:helper
      test_unit:integration
      test_unit:mailer
      test_unit:model
      test_unit:plugin
      test_unit:scaffold 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-06-01T12:27:33.517

在您`config/application.rb`拥有世代设置的地方，您可以隐藏一些您不想看到的生成器。例如：

```
config.generators do |g|
  g.hidden_namespaces << :test_unit << :erb
  g.test_framework :mini_test
  g.template_engine :slim
  # ...
end 
```

# mysql - 真的有必要为文本列设置两个全文索引吗？

> ID：15297985
> 
> 赞同：0
> 
> 时间：2013-03-08T15:53:15.140
> 
> 标签：mysql, full-text-search, full-text-indexing, fulltext-index

我继承了使用 MySQL 和 PHP 构建的自定义 CMS 的代码库，它使用全文索引在内容（文本）字段中进行搜索。在分析数据库结构时，我发现所有相关表都是按以下方式创建的（简化示例）：

```
CREATE TABLE `stories` (
  `story_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `headline` varchar(255) NOT NULL DEFAULT '',
  `subhead` varchar(255) DEFAULT NULL,
  `content` text NOT NULL,
  PRIMARY KEY (`story_id`),
  FULLTEXT KEY `fulltext_search` (`headline`,`subhead`,`content`),
  FULLTEXT KEY `headline` (`headline`),
  FULLTEXT KEY `subhead` (`subhead`),
  FULLTEXT KEY `content` (`content`)  
) ENGINE=MyISAM; 
```

如您所见，全文索引是以通常的方式创建的，但随后也会单独添加每一列，我相信这会创建两个不同的索引。

我联系了之前的开发人员，他说这是创建全文索引的“正确”方法，但根据我在互联网上找到的每个示例，没有这样的要求，这就足够了：

```
CREATE TABLE `stories` (
  `story_id` int(11) unsigned NOT NULL AUTO_INCREMENT,
  `headline` varchar(255) NOT NULL DEFAULT '',
  `subhead` varchar(255) DEFAULT NULL,
  `content` text NOT NULL,
  PRIMARY KEY (`story_id`),
  FULLTEXT KEY `fulltext_search` (`headline`,`subhead`,`content`)
) ENGINE=MyISAM; 
```

该表有超过 80,000 行，并且变得越来越难以管理（整个数据库接近 10GB），所以我想删除任何不必要的数据。

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-25T15:35:15.753

自己弄清楚的方法是将 EXPLAIN 与查询（匹配）一起使用，以查看实际使用了哪些索引。如果您的查询不使用索引并且速度很慢，请创建索引（或手动告诉它使用 index_hint），然后再次尝试 EXPLAIN 以查看索引是否被使用。

我希望如果您的用户只允许指定要搜索的一列，并且该列不是索引列列表中的第一列或唯一列，则查询/匹配将使用非索引顺序搜索。换句话说，如果您的索引位于 ( `headline`, `subhead`, `content`) 上，我希望该索引可用于所有三列的任何搜索，或者仅使用`headline`, 或使用`headline`and `subhead`，但不仅仅用于副标题，也不仅仅是用于内容。我有一段时间没有这样做了，所以现在可能会有所不同；但 EXPLAIN 应该揭示发生了什么。

如果您使用 EXPLAIN 检查所有可能的查询并发现其中任何一个都没有使用索引，那么您就不需要它。

# c# - 在 wpf 中将 WebBrowser 控件设为只读？

> ID：15297987
> 
> 赞同：0
> 
> 时间：2013-03-08T15:53:23.647
> 
> 标签：c#, wpf

我想让 wpf webbroswer 控件只读，因为我仍然希望能够让用户能够从文本字段等复制文本，但我不希望他们能够单击按钮或提交表单。我将 Web 浏览器控件包装在 wpf 用户控件中。当我将 IsEnabled 属性设置为 false 时，它​​可以工作，即 webbroswer 控件被禁用但用户无法从页面中选择文本...

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T16:01:34.250

您可以处理 WebBrowser 的[Navigating](http://msdn.microsoft.com/en-us/library/system.windows.controls.webbrowser.navigating.aspx)事件并取消它，以便用户无法导航到另一个页面。

```
void myBrowser_Navigating(object sender, NavigatingCancelEventArgs e)
{
    e.Cancel = true;      
} 
```

# ios - 核心音频离线渲染 GenericOutput

> ID：15297990
> 
> 赞同：11
> 
> 时间：2013-03-08T15:53:36.317
> 
> 标签：ios, core-audio

有人使用 core-Audio 成功地完成了离线渲染。？

我必须混合两个音频文件并应用混响（使用 2 AudioFilePlayer、MultiChannelMixer、Reverb2 和 RemoteIO）。得到它的工作。我可以在预览时保存它（在 RemoteIO 的 renderCallBack 上）。

我需要在不播放的情况下保存它（离线）。提前致谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-12T12:30:00.190

离线渲染使用 GenericOutput AudioUnit 为我工作。我在这里分享工作代码。核心音频框架似乎有点。但是其中的一些小东西，比如 ASBD、参数……等等都在制造这些问题。努力吧，它会起作用的。不要放弃:-)。core-audio 在处理低级音频时非常强大和有用。这就是我从这几周学到的。享受:-D ....

在 .h 中声明这些

```
//AUGraph
AUGraph mGraph;
//Audio Unit References
AudioUnit mFilePlayer;
AudioUnit mFilePlayer2;
AudioUnit mReverb;
AudioUnit mTone;
AudioUnit mMixer;
AudioUnit mGIO;
//Audio File Location
AudioFileID inputFile;
AudioFileID inputFile2;
//Audio file refereces for saving
ExtAudioFileRef extAudioFile;
//Standard sample rate
Float64 graphSampleRate;
AudioStreamBasicDescription stereoStreamFormat864;

Float64 MaxSampleTime; 
```

//在.m类中

```
- (id) init
{
    self = [super init];
    graphSampleRate = 44100.0;
    MaxSampleTime   = 0.0;
    UInt32 category = kAudioSessionCategory_MediaPlayback;
    CheckError(AudioSessionSetProperty(kAudioSessionProperty_AudioCategory,
                                   sizeof(category),
                                   &category),
           "Couldn't set category on audio session");
    [self initializeAUGraph];
    return self;
} 
```

//ASBD设置

```
- (void) setupStereoStream864 {    
    // The AudioUnitSampleType data type is the recommended type for sample data in audio
    // units. This obtains the byte size of the type for use in filling in the ASBD.
    size_t bytesPerSample = sizeof (AudioUnitSampleType);
    // Fill the application audio format struct's fields to define a linear PCM,
    // stereo, noninterleaved stream at the hardware sample rate.
    stereoStreamFormat864.mFormatID          = kAudioFormatLinearPCM;
    stereoStreamFormat864.mFormatFlags       = kAudioFormatFlagsAudioUnitCanonical;
    stereoStreamFormat864.mBytesPerPacket    = bytesPerSample;
    stereoStreamFormat864.mFramesPerPacket   = 1;
    stereoStreamFormat864.mBytesPerFrame     = bytesPerSample;
    stereoStreamFormat864.mChannelsPerFrame  = 2; // 2 indicates stereo
    stereoStreamFormat864.mBitsPerChannel    = 8 * bytesPerSample;
    stereoStreamFormat864.mSampleRate        = graphSampleRate;
} 
```

//AUGraph设置

```
- (void)initializeAUGraph
{
    [self setupStereoStream864];

    // Setup the AUGraph, add AUNodes, and make connections
// create a new AUGraph
CheckError(NewAUGraph(&mGraph),"Couldn't create new graph");

// AUNodes represent AudioUnits on the AUGraph and provide an
// easy means for connecting audioUnits together.
    AUNode filePlayerNode;
    AUNode filePlayerNode2;
AUNode mixerNode;
AUNode reverbNode;
AUNode toneNode;
AUNode gOutputNode;

// file player component
    AudioComponentDescription filePlayer_desc;
filePlayer_desc.componentType = kAudioUnitType_Generator;
filePlayer_desc.componentSubType = kAudioUnitSubType_AudioFilePlayer;
filePlayer_desc.componentFlags = 0;
filePlayer_desc.componentFlagsMask = 0;
filePlayer_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

// file player component2
    AudioComponentDescription filePlayer2_desc;
filePlayer2_desc.componentType = kAudioUnitType_Generator;
filePlayer2_desc.componentSubType = kAudioUnitSubType_AudioFilePlayer;
filePlayer2_desc.componentFlags = 0;
filePlayer2_desc.componentFlagsMask = 0;
filePlayer2_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

// Create AudioComponentDescriptions for the AUs we want in the graph
// mixer component
AudioComponentDescription mixer_desc;
mixer_desc.componentType = kAudioUnitType_Mixer;
mixer_desc.componentSubType = kAudioUnitSubType_MultiChannelMixer;
mixer_desc.componentFlags = 0;
mixer_desc.componentFlagsMask = 0;
mixer_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

// Create AudioComponentDescriptions for the AUs we want in the graph
// Reverb component
AudioComponentDescription reverb_desc;
reverb_desc.componentType = kAudioUnitType_Effect;
reverb_desc.componentSubType = kAudioUnitSubType_Reverb2;
reverb_desc.componentFlags = 0;
reverb_desc.componentFlagsMask = 0;
reverb_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

//tone component
    AudioComponentDescription tone_desc;
tone_desc.componentType = kAudioUnitType_FormatConverter;
//tone_desc.componentSubType = kAudioUnitSubType_NewTimePitch;
    tone_desc.componentSubType = kAudioUnitSubType_Varispeed;
tone_desc.componentFlags = 0;
tone_desc.componentFlagsMask = 0;
tone_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

    AudioComponentDescription gOutput_desc;
gOutput_desc.componentType = kAudioUnitType_Output;
gOutput_desc.componentSubType = kAudioUnitSubType_GenericOutput;
gOutput_desc.componentFlags = 0;
gOutput_desc.componentFlagsMask = 0;
gOutput_desc.componentManufacturer = kAudioUnitManufacturer_Apple;

//Add nodes to graph

// Add nodes to the graph to hold our AudioUnits,
// You pass in a reference to the  AudioComponentDescription
// and get back an  AudioUnit
    AUGraphAddNode(mGraph, &filePlayer_desc, &filePlayerNode );
    AUGraphAddNode(mGraph, &filePlayer2_desc, &filePlayerNode2 );
    AUGraphAddNode(mGraph, &mixer_desc, &mixerNode );
    AUGraphAddNode(mGraph, &reverb_desc, &reverbNode );
    AUGraphAddNode(mGraph, &tone_desc, &toneNode );
AUGraphAddNode(mGraph, &gOutput_desc, &gOutputNode);

//Open the graph early, initialize late
// open the graph AudioUnits are open but not initialized (no resource allocation occurs here)

CheckError(AUGraphOpen(mGraph),"Couldn't Open the graph");

//Reference to Nodes
// get the reference to the AudioUnit object for the file player graph node
AUGraphNodeInfo(mGraph, filePlayerNode, NULL, &mFilePlayer);
AUGraphNodeInfo(mGraph, filePlayerNode2, NULL, &mFilePlayer2);
    AUGraphNodeInfo(mGraph, reverbNode, NULL, &mReverb);
    AUGraphNodeInfo(mGraph, toneNode, NULL, &mTone);
    AUGraphNodeInfo(mGraph, mixerNode, NULL, &mMixer);
AUGraphNodeInfo(mGraph, gOutputNode, NULL, &mGIO);

    AUGraphConnectNodeInput(mGraph, filePlayerNode, 0, reverbNode, 0);
    AUGraphConnectNodeInput(mGraph, reverbNode, 0, toneNode, 0);
    AUGraphConnectNodeInput(mGraph, toneNode, 0, mixerNode,0);
    AUGraphConnectNodeInput(mGraph, filePlayerNode2, 0, mixerNode, 1);
AUGraphConnectNodeInput(mGraph, mixerNode, 0, gOutputNode, 0);

    UInt32 busCount   = 2;    // bus count for mixer unit input

//Setup mixer unit bus count
    CheckError(AudioUnitSetProperty (
                                 mMixer,
                                 kAudioUnitProperty_ElementCount,
                                 kAudioUnitScope_Input,
                                 0,
                                 &busCount,
                                 sizeof (busCount)
                                 ),
           "Couldn't set mixer unit's bus count");

//Enable metering mode to view levels input and output levels of mixer
    UInt32 onValue = 1;
    CheckError(AudioUnitSetProperty(mMixer,
                                kAudioUnitProperty_MeteringMode,
                                kAudioUnitScope_Input,
                                0,
                                &onValue,
                                sizeof(onValue)),
           "error");

// Increase the maximum frames per slice allows the mixer unit to accommodate the
//    larger slice size used when the screen is locked.
    UInt32 maximumFramesPerSlice = 4096;

    CheckError(AudioUnitSetProperty (
                                 mMixer,
                                 kAudioUnitProperty_MaximumFramesPerSlice,
                                 kAudioUnitScope_Global,
                                 0,
                                 &maximumFramesPerSlice,
                                 sizeof (maximumFramesPerSlice)
                                 ),
           "Couldn't set mixer units maximum framers per slice");

// set the audio data format of tone Unit
    AudioUnitSetProperty(mTone,
                     kAudioUnitProperty_StreamFormat,
                     kAudioUnitScope_Global,
                     0,
                     &stereoStreamFormat864,
                     sizeof(AudioStreamBasicDescription));
// set the audio data format of reverb Unit
    AudioUnitSetProperty(mReverb,
                     kAudioUnitProperty_StreamFormat,
                     kAudioUnitScope_Global,
                     0,
                     &stereoStreamFormat864,
                     sizeof(AudioStreamBasicDescription));

// set initial reverb
    AudioUnitParameterValue reverbTime = 2.5;
    AudioUnitSetParameter(mReverb, 4, kAudioUnitScope_Global, 0, reverbTime, 0);
    AudioUnitSetParameter(mReverb, 5, kAudioUnitScope_Global, 0, reverbTime, 0);
    AudioUnitSetParameter(mReverb, 0, kAudioUnitScope_Global, 0, 0, 0);

    AudioStreamBasicDescription     auEffectStreamFormat;
    UInt32 asbdSize = sizeof (auEffectStreamFormat);
memset (&auEffectStreamFormat, 0, sizeof (auEffectStreamFormat ));

// get the audio data format from reverb
CheckError(AudioUnitGetProperty(mReverb,
                                kAudioUnitProperty_StreamFormat,
                                kAudioUnitScope_Input,
                                0,
                                &auEffectStreamFormat,
                                &asbdSize),
           "Couldn't get aueffectunit ASBD");

    auEffectStreamFormat.mSampleRate = graphSampleRate;

// set the audio data format of mixer Unit
    CheckError(AudioUnitSetProperty(mMixer,
                                kAudioUnitProperty_StreamFormat,
                                kAudioUnitScope_Output,
                                0,
                                &auEffectStreamFormat, sizeof(auEffectStreamFormat)),
           "Couldn't set ASBD on mixer output");

CheckError(AUGraphInitialize(mGraph),"Couldn't Initialize the graph");

    [self setUpAUFilePlayer];
    [self setUpAUFilePlayer2];  
} 
```

//音频文件播放设置这里我是设置语音文件

```
-(OSStatus) setUpAUFilePlayer{
NSString *songPath = [[NSBundle mainBundle] pathForResource: @"testVoice" ofType:@".m4a"];
CFURLRef songURL = ( CFURLRef) [NSURL fileURLWithPath:songPath];

// open the input audio file
CheckError(AudioFileOpenURL(songURL, kAudioFileReadPermission, 0, &inputFile),
           "setUpAUFilePlayer AudioFileOpenURL failed");

AudioStreamBasicDescription fileASBD;
// get the audio data format from the file
UInt32 propSize = sizeof(fileASBD);
CheckError(AudioFileGetProperty(inputFile, kAudioFilePropertyDataFormat,
                                &propSize, &fileASBD),
           "setUpAUFilePlayer couldn't get file's data format");

// tell the file player unit to load the file we want to play
CheckError(AudioUnitSetProperty(mFilePlayer, kAudioUnitProperty_ScheduledFileIDs,
                                kAudioUnitScope_Global, 0, &inputFile, sizeof(inputFile)),
           "setUpAUFilePlayer AudioUnitSetProperty[kAudioUnitProperty_ScheduledFileIDs] failed");

UInt64 nPackets;
UInt32 propsize = sizeof(nPackets);
CheckError(AudioFileGetProperty(inputFile, kAudioFilePropertyAudioDataPacketCount,
                                &propsize, &nPackets),
           "setUpAUFilePlayer AudioFileGetProperty[kAudioFilePropertyAudioDataPacketCount] failed");

// tell the file player AU to play the entire file
ScheduledAudioFileRegion rgn;
memset (&rgn.mTimeStamp, 0, sizeof(rgn.mTimeStamp));
rgn.mTimeStamp.mFlags = kAudioTimeStampSampleTimeValid;
rgn.mTimeStamp.mSampleTime = 0;
rgn.mCompletionProc = NULL;
rgn.mCompletionProcUserData = NULL;
rgn.mAudioFile = inputFile;
rgn.mLoopCount = -1;
rgn.mStartFrame = 0;
rgn.mFramesToPlay = nPackets * fileASBD.mFramesPerPacket;

if (MaxSampleTime < rgn.mFramesToPlay)
{
    MaxSampleTime = rgn.mFramesToPlay;
}

CheckError(AudioUnitSetProperty(mFilePlayer, kAudioUnitProperty_ScheduledFileRegion,
                                kAudioUnitScope_Global, 0,&rgn, sizeof(rgn)),
           "setUpAUFilePlayer1 AudioUnitSetProperty[kAudioUnitProperty_ScheduledFileRegion] failed");

// prime the file player AU with default values
UInt32 defaultVal = 0;

CheckError(AudioUnitSetProperty(mFilePlayer, kAudioUnitProperty_ScheduledFilePrime,
                                kAudioUnitScope_Global, 0, &defaultVal, sizeof(defaultVal)),
           "setUpAUFilePlayer AudioUnitSetProperty[kAudioUnitProperty_ScheduledFilePrime] failed");

// tell the file player AU when to start playing (-1 sample time means next render cycle)
AudioTimeStamp startTime;
memset (&startTime, 0, sizeof(startTime));
startTime.mFlags = kAudioTimeStampSampleTimeValid;

startTime.mSampleTime = -1;
CheckError(AudioUnitSetProperty(mFilePlayer, kAudioUnitProperty_ScheduleStartTimeStamp,
                                kAudioUnitScope_Global, 0, &startTime, sizeof(startTime)),
           "setUpAUFilePlayer AudioUnitSetProperty[kAudioUnitProperty_ScheduleStartTimeStamp]");

return noErr;  
} 
```

//音频文件播放设置这里我设置的是BGMusic文件

```
-(OSStatus) setUpAUFilePlayer2{
NSString *songPath = [[NSBundle mainBundle] pathForResource: @"BGmusic" ofType:@".mp3"];
CFURLRef songURL = ( CFURLRef) [NSURL fileURLWithPath:songPath];

// open the input audio file
CheckError(AudioFileOpenURL(songURL, kAudioFileReadPermission, 0, &inputFile2),
           "setUpAUFilePlayer2 AudioFileOpenURL failed");

AudioStreamBasicDescription fileASBD;
// get the audio data format from the file
UInt32 propSize = sizeof(fileASBD);
CheckError(AudioFileGetProperty(inputFile2, kAudioFilePropertyDataFormat,
                                &propSize, &fileASBD),
           "setUpAUFilePlayer2 couldn't get file's data format");

// tell the file player unit to load the file we want to play
CheckError(AudioUnitSetProperty(mFilePlayer2, kAudioUnitProperty_ScheduledFileIDs,
                                kAudioUnitScope_Global, 0, &inputFile2, sizeof(inputFile2)),
           "setUpAUFilePlayer2 AudioUnitSetProperty[kAudioUnitProperty_ScheduledFileIDs] failed");

UInt64 nPackets;
UInt32 propsize = sizeof(nPackets);
CheckError(AudioFileGetProperty(inputFile2, kAudioFilePropertyAudioDataPacketCount,
                                &propsize, &nPackets),
           "setUpAUFilePlayer2 AudioFileGetProperty[kAudioFilePropertyAudioDataPacketCount] failed");

// tell the file player AU to play the entire file
ScheduledAudioFileRegion rgn;
memset (&rgn.mTimeStamp, 0, sizeof(rgn.mTimeStamp));
rgn.mTimeStamp.mFlags = kAudioTimeStampSampleTimeValid;
rgn.mTimeStamp.mSampleTime = 0;
rgn.mCompletionProc = NULL;
rgn.mCompletionProcUserData = NULL;
rgn.mAudioFile = inputFile2;
rgn.mLoopCount = -1;
rgn.mStartFrame = 0;
rgn.mFramesToPlay = nPackets * fileASBD.mFramesPerPacket;

if (MaxSampleTime < rgn.mFramesToPlay)
{
    MaxSampleTime = rgn.mFramesToPlay;
}

CheckError(AudioUnitSetProperty(mFilePlayer2, kAudioUnitProperty_ScheduledFileRegion,
                                kAudioUnitScope_Global, 0,&rgn, sizeof(rgn)),
           "setUpAUFilePlayer2 AudioUnitSetProperty[kAudioUnitProperty_ScheduledFileRegion] failed");

// prime the file player AU with default values
UInt32 defaultVal = 0;
CheckError(AudioUnitSetProperty(mFilePlayer2, kAudioUnitProperty_ScheduledFilePrime,
                                kAudioUnitScope_Global, 0, &defaultVal, sizeof(defaultVal)),
           "setUpAUFilePlayer2 AudioUnitSetProperty[kAudioUnitProperty_ScheduledFilePrime] failed");

// tell the file player AU when to start playing (-1 sample time means next render cycle)
AudioTimeStamp startTime;
memset (&startTime, 0, sizeof(startTime));
startTime.mFlags = kAudioTimeStampSampleTimeValid;
startTime.mSampleTime = -1;
CheckError(AudioUnitSetProperty(mFilePlayer2, kAudioUnitProperty_ScheduleStartTimeStamp,
                                kAudioUnitScope_Global, 0, &startTime, sizeof(startTime)),
           "setUpAUFilePlayer2 AudioUnitSetProperty[kAudioUnitProperty_ScheduleStartTimeStamp]");

return noErr;  
} 
```

//开始保存文件

```
- (void)startRecordingAAC{
AudioStreamBasicDescription destinationFormat;
memset(&destinationFormat, 0, sizeof(destinationFormat));
destinationFormat.mChannelsPerFrame = 2;
destinationFormat.mFormatID = kAudioFormatMPEG4AAC;
UInt32 size = sizeof(destinationFormat);
OSStatus result = AudioFormatGetProperty(kAudioFormatProperty_FormatInfo, 0, NULL, &size, &destinationFormat);
if(result) printf("AudioFormatGetProperty %ld \n", result);
NSArray  *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];

NSString *destinationFilePath = [[NSString alloc] initWithFormat: @"%@/output.m4a", documentsDirectory];
CFURLRef destinationURL = CFURLCreateWithFileSystemPath(kCFAllocatorDefault,
                                                        (CFStringRef)destinationFilePath,
                                                        kCFURLPOSIXPathStyle,
                                                        false);
[destinationFilePath release];

// specify codec Saving the output in .m4a format
result = ExtAudioFileCreateWithURL(destinationURL,
                                   kAudioFileM4AType,
                                   &destinationFormat,
                                   NULL,
                                   kAudioFileFlags_EraseFile,
                                   &extAudioFile);
if(result) printf("ExtAudioFileCreateWithURL %ld \n", result);
CFRelease(destinationURL);

// This is a very important part and easiest way to set the ASBD for the File with correct format.
AudioStreamBasicDescription clientFormat;
UInt32 fSize = sizeof (clientFormat);
memset(&clientFormat, 0, sizeof(clientFormat));
// get the audio data format from the Output Unit
CheckError(AudioUnitGetProperty(mGIO,
                                kAudioUnitProperty_StreamFormat,
                                kAudioUnitScope_Output,
                                0,
                                &clientFormat,
                                &fSize),"AudioUnitGetProperty on failed");

// set the audio data format of mixer Unit
CheckError(ExtAudioFileSetProperty(extAudioFile,
                                   kExtAudioFileProperty_ClientDataFormat,
                                   sizeof(clientFormat),
                                   &clientFormat),
           "ExtAudioFileSetProperty kExtAudioFileProperty_ClientDataFormat failed");
// specify codec
UInt32 codec = kAppleHardwareAudioCodecManufacturer;
CheckError(ExtAudioFileSetProperty(extAudioFile,
                                   kExtAudioFileProperty_CodecManufacturer,
                                   sizeof(codec),
                                   &codec),"ExtAudioFileSetProperty on extAudioFile Faild");

CheckError(ExtAudioFileWriteAsync(extAudioFile, 0, NULL),"ExtAudioFileWriteAsync Failed");

[self pullGenericOutput];
} 
```

// 从 GenericOutput 节点手动输入和获取数据/缓冲区。

```
-(void)pullGenericOutput{
AudioUnitRenderActionFlags flags = 0;
AudioTimeStamp inTimeStamp;
memset(&inTimeStamp, 0, sizeof(AudioTimeStamp));
inTimeStamp.mFlags = kAudioTimeStampSampleTimeValid;
UInt32 busNumber = 0;
UInt32 numberFrames = 512;
inTimeStamp.mSampleTime = 0;
int channelCount = 2;

NSLog(@"Final numberFrames :%li",numberFrames);
int totFrms = MaxSampleTime;
while (totFrms > 0)
{
    if (totFrms < numberFrames)
    {
        numberFrames = totFrms;
        NSLog(@"Final numberFrames :%li",numberFrames);
    }
    else
    {
        totFrms -= numberFrames;
    }
    AudioBufferList *bufferList = (AudioBufferList*)malloc(sizeof(AudioBufferList)+sizeof(AudioBuffer)*(channelCount-1));
    bufferList->mNumberBuffers = channelCount;
    for (int j=0; j<channelCount; j++)
    {
        AudioBuffer buffer = {0};
        buffer.mNumberChannels = 1;
        buffer.mDataByteSize = numberFrames*sizeof(AudioUnitSampleType);
        buffer.mData = calloc(numberFrames, sizeof(AudioUnitSampleType));

        bufferList->mBuffers[j] = buffer;

    }
    CheckError(AudioUnitRender(mGIO,
                               &flags,
                               &inTimeStamp,
                               busNumber,
                               numberFrames,
                               bufferList),
               "AudioUnitRender mGIO");

    CheckError(ExtAudioFileWrite(extAudioFile, numberFrames, bufferList),("extaudiofilewrite fail"));

}

[self FilesSavingCompleted];
} 
```

//文件保存完成

```
-(void)FilesSavingCompleted{
OSStatus status = ExtAudioFileDispose(extAudioFile);
printf("OSStatus(ExtAudioFileDispose): %ld\n", status);
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-08T16:01:06.570

进行离线渲染的一种方法是删除 RemoteIO 单元并显式调用`AudioUnitRender`图形中最右侧的单元（混音器或混响单元，具体取决于您的拓扑）。通过循环执行此操作，直到您耗尽两个源文件中的样本，并使用扩展音频文件服务写入生成的样本缓冲区，您可以创建混音的压缩音频文件。您需要在后台线程上执行此操作以保持 UI 响应，但我之前使用过这种技术并取得了一些成功。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-04T07:12:53.417

以上代码适用于 iOS7 设备，但不适用于 iOS8 设备和所有模拟器。我已经替换了以下代码段

```
UInt32 category = kAudioSessionCategory_MediaPlayback;
    CheckError(AudioSessionSetProperty(kAudioSessionProperty_AudioCategory,
                                   sizeof(category),
                                   &category),
           "Couldn't set category on audio session"); 
```

使用以下代码。因为 AudioSessionSetProperty 已被弃用，所以我替换了以下代码。

```
AVAudioSession *session = [AVAudioSession sharedInstance];

        NSError *setCategoryError = nil;
        if (![session setCategory:AVAudioSessionCategoryPlayback
                      withOptions:AVAudioSessionCategoryOptionMixWithOthers
                            error:&setCategoryError]) {
            // handle error
        } 
```

iOS 8 必须有一些更新。可以在上面的代码中或在其他地方。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-05-03T07:08:22.687

我遵循 Abdusha 的方法，但我的输出文件没有音频，而且与输入相比，它的大小非常小。在调查之后，我在“pullGenericOutput”函数中做了一个修复。在 AudioUnitRender 调用之后：

```
AudioUnitRender(genericOutputUnit,
                                   &flags,
                                   &inTimeStamp,
                                   busNumber,
                                   numberFrames,
                                       bufferList);

inTimeStamp.mSampleTime++; //Updated 
```

将 timeStamp 增加 1。完成此操作后，输出文件非常适合效果工作。谢谢。你的回答很有帮助。

# php - PHP TinyMCE在textarea中输入php？

> ID：15297995
> 
> 赞同：0
> 
> 时间：2013-03-08T15:53:55.513
> 
> 标签：php, function, tinymce

我刚刚开始使用 TinyMCE，并在论坛中四处寻找我的问题的答案，但我发现的只是一个过时的插件，可以解决我的问题。

回到这个问题，是否有可能以某种方式在 textarea 中键入 ie，然后在我从数据库中检索信息时让它调用该函数？

我考虑过制作某种类型的 BBCode ([php] callFunction(); [/php]) 来完成这项工作，我在正确的轨道上吗？

只是为了让自己清楚，请指出我正确的方向！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T16:02:38.037

是的，如果你使用 [php] callFunction(); [/php] 你可以用它`preg_match()`来查找php代码，然后用`exec()`它来运行它。

确保您有很好的安全性并验证谁已登录以及他们正在尝试运行哪些功能。

# java - 在 Android 中异步更新 UI

> ID：15297996
> 
> 赞同：1
> 
> 时间：2013-03-08T15:53:55.910
> 
> 标签：java, android, android-sdk-2.3

我有一个每 10 秒调用一次的 web 服务调用，并且应该使用 web 服务回复更新一个 TextView（或至少每 10 秒显示一条 toast 消息）

但是用户界面根本没有更新。

请在下面找到代码。

```
public class MessagesRequestActivity extends Activity  {
    /** Called when the activity is first created. */
    String currentMsg="Default";
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.main);

        //Calling the webservice
        getMessage();
    }
    public void getMessage(){

        try
        {
        SoapObject request = new SoapObject("http://tempuri.org/", "getMessage");

        SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true;
        envelope.setOutputSoapObject(request);

        //Web method call
        HttpTransportSE androidHttpTransport = new HttpTransportSE("http://192.168.4.50/WebService.asmx");
        androidHttpTransport.call("http://tempuri.org/"+ "getMessage", envelope);
        //get the response
        SoapPrimitive response = (SoapPrimitive)envelope.getResponse();

        //the response object can be retrieved by its name: result.getProperty("objectName");
        String message = (String)response.toString();
        Toast.makeText(this, message, Toast.LENGTH_LONG).show();

        }
        catch (Exception e)
        {
        e.printStackTrace();
        }
        try {
            Thread.sleep(10000);
        } catch (InterruptedException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }
        }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-08T16:00:21.203

正如每个人都提到的，您正在 UI 线程中进行网络调用并执行 Thread.Sleep() 冻结您的 UI。

我会尝试这样的 AsyncHttpClient 类，它具有您需要的所有功能，您必须在回调中执行 UI 更新。

[http://loopj.com/android-async-http/](http://loopj.com/android-async-http/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-08T16:01:00.357

这是一个示例`AsyncTask`

```
public class TalkToServer extends AsyncTask<String, String, String> {
@Override
protected void onPreExecute() {
    super.onPreExecute();
}

@Override
protected void onProgressUpdate(String... values) {
    super.onProgressUpdate(values);

}

@Override
protected String doInBackground(String... params) {
//do your work here
    return something;
}

@Override
protected void onPostExecute(String result) {
    super.onPostExecute(result);
       // do something with data here-display it or send to mainactivity
} 
```

然后你可以通过调用访问

```
TalksToServer varName = new TalkToServer(); //pass parameters if you need to the constructor
varName.execute(); 
```

[异步文档](http://developer.android.com/reference/android/os/AsyncTask.html) [进度对话框示例](https://stackoverflow.com/questions/9814821/show-progress-dialog-android)

你不想做网络`sleep`的事情或调用`UI`线程。如果它是一个内部类，那么您将可以访问外部类的成员变量。否则，如果要更新 from或其他方法，请在`AsyncTask`类中创建一个构造函数以传递。`context``onPostExecute``doInBackground()`

# java - 插入排序 - 降序

> ID：15297997
> 
> 赞同：2
> 
> 时间：2013-03-08T15:53:56.077
> 
> 标签：java, algorithm, sorting, insertion-sort

抱歉，如果这是一个基本问题...

我只是想了解更多关于算法的知识......

我编写了一个简单的代码来按升序执行插入排序，但由于某种原因，我无法使其按降序执行排序。

我尝试将比较键 (while (i > 0 && a[i] > key) 更改为 (i > 0 && a[i] < key)).. 它似乎部分工作，但第一个元素没有得到排序，我得到以下结果..有人可以让我知道我错在哪里吗？

1 11 10 9 5 4 3 2

```
public class InsertionSort {
    public static void main(String args[]) {
        int[] a = { 1,10,11,5, 9, 3, 2, 4 };
        // Loop through the entire array length. Consider you already have one
        // element in array, start comparing with
        // first element
        for (int j = 1; j < a.length; j++) {
            // Get the key (The value that needs to be compared with existing
            // values.
            int key = a[j];
            // Get the array index for comparison, we need to compare with all
            // other elements in the array with
            // key
            int i = j - 1;
            // While i > 0 and when key is less than the value in the array
            // shift the value and insert
            // the value appropriately.
            //System.out.println(j);
            while (i > 0 && a[i] < key) {
                a[i + 1] = a[i];
                i = i - 1;
                a[i + 1] = key;
            }
        }
        for (int k = 0; k < a.length; k++) {
            System.out.println(a[k]);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-08T15:56:52.913

你从不`a[0]`接触

```
while (i > 0 && a[i] < key) { 
```

所以它没有被分类到应有的位置。使用`>=`代替`>`：

```
while (i >= 0 && a[i] < key) { 
```

升序排序时也会出现同样的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-08T15:56:58.630

数组中的第一个元素是`a[0]`。你没有在任何地方比较它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-08T15:59:24.923

从 0 开始，使用数组 a[] 到达第一个元素 a[0]。所以 a[j] 中的第一个元素将是 a[0] 而不是 a[1]；

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-01T03:22:06.210

```
public static void insertionSort(int[] arr)
    {
        for (int i = 1; i < arr.length; i++)
        {
            int curNumber = arr[i];
            int curIndex = i-1;
            while ( curIndex >= 0 && arr[curIndex] < curNumber)
            {
                arr[curIndex+1] = arr[curIndex];
                curIndex--;
            }
            arr[curIndex+1] = curNumber;
        }
    } 
```