# StackOverflow 问答 14863000-14863999

# json - 我如何在jsp页面中使用restful api（返回json）

> ID：14863001
> 
> 赞同：0
> 
> 时间：2013-02-13T20:59:21.207
> 
> 标签：json, jsp, rest, web

在jsp页面中使用restful api（返回json）的酷方法是什么，我知道有很多方法但是哪一个应该是好的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:18:14.310

没有，真的：如果您需要 JSON，请返回 JSON，并使用框架来处理繁琐的工作。

如果你绝对必须，我会尽可能多地在 Java 中做一些工作，比如设置响应头，将内容转换为 JavaScript 安全的字符串，等等，并且*只*使用 JSP进行演示。

就是说，当您可以使用许多库中的任何一个以零工作量直接从 Java 编写转换后的数据时，我认为在 JSP 中处理任何这些数据的好处几乎为零。

知道您*为什么*要使用 JSP 可能会更容易回答*在您的特定情况下*“最佳”方式是什么：这里的“最佳”具有“首先不要在 JSP 中这样做”的上限。

# gnuplot - 第二个 y 轴上的缺失值

> ID：14863002
> 
> 赞同：4
> 
> 时间：2013-02-13T20:59:23.443
> 
> 标签：gnuplot, multiple-axes

我想绘制 3 组 y 值，其中我想在一个 Y 轴上显示“温度”的值，在另一个 y 轴上显示“总能量”和“势能”值。我的绘图命令是：

```
plot "traj_read.out" using 3:7 title 'Temperature' w lines, \
"traj_read.out" using 3:4 axes x1y2 title 'Total Energy' w lines, \
"traj_read.out" using 3:6 axes x1y2 title 'Potential Energy' w lines 
```

线条显示良好，但左侧 Y 轴上仅显示“温度”的值，右侧 y 轴上的值缺失。

希望有人对如何缩放这些轴有提示！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T21:47:00.740

尝试：

```
set ytics nomirror
set y2tics 
```

默认情况下不打开 y2 轴抽动。

# sql-server-2008 - 从一组运行值中选择最旧和最新的值

> ID：14863003
> 
> 赞同：2
> 
> 时间：2013-02-13T20:59:25.983
> 
> 标签：sql-server-2008

我正在尝试使用 MSSQL 2008 在指定的日期窗口中获取运行（因为没有更好的术语）值的最旧和最新值，我正在努力。表格如下所示：

```
Job      Date         Percent_complete
---      ----         ----------------
1        1/5/2013     5
2        1/10/2013    5
2        1/25/2013    15
2        2/15/2013    25
3        2/15/2013    5
1        2/10/2013    10
1        2/23/2013    20
1        2/24/2013    18
4        1/12/2013    40 
```

例如，在我的查询中，我想询问 2/1/2013 - 2/28/2013 最旧和最新的 percent_complete 并获得：

```
Job   Old    New
---   ---    ---
1     5      18
2     15     25
3     0      5
4     40     40 
```

...所以这里的问题是开始日期之前的最后一个 percent_complete 值必须结转，如果没有记录（例如作业 3），则需要假设为 0。此外，该数字可能会从高位向后退，就像工作 1 一样......所以`min(complete)`不会`max(complete)`让我们到达那里。此外，我还为 Job 4 添加了一条记录，以说明报告窗口中没有记录时的预期结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:52:58.463

我可以得到这样的结果：

```
with max_percent as
(
  select Job
    , [Max] = max(Percent_complete)
  from jobs
  where [Date] between '2/1/2013' and '2/28/2013'
  group by Job
),
min_percent as
(
  select Job
    , [Max] = max(Percent_complete)
  from jobs
  where [Date] < '2/1/2013'
  group by Job
)
select Job = coalesce(mn.Job, mx.Job)
  , [Min] = case when mx.Job is not null then mn.[Max] else 0 end
  , [Max] = coalesce(mx.[Max], mn.[Max], 0)
from max_percent mx
  full join min_percent mn on mx.Job = mn.Job
order by Job 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!3/24f41/6)。

但是理解您的要求有点困难，所以我不确定这是否适用于所有情况下的数据。如果您在问题中添加更多数据和预期结果，我可以根据需要进行更新。

**评论后编辑：**

这个新查询给出了您所追求的结果：

```
with jobList as
(
  select distinct Job from jobs
)
select Job
  , [Min] = isnull(case when mx.[Max] is not null then mn.[Max] else 0 end, 0)
  , [Max] = coalesce(mx.[Max], mn.[Max], 0)

from jobList jl
  outer apply
  (
    select top 1 [Max] = j.Percent_complete
    from jobs j
    where [Date] between '2/1/2013' and '2/28/2013'
      and jl.Job = j.Job
    order by j.[Date] desc
  ) mx
  outer apply
  (
    select top 1 [Max] = j.Percent_complete
    from jobs j
    where [Date] < '2/1/2013'
      and jl.Job = j.Job
    order by j.[Date] desc
  ) mn
order by jl.Job 
```

[SQL Fiddle 与演示](http://sqlfiddle.com/#!3/29803/9)。

同样，它只针对一个小数据集，但它按日期取最高值，而不仅仅是最大百分比，所以希望能让你朝着正确的方向前进。

**第二次编辑：**

只需稍微更改查询即可获得新结果：

```
with jobList as
(
  select distinct Job from jobs
)
select Job
  , [Min] = isnull(mn.[Max], 0)
  , [Max] = coalesce(mx.[Max], mn.[Max], 0)

from jobList jl
  outer apply
  (
    select top 1 [Max] = j.Percent_complete
    from jobs j
    where [Date] between '2/1/2013' and '2/28/2013'
      and jl.Job = j.Job
    order by j.[Date] desc
  ) mx
  outer apply
  (
    select top 1 [Max] = j.Percent_complete
    from jobs j
    where [Date] < '2/1/2013'
      and jl.Job = j.Job
    order by j.[Date] desc
  ) mn
order by jl.Job 
```

[SQL Fiddle 与演示](http://sqlfiddle.com/#!3/84309/3)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T18:50:08.600

这是另一种方法：

**步骤 1.**选择`Date`值不晚于所选月份的行，将每个作业的数据分成两个分区：所选月份数据进入`New`分区，其余进入分区`Old`。

应用于您的示例，这将产生以下结果集：

```
工作日期 Percent_complete  新近度
--- ---- ---- --------   1 1/5/2013 
5                 旧 
2 1/10/2013 5                 旧 
2 1/25/2013 15                旧 
2 2/15/2013 25                新 
3 1/15/2013 5                 新 
1 2/10/2013 10                新 
1 2/23/2013 20                新 
1 2/24/2013 18                新 
4 1 /12/2013 40                旧 

```

**步骤 2.**按降序排列每个分区中的行`Date`：

```
工作日期 Percent_complete 新近度  rnk 
--- ---- ---- --------   --- 
1 1/5/2013 5 旧      1   
2 1/ 10/2013 5 旧      2   
2 1/25/2013 15 旧      1   
2 2/15/2013 25 新      1   
3 1/15/2013 5 新      1   
1 2/10/2013 10 新      3   
1 2/23/2013 20 新      2   
1 2013 年 2 月 24 日 18 新      1   
4 2013 年 1 月 12 日 40 旧      1 

```

**步骤 3.**仅获取排名为 1 的行：

```
工作日期 Percent_complete 新近度 rnk
--- ---- ---- -------- ---
1 2013 年 1 月 5 日 5 旧 1
2 2013 年 1 月 25 日 15 旧 1
2 2013 年 2 月 15 日 25 新 1
3 2013 年 1 月 15 日 5 新 1
1 2013 年 2 月 24 日 18 新 1

```

**步骤 4.**将百分比和默认任何`Old`NULL 设置为 0，并`New`设置为`Old`：

```
工作 旧 新
--- --- ---
1 5 18
2 15 25
3 0 5

```

以下查询实现了上述逻辑：

```
WITH partitioned AS (
  SELECT
    Job,
    Date,
    Percent_complete,
    recency = CASE
      WHEN Date >= '20130201' THEN 'NEW'
      ELSE 'Old'
    END
  FROM atable
  WHERE Date < '20130301'
)
, ranked AS (
  SELECT
    Job,
    Date,
    Percent_complete,
    recency,
    rnk = ROW_NUMBER() OVER (PARTITION BY Job, recency ORDER BY Date DESC)
  FROM partitioned
)
, filtered AS (
  SELECT
    Job,
    Percent_complete,
    recency
  FROM ranked
  WHERE rnk = 1
)
, pivoted AS (
  SELECT
    Job,
    Old = ISNULL(Old, 0),
    New = ISNULL(New, Old)
  FROM filtered
  PIVOT (
    MAX(Percent_complete) FOR recency IN (Old, New)
  ) u
)
SELECT *
FROM pivoted
; 
```

[您可以在 SQL Fiddle](http://sqlfiddle.com/#!3/c1d05/1)测试此查询。

# ios - 使用 HTTP 网络处理 Internet 连接变化的最佳方法

> ID：14863007
> 
> 赞同：6
> 
> 时间：2013-02-13T20:59:42.757
> 
> 标签：ios, objective-c, networking, httprequest, nsoperation

通常，在使用大量 HTTP 请求与服务器通信的 iOS 应用程序中，我将 NSBlockOperation 添加到应用程序的全局 NSOperationQueue，然后在应用程序检测到 Internet 连接状态发生变化时暂停并启用队列，从而节省任何当前在队列中的请求，直到队列解除挂起。但是，我不完全确定这样，当前正在运行的任何操作都会停止，然后重新添加到队列的顶部。

我的问题是：当您使用对远程服务器的 HTTP 请求（即暂停、恢复、取消请求等）时，是否有更好的方法来处理网络状态的变化......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T03:39:46.827

您可以使用[Reachability](https://github.com/tonymillion/Reachability)类来检测网络状态何时发生变化，以避免发送请求。这是基于[Apple 提供的一些示例代码](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)并从其更新而来的。这将让您知道 Internet 连接何时更改而无需轮询。

据我所知，这是检测网络可用性的最佳方法。当网络再次可用时，您会收到即时通知。我相信它甚至会告诉您可用的连接类型（WiFi 或蜂窝网络）。

如果在发出请求时连接断开，您将不得不像现在一样处理这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T12:12:49.420

[只是我的想法-您应该像这里一样](https://stackoverflow.com/questions/4492811/cancel-nsoperation-in-for-loop "NSOperation取消")（手动）添加取消操作。当您检测到网络状态变化（无连接）时，您可以取消当前操作、暂停队列、通知某些管理器以便它可以重新安排操作。当网络可用时，恢复队列。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T13:29:38.003

交易就是为了这个目的。您需要使您的 ws 调用*原子*化，也就是说，您启动一​​个事务、进行调用、获取响应并提交事务。然后你就可以确定你的任务已经完成了。

在其他情况下，您再次启动事务，进行 ws 调用，ws 调用失败并且您无法获得响应，无论出于何种原因，您回滚事务并记录/报告这种情况。你只需要确定你是否真的不能承受错过的 ws 调用。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-21T17:04:50.557

正如 Luke 所建议的，[Apple sample](http://developer.apple.com/library/ios/#samplecode/Reachability/Introduction/Intro.html)最好处理这个问题。但我也想解决您对网络连接中更改检测的需求。这是通过观察名为 kReachabilityChangedNotification 的通知来处理的。

换句话说，您的视图控制器或委托代码必须具有以下部分才能处理网络可达性（阅读“连接性”）更改：

```
[[NSNotificationCenter defaultCenter] addObserver: self selector: @selector(reachabilityChanged:) name: kReachabilityChangedNotification object: nil]; 
```

和

```
//Called by Reachability whenever status changes.    
- (void) reachabilityChanged: (NSNotification* )note    
{    
      Reachability* curReach = [note object];        
      //TODO: Your specific handling.
} 
```

# javascript - 如何在标识符中使用 % 符号

> ID：14863010
> 
> 赞同：6
> 
> 时间：2013-02-13T20:59:56.267
> 
> 标签：javascript, syntax, v8, identifier

浏览[v8](http://code.google.com/p/v8/)树，在`src`目录下，有一些 js 文件，提供一些基本的 JS 对象，如 Math、Array 等。浏览这些文件，我看到标识符中包含百分号 (%)，即`%Foo`. 我一开始天真地以为这是 JS 标识符中允许的其他字符，但是当我在 shell 中尝试时，它对我大喊大叫，说我违反了语法规则。但如果是语法错误，那么 d8 是如何工作的呢？以下是来自实际源代码的示例：

*src/apinatives.js 第 44 到 47 行，来自 github/v8/v8 的 git clone*

```
function Instantiate(data, name) {
  if (!%IsTemplate(data)) return data;
      var tag = %GetTemplateField(data, kApiTagOffset);
      switch (tag) { 
```

*src/apinatives.js 第 41 到 43 行，来自 github/v8/v8 的 git clone*

```
function SetConstructor() {
  if (%_IsConstructCall()) {
    %SetInitialize(this); 
```

为什么这个标识符不会产生语法错误。所有 js 文件，包括 math.js 和 string.js 以及所有其他文件？：wq

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-13T21:42:38.967

它在技术上不是有效的 JavaScript。这些是对 V8[运行时函数](https://code.google.com/p/v8/wiki/RuntimeFunctions)的调用。从该页面：

> 大部分 JavaScript 库是在 JavaScript 代码本身中实现的，使用可从 JavaScript 调用的最小 C++ 运行时函数集。其中一些使用以 % 开头的名称并使用标志“--allow-natives-syntax”来调用。其他的仅由代码生成器生成的代码调用，在 JS 中不可见，即使使用 % 语法也是如此。

如果你看一下，[`parser.cc`](https://code.google.com/p/v8/source/browse/trunk/src/parser.cc?r=17579#3619)你会看到一些与它相关的代码，`allow_natives_syntax`它决定了解析器是否会接受这个对 V8 用于与其运行时交互的 JavaScript 语言的扩展。必须在启用该选项的情况下解析这些文件。

我推测 V8 默认情况下不允许您进行这些调用，因为它与 JavaScript 标准相矛盾，并且因为它可能允许您对运行时执行您不应该执行的操作。

# java - 弱引用，意外的对象删除

> ID：14863014
> 
> 赞同：1
> 
> 时间：2013-02-13T21:00:07.303
> 
> 标签：java, weak-references

我对弱引用的理解：直到对象的所有强引用都丢失/删除之前，gc 无法将对象标记为删除。这意味着如果在某个时候，一个对象只被弱引用引用，那么该对象就有资格进行垃圾收集，并且下次 GC 运行时，它将标记该对象以删除。

***1.我的理解正确吗？***

为了验证我的理解，我创建了以下包含两个类的程序。

```
public class Customer {
    private String name;
    private String ssnId;
    private String phone;

    public Customer(String name, String ssnId, String phone) {
        this.name = name;
        this.phone = phone;
        this.ssnId = ssnId;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getSsnId() {
        return ssnId;
    }
    public void setSsnId(String ssnId) {
        this.ssnId = ssnId;
    }
    public String getPhone() {
        return phone;
    }
    public void setPhone(String phone) {
        this.phone = phone;
    }

    public String toString()
    {
        return ssnId + name + phone; 
    }

} 
```

和

```
public class TestClass {

    public static void main(String[] args) {
        Customer cust = new Customer("ABCD", "001 ", "Phone Number");
        WeakReference<Customer> weakcust = new WeakReference<Customer>(cust);
        int i = 0;
        while(true)
        {
            if(weakcust.get() != null)
            {
                i++;
                System.out.println(i + " " + weakcust.get());
            }
            else
            {
                System.err.println("Object's deleted");
                break;
            }
        }
    }
} 
```

从逻辑上讲，这段代码应该继续打印客户的信息。

令我惊讶的是，我发现即使我没有将 cust 引用设置为 null，GC 也会删除 cust 指出的对象。一段时间后，程序会打印“Object's Deleted”</p>

***2.为什么会这样？***

我相信这可能是因为编译器正在优化代码，并且由于代码中不再使用 cust 引用，编译器自行将其设置为 null。如果我错了，请纠正我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:04:38.380

问题是您的强引用对象客户本身没有被任何人引用，除了弱引用（这是一个弱引用）。所以它被标记为垃圾收集。一旦客户被垃圾收集，你就会看到你看到的行为。
在现实世界的应用程序中，您的客户会在某处被引用，并且只有当它被取消引用时，才会被垃圾回收。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:08:49.243

`cust`将变量分配给weakcust 后，您没有访问该变量。JVM 优化注意到您似乎不再需要它，因此它决定在之后丢弃它。

将其转换为静态变量`class Main`可能会改变这种行为。

# sql-server - Excel 2007 表单到 SQL Server

> ID：14863021
> 
> 赞同：3
> 
> 时间：2013-02-13T21:00:38.477
> 
> 标签：sql-server, forms, excel, ado, sync

我一直在到处寻找答案，但我将描述的问题没有成功。

我有一个经常手动更新的 Excel 工作表。我被要求以实时的方式将每一行更改推送到 Sql Server 中。我需要用户能够通过按下保存按钮将一行保存到服务器。

在 SSMS 中，我已经能够使用 OPENROWSET 从服务器读取数据，例如：

```
SELECT * 
FROM OPENROWSET('Microsoft.ACE.OLEDB.12.0',
'Excel 12.0;HDR=YES;Database=C:\tmp\test2.xlsm',
'SELECT * FROM [myrng]'); 
```

我还能够将数据从 Excel 插入到 SQL Server：

```
Insert into NEWDB.dbo.master 
Select * FROM OPENROWSET('Microsoft.ACE.OLEDB.12.0','Excel 
12.0;HDR=YES;Database=C:\tmp\test2.xlsm','SELECT * FROM [myrng]') 
```

当我尝试在 Excel 文件仍打开的情况下将数据查询、插入或更新回服务器时，就会出现问题。

我最终打算做的是构建一个向导应用程序来填充一个 Excel 表，在该过程结束时可以将其提交到相应的 SQL Server 表。

到目前为止，我一直在玩 VBA 和 ADO，但没有成功，有人建议我使用 DTS 或 SSIS，但我需要 Excel 文件一直保持打开状态。

在此先感谢，罗德里戈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:27:58.513

您可以针对与 Excel 的连接运行：

```
strCon = "Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" & ActiveWorkbook.FullName _
    & ";Extended Properties=""Excel 8.0;HDR=Yes;IMEX=1"";"

''Late binding, so no reference is needed

Set cn = CreateObject("ADODB.Connection")

cn.Open strCon

''A single value, but a query with parameters would be  better
ssql = "INSERT INTO [ODBC;DRIVER=SQL Server;SERVER=server;Trusted_Connection=Yes;DATABASE=Test].table_1 (Atext ) " _
& "Values ('" & Sheet1.[b3] & "')"

cn.Execute ssql 
```

或者

```
ssql = "INSERT INTO [ODBC;DRIVER=SQL Server;SERVER=server;" _
    & "Trusted_Connection=Yes;DATABASE=Test].table_1 ( Atext ) " _
    & "SELECT ACol FROM [Sheet1$b7:c9]" 
```

或者

```
ssql = "INSERT INTO [ODBC;DRIVER=SQL Server;SERVER=server;" _
    & "Trusted_Connection=Yes;DATABASE=Test].table_1 ( Atext ) " _
    & "SELECT Acol FROM Anamedrange" 
```

如果 HDR=No，则使用 F1、F2 等作为各个列的名称，从范围中的第一列开始编号。

这在 Excel 中也适用于我，在此示例中，我使用了对 Microsoft ActiveX 数据对象 xx 库的引用，但后期绑定也可以正常工作。

```
Dim cn As New ADODB.Connection
Dim cmd As New ADODB.Command
cn.Open servercon

cmd.ActiveConnection = cn

cmd.CommandText = "insert_user" ''Stored procedure
cmd.CommandType = adCmdStoredProc
cmd.Parameters("@username").Value = Worksheets("Sheet1").Cells(3, 2)
cmd.Execute 
```

# javascript - 带有阻塞代码的 setTimeout 行为

> ID：14863022
> 
> 赞同：8
> 
> 时间：2013-02-13T21:00:39.377
> 
> 标签：javascript, settimeout

[这是我的测试代码（在这里](http://jsfiddle.net/Xvh55/)小提琴）：

```
console.log('Before wait');
setTimeout(function () { console.log('Yo!'); }, 1000);
var start = Date.now();
while (Date.now() < start + 3000) {}
console.log('After wait'); 
```

这是 Chrome 中事件的时间线：

*   时间 0 秒：打印“等待前”
*   时间 3 秒：打印“等待后”，然后在“哟！”之后立即打印

这种行为是否符合规范？为什么不是

*   时间 0 秒：打印“等待前”
*   时间 3 秒：打印“等待后”
*   时间 4 秒：打印“Yo！”

?

* * *

## 回答 #1

> 赞同：50
> 
> 时间：2013-02-13T21:03:08.983

JavaScript 是单线程的。如果某些代码块使用执行线程，则无法执行其他代码。这意味着您的`setTimeout()`调用必须等到主执行（具有忙等待`while`循环的那个）完成。

这是发生的情况：您计划`setTimeout()`在一秒钟后执行，然后将主线程阻塞 3 秒钟。这意味着当您的繁忙循环结束时，超时已经晚了 2 秒 - JS 引擎试图通过尽快调用您的超时来跟上 - 即立即。

事实上这是：

```
while (Date.now() < start + 3000) {} 
```

是 JavaScript 中最糟糕的事情之一。您将 JavaScript 执行线程保持 3 秒，并且无法执行其他事件/回调。通常浏览器会在这段时间内“冻结”。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-13T21:04:47.690

的延迟与`setTimeout`调用它的确切时间点有关。当您仍在忙于等待时，它就会过期。因此它将在控件返回事件循环的下一个瞬间执行。

编辑：

规范在这一点上有点含糊，但我想这是预期的且唯一直接的解释：

> setTimeout（函数，毫秒）
> 
> 此方法在经过指定的毫秒数后调用该函数一次，直到通过调用 clearTimeout 取消。这些方法返回一个 timerID，可以在随后的 clearTimeout 调用中使用它来取消间隔。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T21:07:23.007

当您在 setTimeout 调用之后运行忙等待循环时，您不会为“哟！”留出时间。打印出来，因为 Javascript 运行时正忙于你的循环（实际上空语句也使它忙，因为循环条件的继续评估）。

您应该始终避免这样的忙等待循环，因为在完成之前，在该窗口中不能调用或运行任何其他内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-06-08T16:08:58.240

不确定它是否可以帮助您，但此问题已在以下位置进行了解释： [https ://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#Run-to-completion](https://developer.mozilla.org/en-US/docs/Web/JavaScript/EventLoop#Run-to-completion)

> 出于这个原因，第二个参数表示最小时间——不是保证时间。

# javascript - Javascript Regex - 查找所有可能的匹配项，即使在已经捕获的匹配项中

> ID：14863026
> 
> 赞同：16
> 
> 时间：2013-02-13T21:00:45.417
> 
> 标签：javascript, regex, string, match

我正在尝试使用带有 javascript 的正则表达式从字符串中获取*所有可能的匹配项。*看来我这样做的方法与已经匹配的字符串部分不匹配。

变量：

```
var string = 'A1B1Y:A1B2Y:A1B3Y:A1B4Z:A1B5Y:A1B6Y:A1B7Y:A1B8Z:A1B9Y:A1B10Y:A1B11Y';

var reg = /A[0-9]+B[0-9]+Y:A[0-9]+B[0-9]+Y/g; 
```

代码：

```
var match = string.match(reg); 
```

我得到的所有匹配结果：

```
A1B1Y:A1B2Y
A1B5Y:A1B6Y
A1B9Y:A1B10Y 
```

我想要的匹配结果：

```
A1B1Y:A1B2Y
A1B2Y:A1B3Y
A1B5Y:A1B6Y
A1B6Y:A1B7Y
A1B9Y:A1B10Y
A1B10Y:A1B11Y 
```

在我的脑海中，我想`A1B1Y:A1B2Y`成为一个匹配项`A1B2Y:A1B3Y`，即使`A1B2Y`在字符串中需要成为两个匹配项的一部分。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-13T21:14:33.570

[`.exec`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/RegExp/exec)在不修改您的正则表达式的情况下，您可以使用和操作正则表达式对象的`lastIndex`属性将其设置为在每次匹配后的下半场开始匹配时开始匹配。

```
var string = 'A1B1Y:A1B2Y:A1B3Y:A1B4Z:A1B5Y:A1B6Y:A1B7Y:A1B8Z:A1B9Y:A1B10Y:A1B11Y';
var reg = /A[0-9]+B[0-9]+Y:A[0-9]+B[0-9]+Y/g;
var matches = [], found;
while (found = reg.exec(string)) {
    matches.push(found[0]);
    reg.lastIndex -= found[0].split(':')[1].length;
}

console.log(matches);
//["A1B1Y:A1B2Y", "A1B2Y:A1B3Y", "A1B5Y:A1B6Y", "A1B6Y:A1B7Y", "A1B9Y:A1B10Y", "A1B10Y:A1B11Y"] 
```

[**演示**](http://jsbin.com/upesek/5/edit)

* * *

根据 Bergi 的评论，您还可以获得最后一场比赛的索引并将其递增 1，因此它不会从比赛的后半部分开始匹配，而是从每个比赛的第二个字符开始尝试匹配：

```
reg.lastIndex = found.index+1; 
```

[**演示**](http://jsbin.com/upesek/7/edit)

最后的结果是一样的。不过，Bergi 的更新代码少了一点，执行[速度也快](http://jsperf.com/setting-lastindex-inside-exec-performance)了一点。`=]`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T21:15:32.557

您无法从中获得直接结果`match`，但可以通过`RegExp.exec`对正则表达式进行一些修改来生成结果：

```
var regex = /A[0-9]+B[0-9]+Y(?=(:A[0-9]+B[0-9]+Y))/g;
var input = 'A1B1Y:A1B2Y:A1B3Y:A1B4Z:A1B5Y:A1B6Y:A1B7Y:A1B8Z:A1B9Y:A1B10Y:A1B11Y'
var arr;
var results = [];

while ((arr = regex.exec(input)) !== null) {
    results.push(arr[0] + arr[1]);
} 
```

为了不消耗文本，我使用*了零宽度*正向`(?=pattern)`预测，以便可以重新匹配重叠部分。

实际上，可以滥用`replace`方法来达到相同的结果：

```
var input = 'A1B1Y:A1B2Y:A1B3Y:A1B4Z:A1B5Y:A1B6Y:A1B7Y:A1B8Z:A1B9Y:A1B10Y:A1B11Y'
var results = [];

input.replace(/A[0-9]+B[0-9]+Y(?=(:A[0-9]+B[0-9]+Y))/g, function ($0, $1) {
    results.push($0 + $1);
    return '';
}); 
```

但是，由于它是`replace`，它会进行额外的无用替换工作。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-13T21:28:19.433

不幸的是，它并不像单个`string.match`.

原因是你想要重叠的匹配，而`/g`标志没有给你。

您可以使用前瞻：

```
var re = /A\d+B\d+Y(?=:A\d+B\d+Y)/g; 
```

但现在你得到：

```
string.match(re); // ["A1B1Y", "A1B2Y", "A1B5Y", "A1B6Y", "A1B9Y", "A1B10Y"] 
```

原因是前瞻是零宽度，这意味着它只是说明模式是否出现在您尝试匹配的内容之后；它不包括在比赛中。

你可以`exec`用来尝试抓住你想要的东西。如果正则表达式有`/g`标志，您可以`exec`重复运行以获取所有匹配项：

```
// using re from above to get the overlapping matches

var m;
var matches = [];
var re2 = /A\d+B\d+Y:A\d+B\d+Y/g; // make another regex to get what we need

while ((m = re.exec(string)) !== null) {
  // m is a match object, which has the index of the current match
  matches.push(string.substring(m.index).match(re2)[0]);
}

matches == [
  "A1B1Y:A1B2Y", 
  "A1B2Y:A1B3Y", 
  "A1B5Y:A1B6Y", 
  "A1B6Y:A1B7Y", 
  "A1B9Y:A1B10Y", 
  "A1B10Y:A1B11Y"
]; 
```

[这是一个在行动中的小提琴](http://jsfiddle.net/jWzfM/)。打开控制台查看结果

或者，您可以在 上拆分原始字符串`:`，然后循环遍历结果数组，取出匹配时匹配的那些，`array[i]`并且`array[i+1]`两者都匹配您想要的。

# c# - 执行单元测试时，Visual Studio 在附加调试器之前多次构建

> ID：14863027
> 
> 赞同：0
> 
> 时间：2013-02-13T21:00:48.627
> 
> 标签：c#, visual-studio-2010

我正在使用 Visual Studio 2010，C# 并尝试执行单元/集成测试。我得到了引用其他几个项目的集成测试项目。当我想执行我的测试时，它会在执行测试之前一次又一次地构建。当我使用 Resharper 和 MSTest 执行测试时，情况也是如此。我确信它与 Visual Studio 有关，将调试器附加到上下文。作为最后的尝试，我从集成项目中删除了所有项目引用，当我开始执行测试时，我看到了相同的行为。这意味着，编译不是特定于项目的，而是正在构建整个解决方案。我已经花了一整天的时间来解决这个问题。我在这里找到了一个类似的项目，没有任何解决方案 [选择“调试|启动新实例”时多次重建](https://stackoverflow.com/questions/9713558/multiple-rebuilds-when-choosing-debug-start-new-instance)

由于每次都重新编写构建，我不确定究竟是什么导致了这个问题。

任何指针，想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-28T12:17:45.900

令人惊讶的是，当我关闭病毒扫描程序扫描解决方案目录时，并没有发生这种行为。我可以提出一个理论，即构建二进制签名在扫描过程中以某种方式被修改，它使 Visual Studio 多次重建它

# android - 如何使用 IntelliJ IDEA 12 配置 Proguard？

> ID：14863033
> 
> 赞同：3
> 
> 时间：2013-02-13T21:01:11.253
> 
> 标签：android, intellij-idea, proguard

我正在尝试配置一个 Android 应用程序以在 IntelliJ IDEA 12 中使用 Proguard，问题是默认情况下 IntelliJ 将我所有的库项目都包含为 injars，显然我无法改变这种行为。

所以，两个问题：

一，我可以改变这种行为吗？

二，我需要吗？如果我使用的是 android-support-v4.jar，可以将它作为 injar 而不是 libraryjar 吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T09:23:03.117

像 android-support-v4.jar 这样的库是 ProGuard 的 injar，因为它们是部署在设备上的应用程序的一部分。ProGuard 将它们与应用程序代码一起处理。这可以减小应用程序的大小，提高其性能，并使逆向工程变得更加困难。例如，ProGuard 可能能够删除大部分未使用的库。

只有 android.jar 是 ProGuard 的库 jar，因为它已经存在于设备上。ProGuard 需要它进行分析，但保持不变并且不会将其复制到输出 jar 中。

# c# - 使用语言代码（en）还是完整的文化代码（例如 en-AU）？

> ID：14863037
> 
> 赞同：3
> 
> 时间：2013-02-13T21:01:37.573
> 
> 标签：c#, wpf, localization, internationalization

我在 C#/WPF 中有一个国际化的应用程序（某些语言的资源字符串）。

目前我对资源文件使用以下代码：default.resx、de-DE、fr-FR、es-ES、pt-BR、pt-PT、nl-NL 等。

但我有一些问题：

1.  例如，对于 nl，有两个变体：nl-NL（荷兰）和 nl-BE。目前我使用 nl-NL，但我想如果来自比利时的人会得到默认文本，因为 nl-BE 没有定义。这是真的？

2.  我应该使用 then nl 而不是 nl-NL 吗？

3.  对于某些语言，只定义了一个国家（例如 hu-HU）……那么 hu 和 hu-HU 之间有什么区别？我什么都不想，但我想确定一下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:29:03.773

资源搜索顺序有点复杂和灵活，请参阅 MSDN [Packaging and Deploying Resources](http://msdn.microsoft.com/en-us/library/sb6a8618%28v=vs.90%29.aspx)。

对于您的问题注释项目 5：如果它没有找到像 nl-NL 这样的特定文化，它会搜索父文化 ( [CultureInfo.Parent](http://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.parent%28v=vs.90%29.aspx) )。但是父文化不一定是没有国家的文化名称，例如对于zh-CN，它是zh-CHS。此外，可能还有祖父母文化等等......

1.  是的
2.  是的，但要小心选择正确的父文化名称。不要简单地切断国家
3.  是的，这无关紧要，只是具体的加载速度可能会快一点。另一方面，你永远不知道未来是否会出现同一种语言的另一种特定文化。也许说罗马尼亚的匈牙利少数民族有自己的文化信息......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:30:44.210

是的，如果您无法同时为 nl-BE 和 nl-NL 本地化资源，您*通常希望以“nl”之类的中立文化提供资源。*如果特定文化不可用，资源管理器将自动回退到父文化。

您的客户是否会对此感到高兴，您稍后可能会发现。佛兰芒语和荷兰语非常相似，因此对于这种特定情况，不太可能让他们感到厌烦。对于巴西和葡萄牙来说，情况并不是那么明确，他们已经有一段时间发展自己的方言，就像美式英语不再是英国式的，有着不同的色彩。hu-HU vs hu没关系，选择hu-HU。

背景信息[在这里](http://msdn.microsoft.com/en-us/library/756hydy4%28v=vs.100%29.aspx)。

# css - 尝试选择菜单选项时，css悬停下拉菜单消失

> ID：14863044
> 
> 赞同：4
> 
> 时间：2013-02-13T21:01:53.183
> 
> 标签：css, drop-down-menu

我一直在寻找我的代码的修复程序一段时间。

我有一个下拉菜单，在您将鼠标悬停在静态对象上后显示菜单的内容，但是当您尝试选择其中一个项目（将鼠标从静态对象上移开）时，项目消失（设置回显示：无）

我的代码如下：

HTML：

```
<div id="menuContainer">
    <div class="menuItem first">
        <div class="settingsIcon"></div>
        <div class="text">Account Settings</div>
        <div class="downArrowIcon"></div>
    </div>
    <div id="settingsMenu">
        <div class="menuItem">Manage clients</div>
        <div class="menuItem">Manage specials</div>
        <div class="menuItem">Manage users</div>
        <div class="menuItem">Logout</div>
    </div>
</div>'; 
```

CSS：

```
div#menuContainer div:hover + div#settingsMenu{
    display: block;
    position: relative;
    z-index: 100;
}

div#menuContainer div#settingsMenu{
    display: none;
    width: 100%;
} 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:11:37.090

您需要确保该`display:none;`部分位于悬停部分之上（因为它是自上而下阅读的，因此您需要适当的优先级），而且在将鼠标`display:block;`悬停在 settingsMenu 本身时也要有。

编码：

```
#settingsMenu{
    display: none;
    width: 100%;
}

#menuContainer div:hover + #settingsMenu,#settingsMenu:hover{
    display: block;
    position: relative;
    z-index: 100;
} 
```

[这是一个要显示的 jsFiddle](http://jsfiddle.net/YrVJS/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:31:39.743

您也可以使用列表而不是 div 来执行此操作，这样更简洁，并且可以轻松扩展为子菜单。这是一个示例：

```
<html>
    <head>
        <style type="text/css">
            nav ul ul {
                display: none;
            }

            nav ul li:hover > ul {
                display: block;
            }
            ul {
                list-style: none;
            }
        </style>
    </head>
    <body>
        <nav>
            <ul>
                <li>
                    <div class="settingsIcon"></div>
                    <div class="text">Account Settings</div>
                    <div class="downArrowIcon"></div>
                    <ul>
                        <li>Manage clients</li>
                        <li>Manage specials</li>
                        <li>Manage users</li>
                        <li>Logout</li>
                    </ul>
                </li>
            </ul>
        </nav>
    </body>
</html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:08:48.467

您是否尝试过添加：

`div#settingsMenu:hover{display: block;}`

还没有测试它，但它似乎可以工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:19:29.620

您所要做的就是将 :hover 状态附加到`div:menuContainer`，而不是`div`s 里面。此外，您不需要`+`

以下应该有效：

```
#menuContainer:hover div#settingsMenu{
    display: block;
    position: relative;
    z-index: 100;
} 
```

编辑：下面是说明上述内容的 CodePed：

[http://codepen.io/braican/pen/yIjLs](http://codepen.io/braican/pen/yIjLs)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-14T11:47:28.877

有时（对我来说发生过几次）问题不是优先顺序，而是 CSS 层。 **z-index**是一个赋予 CSS 另一个维度的属性。

在我的示例中，滑块中的 z-index 与我的下拉列表相混淆，很简单

```
.submenu {
    ...
    z-index: 99999;
} 
```

解决问题。

（.submenu 是`<ul>`下拉列表）

# javascript - 选择导航选项不会转到 URL 导轨

> ID：14863049
> 
> 赞同：0
> 
> 时间：2013-02-13T21:02:04.960
> 
> 标签：javascript, jquery, ruby-on-rails-3

我对为什么以下不起作用有点困惑，我尝试了 2 件 jquery/javascript

所以我有一个用于我的移动视图的下拉菜单 9 我已经结合了我尝试创建链接的两种方式

```
 <select id="nav-select">
    <option value="/public_pages/faq">FAQ</option>
    <option value="vacancy"><%= link_to 'Create Vacancy ', new_vacancy_path %></option>        
   </select> 
```

我试图获取窗口位置并链接到正确 url 的 JavaScript

```
$('#nav-select').change(function(){
var url = $(this).val();
window.location = url;
});

document.getElementById("nav-select").addEventListener('change',function () {
window.location = this.value;
 },false); 
```

当我选择一个选项时没有任何反应

有什么想法吗？我是否错误地使用了选择标签？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T23:35:23.450

如未[定义](https://stackoverflow.com/users/848164/undefined)所述，将您的脚本放在文档就绪处理程序中将解决此问题。为了进一步解释，我敢打赌您在实际文档标记之前定义了脚本。这将使 jQuery 搜索文档中尚不存在的元素。

通过将其放入文档就绪处理程序中：

```
$(document).ready(function(){
    $('#nav-select').change(function(){
        var url = $(this).val();
        window.location = url;
    });
}); 
```

您实际上是让脚本等到页面完成加载，并且`#nav-select`在执行代码之前该元素存在于文档中。

# android - Android 相机、同时原始预览和原始拍摄照片

> ID：14863050
> 
> 赞同：4
> 
> 时间：2013-02-13T21:02:09.557
> 
> 标签：android, camera, android-camera

所以我正在开发类似于相机应用程序的东西。它在原生 OpenGL 纹理上绘制实时相机预览。如果按下按钮，则会以原始形式捕获静止图像（可能比实时预览分辨率更高）。

这是我的代码的概要。为了清楚起见，我没有展示不太相关的部分。这是预览和静止上限分辨率相同的简化情况。

```
void Setup(Activity a) {

  // .. snip ..

  mSurfaceView = new SurfaceView(a);
  mSurfaceView.getHolder().addCallback(this);
  //put the surface off-screen
  AbsoluteLayout.LayoutParams alp = new AbsoluteLayout.LayoutParams(8, 8, -8, -8); 
  a.addContentView(mSurfaceView, alp); //need this, otherwise surface is not created

  mCamera = Camera.open(miCameraId);
  mCamera.setPreviewCallbackWithBuffer(this);

  ConfigureCameraDefaults(640,480);
}

// -------------------------------------------------------------------- //

void ConfigureCameraDefaults(int iX, int iY) {
  Camera.Parameters oParameters=mCamera.getParameters();

  oParameters.setPreviewFormat(ImageFormat.NV21);
  oParameters.setPictureFormat(ImageFormat.NV21);
  oParameters.setPreviewSize(iX, iY); // for live preview
  oParameters.setPictureSize(iX, iY); // for still capture

  int bpp = ImageFormat.getBitsPerPixel(ImageFormat.NV21);
  int iBufSize = (int) (iX*iY*((float)bpp/8));
  mBuffer = new byte[iBufSize];
  mCamera.addCallbackBuffer(mBuffer);

  try {
      mCamera.setParameters(oParameters);
  } catch (Exception e) {
      // .. snip ..
  }
}

void startPreview() {
  mCamera.startPreview();
}

void stopPreview() {
  mCamera.stopPreview();
}

void takePicture() {
  mCamera.takePicture(null, this, null, null); //2nd is the raw callback
}

// -------------------------------------------------------------------- //

@Override
public void onPreviewFrame(byte[] data, Camera camera) {
  // -- at this point the buffer is in a safe state, until it is added again
  onPreviewFrame_native(data);

  // -- make buffer writable again
  mCamera.addCallbackBuffer(mBuffer);
}

@Override
public void onPictureTaken(byte[] data, Camera camera) {
  onStillCapture_native(data);
  mCamera.startPreview(); //otherwise preview will stop
} 
```

好的，现在是问题。当`takePicture()`没有被调用时，一切都按计划运行。预览帧到达，它们被处理，缓冲区重新排队。但是，如果我`startPreview()`这样做`takePicture()`，图片回调将获得一个空数据数组。每次。谷歌文档有这样的说法`takePicture()`：

`The raw callback occurs when the raw image data is available (NOTE: the data will be null if there is no raw image callback buffer available or the raw image callback buffer is not large enough to hold the raw image).`

这对我来说并不完全清楚，因为：

1.  没有为静止捕获设置缓冲区的功能，仅适用于 prevew 帧

2.  即使相同的缓冲区用于静止大写和预览帧，我确实有一个缓冲区排队。

3.  专门为静止大写添加第二个缓冲区（与预览缓冲区相同）绝对没有效果

4.  必须开始预览才能`takePicture()`成为有效调用。

我错过了一些明显的东西吗？还是我们不允许同时从视频中获取原始帧？文档中对此没有任何内容。我也查看了相机源，但无济于事。

任何帮助将不胜感激。

PS。我已经尝试为静止图像使用不同的颜色格式，在拍照之前取消设置预览回调，添加第二个缓冲区，重新排队第二个缓冲区，将表面保持器设置为推送类型，以及其他一些我无法回忆的事情片刻。没有任何区别。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-10T08:09:46.683

似乎没有办法获得原始图像。该方法`addCallbackBuffer`仅由预览回调使用。还有另一种方法`addRawImageCallbackBuffer`应该做你想做的事。它是公共的，但没有导出，所以你不能直接调用它。你可以这样称呼它：

```
 try {
        final Method addRawImageCallbackBuffer =
                camera0.getClass()
                       .getDeclaredMethod("addRawImageCallbackBuffer",
                                          byte[].class);
        addRawImageCallbackBuffer.invoke(camera0, new byte[100000000]);
    } catch (Exception e) {
        Log.e("RNG", "Error", e);
    } 
```

但在我的 Nexus 5 上，它仍然会`null`在回调中返回，所以我认为它根本不受支持。

# text - 如何让文本编辑器 (gedit) 将颜色应用于代码？

> ID：14863052
> 
> 赞同：1
> 
> 时间：2013-02-13T21:02:09.180
> 
> 标签：text, editor, syntax-highlighting, gedit

通常，当我使用像 gedit 这样的文本编辑器时，为了使其将配色方案应用于代码，我所要做的就是使用适当的扩展名保存它并更改代码颜色。最近，另存为 .html 或 .java 并没有奏效。有没有办法强制文本编辑器识别这一点并应用颜色？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-10T15:33:34.553

语法突出显示应该是基于 mime 类型的自动。如果对于像 .html 或 .java 这样的简单类型没有自动发生，那么您就有问题了，但是很难知道您包含的信息在哪里。检查 /usr/share/mime/packages 和 /usr/share/gtksourceview-3.0/language-specs/ 的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T22:25:21.493

在菜单栏上，我必须选择*View > Highlight Mode > Sources > Java*才能让它工作。

# java - 通过 != null 或 !str.equals(null) 检查 Java 字符串空值？

> ID：14863055
> 
> 赞同：4
> 
> 时间：2013-02-13T21:02:43.840
> 
> 标签：java, string, null, null-check

在java中检查非空值的最佳方法是什么？

```
String query ="abcd"; 
```

`query != null`对比 `!query.equals(null).`

哪个更好？为什么？

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-13T21:04:10.887

*第一个更好*（也是**唯一的选择**），因为*第二个*会抛出`NPE`，当你的价值实际上是`null`. *就如此容易。*

试试这个：

```
String str = null;
str.equals(null);  // will throw `NPE`. 
```

所以基本上，您想要执行的测试会`NullPointerException`在第二种情况下触发 a 。所以，别无选择。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-13T21:08:23.960

`!str.equals(null)`将要

1.  如果它没有抛出异常，则总是返回 false，并且
2.  如果 str 为空，则抛出异常

空值检查的目的是确保在此代码中的引用`str`实际上是指一个对象。如果它为空，则不能在其上调用*任何*方法，包括`equals`，而不抛出`NullPointerException`... 空检查的目的是避免发生。

所以`!str.equals(null)`导致非常问题的空检查旨在防止并且根本不做您认为的事情。永远不要这样做。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T21:06:19.500

`query != null`更好，因为`!query.equals(null)`当查询实际上为空时会抛出异常。也`query != null`很容易阅读

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-13T21:09:27.887

`query != null`比较对象是否为`null`. `query.equals("something")`比较该对象内部的值。`string == "something`“。所以在这种情况下使用`query != null`.

# managed-c++ - 未找到 GetTickCount() 标识符

> ID：14863056
> 
> 赞同：0
> 
> 时间：2013-02-13T21:02:44.197
> 
> 标签：managed-c++, gettickcount

当我尝试编译此代码时，我不确定为什么会收到错误“GetClickCount identifier not found”。（我得到与 GetClickCount64 相同的错误）。我希望有人能解释一下。我对这个问题的大部分搜索似乎表明代码缺少 #include ，但这显然不是我的问题。

```
#include <Windows.h>
#include "stdafx.h"
#include "InSort.h"
#include "DataSet.h"

using namespace std;
using namespace System;

ref class Test
{
public: 

    Test(){}

    // TestInsertSortProcedure() method tests the InsertSort process for the duration
    // of the sorting proceedure by checking the time prior to and after the SortCollection()
    // method has run on five different lengths of the array being sorted, each subsequent length
    // being 10-fold greater than the previous length
    void TestInsertSortProcedure()
    {
        int start;
        int finish;
        int total;
        unsigned int increment;
        InSort<int>^ myInsertSorter = gcnew InSort<int>();

        for (increment = 1; increment < 1000000; increment = increment * 10)
        {
            // get new dataset with new number of elements equal to increment value
            Dataset^ myDataArray = gcnew Dataset(increment);

            // Timestamp prior to sorting:
            start = GetTickCount();

            // Sort collection
            myInsertSorter->SortCollection(myDataArray->unsortedArray);

            // Timestamp at completion of sorting
            finish = GetTickCount();
            total = finish - start;

            // Print result to console
            Console::WriteLine(L"Sorting time in milliseconds was: " + total);
        }
    }
};

int main(array<System::String ^> ^args)
{
Test^ testing = gcnew Test();
testing->TestInsertSortProcedure();

return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:47:58.060

尝试使用`Environment::TickCount`

# validation - 骨干验证范围问题

> ID：14863059
> 
> 赞同：0
> 
> 时间：2013-02-13T21:02:53.417
> 
> 标签：validation, backbone.js

我正在尝试在此处本地化应用程序，并在我的模型上使用类似的方式验证消息：

```
var userModel = Backbone.Model.extend({
     validate_msgs: {
     empty_name: msg.empty,
     min_length_name: msg.min,
         max_length_name: msg.length,
         invalid_name: msg.invalid
},

     validation: {
            name: [{
                required: true,
                msg: function(){ return this.validate_msgs.empty_name; }
            },{
                minLength: 3,
                msg: function(){ return this.validate_msgs.min_length_name; }
            },{
                maxLength: 30,
                msg: function(){ return this.validate_msgs.max_length_name; }
            }, {
                fn: "validateName"
            }]
        },

}); 
```

但是 msg 的返回函数上的“this”总是指向视图，如下所示：

```
Backbone.Validation.bind( this,  {valid:this.hideError, invalid:this.showError}); 
```

我该如何处理？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:58:34.837

简单而明显的解决方案是直接使用验证消息：

```
msg: msg.empty 
```

但我假设您有理由将`msg`对象中的错误消息映射到模型上更具体的错误消息。您可以通过将验证消息定义为模型类上的静态属性来实现此目的，并使用模型类名称直接引用属性：

```
var UserModel = Backbone.Model.extend({
  validation: {
    name: [{
      required: true,
      msg: function() { return UserModel.validate_msgs.empty_name; }
    }]
  }
}, 
{
  validate_msgs: {
    empty_name: msg.empty,
    min_length_name: msg.min,
    max_length_name: msg.length,
    invalid_name: msg.invalid
  }
}); 
```

# javascript - 无法从 Ext.data.store 填充字段

> ID：14863063
> 
> 赞同：0
> 
> 时间：2013-02-13T21:03:05.710
> 
> 标签：javascript, extjs, asp-classic

这是我的模型：

```
Ext.define('Email', {
    extend: 'Ext.data.Model',
    idProperty: 'emailid',
    fields: [
        { name: 'emailid', type: 'int' },
        { name: 'emailsubject', type: 'string', useNull: true },
        { name: 'emailbody', type: 'string', useNull: true },
        { name: 'emailto', type: 'string', useNull: true },
        { name: 'emailfrom', type: 'string', useNull: true },
    ]
}); 
```

和数据存储：

```
var EmailDataStore = {

    getDetailStore: function(aid) {    

        var options =  {
            autoLoad: true,
            autoSync: true,
            pageSize: 1,
            remoteFilter: true,
            remoteGroup: true,
            remoteSort: true,
            model: 'Email',
            proxy: {
                type: 'ajax',
                url: 'datastores/datastore-email.asp?action=details&auditid=' + aid,
                reader: {
                    type: 'json',
                    root: 'emailDetails'
                }
            }
        };

        if (typeof (options2) != 'undefined') {
            options = Ext.merge(options, options2);
        }

        var detailStore = Ext.create('Ext.data.Store', options);
        return detailStore;
    }
} 
```

我不会包含 ASP，因为 JSON 正在适当地返回数据。但是在接下来的代码中，

```
...
PortalEmailGrid.prototype.detailStore = null;
PortalEmailGrid.prototype.showEmailDetails = function (id) {
    var self = this;
    //alert(id);
    self.detailStore = EmailDataStore.getDetailStore(id);
    //view store at this state - object appears to exist with the returned record in it
    console.log(self.detailStore);

    var firstItem = self.detailStore.first();
    //undefined here
    console.log(firstItem);
    //count is zero, but i can see the object in the console log above
    alert('detailStore count: ' + self.detailStore.count());

    var win = Ext.create('Ext.window.Window', {
        title: 'Email Details',
        store: self.detailStore,
        height: 400,
        width: 800,
        bodyPadding: 4,
        items: [
            {
                xtype: 'textfield',
                name: 'tofield',
                dataIndex: 'emailto',
                fieldLabel: 'To'
            },
                                {
                xtype: 'textfield',
                name: 'subjectfield',
                dataIndex: 'emailsubject',
                fieldLabel: 'Subject'
            }

        ]
    });

    win.show();
} 
```

我无法让字段填充`detailStore`的数据。但是当我在 Firebug 中登录时`self.detailStore`，我可以看到该对象及其详细信息。`self.detailStore.count()`显示为零，但根据控制台，数据应该在那里。我怀疑由于这种差异，这些字段没有填充`dataIndex`信息。之前的代码块也被调用：

```
var selected = self.grid.selModel.selected;
var id = selected.items[0].raw.emailid;
//var status = selected.items[0].raw.status;
PortalEmailGrid.prototype.showEmailDetails(id); 
```

**您能看出数据未从数据存储区加载的任何原因吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:09:59.790

存储加载是异步的，当您将计数记录到控制台时，存储尚未加载。Firebug 始终显示对象的“最新”状态，这就是您可以看到数据的原因。你需要监听 store 上的 load 事件。

因此，如果您删除 autoLoad 配置，您可以执行以下操作：

```
self.detailStore = EmailDataStore.getDetailStore(id);
self.detailStore.load({
    callback: function(){
        console.log('loaded, do something');
    }
}); 
```

# c# - 新流程不正常？

> ID：14863066
> 
> 赞同：0
> 
> 时间：2013-02-13T21:03:10.487
> 
> 标签：c#

我无法在这里找到我正在寻找的答案，但如果是，请链接它，我将关闭这个重复的帖子。

作为我正在开发的程序的一部分，我希望按此顺序发生三件简单的事情：

1.) 显示选框进度条 2.) 通过 CMD 运行一些命令并将输出移动到可访问的字符串 3.) 停止/隐藏进度条

我看到的问题是我的代码没有按顺序执行，我对为什么感到非常困惑。这似乎是不可能的步骤 2-1-3。

更奇怪的是，如果我在步骤 1 和步骤 2 之间取消注释消息框，事情就会按顺序执行。

新的 CMD 流程是否有什么东西让这变得异常？

这是我的这种方法的代码：

```
 //STEP 1 - Updates label and starts progress bar
        lblSelectDiagnostic.Text = "Diagnostic Running";
        progressBarDiag.Visible = true;
        progressBarDiag.MarqueeAnimationSpeed = 100;

        //MessageBox.Show("Status Updated");

        //STEP 2 - Runs "Test Internet Connection"

        //Gets selected diagnostic name
        string strSelectedDiag = listBoxDiagnostics.SelectedItem.ToString();
        var name = strSelectedDiag.Substring(strSelectedDiag.LastIndexOf(':') + 1);
        strSelectedDiag = name.Trim();

        if (strSelectedDiag.Contains("Test Internet Connection"))
        {
            //Pings Google
            ProcessStartInfo info = new ProcessStartInfo();
            info.RedirectStandardError = true;
            info.RedirectStandardInput = true;
            info.RedirectStandardOutput = true;
            info.UseShellExecute = false;
            info.FileName = "cmd.exe";
            info.CreateNoWindow = true;
            //Creates new process
            Process proc = new Process();
            proc.StartInfo = info;
            proc.Start();
            //Writes commands
            using (StreamWriter writer = proc.StandardInput)
            {
                if (writer.BaseStream.CanWrite)
                {
                    writer.WriteLine("ping www.google.com");
                    writer.WriteLine("exit");
                }
                writer.Close();
            }
            string PingGoogle = proc.StandardOutput.ReadToEnd();
            proc.Close();
        }

        //STEP 3 - Resets label and stops progress bar
        progressBarDiag.MarqueeAnimationSpeed = 0;
        progressBarDiag.Visible = false;
        lblSelectDiagnostic.Text = "Select Diagnostic to Run:"; 
```

-谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:08:39.683

进度条不会显示，因为您在逻辑所在的同一线程中绘制它。您将不得不在另一个线程中执行此操作。最简单的方法是使用**后台工作者**

这将对您有所帮助：http: [//msdn.microsoft.com/en-us/library/cc221403 (v=vs.95).aspx](http://msdn.microsoft.com/en-us/library/cc221403(v=vs.95).aspx)

# ada - GNAT 编程套件：交叉引用信息不是最新的（这是一个猜测）

> ID：14863068
> 
> 赞同：0
> 
> 时间：2013-02-13T21:03:16.617
> 
> 标签：ada, gnat

我正在尝试使用 GNAT Programming Suite（托管在 Win XP 上）在构建期间解决包引用。在生成器结果中，我收到这样的错误：

```
file "ac_configuration_s.ada" not found 
```

单击错误会将我带到这样的一行：

```
with

    Ac_Configuration,
    Dispense_Timer,
    ... 
```

第一项 (Ac_Configuration) 未解决，但第二项 (Dispense_Time) 已解决。我还有其他几个解决或不解决的问题。所有有问题的文件（规范和正文）都被标识为源文件。

当我将鼠标悬停在出现错误的行上时，会出现一个弹出窗口，提供以下信息：

```
(Cross-references info not up to date. This is a guess.)
Ac_Configuration
local package declared at D_Ac_Config_S.Ada:85 
```

猜测是正确的，但我不知道如何使用它。我如何才能正确构建它？

更新

这是对 gcc 的调用

```
gcc -c "-gnatec=C:\Source\build\GNAT-TEMP-000001.TMP" -I- -gnatA
-x ada "-gnatem=C:\Source\build\GNAT-TEMP-000002.TMP" "C:\Source\C_Cbt_Main_B.Ada" 
```

我没有看到对“最小”开关的引用。

在这种情况下，没有相应的正文文件文件**D_Ac_Config_S.Ada**。所以没有要单独编译的正文文件。

当我右键单击*with*内的包引用时，我可以转到**Ac_Configuration**的声明以及作为错误来源的所有其他包名称。所以这些 lreferences 正在以某种方式解决。

顺便说一句，我以前没有使用过 ADA，所以我还在努力了解一切。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:58:32.107

看起来好像您正在`_s.ada`用作规格的后缀，而我猜`_b.ada`是身体？

GNAT 可能对这种命名约定有困难。使用[GNAT](http://gcc.gnu.org/onlinedocs/gnat_ugn_unw/Naming-Schemes.html)[项目](http://gcc.gnu.org/onlinedocs/gnat_ugn_unw/GNAT-Project-Manager.html)文件`.gpr`（_ _ _ t 试过这个，但你可以看到，如果你有一个包，它会混淆问题，例如）。 稍后：事实证明 GNAT (GPL, 4.7, 4.8) 对你的后缀非常满意！`{unit-name}.ads``{unit-name}.adb``Foo_S`

如果包`Ac_Configuration`真的是在第 85 行声明的本地包`D_Ac_Config_S.Ada`，那么问题就来了；您只能使用`with`一个库单元，在本例中为`D_Ac_Config`.

```
with D_Ac_Config;
...
package Foo is
   ...
   Bar : D_Ac_Config.Ac_Configuration.Baz; 
```

我想知道`D_Ac_Config_S.Ada`（例如）是否实际上包含多个 Ada 单元？（如果是这样，编译该文件应该会导致编译错误，例如`end of file expected, file can have only one compilation unit`）。GNAT 在编译时不支持这一点，而是提供了一个实用程序[gnatchop](http://gcc.gnu.org/onlinedocs/gnat_ugn_unw/Renaming-Files-Using-gnatchop.html)。

是否有可能只使用`gnatchop`所有来源并完成它？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:33:00.770

嗯，我认为这听起来像编译器有一组错误的对象/ALI 正在使用，因此交叉引用不是最新的错误。（通常编译器擅长保持最新状态；但您可能需要检查是否为项目设置了“最小重新编译”开关。）

您是否尝试过仅编译 ["owning"] 文件`D_Ac_Config_S.Ada`？（即，如果它是一个规范，请转到相应的正文并对其进行编译。）这应该会强制更新其 ALI/目标文件。

然后尝试正常构建。

-- PS：你可能需要先清理一下。

# ios - Monotouch：播放 MP3 用户控制

> ID：14863076
> 
> 赞同：0
> 
> 时间：2013-02-13T21:03:46.350
> 
> 标签：ios, xamarin.ios, mp3, avplayer

使用 Monotouch 我可以播放 MP3：

```
avPlayer = MonoTouch.AVFoundation.AVPlayer.FromUrl(new NSUrl("http://blah.mp3"));

avPlayer.Play(); 
```

是否有可以显示给用户的 Monotouch 控件，以便为他们提供暂停/停止扫描功能？

在我自己写之前，我想确保我不会无缘无故地这样做。

伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:01:32.250

我相信[AVTouch](https://github.com/xamarin/monotouch-samples/tree/master/AVTouchSample)示例（改编自 Apple 的示例）具有 UI 控件。

# c# - 多用户环境中的静态与公共变量

> ID：14863077
> 
> 赞同：4
> 
> 时间：2013-02-13T21:03:49.610
> 
> 标签：c#, .net, sharepoint

我正在使用以下方法将全局变量保存在单独的类文件中，以便它们可以在几个后端类之间传递。问题是当系统在多用户环境中使用时它会失败。我不能选择“会话”方法，因为管理员还没有准备好在 SharePoint 服务器上启用会话状态。

```
static class Global
{
        private static string id = string.Empty;
        public static string id
        {
            get { return id; }
            set { id = value; }
        }
} 
```

如果我从上面的代码中删除静态声明，它会在多用户场景中正常工作吗？在不向服务器管理员寻求任何帮助的情况下，我还有哪些其他选择。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T21:09:29.297

不要`static`用于每个用户或每个请求的东西；`static`在 Web 应用程序中非常少见，但有时可能用于保存整个系统配置的快照（最好是不可变的）。

那么：我们可以在哪里存放东西？

会话状态将是*每个会话*（这是线索）的明显答案，但听起来这不是一个选项

除此之外，您基本上还有：http 请求。这意味着您可以访问表单、查询字符串和 cookie。*就是*这样。您不想在 cookie 中存储太多：它会膨胀每个请求。而“viewstate”就是邪恶的。如果常规会话状态不可行，您可以基于一些 cookie（适当安全）做一些自制的“会话”实现，但坦率地说，我认为你会做得很好：

*   如果您想要的只是一个，请使用请求表单/查询字符串`id`
*   否则推动您的管理员启用会话状态

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-13T21:09:46.420

您的静态变量将在*所有用户*之间共享，并且不属于特定用户。在 Web 环境中使用静态变量来保持状态几乎总是一个坏主意。

如果您无法启用会话状态，一个好的策略是：

*   将用户特定标识符添加到 URL，并将其保存在 URL 中
*   根据该 ID，将您的状态保存在数据库中的服务器上

这样，您实际上是在重新发明会话状态；但是您避免全局启用会话状态。如果状态足够小，您还可以将其编码到 URL 中。

还要考虑 Session 状态在服务器场环境中不能很好地工作，除非您将其存储在共享服务器上 - 这可能是您的管理员不倾向于启用它的原因。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T21:49:43.657

在 SharePoint 很好地支持的网络场或网络花园环境中，静态可能会更糟。静态字段是*per-AppDomain*。这意味着，例如，对于一台机器内的一个工作进程内的所有用户，它们将是相同的，但在工作进程之间以及机器之间将是不同的。

不要在多用户应用程序中使用静态，并且您不必担心随着环境的变化而发生的行为变化。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T21:17:54.143

如果您确实需要会话状态，请启用会话状态。就这么简单。

但是，如果您只需要几个（轻量级）会话变量，您可以不使用 cookie，并在每个请求上来回传输数据。

您还可以尝试使用以下内容“重新实现”会话状态：

```
static class Globals
{
   private static Dictionary<string, MySessionObjectType> sessions;

   public static MySessionObjectType GetSessionData(string SessionID){...}

   public static void SetSessionData
                         (string SessionID, MySessionObjectType sessionData){...}
} 
```

当然，这不会扩展到多个 Web 服务器，并且管理会话超时将是一个 PITA。

不要忘记 Web 本身的本质是无状态的，因此使用过多的状态（无论是在服务器上还是在客户端上）并不总是一个明智的选择。

# javascript - jqueryui中的长行可排序，包含中断排序

> ID：14863080
> 
> 赞同：0
> 
> 时间：2013-02-13T21:03:55.143
> 
> 标签：javascript, jquery-ui, jquery-ui-sortable

问题演示：http: [//jsfiddle.net/VLvj9/1/](http://jsfiddle.net/VLvj9/1/)

与 html

```
<table>
    <tbody class="sortme">
        <tr><td>Foo</td></tr>
        <tr><td>Bar</td></tr>
        <tr><td>Really long and annoying table row, try to sort me!</td></tr>
    </tbody>
</table> 
```

和 jqueryui

```
$(".sortme").sortable({
    containment: "parent",
    tolerance: "pointer"
}).disableSelection(); 
```

如果您尝试拖动任一长行并对其进行排序，则父容器会向下对齐其宽度。助手被新的小父母从屏幕上推开，无法排序。

`containment`没有属性就不会发生这种情况。我可以在`start()`事件中修改占位符的宽度以保持父级宽度，但似乎包含信息已经在该点设置，并且助手表现出相同的行为。

有没有办法让父级保持其宽度信息，以便遏制按预期工作？

* * *

我相信这个问题是指相同的行为：

[可在表格行上排序的 jQueryUI 在拖动时缩小它们](https://stackoverflow.com/questions/11146000/jqueryui-sortable-on-table-rows-shrinks-them-while-being-dragged)

我的问题是表格内容由 ajax 调用（用户 <input> 内容的状态检查）填充，并且宽度可以在页面的生命周期内任意更改，因此我无法在 td 或表格上设置 px 宽度。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T05:37:46.900

以百分比为您的父母定义一些宽度：

```
<table style="width:100%;">
<div class="sortme" style="display: inline-block; width:100%;"> 
```

这是你更新的[小提琴](http://jsfiddle.net/VLvj9/3/)

**编辑**

由于您不希望宽度为百分比，因此我计算了最宽元素的宽度并将其应用于父元素。这是代码

```
var width = $('.sortme div').width(); //Returns max width from all the matched elements
$('#sortDiv').width(width);
var width2 = $('.sortme tr td').width(); //Returns max width from all the matched elements
$('#sortTable').width(width2); 
```

工作的[小提琴](http://jsfiddle.net/VLvj9/4/)

# linq - 如何使用 Linq 对这些结果进行正确分组？

> ID：14863082
> 
> 赞同：1
> 
> 时间：2013-02-13T21:03:58.653
> 
> 标签：linq

我有以下数据集：

```
Year   Category  Score
2011   A         83
2012   A         86
2013   A         62
2011   B         89
2012   B         86
2013   B         67
2011   C         85
2012   C         73
2013   C         79
2011   D         95
2012   D         78
2013   D         67 
```

我想转换为以下结构。

```
categories: [2011, 2012, 2013], 
series: [
   { data: [83, 86, 62], name: 'A' }, 
   { data: [85, 73, 79], name: 'B' }, 
   { data: [83, 86, 62], name: 'C' }, 
   { data: [95, 78, 67], name: 'D' }] 
```

我希望代码能够容忍源数据集中的“缺失”数据。可以安全地假设，每年和类别中至少有 1 个在源数据中表示。

“粗略”数据示例

```
Year   Category  Score
2011   A         83
// 2012 A is missing
2013   A         62
// 2011 B is missing    
2012   B         86
2013   B         67
2011   C         85
// 2012 C is missing    
2013   C         79
2011   D         95
2012   D         78
2013   D         67 
```

应该产生这个：

```
categories: [2011, 2012, 2013], 
series: [
   { data: [83,  0, 62], name: 'A' }, 
   { data: [ 0, 73, 79], name: 'B' }, 
   { data: [83,  0, 62], name: 'C' }, 
   { data: [95, 78, 67], name: 'D' }] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T04:36:39.443

从 pastebin 代码创建了以下 LINQPad 代码 - 请参阅实现后的注释：

```
void Main()
{
    var scores = new [] {
        new CScore { Year = 2011, Category = 'A', Score = 83 },
        // 2012 A is missing
        new CScore { Year = 2013, Category = 'A', Score = 62 },
        // 2011 B is missing   
        new CScore { Year = 2012, Category = 'B', Score = 86 },
        new CScore { Year = 2013, Category = 'B', Score = 67 },
        new CScore { Year = 2011, Category = 'C', Score = 85 },
        // 2012 C is missing 
        new CScore { Year = 2013, Category = 'C', Score = 79 },
        new CScore { Year = 2011, Category = 'D', Score = 95 },
        new CScore { Year = 2012, Category = 'D', Score = 78 },
        new CScore { Year = 2013, Category = 'D', Score = 67 },
    };

    int[] years = scores.Select(i => i.Year).Distinct()
        .OrderBy(i=>i).ToArray();
    char[] categories = scores.Select(i => i.Category).Distinct()
        .OrderBy(i=>i).ToArray();

    var series =
        from year in years
        from cat in categories
        join score in scores
        on new { Year = year, Category = cat }
        equals new { score.Year, score.Category } into scoreGroup
        select scoreGroup.SingleOrDefault() ??
            new CScore { Year = year, Category = cat } into scoreWithDefault
        group scoreWithDefault.Score by scoreWithDefault.Category into g
        select new Series { Name = g.Key.ToString(), Data = g.ToArray() };

    years.Dump(); // categories
    series.Dump(); // series
}

class CScore
{
    public char Category {get;set;}
    public int Year {get;set;}
    public int Score {get;set;}
}

class Series
{
    public string Name {get;set;}
    public int[] Data {get;set;}
} 
```

### 评论

1.  `CScore`- 重命名以避免我遇到的命名错误
2.  根据输入数据对不同的项目进行排序以避免潜在的排序挑战。
3.  系列查询：
    1.  from 子句形成所有类别/年份组合的交叉产品。
    2.  允许缺失年份的`join..into`默认`CScore`生成
    3.  我选择`SingleOrDefault`这样***如果***输入数据在连接上有多个匹配的 CScore 项目，查询将抛出一个`InvalidOperationException`指示应该做更多的事情来处理冗余。我发现这比`FirstOrDefault`在这种坏数据/奇怪数据情况下不会失败的情况更可取。
    4.  `Score = 0`在初始化程序块中省略，`CScore`因为 0 是默认值。
    5.  `select..into`查询延续允许将查询输入到`group..by`按类别/名称对分数进行分组的查询中。我真的很欣赏这里的空合并运算符。
    6.  `group..by..into g`-- 该`Series`类型类似于`IGrouping<char,int>`我停止使用 group-by 时使用的类型。而是最终选择 IGrouping 类型为所需`Series`类型的项目。

我在 LINQPad 输出中验证了答案 - 并在“应该产生这个”示例输出数据中发现了一些缺陷。此外，这段代码在我的机器上执行大约需要一毫秒，所以除非我们有比这更多的数据要处理，否则我不会想改进它。

尽管我们可以谈论的内容更多——我还是把它留在那里。希望我没有失去任何人。

# ios - 可重用 UITableViewCells 的 UITableView GridLayout 问题

> ID：14863083
> 
> 赞同：0
> 
> 时间：2013-02-13T21:04:09.020
> 
> 标签：ios

我正在使用 UITableView 为 iPad 应用程序创建类似布局的网格（电子表格）。我得到了网格部分的工作，但由于我动态地将 UILabels 添加到单元格中，可重用部分不能正常工作。这是代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:@"FundCell"];

    Fund *fund = [funds objectAtIndex:[indexPath row]];

    float labelWidth = 1024 / ([columnNames count] -1 );

    for(NSString *columnName in columnNames)
    {
        UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(x, 0, labelWidth, 44)];

        label.backgroundColor = [UIColor clearColor];

        label.text = [fund valueForKey:columnName];

        x += label.bounds.size.width;

        [cell addSubview:label];
    }

    x = 0;

    return cell;
} 
```

结果：

![在此处输入图像描述](../Images/14937f273674f5abe144ddbd3ebb55e0.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:24:16.633

您在每次重用中添加新标签。您应该只添加一次标签，存储对它们的引用（通常作为自定义单元子类的属性），然后只设置文本值。

您可能会发现在 xib 中定义自定义单元格并将标签放置在那里更容易，从而创建出口。您可以将其注册以在表中重复使用，它将根据需要创建或出列单元格。

# ios - 在 iOS 的 ArcGIS 地图上画一条线

> ID：14863087
> 
> 赞同：1
> 
> 时间：2013-02-13T21:04:16.827
> 
> 标签：ios, mapkit, arcgis, esri, esri-arc-engine

我现在正在为`ArcGIS`我的一个 iOS 项目使用地图。

你如何在两点之间画一条线。在`MapKit`你使用的情况下`MKPolyLine`。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-21T19:42:41.857

如果您尚未定义任何地图图层，则有几个步骤。您需要的课程[记录在此处](http://resources.arcgis.com/en/help/runtime-ios-sdk/apiref/annotated.html)。您的地图视图 ( `AGSMapView`) 需要有一个图形图层 ( `AGSGraphicsLayer`)。您可以将`AGSGeometry`对象添加到图形层，例如`AGSSimpleLineGeomtry`. 您`AGSSimpleLineGeometry`从`AGSPolyline`定义其几何形状的对象设置对象的几何形状。像这样的东西：

1.  使用[`AGSPolyline`](http://resources.arcgis.com/en/help/runtime-ios-sdk/apiref/interface_a_g_s_polyline.html)类来定义几何（`AGSPolyline`是的子类`AGSGeometry`）。

2.  创建一个`AGSGraphic`对象并将其几何属性设置为首先创建的折线几何。使用您可以使用`AGSGraphic`诸如`AGSSimpleLineGeometry`.

3.  将`AGSGraphic`对象`AGSGraphicsLayer`添加到已添加到地图中的 （`AGSMapView`是`UIView`子类）

# jsf-2 - 表单上的 BlockUI 需要大量工作

> ID：14863098
> 
> 赞同：0
> 
> 时间：2013-02-13T21:04:57.643
> 
> 标签：jsf-2, primefaces, primefaces-extensions

我有一个包含大量工作的表格。我想从它的渲染（初始化）到它完成的时间来阻止表单，并且它里面的所有东西都被渲染了。知道我该怎么做吗？我用 blockUI(p 和 pe) 尝试了不同的东西，但是当表单完成密集工作时，我找不到触发 blockUI 的方法。提前感谢您的帮助。

注意：此过程无需提交表单即可进行。我正在使用最新的 Primefaces 快照

```
 <ui:define name="content">
    <form id="stuff">
        <!--a lot of stuff here-->
    </form>
 </ui:define> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T14:28:45.213

这会在表单呈现期间阻塞 UI。

```
<ui:define name="content">

    <p:blockUI block="stuff" widgetVar="blockUIWidget">
        <h:outputText value="Please wait..."/>
    </p:blockUI>

    <script type="text/javascript">
        $(document).ready(function() {
            blockUIWidget.show();
        });

        $(window).load(function() {
            blockUIWidget.hide();
        });
    </script>
    <form id="stuff">
        <!--a lot of stuff here-->
    </form>
</ui:define> 
```

# actionscript-3 - as3画圈类错误

> ID：14863100
> 
> 赞同：0
> 
> 时间：2013-02-13T21:05:07.863
> 
> 标签：actionscript-3, class, events, listener

我正在尝试在自定义类中创建事件侦听器。我在书中看到过这一点，但我收到错误“在 MouseDown 上访问未定义的属性”。我试图尽可能地抽象这个问题。下面提供了我用来调用我的类的命令。感谢您的任何见解。

```
package  
{
import flash.display.*;;
import flash.events.*;;

public class MouseDraw extends Sprite {

    public function MouseDraw() {
        addEventListener(MouseEvent.MOUSE_DOWN, onMouseDown);        
        }

    public function OnMouseDown(event:MouseEvent):void {
        trace("mouse down");        
    }                   

}   

} 
```

//fla中的代码

```
var mouseDraw:MouseDraw= new MouseDraw();
addChild(mouseDraw); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:17:07.277

您的代码中有一个错字：您的处理程序 ( `OnMouseDown()`) 的名称以大写字母开头，但您添加了`onMouseDown`一个小写的事件侦听器。将您的函数重命名为`onMouseDown`，它应该可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T22:19:18.110

哇——在疯狂的谷歌搜索之后让它工作。感谢所有评论的人。故事的寓意——不要相信你在书中看到的代码会编译！

```
package  
{
import flash.display.*;;
import flash.events.*;;

public class MouseDraw extends Sprite {

    public function MouseDraw() {

        graphics.lineStyle(1);

        addEventListener(Event.ADDED_TO_STAGE, init);                       
        }

    private function init(e:Event):void {
        stage.addEventListener(MouseEvent.MOUSE_DOWN,  onMouseDown);                    
    }

    private function onMouseDown(event:MouseEvent):void {
        trace("mouse down");        
    }                   

}   

} 
```

# java - 作为另一个应用程序的子项启动时，Google 地图应用程序显示在最近的应用程序中

> ID：14863101
> 
> 赞同：0
> 
> 时间：2013-02-13T21:05:08.470
> 
> 标签：java, android, google-maps, android-intent

我有以下问题：

当我像这样在我的应用程序中启动地图活动时

```
public void gotoNav (View view) {
    Intent nav = new Intent(Intent.ACTION_VIEW, Uri.parse("http://maps.google.com/maps?daddr=47.******,8.*****"));
    startActivity(nav);
} 
```

Google 地图启动，但出现在`recent apps`- 对话框中。通常不应该。当通过后退按钮离开地图时（顺便说一句，您可以在描述此按钮的字符串中使用字符吗？），会出现“app-crashed-force-close”消息。当我以同样的方式启动我的邮件应用程序时（URI 字符串除外`mailto:user@example.com`），它既不会出现在最近的应用程序中，也不会出现这样的消息。

有什么问题？

编辑：错误日志...

```
02-13 23:15:37.250: D/AndroidRuntime(6947): Shutting down VM
02-13 23:15:37.250: W/dalvikvm(6947): threadid=1: thread exiting with uncaught exception (group=0x40018578)
02-13 23:15:37.281: E/AndroidRuntime(6947): FATAL EXCEPTION: main
02-13 23:15:37.281: E/AndroidRuntime(6947): android.view.WindowManager$BadTokenException: Unable to add window -- token android.os.BinderProxy@405bfb00 is not valid; is your activity running?
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.view.ViewRoot.setView(ViewRoot.java:532)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:200)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.view.WindowManagerImpl.addView(WindowManagerImpl.java:114)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.view.Window$LocalWindowManager.addView(Window.java:424)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.app.Dialog.show(Dialog.java:241)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.view.android.aL.show(SourceFile:52)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.view.android.S.s(SourceFile:758)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.android.BaseMapsActivity.actuallyShow(SourceFile:102)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.android.BaseMapsActivity.showDialog(SourceFile:88)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.view.android.S.l(SourceFile:404)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.view.android.S.show(SourceFile:390)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.ca.c(SourceFile:372)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.ca.b(SourceFile:404)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.C.j(SourceFile:194)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.ca.a(SourceFile:661)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.ca.b(SourceFile:401)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.C.j(SourceFile:194)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.ca.a(SourceFile:246)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.ca.a(SourceFile:261)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.ca.a(SourceFile:205)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.jv.c(SourceFile:352)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.wizard.jv.e(SourceFile:1597)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.s.c(SourceFile:5496)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.A.f(SourceFile:448)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.A.a(SourceFile:387)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.ui.s.a(SourceFile:5336)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.android.M.a(SourceFile:2356)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.android.M.o(SourceFile:1730)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.android.M.k(SourceFile:1043)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.android.M.a(SourceFile:720)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.android.maps.MapsActivity.processIntentAndStartSession(SourceFile:1031)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.android.maps.w.a(SourceFile:836)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.google.googlenav.x.run(SourceFile:127)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.os.Handler.handleCallback(Handler.java:587)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.os.Handler.dispatchMessage(Handler.java:92)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.os.Looper.loop(Looper.java:130)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at android.app.ActivityThread.main(ActivityThread.java:3687)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at java.lang.reflect.Method.invokeNative(Native Method)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at java.lang.reflect.Method.invoke(Method.java:507)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
02-13 23:15:37.281: E/AndroidRuntime(6947):     at dalvik.system.NativeStart.main(Native Method)
02-13 23:15:37.289: E/liblog(1495): failed to call dumpstate
02-13 23:15:37.296: E/(1495): Dumpstate > /data/log/dumpstate_app_error 
```

# google-chrome - 铬过渡闪光

> ID：14863104
> 
> 赞同：1
> 
> 时间：2013-02-13T21:05:18.980
> 
> 标签：google-chrome, css, webkit, css-transitions

示例：[http ://codepen.io/mastastealth/pen/zvxJc](http://codepen.io/mastastealth/pen/zvxJc)

在 Chrome 中，我在为左侧 div 上的悬停效果设置动画时会出现这种奇怪的闪光（鼠标进出很多，你应该看到它）；这在 Firefox 中不会发生。有什么想法可以解决吗？

HTML：

```
<aside>
  <div>Hi</div>
</aside>
<aside class="l"></aside> 
```

萨斯：

```
html, body { height: 100%; }

aside {
  background: #CCC;
  float: left;
  height: 100%;
  width: 50%; 

  &.l {
   background: linear-gradient(blue,red); 
  }
}

div { 
  background: rgba(0,0,0,0.4);
  margin: 100px auto;
  height: 100px; width: 80%;
  transition: transform 0.2s;

  &:hover { transform: scale(1.1); }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:16:51.030

我遇到过类似的问题，为我解决的问题似乎也可以解决您的问题。我不太确定为什么这通常会起作用，而且我还没有真正找到一个好的解释，或者是否有其他更好的解决方案。

但一种方法是添加`backface-visibility: hidden;`到`div {}`并且闪光灯应该消失。

**编辑：**您还可以申请`-webkit-transform: translate3D(0, 0, 0);`强制硬件加速，这似乎使闪存消失。

希望有帮助！

# c# - .net 中 Sha256 的更新功能在哪里？

> ID：14863105
> 
> 赞同：4
> 
> 时间：2013-02-13T21:05:24.120
> 
> 标签：c#, cryptography, sha

我在我的 c++ 代码中使用了 Sha256 类的更新函数将几个字符串包含到一个哈希值中，但是我在 .net 类 Sha256 中找不到这个函数。这个功能是在C++实现，Java实现Sha，而不是.net？

C++ 中的示例代码：

```
l_ceSHA2.Init();
for ( l_dwordCnt = 0; l_dwordCnt < l_dwordHashRounds; l_dwordCnt++)
{
    l_ceSHA2.Update( mp_strPassword, strlen( mp_strPassword )));
    l_ceSHA2.Update( mp_byteSalt, 32 );
}
l_ceSHA2.Final( mp_byteCryptoKey); 
```

所以，它就像 PBKDF，但更简单。

[C中的Sha256代码供参考](http://www.spale.com/download/scrypt/scrypt1.0/sha256.c)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T22:39:12.127

您可以使用`TransformBlock`. 这是一个示例，说明如何：

```
using System;
using System.Text;
using System.Security.Cryptography;

// Example code for using TransformBlock to hash data in chunks

namespace HashTest
{
    class HashTest
    {
        static void Main(string[] args)
        {
            SHA256 hash = SHA256.Create();
            ASCIIEncoding encoding = new ASCIIEncoding();
            string password = "password";

            // Hash a string using ComputeHash
            string sourcetext = password;
            Console.WriteLine(sourcetext);
            byte[] sourcebytes = encoding.GetBytes(sourcetext);
            byte[] hashBytes = hash.ComputeHash(sourcebytes);
            string hashStr = BitConverter.ToString(hashBytes).Replace("-", "");
            Console.WriteLine(hashStr);

            // Hash exactly two copies of a string
            // (used to cross verify other methods below).
            Console.WriteLine();
            sourcetext = password + password;
            Console.WriteLine(sourcetext);
            sourcebytes = encoding.GetBytes(sourcetext);
            hashBytes = hash.ComputeHash(sourcebytes);
            hashStr = BitConverter.ToString(hashBytes).Replace("-", "");
            Console.WriteLine(hashStr);

            // Hash a string using TransformFinalBlock
            Console.WriteLine();
            sourcetext = password;
            sourcebytes = encoding.GetBytes(sourcetext);
            Console.WriteLine(sourcetext);
            hash.TransformFinalBlock(sourcebytes, 0, sourcebytes.Length);
            hashBytes = hash.Hash;
            hashStr = BitConverter.ToString(hashBytes).Replace("-", "");
            Console.WriteLine(hashStr);

            // At this point we've finalized the hash. To
            // reuse it we must first call Initialize().

            // Hash string twice using TransformBlock / TransformFinalBlock
            Console.WriteLine();
            hash.Initialize();
            sourcetext = password;
            sourcebytes = encoding.GetBytes(sourcetext);
            Console.Write(sourcetext);
            hash.TransformBlock(sourcebytes, 0, sourcebytes.Length, null, 0);
            Console.WriteLine(sourcetext);
            hash.TransformFinalBlock(sourcebytes, 0, sourcebytes.Length);
            hashBytes = hash.Hash;
            hashStr = BitConverter.ToString(hashBytes).Replace("-", "");
            Console.WriteLine(hashStr);

            // Hash string twice using TransformBlock in a loop

            Console.WriteLine();
            hash.Initialize();
            sourcetext = password;
            sourcebytes = encoding.GetBytes(sourcetext);
            for (int i = 0; i < 2; ++i)
            {
                Console.Write(sourcetext);
                hash.TransformBlock(sourcebytes, 0, sourcebytes.Length, null, 0);
            }
            Console.WriteLine();
            hash.TransformFinalBlock(sourcebytes, 0, 0);
            hashBytes = hash.Hash;
            hashStr = BitConverter.ToString(hashBytes).Replace("-", "");
            Console.WriteLine(hashStr);
        }
    }
} 
```

# java - 在类中找不到主要方法/表达式的非法开头

> ID：14863106
> 
> 赞同：1
> 
> 时间：2013-02-13T21:05:25.867
> 
> 标签：java, class, methods, main

我对这一切都很陌生，实际上对编码只有基本的了解。

我实际上正在尝试使用在 ChemMedChem 中发布的 java 代码（支持信息中的 dx.doi.org/10.1002/cmdc.200900317）

我有他们使用的所有适当的程序/jar文件（来自ChemAxon）

我能够复制代码并将其编译为没有问题的类文件：

```
javac -classpath C:\jarfolder\MarvinBeans-plugin.jar;C:\jarfolder\MarvinBeans.jar; MQN.java 
```

虽然我得到：

```
Note: MQN.java uses or overrides a deprecated API.
Note: Recompile with -Xlint:deprecation for details. 
```

然后当它尝试运行类文件时（输入文件应该是一个虚拟化学输入作为微笑代码）：

```
java -classpath C:\jarfolder\MarvinBeans-plugin.jar;C:\jarfolder\MarvinBeans.jar; MQN test.smiles 
```

我得到：

```
Error: Main method not found in class MQN, please define the main method as:
public static void main(String[] args) 
```

我试图将代码附在

```
public static void main(String[] args){} 
```

但是我得到错误：

```
>MQN.java:10: error: illegal start of expression
public String calculateMQN(Molecule m) {
^
>MQN.java:10: error: ';' expected
public String calculateMQN(Molecule m) {
                          ^
>MQN.java:10: error: ';' expected
public String calculateMQN(Molecule m) {
                                     ^
>MQN.java:255: error: reached end of file while parsing
}
 ^
4 errors 
```

您将在下面找到我使用的代码（在添加 public static void main(String[] args) 之前），任何帮助将不胜感激

谢谢！

Java 代码：

```
 import chemaxon.calculations.TopologyAnalyser; 
    import chemaxon.marvin.calculations.HBDAPlugin; 
    import chemaxon.struc.MolAtom; 
    import chemaxon.struc.MolBond; 
    import chemaxon.struc.Molecule;
    public class MQN { 
    TopologyAnalyser ta = new TopologyAnalyser(); 
    HBDAPlugin hbda = new HBDAPlugin(); 
    public String calculateMQN(Molecule m) { 
        if (!m.dearomatize()) { 
            System.out.println("DEAROMATIZE ERROR"); 
        } 
        ta.setMolecule(m); 
        //Classic descriptors 
        try { 
            hbda.setMolecule(m); 
            hbda.run(); 
        } catch (Exception e) { 
            System.err.println("HBDA ERROR"); 
        } 
        int hbd = hbda.getDonorAtomCount(); 
        int hbdm = hbda.getDonorCount(); 
        int hba = hbda.getAcceptorAtomCount();
        int hbam = hbda.getAcceptorCount(); 
        /*Reymond style Rot bond count*/
        int rbc = ta.rotatableBondCount(); 
        for (int i = 0; i < m.getBondCount(); i++) { 
            if (m.getBond(i).getType() == 3) { 
                rbc--; 
            } 
        } 
        if (rbc < 0) { 
            rbc = 0; 
        } 
        //Ring properties / ring sizes count 
        int r3 = 0, r4 = 0, r5 = 0, r6 = 0, r7 = 0, r8 = 0, r9 = 0, rg10 = 0; 
        int[][] sssr = m.getSSSR(); 
        for (int i = 0; i < sssr.length; i++) { 
            switch (sssr[i].length) { 
                case 3: 
                    r3++; 
                    break; 
                case 4: 
                    r4++; 
                    break; 
                case 5: 
                    r5++; 
                    break; 
                case 6: 
                    r6++; 
                    break; 
                case 7: 
                    r7++; 
                    break; 
                case 8: 
                    r8++; 
                    break; 
                case 9: 
                    r9++; 
                    break; 
                default: 
                    rg10++; 
                    break; 
            } 
        } 
        //Atom properties 
        int c = 0, f = 0, cl = 0, br = 0, I = 0, thac = 0, asv = 0, adv = 0, atv = 0, aqv = 0, 
                cdv = 0, ctv = 0, cqv = 0, p = 0, s = 0, posc = 0, negc = 0, 
                afrc = 0, cn = 0, an = 0, co = 0, ao = 0; 
        for (int i = 0; i < m.getAtomCount(); i++) { 
            MolAtom at = m.getAtom(i); 
            boolean isRingAt = ta.isRingAtom(i);
            if (at.getAtno() != 1) { 
                thac++; 
            } 
            //element counts 
            switch (at.getAtno()) { 
                case 1: 
                case 2: 
                case 3: 
                case 4: 
                case 5: 
                    break; 
                case 6: 
                    c++; 
                    break; 
                case 7: 
                    if (isRingAt) { 
                        cn++; 
                    } else { 
                        an++; 
                    } 
                    break; 
                case 8: 
                    if (isRingAt) { 
                        co++; 
                    } else { 
                        ao++; 
                    } 
                    break; 
                case 15: 
                    p++; 
                    break; 
                case 16: 
                    s++; 
                    break; 
                case 9: 
                    f++; 
                    break; 
                case 17: 
                    cl++; 
                    break; 
                case 35: 
                    br++; 
                    break; 
                case 53: 
                    I++; 
                    break; 
            } 
            //valency count 
            switch (at.getBondCount()) {
                case 0: 
                    System.out.println("ATOM WITH NO BONDS"); 
                    break; 
                case 1: 
                    asv++; //single valent can only be acyclic 
                    break; 
                case 2: 
                    if (isRingAt) { 
                        cdv++; 
                    } else { 
                        adv++; 
                    } 
                    break; 
                case 3: 
                    if (isRingAt) { 
                        ctv++; 
                    } else { 
                        atv++; 
                    } 
                    break; 
                case 4: 
                    if (isRingAt) { 
                        cqv++; 
                    } else { 
                        aqv++; 
                    } 
                    break; 
            } 
            if (ta.ringCountOfAtom(i) > 1) { 
                afrc++; 
            } 
        } 
        //Bond properties 
        int csb = 0, cdb = 0, ctb = 0, asb = 0, adb = 0, atb = 0, bfrc = 0; 
        for (int i = 0; i < m.getBondCount(); i++) { 
            MolBond bd = m.getBond(i); 
            if (ta.isRingBond(i)) { 
                switch (bd.getType()) { 
                    case 1: 
                        csb++; 
                        break; 
                    case 2: 
                        cdb++; 
                        break; 
                    case 3: 
                        ctb++; 
                        break; 
                    default: 
                        System.out.println("UNKNOWN CYCLIC BOND TYPE " + bd.getType()); 
                        break; 
                }
            } else { 
                switch (bd.getType()) { 
                    case 1: 
                        asb++; 
                        break; 
                    case 2: 
                        adb++; 
                        break; 
                    case 3: 
                        atb++; 
                        break; 
                    default: 
                        System.out.println("UNKNOWN ACYCLIC BOND TYPE " + bd.getType()); 
                        break; 
                } 
            } 
        } 
        //bond's fused ring count 
        int[][] sssre = m.getSSSRBonds(); 
        int[] brc = new int[m.getBondCount()]; 
        for (int j = 0; j < sssre.length; j++) { 
            for (int k = 0; k < sssre[j].length; k++) { 
                brc[sssre[j][k]]++; 
            } 
        } 
        for (int j = 0; j < brc.length; j++) { 
            if (brc[j] > 1) { //if bond's ring count > 1 
                bfrc++; //increase fused ring bonds count 
            } 
        } 
        for (int i = 0; i < m.getAtomCount(); i++) { 
            int crg = m.getAtom(i).getCharge(); 
            if (crg > 0) { 
                posc += crg; 
            } 
            if (crg < 0) { 
                negc += Math.abs(crg); 
            } 
        } 
        return  //CLASSIC PROPERTIES 
                hbd + ";" //hydrogen bond donor atom count 1 
                + hbdm + ";" //HBD with multivalency 2 
                + hba + ";" //hydrogen bond acceptor atom count 3 
                + hbam + ";" //HBA with multivalency 4 
                + rbc + ";" //rotatable bond count 5 
                //RING PROPERTIES 
                + r3 + ";" + r4 + ";" + r5 + ";" + r6 + ";" + r7 + ";" + r8 + ";" + r9 + ";" + rg10 + ";"
    //RingSize Counts 6-13 
                //ATOM PROPERTIES
                + thac + ";"//total heavy atom count (= everything else than H D T) 14 
                + c + ";" //carbon count 15 
                + p + ";"//phosphorus 16 
                + s + ";"//sulfur atom count 17 
                + f + ";" //fluor atom count 18 
                + cl + ";" //chlorine atom count 19
                + br + ";" //bromine atom count 20 
                + I + ";" //iodine atom count 21 
                + cn + ";" //cyclic nitrogen count 22 
                + an + ";" //acyclic nitrogen count 23 
                + co + ";" //cyclic oxygen count 24
                + ao + ";" //acyclic oxygen count 25 
                + asv + ";"//acyclic single valent atom count 26 
                + adv + ";"//acyclic double valent atom count 27 
                + atv + ";"//acyclic triple valent atom count 28 
                + aqv + ";"//acyclic quart valent atom count 29 
                + cdv + ";"//cyclic double valent atom count 30 
                + ctv + ";"//cyclic triple valent atom count 31 
                + cqv + ";"//cyclic quart valent atom count 32 
                + afrc + ";"//atoms-in-fused-ring count 33 
                + posc + ";" // Positive charges 34
                + negc + ";" // Negative charges 35
                //BOND PROPERTIES 
                + csb + ";"//cyclic single bonds 36
                + cdb + ";"//cyclic double bonds 37
                + ctb + ";"//cyclic triple bonds 38
                + asb + ";"//acyclic singe bonds 39
                + adb + ";"//acyclic double bonds 40 
                + atb + ";"//acyclic triple bonds 41 
                + bfrc + ";"//bonds-in-fused-ring count 42 
                + m.toFormat("smiles:q");//END 43 
    } 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:10:27.267

您的类确实不包含`main`必须遵循此签名的方法：

```
public static void main(String[] args) {
} 
```

此方法是程序的入口点，应该调用其他方法、创建对象等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:28:31.437

像这样添加主

```
...............................
...............................

public class MQN {

    TopologyAnalyser ta = new TopologyAnalyser();
    HBDAPlugin hbda = new HBDAPlugin();

    public static void main(String [] args) {
        // This is where the execution of the program will begin

    }

    public String calculateMQN(Molecule m) {
        if (!m.dearomatize()) {
            System.out.println("DEAROMATIZE ERROR");
    .............
    .............. 
```

如果您仍然遇到编译器错误，请在此处发表评论

# javascript - 表单提交第一次失败并在刷新页面后工作

> ID：14863110
> 
> 赞同：0
> 
> 时间：2013-02-13T21:05:31.887
> 
> 标签：javascript, html, django, form-submit

我正在运行一个 django web 应用程序，当我第一次提交表单时它失败了，我需要刷新并再次提交它以在其中发送数据，或者在 web 浏览器上向前执行。我正在使用 javascript 程序 (editarea) 在 textarea 上自动着色代码

这是我的 HTML 文件：

```
<html>
<head>
    <title>Test</title>
    <script language="javascript" type="text/javascript" src="/static/edit_area/edit_area_full.js"></script>
    <script type="text/javascript">
        function load() {
            var combo = document.getElementById('selSeaShells1').value;
            editAreaLoader.init({
                id: "textarea_1"        // textarea id
                    , syntax: combo                // syntax to be uses for highgliting
                    , start_highlight: true     // to display with highlight mode on start-up
            });
        }
    </script>
</head>
<body onload="load();">
    <form id="codeid" method="post" enctype="application/x-www-form-urlencoded" name="code" action="DestinationAddress/function">
    <h3>Choose a language</h3>
    <select name="sellang1" id="selSeaShells1" onchange="load();">
        <option value="python">Python</option>
        <option value="perl">Perl</option>
        <option value="sql">SQL</option>
        <option value="cpp">C++</option>
        <option value="c">C</option>
        <option value="java">Java</option>
        <option value="css">Css</option>
    </select>
    <br>
    <textarea id="textarea_1" name="content" cols="80" rows="15" type="text"></textarea>
    <input id="thebutton" type="button" value="Submit" onclick="document.forms.codeid.submit();" />
    </form>
</body>
</html> 
```

这里是views.py：

```
def function(request):

encoded_data = urllib.urlencode(request.POST)

url=urllib2.urlopen('http://webappAddress:8000/function/?' + encoded_data)

tml= url.read()

return HttpResponse(tml) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:29:13.103

你的 javascript 失败了。
var combo = document.getElementById('selSeaShells1').value;
组合将是未定义的，因为您在页面完成加载之前调用 load() 。
我会使用 jquery 并这样做：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> //download and get a local copy of jquery don't use googles.***<script>

$(document).ready(function() {
    load();
});

function load()
    {     
        var combo = $('#selSeaShells1 option:selected).val();

            editAreaLoader.init({
            id : "textarea_1"       // textarea id
            ,syntax: combo                // syntax to be uses for highgliting
            ,start_highlight: true      // to display with highlight mode on start-up
            });

    }

</script> 
```

删除 onload="load();" 在正文标签上
这将在页面加载后获得选择。

# .net - 在 GridView 中显示父/子 xml 节点

> ID：14863112
> 
> 赞同：1
> 
> 时间：2013-02-13T21:05:47.473
> 
> 标签：.net, xml, gridview

我有一个格式为 XML 的表单

```
<DDCRData>
<role>
<name>CDH</name>
<adGroup>roles</adGroup>
<active>True</active>
<connectionNames>CDH0P</connectionNames>
<roleUsers>
  <user>
    <dbUserID>asuINBJvT4iGrrUgTcEKRPLzMzN6x6WBPtIjP+VYc6Y=</dbUserID>
    <dbUserPassword>x6JsTdhRcaNI+aFMeXfYkA==</dbUserPassword>
    <assignedTo />
    <checkOutTime />
  </user>
  <user>
    <dbUserID>AYufWjterIqgR4MA5wyO/L8AIVLcDQk1+HDvcqVCnrQ=</dbUserID>
    <dbUserPassword>GElP21V6jg7admUQW+hlZA==</dbUserPassword>
    <assignedTo />
    <checkOutTime />
  </user> 
```

并希望将角色名称及其下方的所有角色用户属性输出到网格视图。每个角色有 5 个角色用户配置文件，每个角色都保存在节点中。我可以使用标准数据集绑定顶级信息：

```
 DataSet ds = new DataSet();
        ds.ReadXml(MapPath("~/utility/LogFile.xml"));
        GridView1.DataSource = ds;
        GridView1.DataBind(); 
```

但似乎无法找到一种方法来按照我想要的方式格式化表格（包括用户信息）。

即对于 xml 配置文件中的每个角色。角色名称 -assignedTo -CheckOutTime

感谢您提供所有信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T22:31:39.577

只是想我会用解决方案更新我的帖子。我为 xml 文件创建了一个 xsd 架构，并编写了两个方法来填充一个 DataTable，然后我将其用作 GridView 的数据源。

这是一些相关的代码：

```
userList = GetUsersFromRole(DDCRGroupName);
PopulateDataTable();

 public List<User> GetUsersFromRole(String DDCRGroupName)
    {
        List<User> usersBelongToRole = new List<User>();
        foreach (DDCRData.roleRow roleRow in config.role.Where(r => r.name == DDCRGroupName))
        {
            foreach (DDCRData.roleUsersRow roleuserrow in roleRow.GetroleUsersRows())
            {
                foreach (DDCRData.userRow userrow in roleuserrow.GetuserRows())
                {
                    User tempUser = new User();
                    tempUser.dbUserID = userrow.dbUserID;
                    tempUser.dbPassword = userrow.dbUserPassword;
                    tempUser.assignedTo = userrow.assignedTo;

                    usersBelongToRole.Add(tempUser);
                }
                return usersBelongToRole;
            }
        }
        return null;
    }

      private void PopulateDataTable()
    {
        //populate datatable with all user information
        foreach (User user in userList)
        {
            DataRow row = userDataTable.NewuserRow();
            row["dbUserID"] = new AESEncryption().Decrypt(user.dbUserID).ToUpper();
            row["dbUserPassword"] = new    AESEncryption().Decrypt(user.dbPassword).ToUpper();
            row["assignedTo"] = user.assignedTo;
            row["checkOutTime"] = user.checkOutTime;
            userDataTable.Rows.Add(row);
        }
    } 
```

然后在 aspx.cs 页面中只是一个简单的：

```
if ((roles != null) && (roles.Count() != 0))
        {
            DDCRData.roleDataTable table = roles.GetTable();

            GridView1.DataSource = table;
            GridView1.DataBind();
        } 
```

希望这会有所帮助！

# struts2 - addFieldError 在 Struts2 中不起作用

> ID：14863121
> 
> 赞同：1
> 
> 时间：2013-02-13T21:06:15.813
> 
> 标签：struts2

我正在学习 struts2 并且在显示 addFieldError 消息时遇到了一些问题..没有显示..当我运行我的项目并将 userID 字段留空时，它确实进入了 validate 方法，甚至满足了**isEmpty**方法的条件，但它没有显示任何错误消息..我在**isEmpty**方法中放了一个 sop 语句来查看，它是否进入.. 语句打印在控制台上，url 更改为**../MyStruts/validation.action**，任何地方都没有错误，也没有任何反应更远..

有人可以告诉我我在哪里做错了..这是我的代码..

struts.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE struts PUBLIC
"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"
 "http://struts.apache.org/dtds/struts-2.0.dtd">

 <struts>

 <package name="validate" extends="struts-default">
 <action name="validation"  class="com.staction.DataAction">
 <result name="success">/success.jsp</result>
 <result name="input">/form1.jsp</result>
 <result name="error">/error.jsp</result>
  </action>  </package>

   </struts> 
```

form1.jsp

```
 <%@ page language="java" contentType="text/html; charset=ISO-8859-1"   pageEncoding="ISO-8859-1"%>
   <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
    <%@ taglib prefix="s" uri="/struts-tags" %>

  <html>
 <head>

</head>
<s:form action="validation">
<h1>
<s:textfield label="UserName" name="userID" />
<s:password label="password" name="password" />
</h1>
<s:submit />
</s:form>
<s:a href="forget">forget password </s:a>
    </html> 
```

动作课...

```
 package com.staction;

     import org.apache.commons.lang3.StringUtils;

     import com.opensymphony.xwork2.ActionSupport; 
     import com.opensymphony.xwork2.ModelDriven;

    public class DataAction extends ActionSupport implements ModelDriven<User> {

private static final long serialVersionUID = 1L;
User user;
DataCheck dc;
public DataAction() {
    user=new User();
    dc=new DataCheck();
}

@Override
public void validate() {
    if(StringUtils.isEmpty(user.getUserID()))
    {
        System.out.println("hellp");
        addFieldError("user.userID", "wtf!!!!");
    }

}
public String execute()
{
    System.out.println("user.userID");
    /*      if(dc.isValid(user))
{
    return SUCCESS;
}*/
    return ERROR;
}

@Override
public User getModel() {
    // TODO Auto-generated method stub
    return user;
} 
```

}

终于`User`上课了。。

```
package com.staction;

import org.apache.commons.lang3.StringUtils;

import com.opensymphony.xwork2.ActionSupport;

public class User{
String userID;
String password;

public String getUserID() {
    return userID;
}
public void setUserID(String userID) {
    this.userID = userID;
}
public String getPassword() {
    return password;
}
public void setPassword(String password) {
    this.password = password;
}
   } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:09:51.587

你的表格：

```
<s:textfield label="UserName" name="userID" /> 
```

您的字段错误：

```
addFieldError("user.userID", "wtf!!!!"); 
```

看到不同？

还：

*   我希望您的代码实际上不是那样随机格式化的；很难阅读。
*   为什么你的`User`课要扩展`ActionSupport`？如果它不是一个动作，请不要扩展基本的默认动作：它没有意义，而且具有误导性。
*   考虑将动作命名为有意义的东西：*大多数*动作都是“数据动作”。
*   在发布示例时，请删除注释掉的代码和与特定问题不直接相关的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-20T01:32:15.077

除了戴夫牛顿的回应，您必须删除“用户”。在 addFieldError 中，以便 Struts2 使用 getModel 自动获取正确的对象，或者您必须在 Action 中为对象用户添加 set/get 方法，以便使用 getter 访问对象。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-08-28T11:30:32.260

Jst 使用要验证的字段的名称...将您的代码更改为

```
addFieldError("UserName", "wtf!!!!"); 
```

# python - 自动格式化 x 轴

> ID：14863123
> 
> 赞同：1
> 
> 时间：2013-02-13T21:06:24.133
> 
> 标签：python, matplotlib

我有一个程序可以处理不同类型的数据。有些数据很大，有些数据非常小。由于某些原因，我只能使用 matplotlib 绘制如下图：

```
 TimeDelta=FF.index[-1]-FF.index[0]          
      ax = fig.add_subplot(111)
      if TimeDelta>timedelta(days=6):
          intr=int(TimeDelta.days/6)
      else:
          intr=2
  #ax.xaxis.set_minor_locator(dates.WeekdayLocator(byweekday=(1),interval=intr))
      ax.xaxis.set_minor_locator(dates.DayLocator(interval=intr))
      ax.xaxis.set_minor_formatter(dates.DateFormatter('%b%d'))
      years= matplotlib.dates.YearLocator() # every year
      yearsFmt = matplotlib.dates.DateFormatter('')
      ax.xaxis.set_major_locator(years)
      ax.xaxis.set_major_formatter(yearsFmt) 
```

我觉得这个方法太复杂了，有人有其他简单的方法来处理这种情况吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T03:41:29.557

有些`Auto*`类[`dates`](http://matplotlib.org/api/dates_api.html#module-matplotlib.dates)确实有一些你可以调整的旋钮，但你似乎想要一个非常具体的格式。我只想做一个功能：

```
def my_x_axis_format(ax, dt):
    if dt>timedelta(days=6):
      intr=int(dt.days/6)
    else:
        intr=2
    #ax.xaxis.set_minor_locator(dates.WeekdayLocator(byweekday=(1),interval=intr))
    ax.xaxis.set_minor_locator(dates.DayLocator(interval=intr))
    ax.xaxis.set_minor_formatter(dates.DateFormatter('%b%d'))
    years= matplotlib.dates.YearLocator() # every year
    yearsFmt = matplotlib.dates.DateFormatter('')
    ax.xaxis.set_major_locator(years)
    ax.xaxis.set_major_formatter(yearsFmt) 
```

然后你可以让你的数字为

```
TimeDelta=FF.index[-1]-FF.index[0]          
ax = fig.add_subplot(111)
my_x_axis_format(ax, TimeDelta) 
```

# python - 具有不平衡类的sklearn逻辑回归

> ID：14863125
> 
> 赞同：21
> 
> 时间：2013-02-13T21:06:24.773
> 
> 标签：python, scikit-learn, classification

我正在用 python 中的 sklearn 逻辑回归解决分类问题。

我的问题是一般/通用问题。我有一个包含两个类/结果（正/负或 1/0）的数据集，但该数据集非常不平衡。有约 5% 的阳性和约 95% 的阴性。

我知道有很多方法可以处理这样的不平衡问题，但还没有找到一个很好的解释来说明如何使用 sklearn 包正确实现。

到目前为止，我所做的是通过选择具有正面结果的条目和随机选择的相同数量的负面条目来建立一个平衡的训练集。然后我可以将模型训练到这个集合，但我不知道如何修改模型，然后处理原始的不平衡人口/集合。

执行此操作的具体步骤是什么？我翻遍了 sklearn 文档和示例，但没有找到好的解释。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-13T22:34:53.260

您是否尝试过传递给您的`class_weight="auto"`分类器？并非 sklearn 中的所有分类器都支持这一点，但有些支持。检查文档字符串。

您还可以通过随机丢弃负样本和/或过度采样正样本（+ 可能会添加一些轻微的高斯特征噪声）来重新平衡数据集。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2016-06-15T02:26:06.043

@agentscully 你读过下面的论文吗？

[SMOTE]（[https://www.jair.org/media/953/live-953-2037-jair.pdf](https://www.jair.org/media/953/live-953-2037-jair.pdf)）。我发现同样非常有用。这是[回购](https://github.com/fmfn/UnbalancedDataset)的链接。根据您平衡目标类的方式，您可以使用

*   **'auto'** : （*在较新的版本 0.17 中已弃用*）或 'balanced' 或自己指定类比 {0: 0.1, 1: 0.9}。
*   **'balanced'**：此模式调整权重与类频率成反比`n_samples / (n_classes * np.bincount(y)`

如果需要更多见解，请告诉我。

# javascript - 输入后滚动Phonegap iOS

> ID：14863126
> 
> 赞同：0
> 
> 时间：2013-02-13T21:06:27.007
> 
> 标签：javascript, iphone, html, ios, cordova

当用户在我的 Phonegap 应用程序上输入文本然后在完成后返回时，整个页面会滚动得比应有的更远。

我正在寻找一种解决方法，以确保一旦失去焦点，页面就会返回到正常位置。

请参阅说明问题的图像：

[http://i.imgur.com/ehd​​XCQq.png](http://i.imgur.com/ehdXCQq.png)

我正在使用 iScroll 4.0，但它在此页面上未激活。

如何纠正这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:06:53.013

前进的方法是设置一个 Javascript 事件，以便在输入框失去焦点后将其带回页面顶部（或任何地方）。这使用了该`onblur`方法（我猜与`onfocus`？）并真正简单地说一旦失去焦点，页面就会重新回到顶部。

这是工作示例：

```
<input name="foo" id="foo" class="foo" onblur="window.scrollTo(0,0);" type="text" /> 
```

...当然，`onblur="window.scrollTo(0,0);"`是返回页面顶部的操作代码。

# php - if 语句中未定义的变量

> ID：14863128
> 
> 赞同：1
> 
> 时间：2013-02-13T21:06:28.203
> 
> 标签：php, mysqli

我正在尝试编译一个 if 语句来检查回复类型是否为`Single`或`Multiple`通过检查 mysqli 变量。如果`Single`则将选项输出为单选按钮，如果`Multiple`则将选项输出为复选框。

但是我在 if 语句中收到一个未定义的变量错误`$qandaReplyType`。如何解决这个问题？

下面的代码：

```
 $qandaquery = "SELECT q.QuestionId, r.ReplyType
                    FROM Question q
                    LEFT JOIN Reply r ON q.ReplyId = r.ReplyId

                    WHERE SessionId = ?
                    GROUP BY q.QuestionId
                    ORDER BY RAND()";

    $qandaqrystmt=$mysqli->prepare($qandaquery);
    // get result and assign variables (prefix with db)
    $qandaqrystmt->execute(); 
    $qandaqrystmt->bind_result($qandaQuestionId,$qandaReplyType);

    $arrReplyType = array();

    while ($qandaqrystmt->fetch()) {

    $arrReplyType[ $qandaQuestionId ] = $qandaReplyType;
  }

    $qandaqrystmt->close();

    function ExpandOptionType($option) { 

    $options = explode('-', $option);
    if(count($options) > 1) {
        $start = array_shift($options);
        $end = array_shift($options);
        do {
            $options[] = $start;
        }while(++$start <= $end);
     }
     else{
        $options = explode(' or ', $option);
     }

     if($qandaReplyType == 'Single'){
     foreach($options as $indivOption) {
         echo '<div class="ck-button"><label class="fixedLabelCheckbox"><input type="radio" name="options_<?php echo $key; ?>[]" id="option-' . $indivOption . '" value="' . $indivOption . '" /><span>' . $indivOption . '</span></label></div>';
     }
 }else if($qandaReplyType == 'Multiple'){
           foreach($options as $indivOption) {
         echo '<div class="ck-button"><label class="fixedLabelCheckbox"><input type="checkbox" name="options_<?php echo $key; ?>[]" id="option-' . $indivOption . '" value="' . $indivOption . '" /><span>' . $indivOption . '</span></label></div>';
     }
}
}

foreach ($arrQuestionId as $key=>$question) {

echo ExpandOptionType(htmlspecialchars($arrOptionType[$key]));

}

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:08:09.603

`$qandaReplyType`函数内部不存在。

您需要先包含`global $qandaReplyType`在函数内部，然后才能使用变量的全局版本。

复习一下PHP 中的[变量范围不会有什么坏处。](http://php.net/manual/en/language.variables.scope.php)

* * *

**编辑：**从外观上看，`$arrQuestionId`也不`$arrOptionType`在函数范围内。
`global $qandaReplyType, $arrQuestionId, $arrOptionType;`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:14:38.383

嗯嗯......你的功能......试试这个：

```
function ExpandOptionType($option) { 
$qandaReplyType = "Single";
$options = explode('-', $option);
if(count($options) > 1) {
    $start = array_shift($options);
    $end = array_shift($options);
    do {
        $options[] = $start;
    }while(++$start <= $end);
 }
 else{
    $options = explode(' or ', $option);
 }

 if($qandaReplyType == 'Single'){
 foreach($options as $indivOption) {
     echo '<div class="ck-button"><label class="fixedLabelCheckbox"><input type="radio"
    name="options_<?php echo $key; ?>[]" id="option-' . $indivOption . '" value="' . 
 $indivOption . '" /><span>' . $indivOption . '</span></label></div>';
 }
 }else if($qandaReplyType == 'Multiple'){
       foreach($options as $indivOption) {
     echo '<div class="ck-button"><label class="fixedLabelCheckbox"><input type="checkbox" name="options_<?php echo $key; ?>[]" id="option-' . $indivOption . '" value="' . $indivOption . '" /><span>' . $indivOption . '</span></label></div>';
 }
 }
 } 
```

如果可行，则 $qandaReplyType 未在函数“内部”定义....您应该找到一种方法来恢复该值 o 可以向函数添加另一个参数并传递 $qandaReplyType 值，例如：

```
function ExpandOptionType($option,$qandaReplyType) 
```

萨卢多斯 ;)

# dojo - 如何将 html 标签与 dijit/form 小部件一起使用？

> ID：14863130
> 
> 赞同：0
> 
> 时间：2013-02-13T21:06:37.610
> 
> 标签：dojo, dijit.form

好的，所以我正在使用 Dojo 1.8 构建一个应用程序，并且我有一个带有类似于此模板的自定义小部件......

```
<div>
  <label for="tag">Select something: </label>
  <select id="tag"
      data-dojo-attach-point="tag"
      data-dojo-type="dijit/form/Select">
    <option value="0">option 0</option>
    <option value="1">option 1</option>
  </select>
</div> 
```

但是，当模板被渲染时，小部件定义了一个新的 id，这使得标签无用。我试过用谷歌搜索，但我所有的搜索都直接指向 Dojo 文档，因为它们具有称为标签的属性，但与 HTML 标签标签无关。

这样做的正确原因是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T06:40:28.190

在您描述的情况下，您可以简单地将标签放在**<select>**周围并使用 for/id 属性进行处理。请参阅 Stackoverflow 问题：

*   [如何对齐两个相邻的 dojo 小部件？](https://stackoverflow.com/questions/13715345/how-do-i-align-two-dojo-widgets-next-to-each-other/13720865#13720865)，另见：[关于标签使用的 w3 教程](http://www.w3schools.com/tags/tag_label.asp)

此外，如果您想在小部件模板中实际使用 Id，请参阅：

*   [如何在 Dojo 小部件模板中创建唯一 ID？](https://stackoverflow.com/questions/11182103/how-do-i-create-unique-ids-in-a-dojo-widget-templateList)

不鼓励直接使用 ids（即硬编码它们，而不是像上面的链接那样即时分配它们）。这样做的原因是模板旨在在创建小部件时一遍又一遍地使用。

理论上，它可以用来在一个页面上创建多个小部件。因此，在这种情况下，您将遇到身份冲突。任何一个页面上的每个 HTML id 都必须是唯一的。

# php - 使用复选框使用 PHP 过滤 MySQL 查询

> ID：14863140
> 
> 赞同：0
> 
> 时间：2013-02-13T21:07:06.047
> 
> 标签：php, mysql, sql, filter

我正在为一家酒店管理公司开发一个网站。在投资组合页面上，我目前有一个谷歌地图，其中包含所有精确定位的酒店和一个来自数据库的酒店表格。但是，我想要一个带有与酒店品牌相对应的复选框的表单。选择一个复选框将仅显示该品牌名称的酒店。我可以弄清楚如何只选择一个品牌，但不能选择多个品牌。

这是表单的代码：

```
<form>
<div class="form-block">
<input type="checkbox" name="Courtyard" value="true" <?php if (isset($_GET["Courtyard"])) { echo "checked"; } ?> /> Courtyard<br />
<input type="checkbox" name="HolidayInnExpress" value="true" <?php if (isset($_GET["HolidayInnExpress"])) { echo "checked"; } ?> /> Holiday Inn Express<br />
<input type="checkbox" name="BestWestern" value="true" <?php if (isset($_GET["BestWestern"])) { echo "checked"; } ?> /> Best Western<br />
</div>
<div class="form-block">
<input type="checkbox" name="CrownePlaza" value="true" <?php if (isset($_GET["CrownePlaza"])) { echo "checked"; } ?> /> Crowne Plaza<br />
<input type="checkbox" name="HolidayInn" value="true" <?php if (isset($_GET["HolidayInn"])) { echo "checked"; } ?> /> Holiday Inn<br />
<input type="checkbox" name="SpringhillSuites" value="true" <?php if (isset($_GET["SpringhillSuites"])) { echo "checked"; } ?> /> Springhill Suites<br />
</div>
<div class="form-block">
<input type="checkbox" name="HamptonInn" value="true" <?php if (isset($_GET["HamptonInn"])) { echo "checked"; } ?> /> Hampton Inn<br />
<input type="checkbox" name="HomewoodSuites" value="true" <?php if (isset($_GET["HomewoodSuites"])) { echo "checked"; } ?> /> Homewood Suites<br />
<input type="checkbox" name="Independent" value="true" <?php if (isset($_GET["Independent"])) { echo "checked"; } ?> /> Independent Properties<br />
</div>
<button type="submit">Filter</button> 
```

和 MySQL Query 来显示表

```
 <?php
if (isset($_GET["BestWestern"])) {
  echo "Brand=\"Best Western\"";
}
$result = mysql_query("SELECT Name, City, State, Website FROM markers WHERE Brand LIKE '%' ORDER BY City");
echo "<table border='1'>
<tr>
    <th>Hotel Name</th>
    <th>City</th>
    <th>State</th>
    <th>Website</th>
</tr>";
while($row = mysql_fetch_array($result)) {
    echo "<tr>";
    echo "<td>" . $row['Name'] . "</td>";
    echo "<td>" . $row['City'] . "</td>";
    echo "<td>" . $row['State'] . "</td>";
    echo "<td><a href='" . $row['Website'] . "'>Visit Website</a></td>";
    echo "</tr>";
}
echo "</table>";
?> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:14:33.393

最简单的方法是使用`WHERE ... IN ()`查询，而不是`LIKE`. 例如

```
$brands = array('Brand X', 'Brand Y');
$sql = "SELECT ... WHERE Brand in ('" . implode("','", $brands) . "');"; 
```

请注意，这只是一个示例。它容易受到 SQL 注入攻击，不应按原样使用。

# c++ - 在 C++ 中访问由 Bash 进程替换创建的“虚拟文件”

> ID：14863142
> 
> 赞同：2
> 
> 时间：2013-02-13T21:07:11.357
> 
> 标签：c++, bash, ascii, process-substitution

我有一个 C++ 可执行文件，在正常使用中，它以下列方式接受文件名作为参数选项：

```
executable -i myFile.txt 
```

我想使用 Bash 进程替换来创建一个“虚拟文件”并通过以下方式将信息（简单的逐行数据）发送到该可执行文件：

```
executable -i <(echo "${myData}") 
```

但是，当我使用此进程替换时，我的 C++ 程序没有访问信息。C++程序中代码的主要文件读取部分如下：

```
ifstream file1 (fileName1);
string line;
int currentLineNumber = 0;
if (verboseFlag == 1) {cout << "reading data from file " << fileName1 << "..." << endl;}
while (getline (file1, line)){
    currentLineNumber++;
    if (verboseFlag == 1) {cout << "line " << currentLineNumber << ": ";}
    istringstream linestream(line);
    string item;
    int itemNumber = 0;
    while (getline (linestream, item, ',')){
        itemNumber++;
        if (verboseFlag == 1) {cout << "item " << itemNumber << ": " << item << " ";}
        // data
            if (itemNumber == 1) {x[currentLineNumber]=atof(item.c_str());}
            if (itemNumber == 2) {y[currentLineNumber]=atof(item.c_str());}
    }
}
file1.close(); 
```

你能指出我解决这个阅读问题的正确方向吗？是否有一些更好的方法适用于正常文件读取和进程替换“文件”读取？

我是这个过程替换的新手，我非常感谢对此提供的任何帮助。

* * *

编辑：

在一些评论之后，下面是一个最小的工作示例，说明了我遇到的问题：

```
// definition of standard input/output stream objects
    #include <iostream>
// manipulate strings as though they were input/output streams
    #include <sstream>
// input and output operations
    #include <stdio.h>
// file input and output operations
    #include <fstream>
// manipulate C strings and arrays
    #include <string.h>
// classify and transform individual characters
    #include <ctype.h>
// Standard General Utilities Library
    #include <stdlib.h>
// getopts (handle command line options and arguments)
    #include <unistd.h>
// sstream (handle conversion from char* to double)
    #include <sstream>

using namespace std;

double returnDoubleFromPointerToChar(const char *cText){
    std::stringstream ss ( cText );
    double dText = 0;
    ss >> dText;
    return dText;
}

int returnNumberOfLinesInFile(const char *fileName1){
    int lineCount = 0;
    string line;
    ifstream file1(fileName1);
    while (std::getline(file1, line))
        ++lineCount;
    file1.close();
    return lineCount;
}

int main (int argc, char **argv){
    char *fileName1 = NULL; // input file name  (i) (required input)
    int verboseFlag = 0;        // verbose flag     (v)
    int index; // internal variable
    int c; // internal variable
    opterr = 0;

    // process command line arguments and options
        while ((c = getopt (argc, argv, "i:v")) != -1)
            switch (c){
                case 'i':
                    fileName1 = optarg;
                    break;
                case 'v':
                    verboseFlag = 1;
                    break;
                case '?':
                    if (
                        optopt == 'i'
                    ){
                        fprintf (stderr, "option -%c requires an argument.\n", optopt);
                    }
                    else if (isprint (optopt)){
                        fprintf (stderr, "unknown option `-%c'.\n", optopt);
                    }
                    else {
                        fprintf (stderr, "unknown option character `\\x%x'.\n", optopt);
                    }
                    return 1;
                default:
                    abort ();
        }
        for (index = optind; index < argc; index++) printf ("non option argument %s\n", argv[index]);
    if (verboseFlag == 1){
        cout << endl;
        cout << "input file name: " << fileName1 << endl;
    }
    // Determine the number of lines in the input file.
        int numberOfLinesInInputFile=returnNumberOfLinesInFile(fileName1);
        if (verboseFlag == 1) {cout << "number of lines in input file: " << numberOfLinesInInputFile << endl;}
    // number of data points
        int n=numberOfLinesInInputFile-1;
    // x variable
        double x[n];
    // y variable
        double y[n];
    // Access the data in the input file.
        ifstream file1 (fileName1);
        string line;
        int currentLineNumber = 0;
        if (verboseFlag == 1) {cout << "reading data from file " << fileName1 << "..." << endl;}
        while (getline (file1, line)){
            currentLineNumber++;
            if (verboseFlag == 1) {cout << "line " << currentLineNumber << ": ";}
            istringstream linestream(line);
            string item;
            int itemNumber = 0;
            while (getline (linestream, item, ',')){
                itemNumber++;
                if (verboseFlag == 1) {cout << "item " << itemNumber << ": " << item << " ";}
                // data
                    if (itemNumber == 1) {x[currentLineNumber]=atof(item.c_str());}
                    if (itemNumber == 2) {y[currentLineNumber]=atof(item.c_str());}
            }
            if (verboseFlag == 1) {cout << endl;}
        }
        file1.close();
    return 0;
} 
```

编辑：

我在下面添加了解决方案代码（根据其他人的评论）：

```
// include WBM C++ library
//  #include "lib_cpp.c"
// definition of standard input/output stream objects
    #include <iostream>
// manipulate strings as though they were input/output streams
    #include <sstream>
// input and output operations
    #include <stdio.h>
// file input and output operations
    #include <fstream>
// manipulate C strings and arrays
    #include <string.h>
// classify and transform individual characters
    #include <ctype.h>
// Standard General Utilities Library
    #include <stdlib.h>
// getopts (handle command line options and arguments)
    #include <unistd.h>
// sstream (handle conversion from char* to double)
    #include <sstream>

using namespace std;

// example usage:
//  ./graph2d -i data.txt -o data.eps -v
//  ./graph2d -i data.txt -o graph.eps -t "training test error versus epochs" -x "epochs" -y "error measure" -v
//  ./graph2d -i data.txt -o graph.eps -t "training test error versus epochs" -x "epochs" -y "error measure" -a 70 -b 50 -c 22 -d 7 -v
//  ./graph2d -i <(echo "${dataForTrainingErrorVersusEpoch}") -o graph.eps -t "training test error versus epochs" -x "epochs" -y "error measure" -v

double returnDoubleFromPointerToChar(const char *cText){
    std::stringstream ss ( cText );
    double dText = 0;
    ss >> dText;
    return dText;
}

int main (int argc, char **argv){
    char *fileName1 = NULL; // input file name  (i) (required input)
    char *fileName2 = NULL; // output file name (o) (required input)
    char *graphTitleMain = NULL;    // graph title      (t)
    char *graphTitleAxisx = NULL;   // graph x axis title   (x)
    char *graphTitleAxisy = NULL;   // graph y axis title   (y)
    double axisyMaximum = DBL_MAX;  // y axis maximum   (a)
    double axisyMinimum = DBL_MAX;  // y axis minimum   (b)
    double axisxMaximum = DBL_MAX;  // x axis maximum   (c)
    double axisxMinimum = DBL_MAX;  // x axis minimum   (d)
    int verboseFlag = 0;        // verbose flag     (v)
    int index; // internal variable
    int c; // internal variable
    opterr = 0;

    // process command line arguments and options
        while ((c = getopt (argc, argv, "i:o:t:x:y:a:b:c:d:v")) != -1)
            switch (c){
                case 'i':
                    fileName1 = optarg;
                    break;
                case 'o':
                    fileName2 = optarg;
                    break;
                case 't':
                    graphTitleMain = optarg;
                    break;
                case 'x':
                    graphTitleAxisx = optarg;
                    break;
                case 'y':
                    graphTitleAxisy = optarg;
                    break;
                case 'a':
                    axisyMaximum = returnDoubleFromPointerToChar(optarg);
                    break;
                case 'b':
                    axisyMinimum = returnDoubleFromPointerToChar(optarg);
                    break;
                case 'c':
                    axisxMaximum = returnDoubleFromPointerToChar(optarg);
                    break;
                case 'd':
                    axisxMinimum = returnDoubleFromPointerToChar(optarg);
                    break;
                case 'v':
                    verboseFlag = 1;
                    break;
                case '?':
                    if (
                        optopt == 'i' ||
                        optopt == 'o' ||
                        optopt == 't' ||
                        optopt == 'x' ||
                        optopt == 'y' ||
                        optopt == 'a' ||
                        optopt == 'b' ||
                        optopt == 'c' ||
                        optopt == 'd'
                    ){
                        fprintf (stderr, "option -%c requires an argument.\n", optopt);
                    }
                    else if (isprint (optopt)){
                        fprintf (stderr, "unknown option `-%c'.\n", optopt);
                    }
                    else {
                        fprintf (stderr, "unknown option character `\\x%x'.\n", optopt);
                    }
                    return 1;
                default:
                    abort ();
        }
        for (index = optind; index < argc; index++) printf ("non option argument %s\n", argv[index]);
    if (verboseFlag == 1){
        cout << endl;
        cout << "input file name: " << fileName1 << endl;
        cout << "output file name: " << fileName2 << endl;
    }
    // x variable
        vector<int> x;
    // y variable
        vector<int> y;
    // Access the data in the input file.
        ifstream file1 (fileName1);
        string line;
        int currentLineNumber = 0;
        if (verboseFlag == 1) {cout << "reading data from file " << fileName1 << "..." << endl;}
        while (getline (file1, line)){
            currentLineNumber++;
            if (verboseFlag == 1) {cout << "line " << currentLineNumber << ": ";}
            istringstream linestream(line);
            string item;
            int itemNumber = 0;
            while (getline (linestream, item, ',')){
                itemNumber++;
                if (verboseFlag == 1) {cout << "item " << itemNumber << ": " << item << " ";}
                // data
                    if (itemNumber == 1) {x.push_back(atof(item.c_str()));}
                    if (itemNumber == 2) {y.push_back(atof(item.c_str()));}
            }
            if (verboseFlag == 1) {cout << endl;}
        }
        file1.close();
        int numberOfLinesInInputFile = currentLineNumber + 1;
    // number of data points
        int n=numberOfLinesInInputFile;
    // graph
        if (verboseFlag == 1){
            cout << "graph main title: " << graphTitleMain << endl;
            cout << "graph x axis title: " << graphTitleAxisx << endl;
            cout << "graph y axis title: " << graphTitleAxisy << endl;
        }
        // Create a new canvas.
            TCanvas *c1 = new TCanvas(graphTitleMain, graphTitleMain); // #u
        // Create a new graph.
            //TGraph *graph = new TGraph(n, x, y);
            TGraph *graph = new TGraph(n, &x[0], &y[0]);
        // Set the graph titles.
            graph->SetTitle(graphTitleMain);
            graph->GetXaxis()->SetTitle(graphTitleAxisx);
            graph->GetYaxis()->SetTitle(graphTitleAxisy);
        // Set the marker styles.
            graph->SetMarkerColor(2); // red
            graph->SetMarkerStyle(kFullCircle); // circle
            graph->SetMarkerSize(1); // default size
        // Set the graph range, if ranges have been specified in command line options.
            if (
                axisyMaximum != DBL_MAX &&
                axisyMinimum != DBL_MAX
            ){
                if (verboseFlag == 1){
                    cout << "graph y axis minimum: " << axisyMinimum << endl;
                    cout << "graph y axis maximum: " << axisyMaximum << endl;
                }
                graph->GetYaxis()->SetRangeUser(axisyMinimum, axisyMaximum);
            }
            if (
                axisxMaximum != DBL_MAX &&
                axisxMinimum != DBL_MAX
            ){
                if (verboseFlag == 1){
                    cout << "graph x axis minimum: " << axisxMinimum << endl;
                    cout << "graph x axis maximum: " << axisxMaximum << endl;
                }
                graph->GetXaxis()->SetRangeUser(axisxMinimum, axisxMaximum);
            }
        // Draw the canvas, then draw the graph and then save the canvas to an image file.
            c1->Draw();
            graph->Draw("ALP");
            // disable ROOT messages
                gErrorIgnoreLevel = 5000;
            if (verboseFlag == 1) {cout << "saving file " << fileName2 << "..." << endl;}
            c1->SaveAs(fileName2);
    if (verboseFlag == 1) {cout << endl;}
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:20:47.863

首先，我剪掉了你的程序的三分之二，它仍然显示问题。这明显接近最小值：

```
#include <iostream>
#include <fstream>

using namespace std;

int returnNumberOfLinesInFile(const char *fileName1){
  int lineCount = 0;
  string line;
  ifstream file1(fileName1);
  while (std::getline(file1, line))
    ++lineCount;
  file1.close();
  return lineCount;
}

int main (int argc, char **argv){
  char *fileName1 = argv[1];
  cout << "input file name: " << fileName1 << endl;
  int numberOfLinesInInputFile=returnNumberOfLinesInFile(fileName1);
  cout << "number of lines in input file: " << numberOfLinesInInputFile << endl;

  ifstream file1(fileName1);
  string line;
  cout << "File contents: " << endl;
  while (getline (file1, line)){
    cout << "line: " << line << endl;
  }
  file1.close();
  return 0;
} 
```

这里的问题是您打开文件两次。`<(process substitution)`只运行一次命令并流式传输结果。如果您想再次读取输出，Bash 不会冒昧地再次运行该命令，因为该命令除了吐出文本之外还可以做很多其他事情。

确保你的程序只打开和读取一次内容，它就会工作。这可能需要您稍微重写您的逻辑，或者只是懒惰并一次将其全部读入内存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:20:55.177

你的代码对我来说很好（我在 OS X 上）。

请记住，与真实文件不同，“虚拟文件”通常是管道端点（在 bash 中使用文件描述符特殊文件实现）。因此，您不能多次打开、读取和关闭虚拟文件，否则第二次您将一无所获。

# python - 在python中以指数格式删除前导0

> ID：14863143
> 
> 赞同：3
> 
> 时间：2013-02-13T21:07:11.650
> 
> 标签：python, floating-point, string-formatting

我在 Python 3.1 中有以下代码

```
"{0:.6E}".format(9.0387681E-8) 
```

这给出了一个字符串`9.038768E-08`，但我想要删除`9.038768E-8` 前导 0的字符串。`E-08`我该怎么办？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:12:25.907

你可以做这样的事情

```
"{0:.6E}".format(9.0387681E-8).replace("E-0", "E-") 
```

或者像 JBernardo 建议的那样更好

```
format(9.0387681E-8, '.6E').replace("E-0", "E-") 
```

`E+0`如果你有大数字，你也需要更换

# c++ - Visual Studio 2008 - vftable 指针不正确？调试模式崩溃，Release 没问题

> ID：14863150
> 
> 赞同：0
> 
> 时间：2013-02-13T21:07:34.923
> 
> 标签：c++, visual-studio, debugging, crash, release

我目前面临 VS08 的问题。我得到了以下（简化的）类结构：

```
class CBase
{
    public:
    virtual void Func() = 0;
};

class CDerived : public CBase
{
public:
    void Func();
}; 
```

此代码在发布模式下运行良好，但是当我尝试运行调试构建时，它会立即在`new CDerived`.

进一步的分析使我能够找到崩溃的位置。它在 CBase::CBase （编译器生成的构造函数）处崩溃。更准确地说，它在`04AE46C6 mov dword ptr [eax],offset CBase::`vftable' (505C2CCh) ` 处崩溃。

有什么线索吗？发布模式很好，但我无法正确调试它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:22:50.657

> 释放模式很好

不，它似乎很好。我的猜测是在调试内存以某种方式被覆盖。由于无法仅从您发布的代码中判断，这就是您可以执行的操作。

我假设您在某处创建对象：

```
CBase* p = new CDerived; 
```

或类似的。在调试模式下，在' 位置设置**内存断点。**`p`您可以将其设置为监视 4 个字节。Visual C++（像大多数编译器一样）会将 vfptr 作为类中的第一件事，因此此断点将跟踪该位置是否被覆盖。如果断点在你调用它崩溃的函数之前被命中，那就是你的问题（调用堆栈会告诉你为什么它被覆盖）。

这可能有很多原因 - 您可能会超出一些内存并覆盖对象（正如 Erik 建议的那样） - 发布版本可能会直接解决调用以防止动态调度的开销，这可以解释为什么它没有崩溃。

也可能是您调用`delete`了对象，而调试版本实际上将内存清零，而发布版本则没有。没有办法仅凭此说。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-14T02:28:48.500

在这里发布一些死灵，但我想为未来的访客提出一点......

正如其他人所说，这可能是内存损坏或免费+重用问题。您不应该仅仅因为您能够通过更改编译器设置或重新排列代码来消除崩溃，就认为这是一个编译器错误。如果这是一个损坏错误，您可能所做的是将损坏移到不会导致程序崩溃的某些内存中——无论如何，在您当前的构建中，在您当前的操作系统和架构上。

仅仅达到不崩溃的地步可能已经足以满足您的即时需求，但与此同时，您并没有学会避免任何导致您首先编写错误的做法。工程师之间有一句由来已久的谚语，可能还有相当多的其他学科：

“自己消失的东西，可以自己回来。”

它可能是任何形式的工程中最真实和最重要的谚语之一。如果你没有亲眼看到虫子死去，你应该总是为此感到焦虑。它应该深深地困扰你。该错误可能仍然存在，等待您的下一个里程碑之夜再次抬头。

Luchian Grigore 就找到内存断点的真正问题给出了很好的建议。

# asp.net-mvc - 找不到资源

> ID：14863161
> 
> 赞同：0
> 
> 时间：2013-02-13T21:08:14.833
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我在 ASP.NET MVC3 中创建一个网站。我的问题是，当引用的文件似乎位于正确的位置时，我收到“找不到资源”错误。

这是确切的错误消息：

```
Server Error in '/' Application.
The resource cannot be found. 
Description: HTTP 404\. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable.  Please review the following URL and make sure that it is spelled correctly. 
Requested URL: /Views/Product/Index.cshtml 
```

问题是，/Views/Product 中有一个 Index.cshtml。

这是我的 Global.asax 的摘录：

```
 routes.MapRoute(
            "Default", // Route name
            "{controller}/{action}/{id}", // URL with parameters
            new { controller = "Product", action = "Index", id = UrlParameter.Optional } // Parameter defaults
        ); 
```

解决方案：问题是我通过右键单击并选择“设置为起始页”将 Index.cshtml 设置为“起始页”。根据 nemesv 的建议手动输入 URL 并看到一切正常后，我进入项目设置并将 Web-> 开始操作更改为“当前页面”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:20:31.580

You requested for `/Views/Product/Index.cshtml`, which is wrong. You must create a `ProductController` class with an `Index` method:

```
public class ProductController : Controller
{
    public void Index()
    {
        return View();
    }
} 
```

and then request for `localhost:yourport/` to get the index for product controller as you defined it in your routes (or just `/Product/Index`).

# vb.net - 在 Visual Basic 2008 express 中增加字符串变量的最大大小

> ID：14863162
> 
> 赞同：0
> 
> 时间：2013-02-13T21:08:19.450
> 
> 标签：vb.net

我对 Visual Basic 2008 express 知之甚少（我相信不是 Visual Basic.NET 的当前标准）（我通常用 C/C++ 编写代码）但是我的老板给了我一个调试程序，程序的错误很简单将（字符串）输入的上限设置为 1,000,000 个字符，他们需要它超出此范围。

我该怎么做呢？起初我认为它就像将变量声明为更大的变量类型（即将 int 更改为 long）一样简单，但我不确定这是否会解决这个问题，因为它是字符串而不是十进制变量类型。

因此，如果 1,000,000 个字符恰好是在 Visual Basic 中输入字符串变量的实际限制（不是理论上的），是否有任何巧妙的方法来规避这种情况？

# php - 与远程共享 服务器上的 javascript 兼容的套接字？

> ID：14863167
> 
> 赞同：0
> 
> 时间：2013-02-13T21:08:34.063
> 
> 标签：php, javascript, sockets, websocket

基本上我想使用某种套接字（网络套接字或node.js？），但我对它们不太了解，我想在启用了javascript的html页面之间发送低延迟数据。

我在共享服务器上安装了 php，并且 socket_connect() 是一个包含的函数，所以我猜测 php_sockets.dll 已安装。我可能会使用它，但是 php 脚本位于远程服务器上，所以我不知道我是否能够运行它？

我应该使用安装在普通共享服务器上的其他语言吗？

编辑：我没有外壳访问权限..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:11:09.990

[http://www.flynsarmy.com/2012/02/php-websocket-chat-application-2-0/](http://www.flynsarmy.com/2012/02/php-websocket-chat-application-2-0/)这应该给你一个很好的开始使用html5的websocket api与php交谈。你不需要 Node.js 来实现它。

# android - Android - 从扩展文件播放 MP4 视频文件

> ID：14863169
> 
> 赞同：3
> 
> 时间：2013-02-13T21:08:41.510
> 
> 标签：android

我已按照所有步骤为我的应用程序测试扩展文件。我现在陷入困境的是如何播放该扩展文件中包含的视频文件。

我已经成功地从 Google Play 下载了它，当我浏览我的文件管理器时，我可以在它应该在的文件夹中看到它。

过去几天我一直在寻找如何播放该文件。目前只有一个用于，以保持适当的大小进行测试。

我试图解析 URI 并将其设置在 videoview 中，但是，它总是显示无法播放视频。

到目前为止，我还尝试过这段代码来访问它（如文档中所述，我已经用我的参数替换了参数）：

```
// Get a ZipResourceFile representing a merger of both the main and patch files
ZipResourceFile expansionFile = APKExpansionSupport.getAPKExpansionZipFile(appContext,
    mainVersion, patchVersion);

// Get an input stream for a known file inside the expansion file ZIPs
InputStream fileStream = expansionFile.getInputStream(pathToFileInsideZip); 
```

为了播放视频，我该如何处理输入流？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-14T10:48:17.103

### 提供者代码

```
public class EHZipUriProvider extends APEZProvider {

@Override
public String getAuthority() {
    // TODO Auto-generated method stub
    return "your.package.name.Utility.EHZipUriProvider";
} 
```

}

### 自定义视频播放器

```
public static final Uri CONTENT_URI = Uri
        .parse("content://your.package.name.Utility.EHZipUriProvider");

public static VideoView mview;

public static void playVideo(Context context, VideoView resource, String VIDEO_NAME) {
    position = 0;
    mview = resource;
    Uri video = Uri.parse((CONTENT_URI + "/" + VIDEO_NAME));
    mview.setVideoURI(video);
    mview.start();

    mview.setOnCompletionListener(new OnCompletionListener() {

        @Override
        public void onCompletion(MediaPlayer mp) {
            // TODO Auto-generated method stub
            mview = null;
        }
    });
} 
```

### 调用活动

```
VideoPlayer.playVideo(context, vv, "rulesofenglish.mp4"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-19T18:03:56.173

比如我的应用包名是：

> com.bluewindsolution.android.sampleapp

那么我的扩展文件应该是

> main.1.com.bluewindsolution.android.sampleapp.obb

详细来说，你可以在[这里](http://developer.android.com/google/play/expansion-files.html)关注：

> [main|patch].<扩展版本>.<包名>.obb

* * *

从扩展中，您可以通过三种方式获得它：

*通过 AssetFileDescriptor*

```
// This one works with an image file and a media file.
// Get a ZipResourceFile representing a specific expansion file
// mainContext, version number of your main expansion, version number of your patch
ZipResourceFile expansionFile = APKExpansionSupport.getAPKExpansionZipFile(this, 1, 0);
AssetFileDescriptor afd_img1 = expansionFile.getAssetFileDescriptor("your_path/your_file.jpg");
AssetFileDescriptor afd_mpbg = expansionFile.getAssetFileDescriptor("your_path/your_file.mp3");

// To set image
ImageView imageView1 = (ImageView)findViewById(R.id.iv1);
imageView1.setImageBitmap(BitmapFactory.decodeFileDescriptor(afd_iv1.getFileDescriptor()));

// To set sound
try {
    mpbg.setDataSource(afd_mpbg.getFileDescriptor(), afd_mpbg.getStartOffset(), afd_mpbg.getDeclaredLength());
    mpbg.prepareAsync();
    mpbg.start();
} catch (IllegalStateException e) {
    Log.w("Error=====", "Failed to prepare media player", e);
} 
```

* * *

通过输入流：

```
// This one works with an image file and a media file.
// Get a ZipResourceFile representing a specific expansion file

ZipResourceFile expansionFile = new ZipResourceFile(filePathToMyZip);

// Get an input stream for a known file inside the expansion file ZIPs

InputStream fileStream = expansionFile.getInputStream(pathToFileInsideZip); 
```

* * *

### 通过乌里

```
// This one can use in almost thing such as jpg, mp3, mp4, pdf, etc.

// You need to create a new class to override APEZProvider
public class ZipFileContentProvider extends APEZProvider {
    @Override
    public String getAuthority() {
        return "com.bluewindsolution.android.sampleapp";
    }
}

// You need to add <provider> in AndroidManifest.xml
<provider
 android:name="com.bluewindsolution.android.sampleapp.ZipFileContentProvider"
   android:authorities="com.bluewindsolution.android.sampleapp"
      android:exported="false"
      android:multiprocess="true"
    >
    <meta-data android:name="mainVersion"
              android:value="1"></meta-data>
</provider>

// After that, you can use it any time by this code:
String filename2 = "image/i_commu_a_1_1_1_1.jpg"; // suppose you store put your file in directory in .obb
String uriString2 = "content://com.bluewindsolution.android.sampleapp" +  File.separator + filename2;
Uri uri2 = Uri.parse(uriString2);
imageView2.setImageURI(uri2);

// Filename inside my expansion file
String filename = "video/v_do_1_1_1.mp4"; // Suppose you store put your file in directory in .obb
String uriString = "content://com.bw.sample_extension_download_main" +  File.separator + filename;
Uri uri = Uri.parse(uriString);

v1 = (VideoView)findViewById(R.id.videoView1);
v1.setVideoURI(uri);
v1.start(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-22T09:09:18.323

使用提供商（对我来说最好的解决方案）！我测试了它，它工作得很好。

请参阅*[Android：使用 APEZ 从 .obb 读取媒体文件](http://nullpointerexc.blogspot.fr/2014/05/android-read-media-file-from-obb-using.html)*。

# css - 防止 CSS 页脚滚动

> ID：14863170
> 
> 赞同：0
> 
> 时间：2013-02-13T21:08:43.957
> 
> 标签：css, footer

```
#bottom_fade {
            position: absolute;
            bottom: 0;
            width: 100%;
            background: url("bottom-fade.png");
            background-repeat:repeat-x;
            height: 400px;
            z-index: 2;
            }
        .categories {
            position: absolute;
            left: 50%;
            color:black;
            word-wrap: break-word;
            font-family: 15px 'Libre Baskerville', serif;
            margin-left: -200px;
            z-index: 1;
            }
        .categories td {
            width: 200px;
            } 
```

[您可能会在此处](http://saturnix.altervista.org/CV/index.html)看到上述代码的结果。尝试调整浏览器窗口的大小，以便您不得不滚动查看表格中的整个文本。

当您滚动时，您可能会看到它`#bottom_fade`不会停留在页面底部，而是会跟随您的滚动。我不希望这种情况发生：我怎么能说 bottom_fade 始终保持连接到浏览器窗口的底部，无论滚动条发生什么情况？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T21:10:37.530

改变

```
#bottom_fade {
        position: absolute;
} 
```

到

```
#bottom_fade {
        position: fixed;
}; 
```

它应该像一个魅力。

（顺便说一句，效果不错！）

# javascript - Function.apply 与 Function.prototype.apply

> ID：14863171
> 
> 赞同：6
> 
> 时间：2013-02-13T21:08:48.390
> 
> 标签：javascript, function, apply

我最近`console.log`通过调用查看了萤火虫的代码`console.log.toString()`并得到了这个：

```
function () { return Function.apply.call(x.log, x, arguments); } 
```

只要我理解这会导致`Function.apply`被调用，它的`this`引用`x.log`和参数是`x`and `arguments`。由于`Function.apply`它本身调用函数，这将导致`x.log`以它的`this`引用`x`和`arguments`作为它的参数被调用。

这引出了我的问题：是否有任何理由以`Function.apply`这种方式调用而不是仅使用`Function.prototype.apply`？或者换句话说，上面和之间有什么区别`return x.log.apply(x, arguments)`吗？

**编辑：**由于它是开源的，我快速查看了 firebug 源代码并找到了它的创建位置（[consoleInjector.js](https://github.com/firebug/firebug/blob/master/extension/content/firebug/console/consoleInjector.js)，第 73 行）：

```
// Construct a script string that defines a function. This function returns
// an object that wraps every 'console' method. This function will be evaluated
// in a window content sandbox and return a wrapper for the 'console' object.
// Note that this wrapper appends an additional frame that shouldn't be displayed
// to the user.
var expr = "(function(x) { return {\n";
for (var p in console)
{
    var func = console[p];
    if (typeof(func) == "function")
    {
        expr += p + ": function() { return Function.apply.call(x." + p +
            ", x, arguments); },\n";
    }
}
expr += "};})";

// Evaluate the function in the window sandbox/scope and execute. The return value
// is a wrapper for the 'console' object.
var sandbox = Cu.Sandbox(win);
var getConsoleWrapper = Cu.evalInSandbox(expr, sandbox);
win.wrappedJSObject.console = getConsoleWrapper(console); 
```

我现在几乎可以肯定这与`Function`处于不同的范围有关，这就是我在对**pst**的回答的第一条评论中所说的，但我仍然不完全理解它。我可能会对此做进一步的研究。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T21:14:06.077

考虑一下：

```
Function.hasOwnProperty("apply")             // false
Function.apply == Function.prototype.apply   // true
Function.__proto__ == Function.prototype     // true in FF which exposes proto 
```

所以 Function.apply 有效，因为 Function 的 [[prototype]] 是[Function.prototype](http://es5.github.com/#x15.3.4)。在这种情况下，两者都应该按需要工作。

但是，考虑到正常的[[GetProperty]](http://es5.github.com/#x8.12.2)规则仍然适用：

```
var f = function () {};
f.apply = "nubbits";
f.apply(/* err */); 
```

诚然，我认为它是“有问题的代码”来改变行为`apply`（尤其是以不兼容的方式），但这两种形式*可能*不同..就个人而言，我*不适应*这种假设情况，我`f.apply`在我的代码中使用.

# iphone - 使用 sharekit 2.0 将图像发布到照片后将图像上传到 Facebook 墙

> ID：14863175
> 
> 赞同：1
> 
> 时间：2013-02-13T21:09:00.413
> 
> 标签：iphone, ios, objective-c, sharekit

我正在尝试使用 sharekit 将图像发布到 facebook 照片：

```
SHKItem *item = [SHKItem image:image_ title:@""];
[SHKFacebook shareItem:item]; 
```

一切正常，但通常当您使用 Facebook 网站发布照片时，Faceook 的墙上也会发布信息。当我使用 sharekit 发布我的照片时，它不会发生。我怎样才能做到这一点？

# php - 在codeigniter中上传图片，需要用户文件吗？

> ID：14863179
> 
> 赞同：0
> 
> 时间：2013-02-13T21:09:05.803
> 
> 标签：php, html, codeigniter, file-upload

我正在使用下面的功能将我的图像文件上传到我的服务器（本地主机）。很好，正在上传图片。但是我需要两个图像字段，因此一旦单击提交按钮，两个图像都应该上传。我使用了此处描述的**[Codeigniter multiple file upload](https://stackoverflow.com/questions/9276756/codeigniter-multiple-file-upload)**的功能，但它不起作用。

我收到此错误消息

```
A PHP Error was encountered

Severity: Warning

Message: is_uploaded_file() expects parameter 1 to be string, array given

Filename: libraries/Upload.php

Line Number: 161 
```

好吧，我不明白错误在哪里。我用来上传单张图片的功能是

```
function do_upload()
    {
        $config['upload_path'] = './uploads/';
        $config['allowed_types'] = 'jpeg|png|gif';
        $config['max_size'] = '0';
        $config['max_width']  = '0';
        $config['max_height']  = '0';

        $this->load->library('upload', $config);

        if ( ! $this->upload->do_upload())
        {
            $error = array('error' => $this->upload->display_errors());
           //failed display the errors
        }
        else
        {
            //success

        }
    } 
```

另外我还想问我可以更改我选择的输入字段名称吗？即我总是需要执行`<input type="file" name="userfile"/>`。是否可以更改名称？我尝试更改它并收到消息**No file was selected**，所以这一定意味着我无法更改它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T21:15:50.917

您必须循环浏览上传的文件，就像您提供的链接中显示的那样。

```
function do_upload() {
        $config['upload_path'] = './uploads/';
        $config['allowed_types'] = 'jpeg|png|gif';
        $config['max_size'] = '0';
        $config['max_width']  = '0';
        $config['max_height']  = '0';

        $this->load->library('upload', $config);

        foreach ($_FILES as $key => $value) {

            if (!empty($value['tmp_name'])) {

                if ( ! $this->upload->do_upload($key)) {
                    $error = array('error' => $this->upload->display_errors());
                    //failed display the errors
                } else {
                    //success
                }

            }
        }
} 
```

并尝试使用这样的 HTML：

```
<input type="file" name="file1" id="file_1" />
<input type="file" name="file2" id="file_2" />
<input type="file" name="file3" id="file_3" /> 
```

您可以根据需要更改输入字段的名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-29T17:06:24.473

如果您正在使用文件多选，请执行以下操作：

HTML（带有数组名称的 HTML5 文件输入允许选择多个文件）：

```
<input type="file" name="userfile[]"/> 
```

或者

```
<input type="file" name="userfile[]"/>
<input type="file" name="userfile[]"/> 
```

CodeIgniter 中的 PHP：

```
// load upload library (put your own settings there)
$this->load->library('upload', array('allowed_types' => 'svg|gif|jpg|png', 'upload_path' => $GLOBALS['config']['upload_path'], ));

// normalise files array
$input_name = 'userfile'; // change it when needed to match your html
$field_names = array('name', 'type', 'tmp_name', 'error', 'size', );
$keys = array();
foreach($field_names as $field_name){
    if (isset($_FILES[$input_name][$field_name])) foreach($_FILES[$input_name][$field_name] as $key => $value){
        $_FILES[$input_name.'_'.$key][$field_name] = $value;
        $keys[$key] = $key;
    }
}
unset($_FILES[$input_name]); // just in case

foreach ($keys as $key){

    $new_file = $this->upload->do_upload($input_name.'_'.$key);

    // do your stuff with each uploaded file here, delete for example:
    $upload_data = $this->upload->data();
    unlink($upload_data['file_name']);

} 
```

# ios - iOS：核心数据 - 我需要保存更改吗？

> ID：14863181
> 
> 赞同：2
> 
> 时间：2013-02-13T21:09:13.567
> 
> 标签：ios, core-data

我的服务器上有自己的“iCloud”系统，所有数据都存储在数据库中。用户 ping 此服务器并获取新的/更新的数据并将其存储在核心数据中。

但是我在提交到服务器后将一些数据临时存储在 Core Data 中（这样用户就不必等到下一次 ping 到服务器）。服务器在下次 ping 时更新核心数据中的这些数据。

我已经`[context save:&error];`为所有临时更新/插入删除了所有这些并且似乎工作正常，但我仍然想知道我是否会遇到某种麻烦而不保存到核心数据？

并且：从服务器检索数据时，我应该在每次插入时保存内容，还是在从 xml 插入记录时将它们全部保存？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:29:44.543

1）如果您不想丢失数据，则必须保存。查看[文档](http://developer.apple.com/library/ios/#documentation/cocoa/Conceptual/CoreData/Articles/cdBasics.html#//apple_ref/doc/uid/TP40001650-TP1)以了解 Core Data 的工作原理以及`NSManagedObjectContext`在那里扮演的角色 - 以及为什么需要保存。

2）您不需要保存每个插入。从服务器检索数据的过程完成后，只需保存上下文即可。

# ruby - 在 ruby 文件中执行方法

> ID：14863182
> 
> 赞同：0
> 
> 时间：2013-02-13T21:09:17.557
> 
> 标签：ruby

我有这个虚拟的 ruby​​ 类文件（`Bar.rb`）：

```
class Bar

   foo() # execute foo()

  def foo()
      puts "Hello world, "
  end
end 
```

我使用以下命令运行文件：

```
$ ruby Bar.rb 
```

我期待在命令中看到“Hello, world”，但收到了这个错误：

```
undefined local variable or method `foo' for Bar:Class (NameError)
    from bar.rb:3:in `<main>' 
```

那么如何执行一个方法呢？Ruby 是否有任何`main`方法（如在 Java 或 C/C++ 中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:12:26.677

首先定义方法，然后调用它。不需要主程序，类或方法之外的第一个代码将首先执行。脚本本身是主要的。我相信对此有更好的定义，但我相信你会理解的。

```
def foo()
  puts "Hello world, "
end

foo() # execute 
```

也不需要把这个放在课堂上，然后你必须先启动她。

```
class Bar
  def foo()
      puts "Hello world, "
  end
end

bar = Bar.new
bar.foo 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:13:03.253

您不需要任何类，您可以直接从文件本身调用您喜欢的任何方法：

bar.rb:

```
puts "Hello, world!" 
```

如果你想坚持你的代码，你`foo`在它的声明之前调用，这显然是行不通的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T21:19:17.310

正如你所写的那样，这有几个原因不起作用。

1.  方法 foo 在您尝试调用它之前尚未声明。
2.  正如您所声明的，方法 foo 是一个实例方法。您不是在类的实例上调用它。

这会起作用：

```
class Bar
  def self.foo
  end

  foo
end 
```

但是，正如其他人所说，您可能不需要将其包装在一个类中。

# ruby-on-rails - 为 Rails 应用程序创建上传控制器操作

> ID：14863185
> 
> 赞同：0
> 
> 时间：2013-02-13T21:09:23.707
> 
> 标签：ruby-on-rails, file-upload, rails-routing

我正在制作一个 Rails 应用程序，并希望添加一个上传功能，允许用户通过 Excel 电子表格一次上传多个条目，而不是一次输入一个条目。

理想情况下，我希望在 new.html.erb 文件的底部添加一个单独的上传/提交部分（粗体部分是上传 HTML.erb）：

```
...
<div class="actions">
    <%= f.submit %>
</div>
<% end %>

**<div class="field">
    Or Upload Multiple Entries <br />        
    <%= form_tag({:action => :upload}, :multipart => true) do %>
        <%= file_field_tag 'multi_doc' %>        
    <% end %>
</div>** 
```

这是我的 routes.rb 文件：

```
Dataway::Application.routes.draw do
    devise_for :users

    resources :revenue_models do
      get 'upload', :on => :collection         
    end

    root :to => "home#index"
end 
```

而我的收入模型控制器（还没有开发动作，现在只是一个重定向）：

```
...
def upload
    redirect_to revenue_models_path
end 
```

我遵循了[上传文件](http://guides.rubyonrails.org/form_helpers.html#uploading-files)和[路由文件](http://guides.rubyonrails.org/routing.html#adding-more-restful-actions)的 rails 指南，当我尝试打开已修改的 /new 视图时，我不断收到错误消息：

```
 Routing Error
        No route matches {:action=>"upload", :controller=>"revenue_models"}
    Try running rake routes 
```

当我运行 rake route 时，我得到一个上传操作的条目：

```
upload_revenue_models GET    /revenue_models/upload(.:format)   revenue_models#upload 
```

最后，我想做的是上传一个包含多个条目的excel文件，解析它，并有条件地将每个数据行添加到我的数据库中，我的印象是我可以在上传操作中指定。请帮忙！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:51:06.023

请`form_for`改用`form_tag`.

二 什么是`multi_doc`a`field/attribute`的`revenue_model`？。我猜是一个 `field/attribute`。`revenue_model`

第三，表单中的实例变量`revenue_model`在哪里？

第四，您必须首先在显示表单的操作/控制器上创建模型的实例变量，例如`@revenue_model = RevenueModel.new`.

尝试此代码后：

```
<%= form_for(@revenue_model, :method => :get, :html => {:multipart => true}, :url => { :controller => "revenue_models", :action => "upload"})) do |f| %>
 <%= f.file_field :multi_doc %>
 <%= f.submit :id => "any_id" %>
<% end %> 
```

这个问题非常令人困惑，试图澄清您的问题，指定您的操作名称和视图中的文件名称。

问候！

# javascript - 沿椭圆移动一个点

> ID：14863188
> 
> 赞同：4
> 
> 时间：2013-02-13T21:09:30.870
> 
> 标签：javascript, math, drawing, ellipse

我在画布上创建了一个椭圆，现在我需要从原点绘制三条线。例如，假设第一条线是 90 度（垂直），所以点是 (0, 10)。我需要另外两条线在两个方向上都离点 x 像素。

我敢肯定我描述得不够好，但基本上我想做的是从已知椭圆上的一个点，找到另一个位于椭圆上的点 x 距离。

我曾尝试寻找椭圆弧，但似乎没有什么适合我正在寻找的东西。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-13T21:18:23.427

对于椭圆：

```
x = a cos(t)
y = b sin(t) 
```

所以：

```
x/a= cos(t)
t = acos(x/a)
y = b sin(acos(x/a)) 
```

插入你的, 和的值`a`，你得到.`b``x``y`

见[https://www.mathopenref.com/coordparamellipse.html](https://www.mathopenref.com/coordparamellipse.html)

比较粗暴：

```
var a=120;
var b=70;

var c=document.getElementById("myCanvas");
var cxt=c.getContext("2d");

var xCentre=c.width / 2;
var yCentre=c.height / 2;

// draw axes
cxt.strokeStyle='blue';
cxt.beginPath();
cxt.moveTo(0, yCentre);
cxt.lineTo(xCentre*2, yCentre);
cxt.stroke();

cxt.beginPath();
cxt.moveTo(xCentre, 0);
cxt.lineTo(xCentre, yCentre*2);
cxt.stroke();

// draw ellipse
cxt.strokeStyle='black';

cxt.beginPath();

for (var i = 0 * Math.PI; i < 2 * Math.PI; i += 0.01 ) {
    xPos = xCentre - (a * Math.cos(i));
    yPos = yCentre + (b * Math.sin(i));

    if (i == 0) {
        cxt.moveTo(xPos, yPos);
    } else {
        cxt.lineTo(xPos, yPos);
    }
}
cxt.lineWidth = 2;
cxt.strokeStyle = "#232323";
cxt.stroke();
cxt.closePath();

// draw lines with x=+/- 40
var deltaX=40;

var y1=b*Math.sin(Math.acos(deltaX/a));

cxt.strokeStyle='red';
cxt.beginPath();
cxt.moveTo(xCentre+deltaX, yCentre-y1);
cxt.lineTo(xCentre, yCentre);
cxt.lineTo(xCentre-deltaX, yCentre-y1);
cxt.stroke();
```

```
<html>
<head><title>Ellipse</title></head>
<body>
    <canvas id="myCanvas" style="position: absolute;" width="400" height="200"></canvas>
</body>
</html>
```

（使用[https://www.scienceprimer.com/draw-oval-html5-canvas](https://www.scienceprimer.com/draw-oval-html5-canvas)作为基础，因为我以前从未使用过 HTML 画布。）

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-13T22:37:48.407

安德鲁莫顿的答案是足够的，但你可以用一个平方根而不是 a`sin`和 an `acos`。

假设您有一个以原点为中心的椭圆，其半径沿 a 的 X 轴，*半径*沿*b*的 Y 轴。这个椭圆的方程是

> *x* ² / *a* ² + *y* ² / *b* ² = 1。

为*y*解决这个问题

> *y* = ± *b* sqrt(1 - *x* ² / *a* ² )

您可以选择合适的符号。根据您的帖子，您需要正平方根。

翻译成 Javascript：

```
function yForEllipse(a, b, x) {
    return b * Math.sqrt(1 - x*x / a * a);
} 
```

# php - 成功的ajax函数后其他jquery函数不起作用

> ID：14863190
> 
> 赞同：0
> 
> 时间：2013-02-13T21:09:32.287
> 
> 标签：php, jquery, ajax, jquery-selectors

**编辑**

JQUERY-AJAX 请求代码：

```
<script type="text/javascript">
$(document).ready(function(){
$(".form").submit( function(e) {
    e.preventDefault();
    var form = $(this);
    var div_add_comment = $(form).parent();
    var div_comments = $(div_add_comment).parent();
    $.ajax({
        type: "POST",
        data: $(form).serialize(),
        url: "includes/comment.php",
        success: function(msg){
            $(div_comments).html(msg);
        }
    });
    return false;
});
});
</script> 
```

JQUERY 显示全部 - 折叠评论代码

```
<script type="text/javascript">
$(document).ready(function(){
$('.see_all').click(function(){
    var thisItem = $(this);
    thisItem.parent().find('#comment2').slideDown('fast');
    thisItem.parent().find('.collapse').css('display','inline-block');
    thisItem.css('display','none');
    return false;
}); 

$('.collapse').click(function(){
     var thisItem = $(this);
     thisItem.parent().find('#comment2').slideUp('fast');
     thisItem.css('display','none');
     thisItem.parent().find('.see_all').css('display','inline-block');
     return false;
})
})
</script> 
```

JQUERY删除焦点上的默认值文本 - TEXTAREA

```
<script type="text/javascript">
$(document).ready(function(){
var Input = $('textarea[name=comment]');
var default_value = Input.val();

$(Input).focus(function() {
    if($(this).val() == default_value)
    {
         $(this).val("");
    }
}).blur(function(){
    if($(this).val().length == 0)
    {
        $(this).val(default_value);
    }
});
})
</script> 
```

如果您需要其他任何东西，请告诉我，我有最宝贵的时间在这些帖子中复制代码并对其进行格式化。

**结束编辑**

我有一个奇怪的小问题。我创建了一个 jquery-ajax 函数来从我的页面的评论部分传输数据。该页面在每个用户帖子下都有一个此表单的实例。所以这个页面会有 X 个帖子，每个帖子有 X 个评论，就像一个社交网络。我的 ajax 请求完美地发送、接收和显示数据但是我还有另外两个调用内部元素的 jquery 函数，这些函数在 ajax 函数返回 html 后不再起作用。ajax 函数未处理的所有其他函数仍然有效。我已经检查并重新检查了来自 ajax 函数的响应 html，它与标准 post-comment 实例的 html 相同。

如果您有任何疑问，请告诉我您想看什么。

谢谢，您的帮助总是值得赞赏的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:13:48.510

确保以元素不必存在的方式绑定 jQuery 函数。

```
$('ul').on('click', 'li', function(){ /* do something */ }); 
```

这将在函数绑定后添加的 LI 上执行。

在您的情况下，您希望绑定到评论部分的父级并定位具有点击行为的元素。

```
$('.comments')
    .on('click', '.see_all', function(){...})
    .on('click', '.collapse', function(){...})
    .on('focus', 'textarea[name=comment]', function(){...})
    .on('blur', 'textarea[name=comment]', function(){...}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:44:35.473

尝试从表单中删除 $()。

你有这个：

```
var form = $(this);
    var div_add_comment = $(form).parent();
    var div_comments = $(div_add_comment).parent(); 
```

应该是这样的：

```
var form = $(this),
    div_add_comment = form.parent(),
    div_comments = $(div_add_comment).parent(); 
```

既然你声明*了 var form = $(this);* 你不需要包装表单......你现在拥有它的方式相当于*$((form))*

不确定这是否会解决您的问题，但 jQuery 可能会挂断此问题，因为您正在从 $(this) 生成子项。

# git - SVN 到 Git 的转换与重命名的主干

> ID：14863192
> 
> 赞同：4
> 
> 时间：2013-02-13T21:09:39.463
> 
> 标签：git, svn, git-svn

我有一个多项目 SVN 存储库，我正在尝试将其转换为多个 Git 存储库，每个项目一个。

我可以用 git-svn 处理的那部分，我已经找到了多个 HOWTO 类型的文档，但是我遇到麻烦的是，当前项目之一是通过在 SVN 中多次重命名和合并不同项目的部分而创建的。在 SVN 中，我可以通过重命名/移动查看单个文件的历史记录，但是当我使用 git-svn 并指定项目主干目录的当前位置时，它只会将历史记录转换到布局更改的位置，我当主干从不同的路径移动时，丢失所有旧的历史。

具体来说，我的存储库的布局曾经看起来像这样：

```
/projectA/trunk/src/com/mycompany/projectA/MyClass.java
/projectB/trunk/src/com/mycompany/projectB/OtherClass.java 
```

这被转换为：

```
/trunk/projectA/src/com/mycompany/projectA/MyClass.java
/trunk/projectB/src/com/mycompany/projectB/OtherClass.java 
```

然后它被重命名并将 src 目录合并到一个公共主干上：

```
/combined-project/trunk/src/com/mycomany/projectA/MyClass.java
/combined-project/trunk/src/com/mycomany/projectB/OtherClass.java 
```

所以如果我运行：

```
git svn clone --trunk=/combined-project/trunk 
```

然后我得到一个 git 存储库，其历史只能追溯到最近的重命名。有人对我如何让 git svn clone 通过重命名跟随主干有任何建议吗？

# text - 在 C 中编码文本

> ID：14863197
> 
> 赞同：1
> 
> 时间：2013-02-13T21:09:59.590
> 
> 标签：text, ascii, bit-manipulation, encode

我的程序从标准输入中读取几个字符串。我想这样编码：A 打印 00 在哪里，B 打印 01 在哪里。这是我的代码。我不知道我错在哪里。谢谢！

```
 #include<stdio.h>
    #include<conio.h>
    #include<string.h>
    int main(void)
   {
    char text[100];

    printf("enter  text:");
    fgets(text,100,stdin);
    int i,j;
    unsigned int aux;
    char a[100];
    char b[100];
    for(i=0;i<100;i++)
    for(j=0;j<100;j++)
    {
                      if(text[i]=='a'){
                      aux=aux|0;
                      aux=aux<<2;
                      a[j-1]=aux;
                      a[j]='\0';
                      }
                     if(text[i]=='b'){
                     aux=aux|1;
                     aux=aux<<2;
                     b[j-1]=aux;
                     b[j]='\0';
                     }
                     strcat(a,b)
                      }
                      printf("%s", a[j]);
                getch();      
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:15:45.737

`printf ("%02d\n", toupper(text[i]) - 'A');`

或者

```
for (i = 0; i < strlen (text); i++)
    sprintf (&a[i*3], "%02d ", toupper(text[i]) - 'A'); 
```

请注意，这仅适用于纯文本字符串

# android - 使用 LIKE 运算符的 Android 不区分大小写的游标查询（适用于所有语言环境）

> ID：14863198
> 
> 赞同：8
> 
> 时间：2013-02-13T21:09:59.547
> 
> 标签：android, sqlite, android-sqlite

我正在尝试进行过滤查询：

```
public Cursor runQuery(CharSequence constraint) {
        return getActivity().getContentResolver().query(
                Phone.CONTENT_URI,
                new String[] {Phone.DISPLAY_NAME, Phone.NUMBER, Phone.TYPE, Phone._ID },
                Phone.DISPLAY_NAME + " LIKE '" + constraint + "%'",// <-- problem here
                null, 
                Phone.DISPLAY_NAME);
    } 
```

但是 LIKE 运算符以区分大小写的方式用于非 ascii 字符（如 SQLite 文档所述）。有没有办法让 LIKE 不区分大小写？（ps我测试俄罗斯符号）

**不起作用**的事情：

*   整理 NOCASE（UNICODE，本地化）
*   上（），下（）

需要帮助或建议。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-19T09:42:08.570

## 更新：我在这种情况下的解决方案

我还没有解决不区分大小写的 LIKE 问题，但我找到了适合我的具体情况的解决方案，而且效果比我预期的还要好 :) 可能对你有用。因此，要按**名称过滤带有电话的联系人，请**使用 Phone.CONTENT_FILTER_URI

```
@Override
public Cursor runQuery(CharSequence constraint) {
    return mContext.getContentResolver().query(
            Uri.withAppendedPath(Phone.CONTENT_FILTER_URI, Uri.encode(constraint.toString())),
            //PROJECTION
            new String[] {
                    Phone._ID, 
                    Phone.DISPLAY_NAME,
                    Phone.NUMBER,
                    Phone.TYPE,
                    Phone.PHOTO_ID},
            //WHERE
            ContactsContract.Contacts.HAS_PHONE_NUMBER + " = 1", 
            null,
            //ORDER BY
            null);
} 
```

此提供程序执行不区分大小写的高级过滤，如果约束为数字，还按电话号码过滤:)

# javascript - 单击多边形时无法弹出信息气泡

> ID：14863201
> 
> 赞同：1
> 
> 时间：2013-02-13T21:10:04.767
> 
> 标签：javascript, html, google-maps, google-maps-api-3

多边形显示正常，我在 chrome 中调试时没有看到任何错误。在 c# 代码中查询多边形的数据点，但与此问题无关。当我单击多边形时，js 代码似乎会触发，但我没有得到任何信息气泡。接下来，我将向信息气泡中添加有关多边形的信息，但首先需要先让它弹出。任何帮助，将不胜感激！

```
var map = new google.maps.Map(document.getElementById('map'), {
                    zoom: 5,
                    center: new google.maps.LatLng(30.2979536, -97.7470835),
                    mapTypeId: google.maps.MapTypeId.ROADMAP
             });

    <%for(int i = 0; i < this.zips2.Count; ++i )%>
    <%{ %>
        <%if ( layerType == "Orders" )
        { 
            GetOrderColor(zips3[i]); 
        } 
        else 
        { 
            GetAptColor(zips3[i]);  
        } %>

        var paths = [<%=zips2[i]%>];
            var color = "<%=color%>";

            var shape = new google.maps.Polygon({
            paths: paths,
            strokeColor: color,
            strokeOpacity: 0.8,
            strokeWeight: 2,
            fillColor: color,
            fillOpacity: 0.35,
            clickable: true
            });

            shape.setMap(map);

            google.maps.event.addListener(shape, 'rightclick', function(event) {

            var contentString = '<div id="content:">' + "Test" + '</div>';
             infowindow1 = new google.maps.InfoWindow();
             infowindow1.setContent(contentString);
             infowindow1.open(map, this);

            });

      <%} %> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T22:00:59.940

在多边形上打开 infoWindow 的关键是理解它与在标记 ( [google.maps.InfoWindow](https://developers.google.com/maps/documentation/javascript/reference#InfoWindow) ) 上打开 infoWindow 不同：

你的代码：

```
google.maps.event.addListener(shape, 'rightclick', function(event) {
   var contentString = '<div id="content:">' + "Test" + '</div>';
   infowindow1 = new google.maps.InfoWindow();
   infowindow1.setContent(contentString);
   infowindow1.open(map, this);  // <--- what is "this"? 
}); 
```

您的代码中的“this”是什么？是导出位置的 MVC 对象吗？[google.maps.Polygon](https://developers.google.com/maps/documentation/javascript/reference#Polygon)没有。

我来自[该示例](https://stackoverflow.com/questions/13020757/how-do-i-open-different-information-for-each-polygon-ive-created-google-maps-a)的代码：

```
google.maps.event.addListener(poly,'click', function(event) {
  infowindow.setContent(contentString);
  infowindow.setPosition(event.latLng);
  infowindow.open(map);
}); 
```

# c++ - Linux：检查进程是否对 C/C++ 中的文件具有读取权限

> ID：14863203
> 
> 赞同：2
> 
> 时间：2013-02-13T21:10:16.427
> 
> 标签：c++, c, linux, pid

假设我们有一些 PID 和绝对文件路径 [不是符号链接，只是一个常规文件] - 确定 PID 对该文件具有读取权限的最有效方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:17:49.200

我只知道一种方法可以做到这一点。首先，通过构造路径`/proc/`+PID，找到进程的UID和GID。例如`/proc/4261`. 然后您 stat() 该路径并获取其 UID 和 GID。然后，您 stat() 您要检查读取访问权限的文件并检查进程的 UID/GID 是否具有读取权限：

（假设您已经在 中构建了“/proc/[PID]”路径`path_to_proc`。）

```
struct stat buf;

// Get UID and GID of the process.
stat(path_to_proc, &buf);
uid_t proc_uid = buf.st_uid;
gid_t proc_gid = buf.st_gid;

// Get UID and GID of the file.
stat(path_to_file_you_want_to_check, &buf);

// If the process owns the file, check if it has read access.
if (proc_uid == buf.st_uid && buf.st_mode & S_IRUSR) {
    // Yes, the process has read access.
}

// Check if the group of the process's UID matches the file's group
// and if so, check for read/write access.
else if (proc_gid == buf.st_gid && buf.st_mode & S_IRGRP) {
    // Yes, the process has read access.
}

// The process's UID is neither the owner of the file nor does its GID
// match the file's.  Check whether the file is world readable.
else if (buf.st_mode & S_IROTH) {
    // Yes, the process has read access.
} 
```

请注意，代码并不完美。它不处理进程的用户实际上属于文件组而不是用户的主要组的可能性。为了解决这个问题，您需要使用 getgrouplist() （这意味着您需要先将进程 UID 转换为包含实际用户名的字符串，然后将所有返回的组与文件的组进行比较，如果匹配，检查组读取访问权限 (S_IRGRP)。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:42:54.763

打开文件。这真的是唯一知道的方法。涉及的答案`stat(2)`要求您编写代码来解释权限位并将它们与您的活动 uid/gid 和补充组进行比较。无论如何，它在一般情况下是不完整的：像 selinux 或 apparmor 这样的 LSM 钩子也可以在传统 Unix 权限模型未捕获的文件上实现权限模型。

# matlab - 从图例中移除特定对象

> ID：14863204
> 
> 赞同：0
> 
> 时间：2013-02-13T21:10:21.900
> 
> 标签：matlab, get, annotations, bar-chart, legend

我需要你们的帮助来解决我面临的一个小问题。当我想用bar函数描绘f1和f2时，我需要在图中的图例选项卡中排除f2注释对象，但是下面写的set语法似乎给出了提到的错误。

代码如下：

```
f1= bar([SN, SN, SN], [Class_Work, Final_Exam, Shift_Grade'-Grade], K, 'stacked');

f2= bar([SN(idx), SN(idx), SN(idx)], [Class_Work(idx), Final_Exam(idx), SG(idx)-Grade(idx)], K*dy/dx, 'stacked', 'LineWidth', 2.5);  

set(f1,{'DisplayName'},{'Mid-Term','Final-Exam','Shift'}')
legend('location','NorthEast','Orientation','horizontal'); 

% in order to Exclude f2 indices from legend: (BUT SEEMS NOT WORKING based on error!)
set(get(get(f2,'Annotation'),'LegendInformation'),...
    'IconDisplayStyle','off'); 
```

运行后，它会在命令窗口中出现此错误，包括正确的图形，但包含所有注释对象：

？？？使用 ==> 获取错误

*无法从单元格转换为双精度。*

==> set(get(get(f2,'Annotation'),'LegendInformation'),... 中的错误

**我需要的图是：在绘制 f2 时，图例选项卡中的*data4、data5 和 data6*图形对象（与 f2 相关）不会出现。**

我提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T09:17:17.653

有一种特殊的语法可以调用 legend 对您的情况有所帮助。来自 Matlab 文档：

```
 legend(h, 'string1', 'string2', ...); 
```

> 在绘图上显示一个图例，其中包含由向量 h 中的句柄标识的对象，并使用指定的字符串来标记相应的图形对象（线、条形系列等）。

所以，在你的情况下，你应该这样做：

```
 legend(f1, 'Mid-Term', 'Final-Exam', 'Shift'); 
```

然后相应地修改图例的其他属性（位置、方向等）。

**更新：**

或者，要使您的初始代码正常工作，您应该执行以下操作：

```
 annots = get(h,'Annotation');
 for i=1:length(annots)
     set(get(annots{i},'LegendInformation'),'IconDisplayStyle','off');
 end 
```

`annots = get(h,'Annotation')`返回单元格数组，然后您只需`annots{i}`对该数组的每个单元格（即）进行操作。

# ant - 如果命令行中有两个目标，则从属目标执行两次

> ID：14863205
> 
> 赞同：1
> 
> 时间：2013-02-13T21:10:25.797
> 
> 标签：ant

我有一个 Ant 构建文件，其依赖项如下：

```
<target name="resolve">
  ....
</target>

<target name="compile" depends="resolve">
  ....
</target>

<target name="ship" depends="compile">
  ....
</target> 
```

当仅使用 调用 ship 目标时`ant ship`，仅需要的目标以正确的顺序执行：`[resolve>compile>ship]`.

问题是在命令行上直接调用两个目标时。通过执行`ant compile ship`，输出为`[resolve > compile > resolve > compile > ship]`. 我无法理解选择两次执行某些依赖项的逻辑。

如何强制 Ant 从不执行目标两次？使用非常复杂的构建文件，我不能总是使用单个目标运行预期的命令。

# android - android findViewById 获取 null 而不是具体实例

> ID：14863217
> 
> 赞同：0
> 
> 时间：2013-02-13T21:10:49.917
> 
> 标签：android, callback, null, widget

我有问题。由于我是开发 Android 应用程序的新手，我想我没有正确理解所有概念。

问题是：
在我的对话框中，输入所有信息并按下“确定”按钮后，我想得到我刚刚输入的内容`TextEdit`。但是当我试图`EditText`通过我得到`okButton.onClickListener`而不是实例时。`findViewById(R.id.myTextEditId)``Null`

这是一些代码：

对话框的 XML（我定义 EditText 的部分）：

```
 <EditText
    android:id="@+id/editText1"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_marginTop="16dp"
        android:layout_marginLeft="4dp"
        android:layout_marginRight="4dp"
        android:layout_marginBottom="4dp"
    android:inputType="textMultiLine"
    android:maxLines="3"
    android:hint="@string/add_new_note_hint">

    <requestFocus />
</EditText> 
```

这是 NPE 所引用的代码：

```
AlertDialog.Builder dialogBuilder = new AlertDialog.Builder(this);
View dialogView = getLayoutInflater().inflate(R.layout.add_note_dialog,null);

dialogBuilder.setTitle(R.string.add_dialog_title)
.setPositiveButton(R.string.add_dialog_pos_but, new DialogInterface.OnClickListener() {

    @Override
    public void onClick(DialogInterface dialog, int which) {
        EditText et = (EditText) findViewById(R.id.editText1); //this is where I get null instead of real instance.
    }
    }) 
```

为什么我会得到这个以及在某些回调方法中处理小部件数据的正确方法（最佳实践）是什么？（怎么修）

非常感谢您在我的问题上花时间！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:14:29.117

dialogView.findViewById 将解决这个问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:16:48.203

问题是`findViewById`搜索当前视图层次结构。如果您从您`Activity`的 .

```
EditText et = (EditText) dialogView.findViewById(R.id.editText1); 
```

你可能也需要制作`dialogView` `final`。

# mysql - 内连接不起作用

> ID：14863219
> 
> 赞同：0
> 
> 时间：2013-02-13T21:10:55.797
> 
> 标签：mysql

经过长时间的工作，我在这里要问我的问题，它很简单，但我不知道为什么它不起作用，请帮忙！！！

我有一张桌子

**phpfox_friend** （我有以下列）

*   朋友ID
*   用户身份
*   朋友用户ID
*   订购

**phpfox_user**（我有下面的列）

*   usre_id
*   用户名
*   status_id
*   全名

我正在尝试通过使用下面提到的 Sql 查询来内部加入它，但它给了我一个错误

> `#`1054 - 'on 子句'中的未知列'phpfox_friend.user_id'

**询问**

```
SELECT * 
FROM `phpfox_friend` 
INNER JOIN `phpfox_user` 
  ON `phpfox_friend.user_id`=`phpfox_user.user_id` 
WHERE phpfox_user.user_name IS NOT NULL 
```

请指导我做错了什么

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:12:53.957

试试这个：

```
SELECT * FROM `phpfox_friend` 
INNER JOIN `phpfox_user` ON 
`phpfox_friend`.`user_id`=`phpfox_user`.`user_id` 
WHERE `phpfox_user`.`user_name` IS NOT NULL 
```

您需要将引号添加到表和字段中。

所以用

```
`phpfox_friend`.`user_id` instead of `phpfox_friend.user_id` 
```

# android - 安卓 4.2.2 不兼容

> ID：14863220
> 
> 赞同：2
> 
> 时间：2013-02-13T21:10:57.457
> 
> 标签：android, android-4.2-jelly-bean

我收到来自我的应用程序的 Android 4.2.2 用户的电子邮件，说 Play 商店显示一条消息，指出我的应用程序不再与他们的设备兼容。这就是我的表现方式：

```
<uses-sdk android:minSdkVersion="5" android:targetSdkVersion="17"/> 
```

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-03T15:44:09.320

它主要用于平板电脑。由于上面的答案，我发现了这一点：

[http://developer.android.com/distribute/googleplay/quality/tablet.html#hardware-requirements](http://developer.android.com/distribute/googleplay/quality/tablet.html#hardware-requirements)

我主要使用

```
<uses-feature android:name="android.hardware.telephony" /> 
```

我不得不改为：

```
<uses-feature android:name="android.hardware.telephony" android:required="false" /> 
```

因为很多平板电脑没有电话

# email - 如何防止外部实体拒绝来自测试服务器的电子邮件？

> ID：14863221
> 
> 赞同：4
> 
> 时间：2013-02-13T21:11:06.593
> 
> 标签：email, smtp, spoofing

我目前正在使用一个允许用户生成电子邮件的客户端，这些电子邮件被发送到客户端的邮件服务器，在那里进行解析，添加内容语言，然后将它们重新发送给收件人。

所以，我的服务器基本上发送以下内容：

```
FROM: sender@myserver.com
TO: receiver@externalclient.com
SUBJECT: hello world
BODY:
|FROM:anyone@anyserver.com|TO:anyoneelse@anyotherserver.com|CC:anycc@anyserver.com|
Dear so-and-so.

Here is the information you were asking for.

Sincerely,

Anyone. 
```

当这些电子邮件从我们的生产网站（即`www.myserver.com`）发送到我们的 SMTP 服务器时，它们会顺利通过。

但是，当我尝试从我们的测试网站（即`test.myserver.com`）发送一个时，它们被拒绝并显示以下信息：

```
#5.0.0 smtp; 5.1.0 - Unknown address error 550-'rejecting spoofed message' (delivery attempts: 0)> #SMTP# 
```

我们这边有什么方法可以让这些电子邮件通过，还是我们需要要求外部客户端更改他们的配置以允许我们从其他子域发送电子邮件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-15T11:04:45.953

它必须是接收域来满足更改。

# python - 在 Python 2.7 中高效读取 800 GB XML 文件

> ID：14863224
> 
> 赞同：21
> 
> 时间：2013-02-13T21:11:27.763
> 
> 标签：python, xml, python-2.7, file, io

我正在 python 2.7 中读取一个 800 GB 的 xml 文件，并使用 etree 迭代解析器对其进行解析。

目前，我只是`open('foo.txt')`在没有缓冲参数的情况下使用。我有点困惑这是我应该采用的方法，还是应该使用缓冲参数或使用来自 io 的东西，如 io.BufferedReader 或 io.open 或 io.TextIOBase。

一个正确方向的观点将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-13T21:18:08.390

默认情况下，标准[`open()`函数](http://docs.python.org/2/library/functions.html#open)已经返回一个缓冲文件（如果在您的平台上可用）。对于*通常*完全缓冲的文件对象。

*通常*这里意味着 Python 将其留给 C stdlib 实现；它使用[`fopen()`调用](http://linux.die.net/man/3/fopen)（`wfopen()`在 Windows 上支持 UTF-16 文件名），这意味着选择了文件的默认缓冲；在 Linux 上，我相信这将是 8kb。对于像 XML 解析这样的纯读取操作，这种类型的缓冲*正是*您想要的。

XML 解析由`iterparse`16384 字节 (16kb) 的块读取文件。

如果要控制缓冲区大小，请使用`buffering`关键字参数：

```
open('foo.xml', buffering=(2<<16) + 8)  # buffer enough for 8 full parser reads 
```

这将覆盖默认缓冲区大小（我希望与文件块大小或其倍数匹配）。根据[这篇文章](http://seann.herdejurgen.com/resume/samag.com/html/v11/i04/a6.htm)，增加读取缓冲区*应该*会有所帮助，并且使用至少 4 倍于预期读取块大小加上 8 个字节的大小将提高读取性能。在上面的示例中，我将其设置为 ElementTree 读取大小的 8 倍。

该[`io.open()`函数](http://docs.python.org/2/library/io.html#io.open)表示对象的新 Python 3 I/O 结构，其中 I/O 已被拆分为新的类类型层次结构，以便为您提供更大的灵活性。代价是更多的间接性，数据必须通过更多的层，Python C 代码自己做更多的工作，而不是把它留给操作系统。

您*可以*尝试看看是否`io.open('foo.xml', 'rb', buffering=2<<16)`会表现得更好。以模式打开`rb`会给你一个[`io.BufferedReader`实例](http://docs.python.org/2/library/io.html#io.BufferedReader)。

你*不想*使用`io.TextIOWrapper`; 底层的 expat 解析器需要原始数据，因为它会自行解码您的 XML 文件编码。它只会增加额外的开销；如果你在`r`(textmode) 中打开，你会得到这种类型。

Using`io.open()`可能会给你更多的灵活性和更丰富的 API，但是底层的 C 文件对象是使用`open()`而不是打开的`fopen()`，并且所有的缓冲都由 Python`io.BufferedIOBase`实现处理。

我认为你的问题将是处理这个野兽，而不是文件读取。无论如何，在读取 800GB 文件时，磁盘缓存几乎都会被拍摄。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:20:17.537

你尝试过惰性函数吗？：[在 Python 中读取大文件的惰性方法？](https://stackoverflow.com/questions/519633/lazy-method-for-reading-big-file-in-python)

这似乎已经回答了你的问题。但是，我会考虑使用这种方法将您的数据写入数据库，mysql 是免费的：[http](http://dev.mysql.com/downloads/) : //dev.mysql.com/downloads/，NoSQL 也是免费的，并且可能更适合涉及写入 800gb 的操作数据或类似数量：[http ://www.oracle.com/technetwork/database/nosqldb/downloads/default-495311.html](http://www.oracle.com/technetwork/database/nosqldb/downloads/default-495311.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T23:10:28.933

我还没有尝试过使用这种史诗般的 xml 文件，但上次我不得不处理大型（且相对简单的）xml 文件时，我使用了[sax parser](http://docs.python.org/2/library/xml.sax.html)。

它基本上为您提供每个“事件”的回调，并留给您存储您需要的数据。您可以提供一个打开的文件，这样您就不必一次全部阅读。

# javascript - 错误jquery移动

> ID：14863229
> 
> 赞同：0
> 
> 时间：2013-02-13T21:11:45.317
> 
> 标签：javascript, jquery-mobile

我刚下载jquery mobile 1.2.0

[http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js](http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js)

但我有这个错误 Uncaught TypeError: Cannot read property 'msie' of undefined

当我在带有 phonegap 的 android 设备上运行项目时，我遇到了同样的错误

```
<!DOCTYPE HTML>
<html>
    <head>
        <title>PhoneGap</title>
        <link rel="stylesheet" href="css/jquery.mobile-1.2.0.min.css" />
        <link rel="stylesheet" href="css/jquery.mobile.structure-1.2.0.min.css" />
        <link rel="stylesheet" href="css/jquery.mobile.theme-1.2.0.min.css" />
    </head>
    <body>
    <h1>Hello PhoneGap !!!</h1>
    <script type="text/javascript" charset="utf-8" src="javascript/cordova-2.4.0.js"></script>
    <script type="text/javascript" charset="utf-8" src="javascript/jquery/jquery-1.9.1.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="javascript/jquery/jquery.mobile-1.2.0.min.js"></script>
    </body>
</html> 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:17:29.013

根据这个页面：http: [//jquerymobile.com/test/#/test/docs/about/getting-started.html](http://jquerymobile.com/test/#/test/docs/about/getting-started.html)

“jQuery Mobile 1.3 RC1 (1.3.0-rc.1) 适用于从 1.7.0 到 1.9.0 的 jQuery 核心版本。”

所以我的猜测是，如果你升级到 jQuery Mobile 1.3 RC1，你至少需要将你的 jQuery 核心降到 1.9.0。

jQuery 1.2.0 看起来像 1.8.2：http: [//jquerymobile.com/demos/1.2.0/](http://jquerymobile.com/demos/1.2.0/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T16:56:50.073

你可以添加

jquery-migrate-1.1.1.min

```
<script src="~/Scripts/jquery-migrate-1.1.1.min.js"></script> 
```

到您的引用脚本列表

# javascript - 使用什么值来清除不同的数据类型？

> ID：14863230
> 
> 赞同：0
> 
> 时间：2013-02-13T21:11:44.527
> 
> 标签：javascript

假设您有一个具有值的属性，并且您想清除该值。您是否总是想将其设置为 null 或 undefined，或者数据类型是否重要。

我认为数据类型很重要的唯一原因是为了记录该属性的数据类型应该是什么。

我正在谈论的示例：

```
var x = "string";
x = ""; // clear the value with the implied data type
// or
x = null; /* or */ x = undefined; 
```

同样可以应用于 Numbers(NaN)、Arrays([])、Objects({}) ，在这些地方它将使用等效的空数据类型清除。

我主要在寻找最佳实践是什么以及为什么，而不是什么是可能的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:14:21.857

这取决于你想要完成什么。
如果您想删除该值，我会将其设置为`null`.
如果您想为字符串提供空字符串值，请执行此操作。

`undefined`未定义...我认为手动将变量更改为未定义并没有太大意义，因为它已定义...

最后一件事，类型无关紧要，在 js 中更改变量类型没有问题，它是动态类型语言。

# php - PHP Curl GET 调用疑难解答

> ID：14863232
> 
> 赞同：0
> 
> 时间：2013-02-13T21:11:55.563
> 
> 标签：php, curl, get, xampp

我正在构建一个对 API 进行标准 HTTP 调用的网站。我的第一个调用是使用基本身份验证的不带参数的直接 GET。我在我的 php 中使用 Curl。我通过本地安装的 XAMPP 运行它。我的电话不工作，但如果我有一个同事在他的 Linux 机器上运行 php，运行旧版本的 ubuntu PHP，它工作正常。解决此问题的最佳方法是什么？我的猜测是它与我的 XAMPP 安装有关，但有没有一种很好的故障排除方法？我在我的 curl 会话中使用 curl_getinfo 来获取返回值，据我所知，它似乎并没有提供太多的洞察力。

这是 curl_getinfo 输出：

```
Array ( 
[url] => https://www.ebusservices.net/webservices/hrpcertws/rbs/api/merchants/267811683882/consumers.xml? 
[content_type] => 
[http_code] => 0 
[header_size] => 0 
[request_size] => 107 
[filetime] => -1 
[ssl_verify_result] => 0 
[redirect_count] => 0 
[total_time] => 0.28 
[namelookup_time] => 0.015 
[connect_time] => 0.015 
[pretransfer_time] => 0 
[size_upload] => 0 
[size_download] => 0
[speed_download] => 0 
[speed_upload] => 0 
[download_content_length] => -1 
[upload_content_length] => -1 
[starttransfer_time] => 0 
[redirect_time] => 0 
[certinfo] => Array ( ) 
[primary_ip] => 127.0.0.1 
[primary_port] => 8888 
[local_ip] => 127.0.0.1 
[local_port] => 59509 
[redirect_url] => 
) 
```

我正在使用： Windows 7 上的
XAMPP 1.8.1
PHP 版本 5.4.7
cURL 7.24.0

添加代码：

```
<?php

    error_reporting(E_ALL);

    $session = 'FALSE';
    // Initialize the session
    $session = curl_init();

    $stderr = fopen("curl.txt", "w+"); 

    // Set curl options
    curl_setopt($session,     CURLOPT_URL, 'https://www.ebusservices.net/webservices/hrpcertws/rbs/api/merchants/12233442/consumers.xml?');
    curl_setopt($session, CURLOPT_STDERR, $stderr);
    curl_setopt($session, CURLOPT_HTTPAUTH, CURLAUTH_BASIC);
    curl_setopt($session, CURLOPT_USERPWD, "username:pwd");
    curl_setopt($session, CURLOPT_RETURNTRANSFER, 1);
    curl_setopt($session, CURLOPT_SSLVERSION, 3);
    curl_setopt($session, CURLOPT_VERBOSE, 1);

    // Make the request
    $response = curl_exec($session);

    print_r(curl_getinfo($session));

    // Close the curl session
    curl_close($session);

    fclose($stderr);

    // Get HTTP Status code from the response
    $status_code = array();
    preg_match('/\d\d\d/', $response, $status_code);

    // Check the HTTP Status code
    if(isset($status_code[0]))
    {
         switch( $status_code[0] ) 
    {
            case 100:
                   break;
            case 200:
                   break;
            case 503:
                   die('Your call to HRP API failed and returned an HTTP status of 503\. That means: Service unavailable. An internal problem prevented us from returning data to you.');
                   break;
            case 403:
                   die('Your call to HRP API failed and returned an HTTP status of   403\. That means: Forbidden. You do not have permission to access this resource, or are over your rate limit.');
                   break;
            case 400:
                  die('Your call to HRP API failed and returned an HTTP status of 400\. That means:  Bad request. The parameters passed to the service did not match as expected. The exact error is returned in the XML response.');
                  break;
            case 401:
                  die('Your call to HRP API failed and returned an HTTP status of 401\. That means: Unauthorized. The credentials supplied do not have permission to access this resource.');
                  break;
            case 404:
                  die('Page not found.');
                  break;
            default:
                  die('Your call to HRP API returned an unexpected HTTP status of:' . $status_code[0]);
        } 
    }
    else
    { 
       echo 'failed';
    }

     // Get the XML from the response, bypassing the header
    if (!($xml = strstr($response, '<?xml'))) {
        $xml = null;
        //echo 'in xml';
    }

     // Output the XML
     echo htmlspecialchars($xml, ENT_QUOTES);

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:11:26.530

尝试使用[Fiddler](http://www.fiddler2.com/fiddler2/)来准确查看 HTTP 流量中的内容。

# haskell - 重大变化在哪里？

> ID：14863235
> 
> 赞同：6
> 
> 时间：2013-02-13T21:12:08.177
> 
> 标签：haskell, yesod

我编写了一个 CRUD 应用程序来与 JIRA 交互。我最终升级了我的 haskell 环境，因为 cabal-dev 并不能解决所有问题。结果，我遇到了一些问题，每当我尝试使用与 JIRA 接口的任何代码时都会出现此错误。

```
Spike: HandshakeFailed (Error_Misc "user error (unexpected type received. expecting
handshake and got: Alert [(AlertLevel_Warning,UnrecognizedName)])") 
```

经过一番谷歌搜索，我认为这与 tls 或使用 tls 的 http-conduit 有关。

我目前正在使用`tls-1.1.2`，`http-conduit-1.8.7.1` 以前我正在使用 `tls-0.9.11`和`http-conduit >= 1.5 && < 1.7`（不确定哪个，旧安装已经消失。

这就是我相信休息发生的地方

```
manSettings :: ManagerSettings
manSettings = def { managerCheckCerts = \ _ _ _-> return CertificateUsageAccept } 
```

这就是它过去的样子

```
manSettings :: ManagerSettings
manSettings = def { managerCheckCerts = \ _ _ -> return CertificateUsageAccept } 
```

这是使用它的代码

```
initialRequest :: forall (m :: * -> *). URI -> IO (Request m,Manager)
initialRequest uri = do
   initReq <- parseUrl uri -- let the server tell you what the request header
                           -- should look like 
   manager <- newManager manSettings -- a Manager manages http connections
                                     -- we mod the settings to handle
                                     -- the SSL cert. See manSettings below.
   return (modReq initReq,manager)
      where modReq initReq = applyBasicAuth username password initReq 
```

让我知道我是否遗漏了什么。在这一点上，我不确定从那时到现在发生了什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T05:19:22.380

这是对错误来源的一个很好的猜测，但不太可能：managerCheckCerts 只是使用证书包来检查证书的有效性。您看到的错误消息似乎来自 tls 本身，表明数据传输失败。使用 tls 提交错误报告可能是一个好主意，最好首先将问题缩小到失败的单个 HTTPS 调用（或者甚至更好，单独使用 tls 并展示相同的失败）。

# gwt - 尚未附加 JSNI 的 GWT 小部件

> ID：14863238
> 
> 赞同：0
> 
> 时间：2013-02-13T21:12:23.603
> 
> 标签：gwt, jsni

我创建了一个扩展 SimplePanel 并在 onLoad() 方法中执行一些 JSNI 的小部件：

```
public class AceEditor extends SimplePanel implements HasText {

  private JavaScriptObject editor;

  @Override
  protected void onLoad() {
    super.onLoad();
    editor = createEditor(getElement());
  }

  private static native JavaScriptObject createEditor(Element element) /*-{
      return $wnd.ace.edit(element);
  }-*/;

  @Override
  public native void setText(String value) /*-{
      this.@org.obiba.opal.web.gwt.ace.client.AceEditor::editor.setValue(value);
  }-*/;

  @Override
  public final native String getText() /*-{
      return this.@org.obiba.opal.web.gwt.ace.client.AceEditor::editor.getValue();
  }-*/;

} 
```

问题是当我第一次调用`setText`时，小部件尚未附加（`onLoad`尚未调用）。

我将此小部件与`UiBinder`.

我可以使用`addAttachHandler`并检查是否附加了小部件，但它似乎不是正确的方法......

知道为什么没有尽快附加小部件吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:22:53.817

你可以在构造函数中调用 createEditor 而不是 onload 吗？

似乎您的代码在加载页面之前调用了 setText 。
现在，如果是这种情况，在构造函数中调用 createEditor 应该是正确的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T02:53:46.487

> 知道为什么没有尽快附加小部件吗？

根据定义，它不应该被“附加”，直到你将它添加到一个已经附加的父级（或者是`RootPanel`，或者另一个已经添加到的东西`RootPanel`）。你这样做了，`onLoad`但仍然没有被调用？

如果您的 JS 工具（在本例中`ace`）要求存在 DOM 节点，那么您无需等待`onLoad`被调用来执行任何操作 - 在您的 Widget 子类的构造函数完成时，您必须已经指定了一个元素。

如果您确实需要将此元素附加到文档上，然后才能对其执行操作，那么可以，当然，您需要等到调用 onLoad。

# tags - 将 gtags 用于 gtk 标头和我自己的项目

> ID：14863246
> 
> 赞同：2
> 
> 时间：2013-02-13T21:12:55.117
> 
> 标签：tags, ctags, gnu-global

我有一个 gtk 项目，我想在我的项目中使用 gtags。我还想将 gtags 用于外部库，在我的例子中是 gtk。我试过了：

```
find /usr/include/gtk-2.0 -name "*.h" > gtk_headers
gtags -f gtk_headers 
```

不幸的是，我在这里遇到了分段错误（使用 Ubuntu 12.04）

任何想法如何获得这项工作？（我也对使用 ctags 或 etags 的解决方案感到满意）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T05:54:26.093

请试试这个：

```
$ (cd /usr/include/gtk-2.0; gtags)          # make tag in the library project
$ gtags                                     # make tag in your project
$ GTAGSLIBPATH=/usr/include/gtk-2.0; export GTAGSLIBPATH
$ global -x xxx 
```

如果您的项目中存在“xxx”，则全局显示它。否则，如果库项目中存在“xxx”，则全局显示它。

要同时显示它们，请尝试以下操作：

```
$ GTAGSTHROUGH=; export GTAGSTHROUGH 
```

如果您有很多库，请像 PATH 环境变量一样指定它们。

```
$ GTAGSLIBPATH=/usr/src/lib:/usr/include/gtk-2.0; export GTAGSLIBPATH 
```

祝你好运！

# vba - 如何在 Excel 中将 DocumentProperty 添加到 CustomDocumentProperties？

> ID：14863250
> 
> 赞同：14
> 
> 时间：2013-02-13T21:13:09.940
> 
> 标签：vba, excel

我正在尝试将 DocumentProperty 添加到 CustomDocumentProperties 集合中。代码如下：

```
Sub testcustdocprop()
Dim docprops As DocumentProperties
Dim docprop As DocumentProperty

Set docprops = ThisWorkbook.CustomDocumentProperties
Set docprop = docprops.Add(Name:="test", LinkToContent:=False, Value:="xyz")

End Sub 
```

运行它会给我以下错误：

```
Run-time error '5':
Invalid procedure call or argument 
```

我尝试将其`.Add`作为 void 函数运行，如下所示：

```
docprops.Add Name:="test", LinkToContent:=False, Value:="xyz" 
```

这给了我同样的错误。如何添加自定义文档属性？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-13T21:18:47.810

Try this routine:

```
Public Sub updateCustomDocumentProperty(strPropertyName As String, _
    varValue As Variant, docType As Office.MsoDocProperties)

    On Error Resume Next
    ActiveWorkbook.CustomDocumentProperties(strPropertyName).Value = varValue
    If Err.Number > 0 Then
        ActiveWorkbook.CustomDocumentProperties.Add _
            Name:=strPropertyName, _
            LinkToContent:=False, _
            Type:=docType, _
            Value:=varValue
    End If
End Sub 
```

* * *

Edit: **Usage Examples**

^(Five years later and the 'official' documentation is still a mess on this... I figured I'd add some examples of usage:)

## Set Custom Properties

```
Sub test_setProperties()
    updateCustomDocumentProperty "my_API_Token", "AbCd1234", msoPropertyTypeString
    updateCustomDocumentProperty "my_API_Token_Expiry", #1/31/2019#, msoPropertyTypeDate
End Sub 
```

## Get Custom Properties

```
Sub test_getProperties()
    MsgBox ActiveWorkbook.CustomDocumentProperties("my_API_Token") & vbLf _
        & ActiveWorkbook.CustomDocumentProperties("my_API_Token_Expiry")
End Sub 
```

## List All Custom Properties

```
Sub listCustomProps()
    Dim prop As DocumentProperty
    For Each prop In ActiveWorkbook.CustomDocumentProperties
        Debug.Print prop.Name & " = " & prop.Value & " (" & Choose(prop.Type, _
            "msoPropertyTypeNumber", "msoPropertyTypeBoolean", "msoPropertyTypeDate", _
            "msoPropertyTypeString", "msoPropertyTypeFloat") & ")"
    Next prop
End Sub 
```

## Delete Custom Properties

```
Sub deleteCustomProps()
    ActiveWorkbook.CustomDocumentProperties("my_API_Token").Delete
    ActiveWorkbook.CustomDocumentProperties("my_API_Token_Expiry").Delete
End Sub 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2017-07-03T16:15:51.077

我想我应该将上述答案从 2013 年扩展到工作，而无需传入 docType 参数：

```
Private Function getMsoDocProperty(v As Variant) As Integer
    'VB TYPES:
        'vbEmpty                0       Empty (uninitialized)
        'vbNull                 1       Null (no valid data)
        'vbInteger              2       Integer
        'vbLong                 3       Long integer
        'vbSingle               4       Single-precision floating-point number
        'vbDouble               5       Double-precision floating-point number
        'vbCurrency             6       Currency value
        'vbDate                 7       Date value
        'vbString               8       String
        'vbObject               9       Object
        'vbError                10      Error value
        'vbBoolean              11      Boolean value
        'vbVariant              12      Variant (used only with arrays of variants)
        'vbDataObject           13      A data access object
        'vbDecimal              14      Decimal value
        'vbByte                 17      Byte value
        'vbUserDefinedType      36      Variants that contain user-defined types
        'vbArray                8192    Array

    'OFFICE.MSODOCPROPERTIES.TYPES
        'msoPropertyTypeNumber  1       Integer value.
        'msoPropertyTypeBoolean 2       Boolean value.
        'msoPropertyTypeDate    3       Date value.
        'msoPropertyTypeString  4       String value.
        'msoPropertyTypeFloat   5       Floating point value.

    Select Case VarType(v)
        Case 2, 3
            getMsoDocProperty = Office.MsoDocProperties.msoPropertyTypeNumber
        Case 11
            getMsoDocProperty = Office.MsoDocProperties.msoPropertyTypeBoolean
        Case 7
            getMsoDocProperty = Office.MsoDocProperties.msoPropertyTypeDate
        Case 8, 17
            getMsoDocProperty = Office.MsoDocProperties.msoPropertyTypeString
        Case 4 To 6, 14
            getMsoDocProperty = Office.MsoDocProperties.msoPropertyTypeFloat
        Case Else
            getMsoDocProperty = 0
    End Select
End Function

Public Sub subUpdateCustomDocumentProperty(strPropertyName As String, _
    varValue As Variant, Optional docType As Office.MsoDocProperties = 0)

    If docType = 0 Then docType = getMsoDocProperty(varValue)
    If docType = 0 Then
        MsgBox "An error occurred in ""subUpdateCustomDocumentProperty"" routine", vbCritical
        Exit Sub
    End If

    On Error Resume Next
    Wb.CustomDocumentProperties(strPropertyName).Value _
        = varValue
    If Err.Number > 0 Then
        Wb.CustomDocumentProperties.Add _
            Name:=strPropertyName, _
            LinkToContent:=False, _
            Type:=docType, _
            Value:=varValue
    End If
End Sub 
```

# sql-server - Grails 1.3.7 映射到 sql server 2k8 日期列

> ID：14863251
> 
> 赞同：0
> 
> 时间：2013-02-13T21:13:14.860
> 
> 标签：sql-server, grails, grails-orm

我们有一个运行 1.3.7 的遗留 grails 应用程序，并且无法映射到具有日期数据类型的 mssql 服务器 2k8 表。

`sqlType:'date'`当它尝试加载实体 ERROR util.JDBCExceptionReporter - Can't convert '2013-07-24' to Timestamp 时，我已经将它映射到它仍然会出现以下错误。

添加了自定义方言扩展`SQLServerDialect`与以下没有区别

```
registerColumnType( Types.DATE, "date" ); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:58:25.057

Grails 1.3.7 与 hibernate 3.3.1 GA 捆绑在一起。我认为`SQLServer2008Dialect`这个版本的 Hibernate 中没有，只有一个适用于 2k 和 2k5 版本的`SQLServerDialect̀

您必须从更高版本中借用此类，如[本博文中所述](http://robert-reiz.com/2011/05/10/sqlserver-2008-with-hibernate-3-6-4/)

为了存档，我在这里复制课程（来自 robert-reiz.com）

```
import org.hibernate.Hibernate;
import org.hibernate.cfg.Environment;
import org.hibernate.dialect.SQLServerDialect;
import org.hibernate.dialect.function.*;
import org.hibernate.type.StandardBasicTypes;

import java.sql.Types;

public class SqlServer2008Dialect extends SQLServerDialect {

 public SqlServer2008Dialect(){
 super();

 registerColumnType( Types.DATE, "date" );
 registerColumnType( Types.TIME, "time" );
 registerColumnType( Types.TIMESTAMP, "datetime2" );

 registerFunction( "current_timestamp", new NoArgSQLFunction("current_timestamp",     Hibernate.TIMESTAMP,false) );

 registerColumnType( Types.BIT, "tinyint" ); //Sybase BIT type does not support null values
 registerColumnType( Types.BIGINT, "bigint" );//changed
 registerColumnType( Types.SMALLINT, "smallint" );
 registerColumnType( Types.TINYINT, "tinyint" );
 registerColumnType( Types.INTEGER, "int" );
 registerColumnType( Types.CHAR, "char(1)" );
 registerColumnType( Types.VARCHAR, "varchar($l)" );
 registerColumnType( Types.FLOAT, "float" );
 registerColumnType( Types.DOUBLE, "double precision" );

 registerColumnType( Types.VARBINARY, "varbinary($l)" );
 registerColumnType( Types.NUMERIC, "numeric($p,$s)" );
 registerColumnType( Types.BLOB, "image" );
 registerColumnType( Types.CLOB, "text" );
 registerColumnType( Types.ROWID, "bigint");

 registerFunction( "ascii", new StandardSQLFunction("ascii", StandardBasicTypes.INTEGER));
 registerFunction( "char", new StandardSQLFunction("char", StandardBasicTypes.CHARACTER));
 registerFunction( "len", new StandardSQLFunction("len", StandardBasicTypes.LONG) );
 registerFunction( "lower", new StandardSQLFunction("lower") );
 registerFunction( "upper", new StandardSQLFunction("upper") );
 registerFunction( "str", new StandardSQLFunction("str", StandardBasicTypes.STRING) );
 registerFunction( "ltrim", new StandardSQLFunction("ltrim") );
 registerFunction( "rtrim", new StandardSQLFunction("rtrim") );
 registerFunction( "reverse", new StandardSQLFunction("reverse") );
 registerFunction( "space", new StandardSQLFunction("space", StandardBasicTypes.STRING));

 registerFunction( "user", new NoArgSQLFunction("user", StandardBasicTypes.STRING) );

 registerFunction( "current_timestamp", new NoArgSQLFunction("getdate", StandardBasicTypes.TIMESTAMP) );
 registerFunction( "current_time", new NoArgSQLFunction("getdate", StandardBasicTypes.    TIME) );
 registerFunction( "current_date", new NoArgSQLFunction("getdate", StandardBasicTypes.    DATE) );

 registerFunction( "getdate", new NoArgSQLFunction("getdate", StandardBasicTypes.    TIMESTAMP) );
 registerFunction( "getutcdate", new NoArgSQLFunction("getutcdate", StandardBasicTypes.    TIMESTAMP) );
 registerFunction( "day", new StandardSQLFunction("day", StandardBasicTypes.INTEGER) );
 registerFunction( "month", new StandardSQLFunction("month", StandardBasicTypes.INTEGER) );
 registerFunction( "year", new StandardSQLFunction("year", StandardBasicTypes.INTEGER) )    ;
 registerFunction( "datename", new StandardSQLFunction("datename", StandardBasicTypes.    STRING) );

 registerFunction( "abs", new StandardSQLFunction("abs") );
 registerFunction( "sign", new StandardSQLFunction("sign", StandardBasicTypes.INTEGER) )    ;

 registerFunction( "acos", new StandardSQLFunction("acos", StandardBasicTypes.DOUBLE) );
 registerFunction( "asin", new StandardSQLFunction("asin", StandardBasicTypes.DOUBLE) );
 registerFunction( "atan", new StandardSQLFunction("atan", StandardBasicTypes.DOUBLE) );
 registerFunction( "cos", new StandardSQLFunction("cos", StandardBasicTypes.DOUBLE) );
 registerFunction( "cot", new StandardSQLFunction("cot", StandardBasicTypes.DOUBLE) );
 registerFunction( "exp", new StandardSQLFunction("exp", StandardBasicTypes.DOUBLE) );
 registerFunction( "log", new StandardSQLFunction( "log", StandardBasicTypes.DOUBLE) );
 registerFunction( "log10", new StandardSQLFunction("log10", StandardBasicTypes.DOUBLE) );
 registerFunction( "sin", new StandardSQLFunction("sin", StandardBasicTypes.DOUBLE) );
 registerFunction( "sqrt", new StandardSQLFunction("sqrt", StandardBasicTypes.DOUBLE) );
 registerFunction( "tan", new StandardSQLFunction("tan", StandardBasicTypes.DOUBLE) );
 registerFunction( "pi", new NoArgSQLFunction("pi", StandardBasicTypes.DOUBLE) );
 registerFunction( "square", new StandardSQLFunction("square") );
 registerFunction( "rand", new StandardSQLFunction("rand", StandardBasicTypes.FLOAT) );

 registerFunction("radians", new StandardSQLFunction("radians", StandardBasicTypes.    DOUBLE) );
 registerFunction("degrees", new StandardSQLFunction("degrees", StandardBasicTypes.    DOUBLE) );

 registerFunction( "round", new StandardSQLFunction("round") );
 registerFunction( "ceiling", new StandardSQLFunction("ceiling") );
 registerFunction( "floor", new StandardSQLFunction("floor") );

 registerFunction( "isnull", new StandardSQLFunction("isnull") );

 registerFunction( "concat", new VarArgsSQLFunction( StandardBasicTypes.STRING, "(    ","+",")" ) );

 registerFunction( "length", new StandardSQLFunction( "len", StandardBasicTypes.INTEGER     ) );
 registerFunction( "trim", new SQLFunctionTemplate( StandardBasicTypes.STRING, "ltrim(    rtrim(?1))") );
 registerFunction( "locate", new CharIndexFunction() );

 getDefaultProperties().setProperty(Environment.STATEMENT_BATCH_SIZE, NO_BATCH);
 }

} 
```

你必须添加

```
dialect = org.hibernate.dialect.SqlServer2008Dialect 
```

在 ̀Datasource.groovy 配置文件中，并使此类可用于您的类路径

警告：在博文中，Hibernate 的基本版本是 3.6.4，上面的代码使用了`SQLServer2005Dialect`3.3.1 GA 版本中不存在的类。我修改了上面的代码以考虑到这一点（我使用`SQLServerDialect`了），同时假设这些类是兼容的。我没有检查这个。

# cakephp - 使用 CakePHP 缓存大量数据

> ID：14863252
> 
> 赞同：0
> 
> 时间：2013-02-13T21:13:15.123
> 
> 标签：cakephp, caching, cakephp-2.0

我有**很多**可以使用的数据，它们几乎不会改变，并且不时刷新缓存根本不是问题 - 但理想情况下，只有在新数据进入表时才会刷新缓存。

我的理解是 CakePHP 可以缓存整个表并处理它，即使像文件缓存这样较慢的缓存也是如此。这意味着我查询所有信息一次，如果我说“findById(54)”，它只会在缓存中搜索 ID 54 并将其处理掉。我不想只缓存 ID 54 的内容。我还想避免更改我已经完成的代码。我知道必须有可能只 findAll() 并缓存一次，但我并没有考虑到这一点，如果我不需要，我宁愿不经历这一切。

我的问题是，如何让 CakePHP 缓存整个表并从该缓存中查询？可能吗？我对使用 memcached 持开放态度，但我想一开始我只会使用文件缓存。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T22:40:10.843

> 我有**很多**数据

“很多”是多少？

## 覆盖 AppModel 中的 find 方法

做你想做的事的一种简单技术是在你的应用模型中劫持 find 调用，如果有一个缓存结果，则返回一个缓存结果，类似于：

```
public function find($type = 'first', $params = array()) {
    $key = md5(serialize(func_get_args());
    $return = Cache::read($key);
    if (false !== $return) {
        return $cacheResult;
    }

    $return = parent::find($type, $params);
    Cache::write($key, $return);
    return $return;
} 
```

通过这种方式，您可以在使用数据库时填充缓存，并且可以禁用缓存，或者拥有一个空缓存，并且仍然可以让您的站点正常工作。

# javascript - Javascript onclick 调用功能似乎不起作用

> ID：14863254
> 
> 赞同：2
> 
> 时间：2013-02-13T21:13:22.930
> 
> 标签：javascript, html

我有我的文本区域，当它被点击时，我希望清除文本

```
<textarea id="cow" rows="5" name="message" cols="50" onfocus="clear()" >Please provide a link to an image no wider than 500px. </textarea> 
```

以及来自外部 js 文件的 javascript：

```
var cow=document.getElementById("cow").value;
function clear(){ document.getElementById("cow").value=' '; } 
```

我意识到我可能可以使用 Jquery，但我只是在尝试学习 javascript。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:32:50.680

信不信由你，你的代码没问题，除了你把函数命名为这个事实**`clear`**。

*在某些*浏览器中，在内联事件处理程序中，`document`对象被连接到事件处理程序的作用域链中。这有一个不幸的效果，它不是指您的功能，而是指. 此行为未标准化，因此根据您使用的浏览器，您可能会看到不同的结果。*`clear`[`document.clear`](https://developer.mozilla.org/en/docs/DOM/document.clear)*

 *如果你**重命名你的函数**，它工作得很好：http: [//jsfiddle.net/QqMsX/](http://jsfiddle.net/QqMsX/)。

* * *

您绝对应该阅读“[在 Javascript 中“清除”是保留字吗？](https://stackoverflow.com/questions/7165570/is-clear-a-reserved-word-in-javascript) ”，其中我还解释了如何避免这种情况。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:33:16.137

似乎浏览器正在尝试调用`document.clear`而不是您创建的 clear 函数。如果您将函数重命名为`clearText`，它可以正常工作[http://jsfiddle.net/7meL7/](http://jsfiddle.net/7meL7/)

避免该问题的一个好方法是在属性中完全避免 JS

```
<textarea id="cow" rows="5" name="message" cols="50">Please provide a link to an image no wider than 500px. </textarea>

// There are better ways, but this is the simplest crossbrowser way
document.getElementById("cow").onfocus = function() {
    this.value = '';
} 
```*

# jquery-mobile - 滚动页面时不移动的 jQuery Mobile 弹出窗口

> ID：14863256
> 
> 赞同：2
> 
> 时间：2013-02-13T21:13:25.550
> 
> 标签：jquery-mobile, popup, scroll

我正在使用 jQuery Mobile 1.3.0 RC1。我在页面底部以编程方式创建了一个弹出窗口，并在几秒钟后使用 setTimeout（toast 通知）关闭。它工作得很好，但是如果我碰巧在显示弹出窗口时滚动页面，弹出窗口也会滚动。我希望弹出窗口不要移动，即保持在相对于屏幕的位置，而不是相对于页面。有没有办法做到这一点 ？

我尝试使用 HTML 元素中的 data-position-to 属性，使用“open”方法的 positionTo 选项，并尝试将弹出元素放置在固定的透明页脚中，这些都没有导致所需的行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T06:24:58.570

上周我遇到了类似的问题。最后使用[模态对话框](http://dl.dropboxusercontent.com/u/49735179/dialog-data-transfer.html)而不是弹出窗口解决了它。

对于弹出窗口，我可以找到以下内容。

```
$("#myPopup").on({
    popupbeforeposition: function () {
        $('.ui-popup-screen').off();
    }
}); 
```

这有助于我防止在用户在弹出窗口之外触摸时关闭对话框。但是滚动问题仍然存在。所以我将所有弹出窗口更改为模式对话框。希望它可以帮助某人。

# php - CRUD 代码点火器

> ID：14863261
> 
> 赞同：0
> 
> 时间：2013-02-13T21:13:48.303
> 
> 标签：php, ruby-on-rails, codeigniter, crud

我使用 codeigniter 来制作我的 webapps，但我很无聊总是创建“CRUD”操作（表单、控制器、模型、数据库）。你知道生成 CRUD 操作的好工具吗？（如 RoR ？）。

谢谢 ！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T16:34:04.960

出于这个原因，我创建了一个库，因为创建 CRUD 操作既无聊又令人沮丧。

火花版本： http: [//getsparks.org/packages/sangar-scaffold/versions/HEAD/show](http://getsparks.org/packages/sangar-scaffold/versions/HEAD/show)

Github： [https ://github.com/sangar82/sangar-scaffold-spark](https://github.com/sangar82/sangar-scaffold-spark)

有了这个火花，您可以执行以下操作：

> Sangar-scaffolds 在数据库、控制器、模型和视图上创建表。
> 
> 它还修改了 routes.php 文件。
> 
> 您可以使用以下元素创建表单：
> - 文本
> - 文本区域
> - 单选按钮
> - 复选框
> - 选择
> - 选择 1:N（使用现有模型填充表单选择）
> - 上传图像（使用缩略图创建和上传规则）
> - 上传文件（使用上传规则）
> - 隐藏关系（这是一个特殊的元素。只允许一个通过脚手架隐藏的关系。它会自动生成一个关系为 1:N 的表单与其父表单链接。Belongs_to 关系）
> 
> 每个元素都有验证规则和使用多语言的可能性。
> 
> 还创建一个分页列表视图。

**Codeigniter 入门项目**

我创建了一个 Codeigniter Starter Project，因为配置一个新项目也很无聊。它具有我认为需要一个新的 codeigniter 项目的基本功能，并且 crud 生成器具有比 Sparks 版本更多的功能。我每天都用它。看看 Github

具有预装功能的自定义 Codeigniter：

Github：[https ://github.com/sangar82/CodeIgniter-Starter/](https://github.com/sangar82/CodeIgniter-Starter/)

它正在持续开发中，欢迎提出错误警报和改进。

特征：

> Sparks 已安装 ( [http://getsparks.org/](http://getsparks.org/) )
> Sangar Auth Library。（Ion-Auth 为我在 PHP-activerecord 下工作而修改）
> Sangar Scaffolding Library。做脚手架的新方法！
> 已安装 Php-ActiveRecord ( [https://github.com/kla/php-activerecord](https://github.com/kla/php-activerecord) ) 版本 每晚构建 2012 年 5 月
> 后端和完全访问控制（登录、注销、记住密码和对后端的保护访问）
> Phil Sturgeon 的模板库已实现( [http://philsturgeon.co.uk/demos/codeigniter-template/user_guide/](http://philsturgeon.co.uk/demos/codeigniter-template/user_guide/) )
> 基本布局（前端、后端）
> Toast 单元测试 ( [http://jensroland.com/projects/toast/](http://jensroland.com/projects/toast/) )
> 包括基本的 before_filter 和 after_filter 支持 (Matthew Machuga) https://github.com/machuga/codeigniter-filter[系统](https://github.com/machuga/codeigniter-filter)
> 消息在布局中作为部分
> 实现 公共内容的文件夹（图像、js、上传...） 3 种语言（英语、西班牙语、加泰罗尼亚语）的
> 语言翻译 用于翻译控制器的方法和 URL CRUD 上的方法名称 用户已实现。 示例：CRUD 类别。类别作为类别树（通过 ajax 排序） 示例：CRUD 产品上传图像和缩略图创建 测试示例（SangarAuth 测试、用户测试、类别测试、产品测试）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-31T11:02:14.467

通过以下链接，您可以在 codeigniter 框架中更轻松地进行 CRUD 操作。

[http://formigniter.org/app/](http://formigniter.org/app/) _

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:49:26.950

看看 GroceryCRUD [http://www.grocerycrud.com/](http://www.grocerycrud.com/)我认为它会满足您的期望；-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-14T16:38:07.217

我发现 CodeIgniter 的 DataMapper ORM 非常易于使用。

[http://datamapper.wanwizard.eu/](http://datamapper.wanwizard.eu/)

# google-sheets - 需要预测公式

> ID：14863262
> 
> 赞同：3
> 
> 时间：2013-02-13T21:13:53.747
> 
> 标签：google-sheets, google-sheets-formula, forecast

我有这个电子表格，在 A 列 - 日期、B 列（2012 年特定日期的关键字使用情况）和 C 列（2013 年特定日期的关键字使用情况）中有一些数据，如图所示：

![例子](../Images/75d1200c2ff6638bd3b676245313779d.png)

我想要的是一个像 FORECAST 这样的函数，它可以根据这些数据“预测”未来日期的值，在这种情况下是 2 月 22 日（C5）。

你能帮我计算一下公式吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-14T12:54:58.523

您可以使用 =FORECAST(value, data_Y, data_X) 公式。

value 是您想要预测相应预测的已知值（在您的情况下为 B5）；
data_Y 是您要预测未来值的一系列数据点 (C2:C4)；
data_X 是构成预测基础的一系列相应数据点 (B2:B4)。

因此，在您的示例中，您将在 C5 中输入的公式是 =forecast(B5,C2:C4,B2:B4) ，它将返回 28.7

[您可以在https://support.google.com/drive/bin/static.py?hl=en&topic=25273&page=table.cs](https://support.google.com/drive/bin/static.py?hl=en&topic=25273&page=table.cs)找到 Google 电子表格的所有公式及其解释

# android - 在两个字符串数组之间传递意图

> ID：14863273
> 
> 赞同：0
> 
> 时间：2013-02-13T21:15:11.237
> 
> 标签：android, arrays, string, android-intent

我有两个字符串数组，主要活动类中有contactNames，第二个活动类中有地址[]。当我单击其中一个名称时，它应该会显示该名称的地址详细信息。我应该如何在 Android 中为两个字符串数组创建一个意图。

**类联系人列表**

```
 Intent i = new Intent (MainActivity.this, Details.class);
    Bundle bundle = new Bundle ();
    bundle.putStringArray("key", address);
    i.putExtras(bundle);
    startActivity(i);
} 
```

**课程详情**

```
 Bundle b = this.getIntent().getExtras();
        String array [] = b.getStringArray("key");
    tvEmail.setText(array.toString());                      
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:58:31.770

> 我应该如何在 Android 中为两个字符串数组创建一个意图。

您可以添加另一个数组（或任何其他数据类型），但您需要使用不同的`key`名称。例子...

```
String[] array1;
String[] array2;

// Populate arrays here

Intent i = new Intent (MainActivity.this, Details.class);
Bundle bundle = new Bundle ();
bundle.putStringArray("key1", array1);
bundle.putStringArray("key2", array2);
i.putExtras(bundle);
startActivity(i); 
```

另请注意，您不需要`Bundle`直接使用 a 。你可以使用`Intent`方法`putExtra(String name, String[] value)`。例如...

```
String[] array1;
String[] array2;

// Populate arrays here

Intent i = new Intent (MainActivity.this, Details.class);
i.putExtra("key1", array1);
i.putExtra("key2", array2);
startActivity(i); 
```

# jquery - HTTP 状态 415 - JQUERY 中的 AJAX 调用不受支持的媒体类型到使用 JERSEY 实现的 Restful WS

> ID：14863274
> 
> 赞同：5
> 
> 时间：2013-02-13T21:15:21.550
> 
> 标签：jquery, jersey, http-status-code-415

您好我正在尝试将 json 数据发布到用 Jersey 实现的 Restful WS。我通过 jquery-ajax 发布数据。为什么我会收到 HTTP Status-415 不受支持的媒体类型？谢谢你。
[点击这里查看萤火虫描述的截图](http://i.stack.imgur.com/9Sj7S.png)

```
 //post method handler 
      @Path("/newentry")
        public class NewEntry {

            @POST
            @Consumes(MediaType.APPLICATION_JSON)
            public Response newEntry(String data) {
                    //doStuff
        }
    }
    // ajax call 
         $.ajax({
                 url: "http://localhost:8080/FirstRestWebService/rest/newentry",
                 type: "post",
                 data: formToJSON(),
                 dataType : "json",
                 success: function(data){
                alert("success");
                  },
               error:function(jqXHR, textStatus, errorThrown) {
                    alert("failure");
                  }   
            }); 

         function formToJSON() {
                return JSON.stringify({
                    "name": $("input#emp_name").val(),
                    ...
                    "username": $('input#username').val(),
                    "password": $('input#password').val()
                    }); 
```

[单击此处获取萤火虫描述的屏幕截图](http://i.stack.imgur.com/9Sj7S.png) **我能够通过 Jersey Client 成功测试 WS**。上面的 AJAX 调用有什么问题？谢谢你。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-13T21:51:37.917

在您的 AJAX 调用中，您需要设置您的内容类型：

```
contentType: "application/json" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-09T14:13:41.617

您必须声明 JSON 依赖项。请尝试将以下依赖项添加到您的 pom.xml。

```
 <dependency>
    <groupId>com.owlike</groupId>
    <artifactId>genson</artifactId>
    <version>0.98</version>
</dependency> 
```

# c# - 如何使用 TaskScheduler 安排 TaskCompletionSource.Task？

> ID：14863276
> 
> 赞同：0
> 
> 时间：2013-02-13T21:15:26.917
> 
> 标签：c#, c#-4.0, task-parallel-library

```
 public Task<bool> Submit(TaskScheduler ts, Func<bool> work, object state, TaskContinuationOptions taskContinuationOptions)
    {
        TaskCompletionSource<bool> tcs = new TaskCompletionSource<bool>(state, TaskCreationOptions.None);

        Task t1 = new TaskFactory(_cts.Token, TaskCreationOptions.None, taskContinuationOptions, ts).StartNew(() =>
        {
            try
            {
                tcs.SetResult(work());
            }
            catch(Exception e)
            {
                tcs.SetException(e);
            }               
        });

        Task<bool> t2 = tcs.Task;
        t2.ContinueWith(OnTaskSignaled);
        return t2;
    }

    public void OnTaskSignaled(Task<bool> signaledTask) 
    {            
        BusinessItem item = (BusinessItem)signaledTask.AsyncState;
        if (signaledTask.IsCanceled)
        {
            Console.WriteLine("{0} cancelled: Invalid State", item.Id);
        }
        else if (signaledTask.IsFaulted)
        {
            Console.WriteLine("{0} threw: {1}", item.Id, signaledTask.Exception);
        }
        else if (signaledTask.Result == true)
        {
            Console.WriteLine("{0} Succeeded", item.Id);
            // continue to submit
        }
        else if (signaledTask.Result == false)
        {
            Console.WriteLine("{0} Incomplete, retry", item.Id);
            Submit(_ts2, item.Work, item);
        }
    } 
```

在上面的示例中，taskContinuationOptions 选项是否传播到 TaskCompletionSource.Task？在调试模式下，我可以看到 t1 和 t2 是两个不同的对象。实际上，如果将 state 传递给 StartNew(...)，它只对 t1 可用，对 t2 不可用。

在这种情况下，TaskFactory 仅用于将工作提交给特定的 TaskScheduler，ts。它还创建另一个任务的事实使代码令人困惑。有没有更容易混淆的方法来做到这一点？我不明白为什么 TaskCompletionSource 作为任务生产者不像 TaskFactory 那样可配置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T11:35:39.640

您没有理由使用`TaskCompletionSource`. 如果您从 lambda 返回值，则`Task`返回的 from`StartNew()`将包含您想要的内容：成功的结果和失败的异常。

另外，我认为`TaskContinuationOptions`in `TaskFactory`work 仅适用于直接通过工厂启动的延续（例如使用[`ContinueWhenAll()`](http://msdn.microsoft.com/en-us/library/system.threading.tasks.taskfactory.continuewhenall.aspx)）。因此，我认为您根本不需要`TaskFactory`，但您应该分别为每个任务（原始任务和延续任务）指定选项。虽然我认为当前方法之外的人应该设置内部延续的执行方式很奇怪。

并回答您的问题：安排`TaskCompletionSource`some是没有意义的`TaskFactory`，因为`TaskCompletionSource`实际上并没有执行。

通过这些更改，您的代码将如下所示：

```
public Task<bool> Submit(
    TaskScheduler ts, Func<bool> work, object state,
    TaskContinuationOptions taskContinuationOptions)
{
    var task = Task.Factory.StartNew(_ => work(), state, _cts.Token);

    task.ContinueWith(OnTaskSignaled, _cts.Token, taskContinuationOptions,
                      TaskScheduler.Default);

    return task;
} 
```

# antlr - ANTLR v.3- 使用句法谓词进行前瞻

> ID：14863279
> 
> 赞同：2
> 
> 时间：2013-02-13T21:15:34.563
> 
> 标签：antlr, abstract-syntax-tree

仍在学习如何*正确*使用 ANTLR ......这是我的问题。

假设您有一个 UML 语法（子集）和一个 ANTLR Lexer/Parser，其规则如下：

```
 // Parser Rules

    model
    :   'MODEL' IDENTIFIER list_dec
    ;

    list_dec
    :   declaration*
    ;

    declaration
    :   class_dec ';' 
    |   association ';' 
    |   generalization ';'
    |   aggregation ';'
    ; 

    class_dec
    :   'CLASS' IDENTIFIER class_content
    ;

    ...

    association
    :   'RELATION' IDENTIFIER 'ROLES' two_roles
    ;

    two_roles
    :   role ',' role
    ;

    role
    :   'CLASS' IDENTIFIER multiplicity
    ;

    ... 
```

我希望“角色”规则仅允许 IDENTIFIER 令牌与现有类 IDENTIFIER 匹配。换句话说，如果给定一个输入文件并在其上运行词法分析器/解析器，那么所有引用的类（例如关联规则中的 IDENTIFIER）都应该存在。问题是一个类在运行时可能（还）不存在（它可以在文件中的任何地方声明）。最好的方法是什么？

提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:30:31.640

这可能最好*在*解析后完成。解析器为您创建某种树，然后您遍历树并收集有关已声明类的信息，然后再次遍历它以验证`role`树/规则。

当然，有些事情可以通过一些自定义代码来完成：

```
grammar G;

options {
  ...
}

@parser::members {
  java.util.Set<String> declaredClasses = new java.util.HashSet<String>();
}

model
:   'MODEL' IDENTIFIER list_dec
;

...

class_dec
:   'CLASS' id=IDENTIFIER class_content 
    {
      declaredClasses.add($id.text);
    }
;

...

role
:   'CLASS' id=IDENTIFIER multiplicity
    {
      if(!declaredClasses.contains($id.text)) {
        // warning or exception in here
      }
    }
;

... 
```

## 编辑

或使用自定义方法：

```
@parser::members {
  java.util.Set<String> declaredClasses = new java.util.HashSet<String>();

  void addClass(String id) {
    boolean added = declaredClasses.add(id);
    if(!added) {
      // 'id' was already present, do something, perhaps?
    }
  }

  void checkClass(String id) {
    if(!declaredClasses.contains(id)) {
      // exception, error or warning?
    }
  }
}

...

class_dec
:   'CLASS' id=IDENTIFIER class_content {addClass($id.text);}
;

role
:   'CLASS' id=IDENTIFIER multiplicity {checkClass($id.text);}
; 
```

# math - 如何获得矩阵对角线长度？

> ID：14863280
> 
> 赞同：1
> 
> 时间：2013-02-13T21:15:38.993
> 
> 标签：math, matrix

有没有一个公式可以让我得到矩阵的对角线长度（以单位为单位）？例如，如果矩阵为 3x3，则对角线长度为 3。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T21:19:03.863

The diagonal of an NxN matrix is always N.

The diagonal of a non-square matricies is `min(nrows, ncols)`.

Matricies can have units (e.g. stiffness matrix in finite elements for mechanics has physical units of force/length), but I'm not sure how you mean it.

# c# - 在 log4net 中将控制台附加程序添加到 Windows 窗体

> ID：14863282
> 
> 赞同：1
> 
> 时间：2013-02-13T21:15:41.673
> 
> 标签：c#, log4net

是否可以将控制台添加到基于表单的 C# 应用程序？目前当我做类似的事情时

```
Console.WriteLine("testing"); 
```

它出现在 VS2010 的输出窗口中。我想知道是否可以将控制台附加到我的 Windows 窗体应用程序。以便输出出现在控制台中。

编辑：看起来我的第一个问题有点误导，它并没有准确说明我想要完成的事情。我刚刚在我的应用程序中添加了一个控制台，使用

```
 [DllImport("kernel32")]
    static extern int AllocConsole(); 
```

然而，我真正想要的是 log4net 控制台附加程序的输出显示在那个没有发生的控制台中。我的附加程序的 xml 是

```
 <appender name="ColoredConsoleAppender" type="log4net.Appender.ColoredConsoleAppender">
    <mapping>
      <level value="INFO" />
      <foreColor value="White" />
      <backColor value="Red, HighIntensity" />
    </mapping>
    <layout type="log4net.Layout.PatternLayout">
      <conversionPattern value="%class %date - %message %newline" />
    </layout>
  </appender> 
```

现在当我去喜欢

```
 log.info("Some log"); 
```

它仍然不会在新添加的控制台窗口中显示它。关于我如何做到这一点的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-26T18:01:49.207

只是把它扔在那里，请确保`AllocConsole()` ***在***加载 log4net 配置之前。我尝试做与您的问题类似的事情，并且在将电话转移到`AllocConsole`. 一旦我移动它，log4net 就会自动写入我分配的控制台。

本质上......（记住做所有不包括在这里的常规错误检查）......

```
using System;
using System.Runtime.InteropServices;
using System.Windows.Forms;
namespace SampleApp
{
    class Program
    {
        [DllImport("kernel32.dll", SetLastError=true, CallingConvention=CallingConvention.Winapi)]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool AllocConsole();

        [DllImport("kernel32.dll", SetLastError=true, CallingConvention=CallingConvention.Winapi)]
        [return: MarshalAs(UnmanagedType.Bool)]
        private static extern bool FreeConsole();

        [STAThread]
        private static void Main(string[] args)
        {
            // (1) Make sure we have a console to use.
            Program.AllocConsole();
            try {
                // (2) Tell log4net to configure itself according to our app.config data.
                log4net.Config.XmlConfigurator.Configure();
                // (3) Usual WinForms startup code here.
                Application.EnableVisualStyles();
                Application.SetCompatibleTextRenderingDefault(false);
                Application.Run(new SampleApp.Form1());
            } catch ( Exception ) {
                // WAT!
            }
            // (4) Remember to release the console before we exit.
            Program.FreeConsole();
        }
    }
} 
```

不是 100% 确定为什么在分配控制台时会有所不同，但这确实为我解决了问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:20:12.170

Just make your project a console application and create/show a form from the console application rather than the other way around.

# hbase - 如何使用 HBASE Shell 创建具有预拆分和压缩或其他选项的表

> ID：14863285
> 
> 赞同：11
> 
> 时间：2013-02-13T21:15:50.913
> 
> 标签：hbase

在 HBase shell 中，帮助文件向我们展示了创建表的几种允许语法：

```
 create 'tableName', {NAME => 'colFamily', VERSIONS => 5 }
 create 'tableName', {NAME => 'cf1'}, {NAME => 'cf2'}
 create 'tableName', 'cf1', 'cf2', 'cf3'
 create 'tableName', 'cf1', {SPLITS => ['10','20','30','40']} 
```

我想创建一个表，在其中指定拆分和一些表选项，例如 COMPRESSION => 'SNAPPY' 和 VERSIONS，但我似乎无法弄清楚语法或找到有用的文档。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-02-13T21:15:50.913

经过实验最终清楚的是，Shell 语法将接受一组列族字典，而 SPLIT 字典实际上是它自己的动物（这很有意义，因为它修改了整个表，而不仅仅是特定的列族。

所以另一个有用的例子是：

```
 create 'tableName', {NAME => 'colFam', VERSIONS => 2, COMPRESSION => 'SNAPPY'}, 
    {SPLITS => ['333','666','FOO']} 
```

请注意，拆分字典与列族字典是分开的；大概我们仍然可以输入一组列族，然后以拆分字典结束。

# java - Junit 和 java 类。

> ID：14863289
> 
> 赞同：1
> 
> 时间：2013-02-13T21:16:04.897
> 
> 标签：java, design-patterns, junit

下面是一个简单的 java 类文件，用于检查用户提供的文件是否在主目录下。当文件不在主目录下时，它会引发异常。

```
public class A {
  public static void main(String args[]) {
     if (new A().processArgs(args[0]) {
        throw Exception("Not under home directory");
     }
  }

  // A simple method to check if the file is at home directory
  private boolean processArgs(String s) {
    File f = new File(s);
    String userHome = System.getProperty("user.home");
    if (s.startsWith(userHome) && f.exists() && additionalLogic())
      return true;  
    else
      return false;
  }
  // Additional business Logic
  private boolean additionalBusinessLogic() {
    // Do wonderful things.
  }
} 
```

我想编写一个简单的 Junit 测试用例来测试 java 类。测试的主要关注点是附加的业务逻辑方法。有没有办法可以绕过检查目录必须在用户主目录下的位置。

我不愿意在我的主类中添加逻辑以使其了解 Junit 类。有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:52:27.207

虽然 fab 的解决方案没有问题，但我决定再写一个：

```
public class Main {
    public static void main(String args[]) {
        // TODO: Should check args length
        Validator validator = new Validator();
        validator.validateArgs(args[0]);
    }
}

public interface Configuration {
    public String getHomeDirectory();
}

public class DefaultConfiguration implements Configuration {
    public String getHomeDirectory() {
        String home = System.getProperty("user.home");
        if (home == null) {
            throw new RuntimeException("User home directory is not set!");
        }
        return home;
    }
}

public class Validator {
  private Configuration configuration;

  public Validator() {
     this(new DefaultConfiguration());
  }

  public Validator(Configuration configuration) {
     this.configuration = configuration;
  }

  // A simple method to check if the file is at home directory
  public void validateArgs(String s) {
    File f = new File(s);
    if (!s.startsWith(configuration.getHomeDirectory()) || !f.exists() || !additionalBusinessLogic())
      throw new RuntimeException("Not under home directory!");
  }

  // Additional business Logic
  private boolean additionalBusinessLogic() {
     // TODO...
     return true;
  }
}

public class ValidatorTest {
  @Test
  public void validateValidArgsTest() {
     final String homeDirectory = ".."; // TODO
     String existingFile = homeDirectory + ".."; // TODO
     new Validator(new Configuration() {
       public String getHomeDirectory() {
          return homeDirectory;
       }
     }).validateArgs(existingFile);
  }

  @Test(expected = RuntimeException.class)
  public void validateInvalidArgsTest() {
     String existingFile = ".."; // TODO
     new Validator(new Configuration() {
       public String getHomeDirectory() {
          return "-INVALID PATH-";
       }
     }).validateArgs(existingFile);
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:24:07.147

您不需要让班级*知道*测试以使其更具*可测试*性。您只需要将附加逻辑与 i/o 内容分离，这也将带来更好的设计：

```
public class A {
  private WonderfulThingsDoer wonderfulService;

  public void main(String args[]) {
     wonderfulService = new WonderfulThingsDoer();
     if (processArgs(args[0]) {
        throw Exception("Not under home directory");
     }
  }

  // A simple method to check if the file is at home directory
  private boolean processArgs(String s) {
    File f = new File(s);
    String userHome = System.getProperty("user.home");
    if (s.startsWith(userHome) && f.exists() && additionalBusinessLogic())
      return true;  
    else
      return false;
  }
  // Additional business Logic
  private boolean additionalBusinessLogic() {
    return wonderfulService.doWonderfulThings();
  }
}

public class WonderfulThingsDoer {
  public boolean doWonderfulThings() {
    // Do wonderful things.
    return true;
  }
} 
```

瞧，提取了一个可测试的单元。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T22:05:51.310

不要硬编码“user.home”

创建一个您在单元代码中更改的字段主目录，以指向测试目录：

```
public class A {

      private static String homeDir;
      protected static void setHomeDir(String home) {
        this.homeDir = home;
      }    

      public static void main(String args[]) {
         if (homeDir == null) {
              homeDir = System.getProperty("user.home");
         }
         A a = new A();
         if (a.processArgs(args[0]) {
            throw new InvalidArgumentException("Not under home directory");
         }
      }

      // A simple method to check if the file is at home directory
      protected boolean processArgs(String s) {
        File f = new File(s);

        if (s.startsWith(A.homeDir) && f.exists() && additionalLogic())
          return true;  
        else
          return false;
      }
      // Additional business Logic
      private boolean additionalBusinessLogic() {
        // Do wonderful things.
      }
    } 
```

现在在单元测试中，将 homeDir 设置为您的测试目录

```
public void testMainHomeExisting() {
    A a = new A;
    String home = "./testdata/";
    A.setHomeDir(home);
    String[] args = new String[]{home}; // hope this compiles otherwise fix it
    // no assert needed here, if test fails, an Exception is thrown
    A.main(args);
} 
```

现在是不存在的家庭测试用例

```
public void testMainHomeNotExisting() {
    A a = new A;
    String home = "./notExistingFooBarFooFoo/";
    A.setHomeDir(home);
    String[] args = new String[]{home}; // hope this compiles otherwise fix it
    // no assert needed here, if test fails, an Exception is thrown
    try {
       A.main(args);
       // if code works the next line should not be reached:
       fail("Expected IllegalArgumentException");
    } catch (IllegalArgumentException ex) {
       // as expected got IllegalArgumentException
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:18:59.700

Just make a `Test` for the core business method `additionalBusinessLogic` only. You don't need to call `main`.

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T21:19:03.010

I see no reason to call `main`.

When you're writing a unit test, you want them to be modular enough to call without relying too much on external methods - and what you can't call you can mock, using something like [EasyMock](http://www.easymock.org/), [PowerMock](http://code.google.com/p/powermock/) or [Mockito](http://code.google.com/p/mockito/).

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-13T21:28:52.260

我会更改您要测试的方法...

1.  删除[访问修饰符](http://docs.oracle.com/javase/tutorial/java/javaOO/accesscontrol.html)
2.  传入`File`您需要能够执行逻辑的变量

`boolean additionalBusinessLogic(File f)`

这将允许同一包中的测试类调用该方法。如果您将其保留为私有，则其他类将无法调用它。

一旦你可以调用你想要测试的方法，测试类就很容易了......

```
public class MyClassTest {
    @Test
    public void additionalBusinessLogic_shouldFoo_whenSomeCondition() {
        // setup
        A a = new A();
        File mockFile = mock(File.class);
        // other setup stuff

        // execute
        boolean result = a.additionalBusinessLogic(mockFile);

        // assert
        // verify whatever you need to
    }
} 
```

对于一个好的模拟框架，我建议[Mockito](http://code.google.com/p/mockito/)。

# r - 安静地停止 R 脚本并将控制权返回给终端

> ID：14863291
> 
> 赞同：1
> 
> 时间：2013-02-13T21:16:12.067
> 
> 标签：r

我经常从带有`source('my_script.r')`. 我希望能够在我的脚本中使用一个语句，在我键入它的任何地方安静地终止脚本的执行，并将控制权返回给终端，在那里我可以检查我的变量。

[该线程](https://stackoverflow.com/questions/3512175/how-to-stop-a-r-script)的答案建议使用

```
q() 
```

或者

```
stop() 
```

停止 R 脚本，但`q()`退出会话，并`stop()`引发异常并且不安静（特别是如果我有类似`options(error=traceback)` 激活的东西，因为它强制 R 打印调用堆栈）。

有没有办法安静地停止脚本的执行并用一个简短的命令将控制权返回给 R 终端？

# java - SSH 输出始终为空

> ID：14863297
> 
> 赞同：3
> 
> 时间：2013-02-13T21:16:49.217
> 
> 标签：java, android, ssh, outputstream, jsch

几个小时以来，我一直试图找出这个问题，但我似乎无法弄清楚。我正在尝试使用 JSch 从 Android 手机通过 SSH 连接到 Linux 计算机。这些命令总是可以正常工作，但通道的输出通常是空的。有时它会显示输出，但大多数时候不会。这是我在网上找到的代码。

```
 String userName = "user";
       String password = "test123";
       String connectionIP = "192.168.1.13";

       JSch jsch = new JSch();
       Session session;
       session = jsch.getSession(userName, connectionIP, 22);
       session.setPassword(password);

       // Avoid asking for key confirmation
       Properties prop = new Properties();
       prop.put("StrictHostKeyChecking", "no");
       session.setConfig(prop);
       session.connect();

       // SSH Channel

       ChannelExec channelssh = (ChannelExec) session.openChannel("exec");      
       ByteArrayOutputStream baos = new ByteArrayOutputStream();
       channelssh.setOutputStream(baos);

       // Execute command
       channelssh.setCommand("ls");
       channelssh.connect();        
       channelssh.disconnect();

       RESULT = baos.toString(); 
```

RESULT 通常为空。如果我将命令更改为 mkdir 或类似的东西，文件会显示在 Linux 计算机上，这让我相信命令部分工作正常。问题似乎出在 ByteArrayOutputStream 中。我还通过终端在另一台计算机上测试了 connectionip、用户名和密码，所以我知道凭据是正确的。我已经用谷歌搜索了这个问题，任何输入都会对我有很大帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T20:58:51.680

找到了我正在阅读错误流的答案。这是其他有此问题的人的正确代码。

```
 InputStream inputStream = channelssh.getInputStream(); 

       BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(inputStream));

       StringBuilder stringBuilder = new StringBuilder();

       String line;

       while ((line = bufferedReader.readLine()) != null) 
       {

           stringBuilder.append(line);
           stringBuilder.append('\n');

       }

       return stringBuilder.toString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T06:18:08.243

exec-channel 将在另一个线程上运行，因此您需要在调用 Channel#disconnect() 之前等待其终止。

# ruby-on-rails-3 - ruby 应用程序中的功能和步骤定义/规范的顺序？（导轨）

> ID：14863298
> 
> 赞同：0
> 
> 时间：2013-02-13T21:16:53.067
> 
> 标签：ruby-on-rails-3, rspec, cucumber, bdd

我是 Rails、黄瓜和 rspec 的新手。为了帮助学习这三个方面，我已经开始构建一个需要登录的实际应用程序。

对于从哪里开始并确认我走在正确的道路上，我将不胜感激。

我从 2 个功能文件开始。但是，我已经在这个阶段停止了，因为我想知道“登录”功能（尽管应用程序的核心方面，因为他们不能在没有登录的情况下做任何事情）应该出现在其他资产和模型之后，例如他们登录时管理的事情。

那么，哪个会先出现？登录功能或他们管理的模型的功能？

示例功能文件：

```
Feature: User loads application

  As a user
  I want be able to load the application
  So that I can manage my files

  Scenario: Load application
    Given I am not yet using the application
    When I visit the application
    Then I should see "Welcome to app" 
```

登录功能文件：

```
Feature: User logs in

  As a user
  I want be able to login
  So that I can manage my private files

  Scenario: Successful login
    Given the user "Username" has an account
    When they login
    Then they should see "You have logged in successfully" 
```

我是否应该从他们实际用作应用程序要点的功能开始？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T12:32:58.790

您实现功能的顺序是一项*业务决策*。是从登录过程开始还是从其他功能开始取决于每个功能所带来的业务价值。

为了帮助您找出从哪里开始，您需要向利益相关者提问。这里有一些例子：

*   *我们可以在没有用户身份验证的情况下构建功能 A 吗？*
*   *此时我们是否绝对需要用户身份验证？*
*   *让我们考虑一下我们只有一个资源来构建一个单一的功能，现在最有价值的是什么：登录或功能 A？*

在身份验证之前构建*功能 A**可能*是一个很好的策略，因为您可以将功能公开给测试用户并更早地对其进行改进。或者，它对您的特定项目毫无意义，您希望身份验证在其他任何事情之前准备好。

现在，要评论您的特定场景，您使用的样式非常好。

我有一种感觉（我可能错了）*用户加载应用程序*功能虽然不是真的有用。作为用户，您是否关心“欢迎使用应用程序”的消息？这个场景看起来像一个功能前设置测试，作为开发人员，您希望拥有它来启动开发过程。但似乎（我可能又错了）告诉任何关于应用程序行为的有用信息。

这可以封装在 Cucumber 特性后面，描述系统的一些**实际**预期行为（如登录过程或将项目添加到购物车或阅读博客文章，无论与您的域相关）。

# php - 将产品 ID 添加到 WHMCS 发票

> ID：14863299
> 
> 赞同：0
> 
> 时间：2013-02-13T21:16:58.093
> 
> 标签：php, mysql, arrays, whmcs

我正在尝试在 WHMCS 的发票中添加产品 ID，但似乎没有任何效果。这是我现在对该行代码的内容：

```
<span class="title">{$LANG.invoicenumber}{*{else}{$LANG.proformainvoicenumber}{/if}*}{$invoicenum} - Service ID #{$invoiceitems.relid}</span><br /> 
```

这就是我添加的部分，但不起作用：

```
 - Service ID #{$invoiceitems.relid} 
```

当我运行调试以查看与使用不同的变量时，它表明`{$invoiceitems}`可用于显示如下项目：

```
Array (2)
0 => Array (6)
  id => 1830
  type => Hosting
  relid => 801
  description => My Hosting Services - dsdjsjd....
  amount => $295.00 USD
  taxed =>
1 => Array (6)
  id => 1831
  type => PromoHosting
  relid => 801
  description => Promotional Code: FREETRIAL - $0.01 U...
  amount => $-294.99 USD
  taxed => 
```

我想要得到的是数字 801，以便该行显示如下：

**发票 #7691 - 服务 ID #801**

任何帮助将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-22T15:24:03.970

在 Invoice # 之后添加以下代码：

```
{if $invoiceitems|@count > 0}
Service ID: #{$invoiceitems[0].relid}
{/if} 
```

在输出服务 ID 之前，您可能需要检查 $invoiceitems[0].type 是否是域或托管。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T18:02:40.340

`{$invoiceitems}`是模板页面上的整个项目数组。因此，当您尝试到达 by 时`{$invoiceitems.relid}`，不会给出任何结果，因为您需要`{$invoiceitems}`通过索引获取数组中的项目，然后您才能到达名为 relid 的属性。

我认为数组内的迭代将解决您的问题。

```
{foreach key=num item=singleitem from=$invoiceitems}
   {$singleitem.relid} // here you can reach the property.
{/foreach } 
```

# c# - linq-sql 中的安全查询？

> ID：14863301
> 
> 赞同：4
> 
> 时间：2013-02-13T21:17:02.857
> 
> 标签：c#, asp.net, linq

我有以下查询：

```
 dat =
from s in dat
orderby s.Schedule.Employee.EmployeName ascending
select s; 
```

问题是`Schedule`或`Employee`可能是`null`，在这些情况下，它应该只显示第一个或最后一个，我不在乎。

有没有办法做到这一点？目前它在`null`.

用于对网格视图进行排序：

```
[NullReferenceException: Object reference not set to an instance of an object.]
   KezberProjectManager.Cases.<gvCases_Sorting>b__8(Case s) in C:\Users\jlarouche\documents\visual studio 2010\Projects\KezberProjectManager\KezberProjectManager\Cases.aspx.cs:103
   System.Linq.EnumerableSorter`2.ComputeKeys(TElement[] elements, Int32 count) +88
   System.Linq.EnumerableSorter`1.Sort(TElement[] elements, Int32 count) +21
   System.Linq.<GetEnumerator>d__0.MoveNext() +178
   System.Web.UI.WebControls.GridView.CreateChildControls(IEnumerable dataSource, Boolean dataBinding) +1698
   System.Web.UI.WebControls.CompositeDataBoundControl.PerformDataBinding(IEnumerable data) +67
   System.Web.UI.WebControls.GridView.PerformDataBinding(IEnumerable data) +14
   System.Web.UI.WebControls.DataBoundControl.OnDataSourceViewSelectCallback(IEnumerable data) +123
   System.Web.UI.DataSourceView.Select(DataSourceSelectArguments arguments, DataSourceViewSelectCallback callback) +33
   System.Web.UI.WebControls.DataBoundControl.PerformSelect() +138
   System.Web.UI.WebControls.BaseDataBoundControl.DataBind() +30
   System.Web.UI.WebControls.GridView.DataBind() +4
   KezberProjectManager.Cases.gvCases_Sorting(Object sender, GridViewSortEventArgs e) in C:\Users\jlarouche\documents\visual studio 2010\Projects\KezberProjectManager\KezberProjectManager\Cases.aspx.cs:138
   System.Web.UI.WebControls.GridView.OnSorting(GridViewSortEventArgs e) +122
   System.Web.UI.WebControls.GridView.HandleSort(String sortExpression, SortDirection sortDirection) +65
   System.Web.UI.WebControls.GridView.HandleSort(String sortExpression) +78
   System.Web.UI.WebControls.GridView.HandleEvent(EventArgs e, Boolean causesValidation, String validationGroup) +497
   System.Web.UI.WebControls.GridView.RaisePostBackEvent(String eventArgument) +205
   System.Web.UI.WebControls.GridView.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +13
   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +9642898
   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1724 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:22:08.540

您需要`null`在访问属性之前检查：

```
var x = from s in dat
        let s = s.Schedule
        let e = s == null ? null : s.Employee
        orderby e == null ? null : e.EmployeeName ascending
        select s; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:22:38.033

像这样的东西？

```
dat =
    from s in dat
    orderby 
       s.Schedule == null ? "" : 
       s.Schedule.Employee == null ? "" : 
       s.Schedule.Employee.EmployeName ascending
    select s; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:23:15.443

那么为什么不使用 if 条件来检查这些对象中的空值并在那里处理呢？我猜这里最大的问题是它们是否应该为空？如果是这样，听起来应该阻止此代码在应用程序中进一步运行。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-13T21:21:07.977

您有`FirstOrDefault()`,`LastOrDefault()`和`DefaultIfEmpty()`方法来解决这种情况。

# javascript - _.each 上下文变量

> ID：14863302
> 
> 赞同：3
> 
> 时间：2013-02-13T21:17:03.080
> 
> 标签：javascript, underscore.js

对于许多 underscore.js 函数，我不了解上下文变量的用途。它有什么用途。我知道它在迭代器回调中绑定了“this”，但我不了解它的实际应用。

```
var context = {'a': 'a'};
_.each([1, 2, 3], function(element, index, list)
{
    console.log(this);
    console.log(element);
    console.log(index);
    console.log(list);
}, context); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:28:03.973

下划线`_.each`看起来像这样：

`_.each(list, iterator, [context])`

当您的迭代器是您创建的某个对象的成员，并且您希望在对象而不是窗口的范围内执行该函数时，上下文非常有用。如果您用作迭代器的预先编写的函数用于`this`引用 Object 的实例（通常是这种情况），则在没有上下文的情况下调用该函数将导致`this`引用错误的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:28:50.150

如果您的*迭代器*函数类似于对象上的*方法*，这将很有用：

```
var context = {'a': 'a',  foo: function(x) { console.log( this.a + x); }};
_.each([1, 2, 3], context.foo, context); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:33:44.890

当您不需要更改上下文时，它真的很有帮助，不要忘记它的硬依赖兄弟 Backbone。

```
var Collection = Backbone.Collection.extend({
//..
    _toggleActive: function (model, state) {
        model.set({
            active: state
        });
    },
    deactivateAll: function () {
        // analog _.each(this.models , func, [context])
        this.each(function (model) {
            // call the method of collection from context
            this._toggleActive(model, false);
        }, this);
    }
//..
}); 
```

或者只是为了调试

```
_.each([1,2,3], function(item, i, arr){
    this.log(item, i);
}, console); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-15T17:16:19.327

截至版本，下划线中约有 21 个函数接受“上下文”作为最后一个可选参数。

_.each(list, iteratee(element, index, list), [context])

迭代一个元素列表，依次将每个元素生成一个 iteratee 函数。如果传递了一个，则迭代对象绑定到上下文对象。

```
var array_1 = ['asdf', 'ghjk', 'lzxc', 'vbnm', 'qwer', 'tyui', 'op'];
var array_2 = [1,0,2,9,3,8,4,7,5,6];

_.each(array_1, function(element, index, list){
    console.log(this.length - index + " - " + this[this.length - index]);
}, array_2); 
```

将输出

```
1 - asdf
0 - ghjk
2 - lzxc
9 - vbnm
3 - qwer
8 - tyui
4 - op 
```

这对应于上下文数组array_2。

# android - 从 Android 中的默认电子邮件提供商获取未读电子邮件的数量

> ID：14863303
> 
> 赞同：2
> 
> 时间：2013-02-13T21:17:07.033
> 
> 标签：android, email

基本上就是标题所说的。我想获得未读电子邮件的数量，这样我就可以把它扔到一个小徽章上。Gmail 很受欢迎，但不是每个人都使用它，所以我想用默认的 android 电子邮件帐户聚合器应用程序来做。它不必在 api v15 之前的设备上工作。

有人知道吗？

# java - 获取完整的用户名站点管理员

> ID：14863307
> 
> 赞同：2
> 
> 时间：2013-02-13T21:17:18.710
> 
> 标签：java, web-services, gwt-ext, siteminder

我们正在使用 GWT-EXT 框架，因此我需要在工具栏上显示登录用户的完整用户名。

我可以通过自定义 Web 服务（在 jars 中）的请求对象检索用户 ID，但我看不到任何可以给我完整用户名的方法。

我对这个定制的框架一无所知，因为一切都在罐子里，对开发人员来说是令人沮丧的不透明。

我搜索了几个链接，发现它是 Siteminder 代理，当它被重定向到 Web 应用程序时，它将注入带有键值对的标头，该键值对在请求对象中包含用户信息。现在的问题是我怎么知道给我一个完整用户名的标题是什么。

另一部分是知道我如何覆盖框架 servlet/创建我自己的 servlet 以至少检索这个完整的标头。

我知道这确实是一个模糊的问题，因为即使我正在对整个工作流程进行自我教育并让我的大脑感到困惑。

非常感谢任何想法或建议或建议！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:18:42.573

我不确定你的设置。Siteminder 代理默认不返回登录的用户名。验证成功后，需要指示 Siteminder 策略服务器在响应标头中返回所需的值。Siteminder 管理员应该能够帮助您进行此配置。

# c - 通过 C 中的管道读/写

> ID：14863308
> 
> 赞同：4
> 
> 时间：2013-02-13T21:17:23.843
> 
> 标签：c, fork, pipe

我今天开始在 C 中使用 pipe() 和 fork() 和 exec()，现在我遇到了一个问题：

主程序，创建两个管道和分叉。子进程对另一个程序执行 exec()，该程序现在只是一个测试程序，它从标准输入读取，与其父进程通信并通过标准输出写入结果。主程序应该接收数据，与 SQLite 3 数据库通信并使用管道返回数据。这部分问题解决了，管道打开和关闭正常，并且有通信。

那么问题是，在某个点的子进程（用 exec() 调用的那个）中，我有这个：

```
printf("Strid sent: %s\n", strid);
write(4,strid,sizeof(strid));

printf("Str sent: %s\n", str);
write(4,str,sizeof(str)); 
```

父母应该正确阅读这部分内容：

```
read(select[0],strid, sizeof(strid));
printf("Strid recived: %s\n",strid);
int id = atoi(strid);
printf("Id recived: %d\n",id);

read(select[0],buffer, sizeof(buffer));
printf("Buffer recived: %s\n",buffer); 
```

但是我收到的那些 printf 是：

```
Strid sent: 1
Str sent: start
Strid recived: 1
Id recived: 1
Buffer recived: 7� (and other strange characters) 
```

如您所见，问题在于接收第二个命令（并且该部分按原样复制，其中没有其他代码）。

我也不得不说，接收 str 的“buffer”变量被声明为 char buffer[20] 并且在 read() 之前没有被使用过

先感谢您！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:26:58.083

阅读后，您需要`0`在最后添加终止字节，然后再打印，例如

```
int len = read(select[0], buffer, sizeof(buffer) - 1);
if (len < 0) {
    perror("read error");
} else {
    buffer[len] = 0;
    printf("Buffer recived: %s\n", buffer);
} 
```

所以，重要的是，在使用之前通读任何函数的[手册页`read`](http://linux.die.net/man/2/read)，或者实际上是手册页......

或者，使用一些*stdio.h*函数，它会添加自己终止的字符串`0`，可能[`fgets`](http://linux.die.net/man/3/fgets)如果逐行读取是可以的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:49:41.397

管道不跟踪写入之间的“边界”。因此，如果您在管道上进行了多次写入，则来自这些写入的所有数据可能会返回以响应一次读取。因此，如果您发送一个字符串（例如）后跟一个整数，并且您尝试将字符串读入缓冲区，它会将字符串和后面的整数整数都放入缓冲区，看起来像字符串末尾的垃圾, read 返回的大小会更大。

此外，如果管道已满，则写入可能不会写入您要求它写入的所有数据——它可能只写入目前可以容纳的量，而您必须稍后再写入其余的数据。

`read`因此，请始终检查您的和调用的返回值，`write`并准备好处理`read`比您预期的要少（或多于）的情况。

# templates - 锂框架模板零件

> ID：14863309
> 
> 赞同：0
> 
> 时间：2013-02-13T21:17:24.660
> 
> 标签：templates, lithium

所以这是我的问题：

如何使用模板部件？我的意思是像 navbar.html.php 这样的单个文件，我会在布局和传递参数中包含这些文件。

我做了一些研究，但没有发现太多关于它的...

感谢阅读/帮助 =D

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T01:42:33.957

这已添加到手册中，但请参阅[如何在锂框架](https://stackoverflow.com/questions/14698748/how-to-include-view-in-lithium-framework)中为 anwser 包含视图。如果您需要更多信息，请询问！

# javascript - 如何使用 jQuery 仅包装元素内容的一部分？

> ID：14863312
> 
> 赞同：0
> 
> 时间：2013-02-13T21:17:42.580
> 
> 标签：javascript, jquery

当我有元素和普通文本时，如何包装内容的一部分？我已经尝试过`.after()`，但这会自动添加一个结束标签。

我有这个：

```
<div class="block">
    <a href="#">example 1</a>
    .
    <a href="#">example 1</a>
    .
    <a href="#">example 1</a>
    .
    <a href="#">example 1</a>
</div> 
```

我必须将其转换为：

```
<div class="block">
    <a href="#">example 1</a>
    <div class="wrap">
        .
        <a href="#">example 1</a>
        .
        <a href="#">example 1</a>
        .
        <a href="#">example 1</a>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:25:29.860

```
$('.block').contents().filter(function(){
   return $(this).index() > 0;
}).wrapAll('<div class="wrap"></div>'); 
```

[http://jsfiddle.net/uhzsN/](http://jsfiddle.net/uhzsN/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:21:23.310

其他答案更清晰，而这给了你一些特殊性

```
var target = $($(".block a").slice(1)); // drop 1st
var container = $("<div class='wrap' />");
container.insertBefore($(target[0]));
target.each(function () {
    $(this).appendTo(container);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:25:01.947

```
$('.block a:gt(0)').wrapAll('<div class="wrap" />'); 
```

# vim - 在 Vim 中突出显示搜索而不是替换？

> ID：14863315
> 
> 赞同：8
> 
> 时间：2013-02-13T21:17:53.193
> 
> 标签：vim

我知道可以阻止 Vim 在任何搜索中突出显示，但是有没有办法让它在常规搜索中突出显示，而不是例如替换？

我经常会突出显示一段文本，然后执行以下操作：

```
:s/^/#/ 
```

注释掉整个块。但是后来我的屏幕左侧上下有一个难看的黄色条，我`:noh`每次都必须清除它。

我希望突出显示保留在常规/搜索中。这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T21:32:10.250

这并不能完全回答您的问题，但对我来说有同样的问题有帮助：我添加了此命令以在搜索或搜索并替换后轻松停用突出显示

```
nnoremap <esc> :noh<return><esc> 
```

（来自[Vim clear last search highlighting](https://stackoverflow.com/questions/657447/vim-clear-last-search-highlighting)）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-05-25T14:12:43.987

我的解决方案：把它放在你的 vimrc 文件中

```
set nohlsearch

noremap * :set hlsearch<CR>:nohlsearch<CR>*
noremap / :set hlsearch<CR>:nohlsearch<CR>/
noremap ? :set hlsearch<CR>:nohlsearch<CR>?

nnoremap <F4> :set invhlsearch<CR>
inoremap <F4> <ESC>:set invhlsearch<CR>gi
nnoremap <CR> :set nohlsearch<CR> 
```

它能做什么：

1.  搜索总是启用亮点。
2.  用于`Enter`关闭突出显示直到下一次搜索，但不是下一次替换。再次按下`Enter`不会重新打开它们。
3.  用于`F4`关闭突出显示直到下一次搜索，但不是下一次替换。再次按下`F4`将切换最后一个搜索模式的突出显示——搜索或替换——如果有的话。

**关于从未真正解释清楚的亮点的一些注释：**
当该`'hlsearch'`选项打开时，所有未来的搜索/替换都将打开`"highlight visibility"`。current`"highlight visibility"`并不是一个你可以直接查询或独立设置的选项，但你可以通过命令独立关闭高亮可见性`:nohlsearch`（这与 不一样`:set nohlsearch`，因为下一次搜索将再次启用可见性）。

此外，每当您运行该命令时，都会`:set hlsearch`产生两种效果：它设置选项以及让 vim 忘记您是否曾经键入过`:nohlsearch`. 换句话说，改变`'hlsearch'`（开或关）将迫使电流`"highlight visibility"`在逻辑上匹配。

# mysql - Mysql查询将2个表中的列获取到一个结果集中

> ID：14863318
> 
> 赞同：0
> 
> 时间：2013-02-13T21:18:04.467
> 
> 标签：mysql, sql, join, union

我正在尝试创建一个查询，该查询显示 TableA 中的 a4、a2、a3 和 TableC 中由 b.b1 = 2 连接的所有项目的日期。输出应按日期降序按时间顺序排列。

```
TableA                 
___________________________________________
| a1   | a2   | a3   | a4   | a5   | a6   |
-------------------------------------------
| 1    |  222 | 333  | 444  | 555  | 665  |
-------------------------------------------
| 2    |  asd | sdf  | ert  | jkl  | xcv  |
-------------------------------------------
| 3    |  111 | tyu  | bnm  | abc  | xyz  |
-------------------------------------------
| 4    |  222 | yyy  | dfd  | hgg  | 544  |
-------------------------------------------  
| 5    |  222 | y56  | df5  | hg7  | 234  |
------------------------------------------- 

TableB
___________________
| b1  | b2  | b3  |
-------------------
| 1   | 717 | c   |
------------------- 
| 2   | 727 | d   |
------------------- 
| 3   | 737 | c   |
------------------- 
| 4   | 747 | d   |
------------------- 

TableC - c2 is foreign key to a.a1 - c3 is foreign key to b.b1
_____________________________
| c1  | c2  | c3  |  date   |
-----------------------------
| 1   | 2   | 2   |12-01-12 | 
-----------------------------
| 2   | 1   | 1   |12-05-12 | 
-----------------------------
| 3   | 5   | 2   |12-07-12 | 
-----------------------------
| 4   | 3   | 1   |12-14-12 | 
-----------------------------
| 5   | 4   | 2   |12-18-12 | 
----------------------------- 
```

它应该看起来像这样......

```
____________________________
| a4  | a2  | a3  |  date  |
----------------------------
| ert | 222 | 333 |12-01-12| 
----------------------------
| df5 | 222 | y56 |12-07-12| 
----------------------------
| dfd | 222 | yyy |12-18-12| 
---------------------------- 
```

我明白了，如果我将查询分成两部分，我会从两个表中获取信息，并且“UNION ALL”使我的日期在表的底部添加行（还有另外两列我不想要, c2 和 c1)，我实际上想要在我的结果中的 a3 旁边有一个名为 date 的列。如何将该列“日期”放入结果集中？

```
SELECT a.a4, a.a2, a.a3
FROM TableA a
JOIN TableC c ON c.c2 = a.a1
JOIN TableB b ON b.b1 = c.c3 and c.c3 = 2
UNION ALL
SELECT d.date,d.c2,d.c1 
From TableC d
JOIN TableB b ON b.b1 = d.c3 and d.c3 = 2 
```

请提出任何您需要的问题，这正在杀死我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:21:50.033

这里还有其他令人困惑的项目，但无需深入挖掘，这很容易：

```
SELECT a.a4, a.a2, a.a3, c.date
FROM TableA a
JOIN TableC c ON c.c2 = a.a1
JOIN TableB b ON b.b1 = c.c3 and c.c3 = 2 
```

`UNION`不做你认为它做了。

另外，是否需要加入表b？

```
SELECT a.a4, a.a2, a.a3, c.date
FROM TableA a
JOIN TableC c ON c.c2 = a.a1 and c.c3 = 2 
```

# asp.net-web-api - 你可以对 WebApi 使用 WcfTestClient 吗？

> ID：14863332
> 
> 赞同：0
> 
> 时间：2013-02-13T21:18:43.413
> 
> 标签：asp.net-web-api, wcftestclient

[This article](http://blogs.msdn.com/b/alexj/archive/2012/08/15/odata-support-in-asp-net-web-api.aspx)表明它是可能的，或者正在工作中，有一些代码表明它可以完成，但我无法弄清楚需要发生什么代码或WcfTestClient的uri需要是。

这是文章中的代码，让我觉得我可以做到：

```
// Metadata routes to support $metadata and code generation in the WCF Data Service client. 
configuration.Routes.MapHttpRoute( 
    ODataRouteNames.Metadata, 
    "$metadata", 
    new { Controller = "ODataMetadata", Action = "GetMetadata" } 
); 
```

这个功能实现了吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:50:42.683

不，它不能按您的意愿工作。WCF 测试客户端支持与基于**SOAP**的服务对话。当前版本不支持 OData。

当然，正如@Snixtor 所提到的，您*可以*使用 ASP.NET Web API 创建一个 SOAP 服务，包括对元数据 (WSDL) 的支持。但我真的不知道为什么有人愿意这样做。

# computational-geometry - Data structures and algorithms for adaptive "uniform" mesh?

> ID：14863336
> 
> 赞同：1
> 
> 时间：2013-02-13T21:18:58.823
> 
> 标签：computational-geometry

I need a data structure for storing float values at an uniformly sampled 3D mesh:

x = x0 + ix*dx where 0 <= ix < nx

y = y0 + iy*dy where 0 <= iy < ny

z = z0 + iz*dz where 0 <= iz < nz

Up to now I have used my Array class:

```
Array3D<float> A(nx, ny,nz);
A(0,0,0) = 0.0f; // ix = iy = iz = 0 
```

Internally it stores the float values as an 1D array with nx * ny * nz elements.

However now I need to represent an mesh with more values than I have RAM, e.g. nx = ny = nz = 2000.

I think many neighbour nodes in such an mesh may have similar values so I was thinking if there was some simple way that I could "coarsen" the mesh adaptively.

For instance if the 8 (ix,iy,iz) nodes of an cell in this mesh have values that are less than 5% apart; they are "removed" and replaced by just one value; the mean of the 8 values.

How could I implement such a data structure in a simple and efficient way?

EDIT: thanks Ante for suggesting lossy compression. I think this could work the following way:

```
#define BLOCK_SIZE 64
struct CompressedArray3D {
    CompressedArray3D(int ni, int nj, int nk) {
        NI = ni/BLOCK_SIZE + 1;
        NJ = nj/BLOCK_SIZE + 1;
        NK = nk/BLOCK_SIZE + 1;

        blocks = new float*[NI*NJ*NK];
        compressedSize = new unsigned int[NI*NJ*NK];
    }

    void setBlock(int I, int J, int K, float values[BLOCK_SIZE][BLOCK_SIZE][BLOCK_SIZE]) {
        unsigned int csize;
        blocks[I*NJ*NK + J*NK + K] = compress(values, csize);
        compressedSize[I*NJ*NK + J*NK + K] = csize;
    }

    float getValue(int i, int j, int k) {
        int I = i/BLOCK_SIZE;
        int J = j/BLOCK_SIZE;
        int K = k/BLOCK_SIZE;

        int ii = i - I*BLOCK_SIZE;
        int jj = j - J*BLOCK_SIZE;
        int kk = k - K*BLOCK_SIZE;

        float *compressedBlock = blocks[I*NJ*NK + J*NK + K];
        unsigned int csize = compressedSize[I*NJ*NK + J*NK + K];

        float values[BLOCK_SIZE][BLOCK_SIZE][BLOCK_SIZE];
        decompress(compressedBlock, csize, values);
        return values[ii][jj][kk];   
    }

    // number of blocks:
    int NI, NJ, NK;

    // number of samples:
    int ni, nj, nk;

    float** blocks;
    unsigned int* compressedSize; 
}; 
```

For this to be useful I need a lossy compression that is:

*   extremely fast, also on small datasets (e.g. 64x64x64)
*   compress quite hard > 3x, never mind if it looses quite a bit of info.

Any good candidates?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T18:14:47.223

听起来您正在寻找 LOD（细节级别）自适应网格。这是视频游戏和地形模拟中反复出现的主题。

对于地形，请参见此处：http: [//vterrain.org/LOD/Papers/](http://vterrain.org/LOD/Papers/) - 寻找 ROAM 视频，该视频不仅可以根据距离自适应，还可以根据视角方向进行自适应。

对于非地形实体，有大量工作（这里有一个示例：[通用自适应网格细化](https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch05.html)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-04T16:10:15.293

我建议使用[OctoMap](https://github.com/OctoMap/octomap)来处理大型 3D 数据。[并按此处](http://eugenfunk.wordpress.com/2013/09/02/3d-points-as-surfels/)所示对其进行扩展以处理几何属性。

# php - trying to build mysql query with counts and group by

> ID：14863341
> 
> 赞同：2
> 
> 时间：2013-02-13T21:19:08.013
> 
> 标签：php, mysql, sql, count, group-by

How can I build a query to do the following?

1.  Grouping by phonenumber
2.  Where That Grouping has over 5 different names

data fields: id, phonenumber, name

I've tried:

```
SELECT count(phonenumber), phonenumber, GROUP_CONCAT(name)
FROM list
group by phonenumber
having count(phonenumber) > 5 
```

but it's timing out, so not sure if that's the right format.

fake data:

```
id | phonenumber | name
1  | 555-5555    | joe
2  | 444-4444    | joe
3  | 555-5555    | joe
4  | 555-5555    | dan
5  | 555-5555    | Ben
6  | 555-5555    | Griff
7  | 555-5555    | Sam
8  | 555-5555    | Jim 
```

desired output:

```
count(phonenumber | phonenumber | GROUP
7                 | 555-5555    | joe, dan, Ben, Griff, Sam, Jim 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:40:54.570

看起来您的查询工作正常。这是[sqlfiddle](http://sqlfiddle.com/#!2/cc035/2)。

如果您只需要获取`DISTINCT`名称，那么您可以这样做

```
SELECT COUNT(phonenumber) AS `count`, 
       phonenumber, 
       GROUP_CONCAT(DISTINCT name) AS `names`
  FROM `list` 
 GROUP BY phonenumber 
HAVING COUNT(phonenumber) > 5 
```

这是[sqlfiddle](http://sqlfiddle.com/#!2/cc035/8)。

# jquery - 计算视差不透明度的定位元素百分比

> ID：14863346
> 
> 赞同：4
> 
> 时间：2013-02-13T21:19:28.700
> 
> 标签：jquery, scroll, parallax

我正在尝试计算一个百分比数（0.0 - 2.0/0% - 200%），以便可以更改 div 进出视图时的不透明度。

*   当窗口高于可视区域时，百分比等于或小于 0
*   当窗口位于可视区域的正中心时，百分比为 1.0
*   当窗口低于可视区域时，百分比为 2.0 及以上

在滚动进出视图时，它将是其中的一部分。

不知何故，我需要将窗口的垂直中心与区域的垂直中心进行比较，但我很难正确计算。

到目前为止我有

```
var p = {
    scrollTop: $(window).scrollTop(),
    documentHeight: $(document).height(),
    windowHeight: $(window).height(),
    contentTop: $('.content').position().top,
    contentHeight: $('.content').height()
};

if (p.windowHeight / 2 + p.scrollTop < p.contentHeight / 2 + p.contentTop) {

    p.percent = (p.windowHeight / 2 + p.scrollTop) / (p.contentHeight / 2 + p.contentTop);
}
else if (p.windowHeight / 2 + p.scrollTop > p.contentHeight / 2 + p.contentTop) {

    p.percent =  (p.windowHeight / 2 + p.scrollTop) / (p.contentHeight / 2 + p.documentHeight - p.contentHeight - p.contentTop);
}
else p.percent = 1;

$('.content').animate({
    opacity: 1 - Math.abs(p.percent - 1)
}, 1); 
```

但我没有考虑文档高度，所以我知道我遗漏了一些东西。我也觉得这可以在一个等式中完成，没有 if/else

这是我正在研究的一个不起作用的小提琴：http: [//jsfiddle.net/nxdTn/](http://jsfiddle.net/nxdTn/)

* * *

为了更好地演示，请参见下面的示例。

黄色是文档，透明灰色是窗口，蓝色是可视区域。

蓝色的不透明度为 0： ![在此处输入图像描述](../Images/06d45cc82caccd98dc67432229118e14.png)

在 100% 不透明度下： ![在此处输入图像描述](../Images/70e1bb9e9f4903e74e7cdd758f780188.png)

回到0： ![在此处输入图像描述](../Images/8373a7cd28863ffded7a3dd6d37ab811.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T00:07:06.297

有很多方法可以给猫剥皮，但我个人会尝试确定进入和退出窗口`scrollTop`时的值的一些界限`content`，然后只计算`scrollTop`' 相对于这些界限的位置。不需要中心点或文档的高度。

我必须对您的 CSS 进行的一项小改动是`content`从`body`. 边距被`content`视为其`position.top()`值为 0。

```
var p = {
    scrollTop: $(window).scrollTop(),
    windowHeight: $(window).height(),
    contentTop: $('.content').position().top,
    contentHeight: $('.content').height()
};

// determine scrollTop's bounds where content enters & exits the window
p.lowerBound = p.contentTop - p.windowHeight;
p.upperBound = p.contentTop + p.contentHeight;

// determine scrollTop's position percentage (x2) in relation to bounds
p.percent = (p.scrollTop - p.lowerBound) / (p.upperBound - p.lowerBound) * 2; 
```

你可以在这里看到一个工作演示：http: [//jsfiddle.net/GoranMottram/nxdTn/3/](http://jsfiddle.net/GoranMottram/nxdTn/3/)

希望它是你正在寻找的。

# sql - Symfony2 + Doctrine - 过滤

> ID：14863348
> 
> 赞同：2
> 
> 时间：2013-02-13T21:19:32.417
> 
> 标签：sql, symfony, doctrine-orm, query-optimization, dql

我有一种`OneToMany`关系，一支足球队有很多球员。我想列出所有足球队并显示每支球队队长的名字。

每个玩家实体都有一个外键（team_id）和一个设置为 0 或 1 的字段“队长”。我目前正在运行以下查询：

```
 $teams = $this
             ->getDoctrine()
             ->getRepository('FootballWebsiteBundle:Team')
              ->createQueryBuilder('t')
             ->setFirstResult(($pageNumber * $resultPerPage) - $resultPerPage)
             ->setMaxResults($resultPerPage)
             ->add('where','t.deleted = 0')
             ->add('orderBy', 't.name DESC')
             ->getQuery()->getResult(); 
```

然后，当我遍历树枝中的每个团队时，我运行 team.getTeamCaptain().getName() ，这是我的团队实体中的一个过滤器：

```
public function getTeamCaptain() {
    $them  = $this->players->filter(function($p) {
        return $p->getCaptain() == 1;
    });

    return $them->first();
} 
```

有没有更好的方法来运行这个查询？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T00:31:39.367

首先，您可能希望[获取并加入](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/dql-doctrine-query-language.html#joins)每个检索到的球队的球员，以避免在模板渲染期间延迟加载他们。这是 DQL：

```
SELECT
    t, p
FROM
    FootballWebsiteBundle:Team t
LEFT JOIN
    t.players p
WHERE
    t.deleted = 0
ORDER BY
    t.name DESC 
```

可以使用以下查询构建器 API 调用来构建：

```
 $teamsQuery = $this
         ->getDoctrine()
         ->getRepository('FootballWebsiteBundle:Team')
         ->createQueryBuilder('t')
         ->addSelect('p')
         ->leftJoin('t.players', 'p')
         ->add('where','t.deleted = 0')
         ->add('orderBy', 't.name DESC')
         ->getQuery() 
```

然后将此查询包装到一个[`Paginator`](http://docs.doctrine-project.org/en/latest/tutorials/pagination.html)对象中（因为在 fetch-joining`setMaxResults`时`setFirstResult` [不能信任](http://docs.doctrine-project.org/en/latest/reference/dql-doctrine-query-language.html#first-and-max-result-items-dql-query-only)）：

```
$paginator = new \Doctrine\ORM\Tools\Pagination\Paginator($teamsQuery, true);

$teamsQuery
     ->setFirstResult(($pageNumber * $resultPerPage) - $resultPerPage)
     ->setMaxResults($resultPerPage) 
```

在您看来，您可以像下面的伪代码一样迭代团队：

```
foreach ($paginator as $team) {
    echo $team->getTeamCaptain() . "\n";
} 
```

您还可以`getTeamCaptain`通过使用[`Selectable`API](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/reference/working-with-associations.html#filtering-collections)在您的方法中获得一些额外的性能：

```
public function getTeamCaptain() {
    $criteria = new \Doctrine\Common\Collections\Criteria();

    $criteria->andWhere($criteria->expr()->eq('captain', 1));

    return $this->players->matching($criteria)->first();
} 
```

这里的优势主要在关联`players`尚未初始化时相关，因为这将避免完全加载它。情况并非如此，但我认为这是一种很好的做法（而不是重新发明集合过滤逻辑）。

# php - hyperlink to retrieve data from a database

> ID：14863349
> 
> 赞同：1
> 
> 时间：2013-02-13T21:19:32.427
> 
> 标签：php, mysql, database, hyperlink

I have created a webpage using html/php which contains a form to collect informtaion which I am storing in a mysql database, each record in the database has the date stored automatically, I want to be able to retrieve this information from the database and display is on the webpage as a list of the dates and then I want to make each date a hyperlink so that when click it will show all the data stored in that form on that specific date.

so far I have been able to retrieve the list of the dates using the following (this works as i need it to) :

```
$query="SELECT Date FROM form";
$result=mysql_query($Query,$db);

while ($dbRow=mysql_fetch_array($Result)) 
 {
  $theDate=$dbRow["Date"];
  echo "$theDate<br>";
 } 
```

I can not figure out at all how to make each of these dates into a hyperlink... any advice anyone?? thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:23:51.703

**注意**不要**使用**函数`mysql_*`。它们在 PHP 5.5 中已被弃用，并且可能会从 PHP 的未来版本中删除。相反，请考虑PHP 中可用的[替代 MySQL 数据库接口，如](http://php.net/mysqlinfo.api.choosing)[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli)，它们**功能更丰富**且**维护良好**。

你需要`echo`输出所有你想要的 HTML。

```
$query = "SELECT Date FROM form";
$result = mysql_query($Query,$db);

while ($dbRow = mysql_fetch_array($Result)) 
{
    $theDate = $dbRow["Date"];
    echo "<a href='showDateInfo.php?date=$theDate'>$theDate</a><br>";
} 
```

我建议阅读 PHP 和 HTML 基础知识

# python - Dictionary value sorting

> ID：14863350
> 
> 赞同：2
> 
> 时间：2013-02-13T21:19:37.593
> 
> 标签：python, dictionary

I have a dictionary with tuples as keys (containing a string and an int) and floats as values. An example:

```
first = {}
first['monkey', 1] = 130.0 
first['dog', 2] = 123.0-
first['cat', 3] = 130.0
first['cat', 4] = 130.0
first['mouse', 6] = 100.0 
```

Now, I need to make a new dictionary, which has the original dictionary key's second element as it's key. The new dictionary's value should be the the place it stands if the keys were sorted. Added to this, there are two exceptions:

1.  If two dicts have values that are equal, but have different strings in the key, the one with the lowest int in the key should be placed higher.
2.  If two dicts have values that are equal, but have different ints in the key, they should be placed equal in the new dict and all get the same values.

So, the new dictionary should be as the following:

```
second[1] = 3
second[2] = 2
second[3] = 4
second[4] = 4
second[6] = 1 
```

I know that it's ignorant to ask someone else to solve my problem without giving my code for it. But i'm simply don't know how to approach the problem. I would be glad if you could provide me with an explanation how would you solve this problem , or even give me a pseudocode of the algorithm.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:53:22.077

```
import itertools as IT

first = {
    ('monkey',1): 130.0,
    ('dog',2): 123.0,
    ('cat', 3): 130.0,
    ('cat', 4): 130.0,
    ('mouse', 6): 100.0
    }

counter = 0
ordered = sorted(first, key = lambda k: (first[k], k[1], k[0]))

second = {}
for key, group in IT.groupby(ordered, first.__getitem__):
    # group = list(group)
    # print(key, group)
    # (100.0, [('mouse', 6)])
    # (123.0, [('dog', 2)])
    # (130.0, [('monkey', 1), ('cat', 3), ('cat', 4)])
    previous = None
    for name, num in group:
        if name != previous:
            counter += 1
        second[num] = counter
        previous = name

print(second) 
```

产量

```
{1: 3, 2: 2, 3: 4, 4: 4, 6: 1} 
```

* * *

**解释：**

第一步是根据关联的值对`(name, num)`键进行排序。`first`但是，如果是平局，`num`则使用 。如果还有平局，`name`则使用 打破平局。

```
In [96]: ordered = sorted(first, key = lambda k: (first[k], k[1], k[0]))

In [97]: ordered
Out[97]: [('mouse', 6), ('dog', 2), ('monkey', 1), ('cat', 3), ('cat', 4)] 
```

* * *

接下来，我们需要将项目分组，`ordered`因为当值相同时有特殊规则`first[k]`。可以使用[itertools.groupby](http://docs.python.org/2/library/itertools.html#itertools.groupby)来实现分组：

```
In [99]: for key, group in IT.groupby(ordered, first.__getitem__):
   ....:     print(key, list(group))
   ....:     
   ....:     
(100.0, [('mouse', 6)])
(123.0, [('dog', 2)])
(130.0, [('monkey', 1), ('cat', 3), ('cat', 4)]) 
```

`itertools.groupby``ordered`正在根据键的值将项目收集成束， `first.__getitem__(item)`。例如，

```
In [100]: first.__getitem__(('monkey', 1))
Out[100]: 130.0

In [101]: first.__getitem__(('cat', 3))
Out[101]: 130.0 
```

`first.__getitem__(item)`只是一种花哨的写作方式`first[item]`。我使用的原因`first.__getitem__`是因为`itertools.groupby`它的第二个参数需要一个函数，并且`first.__getitem__`是符合要求的函数。

* * *

最后，我们遍历每个组。基本上，我们想要这样做：

```
for name, num in group:
    counter += 1
    second[num] = counter 
```

**除了**，当名称相等时，我们不想推进计数器。因此，要检查名称是否相等，存储以前的名称会有所帮助：

```
previous = None
for name, num in group:
    if name != previous:
        counter += 1
    ...
    previous = name 
```

* * *

**警告**：请注意，rkd91 的代码和我的代码会产生不同的答案

```
first = {
    ('monkey',1): 130.0,
    ('dog',2): 123.0,
    ('cat', 3): 129.0,
    ('cat', 4): 130.0,
    ('mouse', 6): 100.0
    } 
```

可能是由于对规范的不同解释。我会让你决定哪个产生所需的输出。

@rdk91 的代码产生

```
{1: 4, 2: 2, 3: 5, 4: 3, 6: 1} 
```

我的代码产生

```
{1: 4, 2: 2, 3: 3, 4: 5, 6: 1} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:39:01.510

1）使用获取键值元组列表`first_list = first.items()`

2) 创建一个[自定义比较器函数](http://icfun.blogspot.ca/2009/08/python-customize-sorting-with.html)，该函数将根据您的标准对列表进行排序。

3）使用排序列表`first_list.sort(comparator)`

4）从排序列表中构建新字典。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T21:55:44.503

```
rob@rivertam:~/Programming$ cat sorter.py 
first = {}
first['monkey', 1] = 130.0
first['dog', 2] = 123.0
first['cat', 3] = 130.0
first['cat', 4] = 130.0
first['mouse', 6] = 100.0

# Get the keys of first, sorted by the value (ascending order), and then by the integer in the key (descending order) if two keys have the same value

s = sorted(first, key=lambda x: x[0])
s.reverse()
s = sorted(s, key=lambda x: first[x])

# Loop through these, and create a new list where the key is the integer in the old key, and the value is the position in the sorted order.

last_val = None
last = (None, None)
index = 0
new_dict = {}

for item in s:
    if not ((first[item] == last_val) and (item[1] != last[1]) and item[0] == last[0]):
        # When we have the same value, the same string but a different integer from the last key, consider it to be the same position in the sorted order.
        index += 1
    new_dict[item[1]] = index
    last_val = first[item]
    last = item

print new_dict
rob@rivertam:~/Programming$ python sorter.py 
{1: 3, 2: 2, 3: 4, 4: 4, 6: 1} 
```

# php - PHP Namespace not working - suspected PHP configuration issue

> ID：14863351
> 
> 赞同：1
> 
> 时间：2013-02-13T21:19:40.160
> 
> 标签：php, apache, namespaces, synology

OK, so, I've been using auto-loaders for a while, become rather used to MVC, and decided to try to tackle namespaces. Well, this hasn't worked as expected. I have managed to reproduce the error in a very simple way, so the contents of my php file read:

```
<?php
namespace site\test;

echo 'hello'; 
```

The output is not what I expected:

Fatal error: Namespace declaration statement has to be the very first statement in the script in *file* on line 2

I'm running PHP 5.3.10 on a Synology NAS, using the latest version of DSM (Synology's OS). This makes use of Apache v2.2.22\. I can confirm that commenting out the "namespace" line returns the word "hello", with no extra characters before it.

There is no BOM at the beginning of the file. I also have no issues with setting headers such as "Location" which would suggest this as being an issue.

Line endings are Unix (\n only) and the character encoding of the file is UTF8.

The PHP setting "auto_prepend_file" is empty.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:22:35.287

命名空间前有空格吗？命名空间必须出现在任何输出之前。这包括浏览器的 HTML。这还包括一个 UTF-8 字节顺序标记 (BOM)，它可以从某些编辑器中爬进来。

尝试在 Linux 等编辑器中打开文件，`vi`它应该会显示开头是否有 BOM。

检查[如何修复 PHP 中的“标头已发送”错误，](https://stackoverflow.com/questions/8028957/headers-already-sent-by-php)以获取有关在文件中开始输出的其他方式的信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:23:19.480

当您有一个以 UTF-8 [BOM](http://de.wikipedia.org/wiki/Byte_Order_Mark)作为第一个字符的文件并且您应该删除开始标记之前的所有空格时，就会发生这种情况。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-16T22:50:25.103

重新安装 DSM（Synology OS）实际上解决了这个问题。完成后，从其他框架获得的一些类在文件开头有“BOM”字节，但不是全部。BOM 问题的简单解决方案是将“BOM”移除器添加到自动加载器中。

# python - tkinter Listbox item binding

> ID：14863353
> 
> 赞同：2
> 
> 时间：2013-02-13T21:19:46.197
> 
> 标签：python, listbox, tkinter, bind

I'm trying to show a context menu when an item in a Listbox widget is right clicked. The problem is that if a bind to the listbox, the whole Listbox will be active for send the event and it doesn't seem possible to bind to the list items only. I can't use `<<ListboxSelect>>` because it will be trigged on left click. So I tried to use the methods `curselection()` but I fell into unwanted results (the right clicked item doesn't have to be selected). I think I need to simulate `<<ListboxSelect>>` using `generate_event()` and `nearest()`. Can someone tell me how to do that or maybe where can i found the defaults binding inside tkinter package ?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:45:38.120

您将需要使用`nearest(event.y)`. 调用回调时绑定到右键弹出菜单。

```
import Tkinter

def context_menu(event, menu):
    widget = event.widget
    index = widget.nearest(event.y)
    _, yoffset, _, height = widget.bbox(index)
    if event.y > height + yoffset + 5: # XXX 5 is a niceness factor :)
        # Outside of widget.
        return
    item = widget.get(index)
    print "Do something with", index, item
    menu.post(event.x_root, event.y_root)

root = Tkinter.Tk()
aqua = root.tk.call('tk', 'windowingsystem') == 'aqua'

menu = Tkinter.Menu()
menu.add_command(label=u'hi')

listbox = Tkinter.Listbox()
listbox.insert(0, *range(1, 10, 2))
listbox.bind('<2>' if aqua else '<3>', lambda e: context_menu(e, menu))
listbox.pack()
root.mainloop() 
```

# c# - 未创建付款

> ID：14863355
> 
> 赞同：3
> 
> 时间：2013-02-13T21:19:59.070
> 
> 标签：c#, asp.net, intuit-partner-platform

我的付款未显示在 QuickBooks 中。

我可以成功创建和更新客户。我还可以成功创建和更新发票。我无法创建付款。但事情是这样的，当我在我的付款对象上执行更新命令时，我确实得到了一个正确的 ID 和域 (NG) 传回。我在运行 Sync 后检查了 Sync 日志文件 (IntuitSyncManagerLogger.log)，但它没有错误消息。一切看起来都不错，只是没有与 QuickBooks 中的发票相关的付款。

我相信我正在设置所有必填字段，但我不确定其中两个。

1) PaymentLine 有一个名为 TxnId 的字段。我将其设置为 InvoiceHeader 的 Id 和 Domain，但不确定这是否正确。

2）还有另一个必填字段（根据文档），但我将其留空，因为我不知道用什么填充它。这是 DiscountAccountId 字段。我不想要与发票相关的折扣。

这是我的代码...

```
SqlConnection connection = new SqlConnection(m_connectionString);
connection.Open();

SqlCommand cmd = new SqlCommand("dbo.Intuit_GetPayment", connection);
cmd.CommandType = CommandType.StoredProcedure;
cmd.Parameters.Add("@glmvSyncId", SqlDbType.Int).Value = glmvSyncId;

SqlDataReader rdr = cmd.ExecuteReader();
rdr.Read();

Intuit.Ipp.Data.Qbd.PaymentHeader paymentHeader = new Intuit.Ipp.Data.Qbd.PaymentHeader();
paymentHeader.ARAccountId = new Intuit.Ipp.Data.Qbd.IdType() {
    idDomain = Intuit.Ipp.Data.Qbd.idDomainEnum.QB,
    Value = "37"
};
paymentHeader.ARAccountName = "Accounts Receivable";
paymentHeader.DepositToAccountId = new Intuit.Ipp.Data.Qbd.IdType() {
    idDomain = Intuit.Ipp.Data.Qbd.idDomainEnum.QB,
    Value = "35"
};
paymentHeader.DepositToAccountName = "Undeposited Funds";
paymentHeader.CustomerId = new Intuit.Ipp.Data.Qbd.IdType() {
    idDomain = (rdr["cust_iddomain"].ToString() == "QB" ? Intuit.Ipp.Data.Qbd.idDomainEnum.QB : Intuit.Ipp.Data.Qbd.idDomainEnum.NG),
    Value = rdr["cust_idvalue"].ToString()
}; // cust_iddomain and cust_idvalue are from the Customer
paymentHeader.DocNumber = rdr["invoicekey"].ToString();
paymentHeader.TxnDate = DateTime.Now; 

List<Intuit.Ipp.Data.Qbd.PaymentLine> listLine = new List<Intuit.Ipp.Data.Qbd.PaymentLine>();

var paymentLine = new Intuit.Ipp.Data.Qbd.PaymentLine();
paymentLine.Amount = Convert.ToDecimal(rdr["amount"]);
paymentLine.TxnId = new Intuit.Ipp.Data.Qbd.IdType() {
    idDomain = (rdr["invc_iddomain"].ToString() == "QB" ? Intuit.Ipp.Data.Qbd.idDomainEnum.QB : Intuit.Ipp.Data.Qbd.idDomainEnum.NG),
    Value = rdr["invc_idvalue"].ToString()
}; // invc_iddomain and invc_idvalue are from the InvoiceHeader

listLine.Add(paymentLine);

Intuit.Ipp.Data.Qbd.Payment syncPayment = new Intuit.Ipp.Data.Qbd.Payment();
syncPayment.Header = paymentHeader;
syncPayment.Line = listLine.ToArray();

connection.Close();

Intuit.Ipp.Data.Qbd.Payment resultPayment = new Intuit.Ipp.Data.Qbd.Payment();

resultPayment = commonService.Add(syncPayment); 
```

我怀疑问题出在 TxnId 上。

我所做的只是创建客户，然后为客户创建发票，然后为发票创建付款。我在某个地方错过了一个对象吗？

非常感谢任何和所有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:52:51.037

同步后付款可能会进入错误状态。您可以通过执行 PaymentQuery 并设置 ErroredObjectsOnly=true 来检查。

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0100_Calling_Data_Services/0015_Retrieving_Objects#Objects_in_Error_State](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0100_Calling_Data_Services/0015_Retrieving_Objects#Objects_in_Error_State)

如果实体处于错误状态，您可以使用 Status API 查询具体原因：

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0600_Object_Reference/SyncStatus](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0600_Object_Reference/SyncStatus)

```
SyncStatusRequest syncStatusRequest = new SyncStatusRequest();
syncStatusRequest.ErroredObjectsOnly = true;
syncStatusRequest.NgIdSet = new NgIdSet[] { new NgIdSet { NgId = <<EnterYourNgIdHere>>, NgObjectType = objectName.Payment } };
SyncStatusResponse[] response = dataServices.GetSyncStatus(syncStatusRequest); 
```

如果付款处于错误状态，您可以从云中删除该实体，因为它从未与 QuickBooks 同步：

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0100_Calling_Data_Services/Deleting_an_Object](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0100_Calling_Data_Services/Deleting_an_Object)

如果实体至少发生了一次成功的同步，但随后更新将其推入错误状态，您将需要执行 Revert：

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0100_Calling_Data_Services/Reverting_an_Object](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0050_Data_Services/0500_QuickBooks_Windows/0100_Calling_Data_Services/Reverting_an_Object)

You can also try doing an Update directly on the entity in error state once you know the reason from the Status API, but it is not documented so it may not work.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T20:22:04.877

Adding the following lines of code seems to have fixed the problem. The Payment is now being recorded in QuickBooks.

```
paymentHeader.TotalAmt = Convert.ToDecimal(rdr["amount"]);
paymentHeader.TotalAmtSpecified = true; 
```

# delphi - 字段之间的 DateTimePicker 选项卡

> ID：14863365
> 
> 赞同：0
> 
> 时间：2013-02-13T21:20:35.887
> 
> 标签：delphi

无论如何允许用户在 TDateTimePicker 中的字段之间切换。

必须使用箭头键或鼠标定位非常慢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T23:06:28.137

不，没有办法。

拦截`TAB`并发送右箭头键`->`很容易，但是您必须决定何时让 ( `SHIFT`-)`TAB`低谷，这应该在站在第一个或最后一个字段时完成，以保持正常的用户体验。

现在，来自光标和鼠标事件的所有选择更改都在 Windows DTM 控件内部处理，并且 Windows API 不支持检索单独的字段。您所能获得的只是这个非常特殊的*编辑*控件的整个文本。

从理论上讲，您可以拦截并保存所有键盘和鼠标输入，并计算是选择了第一个字段还是最后一个字段，但这将是一项艰巨且容易出错的任务，您不应该这样做。

因此没有。你只需要让自己熟悉它。

# neo4j - How to not return the same node in different columns in Cypher

> ID：14863367
> 
> 赞同：1
> 
> 时间：2013-02-13T21:20:44.730
> 
> 标签：neo4j, cypher

I am trying to not return the same node twice in this query in separate columns

```
START n=node:nodes(customer = 'c2')
MATCH n-[:OWNS]->owned-[:CROSS_SELL|UP_SELL]->sell
RETURN distinct n.customer,owned.product,sell.product 
```

Customer C2 owns products P1 and P2\. Product P2 and P3 can be cross sold from product P1\. Product P3 can be also be up sold from product P2\.

The query correctly returns

```
C2 P1 P3
C2 P2 P3
C2 P1 P2 
```

Since the customer already owns P2, I do not want the last record in the result.

How can I accomplish this?

Thanks

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T09:10:35.807

只需添加一个条件来过滤 C2 和 P2 之间的关系

```
START n=node:nodes(customer = 'c2')
MATCH n-[:OWNS]->owned-[:CROSS_SELL|UP_SELL]->sell
WHERE not(n-[:OWNS]-sell)
RETURN distinct n.customer,owned.product,sell.product 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T23:45:54.557

我还没有测试以验证这是否有效，但它似乎在逻辑上是正确的：

```
START n=node:nodes(customer = 'c2')
MATCH n-[:OWNS]->owned-[:CROSS_SELL|UP_SELL]->sell,
      alreadyOwns = n-[:OWNS]->sell
WHERE COUNT(alreadyOwns) = 0
RETURN distinct n.customer,owned.product,sell.product 
```

这个想法基本上是尝试找到从起始节点到交叉/追加销售项目的直接匹配项，如果找到路径，则不要包含它。

# azure - 服务总线队列主机服务的异常处理

> ID：14863368
> 
> 赞同：1
> 
> 时间：2013-02-13T21:20:46.740
> 
> 标签：azure, azureservicebus

我有一个 WCF 服务，它连接到准备接收消息的服务总线队列。这很好，但如果我在处理消息时遇到问题，我希望能够将消息标记为死信。目前，如果我的代码引发异常，消息仍会从队列中删除，但我希望能够在配置中指定不从队列中删除，但将其标记为死信。我已经进行了一些搜索，但我无法弄清楚如何做到这一点。我目前正在将该服务作为 Windows 服务运行

> Uri baseAddress = ServiceBusEnvironment.CreateServiceUri("sb", "namespace", "servicequeue"); _serviceHost = new ServiceHost(typeof(PaperlessImportServiceOneWay), baseAddress); _serviceHost.Open();

配置：

```
<services>
      <service name="Enrollment.ServiceOneWay">
        <endpoint name="ServiceOneWay"
                  address="sb://namespace.servicebus.windows.net/servicequeue"
                  binding="netMessagingBinding"
                  bindingConfiguration="messagingBinding"
                  contract="IServiceOneWaySoap"
                  behaviorConfiguration="sbTokenProvider" />
      </service>
</services>
      <netMessagingBinding>
        <binding name="messagingBinding" closeTimeout="00:03:00" openTimeout="00:03:00"
               receiveTimeout="00:03:00" sendTimeout="00:03:00" sessionIdleTimeout="00:01:00"
               prefetchCount="-1">
          <transportSettings batchFlushInterval="00:00:01" />
        </binding>
      </netMessagingBinding>

<behavior name="sbTokenProvider">
          <transportClientEndpointBehavior>
            <tokenProvider>
              <sharedSecret issuerName="owner" issuerSecret="XXXXXXXXXXXXXXXXXXXXXXXX" />
            </tokenProvider>
          </transportClientEndpointBehavior>
        </behavior> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-15T18:15:40.907

In your interface for the opertion Contract add this [ReceiveContextEnabled(ManualControl = true)] then you can manage to commit or abandon the message Found it in this link: [http://msdn.microsoft.com/en-us/library/windowsazure/hh532034.aspx](http://msdn.microsoft.com/en-us/library/windowsazure/hh532034.aspx)

# c# - 获取进程的所有 DLL

> ID：14863369
> 
> 赞同：6
> 
> 时间：2013-02-13T21:20:47.340
> 
> 标签：c#, .net, dll, process

我想获取为给定进程加载的所有 dll 的列表。我目前正在使用**.NET Framework 4.0**。我知道尝试通过 Process.Modules 属性访问所有托管 dll 时存在[错误。](https://connect.microsoft.com/VisualStudio/feedback/details/546430/system-diagnostics-process-modules-doesnt-include-managed-dlls)（仅列出非托管 dll）。我需要一种以编程方式检索所有这些 dll 的方法。

```
 Process[] myProcess = Process.GetProcessesByName("MyProcess");
 if(myProcess.Count() > 0) 
 {
      foreach (ProcessModule processModule in myProcess[0].Modules)
      //get information
 } 
```

编辑：我感兴趣的过程不在当前的 AppDomain 中。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T22:39:09.360

> 我知道有一个错误

不，这不是错误。这是 CLR v4 中的有意设计更改，微软并没有保密。以前版本的 CLR 努力模拟加载的程序集，就好像它们是非托管 DLL。但是，当他们实现并行进程内 CLR 版本控制功能时，这一切就不再有意义了。它走了，再也不会回来了。

这并不是一个主要问题，调试接口很好地支持在另一个进程中获取已加载程序集的列表。ICorDebugAppDomain::EnumerateAssemblies() 是票。好吧，并不像 Process.Modules 那样容易使用。使用[MDbg 示例](http://www.microsoft.com/en-us/download/details.aspx?id=2282)了解如何使用它。

# mysql - 平均查询大小

> ID：14863380
> 
> 赞同：0
> 
> 时间：2013-02-13T21:21:24.250
> 
> 标签：mysql

我正在对我编写的应用程序进行分析，我想知道的一件事是平均查询大小。有时，应用程序会发送批量插入语句，而一位使用远程 mysql 服务器（来自共享虚拟主机提供商）的客户的 max_allowed_pa​​cket 配置极低，超出了他的控制范围。

我已经在开发服务器上启用了完整的查询日志，但是我找不到任何报告平均查询大小的工具，只是为了让我知道我们正在使用什么。此外，任何关于良好查询日志分析器的建议也值得赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:50:11.467

您始终可以将查询日志文件的大小除以查询日志文件中的行数，以粗略了解您的平均大小。不过，最重要的是最大化。

为什么不设置`max_allowed_packet`为 1GB 而不用担心呢？

# iphone - 每次歌曲更改或使用 Stormy Productions RadioKit 每隔几秒钟从 URL 获取专辑封面更新

> ID：14863397
> 
> 赞同：2
> 
> 时间：2013-02-13T21:22:50.723
> 
> 标签：iphone, ios, audio-streaming, albumart

为了自学如何用 Objective-C 编码，我正在为我的 Church 创建一个网络广播应用程序。这就是问题所在...每当电台上的歌曲发生变化时，我都会将专辑封面上传到我的网络服务器。即使实际图片发生变化，专辑封面也始终具有相同的名称。我为我的应用程序的流媒体部分购买了代码，以便处理好。要了解此代码是如何实现的，您可以从[供应商的网站](http://stormyprods.com/Demos/RadioKitARC-4.5-Demo.zip)下载演示实现。不幸的是，当歌曲更改时，我无法刷新应用程序中显示的图片。下面是一些加载专辑封面的代码（这都是在`viewDidLoad`方法中）。

```
UIImage *albumArt = [UIImage imageWithData:[NSData dataWithContentsOfURL:[NSURL    URLWithString:@"http://www.ourchurchwebserver.org/nameof.jpg"]]];
CGSize picSize = CGSizeMake(100, 100);
CGPoint picOrigin = CGPointMake(108, 74);
CGRect picFrame;
picFrame.size = picSize;
picFrame.origin = picOrigin;
ImageEnlarge * imEn =[[ImageEnlarge alloc]initWithFrame:picFrame];
[[imEn internal]setImage:albumArt];
[self.view addSubview:(imEn)]; 
```

您看到的是用于提供的代码，如果用户点击图片，它将放大，如果他们再次点击它，它会恢复到正常大小。我的第一个想法是创建一个数组，并自动在图片之间来回旋转（具有相同的 URL 地址），但我的知识太有限，研究证明是徒劳的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T06:24:57.737

`RadioKit.h`定义了一个`StormysRadioKitDelegate`包含方法的协议`SRKMetaChanged`。演示项目建议使用这种方法来启动对专辑插图的请求。

所以你应该在这个方法的实现中添加这样的东西。它将网络下载分派到后台线程，完成后更新主线程上的 UI。

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
    NSData *albumArtImageData = [NSData dataWithContentsOfURL:[NSURL URLWithString:@"http://www.ourchurchwebserver.org/nameof.jpg"]];
    dispatch_async(dispatch_get_main_queue(), ^{
        UIImage *albumArt = [UIImage imageWithData:albumArtImageData];
        self.imageEnlarge.internal.image = albumArt;
    });
}); 
```

# javascript - 如何加载java脚本onclick？

> ID：14863399
> 
> 赞同：0
> 
> 时间：2013-02-13T21:22:50.110
> 
> 标签：javascript, onclick, load

```
<script src="recentimg.js" type="text/javascript"></script>

<script language="JavaScript">
imgr = new Array();
imgr[0] = "noimage.jpeg";
RandomImg = true;
</script> 
```

当我点击按钮时..我让它加载随机图像..我的意思是加载这个脚本onclick

```
<script language="JavaScript">
imgr = new Array();
imgr[0] = "noimage.jpeg";
RandomImg = false;
</script> 
```

我试过了

```
<input type="button" onclick="write()" value="load">
<script language="JavaScript">
function write(){RandomImg = false;}
</script> 
```

但它不起作用..

注意：我的网站不支持 php、ajax 加载

* * *

更新------------完整代码..

```
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js' type='text/javascript'></script>

<script language="JavaScript">
imgr = new Array();
imgr[0] = "https://dl.dropbox.com/u/36050019/Bukraa.coM/noimagejpeg.jpeg";
showRandomImg = true;
boxwidth = 298;
cellspacing = 8;
borderColor = "#F5F5F5";
bgTD = "#000000";
thumbwidth = 80;
thumbheight = 64;
fntsize = 16;
acolor = "#666";
label = "اخبار مصر";
aBold = true;
icon = " ";
text = "comments";
showPostDate = false;
summaryPost = 0;
summaryFontsize = 10;
summaryColor = "#666";
icon2 = " ";
numposts = 4;
home_page = "http://bukraa.blogspot.com/";
</script>
<style>table td {
padding: 0px;
text-align: right;
}</style>
<script src="https://dl.dropbox.com/u/36050019/Bukraa.coM/recentpost.js" type="text/javascript"></script> 
```

.....我想在点击时将标签更改为

```
label = "توب نمبر"; 
```

然后当我单击按钮时.. 我的代码显示没有刷新页面的新标签提要我可以使用 java 脚本 jquery 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:30:02.287

朋友，你想达到什么目的还不清楚。但是，如果您希望在单击某个对象时执行您的函数，只需添加

```
$("#clickme").click(function() {
  //script
}); 
```

围绕你的脚本。

例如：

```
<script language="JavaScript">
$("#clickme").click(function() {
imgr = new Array();
imgr[0] = "noimage.jpeg";
RandomImg = false;
});
</script>

<div id="clickme">
Click Me!
</div> 
```

这是关于 jsfiddle 的示例：http: [//jsfiddle.net/CWBZz/3/](http://jsfiddle.net/CWBZz/3/)

# python - 如何制作 flask/gevent.socketio 服务器的 python windows 服务？

> ID：14863402
> 
> 赞同：9
> 
> 时间：2013-02-13T21:22:59.520
> 
> 标签：python, windows, windows-services, flask, gevent-socketio

我有一个烧瓶/gevent SocketIOServer，需要使其作为服务工作：

```
class TeleportService(win32serviceutil.ServiceFramework):
    _svc_name_ = "TeleportServer"
    _svc_display_name_ = "Teleport Database Backup Service"
    _svc_description_ = "More info at www.elmalabarista.com/teleport"

    def __init__(self, args):
        win32serviceutil.ServiceFramework.__init__(self, args)
        self.hWaitStop = win32event.CreateEvent(None, 0, 0, None)

    def SvcStop(self):
        self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
        win32event.SetEvent(self.hWaitStop)

    def SvcDoRun(self):
        servicemanager.LogMsg(servicemanager.EVENTLOG_INFORMATION_TYPE,
                              servicemanager.PYS_SERVICE_STARTED, (self._svc_name_, ''))

        self.ReportServiceStatus(win32service.SERVICE_RUNNING)

        runServer()

@werkzeug.serving.run_with_reloader
def runServer():
    print 'Listening on %s...' % WEB_PORT
    ws = SocketIOServer(('0.0.0.0', WEB_PORT),
        SharedDataMiddleware(app, {}),
        resource="socket.io",
        policy_server=False)

    gevent.spawn(runTaskManager).link_exception(lambda *args: sys.exit("important_greenlet died"))

    ws.serve_forever() 
```

但是，我不知道如何从 SvcStop 停止它，并且运行它具有奇怪的行为，即在 runserver 被杀死之后，命令行参数的服务解析发生。这意味着烧瓶服务器运行，我可以从网络浏览器访问，但服务管理器将其列为“未启动”。例如，在命令行中运行：

```
C:\Proyectos\TeleportServer>python service.py uninstall <--BAD PARAM, TO MAKE IT OBVIOUS
2013-02-13 16:19:30,786 - DEBUG: Connecting to localhost:9097
 * Restarting with reloader
2013-02-13 16:19:32,650 - DEBUG: Connecting to localhost:9097
Listening on 5000...
Growl not available: Teleport Backup Server is started
KeyboardInterrupt <--- HERE I INTERRUPT WITH CTRL-C
Unknown command - 'uninstall'
Usage: 'service.py [options] install|update|remove|start [...]|stop|restart [...
]|debug [...]'
Options for 'install' and 'update' commands only:
 --username domain\username : The Username the service is to run under
 --password password : The password for the username
 --startup [manual|auto|disabled] : How the service starts, default = manual
 --interactive : Allow the service to interact with the desktop.
 --perfmonini file: .ini file to use for registering performance monitor data 
```

建议删除实时重新加载器，这是留下的代码。还是一样的问题

def SvcDoRun(self): servicemanager.LogMsg(servicemanager.EVENTLOG_INFORMATION_TYPE,servicemanager.PYS_SERVICE_STARTED,(self._svc_name_, ''))

```
#self.timeout = 640000    #640 seconds / 10 minutes (value is in milliseconds)
self.timeout = 6000     #120 seconds / 2 minutes
# This is how long the service will wait to run / refresh itself (see script below)
notify.debug("Starting service")

ws = getServer()

while 1:
    # Wait for service stop signal, if I timeout, loop again
    gevent.sleep(0)
    rc = win32event.WaitForSingleObject(self.hWaitStop, self.timeout)
    # Check to see if self.hWaitStop happened
    if rc == win32event.WAIT_OBJECT_0:
        # Stop signal encountered
        notify.debug("Stopping service")
        ws.kill()
        servicemanager.LogInfoMsg("TeleportService - STOPPED!")  #For Event Log
        break
    else:
        notify.debug("Starting web server")
        ws.serve_forever() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-26T15:37:01.767

要从 SvcStop 停止它，您需要在全局变量中存储对“ws”的引用（即，稍后可以检索它的地方）。AFAIK“ws.kill()”然后应该结束循环。

run_with_reloader 装饰器似乎立即运行装饰函数，这可以解释为什么在运行 Web 服务器后才处理命令行。您是否需要自动重新加载，显然装饰器仅在您需要重新加载时才需要。

更新：添加了示例服务代码

在一个不使用flask或gevent的项目中，我使用了这样的东西（删除了很​​多细节）：

```
class Service (win32serviceutil.ServiceFramework):

   def __init__(self, *args, **kwds):
       self._mainloop = None
       win32serviceutil.ServiceFramework.__init__(self, *args, **kwds)

   def SvcStop(self):
       self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)

       if self._mainloop is not None:
           self._mainloop.shutdown()

    def SvcStart(self):
        self.ReportServiceStatus(win32service.SERVICE_START_PENDING)
        self._mainloop = ... .MainLoop()
        self.ReportServiceStatus(win32service.SERVICE_RUNNING)
        try:
            self._mainloop.run_forever()

        finally:
            self.ReportServiceStatus(win32service.SERVICE_STOPPED)

win32serviceutil.HandleCommandLine(Service) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-05T02:57:07.390

我无法`WSGIRequestHandler`在外面的 Flask中访问`request`，所以我使用`Process`.

```
import win32serviceutil
import win32service
import win32event
import servicemanager
from multiprocessing import Process

from app import app

class Service(win32serviceutil.ServiceFramework):
    _svc_name_ = "TestService"
    _svc_display_name_ = "Test Service"
    _svc_description_ = "Tests Python service framework by receiving and echoing messages over a named pipe"

    def __init__(self, *args):
        super().__init__(*args)

    def SvcStop(self):
        self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
        self.process.terminate()
        self.ReportServiceStatus(win32service.SERVICE_STOPPED)

    def SvcDoRun(self):
        self.process = Process(target=self.main)
        self.process.start()
        self.process.run()

    def main(self):
        app.run()

if __name__ == '__main__':
    win32serviceutil.HandleCommandLine(Service) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-27T21:12:13.397

该方法`serve_forever`来自[`BaseServer.serve_forever`](http://docs.python.org/2/library/socketserver.html#SocketServer.BaseServer.serve_forever). 要阻止它，您必须调用[`BaseServer.shutdown()`](http://docs.python.org/2/library/socketserver.html#SocketServer.BaseServer.shutdown)它或它的衍生物。

简而言之，您必须`ws`在全局范围内声明。将此代码放在`Service`类定义之前是一种方法。

```
ws = None 
```

然后将您的`Service.SvcStop`实现更改为：

```
def SvcStop(self):
    self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)

    #Tell the serve_forever() loop to stop and wait until it does. 
    ws.shutdown() 
```

由于`ws.shutdown()`已经在等待侦听器停止，因此您可以摆脱`self.hWaitStop`，除非您在代码中的其他地方使用它。

需要 Python 2.6+

# python - Python 错误检查脚本超级慢

> ID：14863409
> 
> 赞同：0
> 
> 时间：2013-02-13T21:23:19.267
> 
> 标签：python

我有以下程序已经运行了大约两个小时，可能还有 1/4 的时间。我的问题在代码下方：

```
import csv

input_csv = "LOCATION_ID.csv"
input2 = "CITIES.csv"
output_csv = "OUTPUT_CITIES.csv"

with open(input_csv, "rb") as infile:
    input_fields = ("ID", "CITY_DECODED", "CITY", "STATE", "COUNTRY", "SPELL1", "SPELL2", "SPELL3")
    reader = csv.DictReader(infile, fieldnames = input_fields)
    with open(input2, "rb") as infile2:
        input_fields2 = ("Latitude", "Longitude", "City")
        reader2 = csv.DictReader(infile2, fieldnames = input_fields2)
        next(reader2)
        words = []
        for next_row in reader2:
            words.append(next_row["City"])

        with open(output_csv, "wb") as outfile:
            output_fields = ("EXISTS","ID", "CITY_DECODED", "CITY", "STATE", "COUNTRY", "SPELL1", "SPELL2", "SPELL3")
            writer = csv.DictWriter(outfile, fieldnames = output_fields)
            writer.writerow(dict((h,h) for h in output_fields))
            next(reader)
            for next_row in reader:
                search_term = next_row["CITY_DECODED"]

                #I think the problem is here where I run through every city
                #in "words", even though all I want to know is if the city
                #in "search_term" exists in "words
                for item in words:
                    if search_term in words:
                        next_row["EXISTS"] = 1

                writer.writerow(next_row) 
```

我在这里有几个问题：

**1** 鉴于 input_csv 有 14k 行，而 input2 只有 6k 行，为什么要花这么长时间？我知道最里面的 for 循环（以“for item in words:”开头）效率低下（参见 qtn 3），但我希望能更直观地了解幕后发生的事情，以便我（并希望其他 SO 用户）可以避免在我们的其他程序上犯同样的错误。

**2**如果我希望此代码继续运行，这与我离开计算机并进入睡眠/休眠状态有何关系？程序是否会在此时停止，但在计算机再次使用时会自行重新启动？我真的很想知道一旦运行程序的编译器如何与操作系统交互，以及与 python 程序相关的计算机“进入睡眠状态”意味着什么。

**和 3**此代码的更有效实现是什么？我认为这样做不应该花费超过几分钟的时间，对吗？

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:35:05.413

让我们从我看到的一个低效率的地方开始：

```
for next_row in reader:
                search_term = next_row["CITY_DECODED"]
                for item in words:
                    if search_term in words:
                        next_row["EXISTS"] = 1 
```

那是外`for`循环的 14k 次迭代。然后，在嵌套循环中*每次*大约进行 6k 次迭代`for`。然后在你这样做时进行*更多*迭代`if search_term in words`，因为它会迭代单词直到它返回。

我没有过多考虑这个算法实际上在做什么，但你至少应该删除`words`(ie, `words = list(set(words))`) 中的重复项。

我正要发布关于那个小循环的帖子`for item in words`。我很困惑为什么你这样做是因为`items`从未使用过，所以 for 循环是浪费时间。

它很可能可以简化为：

```
for next_row in reader:
    search_term = next_row["CITY_DECODED"]
    if search_term in words:
        next_row["EXISTS"] = 1
    writer.writerow(next_row) 
```

因此，让我们总结一下您进行的所有迭代：

~6k 为`for next_row in reader2: words.append(next_row["City"])`

约 14k 次迭代`for next_row in reader:`乘以总和（i,1,6000），约为 2520 亿。

去掉多余的循环可以为您提供大约 8400 万次迭代，这……嗯，好多了。

# asp.net-mvc-4 - EntityFramework 5 安装

> ID：14863420
> 
> 赞同：0
> 
> 时间：2013-02-13T21:24:04.870
> 
> 标签：asp.net-mvc-4, visual-studio-2012, nuget, entity-framework-5

我在 VS 2010 中创建了一个 ASP.NET MVC4 项目，然后决定我想要 4.5 框架，所以在 VS 2012 中打开项目并将目标框架更改为 4.5。

我得到了一些编译错误，我很确定这些错误是由对低于版本 5 的 EntityFramework 版本的引用引起的。

例如：

> 错误 2 找不到类型或命名空间名称“表”（是否缺少 using 指令或程序集引用？） c:\users\saad\documents\visual studio 2012\Projects\MvcApplication1\MvcApplication1\Models\AccountModels。 cs 21 6 MvcApplication1

以下是我的 Web.config 文件中当前的条目：

```
<configSections>
    <!-- For more information on Entity Framework configuration, visit http://go.microsoft.com/fwlink/?LinkID=237468 -->
    <section name="entityFramework" type="System.Data.Entity.Internal.ConfigFile.EntityFrameworkSection, EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" requirePermission="false" />
</configSections> 
```

和 ...

```
<assemblies>
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral,        PublicKeyToken=b77a5c561934e089" />
</assemblies> 
```

我没有运气将 EntityFramework 引用更改为更高版本，因为它没有出现在框架列表中。

根据给有类似问题的人的一些建议，我尝试使用包管理器控制台来解决问题。你可以在下面看到我陷入的混乱。

有谁知道如何解决这个问题？

我正在做的工作确实需要第 5 版。

> PM> Uninstall-Package entityframework 从 PersonalityTest_002 中成功删除了“EntityFramework 5.0.0”。目录不为空。
> 
> 成功卸载“EntityFramework 5.0.0”。
> 
> PM> Install-Package entityframework Install-Package：无法解析远程名称：'nuget.org' At line:1 char:16 + Install-Package <<<< entityframework + CategoryInfo : NotSpecified: (:) [Install-包]，WebException + FullyQualifiedErrorId：NuGetCmdletUnhandledException，NuGet.PowerShell.Commands.InstallPackageCommand PM> Install-Package EntityFramework 'EntityFramework 5.0.0' 已经安装。目录不为空。
> 
> 成功卸载“EntityFramework 5.0.0”。安装包：无法添加对“EntityFramework”的引用。在 line:1 char:16 + Install-Package <<<< EntityFramework + CategoryInfo : NotSpecified: (:) [Install-Package], InvalidOperationException + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand PM> Install-Package entityframework ' EntityFramework 5.0.0' 已安装。目录不为空。
> 
> 成功卸载“EntityFramework 5.0.0”。安装包：无法添加对“EntityFramework”的引用。在 line:1 char:16 + Install-Package <<<< entityframework + CategoryInfo : NotSpecified: (:) [Install-Package], InvalidOperationException + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand PM> Install-Package EntityFramework ' EntityFramework 5.0.0' 已安装。目录不为空。
> 
> 成功卸载“EntityFramework 5.0.0”。安装包：无法添加对“EntityFramework”的引用。在 line:1 char:16 + Install-Package <<<< EntityFramework + CategoryInfo : NotSpecified: (:) [Install-Package], InvalidOperationException + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand PM> Uninstall-Package EntityFramework -强制卸载包：找不到包“EntityFramework”。在 line:1 char:19 + Uninstall-Package <<<< EntityFramework -Force + CategoryInfo : NotSpecified: (:) [Uninstall-Package], InvalidOperationException + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.UninstallPackageCommand PM> 已安装安装包 EntityFramework 'EntityFramework 5.0.0'。目录不为空。
> 
> 成功卸载“EntityFramework 5.0.0”。安装包：无法添加对“EntityFramework”的引用。在 line:1 char:16 + Install-Package <<<< EntityFramework + CategoryInfo : NotSpecified: (:) [Install-Package], InvalidOperationException + FullyQualifiedErrorId : NuGetCmdletUnhandledException,NuGet.PowerShell.Commands.InstallPackageCommand PM>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:04:48.070

如果您使用的是 NuGet（如果没有，请使用），您可能需要删除并重新添加所有包，以便它们切换到 4.5。如果你打开你的 packages.config 你可以看到版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:51:08.833

**导致错误的TableAttribute**来自：

```
Assembly System.ComponentModel.DataAnnotations.dll, v4.0.0.0
C:\Program Files (x86)\Reference Assemblies\Microsoft\Framework\.NETFramework\v4.5\System.ComponentModel.DataAnnotations.dll 
```

因此，您可能会错过项目中对该程序集的引用。

# c++ - addressof() 可以实现为 constexpr 函数吗？

> ID：14863422
> 
> 赞同：17
> 
> 时间：2013-02-13T21:24:06.927
> 
> 标签：c++, c++11

我需要写一个 constexpr addressof 函数，但我觉得不可能。有谁知道这是否可能？

[cppreference.com](http://en.cppreference.com/w/cpp/memory/addressof)中的参考实现：

```
template< class T >
T* addressof(T& arg) 
{
  return reinterpret_cast<T*>(
           &const_cast<char&>(
              reinterpret_cast<const volatile char&>(arg)
           )
         );
} 
```

使用 reinterpret_cast （类似于 GCC 实现），所以它不会这样做。我可以看到最新的 C++ 标准草案[N3485](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2012/n3485.pdf)也不需要 addressof() 是 constexpr，即使标题 <utility> 中的许多函数最近已升级为 constexpr。

一个可能的，虽然不是很有说服力或有用的用例是：

```
constexpr MyType m;
constexpr MyType const* p = &m;           // this works today
constexpr MyType const* p = addressof(m); // this is my question 
```

假设 MyType 重载了 operator&。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-14T19:10:22.940

`operator&`如评论中所述，您可以使用 SFINAE检测是否有可用的重载。正如 Potatoswatter 在评论中指出的那样，这些需要进行三项单独的检查：

1) 是否`x.operator&()`接受

2) 是否`operator&(x)`接受

前两种是`operator&`定义用户提供的两种方式。

3) 是否`&x`接受

这第三次检查是必要的，因为`x.operator&()`可能会因为`operator&`确实存在而被拒绝，但它是私有的。在这种情况下，`&x`无效。

这些检查可以通过检查来实现`sizeof(f(std::declval<T>()))`，其中`f`的重载方式使得返回类型取决于是否`T`通过检查。

```
namespace addressof_helper {
  template <typename T>
  static char (&checkaddressof(...))[1];

  template <typename T>
  static char (&checkaddressof(T &&, typename std::remove_reference<decltype(&std::declval<T &>())>::type * = 0))[2];

  template <typename T>
  static char (&checknonmember(...))[1];

  template <typename T>
  static char (&checknonmember(T &&, typename std::remove_reference<decltype(operator&(std::declval<T &>()))>::type * = 0))[2];

  template <typename T>
  static char (&checkmember(...))[1];

  template <typename T>
  static char (&checkmember(T &&, typename std::remove_reference<decltype(std::declval<T &>().operator&())>::type * = 0))[2];
} 
```

然后，您可以使用这些辅助函数来选择`addressof`要使用的实现：

```
template <typename T>
constexpr typename std::enable_if<
  sizeof(addressof_helper::checkaddressof<T>(std::declval<T>())) == 2
  && sizeof(addressof_helper::checknonmember<T>(std::declval<T>())) == 1
  && sizeof(addressof_helper::checkmember<T>(std::declval<T>())) == 1,
  T *>::type addressof(T &t) {
  return &t;
}

template <typename T>
/* no constexpr */ typename std::enable_if<
  sizeof(addressof_helper::checkaddressof<T>(std::declval<T>())) == 1
  || sizeof(addressof_helper::checknonmember<T>(std::declval<T>())) == 2
  || sizeof(addressof_helper::checkmember<T>(std::declval<T>())) == 2,
  T *>::type addressof(T &t) {
  return reinterpret_cast<T *>(&const_cast<char &>(reinterpret_cast<const volatile char &>(t)));
} 
```

`addressof`只要`operator&`不重载，这允许在常量表达式中使用。如果它被重载，似乎无法以可用于常量表达式的形式可靠地获取地址。

请注意，GCC 4.7 拒绝`addressof`在它应该工作的地方使用这个实现案例。GCC 4.8 和更高版本可以工作，clang 也是如此。

我在我的答案的早期版本中使用了转发到辅助函数的单个实现`addressof`，但最近我意识到这不是一个好主意，因为如果`addressof<X>`将它用于`X`多个类中的某个类，它很容易导致 ODR 违规翻译单元，有些`X`是定义的，有些`X`是不完整的。拥有两个独立的功能可以避免这个问题。

唯一剩下的问题是如果在定义's custom`addressof<X>`之前在翻译单元中使用它可能会失败。希望这应该足够罕见，以至于在实践中这不是问题。`X``operator&`

合理示例的测试用例：

```
class A { } a;
class B { private: B *operator&(); } b;
class C { C *operator&(); } c;
class D { } d;
D *operator&(D &);
extern class E e;

int main() {
  constexpr A *pa = addressof(a);
  /* no constexpr */ B *pb = addressof(b);
  /* no constexpr */ C *pc = addressof(c);
  /* no constexpr */ D *pd = addressof(d);
  constexpr E *pe = addressof(e);
}

class E { } e; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T08:20:03.027

一种部分解决方法是在`union`包装器中定义任何此类对象，并将指针传递给`union`. 指向包装器的指针可以很容易地转换为对该类型的引用。指针算法应该适用于包装器数组。但我仍然看不到一种方法来获取指向具有重载类型的指针`operator&`。

`union`只需要一个成员；`struct`可以在实践中使用，但从理论上讲，实现可以在开始时添加填充。`MyType *`如果无论如何您都无法在常量表达式中获得 a ，那么填充并不是真的有影响。

```
template< typename t >
union storage_wrapper
    { t obj; };

constexpr storage_wrapper< MyType > m{{ args_to_MyType_constructor }};
constexpr storage_wrapper< MyType > *p = &m; // not overloaded 
```

# android - 如何避免 mobclix 自动播放全屏广告？

> ID：14863424
> 
> 赞同：2
> 
> 时间：2013-02-13T21:24:09.290
> 
> 标签：android, ios, fullscreen, mobclix, interstitial

我们正在开发一个使用 mobclix 来提供广告的应用程序。我们的 android 版本可以正常工作，但我们的 iOS 版本偶尔会在不点击广告横幅的情况下显示全屏（我相信他们称之为插页式）广告。这非常令人恼火，因为即使您与应用程序交互也会发生这种情况。[**编辑：**我们现在在 android 上也看到了这个问题，所以它不是 iOS 特定的。]

我们已经确定我们是`NO`从`adViewCanAutoplay`（和`YES`从回来`richMediaRequiresUserInteraction`，虽然这似乎不相关）。我们还在`Allow Auto-play Ads`仪表板中`No`为所有广告单元设置了`Platform:iPhone`/`Ad Unit:Fullscreen`已`Ads Running`设置为`No`

我们已经从 mobclix 提交了支持请求，但他们刚刚说我们需要向他们发送广告的屏幕截图，以便他们可以提取它们。他们的功能无法检测到试图将广告横幅调整为全屏并阻止它的广告，这似乎很奇怪，而且他们期望我们为他们策划他们的内容更奇怪。注意：这是在等待一周后查看更改仪表板中的设置等是否需要一段时间才能生效。

有谁知道让 mobclix 表现的方法？

# c# - EF 5 一对多自引用 - 代码优先

> ID：14863425
> 
> 赞同：3
> 
> 时间：2013-02-13T21:24:13.083
> 
> 标签：c#, entity-framework, entity-framework-5, code-first

我已经阅读了许多一对多的自引用帖子，但看到了我的具体排列。如果我错过了，请发布链接。

这是我的场景。我有两张桌子。特征包含史诗的集合，史诗可以递归地包含子史诗的集合（我可以有子子子（n）史诗集合）。

下面是我要创建的模型类型的简单概述。

```
public class Feature
{
    public int Id { get; set; }
    public string Name { get; set; }

    public virtual ICollection<Epic> Epics { get; set; } 
}

public class Epic
{
    public int Id { get; set; }
    public string Name { get; set; }

    public int FeatureId { get; set; }

    public int ParentEpicId { get; set; }
    public virtual ICollection<Epic> ChildEpics { get; set; } 
} 
```

我几乎可以在模型构建器中指定关系，但被一件事挂断了。第一个史诗集合将有一个返回父 Feature 的 FeatureId FK 和一个 null ParentEpicId，但在此之下的所有级别的史诗集合都将 FeatureId 设置为 null，ParentEpicId 设置为父史诗的 Id。（FeatureId 可以指向史诗儿童树的顶级特征，但这不是必需的）

如何首先在 EF 代码中指定这种类型的关系？

如果不清楚或您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:30:33.130

显然，两者都`FeatureId`映射`ParentEpicId`到数据库中的可为空列，因此需要将它们映射到数据模型中的可为空属性。您应该将您的`Epic`课程更改为：

```
public class Epic
{
    public int Id { get; set; }
    public string Name { get; set; }

    public int? FeatureId { get; set; }

    public int? ParentEpicId { get; set; }
    public virtual ICollection<Epic> ChildEpics { get; set; } 
} 
```

至于必须设置FeatureId和ParentEpicId其中一个的要求，我认为EF中没有开箱即用的这种机制。

# javascript - JavaScript 是否有未定义的行为？

> ID：14863430
> 
> 赞同：23
> 
> 时间：2013-02-13T21:24:33.950
> 
> 标签：javascript, undefined-behavior

JavaScript 是否具有未定义的行为（类似于 C），或者它是否完全由规范定义且具有确定性？

请注意，我正在丢弃实现错误和规范分歧。我也在丢弃像`Math.random()`and之类的东西`Date.now()`。

是否有一段 JavaScript 代码的行为未完全由 JavaScript 规范确定，并且因此具有“未定义的行为”？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T21:36:42.310

规范中有很多东西明确地留给了实现。尤其是当涉及到主机对象时，可能会有很多怪癖。与宿主对象无关的示例：

> [15.1 全局对象](http://es5.github.com/#x15.1)
> 
> 全局对象的 [[Prototype]] 和 [[Class]] 内部属性的值是**implementation-dependent**。

> [15.1.2.2 parseInt（字符串，基数）](http://es5.github.com/#x15.1.2.2)
> 
> [如果有效数字太多] mathInt 可能是数学整数值的**实现相关的**近似值，它由 Z 以基数-R 表示法表示。

> [15.3.4.2 函数.prototype.toString](http://es5.github.com/#x15.3.4.2)
> 
> 返回函数的**依赖于实现的**表示。

几乎所有的日期解析/字符串化算法都是**依赖于实现的**，这包括`toLocaleString`、`toString`和构造函数。`parse``Date`

> [15.4.4.11 Array.prototype.sort (comparefn)](http://es5.github.com/#x15.4.4.11) - 可能是最好的例子：
> 
> 如果 comparefn 不是未定义的并且不是此数组元素的一致比较函数，则 sort 的行为是**实现定义的**。
> 
> [...] 如果 proto 不为 null 并且存在一个整数 j 使得满足以下所有条件，那么 sort 的行为是**实现定义的**：
> 
> *   obj 是稀疏的 (15.4)
> *   0 ≤ j < 长度
> 
> 如果 obj 是稀疏的并且以下任何条件为真，则排序的行为也是**实现定义的：**
> 
> *   obj 的 [[Extensible]] 内部属性为 false。
> *   名称为小于 len 的非负整数的 obj 的任何数组索引属性都是 [[Configurable]] 属性为 false 的数据属性。
> 
> 如果 obj 的名称为小于 len 的非负整数的任何数组索引属性是访问器属性或者是 [[Writable]] 属性为 false 的数据属性，则排序的行为也由**实现定义。**

最突出的是：

> 执行**依赖**于实现的调用序列 […]

> [15.5.4.9 String.prototype.localeCompare(那个)](http://es5.github.com/#x15.5.4.9)
> 
> 两个字符串以**实现定义的**方式进行比较

> [15.5.4.11 String.prototype.replace](http://es5.github.com/#x15.5.4.11) [在替换符号中，如果数量大于组数]，结果是**实现定义的**。

我将在此处停止列出，您可以通过规范搜索。其他值得注意的地方可能是`toLocaleString`方法，或者方法返回的*依赖于实现的近似值*`Math`。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-02-13T21:33:20.443

我发现了几个例子，引用[了 ECMAScript 语言规范](http://www.ecma-international.org/publications/standards/Ecma-262.htm)（强调我的）：

### [8.5 数字类型](http://www.ecma-international.org/ecma-262/5.1/#sec-8.5)

> **在某些实现**中，外部代码可能能够检测各种非数字值之间的差异，但这种行为是**依赖于实现的**；对于 ECMAScript 代码，所有 NaN 值彼此无法区分。

### [15.7.4.5 Number.prototype.toFixed (fractionDigits)](http://www.ecma-international.org/ecma-262/5.1/#sec-15.7.4.5)

> 如果使用多个参数调用 toFixed 方法，则**行为未定义**（参见第 15 节）。

### [15.7.4.6 Number.prototype.toExponential (fractionDigits)](http://www.ecma-international.org/ecma-262/5.1/#sec-15.7.4.6)

> 如果使用多个参数调用 toExponential 方法，则**行为未定义**（参见第 15 节）。

### [15.7.4.7 Number.prototype.toPrecision（精度）](http://www.ecma-international.org/ecma-262/5.1/#sec-15.7.4.7)

> 如果使用多个参数调用 toPrecision 方法，则**行为未定义**（参见第 15 节）。

### [15.9.4.3 Date.UTC（年、月[、日期[、小时[、分钟[、秒[、毫秒]]]]]）](http://www.ecma-international.org/ecma-262/5.1/#sec-15.9.4.3)

> 当使用少于两个参数调用 UTC 函数时，行为**取决于实现**。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-13T21:33:52.433

我发现

`Array.sort(compareFunction);`

在 compareFunction 行为不正常的情况下（即为相同的输入返回一致的结果）。

从[规范](http://es5.github.com/#x15.4.4.11)：

> 如果 comparefn 不是未定义的并且不是此数组元素的一致比较函数（见下文），则排序的行为是实现定义的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-02-16T03:12:15.890

任何调用 C 风格的未定义行为以响应任何输入的程序都不适合与不可信的输入一起使用。尽管在许多情况下 ECMAScript 规范没有指定精确的行为，但它并没有给实现与 C 编译器具有未定义行为相同的自由来否定时间定律和因果关系。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-05-31T14:41:04.477

首先，定义非正式称为 JavaScript 的语言的 ECMA-262 标准使用术语“实现依赖”和“实现定义”，而没有定义这些术语的含义。实际上，所有这些行为都是未定义的；对于应该发生的事情没有给出任何要求。崩溃或行为不可预测的实现是符合要求的；当然，如果它记录了该行为：那么崩溃或不稳定的行为就是实现所定义的。相比之下，ISO C 标准正式定义了诸如“未指定行为”、“实现定义的行为”和“未定义的行为”之类的术语。这些词无论出现在哪里，实际上都意味着某种东西。

其次，ECMA-262 标准对实施限制保持沉默。这并不意味着他们不在那里。例如，给定特定实现中的 Javascript 程序可以有任何深度的递归吗？任意数量的函数参数？任何深度的词法作用域？它可以分配任意数量的对象吗？当然不是，对吧？**“limit”这个词甚至没有出现在 ECMA-262 2018 的任何地方，除了作为函数参数名称。**例如，该文档没有说 ECMAScript 的一致实现必须允许具有 64 个参数的函数。因此，实现必须支持带有任意数量参数的函数是有道理的。如果我们用一千万个参数做一个函数，然后实现崩溃，它就是不合格的；ECMA-262 没有任何地方声明允许这种故障。如果 C 编译器由于函数中的一千万个参数而崩溃，我们可以明确指出这是程序中的一个问题：它超过了标准中记录的最小实现限制，因此无法*严格遵守*（正式术语）。这是一种未定义行为的情况：它涉及一个不可移植的程序，标准对此没有任何要求（不需要实现来处理那么多函数参数）。

# java - 使用 Arrays.sort() 方法对类型对象的数组进行排序

> ID：14863433
> 
> 赞同：3
> 
> 时间：2013-02-13T21:24:43.637
> 
> 标签：java, comparison, sorting

我知道如何使用 Arrays.sort() 方法以下列方式对对象数组进行排序。

```
Arrays.sort(array of primitive type);   
Arrays.sort(array of primitive type, from, to); 
Arrays.sort(array of an object type);   
Arrays.sort(array of an object type , from, to); 
```

但我不知道以下两种方法。

```
Arrays.sort(array of an object type , comparator);  
Arrays.sort(array of an object type , from, to, comparator); 
```

有人可以让我知道如何使用这些方法对类型对象数组进行排序。我要求您添加代码或任何指向 .java 类的链接。我试图搜索它但找不到它。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:28:12.760

例子：

```
class Person{  
   int id;  
   public getId(){return this.id;}  
//Other  stuff in your custom class
}  

Person[] persons = ...;//An array of person you get from somewhere
Arrays.sort(persons,new Comparator<Person>(){  
    @Override  
    public int compare(Person p1, Person p2){  
         return p1.getId() - p2.getId();  
   }  
} ); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:44:11.697

这很简单：

比较器界面使您可以控制对对象进行排序的方式。

对象可以基于您明智的键。

例如，Account 对象应根据 AccountNumber 进行排序

```
class Account {
    String AccountNumber; //Key 1 
    String AccountName;   //Key 2
    String GovtID;        //Key 3 
} 
```

您可以按三个键中的任何一个进行排序。

为了控制排序，您必须定义一个实现 Comparator 接口的类，它将定义用于排序的逻辑。

```
class SortAccountByNumber implements Comparator<Account> {
    //Implement Unimplemented method 
    @Override
    public int compare(Account a1, Account a2) {
        //Read the specification for this method here in the Java Doc.
        return 0;
    }

} 
```

现在要使用它，只需调用

```
 SortAccountByNumber varSortAccountByNumber = new SortAccountByNumber();
  Arrays.sort(arrayOfAccounts,varSortAccountByNumber); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:31:59.577

这是一个未内联定义比较器的示例。

无论哪种方式都是可以接受的，但我认为这种方式更容易理解。

```
class Person {
   int id;  
   public getId(){
       return this.id;
   }  
}

class PersonComparator implements Comparator<Person> {
    @Override
    public int compareTo(Person personOne, Person personTwo) {
        reuturn personOne.getId() - personTwo.getId();
    }
} 
```

用法：

```
Person[] personArray = buildArraySomehow();
PersonComparator pc = new PersonComparator();
Arrays.sort(personArray, pc); 
```

Comparator 是一个只有一个方法的接口：compareTo。

创建比较器时，这是您需要实现的唯一方法。

请注意，*PersonComparator.compareTo()*只返回两个 Person 对象的 ID 的差异。

这是因为*compareTo()*方法应该如何工作：

*   如果第一项“*在*”第二项之前，则应返回负数。
*   如果第一项“*在*”第二项之后，则应返回一个正数。
*   如果这两个项目是等价的（就排序而言），则应返回零。

查看[Comparator](http://docs.oracle.com/javase/7/docs/api/java/util/Comparator.html)的文档以获取更多信息...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:36:51.073

对于复杂的对象，Java 不知道如何比较它们。因此，您需要编写一个比较器。通常，您选择必须比较的类的成员。

```
public class Comp implements Comparator<Test> {

    @Override
    public int compare(Test t, Test t1) {
       return what_you_want_to_compare;
    }    
} 
```

# database - 谁触发了我的触发器？

> ID：14863435
> 
> 赞同：2
> 
> 时间：2013-02-13T21:24:49.373
> 
> 标签：database, triggers, db2, sql-execution-plan

我的情况：
我想使用我在 db2 中的一个真正敏感的表来制作一个历史表。
普通用户正在通过一些静态计划（已经编译）访问该表。

我想要什么：
我需要记录时间，而世卫组织对此进行了更新。

我打算使用触发器，因为它似乎符合我的需求，但我仍然不知道如何进入“触发触发器”的触发器。
我的意思是，要知道调用静态计划的批处理或可执行文件。

注意：由于每个可执行文件都使用不同的计划，因此获取某种计划 ID 是可以接受的。

可行吗？我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T05:46:06.290

有一个特殊的 DB2 寄存器称为`USER`，它存储授权 id 的信息。您可以像在触发器的插入或更新查询中使用 TIMESTAMP 一样使用它。

```
SET HIST_LAST_UPDATE_USER = USER; 
```

如果您对架构没问题，那么您也可以使用 CURRENT SCHEMA 或 CURRENT SQLID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T16:26:01.623

如果其他人需要它，我能够找到方法：

```
GETVARIABLE(SYSIBM.SYSPLAN); 
```

# watir - 点击表格中返回的搜索结果链接

> ID：14863439
> 
> 赞同：0
> 
> 时间：2013-02-13T21:25:09.933
> 
> 标签：watir

我想单击表格中的链接。表中的链接是搜索结果，因此会根据您搜索的内容而变化。我希望单击表中的第一个链接。

html是：

```
<div data-bind="visible: HasSearchResults">
    <table class="table table-bordered table-striped">
        <tbody data-bind="template: { name: 'productSelectTemplate', foreach: SearchResults }">
            <tr>
                <td>
                <a href="#" class="autoResult" data-bind="text: id + '  (' + name + ')', click: function() { this.SelectProduct(); }">1724612110  (Nike item1)</a>
                </td>
            </tr>

            <tr>
                <td>
                 <a href="#" class="autoResult" data-bind="text: id + '  (' + name + ')', click: function() { this.SelectProduct(); }">5110000601  (Nike item2)</a>
                </td>                  
            </tr>

            <tr>
                <td>
                 <a href="#" class="autoResult" data-bind="text: id + '  (' + name + ')', click: function() { this.SelectProduct(); }">5110000602  (Nike item3)</a>
                </td>
            </tr>

        </tbody>
    </table>
</div> 
```

有人知道怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:38:18.683

您可以通过索引获取元素（相对于正在搜索的容器）。请注意，它是从零开始的索引，因此第一个链接将是索引 0。

以下将单击表中的第一个链接：

```
search_results_table = browser.table(:class => 'table table-bordered table-striped')
search_results_table.link(:index => 0).click 
```

请注意，`:index => 0`默认情况下 包含在定位器中，因此您实际上可以省略它：

```
search_results_table.link.click 
```

# linux - 将 GIT 与 Jenkins 集成

> ID：14863440
> 
> 赞同：0
> 
> 时间：2013-02-13T21:25:15.460
> 
> 标签：linux, git, github, jenkins

我正在尝试将 git repo-url 添加到 jenkins，以便 jenkins 可以构建我的代码并运行一些测试。但是我使用的仓库是私有的，这就是我遇到问题的地方。这是我在源代码管理下的 Jenkins 中添加 GIT repo url 时遇到的错误-

```
 Failed to connect to repository : Command "/usr/local/bin/git ls-remote -h 
    git@github.com:xxxx/xxx.git HEAD" returned status code 128:
    stdout:
    stderr: ERROR: Repository not found.
    fatal: The remote end hung up unexpectedly 
```

我知道造成这种情况的一个原因是因为 repo 是私有的，它需要用户名和密码才能进行身份验证。关于如何将其设为无密码身份验证的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-04T07:58:50.340

以下链接可能对您有所帮助 -

> [https://github.com/Tozkoparan/Deneme/wiki/Setup-Jenkins-for-working-with-a-private-Github-repository](https://github.com/Tozkoparan/Deneme/wiki/Setup-Jenkins-for-working-with-a-private-Github-repository)
> 
> [http://fourkitchens.com/blog/2011/09/20/trigger-jenkins-builds-pushing-github](http://fourkitchens.com/blog/2011/09/20/trigger-jenkins-builds-pushing-github)

# php - mysqli错误调试

> ID：14863441
> 
> 赞同：0
> 
> 时间：2013-02-13T21:25:15.553
> 
> 标签：php, mysqli

我一直在构建一个 xml 解析器，应该从一个文件夹中删除所有 xml 文件，并且在解析主题后应该将数据保存在 mysql 表中。毕竟我收到以下错误。我不确定我做错了什么以及我应该如何调试它。

```
Warning: mysqli::prepare(): Couldn't fetch mysqli in E:\xampp\htdocs\XML_Parser\index.php on line 38 
```

我的代码

```
class XMLFeeds{

    public $obj;

    protected $db_connect;

    function __construct(){     
        // Read feeds and pass it to parser
        $this->db_connect = @new mysqli('loalhost', 'root', '', 'test');
        foreach(glob("feeds/*xml") as $filename) {
            $obj = $this->parsing_feed(file_get_contents($filename, FILE_TEXT) );
            $this->saveFeed($obj);
        }   
    }

    function parsing_feed($feed){       
        return simplexml_load_string($feed);        
    }   

    function saveFeed($obj){
        foreach ($obj as $row){

                $stmt = $this->db_connect->prepare("INSERT INTO tbl 
                        ( id,
                          prod_name,
                          category,
                          description,
                          image_url,
                          keywords,
                          sku,
                          target_url,
                          price,
                          warranty,
                          shipping_costs,
                          impressionurl,
                          lastupdated ) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)");

                if ($stmt === FALSE) {
                    die($mysqli->error);
                }

                $stmt -> bind_param("ssi",
                         $row->name,
                         $row->advertisercategory,
                         $row->description,
                         $row->imageurl,
                         $row->keywords,
                         $row->sku,
                         $row->buyurl,
                         $row->price,
                         $row->standardshippingcostm,
                         $row->impressionurl,
                         $row->lastupdated );
                $stmt ->execute();
        }
    }
}

$parse = new XMLFeeds(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:40:05.750

发生这种情况是因为 localhost 拼写错误，未成功建立与数据库的连接。您在使用@new 实例化 mysqli 类期间省略了错误。

尝试删除@并检查是否没有通过异常建立连接，否则它将继续执行代码。

```
 <?php
    $this->db_connect = new mysqli('localhost', 'root', '', 'zanox');
    if($this->db_connect->connect_error){
       throw new Exception('unable to connect, '. $this->db_connect->connect_error);
    } 
```

# c# - 在屏幕右下角显示表格？

> ID：14863443
> 
> 赞同：1
> 
> 时间：2013-02-13T21:25:21.260
> 
> 标签：c#, .net, notifications, taskbar

我正在创建一个基于显示用户应该接受或拒绝的一些通知的应用程序

如何在屏幕右下角**而不是任务栏上方**显示申请表？

![在此处输入图像描述](../Images/b5e9621946e22f36814dd7aa7646a2ff.png)

代码 ：

```
notificationForm ntf = new notificationForm();
ntf.ShowDialog(); 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-13T21:34:57.170

试试这个：

```
 int x = Screen.PrimaryScreen.WorkingArea.Width - this.Width;
        int y = Screen.PrimaryScreen.WorkingArea.Height - this.Height;
        this.Location = new Point(x, y); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T21:35:15.910

如果您确实必须将通知放在特定位置，那么您需要使用

> [SystemParameters.WorkArea 属性](http://msdn.microsoft.com/en-us/library/system.windows.systemparameters.workarea.aspx)

哪一个

> 获取主显示监视器上工作区的大小。

对于 WPF 应用程序。

或者

> [Screen.WorkingArea 属性](http://msdn.microsoft.com/en-us/library/system.windows.forms.screen.workingarea.aspx)

得到

> 工作区域是显示器的桌面区域，不包括任务栏、停靠的窗口和停靠的工具栏。

对于 WinForms 应用程序。

这也可以像这样得到：

```
Rectangle workingRectangle = Screen.PrimaryScreen.WorkingArea; 
```

根据这些信息，您将能够将您的窗口放置在您喜欢的任何位置。

# python - Paramiko / ssh / tail + grep 挂起

> ID：14863445
> 
> 赞同：10
> 
> 时间：2013-02-13T21:25:30.867
> 
> 标签：python, ssh, grep, paramiko, tail

情况：我想用 paramiko 通过 ssh 跟踪远程日志。

channel.exec_command('tail -f log.log') 工作正常

channel.exec_command('tail -f log.log | grep "filter" ') 挂起

无法理解带有 grep 的 tail 挂起的原因。

代码示例：

```
import paramiko
import select
import re

interesting_line_pattern = re.compile('xxx')

def do_tail():
    client = paramiko.SSHClient()
    client.load_system_host_keys()
    client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
    from os.path import expanduser
    home = expanduser("~")
    client.connect('xxx',
                   username='xxx',
                   key_filename='%s/.ssh/id_rsa' % home)

    log_file = '/home/xxx/log.log'
    grep_pattern = "grep_filter"
    remote_command = 'tail -f %s | grep "%s" ' % (log_file, grep_pattern)
    print remote_command

    transport = client.get_transport()
    channel = transport.open_session()
    channel.exec_command(remote_command)

    while 1:
        try:
            rl, _, _ = select.select([channel], [], [], 0.0)
            if len(rl) > 0:
                print "ready to read"
                for line in linesplit(channel):
                    print line

        except (KeyboardInterrupt, SystemExit):
            print 'got ctrl+c'
            break

    client.close()
    print 'client closed'

def linesplit(socket):
    buffer_string = socket.recv(4048)
    done = False
    while not done:
        if "\n" in buffer_string:
            (line, buffer_string) = buffer_string.split("\n", 1)
            yield line + "\n"
        else:
            more = socket.recv(4048)
            if not more:
                done = True
            else:
                buffer_string = buffer_string + more
    if buffer_string:
        yield buffer_string

if __name__ == '__main__':

    do_tail() 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-14T19:12:02.150

`grep`认为它没有写入终端，因此它正在缓冲其输出。它的输入没有足够的行匹配它来写它的任何输出，所以你认为它已经挂起。

尝试给出`grep`选项`--line-buffered`。例如

```
channel.exec_command('tail -f log.log | grep --line-buffered "filter" ') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-11-20T11:20:02.817

让我分享一下 python >= 3.6 的**linesplit**函数更新

```
def linesplit(socket):
buffer_bytes = socket.recv(4048)
buffer_string = buffer_bytes.decode()
done = False
while not done:
    if "\n" in buffer_string:
        (line, buffer_string) = buffer_string.split("\n", 1)
        yield line + "\n"
    else:
        more = socket.recv(4048)
        if not more:
            done = True
        else:
            buffer_string = buffer_string + more.decode()
if buffer_string:
    yield buffer_string 
```

# winforms - 在 listView 项目删除时崩溃？

> ID：14863446
> 
> 赞同：0
> 
> 时间：2013-02-13T21:25:33.057
> 
> 标签：winforms, visual-c++, listview, crash

我使用以下内容清除整个 listView

```
void Form1::button2_Click(System::Object^  sender, System::EventArgs^  e)
{
    ActiveControl = tabControl1->SelectedTab;

    if (listView3->Items->Count == 0)
    {
        ::MessageBox(0, "Please select data.", "Failed to clear data.", MB_OK | MB_ICONERROR);
    }
    else
    {
        listView3->Items->Clear();
    }
} 
```

然后我尝试使用以下内容清除所选项目...但它崩溃了...

```
void Form1::listView3_ItemCheck(System::Object^  sender, System::Windows::Forms::ItemCheckEventArgs^  e)
{
    listView3->Items[e->Index]->Remove();
} 
```

我会用什么替换我的删除功能，这样它就不会崩溃？

编辑：这就是我添加到我的 listView3 的方式...

```
 ListViewItem^ subitem = gcnew ListViewItem();

    subitem->SubItems->Add(textBox2->Text);

    listView3->Items->Add(subitem); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:28:17.607

如果该索引处的元素是空引用，您可能必须使用不同的方法。

尝试使用项目集合的 RemoveAt 功能，如下所示：

```
if (e->Index >= 0 && e->Index < listView3->Items->Count)
{        
    listView3->Items->RemoveAt(e->Index);
} 
```

# .net - .net Wrapper 中 QuickFix 中的数据字典

> ID：14863450
> 
> 赞同：0
> 
> 时间：2013-02-13T21:25:53.650
> 
> 标签：.net, quickfix

我正在使用 QuickFix .Net Dll 来接收和处理 TradeCaptureReport 消息。我收到了一条包含一些自定义字段的 TradeCaptureReport 消息。

我可以使用各种 get*() 方法从消息中提取一些值，但是，当我尝试使用 getGroup(...) 方法时，我得到了 FieldNotFound 异常。

```
var msg = new QuickFix44.TradeCaptureReport();
msg.setString(@"8=FIX.4.49=52435=AE...");
var noSides = new QuickFix44.TradeCaptureReport.NoSides();
msg.getGroup(1, noSides); 
```

这可能是由自定义字段的存在引起的吗？恰好出现在我要阅读的重复组之前？如果是这样，如何最好地更改 FIX44.xml 文件中的数据字典？

此外，在 Message.GetGroup( **uint num** , Group g)

参数 num 是什么意思？找到的所有示例[http://www.quickfixengine.org/quickfix/doc/html/repeating_groups.html](http://www.quickfixengine.org/quickfix/doc/html/repeating_groups.html)暗示它是您正在寻找的组的第 n 个实例，但如果有人可以确认我会很感激。

**编辑** 感谢您的评论/答案

我对这个组感到困惑......使用 has group 返回 false

```
 var noSides = new QuickFix44.TradeCaptureReport.NoSides();
        var p = msg.hasGroup(noSides); 
```

但我的消息显然有一个 552 标签，当我这样做时

```
 var q = msg.getNoSides(); 
```

它返回值为 1 的 QuickFix.NoSides。

整条留言如下。8=FIX.4.49=52435=AE49=ICE34=4052=20130213-14:44:57.37756=922257=42571=69487=0856=0828=0150=F17=1300946539=2570=N55=21914748=BRN FMH10146101 = FXXXXX916 = 20130301917 = 2013033132 = 26.031 = 12.09018 = 269022 = 175 = 2013021360 = 20130213-14：44：57.3759413 = 0552 = 154 = 237 = 1300955611 = 170339730453 = 7448 = someTrader447 = D452 = 11448 = SomePartyIdFirm447 = D452 = 13448 = 9222447 =D452=56448=8558447=D452=4448=SomePartyId1447=D452=51448=SomePartyId2447=D452=60448=U447=D452=5410=252

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:22:38.423

```
msg.getGroup(1, noSides) 
```

在执行此操作之前，请检查是否有任何组或确认组数或边数字段是否设置或具有大于 0 的值（如果相关）。否则你怎么知道要提取多少组。

```
Could this be caused by the existence of the custom fields? 
```

不必要

```
Message.GetGroup(uint num, Group g) 
```

**num**是 Group 类型的 FIX 消息中的第 num 个组。

# php - 无法让 Aptana 识别 php 包含

> ID：14863452
> 
> 赞同：1
> 
> 时间：2013-02-13T21:26:15.493
> 
> 标签：php, html, ide, aptana

我正在尝试设置 Aptana 3 来处理我目前正在使用 Dream Weaver 处理的 html/css/js/php 项目。似乎 php 没有被完全识别或设置不正确。例如对于线

```
<?php include_once "includes/header.php"; ?> 
```

我收到关于缺少“>”的错误

我首先尝试将项目作为 php 项目导入，其中“web”和“php”被选为性质。

我还尝试创建一个新的 php 项目并粘贴到文件中。

我还确保文件在 php 编辑器中打开。

我是否错过了为 php 设置 Aptana 的关键步骤？

非常感谢帮助，谢谢！

# asp.net - 如何从 ObjectDataSource 返回错误？

> ID：14863456
> 
> 赞同：0
> 
> 时间：2013-02-13T21:26:27.580
> 
> 标签：asp.net, objectdatasource

我使用 objectDataStore 从表单中插入记录。但是当插入数据库时​​，我可能会得到一个错误。如果我得到一个错误，我想在一个字段中显示它。但是如何将一些数据返回到 aspx 文件中呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T06:10:58.297

在代码隐藏中为 ObjectDataSource Updated 事件创建一个处理程序。此处理程序的参数之一是 ObjectDataSourceStatusEventArgs 类型。如果更新时发生异常，则事件参数包含一个异常对象。您需要做的就是测试 Exception 对象不为空，然后在其中插入您想要的任何代码。

以下是处理程序方法的代码示例：

```
protected void MyObjectDataSource_Updated(object sender, ObjectDataSourceStatusEventArgs e)
{
    if (e.Exception != null)
    {
        // populate your field here
        lblMessage.Text = e.Exception.Message
    }
} 
```

这是 ObjectDataSource 标记：

```
<asp:ObjectDataSource
    ID="MyObjectDataSource"
    runat="server"
    UpdateMethod="Update"
    OnUpdating="MyObjectDataSource_Updated"
    TypeName="Your.Custom.Object" /> 
```

[此处](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.objectdatasourcestatuseventargs%28v=vs.110%29.aspx)的此链接包含一个示例，但它用于“删除”和“已删除”事件。您将希望使用相同的代码，但要为“更新”事件实现。

# wcf - WCF JSONP 条件缓存

> ID：14863457
> 
> 赞同：1
> 
> 时间：2013-02-13T21:26:30.283
> 
> 标签：wcf, http, http-caching

使用跨域 WCF 服务，我似乎无法通过 JSONP 响应获得条件缓存。

当请求的 If-None-Match 值与 Etag 匹配时，我希望得到状态代码为 304 Not Modified 且响应正文为空的响应。相反，我得到一个 200 OK 的响应状态代码，正文中有一个垃圾 JSONP 字符串。

网络配置

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <system.web>
      <authentication mode="None" />
    <caching>
      <outputCache enableOutputCache="true"/>
      <outputCacheSettings>
        <outputCacheProfiles>
          <add name="ResourceSet" location="Server" duration="30" varyByParam="skip; take" varyByHeader="Accept"/>
          <add name="Resource" location="Any" duration="30" varyByParam="" varyByHeader="Accept"/>
        </outputCacheProfiles>
      </outputCacheSettings>
    </caching>
  </system.web>

  <system.serviceModel>
    <standardEndpoints>
      <webHttpEndpoint>
        <standardEndpoint
          automaticFormatSelectionEnabled="true"
          helpEnabled="true" crossDomainScriptAccessEnabled="true" />
      </webHttpEndpoint>
        <webScriptEndpoint>
            <standardEndpoint crossDomainScriptAccessEnabled="true"></standardEndpoint>
        </webScriptEndpoint>
    </standardEndpoints>
    <serviceHostingEnvironment aspNetCompatibilityEnabled="true" />
  </system.serviceModel>
</configuration> 
```

服务方式：

```
 [WebGet(UriTemplate = "/{key}")]
    public Resource GetResource(string key)
    {
        ValidateArguments(key);

        Resource resource = resourceRepository.Get(ParseResourceKey(key));

        if (resource == null)
            throw new WebFaultException(HttpStatusCode.NotFound);

        WebFaultException(HttpStatusCode.NotModified);
        Request.CheckConditionalRetrieve(resource.Version);

        // If the caller did not provide an ETag (or it was not a match)
        // Set the ETag on the response message
        Response.SetETag(resource.Version);

        return resource;
    } 
```

要求

```
 GET http://localhost:1128/CannonicalRESTService.svc/1?callback=jsonpCallback HTTP/1.1
    User-Agent: Fiddler
    Host: localhost:1128
    Accept: application/json
    If-None-Match: "9bb40c00-5de9-463e-8b7d-1105c36318c8" 
```

预期响应

```
 HTTP/1.1 304 Not Modified
    Server: ASP.NET Development Server/10.0.0.0
    Date: Wed, 13 Feb 2013 21:20:05 GMT
    X-AspNet-Version: 4.0.30319
    Content-Length: 15
    ETag: "9bb40c00-5de9-463e-8b7d-1105c36318c8"
    Cache-Control: private
    Content-Type: application/x-javascript
    Connection: Close 
```

实际反应

```
 HTTP/1.1 200 OK
    Server: ASP.NET Development Server/10.0.0.0
    Date: Wed, 13 Feb 2013 21:20:05 GMT
    X-AspNet-Version: 4.0.30319
    Content-Length: 15
    ETag: "9bb40c00-5de9-463e-8b7d-1105c36318c8"
    Cache-Control: private
    Content-Type: application/x-javascript
    Connection: Close

    jsonpCallback(null,304); 
```

[代码是从http://code.msdn.microsoft.com/cannonicalRESTEntity](http://code.msdn.microsoft.com/cannonicalRESTEntity)借来的。我所做的只是将 crossDomainScriptAccessEnabled="true" 添加到 web.config。

我很感激你的时间。

# php - 密码重置表单mysql和php

> ID：14863458
> 
> 赞同：0
> 
> 时间：2013-02-13T21:26:31.840
> 
> 标签：php, mysql

有人可以帮我，我的密码重置表格有点乱，我对 php 和 mysql 真的很陌生，所以请不要怪我弄错了。但我确实需要一些帮助。

基本上一切正常，它允许用户输入电子邮件，然后向他们发送新密码。（我没有附加发送电子邮件/密码位的代码，因为我不需要帮助。）唯一的问题是它没有检查电子邮件，它没有检查电子邮件是否存在于我的数据库中并且它允许用户输入在他们想要的任何电子邮件中。但是，如果他们键入不在数据库中的电子邮件，我希望它说对不起，不存在该类型的电子邮件或其他东西。我需要知道如何获取它来检查用户键入的电子邮件是否确实存在。

然后要么说电子邮件已发送，要么有问题。

```
<?php
    $page_title = "Login";
    include('includes/header.php');
    include ('includes/mod_login/login_form2.php'); 

    if(!isset($_GET['err']) || isset($_GET['err'])=='') {
    $_GET['err'] = '0';
    }       
    ?>

    <?   
    $html_form = "<form name=\"forgotpasswordform\" action=\"sendpassword.php\" method=\"post\">
              <table border=\"0\" cellspacing=\"0\" cellpadding=\"3\" width=\"100%\">
                <tr>
                  <td width=\"15%\">Email Address:</td>
                  <td><input name=\"forgotpassword\" type=\"text\" value=\"\" id=\"forgotpassword\" size=\"30\"/></td>
                </tr>
                <tr>
                <td>&nbsp;</td>
                </tr>
                 <tr>
                  <td colspan=\"2\"><input type=\"submit\" name=\"submit\" value=\"Submit\" class=\"mainoption\" /></td>
                </tr>
              </table>
            </form>";

    if ($_GET['err'] == '1') { //error if message is not filled ?>

            <? echo $html_form; ?>

       <?

    } else if ($_GET['err'] == '2') { // error if email is not found

        ?>
            <h1>&nbsp;</h1>
            <p>
            Email Not Found!
            </p>
            <br />
        <?

    } else if ($_GET['err'] == '3') { // EMAIL SENT :D

         ?>
            <h1>&nbsp;</h1>
            <p>
            Thanks! Your new password has been sent.
            </p>
            <br />
        <?

    } else if ($_GET['err'] == '0') { // otherwise print email form 
       ?>

            <? echo $html_form; ?>    

        <? 
    }

    ?> 
```

然后我们链接到 sendpassword.php：

```
<?php

/**
 * ShuttleCMS - A basic CMS coded in PHP.
 * Password Reset - Used for allowing a user to reset password
 * 
 * @author Dan <dan@danbriant.com>
 * @version 0.0.1
 * @package ShuttleCMS
 */
define('IN_SCRIPT', true);
// Start a session
session_start();

//Connect to the MySQL Database
include 'includes/_config/connection.php';

/*
 * Checks form field for email  
 */

if ($_POST['forgotpassword']=='') {
        header('Location: http://localhost/ptb1/recover_password.php?err=1');
}
if(get_magic_quotes_gpc()) {
        $forgotpassword = htmlspecialchars(stripslashes($_POST['forgotpassword']));
} 
else {
        $forgotpassword = htmlspecialchars($_POST['forgotpassword']);

}

/*
 * Checks if the email exists
 */

$sql = "SELECT COUNT(*) FROM ptb_users WHERE email = '$forgotpassword'";
$result = mysql_query($sql)or die('Could not find member: ' . mysql_error());

if (!mysql_result($result,0,0)>0) {
    header('Location: http://localhost/ptb1/recover_password.php?err=2');
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:33:05.790

你正在寻找这样的东西：

```
if(mysql_num_rows($result)) {
    // user found
} else {
    // no user found
} 
```

请记住，您的代码对 sql 注入是开放的，您不应该使用`mysql_`扩展。请改用[PDO](http://php.net/manual/en/book.pdo.php)。

# java - 从 DTO 类获取 REST xml

> ID：14863460
> 
> 赞同：1
> 
> 时间：2013-02-13T21:26:34.000
> 
> 标签：java, rest

我正在做一些 REST Web 服务工作，并且很多 PUTS 正在学习 DTO 课程。其中一些类非常大。有什么东西可以用来获取这些类的 XML 表示吗？我发现通过 DTO 并尝试制定 XML 结构非常耗时。我不可避免地会出错几次，所以它变得很耗时。

有没有办法在 Java 中获取标准 bean 类的 XML 表示？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:41:02.583

是的，这就是 jaxb 注释很方便的地方：

要得到：

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<car registration="abc123">
  <brand>Volvo</brand>
  <description>Sedan</description>
</car> 
```

由此：

```
public class Car {
  private String registration;
  private String brand;
  private String description;
} 
```

使用这些注释：

```
@XmlRootElement
@XmlType(propOrder = {"brand", "description"})
public class Car {
  private String registration;
  private String brand;
  private String description;

  @XmlAttribute
  public String getRegistration() {
      return registration;
  }

  public String getBrand() {
      return brand;
  }

  public String getDescription() {
      return description;
  } 
```

}

注意：为简洁起见，我删除了 setter/constructors。

来自[http://thomassundberg.wordpress.com/2010/01/19/how-to-convert-a-pojo-to-xml-with-jaxb/](http://thomassundberg.wordpress.com/2010/01/19/how-to-convert-a-pojo-to-xml-with-jaxb/)，这是一个很好的起点。

# jquery - 使用 jquery 将内容区域设置为带有粘性页脚的页面高度

> ID：14863461
> 
> 赞同：0
> 
> 时间：2013-02-13T21:26:46.550
> 
> 标签：jquery, html, height, footer

[http://www.playerspace.com/index.cfm/action/aboutus](http://www.playerspace.com/index.cfm/action/aboutus)

我正在使用 jquery 设置一个粘性页脚，其中内容不延伸到折叠下方。

如果我没有的话，浏览器窗口底部的页脚下会有空间。

不幸的是，在发生这种情况的页面上，例如上面包含的链接，内容区域在容器底部和粘性页脚之间存在间隙。

谁能告诉我如何设置白色内容容器的高度以在页面加载时使用 jquery 来满足页脚？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:36:51.500

你可以在没有 jQuery 的情况下做到这一点。

设置您希望填充整个页面的`height: 100%`容器以及所有父容器，包括`body`, 和`html`.

**来源：[http ://css-tricks.com/snippets/css/sticky-footer/](http://css-tricks.com/snippets/css/sticky-footer/)**

# enums - 如何区分枚举名称和枚举索引项？

> ID：14863464
> 
> 赞同：1
> 
> 时间：2013-02-13T21:26:59.343
> 
> 标签：enums, terminology

当我谈论枚举时，我与我的队友交流很糟糕。我永远无法正确区分我正在谈论的枚举的哪一部分。

```
enum PowerLevel {
    Low,
    Medium,
    High
} 
```

`Low`, `Medium`,`High`是枚举的哪一部分？

是什么部分`PowerLevel`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:38:55.900

我说“Powerlevels”是枚举的名称。“低”、“中”和“高”是枚举的成员。这些有时也称为命名常量或元素。

此页面实际上使用了所有三个名称： http: [//msdn.microsoft.com/en-gb/library/sbbt4032 (v=vs.80).aspx](http://msdn.microsoft.com/en-gb/library/sbbt4032(v=vs.80).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:35:54.730

[枚举](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)是功率级别。它具有三个不同的值/实例：低、中和高。

Low 是 powerlevels 的一个实例，并且保证是一个单例。

# c - 使用 write() 打印到控制台

> ID：14863465
> 
> 赞同：2
> 
> 时间：2013-02-13T21:27:02.260
> 
> 标签：c

所以我试图创建一个使用 write() 系统调用（printf 和其他选项不可用）将字符串输出到控制台的函数。然而，我遇到了一个障碍。

这是我的功能：

```
static void doPrint (const char *s)
{
    write (STDOUT_FILENO, s, sizeof(s));
} 
```

由以下人员调用：

> doPrint ("Hello World!\n");

但是，它只打印出来：

> 你好沃

我究竟做错了什么？

注意：对 stdlib 和 stdio 的访问受到限制

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:28:39.017

在这种情况下`sizeof`不会做你想要的 - 它产生指针的大小，而不是字符串的大小。改为使用`strlen`。

> 但对标准库的访问受到限制

`while`您可以使用 a和计数器滚动自己。未经测试：

```
size_t my_strlen(const char *s)
{
    size_t len = 0;
    while (*s++)
        len++;

    return len;
} 
```

或更高效的版本：

```
size_t my_strlen(const char* s)
{
   const char *end = s;
   while (*end++) {};
   return end-s-1;
} 
```

上面的工作是因为指针前进到字符串中的最后一个位置，然后大小是最后一个指针位置和第一个指针位置之间的差异，减 1 当然可以处理空终止字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:29:06.257

`s`是一个指针，而不是一个数组，所以你只打印第一个`sizeof(char *)`字节（在这种情况下它恰好是 8 - 你可能使用的是 64 位系统）。

您必须使用以下方法找到字符串的长度`strlen()`：

```
write (STDOUT_FILENO, s, strlen(s)); 
```

您还应该阅读[这份文件](http://c-faq.com/aryptr/aryptr2.html)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:29:13.427

`write (STDOUT_FILENO, s, strlen(s));`假设您的字符串以空值结尾。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:28:39.470

问题是你的`sizeof`. 您需要显式传递大小或使用`strlen`. 它正在占用指针的大小。`strlen`仅适用于以空字符结尾的字符串。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T21:28:42.460

问题是`sizeof`指针变量是指针变量的长度。您想`strlen(s)`知道指针上有多少个字符。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-13T21:28:49.890

你不想`sizeof(s)`。您要打印的字符数是字符串的长度，而不是指向字符串中第一个字符的指针的大小。

# testing - 如何运行不同的课程......同时开始

> ID：14863467
> 
> 赞同：1
> 
> 时间：2013-02-13T21:27:07.453
> 
> 标签：testing, testng

我在 testng 中运行了以下 xml，我发现即使这些类在不同的线程中运行，它们也是按顺序运行的.....这意味着运行第一类“HP”，然后运行第二类“copyofHp”开始运行。

Eclipse：Juno 服务版本 1 TestNG 插件：6.8

无论如何，这两个类都可以并行执行......同时开始？

```
 <?xml version="1.0" encoding="UTF-8"?>
  <!DOCTYPE suite SYSTEM "http://testng.org/testng-1.0.dtd" >

   <suite name="Suite1" verbose="1" >
     <test name="FHP" parallel="classes" thread-count="5" junit="true">
       <classes>
         <class name="HP"></class>
         <class name="CopyOfHP"></class>
       </classes>
     </test>
   </suite> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T00:46:59.133

这是不正确的，但它为我的目的工作。

但是，如果有人可以展示如何从课堂级别而不是测试级别使其工作，我将不胜感激......

```
 <suite name="Suite1" parallel="tests" thread-count="5" verbose="1" >
 <test name="FHPA"  junit="true">
 <classes>
  <class name="FHP"></class> 
  </classes>
 </test>
 <test name="FHPB" junit="true">
  <classes>
  <class name="CopyFHP"></class>
      </classes>
  </test>
 </suite> 
```

# ruby-on-rails-3.2 - Rails3 中的嵌套属性

> ID：14863471
> 
> 赞同：0
> 
> 时间：2013-02-13T21:27:22.197
> 
> 标签：ruby-on-rails-3.2, associations, nested-attributes, nameerror

我有一个应用程序，用户可以在其中构建一个项目，该项目最多有 12 个志愿者时间段，其他用户可以注册参与该项目。

创建项目时，系统会要求用户提供默认（开始）时间。这个默认时间（Project_Times模型）应该写入到数据库`begin_time`中`Projects`自己的表中，使用project_id参数来标识它属于哪个项目。

然后，用户可以在创建后添加多达 11 个时间段，如果他们想要/需要的话`@project`。

我很难让项目创建默认时间。这就是我所拥有的：

++ Projtime (projtime.rb) 模型 ++

```
class Projtime < ActiveRecord::Base
  attr_accessible :start_time, ...
  belongs_to :project
  default_scope :order => 'times.amount ASC'
end 
```

++ 项目 (project.rb) 模型 ++

```
class Project < ActiveRecord::Base
  attr_accessible :title
  belongs_to :user
  has_one :project_category
  has_many :projtimes, :dependent => :destroy
    accepts_nested_attributes_for :projtimes

  def projtimes
    Projtimes.where('project_id=?', id)
  end
end 
```

++ 项目控制器 ++

```
class ProjectsController < ApplicationController
  ...
  def create
    @user = current_user
    @project = current_user.build_project(params[:project])
    @project.save
    @render 'edit'
  end 
```

其中项目使用上述语法自动分配给用户。我试图复制相同的概念（考虑到每个项目有多次的事实）并为`ProjtimesController`：

```
class ProjtimesController < ApplicationController
  ...
  def create
    @project.projtimes.build
  end
end 
```

但是，我得到一个`NameError in ProjectsController#new`

和`uninitialized constant Project::Projtimes`

我认为通过设置`belongs_to`和`has_many`关联，这应该可行。

帮助任何人？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:01:48.670

projtime.rb 应该以`class Projtime`not开头`class Projime`。

第二双眼睛:-)

# jquery - 为不同的显示逻辑集共享相同的 AJAX 调用

> ID：14863472
> 
> 赞同：-1
> 
> 时间：2013-02-13T21:27:31.667
> 
> 标签：jquery, html, ajax

我正在用 json 填充 div，但我认为这不是最好的方法。似乎有很多代码，有些似乎可以共享。

```
//data for DOM
$.getJSON('json/device.json', function (data) {
    var items = [];
    $.each(data[0].attributes, function (key, val) {
        items.push('<li id="' + key + '">' + '  ' + val + '</li>');
    });

    $('<ol/>', {
        'class': 'raw-list',
        html: items.join('')
    }).hide().fadeIn().appendTo('.json');
});

$.getJSON('json/device.json', function (data) {
    var items = [];
    $.each(data[0].status, function (key, val) {
        items.push(val);
    });

    $('<span/>', {
        'class': 'sort-label error',
        html: items.join('')
    }).hide().fadeIn().appendTo('.status-input .sort-label');
});

$.getJSON('json/device.json', function (data) {
    var items = [];
    $.each(data[0].location, function (key, val) {
        items.push(val);
    });

    $('<span/>', {
        'class': 'sort-label',
        html: items.join('')
    }).hide().fadeIn().appendTo('.location-input .sort-label');
});

$.getJSON('json/device.json', function (data) {
    var items = [];
    $.each(data[0].type, function (key, val) {
        items.push(val);
    });

    $('<span/>', {
        'class': 'sort-label',
        html: items.join('')
    }).hide().fadeIn().appendTo('.type-input .sort-label');
});

$.getJSON('json/device.json', function (data) {
    var items = [];
    $.each(data[0].brand, function (key, val) {
        items.push(val);
    });

    $('<span/>', {
        'class': 'sort-label',
        html: items.join('')
    }).hide().fadeIn().appendTo('.brand-input .sort-label');
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:33:07.723

`$.getJSON`如果您每次都检索相同的数据，则不需要多次调用。

例如：

```
$.getJSON('json/device.json', function(data) {

  // First set of display logic
  var items = [];
  $.each(data[0].attributes, function (key, val) {
     items.push('<li id="' + key + '">' + '  ' + val + '</li>');
  });

  $('<ol/>', {
    'class': 'raw-list',
    html: items.join('')
  })
  .hide().fadeIn().appendTo('.json');

  // Second set of display logic
  var items = [];
  $.each(data[0].status, function (key, val) {
    items.push(val);
  });

  $('<span/>', {
    'class': 'sort-label error',
    html: items.join('')
  })
  .hide().fadeIn().appendTo('.status-input .sort-label');

}); 
```

由于您对大多数数据集的显示逻辑使用了类似的代码块，因此您可以将其包装到一个函数中：

```
function displaySortLabel(items, parentClass) {
  $('<span/>', {
    'class': 'sort-label',
    html: items.join('')
  }).hide().fadeIn().appendTo('.' + parentClass +' .sort-label');
} 
```

然后通过以下方式调用它：

```
displaySortLabel(items, "location-input"); 
```

# gruntjs - Grunt.js - 任务相互调用

> ID：14863473
> 
> 赞同：1
> 
> 时间：2013-02-13T21:27:35.667
> 
> 标签：gruntjs

我试图找出是否有一种（干净的）方法可以从另一个任务中手动调用一个任务。

我的情况是我需要将几个脚本连接成包，比如“concat”，但我需要根据另一个任务的结果来组成配置。

最初，我打算自己实现连接，但我发现重新实现已经存在的东西有点难过，比如 grunt-contrib-concat - 我可以简单地通过向它提供以前运行的任务产生的配置数据来使用它。

那么，在这种情况下，有没有办法从其他任务中手动调用“concat”并为其提供适当的配置块/对象？

此外，我不想在我的配置中为“concat”本身声明任何内容。

任何帮助，将不胜感激！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T03:57:15.363

具体来说，`concat`您可以使用[grunt-lib-legacyhelpers](https://github.com/gruntjs/grunt-lib-legacyhelpers)包。

```
module.exports = function( grunt ) {
  var helpers = require( 'grunt-lib-legacyhelpers' ).init( grunt );

  // …

  var src = helpers.concat( files );
}; 
```

# python-3.3 - 当 foo 更改时，如何在函数中使用变量 foo 来引用某些类 bar.foo？

> ID：14863475
> 
> 赞同：0
> 
> 时间：2013-02-13T21:27:54.263
> 
> 标签：python-3.3

我刚刚开始介绍教我们 Python 的 CS 课程。我一直在胡闹试图制作一个可以为 rpg 游戏生成角色表的程序。我想知道如何使用类来定义物品和稍后购买/装备所述物品的功能。这几乎就是我一直在做的事情：

```
class SomeClass:
    class Foo:
        def description():
            print("Description of the Foo item")
            return
    class Bar:
        def description():
            print("Description of the Bar item")
            return

def SomeFunction(item):
    SomeClass.item.function()
    return 
```

某些功能需要 Foo 或 Bar 才能工作，但它对我没有用。有没有办法做到这一点？

任何帮助都非常感谢。

编辑：我被展示了如何使用 csv 文件，所以我已经切换到使用它们来处理项目，但我仍然有兴趣看看这是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T01:14:15.670

您似乎混淆了类和实例。如果要调用实例的方法，则需要将实例传递给`SomeFunction`并在函数内部调用该方法。如果你想做其他事情，你需要比你提供的更复杂的代码。

# algorithm - 我将如何对常用单词列表进行排序，以找到使用最独特单词的有效组合？

> ID：14863479
> 
> 赞同：0
> 
> 时间：2013-02-13T21:28:13.610
> 
> 标签：algorithm, optimization, set-cover

我有最常用的单词列表，这些单词来自 Google 公开的 ngram 数据。

我有：

6800 频繁 2 克 4800 频繁 3 克 2500 频繁 4 克 1100 频繁 5 克

一个示例 2 ngram 将类似于：

《狗》《一本书》《三把椅子》等

一个示例 5 ngram 类似于：“从前有”“从前有”“这是一个黑暗的和”等等。

我还有一个包含 2000 个常用词的列表。

1）我想从我的各种列表中找出最少数量的 ngram 组合包含频繁单词列表中最多的单词。

例如，如果我发现 200 个 2 克、40 个 3 克、50 个 4 克和 20 个 5 克使用了 1800 个常用词，那将是成功的。我把这些比率做了起来，但我想找到少于 500 个使用大部分单词的组合。

2）我还想从列表中找到包含最多单词的各种 ngram 组合的最少数量。

例如，如果我能找到 500 个使用超过 2000 个不同单词的 ngram，那就太好了。

我遇到的问题是我不知道该怎么做。我认为 hadoop 和 mapreduce 的方向是正确的......但任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T00:20:12.000

你有大约 15k ngrams。这是一个非常小的数据集。它可能适合 1 MB 内存，可能不到您机器上总内存的 1/5000。你不需要 hadoop 来解决这样的问题。此外，这根本不是一个真正的机器学习问题，它只是一个优化问题。

您可以将您的 n-gram 视为（小）单词集，而将您的常用单词列表视为更大的集合。对于您的第一个问题，您希望选择最少数量的 n-gram，以便您可以使用这些 n-gram 覆盖（或尽可能接近覆盖）频繁单词列表。这正是一个[套套问题](http://en.wikipedia.org/wiki/Set_cover_problem)。您可能不会得到确切的解决方案，但有一些简单的启发式方法效果很好。

但是，我并不完全清楚您的第一个问题与第二个问题有何不同。

# json - Grails 从域列表中呈现 JSON 的奇怪行为

> ID：14863482
> 
> 赞同：0
> 
> 时间：2013-02-13T21:28:25.270
> 
> 标签：json, grails

我正在尝试从控制器操作中返回 JSON。这是我的行动方法

```
import grails.converters.JSON
....    
def getDoctorList(id){

    def serviceNo = id ?: "1"

    def service = ServicePoint.findByNumber(serviceNo)

    def jsonMap=service?.staff.collect{
         [id: it.id , name: it.firstName +" "+ it.lastName]             
    }

    render jsonMap as JSON

   } 
```

如果我在最后一行将 jsonMap 转换为 JSON，我的页面将不会被呈现，如果我在呈现 JSON 页面时删除并且一切正常。这段代码有什么问题？

==================================================== ================================

我不需要渲染 gsp 页面我需要将地图渲染为 json 以使用它来填充 gsp 页面中的下拉框。现在，当我在代码中使用（作为 JSON）时，不会显示由 ajax 呈现的页面。如果我删除它一切正常。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:05:41.680

通过呈现 JSON，您不会呈现与操作关联的模板。如果我假设约定并且您有一个 getDoctorList.gsp，那么以下内容将起作用：

```
def getDoctorList(id){
 //.. logic here
 // leaving no render method will default to convention
 // rendering getDoctorList.gsp
}

def getDoctorList(id){
 //.. logic here
 // supplying a render with a view will render that view
 render view: 'doctor_list' // assumes doctor_list.gsp
}

def getDoctorList(id){
 //.. logic here
 // Rendering JSON will not use a template at all
 render jsonMap as JSON
} 
```

这会起作用，但我怀疑这是你想要的：

```
def getDoctorList(id){
 //.. logic here
 [jsonMap: jsonMap as JSON]
} 
```

这会将 jsonMap 作为请求参数推送到 getDoctorList.gsp。一般来说，渲染 JSON 数据通常是为了响应一个 ajax 请求。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T12:25:37.820

不是`render jsonMap as JSON`，但是`return jsonMap as JSON`。在第一种情况下，您`text/html`在`Content-type`标题中返回，`return`Grails 将其设置为`application/json`.

# android - 像素到dp转换android

> ID：14863483
> 
> 赞同：1
> 
> 时间：2013-02-13T21:28:25.693
> 
> 标签：android

这是一个基本问题。谁能解释一下android中使用的转换公式：

像素 = dp * (dpi / 160)。

我已经看到了许多链接，但没有清楚地解释它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:32:49.473

看看这个链接：http: [//developer.android.com/reference/android/util/DisplayMetrics.html#density](http://developer.android.com/reference/android/util/DisplayMetrics.html#density)

这是我能提供的关于密度的最简洁的定义。你把这个密度值乘以 DP 数得到你的像素数。

此外，这里有一些与 DPI 相关的密度的快速参考数字。

> 低密度 (LDPI)：120 DPI；
> 中密度（MDPI）：160 DPI；
> 高密度 (HDPI)：240 DPI；
> 超高密度 (XHDPI)：320 dpi

[来自黛安哈克伯恩：](http://android-developers.blogspot.com/2011/07/new-tools-for-managing-screen-sizes.html)

> 为了从图片中删除大小/密度计算，Android 框架尽可能根据“dp”单位工作，这些单位已针对密度进行了校正。**在与原始 Android 手机相对应的中密度（“mdpi”）屏幕中，**物理像素与 dp 相同；在任一比例下，设备的尺寸均为 320x480。较新的手机可能具有 480x800 的物理像素尺寸，但却是高密度设备。在这种情况下，从 hdpi 到 mdpi 的转换因子是 1.5，因此出于开发人员的目的，设备的 dp 为 320x533。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:33:12.897

dpi = 每英寸点数。一英寸有多少像素。像素是屏幕硬件的实际物理元素。DP 是虚拟像素——android 用作内部测量的假像素。每个 dp 的像素数取决于设备。1dp = 1/160 英寸。此公式用于将 dps 转换为屏幕像素。

# jquery - jq 微小错误：从两个数组之一填充后的随机选择选项

> ID：14863484
> 
> 赞同：0
> 
> 时间：2013-02-13T21:28:27.950
> 
> 标签：jquery, select, random

不是问题很严重，而是代码可能存在小错误这一事实

[http://jsbin.com/apudev/9/edit](http://jsbin.com/apudev/9/edit)

它所做的是从用户选择的两个列表之一中随机选择一辆车。

唯一的问题是选择不会反映在选择字段中。

```
 var select = document.getElementById('s1');
    var items = select.getElementsByTagName('option');
    var index= Math.floor(Math.random() * items.length);
    select.selectedIndex = index; 
```

在其他地方可以工作的其他地方不适合。

有什么问题？

# css - 样式占位符伪仅适用于焦点？

> ID：14863487
> 
> 赞同：2
> 
> 时间：2013-02-13T21:28:40.007
> 
> 标签：css, placeholder

我在 FF 和 Chrome 中使用 HTML5 占位符设置 CSS 样式时遇到了“问题”。例子：

```
http://jchmusic.com 
```

...单击“联系”主菜单。

似乎如果表单是位置：绝对，则占位符文本伪样式-仅在字段处于焦点（选中）时才有效。否则，它只会恢复为“真实”元素的样式。

如果形式是位置：相对，则可以正常工作。

这是我正在使用的代码

```
input:-moz-placeholder{color:#999; font-family:"Courier New", Courier, monospace}
input:-ms-input-placeholder{color:#999; font-family:"Courier New", Courier, monospace}

::-webkit-input-placeholder { /* WebKit browsers */
 color:    #999; font-family:"Courier New", Courier, monospace
}
:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
 color:    #999; font-family:"Courier New", Courier, monospace
}
::-moz-placeholder { /* Mozilla Firefox 19+ */
color:    #999 !important;
     font-family:"Courier New", Courier, monospace;
}
:-ms-input-placeholder { /* Internet Explorer 10+ */
color:    #999;
    font-family:"Courier New", Courier, monospace
} 
```

我在这里阅读了一些关于“悬停”的轶事，但我不知道这是否适用于我的情况。是否有 CSS 的解决方法，还是我只需要回退到 jQuery？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:21:35.813

我已经测试了你的代码，我注意到一些 javascript 正在添加

```
class="placeholder" 
```

未选择时输入，这可能会改变正常占位符的行为。这看起来像是一些 jQueryUI 干预

# arrays - 从数组中提取一个值并将其发送到屏幕

> ID：14863490
> 
> 赞同：-1
> 
> 时间：2013-02-13T21:28:45.950
> 
> 标签：arrays, autoit, monkey-testing

我想对一个网站进行猴子测试（随机单击并将一些值发送到屏幕）。我在 Word 文档上尝试了脚本，但发送的唯一字符是`$`. 如何解决这个问题？

```
#cs ----------------------------------------------------------------------------

AutoIt Version: 3.3.8.1
Author:         Vasile

Script Function:
    Monkey.

#ce ----------------------------------------------------------------------------

; Script Start - Add your code below here
Run("C:\Program Files\Google\Chrome\Application\chrome.exe http://quiz.interhit.net/");deschide chrome--si site QUIZ
Sleep(200) 

$activ_x = 676
$activ_y = 569

$repetari = 0
Do
    Local $array[27]
    $array[0]="F5"
    $array[1]="F1"
    $array[3]="F12"
    $array[4]="¬"
    $array[5]="1"
    $array[6]="10"
    $array[7]="-"
    $array[8]="="
    $array[9]="+"
    $array[10]="TAB"
    $array[11]="SPACE"
    $array[12]="LWIN"; WINDOWS KWY
    $array[13]="CAPSLOCK"
    $array[14]="LALT";ALT KEY
    $array[15]="Enter"
    $array[16]="ESC"
    $array[17]="DELETE"
    $array[18]="BACKSPACE"
    $array[19]="SCROLLLOCK"
    $array[20]="LSHIFT"
    $array[21]="A"
    $array[22]="Z"
    $array[23]="a"
    $array[24]="z"
    $array[25]="1"
    $array[26]="10"
    $x = Random(10, 900, 1)
    $y = Random(10, 600, 1)
    $chr = Random(0,27,1)
    Local $i = 0
    While $i<= 3
        MouseClick("left", $y, $x)
        Send("$array[$chr]}")
        $i = $i + 1
    WEnd
$repetari= $repetari + 1
Until $repetari = 10 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T07:48:35.243

```
 Local $i = 0
While $i<= 3
    MouseClick("left", $y, $x)
    Send("{" & $array[$chr] & "}")
    $i = $i + 1
WEnd 
```

几个小时后，我在朋友的帮助下弄清楚了，问题是在旧版本中，我错过了两个 & 标记来分隔发送函数中的字符¬$arra[$chr]¬。我尝试了这个解决方案并且它正在工作。我也会尝试 CoderSeven 的答案

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:56:23.037

您的 Send 呼叫中似乎缺少一个括号。

尝试：`Send("{$array[$chr]}")`

但是，我认为最好用括号括起来特殊情况。（几乎你所有的角色都是特殊情况，除了底部的几个）

IE：

```
$array[0] = "{F5}"
$array[1] = "{F1}"
 ....
$array[21] = "A"
$array[22] = "Z"
 ....
Send("$array[$chr]") 
```

自从我用 Auto-It 做任何事情以来已经有几年了，所以试一试，让我知道结果如何。

[看看这里的所有特殊情况。](http://www.autoitscript.com/autoit3/docs/functions/Send.htm)

# python - 使用 BeautifulSoup 查找选定的选项

> ID：14863495
> 
> 赞同：14
> 
> 时间：2013-02-13T21:29:02.693
> 
> 标签：python, beautifulsoup

我只想获得选择的选定选项。例如：

```
<select>
  <option value="0">2002/12</option>
  <option value="1">2003/12</option>
  <option value="2">2004/12</option>
  <option value="3">2005/12</option>
  <option value="4">2006/12</option>
  <option value="5" selected>2007/12</option>
</select> 
```

我知道我能做到

```
theSelectTag.findAll('option',attrs={'selected':''}) 
```

但这是返回所有选项。有没有办法获取存在属性的所有元素？请注意，我要求全部，因为我正在抓取的网站确实包含多个选项的选定属性。

我正在使用 Python 2.7 和 Beautiful Soup 4.1.2

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-13T21:30:48.900

作为属性值传递`True`将匹配具有该属性的所有元素：

```
>>> from bs4 import BeautifulSoup
>>> soup = BeautifulSoup('''<select>
...   <option value="0">2002/12</option>
...   <option value="1">2003/12</option>
...   <option value="2">2004/12</option>
...   <option value="3">2005/12</option>
...   <option value="4">2006/12</option>
...   <option value="5" selected>2007/12</option>
... </select>''')
>>> soup.find_all('option', selected=True)
    [<option selected="" value="5">2007/12</option>]
>>> soup.find_all('option', {'selected': True})
    [<option selected="" value="5">2007/12</option>] 
```

并使用 lxml：

```
>>> from lxml import etree
>>> root = etree.HTML('''<select>
  <option value="0">2002/12</option>
  <option value="1">2003/12</option>
  <option value="2">2004/12</option>
  <option value="3">2005/12</option>
  <option value="4">2006/12</option>
  <option value="5" selected>2007/12</option>
</select>''')
>>> root.xpath('//option[@selected]')
    [<Element option at 0x228b7d0>] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-03-12T10:10:23.300

您可以使用

```
theSelectTag.select_one('option:checked') 
```

它将返回您唯一选择的选项。

# tomcat6 - tomcat6在哪里隐藏它的缓存？

> ID：14863507
> 
> 赞同：2
> 
> 时间：2013-02-13T21:29:57.510
> 
> 标签：tomcat6

我有一个 servlet abc.jar 复制到其中`$TOMCAT/webapps`，一切正常。接下来，我关闭了tomcat，删除了文件夹abc和war文件。当我重新启动 tomcat 时，它会出现诸如`"Cannot find folder .../abc"`FileNotFoundException 等错误消息。

我的问题：它怎么知道它应该寻找这个`"abc"`？我从“temp”和“work”文件夹中删除了命名目录，但它仍然记得它。如何清理所有工件？这是 tomcat 6，java-1-6-37。TIA。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:30:43.700

如果您已经关闭了 Tomcat，删除了`$CATALINA_HOME/temp/`,`$CATALINA_HOME/webapps/abc/`和`$CATALINA_HOME/work/`文件夹，并删除了`$CATALINA_HOME/webapps/abc.war`文件；那么有问题的剩余引用可能是`$CATALINA_HOME/conf/Catalina/localhost/abc.xml`（由Tomcat在部署时从您的Web应用程序复制）。

这不是一个“缓存”，但可能会导致 Tomcat 寻找不再存在的文件夹。

[在http://tomcat.apache.org/tomcat-6.0-doc/config/host.html#Automatic%20Application%20Deployment](http://tomcat.apache.org/tomcat-6.0-doc/config/host.html#Automatic%20Application%20Deployment)有更详细的信息。例如：

> 将扫描主机`appBase`目录中没有相应上下文 XML 描述符（具有“.xml”扩展名而不是“.war”扩展名）的任何 Web 应用程序存档文件，以查看它是否包含上下文 XML 描述符（位于`$CATALINA_BASE/conf/[engine_name]/[host_name]`at `/META-INF/context.xml`)，如果找到，描述符将被复制到`$CATALINA_BASE/conf/[engine_name]/[host_name]`目录并重命名。

# c++ - 找到唯一的毕达哥拉斯三元组

> ID：14863511
> 
> 赞同：0
> 
> 时间：2013-02-13T21:30:09.733
> 
> 标签：c++, c

我试图从勾股三元组序列中排除重复三角形，这些三元组只打印斜边为 100 的三角形，但我在排除部分所做的操作失败了......我有以下内容：

```
....
    int one_hundred = 0,
     if( (a*a) + (b*b) == (h*h) ){

        //exclusion
        if((a == b)){

           continue;

        }else {

       //Just prints the the triangles that have hypotenuses of 100
      if(h == 100){
            cout <<  a << "     " << b << "     " << h << endl;

           }

      .....

     } 
```

现在这个输出应该是

![ ](../Images/96111790a6857a2f351d47d9db40f477.png)

我所说的重复是指第一行和最后一行具有相同的一对边

我想要的是这样的输出：

![在此处输入图像描述](../Images/921b5762241fddaab7883171716cf788.png)

但是我这样做如下：

//查看是否重复

```
if((a == 96)){

    continue;

    } 
```

而且我认为通过比较 a == b 我会达到相同的效果，但我没有：

```
if((a == b)){

    continue;

    } 
```

希望这能澄清我正在尝试做的事情......

再次感谢你！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:39:30.843

从毕达哥拉斯三元组序列中过滤掉重复项非常困难，因为您需要永久记住所有旧三元组，以便进行大量比较。

更好的方法是一开始就不产生重复。为此，您可以使用这组公式（来自[关于毕达哥拉斯三元组的维基百科文章的“生成三元组”部分](http://en.wikipedia.org/wiki/Pythagorean_triple#Generating_a_triple)）：

> *a* = *k* ·( *m* ² - *n* ² )
> *b* = *k* ·(2 *mn* )
> *c* = *k* ·( *m* ² + *n* ² )

其中*k*、*m*和*n*是正整数，其中*m*和*n*互质（意味着它们的最大公分母是 1）并且*m*或*n*是偶数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:37:21.553

怎么样 (如果 (abs (ab) < EPSILON)) 继续...

此外，在第一个 if 结构中使用相同的不等式（在某处定义 EPSILON）。

自从我进行 C 编码以来已经有一段时间了，但是双精度数或浮点数的相等性过去常常得到错误的结果。除非它们都是整数，在这种情况下 (a==b) 与 (b==a) 相同，不知道为什么两者都有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:08:52.870

我认为一个简单的方法是创建一个`std::vector<bool> state(h);`因为`h`是所有边中最大的，其他边永远不会更大；对？而且我们知道没有其他数字乘以自身可以等于另一个数字乘以自身，否则您可以说类似**5*5 = 4*4**！因此，您可以使用向量下标作为数字的代表。当您拉出一个数字并发现它可以解决您的问题时，只需将其状态切换为`false`。整个事情会是这样的——

```
bool loop;
std::vector<bool> *state = new std::vector<bool>(h, true);
for(int i = 2; i != sizeof(bool) * h; ++i)
{
    if((state + i))
    {
        a = i;
        loop = true;

        for(int j = i + 1; loop && j != sizeof(bool) * h; ++j)
        {
            if((state + j))
            {
                b = j;          

                if((a*a) + (b*b) == (h*h))
                {
                    loop = false;
                    (*state)[i] = false;                                                      
                    (*state)[j] = false;
                    std::cout << a << " " << b << " " << h << std::endl;
                }
            }
        }
    }
} 
```

我的输出是：

```
28 96 100
60 80 100 
```

这就是我认为您在所需结果示例中的意思。否则，您需要创建一个重复打印某些规则的规则。在这种情况下，您可以添加一个`switch(){}`. 没那么难，当然它不是那么优雅，imoo。

**注意：** 实际上没有必要更改`state->at(i)`为`false`for `i`is 递增，并且永远不会再被触及。但它在那里，以防您以后需要使用潜艇。索引 0 和 1 已被忽略，因为三角形的任何一边都不能为 0，如果一个可行，另一边必须相等`h`，所以不要浪费宝贵的时间。如果您确实坚持使用它们，请记住 0 和 1 是`true`开头并且应该设置为 false。

# c++ - 使用数据文件排序进行计算时遇到问题

> ID：14863525
> 
> 赞同：0
> 
> 时间：2013-02-13T21:30:48.433
> 
> 标签：c++, if-statement, while-loop, counter, ifstream

我是 stackoverflow 社区的新手，也是编码的新手，所以在我了解在这里发帖的技巧以及编码规则时提前道歉。我正在使用 C++，并且正在参加 CS161 初学者计算机科学课程。

我目前正在做一项作业，该作业要求我从存储在计算机上的数据文件中读取数据并对数据进行排序以进行一些计算，在此作业中，根据性别和学校类型查找平均考试成绩。一切都编译并且程序运行但是有一些问题。

第一个问题是我的回声。

```
 // echo the data file
    while (inData)
    {
    inData >> name >> sex >> school >> score;
    cout << name << sex << school << score << endl; 
```

该程序确实回显了数据，但由于某种原因，它最终回显了列表中的姓氏两次。此外，（我不知道这是否重要）当它回显时，它不会跳过姓名、性别、学校和分数之间的空格。

第二个问题是它没有执行计算，我认为这是因为我错过了某种与“计数”相关的指令，但我无法做到。

这是我的代码，让我知道你的想法：

```
#include <iostream>
#include <fstream>
#include <string>
#include <iomanip>
using namespace std;
int main()
{
    //Declare variables to manipulate data
    char sex;
    string name;
    string school;
    string fileSource;
    string CC;
    string UN;
    int maleScore = 0;
    int femScore = 0;
    int unScore = 0;
    int ccScore = 0;
    double maleAvg;
    double femAvg;
    double unAvg;
    double ccAvg;
    double sumAvg = 0;
    int femCount = 0;
    int maleCount = 0;
    int ccCount = 0;
    int unCount = 0;
    int score;
    int sum;
    //Declare stream variables
    ifstream inData;
    ofstream outData;
    inData >> name >> sex >> school >> score;
    // Promt user for file location
    cout << "Please input file location: ";
    cin >> fileSource;

    // open output file and run program exit failsafe command
    inData.open(fileSource);
    if (!inData)
    {
        cout << "Cannot open input file. "
            << "Program will now terminate." << endl;
        return 1;
    }
    outData << fixed << showpoint << setprecision(2);

    // echo the data file
    while (inData)
    {
        inData >> name >> sex >> school >> score;
        cout << name << sex << school << score << endl;

        // while reading incoming data from file, execute the conditions

        // Male and female calculations
        if(sex=='M')
        {
            maleScore = maleScore +=score;
            ++maleCount;
        }
        else if(sex =='F')
        {
            femScore = femScore +=score;
            ++femCount;
        }

        // Community college and University calculations
        if(school == CC)
        {
            ccScore = ccScore +=score;
            ++ccCount;
        }
        else if(school == UN)
        {
            unScore = unScore +=score;
            ++unCount;
        }
        maleAvg = maleScore/maleCount;
    }

    // Male average output
    cout << maleAvg;

    femAvg = femScore/femCount;

    // Female average output
    cout << femAvg;

    ccAvg = ccScore/ccCount;

    // Community College average output
    cout << ccAvg;

    unAvg = unScore/unCount;

    // University average output
    cout << unAvg;
    sum = maleScore + femScore + ccScore + unScore;
    sumAvg = sum/12;
    cout << sumAvg;
    return 0;
} 
```

此外，我的编译器继续运行程序并且不会停止。我拍了一张编译器窗口的照片，但不知道如何发布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:21:11.073

您的代码有一些问题。让我们一次一件地处理，好吗？

```
ifstream inData;
ofstream outData;
inData >> name >> sex >> school >> score; 
```

最后一行是做什么的？`inData`尚未打开，但您正在尝试从中读取。

```
maleScore = maleScore +=score; 
```

在这里（以及其他一些地方）您`+=`错误地使用了运算符。您应该`+=`像这样使用：

```
maleScore += score; 
```

或`+`像这样使用：

```
maleScore = maleScore + score; 
```

然后你这样做：

```
if(school == CC) 
```

现在，`CC`是`std::string`您的代码中的一个，您尚未初始化（这意味着它是空的）。所以它永远不会匹配，因此`if`身体永远不会执行。同样的事情发生在`UN`.

再往下，你在循环中有这条线：

```
maleAvg = maleScore/maleCount; 
```

这样做是在每次循环中重新计算男性的平均值。这不一定是错误的（你会得到正确的结果），但如果文件中的第一个人是女性，你的程序将因除以零而崩溃，因为`maleCount`它将是 0。如果没有女性在，也会发生同样的事情输入文件，或者如果没有大学或学院的分数。

最后，`iostream::eof()`在循环内使用不是一个好主意。您可以在 StackOverflow 上阅读更多相关信息：[为什么循环条件内的 iostream::eof 被认为是错误的？](https://stackoverflow.com/questions/5605125/why-is-iostreameof-inside-a-loop-condition-considered-wrong)

尽管如此，你的错误并不严重，而且是新程序员的典型错误，所以不要气馁。将此视为学习和了解如何检查代码以查找此类错误的机会。所以事不宜迟，让我们看看这个程序的改进版本：

```
#include <iostream>
#include <fstream>
#include <string>
#include <iomanip>

using namespace std; // it's considered bad to do this - but since
                     // this is homework, we'll let it slide.

int main()
{
    //Declare variables to manipulate data    
    string name;
    string fileSource;

    int maleScore = 0;
    int femScore = 0;
    int unScore = 0;
    int ccScore = 0;
    int femCount = 0;
    int maleCount = 0;
    int ccCount = 0;
    int unCount = 0;

    //Declare stream variables
    ifstream inData;
    ofstream outData;

    // Promt user for file location
    cout << "Please input file location: ";
    cin >> fileSource;

    // open output file and run program exit failsafe command
    inData.open(fileSource);

    if(!inData)
    {
        cout << "Cannot open input file. "
             << "Program will now terminate." << endl;
        return 1;
    }    

    cout << "Reading data from '" << fileSource << "'" << endl;

    while(inData >> name)
    { // If we read a name, we can continue. Otherwise, we're done.     
        char sex;       
        int score;
        string school;

        inData >> sex >> school >> score;

        // Write the data out
        cout << "Processing " << name << " (" << sex << ") attending ";

        if(school == "UN")
            cout << "University";
        else if(school == "CC")
            cout << "Community College";

        cout << ". Score = " << score << endl;

        // Male and female calculations
        if(sex=='M')
        {
            maleScore +=score;
            maleCount++;
        }
        else if(sex =='F')
        {
            femScore +=score;
            femCount++;
        }

        // Community college and University calculations
        if(school == "CC")
        {
            ccScore +=score;
            ccCount++;
        }
        else if(school == "UN")
        {
            unScore +=score;
            unCount++;
        }       
    }

    // We do static_cast<double>(maleScore) / maleCount; to ensure that
    // the division is done using floating point and not integer 
    // arithmetic. We could have multiplied the numerator by 1.0 instead.

    if(maleCount != 0)
    {
        cout << "The average scores for males is: " << setprecision(2)
             << static_cast<double>(maleScore) / maleCount << endl;
    }

    if(femCount != 0)
    {
        cout << "The average score for females is: " << setprecision(2)
             << static_cast<double>(femScore) / femCount << endl;
    }

    if(ccCount != 0)
    {
        cout << "The average score for Community Colleges is: " << setprecision(2)
             << static_cast<double>(ccScore) / ccCount << endl;
    }

    if(unCount != 0)
    {
        cout << unScore << "/" << unCount << endl;

        cout << "The average score for Universities is: "  << setprecision(2)
             << static_cast<double>(unScore) / unCount << endl;
    }

    // In this case we will use the multiplication technique instead:   
    cout << "The 'sum' average is: " << setprecision(2)
         << (1.0 * (maleScore + femScore + ccScore + unScore)) / 12 << endl;

    return 0;
} 
```

# ruby - 命令行选项“W1”与“W0”有何不同？

> ID：14863527
> 
> 赞同：1
> 
> 时间：2013-02-13T21:31:00.467
> 
> 标签：ruby, ruby-1.9.3

在 Ruby 脚本中，可以使用`$VERBOSE`全局变量的值来测试详细程度，该变量可以具有三种状态：

```
nil in case verbosity level was “0” (silence)
false for level “1” (medium); this is the default
true for level “2” (verbose); this is verbose mode. 
```

我开始使用我的代码来了解它们之间的区别：

```
@ubuntu:~$ ruby -W0 -e 'a=10;a=10;@foo'
@ubuntu:~$ ruby -W1 -e 'a=10;a=10;@foo'
@ubuntu:~$ ruby -W2 -e 'a=10;a=10;@foo'
-e:1: warning: possibly useless use of a variable in void context
-e:1: warning: instance variable @foo not initialized
@ubuntu:~$ 
```

但实在想不通`W1`和有什么区别`W0`。谁能帮我理解其中的区别？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:49:12.540

要查看真正的区别，您必须在 $STDERR 上打印一些文本。我对您的示例进行了以下更改：

```
ruby -W0 -e 'a=10;a=10;@foo;warn "hello"' 
```

请注意，运行带有`W0`标志的代码，执行时终端中不会出现任何内容。现在，如果您使用 运行`W1`，您将看到由 生成的“错误”消息`Kernel#warn`：

```
ruby -W1 -e 'a=10;a=10;@foo;warn "hello"' 
```

最后，`W2`将显示解释器生成的错误和警告。

# python - 如何正确关闭两个进程共享的管道？

> ID：14863530
> 
> 赞同：2
> 
> 时间：2013-02-13T21:31:20.370
> 
> 标签：python, subprocess, pipe

我正在尝试使用管道在 python 中的进程之间进行通信。这些进程将从不同的线程调用，因此可能无法直接访问`Popen`每个进程的对象。我在下面编写了脚本，作为一个简单的概念证明，但发现我的接收过程永远不会终止。

```
import os
import subprocess
import traceback
import shlex

if __name__ == '__main__':
    (fd_out, fd_in) = os.pipe()
    pipe_in = os.fdopen(fd_in, 'w')
    pipe_out = os.fdopen(fd_out, 'r')
    file_out = open('outfile.data', 'w+')

    cmd1 = 'cat ' + ' '.join('parts/%s' % x for x in sorted(os.listdir('parts')))
    cmd2 = 'pbzip2 -d -c'
    pobj1 = subprocess.Popen(shlex.split(cmd1), stdout=pipe_in)
    pobj2 = subprocess.Popen(shlex.split(cmd2), stdin=pipe_out,
                                                stdout=file_out)

    print 'closing pipe in'                                                     
    pipe_in.close()                                                             
    print 'closing pipe out'                                                    
    pipe_out.close()                                                            
    print 'closing file out'                                                    
    file_out.close()                                                            
    print 'waiting on process 2'                                                
    pobj2.wait()                                                                
    print 'done' 
```

这在许多方面都正确运行。数据块通过管道传输到第二个进程，第二个进程解压缩流并将其写入文件。我可以观察这些进程，直到它们似乎只是在等待（并且什么都不做），终止第二个进程，并且文件似乎已完全写入。

所以，我想知道为什么第二个进程永远不会终止。似乎它从未意识到输入流已被关闭。如何正确关闭管道，以便进程知道终止？

```
david_clymer@zapazoid:/home/tmp/db$ python test.py
closing pipe in
closing pipe out
closing file out
waiting on process 2
^Z
[1]+  Stopped                 python test.py
david_clymer@zapazoid:/home/tmp/db$ bg
[1]+ python test.py &
david_clymer@zapazoid:/home/tmp/db$ jobs -l
[1]+ 31533 Running                 python test.py &
david_clymer@zapazoid:/home/tmp/db$ ps -fp 31533
UID        PID  PPID  C STIME TTY          TIME CMD
1000     31533 22536  0 15:22 pts/2    00:00:00 python test.py
david_clymer@zapazoid:/home/tmp/db$ lsof |grep $(pwd)
bash       3432       david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
bash      22536       david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
python    31533       david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535       david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535       david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31536 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31536 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31537 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31537 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31538 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31538 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31539 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31539 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31540 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31540 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31541 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31541 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31542 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31542 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31543 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31543 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
pbzip2    31535 31544 david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
pbzip2    31535 31544 david_clymer    1u      REG              253,3 12255300000 397270 /home/tmp/db/outfile.data
lsof      31599       david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
grep      31600       david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
lsof      31602       david_clymer  cwd       DIR              253,3      483328 408117 /home/tmp/db
david_clymer@zapazoid:/home/tmp/db$ strace -p 31533
Process 31533 attached - interrupt to quit
wait4(31535, ^C <unfinished ...>
Process 31533 detached 
```

我想我在做一些愚蠢的事情。我想知道是什么，为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:46:54.233

第二个进程可能继承了管道的输入端，因此永远不会关闭。我不是 Python 专家，但也许可以避免这种情况，方法是`Popen`先用 ing 第二个进程`stdin=PIPE`，然后`Popen`用第二个进程`.stdin`作为它的第一个进程`stdout`。（`Popen`可能会安排进程没有处理它在内部创建的管道输入端的句柄。）

为了解决文件描述符继承问题，请使用以下命令调用子进程`close_fds=True`：

```
pobj2 = subprocess.Popen(shlex.split(cmd2),
                         stdin=pipe_out,
                         stdout=file_out,
                         close_fds=True) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:49:54.630

，`subprocess.Popen()`你不应该需要手动调用`os.pipe()`等等。

```
pobj1 = subprocess.Popen(['cat'] + ['parts/' + x for x in sorted(os.listdir('parts'))],
                         stdout=PIPE)
pobj2 = subprocess.Popen(shlex.split('pbzip2 -d -c'),
                         stdin=pobj1.stdout,
                         stdout=open('outfile.data', 'w+')) 
```

应该做你想做的。

# c# - 将 McArthur 或 McMinn 等名称中的第一个和第三个字母大写

> ID：14863531
> 
> 赞同：4
> 
> 时间：2013-02-13T21:31:22.453
> 
> 标签：c#, asp.net, css, html

有没有办法识别复合名称并正确大写第一个和第三个字符？

虽然使用 CSS 更改大小写是一项微不足道的任务，但在处理复合名称时，我还没有找到任何直接的解决方案。

想到的一件事是使用某种查找来识别 LeBare、麦当劳、麦克阿瑟等名称，然后应用一些逻辑来改变情况……任何知道其他可行解决方案的人可能是在那里，所以我不必重新发明轮子（可以这么说）？

注意：用户将直接在文本框中输入这些名称。不能保证用户不会输入 mcMinn 或 macArthur 等内容。话虽如此，我也注意到带有“Le”和“La”前缀的名称（这些名称可能有拉丁/西班牙根，我可以虽然错了）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:48:40.473

在此过程中要记住的一件事是，您还可以使用“麦克阿瑟”的情况，它将是第一个和第四个字符。根据您从哪里提取数据（用户输入、数据库等），我会说按原样使用它可能是一种选择。但是，如果名称以全小写形式出现，那么您可能必须编译一个已知名称前缀列表并对其进行检查。我的观点是，除非名称全部以小写形式出现并显示给用户，否则我只会使用原始格式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:49:07.717

您不能仅使用 CSS 来实现。有几个“字母”jQuery 插件，例如[http://letteringjs.com/](http://letteringjs.com/)。您可以根据 jQuery 中的名称放置自己的逻辑，并使用刻字库为每个字母设置样式

```
.target.char1, .target.char3 {
  text-transform:uppercase;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-02-28T13:55:18.380

你使用这样的 Jquery。

```
$("#LastName").keyup(function () {
var last_name = $("#LastName").val();
var op = last_name.substr(0, 2);
if (op == "mc" || op == "Mc" || op == "MC") {
    $("#LastName").val("Mc" + (last_name.charAt(2).toUpperCase()) + last_name.substr(3).toLowerCase());
} else {
    $("#LastName").val(last_name.charAt(0).toUpperCase() + last_name.substr(1).toLowerCase());
}}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-28T14:01:04.513

您可以在 javascript 中使用 index 循环：

```
var inputValue = "mcminn";

var transformedInput = '';

if(inputValue){
    for(var i=0; i<inputValue.length; i++){
    if(i===0 || i=== 2){
        transformedInput += inputValue.charAt(i).toUpperCase();
        } else {
            transformedInput += inputValue.charAt(i).toLowerCase();
    }
  }
}

console.log(transformedInput);
```

# php - Window.location.href 在谷歌浏览器中不起作用

> ID：14863533
> 
> 赞同：0
> 
> 时间：2013-02-13T21:31:27.913
> 
> 标签：php, javascript

在确认框中单击“确定”后，我试图通过 URL 传递要删除的项目的 ID，但是没有任何反应。这确实适用于 IE，但我希望它也适用于 Chrome。

```
<script>
function dltCnfrm(id)
{
    var r=confirm("Delete this product?")
    if (r)
    {
        window.location.href = "http://localhost/e-com/index.php/product/delete_item/" + id;
    }
}
</script> 
```

html里面的代码

```
foreach ($items as $res) {
$id = $res['id'];
.
.
<td><?php echo "<a href='' onclick='dltCnfrm($id)'>Delete</a>"; ?></td> 
```

我还尝试了其他几种方法，包括

```
location.assign(); 
```

添加返回假；在 if 语句下方

有人可以用 Chrome 浏览器试试吗？Chrome 版本 24.0.1312.57 m

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:47:22.430

我打赌 id 是一个字符串，所以你有一个错误

```
<td><?php echo "<a href='' onclick='dltCnfrm(\"$id\")'>Delete</a>"; ?></td> 
```

您可能还想取消链接点击。

```
<td><?php echo "<a href='' onclick='dltCnfrm(\"$id\"); return false'>Delete</a>"; ?></td> 
```

**但是你永远不应该永远不要对 GET 请求执行删除操作。**GET 用于获取数据，POST 用于更新数据。

# c# - 比较布尔值对的更简单方法？

> ID：14863534
> 
> 赞同：2
> 
> 时间：2013-02-13T21:31:38.273
> 
> 标签：c#, comparison, boolean

假设我有以下布尔值：

*   是A
*   为B
*   是C
*   是现有的A
*   是现有B
*   isExistingC

当isA、isB、isC为真时，如果所有真bool对应的isExisting bool都为真，我想做点什么。如果 isA、isB 或 isC 为 false，则其对应的 isExisting bool 无关紧要。

这是我想出的：

```
if ((isA || isB || isC)
    && ((!isA || isExistingA)
    && (!isB || isExistingB)
    && (!isC || isExistingC)))
{
    // do something
} 
```

我今天显然无法思考，想知道是否有更简单的方法来表达这一点。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T21:43:51.630

Wolfram Alpha 可以简化布尔方程，试试这个[链接](http://www.wolframalpha.com/input/?i=%28%28A%20%7C%7C%20B%20%7C%7C%20C%29%20&%20%28%28~A%20%7C%7C%20C%29%20&&%20%28~B%20%7C%7C%20D%29%20&&%20%28~C%20%7C%7C%20E%29%29%29)

但是在我看来，不要太担心这一点，保持 if 语句的简洁和可读性比担心紧凑性或性能更重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:42:24.823

问题是要求虽然只有一个*isX*变量必须为真，但必须检查所有*isX变量。*所以我认为你不能用更少的“比较”来写一个声明。

我认为您当前的解决方案是最短的形式，但是如果我在没有解释的情况下阅读该代码，我可能不看两次就无法理解它（我认为实际名称更具描述性，也许对读者更有意义） .

# python - 按排序顺序通过键遍历 Python 字典

> ID：14863536
> 
> 赞同：35
> 
> 时间：2013-02-13T21:31:53.610
> 
> 标签：python, loops, sorting, dictionary

我有一个 Python 字典，看起来像这样：

```
D = {1:'a', 5:'b', 2:'a', 7:'a'} 
```

键的值大多无关紧要。有没有办法按数字顺序按键遍历字典？键都是整数。

而不是说

```
for key in D:
    # some code... 
```

我可以按顺序浏览字典键`1, 2, 5, 7`吗？

此外，我不能使用排序/排序功能。

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2013-02-13T21:34:17.707

你可以使用这个：

```
for key in sorted(D.iterkeys()):
    .. code .. 
```

在 Python 3.x 中，使用`D.keys()`（与 Python 2.x 中的相同`D.iterkeys()`）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-13T21:42:28.437

考虑到您不想排序的规定，并假设键都是整数，您可以简单地找到键的最大值和最小值，然后遍历该范围并检查每个键是否实际上在字典中。

```
for key in xrange(min(D), max(D) + 1):
    if key in D:
        print D[key] 
```

当然，这不是很有效，但它*会*起作用，并且它避免了排序。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-13T22:54:31.933

假设键/值按顺序插入，您可以使用[OrderedDict](http://docs.python.org/2/library/collections.html#collections.OrderedDict)：

```
>>> from collections import OrderedDict
>>> d = OrderedDict()
>>> d[1] = 'a'
>>> d[2] = 'a'
>>> d[5] = 'b'
>>> d[7] = 'a'
>>> d
OrderedDict([(1, 'a'), (2, 'a'), (5, 'b'), (7, 'a')])
>>> d.keys()
[1, 2, 5, 7] 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-13T21:34:16.667

您可以使用 获取键列表`dict.keys()`，然后遍历列表的排序视图：

```
for key in sorted(D.keys()):
    print key, D[key] 
```

# facebook - 处理 Facebook add_to_page_dialog 中未发布的页面

> ID：14863537
> 
> 赞同：0
> 
> 时间：2013-02-13T21:31:55.157
> 
> 标签：facebook, facebook-javascript-sdk

我通过 Facebook Javascript [add_to_page](https://developers.facebook.com/docs/reference/dialogs/add_to_page/)对话框将我的 Facebook 应用程序添加到 Facebook 粉丝页面。一切正常，只有未发布的 Facebook 页面存在问题。

我正在检索添加了应用程序的所有页面的 Facebook 页面 ID。如果有人将其添加到此类未发布的 FB 页面，我无法获取页面 ID，并且应用程序仍会添加到 Facebook 页面。我想防止应用程序添加到未发布的页面以防万一。

Facebook 开发人员文档没有提供有关此问题的帮助。

提前感谢您抽出宝贵时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:35:05.913

用户管理的所有页面都将出现在对话框中 - 无法阻止选择未发布或受限制的页面 - 如果您获得用户的`manage_pages` [许可](https://developers.facebook.com/docs/authentication/permissions/)，您可以充当他们的所有页面，包括未发布的页面。

如果您不知道，并且需要知道您的应用正在加载哪个页面，则在加载选项卡时发送到您的应用的签名请求将包含页面 ID

# sql-server - 我在使用 Powershell 的 TrimEnd 正确吗？

> ID：14863538
> 
> 赞同：0
> 
> 时间：2013-02-13T21:31:58.310
> 
> 标签：sql-server, powershell

我目前正在尝试使用 Powershell 获取一些原始数据并将其按摩到 SQL 插入语句中。第一个任务是删除每行原始数据末尾的两个逗号（在数据之前和之后拍 SQL 代码之前）。我一直在使用 Powershell 'TrimEnd' 来尝试完成这项工作，但以下迭代似乎并没有从行尾删除第一个逗号：

```
Sample 1 - (get-content -ErrorAction "Stop" source-file.txt) | Foreach-Object -ErrorAction "Stop" {$_.TrimEnd()} | out-file destination-file.sql

Sample 2 - (get-content -ErrorAction "Stop" source-file.txt) | Foreach-Object -ErrorAction "Stop" {$_.TrimEnd(',')} | out-file destination-file.sql

Sample 3 - (get-content -ErrorAction "Stop" source-file.txt) | Foreach-Object -ErrorAction "Stop" {$_.TrimEnd(",")} | out-file destination-file.sql

Sample 4 - (get-content -ErrorAction "Stop" source-file.txt) | Foreach -ErrorAction "Stop" {$_.TrimEnd()} | out-file destination-file.sql 
```

source-file.txt 看起来像这样：

富，富1，富2，富3，富4，富5，，

我希望最终得到的是：

富，富1，富2，富3，富4，富5，

时代200K

问题是我没有逃避角色还是“Foreach/Foreach-Object”不是这里的方法？在删除 source-file.txt 文件末尾的两个逗号之前，我想确保我走的是正确的道路。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:10:03.380

我一定是手指发胖了，或者盯着屏幕太久了，但我从@Musaab-Al-Okaidi 的建议中利用了#2。我充分利用`{$_.TrimEnd(', ,')}`了我正在做的事情所需要的东西。干杯!

# ios - 复杂核心数据搜索

> ID：14863540
> 
> 赞同：0
> 
> 时间：2013-02-13T21:32:06.793
> 
> 标签：ios, objective-c, core-data

我正在尝试搜索我的核心数据数据库，返回一组非常具体的记录。

我的模型看起来像这样：

```
firstName (NSString)
lastName (NSString)
dateOfBirth (NSDate)
updatedAt (NSDate)
weight (NSNumber)
height (NSNumber) 
```

我想获取具有唯一`firstName`、`lastName`和值的用户列表，但只返回具有最新值`dateOfBirth`的每个用户的完整记录。`updatedAt`

所以，对于像这样的数据库：

```
firstName: Jim, lastName: Brown, dateOfBirth: 1/1/2012, updatedAt: 1/1/2012, weight: 100, height: 100
firstName: Jim, lastName: Brown, dateOfBirth: 1/1/2012, updatedAt: 2/1/2012, weight: 120, height: 100
firstName: Joe, lastName: Smith, dateOfBirth: 1/1/2012, updatedAt: 1/1/2012, weight: 100, height: 100
firstName: Joe, lastName: Smith, dateOfBirth: 2/1/2012, updatedAt: 1/1/2012, weight: 100, height: 100 
```

我会得到一个数组：

```
firstName: Jim, lastName: Brown, dateOfBirth: 1/1/2012, updatedAt: 2/1/2012, weight: 120, height: 100
firstName: Joe, lastName: Smith, dateOfBirth: 1/1/2012, updatedAt: 1/1/2012, weight: 100, height: 100
firstName: Joe, lastName: Smith, dateOfBirth: 2/1/2012, updatedAt: 1/1/2012, weight: 100, height: 100 
```

我知道我可以跑来跑去执行一大堆不同的过滤操作，但我想知道是否有任何“捷径”可以帮助做到这一点。`[fetchRequest setReturnsDistinctResults:YES]`如果我对获取值不感兴趣，我可以使用，但如果我包含在要获取的属性中`updatedAt`，这将返回基本上所有的记录。`updatedAt`我担心将整个数据库加载到一个中，`NSArray`因为它可能非常大（> 10,000条记录）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:21:46.423

首先，我认为你应该修改你的数据模型。名字、姓氏和出生日期不足以可靠地替换唯一 ID（在 10.000 条记录中）。

其次，因此您应该创建一个 Person 实体并使用该实体的相同记录来关联某种带有`updated`date 属性的 Event。

有了这个更健壮的结构，您的查询就变得微不足道了。您只需获取所有人。如果需要，您可以为每个人选择最近的事件。

```
Event *latestEvent = [person.events valueForKeyPath@"@max.updated"]; 
```

# html - Selenium - 如何让脚本使用 ajax 控件下拉菜单

> ID：14863541
> 
> 赞同：0
> 
> 时间：2013-02-13T21:32:07.117
> 
> 标签：html, ajax, drop-down-menu, selenium

我已经将 Selenium 与该产品一起使用了一段时间。

常规的 HTML 页面、表单和 javascript 都可以很好地使用它。

我们的开发人员刚刚添加了一个 AJAX 下拉菜单。

我无法用硒“记录”它，我该如何使用它？实际上，我可以记录最初单击了控件（这使下拉菜单出现），但没有记录然后单击了哪个选项。然后我怎样才能检测到他们点击了其中一个选项？

显示的 HTML 是：

```
<ul id="fruit-switcher" class="nav nav-pills">
  <li class="dropdown">
    <a class="dropdown-toggle" href="#">
      Change fruit…
      <b class="caret"></b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a rel="nofollow" data-method="put" href="/admin/fruits/23-bananas/activate"></a>
      </li>
      <li>
        <a rel="nofollow" data-method="put" href="/admin/fruits/28-apples/activate"></a>
      <li>
      </li>
      <li>
        other options (a links)...
      </li>...
    </ul>
  </li>
</ul>
<script>

  //<![CDATA[
    $(function() {
      $('#fruit-switcher .dropdown-toggle').dropdown();
    })
  //]]>

</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:22:24.333

实际上它是直接的硒代码：

```
click    link="Change..."
pause 200
click //ul[contains(@id,'fruit-switcher')]//ul[contains(@class,'dropdown-menu')]/li[3]/a
click    link="Change..."
pause 600
click //ul[contains(@id,'fruit-switcher')]//a[contains(text(),'Bananas')] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:18:00.977

您始终可以将_keys 发送到元素。

# java - 如何获取字母数字并对其进行操作

> ID：14863545
> 
> 赞同：-2
> 
> 时间：2013-02-13T21:32:37.853
> 
> 标签：java, arrays, string, algorithm

我有一个要求，我需要在给定字母和数字时返回字母。例如，如果给定 C 和 4，我将返回 C+4 = G 如果给定 C 和 -2，我将返回 C + (-2) = A

如果我有 AA，那么 AA + 4 = AD，所以我总是想从字符串中取出最后一个字符。

我正在考虑使用字符串数组来存储字母，但这似乎是一种糟糕的解决方案。有什么方法可以让我做得更好吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:35:38.600

字母字符都已按顺序排列，您只需在其中添加一个数字即可获得另一个。

我想你想要这样的东西：

```
addToChar('A', 4);

char addToChar(char inChar, int inNum)
{
  return (char)(inChar + inNum);
} 
```

您可能还想检查它是小于“A”还是大于“Z”。

**回应您的编辑：**

```
void addToChar(char[] inChars, int inNum)
{
   for (int i = inChars.length-1; inNum != 0 && i >= 0; i--)
   {
      int result = inChars[i]-'A'+inNum;
      if (result >= 0)
      {
         inNum = result / 26;
         result %= 26;
      }
      else
      {
         inNum = 0;
         while (result < 0) // there may be some room for optimization here
         {
            result += 26;
            inNum--;
         }
      }
      inChars[i] = (char)('A'+result);
   }
} 
```

**处理溢出：（**效率稍低）（`'Z' + 1`输出`'AA'`）

```
static String addToChar(String inChars, int inNum)
{
   String output = "";
   for (int i = inChars.length()-1; inNum != 0 || i >= 0; i--)
   {
      if (i < 0 && inNum < 0)
         return "Invalid input";
      int result = i >= 0 ? inChars.charAt(i)-'A'+inNum
                          : -1+inNum;
      if (result > 0)
      {
         inNum = result / 26;
         result %= 26;
      }
      else
      {
         inNum = 0;
         while (result < 0)
         {
            result += 26;
            inNum--;
         }
      }
      output = (char)('A'+result) + output;
   }
   return output;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:38:38.437

试试这个例如：

```
public class example {

 public static void main(String[] args) {

     int number = 2;
     char example = 'c';

     System.out.println((char)(example+number));

    }
 } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T22:04:03.510

这是更新问题的示例：

仍然需要验证输入数字和输入字符串（让我们说如果数字是 124 会发生什么？）

```
 public class example {

 public static void main(String[] args) {

     int number = 1;
     String example = "nicd";
     //get the last letter from the string
     char lastChar = example.charAt(example.length()-1);
     //add the number to the last char and save it
     lastChar = (char) (lastChar+number);
     //remove the last letter from the string
     example = example.substring(0, example.length()-1);
     //add the new letter to the end of the string
     example = example.concat(String.valueOf(lastChar));
     //will print nice
     System.out.println(example);

    }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:35:08.757

您不需要将字母存储在数组中；这就是 ASCII 具有连续顺序的所有字母的原因之一。

执行数学运算，将 隐式转换`char`为 a `int`，然后将结果转换为 a `char`。你必须检查你没有在“A”之前或“Z”之后去。

这是一个[ASCII 表参考](http://www.asciitable.com/.)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T21:40:39.730

你曾经在谷歌上搜索过字符集吗？与 ASCII 一样，字符已经由数字表示。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-13T21:44:59.107

首先，使用演员将您的角色转换为`int`a，然后添加您的`int`，并将其转换回 a `char`。例如：

```
char c = 'c';
int cInt = (int)c;
int gInt = cInt + 4;
char g = (char)gInt; // 'G' 
```

# android - 活动之间的序列化性能问题

> ID：14863546
> 
> 赞同：0
> 
> 时间：2013-02-13T21:32:43.663
> 
> 标签：android, performance

我有 2 个活动，我正在尝试从 Activity A 向 Activity B 发送一些实现 Serializable 的巨大对象。问题是 Android 操作系统序列化这些对象所花费的时间。有没有办法在活动之间发送参数？我尝试发送到 Application 对象并在下一个活动中获取它，但我认为这种方式很脏......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:52:30.727

这正是 Android 创建 的原因`Parcelable`，因为它`Serializable`在这个用例中表现出色。

[Android Parcelable 和 Serializable](https://stackoverflow.com/questions/9323044/android-parcelable-and-serializable)

[http://shri.blog.kraya.co.uk/2010/04/26/android-parcel-data-to-pass-between-activities-using-parcelable-classes/](http://shri.blog.kraya.co.uk/2010/04/26/android-parcel-data-to-pass-between-activities-using-parcelable-classes/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T22:13:54.343

`Serializable`以下是您可以使用的一些替代想法，而不是通过or传递大量数据`Parcelable`：

*   如果您经常使用这一大块数据，您可能会考虑使用`Service`. 它将保存数据、处理数据并在需要时交付。之后可以终止它。
*   另一种方法是在 object 中引用这个大`Application`对象（如[this](https://stackoverflow.com/questions/708012/android-how-to-declare-global-variables)）。“全局参考”通常听起来不太好，但在某些情况下建议这样做。更进一步，如果您仍然发现它“脏”，您可以在它传递到第二个并被它使用后[`WeakReference`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/ref/WeakReference.html)立即使用并摆脱它。`Activity`
*   或者，还有另一种方式，您可以考虑以单数形式完成所有工作`Activity`（不开始第二个工作），然后只玩`View`s。如果这对你来说当然是可能的。

# asp.net - dnn 中友好 url 的自定义规则

> ID：14863550
> 
> 赞同：0
> 
> 时间：2013-02-13T21:32:52.550
> 
> 标签：asp.net, dotnetnuke

我正在为 dnn 中的友好网址苦苦挣扎。我有一个个人资料页面：

```
http://localhost/dnn/uProfile/tabid/95/userId/1/Default.aspx 
```

我想成为：

```
http://localhost/dnn/uProfile/1/username.aspx 
```

我试图添加一些规则，`host > friendly url settings`但我真的不明白如何实现这一点，或者我正在尝试不可能:)？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T17:02:49.597

执行此类操作的最佳选择是使用 URLMaster，www.ifinity.com.au

# scala - Play Framework 2.1：Scala：如何获取整个基本 url（包括协议）？

> ID：14863553
> 
> 赞同：14
> 
> 时间：2013-02-13T21:32:58.407
> 
> 标签：scala, request, playframework-2.1

目前我能够从[请求](http://www.playframework.com/documentation/api/2.1.0/scala/index.html#play.api.mvc.Request)中获取主机，其中包括域和可选端口。不幸的是，它不包含协议（http 与 https），因此我无法为站点本身创建绝对 url。

```
object Application extends Controller {
  def index = Action { request =>
    Ok(request.host + "/some/path") // Returns "localhost:9000/some/path"
  }
} 
```

有没有办法从请求对象中获取协议？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-08-21T17:56:26.647

实际上，有一种简单的方法可以使用反向路由器用来实现类似事情的 Call 类。鉴于您在隐式请求的范围内，您可以执行以下操作：

```
new Call(request.method, input.request).absoluteURL() 
```

它将为您提供完整的 url（协议、主机、路由和参数）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-09-07T10:32:52.540

在 Play 2.3 及更高版本中，您可以使用[Request](https://www.playframework.com/documentation/2.3.x/api/scala/index.html#play.api.mvc.Request)类[的属性。`secure`](https://www.playframework.com/documentation/2.3.x/api/scala/index.html#play.api.mvc.Request)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-02-13T23:10:48.237

我不认为有。

*   Play Framework 2.0 本身不支持 https，参见：[play-framework [2.0] HTTPS](https://stackoverflow.com/questions/9924848/play-framework-2-0-https)
*   [`absoluteURL`Play Framework 2.0的类的方法的`Call`](https://github.com/playframework/Play20/blob/master/framework/src/play/src/main/java/play/mvc/Call.java#L45)实现不建议这样做。

一种解决方法是使用[协议相对 url](http://paulirish.com/2010/the-protocol-relative-url/)，使用`//domain.com/path`.

但是，这对电子邮件中的链接没有帮助。在这种情况下，您可以将协议放在`application.conf`. 在大多数情况下，差异是因为生产支持 https 而开发不支持。

我还没有找到上述解决方法不起作用的情况。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-14T13:03:50.273

实际上，如果它是 http 或 https，您的端口号会给您。

使用 https 支持启动您的 Play 服务器`JAVA_OPTS=-Dhttps.port=9001 play start`

这是一个代码片段（您可以使用正则表达式使验证更加稳定，从属性中获取 https 端口号......）

```
def path = Action { request =>
    val path = 
      if(request.host.contains(":9000"))
        "http://" + request.host + "/some/path"
      else
        "https://" + request.host + "/some/path"
    Ok(path)
  } 
```

代码将返回

```
http://ServerIp:9000/some/path if it's thru http
https://ServerIp:9001/some/path if it's thru https 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-14T11:13:16.527

我的解决方案是将 url 的开头作为 javascript 的附加参数传递。application.conf 解决方案对我不起作用，因为可以通过 http 和 https 访问相同的应用程序，但可以从不同的子网和域访问。

# xslt - XSLT 中的布尔“总和”

> ID：14863559
> 
> 赞同：3
> 
> 时间：2013-02-13T21:33:12.760
> 
> 标签：xslt, boolean

我知道我可以用数值对多个节点求和。我怎样才能对一组节点进行“布尔求和”？例如：

```
<a>
  <b>false</b>
  <b>false</b>
  <b>true</b>
  <b>false</b>
</a> 
```

如何获得所有`<b>`节点值的布尔 OR？（这应该是“真实的”）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T03:38:54.490

**使用**：

```
boolean(/*/b[. = 'true']) 
```

**这将产生表达式的布尔值**：

```
 /*/b[. = 'true'] 
```

**并且在上述表达式至少选择一个节点时为真**——也就是说，当有 a`b`是顶部元素的子元素并且其字符串值为 string 时`'true`。

* * *

**如果您还想计算“布尔产品”（使用*and*），请执行以下操作：**

```
not(/*/b[. = 'false']) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:39:28.300

您可以计算真实值：

```
<xsl:if test="count(a/b[text()='true']) > 0">
        true
</xsl:if> 
```

如果有任何真值，则 OR 将为真。

# actionscript-3 - 加载多个本地 SWF 时出现 AS3 错误 1014

> ID：14863562
> 
> 赞同：1
> 
> 时间：2013-02-13T21:33:16.607
> 
> 标签：actionscript-3

我有两个 SWF，分别称为 A 和 B。它们永远不会部署到网站上，而是用于工具。B 依赖于 A - B 中的某些类扩展了 A 中的类。

我现在正在创建第三个 SWF，称之为 X。X 正在尝试使用 a 和 加载 A`flash.display.Loader`和`flash.net.URLRequest`B。A 和 B 路径被推入一个数组，然后在一个`loadLibrary`函数中调用，如下所示：

```
public class LibraryLoader
{
    private static const CLASS_NAME:String = "LibraryLoader";
    private var _libraries:DisplayObjectContainer;

    ...

    public function loadLibrary(callback:Function, libName:String):void
    {
        trace("loadLibrary('" + libName + "')");

        var loader:Loader = new Loader();
        loader.name = libName;

        var listener:Function = function(e:Event):void
        {
            trace("finished loading '" + libName + "', event: " + e);
            loader.contentLoaderInfo.removeEventListener(Event.COMPLETE, listener);
            _libraries.addChild(loader);
            callback();
        }

        loader.contentLoaderInfo.addEventListener(Event.COMPLETE, listener);
        loader.load(new URLRequest(libName));
    } 
```

问题是，当我加载 B 时，它会引发错误。这是输出：

```
loadLibrary('C:\path\to\A.swf')
finished loading 'C:\path\to\A.swf', event: [Event type="complete" bubbles=false cancelable=false eventPhase=2]
loadLibrary('C:\path\to\B.swf')
[Fault] exception, information=VerifyError: Error #1014: Class a.class.in::A could not be found. 
```

这个类在A里面，B依赖它。

我用谷歌搜索并找到了有关安全权限和沙箱的信息——也许我需要在这些 SWF 之间建立一些信任。这很好，但我似乎无法弄清楚如何正确地做到这一点。

一方面，我尝试像这样设置 LoaderContext（加载两个 SWF 时）：

```
var context:LoaderContext = new LoaderContext();
context.applicationDomain=ApplicationDomain.currentDomain;
loader.load(new URLRequest(libName), context); 
```

没有骰子，那里；同样的错误。此外，尝试设置`context.securityDomain`抛出：

```
[Fault] exception, information=SecurityError: Error #2142: Security sandbox violation: local SWF files cannot use the LoaderContext.securityDomain property. file:///C|/path/to/X.swf was attempting to load file:///C:/path/to/A.swf. 
```

万一有所不同，A 和 B 正在使用`compc.exe`Flex SDK (3.6) 进行编译。我为每个生成一个 SWF 和一个 SWC - 用于运行时的 SWF 和用于编译的 SWC - 使用 compc。这是 compc 的命令行：

```
compc.exe  -output C:\temp\dir -source-path   -include-sources C:\path\to\A\source -directory=true -incremental=true -debug=true  -use-network=false 
compc.exe  -output C:\path\to\A.swc -source-path   -include-sources C:\path\to\A\source -incremental=true -debug=true  -use-network=false 
compc.exe  -output C:\temp\dir -source-path   -include-sources C:\path\to\B\source -directory=true -incremental=true -debug=true  -external-library-path+=C:\path\to\A.swc -use-network=false 
```

在第一次和第三次编译之后，一个“library.swf”文件被放到列出的临时目录中。我取出这些 SWF 并将它们重命名为 A.swf 和 B.swf，将它们放到我想要的位置。

我的 X 项目是在用于 Flash Player 10.1 的 FlashDevelop 4.0.1 中构建的。

我知道它`a.class.in::A`包含在 SWF A 中。我在 Scaleform 运行时中加载这些 SWF 时没有任何问题，因此我确信 FlashPlayer 的处理方式存在某种问题。

当我从 X 加载 A 和 B 时，如何让 B 查看 A 中的类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T08:43:20.300

有三个评论：

1.  你是对的，当你在没有这个加载器的情况下指定`applicationDomain`to时`ApplicationDomain.currentDomain;`，加载 swf 以将子域与共同的父域分开，因此它们看不到彼此的类。
2.  对于通用应用程序域，必须可以从 B 访问来自 A 的类，所以我只看到错误的一种可能性： A 真的没有 class `some.class.in.A`。尝试检查该类是否包含在 A 中（例如由 Sothink SWF Decompiler）或仅检查该类是否在 A 中的代码中显式使用。如果未使用，则不包含在内，您可以强制包含通过在代码中添加这个类：只需`some.class.in.A`在 A without`new`语句中添加一些 where 即可。
3.  `context.securityDomain`用于其他用途，仅在http加载swf文件时使用，不适用于本地。

# postgresql - 递归 SQL PostgreSQL 空结果集

> ID：14863572
> 
> 赞同：0
> 
> 时间：2013-02-13T21:34:02.233
> 
> 标签：postgresql, recursion, null, resultset, adjacency-list

分类表：

```
=# \d
          List of relations
 Schema |    Name     | Type  | Owner
--------+-------------+-------+-------
 public | categories  | table | pgsql
 public | products    | table | pgsql
 public | ticketlines | table | pgsql
(3 rows) 
```

分类内容：

```
=# select * from categories;
 id |  name  | parentid
----+--------+----------
 1  | Rack   |
 2  | Women  | 1
 3  | Shorts | 2
 4  | Wares  |
 5  | Toys   | 4
 6  | Trucks | 5
(6 rows) 
```

运行以下查询：

```
WITH RECURSIVE nodes_cte(name, id, parentid, depth, path) AS (
-- Base case?
 SELECT c.name, 
  c.id, 
  c.parentid, 
  1::INT AS depth, 
  c.id::TEXT AS path 
 FROM categories c
 WHERE c.parentid = ''
UNION ALL
-- nth case
 SELECT c.name, 
  c.id, 
  c.parentid, 
  n.depth + 1 AS depth, 
  (n.path || '->' || c.id::TEXT) 
 FROM nodes_cte n
  JOIN categories c on n.id = c.parentid
)
SELECT * FROM nodes_cte AS n GROUP BY n.name, n.id, n.parentid, n.depth, n.path ORDER BY n.id ASC
; 
```

产生这些结果：

```
 name  | id | parentid | depth |  path
--------+----+----------+-------+---------
 Rack   | 1  |          |     1 | 1
 Women  | 2  | 1        |     2 | 1->2
 Shorts | 3  | 2        |     3 | 1->2->3
 Wares  | 4  |          |     1 | 4
 Toys   | 5  | 4        |     2 | 4->5
 Trucks | 6  | 5        |     3 | 4->5->6
(6 rows) 
```

伟大的！

但给定一个类似的表（类别）：

```
=# \d categories
        Table "public.categories"
  Column  |       Type        | Modifiers
----------+-------------------+-----------
 id       | character varying | not null
 name     | character varying | not null
 parentid | character varying |
 image    | bytea             |
Indexes:
    "categories_pkey" PRIMARY KEY, btree (id)
    "categories_name_inx" UNIQUE, btree (name)
Referenced by:
    TABLE "products" CONSTRAINT "products_fk_1" FOREIGN KEY (category) REFERENCES categories(id)

=# select * from categories;
                  id                  | name  |               parentid               | image
--------------------------------------+-------+--------------------------------------+-------
 611572c9-326d-4cf9-ae4a-af5269fc788e | Rack  |                                      |
 22d15300-40b5-4f43-a8d1-902b8d4c5409 | Women | 611572c9-326d-4cf9-ae4a-af5269fc788e |
 6b061073-96f4-49a1-9205-bab7c878f0cf | Wares |                                      |
 3f018dfb-e6ee-40d1-9dbc-31e6201e7625 | Toys  | 6b061073-96f4-49a1-9205-bab7c878f0cf |
(4 rows) 
```

相同的查询产生零行。

为什么？

它与主键/外键有关吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T13:24:35.297

```
WHERE COALESCE(parent_id, '') = '' 
```

工作。谢谢你。

# python - 用 lambda 减少集合

> ID：14863576
> 
> 赞同：0
> 
> 时间：2013-02-13T21:34:17.530
> 
> 标签：python, functional-programming

给定一个集合，其中每个元素都是一个字符串，如何将集合缩减为一个整数，即这些字符串的长度之和？

```
setA = ("hi", "hello", "bye")
reduce(lambda .... for word in setA) 
```

使用一些 lambda 函数调用 reduce 应该返回 10 (2 + 5 + 3)。

我想我可以用几个 lambdas 来做到这一点，但必须有一种更清洁的方法。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T21:35:31.543

惯用的解决方案是使用[生成器表达式](http://www.python.org/dev/peps/pep-0289/)：

```
sum(len(s) for s in setA) 
```

生成器表达式和列表推导[应该优先](https://stackoverflow.com/questions/1247486/python-list-comprehension-vs-map)于`map()`and`reduce()`和 lambdas。后者是可用的，但被认为是“unpythonic”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T21:36:09.117

干得好：

```
sum(map(len, setA)) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-13T21:36:46.150

```
In [4]: reduce(lambda x, y: x+y , map(lambda x: len(x), setA))
Out[4]: 10 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-02-13T21:37:56.537

如果你真的想用`lambda`and做到这一点`reduce`，你可以：

```
reduce(lambda x, y: x + len(y), s, 0) 
```

但我不确定你为什么`reduce`要从 0 开始而不是仅仅使用`sum`，在这种情况下你的 lambda 是 just `lambda y: len(y)`，相当于 just `len`。

# mysql - 制作条件 MySQL 插入语句

> ID：14863578
> 
> 赞同：1
> 
> 时间：2013-02-13T21:34:21.630
> 
> 标签：mysql, sakai

所以我有这个名为 SAKAI_REALM_RL_FN 的表，它有 3 个字段

*   REALM_KEY
*   ROLE_KEY
*   FUNCTION_KEY

该语句需要做的是，如果每个 REALM_KEY 不存在 ROLE_KEY 和 FUNCTION_KEY 的某些 2 组合，则执行插入。

我已经在看[这篇 StackOverflow 帖子了](https://stackoverflow.com/questions/5247530/mysql-how-to-insert-a-record-for-each-result-in-a-sql-query)

我还有用于单数插入的查询：

```
INSERT INTO `sakai`.`SAKAI_REALM_RL_FN` (`REALM_KEY`, `ROLE_KEY`, `FUNCTION_KEY`) VALUES (248620, 8, 308); 
```

伪代码：

```
if(ROLE_KEY equals 8 and FUNCTION_KEY=308 don't exist for REALM_KEYS)
    than insert ROLE_KEY=8 & FUNCTION_KEY=308 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:41:36.787

```
INSERT INTO `sakai`.`SAKAI_REALM_RL_FN` (`REALM_KEY`, `ROLE_KEY`, `FUNCTION_KEY`)
SELECT *primaryKey*
FROM `sakai`.`SAKAI_REALM_RL_FN`
WHERE not exists (SELECT *primaryKey*
                  from `sakai`.`SAKAI_REALM_RL_FN`
                  where role_key = 8 and function_key = 308); 
```

希望有帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:20:15.470

我不太确定你想要什么，但这里有一些你可能会觉得有用的东西。

具有少量条目的架构：

```
CREATE TABLE ALOHA (
  REALM_KEY VARCHAR(32) NOT NULL,
  ROLE_KEY VARCHAR(32) NOT NULL,
  FUNCTION_KEY VARCHAR(32) NOT NULL
  );

INSERT INTO ALOHA VALUES ('1', '1', '1');
INSERT INTO ALOHA VALUES ('1', '1', '2');
INSERT INTO ALOHA VALUES ('1', '2', '1');
INSERT INTO ALOHA VALUES ('1', '2', '2');
INSERT INTO ALOHA VALUES ('1', '2', '3');
INSERT INTO ALOHA VALUES ('1', '2', '4'); 
```

尝试插入 3 个条目（仅插入一个）：

```
INSERT INTO ALOHA (REALM_KEY, ROLE_KEY, FUNCTION_KEY)
 SELECT * FROM (
  SELECT '1' AS REALM_KEY, '2' AS ROLE_KEY, '1' AS FUNCTION_KEY
  UNION ALL
  SELECT '1', '2', '3'
  UNION ALL
  SELECT '1', '2', '5'
 ) s 
 WHERE NOT EXISTS
  (SELECT 1 FROM ALOHA a
   WHERE a.ROLE_KEY = s.ROLE_KEY
   AND a.REALM_KEY = s.REALM_KEY
   AND a.FUNCTION_KEY = s.FUNCTION_KEY); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:41:28.800

如果您定义正确的索引，RDBMS 可以很好地处理这个问题。

听起来您需要的是跨*所有三*列的复合`UNIQUE`索引。当您执行 时，如果组合尚不存在，则将插入该组合。*`INSERT IGNORE`*

 ***请注意，如果您的表中已经有非唯一行，这将失败。**

```
ALTER TABLE SAKAI_REALM_RL_FN ADD UNIQUE KEY `idx_unique_realm_role_function` (REALM_KEY, ROLE_KEY, FUNCTION_KEY) 
```

然后`INSERT`选择`REALM_KEY`其他 2 列的所有值和静态值。如果这些值已经存在，它们将被忽略。否则它们将与`REALM_KEY`.

```
INSERT IGNORE INTO SAKAI_REALM_RL_FN (REALM_KEY, ROLE_KEY, FUNCTION_KEY) 
  /* SELECT within INSERT gets all REALM_KEY plus the 2 static values */
  SELECT 
    REALM_KEY, 
    8, 
    308
  FROM SAKAI_REALM_RL_FN 
```

## [这是一个演示](http://sqlfiddle.com/#!2/b92c3/1)

完成 后`INSERT IGNORE`，您可以放弃 ，`UNIQUE KEY`因为它可能不再需要。

```
ALTER TABLE SAKAI_REALM_RL_FN DROP KEY `idx_unique_realm_role_function` 
```*

# django - 让 yaml 将“/hello/”重定向到“/hello”

> ID：14863581
> 
> 赞同：0
> 
> 时间：2013-02-13T21:34:30.910
> 
> 标签：django, google-app-engine

自动取款机，尝试访问时

www.eyalw.com/1keyboard/ 你什么也得不到，

但是当访问 www.eyalw.com/1keyboard

你得到正确的页面。

这是当前的 yaml：

```
application: eyalwcom
version: 1
runtime: python27
api_version: 1
threadsafe: no

handlers:

- url: /
  static_files: static/index.html
  upload: static/index.html

- url: /1keyboard
  static_files: static/1keyboard.html
  upload: static/1keyboard.html

- url: /
  static_dir: static

libraries:
- name: webapp2
  version: "2.5.2" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:02:34.983

您可以输入一个正则表达式来匹配您的网址。我不确定我是否可以从头顶得到正确的正则表达式，我认为它会是：

```
- url: /1keyboard/? 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T12:10:13.933

如果您希望始终添加尾部斜杠，您可以使用来自 webapp2 的 RedirectRoute `strict_slash=True`，如下所述：[http ://webapp-improved.appspot.com/api/webapp2_extras/routes.html#webapp2_extras.routes.RedirectRoute](http://webapp-improved.appspot.com/api/webapp2_extras/routes.html#webapp2_extras.routes.RedirectRoute) [1](http://webapp-improved.appspot.com/api/webapp2_extras/routes.html#webapp2_extras.routes.RedirectRoute)

与其将其添加到您的 app.yaml 文件中，不如将其包含在您定义其他路由并将它们链接到处理程序的位置。

# knockout.js - 淘汰赛下拉菜单

> ID：14863588
> 
> 赞同：3
> 
> 时间：2013-02-13T21:35:05.607
> 
> 标签：knockout.js

我在获取绑定下拉列表的选定项目时遇到问题。

```
<p>
  Your Group: 
  <select data-bind="options: availableGroups, optionsText: 'Name', optionsValue: 'GroupId', value: selectedGroup, optionsCaption: 'Choose...'"></select>
</p>
<p>
  I am visible
  You have chosen <span data-bind="text: selectedGroup() ? selectedGroup().Name : 'Nothing'"></span>
</p> 
```

当我从下拉列表中选择某些内容时，我想获取选择的文本，而不是值。我对淘汰赛很陌生，并试图解决这个问题。我为此创建了一个小提琴。

[http://jsfiddle.net/voam/FjRxn/](http://jsfiddle.net/voam/FjRxn/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-12T04:14:28.390

我只是想发布一个我最近一直在使用的解决方案来解决这个问题。它利用绑定处理程序（valueAppendText 和 textFromOption）并将一个可观察对象附加到由下拉列表跟踪的可观察对象。此解决方案并不完整，但演示了不使用添加计算来获取下拉文本的想法。这个解决方案还使用了 jQuery，它可以被删除，但是由于我在我的项目中（大部分）使用 jQuery，所以我把它留在里面。下面的 jsFiddle 链接演示了这个功能。

小提琴：http: [//jsfiddle.net/FjRxn/65/](http://jsfiddle.net/FjRxn/65/)

标记：

```
<select data-bind="options: availableGroups, optionsText: 'Name', optionsValue: 'GroupId', valueAppendText: selectedGroup, optionsCaption: 'Choose...'"></select>

<p>
    I am visible
    You have chosen <span data-bind="textFromOption: selectedGroup"></span>
    <div>
        Group Id: <span data-bind="text: selectedGroup"></span>
    </div>
</p> 
```

绑定处理程序：

```
ko.bindingHandlers.valueAppendText = {
    init: function(element, valueAccessor, allBindingsAccessor, context) {
      var $element, newValueAccessor, observable, setText;

      observable = valueAccessor();
      observable.selectedOptionText = ko.observable(null);
      newValueAccessor = function() {
        return observable;
      };
      $element = $(element);
      setText = function() {
        return observable.selectedOptionText($element.find("option:selected").text());
      };
      setTimeout(setText, 5);
      $element.change(function() {
        return setText();
      });
      return ko.bindingHandlers.value.init(element, newValueAccessor, allBindingsAccessor, context);
    },
    update: function(element, valueAccessor, allBindingsAccessor, context) {
      return ko.bindingHandlers.value.update(element, valueAccessor, allBindingsAccessor, context);
    }
  };

  ko.bindingHandlers.textFromOption = {
    update: function(element, valueAccessor, allBindingsAccessor, context) {
      var newValueAccessor, observable;

      observable = valueAccessor();
      newValueAccessor = function() {
        if (ko.isObservable(observable.selectedOptionText)) {
          return observable.selectedOptionText();
        }
        return observable();
      };
      return ko.bindingHandlers.text.update(element, newValueAccessor, allBindingsAccessor, context);
    }
  }; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-14T01:50:48.953

对于您最初的问题@Pete 的回答是正确的，但是由于您需要保留 GroupId 作为您可以执行[此操作的值（修改过的小提琴）](http://jsfiddle.net/FjRxn/42/)。

首先，该`selectedGroup`属性被重命名为`selectedGroupId`。

`selectedGroup`然后基于以下定义了一个新的计算 observable `selectedGroupId`：

```
self.selectedGroup = ko.computed(function () {
  for (var i = 0; i < groups.length; i++) {
    if (groups[i].GroupId == self.selectedGroupId())
      return groups[i];
  }
  return null;
}); 
```

也`var self = this`定义了

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T08:23:49.467

您还可以在可观察的 selectedGroup 上使用订阅功能。我还创建了另一个 observable 作为“selectedGroupId”。

在订阅事件中，我将 GroupId 的值分配给新的 observable “selectedGroupId”

```
 self.selectedGroup.subscribe(function(item)
     {
          debugger;
          self.selectedGroupId(item.GroupId);
          return item.Name;
      }); 
```

请[在此处查看更新的小提琴](http://jsfiddle.net/FjRxn/50/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T21:41:30.083

改变

```
<select data-bind="options: availableGroups, optionsText: 'Name', optionsValue: 'GroupId', value: selectedGroup, optionsCaption: 'Choose...'"></select> 
```

至：

```
<select data-bind="options: availableGroups, optionsText: 'Name', value: selectedGroup, optionsCaption: 'Choose...'"></select> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-08-30T15:08:25.547

最简单的解决方案是从元素中删除 optionsValue 绑定。然后它将整个对象存储在可观察对象中，您可以访问所有属性。

[jsfiddle](http://jsfiddle.net/FjRxn/105/)

```
<select data-bind="options: availableGroups, optionsText: 'Name',
value: selectedGroup, optionsCaption: 'Choose...'"></select> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-12-08T10:10:06.857

就我个人而言，我会使用@pomber 的答案，并进行少量编辑。

```
self.selectedGroup = ko.computed(function(){
  return ko.utils.arrayFirst(self.availableGroups(), function(grp) {
    return grp.GroupId == self.selectedGroupId();
  }
}, this); 
```

我不喜欢在计算的 observables 中使用 for 循环。

[小提琴](http://jsfiddle.net/rLd2xmqb/1/)

# c# - 我的 .Net 套接字处理程序缺少数据包

> ID：14863589
> 
> 赞同：4
> 
> 时间：2013-02-13T21:35:07.730
> 
> 标签：c#, .net, sockets, tcp

我正在.Net/C# 中编写一些代码以通过以太网与一些工厂设备进行通信。我首先分配一个处理程序：

```
 _TCPConn.BeginReceive(
      _StateObject.sBuffer, 0, _StateObject.sBuffer.Length, SocketFlags.None,
      new AsyncCallback(Socket_DataArrival), _StateObject); 
```

然后在我的处理程序中，首先，我做一个*EndReceive*，然后我将数据从套接字的缓冲区传输到我自己的输入缓冲区，以便稍后进行进一步处理，我记录一些东西，然后我做一个*BeginReceive*重新开始，然后我退出处理程序。所以 ...

```
....
   StateObject stateObject = (StateObject)ar.AsyncState;        
   int bytesReceived = stateObject.sSocket.EndReceive(ar);

// transfer bytes, log stuff,  then reenable receive and leave . . . 

   _TCPConn.BeginReceive(   _StateObject.sBuffer, 0,
   _StateObject.sBuffer.Length, SocketFlags.None,
   new AsyncCallback(Socket_DataArrival), _StateObject);

   return; 
```

这在大多数情况下都可以正常工作，但如果工厂设备发送 2 个数据包并拢，它就会失败。这是一个 Wireshark（网络嗅探器）输出。第一列是以微秒为单位的前一个数据包的时间增量（是的，“微”，而不是“毫秒”）

```
002397  10.1.1.116  10.1.2.11  TCP  ....  Len=6
000024  10.1.1.116  10.1.2.11  TCP  ....  Len=9 
```

当这种情况发生时，第一个数据包似乎消失了——处理程序永远不会被 6 字节数据包调用，只有 9 字节数据包。我知道数据包到达 PC 是因为 Wireshark 显示了它。

但是，如果我们在工厂设备中引入延迟，那么问题就消失了，而不是 24 微秒，而是 10 毫秒。不幸的是，这不是一个解决方案，因为我们无法改变世界各地工厂中安装的大量设备。

有关如何调试和修复此问题的任何建议？ **先感谢您！**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-24T12:43:43.690

你为什么要做 EndReceive(ar) 你应该继续接收。分别处理收到的数据包。你不必停止接收。

# android - 防止屏幕旋转android上的登录屏幕

> ID：14863594
> 
> 赞同：0
> 
> 时间：2013-02-13T21:35:28.820
> 
> 标签：android, android-orientation, android-windowmanager

我有一个应用程序，只要活动进入 onPause 状态，就会在其中显示登录屏幕。通常，当屏幕方向改变时，活动会进入 onPause 状态，所以我在设备旋转时以某种方式阻止了登录屏幕。看下面的代码，

```
protected void onPause() {
    super.onPause();

    WindowManager mWindowManager =  (WindowManager) getSystemService(WINDOW_SERVICE);
    mDisplay = mWindowManager.getDefaultDisplay();

    mOrientation = mDisplay.getRotation();

    if(mOrientation == 1 || mOrientation == 2 || mOrientation == 3 || mOrientation == 0)
    {
        inApp = true;
    }
    if (!inApp) {

        SavedState.setState(this, "HomeActivity");

        Intent intent = new Intent(HomeActivity.this, LoginActivity.class);
        startActivity(intent);
    }
} 
```

但问题是当我按下主页按钮并返回应用程序时，登录屏幕没有显示，而是直接恢复到活动，因为`mDisplay.getRotation()`读取屏幕当前方向并且`if`条件总是为真。

简单明了，我需要在用户按下主页按钮或切换到其他应用程序时显示登录屏幕，但在屏幕旋转时不显示。

非常感谢任何类型的建议或示例。谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:00:31.843

这是应该起作用的东西-您可能需要充实一下...

```
class MyActivity... {
    private boolean loggedIn = false;

@Override
protected void onSaveInstanceState( Bundle data ) {
    super.onSaveInstanceState( data );
    data.putBoolean( "loggedIn", loggedIn );
}

@Override
protected void onUserLeaveHint() {
    isLoggedIn = false; // user pressed home
}

@Override 
protected void onCreate( Bundle data ) {
    isLoggedIn = data.getBoolean( "loggedIn", false );
    ....
}

@Override
protected void onResume() {
    if( !isLoggedIn ) {
        /// Log in...
    }
} 
```

此模式使用首选方法使用/恢复 Activity 的状态，并且作为奖励，如果按下 Home 按钮（或用户 Activity 决定移动到不同的应用程序），则注销用户。请注意，电话不应在此处将用户注销-在大多数情况下，这是所需的行为。

确保清除`android:configChanges`其他人推荐的垃圾。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-13T21:39:03.563

默认情况下，Android 实际上会在轮换时销毁并重新启动您的活动。这会导致`onPause()`, `onStop()`, `onDestroy()`, `onCreate()`, `onStart()`,`onResume()`被调用。避免此类问题的最佳方法是告诉 Android 不要这样做。在清单中添加`android:configChange="orientation"`到您的活动。它将防止破坏，并改为调用旋转函数。在几乎所有情况下，它仍然会正确地重绘您的屏幕。

# android - Android：如何显示来自 Google Places API 的照片

> ID：14863598
> 
> 赞同：3
> 
> 时间：2013-02-13T21:35:35.537
> 
> 标签：android, google-places

我有一个应用程序从 Google Places API 返回一个地点列表。当用户单击地图上的标记（代表地点）时，会弹出一个对话框，其中包含有关该地点的详细信息。我还想显示该地点的照片（如果存在）。

我从这里知道 Place Photos API：[https ://developers.google.com/places/documentation/photos#place_photo_response](https://developers.google.com/places/documentation/photos#place_photo_response)

我可以从 Place Details 响应中检索 photo_reference，并将它与传感器、maxwidth/maxheight 和我的 API 密钥一起传递给 Place Photos API 请求。我遇到的问题是从响应中获取照片。如何将照片对象检索为位图，以便可以在对话框中显示它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T23:43:05.233

经过几个小时的挫折，我找到了解决方案。

通过在 API 返回的响应上调用`getContentType(`)，我能够识别出响应只是给定类型的图像。就我而言，我发现它是“text/jpeg”。`InputStream`您可以通过调用来检索内容的`getContent()`。

`BitmapFactory`类允许您将 a 解码`InputStream`为`Bitmap`.

```
Bitmap photo = BitmapFactory.decodeStream(request.execute().getContent()); 
```

为了显示这个图像，我首先需要为`DialogBuilder`.

```
LayoutInflater factory = LayoutInflater.from(mapView.getContext());
final View view = factory.inflate(R.layout.dialog_layout, null);
dialog.setView(view); 
```

接下来，我获取照片响应并将其添加到`ImageView`布局中（已在 XML 中定义）：

```
LinearLayout ll = (LinearLayout) view.findViewById(R.id.dialogLayout);
ImageView imageView = (ImageView) ll.findViewById(R.id.placePhoto);
imageView.setImageBitmap(photo); 
```

请务必注意，“地点详细信息”响应最多可以发回 10 张照片。您不能保证“最佳”照片会被退回。就我而言，我选择第一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-14T10:01:29.863

最新版本的 Google Play 服务 (7.8) 包括获取与地点相关联的照片的功能 - 请参阅[此处](https://developers.google.com/android/reference/com/google/android/gms/location/places/GeoDataApi.html#getPlacePhotos(com.google.android.gms.common.api.GoogleApiClient,%20java.lang.String))获取 javadoc。

# javascript - jquery-ui 中的可拖动重影在 IE8/9 中不起作用

> ID：14863599
> 
> 赞同：0
> 
> 时间：2013-02-13T21:35:35.870
> 
> 标签：javascript, jquery, jquery-ui, internet-explorer

首先使用 jquery-ui draggable() 生成一个可拖动的框，并在顶部生成一个句柄。

但是，有时框内的内容可能会闪烁，这往往会导致拖动功能移动得太慢。我决定移动到重影类型系统，在其中拖动它，它会显示一个你正在移动它的框，然后将它移动到你放置它的位置。

我已经让它在 Chrome/Firefox 中完美运行，但无法让它在 IE8 或 IE9 中运行。想知道是否有人有任何建议。下面是jquery特定的代码。

```
$(document).ready(function () {
$container = $('#container');
$container.draggable({
    handle: "#header",
    containment: "parent",
    scroll: false,
    helper: function () {
        return "<div class='dragbox' style='width:" + ($container.width()) + "px;height:" + ($container.height()) + "px'></div>";
    },
    stop: function (e, ui) {
        var top = ui.position.top,
            left = ui.position.left;
        $container.css({
            'top': top + "px",
                'left': left + "px"
        });
    }
});
}); 
```

示例可以在[http://jsfiddle.net/Ep5wu/](http://jsfiddle.net/Ep5wu/)找到。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T17:11:22.510

拖动停止事件中的参数 'ui' 是自身拖动的元素，而不是 'helper' div（绿色框）。在拖动停止后，您需要 'helper' 的顶部/左侧值。

试试这个..在 IE10 中工作

```
$(document).ready(function () {
        $container = $('#container');
        $container.draggable(
        {
            handle: "#header", scroll: false,       
            helper:function () {
                return "<div class='dragbox' style='width:" + ($container.width()) + "px;height:" + ($container.height()) + "px'></div>";
            },
            stop: function (e, ui) {
                console.log(ui.helper);
                var top = $(ui.helper).offset().top;
                var left = $(ui.helper).offset().left;
                $container.css({
                    'top': top + "px",
                    'left': left + "px"
                });
        }
            });
    }); 
```

在这里小提琴：http: [//jsfiddle.net/Ep5wu/16/](http://jsfiddle.net/Ep5wu/16/)

# c# - 使用 .where 和 .select 从列表中的列表中选择单个元素

> ID：14863601
> 
> 赞同：1
> 
> 时间：2013-02-13T21:35:40.817
> 
> 标签：c#, string, list, ienumerable, rectangles

我有一个`List<>`类型`world`，在每个世界元素中都是一个`List<>`类型`item`，它本身包含一个`Rectangle`和一个`string`

这是世界的结构

```
`class world
    public Items[] items { get; set; }

    public world(int nooflevels, int noofitems)
    {
        //when creating a world make the items
        items = new Items[noofitems];

        for (int i = 0; i < noofitems; i++)
        {
            items[i] = new Items();
        }
     }        
}` 
```

和项目

```
class Items
{
    public new Rectangle spriterect;
    public string type { get; set; }

    public Items()
    {
        spriterect.X = 0;
        spriterect.Y = 0;
        spriterect.Width = 0;
        spriterect.Height = 0;
        type = "default";
    }

} 
```

这个世界列表是这样创建的 `List<world> Worlds = new List<world>();`

我试图根据类型从项目列表中取出一个特定的矩形

```
 void getitem(string thetype, int world)
    {
        Rectangle  a = Worlds[world].
                       items.Where(f=> f.type == thetype).
                       Select(g => g.spriterect);
    } 
```

所以我希望这会选择包含 .type thetype 的 item[].spriterect 并且我希望它返回该项目中的矩形，但它返回一个 IEnumerable 我如何让它根据类型返回单个矩形？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:39:44.477

您应该从项目中选择单个项目。如果应该有指定类型的单个矩形，则使用`SingleOrDefault`：

```
var item = Worlds[world].items.SingleOrDefault(i => i.type == thetype);
if (item != null) 
    a = item.spriterect; 
```

如果您完全确定始终存在指定类型的矩形，则只需使用`Single`：

```
Rectangle a = Worlds[world].items.Single(i => i.type == thetype).spriterect; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T21:40:04.103

你会想[`.Single`](http://msdn.microsoft.com/en-us/library/bb155325%28v=vs.90%29.aspx)在你之后使用`.Select`。

如果不完全匹配，Single 将抛出异常。

```
Rectangle a = Worlds[world]
                   .items.Where(f=> f.type == thetype)
                   Select(g => g.spriterect).Single(); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T21:41:50.910

而不是 where 使用[FirstOrDefault](http://msdn.microsoft.com/en-us/library/bb340482.aspx)。如果它没有找到该项目，它将返回 null。

```
var primary = Worlds[world].FirstOrDefault(f=> f.type == thetype);

if (primary != null)
   return primary.spriterect;

return null; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T21:41:05.723

如果您只知道您将只能获得一个可以使用的值`Single`，或者`SingleOrDefault`您知道该项目可能不存在。

```
//use if you know the rectangle will be there, and there will be only 1 that matches the criteria
Rectangle a = Worlds[world].items.Single(f => f.type == thetype).spriterect;

//use if the rectangle may not be there, and if it is there will be only 1 that matches the criteria
var item = Worlds[world].items.SingleOrDefault(f => f.type == thetype);
if (item != null)
    Rectangle a = item.spriterect; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-13T21:42:37.057

该`Where`函数返回一个集合（符合条件的所有内容），而不仅仅是单个项目。您可能想使用`First`or `Single`，注意`Single`如果有多个匹配条件，则会抛出异常（如果没有，则两者都会抛出）。

# javascript - 客户端的 Google 分析凭据

> ID：14863606
> 
> 赞同：0
> 
> 时间：2013-02-13T21:35:56.680
> 
> 标签：javascript, google-analytics-api

我目前是通过 Javascript 使用 Google 分析 API 的新手。我正在实现一些图表，首次加载时，页面将我重定向到谷歌网站以使用 Analytics 帐户登录，然后返回到我的原始页面，刷新和图表显示。

在这里，我想避免用户重定向到谷歌分析页面，而不是将凭据存储在配置文件或应用程序变量中的某处。

我尝试搜索和阅读许多博客和文章，但没有成功。

是否有任何技巧/想法可以让我获得任何可以解决此问题的 API？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:41:24.060

Google 不允许您将物理图表拉到您的网站上，因为它们是动态生成的。您可以做的是从他们的 API 中获取数据，然后根据需要在您的站点上显示数据。我已经搜索并找到了一些例子，[看起来](http://www.developerdrive.com/2012/03/embed-analytics-using-the-google-analtyics-api/)它可能会奏效。

它经历了通过 API 提取数据、显示/格式化/样式化数据以及将图表添加到页面的步骤。试试看，[使用 Google Analytics API 嵌入分析](http://www.developerdrive.com/2012/03/embed-analytics-using-the-google-analtyics-api/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-21T04:33:43.570

你被重定向到谷歌登录页面的原因是谷歌连接到你登录的任何用户的分析数据。这意味着每个登录网站的用户都会看到他们自己的分析信息，而不是来自静态帐户的信息。

如果您希望它是同一个用户的分析数据，无论谁登录，您都需要在 Google 的 API 控制台（[https://code.google.com/apis/console/](https://code.google.com/apis/console/)）上设置一个“服务帐户”，然后登录时使用这些凭据。

似乎很多人都在寻找解决方案，所以我创建了一个 nuGet 包： - 连接到您在 API 控制台中设置的“服务帐户” - 提取您想要的任何 Google Analytics 数据 - 显示数据使用 Google 的 Charts API，它以一种非常容易修改的方式完成所有这些工作。您可以在此处查看更多信息：[https](https://www.nuget.org/packages/GoogleAnalytics.GoogleCharts.NET/) ://www.nuget.org/packages/GoogleAnalytics.GoogleCharts.NET/ 。

# bash - Bash：一个多字变量打破 curl

> ID：14863609
> 
> 赞同：1
> 
> 时间：2013-02-13T21:36:13.357
> 
> 标签：bash

我在 bash 中遇到了一个小问题。

我有这条相当难看的线

```
curl -u "$USER:$PASS" --request POST --data '{"title": "'$BRANCH_NAME'", "body": "'$DESCRIPTION'", "head": "'$OWNER':'$BRANCH_NAME'", "base": "develop"}' https://api.github.com/repos/$OWNER/$REPO_NAME/pulls 
```

在这些变量中的大多数都是单个单词的情况下，$DESCRIPTION 可以不止一个，但它似乎打破了界限。

有没有办法让 $DESCRIPTION 在 curl 命令中包含多个单词时不会破坏它？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T22:04:23.990

使用[shell](/questions/tagged/shell "显示标记为“外壳”的问题") *here-doc*对（你）我们的大脑来说会更安全：

```
curl \
    -X POST \
    -H "Content-type:text/json" \
    -d@- \
    "https://api.github.com/repos/$OWNER/$REPO_NAME/pulls" <<EOF
    {
        "title": "$BRANCH_NAME",
        "body" : "$DESCRIPTION",
        "head" : "$OWNER:$BRANCH_NAME",
        "base" : "develop"
    }
EOF 
```

*   `-X`开关是一样的`--request`
*   `-d`开关是一样的`--data`
*   如果存在，您可以替换`d@-`为。`-d@/dev/stdin`
*   `@`for `-d`switch 表示*从文件中读取*

简单而正确的解决方案=）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T21:46:33.953

您应该将变量放在 "" 引号内。喜欢：

```
curl -u "$USER:$PASS" --request POST --data '{"title": "'"$BRANCH_NAME"'", "body": "'"$DESCRIPTION"'", "head": "'"$OWNER"':'"$BRANCH_NAME"'", "base": "develop"}' "https://api.github.com/repos/$OWNER/$REPO_NAME/pulls" 
```

或者，您可以（甚至应该）这样做：

```
data="$( printf '{"title": "%s", "body": "%s", "head": "%s:%s", "base": "develop"}' "$BRANCH_NAME" "$DESCRIPTION" "$OWNER" "$BRANCH_NAME" )"
curl -u "$USER:$PASS" --request POST --data "$data" "https://api.github.com/repos/$OWNER/$REPO_NAME/pulls" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:47:15.713

由于`$DESCRIPTION`可以是多个单词，所以必须用双引号括起来，因此：

```
curl -u "$USER:$PASS" --request POST \
     --data '{"title": "'$BRANCH_NAME'", "body": "'"$DESCRIPTION"'", \
              "head": "'$OWNER':'$BRANCH_NAME'", "base": "develop"}' \
     https://api.github.com/repos/$OWNER/$REPO_NAME/pulls 
```

这是一个不明显的小事，但是该`"'"$DESCRIPTION"'"`部分在 ; 的单引号值内有一个双引号`--data`。然后单引号被终止（暂时），然后有双引号`"$DESCRIPTION"`，然后是一个新的单引号部分的开始，里面的第一个字符是双引号。

为了保持一致性和面向未来，您还应该类似地围绕其他变量：

```
curl -u "$USER:$PASS" --request POST \
     --data '{"title": "'"$BRANCH_NAME"'", "body": "'"$DESCRIPTION"'", \
              "head": "'"$OWNER"':'"$BRANCH_NAME"'", "base": "develop"}' \
     https://api.github.com/repos/$OWNER/$REPO_NAME/pulls 
```

尽量避免在所有 shell 变量值中同时使用单引号和双引号；如果您不得不担心这样的报价，您将做噩梦。

# javascript - JQ Grid - 储蓄编辑

> ID：14863610
> 
> 赞同：0
> 
> 时间：2013-02-13T21:36:16.713
> 
> 标签：javascript, jqgrid

当用户转到第 2 页（或任何其他页面）时，是否有 JQGrid“记住”在第 1 页上所做的编辑？

我还没有找到解决这个问题的简单方法，特别是当我们有很多很多行数据时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:59:08.323

您必须查看 jqGrid 的[内联编辑](http://www.trirand.com/jqgridwiki/doku.php?id=wiki%3ainline_editing)功能。它们包括在单元格中的数据更改时触发的事件处理程序。这些会将更改发送到您的服务器并更新您的数据存储。

# objective-c - 使用两个核心数据模型、一个持久存储协调器和多个持久存储？

> ID：14863618
> 
> 赞同：0
> 
> 时间：2013-02-13T21:36:47.043
> 
> 标签：objective-c, database, core-data

我想知道这张图片的代码会是什么样子

![在此处输入图像描述](../Images/9413e9c80eddd7445259cf7f9326ff7b.png)

[https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreData/Art/advanced_persistence_stack.gif](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CoreData/Art/advanced_persistence_stack.gif)

我尝试过这样做，但最终将两个核心数据模型都保存到了一个 sqlite 数据库中。你怎么能像图片中那样做？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:52:49.753

您使用数据模型的配置部分（每个人都忽略的底部位）将特定实体定向到持久存储。添加两个新配置，一个用于每个持久存储，然后将相关实体添加到每个配置。

然后，在设置核心数据堆栈期间添加持久存储时，使用,参数`addPersistentStoreWithType:configuration:URL:options:error:`中的配置名称。`configuration`

然后，协调器将为您将实体保存到适当的存储中。

# java - 在 Mockito 中存根返回 Null 函数

> ID：14863619
> 
> 赞同：2
> 
> 时间：2013-02-13T21:36:49.573
> 
> 标签：java, mockito

我一直在使用 JUnit 和 Mockito 来尝试测试特定网络模块如何影响其输入和输出流。为了便于测试，我创建了一组模拟网络对象流（即[ObjectInputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/ObjectInputStream.html)的一个实例和[ObjectOutputStream](http://docs.oracle.com/javase/1.4.2/docs/api/java/io/ObjectOutputStream.html#writeObject%28java.lang.Object%29)的一个实例），并以类似于以下代码片段的方式删除我想要测试的方法：

```
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import static org.mockito.Mockito.*;
import org.junit.Test;  

public class NetworkTester
{
    @Test
    public void ModuleRespondsToServerRequest() throws Exception
    {
        ObjectInputStream mockClientIn = mock(ObjectInputStream.class);
        ObjectOutputStream mockClientOut = mock(ObjectOutputStream.class);

        when(mockClientIn.readObject()).thenReturn("Sent from Server");

        // Initialize module and connect it to the network...

        verify(mockClientOut, timeout(100).atLeastOnce()).writeObject(isNotNull());
    }
} 
```

但是，当我尝试编译和运行此代码时，我在“when(mockClientIn.readObject()).thenReturn("Sent from Server");”行得到一个空指针异常。我相信这是由于“readObject()”函数在存根对象上调用时返回一个空指针，但我不知道是否可以绕过这种行为。

有没有办法使用 Mockito 存根这个函数（或类似的 null 返回函数）？在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:09:10.770

Mockito 不能模拟`readObject()`，因为它是最终的。您可以尝试[PowerMockito](http://powermock.googlecode.com/svn/docs/powermock-1.3.7/apidocs/org/powermock/api/mockito/PowerMockito.html)或考虑重新设计您的代码以便于测试。[在此处](https://stackoverflow.com/questions/3793791/final-method-mocking)查看有关该主题的讨论。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T22:09:27.237

如果您查看源代码，您会注意到该方法是最终的。

```
public final Object readObject() 
```

尝试用另一个对象包装依赖项。请参阅：[最终方法模拟](https://stackoverflow.com/questions/3793791/final-method-mocking)

# c# - 下拉列表值：从字符串转换为 int，然后再转换回字符串并显示在文本框中

> ID：14863622
> 
> 赞同：0
> 
> 时间：2013-02-13T21:36:53.097
> 
> 标签：c#, string, drop-down-menu, integer, selectedvalue

我有多个下拉列表。我正在尝试将下拉列表输入值添加在一起，并将答案显示在文本框中。我将值转换为算术运算的整数，然后再转换回字符串以在文本框中显示答案。

它在 Visual Studio 中和在浏览器中加载时构建没有错误。但是，当您选择一个下拉列表时，会出现错误：“输入字符串的格式不正确。” 对于我的一生，我找不到代码错误：

displayRed 是我希望答案显示在 Red1DD、Red2DD 等中的文本框是下拉列表。

```
displayRed.Text =
  (Convert.ToInt32(Red1DD.SelectedValue.ToString())
 + Convert.ToInt32(Red2DD.SelectedValue.ToString())
 + Convert.ToInt32(Red4DD.SelectedValue.ToString())
 + Convert.ToInt32(Red8DD.SelectedValue.ToString())
 + Convert.ToInt32(Red16DD.SelectedValue.ToString())
 + Convert.ToInt32(Red32DD.SelectedValue.ToString())
 + Convert.ToInt32(Red64DD.SelectedValue.ToString())
 + Convert.ToInt32(Red128DD.SelectedValue.ToString())).ToString(); 
```

这是下拉列表之一的样子：

```
<asp:DropDownList ID="Red1DD" runat="server" AutoPostBack="True" OnSelectedIndexChanged="red_SelectedIndexChanged">
        <asp:ListItem Selected="True" Value="" Text="--" />
        <asp:ListItem value="0" Text="0" />
        <asp:ListItem value="1" Text="1" />
</asp:DropDownList> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:40:51.180

你应该使用`Red1DD.SelectedItem.Text;`而不是`SelectedValue.ToString()`

```
displayRed.Text =
  (Convert.ToInt32(Red1DD.SelectedItem.Text)
 + Convert.ToInt32(Red2DD.SelectedItem.Text)
 + Convert.ToInt32(Red4DD.SelectedItem.Text)
 + Convert.ToInt32(Red8DD.SelectedItem.Text)
 + Convert.ToInt32(Red16DD.SelectedItem.Text)
 + Convert.ToInt32(Red32DD.SelectedItem.Text)
 + Convert.ToInt32(Red64DD.SelectedItem.Text)
 + Convert.ToInt32(Red128DD.SelectedItem.Text)).ToString(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-08T22:20:28.313

也许问题是，您为每个下拉菜单定义了一个空字符串的默认值。 `<asp:ListItem Selected="True" Value="" Text="--" />`

现在，当您将其中一个下拉列表的选择更改为 0 或 1 时，其他下拉列表的值仍然是空字符串。 `Convert.ToInt32(..)`不喜欢空字符串作为参数抛出异常。

因此，将您的默认值更改为 0/1，否则您必须在“转换逻辑”中处理空字符串。例如`Convert.ToInt32(string.IsNullOrEmpty(Red1DD.SelectedValue.ToString()) ? "0" : Red1DD.SelectedValue.ToString());` 等等。

（您可以创建一个方法，该方法检查字符串是否为空并返回解析的值，如果为空则返回零。）

# python - 查询 CSV 并将原始 CSV 和结果写入单个 CSV Python

> ID：14863627
> 
> 赞同：0
> 
> 时间：2013-02-13T21:37:23.240
> 
> 标签：python, regex, parsing, csv

我正在尝试解析 CSV，如果任一列都满足条件，则将其写入新的 csv。

例如

如果我有一个看起来像的 csv

```
123 Some Street
Flat 1, 21 Other road
House, Someother street 
```

我需要分析每一行，所以如果一个数字出现在第一列而不是第二列，那么我需要提取该数字，如果两列中都有一个数字，那么我需要提取两者，如果没有数字，那么我需要提取第一列中的文本。然后用 2 个原始列和 3 个新列写一个新的 csv，数字 1，数字 2，文本。即单位号码，门牌号码，房屋名称。所以新的 CSV 看起来像

```
123 Some Street, , 123, 
Flat 1, 21 Other road, 1, 21,
House, Someother street, , , House. 
```

任何指导都会非常有帮助。

谢谢

已编辑

```
import csv

csvFile = 'myData.csv'
csvOut = 'myOut.csv'

reader = csv.reader(csvFile)
writer = csv.writer(csvOut)

for row in reader:
    num = \d | \d\d | \d\d\d
     if row [0] || row [1] == num
        if row [1] == num
            writer.row [3]
        else row [0] == num
            writer.row [2]
            writer.row [3]
    else writer.row [0] [2]

csvOut.close() 
```

再次编辑

我希望这可能是一个更清晰的解释：

我希望输出是一个新的 CSV，其中原始数据位于 [0]、[1] 行中，然后如果行中只有一个数字，即写入行 [3] 的门牌号，如果有是一行中的 2 个数字（行 [0] 和行 [1]），那么它们应该分别写入行 [2] 和 [3]，如果没有数字，则将行 [0] 中的字符串写入行 [ 4]。最终我需要将公寓号、门牌号和门牌名称分成 3 个不同的列。

进一步编辑

我一直在编写代码，现在有以下内容，我觉得我越来越近了，但还有一段路要走？

```
import csv
import re

csvFile = open(myData.csv, 'rb')
csvOut = open(myOut.csv, 'wb')

reader = csv.reader(csvFile)
writer = csv.writer(csvOut)

for row in reader:
    a = row [0] re.compile('\d' | '\d\d' | '\d\d\d')
    a1 = row [0] re.compile('\d' | '\d\d' | '\d\d\d')
    b = row [1] 
    b1 = row [1] re.compile('\d' | '\d\d' | '\d\d\d')
        if b = re.compile('\d' | '\d\d' | '\d\d\d')
            writer.writerow(a,b,a1,b1, )
        elif a = re.compile('\d' | '\d\d' | '\d\d\d')
            witer.writerow(a,b, , b1, )
        else
            writer.writerow(a,b, , ,a)

csvOut.close() 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:55:59.877

这可能会提供线索，因为我不完全确定您需要什么。

`$cat t1`

```
123 Some Street
Flat 1, 21 Other road
House, 23 Someother street 
```

例子

```
import csv
import re
p = re.compile('\d+')
for row in csv.reader(open('t1')):
    print "ROW", row
    match = p.search(row[0])
    if match:
        print "\t#1", match.group()
    if len(row) > 1:
        match = p.search(row[1])
        if match:
            print "\t#2", match.group() 
```

输出

```
ROW ['123 Some Street']
    #1 123
ROW ['Flat 1', ' 21 Other road']
    #1 1
    #2 21
ROW ['House', ' 23 Someother street']
    #2 23 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T05:49:39.273

以下代码可以完成您需要的一切。对于输出，只需索引元组并写出您想要的组件。每个结果有 6 个元素

```
#(flat str, flat #, street str, street #, street, street type)

a = """
123 Some Street
Flat 1, 21 Other road
House, Someother street
"""

import re
#flat gets a word, 0 or more spaces, 0 or more digits
flat    = "([a-z]+ *(\d+)*)"
#street gets 0 or more digits, 1 or more spaces, 1 or more words with a space consuming until it hits street, or road or drive
street  = "((\d+)* +([a-z]+ )+?(street|road|drive))"
address = "%s*.*?%s" % (flat,street)
m       = re.compile(r"%s" % address, re.I)
results = m.findall(a)
with('output.csv','w') as fout:
    #whatever you wish to name your columns
    fout.write("Building,Address,Suite Number, Building Number")
    for r in results:
        fout.write("%s,%s,%s,%s" % (r[0],r[2],r[1],r[3])) 
```

结果

```
[('', '', '123 Some Street', '123', 'Some ', 'Street'),
 ('Flat 1', '1', '21 Other road', '21', 'Other ', 'road'),
 ('House', '', ' Someother street', '', 'Someother ', 'street')] 
```

# c++ - 初始化模板类的静态模板化成员

> ID：14863628
> 
> 赞同：3
> 
> 时间：2013-02-13T21:37:37.093
> 
> 标签：c++, templates, static-members

我有以下代码片段，但它不起作用。dataMap 成员应该包含一个回调函数，该函数接受一个 T& 和 T 在适当的时间传递给回调。模板成员初始化失败（使用 g++ 4.7.2）：`error: need ‘typename’ before ‘MyClass<T>::DataMap’ because ‘MyClass<T>’ is a dependent scope`. 我尝试将 typename 粘贴在它所说的位置，但随后出现了不同的错误：`error: expected primary-expression before ‘;’ token`. 是否可以这样做，或者我是否需要从初始化中删除 typedef？我试着沿着那条路走，但它很快就变得难以辨认并且吐出了更多的错误。

```
template <typename T> class MyClass
{
public:
  typedef void(*CallbackType)(T&);
  typedef std::unordered_map<int, std::pair<T, CallbackType>/**/> DataMap;
  static DataMap dataMap;
  ...
};

template <typename T> MyClass<T>::DataMap MyClass<T>::dataMap = MyClass<T>::DataMap; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T21:41:14.323

编译器正确地建议您可能要包含`typename`关键字，因为*它*`DataMap`是. 静态成员定义应如下所示：*`MyClass<T>::DataMap`*

 *```
template <typename T>
typename MyClass<T>::DataMap MyClass<T>::dataMap; 
```

该成员将被默认构造，因此**无需复制初始化它**。因此，省略该`= MyClass<T>::DataMap`部分就足够了（这会给您带来麻烦，因为您忘记了`DataMap`复制初始化右侧之后的括号）：

```
// This is also valid (mind the parentheses to invoke the
// constructor of `DataMap`), but unnecessary.
template <typename T>
typename MyClass<T>::DataMap MyClass<T>::dataMap = MyClass<T>::DataMap(); 
```*

# android - Google TV 上的 32 位位图速度较慢。错误的像素格式？

> ID：14863629
> 
> 赞同：2
> 
> 时间：2013-02-13T21:37:38.663
> 
> 标签：android, google-tv

我想知道我在这里做错了什么。

我创建了一个尺寸为 1080x1080 的位图：

```
Bitmap level = Bitmap.createBitmap(1080, 1080, Config.ARGB_8888); 
```

然后我在其中画了一些线条和矩形并将其放在 SurfaceView 的画布上：

```
c.drawBitmap(LevelBitmap.level, 0, 0, null); 
```

这个操作在我的谷歌电视 NSZ-GS7 上需要 20 毫秒。很长。

将 surfaceCreated 中的 pixelformat 设置为 RGBX_8888 或 RGBA_8888 会使事情变得更糟，绘制需要 30 毫秒。

```
holder.setFormat(PixelFormat.RGBX_8888); 
```

设置为 RGB_888

```
holder.setFormat(PixelFormat.RGB_888); 
```

当我画东西时导致空指针异常

只有位图的 Config.RGB_565 和窗口的 PixelFormat.RGB_565 的组合才能在可接受的 10 毫秒内将位图绘制到画布上，但 RGB_565 的质量非常糟糕。

我错过了什么吗？Google TV 不能支持 32 位图形吗？它的“自然”像素和位图格式是什么？我在谷歌上错过了关于这个主题的任何文档吗？

这是我用来测量时间的请求的 onDraw 方法：

```
private static void doDraw(Canvas c) {

        if (LevelBitmap.level == null){
            LevelBitmap.createBitmap();
        }

        long time = System.currentTimeMillis();
        c.drawBitmap(LevelBitmap.level, 0, 0, null);
        Log.e("Timer:",""+(System.currentTimeMillis()-time) );
        if(true) return; 
```

这里是创建位图的类：

```
public final class LevelBitmap {

    public static Bitmap    level;

    public static void createBitmap() {
        level = Bitmap.createBitmap(GameViewThread.mCanvasHeight, GameViewThread.mCanvasHeight, Config.ARGB_8888);

        Canvas canvas = new Canvas(level);

        canvas.scale(GameViewThread.fieldScaleFactor, GameViewThread.fieldScaleFactor);
        canvas.translate(500, 500);

        // floor covering
        int plankWidth = 50;
        int plankSpace = 500;
        short size = TronStatics.FIELDSIZE;
        for (int i = plankSpace; i < size; i = i + plankSpace) {
            canvas.drawRect(i, 0, i + plankWidth, size, GameViewThread.bgGrey);
            canvas.drawRect(0, i, size, i + plankWidth, GameViewThread.bgGrey);
        }

        // draw field
        canvas.drawRect(-10, -10, TronStatics.FIELDSIZE + 10, TronStatics.FIELDSIZE + 10, GameViewThread.wallPaint);

    }

} 
```

# ruby-on-rails - 直接 SQL 查询中的问号

> ID：14863631
> 
> 赞同：0
> 
> 时间：2013-02-13T21:37:57.360
> 
> 标签：ruby-on-rails, postgresql, inner-join, rails-activerecord

对 ActiveRecord 产生低效或错误的 DELETE 查询感到失望，我正在寻找一种能够以安全的方式执行直接 SQL 查询的能力，没有 SQL 注入的可能性。

我知道 WHERE 子句有一个安全的变体：

```
MyObject.joins(:details)
.where('my_objects.my_value = ? and details.my_id = ?',
params[:value], params[:id]) 
```

的安全变体是否`execute`存在？就像是：

```
execute(<<eos
DELETE FROM my_objects
USING details
WHERE
  my_objects.details_id = details.id
  AND my_objects.my_value = ?
  AND details.my_id = ?
eos
, params[:value], params[:id]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T04:28:01.717

不幸的是，我认为没有更简单的方法可以利用连接。但至少有可重复使用的卫生助手。

请参阅`ActiveRecord::Base#sanitize_sql`（[文档](http://api.rubyonrails.org/classes/ActiveRecord/Sanitization/ClassMethods.html#method-i-sanitize_sql)）。

```
Model.send(:sanitize_sql, {:foo => "bar"}) 
```

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-02-14T00:45:49.090

你为什么不试试这个：

执行（<<-SQL

使用细节从 my_objects 中删除 my_objects.details_id = details.id AND my_objects.my_value = #{params[:value]} AND details.my_id = #{params[:id]}

SQL

# php - 执行 cURL 后的脚本不起作用。页面不断重新加载

> ID：14863632
> 
> 赞同：0
> 
> 时间：2013-02-13T21:38:01.937
> 
> 标签：php, javascript, post, curl, request

这些是我想要做的步骤：

1.  获取[http://www.skyscanner.es/](http://www.skyscanner.es/)的 HTML 代码，搜索航班。
2.  仅获取该 HTML 的一部分：具有价格的特定“跨度”。
3.  用它操作。

这是我所做的 PHP 代码：

```
 <?php
        $ch = curl_init();
        curl_setopt($ch, CURLOPT_URL, "http://www.skyscanner.es/");
        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt ($ch, CURLOPT_POST, 1);
        curl_setopt ($ch, CURLOPT_POSTFIELDS, "from=Bilbao (BIO)&to=Barcelona (BCN)&depdatetext=25/03/2013&sc_returnOrOneWay=2");
        $output = curl_exec($ch);
        curl_close($ch);
        echo $output;
    ?> 
```

但我得到一个像这样的奇怪字符串：

```
 ‹¥TkoÚ0ý^‰ÿpTi“ê&lt; t%<¤RuR»U+{}4ñ…X5qf›×Pÿûì$ZõÛ‚Äu¬sî=çú:ýÓë¯£Éï‡1¤f!àáû§»Ï#ðHül‚àzr ¿n'÷wù!<Åã/x©1yëõÚ_·}©æÁä[°qY"G«–DŸæ 'ý¢Êf!2=x#CÔívKb FÊ\\ ¡àÐÿ,ùjàdf03d²ÍÑƒ¤|x7&pì$)UÍ€kI®®:]yKe¸8¼;@àv2y€ª),520h’ Ö`R®!§s3i€ !×Èü~Pòm"m¶ÁXUÝDëBô)!“©dÛÝ‚ª9Ïâ°7³‰æ1ö?à¢|ÑÛø*F3z§ânQ¬ÐðÄîhši¢QñYoJ“§¹’ËŒÅÍqñôž'3Ž‚Y“»œ2Æ³yBÔÉ7…îÏ®zÏÐ8I£Ý¡~Ë¿°ja‰RÅÍ››—/m!£BêkähÚ§ÌÛ~nÐEýÐýö´0¬iMw¨¨vkÎLw/ÏêeoæÒ&iA^ôÌ3 §Ë$E÷Þ9Ô=<êØ‘3{uûHµß)gºYMÏî…[1—š.³X¡ †¯Ð¡ý M\¤<³FŽÏÆ•{mŒ™ÇWö0öÆ\{ÞÎNˆ  ­bµ¿nœ\d|œÙ›SôÐöÓhøˆÊÎ0Œ•’Ê2¢a?°°ct¥ÙM'›‰ Z×û/6á~¦úië?®Š%—IÚÃIŠ%h+—@‚òÉöfRAB3Gœ"0®sA·¶Àj+Í€g+*8ûH%ƒwµ”÷°¦ú Ç\ä¦ÒåÊ·¿Aí¨îK÷m-¾vñà-ú¡ 
```

所以，我连第一步都没跨过！

我试图以多种方式修复它，但我还不知道我做错了什么。我想这可以是：

*   要求因为我没有加多少成人、儿童...
*   CURLOPT_URL 必须是 www.skyscanner.es/search.html **，**因为表单在操作中。
*   不执行 POST 请求，直接执行 cURL 到[http://www.skyscanner.es/flights/bio/bcn/130325/airfares-from-bilbao-to-barcelona-in-march-2013.html 之类的 URL？ flt=1](http://www.skyscanner.es/flights/bio/bcn/130325/airfares-from-bilbao-to-barcelona-in-march-2013.html?flt=1)

请问有人可以帮我吗？

提前致谢！

**编辑**：我已经更改了标题，更接近我现在遇到的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:47:45.733

由于您收到以下消息，因此在正文中编码了什么消息并不重要：

`HTTP/1.1 405 Method Not Allowed`

这意味着你不能使用`POST`.

如果您阅读响应的所有标题，您会看到其中一个标题说：

```
Allow: GET, HEAD, OPTIONS, TRACE 
```

如果您要删除这两行：

```
curl_setopt ($ch, CURLOPT_POST, 1);
curl_setopt ($ch, CURLOPT_POSTFIELDS, "from=Bilbao (BIO)&to=Barcelona (BCN)"); 
```

并改变：

```
curl_setopt($ch, CURLOPT_URL, "http://www.skyscanner.es/"); 
```

进入：

```
curl_setopt($ch, CURLOPT_URL, "http://www.skyscanner.es/vuelos/bio/bcn/130325/tarifas-de-bilbao-a-barcelona-en-marzo-2013.html"); 
```

它会工作的。

签出以下代码：

```
<?php

    $accept = array(
        'type' => array('application/rss+xml', 'application/xml', 'application/rdf+xml', 'text/xml'),
        'charset' => array_diff(mb_list_encodings(), array('pass', 'auto', 'wchar', 'byte2be', 'byte2le', 'byte4be', 'byte4le', 'BASE64', 'UUENCODE', 'HTML-ENTITIES', 'Quoted-Printable', '7bit', '8bit'))
    );
    $header = array(
        'Accept: '.implode(', ', $accept['type']),
        'Accept-Charset: '.implode(', ', $accept['charset']),
    );
    $encoding = null;
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL, "http://www.skyscanner.es/vuelos/bio/bcn/130325/tarifas-de-bilbao-a-barcelona-en-marzo-2013.html?flt=1");
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
//    curl_setopt ($ch, CURLOPT_POST, 1);
//    curl_setopt ($ch, CURLOPT_POSTFIELDS, "from=Bilbao (BIO)&to=Barcelona (BCN)");
    curl_setopt($ch, CURLOPT_HEADER, true);
    curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
    $response = curl_exec($ch);
    curl_close($ch);        
    if (!$response) {
        // error fetching the response
    } else {
        echo $response;
    }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T17:57:13.100

I thought that it was using POST method because I get a page whithout prices.

Now I realize that the URL were relatives, so scrips were not loaded. I've add [base tag](https://stackoverflow.com/questions/8831801/curl-get-dataurl-with-absolute-url).

```
[code before]
$result = str_replace("<head>", "<head><base href=\"$skyScannerURL\" />", $response); 
```

Now it has styles and try to load something, but it enter in a bucle, the page is reloaded and the URL has a parameter increasing, it is: ?crty=107

The full code:

```
$accept = array(
    'type' => array('application/rss+xml', 'application/xml', 'application/rdf+xml', 'text/xml'),
    'charset' => array_diff(mb_list_encodings(), array('pass', 'auto', 'wchar', 'byte2be', 'byte2le', 'byte4be', 'byte4le', 'BASE64', 'UUENCODE', 'HTML-ENTITIES', 'Quoted-Printable', '7bit', '8bit'))
);
$header = array(
    'Accept: '.implode(', ', $accept['type']),
    'Accept-Charset: '.implode(', ', $accept['charset']),
);
$encoding = null;
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, "http://www.skyscanner.es/vuelos/bio/bcn/130325/tarifas-de-bilbao-a-barcelona-en-marzo-2013.html?flt=1");
//curl_setopt($ch, CURLOPT_URL, "http://www.skyscanner.es/flights/bio/bcn/130325/airfares-from-bilbao-to-barcelona-in-march-2013.html?flt=1");
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_HEADER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
$response = curl_exec($ch);
curl_close($ch);        
if (!$response) {
    // error fetching the response
} else {
    $skyScannerURL = 'http://www.skyscanner.es/';
    $result = str_replace("<head>", "<head><base href=\"$skyScannerURL\" />", $response);
    echo $result;
} 
```

You can see online [here: codepad.viper-7.com](http://codepad.viper-7.com/8ynyl8/55dev)

Obvious something is not working well. Thanks again everyone.

# google-dfp - 我是否必须在 DFP 中链接定位，或者它们可以是单独的行？

> ID：14863633
> 
> 赞同：0
> 
> 时间：2013-02-13T21:38:02.790
> 
> 标签：google-dfp

在 DFP 中，我有这样的事情：

```
googletag.pubads().setTargeting('age', ['35to44']).setTargeting('gender', ['female']); 
```

我是否必须链接这些`setTargeting`陈述，或者我可以做这样的事情：

```
googletag.pubads().setTargeting('age', ['35to44']);
googletag.pubads().setTargeting('gender', ['female']); 
```

对于我们试图做的一些程序化定位，后者更容易。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:16:00.663

你可以两者都做。

[请参阅此页面](http://support.google.com/dfp_premium/bin/answer.py?hl=en&answer=1638622)上的第一个示例。

我还在我的[jQuery DFP](https://github.com/coop182/jquery.dfp.js/blob/master/jquery.dfp.js#L153)插件中使用了非链接方法，它工作得非常好。

# c++ - 使用 decltype 编写复制和移动函数

> ID：14863636
> 
> 赞同：2
> 
> 时间：2013-02-13T21:38:07.357
> 
> 标签：c++, templates, c++11, move-semantics, decltype

我的代码有几个实例，其中函数在遇到 T&& 或 const T& 时的反应略有不同，但是函数本身很长（注意 T 只是某种对象类型）。例如：

```
void push_back(const T& newt){
    /* code block X */
    new (ptr) T(newt);
    /* code block Y */
}

void push_back(T&& newt){
    /* code block X */
    new (ptr) T(std::move(newt));
    /* code block Y */
} 
```

是否可以按照这个伪代码的行写一些东西：

```
template<typename S>
void push_back(S newt){
    /* code block X */
#if decltype(newt)==T&&
    new (ptr) T(std::move(newt));
#else
    new (ptr) T(newt);
#endif
    /* code block Y */
} 
```

还是有更好的方法来编写几乎相同的移动和复制功能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T21:43:48.837

[`std::forward()`](http://en.cppreference.com/w/cpp/utility/forward)在函数中使用`T&&`并丢弃`const T&`函数：

```
template <typename T>
void push_back(T&& newt){
    /* code block X */
    new (ptr) typename std::remove_reference<T>::type(std::forward<T>(newt));
    /* code block Y */
} 
```

`std::forward()`将`newt`完全按照传递给`push_back()`. 导致：

*   `T`如果`push_back()`传递了一个左值，则使用的复制构造函数，或
*   `T`如果`push_back()`传递了一个右值，则使用的移动构造函数。

[请参阅http://ideone.com/HjOrap](http://ideone.com/HjOrap)上的在线演示。

请注意，如果`push_back()`是独立函数或非模板类的成员函数，则这是正确的。如果它是模板类成员函数，则函数本身必须接受除了类模板类型之外的模板类型，因为此行为取决于`T`推导类型。

请参阅Scott Meyers 的[Universal References](http://isocpp.org/blog/2012/11/universal-references-in-c11-scott-meyers)。

# facebook - 尝试创建新应用程序，但使用移动代码验证时收到错误消息

> ID：14863639
> 
> 赞同：2
> 
> 时间：2013-02-13T21:38:12.013
> 
> 标签：facebook, mobile, verify

我正在尝试创建一个新应用程序，因此需要输入手机号码。但是当我提交国家代码和我的手机号码时，我一直收到同样的错误

* * *

> “抱歉，我们已经尝试发送多个代码，但似乎都失败了。请单击此处获取帮助。”

* * *

但是帮助页面没有为这个错误提供解决方案。

我能做些什么来解决这个问题？

# php - LedAds 广告脚本：统计信息未正确更新，全部停留在 1 次展示

> ID：14863641
> 
> 赞同：0
> 
> 时间：2013-02-13T21:38:15.683
> 
> 标签：php, mysql

我安装了旧的 LedAds php 脚本 ( [http://www.ledscripts.com/](http://www.ledscripts.com/) ) 以在我的网站上运行一个简单的广告轮播器，它们运行得非常好。由于谷歌搜索，我解决了一个阻止我登录到他们的代码问题......但是我找不到这个。

广告显示。点击有效。旋转器做它随机的事情。一切都很好。

但在幕后，统计数据显示每个广告有 1 次展示或点击，仅此而已。如果有点击，就没有印象。如果有印象，就没有点击。

数据库包含 pla_ads (aid, type, did, active, datetime), pla_images (with image URLs, link URLs, alt text, sizes), pla_richtext (for ad html that doesn't fit the nice, simple image+URL format) and pla_impressions（援助、影响、展示、点击）。最后一个显然是应该增长的。

该表是在脚本安装时构建的：

CREATE TABLE {prefix}_impressions (aid int(10) unsigned NOT NULL default '0', impdate date NOT NULL default '0000-00-00', 显示 bigint(20) unsigned NOT NULL default '0', 点击 int(11 ) NOT NULL 默认 '0', PRIMARY KEY (aid,impdate) ) TYPE=MyISAM;

做生意的php在这里（为简单起见保存为文本）：[http ://www.oddjotter.com/ad_class.txt](http://www.oddjotter.com/ad_class.txt)

我手动编辑了印象表中的一个值，以使一个广告的印象变旧（前一天）。在几次网站访问之后，我点击了那个广告——它现在在统计数据中显示 2 次展示，但今天不再计算任何展示次数。

如果有人能明白为什么代码每天只记录一次点击（或点击），我将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T13:07:01.373

问题在于这个表达式：**where (impdate = now()) 和 (aid = $key)**。造成麻烦的是 now() 函数。将其更改为**date(now())**（出现两到三个），它工作正常。

# performance - R嵌套循环慢

> ID：14863645
> 
> 赞同：4
> 
> 时间：2013-02-13T21:38:39.237
> 
> 标签：performance, r

我不知道为什么这样的事情应该很慢：

```
steps=500
samples=100000
s_0=2.1
r=.02
sigma=.2
k=1.9

at<-matrix(nrow=(steps+1),ncol=samples)
at[1,]=s_0

for(j in 1:samples)
{
  for(i in 2:(steps+1))
  {
    at[i,j]=at[(i-1),j] + sigma*sqrt(.0008)*rnorm(1)
  }
} 
```

我尝试使用 sapply 重写它，但从性能的角度来看它仍然很糟糕。

我在这里错过了什么吗？这将是 c++ 甚至是臃肿的 c# 中的秒数。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:49:29.257

R 可以向量化某些操作。在您的情况下，您可以通过进行以下更改来摆脱外循环。

```
for(i in 2:(steps + 1))
{
    at[i,] = at[(i - 1),] + sigma * sqrt(.0008) * rnorm(samples)
} 
```

按`system.time`原版计算`samples = 1000`耗时6.83s，修改后耗时0.09s。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T21:56:52.753

怎么样：

```
at <- s_0 + t(apply(matrix(rnorm(samples*(steps+1),sd=sigma*sqrt(8e-4)),
                   ncol=samples),
                    2,
                    cumsum)) 
```

（还没有仔细测试过，但我认为它应该是正确的，而且速度更快。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-14T00:51:10.163

要编写快速的 R 代码，您确实需要重新考虑如何编写函数。您想要对整个向量进行操作，而不仅仅是一次观察单个观察值。

如果您真的不喜欢编写 C 风格的循环，您也可以尝试 Rcpp。如果您非常习惯于 C++ 并且更喜欢以这种方式编写函数，那么可能会很方便。

```
library(Rcpp)
do_stuff <- cppFunction('NumericMatrix do_stuff(
  int steps,
  int samples,
  double s_0,
  double r,
  double sigma,
  double k ) {

  // Ensure RNG scope set
  RNGScope scope;

  // allocate the output matrix
  NumericMatrix at( steps+1, samples );

  // fill the first row
  for( int i=0; i < at.ncol(); i++ ) {
    at(0, i) = s_0;
  }

  // loop over the matrix and do stuff
  for( int j=0; j < samples; j++ ) {
    for( int i=1; i < steps+1; i++ ) {
      at(i, j) = at(i-1, j) + sigma * sqrt(0.0008) * R::rnorm(0, 1);
    }
  }

  return at;

}')

system.time( out <- do_stuff(500, 100000, 2.1, 0.02, 0.2, 1.9) ) 
```

给我

```
 user  system elapsed 
  3.205   0.092   3.297 
```

因此，如果您已经具备一些 C++ 背景，请考虑学习如何使用 Rcpp 将数据映射到 R 或从 R 映射数据。

# windows - 使用“Windows 正在检查...的解决方案”来报告错误或向用户提供帮助/更新？

> ID：14863648
> 
> 赞同：2
> 
> 时间：2013-02-13T21:38:44.343
> 
> 标签：windows, bug-tracking, crash

每个人以前都见过这个窗口。它显示在未处理的异常或其他情况下，例如应用程序挂起：

![在此处输入图像描述](../Images/c3b54830c885a5f4f92591636296344d.png)

首先，它是做什么的？（它对我从来没有用过）

其次，作为开发人员，我可以以任何方式使用它吗？我想知道，我是否可以在 microsoft 注册，然后查看通过此对话框发送的所有错误报告。因为这个窗口承诺会找到解决方案：我真的可以为我的用户提供解决方案吗？喜欢将他们推荐给网页或提供更新？

我从 android appstore 知道，如果用户发送它们，我可以看到我的应用程序的错误报告。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:55:27.403

是的，可以注册[Windows 错误报告](http://msdn.microsoft.com/en-us/library/windows/hardware/gg487440.aspx)。

# jquery - Jquery - 添加两个带小数点的数字会给出错误的总数

> ID：14863655
> 
> 赞同：1
> 
> 时间：2013-02-13T21:39:10.633
> 
> 标签：jquery

我在文本框上的更改事件上有以下 Jquery 函数

```
 $('input:text[id$=txtText1]').change(GetTotal); 
```

这会调用 GetTotal 函数

```
 function GetTotal() {

            var value1 = txtText1.val();
            var value2 = txtText2.val();
                 var sum = add(value1, value2)

                 $('input:text[id$=txtSubTotals]').val(sum);
} 
```

这是添加功能

```
 function add() {
            var sum = 0;
            for (var i = 0, j = arguments.length; i < j; i++) {
                if (IsNumeric(arguments[i])) {
                    sum += parseFloat(arguments[i]);
                }
            }
            return sum;
        } 
```

在文本框 1 中，值为 1.45，在文本框 2 中，值为 1.44 而不是 2.89。我得到以下值 2.8899999999999997

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:41:31.640

欢迎来到浮点数学的世界（互联网上有很多关于此的文章，但这就是 javascript 和其他语言中浮点数学类型的工作方式）。您可以在许多文章中阅读有关浮点问题的信息。这是[一个](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)。问题是一些正常的十进制值不能以浮点格式精确表示，所以你会得到你所期望的微小错误。

一般来说，如果您在原始数字中没有使用大量小数点，那么将您的值向下舍入到较小的小数点数将消除差异。

例如，如果你想确保得到 2.89，那么你可以将你的值四舍五入到一定数量的小数点，你就会得到想要的答案。

您可能希望更改将其放入总字段的方式，如下所示：

```
$('input:text[id$=txtSubTotals]').val(sum.toFixed(2)); 
```

或者，您甚至可以使用类似`6`in的值，`sum.toFixed(6)`它仍然可以解决您的问题。

如果您真的想要完美的精度（例如非常重要的财务计算），那么有些库不使用浮点来进行准确的财务数学计算，或者您实际上可以转换为整数美分并将所有数学运算作为美分进行把小数点放回最后。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:43:00.653

您可以使用 JavaScript`toFixed()`方法。

[http://www.w3schools.com/jsref/jsref_tofixed.asp](http://www.w3schools.com/jsref/jsref_tofixed.asp)

# python - Paramiko 不执行命令或 shell - Python

> ID：14863659
> 
> 赞同：1
> 
> 时间：2013-02-13T21:39:31.170
> 
> 标签：python, ssh

我正在使用[Paramiko](http://www.lag.net/paramiko/)库`ssh`在两台服务器之间运行命令。我的`"Master"`服务器是一个`Fedora 18`盒子，我`"Slave"`的是一`Windows 7`台机器。为了在机器上运行`ssh`服务器`Windows 7`，我安装了[FreeSSHd](http://www.freesshd.com/)。配置后`freesshd`我可以`ssh`从 Fedora 18 机器进入 Windows 机器并执行类似的命令`dir`。但是，当我尝试这样做时`Paramiko`，我没有同样的运气：

```
import paramiko
import os
import errno

"""
written by Philippe Ribeiro

class Connection
stabilishes the ssh connection between two servers
allowing the executing of commands remotely
"""
class Connection:

    def __init__( self, hostname, username, password):
        """Create a ssh client using the paramiko library
        """
        self.host = hostname
        self.user = username
        self.password = password
        self.port = 23
        self.sshclient = paramiko.SSHClient()
        self.username = username
        self.password = password

        try:        
            self.sshclient.load_system_host_keys()
            self.sshclient.set_missing_host_key_policy( paramiko.AutoAddPolicy() )

            self.sshclient.connect( hostname=self.host, port=self.port, 
                    username=self.username, password=self.password )

            self.sftpclient = self.sshclient.open_sftp()

        except SSHException, e:
            print e

        except AuthenticationException, e:
            print e

        except BadHostKeyException, e:
            print e

    def close(self):
        """Closes a client using the Connection class' API
        """
        self.sshclient.close()
        return

    def remove_directory(self, path):
        """Remove remote directory that may contain files
        It does not support directories that contain subdiretories
        """
        if self.exists(path):
            for filename in self.sftpclient.listdir(path):
                filepath = os.path.join(path, filename)
                self.sfptclient.remove(filepath)
            self.sftpclient.rmdir(path)

        return

    def exists(self, path):
        """Return True if the remote path exists
        """
        try:
            self.sfptclient.stat(path)

        except IOError, e:
            if e.errno == errno.ENOENT:
                return False
                raise
            else:
                return True

    def put_directory(self, localdir, remotedir):
        """Put a directory of files on the remote server
        Create the remote directory if it does not exist
        Does not support directories that contain subdirectories
        Return the number of files transferred
        """
        if not self.exists(remotedir):
             self.sftp.client.mkdir(remotedir)
        count = 0
        for filename in os.listdir(localdir):
             self.sftpclient.put(
                  os.path.join(localdir, filename),
                  os.path.join(remotedir, filename)
             )
             count += 1
        return count

"""
Just for testing purposes
try to connect to a Windows machine from a Unix one
so it can execute commands remotely
"""
cmd  = ["cd ..", "dir" ]
client = Connection("hostname", "username", "password")

try:
    for c in cmd:
            stdin, stdout, stderr = client.sshclient.exec_command(c)
            print stdout.readlines()

except SSHException, e:
    print e

client.close() 
```

但是当我执行时：

```
python client.py 
```

我得到：

```
['Unable to execute command or shell on remote system: Failed to Execute process.\r\n']
['Unable to execute command or shell on remote system: Failed to Execute process.\r\n'] 
```

有人可以告诉我为什么不工作吗？我错过了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T03:13:57.403

替换`cmd = ["cd ..", "dir" ]`为`cmd = ['cmd.exe /c "cd C:\ && dir"' ]`

# iphone - 重置 iPhone 应用程序

> ID：14863673
> 
> 赞同：1
> 
> 时间：2013-02-13T21:39:59.240
> 
> 标签：iphone, ios, xcode

我有一个当前名为“xxxx”的应用程序。该应用程序运行良好，没有任何问题。然而，我遇到了一个绊脚石。当我尝试将应用程序加载到我的 iPhone 上时，我的选择器视图上的图片似乎由于某种奇怪的原因而消失了。我已经进行了多个小时的调试，一切正常。然后我决定将产品名称从“xxxx”更改为“xxxx Redo”。一旦我这样做了，应用程序就完全正常地加载了（应该是 Picker View 中的图片）。

总之，它发现在它的编程方面没有实际的错误。但是，我的问题是为什么它没有以正确的方式加载原始产品名称，但在更改产品名称时加载正确的方式？

我的问题的第二部分是，是否有人知道修复原始应用程序的方法，以便它以原始名称再次正确显示？

我尝试了以下方法：

*   清理应用程序
*   删除 .app 文件并重建
*   删除 iPhone 上的应用程序并重建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:17:01.217

这些事情有时会发生，您可以尝试以下额外步骤：

*   在 XCode 中清理构建文件夹（单击产品菜单时按 alt）
*   重启手机（关机/开机）

我见过它有所作为的案例。

# android - 无法在 Android 中设置片段的 id

> ID：14863676
> 
> 赞同：1
> 
> 时间：2013-02-13T21:39:59.917
> 
> 标签：android, layout, fragment

我在尝试在 XML 中为我的 Fragments 提供一个 id 时遇到问题，但是我似乎无法做到这一点。我尝试了以下教程，但 id 似乎没有设置为片段。我正在使用提供的滑动 + 部分模板。这是我的主要活动的 xml：

```
<android.support.v4.view.ViewPager
    xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/pager"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    tools:context=".MainActivity" >

<!--
This title strip will display the currently visible page title, as well as the page
titles for adjacent pages.

-->

<android.support.v4.view.PagerTitleStrip
    android:id="@+id/pager_title_strip"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_gravity="top"
    android:background="#33b5e5"
    android:paddingBottom="4dp"
    android:paddingTop="4dp"
    android:textColor="#fff" />

<Fragment
    android:id="@+id/account_information_fragment"
    android:name="com.example.AccountInformationFragment"
    android:layout_width="match_parent"
    android:layout_height="match_parent" />

</android.support.v4.view.ViewPager> 
```

然后在我的片段类中，我使用它来设置布局：

```
final View view = inflater.inflate(R.layout.account_information_layout, container, false); 
```

而且该布局不包含任何标签。任何帮助将非常感激

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T01:29:02.507

我想我找到了问题所在。首先，片段标签需要以小写 F 开头，如下所示：

好的：

```
<fragment> 
```

坏的：

```
<Fragment> 
```

其次，恐怕我忘记了 Toast 在尝试显示任何非字符串时会返回 false。你将不得不使用

```
String.valueOf(fragment.getId()); 
```

为了让它在吐司中显示。

我不知道为什么一开始这不起作用，因为我相信我之前为标签尝试了 f 和 F 。设置一个 android:tag 帮助我调试它，因为它自然地返回一个字符串。

# javascript - EmberController 的 content 属性应该在修改之前设置

> ID：14863680
> 
> 赞同：0
> 
> 时间：2013-02-13T21:40:05.423
> 
> 标签：javascript, coffeescript, ember.js

这里有什么问题？

> 未捕获的错误：断言失败：应在修改之前设置 App.ContactController 的内容属性

```
App.ContactController = Ember.ArrayController.extend

  content: []

  newContact: ->
    contact = App.ContactModel.create
      firstName: "john"
      lastName: "doe"
    @.pushObject contact 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:04:17.983

放在`this.set('content', []);`您的上方`pushObject`，它会正常工作。我不太明白为什么这是一个要求，但它似乎在 pre 4 中。也许在下一个版本中他们也会考虑`pushObject` *设置*它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T00:04:23.920

看起来像是 CoffeeScript 语法问题；尝试删除点：`@pushObject contact`

# python - 从 Python 脚本将数据插入 MySQL 表

> ID：14863692
> 
> 赞同：13
> 
> 时间：2013-02-13T21:41:05.070
> 
> 标签：python, mysql

我有一个名为 TBLTEST 的 MySQL 表，其中包含两列 ID 和 qSQL。每个 qSQL 中都有 SQL 查询。

我有另一张表 FACTRESTTBL。

表 TBLTEST 中有 10 行。

例如，在 TBLTEST 上，让 id =4 和 qSQL ="select id, city, state from ABC"。

如何使用 python 从 TBLEST 插入 FACTRESTTBL，可能正在使用字典？

谢谢！

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-02-13T23:21:50.373

您可以将[MySQLdb 用于 Python](http://www.tutorialspoint.com/python/python_database_access.htm)。

示例代码（您需要调试它，因为我无法在这里运行它）：

```
#!/usr/bin/python

import MySQLdb

# Open database connection
db = MySQLdb.connect("localhost","testuser","test123","TESTDB" )

# prepare a cursor object using cursor() method
cursor = db.cursor()

# Select qSQL with id=4.
cursor.execute("SELECT qSQL FROM TBLTEST WHERE id = 4")

# Fetch a single row using fetchone() method.
results = cursor.fetchone()

qSQL = results[0]

cursor.execute(qSQL)

# Fetch all the rows in a list of lists.
qSQLresults = cursor.fetchall()
for row in qSQLresults:
    id = row[0]
    city = row[1]

    #SQL query to INSERT a record into the table FACTRESTTBL.
    cursor.execute('''INSERT into FACTRESTTBL (id, city)
                  values (%s, %s)''',
                  (id, city))

    # Commit your changes in the database
    db.commit()

# disconnect from server
db.close() 
```

# opengl - opengl固定功能使用gpu还是cpu？

> ID：14863707
> 
> 赞同：0
> 
> 时间：2013-02-13T21:41:51.740
> 
> 标签：opengl, ubuntu-12.04, ubuntu-10.04

我有一个代码，它基本上使用 opengl 固定 func 管道绘制平行坐标。该坐标有 7 个轴并绘制 64k 条线。所以输出很混乱，但是当我在具有英特尔 i5 proc、8gb ddr3 ram 的笔记本电脑上运行代码时，它运行良好。我的一个朋友在两个不同的系统中运行相同的代码，这两个系统都有英特尔 i7 和 8gb ddr3 ram 以及一个 nvidia gpu。在这些系统中，代码以快门运行，有时鼠标指针变得无响应。如果你们能给出一些想法为什么会发生这种情况，那将有很大的帮助。最初我认为它在这些系统中运行得更快，因为它们有一个专用的 gpu。我自己的笔记本电脑有 ubuntu 12.04，其他两个系统都有 ubuntu 10.x。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:01:40.410

也许我误解了你，但我走了。

有诸如 glBegin、glEnd 之类的 API 调用，它们向 GPU 发出命令，因此它们使用 GPU 马力，尽管也有对数组的调用，其他与 API 无关的函数 - 它们使用 CPU。现在，通过将数据保存在缓冲区（glGenBuffers 等）中，然后在 onDraw 循环中使用这些缓冲区（VBO/IBO），在 OpenGL 的 onDraw 循环之外预加载模型是一个很好的做法。

如果管理得当，它可以减少 GPU/CPU 的负载。希望这可以帮助。

奥列格

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:03:51.150

固定功能管道是使用现代 opengl 驱动程序中的 gpu 可编程特性实现的。这意味着大部分工作由 GPU 完成。固定功能 opengl 不应该比使用 glsl 来做同样的事情慢，但真的很不灵活。

坐标轴和 7 轴是什么意思？你有你的应用程序的屏幕截图吗？

鼠标口吃听起来像是在给显示驱动程序增加负担。这听起来像您进行了太多的 opengl 调用。您是否使用即时模式（glBegin glVertex ...）？某些 OpenGL 驱动程序可能没有立即模式的最佳实现。您应该为数据使用顶点缓冲区对象。

# wordpress - Wordpress 解析错误意外 T_ENCAPSED_AND_WHITESPACE，需要 T_STRING 或 T_VARIABLE 或 T_NUM_STRING

> ID：14863710
> 
> 赞同：0
> 
> 时间：2013-02-13T21:42:11.907
> 
> 标签：wordpress

伙计们，两天前，我管理的一个网站的虚拟主机出现了故障。现在它似乎恢复了工作，但是当我尝试访问 wp-admin 时，我收到以下错误消息：

```
Parse error: syntax error, unexpected T_ENCAPSED_AND_WHITESPACE, 
expecting T_STRING or T_VARIABLE or T_NUM_STRING in 
/home/ohmycut/public_html/wp-settings.php on line 80 
```

这些是从 75 到 85 的行：

```
// Include the wpdb class and, if present, a db.php database drop-in.
require_wp_db();

// Set the database table prefix and the format specifiers for database table columns.
$GLOBALS['table_prefix'] = $table_prefix;
wp_set_wpdb_vars();

// Start the WordPress object cache, or an external object cache if the drop-in is present.
wp_start_object_cache(); 
```

老实说，我不明白为什么会出现此错误。有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:01:55.420

尝试联系网络托管服务，看看他们是否可以将其恢复到服务关闭之前的状态。

# webrtc - 有没有办法在 webRTC 中发送两个音频流而不是视频和音频流？

> ID：14863712
> 
> 赞同：0
> 
> 时间：2013-02-13T21:42:21.773
> 
> 标签：webrtc

我只关心音频，我想发送两个音频流以在接收方同步。

现在，对于音频和视频，可以通过以下方式获取本地流

```
getUserMedia({'audio':true, 'video':constraints}, onUserMediaSuccess,
               onUserMediaError); 
```

假设我有两个麦克风，我如何访问两个音频流，并进一步在接收器上同步它们？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T01:15:40.990

我认为[很快就会有可能](http://lists.w3.org/Archives/Public/public-media-capture/2013Feb/0016.html)。

```
var audio1 = new AudioStreamTrack(constraints1);
var audio2 = new AudioStreamTrack(constraints2);
var stream = new MediaStream([audio1, audio2]);
navigator.getUserMedia(stream, successCb, errorCb); 
```

您将能够同时跟踪音频/视频流并将它们组合成一个流。

# windows - 交叉编译 ICU for Windows 时导出符号时出错。

> ID：14863713
> 
> 赞同：1
> 
> 时间：2013-02-13T21:42:24.240
> 
> 标签：windows, cross-compiling, icu

我正在尝试使用 Mingw-w64 的 32 位编译器（`i686-w64-mingw32`工具链）来交叉编译 Windows 的 ICU 库。主机是 Ubuntu 12.10 64 位。

我采取的步骤如下所示：

1.  [从这里](http://download.icu-project.org/files/icu4c/50.1.2/icu4c-50_1_2-src.tgz)获取最新的源代码存档并提取它。

2.  制作两份`source/`目录副本 - 一份用于主机，一份用于目标。

3.  对于主机构建：

    ```
    。/配置 ; 制作
    ```

4.  对于目标构建：

    ```
    ./configure --host=i686-w64-mingw32 --with-cross-build= <host_source_dir>
    ```

    ...`<host_source_dir>`上一步的目录在哪里。

5.  当我`make`在目标源目录中运行时，编译会继续进行几分钟而没有任何错误，然后抛出此错误：

    ```
    i686-w64-mingw32-g++ -O2 -W -Wall -pedantic -Wpointer-arith -Wwrite-strings
    -Wno-long-long -mthreads -o ../../bin/uconv.exe uconv.o uwmsg.o
    -L../../lib -licuin50 -L../../lib -licuuc50 -L../../stubdata -licudt50
    -lm uconvmsg/uconvmsg.a
    uconv.o:uconv.cpp:(.text+0x2f): 未定义引用`_uconvmsg_dat'
    ```

什么可能导致此错误？我备份了几行，也注意到了这一点：

```
pkgdata：i686-w64-mingw32-gcc -O2 -Wall -std=c99 -pedantic -Wshadow
  -Wpointer-arith -Wmissing-prototypes -Wwrite-strings -mthreads -shared
  -Wl,-Bsymbolic -Wl,--enable-auto-import -Wl,--out-implib=./all.lib -o
  ../lib/icudt50.dll ./out/tmp/icudt50l_dat.o
无法导出 icudt50_dat：找不到符号
collect2: ld 返回 1 个退出状态
-- 返回状态 = 256
生成库文件时出错。失败的命令：i686-w64-mingw32-gcc -O2 -Wall
  -std=c99 -pedantic -Wshadow -Wpointer-arith -Wmissing-prototypes
  -Wwrite-strings -mthreads -shared -Wl,-Bsymbolic -Wl,--enable-auto-import
  -Wl,--out-implib=./all.lib -o ../lib/icudt50.dll ./out/tmp/icudt50l_dat.o   
为数据生成汇编代码时出错。
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:14:36.040

为了调试您的符号问题，只需提供`-Wl,--trace-symbol=_uconvmsg_dat`如下`i686-w64-mingw32-g++`标志：

`i686-w64-mingw32-g++ -O2 -W -Wall -pedantic -Wpointer-arith -Wwrite-strings -Wno-long-long -mthreads -o ../../bin/uconv.exe uconv.o uwmsg.o -L../../lib -licuin50 -L../../lib -licuuc50 -L../../stubdata -licudt50 -lm uconvmsg/uconvmsg.a -Wl,--trace-symbol=_uconvmsg_dat`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T06:57:28.130

所以事实证明问题确实出在ICU源代码上。我不确定我是否完全理解问题所在，但幸运的是其他人做了并编写了三个补丁。

前两个适用于我上面的问题：

*   [icu4c-50_1_2-crossbuild.patch](https://build.opensuse.org/package/view_file?file=icu4c-50_1_2-crossbuild.patch&package=mingw64-icu&project=windows%3Amingw%3Awin64)
*   [icu4c-4_6_1-win32.patch](https://build.opensuse.org/package/view_file?expand=1&file=icu4c-4_6_1-win32.patch&package=mingw32-icu&project=windows%3Amingw%3Awin32)

在为 x86_64 架构构建时，使用第三个补丁而不是上面列表中的第二个：

*   [icu4c-4_6_1-win64.patch](https://build.opensuse.org/package/view_file?file=icu4c-4_6_1-win64.patch&package=mingw64-icu&project=windows%3Amingw%3Awin64&rev=998ad2e0495d85cc55b308eb4cc1bdd8)

运行时似乎仍然存在问题`make install`，但至少源树似乎现在构建。

# ruby - FileUtils.mv 抛出 Invalid char \302 和 \255 异常

> ID：14863720
> 
> 赞同：4
> 
> 时间：2013-02-13T21:42:38.553
> 
> 标签：ruby

当我在命令行中或从命令行运行以下代码时，`CodeRunner`出现以下错误；

```
Untitled.rb:25: Invalid char '\302' in expression
Untitled.rb:25: Invalid char '\255' in expression 
```

第 25 行对应于`FileUtils.mv`方法所在的行。

```
if the_file.include? "Screen Shot"
    old_file = Shellwords.escape(homepath + "/Desktop/" + the_file)
    new_file = Shellwords.escape(screen_shot_folder + "/" + the_file)

    FileUtils.­mv old_file, new_file
end 
```

最初我认为我的输入（或者`old_file`或`new_file`）有问题，这就是我将它们包装进去的原因，`Shellwords.escape`我还检查了`old_file`和的内容`new_file`是否正确。

如果我打电话`puts old_file + " ++ " + new_file`，我会得到如下信息；

```
/Users/tobyosbourn/Desktop/Screen\ Shot\ 2013-02-04\ at\ 10.49.14\ \(2\).png ++ /Users/tobyosbourn/Desktop/Screenshots/Screen\ Shot\ 2013-02-04\ at\ 10.49.14\ \(2\).png 
```

看起来很正确，但是如果我将它们作为字符串复制并粘贴到 FileUtils.mv 中，我会收到相同的错误消息。

我已经[阅读了 FileUtils 的使用方式](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/fileutils/rdoc/FileUtils.html#method-c-mv)，但看不到我做错了什么，有人可以建议吗？

如果它有助于我的 Ruby 版本是`1.8.7`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T21:46:06.137

您的源代码中有一个*不可见的非 ASCII 字符*，可能是通过从某处的网站上复制和粘贴代码添加的。

具体来说，您的代码中有一个流氓软连字符，编码为 UTF-8（软连字符 = UTF-8 中的 C2 AD，或八进制转义符号中的 \302\255）。

最好的办法是在你的文本编辑器中“显示不可见”，看看你是否能找到一个与其他空间不同的空间。

**编辑**`FileUtils.`将您的片段粘贴到我的文本编辑器中会在（`.`和之间）之后显示一个软连字符`mv`。如果看不到字符，请删除`FileUtils.mv`并重新键入以摆脱字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-08-19T19:23:00.777

另一种去除复制粘贴文本中不可见字符的方法是首先将其复制到原始文本编辑器，例如 Windows 中的记事本或 Linux 中的 Nano，它会自动删除大部分不需要的内容，编辑掉剩余的可疑内容字符，然后从那里粘贴。例如，如果我将您的 FileUtils.mv 粘贴到记事本中，我会得到 FileUtils.¬mv

# psycopg2 - 由于加载库失败导致 psycopg2 导入错误

> ID：14863723
> 
> 赞同：0
> 
> 时间：2013-02-13T21:42:44.160
> 
> 标签：psycopg2

在使用一键式安装程序安装 PostgreSQL 后，我尝试了多种安装 psycopg2 的方法，但无论如何我尝试在 python 中遇到相同的导入错误：ImportError: dlopen(/Library/Python/2.5/site-packages/psycopg2/ _psycopg.so，2)：库未加载：libpq.5.dylib 引用自：/Library/Python/2.5/site-packages/psycopg2/_psycopg.so 原因：找不到图像

我在 Mac OS X 10.5.8 上。我正在使用 Python 2.5。我从安装程序安装了 PostgreSQL（我没有移植它），它安装在 /Library 中）。我将 /Library/PostgreSQL/9.1/bin 添加到源 psycopg2 的 setup.cfg 中，按照安装文件和 Internet 上的任何地方的说明，然后运行 ​​sudo python setup.py build，然后运行 ​​sudo python setup.py install。我还尝试将 /Library/PostgreSQL/9.1/bin 导出到我的路径并运行 sudo pip install psycopg2。但是在所有这些场景中都发生了完全相同的问题。我将非常感谢一些帮助。

最佳马里昂

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T09:15:51.767

问题是在运行时找不到 libpq.5.dylib 文件，因为它不在动态（运行时）链接器搜索的默认位置之一。尝试在启动 python 之前定义环境变量 DYLD_LIBRARY_PATH。我不是 MacOS X 专家，但类似：

```
export DYLD_LIBRARY_PATH=/Library/PostgreSQL/9.1/lib 
```

可能会工作。

# version-control - 如何使用 CVS 的 commitid 功能？

> ID：14863724
> 
> 赞同：1
> 
> 时间：2013-02-13T21:42:47.430
> 
> 标签：version-control, cvs

我注意到较新版本的 CVS 使用 commitids。

我想这是最近添加的 - 因为“回到过去”并没有这样的事情。

谷歌搜索我发现大多数与 CVSNT 相关的评论 - 但似乎 commitids 也存在于标准开源 CVS 中。

如何利用 commitid 功能（在标准 CVS 中）？

例如：

*   如何显示提交ID之间的差异？
*   如何列出与某个 commitid 关联的文件/版本号？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:32:03.347

除了设置它之外，CVS 本身似乎没有任何东西可以对 commitid 做任何事情。

这是文档所说的（`info cvs`）：

> 在`commit`，一个唯一的 commitid 被放置在存储库内的 RCS 文件中。一次提交的所有文件都获得相同的 commitid，这是一个仅由十六进制数字组成的字符串（在 GNU CVS 中通常为 16，在 MirBSD 和 MirDebian GNU CVS 中通常为 19）。FSF GNU CVS 1.11、MirOS GNU CVS 1.11 和 OpenBSD OpenCVS 还不支持 commitid。可以使用`log`and`status`命令检索 commitid；请参阅 *note log:: 和 *note File status::。

其他工具可以解析输出`cvs log`并确定给定提交的 commitid。特别是，在单个`cvs commit`命令中提交的更改将具有相同的 commitid。我可以想象这对于将 CVS 存储库转换为其他系统（如 SVN 或 Git）的工具很有用。

但此类工具必须允许由不具备此功能的旧版本 CVS 创建的存储库。例如，我在 CVS 中维护的一个文件有 211 个提交，其中前 186 个没有提交 ID；显然那是我切换到更新版本的 CVS（2007 年末或 2008 年初）的时候。

一起提交的更改也应该共享相同的时间戳，尽管这不太可靠。将时间戳与作者结合起来应该更可靠一些，但仍然不完美。

# android - 使用 Apache Commons Net 登录 SMTP 服务器

> ID：14863730
> 
> 赞同：1
> 
> 时间：2013-02-13T21:43:04.813
> 
> 标签：android, smtp, apache-commons-net

我正在尝试开发一个 Android 应用程序，该应用程序从用户那里获取用户名和密码，并根据电子邮件服务器检查他/她的凭据。我只需要将用户名和密码组合发送到电子邮件服务器，如果服务器接受，那么我的应用程序将认为用户已通过身份验证。

我尝试使用 Javamail，但显然它与 dalvik 无法相处。有人建议我尝试使用 Apache Commons，但我不知道如何让它做我需要的事情。

如果有人有任何想法，我非常感谢您的帮助！

顺便说一下，我要连接的服务器使用 IMAP/SMTP。

更新：这是我用来进行连接的代码

```
client = new AuthenticatingSMTPClient();
client.addProtocolCommandListener(new PrintCommandListener(new PrintWriter(System.out), true));
client.connect(HOST, PORT);
client.login();
client.execTLS();
client.auth(AuthenticatingSMTPClient.AUTH_METHOD.PLAIN,user,pword); 
```

服务器回复是：

```
220 pod51000.outlook.com Microsoft ESMTP MAIL Service ready at Thu, 14 Feb 2013    18:52:33 +0000
HELO 10.71.12.99
250 pod51000.outlook.com Hello [66.76.192.214]
STARTTLS
220 2.0.0 SMTP server ready
AUTH PLAIN
503 5.5.2 Send hello first 
```

我以前从来没有做过这样的事情，所以我只需要一些指导，比如如何发送“Hello”、服务器还期望什么等。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-15T05:45:35.440

解决了！在身份验证之前添加了一个 client.helo() 并且它工作得很好

# mysql - 普通列后跟聚合函数，但不在 group by

> ID：14863731
> 
> 赞同：3
> 
> 时间：2013-02-13T21:43:15.370
> 
> 标签：mysql, sql, group-by, aggregate-functions

`Group By`我知道只有在包含它们的情况下才允许使用聚合函数后跟的普通列。
但是为什么以下工作？

```
mysql> select payee,sum(amount) from checks;  
+---------+-------------+  
| payee   | sum(amount) |  
+---------+-------------+  
| Ma Bell |      893.76 |  
+---------+-------------+  
1 row in set (0.00 sec) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-13T21:55:25.440

[这种行为是对 MySql 的“扩展”](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)：

> MySQL 扩展了 的使用，`GROUP BY`以便选择列表可以引用未在`GROUP BY`子句中命名的非聚合列。

但是，[此行为实际上是 MySql 中的可配置设置](http://dev.mysql.com/doc/refman/5.1/en/server-sql-mode.html#sqlmode_only_full_group_by)：

> `ONLY_FULL_GROUP_BY`
> 
> 不允许选择列表或（自 MySQL 5.1.10 起）HAVING 列表引用未在 GROUP BY 子句中命名的非聚合列的查询。

It is best to *respect* the `group by` and add all non-aggregated columns, especially if there's the possibility that you might someday migrate to a server that has `ONLY_FULL_GROUP_BY` turned on.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T21:48:22.377

**编辑**手册参考，它比我解释得更好，并注意细节：[http ://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)

这是为了正常工作。如果没有聚合函数，它会对查询中返回的所有行执行此操作。我认为您对此几乎看不到的原因是，这很少是您真正想要完成的事情。当您有一个 where 子句时，您经常放弃 group by，您知道该子句只会返回您计划分组的内容。即，如果您查询的是：

```
select payee,sum(amount) from checks where payee = 'Ma Bell' 
```

下面的 group by 在技术上是多余的：

```
select payee,sum(amount) from checks where payee = 'Ma Bell' group by payee 
```

就个人而言 - 我通常包括 GROUP BY 子句，因为我*认为*它更一致地支持跨平台......虽然不是 100% 肯定。

同样，在您上面的查询中，我会再次问 - 即使它在技术上有效，您是否得到了没有 where 子句的结果？

# ruby-on-rails-3 - 在 Rails 资产中使用 Liquid

> ID：14863732
> 
> 赞同：5
> 
> 时间：2013-02-13T21:43:18.070
> 
> 标签：ruby-on-rails-3, asset-pipeline, liquid

我在我的 CSS 中使用 Liquid。例如，我有`test.css.liquid`其中包含：

`body { background: {{ 'red' }}; }`

当我运行时`rake assets:precompile`，它没有`test.css`被编译，但仍然`test.css.liquid`没有解析 Liquid 代码。

Sprockets 使用默认情况下具有 Liquid 解析器的 Tilt。我在我的网站上启用了 Liquid。

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T16:15:03.660

重命名清单文件是个坏主意`application.css`。您可以通过在清单文件中要求来包含资产，如下所示：

```
*= require your_styles 
```

如果您启动了`liquid`引擎，应该没问题。

# git - Git - 如何列出两次在主分支上更改的所有文件？

> ID：14863735
> 
> 赞同：4
> 
> 时间：2013-02-13T21:43:35.520
> 
> 标签：git, version-control, cvs

我想找出两个日期之间在主分支（或任何一个分支）上修改的所有文件。

我了解，从这篇文章（[如何仅列出在两次提交之间更改的文件名？](https://stackoverflow.com/questions/1552340/git-show-all-changed-files-between-two-commits)）我可以使用

`git diff --name-only SHA1 SHA2`

但我不知道，从今天到昨天，SHA 是什么。尤其是当一天可能有多个提交时。

更准确地说，我想知道在今天凌晨 12:01 和昨天凌晨 12:01 之间在主 git 存储库上更改的文件列表。

这可能吗？我曾经能够在 CVS 中使用`cvs diff -D "1 days ago"`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T21:46:23.163

git 可以使用 reflog 来获取名称在任意时间之前的位置。

```
git diff --name-only master@{1 day ago} master 
```

`master`这将为您提供一天前的确切位置和 master 现在的位置之间的差异。

# c# - PropertyGrid 缺少 textChanged 事件

> ID：14863737
> 
> 赞同：0
> 
> 时间：2013-02-13T21:43:38.170
> 
> 标签：c#, winforms

我遇到了 propertyGrid 的问题。

我有一个名为 DummySettings 的类，它映射到 propertyGrid 我有一个属性“名称”

在 propertygrid EG 中键入内容时，我想引发一个“TextChanged”事件

尽管实现了 INotifyPropertyChanged 事件并引发了它，并且尽管在 propertyGrid 上挂钩了我能想到的各种事件，但当 A 文本更改时，这些事件都不会触发。

我错过了显而易见的事情吗？

# 已编辑

伪代码

```
 public class DummySettings : INotifyPropertyChanged
            {
                private string name;

                [DisplayName("Name")]
                public string Name
                {
                    get { return name; }
                    set
                    {
                        if (name != value)
                        {
                          name = value;
                         OnPropertyChanged("Name");
                        }
                    }
                }

                public event PropertyChangedEventHandler PropertyChanged;

                protected virtual void OnPropertyChanged(string propertyName)
                {
                    PropertyChangedEventHandler handler = PropertyChanged;
                    if (handler != null) handler(this, new PropertyChangedEventArgs(propertyName));
                }
            }

        //UserControl
    public partial class DummyControl : UserControl
    {
     private DummySettings settings;

     ///Constructor
    public DummyControl()
    {
        InitializeComponent();

        settings = new DummySettings();
        propertyGrid1.SelectedObject = settings;
        settings.PropertyChanged += OnDummyPropertyChanged;

     //All the events I have hooked up but not firing when text is changed 
    private void OnDummyPropertyChanged(object sender, PropertyChangedEventArgs e)
    {
          btnToEnable.Enabled = HasName();
    }        
     private void propertyGrid1_Leave(object sender, EventArgs e)
    {
               btnToEnable.Enabled = HasName();
    }

    private void propertyGrid1_Validating(object sender, CancelEventArgs e)
    {
        btnToEnable.Enabled = HasName();
    }

    private void propertyGrid1_SelectedObjectsChanged(object sender, EventArgs e)
    {
          btnToEnable.Enabled = HasName();
    }

    private void propertyGrid1_PreviewKeyDown(object sender, PreviewKeyDownEventArgs e)
    {
         btnToEnable.Enabled = HasName();
    }

      private bool HasName()
    {
        return settings.Name.IsNotNullOrEmpty();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:54:43.637

您可以使用[PropertyValueChanged](http://msdn.microsoft.com/en-us/library/system.windows.forms.propertygrid.propertyvaluechanged.aspx)事件来获取有关在 PropertyGrid 中更改的选定对象属性的通知。因此，当您将`Name`属性值从“Foo”更改为“Bar”时，将引发此事件：

```
void propertyGrid_PropertyValueChanged(object s, PropertyValueChangedEventArgs e)
{
    // previous value is e.OldValue, "Foo"
    // property name is e.ChangedItem.Label, "Name"
    // new value is e.ChangedItem.Value, "Bar"
} 
```

# objective-c - 在基类中使用派生类

> ID：14863742
> 
> 赞同：1
> 
> 时间：2013-02-13T21:44:13.347
> 
> 标签：objective-c, oop, inheritance

是否有可能，特别是在 Objective-C 中，在基类中使用继承类，例如：

```
Class BaseClass
{
  InheritedClass memberVariable;
}

Class InheritedClass : BaseClass
{
  // implementation goes here
} 
```

编辑：更详细的解释：

想象一下现实世界的情况，你有

```
Album:
- Title
- Artist

Song:
- Title
- Artist
- Duration 
```

所以你可以说 Album 类可以是 Song 类的基类，如下所示：

```
Class Album
{
  Title;
  Artist;
}

Class Song : Album
{
  Duration;
} 
```

现在，如果你需要在 Album 类中存储专辑的歌曲，你最终会得到这样的结果：

```
Class Album
{
  Title;
  Artist;
  Songs[];
} 
```

还是我通常错了，或者缺少一些基础知识？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:47:40.040

这是可能的，但您可能不会像在 C++ 中那样存储对象，您需要存储指向它的指针：

```
Class BaseClass
{
    InheritedClass* memberVariable;
} 
```

然后指针可能指向一个 InheritedClass 对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T23:38:11.207

是的，一个类拥有一个实例变量（您所称的成员变量的 ObjC 术语）或属性是完全可以接受的，其类型是其自身的子类。

这是一个简单的、可编译的程序，它演示了您在 Objective-C 中所要求的内容：

```
#import <Foundation/Foundation.h>

@class Song;

@interface Album : NSObject
    @property (strong) NSString *artist;
    @property (strong) NSString *title;
    @property (strong) NSArray *songs; 
    @property (strong) Song *bestSong;
@end

@interface Song : Album
    @property (weak) Album *album;
    @property NSTimeInterval duration;
@end

@implementation Album
@end

@implementation Song
@end

int main(int argc, char *argv[]) {
    @autoreleasepool {
        Album *album = [[Album alloc] init];
        Song *song1 = [[Song alloc] init];
        Song *song2 = [[Song alloc] init];
        album.songs = @[song1, song2];
        album.bestSong = song1;
        song1.album = album;
        song2.album = album;

        NSLog(@"Album: %@", album);
        NSLog(@"songs: %@", album.songs);
        NSLog(@"bestSong: %@", album.bestSong);
    }
} 
```

输出：

```
Album: <Album: 0x7fcc3a40a3e0>
songs: (
    "<Song: 0x7fcc3a40a5e0>",
    "<Song: 0x7fcc3a40a670>"
)
bestSong: <Song: 0x7fcc3a40a5e0> bestSong: <Song: 0x7ff48840a580> 
```

# r - 将百分位线添加到密度图

> ID：14863744
> 
> 赞同：8
> 
> 时间：2013-02-13T21:44:32.213
> 
> 标签：r, ggplot2

我有一些数据`dt = data.table(x=c(1:200),y=rnorm(200))`，我从密度图开始使用`ggplot2`：

```
plot = ggplot(dt,aes(y)) + geom_density(aes(y=..density..)) 
```

有没有办法可以添加类似于[**此**](http://www.psychometric-success.com/images/AA1301.gif)的百分位线？

[**如果进一步我可以对类似于此**](http://wpcontent.answcdn.com/wikipedia/commons/thumb/8/8c/Standard_deviation_diagram.svg/325px-Standard_deviation_diagram.svg.png)的图形段（由百分位线创建）进行着色，那就太好了！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-13T22:24:55.323

[以下是受此答案](https://stackoverflow.com/a/4371473/249691)启发的可能性：

```
dt <- data.table(x=c(1:200),y=rnorm(200))
dens <- density(dt$y)
df <- data.frame(x=dens$x, y=dens$y)
probs <- c(0.1, 0.25, 0.5, 0.75, 0.9)
quantiles <- quantile(dt$y, prob=probs)
df$quant <- factor(findInterval(df$x,quantiles))
ggplot(df, aes(x,y)) + geom_line() + geom_ribbon(aes(ymin=0, ymax=y, fill=quant)) + scale_x_continuous(breaks=quantiles) + scale_fill_brewer(guide="none") 
```

![在此处输入图像描述](../Images/ad4cb95579e739174ffdf56ce8eed7d3.png)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-13T22:22:51.700

```
myd = data.frame(xvar=rnorm(2000),yvar=rnorm(2000))

    xd <- data.frame(density(myd$xvar)[c("x", "y")])
    p <- ggplot(xd, aes(x, y)) + 

      geom_area(data = subset(xd, x < -1), fill = "pink") +
      geom_area(data = subset(xd, x < -1.96), fill = "red") +
      geom_area(data = subset(xd, x > 1), fill = "lightgreen") +
      geom_area(data = subset(xd, x > 1.96), fill = "green") +

      geom_line()

    p 
```

![在此处输入图像描述](../Images/43de3d1ef28ae1c768118f15be04b765.png)

# java - 在 JRibbonFrame 中添加内容 - 非实质性

> ID：14863748
> 
> 赞同：0
> 
> 时间：2013-02-13T21:44:36.437
> 
> 标签：java, swing, ribbon, radiance-flamingo

我正在用 Java 开发一个应用程序。

该界面基于**insubstantial** \ **Flamingo**。

我已经添加了本教程中描述的火烈鸟菜单[本教程](http://blog.frankel.ch/flamingo-tutorial)- 所以我扩展了**JRibbonFrame**类。

现在我应该添加一个“内容窗格” - 但我找不到方法......

从以下链接中，您可以看到我应该在哪里添加“内容窗格”： [http ://starkweb.it/contentPosition.png](http://starkweb.it/contentPosition.png)

一个简短的代码示例如下：

```
import java.awt.Dimension;
import java.awt.EventQueue;
import java.util.Arrays;
import javax.swing.JFrame;
import org.pushingpixels.flamingo.api.common.JCommandButton;
import org.pushingpixels.flamingo.api.ribbon.*;
import org.pushingpixels.flamingo.api.ribbon.resize.*;

public class MainFrame extends JRibbonFrame {

    public static void main(String args[]) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                new MainFrame().setVisible(true);
            }
        });
    }

    public MainFrame() {
        JRibbonBand band1 = new JRibbonBand("Comands", null);
        JCommandButton button1 = new JCommandButton("Square", null);
        JCommandButton button2 = new JCommandButton("Circle", null);

        band1.addCommandButton(button1, RibbonElementPriority.TOP);
        band1.addCommandButton(button2, RibbonElementPriority.MEDIUM);
        band1.setResizePolicies(Arrays.<RibbonBandResizePolicy>asList(
            new CoreRibbonResizePolicies.None(band1.getControlPanel()), 
            new IconRibbonBandResizePolicy(band1.getControlPanel())));

        RibbonTask task1 = new RibbonTask("Tab 1", band1);

        getRibbon().addTask(task1);

        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        setPreferredSize(new Dimension(800, 600));
        validate();
        pack();
    }
} 
```

非常感谢，
最好的问候，
-dAny-

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T13:37:42.737

你需要使用这个 > getContentPane().add();

# ruby-on-rails - Ruby 尝试使用 %x 打印命令行输出

> ID：14863750
> 
> 赞同：1
> 
> 时间：2013-02-13T21:45:09.110
> 
> 标签：ruby-on-rails, ruby

这就是我的小红宝石程序。它可能看起来微不足道，但似乎不起作用。

```
#!/usr/bin/ruby

location = "/home/"

puts %x ("ls " + location) 
```

我收到一条错误消息，提示此语法错误，意外 tSTRING_BEG，期望 $end puts %x ("ls" + location)。

有人可以解释我做错了什么吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:49:30.257

你要：

```
#!/usr/bin/ruby
location = "/home/"

puts %x(ls #{location}) 
```

请注意 %x 和位置之间的空格，您不需要引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:47:32.953

您需要将括号紧邻 the`%x`或它在语法上无效：

```
%x( ... )  # Valid, enclosed with brackets.
%x ( ... ) # Invalid, %x alone makes no sense. 
```

Like`%q`和 others，`%x`可以使用`[ ]`,`{ }`和`< >`作为括号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:51:02.893

`%x`您在和之间添加空格`(`。以下将起作用：

```
location = "/home/"

puts %x[ls #{location}]
puts %x(ls #{location})
puts `ls #{location}`
puts exec "ls #{location}" 
```

# jquery - 输入与：jQuery中的输入

> ID：14863751
> 
> 赞同：14
> 
> 时间：2013-02-13T21:45:12.790
> 
> 标签：jquery, css, jquery-selectors

我想知道为什么人们似乎更喜欢`:input`作为`input`jQuery 选择器？基本上，这两行似乎做同样的事情：

```
$('input:first').focus()
$(':input:first').focus() 
```

但是第二个版本使用更广泛，我不知道为什么。此外，`:input`根据这个基准，选择器似乎更慢：http: [//jsperf.com/input-vs-input/2](http://jsperf.com/input-vs-input/2)

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-13T21:46:35.217

`:input`是 jQuery 的伪选择器，包括`<buttons>`,`<textarea>`等

`input`是一个严格匹配的标签匹配`<input>`。

关于此附加说明提供了`:input`丰富的信息：

> 因为 :input 是一个 jQuery 扩展而不是 CSS 规范的一部分，所以使用查询`:input`不能利用原生 DOM`querySelectorAll()`方法提供的性能提升。要在使用`:input`to 选择元素时获得最佳性能，首先使用纯 CSS 选择器选择元素，然后使用`.filter(":input")`.

--来自[https://api.jquery.com/input-selector/](https://api.jquery.com/input-selector/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-13T21:46:30.400

`input`只是输入元素选择器。 [`:input`](http://api.jquery.com/input-selector/)还选择`textarea`、`select`和`button`（表单控件）。

这不一定是偏好问题，因为实际上它们做的事情有些不同。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T21:46:32.500

[`:input`](http://api.jquery.com/input-selector/)选择所有输入、文本区域、选择和按钮元素，而`input`只选择带有输入标签的元素。

# php - 缓存 facebook/twitter 个人资料图片

> ID：14863753
> 
> 赞同：1
> 
> 时间：2013-02-13T21:45:25.143
> 
> 标签：php, facebook, codeigniter, facebook-graph-api, twitter

我想让用户上传他们的 facebook/twitter 个人资料图片作为头像。我在数据库中插入带有他们的令牌/秘密的记录。我制作了一个脚本来获取用户的 id 并使用显示配置文件图像，`readfile()`但我想将此图像缓存 30 分钟。这可以用codeigniter吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:54:38.430

虽然不是特定于 codeigniter.. 在我创建的网站上 - 当用户使用 facebook 登录时，我们使用类似于 file_get_contents 的内容下载文件.. 然后我们将本地引用与图像数据的 MD5 一起存储.. 这允许我们在下次请求配置文件时轻松检查是否需要更新本地存储（这确实需要服务器从 facebook 重新下载）

在其他情况下，我们存储 facebook 报告的文件大小，以便我们可以执行 HTTP HEAD 请求来轻松检查它是否已更改（我意识到大小与图像更改没有直接关系。但是 99.9%时间是一个很好的迹象。

# excel - 将文件中的值与 Excel 中的列进行比较并更新另一列

> ID：14863756
> 
> 赞同：0
> 
> 时间：2013-02-13T21:45:29.777
> 
> 标签：excel, vba

存在一个 Excel 工作表，其中 Sheet1 的 A 列中包含机器名称列表。

存在一个文本文件，其中包含已退役机器的列表。

我需要在同一张表（Sheet1）B 列下的 Excel 表中将所有退役机器标记为“DECOM”。

这是我到目前为止所拥有的。

```
Sub ImportTextFileContents()
Dim strg As Variant
Dim EntireLine As String

FName = Application.GetOpenFilename("Text Files (*.txt), *.txt", , "Choose File to Import")

Open FName For Input Access Read As #1
i = 1
While Not EOF(1)
    Line Input #1, EntireLine
    strg = EntireLine

    If (Sheets("Sheet1").Range("A").Value = strg) Then
    Sheets("Sheet1").Range("B" & i).Value = "DECOM"
    End If

    i = i + 1
Wend
EndMacro:

On Error GoTo 0
Application.ScreenUpdating = True

Close #1
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:21:03.637

尝试这样的事情：

```
Sub ImportTextFileContents()
Dim strg As Variant
Dim EntireLine As String
Dim DecomMachines() as String
Dim rngExcel as Range
Dim cell as Range

FName = Application.GetOpenFilename("Text Files (*.txt), *.txt", , "Choose File to Import")

Open FName For Input Access Read As #1

'Create an array to contain the list of Decommissioned machines from the TXT file

i = 1
While Not EOF(1)
    Line Input #1, EntireLine
    strg = EntireLine
    ReDim Preserve DecomMachines(0 to i-1)
    DecomMachines(i-1) = strg   
    i = i + 1
Wend    

'Set the range variable over which we need to iterate:
Set rngExcel = Sheets("Sheet1").Range("A1",Range("A1").End(xlDown).Address)  '<-- modify as needed  

For each cell in rngExcel    
'Check to see if this cell.value exists in the array we built, above:
    If Not IsError(Application.Match(Cstr(cell.Value),DecomMachines,False)) Then
        'if the name exists in the DecomMachines array, then we need to mark it as decommissioned.
        cell.Offset(0,1).Value = "DECOM"
    Else:
        'it doesnot exist in the TXT file, so ignore it
    End If
Next    

EndMacro:

On Error GoTo 0
Application.ScreenUpdating = True

Close #1
End Sub 
```

这将创建一个数组，其中包含 TXT 文件中标识的所有机器，然后遍历 A 列中的单元格范围，测试数组中是否存在每个单元格值。如果它确实存在，那么我们知道在 B`cell.Offset(0,1)`列（

# asp.net-mvc-3 - Dapper 使用存储过程 (MSSQL) 时的缓存解决方案

> ID：14863759
> 
> 赞同：5
> 
> 时间：2013-02-13T21:45:39.227
> 
> 标签：asp.net-mvc-3, sql-server-2008, c#-4.0, dapper

我主要使用**Dapper**来调用数据库**MSSQL 2008 R2中的****存储过程**。我没有映射到数据库表的类。大部分数据最终进入并传输到屏幕上的网格。**`IEnumerable <Dynamic>`**

 **是否有我可以使用的即用型数据缓冲解决方案？（我需要在 MVC 上使用它）。

数据库中的数据本质上是静态的和动态的。我使用存储库模型来访问数据。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-14T08:18:54.073

Dapper 不包含任何内置的*数据*缓存功能（尽管它在内部为元编程层使用了广泛的缓存）：它直接针对 ADO.NET 的东西 - 但是，您几乎可以使用任何现成的缓存组件，包括 HTTP 运行时缓存 ( `HttpContext.Current.Cache`) 或更新的`ObjectCache`等实现。因为这些只是获取对象，所以它应该可以正常工作。

如果您使用*分布式*缓存（可能通过 app-fabric、redis 或 memcached），那么您需要可序列化数据。在这种情况下，我强烈建议使用正式的 POCO 类型进行绑定，而不是`dynamic`API。例如，在内部，我们使用 dapper 填充 POCO，这些 POCO 使用 protobuf-net 标记进行注释以进行序列化，并通过 BookSleeve 存储到 redis。这听起来比实际上更复杂。**

# java - Java服务器通过JSON处理来自iOS的请求？

> ID：14863761
> 
> 赞同：0
> 
> 时间：2013-02-13T21:45:57.703
> 
> 标签：java, iphone, ios, json, http

我的任务是创建一个服务器，该服务器将接收来自 iOS 设备 (iPhone) 的信息请求，然后根据此请求返回结果。我做了一些研究，似乎 JSON 是完成这项任务的方法。问题是我不知道从哪里开始；我的服务器应该如何组合在一起，它将如何处理请求等。任何人都可以指出我正确的方向并可能建议一些阅读吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:18:19.617

如果您熟悉 Java，我建议您获取 Eclipse JavaEE 版本，然后： 创建一个新的“动态 Web 项目”。文件/新建/其他/Web/动态 Web 项目

然后，在您的新项目中，创建一个“New Servlet”。文件/新建/其他/Web/Servlet

这应该使用 doGet 和/或 doPost 方法创建一个框架服务器。您可以立即使用 Eclipse 调试 servlet；它可以帮助您完成所有设置（这些天内置了 Jetty）

您可以在 20 分钟内设置您的第一个网络服务器。

从 json.org 获取 JSON jar。将它放在项目中的 WebContent/WEB-INF/lib 中。

在新 servlet 的 doPost 中，使用包含 json 的 post 参数的名称调用 request.getParameter(...) 。将其传递给 JSON 解析器。

要传回 JSON，请从 JSONObject 获取 JSON 字符串，然后使用 response.getWriter().append(...)

达达！

非常简短的答案，但话又说回来，这是一个非常开放的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:07:30.283

您可以使用 Spring Roo 快速入门。它可以为您的域对象自动创建控制器，为 Restful 请求返回 JSON 数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T21:53:20.593

如果您想用 Java 构建它并想使用所有酷猫都在使用的东西，[Dropwizard](http://dropwizard.codahale.com/)是您的最佳选择。在上次为 Vogue 拍摄照片（或者是最新版的[Thoughtworks 技术雷达](http://www.thoughtworks.com/insights)）之后，它的极客因素有所增加。不，真的 - 它非常好，而且非常容易部署和监控。

如果你只是想完成它，一个简短的 PHP 脚本是要走的路。

**警告：**如果你不懂 PHP，没关系：你仍然可以使用它。如果您不了解 Java，请**远离它**。在旅途中学习 Java 是一个很大的错误。

# xcode - 向 xcode 添加视图控制器会导致 monodevelop 出现异常

> ID：14863762
> 
> 赞同：0
> 
> 时间：2013-02-13T21:46:01.310
> 
> 标签：xcode, ipad, uiviewcontroller, monodevelop, popover

我刚开始使用 Monodevelop 3.1.1。我打开了 .xib 文件。我做了一个hello world程序。工作正常。现在我创建了新的 monodevelop 项目，并且我正在尝试使用 iPad 的弹出式样式（即，如果单击按钮并且我们有下拉式弹出式样式）。我向 Xcode 添加了一个视图控制器，我得到了这个错误。

```
System.ArgumentNullException: Argument cannot be null.
Parameter name: path1
 at System.IO.Path.Combine (System.String path1, System.String path2) [0x000c6] in /private/tmp/monobuild/build/BUILD/mono-2.10.9/mcs/class/corlib/System.IO/Path.cs:126 
at MonoDevelop.MacDev.XcodeSyncing.XcodeMonitor.ScanForAddedFiles (IProgressMonitor monitor, MonoDevelop.MacDev.XcodeSyncing.XcodeSyncBackContext ctx, System.Collections.Generic.HashSet`1 knownFiles, System.String directory, System.String relativePath) [0x00067] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/md-addins/MonoDevelop.MacDev/MonoDevelop.MacDev/XcodeSyncing/XcodeMonitor.cs:214 
 at MonoDevelop.MacDev.XcodeSyncing.XcodeMonitor.GetChanges (IProgressMonitor monitor, MonoDevelop.MacDev.ObjCIntegration.NSObjectInfoService infoService, MonoDevelop.Projects.DotNetProject project) [0x00070] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/md-addins/MonoDevelop.MacDev/MonoDevelop.MacDev/XcodeSyncing/XcodeMonitor.cs:256 
  at MonoDevelop.MacDev.XcodeSyncing.XcodeProjectTracker.SyncXcodeChanges (IProgressMonitor monitor) [0x00017] in /Users/builder/data/lanes/monodevelop-lion-monodevelop-3.1-series/5d928ec4/source/md-addins/MonoDevelop.MacDev/MonoDevelop.MacDev/XcodeSyncing/XcodeProjectTracker.cs:497 
```

那么如果我们需要在 MonoDevelop/Xcode 中添加一个视图控制器，我们应该在哪里添加一个视图控制器呢？我们该怎么做呢？更多的问题来了。如果您需要更多信息，请询问。谢谢。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T15:30:24.540

这看起来像 MonoDevelop 中的一个错误。您应该能够在 Xcode 中添加视图控制器，并且它应该被导入回 MonoDevelop。

如果 Xamarin Studio（又名 MonoDevelop 4.0）中仍然存在此错误，我将研究修复它。

更新：这应该在 4.0.1 中修复

# sift - 带有 SIFT 或 Harris-Laplace 描述符的开源 CBIR？

> ID：14863765
> 
> 赞同：2
> 
> 时间：2013-02-13T21:46:10.903
> 
> 标签：sift, cbir

有谁知道使用 SIFT 或 Harris-Laplace 描述符的开源 CBIR？

# git - GitHub Windows“加载提交失败”

> ID：14863766
> 
> 赞同：1
> 
> 时间：2013-02-13T21:46:11.743
> 
> 标签：git, github-for-windows

我突然收到错误“加载提交失败”，它要求我使用控制台调试它。我尝试输入`git log`并收到错误“致命：错误修订版'HEAD'”，几乎我尝试做的任何事情都会导致此错误。

似乎是 GitHub Windows 客户端的一个错误，我绝对没有做任何奇怪的事情。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:46:11.743

不知何故，我正在研究的分支爆炸了。

在`C:\Users\Farzher\Documents\GitHub\project\.git\refs\heads`我找到我的分支`dev.lock`时，我只是将其重命名为`dev`，一切都恢复正常了！

# php - 如何在特定的 php 类函数中获取实际的代码文本？

> ID：14863776
> 
> 赞同：0
> 
> 时间：2013-02-13T21:46:43.530
> 
> 标签：php, regex

我想从文件中的特定函数中获取实际的编程代码文本。例如，我想在`__construct(){}`调用`Example`in的类中获取代码`ExampleClass.php`。我怎样才能做到这一点？

正则表达式是最好的方法还是有更好的方法？

# python - 如何从 Python 元组中的每个值中减去一个？

> ID：14863778
> 
> 赞同：5
> 
> 时间：2013-02-13T21:46:55.223
> 
> 标签：python, integer, tuples

我创建了一个元组`zip()`，我需要从元组中的每个整数中减去一个。我尝试了以下方法，但显然它只适用于列表，那么我如何将它用于 Python 中的元组？

```
[...]
lower, upper = zip(*table)
lower[:] = [x + 1 for x in lower]
upper[:] = [x - 1 for x in upper]
holes = zip(lower[:-1], upper[1:]) 
```

> TypeError：“元组”对象不支持项目分配

大图是我存储了一系列不重叠的排序间隔`table`，我需要得到一系列孔。例如，我的间隔表可能是：

```
[ 6,  7]
[ 8,  9]
[14, 18]
[23, 32] 
```

我想计算`holes`间隔之间的 in：

```
[10, 13]
[19, 22] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T21:50:57.573

将`tuple`构造函数与生成器表达式一起使用：

```
lower = tuple(x - 1 for x in lower)
upper = tuple(x + 1 for x in upper) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-13T21:57:48.317

您也可以在单个列表理解中解决这些问题：

```
holes = [(table[i][1]+1, table[i+1][0]-1) for i in range(len(table)-1)] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-13T23:45:34.213

使用生成器函数可以轻松完成任务。

```
table = [(2,3),(5,6),(12,20),(21,25),(28,28),(35,48),(53,55)]

def gaps_between(intervals):
    prec = intervals[0][1] + 1
    for L,H in intervals:
        print '\nprec = %d   (L,H) = (%d,%d)' % (prec,L,H)
        print 'prec = %d <= L-1 = %d : %s' % (prec,L-1,prec<=L)
        if prec<=L-1:
            yield (prec,L-1)
        prec = H + 1
        print 'next prec = %d' % prec

holes = list(gaps_between(table))

print
print 'table =',table
print 'holes =',holes 
```

在以前的答案中，我使用了在生成器中定义的迭代器。
为了避免这种情况，我在上面使用了一个策略：
定义`first prec = first H = intervals[0][1]`。
鉴于`H>=L`对于每一对 (L,H) ，它都会导致
`first H > first L - 1`--> `first prec > first L - 1`。
因此，关于第一个间隔的第一个测试总是 False，而真正的过程从第二个间隔开始。

```
prec = 3   (L,H) = (2,3)
prec = 3 <= L-1 = 1 : False
next prec = 4

prec = 4   (L,H) = (5,6)
prec = 4 <= L-1 = 4 : True
next prec = 7

prec = 7   (L,H) = (12,20)
prec = 7 <= L-1 = 11 : True
next prec = 21

prec = 21   (L,H) = (21,25)
prec = 21 <= L-1 = 20 : True
next prec = 26

prec = 26   (L,H) = (28,28)
prec = 26 <= L-1 = 27 : True
next prec = 29

prec = 29   (L,H) = (35,48)
prec = 29 <= L-1 = 34 : True
next prec = 49

prec = 49   (L,H) = (53,55)
prec = 49 <= L-1 = 52 : True
next prec = 56

table = [(2, 3), (5, 6), (12, 20), (21, 25), (28, 28), (35, 48), (53, 55)]
holes = [(4, 4), (7, 11), (26, 27), (29, 34), (49, 52)] 
```

结果是正确的：
- 它给出了 (2,3) 和 (5,6) 之间的间隙 (4,4)
- (12,20) 和 (21,25) 之间没有间隙
- (28) 中存在值 28 ,28) 没有任何差距

OP 说间隔是非重叠和排序的。
但是，测试`if prec<=L-1`是强制性的，否则连续的间隔会产生错误：
如果没有这个测试，结果将包含
`....., (7, 11), (21, 20), (26, 27), .......`

.

碰巧的是，通过这个强制性测试，以下
`[[ 8, 9],[14, 18],[18, 32]]`
`[[8, 9], [14, 18], [19, 20], [16, 21], [23, 32]]`
重叠的间隔列表（不是 OP 所说的）
并且在没有测试的情况下会
产生错误，实际上不会产生任何错误。

使用我上面的代码给出正确间隔列表的间隔列表的规则是，间隔必须沿着第二个元素排序。

.

替换`yield (prec,L-1)`为`yield range(prec,L)`will 将间隙作为范围。

例如，替换`yield (prec,L-1)`为`holes.append((prec,L-1))`允许编写没有函数的代码。

# python - pip install virtualenv 脚本在哪里

> ID：14863785
> 
> 赞同：0
> 
> 时间：2013-02-13T21:47:24.673
> 
> 标签：python, virtualenv, pip, setup.py

这可能是一个非常愚蠢的问题，但我正在测试我编写的一个包含一些脚本的 python 包。

我做了以下序列：

1.  使用 setup.py 创建了一个发行版
2.  使用 virtualenv 创建了一个虚拟环境，
3.  称为“activate.bat”
4.  使用 pip 安装了我的包（通过提供 .zip 文件的路径） 事情似乎有效，除了我不知道如何运行我的脚本。如果我尝试运行 example.py，我会收到消息（我使用的是 Windows）：

'example.py' 不是内部或外部命令、可运行程序或批处理文件。

除了原始的 .zip 文件外，我没有看到该文件存在于任何地方的任何证据。那么我该如何运行呢？

[更新]我查了一下，脚本文件不在虚拟环境目录的任何地方。

setup.py 文件如下所示：

```
from distutils.core import setup

setup(name='Fixedwidth',
      version='1.0',
      description='Parser for fixed-width records',
      author='Daryl McCullough',
      author_email='dmccullough@decisionpatterns.com',
      package_dir={'fixedwidth':'lib'},
      packages=['fixedwidth', 'fixedwidth.profiling'],
      scripts=['test/example.py', 'test/unittest.py']
      ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:53:11.893

好吧，正如我所怀疑的那样，这完全是愚蠢的。我对两个不同的“脚本”目录感到困惑，并且运行了错误的“pip”，结果是将包安装到主 python 目录中，而不是虚拟环境中。

# jquery - DataTables 根据 TD 属性值对 html 表进行排序

> ID：14863793
> 
> 赞同：4
> 
> 时间：2013-02-13T21:47:49.403
> 
> 标签：jquery, sorting, datatables

我正在使用 DataTables jquery 库来显示简单的 HTML 表格标记，即不使用 Ajax 或 JSON。除了我想对原始数据而不是显示的格式化数据进行排序之外，这一切都运行良好。我想为我的 TD 标签添加一个属性，例如'data-sort="42"' 并初始化 DataTables，指示它根据该值对列进行排序（如果存在）。

我已经阅读了 mData 和 mRender 的文档，但它们似乎处理的情况比我自己的要复杂得多，即数据很容易被更改或按需从服务器获取。

请有人为我说明初始化代码是如何进行的，或者指出一个这样做的例子？非常感谢！

鲍勃

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T20:01:13.360

查看此页面上有关隐藏标题字符串排序（或隐藏标题数字排序）的部分：[http](http://www.datatables.net/plug-ins/sorting) ://www.datatables.net/plug-ins/sorting 。此方法要求您将原始数据放入 span 的 title 属性中：

```
<td><span title="[raw data]">[Formatted data]</span></td> 
```

然后将此添加到表的初始化脚本中（假设您正在使用隐藏的标题字符串排序）：

```
"aoColumns": [
    { "sType": "title-string" },
 ] 
```

# ios - ios - 我有崩溃代码和 .dSYM 文件，但是如何获取崩溃发生的位置？

> ID：14863797
> 
> 赞同：0
> 
> 时间：2013-02-13T21:48:19.977
> 
> 标签：ios, ios5, ios6, symbolicatecrash

我有这个来自 Apple 的象征性崩溃报告：

```
Thread 0:
14  Fundraising                     0x0007a3aa 0x79000 + 5034 
```

我将二进制文件存档在我的组织者档案中。但我真的不明白“解码”该符号代码需要哪些步骤。有人可以向我解释所需的步骤吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-15T00:16:49.933

如果您的 .dSYM 文件也与二进制文件一起存档，请尝试此操作

[http://sourceforge.net/p/umsservices/wiki/Home/](http://sourceforge.net/p/umsservices/wiki/Home/)

它应该为您完成这项工作。

# objective-c - 我怎样才能格式化这个日期？2013-02-13T19:25:27.1381035-06:00

> ID：14863800
> 
> 赞同：0
> 
> 时间：2013-02-13T21:48:26.137
> 
> 标签：objective-c, nsdate, nsdateformatter, milliseconds

我得到一个看起来像这样的提要：`2013-02-13T19:25:27.1381035-06:00`

我将它设置为这样的 NSDate：

`NSDate *endDate = [tempFormatter1 dateFromString:myEndDateString]`

我可以使用这样的东西：

`[tempFormatter1 setDateFormat:@"dd-MM-yyyy'T'HH:mm:ss'SSS Z'"];`

是否可以从这种格式转换它？

谢谢！

# php - 需要从数据库返回/回显 PHP PDO 结果

> ID：14863806
> 
> 赞同：3
> 
> 时间：2013-02-13T21:48:58.413
> 
> 标签：php, database, pdo

好吧，我做了我的研究，但我似乎无法弄清楚这一点。长话短说，我正在使用这样的东西：

顺便说一句，“（WebsiteInfo）”只是为了感知我的网站/数据库信息。

```
$SQL = new PDO('mysql:dbname=(WebsiteInfo);host=(WebsiteInfo);charset=utf8', '(WebsiteInfo)', '(WebsiteInfo)');

$SQL -> setAttribute(PDO::ATTR_EMULATE_PREPARES, false);

$SQL -> setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION); 
```

现在，这只是目前只是启动数据库连接。顺便说一句，我在这个网站上也找到了一个复制/粘贴代码，用于防止 MySQL 注入。实际上来自这个链接[如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php). 如果它有任何问题，我不介意建议或提示。只要这有意义，因为我可能甚至不到一周前才开始使用数据库，所以一切对我来说都是新的。现在有这个：

```
$Exicu = $SQL -> prepare("SELECT `tags` FROM `users` WHERE `user_id` = :a ") -> execute(array( ':a' => 16)); 
```

`$Exicu`就在那里，因为我一直在尝试从查询中获取结果（如果我说得对的话）。16 也是用户 ID，但这会经常更改，所以这就是为什么 16 不只是被扔在准备语句中的原因。我尝试了很多东西，但都没有奏效。它要么不起作用，要么导致 PHP 崩溃。

但无论如何，我已经尝试过的事情`$Exicu`是`$Exicu->rowCount()`, , 一个带有,`$Exicu->bindParam`的 while 循环, 一个带有, , ,和 just的循环。是的，我知道，这看起来很草率。`$row = $Exicu->fetch()``$SQL->query($Exicu)->fetchAll();``foreach``($Exicu->fetch(PDO::FETCH_ASSOC) as $row)``$Exicu->get_result()``echo PDO::query($Exicu);``echo mysql_result($Exicu)``echo $Exicu`

但这些似乎都不能只向我展示`tags`特定用户的数据库。所以这几乎就是我需要帮助的地方。当我使用这样的东西时没有问题，`echo mysql_result( mysql_query("SELECT (etc,etc)") )`但它没有防止 MySQL 注入的保护。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T21:57:29.300

我这样做我的 PDO 查询是这样的：

```
$user_id = 16;    

$query = $SQL->prepare('SELECT tags FROM users WHERE user_id = :uid');
$query->bindValue(':uid', $user_id, PDO::PARAM_INT);
$query->execute();

while ($row = $query->fetch(PDO::FETCH_ASSOC))
{
    echo $row['tags'];
} 
```

这将从数据库中选择数据，安全地绑定其中的值，然后我们回显结果。

需要循环来遍历从查询返回的每个结果。您可以跳过循环部分并在`while`语句中创建一个变量，并将`$row`结果用作数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-14T07:13:31.657

有一种东西叫做*用户定义函数*。

我想知道为什么这个网站上没有人使用它们。
出于某种原因，每个人都准备好编写一英里长的单行链式方法，而不是简洁明了的函数调用：

```
$user_id = 16;    
$tags = getone('SELECT tags FROM users WHERE user_id = ?',array($user_id)); 
```

有很多方法可以创建这样的功能。一个又快又脏的

```
function getone($sql, $data) {
    global $SQL;
    $stmt = $SQL->prepare($sql);
    $stmt->execute($data);
    return reset($stmt->fetch());
} 
```

但是当然最好是制作一组函数并将它们放在一个类中

# javascript - 如何更改 Twitter 关注按钮的宽度？

> ID：14863809
> 
> 赞同：6
> 
> 时间：2013-02-13T21:49:07.743
> 
> 标签：javascript, html, css, twitter

我知道这已在其他线程中被问过，但这些答案不适合我的情况。如果您从此处嵌入 twitter 关注按钮：

[https://twitter.com/about/resources/buttons](https://twitter.com/about/resources/buttons)

```
<a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> 
```

JS 用 iframe 替换链接：

```
<iframe scrolling="no" frameborder="0" allowtransparency="true" src="http://platform.twitter.com/widgets/tweet_button.1360366574.html#_=1360791644346&amp;count=horizontal&amp;id=twitter-widget-0&amp;lang=en&amp;original_referer=http%3A%2F%2Fwww.foo.com%2Fsearch%2Fcats&amp;size=m&amp;text=Search%20Results%20for%20%22cats%22%20on%20Foo&amp;url=http%3A%2F%2Fwww.foo.com%2Fsearch%2Fcats" class="twitter-share-button twitter-count-horizontal" style="width: 109px; height: 20px;" title="Twitter Tweet Button" data-twttr-rendered="true"></iframe> 
```

如您所见，宽度设置为内联样式。我知道我可以用类似的东西来覆盖它：

```
.twitter-share-button { width: 80px !important; } 
```

例如，但我不想这样做，因为如果共享计数在特定内容页面上增加到非常大的数字怎么办。然后共享计数将被最小宽度所掩盖。

有没有办法告诉 twitter 根据内部的共享计数来调整返回 iframe 的大小，使其不大于所需的最小宽度？

我知道 Facebook 通过我相信的数据属性接受所需的宽度，`data-width`并且可以将其设置为 auto 以获得我在上面要求的行为类型。Twitter 是否为他们的分享按钮提供了类似的功能？

[小提琴](http://jsfiddle.net/3LxbJ/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T21:49:56.340

而不是`width`，设置一个`min-width`：

```
.twitter-share-button { min-width: 80px !important; width: auto !important;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-08-19T09:36:10.537

这似乎是一个已知问题（请参阅[此 Dev Twitter 线程](https://dev.twitter.com/discussions/11405)），截至目前，它已经等待了近 2 年的有效解决方案。目前似乎没有让按钮宽度匹配其实际内容的*干净方法。*
一个人可以摆弄一些自定义的 javascript，但如果你试图操纵 IFrame，最后你又会碰到 IFrame/CORS 墙。

# php - 实体抽象属性被复制到扩展实体

> ID：14863811
> 
> 赞同：0
> 
> 时间：2013-02-13T21:49:18.183
> 
> 标签：php, symfony, doctrine-orm

我有一个非常奇怪的错误：

```
Fatal error: Access level to Acme\DemoBundle\Entity\Book::$title
must be public (as in class Acme\DemoBundle\Entity\AbstractBook) in   
/var/www/html/src/Acme/DemoBundle/Entity/Book.php on line 614 Call 
Stack: 0.0002 674960 1 
```

第 614 行不可用，最疯狂的是，当我将整个实体文件夹从 ide 手动上传到本地 ubunutu 映像时，错误就消失了。

这是我的 AbstractBookEntity：

```
 namespace Acme\DemoBundle\Entity;

 use Doctrine\ORM\Mapping as ORM;
 use Symfony\Component\Validator\Constraints as Assert;

 /** 
 * @ORM\MappedSuperclass 
 * @ORM\HasLifecycleCallbacks
 */
class AbstractBook
{

/**
 * @var string $title
 *
 * @ORM\Column(name="title", type="string", length=45, nullable=true)
 */
public $title; 
```

图书类：

```
namespace Acme\DemoBundle\Entity;

use Symfony\Bridge\Doctrine\Validator\Constraints\UniqueEntity;
use Symfony\Component\Validator\Constraints as Assert;
use Doctrine\ORM\Mapping as ORM;

/**
 * Acme\DemoBundle\Entity\Book
 *
 * @ORM\Table(name="book")
 * @ORM\Entity(repositoryClass="Acme\DemoBundle\Repository\BookRepository")       
 */
class Book extends AbstractBook { 
```

**更新：**

我检测到抽象实体中的属性被复制并声明为私有到扩展实体中，但它是如何发生的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T10:31:58.907

首先，尝试清除缓存：`php app/console cache:clear`或者如果失败：`rm -Rf app/cache/*`

我建议将您的实体变量声明为受保护的（不确定，但我的意思是我听说过使用公共的问题）。

然后你可以运行`php app/console doctrine:generate:entities AcmeDemoBundle`创建getter/setter。

# node.js - PURE node.js 有教程吗？

> ID：14863812
> 
> 赞同：3
> 
> 时间：2013-02-13T21:49:22.013
> 
> 标签：node.js

我一直在寻找 node.js 教程。我刚拿到关于 node 的书，我意识到在我学到一些东西之前我必须使用 express.js 模块。

是否有教程或书籍教授如何创建纯 node.js Web 应用程序，无需任何节点打包模块（npm）？

因为一开始我想学纯node.js，以后可能会用到一些npm。

提前致谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T21:54:31.053

就纯 node.js 而言，官方 API 文档是最好和最新的资源。对于 Web 应用程序，请参阅[http://nodejs.org/api/http.html](http://nodejs.org/api/http.html)上的 HTTP API 文档。

您还可以查看以前的类似问题，这似乎是一个很好的答案：我[如何开始使用 Node.js。](https://stackoverflow.com/questions/2353818/how-do-i-get-started-with-node-js)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-13T22:03:51.217

[我个人是Smashing Node.js](http://smashingnode.com/)这本书的忠实粉丝。它从一些 JavaScript 本身开始，然后转到 V8/Node JS，从那里转到 tcp/http 等。直到本书后面很长时间才涉及 express。它还涵盖了节点世界中使用的常见数据库，例如 mongo、redis 和 MySql。物有所值国际海事组织。

# ruby-on-rails - 活动管理员在查看第一个页面后的任何页面时仅生成包含列标题（没有其他行）的 CSV

> ID：14863813
> 
> 赞同：1
> 
> 时间：2013-02-13T21:49:26.060
> 
> 标签：ruby-on-rails, ruby, csv, activeadmin, kaminari

我在后端使用 Active Admin。

我有几页记录。当我使用内置功能从记录的第一页生成 CSV 文件时，一切正常，但是当我尝试从第 2 页及更高版本运行导出时 - 它会生成一个只有标题而没有数据的空白文档。

有没有人遇到过这个错误？使固定？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-18T00:16:49.847

我刚刚打开了一个 PR 以通过使 CSV 导出始终尊重您所在的当前页面来解决此问题：[https ://github.com/gregbell/active_admin/pull/2419](https://github.com/gregbell/active_admin/pull/2419)

理想情况下，我们希望有“将每条记录导出到一个文件”功能，但目前至少当前的 CSV 导出链接会按预期运行。

# algorithm - 如何仅在画布中使用自定义颜色绘制大于 0% alpha 的可见像素？

> ID：14863819
> 
> 赞同：0
> 
> 时间：2013-02-13T21:49:46.587
> 
> 标签：algorithm, canvas, hit

我想对 png 图像和其他形状进行良好的性能命中测试。我真的不在乎它们是什么形状，因为使用这种技术在检查（而不是设置）时不会出现性能问题。

我打算将屏幕上的所有图像收集在辅助画布中，仅用于命中测试。对于绘制的每个图像，我将创建一个附加到该特定图像的新颜色。然后我将它们全部绘制在画布中，每个图像将具有不同的填充颜色。

当我点击一个像素（x，y）时，它会得到颜色（r，g，b）。每种颜色都映射到一个图像，因此我可以毫无错误地点击该图像（我不会浪费在查找该点击所击中的内容上）。

![在此处输入图像描述](../Images/da7321011cbab125bc90dd3dcc860deb.png)

我知道它将被限制为 256*256*256=16 777 216 件，因为这些都是颜色，但我认为现在这不是问题......

所以我真正需要的是知道如何将这些填充颜色放在仅基于每个图像的可见像素的辅助画布上。

**更新**

![在此处输入图像描述](../Images/a3da73dfcc574319c188310f6b5bcde4.png) 正如您在右侧看到的那样，它是命中测试地图。因此，如果我点击黑色阴影 (c)，我会立即知道我点击了蓝色框，无需任何其他计算。

一项改进是缓存 alpha 数据。还为每个图像实例重用相同的 alpha 数据（我们必须注意缩放和旋转......）。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T02:26:10.143

下面介绍如何对画布图像的不透明像素进行颜色遮罩。

确保将“PutYourImageHere.png”替换为您自己的图片网址。

```
<!doctype html>
<html>
<head>

<script type="text/javascript" src="http://code.jquery.com/jquery.min.js"></script>

<style>
    body{ background-color: ivory; }
    canvas{border:1px solid blue;}
</style>

<script>
    $(function(){

        var img=new Image();
        img.onload=function(){

          var red=255;
          var blue=0;
          var green=0;

          var canvasCopy=document.getElementById("canvasCopy");
          var ctxCopy=canvasCopy.getContext("2d");

          var c=document.getElementById("canvas");
          var ctx=c.getContext("2d");
          ctx.drawImage(this,0,0);

          var imgData=ctx.getImageData(0,0,c.width,c.height);

          for (var i=0;i<imgData.data.length;i+=4)
            {
                if(imgData.data[i+3]>0){
                    imgData.data[i]=red;
                    imgData.data[i+1]=green;
                    imgData.data[i+2]=blue;
                    imgData.data[i+3]=255;
                }
            }
          ctxCopy.putImageData(imgData,0,0);
        }
        img.src = "PutYourImageHere.png";

    }); // end $(function(){});
</script>

</head>

<body>

    <canvas id="canvas" width="300" height="300"></canvas>
    <canvas id="canvasCopy" width="300" height="300"></canvas>

</body>
</html> 
```

# google-maps - 在 Google 地图中使用自定义图钉图标仅显示循环中的第一个位置

> ID：14863825
> 
> 赞同：0
> 
> 时间：2013-02-13T21:49:59.230
> 
> 标签：google-maps, google-maps-api-3

我已经尝试了很多方法来解决这个问题，但我似乎找不到解决方案。问题是只有第一个位置被添加到我的地图中，而其他地方被忽略了。当我删除自定义图钉图标时，所有位置都已正确添加。似乎影响这一点的行是：

```
icon: iconType[place.icon] 
```

正如我所说，当我删除这条线时，一切都按预期工作。我究竟做错了什么？

**下面的代码**

我在一个对象中定义了许多地方，如下所示：

```
var data = [
  {
    "name" : "Hotel A",
    "latlng" : new google.maps.LatLng(-33.636784,19.098212),
    "icon" : "venue",
    "desc" : "This is the venue",
  },
  ...
]; 
```

图标定义如下：

```
iconType = {
  'oneStar' : 'mapimages/lodging_1star.png',
  'twoStar' : 'mapimages/lodging_2star.png',
  ...
}; 
```

我使用 for 循环将我的位置放在地图上，像这样循环遍历数据变量：

```
var bounds = new google.maps.LatLngBounds();
var map;
var infowindow = new google.maps.InfoWindow({ maxWidth: 300 }); 
var marker;

function initialize() {
  // init map
  var venueLatlng = new google.maps.LatLng(-33.636784,19.098212);
  var mapOptions = {
    zoom: 12,
    center: venueLatlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);

  for (var i = 0; i < data.length; i++) { 
    createMarker(data[i]);
  }
  map.fitBounds(bounds);
}

function createMarker(place) {
    bounds.extend(place.latlng);
    marker = new google.maps.Marker({
      position: place.latlng,
      title: place.name,
      map: map,
      icon: iconType[place.icon]
    });
    google.maps.event.addListener(marker, 'click', function() {
      infowindow.setContent(place.desc);
      infowindow.open(map, marker);
    });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:52:57.430

这对我有用（我没有你的图标，所以我链接到谷歌服务器上的公共图标）：

```
 <script>
       var map;

var data = [
  {
    "name" : "Venue A",
    "latlng" : new google.maps.LatLng(-33.636784,19.098212),
    "icon" : "venue",
    "desc" : "This is the venue",
  },
  {
    "name" : "Hotel A",
    "latlng" : new google.maps.LatLng(-33.6,19.0),
    "icon" : "oneStar",
    "desc" : "one star",
  },
  {
    "name" : "Hotel B",
    "latlng" : new google.maps.LatLng(-33.4,19.0),
    "icon" : "twoStar",
    "desc" : "two star",
  }
];

iconType = {
  'oneStar' : 'http://maps.google.com/mapfiles/ms/icons/blue.png',
  'twoStar' : 'http://maps.google.com/mapfiles/ms/icons/red.png',
  'venue'   : 'http://maps.google.com/mapfiles/ms/icons/yellow.png'
};

var bounds = new google.maps.LatLngBounds();
var map;
var infowindow = new google.maps.InfoWindow({ maxWidth: 300 }); 
var marker;

function initialize() {
  // init map
  var venueLatlng = new google.maps.LatLng(-33.636784,19.098212);
  var mapOptions = {
    zoom: 12,
    center: venueLatlng,
    mapTypeId: google.maps.MapTypeId.ROADMAP
  }
  map = new google.maps.Map(document.getElementById('map_canvas'), mapOptions);

  for (var i = 0; i < data.length; i++) { 
    createMarker(data[i]);
  }
  map.fitBounds(bounds);
}

function createMarker(place) {
    bounds.extend(place.latlng);
    var marker = new google.maps.Marker({
      position: place.latlng,
      title: place.name,
      map: map,
      icon: iconType[place.icon]
    });
    google.maps.event.addListener(marker, 'click', function() {
      infowindow.setContent('<b>'+place.name+'</b><br>'+place.desc);
      infowindow.open(map, marker);
    });
}

      google.maps.event.addDomListener(window, 'load', initialize);
     </script> 
```

# php - 当用户检查复选框时，使用 JQuery 设置和取消设置会话变量的正确方法是什么？

> ID：14863826
> 
> 赞同：0
> 
> 时间：2013-02-13T21:49:58.917
> 
> 标签：php, jquery, session

我有一个表单，当用户选中一个复选框时，我使用 JQuery post 方法设置了一个会话变量。

我的问题：如果用户返回并决定取消选中以前选中的框，是否有直接的方法来取消设置会话变量？

HTML

```
<?php session_start() ?>
<html>
<head>

<script type="text/javascript">
        $(document).ready(function(){
var checkboxes = $(".chkbx").change(function() {
    var allIsChecked = checkboxes.length === checkboxes.filter(":checked").length;
    all[0].checked = allIsChecked;
    enableMyElement(checkboxes.filter(":checked").length > 0);
    putInSession($(this).val());
});
var all = $("#checkall").change(function() {
    checkboxes.attr("checked",this.checked);
    enableMyElement(this.checked);
});

  $("#myform").change( function () {    
              $.post(
               'actions.php',
               $(this).serialize(),
                function(data){
                  $("#results").html(data)
                }
              );
              return false;   
            }); 

  });
</script>

</head>

<body>
<form id="myform">
<input id="checkall" type="checkbox">
<input class="chkbx" type="checkbox" value="360" name="box1">
<input class="chkbx" type="checkbox" value="500" name="box2">
<input class="chkbx" type="checkbox" value="510" name="box3">
<input type="submit" value"Send" />
</form>

<div id="results">Will go here</div>

<?php print_r($_SESSION); ?>

</body>

</html> 
```

处理脚本

```
<?php
session_start();
$post = $_POST;
foreach ($post as $key => $value) {
echo $key. "->" .$value; 
$_SESSION[$key] = $key;
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T21:53:17.387

是的。使用 jQuery 帖子传入复选框的状态（选中、未选中）。然后在处理脚本中，您可以检查它是否已检查并设置/取消设置`$_SESSION`变量。

```
if($_POST['checked']) {
    // your current foreach loop
} else {
    unset($_SESSION);
} 
```

# jsf - 如何清除 PrimeFaces DataTable 中的全局过滤器

> ID：14863827
> 
> 赞同：4
> 
> 时间：2013-02-13T21:50:01.523
> 
> 标签：jsf, primefaces

如何使用“清除”命令按钮清除 PrimeFaces DataTable 中的全局过滤器？我[在 PrimeFaces 论坛上发现了类似的问题](http://forum.primefaces.org/viewtopic.php?f=3&t=24230)，但看起来没有回答 - 那里可以找到的提示对我没有帮助。我试图解决问题如下：

```
<p:dataTable id="myTab" widgetVar="myTabWidgetVar" var="obj"
    value="#{managedBean.objects}">
    <f:facet name="header">
        <p:outputPanel>
            <h:outputText value="Search all fields:"/>
            <p:inputText id="globalFilter" onkeyup="myTabWidgetVar.filter()"/>
        </p:outputPanel>
    </f:facet>
</p:dataTable>
<p:commandButton value="Clear" onclick="myTabWidgetVar.clearFilters();"
    update="@form"/> 
```

它仅清除列过滤器。全局过滤器中的值仍不清楚。你能帮我解决问题吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T22:44:04.930

方法如下：

```
$("#someFormId\\:myTab\\:globalFilter").val("").keyup();//if you got `prependId="false" , than omit the `someFormId\\:` part from the selector and leave only `myTab\\:globalFilter` 
```

这将用空字符串填充您的过滤器并触发 keyup 事件，从而清除您的过滤器并清除表的过滤器状态

如果您只想清除过滤器而不重置应用于您的表的过滤器，请使用

```
$("#someFormId\\:myTab\\:globalFilter").val(""); 
```

如果您想在 commandButton 中使用此代码，则无需使用 ajax ( `update...`)

就`onclick`这样使用

```
<p:commandButton value="Clear" 
onclick="$('#someFormId\\:myTab\\:globalFilter').val('').keyup(); return false;"/> 
```

使用`return false;`所以按钮不会提交您的页面...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-05T07:23:58.293

```
<pdataTable  widgetVar="departments" />
<p:commandButton value="#{lang:text('Add department')}"
                 id="....."
                 actionListener="....."
                 update="@form"
                 oncomplete="PF('departments').clearFilters()"
                 styleClass="........."/> 
```

它适用于我的主要面孔

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-21T14:07:35.120

Primefaces 数据表具有“filteredValue”选项。假设您设置了过滤值，例如；过滤值=“#managedBean.filteredObjects}”。

在您的情况下，filteredObjects 具有与数据表的值相同的类型，即“managedBean.objects”。在加载数据表之前，将filteredObjects 变量设置为NULL。它会解决你的问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-02-04T11:05:17.727

上述解决方案在我的情况下不起作用。我尝试了`remoteCommand`这里解释的[Primefaces Datatable doesn't reset filter](https://stackoverflow.com/questions/37458844/primefaces-datatable-doesnt-reset-filter)，但这也不起作用。

我用 ajax 行为事件修复了它。

```
<p:dialog>
    <p:ajax event="open" update="myTableId" onstart="PF('myTable').clearFilters();" />

    <p:dataTable id="myTableId" widgetVar="myTable" ... >
        ...
    </p:dataTable>
</p:dialog> 
```

# php - XMLHttpRequest 对象的 open 方法的相对路径

> ID：14863828
> 
> 赞同：4
> 
> 时间：2013-02-13T21:50:02.410
> 
> 标签：php, javascript, ajax, path

在包含 Ajax 请求的 JavaScript 文件中，URL 与什么相关？我有包含目录 alpha 和 bravo 的 www 目录。alpha 中的 JavaScript 文件和包含它的 HTML 文件，以及处理请求的 PHP。

在我拥有的 JavaScript 文件中，`xmlhttp.open("GET", "CheckServer.php?name="+name,true);`但我认为不`CheckServer.php`正确。我试过`../bravo/CheckServer.php`了，但它不起作用。

我没有使用 JQuery，我使用的是 WAMP。

另外，是否有任何故障排除工具可以用来查看是否首先访问了用于处理请求的 PHP 页面？

编辑：我打开了控制台，它说我在 JavaScript 文件中调用的函数没有定义。这只发生在我将 .js 文件移动到其他目录时。（我适当地修改了`<script>`标签：`<script type="text/javascript" src="../alpha/Check.js">`.

编辑 2：我认为 WAMP 存在问题，因为我将完全相同的文件/文件夹复制到桌面并且一切正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T21:51:17.107

它是相对的，基于调用它的页面的当前位置。它与从何处加载 JavaScript 无关。

打开控制台并查看 Ajax 请求 [控制台或网络选项卡]，您将看到它正在请求的路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T22:02:20.330

*这是一个 URL，与目录*本身无关。它们可能被映射到服务器上的目录，并且通常是，但客户端永远无法确定并且不在乎。**URL**相对于当前URL **（**您在浏览器地址栏中看到的内容）。

所以，问题不是“CheckServer.php 在服务器上的位置”，而是“我如何从客户端访问它”。

如果是这样：

```
http://example.com/alpha/index.html
http://example.com/bravo/CheckServer.php 
```

美好的。使用相对 URL。

但如果是这样：

```
http://alpha.example.com/index.html
http://bravo.example.com/CheckServer.php 
```

然后它变得复杂。您将不得不研究[CORS](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)（跨域资源共享），因为 AJAX 通常不适用于不同的域。

哦，如果 CheckServer.php 根本无法访问……您可能可以想象到答案。

# magento - Magento 事件记录未显示所有事件

> ID：14863830
> 
> 赞同：2
> 
> 时间：2013-02-13T21:50:20.163
> 
> 标签：magento

我在函数 dispatchEvent($name, $data) 下将这一行添加到 /app/Mage.php 中，就在 return 语句的上方：

```
 Mage::log($name, null, 'events.log'); 
```

但是，我的 events.log 仅显示 3 个不同的事件：

```
2013-02-13T21:46:21+00:00 DEBUG (7): resource_get_tablename
2013-02-13T21:46:21+00:00 DEBUG (7): core_collection_abstract_load_before
2013-02-13T21:46:21+00:00 DEBUG (7): core_collection_abstract_load_after 
```

这三个只是一遍又一遍地重复。没有其他事件名称出现。这是否意味着其他事件没有以某种方式触发？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-14T14:16:42.400

我想出了解决方案。使用有问题的代码行，在有问题的文件和函数中，系统 > 配置 > 高级 > 开发人员 > 日志设置 > 启用日志记录设置为“否”，我只得到问题中列出的三个事件，输出到日志文件。

如果我将该设置设置为“是”，那么我会得到每个被触发的事件。这似乎是“对愚蠢问题的明显回答”，但由于我将日志记录代码硬编码到处理事件的函数中，所以我看不出日志记录设置的重要性。为什么 dispatchEvent() 会根据日志设置获得完全不同的输入？无论日志记录设置如何，它都不需要事件的名称吗？但是，唉，我对 Magento 还很陌生，还没有完全理解其中的想法。

我发现的另一件事是：添加了那一行 Mage:log 代码后，每当我在配置中保存设置时，页面 500 的设置都会被保存。我对此并不担心。

**TL;DR**：在系统 > 配置 > 高级 > 开发人员 > 日志设置下将“启用日志记录”设置为“是”，然后将代码行添加到 dispatchEvent()。

# php - 使用类扩展时超出了致命的允许内存大小

> ID：14863832
> 
> 赞同：0
> 
> 时间：2013-02-13T21:50:23.387
> 
> 标签：php, class, methods, extend, public-method

当我使用很多类扩展时，我得到这个错误：

`Fatal error: Allowed memory size of 134217728 bytes exhausted (tried to allocate 65488 bytes) in C:\Web\private\bootstrap.php on line 5`（我确保这实际上是下面代码的行。我的原始代码是第 22 行。）

这是我的代码（大量删节，但仍然会产生错误。我的原始代码有`this->this`6 层！）。

```
class test { // Root class.
    public $system;
    function __construct() {
        $this->system = new system();
    }
}
class system extends test { // System classes and methods.
    public function demo($string = 0){echo $string;}
}
$test = new test();
$test->system->demo("hello"); 
```

这应该只输出一个`hello`，但不幸的是它会抛出错误。是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:53:58.820

递归

当您实例化时`system`，您正在扩展`test`调用该方法的`__construct()`方法，而该方法又创建了一个新`system`对象，该对象扩展`test`并调用了`__construct()`等等。

如果extends ，你为什么要`system`在你的类中创建一个新对象？`test``system``test`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T21:54:16.520

您的代码导致无限循环的递归。

当你创建一个新的 Test 时，它会创建一个新的 System，它调用 Test 的构造函数（因为它正在继承它），它会创建一个新的 System ...重复。

如果您从系统中删除了继承，那么它将正常工作。

```
class system { // System classes and methods.
    public function demo($string = 0){echo $string;}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T22:05:15.720

您正在创建一个无限循环。

当您尝试实例化`new test()`. 您的构造函数创建一个新的系统对象（它本身是一个测试对象，然后您将实例化另一个系统对象并不断地实例化，直到您耗尽内存。

如果你不需要系统对象来实例化一个新的系统对象，你应该重写构造函数（甚至是一个空函数）。

# java - 这在我的通用方法中是否安全？

> ID：14863839
> 
> 赞同：5
> 
> 时间：2013-02-13T21:51:13.000
> 
> 标签：java, generics, casting, type-safety

我的项目中有如下代码：

```
public interface Bar<T extends Foo<?>> {
 //...
}

public class MyFoo implements Foo<String> {
    private List<Bar<Foo<String>> barFoo = ...

    public <U extends Foo<String>> boolean addBar(Bar<? extends U> b) {
        barFoo.add((Bar<Foo<String>>) b); //safe cast?
    }

} 
```

Eclipse 对演员表发出警告，`addBar`指出演员表不安全。但是，鉴于我对类型参数施加的限制，我是否正确地假设强制转换不会抛出，因此强制转换确实是安全的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T22:06:57.907

一般不会。

假设`Bar`有一个方法，和`void get(T value)`有两种实现。现在假设调用者调用了 type 的值。这有效：当=时，我们有那是 的子类型。现在我们将该值转换为 a 。`Foo<String>``MyFoo``YourFoo``addBar``Bar<MyFoo>``U``Foo<String>``Bar<MyFoo>``Bar<? extends U>``Bar<Foo<String>>`

现在如果`Bar`没有接受`T`'s 作为参数的方法，那就没有问题了。但是假设它有一个方法`void process(T value)`。我们调用的实现有`T`= `MyFoo`，所以它只有一个`process(MyFoo value)`方法。但是，一旦我们将它转​​换为 a `Bar<Foo<String>>`，我们可能会用 a`YourFoo`来调用它。这是非法的。

在黑暗中刺伤，但我怀疑你真正想做的是声明`barFoo`为`List<? extends Bar<? extends Foo<String>>`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T22:00:27.173

这不是一个安全的演员阵容。日食是正确的。

想象一下，您有一个`MyFoo`扩展的类，并且当仅编译了签名时`Foo`，您传入了带有签名的`Bar<MyFoo<String>>`Now some 方法，因此方法查找将失败。`Bar``myMethod(Foo x)``myMethod(MyFoo x)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T22:08:20.460

演员表是不安全的*，*因为虽然`U`extends `Foo<String>`，它*不是*（必然）情况是`Bar<U>`extends `Bar<Foo<String>>`。事实上，只有当它们是相同的东西时`Bar<U>`才会扩展`Bar<Foo<String>>`，即 when `U`is `Foo<String>`。

直觉上，看起来（例如）`List<String>`应该是 的子类型`List<Object>`，但这不是泛型的工作方式。`List<String>`是 的子类型`List<? extends Object>`，但*不是*的子类型`List<Object>`。（考虑这样的例子可能更有意义`Comparable<T>`：`Comparable<String>`表示“可以与任何比较`String`，而`Comparable<Object>`表示“可以与任何比较`Object`”。应该清楚，`Comparable<String>`不应该是 的子类型`Comparable<Object>`。）

> […] 演员不会投掷 […]，因此演员确实是安全的？

我认为您误解了警告的性质。*Eclipse 警告您，即使它应该*抛出这个演员表也不会抛出，这实际上*就是*它不安全的原因。例如，这段代码：

```
final Object o = Integer.valueOf(7);
final String s = (String) o; 
```

是完全安全的，因为演员表会抛出异常。但是这段代码：

```
final List<?> wildcardList = new ArrayList<Integer>(Integer.valueOf(7));
final List<String> stringList = (List<String>) wildcardList; 
```

是*unsafe*，因为运行时无法检查强制转换（由于擦除），所以即使它是错误的，它也不会抛出异常：`stringList`现在是 a `List<String>`，其第一个元素是 type `Integer`。（发生的事情是，在稍后的某个时候，`ClassCastException`当您尝试使用该元素做某事时，您会变得自发。）

# wpf - MSDN 示例和缺少 SDKSample

> ID：14863840
> 
> 赞同：2
> 
> 时间：2013-02-13T21:51:16.797
> 
> 标签：wpf, xaml

在 MSDN 示例中，有时我看到它指向一个 SDK 或库，但没有任何指向 SDK 的链接或指针可供下载。这是一般风格还是我遗漏了什么......

以下只是一个示例：

```
<Window x:Class="SDKSample.Window1"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="HierarchicalDataTemplate Sample"
        xmlns:src="clr-namespace:SDKSample">
  <DockPanel>
    <DockPanel.Resources>
      <src:ListLeagueList x:Key="MyList" />
      <HierarchicalDataTemplate DataType="{x:Type src:League}"
                                ItemsSource="{Binding Path=Divisions}">
        <TextBlock Text="{Binding Path=Name}" />
      </HierarchicalDataTemplate>
      <HierarchicalDataTemplate DataType="{x:Type src:Division}"
                                ItemsSource="{Binding Path=Teams}">
        <TextBlock Text="{Binding Path=Name}" />
      </HierarchicalDataTemplate>
      <DataTemplate DataType="{x:Type src:Team}">
        <TextBlock Text="{Binding Path=Name}" />
      </DataTemplate>
    </DockPanel.Resources>
    <Menu Name="menu1"
          DockPanel.Dock="Top"
          Margin="10,10,10,10">
      <MenuItem Header="My Soccer Leagues"
                ItemsSource="{Binding Source={StaticResource MyList}}" />
    </Menu>
    <TreeView>
      <TreeViewItem ItemsSource="{Binding Source={StaticResource MyList}}"
                    Header="My Soccer Leagues" />
    </TreeView>
  </DockPanel>
</Window> 
```

我正在 MSDN [http://msdn.microsoft.com/en-us/library/system.windows.hierarchicaldatatemplate.aspx](http://msdn.microsoft.com/en-us/library/system.windows.hierarchicaldatatemplate.aspx)上查看这个 xaml 代码， 这一切都很好，但我遇到的问题是我在哪里可以找到 SDKSample 类?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2020-05-19T06:07:48.947

可以在以下路径中找到此数据，其中所有示例及其备份文件都托管在 GitHub 上。

[WPF-Samples->数据绑定->HierarchicalDataTemplate](https://github.com/microsoft/WPF-Samples/blob/fbee9021ef17407bc3aaa79ff282f25178a0c4af/Data%20Binding/HierarchicalDataTemplate/ListLeagueList.cs)

可以在存储库中搜索特定文件名以找到其确切位置，并且可以下载或复制相同的文件名。MSDN 文档中给出的命名空间可能与示例存储库中使用的命名空间不匹配，但始终可以更改并且需要相应地更新引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:57:52.893

`xmlns:src="clr-namespace:SDKSample"`是对用于文档的主要项目的引用。您可以看到这一点，因为`Window1`使用了相同的命名空间：`<Window x:Class="SDKSample.Window1"`

但是，我看不到下载整个文档项目的方法。您必须自己创建课程`ListLeagueList`。幸运的是，有一个解释：

> 在以下示例中，`ListLeagueList`是`League`对象列表。每个`League`对象都有一个对象`Name`集合`Division`。每个对象都有`Division`一个`Name`和 一个对象集合`Team`，每个 `Team`对象都有一个`Name`.

# monocross - VS2012 的 Monocross 模板

> ID：14863844
> 
> 赞同：0
> 
> 时间：2013-02-13T21:51:25.123
> 
> 标签：monocross

有没有 VS2012 的 Monocross 模板的计划目前我只能下载 VS2010 的模板。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-14T16:52:39.910

Stackoverflow 真的是关于代码问题的问答。

对于有关产品路线图的问题，您最好查看各个项目讨论组。

对于 monocross，这意味着要问：

*   他们的邮件列表 - [https://groups.google.com/forum/?fromgroups#!forum/monocross-developers](https://groups.google.com/forum/?fromgroups#!forum/monocross-developers)
*   他们的推特账户 - [https://twitter.com/Monocross_net](https://twitter.com/Monocross_net)

# c++ - 使用 boost::hash_value 在 C++11 中定义 std::hash

> ID：14863848
> 
> 赞同：3
> 
> 时间：2013-02-13T21:51:41.053
> 
> 标签：c++, c++11, boost, hash, stdhash

是否有一种简单的方法可以使用 C++11 和 Boost 执行以下操作：

*   `std::hash`使用任何可用的标准定义`<functional>`
*   用于在那些缺少但在 中可用的情况下`boost::hash_value`定义。`std::hash``std::hash``boost::hash_value``<boost/functional/hash.hpp>`

例如：

*   `std::hash<std::vector<bool>>`应该来自标准库，
*   `std::hash<std::vector<unsigned>>`应该用`boost::hash_value`.

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-14T23:05:36.337

想到的第一个想法是使用 SFINAE 并尽可能尝试`std::hash<>`，否则使用`boost::hash_value()`，如下所示：

```
#include <string>
#include <functional>
#include <type_traits>
#include <boost/functional/hash.hpp>

struct my_struct_0 {
    std::string s;
};

template <typename T>
struct has_std_hash_subst { typedef void type; };

template <typename T, typename C = void>
struct has_std_hash : std::false_type {};

template <typename T>
struct has_std_hash<
    T,
    typename has_std_hash_subst<decltype( std::hash<T>()(T()) ) >::type
> : std::true_type {};

template <typename T>
static typename std::enable_if<has_std_hash<T>::value, size_t>::type
make_hash(const T &v)
{
    return std::hash<T>()(v);
}

template <typename T>
static typename std::enable_if<(!has_std_hash<T>::value), size_t>::type
make_hash(const T &v)
{
    return boost::hash_value(v);
}

int main()
{
    make_hash(std::string("Hello, World!"));
    make_hash(my_struct_0({ "Hello, World!" }));
} 
```

不幸的是，总是有`std::hash`触发`static_assert`失败的默认特化。其他库可能不是这种情况，但 GCC 4.7.2 就是这种情况（请参阅 参考资料`bits/functional_hash.h:60`）：

```
 /// Primary class template hash.
  template<typename _Tp>
    struct hash : public __hash_base<size_t, _Tp>
    {
      static_assert(sizeof(_Tp) < 0,
                    "std::hash is not specialized for this type");
      size_t operator()(const _Tp&) const noexcept;
    }; 
```

所以上面的 SFINAE 方法是行不通的——`static_assert`因为有一个阻碍。因此，您无法真正确定何时`std::hash`可用。

现在，这并不能真正回答您的问题，但可能会派上用场——可以反过来做这个技巧——首先检查 Boost 实现，然后才回退到`std::hash<>`. 考虑下面的例子，`boost::hash_value()`如果它可用（即 for`std::string`和`my_struct_0`），否则使用`std::hash<>`（即 for `my_struct_1`）：

```
#include <string>
#include <functional>
#include <type_traits>
#include <boost/functional/hash.hpp>

struct my_struct_0 {
    std::string s;
};

struct my_struct_1 {
    std::string s;
};

namespace boost {
size_t hash_value(const my_struct_0 &v) {
    return boost::hash_value(v.s);
}
}

namespace std {
template <>
struct hash<my_struct_1> {
    size_t operator()(const my_struct_1 &v) const {
        return std::hash<std::string>()(v.s);
    }
};

}

template <typename T>
struct has_boost_hash_subst { typedef void type; };

template <typename T, typename C = void>
struct has_boost_hash : std::false_type {};

template <typename T>
struct has_boost_hash<
    T,
    typename has_boost_hash_subst<decltype(boost::hash_value(T()))>::type
> : std::true_type {};

template <typename T>
static typename std::enable_if<has_boost_hash<T>::value, size_t>::type
make_hash(const T &v)
{
    size_t ret = boost::hash_value(v);
    std::cout << "boost::hash_value(" << typeid(T).name()
              << ") = " << ret << '\n';
    return ret;
}

template <typename T>
static typename std::enable_if<(!has_boost_hash<T>::value), size_t>::type
make_hash(const T &v)
{
    size_t ret = std::hash<T>()(v);
    std::cout << "std::hash(" << typeid(T).name()
              << ") = " << ret << '\n';
    return ret;
}

int main()
{
    make_hash(std::string("Hello, World!"));
    make_hash(my_struct_0({ "Hello, World!" }));
    make_hash(my_struct_1({ "Hello, World!" }));
} 
```

希望能帮助到你。

更新：也许您可以使用@ChristianRau 指出的[此处描述的技巧，并使第一个 SFINAE 方法起作用！](https://stackoverflow.com/questions/12753997/check-if-type-is-hashable)虽然很脏:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T23:04:02.457

我的答案可能不正确，但我会尝试解释为什么我认为答案是否定的。

我不认为可以互换使用`std::hash<T>`，`boost:hash<T>`所以我尝试隐藏对象创建（即使这不是完美的解决方案），并返回它们的结果，即 size_t。方法当然应该在编译时选择，所以我想到的是函数调度，示例代码：

```
template <typename T>
size_t createHash(const T& t, false_type)
{
    return boost::hash<T>()(t);
}

template <typename T>
size_t createHash(const T& t, true_type)
{   
    return std::hash<T>()(t);
}

template<typename T>
size_t createHash(const T& t)
{
    return createHash<T>(t, std::is_XXX<T>::type());
}

int main() 
{
    vector<unsigned> v; v.push_back(1);
    auto h1 = createHash(v);
    cout << " hash: " << h1;
    //hash<vector<unsigned> > h2;
} 
```

这段代码的想法很简单：如果你可以构造 type 的 type `std::hash<T>`，选择第二个实现，如果不能 - 选择第一个。

如果选择第一个实现，代码编译没有问题，你可以使用 fe 进行检查。`std::is_array<T>::type()`在包装函数中，这当然不是真的，所以会选择 boost::hash 实现。但是，如果您使用将返回 a 的特征`true_t`，`vector<unsigned>`例如 fe。`std::is_class<T>::type()`然后编译器将报告“C++ 标准不提供...”，这是`static_assert`.

为此，我们需要强制编译器返回`true_t`一个类型是否真的可构造（它不会使 static_assert 失败）并且`false_t`如果它没有。但是，我不认为有可能做到这一点。

# r - OOB错误率与混淆矩阵的一致性

> ID：14863851
> 
> 赞同：1
> 
> 时间：2013-02-13T21:51:46.450
> 
> 标签：r, random-forest

在检查我的模型的统计数据时，看起来 中的数字与 in 中的数字`confusion matrix`不一致。 `OOB error rate``randomForest`

**如何从混淆矩阵中推导出 OOB 错误率？**他们之间是什么关系？

在下面的示例中，我打印了两个模型的输出，一个适合分层抽样（使用 中的样本子集`sampsize`），另一个不适合（即使用默认抽样方案，我认为它使用所有样本） .

                        ![在此处输入图像描述](../Images/791fabd0de0d1fcccb50a4a090628594.png)

我没有公开数据，但这里是函数调用：

```
sumY = summary(Y)
sampsize <- c(sumY["Y0"]/10, sumY["Y1"])

# First model in the image above
strat.rf.model <- randomForest(x=X,y=Y,sampsize=sampsize, strata=Y)

# Second model in the image above    
rf.model <- randomForest(x=X,y=Y) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-13T23:46:53.970

这不是不一致的，它只是算术：

```
> 180 / (1699 + 180)
[1] 0.09579564
> 63 / (63 + 58)
[1] 0.5206612
> (180 + 63) / (1699 + 180 + 63 + 58)
[1] 0.1215 
```

每个类中的错误率定义为该类中错误分类的观察值的比例，而总体错误分类率是整个数据集的错误分类观察值的比例。

每个类的错误率很少与整体错误率完全匹配。如果你停下来想一想，这是完全有道理的：有些类将比其他类更难识别，然后总体错误率是某种“平均”。

# css - CSS - 在其他 div 周围浮动子 div

> ID：14863852
> 
> 赞同：4
> 
> 时间：2013-02-13T21:51:51.957
> 
> 标签：css, html, css-position

我想根据其他子 div 的高度动态调整子 div 的宽度。很难解释，所以我只展示一些图片......

在这第一张图片中，黑色方块是我的“父”div。它包含其他高度不同的 div。蓝色 div 的高度是静态的，但必须向右浮动。红色 div 是我遇到的问题。如果它们出现在蓝色 div 的底部下方，它们应该会自动调整自己的宽度。

第二个高度小的红色 div。查看最后一个 div 如何适合父 div 的宽度。 ![http://i.imgur.com/jAn3nNg.png](../Images/5d6fc5e0634de2be1f3d5c7f3b394b79.png)

第二个高度较大的红色 div。现在两个底部 2 div 的宽度都适合父 div。 ![http://i.imgur.com/GDQjnNX.png](../Images/51df5531e9f3cc485235836d3b56ee28.png)

再举一个例子……
![http://i.imgur.com/H24E4Tj.png](../Images/1e95c9fb2d5516dbfded67aa75d11d3e.png)

我不确定我是否应该使用特殊定位，或者如何构建 div。如果蓝色 div 下方有一点空间就可以了，我只想在红色 div 之间留出等量的空间。

这有点像我设置的。看到黄色的 div 隐藏在右边的蓝色 div 后面：http: [//jsfiddle.net/MVzHS/1/](http://jsfiddle.net/MVzHS/1/)

```
#floatRight {
   width: 100px;
   height:200px;
   background-color:blue;
   position: absolute;
   right:10px;
   top:10px;
} 
```

解决方案：http: [//jsfiddle.net/MVzHS/3/](http://jsfiddle.net/MVzHS/3/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T22:04:20.263

您可以通过`float: right`在蓝色框上使用并`overflow: hidden`在红色框上设置 来做到这一点。

看看这个[jsFiddle](http://jsfiddle.net/dsundy/8HaLB/)的例子。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:07:35.573

**HTML**

```
<div id="parent">

    <div id="blue">Blue content here</div>

    <div id="red">Red 1 content here
    <br>more content
    <br>more content
    <br>more content
    <br>more content
    <br>more content</div>

    <div id="red">Red 2 content</div>
    <div id="red">Red 3 content</div>

</div> 
```

**CSS**

```
#parent
{
    border: 1px solid black;
    height: 100%;
}

#blue
{
    float: right;
    border: 1px solid blue;
    height: 100px;
    margin-left: 10px;
}

#red
{
    border: 1px solid red;
    overflow: hidden;
    margin-bottom: 10px;
} 
```

JS Bin 在这里可用：http: [//jsbin.com/irubuy/5](http://jsbin.com/irubuy/5)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T22:08:20.100

如果在源代码中您首先添加蓝色 div 并将其浮动，这应该做您想要/需要它做的事情吗？

```
.black {
    width:958px;
    padding:10px;
    border:1px solid #000;
    float:left;
}
.blue {
    width:248px;
    height:400px;
    border:1px solid #00f;
    float:right;
    margin:0 0 10px 30px;
}
.red {
    border:1px solid #f00;
    margin:0 0 10px;
} 
```

[http://jsfiddle.net/seemly/BTxgJ/](http://jsfiddle.net/seemly/BTxgJ/)

我在提供的小提琴中发现的唯一“问题”是 div 本身有点相交，但其中的内容按应有的方式包装。如果使用边框、背景颜色或背景图像，我不确定这将如何显示。这有帮助吗？

# jquery - gmap3：如何获得拒绝的本地化事件？

> ID：14863857
> 
> 赞同：0
> 
> 时间：2013-02-13T11:36:40.313
> 
> 标签：jquery, geolocation, google-maps

我正在使用 gmap3.js（jQuery 插件）的 getgeoloc
[http://gmap3.net/en/catalog/14-services/getgeoloc-54](http://gmap3.net/en/catalog/14-services/getgeoloc-54)

```
$('#test1').gmap3({
    getgeoloc:{
      callback : function(latLng){
        if (latLng){
          $(this).gmap3({
            marker:{ latLng:latLng }
          });
        }else{
          alert('browser didn't find the position.');
        }
      }
    }   
}); 
```

如果用户拒绝浏览器的地理定位。
我怎样才能得到那个事件？

“if (latLng)”的“else”仅在浏览器找不到用户位置的情况下使用。但是如果用户点击“拒绝位置”？

有人有同样的问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T23:22:48.470

解决了。
问题仅在带有 chrome 的本地服务器上。在线使用 if{}else{} 可以正常工作

# vim - Vim：如何确定键映射设置的位置/时间？

> ID：14863858
> 
> 赞同：3
> 
> 时间：2013-02-13T21:52:05.037
> 
> 标签：vim, configuration, editor, mapping, keyboard-shortcuts

我在`:map`要删除的输出中找到了一个映射，但我不知道映射的设置位置。

有没有办法找出映射设置的位置/时间以便我可以删除它？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-13T22:16:59.573

使用这个命令：

```
:verbose map <key> 
```

# ruby - “/”之间的某些符号是什么意思？

> ID：14863859
> 
> 赞同：1
> 
> 时间：2013-02-13T21:52:06.810
> 
> 标签：ruby, regex

我找到了这些，但我对编程太陌生，无法正确理解这一点。此外，你不能真正用谷歌搜索这些东西：

```
/SUFIX ([\[\]\w]+)/i
/ENEMY ([^>,;]+)/i
/RED ([+-]?\d+)/i 
```

我知道它们与字符串有关，而且我很确定这些`"/i"`字符的含义可以是任何情况，但我不知道其余的含义是什么。

谁能解释这些做什么，或将我链接到文档？希望这不是自定义符号等。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T21:53:31.053

这定义了一个*正则表达式*，您可以使用它来匹配文本或执行高级替换。[您会在Ruby 文档](http://www.ruby-doc.org/core-1.9.3/Regexp.html)中找到更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:42:36.070

快速浏览一下，这些模式的含义如下：

```
/SUFIX ([\[\]\w]+)/i 
```

这是寻找一些文本，如其中之一：

```
SUFIX [123]
sufix [abc]
SuFiX [a1]
SUFIX [foo_bar]
SUFIX [1] 
```

但不匹配：

```
SUFIX [] 
```

这：

```
/ENEMY ([^>,;]+)/i 
```

寻找：

```
ENEMY foo
enemy bar
Enemy 123foo456bar 
```

但不会匹配任何内容`>`，`,`或`;`跟随它：

```
ENEMY >
ENEMY ,
ENEMY ; 
```

都会失败。

这：

```
/RED ([+-]?\d+)/i 
```

会很高兴：

```
RED 1
red +10
ReD -5 
```

`+`并且对任何不是可选的/`-`后跟数字的东西都不满意。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-14T00:48:11.673

学习正则表达式的更好方法之一是使用[http://www.rubular.com/](http://www.rubular.com/)之类的东西 Rubular 是一个基于 Ruby 的正则表达式编辑器。这是在编写正则表达式时测试它们的便捷方法。

# javascript - Kendo TreeView：你可以在没有完整树更新的情况下编辑单个数据项吗？

> ID：14863862
> 
> 赞同：0
> 
> 时间：2013-02-13T21:52:20.880
> 
> 标签：javascript, kendo-ui, kendo-treeview

我目前正在使用 kendo v2012.3.1315 运行，并且正在尝试在树视图中编辑特定节点，而无需完整的树视图更新。

我希望能够编辑名称并让它反映在树上以及对数据项的任何访问。现在，我已经能够覆盖 html，但是 a）这可能会由于模板更改而改变，并且 b）当我稍后访问数据项时，它仍然具有旧文本。

这种所需功能的原因有两个：性能和一致的用户界面。

有谁知道这是否可能？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T09:58:44.007

在树中找到元素并将其更新`.html()`为与重绘树时相同的值。

# android - SharedPreferences 返回 null，即使它具有默认值

> ID：14863864
> 
> 赞同：2
> 
> 时间：2013-02-13T21:52:28.540
> 
> 标签：android, null, nullpointerexception, sharedpreferences

我有我的主要活动，它从 SharedPreferences 中保存和加载一些数据......直到现在我已经能够做到这一点。

这些是我的 onCreate、onPause 和 OnResume 方法。

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    setTitle(R.string.title_activity_main);

    this.spinner = (Spinner) findViewById(R.id.geomObject);
    this.sbWidth = (SeekBar) findViewById(R.id.widthSB);
    this.sbDepth = (SeekBar) findViewById(R.id.depthSB);
    this.sbHeight = (SeekBar) findViewById(R.id.heightSB);
    this.widthProgress = (TextView) findViewById(R.id.widthDisplay);
    this.depthProgress = (TextView) findViewById(R.id.depthDisplay);
    this.heightProgress = (TextView) findViewById(R.id.heightDisplay);

    ...more code...
}

protected void onResume() {
    super.onResume();
    loadPrefs();
}

protected void onPause() {
    super.onPause();
    savePrefs();
} 
```

这些是我做大部分工作的方法，所以我可以保持 onX 方法干净：

```
private void savePrefs() {
    this.width = this.sbWidth.getProgress();
    this.depth = this.sbDepth.getProgress();
    this.height = this.sbHeight.getProgress();
    this.forma = this.spinner.getSelectedItemPosition();

    getSharedPreferences("SEEKBARS", MODE_PRIVATE).edit().putInt("width", width).commit();
    getSharedPreferences("SEEKBARS", MODE_PRIVATE).edit().putInt("depth", depth).commit();
    getSharedPreferences("SEEKBARS", MODE_PRIVATE).edit().putInt("height", height).commit();
    getSharedPreferences("SEEKBARS", MODE_PRIVATE).edit().putInt("forma", forma).commit();
    getSharedPreferences("LOCKBARS", MODE_PRIVATE).edit().putBoolean("lockbars", menuLock.isChecked()).commit();
}

private void loadPrefs() {
    int savedSpinner = getSharedPreferences("SEEKBARS", MODE_PRIVATE).getInt("forma", SPINNER_DEFAULT);
    int savedWidth = getSharedPreferences("SEEKBARS", MODE_PRIVATE).getInt("width", SEEKBAR_DEFAULT);
    int savedDepth = getSharedPreferences("SEEKBARS", MODE_PRIVATE).getInt("depth", SEEKBAR_DEFAULT);
    int savedHeight = getSharedPreferences("SEEKBARS", MODE_PRIVATE).getInt("height", SEEKBAR_DEFAULT);

    boolean savedLockFlag = getSharedPreferences("LOCKBARS", MODE_PRIVATE).getBoolean("lockbars", false);

    this.spinner.setSelection(savedSpinner);
    this.sbWidth.setProgress(savedWidth);
    this.sbDepth.setProgress(savedDepth);
    this.sbHeight.setProgress(savedHeight);
//This is the line raising the exception Display:
        this.menuLock.setChecked(savedLockFlag); 

        this.widthProgress.setText(String.valueOf(savedWidth) + " " + getResources().getString(R.string.blocks));
        this.depthProgress.setText(String.valueOf(savedDepth) + " " + getResources().getString(R.string.blocks));
        this.heightProgress.setText(String.valueOf(savedHeight) + " " + getResources().getString(R.string.blocks));
    } 
```

我看不出错误在哪里。我一直在寻找，我知道我不能在 onCreate 上调用 getSharedPreferences，这就是我在 onResume 上这样做的原因。怎么了？

我还附上了logcat，以防万一：

```
FATAL EXCEPTION: main
java.lang.RuntimeException: Unable to resume activity {es.nirvash.android.msg/es.nirvash.android.msg.MainActivity}: java.lang.NullPointerException
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2567)
    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2595)
    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2109)
    at android.app.ActivityThread.access$600(ActivityThread.java:132)
    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1157)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.app.ActivityThread.main(ActivityThread.java:4575)
    at java.lang.reflect.Method.invokeNative(Native Method)
    at java.lang.reflect.Method.invoke(Method.java:511)
    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
    at dalvik.system.NativeStart.main(Native Method)
Caused by: java.lang.NullPointerException
    at es.nirvash.android.msg.MainActivity.loadPrefs(MainActivity.java:231)
    at es.nirvash.android.msg.MainActivity.onResume(MainActivity.java:147)
    at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1154)
    at android.app.Activity.performResume(Activity.java:4539)
    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2557)
    ... 12 more 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T21:55:11.463

问题不是你的布尔值，而是变量`menuLock`。`boolean`（原始类型）不能是`null`.

找到`menuLock`声明的地方，并确保它有一些东西可以坚持。这样，当你使用它时它就不会为空。当然，如果它是 a `View`，请为其分配一些东西以保留 in `onCreate()`, after `setContentView()`，因为它具有 Activity 布局和创建保证。

# ef-code-first - 实体框架 - 代码优先 - TPH 和 WillCascadeOnDelete(true)

> ID：14863866
> 
> 赞同：2
> 
> 时间：2013-02-13T21:52:30.910
> 
> 标签：ef-code-first, entity-framework-5, code-first, entity-relationship

使用 TPH 和`WillCascadeOnDelete(true)`. 当我在删除时为级联设置为 true 时，不会创建我的数据库。异常消息如下：

> *在表“MembersProfiles”上引入 FOREIGN KEY 约束“FK_dbo.MembersProfiles_dbo.Contacts_ContactId”可能会导致循环或多个级联路径。指定 ON DELETE NO ACTION 或 ON UPDATE NO ACTION，或修改其他 FOREIGN KEY 约束。*

为了清除这里的东西是我的模型和用于它的映射。

```
public class MemberProfile
{
   public Guid MemberProfileId { get; set; }
   public ICollection<Contact> Contacts { get; set; }
}

public abstract class Contact
{
   public Guid ContactId { get; set; }
   public Guid AddressId { get; set; }
   public Address Address { get; set; }
}

public class PersonContact : Contact
{
     public string Profession { get; set; }
     public string OrganizationName { get; set; }
}

public class OrganizationContact : Contact
{
     public string SalesPhone { get; set; }
     public string ServicePhone { get; set; }
}

public class ContactMap : EntityTypeConfiguration<Contact>
    {
        public ContactMap()
        {
            ToTable("Contacts");
            HasKey(c => c.ContactId);

            Property(c => c.ContactId).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
            Property(c => c.Name).IsRequired().HasMaxLength(50);
            Property(c => c.Email).IsRequired().HasMaxLength(150);
            Property(c => c.MobilePhone).IsRequired().HasMaxLength(15);
            Property(c => c.Description).IsOptional().HasMaxLength(500);
            Property(c => c.FixPhone).IsOptional().HasMaxLength(15);
            Property(c => c.FaxNumber).IsOptional().HasMaxLength(15);

            HasRequired(mp => mp.Address).WithMany().HasForeignKey(mp => mp.AddressId);
            HasRequired(mp => mp.Link).WithMany().HasForeignKey(mp => mp.LinkId);
            HasRequired(mp => mp.Image).WithMany().HasForeignKey(mp => mp.MediaId);
        }
    }

 public class PersonContactMap : EntityTypeConfiguration<PersonContact>
 {
        public PersonContactMap()
        {
            Property(pc => pc.Profession).IsOptional().HasMaxLength(150);
            Property(pc => pc.OrganizationName).IsOptional().HasMaxLength(150);

            Map(pc => pc.Requires("Discriminator").HasValue("PersonContact").HasColumnType("nvarchar(max)"));                }
    }

public class OrganizationContactMap : EntityTypeConfiguration<OrganizationContact>
{
        public OrganizationContactMap()
        {
            Property(oc => oc.SalesPhone).IsOptional().HasMaxLength(15);
            Property(oc => oc.ServicePhone).IsOptional().HasMaxLength(15);

            Map(oc => oc.Requires("Discriminator").HasValue("OrganizationContact").HasColumnType("nvarchar(max)"));
        }
}

public class MemberProfileMap : EntityTypeConfiguration<MemberProfile>
{
        public MemberProfileMap()
        {
            ToTable("MembersProfiles");
            HasKey(mp => mp.MemberProfileId);

            Property(mp => mp.MemberProfileId).HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity);
            Property(mp => mp.Name).IsRequired().HasMaxLength(50);
            Property(mp => mp.DateOfBirth).IsRequired();
            Property(mp => mp.Email).IsRequired().HasMaxLength(150);
            Property(mp => mp.MobilePhone).IsRequired().HasMaxLength(15);
            Property(mp => mp.Summary).IsOptional();

            HasRequired(mp => mp.Address).WithMany().HasForeignKey(mp => mp.AddressId).WillCascadeOnDelete(true);
            Property(mp => mp.AddressId).HasColumnName("AddressId");

            HasOptional(mp => mp.Media).WithMany().Map(mp => mp.MapKey(new[] { "MediaId" })).WillCascadeOnDelete(true);
            HasOptional(mp => mp.Tags).WithMany().Map(mp => mp.MapKey(new[] { "TagId" })).WillCascadeOnDelete(true);
            HasOptional(mp => mp.Contacts).WithMany().Map(mp => mp.MapKey(new[] { "ContactId" })).WillCascadeOnDelete(true);
        }
} 
```

不幸的是，我无法意识到我做错了什么......所以任何线索将不胜感激。

PS：我使用的是 EF 5.0 Code First

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:10:16.010

看看这个[BlogPost 是否有帮助。](http://weblogs.asp.net/manavi/archive/2011/05/17/associations-in-ef-4-1-code-first-part-6-many-valued-associations.aspx)，另一种选择我会尝试开始一个一个地添加关系，看看它在哪里中断，而不是一次堆叠所有东西。有时它有助于仅使用`individual property mappings`而不是`Fluent API`像您所做的那样。查看我上面提到的那个博客上的不同链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T22:23:57.873

好的，找到问题了。我有两个表引用地址表。在我的情况下，Contacts 和 MemberProfile 都持有对 Addresses 表的引用，并且在这两种情况下都打开了级联删除。一旦我关闭了其中一个关系的级联删除，一切正常。

# php - PHP-MySQL - 允许客户端定义进程、算法或查询

> ID：14863869
> 
> 赞同：0
> 
> 时间：2013-02-13T21:52:37.677
> 
> 标签：php, mysql, database-design

在我的网站中，我允许用户群组管理群组银行账户。用户报告说他们支付了该组应该资助的东西，并且该组帐户“还给他们”。

但是，我想让帐户管理员控制哪个用户支付什么以及何时支付。

例如，一群人共享一辆车。他们开设一个团体账户来处理与汽车相关的费用——汽油、维修等。

群组管理员决定本月只有开车超过 20 英里的人才能参与汽油账单，并且账单在付费用户（开车超过 20 英里的人）之间按照他们的里程（开车 60 英里的用户将支付两倍于驾驶 30 英里的用户的费用）。

我有一个表`users`（用户列表，每个用户都是组帐户的一部分），一个用于`group_accounts`和一个用于`expense_types`（在此示例中，`gas`并`maintenance`在此处列出）

**问题：**

是否有一种将**客户端定义的查询或算法存储在数据库**中的好方法，以允许组管理员创建复杂的计费方法，并（使用 PHP）随后检索和实现这些算法并计算结果？

这是一个数据库设计问题，所以就我而言，可以将额外的列添加到任何表、创建的新表、过程、触发器等。

**注意：具体示例没有真正的兴趣**，我希望我的系统能够处理未知复杂性的算法，这些算法使用来自未知表和列的数据。

# c# - C# 串口超时

> ID：14863881
> 
> 赞同：0
> 
> 时间：2013-02-13T21:53:28.203
> 
> 标签：c#, c, visual-c++, timeout, serial-port

我正在使用`C#`串行端口库与传感器和 PC 进行通信。`SerialPort.Read()`即使那里有数据，我也经常使用该方法超时。我使用串行嗅探器检查我是否在端口接收到所有数据包，但有些 .NET 没有选择所有数据包并超时。我正在读取字节，我收到的字节比串行端口缓冲区大小小 2112。我尝试了多种方法，现在考虑使用本机`C/C++`并在`C#`. 有人可以分享更多想法或`C/C++`在`C#`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:13:39.713

> 以 460800 到 921600 的波特率运行

这些是非常奇怪的波特率，相当高。显然，您没有使用 DataReceived 事件，因此调用 Read() 方法的频率变得相当关键。花一些时间做其他事情，包括 Windows 认为需要完成更重要的事情和上下文切换离开你的线程，接收缓冲区将很快溢出。不实现 SerialPort.ErrorReceived 事件是一个标准错误，因此您只是看不到那些溢出，您所看到的只是缺少数据。

用 C++ 编写这段代码不太可能带来缓解。串行端口只有一个 api，SerialPort 只是一个瘦包装器，它使用 winapi 函数，就像你的 C++ 代码一样。

因此，请采取以下所有步骤：

*   实现 ErrorReceived 事件，以便您*知道*发生溢出
*   喜欢使用 DataReceived 事件，这样您就不必依赖于调用 Read() 足够频繁
*   将 ReadBufferSize 设置为一个不错的大数字，以便驱动程序可以占用空间
*   设置 Handshake 属性，以便驱动程序可以告诉设备在缓冲区已满时停止发送
*   检查您是否可以实施协议，以便设备不只是给机器喷水
*   如果仍然不够可靠，请降低波特率。

# c++ - Qt 如何使用组合框选择更新 GUI QFrame

> ID：14863883
> 
> 赞同：0
> 
> 时间：2013-02-13T21:53:31.247
> 
> 标签：c++, qt, user-interface

我有一个组合框，其中包含不同命令类型的列表。我想根据组合框中的选定命令更改 GUI 上的可见输入字段。我对 Qt 很陌生，如果有人能指出我实现这一点的正确方向，我将不胜感激。

我目前的想法是有一个发出信号的“选择”按钮，连接的插槽将获取组合框的当前索引。我认为我需要实现一个自定义类来保存 QFrame。自定义类将包含指示哪些数据输入（对于所选命令）应显示在 QFrame 中的插槽。

IE，如果在组合框中选择了 COMMAND_1，则 QFrame 中显示 3 个输入字段。如果选择了 COMMAND_2，则在 QFrame 中显示一对单选按钮，并且这 3 个输入字段被隐藏或取消分配。

这是尝试解决此问题的好方法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T22:04:35.910

你正在以正确的方式去做。但 Qt 实际上比你想象的更容易。

您可以使用两个内置小部件：[QComboBox](https://qt-project.org/doc/qt-4.8/qcombobox.html)和[QStackedWidget](https://qt-project.org/doc/qt-4.8/qstackedwidget.html)。您熟悉组合框；堆叠的小部件是一组小部件，一次只会显示一个。它本质上是一个标签式小部件减去标签。

设置您的堆叠小部件，使其第一个小部件是您想要在组合框显示其第一个选项时显示的内容，第二个小部件显示第二个选项，依此类推。然后您可以将内置信号连接到内置插槽：[QComboBox::currentIndexChanged(int)](https://qt-project.org/doc/qt-4.8/qcombobox.html#currentIndexChanged)到[QStackedWidget::setCurrentIndex(int)](https://qt-project.org/doc/qt-4.8/qstackedwidget.html#currentIndex-prop)。

希望有帮助！

# c# - C# 标记派生类实例的最佳方法

> ID：14863886
> 
> 赞同：2
> 
> 时间：2013-02-13T21:53:44.600
> 
> 标签：c#, inheritance

假设您有一个名为 Food 的类，并且您有一个名为 Banana、Apple 和 Orange 的派生类。您在某处有一个 FoodProcessor 方法，在大多数情况下，它可以处理任何类型的食物，但有时需要知道它正在处理什么类型的食物，以便执行特定类型的操作，例如剥香蕉皮、去核苹果，或者挤橙子。

所以你的 FoodProcessor 接受 Food 参数。您的 FoodProcessor 检测 Food 实例的特定衍生类型的最佳方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:57:38.090

您应该使用多态性，每个`Food`子类将定义一个方法`process()`，并且`FoodProcessor`该类将简单地调用该方法。

食品加工机

```
public void process(Food f) {
    f.process(); 
} 
```

苹果

```
public void process() {
    Console.WriteLine("Core the apple.");
} 
```

香蕉

```
public void process() {
    Console.WriteLine("Peel the banana.");
} 
```

橙子

```
public void process() {
    Console.WriteLine("Squeeze the orange.");
} 
```

通过这种方式，您可以利用 Food 及其子类之间的继承关系。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T21:59:58.580

我会将其抽象化并在每种食物中实施：

```
abstract class Food {
    public abstract void Prepare();
}

class Banana : Food {
    public override void Prepare() {
        Peel();
    }
}

class Apple : Food {
    public override void Prepare() {
        Core();
    }
} 
```

然后你会有：

```
class FoodProcessor {
    public void Process(Food food) {
        food.Prepare(); // preparation of the food
        food.Process();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T22:00:23.200

在测试对象的类型时，我喜欢使用`is`关键字，像这样：

```
if(myFood is Bannana)
  Peel((Bannana)myFood); 
```

我更喜欢[`is`](http://msdn.microsoft.com/en-us/library/scekt9xw%28v=vs.71%29.aspx)它，因为它还会检查对象是否实现了接口。

说到接口，如果您有执行特定操作的某些类型，您可能需要考虑使用接口。检查特定类型需要了解可能使用的不同类型，但是，如果您检查接口，则可能会出现实现此接口的新类型，而无需更改代码来处理它们：

```
if(myFood is IPeelable)
  Peel((IPeelable)myFood)
else if(myFood is ICoreable)
  Core((ICoreable)myFood) 
```

如果您寻找特定的类型，您现在和将来都需要知道所有可能的类型，这不是很可扩展的。

这当然假设您不想使用直接多态性，正如其他答案之一所描述的那样。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-13T21:57:18.213

```
void FoodProcessor(Food food)
{
    if(food is Banana)
        ...
    else if(food is Apple)
        ...

    ...
    etc
} 
```

编辑：如果您可以使用其他答案中提到的多态性，则忽略此

# linux - Linux awk 命令不能正确打印整数？

> ID：14863890
> 
> 赞同：0
> 
> 时间：2013-02-13T21:54:02.970
> 
> 标签：linux, command

有人可以解释为什么这个命令不打印没有换行符的 PID 列表吗？我想要像这样的输出：

```
1234 5678 123 456 
```

我尝试了所有这些，但它们都不起作用

```
ps -eww --no-headers -o pid,args | grep 'usr' | awk '{ printf "%d ", $1 }'
ps -eww --no-headers -o pid,args | grep 'usr' | awk '{ printf "%s ", $1 }'
ps -eww --no-headers -o pid,args | grep 'usr' | awk '{ print $1 }' | tr '\n' ''
ps -eww --no-headers -o pid,args | grep 'usr' | awk '{ print $1 }' | tr -d '\n' 
```

我刚刚发现 bash 工作正常，但在我的情况下不是 zsh

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:08:48.980

`zsh`具有让用户知道最后一个输出行是部分输出的*功能*（即没有最后的换行符）。`PROMPT_CR`有关这方面的更多详细信息，您可以查找`PROMPT_SP`并`PROMPT_EOL_MARK`在[`man zshoptions`](http://linux.die.net/man/1/zshoptions).

您可以添加`PROMPT_EOL_MARK=''`到您`~/.zshrc`的部分以使部分行指示器为空，但我建议不要这样做：现在我们知道它只是一个功能，有时如果我们启用它，我们会注意到我们的数据存在问题。在相当强大的终端上，百分号（未设置时的默认值`PROMPT_EOL_MARK`）以**粗体**和反转输出，因此不会与实际输出混淆。

您的命令输出是完全符合您要求的 pid 列表。添加最后一个换行符使它看起来*也*正确`zsh`：

```
ps -eww --no-headers -o pid,args | awk '/usr/ { printf "%d ", $1 } END {print""}' 
```

（也使用另一个答案的想法摆脱`grep`使用的力量`awk`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T22:00:31.830

它对我来说是这样的：

```
ps -eww --no-headers -o pid,args | awk '/usr/{printf "%d ",$1}' 
```

即可以搜索匹配正则表达式的字符串，所以在使用的时候`awk`并不需要。`grep``awk`

# php - 表格在第二个之后切断页面

> ID：14863891
> 
> 赞同：0
> 
> 时间：2013-02-13T21:54:08.483
> 
> 标签：php, html, forms

我不知道为什么，但是我的桌子在第二个标签之后就被切断了`<td>`……谁能帮忙，我一直一遍又一遍地查看它。有人可以帮我找出问题所在吗？

```
<tr>
    <td>Username:</td>
    <td>
        <input name="username" type="text" value='<?
            if($form->value("username")==""){
                echo($req_user_info["username"]);
            }else{
                echo $form->value("username");
            }
        ?>' size="56" maxlength="30">
    </td>
    <td>
        <? echo($form->error("username")); ?>
    </td>
</tr>
<tr>
    <td>New Password:</td>
    <td>
        <input name="newpass" type="password" value='<?
            echo($form->value("newpass"));
        ?>' size="56" maxlength="30">
    </td>
    <td>
        <? echo($form->error("newpass")); ?>
    </td>
</tr> 
```

顺便说一句，该代码只是前两行。

```
<?php
error_reporting(E_ALL);
ini_set("display_errors", 1);
?>
<form action="adminprocess.php" method="POST">
<table align="left" border="0" cellspacing="0" cellpadding="3">
<tr>
<td>Username:</td>
<td>
    <input name="username" type="text" value='<?php
        if($form->value("username")==""){
            echo($req_user_info["username"]);
        }else{
            echo $form->value("username");
        }
    ?>' size="56" maxlength="30">
</td>
<td>
    <?php echo($form->error("username")); ?>
</td>
</tr>
<tr>
<td>New Password:</td>
<td>
    <input name="newpass" type="password" value='<?php
        echo($form->value("newpass"));
    ?>' size="56" maxlength="30">
</td>
<td>
    <?php echo($form->error("newpass")); ?>
</td>
</tr>
<tr>
<td>Confirm New Password:</td>
<td><input name="conf_newpass" type="password" value='
<?php echo $form->value("newpass"); ?>' size="56" maxlength="30"></td>
<td><?php echo $form->error("newpass"); ?></td>
</tr>
</tr>
<td>Edit motto:</td>
<td><input type="text" size="56" name="motto" value='<?php
if($form->value("motto") == ""){
echo $req_user_info['motto'];
}else{
echo $form->value("motto");
}
?>'></td>
<tr>
<tr>
<td>Edit profile bio:</td>
<td><textarea cols="40" rows="10" name="profile" value=""><?php
if($form->value("profile") == ""){
echo $req_user_info['profile'];
}else{
echo $form->value("profile");
}
?></textarea></td>
<tr>
<tr>
<td>Email:</td>
<td><input name="email" type="text" value='
<?php
if($form->value("email") == ""){
echo $req_user_info["email"];
}else{
echo $form->value("email");
}
?>' size="56" maxlength="50">
</td>
<td><?php echo $form->error("email"); ?></td>
</tr>
<tr>
<td>User level:</td>
<td><input name="userlevel" type="text" value='
<?php
if($form->value("userlevel") == ""){
echo $req_user_info["userlevel"];
}else{
echo $form->value("userlevel");
}
?>' size="4" maxlength="10"></td>
<td><?php echo $form->error("userlevel"); ?></td>
</tr>
<tr><td align="right">
<input type="hidden" name="subedit" value="1">
<input type="hidden" name="usertoedit" value="<?php echo $usertoedit; ?>">
<input type="submit" name="button" value="Edit Account">
</td>
<td colspan="2" style="text-align:right;">
<input type="submit" name="button" value="Delete" onclick="return confirm ('Are you sure you want to delete this user, this cannot be undone?\n\n' + 'Click OK to continue or Cancel to Abort!')">
</td>
</tr>
</table>
</form> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:02:55.270

我已经稍微改变了你的语法..

```
<tr>
<td>Username:</td>
<td><input name="username" type="text" value="<?php echo htmlspecialchars(($form->value("username")=="" ? $req_user_info["username"] : $form->value("username"))); ?>" size="56" maxlength="30"></td>
<td><?php echo $form->error("username"); ?></td>
</tr>
<tr>
<td>New Password:</td>
<td><input name="newpass" type="password" value="<?php echo htmlspecialchars($form->value("newpass")); ?>" size="56" maxlength="30"></td>
<td><?php echo $form->error("newpass"); ?></td>
</tr> 
```

对于额外的 php 错误日志，把它放在页面的顶部：

```
<?php
error_reporting(E_ALL);
ini_set("display_errors", 1);
?> 
```

# php - PHP/MySQL 只更新第一行 borkness

> ID：14863895
> 
> 赞同：0
> 
> 时间：2013-02-13T21:54:29.587
> 
> 标签：php, mysql, forms

我是 PHP/MySQL 的新手，但我决定制作某种接口来处理我商店的库存。我已经学到了很多东西，但现在我陷入了绝望。

此表格显示一组特定类型的库存和数量：

```
<form method="post" action="submit.php">
<?php
while ($row = mysql_fetch_assoc($rs)) { 
echo"<input type=\"hidden\" name=\"ovid[]\" value=" . $row['option_value_id'] . " />";
echo $row['name'];
echo"<input type=\"text\" name=\"quant[]\" value=" . $row['quantity'] . " />";
echo"<input type=\"submit\" /><br />";
} ?>
</form> 
```

这是submit.php：

```
$_POST['ovida'] = implode(",",$_POST['ovid']);
$_POST['quanta'] = implode(",",$_POST['quant']);

print $_POST["ovida"];
print $_POST["quanta"];

$ovidyay = $_POST["ovida"];
$quantyay = $_POST["quanta"];

$query = "UPDATE product_option_value SET quantity ='$quantyay' WHERE option_value_id = '$ovidyay'";
$rs = mysql_query( $query )
or die( mysql_error() ); 
```

当我按下提交时没有错误（有很多），但我唯一可以更新的条目是列表中的第一个。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:12:22.957

您可以分别迭代和更新每个项目：

```
for ($i = 0; $i < COUNT($_POST['ovid']); $i++)
{
    $ovidyay = $_POST['ovid'][$i];
    $quantyay = $_POST["quanta"][$i];

    $query = "UPDATE product_option_value SET quantity ='$quantyay' WHERE option_value_id = '$ovidyay'";
    $rs = mysql_query($query);
} 
```

此外，该代码容易受到 SQL 注入攻击，并且您正在使用已弃用的 MySQL php 函数。如果您确实想让您的代码变得更好，更不易受到攻击，请查看以下链接：

[为什么我不应该在 PHP 中使用 mysql_* 函数？](https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-functions-in-php)

[我可以用什么来代替 mysql_ 函数？](http://php.net/mysqli)

[准备好的陈述](http://en.wikipedia.org/wiki/Prepared_statement)

[使用 MySQLi 准备的语句](http://php.net/manual/en/mysqli.quickstart.prepared-statements.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:13:48.007

首先不要使用**mysql_***函数尝试使用 PDO 或 MySQLi 并阅读准备好的语句。

如果你还想用**mysql_****函数至少使用**mysql_real_escape_string**对它们进行转义，但我不建议使用**mysql_***函数，因为它们已被弃用。*

 *这是您可以执行的操作：

1.  您可以遍历每个帖子数据并逐个更新它或
2.  构建一个长查询并执行一次。*

# actionscript-3 - 在动作script3.0中的数组之间插入值

> ID：14863898
> 
> 赞同：0
> 
> 时间：2013-02-13T21:54:33.497
> 
> 标签：actionscript-3, apache-flex, flex3

我在 3 位置插入一个值，该值被插入但不知何故在复制其余部分时它不会复制最后一点。数组的大小没有增加。谁能告诉我如何在中间的数组中添加新元素。

```
for(indexpoint=0;indexpoint<3;indexpoint++) 
{           
    temp.points[indexpoint].x = intpoints[indexpoint].x+this.x;
    temp.points[indexpoint].y = intpoints[indexpoint].y+this.y; 
}

temp.points[3].x = (intpoints[2].x+intpoints[3].x)/2+this.x;
temp.points[3].y = (intpoints[2].y+intpoints[3].y)/2+this.y;

for(indexpoint=3;indexpoint<intpoints.length;indexpoint++)
{           
    temp.points[indexpoint+1].x = intpoints[indexpoint].x+this.x;
    temp.points[indexpoint+1].y = intpoints[indexpoint].y+this.y;       
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:33:48.003

要在数组中插入新元素，您可以使用 方法`splice()`，但首先，您必须创建要添加的对象（它`Point`在您的代码中看起来像 a）：

```
const point:Point = new Point();
point.x = intpoints[2].x+intpoints[3].x)/2+this.x;
point.y = intpoints[2].y+intpoints[3].y)/2+this.y;

temp.points.splice(3, 0, point); 
```

你也可以这样做：

```
temp.points.length = 0;

for each (var point:Point in intpoints) {
    temp.points.add(point.clone().add(this));
}

const newPoint:Point = new Point();
newPoint.x = intpoints[2].x+intpoints[3].x)/2+this.x;
newPoint.y = intpoints[2].y+intpoints[3].y)/2+this.y;
temp.points.splice(3, 0, newPoint); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:37:40.133

为什么不直接使用`splice`函数？

```
array.splice( positionToInsertIn, 0, newValue ); 
```

# perl - 为什么单词字符 (\w) 在 use locale pragma 下不匹配？

> ID：14863899
> 
> 赞同：1
> 
> 时间：2013-02-13T21:54:35.983
> 
> 标签：perl, sorting, unicode, utf-8, locale

当 I 时`use locale`，我的语言环境（et_EE.UTF-8）中的某些字符不匹配，`\w`我看不到任何原因。

除了 ASCII，爱沙尼亚语还使用了六个字符：

> õäöüšž

在下面的测试脚本中，我将它们`$string`与三个额外的特殊字符`ðŋц`（不属于爱沙尼亚字母）一起使用。

```
use feature 'say';
use POSIX qw( locale_h );

{
  use utf8;
  my  $string = "õäöüšž ðŋц";
  binmode STDOUT, ":encoding(UTF-8)";
  say "nothing";
  say 'LOCALE: ', setlocale(LC_CTYPE), ' ', setlocale(LC_COLLATE);
  say 'UC: ', uc( $string );
  say 'SORT: ', sort( split(//, $string) );
  say $string =~ m/\w/g;
  say $string =~ m/\p{Word}/g;
  say '';
}

{
  use utf8;
  use locale;
  binmode STDOUT, ":encoding(UTF-8)";
  my  $string = "õäöüšž ðŋц";
  say "locale";
  say 'LOCALE: ', setlocale(LC_CTYPE), ' ', setlocale(LC_COLLATE);
  say 'UC: ', uc( $string );
  say 'SORT: ', sort( split(//, $string) );
  say $string =~ m/\w/g;
  say $string =~ m/\p{Word}/g;
  say '';
}

{
  use utf8::all;
  my  $string = "õäöüšž ðŋц";
  say "utf8::all";
  say 'LOCALE: ', setlocale(LC_CTYPE), ' ', setlocale(LC_COLLATE);
  say 'UC: ', uc( $string );
  say 'SORT: ', sort( split(//, $string) );
  say $string =~ m/\w/g;
  say $string =~ m/\p{Word}/g;
  say '';
}

{
  use utf8::all;
  use locale;
  my  $string = "õäöüšž ðŋц";
  say "utf8::all + locale";
  say 'LOCALE: ', setlocale(LC_CTYPE), ' ', setlocale(LC_COLLATE);
  say 'UC: ', uc( $string );
  say 'SORT: ', sort( split(//, $string) );
  say $string =~ m/\w/g;
  say $string =~ m/\p{Word}/g;
  say '';
} 
```

我尝试使用 Perl 5.10.1 和 5.14.2 并且都给了我这样的输出：

```
nothing
LOCALE: et_EE.UTF-8 et_EE.UTF-8
UC: ÕÄÖÜŠŽ ÐŊЦ
SORT:  äðõöüŋšžц
õäöüšžðŋц
õäöüšžðŋц

locale
LOCALE: et_EE.UTF-8 et_EE.UTF-8
UC: ÕÄÖÜŠŽ ÐŊЦ
SORT:  ðŋšžõäöüц
šžŋц
õäöüšžðŋц

utf8::all
LOCALE: et_EE.UTF-8 et_EE.UTF-8
UC: ÕÄÖÜŠŽ ÐŊЦ
SORT:  äðõöüŋšžц
õäöüšžðŋц
õäöüšžðŋц

utf8::all + locale
LOCALE: et_EE.UTF-8 et_EE.UTF-8
UC: ÕÄÖÜŠŽ ÐŊЦ
SORT:  ðŋšžõäöüц
šžŋц
õäöüšžðŋц 
```

什么不符合我的预期？

*   主要问题：`use locale`我希望`\w`匹配我所有的六个字符，但结果`šžŋц`很奇怪。为什么会有这样的比赛？从[perlrecharclass](http://perldoc.perl.org/perlrecharclass.html)我读到：

> 对于高于 255 的代码点 ... \w 匹配与 \p{Word} 在此范围内匹配。...对于低于 256 的代码点 ...如果区域设置规则生效 ... \w 匹配平台的本机下划线字符加上任何区域设置认为是字母数字的字符。

因此，`\w`匹配 255 以上的字符，但不匹配“任何语言环境认为是字母数字的”。为什么？同时在语言环境下排序工作正常（没有语言环境不能），结果`ðŋšžõäöüц`是正确的顺序，这表明有正确的字符表示。AFAIU，如果不知道“无论语言环境认为是字母数字的什么”，排序就无法正常工作。或者？

*   我认为这`setlocale`仅在 locale-pragma 下给出结果。我如何测试，哪个语言环境对范围有效？
*   我没想到每个测试用例中的所有字符都是大写的。AFAIU`uc`并且`lc`应该依赖于语言环境。在第一种情况下，我认为它们都会小写，但是使用语言环境我等待前六个字符大写，而其他字符则不是。唯一的情况是我等待所有字符大写，是第三个。我看到我在这里错过了一些重要的事情。糟糕，现在我从`lc`文档中找到：“否则，如果 EXPR 设置了 UTF-8 标志：Unicode 语义用于大小写更改。” UTF-8 标志始终设置在 my 上`$string`，因此在编写过程中得到了答案。

`locale`用于排序和`\p{Word}`匹配对我来说是可以接受的，但我仍然会使用一些提示：为什么不能`\w`按我的预期工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T01:44:59.277

请不要使用损坏的`use locale`编译指示。

请，请，请`Unicode::Collate::Locale`用于区域设置排序。它使用 CLDR 规则，并且是完全可移植的，并且不依赖于狡猾的破坏 POSIX 语言环境，这根本不能很好地工作。

如果你按代码点排序，你会得到废话，但如果你使用一个`Unicode::Collate::Locale`用爱沙尼亚语言环境构造的对象排序，你会得到一些合理的结果：

```
Codepoint sort:  äðõöüŋšžц
Estonian  sort:  ðŋšžõäöüц 
```

此外，当您执行此原始代码点排序时，您会受到规范化问题的严重影响。考虑：

```
NFC/NFD sort by codepoint is DIFFERENT
NFC Codepoint sort:  äðõöüŋšžц
NFD Codepoint sort:  äõöšüžðŋц

NFC/NFD sort in estonian  is SAME
NFC Estonian  sort:  ðŋšžõäöüц
NFD Estonian  sort:  ðŋšžõäöüц 
```

这是产生所有这些的演示程序。

```
#!/usr/bin/env perl
#
# et-demo - show how to handle Estonian collation correctly
#
# Tom Christinansen <tchrist@perl.com>
# Fri Feb 22 19:27:51 MST 2013

use v5.14;
use utf8;
use strict;
use warnings;
use warnings FATAL => "utf8";
use open qw(:std :utf8);

use Unicode::Normalize;
use Unicode::Collate::Locale;

main();
exit();

sub graphemes(_) {
    my($str) = @_;
    my @graphs = $str =~ /\X/g;
    return @graphs;
}

sub same_diff($$) {
    my($s1, $s2) = @_;
    no locale;

    if (NFC($s1) eq NFC($s2)) {
        return "SAME";
    } else {
        return "DIFFERENT";
    }
}

sub stringy {
    return join("" => @_);
}

sub cp_sort {
    no locale;
    return sort @_;
}

sub et_sort {
    state $collator = # we want Estonian here:
        Unicode::Collate::Locale->new(locale => "et");
    return $collator->sort(@_);
}

sub main {
    my $orig = "õäöüšž ðŋц";

    say "    Codepoint sort: ", cp_sort(graphemes($orig));
    say "    Estonian  sort: ", et_sort(graphemes($orig));

    my $nfc = NFC($orig);
    my $nfc_cp_sort = stringy cp_sort(graphemes($nfc));
    my $nfc_et_sort = stringy et_sort(graphemes($nfc));

    my $nfd = NFD($orig);
    my $nfd_cp_sort = stringy cp_sort(graphemes($nfd));
    my $nfd_et_sort = stringy et_sort(graphemes($nfd));

    say "NFC/NFD sort by codepoint is ",
        same_diff($nfc_cp_sort, $nfd_cp_sort);

    say "NFC Codepoint sort: ", $nfc_cp_sort;
    say "NFD Codepoint sort: ", $nfd_cp_sort;

    say "NFC/NFD sort in estonian  is ",
        same_diff($nfc_et_sort, $nfd_et_sort);

    say "NFC Estonian  sort: ", $nfc_et_sort;
    say "NFD Estonian  sort: ", $nfd_et_sort;

} 
```

这确实是您应该如何处理语言环境排序规则。有关众多示例，另请参见此[答案](https://stackoverflow.com/a/15016188)。

# firebase - 我可以在 Firebase 中实现渠道的概念吗？

> ID：14863900
> 
> 赞同：5
> 
> 时间：2013-02-13T21:54:38.260
> 
> 标签：firebase

Firebase 聊天应用程序似乎建议所有客户端都将接收发送到给定 FireBase url 的消息。

现在，确保用户只接收发送到特定通道的消息的一种方法是在客户端过滤消息，但这意味着所有消息都将传播到所有客户端，并且客户端将进行过滤。

有没有办法在 Firebase 服务器上建立通道 - 或者这是否意味着需要为单独的通道创建单独的 firebase，这意味着如果想要用户特定的推送消息，可能需要创建一个通道/firebase对于每个用户。

那么，建议的解决方案是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T22:13:22.573

实际上，[Firebase 数据结构](https://www.firebase.com/docs/data-structure.html)使这变得非常简单！演示应用程序将聊天消息放在 Firebase 的根目录中（即[https://samplechat.firebaseio.com/](https://samplechat.firebaseio.com/)），但您也可以轻松地在 Firebase 中使用单独的位置进行单独的聊天，例如 /chat1、/chat2、等等。或者更好的是，你可以有一个 /chats/ 位置，下面有任意数量的聊天，每个聊天都是唯一的（可能使用[push()](https://www.firebase.com/docs/managing-lists.html)）。

然后，用户可以通过直接引用特定聊天来接收消息并将其推送到特定聊天（例如[https://samplechat.firebaseio.com/chats/chat-id/](https://samplechat.firebaseio.com/chats/chat-id/)），然后他们将不会获得任何其他聊天的任何数据。

# c# - c# 处理模式

> ID：14863904
> 
> 赞同：0
> 
> 时间：2013-02-13T21:55:07.307
> 
> 标签：c#, idisposable

这是一个典型的 IDispose 实现。我不明白的是析构函数？如果您班级的用户忘记调用 Dispose，由于析构函数不会调用 r1.Dispose()，您是否会发生资源泄漏？

```
public class DisposableObject : IDisposable
    {
        private bool disposed;
        private UnmanagedResource r1;

        public DisposableObject()
        {
            r1 = new UnmanagedResource();
        }

        ~DisposableObject()
        {
            this.Dispose(false);
        }

        public void Dispose()
        {

             this.Dispose(true);
             GC.SuppressFinalize(this);       
        }

        protected virtual void Dispose(bool disposing)
        {
            if (!this.disposed)
            {
                if (disposing)
                {
                    // clean up managed resources
                    //call dispose on your member objects
                    r1.Dispose();
                }

                // clean up unmanaged resources
                this.disposed = true;
            }
        }

        public void SomeMethod()
        {
            if (this.disposed)
            {
                throw new ObjectDisposedException(this.GetType().FullName);
            }

        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:59:36.583

否 - 一旦对对象的所有引用都消失了，GC 将调用析构函数（但这不是确定性的）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T22:01:01.867

如果`r1`确实是本机资源（在您的示例中看起来不像），则不应在 if(disposing) 块内而是在它之后处理它。特别注意：

```
if (disposing) 
{
    // free managed resources
    if (managedResource != null)
    {
        managedResource.Dispose();
        managedResource = null;
    }
}
// free native resources if there are any.
if (nativeResource != IntPtr.Zero) 
{
    Marshal.FreeHGlobal(nativeResource);
    nativeResource = IntPtr.Zero;
} 
```

从[正确实施 IDisposable - MSDN](http://msdn.microsoft.com/en-us/library/ms244737%28v=vs.80%29.aspx)

如果`r1`是一个拥有自己实现的托管资源`IDisposable`，假设它被正确实现，任何本机资源都将在其终结器中正确清理（这就是为什么您不需要自己担心它的原因）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T22:01:10.143

析构函数（终结器）调用 Dispose 的原因是垃圾收集器在收集对象之前调用它，保证至少在某个时候 UnmanagedResource 将被释放。

通过使用`using`，`try...finally`您可以强制资源在不需要时立即处置

[http://msdn.microsoft.com/en-us/library/system.object.finalize.aspx](http://msdn.microsoft.com/en-us/library/system.object.finalize.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-13T22:02:49.580

如果你真的想，你可以添加一个终结器：

```
~DisposeImplementation()
{
    Dispose(false);
} 
```

但它应该只用作真正的最后手段，而不是直接依赖的东西。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-13T22:04:10.870

在 .Net 中，我们有一个称为垃圾收集的功能。垃圾收集最终确定所有未引用的对象（不再引用）。然后你的析构函数/终结器调用 Dispose()。

如果您的用户忘记删除这些引用，您最终会遇到某种泄漏。但这就是`using`目的：通过仅在要求范围内定义一次性用品来避免内存阻塞。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-13T22:04:12.537

该模式的存在是因为垃圾收集器不保证托管对象被垃圾收集的顺序。因此，在终结器中，您不能保证`r1`引用仍然有效。

您的`r1`参考有一个类名，`UnmanagedResource`但它显然是一个托管类型。对于真正的无人资源，您将只有一个`IntPtr`或其他一些令牌。为了确保`r1`不喜欢它的资源，它应该实现相同的 Dispose 模式并在`if (disposing)`检查之外释放它的非托管资源。

# visual-studio-2010 - WiX 'Bundle' 'ExePackage' 'DetectCondition' 总是假的

> ID：14863905
> 
> 赞同：5
> 
> 时间：2013-02-13T21:55:06.273
> 
> 标签：visual-studio-2010, wix, bundle, bootstrapper

我正在尝试创建一个在我的[MSI](http://en.wikipedia.org/wiki/Windows_Installer)安装程序之前安装 .NET Framework 4.0 的 WiX 包。我使用命令行参数检查了我的引导程序的日志文件`\l log.txt`，发现`ExePackage::DetectCondition`总是评估为假。

我将`WixNetFxExtension.dll`作为参考包含在我的 Visual Studio 2010 Windows Installer XML Bootstrapper 项目中。

我包括`NetFxExtension`命名空间：

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi"
    xmlns:util="http://schemas.microsoft.com/wix/UtilExtension"
    xmlns:bal="http://schemas.microsoft.com/wix/BalExtension"
    xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension"> 
```

提供基本的捆绑框架：

```
 <Bundle Name="RSA Bootstrapper"
      ...
    <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense" />
      ...

    <Chain>
      <PackageGroupRef Id="NET40" />
      <PackageGroupRef Id="RSA_Application" />
    </Chain>
  </Bundle>
    ... 
```

我将 包含`<PropertyRef Id="NETFRAMEWORK40FULL" />`在片段中，然后继续为 .NET Framework 4.0 ( `NET40`) 定义 ExePackage：

```
 <Fragment>
    <PropertyRef Id="NETFRAMEWORK40FULL" />
    <PackageGroup Id="NET40">
    <ExePackage SourceFile="dotNetFx40_Full_x86_x64.exe"
        Compressed="yes"
        Cache="yes"
        DetectCondition="NETFRAMEWORK40FULL"
        InstallCommand="/norestart /passive /showrmui /ACTION=Install"
        Permanent="yes"
        InstallCondition="NOT NETFRAMEWORK40FULL"
        Vital="yes" >
    <ExitCode Value="0" Behavior="success" />
    <ExitCode Value="1641" Behavior="scheduleReboot" />
    <ExitCode Value="3010" Behavior="scheduleReboot" />
    <ExitCode Behavior="error" /> <!-- Everything else is an error -->
  </ExePackage>
    ... 
```

我还检查了 Visual Studio 构建输出以确认`WixNetFxExtension.dll`正确引用：

C:\Program Files (x86)\WiX Toolset v3.7\bin\Light.exe ... -ext "C:\Program Files (x86)\WiX Toolset v3.7\bin\WixNetFxExtension.dll"

问题出在`DetectCondition`物业上。无论我将其设置为什么，它的评估结果都是`false`.

考虑到可能`NETFRAMEWORK40FULL`无法信任引用，我尝试使用它：

```
<Fragment>
  <Variable Name="isInstalled"
      Type="numeric"
      Value="0"
      Persisted="yes"
      bal:Overridable="yes"/>
  <util:RegistrySearch Id="FindInstallKey"
      Root="HKLM" Key="SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full"
      Value="Install"
      Result="exists"
      Variable="InstallKeyExists" />
  <util:RegistrySearch
      Root="HKLM" Key="SOFTWARE\Microsoft\NET Framework Setup\NDP\v4\Full"
      Value="Install"
      Variable="isInstalled"
      After="FindInstallKey"
      Condition="InstallKeyExists = true"
      Format="raw" />
</Fragment> 
```

设置`DetectCondition="isInstalled"`或`DetectCondition="isInstalled = true"`总是评估为假。即使设置`DetectCondition="true"`总是评估为假！

这是我正在谈论的日志片段，其中`DetectCondition="true"`

```
[16A0:17B4][2013-02-13T13:01:43]i001: Burn v3.7.1224.0, Windows v6.1 (Build 7601: Service Pack 1), path: C:\Users\lalic\Documents\Visual Studio 2010\Projects\RSA Preset\Bootstrapper\bin\Release\Bootstrapper.exe, cmdline: '/l log.txt -burn.unelevated BurnPipe.{33090847-CC78-445B-BAAA-564B840B7E8E} {38F95C6A-EC0F-4402-951B-FABFC5827CB6} 6296'
[16A0:17B4][2013-02-13T13:01:43]i000: Setting string variable 'WixBundleLog' to value 'C:\Users\lalic\Documents\Visual Studio 2010\Projects\RSA Preset\Bootstrapper\bin\Release\log.txt'
[16A0:17B4][2013-02-13T13:01:43]i000: Setting string variable 'WixBundleOriginalSource' to value 'C:\Users\lalic\Documents\Visual Studio 2010\Projects\RSA Preset\Bootstrapper\bin\Release\Bootstrapper.exe'
[16A0:17B4][2013-02-13T13:01:43]i052: Condition '((VersionNT = v5.1) AND (ServicePackLevel >= 3)) OR ((VersionNT = v5.2) AND (ServicePackLevel >= 2)) OR ((VersionNT = v6.0) AND (ServicePackLevel >= 1)) OR (VersionNT >= v6.1)' evaluates to true.
[16A0:17B4][2013-02-13T13:01:43]i000: Setting string variable 'WixBundleName' to value 'RSA Bootstrapper'
[16A0:17B4][2013-02-13T13:01:43]i100: Detect begin, 2 packages
[16A0:17B4][2013-02-13T13:01:43]i052: Condition 'true' evaluates to false.
[16A0:17B4][2013-02-13T13:01:43]i103: Detected related package: {D431417D-F0AC-4CFB-8E25-E27F5B8101D9}, scope: PerMachine, version: 2.1.15.0, language: 0 operation: MajorUpgrade
[16A0:17B4][2013-02-13T13:01:43]i101: Detected package: dotNetFx40_Full_x86_x64.exe, state: Absent, cached: None
[16A0:17B4][2013-02-13T13:01:43]i101: Detected package: RSA_Preset.msi, state: Absent, cached: None
[16A0:17B4][2013-02-13T13:01:43]i199: Detect complete, result: 0x0
[16A0:17B4][2013-02-13T13:02:04]i200: Plan begin, 2 packages, action: Install
[16A0:17B4][2013-02-13T13:02:04]i052: Condition 'NOT NETFRAMEWORK40FULL' evaluates to true. 
```

具体来说， `i052: Condition 'true' evaluates to false.` 实际上`Condition 'NOT NETFRAMEWORK40FULL' evaluates to true.`即使我已经安装了 .NET 4.0 Full 并且可以在我的注册表中手动找到 .NET 4.0 条目，无论是在通常的位置还是在下面`HKLM\SOFTWARE\Wow6432Node`（我在 64 位系统上）。

我错过了什么吗？为什么 DetectCondition 对我不起作用？该项目可以编译、运行、部署有效载荷，否则工作正常。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-14T04:56:10.193

`<PropertyRef Id="NETFRAMEWORK40FULL" />`是对 MSI 属性的引用，但您正在创建一个包。Bundle 具有与 MSI 属性不同的变量，尽管 Burn 本身提供了许多模仿 MSI 提供的变量的 bundle 变量。

也就是说，WixNetFxExtension 为 4.0 NetFx 安装程序提供包组。你可以用一个简单的`<PackageGroupRef Id="NetFx40Redist" />`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-05T09:57:34.943

NETFRAMEWORK40FULL 等变量是 MSI 变量，您不能在 Bundles 中使用它们。

我已成功将 .NET Framework 4.0 客户端版本嵌入到我的捆绑包中。从注册表解析的条件变量。

请注意 DetectCondition 属性中的语法`"&lt;&lt;"`（转换为 <<）。此页面可能会有所帮助[http://wix.tramontana.co.hu/tutorial/com-expression-syntax-miscellanea/expression-syntax](http://wix.tramontana.co.hu/tutorial/com-expression-syntax-miscellanea/expression-syntax)

```
<?xml version="1.0" encoding="UTF-8"?>
<Wix 
    xmlns="http://schemas.microsoft.com/wix/2006/wi" 
    xmlns:bal="http://schemas.microsoft.com/wix/BalExtension" 
    xmlns:util="http://schemas.microsoft.com/wix/UtilExtension"
    xmlns:netfx="http://schemas.microsoft.com/wix/NetFxExtension">

    <Bundle
        Name="My Program Name"
        Version="1.2.0"
        Manufacturer="SUSU"
        UpgradeCode="some-guid">

        <Chain>
            <PackageGroupRef Id="Netfx4"/>
            <MsiPackage Id="MyProgramInstaller" SourceFile="product.msi" Compressed="yes"/>
        </Chain>

        <BootstrapperApplicationRef Id="WixStandardBootstrapperApplication.RtfLicense">
            <bal:WixStandardBootstrapperApplication
                LicenseFile="license.rtf"
                ShowVersion="yes"
            />
        </BootstrapperApplicationRef>
    </Bundle>

    <Fragment>

        <util:RegistrySearch Root="HKLM" Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Client" Value="Version" 
            Variable="Netfx4ClientVersion" /> 

        <util:RegistrySearch Root="HKLM" Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Client" Value="Version" 
            Variable="Netfx4x64ClientVersion" Win64="yes" /> 

        <util:RegistrySearch Root="HKLM" Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full" Value="Version" 
            Variable="Netfx4FullVersion" /> 

        <util:RegistrySearch Root="HKLM" Key="SOFTWARE\Microsoft\Net Framework Setup\NDP\v4\Full" Value="Version" 
            Variable="Netfx4x64FullVersion" Win64="yes"/> 

        <PackageGroup Id="Netfx4">
            <ExePackage
                Id="Netfx4"
                Cache="no"
                Compressed="yes"
                PerMachine="yes"
                Permanent="yes"
                Vital="yes"
                SourceFile="c:\Downloads\dotNetFx40_Client_x86_x64.exe"
                InstallCommand="/q"
                DetectCondition="(Netfx4FullVersion &lt;&lt; &quot;4&quot;) OR (Netfx4ClientVersion &lt;&lt; &quot;4&quot;) OR (Netfx4x64ClientVersion &lt;&lt; &quot;4&quot;) OR (Netfx4x64FullVersion &lt;&lt; &quot;4&quot;)"
                />
        </PackageGroup>

    </Fragment>

</Wix> 
```

# ruby - 如何在 Sequel 模型验证中使用语言环境消息

> ID：14863907
> 
> 赞同：0
> 
> 时间：2013-02-13T21:55:09.817
> 
> 标签：ruby, sequel

我将插件 :validation_helpers 与 Sequel::Model 一起使用：

```
class User < Sequel::Model
  plugin :validation_helpers

  def validate
     super
     validates_presence [:name, :mail]
  end
end 
```

当我显示验证错误时，会写入英文消息“不存在”，但我想将消息本地化为其他语言。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:11:14.613

这是一个 Rails 应用程序吗？如果是，您可以更改 Sequel 插件使用的消息`ValidationHelpers`。为此，您应该执行以下操作：

给定以下语言环境文件：

```
en:
  errors:
    exact_length: "is not %{exact} characters" 
```

您可以像这样定义本地化消息：

```
Sequel::Plugins::ValidationHelpers::DEFAULT_OPTIONS.merge!(
  :exact_length=> {
    :message=> lambda { |exact| I18n.t("errors.exact_length", :exact => exact)}
  }
) 
```

更多信息，您可以访问官方文档：

[http://sequel.rubyforge.org/rdoc-plugins/classes/Sequel/Plugins/ValidationHelpers.html](http://sequel.rubyforge.org/rdoc-plugins/classes/Sequel/Plugins/ValidationHelpers.html)

# excel - Excel VBA 自定义序列

> ID：14863911
> 
> 赞同：0
> 
> 时间：2013-02-13T21:55:25.033
> 
> 标签：excel, vba

使用 Excel VBA，我正在尝试创建自定义序列。如何继续自定义序列的 IP 地址范围为：10.168.187.0 - 10.168.187.100？

我到目前为止的代码发布在下面。

```
Sub Sequence()
'
' Sequence Macro
' Macro recorded 13/02/2013 by Don
'
' Keyboard Shortcut: Ctrl+Shift+M
'
Range("A1").Select
ActiveCell.FormulaR1C1 = "10.168.187.0"
Range("A2").Select
ActiveCell.FormulaR1C1 = "10.168.187.1"
Range("A3").Select
ActiveCell.FormulaR1C1 = "10.168.187.2"
Range("A4").Select
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:32:00.453

Assuming that you're looking to automate the completion of the cells, the following should work:

```
Sub CompleteRange()

For i = 1 To 101

    Cells(i, 1) = "10.168.187." & (i - 1)

Next i

End Sub 
```

# loops - 有趣的嵌套循环的大哦 - 如何计算它？

> ID：14863912
> 
> 赞同：0
> 
> 时间：2013-02-13T21:55:24.990
> 
> 标签：loops, big-o, nested-loops

我知道关于 Big Oh 符号有很多类似的问题，但是这个例子很有趣，而且不是微不足道的：

```
int sum = 0;
for (int i = 1; i <= N; i = i*2)
    for (int j = 0; j < i; j++)
        sum++; 
```

外循环将迭代 lg(N) 次，但是内循环呢？所有操作的 T(N) 是多少？我只能看到 3 个可能性：

*   T(N) = lg(N) * 2^N
*   T(N) = log(N) * (N-1)
*   T(N) = N

我的意见 - T(N) = N - 但这只是我从 sum 变量的观察值得出的直觉，当 N 被多次相乘时 - sum 几乎等于 2N，这给了我们 N。

基本上我不知道怎么算。请帮助我完成这项任务并解释解决方案 - 这对我来说非常重要。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:04:32.197

内部循环迭代最后一次最大值。N. 在最后一次运行之前，它迭代 N/2。如果你把它加起来 N + N/2 + N/4 + N/8 这加起来是 2*N。这就是你计算所有运行的全部内容。T(N) = N

# mysql - MySQL 服务器实例永远不会启动。Mac OS 狮子

> ID：14863916
> 
> 赞同：0
> 
> 时间：2013-02-13T21:55:42.723
> 
> 标签：mysql, macos, osx-lion

我使用 DMG 文件 ( [http://dev.mysql.com/downloads/mysql/](http://dev.mysql.com/downloads/mysql/) ) 安装了 MySQL，并安装了 MySQL_etc.pkg、MySQLStartUpItem.pkg 和 MySQL.prefPane 项目。

每次我尝试从命令行启动 mysql 时，都会收到以下消息：

```
ERROR 2002 (HY000): Can't connect to local MySQL server through socket '/var/mysql/mysql.sock' (2) 
```

感谢 stackoverflow 上的各种帖子，我发现这是因为 MySQL 没有运行。所以我转到系统偏好设置中的 MySQL 窗格，果然“MySQL 服务器实例已停止”。我单击“启动 MySQL 服务器”，然后我得到了旋转的沙滩球 2 分钟，然后没有任何反应。MySQL 服务器实例保持停止状态。

如果我重新启动计算机，那么我可以转到 MySQL 窗格，它告诉我“MySQL 服务器实例正在运行”。果然，命令行中的**mysql -v**告诉我我的 MySQL 连接 ID，并且我的服务器版本为 5.6.10。但是，如果我通过键入 exit 离开 mysql，服务器实例将停止，我只能通过重新启动计算机来重新启动它！

有任何想法吗？我什至无法运行 MySQL 足够长的时间来设置密码，更不用说创建数据库了！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-14T00:31:35.253

经过一下午的虚假线索（我并不是说听起来忘恩负义，所有建议都得到了跟进，我很感谢所有建议），我卸载了 MySQL 的所有痕迹并重新安装了旧版本，遵循此博客上的建议：[http://soatechlab.blogspot.com/2011/01/completely-remove-mysql-on-mac-os-x.html](http://soatechlab.blogspot.com/2011/01/completely-remove-mysql-on-mac-os-x.html)

它现在似乎正在工作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T22:00:02.687

尝试：

```
prompt$ sudo mysqld -u root <secure password goes here!> 
```

注意 sudo：如果没有对计算机和 MySQL 本身的 root 访问权限，MySQL 不会让我启动服务器。还要注意程序是mysqld，不是mysql。

该命令因您安装 MySQL 的方式而异。先试试这个：

```
sudo /Library/StartupItems/MySQLCOM/MySQLCOM start 
```

如果失败：

```
cd /usr/local/mysql
 sudo ./bin/mysqld_safe
(Enter your password, if necessary)
 (Press Control-Z)
 bg 
```

我还没有尝试过，但是如果您使用 MAMP 和 php，请检查一下：-

[http://twob.net/journal/fix-for-mamp-mysql/](http://twob.net/journal/fix-for-mamp-mysql/)

甚至可以尝试重新安装并遵循这些文档：-

[http://dev.mysql.com/doc/refman/5.6/en/macosx-installation.html](http://dev.mysql.com/doc/refman/5.6/en/macosx-installation.html)

此外，此页面上有大量头脑风暴：-

[https://stackoverflow.com/questions/4788381/getting-cant-connect-through-socket-tmp-mysql-when-installing-mysql-on-m](https://stackoverflow.com/questions/4788381/getting-cant-connect-through-socket-tmp-mysql-when-installing-mysql-on-m)

# c++ - 在 GoogleMock 中实现 WillN？

> ID：14863918
> 
> 赞同：2
> 
> 时间：2013-02-13T21:55:51.087
> 
> 标签：c++, googlemock

是否有比重复使用更简洁和/或更简洁的方法来设置多个相同的操作`WillOnce`？例如，有没有办法获得`WillRepeatedly`基数？

我只能找到链接`WillOnce`可能后跟单个 的示例`WillRepeatedly`，这对于我可能希望在调用函数的前 N ​​次返回值然后最后一次返回不同值的情况下不太理想，例如使用模拟在以下示例中表示 obj 并让它循环 N 次：

```
while (obj.IsDone())
{
    SomeAction(obj.NextItem());
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T22:50:45.170

您可以使用[`Times`](https://code.google.com/p/googlemock/wiki/CheatSheet#Cardinalities).

```
// This is the final call
EXPECT_CALL(obj, IsDone())
  .WillOnce(Return(true));
// These are the intermediate calls
EXPECT_CALL(obj, IsDone())
  .Times(N)
  .WillRepeatedly(Return(false))
  .RetiresOnSaturation(); 
```

模拟对象的`IsDone`方法将在前*N*次被调用时返回 false。之后，最近的期望就会得到满足，所以我们用 指示它不再申请[`RetiresOnSaturation`](https://code.google.com/p/googlemock/wiki/CookBook#Controlling_When_an_Expectation_Retires)。后续调用`IsDone`将由第一个期望处理，使其返回 true。如果再次调用它，测试将失败。

如果省略`RetiresOnSaturation`，则第二个期望将继续适用；它将继续返回 false，并且您会收到消息提醒您“过度饱和和活跃”的期望正在失败。

# windows - 只要线程的任何句柄都打开，线程 ID 是否保持唯一/有效？

> ID：14863919
> 
> 赞同：2
> 
> 时间：2013-02-13T21:55:53.643
> 
> 标签：windows, multithreading, winapi, visual-c++, windows-kernel

如果我有一个 Win32 线程，我通过句柄引用它，也可以获得它的线程 ID。

[在我关闭句柄之前，句柄仍然有效](http://msdn.microsoft.com/en-us/library/ms686746%28v=VS.85%29.aspx)且可用，即使线程已终止。（否则，无法使用例如[GetExitCodeThread](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683190%28v=vs.85%29.aspx)

然而，文档似乎没有一致地提及线程终止后线程 ID “发生”了什么，但只要任何人仍然持有终止线程的线程句柄。

[线程句柄和标识符](http://msdn.microsoft.com/en-us/library/ms686746%28v=VS.85%29.aspx)指出

> 从线程创建到线程终止，标识符都是有效的。

然后，当我们查看[GetThreadId](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683233%28v=vs.85%29.aspx) API 时，我们会想知道如果 ID 仅在线程终止之前有效，那么对于终止的线程应该返回什么。（并且该站点上还有一条用户评论：“不正确。只要线程有一个打开的句柄，它的线程 ID 仍然有效且唯一。”这确实回答了这个问题，但没有更多上下文我很警惕。）

另外，我在 SO 的答案中找到[了这个片段：](https://stackoverflow.com/a/5101968/321013)

> ID 是系统中运行的线程的唯一数字标识符。与任何内核对象句柄一样，线程句柄可以看作是一种特殊类型的指向内核对象的引用计数指针。

如果这是正确的，并且线程 ID 确实是内核对象的 ID，那么只要打开任何句柄，这个 ID 就必须保持有效（因为内核对象需要保留在那里才能被查询）。

我的推理合理吗？只要打开任何句柄，线程 ID 是否有效？是否有*任何*MS 文档或权威书籍明确说明其中之一？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T22:11:25.747

注意：

*   [“在线程终止之前，它的线程标识符在系统上唯一标识它。”](http://msdn.microsoft.com/en-us/library/windows/desktop/ms683233%28v=vs.85%29.aspx)
*   ThreadProc 已经退出但其句柄仍然有效且尚未关闭的线程，在最后一个句柄关闭之前仍然具有其原始有效标识符
*   您仍然可以进行反向查找“按线程标识符处理”- [“如果您有线程标识符，则可以通过调用 OpenThread 函数来获取线程句柄。”](http://msdn.microsoft.com/en-us/library/ms686746%28v=VS.85%29.aspx)

因此，只有在关闭最后一个线程句柄后才能重用标识符（也就是说，您的假设是正确的）。

# c# - 如何使用带有字母数字比较的实体框架进行查询？

> ID：14863920
> 
> 赞同：3
> 
> 时间：2013-02-13T21:55:57.933
> 
> 标签：c#, linq, entity-framework

如何仅对字母数字比较使用 Entity Framework 和 LINQ 进行查询？我有一个包含特殊字符的 AccountNumber 字段的数据库表，因此示例帐号可能如下所示 `803-2234502-345`：但是我搜索的帐号不会包含特殊字符：`8032234502345`

```
 string accountNumber = "8032234502345";
    Provider provider = dbContext.Providers.Where(p => p.AccountNumber == accountNumber).FirstOrDefault(); 
```

我试过`Regex.Replace`在比较的两边都添加一个，但我得到了一个例外：

**LINQ to Entities 无法识别方法 'System.String Replace(System.String, System.String)' 方法，并且此方法无法转换为存储表达式。**

任何帮助或建议表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:20:12.027

您正在使用 Linq to Entities，因此只能使用实体映射器中映射到 SQL 的函数。您可以更改用于正确映射到 SQL 的函数（尽管我怀疑使用 Regex 您将无法做到这一点 - 必须进行更手动的比较），或者（正如评论中提到的@Dabblernl ）将您的提供者（或提供者的子集）加载到列表/或可枚举中，然后在其上运行正则表达式。

所以像：

```
Provider provider = dbContext.Providers.Where(p => p != null && p != "").ToList()
.Where(p => *Do regex comparison here*).FirstOrDefault(); 
```

到 SQL 的可能映射在这里：http: [//msdn.microsoft.com/en-us/library/bb738681.aspx](http://msdn.microsoft.com/en-us/library/bb738681.aspx)

# html - 在浏览器调整大小时，div 会下降

> ID：14863921
> 
> 赞同：0
> 
> 时间：2013-02-13T21:56:03.613
> 
> 标签：html, css, css-float

在标题中，我给出了四个不同的值，并使用 float 属性使所有内容都显示在水平线上。

当我调整浏览器窗口的大小时，最后一个 div 低于黑色边框线。

如何修复它。

[http://jsfiddle.net/m6uBA/](http://jsfiddle.net/m6uBA/)

```
<div class="mainDiv" style="border-bottom: 1px solid grey; height: 80px;">
            <div class="subDiv" style="font-size: 24px; color: grey; padding-left: 35px;">
                Company LOGO
            </div>
            <div class="subDiv" style="padding-left: 50px;">
                <p><span style="font-weight: bold;  font-family: arial; color: #333;">welcome xyz!</span> xyz@defie.co</p>
            </div>
            <div class="subDivMenu" style="width: 911px; margin-top: 0px; padding-left: 17px; ">

                <div class="inline" style="padding-top: 12px; ">

                    <ul class="homePageLists" style="">
                                    <li style="padding-bottom: 5px; list-style: none; color: #333;">
                                      <a style="color: #cc0000; font-family: arial; font-size: 14px; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                         Menu
                                        </a>
                                    </li>
                                    <li style="padding-bottom: 5px; list-style: none; color: #; ">
                                      <a style="color: #666; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                        <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_inventory.png">
                                        Inventory
                                      </a>
                                    </li>
                                    <li style="padding-bottom: 5px; list-style: none; color: #653921; ">
                                      <a style="color: #666; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                        <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_vender.png">
                                        Vendors
                                      </a>
                                    </li>
                                    <li style="padding-bottom: 5px; list-style: none; color: #653921; ">
                                      <a style="color: #666; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                          <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_vender.png">
                                          Quote
                                        </a>
                                    </li>
                                    <li style="padding-bottom: 5px; list-style: none; color: #9e1c20; ">
                                      <a style="color: #666; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                          <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_vender.png">
                                          Purchase Orders
                                        </a>
                                    </li>
                                    <li style="padding-bottom: 5px; list-style: none; color: #ff5100; ">
                                      <a style="color: #666; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                        <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_vender.png">
                                        Invoices
                                      </a>
                                    </li>
                                    <li style="padding-bottom: 5px; list-style: none; color: #184179;">
                                      <a style="color: #666; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                          <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_vender.png">
                                          RMA
                                        </a>
                                    </li>
                                    <li style="padding-bottom: 5px; list-style: none; color: #184179;">
                                      <a style="color: #666; font-weight: bold;" href="http://www.w3schools.com/" target="_blank">
                                          <img alt="squareList" style="margin-right: 10px;" id="logo" src="http://intra.defie.co/images/cube_vender.png">
                                          Account Receivable
                                      </a>
                                    </li>
                                </ul>

                </div><!--/.nav-collapse -->

            </div>
            <div class="subDiv" style="float: right;">

                  <p style="font-weight: bold;">ABC Systems</p>
                  <p>1234 lakeview Blvd, CA 94538</p>
                  <p>510-657-8981</p>

            </div>
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-16T12:03:07.217

这个怎么样。

`enter code here`[http://jsfiddle.net/rosario10/m6uBA/31/](http://jsfiddle.net/rosario10/m6uBA/31/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-15T12:48:11.940

尝试向 .subDiv 添加一个新类，例如 .welcome 并使其向右浮动，而不是在标题中的两个元素上使用向左浮动。

# uitableview - TableViewCell“不会”在编辑模式下缩进？

> ID：14863923
> 
> 赞同：0
> 
> 时间：2013-02-13T21:56:09.153
> 
> 标签：uitableview, ios6, autolayout

我正在 Xcode（最新版本）中构建 iOS6，而在 Interface Builder 中，我现在创建了一个只有几个标签的自定义单元格。我希望标签“缩进”而不是被左侧的删除符号和右侧的“重新排序单元格行”符号覆盖。在 IB 中，我注意到一个复选框被选中，说 Indent While Editing 它也设置为 10，并且由于某种原因这仍然不起作用？我们现在是否也必须将“内容视图”拖到画布上？我以为那是开箱即用的。即使在 IB 中也是一个选项，我也无法改变我的单元格高度。这可能是因为新的自动布局系统吗？我知道我有一个单元格背景，因为当我创建它们时，我会非常轻微地改变每个其他单元格的颜色。

我四处搜索，每个人都在问“如何阻止它缩进”我希望它发生而不是它。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:49:50.747

使用自动布局时，单元格缩进不能开箱即用。看到[这个](https://stackoverflow.com/questions/12600214/contentview-not-indenting-in-ios-6-uitableviewcell-prototype-cell/13022753#13022753)问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T10:54:07.270

这个问题似乎是 AutoLayout 中的一个错误，其中系统生成的左水平约束绑定在标签和单元格的视图之间，而不是单元格的`contentView`. 这可能已在 XCode 5 中修复。

很多人似乎都说关闭 AutoLayout 就是答案，但是你失去了 AutoLayout 的所有好处，只是为了修复一个自定义单元格的缩进。它实际上很容易用四行代码（和两行`IBOutlet`，其中一个你可能已经拥有）来修复；

1.  `IBOutlet`为您的标签和左侧水平约束创建一个，方法是按住 CTRL 键从 Interface Builder 中的每一个拖动到`UITableViewCell`子类的头文件，调用它们“ `label`”和“ `leftHorizontalConstraint`”（以匹配下面的代码，或使用您自己的名称和更改代码。

2.  在您的覆盖子类中`UITableViewCell`并`awakeFromNib`添加此代码；

```
 // Remove the constraint that you can't delete in IB (XCode 4)
   [self removeConstraint:self.leftHorizontalConstraint];

   //Create a dictionary of variable name bindings
   NSDictionary *labelDict = NSDictionaryOfVariableBindings(_label);

   //Create a horizontal constraint for the label, 20 points from the left edge of its container
   NSArray *constraints = [NSLayoutConstraint constraintsWithVisualFormat:@"|-20-[_label]" options:0 metrics:nil views:labelDict];

   //Add the constraint to the containerView
   [self.contentView addConstraints:constraints]; 
```

当然，如果 IB 一开始就生成了 label 和 containerView 之间的约束，那会容易很多。我在 XCode 5 中修复了这个问题，但我还没有测试过。您至少应该能够使用 XCode 5 手动删除约束，因为 IB 现在允许您删除系统生成的约束。

# android - 可扩展列表按钮点击与项目点击

> ID：14863927
> 
> 赞同：1
> 
> 时间：2013-02-13T21:56:29.940
> 
> 标签：android

我有一个可扩展的列表视图，其每个组项都有按钮。有什么方法可以区分按钮点击和项目点击？我希望该按钮单击以展开列表。当项目单击以打开活动时

非常感谢

编辑：更多解释

这大致是我想做的事情，现在我正在考虑使用 ExpandableListView 但我不知道该怎么做。

![在此处输入图像描述](../Images/6c0bd105c5382c259707bf4f26d61812.png) 如您所见，我的组行有两个部分，箭头（我有一个自定义箭头）和文本部分。如果用户点击红色部分，那么我想展开（典型的可扩展列表），如果用户点击绿色部分，那么它会将他们带到一个活动中。

请，任何想法如何！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T22:11:22.717

只需使用 onGroupClickListener：[https ://developer.android.com/reference/android/widget/ExpandableListView.OnGroupClickListener.html](https://developer.android.com/reference/android/widget/ExpandableListView.OnGroupClickListener.html)

这将区分组中的单击与子项中的单击。

# java - Weka 分类器的参数

> ID：14863928
> 
> 赞同：6
> 
> 时间：2013-02-13T21:56:34.213
> 
> 标签：java, eclipse, weka, classification

我用威卡。我想访问分类器的参数（权重）。我想要做的是访问参数的值以确定它们如何影响属性。

所以，我的问题是：

*   如何访问分类器的参数？（使用 Eclipse）
*   如何确定参数的相关属性？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:52:56.097

这是关于 WEKA 中权重的相关问题：[How to use weights in Weka](https://stackoverflow.com/questions/12801228/how-to-use-weights-in-weka)

这里是一个java代码的例子：[http ://weka.wikispaces.com/Add+weights+to+dataset](http://weka.wikispaces.com/Add+weights+to+dataset)

要了解属性之间的关系，您可以在选项卡中`Ranker`用作搜索器和`PrincipalComponents`评估器`Selecte attributes`。你会得到一个像这样的相关矩阵：

```
Correlation matrix
  1     -0.11   0.87   0.82 
 -0.11   1     -0.42  -0.36 
  0.87  -0.42   1      0.96 
  0.82  -0.36   0.96   1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:14:50.283

如果您查看[Weka 文档](http://weka.wikispaces.com/Use+WEKA+in+your+Java+code#Classification-Building%20a%20Classifier)，则有一个关于构建分类器的部分。我不是 100% 你想要设置什么参数，但我相信通读这个应该会有所帮助。我无法快速找到可用选项列表，但这也是一个不错的选择，因为我记得几年前我使用 Weka 时有些选项非常有用。

**编辑：**我相信你想要的是“属性权重”。我对它们没有太多经验，但我记得看到这些被随附的[XRFF 文件](http://weka.wikispaces.com/XRFF#Additional%20features)应用于在分类之前更改数据集。为了找到 XRFF 属性权重页面，我遇到了[这篇文章](https://list.scms.waikato.ac.nz/pipermail/wekalist/2009-August/045043.html)，这可能很有用。

# python - 如何从 lighttpd mod_fastcgi 转换为 Apache 2.2 mod_fcgid

> ID：14863932
> 
> 赞同：0
> 
> 时间：2013-02-13T21:57:07.570
> 
> 标签：python, apache, fastcgi, flup

我有一个 Python 脚本，其中包含：

```
from flup.server.fcgi import WSGIServer

def processRequest(environ, start_response):
    # proprietary business logic here
    return

WSGIServer(
    application = processRequest,
    bindAddress = ('0.0.0.0', 6543),
    umask = 0
    ).run() 
```

我在带有 Python 2.7.3 的 ubuntu 12.04.2 LTS 服务器上从命令行运行这个 Python 脚本。

在同一台服务器上，我配置了 lighttpd 版本 1.4.28

```
server.modules = (
    "mod_access",
    "mod_alias",
    "mod_compress",
    "mod_redirect",
    "mod_setenv",
    "mod_fastcgi",
    "mod_accesslog"
)

$SERVER["socket"] == ":443" {
    ssl.engine = "enable"
    ssl.pemfile = "/etc/lighttpd/ssl/secret.pem"
    server.document-root = "/var/www"

    fastcgi.server = (
            "/MyFCGI/" =>
            ((
                "host" => "127.0.0.1",
                "port" => 6543,
                "check-local" => "disable"
            ))
    )
} 
```

当我`https://TheEffKyouDeeEnn/MyFCGI/blah/blahblah`使用 JSON 对象作为 POST 请求时，系统会按照我预期的方式运行，并将我的请求传递给在命令行上运行的 Python 脚本。

我需要在运行 Apache 2.2 的 MS-Windows Server 机器上配置相同的功能。我想保留将我的 Python 脚本部署在网络上任何位置的能力，而不仅仅是在具有 Apache 实例的服务器上。尽管文档似乎表明这是可能的，但至少使用 mod_fcgid，我自己无法使其工作，也找不到工作示例。

您能否确认 mod_fcgid 是合适的模块并举例说明如何配置 Apache 和 mod_fcgid 以复制我的 lighttpd 行为？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T22:15:17.303

这复制了与 Apache2.2 相同的功能。

```
    LoadModule fastcgi_module /usr/lib/apache2/modules/mod_fastcgi.so
    LoadModule headers_module /usr/lib/apache2/modules/mod_headers.so

    虚拟主机 *:80

        文档根目录 /var/www/

        标头集 Access-Control-Allow-Origin "*"
        标头集访问控制允许标头“内容类型”
        标头集 Access-Control-Allow-Methods "POST,GET,OPTIONS"

        AliasMatch ^/MyFCGI/.*$ /var/my_fcgi.py

        目录 /MyFCGI/
            选项 FollowSymLinks +ExecCGI
            允许覆盖所有
            SetHandler fastcgi 脚本
        /目录

         FastCgiExternalServer /var/my_fcgi.py -host localhost:6543

    /虚拟主机

```

# google-app-engine - 由于应用程序被别名隐藏，Google App Engine Datastore Admin 已停用

> ID：14863933
> 
> 赞同：1
> 
> 时间：2013-02-13T21:57:09.410
> 
> 标签：google-app-engine, data-migration, datastore-admin

最近，我使用迁移工具将我的应用程序迁移到了 High-Replication 数据存储。

*   Datastore Admin 页面现在无法正确显示：

    错误：服务器错误

    服务器遇到错误，无法完成您的请求。如果问题仍然存在，请报告您的问题并提及此错误消息和导致它的查询。

当我在旧应用程序（我从中迁移的应用程序）中访问 Datastore Admin 时，我收到以下通知：

*   此应用程序被别名隐藏。应用程序 lrweb2012 有一个别名，该别名导致它接收通常指向此的所有流量。除非您正在查找历史数据，否则您可能希望查看该应用程序。
*   数据存储区管理员已禁用。由于 lrweb2012 有一个隐藏此应用程序的别名，因此无法使用 Datastore Admin 工具。

任何有经验的人都可以建议发生了什么，以及我该如何解决这个问题？

干杯，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:19:51.813

您迁移了您的应用程序，因此您可能希望查看 lrweb2012-hrd 的管理员（或您将其迁移到的任何位置）而不是旧设置。使用左上角的下拉菜单选择不同的应用程序。

# meteor - 是否可以在流星 Accounts.onCreateUser 中使用 userId？

> ID：14863939
> 
> 赞同：0
> 
> 时间：2013-02-13T21:57:23.723
> 
> 标签：meteor

我想在创建时为用户初始化默认变量。有没有一种好方法可以做到这一点 - 我尝试在 onCreateUser 中使用 userId 但没有成功。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:08:54.837

仅供参考，从 Meteor 0.5.8 开始，_id 现在在 OnCreateUser 中有效...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T09:11:04.953

您可以简单地扩展用户集合以添加您想要的任何属性：

```
Accounts.onCreateUser(function(options, user) {
  // We still want the default hook's 'profile' behavior.
  if (options.profile) {
    user.profile = options.profile;
    user.profile.user_status = "new";
  }
  return user;
}); 
```

这不会更新除 之外的任何集合`users`，因此它不能用于将新用户`_id`作为外键存储在另一个集合中。

# javascript - 我试图了解改进 JavaScript 缩小的优化

> ID：14863941
> 
> 赞同：3
> 
> 时间：2013-02-13T21:57:32.357
> 
> 标签：javascript, optimization, minify

在深入研究[uniform.js](http://uniformjs.com/)源代码时，我发现了这个（在[#333](https://github.com/pixelmatrix/uniform/blob/master/jquery.uniform.js#L333)行）：

```
/**
* Meaningless utility function. Used mostly for improving minification.
*
* @return false
*/
function returnFalse() {
  return false;
} 
```

此函数在某些地方被调用（趋势似乎是`false`在这样的 JavaScript 对象文字中使用值的情况下（从第[#351](https://github.com/pixelmatrix/uniform/blob/master/jquery.uniform.js#L351)行开始）

```
bindMany($elem, options, {
  'selectstart dragstart mousedown': returnFalse
}); 
```

但不是在显式返回 false 的情况下。我的问题是为什么说这可以改善缩小？我的第一个想法是，通过拉`false`入一个函数，可以将函数重命名为“a”，因此`false`可以将预期的地方表示为`a()`，但这似乎并没有为我认为的执行中额外功能的成本。有没有更明显的东西我不明白？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T22:05:24.660

您应该注意，在您的示例`returnFalse`中没有被调用，而是被通过了。它被用来防止提供的事件的默认行为。

这种使用实用函数来防止默认行为的技术可以避免创建新的匿名函数来多次执行相同的操作：

```
$('foo').on('something', function () {
    return false;
});
//minified to something like:
$(a).on(b,function(){return !1}); 
```

对比

```
$('foo').on('something', returnFalse); 
//minified to something like:
function c(){return !1}
$(a).on(b,c); 
```

话虽如此，这是一种被误导的缩小方法，因为 jQuery 允许`false`传递事件处理程序以防止默认行为：

```
$('foo').on('something', false);
//minified to something like:
$(a).on(b,!1); 
```

# php - 如何在加载整个内容/页面/文件之前使用 PHP 获取标题？

> ID：14863943
> 
> 赞同：0
> 
> 时间：2013-02-13T21:57:40.720
> 
> 标签：php, get-headers

背景资料：

*   我正在从各种在线来源动态收集一些 URL。
*   如果它是 HTML 页面或图像，我想获取 URL 的内容。
*   我不想加载大文件（如下载的 zip、pdf 或其他文件）——只是为了意识到目标对我来说并不有趣。

**有没有办法在实际获取内容之前使用 PHP 检查响应类型/格式？**（避免浪费我自己和目标服务器的资源和带宽）

（我`get_headers()`在 PHP 文档中找到，但我不清楚该函数是否实际获取整个内容并返回标头，或者以某种方式仅从服务器获取标头，而不先下载内容。我还找到了解决方案带有 CURL 和 fsocketopen 的标头，但问题仍然存在，如果我可以在不加载实际内容的情况下做到这一点）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T22:03:41.733

尝试使用 HTTP **HEAD**请求仅检索标头。就像是：

```
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'HEAD'); 
```

或（手册建议的内容）：

```
curl_setopt($ch, CURLOPT_NOBODY, true); 
```

*（我还没有测试过这些。）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-11T22:45:37.893

有一个PHP函数：

```
$headers=get_headers("http://www.amazingjokes.com/img/2014/530c9613d29bd_CountvonCount.jpg");
print_r($headers); 
```

返回以下内容：

```
Array
(
    [0] => HTTP/1.1 200 OK
    [1] => Date: Tue, 11 Mar 2014 22:44:38 GMT
    [2] => Server: Apache
    [3] => Last-Modified: Tue, 25 Feb 2014 14:08:40 GMT
    [4] => ETag: "54e35e8-8873-4f33ba00673f4"
    [5] => Accept-Ranges: bytes
    [6] => Content-Length: 34931
    [7] => Connection: close
    [8] => Content-Type: image/jpeg
) 
```

在此之后应该很容易获得内容类型。

[更多阅读在这里（PHP.NET）](http://us1.php.net/manual/en/function.get-headers.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T23:31:59.750

这是使用带有 CURLOPT_WRITEFUNCTION 回调函数的 cURL 的解决方案。在其中，我检查传入的标头以查找内容类型。如果这不是我们想要的，它会告诉 cURL 中止，这样您就不会浪费时间获取请求的正文。

```
$ch = curl_init('http://stackoverflow.com/');
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HEADER, true);

$data = '';
$haveHeader = false;

curl_setopt($ch, CURLOPT_WRITEFUNCTION, function($ch, $chunk) use (&$haveHeader, &$data) {
    if (!$haveHeader && ($chunk == "\n" || $chunk == "\r\n")) {
        // detected end of header
        $haveHeader = true;
    } else if (!$haveHeader) {
        // detected content type
        if (preg_match('/content-type:\s*([^;]+)/i', $chunk, $matches)) {
            $contentType = strtolower($matches[1]);
            // check if content type is what we want
            if ($contentType != 'text/html' && strpos($contentType, 'image/') === false) {
                // tell curl to abort
                return false;
            }
        }
    } else {
        // append to data (body/content)
        $data .= $chunk;
    }

    return strlen($chunk);
});

if (curl_exec($ch)) {
    // use $data here
    echo strlen($data);
} 
```

# iphone - 计算 NSMutableArray 中有多少个唯一行

> ID：14863951
> 
> 赞同：0
> 
> 时间：2013-02-13T21:57:54.953
> 
> 标签：iphone, ios, xcode

我有一个 NSMutableArray 并说我在那里有一个“天”列，其中包含的数据范围从 0-4 说我有 5 行这样

```
0
0
1
2
3 
```

我想计算有多少独特的项目，所以在这种情况下它会返回 4，因为它不会计算第二个 0。

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:04:40.713

怎么样`[NSSet setWithArray:yourArray].count`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:01:39.267

这是直截了当的。您想要做的是删除数组中的重复项并获取唯一项的计数。这可以通过使用 NSSet 和 NSMutableArray 来完成：

```
[uniqueArray addObjectsFromArray:[[NSSet setWithArray:duplicateArray] allObjects]];
[uniqueArray count]; 
```

希望这有帮助

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-13T22:09:42.390

如果您的数组已经排序，您可以通过它进行一次传递，维护一个包含“当前”值的变量和一个计数器，每次当前值与索引处的值不匹配时递增（然后更新“当前”值以匹配。这需要比上面更多的代码行，但如果数组足够大，从所有数组元素构建一个集合是一项足以影响性能的大任务，则速度要快得多。

# javascript - 以编程方式为 grunt 任务设置选项？

> ID：14863959
> 
> 赞同：16
> 
> 时间：2013-02-13T21:58:44.523
> 
> 标签：javascript, gruntjs

我有一个繁重的任务，用`grunt.option('foo')`. 如果我从 调用此任务`grunt.task.run('my-task')`，我该如何更改这些参数？

我正在寻找类似的东西：

```
grunt.task.run('my-task', {foo: 'bar'}); 
```

这相当于：

```
$ grunt my-task --foo 'bar' 
```

这可能吗？

（[这个问题](https://stackoverflow.com/questions/14780622/programmatically-pass-arguments-to-grunt-task)是我遇到的另一个问题，但并不完全相同，因为在这种情况下，我无法访问原始任务的 Gruntfile.js。）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-09-23T08:55:54.923

如果您可以使用基于任务的配置选项而不是 grunt.option，这应该可以为您提供更精细的控制：

```
grunt.config.set('task.options.foo', 'bar'); 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-02-13T22:39:52.353

看起来我可以使用以下内容：

```
grunt.option('foo', 'bar');
grunt.task.run('my-task'); 
```

全局设置选项而不是只为该命令设置选项感觉有点奇怪，但它确实有效。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-07-28T20:52:13.707

创建一个设置选项的新任务，然后调用修改后的任务。[这是assemble](http://assemble.io)的真实示例：

```
grunt.registerTask('build_prod', 'Build with production options', function () {
  grunt.config.set('assemble.options.production', true);
  grunt.task.run('build');
}); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-04-21T13:32:46.603

除了@Alessandro Pezzato

Gruntfile.js：

```
grunt.registerTask('build', ['clean:dist', 'assemble', 'compass:dist', 'cssmin', 'copy:main']);

    grunt.registerTask('build-prod', 'Build with production options', function () {
        grunt.config.set('assemble.options.production', true);
        grunt.task.run('build');
    });

    grunt.registerTask('build-live', 'Build with production options', function () {
        grunt.option('assemble.options.production', false);
        grunt.task.run('build');
    }); 
```

现在你可以运行

`$ grunt build-prod`

-或者-

`$ grunt build-live`

他们都将完成完整的任务“构建”，并分别将值传递给[assemble 的选项之一](http://assemble.io/docs/Options.html)，即生产“真”或“假”。

* * *

除了更多地说明 assemble 示例：

在 assemble 中，您可以选择添加`{{#if production}}do this on production{{else}}do this not non production{{/if}}`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-01-03T09:01:58.897

grunt 都是程序化的。所以如果你之前已经为任务设置了选项，那么你已经以编程方式完成了。

仅用于`grunt.initConfig({ ... })`设置任务的选项。

如果您已经初始化，并且之后需要更改配置，您可以执行类似的操作

`grunt.config.data.my_plugin.goal.options = {};`

我将它用于我的项目并且它有效。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-11-03T05:49:51.400

我最近遇到了同样的问题：以编程方式设置 grunt 选项并从单个父任务中多次运行任务。正如@Raphael Verger 提到的，这是不可能的，因为`grunt.task.run`将任务的运行推迟到当前任务完成：

```
grunt.option('color', 'red');
grunt.task.run(['logColor']);
grunt.option('color', 'blue');
grunt.task.run(['logColor']); 
```

将导致*蓝色*被记录两次。

经过一番摆弄，我想出了一个 grunt 任务，它允许为每个要运行的子任务动态指定不同的选项/配置。我已将任务发布为[grunt-galvanize](https://github.com/dylancwood/grunt-galvanize)。以下是它的工作原理：

```
var galvanizeConfig = [
  {options: {color: 'red'}, configs: {}},
  {options: {color: 'blue'}, configs: {}}
];
grunt.option('galvanizeConfig', galvanizeConfig);
grunt.task.run(['galvanize:log']); 
```

这将记录*red**然后*blue *，*根据需要通过在.*`galvanizeConfig`*

# javascript - Javascript AND 语句语法

> ID：14863960
> 
> 赞同：0
> 
> 时间：2013-02-13T21:58:46.853
> 
> 标签：javascript, forms, syntax

我正在尝试对一系列用户输入值（-180 到 180）进行简单的表单验证，但代码的行为与我预期的不同。

```
function validateForm()
{
retVal = true;

lon = document.getElementById("LON").value;
if ((lon  >= -180 && lat <= 180 )== false) 
retVal=false;

if(retVal == false)
{

alert('Please correct the errors');
return false;
}
return retVal;
} 
```

因此，例如，如果我输入 -254 的值，我会按预期收到警报。但是，如果我输入任何大于 -181 的值，我就不会收到警报。我在这里想念什么？

警告：我是新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-13T22:00:25.137

我想你应该检查`lon`变量不小于`-180`和不大于`180`。使用这个简单的`if`语句：

```
var lon = document.getElementById("LON").value;
if (lon < -180 || lon > 180)
    retVal = false; 
```

需要注意的是，您最好使用`var`关键字定义局部变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-13T22:06:58.220

你有初始化的“lon”，但“lat”在哪里被初始化？

以下应该有效：

```
function validateForm()
{
    var lon = document.getElementById("LON").value;        
    var lat = document.getElementById("LAT").value;

    var isValid = (lon  >= -180 && lat <= 180 );

    if ( !isValid)        
    {
        alert('Please correct the errors');
    }

    return isValid;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-13T22:11:10.487

如果要在某个范围内进行验证，则 if 条件应仅检查单个变量，如果为 true，则返回 true，否则显示错误并返回 false。

```
function validateForm()
{
    retVal = true;

    lon = document.getElementById("LON").value;
    if (lon  >= -180 && lon <= 180) 
    {
    return retVal;
    }
    else
    {
    alert('Please correct the errors');
    retVal = false;
    return retVal;
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-13T22:05:38.110

你根本不需要那个`if()`- 只需设置`retval`为表达式中的布尔值......

```
function validateForm() {
    var lon = document.getElementById("LON").value;
    var retval = (lon  >= 180 || lon <= -180);
    if(!retVal) { alert('Please correct the errors'); }
    return retVal;
} 
```

# php - SQL fiddle 和 MySQL 服务器/PhpMyadmin 的结果不同

> ID：14863961
> 
> 赞同：6
> 
> 时间：2013-02-13T21:58:55.140
> 
> 标签：php, mysql

这是 sql 小提琴：[http ://sqlfiddle.com/#!2/e6acc/4](http://sqlfiddle.com/#!2/e6acc/4)

它显示了正确的结果，因为我希望枚举重复的条目。

但是当我在 mysql/phpmyadmin 上运行时，结果是这样的：

```
1515    Abdominal
1100    Hep B Inj Fee
40  1-Ligation
40  1-Ligation
900 1-Suturing Fee
900 1-Suturing Fee
900 1-Suturing Fee
900 1-Suturing Fee 
```

都是1。我已经重新启动了我的电脑。它仍然是一样的。这是为什么？我刚刚从我的 mysql 中检索了 csv 表到小提琴。

编辑：好的，这越来越奇怪了。在我的前端，当我查看其他 ID 时它可以工作： ![在此处输入图像描述](../Images/5eb0b1e3005c525a0b5100cfa8c97125.png)

但是，当我更改查询中的 id 并在 phpmyadmin 上输入时，它仍然显示 1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T10:13:15.297

我不知道为什么 SQL Fiddle 与实际结果不同，但我设法让它在 PHP 中为我工作。使用以下查询：

```
SELECT
  c.procno,
  CONCAT(CASE WHEN cnt > 1 THEN CONCAT(RN,'-') ELSE '' END, t.Proc) Proc
FROM
  (
    SELECT
      @curRow:=CASE WHEN @prevRow = a.Proc THEN @curRow+1 ELSE 1 END AS rn,
      a.Proc,
      a.Procno,
      @prevRow:=Proc grp
    FROM (    
          SELECT
            `incurredcharges`.`procedure_no` procno,
            `c`.`procedure` proc
          FROM
            incurredcharges
            INNER JOIN (
              SELECT `procedure`, `procedure_no` FROM `charges`
              UNION ALL
              SELECT `confinement`, `procedure_no` FROM `confinement`
              UNION ALL
              SELECT `service`, `procedure_no` FROM `ultrasound`
            ) c ON `incurredcharges`.`procedure_no` = c.`procedure_no`
          WHERE `incurredcharges`.`patient_no` = '34'
          ORDER BY `c`.`procedure`
      ) a 
          JOIN (SELECT @curRow:=0, @prevRow:= '') r
  ) t JOIN
  (
          SELECT
            `incurredcharges`.`procedure_no` procno,
            `c`.`procedure` proc, Count(*) cnt
          FROM
            incurredcharges
            INNER JOIN (
              SELECT `procedure`, `procedure_no` FROM `charges`
              UNION ALL
              SELECT `confinement`, `procedure_no` FROM `confinement`
              UNION ALL
              SELECT `service`, `procedure_no` FROM `ultrasound`
            ) c ON `incurredcharges`.`procedure_no` = c.`procedure_no`
          WHERE `incurredcharges`.`patient_no` = '34'
          GROUP BY `incurredcharges`.`procedure_no`,
            `c`.`procedure`
  ) c ON t.proc = c.proc 
```

我唯一改变的是第 27 行从`JOIN (SELECT @curRow:=0) r`到`JOIN (SELECT @curRow:=0, @prevRow:= '') r`

# c# - WebBrowser (win form) 不透明度

> ID：14863965
> 
> 赞同：0
> 
> 时间：2013-02-13T21:59:18.450
> 
> 标签：c#, webbrowser-control, opacity

我在另一个控件之上有一个系统 Windows 窗体 Web 浏览器。Web 浏览器有一个图像集。

Web 浏览器控件的顶部是一个继承的面板，我可以在其中控制不透明度。

如果我让它透明，它不会显示 Web 浏览器图像，它会显示 Web 浏览器下控件的背景颜色。

即第 1 层控制。背景颜色为蓝色 Layer2 Web 浏览器，图像为 HTML Layer3 透明面板

Layer3 透明时显示 layer1 而不是 layer2

如何使 web 浏览器不透明，以便 layer3 显示到 layer2 (webbrowser) ？

我尝试设置 SetStyles 来控制 Web 浏览器的不透明度。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-13T23:56:52.620

**简短的回答：**

你不能。

**现实世界的解决方案：**

你看过WPF吗？

**长答案：**

不透明度是 WinForms 的一个技巧。

当控件被标记为透明（或半透明）显示时，WinForms 会查询父对象的视觉效果以询问“如果我的控件不存在，您会在这里打印什么？”。从这个结果中，WinForms 要么显示控件的像素、父级的像素，要么显示两者的组合（如果是半透明的）。

这在一个简单的例子中变得非常明显：

1.  创建一个新的winforms项目
2.  创建 2 个标签，将它们重叠放置（稍微偏移）
3.  将两个标签背景设置为`Color.Transparent`

您会立即看到透明度从下面的标签中取出一大块。

**示例代码**（全部在一个文件中，编译并运行）：

```
using System;
using System.Windows.Forms;
using System.Drawing;

namespace WindowsFormsApplication5
{
    static class Program
    {
        /// <summary>
        /// The main entry point for the application.
        /// </summary>
        [STAThread]
        static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);
            Application.Run(new MainForm());
        }
    }
    public class MainForm : Form
    {
        private Random random = new Random();
        private Button btnRandomBackgroundColor;
        private Label lblBackgroundLabel;
        private Label lblTransparent;

        public MainForm()
        {
            InitializeComponent();
        }

        private void button_Click(object sender, EventArgs e)
        {
            BackColor = Color.FromArgb(random.Next(0, 255),
                                            random.Next(0, 255),
                                            random.Next(0, 255));
        }

        private void InitializeComponent()
        {
            this.btnRandomBackgroundColor = new System.Windows.Forms.Button();
            this.lblBackgroundLabel = new System.Windows.Forms.Label();
            this.lblTransparent = new System.Windows.Forms.Label();
            this.SuspendLayout();
            // 
            // btnRandomBackgroundColor
            // 
            this.btnRandomBackgroundColor.Location = new System.Drawing.Point(12, 12);
            this.btnRandomBackgroundColor.Name = "btnRandomBackgroundColor";
            this.btnRandomBackgroundColor.Size = new System.Drawing.Size(144, 23);
            this.btnRandomBackgroundColor.TabIndex = 0;
            this.btnRandomBackgroundColor.Text = "Randomize Background Color";
            this.btnRandomBackgroundColor.UseVisualStyleBackColor = true;
            this.btnRandomBackgroundColor.Click += button_Click;
            // 
            // lblBackgroundLabel
            // 
            this.lblBackgroundLabel.AutoSize = true;
            this.lblBackgroundLabel.BackColor = System.Drawing.Color.Transparent;
            this.lblBackgroundLabel.Font = new System.Drawing.Font("Microsoft Sans Serif", 21.75F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblBackgroundLabel.Location = new System.Drawing.Point(41, 49);
            this.lblBackgroundLabel.Name = "lblBackgroundLabel";
            this.lblBackgroundLabel.Size = new System.Drawing.Size(184, 33);
            this.lblBackgroundLabel.TabIndex = 1;
            this.lblBackgroundLabel.Text = "Simple Label";
            // 
            // lblTransparent
            // 
            this.lblTransparent.AutoSize = true;
            this.lblTransparent.BackColor = System.Drawing.Color.Transparent;
            this.lblTransparent.Font = new System.Drawing.Font("Microsoft Sans Serif", 21.75F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((byte)(0)));
            this.lblTransparent.Location = new System.Drawing.Point(61, 63);
            this.lblTransparent.Name = "lblTransparent";
            this.lblTransparent.Size = new System.Drawing.Size(251, 33);
            this.lblTransparent.TabIndex = 2;
            this.lblTransparent.Text = "Transparent Label";
            // 
            // Form1
            // 
            this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
            this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
            this.BackColor = System.Drawing.Color.White;
            this.ClientSize = new System.Drawing.Size(341, 114);
            Controls.Add(this.lblTransparent);
            this.Controls.Add(this.lblBackgroundLabel);
            this.Controls.Add(this.btnRandomBackgroundColor);
            this.Name = "Form1";
            this.Text = "MainForm";
            this.ResumeLayout(false);
            this.PerformLayout();

        }
    }
} 
```

# php - PHP重复图像问题

> ID：14863966
> 
> 赞同：0
> 
> 时间：2013-02-13T21:59:23.797
> 
> 标签：php

我正在尝试为从数据库返回的一些图像设置 id 属性

id 属性仅适用于用户单击的图像。

我的问题是我有重复的图像，很难区分不同的图像。

我将单击的图像存储`src`到数据库中以识别哪个图像应该具有 id 属性。

当用户单击图像时，ID 将自动生成。

我的html就像

```
<div>
  <img src='test1.jpg'/>
  <img src='test1.jpg'/>
  <img src='test1.jpg'/>
  <img src='test2.jpg'/>
  <img src='test3.jpg'/>
</div> 
```

在 php 中渲染图像

```
$html is the string that are returning from DB. it has all kind of html tags.

$doc = new DOMDocument();

@$doc->loadHTML($html);

$imageTags = $doc->getElementsByTagName('img');

$imgSource is the array of images that are supposed to have id attribute
$imgID is the array of ids for the images that were clicked
$source is the current image taht are being checked

  foreach($imageTags as $tag) {
    $source=$tag->getAttribute('src');

    if(in_array($source, $imgSource)){
         $ids=array_keys($imgSource,$source);
                 foreach($ids as $id){
                    $tag->setAttribute('id',$imgID[$id]);
                    $htmlString=$doc->saveHTML();

                  }
              }
} 
```

`test1`如果用户点击和`test2`图像，我上面的代码将生成如下所示的 html

```
<div>
  <img id='123' src='test1.jpg'/>
  <img id='123' src='test1.jpg'/>
  <img id='123' src='test1.jpg'/>
  <img id='456' src='test2.jpg'/>
  <img src='test3.jpg'/>
</div> 
```

`id`123适用于所有人`test1.jpg`，这不是我想要的。我试图通过查找图像位置索引来避免这个问题。因此，如果用户单击第二个`test1.jpg`，则索引将为 2。如果用户单击第三个`test1.jpg`，则索引将为 3。

但是，我不确定如何将其应用于我的 php 代码。我当时只能更改php中的代码。任何人都可以帮助我吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:11:56.573

未经测试，但这就是想法：

```
 $counter = array();
  foreach($imageTags as $tag) {
    $source=$tag->getAttribute('src');

    if(in_array($source, $imgSource)){
         $ids=array_keys($imgSource,$source);
                 foreach($ids as $id){
                    $counter[$imgID[$id]] = isset($counter[$imgID[$id]]) $counter[$imgID[$id]] + 1 : 0;
                    $tag->setAttribute('id',$imgID[$id] . '-' . $counter[$imgID[$id]]);
                    $htmlString=$doc->saveHTML();

                  }
              } 
```

你会得到像这样的ID：

```
<div>
  <img id='123.0' src='test1.jpg'/>
  <img id='123-1' src='test1.jpg'/>
  <img id='123-2' src='test1.jpg'/>
  <img id='456-0' src='test2.jpg'/>
</div> 
```

# git - 防止 git 在拉取期间覆盖跟踪的忽略文件

> ID：14863968
> 
> 赞同：1
> 
> 时间：2013-02-13T21:59:39.053
> 
> 标签：git, version-control, gitignore, git-pull

所以有一个文件已经被 git 跟踪，称为 file.php...这是在协作环境中

我对该文件进行了更改，我不想提交它，但我希望更改保留在我的本地环境中，所以我这样做了

```
1\. git update-index --assume-unchanged file.php
2\. Added file.php to gitignore 
```

并且对文件的更改不会被提交，等等，这工作正常

问题是......每当我做 a`git pull origin master`时，拉总是试图覆盖该文件

我试过这样做`git rm --cached file.php`，但这会取消跟踪文件并需要提交，我不想在忽略这个时影响中央存储库..

如何让 git 在拉取期间忽略跟踪的文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T00:06:18.757

该[`gup`脚本](http://jasoncodes.com/posts/gup-git-rebase)是为您制作的：它存储您的更改、拉取和弹出您的更改，因此您将能够更新您的存储库而无需 git 对您大喊大叫。

还有更聪明的[`git-up`脚本](https://github.com/aanand/git-up)，但此时 Windows 支持看起来不完整。

# php - 使用 file_get_content 检索图像文件时遇到困难

> ID：14863969
> 
> 赞同：0
> 
> 时间：2013-02-13T21:59:44.757
> 
> 标签：php, string, file-get-contents, image-uploading

我正在尝试获取图像路径并在 tmp 目录中打开相应的图像，但该页面仅显示一个空的 img 占位符图片。提前致谢

```
public function getImage($path)
    {
        if($result = $this->db->prepare("SELECT filename FROM trips WHERE filename=?"))
        {
            $result->bind_param('s', $path);
            $result->execute();
            $result->bind_result($filename);
            if($result->fetch())
            {

                    header("Content-type: image/jpeg");

                    if(!file_exists("C:/xampp/htdocs/webshop/public/img/content/" . $filename))
                    {
                         imagefilter($image, IMG_FILTER_GRAYSCALE);
                         imagejpeg($image, "C:/xampp/htdocs/webshop/public/img/content/" . $filename);
                    }
                    else
                    {
                        $image = imagecreatefromjpeg("C:/xampp/htdocs/webshop/public/img/content/" . $filename);
                    }

                        imagejpeg($image);
            }
            else
            {
                echo "error";
            }
        }
        else
        {
            echo "Table retrieve failed: (" . $this->db->error . ") " .$this->db->error;
        }
        var_dump($img);
        return $image;
    } 
```

# c# - 我正在尝试使用 linq 简化一条语句，该语句采用 2 个数字列表并从第二个列表中减去第一个列表

> ID：14863970
> 
> 赞同：4
> 
> 时间：2013-02-13T21:59:46.100
> 
> 标签：c#, .net, performance, linq

我正在尝试使用 linq 简化并希望更便宜的语句，该语句需要 2 个数字列表并从第二个数字列表中减去第一个数字列表。我有一些有用的东西，但我认为它可以更清洁、更高效。

```
double[] main = _mainPower.Select(i => i.Decibels).ToArray();
double[] reference = _referencePower.Select(i => i.Decibels).ToArray();

List<double> amplitudeList = new List<double>();
for (int i = 0; i < main.Count(); i++)
{
     if (!double.IsNaN(main[i] - reference[i]))
     {
          amplitudeList.Add(main[i] - reference[i]);
     }
}

 return amplitudeList; 
```

如果我有 2 个列表 List1 = {8,5,3} 和 List2 = {5,2,1} 返回的列表将是 {3,3,2} 我试过

```
return _mainPower.Select(i => i.Decibels - _referencePower.Select(a => a.Decibels)); 
```

但这显然不起作用。有没有办法将我的函数变成一个不错的 linq 查询？我不允许的一件事是列表是否有两种不同的大小。如果大小不同，则应从末尾修剪较长的列表，以使其与较小的列表相同。

任何帮助，将不胜感激。

谢谢，

- 编辑 -

感谢您使用 StriplingWarrior 的帖子获得所需的帮助。

```
_mainPower.Zip(_referencePower, (v1, v2) => v1.Decibels - v2.Decibels).Where(i => !double.IsNaN(i)); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-13T22:06:03.447

这应该这样做：

```
return _mainPower.Zip(_referencePower,(v1, v2) => v1-v2) 
```

# jquery - 在 Ajax 中使用 jQuery 的消息

> ID：14863971
> 
> 赞同：0
> 
> 时间：2013-02-13T21:59:46.117
> 
> 标签：jquery, ajax

我遇到了 jQuery 消息的问题，我下载了一个插件来在 jQuery 中发出很好的警报，它被命名为 Apprise，并且消息工作正常。

我只需要把它放在头标签中：

```
<script src="../js/jquery-1.9.0.js"></script>
<script src="../js/apprise.js"></script>
<link rel="stylesheet" href="../css/apprise.css"> 
```

然后编写 apprise() 而不是 alert() 来显示消息，问题是我必须在 Ajax 函数中调用函数 apprise() 而这不起作用。

```
$.ajax({
  type: "POST",
  url: "../includes/register.php",
  data: dataString,
  success: function(data) {
    apprise('Sucessful');
    location.reload();
  }
}); 
```

如果我把它当作回报，apprise 就可以工作，但不要重新加载页面。谢谢您的帮助！

# c# - C# Socket 发送图片 JPEG

> ID：14863972
> 
> 赞同：1
> 
> 时间：2013-02-13T21:59:46.207
> 
> 标签：c#, sockets, jpeg, mirc

所以我在stackoverflow中找到了一个用于通过套接字发送二进制文件、图像的代码。所以我用它来测试我的项目

```
private void send_ss()
    {
        byte[] data = new byte[1024];
        int sent;
        IPEndPoint ipep = new IPEndPoint(IPAddress.Parse("127.0.0.1"), 306);

        Socket server = new Socket(AddressFamily.InterNetwork,
                        SocketType.Stream, ProtocolType.Tcp);

        try
        {
            server.Connect(ipep);
        }
        catch (SocketException e)
        {
            //Console.WriteLine("Unable to connect to server.");
            //Console.WriteLine(e.ToString());
            //Console.ReadLine();
        }

        Bitmap bmp = new Bitmap("C:\\Windows\\Web\\Wallpaper\\Theme2\\img7.jpg");

        MemoryStream ms = new MemoryStream();
        // Save to memory using the Jpeg format
        bmp.Save(ms, System.Drawing.Imaging.ImageFormat.Jpeg);

        // read to end
        byte[] bmpBytes = ms.ToArray();
        bmp.Dispose();
        ms.Close();

        sent = SendVarData(server, bmpBytes);

        //Console.WriteLine("Disconnecting from server...");
        server.Shutdown(SocketShutdown.Both);
        server.Close();
    }
    private static int SendVarData(Socket s, byte[] data)
    {
        int total = 0;
        int size = data.Length;
        int dataleft = size;
        int sent;

        byte[] datasize = new byte[4];
        datasize = BitConverter.GetBytes(size);
        sent = s.Send(datasize);

        while (total < size)
        {
            sent = s.Send(data, total, dataleft, SocketFlags.None);
            total += sent;
            dataleft -= sent;
        }
        return total;
    } 
```

所以我尝试在端口 306 中的一个侦听套接字上发送这张图片（使用 m IRC 侦听）

```
on *:socklisten:ac_img:{
  var %p = $ticks $+ $time(hhnnss) $+ $ctime
  sockaccept ac_img_ $+ %p
  echo -s [] Image Connection Established On -> ac_img_ $+ %p
}
on *:sockread:ac_img_*:{
  sockread &picture 
  bwrite $qt($mIRCdir $+ $sockname $+ .jpg) -1 -1 &picture 
} 
```

所以我得到了 ac_img_2920385501147471360792067.jpg 等文件。与原始大小相同，但图像只是没有出现，所以我用写字板打开了两个文件，它们有点不同......不知道为什么......![截屏](../Images/86bcf1f28c758cf70cb1c924494c2df8.png)

那么有什么想法为什么我会面临这个问题？我的意思是......我正在从我的套接字中获取每一个数据并将它们保存到文件中？也许通过 c# 读取的文件损坏？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T22:52:04.860

图像是不同的，因为您读取它，将其解析为 a`Bitmap`并重新编码。写字板屏幕截图显示两者都是 JPEG，但元数据不同（例如“adobe”缺失）。

只需使用`File.ReadAllBytes`或其他无损方法读取图像。

发送代码看起来不错。不知道你为什么要循环。发送永远不会在阻塞套接字上执行部分 IO AFAIK。

# rpgle - RPGLE 编译错误：“未定义名称或指示符”

> ID：14863973
> 
> 赞同：1
> 
> 时间：2013-02-13T21:59:46.963
> 
> 标签：rpgle

我正在上 IBM iSeries 和 Rational Developer 的入门课程，我在为实验室编译我的一个 RPGLE 程序时遇到了困难……不幸的是，实验室只是我们应该编译的代码的演练，没有太多解释，所以我完全不知道我在做什么......

当我编译我的程序 MARKSRPG.RPGLE 时，我的大部分错误都是“未定义名称或指示符”......我不知道这是什么意思，我无法继续查看我是否编写了代码到目前为止工作。

***（更新：我已经对建议进行了更正，现在我得到了不同的错误。“左右手边的类型在 EVAL 操作中不匹配”和“操作数与操作员。）***

该程序分为两个文件：MARKSRPG.RPGLE 和 MARKSDSP.DSPF。这是两者的代码，但我的错误只显示在 MARKSRPG.RPGLE

MARKSDSP：

```
 A          R RECORD1
 A                                  1 33'Marks Calculator'
 A                                  2  2USER
 A                                  1  2SYSNAME
 A                                  1 72DATE
 A                                  4 24'Test 1:'
 A                                  5 24'Test 2:'
 A                                  6 24'Test 3:'
 A                                  7 24'Labs:'
 A                                  8 24'Exam:'
 A            TEST1          3  0B  4 32RANGE(0 100)
 A            TEST2          3  0B  5 32RANGE(0 100)
 A            TEST3          3  0B  6 32RANGE(0 100)
 A            LABS           3  0B  7 32RANGE(0 30)
 A            EXAM           3  0B  8 32RANGE(0 100)
 A            FIELD           T  B  2 71

 A          R RECORD2                   CA03(03 'Exit')
 A                                      OVERLAY
 A                                 10 23'Tests:'
 A                                 11 18'Final Mark:'
 A                                 12 17'Final Grade:'
 A            TESTOVRLL      3  0O 10 30
 A            NUMGRADE       3  0O 11 30
 A            GRADE          2X  O 12 30
 A                                 13 17'F3 - Exit' 
```

MARKSRPG：

```
 FMARKSDSP  CF   E             WORKSTN
 DLETGRADE         S              1A
 DTESTOVRLL        S              3A
  /FREE
       EXFMT RECORD1;
       DOW NOT(*IN03);
               EXSR GETGRADE;
               WRITE RECORD1;
               EXFMT RECORD2;
               IF *IN03= *OFF;
                 EXSR CLEARMARKS;
                 EXFMT RECORD1;
               ENDIF;
             ENDDO;
       *INLR = *ON;
       RETURN;
       BEGSR GETGRADE;
         LETGRADE = 'F';
         TESTOVRLL = (TEST1 + TEST2 + TEST3)/3;
         NUMGRADE = (TESTOVRLL/100*.30) + LABS +(EXAM/100*.35);
        ENDSR;
        BEGSR CLEARMARKS;
          TEST1 = 0;
          TEST2 = 0;
          TEST3 = 0;
          LABS = 0;
          EXAM = 0;
          TESTOVRLL = 0;
        ENDSR;
  /END-FREE 
```

如果您知道任何有用的学习 RPGLE 和 CLLE 的资源，我将不胜感激，任何额外的见解和帮助也会很棒！

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:48:27.513

在您的 RPGLE 成员中，您的显示文件名称错误。你有`MARKSRPG`而不是`MARKSDSP`.

我也没有在任何地方看到 LETGRADE 定义，这应该在你的 D 规范中。

```
D LETGRADE           s            1a 
```

我也没有看到`CLEARMARKS`任何地方定义的子例程。因为我也没有在任何地方看到 /end-free，所以我假设您没有为您的 RPGLE 成员粘贴所有代码。

进行我提到的这两个更改，然后返回任何问题。

以下是 IBM i 信息中心的链接：http: [//publib.boulder.ibm.com/infocenter/iseries/v6r1m0/index.jsp ?topic=/rzasd/sc09250802.htm](http://publib.boulder.ibm.com/infocenter/iseries/v6r1m0/index.jsp?topic=/rzasd/sc09250802.htm)

# xcode - 未找到 BUILT_PRODUCTS_DIR

> ID：14863977
> 
> 赞同：1
> 
> 时间：2013-02-13T21:59:53.383
> 
> 标签：xcode

我有一个包含嵌入式框架的应用程序。我想在构建项目时从这些框架中删除标题。但是，我不想删除应用程序包装器中的其他标头。（我正在为 C 和 C++ 编写一个集成开发环境，它必须包含头文件，以便捆绑的编译器能够工作。）我有一个运行脚本阶段，它使用 Unix工具来定位和`find`删除目录（以及指向的符号链接）给他们）来自嵌入式框架。当我构建用于 Xcode 的调试器时，它工作正常。`Headers``PrivateHeaders`

但是，当我使用 Xcode 的 Archive 命令执行发布时，`${BUILT_PRODUCTS_DIR}`变量不再正确展开。调查表明它指向一个不存在的目录。大概 Xcode 在归档过程中自动删除了这个目录，然后我才能在 Finder 中打开它并查看它的内容。

如何`.app`在创建 Xcode 存档时正常工作的运行脚本构建阶段获取包目录的路径？`find`然后，我可以使用和`${FRAMEWORKS_FOLDER_PATH}`变量从嵌入式框架中删除标头。

我已经尝试使用 Xcode 方案中的后操作删除标头，但这无法正常工作，因为它会删除**所有**头文件，而不仅仅是嵌入式框架中的头文件。这是因为方案后操作找不到`.app`目录。（我曾尝试使用“Provide Build Settings From”弹出菜单，并且通过验证`printenv`它确实正确导出了设置，但`.app`仍然找不到该目录。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:20:52.347

我自己想通了。当我归档我的项目并在归档下添加一个运行脚本后操作时，我进入了我正在使用的方案。这是我使用的脚本的内容：

`find "${ARCHIVE_PRODUCTS_PATH}/${INSTALL_DIR}/${FRAMEWORKS_FOLDER_PATH}" \
-name "Headers" -exec rm -r {} \;
find "${ARCHIVE_PRODUCTS_PATH}/${INSTALL_DIR}/${FRAMEWORKS_FOLDER_PATH}" \
-name "PrivateHeaders" -exec rm -r {} \;`

请注意，如果您自己执行此操作，则必须将虚构`INSTALL_DIR`变量替换为您的应用程序包装器的位置。您可以在应用程序目标的构建设置屏幕中找到它；寻找“安装目录”。（应用程序包装器的名称是`FRAMEWORKS_FOLDER_PATH`变量的一部分，这就是您在上面没有看到它的原因。）

# ups - 将 EPL 图像转换为 PDF？

> ID：14863978
> 
> 赞同：7
> 
> 时间：2013-02-13T21:59:57.243
> 
> 标签：ups, image-formats, epl

我正在使用 UPS API 生成 EPL 标签以在我们的热敏打印机上打印，该打印机使用 CUPS 和`lpr`.

但是，我希望能够以计算机可呈现的格式保存该标签：GIF、PDF、PostScript - 任何东西，真的。

我一直无法找到一个库来将原始 EPL 数据转换为任何其他格式。有没有图书馆可以做到这一点？或者将输出到文件而不是打印机的 LPR 选项或包？如何完成将 Eltron 编程语言文件转换为其他文件？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-03-08T23:00:48.767

无法以编程方式将 EPL 渲染为图像。然而。

# jframe - 在哪里更新 JFrame

> ID：14863981
> 
> 赞同：0
> 
> 时间：2013-02-13T21:59:59.660
> 
> 标签：jframe

嗨，我有一个 JFrame 类，我根据从另一个类收到的信息进行更新。我在 JFrame 中创建了一个更新方法，用于更新页面上的不同对象。但我的问题是这样做是正确的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-30T21:46:24.007

你可以随心所欲地制作它，没有“正确”的方法。这都是偏好问题。就个人而言，我喜欢这种方式。在我几乎所有的 GUI 中，我都有一个名为“update()”或类似的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-30T06:25:29.097

它取决于如何触发更新，但使用事件侦听器和 actionCommands 可能会有所帮助。我不一定喜欢这种方法，但它很方便。

# javascript - JQuery 和子选择器 A > B：不工作？[Chrome 24，JQmobile]

> ID：14863982
> 
> 赞同：1
> 
> 时间：2013-02-13T22:00:00.250
> 
> 标签：javascript, jquery, jquery-mobile, jquery-selectors

**给定嵌套的html：**

```
<a class="star">Hello world!
 <a class="ui-icon-star"> hello </a>
</a> 
```

我使用**了以下JS：**

```
$('.star').click(function () {
    $(this).toggleClass("favorited");
    $(this > '.ui-icon-star').toggleClass("ui-icon-starred");
}); 
```

更改 .star 和子 .ui-icon-star 元素，但它不适用于子元素。我的 [selector(?)] 错误在哪里？我猜大约是 $(this > '.ui-icon-star')。

1： http: [//jsfiddle.net/tNwND/1/](http://jsfiddle.net/tNwND/1/) 2：[http ://www.w3.org/TR/CSS21/selector.html](http://www.w3.org/TR/CSS21/selector.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-13T22:05:09.370

那是因为您的标记无效，浏览器以这种方式呈现您的标记：

```
<a class="star">Hello world! </a>
<a class="ui-icon-star"> hello </a> 
```

所以点击的元素没有`.ui-icon-star`子元素。

# javascript - 固定 div 作为移动设备上的背景

> ID：14863984
> 
> 赞同：0
> 
> 时间：2013-02-13T22:00:12.327
> 
> 标签：javascript, jquery, css, mobile-devices

我想使用 a`div`作为网站的背景。

如果我使用`position:fixed`并将宽度和大小设置为视口大小，则移动设备/平板电脑上的设计会中断，因为它们不支持固定位置。

将 div 设置为静态背景以使其也适用于移动设备的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T23:02:35.980

我不完全确定您打算如何使用背景，但我在这里创建了一种松散的方式来执行此[操作](http://jsbin.com/oziraz/4/edit)。俗气的背景应用于屏幕大小的 div，并且它不会移动（只要您小心放入其中的内容）。然而，同样的效果可以通过直接在 body 上的样式来实现——我不确定你到底需要 div 做什么，所以我不能保证这种技术适用于你的用例。

### 这个怎么运作

在排除免责声明的情况下，这里有一些关于它如何工作的细节。所有内容都必须出现在两个 div 中：一个具有背景的外部 div 和一个包含所有内容的内部 div。外部设置为页面大小，并且可以应用背景。然后将内部的设置为父级的大小，并将所有溢出设置为滚动。由于外部没有滚动条，任何超过背景标签大小的内部内容都会导致滚动条出现在整个页面上，而不仅仅是在页面的一部分上。实际上，这会在“内容”div 内重新创建平均网页上的正文。

如果您对样式有任何具体问题，请告诉我，我会更详细地充实机制。

### 使用 jQuery

我想还有一个选择：使用类似的样式规则，但不能将所有内容嵌套在背景中，而是预先添加它，并在用户滚动时更改它的位置，[就像这样](http://jsbin.com/oziraz/6/edit)。

然后，只需注入以下代码：

```
<style>
#bg {
  width: 100%;
  height: 100%;
  position: absolute;
  top: 0px;
  background-image: url(http://cdn6.staztic.com/cdn/logos/comsanzenpattern-2.png:w48h48);
  margin: 0px;
  padding: 0px;
  overflow: hidden;
}
</style>

<script>
$("body").prepend("<div id='bg'></div>");
$(document).on("scroll", function () {
  $("#bg").css("top", $(document).scrollTop())
          .css("left", $(document).scrollLeft());
});
</script> 
```

相应地修改背景div的样式规则，你应该很好。它不会有很好的帧速率，因为它总是在滚动绘制之后出现，但是如果您对文档结构和样式的其余部分控制得很少，那么您的选项就会不足。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-04-12T04:28:06.907

您不必使用 jquery。我只用 CSS 就能得到这个效果。

您将 div 设置在初始标记的正下方。然后将图像应用到 div 中的 html。也提供 div 和 id 属性（在这种情况下为#background_wrap）。

...我在没有在 html 中应用实际图像链接的情况下尝试了这个，但它从未正常工作，因为在将图像应用到 css 中的背景时，您仍然必须使用“background-image：”属性。让它在移动设备上运行的诀窍是不使用任何背景图像设置。这些值是特定于我的项目的，但它非常适合我的固定背景图像保持居中并响应移动设备以及更大的计算机视口。可能需要为您的特定项目稍微调整值，但值得一试！我希望这有帮助。

```
 <body>
     <div id="background_wrap"><img src="~/images/yourimage.png"/></div>
 </body> 
```

然后在 CSS 中应用这些设置。

```
#background_wrap {
margin-left: auto;
margin-right: auto;   
}
#background_wrap img {
    z-index: -1;
    position: fixed;
    padding-top: 4.7em;
    padding-left: 10%; 
    width: 90%;
} 
```

# sql - Postgres - 也许是交叉表？

> ID：14863985
> 
> 赞同：3
> 
> 时间：2013-02-13T22:00:17.097
> 
> 标签：sql, postgresql, pivot, crosstab

我有一个有 3 列的表 A-

```
date       | type | value
_________________________
2012-01-01 |  1   | 100
2012-01-01 |  2   | 200

2012-01-02 |  1   | 200
2012-01-02 |  2   | 300

2012-01-03 |  1   | 500
2012-01-03 |  2   | 10 
```

对于这种格式的数据，是否可以获得查询结果-

```
date       |     type-1     |  type-2
_____________________________________
2012-01-01     100             200
2012-01-02     200             300 
```

它看起来像一个交叉表问题。不过不确定。任何想法如何为此编写SQL？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-13T22:03:34.960

您可以使用带有`CASE`表达式的聚合函数来获取结果：

```
select date,
  sum(case when type = 1 then value end) Type1,
  sum(case when type = 2 then value end) Type2
from yourtable
group by date 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!1/7896c/2)

您还可以多次加入您的桌子：

```
select t1.date,
  t1.value Type1,
  t2.value Type2
from yourtable t1
left join yourtable t2
  on t1.date = t2.date
  and t2.type = 2
where t1.type = 1 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!1/7896c/4)

# javascript - 在 chrome、safari 和 IE 中重新加载选定的索引

> ID：14863992
> 
> 赞同：1
> 
> 时间：2013-02-13T22:00:32.357
> 
> 标签：javascript, jquery, ajax, google-chrome

这实际上是[我之前问题](https://stackoverflow.com/questions/14847687/ajax-dropdowns-html-select-in-chrome)的延续。我跟踪发现，在chrome、safari、IE等浏览器上，由于reload，它无法正常工作。因此，是否有任何方法可以代替 window.location.reload() 与 chrome、safari 或 IE 兼容？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-13T22:55:44.340

如果您正在寻找一种替代方式来重新加载页面，而不是`location.reload()`；您还可以使用：

```
window.location.href = window.location.href; 
```

另一种（但类似）方式：

```
window.location = document.URL; 
```

还有其他方式：

```
window.location.assign(document.URL);
// or
window.location.replace(location.href); // this will prevent the page to be saved in browser history (back button will not navigate to previous page);
// or
history.go(0); // (not recommended) history object is not public standard but all major browsers support it. 
```

*注意`location.reload()`需要一个`boolean`参数。它的默认值是`false`从**缓存**中重新加载页面。如果将其设置为`true`它将强制浏览器从服务器获取页面。*

**阅读您的另一篇文章后**（我不知道您是否考虑过[Soc 的回答](https://stackoverflow.com/a/14864720/112731)）；除了设置 cookie，我认为您还可以从新 URL 中的查询字符串值中设置/获取数据：

将一些数据传递到重定向页面：

```
// pass the selected index:
var selectedIndex = $('#select-box')[0].selectedIndex;
window.location.href = window.location.href + '?selIndex=' + selectedIndex;

// pass the selected value:
var selectedValue = encodeURIComponent($('#select-box').val());
window.location.href = window.location.href + '?selValue=' + selectedValue; 
```

从查询字符串中获取数据：

```
function queryStringToObject(strQS)
{
    var qs = {};
    var pairs = strQS.split('&');

    for (var i = 0; i < pairs.length; i++)
    {
        var key_val = pairs[i].split('=');
        if (key_val.length > 0)
            qs[key_val[0]] = key_val[1] && decodeURIComponent(key_val[1]);
    }
    return qs;
}

var strQS = 'field1=value1&field2=value2&field3=value3';
var qs = queryStringToObject(strQS);
console.log(qs); 
```

这将输出：

```
{ field1: "value1", field2: "value2", field3: "value3" } 
```

您可以使用`window.location.search.substring(1)`从当前 URL 获取查询字符串。

# iphone - 如何在 iOS 的模板实用程序应用程序中更改翻转动画

> ID：14863995
> 
> 赞同：0
> 
> 时间：2013-02-13T22:00:37.300
> 
> 标签：iphone, ios, ios6

在 iOS 中通过模板创建实用程序应用程序时，查看生成的代码后，有没有办法将动画从 Flip 动画更改为 RollUp 动画？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T04:05:42.753

打开故事板，选择 Segue connected 2 view controllers 并将其转换属性从“Flip Horizo​​ntal”更改为“Cover Vertical”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T22:27:25.743

我不知道您所说的 RollUp 是什么意思，但您可以将其更改为 Presentation Transition Styles 枚举中的任何可用转换类型：

```
typedef enum {
   UIModalTransitionStyleCoverVertical = 0,
   UIModalTransitionStyleFlipHorizontal,
   UIModalTransitionStyleCrossDissolve,
   UIModalTransitionStylePartialCurl,
} UIModalTransitionStyle; 
```

这在 UIViewController 类参考中有记录。

# c# - 在 .Net 中创建和验证 x509 证书

> ID：14863999
> 
> 赞同：6
> 
> 时间：2013-02-13T22:00:42.723
> 
> 标签：c#, .net, certificate, x509certificate2

关于我的企业项目（仅限 Intranet），我遇到了一个使用 .net 验证证书的问题`System.Security.Cryptography.X509Certificates`

步骤 1：**创建根证书**

用于`makecert`创建根证书并将其安装到**受信任的根证书颁发机构**

```
makecert -r -pe -n "CN=Test Labs (CA)" -ss CA -sr CurrentUser -a sha256 -cy authority -sky signature -sv TestLabCA.pvk TestLabCA.cer
pvk2pfx -pvk TestLabCA.pvk -spc TestLabCA.cer -pfx TestLabCA.pfx 
```

第 2 步：**创建证书并使用根证书对其进行签名**

用于`makecert`创建证书，使用根证书对其进行签名并将其安装到**受信任的发布者**

```
makecert -pe -n "CN=Test Labs (SPC)" -a sha256 -cy end -sky signature -ic TestLabCA.cer -iv TestLabCA.pvk -sv TestLabSPC.pvk TestLabSPC.cer
pvk2pfx -pvk TestLabSPC.pvk -spc TestLabSPC.cer -pfx TestLabSPC.pfx 
```

第 3 步：**在代码中验证**

这是验证证书的 C# 代码示例：

```
X509Certificate2 rootCertificate = new X509Certificate2("TestLabCA.cer");
X509Certificate2 certificate = new X509Certificate2("TestLabSPC.cer");

// will return true
Console.WriteLine("{0}, verified = {1}", rootCertificate.GetName(), rootCertificate.Verify());

// will return false
Console.WriteLine("{0}, verified = {1}", certificate.GetName(), certificate.Verify());

// validate the chain
var chain = new X509Chain();
chain.Build(certificate);
Console.WriteLine("{0}, verified root of chain = {1}", certificate.GetName(), chain.ChainElements[chain.ChainElements.Count-1].Certificate.Verify()); 
```

**问题：**

如果我想验证证书，是否必须检查链并验证链中的最后一个，假设这是根证书？

有更好的方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-09T00:22:41.880

除了 Maarten Bodewes 的回答：

要轻松验证链是否有效，您可以使用以下代码：

```
X509Certificate2 Certificate = new X509Certificate2( "Certificate.pfx" );
X509Chain CertificateChain = new X509Chain();
//If you do not provide revokation information, use the following line.
CertificateChain.ChainPolicy.RevocationMode = X509RevocationMode.NoCheck;
bool IsCertificateChainValid = CertificateChain.Build( Certificate ); 
```

IsCertificateChainValid 然后在证书链正确时返回 true。如果它返回 false，您可以使用

```
CertificateChain.ChainStatus 
```

有关状态*为何*无效的信息。可能的值包括 NotTimeValid、UntrustedRoot。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-13T22:18:07.660

你必须创建一个信任链，是的。这意味着您必须将其追溯到您信任的证书。这不一定是根证书，但通常信任根证书而不是中间证书。有时您只想允许单个实体使用单个证书。只要您确定它是正确的证书，您就可以简单地信任该单叶证书，因此“链”将包含一个证书。这方面的一个例子是 Web 服务有时使用的自签名根证书。

请注意，证书链的验证只是整个证书验证的一部分。您需要确保证书没有被吊销，证书仍然有效（在生效日期和到期日期之间）。有时还有用于验证证书的其他专有规则，例如，在数据库中存在证书 ID - 白名单/黑名单。