# StackOverflow 问答 13293000-13293999

# c - 矩形内的点

> ID：13293000
> 
> 赞同：3
> 
> 时间：2012-11-08T16:14:52.643
> 
> 标签：c, point, rectangles

我想问一下这个功能是否正确。它应该检查点是否在矩形内，如果是则打印出来。

```
#include <stdio.h>
#include <stdlib.h>

typedef struct {
  int x;
  int y;
}point;

typedef struct {
  point A;
  point B;
}rectangle;

int main() {
rectangle s;
point T;
printf("Enter rectangle A point x coordinate :\n" );
scanf("%d", &s.A.x);
printf("Enter rectangle A point y coordinate :\n" );
scanf("%d", &s.A.y);
printf("Enter rectangle B point x coordinate :\n" );
scanf("%d", &s.B.x);
printf("Enter rectangle B point y coordinate :\n" );
scanf("%d", &s.B.y);    
printf("\nrectangle - A(%d, %d), B(%d, %d) \n", s.A.x, s.A.y, s.B.x, s.B.y );

for(int i =0; i<2; i++){ 
printf ("X: ");
scanf ("%d", &T.x);
printf ("Y: ");
scanf ("%d", &T.y);
} 

int is_inside(point A, point B){
if((s.A.x <= T.x) && (T.x <= s.B.x) && (s.A.y <= T.y) && (T.y <= s.B.y)) printf("Point (%d, %d)is inside rectangle \n",T.x, T.y);
else printf("No");
}
return 0;
} 
```

添加了整个代码，也许对你们来说会更清楚。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T16:17:46.257

这个函数不正确。它编译，但它不做你想让它做的事情^*。

像这样的数学条件

```
x0 <= X <= x1 
```

用C写成如下：

```
x0 <= X && X <= x1 
```

您的情况应如下所示：

```
if (s.A.x<=T.x && T.x<=s.B.x && s.A.y<=T.y && T.y<=s.B.y) 
```

* * *

^*然后将比较结果`s.A.x<= T.x`与`s.B.x`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:17:42.170

您不能使用`if (a<=b<=c)`，因为它从左到右进行评估，这会给您带来问题。

first`a<=b`评估为`0`or `1`which 再次与第三项相比`c`

使用`a<=b && b<=c`语法

所以，在你的情况下，它就像

```
if ((s.A.x <= T.x) && (T.x <= s.B.x ) && (s.A.y <=T.y )&& (T.y <= s.B.y)) 
```

这个声明说`s.A.x is less than equal to T.x`和`T.x is less than or equal to s.B.x`AND`s.A.y less than equal to T.y and T.y is less than equal to s.B.y`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:25:16.577

*   您缺少函数的返回类型

*   您需要使用评估边界

    ```
    ((s.A.x <= T.x) && (T.x <= s.B.x) && (s.A.y <= T.y) && (T.y <= s.B.y)) 
    ```

*   另一个问题是：在你的函数的 printf 中，你递归地调用 is_inside(A,B)。假设 if 条件为真，您将陷入无限循环。

    ```
    printf("Point (%f, %f)is inside rectangle \n", T.x, T.y); 
    ```

# debugging - gdb：仅自动退出而不会崩溃

> ID：13293001
> 
> 赞同：2
> 
> 时间：2012-11-08T16:14:53.597
> 
> 标签：debugging, gdb

我正在用 gdb 调试我的程序。我可以使用这些`-x`选项进行非交互式调试。

```
gdb -x gdbinit ./myprogram 
```

文件内容`gdbinit`：

```
handle SIGINT pass nostop noprint
handle SIGQUIT pass nostop noprint
handle SIGUSR1 pass nostop noprint
handle SIGUSR2 pass nostop noprint
run
backtrace
quit 
```

gdb 不处理这四个信号，因为我的程序需要它们才能正常工作。

该`backtrace`命令对于在崩溃后进行回溯很有用。

该`quit`命令使 gdb 在程序执行后退出，即使它已经崩溃。

我只想在程序成功完成时自动退出。在其他情况下，gdb 应该可用于分析回溯和其他事情。

**仅当程序无错误退出时，gdb 如何才能退出？**

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T21:48:33.957

使用`$_exitcode` [GDB 便利变量](http://sourceware.org/gdb/onlinedocs/gdb/Convenience-Vars.html)。在上面的 gdb 脚本中，替换：

```
run 
```

和：

```
set $_exitcode = -1
run
if $_exitcode != -1 
    quit
end 
```

并删除最后的`quit`行应该可以工作。使用`-1`不可能的值是可行的，因为在 POSIX 中只能使用退出状态的低 8 位。`WEXITSTATUS()`（见[等待（2）](http://man7.org/linux/man-pages/man2/waitpid.2.html)）。

要使用 GDB Python API 来完成同样的事情，请参见[此处](https://stackoverflow.com/a/8694502/676030)。

# wpf - MVVM 用户控制依赖地狱

> ID：13293004
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:15:16.463
> 
> 标签：wpf, mvvm, user-controls

这似乎是一个简单的任务，我想从 MVVM 视图中传递一个公共属性值，但我不断收到“无法在类型的属性上设置‘绑定’。‘绑定’只能设置在依赖对象的依赖属性”错误。

我正在迭代一个可观察的集合并呈现该项目，并且我想将一些模板代码移动到一个用户控件中。我怎么能解决这个问题？？？？

```
<local:xIPAddressControl UserControlIPAddressText="{Binding Path=IPAddress, RelativeSource={RelativeSource Mode=Self}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" /> 
```

### 用户控制

```
public partial class xIPAddressControl : UserControl
{
    public xIPAddressControl()
    {
        this.InitializeComponent();
    }

    public string UserControlIPAddressText
    {
        get { return this.xIPAddressTextBlock.Text; }
        set { this.xIPAddressTextBlock.Text = value; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:18:42.157

如评论中所述，您的财产必须是 a`DependencyProperty`才能`Binding`在其上使用。

这是您的代码应如下所示：

```
 public static readonly DependencyProperty UserControlIPAddressTextProperty=
            DependencyProperty.Register("UserControlIPAddressText",
                                        typeof(string),
                                        typeof(xIPAddressControl));

       public string UserControlIPAddressText
       {
           get { return (string)GetValue(UserControlIPAddressTextProperty); }
           set { SetValue(UserControlIPAddressTextProperty, value); }
       } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:59:15.217

您将 UserControlIPAddressText 定义为 CLR 属性，但它需要在依赖属性系统中注册。

```
DependencyProperty UserControlIPAddressTextProperty = DependencyProperty.Register("UserControlIPADdressText", typeof(string), null); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-11T23:07:50.880

疯狂的事情，我试图错误地设置用户控件。它需要如下。

```
//this.DataContext = this;

LayoutRoot.DataContext = this; 
```

[教程在这里](http://www.codeproject.com/Articles/325911/A-Simple-Pattern-for-Creating-Re-useable-UserContr)。

# android - Android 对 AVRCP 的支持

> ID：13293005
> 
> 赞同：11
> 
> 时间：2012-11-08T16:15:18.010
> 
> 标签：android, bluetooth, avrcp

哪些 Android 版本和设备支持 AVRCP 1.3 和 1.4？

应用程序需要什么来支持 AVRCP 1.3（提供曲目信息）？我们通过 AudioTrack 播放音频，而不是媒体播放器。

支持 1.4 需要什么？

是否有任何示例、源代码等演示如何支持 AVRCP 1.3 和 1.4？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T09:01:16.387

Base android 不支持 AVRCP 1.3/1.4，许多其他设备支持（许多手机支持 AVRCP 1.3/1.4 例如：Moto Razr 系列手机）。AVRCP 1.3 的源代码可以在 Qualcomm 维护的 codeaurora git 上找到。AVRCP 1.3 需要媒体信息，如 STATUS、TrackName、ArtistName、AlbumName、Duration 等。请在 bluetooth.org 中查看 AVRCP 1.3 规范版本此外，您还需要将 AVRCP 配置文件的 SDP 记录更改为 1.3。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-05T14:45:06.560

这是一个老问题，但同样重要的是：配置文件支持依赖于芯片组和堆栈。蓝牙实现与您运行的 Android 版本无关。

设备的合格列表可在 Bluetooth.org 上找到。这些列表包含支持的配置文件和配置文件版本。

如果设备使用蓝牙品牌，则应在此处列出。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-03-14T07:56:30.217

在 Galaxy S9 中，我在开发设置中看到 1.4 是默认设置，但 1.5 和 1.6 是一个选项。我声称支持 1.5 的索尼 mex-n4100bt 开箱即用，可以在朋友的 Galaxy S4 上列出文件和内容。但在我启动应用程序之前不适用于我的 S9。实际上在我的 S9 上只有控件可以工作，我找不到支持浏览文件的应用程序。需要花更多时间调查发生了什么。

回到（旧）问题，我认为可以在 VLC 代码库中使用支持 AVRCP 的示例。但它可能低于 1.4，因为 1.4 浏览文件应该已经可用。

# python - Python减去两个日期字符串

> ID：13293009
> 
> 赞同：9
> 
> 时间：2012-11-08T16:15:24.357
> 
> 标签：python, string, subtraction

我有两个包含日期的字符串，像这样”

```
start_date = 'Sun Sep 16 16:05:15 +0000 2012'
end_date = 'Sun Sep 17 23:55:20 +0000 2012' 
```

我需要执行：`end_date - start_date` 它应该返回分隔结束日期和开始日期的秒数。

此数据是从 twitter api 中提取的。这就是json给我的。由于它似乎是一个常用的字符串，我假设有一个库或方法可以处理这个问题。我只是找不到一个。谢谢！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-08T16:25:00.123

这是完整的答案：

```
from datetime import datetime

start_date = 'Sun Sep 16 16:05:15 +0000 2012'
end_date = 'Sun Sep 17 23:55:20 +0000 2012'

def __datetime(date_str):
    return datetime.strptime(date_str, '%a %b %d %H:%M:%S +0000 %Y')

start = __datetime(start_date)
end = __datetime(end_date)

delta = end - start
print delta  # prints: 1 day, 7:50:05
print delta.total_seconds()  # prints: 114605.0 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T16:18:19.550

你看起来有多努力？

Python 的[datetime](http://docs.python.org/2/library/datetime.html)模块将解析这种格式，并让您对结果对象进行算术运算。

这是示例代码：

```
a = datetime.datetime.strptime("Sun Sep 16 16:05:15 +0000 2012", "%a %b %d %H:%M:%S +0000 %Y") 
```

请注意，在 Windows（我在上面尝试过）中，该`%z`指令似乎不受支持，这就是该`+0000`部分被硬编码的原因。如果您预计这部分（UTC 偏移量）会有所不同，则需要在单独的步骤中进行处理，除非您可以验证它是否`%z`适合您。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T16:19:30.463

使用 datetime.strptime 方法将您的字符串转换为 datetime 对象。您可以在此处找到所需的格式：http: [//docs.python.org/2/library/datetime.html#strftime-strptime-behavior](http://docs.python.org/2/library/datetime.html#strftime-strptime-behavior)

在你的情况下：

> %a 区域设置的缩写工作日名称。
> %b 区域设置的缩写月份名称。
> %d 以十进制数表示的日期 [01,31]。
> %H 小时（24 小时制），十进制数 [00,23]。
> %M 分钟为十进制数 [00,59]。
> %S 秒为十进制数 [00,61]。
> %Y 年份，世纪为十进制数。
> %z UTC 偏移量，格式为 +HHMM 或 -HHMM（如果对象是幼稚的，则为空字符串）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-08T16:19:33.540

查看日期时间模块（[http://docs.python.org/2/library/datetime.html](http://docs.python.org/2/library/datetime.html)）它有各种日期操作的方法

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-08T16:21:17.773

用于`datetime.strptime()`根据格式代码解析字符串。在您的情况下，格式类似于`"%a %b %d %H:%M:%S %z %Y"`. （注意：我没有测试这种解析格式。）

详细信息： http: [//docs.python.org/2/library/datetime.html#strftime-strptime-behavior](http://docs.python.org/2/library/datetime.html#strftime-strptime-behavior)

然后你可以减去`datetime`对象并得到一个`timedelta`对象。

或者，您可以使用 Twitter 开发人员页面上列出的 Python Twitter API 包装器之一，它可能会为您完成转换：[https ://dev.twitter.com/docs/twitter-libraries#python](https://dev.twitter.com/docs/twitter-libraries#python)

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-08T16:19:38.017

您可以使用 datetime.datetime.strptime() 解析日期，然后可以进行算术运算？

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-05-25T20:52:54.407

从日期时间导入日期时间

```
start_date = 'Sun Sep 16 16:05:15 +0000 2012'
end_date = 'Sun Sep 17 23:55:20 +0000 2012'

def __datetime(date_str):
    return datetime.strptime(date_str, '%a %b %d %H:%M:%S +0000 %Y')

start = __datetime(start_date)
end = __datetime(end_date)

delta = end - start
print(delta)
print(delta.total_seconds())

hours = (delta.total_seconds())/3600

print("Hours %s" % hours)

minutes = (delta.total_seconds())//3600

print("minutes %s" % minutes)
print(divmod(delta.total_seconds(), 3600))

h, m = divmod(delta.total_seconds(), 3600)

print(h)
print(m)

M, s = divmod(m, 60)
print(M)
print(s) 
```

# android - 在 Android 服务中使用 Android Facebook SDK 3.0

> ID：13293011
> 
> 赞同：1
> 
> 时间：2012-11-08T16:15:26.060
> 
> 标签：android, facebook, service

我正在寻找一个示例，说明如何使用新的 Facebook SDK 3.0 方法来请求图形路径并在服务中返回 JSON 结果。到目前为止，我发现的示例是针对活动的，但我在根本没有活动的服务中在后台运行我的 Facebook 查询。任何示例或示例链接将不胜感激。

# templates - Smarty 相对包含子文件夹中的路径

> ID：13293012
> 
> 赞同：1
> 
> 时间：2012-11-08T16:15:26.903
> 
> 标签：templates, smarty, smarty2

我有这样的文件结构：

```
templates
  index.tpl

  module_1
     main.tpl
     xyz.tpl
     abc.tpl
  ...
  module_n
     main.tpl
     zzz.tpl
     kkk.tpl 
```

Smarty 模板目录是：`$smarty->template_dir = USER_ROOT."/templates";`

每个模块模板内`main.tpl`应包含来自同一文件夹的其他模板。

我试图包括这样的：`{include file="./kkk.tpl"}`但这不起作用。如何使用相对路径包含来自同一文件夹的模板？

我使用 Smarty 2.6.24

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:09:10.680

您可以分配一个变量`$moduleName`并使用它（不要忘记双引号）：

```
{include file="$moduleName/kkk.tpl"} 
```

或尝试使用缩写形式`{include}`：

```
{include './kkk.tpl'} 
```

请参阅[http://www.smarty.net/docs/en/language.function.include.tpl](http://www.smarty.net/docs/en/language.function.include.tpl)（*示例 7.53 部分。{include} 与相对路径*）

# bash - 在 Qt 中读取正在写入的文件

> ID：13293018
> 
> 赞同：1
> 
> 时间：2012-11-08T16:15:55.463
> 
> 标签：bash, qt

我正在将 bash 命令的输出写入文件中。在 Qt 中，我想读取这个文件，因为它正在被写入。该命令逐渐写入输出。我怎样才能实现这样的目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:21:35.753

[您可以使用QFileSystemWatcher](http://qt-project.org/doc/qt-4.8/qfilesystemwatcher.html)类监视文件更改

# ios - 警告 'fileAttributesAtPath:traverseLink 已弃用：首先在 ios 2.0 中弃用

> ID：13293020
> 
> 赞同：8
> 
> 时间：2012-11-08T16:16:02.597
> 
> 标签：ios, xcode

我做了这个函数，它返回文档目录中文件的大小，它可以工作，但我收到警告，我希望修复，函数：

```
-(unsigned long long int)getFileSize:(NSString*)path
{
NSArray *paths = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory,        NSUserDomainMask, YES);
NSString *documentsDirectory = [paths objectAtIndex:0];
NSString *getFilePath = [documentsDirectory stringByAppendingPathComponent:path];

NSDictionary *fileDictionary = [[NSFileManager defaultManager] fileAttributesAtPath:getFilePath traverseLink:YES]; //*Warning
unsigned long long int fileSize = 0;
fileSize = [fileDictionary fileSize];

return fileSize;
} 
```

*警告是'fileAttributesAtPath:traverseLink: is deprecated first deprecated in ios 2.0'。这是什么意思，我该如何解决？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T16:18:24.370

在大多数情况下，当您收到有关已弃用方法的报告时，您会在参考文档中查找它，它会告诉您要使用什么替代方法。

> **fileAttributesAtPath:traverseLink：** 返回一个字典，描述给定文件的 POSIX 属性。（在 iOS 2.0 中已弃用。使用 attributesOfItemAtPath:error: 代替。）

所以`attributesOfItemAtPath:error:`改用。

这是简单的方法：

```
NSDictionary *fileDictionary = [[NSFileManager defaultManager] attributesOfItemAtPath:getFilePath error:nil]; 
```

更完整的方法是：

```
NSError *error = nil;
NSDictionary *fileDictionary = [[NSFileManager defaultManager] attributesOfItemAtPath:getFilePath error:&error];
if (fileDictionary) {
    // make use of attributes
} else {
    // handle error found in 'error'
} 
```

编辑：如果您不知道*deprecated*的含义，则表示该方法或类现在已过时。您应该使用更新的 API 来执行类似的操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-11-11T18:13:48.000

接受的答案忘记`traverseLink:YES`从问题中处理。

一个改进的答案是同时使用`attributesOfItemAtPath:error:`and `stringByResolvingSymlinksInPath`：

```
NSString *fullPath = [getFilePath stringByResolvingSymlinksInPath];
NSDictionary *fileDictionary = [[NSFileManager defaultManager] attributesOfItemAtPath:fullPath error:nil]; 
```

# html - 移动浏览器上的图像溢出

> ID：13293021
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:16:06.447
> 
> 标签：html, image, mobile

我得到了一个带有图像的 html 代码。图像非常宽，所以我集成了一个“溢出：隐藏；” 到我的 css 到图像，甚至到整个身体。它适用于每个桌面浏览器，但不适用于 Android 操作系统上的 Chrome。

似乎移动浏览器正在寻找具有最高宽度的对象，并缩放他的缩放以在屏幕的 100% 上具有此宽度。

有人知道这个问题吗？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:33:07.040

调整[viewport 元标记](https://developer.mozilla.org/en-US/docs/Mobile/Viewport_meta_tag)的 width 和 initial-scale 值，这是 inside `<head>`，这是一个例子：

```
<meta name="viewport" content = "width=device-width,initial-scale=1.0,user-scalable=no"> 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-08T16:21:49.737

您需要将其作为图像吗？您可以将其用作背景图像，或将其放在 div 中并为该 div 赋予溢出：隐藏属性

# forms - 链接出单选按钮

> ID：13293022
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:16:06.820
> 
> 标签：forms, url, hyperlink, submit

提交后是否可以使用带有一些单选按钮的表单链接到所选页面？所以我选择了第一个单选按钮，点击按钮提交并获得了 url /angebote.html

谢谢！

```
<form id="aktion">
          <div class="action-check">
            <input class="radio" type="radio" value="angebote.html" name="suche">
            <label for="suche">Ich suche ein Zimmer</label>
          </div>
          <div class="action-check">
            <input class="radio" type="radio" value="angebotseingabe.html" name="biete">
            <label for="biete">Ich biete ein Zimmer</label>
           </div>
          <div class="action-check">
          <input class="radio" type="radio" value="gesuchseingabe.html" name="gruenden">
          <label for="gruenden">Ich möchte eine WG gründen</label>
         </div>
          <div class="submit_container">
          <input class="submit" type="submit" value="Los geht's">
        </div>
    </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:30:12.430

你可以像这样使用javascript。

```
<HTML> 
    <HEAD>
         <SCRIPT language="javascript"> 
              function choiceprop(form3) {
                   var url = <!-- check the good case here -->
                   window.location = url;
               } 
          </SCRIPT> 
    </HEAD> 
    <BODY>
        <FORM NAME="formtest">
             <INPUT TYPE="radio" NAME="choice" VALUE="url1">name1<BR>
             <INPUT TYPE="radio" NAME="choice" VALUE="url2">name2<BR> 
             <INPUT TYPE="radio" NAME="choice" VALUE="url3">name3<BR> 
             <INPUT TYPE="button"NAME="but" VALUE="Validate" onClick="choiceprop(formtest)">
        </FORM> 
   </BODY> 
</HTML> 
```

# c# - 使用 TimeZoneInfo 类来说明夏令时的时间变化

> ID：13293024
> 
> 赞同：3
> 
> 时间：2012-11-08T16:16:11.143
> 
> 标签：c#, .net, timezone, console-application, dst

我有一些过时的代码试图解释夏令时引起的时间变化，如下所示：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ConsoleApplication2
{
    class Program
    {
        static void Main(string[] args)
        {
            for (int i = 1; i <= 31; i++)
            {
                DateTime dt = new DateTime(1960, 3, i, 0, 0, 0);
                Console.WriteLine(dt.ToUniversalTime());
            }

            Console.WriteLine();

            for (int i = 1; i <= 30; i++)
            {
                DateTime dt = new DateTime(1960, 4, i, 0, 0, 0);
                Console.WriteLine(dt.ToUniversalTime());
            }

            Console.ReadKey();
        }
    }
} 
```

此代码遍历 1960 年 3 月和 4 月的日子并打印日期时间。但是，这并不能正确解释 1960 年的时间变化，我相信因为当时时间变化的日期不同。我试图使用 TimeZoneInfo 类来解决这个问题。我将代码更改为以下内容：

```
class Program
    {
        static void Main(string[] args)
        {
            for (int i = 1; i <= 31; i++)
            {
                DateTime dt = new DateTime(1960, 3, i, 0, 0, 0);
                var tz = TimeZoneInfo.Local;
                var utcOffset = new DateTimeOffset(dt, TimeSpan.Zero);
                //use timeZoneInfo class to account for dlst offset
                Console.WriteLine(utcOffset.ToOffset(tz.GetUtcOffset(utcOffset)));
            }

            Console.WriteLine();

            for (int i = 1; i <= 30; i++)
            {
                DateTime dt = new DateTime(1960, 4, i, 0, 0, 0);
                var tz = TimeZoneInfo.Local;
                var utcOffset = new DateTimeOffset(dt, TimeSpan.Zero);
                //use timeZoneInfo class to account for dlst offset
                Console.WriteLine(utcOffset.ToOffset(tz.GetUtcOffset(utcOffset)));

            }

            Console.ReadKey();
        }
    } 
```

不幸的是，这是打印出来的： ![在此处输入图像描述](../Images/bd221f16e41af0d238dcf019abc3da11.png)

这表明夏令时在 4 月 3 日下午 4 点发生变化，而它应该在 4 月 24 日凌晨 2:00 切换到正确解释夏令时我错过了什么？

**编辑：** 我当前的时区是东部。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:25:56.430

看起来 Windows 时区信息与我通过 TZDB 所期望的不匹配。这是一个使用[Noda Time](http://noda-time.googlecode.com)的程序来显示 ~1960 和 1965 之间的所有转换，其中包含 BCL TimeZoneInfo（已包装）和 TZDB 2012i 数据：

```
using System;
using NodaTime;

class Test
{
    static void Main()
    {
        var bcl = DateTimeZoneProviders.Bcl["Eastern Standard Time"];
        var tzdb = DateTimeZoneProviders.Tzdb["America/New_York"];

        ShowTransitions(bcl);
        ShowTransitions(tzdb);
    }

    static void ShowTransitions(DateTimeZone zone)
    {
        Console.WriteLine("Transitions for {0}", zone.Id);
        Instant start = Instant.FromUtc(1960, 1, 1, 0, 0);
        Instant end = Instant.FromUtc(1965, 1, 1, 0, 0);
        var interval = zone.GetZoneInterval(start);
        while (interval.Start < end)
        {
            Console.WriteLine(interval.Start);
            interval = zone.GetZoneInterval(interval.End);
        }
        Console.WriteLine();
    }
} 
```

输出：

```
Transitions for Eastern Standard Time
1959-10-25T06:00:00Z
1960-04-03T07:00:00Z
1960-10-30T06:00:00Z
1961-04-02T07:00:00Z
1961-10-29T06:00:00Z
1962-04-01T07:00:00Z
1962-10-28T06:00:00Z
1963-04-07T07:00:00Z
1963-10-27T06:00:00Z
1964-04-05T07:00:00Z
1964-10-25T06:00:00Z

Transitions for America/Toronto
1959-10-25T06:00:00Z
1960-04-24T07:00:00Z
1960-10-30T06:00:00Z
1961-04-30T07:00:00Z
1961-10-29T06:00:00Z
1962-04-29T07:00:00Z
1962-10-28T06:00:00Z
1963-04-28T07:00:00Z
1963-10-27T06:00:00Z
1964-04-26T07:00:00Z
1964-10-25T06:00:00Z 
```

还有其他时区 ID 映射到“东部标准时间”，但我没有找到任何与 Windows 行为匹配的时区 ID。

我不认为这是一个`TimeZoneInfo`错误 - 我相信这是底层 Windows 时区数据中的一个潜在问题。

如果你想匹配 TZDB 数据，当然，你可以使用 Noda Time :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:57:56.350

有一个 dt.IsDaylightSavingTime()。1960 年对我来说，它会在 4/4 发生变化（比你晚一天），但我是 CST。对于 2012 年，它在我的系统上是正确的。这可能是一个错误。可能只是那一年或直到 X 的所有年份。

我认为这解释了它：

[夏令时](http://www.webexhibits.org/daylightsaving/e.html)

“在 1960 年代初期，夏令时的遵守情况非常不一致，时间遵守情况大杂烩，并且没有就何时更换时钟达成一致。”

“1966 年统一时间法案在整个美国建立了一个统一的（在每个时区内）夏令时系统”

# jquery - 无法用json数据写出数组内特定位置的值

> ID：13293025
> 
> 赞同：0
> 
> 时间：2012-11-08T16:16:17.070
> 
> 标签：jquery, arrays, json

我使用此代码将项目添加到我的数组中。

```
var allItems = [];
$.getJSON(url, function(data) {
    $.each(data, function(i) {
        allItems.push({
            theTeam: data[i]["TeamName"],
            thePlayer: data[i]["TeamPlayer"],
        });
    });
} 
```

如果我使用这段代码

```
$.each(allItems, function (i, val) {                                      
    console.log(val.theTeam);                                    
}); 
```

导致打印团队位置上的所有数据。就像控制台 AC 米兰的第一排 国际米兰控制台的第二排。但我想打印出数组中的特定位置。我尝试了类似的东西`console.log(val[0].theTeam);`

但它给了我错误无法读取未定义的属性“theTeam”。

在这种情况下，我希望我的结果只是 AC 米兰。

**更新包含的 Json 数据**

```
[{
"TeamName": "AC Milan",
"TeamPlayer": "Mange" },{
"TeamName": "Inter",
"TeamPlayer": "Daniel"}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:19:44.767

如果您已经知道要访问的索引，则不需要`.each()`循环，只需通过其索引直接访问您的项目，如下所示：

```
console.log(allItems[0].theTeam); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:20:21.223

val 是 $.each() 方法调用的本地变量。您有一个名为 allItems 的全局数组——不是 val。做所有项目[0].theTeam。

如果该答案与您的要求不相符，那么请更具体。你的问题有点模糊，所以我已经尽力解释你在找什么。干杯。

# c# - 在 Fluent NHibernate 中使用公式引用实体

> ID：13293026
> 
> 赞同：5
> 
> 时间：2012-11-08T16:16:37.990
> 
> 标签：c#, nhibernate, fluent-nhibernate, nhibernate-mapping

我有一个具有`N:1`父子关系的架构，该架构存储在另一个表中并由公式选择。是否可以使用公式将此实体映射到父级？

```
public class ParentEntity {
    public virtual int ParentId { get; set; }
    public virtual ChildEntity Child{ get; set; }
}

public class ParentMapping : ClassMap<ParentEntity> {
    public ParentMapping() {
        Table("ParentTable");

        Id(x => x.ParentId).Column("ParentId").GeneratedBy.Assigned().Not.Nullable();
        References<ChildEntity>(x => x.Child).Formula(
            @"(
                SELECT TOP 1 ChildTable.ChildId
                FROM ChildTable
                WHERE ChildTable.ParentId = ParentId
            )"
        );
    }
} 
```

此映射生成的 SQL 如下所示：

```
SELECT
    this_.ParentId,
    this_.ChildEntity_id
FROM ParentTable this_ 
```

这不是我要找的。

如何引用此子实体并使用从`ChildId`公式中选择的公式，而不是在父表中`ChildId`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T08:36:51.683

*无论如何我不会讨论这种方法的正确性，只是尝试回答。*您正在尝试做的事情： **应该**工作。我已经在测试场景中检查了公式的正确性。所以，是的，公式可以完全这样使用。

但因为它不起作用，我会有点猜测。让我们从我的测试用例中生成的 SQL 开始，它正在工作。

```
SELECT this_.ParentId as ParentId3_0_
, (SELECT TOP 1 Child.ChildId
     FROM Child
     WHERE Child.ParentId = this_.ParentId) as formula1_0_ 
FROM Parent this_ 
```

## 可能的问题

我看到两个可能的问题

### 1.不同的Child ID列名

首先在您的代码段中：

```
References<ChildEntity>(x => x.Child).Formula(
            @"(
                SELECT TOP 1 ChildTable.ChildId
                FROM ChildTable
                WHERE ChildTable.ParentId = ParentId
            )" 
```

是子主键的列名：**`ChildId`**而在 SQL 片段中是**`ChildEntity_id`**：

```
SELECT
    this_.ParentId,
    this_.ChildEntity_id
FROM ParentTable this_ 
```

### 2\. SQL Snippet 不匹配

其次，您提到（上面的 SQL 语句）是生成的。但它更像是这个映射的一个声明：

```
References<ChildEntity>(x => x.Child).Column("ChildEntity_id") 
```

所以不能有一些旧的/其他的映射，实际上是使用的吗？

总结 我想说的是，这种映射方式是有效的。所以你在正确的轨道上，但*魔鬼隐藏在细节中*；）

# java - 便携式码头服务器发布

> ID：13293032
> 
> 赞同：0
> 
> 时间：2012-11-08T16:17:03.510
> 
> 标签：java, jetty, release

我想要一个便携式 Jetty 服务器。默认 jetty.home 目录包含

```
    码头之家
    │
    ├─等
    │ ├─ jetty.xml
    │ ├─ jetty-logging.xml
    │ ├─ jetty-plus.xml
    │ └─ webdefault.xml
    ├─日志
    │
    ├─库
    │ ├─ jetty-6.1.26.jar
    │ └─ other.jar
    ├─网络应用
    │ └─MyWebApp.war
    ├─ start.jar
    └─ start.ini

```

从上面，我想消除`etc`和`lib`目录并保留以下内容

```
    码头之家
    │
    ├─日志
    ├─网络应用
    │ └─MyWebApp.war
    └─ start.jar

```

我使用 OneJar 和 .jar 将所有`lib`文件夹 jar 打包到[start.jar](http://one-jar.sourceforge.net)中`start.ini`。有什么方法可以将`etc`文件夹内容保存在 jar 中，以便我可以简单地运行

```
java -Xmx640M -jar rw.jar 
```

代替

```
java -Xmx640M -jar rw.jar etc/jetty.xml etc/jetty-annotations.xml etc/jetty-deploy.xml etc/jetty-logging.xml etc/jetty-webapps.xml 
```

所以我可以有一个可移植的版本，而且我从不担心有人在客户端更改配置。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:56:51.933

您最好的选择是将码头嵌入到您的应用程序中。

[http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty](http://wiki.eclipse.org/Jetty/Tutorial/Embedding_Jetty)

有了这个，你只需要在类路径中有码头罐子，你应该很高兴。您甚至可以根据需要将所有内容都放入一个罐子中，并在清单中添加一个 Main 类来启动所有内容。

无论如何，xml 文件实际上只是 java 上的一层薄薄的 xml。看看这里的一些嵌入式示例，这应该会引导您了解正确的方法。

[http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/examples/embedded/src/main/java/org/eclipse/jetty/embedded](http://git.eclipse.org/c/jetty/org.eclipse.jetty.project.git/tree/examples/embedded/src/main/java/org/eclipse/jetty/embedded)

# maven - 如何配置 maven install 默认跳过测试？

> ID：13293038
> 
> 赞同：8
> 
> 时间：2012-11-08T16:17:11.017
> 
> 标签：maven, maven-2

我想知道是否可以将 maven 配置为默认跳过单元测试。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-08T16:17:11.017

在 settings.xml 文件的`properties`标记内，添加此属性：**maven.test.skip**为 true。

```
 <profiles>
         <profile>
              <id>development</id>
              <properties>
                  <maven.test.skip>true</maven.test.skip>
              </properties>
         </profile>
    </profiles>

    <activeProfiles>
         <activeProfile>development</activeProfile>
    </activeProfiles> 
```

如果要执行此测试，则可以覆盖该属性：

```
mvn clean install -Dmaven.test.skip=false 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-06-01T17:48:38.463

您可以通过向文件中添加一个`profile`元素来做到这一点`settings.xml`：

```
<profile>
    <id>skip.tests.by.default</id>
    <activation>
        <activeByDefault>true</activeByDefault>
    </activation>
    <properties>
        <maven.test.skip>true</maven.test.skip>
    </properties>
</profile> 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2018-07-27T06:04:21.077

对于 Eclipse Photon，

1.  右键单击 pom.xml

2.  以'maven build...'运行（注意'...'）

3.  输入“干净安装”

4.  检查“跳过测试”并运行

# c++ - 使用 jsoncpp 创建空的 json 数组

> ID：13293043
> 
> 赞同：20
> 
> 时间：2012-11-08T16:17:31.873
> 
> 标签：c++, json, jsoncpp

我有以下代码：

```
void MyClass::myMethod(Json::Value& jsonValue_ref)
{
    for (int i = 0; i <= m_stringList.size(); i++)
    {
        if (m_boolMarkerList[i])
        {
            jsonValue_ref.append(stringList[i]);
        }
    }
}

void MyClass::myOuterMethod()
{
    Json::Value jsonRoot;
    Json::Value jsonValue;

    myMethod(jsonValue);

    jsonRoot["somevalue"] = jsonValue;
    Json::StyledWriter writer;
    std::string out_string = writer.write(jsonRoot);
} 
```

如果所有标记`m_boolMarkerList`都为假，则`out_string`is `{ "somevalue" : null }`，但我希望它是一个空数组：`{ "somevalue" : [ ] }`

有谁知道如何实现这一目标？

非常感谢你！

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-02-28T13:36:44.690

这里有两种方法可以做到：

```
jsonRootValue["emptyArray"] = Json::Value(Json::arrayValue);
// or 
jsonRootValue["emptyArray"] = Json::arrayValue; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-04T09:28:28.110

您可以通过将 Value 对象定义为“数组对象”来做到这一点（默认情况下，它使其成为“对象”对象，这就是为什么您的成员在没有分配时变为“null”，而不是 [] ）

所以，切换这一行：

```
 Json::Value jsonValue;
 myMethod(jsonValue); 
```

有了这个：

```
Json::Value jsonValue(Json::arrayValue);
myMethod(jsonValue); 
```

瞧！请注意，您可以将“arrayValue”更改为您想要的任何类型（对象、字符串、数组、int 等）以创建该类型的对象。正如我之前所说，默认的是“对象”。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-28T16:18:28.850

好，我知道了。这有点烦人，但毕竟很容易。使用 jsoncpp 创建一个空的 json 数组：

```
Json::Value jsonArray;
jsonArray.append(Json::Value::null);
jsonArray.clear();
jsonRootValue["emptyArray"] = jsonArray; 
```

通过 writer 的输出将是：

```
{ "emptyArray" = [] } 
```

# python - pygit2 blob 历史

> ID：13293052
> 
> 赞同：7
> 
> 时间：2012-11-08T16:17:48.283
> 
> 标签：python, git, blob, history, libgit2

我正在尝试`git log filename`使用 pygit2 在 git 裸存储库中进行等效操作。该文档仅说明了如何执行`git log`以下操作：

```
from pygit2 import GIT_SORT_TIME
for commit in repo.walk(oid, GIT_SORT_TIME):
    print(commit.hex) 
```

你有什么主意吗？

谢谢

编辑：

我现在有这样的事情，或多或少是精确的：

```
from pygit2 import GIT_SORT_TIME, Repository

repo = Repository('/path/to/repo')

def iter_commits(name):
    last_commit = None
    last_oid = None

    # loops through all the commits
    for commit in repo.walk(repo.head.oid, GIT_SORT_TIME):

        # checks if the file exists
        if name in commit.tree:
            # has it changed since last commit?
            # let's compare it's sha with the previous found sha
            oid = commit.tree[name].oid
            has_changed = (oid != last_oid and last_oid)

            if has_changed:
                yield last_commit

            last_oid = oid
        else:
            last_oid = None

        last_commit = commit

    if last_oid:
        yield last_commit

for commit in iter_commits("AUTHORS"):
    print(commit.message, commit.author.name, commit.commit_time) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-06T08:56:47.197

我建议您只使用 git 的命令行界面，它可以提供格式精美的输出，使用 Python 非常容易解析。例如，要获取给定文件的作者姓名、日志消息和提交哈希：

```
import subprocess
subprocess.check_output(['git','log','--pretty="%H,%cn%n----%B----"','some_git_file.py']) 
```

有关可以传递给**--pretty的格式说明符的完整列表，请查看****git log**的文档：[https://www.kernel.org/pub/software/scm/git/docs/git-log。 html](https://www.kernel.org/pub/software/scm/git/docs/git-log.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-06T08:32:06.047

另一种解决方案是懒惰地从给定的提交中生成文件的修订版。由于它是递归的，如果历史记录太大，它可能会中断。

```
def revisions(commit, file, last=None):
    try:
        entry = commit.tree[file]
    except KeyError:
        return
    if entry != last:
        yield entry
        last = entry
    for parent in commit.parents:
        for rev in revisions(parent, file, last):
            yield rev 
```

# database - 尝试访问数据库时出现 NullPointerException

> ID：13293056
> 
> 赞同：0
> 
> 时间：2012-11-08T16:17:57.913
> 
> 标签：database, jsf, netbeans, primefaces, nullpointerexception

我正在尝试使用以下方法创建一个思维导图样式的应用程序：

Netbeans 7.2 jdk 6.35 Primefaces 3.4

这个想法是通过访问数据库并从该数据库生成节点来生成思维导图。我已确保该程序从与我尝试访问的对象相同类型的对象中生成合适的图形。但是，当我尝试访问数据库信息时，我得到了 NullPointerException。我在生成通用页面时使用的步骤是：

1）创建数据库并填充它们。2）在netbeans中使用了“来自数据库的新实体类”功能。3) 使用了“来自实体类的 JSF 页面”功能。4) 创建了一个 JSF Managed Bean 来生成思维导图。

下面是思维导图 Bean 的代码：

```
/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package jsf;

import java.util.ArrayList;
import java.util.List;
import java.util.Random;
import javax.enterprise.context.RequestScoped;
import javax.inject.Named;
import jpa.entities.Enginetable;
import jpa.session.EnginetableFacade;
import org.primefaces.event.SelectEvent;
import org.primefaces.model.mindmap.DefaultMindmapNode;
import org.primefaces.model.mindmap.MindmapNode;

/**
 *
 * @author AOL
 */
@Named(value = "mmBean")
@RequestScoped
public class mmBean {

    private MindmapNode root;

    private MindmapNode selectedNode;

    private List<Enginetable> elements;
    private List<Enginetable> filteredElements;
    private List<Enginetable> userlist;

    private Enginetable selectedElement;
    private Enginetable[] selectedElements; 

    private List<Enginetable> elementlist = new ArrayList<Enginetable>();

    private Enginetable nodeentity = new Enginetable();
    private Enginetable rootentity = new Enginetable();
    private Enginetable userentity = new Enginetable();

    private jpa.session.EnginetableFacade ejbFacade;

    private static final String[] username;

    static{

        username = new String[10];  
        username[0] = "Mercedes";  
        username[1] = "BMW";  
        username[2] = "Volvo";  
        username[3] = "Audi";  
        username[4] = "Renault";  
        username[5] = "Opel";  
        username[6] = "Volkswagen";  
        username[7] = "Chrysler";  
        username[8] = "Ferrari";  
        username[9] = "Ford";  
    }

    /**
     * Creates a new instance of MmBean
     */
    public mmBean() {
        ///if(elements==null){
        elements = new ArrayList<Enginetable>(); 
        //} 
        //remoteuser=null;
        // this.populateRandomElements(elements, 10); 
        this.populateRandomElements(elements,6);  

        // filteredElements = new ArrayList<Graphelement>();
        root = new DefaultMindmapNode("Mercedes", "Google", "FFCC00", false);
        /*MindmapNode bmw = new DefaultMindmapNode("BMW", "IP Nos", "6e9ebf", true);
        MindmapNode volvo = new DefaultMindmapNode("Volvo", "Names", "6e9ebf", true);
        MindmapNode audi = new DefaultMindmapNode("Audi", "Malicious ", "6e9ebf", true);
        MindmapNode renault = new DefaultMindmapNode("Renault", "IP Nos", "6e9ebf", true);
        MindmapNode opel = new DefaultMindmapNode("Opel", "Names", "6e9ebf", true);
        MindmapNode volkwagen = new DefaultMindmapNode("Volkswagen", "Malicious ", "6e9ebf", true);
        MindmapNode chrysler = new DefaultMindmapNode("Chrysler", "IP Nos", "6e9ebf", true);
        MindmapNode ferrari = new DefaultMindmapNode("Ferrari", "Names", "6e9ebf", true);
        MindmapNode ford = new DefaultMindmapNode("Ford", "Malicious ", "6e9ebf", true);*/

        Object label = root.getLabel();
        Enginetable entity;

        for( int i = 0 ; i < this.elements.size() ; i++){

                    entity = this.elements.get(i);

                    if ( !label.equals(entity.getStartnode() ) && label.equals(entity.getEndnode() ) ) {

                            root.addNode(new DefaultMindmapNode(entity.getStartnode() , "Malicious Software: ", "00FF99", true));

                    } 

                    else if ( !label.equals(entity.getStartnode() ) && !label.equals(entity.getEndnode() ) ){

                            root.addNode(new DefaultMindmapNode(entity.getStartnode() , "Malicious Software: ", "CC0000", true));

                    }

                    else if ( label.equals(entity.getStartnode() ) ) {

                            this.rootentity.setStartnode( entity.getStartnode() );
                            this.rootentity.setEndnode( entity.getEndnode() );
                            this.rootentity.setConnections( entity.getConnections() );
                            this.rootentity.setGroupid( entity.getGroupid() );
                            this.rootentity.setMoveid( entity.getMoveid() );
                            this.rootentity.setNewconnectioncost( entity.getNewconnectioncost() );
                            this.rootentity.setNewinfovalue( entity.getNewinfovalue() );
                            this.rootentity.setUsername( entity.getUsername() );
                            this.rootentity.setUserid( entity.getUserid() );

                    } 
        }
    }

    public void setElements(List<Enginetable> elements) {
        this.elements = elements;
    }

    public List<Enginetable> getElements() {
        return elements;
    }
    public void setFilteredElements(List<Enginetable> filteredElements) {
        //this.filteredElements = filteredElements;
        this.elements=filteredElements;
    }

    public List<Enginetable> getFilteredElements() {
        return filteredElements;
    }

    public void setSelectedElements(Enginetable[] selectedElements) {
        this.selectedElements = selectedElements;
    }

    public Enginetable[] getSelectedElements() {
        return selectedElements;
    }

    public void setSelectedElement(Enginetable selectedElement) {
        this.selectedElement = selectedElement;
    }

    public Enginetable getSelectedElement() {
        return selectedElement;
    }

    public MindmapNode getRoot() {
        return root;
    }

    public MindmapNode getSelectedNode() {
        return selectedNode;
    }
    public void setSelectedNode(MindmapNode selectedNode) {
        this.selectedNode = selectedNode;
    }

    public void onNodeSelect(SelectEvent event) {
        MindmapNode node = (MindmapNode) event.getObject();

            for( int i = 0 ; i < this.elements.size() ; i++){
                    Enginetable entity;
                    Object label = node.getLabel();
                    Object rootlabel = this.root.getLabel();

                    entity = elements.get(i);

                    if ( entity.getStartnode() == rootlabel ){
                        this.rootentity = entity;
                    }
                    if ( entity.getStartnode() == label ){
                        this.nodeentity = entity;
                    }

            }
    //load children of select node and add via node.addNode(childNode);
    //populate if not already loaded
        if(node.getChildren().isEmpty()) {

            for( int i = 0 ; i < this.elements.size() ; i++){
                    Enginetable entity;

                    entity = this.elements.get(i);

                    if ( (this.nodeentity.getStartnode() == null ? entity.getStartnode() != null : !this.nodeentity.getStartnode().equals(entity.getStartnode())) && (this.nodeentity.getEndnode() == null ? entity.getStartnode() != null : !this.nodeentity.getEndnode().equals(entity.getStartnode())) &&  (this.rootentity.getEndnode() == null ? entity.getStartnode() == null : this.rootentity.getEndnode().equals(entity.getStartnode()))  )  {

                            node.addNode(new DefaultMindmapNode(entity.getStartnode() , "Malicious Software: ", "33FF00", true));

                    } 

                     else if ( (this.nodeentity.getStartnode() == null ? entity.getStartnode() != null : !this.nodeentity.getStartnode().equals(entity.getStartnode())) && (this.nodeentity.getEndnode() == null ? entity.getStartnode() == null : this.nodeentity.getEndnode().equals(entity.getStartnode())) &&  (this.rootentity.getEndnode() == null ? entity.getStartnode() == null : this.rootentity.getEndnode().equals(entity.getStartnode()))  )  {

                            node.addNode(new DefaultMindmapNode(entity.getStartnode() , "Malicious Software: ", "3300FF", true));

                    }

                    else if ( (this.nodeentity.getStartnode() == null ? entity.getStartnode() != null : !this.nodeentity.getStartnode().equals(entity.getStartnode())) && (this.nodeentity.getEndnode() == null ? entity.getStartnode() == null : this.nodeentity.getEndnode().equals(entity.getStartnode())) &&  (this.rootentity.getEndnode() == null ? entity.getStartnode() != null : !this.rootentity.getEndnode().equals(entity.getStartnode()))  )  {

                            node.addNode(new DefaultMindmapNode(entity.getStartnode() , "Malicious Software: ", "FF9900", true));

                    }

                    else if ( (this.nodeentity.getStartnode() == null ? entity.getStartnode() != null : !this.nodeentity.getStartnode().equals(entity.getStartnode())) && (this.nodeentity.getEndnode() == null ? entity.getStartnode() != null : !this.nodeentity.getEndnode().equals(entity.getStartnode())) &&  (this.rootentity.getEndnode() == null ? entity.getStartnode() != null : !this.rootentity.getEndnode().equals(entity.getStartnode()))  )  {

                            node.addNode(new DefaultMindmapNode(entity.getStartnode() , "Malicious Software: ", "CC0000", true));

                    }

                }

            }
        }

    public void onNodeDblselect(SelectEvent event) {
        this.selectedNode = (MindmapNode) event.getObject();        
    }

    private EnginetableFacade getFacade() {
        return ejbFacade;
    }

    private void populateRandomElements(List<Enginetable> list, int size) { 
        userlist = this.getListByUserID( 1 );
        for(int i = 0 ; i < size ; i++)  {

            if ("Chrysler".equals(username[i])){
                Random rand = new Random();
                Enginetable gel =new Enginetable();
                gel.setMoveid(i);
                gel.setUserid(i);
                gel.setStartnode(username[i]);
                gel.setEndnode(username[9]);
                gel.setConnections(username[9]);
         //       gel.setPurpose("dubious");
         //       gel.setRelationship("naughty");
         //       gel.setExperimentid(1);
                gel.setNewinfovalue(1);
                gel.setNewconnectioncost(1);
                list.add(gel);
            }

            else {
                Random rand = new Random();
                Enginetable gel =new Enginetable();
                gel.setMoveid(i);
                gel.setUserid(i);
                gel.setStartnode(username[i]);
                gel.setEndnode(username[9-i]);
                gel.setConnections(username[9-i]);
         //       gel.setPurpose("dubious");
         //       gel.setRelationship("naughty");
         //       gel.setExperimentid(1);
                gel.setNewinfovalue(1);
                gel.setNewconnectioncost(1);
                list.add(gel);                
            }
        }
    }

//

    public Integer getMoveId(Enginetable ent) {
        return ent.getMoveid();
    }

    public void setMoveId(Enginetable ent, Integer id) {
        ent.setMoveid(id);
    }

    public Integer getUserId(Enginetable ent) {
        return ent.getMoveid();
    }

    public void setUserId(Enginetable ent, Integer id) {
        ent.setMoveid(id);
    }

    public String getStartNode(Enginetable ent) {
        return ent.getStartnode();
    }

    public void setStartNode(Enginetable ent, String startnode) {
        ent.setStartnode(startnode);
    }

    public String getEndNode(Enginetable ent) {
        return ent.getEndnode();
    }

    public void setEndNode(Enginetable ent, String endnode) {
        ent.setEndnode(endnode);
    }

 /*   public int getExperimentid(Enginetable ent) {
        return ent.getExperimentid();
    }

    public void setExperimentid(Enginetable ent, int experimentid) {
        ent.setExperimentid(experimentid); 
    }*/

    public int getNewInfoValue(Enginetable ent) {
        return ent.getNewinfovalue();
    }

    public void setNewInfoValue(Enginetable ent, int totalinfovalue) {
        ent.setNewinfovalue(totalinfovalue);
    }

    public String getConnections(Enginetable ent) {
        return ent.getConnections();
    }

    public void setConnections(Enginetable ent, String connections) {
        ent.setConnections(connections);
    }

    public String getNewConnections(Enginetable ent) {
        return ent.getConnections();
    }

    public void setNewConnections(Enginetable ent, String newconnections) {
        ent.setConnections( newconnections );
    }

 /*   public String getUserName(Enginetable ent) {
        return ent.getUsername();
    }

    public void setUsername(Enginetable ent, String name) {
        ent.setUsername(name);
    }
 */
    public List<Enginetable> getListByUsername(String user){
       return this.ejbFacade.getEnginetableByUsername(user);
    } 

    public List<Enginetable> getListByUserID( int id ){
       if ( this.ejbFacade.getEnginetableByUserid(id) == null){
       throw new NullPointerException("admin is null!");
       }
       else if ( this.ejbFacade.getEnginetableByUserid(id) != null){
       List<Enginetable> list = new ArrayList<Enginetable>();
       list = this.ejbFacade.getEnginetableByUserid(id);
           return list;
       }
       else{
           List<Enginetable> list = new ArrayList<Enginetable>();
                Enginetable gel =new Enginetable();
                gel.setMoveid(1);
                gel.setUserid(1);
                gel.setStartnode(username[1]);
                gel.setEndnode(username[9]);
                gel.setConnections(username[9]);
         //       gel.setPurpose("dubious");
         //       gel.setRelationship("naughty");
         //       gel.setExperimentid(1);
                gel.setNewinfovalue(1);
                gel.setNewconnectioncost(1);
                list.add(gel);
           return list;
       }
    } 
} 
```

为了完整起见，我已经包含了它导入的类的代码。

编辑：我删除了 Enginetable 类，因为我有太多字符无法通过堆栈跟踪提交。它只是获取和设置方法。

下面是 EngineTableFacade 类的代码： package jpa.session;

```
import java.util.List;
import javax.ejb.Stateless;
import javax.persistence.EntityManager;
import javax.persistence.NoResultException;
import javax.persistence.PersistenceContext;
import jpa.entities.Enginetable;

/**
 *
 * @author AOL
 */
@Stateless
public class EnginetableFacade extends AbstractFacade<Enginetable> {
    @PersistenceContext(unitName = "Networks0.1PU")
    private EntityManager em;

    @Override
    protected EntityManager getEntityManager() {
        return em;
    }

    public EnginetableFacade() {
        super(Enginetable.class);
    }

    public List<Enginetable> getEnginetableByUsername( String username ) {
        try {
            List<Enginetable> userlist = (List<Enginetable>)
            em.createNamedQuery("Enginetable.findByUsername").
                    setParameter("Username", username).getResultList();
            return userlist; 
        } catch (NoResultException nre) {
            return null;
        }
    }

    public List<Enginetable> getEnginetableByUserid( int id ) {
        try {
            List<Enginetable> userlist = (List<Enginetable>)
            em.createNamedQuery("Enginetable.findByUserid").
                    setParameter("Userid", id).getResultList();
            return userlist; 
        } catch (NoResultException nre) {
            return null;
        }
    }

} 
```

这会在调用 getListByUsername 或 getListByUserID 方法时引发 NullPointerException，但如果不是，则可以正常工作。检查 StackTrace 后，这证实了我的想法，即抛出异常的是这两种方法。

我怀疑，虽然我不确定，这意味着实体管理器在 mmBean 中为空。我不确定如何，甚至是否可以纠正这种情况。拜托，任何建议都将不胜感激，我对这座*需要*跨越但不能跨越的小桥感到非常困惑和沮丧。谢谢你。

编辑以包括堆栈跟踪：

```
com.google.common.collect.ComputationException: java.lang.RuntimeException: java.lang.NullPointerException
        at com.google.common.collect.ComputingConcurrentHashMap$ComputingMapAdapter.get(ComputingConcurrentHashMap.java:397)
        at org.jboss.weld.bean.proxy.ClientProxyProvider.getClientProxy(ClientProxyProvider.java:102)
        at org.jboss.weld.el.AbstractWeldELResolver.lookup(AbstractWeldELResolver.java:115)
        at org.jboss.weld.el.AbstractWeldELResolver.getValue(AbstractWeldELResolver.java:96)
        at javax.el.CompositeELResolver.getValue(CompositeELResolver.java:188)
        at com.sun.faces.el.DemuxCompositeELResolver._getValue(DemuxCompositeELResolver.java:176)
        at com.sun.faces.el.DemuxCompositeELResolver.getValue(DemuxCompositeELResolver.java:203)
        at com.sun.el.parser.AstIdentifier.getValue(AstIdentifier.java:103)
        at com.sun.el.parser.AstValue.getValue(AstValue.java:179)
        at com.sun.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:224)
        at org.jboss.weld.el.WeldValueExpression.getValue(WeldValueExpression.java:50)
        at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:109)
        at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)
        at org.primefaces.component.mindmap.Mindmap.getValue(Mindmap.java:98)
        at org.primefaces.component.mindmap.MindmapRenderer.encodeScript(MindmapRenderer.java:51)
        at org.primefaces.component.mindmap.MindmapRenderer.encodeEnd(MindmapRenderer.java:44)
        at javax.faces.component.UIComponentBase.encodeEnd(UIComponentBase.java:875)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1764)
        at javax.faces.render.Renderer.encodeChildren(Renderer.java:168)
        at javax.faces.component.UIComponentBase.encodeChildren(UIComponentBase.java:845)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1757)
        at javax.faces.component.UIComponent.encodeAll(UIComponent.java:1760)
        at com.sun.faces.application.view.FaceletViewHandlingStrategy.renderView(FaceletViewHandlingStrategy.java:402)
        at com.sun.faces.application.view.MultiViewHandler.renderView(MultiViewHandler.java:131)
        at javax.faces.application.ViewHandlerWrapper.renderView(ViewHandlerWrapper.java:288)
        at com.sun.faces.lifecycle.RenderResponsePhase.execute(RenderResponsePhase.java:121)
        at com.sun.faces.lifecycle.Phase.doPhase(Phase.java:101)
        at com.sun.faces.lifecycle.LifecycleImpl.render(LifecycleImpl.java:139)
        at javax.faces.webapp.FacesServlet.service(FacesServlet.java:594)
        at org.apache.catalina.core.StandardWrapper.service(StandardWrapper.java:1550)
        at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:281)
        at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:175)
        at org.apache.catalina.core.StandardPipeline.doInvoke(StandardPipeline.java:655)
        at org.apache.catalina.core.StandardPipeline.invoke(StandardPipeline.java:595)
        at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:161)
        at org.apache.catalina.connector.CoyoteAdapter.doService(CoyoteAdapter.java:331)
        at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:231)
        at com.sun.enterprise.v3.services.impl.ContainerMapper$AdapterCallable.call(ContainerMapper.java:317)
        at com.sun.enterprise.v3.services.impl.ContainerMapper.service(ContainerMapper.java:195)
        at com.sun.grizzly.http.ProcessorTask.invokeAdapter(ProcessorTask.java:860)
        at com.sun.grizzly.http.ProcessorTask.doProcess(ProcessorTask.java:757)
        at com.sun.grizzly.http.ProcessorTask.process(ProcessorTask.java:1056)
        at com.sun.grizzly.http.DefaultProtocolFilter.execute(DefaultProtocolFilter.java:229)
        at com.sun.grizzly.DefaultProtocolChain.executeProtocolFilter(DefaultProtocolChain.java:137)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:104)
        at com.sun.grizzly.DefaultProtocolChain.execute(DefaultProtocolChain.java:90)
        at com.sun.grizzly.http.HttpProtocolChain.execute(HttpProtocolChain.java:79)
        at com.sun.grizzly.ProtocolChainContextTask.doCall(ProtocolChainContextTask.java:54)
        at com.sun.grizzly.SelectionKeyContextTask.call(SelectionKeyContextTask.java:59)
        at com.sun.grizzly.ContextTask.run(ContextTask.java:71)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.doWork(AbstractThreadPool.java:532)
        at com.sun.grizzly.util.AbstractThreadPool$Worker.run(AbstractThreadPool.java:513)
        at java.lang.Thread.run(Thread.java:662)
Caused by: java.lang.RuntimeException: java.lang.NullPointerException
        at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInstantiation(SecureReflectionAccess.java:186)
        at org.jboss.weld.util.reflection.SecureReflections.newInstance(SecureReflections.java:341)
        at org.jboss.weld.bean.proxy.ProxyFactory.create(ProxyFactory.java:242)
        at org.jboss.weld.bean.proxy.ClientProxyProvider.createClientProxy(ClientProxyProvider.java:87)
        at org.jboss.weld.bean.proxy.ClientProxyProvider.access$000(ClientProxyProvider.java:43)
        at org.jboss.weld.bean.proxy.ClientProxyProvider$1.apply(ClientProxyProvider.java:53)
        at org.jboss.weld.bean.proxy.ClientProxyProvider$1.apply(ClientProxyProvider.java:46)
        at com.google.common.collect.ComputingConcurrentHashMap$ComputingValueReference.compute(ComputingConcurrentHashMap.java:355)
        at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.compute(ComputingConcurrentHashMap.java:184)
        at com.google.common.collect.ComputingConcurrentHashMap$ComputingSegment.getOrCompute(ComputingConcurrentHashMap.java:153)
        at com.google.common.collect.ComputingConcurrentHashMap.getOrCompute(ComputingConcurrentHashMap.java:69)
        at com.google.common.collect.ComputingConcurrentHashMap$ComputingMapAdapter.get(ComputingConcurrentHashMap.java:393)
        ... 52 more
Caused by: java.lang.NullPointerException
        at jsf.mmBean.getListByUserID(mmBean.java:360)
        at jsf.mmBean$Proxy$_$$_WeldClientProxy.getListByUserID(mmBean$Proxy$_$$_WeldClientProxy.java)
        at jsf.mmBean.populateRandomElements(mmBean.java:277)
        at jsf.mmBean.<init>(mmBean.java:74)
        at jsf.mmBean$Proxy$_$$_WeldClientProxy.<init>(mmBean$Proxy$_$$_WeldClientProxy.java)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
        at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:39)
        at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:27)
        at java.lang.reflect.Constructor.newInstance(Constructor.java:513)
        at java.lang.Class.newInstance0(Class.java:355)
        at java.lang.Class.newInstance(Class.java:308)
        at org.jboss.weld.util.reflection.SecureReflections$16.work(SecureReflections.java:344)
        at org.jboss.weld.util.reflection.SecureReflectionAccess.run(SecureReflectionAccess.java:52)
        at org.jboss.weld.util.reflection.SecureReflectionAccess.runAsInstantiation(SecureReflectionAccess.java:173)
        ... 63 more 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:27:40.490

您需要将ejb注入bean

```
@EJB
private jpa.session.EnginetableFacade ejbFacade; 
```

发现你的 mmBean 有更多问题，构造函数中的东西应该移到 postConstruct 方法中（因为它是在注入 EJB 后调用的）

```
@PostConstruct
public void init() {
    ... (code from constructor here)
} 
```

# forms - Symfony2 表单组验证

> ID：13293059
> 
> 赞同：1
> 
> 时间：2012-11-08T16:18:05.183
> 
> 标签：forms, validation, symfony

我尝试在我的表单中使用组验证，如下所示：

在类型类中：

```
public function setDefaultOptions(OptionsResolverInterface $resolver)
{
    $resolver->setDefaults(array(

        'validation_groups' => function(FormInterface $form) {
            $data = $form->getData();

            //if ($data->type == 0) {
            //    return array('Facebook');
            //} else {
            //    return array('mobile');
            //}
            return array('Facebook');
        },
    ));
} 
```

在我的实体中：

```
class Challenge
{
  /*
  * @Type("integer") 
  */
  public $id;

  /*
  * @Type("string") 
  * @Assert\NotBlank(groups={"Facebook"})
  */
  public $title;
} 
```

问题是没有触发标题字段的验证。

有任何想法吗 ？

谢谢

# asp.net-mvc - MVC4 中的可重用文本

> ID：13293061
> 
> 赞同：0
> 
> 时间：2012-11-08T16:18:09.203
> 
> 标签：asp.net-mvc, text, asp.net-mvc-4

我只是在学习 MVC4，所以这是一个非常基本的问题。

我有一串文本，我想在多个页面上显示。完成此操作的最佳实践是什么（除了将其复制/粘贴到每个 cshtml 中）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:34:55.287

您可以在静态类中的代码中定义它们：

```
namespace MyNamespace
{
    public static class MyConstants
    {
        public static string message = "Whatever I wanted to say";
    }
} 
```

并在 cshtml 中使用它们：

```
@using MyNamespace
<h1>@ViewBag.Title @constants.message    </h1> 
```

还可以查看 VikViks 问题的答案：[Share constants between C# and Javascript in MVC Razor](https://stackoverflow.com/questions/6217028/share-constants-between-c-sharp-and-javascript-in-mvc-razor)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:28:56.847

如果它将出现在每一页上，请按照 Maess 的建议将其放入 _layout 文件中。如果您只想在特定视图中使用它，您可以创建一个局部视图并将其插入到您希望它显示的任何位置。

# java - Maven 编译错误

> ID：13293062
> 
> 赞同：12
> 
> 时间：2012-11-08T16:18:12.010
> 
> 标签：java, maven, netbeans, build, maven-3

当我在 Netbeans 中构建和运行我的程序时，它可以正常工作。但是当我尝试“mvn compile”时使用相同的 pom.xml 文件，我收到此错误：

```
[ERROR] Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:2.0.2:compile (default-compile) on project hadoop-test: Compilation failure
[ERROR] /home/metin/NetBeansProjects/hadoop-test/src/main/java/com/citusdata/hadoop/HadoopTest.java:[53,8] error: generics are not supported in -source 1.3 
```

我的java版本不是1.3，这里是“mvn -version”的结果

```
Apache Maven 3.0.4
Maven home: /usr/share/maven
Java version: 1.7.0_03, vendor: Oracle Corporation
Java home: /usr/lib/jvm/java-7-openjdk-amd64/jre
Default locale: en_US, platform encoding: UTF-8
OS name: "linux", version: "3.2.0-27-generic", arch: "amd64", family: "unix" 
```

这是第 53 行：

```
Token<BlockTokenIdentifier> token = locatedBlock.getBlockToken(); 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-08T16:22:45.690

问题是`maven-compiler-plugin`在 Maven2 中默认使用`-source 1.3`和`target 1.3`

您可以通过将其添加到您的 pom 来修复它：

```
 <plugin>
      <groupId>org.apache.maven.plugins</groupId>
      <artifactId>maven-compiler-plugin</artifactId>
      <configuration>
        <compilerVersion>1.5</compilerVersion>
        <source>1.5</source>
        <target>1.5</target>
      </configuration>
    </plugin> 
```

把它放在`pluginManagement`最顶层的父 pom 中是很实用的，这样你的派生 pom 就不需要关心这个了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T16:21:27.300

您必须在 pom.xml 中添加一些信息。像这样的东西：

```
 <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
             <source>1.6</source>
             <target>1.6</target>
        </configuration>
  </plugin> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:23:30.653

在您的日志中，我看到这一行：

```
generics are not supported in -source 1.3 
```

检查maven-compiler插件的源和目标配置，更新到1.5。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:22:02.603

看来您的 Maven 编译器插件版本是 1.3。

查看此链接以强制编译器与 JDK 1.7 一起运行，[http ://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html](http://maven.apache.org/plugins/maven-compiler-plugin/examples/compile-using-different-jdk.html)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-05-17T20:12:59.243

这是在 Eclipse Indigo 中修复相同错误的一种稍微不同的方法。

*   在 Eclipse 中打开您的 (maven) 项目。
*   右键单击 pom.xml
*   选择 ...Maven...添加插件
*   进入：

    ```
     - groupId: org.apache.maven.plugins
      - artifactId: maven-compiler-plugin
      - version: 2.3.2 
    ```

这将在您的 pom.xml 中插入一个新部分并打开一个窗口进行编辑。

然后，您可以按上述方式添加源和目标 xml 元素以选择正确的 JRE。

该部分在我的项目中如下所示：

```
<build>
  <plugins>
     <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
           <source>1.6</source>
           <target>1.6</target>
        </configuration>
     </plugin>
  </plugins>
</build> 
```

请注意其他一些帖子中缺少“构建”和“插件”的额外标签。

保存文件后，Eclipse 将通知您您的 pom 与您的项目不同步。

然后您可以右键单击项目...选择 Maven..update 项目

对我来说，一个关键的见解是 Maven 会自动在 Eclipse 中重新设置构建路径。您可以通过 Project...build path..configure build path...Libraries 进行验证。

因此，从本质上讲，这意味着如果您使用的是 Maven 项目，则不必直接在 Eclipse 中配置构建路径。

高温高压

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-08T16:24:28.577

看来您的 maven java home 指向 jre 而不是 jdk

```
Java home: /usr/lib/jvm/java-7-openjdk-amd64/jre 
```

您必须将其更改为jdk。

试试看`java -version`有什么

用于`/usr/sbin/alternatives --config java` 更改您的 java 版本。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-06-11T17:10:33.797

**将此添加到 Pom.xml**

```
<properties>
    <maven.compiler.target>1.8</maven.compiler.target>
    <maven.compiler.source>1.8</maven.compiler.source>
</properties> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-01-05T10:05:33.703

请从 Eclipse 执行 Maven Run，然后从命令提示符运行 mvn test。就我而言，此步骤解决了所有问题。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2021-09-20T04:19:37.567

**如果您使用 Java 8 和 Spring Boot 运行应用程序，则可以通过将以下行添加到 pom.xml 文件来解决此问题**

```
 <build>
            <plugins>
                    <plugin>
                            <groupId>org.springframework.boot</groupId>
                            <artifactId>spring-boot-maven-plugin</artifactId>
                    </plugin>
                    <plugin>
                            <groupId>org.apache.maven.plugins</groupId>
                            <artifactId>maven-compiler-plugin</artifactId>
                            <version>2.3.2</version>
                            <configuration>
                                 <source>1.8</source>
                                 <target>1.8</target>
                            </configuration>
                    </plugin>
            </plugins>
    </build> 
```

# javascript - 坚持到顶部然后放入 css - [我有示例站点]

> ID：13293064
> 
> 赞同：0
> 
> 时间：2012-11-08T16:18:22.373
> 
> 标签：javascript, css

![在此处输入图像描述](../Images/e6e3dc8a048baa7043eef503e398119e.png)我刚刚发现了这个关于艺术[的好网站。](http://art.sy/)我很好奇他们可以让左边的头球粘在顶部然后停在特定的地方。由于我的理解，`position: absolute;`应该一直坚持下去，不是吗？

我们是否需要任何 javascript 或仅 CSS 来制作相同的东西？提供的例子会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:22:57.230

如果您检查元素然后向下滚动，您可以看到它是如何工作的。

直到`absolute`您滚动了大约 90 像素，然后它才会更改`position`为`static`. 静态使元素浮动在页面上。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:26:38.477

是的，它似乎使用 JS 来创建这种效果。最简单的判断方法是在 Chrome/Chromium 中点击 Inspect Element，然后滚动查看文章——注意`position`滚动时内联属性如何变化。这只能通过 JS 发生。

不仅如此，很难说，因为他们所有的脚本都被缩小了，但我假设它使用[`jQuery.scroll()`](http://api.jquery.com/scroll/)'s 回调来检测正在显示的文章，然后基于它触发固定/绝对样式交换以允许标题滚动或不是。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:25:20.023

这个[Way Points 插件](http://imakewebthings.com/jquery-waypoints/sticky-elements/)正是我认为您正在寻找的。它使用 jquery 根据用户滚动的位置将定位从绝对位置更改为固定位置

你不能只用 css 来完成这个，你需要一些 jQuery 的 javascript 来监控用户滚动

当然，您可以自己编写脚本来检测滚动并手动更改定位，但如果您没有太多经验（因为您还不知道那是 javascript - 或者绝对定位不会坚持元素到顶部）挑衅地使用插件并首先习惯它的工作方式。

# asp.net-mvc - 将大型实体列表映射到 ViewModel 的 PagedList

> ID：13293066
> 
> 赞同：5
> 
> 时间：2012-11-08T16:18:50.360
> 
> 标签：asp.net-mvc, viewmodel, pagedlist

如何在基于 ASP MVC 和 ViewModels 的 Web 应用程序中使用 PagedList。

我想制作一个 Viewmodels 的 PagedList，所以首先我必须将实体映射到 Viewmodels。

当我获取一个大列表时，它非常慢，因为首先在 PagedList 生成之前执行映射（因此获取整个实体列表）。

解决此问题的最佳方法是什么？

```
IEnumerable<InvoiceData> invoiceData = dataService.GetInvoiceData(locationId);

Mapper.CreateMap<InvoiceData, ViewModelInvoiceData>();
IEnumerable<ViewModelInvoiceData> vmInvoiceData = Mapper.Map<IEnumerable<InvoiceData>, IEnumerable<ViewModelInvoiceData>>(invoiceData);

IPagedList<InvoiceDataViewModel> pagedListVMInvoiceData = vmInvoiceData.ToPagedList(page, pageSize); 
```

（我也使用了映射框架，但自定义映射器类当然是同样的问题）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-16T10:41:42.887

为什么你没有在服务器上分页你的数据？[然后像troygoode / PagedList](https://github.com/TroyGoode/PagedList)中的示例 2 那样创建手动寻呼机？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-08T16:14:57.610

我遇到过同样的问题。我通过使用 IQueryable 接口而不是 IEnumerable 加快了我的结果（它们仍然不是那么快，但更快）

改变这个：

```
IEnumerable<InvoiceData> invoiceData = dataService.GetInvoiceData(locationId); 
```

对此：

```
IQueryable<InvoiceData> invoiceData = dataService.GetInvoiceData(locationId); 
```

# python - Django通过关系查询不对称自我

> ID：13293068
> 
> 赞同：2
> 
> 时间：2012-11-08T16:18:55.557
> 
> 标签：python, django, django-orm

我有以下 - 简化 - 模型：

```
class User(models.Model):
    following = models.ManyToManyField("self", through='Following', symmetrical=False)

class Following(models.Model):
    from_user = models.ForeignKey(User, related_name='from_user')
    to_user = models.ForeignKey(User, related_name='to_user')
    status = models.IntegerField() 
```

状态为 0 表示挂起，1 表示关注 让用户成为用户。我想获得用户的所有关注用户

我可以

```
user.following.all() 
```

获取用户关注的所有用户（待定关系或真正关注）

或者

```
Following.objects.filter(from_user=user, status=1) 
```

以用户用户和真正的友谊获取所有以下对象

但是如何获取 user 和 status=1 的所有 User 对象？我似乎找不到方法

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:37:49.323

尝试

```
user.following.filter(to_user__status=1) 
```

`user.following`仍在查询`User`，因此您需要跨越与`__`此处`Follow`的关系。

这里的两个字段`from_user`和`to_user`都`ForeignKey`指向`User`模型。因此，`User()`例如`u`：

*   `u.following`通过中间表搜索`User()`与 w/ 有关系的 s 。这里的关键是选择指向 ,的第一个作为对自身的引用。因此，对于您的版本，过滤具有等于和w/等于的项目。查找是典型的[反向关系](https://docs.djangoproject.com/en/1.4/topics/db/queries/#following-relationships-backward)`u``Follow``u.following``ForeignKey``Follow``User``u``Follow``u.following.filter(to_user__status=1)``Follow``from_user``u``to_user``status``1`
*   `u.from_user`在中间表中搜索`from_user`等于`u`
*   `u.to_user`在中间表中搜索`to_user`等于`u`

此外，您可以直接过滤，并`ForeignKey`记住`from_user`and`to_user`都是 ref `Follow`：

```
User.objects.filter(to_user__from_user=user, to_user__status=1) # user as from_user
User.objects.filter(from_user__to_user=user, from_user__status=1) # user as to_user
User.objects.filter(following=user) # those who are followed by `to_user` user 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-11T18:31:02.647

看来

```
user.following.filter(to_user__status=1) 
```

成功了。有人可以向我解释为什么，以及这是如何工作的吗？ `user.following`是一个正在查询用户的 ManyRelatedManager。会`user.following.filter(from_user__status=1)`做什么？无法猜测它会返回什么...再次感谢！

# c# - 存储对对象的引用

> ID：13293073
> 
> 赞同：15
> 
> 时间：2012-11-08T16:19:22.823
> 
> 标签：c#, c++

有点奇怪的问题，但我想知道任何人都可以帮助...

在 C++ 中，我可以做这样的事情

```
class MyOtherClass
{
     private:
         MyLogger* logger;
     public:
         MyOtherClass (MyLogger* logger)
              : logger (logger)
         {}
};

class MyClass
{
     private:
         MyLogger* logger;
     public:
         MyClass (MyLogger* logger)
              : logger (logger)
         {}
};

int main (int c, char** args)
{
    MyLogger* logger = new MyLogger ();
    /* Code to set up logger */
    MyOtherClass* myOtherClass = new MyOtherClass (logger);
    MyClass* myClass = new MyClass (logger);
} 
```

这样每个其他对象（myOtherClass 和 myClass）都将包含指向记录器的指针，因此它们将调用相同的记录器类。但是，我将如何在 C# 中实现相同的目标？有没有办法存储指向全局对象的引用或指针 - 我猜如果我在 C# 中执行类似的操作

```
public class MyClass
{
     private MyLogger logger = null;

     public MyClass (MyLogger _logger)
     {
         logger = _logger;
     }
}; 
```

它实际上将类变量记录器分配给_logger的副本？还是我把事情搞混了：S

非常感谢任何帮助，并提前感谢您！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-08T16:21:43.960

在 C# 中它实际上要简单得多。

基本上，你可以这样做：

```
MyLogger logger = new MyLogger();
MyOtherClass myOtherClass = new MyOtherClass(logger);
MyClass myClass = new MyClass(logger); 
```

在 C# 中，类基本上作为引用保留（实际上只是引擎盖下的指针）。在此代码段中，您将*引用*传递`logger`给两个对象的构造函数。该引用是相同的，因此每个实例都有相同的`MyLogger`实例。

在这种特殊情况下，您几乎只需要删除指针语法 =D

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-08T16:22:12.740

你把事情搞混了。在 C# 中，赋值语句如

```
 logger = _logger; 
```

复制*引用*，而不是*对象*。在这条语句执行之后，仍然（最多）只有一个`MyLogger`——它现在*被*两个对象变量引用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T16:21:19.047

如果类型是引用类型（类就是这种情况），那么您将复制引用，而不是对象本身。

与引用类型相反，您有值类型。值类型基本上是基本类型：`int`，，`double`等，

在您的情况下，这意味着您将使用相同的对象，无论您是从类还是从外部调用方法访问它。这是因为您的目标是引用的对象。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-18T13:05:43.137

为将来的我添加评论，因为有时我也忘记了，对于 c# 中的新手也想可视化“c++ 指针”与“c# 对象引用”与“C# 对象引用 By Ref”。注意 Passing By Ref(Last method call) 和分配新的 obj 是如何改变原始对象的。

```
using System;

public class Emp
{
    public int TimeSpentInCompany {get; set;}
}

public class Program
{
    public static void Main()
    {

        Emp t1 = new Emp{TimeSpentInCompany = 5};
        Console.WriteLine("original obj before method call-->" + t1.TimeSpentInCompany);

        // Test is one by one

        // var res = PassObject_SimpleUpdateMemberAndPrint(t1);
        // var res = PassObject_SimpleUpdateObjectAndPrint(t1);
        // var res = PassObjectByRef_SimpleUpdateMemberAndPrint(ref t1);
        var res = PassObjectByRef_SimpleUpdateObjectAndPrint(ref t1);

        Console.WriteLine("original obj after method call-->" + t1.TimeSpentInCompany);
        Console.WriteLine("obj from method response-->" + res.TimeSpentInCompany);
    }

    static Emp PassObject_SimpleUpdateMemberAndPrint(Emp data)
    {
        /*
            original obj before method call-->5
            in method before modification obj member--> 5
            in method AFTER modification obj member--> 9
            original obj after method call-->9
            obj from method response-->9
        */      
        Console.WriteLine("in method before modification obj member--> "+ data.TimeSpentInCompany);
        data.TimeSpentInCompany += 4;
        Console.WriteLine("in method AFTER modification obj member--> "+ data.TimeSpentInCompany);
        return data;
    }   

    static Emp PassObject_SimpleUpdateObjectAndPrint(Emp data)
    {
        /*
            original obj before method call-->5
            in method before assigning new obj --> 5
            in method AFTER assigning new obj --> 9
            original obj after method call-->5
            obj from method response-->9
        */
        Console.WriteLine("in method before assigning new obj --> "+ data.TimeSpentInCompany);
        data = new Emp{TimeSpentInCompany = 9};
        Console.WriteLine("in method AFTER assigning new obj --> "+ data.TimeSpentInCompany);
        return data;
    }

    static Emp PassObjectByRef_SimpleUpdateMemberAndPrint(ref Emp data)
    {
        /*
            original obj before method call-->5
            in method before modification obj member--> 5
            in method AFTER modification obj member--> 9
            original obj after method call-->9
            obj from method response-->9
        */      
        Console.WriteLine("in method before modification obj member--> "+ data.TimeSpentInCompany);
        data.TimeSpentInCompany += 4;
        Console.WriteLine("in method AFTER modification obj member--> "+ data.TimeSpentInCompany);
        return data;
    }   

    static Emp PassObjectByRef_SimpleUpdateObjectAndPrint(ref Emp data)
    {
        /*
            original obj before method call-->5
            in method before assigning new obj --> 5
            in method AFTER assigning new obj --> 9
            original obj after method call-->9
            obj from method response-->9
        */
        Console.WriteLine("in method before assigning new obj --> "+ data.TimeSpentInCompany);
        data = new Emp{TimeSpentInCompany = 9};
        Console.WriteLine("in method AFTER assigning new obj --> "+ data.TimeSpentInCompany);
        return data;
    }
} 
```

# objective-c - 解析html表格xcode

> ID：13293074
> 
> 赞同：0
> 
> 时间：2012-11-08T16:19:25.970
> 
> 标签：objective-c, html-table, html-parsing

我如何在 Objective-C 中从 html 解析整个表格，保存它，然后在离线时在 WebView 中显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:23:00.370

使用 NSXMLDocument 并分析 DOM - 它使用 xpath 工作，但可以与 KVC 一起使用（它抽象了整个 HTML 语法）

# c# - SharePoint 2010“错误”打开通过 C# 创建的 Excel

> ID：13293080
> 
> 赞同：1
> 
> 时间：2012-11-08T16:19:50.103
> 
> 标签：c#, sharepoint-2010, openxml, excel-2010

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-23T14:36:13.357

Thanks to [**this article**](http://blogs.msdn.com/b/brian_jones/archive/2009/09/24/finding-open-xml-errors-with-open-xml-sdk-validation.aspx) I found the problem. With the ***OpenXmlValidator*** class you can easily find errors in a created file. In my case the problem was that the title/name of one of my sheets was longer than 31 characters and 31 seems to be the limit. Problem solved, so for anyone with a similar issue, I strongly recommend the use of the validator! ;)

# system-verilog - System Verilog wait() 语句将等待的最短时间/周期是多少？

> ID：13293087
> 
> 赞同：2
> 
> 时间：2012-11-08T16:19:58.410
> 
> 标签：system-verilog, systemc

我有一个 SystemVerilog 任务，我正在尝试移植到 SystemC。任务的主体只是等待一个布尔表达式，然后推送到一个队列中。SystemC 等待机制的工作方式并不完全相同，它只会等待时间或事件。

所以我想知道 SystemVerilog wait() 在重新测试布尔表达式之前等待的最小周期/时间长度是多少。换句话说，在 SV wait() 中驱动重新测试布尔表达式的频率或原因是什么？

如果答案只是每个周期一次，我希望并期望但无法确认，那么解决方案很容易。

这是代码，其中一些内容被重命名和简化，以便脱离上下文更有意义：

```
 virtual task put(input cls_item item);
        wait (queuecount < queuemax);
        push_back(item);
    endtask 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T18:06:04.877

来自 LRM：

> ## 9.4.3 电平敏感事件控制
> 
> 程序语句的执行也可以延迟到条件变为真为止。这是使用等待语句完成的，它是一种特殊形式的事件控制。等待语句的性质是级别敏感的，与基本事件控制（由@ 字符指定）相反，后者是边缘敏感的。
> 
> 等待语句将评估一个条件；并且，如果它为假，则等待语句之后的程序语句应保持阻塞，直到该条件变为真，然后再继续。

基本上，您可以将其`wait(<boolean expression>)`视为连续检查表达式。一旦表达式为真，等待将解除阻塞，顺序代码的执行将继续。

如果`wait()`第一次遇到时表达式为真，则根本不会等待。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T00:29:28.970

我同意你可以认为`wait(expression)`总是不断地检查条件表达式。这是设计者的想法，但是不能以这种方式设计计算机程序，否则会在条件检查循环中浪费 CPU 时间。

在`SystemVerilog`中，它的编译器可能会将布尔表达式建模为一个事件。当执行运行到`wait()`并且条件为假时，模拟内核暂停当前线程并执行其他线程。在模拟中，每当`queuecount`或`queuemax`已经改变时，使用`<`算子重新计算条件。一旦满足条件，就会触发事件，然后等待线程被重新调度并准备恢复其执行。

在`SystemC`中，因为它是`C/C++`世界加上一个事件驱动的硬件建模库，所以你很自然地`C/C++`会编写一个类似`function(<condition expression>)`. 但是，在`C/C++`编译之后`GCC`，实际上程序将首先评估`<condition expression>`then 传递作为函数的参数。这是软件方式。这样，在`wait()`功能上，它只能看到`true`or`false`或 0/1，它确实知道您在等待什么。`wait()`对于硬件建模的真正意图没有任何意义。因此，`wait()`can 只接受`event`SystemC 中的参数。例如，

```
wait (event);       // waiting for the event
wait (a_signal);    // signal interface has value_changed_event, posedge_event, negedge_event
wait (10, SC_NS);   // simulation time is also an event in SC kernel 
```

如果您想为`wait()`类似 SystemVerilog 的相同条件建模，则必须手动编写事件的详细信息。以下是概念验证伪代码，您可以从 SystemC 或 sc_fifo 类中找到示例。

```
 sc_event           waiting_event;

    void put( ... ) {
        while (!(queuecount < queuemax))
            wait( waiting_event);
        push_back(...);
    }

    void get( ... ) {
        ...
        notify_queue_available();
    }

    void notify_queue_available() {
        if (queuecount < queuemax)
            waiting_event.notify();
    } 
```

# ide - 如何在 Qt Creator 中禁用代码折叠？

> ID：13293088
> 
> 赞同：4
> 
> 时间：2012-11-08T16:19:58.520
> 
> 标签：ide, qt-creator, code-folding

我有一个在 Qt Creator 中工作的项目，需要断点来调试。我希望能够通过单击行号旁边的来添加断点，因为它对我来说很直观。但是，当我在 Qt Creator 中单击时，代码被折叠并且没有添加断点。

我可以通过按 F9 来切换断点，所以这不是主要问题。我什至可以通过单击行号的左侧来添加断点。但是，我倾向于单击行号的右侧，这会导致折叠我的代码。我可以以某种方式禁用代码折叠吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-10T07:32:17.800

**您可以通过取消选中工具 > 选项 > 文本编辑器 > 显示 > 显示折叠标记**来隐藏折叠标记。请参阅文档的相关部分：[突出显示和折叠块](http://doc.qt.io/qtcreator/creator-highlighting.html#highlighting-and-folding-blocks)。

# java - 集成测试对单元测试的依赖：构建 JUnit 集成测试的好/致命的无法实现的策略？

> ID：13293101
> 
> 赞同：0
> 
> 时间：2012-11-08T16:20:49.917
> 
> 标签：java, unit-testing, junit, integration-testing

我正在工作的系统（幸运的是）已经有 JUnit 单元测试，它覆盖了一定比例的代码功能（我想总比没有好）。

系统中的方法相互高度依赖，可以作为输入发送到方法的参数组合非常庞大。让我们看一个例子：

```
public void showMessage (final Language language, final Applications apps, final UserID userId) 
```

根据不同的应用程序和用户 ID，上述方法可以弹出超过 300,000 个不同的消息框。除了对一个方法施加如此巨大的压力至少对其中的几个方法听起来是否合理（IMO 在设计方面不能证明是合理的）这一事实之外，我们还担心会导致巨大问题的错误。

话虽如此，我们发现的内容如下：

1.  重构 JUnit 单元测试
2.  提取方法中的很多对象作为参数
3.  创建对象工厂
4.  使用工厂创建的不同输入来提供单元测试（可能是蛮力测试？）
5.  检查新重构的测试的结果

所以基本上，问题如下：

在单元测试之上创建集成测试：可能性和挑战？这是一种定制方法还是一种合理的标准方法？在项目文件和项目构建生命周期中将此类测试放在哪里，是否应该一直构建它们以完成构建过程？

来自 JUnit 实现限制和设计/创意限制的任何类型的反馈/评论。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:39:53.237

集成测试的重点是验证组件是否正确交互在一起。您的每个单元测试都应该验证单个原子代码。一般经验法则（根据我的经验）如果您有一个超过 10 行代码的单元测试，那么您做错了什么，这当然不包括技术上属于`@Before`/`@After`块中测试的一部分的代码。关于单元测试的另一件事是它们可以**不**依赖于任何其他集成测试。我不会使用您上面描述的方法，因为单元测试将使用静态数据。这在回归测试中也起着很大的作用，在回归测试中，旧的单元测试会转移到在发布之前执行的回归套件中。

您的集成测试将依赖于诸如 DBUnit、Selenium 等项目。需要诸如数据库或 GUI 之类的依赖项来执行/验证。单元测试应该在开发人员执行签入之前运行。集成测试应该在每次发生变化时运行（或者无论你对潜在错误的容忍度如何，一天一次太少了）。

我再次建议**不要**在单元测试中使用动态数据。主要是因为您的断言可能会失败，但这并不能证明单元测试无效。

**更新**

> 好吧，正如我所说，我认为这是一个集成测试。我不确定的是，在集成测试中，您正在测试系统链，而不是这些系统的单元测试！单元测试和集成测试之间的依赖性也是一个问题，IMO！

回复：
您对单元测试副集成测试有一个根本的误解。代码单元，即函数没有任何依赖关系，如果它们这样做，您的架构需要进行彻底的检修。通过集成测试，您必须构建不同的场景来证明两个不相交的模块相互交互。这并不意味着将来自两个单元测试的逻辑组合成一个“集成”测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-19T18:37:23.053

阿米尔，

构建“在单元测试之上的集成测试”是什么意思？我会看到集成测试是相当粗粒度的黑盒测试，测试部署在服务器上与真实数据库、JMS 队列、第 3 方 Web 服务等对话的应用程序。通常，您可能想要模拟您不拥有的基础设施（例如3rd 方网络服务等）。

集成测试将比单元测试慢得多，因此您往往不会在每次构建时都执行它们。如果您使用像 jenkins 这样的 CI 服务器，您可能会创建一个单独的集成构建来执行您拥有的所有测试（单元 + 集成）。

您在单元测试中提到了动态数据。我认为最好使用静态输入数据进行单元测试，以确保它们每次执行时都覆盖相同的执行路径，验证在引入新代码时是否发生任何行为变化或测试一些极端情况......

但..

拥有额外的测试套件也是一个好主意，这些测试会用随机输入数据对您的应用程序施加压力。AFAIK Lucene/Solr 的人采用了这种方法，他们甚至开源了他们自己的随机测试框架。看看这些链接：

[http://labs.carrotsearch.com/randomizedtesting.html](http://labs.carrotsearch.com/randomizedtesting.html)

[http://vimeo.com/32087114](http://vimeo.com/32087114)

至于如何使用遗留软件的一般方法，我推荐 M. Feather 的“Working Effectively with Legacy Code”。很棒的书，它可能会给你一些想法，如何用单元测试覆盖你现有的代码并提高代码质量。

[http://www.amazon.com/Working-Effectively-Legacy-Michael-Feathers/dp/0131177052](https://rads.stackoverflow.com/amzn/click/com/0131177052)

# foursquare - 四方访问令牌 C#

> ID：13293106
> 
> 赞同：0
> 
> 时间：2012-11-08T16:21:08.573
> 
> 标签：foursquare

我在从 FourSquare 为我的 C# 桌面应用程序获取访问令牌时遇到问题。我在他们的网站上注册了我的应用程序并获得了客户端 ID 和秘密 ID。对于我的回调 url，我输入了 http..localhost:8080。我不知道该放什么，我知道它没有多大意义，但它就在那里。

我找到了一种使用浏览器获取访问令牌的方法。当我尝试以下网址时：

```
https://foursquare.com/oauth2/authenticate?client_id=MY_CLIENT_ID&response_type=token&redirect_uri=https:localhost:8080/ 
```

它试图重定向到：

http:localhost:8080/?accsess_token=OBTAINED_ACCSESS_TOKEN

所以你去，我得到了我的访问令牌。现在，我尝试通过查看 C# 中的响应标头在我的 C# 代码中做一些类似的事情，并且在 Location 标头中应该有：

http:localhost:8080/?accsess_token=OBTAINED_ACCSESS_TOKEN

但是我有一个问题，响应中没有 Location 标头。当我在浏览器中查看 HttpFox 中的响应标头时，响应内有一个带有我的链接的 Location 标头。

我已经在这里发布了我到目前为止所做的事情，我在这里碰到了一堵砖墙。如果有人知道从 FourSquare 获取桌面应用程序访问令牌的任何其他方式，或者有解决上述标题问题的方法。请张贴。如果有人对此有答案，我会请他喝啤酒，因为这是我工作任务的一部分。:)

到目前为止，这是我的代码。

```
 string url = "https://foursquare.com/oaut2/authenticate?client_id=E4HFYP1LRDSAL21WJVJ1EBT1NSG1DPRHSNXN0PFI10UIOX0N&response_type=token&redirect_uri=https:localhost:8080/";

HttpWebRequest request = null;
HttpWebResponse response = null;
try
{
    request = WebRequest.Create(url) as HttpWebRequest;
    response = request.GetResponse() as HttpWebResponse;
    request.AllowAutoRedirect = false;
    int status = (int)response.StatusCode;
    Console.WriteLine("Request headers: ");
    Console.WriteLine("-------------------------------------------------------------");
    foreach (string s in request.Headers)
    {
         Console.WriteLine(s + ": " + request.Headers[s]);
    }
    Console.WriteLine("Response headers: ");
    Console.WriteLine("-------------------------------------------------------------");

    foreach (string header in response.Headers)
        Console.WriteLine(header + ": " + response.Headers[header]);
}
catch (Exception x)
{
    Console.WriteLine(x.Message);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-12-25T01:06:13.453

在 C# 中，您无法在没有用户干预的情况下获取访问令牌，pord911 提供了解决方案。但正如他所说，它仍然令人讨厌。Foursequare 应该以与 twitter 相同的方式重新设计他们的 Oauth2 Rest API。

话虽如此，您可能想看看这项工作：[https ://codeload.github.com/ignatandrei/4SqDayHistory/zip/master](https://codeload.github.com/ignatandrei/4SqDayHistory/zip/master)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T19:53:29.207

看起来你拼错了网址。你有foursquare.com/oaut2，它应该是foursquare.com/oauth2

另外，请注意您的 URL 格式不正确。它应该是“http://localhost:8080”，而不是“http:localhost:8080”。请务必在您的代码以及您在[foursquare.com/oauth上注册的重定向URI 中进行更改](http://foursquare.com/oauth)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-15T21:30:33.853

谢谢回复。但是我解决了一个 webbrowser 对象的问题，该对象在单击按钮时触发，并带有用于获取 access_token 的初始 url。当使用 access_token 将重定向触发到我的“http://localhost...”url 时，会触发一个 Form_Navigated 事件，处理程序会搜索“access_token”并捕获它。当找到“access_token”时，webbrowser 窗口会自动隐藏，留下您的初始窗口和来自foursquare 的列出数据。仅仅为了获取 access_token 而显示一个空白表格几秒钟看起来有点讨厌，但它可以工作。我在foursquare上找到了这个解决方案。但他们提出了适用于 Android 应用程序的解决方案。链接在这里。

[https://github.com/foursquare/android-oauth-example/blob/master/workspace/android-oauth-example/src/com/foursquare/android/oauth/ActivityWebView.java](https://github.com/foursquare/android-oauth-example/blob/master/workspace/android-oauth-example/src/com/foursquare/android/oauth/ActivityWebView.java)

# ios - iPad和iPhone版共享游戏中心

> ID：13293114
> 
> 赞同：1
> 
> 时间：2012-11-08T16:21:21.583
> 
> 标签：ios, app-store-connect, gamekit

下面的文本复制自[http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/GameKit_Guide/MatchmakingwithGameCenter/MatchmakingwithGameCenter.html#//apple_ref/doc/uid/TP40008304-CH12-SW2](http://developer.apple.com/library/mac/#documentation/NetworkingInternet/Conceptual/GameKit_Guide/MatchmakingwithGameCenter/MatchmakingwithGameCenter.html#//apple_ref/doc/uid/TP40008304-CH12-SW2)。

我找不到粗体文本的设置。我正在开发一款回合制游戏，我希望 iPhone 和 iPad 版本能够相互对战。

> 在 iTunes Connect 中，您可以提供兼容性信息来描述您的游戏的哪些版本可以在匹配过程中相互看到。每个兼容的设备组和游戏版本都作为单独的组进行匹配。创建这些配对组的能力非常灵活：
> 
> *   当您创建游戏的新版本（例如错误修复）时，您可以声明新版本是否与旧版本兼容（具体是哪些）。
>     
>     
> *   **您可以创建不同的游戏（使用不同的捆绑包标识符）并仍然允许它们相互对战。**
>     
>     
> *   您可以在 OS X 和 iOS 上创建不同的游戏并将它们相互匹配。

这篇文章[iPhone game - full and lite version and game center (bundle id)](https://stackoverflow.com/questions/7188248/iphone-game-full-and-lite-version-and-game-center-bundle-id)声明这是不可能的。我很困惑。

# javascript - jQuery.cookie 不存储我的 JSON 字符串

> ID：13293120
> 
> 赞同：0
> 
> 时间：2012-11-08T16:21:32.160
> 
> 标签：javascript, jquery, asp.net-mvc, json, cookies

所以我是 jQuery 和 JSON 的新手，但这很简单，而且它不起作用的事实让我感到沮丧。

我有一个 ASP.NET MVC 网站。我正在使用 AJAX（通过 jQuery）加载一些数据。一切都很好，直到那里。

我正在尝试使用 carhartl / jquery-cookie 将结果存储在 cookie 中。

问题是当我尝试将数据存储在 cookie 中时，数据并没有真正存储。我正在使用下面的代码：

```
 var jsonObj = JSON.stringify(result);

                jQuery.cookie("resultData", jsonObj, {
                    expires: 2,
                    path: "/",
                    json: true
                }); 
```

`jQuery.cookie("resultData")`返回空

我试过运行相同的代码，但我写的不是我的实际数据，而是“hello word”，效果很好。

谁能帮帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:40:34.730

cookie 的最大大小为 4 KB。检查 :) 尝试使用较小的 json，例如 { test : 1 } 看看是否有效

# javascript - 根据电子邮件中点击的链接预填充用户名

> ID：13293122
> 
> 赞同：0
> 
> 时间：2012-11-08T16:21:35.453
> 
> 标签：javascript, grails

我正在向用户发送电子邮件。在这封电子邮件中，他们必须单击一个链接，将他们带到我网站的登录页面：
www.testsite/login

我希望为他们预先填充用户名（电子邮件地址）。

我正在考虑简单地调整发送给他们的链接以包含它：
www.testsite /login?email=tester@test.com

然后我可以使用一些 javascript 来提取此信息并将其放置在表单字段中。

我希望人们对这种方法有所了解。
安全吗？有没有更好或更简单的方法来实现它？这种方法有什么问题吗？

顺便说一句，我的应用程序使用 grails 1.3.7。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:33:30.233

虽然在服务器端预先填充它可能会更好，但这里是对 Stack Overflow 上[另一个答案的修改：](https://stackoverflow.com/a/901144/1721527)

```
function getEmailFromUrl(){
   var regexS = "[\\?#&]email=([^&#]*)";
   var regex = new RegExp(regexS);
   var results = regex.exec(window.location.search);
   if(results == null) return "";
   else return decodeURIComponent(results[1].replace(/\+/g, " "));
} 
```

然后，使用该函数的结果来填充文本框：

```
document.getElementById('email_address').value=getEmailFromUrl(); 
```

希望这可以帮助。

# text - 在 Openlaszlo 的 SWF 运行时中旋转选项卡组件时文本消失

> ID：13293123
> 
> 赞同：1
> 
> 时间：2012-11-08T16:21:36.430
> 
> 标签：text, tabs, rotation, openlaszlo, lzx

为什么当我应用旋转选项卡时，选项卡的文本会消失？有什么方法可以将标签保持在其相对位置，使其与标签一起旋转？

代码：

```
<tabs name="dentes" height="200"  width="300" x="${this.width}" y="${this.height}" rotation="90">
    <tabpane name="coroa" text="Coroa" bgcolor="blue" width="100%" height="100%"> 
        <text>Nome:</text>
    </tabpane>
    <tabpane name="raiz" text="Raiz" bgcolor="red" width="100%" height="100%"> 
        <text>Nome:</text>
    </tabpane>
    <tabpane name="canal" text="Canal" bgcolor="green" width="100%" height="100%"> 
        <text>Nome:</text>
    </tabpane>
</tabs> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T23:33:56.763

这是使用客户端字体时 Flash/SWF 运行时的技术限制。它也在文档中提到：

> [OpenLaszlo 开发人员指南，第 21 章，文本视图](http://labs.openlaszlo.org/trunk-nightly/docs/developers/text.html)：特别是，您应该了解编译为 SWF 的应用程序中客户端字体和嵌入字体之间的区别。（编译为 DHTML 的应用程序不能使用嵌入字体）。因为它们的行为方式并不总是相同（例如，由于 Flash Player 的限制，客户端字体无法旋转或更改不透明度）

使用`<font>`标签将 TTF 字体嵌入到您的应用程序中。如果您为文本选择该字体，则旋转将按预期工作，例如：

```
<canvas width="100%" height="250">

    <!-- ATTENTION: Please download the KentucyFriedChickendFont.ttf file using
         this URL and put it in the same folder as this LZX file.
         http://svn.openlaszlo.org/openlaszlo/trunk/test/resources/ttf/KentuckyFriedChickenFont.ttf
    -->

    <font name="ChickenNoCFF" src="KentuckyFriedChickenFont.ttf" embedascff="false" />
    <font name="ChickenCFF" src="KentuckyFriedChickenFont.ttf" embedascff="true" />

    <inputtext x="100" 
               rotation="10"
               font="ChickenNoCFF" fontsize="32" 
               hasdirectionallayout="false"
               resize="true">
    Embedded font (no CFF)
    </inputtext>

    <!-- Text elements using @hasdirectionallayout="true" need to set
         @embedascff="true" for the SWF10+ runtimes -->
    <inputtext x="100" y="100"
               rotation="10" 
               font="ChickenCFF" fontsize="32" 
               hasdirectionallayout="true">
    Embedded font (embedded as CFF)
    </inputtext>

</canvas> 
```

您必须将 TTF 字体嵌入到您的应用程序中，然后您可以自由旋转任何标准文本组件。

如果`hasdirectionallayout`在 SWF 应用程序中使用文本组件的属性，则`embedascff="true"`在嵌入自定义字体时必须使用该属性。

这是此示例 SWF10 应用程序的屏幕截图，在 5.0（主干）上测试。

![在此处输入图像描述](../Images/d291454a6e27fbfd8e82085e009cf2b2.png)

# eclipse - Eclipse 中的错误....找不到标记库描述

> ID：13293128
> 
> 赞同：0
> 
> 时间：2012-11-08T16:21:46.113
> 
> 标签：eclipse, spring, tomcat, maven, spring-mvc

下面是我的代码

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

在 Eclipse 中，我收到以下错误，但如果我在 tomcat 中运行代码，它可以工作。为什么我在日食中得到这个日食

```
Description Resource    Path    Location    Type
Can not find the tag library descriptor for "http://java.sun.com/jsp/jstl/core" enrollment1.jsp /Enroll/src/main/webapp/WEB-INF/flows/start line 3  JSP Problem 
```

# ios - 如何动态扩展表格视图中的单元格？

> ID：13293131
> 
> 赞同：0
> 
> 时间：2012-11-08T16:21:49.830
> 
> 标签：ios, tableview

我只有一个`cell`带有按钮的`tableview`. `cell`高度定义在

```
tableView:tableView:heightForRowAtIndexPath: 
```

单元格高度为 40；

当我单击按钮时，如何将单元格高度更改为 80？谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:33:33.663

定义一个属性和`@synthesize`它：

```
@property (retain, nonatomic) NSIndexPath* selectedRowIndex; 
```

覆盖`didSelectRowAtIndexPath`和`heightForRowAtIndexPath`方法：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {

    if(selectedRowIndex && indexPath.row == selectedRowIndex.row) {

        //[_yourTableView deselectRowAtIndexPath:indexPath animated:YES]; If you only want the cell to get bigger
        selectedRowIndex = nil;

    }

    else {  self.selectedRowIndex = [indexPath retain];   }

    [tableView beginUpdates];
    [tableView endUpdates];
}

- (CGFloat) tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath{

if (tableView == _yourTableView) {

    if(selectedRowIndex && indexPath.row == selectedRowIndex.row){

        return 80;
    }

    // Cell isn't selected so return single height
    return 40;

}

else return 0;
} 
```

由于 beginUpdates 和 endUpdates 行，这应该为单元格高度设置动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:30:26.570

这是UITableView 委托[的文档](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITableViewDelegate_Protocol/Reference/Reference.html)。您需要设置一个委托，并设置函数为 - (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath。请记住返回值是 CGFloat，因此返回 80.0 而不是 80。希望这会有所帮助。阅读文档中有关其他委托函数的更多信息...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:23:52.213

当按下按钮时，您应该将变量设置为指示它已被按下的值，然后在 tableView 上调用 reloadData。这将使 tableView:heightForRowAtIndexPath 再次被调用。

在 tableView:heightForRowAtIndexPath 检查告诉你按钮是否被按下的变量，如果它被按下则返回 80

# c# - 固定 .NET 对象数组

> ID：13293133
> 
> 赞同：6
> 
> 时间：2012-11-08T16:21:59.950
> 
> 标签：c#, .net, mono, garbage-collection, interop

我想固定一组 .NET 对象（包括对象），以允许本机函数对对象进行一些处理。据我了解， GCHandle.Alloc() 不允许我这样做，因为这样的数组包含不可 blittable 的引用（并且对象也可能包含引用）。

有没有其他选择可以实现这一目标？我会接受非常 hack-y 的建议或需要 Mono 的建议。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T16:31:50.990

.NET 中的数组在连续内存中表示。这意味着在内存中，在元素 0 之后，元素 1 将*直接出现*在前一个元素之后，依此类推。

如果您使用 固定数组[`GCHandle.Alloc`](http://msdn.microsoft.com/en-us/library/1246yz8f.aspx)，那么这意味着*整个*元素列表也固定在内存中，您可以在非托管代码中处理它。

但是，正如您所提到的，只有当类型是 blittable 类型时才有意义（从技术上讲，这是不正确的，如果该类型能够被编组为非托管代码，尽管 blittable 之间有很多重叠P/Invoke/COM Interop 层自动处理的主要类型和内容）。

所以如果你有一个值类型的数组，你可以调用`GCHandle.Alloc`它，它会为你固定数组。但是，P/Invoke 层*已经*为您完成了这项工作，因此您不必担心这一点。

如果您的数组中充满了引用，那么将其编组为未管理的代码无论如何都没有意义；即使固定每个引用，非托管代码也不知道如何处理内存中的引用，因为类型系统不支持引用在内存中指向的 .NET 类型。

如果 .NET 中的类确实是原生结构的包装器/.NET 表示，那么最好在 .NET 中创建该结构的数组，将所有数据复制到其中，然后将其发送到原生代码.

或者，您可以在 C++/cli 中编写您的类，以方便在本机代码中访问 .NET 成员。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:37:26.087

你可以看看`Marshal.AllocHGlobal`和`Marshal.WriteIntPtr`。这是框架提供的使用非托管内存的官方方式。不确定它是否会有所帮助。

**编辑**

另请参阅[https://stackoverflow.com/a/878147/301525](https://stackoverflow.com/a/878147/301525)

# virtualbox - Windows 8 Hyper-V - 开发虚拟机 - VirtualBox 更好？

> ID：13293139
> 
> 赞同：0
> 
> 时间：2012-11-08T16:22:11.573
> 
> 标签：virtualbox, hyper-v

我想知道你如何使用 hyper-v 并在你的 VM 中工作。

我是开发人员，并且习惯于在我的开发环境中使用 VM。到目前为止，我一直在使用 VirtualBox。由于我已经迁移到 Windows 8，我想尝试 hyper-v，但体验不如我习惯的 VirtualBox

例如，我无法使用 hyper-v 控制台全屏工作。因此，当我在许多博客上阅读时，我使用远程桌面连接。但是 RDC 图形渲染速度很慢，并且在 Visual Studio 或 Blend 中工作并不是真正的乐趣。现在，我决定回到 VirtualBox。

你如何访问你的虚拟机？hyper-v 是否真的适用于这种虚拟机，还是更多地适用于您仅用于配置和/或管理任务的虚拟机之类的服务器？

非常感谢您的评论。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T12:02:30.523

in order to work in full screen with hyper-v console, I adjusted the screen resolution of the guest VM within the VM, by right click the desktop. and it works fun, hotkeys are similar to that of RDC. like ctrl+alt+delete become ctrl+alt+end

# google-apps-script - 文档 [my_spreadsheet_id] 丢失（可能已被删除？）

> ID：13293141
> 
> 赞同：5
> 
> 时间：2012-11-08T16:22:13.087
> 
> 标签：google-apps-script, google-sheets

偶尔（实际上它经常发生）我收到“文档 tIbdnvK2ZBY_7SQ2skESDvg 丢失（也许它已被删除？）”错误，这显然不是真的。任何人都可以对这个问题有所了解吗？也许有一些好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-17T23:28:02.907

我有一些在计时器上工作的脚本，偶尔会出现此错误，这似乎是在脚本尝试访问的工作表忙于计算或处理其他请求时发生（旧的 Google 工作表有时会脱机，这也导致了这种情况）。

新的 Google 表格发生的情况要少得多，如果可能的话，降低频率也很好——我移到表单提交触发器，然后每小时在顶部，以防第一个触发器失败。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-09T10:27:59.897

确保使用 SpreadsheetApp 而不是 DocumentApp 打开工作表。

# java - Sonar 中的单元测试执行时间非常长

> ID：13293142
> 
> 赞同：2
> 
> 时间：2012-11-08T16:22:16.153
> 
> 标签：java, unit-testing, maven, sonarqube, execution-time

我正在调查 Sonar 中的单元测试时间执行，从 maven 运行的测试和从 Sonar 运行的测试之间存在很大差异。

例如，对于单个 Java 测试类，我得到：

*   只是 Maven：1.5 秒
*   maven 与 cobertura：5.7 秒
*   声纳：16 秒

为什么maven和Sonar的区别这么大？Sonar 还制作了哪些其他仪器可以将执行时间增加 10 秒？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:31:14.773

据我所知，Sonar 使用 JaCoCo。我个人同意在声纳下测试需要花费大量时间这一事实，因此我们仅在每次 SVN 提交后运行常规测试时才将声纳作为夜间构建的一部分运行。

如果我的回答不能让你满意，我很抱歉...

# javascript - 用 20m x 20m 的盒子包裹经纬度点（Google Maps API V3）

> ID：13293154
> 
> 赞同：1
> 
> 时间：2012-11-08T16:22:39.313
> 
> 标签：javascript, google-maps, gps, mapping, coordinates

我很难弄清楚如何用 20 米乘 20 米的矩形来包裹纬度/经度点。

用例：

```
> Click on a marker on the Google map
< Infowindow opens
> Click a button called 'Wrap' on the Infowindow
< Automatically create a 20x20m box with the marker dead center 
```

我在地图上创建矩形（而不是正方形）没有问题我只需要知道如何计算 Lat/Lng 中正方形的边界。

在普通网格上，我将通过以下方式获得 NW 和 SE 点：

```
marker_nw_y = marker_y + 10 (meters)
marker_nw_x = marker_x - 10
marker_se_y = marker_y - 10
marker_se_x = marker_x + 10 
```

从那里我可以创建图形正方形等。但是使用 Lat/Lng 会变得更加复杂，因为改变两点之间的度数会因您所在的位置而异。

我怎么能这样做？操纵Haversine公式？我需要重新排列并解决其中一个坐标，而不是求解“距离”，但重新排列该公式很困难，我不确定我的结果是否正确。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:33:30.187

我相信[这个问题](https://stackoverflow.com/questions/5715791/google-maps-how-to-create-a-latlngbounds-rectangle-square-given-coords-of-a-c)包含的代码应该可以让你完成你正在寻找的东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:31:28.287

我会使用我移植到 Google Maps API v3 的 Mike Williams 的 eshapes 库来制作“半径”为 20*sqrt(2)/2 米的正方形。

使用我的[Mike Williams 的 eshapes 库端口的](http://econym.org.uk/gmap/eshapes.htm)[示例](http://www.geocodezip.com/v3_MW_example_eshapes.html)

点击监听器将是：

```
google.maps.event.addListener(map, "click", function(evt) {
  var marker = new google.maps.Marker({ position: evt.latLng, map: map});
  var square = google.maps.Polyline.RegularPoly(evt.latLng,20*Math.sqrt(2)/2,4,0,"#ff0000",1,1);
  square.setMap(map);
}); 
```

[工作示例](http://www.geocodezip.com/v3_MW_example_click2addMarkerSquare.html)

[基于 Kelvin Mackay 链接中的替代答案的更简单的工作示例](http://www.geocodezip.com/v3_MW_example_click2addMarkerSquareB.html)

# categories - magento 无法创建类别

> ID：13293155
> 
> 赞同：1
> 
> 时间：2012-11-08T16:22:44.037
> 
> 标签：categories, magento-1.7

最近我无法在我的 magento 商店中编辑或添加新类别。整个布局似乎被破坏了。我真的不知道怎么了。

我已经用谷歌搜索了一下，而且我已经找到了一些东西（似乎应该归咎于谷歌分析），但是[这个论坛帖子](http://www.magentocommerce.com/boards/viewthread/232603/)`.fastaccess`中的解决方案对我没有帮助，因为我在我的服务器上找不到文件。

也不能再上传产品图片了，因为“浏览文件”等按钮都不见了。

这是管理面板的管理类别页面的图像：[img http://img819.imageshack.us/img819/2687/unbenannt1lk.jpg](http://img819.imageshack.us/img819/2687/unbenannt1lk.jpg)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:25:50.863

好的，我不知道这个问题是从哪里来的。但我确实通过重新安装整个商店来解决它。

# javascript - Backbone & Slim PHP - Access-Control-Allow-Headers - 可以获取信息，不能发布吗？

> ID：13293157
> 
> 赞同：4
> 
> 时间：2012-11-08T16:22:49.760
> 
> 标签：javascript, backbone.js, header, cross-domain, slim

我正在使用 Backbone 和 Slim PHP 框架。我正在尝试将信息发布到我的 API，但是 Access-Control-Allow-Headers 不断给我带来问题......

我的控制台显示：

```
 OPTIONS http://api.barholla.com/user/auth 405 (Method Not Allowed) zepto.min.js:2
XMLHttpRequest cannot load http://api.barholla.com/user/auth. Request header field Content-Type is not allowed by Access-Control-Allow-Headers. 
```

我的标题是：

```
Request URL:http://api.barholla.com/user/auth
Request Method:OPTIONS
Status Code:405 Method Not Allowed
Request Headersview source
Accept:*/*
Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3
Accept-Encoding:gzip,deflate,sdch
Accept-Language:en-US,en;q=0.8
Access-Control-Request-Headers:origin, content-type, accept
Access-Control-Request-Method:POST
Connection:keep-alive
Host:api.barholla.com
Origin:http://localhost
Referer:http://localhost/barholla/app/
User-Agent:Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4
Response Headersview source
Access-Control-Allow-Origin:*
Allow:POST
Connection:close
Content-Type:application/json
Date:Thu, 08 Nov 2012 16:12:32 GMT
Server:Apache
Transfer-Encoding:chunked
X-Powered-By:Slim
X-Powered-By:PleskLin 
```

我纤细的 index.php 文件中的标题是：

```
$res = $app->response();
$res->header('Access-Control-Allow-Origin', '*');
$res->header("Access-Control-Allow-Methods: PUT, GET, POST, DELETE, OPTIONS"); 
```

要处理发布数据：

```
$app->post('/user/auth', function () use ($app) {
//code here
}); 
```

在我的javascript（我正在使用主干框架）中，我的代码是：

```
 App.userAuth = new App.UserAuthModel({
  username: $('#username').val(),
  password: hex_md5($('#password').val())
});

App.userAuth.save({}, {
  success: function(model, resp) {
    console.log(resp);
  },
  error: function(model, response) {
    console.log(response);
  }
}); 
```

任何帮助将不胜感激，我多年来一直坚持这一点！

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-23T13:42:14.780

我有一个类似的跨域`POST`问题（实际上除了 之外的所有标题`GET`）。以下解决了它：

```
if ($_SERVER['REQUEST_METHOD'] == 'OPTIONS') {
    if (isset($_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD']) && (   
       $_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD'] == 'POST' || 
       $_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD'] == 'DELETE' || 
       $_SERVER['HTTP_ACCESS_CONTROL_REQUEST_METHOD'] == 'PUT' )) {
             header('Access-Control-Allow-Origin: *');
             header("Access-Control-Allow-Credentials: true"); 
             header('Access-Control-Allow-Headers: X-Requested-With');
             header('Access-Control-Allow-Headers: Content-Type');
             header('Access-Control-Allow-Methods: POST, GET, OPTIONS, DELETE, PUT'); // http://stackoverflow.com/a/7605119/578667
             header('Access-Control-Max-Age: 86400'); 
      }
  exit;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-23T12:32:56.330

**在您的 javascript 客户端中，您正在向/user/auth**发出 OPTIONS 请求，但在您的 PHP 代码中，您仅通过此端点接受 POST 请求。

如果您希望您的 API 接受 OPTIONS 方法，您的代码中应该有这样的内容：

```
$app->options('/user/auth', function () use ($app) {
    //code here
}); 
```

或者，如果您想在同一个函数中处理多个 HTTP 方法：

```
$app->map('/user/auth', function () use ($app) {
    if ($app->request()->isOptions()) {
        //handle options method
    }

    else if ($app->request()->isPost()) {
        //handle post method
    }
})->via('POST', 'OPTIONS'); 
```

请记住，[根据 W3C](http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html)的 OPTIONS 方法：

> [...] 表示请求有关由 Request-URI 标识的请求/响应链上可用的通信选项的信息的请求。此方法允许客户端确定与资源相关联的选项和/或要求，或服务器的能力，而无需暗示资源操作或启动资源检索。

或者，只需更改客户端的代码以发出 POST 请求而不是 OPTIONS 请求。它比通过 OPTIONS 方法验证用户更容易也更有意义。在 zepto.js 中会是这样的：

```
$.post('/user/auth', { foo: 'bar' }, function(response){ 
    console.log(response);
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-09T00:33:15.550

您的 OPTIONS 请求应该是 200 返回一个空响应。然后浏览器将发送真正的 POST 请求。

也无需在`Access-Control-Allow-Methods`标题中添加 OPTIONS。

看来您正在使用身份验证，为什么不也添加[Access-Control-Allow-Credentials](https://developer.mozilla.org/en-US/docs/HTTP_access_control#Access-Control-Allow-Credentials)标头。

有关更多信息，请检查此[代码](https://github.com/nelmio/NelmioCorsBundle/blob/master/EventListener/CorsListener.php)，它可能会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-24T18:50:27.327

CorsSlim 帮助了我。[https://github.com/palanik/CorsSlim](https://github.com/palanik/CorsSlim)

```
<?php 
$app = new \Slim\Slim();
$corsOptions = array("origin" => "*",
"exposeHeaders" => array("Content-Type", "X-Requested-With", "X-authentication", "X-client"),
"allowMethods" => array('GET', 'POST', 'PUT', 'DELETE', 'OPTIONS'));
$cors = new \CorsSlim\CorsSlim($corsOptions);
$app->add($cors); 
```

# mysql - 在 MySql 中“汇总”聚合数据的最佳方法是什么？

> ID：13293160
> 
> 赞同：1
> 
> 时间：2012-11-08T16:22:58.857
> 
> 标签：mysql

我有一个大表，其中包含按多个维度细分的每小时统计数据。它现在足够大，我需要开始聚合数据以加快查询速度。该表看起来像：

```
customer INT
campaign INT
start_time TIMESTAMP
end_time TIMESTAMP
time_period ENUM(hour, day, week)
clicks INT 
```

例如，我在想我可以在活动为空的表中插入一行，点击值将是该客户和时间段的所有点击的总和。同样，我可以将时间段设置为“天”，这将是当天所有小时的总和。

我确信这是一件相当普遍的事情，所以我想知道在 MySql 中实现这一目标的最佳方法是什么？我假设一个 INSERT INTO 与一个 SELECT 语句相结合（就像一个物化视图） - 但是由于新数据不断被添加到这个表中，我如何避免重新计算我之前计算的聚合数据？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T12:15:06.353

我做了类似的事情，这是我处理的问题：

您可以`round(start_time/86400)*86400`在“分组依据”部分中使用来获取当天所有条目的摘要。（对于周几乎相同）

SQL 将如下所示：

```
insert into the_table 
( select 
   customer, 
   NULL, 
   round(start_time/86400)*86400, 
   round(start_time/86400)*86400 + 86400, 
   'day', 
   sum(clicks) 
  from the_table 
  where time_period = 'hour' and start_time between <A> and <B> 
  group by customer, round(start_time/86400)*86400 ) as tbl;

delete from the_table 
where  time_period = 'hour' and start_time between <A> and <B>; 
```

1.  如果您要将同一张表中的摘要插入到自身中 - 您将使用 temp （这意味着您将表中的部分数据复制到一边，而不是删除 - 对于每个事务）。所以你必须非常小心内部选择返回的数据的索引和大小。
2.  当您不断插入和删除行时 - 您迟早会遇到碎片问题。它会大大减慢你的速度。解决方案是使用分区 & 不时删除旧分区。或者您可以运行“优化表”语句，但它会阻止您工作相对较长的时间（可能是几分钟）。
3.  为避免重复数据混乱 - 您可能希望为每个时间聚合周期（hour_table、day_table、...）克隆表

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T17:49:31.770

如果您试图使表格更小，您将在创建摘要行后删除详细行，对吗？交易是你的朋友。开始一个，计算汇总，插入汇总，删除详细行，结束事务。

如果您碰巧为较旧的时间段添加了更多行（谁做的？？），您可以再次运行汇总 - 它会将您之前的汇总条目与您的额外数据组合成一个新的、更强大的汇总条目。

# java - JSplitPane 调整光标大小

> ID：13293166
> 
> 赞同：0
> 
> 时间：2012-11-08T16:23:12.320
> 
> 标签：java, swing, jsplitpane

我似乎无法通过调用来更改 JSplitPane 的调整大小光标有`setCursor(new Cursor(Cursor.DEFAULT_CURSOR));`没有人知道如何解决这个问题？我正在使用 Nimbus UI。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:16:48.547

调用组件`setCursor`将*只*为左右（或顶部和底部）组件`JSplitPane`设置光标。

 *要设置分隔线组件的光标，您可以使用：

```
Component divider = ((BasicSplitPaneUI)splitPane.getUI()).getDivider();
divider.setCursor(new Cursor(Cursor.DEFAULT_CURSOR)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-29T07:06:03.513

我们可以在 JSplitPane 的 addPropertyChangeListener() 侦听器中添加鼠标侦听器的代码，在加载 GUI 后，我们可以触发此事件以将鼠标侦听器绑定到分隔器。这是我的代码：

```
splitPanehor.addPropertyChangeListener(JSplitPane.DIVIDER_LOCATION_PROPERTY, (pce) -> {
        Component divider1 = ((JSplitPane) pce.getSource()).getComponent(2);
        divider1.addMouseListener(new MouseAdapter() {
            @Override
            public void mouseEntered(MouseEvent e) {
                ExomDataGUI.f.setCursor(new Cursor(Cursor.W_RESIZE_CURSOR));
            }

            @Override
            public void mouseExited(MouseEvent e) {
                ExomDataGUI.f.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
            }
        });
    }); 
```

我们可以通过以下方式显示 GUI 后触发此事件：

```
splitPanehor.firePropertyChange(JSplitPane.DIVIDER_LOCATION_PROPERTY, 219, 220); 
```*

# python - 将python日期时间转换为oracle数字

> ID：13293173
> 
> 赞同：1
> 
> 时间：2012-11-08T16:23:41.567
> 
> 标签：python

如何将 python 日期时间对象转换为 Oracle 数字格式。

```
datetime object:

datetime.datetime(2012, 9, 23, 0, 0)

need to be converted to number in Oracle,

20120923 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:25:51.993

```
>>> import datetime
>>> d = datetime.datetime(2012, 9, 23, 0, 0)
>>> d.strftime('%Y%m%d')
'20120923'
>>> int(d.strftime('%Y%m%d'))
20120923 
```

# javascript - 从 Django 直接输入数据用于 D3 图

> ID：13293174
> 
> 赞同：7
> 
> 时间：2012-11-08T16:23:42.150
> 
> 标签：javascript, django, json, d3.js

似乎所有 D3 示例图都将外部 .csv 或 .tsv 文件作为输入数据。有没有办法修改代码以从 Django 中的变量中获取数据。假设 {{ data }} 是 JSON 格式，您如何在[http://bl.ocks.org/3885304](http://bl.ocks.org/3885304)或[http://bl.ocks.org/3887051](http://bl.ocks.org/3887051)等图形中实现这一点？我试图避免总是写一个 .csv 文件。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T16:57:50.577

您始终可以创建一个视图，该视图将为 D3 使用的动态 csv 文件提供服务。这种方式还允许用户下载数据，以防他们需要原始数据而不是图表。

```
def foo(request, ...):
    model = get_object_or_404(Foo, ...)
    data = model.get_data() # should return csv formatted string
    return HttpResponse(data, content_type='text/csv') 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T17:02:02.583

代替异步加载数据（ajax 样式），您可以在传递给模板标签变量和`|safe`d.

查看基于[http://bl.ocks.org/3885304的工作示例](http://bl.ocks.org/3885304)[http://bl.ocks.org/4040034](http://bl.ocks.org/4040034)

您还应该查看有关 SO 的相关问题，关于这个主题有很多。

# linux - linux '500'' 上的 ftp 客户端：命令不理解。'

> ID：13293176
> 
> 赞同：1
> 
> 时间：2012-11-08T16:23:46.377
> 
> 标签：linux, ftp, berkeley-sockets

我尝试制作简单的 ftp 客户端来获取 bsd 套接字上的文件列表。这里是：

```
connectTo(int client_socket, 
              struct sockaddr_in* addr,
              char* ipv4Address,
              char* user,
              char* password,
              char* response) // buffer wchich store responses
{
    client_socket = socket(AF_INET, SOCK_STREAM, 0);
    if(socket < 0)
    {
        printf("Can not create socket");
        return 2;
    }

    addr->sin_family = AF_INET; // address family - internet socket
    addr->sin_port = htons(PORT_NUMBER);
    addr->sin_addr.s_addr = inet_addr(ipv4Address);
    if(connect(client_socket,(struct sockaddr*)addr,sizeof(*addr)) < 0)
    {
        printf("Can not connect!\n");
        return 3;
    }

    int size_read = recv(client_socket, response, BUF_SIZE, 0);

        printf("size_read = %d\n",size_read);
        response[size_read] = '\0'; // for not printing rubbish
        printf("%s\n",response);

    printf("sending username\n");
    char *username = strdup("USER trenkinan\r\n");
    send(client_socket,username,strlen(username)+1,0);

    size_read = recv(client_socket, response, BUF_SIZE, 0);

   //     printf("size_read = %d\n",size_read);
        response[size_read] = '\0'; // for not printing rubbish
        printf("%s",response);
    if(strstr(response,"331"))
    {
        //printf("sending password\n");
        char *passwd = strdup("PASS test\r\n");

       // printf("passwd string: %s",passwd);
        int sent = send(client_socket,passwd,strlen(passwd)+1,0);
        size_read = recv(client_socket, response, BUF_SIZE, 0);
        response[size_read] = '\0'; // for not printing rubbish
        printf("%s",response);

        //printf("sent bytes: %d\n", sent); 
    }

    return 0;
} 
```

我在我的工作站上使用来自 debian 存储库（ftpd）的 ftp 服务器。我尝试执行此代码，当我发送密码服务器时回答 500 ''：命令不理解。我使用wireshark查看会发生什么，我的程序中的所有包看起来都很好，我使用ftp命令（Linux上的轻量级ftp客户端）进行连接，它可以工作，但来自该客户端的包看起来与我自己的客户端相同。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T18:45:18.173

所以，我发现了一个错误：strlen(username) 而不是 strlen(username)+1。我希望它对某人有所帮助。

# java - Java：如何将堆栈的伪代码转换为数组

> ID：13293180
> 
> 赞同：1
> 
> 时间：2012-11-08T16:23:57.400
> 
> 标签：java, arrays, directed-graph

如何将以下伪代码转换为数组而不是堆栈。该算法旨在在给定特定输入的情况下构造一个有向图：

1.  在堆栈上从右到左扫描公式调用符号，直到顶部出现 2 个连续的节点符号。
2.  弹出这 2 个节点符号和堆栈上它们正下方的“*”。从第一个符号到第二个符号绘制一条边。
3.  将第一个符号压入堆栈。
4.  继续执行步骤 1-3，直到公式处理完毕。

这是一个示例输入和输出：

**输入：**

```
***ABCD 
```

**输出：**

```
*AB, *AC, *AD 
```

'*' 代表一条边

所有输入都将使用扫描仪完成。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:27:37.300

可以使用数组和“堆栈索引”的索引来对有限大小的堆栈进行建模。

从 开始堆栈索引`-1`。在 push 操作中，增加堆栈索引，并将值存储在数组的相应索引处。在弹出操作中，使用堆栈索引处的值，并在获取值后递减索引。要访问堆栈的顶部，请读取堆栈索引处的项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:34:52.527

您基本上必须使用 FIFO 属性对数组执行操作。

```
public ArrayStack( )
{
    theArray = new String[InitialSize];
    topOfStack = -1;
} 
```

每次将元素添加到数组 ( *push* ) 时，您都会`topOfStack++;`将元素插入到`"topOfStack"`数组的位置。通过这样做`topOfStack++`，您可以跟踪成为堆栈新顶部的数组位置。

当你这样做时，`pop`你必须检查数组是否不为空，返回元素`array[topOfStack]`并执行`topOfStack--;`。因为顶部现在是数组上的先前位置。

如果您的数组需要更多空间，因为堆栈已满`(topOfStack == InitialSize)`，您必须创建另一个具有更多空间的数组，例如：

```
private void doubleArray( )
{
        String [] newArray = new String[ theArray.length * 2 ];
        for( int i = 0; i < theArray.length; i++ )
            newArray[ i ] = theArray[ i ];
        theArray = newArray;
 } 
```

为了说明，这大致是您需要寻找的，自然还有更多细节需要研究。不过，请自己尝试一下，当您有疑问时，请寻找诸如此类的[资源](https://java2blog.com/implement-stack-using-array-in-java/)。

# javascript - Javascript正则表达式带回所有符号匹配？

> ID：13293183
> 
> 赞同：1
> 
> 时间：2012-11-08T16:24:02.850
> 
> 标签：javascript, regex

我需要一个 javascript 正则表达式对象，它可以带回字符串中任何匹配的符号，例如以下字符串：

```
input =    !"£$[]{}%^&*:@\~#';/.,<>\|¬` 
```

然后是以下代码：

```
input.match(regExObj,"g"); 
```

将返回一个匹配数组：

```
[[,!,",£,$,%,^,&,*,:,@,~,#,',;,/,.,,,<,>,\,|,¬,`,]] 
```

我试过以下没有运气。

```
match(/[U+0021-U+0027]/g); 
```

而且我不能使用以下内容，因为我需要不允许使用 ascii 字符，例如中文字符。

```
[^0-9a-zA-Z\s] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:34:39.077

```
var re = /[!"\[\]{}%^&*:@~#';/.<>\\|`]/g;
var matches = [];
var someString = "aejih!\"£$[]{}%^&*:@\~#';/.,<>\\|¬`oejtoj%";
while(match = re.exec(someString)) {
    matches.push(match[1]);
} 
```

得到

```
['!','"','[',']','{','}','%','^','&','*',':','@','~','#',''',';','/','.','<','>','\','|','`','%] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:37:38.847

关于什么

```
/[!"£$\[\]{}%^&*:@\\~#';\/.,<>|¬`]/g 
```

?

# c# - 如何先在实体框架代码中加载导航数据？

> ID：13293185
> 
> 赞同：0
> 
> 时间：2012-11-08T16:24:05.850
> 
> 标签：c#, asp.net-mvc-3, ef-code-first

我有以下情况：

[http://www.mediafire.com/view/?brjyqlj4rvjako9](http://www.mediafire.com/view/?brjyqlj4rvjako9)

当您在浏览器中阅读图片时，您可以看到我有一个三个表。中间一个是接线表。

除了始终具有 NULL 值的中间表（Bookings 表）中的字段 Room 外，一切正常： [http ://www.mediafire.com/view/?axz7ljskgcpl8cp](http://www.mediafire.com/view/?axz7ljskgcpl8cp)

所以，我看到它需要手动加载，然后才能对其进行读取操作。当我的项目在其上运行时，这是如何在 Entity Framework Code First 中完成的？

guest 和 Room 之间的关系是多对多的，Booking 是一个联结表。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:27:14.063

财产是虚拟的吗？：-

```
public class Booking
{
  ...

  public int RoomId { get; set; }
  public virtual Room Room { get; set; } // Needs to be virtual

  ...
} 
```

导航属性需要是虚拟的才能启用延迟加载。

如果这不是问题，那么我需要您发布您的三个实体（房间、客人、预订）的来源

# java - 有没有办法在 spring mvc3 的 xml 中设置 if/else 条件？

> ID：13293188
> 
> 赞同：6
> 
> 时间：2012-11-08T16:24:11.687
> 
> 标签：java, spring, spring-mvc, spring-3

我在我的 xml 中定义了一个属性文件：

```
<bean class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
    <property name="location" value="/WEB-INF/db.properties"></property>    
</bean> 
```

我在文件中有一个属性：

```
someprop = one 
```

**问题**

在我的 XML 中，我想在 bean 定义中添加/删除属性。例如：

```
<bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName" value="${jdbc.driverClassName}" />
    <property name="url" value="${jdbc.internal.url}" />
    <!--I want to add/remove the line below based on value in property file-->
    <property name="username" value="${jdbc.internal.username}" />
</bean> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T16:27:51.513

这可能使用 SpringEL 来实现。[在此处](http://static.springsource.org/spring/docs/3.0.x/reference/expressions.html)阅读**用于定义 bean 定义的表达式支持**部分。

如果这是为了处理多个环境，那么 Spring 3.1 提供了[bean 定义配置文件](http://blog.springsource.org/2011/02/14/spring-3-1-m1-introducing-profile/)和[环境](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/core/env/Environment.html)抽象。

# javascript - 使用 DOM 元素作为 javascript 映射的键

> ID：13293189
> 
> 赞同：9
> 
> 时间：2012-11-08T16:24:13.783
> 
> 标签：javascript

我正在尝试将一些“私有”数据与 DOM 元素相关联。我没有将该数据添加到 DOM 元素本身（我想避免更改 DOM 元素），而是有一个单独的数据对象，我想将其用作地图。

而不是：

```
document.GetElementById('someElementId').privateData = {}; 
```

我想要做

```
internalPrivateDataMap[document.GetElementById('someElementId')].privateData = {}; 
```

并不是所有的元素都有id字段，有些是动态创建的，所以不能用id作为key。

这对大多数元素都适用，但对于“a”元素，使用的键似乎是元素的 href，我认为是因为 DOM 为 a 元素定义了一个 toString() 函数。

这样做的结果是，如果我有两个具有相同 href 的“a”元素，它们将共享我不想要的 privateData。

我当前的解决方法是生成一个可以用作键的内部 uniqueID，但这需要我修改 DOM 元素，我试图避免这种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T16:30:13.247

正如您所注意到的，这不能可靠地工作，如果不给每个元素一个（生成的）ID 或至少为一个新的自定义元素字段分配一个唯一的 ID，我就无法让它工作；DOM 节点根本没有必要的属性来充当地图中的键。

所以你真的有这些解决方案：

*   为每个元素分配一个生成的 ID，除非它已经有一个
*   将唯一 ID 分配给新的私有字段。这样，您可以将每个 DOM 节点的内存影响保持在较小的范围内，并且仍然将您的私有数据保存在不同的位置。不要忘记，当 DOM 元素被删除时，您需要以某种方式清理私有数据。
*   使用 jQuery 之类的东西，它必须`element.data()`读取私有数据并将其放入 DOM 元素中
*   使用您自己的`element.privateData = {};`注意，您仍然需要清理保留对元素的引用的事件处理程序，否则您将遇到意外的内存泄漏。

# jquery-ui - jquery ui sortable - 单击滚动条会破坏它

> ID：13293197
> 
> 赞同：7
> 
> 时间：2012-11-08T16:24:58.107
> 
> 标签：jquery-ui, jquery-ui-sortable

滚动`.sortable()`容器内的 div 将在您释放滚动条时开始拖动 div

在小提琴中，有 3 个不同的 sortables，其中 1 个是滚动的

[http://jsfiddle.net/wnHWH/1/](http://jsfiddle.net/wnHWH/1/)

Bug：点击滚动条向上或向下拖动滚动内容，当你释放鼠标时，div开始拖动，这使得它跟随你的鼠标，没有办法不刷新页面就解开它。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-01T07:18:17.477

您可以`.mousemove`像这样使用 jquery 的事件：

```
$('#sortable div').mousemove(function(e) {
    width = $(this).width();
    limit = width - 20;
    if(e.offsetX < width && e.offsetX > limit)
        $('#sortable').sortable("disable");
    else
        $('#sortable').sortable("enable");
}); 
```

我已经创建了在这里工作的小提琴[http://jsfiddle.net/aanred/FNzEF/](http://jsfiddle.net/aanred/FNzEF/)。希望它能满足你的需要。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-01T07:19:07.063

`sortable()`可以像 do 一样为句柄指定选择器`draggable()`。然后只有匹配的元素才能获得点击事件。您可以像这样指定句柄选择器：

```
$('#sortable').sortable( {handle : '.handle'}); 
```

您已经拥有了其余部分所需的大部分内容。溢出元素上的内部 div 是一个合适的句柄，如下所示：

```
<div style="height: 200px;overflow:auto">
    <div class="handle" style="height: 300;">
        blah
        blah
        blah 
```

然后您需要恢复其他所有内容的可排序性。你会认为你可以只给这些 div`handle`类，但它正在寻找孩子，所以你需要像这样包装它们：

```
<div><div class="handle">asadf</div></div> 
```

[修改过的小提琴](http://jsfiddle.net/5ZE6Y/)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-01T22:53:34.783

补充 SubRed 的回答：

* * *

这非常适合我的需求。但是，我没有依赖滚动条的宽度为 20 像素（如上），而是使用了以下代码：

[如何获取浏览器的滚动条大小？](https://stackoverflow.com/questions/986937/how-can-i-get-the-browsers-scrollbar-sizes)

这允许代码在不同的设置上处理不同的滚动条宽度。为方便起见，将代码粘贴在这里：

```
function getScrollBarWidth () 
{
    var inner = document.createElement('p');
    inner.style.width = "100%";
    inner.style.height = "200px";

    var outer = document.createElement('div');
    outer.style.position = "absolute";
    outer.style.top = "0px";
    outer.style.left = "0px";
    outer.style.visibility = "hidden";
    outer.style.width = "200px";
    outer.style.height = "150px";
    outer.style.overflow = "hidden";
    outer.appendChild (inner);

    document.body.appendChild (outer);
    var w1 = inner.offsetWidth;
    outer.style.overflow = 'scroll';
    var w2 = inner.offsetWidth;
    if (w1 == w2) w2 = outer.clientWidth;

    document.body.removeChild (outer);

    return (w1 - w2);
} 
```

我还使用宽度值作为滚动条的高度，并修改了 SubRed 的代码以适应。这现在适用于一个或两个滚动条。

我还使用了以下代码：

[使用jQuery检测DIV中是否存在滚动条？](https://stackoverflow.com/questions/2647761/detecting-presence-of-a-scroll-bar-in-a-div-using-jquery)

确定任一滚动条的存在并相应地调整可排序代码的打开/关闭。

非常感谢。

# jquery - 无限滚动和列重新排序的 jQuery DataTables 问题

> ID：13293198
> 
> 赞同：0
> 
> 时间：2012-11-08T16:24:58.120
> 
> 标签：jquery, datatables

有没有人有一个如何实现 DataTables 的示例，该 DataTables 使用无限滚动（或滚动）和列重新排序，其中在初始化表时未加载所有数据？

发生的情况是我们的结果集太大了，我们通过 ajax 在客户端和服务器之间来回切换，以不断地用更多结果填充表。当您获得初始结果集时，对列进行重新排序，然后滚动以获取更多结果，当然这些列是按原始顺序排列的，因为这就是服务器将数据发回的方式。

您看到或使用了哪些实现？？？？例子会很棒。我还没有看到任何真正展示我的场景的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:49:45.213

您应该在 aoColumns 设置中使用 mData 属性。它允许您重新排序列并使用服务器数据填充表而不会出现任何问题。

例如：

初始化数据表：

```
 $('#example').dataTable( {
             "aoColumns":
              [ 
                {"mData": "column1" },
                {"mData": "column2" },
                {"mData": "column3" },  
              ],
             "bServerSide" : true,
             "sAjaxSource" : "url",
             "bScrollInfinite": true,
             "sScrollY": "200px",
             "sDom":'Rlfrtip',
 } ); 
```

来自服务器的 JSON：

```
{"aaData": [{"column1": 1, "column2": 2,"column3": 3}]} 
```

事实证明，您正在将数据映射到列中

# asp.net-mvc - ASP.NET MVC 可选字段被视为必需

> ID：13293207
> 
> 赞同：46
> 
> 时间：2012-11-08T16:25:13.273
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我有这个字段，由于某种原因，当我单击提交时，会收到一条验证消息，表明该字段是必需的。

```
[DisplayName("Total Budget:")]
public double Budget { get; set; }

@Html.EditorFor(model => model.account.Budget)
@Html.ValidationMessageFor(model => model.account.Budget)

public class Account
{
    [DisplayName("Total Budget:")]
    public double Budget { get; set; } //dropdown
} 
```

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2012-11-08T16:40:27.633

MVC 中内置的 DefaultModelBinder 将对值类型（如 int、DateTime、decimal 等）执行所需的数据类型验证。即使您没有使用 someting like 明确指定验证，也会发生这种情况`[Required]`。

为了使其可选，您必须将其定义为可为空的：

```
public double? Budget { get; set; } 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2017-04-21T14:49:46.703

您必须在 application_start (global.asax) 中添加以下行

```
DataAnnotationsModelValidatorProvider.AddImplicitRequiredAttributeForValueTypes = false; 
```

资料来源：[Unrequired 属性不断获取 data-val-required 属性](https://stackoverflow.com/questions/4700172/unrequired-property-keeps-getting-data-val-required-attribute)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-08T16:49:35.107

`double`是一个值类型。值类型总是包含一个值，即使您没有设置一个值。该值是其类型的默认值（在本例中`0.0`）。所有值类型都按照框架的要求进行处理。解决这个问题的唯一方法是创建一个自定义模型绑定器，但这不会阻止模型包含默认值（因为无法说它没有被输入）。

因此，即使您创建了自定义活页夹，当您处理模型时，您也无法判断是否有人输入`0`，或者这是否只是默认值。

因此，唯一真正的解决方案是将您的视图模型更改为使用可为空的类型，例如`Nullable<double>`（简写为`double?`）。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-08T16:32:54.123

您可能将预算从 a 更改`double` 为`double?`

您可能可以尝试将此属性添加到控制器

`BindExclude([Bind(Exclude="Budget")])`以及

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-19T08:54:10.323

使用**Nullable**或**?** 在属性名称之后。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-02-15T14:28:14.663

使用 [NotMapped] 注释，这将删除流程中所需的验证，您还可以使用自己的显示属性

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2022-02-03T16:03:26.183

我刚刚遇到一个项目迁移到 .Net 6.0 的问题，突然有些字段开始需要，即使它没有数据注释。

例如，在

```
public class LoginModel
{
    [BindProperty]
    public InputModel Input { get; set; }

    [TempData]
    public string ErrorMessage { get; set; }
    ...
} 
```

我收到错误消息：“ErrorMessage 字段是必需的”，这当然毫无意义。

该项目已`<Nullable>enable</Nullable>`启用功能，这似乎是造成这种情况的原因。

只需将属性重写为

```
 public string? ErrorMessage { get; set; } 
```

解决这个问题（注意问号）

# box-api - 可以与 API v2.0 共享 web_link 吗？

> ID：13293210
> 
> 赞同：0
> 
> 时间：2012-11-08T16:25:21.193
> 
> 标签：box-api

您可以在 Box 文件夹上创建 web_link 文件。web_link 可以通过 Box UI 共享，但我无法使用 API v2.0 进行共享：

两者都没有：
**PUT /files/{file id}** 和
**PUT /web_links/{file id}**
都 不起作用。与 web_link 的 id 一起使用时，两者都返回 HTTP 404。

这是支持还是我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T20:44:13.063

我认为 API 文档中的共享项目可能是您正在寻找的内容：

[http://developers.box.com/docs/#shared-items-get-a-shared-item](http://developers.box.com/docs/#shared-items-get-a-shared-item)

去引用：

> 检索到项目后，您可以针对实际资源（/files/{id} 或 /folders/{id} 发出 API 请求，只要共享链接和可选密码位于标头中。

# php - PHP 重构数组

> ID：13293217
> 
> 赞同：0
> 
> 时间：2012-11-08T16:25:31.647
> 
> 标签：php, arrays

我需要重建一个数组。这是原始数组：

```
array(8) {
      [0] => array(1)
      {
            ["L_TRANSACTIONID0"] => string(17) "62M97388AY676841D"
      }

      [1] => array(1)
      {
            ["L_TRANSACTIONID1"] => string(17) "9FF44950UY3240528"
      }

      [2] => array(1)
      {
            ["L_STATUS0"] => string(9) "Completed"
      }

      [3] => array(1)
      {
            ["L_STATUS1"] => string(9) "Completed"
      }
} 
```

我想把它重建成这样：

```
array(2) {
      [0] => array(2)
      {
            ["L_TRANSACTIONID0"] => string(17) "62M97388AY676841D"
            ["L_STATUS0"] => string(9) "Completed"
      }
      [1] => array(1)
      {
            ["L_TRANSACTIONID1"] => string(17) "9FF44950UY3240528"
            ["L_STATUS1"] => string(9) "Completed"
      }
} 
```

请注意，KEYS 都与数字表示匹配......这可能吗？

编辑：

这是我正在使用的代码：

```
 foreach($comparison as $key => $val) {
        $findme1 = 'L_TRANSACTID'.$i++;
        $findme2 = 'L_STATUS'.$c++;
        $arrDisable = array($findme1,$findme2);
        if( in_array($key, $arrDisable ) ) {
          unset( $comparison[ $key ][$val]);
        }
            if( in_array($key, $arrDisable) ) {
        unset( $comparison[ $key ][$val]);
        }
      } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:49:00.073

试试这个

```
$labels = array('L_TRANSACTIONID', 'L_STATUS');
$res = array();
foreach($arr as $val) {
  $key = str_replace($labels, '', key($val));
  $res[$key] = isset($res[$key]) ? array_merge($res[$key], $val) : $val;
}
print_r($res); 
```

[http://codepad.org/MwqTPqtA](http://codepad.org/MwqTPqtA)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:49:00.743

如果你确定向量包含对 L_TRANSACTIONIDn / L_STATUSn 键，也就是说，对于每个 transactionID，都有一个对应的状态，你可以做的是获取 id/status 记录的数量（应该等于长度的初始数组，除以 2），并通过增加当前元素计数组成结果键。

可能看起来像这样：

```
$numItems = sizeof($myInitialArray) / 2;
$newArray = array();

for($i = 0; $i < $numItems; $i++)
{
    $itemID = $i * 2; // since we're getting id/status pairs, we're using a step equal to 2

    $newArray[] = array(
        ("L_TRANSACTIONID" . $i) => $myInitialArray[$itemID], // this is the id value
        ("L_STATUS" . $i) => $myInitialArray[$itemID + 1] // this is the status for that id
    );
} 
```

希望这可以帮助。祝你有美好的一天！

# javascript - 来自引用者的 Javascript 解析 id

> ID：13293218
> 
> 赞同：0
> 
> 时间：2012-11-08T16:25:32.800
> 
> 标签：javascript, regex

我正在使用该`document.referrer`属性来获取以下 URL：

```
http://www.site.ru/profile/521590819123/friends
http://www.site.ru/profile/521590819123
http://www.site.ru/profile/521590819123/else 
```

我需要将此字符串中的 ID（例如，如上所示的 521590819123）获取到变量中。这是我到目前为止所拥有的：

```
<script type="text/javascript">
var ref = document.referrer;
var url = 'http://site.com/?id=';
if( ref.indexOf('profile') >= 0 ) 
{
  ref = ref.substr(ref.lastIndexOf('/') + 1);
  window.top.location.href = (url+ref);
}
else
 {
 window.top.location.href = (url + '22');
 }
</script> 
```

但这仅在引荐来源字符串格式为 时才有效`http://www.site.ru/profile/521590819123`。`/friends`上面带有或结尾的其他示例`/else`将不起作用。有人可以帮我修复代码以处理这些实例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:27:50.677

最简单的正则表达式：

```
var m, id;
m = /profile\/(\d+)/.exec(document.referrer);
if (m) {
    id = m[1];
} 
```

该正则表达式表示“找到文本`profile/`后跟数字的第一个位置并将数字放入捕获组中。” 然后代码检查是否存在匹配项（如果字符串根本没有匹配项），如果是，则从第一个捕获组中获取值（位于索引 1；索引 0 是整个匹配字符串） . 根据需要进行修改（例如，仅匹配字符串`www.site.ru/profile/`而不是`profile/`等）。

# android - ConnectivityManager.CONNECTIVITY_ACTION 在 API >= 14 中断开网络连接？

> ID：13293220
> 
> 赞同：8
> 
> 时间：2012-11-08T16:26:02.067
> 
> 标签：android, networking, connectivity

我需要获取断开设备连接的网络。

现在我使用：

```
NetworkInfo ni =intent.getParcelableExtra(ConnectivityManager.EXTRA_NETWORK_INFO); 
```

并检查：

```
ni.isConnected() 
```

如果这返回 false ni - 是设备断开连接的网络。

但在 API 14`ConnectivityManager.EXTRA_NETWORK_INFO`中已*弃用*。谷歌表示使用 getActiveNetworkInfo() 获取网络信息。但是 getActiveNetworkInfo() 总是返回设备现在连接的网络（`isConnected()`必须返回 true）！

如何在不使用 ConnectivityManager.EXTRA_NETWORK_INFO 的情况下获取设备断开连接的网络的网络信息？

Sertorio Noronha，当我使用 getActiveNetworkInfo() 时，我只能得到我现在连接的网络！但我需要获取与我断开连接的网络。

```
ConnectivityManager cm = (ConnectivityManager)
    context.getSystemService(Context.CONNECTIVITY_SERVICE);
NetworkInfo n1 = cm.getActiveNetworkInfo();
Log.d("tets", String.format("%s: %s", n1.getTypeName(), n1.isConnected())); 
```

当我从 WI-FI 断开连接并在日志中连接到 3G 时：

```
mobile: true
mobile: true 
```

当我从 3G 断开连接并在日志中连接到 WI-FI 时：

```
WIFI: true
WIFI: true
WIFI: true 
```

getActiveNetworkInfo 仅返回现在连接的网络，但不返回我断开连接的网络。

如果我在日志中使用不推荐使用的 intent.getParcelableExtra(ConnectivityManager.EXTRA_NETWORK_INFO) 我会看到：

当我从 WI-FI 断开连接并连接到 3G 时：

```
WIFI: false
mobile: true 
```

当我断开 3G 并连接到 WI-FI 时：

```
mobile: false
WIFI: true 
```

但我不想使用已弃用的 api。如何使用现代 api 获取我断开连接的网络？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-12-15T01:07:12.437

您可以使用以下

```
ConnectivityManager connectivityManager = (ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE);
int networkType = intent.getParcelableExtra(ConnectivityManager.EXTRA_NETWORK_TYPE);
boolean isWiFi = networkType == ConnectivityManager.TYPE_WIFI;
boolean isMobile = networkType == ConnectivityManager.TYPE_MOBILE;
NetworkInfo networkInfo = connectivityManager.getNetworkInfo(networkType);
boolean isConnected = networkInfo.isConnected();

if (isWiFi) {
    if (isConnected) {
        Log.i("APP_TAG", "Wi-Fi - CONNECTED");
    } else {
        Log.i("APP_TAG", "Wi-Fi - DISCONNECTED");
    }
} else if (isMobile) {
    if (isConnected) {
        Log.i("APP_TAG", "Mobile - CONNECTED");
    } else {
        Log.i("APP_TAG", "Mobile - DISCONNECTED");
    }
} else {
    if (isConnected) {
        Log.i("APP_TAG", networkInfo.getTypeName() + " - CONNECTED");
    } else {
        Log.i("APP_TAG", networkInfo.getTypeName() + " - DISCONNECTED");
    }
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-08-08T13:00:04.147

**工作的非弃用代码**

```
/**Receiver*/   

 public class NetworkStateReceiver extends BroadcastReceiver {

        /*
         * @see android.content.BroadcastReceiver#onReceive(android.content.Context,
         * android.content.Intent)
         */
        @Override
        public void onReceive(Context context, Intent intent) {
            ConnectivityManager connectivityManager = (ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE);
            int networkType = intent.getExtras().getInt(ConnectivityManager.EXTRA_NETWORK_TYPE);
            boolean isWiFi = networkType == ConnectivityManager.TYPE_WIFI;
            boolean isMobile = networkType == ConnectivityManager.TYPE_MOBILE;
            NetworkInfo networkInfo = connectivityManager.getNetworkInfo(networkType);
            boolean isConnected = networkInfo.isConnected();

            if (isWiFi) {
                if (isConnected) {
                    Log.i("APP_TAG", "Wi-Fi - CONNECTED");
                } else {
                    Log.i("APP_TAG", "Wi-Fi - DISCONNECTED");
                }
            } else if (isMobile) {
                if (isConnected) {
                    Log.i("APP_TAG", "Mobile - CONNECTED");
                } else {
                    Log.i("APP_TAG", "Mobile - DISCONNECTED");
                }
            } else {
                if (isConnected) {
                    Log.i("APP_TAG", networkInfo.getTypeName() + " - CONNECTED");
                } else {
                    Log.i("APP_TAG", networkInfo.getTypeName() + " - DISCONNECTED");
                }
            }
        }

    } 
```

并在清单中

```
<!-- Receiver registration in manifest -->
     <receiver android:name="com.xxx.yyy.NetworkStateReceiver" >
                <intent-filter>
                    <action android:name="android.net.conn.CONNECTIVITY_CHANGE" />
                </intent-filter>
            </receiver> 
```

和

```
<!-- Internet permission for network comunication -->
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /> 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-02-22T11:55:31.190

可以通过 Context 获取 NetworkInfo 的实例。

```
ConnectivityManager connectivityManager = ((ConnectivityManager)context.getSystemService(Context.CONNECTIVITY_SERVICE));
NetworkInfo currentNetworkInfo = connectivityManager.getActiveNetworkInfo();

if(currentNetworkInfo != null && currentNetworkInfo.isConnected()){
   // Your logic goes in here
} 
```

# c - 将数组元素初始化为 NULL

> ID：13293226
> 
> 赞同：9
> 
> 时间：2012-11-08T16:26:25.617
> 
> 标签：c, arrays, null

如何将数组的元素初始化为 NULL。例如，如果我有 char *array[10]; 我希望最后一个元素为 NULL，以便我可以将此数组传递给 execv

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-08T16:32:34.303

`char*`初始化所有`NULL`s的数组：

```
char* array[10] = { NULL }; /* The remaining elements are implicitly NULL. */ 
```

如果您想为 提供初始元素`execv()`：

```
char* array[10] = { "/usr/bin/ls", "-l" }; /* Again, remaining elements NULL. */ 
```

或者如果您希望从数组声明中省略维度：

```
char* array[] = { "/usr/bin/ls", "-l", NULL }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:30:24.697

`NULL`只不过是：`#define NULL (void*) 0 UL` 你`NULL`所说的是`nul`性格`'\0'`

查看`man execv`页面或其他执行进程..它实际上需要可变数量的参数

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:30:34.090

execv 接受一个数组`char *`，而不是一个数组`char`。

```
char *const parms[] = {"abc", "-a", "pqr", NULL}; 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-11-08T16:47:53.130

如果您的数组是 object,String,Char 如果您声明它将自动为 null

例如。

```
Oject [] myarray=new Object[10]; 
```

在数组的任何地方都为空

# php - Json 与 PHP mysql 和 Jquery

> ID：13293227
> 
> 赞同：0
> 
> 时间：2012-11-08T16:26:25.227
> 
> 标签：php, jquery, mysql, json

我有一个奇怪的问题..

当我尝试使用相应的数字 [0]、[1] 等访问我的 json 代码时。我只得到对象的第一个字符。

首先我的代码：

**test2.php**

```
if(isset($_POST['getCustomersArray'])){
$runQuery = mysql_query($Query) or
        die("SQL: $Query)<br />".mysql_error()); 
$numrows = mysql_num_rows($runQuery); 
$array = array(array());

for($i = 0;$i <= 2; $i++){
    $row = mysql_fetch_array($runQuery);
    $array[$i]['namn'] = $row['fornamn'];

}
    print json_encode($array);
} 
```

**脚本文件.js**

```
$.ajax({
    type:"POST",
    url: "test2.php",
    data: "getCustomersArray=true",
    datatype: "JSON",
    cache: false,
    success: function(json) {
            console.log(json[0]);
     }
}); 
```

结果（来自 console.log(json[0])）：

```
[ 
```

来自 console.log(json) 的结果：

```
[{"namn":"the first name"},{"namn":"The secound name"},{"namn":"the third name"}] 
```

我不确定为什么有方括号，但也许应该有？

我已经对这个问题感到困惑有一段时间了，我确信它有些愚蠢。请帮忙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T16:28:00.630

您在 AJAX 设置中有一个不正确的选项，

```
datatype: "json", 
```

它应该是：

```
dataType: "json", 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:30:21.233

```
datatype: "JSON", 
```

应该是

```
dataType: "json",  // json in lowercase and T has to be captalized 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:32:22.520

确保您有以下代码：

```
if(isset($_POST['getCustomersArray'])){
$runQuery = mysql_query($Query) or
    die("SQL: $Query)<br />".mysql_error()); 
$numrows = mysql_num_rows($runQuery); 
$array = array(array());

for($i = 0;$i <= 2; $i++){
    $row = mysql_fetch_array($runQuery);
    $array[$i]['namn'] = $row['fornamn'];
}
header("Content-Type: application/json; charset=UTF-8");
print json_encode($array);
} 
```

在这里，您需要将 content-type 设置为 application/json 并设置正确的字符集以避免任何跨浏览器问题。看看我网站上的以下教程，它应该涵盖所有这些内容，也许还有一些对您的代码的改进：[PHP jQuery Search Tutorial - using JSON object the proper way](http://www.revillwebdesign.com/php-jquery-search-tutorial/)

希望这可以帮助 ：）

# c# - 我应该在哪个时间和哪个上下文中调用 ThreadPool.SetMinThreads

> ID：13293229
> 
> 赞同：0
> 
> 时间：2012-11-08T16:26:34.623
> 
> 标签：c#, multithreading, asynchronous, delegates, threadpool

我有一个 ASP .NET MVC 2 - 应用程序，它调用 C#-DLL 的函数。

DLL 本身是多线程的。在最坏的情况下，它最多使用 200 个线程，这些线程不会运行很长时间。

我使用异步委托来生成线程。为了加快delegate的初始化，我提前计算好需要的线程数，交给ThreadPool：

```
ThreadPool.SetMinThreads(my_num_threads, ...); 
```

我只是想知道，如果我需要足够早地这样做，以便 ThreadPool 有足够的时间来创建线程？我是否必须考虑，*当*我设置 ThreadPool 的大小时，或者在我调用 SetMinThreads 后线程是否立即可用？

此外，如果我在我的 ASP .NET MVC 应用程序中设置 DLL 之外的大小（在我调用 DLL 之前），这个设置对 DLL 是否可用/可见？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:43:27.883

它们共享相同的应用程序域，因此在任何地方设置 ThreadPool 都会影响所有人。请注意，这也会影响 ASP.NET 框架，该框架将使用 ThreadPool 本身来执行所有自己的异步任务等。

考虑到这一点，如果您大致知道所需的最小线程数，您可以在应用程序启动时设置它以供以后使用。

但是，200 个线程似乎有些过多，将其放入上下文中，我的 Chrome 打开了大约 8 个选项卡，使用大约 35 个，我的 SQL Server 大约 50 个。你在做什么要求这么多？

还要意识到，由于必须服务的线程太多，最终您将达到性能下降的极限。微软在 MSDN 上这样说：

> 您可以使用 SetMinThreads 方法来增加最小线程数。但是，不必要地增加这些值可能会导致性能问题。如果同时启动太多任务，所有任务都可能看起来很慢。在大多数情况下，线程池使用自己的分配线程算法会表现得更好。将最小值减少到少于处理器数量也会损害性能。

# objective-c - 在 ios 中进行常量方法更新的有效方法

> ID：13293230
> 
> 赞同：0
> 
> 时间：2012-11-08T16:26:35.327
> 
> 标签：objective-c, ios

我有一个倒计时时钟，它出现在我的游戏中已经种植/开始建造的物体上方。

我正在使用麻雀框架。

现在我只是在 onEnterFrame 中运行一个方法，它检查每一帧（我实际上已经将它设置为每隔一帧，但无论如何）并更新倒计时时钟，但我想知道这是否只是一个缓慢和低效方法来做到这一点。

有没有办法更新我的计数器，而不会阻塞？

我应该补充一点，游戏屏幕上会有许多这样的倒计时时钟。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:42:40.237

另一种方法是使用 NSTimer，它以与您希望倒计时计数器减少的时间间隔相同的时间间隔滴答作响。每次滴答，您都会递减计数器并调用`setNeedsDisplay`.

如果您所做的只是检查倒计时的值是否已更改`onEnterFrame`，如果计数器已更改则重新绘制，那么您应该没问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-20T17:46:49.713

你运行的线程越少，它应该越流畅。计数器只是一个变量，它的开销非常小，你真的不应该担心。

渲染操作、加载图像、创建新对象、销毁对象和其他事情要消耗更多资源，因此增加计数器根本不应该是性能问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:33:46.987

过早的优化..你不知道它很慢你认为它可能是

反正我不追。你担心画画吗？如果是这样。所有视图仅执行 setNeedsDisplay 并在每次运行循环迭代时以批处理模式刷新

# android - 如何使用 Android sdk 3.0 从 Facebook 获得用户喜欢

> ID：13293233
> 
> 赞同：1
> 
> 时间：2012-11-08T16:26:41.037
> 
> 标签：android, facebook, facebook-android-sdk

我会使用 Android sdk 3.0 beta 从 facebook 获得用户喜欢。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T21:12:04.227

如果您有一个有效的会话，这是获得用户喜欢的代码

```
 Session session = Session.getActiveSession();
    Request.Callback callback = new Request.Callback() {

        @Override
        public void onCompleted(Response response) {
            // response should have the likes
            Toast.makeText(getApplicationContext(), response.toString(), Toast.LENGTH_LONG).show();
        }
    };
    Request request = new Request(session, "me/likes", null, HttpMethod.GET, callback);
    RequestAsyncTask task = new RequestAsyncTask(request);
    task.execute(); 
```

# css - 将eclipse内置的css链接到jsp并得到结果

> ID：13293235
> 
> 赞同：1
> 
> 时间：2012-11-08T16:26:48.537
> 
> 标签：css, eclipse, jsp

我正在尝试将我在 eclipse 中创建的 css 链接到 jsp，当我运行该项目时，我的浏览器中没有任何结果。我已经尝试了多种方式，通过把

```
<link rel="stylesheet" href="css/first.css" type="text/css">

<link rel="stylesheet" href="boe/WebContent/first.css" type="text/css">

<link rel="stylesheet" href="(my full path to the file)" type="text/css"> 
```

我已经尝试了很多，以至于我不记得我是如何让它不出错的。我得到这个

```
Tag (link) should be an empty-element tag. 
```

作为警告错误。

我找不到任何关于创建 css 并将其链接到 jsp 的步骤，因此它可以显示在我的浏览器中。

这是我的jsp和css代码。

jsp：

```
<?xml version="1.0" encoding="UTF-8" ?>
<%@ page import="java.util.*" language="java" contentType="text/html; charset=UTF-8"
pageEncoding="UTF-8"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <link rel="stylesheet" href="css/first.css" type="text/css">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>TestPage - Test1</title>
</head>

<body>
    <div id="page-container">Hello World</div>
    <%Date d = new Date(session.getLastAccessedTime());%>
    this page was last viewed <%= d.toString() %>
</body>
</html> 
```

CSS：

```
@CHARSET "UTF-8";
html, body {
    margin:0;
    padding:0;
}

#page-container {
    width: 760px;
    margin: auto;
    background: red;
} 
```

任何有关逐步查找的帮助，或者如果您有很好的解释，将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T16:28:00.020

> 标签（链接）应该是一个空元素标签。

此错误消息告诉您您的`link`标签需要一个右斜杠：

```
<link rel="stylesheet" href="css/first.css" type="text/css" /> <-- see the closing '/' 
```

如果这不能解决问题，我猜你的路径不太正确。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:59:11.910

我改变了

```
<head>
    <link rel="stylesheet" href="css/first.css" type="text/css"> 
```

到

```
<head>
    <style type="text/css">
    <%@include file="css/first.css" %></style>
</head> 
```

在我的“WebContent”文件下的 Eclipse 项目资源管理器中，我添加了一个名为“CSS”的文件夹并将 first.css 移动到该文件夹​​。

尽管从我读到的内容来看，这是一种非常低效的链接方式，因为它导入了整个 CSS。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-03T20:08:40.623

在上面的代码中，将'css'替换为css文件的完整路径，你可以通过右键单击.css文件->属性->位置复制并粘贴上面的代码来代替'css'来获取完整路径

# ruby-on-rails - 网站的 Rails 控制器和路由配置

> ID：13293241
> 
> 赞同：1
> 
> 时间：2012-11-08T16:27:09.350
> 
> 标签：ruby-on-rails, ruby-on-rails-3, rails-routing

我在 RAILS 中有一个应用程序，它由一组 API、一个基本网站和一个管理仪表板组成。对于 API 路由，我没有问题，因为它们属于模型和控制器，并且符合 RAILS RESTful 模式（每个模型一个控制器，每个 HTTP 方法一个方法）。

我不习惯为网站编写路由和控制器。主网站在 / 所以默认路由是`root :to => "home#index"`，我有网站页面的路由，看起来像

```
 get "home/index"
  get "map/index"
  get "api/index"
  get "cgu/index"
  get "legal/index" 
```

我认为这不好，因为我每个视图都有一个控制器，我需要为每个视图定义一个 get。现在对于仪表板，我尝试了一种不同的方法。它在/dashboard，默认路由是 `match "dashboard" => "dashboard#index"`，这里有几个页面作为例子

```
 get "dashboard/index"
  get "dashboard/users"
  get "dashboard/users_stats"
  get "dashboard/routes"
  get "dashboard/routes_stats"
  get "dashboard/charts"
  get "dashboard/financial" 
```

所以对于仪表板，我有一个巨大的dashboard_controller，它包含`def method`每个仪表板页面。IE：

```
#dashboard/users
  def users
     @users = User.all

     respond_to do |format|
      format.html {render :layout => 'dashboard'}
    end
  end 
```

仪表板的控制器位于 /controller 但对于视图和资产，我已将其放入 /folder/dashboard/

这里有2个问题：

*   建立主页和仪表板的最佳方式是什么？我应该每页有一个控制器还是一个全局控制器，每页有一个方法？（我觉得很方便，代码更少）。
*   我应该如何组织我的路线以避免为每个页面设置一个获取“某物/某物”？或者我为每个页面定义了一个路由是正常的 RAILS 吗？我还算新。

编辑：为了澄清，仪表板是围绕现有应用程序构建的，其 API 遵循 RESTFul Rails 模式：

```
 resources :users
  resources :routes 
```

但是仪表板不绑定到任何现有资源，它只对这些资源进行统计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:41:13.810

如果您有自定义控制器操作名称，那么是的，您需要定义每个路由。如果您使用 Restful 路由，那么您可以轻松地将它们定义为

```
resources :users 
```

它将自动为操作创建路由：索引、显示、编辑、更新、创建和销毁。

这可能会有所帮助： http: [//guides.rubyonrails.org/routing.html](http://guides.rubyonrails.org/routing.html)

对于您的仪表板，它可能汇集了大量资源，因此它们可能是自定义方法。我建议专注于通过单个资源构建您的应用程序。然后，一旦你定义了它们，构建你的仪表板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:41:31.940

如果您还没有，请查看[本指南；](http://guides.rubyonrails.org/routing.html)

我认为您还没有接受 Rails 的 MVC 概念。

例如，假设您有“用户”。app 目录下应该有 users_controller.rb、users.rb（模型）、/views/users（视图）。

users_controller 包含索引、显示、创建等默认操作和您的自定义操作，如统计信息

user.rb 包含实例/静态/辅助方法

/views/users/ 包含与控制器中的操作相对应的模板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:47:14.410

我同意其他人在这里所说的一切。您绝对应该尝试更加 RESTful 并创建更多这样的路由：

```
 resources :users 
```

但是，通常有一个不是 RESTful 的控制器（通常称为 pages 或 static），它为诸如`Privacy`、`About Us`等页面提供服务。对于这些路由，我通常这样做：

```
['api', 'privacy', 'us'].each do |p|
  get p, :controller => 'pages', :action => p
 end 
```

# mysql - 我的 SQL JOIN 查询返回没有结果

> ID：13293249
> 
> 赞同：2
> 
> 时间：2012-11-08T16:27:29.510
> 
> 标签：mysql, join

```
SELECT 'nmc_cd.CDID','nmc_cd.CDTitle', 'nmc_cd.CDYear','nmc_cd.pubID','nmc_cd.catID','nmc_cd.CDPrice','nmc_category.catDesc'
From nmc_cd
JOIN nmc_category
ON 'nmc_cd.catID'='nmc_category.catID'
ORDER BY CDTitle 
```

我一直在将此查询放入 mySQL 以尝试从 ncm_CD 和 nmc_category 获取结果的表，但它一直在重新调整没有价值？另外，如果我使用右连接或左连接，它会返回列名（例如 nmc_cd.CDJD）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:31:38.057

尝试删除引号，以便引用列本身 - 使用引号，您正在使用字符串而不是列。

```
SELECT nmc_cd.CDID, nmc_cd.CDTitle,  nmc_cd.CDYear, nmc_cd.pubID, nmc_cd.catID, nmc_cd.CDPrice, nmc_category.catDesc
From nmc_cd
JOIN nmc_category
ON nmc_cd.catID = nmc_category.catID
ORDER BY CDTitle 
```

此外，正如@Randy 提到的，确保您确实拥有符合条件的数据:)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:32:29.160

我不知道为什么你在所有东西周围都有单引号，单引号被认为是一个静态字符串值，所以它不会从列中返回数据：

```
SELECT nmc_cd.CDID,
    nmc_cd.CDTitle, 
    nmc_cd.CDYear,
    nmc_cd.pubID,
    nmc_cd.catID,
    nmc_cd.CDPrice,
    nmc_category.catDesc
From nmc_cd
INNER JOIN nmc_category
    ON nmc_cd.catID=nmc_category.catID
ORDER BY CDTitle 
```

但是对于`INNER JOIN`您正在使用的，您必须确保您的值与两个表中的数据匹配，如果您不这样做，则不会返回任何数据。如果您在两个表中都没有数据，那么您将需要使用 a`LEFT JOIN`或`RIGHT JOIN`：

```
SELECT nmc_cd.CDID,
    nmc_cd.CDTitle, 
    nmc_cd.CDYear,
    nmc_cd.pubID,
    nmc_cd.catID,
    nmc_cd.CDPrice,
    nmc_category.catDesc
From nmc_cd
LEFT JOIN nmc_category
    ON nmc_cd.catID=nmc_category.catID
ORDER BY CDTitle 
```

MySQL 在列和表名周围使用反引号而不是单引号，如果您应用它们，那么您的查询将如下所示：

```
SELECT `nmc_cd`.`CDID`,
    `nmc_cd`.`CDTitle`, 
    `nmc_cd`.`CDYear`,
    `nmc_cd`.`pubID`,
    `nmc_cd`.`catID`,
    `nmc_cd`.`CDPrice`,
    `nmc_category`.`catDesc`
From `nmc_cd`
JOIN `nmc_category`
    ON `nmc_cd`.`catID`=`nmc_category`.`catID`
ORDER BY `CDTitle` 
```

# android - 试图重新查询一个已经关闭的游标——怎么了？

> ID：13293250
> 
> 赞同：0
> 
> 时间：2012-11-08T16:27:30.893
> 
> 标签：android, cursor

我的应用程序抛出错误：

```
11-08 17:19:40.800: E/AndroidRuntime(18592): java.lang.RuntimeException: Unable to resume activity {app.piotrek.learning/app.piotrek.learning.AddNewQuestion}: java.lang.IllegalStateException: trying to requery an already closed cursor  android.database.sqlite.SQLiteCursor@40f7f8a8
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2567)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2595)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1183)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.os.Handler.dispatchMessage(Handler.java:99)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.os.Looper.loop(Looper.java:137)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.app.ActivityThread.main(ActivityThread.java:4575)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at java.lang.reflect.Method.invokeNative(Native Method)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at java.lang.reflect.Method.invoke(Method.java:511)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:789)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:556)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at dalvik.system.NativeStart.main(Native Method)
11-08 17:19:40.800: E/AndroidRuntime(18592): Caused by: java.lang.IllegalStateException: trying to requery an already closed cursor  android.database.sqlite.SQLiteCursor@40f7f8a8
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.app.Activity.performRestart(Activity.java:4508)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.app.Activity.performResume(Activity.java:4531)
11-08 17:19:40.800: E/AndroidRuntime(18592):    at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2557)
11-08 17:19:40.800: E/AndroidRuntime(18592):    ... 10 more 
```

当我去另一个活动并点击“后退按钮”时，似乎出现了错误。我已经发现问题出在此处：

```
@Override
protected void onResume(){
    super.onResume();

    db = new Database(getApplicationContext());

    db.open();

    fillSpinner(db.getAllEntriesSubjects(), spinnerSubject, DatabaseData.KEY_NAME);
    //long data = spinnerSubject.getSelectedItemId();
    //Log.v("ADDNEWQUESTION", "Wybrano: " + data);
    //fillSpinner(db.getAllEntriesTitles(), spinnerTitles);
    db.close();
}

public void fillSpinner(Cursor cs, Spinner spinner, String dane){
    startManagingCursor(cs);

    SimpleCursorAdapter mAdapter = new SimpleCursorAdapter(this, android.R.layout.simple_spinner_item, cs, new String[] {dane}, new int[] {android.R.id.text1});
    mAdapter.setDropDownViewResource(android.R.layout.simple_spinner_item);
    spinner.setAdapter(mAdapter);
} 
```

AFAIK，我没有关闭任何光标。那怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:36:20.120

`db.close();`从方法中删除`onResume`并将其添加到`onPause()`方法中。希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-02T12:38:36.083

尝试这个..

公共无效 onBackPressed() {

```
 Intent i = new Intent(getApplicationContext(), AddNewQuestion.class);
    startActivity(i);
    finish();
    super.onStop();

} 
```

# node.js - 在猫鼬中按日期和时间排序？

> ID：13293254
> 
> 赞同：10
> 
> 时间：2012-11-08T16:27:40.393
> 
> 标签：node.js, mongoose

有人可以告诉我如何根据日期和时间对一组项目进行排序。目前，我正在使用

```
image.find({reviewed:true }, null, {sort:{"submittedDate":-1}}, 
           function (err, images) {}) 
```

我的日期模式是：

```
submittedDate: Thu, 08 Nov 2012 15:42:47 GMT 
```

但它只对日期进行排序。我想先按时间排序，然后按日期排序。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-09T12:31:35.240

排序的方法是：

```
image.find({reviewed:true})
     .sort({'submittedDate': 'desc'})
     .exec(function(err, images) {
         //do stuff with images
     }); 
```

[一些文档](http://mongoosejs.com/docs/api.html#query_Query-sort)。

从 v3.8.1 开始，语法为：

```
image.find({reviewed:true})
     .sort('submittedDate', -1)
     .execFind(function(err, images) {

 }); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2021-01-21T11:16:24.833

根据版本 5.11.13。

1.  添加`{ timestamps: true }`您的架构。

    `new Schema({}, { timestamps: true });`

2.  然后将“排序”添加到您的查询中。

    `Model.find({}).sort({ createdAt: 'desc'}).exec();`

    `Model.find({}).sort({ createdAt: 'asc'}).exec();`

谢谢。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-01-28T13:05:54.923

```
 User.findById(req.user._id).populate("todos").then((rUser)=>{ 
      res.render("dashboard", { user: req.user, todos: rUser.todos, });
    }).catch((e)=>{
        res.send(e);
    }); 
```

# node.js - 请求完成时nodejs表示关闭服务器

> ID：13293257
> 
> 赞同：1
> 
> 时间：2012-11-08T16:27:47.230
> 
> 标签：node.js, express

我正在为我的模块编写一个测试脚本，我需要能够在我的请求完成后关闭我的服务器。以下代码有效，但我可以看到 app.close() 已从 express 3 中删除。现在最好的方法是什么？

```
var testCase = require('nodeunit').testCase;
var request = require('request');
var express = require('express');

var app = express.createServer();
var srv = app.listen();
....

request({
    method: 'POST',
    json: true,
    body: { id: 'second request'},
    url: 'http://' + target
  }, function(err, res, body) {

    console.info("closing server");
    app.close();
    test.done();
  });
}); 
```

谢谢，李

ps test.done() 必须在关闭服务器后调用，否则测试会失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:06:44.230

Express 应用程序曾经继承自`http.Server`，但现在不再这样做了，这就是该`close`方法的来源。相反，请调用`close()`您的`srv`实例。你可能通常会看到这段代码写成：

```
var app = express.createServer();
var srv = require('http').createServer(app);
srv.listen(port); 
```

根据以下[文档](http://expressjs.com/api.html#app.listen)`app.listen()`：

> 绑定并监听给定主机和端口上的连接，此方法与节点的`http.Server#listen()`.

# python - 从命令行创建项目

> ID：13293261
> 
> 赞同：1
> 
> 时间：2012-11-08T16:27:50.147
> 
> 标签：python, django, deployment, sentry

[Sentry](https://www.getsentry.com/)从客户端应用程序中捕获日志记录和错误。

我知道在 Sentry 中创建项目的唯一方法是在 Web 应用程序界面中手动提交表单。

我正在寻找一种从命令行以任何方式（选项、配置文件）将项目创建到 Sentry 中的方法？

这对于部署脚本非常有价值。否则不可能实现自动化。

刚刚在谷歌搜索时发现了这个讨论但没有答案：

[https://groups.google.com/d/topic/getsentry/pWglAEHaPUk/discussion](https://groups.google.com/d/topic/getsentry/pWglAEHaPUk/discussion)

任何想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T20:50:59.180

这是[一个 django 项目](https://github.com/getsentry/sentry/blob/master/src/sentry/models.py#L107)，当然你可以：

```
from sentry.models import Project
project = Project(...)
...
project.save() 
```

**编辑：**您可以[编写自定义管理命令](https://docs.djangoproject.com/en/dev/howto/custom-management-commands/)来获取命令行上的功能

**由问题作者编辑**：是的，它确实是一个 django 项目，所以就像一个 django 项目一样，我在以下三个步骤中自动化了我的部署：

1.  启动 Sentry，创建用户、团队和项目，并从管理 Web 界面调整设置
2.  像处理任何 django 项目一样运行 dumpdata（sentry 将隐式调用 manage.py）：

    `sentry --config=sentry.conf.py dumpdata --indent=2 auth > auth_data.json`

    `sentry --config=sentry.conf.py dumpdata --indent=2 sentry > sentry_data.json`

3.  逐步部署：

    `sentry --config=sentry.conf.py syncdb --noinput`

    `sentry --config=sentry.conf.py migrate`

    `sentry --config=sentry.conf.py loaddata auth_data.json`

    `sentry --config=sentry.conf.py loaddata sentry_data.json`

效果很好。希望这对其他人有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-09-10T15:12:52.210

正如[Sentry 的文档](https://docs.getsentry.com/on-premise/server/faq/)中官方所述：

```
# Bootstrap the Sentry environment
from sentry.utils.runner import configure
configure()

# Do something crazy
from sentry.models import Team, Project, User

user = User()
user.username = 'admin'
user.email = 'admin@localhost'
user.is_superuser = True
user.set_password('admin')
user.save()

team = Team()
team.name = 'Sentry'
team.owner = user
team.save()

project = Project()
project.team = team
project.owner = user
project.name = 'Default'
project.save()

key = ProjectKey.objects.filter(project=project)[0]
print 'SENTRY_DSN = "%s"' % (key.get_dsn(),) 
```

[https://docs.getsentry.com/on-premise/server/faq/](https://docs.getsentry.com/on-premise/server/faq/)

# asp.net - 按钮添加事件点击事件

> ID：13293263
> 
> 赞同：0
> 
> 时间：2012-11-08T16:27:50.403
> 
> 标签：asp.net, vb.net

我的页面上的 formview 控件中有一个按钮。

因为该按钮包含在表单视图中，所以我的代码隐藏看不到它。

所以我这样做了：

```
Dim btnSave As Button = CType(fvCourse.FindControl("btnSave"), Button) 
```

然后我添加了一个这样的事件处理程序：

```
AddHandler btnSave.Click, AddressOf btnSave_Click

Private Sub btnSave_Click(ByVal sender As System.Object, ByVal e As System.EventArgs)
    Response.write("hey!")
End Sub 
```

问题是，我认为它不起作用，因为我从来没有看到“嘿！” 在我的页面上。

我错过了什么吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:42:22.023

我不知道错过了什么，但我认为你可以用更简单的方式来做，因为你使用的是 VB。首先给你的按钮一个命令名称和命令参数：

```
<asp:Button ID="Button1" runat="server" onclick="Button1_Click"
CommandArgument="1" CommandName="yes" /> 
```

这些可以是任何东西 - 通常您使用命令名称来确定用户单击了哪个按钮，并使用命令参数来显示记录 ID。

在您的代码隐藏中，将宏附加到 FormView 的**ItemCommand**事件（当其中发生某些事情时触发）：

```
 Protected Sub FormView1_ItemCommand(sender As Object, e As System.Web.UI.WebControls.FormViewCommandEventArgs) Handles FormView1.ItemCommand

    Select Case e.CommandName.ToLower
        Case "yes"

            'test
            Label2.Text = "You chose " & e.CommandArgument.ToString

    End Select
End Sub Protected Sub FormView1_ItemCommand(sender As Object, e As System.Web.UI.WebControls.FormViewCommandEventArgs) Handles FormView1.ItemCommand

    Select Case e.CommandName.ToLower
        Case "yes"

            'test
            Label2.Text = "You chose " & e.CommandArgument.ToString

    End Select
End Sub 
```

而在 VB 中，这就是您需要做的所有事情！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:34:04.320

您应该将[`ItemCreated`](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.formview.itemcreated.aspx)事件`FormView`用于此类事情。如果`Button`是在`ItemTemplate`你需要检查的`FormViewMode.ReadOnly`，`EditItemTemplate`你需要使用`Edit`：

```
Private Sub fvCourse_ItemCreated(ByVal sender As Object, ByVal e As System.EventArgs) Handles fvCourse.ItemCreated
    Select Case fvCourse.CurrentMode
        Case FormViewMode.Edit
            Dim btnSave As Button = DirectCast(fvCourse.FindControl("btnSave"), Button)
            AddHandler btnSave.Click, AddressOf btnSave_Click
    End Select
End Sub 
```

# python - 在 n 时间后，我将如何停止 while 循环？

> ID：13293269
> 
> 赞同：87
> 
> 时间：2012-11-08T16:28:02.517
> 
> 标签：python, python-2.7

如果它没有达到我想要的效果，我将如何在 5 分钟后停止 while 循环。

```
while true:
    test = 0
    if test == 5:
        break
    test = test - 1 
```

这段代码让我陷入无限循环。

* * *

## 回答 #1

> 赞同：143
> 
> 时间：2012-11-08T16:30:41.740

尝试以下操作：

```
import time
timeout = time.time() + 60*5   # 5 minutes from now
while True:
    test = 0
    if test == 5 or time.time() > timeout:
        break
    test = test - 1 
```

您可能还想在这里添加一个短暂的睡眠，这样这个循环就不会占用 CPU（例如`time.sleep(1)`在循环体的开头或结尾）。

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2014-06-19T11:41:58.560

在这种情况下，您不需要使用`while True:`循环。有一种更简单的方法可以直接使用时间条件：

```
import time

# timeout variable can be omitted, if you use specific value in the while condition
timeout = 300   # [seconds]

timeout_start = time.time()

while time.time() < timeout_start + timeout:
    test = 0
    if test == 5:
        break
    test -= 1 
```

* * *

## 回答 #3

> 赞同：40
> 
> 时间：2012-11-08T16:32:47.503

试试这个模块： http: [//pypi.python.org/pypi/interruptingcow/](http://pypi.python.org/pypi/interruptingcow/)

```
from interruptingcow import timeout
try:
    with timeout(60*5, exception=RuntimeError):
        while True:
            test = 0
            if test == 5:
                break
            test = test - 1
except RuntimeError:
    pass 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2017-06-23T14:12:48.700

Petr Krampl 的回答在我看来是最好的，但是关于循环的性质以及如何优化系统的使用，还需要多说一些。遇到此线程的初学者可能会被问题和现有答案中的逻辑和算法错误进一步混淆。

首先，让我们看看您的代码在最初编写时做了什么：

```
while True:
    test = 0
    if test == 5:
        break
    test = test - 1 
```

如果您`while True`在循环上下文中说，通常您的意图是永远留在循环中。如果这不是您的意图，您应该考虑循环结构的其他选项。Petr Krampl 向您展示了一种非常合理的方法来处理这个问题，这对于可能阅读您代码的其他人来说更加清楚。此外，如果您需要重新访问代码以添加或修复某些内容，几个月后您会更加清楚。编写良好的代码是您文档的一部分。通常有多种方法可以做事，但这并不能使所有方法在所有情况下都同样有效。`while true`是一个很好的例子，尤其是在这种情况下。

接下来，我们将查看原始代码中的算法错误。您在循环中做的第一件事就是将 0 分配给`test`. 接下来要做的是检查 的值是否`test`为 5，除非您有多个线程修改相同的内存位置，否则永远不会出现这种情况。线程不在本次讨论的范围内，但值得注意的是，代码在技术上可以工作，但即使有多个线程，也会丢失很多东西，例如信号量。无论如何，无论哨兵强制执行无限循环，您都将永远处于此循环中。

`test = test - 1`无论它做什么，该语句都是无用的，因为该变量在循环的下一次迭代开始时被重置。即使您将其更改为`test = 5`，循环仍然是无限的，因为每次都会重置该值。如果将初始化语句移到循环之外，那么它至少有机会退出。你可能想要的是这样的：

```
test = 0
while True:
    test = test - 1
    if test == 5:
        break 
```

循环中语句的顺序取决于程序的逻辑。不过，它可以按任意顺序工作，这是重点。

下一个问题是从 0 开始，不断减 1，然后与正数比较的潜在和可能的逻辑错误。是的，在某些情况下，只要您了解其中的含义，这实际上可能就是您打算做的事情，但这很可能不是您想要做的。当您到达整数范围的“底部”（如 C 和其他各种语言）时，较新版本的 python 不会环绕。它会让您继续减 1，直到您填满系统上的可用内存或至少分配给您的进程的内存。查看以下脚本和结果：

```
test = 0

while True:
    test  -= 1

    if test % 100 == 0:
        print "Test = %d" % test

    if test == 5:
        print "Test = 5"
        break 
```

产生这个：

```
Test = -100
Test = -200
Test = -300
Test = -400
...
Test = -21559000
Test = -21559100
Test = -21559200
Test = -21559300
... 
```

的值`test`永远不会是 5，所以这个循环永远不会退出。

为了补充 Petr Krampl 的答案，除了在一段时间后退出循环之外，这里的版本可能更接近您的实际意图：

```
import time

test = 0
timeout = 300   # [seconds]

timeout_start = time.time()

while time.time() < timeout_start + timeout:
    if test == 5:
        break
    test -= 1 
```

它仍然不会基于 的值而中断`test`，但这是一个具有合理初始条件的完全有效的循环。进一步的边界检查可以帮助您避免无缘无故地执行很长的循环，例如在循环进入时检查 test 的值是否小于 5，这会立即中断循环。

* * *

应该提到另一件事，没有其他答案已经解决。有时当你像这样循环时，你可能不想在整个分配的时间内消耗 CPU。例如，假设您正在检查每秒变化的事物的值。如果您不引入某种延迟，您将使用分配给您的进程的每个可用 CPU 周期。如果有必要，那很好，但是好的设计将允许许多程序在您的系统上并行运行，而不会增加可用资源的负担。一个简单的 sleep 语句将释放分配给您的进程的绝大多数 CPU 周期，以便其他程序可以工作。

下面的例子不是很有用，但它确实演示了这个概念。假设您想每秒打印一些内容。一种方法是这样的：

```
import time

tCurrent = time.time()

while True:
    if time.time() >= tCurrent + 1:
        print "Time = %d" % time.time()
        tCurrent = time.time() 
```

输出将是这样的：

```
Time = 1498226796
Time = 1498226797
Time = 1498226798
Time = 1498226799 
```

进程 CPU 使用率如下所示：

[![在此处输入图像描述](../Images/d864f44c62dd563d12c3429b2c4bb424.png)](https://i.stack.imgur.com/GogQ8.png)

对于基本上不做任何工作来说，这是一个巨大的 CPU 使用量。这段代码对系统的其余部分要好得多：

```
import time

tCurrent = time.time()

while True:
    time.sleep(0.25) # sleep for 250 milliseconds
    if time.time() >= tCurrent + 1:
        print "Time = %d" % time.time()
        tCurrent = time.time() 
```

输出是一样的：

```
Time = 1498226796
Time = 1498226797
Time = 1498226798
Time = 1498226799 
```

而且CPU使用率要低得多：

[![在此处输入图像描述](../Images/2d084bbfe2c47ea37b297c1ead8e1884.png)](https://i.stack.imgur.com/30m4m.png)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2012-11-08T16:31:11.680

```
import time

abort_after = 5 * 60
start = time.time()

while True:
  delta = time.time() - start
  if delta >= abort_after:
    break 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2017-07-28T21:19:04.537

我想分享我正在使用的一个：

```
import time
# provide a waiting-time list:
lst = [1,2,7,4,5,6,4,3]
# set the timeout limit
timeLimit = 4

for i in lst:
    timeCheck = time.time()
    while True:
        time.sleep(i)
        if time.time() <= timeCheck + timeLimit:
            print ([i,'looks ok'])
            break
        else:
            print ([i,'too long'])
            break 
```

然后你会得到：

```
[1, 'looks ok']
[2, 'looks ok']
[7, 'too long']
[4, 'looks ok']
[5, 'too long']
[6, 'too long']
[4, 'looks ok']
[3, 'looks ok'] 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-03-16T14:17:11.343

我读过这篇文章，但我只是想问一些事情，像我这样写的东西根本就不会写吗？我已经完成了 5,10 和 20 秒的测试。它的时间并不完全准确，但它们确实接近实际值。

```
import time

begin_time=0
while begin_time<5:

    begin_time+=1
    time.sleep(1.0)
print("The Work is Done") 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2022-02-05T14:29:19.640

我不是python专家，但我写了一个小函数来检查超时和刹车while循环

```
# compare now and given times older than delta
def is_time_older_than(time, delta):
    print(dt.utcnow() - time,delta)
    if (dt.utcnow() - time) > delta: 
        return True
    return False
startTime = dt.utcnow()
while True:
           print("waiting")
           if (is_time_older_than(startTime, timedelta(seconds=5)) == True):
                break 
```

您可以在执行前记录时间而不是发送到函数作为开始时间，增量值以秒为单位（或 60*1 一分钟）它将比较差异并返回 False 或 True 就是这样

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2022-02-11T17:01:06.683

**尝试以下操作：**

```
from datetime import datetime, timedelta

end_time = datetime.now() + timedelta(minutes=5)
while True:
    current_time = datetime.now()
    if current_time == end_time:
        break 
```

# bash - 在 Bash 中解析数据

> ID：13293272
> 
> 赞同：3
> 
> 时间：2012-11-08T16:28:09.257
> 
> 标签：bash, parsing

我有一个里面有很多垃圾的文件。所有这些都在一条线上。但是经常有这样的情况：

```
"var":"value" 
```

前后是不同的字符...

我想要做的是，只提取上述格式并将它们放在一行中。有什么想法可以在 Shell 脚本中实现吗？

最好的问候，亚历克斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T16:34:21.447

我相信

```
grep -o '"[^"]*":"[^"]*"' yourFile.txt > yourOutput.txt 
```

会做的伎俩：

```
> echo 'xxx "a":"b" yyy"x":"y"' | grep -o '"[^"]*":"[^"]*"'
"a":"b"
"x":"y" 
```

# jquery - jQuery-Validation-Engine - 自定义 funcCall 验证在值为空时导致错误

> ID：13293273
> 
> 赞同：2
> 
> 时间：2012-11-08T16:28:08.540
> 
> 标签：jquery, forms, validation, jquery-validation-engine

我有一个自定义验证函数来使用 jQuery-Validation-Engine 验证两个密码字段是否匹配：

```
<input type="password" class="validate[required,funcCall[checkPassordMatch],maxSize[25]]"... 
```

但是，如果未填充该字段，并且提交了表单，我会收到以下异常：

```
Uncaught TypeError: Cannot read property 'checkPassordMatch' of undefined 
```

有什么方法我只能在输入已填充或“必需”首先通过时才运行此验证？

作为参考，我的功能如下：

```
 // Validate the passwords match
function checkPassordMatch(field, rules, i, options){
    console.log(field + ' : ' + rules + ' : ' + i  + ' : ' + options )

    if (field.val() != jQuery("#inputPassword").val()) {
        return options.allrules.passwordMatch.alertText;
    }
} 
```

欣赏任何想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:32:59.757

不需要此自定义功能。我可以用：

```
validate[required,equals[password]] 
```

# jsfiddle - 将资源上传到 jsFiddle

> ID：13293275
> 
> 赞同：1
> 
> 时间：2012-11-08T16:28:13.390
> 
> 标签：jsfiddle

我刚刚发现了 jsFiddle，看起来很棒。问题是他们的文档非常基础。我将我的代码（HTML/JS/Css）放在正确的文本框中，结果似乎还可以，显然只有没有图像存在。

有没有办法将它们上传到我的 jsFiddle 帐户，还是我必须将它们上传到其他地方？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T17:18:44.880

您确实需要将资源上传到网络上的某个地方。

# google-maps-api-3 - getTile() 在本机地图类型中不返回任何内容，如何取回功能？

> ID：13293276
> 
> 赞同：0
> 
> 时间：2012-11-08T16:28:16.620
> 
> 标签：google-maps-api-3

在 maps 3 api 的早期版本中，我构建了一些“叠加”功能来使用自定义地图类型执行以下操作 - 其想法是，与始终在 google 的图块上提供我的图块相反，我只会显示 google 的图块需要时——即当图块在我的缩放和边界之外或当我的图块具有透明度时（主要是因为我的叠加层的外部边界可能跟随河流等）。它是这样工作的：

1.  当`getTile`我的类型被调用时，确定我是否应该为给定级别提供给定的瓷砖。

2.  如果我应该提供瓷砖，请确定瓷砖是否有任何透明度 - 如果有，请使用默认地图获取瓷砖

    ```
    map.mapTypes.get(google.maps.MapTypeId.ROADMAP).getTile(coord, zoom, ownerDocument)` 
    ```

    然后将我的图像附加到返回的 div 的顶部并显示它。否则，就为我的瓷砖服务。

3.  如果我不应该服务，瓷砖，就回来

    ```
    map.mapTypes.get(google.maps.MapTypeId.ROADMAP).getTile(coord, zoom, ownerDocument) 
    ```

因此，似乎由于一些盗窃行为，getTile 不再返回谷歌原生地图类型的任何内容，这带来了两个问题：

1.  我有什么方法可以告诉地图它应该将我的图块显示为覆盖图而不是完整的图块，而不必让我的整个地图成为覆盖图？

2.  有没有办法告诉地图它应该显示自己的图块而不是我的图块？

* * *

覆盖地图作为一种解决方案工作，但性能不是很好，有很多重绘，因为谷歌首先绘制自己的瓷砖，然后用我的覆盖它们。由于我 99% 的图块是完全覆盖的（没有透明度），这似乎是对带宽的相当浪费。如果能够从 getTile 传回元数据，指示是否应该绘制默认的谷歌图块（或在其他回调中指示该事实），那就太好了。我以前看起来像是一个优雅的解决方案并且表现良好 - 覆盖方法绝对是退一步。Marcelo，我不确定我的标题是否反映了我的问题……您是否阅读了该问题的完整文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T07:47:54.533

您无法访问基本地图类型。由于持续滥用，它已被 Google 故意禁用。

在某些时候，这被报告为一个错误，但您可以阅读地图团队成员在[**此线程**](http://code.google.com/p/gmaps-api-issues/issues/detail?id=3635#c2)上的评论：

从该页面引用：

> 不幸的是，我们发现越来越多的开发人员使用默认地图类型来访问和使用 google.maps.Map 对象之外的 Google 地图图块，这是服务条款不允许的。因此，我们被迫将内部地图类型移动到私有注册表。如果您有特定原因需要访问符合服务条款的地图类型，请使用您的用例更新此问题，如果有足够的需求，我们将研究是否可以为您的要求提供可支持的解决方案.

作者：Thor Mitchell（Google 员工 - 地图团队）

# c# - 如何通过 USB 调试模式使用 android 设备 sd 卡保存/检索数据？

> ID：13293277
> 
> 赞同：0
> 
> 时间：2012-11-08T16:28:25.773
> 
> 标签：c#, android

有没有办法通过 USB 调试模式从 android 设备保存/检索文件。这意味着即使设备通过连接到 PC 的 USB 电缆充电，我也希望我的应用程序能够连接。

我认为 ADB（Android 调试桥）能够呈现此服务，但是我不太确定它是否有效，如果可以，我如何将它与 C# 一起使用以简单地从 SD 卡保存和获取一些文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:31:59.673

亚行确实可以为您做到这一点。

从设备中提取文件：

```
adb pull /mnt/sdcard/somefile.txt 
```

将文件推送到设备

```
adb push somefile.txt /mnt/sdcard/ 
```

（注意：显然你需要`somefile.txt`用你自己的路径和/或文件名替换。）

我对 C# 不是很熟悉，但你肯定可以用它制作一些可以与 ADB 二进制文件交互的东西来完成这些任务。

[有关 ADB 功能/语法的更完整列表，请参见此处](http://developer.android.com/tools/help/adb.html)

# tsql - 没有从转换返回的日期

> ID：13293278
> 
> 赞同：0
> 
> 时间：2012-11-08T16:28:26.533
> 
> 标签：tsql

这里有构成日期的 3 个字段的值，但我得到空值。所以我的语法有问题。我也只想要日期（没有时间）`

```
 case when isdate(CAST(someTable.DATE_MM as varchar(8)) + CAST(someTable.DATE_DD as varchar(8)) + CAST (someTable.DATE_YY as varchar(8))) = 1
        then convert(date,CAST(someTable.DATE_MM as varchar(8)) + '/' + CAST(someTable.DATE_DD as varchar(8)) + '/' + CAST (someTable.DATE_YY as varchar(8))) else null end as BirthDate, 
```

那在我的选择语句中，它给了我 NULL 的数据。这 3 个字段的值是：

```
DATE_MM: 3
DATE_DD: 4
DATE_YY: 1959 
```

这 3 个字段后面的数据类型是 int

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:32:36.490

您将 3 个 varchar 值合并在一起，它将返回一个 varchar，因此您的 isdate 将返回 false 并且您的案例将从 else 子句返回 null 值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:51:08.907

你可以用它来`dateadd`代替。

```
select dateadd(day, DATE_DD - 1, 
               dateadd(month, DATE_MM - 1, 
                       dateadd(year,  DATE_YY - 1900, 0))) as BirthDate
from someTable 
```

# google-tv - 在回调函数轮播谷歌电视中添加更多项目

> ID：13293282
> 
> 赞同：2
> 
> 时间：2012-11-08T16:28:36.397
> 
> 标签：google-tv

我在 google tv jquery ui 中使用 carousel.js 来创建视频幻灯片。我希望当我单击“下一步”（右箭头）时，项目将通过 Ajax 加载并附加到幻灯片。这意味着我的应用程序可以运行得更快。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T18:42:16.510

您可能希望将缩略图列表加载到轮播中，这样就不会创建空的轮播。如果您真的想在每次单击 next 时使用 ajax 加载视频 URL，则必须修改以下函数并将 AJAX 合并到其中。

/** * 选择下一个轮播项目。* @param {boolean} 如果项目应该在选择后激活，则为 true。*/ gtv.jq.Carousel.prototype.selectNext = function(activate) { var carousel = this;

if (this.selectedItem) { var newItem = this.selectedItem .parent() .nextAll('.carousel-item-div') .eq(0) .find('.carousel-item'); if (newItem && newItem.length == 0) { newItem = this.container.find('.carousel-item').first(); } this.selectItem(this.selectedItem, newItem, function() { car​​ousel.updateSelectionClasses(newItem); if (activate) { car​​ousel.activateItem(newItem); } }); } };

请注意，每次单击下一个按钮时使用 AJAX 并加载视频 URL 并没有多大意义——您会进行太多的 ajax 调用。最好使用 AJAX 动态加载整个类别的视频 URL 以填充轮播。

例如，最初的 Google TV 模板没有使用 AJAX 加载视频源，但是这个增强的 Google TV 模板添加了 AJAX 加载：

[https://developers.google.com/tv/web/docs/ajax_gtv_templates_tutorial](https://developers.google.com/tv/web/docs/ajax_gtv_templates_tutorial)

看看它是如何在那里完成的。

# c - 监控设备中的嵌套选择

> ID：13293285
> 
> 赞同：0
> 
> 时间：2012-11-08T16:28:51.283
> 
> 标签：c, linux

我正在监视新插入的设备。我正在使用 libudev.h 来做我想做的事。

```
while(1){

        ret = select(fd+1, &fds, NULL, NULL, NULL);

        if(ret<0){

            perror("select() failed. Exitting...");
            exit(EXIT_FAILURE);
        }

        if (FD_ISSET(fd, &fds)) {

            dev = udev_monitor_receive_device(mon);

            if (dev) {
                printf("New device attached\n");
                printf("   Node: %s\n", udev_device_get_devnode(dev));
                printf("   Action: %s\n", udev_device_get_action(dev));

                udev_device_unref(dev);

                   if(strcmp("/dev/ttyUSB0", udev_device_get_devnode(dev))==0){

                     fd1 = open("/dev/ttyUSB0");
                           if (fd<0) exit(0);
                     FD_SET(fd1, &fds);

                     select(fd1+1, &fds, NULL, NULL, NULL);
                      if (FD_ISSET(fd1))         
 //Read from the serial device and echo back to serial device when data is received

 }

                   }

            }

            else {

                printf("No Device from receive_device(). An error occured.\n");

            }                   
        } 
```

现在例如一个设备被插入并且节点是 /dev/ttyUSB0 我需要打开它并监视它的文件描述符。坐下来等待数据可用。

```
 fd1 = open("/dev/ttyUSB0");
                               if (fd<0) exit(0);
                         FD_SET(fd1, &fds);

                         select(fd1+1, &fds, NULL, NULL, NULL);
                          if (FD_ISSET(fd1)){

//Read from the serial device and echo back to serial device when data is received
} 
```

在监控 /dev/ttyUSB0 的 fd 时，第一个选择必须继续对设备进行监控。我应该如何同时进行 2 个选择？.. 谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:37:45.437

你不需要同时做两个`select`s 。重点`select`是您可以同时等待多个文件描述符上的事件。您将两个文件描述符添加到您的`FD_SET`, 调用`select`中，然后检查使用`FD_ISSET`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:38:31.550

正如我所想，您应该使用一种锁定机制。

在一个进程中连续探测正在不断探测设备的设备。

然后当它刚刚向其他进程发出信号并修改锁定变量时

# google-app-engine - datastore.put() 不添加到数据库？

> ID：13293288
> 
> 赞同：0
> 
> 时间：2012-11-08T16:28:59.747
> 
> 标签：google-app-engine, google-cloud-datastore

我有一个 serverlet，它可以接受来自休息服务或来自 jsp 表单帖子的请求，它们都将调用内部方法 (internalAddPodcast()) 以将实体添加到数据存储区。

当我从 jsp 页面点击 internalAddPodcast() 时，它工作正常，我可以通过在添加后立即查询实体来看到该实体已成功添加。但是，当我从其他方法 addPodcast() 执行此操作时， datastore.put() 似乎并没有真正添加到数据存储中，因为我尝试在 put() 之后立即检索它并且什么都没有返回。往下看这个类的底部，我在其中添加了注释“//当从 REST 服务添加时，此查询为空:(”这是我希望得到一些结果的地方，尤其是我刚刚放入的实体数据存储。

```
 package com.aol.sharepodder;

import java.io.IOException;
import java.util.Date;
import java.util.List;
import java.util.logging.Logger;

import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.ws.rs.Consumes;
import javax.ws.rs.DefaultValue;
import javax.ws.rs.FormParam;
import javax.ws.rs.POST;
import javax.ws.rs.Path;
import javax.ws.rs.Produces;

import com.google.appengine.api.datastore.DatastoreService;
import com.google.appengine.api.datastore.DatastoreServiceFactory;
import com.google.appengine.api.datastore.Entity;
import com.google.appengine.api.datastore.FetchOptions;
import com.google.appengine.api.datastore.KeyFactory;
import com.google.appengine.api.datastore.PreparedQuery;
import com.google.appengine.api.datastore.Query;
import com.google.appengine.api.users.User;
import com.google.appengine.api.users.UserService;
import com.google.appengine.api.users.UserServiceFactory;

@Path("/add/podcast/")
public class AddPodcastServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;
    private static final Logger log = Logger.getLogger(AddPodcastServlet.class
            .getName());

    public void doPost(HttpServletRequest req, HttpServletResponse resp)
            throws IOException {

        String email = req.getParameter("email");
        String collectionName = req.getParameter("collectionName");
        String podcast_url = req.getParameter("podcast_url");
        String podcast_description = req.getParameter("podcast_description");
        String podcast_title = req.getParameter("podcast_title");

        log.info("--post adding " + collectionName);

        internalAddPodcast(email, collectionName, podcast_url,
                podcast_description, podcast_title);

        resp.sendRedirect("/collection_details.jsp?collectionName="
                + collectionName + "&email=" + email);
    }

    @POST
    @Produces("text/plain")
    @Consumes("application/x-www-form-urlencoded")
    public String addPodcast(
            @DefaultValue("barrand@gmail.com") @FormParam("email") String email,
            @DefaultValue("default") @FormParam("collectionName") String collectionName,
            @DefaultValue("") @FormParam("podcast_url") String podcast_url,
            @DefaultValue("") @FormParam("podcast_description") String podcast_description,
            @DefaultValue("") @FormParam("podcast_title") String podcast_title) {
        try {
            internalAddPodcast(email, collectionName, podcast_url,
                    podcast_description, podcast_title);
            if (podcast_url == "") {
                return "No url supplied";
            }
            return "true";
        } catch (Exception e) {
            return e.getMessage();
        }
    }

    private void internalAddPodcast(String email, String collectionName,
            String podcast_url, String podcast_description, String podcast_title) {
        log.info("--INTERNAL ADD ");
        log.info("--email " + email);
        log.info("--collectionName " + collectionName);
        log.info("--podcast_url " + podcast_url);
        log.info("--podcast_description " + podcast_description);
        log.info("--podcast_title " + podcast_title);

        UserService userService = UserServiceFactory.getUserService();
        User user = userService.getCurrentUser();

        Entity podcast = new Entity("Podcast");
        podcast.setProperty("collectionName", collectionName);
        podcast.setProperty("user", user);
        podcast.setProperty("email", email);
        Date date = new Date();
        podcast.setProperty("date", date);
        podcast.setProperty("podcast_title", podcast_title);
        podcast.setProperty("podcast_description", podcast_description);
        podcast.setProperty("podcast_url", podcast_url);

        DatastoreService datastore = DatastoreServiceFactory
                .getDatastoreService();
        datastore.put(podcast);

        //try to log the podcast that I just got done adding to the datastore
        Query query = new Query("Podcast");
        PreparedQuery pq = datastore.prepare(query);

            //THIS QUERY IS EMPTY WHEN ADDED FROM THE REST SERVICE :(
        for (Entity p : pq.asIterable()) {
            log.info("_loop " + " - " + KeyFactory.keyToString(p.getKey())
                    + " -- " + p.getProperty("podcast_title") + " - "
                    + p.getProperty("podcast_url"));
        }
    }
} 
```

任何想法我做错了什么，以及为什么我试图从 rest 方法添加的实体没有被添加到数据存储中。

我知道，在这两种情况下，（来自 jsp 帖子或其余服务）当我到达 internalAddPodcast() 时，所有方法参数都正确输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:49:20.510

High Replication 数据存储最终是一致的。这意味着大多数查询不能保证反映刚刚对数据存储所做的更改 - 包括返回您刚刚插入的记录。[在此处](https://developers.google.com/appengine/docs/python/datastore/structuring_for_strong_consistency)阅读有关此内容以及如何进行强一致性查询的更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:50:13.213

啊哈！我找到了。我没有记录被抛出的异常。基本上我试图存储一个超过 500 个字符的字符串属性，它抛出了一个我需要注意的异常:) 所以它永远不会到达 datastore.put()

# c++ - QML 或 C++（级联）中的选项样式（Dropdown、RadioGroup 等）

> ID：13293289
> 
> 赞同：0
> 
> 时间：2012-11-08T16:29:07.453
> 
> 标签：c++, qt, qml, blackberry-10, blackberry-cascades

我正在尝试为属于下拉列表或 Radio Group 的一组选项设置自定义样式。我到处寻找，这似乎是不可能的。至少我想减小每个选项文本中字母的大小，因为太大了！并使我的用户界面崩溃。

这是我需要的示例：

```
RadioGroup {
 id: groupOrigin
 objectName: "groupOrigin"

 Option{
   text: "text to display" 
   //This text default style is what I'm trying to change. Please help!.
 }
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T08:57:51.890

对于 Radio 组，您可以使用自定义实现来实现这一点。取一个标签并将其放置在单选组未在选项标签内提供文本之后。所以无论你想应用什么风格都可以使用标签来完成。

在标签上，您可以设置要应用的字体大小、颜色和其他样式参数。

请检查下面的源代码以获取此自定义单选按钮。我在 QML 中做到了这一点，您可以在 C++ 中实现相同的目标。

```
// The Component title.
    Label {
        id: titleLabel
        text: ""
        textStyle {
            base: SystemDefaults.TextStyles.SmallText
            alignment: TextAlignment.Center
        }
        layoutProperties: StackLayoutProperties {
            horizontalAlignment: HorizontalAlignment.Fill
        }
    }

    // The radio group presenting the different curves.
    RadioGroup {
        id: radioGroup

        Option {
            text: "Height"
        }
    } 
```

# php - 动态日期排序不起作用（使用 jQuery 和 PHP）

> ID：13293293
> 
> 赞同：0
> 
> 时间：2012-11-08T16:29:42.997
> 
> 标签：php, jquery

我目前正在尝试使用 jQuery 对一系列动态日期进行排序，但我的代码似乎不起作用。我不明白我做错了什么。它似乎在这里运行良好[http://jsfiddle.net/Erah9/10/](http://jsfiddle.net/Erah9/10/)（使用示例 HTML 而不是 PHP）但当我使用下面的代码时却不行。这是我到目前为止所做的：

**数组**

```
$status = array("Allocated","Declined","Failed","Pending");
$day = array("1 - Mon","2 - Tue","3 - Wed","4 - Thu","5 - Fri");
$moduleCode = array("XXX101","XX107","XXX122","XXX123","XXX124","XXX201");
$room = array("X110","XX011","X020","XX012","XX013","X001", "X201");
$period = array("1 - 09:00","2 - 10:00","3 - 11:00","4 - 12:00","5 - 13:00"); 
```

**PHP**

```
<div style="padding-top: 20px;">
  <input class="btn" type="button" value="Oldest First" id="sortAsc"/>
  <input class="btn" type="button" value="Newest First" id="sortDesc"/>
</div>
<div id="wrapper" style="padding-top: 10px">
        <ul>
        <?php
        $dateStart = new DateTime();
        $dateStart->setDate(2012, 10, 01);
        $dateEnd = new DateTime();
        $dateEnd->setDate(2012, 12, 01);

        $dates = array();
        while ( $dateStart < $dateEnd ) {
        $status_txt = $status[array_rand($status)];
        $room_txt = $room[array_rand($room)];
        $moduleCode_txt = $moduleCode[array_rand($moduleCode)];
        $day_txt = $day[array_rand($day)];
        $period_txt = $period[array_rand($period)];

        printf(
        "<li class='item'><div class='activity_date'>%s</div>
        <div class='activity_box'>
        <div class='activity_text' id='act'>" . $status_txt . ' request for room 
        '.$room_txt.' made by department CO for module '.$moduleCode_txt.' on
        '.substr($day_txt,3, 4).' '.substr($period_txt,3,6).'</div>
        </div></li>',
        $dateStart->format("d/m/Y")
        );

        $dateStart->modify(sprintf("+%d day",mt_rand(1, 10)));
        }
        ?>
        </ul>
        </div> 
```

**JS**

```
$(window).load(function() {
    var itemsArray = $.makeArray($("li.item"));
    itemsArray.sort(function(a,b){
        var aTime = new Date(parseDate($(a).find('.activity_date').text())).getTime();
        var bTime = new Date(parseDate($(b).find('.activity_date').text())).getTime();
        return bTime - aTime;
    });

    $('#sortAsc').click(function(){
        $("#wrapper").empty().append("<ul></ul>");
        $(itemsArray).each(function(){
            $("#wrapper ul").prepend($(this));
        });
    });

    $('#sortDesc').click(function(){
        $("#wrapper").empty().append("<ul></ul>");
        $(itemsArray).each(function(){
            $("#wrapper ul").append($(this));
        });
    });        
});

function parseDate(input) {
    var parts = input.match(/(\d+)/g);
    var date = new Date(parts[2], parts[1], parts[0], 0, 0, 0);
    return date;
} 
```

​</p>

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:39:36.327

我们可以看到数组 $status、$room 等的一些内容吗？

重新创建您的 PHP（已更新，请参阅下面的评论），它对我来说可以正常运行。

```
 <!DOCTYPE HTML>
    <html lang="en-US">
    <head>
        <meta charset="UTF-8">
        <title></title>
        <script type="text/javascript" src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script type="text/javascript">
    $(window).load(function() {
        var itemsArray = $.makeArray($("li.item"));
        itemsArray.sort(function(a,b){
            var aTime = new Date(parseDate($(a).find('.activity_date').text())).getTime();
            var bTime = new Date(parseDate($(b).find('.activity_date').text())).getTime();
            return bTime - aTime;
        });

        $('#sortAsc').click(function(){
            $("#wrapper").empty().append("<ul></ul>");
            $(itemsArray).each(function(){
                $("#wrapper ul").prepend($(this));
            });
        });

        $('#sortDesc').click(function(){
            $("#wrapper").empty().append("<ul></ul>");
            $(itemsArray).each(function(){
                $("#wrapper ul").append($(this));
            });
        });        
    });

    function parseDate(input) {
        var parts = input.match(/(\d+)/g);
        var date = new Date(parts[2], parts[1], parts[0], 0, 0, 0);
        return date;
    }    
    </script>
        </head>
    <body>
        <div style="padding-top: 20px;">
      <input class="btn" type="button" value="Oldest First" id="sortAsc"/>
      <input class="btn" type="button" value="Newest First" id="sortDesc"/>
    </div>
    <div id="wrapper" style="padding-top: 10px">
            <ul>
            <?php

            $status = array("Allocated","Declined","Failed","Pending");
    $day = array("1 - Mon","2 - Tue","3 - Wed","4 - Thu","5 - Fri");
    $moduleCode = array("XXX101","XX107","XXX122","XXX123","XXX124","XXX201");
    $room = array("X110","XX011","X020","XX012","XX013","X001", "X201");
    $period = array("1 - 09:00","2 - 10:00","3 - 11:00","4 - 12:00","5 - 13:00");

            $dateStart = new DateTime();
            $dateStart->setDate(2012, 10, 01);
            $dateEnd = new DateTime();
            $dateEnd->setDate(2012, 12, 01);

            $dates = array();
            while ( $dateStart < $dateEnd ) {
    $status_txt = $status[array_rand($status)];
            $room_txt = $room[array_rand($room)];
            $moduleCode_txt = $moduleCode[array_rand($moduleCode)];
            $day_txt = $day[array_rand($day)];
            $period_txt = $period[array_rand($period)];

            printf(
            "<li class='item'><div class='activity_date'>%s</div>
            <div class='activity_box'>
            <div class='activity_text' id='act'>" . $status_txt . ' request for room 
            '.$room_txt.' made by department CO for module '.$moduleCode_txt.' on
            '.substr($day_txt,3, 4).' '.substr($period_txt,3,6).'</div>
            </div></li>',
            $dateStart->format("d/m/Y")
            );

            $dateStart->modify(sprintf("+%d day",mt_rand(1, 10)));
            }
            ?>
            </ul>
            </div>
    </body>
    </html> 
```

# php - Twig 模板引擎和截断文本

> ID：13293295
> 
> 赞同：0
> 
> 时间：2012-11-08T16:29:47.493
> 
> 标签：php, twig, templating, templating-engine

[根据这个网站](http://devzone.zend.com/1886/creating-web-page-templates-with-php-and-twig-part-1/)，我一直在学习如何使用 Twig 。这是我的代码，是教程的变体：

索引.php：

```
<?php
// include and register Twig auto-loader
include 'Twig/Autoloader.php';
Twig_Autoloader::register();

// attempt a connection
try {
  $dbh = new PDO('mysql:dbname=articles;host=localhost', 'test', 'testing');
} catch (PDOException $e) {
  echo "Error: Could not connect. " . $e->getMessage();
}

// set error mode
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

// attempt some queries
try {
  // execute SELECT query
  // store each row as an object
  $sql = "SELECT * FROM schedule GROUP BY airtime";
  $sth = $dbh->query($sql);
  while ($row = $sth->fetchObject()) {
    $data[] = $row;
  }

  // close connection, clean up
  unset($dbh); 

  // define template directory location
  $loader = new Twig_Loader_Filesystem('templates');

  // initialize Twig environment
  $twig = new Twig_Environment($loader);
  $escaper = new Twig_Extension_Escaper(false);
$twig->addExtension($escaper);
  // load template
  $template = $twig->loadTemplate('countries.tmpl');

  // set template variables
  // render template
  echo $template->render(array (
    'data' => $data
  ));

} catch (Exception $e) {
  die ('ERROR: ' . $e->getMessage());
}
?> 
```

和模板页面：

```
 {% for d in data %}
      <tr>
        <td>{{ d.articleid }}</td>
        <td>{{ d.articlename }}</td>
        <td>{{ d.info }}</td>
      </tr> 
      {% endfor %} 
```

通过以下方式启用自动转义：

```
 $twig = new Twig_Environment($loader);
  $escaper = new Twig_Extension_Escaper(false);
$twig->addExtension($escaper); 
```

但是，我想截断文本并尝试通过将文本扩展添加到扩展目录来安装它，但我不知道如何让它工作，所以我可以这样做：

```
{{d.info|truncate(40)}} 
```

等等

我确实在谷歌上看过，但我发现与 Symfony 相关，我正在使用 Twig，只是为了感受一下它作为模板引擎的感觉。

我应该怎么做才能在 Twig 中截断文本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T12:18:52.953

您已经有了一半的解决方案，因为您似乎只缺少添加扩展名，这与您使用转义器扩展名基本相同：

```
$twig->addExtension(new Twig_Extensions_Extension_Text()); 
```

应该做的伎俩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T11:46:05.857

在 config.yml 中启用它的服务：

```
services:
    twig.extension.text:
        class: Twig_Extensions_Extension_Text
        tags:
                - { name: twig.extension } 
```

# java - Spring Java 配置 - 如何创建枚举映射到 beans-references

> ID：13293297
> 
> 赞同：16
> 
> 时间：2012-11-08T16:29:59.223
> 
> 标签：java, spring

使用基于 Java 的配置，我正在尝试将映射枚举到 bean 引用的映射转换为纯 Java 配置（当前在 XML 和工作中），但似乎在文档中找不到任何内容；

目前，我的 XML 是这样的；

```
<util:map id="colourHanders" key-type="com.example.ColourEnum"
          value-type="com.example.ColourHandler">
    <entry key="white" value-ref="whiteColourHandler"/>
    <entry key="blue" value-ref="blueColourHandler"/>
    <entry key="red" value-ref="redColourHandler"/>
</util:map> 
```

我确信这很容易，但同样，找不到关于如何在纯 Java 中表示它的任何内容（所以我没有任何 XML 配置文件）..

笔记; `ColourHandler`bean 是使用 @Component 注释创建的，例如。

```
@Component
public class RedColourHandler implements ColourHander{
.....
} 
```

并且 colourHandlers 的地图是这样引用的；

```
@Resource(name="colourHandlers")
    private Map<ColourHandlerEnum, ColourHandler> colourHandlers; 
```

谢谢，

伊恩。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-08T16:42:48.070

你可能想要这样的东西：

```
@Configuration
public class MyConfiguration {
    @Bean public Map<ColourEnum, ColourHandler> colourHandlers() {
        Map<ColourEnum, ColourHandler> map = new EnumMap<>();
        map.put(WHITE, whiteHandler());
        // etc
        return map;
    }

    @Bean public ColourHandler whiteHandler() {
        return new WhiteHandler();
    }
} 
```

如果您需要将处理程序保留为`@Component`s，则可以将它们自动装配到配置类中：

```
@Configuration
public class MyConfiguration {
    @Autowired private WhiteColourHandler whiteColourHandler;

    @Bean public Map<ColourEnum, ColourHandler> colourHandlers() {
        Map<ColourEnum, ColourHandler> map = new EnumMap<>();
        map.put(WHITE, whiteColourHandler);
        return map;
    }
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2017-09-03T10:39:39.620

由于您已经为每个 ColorHandler 提供了一个唯一的类/@Component，我会让 Spring 弄清楚要使用什么（不需要 @Autowire 注入，也不需要任何其他创建方法）：

```
@Configuration
public class MyConfiguration {
    @Bean public Map<ColourEnum, ColourHandler> colourHandlers(
            WhiteColourHandler whiteHandler, 
            BlueColourHandler blueHandler, 
            RedColourHandler redHandler) {
        Map<ColourEnum, ColourHandler> map = new EnumMap<>();
        map.put(WHITE, whiteHandler);
        map.put(BLUE, blueHandler);
        map.put(RED, redHandler);
        return map;
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T16:42:51.860

这实际上非常简单，但您需要知道如何：

```
 @Autowired private ColourHandler whiteColourHandler;
 ...

 public Map<ColourEnum, ColourHandler> getColourHander() {
     Map<ColourEnum, ColourHandler> result = ...;
     map.put( ColourEnum.white, whiteColourHandler );
     ...
     return map;
 } 
```

诀窍是您可以将 bean 注入到配置中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-03-12T14:56:07.177

类似于接受的答案，除了自动装配组件，您可以像往常一样在配置类中声明 bean 并将它们作为参数传递给 Map bean 方法：

```
@Configuration
public class MyConfiguration {
    @Bean public Map<ColourEnum, ColourHandler> colourHandlers(ColourHandler whiteHandler) {
        Map<ColourEnum, ColourHandler> map = new EnumMap<>();
        map.put(WHITE, whiteHandler);
        return map;
    }

    @Bean public ColourHandler whiteHandler() {
        return new WhiteHandler();
    }
} 
```

另请注意，如果字段名称遵循与 bean 定义相同的命名约定，则将映射作为 @Resource 注入不需要注释的“名称”参数。

ie 这将在没有 name 参数的情况下工作：

```
@Resource
private Map<ColourHandlerEnum, ColourHandler> colourHandlers; 
```

但这需要它：

```
@Resource(name="colourHandlers")
private Map<ColourHandlerEnum, ColourHandler> handlers; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-11-22T07:38:19.233

您可以让`ColourHandler`类本身定义自己的类型，这样当您获得新类型时，您就不必不断更改配置类：

```
public interface ColourHander {
    ColourEnum getType();
} 
```

```
@Component
public class RedColourHandler implements ColourHander{
    @Override
    public ColourEnum getType() {
        return ColourEnum.RED;
    }
} 
```

在您的配置类中，您将获得所有`ColourHandler`s 并将它们映射到它们的类型。

```
@Configuration
public class MyConfiguration {
    @Bean 
    public Map<ColourEnum, ColourHandler> colourHandlers(List<ColourHandler> colourHandlers) {
        return colourHandlers.stream().collect(toMap(ColourHandler::getType, x -> x));
    }
} 
```

请注意，如果`IllegalStateException`每种颜色有多个处理程序，您将得到一个，我猜这是预期的行为，您可以抓住它并抛出自己的。

# iphone - Iphone App 自动音量

> ID：13293302
> 
> 赞同：0
> 
> 时间：2012-11-08T16:30:12.133
> 
> 标签：iphone

是否有可能有一个 iphone 应用程序：

*   允许您将手机静音并在设定的时间后自动重新打开铃声？

或者

*   将铃声音量降低到 0，然后在设定的时间后自动打开铃声？

谢谢，所有答案将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:30:28.673

看看这篇文章：

[如何以编程方式使铃声静音或更改 iOS5 上的铃声](https://stackoverflow.com/questions/9320725/how-to-programmatically-silence-the-ringer-or-change-the-ringer-tone-on-ios5)

# windows - 如何在delphi中运行带参数的run.exe（Win+R）？

> ID：13293305
> 
> 赞同：0
> 
> 时间：2012-11-08T16:30:19.363
> 
> 标签：windows, delphi

我想通过使用 run.exe(Win+R) 和不同的命令打开一些东西，我想知道如何使用 Delphi 代码来做到这一点？

例如如何使用 Delphi 代码来做到这一点：`Win+R`-> 输入：<code>control admintools -> 运行。它会打开`Administrative Tools`文件夹；</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:33:17.770

使用[`ShellExecute`](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb762153.aspx).

```
uses
  Windows, ShellAPI;
....
ShellExecute(0, nil, 'control', 'admintools', nil, SW_SHOWDEFAULT); 
```

# visual-studio-2010 - 使用 webpart 打开表单

> ID：13293306
> 
> 赞同：0
> 
> 时间：2012-11-08T16:30:19.690
> 
> 标签：visual-studio-2010, c#-4.0, sharepoint-2010, infopath2010, xmlformview

我在使用 XmlFormView 打开信息路径表单时遇到问题。这里有代码：

```
 SPLimitedWebPartManager manager = file.GetLimitedWebPartManager(PersonalizationScope.Shared);
   try
   {
       XmlFormView form = new XmlFormView();
       String templateLib = "FormServerTemplates";
       String xsnName = report + ".xsn";
       form.XsnLocation = String.Format("{0}/{1}/{2}", SPContext.Current.Web.Url, templateLib, xsnName);
       manager.AddWebPart(form, "TopZone", 0);      
    } 
```

因此，我创建了一个页面并添加了一个 xmlform webpart 以查看页面中的 infopath 报告。问题是当我尝试打开页面时：

***无法访问表单模板 (.xsn) 文件。您可能没有打开文件所需的权限。***

***相关 ID：51a2dcd8-d2fa-4d8b-ae13-1b5f9caa1c51***

这很奇怪，因为当我单击我在文档库中分配的内容类型时，我可以打开相同的表单，但在页面中却看不到它。这里发生了什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T15:32:47.763

首先，您可以检查 SharePoint 日志中的异常并将其添加到帖子中吗？

它们位于 C:\Program Files\Common Files\Microsoft Shared\web server extensions\14\LOGS。您可以使用相关 ID 来查找异常。

此外，尝试使用提升的权限，如下所示：

```
SPSecurity.RunWithElevatedPrivileges(delegate()
{
    // your code here
}); 
```

# python - 按列名提取 Excel 数据

> ID：13293307
> 
> 赞同：0
> 
> 时间：2012-11-08T16:30:19.970
> 
> 标签：python, excel, xlrd

我有一个 Excel 数据集：

```
"id","value","name"
  1  , 10,    "cat"
  2  , 20,    "fish" 
```

在 Python 中：

```
import xlrd

col1 = "id"
col2 = "value"
col3 = "name"
wb = xlrd.open_workbook("file.xls")
sh = wb.sheet_by_index(0)

result = sh.someMethod((col1,col3))????? 
```

有没有一种方法可以按名称返回列？

```
print result
[[1,"cat"],[2,"fish"]] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T04:59:07.257

col_slice 可能是合适的，例如：

```
zip(sh.col_slice(0,1),sh.col_slice(2,1)) 
```

# spring-security - 与来自 AbstractUserDetailsAuthenticationProvider 的 BadCredentialsException 相比，Spring 如何处理 AuthenticationServiceException

> ID：13293317
> 
> 赞同：1
> 
> 时间：2012-11-08T16:30:40.890
> 
> 标签：spring-security

当我`BadCredentialsException`从带有消息的`AbstractUserDetailsAuthenticationProvider's`具体类中抛出一个消息时，它已由 spring 处理，并显示默认失败 jsp 中存在的适当消息。

但是当`AuthenticationServiceException`从同一个类中抛出时，spring 无法处理它，而是显示堆栈跟踪。我观察到在这种情况下，spring 无法重定向到默认的失败 jsp。

1.  BadCredentialsException 和 AuthenticationServiceException 都是 AuthenticationException 的子类，那为什么 spring 安全处理方式不同呢？
2.  有什么地方需要设置他的配置吗？
3.  没有处理 AuthenticationServiceException 是否有任何具体原因？

# jquery - 难以使用 Tapestry 区域 - 更改了 ID

> ID：13293318
> 
> 赞同：0
> 
> 时间：2012-11-08T16:30:43.300
> 
> 标签：jquery, css, tapestry

当我使用tapestry 5.3.6、CSS、jQuery（使用tapestry5-jquery 3.3.3）javaScript 时出现了一些问题。

当我设置一个具有区域的页面（我正在使用 jQueryUI 选项卡）然后从一个切换到另一个刷新我制作的一些组件时，由于标签 ID 的更改，一些元素失去了它们的样式。我用嵌入式样式解决了这个问题，但现在有另一个问题。

我使用 jQuery 将一些事件绑定到一些元素。区域切换后，某些元素会丢失其事件。我已经通过 onActivate 函数中的事件绑定解决了它。此外，当元素的 id 发生变化时，jQuery 选择器会出现问题，但可以使用条件选择器来解决。

有没有更优雅的方式来处理挂毯中的这类问题？我现在所拥有的非常令人困惑，并给我的项目带来了更多的复杂性。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T09:23:36.260

我试图通过从组件[ajax.tabs](http://tapestry5-jquery.com/components/docsjquerytabs)中关闭 t:ajax 标志来解决我的问题，这将排除区域的使用。似乎解决了我的问题，但问题仍然存在，因为我可能希望在其他情况下打开 ajax 行为。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T05:13:13.010

如果您的区域不是在循环中创建的，您可以将区域的`t:id`和设置`id`为相等：

`<t:zone t:id="myId" id="myId" />`

这将在区域更新时停止挂毯分配新的 ID。

# javascript - 如何让 xmlHTTP 等待完成加载

> ID：13293321
> 
> 赞同：0
> 
> 时间：2012-11-08T16:30:51.140
> 
> 标签：javascript, xmlhttprequest

```
function updateItem(str)
{
    var stocks =new Array("GOOG","MSFT","AAP","JDAS","G");
    for(var i=0; i<stocks.length;i++)
    {

        xmlHttp=GetXmlHttpObject();    
        if (xmlHttp==null)
        {
            alert ("Browser does not support HTTP Request");
            return;
        }

        var url="php/updateCart.php";
        url=url+"?q="+stocks[i];
        url=url+"&sid="+Math.random();

        xmlHttp.onreadystatechange= function(){
            if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")
            {
                document.getElementById(stocks[i])
                .innerHTML=xmlHttp.responseText;
            }
        } 

        xmlHttp.open("GET",url,true);
        xmlHttp.send(null); 

    }
}    

function startOff()
{

    if(interval != -1)
    {
        clearInterval(interval);
    }

    interval = setInterval(function() {updateItem()}, 1000);
} 
```

我正在尝试在一个间隔内更新一个表单中的多个部门，问题是 for 循环将很快完成请求。我没有意识到这一点，直到我发出一堆警报并注意到当我慢慢按下输入时......我知道你可以使用 setTimeout 来做到这一点，但我似乎无法正确理解语法。由于我没有检查 readystate 的函数的名称，所以有人可以给我一个关于语法的提示。或者，如果有更简单的方法......我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:43:14.983

您可以使用闭包。将单个值传递给不同的函数，它可以在回调中访问。示例代码可以是这样的：

```
function updateAllItems(str) {
    var stocks =new Array("GOOG","MSFT","AAP","JDAS","G");
    for(var i=0; i<stocks.length;i++) {
        updateItem(str, stocks[i]);
    }
}

function updateItem(str, stock) {
    var xmlHttp=GetXmlHttpObject(); 
    if (xmlHttp==null) {
        alert ("Browser does not support HTTP Request");
        return;
    }
    var url="php/updateCart.php";
    url=url+"?q="+stock;
    url=url+"&sid="+Math.random();

    xmlHttp.onreadystatechange= function(){
    if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete") {
        document.getElementById(stock).innerHTML=xmlHttp.responseText;
    }
    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
}

function startOff() {
   if(interval != -1) {
       clearInterval(interval);
   }
   interval = setInterval(function() {updateAllItems()}, 1000);
 } 
```

编辑：还添加了 startOff() 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:44:56.100

编辑：我把事情搞混了，认为 javascript 有块范围。当您尝试用我想的多种语言解决问题时，就会发生这种情况。问题仍然是一样的，但解决方案不是。我仍然不会使用您使用的超时来解决这个问题（或者在前一个请求完成后开始下一个请求），因为我认为这不是正确的方法。相反，我将解决超时技术仅试图解决的潜在问题。

问题不在于 for 循环“太快”。问题是您在回调函数中使用的变量的范围大于 for 循环体。这意味着您每次都将相同的变量设置为不同的值。因此，最终调用回调函数时，变量将具有最终值。

解决此问题的一种方法是将请求的创建移动到一个新函数，如下所示：

```
function updateAllItems()
{
    var stocks =new Array("GOOG","MSFT","AAP","JDAS","G");
    for(var i=0; i<stocks.length;i++)
    {
        updateItem(stocks[i]);
    }
}

function updateItem(stock)
{
    var xmlHttp=GetXmlHttpObject(); // Do note, we need the var keyword here to
                                    // make sure this variables uses this scope
                                    // rather than global scope
    if (xmlHttp==null)
    {
        alert ("Browser does not support HTTP Request");
        return;
    }

    var url="php/updateCart.php";
    url=url+"?q="+ stock;
    url=url+"&sid="+Math.random();

    xmlHttp.onreadystatechange= function(){
        if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")
        {
            document.getElementById(stock)
            .innerHTML=xmlHttp.responseText;
        }
    }

    xmlHttp.open("GET",url,true);
    xmlHttp.send(null);
} 
```

这可能是更容易理解的方式，但我个人更喜欢下面的方式。它基本上做同样的事情，但是在我们立即调用的匿名函数中使用一点 Javascript 技巧，我们不再需要这样的单独函数，而是可以处理这个内联函数：

```
function updateAllItems()
{
    var stocks =new Array("GOOG","MSFT","AAP","JDAS","G");
    for(var i=0; i<stocks.length;i++)
    {

        (function ()
        {
            var xmlHttp=GetXmlHttpObject(); // Do note, we need the var keyword here to
                                            // make sure this variables uses this scope
                                            // rather than global scope
            var i2 = i;

            if (xmlHttp==null)
            {
                alert ("Browser does not support HTTP Request");
                return;
            }

            var url="php/updateCart.php";
            url=url+"?q="+ stocks[i];
            url=url+"&sid="+Math.random();

            xmlHttp.onreadystatechange= function(){
                if (xmlHttp.readyState==4 || xmlHttp.readyState=="complete")
                {
                    document.getElementById(stocks[i])
                         .innerHTML=xmlHttp.responseText;
                }
            }
        })();

        xmlHttp.open("GET",url,true);
        xmlHttp.send(null);
    }
} 
```

# jasper-reports - 使用溢出细节带拉伸未按预期工作

> ID：13293322
> 
> 赞同：2
> 
> 时间：2012-11-08T16:30:56.257
> 
> 标签：jasper-reports

我有一个简单的报告。它有两个乐队的标题和细节。在*Title*我有一个静态文本，在*Detail*我有一个*textField*。

*textField*设置为***stretchwithoverflow = "true*** " 。如果我将此字段的高度设置为适合一个原始信息，我会得到一排半的更大信息。所以一个*textField*，在*textField*我有 2 行信息，第一行显示正确，第二行 - 我可以看到半个高度。

这可以做到吗？仅展开包含较大信息的行，较大的信息将很好地适合文本字段？

```
<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="report7" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="15f9d2dd-21ce-41ec-bcb8-c1aca3a77e37">
    <parameter name="EndDate" class="java.util.Date">
        <defaultValueExpression><![CDATA[new java.util.Date()]]></defaultValueExpression>
    </parameter>
    <parameter name="Project" class="java.util.Collection"/>
    <parameter name="Severity" class="java.util.Collection"/>
    <parameter name="StartDate" class="java.util.Date">
        <defaultValueExpression><![CDATA[new java.util.Date(112, 0, 01)]]></defaultValueExpression>
    </parameter>
    <parameter name="Project_Sets" class="java.util.Collection"/>
    <queryString>
        <![CDATA[some query]]>
    </queryString>
    <field name="crid" class="java.lang.String"/>
    <field name="SEVER" class="java.lang.String"/>
    <field name="product" class="java.lang.String"/>
    <field name="state" class="java.lang.String"/>
    <field name="status" class="java.lang.String"/>
    <field name="submit_date" class="java.lang.String"/>
    <field name="aging" class="java.lang.Long"/>
    <title>
        <band height="25" splitType="Stretch">
            <staticText>
                <reportElement uuid="63eef93a-7e8f-4c69-b9d6-4447fe90673d" x="0" y="0" width="555" height="25" forecolor="#3399FF"/>
                <textElement textAlignment="Center">
                    <font size="16" isBold="true"/>
                </textElement>
                <text><![CDATA[Defects Aging]]></text>
            </staticText>
        </band>
    </title>
    <columnHeader>
        <band height="32">
            <rectangle>
                <reportElement uuid="9a2288d4-87ce-4ee7-b04e-267a7ee0ea8b" x="0" y="0" width="555" height="32" backcolor="#99CC00"/>
            </rectangle>
            <staticText>
                <reportElement uuid="9281aa7a-4bcc-4456-9f25-83c7b2360a01" x="0" y="0" width="79" height="32" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[CRID]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="cacda134-069c-43ae-abc1-76f5c865df41" x="79" y="0" width="79" height="32" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Severity]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="d798786f-5ee0-4e76-8a35-2f908af6e92c" positionType="Float" x="158" y="0" width="79" height="32" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Product]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="6be4792d-01a5-4d18-940d-90f40417c7ad" positionType="Float" x="237" y="0" width="79" height="32" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[State]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="fa447ca9-121c-43fb-a7bf-1b29ada93adf" positionType="Float" x="316" y="0" width="79" height="32" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Status]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="b2d8f1db-871b-4e34-942f-b8c4a87a358b" positionType="Float" x="395" y="0" width="79" height="32" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Submit Date]]></text>
            </staticText>
            <staticText>
                <reportElement uuid="c3eddc7c-25ca-4e29-a01e-13e856b67d03" x="474" y="0" width="79" height="32" forecolor="#FFFFFF"/>
                <textElement textAlignment="Center" verticalAlignment="Middle">
                    <font fontName="Arial" size="12" isBold="true"/>
                </textElement>
                <text><![CDATA[Days]]></text>
            </staticText>
        </band>
    </columnHeader>
    <detail>
        <band height="81" splitType="Stretch">
            <elementGroup>
                <textField isStretchWithOverflow="true">
                    <reportElement uuid="6422c6d3-40b9-4e38-8bb4-ded91c91ac17" stretchType="RelativeToBandHeight" x="158" y="0" width="79" height="39"/>
                    <textElement textAlignment="Left" verticalAlignment="Middle"/>
                    <textFieldExpression><![CDATA[$F{product}]]></textFieldExpression>
                </textField>
            </elementGroup>
        </band>
    </detail>
</jasperReport> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T16:47:06.070

如果有更多项目并且您希望所有项目都相同，则在同一个乐队中。必须将它们**全部**设置为**stretchType="RelativeToTallestObject" 和isStretchWithOverflow="true"。**

```
 <textField isStretchWithOverflow="true" pattern="###0">
            <reportElement stretchType="RelativeToTallestObject" x="1576" y="0" width="91" height="20"/>
            <textElement textAlignment="Center"/>
            <textFieldExpression class="java.lang.Long"><![CDATA[$F{count_tohfa}]]></textFieldExpression>
        </textField> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-10T11:40:27.273

报告属性：添加此

> ```
> net.sf.jasperreports.text.save.line = true
> 
> net.sf.jasperreports.export.html.wrap.break.word = true 
> ```

来源：[Word Wrapping HTML 与 PDF](https://community.jaspersoft.com/questions/800961/word-wrapping-html-versus-pdf)

# c# - 尝试接受用户输入并写入文件

> ID：13293323
> 
> 赞同：0
> 
> 时间：2012-11-08T16:30:57.927
> 
> 标签：c#, javascript, asp.net

我在尝试将地址的地理位置保存到文件时遇到问题。我正在使用隐藏标签来传输信息。

在客户端按钮事件上，我有：

```
 function save() {
        document.getElementById("hidLat").value = y;
        document.getElementById("hidLon").value = x;
        <% saveAddress s = save(); %>
   } 
```

在 c# 中我有：

```
 protected saveAddress save()
   {
        saveAddress s = new saveAddress();
        s.latitude = hidLat.Value;
        s.longitude = hidLon.Value;

        using (System.IO.StreamWriter file = new System.IO.StreamWriter(@"C:\\savedAddresses.txt", true))
        {
            file.WriteLine(s.latitude + " " + s.longitude);
            file.Close();
        }  

        return s;
   } 
```

当我单击按钮时，文件已创建，但没有保存任何内容。我这样做是对的还是有更好的方法来尝试将用户输入写入文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:33:04.877

您确定设置了纬度和经度变量吗？尝试先打印出来.. 代码似乎没问题

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:35:34.957

我认为您对网络生命周期感到困惑。在您的特定情况下，这就是正在发生的事情：

1.  您的页面被请求，并且 ASP.NET 运行时在后面加载您的代码并尝试执行该页面。
2.  在执行页面的过程中，ASPX 包含要调用的代码

    ```
     saveAddress s = save() 
    ```

    通过这种方式，该方法甚至在页面被渲染回客户端之前被调用。

3.  当页面最终发送到客户端时，您有一些客户端代码调用`function save()`.

我猜您希望在 javascript 函数运行后调用该服务器端方法。你有两个选择：

1.  完整的 PostBack - 您将表单发布回服务器，您的 ASPX 代码后面可以有一些代码来检查`Page.IsPostBack`并尝试调用您的服务器端方法。
2.  Ajax - 您可以向站点上的特定处理程序发出 ajax 请求，然后调用服务器端`save`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:41:06.733

您似乎对在服务器和客户端代码之间传输值感到困惑。看到标记会很有用。我假设您正在使用网络表单`<asp:Label />`控件。为了将值传输到服务器，您需要发布一个表格或制作一个`XMLHttpRequest.`还有其他方法，但我们现在只使用这两种方法。

还要记住，如果这些标签是服务器控件，它们的值将存储在视图状态中。用 javascript 修改值不会影响视图状态。我建议将值存储在隐藏的表单输入字段中。将您的保存逻辑添加到保存`OnClick`服务器端。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T17:02:36.903

评论

你不想使用

```
file.Close(); 
```

当您使用“使用（）{}”时

# git - 使用 TortoiseHG 克隆 Repo 导致 404 错误

> ID：13293325
> 
> 赞同：0
> 
> 时间：2012-11-08T16:31:03.450
> 
> 标签：git, bitbucket, repository

我正在使用 TortoiseHG 将存储库从 BitBucket 克隆到我硬盘驱动器上的本地文件夹中以进行处理。

我转到要克隆到的文件夹，右键单击它并从 TorToiseHG 的上下文菜单中选择克隆。然后，我将来自 BitBucket 的 HTTPS 地址作为源地址，并将我要克隆到的文件夹的完整路径作为我的目标地址。

但是，当我单击克隆时，我不断收到错误消息，抱怨存在错误 404。

```
% hg clone --verbose -- https://username@bitbucket.org/username/projecrepo.git
HTTP Error: 404 (Not Found)
[command returned code 255 Thu Nov 08 15:28:20 2012] 
```

我 100% 确定我输入的来源地址是正确的；我直接从 BitBucket 复制。

我可能做错了什么导致错误？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T23:54:08.670

如果 projecrepo.git 没有出错并且您使用 Mercurial（以 TortoiseHG 的形式，没关系），您**必须**下载并添加[HGGit](http://mercurial.selenic.com/wiki/HgGit)扩展以启用

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:34:31.917

```
hg clone --verbose -- http://SOMESITE/mobile/REPO_LOCATION C:\Users\ME\Desktop 
```

是我使用的，它工作得很好。

我只需右键单击，tortise hg > clone，然后进入该站点。

如果您收到 404 未找到，这意味着您可能没有权限。我必须设置权限才能从这些目录中提取，如果您的权限未设置，它可能会返回 404。在我的逻辑中，你不会想要一个权限错误标志，因为人们会知道他们有正确的位置，但需要编写更好的标题来蛮力围绕墙壁等。

另外：你的指挥部没有目的地？不确定这是否意味着什么。我只是比较我正确的 cmd 和你的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-28T07:57:16.503

对我来说，原因是我没有正确指定链接。我已经安装了*hg-git*扩展，但它仍然给我 404。

看看这个问题：[我可以从 BitBucket 克隆一个 git 存储库吗？](https://stackoverflow.com/questions/27882358/can-i-hg-clone-a-git-repository-from-bitbucket)

基本上，如果您的 BitBucket 存储库 URL 看起来像

```
https://your_username@bitbucket.org/rep_username/project.git 
```

你应该使用一个命令

```
hg clone git+https://bitbucket.org/rep_username/project.git 
```

*请注意，该`your_username@`部分已从原始 URL 中删除，然后您将被要求输入用户名和密码以访问存储库。*

# mysql - 选择符合任意条件的行

> ID：13293331
> 
> 赞同：1
> 
> 时间：2012-11-08T16:31:36.700
> 
> 标签：mysql, select

我有一个这样的 MySql 表：

```
ID  Category    Value
A   LOCATION    COPENHAGEN
A   LOCATION    MADRID
B   LOCATION    MADRID
C   LOCATION    MADRID
C   LOCATION    AARHUS
C   POSITION    WEBDESIGN
D   POSITION    SYSADMIN
D   POSITION    WEBDESIGN
A   GENDER      MALE
B   GENDER      MALE
C   GENDER      FEMALE 
```

Id、Category 和 Values 共同构成了键。请注意，它们是动态的（用户定义的）并且表会很大。

现在我想得到所有`ID`符合某些标准的东西。要返回，`ID`匹配每个 中的一个值就足够了`Category`。

例如：

给我所有拥有的 IDS

> （（位置 = 哥本哈根或位置 = 马德里）和（性别 = 男性））

应该返回 A, B

另一个例子：

给我所有拥有的 IDS

```
((POSITION = SYSADMIN OR POSITION = WEBDESIGN) AND (GENDER = FEMALE) AND (LOCATION = COPENHAGEN OR LOCATION = MADRID)) 
```

应该返回 C

返回的 id 将用作另一个查询的子查询 - 所以性能很重要。

**更新**

我用示例数据和建议的不工作解决方案创建了这个[sql fiddle 。](http://sqlfiddle.com/#!2/3578f/1)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:37:23.427

[删除了初始响应，因为它不起作用。为了使其发挥作用，我在第二次编辑中提出了更可取的查询。]

* * *

## 编辑

您似乎正在尝试创建一个模式来跟踪在不同位置工作的人员，并且从您的数据来看，他们似乎可能在不同的办公室中拥有多个头衔。下面的模式将允许您只定义每个人、工作和位置一次，然后使用链接表将它们连接起来。

```
TABLE People
  p_id INT AI PK
  p_name VARCHAR
  p_sex BOOL
  ...

TABLE Offices
  o_ID INT AI PK
  o_name VARCHAR
  o_location VARCHAR
  ...

TABLE Jobs
  j_ID INT AI PK
  j_name VARCHAR
  ...

TABLE People_Jobs_Offices  --linking table
  p_ID INT PK
  o_ID INT PK
  j_ID INT PK 
```

现在获取马德里或哥本哈根的所有系统管理员：

```
SELECT *
FROM People_Jobs_Offices pjo
  INNER JOIN People p
    ON pjo.p_id = p.p_id 
  INNER JOIN Jobs j
    on pjo.j_id = j.j_id
  INNER JOIN Offices o
    ON pjo.o_id = o.o_id
WHERE
  j.j_name = 'SYSADMIN'
  AND ( o.o_location = 'MADRID'
    OR o.o_location = 'COPENHAGEN' ) 
```

这种方法称为[数据库规范化](http://databases.about.com/od/specificproducts/a/normalization.htm)，通常可以充分利用任何 RDBMS 中的索引，并通过避免数据重复将表中的行数保持在最低限度。

* * *

## 编辑²

我[重新摆弄了你的 SQLfiddle](http://sqlfiddle.com/#!2/28c6e/1/0)。其中大部分必须以编程方式完成，即。确定哪些类别/多少连接/表别名/列名，但您想从`ID`列引用的任何表开始，以便为这些连接提供一个可靠的起点，我刚刚创建了该`users`表以进行说明。

```
CREATE TABLE users (`ID` varchar(16),`name` varchar(16));
INSERT INTO users (`ID`, `name`)
VALUES ('A', 'andrew'), ('B', 'bob'), ('C', 'charla'); 
```

和查询：

```
SELECT u.*,
  gen.value 'gender',
  pos.value 'position',
  loc.value 'location'
FROM users u
  LEFT JOIN yourtable gen
    ON u.ID = gen.ID
      AND gen.category = 'GENDER'
  LEFT JOIN yourtable pos
    ON u.id = pos.id
      AND pos.category = 'POSITION'
  LEFT JOIN yourtable loc
    ON u.id = loc.id
      AND loc.category = 'LOCATION' 
```

和输出：

```
ID  NAME    GENDER  POSITION    LOCATION
A   andrew  MALE    (null)      COPENHAGEN
A   andrew  MALE    (null)      MADRID
B   bob     MALE    WEBDESIGN   MADRID
B   bob     MALE    SYSADMIN    MADRID
C   charla  FEMALE  (null)      MADRID
C   charla  FEMALE  (null)      AARHUS 
```

我还要确保，由于有可能进行*许多*连接，您在表中的 3 列（如果不是全部）`category`上都有索引。`ID`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:15:43.210

目前的解决方案是为每个类别创建一个子查询。像这样：

```
SELECT DISTINCT ID
FROM yourtable
WHERE ID IN 
(SELECT ID from yourtable WHERE (Category = 'POSITION' AND Value = 'SYSADMIN'))
AND ID IN 
(SELECT ID from yourtable WHERE (Category = 'LOCATION' AND Value = 'MADRID') OR (Category = 'LOCATION' AND Value = 'COPENHAGEN')) 
```

可以在[SQL Fiddle](http://sqlfiddle.com/#!2/3578f/4)看到工作示例。

它正在工作，但是当我有很多行或检查许多类别时，我担心性能。

# jquery - 在 Chrome 中损坏的 Bootstrap 崩溃示例

> ID：13293334
> 
> 赞同：2
> 
> 时间：2012-11-08T16:31:42.997
> 
> 标签：jquery, twitter-bootstrap

由于某种原因，来自引导网站的崩溃示例在 Chrome 中被破坏了。我将此标记直接粘贴到我的页面中，简单的手风琴在 FireFox 中运行良好，但在 Chrome 中中断。它在 Chrome 中中断的方式是我可以在两个窗格之间切换*一次*，然后根本没有进一步的折叠工作。

我正在使用最新版本的引导程序。

代码如下，这是来自引导站点的直接粘贴。

我读过一些不正确使用 $.transition 的 jQuery 插件会导致这样的问题。是否有任何仅导致 Chrome 出现问题的问题？

```
<div class="accordion" id="accordion2">
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
        Collapsible Group Item #1
      </a>
    </div>
    <div id="collapseOne" class="accordion-body collapse in">
      <div class="accordion-inner">
        Anim pariatur cliche...
      </div>
    </div>
  </div>
  <div class="accordion-group">
    <div class="accordion-heading">
      <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
        Collapsible Group Item #2
      </a>
    </div>
    <div id="collapseTwo" class="accordion-body collapse">
      <div class="accordion-inner">
        Anim pariatur cliche...
      </div>
    </div>
  </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:45:10.793

将此代码与您的 HTML 一起使用：

```
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css"></link>
<script src="http://twitter.github.com/bootstrap/assets/js/bootstrap-collapse.js"></script>
<script>
    $(document).ready(function() {
        $("#accordion2").collapse()​;
    });
</script> 
```

# django - Django Model QuerySet 按特定字段分组

> ID：13293335
> 
> 赞同：2
> 
> 时间：2012-11-08T16:31:45.023
> 
> 标签：django, django-models, django-queryset, django-orm

考虑到这个模型和数据：

Ad_id + 日期 = 主键

```
 Ad_id  date   clicks
------------------------------
      3     8/10/12   124
      3     7/10/12   433
      3     6/10/12    99
      4     8/10/12    23
      4     7/10/12    80 
```

我正在尝试按 ad_id 分组以返回所有点击的总和。

用sql术语：

```
select Ad_id, date, sum(clicks) from ads group by Ad_id 
```

问题是 Django 自动对模型中的每个字段进行分组，所以分组并没有真正起作用（因为每一行都是唯一的）。

**我已经检查过的解决方案：**

* * *

我知道可以做这样的事情：

```
Ad.objects.values('ad_id').annotate(clicks_sum=Sum('clicks')) 
```

但它并不好，因为它不返回广告模型，而是一个字典。

我也不能使用原始 SQL，因为它不是链式的

我也尝试设置

```
MyQuerySet.group_by = ['ad_id'] 
```

也不行。。

所以我真的只需要按我需要的字段进行分组，结果将是一个广告模型。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:14:02.527

您可以使用 执行原始 SQL 查询`Manager.raw()`，在您的情况下是：

```
Ad.objects.raw('select Ad_id, date, sum(clicks) from ads group by Ad_id') 
```

此方法方法接受原始 SQL 查询，执行它并返回一个`RawQuerySet`实例。这个`RawQuerySet`实例可以像普通一样被迭代`QuerySet`以提供对象实例。

# javascript - 如何创建和组织 JavaScript 数组？

> ID：13293336
> 
> 赞同：1
> 
> 时间：2012-11-08T16:31:45.600
> 
> 标签：javascript, jquery, coldfusion

我正在使用 ColdFusion 8 和 jQuery 1.8。

我有一些来自数据库的信息并被填充到这样的 div 中：

```
<div class='SpecInfo' data-height='10' data-width='23' data-length='156'></div>
<div class='SpecInfo' data-height='20' data-width='21' data-length='159'></div>
<div class='SpecInfo' data-height='30' data-width='25' data-length='154'></div>
<div class='SpecInfo' data-height='40' data-width='27' data-length='155'></div>
<input type='button' id='GoButton' value='Go!'> 
```

我需要提取该信息并将其放入数组中并将其传递给 CFC。我有一个收集数据的功能。它看起来像这样：

```
// SET VARS
$GoButton = $("#GoButton"),
    SpecArray = {
        Height: [],
        Width: [],
        Length: []
    };

// GO
var go = function() {
    var $SpecInfo = $(".SpecInfo"),
        SpecInfoLen = $SpecInfo.length,
        H, 
        W,
        L;
    for (i = 0; i < SpecInfoLen; i++) {
        var H = $SpecInfo.eq(i).data('height'),
            W = $SpecInfo.eq(i).data('width'),
            L = $SpecInfo.eq(i).data('length');
        // add H,W,L values to spec array
        SpecArray['Height'].push(H);
        SpecArray['Width'].push(W);
        SpecArray['Length'].push(L);
    }
    // stringify spec array
    // pass spec array to cfc
    alert(SpecArray['Height'].length);
}
$GoButton.click(go); 
```

这给了我一个高度数组，一个宽度数组和一个长度数组。这不是我想要的。我的信息是这样组织的

```
[10,20,30,40]
[23,21,25,27]
[156,159,154,155] 
```

对于每个 div，我希望将所有属性放在一个地方。我想要更像这样的东西：

```
[10,23,156]
[20,21,159]
[30,25,154]
[40,27,155] 
```

我究竟做错了什么？如何组织我的阵列？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:35:27.110

那么为什么要将所有数据放在 3 个单独的数组中而不是对象数组中呢？

代替

```
 SpecArray['Height'].push(H);
    SpecArray['Width'].push(W);
    SpecArray['Length'].push(L); 
```

采用

```
 SpecArray.push( { 'height': H, 'width': W, 'length': L } ); 
```

这会产生一个对象数组，如下所示：

```
[
 { 'height': 10, 'width': 23, 'length': 156 },
 { 'height': 20, 'width': 21, 'length': 159 },
 { 'height': 30, 'width': 25, 'length': 154 },
 { 'height': 40, 'width': 27, 'length': 155 }
] 
```

但是，您必须将其初始化`SpecArray`为一个数组，而不是作为包含 3 个数组的对象。

# playframework-1.x - 在 Ubuntu 上使用 play framework 1.2.3 时出现异常

> ID：13293337
> 
> 赞同：0
> 
> 时间：2012-11-08T16:31:48.860
> 
> 标签：playframework-1.x

我在 Ubuntu 上的 play v1.2.3 实例直到昨天都运行良好。我不确定我是否同时在 Ubuntu 上安装了任何新软件包。当我现在尝试运行 play (run/start) 时，我得到下面复制的异常。我曾尝试清理 tmp 目录，但没有帮助。任何其他想法（除了重新设置游戏）将不胜感激。谢谢

```
Exception in thread "main" play.exceptions.UnexpectedException: Unexpected Error
    at play.vfs.VirtualFile.contentAsString(VirtualFile.java:180)
    at play.classloading.hash.ClassStateHashCreator.getClassDefsForFile(ClassStateHashCreator.java:83)
    at play.classloading.hash.ClassStateHashCreator.scan(ClassStateHashCreator.java:58)
    at play.classloading.hash.ClassStateHashCreator.scan(ClassStateHashCreator.java:63)
    at play.classloading.hash.ClassStateHashCreator.scan(ClassStateHashCreator.java:63)
    at play.classloading.hash.ClassStateHashCreator.scan(ClassStateHashCreator.java:63)
    at play.classloading.hash.ClassStateHashCreator.computePathHash(ClassStateHashCreator.java:48)
    at play.classloading.ApplicationClassloader.computePathHash(ApplicationClassloader.java:371)
    at play.classloading.ApplicationClassloader.<init>(ApplicationClassloader.java:62)
    at play.Play.init(Play.java:272)
    at play.server.Server.main(Server.java:158)
Caused by: java.lang.RuntimeException: java.io.IOException: Input/output error
    at play.libs.IO.readContentAsString(IO.java:62)
    at play.libs.IO.readContentAsString(IO.java:49)
    at play.vfs.VirtualFile.contentAsString(VirtualFile.java:178)
    ... 10 more
Caused by: java.io.IOException: Input/output error
    at java.io.FileInputStream.readBytes(Native Method)
    at java.io.FileInputStream.read(FileInputStream.java:220)
    at sun.nio.cs.StreamDecoder.readBytes(StreamDecoder.java:264)
    at sun.nio.cs.StreamDecoder.implRead(StreamDecoder.java:306)
    at sun.nio.cs.StreamDecoder.read(StreamDecoder.java:158)
    at java.io.InputStreamReader.read(InputStreamReader.java:167)
    at java.io.Reader.read(Reader.java:123)
    at org.apache.commons.io.IOUtils.copyLarge(IOUtils.java:1364)
    at org.apache.commons.io.IOUtils.copy(IOUtils.java:1340)
    at org.apache.commons.io.IOUtils.copy(IOUtils.java:1315)
    at org.apache.commons.io.IOUtils.toString(IOUtils.java:525)
    at play.libs.IO.readContentAsString(IO.java:60) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:06:20.863

我项目中的一个 Java 类不知何故损坏了。当我尝试将整个目录复制到另一个位置时，我注意到了这一点 - 复制操作生成了一条错误消息，指定了损坏的文件（我相信也可以通过其他方式检测到）。

删除损坏的文件（并用相同的代码替换）会导致正常行为。希望这对其他人有帮助。

# knockout.js - 是否有公认的惯例来处理在用户输入之前“未设置”的“是-否”下拉菜单？

> ID：13293341
> 
> 赞同：3
> 
> 时间：2012-11-08T16:32:06.553
> 
> 标签：knockout.js, javascript, knockout-2.0

我认为这一定是一种常见的情况，我想知道在 Knockout 中是否有一个公认的如何处理这个问题的约定。您有一个“是-否”下拉菜单（或一对单选按钮），它的默认值是一个空白项（或两个都未选中，对于单选按钮）。用户必须做出选择才能继续。

这并不能完美地映射到模型中的布尔值，因为实际上存在三个可能的值。真假，没有用户选择。在 C# 中，您可能会考虑使用可为[空](http://msdn.microsoft.com/en-us/library/1t3y8s4s%28v=vs.80%29.aspx)的布尔值，而在 Java 中，您可能会使用[java.lang.Boolean](http://docs.oracle.com/javase/6/docs/api/java/lang/Boolean.html)。在这两种情况下，“null”都可能表示没有用户选择。

JavaScript 没有可空值，但由于它不强制使用变量类型，因此您可以采用特定变量可以为 null、true 或 false 的约定，并以与 C# 或 java 中的可空布尔值类似的方式使用它.lang.布尔值。

首先，存在绑定到布尔值的问题。默认情况下，Knockout 希望所有绑定值都是字符串类型。这在[此处](https://groups.google.com/forum/#!topic/knockoutjs/_-NzcCQreQ8)和[此处](https://stackoverflow.com/questions/10510683/knockoutjs-version-2-1-0-bind-boolean-value-to-select-box)进行了讨论，RP Niemeyer 提供的解决方案是使用自定义绑定，如下所示：（[此示例的链接到 JS Fiddle](http://jsfiddle.net/rniemeyer/H4gpe/)）

```
ko.bindingHandlers.booleanValue = {
    init: function(element, valueAccessor, allBindingsAccessor) {
        var observable = valueAccessor(),
            interceptor = ko.computed({
                read: function() {
                    return observable().toString();
                },
                write: function(newValue) {
                    observable(newValue === "true");
                }                   
            });

        ko.applyBindingsToNode(element, { value: interceptor });
    }
}; 
```

所以我以此为出发点，我想出了这个自定义绑定。它似乎工作。我对社区对此方法的反馈感兴趣。签出[jsfiddle 以](http://jsfiddle.net/zNEMB/23/)自己进行试验。这有什么缺点和/或可扩展性问题吗？

```
ko.bindingHandlers.nullableBooleanValue = {
    init: function(element, valueAccessor, allBindingsAccessor) {
        var observable = valueAccessor(),
            interceptor = ko.computed({
                read: function() {                                           
                    console.log(observable());
                    console.log(typeof(observable()));

                    var result = null;
                    if(observable() === true){
                        result = "true";
                    } else if(observable() === false){
                        result = "false";
                    } else { // Default is null, which represents no user selection
                        result = "null";
                    }

                    console.log("transforming on read:")
                    console.log(typeof(observable()));
                    console.log(observable());
                    console.log(typeof(result));
                    console.log(result);
                    return result;
                },
                write: function(newValue) {
                    var result = null;
                    if(newValue === "true"){
                        result = true;
                    } else if(newValue === "false"){
                        result = false;
                    } else { // Default is null, which represents no user selection
                        result = null;
                    }

                    console.log("transforming on write:")
                    console.log(typeof(newValue));
                    console.log(newValue);
                    console.log(typeof(result));
                    console.log(result);
                    observable(result);
                }                   
            });

        ko.applyBindingsToNode(element, { value: interceptor });
    }
};

var model = {
    state: ko.observable(null)
};

ko.applyBindings(model); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T19:49:50.180

好的，扩展器方法并没有按照我想要的方式工作，所以我放弃了它（如果你好奇的话，仍然在编辑历史中）。我修改了您的绑定以使其放置选项，因此您无需在 HTML 中指定它们。您还可以选择指定“Null”选项文本（您可以扩展它以允许设置每个标签）。

此方法让您可以将 observable 视为标准的可空布尔值。这是 HTML（注意，这`nullLabel`是完全可选的）：

```
<select data-bind="yesNoNull: answer, nullLabel: 'Null' "></select>
<pre data-bind="text: ko.toJSON($root, null, 2)"></pre>​ 
```

这是绑定：

```
ko.bindingHandlers.yesNoNull = {    
    init: function(element, valueAccessor, allBindingsAccessor) {
        var target = valueAccessor();
        var nullLabel = allBindingsAccessor().nullLabel || "";
        var options = function() { return [ nullLabel, "Yes", "No"]; };
        ko.bindingHandlers.options.update(element, options, allBindingsAccessor);

        var observable = valueAccessor(),
            interceptor = ko.computed({
                read: function() {
                    var result = nullLabel;
                    if(observable() === true){
                        result = "Yes";
                    } else if(observable() === false){
                        result = "No";
                    }
                    return result;
                },
                write: function(newValue) {
                    var result = null;
                    if(newValue === "Yes"){
                        result = true;
                    } else if(newValue === "No"){
                        result = false;
                    }
                    observable(result);
                }                   
            });

        ko.applyBindingsToNode(element, { value: interceptor });
    }
}; 
```

这是[小提琴](http://jsfiddle.net/tyrsius/6w3sK/7/)。

# dart - Dart 中的动态类方法调用

> ID：13293345
> 
> 赞同：14
> 
> 时间：2012-11-08T16:32:25.740
> 
> 标签：dart, dart-mirrors

就像[在 PHP 中动态类方法调用中](https://stackoverflow.com/questions/251485/dynamic-class-method-invocation-in-php)的问题一样，我想在 Dart 中执行此操作。

```
var = "name";
page.${var} = value;
page.save(); 
```

那可能吗？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-08T17:40:50.477

[使用Mirrors](https://api.dart.dev/be/dart-mirrors/dart-mirrors-library.html)可以实现几件事。

这是一个如何设置类的值以及如何动态调用方法的示例：

```
import 'dart:mirrors';

class Page {
  var name;

  method() {
    print('called!');
  }
}

void main() {
  var page = new Page();

  var im = reflect(page);

  // Set values.
  im.setField("name", "some value").then((temp) => print(page.name));

  // Call methods.
  im.invoke("method", []);
} 
```

如果您想知道，`im`是一个[`InstanceMirror`](https://api.dart.dev/be/169966/dart-mirrors/InstanceMirror-class.html)，它基本上反映了`page`实例。

还有一个问题：[有没有办法在 Dart 的类中动态调用方法或设置实例变量？](https://stackoverflow.com/questions/10525929/is-there-a-way-to-dynamically-call-a-method-or-set-an-instance-variable-in-a-cla)

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-08T17:23:23.323

你可以使用[Dart Mirror API](https://api.dart.dev/be/dart-mirrors/dart-mirrors-library.html)来做这样的事情。Mirror API 现在还没有完全实现，但它是如何工作的：

```
import 'dart:mirrors';

class Page {
  String name;
}

main() {
  final page = new Page();
  var value = "value";

  InstanceMirror im = reflect(page);
  im.setField("name", value).then((_){
    print(page.name); // display "value"
  });
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-02-06T18:03:49.207

您可以使用可[序列化](https://pub.dartlang.org/packages/serializable)

例如：

```
import 'package:serializable/serializable.dart';

@serializable
class Page extends _$PageSerializable {
  String name;
}

main() {
  final page = new Page();
  var attribute = "name";
  var value = "value";

  page["name"] = value;
  page[attribute] = value;

  print("page.name: ${page['name']}");
} 
```

# c# - Web 表单上的用户定义控件

> ID：13293346
> 
> 赞同：0
> 
> 时间：2012-11-08T16:32:28.033
> 
> 标签：c#, asp.net, .net, .net-3.5

使用 VS 2010、C#、.NET 3.5

我有三个用户定义的 Web 控件：

控件 1 有一个 ListBox 和一个 Button

控制 2 有 3 `Text-Boxes`2`DropDownLists`和 3`Buttons`

控件 3 只有一个在代码中填充的表。

我有两页：

第 1 页有控制 2 和控制 3

第 2 页有控制 1、控制 2 和控制 3

Control 2 的功能在第 1 页上完美运行。

但是，在第 2 页上单击提交按钮时，DropDownLists 总是显示`SelectedIndex = 0`和`SelectedValue = "0"`.

单击控件 2 上的提交按钮时，所有三个文本框和按钮在两个页面上都保留其值。只有 DropDownLists 无法保留其值。

作为参考，这里是提交按钮 OnClick 事件中的代码：

```
 protected void btnSubmit_Click(object sender, EventArgs e)
    {
        clsLog.WriteLog("TrainingForm.ascx - Submit.");
        tcCategoryError.Text = "&nbsp;";
        tcDateError.Text = "&nbsp;";
        tcDescriptionError.Text = "&nbsp;";
        tcHoursError.Text = "&nbsp;";
        tcMethodError.Text = "&nbsp;";
        foreach (Control c in this.Controls)
        {
            LogControls(c);
        }
        c_iTID = Convert.ToInt32(hTID.Value);
        c_szUserName = hUserName.Value;
        bool bValid = true;
        DateTime dtTrainingDate = DateTime.MinValue;
        string szTrainingDescription = "";
        decimal dHours = 0M;
        int iCategoryID = 0;
        int iMethodID = 0;
        if (!DateTime.TryParse(txtTrainingDate.Text, out dtTrainingDate))
        {
            bValid = false;
            tcDateError.Text = "Please Enter Valid Training Date";
        }
        if (!decimal.TryParse(txtTrainingHours.Text, out dHours))
        {
            bValid = false;
            tcHoursError.Text = "Please Enter Valid Training Hours";
        }
        if (this.ddlCategory.SelectedValue == "0")
        {
            bValid = false;
            tcCategoryError.Text = "Please Select Training Category";

        }
        else
            iCategoryID = Convert.ToInt32(this.ddlCategory.SelectedValue);
        if (this.ddlTrainingMethod.SelectedValue == "0")
        {
            bValid = false;
            tcMethodError.Text = "Please Select Training Method";
        }
        else 
            iMethodID = Convert.ToInt32(this.ddlTrainingMethod.SelectedValue);
        if (txtTrainingDescription.Text.Trim() == "")
        {
            bValid = false;
            tcDescriptionError.Text = "Please Enter Training description.";
        }
        else
            szTrainingDescription = txtTrainingDescription.Text.Trim();
        if (bValid)
        {
            clsData.UpdateTraining(c_iTID, "", c_szUserName, dtTrainingDate, szTrainingDescription, iCategoryID, dHours, iMethodID);
            TrainingID = 0;
            ClearForm();
        }
        OnEvent(new MyEventArgs(c_szUserName));

    } 
```

填充 DropDowns 的代码（用户定义控件的一部分）

```
 protected void BindddlCategory(int iCategoryID)
    {
        DataTable dt = clsData.GetTrainingCategories();
        ddlCategory.Items.Clear();
        ddlCategory.AppendDataBoundItems = true;
        ddlCategory.Items.Add(new ListItem("Select Training Category", "0"));
        ddlCategory.DataSource = dt;
        ddlCategory.DataTextField = "TrainingCategory";
        ddlCategory.DataValueField = "CID";
        ddlCategory.DataBind();
        if (iCategoryID != 0)
            ddlCategory.SelectedValue = iCategoryID.ToString();
    }
    protected void BindddlCategory()
    {
        BindddlCategory(0);
    }
    protected void BindddlTrainingMethod(int iMethodID)
    {
        DataTable dt = clsData.GetTrainingMethods();
        ddlTrainingMethod.Items.Clear();
        ddlTrainingMethod.AppendDataBoundItems = true;
        ddlTrainingMethod.Items.Add(new ListItem("Select Training Method", "0"));
        ddlTrainingMethod.DataSource = dt;
        ddlTrainingMethod.DataTextField = "TrainingCategory";
        ddlTrainingMethod.DataValueField = "CID";
        ddlTrainingMethod.DataBind();
        if (iMethodID != 0)
            ddlTrainingMethod.SelectedValue = iMethodID.ToString();
    }
    protected void BindddlTrainingMethod()
    {
        BindddlTrainingMethod(0);
    } 
```

仅供参考，DDL 不会在页面加载时填充，而是在触发显示控件形式的事件时隐式填充：

```
 public void ShowTrainingEntry(int iTrainingID)
    {
        clsLog.WriteLog("TrainingForm.ascx - ShowTrainingEntry(" + iTrainingID.ToString() + ")");
        hTID.Value = iTrainingID.ToString();
        hUserName.Value = UserName;
        int iCategoryID = 0;
        int iMethodID = 0;
        if (iTrainingID != 0)
        {
            DataTable dt = clsData.GetTrainingRecord(iTrainingID);
            if (dt.Rows.Count == 1)
            {
                txtTrainingDate.Text = Convert.ToDateTime(dt.Rows[0]["TrainingDate"]).ToString("MM/dd/yyyy");
                txtTrainingHours.Text = Convert.ToDecimal(dt.Rows[0]["Hours"]).ToString("N1");
                txtTrainingDescription.Text = dt.Rows[0]["TrainingDescription"].ToString();
                int.TryParse(dt.Rows[0]["CategoryCID"].ToString(), out iCategoryID);
                int.TryParse(dt.Rows[0]["MethodCID"].ToString(), out iMethodID);
            }
            ShowChangeMessage(iCategoryID == 0 | iMethodID == 0);
            ShowDeleteButton(true);
            ShowCancelButton(true);
        }
        BindddlCategory(iCategoryID);
        BindddlTrainingMethod(iMethodID);
        tblMain.Visible = true;
    } 
```

有人对为什么会这样有任何想法吗？

谢谢，约翰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T18:28:26.213

如果要动态添加 UserControl，则需要确保它们的添加*不晚*于 Page_Init。这样当页面尝试从 PostBack 设置值时，控件就会出现。

# php - 从 WP 编辑器 TinyMCE 中删除特定按钮

> ID：13293348
> 
> 赞同：2
> 
> 时间：2012-11-08T16:32:30.753
> 
> 标签：php, wordpress, tinymce, wysiwyg

我试图弄清楚如何从 TinyMCE 编辑器中删除特定按钮。我研究了 codex 中的参数，但 TinyMCE 只是说数组，不确定我是否可以在我的参数中包含一些参数来显示/隐藏哪些按钮？

我正在以重力形式使用编辑器，到目前为止我的代码如下

```
add_action( 'gform_field_input', 'gforms_wp_editor', 10, 5 );

function gforms_wp_editor( $input, $field, $value, $lead_id, $form_id ) {
if( $field["cssClass"] == 'richtext' ) {
ob_start();
wp_editor( $value, "input_{$form_id}_{$field['id']}",
array(
'media_buttons' => false,
'quicktags' => false,

'textarea_name' => "input_{$field['id']}"
)   );
$input = ob_get_clean();
}
return $input;
} 
```

我已经使用`quicktags`to false 删除了 HTML 选项卡，所以希望我可以做一些类似的事情来从编辑器中删除按钮。

上面代码现在显示的按钮如下

![在此处输入图像描述](../Images/7da31c3a462747dcfa42f7c2add939d8.png)

**注意：** “teeny”编辑器现在是我需要的，以防万一有人建议

谢谢

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T16:42:06.337

该`tinymce`参数允许您将配置选项直接传递给 TinyMCE - 请参阅[theme_advanced_buttons](http://www.tinymce.com/wiki.php/Configuration:theme_advanced_buttons_1_n)和[theme_advanced_disable](http://www.tinymce.com/wiki.php/Configuration:theme_advanced_disable)的文档以及[按钮参考](http://www.tinymce.com/wiki.php/Buttons/controls)。

仅显示粗体、斜体和下划线按钮：

```
wp_editor($value, "input...", array(
    'tinymce' => array(
        'theme_advanced_buttons1' => 'bold,italic,underline',
        'theme_advanced_buttons2' => '',
        'theme_advanced_buttons3' => ''
    )
)); 
```

或者，显示*除*粗体、斜体和下划线按钮之外的所有内容：

```
wp_editor($value, "input...", array(
    'tinymce' => array(
        'theme_advanced_disable' => 'bold,italic,underline'
    )
)); 
```

根据要求，您的代码已修改：

```
add_action( 'gform_field_input', 'gforms_wp_editor', 10, 5 );

function gforms_wp_editor( $input, $field, $value, $lead_id, $form_id ) {
    if( $field["cssClass"] == 'richtext' ) {
        ob_start();
        wp_editor( $value, "input_{$form_id}_{$field['id']}",
            array(
                'media_buttons' => false,
                'quicktags'     => false,
                'textarea_name' => "input_{$field['id']}",
                'tinymce'       => array(
                    'theme_advanced_disable' => 'bold,italic,underline'
                )
            )
        );
        $input = ob_get_clean();
    }
    return $input;
} 
```

# jquery - jQuery .hover() 和 .click() 不起作用

> ID：13293351
> 
> 赞同：1
> 
> 时间：2012-11-08T16:32:35.150
> 
> 标签：jquery, html, click, hover

我正在尝试向我的页面的一部分添加一个简单的悬停和单击功能，但它不起作用。我已经做了几百次没有问题，但这次不同，我不知道为什么？

HTML：

```
<div class="description">
    <div id="wrapper">
        <p>bla bla bla</p>
        <div class="linkDesc">
            <a href="#">bla bla bla</a>
        </div>
        <div class="plusSign">&nbsp;</div>
    </div>
</div> 
```

jQuery：

```
jQuery(document).ready(function () {

    $('#wrapper').hover(function () {
        $('this').addClass('hover');
    }, function () {
        $('this').removeClass('hover');
    });
    $('#wrapper').click(function(e) {
        e.preventDefault();
        var urlLocation = $('this').find('.linkDesc').children('a').attr('href');
        window.location = urlLocation;
    });
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T16:34:13.663

```
$('this')   // You have enclosed it as as a string
            // It will try to look for tagName called this 
```

应该

```
$(this)    // Removing the Quotes should work 
```

只有合法`TagNames , classNames , psuedo Selectors and Id's`的应该包含在**引号**中..

**[检查小提琴](http://jsfiddle.net/sushanth009/hQD2P/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:34:24.147

替换`$('this')`为`$(this)`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:21:20.577

如果您只需要添加/删除类，那么您可以使用 css 设置悬停：

```
#wrapper:hover {
    background: red;
} 
```

# arrays - 在 SAS 中定义数组的问题

> ID：13293352
> 
> 赞同：0
> 
> 时间：2012-11-08T16:32:35.710
> 
> 标签：arrays, sas

我正在尝试使用以下代码定义一个数组：

```
data all_dates;
  array arr[*] _temporary_ (1 2 3 4 5);
run; 
```

它给了我这个信息：

```
ERROR: The non-variable based array arr has been defined with zero elements. 
```

查看[文档](http://support.sas.com/documentation/cdl/en/lrdict/64316/HTML/default/viewer.htm#a000201956.htm)示例，我不明白为什么这不起作用。我做错了什么还是不允许这样做？如果不允许，有什么替代的等效方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:35:30.497

啊没关系 - 文档实际上确实说明了：

```
You cannot use the asterisk with _TEMPORARY_ arrays or when you define a multidimensional array. 
```

我想我必须事先计算我需要的元素数量，然后使用：

```
data all_dates;
  array arr[*] a1-a5 (1 2 3 4 5);
  drop a1-a5;
run; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:42:15.873

临时数组的一般解决方案是过度定义临时数组。由于它不在 PDV 中，也没有写出（显然），您可以简单地将其定义为 50 或 100 或任何高于最大值的安全数字 - 这样做几乎不会花费任何性能。

或者，如果“安全数字”对于您所需的内存分配来说太大（例如，数万），请使用宏变量并预先计算数字。鉴于你写了

```
(1 2 3 4 5) 
```

创建此列表时，您应该能够计算所需变量的数量。

# apache - mod_rewrite 国家代码到 URI

> ID：13293357
> 
> 赞同：2
> 
> 时间：2012-11-08T16:32:42.947
> 
> 标签：apache, mod-rewrite, url-rewriting

我需要重定向以下 URL，该 URL 以国家/地区代码开头：

```
http://xx.domain.com/test.html 
```

进入：

```
http://xx.domain.com/xx_en/test.html 
```

我想出了以下内容，当然这会有一个无限循环：

```
RewriteCond %{REQUEST_URI} !/xx_en/ [NC]
RewriteCond %{HTTP_HOST} ^([^.]+)\.domain\.com [NC]
RewriteRule (.*) /%1_en/$1 [R=301,L] 
```

所以我添加了第一行，我认为这意味着如果您在 request_uri 中没有看到 /xx_en/ ，那么请执行以下操作。

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T08:49:51.253

使用类似于以下规则集的内容：

```
RewriteCond %{HTTP_HOST} ^([^\.]+)\.domain\.com$ [NC]
RewriteCond %{REQUEST_URI} !^/%1_en/.*$
RewriteRule ^(.*)$ /%1_en/$1 [R=301,L] 
```

您可以这样理解：对于 domain.com 下所有不以 /<3rd level>_en/ 开头的所有第三级域的请求，都重定向到它...

# sql - 加入海量 CTE 表（13,000,000 行以上）性能问题

> ID：13293359
> 
> 赞同：3
> 
> 时间：2012-11-08T16:32:43.213
> 
> 标签：sql, sql-server, tsql, sql-server-2008-r2, common-table-expression

我们有一个生产数据库，可以提前数年管理 100 家分支机构的人员预订，准确度达到分钟级。

该系统的一部分是突出显示差距的报告，即比较分行营业时间和员工预订，以查看是否有任何分行营业而无人预订。

它还同时检查重叠、重复预订等，基本上需要分钟级的准确性。

我们这样做的方式是使用整数计数表将开放时间和预订的开始和结束时间扩展到分钟：

```
--===== Create and populate the Tally table on the fly
 SELECT TOP 16777216
        IDENTITY(INT,1,1) AS N
   INTO dbo.Tally
   FROM Master.dbo.SysColumns sc1,
        Master.dbo.SysColumns sc2,
        Master.dbo.SysColumns sc3

--===== Add a Primary Key to maximize performance
  ALTER TABLE dbo.Tally
    ADD CONSTRAINT PK_Tally_N 
        PRIMARY KEY CLUSTERED (N) WITH FILLFACTOR = 100 
```

我们利用这个静态索引计数表来扩展开放时间和预订，如下所示：

```
SELECT   [BranchID] ,
        [DayOfWeek] ,
        DATEADD(MINUTE, N - 1, StartTime)
FROM     OpeningHours
        LEFT OUTER JOIN tally ON tally.N BETWEEN 0
                                         AND     DATEDIFF(MINUTE, OpeningHours.StartTime, OpeningHours.EndTime) + 1 
```

问题是，一旦我们有了 13,000,000 个“开放分钟”和“预定分钟”，我们就需要加入结果以查看涵盖的内容：

```
SELECT   OpenDatesAndMinutes.[Date] ,
                                OpenDatesAndMinutes.[Time] ,
                                OpenDatesAndMinutes.[BranchID] ,
                                ISNULL(BookedMinutes.BookingCount, 0) AS BookingCount
                       FROM     OpenDatesAndMinutes
                                LEFT OUTER JOIN BookedMinutes ON OpenDatesAndMinutes.BranchID = BookedMinutes.BranchID
                                                                 AND OpenDatesAndMinutes.[Date] = BookedMinutes.[Date]
                                                                 AND OpenDatesAndMinutes.[Time] = BookedMinutes.[Time] 
```

可以想象，加入分支、日期和时间以及存储在 CTE 表中的 13,000,000 行需要 AGES - 运行一周并不算太糟糕，大约 10 秒，但如果我们运行 6 个月（13,000,000 分钟）会膨胀到25 分钟+

一旦我们将开放时间加入到预定时间，我们就会对岛屿上的数据进行分组并呈现给用户：

```
CrossTabPrep ( [Date], [Time], [BranchID], [BookingCount], [Grp] )
  AS ( SELECT   [Date] ,
                [Time] ,
                [BranchID] ,
                [BookingCount] ,
                DATEPART(HOUR, Time) * 60 + DATEPART(MINUTE, Time) - ROW_NUMBER() OVER ( PARTITION BY [BranchID], Date, [BookingCount] ORDER BY Time ) AS [Grp]
       FROM     PreRender
     ),
FinalRender ( [BranchID], [Date], [Start Time], [End Time], [Duration], [EntryCount], [EntryColour] )
  AS ( SELECT   [BranchID] ,
                [Date] ,
                MIN([Time]) AS [Start Time] ,
                MAX([Time]) AS [End Time] ,
                ISNULL(DATEDIFF(MINUTE, MIN([Time]), MAX([Time])), 0) AS Duration ,
                [BookingCount] AS EntryCount ,
                CASE WHEN [BookingCount] = 0 THEN 'Red'
                     WHEN [BookingCount] = 1 THEN 'Green'
                     ELSE 'Yellow'
                END AS EntryColour
       FROM     CrossTabPrep
       GROUP BY [BranchID] ,
                [Date] ,
                [BookingCount] ,
                [Grp]
     ) 
```

很简单，我的方法有效吗？有什么办法可以改进这种方法，同时保持微小的精度？在处理诸如此类的大量 CTE 表时，将这些数据转储到索引临时表并加入它们是否有任何好处？

我正在考虑的另一件事是替换大连接使用的 DATE & TIME(0) 数据类型，如果我将它们转换为整数会更有效吗？

如果有帮助，这是完整的 CTE：

```
WITH    OpeningHours ( [BranchID], [DayOfWeek], [StartTime], [EndTime] )
          AS ( SELECT   BranchID ,
                        DayOfWeek ,
                        CONVERT(TIME(0), AM_open) ,
                        CONVERT(TIME(0), AM_close)
               FROM     db_BranchDetails.dbo.tbl_ShopOpeningTimes (NOLOCK)
                        INNER JOIN @tbl_Days Filter_Days ON db_BranchDetails.dbo.tbl_ShopOpeningTimes.DayOfWeek = Filter_Days.DayNumber
               WHERE    CONVERT(TIME(0), AM_open) <> CONVERT(TIME(0), '00:00:00')
               UNION ALL
               SELECT   BranchID ,
                        DayOfWeek ,
                        CONVERT(TIME(0), PM_open) ,
                        CONVERT(TIME(0), PM_close)
               FROM     db_BranchDetails.dbo.tbl_ShopOpeningTimes (NOLOCK)
                        INNER JOIN @tbl_Days Filter_Days ON db_BranchDetails.dbo.tbl_ShopOpeningTimes.DayOfWeek = Filter_Days.DayNumber
               WHERE    CONVERT(TIME(0), PM_open) <> CONVERT(TIME(0), '00:00:00')
               UNION ALL
               SELECT   BranchID ,
                        DayOfWeek ,
                        CONVERT(TIME(0), EVE_open) ,
                        CONVERT(TIME(0), EVE_close)
               FROM     db_BranchDetails.dbo.tbl_ShopOpeningTimes (NOLOCK)
                        INNER JOIN @tbl_Days Filter_Days ON db_BranchDetails.dbo.tbl_ShopOpeningTimes.DayOfWeek = Filter_Days.DayNumber
               WHERE    CONVERT(TIME(0), EVE_open) <> CONVERT(TIME(0), '00:00:00')
             ),
        DateRange ( [Date], [DayOfWeek] )
          AS ( SELECT   CONVERT(DATE, DATEADD(DAY, N - 1, @StartDate)) ,
                        DATEPART(WEEKDAY, DATEADD(DAY, N - 1, @StartDate))
               FROM     tally (NOLOCK)
               WHERE    N <= DATEDIFF(DAY, @StartDate, @EndDate) + 1
             ),
        OpenMinutes ( [BranchID], [DayOfWeek], [Time] )
          AS ( SELECT   [BranchID] ,
                        [DayOfWeek] ,
                        DATEADD(MINUTE, N - 1, StartTime)
               FROM     OpeningHours
                        LEFT OUTER JOIN tally ON tally.N BETWEEN 0
                                                         AND     DATEDIFF(MINUTE, OpeningHours.StartTime, OpeningHours.EndTime) + 1
             ),
        OpenDatesAndMinutes ( [Date], [Time], [BranchID] )
          AS ( SELECT   DateRange.[Date] ,
                        OpenMinutes.[Time] ,
                        OpenMinutes.BranchID
               FROM     DateRange
                        LEFT OUTER JOIN OpenMinutes ON DateRange.DayOfWeek = OpenMinutes.DayOfWeek
               WHERE    OpenMinutes.BranchID IS NOT NULL
             ),
        WhiteListEmployees ( [DET_NUMBERA] )
          AS ( SELECT   DET_NUMBERA
               FROM     [dbo].[tbl_ChrisCache_WhiteList]
               WHERE    [TimeSheetV2_SecurityContext] = @TimeSheetV2_SecurityContext
             ),
        BookedMinutesByRole ( [Date], [Time], [BranchID], BookingCount )
          AS ( SELECT   [BookingDate] ,
                        DATEADD(MINUTE, N - 1, StartTime) ,
                        BranchID ,
                        COUNT(BookingID) AS Bookings
               FROM     tbl_Booking (NOLOCK)
                        INNER JOIN tbl_BookingReason  (NOLOCK) ON dbo.tbl_BookingReason.ReasonID = dbo.tbl_Booking.ReasonID
                        INNER JOIN tbl_ChrisCache  (NOLOCK) ON dbo.tbl_Booking.DET_NUMBERA = dbo.tbl_ChrisCache.DET_NUMBERA
                        INNER JOIN @ValidPosCodes AS Filter_PostCodes ON dbo.tbl_ChrisCache.POS_NUMBERA = Filter_PostCodes.POSCODE
                        LEFT OUTER JOIN tally (NOLOCK) ON tally.N BETWEEN 0
                                                                  AND     DATEDIFF(MINUTE, tbl_Booking.StartTime, tbl_Booking.EndTime) + 1
               WHERE    ( Void = 0 )
                        AND tbl_BookingReason.CoverRequired = 0 --#### Only use bookings that dont require cover
                        AND tbl_booking.BranchID <> '023'   --#### Branch 23 will always have messy data
                        AND ( dbo.tbl_Booking.BookingDate BETWEEN @StartDate
                                                          AND     @EndDate )
               GROUP BY [BookingDate] ,
                        BranchID ,
                        DATEADD(MINUTE, N - 1, StartTime)
             ),
        BookedMinutesByWhiteList ( [Date], [Time], [BranchID], BookingCount )
          AS ( SELECT   [BookingDate] ,
                        DATEADD(MINUTE, N - 1, StartTime) ,
                        BranchID ,
                        COUNT(BookingID) AS Bookings
               FROM     tbl_Booking(NOLOCK)
                        INNER JOIN tbl_BookingReason (NOLOCK) ON dbo.tbl_BookingReason.ReasonID = dbo.tbl_Booking.ReasonID
                        INNER JOIN tbl_ChrisCache (NOLOCK) ON dbo.tbl_Booking.DET_NUMBERA = dbo.tbl_ChrisCache.DET_NUMBERA
                        INNER JOIN WhiteListEmployees Filter_WhiteList ON dbo.tbl_Booking.DET_NUMBERA = Filter_WhiteList.DET_NUMBERA
                        LEFT OUTER JOIN tally (NOLOCK) ON tally.N BETWEEN 0
                                                                  AND     DATEDIFF(MINUTE, tbl_Booking.StartTime, tbl_Booking.EndTime) + 1
               WHERE    ( Void = 0 )
                        AND tbl_BookingReason.CoverRequired = 0 --#### Only use bookings that dont require cover
                        AND tbl_booking.BranchID <> '023'   --#### Branch 23 will always have messy data
                        AND ( dbo.tbl_Booking.BookingDate BETWEEN @StartDate
                                                          AND     @EndDate )
               GROUP BY [BookingDate] ,
                        BranchID ,
                        DATEADD(MINUTE, N - 1, StartTime)
             ),
        BookedMinutes ( [Date], [Time], [BranchID], BookingCount )
          AS ( SELECT   [Date] ,
                        [Time] ,
                        [BranchID] ,
                        BookingCount
               FROM     BookedMinutesByRole
               UNION
               SELECT   [Date] ,
                        [Time] ,
                        [BranchID] ,
                        BookingCount
               FROM     BookedMinutesByWhiteList
             ),
        PreRender ( [Date], [Time], [BranchID], [BookingCount] )
          AS ( SELECT   OpenDatesAndMinutes.[Date] ,
                        OpenDatesAndMinutes.[Time] ,
                        OpenDatesAndMinutes.[BranchID] ,
                        ISNULL(BookedMinutes.BookingCount, 0) AS BookingCount
               FROM     OpenDatesAndMinutes
                        LEFT OUTER JOIN BookedMinutes ON OpenDatesAndMinutes.BranchID = BookedMinutes.BranchID
                                                         AND OpenDatesAndMinutes.[Date] = BookedMinutes.[Date]
                                                         AND OpenDatesAndMinutes.[Time] = BookedMinutes.[Time]
             ),
        CrossTabPrep ( [Date], [Time], [BranchID], [BookingCount], [Grp] )
          AS ( SELECT   [Date] ,
                        [Time] ,
                        [BranchID] ,
                        [BookingCount] ,
                        DATEPART(HOUR, Time) * 60 + DATEPART(MINUTE, Time) - ROW_NUMBER() OVER ( PARTITION BY [BranchID], Date, [BookingCount] ORDER BY Time ) AS [Grp]
               FROM     PreRender
             ),
        DeletedBranches ( [BranchID] )
          AS ( SELECT   [ShopNo]
               FROM     [dbo].[vw_BranchList]
               WHERE    [Branch_Deleted] = 1
             ),
        FinalRender ( [BranchID], [Date], [Start Time], [End Time], [Duration], [EntryCount], [EntryColour] )
          AS ( SELECT   [BranchID] ,
                        [Date] ,
                        MIN([Time]) AS [Start Time] ,
                        MAX([Time]) AS [End Time] ,
                        ISNULL(DATEDIFF(MINUTE, MIN([Time]), MAX([Time])), 0) AS Duration ,
                        --dbo.format_timeV2(ISNULL(DATEDIFF(SECOND, MIN([Time]), MAX([Time])), 0)) AS DurationF ,
                        [BookingCount] AS EntryCount ,
                        CASE WHEN [BookingCount] = 0 THEN 'Red'
                             WHEN [BookingCount] = 1 THEN 'Green'
                             ELSE 'Yellow'
                        END AS EntryColour
               FROM     CrossTabPrep
               GROUP BY [BranchID] ,
                        [Date] ,
                        [BookingCount] ,
                        [Grp]
             )
            SELECT  [BranchID] ,
                    CONVERT(VARCHAR(10), DATEADD(DAY, 7, CONVERT(DATETIME, CONVERT(VARCHAR(10), DATEADD(day, -1 - ( DATEPART(dw, [Date]) + @@DATEFIRST - 2 ) % 7, [Date]), 103) + ' 23:59:59', 103)), 103) AS WeekEnding ,
                    [Date] ,
                    [Start Time] ,
                    [End Time] ,
                    [Duration] ,
                    CONVERT(VARCHAR, ( [Duration] * 60 ) / 3600) + 'h ' + CONVERT(VARCHAR, ROUND(( ( CONVERT(FLOAT, ( ( [Duration] * 60 ) % 3600 )) ) / 3600 ) * 60, 0)) + 'm' AS [DurationF] ,
                    [EntryCount] ,
                    [EntryColour] ,
                    CASE WHEN [EntryCount] = 0 THEN 'Red'
                         WHEN [EntryCount] >= 1 THEN 'Green'
                    END AS DurationColour ,
                    CASE WHEN [EntryCount] = 0 THEN 'This period of open-time isnt covered'
                         WHEN [EntryCount] >= 1 THEN 'This period of open-time is covered by ' + CONVERT(VARCHAR, [EntryCount]) + ' booking(s)'
                    END AS [DurationComment]
            FROM    FinalRender
            WHERE   FinalRender.BranchID NOT IN ( SELECT    [BranchID]
                                                  FROM      DeletedBranches ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:02:17.420

这很有趣，因为你最后已经用你的问题回答了你自己的问题。您应该尝试所有这些，但要总结一下：

1.  实现 CTE 以获得更好的性能。您永远不知道 SQL Server 何时会多次评估 CTE
2.  您可以针对临时表构建 indexex。
3.  我不确定你是如何从另一个`[DayOfWeek],DATEADD(MINUTE, N - 1, StartTime)`上跳到加入`[Date],[Time]`的，但是在这里有两列是没有意义的。使用单个`datetime`或 bigint 表示`seconds`来自一个纪元。UnixTimestamp 在这里运行良好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T23:48:08.850

我的建议不是基于你的数据，而是基于生成的测试数据，所以不能完全适用。

建议：为了从性能的二次退化转变为至少线性退化，可以使用批处理，如果数据在批处理期间平均分布。

在下面的示例中，以 3 天的批处理间隔处理 2 年的预订，每个分店每天需要 2 分 30 秒才能恢复免费时间。

试运行结果：

```
2 years - 2 minutes and 30 seconds 
4 years - 4 minutes and 55 seconds.
6 years - 6 minutes and 41 seconds 
```

它通过使用数字来查找不匹配的分钟数，结合了正在使用的相同逻辑。

模式和测试数据创建：

```
 IF OBJECT_ID('vwRandomNumber') IS NOT NULL
        DROP VIEW vwRandomNumber
    GO
    IF OBJECT_ID('dbo.fnRandNumber') IS NOT NULL
    DROP FUNCTION  dbo.fnRandNumber
    GO
    IF OBJECT_ID('dbo.fnRandomInt') IS NOT NULL
    DROP FUNCTION dbo.fnRandomInt
    GO
    IF OBJECT_ID('tblNumbers') IS NOT NULL
    DROP TABLE dbo.tblNumbers
    GO
    IF OBJECT_ID('Branches') IS NOT NULL
    DROP TABLE Branches
    GO
    IF OBJECT_ID('OpeningHours') IS NOT NULL
    DROP TABLE OpeningHours
    GO
    IF OBJECT_ID('Bookings') IS NOT NULL
    DROP TABLE Bookings
    GO

    CREATE VIEW vwRandomNumber
    AS
    SELECT Rand() RandomNumber;
    GO

    CREATE FUNCTION dbo.fnRandNumber()
    RETURNS FLOAT
    AS
    BEGIN
      RETURN (SELECT TOP 1 RandomNumber FROM vwRandomNumber)
    END;
    GO

    CREATE FUNCTION dbo.fnRandomInt(@FromNumber INT, @ToNumber INT)
    RETURNS INT
    AS
    BEGIN
      RETURN (@FromNumber + ROUND(dbo.fnRandNumber()*(@ToNumber - @FromNumber),0))
    END;
    GO

    CREATE TABLE tblNumbers 
    (
       NumberID INT PRIMARY KEY 
    )

    CREATE TABLE Branches
    (
       BranchID INT
      ,BranchName NVARCHAR(100)
    );
    GO

    ;WITH cteNumbers AS (
      SELECT 1 N 
      UNION ALL
      SELECT N+1 FROM cteNumbers WHERE N<100
    )
    INSERT INTO
        Branches
    SELECT N, CAST(NEWID() AS NVARCHAR(100)) FROM cteNumbers
    OPTION(MAXRECURSION 0)

    CREATE TABLE OpeningHours
    (
        BranchID INT 
      , Date DATETIME
      , OpenFrom DATETIME
      , OpenTo DATETIME 
    );
    GO

    CREATE CLUSTERED INDEX CIX_OpeningHours
    ON OpeningHours ([Date], [BranchID])

    GO

    CREATE TABLE Bookings
    (
         BranchID INT
       , BookingDate DATETIME
       , BookingFrom DATETIME
       , BookingTo DATETIME  
    )

    CREATE CLUSTERED INDEX CIX_Bookings
    ON Bookings ([BookingDate],[BranchID])

    DECLARE @StartDate DATETIME = DATEADD(month,0,DATEADD(D,0,DATEDIFF(d,0,GETDATE())))

    ;WITH cteNumbers AS (
      SELECT 1 N 
      UNION ALL
      SELECT N+1 FROM cteNumbers WHERE N<2000
    )
    INSERT INTO
      OpeningHours
      (
          BranchID
        , Date
        , OpenFrom
        , OpenTo
      )
    SELECT
      Branches.BranchID
    , Dates.Day
    , DATEADD(hour,7,Dates.Day)
    , DATEADD(hour,19,Dates.Day)
    FROM
      (
        SELECT 
          DATEADD(d,N,@StartDate) Day
        FROM
          cteNumbers
      ) Dates
    CROSS JOIN
      Branches
    OPTION(MAXRECURSION 0);

    INSERT INTO Bookings
    SELECT 
       OpeningHours.BranchID
      ,OpeningHours.Date
      ,BookingHours.StartDate
      ,BookingHours.ToDate
    FROM
      OpeningHours
    CROSS APPLY
      (
         SELECT DATEADD(hour, dbo.fnRandomInt(0,3), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(4,9), OpeningHours.OpenFrom) ToDate UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(1,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(6,9), OpeningHours.OpenFrom) UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(2,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(5,8), OpeningHours.OpenFrom) TODate UNION ALL
          SELECT DATEADD(hour, dbo.fnRandomInt(0,3), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(4,9), OpeningHours.OpenFrom) ToDate UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(1,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(6,9), OpeningHours.OpenFrom) UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(2,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(5,8), OpeningHours.OpenFrom) TODate UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(0,3), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(4,9), OpeningHours.OpenFrom) ToDate UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(1,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(6,9), OpeningHours.OpenFrom) UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(2,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(5,8), OpeningHours.OpenFrom) TODate UNION ALL
          SELECT DATEADD(hour, dbo.fnRandomInt(0,3), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(4,9), OpeningHours.OpenFrom) ToDate UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(1,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(6,9), OpeningHours.OpenFrom) UNION ALL
         SELECT DATEADD(hour, dbo.fnRandomInt(2,5), OpeningHours.OpenFrom) StartDate
                ,DATEADD(hour, dbo.fnRandomInt(5,8), OpeningHours.OpenFrom) TODate 
      ) BookingHours;

    ;WITH cteNumbers AS (
      SELECT 1 N 
      UNION ALL
      SELECT N+1 FROM cteNumbers WHERE N<5000
    )
    INSERT INTO
        tblNumbers
    SELECT N FROM cteNumbers
    OPTION(MAXRECURSION 0)

    --SELECT COUNT(*) FROM Bookings WHERE 
```

获取无预订时段的脚本：

```
 SET NOCOUNT ON

    IF OBJECT_ID('tblBranchFreePeriods') IS NOT NULL
        DROP TABLE tblBranchFreePeriods

    IF OBJECT_ID('tblFreeMinutes') IS NOT NULL
        DROP TABLE tblFreeMinutes

    CREATE TABLE tblBranchFreePeriods
    (
          BranchID INT
        , Date DATETIME
        , PeriodStartDate DATETIME
        , PeriodEndDate DATETIME
    )

    CREATE TABLE tblFreeMinutes 
    (
         BranchID INT 
        ,Date DATETIME
        ,FreeMinute INT
    )

    IF OBJECT_ID('dbo.tblStartDates') IS NOT NULL
                DROP TABLE tblStartDates

    CREATE TABLE tblStartDates
    (
          BranchID INT
        , Date DATETIME 
        , PeriodStartDate DATETIME
    )

    CREATE CLUSTERED INDEX CIX_tblStartDates
        ON tblStartDates([BranchID],[Date])

    IF OBJECT_ID('dbo.tblEndDates') IS NOT NULL
        DROP TABLE tblEndDates

    CREATE TABLE tblEndDates
    (
          BranchID INT
        , Date DATETIME 
        , PeriodEndDate DATETIME
    )

    CREATE CLUSTERED INDEX CIX_tblEndDate
        ON tblEndDates ([BranchID],[Date])

    CREATE CLUSTERED INDEX CIX_tblFreeMinutes
        ON tblFreeMinutes ([BranchID],[Date],FreeMinute)

    DECLARE @ProcessFromDate DATETIME, @ProcessTo DATETIME
    SELECT @ProcessFromDate = MIN(OpenFrom), @ProcessTo = DATEADD(year,2,@ProcessFromDate) FROM OpeningHours 

    DECLARE @BatchSize INT = 3

    DECLARE @StartTime DATETIME = GETDATE()

    WHILE (@ProcessFromDate <= @ProcessTo) BEGIN

            TRUNCATE TABLE tblFreeMinutes
            TRUNCATE TABLE tblStartDates
            TRUNCATE TABLE tblEndDates

            SET @StartTime = GETDATE()              

            DECLARE @DateFrom DATETIME = @ProcessFromDate, @DateTo DATETIME = DATEADD(d,@BatchSize,@ProcessFromDate)

            PRINT 'Date From ' + CAST(@DateFrom AS NVARCHAR(50))
            PRINT 'Date To ' + CAST(@DateTO AS NVARCHAR(50))

            INSERT INTO
                tblFreeMinutes
            SELECT
                OpeningHours.BranchID
               ,OpeningHours.Date
               ,tblOpeningHourMinutes.NumberID Minute   
            FROM
                OpeningHours
            INNER JOIN
              tblNumbers tblOpeningHourMinutes
            ON
                NumberID 
                    BETWEEN DATEDIFF(minute,OpeningHours.Date,OpeningHours.OpenFrom)
                AND
                    DATEDIFF(minute,OpeningHours.Date,OpeningHours.OpenTo)
            LEFT OUTER JOIN
               Bookings
            ON
                    Bookings.BookingDate = OpeningHours.Date   
                AND
                    Bookings.BranchID = OpeningHours.BranchID 
                AND
                    tblOpeningHourMinutes.NumberID
               BETWEEN
                   DATEDIFF(minute,Bookings.BookingDate,Bookings.BookingFrom)
               AND
                   DATEDIFF(minute,Bookings.BookingDAte,Bookings.BookingTo)              
            WHERE
               OpeningHours.Date BETWEEN @DateFrom AND @DateTo
            AND
               Bookings.BookingDate IS NULL
            OPTION ( FORCE ORDER )

            PRINT 'Populate free minutes ' + CAST(DATEDIFF(millisecond,@StartTime,GETDATE()) AS NVARCHAR(50))
            SET @StartTime = GETDATE()

            INSERT INTO
                tblStartDates
            SELECT 
                  tblFreeMinutes.BranchID
                , tblFreeMinutes.Date
                , DATEADD(minute,tblFreeMInutes.FreeMinute,tblFreeMinutes.Date)
            FROM
                tblFreeMinutes
            LEFT OUTER JOIN
                tblFreeMinutes tblFreeMinutesIn  
            ON
                tblFreeMinutesIn.Date = tblFreeMinutes.Date
            AND
                tblFreeMinutesIn.BranchID = tblFreeMinutes.BranchID
            AND
                tblFreeMinutesIn.FreeMinute = tblFreeMinutes.FreeMinute-1
            WHERE
                tblFreeMinutesIn.BranchID IS NULL

            PRINT 'Populate start dates ' + CAST(DATEDIFF(millisecond,@StartTime,GETDATE()) AS NVARCHAR(50))
            SET @StartTime = GETDATE()

            INSERT INTO
                tblEndDates
            SELECT 
                  tblFreeMinutes.BranchID
                , tblFreeMinutes.Date
                , DATEADD(minute,tblFreeMInutes.FreeMinute,tblFreeMinutes.Date)
            FROM
                tblFreeMinutes
            LEFT OUTER JOIN
                tblFreeMinutes tblFreeMinutesIn  
            ON
                tblFreeMinutesIn.Date = tblFreeMinutes.Date
            AND
                tblFreeMinutesIn.BranchID = tblFreeMinutes.BranchID
            AND
                tblFreeMinutesIn.FreeMinute = tblFreeMinutes.FreeMinute+1
            WHERE
                tblFreeMinutesIn.BranchID IS NULL

            PRINT 'Populate end dates ' + CAST(DATEDIFF(millisecond,@StartTime,GETDATE()) AS NVARCHAR(50))
            SET @StartTime = GETDATE()

            INSERT INTO
                tblBranchFreePeriods
            SELECT 
                  tblStartDates.BranchID
                , tblStartDates.Date
                , tblStartDates.PeriodStartDate
                , tblEndDate.PeriodEndDate 
            FROM 
                tblStartDates 
            CROSS APPLY
                (
                    SELECT TOP 1 
                        *
                    FROM
                        tblEndDates
                    WHERE
                        tblEndDates.BranchID = tblStartDates.BranchID
                    AND
                        tblEndDates.Date = tblStartDates.Date
                    AND
                        tblEndDates.PeriodEndDate > tblStartDates.PeriodStartDate
                    ORDER BY
                        PeriodEndDate ASC
                ) tblEndDate

            PRINT 'Return intervals ' + CAST(DATEDIFF(millisecond,@StartTime,GETDATE()) AS NVARCHAR(50))
            SET @StartTime = GETDATE()

            SET @ProcessFromDate = DATEADD(d,@BatchSize+1,@ProcessFromDate)

            PRINT ''
            PRINT ''

            RAISERROR ('',0,0) WITH NOWAIT

            --SELECT * FROM tblBranchFreePeriods

           --BREAK      
    END

    SELECT 
        *
    FROM
        tblBranchFreePeriods
    ORDER BY
        1,2,3 
```

# delphi - 如何添加或删除 actionMenuBar 的 windowMenu 选项

> ID：13293363
> 
> 赞同：2
> 
> 时间：2012-11-08T16:32:52.947
> 
> 标签：delphi

我想知道，如何添加或删除 actionMenuBar 组件的 windowMenu 选项，我有一个 mdi 应用程序我可以添加该选项但后来我无法删除它

对不起我的英语

我有这个：

```
 //add windowmenu and works fine       
   procedure TForm2.Button1Click(Sender: TObject);
   begin
    Form1.ActionMainMenuBar1.WindowMenu := '&Ventana';
   end;

   //remove windowmenu but dont work
   procedure TForm2.Button2Click(Sender: TObject);
   begin
    Form1.ActionMainMenuBar1.WindowMenu := '';
   end; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T18:36:22.950

```
type
  ActionMainMenuBarAccess = class(TActionMainMenuBar);

procedure TForm2.Button2Click(Sender: TObject);
begin
  ActionMainMenuBar1.WindowMenu := '';
  ActionMainMenuBarAccess(ActionMainMenuBar1).FWindowMenuItem := nil;
  ActionMainMenuBarAccess(ActionMainMenuBar1).RefreshMDIMenu;
end; 
```

另请参阅此[QualityCentral 报告](http://qc.embarcadero.com/wc/qcmain.aspx?d=20278)。

# c# - 在javascript中添加剃刀语句

> ID：13293369
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:33:07.523
> 
> 标签：c#, javascript, razor

我试图在我的 javascript 中添加一些 C# 代码。但我无法将我的 var 名称解析为 C# 代码。

我想要的是这样的：

```
$.ready(function(){
   var name = $("#input");

   @Class.text(name)
}); 
```

但它不允许我解析名称。

这是我得到的一个简短版本，@Class 代表一个更复杂的函数

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:45:07.753

语法确实不正确。

是`var name = $("#input");`javascript。它在文档加载后在客户端执行。`@Class`是服务器端，在生成页面时执行。

您不能在 C# 中使用 javascript 变量。你想达到什么目标；可能有不同的方法可以做到这一点。

-- 更新：您正在尝试从 javascript 调用 ac# 方法。

总的来说，这将需要发回服务器 - 请参阅 [http://blog.bobcravens.com/2009/11/ajax-calls-to-asp-net-mvc-action-methods-using-jquery/](http://blog.bobcravens.com/2009/11/ajax-calls-to-asp-net-mvc-action-methods-using-jquery/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T19:11:17.487

@MichaelTotKorsgaard根据我们在您问题评论中的讨论，我想我现在明白了。不幸的是，您尝试做的事情根本行不通。它不是那样工作的。您执行 AJAX/JSON 的原因是，一旦 C#/MVC/ASP.NET 返回 HTML（它实际上并不知道它返回的内容是否有效），由客户端来“处理”它。这就是 Javascript 的用武之地。但是服务器端 MVC 和客户端 JS 实际上并不了解彼此。您需要 1) 回发或 2) 使用 AJAX。

是时候准备好并学习如何去做了:)

如果您提供有关您实际尝试完成的更多详细信息（例如您尝试从 JS/AJAX 加载的内容），那么我相信 SO 可以为您提供更多信息，让您走上正确的道路。

# java - AJAX 与表单提交

> ID：13293375
> 
> 赞同：16
> 
> 时间：2012-11-08T16:33:29.970
> 
> 标签：java, ajax, struts, form-submit

我们从服务器中提取数据，如果我们使用 Struts，那么我们可以通过提交一个**MVC 架构**的页面来提取数据，或者我们可以进行**AJAX 调用**，但约定是使用表单和呈现响应，但我们也面临着提供丰富的挑战用户体验，所以我们妥协约定，开始使用过多的AJAX，那么我们应该如何在两者之间取得平衡呢？

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-11-08T16:54:04.950

我个人认为 AJAX 应该用于显示更新，而表单提交应该通过页面重新加载来完成。推理？

提交表单时，您是在告诉应用程序做某事。用户往往希望感觉它已经完成。当页面没有重新加载时，用户通常会想知道“这有效吗？”。然后他们必须检查以确保他们所做的事情是正确的。

另一方面，当您显示图表或其他内容时，例如，当用户说“显示 2011 年数据……现在是 2012 年数据”时，他们并没有“做”某事（创建新实体、发送电子邮件、 ETC）。所以 AJAX 在这种情况下可以提供一个很好的用户界面。页面重新加载在这里会很烦人。

总之，我认为表单提交应该通过页面重新加载（让用户看到它工作）来完成，而显示更新应该使用 AJAX（防止烦人的页面重新加载）。

当然，这是一种偏好。我公司的一些应用程序完全使用 AJAX。但这些是最难维护和调试的应用程序。;)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-08T16:41:10.760

常规的旧 HTML 表单提交和花哨的 ajax 表单并不相互排斥。

首先，使纯 HTML 表单正常工作。然后，添加 javascript 来劫持表单并发送 ajax 请求。

控制器和模型不关心用户的浏览器是否支持（或启用）javascript。呈现的视图取决于调用是使用 javascript 还是简单的表单提交。这是 MVC 模式的优势之一，而不是约束。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-08T16:44:26.403

我认为两者之间的选择有些内在：

*   表单提交是同步的，它会重新加载页面。

*   ajax 调用是异步的，它不会重新加载页面。

如果某个动作会改变很多 UI 元素或者需要轮询大量数据来呈现，我会选择表单提交。另一方面，如果某个操作用于简单操作，例如填充选择框或改善用户体验，那么我会选择 AJAX 调用。

没有什么可以避免您根据需要使用尽可能多的 ajax 调用或表单提交，所以最终取决于您。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-08T16:36:41.523

如果您在提交数据之间有错误，您可以在服务器上检查唯一的表单方法。另一方面，如果您进行 Ajax 调用，您可以在客户端检查错误。因此，在这些不同的数据传输技术中，我们可以决定它们服务于不同的目的。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2019-02-19T00:11:04.053

在这个时代，几乎没有使用旧标准 HTML 表单提交方法的情况*（除了纯粹的怀旧，或者可能不知道）*。

> `<form>`如果您想利用[.serialize()](https://stackoverflow.com/questions/15173965/serializing-and-submitting-a-form-with-jquery-and-php)函数（它将表单中的*所有名称-数据对抓取到查询字符串中）* ，标签本身仍然很有用，但除此之外，我们不需要`<form>`在这些天。

使用 AJAX，开发人员可以在更精简的代码库中更好地控制整个过程。但更重要的是，***我们不再那样做事了。***

考虑：

（旧样式 - 表单）当 HTML 表单提交时：（a）它收集表单字段`name=`属性值*（这些成为事实上的变量名称）*（b）连同用户在表单字段中输入的数据*（成为变量值）* , 并将这些数据对发布到 PHP 文件（在`action=`form 标签的属性中指定）。***然后，该页面更改***为另一个页面，导致屏幕明显刷新并丢失所有先前输入的用户数据。即使使用技巧`action=""`，其中表单数据被回发到它开始的同一页面，页面仍然被重置/刷新。

（新样式）完全相同的过程[可以很容易地使用 javascript/jQuery 进行编程](https://stackoverflow.com/a/6960586/1447509)——*除了页面不刷新。*所有先前输入的用户数据/文本都可以保持不受干扰。

回到你的问题：

使用旧式 HTML 表单提交时，页面会发生变化 - 因此，如果您想进行字段验证*，您可以使用 javascript/jQuery 切入提交过程，因此：*

```
$('myform#btnSubmit').click(function(){
    var some_fields_failed = false;
    //check form field values here, set: some_fields_failed = true
    if (some_fields_failed){
       return false; //halts the HTML Form Submit process and returns control to the user
    }
}); 
```

*在这种情况下，您已经在使用大部分将替换 HTML 表单提交过程的 AJAX 构造。*

[这个对 AJAX 的简单介绍](https://www.w3schools.com/xml/ajax_intro.asp)为使用 AJAX 而不是旧式 HTML 表单提交过程提供了一些令人信服的理由：

> AJAX 是开发人员的梦想，因为您可以：
> 
> 在不重新加载页面的情况下更新网页
> 从服务器请求数据 - 在页面加载之后
> 从服务器接收数据 - 在页面加载之后
> 将数据发送到服务器 - 在后台

* * *

请注意，您可以用纯 javascript 编写 ajax 代码，但直到最近，使用 jQuery (javascript) 库要简单得多（输入更少，更一致）。因此，上面的所有示例都使用 jQuery。*要在您的项目中包含 jQuery，只需包含对 jQuery 库的引用：*

```
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
</head> 
```

StackOverflow maven, [Schabse Laks](https://stackoverflow.com/users/34397/slaks) , 创建了一个[简单的 jQuery 教程](http://jqpresentation.slaks.net/Demos/Introducing-jQuery/#)，值得单步*执行（重要提示：使用向下箭头单步浏览页面）*

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-11-11T17:48:16.247

使用 AJAX 发送表单时，您会生成 POST 请求而不是浏览器，因此您可以更好地控制它。即使您一开始就不需要这种控制，但随着时间的推移，它可能会变得有必要。

一种情况是保护表单免受 CSRF 攻击。它可以通过添加一个包含 CSRF 令牌的隐藏表单输入字段来实现，该令牌与表单数据一起发送。但首选的实现是向提交的 POST 请求添加自定义标头。但是，当使用旧的表单提交方法时，您不能执行后者 - 浏览器编写请求并且您无法添加自己的标头。

# php - 批量点对点邮政编码距离

> ID：13293378
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:33:32.020
> 
> 标签：php, mysql, maps, distance

我有一个包含纬度和经度的邮政编码数据库。我正在构建一个加载板，每 10 分钟我们会收到大约 300 个带有起始和目的地邮政编码的负载。由此我们需要计算每个负载的起始和目的地之间的距离。如果我们的负载不是这么多，我们会使用谷歌地图来查询他们中的每一个。Mapquest 有一个批处理 routeMatrix，可以让我们一次做 25 个点。我们尝试了哈弗斯公式，但由于这是一个直线计算，它通常偏离很多英里。

有没有我们可以实施的解决方案，不会导致过度使用服务器资源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:53:33.820

当您可以交错查询并用完单个方向可以容纳的所有航点时，您可以通过 google 方向有效地获得更多信息。一个方向可以容纳 24 个航路点，因此每天有 600/24 = 25 个查询和 24*6*25 = 3600 个查询。我想这类似于 mapquest 批处理路由矩阵。此外，您可以将结果保存在数据库中。

# wix - 单击btn时在wix中打开txt文件

> ID：13293382
> 
> 赞同：1
> 
> 时间：2012-11-08T16:33:43.837
> 
> 标签：wix, wix3.6

我有一个 wix 项目，我在其中添加了一个自定义窗口，用于检查运行应用程序所需的依赖项。该窗口出现在许可协议之后。一切正常，通过自定义操作检查依赖关系，如果 Windows 安装程序高于版本 5，则会出现指向官方网站的超链接。

如果版本较低，我想单击 btn“显示依赖项”并显示带有链接的 txt 文件。我在打开记事本和包含文件的属性下面有自定义操作。

代码：

```
<Property Id="FXDEP" Value="$(sys.CURRENTDIR)\Resources\Files\FxDependencies.txt" />
<Property Id='NOTEPAD'>NOTEPAD.EXE</Property>
<CustomAction Id='LaunchDependencies' Property='NOTEPAD' ExeCommand='[FXDEP]' Return='asyncNoWait' /> 
```

问题是在开发机器上它可以工作，因为它找到了路径，但在其他机器上它当然会失败。我应该如何告诉 wix 维护这个文件并打开它？

我尝试将文件放入

```
<Binary Id="FxDependencies.txt" SourceFile="$(sys.CURRENTDIR)\Resources\Files\FxDependencies.txt" /> 
```

但自定义操作无法识别它。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-11T09:43:43.317

您似乎正在尝试打开位于安装源中的文件。`FxDependencies.txt`和使用相同的值`FXDEP`。

您的具有依赖关系的文本文件位于`Binary`安装程序的表中，要使用它，您必须将其解压缩到一个临时目录中，然后启动记事本来显示它。

为此，您必须编写几个自定义操作：

1.  第一个 CA 将文件提取到临时目录中，并将路径保存到属性中，`FXDEPTEMPPATH`.
2.  第二个 CA 用于`FXDEPTEMPPATH`在记事本中显示它。

`FxDependencies.txt`另一种选择是编写一个小型应用程序 (.exe)，例如在资源中包含您的 . 您将此 .exe 添加到 MSI 的二进制表中，然后从安装程序中启动它而不是记事本。在这种情况下，MSI 会自动将 exe 提取到一个临时目录并启动它。在您的应用程序中，通过从资源中提取信息，在临时目录中创建一个新的文本文件，然后启动记事本来显示它。

* * *

**编辑：**有多种方法可以*从 Binary table 读取文件*。有关示例，请参见以下链接：

*   [`BinaryWrite`](http://code.dblock.org/Source/msiext/1.2/Docs/_msi_binary_8h.html#ae1b642e8fa3ad62c069a7a76eb90f688)来自[Msiext](http://dblock.github.com/msiext/)。
*   从基于 WiX 源代码[的二进制表中读取。](http://blogs.msdn.com/b/icumove/archive/2009/06/23/custom-action-using-wix-reading-from-the-binary-table.aspx)
*   [从二进制表流式传输文件](http://www.installsite.org/pages/en/msi/ca.htm#MyStreamFileFromBinary)。
*   自己写代码：
    *   [`MsiGetActiveDatabase`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370110%28v=vs.85%29.aspx)使用和打开活动数据库的数据库视图[`MsiDatabaseOpenView`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370082%28v=vs.85%29.aspx)；
    *   用 读取二进制流[`MsiRecordReadStream`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370370%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-10T14:18:17.373

我建议您在自定义操作中创建文件夹。所以，

1.  验证先决条件
2.  检查 Windows 安装程序版本
3.  如果版本小于 5，则调用自定义操作来创建文件夹 ( `$(sys.CURRENTDIR)\Resources\Files\`)
4.  然后单击按钮，您可以调用自定义操作来启动 txt 文件

# javascript - 构造函数 javascript 中的条件

> ID：13293394
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:34:17.890
> 
> 标签：javascript, class, constructor, conditional-statements, angle

我想在构造函数中为角度添加条件`if(angle>360){ angle=0; }`怎么办？

```
PLAYER[i] = {
    color: "#fff",
    x: 220*i,
    y: 270,
    width: 32,
    height: 32,
    angle: 180
}; 
```

每次使用这样的条件，都会占用很大的空间。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T16:37:31.863

这不是构造函数——只是对象的初始化。但没关系。使用三元运算符：`angle: (angle > 360 ? 0 : angle)`

# jsf-2 - 会话和视图范围的 bean - 被覆盖的值

> ID：13293398
> 
> 赞同：0
> 
> 时间：2012-11-08T16:34:25.003
> 
> 标签：jsf-2

```
@SessionScoped
public SessionClass{

    // Buyer is a view scoped class
    private List<Buyer> sessionObject = new ArrayList<Buyer>();
} 
```

更新输入字段buyer.fname 时。该列表也已更新。我是否也应该将购买者类更改为会话范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T19:43:56.667

这与 JSF 范围无关，而是与 Java 的面向对象特性有关。显然，视图范围`Buyer`实例表示与会话范围 bean 列表中的项目完全相同的**引用**（但是，您如何编码它超出了我的范围；如果`Buyer`它实际上是一个 JPA 实体，那将是可以解释的）。

如果它确实是 JPA 实体，您应该创建`Buyer`实例的副本或分离实体。

# php - 视图中的 IF 语句未触发

> ID：13293399
> 
> 赞同：0
> 
> 时间：2012-11-08T16:34:25.817
> 
> 标签：php, codeigniter

所以我在我的控制器中有这个代码块（我知道，数据库的东西应该在模型中......一旦工作我会把它转移到那里）。在数据库中搜索“订阅”并在视图中回显。这样可行。但是，在我看来，我想添加一个 IF 语句，如下面的第二个代码块 - 但它不起作用。建议？换句话说，您将如何在视图中编写 IF 语句？很确定`query`部分是不正确的......

```
 // displays current subscription in view
    $userid = $this -> session -> userdata('user_id');

    $this -> db -> select('subscription');
    $this -> db -> where ('id', $userid);
    $query = $this -> db -> get('subscriptions');

    if($query -> result() == TRUE) // if subscription exists for user, display:
    {
        foreach ($query->result() as $row)
        {
            $data['packagename'] = $row->subscription;
        } 
    } 
```

鉴于：

```
 <?php if($query -> result() == TRUE) : ?>
    <? echo $packagename; ?>
    <?php endif ?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:38:19.583

`$query->result()`不返回布尔值，它返回一个数组 ob 对象。

要检查查询是否返回结果，请使用`num_rows()`.

```
if($query->num_rows() > 0){
    foreach ($query->result() as $row){
    }
} 
```

此外，您不应将`$query`对象传递给视图，而应使用`isset`查看变量是否存在：

```
<?php if(isset($packagename)): ?>
    <?php echo $packagename; ?>
<?php endif ?> 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-08T16:39:07.973

让您的数据库逻辑远离您的视图，这就是模型的用途。如果您已经将 $packagename 传递到您的视图中，为什么不简单地对其进行测试呢？

```
<?php if ( isset($packagename) ) : ?>
    <? echo $packagename; ?>
<?php endif; ?> 
```

或者，如果您可以使用 short_open_tags：

```
<? if ( isset($packagename) ) : ?>
    <?= $packagename ?>
<? endif; ?> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:41:47.857

根据我从您的代码中看到的内容，我感觉您认为您在控制器中使用的任何变量都会自动在您的视图中可用。不是这种情况。您应该设置变量并在控制器中执行您的逻辑，并将您想要显示的内容传递给您的视图。

这就是您的控制器的外观：

```
// displays current subscription in view
$userid = $this -> session -> userdata('user_id');

$this -> db -> select('subscription');
$this -> db -> where ('id', $userid);
$query = $this -> db -> get('subscriptions');

if($row = $query -> result()) // if subscription exists for user, display:
{
        $data['packagename'] = $row->subscription;
}

$this->load->view("yourview", $data); 
```

您不需要 a `foreach`，因为您通过 ID 提取 - 您只需要一条记录。

然后，在您看来，只需像这样显示它：

```
<?php if (!empty($packagename)) echo $packagename;?> 
```

# java - 创建线程以打印出消息

> ID：13293409
> 
> 赞同：1
> 
> 时间：2012-11-08T16:34:55.990
> 
> 标签：java, multithreading

不确定我是否做对了。我需要创建一个新线程来写出一定次数的消息。我认为这到目前为止有效，但不确定它是否是最好的方法。然后我需要在线程完成运行后显示另一条消息。我怎么做 ？使用 isAlive() 吗？我该如何实施？

```
public class MyThread extends Thread {

    public void run() {
        int i = 0;
        while (i < 10) {
            System.out.println("hi");
            i++;
        }
    }

    public static void main(String[] args) {
        String n = Thread.currentThread().getName();
        System.out.println(n);
        Thread t = new MyThread();
        t.start();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:37:45.493

到现在为止，你都走上了正轨。现在，要显示另一条消息，当该线程完成时，您可以从主线程调用[`Thread#join`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/Thread.html#join%28%29)该线程。`InterruptedException`当您使用`t.join`方法时，您还需要处理,

然后，当您的线程`t`完成时，您的主线程将继续。所以，像这样继续你的主线程： -

```
t.start();
try {
    t.join();
} catch (InterruptedException e) {
    e.printStackTrace();
}
System.out.println("Your Message"); 
```

当您`t.join`在特定线程（此处为主线程）中调用时，该线程将继续其进一步执行，仅当线程`t`完成执行时。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:46:35.770

扩展`Thread`类本身通常不是一个好习惯。

您应该`Runnable`按如下方式创建接口的实现：

```
public class MyRunnable implements Runnable {

    public void run() {
        //your code here
    }
} 
```

并将它的实例传递给线程，如下所示：

```
MyRunnable r = new MyRunnable();
Thread t = new Thread(r);
t.start(); 
```

* * *

请在此处查看此答案：[Implementing Runnable vs. extended Thread](https://stackoverflow.com/a/2782762/738746)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:55:31.430

这就是你可以做到的......

```
class A implements Runnable
{
    public void run()
    {
    for(int i=1;i<=10;i++)
    System.out.println(Thread.currentThread().getName()+"\t"+i+"  hi");
    }
}
class join1
{
public static void main(String args[])throws Exception
    {
    A a=new A();
    Thread t1=new Thread(a,"abhi");
    t1.start();
    t1.join();
    System.out.println("hello this is me");//the message u want to display
    }
} 
```

查看 join() 加入的详细 [信息](http://docs.oracle.com/javase/tutorial/essential/concurrency/join.html)

# iphone - ASINetworkQueue 中的 ASIHTTPRequest：队列运行时取消请求

> ID：13293410
> 
> 赞同：0
> 
> 时间：2012-11-08T16:35:01.043
> 
> 标签：iphone, ios, asihttprequest, nsoperation, nsoperationqueue

我正在使用 ASIHTTPRequest（我知道，我知道，它没有被维护 - 没关系；它可以工作，并且它是我的应用程序所构建的）通过 ASINetworkQueue 运行一系列 HTTP 请求。

问题是我的队列会有很多请求（数千个），并且需要一段时间才能运行。在它运行的时候，应用程序中的一些数据可能已经改变，这会使一些请求变得不必要。我想在每个请求运行之前对其运行一个验证方法，如果验证方法没有检出，那么它将取消该请求并继续下一个请求。

现在，我正在使用以下代码来创建我的 ASIHTTPRequests：

```
ASINetworkQueue *myQueue = [ASINetworkQueue queue];
NSURL *URL = [NSURL URLWithString:@"http://mywebsite.com"];
ASIHTTPRequest *request = [ASIHTTPRequest requestWithURL:url];
[request setStartedBlock:^{
    NSLog(@"Request started: %@", request.url.absoluteString);
}];
[request setCompletionBlock:^{
    NSLog(@"Request completed: %@", request.url.absoluteString);
    // do some code here to clean up since it's finished
}];
[myQueue addOperation:request]; 
```

我目前的想法是在startedBlock中放入一些东西，所以它会这样做：

```
[request setStartedBlock:^{
    NSLog(@"Request started");
    if (![self myValidationMethod]) {
        [request cancel]; // <----------
    }
}]; 
```

但是，当我这样做时，我从 Xcode 收到以下警告：“在此块中强烈捕获'请求'可能会导致保留周期。”

首先，这是正确的方法吗？我似乎找不到从 ASINetworkQueue 中删除特定 ASIHTTPRequest 的方法。其次，我需要担心来自 Xcode 的这个警告吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:32:53.013

关于您捕获块“容器”并形成循环的警告......只需说：

```
__weak ASIHTTPRequest *rw = request; 
```

并在块中使用它。

至于开始的块方法。对我来说听起来并不完美，但我不知道更好的方法......

# c++ - Xcode 选项卡切换 cmd+1 2 3

> ID：13293414
> 
> 赞同：1
> 
> 时间：2012-11-08T16:35:27.720
> 
> 标签：c++, xcode, tabs, key-bindings, switching

我正在寻找一种能够在 Xcode 中切换选项卡的方法，而不是使用下一个/上一个选项卡，而是使用修饰符+1、2、3 .. 等，以便直接进入特定选项卡。

[在这个应用程序/脚本https://github.com/ciaran/terminaltabswitching](https://github.com/ciaran/terminaltabswitching)的帮助下，我已经为 terminal.app 解决了一个类似的问题。 它可以在 ML 上使用，你只需要增加 info.plist 中的 MaxBundleVersion。它与easySIMBL一起使用。

所以我最近开始在 Xcode 中使用标签，这是我试图找到的第一件事，因为我更喜欢专门选择标签。

任何想法/解决方案？谢谢。

# c# - 在 Windows 商店应用程序中使用 hmacsha256

> ID：13293420
> 
> 赞同：8
> 
> 时间：2012-11-08T16:35:34.490
> 
> 标签：c#, windows-phone-7, cryptography, microsoft-metro

我正在将 Windows Phone 7.1 应用程序迁移/转换/重建到 Windows 8 应用商店应用程序。

我在 de WP7 应用程序中使用的一种方法给我带来了麻烦：

```
private byte[] GetSHA256Key(string data, string secretKey)
{
    byte[] value = Encoding.UTF8.GetBytes(data);
    byte[] secretKeyBytes = Encoding.UTF8.GetBytes(secretKey);

    HMACSHA256 hmacsha256 = new HMACSHA256(secretKeyBytes);

    byte[] resultBytes = hmacsha256.ComputeHash(value);

    return resultBytes;
} 
```

查看 Windows Store Apps 的文档，我想出了这个新代码，我希望它会给出相同的结果。但不是。我做错了什么。但是什么？

```
private byte[] GetSHA256Key(string value, string secretKey)
{
        // Create a MacAlgorithmProvider object for the specified algorithm.
        MacAlgorithmProvider objMacProv = MacAlgorithmProvider.OpenAlgorithm(MacAlgorithmNames.HmacSha256);

        // Create a buffer that contains the message to be signed.
        IBuffer valueBuffer = CryptographicBuffer.ConvertStringToBinary(value, BinaryStringEncoding.Utf8);

        // Create a key to be signed with the message.
        IBuffer buffKeyMaterial = CryptographicBuffer.ConvertStringToBinary(secretKey, BinaryStringEncoding.Utf8);
        CryptographicKey cryptographicKey = objMacProv.CreateKey(buffKeyMaterial);

        // Sign the key and message together.
        IBuffer bufferProtected = CryptographicEngine.Sign(cryptographicKey, valueBuffer);

        DataReader dataReader = DataReader.FromBuffer(bufferProtected);
        byte[] bytes = new byte[bufferProtected.Length];
        dataReader.ReadBytes(bytes);

        return bytes;
} 
```

我不是密码学专家。我不确定我在做什么。也许外面有人可以帮助我。

谢谢，JP

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-02-18T22:06:25.640

```
using System.Runtime.InteropServices.WindowsRuntime;

private string GetSHA256Key(byte[] secretKey, string value)
{
    var objMacProv = MacAlgorithmProvider.OpenAlgorithm(MacAlgorithmNames.HmacSha256);
    var hash = objMacProv.CreateHash(secretKey.AsBuffer());
    hash.Append(CryptographicBuffer.ConvertStringToBinary(value, BinaryStringEncoding.Utf8));
    return CryptographicBuffer.EncodeToBase64String(hash.GetValueAndReset());
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:58:49.187

new HMACSHA256(keydata) 使用密钥作为输入，而 MacAlgorithmProvider.CreateKey() 使用输入作为“用于帮助生成密钥的随机数据”，这不是 HMAC 算法的密钥。

# microsoft-test-manager - 在 MTM 中，如何在不同的环境中重用测试用例？

> ID：13293425
> 
> 赞同：2
> 
> 时间：2012-11-08T16:35:41.290
> 
> 标签：microsoft-test-manager

假设我们有一个非常简单的测试用例：导航到网站的主页。我想在不同环境（DEV、QA、PROD）的不同测试计划中重用这个测试用例。因此，服务的位置将根据我使用的测试计划而改变。

如何确保当测试人员在 MTM 中看到“操作”指令时，它会显示当前环境的正确 URL？

我可以根据测试计划执行此操作吗？有不同的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-21T10:54:22.457

你没有提到你的测试是自动化的，所以我会给你一个手动测试的答案。

1.  在您的测试用例中，不要使用特定的 URL 值。只需说“*导航到该站点的主页。* ”
2.  板条箱只有一个`Test Plan`。
3.  在测试计划中创建 3 个不同的`Test Configurations`，每个环境一个。
4.  在测试计划的属性窗口中，为每个环境添加 3 个链接。例如，为 Qa 添加带有`Description = Qa`&的新链接`Link = http://qa.myservice/`
5.  当您在测试套件中添加此测试用例时，右键单击测试用例并选择`Select test configurations for selected tests`并选择测试用例将运行的配置（环境）。

当您的测试人员将运行测试用例时，将根据配置选择正确的链接。

# mysql - 条件SQL SELECT：选择有值时选择所有最小日期

> ID：13293426
> 
> 赞同：1
> 
> 时间：2012-11-08T16:35:42.900
> 
> 标签：mysql, sql

查看以下 SQL 小提琴：[http ://sqlfiddle.com/#!2/962496/1](http://sqlfiddle.com/#!2/962496/1)

怎么能从用户 b@b.cn 中选择 userpk = 2 和 reg = 1 的所有订单，但只选择来自 a@a.cn 的两个最新订单，其中 userpk = 1 和 reg = 0。所以查询将显示 3 个订单对于 userpk = 2 但只有 2 个订单（不是来自 userpk = 1 的最早订单 2012-01-01

所以条件是 reg，如果 reg = 0 则忽略一阶

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:47:02.373

我认为这会给你你想要的结果：

```
select *
from users u
left join another a
  on u.userpk = a.uPK
where
(
  u.userpk = 2
  and u.reg = 1
)
or
(
  u.userpk = 1
  and u.reg = 0
  and a.odate not in (select min(odate)
                      from another a1
                      where u.userpk = a1.uPK)
) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/387b5/6)

不特定于单个用户的版本（如果您有 2 个以上的用户）：

```
select *
from users u
left join another a
  on u.userpk = a.uPK
where
(
   u.reg = 1
)
or
(
  u.reg = 0
  and a.odate not in (select min(odate)
                      from another a1
                      where u.userpk = a1.uPK)
) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/387b5/7)

# jquery - Flowplayer（新）HTML5 - 自动播放问题

> ID：13293427
> 
> 赞同：2
> 
> 时间：2012-11-08T16:35:47.297
> 
> 标签：jquery, html5-video, flowplayer

我正在尝试将新的 Flowplayer 5.1.1 作为 HTML5 执行以自动启动。

尝试了很多东西，但无法让它工作。

这是我初始化实际视频的方式：

```
<div class="flowplayer minimalist"><video src="http://stream.flowplayer.org/white/470x250.mp4"></video></div> 
```

这通常有效，并且显示了视频。

我怎样才能让这个视频自动播放？

有任何想法吗？

谢谢你们！

# mysql - 使用 DataImportHandler 将 MYSQL 表行导入 solr 时出错

> ID：13293429
> 
> 赞同：-2
> 
> 时间：2012-11-08T16:35:54.887
> 
> 标签：mysql, solr

我想用**Solr4.0**逐行索引 MySQL 表。我已经安装了必要的 java，我的数据库名为“twitter_db”，我想要索引的表名为“tweets”，我使用用户登录：root，没有密码

架构是这样的，所以我将其添加到：

```
 <dataConfig>
        <dataSource driver="org.hsqldb.jdbcDriver" url="jdbc:mysql://localhost/twitter_db" user="root" password="" />
    <document name="tweet">
            <entity name="tweet" query="select * from tweets">
                <field column="tweet_id" name="tweet_id" />
                <field column="text" name="text" />            
                <field column="user" name="user" />
                <field column="tweet_time" name="tweet_time" />
                <field column="topic_kw" name="topic_kw" />
                <field column="timestamp" name="timestamp" />
            </entity>
        </document>
    </dataConfig> 
```

solrconfig 的变化是：

```
 <requestHandler name="/dataimport" class="org.apache.solr.handler.dataimport.DataImportHandler">
    <lst name="defaults">
        <str name="config">db-data-config.xml</str>
    </lst>
  </requestHandler> 
```

当我点击 [root]:8983/solr/db/dataimport?command=full-import 进行完全导入时

它失败了：GUI中的错误消息是：

> 索引失败。回滚所有更改。

并且日志中错误消息的部分是：

```
SEVERE: Exception while processing: tweet document : SolrInputDocument[]:org.apache.solr.handler.dataimport.DataImportHandlerException: Unable to execute query: select * from tweets Processing Document # 1
    at org.apache.solr.handler.dataimport.DataImportHandlerException.wrapAndThrow(DataImportHandlerException.java:71)
    at org.apache.solr.handler.dataimport.JdbcDataSource$ResultSetIterator.<init>(JdbcDataSource.java:252)
    at org.apache.solr.handler.dataimport.JdbcDataSource.getData(JdbcDataSource.java:209) 
```

我想知道在选择表的数据库时是否有错误的数据

我尝试了一个[类似的问题](https://stackoverflow.com/questions/5284586/index-a-db-table-directly-into-solr)，这是一个类似的问题，但我没有在那里找到答案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:13:02.650

检查`driver="org.hsqldb.jdbcDriver"`它是**hsqldb**而不是它应该指向 MySQL 驱动程序类。尝试将驱动程序类更新为适用于 MySQL 的驱动程序，您可以在调试模式下运行它。

# php - 将 php.ini 添加到 SCA Fortify

> ID：13293430
> 
> 赞同：0
> 
> 时间：2012-11-08T16:35:56.860
> 
> 标签：php, fortify

使用 Fortify 扫描我的项目时出现一系列错误：

[警告]：PHP 前端无法解析以下包括：位于 main.php:174 的 Mail.php。[警告]：将 php.ini 文件传递​​给 SCA 可能会有所帮助，因此可以检查 include_path 指令。[警告]：解析文件 (javascript) index.php 时出现意外异常：第 2 行第 17 列解析错误。遇到：_ffy_tag

我尝试将我的 PATH 添加到 Windows 的“环境变量”中的 PEAR 目录中。但还是会出错。

不确定如何执行此操作“将 php.ini 文件传递​​给 SCA 可能会有所帮助，因此可以检查 include_path 指令。” . 我尝试启动扫描向导并在扫描中包含 php.ini 文件，但它仍然会产生错误。

我在代码中包含了完整路径，错误切换到“[警告]：PHP 前端无法解析以下内容：RFC822.php:198 处的 PEAR.php。”

所以真的我的问题是我如何“将我的 php.ini 文件传递​​给 SCA”？任何建议都会非常有帮助。

谢谢，

汤姆

只是一个旁注我的 php.ini include_path 确实包含我的目录。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-07T16:18:06.547

汤姆使用它会在你的扫描中包含 php.ini。我的示例基于在 Unix/Linux 系统上安装 zend 服务器社区。

源分析器-b mybuild。/usr/local/zend/etc/php.ini

当您查看您的 auditworkbench 时，它还将包括对 ini 文件的建议更改。

# c - 自动使用 fgets() 测试程序

> ID：13293431
> 
> 赞同：3
> 
> 时间：2012-11-08T16:35:58.570
> 
> 标签：c, fgets

我目前正在从事一个类似 bash 的项目。但是，我需要用数千个测试来测试这个项目，这是无法手动检查的。这就是为什么我想自动执行测试。

我的程序用于`fgets()`获取用户输入。我知道如何直接向程序发送参数，但是当程序启动时，它会显示程序的提示。如何在标准输入上对包含*测试*的文件进行分类以使程序能够解释测试？（并在终端中获取程序输出）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T10:40:08.460

假设您所有的测试输入都存储在一个名为“test.input”的文件中（每一行都是程序的完整输入），您可以在 bash 中执行以下操作：

```
export LINE_NO=0
cat test.input | while read LINE; do echo "$LINE" | ./program > results.$LINE_NO;
   LINE_NO=$(($LINE_NO + 1));
done 
```

基本上，对于 test.input 中的每一行，上面的命令会将其输入到程序中并将程序的结果存储在 results.0、results.1、results.2 等中，其中 results.number 中的数字是test.input 文件的行号。

希望这可以帮助。

# jsf - java.lang.NoClassDefFoundError：org.primefaces.component.export.ExporterFactory.getExporterForType 处的 org/apache/poi/ss/usermodel/RichTextString

> ID：13293433
> 
> 赞同：2
> 
> 时间：2012-11-08T16:36:10.587
> 
> 标签：jsf, primefaces, datatable, export-to-excel, data-export

我使用了 Primefaces 在其网页中的相同示例代码：

```
<h:commandLink value="Excel">                     
  <p:dataExporter type="xls" target="dataTable" fileName="boo" pageOnly="true"/>  
</h:commandLink> 
```

但不起作用。在 Internet Explorer 浏览器中显示以下消息：

> 网页错误的详细信息 Message: Unexpected call to method or property access。

在 Mozilla Firefox 中什么都没有发生。

可能会发生什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T11:56:29.753

> ```
> javax.servlet.ServletException: org/apache/poi/ss/usermodel/RichTextString 
> ```

在堆栈跟踪中进一步查看。我敢打赌，根本原因是 a`NoClassDefFoundError`还是`ClassNotFoundException`? 在这种情况下，这只是意味着您忘记安装[Apache POI](http://poi.apache.org/)。

下载[此 Apache POI zip 文件](http://www.apache.org/dyn/closer.cgi/poi/release/bin/poi-bin-3.8-20120326.zip)，解压缩，将**poi-3.8-20120326.jar**放入`/WEB-INF/lib`文件夹并重建/重新部署/重新启动 webapp。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-27T15:23:54.833

尝试把这个jar文件。我显示链接，因为我解决了这个问题。

[http://apache.mirrors.pair.com/poi/release/bin/poi-bin-3.9-20121203.zip](http://apache.mirrors.pair.com/poi/release/bin/poi-bin-3.9-20121203.zip)

# java - Java，正则表达式捕获多次出现的模式

> ID：13293434
> 
> 赞同：0
> 
> 时间：2012-11-08T16:36:17.453
> 
> 标签：java, regex, string

这是我原来的字符串：

```
String response = "attributes[{"id":50,"name":super},{"id":55,"name":hello}]"; 
```

我正在尝试解析字符串并提取所有`id`值，例如
50
55

```
Pattern idPattern = Pattern.compile("{\"id\":(.*),");
Matcher matcher = idPattern.matcher(response);

while(matcher.find()){
    System.out.println(matcher.group(1));
} 
```

当我尝试打印该值时，我得到一个异常： `java.util.regex.PatternSyntaxException: Illegal repetition`
过去对正则表达式没有太多经验，但在网上找不到简单的解决方案。
感谢任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:38:37.697

```
Pattern.compile("\"id\":(\\d+)"); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:38:08.573

`{`是正则表达式中的保留字符，应该转义。

```
\{\"id\":(.*?), 
```

编辑：如果您要使用 JSON，您应该考虑使用专用的 JSON 解析器。它会让你的生活更轻松。请参阅[在 Java 中解析 JSON 对象](https://stackoverflow.com/questions/5015844/parsing-json-object-in-java)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T16:39:39.180

不要使用贪婪的匹配运算符，例如匹配任何字符`*`的 a 。`.`不必要的。如果要提取数字，可以使用`\d`.

```
"id":(\d+) 
```

在 Java 字符串中，

```
Pattern.compile("\"id\":(\\d+)"); 
```

# gcc - xdebug - 错误的 ELF 类：ELFCLASS64

> ID：13293437
> 
> 赞同：1
> 
> 时间：2012-11-08T16:36:23.957
> 
> 标签：gcc, xdebug

我试图在我的 x64 Arch Linux 上运行 xdebug，但没有成功。我已经安装了它，现在当我尝试运行lampp时它说：

```
Failed loading /opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/xdebug.so:/opt/lampp/lib/php/extensions/no-debug-non-zts-20100525/xdebug.so: wrong ELF class: ELFCLASS64 
```

我做了一些搜索，发现我需要再次下载xdebug，将其编译为x64并将xdebug.so文件移动到我在lampp中的文件夹中。

[http://www.designified.com/blog/article/60/compiling-installing-xdebug-for-php-525-entropych-build-on-os-x-105](http://www.designified.com/blog/article/60/compiling-installing-xdebug-for-php-525-entropych-build-on-os-x-105)

[由于 ELFCLASS64 错误，如何使用“make”来使用 64 位库](https://stackoverflow.com/questions/1242400/how-to-use-make-to-use-64-bit-libs-because-of-elfclass64-error)

我尝试根据第一个链接中的指南对其进行编译：

```
CFLAGS='-arch x86_64' ./configure --enable-xdebug 
```

以及这些参数：

```
./configure --enable-xdebug "CFLAGS=-m32" "CXXFLAGS=-m32" "LDFLAGS=-m32" --with-php-config=/opt/lampp/bin/php-config 
```

但是我遇到了这个问题：

```
configure: error: C compiler cannot create executables
See `config.log' for more details 
```

这是 config.log 文件：

```
This file contains any messages produced by compilers while
running configure, to aid debugging if configure makes a mistake.

It was created by configure, which was
generated by GNU Autoconf 2.69\.  Invocation command line was

  $ ./configure --enable-xdebug

## --------- ##
## Platform. ##
## --------- ##

hostname = michal-ntb
uname -m = x86_64
uname -r = 3.6.5-1-ARCH
uname -s = Linux
uname -v = #1 SMP PREEMPT Wed Oct 31 20:57:39 CET 2012

/usr/bin/uname -p = unknown
/bin/uname -X     = unknown

/bin/arch              = unknown
/usr/bin/arch -k       = unknown
/usr/convex/getsysinfo = unknown
/usr/bin/hostinfo      = unknown
/bin/machine           = unknown
/usr/bin/oslevel       = unknown
/bin/universe          = unknown

PATH: /usr/local/bin
PATH: /usr/bin
PATH: /bin
PATH: /usr/local/sbin
PATH: /usr/sbin
PATH: /sbin
PATH: /usr/bin/core_perl

## ----------- ##
## Core tests. ##
## ----------- ##

configure:2293: checking for grep that handles long lines and -e
configure:2351: result: /usr/bin/grep
configure:2356: checking for egrep
configure:2418: result: /usr/bin/grep -E
configure:2423: checking for a sed that does not truncate output
configure:2477: result: /bin/sed
configure:2609: checking for cc
configure:2625: found /usr/bin/cc
configure:2636: result: cc
configure:2667: checking for C compiler version
configure:2676: cc --version >&5
cc (GCC) 4.7.2
Copyright (C) 2012 Free Software Foundation, Inc.
This is free software; see the source for copying conditions.  There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

configure:2687: $? = 0
configure:2676: cc -v >&5
Using built-in specs.
COLLECT_GCC=cc
COLLECT_LTO_WRAPPER=/usr/lib/gcc/x86_64-unknown-linux-gnu/4.7.2/lto-wrapper
Target: x86_64-unknown-linux-gnu
Configured with: /build/src/gcc-4.7.2/configure --prefix=/usr --libdir=/usr/lib --libexecdir=/usr/lib --mandir=/usr/share/man --infodir=/usr/share/info --with-bugurl=https://bugs.archlinux.org/ --enable-languages=c,c++,ada,fortran,go,lto,objc,obj-c++ --enable-shared --enable-threads=posix --with-system-zlib --enable-__cxa_atexit --disable-libunwind-exceptions --enable-clocale=gnu --disable-libstdcxx-pch --enable-libstdcxx-time --enable-gnu-unique-object --enable-linker-build-id --with-ppl --enable-cloog-backend=isl --disable-ppl-version-check --disable-cloog-version-check --enable-lto --enable-gold --enable-ld=default --enable-plugin --with-plugin-ld=ld.gold --with-linker-hash-style=gnu --disable-multilib --disable-libssp --disable-build-with-cxx --disable-build-poststage1-with-cxx --enable-checking=release
Thread model: posix
gcc version 4.7.2 (GCC) 
configure:2687: $? = 0
configure:2676: cc -V >&5
cc: error: unrecognized command line option '-V'
cc: fatal error: no input files
compilation terminated.
configure:2687: $? = 1
configure:2676: cc -qversion >&5
cc: error: unrecognized command line option '-qversion'
cc: fatal error: no input files
compilation terminated.
configure:2687: $? = 1
configure:2707: checking whether the C compiler works
configure:2729: cc -arch x86_64   conftest.c  >&5
cc: error: unrecognized command line option '-arch'
cc: error: x86_64: No such file or directory
configure:2733: $? = 1
configure:2771: result: no
configure: failed program was:
| /* confdefs.h */
| #define PACKAGE_NAME ""
| #define PACKAGE_TARNAME ""
| #define PACKAGE_VERSION ""
| #define PACKAGE_STRING ""
| #define PACKAGE_BUGREPORT ""
| #define PACKAGE_URL ""
| /* end confdefs.h.  */
| 
| int
| main ()
| {
| 
|   ;
|   return 0;
| }
configure:2776: error: in `/home/michal/TEMP/xdebug-2.2.1':
configure:2778: error: C compiler cannot create executables
See `config.log' for more details

## ---------------- ##
## Cache variables. ##
## ---------------- ##

ac_cv_env_CC_set=
ac_cv_env_CC_value=
ac_cv_env_CFLAGS_set=set
ac_cv_env_CFLAGS_value='-arch x86_64'
ac_cv_env_CPPFLAGS_set=
ac_cv_env_CPPFLAGS_value=
ac_cv_env_CPP_set=
ac_cv_env_CPP_value=
ac_cv_env_LDFLAGS_set=
ac_cv_env_LDFLAGS_value=
ac_cv_env_LIBS_set=
ac_cv_env_LIBS_value=
ac_cv_env_build_alias_set=
ac_cv_env_build_alias_value=
ac_cv_env_host_alias_set=
ac_cv_env_host_alias_value=
ac_cv_env_target_alias_set=
ac_cv_env_target_alias_value=
ac_cv_path_EGREP='/usr/bin/grep -E'
ac_cv_path_GREP=/usr/bin/grep
ac_cv_prog_ac_ct_CC=cc
lt_cv_path_SED=/bin/sed

## ----------------- ##
## Output variables. ##
## ----------------- ##

AR=''
AWK=''
CC='cc'
CFLAGS='-arch x86_64'
CONFIGURE_COMMAND=' '\''./configure'\''  '\''--enable-xdebug'\'''
CONFIGURE_OPTIONS=' '\''--enable-xdebug'\'''
CPP=''
CPPFLAGS=''
DEFS=''
DSYMUTIL=''
ECHO='echo'
ECHO_C=''
ECHO_N='-n'
ECHO_T=''
EGREP='/usr/bin/grep -E'
EXEEXT=''
GREP='/usr/bin/grep'
LDFLAGS=''
LIBOBJS=''
LIBS=''
LIBTOOL=''
LN_S=''
LTLIBOBJS=''
NMEDIT=''
OBJEXT=''
PACKAGE_BUGREPORT=''
PACKAGE_NAME=''
PACKAGE_STRING=''
PACKAGE_TARNAME=''
PACKAGE_URL=''
PACKAGE_VERSION=''
PATH_SEPARATOR=':'
RANLIB=''
RE2C=''
SED='/bin/sed'
SHELL='/bin/sh'
SHLIB_DL_SUFFIX_NAME=''
SHLIB_SUFFIX_NAME=''
STRIP=''
ac_ct_CC='cc'
bindir='${exec_prefix}/bin'
build=''
build_alias=''
build_cpu=''
build_os=''
build_vendor=''
datadir='${datarootdir}'
datarootdir='${prefix}/share'
docdir='${datarootdir}/doc/${PACKAGE}'
dvidir='${docdir}'
exec_prefix='NONE'
host=''
host_alias=''
host_cpu=''
host_os=''
host_vendor=''
htmldir='${docdir}'
includedir='${prefix}/include'
infodir='${datarootdir}/info'
libdir='${exec_prefix}/lib'
libexecdir='${exec_prefix}/libexec'
localedir='${datarootdir}/locale'
localstatedir='${prefix}/var'
mandir='${datarootdir}/man'
oldincludedir='/usr/include'
pdfdir='${docdir}'
prefix='NONE'
program_transform_name='s,x,x,'
psdir='${docdir}'
sbindir='${exec_prefix}/sbin'
sharedstatedir='${prefix}/com'
sysconfdir='${prefix}/etc'
target=''
target_alias=''
target_cpu=''
target_os=''
target_vendor=''

## ----------- ##
## confdefs.h. ##
## ----------- ##

/* confdefs.h */
#define PACKAGE_NAME ""
#define PACKAGE_TARNAME ""
#define PACKAGE_VERSION ""
#define PACKAGE_STRING ""
#define PACKAGE_BUGREPORT ""
#define PACKAGE_URL ""

configure: exit 77 
```

我一直在寻找解决方案几个小时，发现了一些类似的主题（如[this](https://bbs.archlinux.org/viewtopic.php?id=143181)），但没有帮助。

感谢您的建议和建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-03T21:28:20.110

在互联网上快速查找，结果发现当我运行时，`64 bit Linux`我编译`64 bit`了`xdebug.so`.

`Xampp`运行时我需要的`32 bit`是*预编译的 32 位版本*。

我在[这里](http://www.apachefriends.org/f/viewtopic.php?p=162080)找到了解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-11T15:29:51.967

问题解决了。:-) 显然在编译过程中出现了错误：

```
/usr/bin/ld: cannot find -lgcc 
```

我通过从官方 Arch linux multilib 存储库安装 gcc-multilib 包解决了这个问题。

对于编译，我使用了这些参数：

```
./configure --enable-xdebug "CFLAGS=-m32" "CXXFLAGS=-m32" "LDFLAGS=-m32" --with-php-config=/opt/lampp/bin/php-config 
```

# c++ - 强类型枚举中范围解析背后的基本原理

> ID：13293439
> 
> 赞同：2
> 
> 时间：2012-11-08T16:36:33.070
> 
> 标签：c++, enums, c++11

在强类型枚举中无条件地要求明确范围解析的基本原理是什么？

N2347 解释了与老式枚举的区别，后者没有隐式转换、指定存储类型的能力以及在周围范围内没有注入名称（如在 C++03 中，它具有 C 的遗产）。

换句话说，`enum E1 { a, b, c};`在 C++03 中编写类似于编写

```
const int a = 1; const int b = 2; const int c = 3; 
```

而`enum E1 class { a, b, c};`在 C++11 中更类似于类似

```
namespace E1 { const int a = 1; const int b = 2; const int c = 3; } 
```

（没有引入命名空间，并且在任何一种情况下都定义了枚举类型）。

现在，我通常不明白哪里有歧义，假设一个示例代码如下（不会编译）：

```
enum class E1 { a, b, c };
enum class E2 { a, b, c }; // allowed now

void foo(E1 e) { ... }
void bar(E2 e) { ... }
void baz(int e) { ... }

foo(a);   // not ambigious: E1 expected, nothing but E1::a possible
bar(a);   // not ambigious: E2 expected, nothing but E2::a possible
baz(a);   // not ambigious: illegal - no name `a` in global scope

E1 x = a; // not ambigious: E1 expected, nothing but E1::a possible 
```

在某些情况下，我欢迎（可选）显式范围解析以指出发生了什么，但我不明白为什么 C++11 需要显式范围解析，即使没有可能的方式以另一种方式解释代码。

在我看来，期望 example`void foo(E1 e);`的含义更像是`void foo(using enum E1; E1 e);`（我的语法当然完全错误，但你明白了）是合理的。

以N2347中的`Color`and的“经典”示例为例，其中一个具有*red alert*和*red*，它们也可能是不同的数字常量。如果没有强类型保证，可以想象当一个人真的想在显示器上设置*红色时，最终会使用警报数字常量。*或者，通过整数转换和宽松的函数声明，可以想象有人最终会使用类似获取橙色的东西。`Alert`***`yellow|red`***

 ***这些都不可能，那么我们到底要防御什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T17:02:49.197

> 富（一）；// 没有歧义：预期 E1，只有 E1::a 可能

必须知道表达式的类型。并且由于`a`作为独立表达的使用是模棱两可的，所以`a`任何地方的使用都是模棱两可的。

您不希望表达式根据它们所使用的上下文来改变它们的含义。`1 + 1`总是意味着同样的事情。`1 + t`如果你使用相同的，总是意味着同样的事情`t`。同样，`a`无论在哪里使用，都应该始终表示相同的意思。

C++ 中唯一允许根据使用它的上下文推断源类型的是统一初始化。并且该标准明确指出“braced-init-list”*不是*表达式。`a`是一个表达式，所以它遵循表达式规则。***

# c++ - 使用 ATL 库时如何在运行时更改 Web 服务 URL？

> ID：13293440
> 
> 赞同：0
> 
> 时间：2012-11-08T16:36:37.187
> 
> 标签：c++, web-services, unmanaged, atl

我正在尝试使用另一家公司的现有 Web 服务，并且很难找到解决方案以从不同位置使用相同的 Web 服务。

该地址提供了一个现有的 Web 服务`http://url.to.A/webservice/`，我可以使用 ATL 工具为该服务生成一个 C++`sproxy.exe`代理[类](http://atlserver.codeplex.com/)。

使用该类，我可以毫无问题地使用 Web 服务。

现在我需要使用相同的 Web 服务，但是来自另一个 URL（比如说`http://url.to.B/webservice/`），并且之前创建的代理类不起作用。`SendRequest`方法代理之一中的方法总是返回错误代码`HRESULT`。专门为第二个服务生成一个新的代理提供了一个可行的解决方案顺便说一句。

当我说服务相同时，我的意思是它们公开了完全相同的方法，因此它们各自的`wsdl`定义文件仅在服务 URL 上有所不同。

我试图更改`URL`生成的代理类实例的属性，但它没有帮助。

鉴于我被绑定使用非托管 C++ 作为消费部分，并且我希望能够在运行时指定服务端点，是否有可行的解决方案来解决我的问题？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:45:00.983

为每个服务器/服务生成一个单独的代理类。

然后对生成的代码进行比较。这应该让你知道有什么区别。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-30T12:53:09.513

最终证明，使用`sproxy.exe`, 生成一个可以动态分配给 Web 服务端点的类是不可能的。

# msbuild - 什么是命令行开关 /t:Package 等效的 MSBuild 2010 脚本文件

> ID：13293443
> 
> 赞同：0
> 
> 时间：2012-11-08T16:37:03.440
> 
> 标签：msbuild

我可以看到 MSBuild 在命令行上使用了 /t:Package，但是在 msbuild 脚本文件中包含这个选项的意义是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:42:13.560

构建脚本文件中的等效项是使用 MsBuild 任务。请参阅下面的链接。

[Msdn 构建任务](http://msdn.microsoft.com/en-us/library/z7f65y0d.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:41:52.553

您是否正在使用 MsBuild 任务从另一个脚本调用 msbuild 脚本？如果是这样，您要使用的参数是 Targets [http://msdn.microsoft.com/en-us/library/z7f65y0d.aspx](http://msdn.microsoft.com/en-us/library/z7f65y0d.aspx)。

# c++ - 多维向量指针

> ID：13293448
> 
> 赞同：0
> 
> 时间：2012-11-08T16:37:22.440
> 
> 标签：c++, vector, multidimensional-array

我有以下多维向量

```
int main()
{
    vector< vector<string> > tempVec;

    someFunction(&tempVec);
}

void someFunction(vector< vector<string> > *temp)
{
    //this does not work
    temp[0]->push_back("hello");
} 
```

当我有向量指针时，如何将数据推送到向量中？下面的代码不起作用。

```
 temp[0]->push_back("hello"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:41:14.763

你需要

```
(*temp)[0].push_back("hello") 
```

那是：

*   取消引用`temp`以获得`vector<vector<string> > &`
*   获取第一个元素，a`vector<string> &`
*   使用`.`而不是`->`因为您不再处理指针

也就是说，如果`someFunction`使用 a`vector< vector<string> >&`而不是指针会更容易：`temp[0].push_back("hello")`。引用不允许指针算术或空指针，因此它们更难搞砸，并且更暗示所需的实际输入类型（单个`vector`，而不是可选的或它们的数组）。

# linux - 竞争 futex 时系统 CPU 使用率高

> ID：13293452
> 
> 赞同：17
> 
> 时间：2012-11-08T16:37:29.883
> 
> 标签：linux, spinlock, futex

我观察到，当 linux futexes 竞争时，系统会在自旋锁上花费大量时间。我注意到这是一个问题，即使不直接使用 futex，但在调用 malloc/free、rand、glib 互斥调用和其他调用 futex 的系统/库调用时也是如此。有没有*办法*摆脱这种行为？

我正在使用带有内核 2.6.32-279.9.1.el6.x86_64 的 CentOS 6.3。我还尝试了直接从 kernel.org 下载的最新稳定内核 3.6.6。

*最初*，问题发生在具有 16GB RAM 的 24 核服务器上。该进程有 700 个线程。使用“perf record”收集的数据表明，自旋锁是从 __lll_lock_wait_private 和 __lll_unlock_wake_private 调用的 futex 调用的，并且正在消耗 50% 的 CPU 时间。当我使用 gdb 停止该进程时，回溯显示对 __lll_lock_wait_private __lll_unlock_wake_private 的调用是由 malloc 和 free 进行的。

我试图减少这个问题，所以我编写了一个简单的程序，表明确实是 futexes 导致了自旋锁问题。

启动 8 个线程，每个线程执行以下操作：

```
 //...
   static GMutex *lMethodMutex = g_mutex_new ();
   while (true)
   {
      static guint64 i = 0;
      g_mutex_lock (lMethodMutex);
      // Perform any operation in the user space that needs to be protected.
      // The operation itself is not important.  It's the taking and releasing
      // of the mutex that matters.
      ++i;
      g_mutex_unlock (lMethodMutex);
   }
   //... 
```

我在一台 8 核机器上运行它，它有足够的 RAM。

使用“top”，我观察到机器空闲 10%，用户模式 ​​10%，系统模式 90%。

使用“perf top”，我观察到以下内容：

```
 50.73%  [kernel]                [k] _spin_lock
 11.13%  [kernel]                [k] hpet_msi_next_event
  2.98%  libpthread-2.12.so      [.] pthread_mutex_lock
  2.90%  libpthread-2.12.so      [.] pthread_mutex_unlock
  1.94%  libpthread-2.12.so      [.] __lll_lock_wait
  1.59%  [kernel]                [k] futex_wake
  1.43%  [kernel]                [k] __audit_syscall_exit
  1.38%  [kernel]                [k] copy_user_generic_string
  1.35%  [kernel]                [k] system_call
  1.07%  [kernel]                [k] schedule
  0.99%  [kernel]                [k] hash_futex 
```

我希望这段代码在自旋锁中花费*一些*时间，因为 futex 代码必须获取 futex 等待队列。我还希望代码在系统中花费一些时间，因为在这段代码中，用户空间中运行的代码非常少。然而，50% 的时间花在自旋锁上似乎是多余的，尤其是当这个 cpu 时间需要做其他有用的工作时。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T21:23:18.597

我也遇到过类似的问题。[我的经验是，根据 libc 版本和许多其他晦涩的事情（例如，像这里](http://sourceware.org/bugzilla/show_bug.cgi?id=13699)一样调用 fork()），您可能会在多次锁定和解锁时看到性能下降甚至死锁。

[这个人](http://jamesgolick.com/2012/7/18/innodb-kernel-mutex-contention-and-memory-allocators.html)通过切换到[tcmalloc](http://goog-perftools.sourceforge.net/doc/tcmalloc.html)解决了他的性能问题，这可能是一个好主意，具体取决于用例。对你来说也值得一试。

对我来说，当我有多个线程进行大量锁定和解锁时，我看到了可重现的死锁。我从 2010 年开始使用带有 libc 的 Debian 5.0 rootfs（嵌入式系统），通过升级到 Debian 6.0 解决了这个问题。

# android - Google Plus Android App UI 设计 - ListView 向上滑动进入视图

> ID：13293454
> 
> 赞同：0
> 
> 时间：2012-11-08T16:37:36.560
> 
> 标签：android, user-interface, google-plus

有人可以解释一下谷歌是如何实现他们的谷歌+应用程序的“详细信息”页面的吗？详细信息页面的顶部有一个图像（可以点击），一个`ListView`位于屏幕下方大约 50% 的位置。

像这样： [示例](http://i.imgur.com/IOBjD.png)

当您向上滑动时，ListView 会向上移动以填满整个屏幕： [示例](http://i.imgur.com/X0qzH)

在此之后，额外的滑动控制 listView 向上/向下： [示例](http://i.imgur.com/cAAHy)

我已经完成了我的研究，但很少有人可以建议他们如何实现这一点。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T20:56:58.077

简短的回答是他们正在使用各种技巧来启用滑动菜单。Android 社​​区中的人们编写了大量资源，其中最引人注目的是：

*   有关此主题的视频：https: [//plus.google.com/115177579026138386092/posts/FjnASs9no1a](https://plus.google.com/115177579026138386092/posts/FjnASs9no1a)
*   随视频创作的示例： [https ://github.com/jfeinstein10/SlidingMenu](https://github.com/jfeinstein10/SlidingMenu)
*   最后，存在于 Play 商店中的演示应用程序。

获取演示的最简单方法是在 Play 商店中搜索 SlidingMenu Demos。Demo 中感兴趣的具体控件是“ViewPager”示例和“Slide”示例。

当您查看该库时，您会注意到它几乎重写了 View 中现有控件的重要部分，以及视图中使用的画布元素的自定义转换。

Jeremy 编写的示例实际上是现有 ListView 和 Page 控件的替代库，支持大量 Android 设备以及许多 UI 控件，这些控件与您提供的示例略有不同，并且使用不同的转换。

# javascript - Jquery/Javascript：在我们调用函数的文件之外调用函数

> ID：13293457
> 
> 赞同：0
> 
> 时间：2012-11-08T16:37:43.737
> 
> 标签：javascript, jquery, function

我有一些 javascript 插件包含在我的 HTML 文件中，并且因为我已经检查过而成功包含在内。这是问题所在；基本上我想在 HTML 文件**之外**创建一个函数，然后**在**文档准备好时在 HTML 文件中加载该特定函数。

这是 HTML 文件的函数（外部）。作为一个独立的 JS 文件：

```
function do_anchor_scrolling() {
    $('#back_to_top').anchorScroll();
    $("#landing_link").anchorScroll();
    $("#menu_link").anchorScroll();
    $("#sauces_link").anchorScroll();
    $("#ranches_link").anchorScroll();
    $("#order_link").anchorScroll();
    $("#about_link").anchorScroll();
    $("#franchise_link").anchorScroll();
}); 
```

该函数被调用`do_anchor_scrolling`

我如何在 JQuery 中说文档准备好执行该`do_anchor_scrolling`功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:39:46.870

文档准备好后，调用该函数。

```
$(document).ready(function(){
    do_anchor_scrolling();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:54:05.577

将其作为处理程序传递给[`ready`](http://api.jquery.com/ready/)方法：

```
$(document).ready(do_anchor_scrolling); 
```

甚至更短：

```
$(do_anchor_scrolling); 
```

请注意，该函数并未在此处执行（没有调用括号） - 函数对象本身被传递到`ready`函数中。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-08T16:40:04.350

你可以这样做：

```
$.getScript("yourfile.js");//it grabs and executes yourfile.js
                           //so your function is now defined
do_anchor_scrolling();     //and you can call it 
```

您`$_getScript()`只需`yourfile.js`在. `<script>`_`<head>`

# ruby-on-rails - Ruby on Rails：需要帮助更新嵌套路由中的 db 属性

> ID：13293462
> 
> 赞同：1
> 
> 时间：2012-11-08T16:37:54.760
> 
> 标签：ruby-on-rails, attributes, routes, nested

让我先说一下，我对 Rails 和编程很陌生。

我正在尝试创建一些链接来打开和关闭布尔属性。通过执行以下操作，我基本上成功地在非嵌套资源上执行此操作：

路线：

```
resources :my_resource do
 get 'toggle_attribute', :on => :member
end 
```

控制器：

```
def toggle_attribute
  @resource = Resource.find(params[:id])
  @resource.toggle!(:attribute)
end 
```

看法： `<%= link_to "Toggle Resource", toggle_attribute_resource_path(@resource), :remote => true %>`

首先，就像我上面说的，这适用于我的非嵌套路由，但是无论我尝试添加什么解决方案到控制器，我都无法让我的链接在点击时闪烁消息或重定向到任何内容，你点击按钮并没有任何反应，您必须手动刷新才能看到更改。

其次，我不知道如何让同样的事情在这样嵌套的路线上工作：

路线：

```
resources :resource_1 do
resources :resource_2
end 
```

谁能给我一些提示？

提前致谢。这东西一直让我发疯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:54:10.757

通过使用`remote => true`，您是在告诉它进行 ajax 调用。这意味着您还需要在您的视图文件夹中添加一个 toggle_attribute.js.erb 文件，并在该文件中使用 javascript 将链接元素或文本替换为您想要的内容。

还要确保通过`respond_to :html, :js`在控制器顶部进行设置来响应 js。

```
repond_to :html, :js
def toggle_attribute
  @resource = Resource.find(params[:id])
  @resource.toggle!(:attribute)
end 
```

toggle_attribute.js.erb ：

```
$('#toggler').html("my new html here"); 
```

鉴于：

```
<%= link_to "Toggle Resource", toggle_attribute_resource_path(@resource), :remote => true, :id => "toggler"%> 
```

更新：

对于您的嵌套路线，请尝试以下操作：

```
resources :resource_1 do
  resources :resource_2 do
    member do
      get :toggle_attribute
    end
  end
end 
```

您的路径将类似于：

```
toggle_attribute_resource_1_resource_2_path(@resource, @resource2) 
```

# encryption - 是否有能力将加密数据存储在使用潮汐SDK 创建的桌面应用程序上？

> ID：13293463
> 
> 赞同：0
> 
> 时间：2012-11-08T16:37:58.527
> 
> 标签：encryption, tidesdk

我已经搜索但找不到任何东西。我们需要能够在我们的桌面应用程序中离线存储数据，我们正在寻找跨平台的解决方案。TideSDK 看起来很有希望，但我不确定它是否具有此功能。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T17:28:41.380

我们当然可以在那里提供帮助。SQLite 当然提供加密数据支持，并且完全跨平台并由 TideSDK 支持。我们可以像在 TideSDK 中一样轻松地使用加密数据库，并且可以在 API 中为此提供支持。[如果对此感兴趣，请通过在https://github.com/TideSDK/TideSDK/issues](https://github.com/TideSDK/TideSDK/issues)提交功能请求与我们联系。

如果我们谈论的是源代码的加密——短期来看，1.3.0 中可用的 JS 源代码应该会被混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T01:10:07.180

去年，我们创建了一个 Titanium 桌面模块来支持加密的 SQLite 数据库。我们可以帮助解决这个问题并挖掘出旧代码......

# list - 替换 Haskell 列表中的元素

> ID：13293465
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:38:02.957
> 
> 标签：list, search, haskell

我有一个这样的列表列表：

```
[["BBBBBBBB",
  "BWFFFPFGB", 
  "BWFFFPFGB",
  "BWFFMPFGB",
  "BWFFFPF_B",
  "BWFFFPF6B",
  "BBBBBBB"]] 
```

我做了一些研究，发现了如何使用`!!`操作符访问单个元素。但是当谈到搜索某个元素时`'M'`，我不知道该怎么做。我的朋友说我需要 `(x:xs):xss` 在列表中使用类似的东西，但是当我在 WinGHCi haskell 程序中尝试这个时，我得到了这个。

```
Prelude> let list =    [["BBBBBBBB",
  "BWFFFPFGB", 
  "BWFFFPFGB",
  "BWFFMPFGB",
  "BWFFFPF_B",
  "BWFFFPF6B",
  "BBBBBBB"]]

Prelude> head(x:xs):xss
<interactive>:192:2: Not in scope: `x'
<interactive>:192:4: Not in scope: `xs'
<interactive>:192:8: Not in scope: `xss' 
```

我知道我将名称声明为 `list`而不是 `x:xs`，但即使我声明它， `x:xs`我仍然会收到错误。我可能对haskell还有些陌生，无法真正理解该怎么做，所以我可能会以这种方式错误。

我看过这里[Replace individual list elements in Haskell?](https://stackoverflow.com/questions/5852722/replace-individual-list-elements-in-haskell) 因为最终我想`M` 用不同的东西替换它，但我不完全确定我将如何实现它。

任何帮助/指导表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T00:36:56.200

首先让我们看看如何将 a 替换`W`为`M`

```
charWM :: Char -> Char
charWM 'W' = 'M'  -- If you see W, put M.
charWM x  =  x   -- If you see anything else, put it back as is. 
```

您可以通过添加其他字母转换以您喜欢的方式重写该函数。

现在让我们通过一个列表来完成这项工作。有一个很棒的函数`map :: (a ->b) -> [a] -> [b]`可以让你对列表中的每个元素应用一个函数。

```
stringWM :: String -> String
stringWM xs = map charWM xs  -- do charWM to everything in xs. 
```

例如`stringWM "QWERTY WILL WIN"`=`"QMERTY MILL MIN"`

接下来我们可以对列表列表执行此操作：

```
lolWM :: [String] -> [String]
lolWM xss = map stringWM xss 
```

(`String`是 . 的类型同义词`[Char]`。)
让我们在 ghci 中测试一下：

```
*Main> list'
["BBBBBBBB","BWFFFPFGB","BWFFFPFGB","BWFFMPFGB","BWFFFPF_B","BWFFFPF6B","BBBBBBB"]
*Main> lolWM list'
["BBBBBBBB","BMFFFPFGB","BMFFFPFGB","BMFFMPFGB","BMFFFPF_B","BMFFFPF6B","BBBBBBB"] 
```

都好。

您的示例不完全是`list'`，它`[list']`具有 1 个元素，因此要进行此操作，我们需要`map lolWM`. 如果这是我们需要的，我们通常不会费心编写`stringWM`或直接进入列表列表的列表：`lolWM`

```
lololWM = (map.map.map) charWM 
```

`map.map.map`意思是地图地图的地图。您可以让它让您大吃一惊，或者您可以只说 Char 列表列表的列表，因此 map map map - 每个列表级别一张地图。

* * *

将来，也许您会想`W`用字符串而不是字符来替换。

```
rewriteChar :: Char -> String
rewriteChar 'W' = "--^--"
rewriteChar  x  = [x] -- put x in a list to make it a string 
```

这一次，地图还不够：`map rewriteChar "QWERTY WILL WIN"`给

```
["Q","--^--","E","R","T","Y"," ","--^--","I","L","L"," ","--^--","I","N"] 
```

我们可以使用`concat`它来将其扁平化为一个列表，但这样做更有趣

```
rewriteString = concatMap rewriteChar 
```

所以现在`rewriteString "QWERTY WILL WIN"`给我们`"Q--^--ERTY --^--ILL --^--IN"`。

要尝试更多令人兴奋的事情，`"QWERTY WILL WIN" >>= rewriteChar`还有`"Hello Mum" >>= \x -> [x,x,x]`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T17:10:54.283

首先，Haskell 中几乎所有的“变量”都是不可变的，所以没有“更改列表”，只有修改后的副本。

其次，您需要通过一些标准找到一个元素。为此，您需要遍历一个列表。- 这可以使用递归来完成。可以使用作为遍历函数的参数传递的函数来完成过滤（此函数必须接受一个元素并返回一个布尔值）。

尝试将以上内容放在一起并制作自己的功能。从类型签名开始，它显示了您想要做什么：获取 Char 列表（最好概括为泛型类型）和一个可能更改元素并返回修改后列表的函数：

replaceFunc :: (Char -> Char) -> String -> String

另外，请阅读[http://www.haskell.org/haskellwiki/How_to_work_on_lists](http://www.haskell.org/haskellwiki/How_to_work_on_lists)，那里有一个提示如何将某些功能仅应用于特定元素。

# javascript - 使用javascript从字符串中转义引号？

> ID：13293466
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:38:07.117
> 
> 标签：javascript

例如说我有字符串：

```
var name = 'Mc'Obrian' 
```

我希望能够只转义第一个引号和最后一个引号，而不是名称中使用的引号，我怎样才能在 javascript 中实现这一点？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:39:36.573

使用`\`转义单引号，如下所示：

```
var name = 'Mc\'Obrian' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:39:58.603

`var name = 'Mc\'Obrian'`

或者

`var name = "Mc'Obrian"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:39:24.743

给定您当前的代码，以下内容将正确转义单引号：

```
var name = 'Mc\'Obrian' 
```

我鼓励您阅读[以下有关字符串的教程](http://www.quirksmode.org/js/strings.html)。如果您对性能考虑感兴趣，[请阅读此问题](https://stackoverflow.com/questions/242813/when-to-use-double-or-single-quotes-in-javascript)。

# c++ - 为什么我的翻译矩阵需要转置？

> ID：13293469
> 
> 赞同：27
> 
> 时间：2012-11-08T16:38:10.597
> 
> 标签：c++, opengl, matrix, glsl, linear-algebra

我正在使用 OpenGL 开发一个小型图形引擎，但我的翻译矩阵有一些问题。我正在使用 OpenGL 3.3、GLSL 和 C++。情况是这样的：我定义了一个要在屏幕上渲染的小立方体。立方体使用它自己的坐标系，所以我创建了一个模型矩阵来转换立方体。为了让我自己更容易一点，我从一个平移矩阵开始作为立方体的模型矩阵，经过一些编码后，我设法使一切正常，立方体出现在屏幕上。没什么特别的，但我的翻译矩阵有一点让我觉得有点奇怪。

现在据我所知，平移矩阵定义如下：

```
1, 0, 0, x
0, 1, 0, y
0, 0, 1, z
0, 0, 0, 1 
```

但是，这对我不起作用。当我以这种方式定义我的翻译矩阵时，屏幕上什么也没有出现。它仅在我这样定义我的翻译矩阵时才有效：

```
1, 0, 0, 0
0, 1, 0, 0
0, 0, 1, 0
x, y, z, 1 
```

现在我已经多次检查我的代码以找出为什么会这样，但我似乎无法找出为什么或者我只是错了，并且是否需要像上面的转置矩阵一样定义翻译矩阵？

我的矩阵被定义为从左到右、从上到下的一维数组。

这是我的一些代码可能会有所帮助：

```
//this is called just before cube is being rendered
void DisplayObject::updateMatrices()
{
    modelMatrix = identityMatrix();
    modelMatrix = modelMatrix * translateMatrix( xPos, yPos, zPos );

    /* update modelview-projection matrix */
    mvpMatrix = modelMatrix * (*projMatrix);
}

//this creates my translation matrix which causes the cube to disappear
const Matrix4 translateMatrix( float x, float y, float z )
{
    Matrix4 tranMatrix = identityMatrix();

    tranMatrix.data[3]  = x;
    tranMatrix.data[7]  = y;
    tranMatrix.data[11] = z;

    return Matrix4(tranMatrix);
} 
```

这是我的简单测试顶点着色器：

```
#version 150 core

in vec3 vPos;

uniform mat4 mvpMatrix;

void main()
{
    gl_Position = mvpMatrix * vec4(vPos, 1.0);
} 
```

我还进行了测试以检查我的矩阵乘法是否有效并且确实有效。我 * randomMatrix 仍然只是 randomMatrix

我希望你们能提供帮助。谢谢

编辑：

这就是我将矩阵数据发送到 OpenGL 的方式：

```
void DisplayObject::render()
{
    updateMatrices();

    glBindVertexArray(vaoID);
    glUseProgram(progID);
    glUniformMatrix4fv( glGetUniformLocation(progID, "mvpMatrix"), 1, GL_FALSE, &mvpMatrix.data[0] );
    glDrawElements(GL_TRIANGLES, bufferSize[index], GL_UNSIGNED_INT, 0);
} 
```

mvpMatrix.data 是一个 std::vector：

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-08T17:24:08.317

对于 OpenGL

```
1, 0, 0, 0
0, 1, 0, 0
0, 0, 1, 0
x, y, z, 1 
```

是正确的翻译矩阵。为什么？Opengl 使用*列*优先矩阵排序。这是您最初呈现的矩阵的转置，它是*行优先*排序的。大多数数学教科书和 DirectX 中都使用行专业，因此对于那些刚接触 OpenGL 的人来说，这是一个常见的混淆点。

见： http: [//www.mindcontrol.org/~hplus/graphics/matrix-layout.html](http://www.mindcontrol.org/~hplus/graphics/matrix-layout.html)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T16:41:17.967

您不能在矩阵乘法中交换矩阵，因此 A*B 与 B*A 不同。在交换矩阵之前，您必须转置 B。

```
A * B = t(B) * A 
```

尝试

```
void DisplayObject::updateMatrices()
{
    modelMatrix = identityMatrix();
    modelMatrix = translateMatrix( xPos, yPos, zPos ) * modelMatrix;

    /* update modelview-projection matrix */
    mvpMatrix = modelMatrix * (*projMatrix);
} 
```

# c# - 是否有任何事件告诉我进程正在等待输入？

> ID：13293470
> 
> 赞同：3
> 
> 时间：2012-11-08T16:38:10.590
> 
> 标签：c#, wpf, process, redirectstandardoutput

我正在通过启动一个`Process`这样的文件来处理一个 Tex 文件：

```
process p1 = new Process();
p1.StartInfo.FileName = "C:\\texlive\\2012\\bin\\win32\\pdflatex.exe";
p1.StartInfo.Arguments = FileName;
p1.consuleProcess.StartInfo.WindowStyle = ProcessWindowStyle.Hidden;
p1.consuleProcess.StartInfo.CreateNoWindow = true;
p1.consuleProcess.StartInfo.RedirectStandardOutput = true;
p1.consuleProcess.StartInfo.UseShellExecute = false;
p1.consuleProcess.StartInfo.RedirectStandardInput = true;
p1.Start();
p1.consuleProcess.BeginOutputReadLine();
p1.consuleProcess.OutputDataReceived += new DataReceivedEventHandler(p1_OutputDataReceived); 
```

`TextBox`我通过处理*OutputDataReceived*事件在 a 中显示输出字符串。

如果 Tex 文件中有错误，则应在*StandardInput*中写入一行。我认为没有事件可以告诉我，进程何时等待输入；所以我想，我可以检查*OutputDataReceived*事件来查看条件：*e.Data == "?"* 是真的。但是，问题是*StandardInput*需要一个输入，就在使用*e.Data=="?"触发**OutputDataReceived* 事件之前。

 *那么，我可以做些什么来查看进程何时等待输入？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T16:35:27.070

不确定这是否是您的意思，但您是否在追求类似的东西

```
p1.WaitForInputIdle(NumberofMilisecondstoWait) 
```

更新：

也许是这样的

```
 public void test()
        {
            p1.OutputDataReceived += new DataReceivedEventHandler(p1_OutputDataReceived);
        }

        void p1_OutputDataReceived(object sender, DataReceivedEventArgs e)
        {
            throw new NotImplementedException();
        } 
```*

# javascript - 如何禁用 URL 工具提示（状态栏）？

> ID：13293480
> 
> 赞同：0
> 
> 时间：2012-11-08T16:38:42.520
> 
> 标签：javascript, jquery, html, css, firefox

当我单击链接（或用鼠标悬停）时，URL 会显示在屏幕底部。这是 Firefox 中的默认行为。

我怎样才能防止这种情况？

我正在为触觉界面制作一个网站。

谢谢 ！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:11:35.297

您可以使用 jquery 实现此目的，首先在您的页面中包含 jquery 库，然后

在页面中编写脚本

```
 $(function(){
       $('[data-url]') //select all elements having data-url
        .click(function(e){ e.preventDefault();
         window.location.href= $(this).attr('data-url')})
    }) 
```

**并在 html**

```
<span data-url="#/inbox" >Go to inbox</span>
<a data-url="mydraft.html">Drafts</a> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T17:16:09.433

浏览器不显示什么对象会在点击时执行，所以试试这个：

```
<div onclick="location.href ='http://www.google.com';"> click me </div> 
```

或者您可以使用作为内联元素的 span：

```
<span onclick="location.href ='http://www.google.com';"> click me </span> 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T17:02:02.897

如果您使用任何其他标签会更好，而不是`<a>`假设您使用的是

`<div id='idofdiv'>`标签

查询将是

```
$('#idofdiv').click(function(){
window.open('www.google.com');
}); 
```

希望这可以帮助！！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T16:43:07.990

这是不可能的，CSS 在这里是无处可去的，你不能用 CSS 来做，你可以使用类似的东西来欺骗`<a>`链接，但我建议你不要使用所有这些，没有任何具体原因，反正他们会找到源页面的 URL

```
<a href="#" onclick="location.href ='http://www.google.com';">Spoofing</a> 
```

[**演示**](http://jsfiddle.net/6cCU4/)

注意：实际上刚刚检查过，演示不在小提琴页面上工作，只是制作一个本地`.html`页面，它会工作

# gwt - ImgButton：如何告诉 SmartGWT 不在文件源名称上连接状态？

> ID：13293489
> 
> 赞同：0
> 
> 时间：2012-11-08T16:39:23.313
> 
> 标签：gwt, state, smartgwt

```
private ImgButton button = new ImgButton();

...

button.setSrc("iconName.jpg"); 
```

GWT 或 SmartGWT，我无法准确判断，生成状态字以将其连接到文件名上。

澄清示例：

*   专注，`iconName.jpg`成为`iconName_Focus.jpg`
*   在鼠标向下单击时，`iconName.jpg`变为`iconName_Down.jpg`
*   结束，`iconName.jpg`成为`iconName_Over.jpg`

因为这些图像是自定义图像，所以我想告诉 GWT 在我没有提供相应图像的情况下拍摄默认图像。

例如，当 over 事件触发`iconName_Over.jpg`且不存在时，请使用`iconName.jpg`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T11:14:49.790

相应地使用 setShow{State} 或 setShow{State}Icon 方法。例如，要禁用鼠标按下状态，请使用 setShowDown(Boolean.FALSE)。要在鼠标按下按钮时不显示不同的图标，请使用 setShowDownIcon(Boolean.FALSE)。其余操作具有相应的命名方法，您可以在 ImgButton 的 javadoc 页面中查找。

# asp.net-mvc - 将 Javascript 回调函数传递给局部视图 MVC

> ID：13293491
> 
> 赞同：0
> 
> 时间：2012-11-08T16:39:23.857
> 
> 标签：asp.net-mvc, c#-4.0, partial-views

我想知道这是否是将 JavaScript 回调函数传递给局部视图的正确方法。因此，根据我对部分视图的看法，可能会做不同的事情。所以我传入一个 JavaScript 回调函数来实现这一点。

这是一个通用函数，用于调用我的局部视图以及我传入 JavaScript 回调函数的位置。

```
 function showAjaxMessage(targetDiv, ajaxMessage) {    
    var ajaxLoader = "<img src='Content/loader.gif' alt=''>";
    $(targetDiv).html("<p>" + ajaxLoader + " " + ajaxMessage+"</p>"); 
}

function getPartialView(actionUrl, targetDiv, ajaxMessage, cbFunc) {
    showAjaxMessage(targetDiv, ajaxMessage);

    $.get(actionUrl, { callback: eval(cbFunc).toString()}, function(result) {
        $(targetDiv).html(result);
    });
} 
```

这是我调用它的一个例子：

```
 getPartialView("Home/OpenLogin", "#divLogon", "Loading...", function() { alert('This is the call back function!'); test(); }); 
```

这是我获取回调函数并将其保存到模型的控制器。然后我将它传回局部视图。

```
 // returns a login dialog which will be injected 
    // into a placeholder div on the client
    public ActionResult OpenLogin(string callback)
    {
        var baseModel = new BaseModel();
        baseModel.cbFunc = callback;

        return PartialView("LoginDialog", baseModel);
    } 
```

这是我的部分观点的一个例子。在哪里可以看到我得到了回调函数并在 init 函数中进行了设置。

```
@model MvcApplication8.Models.BaseModel

function init(cb){
    if(cb!=undefined){
        cb();
    }
    else{
        alert("undefined");
    }
}

function test(){
    alert("Testing my call back");
}

$(function () {

   init(@Html.Raw(@Model.cbFunc));

}); 
```

上面的解决方案有效，但想到的主要问题是这样做的正确方法吗？将回调函数从控制器传递给局部视图听起来是错误的，但你会怎么做呢？有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T21:44:05.187

根据您的示例，我不明白为什么要将回调函数传递给局部视图。部分视图呈现在同一页面上的 div 内。为什么不直接在页面上声明函数，以便渲染的局部视图可以使用它呢？

# mysql - 选择上一年12月和当年11月之间的数据，MySQL

> ID：13293497
> 
> 赞同：1
> 
> 时间：2012-11-08T16:39:44.577
> 
> 标签：mysql

我正在尝试检索上一年 12 月和当年 11 月之间的统计数据。我表的`date`列的数据类型为`date`.

下面的 SQL 可以很好地解决一个明显的问题，即它仅在手动更改年份时才有效。在这一时期动态变化的年份中，如何实现同样的目标？

```
SELECT date, SUM(numCalls) AS callTotal FROM callstats_callData
WHERE date BETWEEN '2011-12-01' AND '2012-11-01'
GROUP BY date ORDER BY date 
```

PHP 正在从 MySQL 表中检索数据。

**更新**

下面的代码有效，但我希望有一个基于 SQL 的解决方案。

```
$date1 = (date("Y") - 1) . '12-01';
$date2 = date("Y") . '-11-01';
$fetchTotals = $this->contentDB->prepare("SELECT date, SUM(numCalls) AS callTotal FROM callstats_callData
WHERE date BETWEEN ? AND ?
GROUP BY date ORDER BY date");
$fetchTotals->execute(array($date1, $date2));
$totals = $fetchTotals->fetchAll(); 
```

**工作示例**

这是为了在[此处](http://callaovfd.org/call-stats)检索 Total Calls 图表的呼叫数据。需要循环检索结果，以便显示该时间段内每个月的总数。此页面目前使用上面的 PHP 和 MySQL 代码正常工作，只是希望有一个基于 SQL 的解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:05:57.710

这为您在为更新的查询选择任意月份和日期值时提供了一些灵活性 - 正如您在发布的 PHP 代码中设置的那样：

```
SELECT date, SUM(numCalls) AS callTotal 
FROM callstats_callData
WHERE DATE(date) 
BETWEEN CONCAT(YEAR(CURDATE())-1,'-12-01') AND CONCAT(YEAR(CURDATE()),'-11-01')
GROUP BY date ORDER BY date; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:44:15.837

您可以使用上述查询并采用参数 startDate 和 endDate 创建一个存储过程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:00:23.377

你可以这样做：

```
SELECT 
    date, SUM(numCalls) AS callTotal 
FROM 
    callstats_callData
WHERE 
    (MONTH(date) >= 12 AND YEAR(date) = (YEAR(NOW()) - 1)) OR 
    (YEAR(date) = YEAR(NOW()) AND MONTH(date) < 11);
GROUP BY 
    date 
ORDER BY 
    date 
```

* * *

**编辑：** 看到你的评论，我想最好的方法是：

```
SELECT 
    date, SUM(numCalls) AS callTotal 
FROM 
    callstats_callData
WHERE 
    (MONTH(date) >= 12 AND YEAR(date) = (YEAR(NOW()) - 1)) OR 
    (YEAR(date) = YEAR(NOW()) AND MONTH(date) < 11);
GROUP BY 
    YEAR(date), MONTH(date) 
ORDER BY 
    date 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T17:01:21.807

sql 函数 YEAR(GETDATE()) 返回当前年份。您可以尝试在查询中使用它。

# c++ - 如何将对象列表传递给函数

> ID：13293499
> 
> 赞同：1
> 
> 时间：2012-11-08T16:39:50.833
> 
> 标签：c++, arrays, list

我正在编写一个应该接收书籍对象列表作为参数的函数。在每个书籍对象中都有一个私有数据成员价格。该功能假设比较每本书的价格并返回价格最高的书。

```
//Client program
#include <iostream>
#include "Book.h"
#include "textbook.h"
#include "Name.h"
#include "unsorted.h"
using namespace std;

int main()
{

book b1("The Exception to the Rulers", "Amy", "Goodman", "Hyperion", 342, "1-4013-0131", 21.95,'N'); // this is the title, authors first & last name, publisher, number of pages, isbn number, price, and code.
book b2("Who moved my cheese", "Spencer", "Johnson", "Red Tree", 95, "0-399-14446-3", 19.99,  'H');
book b3("Hellbound Hearts", "Neil", "Gaiman", "Dark Harvest", 326, "978-1-4391-4090-1", 16.00, 'F');

UnsortedType L1; // creating a list "L1" with the default vaule lengh 0

L1.InsertItem(b1); // populating the list with the first book
L1.InsertItem(b2); // populating the list with the second book
L1.InsertItem(b3); // populating the list with the third book 
```

主要是我不确定如何将实际列表“L1”或 L1 的内容传递给将比较价格的函数。我想我很困惑，因为为了调用函数 getMostExpensive 我会做一些类似的事情：

```
L1.getMostExpensive(); 
```

但是如果我用 L1 调用我的函数，我是否必须传递任何参数，如果没有，那么我如何访问函数 getMostExpensive() 内部的私有数据成员价格？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:58:05.147

为什么要`price`成为私有成员`book`？在我看来，“每个人”都应该能够知道一本书的价格......

如果您确实可以将其公开，为什么不使用更简单`std::vector<book>`的免费功能`getMostExpensive()`呢？

```
#include <vector>

...

std::vector<book> L1; 

L1.push_back(b1); // include first book
L1.push_back(b2); // include second book
L1.push_back(b3); // include third book

...

// free function
book getMostExpensive(const std::vector<book>& b) {

    double maxPrice=0;
    unsigned int maxInd;
    for(unsigned int i=0; i<b.size(); ++i){
        if (b[i].price > maxPrice){
            maxInd = i;
            maxPrice = b[i].price;
        }
    }
    return b[maxInd];
} 
```

如果你必须保留，你`price` `private`可以做`UnsortedType`一个`friend`：`book`

```
class UnsortedType;
class book {
    ...
    friend class UnsortedType;
    ...
}; 
```

在这种情况下`L1`，可以访问`book`.

然而，我的默认经验法则是，只要我需要`friend`'s，我的设计就有缺陷：p

您还可以使用 getter/setter 方法：

```
class book 
{
private:
    double _price; // the actual price

public: 
    const double& price // read-only copy of price

    // constructor
    book(...);

    // price-setter
    void setPrice(double newPrice);

};

// constructor initializes const reference to private member _price
book::book(...) : price(_price) {...}

void book::setPrice(double newPrice) { _price = newPrice>=0.0?newPrice:0.0; }

...

int main(...){
    book b;
    ...
    double P = b.price;  // valid
    b.price = 56.8;      // NOT valid; compile-time error

    b.setPrice(56.8);    // valid; this is the only way to set the price

} 
```

# javascript - 如何使用 goog.module 动态加载模块

> ID：13293508
> 
> 赞同：3
> 
> 时间：2012-11-08T16:40:11.743
> 
> 标签：javascript, google-closure, google-closure-library

我想使用google闭包库的goog.module来实现JS模块延迟加载。

我已经能够通过键入来使用这些模块`goog.require(module_name)`。但是，脚本模块将以这种方式在开始时加载。所以我想通过使用 goog.module 动态加载模块（延迟加载）。但我发现 goog.module 的文档很难理解。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T09:40:30.587

我能找到的关于模块的唯一“文档”是提到了 Plovr 中对模块的支持：http: [//plovr.com/](http://plovr.com/)

所以 Plovr 库的源代码 ( [https://code.google.com/p/plovr/](https://code.google.com/p/plovr/) ) 是我知道的唯一“文档”。

# java - Android 2.1 似乎没有刷新输出流

> ID：13293510
> 
> 赞同：1
> 
> 时间：2012-11-08T16:40:21.717
> 
> 标签：java, android, http, rest

我们在 Android 中遇到了一些非常奇怪的行为。我们的网络堆栈（与 REST 服务器通信）几乎在所有情况下都能正常工作，除非我们在执行较大的 POST 后不久执行 GET。似乎正在发生的事情是输出流没有刷新，并最终发送打开新套接字时那里的最后一行。请注意，每个连接都是一个新创建的对象，因此这是意外行为。首先，似乎将我指向输出流的错误代码，这些来自服务器日志。

> 10.1.8.195 - - [07/Nov/2012:13:36:28 -0700]“POST /iou/lender HTTP/1.1”200 28“-”“Android”10.1.8.195 - - [2012 年 11 月 7 日： 13:36:36 -0700]“------------V2ymHFg03ehbqgZCaKO6jy”400 173“-”“-”

之后的尝试应该是 GET，然后从服务器中提取数据，其中包括通过 POST 添加的新条目。然而，我们得到的只是 POST 输出流的最后一行。这是我们网络栈的核心代码，如果需要更多的周边代码，请告诉我。

```
public Object serverConnect(String url, String method,
        Hashtable<String, Object> params) {

    HttpConnection c = null;
    InputStream is = null;
    OutputStream out = null;
    ByteArrayOutputStream postDataByteArrayImage = new ByteArrayOutputStream();
    byte[] data;
    String boundry = "----------V2ymHFg03ehbqgZCaKO6jy";
    try {
        if (!url.startsWith("/")) {
            url = "/" + url;
        }
        String uri = Control.URL_Secure + Control.dtserver + ":"
                + Control.port + url;
        ByteArrayOutputStream postDataByteArray = new ByteArrayOutputStream();

        params.put("sessionId", Control.sessionId);

        if (method.equals("GET")) {
            uri = uri + "?";
            Enumeration enumParams = params.keys();
            while (enumParams.hasMoreElements()) {
                if (!uri.endsWith("?")) {
                    uri = uri + "&";
                }
                String key = (String) enumParams.nextElement();
                uri = uri
                        + key
                        + "="
                        + java.net.URLEncoder.encode((String) params
                                .get(key));

            }
        } else if (method.equals("POST")) {
            Enumeration enumParams = params.keys();
            postDataByteArray.write(("--").getBytes());
            postDataByteArray.write((boundry).getBytes());
            postDataByteArray.write(("\r\n").getBytes());
            while (enumParams.hasMoreElements()) {
                String key = (String) enumParams.nextElement();
                if (!key.equals("image")){
                    postDataByteArray
                            .write(("Content-Disposition: form-data; name=\"")
                                    .getBytes());
                    postDataByteArray.write((key).getBytes());
                    postDataByteArray.write(("\"").getBytes());
                    postDataByteArray.write(("\r\n\r\n").getBytes());
                    postDataByteArray.write(((String) params.get(key))
                            .getBytes());
                    postDataByteArray.write(("\r\n").getBytes());
                    postDataByteArray.write(("--").getBytes());
                    postDataByteArray.write(boundry.getBytes());
                    postDataByteArray.write(("\r\n").getBytes());
                }
            }
            postDataByteArray.close();

        }
        Log.i("URL", uri);
        URL urltoConenct = new URL(uri);
        URLConnection connection = urltoConenct.openConnection();
        HttpURLConnection urlConnection = (HttpURLConnection) connection;

        URLConnection.setDefaultRequestProperty("Method", method); // default
        urlConnection.setRequestProperty("User-Agent", "Android");
        if (method.equals("POST")) {
            urlConnection.setDoOutput(true);
            urlConnection.setFixedLengthStreamingMode(postDataByteArray.toByteArray().length + postDataByteArrayImage.toByteArray().length);
            urlConnection.setRequestProperty("Content-Type",
                    "multipart/form-data; boundary=" + boundry);
            out = urlConnection.getOutputStream();
            out.write(postDataByteArray.toByteArray());
            out.write(postDataByteArrayImage.toByteArray());
            out.close();
        }
        int response = 0;
        try {
            response = urlConnection.getResponseCode();
        } catch (IOException e) {
            if (e.toString()
                    .equals("java.io.IOException: Received authentication challenge is null"))
                throw new RESTException(401, "Invalid Phone or Pin");
            else
                throw e;
        }

        if (response == HttpURLConnection.HTTP_OK) {

            is = urlConnection.getInputStream();
            if (is == null) {
                return new IOException(
                        "Cannot open HTTP InputStream, aborting");
            }

            ByteArrayOutputStream bo = new ByteArrayOutputStream();
            int ch;
            int count = 0;

            while ((ch = is.read()) != -1) {
                bo.write(ch);
                count++;

            }
            data = bo.toByteArray();

            return new String(data);
        } else if (response == 500) {
            return new RESTException(500, "Internal server error");
        } else {
            RESTException x = new RESTException();
            x.setCode(response);
            try {
                is = urlConnection.getInputStream();
                if (is == null) {
                    x.setMessage("Unable to retrieve message");
                    return x;
                }

                ByteArrayOutputStream bo = new ByteArrayOutputStream();
                int ch;
                int count = 0;

                while ((ch = is.read()) != -1) {
                    bo.write(ch);
                    count++;
                }
                data = bo.toByteArray();

                String output = new String(data);
                JSONObject obj;

                try {

                    obj = new JSONObject(output);
                    JSONObject err = obj.getJSONArray("errors")
                            .getJSONObject(0);
                    x.setMessage(err.getString("message"));
                } catch (JSONException e) {
                    Log.e("stuff", output);
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            } catch (FileNotFoundException e) {
                // Damn you android! I'm using a REST service here, stop
                // trying to interpret my errors!
                x.setMessage("Unable to retrieve message");
            }
            return x;
        }
    } catch (Exception x) {
        x.printStackTrace();
        /*
         * if (!retried && x.toString().equals(
         * "java.io.IOException: Persistent connection dropped after first chunk sent, cannot retry"
         * )) { retry = true; } if (!retry) { return x; }
         */
        return x;
    } finally {
        try {
            out.close();
        } catch (Exception x) {

        }
        try {
            is.close();
        } catch (Exception x) {

        }
        try {
            c.close();
        } catch (Exception x) {

        }
        params.clear();

    }

    // return null;
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T13:10:53.690

经过很长时间的挫折，我们发现即使您手动调用连接上的 .close()，Android 也会尝试保持连接处于活动状态。这对我们的 GET 方法很有效，但是 POST 方法使套接字处于无法处理 GET 的状态。添加以下内容解决了我们所有的问题：

```
urlConnection.setRequestProperty("connection", "close"); 
```

# c# - 如何忽略搜索条件中的空属性

> ID：13293511
> 
> 赞同：3
> 
> 时间：2012-11-08T16:40:23.717
> 
> 标签：c#, linq

我有一个不好的要求要做；无论如何，我必须在我的应用程序中实现它。

我有一`Track`堂课

```
public class Track
{
    public string Name { get; set; }
    public string City { get; set; }
    public string Country { get; set; }
} 
```

我有一些测试数据

```
List<Track> Records = new List<Track>
{ 
    new Track { City = "a", Name = "a",  Country = "i" }, // Track 1
    new Track { City = "b", Name = "b",  Country = "i" }, // Track 2
    new Track { City = "a", Name = null, Country = "J" }, // Track 3
    new Track { City = "c", Name = "a",  Country = "J" }, // Track 4
    new Track { City = "b", Name = "a",  Country = null}, // Track 5
}; 
```

要求是我应该`Records`根据传递的值查询数据。如果有任何属性，`null`则搜索条件应忽略该属性。它应该根据`NonNull`属性进行查询。

**示例**：

```
If i query for City = a, Name = "b", Country = "i" then Result is: Track 1 & Track 3
If i query for City = c, Name = "p", Country = "w" then Result is: Track 4 
```

`Name`&在&中有空`Country`值。所以它会在搜索中忽略。希望清楚`Track 3``Track 5`

我终于明白了以下逻辑

```
var filterRecords = new List<Track>();
if (!Records.Any(t => string.IsNullOrWhiteSpace(t.City)))
{
    filterRecords = Records.Where(c => c.City == _city).ToList();  // Here _city is the method parameter.. assume "a"
}

if (!Records.Any(t => string.IsNullOrWhiteSpace(t.Country)))
{
    filterRecords = filterRecords.Where(c => c.City == _country).ToList();  // Here _country is the method parameter.. assume "c"
} 
```

`Track`类有 12 个属性。像上面那样检查 12 次不是好兆头。我想通过使用`LINQ`或任何其他简单的方法来实现这一点。

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T17:06:48.647

我想到的最佳解决方案是构建聚合过滤器（您可以为此使用 Track 对象，因为它已经具有过滤集合的所有可能属性，并且它们可以为空）：

```
Track filter = records.Aggregate(
    new Track() { City = _city, Country = _country, Name = _name },
    (f, t) => new Track()
    {
        City = String.IsNullOrEmpty(t.City) ? null : f.City, 
        Country = String.IsNullOrEmpty(t.Country) ? null : f.Country,
        Name = String.IsNullOrEmpty(t.Name) ? null : f.Name
    },
    f => f); 
```

这将只需要对集合进行一次迭代即可定义哪些字段为空。然后只需将过滤器应用于您的记录：

```
var query = from t in Records
            where (filter.City == null || t.City == filter.City) &&
                    (filter.Country == null || t.Country == filter.Country) &&
                    (filter.Name == null || t.Name == filter.Name)
            select t; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:46:28.500

您可以轻松地将这些表达式链接在一起以创建如下所示的内容。枚举记录 X 次会减慢您的代码速度。例子：

```
var actualResult = Records
       .Where(x => x.City == _city || string.IsNullOrEmpty(x.City))
       .Where(x => x.Country == _country || string.IsNullOrEmpty(x.Country))
       /// .... and so on
       .ToList() 
```

现在，如果您不仅要编写 12 行代码，还有更复杂的解决方案涉及反射和映射，但在这种情况下并不真正需要。如果您的财产数量很大，那么也许值得。但是 12 个属性足够小，对我来说没有太多代码气味。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:53:23.157

如果我理解的话，应该很简单：

```
var results = Records.Select(p => p.City != null && 
              p.Country != null && 
              p.Name != null).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:56:51.013

返回结果的质量和数量对您来说重要吗？我假设您有处理数量的机制。

您可以在抛出查询之前验证您的搜索关键字。你只关心空值吗？多余的关键字怎么办？我会考虑： 1\. 验证关键字 - 12 可以循环。2\. 建立搜索关键字强 3\. 进行查询

看起来很简单，除非它比您在此处描述的更多。

如果我对您的问题的理解不在预期的方向，请纠正我。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-08T16:48:58.570

像这样的东西

```
var listRecords = from track in Records
where (track.city == _city && !string.IsEmpyOrNull(track.city)) && 
(track.Name== _name && !string.IsEmpyOrNull(track.Name))
select track; 
```

你可以添加其余的条件

# asp.net - ASP.NET Web 应用程序在测试服务器上工作，但不在生产服务器上

> ID：13293512
> 
> 赞同：0
> 
> 时间：2012-11-08T16:40:23.953
> 
> 标签：asp.net, .net, iis, iis-7.5, production-environment

我有一个应用程序，我们最近从网站转换为 Web 应用程序，并迁移到更现代的服务器。

在对我所说的“测试盒”进行了一些严格的测试之后，我们推出了新版本的应用程序，但我们遇到了一些奇怪的错误，其中一些给我们的用户带来了真正的麻烦。

当我按下之前执行某些操作的按钮时，它现在会导致路径 ScriptResource.axd?d=aaabbbbccc[ *snip* ] 出现 404 错误（使用 Chrome 开发工具查看）。

该功能在测试盒上运行良好，并且两个盒子上的 web.config 文件相同。ASP.NET、MVC等都安装在生产箱上，和测试箱上一样。生产盒和测试盒均在 Windows Server 2008 上运行 IIS7.5。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:47:32.100

您是否检查过 Stackoverflow 上的其他类似问题？

[ScriptResource.axd 404 未找到](https://stackoverflow.com/questions/3798020/scriptresource-axd-404-not-found)

[asp net 4 应用程序中的 scriptresource.axd 404 错误 - 虽然 webresource 工作正常](https://stackoverflow.com/questions/4797435/scriptresource-axd-404-error-in-asp-net-4-application-webresource-works-fine-t)

[.axd 文件生成 404 错误](https://stackoverflow.com/questions/1098548/axd-files-generate-a-404-error)

[当我浏览 http://localhost:8004/elmah.axd 时，它会生成 404 错误](https://stackoverflow.com/questions/11015013/when-i-browse-http-localhost8004-elmah-axd-it-generates-404-error)

# jquery - 同一页面上具有不同图像的多个工具提示

> ID：13293514
> 
> 赞同：0
> 
> 时间：2012-11-08T16:40:27.200
> 
> 标签：jquery, jquery-tooltip

我已经使用 JQuery 工具制作了一些工具提示，效果很好，但我希望在同一页面上使用不同的图像提供第二个工具提示，但我不知道如何操作。这是我的代码：

```
<span id="tip">
    <img src="images/info20.png" title="(popup text)" />
</span>

$(function() {  
    $("#tip img[title]").tooltip({position: "top right", offset:[0,-25]});
});

.tooltip {
    display:none;
    font-family: arial;
    background: url(../images/purple.png);
    font-size:11px;
    height:70px;
    width:160px;
    padding:25px;
    color:#fff; 
} 
```

我认为我应该能够制作一个与此相同的图像，但将“tooltip”更改为“tooltip2”并在 CSS 中选择不同的图像，但这不起作用。任何人都可以帮忙吗？不幸的是，JQuery Tools 上的论坛似乎坏了，所以我在那里得不到任何帮助。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:46:51.977

您可以使用`content`以下选项设置工具提示的内容：

```
$(function() {  
  $("#tip img[title]").tooltip({
    content: 'Some Mighty Tooltip', 
    position: "top right", 
    offset:[0,-25]});
}); 
```

您可以在此处使用常量字符串，也可以使用函数。[**它实际上在那个小部件文档页面**](http://api.jqueryui.com/tooltip/)中描述得很好。

# sql - dm_db_partition_stats 何时更新？

> ID：13293516
> 
> 赞同：1
> 
> 时间：2012-11-08T16:40:46.977
> 
> 标签：sql, sql-server, function, scalar

我想创建一个标量 SQL 函数，该函数使用 dm_db_partition_stats 检查表的行数。我有一些表被推送给我，在此期间使用这些表的工具变得无用。

我在另一台服务器上备份了这些表。我想做的是检查行数。如果结果为 0，则标量函数将返回 1。在 .NET 前端，如果返回 1，则可以查询备份数据。

我的问题是行数何时会在 dm_db_partition_stats 中更新？是立即进行还是有一些滞后？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:42:48.453

动态管理视图直接返回有关服务器当前内部状态的信息，因此它们是尽可能即时和实时的。但是，该视图的行数只能保证为近似值，如果在插入或删除行的过程中存在活动事务，则您获得的计数可能与您实际查询表时看到的相匹配，也可能不匹配。因此，根据您的描述，随后运行的代码可能找不到它所期望的。

# javascript - 嵌套回调

> ID：13293518
> 
> 赞同：2
> 
> 时间：2012-11-08T16:40:55.090
> 
> 标签：javascript, asynchronous, callback

我在异步 javascript 方面不是很有经验。如何在不硬编码命令数量或使用 eval 的情况下调用命令？

```
var commands = [
    // command 1: result: 0, stdout: ""
    function (stdin, callback) {
        callback(0, "");
    },
    // command 2: result: 1, stdout: ""
    function (stdin, callback) {
        callback(1, "");
    },
    // command 3: result: 0, stdout: ""
    function (stdin, callback) {
        callback(0, "");
    },
    // ...
];

var stdin = "foo";
var end = function (result, stdout) {
    console.log(result);
    console.log(stdout);
};

commands[0](stdin, function (result, stdout) {
    commands[1](stdout, function (result, stdout) {
        commands[2](stdout, end);
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:01:03.157

**最终答案：**

我正在使用递归来遍历命令数组。您向循环函数传递一个命令数组和要调用的最后一个回调（您也可以将希望开始循环的数组的索引作为第四个可选参数传递 - 默认为零）。

```
var commands = [
    // echo foo
    function (stdin, callback) {
        callback(0, "foo");
    },
    // touppercase
    function (stdin, callback) {
        callback(1, stdin.toUpperCase());
    }
];

var stdin   = "",
    loop    = function(commands, lastCallback, stdin, startIndex) {
        (function insideLoop(i, stdout) {
            commands[i](stdout, (i + 1 < commands.length) ? function(result, stdout){ insideLoop(i + 1, stdout); } : lastCallback); 
        })(startIndex || 0, stdin);
    },
    end     = function (result, stdout) {
        console.log(stdout);
    };

loop(commands, end, stdin); 
```

**[代码示例](http://jsfiddle.net/xuyGT/2/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:45:58.407

要让这些函数*异步*运行，您需要一种调用它们的方法，确保在调用之间，允许浏览器（或实际上任何实现）执行其他操作（清理、重排等）。

这可以`.setTimeout`在浏览器或`.nextTick`nodejS 中完成。

```
function runAsync( list ) {
    (function _worker( method ) {
        method();

        if( list.length ) {
            setTimeout(function() {
                _worker( list.shift() );
            }, 100);
        }
    }( list.shift() ));
} 
```

这会被称为

```
runAsync( commands ); 
```

它会连续抓取下一个数组条目（假设是一个函数）并执行它。之后，我们检查该条目中是否有更多元素，如果有，则获取下一个并调用下一个函数。这发生在一个`setTimeout`呼叫和*100ms*的延迟内。我在这里选择了*100 毫秒*，因为它几乎是人类不会看到任何“减速”或“滞后”的时间范围。

# ibm-mq - MQ (Websphere 7) 将消息持久化到文件系统

> ID：13293522
> 
> 赞同：3
> 
> 时间：2012-11-08T16:41:00.567
> 
> 标签：ibm-mq

我将如何设置 MQ 以便收到的每条消息都立即写入文件系统？我有“红皮书”，但至少需要有人至少指出我书中的一章或标题来弄清楚。

我们是一家 .NET 商店。我已经通过 API 编写了 C# 来读取队列，我们​​目前使用 BizTalk MQ 适配器。我们的最终目标是将相同的消息写入文件系统中的多个目录，以“克隆”我们各种测试环境（DEV、STAGE、TRAINING 等）的提要。BizTalk 的问题在于，当我们消费消息时，我们同时将其映射到新消息，因此消息已经更改，我们希望克隆原始原始消息，而不是变形消息。我们的供应商不提供提要的多个副本，例如，他们提供 DEV 和 PROD，但我们内部有 4 个系统。

我想我可以做一个 C# Windows 服务来做到这一点，但如果可能的话，我宁愿使用 MQ 的内置功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T20:33:43.887

无需配置。如果消息是持久的，WMQ 会将其写入磁盘。但是，我认为这对您没有帮助，因为它们不是作为离散消息编写的。没有要复制的磁盘文件，并且仅当复制的 QMgr 与主 QMgr 相同并且在复制期间处于脱机状态时，复制才有效。

这个问题有很多解决方案，但从 WMQ V7 开始，最简单的一个是使用内置的 Pub/Sub 功能。这假设消息通过 QMgr-to-QMgr 通道到达并到达队列，然后您可以在该队列中使用它们。

在这种情况下，可以删除队列并在主题上创建同名别名。然后，您创建一个新队列并定义一个管理订阅，将主题上的消息传递到新队列中。您的应用从新队列中使用。

当您需要将提要发送到另一个 QMgr 或应用程序时，定义一个新订阅并将其指向新的目标队列。由于这是 Pub/Sub，MQ 将复制原始消息的次数与订阅数量相同，并且第一个应用程序及其消息不受影响。如果您需要发送到的目标无法通过 MQ 通道访问（例如，可能 DEV 和 QA 未连接），您可以将消息传递到新队列，使用[SupportPac MO03](http://ibm.co/SupptPacMO03)中的 QLoad 将它们写入文件并然后使用另一个 QLoad 实例将它们加载到不同的 QMgr 上。如果您想实时移动它们，您可以从[SupportPac MA01设置 Q 程序](http://ibm.co/SupptPacMA01)将它们直接从 QMgr1 上的新订阅队列移动到 QMgr2 上的目标队列。您可以根据需要在多个系统之间进行复制。

SupportPacs 主页在[这里](http://ibm.co/SupptPacs)。

如果您使用的只是红皮书，您可能想看看信息中心。请务必使用与您正在使用的 WMQ 版本匹配的信息中心。

*   [WMQ V7.0 信息中心](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r0/index.jsp)
*   [WMQ V7.1 信息中心](http://publib.boulder.ibm.com/infocenter/wmqv7/v7r1/index.jsp)
*   [WMQ V7.5 信息中心](http://pic.dhe.ibm.com/infocenter/wmqv7/v7r5/index.jsp)

# android - 覆盖 Activity 布局的片段

> ID：13293527
> 
> 赞同：2
> 
> 时间：2012-11-08T16:41:11.697
> 
> 标签：android, android-layout, android-activity, fragment

我在处理片段时遇到问题。问题是：我的活动中有一个带有 ListView 的布局。当我在此 ListView 中选择一个项目时，实例化一个替换活动布局的片段。我的结果是片段和活动内容都显示在屏幕上，相互重叠。我能解决什么问题（片段只是替换活动内容）？这是代码：

活动布局.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent" 
android:layout_height="match_parent"
android:id="@+id/activity" 
android:orientation="vertical">

   <FrameLayout android:id="@+id/fragment_to_replace"
        android:layout_width="wrap_content" 
        android:layout_height="wrap_content"
        android:visibility="visible"
        android:orientation="vertical"
        android:layout_gravity="center" >

       <TextView android:id="@+id/textView"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:visibility="visible"
            android:text="@string/textView_select_table"
            android:textSize="30dp"/>

       <ListView android:layout_marginTop="20dp"
         android:layout_width="fill_parent"
         android:layout_height="200dp"
         android:id="@+id/listView"
         android:visibility="visible" 
         android:paddingTop="40dp" />

   </FrameLayout>

</LinearLayout> 
```

活动.java

```
 public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity);

    View view = findViewById(R.id.activity);    

    //Getting the ListView
    ListView listView = (ListView) view.findViewById(R.id.listView);
    listView.setTextFilterEnabled(true);

    //Setting the adapter
    listView.setAdapter(new Adapter(this));

    listView.setOnItemClickListener(new OnItemClickListener() {

            @Override
        public void onItemClick(AdapterView<?> parent, View view, int position,
                long id) {

              //Creates a fragment 
              addFragment();
        }

    });

}

 public void addFragment(){

     MyFragment newFragment;

     FragmentTransaction newFragmentTransaction = getSupportFragmentManager().beginTransaction();

     newFragment = (MyFragment) getSupportFragmentManager()
            .findFragmentById(R.id.fragment);

      if (newFragment == null){
               newFragment = new MyFragment(this, getSupportFragmentManager());
           newFragmentTransaction.replace(R.id.fragment_to_replace, 
                new SelectDrinkFragment(this,   getSupportFragmentManager()));
           newFragmentTransaction.addToBackStack(null);
           newFragmentTransaction.commit();

      }
 } 
```

片段布局.xml

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
   android:id="@+id/fragment"
   android:layout_width="fill_parent"
   android:layout_height="fill_parent"
   android:orientation="vertical" >

   <TextView  
     android:layout_width="fill_parent"
     android:layout_height="wrap_content"
     android:visibility="visible"
     android:text="@string/textView_two"
     android:textSize="20dp"/>

     <LinearLayout android:layout_marginTop="10dp"
       android:layout_width="match_parent"
       android:layout_height="wrap_content"
       android:orientation="horizontal">

        <TextView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:visibility="visible"
        android:text="@string/textView" />

        <TextView android:id="@+id/textView_two"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:visibility="visible"/>

    </LinearLayout>

    <TextView 
      android:id="@+id/textView_three"
      android:layout_marginTop="10dp"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content"
      android:visibility="visible"
      android:text="@string/textView_three"/>

     <ListView 
   android:layout_width="fill_parent"
   android:layout_height="0dp"
   android:layout_weight="1" 
   android:id="@+id/listView_two"
   android:visibility="visible" 
   android:paddingTop="40dp" />

 </LinearLayout> 
```

片段.java

```
 public View onCreateView(final LayoutInflater inflater, final ViewGroup container,      Bundle saveInstanceState){

    View view = inflater.inflate(R.layout.fragment, container, false);  

    final ListView listView = (ListView) view.findViewById(R.id.listView_two); 

    CharSequence [] list = getResources().getStringArray(R.array.array);

    listView.setAdapter(new ListAdapter(getContext(), list));

    return view;

 } 
```

ListAdapter.java

```
 public class ListAdapter extends BaseAdapter{

      private Context context;
      private CharSequence[] drinkArraySize;

      public ListAdapter(Context context, CharSequence[] array){
          super();
          this.context = context;
          this.array= array;
      }

      @Override
      public int getCount() {
        return array.length;
      }

      @Override
      public Object getItem(int position) {
        return null;
      }

     @Override
     public long getItemId(int position) {
       return 0;
     }

     public Context getContext(){
          return context;
     }

     @Override
     public View getView(int position, View convertView, ViewGroup parent) {

        LinearLayout linearLayout = new LinearLayout(getContext());

        RadioButton radioButton = new RadioButton(getContext());
        radioButton.setText(array[position]);

        linearLayout.addView(radioButton);

        return linearLayout;
     }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T17:08:57.530

FragmentTransaction.replace() 看起来它只替换了另一个片段（而不仅仅是任何视图），所以我很确定这是预期的行为（或者至少，我知道我以前遇到过这种情况）。我想你有几个选择：

1.  我在您的代码中没有看到任何会使片段的背景不透明的内容。您可以先尝试一下，看看是否有帮助。如果是这样，那可能是最简单的。

2.  您可以在执行事务的同时将其他项目的可见性设置为 View.GONE，但就 backstack 而言，这存在一些问题。

3.  您可以将 ListView 和 TextView 替换为 ListFragment。这可能是“最好”的方法，但也可能是最多的工作。

# vba - 以名称中的数据日期保存新的电子表格

> ID：13293531
> 
> 赞同：0
> 
> 时间：2012-11-08T16:41:27.070
> 
> 标签：vba, excel

我想保存一个从 Internet 下载的文件，其中包含文件名中数据所在月份的名称。我遇到的问题是我不能只得到一个月。我在 VBA 中以 mm/dd/yyy 格式获取整个日期。日期在工作表中采用 mm/dd/yyy h:mm 格式。我想把它转换为那个月，所以我把月份放在文件名中并保存了它。VBA 将其视为 mm/dd/yyy，因此无法将其添加到文件名中。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:52:15.910

Given`Range("A1")`保存您想要获取月份的日期，请写下：

```
Dim myDate as String
myDate = Format(Range("A1"),"mmmm")) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T07:09:28.100

以今天为例，

```
Dim myDate as String
' if you want to get November 
myDate = monthname(month(date))  
'or 
myDate = Format(date,"mmmm")

'if you want to get 11
myDate = month(date) 

'if you want to get Nov
myDate = Format(date, "mmm")
' or LEFT the November to 3 characters 
```

# solr - Solr - 1.4 中的“分组依据”

> ID：13293536
> 
> 赞同：2
> 
> 时间：2012-11-08T16:41:49.063
> 
> 标签：solr, group-by

我在网上寻找答案，但找不到答案。

假设我在 solr 中有涉及人员的文档。每个文档（人）都有“公司名称”和“出生日期”字段。如何检索每个公司中最年长的人的出生日期？我真正寻找的是在出生日期执行最小功能的选项，并按公司分组。

我必须提到我使用 solr 1.4。

提前谢谢你，哈达斯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-10T01:06:55.563

有一个类似的功能称为 FieldCollapsing，但它仅适用于 solr 3.3 及更高版本。

[https://wiki.apache.org/solr/FieldCollapsing](https://wiki.apache.org/solr/FieldCollapsing)

# asp.net - OnPostAuthenticateRequest 中的 HttpContext.Current.Session 为空

> ID：13293537
> 
> 赞同：0
> 
> 时间：2012-11-08T16:41:49.957
> 
> 标签：asp.net, asp.net-mvc, session

这是一个n00b问题，也许您可​​以提供帮助。

当我参加`Application_OnPostAuthenticateRequest`活动时，我无法查看`Session`since `HttpContext.Current.Session`is null。是否有理由认为这是空的，有没有办法`Session`在此事件期间访问？

除了会话状态之外，是否还有其他事件允许我获取经过身份验证的用户？

谢谢！布雷特

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:50:53.393

在引发[事件](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.postacquirerequeststate%28v=vs.100%29.aspx)`Session`之前将不可用。[`PostAcquireRequestState`](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.postacquirerequeststate%28v=vs.100%29.aspx)

# lotus-domino - LEI windows Service 使 Lotus domino 服务器崩溃

> ID：13293538
> 
> 赞同：0
> 
> 时间：2012-11-08T16:41:51.180
> 
> 标签：lotus-domino

我遇到了 LEI windows 服务的问题。

Lotus Notes Domino Server 是系统组件 LEI - Service

两者都是windos服务。LEI 依赖于 Lotus domino 服务器。

这几天我遇到了一个奇怪的问题，LEI 服务没有运行，当我启动它时，它使 lotusnotes domino 服务器崩溃。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:02:26.780

过去，我遇到了几个导致多米诺骨牌崩溃的 LEI 问题。一些建议： - 服务器是否因特定活动而崩溃？什么样的活动？可以访问此活动使用的数据库吗？- 检查 LEI 日志 (leilog.nsf) 损坏时，创建一个新日志。- 检查您的 LEI 活动。服务器崩溃时正在运行或计划运行的所有活动都应使用“重置活动”操作（菜单操作 - 活动管理 - 重置活动）进行重置。- 日志记录：您使用大量日志记录吗？有一个选项“缓冲区日志”。当有非常多的信息要记录时，我遇到了这个问题（它会导致 OutOfMemory，因为日志被缓冲而不是永久写入日志文档）

# youtube-api - 无效的开发人员密钥

> ID：13293541
> 
> 赞同：3
> 
> 时间：2012-11-08T16:42:00.230
> 
> 标签：youtube-api

我在构建应用程序时达到了 youtube api 配额限制，因此我在请求中添加了开发人员密钥，现在我收到 403 错误：无效的开发人员密钥。

我已经尝试多次重新创建我的项目和 api 密钥，但没有任何运气。我尝试将密钥添加到 URI 并在标头中发送：

```
$c1 = curl_init($feedURL);
curl_setopt($c1, CURLOPT_HTTPHEADER, array(
   'X-GData-Key: key=AIzaS...',
   'GData-Version: 2'
)); 
```

我的应用程序很简单，所有请求的数据都是公开的，所以我看不到使用 Zend PHP 客户端的理由。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T19:19:39.277

您在查询 API 的 v2 时使用了 v3“API 密钥”。

v3“API 密钥”是从[https://code.google.com/apis/console/](https://code.google.com/apis/console/)的访问选项卡获取的，用于向该控制台上列出的任何 API 发出未经身份验证的请求。

v2“开发者密钥”是从[http://code.google.com/apis/youtube/dashboard/](http://code.google.com/apis/youtube/dashboard/)获得的，是您正在寻找的。

我相信其中一个目标是改进 API 的 v2 以开始从 API 控制台支持“API 密钥”，但目前这还不可能。

# cloud-foundry - CloudFoundry node-mongodb 应用程序总是返回 502

> ID：13293544
> 
> 赞同：1
> 
> 时间：2012-11-08T16:42:07.250
> 
> 标签：cloud-foundry

我按照cloudfoundry指南页面提供的步骤操作： [http](http://cndocs.cloudfoundry.com/services/mongodb/nodejs-mongodb.html) ://cndocs.cloudfoundry.com/services/mongodb/nodejs-mongodb.html 前两个步骤都可以，本地和服务器都可以。但是当我添加代码连接mongodb时，它在本地工作，但在服务器上，它只返回502。有人有线索吗？我的网站是：[http ://daniel-mongo.cloudfoundry.com/](http://daniel-mongo.cloudfoundry.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:18:41.850

您是否查看了应用程序的日志以了解可能出现的问题？您可以使用 VMC 中的 logs 命令查看它们。

# r - 安装 SPSS R-plugin 后 Rstudio 停止工作

> ID：13293552
> 
> 赞同：0
> 
> 时间：2012-11-08T16:42:24.433
> 
> 标签：r, spss, rstudio

我正在尝试通过 SPSS 语法使用 R（我在 Windows 7 上使用 SPSS 18），这需要安装一个特殊的插件：PASWStatistics_RPlugIn_1802_win32.exe。我还必须安装旧版本的 R（2.8.1 - 我的旧版本 SPSS 需要 - 我比新版本更喜欢它）。该插件现在可以工作，R（两个版本）都可以工作，但是 Rstudio 停止工作并且即使在卸载并重新安装后也不会启动。有没有人有类似的经验并可以提出解决方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-09T14:30:38.993

以下链接指定如何配置 Rstudio 以使用已安装的特定 R 版本：

[http://www.rstudio.com/ide/docs/advanced/versions_of_r](http://www.rstudio.com/ide/docs/advanced/versions_of_r)

只需安装 R 2.8 和 2.14 并让 spss 使用一个，而 Rstudio 使用另一个。

使用旧版本的 spss 和 R 是有风险的（新版本中已修复的错误、性能下降、可能与其他软件不兼容，例如 R 软件包、缺少功能）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-09T13:36:20.220

您可以同时安装多个版本的 R - 我有五个。当前版本的 Statistics 21 与 R2.14 一起使用。我不知道 Rstudio 如何确定使用哪个版本。您可能需要重置 R 环境变量或路径设置。

# maven - 如何配置maven依赖收敛插件的输出级别？

> ID：13293556
> 
> 赞同：2
> 
> 时间：2012-11-08T16:42:49.660
> 
> 标签：maven, maven-3

我在多模块构建中使用具有依赖关系的 Maven 强制执行器插件，因此它为构建中的每个 pom 运行强制执行器插件。每次运行这个插件时，它都会产生大量的信息输出，这使得很难读取构建结果。例如，在我的例子中，每次调用插件都会产生大约 400 行输出。下面的代码显示了一个输出示例。

如何将强制执行依赖收敛插件配置为仅输出违规，否则除了依赖收敛检查成功之外不打印任何内容？

```
[INFO] --- maven-enforcer-plugin:1.1.1:enforce (enforce-dependencies-convergence) @ bar ---
[INFO] com.example:bar 0.0.1-SNAPSHOT 0.0.1-SNAPSHOT
[INFO] postgresql:postgresql 9.1-901-1.jdbc4 9.1-901-1.jdbc4
[INFO] com.fasterxml.jackson.core:jackson-databind 2.1.0 2.1.0
[INFO] com.fasterxml.jackson.core:jackson-annotations 2.1.0 2.1.0
[INFO] com.fasterxml.jackson.core:jackson-core 2.1.0 2.1.0
[INFO] javax.inject:javax.inject 1 1
[INFO] cglib:cglib-nodep 2.2.2 2.2.2
[INFO] com.googlecode.flyway:flyway-core 1.7 1.7
[INFO] joda-time:joda-time 2.1 2.1
[INFO] com.google.guava:guava 13.0.1 13.0.1
[INFO] org.hibernate:hibernate-validator 4.3.0.Final 4.3.0.Final
[INFO] javax.validation:validation-api 1.0.0.GA 1.0.0.GA
[INFO] org.jsoup:jsoup 1.7.1 1.7.1
[INFO] org.apache.httpcomponents:httpclient 4.2.2 4.2.2
[INFO] org.apache.httpcomponents:httpcore 4.2.2 4.2.2
[INFO] commons-codec:commons-codec 1.6 1.6
[INFO] commons-io:commons-io 2.4 2.4
[INFO] commons-fileupload:commons-fileupload 1.2.2 1.2.2
[INFO] org.slf4j:slf4j-log4j12 1.7.2 1.7.2
[INFO] org.slf4j:slf4j-api 1.7.2 1.7.2
[INFO] log4j:log4j 1.2.17 1.2.17
[INFO] org.slf4j:jcl-over-slf4j 1.7.2 1.7.2
[INFO] org.slf4j:slf4j-api 1.7.2 1.7.2
[INFO] org.slf4j:slf4j-api 1.7.2 1.7.2
[INFO] org.apache.velocity:velocity 1.7 1.7
[INFO] commons-collections:commons-collections 3.2.1 3.2.1
[INFO] org.hibernate.common:hibernate-commons-annotations 4.0.1.Final 4.0.1.Final
[INFO] org.hibernate:hibernate-entitymanager 4.1.8.Final 4.1.8.Final
[INFO] org.jboss.logging:jboss-logging 3.1.0.GA 3.1.0.GA
[INFO] org.jboss.spec.javax.transaction:jboss-transaction-api_1.1_spec 1.0.0.Final 1.0.0.Final
[INFO] dom4j:dom4j 1.6.1 1.6.1
[INFO] org.hibernate:hibernate-core 4.1.8.Final 4.1.8.Final
[INFO] antlr:antlr 2.7.7 2.7.7
[INFO] org.jboss.logging:jboss-logging 3.1.0.GA 3.1.0.GA
[INFO] org.jboss.logging:jboss-logging 3.1.0.GA 3.1.0.GA
[INFO] org.jboss.spec.javax.transaction:jboss-transaction-api_1.1_spec 1.0.0.Final 1.0.0.Final
[INFO] org.jboss.spec.javax.transaction:jboss-transaction-api_1.1_spec 1.0.0.Final 1.0.0.Final
[INFO] dom4j:dom4j 1.6.1 1.6.1
[INFO] dom4j:dom4j 1.6.1 1.6.1
[INFO] org.hibernate.javax.persistence:hibernate-jpa-2.0-api 1.0.1.Final 1.0.1.Final
[INFO] org.javassist:javassist 3.15.0-GA 3.15.0-GA
[INFO] org.hibernate.common:hibernate-commons-annotations 4.0.1.Final 4.0.1.Final
[INFO] org.hibernate.common:hibernate-commons-annotations 4.0.1.Final 4.0.1.Final
[INFO] org.hibernate.javax.persistence:hibernate-jpa-2.0-api 1.0.1.Final 1.0.1.Final
[INFO] org.hibernate.javax.persistence:hibernate-jpa-2.0-api 1.0.1.Final 1.0.1.Final
[INFO] org.javassist:javassist 3.15.0-GA 3.15.0-GA
[INFO] org.javassist:javassist 3.15.0-GA 3.15.0-GA
[INFO] org.hibernate.common:hibernate-commons-annotations 4.0.1.Final 4.0.1.Final
[INFO] org.hibernate.common:hibernate-commons-annotations 4.0.1.Final 4.0.1.Final
[INFO] org.hibernate.common:hibernate-commons-annotations 4.0.1.Final 4.0.1.Final
[INFO] org.aspectj:aspectjweaver 1.7.1 1.7.1
[INFO] org.aspectj:aspectjrt 1.7.1 1.7.1
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-aop 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] aopalliance:aopalliance 1.0 1.0
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-expression 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-test 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-oxm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] commons-lang:commons-lang 2.5 2.5
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-webmvc 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-asm 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context-support 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-beans 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-context 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-core 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-expression 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-expression 3.1.3.RELEASE 3.1.3.RELEASE
[INFO] org.springframework:spring-web 3.1.3.RELEASE 3.1.3.RELEASE 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:13:21.327

这是一个已知的错误：http: [//jira.codehaus.org/browse/MENFORCER-135](http://jira.codehaus.org/browse/MENFORCER-135)

将在版本 1.2 中修复，当前版本是您正在使用的 1.1.1。

你只需要等待那个版本:-(

# sql - SQL - 提取多个值

> ID：13293558
> 
> 赞同：1
> 
> 时间：2012-11-08T16:42:58.603
> 
> 标签：sql, delphi-xe2

我有一个带有成员 ID 的 SQL 表。

每个成员都有关于表中列出的保险索赔的信息。

一栏列出了与 相关的保险 ID `Member-ID`。

例如：-

```
|Member ID    | Insurance Code   |
----------------------------------
|C#$#@@!1231  | 67               | 
```

现在的问题是同一个成员可能有不同的保险代码#'s 作为以前索赔的一部分。

例如，在 2010 年 -2011 年期间，会员的索赔代码 = 67 但对于 2011 - 2012 年，会员的索赔代码 = 3

现在，当我创建一个 SQL 查询时，我只得到一个声明代码的值......我怎样才能得到所有的值，比如 67、3 和 110？这样我就可以回应该会员参与的所有索赔。

```
// SQL QUERY to gather member information.
DMS.ADOQuery1.SQL.Clear;
DMS.ADOQuery1.SQL.Add('select HPFROMDT, HPthruDt, MEMBERKEY, MEMBHPKEY, OPFROMDT, OPTHRUDT, HPCODEKEY' +
                      ' from MEMBHP' +
                      ' where MEMBERKEY = ''' + MembKey + '''  and OPTHRUDT >= ''' + init_date + ''' and OPFROMDT <= ''' + final_date +''' and OPFROMDT < OPTHRUDT'
                     );

//  Showmessage(DMS.ADOQuery1.SQL[0]);

DMS.ADOQuery1.Open;

// Adding the query values to the appropriate variables.
HPCodeKey := (DMS.ADOQuery1.FieldByNAme('HPCODEKEY').AsString);

DMS.ADOQuery1.Close; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:50:37.163

检查查询返回的所有记录，而不仅仅是第一个。还要检查 SQL 语句中的过滤日期（where 条件）。

```
// SQL QUERY to gather member information.
DMS.ADOQuery1.SQL.Clear;
DMS.ADOQuery1.SQL.Add('select HPFROMDT, HPthruDt, MEMBERKEY, MEMBHPKEY, OPFROMDT,      OPTHRUDT, HPCODEKEY' +
                  ' from MEMBHP' +
                  ' where MEMBERKEY = ''' + MembKey + '''  and OPTHRUDT >= ''' +   init_date + ''' and OPFROMDT <= ''' + final_date +''' and OPFROMDT < OPTHRUDT'
                 );

//  Showmessage(DMS.ADOQuery1.SQL[0]);

DMS.ADOQuery1.Open;

while not DMS.ADOQuery1.Eof do
begin
  // Adding the query values to the appropriate variables.
  Showmessage(DMS.ADOQuery1.FieldByNAme('HPCODEKEY').AsString);
  DMS.ADOQuery1.Next;
end;
DMS.ADOQuery1.Close; 
```

# asp.net-mvc - 使用不同存储库填充 ViewModel 的最佳实践

> ID：13293563
> 
> 赞同：0
> 
> 时间：2012-11-08T16:43:10.957
> 
> 标签：asp.net-mvc, viewmodel

我正在尝试找出执行此代码的最佳方法（因为我认为，我的方式锁定不好）：我试图使其易于理解问题。

```
public ActionResult Index()
{
var user=new User();
user.load(1);
return View(user);
}

load(int id )
{
//pseudocode:
//1\. load user from repository1     
//2\. load address from repository2
//3.load payments from repository3
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T17:50:42.517

干得好

我们将首先创建一个`UserModelService`如下

```
public class UserModelService
{
    public User Load(int id)
    {
        var userRepository = new UserRepository();
        var user = userRepository.Load(id);

        var addressRepository = new AddressRepository();
        user.Address = addressRepository.LoadForUserId(id);
        return user;
    }
} 
```

然后我们将修改控制器中的原始代码，如下所示

```
public ActionResult Index()
{
    var userModelSerice =new UserModelService();
    var user = userModelService.load(1);
    return View(user);
} 
```

上面所有剩余的代码参考如下

```
public class AddressRepository
{
    public Address LoadForUserId(int id)
    {
        // Load the address for given user id
    }
}

public class UserRepository
{
    public User Load(int id)
    {
        // Load and return user
    }
}

public class User
{
    public Address Address { get; set; }
}

public class Address
{
} 
```

`UserModelService`现在在您的控制器操作中，您可以通过构造函数将其注入，而不是创建 的新实例。可以应用类似的原则将存储库注入其中，`UserModelService`但这将是另一个大讨论，所以我会在这里打断自己。

# ruby-on-rails - Rails应用程序外的数据库负载平衡？

> ID：13293567
> 
> 赞同：1
> 
> 时间：2012-11-08T16:43:15.430
> 
> 标签：ruby-on-rails, postgresql, replication, load-balancing

我想在我的 postgresql 服务器上进行主/从设置。我的问题是如何从我的 Rails 应用程序中获取与数据库平衡的查询？我不能使用像[Octopus](https://github.com/tchandy/octopus)这样的 gem ，因为它与我对受此[rails cast](http://railscasts.com/episodes/389-multitenancy-with-postgresql)启发的[Apartment](https://github.com/influitive/apartment) gem（两者都修改 ActiveRecord）的使用相冲突。有谁知道在rails应用程序之外进行负载平衡的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:59:16.277

您可以考虑使用允许跨服务器池分发 SELECT 请求的[pgPool](http://www.pgpool.net/mediawiki/index.php/Main_Page)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T19:21:39.970

[PgBouncer](http://pgbouncer.projects.pgfoundry.org/doc/faq.html#_how_to_load_balance_queries_between_several_servers)有效地支持连接池和简单的负载平衡。

# r - 使用拆分，剪切和复制功能过滤R中的数据

> ID：13293569
> 
> 赞同：2
> 
> 时间：2012-11-08T16:43:19.193
> 
> 标签：r

我有一个如下所示的数据集。

```
date <- strptime(c("2011-09-01 00:00:00","2011-09-01 06:00:00","2011-09-01 12:00:00","2011-09-01 18:00:00","2011-09-02 00:00:00",
"2011-09-02 06:00:00","2011-09-02 12:00:00","2011-09-02 18:00:00","2011-09-03 00:00:00","2011-09-03 06:00:00","2011-09-03 12:00:00",
"2011-09-03 18:00:00","2011-09-04 00:00:00","2011-09-04 06:00:00","2011-09-04 12:00:00","2011-09-04 18:00:00","2011-09-05 00:00:00",
"2011-09-05 06:00:00","2011-09-05 12:00:00","2011-09-05 18:00:00","2011-09-06 00:00:00"), format ="%Y-%m-%d %H:%M:%S")

volt <- c(7,8,9,10, 7, 8, 9, 10,  6.1, 11.1,  9.1,  10.1, 7, 8,  9, 10, 6.3, 9.4, 1.3, 19.1, 5.6)

sampV <- data.frame(date,volt)
sampV

               date volt
2011-09-01 00:00:00 7
2011-09-01 06:00:00 8
2011-09-01 12:00:00 9
2011-09-01 18:00:00 10
2011-09-02 00:00:00 7
2011-09-02 06:00:00 8
2011-09-02 12:00:00 9
2011-09-02 18:00:00 10
2011-09-03 00:00:00 6.1
2011-09-03 06:00:00 11.1
2011-09-03 12:00:00 9.1
2011-09-03 18:00:00 10.1
2011-09-04 00:00:00 7
2011-09-04 06:00:00 8
2011-09-04 12:00:00 9
2011-09-04 18:00:00 10
2011-09-05 00:00:00 6.3
2011-09-05 06:00:00 9.4
2011-09-05 12:00:00 1.3
2011-09-05 18:00:00 19.1
2011-09-06 00:00:00 5.6 
```

现在我想**每天**使用日期列对数据进行分组，然后检查 v 中的结果分组是否重复。例如，重复 9 月 1 日和 2 日的“伏特”数据 (7,8,9,10)。

我一直在尝试使用此代码将其拆分为不同的日子，但这是我所能做到的。

```
t1 <- strptime("2011-09-01 00:00:00",format="%Y-%m-%d %H:%M:%S")
t2 <- strptime("2011-09-06 00:00:00",format="%Y-%m-%d %H:%M:%S")

seqD <- seq(t1,t2, by="day")
ctD <- cut(sampV$date, seqD, labels=F )
spD <- split(sampV$date,ctD) 
```

所以我的问题是，你如何提取那些使用重复函数或任何函数从一天到下一天复制的数据？我只是 R 的初学者，我仍在学习绳索，所以您的帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:13:10.547

假设我已经正确理解了您的问题，这是使用`split`和的一种方法`duplicated`：

```
days <- format(sampV$date, '%Y%m%d')
filtered <- split(sampV, days)[! duplicated(split(sampV$volt, days))]
do.call(rbind, filtered)

#                            date volt
# 20110901.1  2011-09-01 00:00:00  7.0
# 20110901.2  2011-09-01 06:00:00  8.0
# 20110901.3  2011-09-01 12:00:00  9.0
# 20110901.4  2011-09-01 18:00:00 10.0
# 20110903.9  2011-09-03 00:00:00  6.1
# 20110903.10 2011-09-03 06:00:00 11.1
# 20110903.11 2011-09-03 12:00:00  9.1
# 20110903.12 2011-09-03 18:00:00 10.1
# 20110905.17 2011-09-05 00:00:00  6.3
# 20110905.18 2011-09-05 06:00:00  9.4
# 20110905.19 2011-09-05 12:00:00  1.3
# 20110905.20 2011-09-05 18:00:00 19.1
# 20110906    2011-09-06 00:00:00  5.6 
```

# mysql - 如何在针对 unixtimestamp (bigint) 列的 where 子句中使用 curdate()

> ID：13293570
> 
> 赞同：1
> 
> 时间：2012-11-08T16:43:18.623
> 
> 标签：mysql, unix-timestamp

我正在尝试提取过去 7 天的记录。这是我一直试图开始工作的选择声明：

```
select from_unixtime(time,'%m/%d/%y') as fdate, from_unixtime(time,'%h:%m:%s') as ftime
from mdl_log
where from_unixtime(time,'%y-%m-%d')  between curdate() and curdate() - INTERVAL 7 DAY 
```

我尝试了 where 子句的各种化身，例如

```
where time between curdate() and curdate() - INTERVAL 7 DAY 
```

和

```
where from_unixtime(time,'%yyyy-%mm-%dd')  between curdate() and curdate() - INTERVAL 7 DAY 
```

和

```
where date(time) between curdate() and curdate() - INTERVAL 7 DAY 
```

选择 curdate() - 以这种格式显示日期 2012-11-08

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:46:12.697

你的最后一个化身几乎在那里。但是，您需要将苹果与苹果进行比较。由于`time`是一个*整数*，您需要将其转换为[MySQL 日期/时间函数](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions)才能使用。

```
WHERE DATE(FROM_UNIXTIME(time)) between CURDATE() and CURDATE() - INTERVAL 7 DAY 
```

鉴于您的用例，您实际上只需要[FROM_UNIXTIME()](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_from-unixtime)：

```
WHERE FROM_UNIXTIME(time) between CURDATE() and CURDATE() - INTERVAL 7 DAY 
```

# css - 悬停/缩放变换背景图像

> ID：13293574
> 
> 赞同：1
> 
> 时间：2012-11-08T16:43:43.510
> 
> 标签：css, hover, scale

我使用下面的代码创建了一排可以是纵向或横向的图像支架。我不知道现在如何将悬停比例变换应用于每个图像（更大）。这是代码：

```
 <ul>
    <li>
        <div style="width:150px; height:150px;
           background: url('img/2.png') no-repeat center;
           border:1px solid red;">
        </div>
    </li>

    <li>
        <div style="width:150px; height:150px;
           background: url('img/1.png') no-repeat center;
           border:1px solid red;">
        </div>
    </li>

    <li>
        <div style="width:150px; height:150px;
           background: url('img/3.png') no-repeat center;
           border:1px solid red;">
        </div>
    </li>
</ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:52:26.283

```
li div:hover{
    transform:scale(1.1,1.1);
} 
```

# php - 在 php 中阅读更多内容

> ID：13293579
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:44:04.120
> 
> 标签：php, mysql

我尝试为我的工作提供更多选项，并创建此代码：

```
<?php
      $string=$polnews['articale']; 
    if (strlen($string) > 500) {

        // truncate string
        $stringCut = substr($string, 0, 500);

        // make sure it ends in a word so assassinate doesn't become ass...
        $string = substr($stringCut, 0, strrpos($stringCut, ' ')).'... <a href="view_articles.php?aid=$polnews[aid]">Read More</a>'; 
    }
    echo $string;?> 
```

但链接不起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:45:16.537

```
'<a href="view_articles.php?aid=$polnews[aid]">Read More</a>'
^                                                           ^ 
```

它在单引号内，因此您`$polnews[aid]`不会被插值，而是按字面意思阅读。变量名将在**[双引号字符串](http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.double)**中展开。

你**可以**把它放在一个双引号字符串中，**或**​​者做

```
.'<a href="view_articles.php?aid=' . $polnews[aid] . '>Read More</a>' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:45:50.840

问题是您不能在单引号字符串中插入变量。

```
$string = substr($stringCut, 0, strrpos($stringCut, ' '))."... <a href=\"view_articles.php?aid=$polnews['aid']\">Read More</a>"; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:47:17.420

```
$string = substr($stringCut, 0, strrpos($stringCut, ' ')).'... <a href="view_articles.php?aid='.$polnews[aid].'">Read More</a>'; 
```

其他答案都很好，这也有效。

# android - 从 sqlite 到 sql android

> ID：13293582
> 
> 赞同：0
> 
> 时间：2012-11-08T16:44:18.450
> 
> 标签：android, sql, sqlite, distance

我有这个查询

```
SELECT
   id,
   ssid,
   bssid,
   capabilities,
   level,
   frequency,
   geolat,
   geolong,
   nickname,
   (
      " + rangeDouble + " * ACOS( (SIN( " + pi + " * " + geoLat + " / 180 ) * SIN( " + pi + " * lat / 180 ) ) + ( COS( " + pi + " * " + geoLat + " / 180 ) * COS( " + pi + " * lat / 180 ) * COS( ABS( ( " + pi + " * " + geoLng + " / 180 ) - ( " + pi + " * longg / 180 ) ) ) ) )
   )
   AS distanza 
FROM
   wifiTable 
HAVING
   distanza < " + rangeDouble + " 
ORDER BY
   distanza LIMIT 0,
   20",
   null
) 
```

*distanza*就像英语中的*距离*。

如何将此查询从 SQL 转换为 SQLite？因为我不知道如何在java代码中使用SELECT得到的“lat”！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:55:08.083

光标 cursor = getReadableDatabase()。rawQuery("你的查询在这里"); 请参阅[此处](http://www.vogella.com/articles/AndroidSQLite/article.html)以了解有关使用 sqlite 的更多信息

**编辑** 你需要有不同的列来存储你必须计算并保存在程序中的 sin 和 COS 值，当你需要显示它时只需调用一个函数计算它并显示[这里](https://stackoverflow.com/questions/3126830/query-to-get-records-based-on-radius-in-sqlite)提到了类似的问题希望这会有所帮助

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:50:25.923

首先了解查询如何在 Android 下使用 Sqlite。正如 Deepak Samuel Rajan 已经提到的那样，您至少可以使用原始查询：

光标 cursor = getReadableDatabase()。rawQuery("你的查询在这里");

然后，关于您的具体问题，它实际上由两部分组成：1）与数据库通信以提取您需要的信息。2）对数据进行某种数学计算。

最好将这两个问题分开，然后解决问题会变得容易得多。

例如，假设 x 和 y 坐标存储在数据库中，并且您想根据它们计算距离：

```
 // get x and y coordinates from databas
 cursor = from query
 x = retrieve from cursor
 y = retrieve from cursor

 // calculate distance: part of your code
  distance = sqrt(x^2 + y^2) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:53:24.077

SQLite 支持 SQL 的大多数功能，因此如果您的语法正确，您不需要更改任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T17:55:08.717

理论上，SQLite 支持用户定义的函数，但实际上，Android 的内置 SQL 接口并不能让您访问它。

如果您不想在自己的程序中进行计算，则必须使用 NDK 编译您自己的 SQLite 副本。

# c++ - QGraphicsItem::SetCursor 不会取消选择

> ID：13293584
> 
> 赞同：0
> 
> 时间：2012-11-08T16:44:26.600
> 
> 标签：c++, qt

全部，

我有一个`QGraphicsEllipseItem`. `setFlags(Qt::ItemIsSelectable | Qt::ItemIsMovable)`这允许我在 QGraphicsView 中快速拖动和移动椭圆。

我决定变得花哨，`setCursor(Qt::OpenHandCursor)`让用户知道他们可以通过点击来移动它。但是，现在松开鼠标左键就不会松开了？我究竟做错了什么？

* * *

示例代码：[自定义 QGraphicItem 和重绘问题](https://stackoverflow.com/questions/13278281/custom-qgraphicitem-and-repaint-issues)

**注意：**我删除了`update()`呼叫，并添加了`prepareGeometryChange()`呼叫。现在修改`MakeNewPoint`函数：

```
QGraphicsEllipseItem * InteractivePolygon::MakeNewPoint(QPointF & new_point)
{
   QGraphicsEllipseItem * result = 0;
   result = new QGraphicsEllipseItem();
   result->setPos(new_point);
   result->setRect(-4, -4, 8, 8);
   result->setFlags(QGraphicsItem::ItemIsMovable | QGraphicsItem::ItemIsSelectable)
   result->setCursor(Qt::OpenHandCursor); //Setting this removes my ability to let go of an item. NOTE: result is parented by this.

   return result;
} 
```

之后：

```
 QGraphicsEllipseItem * new_item = MakeNewPoint(bla);
 new_item->setParent(this);
 //add it to my QList<QGraphicsEllipseItem *> m_points; 
```

* * *

我想指出， my`QGraphicsEllipseItem`是由一个 custom 为父的`QGraphicsItem`。我不改变父母/自定义项目光标，只有椭圆的。我没有遇到非父省略号的这个问题......

* * *

**有趣的结果：**所以我的类自定义`QGraphicsItem`类（椭圆的父类）是一个 QObject，所以我可以从场景中过滤传入的鼠标事件。我`setCursor(Qt::ArrowCursor)`在我的自定义类的构造函数中做了一个......这就是它变得有趣的地方：

`(event->type() == QEvent::GraphicsSceneMouseMove)`即使没有按下鼠标按钮，eventFilter 现在也会捕获。如果我没有`setCursor`接听电话，该事件只会在按下鼠标按钮时触发......想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T19:10:18.553

好的，这就是正在发生的事情，一旦你意识到它就很直观：

当您将 a 设置`QGraphicsItem`为唯一光标时，`QGraphicsView`必须`setMouseTracking(true)`否则`QGraphicsScene`将永远不知道何时更改光标（即，当它在具有唯一光标的图形项上方时）。鼠标移动事件影响了我的椭圆。

通常，`QGraphicsScene`只有在按住按钮时才会获得鼠标移动事件。

# performance - Haskell：涉及大型列表的计算中的意外时间复杂度

> ID：13293587
> 
> 赞同：4
> 
> 时间：2012-11-08T16:44:36.163
> 
> 标签：performance, list, haskell, ghc, time-complexity

我正在处理具有作为中间结果的列表 A=[B] 的计算，它是长度为 L 的 K 个列表的列表。计算 B 的元素的时间复杂度由参数 M 控制，并且是理论上在 M 中是线性的。理论上我希望计算 A 的时间复杂度为 O(K*L*M)。但是，事实并非如此，我不明白为什么？

这是一个简单的完整草图程序，它展示了我解释过的问题

```
import System.Random (randoms, mkStdGen)
import Control.Parallel.Strategies (parMap, rdeepseq)
import Control.DeepSeq (NFData)
import Data.List (transpose)

type Point = (Double, Double)

fmod :: Double -> Double -> Double
fmod a b | a < 0     = b - fmod (abs a) b 
         | otherwise = if a < b then a 
                       else let q = a / b in b * (q - fromIntegral (floor q))

standardMap :: Double -> Point -> Point
standardMap k (q, p) = (fmod (q + p) (2 * pi), fmod (p + k * sin(q)) (2 * pi))

trajectory :: (Point -> Point) -> Point -> [Point] 
trajectory map initial = initial : (trajectory map $ map initial)

justEvery :: Int -> [a] -> [a]
justEvery n (x:xs) = x : (justEvery n $ drop (n-1) xs)
justEvery _ []     = []

subTrace :: Int -> Int -> [a] -> [a]
subTrace n m = take (n + 1) . justEvery m

ensemble :: Int -> [Point]
ensemble n = let qs = randoms (mkStdGen 42)
                 ps = randoms (mkStdGen 21)
             in take n $ zip qs ps 

ensembleTrace :: NFData a => (Point -> [Point]) -> (Point -> a) -> 
                              Int -> Int -> [Point] -> [[a]]
ensembleTrace orbitGen observable n m = 
    parMap rdeepseq ((map observable . subTrace n m) . orbitGen)

main = let k = 100
           l = 100
           m = 100
           orbitGen = trajectory (standardMap 7)
           observable (p, q) = p^2 - q^2
           initials = ensemble k
           mean xs = (sum xs) / (fromIntegral $ length xs)
           result =   (map mean) 
                    $ transpose 
                    $ ensembleTrace orbitGen observable l m 
                    $ initials
       in mapM_ print result 
```

我正在编译

```
$ ghc -O2 stdmap.hs -threaded 
```

并与

```
$ ./stdmap +RTS -N4 > /dev/null 
```

在 intel Q6600, Linux 3.6.3-1-ARCH, GHC 7.6.1 上，对于不同的参数集 K、L、M（程序代码中的 k、l、m）得到以下结果

```
(K=200,L=200,N=200)   -> real    0m0.774s
                         user    0m2.856s
                         sys     0m0.147s

(K=2000,L=200,M=200)  -> real    0m7.409s
                         user    0m28.102s
                         sys     0m1.080s

(K=200,L=2000,M=200)  -> real    0m7.326s
                         user    0m27.932s
                         sys     0m1.020s

(K=200,L=200,M=2000)  -> real    0m10.581s
                         user    0m38.564s
                         sys     0m3.376s

(K=20000,L=200,M=200) -> real    4m22.156s
                         user    7m30.007s
                         sys     0m40.321s

(K=200,L=20000,M=200) -> real    1m16.222s
                         user    4m45.891s
                         sys     0m15.812s

(K=200,L=200,M=20000) -> real    8m15.060s
                         user    23m10.909s
                         sys     9m24.450s 
```

我不太明白这种纯粹的缩放问题可能出在哪里。如果我理解正确，列表是惰性的，不应该构造，因为它们是在头尾方向上消耗的？从测量中可以看出，过多的实时消耗和过多的系统时间消耗之间存在相关性，因为多余的将在系统帐户上。但是如果有一些内存管理浪费时间，这仍然应该在 K、L、M 中线性缩放。

帮助！

**编辑**

我根据 Daniel Fisher 给出的建议对代码进行了更改，确实解决了 M 的不良缩放问题。正如所指出的，通过在轨迹中强制进行严格的评估，我们避免了大型 thunk 的构建。我理解这背后的性能改进，但我仍然不理解原始代码的不良缩放，因为（如果我理解正确的话）thunk 构造的时空复杂度应该在 M 中是线性的？

此外，我仍然无法理解关于 K（集合的大小）的不良缩放。我使用改进的代码对 K=8000 和 K=16000 进行了两次额外的测量，保持 L=200，M=200。放大到 K=8000 符合预期，但对于 K=16000，它已经不正常了。问题似乎在于 的数量`overflowed` `SPARKS`，对于 K=8000 为 0，对于 K=16000 为 7802。这可能反映在糟糕的并发性上，我`Q = (MUT cpu time) / (MUT real time)`将其量化为理想情况下等于 CPU 数量的商。但是，K = 8000 的 Q ~ 4 和 K = 16000 的 Q ~ 2。请帮助我了解这个问题的起源和可能的解决方案。

```
K = 8000:

$ ghc -O2 stmap.hs -threaded -XBangPatterns
$ ./stmap +RTS -s -N4 > /dev/null

56,905,405,184 bytes allocated in the heap
 503,501,680 bytes copied during GC
  53,781,168 bytes maximum residency (15 sample(s))
   6,289,112 bytes maximum slop
         151 MB total memory in use (0 MB lost due to fragmentation)

                                Tot time (elapsed)  Avg pause  Max pause
Gen  0     27893 colls, 27893 par    7.85s    1.99s     0.0001s    0.0089s
Gen  1        15 colls,    14 par    1.20s    0.30s     0.0202s    0.0558s

Parallel GC work balance: 23.49% (serial 0%, perfect 100%)

TASKS: 6 (1 bound, 5 peak workers (5 total), using -N4)

SPARKS: 8000 (8000 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

INIT    time    0.00s  (  0.00s elapsed)
MUT     time   95.90s  ( 24.28s elapsed)
GC      time    9.04s  (  2.29s elapsed)
EXIT    time    0.00s  (  0.00s elapsed)
Total   time  104.95s  ( 26.58s elapsed)

Alloc rate    593,366,811 bytes per MUT second

Productivity  91.4% of total user, 360.9% of total elapsed

gc_alloc_block_sync: 315819 
```

和

```
K = 16000:

$ ghc -O2 stmap.hs -threaded -XBangPatterns
$ ./stmap +RTS -s -N4 > /dev/null

113,809,786,848 bytes allocated in the heap
 1,156,991,152 bytes copied during GC
  114,778,896 bytes maximum residency (18 sample(s))
    11,124,592 bytes maximum slop
      300 MB total memory in use (0 MB lost due to fragmentation)

                                Tot time (elapsed)  Avg pause  Max pause
Gen  0     135521 colls, 135521 par   22.83s    6.59s     0.0000s    0.0190s
Gen  1        18 colls,    17 par    2.72s    0.73s     0.0405s    0.1692s

Parallel GC work balance: 18.05% (serial 0%, perfect 100%)

TASKS: 6 (1 bound, 5 peak workers (5 total), using -N4)

SPARKS: 16000 (8198 converted, 7802 overflowed, 0 dud, 0 GC'd, 0 fizzled)

INIT    time    0.00s  (  0.00s elapsed)
MUT     time  221.77s  (139.78s elapsed)
GC      time   25.56s  (  7.32s elapsed)
EXIT    time    0.00s  (  0.00s elapsed)
Total   time  247.34s  (147.10s elapsed)

Alloc rate    513,176,874 bytes per MUT second

Productivity  89.7% of total user, 150.8% of total elapsed

gc_alloc_block_sync: 814824 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-09T01:37:15.530

[MAD](https://stackoverflow.com/users/442362/m-a-d)的观点`fmod`是好的，但没有必要调用 C，我们可以更好地留在 Haskell 领域（链接线程的[票证](http://hackage.haskell.org/trac/ghc/ticket/2271)同时固定）。麻烦在

```
fmod :: Double -> Double -> Double
fmod a b | a < 0     = b - fmod (abs a) b 
         | otherwise = if a < b then a 
                       else let q = a / b in b * (q - fromIntegral (floor q)) 
```

是类型默认导致`floor :: Double -> Integer`（并因此`fromIntegral :: Integer -> Double`）被调用。现在，`Integer`是一个比较复杂的类型，运算比较慢，从`Integer`to的转换`Double`也比较复杂。原始代码（带有参数`k = l = 200`和`m = 5000`）产生了统计数据

```
./nstdmap +RTS -s -N2 > /dev/null
  60,601,075,392 bytes allocated in the heap
  36,832,004,184 bytes copied during GC
       2,435,272 bytes maximum residency (13741 sample(s))
         887,768 bytes maximum slop
               9 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0     46734 colls, 46734 par   41.66s   20.87s     0.0004s    0.0058s
  Gen  1     13741 colls, 13740 par   23.18s   11.62s     0.0008s    0.0041s

  Parallel GC work balance: 60.58% (serial 0%, perfect 100%)

  TASKS: 4 (1 bound, 3 peak workers (3 total), using -N2)

  SPARKS: 200 (200 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.00s  (  0.00s elapsed)
  MUT     time   34.99s  ( 17.60s elapsed)
  GC      time   64.85s  ( 32.49s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time   99.84s  ( 50.08s elapsed)

  Alloc rate    1,732,048,869 bytes per MUT second

  Productivity  35.0% of total user, 69.9% of total elapsed 
```

在我的机器上（`-N2`因为我只有两个物理内核）。只需更改代码以使用类型签名`floor q :: Int`即可将其降低到

```
./nstdmap +RTS -s -N2 > /dev/null
  52,105,495,488 bytes allocated in the heap
  29,957,007,208 bytes copied during GC
       2,440,568 bytes maximum residency (10481 sample(s))
         893,224 bytes maximum slop
               8 MB total memory in use (0 MB lost due to fragmentation)

                                    Tot time (elapsed)  Avg pause  Max pause
  Gen  0     36979 colls, 36979 par   32.96s   16.51s     0.0004s    0.0066s
  Gen  1     10481 colls, 10480 par   16.65s    8.34s     0.0008s    0.0018s

  Parallel GC work balance: 68.64% (serial 0%, perfect 100%)

  TASKS: 4 (1 bound, 3 peak workers (3 total), using -N2)

  SPARKS: 200 (200 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)

  INIT    time    0.01s  (  0.01s elapsed)
  MUT     time   29.78s  ( 14.94s elapsed)
  GC      time   49.61s  ( 24.85s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time   79.40s  ( 39.80s elapsed)

  Alloc rate    1,749,864,775 bytes per MUT second

  Productivity  37.5% of total user, 74.8% of total elapsed 
```

经过时间减少约 20%，MUT 时间减少 13%。不错。如果我们查看`floor`通过优化获得的代码，我们可以看到原因：

```
floorDoubleInt :: Double -> Int
floorDoubleInt (D# x) =
    case double2Int# x of
      n | x <## int2Double# n   -> I# (n -# 1#)
        | otherwise             -> I# n

floorDoubleInteger :: Double -> Integer
floorDoubleInteger (D# x) =
    case decodeDoubleInteger x of
      (# m, e #)
        | e <# 0#   ->
          case negateInt# e of
            s | s ># 52#    -> if m < 0 then (-1) else 0
              | otherwise   ->
                case TO64 m of
                  n -> FROM64 (n `uncheckedIShiftRA64#` s)
        | otherwise -> shiftLInteger m e 
```

`floor :: Double -> Int`只是使用机器转换，而`floor :: Double -> Integer`需要昂贵`decodeDoubleInteger`且更多的分支。但是这里`floor`调用 where ，我们知道所有涉及`Double`的 s 都是非负的，因此`floor`与 相同`truncate`，它直接映射到机器转换`double2Int#`，所以让我们尝试一下，而不是`floor`：

```
 INIT    time    0.00s  (  0.00s elapsed)
  MUT     time   29.29s  ( 14.70s elapsed)
  GC      time   49.17s  ( 24.62s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time   78.45s  ( 39.32s elapsed) 
```

一个非常小的减少（可以预期，这`fmod`并不是真正的瓶颈）。为了比较，呼叫 C：

```
 INIT    time    0.01s  (  0.01s elapsed)
  MUT     time   31.46s  ( 15.78s elapsed)
  GC      time   54.05s  ( 27.06s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time   85.52s  ( 42.85s elapsed) 
```

有点慢（不出所料，您可以在调用 C 时执行许多 primops）。

但这不是大鱼游泳的地方。坏事是只选择`m`轨迹的每一个元素会导致大量的重击，从而导致大量的分配，并且在时机成熟时需要很长时间来评估。因此，让我们消除泄漏并使轨迹严格：

```
{-# LANGUAGE BangPatterns #-}

trajectory :: (Point -> Point) -> Point -> [Point] 
trajectory map !initial@(!a,!b) = initial : (trajectory map $ map initial) 
```

这大大减少了分配和 GC 时间，因此也减少了 MUT 时间：

```
 INIT    time    0.00s  (  0.00s elapsed)
  MUT     time   21.83s  ( 10.95s elapsed)
  GC      time    0.72s  (  0.36s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time   22.55s  ( 11.31s elapsed) 
```

与原版`fmod`，

```
 INIT    time    0.00s  (  0.00s elapsed)
  MUT     time   18.26s  (  9.18s elapsed)
  GC      time    0.58s  (  0.29s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time   18.84s  (  9.47s elapsed) 
```

和`floor q :: Int`，并且在相同时间内的测量精度内`truncate q :: Int`（分配数字略低`truncate`）。

* * *

> 问题似乎在于溢出的 SPARKS 的数量，对于 K=8000 为 0，对于 K=16000 为 7802。这可能反映在糟糕的并发性上

是的（尽管据我所知，这里更正确的术语是并行性而不是并发性），有一个火花池，当它已满时，不会安排任何进一步的火花在下一个有时间的线程中进行评估来了，计算然后在没有并行性的情况下从父线程完成。在这种情况下，这意味着在初始并行阶段之后，计算会退回到顺序。

火花池的大小显然约为 8K (2^13)。

如果你通过 top 观察 CPU 负载，你会看到它`(close to 100%)*(number of cores)`在一段时间后从一个低得多的值下降（对我来说，它是 ~100% with`-N2`和 ~130% with `-N4`）。

解决方法是避免火花过多，让每个火花做更多的工作。快速而肮脏的修改

```
ensembleTrace orbitGen observable n m =
    withStrategy (parListChunk 25 rdeepseq) . map ((map observable . subTrace n m) . orbitGen) 
```

我`-N2`几乎在整个跑步过程中都恢复了 200%，而且工作效率很高，

```
 INIT    time    0.00s  (  0.00s elapsed)
  MUT     time   57.42s  ( 29.02s elapsed)
  GC      time    5.34s  (  2.69s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time   62.76s  ( 31.71s elapsed)

  Alloc rate    1,982,155,167 bytes per MUT second

  Productivity  91.5% of total user, 181.1% of total elapsed 
```

并且`-N4`它也很好（在挂钟上甚至快一点 - 不多，因为所有线程都基本相同，而且我只有 2 个物理内核），

```
 INIT    time    0.00s  (  0.00s elapsed)
  MUT     time   99.17s  ( 26.31s elapsed)
  GC      time   16.18s  (  4.80s elapsed)
  EXIT    time    0.00s  (  0.00s elapsed)
  Total   time  115.36s  ( 31.12s elapsed)

  Alloc rate    1,147,619,609 bytes per MUT second

  Productivity  86.0% of total user, 318.7% of total elapsed 
```

因为现在火花池没有溢出。

正确的解决方法是使块的大小成为根据轨迹和可用核心数计算的参数，以便火花数不超过池大小。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T23:41:19.503

在做了一些快速分析后，我发现这些是连环犯罪者：

```
ghc --make -O2 MainNonOpt.hs -threaded -prof -auto-all -caf-all -fforce-recomp
./MainNonOpt +RTS -N4 -p > /dev/null

>>>
COST CENTRE MODULE  %time %alloc
fmod        Main     46.3   33.3
standardMap Main     28.5    0.0
trajectory  Main     23.8   66.6 
```

fmod 令人惊讶的是，考虑到它主要是一个数值函数，它所做的大量分配。所以下一步是注释 fmod 以查看问题出在哪里：

```
fmod :: Double -> Double -> Double
fmod a b | a < 0     = {-# SCC "negbranch" #-} b - fmod (abs a) b 
         | otherwise = {-# SCC "posbranch" #-} if a < b then a 
                       else let q = {-# SCC "division" #-} a / b in {-# SCC "expression" #-} b * (q - {-# SCC "floor" #-} fromIntegral (floor q)) 
```

这给了我们：

```
ghc --make -O2 MainNonOpt.hs -threaded -prof -caf-all -fforce-recomp
./MainNonOpt +RTS -N4 -p > /dev/null

COST CENTRE MODULE  %time %alloc

MAIN        MAIN     61.5   70.0
posbranch   Main     16.6    0.0
floor       Main     14.9   30.0
expression  Main      4.5    0.0
negbranch   Main      1.9    0.0 
```

所以这个位`floor`是导致问题的那个。环顾四周后发现，Prelude 没有尽其所能实现一些 Double RealFrac 功能（请参见[此处](http://haskell.1045720.n5.nabble.com/GHC-2271-floor-ceiling-round-Double-gt-Int-are-awesomely-slow-td3166930.html)），可能会导致一些装箱/拆箱。

因此，按照链接中的建议，我使用了 floor 的修改版本，这也使得对 fromIntegral 的调用变得不必要：

```
floor' :: Double -> Double
floor' x = c_floor x
{-# INLINE floor' #-} 

foreign import ccall unsafe "math.h floor" 
   c_floor :: Double -> Double 

fmod :: Double -> Double -> Double
fmod a b | a < 0     = {-# SCC "negbranch" #-} b - fmod (abs a) b
         | otherwise = {-# SCC "posbranch" #-} if a < b then a
                       else let q = {-# SCC "division" #-} a / b in {-# SCC "expression" #-} b * (q - ({-# SCC "floor" #-} floor' q)) 
```

**编辑**：正如 Daniel Fisher 指出的那样，无需内联 C 代码来提高性能。类似的 Haskell 函数已经存在。无论如何我都会留下答案，以供进一步参考。

这确实有所作为。在我的机器上，对于 k=l=200, M=5000，这里是未优化和优化版本的数字：

非优化：

```
real    0m20.635s
user    1m17.321s
sys     0m4.980s 
```

优化：

```
real    0m14.858s
user    0m55.271s
sys     0m3.815s 
```

该`trajectory`功能可能有类似的问题，您可以使用上面使用的分析来查明问题。

可以在Real World Haskell的[这一章](http://book.realworldhaskell.org/read/profiling-and-optimization.html)中找到在 Haskell 中进行分析的一个很好的起点。

# java - CheckBox 矩阵有问题，循环不起作用

> ID：13293590
> 
> 赞同：1
> 
> 时间：2012-11-08T16:44:42.980
> 
> 标签：java, loops, checkbox, nested

我正在编写一个程序，它将有多个窗口，它们将在它们之间传递一个值。目前我正在测试由 1-99 个复选框组成的程序的一部分。但是当我想通过单击一个按钮来检查它们的状态时，它就不起作用了。这就是问题所在：

```
public void actionPerformed(ActionEvent event) {

    if(event.getSource() == okay) {
        for(int i=0;i<box.length; i++){
            for(int j=0;j<box.length; j++){
                if((i==0)&&(j==0)) continue;                    
                if(box[i][j].getState())
                asdf.matra[i][j]=true;
                System.out.println(box[i][j].getLabel() + " is " + asdf.matra[i][j]);
                }       
        }

    }

} 
```

这是主要课程：

```
 public class asdf {
    public static boolean matra[][] = new boolean[10][10];

    public static void main(String arg[]) {

    for(int ii=0;ii<matra.length; ii++){
        for(int jj=0;jj<matra.length; jj++){
            matra[ii][jj]=false;
            }           
    }
    new JFrameDemo();
}
} 
```

和另一类：

```
import java.awt.*;

import java.awt.event.WindowEvent;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import java.awt.event.ItemListener;
import java.awt.event.ItemEvent;

public class JFrameDemo extends Frame implements ActionListener, ItemListener {
    Checkbox box[][] = new Checkbox[10][10];
    Button okay;

JFrameDemo() {
    enableEvents(AWTEvent.WINDOW_EVENT_MASK);
    add(makePanel());
    pack();
    show();

}
private Panel makePanel() {

    GridBagConstraints con = new GridBagConstraints();
    Panel panel = new Panel();
    GridBagLayout gridbag = new GridBagLayout();
    panel.setLayout(gridbag);

    for(int i=0;i<box.length; i++){
        for(int j=0;j<box.length; j++){
            if((i==0)&&(j==0)) continue;                    

            box[i][j] = new Checkbox(i+j*10+"");
            con.gridx = i;
            con.gridy = j;
            panel.add(box[i][j],con);
            }           
    }

    okay = new Button("Unesi");
    con.gridx = 10;
    con.gridy = 10;
    panel.add(okay,con);

    return(panel);
}
public void actionPerformed(ActionEvent event) {

    if(event.getSource() == okay) {
        for(int i=0;i<box.length; i++){
            for(int j=0;j<box.length; j++){
                if((i==0)&&(j==0)) continue;                    
                if(box[i][j].getState())
                asdf.matra[i][j]=true;
                System.out.println(box[i][j].getLabel() + " is " + asdf.matra[i][j]);
                }       
        }

    }

}
public void itemStateChanged(ItemEvent event) {

}
public void processWindowEvent(WindowEvent event) {
    if(event.getID() == WindowEvent.WINDOW_CLOSING)
        System.exit(0);
}
} 
```

程序运行没有任何错误，但控制台没有给出任何结果。它也应该将值传递给全局变量。我认为嵌套 fors 存在问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T20:38:24.900

您忘记将 ActionListener 添加到按钮。

```
okay = new Button("Unesi");
okay.addActionListener(this); 
```

# .htaccess - 重写规则错误

> ID：13293592
> 
> 赞同：0
> 
> 时间：2012-11-08T16:44:53.703
> 
> 标签：.htaccess, url-rewriting, rewrite

我想重写一个简单的 url，但不产生谷歌错误

此代码有效：

```
RewriteEngine on
RewriteRule  lieu/([0-9]+).* index.php?com=location&lID=$1 [L]
RewriteRule  evenement/([0-9]+).* index.php?eID=$1 [L] 
```

但我想为 SEO 添加 R=301 标志

当我添加 [R=301,L] 时：

```
The requested URL /var/www/mysite/index.php was not found on this server. 
```

我知道 R=301 标志必须与 http:// 一起使用

但是当我尝试时，网址没有重写

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T00:22:50.963

Apache 试图猜测一个路径是 URI 路径还是文件路径，但它猜错了。当您在内部重写时，文件路径非常好，因为它都是服务器内部的。但是当您进行重定向时，apache 错误地猜测您的目标 (the `index.php?eID=`) 是一个文件路径，并且它被标记为由 mod_alias 作为重定向处理。到重定向发生时，它的格式错误为文件路径而不是 URI 路径。这就是为什么您在`/var/www/mysite/`重定向时会有所收获。

添加 a`RewriteBase`以提供相对 URI 的 URI 基础，或使您的目标成为绝对 URI：

```
RewriteEngine On
RewriteBase /
RewriteRule  lieu/([0-9]+).* index.php?com=location&lID=$1 [R=301,L]
RewriteRule  evenement/([0-9]+).* index.php?eID=$1 [L,R=301] 
```

或者

```
RewriteEngine on
RewriteRule  lieu/([0-9]+).* /index.php?com=location&lID=$1 [L,R=301]
RewriteRule  evenement/([0-9]+).* /index.php?eID=$1 [L,R=301] 
```

# google-app-engine - GAE - 允许的最大管理员数

> ID：13293594
> 
> 赞同：0
> 
> 时间：2012-11-08T16:44:57.707
> 
> 标签：google-app-engine

我在我的 GAE 应用程序中添加了 15 个人，然后我收到了这个错误：“每个应用程序只允许最多 15 个管理员。”

我在文档中没有看到 GAE 有这种类型的限制，是可配置的设置吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T18:30:03.267

不，限制不可配置。

从还看到您在跟踪器中提交的[问题](http://code.google.com/p/googleappengine/issues/detail?id=8412)，我猜您正在使用`VIEWER`权限来允许访问仅限管理员的页面。要将其扩展到其他用户，您需要使用 Google 帐户身份验证和您自己创建的 ACL 系统。

# c# - 从字符串生成固定大小的字节序列

> ID：13293595
> 
> 赞同：1
> 
> 时间：2012-11-08T16:44:57.397
> 
> 标签：c#

我想从一个可变长度的字符串中创建一个长度固定的字节序列。存档此文件的最佳方法是什么。所有字节应尽可能不同。

### 该代码用于我自己的研究，没有任何成果。

这是我生成字节的第一种方法：

```
static byte[] GenerateBytes(string password, Int32 strength)
{
    Byte[] result = new byte[strength];
    Byte[] pwBytes = Encoding.ASCII.GetBytes(password);
    Int32 prime = GetLowerPrime(pwBytes.Length);

    // Offset count to avoid values
    Int32 count = prime;
    Int32 sum = 0;
    for (int i = 0; i < result.Length; i++) {
        sum += (result[i] = pwBytes[(count++ % pwBytes.Length)]);
    }

    count += prime;
    Int32 pcount = prime;
    for (int i = 0; i < result.Length * 7; i++) {
        result[(i % result.Length)] ^= (Byte)(pwBytes[(count++ % pwBytes.Length)] ^ ((pcount += pwBytes[(count % pwBytes.Length)]) % 255));
    }

    return result;
} 
```

并生成了一些具有 256 / 128 / 64 生成字节的样本并计算了唯一字节：

```
Password "Short":                170  103  60
Password "LongerX":              173  101  55
Password "Really Long":          169  100  57
Password "Unbelivable Safe!0§$": 162  101  56
Password "MCV":                  119  113  61
Password "AAA":                  50   51   50
Password "BBB":                  67   67   52
Password "AAAAAA":               48   48   48 
```

我尝试稍微更改主选择器，这改善了短键的生成，但对长键有部分影响。我还跟踪了一些字节的统计信息。生成，每个字节值使用 9 到 30 次。

### 您如何看待结果？如何改进字节的生成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:47:23.930

你似乎在重新发明轮子。如果您需要从密码中生成密钥，请使用散列函数，或者，最好的方法 - 标准的基于密码的密钥派生函数之一。搜索 PBKDF2。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:52:39.927

好吧，如果您真的想推出自己的解决方案，除了理论兴趣之外没有真正的实际用途，（因为这听起来像一个家庭作业问题）只需从一次性填充随机字节开始，然后将 pwd 与前几个 XOR字节，应该为短密码提供相当高的熵。

# php - 如果移动设备跨越不同的 WiFi AP，PHP 会话会丢失

> ID：13293597
> 
> 赞同：1
> 
> 时间：2012-11-08T16:45:03.573
> 
> 标签：php, session, cookies, submit, wifi

我有一个运行良好的 PHP 站点....只要没有网络中断。我遇到了用户问题，尤其是在 iPad 和笔记本电脑上，这些用户在长时间（可能一个小时左右）没有提交任何数据的情况下登录并在网站内工作。他们输入一堆笔记，当他们提交时，它们会被发送到登录屏幕，而他们在那一小时所做的工作就会丢失。我已经习惯了肮脏的外表......我的研究表明，也许使用 cookie 会帮助解决这个问题。安全性不是一个大问题，因此在 cookie 中存储用户名和散列密码并不是什么大威胁。但我从未使用过 cookie，也不知道从哪里真正开始。我的目标是让任何用户都能够登录，开始在文本区域中输入，在整个建筑物中移动，可能会断开他们的互联网连接并将其恢复，并且能够在没有错误的情况下提交表单。有任何想法吗？提前致谢...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:54:38.337

听起来您的会话即将到期，与更改互联网连接或 Wifi AP 无关。

使用 PHP 更改默认 PHP 会话到期，或更改 php.ini 设置：

```
ini_set("session.cookie_lifetime","3600"); //an hour 
```

默认会话处理程序通过在客户端上设置会话 ID cookie 来工作。对于每个页面请求，都会发送会话 ID。如果会话过期，cookie 将被删除，因此客户端将显示登录屏幕。

假设您使用的是默认的 PHP 会话处理程序（您没有说）。如果这不是问题，那么它会指向您的代码中的问题，例如，如果您试图通过比较 IP 地址来防止会话劫持（随着用户从 AP 移动到 AP，这将改变）。

# php - preg_match 永远不会通过

> ID：13293598
> 
> 赞同：1
> 
> 时间：2012-11-08T16:45:04.493
> 
> 标签：php, preg-match

我的帐户创建脚本的名称输入使用 a 进行验证，`preg_match`因为该字段只允许包含拉丁字符*或*西里尔字符（换句话说，它不能同时包含两者），但是，无论名称字段包含什么，`preg_match`条件都不会满足。到目前为止，我已经尝试了三种可能的代码变体：

```
if (!(preg_match('/^[a-z]$/i',$_POST['name']) || preg_match('/^[а-я]$/i',$_POST['name']))) back('The message');

if (!preg_match('/^[a-z]$/i',$_POST['name']) &&  !preg_match('/^[а-я]$/i',$_POST['name'])) back('The message'); 
```

还有一个试图将两个 preg 匹配项塞进一个。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T16:50:19.533

问题是您将名称限制为一个字符：

```
/^[a-z]$/i 
```

将其更改为：

```
/^[a-z]+$/i 
```

和

```
/^[а-я]+$/i 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:52:42.647

`preg_match`让我们将这些函数抽象为名称`is_latin`和`is_cyrillic`可读性。然后，您正在寻找逻辑：

```
if is_latin xor is_cyrillic     -> OK
else                            -> not OK 
```

或者，倒置：

```
if !(is_latin xor is_cyrillic)  -> not OK 
```

`xor`仅当一个是`true`而另一个时才为真`false`。

此外，您的正则表达式仅匹配一个字符。你会想要`/^[a-z]+$/i`匹配整个单词。此外，要匹配非拉丁词/正则表达式，您需要使用`u`修饰符 like`/^[а-я]+$/iu`并确保您的源代码和主题以 UTF-8 编码。所以：

```
if (!(preg_match('/^[a-z]+$/i', $_POST['name']) xor preg_match('/^[а-я]+$/iu', $_POST['name']))) {
    // error
} 
```

您甚至可以将其缩短为一个正则表达式：

```
if (!preg_match('/^([a-z]+|[а-я]+)$/iu', $_POST['name'])) {
    // error
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T16:52:57.760

您也可以在一个正则表达式中断言两者：

```
if (!preg_match('/ ^[a-z]+$ | ^[\p{Cyrillic}]+$ /ixu',$_POST['name'])) { 
```

请注意两个`|`替代方案，bot 受`^`和约束`$`。

还有`\p{Latin}`, 不仅`\p{Cyrillic}`用于匹配完整的字符范围。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T16:54:42.073

根据您的条件，如果第一个“如果”没有通过，第二个也不会通过，因为它们是等价`!(A or B) <=> !A && !B`的，您想要的是 xor

此外，您只需在此处使用“预匹配”测试一个角色。

你的情况应该是

```
if( preg_match('/^[a-z]+$/iu',$_POST['name']) xor preg_match('/^[а-я]+$/iu',$_POST['name']){

   // do what you want

  } 
```

# gallery - MODx Gallery 插件不显示完整图像

> ID：13293599
> 
> 赞同：0
> 
> 时间：2012-11-08T16:45:06.910
> 
> 标签：gallery, modx-revolution

我安装了图库插件。

我已经上传了我的图片并使用了这样的片段：`[[Gallery? &album=`1 `]]`。

现在我的缩略图显示得很好，但是在点击图片后我被发送到`/index.php?id=4&galItem=2&galAlbum=1&galTag=`地址并且没有任何反应——这个页面和上一个页面一样。

关于我做错了什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T07:14:52.727

您将获得 id=4 的页面链接。在此页面中，您必须获取 galItem、galAlbum 和 galTag 并显示相应的图像。我不确定您是否在模板中处理了这个问题。

试试这个：

```
[[Gallery? &album=1 &linkToImage=`1`]] 
```

如果您将 thumbTpl 块保留为示例，您将获得图像的直接链接：

```
 <a href="[[+linkToImage:if=`[[+linkToImage]]`:is=`1`:then=`[[+image_absolute]]`:else=`[[~[[*id]]?
            &[[+imageGetParam]]=`[[+id]]`
            &[[+albumRequestVar]]=`[[+album]]`
            &[[+tagRequestVar]]=`[[+tag]]` ]]`]]"> 
```

现在你只是得到`else`一部分。

# .net - 如何告诉 ConfigurationManager.ConnectionStrings 提取特定的连接字符串

> ID：13293603
> 
> 赞同：0
> 
> 时间：2012-11-08T16:45:17.440
> 
> 标签：.net, vb.net, console-application

我正在使用一些 Microsoft 示例代码，他们有一个使用 ConfigurationManager.ConnectionStrings 从 app.config 中提取一系列连接字符串并允许个人选择他们想要的字符串的示例。我不需要选择的能力，我只想得到我定义的特定命名的连接字符串。类似的东西（是的，我知道这不是真正的代码）：

```
Configuration.ConnectionStrings.Select("myconnection") 
```

这可能吗？如果没有，我应该如何拉入单个连接字符串？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:48:08.853

您需要参考 System.Configuration.ConfigurationManager

```
 ConfigurationManager.ConnectionStrings["myconnection"].ConnectionString 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:48:33.693

```
ConfigurationManager.ConnectionStrings["my_connection"].ConnectionString 
```

# c# - Outlook 将 ` ` 添加到 HTML 链接

> ID：13293604
> 
> 赞同：1
> 
> 时间：2012-11-08T16:45:21.077
> 
> 标签：c#, .net, outlook, vsto, add-in

我正在使用 C# 创建一个 Outlook 加载项，当用户单击 Outlook 电子邮件中的“发送”按钮时，该加载项在 HTML（新）电子邮件正文签名中搜索链接。我正在连接 Application_ItemSend 事件。奇怪的是，在我运行 XP/Outlook 2007 的机器和另一台 Win7/Outlook 2007 机器上，我能够毫无问题地搜索签名中的链接。但是在其他一些 Win7/Outlook 2007 机器上，我无法搜索链接，因为 Outlook 正在插入一个额外的 span 元素。

例如，我正在HTML（新）电子邮件正文中搜索`<a href="http://www.google.com">`链接。`</a>`上面的链接是由默认签名插入的，所以我希望一直都能找到它。在某些机器上我可以，在某些机器上我不能，因为链接看起来像这样： `<a href="http://www.google.com"><span style='color:blue'>`链接`</span></a>` 我推出了一个标准签名 html 文件，所以所有机器的签名都是相同的，但问题仍然存在。我仍在比较字体/主题设置，但到目前为止没有发现任何区别。

有人知道这里发生了什么吗？

谢谢。

# jquery - jQuery在项目列表中搜索

> ID：13293605
> 
> 赞同：0
> 
> 时间：2012-11-08T16:45:33.183
> 
> 标签：jquery

我正在使用 jQuery 构建一个简单的搜索功能，它将根据用户作为查询输入的内容过滤项目列表。它不会做任何花哨的算法，只是一个简单的匹配。

在这里小提琴：http: [//jsfiddle.net/T7hF3/](http://jsfiddle.net/T7hF3/)

如您所见，我有嵌套列表。计划是，如果任何列表项匹配，那么它应该显示最高父项`<li>`并隐藏所有其他没有匹配项的项。

如果用户没有输入任何内容，那么所有列表项都应该再次显示！

谁能帮我指出正确的方向。我尝试使用 jQuery each 方法来查找包含查询的所有项目并显示它们，但它却将它们全部隐藏起来......

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:59:22.663

它不喜欢你`contains()`对元素的使用，而不是文本。我将其更改为使用过滤器。我还让它隐藏了每个元素，而不仅仅是子`li`元素，所以一切都被隐藏了。

它现在可以工作，但请记住它区分大小写......

[**工作jsfiddle示例**](http://jsfiddle.net/T7hF3/9/)

```
$('form.groups-search').live('submit', function(e) {
    e.preventDefault();
    query = $('input#q').val();
    if (query === "") {
        $('ul.groups-tree *').show();
    } else {
        $('ul.groups-tree *').hide();
        $('ul.groups-tree li').filter(function () {
            return $(this).text().indexOf(query) != -1;
        }).show().parents().show();
    }
});? 
```

# android - 可以计算旋转矩阵的宽度/高度吗？

> ID：13293607
> 
> 赞同：1
> 
> 时间：2012-11-08T16:45:35.117
> 
> 标签：android, matrix, rotation, scale, dimensions

如果我使用这个：

```
mCamera.rotateY(45);
mCamera.getMatrix(mMatrix);
mMatrix.preTranslate(-pivotX, -pivotY);
mMatrix.postTranslate(pivotX + centerX, pivotY + centerY); 
```

并做：

```
canvas.drawBitmap(bitmap, mMatrix, null); 
```

然后绘制的图片会更高更苗条，矩阵将很好地应用于整个图片。现在，有没有办法计算旋转后的大小？我想通过缩放来适应图像，现在当我旋转它时，由于父级的约束，一些顶部和底部被剪裁了。谢谢！

编辑：

我要做的是旋转图像，rotateY 的范围是 0 到 90。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T08:23:15.383

好吧，您可以轻松地让矩阵映射位图的角，然后计算边界，因为映射的角将是 x 和 y 坐标的最大/最小值。也许你可以在没有太多`if`条款的情况下做到这一点:)

**编辑：** 签出

```
RectF r = new RectF(/*your bitmap's corners*/);
matrix.mapRect(r); 
```

这样你应该得到`r`新的尺寸。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:43:29.663

如果你坚持 45°，那么毕达哥拉斯就是关键

# ruby-on-rails - ActiveRecord::基类不可变？

> ID：13293608
> 
> 赞同：1
> 
> 时间：2012-11-08T16:45:37.050
> 
> 标签：ruby-on-rails, ruby, activerecord, immutability

我有一个从 ActiveRecord::Base 扩展的类...

```
class Profile < ActiveRecord::Base 
```

我像这样收集它的记录......

```
records = @profile.all 
```

效果很好，但似乎我无法成功更新属性。我不想将它们保存回数据库，只需在将它们导出为 JSON 之前对其进行修改。我的问题是，为什么我不能更新这些？我正在执行以下操作（在导出之前转换日期格式）：

```
 records.collect! { |record|
        unless record.term_start_date.nil?
            record.term_start_date = Date.parse(record.term_start_date.to_s).strftime('%Y,%m,%d')
        end

        unless record.term_end_date.nil? 
            record.term_end_date = Date.parse(record.term_end_date.to_s).strftime('%Y,%m,%d') 
        end

        record
    } 
```

起初我只是在每个循环中执行此操作，但尝试收集！看看它是否会解决问题，但没有区别。我错过了什么？

PS - 我在 irb 的一张唱片上试过这个并得到了相同的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T19:00:37.203

我建议用另一种方法来解决问题，将逻辑封装在类本身中。

覆盖类中的`as_json`实例方法`Profile`。

```
def as_json(options={})
  attrs = super(options)

  unless attrs['term_start_date'].nil?
    attrs['term_start_date'] = Date.parse(attrs['term_start_date'].to_s).strftime('%Y,%m,%d')
  end

  unless attrs['term_end_date'].nil? 
    attrs['term_end_date'] = Date.parse(attrs['term_end_date'].to_s).strftime('%Y,%m,%d') 
  end

  attrs
end 
```

现在，当您将记录呈现为 json 时，它们将自动使用此逻辑生成中间散列。您也不会冒意外将格式化日期保存到数据库的风险。

如果您不想要格式化逻辑，您还可以设置自己的自定义选项名称。

这篇[博客文章](http://jonathanjulian.com/2010/04/rails-to_json-or-as_json/)更详细地解释了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:53:57.840

尝试添加`record.save!`之前`record`。

实际上，通过使用`collect!`，您只是修改了记录数组，但是要将修改后的记录保存到数据库中，您应该在每条记录上使用`save`or `save!`（如果保存失败，则会引发异常）。

# css - 堆叠背景：如何使其在另一个 div 下可见

> ID：13293611
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:45:56.960
> 
> 标签：css, positioning, background-position

我有两个列 div，我正在为第二个 div 应用一个大背景，并将其背景位置向左移动。我希望它保持整体可见，而不是隐藏在第一个 div 下，同时避免使用负边距或其他有趣的业务。现在它因为溢出而被隐藏：当然是隐藏的......有什么想法吗？

这是示例[http://tinkerbin.com/UqYLFKZG](http://tinkerbin.com/UqYLFKZG)。

这是代码：

HTML：

```
<div class="left">
<ul>
  <li>one item</li>
  <li>one item</li>
  <li>one item</li>
  </ul>
</div>
<div class="middle">
<ul>
  <li>one item</li>
  <li>one item</li>
  <li>one item</li>
  </ul>
</div> 
```

CSS

```
.left {float:left;width:100px;}
.middle {overflow:hidden;background:url("http://farm8.staticflickr.com/7116/8163983721_1ed2414765_b.jpg") no-repeat;background-position:-400px -200px;} 
```

编辑：对反对票有点惊讶；确实，这个问题似乎太容易回答了，因为我在删除溢出时：隐藏，因为左侧不在文档的正常流程中，中间的内容与左侧的内容重叠..因此我需要添加一些左边距或填充来解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T21:00:51.257

解决方案是删除 overflow:hidden 并添加 margin-left 或 padding left 等于 .left div 的大小，以便正确定位 .middle 。

# c++ - C++/boost::thread 程序在 join_all 后挂起并从 Main 返回

> ID：13293612
> 
> 赞同：4
> 
> 时间：2012-11-08T16:46:07.597
> 
> 标签：c++, multithreading, boost

第一次在这里发帖，但我已经彻底寻找这个问题的解决方案并且没有解决方案。我有一个类，它基本上使用静态范围的线程池来计算矩阵的条目。当需要进行新的计算时，静态条件变量会发出信号。当程序结束时，一个静态布尔标志被改变，主线程在退出前调用join_all。问题是当我从 int main() 返回时，程序在静态变量的销毁过程中似乎挂起。

这是执行计算的类的粗略源代码：

```
class FunctionCalculator
{
    public:
        static void createWorkers();
        static void destroyWorkers();
        static void calcFunction();

    private:
        static void run();

        static boost::thread_group workers_;
        static boost::mutex theLock_;

        static int curIndex_;
        static unsigned int numCalcsComplete_;

        static boost::condition_variable stateChange_;
        static boost::condition_variable calculationFinished_;

        static bool finished_;

        static struct SharedCalcData { // some vars } calcData_;
};

// static member definitions
int FunctionCalculator::curIndex_;
unsigned int FunctionCalculator::numCalcsComplete_;
boost::mutex FunctionCalculator::theLock_;
boost::condition_variable FunctionCalculator::stateChange_;
boost::condition_variable FunctionCalculator::calculationFinished_;
boost::thread_group FunctionCalculator::workers_;
bool FunctionCalculator::finished_;
FunctionCalculator::SharedCalcData FunctionCalculator::calcData_;

void FunctionCalculator::createWorkers()
{
    finished_ = false;
    curIndex_ = -1;

    for( unsigned int i = 0; i < 4; i++ )
        workers_.create_thread( boost::bind( &FunctionCalculator::run ) );
}

void FunctionCalculator::destroyWorkers()
{
    {
        boost::mutex::scoped_lock lock( theLock_ );

        finished_ = true;
        curIndex_ = 0;

        stateChange_.notify_all();
    }

    workers_.join_all();
}

void FunctionCalculator::run()
{
    unsigned int i = 0; // the column of the matrix to fill in
    while ( true )
    {
        {
            boost::mutex::scoped_lock lock( theLock_ );

            // block if the calculation is finished until there's a new calculation
            while ( curIndex_ < 0 )
                stateChange_.wait( lock );

            // check if it's time for threads to die
            if ( finished_ )
                break;

            // get the next index to process
            i = (unsigned int)curIndex_++;

            // signal all threads to block if this is the last thread in the calculation
            if ( i == 49 )
                curIndex_ = -1;
        }

        // perform calculation/fill in matrix

        {
            boost::mutex::scoped_lock lock( theLock_ );

            ++numCalcsComplete_;

            // wake up the main thread if this was the last thread in the calculation
            if ( numCalcsComplete_ == 50 )
               calculationFinished_.notify_one();
        }
    }
}

void FunctionCalculator::calcFunction()
{
    // assign calcData_

    {
        boost::mutex::scoped_lock lock( theLock_ );

        curIndex_         = 0;
        numCalcsComplete_ = 0;

        stateChange_.notify_all();

        while ( curIndex_ >= 0 )
            calculationFinished_.wait( lock );
    }
} 
```

这是主要方法的一些粗略代码。它实际上是由 main 创建的一个对象，它调用 createWorkers() 和 calcFunction() 实际上由 Gnu 科学库调用（为此我使用静态成员），但想法是这样的：

```
int main( int argc, char* argv[] )
{
    FunctionCalculator fc;

    FunctionCalculator::createWorkers();

    for ( int i = 0; i < 10; i++ )
        fc.calcFunction();

    FunctionCalculator::destroyWorkers();

    return EXIT_SUCCESS;
} 
```

调用 EXIT_SUCCESS 后，程序挂起，但我已验证 FunctionCalculator 中的四个线程在调用 destroyWorkers() 后已完成 run() 方法。由于程序从main返回，我的理论是问题发生在静态boost库变量最后被销毁时。任何人都可以看到问题吗？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-22T19:56:37.617

根据您的编译器的优化级别，以下代码：

```
while ( curIndex_ < 0 )
            stateChange_.wait( lock ); 
```

可以解释为

```
while ( true )
            stateChange_.wait( lock ); 
```

因为变量 curIndex_ 在这个 while 循环内没有改变。这可能会导致您提到的僵局。您可以将 curIndex_ 声明为 volatile 以强制编译器不优化对此变量的访问。

# javascript - jquery如何从对象中收集所有链接值？

> ID：13293616
> 
> 赞同：0
> 
> 时间：2012-11-08T16:46:13.633
> 
> 标签：javascript, jquery, object

我有一个对象，只是我需要收集并存储包含标签的对象作为链接到一个新数组中。谁能给我最好的方法来做到这一点？

我的对象：

```
 var xploreMaps = {
            radious:55,
            stroke:5,strokeColor:'#fff',
            opacity:0.8,fontSize:13,line:10,
            cRtext:{
                length:4,
                lineColor:'#7d2c2c',
                prop:{
                    0:{link:'motionGraphics.html',color:'#595959',text:'Motion Graphics'},
                    1:{link:'video.html',color:'#306465',text:'Video'},
                    2:{link:'photography.html',color:'#7e6931',text:'Photography'},
                    3:{link:'copyRight.html',color:'#4c4966',text:'Copywriting'}
                    }
            },
            cBtext:{
                length:3,
                lineColor:'#4c839d',
                prop:{
                    0:{link:'imagination.html',color:'#595959',text:'Imagination'},
                    1:{link:'innovation.html',color:'#306465',text:'Innovation'},
                    2:{link:'ideation.html',color:'#7e6931',text:'Ideation'}
                    }
            },
            cGtext:{
                length:5,
                lineColor:'#579549',
                prop:{
                    0:{link:'catalogs .html',color:'#7a5967',text:'Catalogs',
                    subLink:{0:{link:'SEO_SMM.html',color:'#4e4b69',text:'SEO/SMM',align:'top'},1:{link:'site_analytics.html',color:'#545454',text:'Site analytics',align:'btm'}}},
                    1:{link:'socialmedia.html',color:'#1e9ead',text:'Innovation'},
                    2:{link:'loyalty .html',color:'#8fad34',text:'Ideation'},
                    3:{link:'promotions .html',color:'#563b64',text:'Promotions'},
                    4:{link:'implementations.html',color:'#2c6566',text:'Implementations',
                    subLink:{0:{link:'integrating.html',color:'#4c4a66',text:'Integrating',align:'top'},1:{link:'payment.html',color:'#948048',text:'Payment',align:'btm'}}}
                    }
            }
} 
```

我尝试的功能：

```
var links = []//just i need all the objects which contains the link.

        var objFinder = function (obj){
            $.each(obj,function(key,val){
                if(key == 'link' && typeof val == 'string'){
                    links.push(val)
                }else{
                    objFinder(val);//throws errors;
                }
            })
        }
        objFinder(xploreMaps);
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:20:04.293

我认为主要问题是您的对象具有 property `length`。那是搞乱处理。请参阅我在这里创建的小提琴：

[http://jsfiddle.net/8Zfdj/](http://jsfiddle.net/8Zfdj/)

我刚刚注释掉了该`length`属性，它似乎工作正常。我还做了一些小的清理，例如添加缺少的分号，但这不是主要问题。

您可以在此处查看 jQuery 错误（无效）：

[http://bugs.jquery.com/ticket/7260](http://bugs.jquery.com/ticket/7260)

# javascript - 为什么我的 AJAX 函数多次调用回调？

> ID：13293617
> 
> 赞同：8
> 
> 时间：2012-11-08T16:46:14.137
> 
> 标签：javascript, ajax

我制作了一个 ajax post 函数，当我调用它一次时，传递给它的回调函数最终被调用了 3 次。 **为什么多次调用回调？**

我正在尝试使用一种“模块”javascript 模式，该模式使用闭包将类似的功能包装在一个全局变量下。我的 ajax 模块是它自己的文件，看起来像这样：

```
var ajax = (function (XMLHttpRequest) {
    "use strict";

    var done = 4, ok = 200;

    function post(url, parameters, callback) {

        var XHR = new XMLHttpRequest();

        if (parameters === false || parameters === null || parameters === undefined) {
            parameters = "";
        }

        XHR.open("post", url, true);
        XHR.setRequestHeader("content-type", "application/x-www-form-urlencoded");
        XHR.onreadystatechange = function () {
            if (XHR.readyState === done && XHR.status === ok) {
                callback(XHR.responseText);
            }
        };
        XHR.send(parameters);
    }

    // Return the function/variable names available outside of the module.
    // Right now, all I have is the ajax post function.
    return {
        post: post
    };

}(parent.XMLHttpRequest)); 
```

主应用程序也是它自己的文件。例如，它看起来像这样：

```
// Start point for program execution.

(function (window, document, ajax) {
    "use strict";

    ajax.post("php/paths.php", null, function () { window.alert("1"); });

}(this, this.document, parent.ajax)); 
```

如您所见，我试图将依赖项作为局部变量/命名空间引入。当它运行时，它会弹出警告框 3 次。

我不确定这个问题是由于 ajax 函数本身还是整体架构（或两者兼而有之）造成的，所以我很感激对任何一个的评论或想法。

我试过从匿名函数中解开程序的主要部分，但这没有帮助。提前致谢！

***编辑：*** 这是整个 HTML 文件，因此您可以看到我包含`<script>`'s 的顺序。

```
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="expires" conent="0" />
    <title>Mapalicious</title>
    <link href="css/main.css" type="text/css" rel="stylesheet" />
    <script src="js/raphael.js"></script>
</head>
<body>
    <div id="map"></div>
    <script src="js/promise.js"></script>
    <script src="js/bigmap.js"></script>
    <script src="js/ajax.js"></script>
    <script src="js/init.js"></script>
</body>
</html> 
```

***编辑2：***

我在我的例子中有一个错字，并改变了

```
(function (window, document, bigmap, ajax) { 
```

至

```
(function (window, document, ajax) { 
```

***编辑 3：***

我已经更改了`onreadystatechange`将就绪状态记录到控制台的功能：

```
XHR.onreadystatechange = function () {
    console.log("readyState: " + XHR.readyState);
    if (XHR.readyState === done && XHR.status === ok) {
        callback(XHR.responseText);
    }
}; 
```

当我在谷歌浏览器中单步执行代码时，回调被调用了 3 次，控制台记录：

```
readyState: 4
readyState: 4
readyState: 4 
```

但是，当我正常运行页面并且不单步执行时，该函数按预期工作并且只运行一次回调。在这种情况下，控制台会记录：

```
readyState: 2
readyState: 3
readyState: 3
readyState: 4 
```

所以现在我的问题是，**为什么在单步执行代码时会多次调用回调？**

**解决了：**

当我问这个问题时，我没有意识到*只有在调试时单步执行代码时才会发生这种情况*。

**所以**，状态改变了 3 次，但是执行被断点延迟了，所以所有 3 个`onreadystatechange`函数都看到了 4 的当前状态，而不是实际发生变化时*的状态。*

要点是`onreadystatechange`更改不会存储该状态是什么。`readyState` *相反，它在执行时*读取，即使程序被中断，同时状态再次发生变化。

因此，AJAX 需要与使用完全同步代码不同的调试技术……但您可能已经知道这一点。

**感谢所有在这里提供帮助的人。**

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-08T17:01:50.557

有 4 个不同的`readyState`状态：

0 - 未初始化请求
1 - 连接到服务器
2 - 收到请求
3 - 正在处理
4 - 完成，收到响应

这些更改中的每一个都将调用`onreadystatechange`处理程序。这就是为什么大多数这些函数看起来像这样：

```
xhr.onreadystatechange = function()
{
    if (this.readyState === 4 && this.status === 200)
    {
        //do stuff with this.responseText
    }
} 
```

只需对它们进行硬编码，而不是使用狡猾的变量（这些名称对我`done`来说`ok`似乎很危险）。

除此之外，尝试`post`直接在返回的对象中声明函数：

```
return {post : function()
{
}; 
```

或作为匿名。函数，分配给变量`post`：

```
var post = function(){}; 
```

各种引擎用函数做各种各样的事情，你声明它们的方式，提升它们，其中之一。`post`如果您问我，作为函数名称也感觉不正确...我会尝试使用看起来不像保留*的*名称...

此外，您没有明确设置 XHR 的`X-Requested-With`标头：

```
XHR.setRequestHeader('X-Requested-With', 'XMLHttpRequest'); 
```

这可能只是导致问题的原因（HTTP1.1 和传输编码分块？）

`callback(XHR.responseText);`为了使调试更容易，请尝试通过更改为每次显示警报时记录 XHR 对象`callback.apply(this,[this.responseText]);`，尽管该参数是多余的。然后，更改`ajax.post("php/paths.php", null, function () { window.alert("1"); });`为：

```
ajax.post("php/paths.php", null,
function (response)
{
     console.log(this.readyState);//or alert the readyState
     window.alert(response);//check the response itself, for undefined/valid responses
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:55:58.660

在我看来，您的 ajax 对象正在返回对 post 函数的调用。如果是这样，并且您在 ajax 变量上调用 post 函数，它不会调用 post 至少两次：一次在对象实例化时，下一次在方法调用上？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-20T19:49:05.420

我在使用 ajax 方面很新，但我遇到了同样的问题，我正在尝试解决。我一直在阅读 w3chools 中有关 ajax 的信息。我注意到，当检查状态时，他们使用`this.readystate`而`this.status` **不是**. `object.readystate`我认为出于某种原因，它会在 e 上触发 3 次`object.readystat`并且与`this.readystate`. 我明天会检查它，但我认为这可能是问题所在。

# jquery - 对使用 jQuery .ajax() 的“数据：”设置感到困惑

> ID：13293620
> 
> 赞同：1
> 
> 时间：2012-11-08T16:46:28.463
> 
> 标签：jquery

嘿，伙计们，这很简单——我在[Adam Wulf 的网站上](http://welcome.totheinter.net/tutorials/model-view-controller-in-jquery/phase-1/p3/)遇到了一个很酷的 MVC 示例，我试图了解所有不同部分如何交互......在 model.js 中，他有两种不同的使用方式**数据：**设置。有人可以解释他们两者之间的区别，也许是不同方法的一个例子？代码：

```
 $.ajax({
            url: 'ajax.php',
            data : { load : true },
            type: 'GET',
            dataType: 'json',
            timeout: 1000,
            error: function(){
                that.notifyLoadFail();
            },
            success: function(data){
                loadResponse(data);
                that.notifyLoadFinish();
            }
        }); 
```

与此示例相比：

```
 $.ajax({
            url: 'ajax.php',
            data : { load : true, id : id },
            type: 'GET',
            dataType: 'json',
            timeout: 1000,
            error: function(){
                that.notifyLoadFail();
            },
            success: function(data){
                loadResponse(data);
                that.notifyLoadFinish();
            }
        }); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:50:04.400

它只是一个用于将值传递给服务器的匿名对象。在第一个示例中，它包含一个值“load”：

```
data : { load : true } 
```

第二，它有两个值：

```
data : { load : true, id : id } 
```

...“加载”和“ID”。以第二个例子为例：服务器将收到请求的两个参数。例如，在 PHP 中，您可以通过以下方式检索它们：

```
$id = $_GET['id'];
$load = $_GET['load']; 
```

说得通？

干杯

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:50:47.653

数据作为 JSON-Object 传递，如下所示：

```
{ variable1: value1, variable2: value2 } 
```

在`ajax.php`-file 中，您可以使用以下变量访问这些`$_GET`变量：

```
$var1 = $_GET['variable1']  // = value1
$var2 = $_GET['variable2']  // = value2 
```

# mysql - 对存储过程的评论在 mysqldump 上被截断

> ID：13293621
> 
> 赞同：1
> 
> 时间：2012-11-08T16:46:29.543
> 
> 标签：mysql, mysqldump

如何在备份 mysql 数据库时在存储过程中包含注释。我正在使用带有以下命令的 mysql 5.5.16 服务器：

`mysql -u root -p mydb<mydbbakup.sql`

我也尝试过 sql yog，但没有成功。

**更新：** 问题出在 restore 命令上。使用记事本打开转储文件时，存储过程中的所有注释都在那里。以下恢复命令需要任何额外的属性吗？

`mysql -u root -p mydb<mydbbakup.sql;`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T23:51:25.760

要恢复转储文件并包含注释，请使用[--comments](http://dev.mysql.com/doc/refman/5.5/en/mysql-command-options.html#option_mysql_comments)选项`mysql`。例如：

```
mysql --comments -u root -p mydb<mydbbakup.sql 
```

或者，您可以将其添加到您的`~/.my.cnf`文件中：

```
echo "[mysql]" >>~/.my.cnf
echo "comments=true" >>~/.my.cnf 
```

# php - 使用 Visual Studio 数据库文件作为 wamp 的 ms sql 服务器（带有 ms sql 的 php）

> ID：13293623
> 
> 赞同：1
> 
> 时间：2012-11-08T16:46:29.373
> 
> 标签：php, mysql, sql-server, visual-studio

以前我使用 php 和 mysql 一起工作，但由于客户要求，我从 mysql 更改为 .net、c#、Linq 和数据库文件，他们说要使用 Visual Studio，我下载了 2012 版，我正在寻找使用以前完成的用于处理 Visual Studio 数据库文件的 php 脚本。所以，请告诉我访问数据库的方法。我对 Visual Studio 很陌生，我正在搜索数据库登录详细信息..

# bash - GLOBIGNORE 不适用于 sudo 命令

> ID：13293625
> 
> 赞同：0
> 
> 时间：2012-11-08T16:46:34.163
> 
> 标签：bash, sudo, tail

我正在使用一个迷你 shell 脚本来“跟踪”（实时）一堆日志文件。

```
#!/bin/sh

oldGLOBIGNORE=$GLOBIGNORE

export GLOBIGNORE='foo-bar.log'

sudo -E tail -f -n0 /var/log/*.log

GLOBIGNORE=$oldGLOBIGNORE 
```

如您所见，我想记录除名为`foo-bar.log`.

sudo的`-E`选项应该允许我保留`GLOBIGNORE`变量，但看起来它不起作用。

我正在 Ubuntu 10.04、bash 4.1.5 上进行测试。

有什么线索吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:57:46.750

首先 -`GLOBIGNORE`与文件名扩展产生的完整文件路径有关，而不仅仅是最后一部分。所以你实际上想写`GLOBIGNORE='/var/log/foo-bar.log'`.

其次，您实际上不需要导出`GLOBIGNORE`到环境中并添加`-E`，因为`/var/log/*.log`Bash 甚至在调用`sudo`.

第三 - 您保存旧值`GLOBIGNORE`并在之后恢复它的方法不太理想，因为`GLOBIGNORE`未设置时的行为与其设置但为空时的行为不同，并且您的脚本永远无法将其恢复为未设置。幸运的是，脚本*不需要*恢复它（因为脚本的变量不会在脚本返回后继续生效），所以你可以删除那些东西。

总而言之，你可以写：

```
#!/bin/sh

GLOBIGNORE=/var/log/foo-bar.log
sudo tail -f -n0 /var/log/*.log 
```

# silverlight - DataTemplate 中的 TextBlock 忽略的 FontSize 样式

> ID：13293627
> 
> 赞同：2
> 
> 时间：2012-11-08T16:46:39.653
> 
> 标签：silverlight, xaml, silverlight-5.0

TextBlock 的样式（如下）对 DataTemplate 的 TextBlock 没有影响。如果我在样式和模板中都将 TextBlock 更改为 TextBox，则样式会按我的预期应用。为什么 TextBlock 会忽略样式？

谢谢你，
本

```
<UserControl x:Class="SilverlightApplication1.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:l="clr-namespace:SilverlightApplication1" mc:Ignorable="d"
    d:DesignHeight="300" d:DesignWidth="400">
    <UserControl.Resources>
        <Style TargetType="TextBlock">
            <Setter Property="FontSize" Value="20" />
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="FontSize" Value="20" />
        </Style>
        <DataTemplate DataType="l:MyObject">
            <TextBlock Text="{Binding Name}" />
        </DataTemplate>
    </UserControl.Resources>

    <StackPanel>
        <ItemsControl>
            <ItemsControl.Items>
            <l:MyObject Name="Frank" />
            </ItemsControl.Items>
        </ItemsControl>
    </StackPanel>
</UserControl> 
```

# types - Highcharts，您可以更改向下钻取的图表类型吗？

> ID：13293629
> 
> 赞同：4
> 
> 时间：2012-11-08T16:46:45.007
> 
> 标签：types, charts, highcharts, drilldown

Highcharts，您可以更改向下钻取的图表类型吗？

我想首先呈现一个标准的“柱形”图表，然后向下钻取到一个“条形”图表，我已经尝试了我能想到的一切......

我认为它将在向下钻取代码中设置，但似乎并没有以这种方式工作。如...

```
drilldown: {
    type: 'pie',
    name: 'Chart1',
    categories ['1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28'],
    data: [1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8],
    color: colors[0]
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T19:07:12.400

我不知道你试过什么，但你可以做到。
看看我的[**例子**](http://jsfiddle.net/q7Ss6/)。

```
$(function () {
    var chart;
    $(document).ready(function() {

        var colors = Highcharts.getOptions().colors,
            categories = ['MSIE', 'Firefox', 'Chrome', 'Safari', 'Opera'],
            name = 'Browser brands',
            data = [{
                    y: 55.11,
                    color: colors[0],
                    drilldown: {
                        name: 'MSIE versions',
                        categories: ['MSIE 6.0', 'MSIE 7.0', 'MSIE 8.0', 'MSIE 9.0'],
                        data: [10.85, 7.35, 33.06, 2.81],
                        color: colors[0]
                    }
                }, {
                    y: 21.63,
                    color: colors[1],
                    drilldown: {
                        name: 'Firefox versions',
                        categories: ['Firefox 2.0', 'Firefox 3.0', 'Firefox 3.5', 'Firefox 3.6', 'Firefox 4.0'],
                        data: [0.20, 0.83, 1.58, 13.12, 5.43],
                        color: colors[1]
                    }
                }, {
                    y: 11.94,
                    color: colors[2],
                    drilldown: {
                        name: 'Chrome versions',
                        categories: ['Chrome 5.0', 'Chrome 6.0', 'Chrome 7.0', 'Chrome 8.0', 'Chrome 9.0',
                            'Chrome 10.0', 'Chrome 11.0', 'Chrome 12.0'],
                        data: [0.12, 0.19, 0.12, 0.36, 0.32, 9.91, 0.50, 0.22],
                        color: colors[2]
                    }
                }, {
                    y: 7.15,
                    color: colors[3],
                    drilldown: {
                        name: 'Safari versions',
                        categories: ['Safari 5.0', 'Safari 4.0', 'Safari Win 5.0', 'Safari 4.1', 'Safari/Maxthon',
                            'Safari 3.1', 'Safari 4.1'],
                        data: [4.55, 1.42, 0.23, 0.21, 0.20, 0.19, 0.14],
                        color: colors[3]
                    }
                }, {
                    y: 2.14,
                    color: colors[4],
                    drilldown: {
                        name: 'Opera versions',
                        categories: ['Opera 9.x', 'Opera 10.x', 'Opera 11.x'],
                        data: [ 0.12, 0.37, 1.65],
                        color: colors[4]
                    }
                }];

        function setChart(options) {
            chart.series[0].remove(false);
            chart.addSeries({
                type: options.type,
                name: options.name,
                data: options.data,
                color: options.color || 'white'
            }, false);
            chart.xAxis[0].setCategories(options.categories, false);
            chart.redraw();
        }

        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container'
            },
            title: {
                text: 'Browser market share, April, 2011'
            },
            subtitle: {
                text: 'Click the columns to view versions. Click again to view brands.'
            },
            xAxis: {
                categories: categories
            },
            yAxis: {
                title: {
                    text: 'Total percent market share'
                }
            },
            plotOptions: {
                series: {
                    cursor: 'pointer',
                    point: {
                        events: {
                            click: function() {
                                var drilldown = this.drilldown;
                                var options;
                                if (drilldown) { // drill down
                                    options = {
                                        'name': drilldown.name,
                                        'categories': drilldown.categories,
                                        'data': drilldown.data,
                                        'color': drilldown.color,
                                        'type': 'pie'
                                    };
                                } else { // restore
                                    options = {
                                        'name': name,
                                        'categories': categories,
                                        'data': data,
                                        'type': 'column'
                                    };
                                }
                                setChart(options);
                            }
                        }
                    },
                    dataLabels: {
                        enabled: true,
                        color: colors[0],
                        style: {
                            fontWeight: 'bold'
                        },
                        formatter: function() {
                            return this.y +'%';
                        }
                    }
                }
            },
            tooltip: {
                formatter: function() {
                    var point = this.point,
                        s = this.x +':<b>'+ this.y +'% market share</b><br/>';
                    if (point.drilldown) {
                        s += 'Click to view '+ point.category +' versions';
                    } else {
                        s += 'Click to return to browser brands';
                    }
                    return s;
                }
            },
            series: [{
                type: 'column',
                name: name,
                data: data,
                color: 'white'
            }],
            exporting: {
                enabled: false
            }
        });
    });

}); 
```

确保您没有`type`为所有系列定义。[参考](http://api.highcharts.com/highstock#chart.type)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-12-15T12:47:54.410

好吧，我认为如果您定义每个系列的类型就足够了

```
$(function () {
// Create the chart
Highcharts.chart('container', {
    title: {
        text: 'Browser market shares. January, 2015 to May, 2015'
    },
    subtitle: {
        text: 'Click the columns to view versions. Source: <a href="http://netmarketshare.com">netmarketshare.com</a>.'
    },
    xAxis: {
        type: 'category'
    },
    yAxis: {
        title: {
            text: 'Total percent market share'
        }

    },
    legend: {
        enabled: false
    },
    plotOptions: {
        series: {
            borderWidth: 0,
            dataLabels: {
                enabled: true,
                format: '{point.y:.1f}%'
            }
        }
    },

    tooltip: {
        headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
        pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}%</b> of total<br/>'
    },

    series: [{
        name: 'Brands',
        type: 'column',
        colorByPoint: true,
        data: [{
            name: 'Microsoft Internet Explorer',
            y: 56.33,
            drilldown: 'Microsoft Internet Explorer'
        }, {
            name: 'Chrome',
            y: 24.03,
            drilldown: 'Chrome'
        }, {
            name: 'Firefox',
            y: 10.38,
            drilldown: 'Firefox'
        }, {
            name: 'Safari',
            y: 4.77,
            drilldown: 'Safari'
        }, {
            name: 'Opera',
            y: 0.91,
            drilldown: 'Opera'
        }, {
            name: 'Proprietary or Undetectable',
            y: 0.2,
            drilldown: null
        }]
    }],
    drilldown: {
        series: [{
            type: 'line',
                name: 'Microsoft Internet Explorer',
            id: 'Microsoft Internet Explorer',
            data: //your drill data
        }, {
            name: 'Chrome',
            id: 'Chrome',
            data: //your drill data
        }, {
            name: 'Firefox',
            id: 'Firefox',
            data: //your drill data
        }, {
            name: 'Safari',
            id: 'Safari',
            data: //your drill data
        }, {
            name: 'Opera',
            id: 'Opera',
            data: //your drill data
        }]
    }
}); 
```

[http://jsfiddle.net/ffc4jhb7/](http://jsfiddle.net/ffc4jhb7/)

此致

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-02-15T06:34:57.367

检查这个：

文档

[http://api.highcharts.com/highcharts#series](http://api.highcharts.com/highcharts#series)

原始示例

[http://www.highcharts.com/demo/column-drilldown](http://www.highcharts.com/demo/column-drilldown)

试试这个例子：

```
$(function () {
// Create the chart
$('#container').highcharts({
    chart: {
        type: 'column'
    },
    title: {
        text: 'Browser market shares. January, 2015 to May, 2015'
    },
    subtitle: {
        text: 'Click the columns to view versions. Source: <a href="http://netmarketshare.com">netmarketshare.com</a>.'
    },
    xAxis: {
        type: 'category'
    },
    yAxis: {
        title: {
            text: 'Total percent market share'
        }

    },
    legend: {
        enabled: false
    },
    plotOptions: {
        series: {
            borderWidth: 0,
            dataLabels: {
                enabled: true,
                format: '{point.y:.1f}%'
            }
        }
    },

    tooltip: {
        headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
        pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}%</b> of total<br/>'
    },

    series: [{
        name: 'Brands',
        colorByPoint: true,
        data: [{
            name: 'Microsoft Internet Explorer',
            y: 56.33,
            drilldown: 'Microsoft Internet Explorer'
        }, {
            name: 'Chrome',
            y: 24.03,
            drilldown: 'Chrome'
        }, {
            name: 'Firefox',
            y: 10.38,
            drilldown: 'Firefox'
        }, {
            name: 'Safari',
            y: 4.77,
            drilldown: 'Safari'
        }, {
            name: 'Opera',
            y: 0.91,
            drilldown: 'Opera'
        }, {
            name: 'Proprietary or Undetectable',
            y: 0.2,
            drilldown: null
        }]
    }],
    drilldown: {
        series: [{
            type: 'line',
            name: 'Microsoft Internet Explorer',
            id: 'Microsoft Internet Explorer',
            data: [
                [
                    'v11.0',
                    24.13
                ],
                [
                    'v8.0',
                    17.2
                ],
                [
                    'v9.0',
                    8.11
                ],
                [
                    'v10.0',
                    5.33
                ],
                [
                    'v6.0',
                    1.06
                ],
                [
                    'v7.0',
                    0.5
                ]
            ]
        }, {
            type: 'line',
            name: 'Chrome',
            id: 'Chrome',
            data: [
                [
                    'v40.0',
                    5
                ],
                [
                    'v41.0',
                    4.32
                ],
                [
                    'v42.0',
                    3.68
                ],
                [
                    'v39.0',
                    2.96
                ],
                [
                    'v36.0',
                    2.53
                ],
                [
                    'v43.0',
                    1.45
                ],
                [
                    'v31.0',
                    1.24
                ],
                [
                    'v35.0',
                    0.85
                ],
                [
                    'v38.0',
                    0.6
                ],
                [
                    'v32.0',
                    0.55
                ],
                [
                    'v37.0',
                    0.38
                ],
                [
                    'v33.0',
                    0.19
                ],
                [
                    'v34.0',
                    0.14
                ],
                [
                    'v30.0',
                    0.14
                ]
            ]
        }, {
            type: 'line',
            name: 'Firefox',
            id: 'Firefox',
            data: [
                [
                    'v35',
                    2.76
                ],
                [
                    'v36',
                    2.32
                ],
                [
                    'v37',
                    2.31
                ],
                [
                    'v34',
                    1.27
                ],
                [
                    'v38',
                    1.02
                ],
                [
                    'v31',
                    0.33
                ],
                [
                    'v33',
                    0.22
                ],
                [
                    'v32',
                    0.15
                ]
            ]
        }, {
            type: 'line',
            name: 'Safari',
            id: 'Safari',
            data: [
                [
                    'v8.0',
                    2.56
                ],
                [
                    'v7.1',
                    0.77
                ],
                [
                    'v5.1',
                    0.42
                ],
                [
                    'v5.0',
                    0.3
                ],
                [
                    'v6.1',
                    0.29
                ],
                [
                    'v7.0',
                    0.26
                ],
                [
                    'v6.2',
                    0.17
                ]
            ]
        }, {
            type: 'line',
            name: 'Opera',
            id: 'Opera',
            data: [
                [
                    'v12.x',
                    0.34
                ],
                [
                    'v28',
                    0.24
                ],
                [
                    'v27',
                    0.17
                ],
                [
                    'v29',
                    0.16
                ]
            ]
        }]
    }
}); 
```

});

# ios - 我怎样才能回到我的主处理线程？

> ID：13293640
> 
> 赞同：0
> 
> 时间：2012-11-08T16:47:06.503
> 
> 标签：ios, multithreading, ios6, nsurlconnection, objective-c-blocks

我有一个应用程序，我正在访问一个远程网站`NSURLConnection`来运行一些代码，然后保存一些 XML 文件。然后我将访问这些 XML 文件并通过它们进行解析以获取信息。该过程运行良好，只是我的用户界面没有正确更新。我想通过我的`UILabel`. 我正在尝试使用`setBottomBarToUpdating:`. 当我将其设置为“处理中请稍候...”时，它第一次起作用；但是，`connectionDidFinishLoading:`它不会更新。我在想我的 NSURLConnection 正在一个单独的线程上运行，而我`dispatch_get_main_queue`在主线程上更新的尝试不起作用。我怎样才能改变我的代码来解决这个问题？谢谢！[如果我需要包含更多信息/代码，请告诉我！]

**我的文件.m**

```
NSLog(@"Refreshing...");

dispatch_sync( dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
     [self getResponse:@"http://mylocation/path/to/file.aspx"];
});

[self setBottomBarToUpdating:@"Processing Please Wait..."];

queue = dispatch_queue_create("updateQueue", DISPATCH_QUEUE_CONCURRENT); 
```

**连接完成加载：**

```
if ([response rangeOfString:@"Complete"].location == NSNotFound]) {
  // failed
} else {
  //success
  dispatch_async(dispatch_get_main_queue(),^ {
       [self setBottomBarToUpdating:@"Updating Contacts..."];
  });

  [self updateFromXMLFile:@"http://thislocation.com/path/to/file.xml"];

  dispatch_async(dispatch_get_main_queue(),^ {
       [self setBottomBarToUpdating:@"Updating Emails..."];
  });

  [self updateFromXMLFile:@"http://thislocation.com/path/to/file2.xml"];  

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T15:31:31.640

在我的 connectionDidFinishLoading: 我会尝试这样的事情：

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0),^ {
    if ([response rangeOfString:@"Complete"].location == NSNotFound]) {
      // failed
    } else {
      //success
      dispatch_async(dispatch_get_main_queue(),^ {
           [self setBottomBarToUpdating:@"Updating Contacts..."];
      });

      [self updateFromXMLFile:@"http://thislocation.com/path/to/file.xml"];

      dispatch_async(dispatch_get_main_queue(),^ {
           [self setBottomBarToUpdating:@"Updating Emails..."];
      });

      [self updateFromXMLFile:@"http://thislocation.com/path/to/file2.xml"];  
    }
}); 
```

然后所有文件访问都发生在后台队列中，因此主队列没有被锁定。主队列也将更快地完成对 connectionDidFinishLoading 的调用，因为您将所有艰苦的工作投入到默认队列中，这应该让它（和主线程）准备好接受您对 UI 更新的排队这将由默认队列在处理您刚刚加入它的块时完成。

队列切换变为

*   connectionDidFinishLoad 的主线程回调：
*   快速切换到默认全局队列释放主线程
*   最终移交给 setBottomBarToUpdating 的主队列：调用
*   在主线程上执行主队列块以正确更新 UI
*   最终完成主队列上的块
*   最终完成默认队列上的块

您增加了并发性（在您拥有良好的多核设备的情况下很好），并且您已经从主线程中减轻了 I/O 的负担（对它来说从来都不是一个好地方），而是专注于用户界面工作（合适的地方）。

理想情况下，您也可以在主线程之外运行 NSURLConnection 运行循环，但这可能足以让您继续前进。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:57:58.237

您在哪个运行循环中运行 NSURLConnection？如果它是主循环，则您正在排队 setBottomBarToUpdating: 调用您已经在做的工作，因此可能是您没有看到 UI 更新的原因。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:53:06.247

你也可以`performSelectorOnMainThread`这样尝试：

```
if ([response rangeOfString:@"Complete"].location == NSNotFound]) {
                // failed
            } else {
                //success
                [self performSelectorOnMainThread:@selector(setBottomBarToUpdating) withObject:@"Updating Contacts..." waitUntilDone:false];

                [self updateFromXMLFile:@"http://thislocation.com/path/to/file.xml"];

                [self performSelectorOnMainThread:@selector(setBottomBarToUpdating) withObject:@"Updating Emails..." waitUntilDone:false];

                [self updateFromXMLFile:@"http://thislocation.com/path/to/file2.xml"];  

            } 
```

# ios - 来自 TableViewController 的奇怪值，其中填充了来自 JSON 的数据

> ID：13293641
> 
> 赞同：0
> 
> 时间：2012-11-08T16:47:07.033
> 
> 标签：ios, json, uitableview, nsarray, uistoryboardsegue

今天我遇到了无法复制的错误，这让我很困惑。好的小背景：

我目前正在开发具有标签栏控制器作为初始视图控制器的应用程序。有几个导航控制器连接到不同的标签栏项目。

其中之一是从 JSON 填充的 tableViewController。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath 
```

{

```
static NSString *simpleTableIdentifier = @"SimpleTableItem";
   SimpleTableCell *cell = (SimpleTableCell *)[tableView dequeueReusableCellWithIdentifier:simpleTableIdentifier];

if (cell == nil)
{
    NSArray *nib = [[NSBundle mainBundle] loadNibNamed:@"SimpleTableCell" owner:self options:nil];
    cell = [nib objectAtIndex:0];
}   

     //NSMutableArray for storing loaded values
[pics addObject:imageLoad];
[names addObject:[aucdict objectForKey:@"name"]];
[idcka addObject:[aucdict objectForKey:@"auction_id"]];

  // Configure the cell...
cell.nameLabel.text = [aucdict objectForKey:@"name"];
cell.priceLabel.text = [NSString stringWithFormat:@"%@",priceString];
cell.timeLabel.text = [NSString stringWithFormat:@"%@",timeString];

cell.thumbnailImageView.image = imageLoad;

return cell;} 
```

单击行后，我执行 performSegueWithIdentifier：

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath{
[self performSegueWithIdentifier:@"showAuctionDetail" sender:self];} 
```

在 prepareForSegue 我发送一些数据到下一个 ViewController

```
-(void) prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender 
```

{

```
namesArray = [[NSArray alloc] initWithArray:names];
picsArray =[[NSArray alloc] initWithArray:pics];
IDarray = [[NSArray alloc] initWithArray:idcka];
if ([segue.identifier isEqualToString:@"showAuctionDetail"])
{
    NSIndexPath *indexPath = [self.tableView indexPathForSelectedRow];
    detailViewController *dViewController = segue.destinationViewController;
    dViewController.selectedAuctionTitle = [namesArray objectAtIndex:indexPath.row];
    dViewController.auctionPic = [picsArray objectAtIndex:indexPath.row];
    dViewController.id_aukcie = [IDarray objectAtIndex:indexPath.row];
}} 
```

Now comes my problem. Sometimes (this really confuses me, because it I haven't found when does it happen) when I start the application, and tap on some row, I get totally different data passed to DetailViewController. The only thing, I can guess is that my arrays are different (they contain more or less values) than actual JSON response. But that would mean, my app would crash if I clicked on first or last item in table (index out of bounds or something like that), that never happened.

I've seen this bug happened maybe 5 times randomly. I tried to run and quit app for 20 times in a row and it happened only once.

P.S. I know that class name (detailViewController) should start with capital letter, I apologize for that :)

edited: as rdelmar suggested

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:06:55.527

I think the problem is having the call out to the server in the cellForRowAtIndexPath: method. You should put that code in viewDidLoad, and then when the data has come back, and is finished parsing, call reloadData on your table view.

# reporting-services - SSRS 不按嵌入类型在报表上显示图像

> ID：13293642
> 
> 赞同：1
> 
> 时间：2012-11-08T16:47:11.367
> 
> 标签：reporting-services, dynamics-crm

在 SSRS 中，我对报告中的图像有以下设置：

```
MIME Type= Image/jpeg
Source=Embeded
Value= points to the file 
```

当我从 CRM 生成报告时，报告不显示图像。它会生成一个带有 ImageID、SessionID 等的长 URL。所以它似乎找不到图像。我们可以把base64直接放到IMG标签的SRC里吗？或者我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T11:03:29.163

对于我的 20111 On-Prem，我有一个 CRM SSRS 报告，该报告正在提取作为 CRM 中“附件”的 JPG 图片。我们将图像源设置为 Annotation 上的 Base64 “Body”字段。

# asp.net-mvc-4 - 属于与 Entity Framework 5 和 .net MVC 4 的关系不保存

> ID：13293644
> 
> 赞同：0
> 
> 时间：2012-11-08T16:47:14.037
> 
> 标签：asp.net-mvc-4, entity-framework-5

在使用 Entity Framework 5 进行更新/创建时，我无法正确保存我的关系。

我有一个带有 EF 5 的新 MVC 4.0 项目，我正在使用代码优先迁移。

我的模型看起来像这样。

```
public class Blog
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    public string Name { get; set; }
}

public class Post
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    public string Text{ get; set; }
    public virtual Blog Blog { get; set; }
} 
```

我的迁移在我的帖子表中正确创建了一个 Blog_Id 列。

后控制器：

```
var db = new AppContext();
ViewBag.Blogs = new SelectList(db.Blogs.ToList(), "ID", "Title", post.Blog_Id); 
```

帖子视图：

```
<p>
    @Html.LabelFor(model => model.Blog.Id, "Blog")
    @Html.DropDownListFor(model => model.Blog.Id,
         (SelectList)ViewBag.Blogs, "Select blog", new { })
    @Html.ValidationMessageFor(model => model.Blog.Id)
</p> 
```

但是，当我创建/更新帖子时，模型在保存之前具有正确的关系，但 Blog_Id 列不会持久保存到数据库中。

我的更新功能看起来像这样。

```
var db = new AppContext();
db.Posts.Attach(post);
db.Entry(post).State = EntityState.Modified;
db.SaveChanges(); 
```

任何帮助将不胜感激。我看过的所有文档和示例似乎都已过时（主要使用 EF4），而且 MSDN 文档似乎是自引用的（EF 说要查看文档，文档说要查看 EF 站点）并且难以导航。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:18:52.277

最简单的解决方案是将外键公开为模型中的属性：

```
public class Post
{
    [Key]
    [DatabaseGeneratedAttribute(DatabaseGeneratedOption.Identity)]
    public int Id { get; set; }
    public string Text{ get; set; }

    public int BlogId { get; set; } // FK property
    public virtual Blog Blog { get; set; }
} 
```

然后将您的帖子视图绑定到该属性：

```
<p>
    @Html.LabelFor(model => model.BlogId, "Blog")
    @Html.DropDownListFor(model => model.BlogId,
        (SelectList)ViewBag.Blogs, "Select blog", new { })
    @Html.ValidationMessageFor(model => model.BlogId)
</p> 
```

如果您不希望需要更改跟踪以使 EF 认识到关系已更改：

```
var db = new AppContext();
var blog = post.Blog;
post.Blog = null;

db.Posts.Attach(post);
db.Entry(post).State = EntityState.Modified;
post.Blog = blog; // EF now recognizes a change of the relationship

db.SaveChanges(); 
```

# .htaccess - 重定向网址并在地址栏上显示短网址

> ID：13293646
> 
> 赞同：0
> 
> 时间：2012-11-08T16:47:22.023
> 
> 标签：.htaccess

我已经看到很多网站都在这样做，但还没有找到解释这一点的指南。我有这个 .htaccess 代码

```
Options +FollowSymLinks  
RewriteEngine On  
RewriteRule ^users/(\d+)*$ ./profile.php?id=$1 
```

它将 site.com/user/1 重定向到 site.com/profile.php?id=1 但是当它重定向时，我希望用户在他的地址栏中看到缩短的 url (site.com/user/1)

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:52:16.090

重写是服务器的内部逻辑，即浏览器请求您在地址栏中看到的长 URL，而 HTTP 服务器将其路由到较短的 URL。如果您希望浏览器显示较短的 URL，则需要使用`Redirect`而不是`Rewrite`.

请注意，使用重定向，页面加载速度会变慢，因为服务器将重定向响应返回给浏览器，然后浏览器再次请求页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T04:11:35.610

规则的工作方式如下：

```
RewriteRule <pattern_A> <target_B> 
```

它**总是**从`<pattern_A>`to 开始 工作`<target_B>`，从不反过来，这个规则没有“链接”两个请求。此答案的[顶部](https://stackoverflow.com/a/11711948/851273)解决了“为另一个 URL 更改 URL”时发生的两种不同的事情。

您拥有的规则采用不带查询字符串的 URL，并在内部将其重写为带有查询字符串的 php 文件。浏览器没有看到这种情况发生，它在“幕后”。当您说您希望地址栏显示没有查询字符串的 URL 时，您首先会转到一些其他的 URL，并且“其他”URL 需要从外部重定向浏览器。因此，根据您已有的规则：

```
RewriteCond %{THE_REQUEST} ^[A-Z]{3,9}\ /profile\.php\?id=([^&\ ]+)
RewriteRule ^ /users/%1? [L,R=301] 
```

它与请求字符串匹配，而不是请求 URI（它在 URL 处理管道和重写引擎中发生更改），提取 ID，并使用标志*将浏览器重定向*到不带查询字符串的新 URL 。`R=301`

您确实需要更改*所有内容*，以便它们使用看起来更清晰的 URL，而不是依赖一种非常繁琐且效率低下的方式来重定向浏览器，然后在内部重写*回*原始 URL。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:50:57.747

有很多关于如何做到这一点的资料。这是我google时得到的第一个。

[http://net.tutsplus.com/tutorials/other/using-htaccess-files-for-pretty-urls/](http://net.tutsplus.com/tutorials/other/using-htaccess-files-for-pretty-urls/)

# java - 是否可以在 dwr 中使用树集？

> ID：13293651
> 
> 赞同：1
> 
> 时间：2012-11-08T16:47:39.840
> 
> 标签：java, dwr, treeset

我的问题是，我尝试使用 DWR 将 TreeSet 放入我的 Javascript 中。这是我的示例代码：

Java代码：

```
public class myDWRObject {
  public HashMap<String, Object> getData() {
    TreeSet<aComplexObject> myTreeSet = aFunctionThatReturnsThisTreeSet();
    HashMap<String, Object> myHashMap = new HashMap<String, Object>();
    myHashMap.put("MYID", myTreeSet);
    return myHashMap
  }
} 
```

控制器-servlet.xml：

```
<beans>
  <bean id="myobject" class="de.apackage.myDWRObject " scope="request">
    <dwr:remote javascript="myObject">
      <dwr:include method="getData" />
      <dwr:filter class="de.apackage.DwrControllerInitializer"/>
    </dwr:remote>
    <aop:scoped-proxy proxy-target-class="false" />
  </bean>
  <dwr:configurations>
    <dwr:create javascript="myObject" type="spring" >
      <dwr:param name="beanName" value="myobject" />
    </dwr:create>
    <dwr:convert type="object" class="java.util.TreeSet" />
    <dwr:convert type="object" class="de.apackage.aComplexObject" />
  </dwr:configurations>
</beans> 
```

模型.xml：

```
<!-- {{{ CONTROLLER: myObject-->
  <controller name="myObject">

    <!-- {{{ METHOD: getData-->
    <method name="getData" type="GET|POST" session="require" transaction="false">
      <param_validator_ref idref="configspecdata"/>
      <param_validator_ref idref="ticketdata"/>

      <state value="ANY">
        <execute/>
      </state>

    </method>
    <!-- }}} -->
  </controller>
  <!-- }}} --> 
```

在我的 HTML 文档中：

```
<script type="text/javascript">
  function getData () {
    myObject.getData(callBack);
  }
  function callBack(aData){
    alert("done");
  }
</script> 
```

现在是我的问题，我从 apache 服务器得到响应：

```
16:50:37,17  - WARN  - [main] org.springframework.beans.factory.support.DisposableBeanAdapter - Invocation of destroy method failed on bean with name 'dwrController': java.security.AccessControlException: access denied (java.lang.RuntimePermission modifyThread) 
```

我不明白我的错，你能帮帮我吗？有可能，dwr 不能与树集一起工作吗？

问候曼尼

# javascript - jQuery 移动页面显示事件未在第一个 $.mobile.changePage() 上触发

> ID：13293656
> 
> 赞同：0
> 
> 时间：2012-11-08T16:48:03.647
> 
> 标签：javascript, cordova, jquery-mobile

我正在编写一个 phonegap/jquery 移动应用程序并且有一个我似乎无法解决的问题。

当应用程序加载（设备就绪和 jqm_mobile_init）触发并且应用程序创建/打开数据库并检查用户是否登录时（只是数据库中的一个标志）。如果是这样，应用程序调用 $.mobile.changePage("#home", {transition:"none"}); 将它们重定向到“主页”页面。

然后在“主页”页面显示事件中，我从数据库中获取大量信息并将其附加到主页内的列表视图中。

但是，第一次运行（使用 $.mobile.changePage 事件）时，不会触发 pageshow 事件（因此我的数据都不会附加到列表视图）。如果我浏览应用程序然后访问该页面，则数据显示正常。这只发生在使用 $.mobile.changePage 更改到主页时。

如何让 pageshow() 在 $.mobile.changePage 上触发？还是有其他方法可以做到这一点？

这是我的代码：

```
/************************************************
Try to create/open the DB, if not catch the error
***********************************************/
try {
    if (!window.openDatabase) {
        alert('not supported');
    } else {
        var shortName = 'test';
        var version = '1.0';
        var displayName = 'test Database';
        var maxSize = 200000; // in bytes
        // database instance in db.
        var db = openDatabase(shortName, version, displayName, maxSize);

        // Create tables
        createTables(db);

        // Check if there is a signedin user
        isUserSignedInQuery(db);

    }
} catch(e) {
    // Error handling code goes here.
    if (e == 2) {
        // Version number mismatch.
        alert("Invalid database version.");
    } else {
        alert("Unknown error "+e+".");
    }
    return;
}

// Universal null/blank data handler
function nullDataHandler(transaction, results) { }

// Universal error callback
function errorHandler(error) {
    //alert("Error processing SQL: " +error.message+ " Error Code: " +error.code);
}

// Create tables if dont already exist
function createTables(db) {
    db.transaction(
        function (transaction) {

            // create tables
    }
    );
}

/**********************************************************************************************
Check if there is a signed in user, if so redirect to listings page, if not display login page
**********************************************************************************************/

function isUserSignedInQuery(db) {
    db.transaction(
        function (transaction) {
            transaction.executeSql("SELECT * FROM USERS WHERE signedIn=1;",
            [], // array of values for the ? placeholders
            isUserSignedInDataHandler, errorHandler);
        }
    );
}

function isUserSignedInDataHandler(transaction, results) {
    // Handle the results
    if (results.rows.length > 0) {
        //console.log("someones logged in!");

        // Assign signed in user to global var
        console.log("logged in user = " + results.rows.item(0).id);
        window.currentSignedInUserId = results.rows.item(0).id;

        $.mobile.changePage( "#home", { transition: "none"} );
    } else {
        $.mobile.changePage( "#login", { transition: "none"} );
    }
}

/**********************************************************************************************
Sign in page:
**********************************************************************************************/

function doesSigningInUserAlreadyExistQuery(db) {
    db.transaction(
        function (transaction) {
            transaction.executeSql("SELECT * FROM USERS WHERE username='"+usernameValue+"' ORDER BY id LIMIT 0,1;",
            [], // array of values for the ? placeholders
            doesSigningInUserAlreadyExistDataHandler, errorHandler);
        }
    );
}

function doesSigningInUserAlreadyExistDataHandler(transaction, results) {

    // User exists, sign them in.
    if (results.rows.length > 0) {

        //console.log("user exists");

        // Find number of rows
        var len = results.rows.length;
        //console.log(len);

        for (var i=0; i<len; i++){
            //console.log(results.rows.item(i));

            db.transaction(
                function (transaction) {
                    transaction.executeSql('UPDATE USERS SET signedIn = 1 WHERE username="'+usernameValue+'"');
                }               
            );

            // Assign signed in user to global var
            window.currentSignedInUserId = results.rows.item(0).id;

            // Redirect to home/listings page
            $.mobile.changePage( "#home", { transition: "slidefade"} );
        }

    // User is new, create them and sign them in
    } else {

        db.transaction(
            function (transaction) {
                transaction.executeSql('INSERT INTO USERS (username, password, userId, defaultHandler, autoSync, updateCaseTypes'
                +', updateHistorical, updateFavorite, signedIn) '
                +'VALUES ("'+usernameValue+'", "eclipse", "userid321", "Another User", 1, 1, 1, 1, 1);', [],
                function (transaction, resultSet) {
                    if (!resultSet.rowsAffected) {
                        // Previous insert failed.
                        alert('No rows affected!');
                        return false;
                    }
                    alert('insert ID was '+resultSet.insertId);

                    //Assign signed in user to global var
                    window.currentSignedInUserId = resultSet.insertId;
                });
            }               
        );

        // Redirect to home/listings page
        $.mobile.changePage( "#home", { 
            reloadPage: true,
            transition: "slidefade"} );

    }
}

$('#login').live('pageshow', function(event) {

    console.log(window.currentSignedInUserId); // This is empty - global var not working

    // Should this be tap??????? Find out. -----------
    $('a#signIn').click(function() {

        // Get values of all fields & buld vars
        var username = $('#login-username');
        var password = $('#login-password');

        // Check if fields are empty
        if( !username.val() ) {
              username.addClass('empty');
              $('label.login-username').addClass('blank');
            }
            if( !password.val() ) {
              password.addClass('empty');
              $('label.login-password').addClass('blank');
            }

            // If both not empty, check if user exists, if so sql update if not sql insert
            if (username.val() && password.val()) {

                // Get username
                usernameValue = username.val();

                // Run function
                doesSigningInUserAlreadyExistQuery(db);

            }

    });
});

$('#home').live('pageshow', function(event) {

    console.log("Page show fired on recordings page");

    db.transaction(getRecordingsQuery, getRecordingsDataHandler, errorHandler);

            // get stuff, loop through it and append

        // Refresh the list to add JQM styles etc
        $('#recordings-list').listview('refresh');

    }

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T16:31:47.467

我已经设法解决了它，它并不是一个真正的正确修复，但它的工作原理是在屏幕刷新时屏幕闪烁。

如果它对任何人有帮助，我添加了 allowSamePageTransitions: true ，它解决了这个问题（以闪烁为代价）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:16:33.610

您应该使用`on()`而不是`live()`. `live()`已被弃用。
您是否尝试过将其放入`beforepageshow`而不是`pageshow`？它似乎是放置数据收集/动态页面元素生成的更好地方。

# iphone - iPhone 应用程序在 iPad 上自动调整大小不正确

> ID：13293657
> 
> 赞同：0
> 
> 时间：2012-11-08T16:48:06.263
> 
> 标签：iphone, objective-c, ios, autoresize

我开发了 iPhone 应用程序。当我尝试在 iPad 模拟器中运行此应用程序时，它没有显示 1x/2x 缩放按钮，而是以错误的方式显示应用程序自动调整大小视图。

我不想制作 ipad 原生笔尖/视图，所以我需要禁用自动调整应用程序。

有人可以帮忙吗？

编辑：在“摘要”选项卡中，在“设备”下拉菜单中选择了“iPhone”。

EDIT2：启动应用程序时，启动屏幕在小 1x 窗口中正确加载，而不是在首次视图加载时切换到全屏。

![ipad模拟器截图](../Images/180b326fbfa31e24c3662ed05e405075.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:53:27.277

转到目标的设置，“摘要”选项卡，然后在“设备”下拉菜单中选择“iPhone”而不是“通用”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T17:06:48.020

进入你的 Application-Info.plist 并检查 iPad 是否有什么东西。在一个项目中，我开始做一个应用程序 Universal，只开发了 iPhone 主题。然后，为了向客户展示一个预版本，我在 iPad 上进行了测试，屏幕完全相反（iPhone：纵向模式，iPad 横向）。我认为在 Info.plis 中仍然有 iPad : Landscape。也许是这样的。

# c++ - C++ 理解类和构造函数

> ID：13293658
> 
> 赞同：1
> 
> 时间：2012-11-08T16:48:08.527
> 
> 标签：c++, string, class, object, text

我是 C++ 新手（来自 Java）。我在用 C++ 组合类时遇到了麻烦。

我在这个程序中的目标是简单地实现一个带有一些字符串和计数器的基本 Animal 类。

我希望能够从我创建的文本文件中读取数据，并将文本文件中的行设置为这些变量中的每一个。

物种家族门的后裔

然后我希望程序打印出所有 3 个类的结果。

我不明白如何实现默认构造函数。

这是我的课。

```
#include <iostream>
#include <string>

using namespace std;

class Animal
{
    string species;
                string family;
                string phylum;
                string desc;
                static int count;
   public:    
       bool readIn(ifstream&file, const string frame);
    void printInfo() const;
    void setAnimal(string s, string f, string p, string d);
    static int getCount();
    Animal(string s, string f, string p, string d);
    Animal(ifstream& file, const string fname);
}; 
```

这些是函数定义：

```
#include "animal.h"
#include <iostream>
#include <string>
using namespace std;

Animal::Animal(string s, string f, string p, string d)
{
        setAnimal(s,f,p,d);
}    

static int Animal::getCount()

{
    int i=0;
        i++;
        return i;
}

bool Animal::readIn(ifstream &myFile, const string fname)
{
        myFile.open(fname);
        if(myFile)
        {
                getline(myFile, species);
                getline(myFile, family);
                getline(myFile, phylum);
                getline(myFile, desc);
                myFile.close();
                return true;
        } 
        else
        return false;
}   

Animal::Animal(ifstream& file, const string fname)
{
        if(!readIn(file, fname) )
        species="ape";
        family="ape";
        phylum="ape";
        desc="ape";
        count = 1;
}   

void Animal::printInfo() const
{
cout << species << endl;
cout << family << endl;
cout << phylum << endl;
cout << desc << endl;
}

void Animal::setAnimal(string s, string f, string p, string d) 
{
        species = s, family = f, phylum = p, desc = d;
}

int main()
{
        ifstream myFile;
        Animal a;
        Animal b("homo sapien", "primate", "chordata", "erectus");
        Animal c(myFile, "horse.txt");
        a.printInfo();
        b.printInfo();
        c.printInfo();
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:57:36.080

默认构造函数是可以在不指定参数的情况下调用的构造函数。此描述可能看起来有点冗长，因此请考虑几种可能性。

通常，或者默认情况下（没有双关语），默认构造函数将只是一个不带参数的构造函数：

```
class Animal
{
public:
  Animal() {}; // This is a default constructor
}; 
```

其他时候，虽然你可能会编写一个带有参数的构造函数，但所有参数都有默认值：

```
class Animal
{
public:
  Animal(int age=42) : age_(age) {};  // This is a default constructor
private:
  int age_;
}; 
```

这也是一个默认构造函数，因为它可以不带参数调用：

```
Animal a;  // OK 
```

您不希望在一个类中有 2 个默认构造函数。也就是说，不要尝试编写这样的类：

```
class Animal
{
   public:

      Animal() {};
      Animal(int age=42) : age_(age) {}; 
    private:
      int age_;
}; 
```

在 C++ 中，如果你有一个没有默认构造函数的类，编译器会自动为你生成一个。但是，如果您自己已经声明了*任何*其他构造函数，编译器不会自动生成默认构造函数。因此，在您的情况下，由于您已经声明了 2 个其他构造函数（都是“转换”构造函数），编译器不会为您生成默认构造函数。由于定义的类没有默认构造函数，因此您不能默认构造`Animal`对象。换句话说，这不会编译：

```
Animal a; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:53:57.477

默认构造函数只是一个不带参数的构造函数。如果您没有定义自己的任何构造函数，编译器会为您生成一个。

这个自动生成的除了调用类的基类和成员的无参数构造函数之外什么都不做。

您可以自己定义无参数构造函数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:53:42.537

要实现默认构造函数，只需执行您已经完成的操作，但不提供参数：

```
static int getCount();
Animal(string s, string f, string p, string d);
Animal(ifstream& file, const string fname);
Animal(); //Default Constructor 
```

然后在您的实现中：

```
Animal::Animal(){
    species="ape";
    family="ape";
    phylum="ape";
    desc="ape";
    count = 1;
} 
```

# php - php查询字符串utf8不起作用

> ID：13293660
> 
> 赞同：1
> 
> 时间：2012-11-08T16:48:16.047
> 
> 标签：php, utf-8

我正在尝试生成一个查询字符串。该函数适用于非 utf8 字符，但 utf8 字符显示为空白。

功能

```
function qs_search($qs) {
  parse_str($_SERVER['QUERY_STRING'], $query_string);
  $query_string['search'] = basename($qs);
  return http_build_query($query_string);
} 
```

这些是结果...

qs_search('常规');

```
index.php?list&search=regular 
```

qs_search('Синодальный');

```
index.php?list&search= 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T17:03:24.770

根据评论，我仍然不知道你为什么要使用`basename`，但是，使用[`set_locale`](http://php.net/manual/en/function.setlocale.php)将在 PHP 5.2+ 中工作：

```
<?php
    function qs_search($qs) {
        $query_string = array();
        $query_string['search'] = basename($qs);
        return http_build_query($query_string);
    }
    setlocale(LC_ALL, "en_US.UTF8");
    var_dump(qs_search("regular"));
    var_dump(qs_search("Синодальный"));
?> 
```

[如前所述，这**不适**用于 PHP 5.0.0 - 5.1.6。点击查看结果。](http://3v4l.org/6XIa5)

**编辑**：

显然 Drupal 的开发人员也有同样的问题，并因为[这个 bug创建](http://drupal.org/node/278425)[了自己的`basename`函数](http://api.drupal.org/api/drupal/core%21includes%21file.inc/function/drupal_basename/8)，这应该可以解决您在 PHP 5.0.0 - 5.1.6 上的问题。

# sql - VB.Net SQL 从数据网格插入

> ID：13293662
> 
> 赞同：0
> 
> 时间：2012-11-08T16:48:22.987
> 
> 标签：sql, vb.net

我目前正在构建一个应用程序，用户将数据输入到网格中，然后将其插入到 SQl 表中。但是，我在让它插入多于顶行时遇到问题。我收到一条错误消息，指出已为该过程声明了太多参数。我试图执行一个循环，每行都发生插入。运行时插入顶行但忽略其他任何内容

```
 For i = 0 To dgvRI.Rows.Count - 1
            sqlRI.CommandText = "dbo.vb_insert"
            sqlRI.CommandType = CommandType.StoredProcedure
            sqlRI.Parameters.Add("@accid", SqlDbType.VarChar).Value = accid
            sqlRI.Parameters.Add("@rnum", SqlDbType.Int).Value = dgvRI.Rows(i).Cells(0).Value
            sqlRI.Parameters.Add("@rilim", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(1).Value
            sqlRI.Parameters.Add("@riatt", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(2).Value
            sqlRI.Parameters.Add("@rishare", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(3).Value
            sqlRI.Parameters.Add("@rname", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(4).Value
            sqlRI.Parameters.Add("@bname", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(5).Value
            sqlRI.Parameters.Add("@type", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(6).Value
            sqlRI.Parameters.Add("@cov", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(7).Value
            sqlRI.Parameters.Add("@prop", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(8).Value
            sqlRI.Parameters.Add("@loc", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(9).Value
            sqlRI.Parameters.Add("@con", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(10).Value
            sqlRI.Parameters.Add("@prem", SqlDbType.Decimal).Value = dgvRI.Rows(i).Cells(11).Value
            sqlRI.Parameters.Add("@curr", SqlDbType.VarChar).Value = dgvRI.Rows(i).Cells(12).Value
            i += sqlRI.ExecuteNonQuery()
        Next
    Catch ex As Exception
        MessageBox.Show(ex.Message)
    End Try 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:53:35.343

为每一行创建新实例，我认为您的对象每次都添加相同的参数。

```
 sqlRI = new sqlRI();//create new instance everytime
        sqlRI.CommandText = "dbo.vb_insert"
        sqlRI.CommandType = CommandType.StoredProcedure
        sqlRI.Parameters.Add("@accid", SqlDbType.VarChar).Value = accid 
```

# ruby-on-rails - 开发模式下的内部服务器错误（500），rails 中没有调试页面或日志输出：utf-8

> ID：13293669
> 
> 赞同：1
> 
> 时间：2012-11-08T16:48:53.177
> 
> 标签：ruby-on-rails, utf-8, ruby-1.9

开发模式下的 rails 应用程序会提供内部服务器错误，而不是通常的带有跟踪的错误页面。也没有任何信息`log/development.log`。不管是什么服务器。应任何要求。

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:48:53.177

ruby 1.9 下无效字符编码导致的语法错误。当ruby（和rails）在源文件中默认需要ASCII时，您很可能使用了utf-8。（是的，对吧？）

解决方案是使用 BOM [http://www.w3.org/International/questions/qa-byte-order-mark](http://www.w3.org/International/questions/qa-byte-order-mark)或把

```
# encoding: UTF-8 
```

或者

```
# coding: UTF-8 
```

在 utf-8 中的文件之上。

要`UTF-8`全局设置，你可以把

```
config.encoding = "utf-8" 
```

在你`config/application.rb`这相当于

```
Encoding.default_external = Encoding::UTF_8
Encoding.default_internal = Encoding::UTF_8 
```

这又相当于把：

```
# encoding: UTF-8 
```

或每个文件顶部的 BOM。

这允许在 rails 应用程序的所有文件上全局使用 utf-8。

如果您想在所有 ruby​​ 文件上使用全局选项，可以使用`-E`or `-K`ruby​​ 选项并通过`RUBYOPT`环境变量进行设置，例如：

```
export RUBYOPT=-Ku 
```

或者

```
export RUBYOPT='-E utf-8:utf-8' 
```

见[http://www.manpagez.com/man/1/ruby/](http://www.manpagez.com/man/1/ruby/) 见[http://zargony.com/2009/07/24/ruby-1-9-and-file-encodings](http://zargony.com/2009/07/24/ruby-1-9-and-file-encodings)

还有一个 gem 可以在 Rails 项目中需要它的每个文件的顶部设置魔术注释：h [ttps://github.com/m-ryan/magic_encoding](https://github.com/m-ryan/magic_encoding)

# android - BaseAdapter 未填充列表视图

> ID：13293678
> 
> 赞同：0
> 
> 时间：2012-11-08T16:49:07.993
> 
> 标签：android, listview, listadapter, baseadapter

所以我有一个我构建的基本适配器类。我也尝试在我的一项活动中使用它。我有一个用于父布局的 xml 和一个用于扩展行的 xml。但是，这些组件并没有链接在一起。应用程序不会崩溃，但行不会膨胀（尽管父 xml 文件仍显示在屏幕上）。有人可以看看我的代码并告诉我我忽略了哪些关键组件吗？我只会发布相关代码。由于没有发生错误，因此无法发布错误日志。非常感谢

父 XML (nearby_places_list)

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:padding="10dp"
    android:orientation="vertical"
    android:background="@drawable/bg">

   <Button
    android:id="@+id/continuetomap"
    android:layout_height="100dp"
    android:layout_width="match_parent"
    android:background="@drawable/map_continue"
    />

   <ListView
       android:id="@+id/list_view_nearby"
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"
       android:divider="#b5b5b5"
       android:listSelector="@drawable/list_selector">
   </ListView>

</LinearLayout> 
```

扩展 XML 的行 (nearby_list_row)

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:padding="5dp"
        android:orientation="vertical"
        android:background="@drawable/list_selector">"

        <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:orientation="horizontal"
        android:background="@drawable/list_selector">

            <LinearLayout
            android:layout_width="0dp"
            android:layout_weight="3"
            android:layout_height="wrap_content"
            android:orientation="vertical"
            android:background="@drawable/list_selector">
                <TextView
                    android:id= "@+id/name"        
                    android:textSize="20dp" 
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="name"
                    android:textColor="#54944d"/>
                 <TextView
                    android:id= "@+id/vicinity"        
                    android:textSize="20dp" 
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="vicinity"
                    android:textColor="#000000"/>
                  <TextView
                    android:id= "@+id/openorclosed"
                    android:textSize="20dp"
                    android:layout_width="fill_parent"
                    android:layout_height="wrap_content"
                    android:text="Open"
                    android:textColor="#000000"
                    android:textStyle="bold"/>    
                    </LinearLayout>

            <RelativeLayout
                android:layout_width="0dp"
                android:layout_height="wrap_content"
                android:layout_weight="0.74" >

                 <Button
                android:layout_width="60dp"
                android:id="@+id/button_add_to_fav"
                android:background="@drawable/add_square"
                android:layout_height="60dp"
                android:layout_alignParentRight="true"
                />

               <Button
                android:layout_width="60dp"
                android:id="@+id/button_call_rest"
                android:background="@drawable/add_square"
                android:layout_height="60dp"
                android:layout_alignParentRight="true"
                android:layout_below="@+id/button_add_to_fav"
                />

            </RelativeLayout>

          </LinearLayout>

    </RelativeLayout> 
```

基本适配器类

```
public class AdapterForList extends BaseAdapter {

    private final Context context;
    private final ArrayList<HashMap<String, String>> alHm;
    private final String TAG_A;
    private final String TAG_B;
    private final String TAG_C;

    public AdapterForList(Context context, ArrayList<HashMap<String, String>> alhm, String TAG_1, String TAG_2, String TAG_3) {
        super();
        this.context = context;
        this.alHm = alhm;
        TAG_A = TAG_1;
        TAG_B = TAG_2;
        TAG_C = TAG_3;
    }

    @Override
    public View getView(int position, View convertView , ViewGroup parent){
        LayoutInflater inflator = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);

        convertView = inflator.inflate(R.layout.nearby_list_row, parent, false);
        TextView tv1 = (TextView) convertView.findViewById(R.id.name);
        TextView tv2 = (TextView) convertView.findViewById(R.id.vicinity);
        TextView tv3 = (TextView) convertView.findViewById(R.id.openorclosed);
        Button btnAdd= (Button) convertView.findViewById(R.id.button_add_to_fav);
        Button btnCall= (Button) convertView.findViewById(R.id.button_call_rest);

        if (alHm.get(position).containsKey(TAG_A)){  // get the value from the key (if it exist) and set the first text view to it 
            String value = alHm.get(position).get(TAG_A);
            tv1.setText(value);;
        }

        if (alHm.get(position).containsKey(TAG_B)){   
            String value = alHm.get(position).get(TAG_B);
            tv2.setText(value);;
        }

        if (alHm.get(position).containsKey(TAG_C)){  // get the value from the key (if it exist) and set the first text view to it 
            String value = alHm.get(position).get(TAG_C);
            tv3.setText(value);;
        }

        return convertView;
    }
    @Override
    public int getCount() {
        // TODO Auto-generated method stub
        return alHm.size();
    }
    @Override
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return position;
    }
    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return position;
    }

} 
```

相关活动代码

```
protected void onPostExecute(Boolean result){
    if (result){
        // adding data to listview
        final ListView lv = (ListView) findViewById(R.id.list_view_nearby);
        lv.setAdapter(new AdapterForList(context, listOfHM, JSONextractor.TAG_NAME,   
            JSONextractor.TAG_VICINITY,  JSONextractor.TAG_OPERATINGHOURS_OPENNOW));

        //more code ...

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:47:06.257

所以事实证明我的代码确实有效（但不是最佳的）。我在下面发布了如何正确使用基本适配器

刚刚阅读了 savadow 提出的文章（真的让我大开眼界）。基本上我的 BaseAdapter 没有利用类的任何优化能力。相反，我将在基础适配器类中将代码更改为以下代码。

[http://lucasr.org/2012/04/05/performance-tips-for-androids-listview/](http://lucasr.org/2012/04/05/performance-tips-for-androids-listview/)

```
public View getView(int position, View convertView , ViewGroup parent){
        LayoutInflater inflator = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
        if (convertView == null){  
        convertView = inflator.inflate(R.layout.nearby_list_row, parent, false);
        }
        // now if the convertView is not null i simply update the values rather than re-inflate the view (inflating is expensive)

        tv1 = (TextView) convertView.findViewById(R.id.name);
        tv2 = (TextView) convertView.findViewById(R.id.vicinity);
        tv3 = (TextView) convertView.findViewById(R.id.openorclosed);
        btnAdd= (Button) convertView.findViewById(R.id.button_add_to_fav);
        btnCall= (Button) convertView.findViewById(R.id.button_call_rest); 
```

# python - PyYAML，如何对齐地图条目？

> ID：13293680
> 
> 赞同：8
> 
> 时间：2012-11-08T16:49:12.240
> 
> 标签：python, yaml, pyyaml

我使用 PyYAML 将 python 字典输出为 YAML 格式：

```
import yaml
d = { 'bar': { 'foo': 'hello', 'supercalifragilisticexpialidocious': 'world' } }
print yaml.dump(d, default_flow_style=False) 
```

输出是：

```
bar:
  foo: hello
  supercalifragilisticexpialidocious: world 
```

但我想：

```
bar:
  foo                                : hello
  supercalifragilisticexpialidocious : world 
```

有没有解决这个问题的简单方法，即使是次优的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-09T18:31:13.373

好的，这就是我到目前为止的想法。

我的解决方案包括两个步骤。第一步定义了一个字典表示器，用于向键添加尾随空格。通过这一步，我在输出中获得了带引号的键。这就是为什么我添加第二步来删除所有这些引号：

```
import yaml
d = {'bar': {'foo': 'hello', 'supercalifragilisticexpialidocious': 'world'}}

# FIRST STEP:
#   Define a PyYAML dict representer for adding trailing spaces to keys

def dict_representer(dumper, data):
    keyWidth = max(len(k) for k in data)
    aligned = {k+' '*(keyWidth-len(k)):v for k,v in data.items()}
    return dumper.represent_mapping('tag:yaml.org,2002:map', aligned)

yaml.add_representer(dict, dict_representer)

# SECOND STEP:
#   Remove quotes in the rendered string

print(yaml.dump(d, default_flow_style=False).replace('\'', '')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-23T08:16:42.790

我为 JavaScript 找到了[https://github.com/jonschlinkert/align-yaml](https://github.com/jonschlinkert/align-yaml)并将其翻译为 Python

[https://github.com/eevleevs/align-yaml-python](https://github.com/eevleevs/align-yaml-python)

它不使用 PyYAML，直接将其应用于 YAML 输出，无需解析。

以下函数的副本：

```
import re

def align_yaml(str, pad=0):
    props = re.findall(r'^\s*[\S]+:', str, re.MULTILINE)
    longest = max([len(i) for i in props]) + pad
    return ''.join([i+'\n' for i in map(lambda str:
            re.sub(r'^(\s*.+?[^:#]: )\s*(.*)', lambda m:
                    m.group(1) + ''.ljust(longest - len(m.group(1)) + 1) + m.group(2),
                str, re.MULTILINE)
        , str.split('\n'))]) 
```

# .net - 如何查看性能计数器数据？

> ID：13293683
> 
> 赞同：2
> 
> 时间：2012-11-08T16:49:21.320
> 
> 标签：.net, performancecounter

我创建了几个性能计数器来计算对第三方 Web 服务的请求以及这些 Web 服务报告的错误数。

我在我的 asp.net 代码中正确地增加了这些性能计数器，我可以在我的 Visual Studio Server Explorer 中看到这些计数器。

我可以看到这些列在我的 perfmon 中，但不确定如何准确查看当前计数？

手动查看这些并以编程方式将它们下载到数据库中的最佳方法是什么？

# android - Android中的指南针

> ID：13293687
> 
> 赞同：14
> 
> 时间：2012-11-08T16:49:40.440
> 
> 标签：android, android-sensors

我正在尝试使用加速度计和磁场传感器对 Android 指南针进行编程，现在我想知道如何为我的指南针获取正确的角度。

我分别在“加速度”和“磁力”中读取加速度计和磁场传感器的值。为了获得角度，我执行以下操作：

```
float R[] = new float[9];
float I[] = new float[9];
boolean success = SensorManager.getRotationMatrix(R, I, accele, magne);
        if(success) {
            float orientation[] = new float[3];
            SensorManager.getOrientation(R, orientation);
            azimuth = orientation[0]; // contains azimuth, pitch, roll
                            .... 
```

稍后，我使用旋转矩阵来放置我的针：

```
rotation.setRotate(azimuth, compass.getWidth() / 2, compass.getHeight() / 2);
canvas.drawBitmap(needle, rotation, null); 
```

现在，getOrientation 的文档说，orientation[0] 应该是围绕 z 轴的旋转。TYPE_ORIENTATION 的文档指出“方位角，磁北方向和 y 轴之间的角度，围绕 z 轴（0 到 359）。0=北，90=东，180=南，270=西”。

然而，我的方位角不在 0 到 359 之间，而是在 -2 到 2 之间。getOrientation 的方位角到底是什么？如何将其转换为角度？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-08T17:21:46.643

使用以下以弧度 (-PI, +PI) 为单位的给定方位角转换为度数 (0, 360)

```
float azimuthInRadians = orientation[0];
float azimuthInDegress = (float)Math.toDegrees(azimuthInRadians);
if (azimuthInDegress < 0.0f) {
    azimuthInDegress += 360.0f;
} 
```

为方便起见使用的变量名 ;-)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-07T09:59:49.097

可以从[https://github.com/iutinvg/compass获取代码片段](https://github.com/iutinvg/compass)

它不使用过时的东西，应用低通滤波器。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T16:56:43.730

我在谷歌的 ApiDemos 中找到了这个：

```
 /*
 * Copyright (C) 2007 The Android Open Source Project
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package com.example.android.apis.graphics;

import android.app.Activity;
import android.content.Context;
import android.graphics.*;
import android.hardware.SensorListener;
import android.hardware.SensorManager;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.os.SystemClock;
import android.util.Config;
import android.util.Log;
import android.view.View;

public class Compass extends GraphicsActivity {

    private static final String TAG = "Compass";

    private SensorManager mSensorManager;
    private SampleView mView;
    private float[] mValues;

    private final SensorListener mListener = new SensorListener() {

        public void onSensorChanged(int sensor, float[] values) {
            if (Config.LOGD) Log.d(TAG, "sensorChanged (" + values[0] + ", " + values[1] + ", " + values[2] + ")");
            mValues = values;
            if (mView != null) {
                mView.invalidate();
            }
        }

        public void onAccuracyChanged(int sensor, int accuracy) {
            // TODO Auto-generated method stub

        }
    };

    @Override
    protected void onCreate(Bundle icicle) {
        super.onCreate(icicle);
        mSensorManager = (SensorManager)getSystemService(Context.SENSOR_SERVICE);
        mView = new SampleView(this);
        setContentView(mView);
    }

    @Override
    protected void onResume()
    {
        if (Config.LOGD) Log.d(TAG, "onResume");
        super.onResume();
        mSensorManager.registerListener(mListener, 
                SensorManager.SENSOR_ORIENTATION,
                SensorManager.SENSOR_DELAY_GAME);
    }

    @Override
    protected void onStop()
    {
        if (Config.LOGD) Log.d(TAG, "onStop");
        mSensorManager.unregisterListener(mListener);
        super.onStop();
    }

    private class SampleView extends View {
        private Paint   mPaint = new Paint();
        private Path    mPath = new Path();
        private boolean mAnimate;
        private long    mNextTime;

        public SampleView(Context context) {
            super(context);

            // Construct a wedge-shaped path
            mPath.moveTo(0, -50);
            mPath.lineTo(-20, 60);
            mPath.lineTo(0, 50);
            mPath.lineTo(20, 60);
            mPath.close();
        }

        @Override protected void onDraw(Canvas canvas) {
            Paint paint = mPaint;

            canvas.drawColor(Color.WHITE);

            paint.setAntiAlias(true);
            paint.setColor(Color.BLACK);
            paint.setStyle(Paint.Style.FILL);

            int w = canvas.getWidth();
            int h = canvas.getHeight();
            int cx = w / 2;
            int cy = h / 2;

            canvas.translate(cx, cy);
            if (mValues != null) {            
                canvas.rotate(-mValues[0]);
            }
            canvas.drawPath(mPath, mPaint);
        }

        @Override
        protected void onAttachedToWindow() {
            mAnimate = true;
            super.onAttachedToWindow();
        }

        @Override
        protected void onDetachedFromWindow() {
            mAnimate = false;
            super.onDetachedFromWindow();
        }
    }
} 
```

如您所见，您确实获得了 0 到 360 之间的度数

# html - 移动网站上的希伯来语

> ID：13293689
> 
> 赞同：0
> 
> 时间：2012-11-08T16:49:44.957
> 
> 标签：html, utf-8, hebrew

我正在尝试为移动设备构建一个基本网页，在我的电脑 Chrome 浏览器上，我看到“???? ?????? ???” 希伯来文所写的每一个地方。这是我的代码：

```
<?php

?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="he">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="Content-Language" content="he" />
    <meta name="GENERATOR" content="PHPEclipse 1.2.0" />
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
    <link rel="stylesheet" href="css/themes/light_blue.css" />
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile.structure-1.2.0.min.css" />
    <title>מניין</title>
</head>
<body>
    <div id="wraper" data-role="header">בדיקה בדיקה הדיקה</div>
</body>
</html> 
```

我正在使用 Eclipse IDE 进行开发。关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:52:22.817

删除`; charset=UTF-8` 和添加`<meta charset="iso-8859-8">`里面的文档`<head>`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:53:03.550

你用什么浏览器？

在 Chrome 上效果很好

# python - 从两个进程访问 ZODB

> ID：13293690
> 
> 赞同：2
> 
> 时间：2012-11-08T16:49:45.500
> 
> 标签：python, pyramid, zodb

我有一个站点，每次在服务器运行时尝试打开数据库时，它都会显示一个错误，即数据库已由不同的进程打开。

问题是我有一些脚本可以用 cron 安排来检查数据库，甚至只是`pshell`在服务器运行时使用。

到目前为止，似乎不可能从不同的进程打开数据库，而文档实际上说可以有多个连接到数据库。

这个问题迫使我一次只运行一个脚本/进程，包括服务器。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:53:44.860

ZODB 在其默认配置中是一个进程内对象数据库。但是，您可以使用客户端-服务器模型跨进程共享它。

您在这里有 3 个选项：

*   使用[ZEO](https://pypi.org/project/ZEO/)创建一个专用进程来共享 ZODB 存储。[*曾经有一个关于将 ZODB 与 ZEO*](https://github.com/Pylons/pyramid_cookbook/blob/3f900753f5d8efa7433b09f17a5c28d949ee324c/database/zodb_zeo.rst)与 Pyramid 特定说明一起使用的 Pyramid 食谱条目，但请考虑到它已于[2013 年 12 月](https://github.com/Pylons/pyramid_cookbook/commit/7a5573f71e2360100c4902f5ddc9718dbbe2acbe#diff-11e0eed8d3696c0a632f822df385ab3c)因过时而被删除。对我来说，这些说明看起来仍然相当准确，但我还没有测试过它们。
*   使用[RelStorage](http://pypi.python.org/pypi/RelStorage)将对象数据库存储在 Oracle、MySQL 或 PostgeSQL 中。
*   使用[NEO](https://neo.nexedi.com/)将 MySQL 用作分布式后端。警告：该平台（尚未）与 Python 3 兼容，但该项目正在积极开发中（截至 2018 年 11 月），因此可能会出现这种情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T12:47:36.740

您可以使用 RelStorage。

```
pip install RelStorage 
```

...或添加到 setup.py 需要：

```
requires = [
...
RelStorage',
] 
```

在 [app:main] 部分更改 developer.ini：

```
[app:main]
...
zodbconn.uri = zconfig://%(here)s/relstorage.conf 
```

使用以下内容创建文件“relstorage.conf”：

```
%import relstorage
<zodb main>
  <relstorage>
    <postgresql>
      # The dsn is optional, as are each of the parameters in the dsn.
      dsn dbname='zodb' user='zodbuser' host='yourhostname.net' password='YOURpassowrd'
    </postgresql>
  </relstorage>
</zodb> 
```

根据设置，“relstorage.conf”必须与“developer.ini”放在同一文件夹中

# pydev - 如何参考外部资源？

> ID：13293695
> 
> 赞同：0
> 
> 时间：2012-11-08T16:50:05.460
> 
> 标签：pydev

我正在将 Eclipse Juno 与 Pydev 2.7.1 一起使用，但我想导入一个外部文件夹，以便直接从 Eclipse 的编辑器（并且相互）修改其内容。

这真的不可能吗？

我看过[这个 stackoverflow 帖子](https://stackoverflow.com/questions/7394031/how-do-you-create-a-pydev-project-from-existing-code)，但它确实说明了如何将外部文件添加到 PYTHONPATH。我还发现[了这个 stackoverflow 帖子](https://stackoverflow.com/questions/12519327/how-to-define-an-external-source-folder-in-pydevproject)：但我仍然无法编辑外部文件 :(

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T23:50:11.813

好的，我找到了。

在官方常见问题解答中找到：[如何导入现有项目](http://pydev.org/faq.html#PyDevFAQ-HowdoIimportexistingprojects/sourcesintoPyDev?)（选项 1）

1.  创建一个新的 PyDev 项目
2.  表示您不需要新项目的默认文件夹（请参阅屏幕截图）。
3.  选择您需要直接从 Eclipse 编辑器修改的源所在的目录（参见屏幕截图）。

![选择原始文件夹](../Images/309cdb40cf83a7eacf77c96a6a6d6a77.png)

# google-drive-api - Google Drive API Upload 返回文件 ID/标题，但文件在 Drive 中不存在

> ID：13293698
> 
> 赞同：3
> 
> 时间：2012-11-08T16:50:15.833
> 
> 标签：google-drive-api

我已经按照 Google Drive SDK 站点上给出的示例进行了通过服务帐户进行授权（https://developers.google.com/drive/service-accounts）并插入文件（https://developers.google.com/驱动器/v2/参考/文件/插入）。我已经设法使用带有 oauth2 的客户端 ID/客户端密码使其工作，但需要自动化，所以想使用私钥。

我的问题是我得到一个文件 ID、标题、描述和 MIME 类型作为回报，例如文件 ID：%s0B6ysbMIcH3AGWHJPRmZUTVZZZMnM，标题：我的文档，描述：测试文档，MIME 类型：文本/纯文本，但文档不存在在驱动器中，没有返回错误。

我已经为此工作了 2 天，但没有成功，非常感谢任何帮助。我在网上查了一下，发现的例子和下面类似。我尝试了多个 Google 帐户（一个是公司 Google Apps，另一个是具有相同结果的普通 gmail 帐户）。

代码（更改了帐户信息）：

```
public class AutoGoogleDrive {

private static final String SERVICE_ACCOUNT_PKCS12_FILE_PATH = "/home/jsmith/Java/11111111111111111111111111-privatekey.p12";
private static final String SERVICE_ACCOUNT_EMAIL = "1111111111111@developer.gserviceaccount.com";

public static Drive getDriveService() throws GeneralSecurityException,
IOException, URISyntaxException {
HttpTransport httpTransport = new NetHttpTransport();
JacksonFactory jsonFactory = new JacksonFactory();
GoogleCredential credential = new GoogleCredential.Builder()
  .setTransport(httpTransport)
  .setJsonFactory(jsonFactory)
  .setServiceAccountId(SERVICE_ACCOUNT_EMAIL)
  .setServiceAccountScopes(DriveScopes.DRIVE_FILE)
  .setServiceAccountPrivateKeyFromP12File(
      new java.io.File(SERVICE_ACCOUNT_PKCS12_FILE_PATH))
  .build();
 Drive service = new Drive.Builder(httpTransport, jsonFactory, null)
  .setHttpRequestInitializer(credential).build();
 return service;
}

public static void main(String[] args) throws IOException {

    Drive service = null;
    try {
        service = getDriveService();
    } catch (GeneralSecurityException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (URISyntaxException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

//Insert a text file  
File body = new File();
body.setTitle("My document");
body.setDescription("A test document");
body.setMimeType("text/plain");

// File's content.
java.io.File fileContent = new java.io.File("/home/jsmith/document.txt");
FileContent mediaContent = new FileContent("text/plain", fileContent);
try {
  File file = service.files().insert(body, mediaContent).execute();

  // Uncomment the following line to print the File ID.
   System.out.println("File ID: %s" + file.getId());
  System.out.println("Title: " + file.getTitle());
   System.out.println("Description: " + file.getDescription());
   System.out.println("MIME type: " + file.getMimeType());

} catch (IOException e) {
  System.out.println("An error occured: " + e); 
} 

}
} 
```

谢谢，

乔·史密斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T18:29:28.837

使用服务帐户时，插入的文件将添加到没有 Drive UI 的应用程序的 Drive 帐户中。这些文件只能通过 API 获得。

# python - 如何在 python 中使用联合？

> ID：13293703
> 
> 赞同：10
> 
> 时间：2012-11-08T16:50:37.363
> 
> 标签：python, union, ctypes

我刚刚开始使用python，我想知道我应该如何用python定义联合（使用ctypes）？希望我是对的，通过 ctypes 支持工会。例如下面的 c 代码在 python 中是如何的

```
struct test
{
char something[10];
int status;
};

struct test2
{
char else[10];
int status;
int alive;
};

union tests
{
struct test a;
struct test2 b;
};

struct tester
{
char more_chars[20];
int magic;
union tests f;
}; 
```

Thx，如果其他人正在寻找相同的答案，则添加简单示例

```
from ctypes import *

class POINT(Structure):
    _fields_ = [("x", c_int),
                 ("y", c_int)]

class POINT_1(Structure):
    _fields_ = [("x", c_int),
                 ("y", c_int),
                 ("z",c_int)]

class POINT_UNION(Union):
    _fields_ = [("a", POINT),
                 ("b", POINT_1)]

class TEST(Structure):
    _fields_ = [("magic", c_int),
                 ("my_union", POINT_UNION)]

testing = TEST()
testing.magic = 10;
testing.my_union.b.x=100
testing.my_union.b.y=200
testing.my_union.b.z=300 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T16:57:40.280

看看[`ctypes`教程](http://python.net/crew/theller/ctypes/tutorial.html#structures-and-unions)。你使用这个`ctypes.Union`类：

```
class test(ctypes.Structure):
    # ...
class test2(ctypes.Structure):
    # ...

class tests(ctypes.Union):
    _fields_ = [("a", test),
                ("b", test2)] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:56:09.393

只需创建一个继承自`ctypes.Union`. [在此处](http://docs.python.org/2/library/ctypes.html#structures-and-unions)阅读更多相关信息。

`_fields_`然后在类成员中定义联合字段。

# mongodb - 在 mongo 封顶集合上设置最大值

> ID：13293704
> 
> 赞同：9
> 
> 时间：2012-11-08T16:50:43.917
> 
> 标签：mongodb

我有一个现有的集合，我需要使用列出的方法将其转换为[Capped Collection ：](http://www.mongodb.org/display/DOCS/Capped+Collections)

```
> db.runCommand({"convertToCapped": "mycoll", size: 100000}); 
```

但是，不接受 max 字段作为参数

```
> db.mycol1.convertToCapped
function (bytes) {
    if (!bytes) {
        throw "have to specify # of bytes";
    }
    return this._dbCommand({convertToCapped: this._shortName, size: bytes});
} 
```

知道如何设置吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-08T18:30:07.450

max 只是 createCollection 方法中的一个选项，而不是 convertToCapped：

```
db.createCollection("mycoll", {capped:true, size:100000, max:100}); 
```

有一个 cloneCollectionAsCapped，但它看起来也没有一个 max doc 选项：[http ://docs.mongodb.org/manual/reference/command/cloneCollectionAsCapped/](http://docs.mongodb.org/manual/reference/command/cloneCollectionAsCapped/)

您可能需要使用 max 参数创建一个新的上限集合，并从现有集合中传输数据和索引。请参阅[http://learnmongo.com/posts/easily-move-documents-between-collections-or-databases/](http://learnmongo.com/posts/easily-move-documents-between-collections-or-databases/)

# java - 从 AKKA 发送非阻塞 http 请求的 Java 示例

> ID：13293707
> 
> 赞同：4
> 
> 时间：2012-11-08T16:50:52.980
> 
> 标签：java, akka

在 AKKA 文档中写道

> ...参与者不应阻塞（即在占用线程时被动等待）某些外部实体，可能是锁、网络套接字等。阻塞操作应该在一些特殊情况下的线程中完成，该线程将消息发送到对他们采取行动的行动者。 *来源[http://doc.akka.io/docs/akka/2.0/general/actor-systems.html#Actor_Best_Practices](http://doc.akka.io/docs/akka/2.0/general/actor-systems.html#Actor_Best_Practices)*

目前我发现了以下信息：

1.  我阅读[了从 Akka / Scala 发送出站 HTTP 请求](https://stackoverflow.com/questions/5432982/sending-outbound-http-request-from-akka-scala/5443161#5443161)并检查了[https://github.com/dsciamma/fbgl1上的示例](https://github.com/dsciamma/fbgl1)

2.  我发现以下文章[http://nurkiewicz.blogspot.de/2012/11/non-blocking-io-discovering-akka.html](http://nurkiewicz.blogspot.de/2012/11/non-blocking-io-discovering-akka.html)解释了如何使用[https://github.com/AsyncHttpClient/async-http-client](https://github.com/AsyncHttpClient/async-http-client)非阻塞带有 akka 的 http 客户端。但是是用 Scala 编写的。

我如何编写一个发出非阻塞 http 请求的演员？

它必须将远程 url 页面下载为文件，然后将生成的文件对象发送给主参与者。然后主actor将此请求发送到解析器actor以解析文件......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-21T19:04:54.107

在最后一个回复中，Koray 使用了错误的发件人参考，正确的做法是：

```
public class ReduceActor extends UntypedActor {

@Override
public void onReceive(Object message) throws Exception {
    if (message instanceof URI) {
        URI url = (URI) message;

        AsyncHttpClient asyncHttpClient = new AsyncHttpClient();
        final ActorRef sender = getSender();
        asyncHttpClient.prepareGet(url.toURL().toString()).execute(new AsyncCompletionHandler<Response>() {

            @Override
            public Response onCompleted(Response response) throws Exception {
                File f = new File("e:/tmp/crawler/" + UUID.randomUUID().toString() + ".html");
                // Do something with the Response
                // ...
                // System.out.println(response1.getStatusLine());
                FileOutputStream fao = new FileOutputStream(f);
                IOUtils.copy(response.getResponseBodyAsStream(), fao);
                System.out.println("File downloaded " + f);
                sender.tell(new WordCount(f));
                return response;
            }

            @Override
            public void onThrowable(Throwable t) {
                // Something wrong happened.
            }
        });
    } else
        unhandled(message);
  } 
```

查看akka的另一个线程：[https ://stackoverflow.com/a/11899690/575746](https://stackoverflow.com/a/11899690/575746)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T20:26:23.007

我已经以这种方式实现了这一点。

```
public class ReduceActor extends UntypedActor {
@Override
public void onReceive(Object message) throws Exception {
    if (message instanceof URI) {
        URI url = (URI) message;

        AsyncHttpClient asyncHttpClient = new AsyncHttpClient();

        asyncHttpClient.prepareGet(url.toURL().toString()).execute(new AsyncCompletionHandler<Response>() {

            @Override
            public Response onCompleted(Response response) throws Exception {
                File f = new File("e:/tmp/crawler/" + UUID.randomUUID().toString() + ".html");
                // Do something with the Response
                // ...
                // System.out.println(response1.getStatusLine());
                FileOutputStream fao = new FileOutputStream(f);
                IOUtils.copy(response.getResponseBodyAsStream(), fao);
                System.out.println("File downloaded " + f);
                getSender().tell(new WordCount(f));
                return response;
            }

            @Override
            public void onThrowable(Throwable t) {
                // Something wrong happened.
            }
        });
    } else
        unhandled(message);
} 
```

# jquery - jQuery 触发器返回延迟

> ID：13293709
> 
> 赞同：2
> 
> 时间：2012-11-08T16:50:55.627
> 
> 标签：jquery, plugins, triggers, deferred

我正在尝试触发自定义事件，该事件将延迟返回。

我在插件内部使用触发器，所以我不能只是这样做`this.options.beforeOpen().done()`......因为在这种情况下`beforeOpen()`，客户端内部`$(this)`将返回选项对象。

```
$me.trigger('beforeOpen').
                        done(function(){
                            me._open();
                        })
                        .fail(function(){
                            me.state = 'closed';
                            $me.trigger('ifNotOpened.' + me.name);
                            $me.trigger('ifOpenedOrNot.' + me.name);
                        }) 
```

在我的自定义事件中

```
$me.on( 'beforeOpen', function() {
                        var d = $.Deferred();
                        setTimeout(function(){ d.resolve() },1000);
                        return d.promise();
                    }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-09T08:23:01.190

我意识到如何做到这一点：

```
var deferred = me.options.beforeOpen.call( $me );
    deferred
        .done(function(){...})
        .fail(function(){...}) 
```

希望这会帮助某人。

# c - 将 HTTP GET 响应与传入文件分开

> ID：13293713
> 
> 赞同：2
> 
> 时间：2012-11-08T16:51:00.467
> 
> 标签：c, http, sockets, get, response

我正在开发一个使用套接字通过 HTTP GET 请求检索文件的 C 程序。我使用该`recv`函数写入缓冲区，然后将缓冲区的内容附加到一个新文件中。该程序运行良好，除了一个问题：每个文件的顶部都包含 HTTP 响应。

例如，我可以使用我的程序从网上成功下载并打开一个 PDF 文件，并且它会毫无问题地打开。但是，如果我在 Notepad++ 中编辑 PDF，我会在顶部看到以下内容：

```
HTTP/1.1 200 OK
Date: Wed, 07 Nov 2012 19:57:54 GMT
Server: Apache/2.2.21 (Unix) mod_python/3.3.1 Python/2.6.6 PHP/5.3.8
Last-Modified: Wed, 01 Aug 2012 21:31:31 GMT
ETag: "f2ae8c-4134aa-4c63b04c07df2"
Accept-Ranges: bytes
Content-Length: 4273322
Content-Type: application/pdf

%PDF-1.4
%äðíø
10 0 obj
<</Filter/FlateDecode/Length 2722>>
... 
```

如果我使用浏览器下载 PDF 文件，则文件匹配，但我的程序检索到的文件顶部的 HTML 响应除外。我已经通过删除有问题的行并比较文件哈希来验证这一点。

我觉得有更优雅和正确的方法来解决这个问题。我知道在文件开始之前 HTTP 响应之后总是有两个换行符，所以这是我（草率，不工作）尝试提取响应：

```
FILE* ptr_file = fopen("PDF_TEST.pdf", "w+");
char* buffer[BUFFER_SIZE];
int file_pos   = 0;
int bytes_rcvd = 0;
int first_iter = 1;

while((bytes_rcvd = recv(socket_server, buffer, BUFFER_SIZE, 0)) > 0)
{
    if(first_iter)
    {// Need to remove the HTTP response from the buffer
        char* str_buffer;
        char* html_resp = strstr(buffer, "\n\n");
        int   html_resp_length = strlen(html_resp) + 2;
        printf("HTML RESPONSE:\n%s\n\n", html_resp);
        char* first_buffer[BUFFER_SIZE - html_resp_length];
        memcpy(first_buffer, buffer+html_resp_length-1, sizeof(first_buffer));
        printf("\n\nREST OF BUFFER:%s\n", first_buffer);
        bytes_rcvd -= html_resp_length;
        fwrite(first_buffer, 1, bytes_rcvd, ptr_file);
        first_iter = 0;
        continue;
    }           
    fwrite(buffer, 1, bytes_rcvd, ptr_file); 
    file_pos += bytes_rcvd;
} 
```

我在这段代码中遇到了分段错误，但我相信这是因为我的缓冲区是一个数组，`char*`并且我正在使用它，就好像它在`char`数组中一样。

我的问题：
1.) 将 HTTP 响应与文件分开的最佳方法是什么？
2.）使用`Content-Length`HTML响应指定的写入文件更好，还是应该使用我当前的方法来写入接收到的字节数？

任何输入表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T16:54:15.060

一种方法是有两个循环：第一个循环用于响应标头，读取直到得到一个空行。数据的第二个接收循环。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T18:50:15.127

我认为您在`str*`函数调用时遇到了麻烦，因为您假设缓冲区是空终止的。您可以接收`BUFFER_SIZE - 1`字节，然后`buffer[bytes_recvd] = '\0'`在进行测试之前进行设置。

此外，正如其他人指出的那样，您需要寻找`"\r\n\r\n"`而不是`"\n\n"`作为标题的终止。

小心处理 CR LF CR LF 序列跨越两个不同的 recv() 调用的情况。一种可能的解决方法是将 的最后三个字节复制`buffer`到 的开头`buffer`，并让您的下一次读取从 开始`&buffer[3]`。

# php - Ubuntu和apache服务器中特定文件夹的php奇怪行为

> ID：13293714
> 
> 赞同：3
> 
> 时间：2012-11-08T16:51:01.543
> 
> 标签：php, linux, apache, file, ubuntu

我刚刚移植了允许文件上传的网站服务器。现在它在 ubuntu 11.04 上运行 vps。上传的文件存储在具有所有者：root 和组：root 的文件夹调用文件中，与其他文件夹类似。

但问题是当我尝试运行 php 函数（readfile（））从文件夹中读取任何文件时，它没有读取该文件，但是当我将文件夹所有者和组更改为 10000 和 1005 时，与在以前的服务器中。PHP 立即找到该文件并开始下载。我无法猜测是什么问题以及这是如何发生的。因为我尝试将文件及其内容组和所有者更改为 root。

谁能描述这是如何发生的，以及如何将其更改为我自己的组或所有者。而且我的 VPS 中目前没有名为 10000 和 1005 的组和所有者。

它是在服务器上完成的某种错误或黑客行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T17:01:34.143

在 ubuntu apache 上的用户是`www-data`.

在您的第一个场景中，apache 没有正确的访问权限。以 /var/www 目录的 12.04 默认权限为例

`-rw-r--r-- 1 root root 177 Sep 15 11:43 index.html`

如您所见，apache 只能读取此文件。这就是它需要做的所有事情。第一组`-rw-`对应于用户。第二组烫发`r--`对应于组，第三组`r--`对应于其他所有人。

由于您正在运行 php，因此`www-data`您将无法写入此文件。

`upload`使用在 /var/www 中创建目录`sudo mkdir uploads`会授予权限。

`drwxr-xr-x 2 root root 4096 Nov 8 11:59 uploads`

再次`www-data`无法写入上传目录！

您可以打开“其他”权限（不好，因为任何用户都可以写入此目录，而实际上您只希望 www-data 能够写入），您可以添加`www-data`为此目录的所有者。您可以创建一个`admin`组或其他东西并向其中添加 www-data，（或者`www-data`如果没有其他用户需要使用它，或者只是将组更改为，可能还有许多其他更安全的方式，我不是系统管理员，这就是为什么 serverfault会很好:))

至于您的用户问题，如果用户不存在并且您尝试使用`chown`

```
daniel@daniel:/var/www$ sudo chown doesnotexist:stuff uploads/
chown: invalid user: doesnotexist:stuff' 
```

你检查过哪些用户是 presnet 吗？使用`groups`或`cat /etc/passwd`？

# wpf - UserControl 中的只读依赖属性 - 如何使用 ViewModel 属性调用 SetValue？

> ID：13293716
> 
> 赞同：0
> 
> 时间：2012-11-08T16:51:04.053
> 
> 标签：wpf, mvvm, prism

我正在通过 RegisterReadOnly 定义一个只读依赖属性，并删除了 SetValue 的 CLR 包装器（此处概述的方法类似于 MSDN 文章[http://dotnetslackers.com/WPF/re-131262_WPF_Read_only_Dependency_Properties.aspx](http://dotnetslackers.com/WPF/re-131262_WPF_Read_only_Dependency_Properties.aspx)）

现在，我仍然可以从 UserControl 的代码中调用 SetValue，但是，按照 MVVM 的精神，我如何在 ViewModel 上调用 SetValue，而不直接在代码中引用 ViewModel 实例？

我在 UserControl 上有一个只读依赖属性的原因是因为我希望它只表示状态信息，并且不允许在外部重新绑定它

# android - Android 关闭光标

> ID：13293718
> 
> 赞同：0
> 
> 时间：2012-11-08T16:51:09.773
> 
> 标签：android, sqlite, android-cursor

我在我的 sqlite 助手类上有这个：

```
public String listaProdutoDeUmaProposta(String proposta) {

    String sql = "SELECT produto FROM propostas " +
    " WHERE _id =" + proposta;
    String x = "";
    Cursor c = db.rawQuery(sql, null);
    if (c != null) {
        if (c.moveToFirst()) {
            c.moveToFirst();
            x = c.getString(0); 
        }   
    }
    //c.close();
    return x;
} 
```

我在 Activity A 上使用它（在 onCreate 内）：

```
 db = new repositorio(Dados.this);
    db.open();
    produto = db.listaProdutoDeUmaProposta(PROPOSTA);
    if ("XXX".equals(produto)) {
        //code code code
    }
    db.close() 
```

**我在活动 A 上使用它，如果转到活动 B 并按下后退按钮，应用程序强制关闭，它说光标已经关闭。我该如何解决这个问题？**

**错误**

```
W/SQLiteCursor(1088): requery() failed database /data/data/ace.cice/databases/combinedxxi (conn# 0) already closed
W/SQLiteCursor(1088): java.lang.IllegalStateException: database /data/data/ace.cice/databases/combinedxxi (conn# 0) already closed
W/SQLiteCursor(1088):   at android.database.sqlite.SQLiteDatabase.verifyDbIsOpen(SQLiteDatabase.java:2123)
W/SQLiteCursor(1088):   at android.database.sqlite.SQLiteDatabase.getDbConnection(SQLiteDatabase.java:2448)
W/SQLiteCursor(1088):   at android.database.sqlite.SQLiteDatabase.getDatabaseHandle(SQLiteDatabase.java:2429)
W/SQLiteCursor(1088):   at android.database.sqlite.SQLiteCursor.requery(SQLiteCursor.java:412)
W/SQLiteCursor(1088):   at android.app.Activity.performRestart(Activity.java:4393)
W/SQLiteCursor(1088):   at android.app.ActivityThread.performRestartActivity(ActivityThread.java:2652)
W/SQLiteCursor(1088):   at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:163)
W/SQLiteCursor(1088):   at android.app.LocalActivityManager.dispatchResume(LocalActivityManager.java:518)
W/SQLiteCursor(1088):   at android.app.ActivityGroup.onResume(ActivityGroup.java:58)
W/SQLiteCursor(1088):   at ace.cice.DadosApoliceTabs.onResume(DadosApoliceTabs.java:163)
W/SQLiteCursor(1088):   at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1153)
W/SQLiteCursor(1088):   at android.app.Activity.performResume(Activity.java:4428)
W/SQLiteCursor(1088):   at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2217)
W/SQLiteCursor(1088):   at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2255)
W/SQLiteCursor(1088):   at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1028)
W/SQLiteCursor(1088):   at android.os.Handler.dispatchMessage(Handler.java:99)
W/SQLiteCursor(1088):   at android.os.Looper.loop(Looper.java:132)
W/SQLiteCursor(1088):   at android.app.ActivityThread.main(ActivityThread.java:4025)
W/SQLiteCursor(1088):   at java.lang.reflect.Method.invokeNative(Native Method)
W/SQLiteCursor(1088):   at java.lang.reflect.Method.invoke(Method.java:491)
W/SQLiteCursor(1088):   at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841)
W/SQLiteCursor(1088):   at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599)
W/SQLiteCursor(1088):   at dalvik.system.NativeStart.main(Native Method)
D/AndroidRuntime(1088): Shutting down VM W/dalvikvm(1088): threadid=1: thread exiting with uncaught exception (group=0x40014760)
E/AndroidRuntime(1088): FATAL EXCEPTION: main 
E/AndroidRuntime(1088): java.lang.RuntimeException: Unable to resume activity {ace.cice/ace.cice.DadosApoliceTabs}: java.lang.IllegalStateException: trying to requery an already closed cursor 
E/AndroidRuntime(1088):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2227) 
E/AndroidRuntime(1088):     at android.app.ActivityThread.handleResumeActivity(ActivityThread.java:2255) 
E/AndroidRuntime(1088):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1028) 
E/AndroidRuntime(1088):     at android.os.Handler.dispatchMessage(Handler.java:99) 
E/AndroidRuntime(1088):     at android.os.Looper.loop(Looper.java:132) 
E/AndroidRuntime(1088):     at android.app.ActivityThread.main(ActivityThread.java:4025) 
E/AndroidRuntime(1088):     at java.lang.reflect.Method.invokeNative(Native Method) 
E/AndroidRuntime(1088):     at java.lang.reflect.Method.invoke(Method.java:491) 
E/AndroidRuntime(1088):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:841) 
E/AndroidRuntime(1088):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:599) 
E/AndroidRuntime(1088):     at dalvik.system.NativeStart.main(Native Method) 
E/AndroidRuntime(1088): Caused by: java.lang.IllegalStateException: trying to requery an already closed cursor 
E/AndroidRuntime(1088):     at android.app.Activity.performRestart(Activity.java:4394) 
E/AndroidRuntime(1088):     at android.app.ActivityThread.performRestartActivity(ActivityThread.java:2652) 
E/AndroidRuntime(1088):     at android.app.LocalActivityManager.moveToState(LocalActivityManager.java:163) 
E/AndroidRuntime(1088):     at android.app.LocalActivityManager.dispatchResume(LocalActivityManager.java:518) 
E/AndroidRuntime(1088):     at android.app.ActivityGroup.onResume(ActivityGroup.java:58) 
E/AndroidRuntime(1088):     at ace.cice.DadosApoliceTabs.onResume(DadosApoliceTabs.java:163) 
E/AndroidRuntime(1088):     at android.app.Instrumentation.callActivityOnResume(Instrumentation.java:1153) 
E/AndroidRuntime(1088):     at android.app.Activity.performResume(Activity.java:4428) 
E/AndroidRuntime(1088):     at android.app.ActivityThread.performResumeActivity(ActivityThread.java:2217) 
E/AndroidRuntime(1088):     ... 10 more 
```

简历：

```
@Override
public void onResume() {
    System.out.println("Dados Apolice Tabs ON RESUME");
    db = new repositorio(Dados.this);
    db.open();
    produto = db.listaProdutoDeUmaProposta(PROPOSTA);
    db.close();
        super.onResume();   
} 
```

我从 A 调用活动 B，例如：

```
I = new Intent("ace.cice.AconselhamentoCliente");
EXTRAS = new Bundle();
EXTRAS.putString("proposta", PROPOSTA);
I.putExtras(EXTRAS);
startActivityForResult(I, request_Code); 
```

# ruby - 通过命令行传递数组

> ID：13293721
> 
> 赞同：4
> 
> 时间：2012-11-08T16:51:21.123
> 
> 标签：ruby

我有一个名为 的 Ruby 脚本，`foobar.rb`它接受多个参数。

我希望（可选）能够在命令行上指定一个整数数组，并能够将它们作为单个选项进行处理。我认为我的命令行看起来像这样：

```
foobar.rb [1,2,3] 
```

在 1 到 10 的范围内，我对 Ruby 的了解可能在 6 左右。足以知道可能有一种简单的方法可以完成此任务，但还不足以知道它是什么，甚至还不足以知道在文档中的位置。

如何解析这个以逗号分隔的整数列表并`Array`在代码中以 a 结尾？如果存在这样的解决方案，我更喜欢不需要添加任何外部库的 idomatic 1-liner 解决方案。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-08T17:05:54.390

我会`optparse`自己使用它，如下所示：

```
require 'optparse'

options = {}

OptionParser.new do |opts|
  opts.banner = "Usage: #{$0} [options]"

  opts.on("-a", "--argument a,b,c", Array, "Array of arguments") { |a| options[:array] = a.map { |v| v.to_i } }
end.parse!

puts options.inspect

  => {:array=>["1", "2", "3", "4"]} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-08T17:02:59.280

如果您使用 bash 作为终端，这应该可以：

```
integer_array = ARGV[0].scan(/\d/).map(&:to_i) # => Array containing 1,2,3 
```

用 zsh 尝试过，它崩溃了，因为 zsh 尝试`[]`在命令行上解释

对于 zsh，您必须使用

```
foobar.rb "[1,2,3]" 
```

# jquery - 使用复选框对多个类别进行 jQuery 产品过滤

> ID：13293722
> 
> 赞同：1
> 
> 时间：2012-11-08T16:51:24.940
> 
> 标签：jquery, filter, hide, show

这个问题是这个问题的进一步发展：

[用于隐藏和显示 div（产品过滤）的 jQuery 简单复选框，](https://stackoverflow.com/questions/12563152/jquery-simple-checkbox-to-hide-and-show-divs-product-filtering) [ManseUK 给出](https://stackoverflow.com/users/572939/manseuk)了出色的回答

ManseUK 的解决方案支持按单个类别（特别是流派）进行产品过滤，但对于我当前的项目，我需要按 2 个类别进行排序：颜色和大小。通过修改 ManseUK 的解决方案，我几乎可以让它工作，但是当我选择了两个过滤器时它会失败 - 在这个例子中，选择“青色”和“xl”应该只显示 xl 青色，但它会显示两个青色而不是 xl 青色。我正在使用的代码如下：

HTML：

```
<input type="checkbox" id="cyan" value="cyan" /> Cyan<br />
<input type="checkbox" id="magenta" value="magenta" /> Magenta<br />
<input type="checkbox" id="black" value="black" /> Black<br />
<input type="checkbox" id="xl" value="xl" /> XL<br />

<!--------------------->
<div class="products">
    <div class="productItem" data-price="250" data-category="cyan">
        Cyan Ink
        <div class="productItemPrice"><span>&pound;250</span></div>
    </div>
    <div class="productItem" data-price="150" data-category="magenta">
        Magenta Ink
        <div class="productItemPrice"><span>&pound;150</span></div>
    </div>
    <div class="productItem" data-price="250" data-category="black">
        Black Ink        <div class="productItemPrice"><span>&pound;250</span></div>
    </div>
    <div class="productItem" data-price="241" data-category="cyan" data-size="xl">
        XL Cyan Ink
        <div class="productItemPrice"><span>&pound;241</span></div>
    </div>
</div>
<!--------------------->​ 
```

CSS：

```
.productItem{float:left;padding:5px;margin:5px;border:1px solid #eaeaea}
body{font-family:verdana} 
```

JS：

```
$('input[type="checkbox"]').click(function() {
    if ($('input[type="checkbox"]:checked').length > 0) {
        $('.products >div').hide();
        $('input[type="checkbox"]:checked').each(function() {
            $('.products >div[data-category=' + this.id + ']').show();
            $('.products >div[data-size=' + this.id + ']').show();
        });
    } else {
        $('.products >div').show();
    }
});​ 
```

[以上代码的JSFIDDLE](http://jsfiddle.net/NGy7D/)

我可以看到 js 正在对要显示的 div 执行逻辑 OR - 我怎样才能使它成为 AND？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:53:56.947

对代码进行了一些更改..

*   缓存变量。

*   您正在遍历所有复选框并将 id 分配给
    它。您需要单独查询大小，因为它是不同的
    实体。

*   我只循环不是大小的复选框..所有颜色

*   然后检查大小也是检查每种颜色...

**完整代码**

```
 $('input[type="checkbox"]').click(function() {
    // Cache These Variables
    var $checked = $('input[type="checkbox"]:checked');
    var $productsDiv = $('.products > div');
    var $sizeCheckBox = $('input[type="checkbox"][value="xl"]');

    if ($checked.length > 0) {
        $productsDiv.hide();
        // If only XL Checkbox is Checked
        if ($checked.length == 1 && $sizeCheckBox.is(':checked')) {
              $('.products > div[data-size=' + $sizeCheckBox.attr('id') + ']')
                 .show();
        } 
        // If Others are also Checked
        else {
            // All Checkboxes and Not Size Checkbox
            $checked.not($sizeCheckBox).each(function() {
                var dataSize = '';
                if ($sizeCheckBox.is(':checked')) {
                    dataSize = '[data-size=' + $sizeCheckBox.attr('id') + ']';
                }
                $('.products >div[data-category=' + this.id + ']' 
                             + dataSize).show();
            });
        }
    } else {
        $productsDiv.show();
    }
});​ 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/NGy7D/3/)**

# android - 发布到 Google Play 和 Amazon 应用商店的 Android 许可策略

> ID：13293723
> 
> 赞同：9
> 
> 时间：2012-11-08T16:51:41.163
> 
> 标签：android, amazon, google-play, amazon-appstore

我想在亚马逊应用商店和 Google Play 上发布付费应用。我计划为我的应用程序进行两个单独的构建，一个包含并启用了 Google Play 许可库（用于提交到 Google Play），另一个禁用了许可库（用于提交到亚马逊应用商店；亚马逊有自己的许可设施） . 除此之外，两个构建将是相同的（相同的包名称等）。有谁知道这种策略是否可行？

我特别担心的是应用程序更新。如果用户从 Amazon 应用商店购买了我的应用，并且我向 Google Play 发布了更新，那么该用户是否会收到通知，告知他们可以从 Google Play 获得更新？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-12T11:46:27.187

我目前在 google play 市场和 Amazon 市场上都有应用程序，并且没有遇到您上面提到的任何问题。我正在使用 ecplise 并使用证书创建了 apk 文件，并为两个 Android 市场使用了相同的 apk 文件。

由于它们是独立的市场，并且您提到亚马逊有自己的身份验证，这意味着谷歌播放更新不是问题，因此需要在两个市场上完成。

[Google Play 与亚马逊应用商店](https://web.archive.org/web/20130730163559/http://www.broadbandgenie.co.uk/blog/20120903-quick-guide-amazon-android-appstore)

最后，需要注意的是，如果您有任何引用游戏市场的链接，您需要将它们更改为亚马逊市场，否则亚马逊将失败（上传到亚马逊市场可能需要几天时间），希望这会有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-12T05:40:06.203

当您将 android apk 文件提交到 Amazon 应用商店时，它会自行签名并发布应用。我通过调试构建（甚至没有任何签名的 apk）上传，亚马逊接受了它，该应用程序现在在他们的应用程序商店中。亚马逊可能会对应用程序进行某种自动签名。

> 确保您没有实施与 Google Play 商店相关的任何内容。

祝你好运！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-12T12:10:49.593

我正在编写一个应用程序并面临同样的情况，我发现最好的解决方案是将您的应用程序变成一个库项目并将其导入两个单独的项目以进行发布。

这些单独的项目将具有从特定商店启动所需的任何更改，但您的大部分代码将在一个库中。这样，您对库所做的任何更新都将在下一次构建时自动传递到两个版本。

# vb.net - Oracle data_default 返回 long

> ID：13293726
> 
> 赞同：1
> 
> 时间：2012-11-08T16:51:54.827
> 
> 标签：vb.net, oracle11g

我正在尝试获取列的默认值，但不幸的是我什么也没得到。这是我的代码：

```
'ColumnName is the Column Name in question
'BaseTableName is the Table Name
   Dim myCon As New OracleConnection
   myCon.ConnectionString = gApp.ConnectString
   myCon.Open()
   Dim myCmd As New OracleCommand
   myCmd.Connection = myCon
   myCmd.CommandType = CommandType.Text
   myCmd.CommandText = "select data_default " & _
          "from all_tab_columns " & _
          "where table_name='" & BaseTableName & "' " & _
          "and column_name='" & ColumnName & "'"
   Dim dr As OracleDataReader
   dr = myCmd.ExecuteReader
   dr.Read()
   Dim val = dr.GetValue(0).ToString

   '  Dim val = myCmd.ExecuteScalar 'I tried also with executeScalar but it was the same

   myCon.Close() 
```

当我在 oracle 中执行相同的字符串时，它返回一个 Long 并且 long 里面是默认值 ![oracle中的结果](../Images/50e1edabba5b5bc4061f3f0097d8b76e.png)

如何在 long 中获取原始值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T19:40:32.873

假设问题是因为您的环境不支持 LONG，您可以先创建一个函数将值转换为 VARCHAR2。例如：

```
create table test1(a number default 0);

create or replace function get_data_default(
    p_owner varchar2,
    p_table_name varchar2,
    p_column_name varchar2
) return varchar2 authid current_user is
    v_data_default varchar2(4000);
begin
    select data_default
    into v_data_default
    from all_tab_columns
    where owner = p_owner
        and table_name = p_table_name
        and column_name = p_column_name;

    return v_data_default;
end;
/

select get_data_default(USER, 'TEST1', 'A') from dual;

0 
```

如果您对其他列有此问题，您可以使函数更通用，或者您可以查看实用程序将所有字典 LONG 转换为 CLOB。[Dictionary Long Application](http://www.oracle-developer.net/display.php?id=422)可以做到这一点，尽管它会变得非常复杂。

# ios - 将世界转换为对象坐标

> ID：13293728
> 
> 赞同：4
> 
> 时间：2012-11-08T16:51:58.713
> 
> 标签：ios, math, geometry, linear-algebra, gyroscope

iPhone陀螺仪接收到相对于某个参考姿态的旋转数据并且它不会改变（除非相乘。）假设我使用我的iPhone相机面对墙壁，然后向左旋转45度（`roll += PI/4`。）

现在，如果我将手机抬向天花板，由于坐标空间是固定的（世界坐标空间，不随手机移动或旋转），偏航和俯仰都会发生变化。有没有办法确定这个角度（两者之间的角度）地面平面和相机方向矢量），滚动，偏航和俯仰给定？

编辑：而不是打开另一个问题，我会在这里尝试。Luc 的解决方案有效。但是如何获得另外两个旋转角度呢？我已经阅读了发布链接上的信息，但是自从我学习线性代数以来已经有好几年了。实际上，这可能比编程问题更多的是数学问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-11T22:56:20.527

我并没有真正为 iPhone 编码，所以我会在“真实世界坐标”框架上相信你。

在这种情况下，您需要两个 z 轴向量之间的点积。这会给你你正在寻找的角度的余弦，因此非常接近。`0°`由于平面之间的角度仅作为和之间的值才真正有意义`90°`，因此您实际上拥有该余弦所需的所有信息。

这里没有乳胶格式，否则我会更详细地介绍，但如果您有兴趣， [请阅读此页面，我将在此处包含最终结果，即您的三个旋转的旋转矩阵：](http://planning.cs.uiuc.edu/node102.html)![旋转矩阵](../Images/4ebe4d05827ab833b51e7dda1ac05aff.png)

现在水平平面的 z 轴向量是`(0,0,1)`（尽管将其读作垂直向量）并随该矩阵旋转，您只需得到它的第三列。

所以我们想要第三列和`(0,0,1)`向量之间的点积，所以你得到`cos(β)cos(γ)`的是`cos(pitch)*cos(roll)`

总之，您的计划之间的角度是`arccos(cos(pitch)*cos(roll))`。这个值会告诉你你的 iPhone 倾斜了多少，当然不是朝哪个方向。但是你可以从我们谈到的向量（矩阵的最右边一列）的值中计算出来。

# python - ValueError：对象对于所需数组来说太深

> ID：13293731
> 
> 赞同：4
> 
> 时间：2012-11-08T16:52:00.773
> 
> 标签：python, numpy, scipy

```
""" ___ """
from scipy.optimize import root
import numpy as np

LENGTH = 3

def process(x):
    return x[0, 0] + x[0, 1] * 5

def draw(process, length):
    """ """
    X = np.matrix(np.random.normal(0, 10, (length, 2)))
    y = np.matrix([process(x) for x in X])
    y += np.random.normal(3, 1, len(y))
    return y.T, X.T

def maximum_likelyhood(y, X):
    def objective(b):
        return (X.T * (y - X * b.T))
    x0 = np.matrix([0, 0])
    res = root(objective, x0=x0)
    return res.x

y, X = draw(process, LENGTH)
X = X.transpose()
b = np.matrix([[0], [1]])
print maximum_likelyhood(y, X) 
```

产生一个

```
 Traceback (most recent call last):
File "ml.py", line 33, in <module>
  maximum_likelyhood(y, X)
File "ml.py", line 26, in maximum_likelyhood
  res = root(objective, x0=x0)
File "/usr/local/lib/python2.7/dist-packages/scipy/optimize/_root.py", line 168, in root
  sol = _root_hybr(fun, x0, args=args, jac=jac, **options)
File "/usr/local/lib/python2.7/dist-packages/scipy/optimize/minpack.py", line 193, in    _root_hybr
ml, mu, epsfcn, factor, diag)

ValueError: object too deep for desired array 
```

我什至喘不过气来，问题出在目标函数的 b 中吗？还是在它的输出中？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-08T21:19:50.697

问题是 fsolve 和 root 不接受矩阵作为目标函数的返回值。

例如，这是上述问题的解决方案：

```
def maximum_likelyhood(y, X):
    def objective(b):
        b = np.matrix(b).T
        return np.transpose(np.array((X.T * (y - X * b))))[0]
    x0 = (1, 1)
    res = root(objective, x0=x0)
    return res.x 
```

# php - 抑制 PHPLint 的“运算符应用于混合类型的值”

> ID：13293732
> 
> 赞同：2
> 
> 时间：2012-11-08T16:52:07.540
> 
> 标签：php, lint

我目前正处于“防弹”我的代码的工作阶段（很高兴有时间去做！）。我正在使用 PHPLint，它的工作做得很好，但是有谁知道如何抑制错误“运算符应用于混合类型的值”。下面是从类中获取的函数示例：

```
protected /*.int.*/ function numRows(/*.string.*/ $sql)
{
    /*.int.*/ $num_rows = 0;
    $result = $this->mysqli->query($sql);

    if ($result instanceof mysqli_result)
    {
        $num_rows = $result->num_rows;
        $result->free();
    }
    return $num_rows;
} 
```

这给出了以下错误：

```
 $num_rows = $result->num_rows;
                                 \_ HERE 
```

==== DatabaseObject.class.php:103：错误：`->' 运算符应用于混合类型的值

```
 $result->free();
                     \_ HERE 
```

==== DatabaseObject.class.php:104：错误：`->' 运算符应用于混合类型的值

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-25T20:48:51.820

我认为你可以使用[cast](http://www.icosaedro.it/phplint/phplint2/doc/reference.htm?p=typecasting)函数来做到这一点。但是，这意味着将 lint 库作为主代码的一部分进行安装。这不是我一直愿意做的事情。

# ruby-on-rails - 通过设计允许 AJAX (Rails)

> ID：13293737
> 
> 赞同：0
> 
> 时间：2012-11-08T16:52:20.823
> 
> 标签：ruby-on-rails, ajax, ruby-on-rails-3, devise, ruby-on-rails-plugins

我刚刚添加并配置了设计 gem。除了阻止我的表单的自动保存 AJAX 调用之外，它工作得很好。

在我的控制器顶部，我有：

```
before_filter :authenticate_user! 
```

我的 AJAX 调用来自同一个控制器：

```
 def autosave
    #TODO: update relative entry
    #TODO: verify user logged in
    #TODO: verify entry belongs to relative user
    render content_type: 'text/xml', inline: "<result status='ok' />"
  end 
```

当然，我可以像这样声明我的 before 过滤器：

```
before_filter :authenticate_user!, except: :autosave 
```

..但这并不能阻止任何人随时调用此控制器功能。

允许调用此函数的最佳方法是什么？我仍然想确保只有登录用户才能拨打电话，并且他们正在编辑的给定记录属于他们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:37:58.267

不完全确定您要做什么，但听起来您只需要在自动保存中添加一些逻辑即可。使用此设置，该函数本身仍将被调用，但除非条件正确，否则它是否执行任何操作完全是另一回事。

```
def autosave
  #Verify that the user is signed in and he has ownership of entry
  if !current_user.nil? && entry.user == current_user
    render content_type: 'text/xml', inline: "<result status='ok' />"
  else
    #do nothing nothing or redirect with error here
  end  
end 
```

由于您正在发布 AJAX 帖子，因此您必须为您的 ajax 调用提供一些附加信息作为安全对策，即 CSRF 安全令牌。请参阅 [Devise not setting current_user on Ajax post 即使正确的 x-csrf-token 包含在请求标头](https://stackoverflow.com/questions/7393871/devise-not-setting-current-user-on-ajax-post-even-though-correct-x-csrf-token-is)中，以获取使用安全令牌的示例 AJAX 请求。此外，请确保您还包含`<%= csrf_meta_tag %>`在您的头部标签中。

# perl - 如何在 Mojolicious 的其他控制器中调用动作？

> ID：13293739
> 
> 赞同：12
> 
> 时间：2012-11-08T16:52:20.810
> 
> 标签：perl, model-view-controller, mojolicious, mojolicious-lite

我有一个使用 Mojolicious 框架的应用程序。我在数据库中有一个表，其中包含错误响应列表和与之相关的其他详细信息。我已经创建了相应的结果和结果集来处理数据库表。还有一个控制器通过与结果集交互来获取有关错误的详细信息。

我的想法是在此控制器中调用一个操作，该操作将通过查询数据库来获取（由另一个控制器）传递给它的错误的详细信息，加载有关请求资源的环境的运行时信息，从而导致错误，创建一个响应并返回到调用它的控制器。

我正在努力处理从一个控制器到另一个控制器的呼叫。我如何在 Mojolicious 中做到这一点？`$self`我可以传递控制器对象（

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-08T17:22:36.553

在 Mojolicious 中，您可能希望使用帮助器传递该对象**而不**创建`Mojolicious::Controller`它：

在您的主要课程中：

```
sub startup {
    my $app = shift;

    # ...
    my $thing = Thing->new(foo => 42);
    $app->helper(thing => sub {$thing});
} 
```

在您的控制器中：

```
sub cool_action {
    my $c = shift;

    # ...
    my $foo = $c->thing->gimmeh_foo('bar');
    # ...
} 
```

但是，如果您想为某些操作准备一些东西（例如数据库），也许[under](http://mojolicio.us/perldoc/Mojolicious/Guides/Routing#Under)对您有帮助：

> 要与多个嵌套路由共享代码，您可以 [...]

PS：Mojolicious 的这个功能之前被命名为*Bridges*。答案相应更新。

# c# - jQuery 倒计时和 C# 中继器

> ID：13293745
> 
> 赞同：0
> 
> 时间：2012-11-08T16:52:31.363
> 
> 标签：c#, jquery, countdown

我正在尝试在 C# Web 应用程序中使用 jQuery 进行多个倒计时。

我的数据库中有两个不同的日期，我将它们插入到 javascript 中。这很好用，但是 javascript 使用数据库中的相同日期，这可能是因为只有一个 javascript 实例，所以我需要一些关于如何解决这个问题的建议。

这是完整的代码。

标记：

```
<script type="text/javascript" src="scripts/jquery.countdown.js"></script>
<script type="text/javascript">
    $(function () {
        var count = new Date('<%=Datestring%>');
        var countdown = setInterval(function () {
            $('.countdown').countdown({ until: count, format: 'DHMS' });
            if (count == 0) {
                window.location = 'http://google.com';
            }
            count--;
        }, 1000);
    });
</script>

<asp:Repeater ID="repAuctions" runat="server" OnItemDataBound="repAuctions_OnItemDataBound">
    <ItemTemplate>
        <div>
            <asp:Literal ID="litHeading" runat="server" />
            <br/>
            <asp:Literal ID="litCountDown" runat="server" />
        </div>
    </ItemTemplate>
</asp:Repeater> 
```

后端：

```
public string Datestring;
    protected void Page_Load(object sender, EventArgs e)
    {
        repAuctions.DataSource = AuctionsFactory.GetAllAuctions();
        repAuctions.DataBind();
    }

    protected void repAuctions_OnItemDataBound(object sender, RepeaterItemEventArgs e)
    {
        var auction = (Auction)e.Item.DataItem;
        var litCountDown = (Literal)e.Item.FindControl("litCountDown");
        var litHeading = (Literal)e.Item.FindControl("litHeading");

        string format = "ddd MMM d yyyy HH:mm:ss";
        var countdowndate = (DateTime) auction.TimeLeft;
        Datestring = countdowndate.ToString(format);

        litHeading.Text = auction.Heading;
        litCountDown.Text = auction.TimeLeft + "<span class='countdown'></span>";
    } 
```

提前致谢 ：）

# ajax - 多个嵌套异步 AJAX 调用和返回数据的顺序

> ID：13293746
> 
> 赞同：3
> 
> 时间：2012-11-08T16:52:37.947
> 
> 标签：ajax, json, asynchronous, nested, synchronous

第一次在这里发海报。对于我遇到的其他问题，我找到了一些很好的答案，但是这个问题让我很难过，我不确定最好的解决方法。我进行了一些搜索，但没有找到任何看起来像是解决方案的东西。

我正在构建一个基本 BOM 显示的表格。该函数采用所需的部件 ID 和空格（仅用于缩进结果以提高可读性）并通过再次调用自身来检查任何子部件的每个结果，依此类推。

如果我将 ASYNC 设置为*false*并且我得到了想要的结果，这会很好，但我认为可能有一种方法可以使这个异步并在更短的时间内达到相同的结果。

是的，我将对其进行修改，使其不会在每次调用时更新 DOM。我会把它改成一个变量，所以最后只有一个调用！

任何帮助表示赞赏。

```
/*******************************************************************
FUNCTION -  Traverse the BOM     
            Check each PID for child parts          
********************************************************************/   
function traverse_bom(search_term, spaces) {     
    spaces += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
    $.ajax({
        //async: false, 
        url: 'spec_collector_ajax.php',
        dataType: 'json',
        data:  { data_retrieve: "database_query",
                 table: "Product_Structure",
                 order: "ORDER BY COMPRT_02",
                 search: search_term},                 
        success: function(data2) 
        {       
            // If there is data, then print it out to a table     
            if (data2 != 0) 
            {               
                // Iterate through each entry and list the results
                $.each(data2, function(i2,item2) 
                {      
                    // print the BOM entry info
                    $('#table_bom tbody:last').append( '<tr><td>' + spaces + item2.COMPRT_02 + '</td><td>' + item2.QTYPER_02 + '</td></tr>');

                    // Check for children under this part
                    traverse_bom(item2.COMPRT_02, spaces);                     
                });
            } 

            else
            {
            }
        },
        // Error handling
        error: function (xhr, ajaxOptions, thrownError) {
            // Print error message for debugging
            alert(thrownError);
        }
    }); 
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-07T01:13:00.970

您可以在调用递归期间设置[async = false](http://api.jquery.com/jQuery.ajax/?rdfrom=http://docs.jquery.com/mw/index.php?title=Ajax/jQuery.ajax&redirect=no#jQuery-ajax-settings)，使后续调用同步并且不会搞砸您的订单。

例如：

```
/*******************************************************************
FUNCTION -  Traverse the BOM     
            Check each PID for child parts          
********************************************************************/   
function traverse_bom(search_term, spaces, synchronous) {
    //if synchronous is null default to asynchronous 
    if(synchronous == null) { synchronous = false; }

    spaces += "&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;";
    $.ajax({
        //async: false, 
        url: 'spec_collector_ajax.php',
        dataType: 'json',
        async: !synchronous, //Not synchronous
        data:  { data_retrieve: "database_query",
                 table: "Product_Structure",
                 order: "ORDER BY COMPRT_02",
                 search: search_term},                 
        success: function(data2) 
        {       
            // If there is data, then print it out to a table     
            if (data2 != 0) 
            {               
                // Iterate through each entry and list the results
                $.each(data2, function(i2,item2) 
                {      
                    // print the BOM entry info
                    $('#table_bom tbody:last').append( '<tr><td>' + spaces + item2.COMPRT_02 + '</td><td>' + item2.QTYPER_02 + '</td></tr>');

                    // Check for children under this part
                    // This is where we set synchronous to true, inside the recursion.
                    traverse_bom(item2.COMPRT_02, spaces, true); 
                });
            } 

            else
            {
            }
        },
        // Error handling
        error: function (xhr, ajaxOptions, thrownError) {
            // Print error message for debugging
            alert(thrownError);
        }
    }); 
}; 
```

# java - 多色网格

> ID：13293749
> 
> 赞同：1
> 
> 时间：2012-11-08T16:52:43.463
> 
> 标签：java, grid

我的任务是为 3 种不同类型的益智游戏制作游戏生成器。我只需要完成《宝石迷阵》的最后一场比赛。我已经使用充满按钮的 GridLayout 制作了网格。

我只需要在所有按钮上应用 7 种不同的颜色。我之前尝试过使用此代码：

```
String[] backgroundColors = {"CYAN","PINK","YELLOW"};  
int number = (int)(Math.random() * 3);  
String c = (backgroundColors[number]); 
```

（然后在我将按钮添加到窗格后，我 dd 这个：）

```
buttonBejeweled.setBackgroundColor(c); 
```

它失败了。我想也许我应该使用和数组，但我搜索并没有找到任何不幸的。请帮助我使用随机颜色生成器，最好使用数组。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:00:37.603

您可以使用

```
Color[] backgroundColors = {Color.RED,Color.GREEN,Color.BLUE};  
int number = (int)(Math.random() * 3);  
Color c = (backgroundColors[number]); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:07:09.707

.setBackgroundColor() 是否使用字符串参数？如果它不起作用，我猜它使用了 Color 类型的参数。您是否已导入颜色库？如果不是，要访问颜色，您必须使用 Color 类并使用 Color.CYAN 访问颜色，因此您会这样做

```
Color[] backgroundColors = {Color.CYAN,Color.PINK,Color.YELLOW};  
int number = (int)(Math.random() * 3);  
Color c = (backgroundColors[number]); 
buttonBejeweled.setBackgroundColor(c); 
```

# c - 下面的简单代码在 O 方面的效率是多少以及如何？

> ID：13293751
> 
> 赞同：-2
> 
> 时间：2012-11-08T16:52:50.383
> 
> 标签：c, arrays

```
#define MAX 20    //defines max as 20  
#include< stdio.h>  

main()    //main function starts  
{  
    int a[MAX],i,n;  //defines a array along with some variables  `

    printf("Enter the value of n\n");    //take the size of the array from user  
    scanf("%d",&n);    //reads the value
    printf("Enter the numbers\n");    //asks to enter the values of array  
    for(i=0;i< n;i++)    //for loop is used to read the elements of the array     
    scanf("%d",&a[i]);    //reads the element    

    i=0;    //initialises i to zero to point it to the first element of array  
    do    //starts the do while loop      
    {  
        a[i]=a[i]+1;    //increases the stored value of the array by 1  
        i++;  
    } while(i< n);    //checks the while condition whether i is less than n  

    printf("The final array is \n");  
    for(i=0;i< n;i++)    //for loop is used to print the array  
        printf("%d\t",a[i]);    //prints the final array  
} 
```

如果 i 的值在 do while 循环内发生变化，并且如果它发生变化，那么效率会发生变化，那么它是如何变化的。

> 如果将while循环更改如下，效率会是多少

```
int j=0;
do{
  if(j==n-2 || j==n-3)
    i--;
  else 
  {
    a[i]=a[i]++;
    i++;
    j++;
  }
} while(i< n); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:04:26.913

答案是 O(3n) = O(n) 因为你的循环从 0 增加到 (n-1) 3 次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:22:16.720

上）

我认为这就是你试图以一种有组织的“智能”方式编写的内容：

```
#include< stdio.h>  
main()
{  
    int *a;
    int i;
    int n;

    printf("Enter the value of n\n");
    scanf("%d",&n);
    a = (int*)malloc(n * sizeof(*a));//dynamically allocate the array in the needed size.
    printf("Enter the numbers\n");
    for(i=0; i<n; ++i)
    {
        scanf("%d",&a[i]);
    }

    for(i=0; i<n; ++i)
    {
        a[i]++;
    }

    for(i=0; i<n; ++i)
    {
        printf("%d\t",a[i]);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:59:30.450

该算法是 O(∞)，因为`i`在中间循环中从不递增。

# c# - ASP.Net 如何响应发送到我的通用处理程序的请求

> ID：13293753
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:52:56.593
> 
> 标签：c#, asp.net

假设我已经告诉第 3 方向基于 {http://myIp/Myhandler.ashx} 的通用处理程序发送请求。我该如何回应他们发送的请求？我有函数 process request 让我可以访问上下文对象，但是如何使用它来确保我的响应返回到请求发起的同一位置，从而充当对他们请求的回复。我尝试构建一个 HTTPResponse 对象并将其发送到他们的服务器，但这不起作用。我正在尝试用 OK 消息回复他们，并给他们一个网址以将用户重定向到。

```
 public void ProcessRequest(HttpContext context)
        {

            string status = context.Request.Params["Status"];
            string statusDetail = context.Request.Params["StatusDetail"];

            switch (status.ToUpper())
            {
                case "OK":
                    {
                        StringBuilder content = new StringBuilder();

                        content.Append("Status=" + HttpUtility.UrlEncode("OK"));
                        content.Append("&RedirectURL=" + HttpUtility.UrlEncode("http://http://myip:myport/Error.aspx?Error=SUCCESS"));
                        content.Append("&StatusDetail=" + HttpUtility.UrlEncode("OK"));

                        HttpWebResponse response = SendPOSTRequest("http://theirip.page", content.ToString(), "", "", true);
}
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T16:54:48.117

您用于`context.Response`写入响应流。（您可以随用随用`Write`，而不是将所有内容都放在字符串构建器中并写入；它会自动适当地缓冲它。）ASP、IIS 和 HTTP 将确保写入响应流是针对实际发送请求的任何内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T16:55:40.193

使用`context`参数设置要发送的响应。由于您的响应是一个字符串，您可以使用`Write`：

```
context.Response.Write(content.ToString()); 
```

您还需要设置一些响应标头：

```
context.Response.ContentType = "text/plain";
context.Response.ContentEncoding = System.Text.Encoding.Default; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:55:33.760

```
HttpWebResponse response = Context.Response 
```

或直接写给它

```
Context.Response = SendPOSTRequest .... 
```

# kml - 如果在纬度/经度点的 500 英尺区域内，则从 KML 解析坐标

> ID：13293754
> 
> 赞同：0
> 
> 时间：2012-11-08T16:53:00.840
> 
> 标签：kml, google-earth-plugin

我有一个 KML 文件 ( )，其中的资产在纽约地区`NewYork.kml`的坐标 ( 内部 ) 中列出。`LineStrings`

我正在尝试在纽约选择一个随机点（例如：`40.739974`, `-74.009605`）并获取 500 英尺范围内列出的任何资产。

我正在使用 Java/Google 地球 API。有没有人对哪个方向有任何提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-05T00:01:18.497

我推荐[geojs](http://code.google.com/p/geojs/)库，特别是[geo.Point](http://code.google.com/p/geojs/wiki/GeoPointReference)类。

它有一些有用的方法`distance()`，您可以使用这些方法查看两个坐标是否在 500 英尺范围内。

# gcc - gfortran：尝试执行“f951”时出错：execvp：没有这样的文件或目录

> ID：13293762
> 
> 赞同：8
> 
> 时间：2012-11-08T16:53:19.507
> 
> 标签：gcc, compiler-errors, fortran, gfortran

我正在尝试编译在互联网上找到的代码。实际上，我正在尝试编译在[http://www.cs.berkeley.edu/~fowlkes/BSE/](http://www.cs.berkeley.edu/~fowlkes/BSE/)找到的代码。

我尝试在我的 MAC 中安装 gfortran 和编译它所需的所有其他库。但是当我运行**make**命令时，出现以下错误：

```
$ make
(cd trlan && make -f Makefile.gcc)
gfortran -O3 -ffixed-line-length-132 -c dsort2.f
gfortran: error trying to exec 'f951': execvp: No such file or directory
make[1]: *** [dsort2.o] Error 1
make: *** [trlan/libtrlan.a] Error 2 
```

我认为该错误与我的 c++ 编译器版本有关，与 gfortran 不兼容。

当我运行命令**gcc --version**：

```
$ gcc --version
i686-apple-darwin11-llvm-gcc-4.2 (GCC) 4.2.1 (Based on Apple Inc. build 5658) (LLVM build 2336.11.00) 
```

当我运行命令**gfortran --version**时：

```
$ gfortran --version
GNU Fortran (GCC) 4.8.0 20120930 (experimental) 
```

我正在运行命令**make**的目录下的 Makefile 在这里：[https://www.dropbox.com/s/q7mxvhnqg62ioum/Makefile.gcc](https://www.dropbox.com/s/q7mxvhnqg62ioum/Makefile.gcc)

trlan目录下的Makefile在这里：[https ://www.dropbox.com/s/jydwpkg3f1upbgf/Makefile.gcc](https://www.dropbox.com/s/jydwpkg3f1upbgf/Makefile.gcc)

任何人都知道如何解决这个问题或如何找到可以帮助我解决它的工具？

我正在尝试这个： [http ://eftrunk.blogspot.com/2011/11/how-to-fix-error-trying-to-exec-f951.html](http://eftrunk.blogspot.com/2011/11/how-to-fix-error-trying-to-exec-f951.html)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-10-02T14:53:30.450

我找到的最简单的解决方案（也许不是最干净的）是将路径中的 f951 静态链接到 gfortran 的二进制文件：

```
find /usr/local/ -name f951 
```

对我来说返回：

```
/usr/local/gfortran/libexec/gcc/x86_64-apple-darwin11/4.6.2/f951
/usr/local/gfortran/libexec/gcc/x86_64-apple-darwin14/5.1.0/f951 
```

所以我在 /usr/local/bin 中放了一个最适合我的系统的链接：

```
sudo ln -s /usr/local/gfortran/libexec/gcc/x86_64-apple-darwin14/5.1.0/f951 /usr/local/bin/. 
```

现在 gfortran 又可以工作了。无需卸载 XCode 或任何其他夸张的工作负载。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-11-09T22:51:52.713

答案可以在以下网站找到：

[http://eftrunk.blogspot.com/2011/11/how-to-fix-error-trying-to-exec-f951.html](http://eftrunk.blogspot.com/2011/11/how-to-fix-error-trying-to-exec-f951.html)

基本上需要删除 Xcode，使用[http://hpc.sourceforge.net/](http://hpc.sourceforge.net/)重新安装 gcc 和 gfortran ，然后重新安装 Xcode。

# continuous-integration - 谁能告诉我声纳中冗余修饰符检查中的“大约 8 小时”是什么意思？

> ID：13293763
> 
> 赞同：0
> 
> 时间：2012-11-08T16:53:21.743
> 
> 标签：continuous-integration, sonarqube

![在此处输入图像描述](../Images/1347f08a16155b078476e11b7965f3f7.png)

我在其他支票上也看到了这一点，但有很多没有它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:08:48.747

这会告诉您 Sonar 何时首次发现此违规行为。

# vb.net - 打开连接到计算机 rj11 端口的钱箱

> ID：13293768
> 
> 赞同：1
> 
> 时间：2012-11-08T16:53:30.257
> 
> 标签：vb.net, point-of-sale

我有一个用 VB.Net 制作的软件，它打开了一个连接到收据打印机的钱箱。前几天出现问题，打印机型号变了，我必须将钱箱连接到计算机的 rj11 端口。我对这个端口一无所知，这不是 COM 端口，也不是调制解调器。

以前有人遇到过这个问题吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T14:03:07.573

我对 VB.net 没有太多经验，但我已经在 Delphi 中与这些端口进行了通信，所以这就是我所知道的。

这些端口通常的工作方式是它们具有固定的 IRQ 位置，这些在制造商手册中有详细说明

开通提现流程如下

1.  获取端口的内存（IRQ）（这应该在制造商的手册中详细说明）
2.  从端口获取当前的 8 位（短）值（这样我们就不会弄乱那里的设置）
3.  使用 OR 打开或关闭相关位（1 或 0）以打开，AND 关闭以打开平局
4.  等待一秒钟以打开抽奖（否则该位将在抽奖有时间响应之前被翻转）
5.  使用 OR 打开或关闭相关位（1 或 0）打开，AND 关闭以重新接合抽屉上的锁定销（否则当他们关闭时，抽屉将再次弹开）*

    *   注意：您不只是将值设置回您最初获得的值，因为如果程序在将其翻转回锁定之前崩溃，您无法在不重新启动的情况下锁定抽奖，因此在原件上使用 AND 或 OR value 将确保 1 为 0 或相反。

最大的问题是在 Windows 中访问这些端口有点痛苦，因为现在大多数命令都受到限制（即被归类为特权指令），但是那里有 3rd 方 DLL 可以绕过它（例如[Inpout32.dll）。 dll](http://logix4u.net/parallel-port/parallel-port/index.php?option=com_content&task=view&id=16&Itemid=1) ) - 虽然 VB.net 可能没有这个限制。

* * *

来自 Tysso 5700 用户手册

**Cash Drawer Controller Register**
Register Location: I/O port 280h
Size: 8 bit
Bit 0~3, 5~7: Reserved
Bit 4: Cash Drawer “DIO OUTPUT”，引脚输出控制。1：打开钱箱 0：关闭钱箱

# android - 如何导航到相同的父状态

> ID：13293772
> 
> 赞同：36
> 
> 时间：2012-11-08T16:53:33.257
> 
> 标签：android, android-intent, android-actionbar

从我对 Gmail 和 TED 应用程序的观察来看，向上导航的行为将导航到具有相同状态（滚动位置）的父级，这与谷歌在他们的文档[实施向上导航](http://developer.android.com/training/implementing-navigation/ancestral.html)中所说的不同，就像创建父级意图并启动它一样。

我从 Android 示例代码中实现了代码，所有状态都消失了（我之前设置的所有额外参数和滚动位置）。什么是正确的方法？我在 Android 文档上找不到任何内容。

下面是代码：

```
public boolean onOptionsItemSelected(MenuItem item) {
switch (item.getItemId()) {
    case android.R.id.home:
        Intent upIntent = new Intent(this, MyParentActivity.class);
        if (NavUtils.shouldUpRecreateTask(this, upIntent)) {
            // This activity is not part of the application's task, so create a new task
            // with a synthesized back stack.
            TaskStackBuilder.from(this)
                    .addNextIntent(new Intent(this, MyGreatGrandParentActivity.class))
                    .addNextIntent(new Intent(this, MyGrandParentActivity.class))
                    .addNextIntent(upIntent)
                    .startActivities();
            finish();
        } else {
            // This activity is part of the application's task, so simply
            // navigate up to the hierarchical parent activity.
            NavUtils.navigateUpTo(this, upIntent);
        }
        return true;
}
return super.onOptionsItemSelected(item); 
```

}

在我的情况下，我有 3 个活动说 AB 和 C，当用户从 A 导航到 BI 时放置了一些额外内容，`onCreate`而 BI 使用这些额外内容从数据库查询数据以填充我的行，当我从 C 导航回来时，所有额外内容都消失了，活动B 什么都不显示。

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-06-27T11:38:20.577

android 活动的“标准”行为是，每次该活动有新的意图时，都会创建一个新的活动实例（请参阅[此处](http://developer.android.com/guide/topics/manifest/activity-element.html#lmode)的 launchMode-docu ）。因此，如果您调用 navigateUpTo，您的附加功能似乎消失了。

在你的情况下，我建议使用

```
android:launchMode="singleTop" 
```

用于您的 AndroidManifest.xml 中的父活动。这样，您将返回到您现有的活动（只要它位于任务的后堆栈的顶部）。这样，您的额外内容将被保留。

我也不明白为什么你引用的谷歌文档中没有提到这一点，因为这似乎是人们在使用向上导航时所期望的行为。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-12-06T10:14:37.137

[这是已接受答案](https://stackoverflow.com/a/17342137/2306907)的替代解决方案：

如果您无法更改`launchMode`活动的 或如果父活动不在后堆栈顶部（例如 A 是 C 的父级），则不能使用上述解决[方案](https://stackoverflow.com/a/17342137/2306907)。在这种情况下，您必须扩展您的`navigateUpTo`调用以告诉活动，如果它在后台堆栈上，则不应重新创建它：

```
Intent intent = NavUtils.getParentActivityIntent(this); 
intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP); 
NavUtils.navigateUpTo(this, intent); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-11T22:13:18.867

当我在带有片段的主要活动中调用 startActivityForResult() 然后尝试使用向上导航从被调用者返回到它时，我遇到了类似的问题。通过实施向上导航解决：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            setResult(RESULT_CANCELED);
            finish();
            return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

在这种情况下，向上按钮的行为类似于普通的后退按钮，并且所有状态都被保留。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-23T16:25:00.010

你可以使用这个：

```
@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case android.R.id.home:
            super.onBackPressed();
            return true;
    }
    return super.onOptionsItemSelected(item);
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T17:07:22.460

您需要将状态保存在父活动上，并在从调用活动返回后恢复。

请参阅[使用 Save Instance State 保存 Android Activity 状态以](https://stackoverflow.com/questions/151777/saving-activity-state-in-android/151940#151940)获取有关该过程的完整说明，并附有代码。

# types - 哪些语言将符号/无符号归因于操作而不是数据？

> ID：13293774
> 
> 赞同：4
> 
> 时间：2012-11-08T16:53:38.677
> 
> 标签：types, programming-languages, unsigned

在大多数比汇编更高级别的语言中，整数变量具有带符号或无符号的特性。在 C 中，“无符号短”作为数据类型。我能想到的所有语言，C 系列或 Pascal 派生的新语言，如 Go，都有这样的数据类型。（有些不提供未签名，只是签名，但不要介意那些。）

基本事实是，我研究过的所有 CPU 都具有与操作相关的符号，或者在操作之后选择分支操作码。有有符号右移和无符号右移操作码。有符号和无符号整数都经过相同的算术电路，因为 1 和 0 的结果相同。进位和溢出标志得到调整。当编译器根据符号表和它建立的变量属性选择进位分支与溢出分支或类似选择时，就会出现区别。

只是好奇，因为我喜欢接近硅的语言 - 是否有任何更高级别的语言，比如在 C 级别以上，整数值没有使用任何有符号/无符号属性键入？

我知道 Java 中的 >>> 运算符。这是我所要求的一个小例子，但想知道是否有语言（可能晦涩难懂）彻底使用不同的运算符而不是有符号/无符号的不同数据类型。

（有点相关的是任何语言是否提供访问 CPU 的 C 或 O 标志的问题，所以你可以自己动手做。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-03T18:15:29.490

我认为从语言开发人员的角度来看，没有签名和签名的操作是相当罕见的。具有无符号右移行为的 java 运算符 >>> 似乎是一个例外，它的用法与将其操作数视为有符号或无符号（我的假设）没有太大关系。如果您将所有有符号/无符号逻辑实现为操作，它很快就会变得棘手。例如考虑两个 C 分配：

```
short var_a = -1;
unsigned int var_b = var_a;
printf("%d", var_b); // -1

unsigned short var_a = -1;
unsigned int var_b = var_a;
printf("%d", var_b); // 65535 
```

第一种情况必须执行符号扩展，因为它是有符号类型的向上转换，而第二种情况不能执行符号扩展，因为它是无符号类型的向上转换。我不想考虑为此类分配使用哪个分配操作。

还要考虑[Gosling](http://www.gotw.ca/publications/c_family_interview.htm)对此的看法：

> “向任何 C 开发人员询问有关无符号的问题，很快你就会发现几乎没有 C 开发人员真正了解无符号的情况，无符号算术是什么。这样的事情使 C 变得复杂。我认为 Java 的语言部分非常简单. 你必须查找的图书馆。

我同意他的观点，并认为拥有一种签名类型更简单。需要 Java 等语言中的无符号算术的人可以轻松地自己实现它（我在 Java 中实现了一个 C 解释器）。

# mysql - MySQL MIN/MAX 所有行

> ID：13293778
> 
> 赞同：3
> 
> 时间：2012-11-08T16:53:45.220
> 
> 标签：mysql, select, max, min

我有`Races`行的表`ID`，`Name`和`TotalCP`。我 SELECT MIN( `TotalCP`) FROM `Races`，但是我想选择具有最小值的整行。我怎样才能做到这一点，在一个单一的查询？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-08T16:55:26.993

从聚合值中获取整行的一般形式是：

```
SELECT *
FROM Races
WHERE TotalCP = (SELECT MIN(TotalCP) FROM Races) 
```

或者

```
SELECT r.*
FROM
(
    SELECT MIN(TotalCP) t
    FROM Races
) m
INNER JOIN Races r ON m.t = r.TotalCP 
```

但是，在这种情况下，由于您使用的是`MIN`，您只需排序并取第一行：

```
SELECT *
FROM Races
ORDER BY TotalCP
LIMIT 1 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:55:27.177

```
Select * from Races
where TotalCP = SELECT MIN( TotalCP ) FROM Races 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:55:38.223

子查询是您的选择，

```
 SELECT * FROM Races where TotalCP = (SELECT MIN( TotalCP ) FROM Races) 
```

# jsf-2 - 动态创建 HtmlSelectOneMenu - 分配 SelectItem 列表

> ID：13293779
> 
> 赞同：2
> 
> 时间：2012-11-08T16:53:46.793
> 
> 标签：jsf-2

我有一个 JSF 应用程序，我需要根据页面的某些参数动态创建几乎所有 UIComponents。组件被创建并添加到 HtmlPanelGrid。我已经成功地创建了 HtmlLabel、HtmlInputText、UISelectBoolean 和 HtmlCommandButton。现在我需要创建一个 HtmlSelectOneMenu 并添加它，我很难找到显示如何附加要选择的项目列表的示例。

选择列表是这样的，我将 cfaItems 设置为我的支持 bean 的属性：

```
SelectItem[] cfaItems = {
    new SelectItem(1, "1"),
    new SelectItem(2, "2"),
    new SelectItem(3, "3"),
    new SelectItem(4, "4"),
    new SelectItem(5, "5")
}; 
```

HtmlSelectOneMenu 的创建：

```
 HtmlSelectOneMenu cfaMenu = (HtmlSelectOneMenu)
        getApplication().createComponent(HtmlSelectOneMenu.COMPONENT_TYPE);
    cfaMenu.setId("cfaMenu");
    grid.getChildren().add(cfaMenu); 
```

尽我所能，我需要创建一个 ValueExpression 将 cfaItems 列表绑定到 cfaMenu 但找不到任何示例是一个问题。我认为我需要做这样的事情

```
 String menuBinding =
        "#{" + beanName + ".cfaItems}";
    ValueExpression menuVE = getApplication().getExpressionFactory().
        createValueExpression(FacesContext.getCurrentInstance().
        getELContext(), menuBinding, String.class);
    cfaMenu.setValueExpression("value", menuVE); 
```

但我不认为这是正确的。有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:21:16.663

您需要[`UISelectItems`](http://docs.oracle.com/javaee/6/api/javax/faces/component/UISelectItems.html)使用给定的选择项数组作为值创建一个实例，然后将其添加为菜单的子项，就像您`<f:selectItems>`在视图端所做的那样。

```
UISelectItems selectItems = new UISelectItems();
selectItems.setValue(cfaItems);
cfaMenu.getChildren().add(selectItems); 
```

# vim - 设置 expandtab 时突出显示 vim 中的选项卡

> ID：13293780
> 
> 赞同：5
> 
> 时间：2012-11-08T16:53:50.367
> 
> 标签：vim, indentation, vim-syntax-highlighting

是否有一种方法可以使 vim 突出显示具有给定颜色的制表符，但*仅*在`expandtab`设置选项时？我知道`'listchars'`，但我希望能够区分“有效标签”和“无效标签”。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T19:51:50.163

您可以`:match`基于 为制表符添加自定义`:autocmds`，如下所示：

```
autocmd WinEnter,VimEnter *
\   if &expandtab |
\       silent! call matchadd('Error', '\t',  10, 31337) |
\   else |
\       silent! call matchdelete(31337) |
\   endif 
```

（为简单起见，这使用了硬编码的 ID。）

或者，您可以使用像我的[IndentConsistencyCop](http://www.vim.org/scripts/script.php?script_id=1690)这样的插件，它检查缓冲区及其设置的不一致缩进和不匹配，并且默认情况下还会突出显示错误的行。（插件页面有其他插件的链接。）

# scala - 如何为节点之间的图强制执行类型

> ID：13293782
> 
> 赞同：2
> 
> 时间：2012-11-08T16:53:54.810
> 
> 标签：scala

我正在尝试在节点与其父节点之间的图中强制执行类型关系。我有以下内容无法在 child.parents ::= this 上编译。欢迎任何评论

```
 trait TGraphNode {
    type NodeType <: TGraphNode
    var id = -1
    var parents = List[NodeType]()
    var children = List[TGraphNode]()

    def addChild(child: NodeType) {
      children ::= child
      child.parents ::= this
    }

    override def toString = "node-"+id+"->"+children
  } 
```

抱歉 - 下次会添加编译错误。我正在尝试实现以下目标：假设我有 2 个类型为 F 和 C 的节点 - 我想通过构造强制 C 只能将 F 作为父级，但是，反过来我不在乎。F可以有C，D..作为孩子。所以我想捕捉到 ParentType 可以在实现特征的类中被覆盖。

```
class F extends TGraphNode ...
class B extends TGraphNode {
  type ParentType = F
} 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:31:17.447

错误信息是

```
error: Type mismatch 
 found   : TGraphNode.this.type (with underlying type TGraphNode)
 required: child.NodeType
             child.parents ::= this 
```

（请不要在您的问题中省略）

您的代码声明节点可以选择其父节点所需的类型，类型为 variable `NodeType`。这种类型必须符合 TGraphNode，但它可能比这更受限制。

鉴于此，`child`添加的类型可能`addChild`需要比`this`其父类型更受限制的类型。编译器拒绝它是正确的。

这就是错误消息的内容：您放入`this`了孩子的父母列表。`this`有类型`TGraphNode`。但是`parents`列表是`NodeType`子列表的 ( `child.NodeType`) 并不能保证比类型匹配。

如果您不解释您要达到的目标，我无法进一步评论。

* * *

编辑后：

您必须声明您将在 addChild 中仅接受一个接受此作为父母的孩子。这可能有点棘手，这是一种可能的方法：

```
def addChild[N](child: TGraphNode{type NodeType = N})
               (implicit thisAsParentOfChild : this.type <:< N) {
  children ::= child
  child.parents ::= thisAsParentOfChild(this)
} 
```

完成后，您现在可以这样做

```
class F extends TGraphNode {type NodeType = TGraphNode }
class C extends TGraphNode {type NodeType = F }
class X extends TGraphNode {type NodeType = TGraphNode } 

val f = new F
val c = new C
val x = new X

f.addChild(c) // ok 
x.addChild(f) // ok

x.addChild(c) // error: Cannot prove that x.type <:< F 
```

如果您不知道 <:< 类型的隐式参数是[做什么的，请查看 <:<、<%< 和 =:= 在 Scala 2.8 中的含义，以及它们在哪里记录？](https://stackoverflow.com/q/3427345/754787)

* * *

在重新考虑和阅读 bluenote 建议时，写作`addParent`比`addChild`您的上下文要简单得多（我相信这是颠倒孩子和父母的正确方法）：

```
def addParent(parent: NodeType) {
  parents ::= parent
  parent.children ::= this
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:32:06.057

我的猜测是，您只是混淆了类型`NodeType`和`TGraphNode`. 如果我理解正确，孩子可能是`TGraphNode`. 至少这是`addChild`函数签名所表明的，并且可能是更可能的用例。所以，孩子必须是类型`NodeType`，但父母可以有更一般的`TGraphNode`类型，即：

```
trait TGraphNode {
  type NodeType <: TGraphNode
  var id = -1
  var children = List[NodeType]()
  var parents = List[TGraphNode]()

  def addChild(child: NodeType) {
    children ::= child
    child.parents ::= this
  }

  override def toString = "node-"+id+"->"+children
} 
```

**编辑：**

好吧，你真的想要反过来。由于上面提到的版本编译，你可以颠倒孩子和父母的定义来得到你想要的。

# web-services - com.sun.jersey.api.container.ContainerException：ResourceConfig 实例不包含任何根资源类

> ID：13293787
> 
> 赞同：14
> 
> 时间：2012-11-08T16:53:58.883
> 
> 标签：web-services, rest, maven, jersey

当我尝试在 Apache Tomcat 上访问使用 Jersey 和 maven 实现的 HelloWorld RESTful Web 服务时，出现以下异常。

```
URL: http://localhost:8080/TestRest/rest/hello/abcd 
```

com.sun.jersey.api.container.ContainerException：ResourceConfig 实例不包含任何根资源类。

我查看了互联网上的各种来源，他们说发生异常是因为 web.xml 中给出的包结构中没有类，但我确保它们都是正确的。

非常感谢您对此的任何帮助。

以下是 pom.xml 的代码

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
      <modelVersion>4.0.0</modelVersion>
      <groupId>my.test.rest</groupId>
      <artifactId>TestRest</artifactId>
      <packaging>war</packaging>
      <version>0.0.1-SNAPSHOT</version>
      <name>TestRest Maven Webapp</name>
      <url>http://maven.apache.org</url>
      <repositories>
                <repository>
                <id>maven2-repository.java.net</id>
                <name>Java.net Repository for Maven</name>
                <url>http://download.java.net/maven/2/</url>
                <layout>default</layout>
        </repository>
  </repositories>
  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>test</scope>
    </dependency>
    <dependency>
            <groupId>com.sun.jersey</groupId>
            <artifactId>jersey-server</artifactId>
            <version>1.8</version>
    </dependency>
  </dependencies>
  <build>
    <finalName>TestRest</finalName>
  </build>
</project> 
```

这是简单的 HelloWorldService。

```
package com.rest;

import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.PathParam;
import javax.ws.rs.core.Response;

@Path("/hello")
public class HelloWorldService {

    @GET
    @Path("/{param}")
    public Response getMsg(@PathParam("param") String msg) {

        String output = "Hello, " + msg;

        return Response.status(200).entity(output).build();

    }

} 
```

最后，web.xml

```
<web-app id="WebApp_ID" version="2.4"
    xmlns="http://java.sun.com/xml/ns/j2ee" 
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee 
    http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd">
    <display-name>Restful Web Application</display-name>

    <servlet>
        <servlet-name>HelloServlet</servlet-name>
        <servlet-class>
                     com.sun.jersey.spi.container.servlet.ServletContainer
                </servlet-class>
        <init-param>
             <param-name>com.sun.jersey.config.property.packages</param-name>
             <param-value>com.rest</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>HelloServlet</servlet-name>
        <url-pattern>/rest/*</url-pattern>
    </servlet-mapping>

</web-app> 
```

我希望我的目录结构也是正确的，如果不是，请纠正我。

![目录结构](../Images/39c41a88248ebe7fe72d95b1f1792e55.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-08T17:36:38.097

您在错误的源文件夹中有 HelloWorldService.java。它必须在 src/main/java中，**而不是**在 src/main/resources 中。这是一个很大很大的不同！

这意味着您的 Java 代码尚未编译，这就是您收到错误的原因。没有可以处理请求的类。

看看[Maven 标准目录布局](http://maven.apache.org/guides/introduction/introduction-to-the-standard-directory-layout.html)。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-18T06:13:57.023

是的，在使用 Maven 在 Java 中开发 RESTful Web 服务时，它在 Eclipse Indigo 中存在问题，因为它没有创建正确的目录结构。因此，删除给定的源目录并将源添加为 src/main/java 就像@maba 正确提到的那样是最好的解决方法。您可以参考这里以获取有关在 Eclipse Indigo 中使用 Maven 在 Java 中开发 RESTful Web 服务的详细说明...

[http://kausalmalladi.blogspot.in/2012/11/developing-restful-java-web-service-in.html](http://kausalmalladi.blogspot.in/2012/11/developing-restful-java-web-service-in.html)

# c# - 如何跨两个函数串一个值？

> ID：13293796
> 
> 赞同：2
> 
> 时间：2012-11-08T16:54:16.857
> 
> 标签：c#, asp.net, .net, visual-studio-2010, .net-4.0

我是 C# 世界的新手，所以放轻松！:]

我什至不确定我使用的术语是否正确。我认为这将是一个简单的谷歌搜索，但恐怕我的措辞可能不正确。

我正在从数据库中收集数据。像这样：

```
 SqlConnection mySqlConnection = new SqlConnection(strings.settings.connectionString);
        SqlCommand mySqlCommand = mySqlConnection.CreateCommand();
        mySqlCommand.CommandText = "SELECT FNAME, LNAME, ZIPCODE FROM database WHERE ID = @ID";

        mySqlCommand.Parameters.Add("@ID", SqlDbType.Char).Value = txtID.Text;
        mySqlConnection.Open();
        SqlDataReader mySqlDataReader = mySqlCommand.ExecuteReader(CommandBehavior.SingleRow);

        if (mySqlDataReader.HasRows == false)
        {
            throw new Exception();
        }

        if (mySqlDataReader.Read())
        {
            txtFname.Text = mySqlDataReader[0].ToString();
            txtLname.Text = mySqlDataReader[1].ToString();
            lblZipcode.Text = mySqlDataReader[2].ToString(); 
            //need help on stringing the value ZIPCODE above.  
        } 
```

我的问题是：如何将 Zipcode 值串到另一个函数？我一直在尝试像

```
 string Zipcode = mySqlDataReader[2].ToString(); 
```

但我一直在试图弄清楚如何将该值串起来，以便可以在不同的函数中使用它，如下所示：

```
 private void GetZipData()
 {
   //Get that value
 } 
```

任何帮助或正确方向的观点将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T17:00:27.620

要么我误解了这个问题，要么你的方法根本上是错误的。首先，你`GetZipData()`正在返回`void`，所以是一个子例程，而不是一个函数。更好的是，将其称为一种方法，因为它涵盖了 subs 和 funcs...

您可以像这样传递参数...

```
public void GetZipData(String SomeInputString) {
    ///Do something
} 
```

你可以从这样的函数中返回东西......

```
public String GetZipData() {
    return "Some String";
} 
```

我怀疑您想要做的是从数据阅读器获取单个邮政编码或邮政编码列表。就像是...

```
public String GetZipData(Integer Id) {
    //All your MySQL Code here
    return mySqlDataReader[2].ToString();
} 
```

那么你可以简单地这样称呼它......

```
String TheZipCode = GetZipData(123); 
```

当然，你也可以考虑做其他事情——比如创建一个类来代表客户并返回它而不是字符串——然后你可以在一次 Db 之旅中获得所有信息......

```
class Person {
    String Firstname;
    String Lastname;
    String ZipCode;
}

public Person GetPersonData(Integer Id) {
    //All your MySQL Code here
    Person ReturnData = new Person();

    ReturnData.Firstname = mySqlDataReader[0].ToString();
    ReturnData.Lastname = mySqlDataReader[1].ToString();
    ReturnData.ZipCode = mySqlDataReader[2].ToString();

    return ReturnData;
} 
```

那你就有...

```
Person person = GetPersonData(12);
//You can now use person.Firstname, person.ZipCode, etc... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T16:58:58.953

将此方法更改为

```
private string GetZipData()
 {
   string Zipcode = mySqlDataReader[2] as String;
   return Zipcode;
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:10:04.800

我不确定您要达到的目标。如果要将 zip 字符串传递给另一个方法，可以向该方法添加一个字符串参数

```
private void DoSomethingWithZipCode(string zipCode)
{
    Console.WriteLine(zipCode);
} 
```

如果要返回取决于邮政编码的另一个值，则还需要返回类型

```
private string GetCity(string zipCode)
{
    string city = <get city from database>;
    return city;
} 
```

或者在你的情况下

```
private string GetZipData(SqlDataReader dataReader)
{
    return dataReader[2].ToString(); 
} 
```

你会这样称呼它

```
lblZipcode.Text = GetZipData(mySqlDataReader); 
```

您还可以编写扩展方法。您必须将此方法放在一个静态类中，该类的命名空间在您使用它的地方可用

```
public static string ZipData(this SqlDataReader dataReader)
{
    return dataReader[2].ToString(); 
} 
```

你可以这样称呼它

```
lblZipcode.Text = mySqlDataReader.ZipData(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-08T21:12:08.050

```
string Zipcode = mySqlDataReader[2].ToString();

private void GetZipData(string yourInput)
{
   //do your stuff with yourInput
} 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-08T17:00:05.780

如果您的顶级数据访问代码在其自己的方法中，您可以从那里“返回”它，然后从新值调用您的数据访问方法，见下文：

```
return ZipCode

private void GetZipData() {
var stry=DataCode();
} 
```

问候克雷格

# html - 如何将输入“文本”的高度和跨度设置为相同的值

> ID：13293801
> 
> 赞同：2
> 
> 时间：2012-11-08T16:54:41.453
> 
> 标签：html, css

我在同一行上有一个输入文本和一个跨度。
在Firefox中，它们没有相同的高度。
在我看来，跨度的高度最低。
输入文本和跨度具有相同高度的最佳方法是什么？

```
<div class="form">
    <input type="text" required="required" class="data-item">
    <span class="add-on">Orders</span>
</div>​ 
```

演示：http: [//jsfiddle.net/BeLDD/7](http://jsfiddle.net/BeLDD/7)

PS：不要写可能的重复，[`How to make <span> the same height as <input type=“text”&gt;`](https://stackoverflow.com/questions/4210994/how-to-make-span-the-same-height-as-input-type-text)因为我不需要垂直对齐到中间的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T16:58:16.583

输入标签的总高度包括它的边框和内边距。不幸的是，这些默认值因浏览器而异。

使用 CSS 显式设置跨度和输入的边距、边框和填充（以及字体大小），直到它们达到所需的大小。由于输入有边框而您的跨度（可能）没有，您需要根据您的设计单独进行这些调整。

# java - SHA-1 哈希如何在 Android 上的 Java 上运行

> ID：13293802
> 
> 赞同：0
> 
> 时间：2012-11-08T16:54:45.107
> 
> 标签：java, android, hash, sha1

我四处搜索如何对设备标识符进行哈希处理，并偶然发现了以下代码。

我真的不明白它在做什么。

1.  为什么我需要对设备 ID 进行 urlEncode 编码？
2.  为什么我需要散列字节，我不能只在 String 上这样做吗？
3.  为什么我需要将其转换为 BigInteger ？
4.  为什么我需要移动位以获取带有散列 id 的字符串？

谁能逐行解释发生了什么？我希望这也能帮助其他人理解这个在博客和论坛中传播的片段。

```
String hashedId = "";

String deviceId = urlEncode(Secure.getString(context.getContentResolver(), Secure.ANDROID_ID));

try {
    MessageDigest digest = MessageDigest.getInstance("SHA-1");

    byte bytes[] = digest.digest(deviceId.getBytes());

    BigInteger b = new BigInteger(1, bytes);
    hashedId = String.format("%0" + (bytes.length << 1) + "x", b);

} catch (NoSuchAlgorithmException e) {
    //ignored
}

return hashedId; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T17:34:38.210

为什么我需要对设备 ID 进行 urlEncode 编码？

> 为什么我需要散列字节，我不能只在 String 上这样做吗？

大多数散列算法，包括 SHA-1，都使用二进制数据作为输入（即字节）。字符串本身没有特定的二进制表示；它根据编码而变化。

他们提供的代码行使用默认编码，这有点脆弱。我希望看到类似的东西

```
byte bytes[] = digest.digest(deviceId.getBytes(Charset.forName("UTF-8"))); 
```

> 为什么我需要将其转换为 BigInteger ？

这是为了方便帮助转换为十六进制表示。

> 为什么我需要移动位以获取带有散列 id 的字符串？

正在使用的格式 String 是`%0Nx`，这会导致字符串被零填充到`N`字符。由于十六进制表示一个字节需要两个字符，因此`N`是`bytes*2`，结果为`bytes << 1`。

我真的不明白你为什么不只包含[适用于 Android 的 Guava](http://code.google.com/p/guava-libraries/wiki/Compatibility)并使用[`Hashing`构建器](http://docs.guava-libraries.googlecode.com/git/javadoc/src-html/com/google/common/hash/Hashing.html#line.40)：

```
String hash = Hashing.sha1().hashString(deviceId, Charsets.UTF_8).toString(); 
```

这是一行，不会抛出检查异常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:27:19.323

关于位移：左移1相当于乘以2。字符串中的每个字节由2个十六进制字符表示，因此生成的字符串将是哈希中字节数的两倍。

这将创建一个类似于 的格式字符串，`%032x`它将一个整数值打印为一个零填充的 32 个字符的字符串。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T17:31:44.310

您需要散列字节而不是字符串，以便散列**字符数据**而不是`String`对象，这对于给定的字符序列可能具有不可预测的内部状态。

它被转换为 BigInteger，因此它可以一致地格式化为每字节两个十六进制数字。（这就是为什么左移时长度乘以 2。）

基本上，您所有问题的答案都是：**即使在不同的平台上，您也可以获得可靠、可重复的结果**。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-01-27T09:12:24.710

您也可以使用此代码：

```
 public class sha1Calculate {

        public static void main(String[] args)throws Exception
        {
             File file = new File("D:\\Android Links.txt");
            String outputTxt= "";
            String hashcode = null;

            try {

                FileInputStream input = new FileInputStream(file);

                ByteArrayOutputStream output = new ByteArrayOutputStream ();
                byte [] buffer = new byte [65536];
                int l;

                while ((l = input.read (buffer)) > 0)
                    output.write (buffer, 0, l);

                input.close ();
                output.close ();

                byte [] data = output.toByteArray ();

                    MessageDigest digest = MessageDigest.getInstance( "SHA-1" ); 

                byte[] bytes = data;

                digest.update(bytes, 0, bytes.length);
                bytes = digest.digest();

                StringBuilder sb = new StringBuilder();

                for( byte b : bytes )
                {
                    sb.append( String.format("%02X", b) );
                }

                    System.out.println("Digest(in hex format):: " + sb.toString());

            }catch (FileNotFoundException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (NoSuchAlgorithmException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

        } 
```

# ruby - OSX上的ruby bcrypt安装错误

> ID：13293804
> 
> 赞同：1
> 
> 时间：2012-11-08T16:54:52.750
> 
> 标签：ruby, bcrypt

我试图执行'sudo gem install bcrypt-ruby'

并得到以下错误：

> 构建原生扩展。这可能需要一段时间...
> 
> 错误：安装 bcrypt-ruby 时出错：
> 
> 错误：无法构建 gem 原生扩展。
> 
> /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby extconf.rb mkmf.rb 在 /System/Library/Frameworks/Ruby.framework/Versions/1.8/ 找不到 ruby​​ 的头文件usr/lib/ruby/ruby.h
> 
> Gem 文件将继续安装在 /Library/Ruby/Gems/1.8/gems/bcrypt-ruby-3.0.1 中以供检查。结果记录到 /Library/Ruby/Gems/1.8/gems/bcrypt-ruby-3.0.1/ext/mri/gem_make.out

我正在使用 ruby​​ 1.8.7 和 xcode 4.5.2 运行 osx lion

（谢谢你帮助我）

# python-2.7 - pySerial 无法打开端口 COM6：找不到元素

> ID：13293805
> 
> 赞同：1
> 
> 时间：2012-11-08T16:54:54.357
> 
> 标签：python-2.7, pyserial

我尝试使用以下代码：

```
 import serial
    ser = serial.Serial()
    ser.baudrate = 56700
    ser.port = 'COM6'
    ser.open() # HERE IS THE ERROR 
```

当我从 Python shell 中逐行输入时，它可以工作，并且我可以从蓝牙设备接收数据。但是当我从 cmd (C:\>python serial.py) 运行它时，它会引发错误“无法打开端口 COM6：找不到元素”。我可以在蓝牙设备中看到它连接一秒钟然后断开连接。有谁知道这是什么吗？顺便说一句，我使用的是 Windows 7 64 位和 Python 2.7。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T20:26:32.340

也许您忘记以管理员身份运行命令提示符？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-06T21:01:14.763

我有同样的问题。`time.sleep(5)`我通过添加around 来修复它`ser.open()`。所以它看起来像这样：

```
import serial
import time
ser = serial.Serial()
ser.baudrate = 56700
ser.port = 'COM6'
time.sleep(5)
ser.open()
time.sleep(5) 
```

我没有对代码进行太多实验，但你可能不必睡 5 秒，你可能只需睡 0.1 秒，它仍然可以工作。这可能不是修复它的最佳方法，但它确实有效。

# php - preg_match 将一个单词一分为二，将最后一个字符作为捕获的组返回

> ID：13293807
> 
> 赞同：0
> 
> 时间：2012-11-08T16:54:55.290
> 
> 标签：php, regex

这是我的模式：

```
$fullname = '/^([a-zA-Z]+)(?:[,]?[\s]?)?([a-zA-Z]+)((?:\s)([a-zA-Z]{1}))?$/i'; 
```

我`preg_match($nameReg, $value, $match)`在 PHP 中使用它。

我想捕获姓氏，然后是名字。由于我将使用 ajax 在我的 sql 语句中通过 LIKE 动态加载结果，因此我想从姓氏开始，而不是等待名字。

问题是，当我只输入姓氏（第一个单词）时，我将姓氏的最后一个字符作为捕获的组。

```
Array
(
    [0] => SMITH
    [1] => SMIT
    [2] => H
) 
```

我想得到

```
Array
(
    [0] => SMITH
    [1] => SMITH
) 
```

但我不明白这里发生了什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T16:58:45.767

那是因为您在第二个中至少需要一个字母`[a-zA-Z]+`。如果您将第二个捕获组设为可选，它应该可以工作：

```
/^([a-zA-Z]+)(?:[,]?[\s]?)?([a-zA-Z]+)?((?:\s)([a-zA-Z]{1}))?$/i 
```

但是，您正在使用不区分大小写的标志，但仍提供大写和小写变体。加号`{1}`总是多余的。最后，单字符字符类也是不必要的，虽然这可能是一个品味问题，但我认为它们只会帮助需要转义的空格和字符的可读性。这可以缩短：

```
/^([a-z]+)(?:,?\s?)?([a-z]+)?((?:\s)([a-z]))?$/i 
```

也许嵌套一些可选组也是一个好主意。例如，如果没有逗号或空格来分隔第二个名称，则没有理由允许使用第二个名称：

```
/^([a-z]+)(?:(?:,\s?|\s)([a-z]+)?)?(?:\s([a-z]))?$/i 
```

# python - 将 pandas 数据框列导入为字符串而不是 int

> ID：13293810
> 
> 赞同：123
> 
> 时间：2012-11-08T16:54:59.533
> 
> 标签：python, pandas, casting, type-conversion, dtype

我想将以下 csv 作为字符串而不是 int64 导入。Pandas read_csv 自动将其转换为 int64，但我需要此列作为字符串。

```
ID
00013007854817840016671868
00013007854817840016749251
00013007854817840016754630
00013007854817840016781876
00013007854817840017028824
00013007854817840017963235
00013007854817840018860166

df = read_csv('sample.csv')

df.ID
>>

0   -9223372036854775808
1   -9223372036854775808
2   -9223372036854775808
3   -9223372036854775808
4   -9223372036854775808
5   -9223372036854775808
6   -9223372036854775808
Name: ID 
```

不幸的是，使用转换器会产生相同的结果。

```
df = read_csv('sample.csv', converters={'ID': str})
df.ID
>>

0   -9223372036854775808
1   -9223372036854775808
2   -9223372036854775808
3   -9223372036854775808
4   -9223372036854775808
5   -9223372036854775808
6   -9223372036854775808
Name: ID 
```

* * *

## 回答 #1

> 赞同：193
> 
> 时间：2012-11-14T17:58:57.017

只是想重申这将适用于熊猫> = 0.9.1：

```
In [2]: read_csv('sample.csv', dtype={'ID': object})
Out[2]: 
                           ID
0  00013007854817840016671868
1  00013007854817840016749251
2  00013007854817840016754630
3  00013007854817840016781876
4  00013007854817840017028824
5  00013007854817840017963235
6  00013007854817840018860166 
```

我也在创建一个关于检测整数溢出的问题。

编辑：在此处查看解决方案：[https ://github.com/pydata/pandas/issues/2247](https://github.com/pydata/pandas/issues/2247)

更新，因为它可以帮助其他人：

要将**所有列**作为 str，可以这样做（来自评论）：

```
pd.read_csv('sample.csv', dtype = str) 
```

要将**大多数或选择性列**作为 str，可以这样做：

```
# lst of column names which needs to be string
lst_str_cols = ['prefix', 'serial']
# use dictionary comprehension to make dict of dtypes
dict_dtypes = {x : 'str'  for x in lst_str_cols}
# use dict on dtypes
pd.read_csv('sample.csv', dtype=dict_dtypes) 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-11-09T02:54:20.790

这可能不是最优雅的方式，但它可以完成工作。

```
In[1]: import numpy as np

In[2]: import pandas as pd

In[3]: df = pd.DataFrame(np.genfromtxt('/Users/spencerlyon2/Desktop/test.csv', dtype=str)[1:], columns=['ID'])

In[4]: df
Out[4]: 
                       ID
0  00013007854817840016671868
1  00013007854817840016749251
2  00013007854817840016754630
3  00013007854817840016781876
4  00013007854817840017028824
5  00013007854817840017963235
6  00013007854817840018860166 
```

只需替换`'/Users/spencerlyon2/Desktop/test.csv'`为您的文件的路径

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2020-04-14T03:03:23.910

自 pandas 1.0 以来，它变得更加简单。这会将列 'ID' 读取为 dtype 'string'：

```
pd.read_csv('sample.csv',dtype={'ID':'string'}) 
```

[正如我们在本入门指南](https://pandas.pydata.org/pandas-docs/stable/getting_started/basics.html#dtypes)中所见，'string' dtype 已被引入（在字符串被视为 dtype 'object' 之前）。

# cocos2d-iphone - IOS游戏中如何使用Lua作为数据存储？

> ID：13293818
> 
> 赞同：2
> 
> 时间：2012-11-08T16:55:24.790
> 
> 标签：cocos2d-iphone, lua, kobold2d

我在一些不同的 IOS 游戏中看到 Lua 脚本用于保存用户设置和数据。我自己不知道如何做到这一点，有人知道开源项目或如何实现这一目标的示例吗？

人们只是以编程方式重写 lua 脚本吗？或者 Lua 中有什么方法可以在 lua 脚本中重写或保存数据？我真的很困惑如何用 lua 实现这一点。请帮帮我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T19:03:31.037

> 人们只是以编程方式重写 lua 脚本吗？

是的，这真的很简单。您将设置数据或其他任何内容存储在表格中。然后使用简单的 Lua 代码将该表写入文件。您编写的文件是一个 Lua 脚本，执行时会*返回该表。*

所以你的脚本看起来像这样：

```
return
{
  setting = true,
  width = 640,
  height = 480,
} 
```

编写这种序列化所需的代码并不难编写（只要您没有直接或间接引用自身的表）。有[多种实现方式。](http://lua-users.org/wiki/TableSerialization)

# sql - 如何配置 Visual Basic 应用程序以连接到远程 sql 数据库

> ID：13293827
> 
> 赞同：0
> 
> 时间：2012-11-08T16:55:37.147
> 
> 标签：sql, database, visual-studio-2010

我刚刚创建了我的 Visual Basic 应用程序，它在我的系统上连接并使用 Sql 数据库。并且它工作正常。

我的愚蠢问题是当我将我的应用程序分发给我在 INTRANET/LAN 上的朋友时，我如何让他们与我系统上的 SQL 数据库通信。

如果这需要一些研究，请向我推荐要学习的主题和参考资料。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:59:08.220

您通常会在 app.config 文件中配置到数据库的连接字符串。

查看[connectionstring.com](http://www.connectionstrings.com/sql-server-2012)以了解您可以包含和/或配置的不同选项。

您还需要确保为您的朋友创建正确的帐户，并且运行 SQL 数据库的计算机将允许远程连接并打开防火墙。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:49:18.823

除非您和您的朋友在同一个 windows 域中，否则您将不得不关闭连接字符串中的集成安全性：

```
"Server=10.0.2.88\SQLEXPRESS;Database=PlaylistTEST;User Id=myUsername;Password=myPassword;" 
```

并为数据库创建登录名：

```
In MSSQL Server Management Studio, expand server ->  expand security -> 
right-click on logins -> new login -> 
  sql server authenication: enter user and password, then 
  user mapping -> check off database that they will access and select roles down below. 
```

并且很可能在 SQL Server 下启用混合登录：

```
In MSSQL Server Management Studio, Right-click on server -> Properties -> Security -> 
        Server Authentication -> SQL Server and Windows Authenication mode 
```

最后，可能启用 TCP/IP：

```
Programs -> MSSQL Server -> Configuration Tools -> SQL Server Configuration Manager -> 
         SQL Server Network Configuration -> Protocols for MSSQLSERVER -> 
         TCP/IP -> Right-click -> Enable 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-19T13:19:13.283

将连接字符串与数据库服务器的 IP 地址一起使用：

```
Public connectionString As String = "Data Source=169.254.90.176,1433;Initial Catalog=Dbname;User Id=username;Password=password;" 
```

# java - java 插入 Blob 作为 ByteArrayOutputStream 得到 ClassCastException

> ID：13293828
> 
> 赞同：0
> 
> 时间：2012-11-08T16:55:37.477
> 
> 标签：java, sql, casting, blob, bytearrayoutputstream

我必须将表示为 ByteArrayOutputStream 的 pdf 文件保存到表的 Blob SQL 字段中，这是我的代码：

```
public boolean savePDF(int version, ByteArrayOutputStream baos) throws Exception{
    boolean completed = false;
    ConnectionManager conn = new ConnectionManager();
    try {
        PreparedStatement statement = conn.getConnection().prepareStatement(INSERT_PDF);
        statement.setLong(1, version);
        statement.setBlob(2, (Blob)baos);           
        statement.execute();
        conn.commit();
        completed = true;
    } catch (SQLException e) {
        conn.rollbackQuietly();
        e.printStackTrace();
        throw e;
    } catch (ClassNotFoundException e) {
        e.printStackTrace();
    }finally{
        conn.close();
    }                           
    return completed;       
} 
```

但我得到一个 java.lang.ClassCastException：

```
java.io.ByteArrayOutputStream cannot be cast to java.sql.Blob 
```

我该如何管理？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:02:40.510

你不能投射`ByteArrayOutputStream` 到`Blob`. 尝试`Blob`如下创建实例：

```
 SerialBlob blob = new SerialBlob(baos.toByteArray()); 
```

接着

```
 statement.setBlob(2, blob); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T17:01:55.360

有一个`setBlob`需要一个`InputStream`，所以

```
ByteArrayInputStream bais = new ByteArrayInputStream(baos.toByteArray());
statement.setBlob(2, bais); 
```

# google-app-engine - 具有有效电子邮件的 AppEngine 用户服务的用户构造函数返回没有 user_id 的用户

> ID：13293834
> 
> 赞同：1
> 
> 时间：2012-11-08T16:55:51.890
> 
> 标签：google-app-engine

我在阅读 AppEngine 用户服务文档[https://developers.google.com/appengine/docs/python/users/userobjects](https://developers.google.com/appengine/docs/python/users/userobjects)时的理解是，如果我们使用有效的电子邮件地址初始化用户，则创建的用户应该具有有效的 user_id。但是，当我尝试这段代码时

```
from google.appengine.api import users

user = users.User('valid_email@gmail.com')
print user.user_id() 
```

在开发服务器和真实的 AppEngine 环境中，我总是得到

```
None 
```

这是一个错误吗？还是我误解了文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:04:03.770

如果像上面那样实例化对象，它实际上会返回`None`. 根据[文档](https://developers.google.com/appengine/docs/python/users/userclass#User_user_id)：

> 注意：如果您的应用程序构造了 User 实例，API 将不会为 user_id 设置值并返回 None

为了使用该`user_id`方法，我建议使用该`user = users.get_current_user()`结构，如果用户未登录，则允许他们使用其 Google 帐户进行身份验证。例如：

```
user = users.get_current_user()
if user:
    self.response.out.write(user.user_id())
else:
    self.response.out.write(
        "<a href=\"%s\">Sign in</a>." % users.create_login_url("/")) 
```

您可以在文档中找到类似的示例，但经过身份验证后，您将能够访问该`user_id`方法。

# python - Blender：分段，故障核心转储？

> ID：13293835
> 
> 赞同：1
> 
> 时间：2012-11-08T16:55:53.153
> 
> 标签：python, segmentation-fault, blender, gimp, gimpfu

**这是我正在尝试创建的附加组件：**

```
import bpy
import os
import sys
import subprocess
import time
from threading import * 

class Repeat(Thread):
    def __init__(self,delay,function,*args,**kwargs):
        Thread.__init__(self)
        self.abort = Event()
        self.delay = delay
        self.args = args
        self.kwargs = kwargs
        self.function = function
    def stop(self):
        self.abort.set()
    def run(self):
        while not self.abort.isSet():
            self.function(*self.args,**self.kwargs)
            self.abort.wait(self.delay)

class ExportToGIMP(bpy.types.Operator):
    bl_idname = "uv.exporttogimp"
    bl_label = "Export to GIMP"

    def execute(self, context):
        f = open("/home/antoni4040/blender.txt", "w").close() 
        self.filepath = os.path.join(os.path.dirname(bpy.data.filepath), "Layout")
        bpy.ops.uv.export_layout(filepath=self.filepath, check_existing=True, export_all=False, modified=False, mode='PNG', size=(1024, 1024), opacity=0.25, tessellated=False)
        self.files = os.path.dirname(bpy.data.filepath)
        cmd = " (python-fu-bgsync RUN-NONINTERACTIVE)"
        subprocess.Popen(['gimp', '-b', cmd])
        file = Repeat(3, self.up)
        file.start()
        return {'FINISHED'};

    def doit(self):
        r = Repeat(3, self.update)
        r.start()

    def up(self):
        f = open("/home/antoni4040/blender.txt", "r")
        string = f.read()
        if "ok" in string:
            self.materialize()
            self.doit()
            file.stop()
        else:
            pass     

    def update(self):
        self.layout_texture.image.reload()
        for area in bpy.data.screens['Default'].areas:
            if area.type in ['IMAGE_EDITOR', 'VIEW_3D']:
                area.tag_redraw()

    def materialize(self):
        self.layout_texture = bpy.data.textures.new(name = "Layout_Texture", type = "IMAGE")
        self.material = bpy.data.materials.new(name="Layout")
        self.object = bpy.context.active_object
        self.material_texture = self.material.texture_slots.add()
        self.material_texture.texture = self.layout_texture
        self.material_texture.texture_coords = "UV"
        self.filepath2 = "/home/antoni4040/Έγγραφα/Layout1.png"
        self.texture_image = bpy.data.images.load(self.filepath2)                       
        self.layout_texture.image = self.texture_image
        self.con_obj = self.object.data
        self.con_obj.materials.append(self.material)
        bpy.data.screens['UV Editing'].areas[1].spaces[0].image = self.texture_image

def exporttogimp_menu(self, context):
    self.layout.operator(ExportToGIMP.bl_idname, text="Export To GIMP")

bpy.utils.register_class(ExportToGIMP)
bpy.types.IMAGE_MT_uvs.append(exporttogimp_menu) 
```

**与此一起使用：**

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

from gimpfu import *
import time
import sys  

def blender_gimp_sync():
    im_dir = "/home/antoni4040/Έγγραφα/Layout.png"
    image = gimp.pdb.gimp_file_load(im_dir, im_dir)
    gimp.Display(image)
    layer = gimp.pdb.gimp_layer_new(image, 1024, 1024, RGBA_IMAGE, "PaintHere", 100.0, NORMAL_MODE) 
    image.add_layer(layer)
    drawable = pdb.gimp_image_get_active_layer(image)
    num = 1
    while True:
        time.sleep(3.0)
        if image is not None:  
            ims_dir = "/home/antoni4040/Έγγραφα/Layout1.png"
            gimp.pdb.file_png_save(image, drawable, ims_dir, ims_dir, 0, 0, 0, 0, 0, 0, 0)
            f = open("/home/antoni4040/blender.txt", "w")
            f.write("ok")
        else:
            pass

register(
    "python_fu_bgsync",
    "Blender-Gimp Sync",
    "Syncronize Gimp with Blender for texturing",
    "Antonis Karvelas",
    "Antonis Karvelas",
    "2012",
    "Sync",
    "",
    [],
    [],
    blender_gimp_sync,
    menu="<Image>/Image/Blender-Gimp"
)   
main() 
```

**但是，我总是收到分段错误错误......为什么会这样？我做错了什么？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-25T07:18:56.947

**好吧，你可以在代码模板中找到它作为“Operator Modal Timer”，它显示了如何在 Blender 中连续做事：**

```
import bpy

class ModalTimerOperator(bpy.types.Operator):
    """Operator which runs its self from a timer"""
    bl_idname = "wm.modal_timer_operator"
    bl_label = "Modal Timer Operator"

    _timer = None

    def modal(self, context, event):
        if event.type == 'ESC':
            return self.cancel(context)

        if event.type == 'TIMER':
            # change theme color, silly!
            color = context.user_preferences.themes[0].view_3d.space.back
            color.s = 1.0
            color.h += 0.01

        return {'PASS_THROUGH'}

    def execute(self, context):
        self._timer = context.window_manager.event_timer_add(0.1, context.window)
        context.window_manager.modal_handler_add(self)
        return {'RUNNING_MODAL'}

    def cancel(self, context):
        context.window_manager.event_timer_remove(self._timer)
        return {'CANCELLED'}

def register():
    bpy.utils.register_class(ModalTimerOperator)

def unregister():
    bpy.utils.unregister_class(ModalTimerOperator)

if __name__ == "__main__":
    register()

    # test call
    bpy.ops.wm.modal_timer_operator() 
```

# java - 更改现有 JDialog 的模式

> ID：13293836
> 
> 赞同：0
> 
> 时间：2012-11-08T16:55:54.450
> 
> 标签：java, swing, jdialog, modality

我正在集成一个小程序，我需要破解其中一个对话框并更改其模式。

我的问题是我不懂 Swing，而且我的尝试在实践中没有效果。

当前实施：

```
dialog.setModalExclusionType(ModalExclusionType.TOOLKIT_EXCLUDE);
dialog.repaint(); 
```

也试过

```
dialog.setModal(false); 
```

所以有我的问题。如何动态更改现有 JDialog 的模态？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:24:20.467

不知道你想做什么......但也许你可以从这里得到一些东西

```
 public class Mainz extends JFrame implements ActionListener{
                JButton showDialog = new JButton("show dialog");

                public Mainz() {
                    setLayout(new FlowLayout());
                    showDialog.addActionListener(this);
                    add(showDialog);
                    setSize(200, 300);
                    setVisible(true);   
                }
                @Override
                public void actionPerformed(ActionEvent e) {
                    new Dialogz(this, false);
                    setEnabled(false);
                }

                public static void main(String[]args){
                    new Mainz();
            }
            }
            class Dialogz extends JDialog{
                JButton close = new JButton("close");

                public Dialogz(JFrame owner,boolean modal) {
                    super(owner, modal);
                    setSize(100, 200);
                    add(close);
                    setLocationRelativeTo(owner);
                    setVisible(true);

                    close.addActionListener(new ActionListener() {
                        public void actionPerformed(ActionEvent ae){
                            closez();
                        }
                    });
                } 

                void closez(){
                    setModalExclusionType(ModalExclusionType.APPLICATION_EXCLUDE);
                    System.out.println("modal exclusion befor = "+getModalExclusionType());
                    setModalExclusionType(ModalExclusionType.NO_EXCLUDE);
                    System.out.println("modal exclusion after = "+getModalExclusionType());

                    System.out.println("modality before ="+getModalityType());
                    setModal(true);
                    System.out.println("modality  after ="+getModalityType());
                    getOwner().setEnabled(true);
                    Dialogz.this.dispose();
                }
            } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-14T21:44:51.043

要更改您的对话框是模态的还是无模态的，请使用[`setModalityType`](http://docs.oracle.com/javase/6/docs/api/java/awt/Dialog.html#setModalityType%28java.awt.Dialog.ModalityType%29)方法。

*   呼叫时[`setModal(true)`](http://docs.oracle.com/javase/6/docs/api/java/awt/Dialog.html#setModal%28boolean%29)，模态类型与呼叫相同`setModalityType(Dialog.DEFAULT_MODALITY_TYPE)`。默认值为[`ModalityType.APPLICATION_MODAL`](http://docs.oracle.com/javase/6/docs/api/java/awt/Dialog.ModalityType.html#APPLICATION_MODAL)。
*   当您呼叫时`setModal(false)`，模态类型设置为[`ModalityType.MODELESS`](http://docs.oracle.com/javase/6/docs/api/java/awt/Dialog.ModalityType.html#MODELESS)。

当您更改其模式时，该对话框应该不可见。否则，直到对话框被隐藏然后再次显示时才会生效。

此外，必须对对话框本身进行编程以支持不同的模态模式。

*   当您使用模式对话框时，与所有者窗口（以及可能与其他应用程序窗口）的交互被阻止。因此，您显示对话框，`dialog.setVisible(true)`并且此方法在对话框关闭之前不会返回。然后使用对话框中的数据。
    典型的模式对话框是打开文件：应用程序在知道要加载哪个文件之前无法继续。
*   在无模式对话框的情况下，该方法`dialog.setVisible(true)`立即返回（在屏幕上显示对话框之后）。在对话框中按下按钮通常会对其他窗口和对话框产生一些影响。您可以在显示对话框时与应用程序的其他窗口进行交互。
    例如，典型的“查找”对话框会在主窗口中选择一个搜索字符串。您可以返回主窗口，更改文本，然后再次单击查找，依此类推。

* * *

如果您需要更多帮助，我可以向您展示一个带有对话框的工作示例，该示例可以在两种模式下工作：模态和非模态。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-16T16:31:39.797

一个黑客黑客：

您可以通过调用私有方法来更改现有对话框的模式：

```
java.awt.Dialog.hideAndDisposePreHandler(); 
```

调用这个私有方法——例如：

```
private void executeMethod(final Class<?> clazz, final String methodName, final Object instance)
{
    final Method method =
        Iterables.getOnlyElement(Iterables.filter(
            Arrays.asList(clazz.getDeclaredMethods()), new Predicate<Method>()
            {
                public boolean apply(final Method method)
                {
                    return method.getName().equals(methodName);
                }
            }));

    method.setAccessible(true);
    try
    {
        method.invoke(instance);
    }
    catch (IllegalAccessException | IllegalArgumentException | InvocationTargetException e)
    {
        throw Throwables.propagate(e);
    }
} 
```

（此代码需要番石榴）

最后称之为：

```
final Dialog myDialog = ...;

executeMethod(Dialog.class, "hideAndDisposePreHandler", myDialog); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T17:19:31.383

我猜你还没有获得`AWTPermission.toolkitModality`你的小程序的许可。

另一个问题可能是您的平台不支持排除类型 - 您可以使用`Toolkit.isModalExclusionTypeSupported(java.awt.Dialog.ModalExclusionType)`.

# php - a="$b" 和 $b="value" 的 a="value" 有什么区别？

> ID：13293838
> 
> 赞同：0
> 
> 时间：2012-11-08T16:56:01.687
> 
> 标签：php, ldap, variable-assignment

我正在用 PHP 进行一些 LDAP 开发，并且在 PHP 中遇到了某种可能是新手的值分配。

我的问题特定于 LDAP_MODIFY，但可能是一般问题。我正在尝试更新一个属性，但以下属性给了我一个未找到属性的错误：

```
$email = 'Whitegon024@thedomain.org';
$attributes   = array( "userPrincipleName" => "$email"); 
```

但以下是成功的：

```
$attributes = array( "userPrincipalName" => 'Whitegon024@thedomain.org') ; 
```

如果我做`print_r($attributes);`任何一个，我会得到：

```
Array
(
    [userPrincipleName] => Whitegon024@thedomain.org
) 
```

有人有线索吗？我敢肯定这是非常简单的事情。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-08T16:58:32.910

您在第一次尝试中将 principal 拼错为原则……这与您分配变量的方式无关。

澄清 -`attribute not found`并不意味着它看到索引的空值`userPrincipalName`- LDAP 服务器说索引`userPrincipleName`本身不作为主体 LDAP 记录的属性存在。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T16:59:09.620

PHP 正在为变量解析双引号字符串。如果您不想解析，请使用单引号字符串。此外，即使您使用的是双引号字符串，也请`{$var}`使用`$var`. 因此，您还可以解析数组`{$someArray['someIndex']}`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T16:59:53.390

更改`$attributes = array( "userPrincipleName" => "$email");`为`$attributes = array( "userPrincipleName" => $email);`

# iphone - iOS 自定义 TabBar 高度

> ID：13293839
> 
> 赞同：2
> 
> 时间：2012-11-08T16:56:08.113
> 
> 标签：iphone, ios, ipad, ios5, uitabbarcontroller

设置`TabBar`高度的最简单方法是什么？

`ViewControllers`我虽然只是添加一个带有按钮的工具栏，但是如果不是模态的，我该如何导航呢？我想复制确切的`TabBarController`行为，但使用自定义高度和按钮。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-08T17:01:16.703

您不能更改 tabBar 的大小。你必须自己动手。看看容器 UIViewControllers [http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/doc/uid/TP40006926-CH3-SW81)

本质上，您将创建自己的 TabBarController，在底部有您自己的 tabBar，并且您将拥有子视图控制器，您将在按下按钮时显示它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:27:29.307

TabBar的默认值`height`是常量，由 Apple 定义，因此您无法更改它。您应该创建一个自定义容器控制器。看看这个[可可控件](http://www.cocoacontrols.com/)上的自定义[控制器](http://www.cocoacontrols.com/platforms/ios/controls/mhtabbarcontroller)，他们的自定义控制器很容易理解。也可以查看官方文档，了解如何创建[自定义视图控制器](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html)。

# .net - 通过 vlc 播放带字幕的视频

> ID：13293842
> 
> 赞同：2
> 
> 时间：2012-11-08T16:56:20.233
> 
> 标签：.net, vb.net, winforms, vlc

我试图通过 vlc 播放视频和字幕。

我的代码：

```
Process.Start("path to vlc", "videofile.avi, subtitles.srt") 
```

不工作。

什么是正确的方法？

解决方案：

```
Process.Start("C:\Program Files (x86)\VideoLAN\VLC\vlc.exe", "file:///C:/P2.avi --sub-file=file:///C:/123.srt") 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T16:59:23.537

尝试

```
Process.Start("path to VLC", "videofile.avi --sub-file=subtitles.srt"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-26T19:19:15.897

[此处](https://github.com/ZeBobo5/Vlc.DotNet/issues/543#issuecomment-478665591)显示的解决方案适用于我：

将字幕文件设置为“SetMedia()”方法的选项。请注意，使用`new string[] { @"sub-file=your subtitle file address}`

# batch-file - 在 SQL Server 代理作业的路径中使用带空格的参数调用批处理文件

> ID：13293843
> 
> 赞同：1
> 
> 时间：2012-11-08T16:56:29.453
> 
> 标签：batch-file, parameter-passing, syntax-error, execution

我在 SQL Server 代理作业步骤中从以下位置运行批处理文件：

```
"D:\Program Files\Cincom\Control\2212\Prd\Dcls\DEV1-MIKE1_RUN_Batch_JOB" 
```

我想传入一个参数来运行一个 IF 语句。但是，当我这样做时：

```
"D:\Program Files\MyProgram\Dcls\DEV1-MIKE1_RUN_Batch_JOB 1" 
```

我收到**“不被识别为内部或外部命令、可运行程序或批处理文件”**错误

同样的事情：

```
"D:\Program Files\MyProgram\Dcls\DEV1-MIKE1_RUN_Batch_JOB '1'" 
```

和：

```
"D:\Program Files\MyProgram\Dcls\DEV1-MIKE1_RUN_Batch_JOB "1" " 
```

我需要传递参数，并且需要从给定位置运行批处理文件。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:05:48.947

用引号将批处理文件完整路径括起来，然后指定批处理文件的参数：

`"D:\Program Files\MyProgram\Dcls\DEV1-MIKE1_RUN_Batch_JOB" 1`

# reporting-services - 根据 SSRS 报告 2008 中的其他字段值将字段设为粗体

> ID：13293853
> 
> 赞同：0
> 
> 时间：2012-11-08T16:57:04.740
> 
> 标签：reporting-services

为了满足我的期望，我在 fontweight 表达式和字段值表达式中尝试了这段代码

```
=iif(fields!RATE_SELECTED="A","BOLD","NORMAL") 
```

我最终有一个例外

错误 BC30518：重载解析失败，因为无法使用这些参数调用可访问的“=”

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T04:38:09.507

你缺少`.Value`表达。它应该是：

`=iif(Fields!RATE_SELECTED.Value="A","Bold","Normal")`

此外，它应该`"Bold","Normal"`代替 "BOLD","NORMAL"
并且*由于一些 SSRS 错误*，如果你尝试这个，它仍然不起作用，那么*诀窍*是：

尝试首先清除以前的值，然后单击`OK >> OK`直到您再次到达*报表设计器屏幕*。

从这里，再次*右键单击*您的报告项目，例如*TextBox*（*粗体附近*`right click >>TextBox properties >>Font>> fx`） ，然后当您在这里时，不要手动编写完整的表达式，只编写然后单击[见图] 并选择，类似地单击并双击**粗体，**然后是**Normal** 然后，通过您的手动编辑，最终表达式应该是 *![在此处输入图像描述](../Images/19693e4c773a5671a710349a40131eb3.png)

`=iif(`*`Fields`*`RATE_SELECTED`*`Constants`* ****`=iif(Fields!RATE_SELECTED.Value="A","Bold","Normal")`*****

 *****高温高压*****

# google-apps-script - 每次运行脚本时，脚本执行时间都会有所不同

> ID：13293856
> 
> 赞同：0
> 
> 时间：2012-11-08T16:57:29.687
> 
> 标签：google-apps-script, google-sheets

每次我运行我的脚本时，它的执行时间都与上次运行有很大不同。该脚本正在对约 500 行样本表执行一些自定义验证。执行时间从 7 秒到 300 秒不等。有趣的事实是，这 300 秒超过 5 分钟（我相信这是官方限制，是吗？）。

任何人都可以尝试帮助我理解这种行为吗？提前致谢， Łukasz

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:57:09.900

5 分钟不，您的脚本将在 6 分钟后超时。

你可以发布代码吗？所以我可以更好地理解你想要达到的目标。

当在同一个样本表上运行脚本时，您获得的不同执行时间是否总是不同的，包含相同的数据？还是仅当样本表数据不同时执行时间才会有所不同？

您的脚本正在执行的自定义验证是否会在您每次运行脚本时发生变化？

# jenkins - 詹金斯：如何将每个 scm 更改的新工作放入构建队列？

> ID：13293859
> 
> 赞同：1
> 
> 时间：2012-11-08T16:57:37.657
> 
> 标签：jenkins, continuous-integration, polling

我正在使用 Jenkins 进行连续集成。

我配置了一个作业，它轮询 scm 的更改。我有一个执行人。当有多个 scm-change，但 executor 已经在工作时，仍然只有一个作业添加到队列中，我希望它排队多个作业。

我已经尝试将我的工作“参数化”作为一种解决方法，但只要轮询未设置任何参数¹（甚至不是默认参数²），这也无济于事。

有没有办法为每个 scm-change 在作业队列中获取一个新版本？

[1] [https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Build](https://wiki.jenkins-ci.org/display/JENKINS/Parameterized+Build)

[2] 我尝试将此场景与[https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+Dynamic+Parameter+Plug-in结合使用](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+Dynamic+Parameter+Plug-in)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T19:18:13.440

[您可以使用Jenkins Adaptive Plugin](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+Adaptive+Plugin)编写脚本以由 SVN 触发并创建一个新构建，而不管当前正在运行什么。

另一种选择是创建两个作业，一个监视 SCM，一个运行构建。每次发生 SCM 更改时，您都会让第一个作业将第二个作业的实例添加到队列中并立即完成，以便它可以继续轮询。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T16:05:22.160

通过使用需要两个步骤的解决方法，在 Jenkins 中描述的场景是可能的：

*   [JobA_trigger] 通过 curl 或 jenkins-cli.jar¹“外部”触发另一个工作的一个工作。

*   [JobA] 必须是参数化的实际工作。

在我的设置中，JobA_trigger 会定期轮询 SCM。如果有变化，则通过 curl 触发 JobA 并提交当前日期时间²。这种“外部”触发是向 JobA 提交参数所必需的。

```
# JobA_trigger "execute shell"
curl ${JENKINS_URL}job/JobA/buildWithParameters?SVN_REVISION=`date +"%Y-%m-%d"`%20`date +"%H:%M:%S"`
# SVN_REVISION, example (decoded): "2012-11-07 12:56:50" ("%20" is url-encoded space) 
```

JobA 本身是参数化的，并接受一个字符串参数“SVN_REVISION”。此外，我必须将 SVN-URL 更改为

```
# Outer brackets for usage of SVN revision dates³ - must be avoided if working on a revision-number.
https://svn.someaddress.com/trunk@{${SVN_REVISION}} 
```

使用此解决方法，对于每个 scm-change，都有新运行的 JobA 排队，其中附加了相关的 svn-revision/dateTime 作为参数，并用作该作业正在测试的软件状态。

¹ [https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI](https://wiki.jenkins-ci.org/display/JENKINS/Jenkins+CLI)

² 我决定使用 dateTime-bases 更新而不是基于修订的更新，因为我有 svn-externals，如果我要基于修订工作，每个都将更新为 HEAD。

³ [http://svnbook.red-bean.com/en/1.7/svn.tour.revs.specifiers.html#svn.tour.revs.dates](http://svnbook.red-bean.com/en/1.7/svn.tour.revs.specifiers.html#svn.tour.revs.dates)

# asp.net - 让页面方法未处理的异常表现为其他 ASP.Net 未处理的异常

> ID：13293863
> 
> 赞同：2
> 
> 时间：2012-11-08T16:57:46.143
> 
> 标签：asp.net, exception-handling, asmx, webforms, pagemethods

我有一个具有单页方法的网络表单。我的其他 Web 应用程序将未处理的异常记录到 Web 服务器上的系统事件日志中。由于与我合作的其他开发人员希望在事件日志中看到应用程序错误条目，我希望这个应用程序也能这样做。

但是，当从页面方法内的调用代码中捕获异常时，我让应用程序发送错误电子邮件。发生这种情况时，它不会写入事件日志。注意：页面方法在调用我的邮件通知方法后重新抛出异常。

从我目前阅读的内容来看，ASP.Net 似乎默认将错误记录到事件日志中。我想页面方法/WebMethods 并非如此，因为它们基本上将异常抛出给调用它的客户端代码。

是否有一种简单的方法可以使该异常正确冒泡以便写入事件日志？没有其他应用程序直接从我所看到的内容写入事件日志，所以我认为该应用程序不会创建新源，因为我们的安全人员将很多事情锁定（出于善意，是的安全）。

```
[WebMethod]
public static object MyPseudoWebMethod()
{
    try
    {
        // My exception spawning unreliable code here
    }
    catch(Exception ex)
    {
        // Cleanup ...
        this.SendErrorNotification(ex);

        throw; // <-- This doesn't bubble up but I'd love for it to!
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T20:23:10.733

嗯有趣的问题。你是对的，WebMethod 异常不遵循正常的异常流程。

> 如果您的 Web 方法引发异常，则不会触发 Application_Error 事件。这样做的原因是 XML Web services 的 HTTP 处理程序使用 XML Web services 执行时发生的任何异常，并在调用 Application_Error 事件之前将其转换为 SOAP 错误。

*（从[这里](http://geekswithblogs.net/pavelka/archive/2005/09/05/HowToCreateAGlobalExceptionHandlerForAWebService.aspx)）*

上面的页面建议使用 SOAP 扩展在它被吞下之前捕获该异常，但如果你不想这样做，我会这样做：

1) 制作一个新的“错误接收”ASPX 页面，您将构建该页面将采用您想要在错误日志中记录的任何参数。因此，例如，让此页面接收名为“ExceptionDetails”的 POST 或您希望捕获的任何其他内容。此页面不会直接在浏览器中查看，因此它不需要任何 ASPX 控件或任何东西，但在其上使用 MasterPage 不会有任何损害。

2) 在这个新页面后面的代码中，获取您发送的任何 POSTS，并使用您需要的任何详细信息新建一个异常。立即抛出此异常。这样做意味着此异常将遵循应用程序中其他未处理异常的任何流程（日志记录、电子邮件发送等）。

3）在调用WebMethod JS的页面上，将对WebMethod的调用包装在try-catch中

4) 在 catch 块中，在浏览器中打印出您想要的任何消息，并启动一个新的 AJAX 帖子到接收 ASPX 页面的新错误，传递您让该页面查找的任何 POST 内容。

默认情况下，新的 AJAX 调用不会改变用户的感知。AJAX 调用会触发对该页面的新请求，而 ASPX 页面本身实际上完全不知道它的 AJAX 而不是正常的浏览器请求。如果您正在记录用户的 ID 或其他任何内容，则当前设置的任何 cookie/会话/身份验证数据也可用于 AJAX 页面。如果您查看像 Firebug 这样的工具返回的响应，您会发现它实际上是 YellowScreenOfDeath 的 HTML（除非您有一个自定义的 500 页面，在这种情况下，它是返回的那个 HTML）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T19:00:01.347

这就是传统 ASMX Web 服务的工作方式。

唯一的解决方法是停止使用它们（无论如何你都应该这样做，除非你坚持使用 .NET 2.0）。WCF 没有这个问题。

# iis-7 - “威胁已经被清除了。” 在 aspx SOAP 服务中

> ID：13293865
> 
> 赞同：0
> 
> 时间：2012-11-08T16:57:46.003
> 
> 标签：iis-7

我有一个通过 Tuxedo 访问企业数据库的 aspx soap 服务。肥皂服务在 IIS7/Windows 2008 R2 上运行。我们偶尔会收到“线程被中止”。并且 SOAP 调用无法返回。由于网络/数据库性能/粗略的后端问题，调用完全有可能长时间运行（最多 20 分钟）我们可以耐心等待。我们认为 IIS 正在杀死运行时间过长的线程。目前可扩展性不是问题，因为我们看到最多 10 个并发请求。有没有办法配置 IIS 在杀死线程之前给更多时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-20T19:20:33.883

一种可能是 web.config 中的 executionTimeout 设置。默认值为 110 秒。如果在 web.config 中设置了 debug=true 开关，则忽略此值并且永远不会发生超时。增加此值将允许 IIS 在终止线程之前提供更多时间。

```
<system.web>
    <httpRuntime executionTimeout="110"/>
</system.web> 
```

# java - Vaadin 的 SEO 问题

> ID：13293869
> 
> 赞同：3
> 
> 时间：2012-11-08T16:57:55.680
> 
> 标签：java, gwt, web, vaadin

我正在考虑使用 Vaadin 来开发我的一个项目，但是，从我读过的内容来看，这个框架似乎在 SEO 方面存在一些问题。知道 Vaadin 的主要重点是开发 webapps，这不是什么大问题，但我要开发的项目更像是一个社区公共网站，在这种情况下，遇到 SEO 问题将是一个沉重的负担。

我的问题是，Vaadin 真的有这种问题吗？如果是这样，有没有办法绕过它？

我想确保这个网站被搜索引擎正确索引，做一个好的网站但它从未出现在相关搜索中是非常糟糕的。

编辑：我打算在本网站的大部分内容上使用我的设计师制作的 HTML 中的 CustomLayout，这会改变这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-02T22:34:01.863

答案可能在 GWT 的更深层 Vaadin 中，其中一些示例位于：

[http://www.infoq.com/resource/articles/progwt/en/resources/progwt.pdf](http://www.infoq.com/resource/articles/progwt/en/resources/progwt.pdf)

# c# - config.DataServiceBehavior.MaxProtocolVersion 从 V3.0 到 V2.0 的更改无法恢复

> ID：13293874
> 
> 赞同：6
> 
> 时间：2012-11-08T16:58:19.437
> 
> 标签：c#, asp.net, visual-studio-2012, wcf-data-services

我变了

```
config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3 
```

从 V3 到 V2 以验证 JSON 输出是否为 Verbose。但是，当我将它改回 V3 时，输出仍然是冗长的，我必须添加

```
?$format=application/json;odata=verbose 
```

为了获得 JSON Light。有关如何将其恢复到正确版本的提示？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-27T05:12:28.453

要解决此问题，请使用可以扩展部分类

```
namespace Project.ServiceReference
{
public partial class MyEntities : global::System.Data.Services.Client.DataServiceContext
{
    public TestDirectoryEntities(string uri)
        : base(new Uri(uri), DataServiceProtocolVersion.V3)
    {
        this.ResolveName = new global::System.Func<global::System.Type, string>   (this.ResolveNameFromType);
        this.ResolveType = new global::System.Func<string, global::System.Type>(this.ResolveTypeFromName);
        this.OnContextCreated();
    }
}
} 
```

# linq - 无法将“Linq.LookupList`1[System.Nullable`1[System.Int32]]”类型的对象转换为 Generic.List`1[System.Nullable`1[System.Int32]]”类型

> ID：13293876
> 
> 赞同：1
> 
> 时间：2012-11-08T16:58:35.003
> 
> 标签：linq, sharepoint-2010

我收到此错误@List)itemPage.userId

无法将类型为“Microsoft.SharePoint.Linq.LookupList `1[System.Nullable`1[System.Int32]]”的对象转换为类型“System.Collections.Generic.List `1[System.Nullable`1[System.Int32]]”

代码：

```
 List<MySitePage> userId = PagesFacade.GetPages(web.Url, (List<int?>)itemPage.userId); 
```

ItemPage 中的 userId 是私有的`Microsoft.SharePoint.Linq.LookupList<System.Nullable<int>> _userId ;`

```
public static List<MySitePage> GetPages(string relativeWebUrl, List<int?> userIds) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:18:34.290

`LookupList<T>`实现`IList<T>`，而不是列表。这是确切的实现：

```
public sealed class LookupList<T> : IList<T>, ICollection<T>, IEnumerable<T>, IEnumerable, ICloneable 
```

既然如此，因为它是 IEnumerable，你可以尝试调用`ToList`集合并希望它实现它（虽然我实际上没有使用过 Sharepoint 集合）。所以试试这个：

```
List<MySitePage> userId = PagesFacade.GetPages(web.Url, itemPage.userId.ToList()); 
```

# ruby-on-rails - 带有 mongoid 的自定义字段

> ID：13293877
> 
> 赞同：2
> 
> 时间：2012-11-08T16:58:35.193
> 
> 标签：ruby-on-rails, ruby, mongoid, mongoid3, custom-field-type

我开始在我的项目中使用[mongoid](http://mongoid.org/en/mongoid/index.html) gem，我对它如何存储和获取数据库上的信息有点困惑。我的模型中有特定类型的字段，但是当我从数据库中获取它时，它返回一个哈希。这是我的模型：

服务.rb

```
class Service
  include Mongoid::Document
  field :username, type: String
  field :strategy, type: Strategy
  field :design, type: Design

end 
```

策略.rb

```
class Strategy 
  include Mongoid::Document

  field :name, type: String
  field :description, type:  String
  field :resources, type:  Resources
  field :scalability, type:  Scalability  
  field :localization, type:  Localization
  field :contact, type:  Contact

end 
```

如果我初始化一个新服务@service，并执行@service.class，它会返回正确的服务，但是如果我尝试执行@service.strategy.class，它会返回哈希，而不是策略，就像我期待的那样。我在[mongoid 手册](http://mongoid.org/en/mongoid/docs/documents.html#fields)上阅读了“自定义字段序列化”，我认为这可以让我做我想做的事。但是我想知道是否没有其他方法可以轻松做到这一点，因为我有很多模型要更改。

# javascript - javascript数组/对象问题

> ID：13293878
> 
> 赞同：0
> 
> 时间：2012-11-08T16:58:40.840
> 
> 标签：javascript, jquery, arrays

我正在尝试将元素推送到数组上。

**编辑**

```
 task.prototype.goTest=function(){

     for(a = 0; a < test.length; a++) {
        if(this.testnumber != test[a].number) {

            //it will only loop 8 times under conditional statement            
            group = {
                title: test[a].Title,
                ID: test[a].ID,
                contents: []
            };

            this.company.push(group);
            this.testnumber = test.number[a];
        }
        //outside of if conditional statement.. it will loop 15 times
        //i want every test[a].conetents get pushed to group.contents array. 
        //this.company is the final variable I need for this function...    

        group.contents.push(test[a].contents);
    }
    console.log(this.company);
} 
```

但是，当我这样做时

```
console.log(this.company); 
```

`group.contents`我看到 8 个元素，每个数组中只有 1 个元素。理想的情况是`group.contents`数组中有 8 个元素和 2 到 3 个元素。

this 指的是函数中的对象。知道如何解决我的问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:04:52.973

您正在`group` 每个循环创建一个新对象，因此对的引用`group.contents`只是当前对象，它不*引用*先前创建的`group`对象。

因此，每次调用 时`group.contents.push`，您只是推送到在该循环迭代中创建的对象。

# c# - 在 c# 中使用复制命令，不尊重路径

> ID：13293882
> 
> 赞同：0
> 
> 时间：2012-11-08T16:58:51.117
> 
> 标签：c#, copy, command

我正在尝试编写一些基本上将一堆文件连接到一个输出文件中的东西。

我的代码如下

```
string[] destination = new string[this.lbFiles.Items.Count];
this.lbFiles.Items.CopyTo(destination, 0);
string result1 = ConvertStringArrayToString(destination);
result1 = result1.Remove(result1.Length - 3);
string outputfile = this.saveFileDialog1.FileName;
string copyarg = "copy /b " + result1 + quote + outputfile + quote;
System.Diagnostics.Process.Start("CMD.exe", copyarg); 
```

所以基本上 result1 = 我要连接的所有文件。带有完整的路径和引号。和 outputfile = 我想与完整路径一起使用的输出文件名。

我的问题是，当我执行代码时，它复制了文件，但它没有使用我指定的输出文件名，而是将文件输出到程序exe所在的目录，而不是我指定的路径。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:48:30.703

您似乎在其中缺少引号或空格。您正在删除 result1 的最后三个字符，我假设它们是“ `+`”，然后立即添加一个引号。这会产生`copy /b "d:\test1.ac3" + "d:\test2.ac3""d:\output.ac3"`.

我认为这会出错，但如果没有，它肯定会产生你的奇怪行为。特别是如果您的文件名中实际上有空格。

# sql-server - 将 SQL Server 2008 R2 数据库转换为 PostGIS

> ID：13293885
> 
> 赞同：-1
> 
> 时间：2012-11-08T16:58:56.187
> 
> 标签：sql-server, sql-server-2008-r2, postgis, postgresql-9.2

我在 SQL Server 2008 R2 中有一个数据库，需要将其转换为 PostGIS 数据库。

我安装了带有 PostGIS 扩展的 PostGres 9.2。将现有 SQL Server 2008 R2 数据库转换为 PostGIS 等效数据库的下一步应该是什么？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T21:01:44.273

好吧，首先你不能将数据库从 SQL Server 转换为 Postgres。希望您只是想在新创建的 Postgres 数据库中制作类似结构的表副本。如果是这种情况，您可以使用 SSMS 创建一个临时 SSIS 包来复制数据。但是，您需要先安装一个像[这样](http://pgoledb.com/)的 Postgres OLEDB 提供程序，然后才能执行此操作。

# c# - 如何从 Native C++ 调用 C# 库（使用 C++\CLI 和 IJW）

> ID：13293888
> 
> 赞同：59
> 
> 时间：2012-11-08T16:58:57.190
> 
> 标签：c#, c++, visual-studio-2010, c#-4.0, c++-cli

**背景：**作为更大任务的一部分，我需要使非托管 C++ 和 C 代码可以访问 C# 库。为了自己回答这个问题，过去几天/几周我一直在学习 C++/CLI。

似乎有许多不同的方法可以使用非托管 C++ 和 C 中的 C# dll 来实现。一些简短的答案似乎是：使用 Interlope 服务，使用 .com。和 regasm，使用 PInvoke（似乎只从 C# 到 C++），并在 C++/CLR 中使用 IJW（这似乎是 Interlope 服务）。我认为最好设置一个库，它可能是一个 CLR 包装器，它使用 IJW 代表本机 C++ 和 C 代码调用我的 C# dll。

**细节：**我需要将字符串和 int 的值从 c++ 代码传递给 C# dll，然后返回 void。

**相关性：**许多公司有很多借口混合和匹配 C++、C 和 C#。性能：非托管代码通常更快，接口：托管接口通常更易于维护、部署，并且通常更容易看，经理们也告诉我们。遗留代码也迫使我们。它就在那里（就像我们爬过的山一样）。虽然如何从 C# 调用 C++ 库的示例很多。通过谷歌搜索很难找到如何从 C++ 代码调用 C# 库的示例，尤其是如果您想查看更新的 4.0+ 代码。

**软件：** C#、C++/CLR、C++、C、Visual Studio 2010 和 .NET 4.0

**问题详情：** OK 多部分问题：

1.  使用 com 对象有优势吗？还是 PInvoke？还是别的什么方法？（我觉得这里的学习曲线同样陡峭，尽管我确实在 Google Land 中找到了有关该主题的更多信息。IJW 似乎承诺我想要它做的事情。我是否应该放弃寻找 IJW 解决方案和而是专注于这个？）（优势/劣势？）

2.  我想象有一个解决方案是否正确，我编写了一个在 C++/CLR 中利用 IJW 的包装器？我在哪里可以找到关于这个主题的更多信息，不要说我没有足够的谷歌/或查看 MSDN 而不告诉我你在哪里看到它。（我想我更喜欢这个选项，努力编写清晰简单的代码。）

3.  缩小问题范围：我觉得我真正的问题和需要是回答以下较小的问题：如何设置非托管 C++ 文件可以在 Visual Studio 中使用的 C++/CLR 库。我认为，如果我可以简单地在非托管 C++ 代码中实例化一个托管 C++ 类，那么我可能能够解决剩下的问题（接口和包装等）。我希望我的主要愚蠢之处在于尝试在 Visual Studio 中设置引用/#includes 等，我清楚地认为我可能有其他误解。也许整个事情的答案可能只是指向帮助我的教程或说明的链接。

**研究：**我一遍又一遍地用谷歌搜索和搜索并取得了一些成功。我找到了许多链接，这些链接向您展示了如何从 C# 代码中使用非托管库。而且我承认已经有一些链接显示了如何使用 com 对象来做到这一点。针对 VS 2010 的结果并不多。

**参考资料：** 我一遍又一遍地阅读了很多帖子。我试图通过最相关的工作。有些似乎非常接近答案，但我似乎无法让它们发挥作用。我怀疑我缺少的东西非常小，例如误用关键字 ref，或缺少 #include 或 using 语句，或误用名称空间，或未正确使用 IJW 功能，或缺少 VS需要正确处理编译等。所以你想知道，为什么不包含代码？好吧，我觉得我不在一个我理解并期望我必须工作的代码的地方。我想在一个我理解它的地方，当我到达那里时，我可能需要帮助修复它。我将随机包含两个链接，但我不允许在我当前的 Hitpoint 级别显示它们。

[http://www.codeproject.com/Articles/35437/Moving-Data-between-Managed-Code-and-Unmanaged-Cod](http://www.codeproject.com/Articles/35437/Moving-Data-between-Managed-Code-and-Unmanaged-Cod)

这从 C++ 到 Visual Basic 并通过 C++CLR 返回的两个方向从托管和非托管代码调用代码，当然我对 C# 感兴趣。：http: [//www.codeproject.com/Articles/9903/Calling -托管代码来自非托管代码和副](http://www.codeproject.com/Articles/9903/Calling-Managed-Code-from-Unmanaged-Code-and-vice)

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-16T00:16:43.930

你可以很容易地做到这一点。

1.  创建一个 .h/.cpp 组合
2.  在新创建的 .cpp 文件上启用 /clr。（CPP -> 右键单击​​ -> 属性）
3.  将“其他#using 目录”的搜索路径设置为指向您的 C# dll。

本机.h

```
void NativeWrapMethod(); 
```

本机.cpp

```
#using <mscorlib.dll>
#using <MyNet.dll>

using namespace MyNetNameSpace;

void NativeWrapMethod()
{
    MyNetNameSpace::MyManagedClass::Method(); // static method
} 
```

这就是将 C++\CLI 中的 C# 库与本机代码一起使用的基础知识。（只需在需要的地方引用 Native.h 并调用该函数。）

将 C# 代码与托管 C++\CLI 代码一起使用大致相同。

关于这个主题有很多错误信息，因此，希望这可以为人们节省很多麻烦。:)

* * *

我已经这样做了：VS2010 - VS2012（它可能也适用于 VS2008。）

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2015-05-01T14:26:16.587

**2018 年更新**

似乎该解决方案不适用于 Visual Studio 2017 及更高版本。不幸的是，我目前没有使用 Visual Studio，因此无法自己更新这个答案。但是[kaylee发布了我的](https://stackoverflow.com/users/3543437/kayleefrye-ondeck)[答案](https://stackoverflow.com/a/53016935/3859994)的更新版本，谢谢！

**更新结束**

如果你想使用 COM，这是我对这个问题的解决方案：

**C# 库**

首先，您需要一个兼容 COM 的库。

*   你已经有了？完美，你可以跳过这部分。

*   您可以访问图书馆吗？按照以下步骤确保它与 COM 兼容。

    1.  确保您在项目的属性中**选中**了“注册 COM 互操作”选项。属性 -> 构建 -> 向下滚动 -> 注册 COM 互操作

以下屏幕截图显示了您可以找到此选项的位置。

![截图项目属性构建](../Images/6d489d15f95073d56c836d4d49bce3c1.png)

2.  所有应该可用的接口和类都需要有一个[GUID](https://www.guidgenerator.com/)

    ```
    namespace NamespaceOfYourProject
    {
        [Guid("add a GUID here")]
        public interface IInterface
        {
            void Connect();

            void Disconnect();
        }
    }

    namespace NamespaceOfYourProject
    {
         [Guid("add a GUID here")]
         public class ClassYouWantToUse: IInterface
         {
             private bool connected;

             public void Connect()
             {
                 //add code here
             }

             public void Disconnect()
             {
                 //add code here
             }
         }
    } 
    ```

所以这几乎就是你必须用你的 C# 代码做的事情。让我们继续 C++ 代码。

**C++**

1.  首先，我们需要导入 C# 库。

编译 C# 库后，应该有一个 .tlb 文件。

```
#import "path\to\the\file.tlb" 
```

如果您将这个新创建的文件导入到您的 file.cpp，您可以将您的对象用作局部变量。

```
#import "path\to\the\file.tlb"

int _tmain(int argc, _TCHAR* argv[])
{
    CoInitialize(NULL);

    NamespaceOfYourProject::IInterfacePtr yourClass(__uuidof(NamespaceOfYourProject::ClassYouWantToUse));

    yourClass->Connect();

    CoUninitialize();
} 
```

2.  使用您的类作为属性。

您会注意到第一步仅适用于局部变量。以下代码显示了如何将其用作属性。与[这个](https://stackoverflow.com/questions/29969302/c-com-object-as-property/29969481)问题有关。

您将需要位于 atlcomcli.h 中的 CComPtr。将此文件包含在您的头文件中。

CPlusPlusClass.h

```
#include <atlcomcli.h> 
#import "path\to\the\file.tlb"

class CPlusPlusClass
{
public:
    CPlusPlusClass(void);
    ~CPlusPlusClass(void);
    void Connect(void);

private:
    CComPtr<NamespaceOfYourProject::IInterface> yourClass;
} 
```

CPlusPlusClass.cpp

```
CPlusPlusClass::CPlusPlusClass(void)
{
    CoInitialize(NULL);

    yourClass.CoCreateInstance(__uuidof(NamespaceOfYourProject::ClassYouWantToUse));

}

CPlusPlusClass::~CPlusPlusClass(void)
{
    CoUninitialize();
}

void CPlusPlusClass::Connect(void)
{
    yourClass->Connect();
} 
```

就是这样！在 C++ 和 COM 中享受 C# 类的乐趣。

* * *

## 回答 #3

> 赞同：16
> 
> 时间：2014-08-20T16:44:59.117

我发现做到这一点的绝对最佳方法是创建一个将 c# 代码连接到本机 C++ 的 c++/cli 桥。您可以使用 3 个不同的项目来执行此操作。

*   第一个项目：C# 库
*   第二个项目：C++/CLI 桥（这包含了 C# 库）
*   第三个项目：使用第二个项目的本机 C++ 应用程序

我最近创建了一个简单的 GitHub 教程，说明如何在[此处](https://github.com/jsmitty/CPlusPlusCLI-Tutorial)执行此操作。用一点勇气阅读该代码，您应该能够敲定创建一个 C++/CLI 桥接器，该桥接器允许您在本机 C++ 中使用 C# 代码。

作为奖励，我添加了如何将 C# 事件包装到可以订阅的 C++ 中的函数指针。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2018-10-26T22:18:31.967

[不幸的是，来自 0lli.rocks](https://stackoverflow.com/a/29988737/3543437)的答案要么已过时，要么不完整。我的同事帮助我完成了这项工作，坦率地说，其中一两个实施细节并不明显。这个答案纠正了差距，应该可以直接复制到 Visual Studio 2017 中供您自己使用。

**警告**：我无法让它为 C++/WinRT 工作，仅供参考。由于接口不明确导致的各种编译错误`IUnknown`。我也遇到了问题，使其仅适用于库实现，而不是在应用程序的主体中使用它。我专门尝试按照 0lli.rocks 的说明进行操作，但始终无法编译。

# 步骤 01：创建 C# 库

* * *

这是我们将用于演示的那个：

```
using System;
using System.Runtime.InteropServices;

namespace MyCSharpClass
{
    [ComVisible(true)] // Don't forget 
    [ClassInterface(ClassInterfaceType.AutoDual)] // these two lines
    [Guid("485B98AF-53D4-4148-B2BD-CC3920BF0ADF")] // or this GUID
    public class TheClass
    {
        public String GetTheThing(String arg) // Make sure this is public
        {
            return arg + "the thing";
        }
    }
} 
```

# 步骤 02 - 为 COM 可见性配置 C# 库

* * *

## 子步骤 A - 注册 COM 互操作性

[![在此处输入图像描述](../Images/1aa52d2386b39d3eca99f2c8b7698998.png)](https://i.stack.imgur.com/EPQbW.png)

## 子步骤 B - 使程序集 COM 可见

[![在此处输入图像描述](../Images/22c0fb478c6851516c0caeeb64af68f9.png)](https://i.stack.imgur.com/EDj7z.png)

# `.tlb`第 3 步 - 为文件构建库

* * *

你可能只想这样做`Release`，`AnyCPU`除非你真的需要更具体的东西。

# 第 4 步 - 将`.tlb`文件复制到 C++ 项目的源位置

* * *

[![在此处输入图像描述](../Images/27b0ec39e3b1fa188705a00b3014c119.png)](https://i.stack.imgur.com/9dYCK.png)

# 第 5 步 - 将`.tlb`文件导入您的 C++ 项目

* * *

```
#include "pch.h"
#include <iostream>
#include <Windows.h>
#import "MyCSharpClass.tlb" raw_interfaces_only

int wmain() {
    return 0;
} 
```

# 第 6 步 - 当 Intellisense 失败时不要惊慌

* * *

[![在此处输入图像描述](../Images/f2ee1e182f0a40f117be341e5d21ac99.png)](https://i.stack.imgur.com/H8T6k.png)

它仍然会建立。一旦我们将实际类实现到 C++ 项目中，您将看到更多红线代码。

# 第 7 步 - 构建您的 C++ 项目以生成`.tlh`文件

* * *

一旦您第一次构建，此文件将进入您的中间对象构建目录

[![在此处输入图像描述](../Images/84e9bf34c2580ebad7fc205d02a1f5eb.png)](https://i.stack.imgur.com/NnJs4.png)

# 第 8 步 - 评估`.tlh`文件以获取实施说明

* * *

这是`.tlh`在中间对象文件夹中生成的文件。不要编辑它。

```
// Created by Microsoft (R) C/C++ Compiler Version 14.15.26730.0 (333f2c26).
//
// c:\users\user name\source\repos\consoleapplication6\consoleapplication6\debug\mycsharpclass.tlh
//
// C++ source equivalent of Win32 type library MyCSharpClass.tlb
// compiler-generated file created 10/26/18 at 14:04:14 - DO NOT EDIT!

//
// Cross-referenced type libraries:
//
//  #import "C:\Windows\Microsoft.NET\Framework\v4.0.30319\mscorlib.tlb"
//

#pragma once
#pragma pack(push, 8)

#include <comdef.h>

namespace MyCSharpClass {

//
// Forward references and typedefs
//

struct __declspec(uuid("48b51671-5200-4e47-8914-eb1bd0200267"))
/* LIBID */ __MyCSharpClass;
struct /* coclass */ TheClass;
struct __declspec(uuid("1ed1036e-c4ae-31c1-8846-5ac75029cb93"))
/* dual interface */ _TheClass;

//
// Smart pointer typedef declarations
//

_COM_SMARTPTR_TYPEDEF(_TheClass, __uuidof(_TheClass));

//
// Type library items
//

struct __declspec(uuid("485b98af-53d4-4148-b2bd-cc3920bf0adf"))
TheClass;
    // [ default ] interface _TheClass
    // interface _Object

struct __declspec(uuid("1ed1036e-c4ae-31c1-8846-5ac75029cb93"))
_TheClass : IDispatch
{
    //
    // Raw methods provided by interface
    //

      virtual HRESULT __stdcall get_ToString (
        /*[out,retval]*/ BSTR * pRetVal ) = 0;
      virtual HRESULT __stdcall Equals (
        /*[in]*/ VARIANT obj,
        /*[out,retval]*/ VARIANT_BOOL * pRetVal ) = 0;
      virtual HRESULT __stdcall GetHashCode (
        /*[out,retval]*/ long * pRetVal ) = 0;
      virtual HRESULT __stdcall GetType (
        /*[out,retval]*/ struct _Type * * pRetVal ) = 0;
      virtual HRESULT __stdcall GetTheThing (
        /*[in]*/ BSTR arg,
        /*[out,retval]*/ BSTR * pRetVal ) = 0;
};

} // namespace MyCSharpClass

#pragma pack(pop) 
```

在该文件中，我们看到了我们想要使用的公共方法的这些行：

```
virtual HRESULT __stdcall GetTheThing (
        /*[in]*/ BSTR arg,
        /*[out,retval]*/ BSTR * pRetVal ) = 0; 
```

这意味着导入的方法将需要一个类型为 的输入字符串`BSTR`，以及一个指向`BSTR`输出字符串的指针，导入的方法将在成功时返回该指针。您可以像这样设置它们，例如：

```
BSTR thing_to_send = ::SysAllocString(L"My thing, or ... ");
BSTR returned_thing; 
```

在我们可以使用导入的方法之前，我们必须构造它。从`.tlh`文件中，我们看到以下几行：

```
namespace MyCSharpClass {

//
// Forward references and typedefs
//

struct __declspec(uuid("48b51671-5200-4e47-8914-eb1bd0200267"))
/* LIBID */ __MyCSharpClass;
struct /* coclass */ TheClass;
struct __declspec(uuid("1ed1036e-c4ae-31c1-8846-5ac75029cb93"))
/* dual interface */ _TheClass;

//
// Smart pointer typedef declarations
//

_COM_SMARTPTR_TYPEDEF(_TheClass, __uuidof(_TheClass));

//
// Type library items
//

struct __declspec(uuid("485b98af-53d4-4148-b2bd-cc3920bf0adf"))
TheClass;
    // [ default ] interface _TheClass
    // interface _Object 
```

首先，我们需要使用类的命名空间，即`MyCSharpClass`

接下来，我们需要从命名空间中确定智能指针，即`_TheClass`+ `Ptr`；这一步并不明显，因为它不在`.tlh`文件中。

最后，我们需要为类提供正确的构造参数，即`__uuidof(MyCSharpClass::TheClass)`

结束，

```
MyCSharpClass::_TheClassPtr obj(__uuidof(MyCSharpClass::TheClass)); 
```

# 第 9 步 - 初始化 COM 并测试导入的库

* * *

您可以使用`CoInitialize(0)`特定的 COM 初始化程序或任何您的特定 COM 初始化程序来执行此操作。

```
#include "pch.h"
#include <iostream>
#include <Windows.h>
#import "MyCSharpClass.tlb" raw_interfaces_only

int wmain() {
    CoInitialize(0); // Init COM
    BSTR thing_to_send = ::SysAllocString(L"My thing, or ... ");
    BSTR returned_thing;
    MyCSharpClass::_TheClassPtr obj(__uuidof(MyCSharpClass::TheClass)); 
    HRESULT hResult = obj->GetTheThing(thing_to_send, &returned_thing);

    if (hResult == S_OK) {
        std::wcout << returned_thing << std::endl;
        return 0;
    }
    return 1;
} 
```

再一次，当 Intellisense 出现故障时不要惊慌。你在黑魔法、巫毒和 Thar Be Dragons 的领域，所以继续前进！

[![在此处输入图像描述](../Images/aba7342e36a57c61b8490c7320ce71fb.png)](https://i.stack.imgur.com/lCRSF.png)

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2012-12-11T15:59:12.627

我找到了至少开始回答我自己的问题的东西。以下两个链接包含来自 Microsoft 的 wmv 文件，这些文件演示了在非托管 C++ 中使用 C# 类。

第一个使用 COM 对象和 regasm：http: [//msdn.microsoft.com/en-us/vstudio/bb892741](http://msdn.microsoft.com/en-us/vstudio/bb892741)。

第二个使用 C++/CLI 的特性来包装 C# 类：http: [//msdn.microsoft.com/en-us/vstudio/bb892742](http://msdn.microsoft.com/en-us/vstudio/bb892742)。我已经能够从托管代码中实例化 ac# 类并检索视频中的字符串。它非常有帮助，但它只回答了我问题的 2/3，因为我想将一个带有字符串周界的类实例化为 ac# 类。作为概念证明，我将示例中提供的代码更改为以下方法，并实现了这一目标。当然，我还添加了一个修改后的 {public string PickDate(string Name)} 方法来对名称字符串做一些事情，以向自己证明它有效。

```
wchar_t * DatePickerClient::pick(std::wstring nme)
{
    IntPtr temp(ref);// system int pointer from a native int
    String ^date;// tracking handle to a string (managed)
    String ^name;// tracking handle to a string (managed)
    name = gcnew String(nme.c_str());
    wchar_t *ret;// pointer to a c++ string
    GCHandle gch;// garbage collector handle
    DatePicker::DatePicker ^obj;// reference the c# object with tracking handle(^)
    gch = static_cast<GCHandle>(temp);// converted from the int pointer 
    obj = static_cast<DatePicker::DatePicker ^>(gch.Target);
    date = obj->PickDate(name);
    ret = new wchar_t[date->Length +1];
    interior_ptr<const wchar_t> p1 = PtrToStringChars(date);// clr pointer that acts like pointer
    pin_ptr<const wchar_t> p2 = p1;// pin the pointer to a location as clr pointers move around in memory but c++ does not know about that.
    wcscpy_s(ret, date->Length +1, p2);
    return ret;
} 
```

我的部分问题是：什么更好？根据我在许多研究中阅读的内容，答案是 COM 对象被认为更易于使用，而使用包装器可以实现更大的控制。在某些情况下，使用包装器可以（但并非总是）减小 thunk 的大小，因为 COM 对象自动具有标准大小的占用空间，并且包装器只有它们需要的大小。

thunk（正如我在上面使用的）指的是在 COM 对象的情况下在 C# 和 C++ 之间使用的空间时间和资源，以及在使用 C++/CLI 进行编码的情况下在 C++/CLI 和本机 C++ 之间使用的空间时间和资源包装。所以我的答案的另一部分应该包括一个警告，即超过绝对必要的跨越 thunk 边界是不好的做法，不建议在循环内访问 thunk 边界，并且可能错误地设置包装器，以便它加倍 thunk （越过边界两次，只需要一个 thunk），而对于像我这样的新手来说，代码似乎不正确。

关于 wmv 的两个注意事项。第一：有些镜头在两者中都重复使用，不要上当。起初它们看起来相同，但它们确实涵盖了不同的主题。其次，还有一些额外的功能，例如编组，现在是 CLI 的一部分，而 wmv 中没有涵盖。

编辑：

请注意，您的安装有一个后果，CLR 将找不到您的 c++ 包装器。您必须确认 c++ 应用程序安装在任何/每个使用它的目录中，或者在安装时将库（然后需要强命名）添加到 GAC。这也意味着在开发环境中的任何一种情况下，您都可能必须将库复制到应用程序调用它的每个目录。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-10-16T23:02:43.343

我做了一堆环顾四周，发现了微软的一篇相对较新的文章，详细介绍了它是如何完成的（有很多旧的信息漂浮在周围）。从文章本身：

> 代码示例使用 CLR 4 托管 API 在本机 C++ 项目中托管 CLR，加载和调用 .NET 程序集

[https://code.msdn.microsoft.com/CppHostCLR-e6581ee0](https://code.msdn.microsoft.com/CppHostCLR-e6581ee0)

基本上它分两步描述它：

1.  将 CLR 加载到进程中
2.  加载您的程序集。

# ios - 代替日期选择器的是 iOS 的第三方 API 日历

> ID：13293891
> 
> 赞同：0
> 
> 时间：2012-11-08T16:59:08.993
> 
> 标签：ios, ipad, calendar, ekeventkit, ekevent

哪个是最好的 Third Api 日历？如果您有任何教程或您构建的代码可以在这里分享？

这将是一个很大的帮助。尤其是当第三方 api 与 EKeventKit 集成时。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:34:31.130

*   [Tapku](http://www.cocoacontrols.com/platforms/ios/controls/tapku-calendar)日历是 iOS 上最好的日历之一。

![塔库](../Images/03040edcf65bf886bb93ee631a748386.png)

*   另一个是[CKCalendar](https://github.com/jaykz52/CKCalendar)

有关更多控件，请查看[Cocoa Controls](http://www.cocoacontrols.com/)

# magento - Magento - 在特定时间禁用产品

> ID：13293897
> 
> 赞同：0
> 
> 时间：2012-11-08T16:59:18.993
> 
> 标签：magento, product

在商店里，我也想销售产品和活动。所有事件（虚拟产品）都具有属性`date`。事件结束后，我希望将其状态设置为禁用。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T19:07:30.607

您可以查看[如何安排未来的产品激活](http://www.ecomdev.org/2010/06/07/how-to-schedule-the-future-product-activation.html)并反转逻辑以禁用产品。

# python - 遍历列表的字典 + 将相同键的值相加

> ID：13293902
> 
> 赞同：0
> 
> 时间：2012-11-08T16:59:24.983
> 
> 标签：python, sorting, iteration

我有这样的数据结构：

```
[
    { "key" : { "subkey" : "red", "value" : 1 }  },
    { "key" : { "subkey" : "red", "value" : 2 }  },
    { "key" : { "subkey" : "blue", "value" : 1 }  },
    { "key" : { "subkey" : "yellow", "value" : 3 }  },
    { "key" : { "subkey" : "blue", "value" : 5 }  },
    { "key" : { "subkey" : "blue", "value" : 8 }  },
    { "key" : { "subkey" : "red", "value" : 2 }  },
    { "key" : { "subkey" : "red", "value" : 3 }  },
    { "key" : { "subkey" : "red", "value" : 6 }  },
] 
```

这个想法是我想遍历它，当至少 2`"subkeys"`个相同时，触发`some_event()`，这会将这些连续对象的值相加，直到它`"subkey"`再次遇到不同的对象。

例如，第一个和第二个 dicts 应该在添加`some_event()`值的情况下触发`2+1`。`some_event()`然后第三行（蓝色）和第四行（黄色）没有任何反应，第五和第六行（蓝色）用 values`5+8`等触发。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:14:47.033

```
from itertools import groupby

L = [
    { "key" : { "subkey" : "red", "value" : 1 }  },
    { "key" : { "subkey" : "red", "value" : 2 }  },
    { "key" : { "subkey" : "blue", "value" : 1 }  },
    { "key" : { "subkey" : "yellow", "value" : 3 }  },
    { "key" : { "subkey" : "blue", "value" : 5 }  },
    { "key" : { "subkey" : "blue", "value" : 8 }  },
    { "key" : { "subkey" : "red", "value" : 2 }  },
    { "key" : { "subkey" : "red", "value" : 3 }  },
    { "key" : { "subkey" : "red", "value" : 6 }  },
]

def some_event(*args):
    print args, sum(args)

for k, g in groupby(L, key=lambda x:x["key"]["subkey"]):
    g = list(g)
    if len(g) > 1:
        some_event(*(i["key"]["value"] for i in g)) 
```

# javascript - 在foreach生成的html表格中选择单元格

> ID：13293903
> 
> 赞同：0
> 
> 时间：2012-11-08T16:59:25.453
> 
> 标签：javascript, html, knockout.js

请帮我敲出.js 代码

我尝试通过 id 选择表中的元素并更改它的 css 样式，但所有行都有相同的 id，我不能使用函数 getElementById。我怎么能做这个简单的事情？

```
<tbody data-bind="foreach: times">
        <tr>
            <td id=$index() data-bind="click: $root.select.bind($data, $index(), 0)> </td>

        ....

        <td id=$index() data-bind="click: $root.select.bind($data, $index(), 19)> </td>

    <tr>
</tbody> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:02:59.977

ID 应该始终是唯一的。将相同的类分配给您感兴趣的所有元素并使用一些 jquery：

```
document.getElementsByClassName('class_name') 
```

编辑：好点。我本来打算建议使用jquery，然后记住了这个功能。如果你使用的是 jquery 库，你也可以试试这个：

```
$('.class_name').each(function(index) {
    ...do something...
}); 
```

编辑：要回答您的问题，有几种方法可以做到这一点：

```
$('.class_name').attr('id', new_id) 
```

或者

```
$('.class_name').addClass('class_name') 
```

取决于你到底想要做什么

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T18:56:23.960

尝试使用这样的代码：

```
<tbody data-bind="foreach: times">
    <tr>
        <td data-bind="attr: {id: $index()}, click: $root.select.bind($data, $index(), 0)></td>
    <tr>
</tbody> 
```

在此处阅读有关`attr`绑定的更多信息：http: [//knockoutjs.com/documentation/attr-binding.html](http://knockoutjs.com/documentation/attr-binding.html)

# silverstripe - 带有变量的 Silverstripe 3 查询

> ID：13293905
> 
> 赞同：0
> 
> 时间：2012-11-08T16:59:27.867
> 
> 标签：silverstripe

我在 Silverstripe 2.x 项目中使用了以下查询：

```
$obj = DataObject::get_one('Post', "\"URLSegment\" = '$segment'") 
```

有谁知道我将如何在新的 ORM 中复制这个查询？我试过了 ：

```
$obj = Post::get()->filter("\"URLSegment\" = '$segment'")
$obj = Post::get()->where("\"URLSegment\" = '$segment'") 
```

而且似乎都不起作用。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T22:12:03.143

您遇到的问题是 DataObject::get() 将返回对象集合，而 DataObject::get_one() 将返回指定类的单个对象。Silverstripe 3 相当于：

```
$obj = Post::get()->where("\"URLSegment\" = '$segment'")->First(); 
```

在这种情况下（与 SS2 一样），您需要确保明确注意转义以避免注入漏洞。但是，该`filter`功能现在将为您解决这个问题。所以你现在真正想要的是：

```
$obj = Post::get()->filter('URLSegment', $segment)->First(); 
```

相关文档位于：[http ://doc.silverstripe.org/framework/en/topics/datamodel](http://doc.silverstripe.org/framework/en/topics/datamodel)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T07:01:22.167

```
DataList::create('Post')->filter(array('URLSegment' => $segment))->First(); 
```

也将工作。

# windows-7 - 许可被拒绝复制我自己的文件？（赢 7）

> ID：13293910
> 
> 赞同：0
> 
> 时间：2012-11-08T16:59:53.093
> 
> 标签：windows-7, vbscript

我正在使用以下 vbscript 来备份我的文档：

```
If strMessage = vbYes Then
    Dim FSO
    Dim objShell
    Dim strDesktop 
    Dim strDocuments

    Set FSO = CreateObject("Scripting.FileSystemObject")
    Set objShell = WScript.CreateObject("Wscript.Shell")

    strDesktop = objShell.SpecialFolders("Desktop")
    strDocuments = objShell.SpecialFolders("MyDocuments")

    If FSO.DriveExists("H") Then
        FSO.CopyFolder strDesktop, "H:\Desktop", True
        FSO.CopyFolder strDocuments, "H:\Documents", True
    Else 
        MsgBox("Your personal folder is not mapped.  Please contact IT to have it mapped or created.")
    End if
Else
    MsgBox("You will be reminded again in 30 days")
End if 
```

它工作正常，除了我在复制我的文档时遇到“权限被拒绝”错误。我想不出任何理由为什么我无法复制自己的文档....这与 Windows Script Host 有关吗？

# ios - 在没有地图视图的情况下获取当前位置

> ID：13293911
> 
> 赞同：0
> 
> 时间：2012-11-08T16:59:54.560
> 
> 标签：ios, mapkit, currentlocation

> **可能重复：**
> [如何通过 iphone 应用程序中的代码获取用户的当前位置？](https://stackoverflow.com/questions/9357279/how-to-get-the-users-current-location-by-code-in-iphone-app)

我想在我的应用程序加载时抢夺当前位置 LONG 和 LAT，但不可见。

我不想在后台运行应用程序或在后台跟踪手机的位置。只需获取当前坐标（如果有）。

有没有比创建传统的 mapView 并隐藏它更干净的方法？

# java - 是否可以将 XSream 配置为不包含等于默认值的值？

> ID：13293913
> 
> 赞同：0
> 
> 时间：2012-11-08T17:00:08.470
> 
> 标签：java, xstream

我正在使用带有[注释的](http://x-stream.github.io/annotations-tutorial.html)[XStream](http://x-stream.github.io/)在我的 Java 对象和 XML 之间进行传输。我本质上是在尝试使 XML 尽可能小，我想要减少的项目之一是在不需要时包含值。当一个值是我不想将它包含在我的 xml 中时，因为它的默认值也是 false。`boolean``boolean``false`

是否可以将 XSream 配置为不包含等于默认值的值？

**鉴于：**

```
public class Test {

    @XStreamAlias("name")
    @XStreamAsAttribute
    private String name;

    @XStreamAlias("good")
    @XStreamAsAttribute
    private boolean good;

    public Test(String name, boolean good){
        this.name = name;
        this.good = good;
    }

    public static void main(String[] args) {
        XStream stream = new XStream();
        stream.processAnnotations(new Class[] {Test.class});

        Test test1 = new Test("Test", true);
        System.out.println(stream.toXML(test1));
        Test test2 = new Test("Test", false);   
        System.out.println(stream.toXML(test2));    
    }
} 
```

**这打印：**

```
<Test name="Test" good="true"/>
<Test name="Test" good="false"/> 
```

**我希望它是：**

```
<Test name="Test" good="true"/>
<Test name="Test"/> 
```

**编辑：**
我注意到 BooleanConverter 有一个名为的方法`shouldConvert`，所以我尝试通过扩展类来覆盖它。哪个不起作用，它永远不会被调用。方法：

```
@Override
public boolean shouldConvert(Class type, Object value) {
  System.out.println("Class: "+type+" Value: "+value);
  return (Boolean)value;
} 
```

我的变量注释来设置转换器`good`

```
@XStreamConverter(MyBooleanConverter.class)
@XStreamAlias("good")
@XStreamAsAttribute
private boolean good; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-11-22T10:54:40.357

我最近遇到了同样的问题，发现避免 XStream 为布尔值实例化默认值的最简单方法是让你的布尔值 java.lang.Booleans 而不是原始布尔值。

所以像这样简单地定义你的属性就可以了：

```
@XStreamAlias("good")
@XStreamAsAttribute
private Boolean good; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T18:37:20.483

您必须编写自己的`BooleanConverter`重写`toString(Objec obj)`方法。

```
public class MyBooleanConverter extends BooleanConverter{

    @Override
    public String toString(Object obj) {
        if(((Boolean)obj).equals(false)){
            return null;
        }
        return super.toString(obj);
    }   

} 
```

然后设置注释以在您想要的变量上使用转换器：

```
@XStreamConverter(MyBooleanConverter.class)
@XStreamAlias("good")
@XStreamAsAttribute
private boolean good; 
```

这可行，但需要您每次都在 XStreamConverter 中设置添加注释。我宁愿不必这样做，因为我希望我的转换器比默认的更频繁地使用。你可以用它`registerConverter`来实现。这是完整的示例：

```
public class Test {

    @XStreamAlias("name")
    @XStreamAsAttribute
    private String name;

    @XStreamAlias("good")
    @XStreamAsAttribute
    private boolean good;

    public Test(String name, boolean good){
        this.name = name;
        this.good = good;
    }

    public static void main(String[] args) {
        XStream stream = new XStream();
        stream.processAnnotations(new Class[] {Test.class});
        stream.registerConverter(new MyBooleanConverter());

        Test test1 = new Test("Test", true);
        System.out.println(stream.toXML(test1));
        Test test2 = new Test("Test", false);   
        System.out.println(stream.toXML(test2));    
    }
} 
```

# sharepoint-2010 - 客户端对象模型 - 禁用事件触发

> ID：13293916
> 
> 赞同：1
> 
> 时间：2012-11-08T17:00:18.773
> 
> 标签：sharepoint-2010

从托管客户端对象模型进行列表项更新时，有没有办法禁用事件触发？

在服务器模型中，我执行以下操作。但是，我找不到在托管客户端 ObjectModel 上执行相同操作的方法：

```
class DisabledEventsScope : SPItemEventReceiver, IDisposable
        {          // Boolean to hold the original value of the EventFiringEnabled property        
            bool _originalValue;
            public DisabledEventsScope()
            {
                // Save off the original value of EventFiringEnabled              
                _originalValue = base.EventFiringEnabled;
                // Set EventFiringEnabled to false to disable it              
                base.EventFiringEnabled = false;
            }
            public void Dispose()
            {
                // Set EventFiringEnabled back to its original value               
                base.EventFiringEnabled = _originalValue;
            }
        }

 using (DisabledEventsScope scope = new DisabledEventsScope())
                        {                            
                            // State-changing operation occurs here.
                            spItem.Update();
                        } 
```

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T08:07:50.000

您不能在客户端对象模型中执行此操作，请参阅 SP.List 对象的 MSDN 文档：http: [//msdn.microsoft.com/en-us/library/ee554951](http://msdn.microsoft.com/en-us/library/ee554951)。但是您可以开发自定义 Web 服务，该服务将从客户端调用并禁用事件触发。

# javascript - 如何在 ruby on rails 中设置复选框的值？

> ID：13293917
> 
> 赞同：1
> 
> 时间：2012-11-08T17:00:20.003
> 
> 标签：javascript, ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1

我是新手，我想知道如何在 ruby​​ on rails 的前端将复选框的值从“1”设置为“是”和“0”设置为“否”？

```
 <%= f.check_box :RDSAP_Answer, id: "enr_rds_surv_rdsap_xref_answer_check" %> 
```

现在，在浏览器中，如果我选中该框，则将值“1”存储到数据库中，如果未选中，则将空值存储在数据库中。

我想存储`Yes for checked`和`No for unchecked`在数据库中。可以在 RoR 中做吗？还是在 JavaScript 中最简单？设置值的最简单方法是什么。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:09:08.433

您应该保持复选框值不变，并根据需要使用帮助器显示值：

```
Answered: <%= object.RDSAP_answer ? 'Yes' : 'No' %> 
```

如果您经常需要这个，请为此向模型添加一个方法：

```
def display_RDSAP_answer
  RDSAP_answer ? 'Yes' : 'No'
end 
```

在您看来：

```
Answered: <%= object.display_RDSAP_answer %> 
```

# ios5 - 调用应用程序的时间：didFinishLaunchingWithOptions：在 iOS 5.x 和 iOS 6 之间有所不同

> ID：13293922
> 
> 赞同：3
> 
> 时间：2012-11-08T17:00:37.243
> 
> 标签：ios5, uiviewcontroller, ios6, uiapplicationdelegate, ios5.1

主题。

在 iOS 5.x 中，我有方法调用的下一个结果：

```
-[UIViewController initWithCoder:]
-[UIApplicationDelegate didFinishLaunchingWithOptions:]
-[UIViewController viewDidLoad]
-[UIViewController viewWillAppear:]
-[UIViewController viewDidAppear:] 
```

但在 iOS 6.x 中，它是下一个：

```
-[UIViewController initWithCoder:]
-[UIViewController viewDidLoad]
-[UIViewController viewWillAppear:]
-[UIApplicationDelegate didFinishLaunchingWithOptions:]
-[UIViewController viewDidAppear:] 
```

那么……我该怎么办？这是我的错还是苹果改变了一些逻辑？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T09:00:32.213

在你的 main.m

```
return UIApplicationMain(argc, argv, nil, NSStringFromClass([AppDelegate class])); 
```

# c++ - 不能使用 C 库（函数）

> ID：13293925
> 
> 赞同：1
> 
> 时间：2012-11-08T17:00:39.467
> 
> 标签：c++, eclipse, qt

以下是我的环境：

*   面向 C/C++ 开发人员的 Eclipse IDE(Juno)
*   Qt 4.8.3
*   Qt Eclipse 集成 v1.6.1
*   mingw(20120426)

当我创建一个 Qt 控制台项目时，我就是不能使用 C 库函数，例如`exit(int)`或`atoi(string)`.

错误信息是这样的`Function 'exit' could not be resolved`。

我已经包含`stdlib.h`，但仍然无法工作。

不知道跟指数有没有关系。

* * *

**20121109更新**

谢谢你给我帮助！

`atoi`只是一个例子！

虽然我用c++编写程序，但有时我想使用C库，所以我将它标记为c++。

以下是我包括的

*   `C:/MinGW/include`
*   `C:/MinGW/lib/gcc/mingw32/4.6.2/include`
*   `C:/MinGW/lib/gcc/mingw32/4.6.2/include/c++`
*   `C:/MinGW/lib/gcc/mingw32/4.6.2/include/c++/backward`
*   `C:/MinGW/lib/gcc/mingw32/4.6.2/include/c++/mingw32`
*   `C:/MinGW/lib/gcc/mingw32/4.6.2/include-fixed`

其他的是 Qt 库。

以下是`main`.

```
#include <QtCore>
#include <QCoreApplication>
#include <cstdlib>

using namespace std;

int main(int argc, char *argv[])
{
    std::exit(0);
    QCoreApplication a(argc, argv);
    return a.exec();
} 
```

我尝试这种方式，但仍然收到错误消息`Function 'exit' could not be resolved`。

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:07:37.443

首先，使用 C++ 标头样式。对于 stdlib.h ：

```
#include <cstdlib> 
```

然后，我猜你没有带来命名空间信息。要么写：

```
using namespace std; 
```

（即使我不推荐它）或

```
using std::exit    using std::atoi; 
```

或使用完全限定名称：

```
std::exit(-1); 
```

最后，为什么你需要像 atoi 这样的功能？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-12T17:03:03.427

我有一个类似的情况，我可以通过移动`#include <cstdlib>`到标题包含列表的顶部来解决。这意味着其他头文件之一依赖于`cstdlib`. 这不是很好的做法，但它们都是系统头文件，尝试更正它们会使代码在类似开发系统之间的可移植性降低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-03-06T09:11:12.650

我使用 Eclipse C++ 开普勒。这就是我所做的，它对我有用：右键单击编辑器屏幕>运行方式>本地 C/C++ 应用程序。

# android - 按下按钮 Home i Back 时如何完成应用程序？

> ID：13293926
> 
> 赞同：1
> 
> 时间：2012-11-08T17:00:45.217
> 
> 标签：android, xamarin.android, monocross

按下 Home 和 Back 按钮时如何完成应用程序？前提是我的记忆中有很多照片。当按下返回按钮时 - 应用程序重新启动... 当按下主页按钮时 - 退出应用程序，但当它重新启动时 - 不会启动 Splashstsreen。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:08:27.160

I don't think it's good programming practice to fiddle and interfering with the activities lifecycle. It's the OS responsibility to manage the lifecycle, including pause and finish activities. Instead you should use other methods to handle your problem with not showing splash screen, these methods are onResume and maybe also onStart(). Also you should get familiar with the activity lifecycle(link submitted by @ss1271).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:12:11.017

没有代码很难看到，但听起来您的活动正在恢复，而不是从头开始（因为它应该表现）。听起来在这种情况下它的行为是正确的。如果您坚持希望您的应用程序在单击后退按钮后真正退出，也许您可​​以覆盖 onBackPressed() 然后让您的 Activity 调用它的 finish() 方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:32:57.990

按 Home 会让活动进入`onPause()`。但是，如果您在按HOME时坚持退出应用程序，这显然不是一个好习惯，您可以这样做：

1.  覆盖`onPause()`和`onBackPressed()`
2.  添加`finish();`到这些方法。

我确信通过添加`finish();`到`onBackPressed()`将在按下后退按钮时退出应用程序，但我还没有尝试过 Home。

请参阅[活动生命周期](http://developer.android.com/reference/android/app/Activity.html#ActivityLifecycle)了解更多信息。

# c# - 应用程序的权限

> ID：13293932
> 
> 赞同：0
> 
> 时间：2012-11-08T17:01:01.883
> 
> 标签：c#, security, privilege

有没有办法获得与 C# 程序相关的权限？如果是，如何？

我知道在 C 中，您必须创建一个令牌并使用 GetTokenInformation() 方法来获取有关该令牌的信息。

C#中有类似的东西吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:02:49.913

我的 C# 有点生锈，但如果我没记错的话，这可以解决问题

```
WindowsIdentity windowsIdentity = WindowsIdentity.GetCurrent(); 
```

# c - 程序使用 fgets 停止读取文件

> ID：13293934
> 
> 赞同：0
> 
> 时间：2012-11-08T17:01:15.883
> 
> 标签：c, file, csv, fopen

如果有人可以帮助我完成我的“程序”，那就太好了。我正在尝试读取 csv 文件并将其移动到二维数组。它停在第 17 行（共 200 行）。

```
 int main ()
{
   FILE * pFile;
   double **tab;
   char bufor [100];
   int i=0;
   tab = (double**)malloc(sizeof(double*));

   pFile = fopen ("sygnal1.csv" , "r");
   if (pFile == NULL) printf("Error");
   else 
        while (fgets (bufor , 100 , pFile))
            {
            tab[i] = (double *) malloc(2 * sizeof(double));
            sscanf(bufor, "%lf, %lf,", &tab[i][0], &tab[i][1]);
            printf("%lf.%lf.\n",tab[i][0],tab[i][1]);  //It's here only for testing
            i++;
            }
    printf("number of lines read %d\n",i);
    fclose (pFile);
    system("PAUSE");
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:04:39.960

您还没有完全分配内存`tab`。您刚刚分配了一个（未初始化的）指针。当 i > 0 时，您将进入未定义的行为。您需要分配至少与文件中可能存在的行数一样多的元素，例如

```
 tab = malloc(sizeof(*tab) * MAX_LINES); 
```

或`realloc`在每次迭代后使用以增加元素的数量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T17:05:16.997

```
tab = (double**)malloc(sizeof(double*)); 
```

您只在此数组中分配 1 个元素。所有其他访问都在写入未分配的内存块，并可能造成损坏。

`realloc`定期尝试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T17:06:54.153

您在选项卡中只为一个双 * 创建了位置，如果您知道要存储的行数，请执行以下操作：

```
tab = malloc(sizeof(*tab) * NB_LINES); 
```

另外，不要强制返回 malloc。

# asp.net-mvc-3 - 如果需要父类，则需要属性

> ID：13293938
> 
> 赞同：0
> 
> 时间：2012-11-08T17:01:22.617
> 
> 标签：asp.net-mvc-3, data-annotations, modelstate

我对 MVC3 模型验证和 DataAnnotations 有疑问

我有以下课程：

```
public class A
{
    public C SomeProperty {get;set;}
}

public class B
{
    [Required]
    public C SomeProperty {get;set;}
}
public class C
{
    [Required]
    public string SomeSubProperty {get;set;}
} 
```

这是因为某些对象可能需要 C 而其他对象不需要 C，但如果需要 C，我希望 SomeSubProperty 也需要。

但是，当我在控制器中调用 ModelState.IsValid 时，如果 SomeSubProperty 未设置，则在同时使用 A 和 B 作为模型时它会返回 false。有什么办法可以产生这种行为？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T22:57:14.097

我通常不会将“域模型”与“视图模型”混合在一起。

领域模型反映了业务关系，它可能非常复杂，而视图模型假设非常扁平并且没有深层次的依赖关系，因此您可以使用注释。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T23:33:57.087

看看[AutoMapper](https://github.com/AutoMapper/AutoMapper/wiki/Getting-started)。定义具有特定要求的每个 ViewModel，并在验证成功后将其映射到域模型以进行处理。

# asp.net - 如何在 SessionSecurityTokenCreated 时有条件地设置 FedAuth cookie SessionToken.IsPersistent

> ID：13293939
> 
> 赞同：3
> 
> 时间：2012-11-08T17:01:25.330
> 
> 标签：asp.net, session-cookies, wif, ws-federation

我将 WIF 与 WS Federation 一起使用，以便我的 ASP.NET 应用程序可以针对 STS（Thinktecture IdentityServer）进行身份验证。在我的 RP 中，我想根据用户的声明务实地设置 cookie 持久性。

观察 Fiddler 中的流量，我可以看到 WIF FedAuth cookie 是在 STS 令牌发布到 RP 时首次设置的。在设置 cookie 之前，我想拦截一些事件并根据当前声明将 cookie 设置为持久（或不持久）。

我知道我可以在 web.config 中设置 cookie 持久性，但是这种行为需要基于用户的条件。

 ~~~~```
<wsFederation ... persistentCookiesOnPassiveRedirects="true" /> 
```~~  ~~我的第一种方法是尝试处理各种 SessionSecurityTokenCreated 事件，但这些事件似乎从未被触发。 **我是否错误地添加了处理程序？或者有没有更好的方法来做到这一点？**

```
protected void Application_Start()
{
    ...

    FederatedAuthentication.SessionAuthenticationModule.SessionSecurityTokenCreated +=
        new EventHandler<SessionSecurityTokenCreatedEventArgs>(SessionAuthenticationModule_SessionSecurityTokenCreated);

    FederatedAuthentication.WSFederationAuthenticationModule.SessionSecurityTokenCreated +=
        new EventHandler<SessionSecurityTokenCreatedEventArgs>(WSFederationAuthenticationModule_SessionSecurityTokenCreated);

}

//This never seems to fire...
void SessionAuthenticationModule_SessionSecurityTokenCreated(object sender,
        SessionSecurityTokenCreatedEventArgs e)
{
    if (e.SessionToken.ClaimsPrincipal.HasClaim("someClaim", "someValue"))
        e.SessionToken.IsPersistent = true;
    else
        e.SessionToken.IsPersistent = false;
}

//This never seems to fire either...
void WSFederationAuthenticationModule_SessionSecurityTokenCreated(object sender,
        SessionSecurityTokenCreatedEventArgs e)
{
    if (e.SessionToken.ClaimsPrincipal.HasClaim("someClaim", "someValue"))
        e.SessionToken.IsPersistent = true;
    else
        e.SessionToken.IsPersistent = false;            

} 
```

有趣的是：如果我为 SessionAuthenticationModule_SessionSecurityTokenReceived 添加一个处理程序，这个事件似乎会触发。在这里，我可以重新发出 cookie 并设置*IsPersistent = true*但这直到第一次设置 cookie 后才会被触发，我更愿意在第一次发出 cookie 时执行此操作。

经过一番测试：如果我在 SessionAuthenticationModule_SessionSecurityTokenReceived 中重新发出 cookie，那么 SessionAuthenticationModule_SessionSecurityTokenCreated 将被触发。我只是似乎无法找出为什么当令牌首次发布到 RP 时在初始创建 cookie 时没有触发它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T21:28:02.977

我的问题的根源是：a）我使用的是自定义 WSFederationAuthenticationModule。b) 我没有使用自定义模块的名称来连接 Global.asax 中的事件。

假设我的 web.config 里面有这个：

```
<system.webServer>

// ...

    <add name="MyCustomWSFederationAuthenticationModule"
     type="MyLib.MyCustomWSFederationAuthenticationModule, Thinktecture.IdentityModel, Version=1.0.0.0, Culture=neutral"
     preCondition="managedHandler" />

    <add name="SessionAuthenticationModule"
     type="System.IdentityModel.Services.SessionAuthenticationModule, System.IdentityModel.Services, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089"
     preCondition="managedHandler"  />

// ...

</system.webServer> 
```

并假设“MyCustomWSFederationAuthenticationModule”是自定义 fed-auth 模块的名称。然后我只需要修复方法处理程序的名称（在应用程序启动中没有任何内容）。

```
protected void Application_Start()
{
    //Nothing here.
}

//This never seems to fire either...
void MyCustomWSFederationAuthenticationModule_SessionSecurityTokenCreated(object sender,
        SessionSecurityTokenCreatedEventArgs e)
{
    if (e.SessionToken.ClaimsPrincipal.HasClaim("someClaim", "someValue"))
        e.SessionToken.IsPersistent = true;
    else
        e.SessionToken.IsPersistent = false;            
} 
```~~~~

# mysql - InnoDB 外键定义无法解析列名

> ID：13293941
> 
> 赞同：1
> 
> 时间：2012-11-08T17:01:40.160
> 
> 标签：mysql, foreign-keys, innodb

我在两个表之间创建外键约束时遇到问题。

这是第一个表：

```
CREATE TABLE `agews_rifiuti_cer` (
  `id_cer` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `agews_id` int(10) unsigned DEFAULT '0',
  `livello` tinyint(4) DEFAULT '1',
  `codice` varchar(10) DEFAULT NULL,
  `descrizione` varchar(255) DEFAULT NULL,
  `note` text,
  `flag_pericoloso` tinyint(1) DEFAULT '0',
  `id_cliente` int(10) unsigned DEFAULT '1',
  `flag_modificato` char(1) DEFAULT 'N',
  PRIMARY KEY (`id_cer`),
  KEY `fk_id_cliente_agews_sgs_codici_cer` (`id_cliente`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8; 
```

这是第二个：

```
CREATE TABLE `lin_98_47_rifiuti` (
  `id_rifiuto` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `id_azienda` int(10) unsigned NOT NULL DEFAULT '1',
  `id_sede` int(10) unsigned NOT NULL DEFAULT '1',
  `revisione_documento` int(10) unsigned NOT NULL DEFAULT '0',
  `rifiuto` varchar(255) DEFAULT NULL,
  `codice_cer` varchar(10) DEFAULT NULL,
  `nome_interno` varchar(255) DEFAULT NULL,
  `descrizione` text,
  `materie_prime` text,
  `contenitore` text,
  `deposito` text,
  `data_ultima_analisi` date DEFAULT NULL,
  `stato_fisico` enum('Solido pulverulento','Solido non pulverulento','Fangoso palabile','Liquido') DEFAULT 'Solido non pulverulento',
  `quantita` float(9,1) DEFAULT '0.0',
  `unita_misura` enum('Kg','l','mc') DEFAULT 'Kg',
  `id_pericolo` int(10) unsigned DEFAULT NULL,
  `destino` enum('Recupero','Smaltimento') DEFAULT NULL,
  `id_recupero` int(10) unsigned DEFAULT NULL,
  `id_smaltimento` int(10) unsigned DEFAULT NULL,
  `id_cer` int(10) unsigned DEFAULT NULL,
  `immagine` varchar(255) DEFAULT NULL,
  `image_type` varchar(20) DEFAULT NULL,
  `image_content` mediumblob,
  `image_size_x` smallint(5) unsigned DEFAULT '0',
  `image_size_y` smallint(5) unsigned DEFAULT '0',
  `flag_storico` tinyint(1) DEFAULT '0',
  `id_responsabile` int(10) unsigned DEFAULT '0',
  `nome_responsabile` varchar(255) DEFAULT '0',
  `id_ultima_modifica` int(10) unsigned DEFAULT '0',
  `create_log` tinyint(1) DEFAULT '1',
  PRIMARY KEY (`id_rifiuto`,`id_azienda`,`id_sede`,`revisione_documento`),
  KEY `fk_main_lin_98_47_rifiuti` (`id_azienda`,`id_sede`,`revisione_documento`),
  KEY `fk_id_responsabile_lin_98_47_rifiuti` (`id_responsabile`,`id_azienda`,`id_sede`,`revisione_documento`,`nome_responsabile`),
  KEY `fk_id_pericolo_lin_98_47_rifiuti` (`id_pericolo`),
  KEY `fk_id_recupero_lin_98_47_rifiuti` (`id_recupero`),
  KEY `fk_id_smaltimento_lin_98_47_rifiuti` (`id_smaltimento`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8; 
```

问题发生在我尝试这样做：

```
ALTER TABLE lin_98_47_rifiuti ADD CONSTRAINT fk_id_cer_lin_98_47_rifiuti FOREIGN KEY (id_cer) REFERENCES agews_rifiuti_cer(id_cer) ON UPDATE CASCADE ON DELETE CASCADE; 
```

我得到这个错误：

```
#1005 - Can't create table 'db_626suite.#sql-71c_13d5' (errno: 150) 
```

虽然命令 SHOW INNODB STATUS 说：

```
Error in foreign key constraint of table db_626suite/#sql-71c_13d5:
 FOREIGN KEY (id_cer) REFERENCES agews_rifiuti_cer(id_cer) ON UPDATE CASCADE ON DELETE CASCADE:
Cannot resolve column name close to:
) ON UPDATE CASCADE ON DELETE CASCADE 
```

但是语法和字段定义对我来说似乎是正确的。我究竟做错了什么？

编辑：

**Marc B**建议这可能是由于`id_cer`定义为`NOT NULL`in的事实`agews_rifiuti_cer`，但我不认为是这种情况，实际上请考虑另一个表：

```
CREATE TABLE `agews_rifiuti_pericolo` (
  `id_pericolo` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `agews_id` int(10) unsigned DEFAULT '0',
  `codice` varchar(255) DEFAULT NULL,
  `pericolo` varchar(255) DEFAULT NULL,
  `note` text,
  `id_cliente` int(10) unsigned DEFAULT '1',
  `flag_modificato` char(1) DEFAULT 'N',
  PRIMARY KEY (`id_pericolo`),
  KEY `codice_rifiuti_recupero` (`codice`),
  KEY `fk_id_cliente_rifiuti_pericolo` (`id_cliente`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8; 
```

这里`id_pericolo`的定义`NOT NULL`如上`id_cer`，但它完美地工作：

```
ALTER TABLE lin_98_47_rifiuti ADD CONSTRAINT fk_id_pericolo_lin_98_47_rifiuti FOREIGN KEY (id_pericolo) REFERENCES agews_rifiuti_pericolo(id_pericolo) ON UPDATE CASCADE ON DELETE SET NULL; 
```

即使在`lin_98_47_rifiuti`字段`id_pericolo`中定义为`DEFAULT NULL`

编辑2：

我刚刚尝试了这个最小的设置：

```
CREATE TABLE `cer` (
  `id_cer` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `codice` varchar(10) DEFAULT NULL,
  PRIMARY KEY (`id_cer`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

CREATE TABLE `rifiuti` (
  `id_rifiuto` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `id_cer` int(10) unsigned NULL DEFAULT NULL,
  `rifiuto` varchar(10) DEFAULT NULL,
  PRIMARY KEY (`id_rifiuto`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8;

ALTER TABLE rifiuti ADD FOREIGN KEY (id_cer) REFERENCES cer(id_cer) ON UPDATE CASCADE ON DELETE CASCADE; 
```

一切正常，但我不明白我的原始查询中可能存在什么问题。

另外我认为这证明这不是将字段定义为`NOT NULL`or的问题`DEFAULT NULL`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:05:04.200

您在 lin_98_47 表中定义`id_cer`为`default null`，但另一个表中匹配的 FK 字段定义为`not null`.

字段定义必须完全匹配才能建立外键关系，其中包括可空性：

```
`id_cer` int(10) unsigned NOT NULL AUTO_INCREMENT,

`id_cer` int(10) unsigned DEFAULT NULL, 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-09T08:02:24.373

我真的不明白**为什么**，但是在所有表中重命名`id_cer`为`id_codice`，同时保持其定义不变，解决了这个问题。

因此，MySQL 似乎对该特定​​字段名称存在某种问题。

# c# - 进度条表单未完全加载

> ID：13293944
> 
> 赞同：0
> 
> 时间：2012-11-08T17:01:50.650
> 
> 标签：c#, winforms, progress-bar

我正在编写一个可能需要相当长的加载时间（5-30 秒）的程序。我想要一个以选取框样式进度条开头的表单，以便用户知道正在做某事。

```
public FrmMain()
{
     var loading = new FrmLoading();
     loading.Show();

     InitializeComponent();

     // other start up code here

     loading.Close()
} 
```

现在，`loading`弹出就好了。问题是标签和进度条什么都没有显示，而且看起来它们几乎要崩溃了。我已经研究过`BackgroundWorker`，但是，老实说，我并不完全理解如何使它为我工作。我尝试按照以下教程和示例进行操作：

*   [C# 中的 BackgroundWorker 基础知识](http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/)
*   [C# 后台工作者](http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/)
*   [进度条](http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/)
*   [BackgroundWorker 类](http://www.dreamincode.net/forums/topic/112547-using-the-backgroundworker-in-c#/)

但我的头就是没有抓住它。有没有其他方法可以让表单正确加载？感谢您的任何帮助。

**编辑**

我的`BackgroundWorker`尝试包括创建一个函数，该函数执行我在`FrmMain`. 所以，我有：

```
public FrmMain()
{
    Loading = new FrmLoading();
    Loading.Show();

    backgroundWorker1.RunWorkerAsync();
}

private void FormLoading()
{
     // Initialize and loading elements of the form
     InitializeComponent();
}
private void BackgroundWorker1DoWork(object sender, DoWorkEventArgs e)
{
    FormLoading();
}

private void BackgroundWorker1RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    Loading.Close();
} 
```

但我一直`NullReferenceException`在`backgroundWorker1.RunWorkerAsync();`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T18:21:44.333

一个鲜为人知或经常被遗忘的框架库是 Microsoft.VisualBasic。您可以将它与 C# 应用程序一起使用。只需添加一个 Reference ... 和这个类。它处理所有后台工作线程和其余部分。

```
public class MyApplication : WindowsFormsApplicationBase
{
    private static MyApplication _application;

    public static void Run(Form form)
    {
        _application = new MyApplication{ MainForm = form };
        _application.Run(Environment.GetCommandLineArgs());
    }

    protected override void OnCreateSplashScreen()
    {
        this.SplashScreen = new MySplashScreenForm();
    }
} 
```

最后，将 Program.Main() 下的应用启动更改为：

```
Application.Run(new Form1()); 
```

到

```
 MyApplication.Run(new Form1()); 
```

如果你不熟悉，这个类还提供了更多的特性，比如单实例处理，绝对值得一看。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T20:28:27.053

也许这会有所帮助：

添加一个：

```
Shown += new EventHandler(Form1_Shown); 
```

在你的`InitializeComponent();`.

并添加：

```
void Form1_Shown(object sender, EventArgs e)
{
    Refresh();
} 
```

此外，如果您没有订阅`BackgroundWorker1DoWork`Designer 中的事件处理程序，则必须添加：

```
backgroundWorker1.DoWork += new DoWorkEventHandler(backgroundWorker1_DoWork); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-08T22:03:54.037

我最终做的可能并不优雅，但它完成了我所需要的。

```
public FrmMain()
{    
     InitializeComponent();

     backgroundWorker1.RunWorkerAsync();

     var loading = new FrmLoading();
     loading.ShowDialog();
}

private void BackgroundWorker1DoWork(object sender, DoWorkEventArgs e)
{
    DbQuery();
}

private void BackgroundWorker1RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    Loading.Close();
} 
```

这会调出我的`loading`表单，使其具有焦点并完全加载。由于我在调用`DoWork`之前调用了`ShowDialog()`，因此`BackgroundWorker`继续工作。完成后，它`DbQuery()`会调用`BackgroundWorker1RunWorkerCompleted()`，它会关闭我`FrmLoading`并继续执行我的程序。感谢所有发帖的人。

# c# - 网格视图中多个页面的总计和运行总计

> ID：13293952
> 
> 赞同：0
> 
> 时间：2012-11-08T17:02:20.993
> 
> 标签：c#, gridview, cumulative-sum

我在页脚有一个总计的gridview。我的分页每页只允许 25 条记录。因此，当有多个页面时，应该有运行总计和总计。谁能帮我写代码。下面是一列总计的代码。

```
<asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false" AllowSorting="true" ShowFooter="True" OnPageIndexChanging="GridView1_PageIndexChanging" OnDataBound="GridView1_DataBound" OnRowDataBound="GridView1_RowDataBound" OnRowCreated="GridView1_RowCreated">
<asp:TemplateField ItemStyle-HorizontalAlign="Center" HeaderStyle-Width="30px"                                                                                                          HeaderStyle-VerticalAlign="Top" ItemStyle-Wrap="True">
<ItemTemplate>
<asp:Label ID="lblcriteria" runat="server" Text='<%# DataBinder.Eval(Container.DataItem,"CRITERIA_N") %>' />
</ItemTemplate></asp:TemplateField>
<asp:TemplateField HeaderText="Period" SortExpression="PERIOD_N" ItemStyle-HorizontalAlign="Center"
 HeaderStyle-VerticalAlign="Top" ItemStyle-Wrap="True">
<ItemTemplate>
<asp:Label ID="lblPERIOD_N" runat="server" Text='<%# DataBinder.Eval(Container.DataItem,"PERIOD_N") %>' /></ItemTemplate></asp:TemplateField>
<asp:TemplateField HeaderText="Receipts" SortExpression="CHECK_AMT_A_USD" ItemStyle-HorizontalAlign="Center"
HeaderStyle-VerticalAlign="Top" HeaderStyle-Width="70px">
<ItemTemplate>
<asp:Label ID="lblReceipt" runat="server" Text='<%# DataBinder.Eval(Container.DataItem,"CHECK_AMT_A_USD") %>' /></ItemTemplate>
<FooterTemplate>
<asp:Label ID="lbltotReceipt" runat="server"></asp:Label>
<asp:Label ID="lblgrangtot" runat="server"></asp:Label>
</FooterTemplate>
</asp:TemplateField>
</column> 
```

aspx.cs

```
protected void GridView1_RowDataBound(object sender, GridViewRowEventArgs e)
{
    GridView grid = sender as GridView;
    DataRowView tableData = e.Row.DataItem as DataRowView;
    DataTable dt = Session["List"] as DataTable;       

    if (e.Row.RowType == DataControlRowType.Header)
    {
        totreceipt = 0; 
    }
    if (e.Row.RowType == DataControlRowType.DataRow)
    {
        Label lblReceipt = (Label)e.Row.FindControl("lblReceipt");
        totreceipt += Convert.ToDecimal(tableData["CHECK_AMT_A_USD"]);
    }
    if (e.Row.RowType == DataControlRowType.Footer)
    {

        Label lbltotReceipt = (Label)e.Row.FindControl("lbltotReceipt");
        lbltotReceipt.Text = string.Format("{0:N2}", totreceipt);
        e.Row.Cells[0].Text = "Total:";
    }

} 
```

我无法通过示例。这些很令人困惑。所以请帮助编码。

更新：

这是我的SP..

```
CREATE procedure [dbo].[SP_AVG_DAYS]      

@Cont_C char(1),      
@Month_dd varchar(10),        
@MonYr_S VARCHAR(12),        
@2_Div_Code VARCHAR(2)       

As                  

DECLARE @SelectText varChar(2000)                         
DECLARE @Table varchar(30)      

IF @2_Div_Code <> ''    
BEGIN    
 IF @MonYr_S='Div_Reg'    
 BEGIN    
  SET @Table='VW_BPDP_DIV_REG'    
 END    
 IF @MonYr_S='Div_Area'    
 BEGIN     
  SET @Table='VW_BPDP_DIV_AREA'    
 END    
 IF @MonYr_S='Div_Loc'    
 BEGIN     
  SET @Table='VW_BPDP_DIV_LOC'    
 END 
 END

SET @SelectText='SELECT CRITERIA_N,HEADER_N,PERIOD_N,CHECK_RECEIPT, BP_DAYS 
FROM ' + @Table + '       
WHERE  CONT_C = ''' + @Cont_C + ''' AND DIV_C = ''' + @2_Div_Code + ''' '     

EXECUTE(@SelectText) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:22:20.323

从您的代码中运行总计可以确定。您可以通过将每个页面的运行总计保存到 viewState 或 Session 中来计算总计。或者您想从一开始就显示所有条目的总计？

我假设您不需要所有表格的 GrandTotal，所以我建议您使用另一个 varchar 变量：@SelectCriteria，您将其设置在您想要总计的地方

```
CREATE procedure [dbo].[SP_AVG_DAYS]   
@Cont_C char(1),      
@Month_dd varchar(10),        
@MonYr_S VARCHAR(12),        
@2_Div_Code VARCHAR(2),        
@2_Reg_Code VARCHAR(3),        
@2_Area_Code VARCHAR(3),        
@2_CR_Code VARCHAR(3)       

As                  

DECLARE @SelectText varChar(2000)                         
DECLARE @SelectCriteria varChar(100)    
DECLARE @Table varchar(30)      

IF @2_Div_Code <> ''    
BEGIN    
IF @MonYr_S='Div_Reg'    
 BEGIN    
   SET @SelectCriteria =', Sum(_columnWithValues) as GrandTotal'
   SET @Table='IA_VPAYMENTS_BPDP_DIV_REG'    
 END    
IF @MonYr_S='Div_Area'    
  BEGIN     
SET @Table='IA_VPAYMENTS_BPDP_DIV_AREA'    

END    
 IF @MonYr_S='Div_Loc'    
 BEGIN     
  SET @Table='IA_VPAYMENTS_BPDP_DIV_LOC'    
 END 
 END

SET @SelectText='SELECT CRITERIA_N,HEADER_N,PERIOD_N,CHECK_RECEIPT, BP_DAYS' + @SelectCriteria + ' FROM ' + @Table + 'WHERE  CONT_C = ''' + @Cont_C + ''' AND DIV_C = ''' + @2_Div_Code + ''' '     
EXECUTE(@SelectText) 
```

# c - 为什么服务器套接字提供与绑定端口号不同的端口号？

> ID：13293953
> 
> 赞同：4
> 
> 时间：2012-11-08T17:02:20.563
> 
> 标签：c, sockets, network-programming, endianness

我正在用 C 编写一个小型套接字程序。在服务器端，我使用 socket() 系统调用创建了一个套接字描述符，然后我将该套接字与一个端口绑定。在此之后，我试图获取描述符的 IP/端口号，它提供的端口与绑定端口号没有什么不同。我正在尝试使用 getsockname() 方法取回 IP/端口，使用此方法是否正确？请帮我。

```
#define SERVER_ADDR "127.0.0.1"
#define SERVER_PORT "9090" // actual port no I am binding
#define QUEUE_LENGTH 10

int main()
{
struct addrinfo hints, *servinfo, *temp;

memset(&hints,0,sizeof hints);
hints.ai_family = AF_UNSPEC;
hints.ai_socktype = SOCK_STREAM;

// here I am passing SERVER_PORT == 9090
int status = getaddrinfo(SERVER_ADDR,SERVER_PORT,&hints,&servinfo);
if(status != 0)
{
printf("Server: getaddrinfo() errored with code %d\n",status);
return;
}

int sfd = -1;
for(temp = servinfo; temp != NULL; temp = servinfo->ai_next)
{
sfd = socket(temp->ai_family,temp->ai_socktype,temp->ai_protocol);
if(sfd == -1)
{
  printf("Server: Socket error with code %d\n",sfd);
  continue;
}

status = bind(sfd,temp->ai_addr,temp->ai_addrlen);
if(status == -1)
{
  printf("Server: Bind error with code %d\n",status);
  continue;
}
printf("Server: Bind Successful\n");

// un necessary code goes here
struct sockaddr_in server_address;
char ipv4[INET_ADDRSTRLEN];
int addr_size = sizeof(server_address);
// i am using below method to get the port no from socket descriptor
getsockname(sfd, (struct sockaddr *)&server_address, &addr_size);

// I am expecting below will print 9090\. but it prints different port no why ? 
printf("Server Port: %d\n",server_address.sin_port);
printf("Port from getsddrinfo: %d\n",( (struct sockaddr_in *)temp->ai_addr)->sin_port);

inet_ntop(AF_INET, &(server_address.sin_addr),ipv4,INET_ADDRSTRLEN);
printf("Server IP Address: %s\n",ipv4);
// un necessary code ends here
break;
}

if(temp == NULL)
{
printf("Server: Failed to bind\n");
return;
}
status = listen(sfd,QUEUE_LENGTH);
if(status == -1)
{
printf("Server: Listening failed\n");
return;
}
printf("Server: waiting for coneections...\n");

while(1)
{
printf("Server: Main loop, will wait for client to connect...\n");
struct sockaddr client_address;
int addr_length = sizeof client_address;
// accepting client
int new_sfd = accept(sfd,&client_address,&addr_length); 
}
printf("Server: Done!\n"); 
} 
```

输出是：

```
Server: Bind Successful
Server Port: 33315 --> why this different from one I have binded (9090)
Port from getsddrinfo: 33315 --> why this different from one I have binded (9090)
Server IP Address: 127.0.0.1
Server: waiting for coneections...
Server: Main loop, will wait for client to connect... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T17:13:14.830

的十进制成员`struct sockaddr`按网络字节顺序返回。

因此，您需要将这些值转换为主机字节顺序，`ntoh`在使用它们之前使用函数族，打印它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:12:50.790

`hints.sin_port = htons( 9090 );`之后添加`hints.ai_socktype = SOCK_STREAM;`

# matlab - 检测到分割违规 - matlab

> ID：13293956
> 
> 赞同：6
> 
> 时间：2012-11-08T17:02:30.960
> 
> 标签：matlab, segmentation-fault, matlab-figure

`Segmentation violation detected`每当我尝试将图形保存为 jpg 或 png 时，都会在 Matlab 7.12.0.635 (R2011a)（在 Ubuntu 12.10 上）中出现错误。我可以将图形保存为 .fig，但...

我能做些什么来解决这个问题？你遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-29T12:55:16.443

通过将默认渲染器更改为`zbuffer`. 将此行添加到`startup.m`文件中：

> `set(0, 'DefaultFigureRenderer', 'zbuffer');`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-29T05:00:51.230

我通过安装 matlab-support 包解决了这个问题，

```
 sudo apt-get install matlab-support 
```

# interface - 使用隐式接口调用外部过程的模块

> ID：13293964
> 
> 赞同：3
> 
> 时间：2012-11-08T17:02:52.197
> 
> 标签：interface, module, fortran90, subroutine

以下代码，结合**模块程序**和**外部程序**：

```
module module_dummy

  implicit none

contains

  subroutine foo(a)

    real, intent(inout) :: a(:)

    call bar(a)

  end subroutine foo

end module module_dummy

program main

  use module_dummy

  implicit none 

  integer, parameter :: nelems = 100000000
  real,  allocatable :: a(:)

  allocate( a(nelems) )
  a = 0.0
  call foo(a)
  print *, a(1:10)
  deallocate(a)

end program main

subroutine bar(a)

  implicit none

  real, intent(inout) :: a(:)

  a = 1.0      

end subroutine bar 
```

似乎失败了：

1.  与`segmentation fault`
2.  打印一个块`0.000`而不是一个块`1.000`

在我迄今为止尝试过的任何平台上。该问题与 的**隐式接口声明**有关`bar`，实际上可以通过任何方式添加显式接口来解决该问题，例如使用：

```
module module_dummy

  implicit none

contains

  subroutine foo(a)

    interface 
       subroutine bar(x)
         real, intent(inout) :: x(:)
       end subroutine bar
    end interface

    real, intent(inout) :: a(:)

    call bar(a)

  end subroutine foo

end module module_dummy 
```

或`bar`在要由`module_dummy`.

无论如何，我真的不明白首先是什么错误。我在[Fortran 90 标准](ftp://ftp.nag.co.uk/sc22wg5/N001-N1100/N692.pdf)（第 12.3.2.4 节）中发现的内容是：

> 从过程接口是隐式的作用域单元引用的过程的类型、类型参数和虚拟参数的形状必须使得实际参数与虚拟参数的特征一致。

在这种情况下，该规则似乎得到了尊重，因为`a`它总是被声明为

```
real, intent(inout) :: a(:) 
```

那么，我在解释使先前代码错误的标准时遗漏了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-08T20:52:13.783

假定形状的虚拟参数必须在其参考点具有显式接口。F90 12.3.1.1 项目 2c。

实际上，假设的形状数组是通过传递一个描述符来传递的——一个描述数组的边界和存储位置的小结构。Ye-olde F77 显式形状和假定大小的数组只需传递第一个元素的地址即可。如果没有显式接口，编译器不知道它需要构建和传递描述符——因此会导致混乱和混乱。

# javascript - 连续 x 轴背景图像幻灯片

> ID：13293974
> 
> 赞同：0
> 
> 时间：2012-11-08T17:03:29.917
> 
> 标签：javascript, jquery, css, loops, slide

我有一个带有大图像背景 css 规则的 div 元素。

现在我想在x轴平滑滑动图像，有没有轻量级的插件或片段？

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:23:17.020

这是 webkit 的样式：http: [//jsbin.com/uzifag/2/](http://jsbin.com/uzifag/2/)

请注意，我将背景位置移动到图像的负宽度。如果您希望它是相反的方向，则正宽度将起作用。您可以根据需要播放动画的持续时间。

```
body{
  background:url(http://placekitten.com/1920/1080/) repeat-x center left;
  -webkit-animation: slidex 20s linear infinite;
     -moz-animation: slidex 20s linear infinite;
      -ms-animation: slidex 20s linear infinite;
       -o-animation: slidex 20s linear infinite;
          animation: slidex 20s linear infinite;
}

@-webkit-keyframes slidex
{
  FROM{background-position:0 center;}
  TO{background-position:-1920px center;}
}
@-moz-keyframes slidex
{
  FROM{background-position:0 center;}
  TO{background-position:-1920px center;}
}
@-ms-keyframes slidex
{
  FROM{background-position:0 center;}
  TO{background-position:-1920px center;}
}
@-o-keyframes slidex
{
  FROM{background-position:0 center;}
  TO{background-position:-1920px center;}
}
@keyframes slidex
{
  FROM{background-position:0 center;}
  TO{background-position:-1920px center;}
} 
```

# sql - 一个月前 (SQL)

> ID：13293975
> 
> 赞同：0
> 
> 时间：2012-11-08T17:03:33.470
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2005

我正在尝试在 SQL 查询中挖掘更多内容，我同意了。

```
Yearmo      Back_1_month
-------     ------------
 201202      201201            Where 201202 is Feb 2012 , 201201 is Jan 2012
 201201      201112            
 201204      201203            
 201212      201211 
```

我很困惑，怎么能做到201201。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:12:14.163

假设这`yearmo`是一个`int`：

```
DECLARE @Yearmo INT
SET @Yearmo = 201201

-- First, convert yearmo to a varchar.
-- Next, add a "day" portion to the varchar.
-- Then, convert to a date.
-- Then, subtract a month.
-- Finally, convert back to your original format using char(6).
SELECT CONVERT(
    CHAR(6), 
    (DATEADD(MONTH, -1, CAST(CAST(@YearMo AS VARCHAR) + '01' AS DATETIME))), 
    112
) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:07:43.317

要减去一个月，您可以像这样使用[DATEADD](http://msdn.microsoft.com/en-us/library/ms186819.aspx)

```
SELECT DATEADD(month, -1, yearmo) 
```

但是你需要格式化你的日期，`yearmo`如果不是，你可能需要转换为日期时间。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T17:15:38.090

这适用于一个 sql 查询：

```
SELECT CONVERT(VARCHAR(6), DATEADD(month, -1 , convert(datetime, CAST ( 201201 AS VARCHAR(8)) + '01', 112) ) , 112) 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-08T17:25:32.117

试试这个：

```
SELECT yearmo, 
LEFT(CONVERT(CHAR(8), DATEADD(month, -1, CONVERT(datetime, yearmo + '01')), 112), 6)
FROM <YOUR_TABLE> 
```

[SQL小提琴](http://sqlfiddle.com/#!3/594c5/16)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-08T17:15:13.410

您可以创建一个参数为 yearmo 的存储过程，然后将 substring(yr) 和 substring(mo) 保存在两个变量中，然后查看，如果 substring(mo) 为 01，则在转换后递减 substring(yr) 并更改 substring(mo)到 12，然后追加子字符串并返回。

# php - 有没有更好的方法来构建具有搜索功能的 PHP 数组？

> ID：13293976
> 
> 赞同：3
> 
> 时间：2012-11-08T17:03:33.307
> 
> 标签：php, mysql, arrays, multidimensional-array

我经营一个网站，允许数百名客户在线销售产品。当客户访问我客户的一个网站时，他们会以以下形式访问

> www.site.com?userid=12345

在登录页面上，我们使用 mysql 查找有关用户 ID 为 12345 的客户的信息以及他/她可以销售的产品列表。我们只提供约 30 种产品的套件，我们对其进行定义，以便我们知道它们的外观，但并非所有客户都能以相同的价格提供。此信息的 mysql 表如下所示：

```
userid | category | itemid | price
=================================
12345  |    1     |  1     | 1.00
12345  |    1     |  2     | 2.00
12345  |    1     |  3     | 3.00
12345  |    2     |  4     | 4.00
12345  |    2     |  5     | 5.00
67890  |    1     |  1     | 2.25
67890  |    2     |  4     | 8.00 
```

当客户访问 www.site.com?userid=12345 时，会使用以下内容进行查找：

```
SELECT category, itemid, price FROM tablename WHERE userid = 12345 
```

*注意 - 是的，我阻止了 sql 注入。

我遇到的问题是如何在 PHP 中构建后续数组。我最初的想法是：

```
<?php
...

while ($row = $stmt->fetch()) {
  $products[]['category'] = $row['category'];
  $products[]['itemid'] = $row['itemid'];
  $products[]['price'] = $row['price'];
}

//the array will end up looking like this:
Array
(
    [0] => Array
        (
            [category] => 1
            [itemid] => 1
            [price] => 1
        )
    [1] => Array
        (
            [category] => 1
            [itemid] => 2
            [price] => 2
        )
    [2] => Array
        (
            [category] => 1
            [itemid] => 3
            [price] => 3
        )
    [3] => Array
        (
            [category] => 2
            [itemid] => 4
            [price] => 4
        )
    [4] => Array
        (
            [category] => 2
            [itemid] => 5
            [price] => 5
        )
)

?> 
```

我需要捕获这样的信息的原因：在实际站点本身上，有两个主要类别（食物和饮料）。如果客户在 $products 中有类别 1 的任何产品，请在页面上显示 Food html 部分。如果客户在 $products 中有类别 2 的任何产品，请在页面上显示 Drinks html 部分。

然后，有一组预定义的 itemid 可用于所有类别。就食物而言，有4种：

1.  意大利辣香肠
2.  香肠
3.  起司
4.  蔬菜

如果用户没有这些 itemid 之一，他/她将无法销售该产品，并且该产品不会出现在 Food html 部分中。如果他们能够销售该产品，我希望能够参考该部分/项目的价格并将其显示在实际项目旁边。

我知道我的 $products 数组将包含我需要的所有信息，但我不确定我构建它的方式是否最好，或者在构建所描述的页面时如何真正引用它。

例如（我知道这段代码不正确，但说明了我想要完成的事情）：

*   “如果 $products 类别数组中存在值 1，则显示食品部分。”
*   “如果 $products itemid 类别数组中存在值 1，则将 Pepperoni Pizza 显示为页面上的一个选项，并显示与该特定类别/itemid 组合相关的价格。”

任何指导表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T17:06:53.240

```
$products[]['category'] = $row['category'];
$products[]['itemid'] = $row['itemid'];
$products[]['price'] = $row['price']; 
```

这将为每个属性创建一个新数组；采用

```
$products[] = $row; 
```

…将行内容复制到产品数组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T17:25:36.953

我不确定我是否遵循您提出的所有要求，但是当您遍历行时，为什么不在那里进行您的类别检查。

```
//setup some flags
$food  = false;
$drink = false;

while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { //fetch an assoc array
  $products[] = $row;
  if(!$food AND 1 == $row['category']){ //haven't seen food yet, check for it
    $food = true;
  } elseif (!$drink AND 2 == $row['category']) { //same for drink
    $drink = true;
  }
}

//later
if($food){
  //display food
} 
```

当然，不仅仅是明确地跟踪这些标志，似乎更通用的方法会更好：

```
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { //fetch an assoc array
  $products[] = $row;
  $categories[$row['category']] = true;
}

//later
if(in_array(1, $categories)){
  //display food
} 
```

但这仍然有一些不足之处。这个怎么样：

```
//use some OOP to make this cleaner (class constants)
define('FOOD' , 1);
define('DRINK', 2);

//setup default values
$categories = array(FOOD => false, DRINK = false);
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { //fetch an assoc array
  $products[] = $row;
  $categories[$row['category']] = true;
}

//later
if($categories[FOOD]){
  //display food
} 
```

而且，如果我正确理解您的问题，您可能只需要检查产品是否可用（使用产品 ID） - 更改您的产品循环以将其作为关键跟踪：

```
while ($row = $stmt->fetch(PDO::FETCH_ASSOC)) { //fetch an assoc array
  $products[$row['itemid']] = $row;
  $categories[$row['category']] = true;
}

//later
if(isset($products[$searchId])){
  //user has this product
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-08T17:34:59.680

如果您使用 Zend，您可以使用 itemid 作为第一列的 $products = $query->fetchAssoc 并获取数组 $products[itemid1] => array(itemid1, 'category', 'price'), $products[itemid2] = > 数组（itemid2，'类别'，'价格'）。

但对于类别，我认为更好的解决方案是：

```
$products[$row['category']][$row['itemid']] = $row['price']; 
```

所以你可以像这样使用它：

```
if (!empty($products[$foodid])) {
    echo "Food HTML part";
    if (!empty($products[$foodid][$cheeseid])) {
        echo "Cheese price = {$products[$foodid][$cheeseid]}";
    }
} 
```

我希望我能理解你的问题:) 对不起我的英语

# ios - 使用 RubyMotion 解析 JSON

> ID：13293979
> 
> 赞同：2
> 
> 时间：2012-11-08T17:03:35.263
> 
> 标签：ios, ruby, json, rubymotion

我有一个 RubyMotion 类，它从 Twitter 的搜索 API 中读取数据以创建`Tweet`如下对象。

当我运行它时，我收到此错误：

```
(main)> 2012-11-08 17:01:32.634 Hello[39940:c07] -[__NSCFString bytes]: unrecognized selector sent to instance 0xea1f800
2012-11-08 17:01:32.685 Hello[39940:c07] json.rb:20:in `parse:': NSInvalidArgumentException: -[__NSCFString bytes]: unrecognized selector sent to instance 0xea1f800 (RuntimeError)
    from tweets_controller.rb:11:in `create_tweets'
    from tweets_controller.rb:7:in `tweets'
    from twitter_view_controller.rb:21:in `tableView:numberOfRowsInSection:'
    from app_delegate.rb:10:in `application:didFinishLaunchingWithOptions:'
2012-11-08 17:01:32.686 Hello[39940:c07] *** Terminating app due to uncaught exception 'RuntimeError', reason: 'json.rb:20:in `parse:': NSInvalidArgumentException: -[__NSCFString bytes]: unrecognized selector sent to instance 0xea1f800 (RuntimeError)
    from tweets_controller.rb:11:in `create_tweets'
    from tweets_controller.rb:7:in `tweets'
    from twitter_view_controller.rb:21:in `tableView:numberOfRowsInSection:'
    from app_delegate.rb:10:in `application:didFinishLaunchingWithOptions:' 
```

**我应该如何解析 JSON？**

```
class TweetsController
  def initialize
    @twitter_accounts = %w(dhh google)
  end

  def tweets
    @tweets ||= create_tweets
  end

  def create_tweets
    BW::JSON.parse(twitter_search_results)["results"].each do |result|
      @tweets << Tweet.new(result)
    end
    @tweets
  end

  def twitter_search_results
    query = @twitter_accounts.map{ |account| "from:#{account}" }.join(" OR ")
    url_string = "http://search.twitter.com/search.json?q=#{query}"
    url_string_escaped = url_string.stringByAddingPercentEscapesUsingEncoding(NSUTF8StringEncoding)
    url = NSURL.URLWithString(url_string_escaped)
    request = NSURLRequest.requestWithURL(url)
    response = nil
    error = nil
    data = NSURLConnection.sendSynchronousRequest(request, returningResponse: response, error: error)
    ##raise "BOOM!" unless (data.length > 0 && error.nil?)
    json = NSString.alloc.initWithData(data, encoding: NSUTF8StringEncoding)
  end
end

class Tweet
  attr_reader :created_at, :from_user, :text
  def initialize(tweet_result)
    @created_at = tweet_result["created_at"]
    @from_user = tweet_result["from_user"]
    @text = tweet_result["text"]
  end
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-08T19:02:35.633

有几个 CocoaPods 可以解决这个问题。特别是 JSONKit。

编辑：这不是气泡包装错误。这是一个解释 Twitter 响应的问题。我有一个使用bubblewrap 和JSONKit 的示例。我很快就会把它放在 GitHub 上。简短的总结，Twitter 返回一个数组数组。第一个元素是该组中的内容，第二个元素是实际数据。您想要迭代最外层的数组以查找第一个元素是结果的数组，然后使用第二个元素来导出您的响应数据。以下是两种替代实现：

```
def create_tweets_using_bubblewrap
  @twitter_accounts = %w(dhh google)
  query = @twitter_accounts.map{ |account| "from:#{account}" }.join(" OR ")
  url_string = "http://search.twitter.com/search.json?q=#{query}"

  BW::HTTP.get(url_string) do |response|
    parsed = BW::JSON.parse response.body.to_str
    parsed.each do |item|
      next if item[0] != 'results'
      @feed = []
      item[1].each do |tweet|
        @feed << {:from => tweet['from_user'], :text => tweet['text']}
      end
    end
  end
  @feed
end

def create_tweets_using_jsonkit
  @twitter_accounts = %w(dhh google)
  query = @twitter_accounts.map{ |account| "from:#{account}" }.join(" OR ")
  url_string = "http://search.twitter.com/search.json?q=#{query}"

  error_ptr = Pointer.new(:object)
  BW::HTTP.get(url_string) do |response|
    parsed = response.body.to_str.objectFromJSONStringWithParseOptions JKParseOptionValidFlags, error: error_ptr
    if parsed.nil?
      error = error_ptr[0]
      puts error.userInfo[NSLocalizedDescriptionKey]
      @timer.setValid false
    else
      parsed.each do |item|
        next if item[0] != 'results'
        @feed = []
        item[1].each do |tweet|
          @feed << {:from => tweet['from_user'], :text => tweet['text']}
        end
      end
    end
  end
  @feed
end 
```

[http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSJSONSerialization_Class/Reference/Reference.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-08T21:26:58.867

简短的回答：跳过使用 Bubblewrap。

```
 def create_tweets
    json_string = twitter_search_results.dataUsingEncoding(NSUTF8StringEncoding)
    e = Pointer.new(:object)
    json_hash = NSJSONSerialization.JSONObjectWithData(json_string, options:0, error: e)
    json_hash["results"].each do |result|
      @tweets << Tweet.new(result)
    end
  end 
```

# jquery - 花式盒子秀pdf

> ID：13293980
> 
> 赞同：8
> 
> 时间：2012-11-08T17:03:43.447
> 
> 标签：jquery, fancybox

嗨，我正在尝试使用 fancybox 显示 PDF，但我不能。

我有这个代码：

```
 $(".fancybox").fancybox({
      'frameWidth': 100,
       'frameHeight':495,
       'overlayShow':true,
       'hideOnContentClick':false,
      'type':'iframe'
}) 
```

和

```
<a class="fancybox" href="/symfony2/web/app.php/pdf/2"> show pdf</a> 
```

但向我展示了生成pdf的方式：

[http://www.subirimagenes.com/imagen-pantallazo-8110661.html](http://www.subirimagenes.com/imagen-pantallazo-8110661.html)

有谁知道如何解决问题以正确显示 facybox？问候。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-08T19:18:10.497

你能解释一下什么对你不起作用吗？它应该工作 - [http://jsfiddle.net/zqJFp/](http://jsfiddle.net/zqJFp/)

```
<a class="fancybox" href="http://samplepdf.com/sample.pdf">Open pdf</a>

​$(".fancybox").fancybox({
    width  : 600,
    height : 300,
    type   :'iframe'
});​ 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-11-18T16:27:42.427

这对我有用，我希望对你有用！

```
<a class="btn btn-info btn-sm btn-hover gallerypdf" data-fancybox-type="iframe" href="../../assets/img/exp_2493_parte-3.pdf"><span class="glyphicon glyphicon-eye-open"></span></a> 
```

```
$(document).ready(function() {
    $(".gallerypdf").fancybox({
        openEffect: 'elastic',
        closeEffect: 'elastic',
        autoSize: true,
        type: 'iframe',
        iframe: {
            preload: false // fixes issue with iframe and IE
        }
    });
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2018-08-29T14:15:16.437

Fancybox 尝试通过查看文件扩展名（gif、jpg、pdf 等）来根据给定的 url 自动检测内容的类型。在您的情况下，无法检测到它，因为您的网址不是以“.pdf”结尾，因此您必须手动设置类型。

接受的解决方案很好，因为这可以在`type`初始化 fancybox 时使用选项来完成，但是如果您有混合内容（图像和 pdf 一起），它将不起作用。在这些情况下，您可以使用`data-type`inline 属性并标记每个单独的条目。

例如，您可以这样做：

```
<a href="getimages.php?id=123" data-type="image">
    Show image
</a>
<a href="getpdf.php?id=123" data-type="iframe">
    Show pdf
</a>
<a href="getajax.php?id=123" data-type="ajax" data-src="my/path/to/ajax/">
    Show ajax content
</a> 
```

... 等等。

# jquery - jQuery find() - 排除 $(this) 元素

> ID：13293981
> 
> 赞同：4
> 
> 时间：2012-11-08T17:03:49.063
> 
> 标签：jquery

基本上我正在尝试进行查找然后运行效果，但我想排除所有者元素。这就是我目前所拥有的：

```
$('li.main').click(function(){
    $(this).parents('.content').find('li.main').not(this).removeClass('active');
    $(this).parents('.content').find('li.subs').not(this).slideUp();

    $(this).parent().toggleClass('active');
    $(this).parent().next('li.subs').slideToggle();
}); 
```

不太行。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T17:06:03.310

尝试这个：

```
$('li.main').click(function(){
    var item = $(this), allItems = item.parents('.content').find('li.main');
    if(!item.hasClass('active')){
        allItems = allItems.not(item);
        item.parent().addClass('active');
        item.parent().next('li.subs').slideDown();
    }
    allItems.removeClass('active');
    allItems.slideUp();
}); 
```

# javascript - 如何设置平滑滚动的偏移量

> ID：13293984
> 
> 赞同：7
> 
> 时间：2012-11-08T17:03:52.973
> 
> 标签：javascript, jquery, scroll, offset, smooth-scrolling

我已经在[我的网站上实现了](http://mcography.com/test/)[CSS Tricks Smooth Page Scroll](http://css-tricks.com/examples/SmoothPageScroll/#top)，它运行得非常好。但是，因为我在页面顶部有一个固定的导航，所以当页面滚动到适当的锚 div 时，div 的顶部会消失在导航的后面。如何偏移滚动（大约 70 像素）以便显示整个 div？我试过这样做：

```
var targetOffset = $target.offset().top - 70; 
```

但这并不完全奏效。页面滚动到适当的位置，但随后它立即跳回以隐藏 div 的顶部。我错过了什么？这是完整的代码：

```
$(function() {

    function filterPath(string) {
        return string
        .replace(/^\//,'')
        .replace(/(index|default).[a-zA-Z]{3,4}$/,'')
        .replace(/\/$/,'');
    }

    var locationPath = filterPath(location.pathname);
    var scrollElem = scrollableElement('html', 'body');

    // Any links with hash tags in them (can't do ^= because of fully qualified URL potential)
    $('a[href*=#]').each(function() {

        // Ensure it's a same-page link
        var thisPath = filterPath(this.pathname) || locationPath;
        if (  locationPath == thisPath
            && (location.hostname == this.hostname || !this.hostname)
            && this.hash.replace(/#/,'') ) {

                // Ensure target exists
                var $target = $(this.hash), target = this.hash;
                if (target) {

                    // Find location of target
                    var targetOffset = $target.offset().top - 70;
                    $(this).click(function(event) {

                        // Prevent jump-down
                        event.preventDefault();

                        // Animate to target
                        $(scrollElem).animate({scrollTop: targetOffset}, 400, function() {

                            // Set hash in URL after animation successful
                            location.hash = target;

                        });
                    });
                }
        }

    });

    // Use the first element that is "scrollable"  (cross-browser fix?)
    function scrollableElement(els) {
        for (var i = 0, argLength = arguments.length; i <argLength; i++) {
            var el = arguments[i],
            $scrollElement = $(el);
            if ($scrollElement.scrollTop()> 0) {
                return el;
            } else {
                $scrollElement.scrollTop(1);
                var isScrollable = $scrollElement.scrollTop()> 0;
                $scrollElement.scrollTop(0);
                if (isScrollable) {
                    return el;
                }
            }
        }
        return [];
    }

}); 
```

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-08T17:48:42.370

这总是发生。我搜索并寻找答案，感到沮丧，发布一个寻求帮助的问题，然后立即找到我的问题的答案。愚蠢的。无论如何，对于任何可能遇到同样问题的人来说，这里都是解决方案。

例如，如果您想将偏移量更改为 70px，请将代码更改为：

```
var targetOffset = $target.offset().top - 70; 
```

但是，除非您从代码中删除此行...

```
location.hash = target; 
```

...页面将滚动到正确的位置，然后立即跳回，以便 div 的顶部隐藏在标题后面。您可以从代码中删除上述行，一切都会很好，除了 URL 将不再更改以反映用户在页面上的位置。

如果您希望更改 URL（我认为这对于可用性而言是一个好主意），那么您所要做的就是更改锚 div 的 CSS。为 padding-top 添加一个正值，为 margin-top 添加一个负值。例如：

```
#anchor-name {
padding-top: 70px;
margin-top: -70px;
} 
```

我只有 3 个 div，所以我只是将 CSS 插入到每个 div 中，瞧，一切正常。但是，如果您有很多锚 div，您可能会考虑创建一个 .anchor 类，将 CSS 放在那里，并将该类应用于所有适当的 div。

我希望这有帮助！

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2014-01-06T13:53:54.400

我用下面的代码解决了这样的问题：

工作演示在[**这里**](http://www.teckstack.com/professional-photographer-prevent-image-theft/)。您可以使用侧边栏中的“**发布主题**”部分和主要内容区域中的内容。

**代码**

```
jQuery(function() {
  jQuery('a[href*=#]:not([href=#])').click(function() {
    if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {

      var target = jQuery(this.hash);
      target = target.length ? target : jQuery('[name=' + this.hash.slice(1) +']');
      if (target.length) {
        jQuery('html,body').animate({
          scrollTop: target.offset().top -100
        }, 1000);
        return false;
      }
    }
  });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-08-20T09:30:32.087

参考[https://codepen.io/pikeshmn/pen/mMxEdZ](https://codepen.io/pikeshmn/pen/mMxEdZ)

**方法：我们使用***document.getElementById('header').offsetHeight*获取固定导航的高度， 并将滚动偏移到这个值。

```
var jump=function(e){  

e.preventDefault();                        //prevent "hard" jump
  var target = $(this).attr("href");       //get the target

      //perform animated scrolling
      $('html,body').animate(
        {
          scrollTop: $(target).offset().top - document.getElementById('header').offsetHeight - 5  //get top-position of target-element and set it as scroll target
        },1000,function()                  //scrolldelay: 1 seconds
        {
          location.hash = target;          //attach the hash (#jumptarget) to the pageurl
        });
      }

  $(document).ready(function()
  {
    $('a[href*="#"]').bind("click", jump); //get all hrefs
    return false;
  }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-11-06T10:39:14.983

实际上有一个CSS规则：`scroll-padding-top`:)当然结合了`padding-top`最顶层元素的常规。

参看。[https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-padding-top](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-padding-top)

# .net - 是否可以链接或“重定向”到 Windows RT 中的应用程序？

> ID：13293990
> 
> 赞同：1
> 
> 时间：2012-11-08T17:04:16.730
> 
> 标签：.net, windows-runtime

在 IOS 平台上，可以为浏览器提供指向设备上应用程序的链接，以便跟随该链接导致应用程序启动并处理请求。例如：

```
 pownce://foo/etc 
```

编写 WinRT 应用程序是否有类似的方法？这对于处理大量使用浏览器重定向来在各方之间传递信息的联合身份和身份验证流程非常重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T20:54:01.107

Yes, Windows Store apps can be set up to handle protocol activation, which is described in the app manifest. (This will set up the necessary registry entries at installation time--you can't do that manually for an app distributed via the Windows Store.) It basically allows for the same thing: define your own URI scheme and register an app as a handler for that scheme.

请参阅[如何处理协议激活 (HTML/JS)](http://msdn.microsoft.com/en-us/library/windows/apps/hh452686.aspx)或[C#/VB/XAML 的等效主题](http://msdn.microsoft.com/en-us/library/windows/apps/xaml/Hh779670%28v=win.10%29.aspx)。

# routing - ember.js 中是否有一个回调，我可以在状态转换后渲染所有视图后使用它来运行代码？

> ID：13293992
> 
> 赞同：4
> 
> 时间：2012-11-08T17:04:21.623
> 
> 标签：routing, ember.js

我有由三个出口组成的应用程序视图：

```
<script type="text/x-handlebars" data-template-name="application">
        {{outlet header}}
        {{outlet content}}
        {{outlet footer}}
</script> 
```

呈现自己的观点（简化）：

```
<script type="text/x-handlebars" data-template-name="header">
<a href="#" data-role="button" data-icon="arrow-l" data-iconpos="notext" 
        {{action changeDate view.prevDate href=true}}>Prev</a>
{{view.model.weekDay}}
<a href="#" data-role="button" data-icon="arrow-r" data-iconpos="notext" 
        {{action changeDate view.nextDate href=true}}>Next</a>
</script>

<script type="text/x-handlebars" data-template-name="content">
{{view.model.month}}
</script>

<script type="text/x-handlebars" data-template-name="footer">
{{view.model.day}}
</script> 
```

和应用程序路由器，它使用路由逻辑刷新视图

```
Router: ember.Router.extend({
    root: ember.Route.extend({
        changeDate: ember.State.transitionTo('date'),
        index: ember.Route.extend({
            route: '/',
            connectOutlets: function (router) {
                router.transitionTo('date', new Date());
            }
        }),
        date: ember.Route.extend({
            route: '/:date',
            serialize: function (router, date) {
                return { date: toUrlString(date) };
            },
            deserialize: function (router, param) {
                return parseUrlString(param.date);
            },
            connectOutlets: function (router, date) {
                var appController = router.get('applicationController'),
                    controller = router.get('dayController');
                controller.navigateTo(date || new Date());
                appController.connectOutlet({ outletName: 'header', viewClass: router.namespace.HeaderView, controller: controller });
                appController.connectOutlet({ outletName: 'content', viewClass: router.namespace.ContentView, controller: controller });
                appController.connectOutlet({ outletName: 'footer', viewClass: router.namespace.FooterView, controller: controller });
            }
        })
    })
}) 
```

这一切都很好，除了一件事 - 应用程序使用 jQuery Mobile，并且在重新渲染视图后，我需要对更新的元素应用 jqm 增强。我尝试`didInsertElement`在每个视图中使用回调来增强已重绘的部分。但它没有按预期工作，因为 jqm 对页眉和页脚块进行了非常特殊的处理。`.trigger('pagecreate')`除非通过使用或`.page('destroy').page()`在根应用程序视图上使用重新初始化所有页面，否则它们不会得到适当的增强。

问题是 - 每个视图都调用自己的`didInsertElement`，因此增强代码执行了 3 次。

在完成路由转换并使用当前数据渲染和更新所有受影响的视图后，是否有可靠的方法来执行增强代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-12T06:02:56.430

我最近添加了一些对此有帮助的东西，一个 afterRender 队列。请参阅[此提交](https://github.com/emberjs/ember.js/commit/512327c0128f53d4a0d6828ab38f27c6ccf686ec)，特别是使用示例的测试。

# python - 使用太大而无法存储在内存中的文件？

> ID：13293994
> 
> 赞同：4
> 
> 时间：2012-11-08T17:04:25.263
> 
> 标签：python, sqlite, large-files, dbm

我有一个 20 GB 的文件，如下所示：

```
Read name, Start position, Direction, Sequence 
```

请注意，读取名称不一定是唯一的。

例如，我的文件片段看起来像

```
Read1, 40009348, +, AGTTTTCGTA
Read2, 40009349, -, AGCCCTTCGG
Read1, 50994530, -, AGTTTTCGTA 
```

我希望能够以一种允许我存储这些行的方式

1.  保持文件根据第二个值排序
2.  遍历排序的文件

似乎数据库可以用于此。

该文档似乎暗示[dbm](http://docs.python.org/3.3/library/dbm.html)不能用于对文件进行排序并对其进行迭代。

因此我想知道[SQLite3](http://docs.python.org/3.3/library/sqlite3.html)是否能够做到 1) 和 2)。我知道我将能够使用 SQL 查询对文件进行排序，并使用 sqlite3 遍历结果集。但是，我能否在不耗尽 4GB RAM 计算机上的内存的情况下做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-08T17:06:34.560

[SQLite 能够](https://www.sqlite.org/whentouse.html)做到 1) 和 2)。

我建议您尝试并报告您遇到的任何问题。

> 默认页面大小为 1024 字节，SQLite 数据库的大小限制为 2 TB（2 ^(41)字节）。即使它可以处理更大的数据库，SQLite 也将整个数据库存储在单个磁盘文件中，并且许多文件系统将文件的最大大小限制为小于这个值。因此，如果您正在考虑这种规模的数据库，您最好考虑使用客户端/服务器数据库引擎，该引擎将其内容分布在多个磁盘文件中，并且可能跨越多个卷。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-08T17:18:54.733

请参阅有关大型 SQLlite 数据库的[这个问题。](https://stackoverflow.com/questions/784173/what-are-the-performance-characteristics-of-sqlite-with-very-large-database-file)

重要的一点：

> 我试图将多行插入到只有一个表的 sqlite 文件中。当文件大约 7GB 时（对不起，我不能具体说明行数）插入花费的时间太长了。我曾估计插入所有数据的测试需要 24 小时左右，但即使在 48 小时后也没有完成。

使用的样本约为 50GB 数据，但未提及系统规格。

# google-chrome - 如何将 Adsense 添加到我的 chrome 扩展程序中？

> ID：13293998
> 
> 赞同：11
> 
> 时间：2012-11-08T17:04:31.210
> 
> 标签：google-chrome, google-chrome-extension, adsense

我已经编写了小型 chrome 扩展程序，当您单击它的图标时，它会将您发送到特定的 URL。

现在我需要在我的扩展代码中添加一个 Adsense 广告，以便广告出现在 youtube.com 的右侧，

请看图片： http: [//i.stack.imgur.com/yhVz5.jpg](https://i.stack.imgur.com/yhVz5.jpg)，我只是标记了我希望我的广告出现的位置。

我已经看到了一个可以做到这一点的扩展，但我不知道该怎么做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:28:00.983

您是否阅读过计划政策：Chrome 应用和扩展程序中的广告 [https://developers.google.com/chrome/web-store/program_policies](https://developers.google.com/chrome/web-store/program_policies)

**目前，根据 AdSense 政策，AdSense 不得用于在 Chrome 扩展程序或打包应用中投放广告。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T16:56:57.330

打包应用程序中的 AdSense 正在开发中。请参阅此处的讨论：[https ://groups.google.com/a/chromium.org/forum/?hl=en&fromgroups#!topic/chromium-apps/_47r_YKRdjA](https://groups.google.com/a/chromium.org/forum/?hl=en&fromgroups#!topic/chromium-apps/_47r_YKRdjA)

同时，为这个问题加注星标：[https ://code.google.com/p/chromium/issues/detail?id=132602](https://code.google.com/p/chromium/issues/detail?id=132602)

# sharepoint-2010 - 共享点列表项事件处理程序 - 识别源

> ID：13293999
> 
> 赞同：0
> 
> 时间：2012-11-08T17:04:32.733
> 
> 标签：sharepoint-2010

我有一个更新列表项的 Web 部件。用户还可以从屏幕更新项目。我使用 SPListItem.Update 方法。

我在列表中附加了事件处理程序。

在项目更新/更新方法中......有没有办法知道用户是从屏幕还是从我的 Web 部件更新了列表项？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T17:12:01.487

当从 Web 部件更新列表时，您能否在列表中添加一列并更新代码中的值。