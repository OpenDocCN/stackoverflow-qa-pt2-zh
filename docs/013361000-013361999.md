# StackOverflow 问答 13361000-13361999

# php - 在 Sphinx 中使用停用词的推荐方法

> ID：13361000
> 
> 赞同：0
> 
> 时间：2012-11-13T12:44:19.623
> 
> 标签：php, full-text-search, sphinx

我已将停用词设置为文本文件，并正确链接到我的 sphinf 配置文件的每个索引中的位置 - 我只是想知道在使用停用词列表时与 Sphinx API 一起使用的“最佳”参数是什么。

注意 - 我正在使用 PHP Sphinx API

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T10:00:27.173

对于其他寻找解决方案的人 [http://sphinxsearch.com/docs/archives/1.10/conf-stopwords.html](http://sphinxsearch.com/docs/archives/1.10/conf-stopwords.html)

# php - 使用 404 重定向不起作用

> ID：13361003
> 
> 赞同：0
> 
> 时间：2012-11-13T12:44:45.567
> 
> 标签：php

我有一个应该重定向的代码，以防它没有正确设置某些请求参数。

```
 if(!is_numeric($_GET['id'])){
                         header("HTTP/1.0 404 Not Found");
                    header('Location: '.$url);
                    exit();
               } 
```

问题是，每当我检查 Firefoxes 插件、实时 HTTP 标头时，我都会看到 302 临时重定向。这是为什么？为什么没有给出 404 响应？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T12:49:10.397

`Location`发送带有`404`状态码的标头是没有意义的。

`Location`意思是“你要的东西在这里”

`404`意思是“我没有你要的”

这两种说法是不相容的。

如果你想发送一个特定的人类可读的错误解释，那么就像你对任何其他类型的文档一样输出它。`include()`如果你愿意，你可以。不要尝试重定向到它。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T12:51:59.437

> 问题是，每当我检查 Firefoxes 插件、实时 HTTP 标头时，我都会看到 302 临时重定向。这是为什么？为什么没有给出 404 响应？

**不确定您想在这里做什么，**但以下将提供您的目的。

```
if (! is_numeric($_GET['id'])) {
    header('Location: ' . $url, true, 404);
    exit();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:49:38.263

如上所述，您只能发送一个您正在尝试的标头。

在 404 的情况下 - 这将显示由您的 Web 服务器配置定义的错误相关错误页面。

做你想做的事......你需要将服务器的 404 从一个普通的 html 修改为一个 php 页面，并计算出从那里显示的内容（你可以基于引用者等）。

如果需要，您可以从“动态”404 页面中进行重定向。

# java - 在 Android/Java 中运行一个类 onClick()

> ID：13361004
> 
> 赞同：1
> 
> 时间：2012-11-13T12:44:49.243
> 
> 标签：java, android, database

我想将我的数据库导出到我的 SD 卡。我正在尝试关注这个问题： [Making a database backup to SDCard on Android](https://stackoverflow.com/questions/2814213/making-a-database-backup-to-sdcard-on-android)

但是由于我对编程还是很陌生，所以我不确定我是否做得对。我为此做了一个单独的课程，`ExportDatabaseFileTask.java`所以现在我只需要在我的主目录中调用它。

在我的 main 中，我有一个执行此代码的 onClick 侦听器：

```
 ExportDatabaseFileTask thing = new ExportDatabaseFileTask(); 
```

该行是否足以在我的班级中运行代码以导出数据库？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:51:54.187

您将不得不安排任务：

```
ExportDatabaseFileTask thing = new ExportDatabaseFileTask();
thing.execute(.....); 
```

现在它将从一个新的胎面运行。

您正在尝试访问外部存储。确保您在清单文件中定义了必要的权限。这可以通过添加来完成

```
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

您可以在此处阅读[文档](http://developer.android.com/reference/android/os/AsyncTask.html)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T13:00:01.460

根据您在 ExportDatabaseFileTask 中输入的代码，您可以只创建该类的对象。

每次使用 .... = new .....(); 创建对象时 您正在运行构造函数；构造函数运行内部的代码

```
public ExportDatabaseFileTask()
{
} 
```

在这种情况下。将您的代码放在那里，它会在您创建 ExportDatabaseFileTask 对象后立即运行。

或者，在 ExportDatabaseFileTask 类中，使用代码创建一个方法

```
public void exportToSD()
{
//dostuff
} 
```

然后调用 thing.exportToSD();

# c# - C# 泛型类和 EqualityComparer

> ID：13361005
> 
> 赞同：5
> 
> 时间：2012-11-13T12:44:54.520
> 
> 标签：c#, generics, static, icomparable, icomparer

谁能解释一下以下类声明中有什么问题：

```
private class PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType> :
        IComparer<PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType>>
            where TPriorityValue : IComparable
            where IIdentifiableEntry : Identifier<IType>
    {
        public TPriorityValue Priority{get;private set;}
        public IIdentifiableEntry Entry{get;private set;}

        public PriorityQueueEntry(TPriorityValue val,IIdentifiableEntry entry)
        {
            Priority = val;
            Entry = entry;
        }
        public int Compare(PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType> first, PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType> second) 
        {
            if (first.Priority.CompareTo(second.Priority) < 0)
            {
                return -1;
            }
            else if (first.Priority.CompareTo(second.Priority) > 0)
            {
                return 1;
            }
            return EqualityComparer<IIdentifiableEntry>.Default.Equals( first.Entry.Id, second.Entry.Id);
        }
    } 
```

编译器在我使用 EqualityComparer 的那一行抱怨。错误如下：

> 错误 CS0176：无法使用实例引用访问静态成员 `object.Equals(object, object)'，而是使用类型名称对其进行限定

我看不到我在哪里使用实例引用。

* * *

对不起，我的错。我发布了一个不完整的问题。为了完整起见，标识符类如下：

```
public interface Identifier<ID_TYPE> 
{
    ID_TYPE Id{get;set;}
} 
```

在那里使用 EqualityComparer 是由于复制和粘贴错误（对不起，今天的通用代码太多）。

当然我的问题是错误的，因为我没有给你所有你需要回答的元素（我很快就会删除它）。我`IType`需要`IConvertible`。总之谢谢大家。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T12:48:36.373

这是一个实例参考：

```
EqualityComparer<IIdentifiableEntry>.Default 
```

第一个问题是你根本*不想*打电话`object.Equals(object, object)`。您确实想在相等比较器上调用该方法 - 但您尝试使用不可转换为`IIdentifieableEntry`.

第二个问题是您正在尝试执行*排序*比较，而不是*相等*比较，所以您想要`Comparer<T>`，而不是`EqualityComparer<T>`。

目前尚不清楚您要实现什么，但这段代码至少可以*编译*：

```
return Comparer<IIdentifiableEntry>.Default.Compare(first.Entry, second.Entry); 
```

如果你真的想比较 Id 属性，你需要一个*ID 属性类型*的相等比较器——我们不知道那个类型是什么。

我怀疑你更有可能真的想要这样的*东西*：

```
return Comparer<string>.Default.Compare(first.Entry.Id, second.Entry.Id); 
```

...但这取决于`Id`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T12:56:46.750

您没有显示 Identifier 或 EqualityComparer 的声明。但我假设您需要将行更改为：

```
return EqualityComparer<IIdentifiableEntry>.Default.Equals<IType>( first.Entry.Id, second.Entry.Id); 
```

**[编辑]**

根据乔恩的评论。你根本不想平等比较器。假设那个 Entry.Id 是 IComparable，那么只需：

```
return first.Entry.Id.CompareTo(second.Entry.Id); 
```

我建议将 Entry 限制为 IComparable，因此我们会得到如下信息：

类 PriorityQueueEntry> where TPriorityValue : IComparable where TEntry : IComparable { public TPriorityValue Priority{get;private set;} public TEntry Entry{get;private set;}

```
 public PriorityQueueEntry(TPriorityValue val, TIdentifiableEntry entry)
    {
        Priority = val;
        Entry = entry;
    }
    public int Compare(PriorityQueueEntry<TPriorityValue, TEntry first, PriorityQueueEntry<TPriorityValue, TEntry> second) 
    {
        if (first.Priority.CompareTo(second.Priority) < 0)
        {
            return -1;
        }
        else if (first.Priority.CompareTo(second.Priority) > 0)
        {
            return 1;
        }
        return first.Enrtry.CompareTo(second.Entry);
    }
} 
```

如果 TEntry 是一个类，您可能需要添加一些空检查。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:18:49.000

最后我以这种方式解决了：

```
private class PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType> :
        IComparer<PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType>>
            where TPriorityValue : IComparable
            where IIdentifiableEntry : Identifier<IType>
            where IType : IConvertible
    {
        public TPriorityValue Priority{get;private set;}
        public IIdentifiableEntry Entry{get;private set;}

        public PriorityQueueEntry(TPriorityValue val,IIdentifiableEntry entry)
        {
            Priority = val;
            Entry = entry;
        }
        public int Compare(PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType> first, PriorityQueueEntry<TPriorityValue,IIdentifiableEntry,IType> second) 
        {
            if (first.Priority.CompareTo(second.Priority) < 0)
            {
                return -1;
            }
            else if (first.Priority.CompareTo(second.Priority) > 0)
            {
                return 1;
            }
            return first.Entry.Id.ToUInt32(NumberFormatInfo.CurrentInfo) < first.Entry.Id.ToUInt32(NumberFormatInfo.CurrentInfo) ? -1:1; 
        }
    } 
```

# java - 用于 RDF 版本跟踪的 Java 框架

> ID：13361006
> 
> 赞同：3
> 
> 时间：2012-11-13T12:44:55.307
> 
> 标签：java, versioning, rdf

我正在寻找一个用于处理图形数据库中的 RDF 数据的 java 框架。主要目的是管理 RDF 图的多个版本，并且所有版本必须始终可访问。所以版本跟踪是我需要的一个重要功能。是否有任何工具可以开箱即用地支持此功能，而无需从头开始开发？

我发现与该主题相关的唯一工具是`OpenAnzo`，但该网站不再可用。

向节点添加时间戳应该不是问题，但也`SPARQL`应该可以通过或其他查询语言轻松访问。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T03:15:02.317

您可能对[Alibaba Auditing Repository](http://www.openrdf.org/doc/alibaba/2.0-rc5/alibaba-repository-auditing/index.html)和[Auditing SAIL](http://www.openrdf.org/doc/alibaba/2.0-rc5/alibaba-sail-auditing/index.html)感兴趣，它们是用于 RDF 数据更改跟踪和出处的[Sesame](http://www.openrdf.org/)扩展（披露：我在 Sesame 开发团队中）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T17:05:19.320

我不知道任何现有的数据库解决方案提供开箱即用的版本控制。您最好的选择是在现有数据库上为您的应用程序制定自定义方案。例如，您可以将不同版本的数据放入命名图中并将其用作版本控制结构，然后在查询中使用 from/from named 能够查询部分或所有不同版本的数据。您也可以尝试通过具体化来解决问题，这会产生类似的结果。

# android - 获取全局坐标中的磁场值

> ID：13361010
> 
> 赞同：1
> 
> 时间：2012-11-13T12:45:27.237
> 
> 标签：android, coordinates, sensors, magnetometer

对于 Android 应用程序，我需要跨全球（世界）坐标系的轴进行磁场测量。以下是我将如何（猜测）实现这一点。如有必要，请纠正我。另外，请注意，问题是关于任务的算法部分，而不是关于传感器的 Android API - 我对后者有经验。

第一步是获取`TYPE_MAGNETIC_FIELD`传感器数据（`M`）和`TYPE_ACCELEROMETER`传感器数据（`G`）。第二个应该根据 Android 的文档使用，但我不确定它是否不应该`TYPE_GRAVITY`代替（再次作为`G`），因为加速度计似乎提供的不是纯重力。

下一步是通过 获得旋转矩阵`getRotationMatrix(R, I, G, M)`，其中`R`和`I`是相应的旋转和倾斜矩阵。

现在是最值得怀疑的部分：为了将`M`向量转换为世界坐标系，我想乘以`[R * I] * M`.

我不确定这是将磁场读数转换为另一个基础的正确方法。另外，我不知道是否`remapCoordinateSystem`应该*补充*或*替代*上述内容。

如果已经存在一些可以执行此操作的源代码，我将不胜感激发布链接，但我不想为这个特定任务使用大型通用库（例如，用于增强现实支持），因为我会喜欢让它尽可能简单。

**附言**

为了清楚起见，我想到在原始帖子中添加一些信息。

让我们假设一个设备放在桌子上并不断地从它的磁传感器中读取数据。每个测量值包含 3 个值，表示 X、Y、Z 轴上的磁场，它们是设备的局部坐标系。我认为我可以忽略环境场波动（通过低通滤波器平滑），因此这 3 个值应该在设备保持在原位时几乎保持不变。如果我们围绕任何轴旋转设备，值会改变，因为我们改变了局部坐标系。但是该字段本身实际上并没有改变。因此，我想将本地 X、Y、Z 场测量值转换为这样的 X'、Y'、Z'，只要设备没有从其位置移动（仅旋转），无论设备旋转如何，它们都会保持各自的值。

我已经实现了上面描述的算法，并且通过建议的转换获得了值 X'、Y'、Z' 的规律和显着变化，所以它有问题。

**聚苯乙烯**

有时我会在 SO 上找到与我的问题完全相同的副本 -[如何获得磁场矢量，与设备旋转无关？](https://stackoverflow.com/questions/11772923/how-can-i-get-the-magnetic-field-vector-independent-of-the-device-rotation)- 但不幸的是，答案包含我的建议，并且该问题的 OP 确认它们不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T05:50:14.567

M 相对于单词坐标的坐标就是乘法**R*M**。

旋转矩阵 R 在数学上是基矩阵从设备坐标到字坐标的变化。设**X**、**Y**、**Z**为设备坐标基础，**W_1**、**W_2**、**W_3**为字坐标基础，则
**M** = m_1 **X** + m_2 **Y** + m_3
以及
**M** = c_1 **W_1** + c_2 **W_2** + c_3 **W_3**
其中**R** * (m_1, m_2, m_3) = (c_1, c_2, c_3) 转置。

低通滤波器仅用于滤除**X**、**Y**方向的加速度。RemapCoordinateSystem用于改变基的顺序，即从W_1、W_2、W_3变为W_1、W_3、W_2。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T21:53:27.160

设备上的磁力计传感器返回设备坐标中的 3 向量。您可以使用 getRotationMatrix() 获取一个矩阵，该矩阵可用于将该设备坐标向量转换为世界坐标。您还可以了解四元数并直接使用 TYPE_ROTATION_VECTOR。但是，Android 中没有 Quaternion 库（据我所知），这是超出此问题范围的讨论。

但是，这对您没有任何好处，因为设备方向信息部分基于磁力计的值。换句话说，设备总是会告诉你磁矢量正对着北方。

现在，你*可以*做的是磁倾角。这是 getRotationMatrix() 的输出之一，尽管您必须将矩阵转换为角度才能使用它。这也超出了这个问题的范围。

最后，你的最后一个选择是建立一个水平的桌子，上面有一个指向正北的箭头。（您必须在晚上将其对准星星或其他东西。）然后，将您的设备平放在桌子上，设备顶部朝北。在这种情况下，设备坐标将与世界坐标相同，并且磁力计传感器将产生您想要的值。

您的评论表明您对局部变化感兴趣。仅凭您的 Android 设备根本无法到达真正的北方。从理论上讲，您可以按照我的描述构建一张桌子，然后以与之前完全相同的方向拿着设备四处走动，并留意桌子以供参考。不过，我怀疑你能否成功。

您可以尝试在您的应用程序中使用陀螺仪来帮助您始终以完全相同的方式保持设备的方向，但是您使用的任何 Android 设备中的陀螺仪都可能漂移太多而无法正常工作。

或者也许我们仍然不明白你想要做什么。不过，最重要的是，您根本无法仅使用 Android 设备获得全局坐标系——无论您获得什么，都将始终与该确切位置的局部磁场对齐。

# android - 如何使用回调从 onTimeSet() 方法设置值？

> ID：13361012
> 
> 赞同：0
> 
> 时间：2012-11-13T12:45:33.163
> 
> 标签：android, interface, callback, timepicker

我在`TimePickerApp`课堂上有这个方法：

```
public void onTimeSet(TimePicker view, int minute, int second) {
    this.timerMinute = minute;
    this.timerSecond = second;
} 
```

当用户按下设置按钮时，我想从我的主类中设置分钟和秒的值，即调用`TimePicker`该方法的时候。`onTimeSet`

我在`TimePickerApp`课堂上获得了分钟和秒的方法。

我想使用接口实现回调，我的疑问是如何做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T00:10:22.637

将 TimePickerDialog 与不同的 OnTimeSetListener 回调一起使用，以便您可以使用您选择的任何对象来处理事件。

# html - 仅为 IE 设置 CSS？

> ID：13361015
> 
> 赞同：1
> 
> 时间：2012-11-13T12:45:37.707
> 
> 标签：html, css, internet-explorer, browser

我有一个简单`div`的 2px 厚边框和绝对定位，直到它的父元素悬停在它上面。由于 IE 的盒子模型，说的位置`div`在 IE 中有些偏离，但在任何其他浏览器中都没有。我不想为 IE 添加一个完全独立的样式表，我只想在浏览者使用 IE 时修改类本身。

那么如何只为 IE 修改**或**添加特定的类呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T12:49:43.390

您需要使用一种叫做**条件注释**的东西。这些仅在 IE 中有效（其他浏览器会将它们视为注释），因此它们是仅针对 IE 的好方法。

**示例**- 如果您想在 IE6 中完成某些操作，请使用以下命令：

```
<!--[if IE 6]>
Special instructions for IE 6 here
<![endif]-- 
```

要了解更多信息，请访问[有关条件注释的官方 MSDN 来源](http://msdn.microsoft.com/en-us/library/ms537512%28v=vs.85%29.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:52:58.047

您可以在 html（或其他）文件中添加以下条件片段。之后，您可以在您的`ie_stylesheet.css`

```
 <!--[if IE]>
    <link type="text/css" rel="stylesheet" media="all" href="ie_stylesheet.css"/>
  <![endif]--> 
```

[我认为这里](http://www.quirksmode.org/css/condcom.html)有足够的解释。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:54:43.317

您可以通过在样式表的开头添加 CSS 重置来尝试避免使用 IE 样式表。请查看以下内容：[http ://www.cssreset.com/scripts/html5-doctor-css-reset-stylesheet/](http://www.cssreset.com/scripts/html5-doctor-css-reset-stylesheet/)

重置应该有助于使元素在所有浏览器中的行为都相同。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T16:17:48.163

我发现[条件注释](http://www.quirksmode.org/css/condcom.html)的这种用法是一种非常优雅的方式，`<html>`可以使用可以在 CSS 和 JS 中使用的类来标记标签：

```
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html lang="en"> <!--<![endif]--> 
```

作为一个人为的例子，如果你想以 IE6 为目标使所有链接变为红色，你可以使用如下的特异性：

```
.lt-ie7 a {
  color: red;
} 
```

不需要单独的样式表。

资料来源：[条件样式表 vs CSS hacks？答：都没有！](http://paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/)

# android - Android：在运行时从 Internet 获取图像并显示在列表视图中的更有效的解决方案

> ID：13361018
> 
> 赞同：0
> 
> 时间：2012-11-13T12:45:55.833
> 
> 标签：android, listview

**场景**：有点棘手但很有趣。我已经发送了一个请求，它将给我一个 JSON 响应。此响应将进一步包含，例如 10 个 JSON 请求 URL。

然后我将向这 10 个 URL 发送请求，然后每个 URL 将包含 2 个图像 URL。这意味着总共有 20 张图像。

我的目的是`ListView`尽可能快地向用户展示这些图像。这是我到目前为止所做的：

**第 1 步：**活动开始后，弹出一个`ProgressDialog`显示加载圈，就像在 youtube 中一样。

**第 2 步：**在 AN`ASYNC TASK`中，发送提供这 10 个 JSON 请求的 URL 的第一个请求。发送此请求，然后解析并存储这 10 个 URL 作为响应。

**第 3 步：**从第一个（共 10 个）开始，发送将给出 JSON 响应的请求。

**第 4 步：**解析此响应以获取 2 个图像 URL 并存储在 LinkedList 中。

**第 5 步：**因为我们现在有了图像的实际链接，所以关闭进度对话框并获取图像。

**第 6 步：**此图像将存储在`drawable`. 我做了一个`BaseAdapter`叫做`ImageAdapter`has的习惯`ArrayList<Drawable> mImages`；

**第 7 步：**将接收到的 drawable 存储在 this 中`ArrayList`，使用：`adapter.mImages.add(drawable);`

**第 8 步：**然后调用`adapter.notifyDataSetChanged();`这将在图像准备好显示后立即更新列表视图。

**第 9 步：**返回第 3 步以处理更多 URL。

以下是代码（删除了所有不必要的代码）：

**活动类**

```
public class ImageViewer extends Activity {
    GridView gvImage;
    private ProgressDialog progressDialog;
    private final static Integer IMAGE_LIMIT = 10;
    private ImageAdapter adapter;

    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        try {
            setContentView(R.layout.ImageViewer);
            gvImage = (GridView) findViewById(R.id.gvImage);
            adapter = new ImageAdapter(this);
            gvImage.setAdapter(adapter);

            progressDialog = ProgressDialog.show(ImageViewer.this, "In Progress",
                    "Loading...", true, true, new DialogInterface.OnCancelListener() {

                        public void onCancel(DialogInterface dialog) {
                            finish();
                        }
                    });
            new SendRequest().execute(null);
        } catch (Exception e) {
        }
    }

    class SendRequest extends AsyncTask {
        protected Object doInBackground(Object... params) {
            try {
                HttpClient client = new DefaultHttpClient(httpParameters);
                HttpContext localContext = new BasicHttpContext();
                HttpGet httpGet = new HttpGet(BaseRequest_URL);

                JSONObject jsonResponse = null;

                HttpResponse httpResponse = client.execute(httpGet, localContext);
                if (httpResponse.getStatusLine().getStatusCode() == 200) {
                    HttpEntity entity = httpResponse.getEntity();
                    jsonResponse = getJSONObjectFromEntity(entity); //getJSONObjectFromEntity() will return JSONObject
                    processJSON(jsonResponse);
                }
                progressDialog.dismiss();
            } catch (Exception e) {
            }
            return null;
        }

        private void processJSON(JSONObject jsonResponse) throws JSONException {
            for (int i = 0; i < IMAGE_LIMIT; i++) {
                // Some JSON parsing. Output will be 'imageURL' which will be image URL
                displayImage(imageURL);
            }
        }

        public void displayImage(String uri150) {
            try {
                InputStream is = (InputStream) new URL(uri150).getContent();
                if(progressDialog.isShowing()){
                    progressDialog.dismiss();
                }
                Drawable d = Drawable.createFromStream(is, "image 150");
                adapter.mImages.add(d);
                handler.sendEmptyMessage(0); // Handler Below
            } catch (Exception e) {
            }
        }

        protected void onPostExecute(Object result) {
            super.onPostExecute(result);
        }
    }

    private Handler handler = new Handler(){
        public void handleMessage(android.os.Message msg) {
            adapter.notifyDataSetChanged();
        };
    };
} 
```

**图像适配器类：**

```
public class ImageAdapter extends BaseAdapter {
    Context context;
    public ArrayList<Drawable> mImages = new ArrayList<Drawable>();

    public ImageAdapter(Context c) {
        this.context = c;
    }

    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imageView = new ImageView(context);
        try {
            imageView.setLayoutParams(new GridView.LayoutParams(150, 150));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setImageDrawable(mImages.get(position));
            imageView.setTag("Image" + position);
        } catch (Exception e) {
        }
        return imageView;
    }
} 
```

**问题：**

1.  我看到它的方式`ImageAdapter`被称为多次。有没有其他方法可以减少它。

2.  如何优化 ImageAdapter 的代码。

3.  还有什么改进吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:55:04.780

我可以肯定地告诉你，将图像存储在内存中是**错误**的，因为你会得到**OutOfMemoryException**。

要了解如何使用图像和缓存，请访问[高效显示位图](http://developer.android.com/training/displaying-bitmaps/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T14:42:57.753

1.  （前 2 个问题）适配器不仅控制显示哪一行（在列表中查看），它还回收它。在您的适配器中，getView 每次调用时都会创建一个新视图，如果旧视图不可用，它应该只创建一个新视图。[在此处](https://github.com/commonsguy/cw-andtutorials/blob/master/05-FancyList/LunchList/src/apt/tutorial/LunchList.java)查看 Mark Murphy（commonsware）的适配器。

2.  在您的代码中，所有图像都是在进度对话框期间下载的。您的用户可能不会看到最后一个，这肯定会加重您的记忆负担。我建议您延迟加载 JSON 和图像（请求您的 JSON，解析它，根据您的用户看到/滚动的网格数量来异步加载图像）。关于图像延迟加载的讨论很多，您绝对应该从 Fedor 的[回答](https://stackoverflow.com/questions/541966/how-do-i-do-a-lazy-load-of-images-in-listview/3068012#3068012)开始。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T09:58:01.247

试试[这个](https://github.com/thest1/LazyList)库。它非常适合layz加载。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T10:08:41.293

只需搜索 Android LazyImageLoading

祝你好运

# frameworks - XCode 4.5 编译框架 C++ 文件

> ID：13361021
> 
> 赞同：1
> 
> 时间：2012-11-13T12:46:29.933
> 
> 标签：frameworks, compilation, header

我刚刚开始收到编译错误 - 在文件中 - CAMediaTiming.h（我相信这是 QuartzCore 框架的一部分）。

@class NSString; -------- Prefix 属性后面必须跟一个接口或协议。

在通过 StackOverflow 搜索时，我推断这是一个 C 文件（因此它应该允许 @class）但是，Xcode 不应该再次编译它......

我不知道这是怎么发生的，因为我没有触及任何 Build 设置，事实上，我刚刚在辅助类中添加了一条简单的线 - 我将这条线放入了.... ([numberArray removeAllObjects]; ) 然后我把它拿回来，但问题仍然存在，所以这是一个死胡同:)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T15:34:19.437

我已经解决了这个问题-

基本上，在其中一个 .m 文件中，我有标准注释......

```
//  filename.m
//
// Created by......
// Copyright  .....
// 
```

不知何故，我（一定是我，因为它是一个单独的项目，但我发誓我没有这样做）所以 - 它变成了......

```
UIButton//
//  filename.m
//
// Created by......
// Copyright.....
// 
```

在进行一些实验后，根据它所在的文件，可能会在不相关的文件中导致无数编译器错误。

# android - 如何在android中获取内部和外部sdcard路径

> ID：13361024
> 
> 赞同：20
> 
> 时间：2012-11-13T12:46:52.717
> 
> 标签：android, file, android-sdcard, android-file

大多数新的 android 设备都有一个内部 sdcard 和一个外部 sdcard。我想制作一个文件资源管理器应用程序，但我不知道如何获取在我的应用程序中使用的路径，因为

```
File file = Environment.getExternalStorageDirectory(); 
```

只是在大多数设备中返回，`/mnt/sdcard` 但其他外部 SD 卡还有另一条路径，例如`/storage1 or /storage2` . 任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2016-08-04T06:34:13.847

> 如何在android中获取内部和外部sdcard路径

**存储在内部存储中的方法：**

```
File getDir (String name, int mode)

File getFilesDir () 
```

以上方法存在于`Context`类中

**存储在手机内存中的方法：**

```
File getExternalStorageDirectory ()

File getExternalFilesDir (String type)

File getExternalStoragePublicDirectory (String type) 
```

一开始大家都用`Environment.getExternalStorageDirectory()`，指向手机内存的**根。**结果，根目录充满了随机内容。

后来又增加了这两个方法：

在`Context`课堂上，他们添加了`getExternalFilesDir()`，指向手机内存中的特定应用目录。卸载应用程序时，该目录及其内容将被删除。

`Environment.getExternalStoragePublicDirectory()`用于存储知名文件类型（如照片和电影）的集中位置。卸载应用程序时，该目录及其内容**不会**被删除。

**存储在可移动存储（即微型 SD 卡）中的方法**

在 API 级别 19 之前，没有官方的方式存储在 SD 卡中。但是许多人可以使用非官方的 API 来做到这一点。

**正式地，在API 级别 19**（Android 版本 4.4 - Kitkat）的`Context`类中引入了一种方法。

 **```
File[] getExternalFilesDirs (String type) 
```

> 它返回所有共享/外部存储设备上应用程序特定目录的绝对路径，应用程序可以在其中放置其拥有的持久文件。这些文件是应用程序内部的，通常不会作为媒体对用户可见。

这意味着，它将返回到 Micro SD 卡和内部存储器的路径。通常，**第二个返回路径**是 micro SD 卡的存储路径。

根据 Google/官方 Android 文档的内部和外部存储**术语**与我们的想法有**很大不同。**

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-06T07:29:09.640

是的。不同的制造商使用不同的 SD 卡名称，如三星 Tab 3 它的 extsd，而其他三星设备使用不同的 SD 卡，不同的制造商使用不同的名称。

我和你有同样的要求。所以我从我的项目中为您创建了一个示例示例转到此链接[Android 目录选择器](https://github.com/shivarajp/AndroidDirectoryChooserExample)示例，该示例使用 android-dirchooser 库。此示例检测 SD 卡并列出所有子文件夹，它还检测设备是否有多个 SD 卡。

部分代码如下所示完整示例转到链接[Android 目录选择器](https://github.com/shivarajp/AndroidDirectoryChooserExample)

```
/**
* Returns the path to internal storage ex:- /storage/emulated/0
 *
* @return
 */
private String getInternalDirectoryPath() {
return Environment.getExternalStorageDirectory().getAbsolutePath();
 }

/**
 * Returns the SDcard storage path for samsung ex:- /storage/extSdCard
 *
 * @return
 */
    private String getSDcardDirectoryPath() {
    return System.getenv("SECONDARY_STORAGE");
}

 mSdcardLayout.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View view) {
        String sdCardPath;
        /***
         * Null check because user may click on already selected buton before selecting the folder
         * And mSelectedDir may contain some wrong path like when user confirm dialog and swith back again
         */

        if (mSelectedDir != null && !mSelectedDir.getAbsolutePath().contains(System.getenv("SECONDARY_STORAGE"))) {
            mCurrentInternalPath = mSelectedDir.getAbsolutePath();
        } else {
            mCurrentInternalPath = getInternalDirectoryPath();
        }
        if (mCurrentSDcardPath != null) {
            sdCardPath = mCurrentSDcardPath;
        } else {
            sdCardPath = getSDcardDirectoryPath();
        }
        //When there is only one SDcard
        if (sdCardPath != null) {
            if (!sdCardPath.contains(":")) {
                updateButtonColor(STORAGE_EXTERNAL);
                File dir = new File(sdCardPath);
                changeDirectory(dir);
            } else if (sdCardPath.contains(":")) {
                //Multiple Sdcards show root folder and remove the Internal storage from that.
                updateButtonColor(STORAGE_EXTERNAL);
                File dir = new File("/storage");
                changeDirectory(dir);
            }
        } else {
            //In some unknown scenario at least we can list the root folder
            updateButtonColor(STORAGE_EXTERNAL);
            File dir = new File("/storage");
            changeDirectory(dir);
        }

    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-08-18T12:50:31.670

由于没有直接获取路径的方法，解决方案可能是扫描 /system/etc/vold.fstab 文件并查找如下行：dev_mount sdcard /mnt/sdcard 1 /devices/platform/s3c-sdhci.0/ mmc_host/mmc0

找到一个后，将其拆分为其元素，然后拉出该挂载点的路径并将其添加到 arraylist

*强调文本*一些设备完全缺少vold文件，所以我们在这里添加一个路径以确保列表始终包含第一个sdcard的路径，无论是真实的还是模拟的。

```
 sVold.add("/mnt/sdcard");

    try {
        Scanner scanner = new Scanner(new File("/system/etc/vold.fstab"));
        while (scanner.hasNext()) {
            String line = scanner.nextLine();
            if (line.startsWith("dev_mount")) {
                String[] lineElements = line.split(" ");
                String element = lineElements[2];

                if (element.contains(":"))
                    element = element.substring(0, element.indexOf(":"));

                if (element.contains("usb"))
                    continue;

                // don't add the default vold path
                // it's already in the list.
                if (!sVold.contains(element))
                    sVold.add(element);
            }
        }
    } catch (Exception e) {
        // swallow - don't care
        e.printStackTrace();
    }
} 
```

现在我们已经有了一个干净的挂载路径列表，测试每个路径以确保它是有效且可用的路径。如果不是，请将其从列表中删除。

```
private static void testAndCleanList() 
{
    for (int i = 0; i < sVold.size(); i++) {
        String voldPath = sVold.get(i);
        File path = new File(voldPath);
        if (!path.exists() || !path.isDirectory() || !path.canWrite())
            sVold.remove(i--);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-06-19T06:21:33.113

我不确定这个答案有多普遍，但我在装有 Android 4.4 的摩托罗拉 XT830C 和 Nexus 7 android 6.0.1 上对其进行了测试。在三星 SM-T530NU Android 5.0.2 上。我用`System.getenv("SECONDARY_STORAGE")`和`Environment.getExternalStorageDirectory().getAbsolutePath()`。
没有第二张 SD 卡的 Nexus`System.getenv`返回 null 并`Envirnoment.getExterna...`给出 /storage/emulated/0。
具有外部 SD 卡的摩托罗拉设备为 /storage/sdcard1`System.getenv("SECONDARY_STORAGE")`提供`Envirnoment.getExterna...`/storage/emulated/0。
samsumg 为外部 SD 返回 /storage/extSdCard。
就我而言，我正在外部位置创建一个子目录并使用

```
 appDirectory = (System.getenv("SECONDARY_STORAGE") == null)
       ? Environment.getExternalStorageDirectory().getAbsolutePath()
       : System.getenv("SECONDARY_STORAGE"); 
```

找到SD卡。在这个目录中创建一个子目录是有效的。
当然，我必须在清单文件中设置访问外部存储器的权限。
我还有一个 Nook 8" 彩色平板电脑。当我有机会对其进行测试时，如果我对这种方法有任何问题，我会发布。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T13:04:28.437

> 但其他外部 sdcard 有另一条路径，如 /storage1 或 /storage2

Android SDK 中没有任何东西——至少通过 Android 4.1——可以让您访问这些路径。无论如何，您的应用程序可能无法读取或写入它们。此类存储位置的行为及其用途取决于设备制造商。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-01-27T13:05:20.237

对于所有 Android 版本，

权限：

```
<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" android:maxSdkVersion="29" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" android:maxSdkVersion="29" />
<uses-permission android:name="android.permission.MANAGE_EXTERNAL_STORAGE" tools:ignore="ScopedStorage" /> 
```

使用 Android 10 的 requestLegacyExternalStorage（添加到 AndroidManifest > application 标签）：

```
android:requestLegacyExternalStorage="true" 
```

获取内部目录路径：

```
@Nullable
public static String getInternalStorageDirectoryPath(Context context) {
    String storageDirectoryPath;

    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.R) {
        StorageManager storageManager = (StorageManager) context.getSystemService(Context.STORAGE_SERVICE);
        if(storageManager == null) {
            storageDirectoryPath = null; //you can replace it with the Environment.getExternalStorageDirectory().getAbsolutePath()
        } else {
            storageDirectoryPath = storageManager.getPrimaryStorageVolume().getDirectory().getAbsolutePath();
        }
    } else {
        storageDirectoryPath = Environment.getExternalStorageDirectory().getAbsolutePath();
    }

    return storageDirectoryPath;
} 
```

获取外部目录：

```
@NonNull
public static List<String> getExternalStorageDirectoryPaths(Context context) {
    List<String> externalPaths = new ArrayList<>();
    String internalStoragePath = getInternalStorageDirectoryPath(context);

    File[] allExternalFilesDirs = ContextCompat.getExternalFilesDirs(context, null);
    for(File filesDir : allExternalFilesDirs) {
        if(filesDir != null) {
            int nameSubPos = filesDir.getAbsolutePath().lastIndexOf("/Android/data");
            if(nameSubPos > 0) {
                String filesDirName = filesDir.getAbsolutePath().substring(0, nameSubPos);
                if(!filesDirName.equals(internalStoragePath)) {
                    externalPaths.add(filesDirName);
                }
            }
        }
    }

    return externalPaths;
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-09-08T03:54:34.753

```
File main=new File(String.valueOf(Environment.getExternalStorageDirectory().getAbsolutePath()));
File[]t=main.getParentFile().listFiles();

for(File dir:t)
{
    Log.e("Main",dir.getAbsolutePath());
} 
```

输出：

```
E/Main: /storage/sdcard1
E/Main: /storage/sdcard0 
```

我有一张 SD 卡和内置内存。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-08-18T05:33:13.357

试试这个代码，它会有所帮助

```
Map<String, File> externalLocations = ExternalStorage.getAllStorageLocations();
File sdCard = externalLocations.get(ExternalStorage.SD_CARD);
File externalSdCard = externalLocations.get(ExternalStorage.EXTERNAL_SD_CARD); 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2014-07-08T00:47:53.803

没有用于获取内部/外部 sdcard 路径的公共 api。

但是在 android.os.storage 包中有一个叫做 StorageManager 的平台 api。见[http://goo.gl/QJj1eu](http://goo.gl/QJj1eu)。

有列表存储、挂载/卸载存储、获取挂载状态、获取存储路径等功能。

但它是隐藏的 api，它应该在下一个 android 版本中被弃用或破坏。

并且有些方法需要特别许可，而且大多数都没有记录在案。**

# jasper-reports - 如何使用 ireport 将多个字段值添加到图表中的类别表达式？

> ID：13361031
> 
> 赞同：1
> 
> 时间：2012-11-13T12:47:37.623
> 
> 标签：jasper-reports, ireport

我有一张如下所示的表格

ID 名称 年份 1 月 2 月 3 月 4 月 5 月 [这些是列名]

1 abc 2012 2.5 3.2 2.5 2.3 6.2 [这些是我表行中的值]

2 美国广播公司 2011 3.9 6.2 7.5 6.5 6.8

我正在尝试创建一个折线图，其中 x 轴是我的列名，即 Jan、Feb 等，我的 Y 轴应该是其对应的值。系列表达式将是年份。

有人可以帮我创建类别表达式和价值表达式，因为我无法这样做吗？

任何帮助，将不胜感激。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:28:31.603

将查询输出重新格式化为：

```
 ID     Name     Year     Month     Value
  1      abc     2012     Jan       2.5
  1      abc     2012     Feb       3.2
  ...
  2      abc     2011     May       6.8 
```

您的月份也可以是 yyyy-mm，这可能有助于更好地组织您的输出。然后在 x 轴（类别）上使用月份，对于 y 轴（值），使用值。

# php - 用 mysql 标记云

> ID：13361034
> 
> 赞同：1
> 
> 时间：2012-11-13T12:47:48.287
> 
> 标签：php, mysql, tags, cloud

有没有其他方法可以在没有临时表的情况下从 mysql 制作标签云？

```
mysql> 解释壁纸关键字；
+--------------+-----------+------+--- --+---------+----------------+
| 领域 | 类型 | 空 | 钥匙 | 默认 | 额外 |
+--------------+-----------+------+--- --+---------+----------------+
| 编号 | mediumint(7) 无符号 | 否 | 优先级 | 空 | 自动增量 |
| 壁纸_id | mediumint(7) 无符号 | 是 | 穆尔 | 空 | |
| 关键字 ID | smallint(5) 无符号 | 是 | 穆尔 | 空 | |
+--------------+-----------+------+--- --+---------+----------------+

mysql>解释关键字；
+---------+----------+------+-----+-- -------+----------------+
| 领域 | 类型 | 空 | 钥匙 | 默认 | 额外 |
+---------+----------+------+-----+-- -------+----------------+
| 编号 | mediumint(7) 无符号 | 否 | 优先级 | 空 | 自动增量 |
| 关键词 | varchar(32) | 是 | 统一 | 空 | |
+---------+----------+------+-----+-- -------+----------------+

```

`SELECT k.keyword,count(k.keyword) AS count FROM keywords k Left Join wallpaper_keywords wk ON wk.keyword_id = k.id GROUP BY wk.keyword_id, k.keyword ORDER BY count DESC limit 100;`

```
+----------+------+
| 关键词 | 计数 |
+----------+------+
| 电脑 | 10 |
| 路| 4 |
| 树 | 4 |
| 窗口 | 4 |
| 自然 | 4 |
| 森林 | 3 |
| 汽车 | 3 |
| 马自达 | 3 |
| 摘要 | 3 |
| 搞笑 | 3 |
| 运动 | 3 |
| 海| 高分辨率照片| CLIPARTO 3 |
| 城市| 3 |
| 战士 | 2 |
| 鸟| 高分辨率照片| CLIPARTO 2 |
| 灯| 1 |
| 夏天| 1 |
| 空间 | 1 |
| 黄昏 | 1 |
| Ubuntu | 1 |
+----------+------+

解释：

+----+-------------+--------+--------+- --------------+---------+---------+------+------+- ---------------------------------------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+--------+--------+- --------------+---------+---------+------+------+- ---------------------------------------------+
| 1 | 初级 | 关键词 | 索引 | 空 | 关键词 | 99 | 空 | 20 | 使用索引；使用临时的；使用文件排序 |
| 1 | 初级 | | 全部 | 空 | 空 | 空 | 空 | 54 | |
| 2 | 派生 | 壁纸_关键词 | 索引 | 空 | 初级 | 3 | 空 | 54 | |
+----+-------------+--------+--------+- --------------+---------+---------+------+------+- ---------------------------------------------+
3 行一组（0.00 秒）

```

**编辑** 另一个查询： `SELECT count,k.keyword from (SELECT * , count(wk.keyword_id) AS count FROM wallpaper_keywords wk GROUP BY wk.keyword_id LIMIT 50000) as data left join keywords as k on k.id = data.keyword_id order by count desc limit 500`

```
+----+-------------+------------+--------+-------- --------+------------+---------+------------------+- -----+----------------+
| 编号 | 选择类型 | 表| 类型 | 可能的键 | 关键 | key_len | 参考 | 行 | 额外 |
+----+-------------+------------+--------+-------- --------+------------+---------+------------------+- -----+----------------+
| 1 | 初级 | | 全部 | 空 | 空 | 空 | 空 | 20 | 使用文件排序 |
| 1 | 初级 | ķ | eq_ref | 初级 | 初级 | 3 | 数据.keyword_id | 1 | |
| 2 | 派生 | 周 | 索引 | 空 | 关键字 ID | 3 | 空 | 59 | |
+----+-------------+------------+--------+-------- --------+------------+---------+------------------+- -----+----------------+

```

现在的问题是 - 有没有更好的解决方案？更便宜的（SHOW STATUS LIKE 'last_query_cost';）方法算吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T14:03:20.277

为了计算每个关键字的总值，您可以在表关键字中使用附加字段 (total_count)，并且通过每次添加新关键字向该字段添加 +1 - 当您将拥有 100 000 条记录时，这对您的数据库来说真的更简单。

# iphone - UIScrollView 滚动问题（无法设置 userInteraction 或查找框架）

> ID：13361038
> 
> 赞同：0
> 
> 时间：2012-11-13T12:48:26.003
> 
> 标签：iphone, objective-c, xcode, uiscrollview, interface-builder

我已经在界面生成器中创建了一个 UIScrollView，并且我已经正确地链接了这一切。当我尝试在 scrollV 上设置 userInteractionEnabled 时，它似乎并没有改变值（见下文）：

![不变](../Images/8bf57c4cacc11e2da45fe6471953adc9.png)

我打印了许多值来检查正在发生的事情，但我很困惑：

**(lldb) p self.scrollV.userInteractionEnabled
(BOOL) $3 = NO

(lldb) p self.scrollV.contentSize
(CGSize) $4 = (width=320, height=479)

(lldb) p self.scrollV.frame
错误：属性在“UIScrollView *”类型的对象上找不到“框架”错误：1 解析表达式错误**

我发现 frame 属性没有显示很奇怪，但是当我自己打印出 scrollView 时，我得到以下信息：

**(lldb) po self.scrollV
(UIScrollView *) $5 = 0x16f7a8d0`<UIScrollView: 0x16f7a8d0; frame = (0 60; 320 312); clipsToBounds = YES; autoresize = RM+TM; gestureRecognizers = <NSArray: 0x16fb2630>; layer = <CALayer: 0x16f08860>; contentOffset: {0, 0}>`**

在我看来，这似乎意味着有 2 个 UIScrollViews 彼此独立工作，我最初使用 IBOutlet UIScrollView *scrollV; 将 scrollV 声明为如下实例变量；

但是，为了查看这是否由于某种原因导致问题，我也尝试使用：@property (nonatomic, retain) IBOutlet UIScrollView *scrollV; 并更改所有对“自我”的引用。

任何人都可以就为什么会发生这种情况提供任何建议吗？我目前正在使用以下函数将对象添加到 scrollV：

```
- (void)addTitle:(NSString *)title withText:(NSString *)text andPosition:(int *)yPos
{
    UILabel *titleLabel = [[UILabel alloc] initWithFrame:CGRectMake(4, *yPos, 312, 30)];
    [titleLabel setTextColor:kBlueColor];
    [titleLabel setText:[NSString stringWithFormat:@" %@", title]];
    [titleLabel setFont:[UIFont boldSystemFontOfSize:18]];

*yPos += titleLabel.frame.size.height;

// Rounds up the int
int tbHeight = (([text length] + 40 - 1) / 40);

tbHeight = 19 + (19 * tbHeight);

UITextView *textV = [[UITextView alloc] initWithFrame:CGRectMake(4, *yPos, 312, tbHeight)];
[textV setTextColor:kBlueColor];
[textV setFont:[UIFont systemFontOfSize:14]];
[textV setScrollEnabled:NO];
[textV setShowsVerticalScrollIndicator:NO];
[textV setEditable:NO];
[textV setText:text];

*yPos += textV.frame.size.height + 5;

[self.scrollV addSubview:titleLabel];
[self.scrollV addSubview:textV];
} 
```

我已经添加了代码，以防万一这些由于某种原因干扰了 scrollV。运行应用程序时会显示所有视图，因此 scrollV 肯定存在并且在 IB 中很好地链接起来。

任何关于这个问题的建议都将非常受欢迎。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:42:55.397

该行有一个断点`self.scrollV.userInteractionEnabled =YES`

删除它并禁用断点

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:03:23.530

好的，我设法解决了这个问题，看来我不小心在界面生成器中将 UIView userInteractionEnabled 设置为 NO。这会将其应用于所有子视图，从而导致我的 scrollView 也为 NO。

# c# - Windows 8 / XAML 双击事件总是在 Tap 之前

> ID：13361039
> 
> 赞同：8
> 
> 时间：2012-11-13T12:48:27.940
> 
> 标签：c#, xaml, windows-8, touch, double-click

我在应用程序中有一个按钮。我希望它根据我是点击它（暂停动画）还是双击（重新启动动画）来做不同的事情

但是，当我双击时，它似乎首先触发了点击事件，然后是快速连续的双击。有没有解决的办法？这是一个已知问题还是我犯了一个新手错误？

编辑：对于那些询问的人，我正在使用`Tapped`and`DoubleTapped`事件。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-07-02T14:44:29.847

给单个选项卡一些暂停。如果出现双标签，则消除单标签事件

```
 bool singleTap;
    private async void control_Tapped_1(object sender, TappedRoutedEventArgs e)
    {
        this.singleTap = true;
        await Task.Delay(200);
        if (this.singleTap)
        {
              // Single tab Method .
        }
    }

    private void control_DoubleTapped_1(object sender, DoubleTappedRoutedEventArgs e)
    {
        this.singleTap = false;

        // Double tab Method  
  } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-14T04:07:56.080

您可能要考虑让它两者兼而有之。把它想象成双击 Windows 中的文件夹。用户将习惯于第一次单击时发生的事情（突出显示文件夹），他们会期望双击突出显示，然后导航。

总而言之，这似乎是一个设计问题，而不是技术问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-22T23:43:04.983

```
[System.Runtime.InteropServices.DllImport("user32.dll")]
static extern uint GetDoubleClickTime();
    bool _singleTapped = false;

        //Tapped event handler
        private async void control_Tapped(object sender, TappedRoutedEventArgs e)
        {
        _singleTapped = true;
            //var x = GetDoubleClickTime();
            //GetDoubleClickTime() gets the maximum number of milliseconds that can elapse between a first click and a second click
            await Task.Delay(TimeSpan.FromMilliseconds(GetDoubleClickTime()));

            if (!_singleTapped)
            { return; }
           //SingleTapped code
        }

        //DoubleTapped event handler
        private async void control_DoubleTapped(object sender, DoubleTappedRoutedEventArgs e)
        {
            _singleTapped = false;
            //DoubleTapped code
        } 
```

# sql - 使用日期在 Oracle 中创建表

> ID：13361040
> 
> 赞同：2
> 
> 时间：2012-11-13T12:48:30.943
> 
> 标签：sql, oracle, oracle10g

我想在 Oracle 10g 中创建一个表，并且我想为我的日期列指定日期格式。如果我使用以下语法：

```
create table datetest(
........
startdate date); 
```

然后日期列将接受`DD-MON-YY`我不想要的日期格式。

我希望我的日期列的语法是`MM-DD-YYYY`

请让我知道如何进行此操作。

问候，

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T13:04:49.203

A`DATE`没有固有的格式。它不仅仅是一个恰好代表日期的字符串。Oracle 有自己的内部格式来存储日期值。

当需要将实际日期值转换为字符串时，格式就会发挥作用，反之亦然，这当然会发生很多，因为我们以交互方式将日期写为字符串。

您的数据库的默认日期格式由`NLS_DATE_FORMAT`您可能设置的 settings 确定`DD-MON-YYYY`（我相信这是美式英语语言环境的默认设置）。为方便起见，您可以在数据库级别或单个会话中更改此设置，但通常更安全的编程实践是明确的，这样您就不会遇到错误，或者更糟糕的是，如果您的代码在不同的环境中运行，则会出现错误的结果.

明确指定日期值的最简单方法是使用日期文字，即单词“日期”后跟表示 YYYY-MM-DD 格式的日期的字符串，例如`date '2012-11-13'`. Oracle 解析器直接将其转换为相应的内部日期值。

如果您想使用不同的格式，那么我建议您在代码中明确使用 TO_CHAR/TO_DATE 和所需的格式模型。例子：

```
INSERT INTO my_table (my_date) VALUES ( TO_DATE( '11-13-2012', 'MM-DD-YYYY' ) );

SELECT TO_CHAR( my_date, 'MM-DD-YYYY' ) FROM my_table; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:05:56.953

日期 r 没有您建议的格式。它们在内部存储为 7 字节数字。选择时格式化日期，请使用`TO_CHAR(yourdatefield, 'format')`

格式都显示在这里：[http ://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements004.htm#i34924](http://docs.oracle.com/cd/B19306_01/server.102/b14200/sql_elements004.htm#i34924)

```
eg to_char(startdate, 'mm-dd-yyyy') 
```

# ios5 - ios smsComposer phonegap 插件是否适用于cordova-2.1.0 js 文件

> ID：13361046
> 
> 赞同：0
> 
> 时间：2012-11-13T12:49:09.697
> 
> 标签：ios5, phonegap-plugins, cordova-2.0.0

我能够在cordova-1.9.0 中集成iOS smsComposer phonegap 插件，但不能与cordova-2.1.0 js 文件集成。可能是什么问题。任何人都在使用该插件，或者该插件是否支持cordova-2.1.o，还有一件事是如何确定电话间隙插件是否支持我们当前的cordova-xxx。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-26T22:58:33.177

上个月在 [git phonegap plugins有一个新版本的 SMSComposer](https://github.com/phonegap/phonegap-plugins/tree/master/iOS/SMSComposer)

我让它与cordova-2.2.0.js一起使用

笔记：

*   他们使用了一个文件：SMSComposer.js 我必须将“Cordova”更改为“cordova”才能使其正常工作。
*   它也适用于较旧的 iOS 版本。我想我是通过在 Xcode 中更改它来打破它的，这是我第一次使用插件时。

# entity-framework - 实体框架 - 表命名冲突应用程序、用户、角色

> ID：13361047
> 
> 赞同：0
> 
> 时间：2012-11-13T12:49:17.297
> 
> 标签：entity-framework

我们正处于使用 EF4/5（以及 Silverlight 的 RIA 服务）的项目的数据库设计阶段。

我们当前的模式有如下表：应用程序、用户和帐户

在 .NET 中，我与现有对象发生命名冲突，并且必须指定我自己的对象，例如：System.Windows.Application

```
EntityQuery<Customer.Web.Application> queryApplicationT32 = custDomainContext.GetApplicationsQuery(); 
```

问题：最好的做法是这样做，还是在 EF 中映射到其他东西，例如 CustApplication？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:54:40.530

如果`Application`和是您域中真正有意义的名称`User`，`Account`您应该使用它们。

当您对两个类都有 using 语句时，您只会有名称冲突：

```
using Customer.Web;
using System.Windows; 
```

如果您只使用其中一个，则不会发生冲突。如果您同时使用两者，则必须完全指定您的类名。

您还可以使用[别名](http://msdn.microsoft.com/en-us/library/c3ay4x3d%28v=vs.110%29.aspx)：`using myAlias = Customer.Web;`这样您就可以通过使用简写别名来指定要使用的类。

# shell - sed(1)：添加一行

> ID：13361053
> 
> 赞同：2
> 
> 时间：2012-11-13T12:50:05.120
> 
> 标签：shell, scripting, sed

我在文件中有以下文本结构：

```
"require": {
    "php": ">=5.3.3",
    "symfony/symfony": "2.1.*",
    "jms/di-extra-bundle": "1.1.*"
}, 
```

我想补充

> , "friendsofsymfony/user-bundle": "*"

在“}”之前，使用 sed(1)。

我还必须考虑到最后一行的末尾可能有也可能没有逗号。

我尝试了很多东西；

```
sed '/require/,/\},/ { /[^,]$/ i//&,\n        '\'something\''/ }' composer.json; 
```

但我无法让它工作。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:44:47.783

这很难用 sed 稳健地完成，您应该使用适当的 JSON 库。

但是要使用 GNU sed 做你想做的事情，你可以做这样的事情（这里不检查结尾的逗号）：

```
sed '/require/,/},/ s/},/, "friendsofsymfony\/user-bundle": "\*"\n&/ 
```

要检查结尾逗号，您需要进行更多解析：

*解析.sed*

```
/^[ \t]*"require/ {                       # when 'require' found
  : a
  N                                       # run through pairwise
  /\n[\t ]*\},/! { P; s/[^\n]+\n//; ba }  # lines until '},' is found
  /,\n/! s/\n/,&/                         # append comma if not present
  s/\n([\t ]*)},/\n\1\1"friendsofsymfony\/user-bundle": "\*"&/
} 
```

运行：

```
sed -rf parse.sed infile 
```

在提供的示例文件上运行时*parse.sed*的输出摘录：

```
[...]

"require": {
    "php": ">=5.3.3",
    "symfony/symfony": "2.2.*",
    "doctrine/orm": ">=2.2.3,<2.4-dev",
    "doctrine/doctrine-bundle": "1.0.*",
    "twig/extensions": "1.0.*",
    "symfony/assetic-bundle": "2.1.*",
    "symfony/swiftmailer-bundle": "2.1.*",
    "symfony/monolog-bundle": "2.1.*",
    "sensio/distribution-bundle": "2.2.*",
    "sensio/framework-extra-bundle": "2.2.*",
    "sensio/generator-bundle": "2.2.*",
    "jms/security-extra-bundle": "1.3.*",
    "jms/di-extra-bundle": "1.2.*",
    "friendsofsymfony/user-bundle": "*"
},

[...] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:57:01.497

使用`i`命令插入。在要插入的字符串的末尾需要换行符：

```
sed '/require/,/},/{/^},/i, "friendsofsymfony/user-bundle": "*"
}' 
```

# django - django 中的选择选项没有显示正确的数据

> ID：13361057
> 
> 赞同：0
> 
> 时间：2012-11-13T12:50:21.133
> 
> 标签：django, drop-down-menu, django-models, django-templates

谁能帮我解决这个问题。非常感谢您的帮助。谢谢。

这是我的程序

模板.html

```
<tbody>
{% for condition in conditioner %}
{{ condition.owner }}
{% with "#CCE6FF" as bgcolor %} 
<tr>
    <td style="height: 30">{{ condition.NEW_DATE }}</td>
    <td>
        <select class="SMOKER select_input" name="condition">
            <option value="{{condition.SMOKER.01}}" >Never</option>
            <option value="{{condition.SMOKER.02}}" >Ex-Smoker</option>
        </select>
    <td><input type="text" name="condition" id="condition{{ forloop.counter }}" value="{{ condition.WEIGHT }}" /></td>
    <td><input type="text" name="condition" id="condition{{ forloop.counter }}" value="{{ condition.HEIGHT }}" /></td>
    <td><input type="text" name="condition" id="condition{{ forloop.counter }}" value="{{ condition.BP }}" /></td>
</tr>
----more program--- 
```

模型.py

```
class Condition(models.Model):
owner = models.ForeignKey(Afdeling)
CPR = models.ForeignKey(Patient)
NEW_DATE = models.DateField(null = True, blank = True)

smoker = (("01" , 'Never'),
         ("02" , 'Ex-Smoker'),

SMOKER      = models.CharField(max_length = 2, choices = smoker, null = True, blank = True)    

WEIGHT      = models.DecimalField(max_digits = 5, decimal_places = 1, null = True, blank = True)

HEIGHT      = models.DecimalField(max_digits = 5, decimal_places = 1, null = True, blank = True)

BP = models.SmallIntegerField(max_length = 3, null = True, blank = True)
----more models.py--- 
```

![条件输出](../Images/c884d104a81044fa2a1a894bbf6ef307.png)

它显示了表格和选定的选项，但没有显示正确的数据。

> 在我的数据库中，19 okt 应该是 Ex-Smoker，但在这里它显示 Never 到所有列。

该表的 html 是：

```
<select class="SMOKER select_input" name="condition">
<option value="2" >Never</option>
<option value >Ex-Smoker</option>
</select> 
```

我希望我的解释是可以理解的，如果有人需要更多澄清，我会尽力解释。我真的需要这方面的帮助。非常感谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:46:41.863

我承认我不完全理解，例如你想要做什么`{{condition.SMOKER.01}}`，看起来你更愿意做`{{ condition.smoker.0.0 }}`，`{{ condition.smoker.1.0 }}`哪个会分别输出`01`和`02`，就像在 python`condition.smoker[0][0]`和`condition.smoker[0][1]`.

无论如何，关于这个：

> 在我的数据库中，19 okt 应该是 Ex-Smoker，但在这里它显示 Never 到所有列。

这仅仅是因为您从未使用`selected="selected"`. 也许它应该看起来像这样：

```
 <select class="SMOKER select_input" name="condition">
        <option value="{{condition.smoker.0.0}}" {% if condition.SMOKER == condition.smoker.0.0 %}selected="selected"{% endif %}>Never</option>
        <option value="{{condition.smoker.1.0}}" {% if condition.SMOKER == condition.smoker.1.0 %}selected="selected"{% endif %}>Ex-Smoker</option>
    </select> 
```

希望这可以帮助。但正如我所说，很难理解您要做什么，而且您故意违反通用标准这一事实无济于事：使用大写的属性名称和小写的伪常量与我们使用的相反要做 - 以及您在 django 文档中可以看到的内容，如下所示：

```
class Condition(models.Model):
    SMOKER_CHOICES = (
        ("01" , 'Never'),
        ("02" , 'Ex-Smoker'),
    )
    smoker = models.CharField(max_length=2, choices=SMOKER_CHOICES)
    # etc .... 
```

所以也许你只是被自己的气质弄糊涂了？

# c++ - 链表的冒泡排序

> ID：13361059
> 
> 赞同：1
> 
> 时间：2012-11-13T12:50:25.543
> 
> 标签：c++, linked-list, bubble-sort

我正在尝试使用冒泡排序对单链表进行排序。如果有一个简单的错误，请原谅。请告诉我哪里出错了。当我尝试执行此操作时，程序意外停止。

```
void sortBubble()
{
      Node *i=start,*j=start;Node *temp;Node* prev=start;Node* agla;
      while(i->next!=NULL)
      {
           cout<<"\nhello 1";
           j=i;
           agla=j->next;
           while(agla!=NULL)
           {
                temp=NULL;temp->next=NULL;
                cout<<"\nhello2";

                if(*(j) > *(agla))
                {
                     temp=agla->next;
                     agla->next=j;
                     prev->next=agla;
                     prev=agla;
                     agla=j->next;
                     j->next=temp;
                }
                else{
                     prev=j;
                     j=agla;
                     agla=j->next;}
                }
                prev=i;
                i=i->next;
           }
      }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T12:56:29.897

您绝对导致程序崩溃的第一个明显错误是：

```
 while(agla!=NULL)
       {
            temp=NULL;temp->next=NULL; 
```

您将变量设置为`NULL`，然后设置其字段。空指针不指向任何地方，因此您无法编辑其内容。

消除`temp->next=NULL;`

* * *

## 编辑：

你的程序逻辑不正确。在循环的几次迭代之后，您破坏了列表，并且程序陷入了一个带有混合指针的无限循环。

在冒泡排序中，我们多次遍历项目。在每次迭代中，最大的项目会冒泡到列表的末尾。在第一次迭代之后，我们确定最大的元素在列表的末尾。在第二次迭代之后，我们确定第二大元素在列表的最后一个元素之前，依此类推。
您重复此过程，直到所有项目都在其位置：

```
int getListSize(Node* start)
{
    int count = 0;
    while(start != NULL)
    {
        count++;
        start = start->next;
    }
    return count;
}

void bubbleSort(Node *&start) // <-- Pass a reference to pointer, because we may need to modify the start pointer.
{
    int size = getListSize(start);
    int i = 0;

    while(size--)
    {
        Node
            *current = start,
            *prev = NULL; // We are at the beginnig, so there is no previous node.

        while(current->next != NULL) // We have at least one node (size > 0) so `current` itself is not NULL.
        {
            Node *after = current->next;
            if((*current) > (*after))
            {
                //swap the items
                current->next = after->next;
                after->next = current;
                if (prev == NULL) // we are at the beginning
                    start = after;
                else
                    prev->next = after;

                prev = after;
            }
            else
            {
                prev = current;
                current = current->next;
            }
        }
    }
} 
```

我们重复“冒泡”过程`size`时间。这不是最有效的方法，因为我们甚至会比较已经排序的项目。一种更有效的方法是排序直到没有新的交换发生：

```
void bubbleSort(Node *&start) // <-- Pass a reference to pointer, because we may need to modify the start pointer.
{
    int size = getListSize(start);
    int i = 0;

    Node *lastSwapped = NULL;

    while(size--)
    {
        Node
            *current = start,
            *prev = NULL, // We are at the beginnig, so there is no previous node.
            *currentSwapped = NULL;

        while(current->next != lastSwapped) // We have at least one node (size > 0) so `current` itself is not NULL.
        {
            Node *after = current->next;
            if((*current) > (*after))
            {
                //swap the items
                current->next = after->next;
                after->next = current;
                if (prev == NULL) // we are at the beginning
                    start = after;
                else
                    prev->next = after;

                prev = after;
                currentSwapped = current;
            }
            else
            {
                prev = current;
                current = current->next;
            }
        }

        if (currentSwapped == NULL)
            break; // No swapping occured. The items are sorted.
        else
            lastSwapped = currentSwapped;
    }
} 
```

[这是完整的工作程序](https://gist.github.com/4066561)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:55:27.993

您只是通过简单地比较元素`*(j) > *(agla)`，我不确定它是如何构建的，因为两者`j`都是`agla`指向结构的指针。结构不能直接比较。

# bash - 如何使用 awk 和条件管道提交 qsub 作业？

> ID：13361060
> 
> 赞同：0
> 
> 时间：2012-11-13T12:50:29.900
> 
> 标签：bash, awk, pipe, fasta, qsub

我有一个文件（fasta），我正在使用 awk 从（带有标题的序列）中提取所需的字段。然后我通过管道将其传输到 BLAST 程序，最后通过管道将其传输到 qsub 以提交作业。文件：

```
>sequence_1
ACTGACTGACTGACTG
>sequence_2
ACTGGTCAGTCAGTAA
>sequence_3
CCGTTGAGTAGAAGAA 
```

和命令（有效）：

```
awk < fasta.fasta '/^>/ { print $0 } $0 !~ /^>/' | echo "/Local/ncbi-blast-2.2.25+/bin/blastx -db blastdb.fa -outfmt 5 >> /User/blastresult.xml" | qsun -q S 
```

我想做的是添加一个条件，如果它低于某个阈值，则将对我正在运行的作业数量（使用 qstat）进行采样，该作业将被提交。例如：

```
allowed_jobs=200 #for example 
awk < fasta.fasta '/^>/ { print $0 } $0 !~ /^>/' | echo "/Local/ncbi-blast-2.2.25+/bin/blastx -db blastdb.fa -outfmt 5 >> /User/blastresult.xml" | cmd=$(qstat -u User | grep -c ".") | if [ $cmd -lt $allowed_jobs ]; then  qsub -q S 
```

不幸的是（无论如何对我来说）我所有的尝试都失败了。我会很感激任何帮助

编辑：详细说明：我想做的是从fasta文件中提取：

```
>sequene_x
ACTATATATATA 
```

或者基本上： >HEADER\nSEQUENCE 一个接一个，并将其通过管道传输到可以采用标准输入的爆炸程序。我想为每个序列创建一个独特的作业，这就是我想为每个序列管道到 qsub 的原因。说白了，qsub 提交看起来像这样：

```
qsub -q S /Local/ncbi-blast-2.2.25+/bin/blastx -db blastdb.fa -query FASTA_SEQUENCE -outfmt 5 >> /User/blastresult.xml 
```

请注意，如果标准输入序列通过管道传递给它，则 -query 标志是不必要的。但是，对我来说主要的问题是如何结合我上面提到的条件，以便仅当 qstat 结果低于阈值时，序列才会被传送到 qsub。理想情况下，如果 qstat 结果高于阈值，它将休眠直到 i 低于阈值，然后将其向前传递。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T02:59:28.667

您好，我想这已经很久了。

我将提供一种解决此问题的方法，通过在将其传递给 awk 之前计算应处理的行（序列），awk 片段将在**echo time 工作**的地方进行。

```
#!/bin/bash
ct=`grep -c '^>' fasta.fasta`
if [ $ct -lt 201 ] ; then 
    echo time to work
else
    echo too much
fi 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T19:57:03.230

这段 shell 读取两行，将它们打印到 stdout 并通过管道输入您的 qsub 命令

```
while IFS= read -r header; do
    IFS= read -r sequence
    printf "%s\n" "$header" "$sequence" | 
    qsub -q S /Local/ncbi-blast-2.2.25+/bin/blastx -db blastdb.fa -outfmt 5 >> /User/blastresult.xml
done < fasta.fasta 
```

# css - 谷歌浏览器 - Mac 和 PC 之间的差异

> ID：13361064
> 
> 赞同：8
> 
> 时间：2012-11-13T12:50:43.403
> 
> 标签：css, windows, macos, google-chrome

我正在为客户开发一个网站，并且我已经在 Windows 上的主要浏览器上对其进行了测试。

现在我面临 Chrome Win 和 Chrome Mac（相同版本）之间的一些小差异。这些确实是次要的事情，但是客户发现了它们，所以我想知道..我可以通过 css 进行一些重置以使两个版本尽可能相似？

我想我必须使用浏览器默认的 -webkit 前缀，你知道有什么好的演练吗？

我的意思是：我可以使用一些基本的 .css 来重置 Chrome 并强制它呈现尽可能相似的内容，甚至跨平台？

谢谢！

**更新**：我提到的差异主要涉及字体大小、字母间距以及与元素的高度和行高相关的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T13:09:03.750

您遇到的是默认浏览器 CSS 定义。在启动项目时重置或规范化 CSS 总是一个好主意，以便所有浏览器对基本元素的行为方式相同。

[http://meyerweb.com/eric/tools/css/reset/](http://meyerweb.com/eric/tools/css/reset/) <<重置。将所有常见的 CSS 设置为 0。这可能很难使用，因为它意味着对您想要使用的每个元素进行样式设置。即列表不再有任何默认填充或列表样式。

[http://necolas.github.com/normalize.css/](http://necolas.github.com/normalize.css/) << Normalize 为您提供了一些默认设置，但仍试图将所有现代浏览器带到相同的起点。

当涉及到前缀时，实际上只有一些 CSS 属性使用它们。这里有一个很好的解释：[http ://webdesign.about.com/od/css/a/css-vendor-prefixes.htm](http://webdesign.about.com/od/css/a/css-vendor-prefixes.htm)

哪些浏览器使用哪个前缀的列表：

*   安卓：-webkit-
*   铬：-webkit-
*   火狐：-moz-
*   Internet Explorer：-ms-
*   iOS：-webkit-
*   歌剧：-o-
*   Safari：-webkit-

还要记住，对于使用过滤器的旧版本的 IE，一些 CSS 属性需要以不同的方式定义。不透明度就是其中之一。

# html - 自动调整 div 元素的大小

> ID：13361065
> 
> 赞同：1
> 
> 时间：2012-11-13T12:50:52.660
> 
> 标签：html, css

我想知道有人可以帮我处理一件小事。我从事个人项目，但无法正确解决一件事。

这是 JSBin [http://jsbin.com/inixuf/1/edit](http://jsbin.com/inixuf/1/edit)

问题出在图像中，如果屏幕小于 21 英寸并且说是 15.3 英寸，它将每行仅显示 3 个图像，而在 21 英寸上它将每行显示 4 个图像，并且随着您变大，它将显示越来越多。这不是我想要的，我不想要一个可以强制重新调整图像 div 类大小的脚本，以确保无论你是什么屏幕，每行总是会得到 4 个图像。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T12:55:33.613

使用 % 设置宽度。

所以一张图片的宽度是：div 宽度的 20%，图片两边的边距为 2.5%。这样你就可以很好地填充 100%。

.imagecontainer { 宽度：20%; 左边距：2.5%；边距：2.5%；}

然后让所有尺寸都是相对的

# javascript - 如何在 express js 中访问使用 app.set() 设置的变量

> ID：13361072
> 
> 赞同：25
> 
> 时间：2012-11-13T12:51:41.637
> 
> 标签：javascript, node.js, express

我如何访问使用 express 设置的变量`app.set()`，例如

```
 app.set('view engine','jade');
app.set('jsDirectory',/js/'); 

```

从指南中，我了解到我可以使用 访问相同的`app.get(<key>)`内容，但这是`console.log(app.get('view engine'))`.

```
{ 路由器：
   { 应用程序：
      {堆栈：[对象]，
        域：空，
        _events：[对象]，
        _maxListeners: 10,
        _连接：0，
        连接：[Getter/Setter]，
        allowHalfOpen：真，
        _句柄：空，
        httpAllowHalfOpen：假，
        缓存：{}，
        设置：[对象]，
        重定向：{}，
        isCallbacks: {},
        _locals：[对象]，
        动态视图助手：{}，
        错误处理程序：[]，
        路线： '/'，
        路线：[循环]，
        路由器：[Getter]，
        root: 'C:\\Users\\Shahal\\Works\\App',
        楷模： {}，
        扩展：{}，
        disconnectSchemas：[功能：disconnectSchemas]，
        护照：[对象]}，
     路线：{}，
     参数：{}，
     _params：[]，
     中间件：[功能] } }

```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2012-11-13T18:38:39.423

它们通过 app.settings 对象变得可用：

```
app.set('oneSetting', 'one');
app.set('twoSetting', 'two');
app.set('view engine','jade');

console.log(app.settings.oneSetting);
console.log(app.settings.twoSetting);
console.log(app.settings['view engine']); 
```

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-05-06T14:56:56.553

我知道这是 2 岁，但它仍然是谷歌上弹出的第一个链接，所以我认为这可能是合适的。

你也可以这样设置你的变量

```
 app.set('port', 3000); 
```

后来得到它

```
 app.get('port'); 
```

我更喜欢这种方法，因为它更短，更直接。这也是他们在[Express 4.x 文档](http://expressjs.com/api.html#app.get)中使用的方式。

```
 app.get(name)
    Returns the value of name app setting, where name is one of strings in the app settings table. 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2017-11-13T04:56:10.983

```
app.set('view engine','hbs')
**All are correct:**
app.get('view engine')
app.locals.settings['view engine']
app.settings['view engine'] 
```

# scala - 避免 Java MPI 绑定中的命名空间冲突

> ID：13361074
> 
> 赞同：3
> 
> 时间：2012-11-13T12:51:48.260
> 
> 标签：scala, namespaces, mpj-express, name-clash

我正在为我当前的项目使用 MPJ-api。我使用的两个实现是 MPJ-express 和 Fast-MPJ。但是，由于它们都实现了相同的 API，即 MPJ-API，由于名称空间冲突，我无法同时支持这两种实现。

有没有办法用相同的包和类名包装两个不同的库，以便在 Java 或 Scala 中同时支持两者？

到目前为止，我能想到的唯一方法是将模块移动到单独的项目中，但我不确定这是否可行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:17:13.777

如果您的代码仅使用 MPI 函数的子集（就像我审查过的大多数 MPI 代码一样），您可以编写一个抽象层（特征甚至 Cake-Pattern）来定义您实际使用的操作。然后，您可以为每个实现实现一个具体的适配器。

这种方法也适用于非 MPI 通信层（想想 Akka、JGroups 等）

作为奖励，您可以使用 SLF4J 方法：在运行时根据类路径中的实际内容选择正确的实现。

# php - 使用 Grid 和 _prepareCollection 的 Magento 管理模块：遍历集合会使排序失败

> ID：13361088
> 
> 赞同：1
> 
> 时间：2012-11-13T12:52:31.590
> 
> 标签：php, magento-1.7, magento

我制作了一个反映 CMS->Page 的小型管理模块。我的管理页面块使用的代码`app\code\core\Mage\Adminhtml\Block\Catalog\Product\Grid.php`为我提供了一个网格，我可以像在原始 CMS->Page 部分中一样对它进行排序和过滤。

这是我的管理页面块中的代码：

```
protected function _prepareCollection()
    {
        $collection = Mage::getModel('cms/page')->getCollection();
        $collection->setFirstStoreFlag(true);
        $this->setCollection($collection);
        return parent::_prepareCollection();
    } 
```

正如我所提到的，它显示并允许正确排序。

但是，当我尝试通过修改上述内容来修改行中的数据时：

```
protected function _prepareCollection()
    {
        $collection = Mage::getModel('cms/page')->getCollection();
        $collection->setFirstStoreFlag(true);

        foreach ($collection as $order) {
            $order->setData( 'title', 'Hello world' );    
        } 

        $this->setCollection($collection);
        return parent::_prepareCollection();
    } 
```

我无法再排序或过滤。任何人都可以了解正在发生的事情以及我是否有正确的方法来更改行数据？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:44:20.857

发生了什么：正在加载您的收藏。`foreach`语言构造会触发您的`load`集合方法，它会从数据库中提取数据并填充`items`.

为什么你的排序不起作用？因为在您已经加载它之后，排序将应用于集合。这意味着这些项目已经以默认排序顺序存在于您的集合中。

你应该怎么做你的事？现在我不知道你想用那个`setData`方法对每个集合项目完成什么。如果您要在创建列时使用它，只需在列中添加字符串值。

```
...->addColumn('title', array('default' => 'Hello world')) 
```

如果您想提取集合中存在的更多数据，您也不需要加载它，只需使用集合方法 `addAttributeToSelect`（如果它是 EAV 实体）或`addFieldToFilter`.

# html - HTML/CSS 列表样式帮助 :S

> ID：13361090
> 
> 赞同：-1
> 
> 时间：2012-11-13T12:52:42.697
> 
> 标签：html, css, list, styles

我制作了一个列表并使用 ul 标签添加了一个 id，但我似乎无法让我的列表设置样式的唯一方法是实际设置 ul 和 li 标签的样式，但如果我这样做，我的所有列表看起来都一样。如果你不明白这里的代码 -

```
 <ul id="navigation">
                <li><a href="http://www.google.com">Home</a></li>
                <li>Premium</li>
                <li>FAQ</li>
                <li>Disclaimer</li>
            </ul>
            <ul id="login">
                <li>Login</li>
                <li>-</li>
                <li>Register</li>
            </ul> 
```

但是我不希望这两个列表的样式都以我希望它们不同的方式进行设置，而使样式生效的唯一方法是-

```
#navigation{
color:#808080;
float:left;
margin-top:50px;
font-family:"Myriad Pro", Times, serif;
}

#login{
color:#808080;
float:right;
margin-top:50px;
font-family:"Myriad Pro", Times, serif;
}

ul li{
display:inline;
text-decoration:none;
padding:15px;
 } 
```

所以我的问题是我如何将填充 15px 应用于导航列表而不是登录列表我尝试将它放在导航 css 代码中但它什么也没做:(

谢谢！！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:55:25.830

试试这样：

```
#navigation li {
   ... your styles
}

#login li {
   ... your different styles
} 
```

您还可以先设置默认的 li 样式，然后在#navigation 中为 li 覆盖/添加它们，如下所示：

```
li {
   ... default styles
}

#navigation li {
   ... styles for navigation list, on top of the default ones
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:00:59.163

最好的方法是先放置通用样式，然后是更具体的样式

```
ul li {
  display:inline;
  text-decoration:none;
}

#navigation, #login {
  color:#808080;
  margin-top:50px;
  font-family:"Myriad Pro", Times, serif;
}

#navigation {
  float:left;
}

#login{
  float:right;
}

#navigation li {
  padding:15px;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:57:51.793

您需要使用 css 后代选择器 - [http://www.w3.org/TR/CSS2/selector.html#descendant-selectors](http://www.w3.org/TR/CSS2/selector.html#descendant-selectors)：

```
#navigation li{
    display:inline;
    text-decoration:none;
    padding:15px;
}

#login li{
    display:inline;
    text-decoration:none;
} 
```

# c++ - 结构字段上的智能指针

> ID：13361092
> 
> 赞同：2
> 
> 时间：2012-11-13T12:53:11.370
> 
> 标签：c++, boost

我已经读过，一个不能存储`std::auto_ptr`，`std::vector`可以`boost::ptr_vector`代替使用。我已经能够这样做，但是`ptr_vector`当我不想存储指针时，我不知道如何使用，而是存储一个具有指针成员的结构。

在此示例中，我想打开一些文件并将关联的`ofstream`对象与一些附加数据一起存储，以供以后使用。我想用智能指针替换`file`字段。`struct data`由于`vector<data> v`应该是所有者，我认为 a`shared_ptr`会起作用，但不合适。

我应该用什么替换裸指针`file`？

```
#include <iostream>
#include <fstream>
#include <vector>

struct data {
  std::string filename;
  std::ofstream* file;

  data(const std::string filename, std::ofstream* file)
    : filename(filename), file(file)
  {
  }
};

std::vector<data> open_files()
{
  std::vector<data> v;
  v.push_back(data("foo", new std::ofstream("foo")));
  return v;
}

int main()
{
  std::vector<data> v = open_files();

  /* use the files */
  *(v[0].file) << "foo";

  delete v[0].file;  // either rely on dtor to close(), or call it manually
} 
```

**更新：** 我觉得我在描述我的问题方面做得不够好，让我试试另一个例子。我也在寻找 C++03 解决方案：

```
#include <memory>
#include <vector>
#include <boost/ptr_container/ptr_vector.hpp>

struct T {
  std::auto_ptr<int> a;
};

int main()
{
  // instead of
  // std::vector<std::auto_ptr<int> > v;
  // use
  boost::ptr_vector<int> v;

  // what to use instead of
  // std::vector<T> w;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:20:30.507

关于您的数据类，我建议使用`std::unique_ptr<std::ofstream>`. 这不是为了让您免于意外的内存泄漏，因为您正在删除构造函数中的指针，而是为了*使所有权明确*。您的代码的用户必须知道`data`它在构造函数中使用的指针在做什么：

```
std::ofstream ofs;
{
   data d1("crash", &ofs);
} // error! d1 will attempt to delete stack allocated object

std::ofstream* pOfs = new std::ofstream(....);
data d2("crash again", pOfs);
delete pOFs; // user thinks data makes a deep copy 
```

但是，`unique_ptr`意图很明确，因此更难出错：

```
data d3("OK", std::unique_ptr<std::ofstream>(new std::ofstream(....)));

std::unique_ptr<std::ofstream> pOfs2(new std::ofstream(....));
data d4("OK", pOfs2); // safe, pOfs's contents have been safely moved

// we can check pOfs2 after the move
if (pOfs2) { /*  */ } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T12:55:50.880

您可以在析构函数中删除指针：

```
struct data 
{
  std::string filename;
  std::ofstream* file;

  data(const std::string filename, std::ofstream* file)
    : filename(filename), file(file)
  {
  }
  ~data()
  {
     delete file;
  }
}; 
```

或用于`std::unique_ptr`包装该指针，但在您的情况下它是不必要的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:58:55.517

您不需要拥有 ofstream* 作为成员。

```
#include <iostream>
#include <fstream>
#include <vector>

struct data {
  std::string filename;
  data(const std::string filename) : filename(filename)
  {}
};

std::vector<data> open_files()
{
  std::vector<data> v;
  v.push_back(data("foo"));
  return v;
} 
```

如果要附加到文件，请指定应用程序文件模式。

```
void print_files(const std::vector<data>& v)
{
    for(std::vector<data>::const_iterator it = v.begin(); it != v.end(); ++it)
    {
        std::ofstream os(it->filename, std::ostream::app);
        os << "bar";
    }
}

int main()
{
  std::vector<data> v = open_files();

    print_files(v);
} 
```

# php - 我想使用 htaccess 或 php 将旧 url 重定向到新的重写 url

> ID：13361097
> 
> 赞同：1
> 
> 时间：2012-11-13T12:54:08.560
> 
> 标签：php, .htaccess, url, redirect, rewrite

我有一个问题，因为我使用重写 url..

我的旧网址： `Website.com/index.php?act=appdetail&appid=oWV`

新的重写 URL `http://website.com/angry_birds_rio-appdetail-oWVi.html`

但是我所有的旧网址都在谷歌中编入索引，如果有人访问我的网站，它会显示旧网址，谷歌也会索引新网址。它在网站问题上制作重复页面。

让我知道解决方案

我的重写 URL htaccess

> 重写引擎开启
> 
> RewriteRule ^([^-] *)-([^-]* )-([^-] *)-([^-]* )-([^-]*).html$ index.php?appanme=$1&act=$2 &appid=$3&page=$4&cat=$5 [L]
> 
> RewriteRule ^([^-] *)-([^-]* )-([^-] *)-([^-]* )-([^-] *)-([^-]* ).html$ index.php? appanme=$1&act=$2&appid=$3&page=$4&cat=$5&sString=$5 [L]
> 
> RewriteRule ^([^-] *)-([^-]* )-([^-]*).html$ index.php?appanme=$1&act=$2&appid=$3[L]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:14:22.287

这是您的 .htaccess 文件：

```
RewriteEngine on
RewriteRule ^/index.php?act=appdetail&appid=oWV$ http://website.com/angry_birds_rio-appdetail-oWVi.html [R=301,L] 
```

您需要告知网络爬虫有关重定向的信息，您可以使用 301 代码进行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-15T11:57:42.837

似乎规则是基于 .htaccess 的；如果存在一组 CGI 参数，您需要一组额外的规则来永久重定向 (301) BROWSER/CRAWLER 对 index.php 页面的请求到适当的别名，这将在几周内整理 Google。然后你上面的规则，例如

```
RewriteEngine On
RewriteBase /

#Permanently redirect BROWSER requests for the index.php?xxx to the appropriate page alias:
RewriteCond %{THE_REQUEST}      /index.php     [NC]
RewriteCond %{QUERY_STRING}     ^appanme=([^&]+)&act=([^&]+)&appid=([^&]+)&page=([^&]+)&cat=([^&]+)&sString=([^&]+)  [NC]
RewriteRule ^.*                 http://%{HTTP_HOST}/%1-%2-%3-%4-%5-%6.html [R=301,L]

RewriteCond %{THE_REQUEST}      /index.php     [NC]
RewriteCond %{QUERY_STRING}     ^appanme=([^&]+)&act=([^&]+)&appid=([^&]+)&page=([^&]+)&cat=([^&]+)  [NC]
RewriteRule ^.*                 http://%{HTTP_HOST}/%1-%2-%3-%4-%5.html   [R=301,L]

RewriteCond %{THE_REQUEST}      /index.php     [NC]
RewriteCond %{QUERY_STRING}     ^appanme=([^&]+)&act=([^&]+)&appid=([^&]+)  [NC]
RewriteRule ^.*                 http://%{HTTP_HOST}/%1-%2-%3.html   [R=301,L]

# Followed by: YOUR RULES FROM ABOVE 
```

**注意**：

1）您的第二条规则中似乎有错字： sString=$6 NOT sString=$5

2）如果您不清楚上述规则的作用，或者如果您想要更抽象的东西，请考虑以下[帖子](http://www.experts-exchange.com/A_4043.html)，Apache [mod_rewrite](http://httpd.apache.org/docs/current/mod/mod_rewrite.html)文档值得一读。

# lighttpd - Lighttpd：让子路径指向不同的文档根

> ID：13361099
> 
> 赞同：8
> 
> 时间：2012-11-13T12:54:24.540
> 
> 标签：lighttpd, subdirectory, document-root

我有一个指向 document-root 的 lighttpd-Setup `/var/www`。但是，我希望 URL`other/`指向`/some/other/dir`. 我正在使用以下配置进行此操作：

```
$HTTP["url"] =~ "^/other($|/)" {
  server.document-root = "/some/other/dir"
} 
```

但是，如果我访问“http://myhost/other”，lighttpd 会尝试访问`/some/other/dir/other`而不是仅访问`/some/other/dir`. 是否有可能以某种方式剥离`/other`但保留任何进一步的 URL 段？因此，例如，`http://myhost/other/sub/foo.txt`应该指向`/some/other/dir/sub/foo.txt`.

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-07-06T13:15:32.520

而不是尝试 set `server.document-root`，您可以使用`mod_alias`来实现此目的：

```
server.modules = ( ..., "mod_alias" )

...

alias.url = ( "/other/" => "/some/other/dir/" ) 
```

这将创建一个别名，以便该文件夹内的所有请求`/other/`和资源都将重定向到`/some/other/dir/`文件系统上，并且请求直接`/other/`指向 的根目录`/some/other/dir/`，就像您想要的那样。

# c# - taglib-sharp 中是否有与 Label/Publisher 等效的字段？

> ID：13361102
> 
> 赞同：3
> 
> 时间：2012-11-13T12:54:32.147
> 
> 标签：c#, .net, id3, taglib-sharp

我正在尝试使用 Taglib-sharp 更新标签/发布者字段，但使用对象浏览器在其对象层次结构中的任何地方都看不到它。

我搜索了谷歌和文档，看起来这是一个不适合的领域。

在我寻找可以编辑这些字段的替代方案（任何人都可以提出任何建议？）之前，我想我会最后一次破解并在 StackOverflow 社区中询问熟悉 TagLib-sharp 的人是否有更明智的意见？

提前致谢，

弗朗西斯

更新：我调查了其他库，例如 mpg123 和 UltraID3Lib，但它们似乎有相同的限制。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-06-29T19:03:36.393

好吧，丹尼尔福克斯的回答对我不起作用。但是，这只是一个开始。

在 TagLib-sharp 代码中添加字段的步骤是：

1.  下载[源](https://github.com/mono/taglib-sharp)

2.  打开文件**TagLib/Tag.cs**​​ 并插入以下代码*（我将其插入到 PerformersSort 下方，第 250 行）*：

    ```
    public virtual string Publisher
    {
        get { return ""; }
        set { }
    } 
    ```

3.  打开文件**TagLib/Id3v2/Tag.cs**​​ 并插入以下代码*（我将其插入到 PerformersSort 下方，第 1292 行）*：

    ```
    public override string Publisher
    {
        get { return GetTextAsString(FrameType.TPUB); }
        set { SetTextFrame(FrameType.TPUB, value); }
    } 
    ```

4.  打开文件**TagLib/Id3v2/FrameTypes.cs**并插入以下代码*（我将其插入到 TPOS 下方，第 71 行）*：

    ```
    public static readonly ReadOnlyByteVector TPUB = "TPUB"; 
    ```

5.  现在是“啊哈”的事情。打开文件**TagLib/CombinedTag.cs**​​ 并插入以下代码*（我将其插入到 PerformersSort 下方，第 318 行）*：

    ```
    public override string Publisher
    {
        get
        {
            foreach (Tag tag in tags)
            {
                if (tag == null)
                    continue;

                string value = tag.Publisher;

                if (value != null)
                    return value;
            }

            return null;
        }

        set
        {
            foreach (Tag tag in tags)
                if (tag != null)
                    tag.Publisher = value;
        }
    } 
    ```

6.  最后，编译代码。

**重要提示**：我在编译代码时也遇到了问题。您必须下载[SharpZipLib dll](http://icsharpcode.github.io/SharpZipLib/) (.NET 2.0) 并将此 dll 包含在 taglib 项目中。另外，我需要安装我用 Nuget 制作的 NUnit。最后，我在测试代码中注释了 GDK 库及其所有错误，因为在生产中不会使用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-05T11:03:55.423

那么 TagLib# 无法读取发布者标签。即使是目前的最新版本（2.1.0.0）也无法做到这一点。作为替代方案，您可以使用免费提供的 TagLib# 的源代码自己添加此功能。

为此，请打开文件**TagLib/Id3v2/FrameTypes.cs**并在某处添加以下行：

```
public static readonly ReadOnlyByteVector TPUB = "TPUB";  // Publisher field 
```

在文件**TagLib/Id3v2/Tag.cs​​ 中**：

```
public string Publisher {
    get {return GetTextAsString (FrameType.TPUB);}
    set {SetTextFrame (FrameType.TPUB, value);}
} 
```

然后，您可以使用类似这样的方式访问 Publisher 字段

```
TagLib.File tf = TagLib.File.Create(...);   // open file
tf.Tag.Publisher = "Label XY";              // write new Publisher
tf.Save();                                  // save tags 
```

请注意，这是一个丑陋的 hack，但适用于 MP3 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T14:48:41.490

我不习惯 TagLib#，但我在 Qt 项目中使用 TagLib，我在其中检索此信息检查`TagLib::File::properties`. 看一下文档，它只是一个包含每个属性和值的字符串映射。

希望 TagLib# 有这个方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-12-30T00:39:04.173

2019 年 12 月 30 日更新：

看起来主要的[taglib](https://github.com/mono/taglib-sharp)项目已经包含了 publisher 字段，所以你应该只使用最新版本。我已经从我的 fork 更新到最新的 TagLib，并且可以证明它按预期工作。

提示：如果您想更改 TagLib 编译到的框架版本（在编写时默认为 462 和 .NET STD 2.0），您需要更改位于 Solutions 文件夹中的 Directory.Build.Props 文件。

```
<Project>
<PropertyGroup>
    <ReleaseVersion>2.2.0.0-beta</ReleaseVersion>
    <RepositoryUrl>https://github.com/mono/taglib-sharp</RepositoryUrl>
    <RepositoryType>git</RepositoryType>
    <TaglibSharpTargetFramework>net472;netstandard2.0</TaglibSharpTargetFramework>
    <LangVersion>latest</LangVersion>
</PropertyGroup>
</Project> 
```

我在上面粘贴了我的版本，这表明我已将其更改为编译为 .NET 4.7.2。

# c# - 如何在沙箱中执行 3rd 方代码

> ID：13361103
> 
> 赞同：2
> 
> 时间：2012-11-13T12:54:32.057
> 
> 标签：c#, asp.net

> **可能重复：**
> [在 .NET 4.0 中，如何“沙箱化”内存中的程序集并执行方法？](https://stackoverflow.com/questions/5997995/in-net-4-0-how-do-i-sandbox-an-in-memory-assembly-and-execute-a-method)

场景如下。我想要一个视图，用户可以在其中放入一些可以组成 ac# 类的东西：

```
public class my3rdpartyclass
{
   public void withOneMethod()
   {

   }
} 
```

我想即时编译它，我猜这不是难点。但是我如何保护我的系统，例如 withOneMethod 中的第 3 方代码不能运行任何可能损坏我的系统或从 web.config 或系统信息访问属性的东西。

这样的事情可能吗？

# objective-c - IOS中的即时/自动保存

> ID：13361108
> 
> 赞同：2
> 
> 时间：2012-11-13T12:55:00.310
> 
> 标签：objective-c, ios, uitableview, uitextfield, modal-dialog

背景：在我的日常工作中，我是一名 Windows 自动化和数据翻译“专家”（或者他们这么说*） 。*自从我在 2004 年购买了我的第一台 Mac 以来，我一直在不断地涉足 Objective-C 编码。

我正在开发一个 IOS 应用程序。我的数据容器类知道如何从磁盘保存和加载，每个对象都响应`-(void)saveToImpliedFilename{}`or的实例方法`-(void)save:(NSString *)filename {}`。有一个静态调用可以从存储中加载数据文件并从中创建不同的数据对象（它们是相当轻量级的对象，所以我不担心一次加载几个）。该应用程序的域如此之大，以至于其中许多都不会一次加载。

```
+(NSArray *)loadData {} 
```

这一切都很好，很棒。在存储中，对象以 Xml 形式存储，并且寿命很好。

我遇到麻烦的地方是尝试修改教程时，我会发生两件事：

*快速说明：我将本教程用作 POC 编码的基础，然后我将返回并从“真实”编码重新开始，重用我的数据对象和我在此过程中构建的一些其他实用程序。*

这是我的目标和问题清单：

1.  我希望表格视图告诉数据对象在几乎每个“编辑”事件中保存。我唯一能一直工作的就是重新组织桌子的顺序。（保存按钮和添加新条目工作正常）

2.  在列表中输入一个新条目会创建一个漂亮的模态编辑器，其中包含一个保存和取消按钮，效果非常好。但是，如果我编辑现有条目，则无法重现保存按钮的行为。每次我尝试时，按钮的事件都不再触发。我不知道我哪里错了。

我使用本教程系列中的“可编辑表视图”项目作为我的基础：[http ://www.aboutobjects.com/community/iphone_development_tutorial/tutorial.html](http://www.aboutobjects.com/community/iphone_development_tutorial/tutorial.html)

在下面的代码中，[self isModal] 测试是让保存/取消按钮可见并连接起来的地方。调出新条目屏幕显然是它唯一的模态。我尝试将这些东西连接起来，以便始终创建按钮，但同样，事件永远不会为任何一个触发。下面的下一个块是使用 NEW 功能显式调用可编辑表视图的地方，但同一表视图的非模态视图由选择器表上的选择事件调用。

所以...

```
// code snipped for the new/modal editor

- (void)viewDidLoad {
    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;

    //  If the user clicked the '+' button in the list view, we're
    //  creating a new entry rather than modifying an existing one, so
    //  we're in a modal nav controller. Modal nav controllers don't add
    //  a back button to the nav bar; instead we'll add Save and
    //  Cancel buttons.
    //
    if ([self isModal]) {
        UIBarButtonItem *saveButton = [[UIBarButtonItem alloc]
                                       initWithBarButtonSystemItem:UIBarButtonSystemItemSave
                                       target:self
                                       action:@selector(save)];

        [[self navigationItem] setRightBarButtonItem:saveButton];

        UIBarButtonItem *cancelButton = [[UIBarButtonItem alloc]
                                         initWithBarButtonSystemItem:UIBarButtonSystemItemCancel
                                         target:self
                                         action:@selector(cancel)];

        [[self navigationItem] setLeftBarButtonItem:cancelButton];
    }
    // do stuff here to display my object...    

}

// this code is called from the selection table to explicitly add a new data object. 

- (void)add {

    vhAddVehicleViewController *controller = [[vhAddVehicleViewController alloc] initWithStyle:UITableViewStyleGrouped];

    id vehicle = [[Vehicle alloc] init];
    [controller setVehicle:vehicle];
    [controller setListcontroller:self];

    UINavigationController *newNavController = [[UINavigationController alloc] initWithRootViewController:controller];

    [[self navigationController] presentViewController:newNavController animated:YES completion:nil];

}

// this is where it's called on the table selection to show the same view without the save/cancel buttons.

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath {
    vhAddVehicleViewController *controller = [[vhAddVehicleViewController alloc] initWithStyle:UITableViewStyleGrouped];

    NSUInteger index = [indexPath row];
    id vehicle = [[self vehicles] objectAtIndex:index];

    [controller setVehicle:vehicle];
    [controller setTitle:[vehicle Vehiclename]];

    [[self navigationController] pushViewController:controller animated:YES];
} 
```

我假设问题是呈现它会使其成为模态，而推动它不会......？没关系。但是当我对模态进行测试以尝试使按钮保持工作时，我感到很高兴。按钮在点击时绘制并单击，但事件不会触发。

停！：-） 非常感谢。-- Chris（我使用我的 Google 帐户登录，所以在页面顶部我显示为“user1820796”）*耸了耸肩*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T15:34:22.743

我仍然认为这与推送/弹出视图而不是呈现视图有关。我将其全部切换为演示文稿，它现在按我想要的方式工作。

谢谢各位帮忙。与我在 GUI 上所习惯的范式完全不同，但我已经到了那里。

谢谢！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:37:49.703

你忘了打电话`[super viewDidLoad];`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:13:29.233

**更新**

*尝试在按下*视图控制器时移除左侧的取消按钮。看看保存是否开始工作。我认为问题是当视图控制器被按下时你不应该向导航栏添加左按钮。

您使用的是哪种方法签名？

```
- (void)save
{
    NSLog(@"Saving");
} 
```

或者

```
- (void)save:(id)sender
{
    NSLog(@"Saving");
} 
```

# android - 相对布局 toLeftOf

> ID：13361111
> 
> 赞同：1
> 
> 时间：2012-11-13T12:55:07.717
> 
> 标签：android, android-layout, android-relativelayout

我在 LinearLayout 中有一个 RelativeLayout，用于显示一些数据：

```
<LinearLayout
    android:id="@+id/linearLayout4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginRight="3dp"
    android:layout_marginTop="3dp"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="3dp"
        android:ellipsize="end"
        android:maxLines="1"
        android:textSize="16dp"
        android:textStyle="bold" />

    <RelativeLayout
        android:layout_width="wrap_content"
        android:layout_height="wrap_content" >

        <TextView
            android:id="@+id/time"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:gravity="center_vertical"
            android:singleLine="true" />

        <ImageView
            android:id="@+id/uhr"
            android:layout_width="20dp"
            android:layout_height="20dp"
            android:layout_gravity="left"
            android:layout_marginLeft="2dp"
            android:layout_toRightOf="@id/time"
            android:src="@drawable/event_clock" />
    </RelativeLayout>

    <TextView
        android:id="@+id/description"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_marginLeft="3dp"
        android:autoLink="web|email"
        android:textSize="14dp" />
</LinearLayout> 
```

问题是我希望我的 ImageView 位于左侧，而 TextView 位于其旁边。但是，如果我更改`android:layout_toRightOf="@id/time"`为`android:layout_toLeftOf="@id/time"`它仅显示 TextView 但 ImageView 消失。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:01:45.137

只需将其`layout_toRightOf`放在 TextView 上即可：

```
<RelativeLayout
    android:layout_width="wrap_content"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/time"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_toRightOf="@+id/uhr"
        android:gravity="center_vertical"
        android:singleLine="true" />

    <ImageView
        android:id="@+id/uhr"
        android:layout_width="20dp"
        android:layout_height="20dp"
        android:layout_gravity="left"
        android:layout_marginLeft="2dp"
        android:src="@drawable/event_clock" />
</RelativeLayout> 
```

# javascript - float:right 使用 css - 必须有一个简单的方法来做到这一点

> ID：13361118
> 
> 赞同：0
> 
> 时间：2012-11-13T12:55:28.617
> 
> 标签：javascript, html, css, css-float

我有一些文本要在其后显示一个“V”并浮动到右侧。文本是电压（因此是 V）。它有一个`id`并且是用 JavaScript 计算的。

我敢肯定有一种巧妙的方法可以做到这一点，但我缺乏经验，而且事情过于复杂，而且一无所获！

我试过这个：

```
<h3><span id="voltsSensor2"; style="float:right" >2.99</span>V</h3> 
```

但是因为 V 在跨度之外，所以它保持在左侧。

我也尝试过让 h3 标签在 css 中全部浮动，但由于某种原因，它会将文本放在 div 区域之外，该区域是一个带有边框的框，如我的 css 中定义的那样，如本例所示：

```
<div class="ex">
    <h1 id = nameS1>Sensor 2</h1>
    <h2>Temperature</h2>
    <h3><span id="tempSensor2">18.5</span>&#176C</h3>

    <div style="width:255px; height:13px; background-color:#ddd;">
        <div id ="barTempS2" style="width:60px; height:13px; background-color:#366; border-right:1px white solid;"></div>
    </div>

    <h2>Humidity</h2>
    <h3><span id="humSensor2">55.0</span>%RH</h3>

    <div style="width:255px; height:13px; background-color:#ddd;">
        <div id ="barHumS2" style="width:140px; height:13px; background-color:#366"></div>
    </div>

    <h4><span id="voltsSensor1">2.99</span>V</h4>
    <img src="images/greyCornerRhb.png" width="12" height="12" alt="Sensor Name"; style="float:right">
</div> 
```

我敢肯定有一个更简单的方法。我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T12:59:43.740

您应该只`text-align: right;`在父元素上使用 a 并丢失`float`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T12:58:40.577

尝试这个：

```
<h3 style="float:right"><span id="voltsSensor2">2.99</span>V</h3>
<div style="clear: both"></div> 
```

JSFiddle：http: [//jsfiddle.net/BJPUv/](http://jsfiddle.net/BJPUv/)

div将`clear:both`允许浮动元素的高度，因此它们不会浮出 div。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T12:59:13.927

你可以很容易地做两件事。要么将 V 粘贴在它自己的跨度中，并为两个跨度指定 position:relative 和 float:right 。或者只是将 V 粘贴在数字的范围内。计算完值后，您可以在 js 代码中附加“V”。

# ruby - 数组为空时如何不保存到csv

> ID：13361121
> 
> 赞同：0
> 
> 时间：2012-11-13T12:55:57.913
> 
> 标签：ruby, xpath, csv, nokogiri, conditional

我正在解析一个网站，并且正在寻找潜在的数百万行内容。但是，csv/excel/ods 不允许超过一百万行。

这就是为什么我试图使用临时来排除保存空内容的原因。但是，它不起作用：我的代码不断在 csv 中创建空行。

这是我的代码：

```
# create csv
CSV.open("neverending.csv", "w") do |csv|
csv << ["kuk","date","name"]

# loop through all urls
File.foreach("neverendingurls.txt") do |line|
begin
doorzoekbarefile = Nokogiri::HTML(open(line))
for k in 1..999 do

# PROVISIONARY / CONDITIONAL
unless doorzoekbarefile.at_xpath("//td[contains(style, '60px')])[#{k}]").nil?

# xpaths
kuk = doorzoekbarefile.at_xpath("(//td[contains(@style,'60px')])[#{k}]")
date = doorzoekbarefile.at_xpath("(//td[contains(@style, '60px')])[#{k}]/following-sibling::*[1]")
name = doorzoekbarefile.at_xpath("(//td[contains(@style, '60px')])[#{k}]/following-sibling::*[2]")

# save to csv
csv << [kuk,date,name]

end
end
end

rescue
puts "error bij url #{line}"
end
end
end 
```

任何人都知道出了什么问题或如何解决问题？基本上我只需要更改代码，以便在 xpath 为空时不会创建新的 csv 数据行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:03:02.730

这实际上与 xpath 无关。很简单 Array#empty？

```
row = [kuk,date,name]
csv << row if row.compact.empty? 
```

顺便说一句，你的代码是一团糟。学习如何在再次发布之前至少缩进。

# database - VB .NET 和数据库

> ID：13361122
> 
> 赞同：1
> 
> 时间：2012-11-13T12:56:18.623
> 
> 标签：database, vb.net, ms-access

试图让这段代码输入玩家姓名，将其填写在数据行中，然后在数据库中更新它。它当前在数据行中更新，但我无法正确获取代码来更新数据库。你能帮忙喝彩吗。

```
 Using da As OleDbDataAdapter = New OleDbDataAdapter("SELECT * FROM Team1", con)
            da.Fill(ds, "BPAWA")

            txtFirstName.Text = ds.Tables("BPAWA").Rows(0).Item(1)

            T1P1 = InputBox("Name of Player 1")

            ds.Tables("BPAWA").Rows(0).Item(1) = T1P1

            ds.Tables("BPAWA").AcceptChanges()
            ds.AcceptChanges()

            da.Update(ds, "BPAWA")
            MsgBox("Player 1 Added Successfully")
        End Using 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:23:15.963

您的 OleDbDataAdapter 没有链接到实际命令，您似乎也没有在代码中创建适配器。[在此处查看示例](http://msdn.microsoft.com/en-us/library/system.data.oledb.oledbdataadapter%28v=vs.100%29.aspx)

缺少这样的一行

```
Dim da As OleDbDataAdapter = new OleDbDataAdapter(selectCommand, connection); 
```

所以我可以用这种方式重写你的代码（避免全局变量）

```
Private Sub btnLoad_Click(sender As Object, e As EventArgs) Handles btnLoad.Click
    Dim dbProvider As String = "PROVIDER=microsoft.ace.oledb.12.0;"
    Dim dbSource As String = "Data Source = C:\BP_Table_Project.accdb"
    Dim ds as DataSet = new DataSet()

    Using con As OleDbConnection = new OleDbConnection()
        con.ConnectionString = dbProvider & dbSource
        con.Open()

        MsgBox("Connection With Database Established", 0, "Database Connection")

        Using da as OleDbDataAdapter = new OleDbDataAdapter("SELECT * FROM Team1", con)
            Dim builder As OleDbCommandBuilder = New OleDbCommandBuilder(da)
            da.Fill(ds, "BPAWA")
            ......

            da.Update(ds, "BPAWA")
            MsgBox("Player 1 Added Successfully")
        End Using
        MsgBox("Connection With Database Closed", 0, "Database Connection")
    End Using
End Sub 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-13T13:22:49.510

前`da.Update(ds, "BPAWA")`

添加：

```
ds.Tables("BPAWA").AcceptChanges()
ds.AcceptChanges() 
```

# backbone.js - 如何使用 Alloy（appcelerator）查询（where，inner join）？

> ID：13361124
> 
> 赞同：3
> 
> 时间：2012-11-13T12:56:33.687
> 
> 标签：backbone.js, appcelerator, titanium-alloy

我正在尝试：

```
Application Mobile with Alloy
Titanium SDK version: 2.1.3 (10/02/12 16:16 15997d0)
iPhone Device family: universal
iPhone SDK version: 6.0
iPhone simulated device: iphone
Detected compiler plugin: ti.alloy/1.0 
```

我创建了两个模型：

```
alloy generate model met sql met_id:int libelle:string famille_id:int
alloy generate model famille sql famille_id:int libelle:string 
```

并填写以下数据：

```
var mets = Alloy.createCollection('Met')
var met = Alloy.createModel("Met",{met_id:1,libelle:"Salade de Chèvre Chaud",famille_id:1});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:2,libelle:"Salade de Chèvre Chaud",famille_id:2});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:3,libelle:"Salade de Chèvre Chaud",famille_id:3});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:4,libelle:"Salade de Chèvre Chaud",famille_id:4});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:5,libelle:"Salade de Chèvre Chaud",famille_id:1});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:6,libelle:"Salade de Chèvre Chaud",famille_id:2});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:7,libelle:"Salade de Chèvre Chaud",famille_id:3});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:8,libelle:"Salade de Chèvre Chaud",famille_id:4});mets.add(met);met.save();
var met = Alloy.createModel("Met",{met_id:9,libelle:"Salade de Chèvre Chaud",famille_id:1});mets.add(met);met.save();
var familles = Alloy.createCollection('Famille')
var famille = Alloy.createModel("Met",{famille_id:1,libelle:"famille 1");familles.add(famille);famille.save();
var famille = Alloy.createModel("Met",{famille_id:2,libelle:"famille 2"});familles.add(famille);famille.save();
var famille = Alloy.createModel("Met",{famille_id:3,libelle:"famille 3"});familles.add(famille);famille.save();
var famille = Alloy.createModel("Met",{famille_id:4,libelle:"famille 4"});familles.add(famille);famille.save(); 
```

现在，我想用 famille_id = 1 获取所有“遇见”。

```
var mets = Alloy.createCollection('Met')
mets.where({famille_id:1}). 
```

我的第一个问题是`mets.length = 0`。有人知道为什么吗？第二个是我怎样才能在和`inner join`之间做一个？`met``famille_id`

有关信息，如果我这样做：

```
var mets = Alloy.createCollection('Met')
mets.fetch();
for(var i = 0;i< mets.length;i++)
{
    var args = {
        plat : mets.models[i].attributes.libelle,
        met_id : mets.models[i].attributes.met_id
    }
    var rowPlat = Alloy.createController('rowPlat', args).getView();
    data.push(rowPlat);
} 
```

我在 a 中有所有数据`tableView`，并且工作正常。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T13:51:12.367

您的问题是您没有获取任何数据。所以`where`不会返回任何记录。

所以首先初始化你的收藏：

```
var mets = Alloy.createCollection('Met')
mets.fetch(); 
```

然后在需要时根据您的输入过滤数据。

```
mets.where({famille_id:1}) 
```

因为我不使用合金，所以我没有测试过这个。但`Alloy.createCollection`只需返回一个`Backbone.Collection`s

# mysql - 基本的mysql版本控制？

> ID：13361130
> 
> 赞同：7
> 
> 时间：2012-11-13T12:56:56.443
> 
> 标签：mysql, database, database-design, versioning, database-versioning

我们有一个如下图所示的购物车，该设置运行良好，除了一个致命缺陷。如果您下订单，则订单与产品相关联，因此如果我在您购买产品后更新产品，我无法向您展示您想要产品在您购买时的样子（包括价格）。这意味着我们需要版本控制。

![当前架构](../Images/ad36061ba8a86f76448634ea10386e61.png)

我目前的计划是，当创建新产品或变体或编辑现有产品时，在数据库中创建产品或变体的副本。购买时，将订单链接到版本，而不是产品。

这看起来相当简单，除了我可以看到我们唯一不需要版本化的是类别（因为没有人关心它属于什么类别。）。所以我们需要版本：

*   产品
*   变体
*   每个版本的键 -> 值对属性
*   图片

我目前的想法是，

> **注意：** *当创建产品时，也会创建默认变体，这不能被删除。*

*   **创建产品时**
    *   将产品插入产品表中。
    *   创建默认变体
    *   将产品复制到 products_versions 表中
        *   用 product_id 列替换当前 id 列
        *   添加标识列
    *   将变体复制到 variables_versions 表中
        *   用 variant_id 列替换当前 id 列
        *   添加标识列
        *   将 product_id 列替换为 product_version_id 列

* * *

*   **编辑产品时**
    *   将产品更新到产品表中。
    *   将产品复制到 products_versions 表中
        *   用 product_id 列替换当前 id 列
        *   添加标识列
    *   将所有产品变体复制到 variables_versions 表中
        *   用 variant_id 列替换当前 id 列
        *   添加标识列
        *   将 product_id 列替换为 product_version_id 列
    *   将所有 variant_image_links 复制到 variant_Image_link_version 表中
        *   将当前的 variant_id 列替换为 variant_version_id 列

* * *

*   **添加变体时**
    *   将变体添加到变体表中。
    *   将产品复制到 products_versions 表中
        *   用 product_id 列替换当前 id 列
        *   添加标识列
    *   将所有产品变体复制到 variables_versions 表中
        *   用 variant_id 列替换当前 id 列
        *   添加标识列
        *   将 product_id 列替换为 product_version_id 列

* * *

*   **编辑变体时**
    *   更新变体表中的变体。
    *   将产品复制到 products_versions 表中
        *   用 product_id 列替换当前 id 列
        *   添加标识列
    *   将所有产品变体复制到 variables_versions 表中
        *   用 variant_id 列替换当前 id 列
        *   添加标识列
        *   将 product_id 列替换为 product_version_id 列
    *   将所有 variant_image_links 复制到 variant_Image_link_version 表中
        *   将当前的 variant_id 列替换为 variant_version_id 列

所以最终的结构看起来像[Full Size](https://i.stack.imgur.com/fj6o1.png) [![](../Images/6c1fdc160cc10d97247e7f83a2b4b409.png)](https://i.stack.imgur.com/fj6o1.png)

现在这一切看起来都很棒，除了看起来有很多重复的数据，例如，如果我们更新产品，我们会复制变体，即使它们在插入后不会更新。此外，这似乎需要做很多工作。

有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-14T18:48:36.677

您可以执行 ERP（也可能是工资单）系统执行**的操作：添加开始和结束日期/时间**。所以...

*   根据共同日期，变体和价格与其产品相匹配。
*   所有查询默认在当前日期运行，并且每个表之间的连接还需要考虑重叠/相交的日期范围。`parent_start_date <= child_start_date AND parent_end_date >= child_end_date`
*   对于每个价格变化或变体，您最终会得到重复的行，但是当产品价格变化时，您不需要保持更新尽可能多的记录（如变体 ID）。
*   需要确保使用有效日期。PS：使用系统的最大日期作为最新/最近记录的结束日期时间。

顺便说一句，一些相关的问题：

*   [在 MongoDB 中实现数据版本控制的方法](https://stackoverflow.com/questions/4185105/ways-to-implement-data-versioning-in-mongodb?rq=1)
*   [在 PostreSQL 中实现数据版本控制的方法](https://stackoverflow.com/questions/4185235/ways-to-implement-data-versioning-in-postresql?rq=1)
*   [在 Cassandra 中实现数据版本控制的方法](https://stackoverflow.com/questions/4183945/ways-to-implement-data-versioning-in-cassandra?rq=1)
*   [MySQL 中的行版本控制](https://stackoverflow.com/questions/6290695/row-versioning-in-mysql?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-16T04:38:07.627

另一种方法是永远不要编辑或删除您的数据，只创建新数据。在 SQL 术语中，您曾经对表运行的唯一操作是 INSERT 和 SELECT。

要完成您想要的，每个表都需要以下列：

*   version_id - 这将是您的主键
*   id - 这将是保存对象版本的东西（例如，查找产品的所有版本，SELECT * FROM products WHERE id = ?）
*   创立日期
*   is_active - 你没有删除任何东西，所以你需要标记以（逻辑上）删除数据

有了这个，您的产品表将如下所示：

```
CREATE TABLE products (
  version_id CHAR(8) NOT NULL PRIMARY KEY,
  id INTEGER NOT NULL,
  creation_date TIMESTAMP NOT NULL DEFAULT NOW(),
  is_active BOOLEAN DEFAULT true,
  name VARCHAR(1024) NOT NULL,
  price INTEGER NOT NULL
);

CREATE TABLE variants (
  version_id CHAR(8) NOT NULL PRIMARY KEY,
  id INTEGER NOT NULL,
  creation_date TIMESTAMP NOT NULL DEFAULT NOW(),
  is_active BOOLEAN DEFAULT true,
  product_version_id CHAR(8) NOT NULL,
  price INTEGER NOT NULL,
  override_price INTEGER NOT NULL,
  FOREIGN KEY (product_version_id) REFERENCES products(version_id)
); 
```

现在，插入任一表

1.  生成唯一的version_id（有几种策略，一种是使用数据库序列，或者对于MySQL使用ant AUTO_INCREMENT）。
2.  生成一个标识。此 id 对于产品的所有版本都是一致的。

要更新表中的一行，必须插入整个图表，例如，要更新产品，必须插入新产品和新变体。（这里有很大的优化空间，但最容易从未优化的解决方案开始。）

例如，更新产品

1.  生成唯一的 version_id
2.  使用相同的 id
3.  插入新产品变体。变体将与链接到您正在“更新”的产品的先前版本的变体相同，除了 product_version_id 不同。

该主体可以扩展到您的所有表。

要查找产品的最新版本，您需要使用 creation_date 列来获取最近创建的产品。

这个模型将使用更多空间，但我认为这可能是一个公平的权衡，因为它很简单：只有 INSERT 和 SELECT，并且数据永远不会发生变异。

# xaml - 在 WinRT / Windows 应用商店应用程序中安全地存储加密密钥

> ID：13361133
> 
> 赞同：3
> 
> 时间：2012-11-13T12:57:01.843
> 
> 标签：xaml, encryption, windows-8, windows-runtime, winrt-xaml

我想加密我的一些 Windows 8 应用数据（存储在本地存储文件夹中）。这不是非常敏感的数据，但是我想防止用户伪造/修改它（并且正在研究加密作为实现这一目标的一种方式）。

是否有任何可用的安全密钥库可用于保存我的密钥以供以后重复使用？我想做的是：1）在第一次运行时生成密钥并将其存储在某处，2）使用密钥加密数据，3）每当我需要解密数据时，我都会从存储中检索密钥。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T13:33:18.153

您看过 PasswordVault 类了吗？[http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.credentials.passwordvault.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.security.credentials.passwordvault.aspx)

基本上所有机密信息都应该放在那里。如果您想“防止用户伪造/修改它”，问题是您愿意为此投入多少精力。

一般来说，PasswordVault 中的数据应该是安全的，无需使用额外的加密。关于高于该级别的安全性，可以说对计算机具有物理访问权限的攻击者可以对其进行任何操作，因为您必须将密钥存储在同一台计算机上。任何更迅速地达到与投入努力相比收益递减的点——即只是增加一些模糊性而不是真正的安全性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-15T14:30:58.320

小心 PasswordVault 解决方案，我发现它实际上是一个问题，因为它是一个漫游设置。如果您同时在两台设备上打开您的应用程序，您将获得两个加密密钥，但一天左右后，漫游设置将覆盖第一个生成的加密密钥。

# asynchronous - 使用 signalR 更新 Winforms UI

> ID：13361138
> 
> 赞同：0
> 
> 时间：2012-11-13T12:57:21.127
> 
> 标签：asynchronous, signalr, signalr.client

我有一个表单，它是在系统托盘中运行的它自己的 UI 线程上创建的，我需要使用来自服务器的 signalR 连接进行操作，我认为该连接在后台线程上运行。我知道在不从 UI 线程访问控件时需要调用控件。我可以使用在表单加载时调用的以下代码进行操作（在我的情况下制作弹出窗口），但由于我对异步相当陌生，因此需要进行完整性检查：

```
 private void WireUpTransport()
    {
        // connect up to the signalR server
        var connection = new HubConnection("http://localhost:32957/");
        var messageHub = connection.CreateProxy("message");
        var uiThreadScheduler = TaskScheduler.FromCurrentSynchronizationContext();

        var backgroundTask = connection.Start().ContinueWith(task =>
        {
            if (task.IsFaulted)
            {
                Console.WriteLine("There was an error opening the connection: {0}", task.Exception.GetBaseException());
            }
            else
            {
                Console.WriteLine("The connection was opened successfully");
            }
        });

        // subscribe to the servers Broadcast method
        messageHub.On<Domain.Message>("Broadcast", message =>
        {
            // do our work on the UI thread
            var uiTask = backgroundTask.ContinueWith(t =>
            {
                popupNotifier.TitleText = message.Title + ", Priority: " + message.Priority.ToString();
                popupNotifier.ContentText = message.Body;
                popupNotifier.Popup();
            }, uiThreadScheduler);
        });
    } 
```

这看起来好吗？它在我的本地机器上运行，但这有可能在我们业务中的每台用户机器上推出，我需要把它做好。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T17:25:31.140

从技术上讲，您应该在收听之前连接所有通知（使用`On<T>`） 。`Start`至于您的异步工作，我不太确定您要做什么，但由于某种原因，您将通知链接到您的 UI`On<T>`到`backgroundTask`变量中，该变量是调用返回给您的任务`Start`。没有理由参与其中。

所以这可能是你想要的：

```
private void WireUpTransport()
{
    // connect up to the signalR server
    var connection = new HubConnection("http://localhost:32957/");
    var messageHub = connection.CreateProxy("message");
    var uiTaskScheduler = TaskScheduler.FromCurrentSynchronizationContext();

    // subscribe to the servers Broadcast method
    messageHub.On<Domain.Message>("Broadcast", message =>
    {
        // do our work on the UI thread
        Task.Factory.StartNew(
            () =>
            {
                popupNotifier.TitleText = message.Title + ", Priority: " + message.Priority.ToString();
                popupNotifier.ContentText = message.Body;
                popupNotifier.Popup();
            }, 
            CancellationToken.None,
            TaskCreationOptions.None,
            uiTaskScheduler);
    });

    connection.Start().ContinueWith(task =>
    {
        if (task.IsFaulted)
        {
            Console.WriteLine("There was an error opening the connection: {0}", task.Exception.GetBaseException());
        }
        else
        {
            Console.WriteLine("The connection was opened successfully");
        }
    });
} 
```

# ruby - 通过 Fog 为 EC2 实例设置 user_data

> ID：13361143
> 
> 赞同：0
> 
> 时间：2012-11-13T12:57:36.023
> 
> 标签：ruby, amazon-web-services, fog

有人知道如何通过 Fog 框架设置 EC2 user_data。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T15:30:30.930

例如，只需设置`user_data`选项

```
compute.servers.create :user_data => 'some data' 
```

# python - Python Django：tzinfo 不适用于数据库插入。但是为什么 .now(local_tz) 有效？

> ID：13361144
> 
> 赞同：1
> 
> 时间：2012-11-13T12:57:46.570
> 
> 标签：python, django, timezone, pytz

我正在使用 Django。

在设置中：

```
TIME_ZONE = 'Europe/Copenhagen'
USE_TZ = True 
```

由于 DST，时钟在 2013 年 3 月 31 日跳过一个小时。01:59 到 03:00

我认为：

日期和时间以当地时间给出。我希望这些以 UTC 格式插入。

下面的代码正确保存为 UTC，但给出 RuntimeWarning: DateTimeField received a naive datetime

```
the_date = datetime.datetime(2013, 3, 31, 1, 59)
hit = hits(date= the_date); hit.save(); # Correctly saved as 00:59:00

the_date = datetime.datetime(2013, 3, 31, 3, 1)
hit = hits(date= the_date); hit.save(); # Correctly saved as 01:01:00 
```

我想我可以通过让日期时间知道来避免警告。它确实避免了警告，但现在转换是错误的。

```
tz = timezone(settings.TIME_ZONE)
the_date = datetime.datetime(2013, 3, 31, 3, 1, tzinfo = tz)
hit = hits(date= the_date); hit.save(); # Incorrectly saved as 02:01:00 
```

以下工作，没有运行时错误：

```
I have installed pytz.
the_date = local_tz.localize(datetime.datetime(2013, 3, 31, 3, 1)) 
```

解决我的问题：

我知道 tzinfo 不起作用，因为它不考虑夏令时。好吧，我不会用它。但是当以下似乎起作用时，我感到困惑：

```
the_date = datetime.datetime.now(local_tz) 
```

这在冬季（它减去 1 小时以获得 utc）和当我将计算机系统时间更改为夏季的日期（它减去 2 小时以获得 utc）时都正确插入为 utc。

我的问题：

.now(local_tz) 工作还是我测试错了？为什么这与 tzinfo = tz 不同？还是我使用 tzinfo 错误？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:21:24.007

我建议尽快转换为 UTC，并且只在内部使用 UTC。保存跨时区移动的情况（例如船舶）并且确实需要保存时区信息，对于恒定时区的情况，仅使用本地时间进行输入/输出并将其转换为 UTC 在用户界面上要简单得多.

要将本地时间转换为 UTC，您需要使用`pytz.timezone.normalize`处理夏令时和其他时区转换的方法。[请参阅文档](http://pytz.sourceforge.net/#problems-with-localtime)的这一[部分`pytz`](http://pytz.sourceforge.net/#problems-with-localtime)。在您的情况下，要将本地日期时间转换为 UTC，您需要以下内容：

```
from pytz import timezone, utc

local_tz = timezone(settings.TIME_ZONE)
local_dt = datetime.datetime(2013, 3, 31, 3, 1, tzinfo = local_tz)
utc_dt = utc.normalize(local_dt.astimezone(utc)) 
```

# ruby-on-rails - 从没有清单的 Rails 视图中声明的样式表生成单个 CSS 文件

> ID：13361146
> 
> 赞同：1
> 
> 时间：2012-11-13T12:57:56.373
> 
> 标签：ruby-on-rails, ruby-on-rails-3, stylesheet, asset-pipeline, sprockets

我目前在我的 Rails 视图中声明了特定于视图的样式表，使用：

```
<% content_for :page_specific_stylesheets do %>
  <%= stylesheet_link_tag "some-stylesheet", :media => "all" %>
  <%= stylesheet_link_tag "some-other-stylesheet", :media => "all" %>
<% end %> 
```

我还有一个从 Sass 部分构建的单独的应用程序范围的样式表，并通过 application.css 清单构建单独的样式表。我喜欢在我的视图中列出特定于页面的样式表，但这样做的问题是它们没有合并和缩小，而是作为单独的样式表包含在页面中。我知道我可以在此处为页面引用单个清单样式表，并让其引用特定于页面的样式表，但我想跳过此清单并保留在视图中声明的各个样式表，因为我觉得它更清晰。

那么有什么方法可以告诉 Rails/Sprockets 从视图中组合和缩小一组样式表。显然，这会给我每页两个样式表——我的站点范围的样式表和一个特定于页面的样式表，但这对我来说很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T03:24:29.930

无法从视图中组合文件，但样式表可以表现为清单。如果您使用该`@include`指令，Sass 会通过将该文件的内容插入到调用文件中来预编译它。

留下第二个声明：

```
<% content_for :page_specific_stylesheets do %>
  <%= stylesheet_link_tag "some-other-stylesheet", :media => "all" %>
<% end %> 
```

在 的顶部`some-other-stylesheet.css.scss`，包括第一个：

```
@include "some-stylesheet";

/* Other Sass... */ 
```

# sql-server - 向绑定到带有连接的 SQL 存储过程的 Access ADP 表单添加值时出错

> ID：13361150
> 
> 赞同：1
> 
> 时间：2012-11-13T12:58:04.743
> 
> 标签：sql-server, ms-access, sql-server-2008r2-express, adp

我有一个连接到 SQL Server 2008 Express Edition 的 Access 2003 ADP 项目。

当我尝试向一个表单添加值时，它的 RecordSource 是一个使用 JOIN 的 SQL Strored 过程，我收到以下错误：

您无法更新记录，因为另一个用户或应用程序将其删除或更改了其主键的值。

存储过程的代码是：

```
SELECT F.Description, T.Quantity, T.Points
FROM Test T
RIGHT OUTER JOIN tblCriteriaCategory1 F 
ON T.FunctionalityID = F.tblCriteriaCategory1ID 
```

（我要添加的值是 Quantity 和 Points to table Test 的值）

我还在 Test 和 tblCriteriaCategory1 表上创建了适当的 ForeignKey 关系。

感谢您对上述问题的任何帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T16:02:16.723

您可能需要将功能 ID 作为测试的主键。

这篇[知识库文章](http://support.microsoft.com/kb/295250)显示了与您遇到的几乎完全相同的场景

# ruby-on-rails - Cantango：许可证与权限，何时使用？

> ID：13361156
> 
> 赞同：1
> 
> 时间：2012-11-13T12:58:35.280
> 
> 标签：ruby-on-rails, cancan

在 Rails 的 Cantango 中使用 Permit 引擎而不是 Permission 引擎有什么优缺点（反之亦然）？

哪个性能更好？一个允许什么，另一个不允许？

在使用另一个时禁用一个更好（例如出于性能问题）还是应该将它们相互补充使用？

# javascript - 如何计算Javascript中文本格式的两个日历日期之间的天数？

> ID：13361158
> 
> 赞同：2
> 
> 时间：2012-11-13T12:58:40.800
> 
> 标签：javascript, jquery, jquery-ui, date, datepicker

我有一个表单，它有两个带有日期选择器的输入字段（在 jquery ui 的帮助下）。一个询问入住日期，另一个询问退房日期。我想计算这两个日期之间的天数.我是javascript的初学者。所以有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:03:15.743

使用 unix 时间戳。当您使用时间时，它是通用工具：

```
var a = new Date(2012,11,10);
var b = new Date(2012,11,12);
var dt = (b.getTime() - a.getTime())/(24*3600*1000) //2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:12:02.453

您必须首先获取此类输入字段的值，例如：

```
var v1 = document.getElementById('input1Id').value;
var v2 = document.getElementById('input2Id').value; 
```

那么你必须实例化两个新的 Javascript Date 对象：

```
var parts1 = v1.split('/'); 
var parts2 = v2.split('/');
// this will split your string into date parts, eg. 11/30/2012 would result as an array ['11','30','2012'];

var date1 = new Date(parts1[2],parts1[0],parts1[1]);
var date2 = new Date(parts2[2],parts2[0],parts2[1]);
// remember to check the index of array items considering your date format 
```

最后，您只需从另一个日期中减去一个日期即可获得天数差异：

```
var difference = Math.Abs(date1 - date2);
difference = parseInt(difference / 86400000);
//86400000 are the milliseconds in one day. Parsing to int will round the day - eg.5,4 days results as 5 day 
```

* * *

编辑：当然，您可以通过他的 id 属性引用您的 html 元素

```
<input type="text" id="myTextbox">

---

var txb = document.getElementById('myTextbox');
// do anything else to your txb here, if u like
txb.value = difference; 
```

而已！

# python - 使用 PostgreSQL 和全文搜索的 SQLAlchemy

> ID：13361161
> 
> 赞同：11
> 
> 时间：2012-11-13T12:58:50.233
> 
> 标签：python, postgresql, sqlalchemy, flask

我正在使用烧瓶、sqlalchemy 和烧瓶-sqlalchemy。我想用 gin 和 to_tsvector 在 postgres 中创建一个完整的测试搜索索引。目前，我正在尝试以下方法。我认为它最接近我想要表达的东西，但不起作用。

```
from sqlalchemy.ext.declarative import declared_attr
from sqlalchemy.schema import Index
from sqlalchemy.sql.expression import func

from app import db

class Post(db.Model):

    id = db.Column(db.Integer, primary_key=True)
    added = db.Column(db.DateTime, nullable=False)
    pub_date = db.Column(db.DateTime, nullable=True)
    content = db.Column(db.Text)

    @declared_attr
    def __table_args__(cls):
        return (Index('idx_content', func.to_tsvector("english", "content"), postgresql_using="gin"), ) 
```

这会引发以下错误...

```
Traceback (most recent call last):
  File "./manage.py", line 5, in <module>
    from app import app, db
  File "/vagrant/app/__init__.py", line 36, in <module>
    from pep.models import *
  File "/vagrant/pep/models.py", line 8, in <module>
    class Post(db.Model):
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/flask_sqlalchemy.py", line 477, in __init__
    DeclarativeMeta.__init__(self, name, bases, d)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/ext/declarative/api.py", line 48, in __init__
    _as_declarative(cls, classname, cls.__dict__)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/ext/declarative/base.py", line 222, in _as_declarative
    **table_kw)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/schema.py", line 326, in __new__
    table._init(name, metadata, *args, **kw)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/schema.py", line 393, in _init
    self._init_items(*args)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/schema.py", line 63, in _init_items
    item._set_parent_with_dispatch(self)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/events.py", line 235, in _set_parent_with_dispatch
    self._set_parent(parent)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/schema.py", line 2321, in _set_parent
    ColumnCollectionMixin._set_parent(self, table)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/schema.py", line 1978, in _set_parent
    self.columns.add(col)
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/sql/expression.py", line 2391, in add
    self[column.key] = column
  File "/home/vagrant/.virtualenvs/pep/local/lib/python2.7/site-packages/sqlalchemy/sql/expression.py", line 2211, in __getattr__
    key)
AttributeError: Neither 'Function' object nor 'Comparator' object has an attribute 'key' 
```

我也试过

```
return (Index('idx_content', "content", postgresql_using="gin"), ) 
```

但是，它不能作为 postgres （至少 9.1，因为这是我运行的）期望 to_tsvector 被调用。此行创建 SQL；

```
CREATE INDEX content_index ON post USING gin (content) 
```

而不是我想要的；

```
CREATE INDEX content_index ON post USING gin(to_tsvector('english', content)) 
```

我打开了一张票，因为我认为这可能是一个错误/限制。[http://www.sqlalchemy.org/trac/ticket/2605](http://www.sqlalchemy.org/trac/ticket/2605)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:14:10.243

现在我已经添加了以下几行来手动完成，但如果有的话，我更喜欢“正确的”SQLAlchemy 方法。

```
create_index = DDL("CREATE INDEX idx_content ON pep USING gin(to_tsvector('english', content));")
event.listen(Pep.__table__, 'after_create', create_index.execute_if(dialect='postgresql')) 
```

关于 SQLAlchemy 错误跟踪器有一些有趣的讨论。看起来这是当前索引定义的限制。基本上，我的要求是允许索引是表达式，而不仅仅是列名，但目前不支持。此票正在跟踪此功能请求：[http](http://www.sqlalchemy.org/trac/ticket/695) ://www.sqlalchemy.org/trac/ticket/695 。但是，这正在等待开发人员采取行动并完成工作（并且已经有一段时间了）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-02-04T22:13:48.100

在我创建一些单列和多列 tsvector GIN 索引时遇到了这个老问题。对于正在寻找一种使用列名的字符串表示来创建这些索引的简单方法的任何人，这里是使用 SQLAlchemy[`text()`](https://docs.sqlalchemy.org/en/latest/core/sqlelement.html#sqlalchemy.sql.expression.text)构造的一种方法。

```
from sqlalchemy import Column, Index, Integer, String, text
from sqlalchemy.ext.declarative import declarative_base
from sqlalchemy.sql import func

Base = declarative_base()

def to_tsvector_ix(*columns):
    s = " || ' ' || ".join(columns)
    return func.to_tsvector('english', text(s))

class Example(Base):
    __tablename__ = 'examples'

    id = Column(Integer, primary_key=True)
    atext = Column(String)
    btext = Column(String)

    __table_args__ = (
        Index(
            'ix_examples_tsv',
            to_tsvector_ix('atext', 'btext'),
            postgresql_using='gin'
            ),
        ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-10T08:39:20.960

因此，在 sqlalchemy 0.9 及更高版本中，这是可行的：

```
class Content(Base, ):
    __tablename__ = 'content'

    id = sa.Column(sa.Integer, primary_key=True)

    description = sa.Column(sa.UnicodeText, nullable=False, server_default='')
    @declared_attr
    def __table_args__(cls):
        return (sa.Index('idx_content',
                     sa.sql.func.to_tsvector("english", cls.description),
                     postgresql_using="gin"), ) 
```

值得注意的是，与第一个示例的不同之处在于直接引用列名，而不是在引号中提供列名，因为这不起作用。

# c++ - 带有数组的模板特化，std::is_array

> ID：13361164
> 
> 赞同：2
> 
> 时间：2012-11-13T12:59:01.703
> 
> 标签：c++, templates, sfinae, specialization

我玩弄模板专业化和 SFINAE。

至于下面的例子，事情似乎很简单：

```
 template <class T>
    void Do(T t, typename std::enable_if<std::is_integral<T>::value >::type* = 0)
    {
        cout << "is integer" << endl;
    }

    template <class T>
    void Do(T t, typename std::enable_if<std::is_floating_point<T>::value >::type* = 0)
    {
        cout << "is float" << endl;
    } 
```

不，我尝试了 std::is_array，但从未使用过 std::is_array 的特化。

所以我尝试了为什么 is_array 永远不匹配：

```
 template <int num>
    void Do( int a[num])
    {
        cout << "int array size " << num << endl;
    }

    void Do( int* x)
    {
        cout << "int*" << endl;
    }

    ...
    int e[] = { 1,2,3 };
    Do(e);
    ... 
```

*对我*来说，第一个谜团是，“int a[num]”的特化从来没有抓住过！函数参数始终具有 int* 类型。

如果我使用引用类型，我会得到“正确”的结果：

```
 template <int num>
    void Do( int (&a)[num])
    {
        cout << "int array size " << num << endl;
    }

    void Do( int* &x)
    {
        cout << "int*" << endl;
    } 
```

所以我的问题出现了：std::is_array 与模板函数参数结合使用是否合理？我知道

```
 cout << boolalpha << std::is_array<decltype(e)>::value << endl; 
```

会给我正确的结果。但是手动声明模板选择并没有给我任何功能添加。我有什么方法可以检测（使用或不使用 SFINAE）来自函数参数的模板特化是否适合数组？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:04:27.247

我想你自己搞定了——如果你想在专业化中使用它们的类型，通过引用将数组传递给模板函数。

您想要这样做的原因是数组到指针衰减，这是模板函数参数在与参数类型匹配之前发生的为数不多的隐式转换之一。这就是为什么`T`当您尝试检查它是否是`DoIt`. 但是，当目标类型是引用类型时，*不会*发生数组到指针的衰减。所以，总结一下：

```
template <class T>
void Do(T& t, typename std::enable_if<std::is_array<T>::value >::type* = 0) 
```

应该管用。

顺便说一句，不使用 SFINAE 的无聊方式

```
template <class T, unsigned N>
void Do(T (&t)[N]) 
```

也可以。

# java - Java - 使用 Ant 自动生成样板代码

> ID：13361168
> 
> 赞同：1
> 
> 时间：2012-11-13T12:59:17.700
> 
> 标签：java, ant, code-generation, building, precompile

**简介：** 我在尝试、失败和沮丧之前问这个问题，因为我对 Apache Ant 的经验为零。一个简单的“是的，这会起作用”就足够了，或者如果它不起作用，请告诉我什么会起作用。

**情况：** 我正在开发一个使用 JavaFX 创建 GUI 的项目。JavaFX 依赖于类似 Java Bean 的对象，这些对象的属性需要大量样板代码。例如，我想要的所有功能都是一个名为*name的**字符串*，默认值为*"Unnamed"*，或者采用最小的 Java 语法：

 **```
String name = "Unnamed"; 
```

在 JavaFX 中，为了提供相同的功能，最少的代码量会增加很多（在这种情况下，功能对我来说意味着我可以设置和获取某个变量以在我的程序中使用）：

```
private StringProperty name = new StringProperty("Unnamed");
public final String getName() { return name.get(); }
public final void setName(String value) { name.set(value); } 
```

**问题：**我可以使用 Ant 生成这个样板代码吗？

似乎可以制作充当（Java）预处理器的 Ant 脚本。例如，通过使用正则表达式替换 ( [https://ant.apache.org/manual/Tasks/replaceregexp.html](https://ant.apache.org/manual/Tasks/replaceregexp.html) ) 函数。我正在考虑在我的代码中与此类似的代码行，然后将其自动替换：

```
<TagToSignifyReplaceableLine> StringProperty person "Unnamed" 
```

**最后的评论：**正如我之前所说的，我以前从未使用过 Ant，所以我想与您核实一下 1）这是否可以完成，以及 2）这是否是一种好方法或是否有更好的方法。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:49:12.447

是的，可以做到:-)

我曾经编写了一个 Web 服务适配器，它使用 WSDL 文档（描述基于 SOAP 的 Web 服务的 XML 文件）来生成 POJO Java 类，该类实现了我的产品的功能接口。导致我这样做的是与我们的专有系统对话所必需的盲目重复的 Java 代码。

该技术解决方案使用 XSLT 样式表将输入 XML 文档转换为输出 Java 文本文件，该文件随后由 ANT 编译。

```
<!-- Generate the implementation classes -->
<xslt force="true" style="${resources.dir}/javaServiceStub.xsl" in="${src.dir}/DemoService.wsdl" out="${build.dir}/DemoService/src/com/myspotontheweb/DemoServiceSkeleton.java" classpathref="project.path">
    <param name="package" expression="com.myspotontheweb"/>
    ..
    ..
</xslt> 
```

不幸的是，XSLT 是最接近原生 ANT 支持的模板引擎的东西。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:33:16.480

我会特别看一下 JSR-269：[**genftw**](http://code.google.com/p/genftw/)这使得 JSR-269 更容易......

是的，它可以与 Ant 一起工作，甚至无需编写插件，并且比脆弱的 RegEx 工作得更好。

如果您真的很喜欢冒险，另一个选择是查看[XText](http://www.eclipse.org/Xtext/)以进行代码生成，但它相当复杂。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:18:22.087

是的，可能。您甚至可以实现您自己的 Ant 任务，这很容易完成这项工作。

像这样的蚂蚁：

```
<taskdef name="codegen" classpath="bin/" classname="com.example.CodeGen" /> 
```

接着

```
<codegen className="Test.java">
   <Property name="StringProperty.name" value="Unnamed"/>
</codegen> 
```

CodeGen.java 然后像这样：

```
public class CodeGen extends Task {
    private String className = null;
    private List properties = new ArrayList();

    public void setClassName(String className) {
        this.className = className;
    }

    /**
     * Called by ant for every &lt;property&gt; tag of the task.
     *  
     * @param property The property.
     */
    public void addConfiguredProperty(Property property) {
      properties.add(property);
    }

    public void execute() throws BuildException {
        // here we go!
    }

} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:03:42.990

我知道这是可以做到的，因为我以前的公司使用 ant 在 java 中生成模型对象。

他们使用的方法是在 XML 文件中定义模型对象并运行 ant 任务来生成 pojo 和 dto。

我很快搜索了一下，发现有一些工具可以让您从 XML 生成 java。您可能可以在 XML 中提供您的架构/默认值等，并有一个 nt 任务来运行该工具。**

# android - Android ICS 后退按钮

> ID：13361169
> 
> 赞同：0
> 
> 时间：2012-11-13T12:59:19.293
> 
> 标签：android, android-4.0-ice-cream-sandwich

我在 Android 2.3.3 上开发了一个应用程序。当我单击应用程序中的按钮时，我会通过 Intent 打开下一个 Activity 并使用 onCreate 方法中的数据填充线性布局。然后我去下一个活动。当我点击后退按钮时，之前的 Activity 会加载所有数据。我的应用程序在 Android 2.3.5 上运行良好，但是当我在 Android 4.0 上测试它时，之前的活动缺少数据。

我还实现了后退按钮操作。我在 Activity 上调用 this.finish()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:56:09.343

I would recommend looking into saving the instance state of your application. This can be done by using a combination of [onSaveInstanceState](http://developer.android.com/reference/android/app/Activity.html#onSaveInstanceState%28android.os.Bundle%29) and [onRestoreInstanceState](http://developer.android.com/reference/android/app/Activity.html#onRestoreInstanceState%28android.os.Bundle%29). This way all data is retained by the Activity.

```
@Override        
protected void onSaveInstanceState(Bundle savedInstanceState) {
   super.onSaveInstanceState(savedInstanceState);            
   savedInstanceState.putInt("data", a);
}

@Override    
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);     
    a= savedInstanceState.getInt ("data");   
} 
```

# javascript - 使用来自javascript的元素的参数类调用方法

> ID：13361174
> 
> 赞同：0
> 
> 时间：2012-11-13T12:59:39.577
> 
> 标签：javascript, jquery, asp.net-mvc

这是主文件：

```
<li id="notification0">
    <a href="#" onclick="/MyPage/MyPageView"></a>
</li>
<li id="notification1">
    <a href="#" onclick="/MyPage/MyPageView"></a>
</li>
<li id="notification2">
    <a href="#" onclick="/MyPage/MyPageView"></a>
</li> 
```

然后，使用 javascript 和 jquery，我将文本和类添加到链接中。我想以该类作为参数调用 MyPageController 中的 MyPageView 函数。我应该在 onclick 中更改什么以将类添加为参数？但是我稍后会在代码中获取并添加该类。

我想做这个：

```
onclick="/MyPage/MyPageView/classForTheCorrectNotificationTag" 
```

这就是我添加课程的方式：

```
$('#notification0').addClass('test');
$('#notification1').addClass('water');
$('#notification2').addClass('driver'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:27:34.973

由于您将基本控制器路径作为公共值，因此您可以简单地将其作为全局变量：

```
var controllerPath = "/MyPage/MyPageView/"; 
```

然后你可以在添加类的同时添加点击事件：

```
$('#notification0').addClass('test').click(function(e) {
    window.location.href = controllerPath + 'test';
}); 
```

根据需要添加的类的方式，这可能会变得更加动态，例如：

```
function SetClickable(id, path) {
    $('#' + id).addClass(path).click(function(e) {
        window.location.href = controllerPath + path;
    });
} 
```

如果主控制器路径不是常量，您可能需要尝试使用数据属性来包含它：

```
<li id="notification0" data-controller="/MyPage/MyPageView/">
    <a href="#"></a>
</li>

function SetClickable(id, path) {
    $('#' + id).addClass(path).click(function(e) {
        var controller = $(this).data("controller");
        window.location.href = controller + action;
    });
} 
```

# sql-server - 复合 FK 中包含的每一列是否都需要一个额外的索引？

> ID：13361178
> 
> 赞同：1
> 
> 时间：2012-11-13T12:59:48.900
> 
> 标签：sql-server, indexing, foreign-keys

我通常在我的 FK 上放置索引以加快我的查询速度，但是如果我在两列上有一个分组索引，其中之一是 FK。是不是也需要加索引？

如您所知，在这种情况下`dm_db_missing_index_details`会不断提示缺少一个索引。

如果有人能告诉我是否真的有必要，我将不胜感激？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:51:40.260

您确实不需要索引，但正如您所说，它将加快查询过程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T14:49:24.437

仅当复合索引将 FK 作为最左边的键时。(FK, Foo) 上的索引将覆盖 (FK) 缺失的索引。但是 (Foo, FK) 上的索引将毫无用处。

# objective-c - LLDB 相当于 Xcode 中 GDB 中的“分离”？

> ID：13361187
> 
> 赞同：6
> 
> 时间：2012-11-13T13:00:20.023
> 
> 标签：objective-c, xcode, debugging, gdb, lldb

LLDB 中是否有任何等效于 GDB 的“分离”命令？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T13:03:46.383

```
process detach 
```

我从[这个 lldb 别名列表中](http://sealiesoftware.com/.lldb-gdb)得到了这个。

# javascript - 面向对象的 JavaScript 编程

> ID：13361192
> 
> 赞同：4
> 
> 时间：2012-11-13T13:00:44.430
> 
> 标签：javascript, oop

在开始尝试学习backbone.js 之前，我一直在尝试使用JavaScript 学习OOP。

我希望能够进行数据绑定，但我似乎无法让它工作。

我刚刚制作了一个预算网站的简单原型，您可以输入预算并输入您花费了多少，它会显示您是否已经完成。

```
function BudgetItem(spent, budget){

    this.setSpent = function(spent){
        this.spent = spent;
    }
    this.setBudget = function(budget){
        this.budget = budget;
    }
    this.getSpent = function(){
        return this.spent;
    }
    this.getBudget = function(){
        return this.budget;
    }

}

function BudgetType(type){
    this.getType = function(){
        return type;
    }
}

BudgetType.prototype = new BudgetItem();

$(document).ready(function(){

    var food = new BudgetType('food');

    $('.budget').html(food.getBudget());
    $('.editbudget').change(function(){
        food.setBudget($('.editbudget').data())
    });
}) 
```

到目前为止，这是我的代码。我不确定我是否做得对。我应该扩展东西吗？另外，有人可以解释如何在没有库的情况下动态绑定数据吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T15:07:04.867

首先我给你一些理论。Javascript 函数是一个动态对象，就像它一样`Object`，并且可以使用`new`关键字创建一个新实例，就像您在侦听器中所做的那样。发生这种情况时，函数本身将作为构造函数运行，而`this`关键字将绑定到新创建的对象。你在上面所做的实际上是在你第一次传递它们的值时动态添加新属性......这很好，但对其他读者来说不是很清楚。

现在是棘手的部分。每个函数都有一个指向“隐藏”原型对象的链接。这是由 JavaScript 运行时创建的匿名（不能通过名称访问）对象，并通过`prototype`属性作为对用户对象的引用传递。此 Prototype 对象还通过其`constructor`属性引用了该函数。要测试我自己说的话，请尝试以下操作：

```
BudgetItem.prototype.constructor === BudgetItem // true 
```

综上所述，您现在可以将函数视为在幕后为您创建的（隐藏）类的构造函数，可通过函数的原型属性访问。因此，您可以将字段直接添加到 Prototype 对象中，如下所示：

```
function BudgetItem(spent) { 
    this.spent = spent 
}           
BudgetItem.prototype.setSpent = function(spent) { this.spent = spent };
BudgetItem.prototype.getSpent = function() { return this.spent }; 
```

另一个问题是继承和向构造函数传递参数。同样，您的版本是有效的，但您在初始化 BudgetType 时无法传递已花费和预算值。我会做的是忘记原型然后去：

```
function BudgetType(type, spent) {
    var instance = new BudgetItem(spent);
    instance.type = type;
    return instance;
} 
```

这与 Scott Sauyet 上面的建议很接近，但更强大。现在您可以传递两个参数（以及更多参数）并拥有更复杂的继承树。

最后，您可以做的是通过为其他自动变量（作为参数传递或在函数内部初始化的变量）提供 getter 来创建私有（或更准确地说是伪私有）属性。这是该语言的一个特殊功能，它的工作原理如下：

```
function BudgetType(type, spent) {
     var instance = new BudgetItem(spent);
     instance.getType = function() {
         return type;
     }
     return instance;
} 
```

现在您可以访问 obj.getType() 在构造函数中传递的“类型”，但不能覆盖初始值。即使您定义了 obj.type = 'New Value'，getType() 也会返回传递的初始参数，因为它引用了另一个上下文，该上下文是在初始化对象时创建的，并且由于关闭而从未被释放。

希望有帮助...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:13:10.030

如果您希望对象的所有实例都引用相同的成员/值，您可以使用闭包：

```
// create a constrctor for you object wrapped in a closure
myCon = (function() {

    // define shared members up here
    var mySharedObj = new function () {
        this.member = "a";
    }();

    // return the actual constructor   
    return function () {
        this.mySharedObj = mySharedObj;
    }
}());

// create two instances of the object
var a = new myCon();
var b = new myCon();

// Altering the shared object from one
a.mySharedObj.member = "b";

// Alters it for all
console.log(b.mySharedObj.member); 
```

如果您想从其他对象构建对象（有点像其他语言`class whatever extends baseClass`），但不希望它们通过引用共享值（而不是值的克隆），您可以使用如下内容：

```
Object.prototype.extendsUpon = (function (_prop, _args) {
    return function (base) {
        for (var key in base) {
            if (_prop.call(base, key)) {
                this[key] = base[key];
            }
        }

        function con(child){
            this.constructor = child;
        }
        con.prototype = base.prototype;

        this.prototype = new con(this);
        this.__base__ = base.prototype;

        var args = _args.call(arguments);
        args.shift();
        base.constructor.apply(this, args);
    }
}(Object.prototype.hasOwnProperty, Array.prototype.slice)); 
```

然后在对象之上构建对象：

```
// Base Object Constructor
function Fruit(name) {
    this.fruitname = name;
}
Fruit.prototype.yum = function() {
    return "I had an " + this.fruitname;
}

// Object constructor that derives from the Base Object
function Favorite() {

    // Derive this object from a specified base object:
    //     @arg0  -> Object Constructor to use as base
    //     @arg1+ -> arguments passed to the BaseObject's constructor
    this.extendsUpon(Fruit, "apple");

    // From here proceed as usual

    // To access members from the base object that have been over-written,
    // use "this.__base__.MEMBER.apply(this, arguments)"
}
Favorite.prototype.yum = function() {
    return this.__base__.yum.apply(this) + " and it was my favorite";
}
var mmm = new Favorite();

// Outputs: "I had an apple and it was my favorite" 
mmm.yum(); 
```

# mysql - MySql - 无法对 varchar 列进行排序？

> ID：13361193
> 
> 赞同：1
> 
> 时间：2012-11-13T13:00:46.560
> 
> 标签：mysql, sql

我正在尝试对 varchar 列进行非常简单的排序，但出现语法错误。用 PHP 和 phpmyadmin 测试。

这是查询：

```
SELECT * FROM cards_available_properties ORDER BY option 
```

这是错误：

> 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的 'option LIMIT 0, 30' 附近使用正确的语法

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:01:40.617

`OPTION`是保留关键字。用反引号逃脱它。

```
SELECT * FROM cards_available_properties ORDER BY `option` 
```

*   [**MySQL 保留字**](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

# java - 尝试为 Solaris 10 (AMD) 的 VirtualBOX 安装上的 ControlTier 安装设置 JAVA_HOME 让我： JAVA_HOME 未设置或设置不正确

> ID：13361194
> 
> 赞同：1
> 
> 时间：2012-11-13T13:00:55.190
> 
> 标签：java, java-home

我像一个疯狂的白痴一样在谷歌上搜索，慢慢失去了住在这里的意愿:) 问题是，我需要设置 ControlTier，为此我需要安装 JRE 和 JDK（版本 6u26 和 6u34）我已经得到了两者都设置并且在过去的几个小时里一直在徒劳地试图找出如何设置 JAVA_HOME 变量，并根据其他站点，PATH 变量以这样的方式设置 zip 文件中的 install.sh 脚本controlTier 不会一直给我一个：JAVA_HOME 没有设置或设置不正确。

我已经尝试过两者的各种组合。有人可以帮助我并指出我必须做些什么才能让这件事旋转起来......非常感谢，这真的很令人沮丧。我希望能够让这个东西运行起来。

干杯!

# scala - Scala 类型类模式和泛型方法

> ID：13361198
> 
> 赞同：4
> 
> 时间：2012-11-13T13:01:02.070
> 
> 标签：scala, generics, typeclass, spray-json

我正在尝试编写一个通用提取器，用于使用 spray 和 spray-json 解析 json POST 正文。

但是，我正在努力让它与多个模型一起使用。这是服务对象中的 case 语句：

```
import MyJsonProtocol._

...

def receive = {
  case Post (Routes.person.post, p: Person) => sender ! Ok(Actions.person.post(p))
  case Get  (Routes.foo.forId(x))           => sender ! Ok(x)
  case _                                    => sender ! Ok("No handler")
} 
```

这是我写的提取器（只要在 case 语句的范围内只有一个模型的 JsonReader 就可以工作）：

```
//NB. Json.parse returns an Option[T]
object Post extends Request {
  def unapply[T:JsonReader](req: HttpRequest): Option[(String, T)] = req match {
    case HttpRequest(POST, url, _, HttpBody(_, body), _) => Json.parse[T](body.asString).map((url, _))
    case _ => None
  }
} 
```

但是，一旦我添加了一个新模型（和关联的 JsonReader），代码就不再编译并出现此错误：

```
ambiguous implicit values:
[error]  both value personFormat in object Json of type => spray.json.RootJsonFormat[com.rsslldnphy.foam.models.Person]
[error]  and value animalFormat in object Json of type => spray.json.RootJsonFormat[com.rsslldnphy.foam.models.Animal]
[error]  match expected type spray.json.JsonReader[T]
[error]     case Post (Routes.person.post, p: Person) => sender ! Ok(Actions.person.post(p)) 
```

JsonReaders 的泛型类型不同的事实似乎已经丢失。这种类型的擦除吗？有没有办法得到我想要的？

这是迄今为止该项目的完整编译代码，并附有注释`ExampleService`，解释了导致它崩溃的原因：[github.com/rsslldnphy/foam](http://github.com/rsslldnphy/foam)。感谢您的帮助，谢谢。

或者，如果我想要的目前不可能，任何人都可以提出替代方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T21:47:39.880

你需要给编译器明确的指令来完成这项工作。正如您在下面看到的，编译器无法推断 T 应该是什么。编译器需要能够从请求中动态查看 Json，并从中暗示一个类型（我们只能梦想它会这样做；））

```
def unapply[T:JsonReader](req: HttpRequest): Option[(String, T)] = (...) Json.parse[T] (...) 
```

这意味着要完成这项工作，您必须明确注释帖子，如下所示：

```
import MyJsonProtocol._

...

def receive = {
  case Post[Person] (Routes.person.post, p: Person) => sender ! Ok(Actions.person.post(p))
  case Get  (Routes.foo.forId(x))           => sender ! Ok(x)
  case _                                    => sender ! Ok("No handler")
} 
```

并将定义更改为此

```
case class Post[T: JsonReader] extends Request {
  def unapply(req: HttpRequest): Option[(String, T)] = req match {
    case HttpRequest(POST, url, _, HttpBody(_, body), _) => Json.parse[T](body.asString).map((url, _))
    case _ => None
  }
} 
```

# visual-studio - 调试时调用 COM 组件 VS2012 返回了错误 HRESULT E_FAIL

> ID：13361199
> 
> 赞同：121
> 
> 时间：2012-11-13T13:01:04.017
> 
> 标签：visual-studio, visual-studio-2012

我在调试从 Visual Studio 2010 迁移到 2012 的项目时遇到问题。每次我去调试它时，我都会收到错误消息：

> “对 COM 组件的调用已返回错误 HRESULT E_FAIL”。

在本地 IIS 服务器中编译和运行应用程序工作正常 - 只是无法调试。

除了迁移到 VS2012 之外，另一个变化是我现在使用 Team Foundation Server 进行源代码控制和问题跟踪 - 但我看不出这会如何影响它。

我可以把它缩小到以下

*   项目文件 - 它已从 VS 2003 迁移为网站项目，并已被切碎并更改为不同的版本
*   Crystal Report 运行时库/其他一些库

有任何想法的人吗？

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2015-04-25T00:45:49.723

我最近得到了很多。我不得不创建一个新文件并将代码移动到新文件以解决它。

我通过**删除解决方案的 suo 文件**来修复它（据我所知，它只存储诸如在 IDE 中打开了哪些文件之类的信息，删除它并没有真正的损害）。

我的文件似乎已损坏。（IDE 不会记住重新启动时打开了哪些文件。它的大小为 1.7MB，看起来很大，即使对于我的 40 个项目解决方案，它很少一次打开超过 50 个文件。）

编辑：我最近不得不在 VS2017 中执行此操作，但由于另一个原因，构建需要更长的时间，并且需要 5 分钟以上的时间才能停止调试会话，删除那个讨厌的 suo 文件可以立即修复它，现在任何时候 VS 都可以奇怪地删除 SUO是我的第一个停靠港。

* * *

## 回答 #2

> 赞同：84
> 
> 时间：2019-04-03T10:28:15.623

我在 Visual Studio 2019 中的 c++ 项目中遇到了同样的问题。

以下解决方案对我有用：

*   关闭 Visual Studio。
*   转到项目的根文件夹并删除 .vs 目录。
*   启动 Visual Studio 并打开解决方案。
*   构建现在应该可以工作了。

* * *

## 回答 #3

> 赞同：77
> 
> 时间：2016-02-02T19:07:51.730

我删除了 csproj.user 文件，它对我有用。

在其他一些情况下，要修复此错误，我会转到项目属性中的 Web 选项卡并选中“使用 Visual Studio 开发服务器”和“自动分配端口”。之后我需要重建项目并重新启动VS

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2014-06-11T15:05:24.087

这解决了我的问题：

开始 —> 运行 —>`regsvr32 %SystemRoot%\System32\msxml3.dll`

开始 —> 运行 —>`regsvr32 %SystemRoot%\SysWOW64\msxml3.dll`

在此之前，我尝试了西蒙的上述解决方案，但对我不起作用！

也许将这两种解决方案结合起来就可以了！

* * *

## 回答 #5

> 赞同：8
> 
> 时间：2017-09-19T08:09:09.113

很抱歉恢复死线程，但我在 VS2017 上通过删除项目模板缓存和项目模板缓存文件夹解决了这个问题

```
%localappdata%\Microsoft\VisualStudio\[BUILD] 
```

然后通过重置视觉工作室设置

```
Tools>Import and export settings>reset all settings 
```

我还听说关闭“所有项目的轻量级解决方案负载”会有所帮助。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2016-10-19T15:36:46.193

我想补充一点，在 WinForms 应用程序中打开设计器文件时遇到了这个错误。我的问题是项目中的引用之一是引用自身。显然这可能发生在这里提到

[https://social.msdn.microsoft.com/Forums/office/en-US/00aede04-d8cd-4475-8114-4b4792261052/winforms-designer-error-hresult-efail-has-been-returned-from-a-呼叫一个 com 组件](https://social.msdn.microsoft.com/Forums/office/en-US/00aede04-d8cd-4475-8114-4b4792261052/winforms-designer-error-hresult-efail-has-been-returned-from-a-call-to-a-com-component)

我删除了参考，它工作正常。

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-10-31T13:32:14.573

也许[这个页面](http://blogs.msdn.com/b/smondal/archive/2013/03/08/error-hresult-e-fail-has-been-returned-from-a-call-to-a-com-component.aspx)有帮助：

> 场景二：Microsoft Visual Studio 2010 IDE 在创建或调试 Web 应用程序项目时崩溃。出现上述错误是因为 Visual Studio 2010 的缓存损坏。为了解决此问题，只需从以下位置删除项目缓存：
> 
> `C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\ProjectTemplatesCache`
> 
> `C:\Program Files(x86)\Microsoft Visual Studio 10.0\Common7\IDE\ProjectTemplatesCache`
> 
> 然后运行`devenv.exe /setup`重新构建缓存。

* * *

## 回答 #8

> 赞同：4
> 
> 时间：2014-04-08T03:28:14.700

嗬！以防其他人在尝试附加到 IIS 网站时遇到此错误。

三重检查您的主机名是否正确，我忘记了（例如）[http://my.testsite.com中的“/”](http://my.testsite.com)

在像我一样重新安装 Visual Studio 之前试试这个。可怕的错误消息。

* * *

## 回答 #9

> 赞同：4
> 
> 时间：2018-11-01T07:54:37.200

我尝试了所有上述解决方案对我都不起作用，我在[这里找到了解决方案](https://developercommunity.visualstudio.com/content/problem/260196/add-a-reference-raise-error-error-hresult-e-fail-h.html)

*   通过进入打开 ActivityLog.xml

    ```
    C:\Users\{UserName}\AppData\Roaming\Microsoft\VisualStudio\15.{Id} 
    ```

*   检查错误是否表明

    ```
    "CreateInstance failed for package 
    [ReferenceManagerPackage]Source: 'mscorlib' Description: Could not load type 
     'Microsoft.VisualStudio.Shell.Interop.' from assembly 
     'Microsoft.VisualStudio.Shell.Interop.11.0' 
    ```

*   然后`gacutil`通过 VS Cmd 提示符（管理员模式）运行此命令：

    1.  导航

        ```
        C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\Common7\IDE\PublicAssemblies 
        ```

    2.  跑`gacutil -i Microsoft.VisualStudio.Shell.Interop.11.0.dll`

* * *

## 回答 #10

> 赞同：3
> 
> 时间：2019-09-05T17:54:25.837

似乎要在 Visual Studio 2017 中显示“添加引用”对话框，需要在 GAC 中注册 Microsoft.VisualStudio.Shell.Interop.11.0.dll。您可以按照以下步骤在 GAC 中注册此程序集：

打开 VS2017 的开发命令提示符（确保以管理员身份运行，否则 GAC 注册可能会失败）

将当前目录更改为 Visual Studio 2017 安装的 PublicAssemblies 文件夹。我的是：

C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\PublicAssemblies

运行以下命令在 GAC 中注册程序集：

gacutil -i Microsoft.VisualStudio.Shell.Interop.11.0.dll

C:\Program Files (x86)\Microsoft Visual Studio\2017\Community\Common7\IDE\PublicAssemblies>gacutil -i Microsoft.VisualStudio.Shell.Interop.11.0.dll Microsoft (R) .NET 全局程序集缓存实用程序。版本 4.0.30319.0 版权所有 (c) Microsoft Corporation。版权所有。

程序集成功添加到缓存

现在重新启动 VS2017 并尝试再次添加对项目的引用，您应该会看到 Add Reference 对话框出现。

如需更多说明，请点击以下链接

[https://camerandwyer.com/2017/05/03/how-to-fix-the-operation-could-not-be-completed-error-adding-reference-to-visual-studio-2017/#more-2286](https://camerondwyer.com/2017/05/03/how-to-fix-the-operation-could-not-be-completed-error-adding-reference-to-visual-studio-2017/#more-2286)

* * *

## 回答 #11

> 赞同：3
> 
> 时间：2020-06-11T11:59:14.800

我在[https://developercommunity.visualstudio.com/content/problem/260196/add-a-reference-raise-error-error-hresult-e-fail-h.html](https://developercommunity.visualstudio.com/content/problem/260196/add-a-reference-raise-error-error-hresult-e-fail-h.html)地址上找到了以下解决方案。

它在 VS 2019 中对我有用：

1 以管理员身份打开“VS 2017 的开发人员命令提示符”

2 CD 进入“C:\Program Files (x86)\Microsoft Visual Studio\2017\Professional\Common7\IDE\PublicAssemblies”

3 运行“gacutil -i Microsoft.VisualStudio.Shell.Interop.11.0.dll”

重新启动后，一切正常。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2016-11-02T10:51:03.830

从 VS2013 升级到 VS2015 后，我遇到了同样的问题。

我正在从事的项目引用了它自己。虽然 VS2013 不在乎，但 VS2015 不喜欢这样，我得到了那个错误。删除引用后，错误消失了。我花了大约4个小时才发现...

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2019-09-20T18:39:51.010

只需删除包文件夹。这对我有帮助

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-09-22T06:03:09.590

*根本原因：* GAC 中缺少 Microsoft.VisualStudio.Shell.Interop.11.0.dll。

*解决方案：* 1\. 转到开始菜单并打开 Visual Studio 的命令提示符 2\. 输入命令**gacutil -i Microsoft.VisualStudio.Shell.Interop.11.0.dll** 3\. 如果您的系统无法找到此 dll 文件，您可以下载它来自 Nuget 包管理器，然后可以提供 dll 的路径

可以了，好了！点击进入，你就完成了！

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2014-10-09T15:27:25.890

我编写了一个简单的程序来打开不同的文件夹，同时单击一些特定的按钮。我将文件属性设置为“内容”和“如果较新则复制”以进行部署。因此，如果我在其他软件中安装了 exe 文件，它实际上会安装其所有资源并正常运行程序。所以，这就是我的程序。在开发此程序时，有时如果我运行程序进行检查，它会显示错误

> **“HRESULT E_FAIL 已从对 COM 组件的调用中返回”**

我无法打开设计器视图。但不知何故，我得到了一个简单的解决方案。我不确定它是否适用于其他人。

这是解决方案：

将整个应用程序文件夹复制到另一个位置。从那里单击应用程序文件。它不起作用，因为它只是一个副本，你不会看到设计师

1.  从解决方案资源管理器中删除 form1.vb （或者如果在开发过程中更改，则可能是不同的名称）
2.  在解决方案资源管理器中>右键单击>添加现有项目>浏览从中复制文件夹的文件 Form1.vb（原始位置）
3.  在新位置运行程序。它会工作

如果您想添加一些东西并且在运行程序后发现相同的错误，则此解决方案的问题，您必须再次将整个应用程序文件夹复制到另一个位置并按照上述步骤操作

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2019-08-08T14:29:24.057

我安装了最新的 Windows 10 SDK 后发生了错误。使用 SDK 8.1 构建 C++ 项目时出现错误。在项目属性中，我切换到最新的 10 SDK。重建。那行得通。改回8.1。重建。没有错误。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2021-06-08T00:53:14.583

就我而言，这似乎是因为我隐藏了一些文件，但一些相关的窗口仍然打开。

关闭所有窗口并重建解决方案为我修复了它。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-11-05T03:39:06.450

解决问题的步骤：

1.在 VS 2012 中以管理员模式打开您的解决方案/Web 应用程序。

2.转到 IIS 并记下应用程序的设置（例如虚拟目录名称、物理路径、身份验证设置和使用的应用程序池）。

3.从默认网站中删除（右键单击并选择删除）您的应用程序。刷新 IIS。

4.返回 VS 2012 并打开 Web 应用程序的设置（右键单击并选择属性）。

5.选择 Web。在服务器部分确保您选择了“使用本地 IIS Web 服务器”。

6.在 Project Url 文本框中输入您的应用程序路径（http:/// `localhost`Application Path）。单击创建虚拟目录。

7.转到 IIS 并应用步骤 2 中记录的设置。刷新 IIS。

8.转到VS 2012，将此项目设置为启动项目，并将适当的页面设置为启动页面。

9.单击运行按钮以调试模式启动项目。

这为我解决了从 VS 2010 迁移到 2012 的 Web 应用程序的问题。希望这有助于任何寻找特定问题的人。

我的机器配置是：IIS 7.5.7600.16385

VS 2012 专业版

Windows 7 企业版（版本 6.1 - 内部版本 7601：Service Pack 1）

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-03-23T11:26:59.663

这有时会在我们的 TFS 构建服务器中发生（门控签入）。它是关于工作区文件夹的。我不知道为什么，但工作区文件夹访问有时会损坏。我要解决的问题是删除 TFS 构建工作区并删除相关的工作区文件夹。TFS 构建机器然后为自己创建新的工作空间并修复问题。

Tousif Ahmed 的解决方案应该适用于本地构建。将应用程序文件夹复制到另一个地方应该和我在 TFS 构建机器中做的一样。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2016-06-27T17:10:22.320

就我而言，此消息似乎可以由 Visual Studio 2013 中的 Intellisense 发出。下面的屏幕截图显示了首次加载客户项目后 VisualStudio 2013 底部的错误。 [![VS2013](../Images/e33bc39c99282b7e6ee997e07239fcc4.png)](https://i.stack.imgur.com/eFRNl.jpg)

我开始搜索导致此错误的原因，并决定尝试删除 user.vxproj 文件，如上所述。但是我发现项目构建没有问题，然后退出并重新加载项目后，我不再收到错误。所以我假设在我的情况下，由于将项目从客户目录树结构移动到我的本地开发磁盘树结构而导致了一些损坏。这里的关键是，就我而言，问题是暂时的。我什么也没做，问题似乎自行解决了。（通常不是一件可取的事情，因为我没有修复任何东西，所以它可能会回来）。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2016-07-27T14:58:04.063

我最近花了大约 3 个小时尝试在本地 IIS 上运行的 ASP.NET 应用程序上解决此问题。我指定了“覆盖应用程序根 URL”，并指定了带有结尾正斜杠 (/) 的 url，例如`http://my.dev.com/`. 如果我保存了项目选项并返回，它会将覆盖的根 url 显示为`http://http://my.dev.com`. 一旦我删除了最后一个正斜杠，它就开始表现正常并且错误消失了。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2016-10-14T20:06:21.397

> HRESULT E_FAIL 已从对 COM 组件的调用中返回

就我而言，这是因为我的解决方案中有具有相同 GUID 的不同项目。（项目是通过复制/粘贴创建的）

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2016-11-04T16:08:08.787

我的问题表现为打开 Win10 appxmanifest 文件（没有双关语）。只需安装 Windows 10 工具和 SDK（转到新建->项目->选择 Windows->安装工具）即可修复它。

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2016-11-16T09:39:41.347

1.  添加在 x86 架构或 64 位系统上启动的开发，然后它也将在 32 位系统上运行。
2.  但是如果您添加在 32 位系统上启动的开发，然后您想对 64 位源代码进行更改注意：如果您在服务器系统上连接了 SAP 许可证，则通过服务管理器设置端口并设置服务器名称，否则系统将给出错误：

> 连接上下文：- 检索具有 CLSID {632F4591-AA62-4219-8FB6-22BCF5F60090} 的组件的 COM 类工厂失败，原因是以下错误：80040154 未注册类（HRESULT 异常：0x80040154 (REGDB_E_CLASSNOTREG)）。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2017-06-07T16:48:05.450

我通过删除 ComponentModelCache 文件夹解决了同样的问题

1.  关闭 Visual Studio（如果你还没有因为绝望而这样做）
2.  打开文件资源管理器窗口并导航到您的 AppData 文件夹。您可以通过以下方式到达：
    1.  在搜索栏中，键入`%APPDATA%/..`并按 Enter
    2.  或者，导航到`C:\Users\\AppData`
3.  进入`Local\Microsoft\VisualStudio\<version>`Visual Studio 2013 的 12.0 所在的位置。
4.  删除 ComponentModelCache 文件夹。

从这里：[http ://withmartin.net/how-visual-studios-component-model-cache-can-be-a-pain/](http://withmartin.net/how-visual-studios-component-model-cache-can-be-a-pain/)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2017-12-19T21:43:12.097

不确定错误的确切重现步骤（HRESULT E_FAIL 已从对 COM 组件的调用中返回），但我的解决方案是：

1.  关闭 Visual Studio 并通过控制面板修复它。
2.  重启系统

重新启动后，错误消失了。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2018-12-02T12:11:05.993

我在 Visual Studio 2017 中遇到了同样的问题，请按照以下步骤操作：

1.  开始——> 跑——> regsvr32 %SystemRoot%\System32\msxml3.dll

2.  开始——> 跑——> regsvr32 %SystemRoot%\SysWOW64\msxml3.dll

3.  清理项目。

4.  重新启动视觉工作室。

    第 1 步和第 2 步是从 Besnik Kastrati 帖子中复制的。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2019-06-13T22:24:11.060

我找到了这个答案，单击顶部的 Ctrl+Alt+J 单击 (...) 现在您可以从 Browse 、 .Net 或其他添加 dll 单击确定按钮后单击（添加到解决方案资源管理器中选定项目中的引用）（这是一个绿色的加号“+”按钮）

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2019-12-10T10:00:08.090

尝试安装之前下载并安装在另一个项目中的 nuget 包时出现此错误。

单击“工具”>“选项”>“NuGet 包管理器”下**的“清除所有 NuGet 缓存”为我解决了这个问题**

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2020-06-13T04:59:24.157

我在安装 VS2019 后遇到了这个错误，但是在尝试打开一个针对 VS2015 的大型解决方案（20 多个项目）时，包括 vcxproj 和 csproj 项目。csproj 全部加载正常，而 vcxproj 全部因 OP 错误而失败。删除 .vs 文件夹不起作用。

起作用的是在“浏览数据库后备”设置下设置 VC++ 的“后备位置”。

```
Tools (menu)
-Options...
--Text Editor
---C/C++
---Advanced
----Browsing Database Fallback
-----Fallback Location 
```

我将我的设置为`D:\VC++\v16`. 我将 v140 用于 VS2015，将 v141 用于 VS2017。还要设置“始终使用”和“不警告”。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2020-09-10T16:15:54.610

我**从 VS2017 更新到 VS2019 时遇到了这个问题**

对我来说，问题只是通过`deleting the .VC.db`项目文件解决了。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2021-11-08T10:13:20.037

我也有类似的问题，发现所有解决方案都无法在我的系统上运行。我观察到我的系统中安装了 2 个 Visual Studio 版本（2012 和 2019）。所以我只是卸载了 2012 并重新启动了我的系统。自动删除此错误。

如果上述所有解决方案都失败了，包括使用 cmd 行的解决方案，请尝试此方法。

# ejb - 架构选择：ESB 和 EJB

> ID：13361200
> 
> 赞同：0
> 
> 时间：2012-11-13T13:01:06.763
> 
> 标签：ejb, websphere, jpa-2.0, ejb-3.0, esb

我正在构建一个新的 Java EE 应用程序（瘦客户端），这里是应用程序层：

*   应用程序演示将使用 JSF2 / Spring webflow 和 RichFaces 4
*   业务层将使用 EJB 3
*   持久层将使用 JPA2 - Hibernate 实现

该应用程序将在 Websphere Application Server 上运行。

该公司拥有 Websephre Message Broker 作为 ESB。

我有两个选择，我试图根据可扩展性、维护、性能、最佳实践和企业架构设计找出最佳选择，对于它们中的每一个：

1.  在 ESB 上部署业务 EJB3 服务，在专用服务器上部署表示层：表示层将通过 ESB 调用业务服务
2.  在专用WAS上部署EJB服务，在专用服务器上部署表示层：表示层将直接调用EJB服务而不使用ESB

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T01:45:52.063

这是我的建议……使用您做出的架构决策在 WAS 上构建您的应用程序。对于将您的应用程序集成到 ESB，我会投票支持 JMS 或 WebSphere MQ。您可以选择 Web 服务，但正如您的企业架构团队很可能会说的那样......您需要与确认交付进行时间独立的通信。

如果您还想了解这一切是如何工作的，我会查看 IBM SOA 设计模式或随意阅读我的红皮书（IBM SOA 零售设计模式），了解如何将应用程序粘合到 ESB。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-10T14:33:33.180

这取决于（一如既往:)）如果您计划在未来扩展您的应用程序并将其与除 JSF 客户端之外的其他客户端集成，那么 ESB 将是一个可行的解决方案。否则，请保持简单，即应用服务器中的所有内容。如果您继续使用 ESB，我建议您将 EJB 层移动到应用程序服务器，并将您的应用程序从 ESB 公开为 Web 服务。

# c++ - 使用 QDomDocument 读取 xml 文件只需获取第一行

> ID：13361203
> 
> 赞同：0
> 
> 时间：2012-11-13T13:01:13.640
> 
> 标签：c++, xml, qt

我使用 QXmlStreamWriter 生成一个 xml 文件。该文件如下所示：

```
<?xml version="1.0" encoding="UTF-8"?>
<pedestrianinfo>
    <pedestrian uuid="2112e2ed-fc9b-41e8-bbcb-b44ad78bde11">
        <module>11.1208</module>
        <direction>4</direction>
        <row>5</row>
        <column>71</column>
    </pedestrian>
    <pedestrian uuid="1aabb9c1-4aa7-4f47-9542-36d2dfaa26e4">
        <module>1.48032</module>
        <direction>4</direction>
        <row>67</row>
        <column>31</column>
    </pedestrian>

...

</pedestrianinfo> 
```

然后我尝试通过 QDomDocument 读取内容。我的代码如下所示：

```
xmlReader *xp = new xmlReader(QString("D:\\0T.xml"));
    if(xp->openFile()) {
        if(xp->isGetRootIndex()) {
            xp->parseRootIndexElement();
        }
        else
            cout<<"Unable to get root index."<<endl;
    } 
```

这是 isGetRootIndex()：

```
bool xmlReader::isGetRootIndex()
{
    doc.setContent(&file,false);
    root = doc.documentElement();
    if(root.tagName() == getRootIndex()) //rootIndex=="pedestrianinfo"
        return true;
    return false;
} 
```

这是 parseRootIndexElement()：

```
void xmlReader::parseRootIndexElement()
{
    QDomNode child = root.firstChild();
    while(!child.isNull()) {
        if(child.toElement().tagName() == getTagNameP())  //"childTagName=="pedestrian"
            parseEntryElement(child.toElement());
        qDebug()<<"module="<<module<<" direction="<<direction<<" row="<<row<<" column="<<column;
        child = child.nextSibling();
    }
} 
```

parseEntryElement(const QDomElement &element) 是一个函数，用于获取每个标签中的信息并将它们保存到模块等变量中。但是，每次我运行我的代码时，只有 xml 文件的第一个子文件可能是 qDebug*ed*。似乎在执行 child.nextSibling() 之后，child 变为 null。为什么它没有得到下一个行人信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:42:52.470

根据我在文档中看到的内容，我看起来是正确的。也许 parseEntryElement 意外地推进了迭代器？

# c# - 预定消息

> ID：13361205
> 
> 赞同：2
> 
> 时间：2012-11-13T13:01:22.563
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4, message-queue, mq

哪个消息队列库可以处理预定消息？

例如：我需要通过 ASP.NET MVC 应用程序将邮件放入队列并按计划发送电子邮件。对于每封电子邮件，我都有发送日期和时间。

1.  消息 1 于 2012 年 9 月 10 日 12:00
2.  消息 2 于 2012 年 10 月 10 日 13:35
3.  消息 3 于 2012 年 10 月 10 日 24:00

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:22:16.383

听起来更像是使用**计划任务**完成的事情。为此，除了访问您可以使用的本机 api 之外，还有几个成熟的选项：

[任务计划程序托管包装器](http://taskscheduler.codeplex.com/)

[石英网](http://quartznet.sourceforge.net/)

当然，您的任务可能会处理一个队列。

# jquery - 一系列列表项的导航循环

> ID：13361208
> 
> 赞同：2
> 
> 时间：2012-11-13T13:01:39.803
> 
> 标签：jquery, loops, iteration

如果您查看界面顶部，我有 7 个图标。每个图标都有一个对应的标签（使用`<li>`）。当我单击“下一步”按钮时，我想显示下一个标签`<li>`并隐藏前一个标签。我需要这个循环发生，这样一旦我们到达最后一个`<li>`循环。

对于后退按钮，我显然需要与此相反。到目前为止我的代码：

```
$('#next2').click(function() {
    var nextItem = $('#labels li.select').hide().next('#labels li');
    if (nextItem.length === 0) {
        nextItem = $('#labels li').first();
    }

    nextItem.fadeIn().addClass('select');
    $('#labels li.select').prev().hide();
});

$('#prev2').click(function() {
    var prevItem = $('#labels li.select').hide().prev('#labels li');
    if (prevItem.length === 0) {
        prevItem = $('#labels li').last();
    }

    prevItem.fadeIn().addClass('select');
    $('#labels li.select').next().hide();
}); 
```

> HTML

```
<div style="margin-left:8%; margin-bottom:10px;">
    <ul id="labels">
        <li id="label-discover" class="select">Discover </li>
        <li id="label-collaborate">Collaborate </li>
        <li id="label-create">Create </li>
        <li id="label-develop">Develop </li>
        <li id="label-launch">Launch </li>
        <li id="label-maintain">Maintain </li>
        <li id="label-learn">Learn </li>
    </ul>
</div> 
```

> CSS

```
#labels li {
    font-family: 'ArvoBold';
    line-height: 100%;
    font-size: 100%;
    color:#FFF;
    margin-bottom:7px;
    text-align:left;
    display:inline;
    display:none;
    text-transform:capitalize;
}

#labels li.deselect {
    display:none;
}

#labels li.select {
    display:inline;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:52:19.900

不知道这是否是你所追求的，但我很快就把它搞定了：

预览：[JSFiddle](http://jsfiddle.net/JamesD/DYvRW/)

```
$(document).ready(function() {
    var total= $('#labels').children().length - 1;
    var current = 0;

    $('#prev').click(function(e) {
        /* Stop page refreshing on anchor click */
        e.preventDefault();

        $('#labels').children().eq(current).hide();

        if(current === 0)
            current = total;
        else
            current--;

        $('#labels').children().eq(current).show();

    });

    $('#next').click(function(e) {
        /* Stop page refreshing on anchor click */
        e.preventDefault();

        $('#labels').children().eq(current).hide();

        if(current === total)
            current = 0;
        else
            current++;

        $('#labels').children().eq(current).show();

    });
});​​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:26:00.300

## *[jsBin 演示](http://jsbin.com/abisom/2/edit)*

如果您将最初设置为“0”的计数器设置为“0”并且您知道页码：

```
var pagesN = 7 // or use: $('childrensOfSomeElement').length;
var c = 0;

 $('#prev, #next').click(function(){

    // logic //
    var myID = this.id=='next' ? c++ : c--;  
    c= c===-1? pagesN-1 : c%pagesN ;  

    console.log( c );

 }); 
```

单击后，您可以使用该方法定位您想要的**任何子**元素`.eq()`

# algorithm - 最大化以值为界的排序数组的总和中贡献的因素数量

> ID：13361213
> 
> 赞同：2
> 
> 时间：2012-11-13T13:01:55.760
> 
> 标签：algorithm, sorting

我有一个大小为 n 的排序整数数组。这些值不是唯一的。我需要做的是：给定一个 B，我需要找到一个`i<A[n]`这样的总和`|A[j:1 to n]-i|`小于 B 并且对该特定总和贡献最大数量的 A[j]s。我有一些想法，但我似乎无法从天真的 n*B 和 n*n 算法中找到更好的东西。关于 O(nlogn) 或 O(n) 的任何想法？例如：想象一下

> A[n] = 1 2 10 10 12 14 和 B<7 那么最好的 i 是 12 因为我实现了 4 个 A[j] 对我的总和有贡献。如果 i=10 我得到 10 - 10 + 10 - 10 +12-10 + 14-10 = 6<7，则 10 和 11 也同样好

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:22:26.570

O(n) 中的解决方案：从末尾开始计算 a[n]-a[n-1] ：让 d=14-12 => d=2 和 r=Bd => r=5，然后重复运算但将 d 乘以 2： d=12-10 => d=2 and r=r-2*d => r=1, r=1 算法结束，因为总和必须小于 B：

索引为 0..n-1 的数组

```
i=1
r=B
while(r>0 && n-i>1) {
  d=a[n-i]-a[n-i-1];
  r-=i*d;
  i++;
}
return a[n-i+1]; 
```

也许一张图解释得更好

```
14       x
13       x  -> 2
12      xx
11      xx  -> 2*2
10    xxxx    -> 3*0
 9    xxxx   
 8    xxxx
 7    xxxx
 6    xxxx
 5    xxxx
 4   xxxxx
 3   xxxxx
 2  xxxxxx
 1 xxxxxxx 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:48:50.113

我认为您可以使用以下三个技巧在 O(n) 中做到这一点：

## 累计金额

预先计算一个存储 sum(A[0:k]) 的数组 C[k]。
这可以通过 C[k]=C[k-1]+A[k] 在时间 O(n) 中递归地完成。这个数组的好处是你可以通过 C[b]-C[a-1] 计算 sum(A[a:b])。

## 最佳中点

因为您的元素已排序，所以很容易计算最佳 i 以最小化绝对值的总和。事实上，最好的 i 总是由中间条目给出。如果列表的长度是偶数，则两个中心元素之间的所有 i 值将始终给出最小绝对值。

例如，对于您的列表 10、10、12、14，中心元素是 10 和 12，因此 i 在 10 和 12 之间的任何值都会使总和最小化。

## 迭代搜索

您现在可以一次扫描元素以找到最佳值。

```
1\. Init s=0,e=0
2\. if the score for A[s:e] is less than B increase e by 1
3\. else increase s by 1
4\. if e<n return to step 2 
```

跟踪所见分数 < B 的 es 的最大值，这就是你的答案。

这个循环最多可以循环 2n 次，所以它是 O(n)。

A[s:e] 的分数由总和 |A[s:e]-A[(s+e)/2]| 给出。

令 m=(s+e)/2。

```
score = sum |A[s:e]-A[(s+e)/2]| 
= sum |A[s:e]-A[m]|
= sum (A[m]-A[s:m]) + sum (A[m+1:e]-A[m])
= (m-s+1)*A[m]-sum(A[s:m]) + sum(A[m+1:e])-(e-m)*A[m] 
```

我们可以使用预先计算的数组 C[k] 来计算这个表达式中的总和。

## 编辑

如果端点必须始终为 n，那么您可以使用此替代算法：

```
1\. Init s=0,e=n
2\. while the score for A[s:e] is greater than B, increase s by 1 
```

## 蟒蛇代码

这是该算法的python实现：

```
def fast(A,B):
    C=[]
    t=0
    for a in A:
        t+=a
        C.append(t)

    def fastsum(s,e):
        if s==0:
            return C[e]
        else:
            return C[e]-C[s-1]

    def fastscore(s,e):
        m=(s+e)//2
        return (m-s+1)*A[m]-fastsum(s,m)+fastsum(m+1,e)-(e-m)*A[m]

    s=0
    e=0
    best=-1
    while e<len(A):
        if fastscore(s,e)<B:
            best=max(best,e-s+1)
            e+=1
        elif s==e:
            e+=1
        else:
            s+=1
    return best

print fast([1,2,10,10,12,14],7)
# this returns 4, as the 4 elements 10,10,12,14 can be chosen 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T21:39:32.127

尝试这种`O(N) with N size of array`方法：

```
minpos = position of closest value to B in array (binary search, O(log(N))
min = array[minpos]

if (min >= B) EXIT, no solution

// now, we just add the smallest elements from the left or the right
// until we are greater than B

leftindex = minpos - 1
rightindex = minpos + 1

while we have a valid leftindex or valid rightindex:
    add = min(abs(array[leftindex (if valid)]-B), abs(array[rightindex (if valid)]-B))
    if (min + add >= B)
        break
    min += add
    decrease leftindex or increase rightindex according to the usage

min is now our sum, rightindex the requested i (leftindex the start) 
```

（可能会发生某些索引不正确，这只是想法，而不是实现）

我猜，小 b 的平均情况是`O(log(N))`. 只有当我们可以使用整个数组时，才会发生线性情况。

我不确定，但也许这也可以在 中完成`O(log(N)*k) with N size of array and k < N`。我们必须巧妙地使用 bin 搜索在每次迭代中找到 leftindex 和 rightindex，这样每次迭代可能的结果范围就会变小。这很容易做到，但我们必须注意重复，因为它们可能会破坏我们的 bin 搜索缩减。

# d3.js - 如何使用 d3.js 更改圆圈样式

> ID：13361214
> 
> 赞同：1
> 
> 时间：2012-11-13T13:02:02.327
> 
> 标签：d3.js, force-layout

我正在尝试更改d3.js 中内置的 force-directed示例[http://bl.ocks.org/1153292 。](http://bl.ocks.org/1153292)

我想根据 Json 中的类型为圆圈创建类。我将需要使用 CSS，但我不知道如何更改代码以应用它。

这是我到目前为止修改的代码......

```
 <!DOCTYPE html>
  <html>
    <head>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8">
      <title>Mobile Patent Suits</title>
      <script type="text/javascript" src="http://mbostock.github.com/d3/d3.js?1.29.1"></script>
      <script type="text/javascript" src="http://mbostock.github.com/d3/d3.geom.js?1.29.1"></script>
      <script type="text/javascript" src="http://mbostock.github.com/d3/d3.layout.js?1.29.1"></script>
      <style type="text/css">

  circle {
    fill: #ccc;
    stroke: #333;
    stroke-width: 1.5px;
  }

  text {
    font: 10px sans-serif;
    pointer-events: none;
  }

  text.shadow {
    stroke: #fff;
    stroke-width: 3px;
    stroke-opacity: .8;
  }

      </style>
    </head>
    <body>
      <script type="text/javascript">

  // http://blog.thomsonreuters.com/index.php/mobile-patent-suits-graphic-of-the-day/
  var links = [
    {source: "t1", target: "hate", type: "green"},
    {source: "t1", target: "good", type: "green"},
    {source: "t2", target: "hate", type: "green"},
    {source: "t3", target: "good", type: "green"},
    {source: "t4", target: "good", type: "green"},
    {source: "hate", target: "airport", type: "yellow"},
    {source: "good", target: "airport", type: "yellow"},
    {source: "good", target: "flight", type: "yellow"},
  ];

  var nodes = {};

  // Compute the distinct nodes from the links.
  links.forEach(function(link) {
    link.source = nodes[link.source] || (nodes[link.source] = {name: link.source});
    link.target = nodes[link.target] || (nodes[link.target] = {name: link.target});
  });

  var w = 960,
      h = 500;

  var force = d3.layout.force()
      .nodes(d3.values(nodes))
      .links(links)
      .size([w, h])
      .linkDistance(60)
      .charge(-300)
      .on("tick", tick)
      .start();

  var svg = d3.select("body").append("svg:svg")
      .attr("width", w)
      .attr("height", h);

  var path = svg.append("svg:g").selectAll("path")
      .data(force.links())
    .enter().append("svg:path")
      .attr("class", function(d) { return "link " + d.type; })
      .attr("marker-end", function(d) { return "url(#" + d.type + ")"; });

  var circle = svg.append("svg:g").selectAll("circle")
      .data(force.nodes())
    .enter().append("svg:circle")
      .attr("r", 6)
      .call(force.drag);

  var text = svg.append("svg:g").selectAll("g")
      .data(force.nodes())
    .enter().append("svg:g");

  // A copy of the text with a thick white stroke for legibility.
  text.append("svg:text")
      .attr("x", 8)
      .attr("y", ".31em")
      .attr("class", "shadow")
      .text(function(d) { return d.name; });

  text.append("svg:text")
      .attr("x", 8)
      .attr("y", ".31em")
      .text(function(d) { return d.name; });

  // Use elliptical arc path segments to doubly-encode directionality.
  function tick() {
    path.attr("d", function(d) {
      var dx = d.target.x - d.source.x,
          dy = d.target.y - d.source.y,
          dr = Math.sqrt(dx * dx + dy * dy);
      return "M" + d.source.x + "," + d.source.y + "A" + dr + "," + dr + " 0 0,1 " + d.target.x + "," + d.target.y;
    });

    circle.attr("transform", function(d) {
      return "translate(" + d.x + "," + d.y + ")";
    });

    text.attr("transform", function(d) {
      return "translate(" + d.x + "," + d.y + ")";
    });
  }

      </script>
    </body>
  </html> 
```

有人可以给我一个提示吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:41:06.933

你有一个连接数组`links`。之后，您通过这些行从该数组中提取不同的节点：

```
 links.forEach(function(link) {
    link.source = nodes[link.source] || (nodes[link.source] = {name: link.source} );
    link.target = nodes[link.target] || (nodes[link.target] = {name: link.target});
  }); 
```

此时您应该`type`为每个节点插入 。因此，例如，我们可以为这个节点使用链接的类（然而，在这种情况下，只有一个节点的所有链接中的一个决定了它的类）。这将导致以下代码：

```
 links.forEach(function(link) {
    link.source = nodes[link.source] || (nodes[link.source] = {name: link.source, type: link.type} );
    link.target = nodes[link.target] || (nodes[link.target] = {name: link.target, type: link.type});
  }); 
```

并非所有节点都有`type`属性，而不仅仅是`name`.

稍后在此处创建圈子时

```
 var circle = svg.append("svg:g").selectAll("circle")
      .data( force.nodes() )
    .enter().append("svg:circle")
      .attr("r", 6)
      .call(force.drag); 
```

我们可以将该类型属性与一个确定每个圆形类的函数一起使用，如下所示：

```
 var circle = svg.append("svg:g").selectAll("circle")
      .data( force.nodes() )
    .enter().append("svg:circle")
      .attr("r", 6)
      .attr( 'class', function( d ) { console.log( d ); return d.type; } )
      .call(force.drag); 
```

现在所有的圈子都有各自的班级。

请注意，您可能希望确定每个节点的类型以某种方式不同，然后在此示例中。因此，相应地更改上述声明`links.forEach( ... );`。

# git - Git：尝试将本地 git 存储库同步到远程存储库

> ID：13361216
> 
> 赞同：1
> 
> 时间：2012-11-13T13:02:09.680
> 
> 标签：git

我想使用我的本地机器进行开发并使用远程服务器进行登台。我首先在远程服务器上设置了一个 git repo 并提交了文件，然后我在本地克隆了该 repo。

效果很好，但是当我尝试将更改推送到遥控器时：

```
git push origin master 
```

我收到以下错误：

> remote: error: refusing to update check out branch: refs/heads/master
> 默认情况下，在非裸存储库中更新当前分支是被拒绝的，因为它会使索引和工作树与你推送的内容不一致，并且需要'git reset --hard' 将工作树与 HEAD 匹配。
> 
> 您可以在远程存储库中将“receive.denyCurrentBranch”配置变量设置为“忽略”或“警告”，以允许推送到其当前分支；但是，除非您安排更新其工作树以匹配您以其他方式推送的内容，否则不建议这样做。
> 
> 要消除此消息并仍保持默认行为，请将“receive.denyCurrentBranch”配置变量设置为“拒绝”。

# compilation - Erlang R15B02 中的混合堆支持？

> ID：13361229
> 
> 赞同：0
> 
> 时间：2012-11-13T13:03:17.047
> 
> 标签：compilation, erlang, heap-memory, configure

Erlang R15B02 是否支持混合堆？

我运行它`configure --enable-hybrid-heap blabla...`，`make`但没有`[hybrid-heap]`显示标志：

```
$ erl
Erlang R15B02 (erts-5.9.2) [source] [64-bit halfword] [smp:16:16] [async-threads:0] [kernel-poll:false] 
```

我从这里了解了这个标志：[https ://stackoverflow.com/a/1185490/940313](https://stackoverflow.com/a/1185490/940313)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:12:11.373

实验性的混合堆实现在 R15B02 中消失了：

```
OTP-10105  Remove all code, documentation, options and diagnostic
       functions which were related to the experimental hybrid heap
       implementation. 
```

见[http://www.erlang.org/download/otp_src_R15B02.readme](http://www.erlang.org/download/otp_src_R15B02.readme)

# java - Android - 在画布中绘制位图

> ID：13361231
> 
> 赞同：7
> 
> 时间：2012-11-13T13:03:20.213
> 
> 标签：java, android, bitmap, draw, android-canvas

我目前有一个迷宫游戏，它绘制一个 5 x 5 的正方形（占用屏幕的宽度并将其均匀分割）。然后对于使用 x 和 y 坐标的每个框，我使用 drawRect 来绘制彩色背景。

我遇到的问题是我现在需要在同一位置绘制图像，因此替换当前的纯背景颜色填充。

这是我目前用于 drawRect 的代码（一些示例）：

```
// these are all the variation of drawRect that I use
canvas.drawRect(x, y, (x + totalCellWidth), (y + totalCellHeight), green);
canvas.drawRect(x + 1, y, (x + totalCellWidth), (y + totalCellHeight), green);
canvas.drawRect(x, y + 1, (x + totalCellWidth), (y + totalCellHeight), green); 
```

然后，我还需要为画布中的所有其他方块实现背景图像。此背景将在其顶部绘制简单的 1px 黑线，当前代码在灰色背景中绘制。

```
background = new Paint();
background.setColor(bgColor);
canvas.drawRect(0, 0, width, height, background); 
```

如果这是可能的，请您提出建议。如果是这样，我能做的最好的方法是什么，同时尝试最小化内存使用并拥有 1 个图像，该图像将扩展和缩小以填充相关的方形空间（这在所有不同的屏幕尺寸上都会有所不同，因为它会分割整体屏幕宽度均匀）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T13:22:01.250

使用`Canvas`方法`public void drawBitmap (Bitmap bitmap, Rect src, RectF dst, Paint paint)`。设置`dst`为您希望将整个图像缩放到的矩形的大小。

**编辑：**

这是在画布上以正方形绘制位图的可能实现。假设位图在二维数组中（例如`Bitmap bitmapArray[][];`），并且画布是方形的，因此方形位图纵横比不会失真。

```
private static final int NUMBER_OF_VERTICAL_SQUARES = 5;
private static final int NUMBER_OF_HORIZONTAL_SQUARES = 5; 
```

...

```
 int canvasWidth = canvas.getWidth();
    int canvasHeight = canvas.getHeight();

    int squareWidth = canvasWidth / NUMBER_OF_HORIZONTAL_SQUARES;
    int squareHeight = canvasHeight / NUMBER_OF_VERTICAL_SQUARES;
    Rect destinationRect = new Rect();

    int xOffset;
    int yOffset;

    // Set the destination rectangle size
    destinationRect.set(0, 0, squareWidth, squareHeight);

    for (int horizontalPosition = 0; horizontalPosition < NUMBER_OF_HORIZONTAL_SQUARES; horizontalPosition++){

        xOffset = horizontalPosition * squareWidth;

        for (int verticalPosition = 0; verticalPosition < NUMBER_OF_VERTICAL_SQUARES; verticalPosition++){

            yOffset = verticalPosition * squareHeight;

            // Set the destination rectangle offset for the canvas origin
            destinationRect.offsetTo(xOffset, yOffset);

            // Draw the bitmap into the destination rectangle on the canvas
            canvas.drawBitmap(bitmapArray[horizontalPosition][verticalPosition], null, destinationRect, null);
        }
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:06:19.297

试试下面的代码：

```
Paint paint = new Paint();
paint.setAntiAlias(true);
paint.setFilterBitmap(true);
paint.setDither(true);

canvas.drawBitmap(bitmap, x, y, paint); 
```

===================

你也可以参考这个[答案](https://stackoverflow.com/questions/7344497/android-canvas-draw-rectangle)。

# c# - GDI+ 绘制矩形很慢

> ID：13361234
> 
> 赞同：1
> 
> 时间：2012-11-13T13:03:28.537
> 
> 标签：c#, performance, gdi+

我开发了一个 Windows 窗体应用程序，用于在用户单击、按住和拖动鼠标时绘制与用户鼠标位置相关的矩形区域。

该类非常简单，如下所示：

```
public partial class MainForm : LayeredForm
{
    private bool drawing = false;
    private Point startLocation = Point.Empty;

    public MainForm()
    {
        InitializeComponent();
        Location = Screen.PrimaryScreen.Bounds.Location;
        Size = Screen.PrimaryScreen.Bounds.Size;
        Cursor = Cursors.Cross;
        TopMost = true;
        ShowInTaskbar = false;
        DoubleBuffered = true;
    }

    private void MainForm_MouseDown(object sender, MouseEventArgs e)
    {
        drawing = true;
        startLocation = e.Location;
    }

    private void MainForm_MouseMove(object sender, MouseEventArgs e)
    {
        if (drawing)
            Invalidate();
    }

    private void MainForm_MouseUp(object sender, MouseEventArgs e)
    {
        drawing = false;
    }

    private void MainForm_Paint(object sender, PaintEventArgs e)
    {
        Rectangle r = new Rectangle(Math.Min(startLocation.X, Cursor.Position.X), Math.Min(startLocation.Y, Cursor.Position.Y),
            Math.Abs(startLocation.X - Cursor.Position.X), Math.Abs(startLocation.Y - Cursor.Position.Y));

        e.Graphics.FillRectangle(Brushes.Blue, r);
    }
}

public class LayeredForm : Form
{
    public new event PaintEventHandler Paint;

    public LayeredForm()
    {
        SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
        StartPosition = FormStartPosition.Manual;
    }

    protected override CreateParams CreateParams
    {
        get
        {
            if (DesignMode) return base.CreateParams;
            CreateParams cParams = base.CreateParams;
            cParams.ExStyle = cParams.ExStyle | 0x80000;
            return cParams;
        }
    }

    private void PaintNative(Bitmap bitmap)
    {
        IntPtr hdcDestination = Win32.GetDC(IntPtr.Zero);
        IntPtr hdcSource = Win32.CreateCompatibleDC(hdcDestination);
        IntPtr hdcBitmap = IntPtr.Zero;
        IntPtr previousBitmap = IntPtr.Zero;

        try
        {
            hdcBitmap = bitmap.GetHbitmap(Color.FromArgb(0));
            previousBitmap = Win32.SelectObject(hdcSource, hdcBitmap);

            Win32.SIZE size = new Win32.SIZE(bitmap.Width, bitmap.Height);
            Win32.POINT source = new Win32.POINT(0, 0);
            Win32.POINT destination = new Win32.POINT(Left, Top);
            Win32.BLENDFUNCTION blendFunc = new Win32.BLENDFUNCTION()
            {
                BlendOp = Win32.AC_SRC_OVER,
                BlendFlags = 0,
                SourceConstantAlpha = 50,
                AlphaFormat = Win32.AC_SRC_ALPHA
            };

            Win32.UpdateLayeredWindow(Handle, hdcDestination, ref destination, ref size, hdcSource, ref source, 0, ref blendFunc, 2);
        }
        finally
        {
            Win32.ReleaseDC(IntPtr.Zero, hdcDestination);
            if (hdcBitmap != IntPtr.Zero)
            {
                Win32.SelectObject(hdcSource, previousBitmap);
                Win32.DeleteObject(hdcBitmap);
            }
            Win32.DeleteDC(hdcSource);
        }
    }

    public new void Invalidate()
    {
        using (Bitmap bitmap = new Bitmap(ClientSize.Width, ClientSize.Height))
        {
            using (Graphics graphics = Graphics.FromImage(bitmap))
            {
                if (Paint != null)
                    Paint(this, new PaintEventArgs(graphics, Rectangle.Empty));
            }
            PaintNative(bitmap);
        }
    }
} 
```

在我的电脑和其他大多数电脑上，一切都运行良好。然而，在对各种机器进行了一些测试后，我发现一些计算机在绘制矩形时遇到了困难（明显很慢，而且断断续续）。我想我已经确定了这个问题，但是我需要验证和解决这个问题。

我相信问题在于每次鼠标移动事件被触发时，整个表单都会被一次又一次地绘制。在具有大分辨率的弱计算机上，这是非常费力的。

在进行了一些研究之后，我认为解决方案是只绘制已更改的矩形部分而不是整个表单，尽管我对如何做到这一点一无所知。我非常感谢 SO 可以提供的任何帮助，在此先感谢。

## 更新

肯的​​完整代码：

```
public sealed partial class RegionForm : LayeredWindow // : Form
{
    private Bitmap bitmap;
    private bool mouseDown;
    private Point newPoint = Point.Empty;
    private Point oldPoint = Point.Empty;
    private Point startPoint = Point.Empty;

    public RegionForm()
    {
        InitializeComponent();
        Location = Screen.PrimaryScreen.Bounds.Location;
        Size = Screen.PrimaryScreen.Bounds.Size;
        Cursor = Cursors.Cross;
        TopMost = true;
        ShowInTaskbar = false;
    }

    private void regionPanel_MouseDown(object sender, MouseEventArgs e)
    {
        bitmap = new Bitmap(regionPanel.ClientSize.Width,
                            regionPanel.ClientSize.Height,
                            PixelFormat.Format32bppPArgb);

        regionPanel.DrawToBitmap(bitmap, regionPanel.ClientRectangle);
        startPoint = e.Location;
        mouseDown = true;
    }

    private void regionPanel_MouseUp(object sender, MouseEventArgs e)
    {
        mouseDown = false;

        if (bitmap != null)
        {
            bitmap.Dispose();
            bitmap = null;
        }

        Rectangle region = new Rectangle(startPoint, new Size(oldPoint.X - startPoint.X + 1,
                                                              oldPoint.Y - startPoint.Y + 1));
        regionPanel.Invalidate(region, true);
    }

    private void regionPanel_MouseMove(object sender, MouseEventArgs e)
    {
        if (mouseDown)
        {
            using (Graphics g = regionPanel.CreateGraphics())
            {
                g.SmoothingMode = SmoothingMode.None;
                newPoint = e.Location;
                ClearRegion(g);
                oldPoint = newPoint;
                DrawRegion(g);
            }
        }
    }

    private void DrawRegion(Graphics g)
    {
        int x1 = startPoint.X;
        int y1 = startPoint.Y;
        int x2 = newPoint.X;
        int y2 = newPoint.Y;

        //block "negative" selection
        if (x1 > x2)
        {
            x2 = x1;
        }
        if (y1 > y2)
        {
            y2 = y1;
        }

        //Draw a red rectangle
        g.FillRectangle(Brushes.Red, x1, y1, x2 - x1, y2 - y1);
    }

    private void ClearRegion(Graphics g)
    {
        int x1 = startPoint.X;
        int y1 = startPoint.Y;
        int x2 = oldPoint.X;
        int y2 = oldPoint.Y;

        if (x1 > x2)
        {
            x2 = x1;
        }
        if (y1 > y2)
        {
            y2 = y1;
        }

        //check left line
        if (newPoint.Y < y2)
        {
            Rectangle rectdst = new Rectangle(x1, newPoint.Y, 1, oldPoint.Y - newPoint.Y);
            g.DrawImage(bitmap, rectdst, rectdst, GraphicsUnit.Pixel);
        }

        //upper line
        if (newPoint.X < x2)
        {
            Rectangle rectdst = new Rectangle(newPoint.X, y1, oldPoint.X - newPoint.X, 1);
            g.DrawImage(bitmap, rectdst, rectdst, GraphicsUnit.Pixel);
        }

        //right line
        if (newPoint.X != x2 || newPoint.Y < y2)
        {
            int h = 0;
            int y = 0;
            if (newPoint.X == x2)
            {
                y = newPoint.Y;
                h = oldPoint.Y - newPoint.Y + 1;
            }
            else
            {
                y = startPoint.Y;
                h = oldPoint.Y - startPoint.Y + 1;
            }

            Rectangle rectdst = new Rectangle(oldPoint.X, y, 1, h);
            g.DrawImage(bitmap, rectdst, rectdst, GraphicsUnit.Pixel);
        }

        //bottom line
        if (newPoint.Y != y2 || newPoint.X < x2)
        {
            int w = 0;
            int x = 0;

            if (newPoint.Y == y2)
            {
                x = newPoint.X;
                w = oldPoint.X - newPoint.X + 1;
            }
            else
            {
                x = startPoint.X;
                w = oldPoint.X - x1 + 1;
            }

            Rectangle rectdst = new Rectangle(x, oldPoint.Y, w, 1);
            g.DrawImage(bitmap, rectdst, rectdst, GraphicsUnit.Pixel);
        }
    }

public class LayeredWindow : Form
{
    public new event PaintEventHandler Paint;

    public LayeredWindow()
    {
        SetStyle(ControlStyles.OptimizedDoubleBuffer, true);
        StartPosition = FormStartPosition.Manual;
    }

    protected override CreateParams CreateParams
    {
        get
        {
            if (DesignMode) return base.CreateParams;
            CreateParams cParams = base.CreateParams;
            cParams.ExStyle = cParams.ExStyle | 0x80000;
            return cParams;
        }
    }

    private void PaintNative(Bitmap bitmap)
    {
        IntPtr hdcDestination = Win32.GetDC(IntPtr.Zero);
        IntPtr hdcSource = Win32.CreateCompatibleDC(hdcDestination);
        IntPtr hdcBitmap = IntPtr.Zero;
        IntPtr previousBitmap = IntPtr.Zero;

        try
        {
            hdcBitmap = bitmap.GetHbitmap(Color.FromArgb(0));
            previousBitmap = Win32.SelectObject(hdcSource, hdcBitmap);

            Size size = new Size(bitmap.Width, bitmap.Height);
            Point source = new Point(0, 0);
            Point destination = new Point(Left, Top);
            Win32.BLENDFUNCTION blendFunc = new Win32.BLENDFUNCTION()
            {
                BlendOp = Win32.AC_SRC_OVER,
                BlendFlags = 0,
                SourceConstantAlpha = 50,
                AlphaFormat = Win32.AC_SRC_ALPHA
            };

            Win32.UpdateLayeredWindow(Handle, hdcDestination, ref destination, ref size, hdcSource, ref source, 0, ref blendFunc, 2);
        }
        finally
        {
            Win32.ReleaseDC(IntPtr.Zero, hdcDestination);
            if (hdcBitmap != IntPtr.Zero)
            {
                Win32.SelectObject(hdcSource, previousBitmap);
                Win32.DeleteObject(hdcBitmap);
            }
            Win32.DeleteDC(hdcSource);
        }
    }

    public new void Invalidate()
    {
        using (Bitmap bitmap = new Bitmap(ClientSize.Width, ClientSize.Height))
        {
            using (Graphics graphics = Graphics.FromImage(bitmap))
            {
                if (Paint != null)
                    Paint(this, new PaintEventArgs(graphics, Rectangle.Empty));
            }
            PaintNative(bitmap);
        }
    }
}

public sealed class Win32
{
    [DllImport("user32.dll")]
    public static extern bool HideCaret(IntPtr hWnd);

    [DllImport("user32.dll", CharSet = CharSet.Auto, ExactSpelling = true, CallingConvention = CallingConvention.Winapi)]
    public static extern short GetKeyState(int keyCode);

    [DllImport("user32.dll")]
    public static extern bool RegisterHotKey(IntPtr hWnd, int id, uint fsModifiers, uint vk);

    [DllImport("user32.dll")]
    public static extern bool UnregisterHotKey(IntPtr hWnd, int id);

    [DllImport("gdi32.dll", SetLastError = true)]
    public static extern IntPtr CreateCompatibleDC(IntPtr hdc);

    [DllImport("user32.dll")]
    public static extern IntPtr GetDC(IntPtr hWnd);

    [DllImport("gdi32.dll", ExactSpelling = true, PreserveSig = true, SetLastError = true)]
    public static extern IntPtr SelectObject(IntPtr hdc, IntPtr hgdiobj);

    [DllImport("user32.dll")]
    public static extern bool ReleaseDC(IntPtr hWnd, IntPtr hDC);

    [DllImport("gdi32.dll")]
    public static extern bool DeleteDC(IntPtr hdc);

    [DllImport("gdi32.dll")]
    public static extern bool DeleteObject(IntPtr hObject);

    [DllImport("user32.dll", ExactSpelling = true, SetLastError = true)]
    public static extern bool UpdateLayeredWindow(IntPtr hwnd, IntPtr hdcDst, ref Point pptDst, ref Size psize, IntPtr hdcSrc, ref Point pptSrc, uint crKey, [In] ref BLENDFUNCTION pblend, uint dwFlags);

    [DllImport("user32.dll")]
    public static extern IntPtr GetDesktopWindow();

    [DllImport("user32.dll")]
    public static extern IntPtr GetWindowDC(IntPtr ptr);

    [DllImport("gdi32.dll")]
    public static extern IntPtr CreateCompatibleBitmap(IntPtr hdc, int nWidth, int nHeight);

    [DllImport("gdi32.dll")]
    public static extern bool BitBlt(IntPtr hdcDest, int xDest, int yDest, int wDest, int hDest, IntPtr hdcSource, int xSrc, int ySrc, CopyPixelOperation rop);

    [DllImport("user32.dll")]
    public static extern IntPtr GetForegroundWindow();

    [DllImport("user32.dll")]
    public static extern bool GetWindowRect(IntPtr hWnd, out RECT rect);

    public const byte AC_SRC_OVER = 0;
    public const byte AC_SRC_ALPHA = 1;
    public const byte ULW_ALPHA = 2;

    [StructLayout(LayoutKind.Sequential, Pack = 1)]
    public struct BLENDFUNCTION
    {
        public byte BlendOp;
        public byte BlendFlags;
        public byte SourceConstantAlpha;
        public byte AlphaFormat;
    }

    [StructLayout(LayoutKind.Sequential)]
    public struct RECT
    {
        public int Left;
        public int Top;
        public int Right;
        public int Bottom;
    }

} 
```

解决方案下载：[http ://www.mediafire.com/?b9ql4pzh69u10n4](http://www.mediafire.com/?b9ql4pzh69u10n4)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-18T06:29:21.920

You need to draw it from the `MouseMove` event. Invalidating the whole control will be slow on some computers/resolutions.

UPDATE:

This code will draw and clear the rectangle for selected region in a highly optimized way.

The routine draws a rectangle on `MouseMove`, but only clears fragments of the lines as needed. That is if the region is smaller than the previous size only the outer parts of the lines are cleared from the stored bitmap.

Due to this there is no need to enable double-buffering.

In order to get the buffered bitmap of the window in correct position as source copy we need to implement a small trick:

*   Add a `Panel` (panFill in this example) to the form and set docking to fill.
*   Add all controls / background image to the panel, not the form

Now we can copy the bitmap we need later from the `Panel` instead of the `Form`. The reason we need this is that using `this.DrawBitmap()` will draw borders and title-bar to the bitmap too and we don't want that. Using the `Panel` will eliminate this.

In the global scope of the form's class we set:

```
Bitmap bmp = null;
bool inDrag = false;
Point regStart = Point.Empty;
Point regNew = Point.Empty;
Point regOld = Point.Empty; 
```

On the Panel's MouseDown/Up event:

```
private void panFill_MouseDown(object sender, MouseEventArgs e)
{
    //Create a bitmap
    bmp = new Bitmap(panFill.ClientSize.Width, _
                     panFill.ClientSize.Height, _
                     Imaging.PixelFormat.Format32bppPArgb);

    panFill.DrawToBitmap(bmp, panFill.ClientRectangle);

    //store origo/start point and mark that we're active
    regStart = e.Location;
    inDrag = true;
}

private void panFill_MouseUp(object sender, MouseEventArgs e)
{
    inDrag = false;

    //we're done, clean up resources if any
    if (bmp != null) {
        bmp.Dispose();
        bmp = null; //use as marker for this check
    }

    //clean up by redrawing panel
    Rectangle r = new Rectangle(regStart, _
                                new Size(regOld.X - regStart.X + 1, _
                                         regOld.Y - regStart.Y + 1));
    panFill.Invalidate(r, true);

} 
```

In our `MouseMove` event we call clear and draw a new rectangle:

```
private void panFill_MouseMove(object sender, MouseEventArgs e)
{
    if (inDrag) {

        using (Graphics g = panFill.CreateGraphics) {
            g.SmoothingMode = Drawing2D.SmoothingMode.None;

            //we store new pos. here as it's used to calculate
            //delta for what we need to redraw
            regNew = e.Location;
            ClearRegion(g);

            regOld = regNew;
            DrawRegion(g);
            }
        }
} 
```

The function to draw the rectangle is pretty straight forward:

```
private void DrawRegion(Graphics g)
{
    int x1 = regStart.X;
    int y1 = regStart.Y;
    int x2 = regNew.X;
    int y2 = regNew.Y;

    //block "negative" selection
    if (x1 > x2) {
        x2 = x1;
    }
    if (y1 > y2) {
        y2 = y1;
    }

    //Draw a red rectangle
    g.DrawRectangle(Pens.Red, x1, y1, x2 - x1, y2 - y1);
} 
```

The next method holds all the magic optimized to only draw what is needed. It achieve this by checking the two main lines from origo and if the length has shrunk. If so it calculate the delta for the old position and the new position and only redraws the "gap".

For the two other lines if do the same if the tangent position is the same, if not it redraws the whole line.

```
private void ClearRegion(Graphics g)
{
    int x1 = regStart.X;
    int y1 = regStart.Y;
    int x2 = regOld.X;
    int y2 = regOld.Y;

    if (x1 > x2) {
        x2 = x1;
    }
    if (y1 > y2) {
        y2 = y1;
    }

    //check left line
    if (regNew.Y < y2) {
        Rectangle rectdst = new Rectangle(x1, regNew.Y, 1, regOld.Y - regNew.Y);
        g.DrawImage(bmp, rectdst, rectds, GraphicsUnit.Pixel);
    }

    //upper line
    if (regNew.X < x2) {
        Rectangle rectdst = new Rectangle(regNew.X, y1, regOld.X - regNew.X, 1);
        g.DrawImage(bmp, rectdst, rectdst, GraphicsUnit.Pixel);
    }

    //right line
    if (regNew.X != x2 || regNew.Y < y2) {
        int h = 0;
        int y = 0;
        if (regNew.X == x2) {
            y = regNew.Y;
            h = regOld.Y - regNew.Y + 1;
        } else {
            y = regStart.Y;
            h = regOld.Y - regStart.Y + 1;
        }

        Rectangle rectdst = new Rectangle(regOld.X, y, 1, h);
        g.DrawImage(bmp, rectdst, rectdst, GraphicsUnit.Pixel);
    }

    //bottom line
    if (regNew.Y != y2 || regNew.X < x2) {
        int w = 0;
        int x = 0;

        if (regNew.Y == y2) {
            x = regNew.X;
            w = regOld.X - regNew.X + 1;
        } else {
            x = regStart.X;
            w = regOld.X - x1 + 1;
        }

        Rectangle rectdst = new Rectangle(x, regOld.Y, w, 1);
        g.DrawImage(bmp, rectdst, rectdst, GraphicsUnit.Pixel);

    }
} 
```

This is the, I would say, the most you can get out of GDI+ on a form. Different approaches involved DirectX and more low-level stuff. By limiting what is redrawn based on need, the speed is optimal.

Also notice that the bitmap copy of the fill panel is PARG which is the fastest type as alpha is pre-multiplied. I am, although not necessary in this case, setting smoothing mode to none so the lines will keep themselves sharp without any aliasing leaking.

On a Windows XP 32-bit, 2 GB memory and Atom CPU this runs smooth as it gets.

Note: original code is written in VB and translated to C#. Some errors may occure - adjust as needed. Add handlers as needed.

The original VB code for those interested:

```
Public Class Form1

    Private bmp As Bitmap = Nothing
    Private inDrag As Boolean = False
    Private regStart As Point = Point.Empty
    Private regNew As Point = Point.Empty
    Private regOld As Point = Point.Empty

    Public Event RegionSelected(r As Rectangle)

    Private Sub panfill_MouseDown(sender As Object, e As System.Windows.Forms.MouseEventArgs) Handles panFill.MouseDown

        bmp = New Bitmap(panFill.ClientSize.Width, panFill.ClientSize.Height, Imaging.PixelFormat.Format32bppPArgb)
        panFill.DrawToBitmap(bmp, panFill.ClientRectangle)

        regStart = e.Location

        inDrag = True

    End Sub
    Private Sub panFill_MouseMove(sender As Object, e As System.Windows.Forms.MouseEventArgs) Handles panFill.MouseMove

        If inDrag Then
            Using g As Graphics = panFill.CreateGraphics

                g.SmoothingMode = Drawing2D.SmoothingMode.None

                regNew = e.Location

                ClearRegion(g)

                regOld = regNew

                DrawRegion(g)

            End Using

        End If

    End Sub
    Private Sub panFill_MouseUp(sender As Object, e As System.Windows.Forms.MouseEventArgs) Handles panFill.MouseUp

        inDrag = False

        If bmp IsNot Nothing Then
            bmp.Dispose()
            bmp = Nothing
        End If

        Dim r As New Rectangle(regStart, New Size(regOld.X - regStart.X + 1, regOld.Y - regStart.Y + 1))
        panFill.Invalidate(r, True)

        RaiseEvent RegionSelected(r)

    End Sub
    Private Sub DrawRegion(g As Graphics)

        Dim x1, y1, x2, y2 As Integer
        x1 = regStart.X
        y1 = regStart.Y
        x2 = regNew.X
        y2 = regNew.Y

        If x1 > x2 Then
            x2 = x1
        End If
        If y1 > y2 Then
            y2 = y1
        End If

        g.DrawRectangle(Pens.Red, x1, y1, x2 - x1, y2 - y1)

    End Sub
    Private Sub ClearRegion(g As Graphics)

        Dim x1, y1, x2, y2 As Integer

        x1 = regStart.X
        y1 = regStart.Y
        x2 = regOld.X
        y2 = regOld.Y

        If x1 > x2 Then
            x2 = x1
        End If
        If y1 > y2 Then
            y2 = y1
        End If

        'left line
        If regNew.Y < y2 Then

            Dim rectdst As New Rectangle(x1, regNew.Y, 1, regOld.Y - regNew.Y)
            g.DrawImage(bmp, rectdst, rectdst, GraphicsUnit.Pixel)

        End If

        'upper line
        If regNew.X < x2 Then

            Dim rectdst As New Rectangle(regNew.X, y1, regOld.X - regNew.X, 1)
            g.DrawImage(bmp, rectdst, rectdst, GraphicsUnit.Pixel)

        End If

        'right line
        If regNew.X <> x2 OrElse regNew.Y < y2 Then

            Dim h, y As Integer
            If regNew.X = x2 Then
                y = regNew.Y
                h = regOld.Y - regNew.Y + 1
            Else
                y = regStart.Y
                h = regOld.Y - regStart.Y + 1
            End If

            Dim rectdst As New Rectangle(regOld.X, y, 1, h)
            g.DrawImage(bmp, rectdst, rectdst, GraphicsUnit.Pixel)

        End If

        'bottom line
        If regNew.Y <> y2 OrElse regNew.X < x2 Then

            Dim w, x As Integer
            If regNew.Y = y2 Then
                x = regNew.X
                w = regOld.X - regNew.X + 1
            Else
                x = regStart.X
                w = regOld.X - x1 + 1
            End If

            Dim rectdst As New Rectangle(x, regOld.Y, w, 1)
            g.DrawImage(bmp, rectdst, rectdst, GraphicsUnit.Pixel)

        End If

    End Sub

End Class 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-14T11:44:46.840

好的，亚历克斯，这里是您要求的代码示例。

首先，您必须在自己绘制的控件上设置一些样式。这是 DoubleBuffered、AllPaintingInWmPaint 和 UserPaint。这样可以避免闪烁（参见[此示例](http://www.codeproject.com/Articles/12870/Don-t-Flicker-Double-Buffer)）。其次，不要在 MouseMove 事件本身中进行绘制。记住绘制所需的所有数据并调用 Invalidate。在覆盖方法“Control.OnPaint”或事件“Cotrol.Paint”中进行所有绘画。我还添加了一个 KeyPress 处理程序，以便我可以再次关闭您的 RegionForm。

在 MouseDown 事件中，我记得鼠标光标的位置和控件的当前外观（位图）。在 MouseMove 时，我计算鼠标按下位置和当前鼠标光标位置之间的向量（距离）。如果用户转到鼠标向下点的左上角，这也有效。这个矩形是必须绘制的新区域。但我们还必须使旧区域无效。这就是为什么我计算一个包含旧区域和新区域的联合矩形。该联合用于调用“Control.Invalidate”。只需绘制已保存图像的特定部分即可清除旧区域。

```
public sealed partial class RegionForm : Form
{
    private Bitmap bitmap;
    private bool mouseDown;
    private Rectangle newRegion;
    private Rectangle oldRegion;
    private Point startPoint;

    public RegionForm()
    {
        InitializeComponent();
        Location = Screen.PrimaryScreen.Bounds.Location;
        Size = Screen.PrimaryScreen.Bounds.Size;
        Cursor = Cursors.Cross;
        TopMost = true;
        ShowInTaskbar = false;

        this.SetStyle(
            ControlStyles.UserPaint |
            ControlStyles.AllPaintingInWmPaint |
            ControlStyles.DoubleBuffer, true);
    }

    protected override void OnKeyPress(KeyPressEventArgs e)
    {
        base.OnKeyPress(e);

        if (e.KeyChar == (char)Keys.Escape)
            this.Close();
    }

    protected override void OnMouseDown(MouseEventArgs e)
    {
        base.OnMouseDown(e);

        bitmap = new Bitmap(this.ClientSize.Width,
                    this.ClientSize.Height,
                    PixelFormat.Format32bppPArgb);

        this.DrawToBitmap(bitmap, this.ClientRectangle);
        startPoint = e.Location;
        mouseDown = true;
    }

    protected override void OnMouseUp(MouseEventArgs e)
    {
        base.OnMouseUp(e);

        mouseDown = false;

        if (bitmap != null)
        {
            bitmap.Dispose();
            bitmap = null;
        }

        // reset regions
        newRegion = Rectangle.Empty;
        oldRegion = Rectangle.Empty;

        // invalidate all
        Invalidate(true);
    }

    protected override void OnMouseMove(MouseEventArgs e)
    {
        base.OnMouseMove(e);

        if (mouseDown)
        {
            // calculate new region
            var vector = Point.Subtract(e.Location, new Size(startPoint));
            newRegion = new Rectangle(System.Math.Min(startPoint.X, e.Location.X), System.Math.Min(startPoint.Y, e.Location.Y), System.Math.Abs(vector.X), System.Math.Abs(vector.Y));

            // invalidate only the area of interest
            var invalidate = Rectangle.Union(oldRegion, newRegion);
            Invalidate(invalidate, true);
        }
    }

    protected override void OnPaint(PaintEventArgs e)
    {
        base.OnPaint(e);

        e.Graphics.SmoothingMode = SmoothingMode.None;

        ClearRegion(e.Graphics, bitmap, oldRegion);
        DrawRegion(e.Graphics, newRegion);

        // remember which region has been handled
        oldRegion = newRegion;
    }

    static void DrawRegion(Graphics g, Rectangle region)
    {
        if (g == null || region == Rectangle.Empty)
            return;

        //Draw a red rectangle
        g.FillRectangle(Brushes.Red, region);
    }

    static void ClearRegion(Graphics g, Bitmap bitmap, Rectangle region)
    {
        if (g == null || region == Rectangle.Empty || bitmap == null)
            return;

        // take only the selected region from the original image and draw that part
        g.DrawImage(bitmap, region, region, GraphicsUnit.Pixel);
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-06T14:58:45.970

这在很大程度上取决于表单上可见的内容。例如，如果您自己绘制大量自己的对象，则需要在每个鼠标移动事件上使完整的表单无效。

否则，您只需使特定区域无效。然后您需要使用背景颜色清除该区域并调用完全或部分位于该区域中的所有对象以重新绘制它们自己。之后，您可以绘制 DragDrop 光标/图形。

大多数情况下，确定无效区域中的对象太复杂了。

# azure - 如何使用 web deploy 在 Windows Azure 中部署子站点

> ID：13361235
> 
> 赞同：3
> 
> 时间：2012-11-13T13:03:36.287
> 
> 标签：azure, web-deployment, azure-web-roles

我有一个 Web 角色，可以使用不同的端口号访问多个站点。例如（主站点）[http://site.cloudapp.net](http://site.cloudapp.net)，（子站点[）](http://site.cloudapp.net:8081)[http://site.cloudapp.net:8080，http://site.cloudapp.net:8081](http://site.cloudapp.net:8080)

我可以使用 web deploy 来部署主站点。如何使用 web deploy 来部署子站点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-17T05:41:48.460

您可以通过在子应用程序前面加上父站点名称来部署它。例如`mysite/myapplication`. 如果您需要，[ScottGu 的博客会提供更多详细信息。](http://weblogs.asp.net/scottgu/archive/2010/09/13/automating-deployment-with-microsoft-web-deploy.aspx)

但是，我会更担心，因为您说您使用 Azure Web 角色执行此操作，该角色部署在具有临时磁盘的虚拟机上（如果硬件出现故障或需要重新部署，则非持久性）。如果 Azure 将您的 Web 角色重新部署到另一个 VM，您的“Web 部署”更改将丢失，并且您的 cspkg 的内容将被重新部署。如果您真的想使用 Web 部署，您应该考虑使用 Azure 网站或 Azure 虚拟机，否则为确保您的更改不会丢失，您需要重新发布完整的 cspkg 文件并允许 Azure 将更改部署到您的所有实例。

# matlab - 根据索引列表从数组中提取固定数量的数据

> ID：13361240
> 
> 赞同：3
> 
> 时间：2012-11-13T13:03:50.373
> 
> 标签：matlab, bsxfun

我有数组

```
a=1:20 
```

以及一系列指示我想从哪里开始提取数据的索引：

```
i=[4,12] 
```

对于每个 index `i`，我想要该索引和列或行中的接下来的四个（嗯`x`，真的）元素。我将避免接近数组的末尾，以便可以忽略特殊情况。

如果我对此进行硬编码，我可以使用：

```
a([4:8;12:16]) 
```

这将达到我的结果。

但`i`可能有许多不同的值。

关于如何将索引列表转换为范围矩阵或解决此问题的其他方法的任何想法？

**编辑** 我正在使用 Matlab 2007；如果解决方案仅依赖于 Matlab 的内部结构和工具箱​​，那将是更好的选择。`bsxfun`直到 2007a 才出现。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:08:28.277

除了 中的元素之外，让`i`您的索引x 和`x`您想要的元素数量`i`，然后您可以使用

```
i = [4 6 8];
x = 4; 

bsxfun(@plus, 0:x, i(:)) 
```

得到一个索引矩阵：

```
ans =

     4     5     6     7     8
     6     7     8     9    10
     8     9    10    11    12 
```

如果您无权访问，`bsxfun`则可以`repmat`改用：

```
i = [4 6 8];
x = 4; 

repmat(i(:), 1, x+1) + repmat(0:x, length(i), 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:23:56.887

这是一个没有 bsxfun 但受先前答案启发的 repmat 的解决方案。

```
i = [4 6 8];
x = 4;
p = repmat(1:x,length(i),1);
q = repmat(i',1,x);
p+q 
```

# python - Sublime text：如何获取当前视图的文件名

> ID：13361241
> 
> 赞同：11
> 
> 时间：2012-11-13T13:03:50.237
> 
> 标签：python, plugins, sublimetext2, filenames, delete-file

我正在尝试编写一个小插件来删除当前文件并关闭活动视图。由于某种原因 self.view.file_name() 总是返回 None。

我是 Python 新手，我不知道为什么它不能这样工作。根据[API 参考](http://www.sublimetext.com/docs/2/api_reference.html#sublime.View)file_name() 返回当前视图的文件名。

```
import sublime, sublime_plugin, send2trash

class DeleteCurrentFileCommand(sublime_plugin.TextCommand):
    def run(self, edit):        
        f = self.view.file_name()
        if (f is None):
            return

        send2trash.send2trash(f)
        self.view.window().run_command('close') 
```

dir（self.view）的输出：

> [' **class** ',' **delattr** ',' **dict** ',' **doc** ',' **format** ',' **getattribute** ',' **hash** ',' **init** ',' **len** ',' **module** ',' **new** ',' **reduce** ',' **reduce_ex** '，' **repr** '，' **setattr** '，' **sizeof** '，' **str** '，' **subclasshook** '，' **weakref**'，'add_regions'，'begin_edit'，'buffer_id'，'classify'，'command_history'，'em_width'，'encoding'，'end_edit'，'erase'，'erase_regions'，'erase_status'，'extract_completions'， 'extract_scope'、'file_name'、'find'、'find_all'、'find_all_results'、'find_by_selector'、'fold'、'folded_regions'、'full_line'、'get_regions'、'get_status'、'get_symbols'、'has_non_empty_selection_region '，'id'，'indentation_level'，'indented_region'，'insert'，'is_dirty'，'is_folded'，'is_loading'，'is_read_only'，'is_scratch'，'layout_extent'，'layout_to_text'，'line'， 'line_endings'，'line_height'，'lines'，'match_selector'，'meta_info'，'name'，'replace'，'retarget'，'rowcol'，'run_command'，'scope_name'，'score_selector'，'sel' ，'set_encoding'，'set_line_endings'，'set_name'，'set_read_only'，'set_scratch'，'set_status'，'set_syntax_file'，'set_viewport_position'，'settings'，'show'，'show_at_center'，'size'，' split_by_newlines'，'substr'，'syntax_name'，'text_point'，'text_to_layout'，'unfold'，'viewport_extent'，'viewport_position'，'visible_region'，'window'，'word']match_selector'，'meta_info'，'name'，'replace'，'retarget'，'rowcol'，'run_command'，'scope_name'，'score_selector'，'sel'，'set_encoding'，'set_line_endings'，'set_name' 、'set_read_only'、'set_scratch'、'set_status'、'set_syntax_file'、'set_viewport_position'、'settings'、'show'、'show_at_center'、'size'、'split_by_newlines'、'substr'、'syntax_name'、' text_point'，'text_to_layout'，'展开'，'viewport_extent'，'viewport_position'，'visible_region'，'window'，'word']match_selector'，'meta_info'，'name'，'replace'，'retarget'，'rowcol'，'run_command'，'scope_name'，'score_selector'，'sel'，'set_encoding'，'set_line_endings'，'set_name' 、'set_read_only'、'set_scratch'、'set_status'、'set_syntax_file'、'set_viewport_position'、'settings'、'show'、'show_at_center'、'size'、'split_by_newlines'、'substr'、'syntax_name'、' text_point'，'text_to_layout'，'展开'，'viewport_extent'，'viewport_position'，'visible_region'，'window'，'word']run_command'、'scope_name'、'score_selector'、'sel'、'set_encoding'、'set_line_endings'、'set_name'、'set_read_only'、'set_scratch'、'set_status'、'set_syntax_file'、'set_viewport_position'、'settings' , 'show', 'show_at_center', 'size', 'split_by_newlines', 'substr', 'syntax_name', 'text_point', 'text_to_layout', '展开', 'viewport_extent', 'viewport_position', 'visible_region', '窗口'，'单词']run_command'、'scope_name'、'score_selector'、'sel'、'set_encoding'、'set_line_endings'、'set_name'、'set_read_only'、'set_scratch'、'set_status'、'set_syntax_file'、'set_viewport_position'、'settings' , 'show', 'show_at_center', 'size', 'split_by_newlines', 'substr', 'syntax_name', 'text_point', 'text_to_layout', '展开', 'viewport_extent', 'viewport_position', 'visible_region', '窗口'，'单词']set_viewport_position'、'settings'、'show'、'show_at_center'、'size'、'split_by_newlines'、'substr'、'syntax_name'、'text_point'、'text_to_layout'、'unfold'、'viewport_extent'、'viewport_position' , 'visible_region', 'window', 'word']set_viewport_position'、'settings'、'show'、'show_at_center'、'size'、'split_by_newlines'、'substr'、'syntax_name'、'text_point'、'text_to_layout'、'unfold'、'viewport_extent'、'viewport_position' , 'visible_region', 'window', 'word']

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-19T14:36:57.137

根据[非官方文档的插件页面](https://sublime-text-unofficial-documentation.readthedocs.org/en/latest/extensibility/plugins.html?highlight=ApplicationCommand#conventions-for-command-names)，Sublime Text 通过以下方式规范化命令名称：

1.  去掉“命令”后缀
2.  用下划线分隔驼峰式短语

因此，应按以下方式调用 DeleteCurrentFileCommand： `view.run_command("delete_current_file")`

使用此命令，我能够在 Python 控制台中完全按照上面列出的方式运行您的插件。

但是，如果我尝试运行`view.run_command("DeleteCurrentFile")`，那么控制台将显示一个空行。这可能导致 self.view.file_name() 返回 None 的想法。

# c# - 尝试使用 DPAPI 保护数据时被拒绝访问

> ID：13361242
> 
> 赞同：3
> 
> 时间：2012-11-13T13:03:50.997
> 
> 标签：c#, .net, dpapi

我正在 Windows 8 上开发 ac# .net 3.5 应用程序。

我需要使用 DPAPI 加密数据。它在我的所有机器上都可以正常工作，除了一台机器出现以下异常：System.Security.Cryptography.CryptographicException 消息：访问被拒绝。

```
 byte[] bytes;
 bytes = ProtectedData.Protect(Encoding.UTF8.GetBytes(argsStr.ToString()), null, DataProtectionScope.CurrentUser); 
```

当我将 DataProtectionScope.CurrentUser 更改为 DataProtectionScope.LocalMachine 时，它​​可以正常工作。

似乎有人拒绝了当前用户执行 DAPI 加密的访问权限

我能做些什么来解决这个问题？

失败的应用程序是在当前登录用户下运行的控制台应用程序。

当使用提升的权限运行应用程序时，它仍然失败并拒绝访问。

我尝试重置登录密码，它解决了这个问题。

怎么会发生这样的事情？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-01T07:42:38.777

发生这种情况是因为 DPAPI 的 MasterKey 不同步。典型的原因是：

*   以管理方式更改密码（不提供旧密码且不在域中 - 网络用户管理员密码）
*   第三方认证包

您可以使用 CryptProtectData(CRYPTPROTECT_CRED_SYNC) 在代码中手动同步 MasterKey

问候，文森特

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-01-05T12:03:16.713

当用户没有在 Windows 7 上定义密码时，我遇到了同样的问题。解决方案是为用户设置密码。

# highcharts - Highcharts 列范围不播列

> ID：13361243
> 
> 赞同：0
> 
> 时间：2012-11-13T13:04:05.397
> 
> 标签：highcharts

[http://jsfiddle.net/Sq9SL/2/](http://jsfiddle.net/Sq9SL/2/)

我认为我的 Json 数据可能有问题，导致没有列。

```
Can someone help me identity what the problem is please 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:10:36.940

原来 JSON 需要首先有最小的数字

所以像这样的数据值

```
[1517443200000,123808,101168] 
```

应该

```
[1517443200000,101168,123808] 
```

# java - 从文件中读取位

> ID：13361246
> 
> 赞同：0
> 
> 时间：2012-11-13T13:04:10.470
> 
> 标签：java, file, bits

我如何从文件中读取位？我写了一些类似的文件：

```
File plik=new File("bitowo");
  FileOutputStream fos=new FileOutputStream(plik);
  byte[] test =new byte[2];
  test[0]=(byte)01101000;
  test[1]=(byte)10101010;
  fos.write(test);
  fos.close(); 
```

并且“bitowo”只有 2 个字节，但我怎样才能从文件“bitowo”中逐位读取？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:16:32.750

这个：

```
test[0]=(byte)01101000;
test[1]=(byte)10101010; 
```

不做你认为它做的事。具体来说，它不会使用代码似乎建议的位模式写入两个字节。

该数字`01101000`将被解释为八进制整数文字，因为它以`0`. 在十进制中，这将是数字`295424`。当您将其转换为 a`byte`时，仅保留低 8 位，而那些恰好是`0`. 所以文件中的第一个字节是`0`.

该数字`10101010`将被解释为十进制整数文字（数字千万、十万一千零）。同样，通过将其转换为`byte`，仅保留低 8 位，因此文件中的第二个字节将包含值`18`（十进制）。

如果您使用的是 Java 7，则可以在代码中使用二进制文字，方法是在数字前加上`0b`:

```
test[0]=(byte)0b01101000;
test[1]=(byte)0b10101010; 
```

要读回这两个字节，只需用 a 打开文件`FileInputStream`并从中读取两个字节。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T13:05:38.757

你不能逐位阅读。您*可以* [逐字节读取](http://docs.oracle.com/javase/6/docs/api/java/io/InputStream.html#read%28%29)，然后逐位[移动字节。](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/op3.html)

# python - 使用 SWIG 为 C++ 类创建 python 包装器

> ID：13361247
> 
> 赞同：2
> 
> 时间：2012-11-13T13:04:16.383
> 
> 标签：python, swig

我有 C++ 目标文件

例如：example1.o 和 example2.o

1.  是否可以使用 SWIG 创建一个 python 包装类？
2.  如果是，我如何使用 SWIG 创建

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:22:45.320

您可以在没有 C++ 源文件的情况下创建包装器，但您需要头文件，因为您将为 Python 包装器生成定义的接口文件需要 C++ 头文件。

可以通过以下示例命令生成使用接口文件包装器：

```
swig -c++ -python example.i
g++ -fpic -c example_wrap.cxx -I /usr/include/python2.7/
g++ --shared example.o example_wrap.o  -o _example.so 
```

example.o 是您已经拥有的目标文件。然后，您可以启动 Python 解释器并键入`import example`以验证它是否正常工作。

# c# - 如何使用 OleDbConnection 从 Excel 文件中检索数据

> ID：13361248
> 
> 赞同：2
> 
> 时间：2012-11-13T13:04:20.137
> 
> 标签：c#, .net, oledb, com-interop

问题是我只需要从 Excel 中的数据中选择 2 列，所以我继续使用 sql 从 Excel 文件中检索数据。但是这次我不断收到“无法创建文件”错误，当我尝试打开我的连接时会发生这种情况。为什么要尝试创建文件？

我的代码：

```
public void ReadExcelFile()
{
    string connectionString = string.Format(ConfigurationManager.ConnectionStrings["ExcelConnection"].ConnectionString.Replace("'", "\""), "@C:/Temp/Copy.xlsx");
    using (OleDbConnection connection = new OleDbConnection(connectionString))
    {
        try
        {
            connection.Open();
            string sqlCmd = "SELECT  * FROM [Ark1$]";
            using (OleDbCommand command = new OleDbCommand(sqlCmd, connection))
            {
                command.CommandType = System.Data.CommandType.Text;
                using (OleDbDataReader reader = command.ExecuteReader())
                {
                    while (reader.Read())
                    {
                        Console.WriteLine(reader.ToString());
                    }
                }
            }

        }
        catch (Exception exception)
        {
            Console.WriteLine("ERROR in ReadExcelFile() method. Error Message : " + exception.Message);
        }
    }
} 
```

谁能帮我这个 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:16:57.560

** 已编辑 **

像这样测试它： -

```
string filename = "@C:\Temp\Copy.xlsx";

OleDbConnection con = new OleDbConnection(
"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=" + 
filename + ";Extended Properties=\Excel 8.0;HDR=YES;IMEX=1\""); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T08:54:10.913

要为读取 Excel 文件配置 OleBConnection，请尝试以下操作：

```
string filename = "@C:\Temp\Copy.xlsx";       

OleDbConnection connection =new OleDbConnection(
                         "provider=Microsoft.Jet.OLEDB.4.0;Data Source='"+filename+"';"+
                         "Extended Properties=Excel 8.0;"); 
```

# layout - (Py)Qt：管理动态创建的自定义 QWidget 布局的最佳实践

> ID：13361249
> 
> 赞同：2
> 
> 时间：2012-11-13T13:04:22.580
> 
> 标签：layout, pyqt

我有一个 QMainWindow 有各种小部件，加载了 loadUI。其中一个小部件是一个 QGroupBox，它在开始时是空的（也没有布局）。我还有一个自定义小部件 (CustomWidgetContainer)，它在其内部创建各种小部件 (CustomWidget)。有多少和哪个是在运行时确定的。

问题是 CustomWidgetContainer 有自己的布局来添加它的小部件。但是当 CustomWidgetContainer 被添加到 QMainWindow 时，布局将替换为 QMainWindow 的父级布局（这是预期的和记录的行为）。

但是当这个 CustomWidgetContainer 需要自己的布局 (self.layout()) 来添加额外的 CustomWidgets 或删除所有 CustomWidgets 时，self.layout() 返回 None。

我可以想象各种解决方法检查父级是否已经有一个布局（使用那个，在父级中设置一个等）等等。但是我不想对我的孩子（CustomWidgetContainer）类的父母（QMainWindow）做任何事情，因为我认为这是一种不好的做法。

片段：ScalarInputEdit == CustomWidget，InputsWidget == CustomWidgetContainer

```
class MainWindow(qt.QMainWindow):
    ....
    def connect(self, host, port):
        self._client = PymotClient(host, port)
        self.client.connect()        
        self._set_enabled_connected()
        self.log.info("Connected to %s:%d", host, port)

        self._inputswidget = InputsWidget(self, self.client)
        print "Layout Before:", self._inputswidget.layout()
        self.inputsBox.setLayout(self._inputswidget.layout())
        print "Layout After:", self._inputswidget.layout()
        self._inputswidget.append_inputs_from_client()

class InputsWidget(qt.QWidget):
    def __init__(self, parent, client):
        super(InputsWidget, self).__init__(parent)
        ....
        self.setLayout(qt.QGridLayout())

    def append_inputs_from_client(self):
        for inp in some_list:
           self.append_input(inp)

    def append_input(self, pbo):
        self.layout().addWidget(ScalarInputEdit(self, self.client, pbo))

    def remove_all_inputs(self):
        for child in self.layout().children():
            child.deleteLater() 
```

输出：

```
Layout Before: <PyQt4.QtGui.QGridLayout object at 0x8880ecc> 
Layout After: None
Exception: 
  File    "...inputwidgets.py", line 134, in append_input
    self.layout().addWidget(ScalarInputEdit(self, self.client, pbo))
AttributeError: 'NoneType' object has no attribute 'addWidget' 
```

这样做的标准/良好做法是什么？对我来说，在以后的某个阶段（在 __ init__ 之后）需要您的 layout() 似乎很常见。但是由于某些用例似乎取代了我的布局，或者更糟糕的是甚至将其删除，我如何确定要添加/删除的布局？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T17:28:00.120

引用：

```
when the CustomWidgetContainer gets added to the QMainWindow, the layout is
replaced with the parenting layout of the QMainWindow (which is expected and
documented behaviour). 
```

这对我来说很不清楚：您指的是什么记录在案的行为？

```
self._inputswidget = InputsWidget(self, self.client)
print "Layout Before:", self._inputswidget.layout()
self.inputsBox.setLayout(self._inputswidget.layout()) 
```

为什么将布局设置为`inputsBox`布局`_inputswidget`？

```
print "Layout After:", self._inputswidget.layout() 
```

的布局`_inputswidget`很自然会是`None`现在，因为您刚刚将其*转移*到`inputsBox`.

```
self._inputswidget.append_inputs_from_client() 
```

显然，这是行不通的，因为你拿走了 的布局`_inputswidget`，并没有替换它。

# codeigniter - mod_rewrite 与 codeigniter

> ID：13361257
> 
> 赞同：0
> 
> 时间：2012-11-13T13:04:43.683
> 
> 标签：codeigniter, mod-rewrite

我使用共享主机。我用 codeigniter 构建了我的 web 应用程序，我的新 web 目录如下：

```
/home/projName/public_html/proj_v3/ 
```

在这个目录下，有index.php、.htaccess。如上所示，我将不同的项目版本分隔在不同的目录中（即：proj_v1、proj_v2、proj_v3）。Web 应用程序允许上传照片，它存储在**/home/projName/public_html/proj_v3/application/uploads**中。**proj_v2**目前有最新上传的照片，因为它仍在使用中。因为我有不同版本的项目，所以我想将目录上传放在一个公共目录中，例如**/home/projName/public_html**。这样对于任何新版本的项目，我都不必将上传文件夹移动到新项目文件夹。这可能会导致停机。

目前，**/home/projName/public_html/proj_v2**中的 .htaccess 文件是：

```
Options -indexes
DirectoryIndex index.php
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php/$1/ [L] 
```

**我在/home/projName/public_html/**中有另一个 .htaccess是：

```
Options All -Indexes
RewriteEngine On
Rewriterule ^(.*)\.*$  proj_v3/index.php/$1/
RewriteOptions MaxRedirects=3 
```

基本上我应该如何编辑 /home/projName/public_html/ 中的第二个**.htaccess**文件，以便如果 web 目录是**domain.com/uploads/image.png**，它会从**/home/projName/public_html/uploads**获取图像. 目前，第二个**.htaccess**文件告诉**domain.com**指向**/home/projName/public_html/proj_v3**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:30:50.983

您要做的是允许真实文件和文件夹的路径存在，同时将其他所有内容重定向到 CodeIgniter，您可以在第二个 .htaccess 文件中使用它来实现这一点：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

绝对值得阅读 CodeIgniter 网站上关于[mod rewrite的这篇文章](http://codeigniter.com/wiki/mod_rewrite)

我之前实际上给出了类似的答案：[mod_rewrite in Users/<username>/Sites directory on OSX](https://stackoverflow.com/questions/9935894/mod-rewrite-in-users-username-sites-directory-on-osx/9939343#9939343)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:28:50.947

```
RewriteRule \.(jpe?g|gif|png|wmv|bmp)$ /uploads/$1 
```

可能对你有用。您可以根据需要添加其他格式。

# wpf - 如何区分“单击的窗口关闭按钮 (X)”与关闭处理程序中的 window.Close()

> ID：13361260
> 
> 赞同：10
> 
> 时间：2012-11-13T13:04:47.977
> 
> 标签：wpf, window

有没有一种聪明的方法来检测窗口是否被关闭

*   用户按下窗口右上角的 (X) 按钮或
*   window.Close() 已以编程方式调用。

我想在 window.Closing 处理程序中检测到这一点。每当我调用 window.Close() 时，我都可以设置一个标志，但这不是一个非常漂亮的解决方案。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-13T14:16:37.423

我不确定我是否喜欢这个，但你显然有理由问这个问题。如果要在 OnClosing 事件中获取堆栈跟踪，则可以查找 Window.Close 事件。

```
protected override void OnClosing(System.ComponentModel.CancelEventArgs e)
{
   bool wasCodeClosed = new StackTrace().GetFrames().FirstOrDefault(x => x.GetMethod() == typeof(Window).GetMethod("Close")) != null;
   if (wasCodeClosed)
   {
       // Closed with this.Close()
   }
   else
   {
       // Closed some other way.
   }

   base.OnClosing(e);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-15T16:46:13.480

区别如下：

Window.Close() 导致 WM_CLOSE 被发送到窗口。

Alt+F4 和 X 按钮会导致带有 SC_CLOSE 类型的 WM_SYSCOMMAND 消息。您可以决定是否希望进一步路由此消息（并最终导致 WM_CLOSE ）。

这是一段捕获此消息的代码。如果您希望取消默认行为，请从委托返回“True”：

```
class SystemMenu : IDisposable
{
    const int WM_SYSCOMMAND = 0x0112;
    const int SC_CLOSE = 0xF060;

    public delegate bool HandleSystemCommand();
    HwndSource _source;
    HandleSystemCommand _handler;

    public SystemMenu(Window window, HandleSystemCommand handler )
    {
        _handler = handler;
        _source  = HwndSource.FromHwnd(new WindowInteropHelper( window ).Handle);
        _source.AddHook(WndProc);
    }

    public void Dispose() {
        _source.RemoveHook(WndProc);
    }

    private IntPtr WndProc(IntPtr hwnd, int msg, IntPtr wParam, IntPtr lParam, ref bool handled)
    {
        switch (msg)
        {
            case WM_SYSCOMMAND:
                int command = wParam.ToInt32() & 0xfff0;
                if (command == SC_CLOSE)
                    handled = _handler();
                break;
            default:
                break;
        }
        return IntPtr.Zero;
    }
} 
```

# unit-testing - DefaultIfEmpty Linq to Sql 在 Moles 测试中返回 null

> ID：13361263
> 
> 赞同：0
> 
> 时间：2012-11-13T13:04:53.407
> 
> 标签：unit-testing, linq-to-sql, moles, defaultifempty

我做了一个痣来测试我的存储库类，当我输入 DefaultIfEmpty(new Drivers()) 时它可以工作，但是当我运行程序时，我收到这个错误：**查询运算符“DefaultIfEmpty”使用不支持的重载。**

但是当我把它放回**DefaultIfEmpty()**时，它工作正常，但我的**强文本**痣测试现在返回一个空值。这是我的代码：

```
 var result = from p in this.context.AirPositions
                         join a in this.context.Airplane p.airplane_id equals a.id
                         join s in this.context.Status on p.status_id equals s.id
                         join dp in this.context.DriversPositions on p.id equals dp.position_id into dpJoin
                         from ds in dpJoin.DefaultIfEmpty(new DriversPosition())
                         join d in this.context.Drivers on ds.driver_id equals d.id into dsJoin
                         from drs in dsJoin.DefaultIfEmpty(new Driver())
                         orderby p.timesent descending
                         select new PositionViewModel()
                         { ... }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T08:33:41.990

似乎 linq 提供程序不支持 DefaultOrEmpty 函数的重载，该函数采用默认值。

如果你想用 moles 测试它，你必须将你的代码重写为其他东西。我知道测试不应该改变你的代码。尝试使用 SingleOrDefault 重写您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-29T09:38:26.077

使用 Linq-to-Sql 和 Linq-to-Object 运行的代码似乎存在问题。

我用以下方法解决了它：

```
var result = from p in this.context.AirPositions
             join a in this.context.Airplane on p.asset_id equals a.id
             let driver = (from dd in this.context.DriversPositions.Where(u => u.position_id == p.id)
             join d in this.context.Drivers on dd.driver_id equals d.id
             select d).FirstOrDefault()
             orderby p.timesent descending
             select new PositionViewModel() {...} 
```

希望这对其他人有帮助:)

# php - 从字符串末尾删除 NULL

> ID：13361267
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:05:31.683
> 
> 标签：php, arrays, string, function

我如何在这里摆脱行尾的 NULL ？

> WYOMING MI NEW JERSEY 07728 电脑维修技术NULL

```
$phrases = array("NEW YORK NY", "NEW JERSEY", "SOUTH DAKOTA", "SOUTH CAROLINA",     "COMPUTER REPAIR TECH","YORK NY","07728","WYOMING MI","WYOMING MINNESOTA");
$string = ("I live in wyoming Minnesota, but used to live in New Jersey 07728 working     as a computer repair tech.");
$string = strtoupper($string);

$matches = stringSearch($phrases, $string);

var_dump($matches);

function stringSearch($phrases, $string){
    $phrases1 = trim(implode('|', $phrases));
    $phrases1 = str_replace(' ', '\s', $phrases1);

    preg_match_all("/$phrases1/s", $string, $matches);

    $value = implode(' ', array_filter($matches[0]));
    echo $value;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:09:37.177

该函数不返回任何内容。因此，该`$matches`变量将包含值`null`。该值由 输出`var_dump($matches)`，就在函数内的字符串被`echo`编辑之后。

换句话说，它不是结果字符串的一部分，而是单独的输出。删除`var_dump($matches)`它就消失了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:10:11.227

这`var_dump`是导致问题的原因！

试试这个！

```
$phrases = array("NEW YORK NY", "NEW JERSEY", "SOUTH DAKOTA", "SOUTH CAROLINA",     "COMPUTER REPAIR TECH","YORK NY","07728","WYOMING MI","WYOMING MINNESOTA");
$string = ("I live in wyoming Minnesota, but used to live in New Jersey 07728 working     as a computer repair tech.");
$string = strtoupper($string);

$matches = stringSearch($phrases, $string);

//var_dump($matches);  // <---------- comment this out!!!

function stringSearch($phrases, $string){
    $phrases1 = trim(implode('|', $phrases));
    $phrases1 = str_replace(' ', '\s', $phrases1);

    preg_match_all("/$phrases1/s", $string, $matches);

    $value = implode(' ', array_filter($matches[0]));
    if($value){
        echo $value;
    }

} 
```

# java - 通过蓝牙从 Choicemed 血氧计 MD300C318T 读取数据

> ID：13361271
> 
> 赞同：1
> 
> 时间：2012-11-13T13:05:46.317
> 
> 标签：java, android, bluetooth

我正在尝试将我的 Android 应用程序连接到 Choicemed 血氧计。我找不到有关如何执行此操作的任何信息。我的应用程序还支持可以很好配对的 Polar Wearlink 心率监测器。有什么想法或信息吗？

# html - CSS对“位置：固定”的误解

> ID：13361275
> 
> 赞同：0
> 
> 时间：2012-11-13T13:06:06.390
> 
> 标签：html, css

我遇到了一个问题，顶部 div 应该在顶部时距离视口顶部大约 20px：

HTML：

```
<div id="top">
</div>
<div id="bottom">
    <p>some text</p>
    <p>some text</p>
    <p>some text</p>
    <p>some text</p>
    <p>some text</p>
</div> 
```

CSS：

```
body {
    margin-top: 0px;
    margin-left: 0px;
    margin-right: 0px;
}

#top {
    width: 100%;
    height: 50px;
    background-color: #00c;
    position: fixed;
} 
```

如果我从 中删除`position: fixed`，`#top`结果如预期，`#top`div 就在顶部。

如果有的话，我怎样才能使div 靠在视口的`#top`顶部？`#top``position:fixed`

PS（我无法在[http://jsfiddle.net](http://jsfiddle.net)上进行演示，因为那里看不到问题。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:09:10.580

这真的很难理解，但我认为您希望位置固定并且 div 触摸顶部？

添加`top: 0px;`到`#top`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T13:11:31.560

如果问题在 jsfiddle 中不可见，则意味着您的 HTML 代码与他们的代码之间一定存在差异。

使用 Firebug 或“检查元素”之类的工具来查看应用到`#top`（以及任何父元素）的所有活动 CSS 样式，直到找到不同之处。

# mongodb - MongoDB：@DBRef 查询

> ID：13361278
> 
> 赞同：6
> 
> 时间：2012-11-13T13:06:30.673
> 
> 标签：mongodb, dbref

我有一个专为存储用户通知设计的类层次结构：

```
@Document
public class Notification<T> {
   @Id
   private String id;
   @DBRef
   private T tag;
   ...
}

@Document
public class NotificationA extends Notification<WrappedA> {
}

@Document
public class NotificationB extends Notification<WrappedB> {
}

    ... 
```

这对于返回多态数组很有用，允许我在“标签”字段中存储任何类型的数据。当包装的对象包含 @DBRef 字段时，问题就开始了：

```
@Document
public class WrappedA {
   @Id
   private String id;
   @DBRef
   private JetAnotherClass referenced;
   ...
} 
```

“标签”字段的查询工作正常：

```
db.NotificationA.find( {"tag.$id": ObjectId("507b9902...32a")} ) 
```

但我需要查询 JetAnotherClass 的字段（两级 @DBRef 字段）。我尝试过使用点表示法和子对象，但它返回 null：

点符号：

```
db.NotificationA.findOne( {"tag.$referenced.$id": ObjectId("508a7701...29f")} ) 
```

子对象：

```
db.NotificationA.findOne( {"tag.$referenced": { "_id": ObjectId("508a7701...29f") }} ) 
```

有什么帮助吗？提前致谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T13:45:41.560

由于您看起来只是在查询，`_id`我相信您可以这样做：

```
db.NotificationA.findOne({"tag.$id": ObjectId("blah")}); 
```

然而：

> 但我需要查询 JetAnotherClass 的字段（两级 @DBRef 字段）。

DBRefs 不是 JOIN，它们只是一个自我描述`_id`，如果您不知道链接集合，它将创建一个帮助对象，因此您不必在客户端自己编写代码。

您可以在此处找到有关 DBRefs 的更多信息：http: [//docs.mongodb.org/manual/applications/database-references/](http://docs.mongodb.org/manual/applications/database-references/)

基本上，您可以从同一文档中查询 DBRef 中的子字段，即：`DBRef.$_id`但您不能在服务器端解析该 DBRef 并查询结果字段。

# android - 在 Android 2.3.3 中以睡眠/待机模式播放音乐

> ID：13361280
> 
> 赞同：1
> 
> 时间：2012-11-13T13:06:36.067
> 
> 标签：android, sleep, playback, standby

我正在尝试开发一个简单的媒体播放器来播放 Android 2.3.3 的 sdcard/music 目录的 mp3。问题是当我按下电源按钮或设备进入睡眠状态时，音乐停止。通过谷歌搜索和搜索 stackoverflow，我发现我需要使用唤醒锁定选项，但无论我做什么，当设备进入睡眠状态时，音乐都会停止（在模拟器上按 F7 也会停止音乐）。由于我已经为此奋斗了太久，所以我想我会寻求帮助。我真诚地感谢任何意见。谢谢。这是我的代码：

```
FileInputStream fis = new FileInputStream(songList.get(0));
FileDescriptor fd = fis.getFD();
if (mediaPlayer != null) {
 if (mediaPlayer.isPlaying()) {
  mediaPlayer.release();
  mediaPlayer = null;
 }
}

mediaPlayer = new MediaPlayer();
mediaPlayer.setWakeMode(getApplicationContext(), PowerManager.PARTIAL_WAKE_LOCK);
mediaPlayer.setDataSource(fd);
mediaPlayer.prepare();
playPauseButton.setImageResource(android.R.drawable.ic_media_pause);
mediaPlayer.seekTo(songPosition);
mediaPlayer.start();
appMsg.setText(songList.get(0)); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:59:49.897

我认为您应该使用服务在后台运行媒体所以您创建一个服务并将您的媒体代码放入其中并将其附加到启动和停止按钮可能是这样的：

```
public class MediaPlayerService extends Service {
     MediaPlayer myMediaPlayer;

     @Override
     public IBinder onBind(Intent intent) {
            // TODO Auto-generated method stub
            return null;
     }
     @Override
     public void onCreate() {
         FileInputStream fis = new FileInputStream(songList.get(0));
         FileDescriptor fd = fis.getFD();

         if (mediaPlayer != null) {
           if (mediaPlayer.isPlaying()) {
               mediaPlayer.release();
               mediaPlayer = null;
              }
            }

         mediaPlayer = new MediaPlayer();
         mediaPlayer.setDataSource(fd);
         mediaPlayer.prepare();
         playPauseButton.setImageResource(android.R.drawable.ic_media_pause);
         mediaPlayer.seekTo(songPosition);
         appMsg.setText(songList.get(0));
     }
     @Override
     public void onStart(Intent intent, int startid) {
         myMediaPlayer.start();
     }
     @Override
     public void onDestroy() {
         myMediaPlayer.stop();
     }
} 
```

之后，当使用方法按下开始按钮时启动该服务，并在 Activity 类`startService`中使​​用方法停止它`stopService`

# visual-studio-2010 - 在多台电脑上使用（增强）库，具有相同的编译器/IDE 版本

> ID：13361284
> 
> 赞同：0
> 
> 时间：2012-11-13T13:06:51.460
> 
> 标签：visual-studio-2010, boost, compilation, static-libraries

这个问题已经困扰我很久了。我有点不愿意问它，因为它对 boost（和我的编译器）来说是非常具体的，尽管有一天我必须问它，否则我永远不会知道它。

无论如何，我（我猜这里有很多人）使用多台电脑，并使用外部硬盘驱动器作为“切换”时轻松访问所有数据的手段；我有两台笔记本电脑和一台我经常使用的台式机。现在我将所有库（来自 boost）存储在我的外部硬盘驱动器上，我想知道我是否可以将它们与多台电脑一起使用？

boost 的最大部分——只有头文件的库——当然可以简单地使用，但是需要编译的额外部分呢？我确保所有电脑都使用相同版本的 IDE，所以我认为我应该只编译一次？我使用的 IDE 是 Visual Studio 2010（考虑到 2012 年）。

Qt 库/扩展又如何呢？

# objective-c - 有没有办法跟踪仍然指向对象的内容？

> ID：13361292
> 
> 赞同：2
> 
> 时间：2012-11-13T13:07:35.263
> 
> 标签：objective-c, ios, memory, automatic-ref-counting

我一直在试图追查为什么一块内存没有被释放。我可以看到它分配，但是当我离开视图并返回时，它被重新分配。它正在分配一个笔尖，然后使用视图。

**有没有办法跟踪仍然指向对象的内容？**

![仪器](../Images/f42b32933a7e9db1341852b4d0770378.png)

```
 TPDatePickerKeyboardView *keyboard = [[[NSBundle mainBundle] loadNibNamed:@"TPDatePickerKeyboardView" owner:self options:nil] objectAtIndex:0];
    keyboard.delegate = self;
    keyboard.associatedControl = self;
    self.datePickerKeyboard = keyboard;

    self.inputView = keyboard; 
```

**我找到了 Object 但它是 UIKit 的一部分？**

![对象摘要](../Images/04c4ba5914de3a01b187ba6f291e65c6.png) ![在此处输入图像描述](../Images/b08cfb96bf4cf869f5b6d0affd746de9.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:33:16.973

在 viewWillDisappear 中尝试添加 self. datePickerKeyboard.delegate = nil; 看看能不能解决它。

# android - mterp (Dalvik VM) 如何组织其字节码解释循环？

> ID：13361293
> 
> 赞同：6
> 
> 时间：2012-11-13T13:07:45.743
> 
> 标签：android, performance, interpreter

我正在研究 Android Dalvik VM，当我阅读文件 vm/mterp/out/InterpC-portable.cpp 中的 mterp 代码时遇到一个问题。实际上它是dalvik vm的主要解释器循环来解释dex文件中的字节码。如果我写了这个文件，我会选择一个 switch-case 结构来做这样的事情：

```
while (hasMoreIns()) {
   int ins = getNextIns();
   switch(ins) {
     case MOV:
       //interprete this instruction
       ...
       break;
     case ADD:
       ...
       break;
     ...
     default: break;
   }
 } 
```

但是，mterp 使用的内容与我的想法非常不同，它使用了一些神奇的代码（对我而言），如下所示：

```
FINISH(0);

HANDLE_OPCODE(OP_NOP)
   FINISH(1);
OP_END

HANDLE_OPCODE(OP_MOVE)
   ...
OP_END

... 
```

我用谷歌搜索它，发现它似乎是一个修改过的“线程”样式执行，它与 switch-case 样式不同并且具有更好的性能，因为它删除了 while 循环中的分支操作。但我仍然无法理解这段代码以及为什么它的性能更好。它如何找到解释器的下一个代码？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-14T07:41:40.517

作为一个简短的指导，该`out`目录充满了预处理文件，如果您想弄清楚代码，我认为这不是一件值得阅读的好东西。对应的源（本身）是和目录`InterpC-portable.cpp`的内容。`portable``c`

关于代码如何分派操作码，您需要查看`FINISH`宏的定义，在`portable/stubdefs.cpp`：

```
# define FINISH(_offset) {                                                  \
        ADJUST_PC(_offset);                                                 \
        inst = FETCH(0);                                                    \
        if (self->interpBreak.ctl.subMode) {                                \
            dvmCheckBefore(pc, fp, self);                                   \
        }                                                                   \
        goto *handlerTable[INST_INST(inst)];                                \
    } 
```

该宏用于每个操作码定义的末尾，并用作`switch (opcode)`语句的等价物。简而言之，这会读取 PC 指向的指令代码单元——从中获取操作码`inst = FETCH(0)`——`INST_INST(inst)`并将该操作码用作所有操作码地址表的索引。`goto`使用语句直接跳转到地址。

这`goto`是一个“计算的 goto”，它是一个非标准的 GCC 扩展。您可以在 GCC 手册中阅读有关它的内容，您还可以在 2008 年我在 Google IO 上关于 Dalvik internals 的演示文稿中找到有关该主题的一些信息。（在[https://sites.google.com/site找到它/io/dalvik-vm-internals](https://sites.google.com/site/io/dalvik-vm-internals)。）

我的演讲还谈到了这种技术的性能特征。简而言之，它节省了一些分支，并且在分支预测方面表现相对较好。但是，有更好的方法来编写解释器（正如我在演讲中所介绍的，以及 CPU 特定的 Dalvik 解释器实际上可以工作）。

并且对于更大的上下文，假设您有足够的 RAM 来保存编译结果，那么将字节码编译为本机 CPU 指令通常会比优化得最好的解释器更快地执行。Froyo 中引入的基于跟踪的 Dalvik JIT 旨在进行权衡，其中使用适量的额外 RAM 来实现相当有成效的性能提升。

# php - 使用 PHP 的 Gmail 到数据库 - 达到 Gmail 带宽限制 - 建议？

> ID：13361294
> 
> 赞同：1
> 
> 时间：2012-11-13T13:07:45.890
> 
> 标签：php, mysql, gmail, imap

希望有人有一些建议或解决方法。

我最近编写了一个电子邮件解析器，用于处理通过 CPanel 中的管道转发的邮件，并将详细信息输入到 mySQL 表中。

客户现在希望将历史邮件导入此数据库，并且拥有大约 50 个 Gmail 帐户，其中一些帐户包含超过 20,000 封邮件。

在我正在使用的“测试”帐户上，我已经能够从 25000 封电子邮件中收到大约 7000 封电子邮件。为了尝试弄清楚为什么我将其剥离，所以运行了一个非常简单的 php imap 脚本，只是为了将电子邮件的几个部分转储到表格中的一个单元格中，然后担心解析它，但是同样的事情也会发生。它达到 6000-7000 电子邮件标记并停止 - 没有错误或任何东西，它只是停止。

我刚刚发现 Gmail 对 IMAP 的带宽限制为每小时 750MB，并且通过数学计算，我很可能会遇到这个问题，这就是它停止的原因。

第一个问题 - 任何人都知道我如何检查这是否是原因？

其次-假设任何人都可以想到最佳解决方案吗？

我考虑过以几千封电子邮件为单位进行操作，但这意味着由于帐户数量众多，需要进行大量手动干预，而且下载它们需要很长时间，而我没有这些。

我的第二个（也是迄今为止最好的）想法是使用 Gmail 推荐的方法之一将所有邮件迁移到在客户端的 Cpanel 上创建的电子邮件地址，并使用内置管道功能通过我在我对他们的新邮件也是如此。（我不能 100% 确定迁移会触发 CPanel 应用管道规则，我必须进行测试）。

感谢任何输入。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:41:40.110

你的第一个问题我没有答案。

但是就您的第二个问题而言，如果您将任务分成几千封电子邮件，您不一定必须手动重新运行您的程序。您可以在收到 x 封电子邮件后使用 sleep 将程序停止一小时，或者您可以设置一个每小时运行一次的 cron 作业，您只需保存指向您处理的最后一封电子邮件的指针一个数据库或临时文件，这样您就知道在哪里获取并重新开始下一个 cron 作业运行。

# android - ANDROID 应用程序的 ZXing 条码

> ID：13361295
> 
> 赞同：0
> 
> 时间：2012-11-13T13:07:50.997
> 
> 标签：android, zxing

我编写了一个应用程序来扫描条形码。我尝试使用 ZXing 并且一切正常，但我会直接使用相机而不使用外部应用程序（如 Anobii），有什么方法可以做到这一点 ZXing？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:18:14.130

CaptureActivity 有方法：

```
public void handleDecode(Result rawResult, Bitmap barcode) 
```

此方法决定是否调用外部或内部应用程序，您应该将以下代码注释到 switch(source){...} 以避免退出到外部应用程序。：

```
case NATIVE_APP_INTENT:

case PRODUCT_SEARCH_LINK:

    handleDecodeExternally(rawResult, resultHandler, barcode);
    break;
case ZXING_LINK:

    if (returnUrlTemplate == null) {
        handleDecodeInternally(rawResult, resultHandler, barcode);
    } else {
        handleDecodeExternally(rawResult, resultHandler, barcode);
    }
    break; 
```

在你可以调用活动的下一个方法中，你应该注释所有并添加下一个代码：

```
private void handleDecodeInternally(Result rawResult,
        ResultHandler resultHandler, Bitmap barcode) {
    String resultString = resultHandler.getDisplayContents().toString();
    if (resultString.startsWith("some"))//define a regular expression in the qr code{
        //do something as call a new activity

    }else{
        //show error message
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:13:30.350

扩展 Flavio 的答案，您需要查看`com.google.zxing.client.android.camera`包含用于使用 android 相机的类的包

# c# - 双数组到对象数组？

> ID：13361298
> 
> 赞同：2
> 
> 时间：2012-11-13T13:08:00.577
> 
> 标签：c#, casting

我有以下数组：

```
double[] Series = new double[] { 7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6 } 
```

系列调试视图：

```
> Series
--> [0]
--> [1]
--> ...
--> [10]
--> [11] 
```

当我写以下内容时：

```
object[] object_array = new object[] { Series } 
```

object_array 调试视图：（不止一层）

```
> object_array
--> [0]
----> [0]
----> [1]
----> ...
----> [10]
----> [11] 
```

我写以下内容以防止新级别：

```
object[] object_array = new object[Series.Length];
for (int i = 0; i < Series.Length; i++)
{
    object_array[i] = Series[i];
} 
```

这是其他解决方案之一。但我认为，可能有更好的方法来做到这一点。我使用上面的循环有问题吗？还是不同的方式？

（我使用 highcharts。如果我给出的数组包含多个级别，它就不起作用。）

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T13:10:17.180

```
var object_array = Series.Cast<object>().ToArray(); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T13:11:15.567

使用 LINQ：

```
double[] series = new double[] { 7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6 };
object[] seriesAsAbjectArray = series.Cast<object>().ToArray(); 
```

您**不能**将其转换为`object[]`, 的原因是它`double`是一种值类型，因此您必须创建一个包含*boxed* `double` -items 的新数组。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-13T13:14:13.240

通过做这个

```
object[] object_array = new object[] { Series } 
```

您正在分配一个双精度数组作为数组 object_array 的第一个对象项。您实际上是在创建一行的二维数组。你可以使用这样的东西：

```
double[] Series = new double[] { 7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6 };
object[] object_array = new object[Series.Length];
Series.CopyTo(object_array, 0); 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-11-13T13:10:20.157

您只需分配它，因为它`double`是一个`object`.

```
object[] object_array = Series; 
```

# .net - Dotnet 从字符串中提取值

> ID：13361299
> 
> 赞同：0
> 
> 时间：2012-11-13T13:08:02.950
> 
> 标签：.net, regex

我需要能够从下面的字符串中提取值，并将它们分配给特定的变量。

```
[1;1HSVC_LVL={89} CALLS_OFF={966} CALLS_Q={2} CURR_DEL={67}[K[2;1HACD_HOLD={4} AN_WAIT={3} NRDY_WRAP={9} WALK_AWAY={14} FRCD_OFF={12}[K[4;1H{EOM}[K 
```

实际的字符串稍长一些，包含大约 16 个键/值对。如上所示，它还可以包含无关字符。这个字符串每隔几秒钟就会到达一次，我每次都需要相当快地将值解析为变量。我将为每个键/值对设置一个单独的变量。

在字符串中，我需要搜索键名，即“SVC_LVL”并将键值（包含在“{}”中，即键名“SVC_LVL”的“89”）分配给一个变量。每次的值不一定是相同的长度，所以我不能简单地从字符串中删除特定数量的字符，需要在“{}”中提取值

所以我真正在寻找的是一种找到每个特定键名（我事先知道）的方法，然后从它之后的下一个“{}”中提取值，将其分配给一个值，然后继续下一个。

不确定正则表达式是否是最好的方法，以及将每个单独拉出的示例是什么。这样做16次是明智的吗？还是我应该以不同的方式看待？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:34:04.973

如果要搜索特定键，请使用此选项：

```
string key = "SVC_LVL";
string pattern = key + @"\=\{(?<value>[^\}]+)\}";
foreach (Match m in Regex.Matches(input, pattern))
{
    Console.WriteLine(m.Groups["value"].Value);
} 
```

或者使用它来列出所有键值对：

```
string patAllKeyValues = @"(?<key>[\p{L}_]+)\=\{(?<value>[^\}]+)\}";
foreach (Match m in Regex.Matches(input, patAllKeyValues))
{
    Console.WriteLine("{0} -> {1}", 
                       m.Groups["key"].Value, 
                       m.Groups["value"].Value);
} 
```

# jquery - JQuery DataTables - AJAX 加载消息模式对话框

> ID：13361300
> 
> 赞同：1
> 
> 时间：2012-11-13T13:08:09.680
> 
> 标签：jquery, datatables, modal-dialog, loading, message

嗨，我正在使用 JQuery DataTables 插件，我让它运行得很好，但我需要在加载表期间显示一个带有加载 gif 的模态对话框。我的意思是，如果有一种方法可以在表格顶部显示“正在处理...”，我可以显示模态对话框。

其实我尝试：

```
$("#loading").dialog("open");
$('#example').dataTable( {
    "bProcessing": true,
    "sAjaxSource": "/Lq/Distribution?total=100",
    "success": fnsuccessComplete
} ); 
```

在 fnsuccessComplete 函数中，我添加了

```
$("#loading").dialog("close"); 
```

但是，如果我填充数据表，它不会显示对话框，如果我注释代码以填充数据表，它会显示对话框

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:13:46.927

jQuery.dataTable 中没有`success`选项。我想你想用`fnInitComplete`.

检查文档：[http ://datatables.net/ref](http://datatables.net/ref)

# java - 为所有小程序设置默认内存限制

> ID：13361313
> 
> 赞同：1
> 
> 时间：2012-11-13T13:09:20.020
> 
> 标签：java, memory, configuration, applet, icedtea

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:16:04.417

as oracle says: [http://docs.oracle.com/javase/7/docs/webnotes/tsg/TSG-Desktop/html/plugin.html](http://docs.oracle.com/javase/7/docs/webnotes/tsg/TSG-Desktop/html/plugin.html).

following environment variable should be set to add additional arguments to applets:

```
_JPI_VM_OPTIONS=-Xmx… 
```

Moreover as the reffered site says:

> Please note that you need to restart your browser after you set the environment variable. If you are setting this environment variable in the command shell, then you must use the same command shell to launch the browser so that the browser inherits the value of environment variable.

However if you doubt how to set environment variable in ubuntu, following post might be helpful: [Make $JAVA_HOME easily changable in Ubuntu](https://stackoverflow.com/questions/2655641/set-environment-variable-in-ubuntu)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T20:34:09.770

I just had a look at the source code of the icedtea-web plugin. [The part of the code which builds the command line](http://icedtea.classpath.org/hg/icedtea-web/file/df7db8de4a20/plugin/icedteanp/IcedTeaNPPlugin.cc#l1647) seems to have no provision at all for including custom arguments, no matter their origin. So it does not matter which config files, HTML files or environment variables I edit, the code there will build the same command line to call java, disregarding all my whishes.

So if all configuration fails, what remains is hackery. One approach would be to patch the source code of the plugin, and make it include additional words into its command line. For a static addition, i.e. a single size change, this would be fairly easy. A more general fix would include the content of some environment variable, the way [Peter's answer](https://stackoverflow.com/a/13361381/1468366) suggests. That would mean word-splitting the environment variable in question, and allocating the space for the array of words dynamically. Quite a bit of work at the C level.

As an alternative, one could tackle this at the level of the executed binary. The plugin apparently has the path of the executable hard-coded into it. In my case, this path is `/usr/lib/jvm/java-6-openjdk-amd64/jre/bin/java`. One can rename that binary to `java.orig`, and put a shell script in its place, with the following content:

```
#!/bin/bash
for i in "$@"; do
  if [[ "${i}" == sun.applet.PluginMain ]]; then
    exec "$0.orig" -Xmx512m "$@"
  fi
done
exec "$0.orig" "$@" 
```

One consequence of this approach is the fact that `ps` will no longer print these applets as `java` but instead as `java.orig`. Should not be a problem in most cases.

# java - Hibernate 为新的子实体生成幽灵条目

> ID：13361322
> 
> 赞同：5
> 
> 时间：2012-11-13T13:10:31.343
> 
> 标签：java, hibernate

我对 Hibernate 有一个奇怪的（无论如何对我来说）问题，我无法理解。下面的代码是我尝试使用附加实体 CaseToSuggestion 对实体 Case 和 Suggestion 之间的属性建模 ManyToOne 关系，其中 Case 是我的聚合根：

```
@Entity
@Table(name = "sga_cases")
public class Case {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int id;

    // Business key
    @Column(name = "caseid", unique = true, nullable = false)
    private String caseId;

    ...

    @OneToMany(mappedBy = "associatedCase", orphanRemoval = true, cascade = CascadeType.ALL)
    private Set<CaseToSuggestion> associatedSuggestions = new HashSet<CaseToSuggestion>();

    ...
}

@Entity
@Table(name = "sga_suggestions")
public class Suggestion {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int id;

    @Column(name = "suggestionid", unique = true, nullable = false)
    private String suggestionId;

    @Column(name = "localizationkey", nullable = false)
    private String localizationKey;

    @OneToMany(mappedBy = "associatedSuggestion", orphanRemoval = true, cascade = CascadeType.ALL)
    private Set<CaseToSuggestion> caseMapping = new HashSet<CaseToSuggestion>();

    ...
}

@Entity
@Table(name = "sga_case2suggestion")
public class CaseToSuggestion {

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    private int id;

    @Column(name = "feedback")
    private float feedback;

    @ManyToOne
    @JoinColumn(name = "caseid")
    private Case associatedCase;

    @ManyToOne(cascade = CascadeType.ALL)
    @JoinColumn(name = "suggestionid")
    private Suggestion associatedSuggestion;

   ...
} 
```

如果我为上述实体创建新对象，设置适当的关联，然后将它们与 EntityManager 一起存储，一切正常：

```
Case c = new Case(...)
Suggestion sugg = new Suggestion(...);
CaseToSuggestion case2sugg = new CaseToSuggestion(c, sugg, 1.0f);

c.getAssociatedSuggestions().add(case2sugg);
sugg.getAssociatedCases().add(case2sugg); 
```

其次是`entityManager.persist(c);`

如果我想为已经在数据库中的案例添加新的关联，我会从 EntityManager 中检索我想要关联的案例和建议实体，并将它们添加到新的 CaseToSuggestion：

```
CaseToSuggestion c2s = new CaseToSuggestion(c, s, fb);
c.getAssociatedSuggestions().add(c2s);
s.getAssociatedCases().add(c2s); 
```

其次是`entityManager.merge(c);`

CaseToSuggestion 实体存储在数据库中，但对于每个条目，我都会得到一个“幽灵条目”，其中包含新生成的 id 和所有字段为空：

```
+----+----------+--------+--------------+
| id | feedback | caseid | suggestionid |
+----+----------+--------+--------------+
|  3 |        1 |      3 |            1 |
|  4 |        1 |      4 |            2 |
|  5 |        1 |      5 |            2 |
|  6 |        0 |   NULL |         NULL |
|  7 |        1 |      6 |            2 |
|  8 |        0 |   NULL |         NULL |
|  9 |        1 |      7 |            2 |
| 10 |        0 |   NULL |         NULL |
+----+----------+--------+--------------+ 
```

有人知道可能导致这种情况的原因吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:31:16.713

好，我知道了。删除建议中的 OneToMany-Mapping 完全解决了我的问题。

# php - PHP 现在设置格式 YYYY-MM-DD

> ID：13361324
> 
> 赞同：6
> 
> 时间：2012-11-13T13:10:34.257
> 
> 标签：php

我需要以这种格式将变量设置为当前日期：例如： 2012-05-12 ，我知道那是 YYYY-MM-DD 吗？

我试过了：

```
$date = date("yyyy-mm-dd", strtotime(now)); 
```

但这并没有将日期保存到 mysql，因此它显示为 0000-00-00。

该字段设置为类型：mysql 数据库中的日期。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-13T13:13:25.970

简单的：

```
$date = date('Y-m-d'); 
```

见 [http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-11-13T13:11:27.993

经常检查[文档](http://php.net/manual/en/function.date.php)，你会发现你需要的格式是：

```
<?php date('Y-m-d'); ?> 
```

**编辑：**另外，您不需要将时间指定为第二个参数，`date()`默认情况下将使用现在。应该注意的是，您的语法也是错误的`strtotime('now')`，因为“now”是一个需要引用的字符串。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-13T13:26:35.383

采用

```
$date = date("Y-m-d"); 
```

然后将`$date`变量保存到数据库

# python - 在 groupby 操作中保留日期时间索引

> ID：13361326
> 
> 赞同：2
> 
> 时间：2012-11-13T13:10:40.623
> 
> 标签：python, pandas

假设我有以下 DataFrame（时间序列，第一列是 DateTimeIndex）

```
 atn   file
datetime                             
2012-10-08 14:00:00  23.007462      1
2012-10-08 14:30:00  27.045666      1
2012-10-08 15:00:00  31.483825      1
2012-10-08 15:30:00  37.540651      2
2012-10-08 16:00:00  43.564573      2
2012-10-08 16:00:00  48.589852      2
2012-10-08 16:00:00  55.289452      2 
```

我的**目标**是在最后一列“文件”中提取第一次出现特定数字的行，以便**获得与此类似的表**：

```
 datetime             atn
file                             
1      2012-10-08 14:00:00  23.007462
2      2012-10-08 15:30:00  37.540651 
```

我的**方法**是按“文件”分组，然后在“第一”上聚合：

```
dt.groupby(by="file").aggregate("first") 
```

但是这样做的问题是，索引不被用作分组的列。我首先通过以下方式将索引添加为列来解决此问题：

```
dt2 = dt.reset_index()
dt2.groupby(by="file").aggregate("first") 
```

但现在的**问题**是 datetime 列不再是日期，而是浮动：

```
 datetime        atn
file                         
1     1.349705e+18  23.007462
2     1.349710e+18  37.540651 
```

有没有

*   一种将浮点数转换回日期时间的方法？
*   或者一种在 groupby/aggregate-operation 中保留日期时间的方法？
*   或者一个更好的方法来实现这个最终表？

* * *

示例数据框可以按如下方式使用：

复制这个（到剪贴板）：

```
2012-10-08 14:00:00,  23.007462,     1
2012-10-08 14:30:00,  27.045666,     1
2012-10-08 15:00:00,  31.483825,     1
2012-10-08 15:30:00,  37.540651,     2
2012-10-08 16:00:00,  43.564573,     2
2012-10-08 16:00:00,  48.589852,     2
2012-10-08 16:00:00,  55.289452,     2 
```

进而：

```
dt = pandas.read_clipboard(sep=",", parse_dates=True, index_col=0, 
                           names=["datetime", "atn", "file"]) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:02:05.750

我认为这是 pandas 中的一个错误 - 在 groupby 之后 dtype 更改为 float

```
dt3 = dt2.groupby(by="file").aggregate("first")
dt3.dtypes 
```

给我：

```
datetime    float64
atn         float64 
```

要将 dtype 更改回 datetime64，您可以执行以下操作：

```
dt3['datetime'] = pd.Series(dt3['datetime'], dtype='datetime64[ns]') 
```

我在[GitHub 上创建了一个新问题](https://github.com/pydata/pandas/issues/2238)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:46:32.713

看起来像一个错误，但此时，**不指定** `parse_dates=True`会给我预期的结果。

我的 ipython 结果 - 没有`parse_dates=True`:-

```
In [29]: dt2 = pd.read_clipboard(sep=",", index_col=0, 
                           names=["datetime", "atn", "file"])

In [30]: dt2
Out[30]: 
                           atn  file
datetime                            
2012-10-08 14:00:00  23.007462     1
2012-10-08 14:30:00  27.045666     1
2012-10-08 15:00:00  31.483825     1
2012-10-08 15:30:00  37.540651     2
2012-10-08 16:00:00  43.564573     2
2012-10-08 16:00:00  48.589852     2
2012-10-08 16:00:00  55.289452     2

In [31]: dt2.reset_index().groupby(by="file").aggregate("first")
Out[31]: 
                 datetime        atn
file                                
1     2012-10-08 14:00:00  23.007462
2     2012-10-08 15:30:00  37.540651

In [32]: 
```

我的 ipython 结果，带有`parse_dates=True`：-

```
In [33]: dt = pd.read_clipboard(sep=",", parse_dates=True, index_col=0, 
                           names=["datetime", "atn", "file"])
KeyboardInterrupt

In [33]: dt = pd.read_clipboard(sep=",", parse_dates=True, index_col=0, 
                           names=["datetime", "atn", "file"])

In [34]: dt.reset_index().groupby(by="file").aggregate("first")
Out[34]: 
          datetime        atn
file                         
1     1.349705e+18  23.007462
2     1.349710e+18  37.540651 
```

明确检查`dtypes`：-

```
In [40]: new_dt = dt.reset_index().groupby(by="file").aggregate("first")

In [41]: new_dt
Out[41]: 
          datetime        atn
file                         
1     1.349705e+18  23.007462
2     1.349710e+18  37.540651

In [42]: new_dt.dtypes
Out[42]: 
datetime    float64
atn         float64

In [43]: new_dt2 = dt2.reset_index().groupby(by="file").aggregate("first")

In [44]: new_dt2.dtypes
Out[44]: 
datetime     object
atn         float64 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T00:11:06.590

我相信这是固定的，将在 0.9.1 版本中

# android - OSMDroid 地图视图。已成功添加自定义标记，但也显示默认值？

> ID：13361329
> 
> 赞同：0
> 
> 时间：2012-11-13T13:10:53.997
> 
> 标签：android, android-mapview, osmdroid

我的代码如下。本质上，我试图用我的自定义标记替换每个标记，即我的可绘制 beer_full。

我的自定义叠加层中的这个被覆盖的绘图功能完美地完成了这项工作，但它也将默认图标留在那里。因此，我的标记作为默认标记顶部的自定义标记出现在我的地图上。

有人知道我如何停止显示默认标记吗？

干杯

```
@Override
    public void draw(Canvas canvas, MapView mapview, boolean shadow) {
        // TODO Auto-generated method stub
        super.draw(canvas, mapview, shadow);

        if(!shadow)
        {
        for (int ctr = 0; ctr < myOverlays.size(); ctr++)
        {
            GeoPoint in = myOverlays.get(ctr).getPoint();

            //Toast.makeText(mapview.getContext(), ctr, Toast.LENGTH_SHORT).show();

            Point out = new Point();
            mapview.getProjection().toPixels(in, out);

            Bitmap bm = BitmapFactory.decodeResource(mapview.getResources(), 
              R.drawable.beer_full);

            canvas.drawBitmap(bm, 
              out.x - bm.getWidth()/2,  //shift the bitmap center
              out.y - bm.getHeight()/2,  //shift the bitmap center
              null);
        }
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:30:00.237

删除线`super.draw(canvas, mapview, shadow);`。您基本上是在绘制默认图标（通过调用该`draw`方法的默认实现），然后在其上绘制您的自定义图标。

# django - Google App Engine、Django、CloudSQL 和图像

> ID：13361330
> 
> 赞同：-2
> 
> 时间：2012-11-13T13:11:05.800
> 
> 标签：django, google-app-engine, google-cloud-sql

目前正在将一些 Django 项目移植到 Google App Engine。我正在使用 Python 2.7、Django 1.4 和 Google CloudSQL。

我遇到的问题是管理员驱动的画廊。处理图像上传似乎是一个问题，使用 ImageField 我在 mkdir 命令上遇到错误，因为 GAE 不允许本地写入。

我有点卡住了，解决方案似乎很困惑，我正在使用 CloudSQL，因为它与以前运行这些站点的旧 MySQL 数据库兼容。

在没有本地存储的情况下，如何让图库恢复并运行？我一直在研究 GAE blobstore 的使用，但帖子似乎多种多样且无济于事。

干杯凯文

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:36:54.703

您必须重写 ImageField 以使用 BlobStore 而不是文件。

快速谷歌搜索表明有人可能已经这样做了： http: [//blog.uysrc.com/2011/02/12/image-uploads-working-with-models-imagefield/](http://blog.uysrc.com/2011/02/12/image-uploads-working-with-models-imagefield/)

# php - 保护 API - JS 前端和 PHP 后端

> ID：13361331
> 
> 赞同：2
> 
> 时间：2012-11-13T13:11:10.490
> 
> 标签：php, javascript, security

我正在寻找一个好的实现来保护我用 PHP 编写的后端。

设想：

**服务器 1 (www.domain.com)** 仅向客户端提供 JS/HTML 服务器

**服务器 2 (www.domain2.com)** 正在运行一个 PHP 服务器，它使用 JSON 数据响应服务器 1（由 Sevrer1 上的 Javascript 模板引擎呈现）。

如何阻止其他人从 Server1 获取 JSON 响应？我知道我可以添加某种 API 密钥，但它存储在 JS 中（每个人都可以阅读），我知道我可以检查请求是否来自服务器 1 IP，但伪造这样的请求并不是什么大问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T16:38:14.617

为什么不创建一些短期令牌并仅在服务器端共享它们，然后嵌入到 JS 代码中？

[资源](http://abhinavsingh.com/blog/2009/10/web-security-using-crumbs-to-protect-your-php-api-ajax-call-from-cross-site-request-forgery-csrfxsrf-and-other-vulnerabilities/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:59:25.703

从 Server1 到 Server2 进行内部调用是一种解决方案，不将 Server1 暴露在 Internet 上，并将其添加到专用网络可能会有所帮助。

即使有人解决了问题，您也可以添加验证，例如确保请求来源来自授权来源（在您的情况下为 Server2）。如果请求来源来自其他来源，则直接返回而不进行处理。

如果您仍然对此感到偏执，您可以随时添加更多机制，例如[基于哈希的消息身份验证代码](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CDEQFjAA&url=http://en.wikipedia.org/wiki/Hash-based_message_authentication_code&ei=MlKiUOHdAoaKrgfuuYG4Aw&usg=AFQjCNHJz8Y7on_vQuJtpKp_LwDX0b4Rhg&sig2=XnSghlZCmVedSDSyYLQwEA)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T14:11:10.543

您可以做的一件事是在服务器 1 上创建一个会话 cookie，并同时将该会话值存储在服务器 2 上的数据库中。每当有人从服务器 1 发出请求时，您都会在请求中附加 cookie 值并将其发送到服务器 2在进行 API 调用时。仅当传入会话 ID 与存储在数据库中的会话 ID 匹配时，服务器 2 才返回 JSON。

这不是万无一失的。有人可以破解 cookie，一旦用户注销，您将需要清除会话。

正如您所提到的，另一种方法是在服务器 1 上使用服务器端脚本语言。

# java - 基本 MVC 模式和 GUI

> ID：13361333
> 
> 赞同：1
> 
> 时间：2012-11-13T13:11:26.893
> 
> 标签：java, swing, model-view-controller, user-interface, jcomponent

我想问小费。如果您有一个 JFrame，其中包含许多 JPanel，其中有十个 JTextFields 标签和一个编辑按钮，您将如何构建您的应用程序。

您会将所有代码都放在 JFrame 中，还是从 JPanel 扩展并将所有代码包含在 JFrame 中？

按钮呢？我想使用 MVC 模式，你会如何处理动作监听器？他们每个人都是自己的控制器，还是您只为所有这些人使用一个控制器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:07:47.273

我认为这首先是风格和个人喜好的问题。它还取决于您的应用程序应该做什么以及如何做。

如果您的 JPanel 在某种方式上都非常相似，那么从 JPanel 扩展可能是有意义的。例如，如果每个面板有 10 个按钮，其中按钮 1 总是对其相应的模型对象执行 xyz() （尤其是当此对象对于 1 个 JPanel 的所有按钮都相同时）并且按钮 2 执行 abc() ...

如果 JPanel 没有以这种方式强相关，我会将我的代码放置在 JFrame 或从外部设置整个 GUI 的第三个对象中。

与动作监听器类似。如果您的操作很少，我可能会只选择一个控制器对象以方便使用（文件不多）。如果您有很多不同的操作，我会将类似的操作分组到每组操作的一个控制器对象中。

也就是说，最好从一种简单的方法 (YAGNI) 开始，在这种方法中，您从 JFrame / 第三个对象执行所有操作，并拥有一个动作侦听器，然后在您觉得将事物拆分为您提供更清晰或更灵活的设计时进行重构。

# java - jsp:param 编码问题

> ID：13361335
> 
> 赞同：4
> 
> 时间：2012-11-13T13:11:30.333
> 
> 标签：java, jsp

所以我有几个 .jsp 文件：

其中一个文件具有 head 标签并具有页面标题：

```
<%@ page pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>${param.title}</title>
</head> 
```

其他文件包括第一个文件并使用 jsp:param 将参数传递给它：

```
<%@ page pageEncoding="UTF-8"%>
<jsp:include page="consoleheader.jsp">
    <jsp:param name="title" value="Título"/>
</jsp:include>
<body>
...
</body>
</html> 
```

当我这样做时，我使用 jsp:param 传递的任何非 ASCII 字符都会出现乱码（例如 Título 中的 í）。在其他任何地方都可以正常工作。所有 jsp 文件都使用 UTF-8 编码。我没有在我的 JVM 上设置任何字符集配置。任何人都知道如何在不手动设置 JVM 编码的情况下解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2015-08-04T15:05:35.637

我对 jsp 参数也有类似的问题，并通过以下方式对其进行了破解：

主.jsp：

```
<%@ page pageEncoding="UTF-8"%>
<html>
<head/>
  <body>
    <jsp:include page="other.jsp">
      <%-- í = &iacute; --%>
      <jsp:param name="title" value="T&iacute;tulo"/>
    </jsp:include>
  </body>
</html> 
```

其他.jsp

```
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<%@ page pageEncoding="UTF-8"%>
<h1><c:out value="${param.title}" escapeXml="false"/></h1> 
```

* * *

我知道这不是最好的解决方案，但它对我有用。

* * *

### 编辑

我找到了[另一个](https://groups.google.com/forum/#!topic/omaha-java-users-group/SBVal1wEj98)也可以为您工作的解决方案：

> 在 jsp:include 之前添加 setCharacterEncoding 行就可以了。
> `<% request.setCharacterEncoding("utf-8"); %>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T15:45:14.433

在这里使用 JSTL。虽然它更冗长：

“头”：

```
<%@ page pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>${title}</title>
</head> 
```

“身体”：

```
<%@ page pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<c:set var="title" scope="request" value="Título"/>
<jsp:include page="consoleheader.jsp">
<body>
...
</body>
</html> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:44:24.730

参数值可以是动态的吗？. 如果不是，请将“í”替换为

`&#237;`

# css - 用户确定的 CSS 和 rails 中的路径

> ID：13361338
> 
> 赞同：0
> 
> 时间：2012-11-13T13:11:37.707
> 
> 标签：css, ruby-on-rails, asset-pipeline

我正在构建一个 Rails 3.2 应用程序，它具有一些功能，用户可以将不同的主题（即 CSS 文件）应用到他们的网站。我有一个带有主题名称和文件名的主题​​模型 - 非常简单。

我的问题是，这些 css 文件应该放在哪里？它们应该在 /assets 文件夹中，还是在 /public 文件夹中？据我所知，它们无法添加到管道中，因为我不知道用户将选择哪个 css 文件，因此无法预编译。

如果我使用类似的东西：

```
stylesheet_link_tag "plain.css" 
```

它当然会生成 /assets/plain.css 的路径，该路径不是有效路径。

我可以把它放在 /public 并使用类似的东西生成路径 `"public/themes/" + theme.file`

但这感觉有些不对劲。有什么架构建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:39:24.293

如果所有主题都是用户选择的简单的预先存在的样式表，我会选择

```
/app/assets/stylesheets/themes/plain.css 
```

然后在视图中使用它：

```
stylesheet_link_tag "themes/plain"

# or e.g. using the model

stylesheet_link_tag "themes/#{current_user.theme.file_name}“ 
```

您还可以考虑创建一个`theme_stylesheet_tag`帮助程序，以更干净的方式为您执行此操作。

# java - JavaFX TextInputControl requestFocus

> ID：13361345
> 
> 赞同：2
> 
> 时间：2012-11-13T13:12:10.847
> 
> 标签：java, javafx-2, javafx

我正在尝试从 TextInputControl 调用 requestFocus 方法。没有成功。当我打开一个新选项卡时，我想将焦点设置在 TextInputControl 上。我正在这样做：

```
tab.setContent(anchor);
tabPane.getTabs().add(tab);

SingleSelectionModel<Tab> selectionModel = tabPane.getSelectionModel();
selectionModel.select(tab);

focusTopLeftInputArea(anchor); 
```

和 focusTopLeftInputArea 找到一个 TextInputControl“ti”并调用 ti.requestFocus()。

focusTopLeftInputArea 可以很好地找到 TextInputControl 但控件没有获得焦点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T13:24:03.930

来自 Node 的 requestFocus 方法的 JavaFX Api 文档：

> 为了有资格获得焦点，节点必须是场景的一部分，它和它的所有祖先都必须可见，并且不能被禁用。

那么你究竟从哪里调用这段代码呢？确保在调用 requestFocus 时，您的控件已经是场景/舞台的一部分，并且调用是在 JavaFX 应用程序线程中完成的（这可以通过调用来确保`Platform.runLater()`）。

# c++ - 从文件夹加载文件并保存到另一个文件夹

> ID：13361346
> 
> 赞同：1
> 
> 时间：2012-11-13T13:12:11.043
> 
> 标签：c++, qt, opencv

我正在使用 opencv（2.3 版）和 qt（4.8 版）使用 Visual c++ 编写，我在从文件夹加载文件（jpg 图像）并保存到另一个文件夹时遇到了一些问题。这是我的代码：

```
for (uint i = 0; i < numFiles; i += (numFiles / numBoards) ){

    QString str = "D:/TESI_Magistrale/Linescanner/imm_aquisition/image" + QString::number(i + 1) + ".jpg";
    QImage *image=new QImage();
    image->load(str);

    IplImage *currentImage = cvCreateImageHeader(cv::Size(640,480),IPL_DEPTH_8U,1);//1 channel xk b&w (solo brightness)
    currentImage->imageData = (char*)image;

    QString str1 = "D:/TESI_Magistrale/Linescanner/imm_calibration/image" + QString::number(i + 1) + ".jpg";
    QByteArray ba1 = str1.toLatin1();
    const char *text1 = ba1.data();
    cvSaveImage(text1,currentImage);

} 
```

问题是当我打开保存文件夹（imm_calibration）中的jpg图像时，它们与原始图像完全不同。错误在哪里？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:20:10.367

```
currentImage->imageData = (char*)image; 
```

这当然是非常可疑的。您正在将 a 转换`QImage*`为 a `char*`。首先要做的是更改为

```
currentImage->imageData = image->bits(); 
```

为了使用缓冲区。另一件事，您正在`currentImage`使用固定值创建，也许最好使用

```
cvCreateImageHeader(cv::Size(image->width(),image->height(),....) 
```

这是针对 qt 部分的。可能还不够。

# php - 在 PHP DOM 中过滤日期

> ID：13361347
> 
> 赞同：2
> 
> 时间：2012-11-13T13:12:32.280
> 
> 标签：php, parsing, dom, simple-html-dom

我想用 SIMPLE HTML PHP DOM PARSER (simplehtmldom.sourceforge.net) 从获取的内容中替换所有日期。这是代码：

```
include("simple_html_php_dom.php");
$html = file_get_html("http://freebacklinks.prijm.com"); //example.com
$result = "$html";
$result = preg_replace("/([1-9]|[0-2][0-9]|3[0-1]) (Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) [0-9]{4}/", " ", $result);
$result = preg_replace("/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec) ([1-9]|[0-2][0-9]|3[0-1]) [0-9]{4}/", " ", $result);
echo $result; 
```

所以，这里所有的日期数据，比如：`01 Jan 2004`or `Jan 01 2004`or`Dec 12 14`应该用空格替换......但它没有用空格替换那些日期......现在该怎么办？
**这是一个显示它将如何工作的示例..** [http://codepad.org/lAuHW565](http://codepad.org/lAuHW565) **但为什么它在[PHP Simple HTML DOM Parser中不起作用](http://simplehtmldom.sourceforge.net/)**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:47:42.900

您试图替换一个`SimpleHTML`不可能的对象（它是一个对象，而不是字符串）。您应该做的是先获取HTML，然后替换，然后将其转换为`SimpleHTML`使用该`str_get_html`功能。

```
<?php
    include("simple_html_php_dom.php");

    //Start with getting the pure HTML and replacing in that (don't use SimpleHTMLPHP for this)
    $html = file_get_contents("http://freebacklinks.prijm.com"); //example.com
    $html= preg_replace("/([1-9]|[0-2][0-9]|3[0-1])\s+(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+[0-9]{4}/", " ", $html);
    $html = preg_replace("/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+([1-9]|[0-2][0-9]|3[0-1])\s+[0-9]{4}/", " ", $html);

    //Now create the $result variable:
    $result = str_get_html($html);
    echo $result;
?> 
```

# php - 使用 AJAX Post 的响应

> ID：13361350
> 
> 赞同：0
> 
> 时间：2012-11-13T13:13:03.217
> 
> 标签：php, javascript, jquery, ajax

我一直在开发一个注册表单，而且我一直在缓慢但肯定地学习一些 javascript 和 jquery，以进一步支持我对这一切的了解。但是我遇到了一个问题，问题是我无法从 AJAX 请求中获得响应。

我的 AJAX 请求在一个单独的函数中，我有多种用途。我已将 alert();'s 放入代码中以进行调试。

```
function validate_input ( input, type ) {
    $.ajax({
            type:'post',
            url: 'ajax_request.php',
            data: "type=" + type + "&input=" + input,
            success: function( response ) {
            if( response == "true" || response == "false" ) {
                alert( "working" );
                console.log(response);
                return response;
            } else {
                alert( "AJAX/jQuery Error" );
                alert( "Reponse !== true or false" );
            }
        }
    });
} 
```

我可以确认 ajax_request.php 文件正确地回显**真**或**假**，但是，对于那些感兴趣的人来说，这里是编码。

```
if (!defined('BASEPATH') &&
strtolower($_SERVER['HTTP_X_REQUESTED_WITH']) != 'xmlhttprequest')
exit('Direct Access to this file has been disabled.');

include('core/db.php');
$validateType = intval( $_POST['type'] );
$input = escape_string( $_POST['input'] );

if( $validateType == 1 ) // validate username
{
    echo ( user_exists( $input ) ? "true" : "false" );
} else if( $validateType == 2 ) // validate email
{ 
    echo "true"; // not coded yet
} 
```

最后，我在必要时调用该函数（*使用 .blur()*），您可以在下面看到；

```
var username_value = "Jake"; // for debugging purposes, var definitely contains something
validate_input( username_value, 1 );
alert( validate_input( username_value, 1 ) ); alerts "undefined" 
```

我只是想知道是否有人可以看到导致此问题的代码的任何问题，请不要建议我使用验证器插件，这不是问题的答案。

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:26:12.753

Ajax 调用是异步的，你不能这样返回响应。使用 ajax，您可以定义一个回调函数，该函数在收到响应时调用。代码执行不会停止并在继续之前等待响应。

所以你需要在成功函数中做任何你想做的事情，或者从那里调用另一个函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:22:37.507

ajax“类型”设置为 POST，但您的脚本正在检查 $_GET 数组的参数。将 $_GET 更改为 $_POST 或将 ajax 类型更改为“get”。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:32:29.667

```
alert( validate_input( username_value, 1 ) ); 
alerts "undefined" 
```

这不会那样工作。首先 - 您正在使用异步 ajax 调用。

第二：

```
success: function( response ) {
            if( response == "true" || response == "false" ) {
                alert( "working" );
                console.log(response);
                return response;
            } else {
                alert( "AJAX/jQuery Error" );
                alert( "Reponse !== true or false" );
            }
        } 
```

在上面的代码中，返回属于成功处理函数，而不是`validate_input`函数。基本上，您无处返回您的响应。

因此，`return response;`您应该对响应做任何您需要做的事情：

```
success: function( response ) {
                if( response == "true" || response == "false" ) {
                    alert( "working" );
                    console.log(response);
                    alert(response);//here you do what you need.
                } else {
                    alert( "AJAX/jQuery Error" );
                    alert( "Reponse !== true or false" );
                }
            } 
```

`.get`, `.post`,`.load`的工作方式与它们`$.ajax`在后面使用的方式相同

# javascript - 如何使用 jquery 和 JSON 动态构建链接

> ID：13361354
> 
> 赞同：1
> 
> 时间：2012-11-13T13:13:11.843
> 
> 标签：javascript, json

我有一个返回以下 JSOn 的 Web API：-

```
{'url': 'http://192.168.10.50/WCF/00vf/img?imgid=1', 'desc': 'firstdoc'},{'url': 'http://192.168.10.50/WCF/vf/img?imgid=2', 'desc': 'sedonddoc'},{'url': 'http://192.168.10.50/WCF/vf/img?imgid=3', 'desc': 'thirddoc'} 
```

所以我需要`<a>`根据返回的 JSON 构建链接，我尝试编写以下 jquery 但没有成功：-

```
<script type="text/javascript">
$(function() {
    $.getJSON("http://localhost:1431/home/statisjson",
  {

    datetype: "json"
  },
  function(data) {
      $.each(data, function (key, val) {
      $("<a/>").attr("href", val.url).appendTo("#links");

    });
  });
})
</script>
<div id="links"></div> 
```

我仍然需要将“desc”JSON 对象添加为链接文本，但我不知道该怎么做？

BR

**::UPDATE::** 我已将我的脚本更新为以下内容，但它不起作用：-

```
@section scripts {
 <script type="text/javascript">
     $(document).ready(function () {

         $.ajax({
             type: "GET",
             url: 'http://localhost:1431/Home/statisjson',
             dataType: "JSON",

             success: function (result) {

                 $.each(result, function (key, val) {

                     $("<a>", { href: val.url, text: val.desc }).appendTo("#links");

                 });
             }
         });

     });

 </script> 
```

返回 JSON 的 asp.net 方法如下所示：-

```
public ActionResult statisjson(int start = 0, int rows = 50)
        {
 var j = "[{'url': 'http://192.168.10.50/img?imgid=1', 'desc': 'firstdoc'},{'url': 'http://192.168.10.50/img?imgid=2', 'desc': 'sedonddoc'},{'url': 'http://192.168.10.50/img?imgid=3', 'desc': 'thirddoc'}]"; 
return Content(j, "application/json");

        } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:16:30.113

当传递 HTML 作为第一个参数时，你可以传递一个包含你的属性的对象字面量作为第二个参数：

```
$("<a>", { href: val.url, text: val.desc }).appendTo("#links"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:15:53.217

尝试使用这个：

```
$("<a>" + val.desc + "</a>").attr("href", val.url).appendTo("#links"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:17:12.457

这不是一个有效的 JSON。您需要添加`[]`.

```
[{'url': 'http://192.168.10.50/WCF/00vf/img?imgid=1', 'desc': 'firstdoc'},{'url': 'http://192.168.10.50/WCF/vf/img?imgid=2', 'desc': 'sedonddoc'},{'url': 'http://192.168.10.50/WCF/vf/img?imgid=3', 'desc': 'thirddoc'}] 
```

你应该试试这个来创建你的链接：

```
$("<a/>").attr("href", val.url).text(val.desc).appendTo("#links"); 
```

# c# - 使用 foreach 循环但坚持要做什么

> ID：13361355
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:13:23.633
> 
> 标签：c#

我有一个集合列表，它返回以下结果：

```
GenderID      Name    Gender
1              Mary   F
1              Jane   F
1              Lori   F
2              John   M
2              Mike   M 
```

我正在使用 foreach 循环并根据 GenderID 动态创建一个列表视图。我不知道 GenderID 更改时要检查的内容。谁能指出我或给我一些反馈。

```
public void GetGenderInfo()
{
    int? currentGenderID = null;

    List<Gender> lstGenders = GetListOfGenders();

    foreach (var g in lstGenders)
    {
        currentGenderID = g.GenderID;

        if ( //what goes here )
        {
            // create ListView
        }
    }
} 
```

预期结果为：

```
Mary F     John M
Jane F     Mike M
Lori F 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:02:30.320

由于您希望按某个值进行分组，因此您需要跟踪您的分组值。添加列表字典可以解决这个问题。看看下面的代码：

```
public void GetGenderInfo()
{
    List<Gender> lstGenders = GetListOfGenders();

    var tmpDict = new Dictionary<int, List<Gender>();
    foreach (var g in lstGenders)
    {
        List<Gender> currGender;
        if (!tempDict.TryGetValue(g.GenderId, out currGender)
        {
            currGender = new List<Gender>();
            tempDict.Add(g.GendrId, currGender);
        }
        currGender.Add(g);
     }

    //Now itterate your dictionary & pull out the groupings.
    } 
```

现在`tmpDict`包含按 GenderId 分组的原始列表。

# linux - 如何从 bash 中的 .csv 文件的第一行获取特定列？

> ID：13361361
> 
> 赞同：0
> 
> 时间：2012-11-13T13:13:40.247
> 
> 标签：linux, bash, shell, awk

我正在编写一个连接到服务器的 bash 脚本，将数据导出到 .csv 文件，然后运行一个使用该新创建文件的 jar。问题是，jar 要求文件名包含 .csv 文件中第一行的 Timestamp 列的值。

这是我的 .csv 文件的第一行。在这种情况下，时间戳是位于行尾的**2012-11-01 。**

```
"####<Nov 1, 2012 12:00:01 AM UTC> <Warning> <AesoRMQAdapter::RabbitMQAdapter> <> <myServer> <[ACTIVE] ExecuteThread: '7' for queue: 'weblogic.kernel.Default (self-tuning)'> <> <> <> <1351728001726> <BEA-000000> <DEBUG SEND MESSAGE={"Volume":55.1,"OfferedVolume":54.8,"ArmedVolume":0.0,"Status":false,"BlockNr":0,"Timestamp":"2012-11-01T00:00:01+0000"}> " 
```

我的问题如下。

检索 .csv 文件后，我该如何...

1.  从 .csv 文件的第一行中获取第一个时间戳
2.  在我将保存 .csv 文件的文件名中使用该时间戳

感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:24:01.290

用于`head -1`从输入文件中仅获取一行，然后`grep -o`检索该行中的所有时间戳，然后`head -1`仅保留第一行。

```
$ date=`cat myfile.csv | head -1 | grep -o -e "[0-9]\{4\}-[0-9]\{2\}-[0-9]\{2\}" | head -1`
$ echo $date
2012-11-01
$ mv myfile.csv myfile.$date.csv 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:21:58.457

例如，使用`GNU grep`：

```
ts=$(grep -Pom1 '(?<="Timestamp":")[^"]*' csv) 
```

或与`sed`：

```
ts=$(sed -n '1s/.*"Timestamp":"\([^"]*\).*/\1/p' csv) 
```

然后你可以做

```
mv csv "$ts.txt" 
```

旧名称在哪里`csv`，`2012-11-01T00:00:01+0000.txt`将是新名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:25:38.703

awk oneliner 一次性完成：

```
awk -F':"' 'NR==1{split($NF,t,"T");print "mv "FILENAME" "t[1]".csv"}' file.csv 
```

这将打印“mv”命令行。如果要执行它，只需将输出通过管道传输到 sh ，如下所示：

```
awk ..... |sh 
```

测试：

```
kent$  cat dummy.csv 
"####<Nov 1, 2012 12:00:01 AM UTC> <Warning> <AesoRMQAdapter::RabbitMQAdapter> <> <myServer> <[ACTIVE] ExecuteThread: '7' for queue: 'weblogic.kernel.Default (self-tuning)'> <> <> <> <1351728001726> <BEA-000000> <DEBUG SEND MESSAGE={"Volume":55.1,"OfferedVolume":54.8,"ArmedVolume":0.0,"Status":false,"BlockNr":0,"Timestamp":"2012-11-01T00:00:01+0000"}> "
foo;bar;blah

kent$  awk -F':"' 'NR==1{split($NF,t,"T");print "mv "FILENAME" "t[1]".csv"}' dummy.csv
mv dummy.csv 2012-11-01.csv 
```

# python - 各种内存错误，python

> ID：13361364
> 
> 赞同：1
> 
> 时间：2012-11-13T13:13:53.287
> 
> 标签：python, memory

我正在使用 Python，但最近我遇到了很多内存错误。

一个与以 .png 格式保存绘图有关。一旦我尝试将它们保存为 .pdf 格式，我就不再有这个问题了。如何仍将 .png 用于多个文件？

其次，我正在读取相当大的数据文件，一段时间后，我的内存不足。我每次都尝试关闭它们，但也许还有一些东西打开了。有没有办法在没有处理程序的情况下关闭 Python 中所有打开的文件？

最后，Python 应该释放所有未使用的变量，但我认为它没有这样做。如果我只运行一个函数，我没有问题，但如果我在行中运行两个不相关的函数（在完成第一个之后和进入第二个之前，据我所知，所有变量都应该被释放），在第二个期间，我再次遇到内存错误问题。因此我相信，变量在第一次运行后不会被释放。如何强制 Python 释放所有这些（我不想使用 del，因为有很多变量，我不想指定其中的每一个）。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:22:53.807

查看代码可能会带来更多的许可。

你也可以尝试做

```
import gc
f() #function that eats lots of memory while executing
gc.collect() 
```

这将调用垃圾收集器，您将确保删除所有废弃的对象。如果这不能解决问题，请查看 objgraph 库[http://mg.pov.lt/objgraph/objgraph.html](http://mg.pov.lt/objgraph/objgraph.html)以检测谁泄漏了内存或找到您忘记删除的地方对内存消耗对象的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:04:49.150

> 其次，我正在读取相当大的数据文件，一段时间后，我的内存不足。我每次都尝试关闭它们，但也许还有一些东西打开了。有没有办法在没有处理程序的情况下关闭 Python 中所有打开的文件？

如果您使用`with open(myfile1) as f1: ...`，则无需担心关闭文件或意外打开文件。

请参阅[**此处**](http://effbot.org/zone/python-with-statement.htm)以获得很好的解释。

至于其他问题，我同意 alex_jordan 的观点，如果你展示一些代码会有所帮助。

# asp.net-mvc - Html.Display扩展不输出值

> ID：13361368
> 
> 赞同：0
> 
> 时间：2012-11-13T13:14:12.087
> 
> 标签：asp.net-mvc

我使用以下代码打印用户名。

```
@if (User.Identity.IsAuthenticated)
{
   @Html.Display("Welcome, " + User.Identity.Name);
} 
```

但它不打印它。

为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:19:25.923

`Html.Display`不是要显示字符串，而是模型中的属性。尝试这样的事情：

```
@if (User.Identity.IsAuthenticated)
{
   @: Welcome, @User.Identity.Name
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:22:02.063

我找到了另一个解决方案：

```
 @if (User.Identity.IsAuthenticated)
           {
               <label>Welcome, </label>  @Html.Label(User.Identity.Name);
           } 
```

# windows-phone-7 - 在 Windows Phone 中的 Web 浏览器控件内自动填充网站的登录信息

> ID：13361372
> 
> 赞同：0
> 
> 时间：2012-11-13T13:14:32.647
> 
> 标签：windows-phone-7

我正在尝试制作一个 windowsphone 7 应用程序。用户将他的登录详细信息存储在应用程序中，在打开应用程序时，应用程序将通过自动填写详细信息登录到特定站点。我指的这个站点没有任何用于登录的 API。

该应用程序将需要自动填充需要 javascript 注入的详细信息......有人在这方面工作吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T12:37:45.100

您可以将 IsoltedStroageSettings 用于这么小的目的，因为您只需要存储几个字段。一个简单的例子是

```
IsolatedStorageSettings appSettings = IsolatedStorageSettings.ApplicationSettings; 
```

最初添加值

```
appSettings.Add("id", "sum@somthing.com");
appSettings.Add("password", "pass123"); 
```

稍后检索它们

```
string id= (string)appSettings["id"];
string id= (string)appSettings["password"]; 
```

希望有帮助:)

# android - 在 Android 平板电脑中禁用物理键盘

> ID：13361375
> 
> 赞同：1
> 
> 时间：2012-11-13T13:15:11.457
> 
> 标签：android, keyboard

好的，所以我购买了中文平板电脑和中文键盘，它们耗尽了我的标签电池 v.fast，所以我正在考虑创建一个应用程序来启用和禁用物理键盘，任何人都可以帮助我如何在编码中定位物理键盘，或者是还有其他可能的方法。

编辑：禁用我的意思是与物理键盘没有任何交互，或者说禁用usb端口，你会建议什么

我还有 ROM 工具箱，它还允许我使用一些构建属性，所以如果你能以这种方式帮助我，我将非常感谢 b/c，它将为我节省很多时间。

Android：4.0.3 键盘使用 USB 数据线连接。

无论如何提前谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-25T18:01:08.400

无论如何，我想分享我的解决方案，

我启用了 Pin Lock，它会将 android 变成睡眠模式，所以过了一会儿我的物理键盘会自动禁用（大写锁定灯停止响应）。

;)

# php - 将 print_r 的输出写入 txt 文件。PHP

> ID：13361376
> 
> 赞同：12
> 
> 时间：2012-11-13T13:15:17.680
> 
> 标签：php

> **可能重复：**
> [将数组打印到文件](https://stackoverflow.com/questions/2628798/print-array-to-a-file)

如何在文件中写入输出（例如，当我使用数组时）？，我正在尝试这个：

```
 ...
print_r($this->show_status_redis_server());
$status_redis = ob_get_contents();
fwrite($file, $status_redis);
    ... 
```

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2012-11-13T13:17:03.187

`print_r()`有第二个参数，如果作为传递，`TRUE`则将输出作为字符串返回。

```
$output = print_r($data, true);
file_put_contents('file.txt', $output); 
```

您甚至可以使用`var_export`函数进行 cosinder，因为它提供了有关数据类型的更好信息。从`print_r`您无法判断变量是否为 FALSE 的 NULL，但`var_export`让我们准确地查看变量的数据类型。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T13:17:06.243

[`print_r($expression [, bool $return = false ])`](http://www.php.net/manual/en/function.print-r.php)具有标识您要返回字符串或回显一个的可选参数。

```
$str = print_r($desiredVariable, true);
fwrite($handle, $str); 
```

我也会使用[`file_put_contents`](http://www.php.net/manual/en/function.file-put-contents.php)：

```
$content = print_r($yourVar, true);
file_put_contents('file.log', $content); 
```

# java - 将我的数据库移动到 SD 卡不起作用

> ID：13361377
> 
> 赞同：0
> 
> 时间：2012-11-13T13:15:38.873
> 
> 标签：java, android

我正在使用下面的代码尝试将我的数据库文件移动到我的 sdcard。除了在`sd`. 有任何想法吗？

```
File data = Environment.getDataDirectory();
if (sd.canWrite()) {
    String currentDBPath = "\\data\\application.package\\databases\\name";
    String backupDBPath = "name";
    File currentDB = new File(data, currentDBPath);
    File backupDB = new File(sd, backupDBPath);
    if (currentDB.exists()) {
        FileChannel src;
    try {
    src = new FileInputStream(currentDB).getChannel();
        FileChannel dst = new FileOutputStream(backupDB).getChannel();
        try {
        dst.transferFrom(src, 0, src.size());
    src.close();
            dst.close();
        } catch (IOException e) {                                                    
            e.printStackTrace();
        }
    } catch (FileNotFoundException e) {
    e.printStackTrace();
    } 
```

![在此处输入图像描述](../Images/d5781c2d74986aa5bb087541ae460999.png)

![在此处输入图像描述](../Images/2a63eef854daf3be2895d6d2511ddb7a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:26:09.040

如果您创建一个变量，您只能使用它的实例：

把它放在你的代码之前：

```
File sd = Environment.getExternalStorageDirectory(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:25:30.370

如果您使用的是 SQLite 数据库，请尝试以下操作：

```
public class _DBHelper extends SQLiteOpenHelper {

    public boolean backUp() throws Exception
        {
            InputStream input = null;
            OutputStream output = null;

            try {
                SQLiteDatabase db = this.getReadableDatabase();
                String strSource = db.getPath();

                String strDest = Utilities.getAppDocumentsFolder(_context) + "/"
                        + DATABASE_NAME;

                File fileDest = new File(strDest);
                if (fileDest.exists())
                {
                    fileDest.delete();
                }

                input = new FileInputStream(strSource);

                output = new FileOutputStream(strDest);

                byte[] buffer = new byte[1024];
                int length;
                while ((length = input.read(buffer)) > 0) {
                    output.write(buffer, 0, length);
                }
            } catch (Exception e) {
                throw e;
            } finally
            {
                if (output != null)
                {
                    output.flush();
                    output.close();
                }
                if (input != null)
                {
                    input.close();
                }
            }

            return true;
        }
} 
```

# c# - 应用程序的新实例

> ID：13361379
> 
> 赞同：5
> 
> 时间：2012-11-13T13:15:53.907
> 
> 标签：c#, .net, wpf

我已经在我的计算机上制作了 MP3 文件以与我的媒体播放器关联。所以当我在资源管理器中双击一个 MP3 文件时，显然媒体播放器会启动并播放它。

**我的问题** 我可以防止弹出多个实例，但是如何将新实例的文件路径传输到我已经使用的实例

**我想要发生的事情：** 我双击一首歌曲，......我正在听它我双击另一首歌曲，当前歌曲应该停止并且新歌曲应该开始播放，而不会弹出应用程序的新实例。

我使用 Mutex 检查是否已经有一个正在运行的实例。要获取文件路径，我使用 Environment.GetCommandLineArgs()

我需要的只是将文件的路径传递给当前实例。我怎样才能做到这一点？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:25:35.740

本质上，您必须将其构建到您的应用程序中。

当用户单击第二首歌曲时，您必须有某种方法让当前实例终止应用程序的前一个实例或向其发送消息。

这些对我来说似乎有点脏。

我认为一种干净的方法是编写一个`app_booter.exe`与您的媒体文件相关联的小文件。单击媒体文件时，它会启动此 _app_booter_ 其中：

1.  查找应用程序的运行实例。
2.  向它发送数据以停止当前歌曲并播放这首新歌曲。
3.  如果应用程序没有运行，它只是在命令行上使用歌曲启动它。

要从这个其他 exe 发送您的应用程序数据，您可以查看 IPC: [Interprocess communication for Windows in C# (.NET 2.0)](https://stackoverflow.com/questions/50153/interprocess-communication-for-windows-in-c-sharp-net-2-0)

我认为[`WM_COPYDATA`](http://msdn.microsoft.com/en-us/library/ms649011.aspx)上述帖子中提到的方法或 tcp 套接字就足够了，因为您的数据非常简单，只是一个文件路径，也许是一个命令。

我认为保留两个单独的 exe 比构建应用程序以与其先前的实例对话更容易和更清洁。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:23:04.783

我想你正在寻找这个[http://wpfinstanceawareapp.codeplex.com/](http://wpfinstanceawareapp.codeplex.com/)

为可以将命令行参数传递给第一个实例的单实例应用程序提供功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:23:37.510

在你`Main`检查你的互斥体之后，从参数中获取歌曲并触发一个`Play(FileInfo filename)`事件来播放歌曲。你的表单应该处理这个事件（或者更好的控制器类）

# mouse - 鼠标悬停效果在 Three.js 中不起作用

> ID：13361380
> 
> 赞同：1
> 
> 时间：2012-11-13T13:15:58.020
> 
> 标签：mouse, three.js, rollover, projector

我需要有关 Three.js 的这段代码的帮助。我不知道为什么它不起作用，因为一切都是正确的，并且是从其他有效的代码中复制而来的。问题是没有鼠标悬停效果。

```
<html>
<head>
    <title>NUEVO</title>
    <style>canvas { width: 100%; height: 100% }</style>
</head>

<body>

    <script src="js/libs/Tween.js"></script>
    <script src="js/libs/stats.min.js"></script>
    <script src="https://raw.github.com/mrdoob/three.js/master/build/three.js"></script>

    <script>

        var scene,camera,rendered,projector;
        var mouseX, mouseY, stats, container;
        var objects=[];
        var INTERSECTED;
        var theta = 0;

        init();
        animate();

        function init(){ 

            scene = new THREE.Scene();

            camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 20000);
            camera.position.set( 0, 150, 400 );
            camera.lookAt(scene.position);  

            renderer = new THREE.CanvasRenderer();
            renderer.setSize(window.innerWidth, window.innerHeight); 
            container = document.createElement( 'div' );
            document.body.appendChild( container );
            container.appendChild( renderer.domElement );

            projector = new THREE.Projector(); 

            stats = new Stats();
            stats.domElement.style.position = 'absolute';
            stats.domElement.style.bottom = '0px';
            stats.domElement.style.zIndex = 100;
            container.appendChild( stats.domElement );

            for (var i=0; i<3; i++)
            {
                var geometry = new THREE.CubeGeometry(40,40,40); 
                var material = new THREE.MeshBasicMaterial({color: 0x00ff00}); 
                var cube = new THREE.Mesh(geometry, material);
                cube.position.x = (i*200) -200 
                objects.push(cube);
                scene.add(cube);
            }

            window.addEventListener( 'resize', onWindowResize, false );
        }

        function onDocumentMouseDown( event ) 
        {
            event.preventDefault();
            mouseX =  ( event.clientX / window.innerWidth ) * 2 - 1;
            mouseY = - ( event.clientY / window.innerHeight ) * 2 + 1;
        }

        function onWindowResize() {

            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize( window.innerWidth, window.innerHeight );
        }

        function animate()
        {
            requestAnimationFrame(animate);
            render();
            update();
        }

        function update()
        {

            var vector = new THREE.Vector3( mouseX, mouseY, 1 );
            projector.unprojectVector( vector, camera );

            var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
            var intersects = ray.intersectObjects( scene.children );

            if ( intersects.length > 0 ) {

                if ( intersects[ 0 ].object != INTERSECTED ) 
                {
                    if ( INTERSECTED ) 
                        INTERSECTED.material.color.setHex( INTERSECTED.currentHex );
                        // store reference to closest object as current intersection object
                        INTERSECTED = intersects[ 0 ].object;
                        // store color of closest object (for later restoration)
                        INTERSECTED.currentHex = INTERSECTED.material.color.getHex();
                        // set a new color for closest object
                        INTERSECTED.material.color.setHex( 0xffff00 );  

                } else {// there are no intersections 
                    // restore previous intersection object (if it exists) to its original color
                    if ( INTERSECTED ) 
                        INTERSECTED.material.color.setHex( INTERSECTED.currentHex );
                        // remove previous intersection object reference
                        //     by setting current intersection object to "nothing"
                        INTERSECTED = null;
                }

                /*  for(var i=0; i<3; i++)
                {  
                    objects[i].rotation.y += 0.05; 
                }*/
            }
        }

        function render() 
        { 
            //theta += 0.4;
            camera.position.x = 300 * Math.sin( theta * Math.PI / 360 );
            camera.position.y = 300 * Math.sin( theta * Math.PI / 360 );
            camera.position.z = 300 * Math.cos( theta * Math.PI / 360 );
            camera.lookAt( scene.position );

            renderer.render(scene, camera);
        }   

    </script>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:58:52.477

这就是你想要的：

[http://jsfiddle.net/Lx6nE/4/](http://jsfiddle.net/Lx6nE/4/)

什么问题：

*   Three.js 的链接应该指向缩小的源。
*   大括号应该正确缩进，因为闪烁
*   应该捕获 mousedown 事件。

编码：

```
 var scene,camera,rendered,projector;
    var mouseX, mouseY, stats, container;
    var objects=[];
    var INTERSECTED;
    var theta = 0;

    init();
    animate();

    function init(){ 

        scene = new THREE.Scene();

        camera = new THREE.PerspectiveCamera(45, window.innerWidth/window.innerHeight, 1, 20000);
        camera.position.set( 0, 150, 400 );
        camera.lookAt(scene.position);  

        renderer = new THREE.CanvasRenderer();
        renderer.setSize(window.innerWidth, window.innerHeight); 
        container = document.createElement( 'div' );
        document.body.appendChild( container );
        container.appendChild( renderer.domElement );

        projector = new THREE.Projector(); 

        stats = new Stats();
        stats.domElement.style.position = 'absolute';
        stats.domElement.style.bottom = '0px';
        stats.domElement.style.zIndex = 100;
        container.appendChild( stats.domElement );

        for (var i=0; i<3; i++)
        {
            var geometry = new THREE.CubeGeometry(40,40,40); 
            var material = new THREE.MeshBasicMaterial({color: 0x00ff00}); 
            var cube = new THREE.Mesh(geometry, material);
            cube.position.x = (i*50) -60
            objects.push(cube);
            scene.add(cube);
        }

        window.addEventListener( 'resize', onWindowResize, false );
        window.addEventListener( 'mousedown', onDocumentMouseDown, false );
    }

    function onDocumentMouseDown( event ) 
    {
        event.preventDefault();
        mouseX =  ( event.clientX / window.innerWidth ) * 2 - 1;
        mouseY = - ( event.clientY / window.innerHeight ) * 2 + 1;
    }

    function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize( window.innerWidth, window.innerHeight );
    }

    function animate()
    {
        requestAnimationFrame(animate);
        render();
        update();
    }

    function update()
    {

        var vector = new THREE.Vector3( mouseX, mouseY, 1 );
        projector.unprojectVector( vector, camera );

        var ray = new THREE.Ray( camera.position, vector.subSelf( camera.position ).normalize() );
        var intersects = ray.intersectObjects( scene.children );

        if ( intersects.length > 0 ) {

            if ( intersects[ 0 ].object != INTERSECTED ) 
            {
                if ( INTERSECTED ) 
                    INTERSECTED.material.color.setHex( INTERSECTED.currentHex );
                    // store reference to closest object as current intersection object
                    INTERSECTED = intersects[ 0 ].object;
                    // store color of closest object (for later restoration)
                    INTERSECTED.currentHex = INTERSECTED.material.color.getHex();
                    // set a new color for closest object
                    INTERSECTED.material.color.setHex( 0xffff00 );  

            }
        } else {// there are no intersections 
                // restore previous intersection object (if it exists) to its original color
                if ( INTERSECTED ) 
                    INTERSECTED.material.color.setHex( INTERSECTED.currentHex );
                    // remove previous intersection object reference
                    //     by setting current intersection object to "nothing"
                    INTERSECTED = null;

            /*  for(var i=0; i<3; i++)
            {  
                objects[i].rotation.y += 0.05; 
            }*/
        }
    }

    function render() 
    { 
        //theta += 0.4;
        camera.position.x = 300 * Math.sin( theta * Math.PI / 360 );
        camera.position.y = 300 * Math.sin( theta * Math.PI / 360 );
        camera.position.z = 300 * Math.cos( theta * Math.PI / 360 );
        camera.lookAt( scene.position );

        renderer.render(scene, camera);
    } 
```

​</p>

# shell - 在 shell 脚本中切换红宝石

> ID：13361382
> 
> 赞同：1
> 
> 时间：2012-11-13T13:16:10.343
> 
> 标签：shell, rvm, jruby

执行 bash shell 脚本时，我使用的是 ruby​​ 1.9.3。然后，在脚本中，我想切换到 JRub（我使用的是 rvm）。我尝试通过`rvm use jruby`在脚本中执行切换到 JRuby，但这不起作用，它说：

```
RVM is not a function, selecting rubies with 'rvm use ...' will not work.

You need to change your terminal emulator preferences to allow login shell.
Sometimes it is required to use `/bin/bash --login` as the command.
Please visit https://rvm.io/integration/gnome-terminal/ for a example.

./run.sh: line 10: jruby: command not found 
```

当我`type rvm | head -n1`在命令提示符下执行时，我得到：`rvm is a function`. 所以我不确定这个问题。我想这可能是因为我使用 sudo ( `sudo rvm install jruby`) 安装了 JRuby。所以我再次使用 sudo 运行了 shell 脚本。我再次收到错误。

如何使用 rvm 从 bash shell 脚本中切换 rubies？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T14:11:02.100

我最终将其添加到之前的行中：

```
[[ -s "$HOME/.rvm/scripts/rvm" ]] && . "$HOME/.rvm/scripts/rvm" 
```

正如这个线程中所解释的（对不起 - 虽然我之前知道这个线程，但我并没有完全掌握它）：

[RVM 不切换红宝石](https://stackoverflow.com/questions/3276950/rvm-doesnt-switch-rubies)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:18:37.897

/complete/path/to/rvm 你的 shell 似乎定义了一个 'rvm' 内置命令。

# silverlight - Silverlight 应用程序第一次下载后是否保持保存/缓存？

> ID：13361384
> 
> 赞同：0
> 
> 时间：2012-11-13T13:16:24.027
> 
> 标签：silverlight

如果我的 asp.net 网站有一些 silverlight 内容（XAP 文件、silverlight 视频内容），用户每次在浏览器中打开我的网站时是否必须下载所有内容，或者即使用户打开计算机，日期仍保存/缓存在硬盘上？数据保存在哪个文件夹中，保存多长时间？在创建 silverlight 项目时，我在某处读到了有关“通过使用应用程序库缓存来减少 XAP 大小”选项的信息。该选项是否默认启用（VS 中没有安装 Silverlight）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:26:36.833

我建议在此处阅读[Silverlight 和 XAP 缓存](http://www.silverlightshow.net/items/Caching-of-in-and-around-your-Silverlight-application-part-1.aspx)。简而言之，是的，Silverlight XAP 会被缓存，并且仅在 XAP 被修改或浏览器缓存被清除时才会重新加载。

浏览器将缓存运行应用程序所需的资源、库、xaml 和二进制文件。这由浏览器缓存处理，您的文件存储在临时 Internet 文件目录中。

程序集缓存允许浏览器将程序集与 XAP 文件分开缓存。这样做的好处是您可以更新您的 XAP 并且浏览器不必重新下载您的程序集，只需更新的 XAP 文件。当用户重新访问您的网站时，这会对下载速度产生很大影响。

有时，缓存 XAP 文件可能对您不利，因为发布更新不一定会弄脏缓存。IE 比 Chrome 和 Firefox 更好地处理更新。上面的链接向您展示了如何将 IIS 配置为在发布时立即使 Web 内容过期。 [此 CodeProject 链接](http://www.codeproject.com/Articles/143414/Prevent-your-Silverlight-XAP-File-from-Caching-in)还具有使用动态字符串更新 ASP.NET 页面内容以强制在发布时刷新缓存的好方法。

# php - PHP preg_replace 在现有字符串中插入字符串

> ID：13361386
> 
> 赞同：1
> 
> 时间：2012-11-13T13:16:31.110
> 
> 标签：php, regex, preg-replace

不幸的是，我真的无法理解正则表达式，所以我最后的手段是向你们这些优秀的人寻求帮助。

我有这个现有的代码：

```
<li id="id-21" class="listClass" data-author="newbie">
    <div class="someDiv">
        <span class="spanClass">Some content</span>
    </div>

    <div class="controls faint">
        <a href="link2">Link 2</a>
        <a href="link3">Link 3</a>
    </div>
</li> 
```

由于多种原因，我不得不使用 preg_replace 注入一段额外的代码：

```
<a href="link1">Link 1</a> 
```

我想你可以猜到应该去哪里，但为了清楚起见，我希望得到的字符串看起来像：

```
<li id="id-21" class="listClass" data-author="newbie">
    <div class="someDiv">
        <span class="spanClass">Some content</span>
    </div>

    <div class="controls faint">
        <a href="link1">Link 1</a>
        <a href="link2">Link 2</a>
        <a href="link3">Link 3</a>
    </div>
</li> 
```

谁能帮助我使用适当的正则表达式来实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:10:04.260

尝试这个

```
$html = '<li id="id-21" class="listClass" data-author="newbie">
    <div class="someDiv">
        <span class="spanClass">Some content</span>
    </div>

    <div class="controls faint">
        <a href="link2">Link 2</a> 
        <a href="link3">Link 3</a>
    </div>
</li>';

$eleName = 'a';
$eleAttr = 'href';
$eleAttrValue = 'link2';
$addBefore = '<a href="link1">Link 1</a>';

$result = regexAddBefore($html, $eleName, $eleAttr, $eleAttrValue, $addBefore);

var_dump($result);

function regexAddBefore($subject, $eleName, $eleAttr, $eleAttrValue, $addBefore){
    $regex = "/(<\s*".$eleName."[^>]*".$eleAttr."\s*=\s*(\"|\')?\s*".$eleAttrValue."\s*(\"|\')?[^>]*>)/s";
    $replace = $addBefore."\r\n$1";

    $subject = preg_replace($regex, $replace, $subject);

    return $subject;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:32:36.297

我可以建议两件事（虽然我不能清楚地理解你的问题）

```
$newStr = preg_replace ('/<[^>]*>/', ' ', $htmlText); 
```

这将从字符串中删除所有 html 标签。不知道对你有没有用。

另一个建议是使用`strip_tags`函数。的第二个参数`strip_tags`是可选的。您可以在第二个参数的帮助下定义要保留的标签。

```
$str = '<li id="id-21" class="listClass" data-author="newbie">
        <div class="someDiv">
            <span class="spanClass">Some content</span>
        </div>

        <div class="controls faint">
            <a href="link2">Link 2</a>
            <a href="link3">Link 3</a>
        </div>
        </li>';

echo strip_tags ($str,'<a>'); 
```

这将为您提供仅包含链接和 html 字符串中的任何文本的输出。

对不起，如果这也没有帮助。

# c# - asp.net 代码显示编译器错误消息：CS1729：'EmailReader.Pop3Client' 不包含采用 0 个参数的构造函数

> ID：13361387
> 
> 赞同：0
> 
> 时间：2012-11-13T13:16:32.407
> 
> 标签：c#, asp.net, compiler-errors

我在运行以下代码时收到此错误消息：

错误信息：

```
Compilation Error

Description: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately. 

Compiler Error Message: CS1729: 'EmailReader.Pop3Client' does not contain a constructor that takes 0 arguments

Source Error:
Line 148:        private static object @__fileDependencies; 
Line 149:  
Line 150:        [System.Diagnostics.DebuggerNonUserCodeAttribute()] 
Line 151:        public pop3client_aspx() { 
Line 152:            string[] dependencies; 
```

Home.aspx.cs 代码：

```
protected void Button1_Click(object sender, EventArgs e)
{
    Session["email"] = txt_email.Text;
    Session["pwd"] = txt_password.Text;
    Response.Redirect("Pop3Client.aspx");
} 
```

当我单步执行代码时，没有执行 Pop3Client.aspx.cs page_load 事件中的断点。任何想法如何解决这个问题？

Pop3Client.aspx.cs

```
protected void Page_Load(object sender, EventArgs e)
{

    int page = 1;
    if (Request.QueryString["page"] == null)
    {
        Response.Redirect("Pop3Client.aspx?page=1");
        Response.Flush();
        Response.End();
    }
    else
        page = Convert.ToInt32(Request.QueryString["page"]);
    try
    {
        Email = Session["email"].ToString();
        Password = Session["pwd"].ToString();
    }
    catch (Exception ex)
    { 
        Response.Redirect("Home.aspx"); 
    }

    int totalEmails;

    List<Email> emails;
    string emailAddress;
    using (EmailReader.Pop3Client client = new EmailReader.Pop3Client(Host, Port, Email, Password, true))
    {
        emailAddress = client.Email;
        client.Connect();
        totalEmails = client.GetEmailCount();
        emails = client.FetchEmailList(((page - 1) * NoOfEmailsPerPage) + 1, NoOfEmailsPerPage);
    }

    int totalPages;
    int mod = totalEmails % NoOfEmailsPerPage;
    if (mod == 0)
        totalPages = totalEmails / NoOfEmailsPerPage;
    else
        totalPages = ((totalEmails - mod) / NoOfEmailsPerPage) + 1;
    for (int i = 0; i < emails.Count; i++)
    {
        Email email = emails[i];
        int emailId = ((page - 1) * NoOfEmailsPerPage) + i + 1;
        TableCell noCell = new TableCell();
        noCell.CssClass = "emails-table-cell";
        noCell.Text = Convert.ToString(emailId);
        TableCell fromCell = new TableCell();
        fromCell.CssClass = "emails-table-cell";
        fromCell.Text = email.From;
        TableCell subjectCell = new TableCell();
        subjectCell.CssClass = "emails-table-cell";
        subjectCell.Style["width"] = "300px";
        subjectCell.Text = String.Format(DisplayEmailLink, emailId, email.Subject);
        TableCell dateCell = new TableCell();
        dateCell.CssClass = "emails-table-cell";
        if (email.UtcDateTime != DateTime.MinValue)
            dateCell.Text = email.UtcDateTime.ToString();
        TableRow emailRow = new TableRow();
        emailRow.Cells.Add(noCell);
        emailRow.Cells.Add(fromCell);
        emailRow.Cells.Add(subjectCell);
        emailRow.Cells.Add(dateCell);
        EmailsTable.Rows.AddAt(2 + i, emailRow);
    }
    if (totalPages > 1)
    {
        if (page > 1)
            PreviousPageLiteral.Text = String.Format(SelfLink, page - 1, "Previous Page");
        if (page > 0 && page < totalPages)
            NextPageLiteral.Text = String.Format(SelfLink, page + 1, "Next Page");
    }
    EmailFromLiteral.Text = Convert.ToString(((page - 1) * NoOfEmailsPerPage) + 1);
    EmailToLiteral.Text = Convert.ToString(page * NoOfEmailsPerPage);
    EmailTotalLiteral.Text = Convert.ToString(totalEmails);
    EmailLiteral.Text = emailAddress;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:10:23.913

`Pop3Client`您似乎已经向您的代码隐藏类添加了一个带有参数的构造函数。这意味着您的类不再包含无参数构造函数。ASP.NET 要求存在这样的构造函数，以便在首次加载页面时对其进行编译。

没有理由在 ASP.NET 页面的代码隐藏中包含构造函数，因此您可能应该将其删除，但添加无参数构造函数也应该可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:05:38.987

该错误表明您在某处拥有`new EmailReader.Pop3Client()`. 您显示的代码没有该错误。

所以有问题的代码必须在其他地方。

# php - 如何组合来自 2 个数据库列的文本并将结果插入另一列？

> ID：13361392
> 
> 赞同：3
> 
> 时间：2012-11-13T13:17:00.117
> 
> 标签：php, mysql

我试图编写一个代码，我可以将数据库中第 1 列的第一个字母与第 2 列的文本结合起来，并将结果插入另一列

基本上这就是我想要发生的事情

从

```
first_name    last_name    username
Lorem         Ipsum 
```

进入

```
first_name    last_name    username
Lorem         Ipsum        lipsum 
```

处理这个问题的最佳方法是什么？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:18:26.550

```
UPDATE tableName
SET username = CONCAT(SUBSTRING(LOWER(first_name),1,1),LOWER(last_name)) 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/bb5a9/1)

# javascript - jQuery 元素

> ID：13361394
> 
> 赞同：3
> 
> 时间：2012-11-13T13:17:05.063
> 
> 标签：javascript, jquery, html, css

我正在做一个小项目，但遇到了问题。我正在使用 jQuery 创建新元素。所以因为页面加载时它们不在文档中，所以我无法以任何方式操作它们。有没有办法让 jQuery 读取新元素以解决我的问题？

```
$("img.fbimg").click(function(){
    $(this).hide();
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:18:13.353

您需要使用事件委托：

```
$("body").on("click", "img.fbimg", function() {
    $(this).hide();
}); 
```

*在这里*，您可以`"body"`替换为.*`img.fbimg`*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:18:01.197

你似乎需要

```
$(document.body).on('click', "img.fbimg", function(){
    $(this).hide();
}); 
```

即使`click`在选择器为`"img.fbimg"`.

请注意，如果您有一个更精确的元素包含您的图像并在加载时存在，那么使用它会更有效

```
$('#idOfElementContainingAllTheImages').on('click', "img.fbimg", function(){ 
```

[参考](http://api.jquery.com/on/)*

# ruby-on-rails - “TypeError：无法在生产模式下调用未定义的方法‘write’”

> ID：13361398
> 
> 赞同：1
> 
> 时间：2012-11-13T13:17:11.807
> 
> 标签：ruby-on-rails, deployment, production, actionview

当我在本地系统上运行我的小应用程序时，一切正常。当我开始生产时，我收到错误 500 消息（很抱歉，出现了问题。）。我的 production.log 字段显示如下：

```
Started GET "/" for 79.203.113.136 at 2012-11-13 13:54:06 +0100
Processing by DayviewController#index as HTML
  Rendered dayview/index.html.erb within layouts/application (0.4ms)
Completed 500 Internal Server Error in 1783ms

ActionView::Template::Error (TypeError: Cannot call method 'write' of undefined
at /tmp/execjs20121113-27948-1cczq8s.js:5043:20
at /tmp/execjs20121113-27948-1cczq8s.js:5057:16
at /tmp/execjs20121113-27948-1cczq8s.js:1:92
at Object.<anonymous> (/tmp/execjs20121113-27948-1cczq8s.js:1:109)
at Module._loadContent (node.js:667:21)
at node.js:695:20
at node.js:304:23
at node.js:756:9

(in /home/www/pvdaheim/app/assets/javascripts/jquery-1.8.2.min.js)):
5:   <%= stylesheet_link_tag    "application", :media => "all" %>
6:   <%= javascript_include_tag "application" %>
7:   <%= javascript_include_tag :defaults %>  
8:   <%= javascript_include_tag "jquery-1.8.2.min", "jquery-ui-1.8.23.custom.min", "jquery.ui.datepicker", "rails", "highcharts", "highstock" %>
9:   <%= csrf_meta_tags %>
10: </head>
11: <body>
 app/views/layouts/application.html.erb:8:in `_app_views_layouts_application_html_erb___1022895261_93021610' 
```

我没有名为 /tmp/execjs20121113-27948-1cczq8s.js 的文件。我在论坛中发现了一些类似的问题，但没有一个对我的修复有帮助。

谢谢和问候， 安德烈亚斯

这是我的 index.html.erb：

```
<div id="container2" style="height:500px; background-color:#999999; border:thin solid">
</div>

<script type="text/javascript" src="./pv_andreas/wr.js"></script>?
<script type='text/javascript'>//<![CDATA[ 

$(function() {
    var chart = new Highcharts.StockChart({
    ... highstock stuff rendered to container2...
});
//]]>
</script> 
```

这是我的 routes.rb：

```
Pvdaheim::Application.routes.draw do
  get "dayview/index"
  root :to => 'dayview#index'
end 
```

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-13T20:00:43.017

在您的路线文件中删除`get "dayview/index"`，它将起作用。

# extjs4 - 如何在 Ext JS 网格列中添加多个渲染器

> ID：13361400
> 
> 赞同：0
> 
> 时间：2012-11-13T13:17:16.210
> 
> 标签：extjs4

我有 Ext JS 网格，其中有一个数字列，我想在其中添加两种类型的渲染器 1.colorRenderer：此渲染器将根据值小于零或大于零来决定是否以红色或绿色显示数值零 2\. formatRenderer：此渲染器用于将数值格式化为 2 位小数

在列中添加类似的东西不起作用

渲染器：colorRenderer、formatRenderer

我可以编写另一个 ClubbedRenderer 并在其中调用这两个渲染器的一种方法，但这将导致解决方案无法扩展，并且如果新渲染器出现，它需要获得所有排列组合

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:53:40.973

这有什么问题：

```
renderer: function( aValue, aMeta, aRecord )
{
    aMeta.style = aValue >= 0 ? "color: #00FF00;" : "color: #FF0000;";
    return Ext.util.Format.number( aValue, '0.00' );
} 
```

看到一个工作[JsFiddle](http://jsfiddle.net/Izhaki/9XR7x/1/)。

# mysql - 优化另一个表中可选字段的查询

> ID：13361401
> 
> 赞同：3
> 
> 时间：2012-11-13T13:17:47.770
> 
> 标签：mysql, optimization, count, large-scale

我有一个名为**items**的 innodb 表，它为一个电子商务网站提供动力。搜索系统允许您搜索可选/附加字段，这样您就可以仅搜索维修过的计算机或仅超过 2000 年的汽车。

这是通过名为**items_fields**的附加表完成的。它有一个非常简单的设计：

```
+------------+------------------------+------+-----+---------+----------------+
| id         | int(11)                | NO   | PRI | NULL    | auto_increment |
| field_id   | int(11)                | NO   | MUL | NULL    |                |
| item_id    | int(11)                | NO   | MUL | NULL    |                |
| valueText  | varchar(500)           | YES  |     | NULL    |                |
| valueInt   | decimal(10,1) unsigned | YES  |     | NULL    |                |
+------------+------------------------+------+-----+---------+----------------+ 
```

还有一个名为**fields**的表，其中仅包含字段名称和类型。

返回搜索结果的主要查询如下：

```
SELECT items...   
FROM items   
WHERE items... AND (  
      SELECT count(id)  
      FROM items_fields    
      WHERE items_fields.field_id = "59" AND items_fields.item_id = items.id AND
      items_fields.valueText = "Damaged")>0  
ORDER by ordering desc LIMIT 35; 
```

在大规模（每天仅超过 400 万个搜索查询）上，我需要进一步优化这些高级搜索。目前，平均高级搜索查询大约需要 100 毫秒。

我怎样才能加快这个查询？您还有其他优化建议吗？两个表都是innodb，服务器堆栈绝对很棒，但是我仍然要解决这个查询:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:22:38.877

添加和索引 (item_id, field_id, valueText) 因为这是您的搜索。

摆脱内部选择！！！MySQL 最高 5.5 无法使用内部选择优化查询。据我所知，MariaDB 5.5 是目前唯一支持内部选择优化的 MySQL 替代品。

```
 SELECT i.*, f2.* as damageCounter FROM items i  
    JOIN items_fields f ON f.field_id = 59
                       AND f.item_id = i.id
                       AND f.valueText = "Damaged"
   JOIN item_fields f2 ON f2.item_id = i.id
   ORDER by i.ordering desc 

   LIMIT 35; 
```

第一个连接将限制返回的集合。第二次加入将获取满足第一次加入的项目的所有 item_fields。在第一个和最后一个连接之间，您可以添加更多连接条件，这些条件将根据附加点过滤掉结果。例如：

```
 SELECT i.*, f3.* as damageCounter FROM items i  
    JOIN items_fields f ON f.field_id = 59
                       AND f.item_id = i.id
                       AND f.valueText = "Damaged"
   JOIN items_fields f2 ON f2.field_id = 22
                       AND f2.item_id = i.id
                       AND f.valueText = "Green"
   JOIN item_fields f3 ON f3.item_id = i.id
   ORDER by i.ordering desc 

   LIMIT 35; 
```

这将返回所有项目的结果集，其中字段 59 的值为“已损坏”，字段 22 的值为“Green”以及它们的所有 item_fields。

# java - 卷曲和形式 - 不重定向到页面

> ID：13361403
> 
> 赞同：2
> 
> 时间：2012-11-13T13:17:54.117
> 
> 标签：java, php, javascript, jquery, curl

我有两页：

**一个.php**

```
<?php if($_POST && $_POST['captcha'] == 'thisisrandom'){
    echo 'KEY = ' . uniqid();
} ?>
<form action="one.php" method="POST">
    NAME: <input type="text" name="name"> <br />
    CAPTCHA: <input type="text" name="captcha"> <br />

    <input type="submit">
</form> 
```

**二.php**

```
<?php
function get_web_page($url)
{
        //echo "curl:url<pre>".$url."</pre><BR>";
    $options = array(
        CURLOPT_RETURNTRANSFER => true,     // return web page
        CURLOPT_HEADER         => false,    // don't return headers
        CURLOPT_FOLLOWLOCATION => true,     // follow redirects
        CURLOPT_ENCODING       => "",       // handle all encodings
        CURLOPT_USERAGENT      => "spider", // who am i
        CURLOPT_AUTOREFERER    => true,     // set referer on redirect
        CURLOPT_CONNECTTIMEOUT => 15,      // timeout on connect
        CURLOPT_TIMEOUT        => 15,      // timeout on response
        CURLOPT_MAXREDIRS      => 10,       // stop after 10 redirects

    );

    $ch      = curl_init($url);
    curl_setopt_array( $ch, $options );
    $content = curl_exec( $ch );
    $err     = curl_errno( $ch );
    $errmsg  = curl_error( $ch );
    $header  = curl_getinfo( $ch,CURLINFO_EFFECTIVE_URL );
    curl_close( $ch );

    $header['errno']   = $err;
    $header['errmsg']  = $errmsg;

    //change errmsg here to errno
    if ($errmsg)
    {
        echo "CURL:".$errmsg."<BR>";
    }
    return $content;
}
print_r(get_web_page('http://localhost/one.php'));
?> 
```

我打开页面**two.php**。这向我展示了**one.php**的表单。这没关系，但如果我提交表单，那么这会将我重定向到**one.php**。如何在 two.php 页面上填写此表单**、**提交表单并在 one.php 页面上从 one.php 接收数据**而**无需**重定向**？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:58:35.847

您可以通过 Jquery 进行 AJAX Post 调用，以防止在提交表单时重定向。

首先从表单元素中删除 action 属性。HTML 应如下所示：

```
<form method="POST">
    <label for="name">NAME:</label><input type="text" name="name" />
    <label for="captcha">CAPTCHA:</label><input type="text" name="captcha" />
    <input type="submit" />
</form> 
```

**其次，在one.php**中监听表单提交按钮，并在单击时进行 ajax post 调用。您可以使用[jquery 序列化函数](http://api.jquery.com/serialize/)从输入值创建数据集。并且由于 one.php 和 two.php 不在同一个域中，您应该使用[jquery getjson](http://api.jquery.com/jQuery.getJSON/)选项来获取数据。

```
$(document).ready(function() {
    $('form input[type=submit]').click(function(event) {
        event.preventDefault();
        var formData = $(this).closest('form').serialize();
        $.ajax({
                type: 'POST',
                url: 'one.php',
                data: formData,
                dataType: 'json',
                success: function(data) {
                   // do your work here
                }
            });
     });
}); 
```

作为最后一件事，您需要使用 php 函数[json_encode](http://php.net/manual/en/function.json-encode.php)格式化您的 php 输出。所以**one.php**应该是这样的：

```
<?php if($_POST && $_POST['captcha'] == 'thisisrandom'){
    $arr["key"]= "KEY";
    $arr["value"]= uniqid();
    echo json_encode($arr);
} ?> 
```

# gwt - 使用 xml 文件中的接口 (gwt mvp)

> ID：13361412
> 
> 赞同：0
> 
> 时间：2012-11-13T13:18:29.590
> 
> 标签：gwt, mvp, uibinder

我正在使用[GWT MVP II](https://developers.google.com/web-toolkit/articles/mvp-architecture-2)（带有 UiBinder），我有一个问题。假设我有一个小部件，其中包括：

*   **CoolButtonView.ui.xml** - UiBinder 的 xml

*   **CoolButtonView.java** - 视图的界面

*   **CoolButtonViewImp.java** - 实现 CoolButtonView.java 并包含对 CoolButtonPresenter 的引用

*   **CoolButtonPresenter.java** - 演示者界面

*   **CoolButtonPresenterImpl.java** - 实现 CoolButtonPresenter 并包含对 CoolButtonView 的引用

我正在尝试通过这样的界面在其他小部件 xml 中使用它：< r:CoolButtonView ui:field="myButton" />，但出现错误：

```
 Invoking generator com.google.gwt.uibinder.rebind.UiBinderGenerator
    Not allowed in an HTML context Element 
    <r:CoolButtonView ui:field='CoolButtonView' /> 
```

但是，如果我通过视图使用我的小部件，一切都很好： < r:CoolButtonViewImpl ui:field="myButton" /> 但我认为这是不正确的。

我应该在 xml 文件中使用接口吗？如果我应该，什么是正确的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:44:01.183

它应该工作，但你`@UiField`应该是`provided=true`。

请参阅[https://code.google.com/p/google-web-toolkit/issues/detail?id=5662](https://code.google.com/p/google-web-toolkit/issues/detail?id=5662)和[https://code.google.com/p/google-web-toolkit/issues/detail?id =5879](https://code.google.com/p/google-web-toolkit/issues/detail?id=5879)

你是否应该这样做是另一个“可能会引发辩论、争论、投票或扩展讨论”的故事，而 StackOverflow 不适合此类问题：请参阅[https://stackoverflow.com/faq#close](https://stackoverflow.com/faq#close)

# cordova - 在 iPhone UIWebview 上截取屏幕外绘制的 SVG

> ID：13361415
> 
> 赞同：3
> 
> 时间：2012-11-13T13:18:38.953
> 
> 标签：cordova, uiwebview, svg, mobile-safari

我目前正在使用 PhoneGap 开发 iPhone 应用程序。在这个应用程序中，我经常使用 SVG 图像。

我在 HTML <object> 标签中加载这些 SVG 图像，以便传递参数并允许脚本执行（当 SVG 加载到图像标签中时，脚本不会执行）。

当 SVG 图像加载到屏幕上时，一切正常，但是当它在屏幕外渲染时（如我们的“寻呼机”控件的情况），它会被剪裁，并且只有在加载时可见的任何部分被画。

1.  有没有其他人有这个问题？你怎么修好它的？
2.  有没有人对如何强制对象标签定期重绘有任何想法（如果我更改为 img 标签，它会正确绘制，但没有可用的参数或脚本。）

# html - 100% 高度和宽度 DIV，中间有内容

> ID：13361419
> 
> 赞同：1
> 
> 时间：2012-11-13T13:19:10.120
> 
> 标签：html, css

我已经为此搜索了很多答案，并尝试了多人不同的解决方案，但都没有奏效。有没有人有一个简单的方法来做到这一点？

示例图片：

![中间的内容](../Images/6f3ac86d8f42e1697c80b126aa595f7a.png)

边框应`20px`远离浏览器的所有边缘。非常感谢任何可以提供帮助的人。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:21:08.953

在 div 上试试这个 css：

```
position: absolute;
bottom: 20px;
top: 20px;
left: 20px;
right: 20px;
text-align: center; 
```

垂直对齐问题：据我所知，您不能`vertical-align: middle;`在块上使用。只有知道内容高度（或使用 javascript）才能解决问题。

您可以使用`padding-top: 50%;`，但它并不是真正的“中间”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:33:28.227

这在某种程度上是一种比上面回答的方法更敏感的方法。我希望它有帮助

**css**

```
#wrapper
{
    position:absolute;
    width:100%;
    height:100%;
    border:20px solid #F82;
}
#content
{
    position:relative;
    margin-left:auto;
    margin-right:auto;
    height:20%;
    width:20%;
    top:40%;
    color:#E22;
    font-size:40pt;
} 
```

**​html**

 **```
<div id="wrapper">
    <div id="content">Content</div>
</div>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

这是一个功能[小提琴](http://jsfiddle.net/brunovieira/KQ2Mq/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:33:08.903

我更新了演示，中间还有内容，请看这个[演示](http://jsfiddle.net/d22gs/3/)

```
div{
position:absolute;
text-align:center;
width:100%;
height:100%;
bottom: 20px;
top: 20px;
left: 20px;
right: 20px;
padding:50% 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:33:17.743

这是一个内容垂直居中的示例：

**HTML**

```
<div id="box">
    <div id="content">
        Content
    </div>
</div>​ 
```

**CSS**

```
#box {
    width: 200px;
    height: 200px;
    border: solid 5px #CCC;
    margin: 20px;
    position:relative
}
#content {
    position:absolute;
    top: 50%;
    width: 100%;
    margin-top:-10px; /* Should be half of font-size */
    font-size: 20px;
    text-align: center;
    color: red;
    font-family: "Helvetica", "Lucida Sans", "Lucida Sans Unicode", "Luxi Sans", Tahoma, sans-serif;
} 
```

这是产生以下结果的[示例代码：](http://jsfiddle.net/Kf9NP/)

![div中的居中内容](../Images/3ba8aadd0de63269a8f180d0a0b84dc0.png)

* * *

**编辑**（如果内容多于一行，则替代）

与以前相同的 HTML，带有以下 CSS（[演示代码](http://jsfiddle.net/Kf9NP/2/)）。

```
#box {
    width: 200px;
    height: 200px;
    border: solid 5px #CCC;
    margin: 20px;
}
#content {
    width: 200px;
    height: 200px;
    display: table-cell;
    vertical-align: middle;
    text-align: center;

    color: red;
    font-size: 20px;
    font-family: "Helvetica", "Lucida Sans", "Lucida Sans Unicode", "Luxi Sans", Tahoma, sans-serif;
} 
```

![居中的三行内容](../Images/70e4105c39900b2581d9544113053e4b.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T13:37:18.393

这个 CSS 也适用于 content-div

```
position:absolute;
margin-left: 20%;
width: 60% (100%-margin-left*2); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-13T14:07:18.563

```
<html>
<head>
    <title>20PX</title>
<style type="text/css">
body{
background-color: blue;}
#test {
position: absolute;
bottom: 20px;
right: 20px;
top: 20px;
left: 20px;
text-align: center;
background-color: red;
}
</style>
</head>
<body>
    <div id="test">
     center text 
    </div>
</body>
</html> 
```**

# c++ - 使用时出现 C++ 错误

> ID：13361423
> 
> 赞同：-7
> 
> 时间：2012-11-13T13:19:36.623
> 
> 标签：c++

我不断收到实例化错误。尝试修复它，无论如何，我似乎无法实现 SET。尝试使用向量，但我不知道如何正确实现相等运算符并且也失败了。

起初我使用向量，但在尝试保持 x 和 y 值唯一时很难使用。意思是，我会阅读一个数据文本文件。 `Point1, [3, 10]` `Point2, [10, 10]`

因此点 1 将与点 2 转到不同的向量，然后分别存储数据。但不知何故，在文本文件中有 Point1, [3, 10] 的重复值。我不想插入另一个相同的记录并希望它们是独一无二的。所以我尝试使用 set 但我无法真正插入数据。

错误是：

> 在成员函数 'bool std::les<_Tp>::operator()(const _Tp&, const _Tp&) const [with _Tp = Point]': STL_TREE.h:980: 从 'std::pair::iterator 实例化， bool> std::_Rb_tree<_Key,.... STL_SET.h:307: 实例化自 'std::pair, _Compare, typename _Alloc::rebind<_Key>::other>::const_interator, bool> std::设置..... main.cpp：141：从这里实例化stl_function.h：227：错误：'_ *x <* _y'中的'operator<'不匹配

点.h

```
#ifndef POINT_H
#define POINT_H 

#include <iostream>
#include <ostream>
#include <fstream>
#include <sstream>
#include <vector>
#include <math.h>
#include <set>
#include <string.h>
#include <string>
#include <stdio.h>

using namespace std;

class Point
{
    friend ostream& operator<<(ostream&, const Point&);

    protected:
        int x, y;

    public:
        //c'tor
        Point(int xx, int yy);

        //setters
        void setX(int x1);
        void setY(int y1);

        //getters
        int getX() const {return x;};
        int getY() const {return y;};
};

Point::Point(int xx, int yy) : x(xx), y(yy)
{

}

void Point::setX(int x1)
{
    x=x1;
}

void Point::setY(int y1)
{
    y=y1;
}

#endif 
```

主文件

```
#include "Point.h"
#include <iostream>
#include <ostream>
#include <fstream>
#include <sstream>
#include <set>
#include <math.h>
#include <set>
#include <string.h>
#include <string>
#include <stdio.h>
#include <map>
#include <algorithm>
#include <map>

using namespace std;

class Main
{
    public: 
        void mainMenu();
        void stringToUpper(string &s);
};

void stringToUpper(string &s)
{
    for(unsigned int l=0; l < s.length(); l++)
    {
        s[l] = toupper(s[l]);    
    }
}

void Main::mainMenu()
{
    cout<<"1)   type filename and read data"<<endl;
    cout<<"2)   View data"<<endl;    
    cout<<"Q)   Enter 'Q' to quit"<<endl<<endl;
}

int main()
{
    Main main;
    char menuChoice;
    bool quit=false;
    int count = 0;

    set<Point> p;

    while ( !quit)
    {
        main.mainMenu();
        cout << "Please enter your choice : ";
        cin>>menuChoice;
        menuChoice = toupper(menuChoice);

        switch(menuChoice)
        {
            case '1':
                {
                    string line, name;
                    char filename[50];
                    int x,y;

                    cout << "Please enter filename : ";
                    cin >> filename;

                    ifstream myfile(filename);
                    if (myfile.is_open())
                    {
                        while ( myfile.good() )
                        {
                            getline(myfile, line);
                            {      
                                for (unsigned int i = 0; i < line.size(); ++i) 
                                {
                                    if (line[i] == '[' || line[i] == ']' || line[i] == ',') 
                                    {
                                        line[i] = ' ';
                                    }
                                    istringstream in(line);
                                    in >> name >> x >> y;                                  
                                }
                                if(name == "Point")
                                {
                                p.insert(Point(x,y))    }                        
                            }                                
                            count++;
                        }    
                        myfile.close();
                        cout << count;
                    }
                    else cout<< "Unable to open file";
                }
                break;                             
            case '2':
                {
                cout<<"view data"<<endl;
                }                   
            case 'Q':
                cout<<"You have chosen to quit!"<<endl;
                quit=true;
                exit(0);
            default:
                cout<<"Invalid entry"<<endl<<endl;
                break;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:21:38.427

如果您想将 Point 放入一个集合中，那么 set 需要一种将一个 Point 与另一个进行比较的方法，以便将它们按顺序排列。你必须声明这个函数

```
bool operator<(const Point& p1, const Point& p2)
{
    ...
} 
```

这样做，您将能够实例化`std::set<Point>`

通常的实现是

```
bool operator<(const Point& p1, const Point& p2)
{
    return p1.x < p2.x || p1.x == p2.x && p1.y < p2.y;
} 
```

`operator<`只要您遵守*严格的弱排序*规则，顺序是什么并不重要（我假设否则您可能已经意识到您需要更早） 。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:23:10.237

`std::set`需要一个比较函数或函子来比较两个`Points`并应用严格的弱排序。`Point`您可以通过提供小于比较函数来实现这一点。

您可以使用以下方法轻松实现`std::tie`：

```
#include <tuple> // for std::tie

class Point
{
    // rest as before
    friend bool operator<(const Point& lhs, const Point& rhs)
    {
      return std::tie<lhs.x, lhs.y> < std::tie<rhs.x, rhs.y>;
    }
}; 
```

# java - 初学者——Spring/hibernate集成，asm不兼容

> ID：13361424
> 
> 赞同：1
> 
> 时间：2012-11-13T13:19:39.743
> 
> 标签：java, mysql, spring, hibernate

我是 spring/hibernate 的初学者，并尝试运行一些简单的 web 应用程序来访问远程数据库上的数据。

我正在使用 Netbeans 7.2，而数据库在 Mysql 5.X 上

我创建了一个带有 'id' 和 'name' 列以及一些条目的虚拟 'User' 表。我从一个索引页面开始，该页面带有指向从数据库获取用户信息的用户页面的链接。当我单击指向用户页面的链接时，出现以下错误：

org.springframework.web.util.NestedServletException：处理程序处理失败；嵌套异常是 java.lang.ExceptionInInitializerError

有人能帮我吗？

注意：首先对不起，如果我做错了什么对不起

代码 ：

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"     xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
<context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/applicationContext.xml</param-value>
    </context-param>
    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>
    <servlet>
        <servlet-name>dispatcher</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>2</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>dispatcher</servlet-name>
        <url-pattern>*.htm</url-pattern>
    </servlet-mapping>
    <session-config>
        <session-timeout>
            30
        </session-timeout>
    </session-config>
    <welcome-file-list>
        <welcome-file>redirect.jsp</welcome-file>
    </welcome-file-list>
</web-app> 
```

调度程序-servlet.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">

    <bean class="org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping"/>

    <bean id="userController" class="Controller.UserController" />

    <!--
    Most controllers will use the ControllerClassNameHandlerMapping above, but
    for the index controller we are using ParameterizableViewController, so we must
    define an explicit mapping for it.
    -->
    <bean id="urlMapping" class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping">
        <property name="mappings">
            <props>
                <prop key="index.htm">indexController</prop>
                <prop key="user.htm">userController</prop>
            </props>
        </property>
    </bean>

    <bean id="viewResolver"
          class="org.springframework.web.servlet.view.InternalResourceViewResolver"
          p:prefix="/WEB-INF/jsp/"
          p:suffix=".jsp" />

    <!--
    The index controller.
    -->
    <bean name="indexController"
          class="org.springframework.web.servlet.mvc.ParameterizableViewController"
          p:viewName="index" />
</beans> 
```

应用上下文.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xmlns:aop="http://www.springframework.org/schema/aop"
       xmlns:tx="http://www.springframework.org/schema/tx"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
       http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.5.xsd
       http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.5.xsd">

    <!--bean id="propertyConfigurer"
          class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"
          p:location="/WEB-INF/jdbc.properties" />

<bean id="dataSource"
    class="org.springframework.jdbc.datasource.DriverManagerDataSource"
    p:driverClassName="${jdbc.driverClassName}"
    p:url="${jdbc.url}"
    p:username="${jdbc.username}"
    p:password="${jdbc.password}" /-->

    <!-- ADD PERSISTENCE SUPPORT HERE (jpa, hibernate, etc) -->

</beans> 
```

休眠.cfg.xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC "-//Hibernate/Hibernate Configuration DTD 3.0//EN" "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
  <session-factory>
    <property name="hibernate.dialect">org.hibernate.dialect.MySQLDialect</property>
    <property name="hibernate.connection.driver_class">com.mysql.jdbc.Driver</property>
    <property name="hibernate.connection.url">jdbc:mysql://******:3306/EPGV_Interface?zeroDateTimeBehavior=convertToNull</property>
    <property name="hibernate.connection.username">*****</property>
    <property name="hibernate.connection.password">*****</property>
    <mapping resource="Model/User.hbm.xml"/>
  </session-factory>
</hibernate-configuration> 
```

休眠.reveng.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-reverse-engineering PUBLIC "-//Hibernate/Hibernate Reverse Engineering DTD 3.0//EN"     "http://hibernate.sourceforge.net/hibernate-reverse-engineering-3.0.dtd">
<hibernate-reverse-engineering>
  <schema-selection match-catalog="EPGV_Interface"/>
  <table-filter match-name="User"/>
</hibernate-reverse-engineering> 
```

HibernateUtil.java

```
package Model;

import org.hibernate.cfg.AnnotationConfiguration;
import org.hibernate.SessionFactory;

public class HibernateUtil {

    private static final SessionFactory sessionFactory;

    static {
        try {
            // Create the SessionFactory from standard (hibernate.cfg.xml) 
            // config file.
            sessionFactory = new AnnotationConfiguration().configure().buildSessionFactory();
        } catch (Throwable ex) {
            // Log the exception. 
            System.err.println("Initial SessionFactory creation failed." + ex);
            throw new ExceptionInInitializerError(ex);
        }
    }

    public static SessionFactory getSessionFactory() {
        return sessionFactory;
    }
} 
```

用户.java

```
package Model;
// Generated 13 nov. 2012 11:00:50 by Hibernate Tools 3.2.1.GA
/**
 * User generated by hbm2java
 */
public class User  implements java.io.Serializable {
     private Integer id;
     private String name;
    public User() {
    }
    public User(String name) {
       this.name = name;
    }
    public Integer getId() {
        return this.id;
    }
    public void setId(Integer id) {
        this.id = id;
    }
    public String getName() {
        return this.name;
    }
    public void setName(String name) {
        this.name = name;
    }
} 
```

用户.hbm.xml：

```
<?xml version="1.0"?>
<!DOCTYPE hibernate-mapping PUBLIC "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
"http://hibernate.sourceforge.net/hibernate-mapping-3.0.dtd">
<!-- Generated 13 nov. 2012 11:00:50 by Hibernate Tools 3.2.1.GA -->
<hibernate-mapping>
    <class name="Model.User" table="User" catalog="EPGV_Interface">
        <id name="id" type="java.lang.Integer">
            <column name="id" />
            <generator class="identity" />
        </id>
        <property name="name" type="string">
            <column name="name" length="45" />
        </property>
    </class>
</hibernate-mapping> 
```

用户控制器.java

```
package Controller;

import Model.HibernateUtil;
import java.util.List;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import org.hibernate.Session;
import org.springframework.web.servlet.ModelAndView;
import org.springframework.web.servlet.mvc.Controller;

public class UserController implements Controller {

    @Override
    public ModelAndView handleRequest(HttpServletRequest hsr, HttpServletResponse hsr1) throws Exception {
        ModelAndView mv = new ModelAndView("user");
        try 
        {
            Session session = HibernateUtil.getSessionFactory().getCurrentSession();
            session.beginTransaction();
            List result = session.createQuery(" from User").list();
            mv.addObject("users", result);
            session.getTransaction().commit();
        } 
        catch (Exception e) 
        {
               e.printStackTrace();
        }    
        return mv; 
    }
} 
```

重定向.jsp：

```
<%--
Views should be stored under the WEB-INF folder so that
they are not accessible except through controller process.

This JSP is here to provide a redirect to the dispatcher
servlet but should be the only JSP outside of WEB-INF.
--%>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<% response.sendRedirect("index.htm"); %> 
```

索引.jsp：

```
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
    "http://www.w3.org/TR/html4/loose.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Portail</title>
    </head>

    <body>
        <a href="user.htm">Go to user</a>
    </body>
</html> 
```

用户.jsp：

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<%@page contentType="text/html" pageEncoding="UTF-8"%>
<!DOCTYPE html>

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>test</title>
    </head>
    <body>
        <br>
        <table>
            <tr>
                <td>Id</td>
                <td>Name</td>
            </tr>
            <c:forEach items="${users}" var="user">
            <tr>
                <td><c:out value="${user.id}"></c:out></td>
                <td><c:out value="${user.name}"></c:out></td>
            </tr>
            </c:forEach>
        </table>
    </body>
</html> 
```

编辑：来自 glassfish 服务器管理控制台的日志

我的管理员授予我访问 glassfish 管理控制台的登录权限，这是我为“会话”获得的

```
2740    INFO    Redirecting to /index.jsf(details)  org.glassfish.admingui  13 nov. 2012 17:49:17.005   _ThreadID=2631;_ThreadName=Thread-2;

2741    INFO    Admin Console: Initializing Session Attributes...(details)  org.glassfish.admingui  13 nov. 2012 17:49:17.025   _ThreadID=2635;_ThreadName=Thread-2;

2742    INFO    WebModule[null] ServletContext.log():Destroying Spring FrameworkServlet 'dispatcher'(details)   javax.enterprise.system.container.web.com.sun.enterprise.web    13 nov. 2012 17:49:51.886   _ThreadID=2632;_ThreadName=Thread-2;

2743    INFO    Closing WebApplicationContext for namespace 'dispatcher-servlet': startup date [Tue Nov 13 17:45:18 ... (details)   org.springframework.web.context.support.XmlWebApplicationContext    13 nov. 2012 17:49:51.886   _ThreadID=2632;_ThreadName=Thread-2;

2744    INFO    Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@44442f... (details)   org.springframework.beans.factory.support.DefaultListableBeanFactory    13 nov. 2012 17:49:51.887   _ThreadID=2632;_ThreadName=Thread-2;

2745    INFO    WebModule[null] ServletContext.log():Closing Spring root WebApplicationContext(details)     javax.enterprise.system.container.web.com.sun.enterprise.web    13 nov. 2012 17:49:51.890   _ThreadID=2632;_ThreadName=Thread-2;

2746    INFO    Closing Root WebApplicationContext: startup date [Tue Nov 13 17:45:18 CET 2012]; root of context hie... (details)   org.springframework.web.context.support.XmlWebApplicationContext    13 nov. 2012 17:49:51.890   _ThreadID=2632;_ThreadName=Thread-2;

2747    INFO    Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@176be9... (details)   org.springframework.beans.factory.support.DefaultListableBeanFactory    13 nov. 2012 17:49:51.891   _ThreadID=2632;_ThreadName=Thread-2;

2748    INFO    WebModule[null] ServletContext.log():No Spring WebApplicationInitializer types detected on classpath(details)   javax.enterprise.system.container.web.com.sun.enterprise.web    13 nov. 2012 17:49:54.256   _ThreadID=2256;_ThreadName=Thread-2;

2749    INFO    WebModule[null] ServletContext.log():Initializing Spring root WebApplicationContext(details)    javax.enterprise.system.container.web.com.sun.enterprise.web    13 nov. 2012 17:49:54.312   _ThreadID=2256;_ThreadName=Thread-2;

2750    INFO    Root WebApplicationContext: initialization started(details)     org.springframework.web.context.ContextLoader   13 nov. 2012 17:49:54.312   _ThreadID=2256;_ThreadName=Thread-2;

2751    INFO    Refreshing Root WebApplicationContext: startup date [Tue Nov 13 17:49:54 CET 2012]; root of context ... (details)   org.springframework.web.context.support.XmlWebApplicationContext    13 nov. 2012 17:49:54.432   _ThreadID=2256;_ThreadName=Thread-2;

2752    INFO    Loading XML bean definitions from ServletContext resource [/WEB-INF/applicationContext.xml](details)    org.springframework.beans.factory.xml.XmlBeanDefinitionReader   13 nov. 2012 17:49:54.503   _ThreadID=2256;_ThreadName=Thread-2;

2753    INFO    Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory... (details)   org.springframework.beans.factory.support.DefaultListableBeanFactory    13 nov. 2012 17:49:54.572   _ThreadID=2256;_ThreadName=Thread-2;

2754    INFO    Root WebApplicationContext: initialization completed in 262 ms(details)     org.springframework.web.context.ContextLoader   13 nov. 2012 17:49:54.574   _ThreadID=2256;_ThreadName=Thread-2;

2755    INFO    WebModule[null] ServletContext.log():Initializing Spring FrameworkServlet 'dispatcher'(details)     javax.enterprise.system.container.web.com.sun.enterprise.web    13 nov. 2012 17:49:54.607   _ThreadID=2256;_ThreadName=Thread-2;

2756    INFO    FrameworkServlet 'dispatcher': initialization started(details)  org.springframework.web.servlet.DispatcherServlet   13 nov. 2012 17:49:54.607   _ThreadID=2256;_ThreadName=Thread-2;

2757    INFO    Refreshing WebApplicationContext for namespace 'dispatcher-servlet': startup date [Tue Nov 13 17:49:... (details)   org.springframework.web.context.support.XmlWebApplicationContext    13 nov. 2012 17:49:54.611   _ThreadID=2256;_ThreadName=Thread-2;

2758    INFO    Loading XML bean definitions from ServletContext resource [/WEB-INF/dispatcher-servlet.xml](details)    org.springframework.beans.factory.xml.XmlBeanDefinitionReader   13 nov. 2012 17:49:54.612   _ThreadID=2256;_ThreadName=Thread-2;

2759    INFO    Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory... (details)   org.springframework.beans.factory.support.DefaultListableBeanFactory    13 nov. 2012 17:49:54.651   _ThreadID=2256;_ThreadName=Thread-2;

2760    INFO    Mapped URL path [/user*] onto handler 'userController'(details)     org.springframework.web.servlet.mvc.support.ControllerClassNameHandlerMapping   13 nov. 2012 17:49:54.670   _ThreadID=2256;_ThreadName=Thread-2;

2761    INFO    Mapped URL path [/index.htm] onto handler 'indexController'(details)    org.springframework.web.servlet.handler.SimpleUrlHandlerMapping     13 nov. 2012 17:49:54.739   _ThreadID=2256;_ThreadName=Thread-2;

2762    INFO    Mapped URL path [/user.htm] onto handler 'userController'(details)  org.springframework.web.servlet.handler.SimpleUrlHandlerMapping     13 nov. 2012 17:49:54.740   _ThreadID=2256;_ThreadName=Thread-2;

2763    INFO    FrameworkServlet 'dispatcher': initialization completed in 205 ms(details)  org.springframework.web.servlet.DispatcherServlet   13 nov. 2012 17:49:54.813   _ThreadID=2256;_ThreadName=Thread-2;

2764    INFO    Loading application [SpringHibernateTuto2] at [/SpringHibernateTuto2](details)  javax.enterprise.system.container.web.com.sun.enterprise.web    13 nov. 2012 17:49:54.816   _ThreadID=2256;_ThreadName=Thread-2;

2765    INFO    SpringHibernateTuto2 was successfully deployed in 1,007 milliseconds.(details)  javax.enterprise.system.tools.admin.org.glassfish.deployment.admin  13 nov. 2012 17:49:54.823   _ThreadID=2256;_ThreadName=Thread-2;

2766    INFO    Hibernate Annotations 3.3.1.GA(details)     org.hibernate.cfg.annotations.Version   13 nov. 2012 17:50:01.078   _ThreadID=189;_ThreadName=Thread-2;

2767    INFO    Hibernate 3.2.5(details)    org.hibernate.cfg.Environment   13 nov. 2012 17:50:01.093   _ThreadID=189;_ThreadName=Thread-2;

2768    INFO    hibernate.properties not found(details)     org.hibernate.cfg.Environment   13 nov. 2012 17:50:01.097   _ThreadID=189;_ThreadName=Thread-2;

2769    INFO    Bytecode provider name : cglib(details)     org.hibernate.cfg.Environment   13 nov. 2012 17:50:01.099   _ThreadID=189;_ThreadName=Thread-2;

2770    INFO    using JDK 1.4 java.sql.Timestamp handling(details)  org.hibernate.cfg.Environment   13 nov. 2012 17:50:01.103   _ThreadID=189;_ThreadName=Thread-2;

2771    INFO    configuring from resource: /hibernate.cfg.xml(details)  org.hibernate.cfg.Configuration     13 nov. 2012 17:50:01.175   _ThreadID=189;_ThreadName=Thread-2;

2772    INFO    Configuration resource: /hibernate.cfg.xml(details)     org.hibernate.cfg.Configuration     13 nov. 2012 17:50:01.175   _ThreadID=189;_ThreadName=Thread-2;

2773    INFO    Reading mappings from resource : Model/User.hbm.xml(details)    org.hibernate.cfg.Configuration     13 nov. 2012 17:50:01.241   _ThreadID=189;_ThreadName=Thread-2;

2774    INFO    Configured SessionFactory: null(details)    org.hibernate.cfg.Configuration     13 nov. 2012 17:50:01.253   _ThreadID=189;_ThreadName=Thread-2;

2775    INFO    Mapping class: Model.User -> User(details)  org.hibernate.cfg.HbmBinder     13 nov. 2012 17:50:01.323   _ThreadID=189;_ThreadName=Thread-2;

2776    INFO    Hibernate Validator not found: ignoring(details)    org.hibernate.cfg.AnnotationConfiguration   13 nov. 2012 17:50:01.342   _ThreadID=189;_ThreadName=Thread-2;

2777    INFO    Using Hibernate built-in connection pool (not for production use!)(details)     org.hibernate.connection.DriverManagerConnectionProvider    13 nov. 2012 17:50:01.407   _ThreadID=189;_ThreadName=Thread-2;

2778    INFO    Hibernate connection pool size: 20(details)     org.hibernate.connection.DriverManagerConnectionProvider    13 nov. 2012 17:50:01.407   _ThreadID=189;_ThreadName=Thread-2;

2779    INFO    autocommit mode: false(details)     org.hibernate.connection.DriverManagerConnectionProvider    13 nov. 2012 17:50:01.408   _ThreadID=189;_ThreadName=Thread-2;

2780    INFO    using driver: com.mysql.jdbc.Driver at URL: jdbc:mysql://inra3.seq.cng.fr:3306/EPGV_Interface?zeroDa... (details)   org.hibernate.connection.DriverManagerConnectionProvider    13 nov. 2012 17:50:01.408   _ThreadID=189;_ThreadName=Thread-2;

2781    INFO    connection properties: {user=mathieu, password=****}(details)   org.hibernate.connection.DriverManagerConnectionProvider    13 nov. 2012 17:50:01.408   _ThreadID=189;_ThreadName=Thread-2;

2782    INFO    MySQL, version: 5.1.61(details)     org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.417   _ThreadID=189;_ThreadName=Thread-2;

2783    INFO    JDBC driver: MySQL-AB JDBC Driver, version: mysql-connector-java-5.0.8 ( Revision: ${svn.Revision} )(details)   org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.417   _ThreadID=189;_ThreadName=Thread-2;

2784    INFO    Using dialect: org.hibernate.dialect.MySQLDialect(details)  org.hibernate.dialect.Dialect   13 nov. 2012 17:50:01.435   _ThreadID=189;_ThreadName=Thread-2;

2785    INFO    Using default transaction strategy (direct JDBC transactions)(details)  org.hibernate.transaction.TransactionFactoryFactory     13 nov. 2012 17:50:01.440   _ThreadID=189;_ThreadName=Thread-2;

2786    INFO    No TransactionManagerLookup configured (in JTA environment, use of read-write or transactional secon... (details)   org.hibernate.transaction.TransactionManagerLookupFactory   13 nov. 2012 17:50:01.443   _ThreadID=189;_ThreadName=Thread-2;

2787    INFO    Automatic flush during beforeCompletion(): disabled(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.443   _ThreadID=189;_ThreadName=Thread-2;

2788    INFO    Automatic session close at end of transaction: disabled(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.443   _ThreadID=189;_ThreadName=Thread-2;

2789    INFO    JDBC batch size: 15(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.443   _ThreadID=189;_ThreadName=Thread-2;

2790    INFO    JDBC batch updates for versioned data: disabled(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.444   _ThreadID=189;_ThreadName=Thread-2;

2791    INFO    Scrollable result sets: enabled(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.445   _ThreadID=189;_ThreadName=Thread-2;

2792    INFO    JDBC3 getGeneratedKeys(): enabled(details)  org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.445   _ThreadID=189;_ThreadName=Thread-2;

2793    INFO    Connection release mode: auto(details)  org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.445   _ThreadID=189;_ThreadName=Thread-2;

2794    INFO    Maximum outer join fetch depth: 2(details)  org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.446   _ThreadID=189;_ThreadName=Thread-2;

2795    INFO    Default batch fetch size: 1(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.446   _ThreadID=189;_ThreadName=Thread-2;

2796    INFO    Generate SQL with comments: disabled(details)   org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.447   _ThreadID=189;_ThreadName=Thread-2;

2797    INFO    Order SQL updates by primary key: disabled(details)     org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.447   _ThreadID=189;_ThreadName=Thread-2;

2798    INFO    Order SQL inserts for batching: disabled(details)   org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.447   _ThreadID=189;_ThreadName=Thread-2;

2799    INFO    Query translator: org.hibernate.hql.ast.ASTQueryTranslatorFactory(details)  org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.447   _ThreadID=189;_ThreadName=Thread-2;

2800    INFO    Using ASTQueryTranslatorFactory(details)    org.hibernate.hql.ast.ASTQueryTranslatorFactory     13 nov. 2012 17:50:01.451   _ThreadID=189;_ThreadName=Thread-2;

2801    INFO    Query language substitutions: {}(details)   org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.451   _ThreadID=189;_ThreadName=Thread-2;

2802    INFO    JPA-QL strict compliance: disabled(details)     org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.451   _ThreadID=189;_ThreadName=Thread-2;

2803    INFO    Second-level cache: enabled(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.451   _ThreadID=189;_ThreadName=Thread-2;

2804    INFO    Query cache: disabled(details)  org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.451   _ThreadID=189;_ThreadName=Thread-2;

2805    INFO    Cache provider: org.hibernate.cache.NoCacheProvider(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.452   _ThreadID=189;_ThreadName=Thread-2;

2806    INFO    Optimize cache for minimal puts: disabled(details)  org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.452   _ThreadID=189;_ThreadName=Thread-2;

2807    INFO    Structured second-level cache entries: disabled(details)    org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.452   _ThreadID=189;_ThreadName=Thread-2;

2808    INFO    Statistics: disabled(details)   org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.459   _ThreadID=189;_ThreadName=Thread-2;

2809    INFO    Deleted entity synthetic identifier rollback: disabled(details)     org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.459   _ThreadID=189;_ThreadName=Thread-2;

2810    INFO    Default entity-mode: pojo(details)  org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.459   _ThreadID=189;_ThreadName=Thread-2;

2811    INFO    Named query checking : enabled(details)     org.hibernate.cfg.SettingsFactory   13 nov. 2012 17:50:01.459   _ThreadID=189;_ThreadName=Thread-2;

2812    INFO    building session factory(details)   org.hibernate.impl.SessionFactoryImpl   13 nov. 2012 17:50:01.487   _ThreadID=189;_ThreadName=Thread-2;

2813    SEVERE  Initial SessionFactory creation failed.java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.<i... (details)   javax.enterprise.system.std.com.sun.enterprise.server.logging   13 nov. 2012 17:50:01.626   _ThreadID=189;_ThreadName=Thread-2;

2814    WARNING     StandardWrapperValve[dispatcher]: PWC1406: Servlet.service() for servlet dispatcher threw exception ... (details)   javax.enterprise.system.container.web.com.sun.enterprise.web    13 nov. 2012 17:50:01.627   _ThreadID=189;_ThreadName=Thread-2;

2815    INFO    cleaning up connection pool: jdbc:mysql://*****:3306/EPGV_Interface?zeroDateTimeBehavior=... (details)  org.hibernate.connection.DriverManagerConnectionProvider    13 nov. 2012 17:50:12.421   _ThreadID=3;_ThreadName=Thread-2; 
```

以及服务器错误的详细信息

日志条目详细信息

时间戳

11 月 13 日 2012 17:50:01.626 日志级别

严重的记录器

javax.enterprise.system.std.com.sun.enterprise.server.logging 名称-值对

_ThreadID=189;_ThreadName=Thread-2; 记录编号

2813 消息 ID

完成留言

初始 SessionFactory 创建 failed.java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.(I)V

有帮助吗？您还需要些别的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T17:21:33.460

看起来您的 asm 版本与您的 Hibernate 版本不兼容。问题的相关部分是：

```
2813    SEVERE  Initial SessionFactory creation failed.java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.<i... (details) 
```

您需要检查您的 asm 版本和休眠版本是否兼容。查看 Maven 依赖项/存储库..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-23T07:19:58.153

只需添加 cglib-nodep2.2 并删除 cglib2.1.3，然后从 hibernate 中删除旧的 asm.jar 并仅为您的 hibernate 执行此操作（首先在类路径中），保留 spring 库

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-11T21:20:25.200

我遇到了同样的问题，应用程序没有任何问题出现，但是，当我尝试访问测试资源时，服务器返回 404。问题出在重复的 jar 中。我包含了一个休眠 jar 和 spring-boot-starter-data-jpa 也包含休眠，但版本略有不同。我一开始使用 spring-boot-started-data-jpa，它就回来了。

# ruby - 尝试在 Ruby 中调用方法时出现异常

> ID：13361426
> 
> 赞同：4
> 
> 时间：2012-11-13T13:20:01.663
> 
> 标签：ruby

我是红宝石的新手。我的示例代码给了我这个例外：

```
C:/Users/abc/RubymineProjects/Sample/hello.rb:5:in `<class:Hello>': undefined method `first_method' for Hello:Class (NoMethodError)
    from C:/Users/abc/RubymineProjects/Sample/hello.rb:1:in `<top (required)>'
    from -e:1:in `load'
    from -e:1:in `<main>' 
```

进程以退出代码 1 结束

我的代码是：

```
class Hello
  def first_method
    puts "Hello World"
  end
  first_method()
end 
```

我正在使用 RubyMine 4.5.4。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:45:52.513

问题是您试图调用`first_method`该类——并且`first_method`是一个实例方法。要调用实例方法，您需要使用类的实例。要创建类的实例，您可以使用`SomeClass.new`. 因此，要使用您的方法，请尝试以下代码（与@megas 相同的代码）：

```
class Hello
  def first_method
    puts "Hello World"
  end
end

Hello.new.first_method 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T15:16:49.783

与其他答案相比（但要实现相同的输出），如果您确实希望该方法调用在您的类中工作，您可以简单地将方法定义为类方法：

```
class Hello
  def self.first_method
    puts "Hello World"
  end
  first_method()
end

#=> "Hello World" 
```

我发现以下链接有助于更详细地解释两者之间的区别：[http ://railstips.org/blog/archives/2009/05/11/class-and-instance-methods-in-ruby /](http://railstips.org/blog/archives/2009/05/11/class-and-instance-methods-in-ruby/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:23:18.270

尝试这个：

```
class Hello
  def first_method
    puts "Hello World"
  end
end

Hello.new.first_method 
```

# iphone - iFrame 忽略宽度属性

> ID：13361428
> 
> 赞同：1
> 
> 时间：2012-11-13T13:20:11.727
> 
> 标签：iphone, web-applications, iframe, width

我使用 JavaScript 检查用户代理，并根据我想要更改 iframe 的宽度。iframe 已加载，但在 iPhone 上，宽度属性被忽略。

我尝试了不同的宽度，在加载时你可以看到 iframe 在很短的时间内具有正确的尺寸，但随后它的宽度约为 1000 像素或更高。

这是代码：

```
<script type="text/javascript">
    <!--

        if (iPhone == 1) {
            document.write('<iframe width=\"962px\" height=\"800px\" style=\"position: absolute; left:0px; top:69px;\" src=\"http://xxxxxxx/index.aspx?app=0&iPhone=' + iPhone + '&iPad=' + iPad + '\"/>');
        }
        else {
            document.write('<iframe class=\"eMeeting\" src="http://xxxxx/index.aspx?app=0&iPhone=' + iPhone + '&iPad=' + iPad + '\"/>');
        }

//-->
</script> 
```

编辑：

用户代理代码

```
if ((navigator.userAgent.match(/iPhone/i)) || (navigator.userAgent.match(/iPod/i))) {

iPhone = 1; 
```

}

# iphone - 将数据存储在一个 SQLite 表中，然后检索并将其存储到另一个表中

> ID：13361432
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:20:36.620
> 
> 标签：iphone, ios, objective-c, sqlite

我正在学习如何使用 SQLite 数据库，我在将数据存储在表中时遇到问题，然后再检索它并将其存储到新表中。

我创建了我的第一个表（FoodType），如下所示：

```
CREATE TABLE FoodType(
    type_id integer,
    Category_id integer,
    Type text,
    Quantity text,
    NumberCalories text
) 
```

我在视图控制器中从该表中检索数据并在标签中显示数据。现在我想将数据存储到我创建的另一个表（订单）中：

```
CREATE TABLE Order (
    id integer NOT NULL PRIMARY KEY AUTOINCREMENT,
    type-meal text,
    Quantity text,
    NumCal text
) 
```

这是我试图用来将数据插入第二个表的代码：

```
NSString *insertSQL = [NSString stringWithFormat: 
    @"INSERT INTO Order (type-meal,Quantity,NumCal) VALUES (\"%@\",\%@\",\"%@\")",_typeLbl.text,_Quantity.text,_Number.text]; 
```

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:55:04.297

尝试使用属性“REPLACE INTO”而不是“INSERT INTO”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:30:34.947

“订单”是 SQL 中的保留字。尝试将表格称为其他名称。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-14T08:40:36.593

这是我用来将数据保存在具有类别类型的第二个 tableView 中的所有代码，数据库中没有存储任何内容，但是如果我确定 type_id=4 它仅采用第一类别的第四种类型
：-（IBAction )SaveData:(id)sender { @try { if (sqlite3_open([[AppDelegate getDBPath] UTF8String], &database)== SQLITE_OK) {

```
 NSString *statement= [NSString stringWithFormat: @"INSERT INTO SavedD (type_meal,Quantity,NumCal) SELECT Type,Quantity,NumberCalories FROM FoodType Where type_id=?" ];
         const char *sqlstatement = [statement UTF8String];

                if (sqlite3_prepare_v2(database, sqlstatement, -1, &compiledStatement, NULL)== SQLITE_OK)
                {
                    NSLog(@"Data inserted Successfully");
                    //  UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"OK" message:@"Record added" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];
                    // [alert show];

                    sqlite3_bind_text(compiledStatement, 1, [mealType UTF8String], -1, SQLITE_TRANSIENT);

                    sqlite3_bind_text(compiledStatement, 2, [Quantit UTF8String], -1, SQLITE_TRANSIENT);
                    sqlite3_bind_text(compiledStatement, 3, [NumofCal UTF8String], -1, SQLITE_TRANSIENT);

                    NSLog(@"%@",mealType);
                    //   NSLog(@"%@",PersonId);
                    NSLog(@"%@",Quantit);
                    NSLog(@"%@",NumofCal);

                    int iResult = sqlite3_step(compiledStatement);
                    NSLog(@"%d",iResult);
                    if (SQLITE_DONE!=iResult )
                        NSAssert1(0,@"Error when inserting  %s",sqlite3_errmsg(database));

                }
                else {

                    UIAlertView *AlertOK = [[UIAlertView alloc] initWithTitle:@"Error" message:@"Data not inserted22" delegate:self cancelButtonTitle:@"OK" otherButtonTitles:nil];

                    [AlertOK show];

                }

                sqlite3_finalize(compiledStatement);

            }
            sqlite3_close(database);
        }

        @catch (NSException * e) {
            NSLog(@"The Record already inserted");
        } 
```

}

检查数据插入成功后..但“mealType”、“Quantit”和“NumofCal”的值为空..

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T14:42:34.007

你不能`-`在标识符中使用字符而不引用它们。

尝试`type_meal`或`"type-meal"`。

# c# - ASP.NET 自定义控件取消渲染

> ID：13361433
> 
> 赞同：1
> 
> 时间：2012-11-13T13:20:39.963
> 
> 标签：c#, asp.net, custom-controls

我有一个派生自 Panel 的自定义 ASP.NET 控件。它有一个默认构造函数和 RenderBeginTag、RenderContents 和 RenderEndTag 覆盖。

现在在构造函数中我想检查一些属性，在某种情况下我想阻止/取消控件的完整呈现。

最简单的方法是什么？最好就在那个构造函数中。现在我已经为所有覆盖方法添加了一个小检查，但我相信这可以做得更聪明。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:59:17.717

您也可以覆盖`WebControl.Render`执行检查的方法 - 这样您就不必检查 3 种不同的方法。

但更好的解决方案是设置`this.Visible = false`- 这可以防止调用渲染方法并防止`PreRender`引发事件（它们在设计上应该只在可见控件上引发）。

我会覆盖该`Visible`属性并在那里添加检查：

```
public override bool Visible
{
    get
    {
        var b = base.Visible;
        if (!b || this.ControlShouldNotBeRendered())
            return false;
        return true;
    }

    set
    {
        base.Visible = value;
    }
} 
```

# c# - 如何管理我的应用程序关闭方式？

> ID：13361436
> 
> 赞同：3
> 
> 时间：2012-11-13T13:20:54.597
> 
> 标签：c#, c#-4.0

我需要以同样的方式关闭我的应用程序，无论是直接关闭还是从任务栏或任务管理器关闭。我需要做一些预先设置并在每次关闭应用程序之前自动生成日志文件......

例如，每次退出时我都会给我的应用程序表单提供以下效果，但是当我从任务栏或任务管理器关闭我的应用程序时不会显示此效果......

```
 System.Windows.Forms.Timer closeTimer = new System.Windows.Forms.Timer();

    void lblClose_Click(object sender, System.EventArgs e)
    {
        closeTimer.Tick += new EventHandler(closeTimer_Tick);
        closeTimer.Interval = 10;
        closeTimer.Start();            
    }

    void closeTimer_Tick(object sender, EventArgs e)
    {
        int a = (int)(this.Opacity * 100);
        a--;
        this.Opacity = ((double)a / 100);
        if ((this.Opacity*100) == 0)
            this.Close();
    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:29:48.677

从[这个问题](https://stackoverflow.com/a/10579614/1324019)：

```
[STAThread]
static void Main()
{
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    Application.ApplicationExit += new EventHandler(Application_ApplicationExit);
    AppDomain.CurrentDomain.ProcessExit += new EventHandler(CurrentDomain_ProcessExit);
    Application.Run(new MainForm());
} 
```

这比使用`FormClosed`as 更可取，因为表单正在关闭并不一定意味着应用程序是（当然特定于您的代码）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T13:26:36.520

我假设您的应用是 System.Windows.Forms.Application。如果是这样，您可以收听 ApplicationExit 事件。

所以在 Main 中，执行以下操作：

```
Application.ApplicationExit += (s,e) =>
{
   // Your exit code.
}; 
```

请参阅[http://msdn.microsoft.com/en-us/library/system.windows.forms.application.applicationexit.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.application.applicationexit.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:28:01.100

你需要处理`FormClosing`事件。更多信息在这里：http: [//msdn.microsoft.com/en-us/library/system.windows.forms.form.formclosing.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.form.formclosing.aspx)

# java - InFix to Prefix 方法类

> ID：13361438
> 
> 赞同：0
> 
> 时间：2012-11-13T13:21:02.877
> 
> 标签：java, class, methods, prefix, infix-notation

我试图查明我的前缀计算器类中的错误，但我在这样做时遇到了麻烦。

预期的输出应该是这样的： InFix: "2+4" （例如） PostFix: "24+" PreFix: " 24" （这里是错误）

这是计算前缀的类：

```
public class PreEva {
private String prefijo;
private String iString;

public PreEva(String iString){
    int longitud = iString.length(); //kinda redundant
    char p1[]=new char[longitud], p2[]=new char[longitud];
    prefijo="";
    int contp1=0, contp2=0;

    for(int i=longitud-1;i>=0;i--){
        char tmp=iString.charAt(i);
        switch(tmp){
            case '^':case')':
                if(contp2<=0){      //If p2 is empty, inputs the operator
                    p2[contp2]=tmp;
                    contp2++;
                    }
                else{
                    p2[contp2]=tmp;
                    contp2++;
                }break;
            case '/':case '*':
                if(contp2<=0){      //If p2 is empty, inputs the operator
                    p2[contp2]=tmp;
                    contp2++;
                }
                else{
                    if(p2[contp2-1]=='^'){
                        while(p2[contp2]-1=='^'){
                            for(int j=contp2; j>0; j--){    //Passes to p1
                                if(p2[contp2-1]==p2[contp2-2]){
                                    contp2=j-1; 
                                    j=0;
                                }
                                else{
                                    p1[contp1]=p2[j-1];
                                    contp1++;
                                }
                                contp2++;
                            }
                            p2[contp2]=tmp;
                            contp2++;
                        }
                    }
                    else{
                        p2[contp2]=tmp;
                        contp2++;
                    }
                }break;
            case '+':case '-':              
                if(contp2<=0){          //Ifthere's nothing in p2, inputs the operator
                    p2[contp2]=tmp;
                    contp2++;
                }
                else{
                    if(p2[contp2-1]==')'||p2[contp2-1]=='+'||p2[contp2-1]=='-'){
                        p2[contp2]=tmp;
                        contp2++;
                    }
                    else{
                        while(!(p2[i-1]==')'||p2[i-1]=='+'||p2[i-1]=='-')){
                            for(int j=contp2; j>0; j--){    //Paso a p1
                                if(p2[contp2-1]==p2[contp2-2]){
                                    contp2=j-1;
                                    j=0;
                                }
                                else{
                                    p1[contp1]=p2[j-1];
                                    contp1++;
                                }
                                contp2++;
                            }
                            p2[contp2]=tmp;
                            contp2++;
                        }
                    }
                }break;
            case '(':
                if(contp2<=0){              //If there is nothing adds to p2
                    p2[contp2]=tmp;
                    contp2++;
                }
                else{
                    for(int j=contp2; j>0; j--){    //To p1
                        if(p2[contp2-1]==')'){      //If the one under tmp is ')', drops the counter(subtracs from counter i believe is more accurate)
                            contp2=j-1;
                            j=0;
                        }
                        else{
                            p1[contp1]=p2[j-1];
                            contp1++;
                        }
                    }
                }break;
            default:p1[contp1]=tmp;          
            contp1++;
            break;
        }

    }
    for(int i=longitud-1; i>=0 ;i--){
        prefijo=""+prefijo+""+p1[i];
    }
 }

/* Retornar Resultado */
public String getOS(){
    return prefijo;
} 
```

如果有人对如何改进我的代码或纠正此错误有任何建议，我们将不胜感激！

提前谢谢。

# php - 如何用 SQL 写这个？

> ID：13361439
> 
> 赞同：1
> 
> 时间：2012-11-13T13:21:05.543
> 
> 标签：php, sql, associations, rights

我一直试图自己找到这个答案，但我太糟糕了，所以我来到这里希望你能帮助我。

我有以下数据库表：

```
user(
    int unsigned id,
    varchar      login
)
group(
    int unsigned id,
    varchar      label
)
right(
    int unsigned id,
    varchar      label
)
user_group(
    int unsigned userId,
    int unsigned groupId
)
user_right(
    int unsigned userId,
    int unsigned rightId,
    boolean      granted
)
group_right(
    int unsigned groupId,
    int unsigned rightId,
    boolean      granted
) 
```

和 3 个配置参数（PHP 定义）：

*   **`GRANTED_BY_DEFAULT`**可以是`TRUE`或`FALSE`。它指示，当没有为组或用户指定权限时（即不在关联表中），是否授予权限。

*   **`RESULTING_RIGHTS`**可以是**`MIN_RIGHTS`**或**`MAX_RIGHTS`**。它指示在确定结果权限时是使用“AND”还是“OR”运算符。例如，如果对于右“r1”，组“g1”为 TRUE，组“g2”和“g3”为 FALSE，“MIN_RIGHTS”为 FALSE，“MAX_RIGHTS”为 TRUE。

*   **`RIGHTS_PRIORITY`**可以是**`USER_OVER_GROUP`**或**`GROUP_OVER_USER`**。它指示用户自己的权限是否优先于他的组的权限，或者组的权限是否会优先于用户自己的权限。

考虑到这 3 个参数和他的组，我想提出一个可以找到用户有效拥有的权限的查询，但我真的不知道该怎么做。我还可以进行多个查询并在 PHP 端完成部分工作，但我想避免进行很多查询，因为我希望我的应用程序足够快，可以处理 AJAX 自动完成和其他类似的事情。

如果没有人愿意或有时间帮助我，我会理解 :p 感谢您的阅读。

编辑：一些示例数据：

```
user (id, login) :
1 "Admin"

group (id, label) :
1 "g1"
2 "g2"
3 "g3"

right (id, label) :
1 "r1"
2 "r2"
3 "r3"

user_group (userId, groupId) :
1 1
1 2

user_right (userId, rightId) :
1 1 true
1 2 false

group_rights (groupId, rightId) :
1 1 true
1 2 false
2 1 false
2 3 true 
```

并且输出将是 (right_id, right_label) 行的列表，具体取决于参数和其他表的行。

在检索权限时，用户 ID 和/或登录名被认为是已知的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T16:21:27.670

```
DECLARE @USERID INT = 1,
        @GRANTED_BY_DEFAULT INT = 0,
        @RESULTING_RIGHTS VARCHAR(20) = 'MIN_RIGHTS',
        @RIGHTS_PRIORITY VARCHAR(20) = 'USER_OVER_GROUP'

SELECT 
    R.ID,
    R.NAME,
    CASE
        WHEN MAX(UR.Value) IS NULL AND MAX(GR.Value) IS NULL THEN
            @GRANTED_BY_DEFAULT
        WHEN MAX(UR.Value) IS NOT NULL AND MAX(GR.Value) IS NOT NULL THEN
            CASE
                WHEN @RIGHTS_PRIORITY = 'USER_OVER_GROUP' THEN
                    MAX(UR.Value)
                ELSE
                    CASE 
                        WHEN @RESULTING_RIGHTS = 'MIN_RIGHTS' THEN
                            MIN(GR.Value)
                        ELSE
                            MAX(GR.Value)
                    END
            END
        WHEN MAX(GR.Value) IS NULL THEN
            MAX(UR.Value)
        ELSE
            CASE
                WHEN @RESULTING_RIGHTS = 'MIN_RIGHTS' THEN
                    MIN(GR.Value)
                ELSE
                    MAX(GR.Value)
            END
    END VALUE
FROM
    [Right] R
    CROSS JOIN [User] U
    LEFT JOIN [User_Right] UR
        ON R.ID = UR.RightID
        AND UR.UserID = U.ID
    LEFT JOIN [User_Group] UG
        ON UG.UserID = U.ID
    LEFT JOIN [Group_Right] GR
        ON UG.GroupID = GR.GroupID 
        AND GR.RightID = R.ID
WHERE
    U.ID = @USERID
GROUP BY 
    R.ID,
    R.NAME 
```

这是一个 SQL 小提琴示例[SQL Fiddle](http://sqlfiddle.com/#!3/97eb2/5)

# java - 基于单个视图的多个实体

> ID：13361446
> 
> 赞同：0
> 
> 时间：2012-11-13T13:21:23.097
> 
> 标签：java, jpa, orm, oracle11g, eclipselink

我正在制作一个基于远程数据库模式的域模型，它只为我提供一个单一的视图来处理。该视图是许多不同表的完全连接，这意味着存在大量重复数据。

视图看起来有点像这样（它实际上要大得多，但想法是一样的）：

```
STUDENT_ID     STUDENT_NAME     CLASS_ID     CLASS_NAME     YEAR_ID     YEAR
----------------------------------------------------------------------------
1              Jane             1            Maths          1           2001
1              Jane             2            Biology        1           2001
2              Adam             2            Biology        1           2001
2              Adam             2            Biology        2           2002
NULL           NULL             1            Maths          2           2002
3              Pete             NULL         NULL           NULL        NULL
NULL           NULL             3            Physics        NULL        NULL
NULL           NULL             NULL         NULL           3           2003 
```

正如我们所见，它是表 和 的`STUDENT`完全`CLASS`连接`YEAR`。

有些学生是

我想做 3 个实体类`Student`：`Class`和`Year`; 每个人都持有一个 ID 和姓名：

```
@Entity
@Table(name = "THE_VIEW")
public class Student implements Serializable {

    @Id
    @Column(name = "STUDENT_ID")
    private long id;

    @Column(name = "STUDENT_NAME")
    private String name;

    /* Getters, setters and references to other entities */
}

@Entity
@Table(name = "THE_VIEW")
public class Clazz implements Serializable {

    @Id
    @Column(name = "CLASS_ID")
    private long id;

    @Column(name = "CLASS_NAME")
    private String name;

    /* Getters, setters and references to other entities */
} 
```

我可以使用`STUDENT_ID`and `CLASS_ID`as `@Id`s 吗？它们在视图中并不是唯一的，但是做一些类似的`SELECT DISTINCT STUDENT_ID, STUDENT_NAME FROM THE_VIEW`事情会使它们变得独一无二...... JPA 如何处理这些事情？

为所有 ID：s 使用复合主键当然是可能的，但它必须包含许多字段，我真的想避免这种情况。

有关解决此问题的任何其他建议？我们现在可以忽略与其他实体类型的关系。

JPA 实现是 eclipselink 2.2.0，数据库是 Oracle 11g

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:10:34.373

首先，我会使用真实的表格，而不是这个视图。限制自己这样做是没有意义的。我假设您的应用程序是只读的？看不到您如何写入此视图。

如果您必须使用视图，则创建一个映射到它的对象，并将您的真实模型对象定义为嵌入式。

IE

```
@Entity
public StudentClassAssignment {
  @EmbeddedId
  StudentClassAssignmentId
  @Embedded
  Student student
  @Embedded
  SchoolClass schoolClass      
  @Embedded
  Year year
} 
```

# iphone - 核心数据 NSFetchedResultsController 抛出 NSObjectInaccessibleException

> ID：13361448
> 
> 赞同：1
> 
> 时间：2012-11-13T13:21:32.987
> 
> 标签：iphone, objective-c, ios, core-data, nsfetchedresultscontroller

我开始使用核心数据。我正在尝试使用 UISearchDisplayController 实现 NSFetchedResultsController ，它还将在`viewWillAppear:`调用方法后尝试在后台更新来自服务器的数据。

这是我的核心数据助手实现：

```
#import <Foundation/Foundation.h>

@interface NEDatabase : NSObject
{
    //
}

@property (readonly, strong, nonatomic) NSManagedObjectContext *managedObjectContext;
@property (readonly, strong, nonatomic) NSManagedObjectModel *managedObjectModel;
@property (readonly, strong, nonatomic) NSPersistentStoreCoordinator *persistentStoreCoordinator;

- (void)saveContext;
- (NSURL *)applicationDocumentsDirectory;

+(NEDatabase *)sharedDatabase;

-(void)contextSaved:(NSNotification *)notification;

@end

#import "NEDatabase.h"

#define DEFINE_SHARED_INSTANCE_USING_BLOCK(block) \
static dispatch_once_t pred = 0; \
__strong static id _sharedObject = nil; \
dispatch_once(&pred, ^{ \
_sharedObject = block(); \
}); \
return _sharedObject; \

@implementation NEDatabase

@synthesize managedObjectContext = _managedObjectContext;
@synthesize managedObjectModel = _managedObjectModel;
@synthesize persistentStoreCoordinator = _persistentStoreCoordinator;

#pragma mark -
#pragma mark - Singletone implementation

+(NEDatabase *)sharedDatabase
{
    DEFINE_SHARED_INSTANCE_USING_BLOCK(^{
        return [[self alloc] init];
    });
}

-(id)init
{
    self = [super init];
    if (self != nil)
    {
        [[NSNotificationCenter defaultCenter] removeObserver:self];
        //[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(contextSaved:) name:NSManagedObjectContextDidSaveNotification object:nil];
    };

    return self;
}

#pragma mark - multi-context handling

-(void)contextSaved:(NSNotification *)notification
{
    NSLog(@"contextSaved: called");

    NSManagedObjectContext *theContext = notification.object;
    if(theContext != [self managedObjectContext])
    {
        NSLog(@"---- BACKGROUND CONTEXT CHANGED");

        [[self managedObjectContext] mergeChangesFromContextDidSaveNotification:notification];
    };
}

#pragma mark - core data

- (void)saveContext
{
    NSError *error = nil;
    NSManagedObjectContext *managedObjectContext = self.managedObjectContext;
    if (managedObjectContext != nil) {
        if ([managedObjectContext hasChanges] && ![managedObjectContext save:&error]) {
            // Replace this implementation with code to handle the error appropriately.
            // abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development.
            NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
            abort();
        }
    }
}

// Returns the managed object context for the application.
// If the context doesn't already exist, it is created and bound to the persistent store coordinator for the application.
- (NSManagedObjectContext *)managedObjectContext
{
    if (_managedObjectContext != nil) {
        return _managedObjectContext;
    }

    NSPersistentStoreCoordinator *coordinator = [self persistentStoreCoordinator];
    if (coordinator != nil) {
        _managedObjectContext = [[NSManagedObjectContext alloc] init];
        [_managedObjectContext setPersistentStoreCoordinator:coordinator];
        [_managedObjectContext setStalenessInterval:0];
    }
    return _managedObjectContext;
}

// Returns the managed object model for the application.
// If the model doesn't already exist, it is created from the application's model.
- (NSManagedObjectModel *)managedObjectModel
{
    if (_managedObjectModel != nil) {
        return _managedObjectModel;
    }
    NSURL *modelURL = [[NSBundle mainBundle] URLForResource:@"nightexpress" withExtension:@"momd"];
    _managedObjectModel = [[NSManagedObjectModel alloc] initWithContentsOfURL:modelURL];
    return _managedObjectModel;
}

// Returns the persistent store coordinator for the application.
// If the coordinator doesn't already exist, it is created and the application's store added to it.
- (NSPersistentStoreCoordinator *)persistentStoreCoordinator
{
    if (_persistentStoreCoordinator != nil) {
        return _persistentStoreCoordinator;
    }

    NSURL *storeURL = [[self applicationDocumentsDirectory] URLByAppendingPathComponent:@"nightexpress.sqlite"];

    NSError *error = nil;
    _persistentStoreCoordinator = [[NSPersistentStoreCoordinator alloc] initWithManagedObjectModel:[self managedObjectModel]];
    if (![_persistentStoreCoordinator addPersistentStoreWithType:NSSQLiteStoreType configuration:nil URL:storeURL options:nil error:&error]) {
         [[NSFileManager defaultManager] removeItemAtURL:storeURL error:nil]

         * Performing automatic lightweight migration by passing the following dictionary as the options parameter:
         @{NSMigratePersistentStoresAutomaticallyOption:@YES, NSInferMappingModelAutomaticallyOption:@YES}

         Lightweight migration will only work for a limited set of schema changes; consult "Core Data Model Versioning and Data Migration Programming Guide" for details.

         */
        NSLog(@"Unresolved error %@, %@", error, [error userInfo]);
        abort();
    }

    return _persistentStoreCoordinator;
}

#pragma mark - Application's Documents directory

// Returns the URL to the application's Documents directory.
- (NSURL *)applicationDocumentsDirectory
{
    return [[[NSFileManager defaultManager] URLsForDirectory:NSDocumentDirectory inDomains:NSUserDomainMask] lastObject];
}

@end 
```

和我的表视图控制器（带有搜索显示控制器的获取结果控制器）实现：

```
#import <UIKit/UIKit.h>
#import "CDDirection.h"
#import "NEDirection.h"
#import "NEDefaults.h"
#import "NEDirectionDelegate.h"
#import "NEServer.h"

@interface NEDirectionViewController : UIViewController <UITableViewDelegate, UITableViewDataSource, NEServerDelegate,UISearchBarDelegate, NSFetchedResultsControllerDelegate, UISearchDisplayDelegate>
{
    IBOutlet UITableView *directionsTableView;
    IBOutlet UITableViewCell *directionCell;

    IBOutlet UISearchDisplayController *searchDisplayController;
    IBOutlet UISearchBar *searchBar;

    NSFetchedResultsController *fetchedResultsController;
    NSFetchedResultsController *searchFetchedResultsController;
    NSManagedObjectContext *context;

    NEDirection *selectedDirection;

    BOOL isFromDirection;

    __unsafe_unretained id<NEDirectionDelegate> delegate;
}

@property (nonatomic, retain) IBOutlet UITableView *directionsTableView;
@property (nonatomic, retain) IBOutlet UITableViewCell *directionCell;

@property (nonatomic, retain) IBOutlet UISearchDisplayController *searchDisplayController;
@property (nonatomic, retain) IBOutlet UISearchBar *searchBar;

@property (nonatomic, retain) NSFetchedResultsController *fetchedResultsController;
@property (nonatomic, retain) NSFetchedResultsController *searchFetchedResultsController;
@property (nonatomic, retain) NSManagedObjectContext *context;

@property (nonatomic, retain) NEDirection *selectedDirection;

@property (nonatomic, readwrite) BOOL isFromDirection;

@property (nonatomic, assign) id<NEDirectionDelegate> delegate;

-(void)updateDirectionsFromServer;

@end 
```

第二部分：

```
//
//  NEDirectionViewController.m
//  nightexpress
//
//  Created by Oleg Samoylenko on 11/5/12.
//  Copyright (c) 2012 Trinetix. All rights reserved.
//

#import "NEDirectionViewController.h"

@interface NEDirectionViewController ()

@end

@implementation NEDirectionViewController

@synthesize directionsTableView;
@synthesize directionCell;

@synthesize searchDisplayController;
@synthesize searchBar;

@synthesize fetchedResultsController;
@synthesize searchFetchedResultsController;
@synthesize context;

@synthesize selectedDirection;
@synthesize isFromDirection;
@synthesize delegate;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self)
    {
        // Custom initialization
    };
    NSLog(@"NEDirectionViewController initialized");
    return self;
}

- (void)viewDidLoad
{
    NSLog(@"\n\nNEDirectionViewController: viewDidLoad called");
    [super viewDidLoad];
    // Do any additional setup after loading the view from its nib.
    self.context=[[NEDatabase sharedDatabase] managedObjectContext];
    [self.context setStalenessInterval:0];

    [self.directionsTableView reloadData];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

-(void)viewWillAppear:(BOOL)animated
{
    NSLog(@"NEDirectionViewController: viewWillAppear: called");
    [super viewWillAppear:animated];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(contextSaved:) name:NSManagedObjectContextDidSaveNotification object:nil];
    [self updateDirectionsFromServer];
}

-(void)viewWillDisappear:(BOOL)animated
{
    NSLog(@"NEDirectionViewController: viewWillDisappear: called");
    [super viewWillDisappear:animated];
    [[NSNotificationCenter defaultCenter] removeObserver:self];
    [NEServer sharedServer].delegate=nil;
}

#pragma mark - Actions

-(void)contextSaved:(NSNotification *)notification
{
    NSLog(@"contextSaved: called");
    NSManagedObjectContext *theContext = notification.object;
    if(theContext != self.context)
    {
        NSLog(@"---- BACKGROUND CONTEXT CHANGED");

        // should I notify NSFetchedResultsController that there were context saves on background threads?
        // how can I merge contexts if userInfo is nil?
        [self.context mergeChangesFromContextDidSaveNotification:notification];
        [self.directionsTableView reloadData];
    };
}

-(void)updateDirectionsFromServer
{
    NSLog(@"updateDirectionsFromServer called");
    [NEServer sharedServer].delegate=self;
    [[NEServer sharedServer] performSelectorInBackground:@selector(updateDirectionsWithArgs:) withObject:nil];
}

#pragma mark - Helper methods

- (NSFetchedResultsController *)fetchedResultsControllerForTableView:(UITableView *)tableView
{
    NSLog(@"fetchedResultsControllerForTableView: called");
    return tableView == self.directionsTableView ? self.fetchedResultsController : self.searchFetchedResultsController;
}

- (void)fetchedResultsController:(NSFetchedResultsController *)aFetchedResultsController configureCell:(UITableViewCell *)theCell atIndexPath:(NSIndexPath *)theIndexPath
{
    NSLog(@"fetchedResultsController: configureCell: atIndexPath: %i %i", theIndexPath.section, theIndexPath.row);

    NSManagedObjectContext *managedObj=[aFetchedResultsController objectAtIndexPath:theIndexPath];
    if (managedObj==nil)
    {
        NSLog(@"PANIC: fetchedResultsController objectAtIndexPath: returned nil object");
        return;
    }
    else
    {
        CDDirection *dir=(CDDirection *)managedObj;
        UILabel *nameLabel=(UILabel *)[theCell viewWithTag:1];
        [nameLabel setText:dir.name];

        if ([dir.current boolValue]==YES)
        {
            UIImageView *curCityImageView=(UIImageView *)[theCell viewWithTag:2];
            [curCityImageView setImage:[UIImage imageNamed:@"uitableviewcell_accessory1.jpg"]];
        };
        if ([selectedDirection.name isEqualToString:dir.name])
        {
            UIImageView *accImageView=[[UIImageView alloc] initWithFrame:CGRectMake(0.0, 0.0, 24, 24)];
            [accImageView setImage:[UIImage imageNamed:@"uitableviewcell_accessory2.png"]];
            [theCell setAccessoryView:accImageView];
        };
   };
}

#pragma mark - UITableViewDataSource

-(UITableViewCell *)tableView:(UITableView *)theTableView cellForRowAtIndexPath:(NSIndexPath *)theIndexPath
{
    NSLog(@"tableView: cellForRowAtIndexPath: %i %i", theIndexPath.section, theIndexPath.row);

    static NSString *cellIdentifier=@"CellIdentifier";
    UITableViewCell *cell = [theTableView dequeueReusableCellWithIdentifier:cellIdentifier];
    if (cell == nil)
    {
        [[NSBundle mainBundle] loadNibNamed:@"DirectionCell" owner:self options:nil];
        cell=self.directionCell;
        self.directionCell=nil;
    };

    [self fetchedResultsController:[self fetchedResultsControllerForTableView:theTableView] configureCell:cell atIndexPath:theIndexPath];
    return cell;
}

- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    NSInteger count = [[[self fetchedResultsControllerForTableView:tableView] sections] count];
    NSLog(@"numberOfSectionsInTableView: %i", count);
    return count;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    NSInteger numberOfRows = 0;
    NSFetchedResultsController *fetchController = [self fetchedResultsControllerForTableView:tableView];
    NSArray *sections = fetchController.sections;
    if(sections.count > 0)
    {
        id <NSFetchedResultsSectionInfo> sectionInfo = [sections objectAtIndex:section];
        numberOfRows = [sectionInfo numberOfObjects];
    };
    NSLog(@"tableView: numberOfRowsInSection: %i", numberOfRows);
    return numberOfRows;
}

#pragma mark - UITableViewDelegate

-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"tableView: didSelectRowAtIndexPath: %i %i", indexPath.section, indexPath.row);

    CDDirection *cdDir=[[self fetchedResultsControllerForTableView:tableView] objectAtIndexPath:indexPath];
    self.selectedDirection=[[NEDirection alloc] init];
    self.selectedDirection.name=cdDir.name;
    self.selectedDirection.latitude=cdDir.latitude;
    self.selectedDirection.longitude=cdDir.longitude;
    self.selectedDirection.server_id=cdDir.server_id;
    self.selectedDirection.current=cdDir.current;
    if (isFromDirection)
    {
        [delegate directionUpdatedTo:self.selectedDirection withHeading:@"from"];
    }
    else
    {
        [delegate directionUpdatedTo:self.selectedDirection withHeading:@"to"];
    };
    [tableView reloadData];
    [self.directionsTableView reloadData];
}

#pragma mark - content filtering

- (void)filterContentForSearchText:(NSString*)searchText scope:(NSInteger)scope
{
    // update the filter, in this case just blow away the FRC and let lazy evaluation create another with the relevant search info
    self.searchFetchedResultsController.delegate = nil;
    self.searchFetchedResultsController = nil;
    // if you care about the scope save off the index to be used by the searchFetchedResultsController
    //self.savedScopeButtonIndex = scope;
}

#pragma mark - search bar

- (void)searchDisplayController:(UISearchDisplayController *)controller willUnloadSearchResultsTableView:(UITableView *)tableView;
{
    // search is done so get rid of the search FRC and reclaim memory
    self.searchFetchedResultsController.delegate = nil;
    self.searchFetchedResultsController = nil;
}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
    [self filterContentForSearchText:searchString scope:[self.searchDisplayController.searchBar selectedScopeButtonIndex]];

    // Return YES to cause the search result table view to be reloaded.
    return YES;
}

- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchScope:(NSInteger)searchOption
{
    [self filterContentForSearchText:[self.searchDisplayController.searchBar text] scope:[self.searchDisplayController.searchBar selectedScopeButtonIndex]];

    // Return YES to cause the search result table view to be reloaded.
    return YES;
}

#pragma mark - NSFetchedResultsControllerDelegate

- (void)controllerWillChangeContent:(NSFetchedResultsController *)controller
{
    UITableView *tableView = controller == self.fetchedResultsController ? self.directionsTableView : self.searchDisplayController.searchResultsTableView;
    [tableView beginUpdates];
}

- (void)controller:(NSFetchedResultsController *)controller
  didChangeSection:(id <NSFetchedResultsSectionInfo>)sectionInfo
           atIndex:(NSUInteger)sectionIndex
     forChangeType:(NSFetchedResultsChangeType)type
{
    UITableView *tableView = controller == self.fetchedResultsController ? self.directionsTableView : self.searchDisplayController.searchResultsTableView;

    switch(type)
    {
        case NSFetchedResultsChangeInsert:
            [tableView insertSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [tableView deleteSections:[NSIndexSet indexSetWithIndex:sectionIndex] withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controller:(NSFetchedResultsController *)controller
   didChangeObject:(id)anObject
       atIndexPath:(NSIndexPath *)theIndexPath
     forChangeType:(NSFetchedResultsChangeType)type
      newIndexPath:(NSIndexPath *)newIndexPath
{
    UITableView *tableView = controller == self.fetchedResultsController ? self.directionsTableView : self.searchDisplayController.searchResultsTableView;

    switch(type)
    {
        case NSFetchedResultsChangeInsert:
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeDelete:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:theIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            break;

        case NSFetchedResultsChangeUpdate:
            [self fetchedResultsController:controller configureCell:[tableView cellForRowAtIndexPath:theIndexPath] atIndexPath:theIndexPath];
            break;

        case NSFetchedResultsChangeMove:
            [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:theIndexPath] withRowAnimation:UITableViewRowAnimationFade];
            [tableView insertRowsAtIndexPaths:[NSArray arrayWithObject:newIndexPath]withRowAnimation:UITableViewRowAnimationFade];
            break;
    }
}

- (void)controllerDidChangeContent:(NSFetchedResultsController *)controller
{
    UITableView *tableView = controller == self.fetchedResultsController ? self.directionsTableView : self.searchDisplayController.searchResultsTableView;
    [tableView endUpdates];
}

#pragma mark - FRC creation

- (NSFetchedResultsController *)newFetchedResultsControllerWithSearch:(NSString *)searchString
{
    NSSortDescriptor *sortDescr=[[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES selector:@selector(caseInsensitiveCompare:)];
    NSArray *sortDescriptors =[NSArray arrayWithObjects:sortDescr, nil];
    NSPredicate *filterPredicate; //= [NSPredicate predicateWithFormat:@"name CONTAINS[cd] %@", searchString];

    /*
     Set up the fetched results controller.
     */
    // Create the fetch request for the entity.
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *callEntity=[NSEntityDescription entityForName:@"Direction" inManagedObjectContext:self.context];
    [fetchRequest setEntity:callEntity];

    NSMutableArray *predicateArray = [[NSMutableArray alloc] init];
    if(searchString.length)
    {
        // your search predicate(s) are added to this array
        [predicateArray addObject:[NSPredicate predicateWithFormat:@"name CONTAINS[cd] %@", searchString]];
        // finally add the filter predicate for this view
        if(filterPredicate)
        {
            filterPredicate = [NSCompoundPredicate andPredicateWithSubpredicates:[NSArray arrayWithObjects:filterPredicate, [NSCompoundPredicate orPredicateWithSubpredicates:predicateArray], nil]];
        }
        else
        {
            filterPredicate = [NSCompoundPredicate orPredicateWithSubpredicates:predicateArray];
        }
    };

    [fetchRequest setPredicate:filterPredicate];

    // Set the batch size to a suitable number.
    //[fetchRequest setFetchBatchSize:0];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Edit the section name key path and cache name if appropriate.
    // nil for section name key path means "no sections".
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:self.context sectionNameKeyPath:nil cacheName:nil];
    aFetchedResultsController.delegate = self;

    NSError *error = nil;
    if (![aFetchedResultsController performFetch:&error])
    {
        /*
         Replace this implementation with code to handle the error appropriately.

         abort() causes the application to generate a crash log and terminate. You should not use this function in a shipping application, although it may be useful during development. If it is not possible to recover from the error, display an alert panel that instructs the user to quit the application by pressing the Home button.
         */
        NSLog(@"Unresolved error %@, %@", [error localizedDescription], [error localizedFailureReason]);
        abort();
    };

    return aFetchedResultsController;
}

- (NSFetchedResultsController *)fetchedResultsController
{
    if (fetchedResultsController != nil)
    {
        return fetchedResultsController;
    };
    fetchedResultsController = [self newFetchedResultsControllerWithSearch:nil];
    return fetchedResultsController;
}

- (NSFetchedResultsController *)searchFetchedResultsController
{
    if (searchFetchedResultsController != nil)
    {
        return searchFetchedResultsController;
    };
    searchFetchedResultsController = [self newFetchedResultsControllerWithSearch:self.searchDisplayController.searchBar.text];
    return searchFetchedResultsController;
}

/*
#pragma mark - UITableViewDelegate

-(void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    NSLog(@"tableView: didSelectRow:%i called", indexPath.row);
    if ([tableView isEqual:self.searchDisplayController.searchResultsTableView])
    {
        self.selectedDirection=[self.searchResults objectAtIndex:indexPath.row];
    }
    else
    {
        self.selectedDirection=[self.allItems objectAtIndex:indexPath.row];
    };
    if (isFromDirection)
    {
        if ((delegate!=nil) && ([(UIViewController *)delegate respondsToSelector:@selector(directionUpdatedTo:withHeading:)]))
        {
            [delegate directionUpdatedTo:self.selectedDirection withHeading:@"from"];
        };
    }
    else
    {
        if ((delegate!=nil) && ([(UIViewController *)delegate respondsToSelector:@selector(directionUpdatedTo:withHeading:)]))
        {
            [delegate directionUpdatedTo:self.selectedDirection withHeading:@"to"];
        };
    };
    [self.searchDisplayController.searchResultsTableView reloadData];
    [self.directionsList reloadData];
}
*/

#pragma mark - NEServerDelegate

-(void)directionsUpdateSentAndReceivedResponse:(NSDictionary *)response
{
    NSLog(@"directionsUpdateSentAndReceivedResponse: %@ called", [response debugDescription]);
    //self.context=[[NEDatabase sharedDatabase] managedObjectContext];
    //[self.directionsTableView reloadData];
    //self.searchDisplayController.searchContentsController.
}

@end 
```

我的代码在`- (void)fetchedResultsController:(NSFetchedResultsController *)aFetchedResultsController configureCell:(UITableViewCell *)theCell atIndexPath:(NSIndexPath *)theIndexPath`

行：`[nameLabel setText:dir.name];

这是崩溃日志：`*** Terminating app due to uncaught exception 'NSObjectInaccessibleException', reason: 'CoreData could not fulfill a fault for '0x748d610 <x-coredata://7866ED27-8B71-42CD-A726-3FA14C8B1619/Direction/p2859>''`

这是NEServer

```
-(void)updateDirectionsWithArgs:(NSDictionary *)args
{
    @autoreleasepool
    {
        //... getting data from server and saving it to responseDict NSDictionary

        NSManagedObjectContext *context=[[NSManagedObjectContext alloc] init];
        context.persistentStoreCoordinator=[[NEDatabase sharedDatabase] persistentStoreCoordinator];

        NSFetchRequest *fetchRequest=[[NSFetchRequest alloc] init];
        NSEntityDescription *pEntity=[NSEntityDescription entityForName:@"Direction" inManagedObjectContext:context];
        [fetchRequest setEntity:pEntity];
        NSArray *fetchedResults=[context executeFetchRequest:fetchRequest error:nil];
        for (CDDirection *dir in fetchedResults)
        {
            [context deleteObject:dir];
        };
        [context save:nil];

        NSArray *cities=[responseDict objectForKey:@"cities"];
        for (NSDictionary *dirDict in cities)
        {
            CDDirection *dir=[NSEntityDescription insertNewObjectForEntityForName:@"Direction" inManagedObjectContext:context];
            dir.name=[dirDict objectForKey:@"name"];
            dir.server_id=[dirDict objectForKey:@"id"];
            dir.longitude=[dirDict objectForKey:@"longitude"];
            dir.latitude=[dirDict objectForKey:@"latitude"];
            if ([dir.name isEqualToString:@"Киев"])
            {
                dir.current=[NSNumber numberWithBool:YES];
            }
            else
            {
                dir.current=[NSNumber numberWithBool:NO];
            };
        };
        [context save:nil];

        if ((delegate!=nil) && ([(UIViewController *)delegate respondsToSelector:@selector(directionsUpdateSentAndReceivedResponse:)]))
        {
            [delegate directionsUpdateSentAndReceivedResponse:responseDict];
        };

    }
} 
```

请帮助我，如何解决这个错误？

ps iOS 4.3+ iphone 应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:40:28.167

检查链接，它可以帮助你：

*   [调试 NSObjectInaccessibleException - ID 为 0x123456789 的 NSManagedObject 已失效](https://stackoverflow.com/questions/1250872/debugging-nsobjectinaccessibleexception-the-nsmanagedobject-with-id0x12345678)
*   [核心数据 NSObjectInaccessibleException NSManagedObject 已失效](https://stackoverflow.com/questions/7221561/core-data-nsobjectinaccessibleexception-nsmanagedobject-has-been-invalidated)
*   [Coredata - “NSObjectInaccessibleException - CoreData 无法完成故障”](https://stackoverflow.com/questions/5591301/coredata-nsobjectinaccessibleexception-coredata-could-not-fulfill-a-fault)
*   [CoreData NSObjectInaccessibleException](https://stackoverflow.com/questions/6409567/coredata-nsobjectinaccessibleexception)

# jquery - CSS3动画translate3d不起作用

> ID：13361449
> 
> 赞同：2
> 
> 时间：2012-11-13T13:21:35.390
> 
> 标签：jquery, css, css-animations, translate3d

我一直在试验 jQuery animate 与 CSS3 animate，我还想测试 2D / 3D 转换，看看哪个更好。

有谁知道为什么我的 CSS3 translate3d 不起作用？我已经在台式机和移动设备上尝试过。

任何帮助表示赞赏

[jsFiddle](http://jsfiddle.net/sygad/F6c4T/)

**HTML**

```
<div id="container1" class="container">transition</div>
    <div id="container2" class="container">translate</div>
    <div id="container3" class="container">translate3d</div>
    <div id="container4" class="container">jQ animate</div> 
```

**CSS**

```
 .container          {position:absolute; left:20px; width:80px; height:80px; padding:5px;}

/* transition */
#container1         {top:20px; background:red;
                    -webkit-transition:all 0.3s linear;
                    -moz-transition:all 0.3s linear;
                    -o-transition:all 0.3s linear;
                    -ms-transition:all 0.3s linear;
                    transition:all 0.3s linear;}

#container1.on      {left:250px} /* It moves if from pos absolute of parent, the body tag in this example */

/* 2D translate */
#container2         {top:120px; background:yellow;
                    -webkit-transition:all 0.3s linear;
                    -moz-transition:all 0.3s linear;
                    -o-transition:all 0.3s linear;
                    -ms-transition:all 0.3s linear;
                    transition:all 0.3s linear;}

#container2.on      {-webkit-transform: translate(230px);
                    -moz-transform: translate(230px);
                    -o-transform: translate(230px);
                    -ms-transform: translate(230px);
                    transform: translate(230px);}  /* It moves if from the starting point, 20px left in this example */

/* 3D - translate */
#container3         {top:220px; background:lime;
                    -webkit-transition:all 0.3s linear;
                    -moz-transition:all 0.3s linear;
                    -o-transition:all 0.3s linear;
                    -ms-transition:all 0.3s linear;
                    transition:all 0.3s linear;}

#container3.on      {-webkit-transform: translate3d(230,0,0);
                    -moz-transform: translate3d(230,0,0);
                    -o-transform: translate3d(230,0,0);
                    -ms-transform: translate3d(230,0,0);
                    transform: translate3d(230,0,0);}  /* It moves if from the starting point, 20px left in this example */

/* jQuery Animate */
#container4         {top:320px; background:orange;} 
```

**jQuery**

```
 $('#container1').click(function()
    {
        $(this).toggleClass('on');
    })

    $('#container2').click(function()
    {
        $(this).toggleClass('on');
    })

    $('#container3').click(function()
    {
        $(this).toggleClass('on');
    })

    $('#container4').toggle(function()
    {
        $(this).animate({'left':'250px'});

    }, function()
    {
        $(this).animate({'left':'20px'});
    }) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:31:49.420

您缺少长度单位`px`。

在 css 中使用它：

```
#container3.on {
    -webkit-transform: translate3d(230px, 0, 0);
    -moz-transform: translate3d(230px, 0, 0);
    -o-transform: translate3d(230px, 0, 0);
    -ms-transform: translate3d(230px, 0, 0);
    transform: translate3d(230px, 0, 0);
}  /* It moves if from the starting point, 20px left in this example */ 
```

这是一个[小提琴](http://jsfiddle.net/F6c4T/6/)

# mongodb - MongoDB 复制集和 ELB

> ID：13361458
> 
> 赞同：6
> 
> 时间：2012-11-13T13:22:07.370
> 
> 标签：mongodb, amazon-web-services, load-balancing, pymongo

我在使用 ELB 的 aws 上有一个主节点和两个辅助节点。阅读和写作的最佳实践是什么？

1）我是否在ELB中的所有节点与主节点和辅助节点创建一个单一的LB，并让python（pymongo）处理排序读写？

2) 还是将所有辅助节点置于 ELB 下并将主节点分配给弹性 IP？这将需要一个脚本来跟踪节点类型并在故障转移时重新分配。

我希望选项1。

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T15:28:36.847

这取决于你的情况。使用 mongodb 驱动程序，您不必跟踪客户端连接到哪个节点 - 您只需通知它有关副本集的信息，它就会自动连接到主节点并处理故障转移。

如果要分配读取负载，则可以设置读取首选项以允许应用程序从辅助节点读取，但您将只能写入主节点。这意味着为所有传入连接设置 ELB 是不必要的，甚至可能会伤害您，因为它可能导致写入被发送到辅助节点（它们将失败）。使用读取首选项将允许您分发读取，因此在您的情况下，我建议不要使用 ELB。

一般来说，我会看看[http://www.slideshare.net/jrosoff/mongodb-on-ec2-and-ebs](http://www.slideshare.net/jrosoff/mongodb-on-ec2-and-ebs)。您可能会发现它很有帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-11-05T20:44:37.340

我在同一条船上，但我在一个副本集中运行 3 个 mongo 实例，2 个默认实例和 1 个仲裁器。设置 ElasticIP 是一个坏主意 b/c 这意味着您的 mongo 服务器将有一个面向公众的连接，这是您不想要的。

我最终创建了一个 ELB，它在 27017 上侦听并转发给副本集的两个默认成员，但不是为了实际的负载平衡，而是为了容错。因此，如果 27017 健康检查失败，备用服务器可以处理后续请求。加上 ELB，您可以创建 DNS CNAME 记录并指向您的应用程序使用它，在我的情况下，我使用“docstore”。这样您就不需要指定实际的 mongo 实例，如 docstore-1 和 docstore-2 等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-12-22T16:12:28.140

我认为答案是，您不使用负载均衡器。您的客户端提供所有副本集成员（主副本和辅助副本）的详细信息，并连接到当前主副本，无论哪个可能。

请参阅[如何从 MongoDB shell 连接到副本集？](https://stackoverflow.com/questions/13912765/how-do-you-connect-to-a-replicaset-from-a-mongodb-shell#answer-28675561)

```
mongo --host replicaSetName/host1[:porthost1],host2[:porthost1],host3[:porthost3] databaseToConnect 
```

在这里，我们使用命令行客户端连接到副本集（不是单个节点），但它可以是 nodeJS、MongoChef（支持副本集）或您正在连接的任何客户端。

# css - Safari 渲染由 scaleX 缩放的内联块的问题

> ID：13361459
> 
> 赞同：6
> 
> 时间：2012-11-13T13:22:10.697
> 
> 标签：css, safari

这是杯子预览的图像：

![在此处输入图像描述](../Images/387e09447b9670d3e548f47bf10230cb.png)

预览显示其他 div 包含的内容，但按比例缩小了 0.2。为了模拟杯子的表面曲线，我使用了一种技术，其中预览块的宽度 = 原始宽度*0.2，它们通过`scaleX`变换缩放 0.6、0.8、1、0.8。0.6。

它工作正常（由于跨浏览器兼容性，我不能使用 html5 画布，这是一项要求），但是，正如您在附加图像上看到的（顶部图像来自 chrome，底部来自 safari），safari 呈现不需要的光线。没有任何帮助 - 绝对定位，将一个块放在另一个块上以隐藏那条光线。这是 safari 特有的问题，可能是因为在`transformX`对块的边缘进行了抗锯齿处理之后，并且由于`scaleX`，侧边缘变得更加明亮。其他浏览器不这样做。

有谁知道我该如何解决这个问题以在 safari 中没有这些行的情况下进行渲染？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-19T21:33:32.727

尝试使用`background-size`而不是`transform: scale`.

# svn - 如何更新可能安装在多个地方的 svn cmd-line 工具？

> ID：13361460
> 
> 赞同：5
> 
> 时间：2012-11-13T13:22:14.887
> 
> 标签：svn, osx-mountain-lion, xcode4.5, macports

我已经`XCode -> Preferences -> Downloads`从`Command Line Tools`. 我想我会得到我需要的最新版本的命令行工具。

1.  我检查使用`xcrun -find svn`：
    *   我找到了第一个 **Subversion**`/Applications/Xcode.app/Contents/Developer/usr/bin/`
    *   这个 svn 的版本是**1.6.18 (r1303927)**。
2.  然后我用`which svn`：
    *   我在上找到了另一个**Subversion**`/usr/bin/`
    *   版本是 svn，版本**1.6.18 (r1303927)**。

他妈的是怎么回事？我的 os x 上有两个副本吗？同一天同一构建和编译？还是有链接？如何使出现PLZ？

我记得使用`xcode-select`... 让我的命令行使用`/Applications/XCode.app/`. 所以这里肯定有问题！

在*Apache-Subversion*网站上，推荐的版本是**1.7.7**。所以我打算更新我使用的svn。*（对我而言）在Mac OS X*上获取二进制包的最佳方法是使用`MacPorts`.

我跑了`port installed subversion svn`-> `None of the specified ports are installed.`！

如果我使用*macports*安装最新的*svn*，我可能会在我的 osx 上丢失第三个。

拜托，这不是技术问题，因为我可以完美地使用旧的 svn，但我需要解释。我的问题是`What is going on ?`

ps：随时编辑我的帖子以适应stackoverflow上一个好问题的要求。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T13:45:32.213

安装[macports](http://www.macports.org/)，它将修改您`~/.profile`以包含`/opt/local/bin`在开头`$PATH`（您可能必须注销并重新登录才能生效）。

然后：

```
$ sudo port install subversion 
```

之后，`which svn`应该显示：

```
/opt/local/bin/svn 
```

# wpf - 从 wpf 网格中看不到绘制的矩形

> ID：13361473
> 
> 赞同：1
> 
> 时间：2012-11-13T13:23:09.453
> 
> 标签：wpf, grid, drawing

我为我的英语语法弱点道歉。我尝试在 WPF 网格中绘制一个矩形。我画了它，但在网格的右侧和底部看不到这个矩形。我应该怎么办？这是我的 XAML 和代码。

< 窗口 x:Class="DrawCircle.MainWindow"

```
 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"

    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"

    Title="MainWindow" Height="350" Width="525"
    MouseLeftButtonUp="window_MousLefteUp" MouseRightButtonUp="window_MouseRightButtonUp"
    MouseMove="Grid_MouseMove"
    MouseDown="Grid_MouseDown" >

<Grid x:Name="window"  Margin="0,0,0,0" Background="PaleGreen"  VerticalAlignment="Stretch" HorizontalAlignment="Stretch" ClipToBounds="False">

    <Grid.RenderTransform>
        <TransformGroup>

            <ScaleTransform x:Name="scaleTransform1" ScaleX="0.5" ScaleY="0.5" />
            <TranslateTransform x:Name="translateTransform1" X="0" Y="0" />

        </TransformGroup>
    </Grid.RenderTransform>

</Grid> 
```

它的背后代码是：

```
public partial class MainWindow : Window
{

    bool cornerPointed = false;
    Point corner1;
    Rectangle myRectangle;        

    public MainWindow()
    {
        InitializeComponent();
        myRectangle = new Rectangle();
        myRectangle.HorizontalAlignment = HorizontalAlignment.Left;
        myRectangle.VerticalAlignment = VerticalAlignment.Top;
        myRectangle.Stroke = Brushes.Red;
        window.Children.Add(myRectangle);
    }
    private void Grid_MouseDown(object sender, MouseButtonEventArgs e)
    {

        cornerPointed = true;
        corner1 = new Point(e.GetPosition(this.window).X, e.GetPosition(this.window).Y);
        myRectangle.Margin = new Thickness(corner1.X, corner1.Y, 0, 0);
    }

    private void Grid_MouseMove(object sender, MouseEventArgs e)
    {
        if (cornerPointed == true)
        {
            Point corner2 = e.GetPosition(this.window);
            myRectangle.Margin = new Thickness(System.Math.Min(corner1.X, corner2.X),
                                               System.Math.Min(corner1.Y, corner2.Y),
                                               0, 0);
            myRectangle.Width = Math.Abs(e.GetPosition(this.window).X - corner1.X);
            myRectangle.Height = Math.Abs(e.GetPosition(this.window).Y - corner1.Y);
        }
    }

    private void window_MousLefteUp(object sender, MouseButtonEventArgs e)
    {

        cornerPointed = false;
        myRectangle = new Rectangle();
        myRectangle.HorizontalAlignment = HorizontalAlignment.Left;
        myRectangle.VerticalAlignment = VerticalAlignment.Top;
        myRectangle.Stroke = Brushes.Red;
        window.Children.Add(myRectangle);

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:20:05.783

scaletransform 正在缩小你的绿色网格。由于您直接在绿色网格上绘制红色矩形，因此红色矩形不能超出绿色。

如果你想让绿色变得那么小，但到处都有红色，那么你可以使用另一个像这样的网格：

```
 <Grid x:Name="window">
    <Grid Background="PaleGreen">
      <Grid.RenderTransform>
        <TransformGroup>
          <ScaleTransform x:Name="scaleTransform1" ScaleX="0.5" ScaleY="0.5" />
          <TranslateTransform x:Name="translateTransform1" X="0" Y="0" />
        </TransformGroup>
      </Grid.RenderTransform>
    </Grid>
  </Grid> 
```

编辑：这是一个使用滑块来演示“缩放”效果的附加示例。当您移动滑块时，红色矩形也会被缩放。

```
 <DockPanel LastChildFill="True">
    <Slider x:Name="sldZoom" DockPanel.Dock="Top" Orientation="Horizontal" Minimum="0" Maximum="1" Value="1"/>
    <Grid Background="PaleGreen" x:Name="window">
      <Grid.RenderTransform>
        <TransformGroup>
          <ScaleTransform x:Name="scaleTransform1"
                          ScaleX="{Binding ElementName=sldZoom, Path=Value, Mode=OneWay}"
                          ScaleY="{Binding ElementName=sldZoom, Path=Value, Mode=OneWay}" />
        </TransformGroup>
      </Grid.RenderTransform>
    </Grid>
  </DockPanel> 
```

EDIT2：如果您愿意，您还可以更改滑块的比例（或您使用的任何绑定属性）。例如.. 而不是使用 0-1 比例，您可以使用 0-10 比例。这意味着，当您将其设置为 10 时，您将获得 10 倍缩放效果。

如果您想禁用缩小到无法写入的空白点，则将基本比例设置为 1。这是一个滑块，您可以放入我上面的示例中，它将为您提供 1-10 倍的比例。这将禁止用户缩小到无法写入的区域。（您可以使用数字来获得您喜欢的任何设置）。

```
<Slider x:Name="sldZoom" DockPanel.Dock="Top" Orientation="Horizontal" Minimum="1" Maximum="10" Value="2"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:13:49.460

你是在问为什么绿色网格没有填满整个窗口？如果是这样，那是因为这条线将网格的宽度和高度缩小了 50%：

```
<ScaleTransform x:Name="scaleTransform1" ScaleX="0.5" ScaleY="0.5" /> 
```

如果这不是问题，请澄清问题是什么。

# python-3.x - 如何在 tkinter Python 中展开顶层窗口？

> ID：13361479
> 
> 赞同：2
> 
> 时间：2012-11-13T13:23:18.423
> 
> 标签：python-3.x, tkinter

当我生成新的顶级窗口时，我希望它显示为全屏。我不知道该怎么做。在我的情况下，不可能使用 overrideredirect() 方法。我必须留下窗口的标题。当我设置屏幕分辨率的大小时：

```
self.geometry("{0}x{1}+0+0".format(self.winfo_screenwidth(), self.winfo_screenheight())) 
```

窗口填满了所有屏幕空间，但仍未完全展开。在这种情况下，我必须按窗口右上角的“展开”按钮才能完全展开它。我该怎么做才能生成已经展开的顶级窗口？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T21:25:11.477

您可以使用`wm_attributes`方法 (of`Tk`或`Toplevel`) 来设置`zoomed`属性。

```
self.wm_attributes("-zoomed", "1") 
```

[您可以在Tk doc](http://www.tcl.tk/man/tcl/TkCmd/wm.htm#m8)中找到更多属性描述。

请注意，还有一个`fullscreen`属性，您可以通过仅传递属性名称来读取状态，即 `wm_attributes("-zoomed")`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-29T14:35:07.507

```
from Tkinter import *
root = Tk()
root.wm_attributes('-topmost', 1)
root.mainloop() 
```

# javascript - 在提交按钮上设置延迟；id 按钮灰色并在单击后禁用 x 秒

> ID：13361483
> 
> 赞同：1
> 
> 时间：2012-11-13T13:23:31.787
> 
> 标签：javascript, button, submit, delay

我喜欢在提交按钮上设置延迟。换句话说，单击该按钮后会变灰几秒钟。我怎样才能用js完成这个？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:30:55.753

这可能会对您有所帮助：http: [//jsfiddle.net/jhNcM/](http://jsfiddle.net/jhNcM/)

```
<input type="button" id="aaa" value="button" />

$('#aaa').click(function() {
    var aaa =  $(this);
    aaa.prop('disabled', true);
    setTimeout(function() {
        aaa.prop('disabled', false);
    }, 3000);
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:35:04.437

纯 JavaScript：http: [//jsfiddle.net/R5p5q/1/](http://jsfiddle.net/R5p5q/1/)

```
<form id="myForm">
    <input id="mySubmit" type="submit" value="GO" />
</form> 
```

​</p>

```
var myForm = document.getElementById('myForm');

myForm.addEventListener("submit", function(evt) {
    var elemSubmit = document.getElementById('mySubmit');
    elemSubmit.setAttribute("disabled", "disabled");

    // Removes disabling after 3 seconds
    window.setTimeout(function() {
        elemSubmit.removeAttribute("disabled");
    }, 3e3);
},false); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:27:59.617

有一种方法可以做到这一点[http://jsfiddle.net/Ktk6f/](http://jsfiddle.net/Ktk6f/)

HTML

```
<input type="submit" value="submitData" id="myButton" /> 
```

JS

```
$('#myButton').click(function(){
    var that = $(this);
    that.attr('disabled', true);
    var timer = setTimeout(function(){
        that.attr('disabled', false);
    }, 1000);
}); 
```

它需要 jQuery JS 框架

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:27:43.987

```
$("#button").click(function() {
    if (this.disabled) {
        return;
    }
    this.disabled = true;
    setTimeout($.proxy(function() {
        this.disabled = false;
    }, this), 3000);
}); 
```

# mysql - 基于毫秒的 SELECT 时间戳

> ID：13361484
> 
> 赞同：2
> 
> 时间：2012-11-13T13:23:36.800
> 
> 标签：mysql, sql, optimization, delete-row

我将android设备发送的时间戳和一些相关的用户数据存储在一个MySQL表中，其结构如下：

```
CREATE TABLE IF NOT EXISTS `breadcrumbs` (   
  `breadcrumbs_id` bigint(20) NOT NULL AUTO_INCREMENT,   
  `users_id` int(10) NOT NULL,   
  `timestamp` bigint(20) NOT NULL,   
  `data` text,   
  PRIMARY KEY (`breadcrumbs_id`,`users_id`),   
  KEY `fk_breadcrumbs_users1` (`users_id`)   
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=468792 ; 
```

android 设备以毫秒为单位发送时间戳，并遵循 UTC 时间标准来构建时间戳。我一直在尝试去除超过一个月的面包屑。由于 MySQL 没有毫秒格式，我一直在使用以下查询：

```
DELETE FROM breadcrumbs WHERE ((`timestamp`)/1000) < UNIX_TIMESTAMP() - 2592000; 
```

删除记录需要相当长的时间。下面是运行删除查询的结果：

```
/*382,580 rows affected, 0 rows found. Duration for 1 query: 36.894 sec. */ 
```

我的问题是：

1.  我是否正确拾取面包屑？
2.  我可以优化`DELETE`查询，使其比当前运行得更快。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:33:18.570

**选项 1**：添加索引`(timestamp)`并测试此查询，以便可以使用索引：

```
DELETE FROM breadcrumbs 
WHERE `timestamp` < 1000 * UNIX_TIMESTAMP( NOW() - INTERVAL 1 MONTH ) ; 
```

* * *

**选项 2**：使用@Micahel Berkowsi 的方法并存储部分时间戳，MySQL 无需转换即可使用。

* * *

**选项 3**：在**[MySQL 5.6](http://dev.mysql.com/doc/refman/5.6/en/fractional-seconds.html)**发布时迁移到它（它仍处于 beta 测试阶段）或**[MariaDB 5.3 或 5.5](https://kb.askmonty.org/en/microseconds-in-mariadb/)**，它们支持日期时间和时间戳列中的**微秒精度**。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:30:48.113

您的查询逻辑是正确的，但我建议不要首先存储毫秒格式，而是除以 1000 `INSERT`（或存储毫秒和普通 UNIX 时间戳格式）。或者，将其存储为`DATETIME`使用`FROM_UNIXTIME(timestamp / 1000)`时使用`INSERT`。然后，在列上创建索引`timestamp`，删除应该快得多。

```
CREATE TABLE IF NOT EXISTS `breadcrumbs` (   
  `breadcrumbs_id` bigint(20) NOT NULL AUTO_INCREMENT,   
  `users_id` int(10) NOT NULL, 
  `timestamp` bigint(20) NOT NULL,
  /* Also consider storing `timestamp` as a DATETIME */
  /* `timestamp` DATETIME NOT NULL, */
  `data` text,   
  PRIMARY KEY (`breadcrumbs_id`,`users_id`),
  KEY `fk_breadcrumbs_users1` (`users_id`),
  /* index on timestamp */
  INDEX `idx_timestamp` (`timestamp`) 
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=468792 ;   

/* Store the timestamp without the milliseconds (or store it both ways in 2 columns) */
INSERT INTO breadcrumbs (`breadcrumbs_id`, `users_id`, `timestamp`, `data`) VALUES (123,123, input_timestamp / 1000, data)
/* Or even better, store it as a MySQL DATETIME */
INSERT INTO breadcrumbs (`breadcrumbs_id`, `users_id`, `timestamp`, `data`) VALUES (123,123, FROM_UNIXTIME(input_timestamp / 1000), data) 
```

作为索引`DATETIME`列，您的`DELETE`查询将如下所示：

```
DELETE FROM breadcrumbs WHERE `timestamp` < NOW() - INTERVAL 1 MONTH; 
```

# java - 如何扩展 Eclipse 的重命名重构以在完成后触发另一个重构

> ID：13361487
> 
> 赞同：7
> 
> 时间：2012-11-13T13:23:40.953
> 
> 标签：java, eclipse, refactoring, rename, ltk

我正在尝试扩展 eclipse 的重命名重构以调用另一个重命名重构。

```
public class Person {  
  ...  
}

public class PersonDAO {  
   public List<Person> getPersonByName(String name) {  
     ...  
   }  
} 
```

将类 Person 重命名为 User 后，我希望`getPersonByName`将方法重命名为`getUserByName`.

我已经扩展了 RenameParticipant 并尝试通过使用 JDT 重命名重构和 ASTRewrite 来实现。

问题是我创建的更改与原始重命名重构更改冲突。
我无法使用`postCreateChange`（似乎基本处理器只返回 null），现在我被卡住了。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-30T15:48:51.327

无法通过重构来更改方法中由新值“User”定义的字符串“Person”。

但是您可以使用`Ctrl`+`H`在整个工作区中搜索所需的字符串并将其替换为新值。

![在此处输入图像描述](../Images/6b69225a52894059888bdbf18ff2e1ea.png)

当您单击 Replace 按钮时，Eclipse 将询问您将替换 serched String 的新值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-02T09:10:57.803

更好的建议：

1）使用休眠。然后，您将使用 Criteria API，不需要多余地指定“Person”，并且可以以模块化方式附加其他限制/标准——这对于列表/搜索页面很有用。

2) 调用您的 API getByName()。List people = personDao.getPersonByName("...") 已经有点重复重复了。

整个事情看起来有点像我在以前的项目中看到的执行 DAO、数据库访问或持久性的“错误方式”。冗长但不灵活和低效用标准的结合，让我想起了 90 年代中期手工编写的持久性或服务做得不好。

# spring - Spring Security 3.1 运行方式

> ID：13361488
> 
> 赞同：8
> 
> 时间：2012-11-13T13:23:43.253
> 
> 标签：spring, spring-security

我正在尝试让 Spring Security 3.1 中的 Run-As 功能正常工作。奇怪的是，我找不到一个例子。甚至[Spring Security Book](http://www.packtpub.com/spring-security-3/book)也根本没有涵盖这个主题。

这是我的应用程序上下文的安全部分。

```
<security:global-method-security
        pre-post-annotations="enabled">
    <security:expression-handler ref="customExpressionHandler"/>
</security:global-method-security>

<bean id="runAsManager"
      class="org.springframework.security.access.intercept.RunAsManagerImpl">
    <property name="key" value="my_run_as_password"/>
</bean>

<bean id="runAsAuthenticationProvider"
      class="org.springframework.security.access.intercept.RunAsImplAuthenticationProvider">
    <property name="key" value="my_run_as_password"/>
</bean>
<security:http auto-config="true" create-session="always">
    <security:remember-me key="njc2"/>
    <security:session-management invalid-session-url="/sessionTimeout.html"/>
    <security:intercept-url pattern="/**" access="ROLE_USER"/>
    <security:form-login login-page='/login.html'
                         authentication-success-handler-ref="njcAuthenticationSuccessHandler"
                         authentication-failure-url="/login-failure.html"/>
    <security:logout invalidate-session="true" logout-url="/j_spring_security_logout"
                     logout-success-url="/login.html"/>
</security:http> 
```

在运行时，Spring“神奇地”创建了一个实例，`org.springframework.security.access.intercept.aopalliance.MethodSecurityInterceptor`但不连接 my `runAsManager`，因此使用`NullRunAsManager`默认创建的实例。

您能否向我展示一个有效的 Spring Security 3.1 示例，该示例演示运行方式和使用 JSR-250 注释，例如`@RunAs`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T19:40:02.893

实际上你可以使用 Spring Security XML 命名空间来设置`RunAsManager`：

```
<sec:global-method-security run-as-manager-ref="runAsManager">
     <!-- Rest of your code -->
</sec:global-method-security> 
```

我不知道任何开箱即用的`@RunAs`集成。但我确信可以自己实现并与 Spring Security 集成。

# java - java Collection框架中数组和任何集合之间的区别？

> ID：13361489
> 
> 赞同：16
> 
> 时间：2012-11-13T13:23:45.117
> 
> 标签：java, arrays, collections

正如标题所说，我正在研究“数组与 java Collection 框架中的任何集合之间的差异”。

认为它的水平足够高，可以为我们中的一些（或许多）对此知之甚少或需要思考太久才能得出有趣答案的人提供一些很好的理解

到目前为止，我想出了：

1.  集合框架类要么在下面使用数组，要么使用更复杂的数据结构。当一个数组只是...一个数组
2.  Array 没有 Collection 类提供的方法（没有 API）。

如果这些假设不正确，请纠正我，当然还要添加您自己的答案

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-11-14T13:49:15.773

它们实际上是无关的，只是说它们都存储一组值。

从能力的角度来看，虽然两者都可以存储对对象的引用：

*   数组可以存储原语
*   集合**不能**存储原语（尽管它们可以存储原语包装类，例如`Integer`等）

一个重要的区别，Java 新手通常不理解，是可用性和便利性之一，特别是考虑到集合会在需要时自动扩展大小：

*   数组 - 避免使用它们，除非你*必须*
*   集合 - 优先使用它们而不是数组

数组最终是在一个对象中存储一组基元/引用的唯一方法，但它们是最基本的选项。尽管数组可能会给您带来一些速度优势，但除非您*需要*超快的代码，否则集合是首选，因为它们非常方便。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-04-02T07:14:06.580

Array 和 Collection 之间有 5 个区别，如下所示：

1.  数组的大小是固定的，而一些集合本质上是可以增长的。

2.  数组存储同质数据。集合存储同质和异构数据。

3.  在数组中，没有下划线数据结构，而集合有下划线数据结构。

4.  建议使用数组来提高性能，而不建议使用集合。

5.  与集合相比，数组使用更多的内存空间。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2016-01-18T14:09:23.917

1.  数组的长度是固定的，而集合本质上是可增长的。
2.  数组可以存储同质元素，而集合可以存储两者。
3.  如果您事先知道大小，请选择数组
4.  从性能的角度来看，最好使用 Arrays
5.  数组没有任何现成的方法，而集合有现成的方法。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-10-01T08:29:51.047

**数组**和**集合**之间的 6 个区别如下：

1.  数组的大小是固定的，但集合的大小是动态的。
2.  关于内存数组不好用，但关于内存集合更好用。
3.  就性能而言，最好使用数组，但就性能而言，集合不好用。
4.  数组只能包含同质元素，但集合可以同时包含同质和异质元素
5.  数组没有现成的方法，但集合有现成的数据结构和方法。
6.  数组可以同时保存原语和包装对象，但集合只能保存对象。

# c - 解释这个运行函数而不显式调用它的代码？

> ID：13361495
> 
> 赞同：8
> 
> 时间：2012-11-13T13:24:21.143
> 
> 标签：c, buffer-overflow

下面代码的输出是“溢出”，但我没有显式调用该`func`函数。它是如何工作的？

```
#include<stdio.h>
#include<string.h>
#include<stdlib.h>

int copy(char *input)
{
    char var[20];
    strcpy(var, input);
    return 0;
}

int func(void)
{
    printf("Overflow\n");
    return 0;
}

int main(int argc, char *argv[])
{
    char str[] = "AAAABBBBCCCCDDDDEEEEFFFFGGGG";
    int *p = (int *)&str[24];
    *p = (int)func;

    copy(str);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-13T13:27:06.373

`copy`函数溢出函数中的`var`缓冲区，并用`copy`函数的地址覆盖`main`返回地址`func`。

当`copy`函数返回时，不是在函数调用`main`之后返回，而是返回到函数。`copy``func`

# shell - 将字体转换为不同的类型

> ID：13361496
> 
> 赞同：2
> 
> 时间：2012-11-13T13:24:27.603
> 
> 标签：shell, fonts

嗨，我正在寻找一个命令行工具来将我的 svg 字体转换为 woff、otf 等。有人知道这样的工具吗？

谢谢！

# java - 具有数据库支持最佳实践的 Java 枚举

> ID：13361497
> 
> 赞同：3
> 
> 时间：2012-11-13T13:24:32.467
> 
> 标签：java, mysql, hibernate, jpa, enums

我已经四处寻找一些答案，但它们并没有让我足够满意。我希望这不会重复。

我有一个应用程序，其中的数据应该是恒定的。以后可以修改此数据，因此我当前的方法是使用具有此常量的单独表，该表从其他表中引用。例如，此表具有列 ID 和列值。而这个表是由一个带有 ID 和 Value 的 Java 对象来表示的。

当我想比较这个常量时，我​​的问题就来了。比较使用它的 ID 对我来说似乎很难看，所以我想使用枚举来比较它们。但这似乎很尴尬，因为我将在用作“类型”的类中使用 ENUM。所以我也在考虑 JPA 的 @enumerated 注释......但老实说，我没有看到最好的方法。我可以肯定的是，我绝对想要 - 不知何故 - 将这些常量数据存储在数据库中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:35:15.160

在我的脑海中，我可以考虑以下方法。

1.  创建`enum`并将其名称映射到 DB。这种方法很简单并且会奏效。它的缺点是数据库中的字符串太多。因此，如果枚举元素名称正在更改，您必须修复数据库。字符串占用空间。如果您想将此类字段用于查询条件，则需要对此类字段进行索引。
2.  创建`enum`并将其序数映射到 DB。这也很简单，但是即使更改了枚举元素的一个顺序，数据库也需要维护。而且数据库数据的可读性较差。

#1 和 #2 都有共同的缺点：实际上数据存储了两次：一次硬编码为枚举。在数据库中两次。如果您必须修改数据，则必须在 2 个地方执行此操作。必须在开发期间进行修改，因为`enum`必须重新编译。

但是，还有其他[解决方案](http://java.dzone.com/articles/enum-tricks-dynamic-enums)可以提供所谓的“动态枚举”。看一看。可能此解决方案会对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T00:26:33.850

另一种选择是使用字符串字段将您的枚举存储到数据库表中，并在返回的路上将它们包装起来供其他对象使用。

例如以下之一：

[将字符串转换为枚举？](https://stackoverflow.com/questions/1818712/convert-a-string-to-an-enum)

[http://www.vineetmanohar.com/2010/01/3-ways-to-serialize-java-enums/](http://www.vineetmanohar.com/2010/01/3-ways-to-serialize-java-enums/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T14:05:53.323

以后可以修改的数据不再是恒定的，而是可变的...... ;-)

无论如何：如果可能的值列表可以随时间变化，我认为使用 Enums 和 @enumerated JPA 注释没有问题。

如果值本身可以更改，您将需要某种名称/值映射，以避免使用 ID 进行比较。您还可以将“属性”添加到 Enums，您可以将其用于数据的可变部分。这样，只有枚举的名称将作为常量字符串存储在数据库中（作为标识符），并且“值”可以在您的代码中更改。

[http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html](http://docs.oracle.com/javase/tutorial/java/javaOO/enum.html)

# c - 在C中返回具有多个数字的奇数/偶数

> ID：13361499
> 
> 赞同：1
> 
> 时间：2012-11-13T13:25:14.257
> 
> 标签：c, if-statement

我正在尝试编写一个程序，该程序将采用两个数字并根据它们的值，返回两个都是奇数，两个都是偶数，或者 A 是奇数，B 是偶数，等等。

我设法让程序检查一个变量，但如果我添加第二个变量，我会得到一个我没想到的输出，而且我似乎无法安排代码以提供正确的输出。我猜这是 if/else 语句的排列有问题。

```
#include <stdio.h>

int main()
{
    int numA, numB;
    printf("Please enter variables:");
    scanf("%d, %d", &numA, &numB);
    if (numA % 2) {
        printf("Variable A:%d is odd \n",numA);
    }
else{
    printf("Variable A:%d is even \n", numA);
}
if (numB % 2) {
    printf("Variable B:%d is odd \n",numB);
}
else{
    printf("Variable B:%d is even \n", numB);
}
return 0;
} 
```

我得到的输出如下

```
Please enter variables:4 5
Variable A:4 is even 
Variable B:32767 is odd 
```

为什么变量 B:32767 不是 5？

非常感谢您一如既往的帮助。如果我能解决这个问题，希望我能自己解决剩下的问题。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T13:27:05.843

您的`scanf`格式要求数字用逗号分隔，

```
scanf("%d, %d", &numA, &numB); 
```

但是您的输入不是，因此只有第一个数字被转换，`scanf`第二个数字未初始化。

您应该始终检查和朋友的返回值，`scanf`以验证是否进行了正确的转换次数。

# c# - 数组必须包含 1 个元素

> ID：13361500
> 
> 赞同：45
> 
> 时间：2012-11-13T13:25:18.557
> 
> 标签：c#, .net, asp.net-mvc, asp.net-mvc-3, model-validation

我有以下课程：

```
public class CreateJob
{
    [Required]
    public int JobTypeId { get; set; }
    public string RequestedBy { get; set; }
    public JobTask[] TaskDescriptions { get; set; }
} 
```

我想在上面有一个数据注释，`TaskDescriptions`以便数组必须包含至少一个元素？很像`[Required]`。这可能吗？

* * *

## 回答 #1

> 赞同：71
> 
> 时间：2013-05-19T12:31:52.200

它可以使用标准的 Required 和 MinLength 验证属性来完成，但仅适用于数组：

```
public class CreateJob
{
    [Required]
    public int JobTypeId { get; set; }
    public string RequestedBy { get; set; }
    [Required, MinLength(1)]
    public JobTask[] TaskDescriptions { get; set; }
} 
```

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2012-11-13T13:31:37.923

我以前见过用于此的自定义验证属性，如下所示：

（我已经给出了带有列表的示例，但可以适用于数组，或者您可以使用列表）

```
public class MustHaveOneElementAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        var list = value as IList;
        if (list != null)
        {
            return list.Count > 0;
        }
        return false;
    }
}

[MustHaveOneElementAttribute (ErrorMessage = "At least a task is required")]
public List<Person> TaskDescriptions { get; private set; }

// as of C# 8/9 this could be more elegantly done with     
public class MustHaveOneElementAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        return value is IList {Count: > 0};
    }
} 
```

感谢 Antonio Falcão [Jr.](https://stackoverflow.com/users/13142131/antonio-falc%C3%A3o-jr)的优雅

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2018-06-01T10:10:18.767

这是@dove 解决方案的一些改进版本，它处理不同类型的集合，例如 HashSet、List 等...

```
public class MustHaveOneElementAttribute : ValidationAttribute
{
    public override bool IsValid(object value)
    {
        var collection = value as IEnumerable;
        if (collection != null && collection.GetEnumerator().MoveNext())
        {
            return true;
        }
        return false;
    }
} 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2018-04-12T08:45:42.363

请允许我在 .NET Core 中使用 MinLengthAttribute。

Microsoft 建议使用从 .NET Core 2.0 开始的 Razor Pages。

目前，在 PageModel 中的属性上使用 MinLengthAttribute 的验证不起作用：

```
[BindProperty]
[Required]
[MinLength(1)]
public IEnumerable<int> SelectedStores { get; set; } 
```

当 SelectedStores.Count() == 0 时，ModelState.IsValid 返回 true。

使用 .NET Core 2.1 Preview 2 进行测试。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2020-11-26T16:27:49.850

您必须使用 2 个标准注释属性

```
public class CreateJob
{
    [MaxLength(1), MinLength(1)]
    public JobTask[] TaskDescriptions { get; set; }
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2020-04-02T13:02:42.830

除了 mynkow 的回答之外，我还添加了将最小计数值传递给属性并生成有意义的失败消息的功能：

```
public class MinimumElementsRequiredAttribute : ValidationAttribute
{
  private readonly int _requiredElements;

  public MinimumElementsRequiredAttribute(int requiredElements)
  {
    if (requiredElements < 1)
    {
      throw new ArgumentOutOfRangeException(nameof(requiredElements), "Minimum element count of 1 is required.");
    }

    _requiredElements = requiredElements;
  }

  protected override ValidationResult IsValid(object value, ValidationContext validationContext)
  {
    if (!(value is IEnumerable enumerable))
    {
      return new ValidationResult($"The {validationContext.DisplayName} field is required.");
    }

    int elementCount = 0;
    IEnumerator enumerator = enumerable.GetEnumerator();
    while (enumerator.MoveNext())
    {
      if (enumerator.Current != null && ++elementCount >= _requiredElements)
      {
        return ValidationResult.Success;
      }
    }

    return new ValidationResult($"At least {_requiredElements} elements are required for the {validationContext.DisplayName} field.");
  }
} 
```

像这样使用它：

```
public class Dto
{
  [MinimumElementsRequired(2)]
  public IEnumerable<string> Values { get; set; }
} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2021-05-27T14:43:29.797

只需更新 Dove (@dove) 对 C# 9 语法的响应：

```
 public class MustHaveOneElementAttribute : ValidationAttribute
    {
        public override bool IsValid(object value)
            => value is IList {Count: > 0};
    } 
```

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2018-04-15T20:08:04.627

MinLength 属性认为该值为 null 的值是有效的。因此，只需将模型中的属性初始化为空数组即可。

```
MinLength(1, ErrorMessageResourceName = nameof(ValidationErrors.AtLeastOneSelected), ErrorMessageResourceType = typeof(ValidationErrors))]
int[] SelectedLanguages { get; set; } = new int[0]; 
```

# javascript - 在 webviews 中有哪些 Titanium 命名空间可用？

> ID：13361501
> 
> 赞同：0
> 
> 时间：2012-11-13T13:25:18.683
> 
> 标签：javascript, webview, namespaces, titanium

这是在这里，因为我花了太长时间才自己发现这一点。

如果您有一个加载本地网页的 Titanium webview，则该网页可以访问 Titanium 命名空间。文档添加：“......*特别*是 Ti.App.fireEvent 和 Ti.API 日志记录功能”。

但是，如果您实际上使用触发 Javascript 的按钮将本地网页加载到 webview 中，您会发现 Titanium 命名空间的很大一部分不可用，并且调用其中任何一个都会杀死 Javascript 线程。

那么哪些位可用，哪些不可用？查看答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:34:53.223

答案是你没有得到*特别的日志记录和事件触发的*东西......这两件事就是*你*得到的。

提供给 webview 的 Titanium 对象如下所示：

```
{ 
  _event_listeners: function(),
  createEventListener: function(listener),
  getEventListenerByKey: function(key,arg),
  API: org.appcelerator.kroll.KrollLogging@40588cb8,
  App: [object]
  executeListener: function (id,data)
 } 
```

Titanium.App 对象依次包括：

```
{
  addEventListener : function(eventName,listener),
  removeEventListener : function(eventName,listener),
  fireEvent : function(eventName,data)
} 
```

任何其他位的钛都不可用。忍受它。

# jquery - 如何获取 Raphael 中的最后一个元素（对象）、位置详细信息？

> ID：13361508
> 
> 赞同：0
> 
> 时间：2012-11-13T13:25:39.650
> 
> 标签：jquery, raphael

我正在做一个循环函数来制作圆圈，我决定将圆圈链接到对象之间的画线，所以，第一个圆圈是绘制我应该得到对象的'cx'和'cy'，我将开始划清界线。

为此，在 jquery 的情况下，我们可以使用 ':last' 选择器获得最终元素，我正在尝试使用 raphael，任何人都可以帮助我获得每个绘图的最后一个元素。

我的功能：

```
var paper = new Raphael('paper',500,500);
var circle1 = paper.circle(50,50,50).attr({fill:'green'});

var circle2 = paper.circle(200,50,50).attr({fill:'red'});

$(paper.node,':first').click(function(){
    alert(this.atrr('x'));
})

$(paper.node,':last').click(function(){
    alert(this.atrr('x'));
}) 
```

[jsfiddle在这里](http://jsfiddle.net/Mg39Z/2/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:21:12.547

@3gwebtrain

尝试这个：

```
var paper = new Raphael('paper',500,500);
var circle1 = paper.circle(50,50,50).attr({fill:'green'});
var circle2 = paper.circle(180,50,50).attr({fill:'red'});

jQuery(function($){

    var c1 = $('circle:first').attr("cx");
    var c2 = $('circle:last').attr("cx");
    $('circle:first').click(function(){
        alert(c1);
    });
    $('circle:last').click(function(){
        alert(c2);
    });

}); 
```

或在这里找到小提琴：http: [//jsfiddle.net/Mg39Z/5/](http://jsfiddle.net/Mg39Z/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:47:21.637

您的功能设置不正确，您应该像这样使用它：

[http://jsfiddle.net/S6REC/](http://jsfiddle.net/S6REC/)

```
$('circle:first',paper.node).click(function(){
    alert($(this).attr('cx'));
})

$('circle:last',paper.node).click(function(){ 
    alert($(this).attr('cx'));
}) 
```

# python - 类型错误：+ 不支持的操作数类型：“dict_items”和“dict_items”

> ID：13361510
> 
> 赞同：32
> 
> 时间：2012-11-13T13:25:57.420
> 
> 标签：python, python-3.x

我尝试总结两个这样的字典：

```
my_new_dict = dict(my_existing_dict.items() + my_new_dict.items()) 
```

但收到错误

```
TypeError: unsupported operand type(s) for +: 'dict_items' and 'dict_items' 
```

我做错了什么？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-11-13T13:28:08.507

从 Python 3.9（尤其是[PEP 584](https://www.python.org/dev/peps/pep-0584/)）开始，dicts 像集合一样获得 union ( `|`) 和 update ( `|=`) 操作，因此这成为实现您正在寻找的“一种真正的方式”。

```
d1 | d2 
```

该 PEP 列出了早期 Python 版本中可用的其他选项，这些选项都有其缺点。如果您达到[PEP 448](https://www.python.org/dev/peps/pep-0448/) (Python 3.5)，我建议您使用：

```
{**d1, **d2} 
```

这是将两个字典解包成一个新字典，从而形成一个联合。

一个问题是你想要的行为是模棱两可的——字典不能有重复的键，所以如果两者都包含相同的键，你想发生什么就不清楚了。该规范明确说明了使用此方法时应该发生的情况：

> 在字典中，后面的值总是会覆盖前面的

如果您想要相反的行为，您可以简单地交换文字中字典的顺序。

您的方法不起作用，因为[字典视图是 set-like](http://docs.python.org/3/library/stdtypes.html#dictionary-view-objects)，因此它们没有实现添加。

您可能想要的是[union](https://docs.python.org/3/library/stdtypes.html#frozenset.union) : `d1.items() | d2.items()`，它将为您提供一组`(key, value)`. 如果然后将其传递给`dict()`并且有重复项，则“最后一个”值将是使用的值，但是集合（与视图本身不同）是无序的，因此不能保证哪个项目最终会在组合中“第一个”设置，这意味着一个“获胜”将是任意的。

因此，简而言之，只要订单/重复选择不重要：

```
dict(d1.items() | d2.items()) 
```

在 Python 2 中，`dict.items()`只需返回 a `list`，您的方法将在其中起作用。

* * *

## 回答 #2

> 赞同：29
> 
> 时间：2012-11-13T13:28:18.843

在 python3 中，`dict.items()`返回一个类型`dict_items`显然无法添加的对象。（在 python 2 中，它返回一个`list`可以添加的）。

添加一对适用于 py2k 和 py3k 的字典的另一种方法：

```
d = dict1.copy()
d.update(dict2) 
```

当然，在发生键冲突的情况下，您希望发生的事情有些模棱两可。例如，如果两个 dicts 都有`key1`，`key1`应该在输出中保留谁？或者你应该使用它们两个值的某种组合？在后一种情况下，您可能需要`collections`模块中的某些内容（`defaultdict`或者`Counter`）

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2018-11-19T14:19:38.917

其他建议答案的另一种方法是：

`dict(list(d1.items()) + list(d2.items()))`

`d1`如果和中都存在键，则 in`d2`的值`d2`将用于最终字典。

# c# - 保存用户的配置

> ID：13361512
> 
> 赞同：0
> 
> 时间：2012-11-13T13:26:09.973
> 
> 标签：c#

我正在使用 C# 中的一个小型命令行应用程序。这是`ConfigurationManager`一个很好的解决方案吗？这是我可以写入的配置，还是只读的？

此页面： http: [//msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.appsettings.aspx](http://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.appsettings.aspx)清楚地表明我可以读取数据。

我的目标是通过命令行提示收集一些信息，并将输入的内容写入应用程序可以与其他命令一起使用的文件中。

感谢您的帮助，我是 C# 新手，所以我只是想弄清楚这些东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:30:00.673

我建议使用[设置](http://msdn.microsoft.com/en-us/library/aa730869.aspx)功能而不是`ConfigurationManager`- 如果您想读/写用户设置，那是正确的工具。

> .NET Framework 2.0 允许您创建和访问在应用程序执行会话之间持久存在的值。这些值称为设置。设置可以代表用户偏好或应用程序需要使用的有价值的信息。例如，您可以创建一系列设置来存储用户对应用程序配色方案的偏好。或者，您可以存储指定应用程序使用的数据库的连接字符串。设置允许您在代码之外保留对应用程序至关重要的信息，并创建存储个人用户偏好的配置文件。

# javascript - JQuery滑块：滞后在句柄旁边添加标签

> ID：13361515
> 
> 赞同：0
> 
> 时间：2012-11-13T13:26:19.560
> 
> 标签：javascript, jquery, jquery-ui

[我对这个 StackOverflow 问题](https://stackoverflow.com/questions/8582564/jquery-ui-slider-how-to-make-a-box-follow-the-handler)有类似的设计目标，即向JQuery 滑块添加标签，在用户拖动滑块时显示滑块的当前值。我对这些答案的问题是`slide`当滑块即将移动到新位置时触发事件，并为`ui`对象提供新值。很好，但是我能找到方法的唯一滑块*位置是旧位置，而不是新位置。*滑块上有足够的步数，这并不明显，但如果我减少步数，您会看到标签出现在滑动手柄*曾经*所在的位置旁边。

我已经从另一个问题更新了 jsFiddle 以说明问题：http: [//jsfiddle.net/mcuf6/2/](http://jsfiddle.net/mcuf6/2/)

那么，tl; dr：如何通过在滑动事件期间获取滑块句柄的最终位置来避免在用户拖动句柄时绘制滑块标签的滞后？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:44:23.660

编辑：这个小技巧应该完全符合您的需要

```
$(document).ready(function() {
    $("#slider").slider({
        value:0,
        min: 0,
        max: 5,
        step: 1,
        range: 'min',
        slide: function( event, ui ) {
            var that = $(this);
            setTimeout(function() {
            var offsetLeft = that.find(".ui-slider-handle").offset().left;
            $( "#sliderValue" )
                .val( ui.value )
                .css({
                    "position": "absolute",
                    "left": offsetLeft
                });
        },1);
        }
    });
});​ 
```

[http://jsfiddle.net/mcuf6/6/](http://jsfiddle.net/mcuf6/6/)

# asp.net-mvc - 设置不显示在视图中的属性

> ID：13361516
> 
> 赞同：2
> 
> 时间：2012-11-13T13:26:28.483
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

在我的 MVC 项目中，我在“索引”页面上有三个链接，它们都启动相同的“创建”视图。我想向视图传递一个标志，以允许我确定哪些链接用于启动视图。

我通过创建我的类的新实例、设置“模式”属性并将模型传递给视图来实现这一点。

例如，在“索引”视图中，我有：

```
@Html.ActionLink("My Link 1", "Create", New With {.id = 1}, Nothing)
@Html.ActionLink("My Link 2", "Create", New With {.id = 2}, Nothing)
@Html.ActionLink("My Link 3", "Create", New With {.id = 3}, Nothing) 
```

我的控制器中的“创建”将是：

```
Function Create(id As Integer) As ActionResult
    Dim myObject As myObject = New myObject
    myObject.Mode = id

    Return View(myObject)
End Function 
```

这似乎只有在我的视图中有一个引用“模式”属性的编辑器时才有效。如果我将以下代码留在我的视图中，一切正常，但是如果删除它（因为我不想在表单上显示它），“模式”属性始终设置为 0。

```
<div class="editor-label">
   @Html.LabelFor(Function(model) model.Mode)
</div>
<div class="editor-field">
   @Html.EditorFor(Function(model) model.Mode)
   @Html.ValidationMessageFor(Function(model) model.Mode)
</div> 
```

如何设置“模式”而不在我的视图中显示？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:33:04.347

你可以试试

```
@Html.HiddenFor(model.Mode) 
```

# c++ - boost::spirit::lex 和空格的问题

> ID：13361519
> 
> 赞同：5
> 
> 时间：2012-11-13T13:26:33.440
> 
> 标签：c++, boost, boost-spirit, boost-spirit-lex

我尝试学习使用 boost::spirit。为此，我想创建一些简单的词法分析器，将它们组合起来，然后开始使用 Spirit 进行解析。我尝试修改示例，但它没有按预期运行（结果 r 不正确）。

这是词法分析器：

```
#include <boost/spirit/include/lex_lexertl.hpp>

namespace lex = boost::spirit::lex;

template <typename Lexer>
struct lexer_identifier : lex::lexer<Lexer>
{
    lexer_identifier()
        : identifier("[a-zA-Z_][a-zA-Z0-9_]*")
        , white_space("[ \\t\\n]+")
    {
        using boost::spirit::lex::_start;
        using boost::spirit::lex::_end;

        this->self = identifier;
        this->self("WS") = white_space;
    }
    lex::token_def<> identifier;
    lex::token_def<> white_space;
    std::string identifier_name;
}; 
```

这是我正在尝试运行的示例：

```
#include "stdafx.h"

#include <boost/spirit/include/lex_lexertl.hpp>
#include "my_Lexer.h"

namespace lex = boost::spirit::lex;

int _tmain(int argc, _TCHAR* argv[])
{
    typedef lex::lexertl::token<char const*,lex::omit, boost::mpl::false_> token_type;
    typedef lex::lexertl::lexer<token_type> lexer_type;

    typedef lexer_identifier<lexer_type>::iterator_type iterator_type;

    lexer_identifier<lexer_type> my_lexer;

    std::string test("adedvied das934adf dfklj_03245");

    char const* first = test.c_str();
    char const* last = &first[test.size()];

    lexer_type::iterator_type iter = my_lexer.begin(first, last);
    lexer_type::iterator_type end = my_lexer.end();

    while (iter != end && token_is_valid(*iter))
    {
        ++iter;
    }

    bool r = (iter == end);

    return 0;
} 
```

只要字符串中只有一个标记，r 就为真。为什么会这样？

问候托拜厄斯

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-13T19:33:24.080

您已经创建了第二个词法分析器状态，但从未调用过它。

# 简化并获利：

* * *

`pass_ignore`在大多数情况下，获得所需效果的最简单方法是在可跳过标记上使用带有标志的单状态词法分析：

```
 this->self += identifier
                | white_space [ lex::_pass = lex::pass_flags::pass_ignore ]; 
```

请注意，这需要`actor_lexer`允许语义操作：

```
typedef lex::lexertl::actor_lexer<token_type> lexer_type; 
```

完整样本：

```
#include <boost/spirit/include/lex_lexertl.hpp>
#include <boost/spirit/include/lex_lexertl.hpp>
namespace lex = boost::spirit::lex;

template <typename Lexer>
struct lexer_identifier : lex::lexer<Lexer>
{
    lexer_identifier()
        : identifier("[a-zA-Z_][a-zA-Z0-9_]*")
        , white_space("[ \\t\\n]+")
    {
        using boost::spirit::lex::_start;
        using boost::spirit::lex::_end;

        this->self += identifier
                    | white_space [ lex::_pass = lex::pass_flags::pass_ignore ];
    }
    lex::token_def<> identifier;
    lex::token_def<> white_space;
    std::string identifier_name;
};

int main(int argc, const char *argv[])
{
    typedef lex::lexertl::token<char const*,lex::omit, boost::mpl::false_> token_type;
    typedef lex::lexertl::actor_lexer<token_type> lexer_type;

    typedef lexer_identifier<lexer_type>::iterator_type iterator_type;

    lexer_identifier<lexer_type> my_lexer;

    std::string test("adedvied das934adf dfklj_03245");

    char const* first = test.c_str();
    char const* last = &first[test.size()];

    lexer_type::iterator_type iter = my_lexer.begin(first, last);
    lexer_type::iterator_type end = my_lexer.end();

    while (iter != end && token_is_valid(*iter))
    {
        ++iter;
    }

    bool r = (iter == end);
    std::cout << std::boolalpha << r << "\n";
} 
```

印刷

```
true 
```

# “WS”作为船长状态

* * *

也有可能您遇到了使用第二个解析器状态作为船长 ( `lex::tokenize_and_phrase_parse`) 的示例。让我花一分钟或 10 分钟为此创建一个工作示例。

**更新**花了我 10 多分钟 (waaaah) :) 这是一个对比测试，展示了词法分析器状态如何交互，以及如何使用 Spirit Skipper 解析来调用第二个解析器状态：

```
#include <boost/spirit/include/qi.hpp>
#include <boost/spirit/include/lex_lexertl.hpp>
namespace lex = boost::spirit::lex;
namespace qi  = boost::spirit::qi;

template <typename Lexer>
struct lexer_identifier : lex::lexer<Lexer>
{
    lexer_identifier()
        : identifier("[a-zA-Z_][a-zA-Z0-9_]*")
        , white_space("[ \\t\\n]+")
    {
        this->self       = identifier;
        this->self("WS") = white_space;
    }
    lex::token_def<> identifier;
    lex::token_def<lex::omit> white_space;
};

int main()
{
    typedef lex::lexertl::token<char const*, lex::omit, boost::mpl::true_> token_type;
    typedef lex::lexertl::lexer<token_type> lexer_type;

    typedef lexer_identifier<lexer_type>::iterator_type iterator_type;

    lexer_identifier<lexer_type> my_lexer;

    std::string test("adedvied das934adf dfklj_03245");

    {
        char const* first = test.c_str();
        char const* last = &first[test.size()];

        // cannot lex in just default WS state:
        bool ok = lex::tokenize(first, last, my_lexer, "WS");
        std::cout << "Starting state WS:\t" << std::boolalpha << ok << "\n";
    }

    {
        char const* first = test.c_str();
        char const* last = &first[test.size()];

        // cannot lex in just default state either:
        bool ok = lex::tokenize(first, last, my_lexer, "INITIAL");
        std::cout << "Starting state INITIAL:\t" << std::boolalpha << ok << "\n";
    }

    {
        char const* first = test.c_str();
        char const* last = &first[test.size()];

        bool ok = lex::tokenize_and_phrase_parse(first, last, my_lexer, *my_lexer.self, qi::in_state("WS")[my_lexer.self]);
        ok = ok && (first == last); // verify full input consumed
        std::cout << std::boolalpha << ok << "\n";
    }
} 
```

输出是

```
Starting state WS:  false
Starting state INITIAL: false
true 
```

# iphone - 即使单击更新按钮，分发配置文件仍会过期

> ID：13361526
> 
> 赞同：2
> 
> 时间：2012-11-13T13:26:53.847
> 
> 标签：iphone, ios, xcode

我的应用程序的分发配置文件已过期，旁边会出现一个“更新”按钮，但点击它后什么也没有发生，只是它把我带到了开发配置文件页面。单击更新按钮后，分发配置文件的状态仍然过期。我想更新它，有没有人对此有任何想法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:45:46.870

转到[https://developer.apple.com/devcenter/ios/index.action](https://developer.apple.com/devcenter/ios/index.action)，登录并​​按照步骤更新您的开发者计划。之后，您可以从您的供应端口下载供应配置文件，并通过将其拖到 XCode 应用程序图标上来在 XCode 中进行设置。删除旧的，它会很好。为我工作:)

# ios - 当我有自定义 TableViewCell 并想做 MVC 时使用 TableView 或 TableViewController

> ID：13361528
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:27:00.197
> 
> 标签：ios, model-view-controller, uitableview, tableview

1.  条件：我有一个自定义 TableViewCell，我以编程方式做所有事情，没有 xib。
2.  如果我想做一个MVC（拆分视图和动作），使用TableView还是使用Single TableViewController，哪个更适合MVC设计？
3.  据我所知，TableView 只是一个 UI 视图，而 TableViewController 可以包含一些逻辑。这是否意味着，如果我想要一个严格的 MVC 设计，我需要使用 TableView 和另一个 object-c 文件来处理 TableView 的逻辑，TableViewCell。

我在stackoverflow、google上搜索过这个，没有具体的答案或很好的理解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:42:29.193

我曾经保持

1.  自定义“模型”对象，其中包含用户的用户名、城市和图像，假设在“User.h”和“User.m”类中
2.  自定义“视图”对象，其中包含两个用于显示名称和城市的 UILabel 和用于显示用户图片的 UIImageView，假设命名为“CellUser”
3.  自定义“Controller”对象，可以包含 UITableView 的 datasource 和 datadelegate 方法，例如“UserViewController”，“UIViewController”的子类。

可以根据项目的需要创建自定义 UITableView 类，假设当您需要在项目的一页以上显示相同的数据时。

希望能帮助你理解！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:51:21.070

UITableViewCell 子类可以充当模型。它可以包含您在 UIView 中显示的视图。
在 UITableViewCell 子类中创建一个方法来初始化数据并将其插入当前单元格的子视图中。
在“tableView cellForRowAtIndexPath”方法中，您实例化您的 CustomCell 类。

UITableViewController 与您将自己创建的 UIViewController 并放入 UITableView 相同。它是 UIViewController 的子类，只是为了方便用户。并设置委托和数据源，而无需您设置它们。

# c - c编程scanf

> ID：13361538
> 
> 赞同：2
> 
> 时间：2012-11-13T13:27:39.353
> 
> 标签：c, morse-code

我被分配了这个任务，这是我到目前为止所做的代码。该代码只接受一个字母，当它应该比字母做更多时，所以我可以输入一个单词，它会是摩尔斯电码

```
#include "stdafx.h"
#include <ctype.h> 
#include <stdlib.h>
#include <string.h>

int _tmain(int argc, _TCHAR* argv[])
{
  char input[80], str1[100];

  fflush(stdin);
  printf("Enter a phrase to be translated:\n");
  scanf("%c", &input);
  int j = 0;
  for (int i = 0; i <= strlen(input); i++)
    {
      str1[j] = '\0';
      switch(toupper(input[i]))
        {
          ..................
        }
      j++;
    }
  printf("\nMorse is \n %s\n", str1);
  fflush(stdout);
  //printf("%s\n ",morse);
  free(morse);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T13:30:04.837

您的 scanf`%c`只需要一个字符。用于`%s`读取 c 字符串：

```
scanf("%s", input); 
```

参数为`scanf()`指针类型。由于 c 字符串名称是指向第一个元素的指针，因此无需说 address-of ( `&`)。

如果您只阅读一个字符，则需要使用`&`.

例如：

```
scanf("%c", &input[i]); // pass the address of ith location of array input. 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:31:10.147

`scanf("%c", &input);`将读取一个字符，您可能正在寻找`scanf("%s", input);`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T13:30:45.587

`%s`使用not读取字符串`%c`。同样一个字符串已经是一个指针，不需要获取它的地址。所以转换这个：

```
scanf("%c", &input); 
```

进入：

```
scanf("%s", input); 
```

# asp.net-mvc-3 - 读取 Excel 数据并在 MVC 视图中以表格形式显示

> ID：13361540
> 
> 赞同：0
> 
> 时间：2012-11-13T13:27:46.083
> 
> 标签：asp.net-mvc-3, import-from-excel

我正在使用 MVC3。我想从 Excel 表中读取数据，这些数据将保存在我的应用程序的一个文件夹中。我必须逐行验证数据。最后必须以表格形式在视图中显示相同的内容。如果存在验证问题，则这些单元格的背景颜色应为红色。

所以，我想要从 Excel 中读取数据并以表格形式显示在视图中的解决方案。我可以在我的 MVC 应用程序中使用哪些功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:32:22.257

我建议使用[Open XML SD](http://www.microsoft.com/en-us/download/details.aspx?id=5124) K 或[EPPLUS](http://epplus.codeplex.com/)来执行此操作。如果使用旧的 excel .xls，我建议[使用 OLE DB](http://www.codeproject.com/Articles/8500/Reading-and-Writing-Excel-using-OLEDB)

# python - 在 ReadTheDocs 上构建 Sphinx 文档

> ID：13361552
> 
> 赞同：0
> 
> 时间：2012-11-13T13:28:52.867
> 
> 标签：python, django, google-app-engine, python-sphinx, django-sphinx

有一种方法可以让 readthedocs.org 为在 google 应用程序引擎上运行的 Django 项目（托管在 git 上）构建基于 sphinx 的文档？

我继续收到此错误：

```
Sphinx Standard Error
The Google App Engine SDK could not be found! 
```

我创建了以下需求文件：

```
django
ez_setup
google-appengine 
```

但 ReadTheDocs 无法解压 google-appengine

```
Downloading/unpacking django (from -r docs/requirements.txt (line 1))
    Running setup.py egg_info for package django

Downloading/unpacking ez-setup (from -r docs/requirements.txt (line 2))
   Downloading ez_setup-0.9.tar.gz
   Running setup.py egg_info for package ez-setup

Downloading/unpacking google-appengine (from -r docs/requirements.txt (line 3))
   Running setup.py egg_info for package google-appengine
   Traceback (most recent call last):
       File "<string>", line 16, in <module>
       File  "/home/docs/checkouts/readthedocs.org/user_builds/****/envs/latest/build/google-appengine/setup.py", line 2, in <module>
       import ez_setup
   ImportError: No module named ez_setup
   Complete output from command python setup.py egg_info:
   Traceback (most recent call last):

File "<string>", line 16, in <module>

File "/home/docs/checkouts/readthedocs.org/user_builds/***/envs/latest/build/google-appengine/setup.py", line 2, in <module>

import ez_setup
ImportError: No module named ez_setup 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-18T17:40:50.210

`ez_setup`不是你通常会依赖的东西。它是一个单独的`ez_setup.py`文件，过去捆绑在您旁边，`setup.py`以帮助没有`setuptools`（或`distribute`）安装的人。在您的 setup.py 中将类似于：

```
try:
    import setuptools
except Import Error:
    # run ez_setup 
```

但是您正在使用 virtualenv，并且您现在几乎可以指望拥有 virtualenv/setuptools/distribute 的人。因此，您可以删除所有`ez_setup`引用，尤其是从您的`requirements.txt`.

我认为`ez_setup`您正在安装的模块干扰了应用引擎自己的`setup.py`.

# c++ - enable_if 结构定义和默认模板参数

> ID：13361553
> 
> 赞同：2
> 
> 时间：2012-11-13T13:29:02.823
> 
> 标签：c++, templates

根据 enable_if struct 的定义：

```
template<bool B, class T = void>
struct enable_if {};

template<class T>
struct enable_if<true, T> { typedef T type; }; 
```

我想知道如何

```
template<class T>
T foo(T t, typename std::enable_if<std::is_integral<T>::value >::type* = 0) 
{
    return t;
} 
```

特别 ：

```
typename std::enable_if<std::is_integral<T>::value >::type 
```

可以在没有指定类型 T 的情况下调用，以防`std::is_integral<T>::value`equal `true`。在这种情况下，将调用 std::enable_if 的特化，并且在此定义中没有默认模板参数。

是不是因为推导模板参数机制？如果是，为什么为非专业化定义指定默认参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:40:59.233

你的问题有点神秘，但据我了解：

> 我想知道如何`...`在没有指定类型 T 的情况下调用

1.  它不会；只有当用户需要（隐式或显式）*具有特定值的*实例化时，才会实例化`foo`和模板。所以总是被指定。`enable_if`*`T`*`T`

2.  默认模板参数仅在“基本”模板定义中出现（即*不是*特化）。这就是为什么你只在`enable_if`. 但是，它们会影响所有特化（基本上，如果您实例化`enable_if<X>`，编译器会看到您没有为基本模板提供参数之一，并尝试将所有特化与参数列表匹配`<X, void>`）。

顺便说一句，第二个模板参数用于从`enable_if`than中获取不同的类型`void`：

```
std:enable_if<1, int>::type f(); 
```

只是`int f()`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:37:32.450

`enable_if`模板的目的是从重载集中*删除*函数模板。就其本身而言，您的示例并不是非常有用，只是它将拒绝实例化具有编译器错误的非整数类型。但是，如果您还编写了第二个重载，例如使用反向条件，那么`foo(1)`两者`foo(1.0)`都只会找到一个可行的重载并且没有歧义。

事实上，再想一想：在推导 的参数时`foo(1.0)`，第一个版本（你写的那个）实际上是错误的，因为没有成员类型`::type`。但是，这*不是*硬编译错误，而只是所谓的“替换失败”——这*不是*错误。它只是从考虑中删除了整个模板。

作为旁注，`enable_if`在*类*模板中有一个相关用途，可以帮助消除专业化的歧义，也使用默认参数。它看起来像`template <typename T, typename = typename std::enable_if<some_condition>::type> ...`

# c# - 如何在两个 SelectListItem 列表之间使用 except()

> ID：13361554
> 
> 赞同：-4
> 
> 时间：2012-11-13T13:29:07.750
> 
> 标签：c#, asp.net-mvc-3, linq

我有两个类型的列表，`IEnumerable <SelectListItem>`我需要`IEnumerable <SelectListItem>`使用第二个列表中不存在的第一个列表的元素创建一个新列表。我怎样才能做到这一点？

我试图用 a 来做，`Except()`但没有结果......

示例代码：

```
IEnumerable<SelectListItem> SelectListItemA = ....;
IEnumerable<SelectListItem> SelectListItemB = ....;
IEnumerable<SelectListItem> Except = SelectListItemA.Except(SelectListItemB); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:36:39.783

也许是这样的：

```
var items1 = new List<SelectListItem>();
var items2 = new List<SelectListItem>();
//[.. populate lists here ..]
var onlyInFirst = items1.RemoveAll(item1 => items2.Any(item2 => item1.Value == item2.Value)); 
```

`Except`需要它`Equals`并`GetHashCode`在遍历的类中实现。

# javascript - Javascript继承不起作用

> ID：13361572
> 
> 赞同：-2
> 
> 时间：2012-11-13T13:30:04.767
> 
> 标签：javascript, oop

我有这个代码：

```
function a() { this.j = "aa"; }
var b = { o:2 };
b.prototype = new a();
alert(b.j); //alert "undefined" 
```

为什么我会不确定？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:33:26.567

```
function a() {this.j="aa";}
function b() {this.o=2;}
b.prototype=new a();
b.prototype.constructor=b;

var c = new b();

alert(c.j); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:32:05.707

把“b”变成一个函数：

```
function B() {
  this.o = 2;
} 
```

然后给它一个原型：

```
B.prototype = new a(); 
```

然后构造一个“b”：

```
var b = new B(); 
```

然后查看您的警报报告的内容。

# ios - 在其他方法问题中使用检索到的数据（AFNetworking）

> ID：13361574
> 
> 赞同：1
> 
> 时间：2012-11-13T13:30:12.903
> 
> 标签：ios, xcode, macos, afnetworking

我已经在我的应用程序中使用了该项目，并在我想在视图控制器的其他部分中使用的部分中使用了`AFJSONRequest`它返回的数据。`success`我这辈子都想不通。我创建了一个属性来保存数据，但我无法在其他方法中访问它。这有什么原因吗？这可能是我做错了什么。如何在其他方法中使用 nameArray、emailArray 和 passArray？它们已经被声明为属性。这是我的代码：

```
- (void)viewDidLoad
{
[super viewDidLoad];
NSURL *url = [NSURL URLWithString:@"http://10.247.245.87/it/emailmanager.php"];
NSURLRequest *request = [NSURLRequest requestWithURL:url];
[AFJSONRequestOperation addAcceptableContentTypes:[NSSet setWithObject:@"text/html"]];
AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON)
                                     {
                                         NSLog(@"email.last_name is of type: %@", [[JSON valueForKeyPath:@"email.lastname" ] class]);
                                         nameArray = [JSON valueForKeyPath:@"email.last_name"];
                                         emailArray = [JSON valueForKeyPath:@"email.email_address"];
                                         passArray = [JSON valueForKeyPath:@"email.password"];
                                         NSLog(@"%@", nameArray);
                                     }
                                                                                    failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON)
                                     {
                                         NSLog(@"error %@ %@", [error description], JSON);
                                     }];

[operation start];
} 
```

这是其余的。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
EMailCell* cell = [tableView dequeueReusableCellWithIdentifier:@"EmailCell"];
cell.nameLabel.text = @"%@", nameArray;
cell.emailLabel.text = @"%@", emailArray;
cell.passLabel.text = @"%@", passArray;
return cell;

} 
```

以下是 JSON 结果的结构：

```
2012-11-13 07:43:46.026 IT Tools[13987:c07] Names: (
        {
    code = 0496;
    department = Management;
    "email_address" = "????@???.com";
    "first_name" = John;
    id = 227;
    "last_name" = Doe;
    password = "T0496)$(^";
    store = Toyota;
}, 
```

调试器控制台的结果： `2012-11-13 09:04:37.416 IT Tools[15386:c07] email.last_name is of type: __NSArrayI`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:33:16.917

You are assigning arrays to string values. You should loop through the JSON results and create arrays of strings... It would help to know the structure of your JSON results. If you are using core data, there is a handy method for parsing JSON into core data objects.

# php - 如果下拉列表值更改，则运行 php 脚本

> ID：13361576
> 
> 赞同：0
> 
> 时间：2012-11-13T13:30:20.953
> 
> 标签：php, sql

当下拉列表的值更改为运行 viewtb.php 时是否有可能？

这就是我的自动取款机，但我仍然必须使用提交按钮来查看表格。

```
<form method="POST">
<select id="selectcourse" name="selectcourse">
<?php 
$sql = mysql_query("SELECT crs_name FROM sp_crs");
while ($crs_name = mysql_fetch_array($sql)){
echo "<option>" . $crs_name['crs_name'] . "</option>";
}
?>
</select>
<input type="submit" name="Submit" value="View Subjects">
</form>
<?php
$host="localhost";
$username="root";
$password="";
$db_name = "db_sp_dwcsj";

mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name")or die("cannot select DB");
?>

viewtb.php
<?php
if(isset($_POST['Submit'])){
$sort = $_POST['selectcourse'];
$order = "SELECT sbj_name FROM sp_crs_ml where crs_name='$sort'";
$result = mysql_query($order);  
while($data = mysql_fetch_row($result)){
  echo("
  <table border=1
  <tr>
  <td>
  $data[0]
  </td>
  </tr>
  </table>");
}
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:36:00.317

您似乎在这里混合了概念。PHP 脚本旨在在服务器端执行，因此“运行时”调用是不可能的，除非您再次使用 JavaScript（或其他......如 Flash）对服务器执行查询。大多数现代网站都使用 AJAX，一个非常流行的框架是[jQuery](http://jquery.com/)，它允许您执行查询，如此[处](http://api.jquery.com/jQuery.ajax/)所述。

# javascript - 使用子字符串提取数字

> ID：13361582
> 
> 赞同：0
> 
> 时间：2012-11-13T13:30:34.587
> 
> 标签：javascript, substring, substr

我有一个文档，我想从一个大列表中提取特定数字。

我不能在这里列出整个代码，为了简单起见，我将展示一个示例，因为代码不是必需的。

例如，假设我有一个如下所示的列表：

```
1: text,
2: more text,
3: etc 
```

使用 substring 仅捕获字符串中的第一个字母很容易，这将是我所追求的数字。但是，当它达到 10 或 100 时会发生什么？请记住，我根本无法更改列表的格式或内容，我只能接收其中的值。

有没有办法只得到数字，没有字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:33:22.510

使用正则表达式。

就像是

```
var matches = "121: test".match(/^(\d*):\s/)
var val;

if (matches && matches.length > 0) val = matches[1] 
```

这个正则表达式有一堆你可能需要也可能不需要的东西

`^` 表示该行的开头
`()` 表示捕获该组
`\d*` 表示您在一行
`:`中找到的数字数量是您在示例
`\s`中的冒号是冒号后的单个空白字符，在您的示例中

由于我们定义了 (\d*)，match 方法将捕获匹配的那部分（数字）并使其在数组中可用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:35:18.383

你可以做子串直到 indexof(":"); 示例代码：

```
var str="100: Hello world!";
document.write(str.substring(0, str.indexOf(":"))); 
```

结果你得到100。希望这可以帮助！祝你好运，

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-13T13:44:52.713

您可以使用正则表达式：

```
var s = "1: text,\n"+
"2: more text,\n"+
"3: etc\n​​"​;

var matches = s.match( /\d+/ig);

for(var i=0;i<matches.length;++i){
   console.log(matches[i]);           
}​​​​​​​​​​ 
```

看到[它在这里工作](http://jsfiddle.net/felice_pollano/4eCSs/)。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T13:33:28.737

你为什么不为此使用正则表达式？

```
'100: asds'.replace(/^(\d+):.+$/, '$1'); // 100 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-13T13:34:04.143

你可以得到'：'的位置，然后做 string.substring(0, position)

```
var str="1000: this is a string";
var number = str.substring(0,str.search(':')); // 1000 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-13T13:39:29.413

尝试

```
// limit split to 1 to avoid unnecessary splits
var num = "1000: rest of string".split(":", 1)[0]; 
```

我在 jsPerf 上对这里给出的方法进行了一些测试，结果[在这里](http://jsperf.com/split-string)

检索所需数字的最快方法是

```
"1000: rest of string".substring(0, str.indexOf(":")); 
```

如果速度很重要，那么正确的答案应该交给用户编码器。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-11-14T06:45:36.423

也许正则表达式对您来说是一个更好的选择，但是如果您需要使用上面建议的解决方案，您可以执行以下操作来摆脱“{”

```
if(str.contains("{"))
{
     str.replace("{", "");
} 
```

# python - 从 Paster 模板测试/打包 python 应用程序

> ID：13361584
> 
> 赞同：0
> 
> 时间：2012-11-13T13:30:36.710
> 
> 标签：python, testing, packaging, software-packaging

使用[Modern-Package](http://pypi.python.org/pypi/modern-package-template)模板，我可以看到如何构建“库”或其他应用程序导入的模块，但不清楚的是如何构建脚本以供控制台使用？

如果我按照我理解的说明进行操作，我会在`<pkgname>/src/<pkgname>/`目录中进行开发，弹出树，`python setup.py build`.

但是，这只是创建了相同样式的源代码树，例如`build/lib<whatever>/<pkgname>/__init__py`.

我很可能根本无法正确理解这一点，但是测试和打包您最终应该能够直接执行的应用程序的“正确”方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:34:38.757

对于任何想知道的人；我的解决方案是使用`python setup.py develop --user`并添加`~/.local/bin`到您的路径中。答对了。

# iphone - UIWebView 在方向改变时改变图像

> ID：13361586
> 
> 赞同：0
> 
> 时间：2012-11-13T13:30:42.097
> 
> 标签：iphone, objective-c, uiwebview, orientation-changes

我希望我的 uiwebview 在方向更改时更改 gif 图像，所以最初我使用以下代码加载第一个图像：

```
NSString * url = @"gif image url...";
int width = width of image;
int height = height of image;

NSString * htmlCode = [NSString stringWithFormat:@"<html><head><body leftmargin=\"0\" topmargin=\"0\"><img id=\"gifimg\" src=\"%@\" width=\"%i\" height=\"%i\"></body></html>", url, width,height];
[tmpWebView loadHTMLString:htmlCode baseURL:nil]; 
```

我将以下代码放入orientationChanged函数中：

```
NSString url = @"portrait image url...";
int width = width of portrait image;
int height = height of portrait image;

if (deviceOrientation == UIInterfaceOrientationLandscapeLeft) {
    url = @"landscape image url...";
    width = width of landscape image;
    height = height of landscape image;
}

NSString * jsString = [[NSString alloc] initWithFormat:@"document.getElementsByTagName('img')[0].style.width= '%dpx';document.getElementsByTagName('img')[0].style.height= '%dpx';document.getElementsByTagName('img')[0].src= '%@'", width,height, url];

[webview stringByEvaluatingJavaScriptFromString:jsString];
[jsString release];
[webview setBackgroundColor:[UIColor clearColor]];
[webview setOpaque:NO]; 
```

所以图像在第一次显示时工作正常，当我旋转设备时，（横向或纵向）图像出现但其中一部分被截断。（每次旋转后，图像的一部分被忽略.....），任何主意？

感谢帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:32:55.067

这都是关于定位问题的，我想是的。在这里你应该做类似的事情

1）每当方向变化得到那个点并识别方向假设你有肖像然后调用你的方法来为肖像模式设置新图像，反之亦然。

这是我的逻辑，请仔细查看。

**每当方向改变时调用下面的方法。在这里，您只需要按照您的要求允许改变方向，您还需要为横向设置图像。**

```
 - (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    if(toInterfaceOrientation ==UIInterfaceOrientationPortrait||toInterfaceOrientation==UIInterfaceOrientationMaskPortraitUpsideDown);
   {
      [self setImagesForPortraitView];
   }
 else
    {
      [self setImagesForLandscapeView];
   }

   //setImagesForPortraitView and setImagesForLandscapeView would be your custom method which setUP the Images for different orientation
 //So here as Orientation chnages you can easily set the new image to Webview as you said. 
```

}

注意：在这里，我只是为您当前的 REq 发布此答案，我不知道您如何管理方向......

我希望它可以帮助你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:41:53.047

那是因为当您按照 xib 文件中的指示加载 nib 文件时，uiimageview 很可能放在最后，所以我想您需要修改帧坐标以显示谁图像。如果您想测试这个理论，请尝试在图像末尾的 xib 文件中放入一个按钮并运行应用程序并旋转设备以显示在 lanscape 中，如果我的理论是正确的，则按钮不会显示。我希望这有帮助！祝你好运！

# xcode - 从 xcode 4.3.2 升级到 4.5.2 时出现错误

> ID：13361588
> 
> 赞同：4
> 
> 时间：2012-11-13T13:30:44.773
> 
> 标签：xcode

我有 Mac OS X v10.7.5 Lion。我正在尝试安装 Ruby 1.9.3。在做的过程中，我刚刚下载了xcode 4.5.2来替换4.3.2。但是当我这样做时，我收到以下错误。我该如何解决这个问题？

提前致谢。

```
The operation can’t be completed because some items had to be skipped. For each item, 
choose File > Get Info, make sure “Locked” is deselected, and then check the Sharing & 
Permissions section. When you are sure the items are unlocked and not designated as 
Read Only or No Access, try again. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T23:20:32.327

我发现我首先需要删除旧的并在应用程序中放置新的。

# charts - JavaFx 2.x：绘制后如何修改线条？

> ID：13361590
> 
> 赞同：1
> 
> 时间：2012-11-13T13:30:49.150
> 
> 标签：charts, line, javafx-2

此代码绘制一个 XY 线图并（感谢 Bhupendra 的代码）通过鼠标左键单击在图表上绘制线条，如果鼠标悬停，选中的线条变为红色，可以删除或移动。

```
import javafx.application.Application;
import javafx.event.EventHandler;
import javafx.scene.Group;
import javafx.scene.Scene;
import javafx.scene.chart.CategoryAxis;
import javafx.scene.chart.LineChart;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.XYChart;
import javafx.scene.control.Label;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.Pane;
import javafx.scene.paint.Color;
import javafx.scene.shape.Line;
import javafx.scene.shape.LineTo;
import javafx.scene.shape.MoveTo;
import javafx.scene.shape.Path;
import javafx.stage.Stage;

public class LinesEdit extends Application {

Path path;

public static void main(String[] args) {
    launch(args);
}

@Override
public void start(Stage stage) {

    final CategoryAxis xAxis = new CategoryAxis();
    final NumberAxis yAxis = new NumberAxis(1, 21, 0.1);
    yAxis.setTickUnit(1);
    yAxis.setPrefWidth(35);
    yAxis.setMinorTickCount(10);
    yAxis.setTickLabelFormatter(new NumberAxis.DefaultFormatter(yAxis) {
        @Override
        public String toString(Number object) {
            String label;
            label = String.format("%7.2f", object.floatValue());
            return label;
        }
    });
    final LineChart<String, Number> lineChart = new LineChart<String, Number>(xAxis, yAxis);

    lineChart.setCreateSymbols(false);
    lineChart.setAlternativeRowFillVisible(false);
    lineChart.setLegendVisible(false);

    XYChart.Series series1 = new XYChart.Series();

    series1.getData().add(new XYChart.Data("Jan", 1));
    series1.getData().add(new XYChart.Data("Feb", 4));
    series1.getData().add(new XYChart.Data("Mar", 2.5));
    series1.getData().add(new XYChart.Data("Apr", 5));
    series1.getData().add(new XYChart.Data("May", 6));
    series1.getData().add(new XYChart.Data("Jun", 8));
    series1.getData().add(new XYChart.Data("Jul", 12));
    series1.getData().add(new XYChart.Data("Aug", 8));
    series1.getData().add(new XYChart.Data("Sep", 11));
    series1.getData().add(new XYChart.Data("Oct", 13));
    series1.getData().add(new XYChart.Data("Nov", 10));
    series1.getData().add(new XYChart.Data("Dec", 20));

    BorderPane bp = new BorderPane();
    bp.setCenter(lineChart);
    Scene scene = new Scene(bp, 800, 600);
    lineChart.setAnimated(false);
    lineChart.getData().addAll(series1);

    LinesEdit.MouseHandler mh = new LinesEdit.MouseHandler( bp );
    bp.setOnMouseClicked( mh );
    bp.setOnMouseMoved( mh );

    stage.setScene(scene);

    path = new Path();
    path.setStrokeWidth(1);
    path.setStroke(Color.BLACK);

    scene.setOnMouseDragged(mh);
    scene.setOnMousePressed(mh);
    bp.getChildren().add(path);
    stage.setScene(scene);
    stage.show();
}    

class MouseHandler implements EventHandler< MouseEvent > {
private boolean gotFirst    = false;
private Line    line;
private Pane    pane;
private double  x1, y1, x2, y2;
private LineHandler lineHandler;

public MouseHandler( Pane pane ) {
    this.pane = pane;
    lineHandler = new LineHandler(pane);
}

class LineHandler implements EventHandler< MouseEvent > {
double  x, y;
Pane pane;

public LineHandler(Pane pane){
    this.pane = pane;
}
@Override
public void handle( MouseEvent e ) {
    Line l = (Line) e.getSource();

    // remove line on right click
    if( e.getEventType() == MouseEvent.MOUSE_PRESSED
            && e.isSecondaryButtonDown() ) {
        pane.getChildren().remove( l );
    } else if( e.getEventType() == MouseEvent.MOUSE_DRAGGED
            && e.isPrimaryButtonDown() ) {
        double tx = e.getX();
        double ty = e.getY();
        double dx = tx - x;
        double dy = ty - y;
        l.setStartX( l.getStartX() + dx );
        l.setStartY( l.getStartY() + dy );
        l.setEndX( l.getEndX() + dx );
        l.setEndY( l.getEndY() + dy );
        x = tx;
        y = ty;
    } else if( e.getEventType() == MouseEvent.MOUSE_ENTERED ) {
        // just to show that the line is selected
        x = e.getX();
        y = e.getY();
        l.setStroke( Color.RED );
    } else if( e.getEventType() == MouseEvent.MOUSE_EXITED ) {
        l.setStroke( Color.BLACK );
    }
    // should not pass event to the parent
    e.consume();
}
}   
@Override
public void handle( MouseEvent event ) {
    if( event.getEventType() == MouseEvent.MOUSE_CLICKED ) {
        if( !gotFirst ) {
            x1 = x2 = event.getX();
            y1 = y2 = event.getY();
            line = new Line( x1, y1, x2, y2 );

            pane.getChildren().add( line );

            gotFirst = true;
        } 
        else {
            line.setOnMouseEntered( lineHandler );
            line.setOnMouseExited( lineHandler );
            line.setOnMouseDragged( lineHandler );
            line.setOnMousePressed( lineHandler );
            // to consume the event
            line.setOnMouseClicked( lineHandler );
            line.setOnMouseReleased( lineHandler );
            line = null;
            gotFirst = false;
        }
    } 
        else {
            if( line != null ) {
                x2 = event.getX();
                y2 = event.getY();
                // update line
                line.setEndX( x2 );
                line.setEndY( y2 );
        }
     }
  }
 }
} 
```

我现在想做的是通过选择终点或尾点之一（图中的 A 和 B）来更改线长或斜率并设置新的终点 x,y 点

![在此处输入图像描述](../Images/f3029fc9cce710ef62531161eee9343e.png)

如何做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T15:28:26.503

使用以下类而不是`Line`...

```
public class EditLine extends Parent {
    private static final double radius  = 5;
    private Line                line;
    private Circle              c1, c2;

    private class MouseHandler implements EventHandler< MouseEvent > {
        private boolean isfirst;

        public MouseHandler( boolean first ) {
            isfirst = first;
        }

        public void handle( MouseEvent event ) {
            if( event.getEventType() == MouseEvent.MOUSE_ENTERED ) {
                if( isfirst )
                    c1.setOpacity( 1 );
                else c2.setOpacity( 1 );
            } else if( event.getEventType() == MouseEvent.MOUSE_EXITED ) {
                if( isfirst )
                    c1.setOpacity( 0 );
                else c2.setOpacity( 0 );
            } else if( event.getEventType() == MouseEvent.MOUSE_DRAGGED ) {
                double x = event.getSceneX();
                double y = event.getSceneY();
                if( isfirst ) {
                    line.setStartX( x );
                    line.setStartY( y );
                    c1.setCenterX( x );
                    c1.setCenterY( y );
                } else {
                    line.setEndX( x );
                    line.setEndY( y );
                    c2.setCenterX( x );
                    c2.setCenterY( y );
                }
            }
        }
    }

    public EditLine( double x1, double y1, double x2, double y2 ) {
        line = new Line( x1, y1, x2, y2 );
        line.setMouseTransparent( true );

        c1 = new Circle( x1, y1, radius, Color.RED );
        c1.setOpacity( 0 );
        MouseHandler mh1 = new MouseHandler( true );
        c1.setOnMouseEntered( mh1 );
        c1.setOnMouseExited( mh1 );
        c1.setOnMouseDragged( mh1 );
        c2 = new Circle( x2, y2, radius, Color.RED );
        c2.setOpacity( 0 );
        MouseHandler mh2 = new MouseHandler( false );
        c2.setOnMouseEntered( mh2 );
        c2.setOnMouseExited( mh2 );
        c2.setOnMouseDragged( mh2 );

        getChildren().addAll( c1, c2, line );
    }
} 
```

# javascript - Typescript 会帮助我决定调用哪个函数吗？

> ID：13361595
> 
> 赞同：0
> 
> 时间：2012-11-13T13:31:09.490
> 
> 标签：javascript, typescript

我有以下目录结构：

```
/Admin/Grid
   abc.ts  // this file contains the one function abc()
   xxx.ts  // this file contains the one function xxx()

/Admin/Dialog
   abc.ts  // this file contains the one function abc() 
```

我将所有三个 javascript 都加载到我的浏览器中。

函数 xxx() 如下所示：

```
function xxx() {
   // do abc
   abc();
} 
```

有没有一种使用打字稿的方法，我可以告诉函数 xxx 执行 /Admin/Dialog 目录中文件内的函数 abc？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:38:24.070

如果您引用所有这些文件并且您的函数都在全局范围内（看起来它们来自您的问题），那么您可以从任何地方调用这些函数。

您可能想要研究的 TypeScript 的一个好处是使用模块和类来封装函数和数据组，这有助于您组织程序并保持全局范围不受您自己的函数和变量的影响。

所以回到你的问题，如果你想要两个同名的函数，你不能把它们都放在同一个范围内——你需要：

*   重命名一个
*   将它们包含在类/模块中
*   仅包含包含 abc 函数的文件之一

这是基于您的问题的示例。

```
class OtherClass {
    abc () {

    }
}

class MyClass {
    xxx () {
        var oc = new OtherClass();
        oc.abc();
    }
}

var mc = new MyClass();

mc.xxx(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:40:08.507

我会用 JavaScript 回答你：

基本上没有办法告诉 xxx() 执行 /Admin/Dialog/abc.ts 中的 abc()。这是因为当 /Admin/Dialog/abc.ts 被加载时，它会覆盖 /Admin/Grid/abc.ts 的 abc()。

你可以做的是这样的：

/Admin/Grid/abc.ts

```
var grid = {
    abc: function() {
        ....
    }
} 
```

/Admin/Dialog/abc.ts

```
var dialog= {
    abc: function() {
        ....
    }
} 
```

然后在 xxx() 中：

```
function xxx() {
   grid.abc();
} 
```

这样对话框的 abc() 将不会覆盖网格的 abc()。

**编辑：在 TypeScript 中：**
/Admin/Grid/abc.ts

```
class Grid {
    abc() {
    }
} 
```

/Admin/Dialog/abc.ts

```
class Dialog {
    abc() {
    }
} 
```

然后在 xxx.ts 中：

```
class Samantha {
    xxx () {
        var grid = new Grid ();
        grid.abc();
    }
}

var me = new Samantha ();
me .xxx(); 
```

希望这可以帮助！

# php - 每个提交的条目中的自动增量 ID = 0

> ID：13361597
> 
> 赞同：0
> 
> 时间：2012-11-13T13:31:10.873
> 
> 标签：php

现在我正在使用 mysql 数据库表。我创建了一个输入数据的表单。正在输入数据的四个字段是`Class Caption` `Class Name` `Class Description` `Credit Hours`。我已经设置了一个自动增量`id`，但是每次我保存一个类时，我都会得到一个`id`等于`0`，并且对于类标题，我会在`.`前面显示一个句点。我不确定为什么每次将信息提交到数据库时都会出现此问题。

**PHP**

```
<h1>class</h1>

<?php
    include ('Resources/db_connect.php');
    $query="SELECT * FROM class";
    $result=mysql_query($query, $db_link);
if ($result){
    $num=mysql_num_rows($result);
    mysql_close();
?>

<table border="0" cellspacing="2" cellpadding="2">
<tr>
<td><h3>id</h3></td>
<td><h3>class_caption</h3></td>
<td><h3>class_name</h3></td>
<td><h3>class_description</h3></td>
<td><h3>class_credit_hours</h3></td>
</tr>

<?php
$i=0;
while ($i < $num) {

$f1=mysql_result($result,$i,"id");
$f2=mysql_result($result,$i,"class_caption");
$f3=mysql_result($result,$i,"class_name");
$f4=mysql_result($result,$i,"class_description");
$f5=mysql_result($result,$i,"class_credit_hours");
?>

<tr>
<td><?php echo $f1; ?></td>    
<td><?php echo $f2; ?></td>    
<td><?php echo $f3; ?></td>    
<td><?php echo $f4; ?></td>    
<td><?php echo $f5; ?></td>    
</tr>

<?php
$i++;

}
}
else{
    echo "No Results Found";
    mysql_close($db_link);
}
?> 
```

**插入表格**

```
<form action="" method="post">
<table>
<tr>
    <td>Class Caption: <td><input type="text" name="class_caption" size="8"><br>
</tr>
<tr>
    <td>Class Name: <td><input type="text" name="class_name" size="30"><br>
</tr>
<tr>
    <td>Class Description: <td><textarea rows="5" name="class_description" cols="50"></textarea><br>
</tr>
<tr>
    <td>Credit Hours: <td><input type="text" name="class_credit_hours" size="1">
</tr>
<tr>
    <td><input type="submit" value="Submit">
</tr>
</table>
</form> 
```

**表设计**：[链接](http://webprolearner.ueuo.com/class_des/table_structure.php)

**询问**

```
CREATE TABLE class
(
    id INT,
    class_caption VARCHAR(30),
    class_name VARCHAR(30),
    class_description VARCHAR(300),
    class_credit_hours INT,
    CONSTRAINT cc_pk PRIMARY KEY (id),
    CONSTRAINT cc_uq UNIQUE (class_caption)
); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:39:05.893

自动增量在哪里定义？不应该有类似的东西：

```
CREATE TABLE class
(
id int(11) NOT NULL AUTO_INCREMENT,... 
```

# javascript - 同一页面上的两个 jQuery File Upload 小部件

> ID：13361598
> 
> 赞同：1
> 
> 时间：2012-11-13T13:31:11.543
> 
> 标签：javascript, jquery, jquery-plugins, file-upload

我正在使用 jquery jQuery File Upload 插件（blueimp.github.com/jQuery-File-Upload）来上传图像，但我想添加另一个文件上传小部件来下载其他文件。是否可以在同一页面上有两个小部件？

谢谢

# c++ - 无法为不同线程中的父级创建子级（Qt）

> ID：13361599
> 
> 赞同：1
> 
> 时间：2012-11-13T13:31:20.177
> 
> 标签：c++, mysql, qt

我目前在 Qt 中遇到一个奇怪的问题。我有一个使用 QTcpSocket 处理多个客户端的应用程序。客户端向服务器提供登录详细信息，服务器正在检查 MySQL 数据库以验证单独线程上的凭据。

我有 2 个不同的客户端程序登录到该服务器 1\. 一个使用 Qt 连接到那里的简单客户端 2\. 一个用 C-Sharp (.net) 编码的客户端

然而

当第二个客户端尝试登录服务器时，我在服务器上收到一条错误消息，告诉我：

**QObject：无法为不同线程中的父级创建子级。Parent是QNativeSocketEngine(0x1231e00)，parent的线程是QThread(0xc625f0)，当前线程是CMySQLHandler(0xc67188)**

我猜这发生在 MySQL 处理程序线程上但奇怪的是，它根本没有发生在用 Qt 编码的客户端上

这是代码：

```
void CMySQLHandler::onAuthRequest(ulong clientID, QString email, QString psw, QString HWID, QString ip)
{

    string pass = "", salt = "", name = "", avatar = "";
    uint UserID = 0;
    CUserData *extra = new CUserData();
    bool success = false;
    QString failReason = "Success";

    string Query = "SELECT password, username, avatar, userid FROM jos_users LEFT JOIN jos_community_users ON jos_users.id = jos_community_users.userid WHERE email = '"+email.toStdString()+"'";
    SQLRow Row = GetRow(Query);

    if(!Row.empty())
    {
        QString hashedPass = QString(Row[0].c_str());
        pass = hashedPass.split(':').at(0).toStdString();
        salt = hashedPass.split(':').at(1).toStdString();

        name = Row[1];
        avatar = Row[2];
        UserID = QString(Row[3].c_str()).toUInt();
        QByteArray data;
        data.append((psw + QString(salt.c_str())));
        QString blah = QString(QCryptographicHash::hash(data,QCryptographicHash::Md5).toHex());
        if(QString(pass.c_str()) == blah )
            success = true;
        else
            failReason = "Invalid password";

    }
    else
    {
        failReason = "E-Mail not found";
        emit Handle->onAuthCompleted(clientID, false, failReason, extra);
        return;
    }

    extra->Avatar += avatar.c_str();
    extra->UserID = UserID;

    extra->Username = QString(name.c_str());

    emit Handle->onAuthCompleted(clientID, true, QString(), extra);
} 
```

这是信号定义

```
void CMySQLHandler :: onTimerInit()
{

    //Authentication
    connect(this, SIGNAL(doAuthCompleted(ulong,bool,QString,CUserData*)), Handle, SLOT(onAuthCompleted(ulong,bool,QString,CUserData*)));
    connect(Handle, SIGNAL(doRequestAuth(ulong,QString,QString,QString,QString)), this, SLOT(onAuthRequest(ulong,QString,QString,QString,QString)));
    //end

    CMySQL::Init(Handle);
} 
```

我是 Qt 框架的新手。请原谅缺乏知识。

感谢您花时间阅读本文。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:05:10.183

当您使用多线程时，这种不同线程的问题在 Qt 中总是会发生。解决这个问题的典型方法是使用信号和槽。

该错误不会发生在 中`onAuthRequest`，它可能更早，您尝试调用此函数。也许您正在`CMySQLHandler`一个线程中创建一个对象，并尝试在另一个线程中执行它的成员函数。

如果您出于某种原因需要调用属于不同威胁`slot`的对象的函数，请在包装该函数的对象中创建 a 并使用`emit`.

请参阅类似的问题[QObject: Cannot create children for a parent that is in a different thread](https://stackoverflow.com/questions/3268073)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:43:20.480

Qt 使用线程拥有对象的概念。线程自己的对象来做信号/槽机制。问题是您试图在线程 CMySQLHandler(0xc67188) 中创建一个新对象并将其分配给父 QNativeSocketEngine(0x1231e00)。但是 QNativeSocketEngine 归 QThread(0xc625f0) 所有，这是不允许的。我在您的代码中看不到错误，因此您可能需要进行更多调试以找到导致错误的行并编辑您的问题。

# jquery - 如何在 UpdatePanel onClick 事件中使用 jquery 隐藏 div？

> ID：13361602
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:31:20.057
> 
> 标签：jquery, asp.net

这就是我尝试这样做的方式：

```
 $(document).ready(function () {

    $("#ButtonId").click(function () {

        $('#DivID').hide();

    });

}); 
```

这对我不起作用。任何的意见都将会有帮助。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:33:20.193

最可能的原因：

*   非唯一 ID（文档中只有一个元素可以具有给定 ID，如果不能使其唯一，请使用类）
*   动态创建的按钮（使用`$(document.body).on('click', "#ButtonId", function () {`）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:17:40.497

具有 runat="server" 的控件在呈现页面时更改其 ID（有解决此问题的方法，但它不是默认功能）。如果确保 ID 唯一的初始答案对您不起作用，请确保您引用了正确的 ID。您可以通过 YourElementID.ClientID 获取呈现的 ID：

```
<script type="text/javascript">
     $(document).ready(function () {
         $('#<%= ButtonId.ClientID %>').click(function () { 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T16:19:48.410

谢谢你们的帮助。

我想与您分享我是如何设法操纵 UpdatePanel 中的 div 的。这是我为解决问题所做的工作：

```
 function pageLoad() {
     $(function () {

            if(Sys.WebForms.PageRequestManager.getInstance().get_isInAsyncPostBack()) {

                  $('.DivClass').hide();
            }  
     });
 } 
```

使用函数 pageLoad() 和 get_isInAsyncPostBack() 我可以跟踪 UpdatePanel 的部分更新，这样我可以在发生时隐藏我的 div。

# php - 带有 php 脚本内容的 DOMPDF

> ID：13361604
> 
> 赞同：1
> 
> 时间：2012-11-13T13:31:32.040
> 
> 标签：php

我需要使用 dom pdf 和 php 生成 pdf。我试过这个，但我得到错误 500，我没有语法错误。如果我尝试：`$html='Title here'`它有效。我尝试使用外部 php 脚本并使用`file_get_contents()`函数，但它没有用。任何人都可以帮助我找到使用 php 脚本生成 pdf 的解决方案吗？

这是我的脚本（dompdf/index.php）：

```
<?php

include("dompdf_config.inc.php");
include "../config.php";
include("../db/mysql.php");

$pers=$db->sql_fetchrow($db->sql_query('//-----query here--------'));
$inv=$db->sql_fetchrow($db->sql_query('//-----query here--------'));
$cli=$db->sql_fetchrow($db->sql_query('//-----query here--------'));
$proj=$db->sql_fetchrow($db->sql_query('//-----query here--------'));

$total=$db->sql_query('//-----query here--------');

$ret.=
  '
<html>
<head>

</head>

<body>

<div id="left" style="float:left; margin:0 auto;width400px;">
<strong><h2></h2></strong>

</div>

<div id="left" style="float:left; margin:0 auto;  width:300px; ">
<h2 style="">INVOICE</h2>
<table style="border-style : solid;
border-width:2 px;
border-color : black; width:300px; ">
<tr style="border-bottom: 2px solid black !important;"><th style="border-bottom: 2px solid black !important;">Invoice Date</th><th style="border-bottom: 2px solid black !important;">Invoice No.</th></tr>
<tr><td align="center">'.$inv["date_due"].'</td><td align="center">'.$inv["invoice_no"].'</td></tr>
</table>

</div>
<br />
<div  style="float:left; margin:0 auto;width:100%;margin-top:50px; width=300px;">

<table style="border-style : solid; border-width:2 px; border-color : black; width=400px;">
<tr border="1"><th style="border-bottom: 2px solid black !important;" width="400">INVOICE TO:'.$pers['name'].'</th></tr>
<tr><td width="400">
    '.$cli["name"].'<br />
   '.$cli["street"].'<br />
    '.$cli["city"].'<br /><br />
'.$cli["country"].'<br />
</td></tr>
</table>
</div>
<br />
<div style="float:left; width:600; margin-top:50px;margin-bottom:50px;">

<table style="border-style : solid; border-width:2 px; border-color : black; width=600px;">
<tr width=800px; border="2" style="bordder-bottom: #000 solid;"><th colspan="2" style="border-bottom: 2px solid black !important;width:600px;">INVOICE DESCRIPTION</th></tr>

<tr ><td align="right" width="300"><strong>Project name:</strong></td>
<td>'.$proj["name"].'</td></tr>

<tr><td align="right" width="300"><strong>Job number:</strong></td>
<td width="300">'.$proj["job_no"].'</td></tr>

<tr><td align="right" width="300"><strong>Job reference:</strong></td>
<td width="300"> '.$proj["job_reference"].'</td></tr>

<tr><td align="right" width="300"><strong>Source Language:</strong></td>
<td width="300">'.$proj["source_lang"].'</td></tr>

<tr><td align="right" width="300"><strong>Target Language:</strong></td>
<td width="300">'.$proj["targ_lang"].'</td></tr>

<tr><td align="right" width="300"><strong>Deadline:</strong></td>
<td width="300">'.$proj["deadline"].'</td></tr>

</table>
</div>
<br />
<br />
<div style="margin-top:50px;width:600px;">

<table style="border-style : solid; border-width:2 px; border-color : black; width:600px;">
<tr border="1" style="border-bottom: black solid"><th style="border-bottom: 2px solid black !important;">Task description</th><th  style="border-bottom: 2px solid black !important;">Unit</th><th style="border-bottom: 2px solid black !important;">Qty</th><th  style="border-bottom: 2px solid black !important;">Fee Unit</th><th style="border-bottom: 2px solid black !important;">Amount</th></tr>';
  $ret1="";
 $sum=0;
while($r=$db->sql_fetchrow($total)){

    $task_type=$db->sql_fetchrow($db->sql_query('//-----query here--------'));
$quote_type=$db->sql_fetchrow($db->sql_query('//-----query here--------')); 
$unit=$db->sql_fetchrow($db->sql_query('//-----query here--------'));
 $t_lang=$db->sql_fetchrow($db->sql_query('//-----query here--------')); 
 $s_lang=$db->sql_fetchrow($db->sql_query('//-----query here--------'));
 $price=$db->sql_fetchrow($db->sql_query('//-----query here--------'));
 $amount=$price["unit_fee"]*$r["unit_qty"];
 $sum+=$amount;
$ret.='   
<tr style="alignment-adjust: central;"><td>'.$task_type["task"].'&nbsp;&nbsp;&nbsp; '.$quote_type["client_quote"].'</td><td>'.$unit["name"].'</td><td>'.$r["unit_qty"].'</td><td>'.$price["unit_fee"].'</td><td align="right">'.$amount.' '.$r["currency"].'</td></tr>
 ';
 $curr=$r["currency"];

$ret.= '<tr ><td colspan="4" align="right">Subtotal</td><td colspan="4" align="right">'.$sum.' '.$curr.'</td></tr>
<tr ><td colspan="4" align="right">100% due on'.$r["date_due"].'</td><td colspan="4" align="right">'.$sum.' '.$curr.'</td></tr>
<tr ><td colspan="4" align="right">VAT 0%</td><td colspan="4" align="right">0,0 '.$curr.'</td></tr>
<tr ><td colspan="4" align="right"><strong>TOTAL</strong></td><td colspan="4" align="right"><strong>'.$sum.' '.$curr.'</strong></td></tr>
</tr>
</table>
</div>
<br />
  </table><br />
  </div>

  </body>
  </html>';

  $dompdf = new DOMPDF();
  $dompdf->load_html($ret);
  $dompdf->render();
  $dompdf->stream("Invoice.pdf");
  ?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:38:28.857

您的`content()`函数与文本相呼应。它将它推送到屏幕上，而您想在 $html 中捕获它。改用 return 。

**更新**

为了将所有查询结果捕获到一个返回值，您可以将它们附加到一个变量，如下所示：

```
function content() {
// Define the output variable
$output = "";

//Run query
$pers=$db->sql_fetchrow($db->sql_query('select * from clients_persons where person_id='.$_GET["ps"].''));

//Combine query results and html
$output .= $pers['name'];
$output .= " <i>";
$output .= $pers['email'];
$output .= " </i>";

return $output;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:50:49.750

检查内存限制是否存在此类问题。

# c# - 使用 JSONP 和 JQuery 调用 REST Api

> ID：13361605
> 
> 赞同：2
> 
> 时间：2012-11-13T13:31:32.563
> 
> 标签：c#, asp.net-mvc, jsonp

我在 MVC4 中创建了 REST API，当我编写来自提琴手的请求时它工作正常。但是在我的应用程序中，我需要通过 jsonp 调用，因为它会跨域请求。但是当我调用这个服务时，它给了我如下所示的错误：

Jquery JsonP 调用..

```
$.ajax({
        type: "POST" ,
        url: "http://127.0.0.1:81/api/sites/GetDomainAvailability?apikey=asfasfdsf&callback=?",
        data: { SubDomain: subDomain, ParentDomain: parentDomain, ResellerId: resellerId },
        cache: false,
        contentType: "application/json; charset=utf-8",
        success: function (response) {
            if (callback)
                callback(response.d);
        },
        error: function (response) {
            if (callback)
                error(response.d);
        },
    }); 
```

错误： ![在此处输入图像描述](../Images/1ec3368621664170c732cd0514effad8.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T15:58:56.743

现在你没有做 JSONP。它仍然是 POST 请求。要使其成为 JSONP，您只需添加`dataType: "jsonp"`到您的`$.ajax()`调用中。您还可以删除一些其他冗余参数，如内容类型和“回调”参数（但这是可选的）。因此，您的代码应如下所示：

```
$.ajax({
    url: "http://127.0.0.1:81/api/sites/GetDomainAvailability?apikey=asfasfdsf",
    data: { SubDomain: subDomain, ParentDomain: parentDomain, ResellerId: resellerId },
    datatype: "jsonp",
    cache: false,
    success: function (response) { /* ... */ },
    error: function (response) { /* ... */ },
}); 
```

也准备好，您的请求将被转换为 GET 请求，看起来像 `/GetDomainAvailability?apikey=key&callback=jquery123&SubDomain=sss&ParentDomain=ppp&ResellerId=123&_=4398572349857`

因此，为此准备您的服务器端代码。

# c++ - 在 Xtext 语法/DSL 中引用 C++ 类型

> ID：13361606
> 
> 赞同：2
> 
> 时间：2012-11-13T13:31:33.227
> 
> 标签：c++, eclipse-cdt, xtext

我花了几天时间试图想出一个在 Xtext DSL 中引用 C++ 类型的解决方案。至此，我已经非常熟悉用于引用 Java/JVM 类型的 Xtext/Eclipse 机制了。

大概要执行类似于 JVM 导入机制的操作，我必须将现有的（可能相当大的）CDT 索引保存为 Ecore，并将该 Ecore 导入我的 Xtext Grammar。

我正在考虑的另一种选择是对现有 CDT 索引的一些编程挂钩。似乎这个选项可能更难，因为它可能涉及更多的自定义代码来实现。

有没有人在 Xtext 语法/DSL 中发现并成功实现了 C++ 类型的引用？有什么例子吗？对更好的解决方案有什么建议吗？就此而言，我提出的任何一个解决方案似乎都是合理/可行的吗？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-11-16T23:18:04.820

要真正能够在 Xtext DSL 中引用 C++ 或任何非 Xtext 元素，您必须将可引用元素带入 Xtext 的索引中。

正确的做法是拥有一个包含 CDT 索引的 IAllContainerState，并为每个 C++ 文件创建一个 IResourceDescription。CDT 索引应包含有关所包含资源、类型和名称的信息，这可以映射到范围章节中描述的概念：[https ://eclipse.org/Xtext/documentation/303_runtime_concepts.html#scoping](https://eclipse.org/Xtext/documentation/303_runtime_concepts.html#scoping)

GenericResourceServiceProvider 可用于 C++ 资源的 IResourceServiceProvider。

查看 org.eclipse.xtext.resource.generic 包以及它如何用于索引 .ecore 模型。

# matlab - 从工作区基地清除

> ID：13361609
> 
> 赞同：1
> 
> 时间：2012-11-13T13:31:44.243
> 
> 标签：matlab

我有 toto.m + model.mdl 来自函数 toto.m ，我打开模型在关闭模型后在工作区中加载变量我想清除工作区中加载的变量有没有办法在不使用全部清除的情况下做到这一点？

```
function toto

model = 'model1';
open_system(model1);
close_system(model1);
end 
```

当我运行该函数时，工作区没有被清除，我怎么能清除模型只使用的变量而不使用全部清除？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:39:15.307

您可以使用`clear`后跟变量列表，例如`clear a b c`. 但是，我不知道是否有一种方法可以清除给定脚本中声明的所有变量，尽管您始终可以使用函数，因此函数范围内的所有变量都会在函数结束时被清除。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:57:40.483

如果要清除除运行脚本之前已经存在的变量之外的所有变量，可以临时存储这些已经存在的变量名称，然后使用以下命令运行 clear：

```
already_existing_vars = who;

% your actual script ...
% ...

% clear variables created in this script
vars_to_clear = setdiff(who,already_existing_vars);
clear(vars_to_clear{:},'vars_to_clear') 
```

# android - 使用 Android v4 兼容库时出现“包不存在”错误

> ID：13361613
> 
> 赞同：1
> 
> 时间：2012-11-13T13:32:01.370
> 
> 标签：android, xamarin.android

我在 Visual Studio 2010 中使用 MonoDroid 4.2，并尝试使用 Android v4 兼容库中的 ViewPager、Fragments 和其他东西。

我能够添加项目引用，`Mono.Android.Support.v4.dll`并且在设计时我没有收到任何错误，并且智能感知工作正常。

但是当我构建时，我会收到这样的错误：

> 包 android.support.v4.view.ViewPager 不存在 android.support.v4.view.ViewPager.OnPageChangeListener

如果我双击错误，它会打开 MonoDroid 动态创建的源 java 文件，并转到有问题的行：

```
public class ViewPagerTestActivity_MyPagerAdapter
  extends android.support.v4.view.PagerAdapter 
```

所以看起来Java找不到库包，但我不知道为什么。我是否需要手动安装它，以及如何告诉 MonoDroid 在哪里可以找到它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T16:06:18.130

经过一番研究，我了解到我需要实际**安装**支持库。MonoDroid 有它的 .NET 绑定，但是如果没有它，底层的 java 就无法构建，当然。以下是[获取支持库的](http://developer.android.com/tools/extras/support-library.html)说明[以及将其连接到 MonoDroid 项目的说明](http://docs.xamarin.com/Android/Guides/Platform_Features/Fragments/Fragments_Walkthrough/Part_2_-_Supporting_pre-Honeycomb_Android_using_Support_Packages)。

# c# - 尽管 ReadLine() 程序关闭

> ID：13361615
> 
> 赞同：1
> 
> 时间：2012-11-13T13:32:09.030
> 
> 标签：c#, readline, quit

我遇到了一个奇怪的问题。我创建了一个对象（在该对象内我调用 readline..）然后程序退出，尽管我最后调用了 ReadLine()。

为什么停不下来？如何让它停下来？

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Funkcjonalnosc {

    class MainClass {
        static void Main(string[] args) {
            new MainMenu();         
            Console.ReadLine();
        }
    }
} 
```

* * *

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace Funkcjonalnosc {
   public class MainMenu {
        int selection;
        public MainMenu() {
            showMenu();
            selection = getSelection();
            Console.WriteLine("Wybrano "+ selection);
            switch (selection) {
                case 1: break; //strojenie
                case 2: break; //pobieranie stroju
            }
        }
        void showMenu() {
            String menu = "1\. Nastrój\n2\. Dodaj strój";
            Console.WriteLine(menu);
        }

        int getSelection() {//pobiera wybrana opcje z menu{
            try {
                return Console.Read();
            } catch (Exception e) { Console.WriteLine("Zly wybor"); getSelection(); }
            return -1;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:41:11.853

从 MSDN 上[`Console.Read`](http://msdn.microsoft.com/en-us/library/system.console.read.aspx)：

> 当您键入输入字符时，Read 方法会阻止其返回；当您按下 Enter 键时它会终止

因此，如果我输入，比如说，`1`它不会做任何事情——直到我输入`enter`. 当我这样做时，`Console.Read`返回`1`，但`enter`仍然缓冲。当您使用`Console.ReadLine`时，它会获取此缓冲`enter`，因此会立即退出。您可以通过键入`1``2``3``enter`-`Read`获取`1`- 并`ReadLine`获取剩余的 来查看这一点`2``3`。

为了避免这种缓冲行为，您可能想尝试一下`Console.ReadKey`。

# ruby - Selenium WebDriver Ruby 绑定出现超时错误

> ID：13361616
> 
> 赞同：1
> 
> 时间：2012-11-13T13:32:13.053
> 
> 标签：ruby, selenium-webdriver

当我在我的站点中运行 selenium webdriver ruby​​ bindings 时，有时我会收到**Timeout Error**。

我觉得加载图像浪费了很多时间，如何在不加载图像的情况下启动 selenium，以及任何加快速度的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T17:30:44.643

如果您想停止加载图像，我相信您可以创建自定义 Firefox 配置文件，安装 Adblock 扩展程序，保存配置文件，然后指定您的 Selenium 服务器以使用该保存的配置文件而不是新配置文件启动新的 Firefox 实例. 您必须告诉 Adblock 阻止您网站上的所有图片。

但是，我同意@Arran。如果您的网站加载图像缓慢，您可能应该解决其他问题，例如增加服务器资源、缓存或其他技术来加快加载时间。

您还可以将 Selenium 加载超时从默认的 30 秒增加到 150 秒（2.5 分钟），但我仍然建议尝试以任何一种方式加快页面加载速度。

# html - 3 列、像素和百分比

> ID：13361620
> 
> 赞同：0
> 
> 时间：2012-11-13T13:32:53.587
> 
> 标签：html, css

我想将 2 列粘在两侧，每列都有一个精确的像素宽度（在这种情况下为 30px），它们之间还有另一个 div 填充剩余空间。

```
|-----------100%-----------|
|30px || remaining  ||30px |

+-----++------------++-----+
|     ||            ||     |
|     ||            ||     |
|   1 ||     2      ||  3  |
|     ||            ||     |
+-----++------------++-----+
  |                     |
  |                     -- float:right
  ---- float:left 
```

如何仅使用纯 css 实现这一目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:39:35.883

您的中心 div 可以绝对定位，并且从两侧偏移 30px。

```
.container{
   position:relative;
   width:600px;
   height: 400px;
}
.center{
    position:absolute;
    left:30px;
    right:30px;
    height: 100%;
} 
```

这将确保您的 div 始终占据容器 div 的 100%，但每边留出 30px

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:43:29.003

除了浮动左右 div 之外，你真的不需要做任何事情。你放在中间的任何 div 都会自动填充剩余的空间。

```
<div class="right"></div>
<div class="left"></div>
<div class="center"></div>​

.right{
float:right;
background-color:yellow;
height:50px;
width:30px;
}
.left{
float:left;
background-color:yellow;
height:50px;
width:30px;
}
.center{background-color:green;height:100%;height:50px;} 
```

小提琴：http: [//jsfiddle.net/calder12/55dza/](http://jsfiddle.net/calder12/55dza/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:51:34.980

使用此表

```
<table border="1">
    <tr>
        <td class="fixed">
            left
        </td>
        <td class="remaining">
            middle
        </td>
        <td class="fixed">
            right
        </td>
    </tr>
</table>​ 
```

试试这个 CSS

```
table { width: 100%; }
.fixed { width: 30px; }
.remaining { width: auto; }​ 
```

[jsFiddle](http://jsfiddle.net/5CNMh/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:43:54.967

`#left { background-color: Red; width: 30px; height: 500px; float: left; }`

`#middle { background-color: blue; height: 500px; }`

`#right { background-color: Red; width: 30px; height: 500px; float: right; }`

在 html 中，您放置了左侧 div，然后是右侧，然后是中间 div。

# c++ - 未在此范围内声明

> ID：13361621
> 
> 赞同：1
> 
> 时间：2012-11-13T13:32:54.047
> 
> 标签：c++, header, arduino

将代码上传到 Arduino Atmega2560 时出错。

错误是：

```
herkulex.cpp: In member function 'void herkulex::hklx_SendPacket(DrsPacket)':
herkulex.cpp:121: error: 'USART0_PutNChar' was not declared in this scope
herkulex.cpp: In member function 'unsigned char herkulex::hklx_ucReceivePacket(DrsPacket*)':
herkulex.cpp:211: error: 'USART0_ucGetNChar' was not declared in this scope
herkulex.cpp: In member function 'void herkulex::hklx_RemoveInvalidData()':
herkulex.cpp:244: error: 'USART0_ucTrashNChar' was not declared in this scope 
```

下面是发生错误的代码：（herkulex.cpp 代码）

```
#include<Arduino.h>
#include<Wire.h>
#include<Math.h> 

//ATmega128ì�˜ ë ˆì§€ìŠ¤í„° ë“±ì�´ ì •ì�˜ë�˜ì–´ ìžˆì�Œ
#include <avr/io.h>
//#include "TIMER0.h"
#include "USART0.h" 
//#include "USART0.c"

//#define __HERKULEX_C
#include "herkulex.h"
//#undef __HERKULEX_C

//void hklx_RemoveInvalidData(void);
#define herkulex_cpp

herkulex::herkulex()
{
  // Empty constructor. needed for lib
}

#define USART_BUF_SIZE 256  
#define PROTOCOL_SIZE_IDX 2
#define PROTOCOL_ID_IDX   3
#define PROTOCOL_CMD_IDX  4
#define PROTOCOL_CS1_IDX  5
#define PROTOCOL_CS2_IDX  6
#define PROTOCOL_DATA_IDX  7

//í—¤ë�” ê´€ë ¨
#define HEADER      0xFF

//SIZE ê´€ë ¨
#define MIN_PACKET_SIZE     7
#define MIN_ACK_PACKET_SIZE                 9
#define MAX_PACKET_SIZE                     223
#define MAX_DATA_SIZE                       (MAX_PACKET_SIZE-MIN_PACKET_SIZE)

//ID ê´€ë ¨
#define MAX_ID                              0xFD    
#define BROADCAST_ID                        0xFE  

//CMD ê´€ë ¨ - Request Packet
#define CMD_EEP_WRITE                       0x01
#define CMD_EEP_READ                        0x02
#define CMD_RAM_WRITE                       0x03
#define CMD_RAM_READ                        0x04    
    #define CMD_RW_DATA_ADDR_IDX            7
    #define CMD_RW_DATA_LEN_IDX             8
#define CMD_I_JOG                           0x05
    #define CMD_I_JOG_STRUCT_SIZE           5
    #define CMD_I_JOG_MAX_DRS               (MAX_DATA_SIZE/CMD_I_JOG_STRUCT_SIZE)
#define CMD_S_JOG                           0x06
    #define CMD_S_JOG_STRUCT_SIZE           4
    #define CMD_S_JOG_MAX_DRS               (MAX_DATA_SIZE/CMD_S_JOG_STRUCT_SIZE)
#define CMD_STAT                            0x07    
#define CMD_ROLLBACK                        0x08
#define CMD_REBOOT                          0x09

#define CMD_MIN                             (CMD_EEP_WRITE)
#define CMD_MAX                             (CMD_REBOOT)

//CMD ê´€ë ¨ - ACK Packet
#define CMD_ACK_MASK                        0x40

#define CMD_EEP_WRITE_ACK                   (CMD_EEP_WRITE|CMD_ACK_MASK)
#define CMD_EEP_READ_ACK                    (CMD_EEP_READ|CMD_ACK_MASK)
#define CMD_RAM_WRITE_ACK                   (CMD_RAM_WRITE|CMD_ACK_MASK)
#define CMD_RAM_READ_ACK                    (CMD_RAM_READ|CMD_ACK_MASK)
#define CMD_I_JOG_ACK                       (CMD_I_JOG|CMD_ACK_MASK)
#define CMD_S_JOG_ACK                       (CMD_S_JOG|CMD_ACK_MASK)
#define CMD_STAT_ACK                        (CMD_STAT|CMD_ACK_MASK)
#define CMD_ROLLBACK_ACK                    (CMD_ROLLBACK|CMD_ACK_MASK)
#define CMD_REBOOT_ACK                      (CMD_REBOOT|CMD_ACK_MASK)

#define CMD_ACK_MIN                         (CMD_EEP_WRITE_ACK)
#define CMD_ACK_MAX                         (CMD_REBOOT_ACK)

//CheckSum ê´€ë ¨
#define CHKSUM_MASK                         0xFE

//////////////////////////////receiving state result value //////////////////////////////
  enum{
    DRS_RXWAITING,
    DRS_RXCOMPLETE,
    DRS_HEADERNOTFOUND,
    DRS_INVALIDSIZE,
    DRS_UNKNOWNCMD,
    DRS_INVALIDID,
    DRS_CHKSUMERROR,
    DRS_RXTIMEOUT
  }DrsRxStatus;

void herkulex:: hklx_Init(unsigned long ulBaudRate){
//  TIMER0_Init();
//  USART0_Init(ulBaudRate);
    return;
}
#define HEADER      0xFF
void herkulex:: hklx_SendPacket(DrsPacket stPacket){
    unsigned char i;

    //í—¤ë�” ìž…ë ¥
    stPacket.ucHeader[0] = HEADER;
    stPacket.ucHeader[1] = HEADER;

    //CheckSum ê³„ì‚° í›„ ìž…ë ¥
    stPacket.ucCheckSum1 = stPacket.ucPacketSize ^ stPacket.ucChipID ^ stPacket.ucCmd;
    for( i=0; i<(stPacket.ucPacketSize-MIN_PACKET_SIZE); i++ )    
        stPacket.ucCheckSum1 ^= stPacket.unData.ucData[i];

    stPacket.ucCheckSum2 = ~(stPacket.ucCheckSum1);
    stPacket.ucCheckSum1 &= CHKSUM_MASK;    
    stPacket.ucCheckSum2 &= CHKSUM_MASK;

    //PacketSize ë§Œí�¼ USART0ìœ¼ë¡œ ì†¡ì‹ 
    USART0_PutNChar(&stPacket.ucHeader[0], stPacket.ucPacketSize);

    return;
}

unsigned char herkulex:: hklx_ucReceivePacket(DrsPacket *pstPacket){
    unsigned char i, ucPacketSize, ucChipID, ucCmd, ucReadLen, ucCheckSum1, ucCheckSum2;

    //ë°›ì�€ ë�°ì�´í„° ìˆ˜ê°€ ACK íŒ¨í‚·ì�˜ ìµœì†Œ ì‚¬ì�´ì¦ˆë³´ë‹¤ ì �ì�„ ê²½ìš°
    if(gucRxBufferCnt < MIN_ACK_PACKET_SIZE){
        return DRS_RXWAITING;
    }

    //íŒ¨í‚·ì�˜ ì²˜ì�Œ ë‘� ë°”ì�´íŠ¸ê°€ í—¤ë�”ê°€ ì•„ë‹� ê²½ìš°
    if(gucRxBuffer[gucRxBufferReadIdx] != HEADER || 
       gucRxBuffer[((unsigned int)gucRxBufferReadIdx+1)%USART_BUF_SIZE] != HEADER){
        hklx_RemoveInvalidData();
        return DRS_HEADERNOTFOUND;   
    }
    //ë§žì�„ ê²½ìš° Size, ID, Cmdë¥¼ ì�½ì–´ì˜´
    else{
        ucPacketSize = gucRxBuffer[ ((unsigned int)gucRxBufferReadIdx + PROTOCOL_SIZE_IDX ) % USART_BUF_SIZE ];
        ucChipID = gucRxBuffer[ ((unsigned int)gucRxBufferReadIdx + PROTOCOL_ID_IDX ) % USART_BUF_SIZE ];
        ucCmd = gucRxBuffer[ ((unsigned int)gucRxBufferReadIdx + PROTOCOL_CMD_IDX ) % USART_BUF_SIZE ];
    }

    //Sizeê°€ ìµœëŒ€ë³´ë‹¤ í�´ ê²½ìš°
    if(ucPacketSize > MAX_PACKET_SIZE){
        hklx_RemoveInvalidData();
        return DRS_INVALIDSIZE;
    }
    //ì•„ì§� Size ë§Œí�¼ì�˜ ë�°ì�´í„°ê°€ ë“¤ì–´ì˜¤ì§€ ì•Šì•˜ì�„ ê²½ìš°
    else if(ucPacketSize > gucRxBufferCnt){
        return DRS_RXWAITING;
    }

    //Cmdê°€ ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ ê²½ìš°
    if(!(ucCmd >= CMD_ACK_MIN && ucCmd <= CMD_ACK_MAX)){
        hklx_RemoveInvalidData();
        return DRS_UNKNOWNCMD;
    }

    //IDê°€ ë²”ìœ„ë¥¼ ë²—ì–´ë‚œ ê²½ìš°
    if(ucChipID >= BROADCAST_ID){
        hklx_RemoveInvalidData();
        return DRS_INVALIDID;
    }

    //ê°� Cmdì—� ë”°ë�¼ì„œ Sizeê°€ ì �í•©í•œì§€ ê²€ì‚¬
    switch(ucCmd){
        case CMD_EEP_WRITE_ACK:
        case CMD_RAM_WRITE_ACK:
        case CMD_I_JOG_ACK:
        case CMD_S_JOG_ACK:
        case CMD_STAT_ACK:
        case CMD_ROLLBACK_ACK:
        case CMD_REBOOT_ACK:
            if(ucPacketSize != MIN_ACK_PACKET_SIZE){
                hklx_RemoveInvalidData();
                return DRS_INVALIDSIZE;
            }
            break;
        case CMD_EEP_READ_ACK:
        case CMD_RAM_READ_ACK:
            ucReadLen = gucRxBuffer[ ((unsigned int)gucRxBufferReadIdx + CMD_RW_DATA_LEN_IDX ) % USART_BUF_SIZE ];
            if(ucPacketSize != (MIN_ACK_PACKET_SIZE + 2 + ucReadLen)){
                hklx_RemoveInvalidData();
                return DRS_INVALIDSIZE;
            }   
            break;
    }

    //ìˆ˜ì‹ ë�œ íŒ¨í‚·ì�˜ CheckSumì�„ ê³„ì‚°
    ucCheckSum1 = ucPacketSize ^ ucChipID ^ ucCmd;
    for(i=0;i<(ucPacketSize-MIN_PACKET_SIZE);i++){
        ucCheckSum1 ^= gucRxBuffer[ ((unsigned int)gucRxBufferReadIdx + i ) % USART_BUF_SIZE ];
    }
    ucCheckSum2 = ~(ucCheckSum1);
    ucCheckSum1 &= CHKSUM_MASK;
    ucCheckSum2 &= CHKSUM_MASK;

    //ê³„ì‚°ë�œ CheckSumì�´ ì‹¤ì œë¡œ ë°›ì�€ ë�°ì�´í„°ì™€ ì�¼ì¹˜í•˜ëŠ”ì§€ ê²€ì‚¬
    if(ucCheckSum1 != gucRxBuffer[ ((unsigned int)gucRxBufferReadIdx + PROTOCOL_CS1_IDX) % USART_BUF_SIZE ] ||
       ucCheckSum2 != gucRxBuffer[ ((unsigned int)gucRxBufferReadIdx + PROTOCOL_CS2_IDX) % USART_BUF_SIZE ])
    {
        hklx_RemoveInvalidData();
        return DRS_CHKSUMERROR;
    }       

    //ëª¨ë“  ê²€ì‚¬ë¥¼ í†µê³¼í–ˆë‹¤ë©´, ë°›ëŠ” pstPacketì—� íŒ¨í‚·ì�„ ë³µì‚¬
    USART0_ucGetNChar(&(pstPacket->ucHeader[0]), ucPacketSize);

    //ì™„ë£Œ ìƒ�íƒœë¥¼ ë°˜í™˜
    return DRS_RXCOMPLETE;
}

void herkulex:: hklx_RemoveInvalidData(void){
    unsigned char ucRcvCnt, ucRdIndex, i;

    //ë²„í�¼ì�˜ ìƒ�íƒœë¥¼ ë³€ìˆ˜ì—� ë³µì‚¬
    ucRcvCnt=gucRxBufferCnt;
    ucRdIndex=gucRxBufferReadIdx;

    //ë°›ì�€ ë�°ì�´í„°ê°€ ì—†ì�„ ê²½ìš° ë°˜í™˜
    if(ucRcvCnt==0){
        return;
    }

    //ë‹¤ì�Œ í—¤ë�”ë¥¼ ì°¾ê±°ë‚˜ ë°›ì�€ ë�°ì�´í„°ì�˜ ë��ì—� ë�„ë‹¬í•  ë•Œê¹Œì§€ ì§„í–‰

    for(i=1;i<ucRcvCnt-1;i++){
        if( (gucRxBuffer[ ((unsigned int)ucRdIndex + i ) % USART_BUF_SIZE ] == HEADER ) &&
            (gucRxBuffer[ ((unsigned int)ucRdIndex + i + 1) % USART_BUF_SIZE ] == HEADER) )
        {
            break;
        }
    }
    if((i==ucRcvCnt-1) && (gucRxBuffer[ ((unsigned int)ucRdIndex + ucRcvCnt - 1) % USART_BUF_SIZE ] != HEADER))
    {
        i++;
    }       

    //ië§Œí�¼ ë�°ì�´í„°ë¥¼ ë²„ë¦¼
    USART0_ucTrashNChar(i);     

    return;
} 
```

错误声明它们未声明的变量都在我已包含在 herkulex.cpp 文件中的 USART0.h 文件下声明。我可以知道代码有什么问题吗？谢谢！

```
USART0.h code: 
#ifndef USART0_lib
#define USART0_lib

#include <Arduino.h>
#include <Wire.h> 
#include <inttypes.h>
//ìˆ˜ì‹  ë²„í�¼ì�˜ ì‚¬ì�´ì¦ˆ ì„ ì–¸
#define USART_BUF_SIZE 256

//ìˆ˜ì‹  ë²„í�¼, ì�½ê¸° ì�¸ë�±ìŠ¤, ì“°ê¸° ì�¸ë�±ìŠ¤, ë�°ì�´í„° ìˆ˜ë¥¼ ì €ìž¥í•  ë³€ìˆ˜ ì„ ì–¸
volatile unsigned char gucRxBuffer[USART_BUF_SIZE];
volatile unsigned char gucRxBufferReadIdx;
volatile unsigned char gucRxBufferWriteIdx;
volatile unsigned char gucRxBufferCnt;

#ifdef USART0_cpp
#define EXTERN 
#else 
#define EXTERN extern 
#endif 

class USART0
{
  public: 
  USART0();

  void USART0_Init(unsigned long ulBaudRate);
  void USART0_PutChar(unsigned char ucData);
  void USART0_PutNChar(unsigned char *pucData, unsigned char ucCnt);
  unsigned char USART0_ucGetNChar(unsigned char *pucTarget, unsigned char ucCnt);
  unsigned char USART0_ucTrashNChar(unsigned char ucCnt);
  void USART0_ClearBuffer(void);

//  private :no private
};

#endif 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:36:05.757

`USART0_PutChar`是类的成员函数`USART0`。您正尝试从另一个类成员函数调用它，就像独立非成员函数一样 - 您需要一个实例`USART0`来调用该函数。

关于您的评论，您需要创建一个实例，`USART0`然后像调用任何其他成员函数一样调用该函数

```
 USART0 obj;
 obj.USART0_PutChar(); 
```

**除非您从同一类的**另一个成员函数调用它，否则您不能像当前尝试那样调用成员函数。您可以通过将实例`USART0`（或指针或引用）作为参数传递给您需要调用的函数来实现您想要的`USART0_PutChar()`。或者，您可以考虑将此函数设为静态成员函数，`USART0`尽管这可能不合适，具体取决于函数是否需要访问非静态成员变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:37:49.937

该函数`USART0_PutNChar`（和其他函数）是另一个类的*成员函数*。您需要创建该类的实例并通过此对象调用函数：

```
USART0 usart0;

usart0.USART0_PutNChar(...); 
```

但是，该类`USART0`似乎不包含任何状态，这意味着您可以将函数设为全局（即不在类中）；使函数静态，如

```
// Using `struct` as there is no private or protected data/functions
struct USART0
{
    static void USART0_PutNChar(...);
    ...
}; 
```

第三种选择是制作`USART0`命名空间：

```
namespace USART0
{
    void USART0_PutNChar(...);
    ...
} 
```

在最后两种情况下，您可以像这样调用函数：

```
USART0::USART0_PutNChar(...); 
```

# eclipse - Maven 不更新/下载依赖项

> ID：13361622
> 
> 赞同：4
> 
> 时间：2012-11-13T13:32:54.143
> 
> 标签：eclipse, apache, maven, wicket

我正在使用 Eclipse EE 和 Apache Wicket。

我在 pom.xml 中写下了我的依赖项。

出于某种原因，即使我尝试清理项目并进入 Maven > 更新项目，maven 也不会更新。

当我去检查依赖项时，jar 在那里，但是当我尝试运行时它仍然给我错误（ClassNotFoundException）。

为什么会这样？

有问题的依赖：

```
<dependency>
    <groupId>org.tuckey</groupId>
    <artifactId>urlrewritefilter</artifactId>
    <version>4.0.3</version>
</dependency> 
```

也已经尝试重新安装maven。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T13:44:58.860

尝试运行*mvn eclipse:eclipse*来更新你的 Eclipse。此外，在命令运行完成后刷新。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-15T15:55:09.857

你不应该混合使用 "mvn eclipse:eclipse" 和[m2eclipse maven eclipse plugin](http://www.sonatype.org/m2eclipse/)，这会导致插件无法正常运行。如果您这样做了，您需要删除您的 .project/.classpath/.settings 文件并使用“导入现有 maven 项目”重新导入。

# java - 在 J2ME 中存储数据的文件

> ID：13361625
> 
> 赞同：1
> 
> 时间：2012-11-13T13:33:01.297
> 
> 标签：java, java-me, compression

我正在编写一个 J2ME 词典应用程序，但我一直在坚持哪种方式是在应用程序中存储内容的最佳方式。我不希望应用程序太大。我想将单词的描述存储在字典中。请帮我。

我知道[RMS](https://stackoverflow.com/tags/rms/info)，但我不想使用 RMS，因为字典中的所有单词及其描述都不适合 RMS。

我打算只离线工作，而不从网络访问数据。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T17:12:35.743

字典是一个映射，其中键是单词，值是描述。你可以有一个哈希表。
要将值存储在 jar 文件中，请使用[`Java .properties file`](http://en.wikipedia.org/wiki/.properties). 每行都将成为一个键值对。
然后你打开那个文件[`Class.getResourceAsStream`](http://www.developer.nokia.com/Resources/Library/Java/_zip/GUID-A8A297BB-EA23-4E2C-A9D1-6403BBEE0CD9/java/lang/Class.html#getResourceAsStream%28java.lang.String%29)并解析它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:51:11.657

J2me 应用程序可以使用一个叫做[RMS](http://www.ibm.com/developerworks/library/wi-rms/)的东西，它非常适合用于仅从应用程序读取/写入数据。如果你想读取外部文件，你的应用会请求用户许可，这可能不太酷。

例如，RMS 用于存储游戏偏好等内容。

请记住，RMS 非常简单，不支持`SELECT`. 您只遍历内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-06-24T17:20:47.323

我试着只是阅读文件。花了半分钟。可以肯定的是，我们不能使用单个文件来保存数据。相反，将数据存储在多个文件中。我使用了以下结构。

```
en
├───a
│       a.txt
│       b.txt
│       c.txt
│       ...
├───b   ...
├───c   ...
│
... 
```

`word`在哪里`en/w/o.txt`。

这种方法效果很快。似乎在创建包时资源被压缩，所以这是最方便的方法。

# ffmpeg - 高清和正常质量的 ffmpeg 设置

> ID：13361627
> 
> 赞同：3
> 
> 时间：2012-11-13T13:33:06.517
> 
> 标签：ffmpeg

您好，我需要在我的服务器上存储同一个文件的两个版本，中等质量和高清质量，问题是我不太了解 ffmpeg，所以我只是随机尝试这是代码，我正在使用代码 belo但我最终得到了一个更大的文件，但是它可以工作，它可以播放。

```
ffmpeg -i inputfile.wmv  -vcodec libx264 -ar 44100 -b 200 -ab 56 -crf 22 -s 360x288 -vpre medium -f flv tmp.flv 
```

只需要这两个命令来创建 2 个不同的文件

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T14:24:47.317

您需要提供有关您的目标比特率、质量或目标文件大小以及源材料的大小和质量的更多信息，最好包括使用的编解码器和相关参数。

您应该阅读手册`ffmpeg -h`或两者兼而有之。您的命令行有几个问题：

*   您正在使用恒定速率因子 crf = 22，同时仍在尝试使用 -b 200 限制比特率。
*   比特率以比特/秒指定（除非您使用的是*非常*旧的 ffmpeg），并且 200 bps 不能用于任何事情，添加`k`以获取千比特/秒。
*   您尚未指定音频编解码器，但已指定音频比特率，ffmpeg 会尝试为您猜测音频编解码器，但我不知道 .flv 文件的默认编解码器是什么。

我假设您发布的命令行应该用于“中等”质量文件。

您可以尝试的一些建议：

1.  *先试试这个*：指定音频编解码器，例如`-acodec libmp3lame`，或者如果音频已经是一个好的格式，你可以直接复制它而不用修改`-acodec copy`
2.  尝试不同的比率因子，例如`-crf 30`，数字越大意味着图片质量越差，但文件大小也越小。
3.  尝试不同的编码器预设，例如`-vpre slow`，通常，较慢的预设启用在编码时需要更多 CPU 周期但会产生更好的图像质量的功能，请参阅`x264 --fullhelp`或[此页面](http://dev.gentoo.org/~beandog/x264_preset_reference.html)以查看每个预设包含的内容。
4.  进行 2 遍编码，[链接](http://ffmpeg.org/trac/ffmpeg/wiki/x264EncodingGuide#twopass)。

如果您不想阅读 ffmpeg 的所有文档和所需的编解码器参数，我建议您查看[此备忘单](http://rodrigopolo.com/ffmpeg/cheats.html)，尽管命令行开关已在不同版本的 ffmpeg 上发生了变化，因此示例可能无法正常工作。

一个示例命令行：

```
ffmpeg -i inputfile.wmv  -vcodec libx264 -crf 25 -s 360x288 -vpre veryslow -acodec libmp3lame -ar 44100 -ab 56k -f flv tmp.flv 
```

该参数`-s [size]`是输出视频的大小，以像素为单位，对于 HD 文件，您可能需要 1280x720 左右的尺寸，如果您的材料是 5:4 比例（如 360x288），则您需要尝试 1280x1024、960x768 或 900x720。不要设置比源材料大的尺寸，因为这只会放大视频，您（可能）最终会得到一个更大的文件，而质量没有任何明显的改善。该`-ab`参数是音频比特率，您可能还想在 HD 版本上增加此参数。

# css - 使用规则重置元素（删除一个类上的所有元素样式）

> ID：13361636
> 
> 赞同：3
> 
> 时间：2012-11-13T13:33:20.677
> 
> 标签：css

我想知道，是否有任何 CSS 规则来重置元素样式？

能够只与一个类一起使用就好了`.reset`。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:47:08.917

您可以创建一个 CSS 类，将样式“重置”为您想要的任何样式：

```
.reset{
  border:0;
  padding:0;
  margin:0;
  font-weight:normal;
  /*etc.*/
} 
```

然后应用于您的元素：

```
<h1 class="reset">...</h1> 
```

这就是你所追求的吗？

请记住，CSS 中的第一个“C”代表 Cascading，因此您可能需要更具体地使用 CSS 来克服应用于元素的其他样式。[CSS 优先级参考](http://www.w3.org/TR/CSS2/cascade.html)。

# objective-c - UIImage 动画延迟数组

> ID：13361639
> 
> 赞同：0
> 
> 时间：2012-11-13T13:33:26.623
> 
> 标签：objective-c, uiimage, uiviewanimation

我发现这段代码对于避免第一次动画延迟非常有帮助：

```
NSMutableArray *menuanimationImages = [[NSMutableArray alloc] init];

for (int aniCount = 1; aniCount < 21; aniCount++) {
    NSString *fileLocation = [[NSBundle mainBundle] pathForResource: [NSString stringWithFormat: @"bg%i", aniCount + 1] ofType: @"png"];
    // here is the code to pre-render the image
    UIImage *frameImage = [UIImage imageWithContentsOfFile: fileLocation];
    UIGraphicsBeginImageContext(frameImage.size);
    CGRect rect = CGRectMake(0, 0, frameImage.size.width, frameImage.size.height);
    [frameImage drawInRect:rect];
    UIImage *renderedImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    [menuanimationImages addObject:renderedImage];
}

settingsBackground.animationImages = menuanimationImages; 
```

但我有时想使用相同的图像 - 我可以通过手动填写我的数组上方的代码吗

```
testArray  = [[NSArray alloc] initWithObjects:[UIImage imageNamed:@"test_001.png"],

                           [UIImage imageNamed:@"test_002.png"],

                           [UIImage imageNamed:@"test_001.png"],
nil]; 
```

感谢您的想法！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:38:54.503

是的，你可以使用这个

```
UIImageView * animatedImageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 200,200)];

testArray  = [[NSArray alloc] initWithObjects:[UIImage imageNamed:@"test_001.png"], [UIImage imageNamed:@"test_002.png"],[UIImage imageNamed:@"test_001.png"],nil];
animTime =3.0;
[animatedImageView setAnimationImages:testArray] ;
animatedImageView.animationDuration =  animTime;
animatedImageView.animationRepeatCount = 1;
[self.view addSubview: animatedImageView];
[animatedImageView startAnimating]; 
```

# hyperlink - 带有链接的 Google 地球 kml 屏幕叠加层

> ID：13361643
> 
> 赞同：1
> 
> 时间：2012-11-13T13:33:33.983
> 
> 标签：hyperlink, kml, google-earth

伙计们，

我想创建一个总是在 GE 视图的左上角显示一个图标的 kml。此外，单击该图标应该会打开一个带有一些附加信息的地标气球/网页/smthg。

我可以想到两种可能的解决方案：1）带有嵌入式链接的屏幕覆盖图和 2）带有绝对 screenXY 坐标的地标。不幸的是，我找不到其中任何一个的一个例子，这让我想知道这是否可行？

任何帮助高度赞赏，

安西

# database - Virtuemart2 csv导入数据库不断崩溃

> ID：13361646
> 
> 赞同：0
> 
> 时间：2012-11-13T13:33:47.327
> 
> 标签：database, csv, import, crash, virtuemart

我正在使用插件**CSV Advanced**在 Virtuemart 2 中导入大约 230 种产品。这一切似乎在开始时运行良好，但表**“_virtuemart_product_customfields”**不断崩溃。我现在尝试一次只导入几个产品，但似乎，但是我这样做了，当我得到大约 151 个产品时，表崩溃了。即使我只是尝试再进口一种产品。

我已经“TRUNCATE”：多次修改表格（**这足以获得“新开始”吗？**）并重新开始。

我没有删除产品，我只是想更新它们的简短描述、详细描述、自定义字段和自定义字段的值。

**当我分析表格时，我在 phpMyadmin 中遇到了这个错误（在导入了比 151 多一个产品之后）：**

XXX_virtuemart_product_customfields / 检查 / 警告 / 表被标记为崩溃

XXX_virtuemart_product_customfields / 检查 / 错误 / Can't read indexpage from filepos: 33792

XXX_virtuemart_product_customfields / 检查 / 错误 / 表 './XXX_virtuemart_product_customfields.MYI' 的密钥文件不正确；尝试修复它

XXX_virtuemart_product_customfields/检查/错误/损坏

任何人都知道可能导致这种情况的原因吗？我真的不相信我的 CSV 文件中有任何错误。

或许值得一提的是，文件中的信息是瑞典语，带有 åäö，但 CSV 是 UTF-8 格式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:02:50.953

```
Try To increase your mysql user query execution time 
```

再次出现此问题，然后您需要批量导入（设置一些限制）

# css - GWT cellTable 单元格的动态样式

> ID：13361648
> 
> 赞同：1
> 
> 时间：2012-11-13T13:33:51.997
> 
> 标签：css, gwt, celltable

我在使用 GWT 时遇到问题。我正在构建 cellTable 的列，我希望单元格的样式取决于该单元格的值：

```
Column<MyProxy, MyProxy> editButtonColumn = new Column<MyProxy, MyProxy>(new ActionCell<MyProxy>("", new ActionCell.Delegate<MyProxy>() {
        @Override
        public void execute(MyProxy record) {
            if (object.isEditable()) {
                doSomething(record);
            }
        }
    })) {
        @Override
        public MyProxy getValue(MyProxy object) {
            if (object.isEditable()) {
                this.setCellStyleNames("editButtonCell");
            }
            return object;
        }
    }; 
```

我已经在调试模式下检查了样式“editButtonCell”是否正确应用。但是在生成的 HTML 中，第一行的样式每次都丢失..​​....它看起来像一个 GWT 错误，但也许你们有更好的解释。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T13:51:09.640

`getValue`我还没有检查，但很可能在调用时间之前已经生成了单元格的开口，因此`setCellStyleNames`仅适用于列中的剩余单元格。

正确的方法是*覆盖* [`getCellStyleNames`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/cellview/client/Column.html#getCellStyleNames%28com.google.gwt.cell.client.Cell.Context,%20T%29)列以返回 CSS 类名称或不取决于单元格值。

* * *

顺便说一句，您可以`IdentityColumn`在`getValue`then 变得微不足道时进行扩展。

# cakephp - cakephp 命名参数破坏基于 REST 的 Web 服务

> ID：13361649
> 
> 赞同：0
> 
> 时间：2012-11-13T13:33:56.457
> 
> 标签：cakephp

我有一个基于以下形式的 json REST：

```
Router::mapResources('Test'); 
```

这相当于索引方法：

```
Router::connect( '/Test',
                 array(
                      'controller' => 'ChannelSources', 
                      'action' => 'index', 
                      '[method]' => 'GET' ),
                 array(); 
```

我正在尝试为此方法添加对命名参数的支持。但显然它破坏了路由器方法，因为索引操作不是 URL 的一部分

我试过使用 Router::connectNamed(array('somenameparam')); 但它失败了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-15T11:40:26.207

我会创建一个特定的路线，以便您可以传递正确的参数，然后您可以将您的参数传递到路线中。

看看，[http://book.cakephp.org/2.0/en/development/routing.html#passing-parameters-to-action](http://book.cakephp.org/2.0/en/development/routing.html#passing-parameters-to-action)

```
Router::connect(
    '/blog/:id-:slug', // E.g. /blog/3-CakePHP_Rocks
    array('controller' => 'blog', 'action' => 'view'),
    array(
        // order matters since this will simply map ":id" to $articleId in your action
        'pass' => array('id', 'slug'),
        'id' => '[0-9]+'
    )
); 
```

# c# - 函数教程不够清晰

> ID：13361652
> 
> 赞同：0
> 
> 时间：2012-11-13T13:34:07.860
> 
> 标签：c#, function, methods

一般来说，我是 C# 和面向对象语言的绝对初学者，所以我在网上找到了本教程并坚持使用[functions](http://csharp.net-tutorials.com/basics/functions/#.UKJHhWe5e1s)。现在，它说：你声明这样的函数：

```
public int AddNumbers(int number1, int number2) 
{
     int result = number1 + number2;
     return result; 
} 
```

但它并没有说这个方法必须在 Main() 方法之外。而且，它说这个函数是这样调用的：

```
int result = AddNumbers(10, 5);
Console.WriteLine(result); 
```

我的猜测是你必须把这段代码放在 Main() 方法中，但它并没有说你必须首先制作对象，所以正确的代码是：

```
Program add = new Program();
int result = add.AddNumbers(10, 5);
Console.WriteLine(result); 
```

'Program' 是父类的名称。

所以我现在很困惑。我不熟悉 C# 版本，但作为我的结论，本[教程](http://csharp.net-tutorials.com/basics/functions/#.UKJHhWe5e1s)适用于 C# 2.0。

由于本教程在谷歌“C#教程”的#2上，我对我和未来的学习者的问题是：这是错误还是你在 C# 2.0 中这样做的方式，或者它只是以这样的方式编写的，所以不是对于绝对初学者来说足够清楚吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:37:21.840

他们的示例对于初学者来说不是很清楚，但看起来他们假设您是从同一个类中调用该函数。

所以这样的事情会起作用：

```
public class Foo
{
   public void Bar()
   {
     int result = Add(1, 3);
   }

   public int Add(int first, int second)
   {
     return first + second;
   }
} 
```

这可能会在您的`Main`方法中使用，例如：

```
public static Main()
{
  var foo = new Foo();
  foo.Bar();
} 
```

正如@Oded 在他的回答中指出的那样，作者可能已经理所当然地认为您不能嵌套函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:41:53.157

方法与实例相关，你应该通过从类中创建一个实例来调用它们，然后调用“与你一样”的方法

但是，`static`方法是类方法，因此您可以在不创建实例的情况下调用它们

```
 public static int AddNumbers(int number1, int number2) 
  {
 int result = number1 + number2;
 return result; 
  } 
```

你用它的类名调用方法`Program.AddNumbers(1,2)`

但是，如果方法是静态的，您可以在同一类中的静态方法中调用它，而无需指定类的名称

```
 AddNumber(1,2) 
```

因为`AddNumber`是在同一个类中调用的静态方法`Program`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:51:29.387

您使用的教程具有误导性。在 c# 中没有独立的函数。所有可执行代码都放在属于类的方法中。

这就是为什么最好避免使用“函数”一词并使用常用的方法 - （类的）方法。

方法可以是静态的——那些在类上调用并且不需要类实例，或者实例方法——那些需要一个必须首先创建的现有实例

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:36:32.780

本教程可能认为方法不能嵌套是理所当然的。

方法不能包含方法 - 方法应该在类或结构中。

你所做的——就教程而言，你得到的解决方案是正确的。

# ios - 阻塞和保留循环无法捕获它

> ID：13361655
> 
> 赞同：0
> 
> 时间：2012-11-13T13:34:21.383
> 
> 标签：ios, block, weak-references, retain-cycle

我遇到了块和弱引用的问题，我在 ARC 下。我建立了一个类，它是一个免费项目，它是一种围绕 Google Directions API 的简单包装器，您可以在此处下载它：[链接到该项目](https://github.com/DrAma999/Route-Directions-Object)
我在视图控制器中使用它问题是使用它后视图控制器是未解除分配。我想这是这个对象的一个​​问题，因为如果我将它注释掉或设置为 nil 一切正常。我无法理解保留周期在哪里，当然我设置为弱自我，这是我使用它的视图控制器的方法：

```
- (void) getDirections{
 __weak RouteMapViewController *  weakSelf =  self;
self.routeObject = [[RouteDirectionsObject alloc]init];

[self.mapView removeAnnotations:self.mapView.annotations];
[self.mapView removeOverlays:self.mapView.overlays];
[[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:YES];
[_routeObject createDirectionRequestWithStartPoint:weakSelf.startPoint
                                           andEndPoint:weakSelf.endPoint
                                     withCallBackBlock:^(NSError *error, NSDictionary *routeDistance, NSDictionary *routeDuration, MKPolyline *routePolyline, NSArray *routes, NSArray *steps, CLLocation *startPoint, CLLocation *endPoint, NSArray *directions) {
    [[UIApplication sharedApplication] setNetworkActivityIndicatorVisible:NO];
    Annotation * startAnnotation = [[Annotation alloc]initWithCoordinate:startPoint.coordinate title:NSLocalizedString(@"YOUR_POSITION_KEY", @"Your position") annotationType:AnnotationTypeStart];
    Annotation * endAnnotation = [[Annotation alloc]initWithCoordinate:endPoint.coordinate title:NSLocalizedString(@"AIRPORT_POSITION_KEY", @"Airport position") annotationType:AnnotationTypeEnd];
    NSArray * annotationArray = [NSArray arrayWithObjects:startAnnotation, endAnnotation, nil];
    weakSelf.routeSteps = steps;
    weakSelf.routeDirections = directions;
    weakSelf.duration = routeDuration;
    weakSelf.distance = routeDistance;
    CLLocationDegrees maxLat = -90.0f;
    CLLocationDegrees maxLon = -180.0f;
    CLLocationDegrees minLat = 90.0f;
    CLLocationDegrees minLon = 180.0f;

    for (int i = 0; i < weakSelf.routeSteps.count; i++) {
        NSDictionary * stepDictCoordinate = [[weakSelf.routeSteps objectAtIndex: i]objectForKey:@"start_location"];
        CLLocationCoordinate2D currentLocationCoordinate = CLLocationCoordinate2DMake([[stepDictCoordinate objectForKey:@"lat"]doubleValue], [[stepDictCoordinate objectForKey:@"lng"]doubleValue]);
        if(currentLocationCoordinate.latitude > maxLat) {
            maxLat = currentLocationCoordinate.latitude;
        }
        if(currentLocationCoordinate.latitude < minLat) {
            minLat = currentLocationCoordinate.latitude;
        }
        if(currentLocationCoordinate.longitude > maxLon) {
            maxLon = currentLocationCoordinate.longitude;
        }
        if(currentLocationCoordinate.longitude < minLon) {
            minLon = currentLocationCoordinate.longitude;
        }
    }

    MKCoordinateRegion region;
    region.center.latitude     = (maxLat + minLat) / 2;
    region.center.longitude    = (maxLon + minLon) / 2;
    region.span.latitudeDelta  = maxLat - minLat;
    region.span.longitudeDelta = maxLon - minLon;

    dispatch_async(dispatch_get_main_queue(), ^{
        if ( error) {
            UIAlertView * alert = [[UIAlertView alloc]initWithTitle:NSLocalizedString(@"Error", @"Error alert view title") message:NSLocalizedString(@"KEY_DIRECTIONS_ERROR", @"Alert error message for directions") delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
            [alert show];

            [_routesButton setEnabled:NO];

        }
        else{
            [weakSelf.mapView addAnnotations:annotationArray];
            [_routesButton setEnabled:YES];

            if(routePolyline){
                [weakSelf.mapView addOverlay:routePolyline];
            }
            else{
                UIAlertView * alert = [[UIAlertView alloc]initWithTitle:NSLocalizedString(@"Error", @"Error alert view title") message:NSLocalizedString(@"KEY_DIRECTIONS_POLYLINE_ERROR", @"Polyline inconsistant") delegate:nil cancelButtonTitle:@"OK" otherButtonTitles: nil];
                [alert show];

            }
            //[weakSelf.mapView setRegion:region animated:YES];
            [weakSelf setRegion:region];
        }
    });
}];} 
```

如果我放置断点并询问视图控制器的 retainCount，我可以看到即使传递的视图控制器设置为弱，它也会增加不同的时间。任何帮助将不胜感激。
谢谢，
安德里亚

**/ *** ** *** ** *** ** *** **** *UPDATE* ***** ** *** ** *** ** *** *** /**
检查分配我可以看到在块内视图控制器被保留了很多次通过 trought调用`-tryRetain`until 的方法被递减，但它似乎错过了一个释放释放。为了清楚起见，我必须指定传递的块被复制到类路由方向对象中。我做了一个小样本，你可以在这里下载：[下载项目](https://dl.dropbox.com/u/51180713/TESTMYAPI.zip)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T17:42:13.333

对象的绝对保留计数没有意义；www.whentouseretaincount.com（底部有一些描述技术细节的链接）。

泄漏工具不太可能提供帮助。可能会，但也可能不会。但是，分配工具是您的朋友。打开“记录引用计数”和“仅跟踪活动分配”。在 Instruments 中运行您的应用程序，然后查找应该消失但没有消失的对象。单击任何一个将显示该对象的保留/释放事件，这将回答额外保留来自何处的问题。

鉴于这是一个视图对象，很有可能是因为它仍然在视图层次结构中，但隐藏在其他不透明的视图后面。它也可能被保存为计时器的目标或缓存，可能是“返回”样式的导航缓存。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:12:42.550

您可以使用 Instruments 来确定是什么在保留和释放您的对象，并找出不平衡发生的位置。这可以通过在构建和运行项目时选择 Profile 来完成，您将启动仪器。

进入后，您可以选择泄漏以确定泄漏发生的位置。 ![在此处输入图像描述](../Images/d454e8ec0a39e7599bb6c57f7142eb94.png)

您可以使用以下几个指南来掌握 Instruments：

*   [http://www.raywenderlich.com/2696/how-to-debug-memory-leaks-with-xcode-and-instruments-tutorial](http://www.raywenderlich.com/2696/how-to-debug-memory-leaks-with-xcode-and-instruments-tutorial)
*   [http://mobileorchard.com/find-iphone-memory-leaks-a-leaks-tool-tutorial/](http://mobileorchard.com/find-iphone-memory-leaks-a-leaks-tool-tutorial/)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-11-14T10:46:52.720

**在您的情况下，您不应该使用 self 类的实例变量（以块为单位） _routerButton**

# bash - 如何测试是否在 Bash 中设置了位置参数？

> ID：13361658
> 
> 赞同：4
> 
> 时间：2012-11-13T13:34:44.620
> 
> 标签：bash, shell, parameters

我想知道为什么`[[ ! -v 1 ]]`无论我是否将第一个位置参数传递给下面的函数，测试都会失败：

```
shopt -os nounset

function foo {
  echo -n "$FUNCNAME: 1st positional parameter "
  [[ ! -v 1 ]] && echo "is missing." || echo is "\"$1\"."
} 
```

我知道还有其他测试方法，但为什么这个特定的测试不起作用？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T17:04:29.903

在这种情况下，您要检查参数是否未设置。

```
has_1() {
  if [[ -z "${1+present}" ]]; then 
    echo "no first param"
  else
    echo "given: $1"
  fi
} 
```

仅当参数*未设置时，*[参数扩展](http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion) `${var+word}`才会返回“word” ——即，如果您传递一个空字符串，该函数将指示第一个参数已给出。

 ** * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T17:43:34.647

```
if [ "$#" -gt "0" ]; then echo 'ok'; else echo '0'; fi 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-12-10T10:50:20.510

Bash 5.1 有一个非常直接的方法来做到这一点。如[发行说明](https://tiswww.case.edu/php/chet/bash/NEWS)中所述：

> X。`test -v N' 现在可以测试是否设置了位置参数 N。

因此，要检查是否设置了第 N 个参数，可以使用以下任一方法：

```
test -v N 
```

```
[ -v N ] 
```

* * *

看一个非常基本的例子：

```
test -v 1 && echo "1st parameter is set: '$1'"
[ -v 2 ] && echo "2nd parameter is set: '$2'" 
```

查看一些示例：

```
bash-5.1$ bash script.sh ""
1st parameter is set: ''

bash-5.1$ bash script.sh a b
1st parameter is set: 'a'
2nd parameter is set: 'b'

bash-5.1$ bash script.sh ""
1st parameter is set: ''

bash-5.1$ bash script.sh "" bla
1st parameter is set: ''
2nd parameter is set: 'bla' 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-01-12T13:08:32.483

以下模式涵盖了大多数实际用例：

```
[[ -z "${2:-}" ]] && echo "The 2'nd parameter is unset" >&2 && exit 1 
```

[壳参数扩展](https://www.gnu.org/savannah-checkouts/gnu/bash/manual/bash.html#Shell-Parameter-Expansion)*

# c# - ObservableCollection 添加一个项目并覆盖其他项目

> ID：13361659
> 
> 赞同：0
> 
> 时间：2012-11-13T13:34:49.670
> 
> 标签：c#, windows-phone-7, observablecollection

我有这个功能：

```
ObservableCollection<TankstellenItem> completeList = new ObservableCollection<TankstellenItem>();
        for(var j = 0; j < listItem.Count; j++)
        {
            foreach (FuelItem fItem in listItem.ToList()[j].Fuels)
            {
                Debug.WriteLine("HERE AGAIN: " + fItem.Price);
                TankstellenItem newItem = new TankstellenItem();
                ObservableCollection<FuelItem> fuelList = new ObservableCollection<FuelItem>();
                newItem = listItem.ToList()[j];
                newItem.Fuels = null;
                fuelList.Add(fItem);
                newItem.Fuels = fuelList;
                completeList.Add(newItem);
                Debug.WriteLine("PRICES: " + completeList.ToList()[0].Fuels[0].Price);
            }
        }
        Debug.WriteLine("COMPLETELIST LENGTH: " + completeList.ToList()[0].Fuels[0].Price + " + " + completeList.ToList()[1].Fuels[0].Price); 
```

结果是：

```
LISTITEM LENGTH: 1
HERE AGAIN: 1,699
PRICES: 1,699
HERE AGAIN: 1,529
PRICES: 1,529
COMPLETELIST LENGTH: 1,529 + 1,529 
```

正如您在 foreach 中看到的，价格是不同的。但是在 for 方法之后，每个项目的输出只有 1,529。我不明白为什么会这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:30:35.417

从您的代码中可以看出，您希望`Fuel`从原始列表 () 中的每个 TankstellenItem 中检索所有对象`listItem`，然后将它们放入 ObservableCollection。

```
 // Create Complete List
 ObservableCollection<TankstellenItem> completeList = new ObservableCollection<TankstellenItem>();
 // Loop through each TankstellenItem in listItem
 foreach(TankstellenItem tItem in listItem) {
      // Create an ObservableCollection to store FuelItem objects
      ObservableCollection<FuelItem> fuelList = new ObservableCollection<FuelItem>();
      // Loop through each FuelItem in the current TankstellenItem
      foreach(FuelItem fItem in tItem) {
           // Add the FuelItem from current TankstellenItem to the ObservableCollection
           Debug.WriteLine("HERE AGAIN: " + fItem.Price);
           completeList.Add(new TankstellenItem() {
                // Add the FuelItem
                Fuels = new ObservableCollection<FuelItem>() { 
                     fItem,
                };
           }
      }

 } 
```

虽然，如果您只关心`FuelItem`s，拥有 FuelItems 的集合而不是将它们包装在`TankstellenItem`.

```
 ObservableCollection<FuelItem> completeList = new ObservableCollection<FuelItem>();
 foreach(TankstellenItem tItem in listItem) {
      foreach(FuelItem fItem in tItem) {
           completeList.Add(fItem);
      }
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T14:31:54.303

Linq 可能会让这更容易：你真的想要

```
var completelist=listItem.SelectMany(
       i=>i.Fuels.Select(
          f=>new TankstellenItem { Fuels=new ObservableCollection<FuelItem>(new[] { f})}
       )
   ).ToList(); 
```

# javascript - jquery modal-dialog 按钮关闭不能正常工作

> ID：13361662
> 
> 赞同：0
> 
> 时间：2012-11-13T13:34:58.633
> 
> 标签：javascript, button, modal-dialog

```
$(function () {
        $('#modalDlg2').live("click", function (event) {
            event.preventDefault();
            loadDialog(event, "/User/Create");
        });
        function loadDialog(event, target) {
            var $dialog = $('<div></div>');
            $dialog.empty();
            $dialog
    .load(target)
    .dialog({
    title:"Novo utilizador",
        modal: true,
        autoOpen: false,
        width: 600,
        show:'fade',
        hide:'fade',
        minHeight: 400,
        resizable: false
    });

     $dialog.dialog( "option", "buttons", {
            "Cancelar": function() { 
                    $(this).dialog("close");
                    $(this).empty();
                }         });
            $dialog.dialog('open');
        }            
    }) 
```

我的关闭按钮“Cancelar”有问题，它应该关闭模式对话框然后清空它，但似乎 $(this).dialog("close") 不起作用，而 .empty() 起作用。
我一直在寻找我的问题的解决方案。谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:43:12.803

我会尝试将其放入负载的回调函数中：

```
$(function() {
    $('#modalDlg2').on("click", function(event) {
        event.preventDefault();
        loadDialog(event, "/User/Create");
    });

    function loadDialog(event, target) {
        var $dialog = $('<div></div>');
        $dialog.empty();
        $dialog.load(target, function() {
            $dialog.dialog({
                title: "Novo utilizador",
                modal: true,
                autoOpen: false,
                width: 600,
                show: 'fade',
                hide: 'fade',
                minHeight: 400,
                resizable: false
            });

            $dialog.dialog("option", "buttons", {
                "Cancelar": function() {
                    $(this).dialog("close");
                    $(this).empty();
                }
            });
            $dialog.dialog('open');
        });
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:45:03.380

试试这个：

```
$dialog.dialog( "option", "buttons", {
    "Cancelar": function() { 
            $dialog.dialog("close");
            $(this).empty();
    }
});
$dialog.dialog('open'); 
```

或者

```
$dialog.dialog( "option", "buttons", {
   "Cancelar": $.proxy(function() { 
        $(this).dialog("close");
        $(this).empty();
    },this)         
});
$dialog.dialog('open'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-08T06:00:15.873

试试下面的代码：

```
$dialog.dialog("option", "buttons", { "Cancelar": function() { $(this).remove(); } }); 
```

# mysql - 计算多个属性sql

> ID：13361664
> 
> 赞同：0
> 
> 时间：2012-11-13T13:35:09.057
> 
> 标签：mysql, sql

我正在寻找以下输出

*   10 位客户在 2 个产品组中购买了 10 件商品
*   8 位客户在 1 个产品组中购买了 10 件商品。

通常是一个矩阵，其中客户计数超过购买的项目和产品组，即。计算超过 2 个属性（项目和产品组）

我尝试了下面的代码，但它只给了我

*   1 位客户拥有 10 个项目和 2 个产品组
*   1 位客户拥有 10 件商品和 1 个产品组，尽管每行中有更多客户：

片段，

```
count (distinct customer_id) over (Partition by customer_id) as Customer_ID
,count (distinct customer_shipment_item_id) Over (Partition by customer_id) as customer_items
,count (distinct product_group) Over (Partition by customer_id) as customer_product_groups 
```

你能解释一下这是如何工作的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:49:18.673

我认为这样的事情会给你你正在寻找的东西：

```
SELECT    COUNT(customer_id) Customer_ID, customer_items, customer_product_groups

FROM 

(SELECT   customer_id, COUNT(DISTINCT customer_shipment_item_id) as customer_items,
          COUNT(DISTINCT product_group) as customer_product_groups
 FROM     TABLENAME
          JOIN <YOUR JOINS>
 WHERE    customer_id IN (SELECT customer_ID FROM <YOUR JOINS> WHERE customer_shipment_item_id = x)
 GROUP BY customer_id
) a

GROUP BY customer_items, customer_product_groups 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:45:55.420

尝试这个。除非我不明白您在寻找什么，否则您不需要 Partition By 子句。

```
count (distinct customer_id) as Customer_ID
,count (distinct customer_shipment_item_id) as customer_items
,count (distinct product_group) as customer_product_groups 
```

# iphone - 取消通话后返回应用程序

> ID：13361668
> 
> 赞同：4
> 
> 时间：2012-11-13T13:35:15.437
> 
> 标签：iphone, objective-c, ios6, uiapplication, telprompt

我想在`telprompt://`调用后使用方案返回到我的应用程序。但我有一个问题。

如果对方忙，我会看到两个按钮：重拨和取消。因此，如果我按取消，我将不会返回我的应用程序。有什么办法可以处理吗？

PS 不在`telprompt://`私有 API 中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:37:14.227

在这里您可以使用 WebView 并在其上加载请求。

```
 UIWebView *callWebview = [[UIWebView alloc] init];   
 NSURL *telURL = [NSURL URLWithString:[NSString stringWithFormat:@"tel://%@", phoneNumber]
 [callWebview loadRequest:[NSURLRequest requestWithURL:telURL]]; 
```

我敢肯定它会与 Charm 一起使用.....

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-15T03:10:29.587

我认为你需要：

```
[[UIApplication sharedApplication] openURL: [NSURL URLWithString:[NSString stringWithFormat:@"telprompt:%@",num]]]; 
```

# opengl - VBO：没有正确绘制。手工绘图作品

> ID：13361671
> 
> 赞同：4
> 
> 时间：2012-11-13T13:35:24.150
> 
> 标签：opengl

所以我需要编辑这个问题。如其中一条评论所述，我更改为使用缓冲区的渲染方法。但是，几何图形未正确绘制。如果我使用相同的缓冲区并手动绘制顶点，它看起来还不错（虽然没有纹理，但有些东西搞砸了）。我也尝试用顶点信息构建一个缓冲区，但这根本没有帮助。

```
void ModelHandler::DrawModels(){

    //go through each of the models
    for(int i=0;i<Models3D.size();i++){

        //glEnableClientState(GL_VERTEX_ARRAY);
        //glVertexPointer(3, GL_FLOAT, 0, Models3D[i]->object.m_pVertice);

        //now draw all the material groups with their vertices for the model
        for(int j=0;j<Models3D[i]->object.mtlGroups.size();j++){

            //Drawing the vertices manually from the buffer object seems to work
            /*
            for(int lj=0;lj<Models3D[i]->object.mtlGroups[j]->m_vecgroupVerticeIndex.size();lj++){

                int mtlIndex2 = Models3D[i]->object.FindMaterial(Models3D[i]->object.mtlGroups[j]->mtlName);
                bool tOn = false;

                //check if there was a texture for this material
                if(Models3D[i]->object.materials[mtlIndex2]->texturePresent){

                    glEnable(GL_TEXTURE_2D);
                    //glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL);
                    glBindTexture(GL_TEXTURE_2D, Models3D[i]->object.materials[mtlIndex2]->textureIDDiffuse);
                    tOn = true;

                }

                if(tOn){
                    glBegin (GL_QUADS);
                    glTexCoord2f (0.0, 0.0);
                    glVertex3f (0.0+5, 0.0, -2.0f);
                    glTexCoord2f (1.0, 0.0);
                    glVertex3f (1.4f+5, 0.0, -2.0f);
                    glTexCoord2f (1.0, 1.0);
                    glVertex3f (1.4f+5, -1.0, -2.0f);
                    glTexCoord2f (0.0, 1.0);
                    glVertex3f (0.0f+5, -1.0, -2.0f);
                    glEnd ();               
                }

                glBegin(GL_TRIANGLES);

                glColor3f(Models3D[i]->object.mtlGroups[j]->VBO[lj*3].colour[0],Models3D[i]->object.mtlGroups[j]->VBO[lj*3].colour[1],Models3D[i]->object.mtlGroups[j]->VBO[lj*3].colour[2]);
                if(tOn){
                glTexCoord2f (Models3D[i]->object.mtlGroups[j]->VBO[lj*3].tex[0], Models3D[i]->object.mtlGroups[j]->VBO[lj*3].tex[1]);
                }
                glVertex3f(Models3D[i]->object.mtlGroups[j]->VBO[lj*3].location[0], Models3D[i]->object.mtlGroups[j]->VBO[lj*3].location[1], Models3D[i]->object.mtlGroups[j]->VBO[lj*3].location[2]);

                glColor3f(Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].colour[0],Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].colour[1],Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].colour[2]);
                if(tOn){
                glTexCoord2f (Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].tex[0], Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].tex[1]);
                }
                glVertex3f(Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].location[0], Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].location[1], Models3D[i]->object.mtlGroups[j]->VBO[lj*3+1].location[2]);

                glColor3f(Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].colour[0],Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].colour[1],Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].colour[2]);
                if(tOn){
                glTexCoord2f (Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].tex[0], Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].tex[1]);
                }
                glVertex3f(Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].location[0], Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].location[1], Models3D[i]->object.mtlGroups[j]->VBO[lj*3+2].location[2]);

                glEnd();

            }
            glDisable(GL_TEXTURE_2D);
            */

            //####
            glBindBuffer(GL_ARRAY_BUFFER, Models3D[i]->object.mtlGroups[j]->vboID);
            glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, Models3D[i]->object.mtlGroups[j]->indexvboID);

            /*
            //this could also be used BUT if glDrawElements uses the indices (m_pgroupVerticeIndex), we will need to give the array with all the 
            //vertices to glVertexPointer. That array would be m_pVertice
            //glVertexPointer(3, GL_FLOAT, 5, Models3D[i]->object.mtlGroups[j]->buffer);
            */

            glEnableClientState(GL_COLOR_ARRAY);
            glEnableClientState(GL_NORMAL_ARRAY);
            glEnableClientState(GL_VERTEX_ARRAY);

            //Get the material that belongs to this mtlGroup
            int mtlIndex = Models3D[i]->object.FindMaterial(Models3D[i]->object.mtlGroups[j]->mtlName);

            //check if there was a texture for this material
            if(Models3D[i]->object.materials[mtlIndex]->texturePresent){

                glEnable(GL_TEXTURE_2D);
                glTexEnvf(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL);
                glBindTexture(GL_TEXTURE_2D, Models3D[i]->object.materials[mtlIndex]->textureIDDiffuse);

                glEnableClientState(GL_TEXTURE_COORD_ARRAY);
                glTexCoordPointer(2, GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(12));
                //glTexCoordPointer(2, GL_FLOAT, 5, Models3D[i]->object.mtlGroups[j]->buffer);
                //glTexCoordPointer(2, GL_FLOAT, 0, Models3D[i]->object.m_pTexture);

            }

            // Resetup our pointers.  This doesn't reinitialise any data, only how we walk through it
            glNormalPointer(GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(20));
            glColorPointer(3, GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(32));
            glVertexPointer(3, GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(0));

            glDrawElements(GL_TRIANGLES, Models3D[i]->object.mtlGroups[j]->m_vecgroupVerticeIndex.size()*3, GL_UNSIGNED_BYTE, BUFFER_OFFSET(0));

            //glDrawElements(GL_TRIANGLES, Models3D[i]->object.mtlGroups[j]->m_vecgroupVerticeIndex.size()*3, GL_UNSIGNED_INT,  Models3D[i]->object.mtlGroups[j]->m_pgroupVerticeIndex);

            glDisableClientState(GL_TEXTURE_COORD_ARRAY);
            glDisableClientState(GL_COLOR_ARRAY);
            glDisableClientState(GL_NORMAL_ARRAY);
            glDisableClientState(GL_VERTEX_ARRAY);

            glDisable(GL_TEXTURE_2D);

        }

    }

} 
```

我的缓冲区包含顶点（顶点结构数组）：

```
struct Vertex {

    GLfloat location[3];
    GLfloat tex[2];
    GLfloat normal[3];
    GLfloat colour[3];
    GLubyte padding[20];        //apparently to get 64 bytes -> improved performance

}; 
```

以下是我为每种材料初始化/生成缓冲区的方法：

```
//This function was implemented based on the tutorial shown at
//http://sdickinson.com/wordpress/?p=122

void CObjLoader::GenerateVBO(){

    for(int mj=0;mj<mtlGroups.size();mj++){

        glGenBuffers(1, &mtlGroups[mj]->vboID);
        //printf("bufferID: %d", mtlGroups[mj]->vboID);

        glBindBuffer(GL_ARRAY_BUFFER, mtlGroups[mj]->vboID); // Bind the buffer (vertex array data)

        // Allocate space.  We could pass the mesh in here (where the NULL is), but it's actually faster to do it as a 
        // seperate step.  We also define it as GL_STATIC_DRAW which means we set the data once, and never 
        // update it.  This is not a strict rule code wise, but gives hints to the driver as to where to store the data
        glBufferData(GL_ARRAY_BUFFER, sizeof(Vertex) * mtlGroups[mj]->m_vecgroupVerticeIndex.size()*3, NULL, GL_STATIC_DRAW);
        glBufferSubData(GL_ARRAY_BUFFER, 0, sizeof(Vertex) * mtlGroups[mj]->m_vecgroupVerticeIndex.size()*3, mtlGroups[mj]->VBO); // Actually upload the data

        // Set the pointers to our data.  Except for the normal value (which always has a size of 3), we must pass 
        // the size of the individual component.  ie. A vertex has 3 points (x, y, z), texture coordinates have 2 (u, v) etc.
        // Basically the arguments are (ignore the first one for the normal pointer), Size (many components to 
        // read), Type (what data type is it), Stride (how far to move forward - in bytes - per vertex) and Offset 
        // (where in the buffer to start reading the data - in bytes)

        // Make sure you put glVertexPointer at the end as there is a lot of work that goes on behind the scenes
        // with it, and if it's set at the start, it has to do all that work for each gl*Pointer call, rather than once at
        // the end.
        glTexCoordPointer(2, GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(12));
        glNormalPointer(GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(20));
        glColorPointer(3, GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(32));
        glVertexPointer(3, GL_FLOAT, sizeof(Vertex), BUFFER_OFFSET(0));

        // When we get here, all the vertex data is effectively on the card

        // Our Index Buffer, same as above, the variable needs to be accessible wherever we draw
        glGenBuffers(1, &mtlGroups[mj]->indexvboID); // Generate buffer
        glBindBuffer(GL_ELEMENT_ARRAY_BUFFER, mtlGroups[mj]->indexvboID); // Bind the element array buffer
        // Upload the index array, this can be done the same way as above (with NULL as the data, then a 
        // glBufferSubData call, but doing it all at once for convenience)
        glBufferData(GL_ELEMENT_ARRAY_BUFFER, mtlGroups[mj]->m_vecgroupVerticeIndex.size()*3*sizeof(GLubyte), mtlGroups[mj]->index, GL_STATIC_DRAW);

    }

} 
```

为简单起见，我的索引数组如下所示：0,1,2,3,4,5,...。这意味着我的缓冲区包含一些顶点两次。因此 VBO 和索引具有相同的长度。

也许我在初始化时搞砸了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T17:14:03.413

所以错误如下（我将复制我之前解释解决方案的评论）：

*好的，我发现了错误。显然，我使用 GLubyte 作为索引，就我而言，我有超过 255 个顶点。更改为 GLuint 已解决该问题。但是，我的纹理仍未正确绘制到对象上。对象保持灰色。但颜色似乎有效。*

.obj 加载器现在产生了更好的结果，并且可以使用更简单的模型。我会做一些进一步的测试，如果有问题，我会回来的。

# javascript - 使用 span 标签将数字包装在 javascript 字符串中

> ID：13361672
> 
> 赞同：1
> 
> 时间：2012-11-13T13:35:29.910
> 
> 标签：javascript, string

我有一个以 X,XXX 格式生成的数字（所以它有逗号）。数字需要设置样式（黑色背景和白色文本），而逗号需要保持原样。

无论如何，我试图在字符串中的每个数字周围添加一个跨度，但它似乎不起作用。

```
function numberWithCommas(x) {
    var parts = x.toString().split(".");
    parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    var stylednumbers = parts.join(".");
    var stylednumbers = stylednumbers.replace(/([0-9]+\.)/, '<span class="counternumber">$1</span>');
    return stylednumbers;
} 
```

我是一个 javascript 新手（也避免使用 jQuery，因为它是 WordPress），但热衷于让它工作。关于我哪里出错的任何想法？

如果您需要任何进一步的信息，我将很乐意提供。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:10:33.460

我想你希望你的正则表达式是`/([0-9]+)/g`，否则只有你号码的最后三位数字会被跨越。

# zend-framework - 在 url 中添加单引号

> ID：13361673
> 
> 赞同：0
> 
> 时间：2012-11-13T13:35:38.667
> 
> 标签：zend-framework

所以我有一个网站（没有开发它），你有这样的网址：

```
http://mysite.com/profile-user/profile/nameOfUser 
```

这是一个使用 Zend 开发的站点，我已经不喜欢 url 配置，我认为它很冗长，但这不是真正的问题。

如果我这样做：

```
http://mysite.com/profile-user/profile/' 
```

在用户名中添加单引号，我收到一堆 zend 错误消息：

```
Exception information:

        Message: Mysqli prepare error: You have an error in your SQL syntax;
     check the manual that corresponds to your MySQL server version for the
 right syntax to use near '''') LIMIT 1' at line 1
        Stack trace: 
```

然后跟随堆栈跟踪

然后

```
Request Parameters:

    array (
      'profil' => '\'',
      'module' => 'default',
      'controller' => 'journalentrepreneur',
      'action' => 'index',
      'tab' => 'profil',
    ) 
```

那应该是什么意思？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:40:29.040

这意味着该站点的 URL 导致查询被直接发送到 MySQL 数据库，从安全的角度来看，这充其量是危险的！如果您不确定我指的是什么，请查看 SQL 注入。

看起来不像 Zend 框架，你需要看网站本身的编码——URL 结构是如何构建的？

您对站点的配置没有说太多，但假设它在 Apache 服务器上，请查看重写规则和它所引用的 PHP 文件 - 您需要在此处包含一些示例代码以使我们能够为您提供更多帮助。无论哪种方式，您都需要在完成之前做一些工作以正确保护网站，所以要小心！

# .net - 使用 Linq-to-XSD 进行 XML 验证

> ID：13361674
> 
> 赞同：1
> 
> 时间：2012-11-13T13:35:51.310
> 
> 标签：.net, xsd, linq-to-xsd

我已经`linq-to-xsd`使用多个生成了类代码`XSD schemas`。我想验证一个`XML`使用已经创建的类而不是每次`xsd`文件都使用的类。

谢谢。

# ruby - 彩虹工人在超时后被杀死，即使它回复了

> ID：13361676
> 
> 赞同：0
> 
> 时间：2012-11-13T13:36:01.050
> 
> 标签：ruby, sinatra, unicorn, rainbows

我有一个在 Rainbows 上运行的 Sinatra 应用程序。我记录以下内容：

```
before do
  logger.info("#{Process.pid} #{Time.now} #{request.ip} #{request.path_info} #  {params.to_s}")
end 
```

和

```
after do
  logger.info("#{Process.pid} #{Time.now} #{request.ip} #{request.path_info} #{params.to_s} => #{response.headers['X-API-Status']} (#{response.successful?})")
end 
```

在我的日志中我可以阅读：

```
25988 2012-11-13 11:57:52 +0100 192.168.90.1 /req {"u"=>"810000027"}
25988 2012-11-13 11:57:59 +0100 192.168.90.1 /req {"u"=>"810000027"} => 200 (true)
192.168.90.1 - - [13/Nov/2012 11:57:59] "POST /req HTTP/1.1" **200** 14 7.5862
25988 2012-11-13 11:57:59 +0100 192.168.90.1 /req {"u"=>"810000027"}
25988 2012-11-13 11:57:59 +0100 192.168.90.1 /req {"u"=>"810000027"} => 200 (true)
192.168.90.1 - - [13/Nov/2012 11:57:59] "POST /req HTTP/1.1" 200 14 0.0223
E, [2012-11-13T11:58:04.099913 #25875] ERROR -- : worker=2 PID:**25988** timeout (12s > 11s), killing
E, [2012-11-13T11:58:04.106428 #25875] ERROR -- : reaped #<Process::Status: pid 25988 SIGKILL (signal 9)> worker=2 
```

我的工人（pid 25988）被杀死，好像它没有响应第一个请求......但它显然已经！它甚至处理了另一个请求（我使用基本并发模型-> 无并发）

我的彩虹配置是：

```
Rainbows! do
 timeout(10) 
end

listen(3000)
pid('/tmp/rainbows.pid')
stderr_path('/var/log/rainbows.log')
stdout_path('/var/log/rainbows.log')
working_directory('/opt/app')
worker_processes(4) 
```

你知道会发生什么吗？或者我该如何进一步调查？谢谢 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T14:56:29.423

实际上问题在于客户端（闪存）“保持活动状态”太久的请求。显然没有办法[正确关闭 AS3 中的 tcp 连接](https://stackoverflow.com/questions/12751136/as3-how-to-shutdown-tcp-connection)......

我解决了我的问题：

```
Rainbows! do
  keepalive_timeout(0)
end 
```

无论如何，这对我来说似乎很合适。

# regex - 谷歌分析正则表达式 - 替代无负前瞻

> ID：13361680
> 
> 赞同：6
> 
> 时间：2012-11-13T13:36:39.037
> 
> 标签：regex, google-analytics

谷歌分析不再允许在其过滤器中进行负前瞻。事实证明，要创建仅包含我希望包含的链接的自定义报告非常困难。

如果启用它，包含负前瞻的正则表达式将起作用：

```
test.com(\/\??index\_(.*)\.php\??(.*)|\/\?(.*)|\/|)+(\s)*(?!.) 
```

这匹配：

```
test.com
test.com/
test.com/index_fb2.php
test.com/index_fb2.php?ref=23
test.com/index_fb2.php?ref=23&e=35
test.com/?ref=23 
test.com/?ref=23&e=35 
```

并且不匹配（应该如此）：

```
test.com/ambassadors
test.com/admin/?signup=true 
test.com/randomtext/ 
```

我正在寻找如何调整我的正则表达式以仍然保持相同的匹配但不使用负前瞻。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T16:04:52.890

Google Analytics 似乎不支持单行和多行模式，这对我来说很有意义。URL 不能包含换行符，因此如果点与它们不匹配并不重要，并且除了整个字符串的开头和结尾之外，永远不需要`^`and匹配任何地方。`$`

这意味着`(?!.)`您的正则表达式中的 完全等同于`$`，它仅在字符串的最后匹配（例如`\z`，在支持它的风格中）。由于这是您的正则表达式中唯一的前瞻，您不应该遇到这个问题；你应该一直在使用`$`。

但是，您的正则表达式还有其他问题，主要是由于过度依赖`(.*)`. 例如，它匹配这些字符串：

```
test.com/?^#(%)!*%supercalifragilisticexpialidocious
test.com/index_ecky-ecky-ecky-ecky-PTANG!-vroop-boing_rowr.php (ni! shh!) 
```

...我很确定你不想要。:P

试试这个正则表达式：

```
test\.com(?:/(?:index_\w+\.php)?(?:\?ref=\d+(?:&e=\d+)?)?)?\s*$ 
```

或更易读：

```
test\.com
(?:
  /
  (?:index_\w+\.php)?
  (?:
    \?ref=\d+
    (?:
      &e=\d+
    )?
  )?
)?
\s*$ 
```

出于说明目的，我对（例如）可以存在哪些参数、它们将出现的顺序以及它们的值可以是什么进行了很多简化假设。我也想知道是否真的有必要匹配域（`test.com`）。我没有使用 Google Analytics 的经验，但比赛不应该在域*之后立即开始（并锚定）吗？*你真的必须在最后允许空格吗？在我看来，正则表达式应该更像这样：

```
^/(?:index_\w+\.php)?(?:\?ref=\d+(?:&e=\d+)?)?$ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:45:11.303

首先，我认为您的正则表达式需要一些修复。让我们看看你有什么：

```
test.com(\/\??index_.*.php\??(.*)|\/\?(.*)|\/|)+(\s)*(?!.) 
```

第二种选择已经处理了您`?`在开头使用 optional 的情况：`index...`

```
test.com(\/index_.*.php\??(.*)|\/\?(.*)|\/|)+(\s)*(?!.) 
```

现在你可能只希望第一个`(.*)`被允许，如果之前确实有一个文字`?`。否则你会匹配`test.com/index_fb2.phpanystringhereandyouprobablydon'twantthat`。所以移动相应的可选标记：

```
test.com(\/index_.*.php(\?(.*))?|\/\?(.*)|\/|)+(\s)*(?!.) 
```

现在`.*`尽可能多地消耗任何角色。此外，`.`前面的`php`消耗任何字符。这意味着您将同时允许`test.com/index_fb2php`和`test.com/index_fb2.html?someparam=php`。让我们把它变成文字`.`并且只允许非问号字符：

```
test.com(\/index_[^?]*\.php(\?(.*))?|\/\?(.*)|\/|)+(\s)*(?!.) 
```

现在第一个、第二个和第三个选项可以合并为一个，如果我们也将文件名设为可选：

```
test.com(\/(index_[^?]*\.php)?(\?(.*))?|)+(\s)*(?!.) 
```

最后，`+`可以删除，因为`(.*)`内部已经可以处理所有可能的重复。也`(something|)`与`(something)?`：

```
test.com(\/(index_[^?]*\.php)?(\?(.*))?)?(\s)*(?!.) 
```

看到您的输入示例，这似乎更接近您实际想要匹配的内容。

然后回答你的问题。什么`(?!.)`取决于您是否使用`singleline`模式。如果你这样做了，它就断言你已经到达了字符串的末尾。在这种情况下，您可以简单地将其替换为`\Z`，它始终匹配字符串的结尾。如果你不这样做，那么它断言你已经到了一行的末尾。在这种情况下，您可以使用`$`，但您还需要使用多行模式，以便也`$`匹配行尾。

因此，如果您使用`singleline`模式（这可能意味着每个字符串只有一个 URL），请使用以下命令：

```
test.com(\/(index_[^?]*\.php)?(\?(.*))?)?(\s)*\Z 
```

如果您不使用`singleline`模式（这可能意味着您可以在自己的行中有多个 URL），您还应该使用`multiline`模式和这种锚点：

```
test.com(\/(index_[^?]*\.php)?(\?(.*))?)?(\s)*$ 
```

# .net - 如何不删除其他对象引用的缓存项

> ID：13361683
> 
> 赞同：4
> 
> 时间：2012-11-13T13:36:48.723
> 
> 标签：.net, design-patterns, caching, memory-management

我假设一个代表某物的对象，你在内存中只能有一个实例。我避免重复和等于对象。

1.  假设一个对象由 类型的“New York”唯一标识`City`，包含在缓存中（扩展 `System.Runtime.Caching.ObjectCache`）。该对象被另一个名为`MyBusinessObject`

2.  缓存删除了“New York”对象，但该对象`MyBusinessObject`仍指“New York”。垃圾收集器不会从内存中删除这个对象，因为仍然有引用。

3.  另一个对象从缓存中请求“纽约”。`City`缓存加载“纽约”的新实例

现在有两个“New York”实例，一个`MyBusinessObject`是引用（无效），另一个是缓存引用的“New York”实例。

有没有一种设计模式可以解决这个问题？我不想`MyBusinessObject`使用`City`.

一种可能的解决方案不会消除被引用的缓存对象，但是，如何做到这一点？

这是我在上面试图解释的 UML 图：

![类图 UML](../Images/f5f2f98639561e9d8b46caaa6fcbe5ef.png)

![对象图](../Images/23f4761e37a1d45113adf4f9d3ce1a81.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T14:27:29.203

在这种情况下，您的缓存不应缓存*实际*对象，而是缓存对象的包装器，该包装器还包含有关缓存中对象状态的信息。

例如，您可以有一个像这样的简单类，表示缓存中的项目：

```
public class CacheItem<T>
{
    // Since the cache is the only thing
    // that should be making CacheItems,
    // make this internal to the assembly
    // that the cache is implemented in.
    // This constructor is called before
    // an add.
    internal CacheItem(T item)
    {
        // Set the property values.
        Item = item;
    }

    // Poor-man's immutability.
    public T Item { get; private set; }

    // The backing field for IsCached, it
    // is volatile so that it can serialize
    // access for single reads/writes, which is
    // what the property does.
    // Assume it is being added when constructed.
    private volatile bool _isCached = true;

    // Only able to be set by the cache.
    // The setter is set to false when the item
    // is stale (not in the cache any longer).
    public bool IsCached 
    {
        get { return _isCached; }
        set { _isCached = value; } 
    }
} 
```

这里的想法很简单：

*   当你的缓存即将向缓存中输入一个项目的新实例时，它会调用构造函数（构造函数应该*只*对缓存可用，如果需要，你可以`CacheItem`使用私有构造函数而不是内部构造嵌套类）它将`IsCached`属性值设置为 true。然后将该项目放置在缓存中。

*   当项目从缓存中过期时，缓存将该`IsCached`属性设置为 false（同样，该属性应该只能由缓存访问）。

*   责任转移到*客户端*来检查`CacheItem<T>`它是否过时。

请注意，这是一个拉操作。如果需要，您可以通过添加事件来添加*推送*`CacheItem<T>`操作支持，如下所示：

```
public class CacheItem<T>
{
    // Since the cache is the only thing
    // that should be making CacheItems,
    // make this internal to the assembly
    // that the cache is implemented in.
    // This constructor is called before
    // an add.
    internal CacheItem(T item)
    {
        // Set the property values.
        Item = item;
    }

    // Poor-man's immutability.
    public T Item { get; private set; }

    // The lock for the event registrations.
    // Since everything else is immutable, this needs
    // to be as well.
    private readonly object _eventLock = new object();

    // The backing field for the Expired
    // event.  Since everything else is immutable
    // this needs to be as well.
    private readonly EventHandler _expiredHandlers;

    // The expires event.
    public event EventHandler Expired
    {
        add { lock (_eventLock) _expiredHandlers += value; }
        remove { lock (_eventLock) _expiredHandlers -= value; }
    }

    // The backing field for IsCached, it
    // is volatile so that it can serialize
    // access for single reads/writes, which is
    // what the property does.
    // Assume it is being added when constructed.
    private volatile bool _isCached = true;        

    // The setter is set to false by the 
    // Expire method (called by the cached)
    // when the item is stale 
    // (not in the cache any longer).
    public bool IsCached { get { return _isCached; } }

    // Called internally by the cache.
    internal void Expire()
    {
        // Set _isCached to false.
        _isCached = false;

        // Get the event handlers and fire
        // the event.  Getting the handlers
        // needs to be synchronized.
        EventHandler handlers;

        // Synchronize.
        lock (_eventLock) handlers = _expiredHandlers;

        // Fire if there are handlers.
        if (handlers != null) handlers(this, EventArgs.Empty);
    }
} 
```

现在，您可以让您的客户端订阅该`Expired`事件，这将在缓存项无效时向客户端指示。`Expire`当它从缓存中删除时，缓存会通过调用该项目的内部事件来触发它（并且它也会将该`IsCached`属性设置为 false）。

# c# - 如何将控制事件设置为 null

> ID：13361690
> 
> 赞同：-2
> 
> 时间：2012-11-13T13:37:17.760
> 
> 标签：c#, visual-studio, events

H，

我有一个事件设置为 ItemChecked 的 listView，现在我需要执行以下操作：

```
var tmp = this.listView.ItemChecked;
this.listView.ItemChecked = null; //set the event to null

// run some code which checkes some item in the list
// wehre the event shouldnt get fired on

this.listView.ItemChecked = tmp; //set the event again 
```

问题是我无法阅读该事件，我得到的消息是它只能在语句的左侧使用。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:41:07.243

```
this.listView.ItemChecked -= myEventHandler;

// run some code

this.listView.ItemChecked += myEventHandler; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:41:22.673

您可以取消订阅并重新订阅以执行您想要执行的操作：

```
private void listView1_ItemChecked(object sender, ItemCheckedEventArgs e)
{
    listView1.ItemChecked -= new ItemCheckedEventHandler(listView1_ItemChecked);

    // do stuff

    listView1.ItemChecked += new ItemCheckedEventHandler(listView1_ItemChecked);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:53:17.130

您可以删除然后添加事件处理程序。假设您的代码位于名为 ItemChecked 的方法中

```
listView.ItemChecked -= ItemChecked;

// do whatever

listView.ItemChecked += ItemChecked; 
```

但是，我更喜欢检查重入呼叫。

```
object alreadyInItemChecked;

void ItemChecked(object s, EventArgs e)
{
   if (Monitor.TryEnter(alreadyInItemChecked))
   {
      try
      {
          // do whatever
      }
      finally
      {
          Monitor.Exit(alreadyInItemChecked)
      }
   }
 } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:44:01.727

您可以像这样订阅/取消订阅事件。

```
 this.someObject.someObjectEvent += someEventHandler;
        this.someObject.someObjectEvent -= null; 
```

因此，当您希望触发事件时订阅并在不需要时取消订阅。

# java - 尝试将双精度值插入 Oracle 数据库时出现 SQLException

> ID：13361692
> 
> 赞同：8
> 
> 时间：2012-11-13T13:37:26.427
> 
> 标签：java, sql, string, oracle11g, ora-00913

我必须开发一个将一些数据插入 Oracle 数据库的小程序。不幸的是，我在 SQL`Statement`及其执行方面遇到了一些麻烦。这是我正在使用的代码：

```
db.execute(
    String.format("INSERT INTO tops VALUES (%d, '%s', %d, %f.00, '%s', TO_TIMESTAMP('%s', 'YYYY-MM-DD HH24:MI:SS.FF'))", 
        item.getID(),
        item.getTitle(),
        this.elements,
        item.getSize(),
        item.getEntity(),
        timestamp.toString())); 
```

这是执行应该工作的部分，但我收到以下错误：

```
java.sql.SQLException: ORA-00913: Zu viele Werte 
```

[谷歌翻译](http://translate.google.com/#auto/en/Zu%20viele%20Werte)例外是：

```
java.sql.SQLException: ORA-00913: Too many values 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:55:47.067

您可以使用 Guallaume 在评论中建议的这样的准备好的陈述；

```
PreparedStatement pstmt = null;
Connection conn = null;

try{
     //if you have a method that creates a connection for you.
     conn = getConnection();
     pstmt = conn.prepareStatement("INSERT INTO tops(id, title, elements, size, entity, timeStamp) VALUES(?,?,?,?,?,?)");
     pstmt.setInt(1,item.getID());

     //Assuming that title is a String data type
     pstmt.setString(2,item.getTitle());
     pstmt.setString(3,this.elements);
     pstmt.setDouble(4,item.getSize()); // <--- JDBC will make sure this works

     //assuming Entity data type is String
     pstmt.setString(5,item.getEntity());

     //if your timestamp's string format is 
     //well formed, you may insert as a string.
     pstmt.setString(6,timestamp.toString());
     pstmt.executeUpdate();
}catch(Exception e){
     e.printStackTrace();
}finally{  
     try{
         pstmt.close();
     }catch(Exception e){}

     try{
         conn.close();
     }catch(Exception e){}
 } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T13:44:38.580

不要使用这种语法

```
INSERT INTO table VALUES (val1, val2, ...) 
```

改用这个

```
INSERT INTO table (col1, col2, ...) VALUES (val1, val2, ...) 
```

表可能会改变。字段可能会被添加/删除/重新排序 - 如果您的`INSERT`语句再次中断。

当然，正如其他人所建议的那样，您应该使用准备好的语句来避免 SQL 注入和语法错误......想象一下，`item.getTitle()`这些中的任何一个

```
"a', 'b";
"a'); DROP TABLE tops;' ..."; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T14:11:14.300

你真的应该使用 PreparedStatements，相信我们......

但是，在这种情况下，问题很可能是您的语言环境使用逗号 ( `,`) 字符作为小数点。

所以 1/4 变成: `0,25`，而不是`0.25`数据库想要的！

为什么这是个问题？

看这个：

```
INSERT INTO SOMETABLE VALUES ( 0,25 );
INSERT INTO SOMETABLE VALUES ( 0, 25); 
```

两者都被视为具有**2 个**值，只是第一个对我们来说并不明显，他们使用逗号作为小数点......所以你必须将逗号更改为点，或者将语言环境更改为美国。

正确的：

```
INSERT INTO SOMETABLE VALUES ( 0.25); 
```

您可以使用[String.format(Locale l, String format, Object... args)](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#format%28java.util.Locale,%20java.lang.String,%20java.lang.Object...%29)通过提供适当的语言环境来指定字符串格式的语言环境。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T14:34:35.400

此格式字符串已更正。

```
"INSERT INTO tops VALUES (%f, '%s', %f, %.2f, '%s', TO_TIMESTAMP('%s', 'YYYY-MM-DD HH24:MI:SS.FF'))" 
```

不要为每个参数使用多个值，每个参数只使用一个，总共六个值。

# javascript - 检测子节点号

> ID：13361697
> 
> 赞同：0
> 
> 时间：2012-11-13T13:37:49.110
> 
> 标签：javascript

我正在尝试添加一个用于单击的事件侦听器，并且我想知道被单击的节点的位置

```
function evl(etna) {
    document.addEventListener("click", function (el) {
        alert("You clicked on " + 'the name of element that was clicked or his array code');
    }, false);
}; 
```

哪里`etna`是：

```
document.getElementsByTagName("*"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:40:24.983

```
function evl(etna){
    document.addEventListener("click",function (el) {
        var clickedElement = el.target || el.srcElement;
        alert("Link detected a click. Cancellable: "+clickedElement.name);
        for(var i = 0; i < etna.length; i++) {
            if(etna[i] === clickedElement) {
                //i is a position of an element in etna
                break;
            }
        }
      },false);
}; 
```

~~您可以使用`this`which 将指向单击的元素。~~ 至于[Phil H](https://stackoverflow.com/users/36537/phil-h) IE 8 不能那样工作。但无论如何，应该使用`.target`or `.srcElement`。也许得到它的id会更好。Name 属性对 div、span 等无效。

但是您也将事件附加到`document`. 这将指向一个文档。取而代之的是，您应该使用`el.target || el.srcElement`where`.target/.srcElement`是指向实际发生单击的节点的指针。

另外，我认为您无法获取数组（实际上是节点列表）中返回的元素的索引`document.getElementsByTagName("*")`（嗯，您可以获取该列表并在循环中遍历它并检查每个元素是否等于`this`）。另外，我不知道为什么需要它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:44:19.590

`etna`添加一个循环并为数组中的每个项目设置不同的事件侦听器：

```
function evl(etna){
    for(var i=0; i < etna.length; ++i) {
        (function() {
            var thisNode = etna[i];
            var localval = i;
            etna[i].addEventListener("click",function (el) {
                alert("Link detected a click. Cancellable: "+ thisNode.id + " which is id " + localval );
            },false);
        })();
    }
} 
```

工作jsfiddle：http: [//jsfiddle.net/5xDjE/](http://jsfiddle.net/5xDjE/)

立即调用的函数只是强制定义 and 的作用域`thisNode`，`localval`否则所有元素都会引用同一个变量（javascript 作用域很有趣）。

我建议不要使用索引（范围 via `localval`），因为它需要保留原始节点数组。由于节点会随时间而变化，并且 javascript 会为您进行引用计数，因此您希望避免使用这些长节点数组。

请注意`this`，在 IE8 及以下，并不总是有被点击的元素[指向全局窗口对象](http://www.sitepoint.com/javascript-this-event-handlers/)。

# forms - Flex formitem 标签对齐异常

> ID：13361699
> 
> 赞同：3
> 
> 时间：2012-11-13T13:37:49.420
> 
> 标签：forms, apache-flex

我给这个发了一个体面的头发致敬
**为什么在世界上，标签 1 和标签 2 有不同的垂直对齐方式？**

```
 <s:Form width="100%">
            <s:FormHeading width="100%" label="Heading" />
            <s:FormItem width="100%" label="Label 1">
                <s:HGroup verticalAlign="bottom">
                    <s:Label text="Size" fontSize="40"/>
                    <s:Label text="Mb"/>                        
                </s:HGroup>
            </s:FormItem>
            <s:FormItem width="100%" label="Label 2">
                <s:HGroup verticalAlign="middle">
                    <s:VGroup horizontalAlign="center">
                        <s:Label text="Set1" />
                        <s:Label text="{this.set1}" fontSize="40"/>
                        <s:Label text="Days" />
                    </s:VGroup>
                    <s:Label text="+" fontSize="40" />
                    <s:VGroup horizontalAlign="center">
                        <s:Label text="Set2" />
                        <s:Label text="{this.set2}" fontSize="40" />
                        <s:Label text="Days" />
                    </s:VGroup>
                </s:HGroup>
            </s:FormItem>
        </s:Form> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T14:16:01.233

错误或功能？a 的标签与' 内容`FormItem`的基线对齐。`FormItem`一张图片说了一千多个字，所以我会告诉你会发生什么：

![FormItem 基线](../Images/f9d5bc5771627dc62cabd1b730baf804.png)

所以它原来是一个功能（感谢提出这个问题：我自己直到今天才知道这个）。

为了“修复”这个特性，你必须创建一个自定义皮肤：通过复制原始的`spark.skins.spark.FormItemSkin`. 找到名为;
的元素 `labelDisplay`它应该是这样的：

```
<s:Label id="labelDisplay"
         fontWeight="bold"
         left="labelCol:0" right="labelCol:5" 
         bottom="row1:10" baseline="row1:0"/> 
```

看到那个`baseline`属性了吗？这就是导致不良行为的原因。
您可以简单地删除它；然后标签将始终与底部对齐。如果你想将它与垂直中心对齐，你可以像这样改变它：

```
<s:Label id="labelDisplay" fontWeight="bold" verticalAlign="middle"
         left="labelCol:0" right="labelCol:5" top="row1:10" bottom="row1:10"/> 
```

现在您需要做的就是将您的自定义皮肤应用到您的 FormItem：

```
<s:FormItem skinClass="my.custom.FormItemSkin"> 
```

或者在更频繁使用的情况下：

```
<fx:Style>
    @namespace s "library://ns.adobe.com/flex/spark";

    s|FormItem.centeredLabel {
        skinClass: ClassReference("my.custom.FormItemSkin");
    }
</fx:Style>

<s:FormItem styleName="centeredLabel"> 
```

# macos - Textmate 和 CUDA 的语法高亮显示

> ID：13361703
> 
> 赞同：2
> 
> 时间：2012-11-13T13:38:15.303
> 
> 标签：macos, cuda, textmate

有谁知道我如何在 Textmate for mac 中为 CUDA (.cu) 文件添加语法突出显示。如果他能将 .cu 文件识别为具有相同突出显示的 .c 文件，我就足够了。问题是如果我将它保存为 .cu 我没有任何突出显示。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T19:02:15.050

你可以下载“sublimetext-cuda-cpp”设计的这个[包。](https://github.com/harrism/sublimetext-cuda-cpp/archive/master.zip)

[通过将存储库克隆](https://github.com/harrism/sublimetext-cuda-cpp)到 Sublime Text 2 Packages 目录来安装包：

```
cd <package directory>
git clone git://github.com/harrism/sublimetext-cuda-cpp.git 
```

之后重新启动 Sublime Text，切换到 CUDA C++ 作为突出显示配置文件并使用上述命令之一进行尝试。

你的mac中没有安装git，你必须下载并安装它，[这里](https://help.github.com/articles/set-up-git)你有安装gif所需的所有文件和信息。

您也可以尝试为 TextMate使用[CTags 捆绑包。](http://svn.textmate.org/trunk/Bundles/CTags.tmbundle/)有关如何在[此处](http://gerd.knops.org/?p=7)安装它的所有详细信息。

或者，您也可以下载此[捆绑包](http://gerd.knops.org/files/CTags.tmbundle.zip)（在 TextMate 的尖端版本中），可以通过解压缩 zip 文件并双击 CTags.tmbundle 文件来安装它。捆绑包中提供了帮助。

# java - RequestMapping 不发生

> ID：13361704
> 
> 赞同：0
> 
> 时间：2012-11-13T13:38:17.563
> 
> 标签：java, javascript, spring, liferay, ipc

我试图通过呈现 URL 在两个 portlet 之间进行通信。

一个 portlet 显示了包含可用选项列表的表格。单击其中一个选项时，javascript 函数将呈现 URL，并且在第二个 portlet 中应显示有关单击项目的详细信息。

但是，它不起作用：URL 被正确呈现，在 URL 中具有正确的行 ID，但从`@RenderMapping(params)`不调用第二个 portlet 的方法，设置为。

在此先感谢第一个 portlet view.jsp：

```
<%@page import="java.util.List"%>
<%@page import="pl.spot.vorange.model.Project"%>
<%@ taglib uri="http://java.sun.com/portlet_2_0" prefix="portlet" %>

<div id="projectListDiv"  style="width: 100%;"></div>

<script type="text/javascript">
var pids = new Array();
var pnames = new Array();
var projectId = "${p.id}";
<%
List<Project> all = (List<Project>) request.getAttribute("all");
if(all!=null && !all.isEmpty()) {
int i = 0;
for(Project project : all) {
    out.println("pids[" + i + "]='"+project.getId()+"';\n");
    out.println("pnames[" + i + "]='"+project.getName()+"';\n");
    i++;
}
} else {
    out.println("brak projektów w zasięgu requestu");
}
%>

function createProjectList() {
var tags = "<table width='100%'>";

for(var i=0; i<pids.length; i++) {
    tags += "<tr class='projectTr'>";
    tags += "<td class='orangeArray' onClick='firePortletEvent2(" + pids[i] +  
")'> </td>";

    if(pids[i]!=projectId) {
        tags += "<td class='orangeTableItem' onClick='firePortletEvent2(" +
 pids[i] + ")'>";
    } else {
        tags += "<td class='orangeTableItemSel'  
 onClick='firePortletEvent2(" + pids[i] + ")'>";
    }

    tags += pnames[i] + "</td></tr>";
}

tags += "</table>";
el = document.getElementById("projectListDiv");
if(el!=null) {
    el.innerHTML = tags;
}
}
function firePortletEvent2(projectId) {
var url ="<portlet:renderURL />";   
prefix = "&_offer2_WAR_vorange_";
url += prefix+"a=getproject";
url += prefix+"page=expiring";
url += prefix+"tab=expiringOffers";
url += prefix+"pid="+encodeURI(projectId);
location = url;
}

createProjectList();
</script> 
```

单击其中一个项目会呈现 URL。

第二个 portlet 控制器：

```
@RenderMapping(params = "a=getproject")
public String getProject(RenderResponse response, RenderRequest request) {

    String pid = request.getParameter("pid");
    Project p = null;
    if (pid != null) {
        long id = Long.parseLong(pid);
        p = projectService.searchById(id);
        request.getPortletSession().setAttribute("project", p);
    }

    p = (Project) request.getPortletSession().getAttribute("project");
    request.setAttribute("p", p);

    return "view";
} 
```

我不知道它是否正常工作，因为从未调用过此方法。

我知道代码很乱，但我还没有写。我刚拿到它，我必须修复它。

如果这段代码永远无法工作，我不会感到惊讶，但我刚刚开始在 Liferay 上进行开发并且不知道很多事情。

# android - 根据屏幕尺寸强制加载所需的 dpi drawable

> ID：13361710
> 
> 赞同：5
> 
> 时间：2012-11-13T13:38:30.870
> 
> 标签：android, drawable, dpi, screen-size

我有 4 组图像

```
Resolutions        DPI      Directory
240 x 320          120dpi - drawable-ldpi
320 x 480          160dpi - drawable-mdpi
480 x 800          240dpi - drawable-hdpi
1280x 800          320dpi - drawable-xhdpi 
```

但是当我在华硕变压器上用分辨率测试它时`1280x800 and DPI 224`。它从 drawable-hdpi 加载图形。

如果我要添加另一个名为 drawable-xlarge 的文件夹，它将加载所需的图像，但也会增加应用程序的大小。

我的问题如下

1 - 支持所有屏幕尺寸和 DPI 的最佳做法是什么？

2 - 有没有办法强制加载特定DPI wrt屏幕尺寸的drawable？

3 - 在不复制图形的情况下，针对我的问题推荐的解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T13:48:33.140

> 但是当我在分辨率为 1280x800 和 dpi 224 的华硕变压器上对其进行测试时。它从 drawable-hdpi 加载图形。

那是因为华硕变压器是一种`-hdpi`设备。因此，它工作正常。

> 支持所有屏幕尺寸和 dpi 的最佳做法是什么？

通常，图像仅根据密度而变化，因此您当前的结构很好。

如果您选择在屏幕尺寸*和*密度上都不同的图像，您将需要`res/drawable-xlarge-hdpi/`为

> 有没有办法强制加载特定 dpi wrt 屏幕尺寸的可绘制对象？

密度和屏幕尺寸彼此无关。

> 在不复制图形的情况下，针对我的问题推荐的解决方案是什么？

根据您的“问题”，您没有问题。因此，没有针对您的非问题的建议。

# hadoop - Amazon S3 分段上传经常失败

> ID：13361717
> 
> 赞同：0
> 
> 时间：2012-11-13T13:39:00.057
> 
> 标签：hadoop, amazon-s3, amazon-ec2, amazon-emr

我正在尝试使用 s3cmd CLI将**32GB文件上传到 S3 存储桶。**它正在进行分段上传，并且经常失败。我正在使用具有 1000mbps 带宽的服务器执行此操作。但是上传还是很慢。我可以做些什么来加快速度吗？

另一方面，该文件位于我提到的服务器上的 HDFS 上。有没有办法引用 Amazon Elastic Map Reduce 作业来从这个 HDFS 中提取它？它仍然是上传，但作业也正在执行。所以整个过程要快得多。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T15:12:46.703

首先我承认我从来没有使用过 s3cmd 的 Multipart 功能，所以我不能说这个。但是，我过去曾使用[boto](https://github.com/boto/boto)将大型（10-15GB 文件）上传到 S3，并取得了很大的成功。事实上，这对我来说变得如此普遍，以至于我编写了一个[小实用程序](https://github.com/mumrah/s3-multipart)来使它更容易。

至于您的 HDFS 问题，您始终可以使用完全限定的 URI 引用 HDFS 路径，例如 hdfs://{namenode}:{port}/path/to/files。这假设您的 EMR 集群可以访问此外部 HDFS 集群（可能必须使用安全组设置）

# sql - 如何将存储过程的文本放入 SQL Server 2000 中的单个记录中？

> ID：13361722
> 
> 赞同：5
> 
> 时间：2012-11-13T13:39:19.517
> 
> 标签：sql, sql-server, tsql, sql-server-2000

通过以下脚本，我得到了数据库中的所有存储过程：

```
SELECT sm.id, OBJECT_NAME(sm.id) AS object_name, sm.text
FROM syscomments AS sm
JOIN sysobjects AS so ON sm.id = so.id
WHERE (so.status >= 0) AND (so.xtype = 'P') 
```

**我想为每个存储过程获取一行。**表 syscomments 中的文本字段是 nvarchar 4000。因此一个方法可能存储在多个寄存器中。问题是我有超过 15000 个字符的存储过程。

## 识别使用多条记录的 SP

```
SELECT sm.id, COUNT(sm.colid) AS Cantidad
INTO #SPrepeated
FROM  syscomments AS sm INNER JOIN
      sysobjects AS so ON sm.id = so.id
WHERE (so.status >= 0) AND (so.xtype = 'P') AND (so.category = 0)
GROUP BY sm.id, so.name
HAVING   (COUNT(sm.colid) > 1)

SELECT sm.id, OBJECT_NAME(sm.id) AS object_name, sm.text
into #Tresult
FROM syscomments AS sm
JOIN sysobjects AS so ON sm.id = so.id
JOIN #SPrepeated as spr ON so.id = spr.id
WHERE (so.status >= 0) AND (so.xtype = 'P')

select * from #Tresult

drop table #Tresult
drop table #SPrepeated 
```

在**#TResult**我有所有在表中有多个记录的存储过程`syscomments`。鉴于结果可能超过 8000 个字符，如何将它们分组并连接到每个过程的单个记录中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:23:59.363

如果您被迫使用 SQL Server 2000，您几乎必须使用`text`or`ntext`字段来分别超过 4000/8000 个字符的`nvarchar`限制`varchar`。

您不能在`text`和`ntext`字段上使用常规字符串命令，这使它变得一团糟。

如果您**真的**希望每个存储过程都在一行中，您可以尝试以下操作。

下面的代码是可憎的，没有两种方法。我接受了您的基本查询，并使用游标`READTEXT`和`UPDATETEXT`，在一行中创建了存储过程列表。代码中的注释应该有望帮助确定我正在尝试做什么。

这还没有经过 100% 的测试，所以如果有任何问题，请告诉我。

```
-- Gonzalo's original code --
SELECT sm.id, COUNT(sm.colid) AS Cantidad
INTO #SPrepeated
FROM  syscomments AS sm INNER JOIN
      sysobjects AS so ON sm.id = so.id
WHERE (so.status >= 0) AND (so.xtype = 'P') AND (so.category = 0)
GROUP BY sm.id, so.name
HAVING   (COUNT(sm.colid) > 1)

SELECT sm.id, sm.colid, OBJECT_NAME(sm.id) AS object_name, 
    cast(sm.text as ntext) as [text]
into #Tresult
FROM syscomments AS sm
JOIN sysobjects AS so ON sm.id = so.id
JOIN #SPrepeated as spr ON so.id = spr.id
WHERE (so.status >= 0) AND (so.xtype = 'P')

-- Create our #TresultSingle temporary table structure --    
SELECT TOP 1 [id], object_name, cast([text] as ntext) as [text]
INTO #TresultSingle
FROM #Tresult

-- Clear out the table, ready to insert --        
TRUNCATE TABLE #TresultSingle

DECLARE @id int, @previd int, @colid int, @objectname nvarchar(4000), 
    @text nvarchar(4000)
DECLARE @ptrval varbinary(16), @offset int
SET @text = ''

-- Begin cursor, and start praying --   
DECLARE ResultCursor CURSOR
FOR 
SELECT [id], colid, [object_name], [text]
FROM #Tresult
ORDER BY [id], colid

OPEN ResultCursor

FETCH NEXT FROM ResultCursor
INTO @id, @colid, @objectname, @text

INSERT INTO #TresultSingle
SELECT @id, @objectname, @text

WHILE @@FETCH_STATUS = 0
BEGIN
     -- If the ID has changed, create a new record in #TresultSingle --
    IF @id <> @previd
    BEGIN
        INSERT INTO #TresultSingle
        SELECT @id, @objectname, @text
    END
    ELSE
    BEGIN
        -- Get the textpointer of the current @id --
        SELECT @ptrval = TEXTPTR(text) 
        FROM #TresultSingle
        WHERE [id] = @id 

        -- Set our offset for inserting text --
        SET @offset = 4000 * (@colid - 1)

        -- Add the new text to the end of the existing text --
        UPDATETEXT #TresultSingle.text @ptrval @offset 0 @text
    END

    SET @previd = @id

    FETCH NEXT FROM ResultCursor
    INTO @id, @colid, @objectname, @text
END

CLOSE ResultCursor
DEALLOCATE ResultCursor

SELECT * FROM #TresultSingle

DROP TABLE #TresultSingle
drop table #Tresult
drop table #SPrepeated 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T16:36:04.330

即使@LittleBobbyTables 的解决方案工作正常（还没有测试，所以我只是假设它可以），这不会返回 SP 的全文：

在 EM 和 SSMS 中，SELECT 根据提到的选项截断结果。无论任何选项如何，PRINT 也会截断 8000 字节。

我建议从 C# 应用程序而不是在本机 T-SQL 中调用 SELECT 语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T19:16:47.407

我按照@devio 的建议从应用程序中调用了 SELECT 语句，它运行良好（文本字段没有被截断）。@LittleBobbyTables 建议的脚本是该问题的解决方案，只需稍作修改，因为第一条记录被连接两次相同的字符串。

## 解决方案

```
-- Gonzalo's original code --
SELECT sm.id, COUNT(sm.colid) AS Cantidad
INTO #SPrepeated
FROM  syscomments AS sm INNER JOIN
  sysobjects AS so ON sm.id = so.id
WHERE (so.status >= 0) AND (so.xtype = 'P') AND (so.category = 0)
GROUP BY sm.id, so.name
HAVING   (COUNT(sm.colid) > 1)

SELECT sm.id, sm.colid, OBJECT_NAME(sm.id) AS object_name, 
    cast(sm.text as ntext) as [text]
into #Tresult
FROM syscomments AS sm
JOIN sysobjects AS so ON sm.id = so.id
JOIN #SPrepeated as spr ON so.id = spr.id
WHERE (so.status >= 0) AND (so.xtype = 'P')

-- LittleBobbyTables code

-- Create our #TresultSingle temporary table structure --    
SELECT TOP 1 [id], object_name, cast([text] as ntext) as [text]
INTO #TresultSingle
FROM #Tresult

-- Clear out the table, ready to insert --        
TRUNCATE TABLE #TresultSingle

DECLARE @id int, @previd int, @colid int, @objectname nvarchar(4000), 
    @text nvarchar(4000)
DECLARE @ptrval varbinary(16), @offset int
SET @text = ''
set @previd = 0;

-- Begin cursor, and start praying --   
DECLARE ResultCursor CURSOR
FOR 
SELECT [id], colid, [object_name], [text]
FROM #Tresult
ORDER BY [id], colid

OPEN ResultCursor

FETCH NEXT FROM ResultCursor
INTO @id, @colid, @objectname, @text

WHILE @@FETCH_STATUS = 0
BEGIN
-- If the ID has changed, create a new record in #TresultSingle --
IF @id <> @previd
BEGIN
    INSERT INTO #TresultSingle
    SELECT @id, @objectname, @text
END
ELSE
BEGIN
        -- Get the textpointer of the current @id --
        SELECT @ptrval = TEXTPTR(text) 
        FROM #TresultSingle
        WHERE [id] = @id 

        -- Set our offset for inserting text --
        SET @offset = 4000 * (@colid - 1)
        -- Add the new text to the end of the existing text --
        UPDATETEXT #TresultSingle.text @ptrval @offset 0 @text
    END

    SET @previd = @id

    FETCH NEXT FROM ResultCursor
    INTO @id, @colid, @objectname, @text
END

CLOSE ResultCursor
DEALLOCATE ResultCursor

SELECT * FROM #TresultSingle

DROP TABLE #TresultSingle
drop table #Tresult
drop table #SPrepeated 
```

# android - 在 RenderScript 中旋转图像

> ID：13361723
> 
> 赞同：1
> 
> 时间：2012-11-13T13:39:25.813
> 
> 标签：android, matrix, rotation, imageview, renderscript

我需要在渲染脚本中旋转图像，并且我有以下代码：

```
private ScriptC_flip mScript;
Button flip = (Button)view.findViewById(R.id.flipVertical);
flip.setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        mScript.set_direction(1);
        flip();
    }
});
mBitmapIn = loadBitmap(R.drawable.face2);

in = (ImageView) view.findViewById(R.id.displayin);
in.setImageBitmap(mBitmapIn);

createScript(); 
```

需要以下功能：

```
protected void flip() {
    mScript.invoke_filter();
    mOutAllocation.copyTo(mBitmapIn);

    mRS.destroy();
    mInAllocation.destroy();
    mOutAllocation.destroy();
    mScript.destroy();

    createScript();
    in.invalidate();
}

private void createScript() {
    mRS = RenderScript.create(getActivity());

    mInAllocation = Allocation.createFromBitmap(mRS, mBitmapIn,
            Allocation.MipmapControl.MIPMAP_NONE, Allocation.USAGE_SCRIPT);
    mOutAllocation = Allocation.createTyped(mRS, mInAllocation.getType());

    mScript = new ScriptC_flip(mRS, getResources(), R.raw.flip);
    mScript.set_width(mBitmapIn.getWidth());
    mScript.set_height(mBitmapIn.getHeight());
    mScript.set_gIn(mInAllocation);
    mScript.set_gOut(mOutAllocation);
    mScript.set_gScript(mScript);

}

private Bitmap loadBitmap(int resource) {
    final BitmapFactory.Options options = new BitmapFactory.Options();
    options.inPreferredConfig = Bitmap.Config.ARGB_8888;
    return BitmapFactory.decodeResource(getResources(), resource, options);
} 
```

这是我的 RenderSCript 代码：

```
#pragma version(1)
#pragma rs java_package_name(com.example.android.rs.hellocompute)

rs_allocation gIn;
rs_allocation gOut;
rs_script gScript;
int width;
int height;
int direction = 0; // 0 - flip horizontally, 1 - flip vertically
float rotation;

void init(){
    rotation = 0.0f;
}

void root(const uchar4 *v_in, uchar4 *v_out, const void *usrData, uint32_t x, uint32_t y) {
    if(direction == 4){ // rotate right
        const uchar4 *element = rsGetElementAt(gIn, x, y);
        float4 color = rsUnpackColor8888(*element);
        float4 output = {color.r, color.g, color.b};
        *v_out = rsPackColorTo8888(output);

        rs_matrix4x4 matrix;
        rsMatrixLoadIdentity(&matrix);
        rsMatrixTranslate(&matrix, 100.0f, 100.0f, 0.0f);
        rsMatrixRotate(&matrix, rotation++, 0.0f, 0.0f, 1.0f);
        //       rsgProgramVertexLoadModelMatrix(&matrix);
    }else if(direction == 5){ // rotate right
        const uchar4 *element = rsGetElementAt(gIn, y, height - x);
        float4 color = rsUnpackColor8888(*element);
        float4 output = {color.r, color.g, color.b};
        *v_out = rsPackColorTo8888(output);
    }
}

void filter() {
    rsForEach(gScript, gIn, gOut, 0);
} 
```

如果我尝试对这一行进行注释：

```
//       rsgProgramVertexLoadModelMatrix(&matrix); 
```

我收到此方法不存在的错误。为什么会这样？我在其他渲染脚本示例中使用了它。唯一的区别是那里我有一个 RSSurfaceView，在这里，我将结果设置在图像视图上。现在我怎样才能让它旋转？如果我将“方向”设置为 5，那么它会向右旋转 90 度。如果我尝试使用“direction”= 4，它不会做任何事情。我从一个例子中得到了这个，它会一遍又一遍地旋转一个网格

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T09:08:04.637

我想出了如何使用 RSSurfaceView 来做到这一点，但遗憾的是，这个类已被弃用，所以我不能再将渲染脚本用于图形了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T10:42:44.887

rsgProgramVertexLoadModelMatrix 调用是 RenderScript 图形方面的一部分，但您在计算脚本中使用它。

通过将原始图像中的位置乘以矩阵来在计算脚本中进行旋转：

```
rs_allocation gIn;
rs_allocation gOut;
rs_script gScript;
int width;
int height;
int direction = 0; // 0 - flip horizontally, 1 - flip vertically
float rotation;

float gImageWidth;
float gImageHeight;

void init(){
    rotation = 0.0f;
}

void root(const uchar4 *v_in, uchar4 *v_out, const void *usrData, uint32_t x, uint32_t y) {
    if(direction == 4){ // rotate right
        rs_matrix4x4 matrix;
        rsMatrixLoadIdentity(&matrix);
        rsMatrixTranslate(&matrix, gImageWidth/2.0f, gImageHeight/2.0f, 0.0f);
        rsMatrixRotate(&matrix, rotation, 0.0f, 0.0f, 1.0f);
        rsMatrixTranslate(&matrix, -gImageWidth/2.0f, -gImageHeight/2.0f, 0.0f);

        float4 in_vec = {x, y, 0.0f, 1.0f};
        float4 trans = rsMatrixMultiply( &matrix, in_vec);

        float trans_x = trans.x;
        float trans_y = trans.y;

        if ( trans_x < 0.0f) {
            trans_x = 0.0f;
        }
        else if ( trans_x >= gImageWidth) {
            trans_x = gImageWidth - 1.0f;
        }
        if ( trans_y < 0.0f) {
            trans_y = 0.0f;
        }
        else if ( trans_y >= gImageHeight) {
            trans_y = gImageHeight - 1.0f;
        }

        const uchar4 *element = rsGetElementAt(gIn, trans_x, trans_y);
        *v_out = *element;

       //rsgProgramVertexLoadModelMatrix(&matrix);
    }else if(direction == 5){ // rotate right
        const uchar4 *element = rsGetElementAt(gIn, y, height - x);
        float4 color = rsUnpackColor8888(*element);
        float4 output = {color.r, color.g, color.b};
        *v_out = rsPackColorTo8888(output);
    }
}

void filter() {
    gImageWidth = rsAllocationGetDimX(gIn);
    gImageHeight = rsAllocationGetDimY(gIn);
    rsForEach(gScript, gIn, gOut, 0);
} 
```

# javascript - HTML5 服务器发送事件：技术细节？

> ID：13361724
> 
> 赞同：2
> 
> 时间：2012-11-13T13:39:28.747
> 
> 标签：javascript, html, server-sent-events

我对 HTML5 的新服务器发送事件的技术背景感兴趣。那里真的发生了什么？

*   您不需要服务器端的特殊功能 - 只需像往常一样发送您的数据，例如 html
*   HTTP 仍然是一个请求/响应协议。在我看来，新的内容类型“文本/事件流”不会改变这一点

那么这个概念只是“普通旧**长轮询**”的封装版本吗？另一方面，它通常被描述为与服务器的持久、双向连接。在我看来，这将是不同的东西。我只是想了解这如何在 http 之上工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T16:17:16.993

与长轮询相比，它更像是[永久帧](http://en.wikipedia.org/wiki/Comet_%28programming%29#Hidden_iframe)的编码，依赖于[分块传输编码](http://en.wikipedia.org/wiki/Chunked_transfer_encoding)，而不是在数据准备好之前保持连接打开。事件中发送的数据只是文本，尽管该文本当然可以是 HTML，但这取决于您的应用程序来使用它做适当的事情。事件流中的项目如下所示：

```
event: message
data: Any text data you want goes here 
```

在浏览器中，当它接收到这个块时，您会看到一个事件`message`，`EventSource`您可以使用熟悉的`addEventListener("message", callback)`方法捕获该事件。

[永久帧（或长轮询）的主要好处是标准化的接口（基本上，不值得更新现有的工作代码）， Web 套接字](http://www.whatwg.org/specs/web-apps/current-work/multipage/network.html)的主要优点是它可以在长时间运行的进程的廉价共享主机上正常工作不允许。

PS 技术细节[都在规范中](http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#server-sent-events)

# c++ - C++ Builder Datasnap 如何访问服务器对象列表

> ID：13361726
> 
> 赞同：1
> 
> 时间：2012-11-13T13:39:30.670
> 
> 标签：c++, c++builder, 3-tier

我正在使用 Datasnaps 在 c++ builder XE3 中制作一个 3 层应用程序，目前我正在研究中间层部分。但我有一个问题，服务器也需要显示来自客户端的信息。假设客户端推送两个整数，比如 5 和 5，服务器应该总结它们。服务器也应该在其 GUI 中显示它。

长话短说如何访问包含我的服务器方法的 ServerObject 列表，它存储在哪里，我什至可以访问它吗？

这可能是我发布过的最模糊的问题，但我无法更好地解释。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T08:39:00.047

自己找到的。对象可在 ServerPrepare 事件中访问。每次与服务器交互时，对象都在 DSPrepareEventObject->MethodInstance 中可用，必须将其转换为 Serverclass 的实例。

编辑：甚至更好的是所有形式都是全局对象：/

# esb - 如何实现 Mule 消息观察者？

> ID：13361727
> 
> 赞同：0
> 
> 时间：2012-11-13T13:39:32.350
> 
> 标签：esb, mule, contentobserver, observers

我试图在 Mule 上实现一个不需要改变消息的简单消息观察器。

文档上的这个[链接](http://www.mulesoft.org/documentation/display/MULE3USER/Custom+Message+Processors)说最简单的方法是扩展 AbstractMessageObserver。但正如我在[此链接](http://mule.1045714.n5.nabble.com/mule-scm-mule-20216-branches-mule-3-x-core-src-main-java-org-mule-processor-AbstractMessageObserver-s-td3269393.html)上看到的那样，该类已在 Mule 的早期版本中被删除。

那么，现在最好的方法是实现 MessageProcessor 接口并在 process 方法中简单地返回 MuleEvent 参数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:48:49.980

如果您需要访问整个`MuleEvent`，无论是一个`MessageProcessor`或一个 POJO 实现`Callable`。

否则，如果您只需要观察有效负载，一个简单的 POJO 组件就可以解决问题。

请注意，Mule 还提供拦截器（和`InterceptingMessageProcessor`s）：如果您需要在操作之前/之后运行，或者如果您希望停止处理，请使用拦截器。

# git - 通过名称找到一个交换文件

> ID：13361729
> 
> 赞同：85
> 
> 时间：2012-11-13T13:39:41.827
> 
> 标签：git, github, git-merge, dvcs, swapfile

当我尝试将我的分支与远程分支合并时：

```
git merge feature/remote_branch 
```

我收到了这条消息：

```
E325: ATTENTION
Found a swap file by the name ".git/.MERGE_MSG.swp"
          owned by: xxxxxx   dated: Mon Nov 12 23:17:40 2012
         file name: ~xxxxxx/Desktop/My-ios-App/.git/MERGE_MSG
          modified: YES
         user name: xxxxxx   host name: unknown-b8-8d-12-22-27-72.lan
        process ID: 1639
While opening file ".git/MERGE_MSG"
             dated: Tue Nov 13 14:06:48 2012
      NEWER than swap file!

(1) Another program may be editing the same file.
    If this is the case, be careful not to end up with two
    different instances of the same file when making changes.
    Quit, or continue with caution.

(2) An edit session for this file crashed.
    If this is the case, use ":recover" or "vim -r .git/MERGE_MSG"
    to recover the changes (see ":help recovery").
    If you did this already, delete the swap file ".git/.MERGE_MSG.swp"
    to avoid this message.

Swap file ".git/.MERGE_MSG.swp" already exists!
[O]pen Read-Only, (E)dit anyway, (R)ecover, (D)elete it, (Q)uit, (A)bort: 
```

如何处理？

* * *

## 回答 #1

> 赞同：90
> 
> 时间：2012-11-13T13:48:23.563

看起来您有一个打开`git commit`或`git merge`正在进行，并且编辑器仍在打开编辑提交消息。

两种选择：

1.  找到会话并完成它（最好）。
2.  删除`.swp`文件（如果您确定其他 git 会话已消失）。

评论澄清：

*   *会话*是编辑会话。
*   您可以通过在编辑会话中输入命令来查看`.swp`正在使用的`:sw`内容，但通常它是与您正在使用的文件位于同一目录中的隐藏文件，带有`.swp`文件后缀（即`~/myfile.txt`，将是`~/.myfile.txt.swp`）。

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2018-07-13T13:49:34.107

接受的答案未提及如何删除 .swp 文件。

> 出现提示时点击“D”，它将删除它。

就我而言，在我点击 D 后，它保留了最新保存的版本，并删除了创建的**.swp**，因为我错误地退出了 VIM

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2019-08-25T11:05:07.197

.MERGE_MSG.swp 在你的 git 中打开，你只需要删除这个 .swp 文件。就我而言，我使用了以下命令，它运行良好。

```
rm .MERGE_MSG.swp 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-12-02T05:47:43.750

尝试将更改拉入不是从我尝试从中提取的上游分支创建的分支时，我也遇到了此错误。

`night-version`例如 - 这会创建一个新的上游分支匹配

```
git checkout upstream/night-version -b testnightversion 
```

这会`testmaster`在本地创建一个与`master`上游分支匹配的分支。

```
git checkout upstream/master -b testmaster 
```

现在，如果我尝试将更改拉`night-version`入`testmaster`分支会导致此错误。

```
git pull upstream night-version //while I'm in `master` cloned branch 
```

我设法通过导航到正确的分支并拉取更改来解决这个问题。

```
git checkout testnightversion
git pull upstream night-version // works fine. 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-04-12T03:26:09.377

## 2022 年 2 月更新：

删除`.MERGE_MSG.swp`以避免`E325: ATTENTION`。

```
rm .MERGE_MSG.swp 
```

通常`.example.swp`文件并不重要。

此外，通常`.example.swp`文件是在原始文件的同一目录中制作的。然后，您无法在终端上列出`.example.swp`文件。`ls`您需要使用`ll`or`ls -a`命令来列出`.example.swp`终端上的文件。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-03-31T19:30:43.650

更多信息... 有时 .swp 文件可能由在后台运行的 vm 持有。尝试删除文件时，您可能会看到权限被拒绝消息。

[![检查并杀死进程vm](../Images/48770d550a9699fcb43342772b41b98a.png)](https://i.stack.imgur.com/KH8lA.png)

# unit-testing - jasmine-jquery qUnit 替代方案

> ID：13361730
> 
> 赞同：2
> 
> 时间：2012-11-13T13:39:44.173
> 
> 标签：unit-testing, backbone.js, jasmine, qunit, jasmine-jquery

我目前正在测试一些使用模板呈现的 Backbone.js 视图。我的模板在我的 html 中定义并使用 jinja 构建服务器端。我使用的单元测试框架是 qUnit。我希望能够做一些类似于 jasmine-jquery loadFixtures 功能的事情，即将我的模板加载到我的测试套件中以便能够呈现我的视图（在此处描述：http: [//lostechies.com/derickbailey/2011 /09/06/test-driving-backbone-views-with-jquery-templates-the-jasmine-gem-and-jasmine-jquery/](http://lostechies.com/derickbailey/2011/09/06/test-driving-backbone-views-with-jquery-templates-the-jasmine-gem-and-jasmine-jquery/) Jasmine-JQuery Fixtures To The Rescue! 部分）。

qUnit 有替代方案吗？一个更好的方法继续？

这是我的观点的定义方式：

```
MyView = Backbone.View.extend({
  template: _.template($('#my-template').html()),

  initialize: function() {
    this.$el.html(this.template());
  }
}); 
```

这是我定义模板的方式：

```
<script type="text/html" id="my-template">
    <div>
      <span>Bla bla</span>
    </div>
</script> 
```

# c# - PrivateFontCollection.AddMemoryFont 是否适用于 WOFF 文件？

> ID：13361732
> 
> 赞同：3
> 
> 时间：2012-11-13T13:39:53.230
> 
> 标签：c#, truetype, woff

我正在尝试编写一个应该获取字体链接的 Web 应用程序，并返回以发送的字体格式编写的内容的图像。

我正在打开一个读取字体文件的流，并将文件的 InPtr 发送到 PrivateFontCollection.AddMemoryFont，这样我以后可以将它与一些图形对象一起使用。当我使用有效的 .ttf 文件时，一切正常，但每当我尝试使用 .woff 字体文件时，我得到 AddMemoryFont 行的“System.IO.FileNotFoundException: File not found”，即使我可以看到该文件是阅读没有错误。

我尝试使用在线转换器将 .woff 文件转换为 .ttf，当我在新的 .ttf 文件上运行我的代码时，它运行良好。

使用 .woff 文件是否有问题，或者我是否需要更改某些内容才能使其正常工作？

```
WebClient client = new WebClient();
Stream stream = client.OpenRead("http://www.drivehq.com/file/df.aspx/shareID2129391/fileID59377155/arial.ttf"); // Works fine.
//Stream stream = client.OpenRead("http://themes.googleusercontent.com/static/fonts/kiteone/v1/VNHoD96LpZ9rGZTwjozAOvesZW2xOQ-xsNqO47m55DA.woff"); // Doesn't work.
PrivateFontCollection fonts;
FontFamily family = LoadFontFamily(stream, out fonts);

public static FontFamily LoadFontFamily(Stream stream, out PrivateFontCollection fontCollection)
{
    byte[] buffer = null;
    using (MemoryStream ms = new MemoryStream())
    {
        int count = 0;
        do
        {
            byte[] buf = new byte[1024];
            count = stream.Read(buf, 0, 1024);
            ms.Write(buf, 0, count);
        } while (stream.CanRead && count > 0);
        buffer = ms.ToArray();
    }

    var handle = System.Runtime.InteropServices.GCHandle.Alloc(buffer, System.Runtime.InteropServices.GCHandleType.Pinned);

    try
    {
        var ptr = System.Runtime.InteropServices.Marshal.UnsafeAddrOfPinnedArrayElement(buffer, 0);
        fontCollection = new PrivateFontCollection();
        fontCollection.AddMemoryFont(ptr, buffer.Length);
        return fontCollection.Families[0];
    }
    finally
    {
        handle.Free();
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T16:47:44.973

.NET Framework 不支持导入 WOFF 字体，就像 Windows XP/Vista/7/8 一样。

您必须使用[外部工具](http://orionevent.comxa.com/otf2woff.html)将其转换为 TTF并导入 TTF。

# asp.net - 设置“ControlToValidate”属性后自定义验证器停止工作

> ID：13361733
> 
> 赞同：0
> 
> 时间：2012-11-13T13:39:56.967
> 
> 标签：asp.net, customvalidator

我正在使用 ASP.NET Pages 和 CustomValidator 控件来验证控件集。另外我正在使用 ClientValidation 属性和我的自定义 javascript 函数。我的主要问题是：当我设置“ControlToValidate”属性时 - 验证函数停止调用。我已经检查了两次，为验证器和控件设置了 ID 以进行验证，但仍然没有结果。

有人知道如何解决我的情况吗？

PS 我需要设置 ControlToValidate 属性的主要原因是我想在失去控制焦点后立即触发验证

更新：这里是验证器：

```
 <asp:CustomValidator ID="cvEmail1" runat="server" ClientValidationFunction="ValidateEmail" 
            Display="Dynamic" EnableClientScript="True" ForeColor="Red" ErrorMessage="This field is required"/> 
```

这是验证功能：

```
<script type="text/javascript">
    function ValidateEmail(sender, args) {
        var isValid = myCheck();
        args.IsValid = isValid;
    }
</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:51:08.990

没有 ControlToValidate 属性集的 CustomValidator 会在每次回发时进行验证。当您建立另一个控件的 ID 时，它只会在该控件具有要验证的值时进行验证；它不会验证空文本。将 ValidateEmptyText 设置为 true 以启用它。

此外，您可能想发布您的设置，以便我们进一步提供帮助。

# c# - 如何循环配置部分

> ID：13361734
> 
> 赞同：5
> 
> 时间：2012-11-13T13:39:59.383
> 
> 标签：c#, configurationsection

我的`Web.config`文件中有以下部分：

```
<configSections>
    <section name="mySection" type="myNameSpace, myProject"/>
</configSections>

<mySection>
    <city id="ny" type="nameSpace1" />
    <city id="dc" type="nameSpace2" />
    <city id="nj" type="nameSpace3" />
</mySection> 
```

我需要编写循环遍历`cities`给定的代码`id`并返回`type`.

IE

```
 if the given id = "ny" --> return nameSpace1
 if the given id = "dc" --> return nameSpace2
 if the given id = "nj" --> return nameSpace3 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:46:48.887

您需要参考以下部分：

```
var theSection = (TypeOfSection)ConfigurationManager.GetSection("mySection"); 
```

请注意转换为`TypeOfSection`- 这是在配置文件中声明的类型。

此时，您应该有一个可以访问和迭代的强类型对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-04-18T03:43:11.310

> 在我的回答中，我假设您已经编写了一个实现 ConfigurationSection 的类，该类具有一组城市。– 2012 年 11 月 13 日 13:50

这个先前的答案在技术上是正确的，尽管我觉得它缺乏细节。我将尝试详细说明@Oded 的回复，希望这将是一个清晰的展示！

## 脚步

1.  这里要做的第一件事是实现一个新类，`MyConfigSection`它只是一个标准 POCO *（普通旧 C 对象）*，具有您将存储在配置源中的每个配置值的属性。

    ```
    public class MyConfigSection
    {
        public City[] Cities {get; set;}
    } 
    ```

    **注意：** 我们使用的是类型的对象数组`City`，这是为了根据您的特定用例需要允许多个条目，尽管您不限于任何给定的类型。在这种情况下，该类的结构如下：

    ```
    public class City
    {
        public string Id {get; set;}
        public string Type {get; set;}
    } 
    ```

2.  在您选择的源中创建配置部分，并将该部分命名为与预期目的相对应的名称，在这种情况下，我们将调用该部分`mySection`以匹配原始问题。

    ```
    <mySection>
        <Cities>
            <city Id="ny" Type="nameSpace1" />
            <city Id="dc" Type="nameSpace2" />
            <city Id="nj" Type="nameSpace3" />
        </Cities>
    </mySection> 
    ```

3.  现在关键步骤是将`MyConfigSection`poco 绑定到所需的配置设置部分。`IOptions<T>`我们可以通过将以下代码添加到您的启动类中来实现这一点，而无需通过接口：

    ```
    var configSection = new MyConfigSection();
    Configuration.Bind("mySection", configSection);
    services.AddSingleton(configSection); 
    ```

4.  添加绑定并将生成的对象注册到服务容器后，现在可以通过依赖注入在代码库中的任何位置使用它，只需`MyConfigSection`在需要存储在上述配置中的值的任何方法中包含类型参数即可。

    ```
    public Type GetCityType(string cityId, MyConfigSection config)
    {
        var typeName = config.Cities
            .Where(x => x.Id == cityId)
            .Select(x => x.Type);
        return Type.GetType(typeName);
    } 
    ```

    在这个特定场景中，设置值的使用稍微复杂一些，因为您正在处理一个额外的 poco 类型的数组，尽管在 LINQ 的帮助下，从 Cities 中检索必要的值变得非常简单大批。得到与类型对应的字符串并将其存储在`typeName`变量中后，您可以使用反射来返回实际`Type`对象，而不仅仅是一个字符串，如上所示。*（该`GetType()`方法还有几个值得一看的重载，它们允许您配置如果找不到具有给定名称的类型会发生什么，以及搜索是否应该区分大小写等。）*

* * *

我希望这个答案对您的情况清楚且有用，如果您有任何我没有完全回答的问题，请发表评论，我一定会通过一些额外的阐述来更新答案！

# apache - .htaccess PDF Catch - 调整

> ID：13361736
> 
> 赞同：0
> 
> 时间：2012-11-13T13:40:05.490
> 
> 标签：apache, .htaccess, apache2

我目前使用这个 htaccess 命令来捕获热链接到我们 pdf 的人。但是，我希望搜索引擎仍然可以访问。真的，我只关心谷歌仍然可以访问。有人可以指导我正确地将其构建到此查询中吗？

```
RewriteEngine On
RewriteCond %{REQUEST_URI} \.(pdf)$ [NC]
RewriteCond %{HTTP_REFERER} !^https?://(www\.)?mydomain.com/
RewriteRule ^(.*)$ /pdf?pdf=$1 [L] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T13:17:23.507

PDF Hotlink Protection，不会阻止搜索引擎扫描内容。这将防止其他网站直接链接到您的 PDF 表。您可以让他们转发到启动页面（以便客户知道您是谁，然后单击“查看 Pdf”按钮。它是通过 $_GET['pdf'] var 发送的。

```
RewriteEngine On
RewriteCond %{REQUEST_URI} \.(pdf)$ [NC]
RewriteCond %{HTTP_USER_AGENT} !^.*Googlebot.*$
RewriteCond %{HTTP_USER_AGENT} !^.*bingbot.*$
RewriteCond %{HTTP_USER_AGENT} !^.*msnbot.*$
RewriteCond %{HTTP_USER_AGENT} !^.*Slurp.*$
RewriteCond %{HTTP_REFERER} !^https?://(www\.)?mydomain.com/
RewriteRule ^(.*)$ /pdf?pdf=$1 [L] 
```

# c# - 使用 nvidia 卡旋转显示时，带有文本的光标被裁剪

> ID：13361739
> 
> 赞同：3
> 
> 时间：2012-11-13T13:40:10.943
> 
> 标签：c#, nvidia, mouse-cursor

我正在使用自定义开发的鼠标光标，它在鼠标指针旁边呈现带有文本的位图。通常这工作得很好。但是，在某些显卡（包括 geforce 9500）上，如果我使用 nvidia 控制面板将显示器旋转到纵向模式 - 文本会被部分裁剪，因此只显示第一个字母的一半。然而，部分显示的字母似乎已正确旋转。

这是一个已知的问题？有人知道这是怎么发生的吗？（我会尝试粘贴代码的相关部分，虽然有点多）我使用的是 Windows 7，c# 中的代码。

**Edit1：**发现了一些有趣的东西 - 如果我在指针旁边写的字符串很短（例如“Aa”）它会被破坏，但如果它更长（比如“Aaa”）它可以很好地旋转。

**Edit2：**这是有问题的代码：

```
int width = cursor.Size.Width + textSize.Width + scrollTokenSize.Width - 10;
int height = cursor.Size.Height;
bitmap = new Bitmap(width, height); 
```

该位图设置在光标旁边。问题（我认为）是高度和宽度的大小不同，如果我让位图只使用最大值两次，那么我的文本将显得太远，从指针向下（但它都显示我应该提到）。想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T12:04:00.940

对于任何感兴趣的人，我设法通过将我的非方形位图添加到透明方形位图上来解决这个问题。猜猜显卡假设鼠标指针是平方的。

# iphone - UISplitViewController

> ID：13361740
> 
> 赞同：0
> 
> 时间：2012-11-13T13:40:12.770
> 
> 标签：iphone, uisplitviewcontroller

我想从 Tableviewcontroller 导航到包含 splittview 的新站点。

所以我创建了一个 UIViewController 并用 IB 添加了 splitview。我的问题是：如何将 splittView 添加到我的 UIViewController 的视图中？

还是只能从 appdelegate 中添加 splittview？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:37:36.100

也许[这个问题](https://stackoverflow.com/questions/2633532/navigate-to-a-splitviewcontroller)会有所帮助？A`UISplitViewController`必须是应用程序的根视图控制器

# c# - 从服务中获取图像

> ID：13361745
> 
> 赞同：2
> 
> 时间：2012-11-13T13:40:32.487
> 
> 标签：c#, javascript, asp.net-mvc, service, asp.net-mvc-4

我使用 MVC4、Razor 和 C#。我想要服务，例如：

```
[WebGet]
[OperationContract]
public string Get(int id)
{
  PictureManager m = new PictureManager();
  Picture p = m.Load(id);
  return Convert.ToBase64String(p.Trunk);
} 
```

在哪里：

```
public byte[] Trunk { get { return _trunk; } } 
```

在客户端，我想以同样的方式使用它：

```
<img src="http://MyService/MyPictures/Get?id=21"> 
```

有没有一样的能力？或者我可能需要使用一些 JavaScript 在客户端显示图片？你能告诉我方向吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:53:02.703

如果您的图像是 jpeg，请从您的代码中返回此内容。

```
return "data:image/jpeg;base64," + Convert.ToBase64String(p.Trunk); 
```

[在此处阅读数据 URI 方案。](http://en.wikipedia.org/wiki/Data_URI_scheme)

# jenkins - Jenkins/Hudson JBoss 管理插件

> ID：13361752
> 
> 赞同：0
> 
> 时间：2012-11-13T13:41:07.370
> 
> 标签：jenkins, hudson, jboss5.x

我可以通过 Jenkins 配置指定本地 JBoss 实例的 IP 地址，但是如何指定部署的端口/端口绑定？

# c++ - 无法锁定 Qt 互斥锁 (QReadWriteLock) 访问冲突写入

> ID：13361757
> 
> 赞同：2
> 
> 时间：2012-11-13T13:41:31.423
> 
> 标签：c++, multithreading, qt, mutex

这个问题的一些背景是我之前的问题： [非成员函数指针作为 API 中对成员函数的回调](https://stackoverflow.com/questions/13129372/non-member-function-pointer-as-a-callback-in-api-to-member-function)（它可能无关紧要）。

回调启动一个写入一些数据的线程。还有另一个线程读取相同的数据，这会导致一些崩溃。我刚刚参加了多线程速成课程（感谢 SO），这是我试图保证作者和读者不会同时访问数据的尝试。我正在使用来自 Qt (QReadWriteLock) 的一些互斥机制。

```
#include <QSharedPointer>
#include <QReadWriteLock>

Class MyClass
{
public:
  MyClass();
  bool open();
  float getData();
  void streamCB(void* userdata);

protected:
  float private_data_;
  QSharedPointer<QReadWriteLock> lock_;
};

// callback wrapper from non-member C API to member function void
__stdcall streamCBWrapper(void* userdata)
{
   static_cast<MyClass*>(userdata)->streamCB(userdata);
}

// constructor
MyClass::MyClass()
{
  lock_ = QSharedPointer<QReadWriteLock>(new QReadWriteLock());
  lock_->lockForWrite();
  private_data_ = getData();
  lock_->unlock();
}

// member callback
void MyClass:streamCB(void* userdata)
{
  float a = getData(); 
  lock_->lockForWrite(); //*** fails here
  private_data_ = a;
  lock_->unlock();
} 
```

运行程序时出现分段错误。VS 调试器`Access violation writing location 0x00fedbed.`在我标记的行上说`//*** fails here.` 锁在构造函数中起作用，但在回调中不起作用。

知道出了什么问题吗？我应该看什么？（以及如何改进我的问题）谢谢！

其他相关线程 [无法访问在类'QReadWriteLock'Error 1 error C2248中声明的私有成员：'QReadWriteLock::QReadWriteLock'](https://stackoverflow.com/questions/9507604/cannot-access-private-member-declared-in-class-qreadwritelockerror1error-c22)（我使用了QSharedPointer建议）

**编辑1：** 回调设置

```
bool MyClass::open()
{
  // stuffs
  int mid = 0;
  set_stream_callback(&streamCBWrapper, &mid);
  // more stuffs
  return true;
} 
```

**编辑2：** 感谢您的所有建议。所以我的错误可能根本不是由于互斥锁，而是因为我对 API 缺乏了解？我很困惑.. 这是 set_stream_callback 的 API 文档。

```
typedef void (__stdcall *STREAM_CALLBACK)(void *userdata);

/*! @brief Register a callback to be invoked when all subscribed fields have been updated
 *
 *  @param streamCB pointer to callback function
 *  @param userdata pointer to private data to be passed back as argument to callback
 *  @return 0 if successful, error code otherwise
 */
__declspec(dllimport) int __stdcall set_stream_callback(
    STREAM_CALLBACK streamCB, void *userdata); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:40:20.137

为什么需要足够的代码示例的好例子。

如果我正确解释了您的回调语法，

set_stream_callback(&streamCBWrapper, &mid);

设置`streamCBWrapper`为回调函数，while`&mid`是指向`userdata`.

在回调中，您实际上是在*将指针转换`int`为`MyClass`*，然后尝试访问不存在对象的成员变量。

确保将一个实例传递`MyClass`给您的回调。我想这就是`this`你的情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T18:16:57.617

对我来说，这听起来基本上像是一个线程问题。由于无论如何您都在使用 Qt 互斥，您可能会考虑使用 Qt 的线程机制并在线程之间发送信号和插槽。只要您遵循[此处](http://blog.qt.digia.com/blog/2010/06/17/youre-doing-it-wrong/)和[此处](http://blog.qt.digia.com/blog/2007/07/05/qthreads-no-longer-abstract/)的建议，它们的文档就很好并且易于使用。

# teamcity - PHP Mess Detector 与 Teamcity 的集成

> ID：13361760
> 
> 赞同：0
> 
> 时间：2012-11-13T13:41:35.197
> 
> 标签：teamcity, phpmd

我安装了 Teamcity 7.0.3 和不同的项目。我想使用 PHP Mess Detector。我想从 PHP Mess Detector 获得一组有限的规则。每个项目都有不同的规则。所以我的问题是 1：如何修改 PHP Mess Detector 的默认规则？2：如何在 Teamcity 中为每个项目定义不同的规则集？

我当前的构建文件内容是：

```
<?xml version="1.0" encoding="UTF-8"?>
<project name="bnnpoa" default="analyse" basedir=".">
    <property name="project-name" value="${ant.project.name}" />
    <property name="work-dir" value="%system.teamcity.build.workingDir%" />
    <property name="folder-to-check" value="${work-dir}\sites" />
    <target name="analyse">
      <exec executable="C:\php\PEAR\scripts\phpmd.bat">
        <arg value="${folder-to-check}"/>
        <arg value="html"/>
        <arg value="C:\php\PEAR\resources\rulesets\naming.xml,C:\php\PEAR\resources\rulesets\codesize.xml,C:\php\PEAR\resources\rulesets\controversial.xml"/>
        <arg value=">"/>
        <arg value="${project-name}_analysis.htm"/>
      </exec>
    </target>
</project> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T06:58:39.027

添加构建步骤并为每个项目使用相同的代码。要定义自己的规则，您可以修改 XML 文件或复制它们，根据需要修改规则，将文件放在同一路径中，其他选项是创建新的 XML 并从文件中导入所需的规则。

# html - 消息分隔符，一个标签更快

> ID：13361764
> 
> 赞同：0
> 
> 时间：2012-11-13T13:41:43.843
> 
> 标签：html, css, web

我有消息分隔符，但我认为可以更快地做到这一点：

```
<div style="border-top: 1px solid black; width: 33%; float: left;margin-top: 30px;"></div>
<div style="float: left; margin-top: 25px; width: 33%; text-align: center;">Dzisiaj</div>
<div style="border-top: 1px solid black; margin-top: 30px;width: 33%; float: right;"></div>
<br /> 
```

结果很好：

```
---------- Dzisiaj ----------- 
```

但我想这样做：

```
<span class="delimiter">Dzisiaj</span> 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:49:08.207

这为您提供了一个固定宽度的边框，但我认为它不适用于百分比宽度：

```
<div style="border-left: 100px solid black; border-right: 100px solid black; text-align: center; line-height: 1px; margin: 0.5em 0;">Dzisiaj</div> 
```

# php - 遍历具有匹配属性的对象数组

> ID：13361765
> 
> 赞同：0
> 
> 时间：2012-11-13T13:41:44.980
> 
> 标签：php, arrays, object

我有一组用于创建菜单的对象，每个对象都有属性 id、video_id 和 chapter_id。

我想为每个循环制作一个，例如

```
foreach($menu_objects as $object WHERE $object->chapter == $variable) 
```

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:44:06.317

PHP 不提供这样的语法，但是，您始终可以将其作为`if`- 语句作为循环中的第一行：

```
foreach ($menu_objects as $object) {
    if ($object->chapter != $variable) continue;
    ... process as normal ... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:44:12.960

只需在循环中嵌套一个 if ：

```
foreach($menu_objects as $object){
  if($object->chapter == $variable){
    // do something here
  }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:44:04.587

几种方法

```
foreach(array_filter($menu_objects, function($o) { return $o->chapter == $variable}) as $object) 
```

或者

```
foreach($menu_objects as $o)
{
    if ($o->chapter == $variable)
    {
        //Code here
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:44:21.917

只需添加一个如果？

```
foreach($menu_objects as $object) {
   if ($object->chapter == $variable) {
      // Do Something?
   }
} 
```

# python - 制作降价解析器时的正则表达式问题

> ID：13361766
> 
> 赞同：1
> 
> 时间：2012-11-13T13:41:52.530
> 
> 标签：python, regex, markdown

我正在尝试在python中制作一个markdown解析器，不是因为它有用，而是因为它很有趣并且因为我正在尝试学习正则表达式。

```
#! /usr/bin/env python
#-*- coding: utf-8 -*-

import re

class Converter:

    def markdown2html(self, string):

        string = re.sub('\*{3}(.+)\*{3}', '<strong>\\1</strong>', string)
        string = re.sub('\*{2}(.+)\*{2}', '<i>\\1</i>', string)
        string = re.sub('^#{1}(.+)$', '<h1>\\1</h1>', string, flags=re.MULTILINE)
        string = re.sub('^#{2}(.+)$', '<h2>\\1</h2>', string, flags=re.MULTILINE)

        return string

markdown_sting = """
##h2 heading
#H1 heading
This should be a ***bold*** char
#anohter h1
anohter ***bold***
this is a **italic** string
"""

converter = Converter()
print converter.markdown2html(markdown_sting) 
```

它打印

```
<h1>#h2 heading</h1>
<h1>H1 heading</h1>
This should be a <strong>bold</strong> char
<h1>anohter h1</h1>
anohter <strong>bold</strong>
this is a <i>italic</i> string 
```

如您所见，它不解析 h2 标签。我哪里出错了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:43:57.407

当您解析器看到时`#`，它会替换`h1`. 然后它尝试对 进行替换`h2`，但没有字符串，因为在解析该部分时已经替换`##`了哈希 ( ) 之一。`'#'``h1`

一个简单的解决方法是交换订单：

```
string = re.sub('^#{2}(.+)$', '<h2>\\1</h2>', string, flags=re.MULTILINE)
string = re.sub('^#{1}(.+)$', '<h1>\\1</h1>', string, flags=re.MULTILINE) 
```

通常，当您对数据应用转换时，应将其从*最严格到最不严格*的顺序排列，以避免这些问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T14:02:40.050

您可以通过确保标题文本的第一个字符*不是*井号来确保仅匹配所需数量的井号。这可以通过使用`[^#]`这样的来完成：

```
string = re.sub('^#{1}([^#].*)$', '<h1>\\1</h1>', string, flags=re.MULTILINE)
string = re.sub('^#{2}([^#].*)$', '<h2>\\1</h2>', string, flags=re.MULTILINE) 
```

这样规则的顺序就无关紧要了，使规则更加健壮。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:44:13.257

这些正则表达式按顺序进行评估。h1 正则表达式将抓取任何以 # 开头的行并将其转换为`<h1>`. 因此，当它到达 h2 正则表达式时，该行不再以 ## 开头。交换这两个表达式。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T13:49:18.843

更合适更高效的方法可能是比较字符串的第一个字符，然后进行简单的字符串替换

```
def markdown2html(self, string):

    if string[0:2] == "##":
        string = string.replace( "##", "<h2>" ) + "</h2>"
    if string[0] == "#":
        string = string.replace( "##", "<h1>" ) + "</h1>"
    return string 
```

这样您就可以进行简单的列表操作而不是 RegEx。但在所有情况下，顺序都很重要

# java - 如何在 Java Swing 中使用双精度值在 JTextpane 中设置文本的字体大小

> ID：13361769
> 
> 赞同：4
> 
> 时间：2012-11-13T13:41:56.443
> 
> 标签：java, swing

您好我正在尝试构建一个 java Swing 应用程序，用户可以选择在 jtextpane 中设置所需的文本字体大小。我正在使用“StyleConstants.setFontSize(attr, int);”。这仅适用于整数值，但是当用户给出双精度值 Eg(8.5) 时，上述命令将失败，因为它只接受整数值而不接受双精度值。那么我该如何解决呢？有没有接受双值的命令？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:16:28.377

您可以通过 HTML/CSS 尝试：

```
JTextPane textPane = new JTextPane();
textPane.setContentType("text/html");
textPane.setText("<span style='font-size: 8.5pt'>Hey there!</span>"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-06T12:39:56.010

以下 swing 组件支持 HTML 格式：按钮、菜单项、标签、工具提示和选项卡式窗格。要使用格式，必须在文本的开头放置标签（在末尾关闭它是可选的。）例如：

```
<html><font size="8.5pt">Two</font> 
```

# javascript - 在 jquery 中的 html 代码上出现一些奇怪的错误

> ID：13361773
> 
> 赞同：2
> 
> 时间：2012-11-13T13:42:32.277
> 
> 标签：javascript, jquery

为什么我会收到此错误？可能必须对引号做些什么？

![在此处输入图像描述](../Images/fa476a10eac29bff616afe66c08f27a0.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:44:07.733

字符串不能跨越 javascript 中的多行。由于该行以 开头`"`且不以 结尾`"`，因此它是一个错误。

您可以将 a`\`放在每行的末尾，它会转义换行符。如果你这样做，你要附加的 dom 将不会有它在你的代码中所做的漂亮格式，因为换行符被转义了。

另一种选择是使用 a`+`将一些字符串连接在一起

```
$().append(
   "<dom>" +
   "<moredom>" +
   "<moredom>" 
); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T13:43:54.053

编译器是对的，你不能跨越多行这样的字符串。

要保留此构造，请`\`在行尾添加一个：

```
$('body').append("<div product id=product_header>\
    <table id=product_header_table>\
    </table>\
</div>") 
```

# matlab - matlab polyval中的置信度

> ID：13361775
> 
> 赞同：0
> 
> 时间：2012-11-13T13:42:54.493
> 
> 标签：matlab, linear-regression

我需要了解如何计算线性回归的置信区间。我自己得到的值与使用 Matlab 得到的值不同。所以，我一直试图了解它是如何在 Matlab 中完成的。在 polyval.m 中，我不明白下面的代码部分。似乎 E 等价于 [E,R] = qr(V,0)。但不确定它到底是什么。我的问题是：

1.  怎么`[E,R] = qr(V,0) different from [Q,R]=qr(V);`
2.  如何`E(=V/R)`用于计算置信区间（下面的增量）？

    % S 是一个包含三个元素的结构：原始 X 的 Vandermonde 矩阵的三角因子、自由度和残差范数。

    E = V/R；

    ```
    e = sqrt(1+sum(E.*E,2)); 
    ```

    ...

    delta = normr/sqrt(df)*e;

非常感谢！

大辅

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:46:11.743

[我在我的优化提示和技巧](http://www.mathworks.com/matlabcentral/fileexchange/8553-optimization-tips-and-tricks)文档中详细讨论了这一点。

至于qr(V,0)与qr(V)的差异，就是所谓的经济qr。阅读 qr 的帮助文档。

# powershell - 动态过滤列表的有效方法？

> ID：13361777
> 
> 赞同：0
> 
> 时间：2012-11-13T13:42:55.917
> 
> 标签：powershell, powercli

我正在尝试从 vCenter 获取所有 VM 的列表，但如果 VM 的名称包含我在另一个列表中的字符串之一，则从列表中排除 VM。

```
$vm_list = Get-Datacenter | Get-VM 

$vm_list content:

vm1233
vm4566
vm7890
vm3330
vm9990 
```

现在我想从名称中排除列表中包含其中一个字符串的任何 VM：

```
$exluded_vms = @('33', '66') 
```

最好的方法是什么？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-13T13:46:37.130

我用这个：

```
[regex]$exluded_vms = '33|66'
 $vm_list = Get-Datacenter | Get-VM  | ? { $_.NAME -NOTMATCH $exluded_vms} 
```

更有效的方法是使用 `get-view`

```
 get-view -viewtype virtualmachine -filter @{'name'='^((?!33|66).)*$'} 
```

最后一个提供有关 VM 的更多信息，您可以将结果传递`| select name`给以限制输出

# c# - UdpClient.EnableBroadcast 值无效

> ID：13361779
> 
> 赞同：3
> 
> 时间：2012-11-13T13:43:05.710
> 
> 标签：c#, .net, udp, udpclient

我只是在玩一个`UdpClient`并注意到设置`UdpClient.EnableBroadcast`或`true`没有`false`任何（副作用）效果，我可以用它进行广播：

```
using (UdpClient client = new UdpClient())
{
    byte[] data = Encoding.ASCII.GetBytes("Hello");
    while (true)
    {
        client.Send(data, data.Length, new IPEndPoint(IPAddress.Broadcast, 45678));
        Console.WriteLine("sent");
        Console.ReadKey();
    }
} 
```

[MSDN页面](http://msdn.microsoft.com/en-us/library/system.net.sockets.udpclient.enablebroadcast.aspx)对此相当含糊，但如果您将属性设置为广播，听起来应该会导致异常`false`：

> 获取或设置一个布尔值，该值指定 UdpClient 是否可以发送或接收广播数据包。... 如果 UdpClient 允许广播数据包，则为 true；否则为假。默认值为假。

这不是一个关键问题，但它只是让我想知道。这是一个错误还是该属性就在那里，以便您稍后可以参考它并确定您是否打算使用它进行广播？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:48:39.283

您需要在初始化 udp 套接字时启用广播模式，如下所示

```
this.someUdpSocket.EnableBroadcast = true;
this.someUdpSocket.Client.Bind(new IPEndPoint(IPAddress.Any, 0)); 
```

新编辑：

上面不起作用，下面的代码

```
this.someUdpSocket.Client.EnableBroadcast = false; 
```

也达不到目的。至于您的回答“是的，它可以称为错误，或者该属性可能与其他上下文相关。”

但是如果你想明确地禁用广播，你可以像下面这样：

```
this.someUdpSocket.Client.SetSocketOption(SocketOptionLevel.Udp, SocketOptionName.Broadcast, false); 
```

谢谢你的动力。

# mysql - 不时更新/插入需要几秒钟

> ID：13361782
> 
> 赞同：7
> 
> 时间：2012-11-13T13:43:17.323
> 
> 标签：mysql, insert, sql-update

我的服务器上非常简单的 INSERT / UPDATES 有问题。有时，完成这样的查询需要几秒钟以上的时间：

```
2.1062s - INSERT INTO `transaction` SET `idUser` = 72, `currency` = 50, `amount` = '10', `action` = 'buyCoins';
11.785s - UPDATE `user` SET `cash` = 10, `crystal` = 10, `expPoints` = 10, `energy` = 10 WHERE idUser = 72;
0.6296s - UPDATE `user` SET `lastEnergyUpdate` = CURRENT_TIMESTAMP WHERE idUser = 72; 
```

看起来问题不取决于特定的表。我在那些桌子上没有触发器。

表定义：

```
CREATE TABLE `user` (
 `idUser` int(10) unsigned NOT NULL AUTO_INCREMENT,
 `expPoints` int(10) NOT NULL DEFAULT '0',
 `cash` int(10) NOT NULL DEFAULT '1000',
 `crystal` int(10) NOT NULL DEFAULT '10',
 `energy` int(4) NOT NULL DEFAULT '0',
 `name` varchar(50) DEFAULT NULL,
 `surname` varchar(50) DEFAULT NULL,
 `age` int(4) unsigned DEFAULT NULL,
 `sex` enum('men','women','unknown') DEFAULT NULL,
 `lastEnergyUpdate` timestamp NULL DEFAULT NULL,
 `lastLogin` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
 `insertDate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
 PRIMARY KEY (`idUser`),
 UNIQUE KEY `serviceUnique` (`serviceName`,`serviceId`)
) ENGINE=InnoDB AUTO_INCREMENT=5333 DEFAULT CHARSET=utf8

CREATE TABLE `transaction` (
  `idTransaction` int(10) NOT NULL AUTO_INCREMENT,
  `idUser` int(10) unsigned NOT NULL,
  `currency` enum('crystal','partnerCurrency','cash') DEFAULT NULL,
  `amount` int(5) NOT NULL,
  `action` enum('unlockPlace','buyExtra','collectReleased') NOT NULL,
  `insertDate` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`idTransaction`),
  KEY `fk_transaction_user1` (`idUser`),
  CONSTRAINT `fk_transaction_user1` FOREIGN KEY (`idUser`) REFERENCES `user` (`idUser`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB AUTO_INCREMENT=156329 DEFAULT CHARSET=utf8 
```

在同一台服务器上，我有更多的数据库（~100），但没什么大不了的。所有数据库的转储约为 300MB。

mysqltunner 输出：

```
 >>  MySQLTuner 1.0.1 - Major Hayden <major@mhtx.net>
 >>  Bug reports, feature requests, and downloads at http://mysqltuner.com/
 >>  Run with '--help' for additional options and output filtering

-------- General Statistics --------------------------------------------------
[--] Skipped version check for MySQLTuner script
[OK] Currently running supported MySQL version 5.1.66-0ubuntu0.11.10.2-log
[OK] Operating on 64-bit architecture

-------- Storage Engine Statistics -------------------------------------------
[--] Status: -Archive -BDB -Federated +InnoDB -ISAM -NDBCluster
[--] Data in MyISAM tables: 138M (Tables: 267)
[--] Data in InnoDB tables: 170M (Tables: 327)
[--] Data in MEMORY tables: 0B (Tables: 1)
[!!] Total fragmented tables: 329

-------- Performance Metrics -------------------------------------------------
[--] Up for: 20h 45m 57s (558K q [7.468 qps], 58K conn, TX: 685M, RX: 98M)
[--] Reads / Writes: 66% / 34%
[--] Total buffers: 1.1G global + 6.0M per thread (150 max threads)
[OK] Maximum possible memory usage: 2.0G (12% of installed RAM)
[OK] Slow queries: 0% (54/558K)
[OK] Highest usage of available connections: 6% (10/150)
[OK] Key buffer size / total MyISAM indexes: 16.0M/8.8M
[OK] Key buffer hit rate: 99.9% (245K cached / 258 reads)
[OK] Query cache efficiency: 51.5% (176K cached / 342K selects)
[OK] Query cache prunes per day: 0
[OK] Sorts requiring temporary tables: 6% (1K temp sorts / 19K sorts)
[!!] Temporary tables created on disk: 34% (2K on disk / 8K total)
[OK] Thread cache hit rate: 99% (10 created / 58K connections)
[!!] Table cache hit rate: 16% (786 open / 4K opened)
[OK] Open file limit used: 32% (714/2K)
[OK] Table locks acquired immediately: 99% (329K immediate / 329K locks)
[OK] InnoDB data size / buffer pool: 170.3M/512.0M

-------- Recommendations -----------------------------------------------------
General recommendations:
    Run OPTIMIZE TABLE to defragment tables for better performance
    MySQL started within last 24 hours - recommendations may be inaccurate
    Temporary table size is already large - reduce result set size
    Reduce your SELECT DISTINCT queries without LIMIT clauses
    Increase table_cache gradually to avoid file descriptor limits
Variables to adjust:
    table_cache (> 1024) 
```

当然，它只发生在约 1% 的查询中（99% 工作正常），然后 HDD 真的很忙（13% - 8 核服务器上的 20% wa）

我应该继续增加 table_cache 吗？任何其他想法发生了什么？我该如何改进它？

我的 MySQL 服务器是 5.1.66。我尝试升级到 5.5.x 但这对我没有帮助，所以我将其降级。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T07:50:13.507

*当然，它只发生在大约 1% 的查询中（99% 工作正常），然后 HDD 真的很忙（13% - 20% 在 8 核服务器上）*

1.  您的磁盘出现问题 - 我敢打赌这会在您的 innodb 日志刷新到磁盘时发生 - 我会尝试更小（更频繁地刷新）和更大的日志大小（更频繁地刷新） - 我希望你得到更多从更频繁的冲洗。

2.  另一件事是什么在吃你的 IO - 如果你能抓住罪魁祸首，在这段时间内运行 iotop。

3.  否则，如果可以，请确保您的 tmp、数据和日志分区在物理上是分开的。

# foreach - 在 smarty 中循环嵌套数组

> ID：13361788
> 
> 赞同：0
> 
> 时间：2012-11-13T13:43:34.743
> 
> 标签：foreach, smarty

对此有一些实际问题，希望有人能提供帮助。这是我正在使用的数据的简化样本。所以这里 $order_info 是一个数组，在该数组内部还有另一个名为 $items 的数组，其中有多个以项目 ID 作为名称的数组（非常烦人！）。我想要做的是遍历 $items 数组中的数组——问题是我不知道它们的名字。是否可以只循环遍历数组中的每个数组（也在数组中！）？它还需要使用 smarty。我尝试了各种嵌套的 for 循环，但都返回一个空白页，提示错误。

```
 {$order_info}   Array (86)
order_id => "15"

items => Array (2)
  4008222099 => Array (19)
    item_id => "4008222099"
    order_id => "15"
    product_id => "836"
    product_code => "B0001WS6L2"
    price => "229.95"
    amount => "1"
    extra => Array (9)
      step => "1"
      product_options => Array (0)
      unlimited_download => "N"
      product => "LINGO TR-2203 Pacifica Talk Talking T..."
      company_id => "0"
      is_edp => "N"
      edp_shipping => "N"
      base_price => "229.95"
      stored_price => "N"
    product => "LINGO TR-2203 Pacifica Talk Talking T..."
    deleted_product => ""
    discount => "0"
    company_id => "0"
    base_price => "229.95"
    original_price => "229.95"
    cart_id => "4008222099"
    tax_value => "0"
    subtotal => "229.95"
    display_subtotal => "229.95"
    shipped_amount => "0"
    shipment_amount => "1"
  1157311813 => Array (19)
    item_id => "1157311813"
    order_id => "15"
    product_id => "744"
    product_code => "B00028DM96"
    price => "119.99"
    amount => "1"
    extra => Array (9)
      step => "1"
      product_options => Array (0)
      unlimited_download => "N"
      product => "Sharp Electronics PW-E550 Electronic ..."
      company_id => "0"
      is_edp => "N"
      edp_shipping => "N"
      base_price => "119.99"
      stored_price => "N"
    product => "Sharp Electronics PW-E550 Electronic ..."
    deleted_product => ""
    discount => "0"
    company_id => "0"
    base_price => "119.99"
    original_price => "119.99"
    cart_id => "1157311813"
    tax_value => "0"
    subtotal => "119.99"
    display_subtotal => "119.99"
    shipped_amount => "0"
    shipment_amount => "1" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-17T13:29:59.533

以下解决了它 - 如果人们将来需要做同样的事情，应该会有所帮助：

```
{foreach from=$order_info.items item=foo} 
     {$foo.product_id} 
{/foreach} 
```

# java - 使用 Hibernate 在 Java 中进行 SQLite 加密

> ID：13361790
> 
> 赞同：8
> 
> 时间：2012-11-13T13:43:47.817
> 
> 标签：java, hibernate, sqlite, encryption

我目前正在使用[hibernate-sqlite](http://code.google.com/p/hibernate-sqlite/)。

要访问动态创建的 sqlite 数据库，这非常有效。现在我想保护 sqlite 文件。经过一番研究，我发现要走的路是（[AES](http://en.wikipedia.org/wiki/Advanced_Encryption_Standard)）加密。任何人都可以向我解释这是否可以使用休眠？如果是这样，怎么办？如果这不起作用，是否有任何其他解决方案来保护文件中的数据？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T07:02:07.633

您可以使用 sqlite (System.Data.SQLite) 的内置加密。[在http://sqlite.phxsoftware.com/forums/t/130.aspx](http://sqlite.phxsoftware.com/forums/t/130.aspx)查看更多详细信息

您还可以使用 SQLCipher，它是 SQLite 的开源扩展，提供透明的 256 位 AES 数据库文件加密。[http://sqlcipher.net](http://sqlcipher.net)

因为你需要休眠

您可以使用 FluentNHibernate，您可以使用以下配置代码：

```
private ISessionFactory createSessionFactory()
{
    return Fluently.Configure()
            .Database(SQLiteConfiguration.Standard.UsingFileWithPassword(filename, password))
            .Mappings(m => m.FluentMappings.AddFromAssemblyOf<DBManager>())
            .ExposeConfiguration(this.buildSchema)
            .BuildSessionFactory();    
}

private void buildSchema(Configuration config)
{
        if (filename_not_exists == true)
        {
            new SchemaExport(config).Create(false, true);
        }
} 
```

方法`UsingFileWithPassword(filename, password)`加密数据库文件并设置密码。它仅在创建新数据库文件时运行。用这种方法打开旧的未加密的失败。

***编辑 ：***

为您提供更多选择

*   [SEE](http://www.hwaci.com/sw/sqlite/see.html) - 官方实现。
*   [wxSQLite](http://sourceforge.net/projects/wxsqlite/) - 一个 wxWidgets 风格的 C++ 包装器，它也实现了 SQLite 的加密。
*   [SQLCipher](http://sqlcipher.net/) - 使用 openSSL 的 libcrypto 来实现。
*   [SQLiteCrypt](http://sqlite-crypt.com/documentation.htm) - 自定义实现，修改 API。
*   [botansqlite3](https://github.com/OlivierJG/botansqlite3) -botansqlite3 是 SQLite3 的加密编解码器，可以使用 Botan 中的任何算法进行加密.

SEE 和 SQLiteCrypt 需要购买许可证。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-20T21:11:14.710

你知道[SQLite 的加密扩展](http://www.hwaci.com/sw/sqlite/see.html)，对吧？

# sharepoint-2010 - 从 SharePoint 2010 ECMAScript OM 中的页面库中获取发布页面

> ID：13361791
> 
> 赞同：1
> 
> 时间：2012-11-13T13:43:52.573
> 
> 标签：sharepoint-2010, sharepoint-clientobject

我想使用 JavaScript 和客户端对象模型获取特定发布 Web 中的所有页面，它不断给出

> 属性或字段尚未初始化。它尚未被请求或请求尚未执行。可能需要明确要求。

这是代码，

```
 var selectedDoc;
    var ctx = new SP.ClientContext.get_current();
        var site = ctx.get_site();
        //('created ctx');
        //loading the Library 
        var pagesLib = site.openWeb('/Ar/News').get_lists().getByTitle('Pages');

        if (missionType == 'All') {

            var query = new SP.CamlQuery();

            query.set_viewXml("<View><RowLimit>10</RowLimit></View>");
       selectedDoc = pagesLib.getItems(query);

            ctx.load(selectedDoc,'Include(Title)');

            ctx.executeQueryAsync(getAllNewsWithQuerySuccess(this,this.onListLoadSuccess), getAllNewsWithQueryFailure(this,this.onQueryFailed)); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:58:27.007

你可能错过了一个`load`电话。分配后立即尝试`pagesLib`：

```
ctx.load(pagesLib); 
```

我猜该错误是由于在`pagesLib`对它执行 CAML 查询之前没有填充。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-10-04T12:31:24.253

您可能错过了加载调用。在分配 pagesLib 后立即尝试此操作：

```
ctx.load(pagesLib); 
```

我猜该错误是由于在您对它执行 CAML 查询之前没有填充 pagesLib。

# java - 捆绑了依赖项的 JavaFX jar

> ID：13361804
> 
> 赞同：4
> 
> 时间：2012-11-13T13:44:14.273
> 
> 标签：java, maven, ant, javafx-2

我刚刚提出了一个关于使用 javafxpackager 制作 JavaFX jar 的问题，你可以[在这里](https://stackoverflow.com/questions/13359626/classpath-on-javafx-using-javafxpackager)看到。我的问题是我无法在清单中包含类路径。好吧，当我在等待答案时，我尝试`maven-antrun-plugin`了。它工作得很好，我可以使用依赖项运行我的应用程序，但是（总是有一个但是）只有在我的最终 jar 之外的依赖项。所以它是这样的：

```
FinalJar.jar
lib
  |_{all dependencies here} 
```

`JavaFX-Class-Path`我的清单文件通过属性指向依赖项。如果我将依赖项放入 jar 中，就像我想要的那样，它不会找到我的依赖项。有什么帮助吗？

**编辑：**这是将依赖项添加到 jar 中的步骤，它在 pom.xml 中：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.6</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <configuration>
                        <target>
                            <taskdef name="jfxjar" classname="com.sun.javafx.tools.ant.FXJar"
                                classpathref="maven.plugin.classpath" />
                            <jfxjar
                                destfile="${project.build.directory}/dist/${project.build.finalName}">
                                <fileset dir="${project.build.directory}/classes" />

                                <!-- Adds the dependencies to jar -->
                                <fileset dir="${project.build.directory}/lib/" includes="*.jar" />
                                <application name="${project.name}" mainClass="com.google.code.mzplay.principal.PrincipalFX" />

                                <resources>
                                    <!-- Adds the dependencies to classpath -->
                                    <fileset dir="${project.build.directory}/lib/" includes="*.jar" />
                                </resources>
                            </jfxjar>
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>com.oracle</groupId>
                    <artifactId>ant-javafx</artifactId>
                    <version>${javafx.version}</version>
                    <systemPath>${java.home}/../lib/ant-javafx.jar</systemPath>
                    <scope>system</scope>
                </dependency>
                <dependency>
                    <groupId>com.oracle</groupId>
                    <artifactId>javafx</artifactId>
                    <version>${javafx.version}</version>
                    <systemPath>${java.home}/lib/jfxrt.jar</systemPath>
                    <scope>system</scope>
                </dependency>
            </dependencies>
        </plugin> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-09-23T12:04:23.010

最后，我的POM的“构建”部分变成了这个（你可以看到它也有一个焊接部分），我已经很久没有使用它了，所以我什至不知道它是否可以了

```
<build>
    <finalName>JarName</finalName>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.4</version>
            <configuration>
                <source>1.7</source>
                <target>1.7</target>
                <encoding>UTF-8</encoding>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <version>2.3</version>
            <executions>
                <execution>
                    <id>copy-dependencies</id>
                    <phase>package</phase>
                    <goals>
                        <goal>copy-dependencies</goal>
                    </goals>
                    <configuration>
                        <includeScope>runtime</includeScope>
                        <outputDirectory>${project.build.directory}/dist/lib</outputDirectory>
                        <overWriteReleases>false</overWriteReleases>
                        <overWriteSnapshots>false</overWriteSnapshots>
                        <overWriteIfNewer>true</overWriteIfNewer>
                    </configuration>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-antrun-plugin</artifactId>
            <version>1.6</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <configuration>
                        <target>
                            <taskdef name="jfxjar" classname="com.sun.javafx.tools.ant.FXJar"
                                classpathref="maven.plugin.classpath" />
                            <jfxjar
                                destfile="${project.build.directory}/dist/${project.build.finalName}">
                                <fileset dir="${project.build.directory}/classes" />
                                <application name="${project.name}" mainClass="com.google.code.mzplay.principal.WeldJavaFXLauncher" />
                                <resources>
                                    <fileset dir="${project.build.directory}/dist/" includes="lib/*.jar" />
                                </resources>
                            </jfxjar>
                        </target>
                    </configuration>
                    <goals>
                        <goal>run</goal>
                    </goals>
                </execution>
            </executions>
            <dependencies>
                <dependency>
                    <groupId>com.oracle</groupId>
                    <artifactId>ant-javafx</artifactId>
                    <version>${javafx.version}</version>
                    <systemPath>${java.home}/../lib/ant-javafx.jar</systemPath>
                    <scope>system</scope>
                </dependency>
                <dependency>
                    <groupId>com.oracle</groupId>
                    <artifactId>javafx</artifactId>
                    <version>${javafx.version}</version>
                    <systemPath>${java.home}/lib/jfxrt.jar</systemPath>
                    <scope>system</scope>
                </dependency>
            </dependencies>
        </plugin>
        <plugin>
            <groupId>org.codehaus.mojo</groupId>
            <artifactId>sonar-maven-plugin</artifactId>
            <version>2.0</version>
        </plugin>
    </plugins>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.eclipse.m2e</groupId>
                <artifactId>lifecycle-mapping</artifactId>
                <version>1.0.0</version>
                <configuration>
                    <lifecycleMappingMetadata>
                        <pluginExecutions>
                            <pluginExecution>
                                <pluginExecutionFilter>
                                    <groupId>org.apache.maven.plugins</groupId>
                                    <artifactId>maven-dependency-plugin</artifactId>
                                    <versionRange>[2.0,)</versionRange>
                                    <goals>
                                        <goal>copy-dependencies</goal>
                                    </goals>
                                </pluginExecutionFilter>
                                <action>
                                    <execute />
                                </action>
                            </pluginExecution>
                        </pluginExecutions>
                    </lifecycleMappingMetadata>
                </configuration>
            </plugin>
        </plugins>
    </pluginManagement>
</build> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-15T09:18:13.180

它更容易使用`maven-shade-plugin`。它构建了一个包含所有依赖项的大胖 jar。您可以将其与`javafx-maven-plugin`. 我也尝试了不同的方法并玩了很长时间，这个解决方案是唯一真正有效的解决方案。此外，它很容易设置。

这是您必须添加到 pom.xml 的内容：

```
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>3.1.1</version>
            <configuration>
            </configuration>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                    <configuration>
                        <transformers>
                            <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                                <mainClass>your.package.name.Main</mainClass>
                            </transformer>
                        </transformers>
                    </configuration>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>com.zenjava</groupId>
            <artifactId>javafx-maven-plugin</artifactId>
            <version>8.8.3</version>
            <configuration>
                <mainClass>your.package.name.Main</mainClass>
            </configuration>
        </plugin>
    </plugins>
</build> 
```

在里面更改你的包名`mainClass`以获取 shade 和 javaFx 插件，你就完成了。现在您可以像往常一样使用`mvn package`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-25T03:37:13.063

你想获得一些本地应用程序吗？像exe或dmg。这是我的解决方案。先将项目制作成maven项目，然后添加一些插件以达到目标；我将分享我的 pom.xml，在你的 pom.xml 中添加这两个插件，稍后在你的终端中运行“mvn jfx:native”。

```
 <!--  this plugin will copy dependencies into target application-->

      <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-dependency-plugin</artifactId>
          <version>2.10</version>
          <executions>
              <execution>
                  <id>copy-dependencies</id>
                  <phase>package</phase>
                  <configuration>
                      <overWriteReleases>false</overWriteReleases>
                      <overWriteSnapshots>false</overWriteSnapshots>
                      <overWriteIfNewer>true</overWriteIfNewer>
                  </configuration>
                  <goals>
                      <goal>copy-dependencies</goal>
                  </goals>
              </execution>
          </executions>
      </plugin>

      <plugin>
          <groupId>com.zenjava</groupId>
          <artifactId>javafx-maven-plugin</artifactId>
          <version>8.8.3</version>
          <configuration>
              <!-- it's javafx Application's Main Class -->
              <mainClass>org.john.Main</mainClass>
              <!-- what's platform , write what kind of target name -->
              <bundler>exe</bundler>
              <!-- tell plugin where the target save-->
              <jfxAppOutputDir>${project.build.directory}/app</jfxAppOutputDir>
              <nativeOutputDir>${project.build.directory}/native</nativeOutputDir>
              <appName>Ticket</appName>
              <vendor>www.kvcoogo.com</vendor>
          </configuration>
      </plugin> 
```

# video - 在不重新编码的情况下将帧从 mp4 文件复制到 mp4 时，什么会改变 fps？

> ID：13361812
> 
> 赞同：0
> 
> 时间：2012-11-13T13:44:29.293
> 
> 标签：video, ffmpeg, frame-rate, libavcodec

我尝试将视频从 in.mp4 复制到 out.mp4 而不重新编码。我在[这里使用](https://stackoverflow.com/questions/13290413/why-decoding-frames-from-avi-container-and-encode-them-to-h264-mp4-doesnt-work)**pogorskiy** 建议的代码示例。复制过程成功，但视频播放速度非常快。[我用MediaInfo](http://mediainfo.sourceforge.net/en)检查了这两个文件的 fps 。“in.mp4”的 fps 是 25 fps，“out.mp4” 是**533fps**。我不明白如果我从构造将 fps 更改为 533 是什么？**`outStream``inStream`**

 **我希望我正确地解释了自己。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T15:25:33.587

问题在于 PTS 和 DTS 值。它们必须正确设置。

详细答案在[这里](https://stackoverflow.com/questions/13565062/fps-porblem-when-saving-video-in-mp4-container#13587332)**

# c# - 另一个 DLL 中的系统命名空间

> ID：13361816
> 
> 赞同：3
> 
> 时间：2012-11-13T13:44:50.587
> 
> 标签：c#, .net, sterling-db

这是我的问题：

我正在使用一个 DLL 库（不是来自 .NET 框架），它包含一个`System`带有`Tuple`和`Lazy`类的命名空间。

当我尝试编译我的项目时，编译器会抛出一些错误，指出这些类存在于`mscorlib.dll`另一个 DLL 中。

那么，如何使用 .NET Framework 中的类而不删除对其他 DLL 的引用？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-13T13:48:45.470

如果它们具有相同的命名空间等，那么消除歧义的唯一方法是使用`extern alias`. 在解决方案资源管理器中，`Aliases`将此恶意引用的属性更改为其他内容，例如`foo`（而不是`global`）。

现在，在您需要来自该程序集的类型的类文件中，您必须添加（在最顶部）：

```
extern alias foo; 
```

然后稍后在您可以使用的代码中：

```
foo::Some.Namespace.TheType 
```

或同样：

```
foo.Some.Namespace.TheType 
```

基本上，别名成为一个额外的消歧层次。供参考的默认别名是`global`. 然而，还要注意，虽然**编译器**对此很好，但 VS2012 IDE 仍然有一些......扭结*：*`extern alias` https: [//connect.microsoft.com/VisualStudio/feedback/details/770464/ide-but-not -compiler-incorrectly-reports-an-error-when-using-extern-alias-to-disambiguate-types](https://connect.microsoft.com/VisualStudio/feedback/details/770464/ide-but-not-compiler-incorrectly-reports-an-error-when-using-extern-alias-to-disambiguate-types)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-13T13:47:26.190

听起来您使用的第三方库是为 .NET 2.0 或 .NET 3.5 设计的。

如果第三方没有为 .NET 4+ 提供 DLL，我会感到非常惊讶*-*我强烈怀疑您可以替换目标框架版本的 DLL 并重新构建。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-13T13:47:56.320

这可能是针对 .NET 2 或 3.5 的库，它为 .NET 4 功能（[`Tuple`](http://msdn.microsoft.com/en-us/library/dd268536.aspx)和[`Lazy`](http://msdn.microsoft.com/en-us/library/dd642331.aspx)）添加了自己的实现。查找此库的更新 .NET 4 版本。

# jboss - jca-boss-beans.ml中WorkManagerThreadPool的maximumPoolSize参数是否限制了我们可以实例化的最大线程数？

> ID：13361818
> 
> 赞同：0
> 
> 时间：2012-11-13T13:44:52.717
> 
> 标签：jboss, jms, threadpool

我想知道 jca-boss-beans.xml 中服务 WorkManagerThreadPool 的参数 maximumPoolSize 是否限制了我们可以实例化的最大线程数？

谢谢你的回答，

尼古拉斯·莫让

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:24:50.230

它是可以同时处于活动状态的 JCA 连接的最大数量（每个连接由一个线程管理）。所以这个属性不限制 JBoss 使用的线程总数，而只是 JCA 连接。如果您想了解有关性能和池的更多信息，可以查看[Best Practices for Performance Tunning](http://www.jboss.com/pdf/JB_JEAP5_PerformanceTuning_wp_web.pd)。

# emacs - 如何将列表作为参数提供给elisp中的函数？

> ID：13361819
> 
> 赞同：6
> 
> 时间：2012-11-13T13:44:52.443
> 
> 标签：emacs, elisp

我正在尝试学习 elisp 和 emacs 自定义。我设置了一个变量的参数列表。如何将此列表传递给函数，而不是直接给出参数。

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-13T13:47:42.440

使用[`apply`](http://www.gnu.org/software/emacs/manual/html_node/elisp/Calling-Functions.html#index-apply)功能：

```
(apply 'function arglist) 
```

例如：

```
(apply '+ '(1 2 3 4))
==> 10 
```

# javascript - 新 Twitter 小部件的 iframe CSS 覆盖

> ID：13361823
> 
> 赞同：14
> 
> 时间：2012-11-13T13:45:00.813
> 
> 标签：javascript, html, css, iframe

我正在尝试自定义新的 Twitter 小部件，但 CSS 存在一些问题，并且似乎无法在这个新小部件上覆盖他们的问题。我已经尝试搜索解决方案，但找不到任何匹配项。

[这是我的页面](http://www.inside-guides.co.uk/brentwood/nightlife/bars/lot-75-cafe-bar-412.html)，其中右侧导航中的小部件和 .timeline 类的调整 CSS：

```
.timeline {
margin-bottom:0;
border:0 !important;
border-radius:0 !important;
-webkit-border-radius:0;
-moz-border-radius:0;
} 
```

html:

```
<div class="bg">
<h3 class="twitter">Twitter News</h3>
<div id="twitter">
<a class="twitter-timeline" href="https://twitter.com/" data-widget-id="268336500536647680">Tweets by </a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</div></div> 
```

我已经开始使用 !important 声明并尝试覆盖主要的#twitter id，但两者都不起作用。

任何想法都非常感谢。

**我显然需要以某种方式编辑 iframe，但不确定如何 - 如果有人更清楚我如何使用我的代码（而不是教程）来做到这一点，那就太好了。我还需要更改 iframe 宽度..

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-26T13:03:34.137

我设法用 javascript 做到了这一点（我在我的应用程序中使用了 jQuery！）。您必须在 iframe 加载后应用样式（我没有找到有效的“加载”事件，所以我使用轮询策略）。

```
// Customize twitter feed
var hideTwitterAttempts = 0;
function hideTwitterBoxElements() {
    setTimeout( function() {
        if ( $('[id*=twitter]').length ) {
        $('[id*=twitter]').each( function(){
            if ( $(this).width() == 220 ) {
                $(this).width( 198 ); //override min-width of 220px
            }
            var ibody = $(this).contents().find( 'body' );
            ibody.width( $(this).width() + 20 ); //remove scrollbar by adding width

            if ( ibody.find( '.timeline .stream .h-feed li.tweet' ).length ) {
            ibody.find( '.timeline' ).css( 'border', 0 );
            ibody.find( '.timeline .stream' ).css( 'overflow-x', 'hidden' );
            ibody.find( '.timeline .stream' ).css( 'overflow-y', 'scroll' );
            ibody.find( '.timeline-header').hide();
            ibody.find( '.timeline-footer').hide();
            }
            else {
                $(this).hide();
            }
        });
        }
        hideTwitterAttempts++;
        if ( hideTwitterAttempts < 3 ) {
            hideTwitterBoxElements();
        }
    }, 1500);
}

// somewhere in your code after html page load
hideTwitterBoxElements(); 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-05T16:44:06.013

对于任何感兴趣的人来说，这是没有 jQuery 的。

更新了更好的解决方案，该解决方案不依赖轮询，因此有时不会出现无样式布局：

```
twttr.events.bind('rendered',function(){
  [].slice.call(document.querySelectorAll('iframe.twitter-timeline')).forEach(function(e,i,a){
    var fE = e.contentDocument.getElementsByClassName('timeline-footer');
    if(fE.length){
      fE[0].style.backgroundColor='transparent';
    }
  });
}); 
```

旧版：

```
// Customize twitter feed                                                                              
var hideTwitterAttempts = 0;                                                                           
function hideTwitterBoxElements() {                                                                    
    setTimeout( function() {                                                                           
        var list = document.getElementsByTagName('iframe');                                            
        if (list.length ) {                                                                            
            Array.prototype.forEach.call(                                                              
                list,                                                                                  
                function(element){                                                                     
                    var footerE = element.contentDocument.getElementsByClassName('timeline-footer')[0];
                    footerE.style.backgroundColor="transparent";                                       
                });                                                                                    
        }                                                                                              
        hideTwitterAttempts++;                                                                         
        if ( hideTwitterAttempts < 3 ) {                                                               
            hideTwitterBoxElements();                                                                  
        }                                                                                              
    }, 1500);                                                                                          
}                                                                                                      
hideTwitterBoxElements(); 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-07-16T05:26:28.390

我改编了@Sebastiaan Ordelman 的代码并添加了一些注释（引用旧 API 中的值）。这是我尝试在短时间内匹配旧 API。将此代码放在新 twitter 小部件中的新复制和粘贴代码之后。

```
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.1/jquery.min.js"></script>
<script>
var hideTwitterAttempts = 0;
function hideTwitterBoxElements() {
    setTimeout( function() {
        if ( $('[id*=twitter]').length ) {
        $('[id*=twitter]').each( function(){
            var ibody = $(this).contents().find( 'body' );

            if ( ibody.find( '.timeline .stream .h-feed li.tweet' ).length ) {
            ibody.find( '.customisable-border' ).css( 'border', 0 );
            ibody.find( '.timeline' ).css( 'background-color', '#004A7B' ); //theme: shell: background:
            ibody.find( 'ol.h-feed' ).css( 'background-color', '#0575A1' ); //theme: tweets: background:
            ibody.find( 'ol.h-feed' ).css( 'border-radius', '5px 5px 5px 5px' );
            ibody.find( 'li.tweet' ).css( 'border-bottom', '1px dotted #FFFFFF' ); //theme: tweets: color:
            ibody.find( 'li.tweet' ).css( 'color', '#FFFFFF' ); //theme: tweets: color:
            ibody.find( '.customisable:link' ).css( 'color', '#07E0EB' ); //theme: tweets: links:
            ibody.find( '.footer' ).css( 'visibility', 'hidden' ); //hide reply, retweet, favorite images
            ibody.find( '.footer' ).css( 'min-height', 0 ); //hide reply, retweet, favorite images
            ibody.find( '.footer' ).css( 'height', 0 ); //hide reply, retweet, favorite images
            ibody.find( '.avatar' ).css( 'height', 0 ); //hide avatar
            ibody.find( '.avatar' ).css( 'width', 0 ); //hide avatar
            ibody.find( '.p-nickname' ).css( 'font-size', 0 ); //hide @name of tweet
            ibody.find( '.p-nickname' ).css( 'visibility', 'hidden' ); //hide @name of tweet
            ibody.find( '.e-entry-content' ).css( 'margin', '-25px 0px 0px 0px' ); //move tweet up (over @name of tweet)
            ibody.find( '.dt-updated' ).css( 'color', '#07E0EB' ); //theme: tweets: links:
            ibody.find( '.full-name' ).css( 'margin', '0px 0px 0px -35px' ); //move name of tweet to left (over avatar)
            ibody.find( 'h1.summary' ).replaceWith( '<h1 class="summary"><a class="customisable-highlight" title="Tweets from fundSchedule" href="https://twitter.com/fundschedule" style="color: #FFFFFF;">fundSchedule</a></h1>' ); //replace Tweets text at top
            ibody.find( '.p-name' ).css( 'color', '#07E0EB' ); //theme: tweets: links:
            }
            else {
                $(this).hide();
            }
        });
        }
        hideTwitterAttempts++;
        if ( hideTwitterAttempts < 3 ) {
            hideTwitterBoxElements();
        }
    }, 1500);
}

// somewhere in your code after html page load
hideTwitterBoxElements();
</script> 
```

更改图片：http: [//img837.imageshack.us/img837/1139/btjc.png](http://img837.imageshack.us/img837/1139/btjc.png)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-11-20T10:36:52.140

This doesn't directly answer CSS aspect of the question, but I think it's worth noting for completeness that some of what you want (eg hide borders / header) can be done using the data- attributes passed in the widget:

```
<a class="twitter-timeline" href="https://twitter.com/twitterapi" 
    data-widget-id="YOUR-WIDGET-ID-HERE" 
    data-theme="dark"
    data-chrome="noheader nofooter noborders noscrollbar transparent"
    data-link-color="#cc0000"
    width="200"
    height="300"
    >Tweets by @twitterapi</a> 
```

[https://dev.twitter.com/docs/embedded-timelines#customization](https://dev.twitter.com/docs/embedded-timelines#customization)

Maybe there's a performance benefit to minimising javascript arm wrestling where possible?

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-11-13T13:49:09.423

他们创建了一个 iframe，因此它是另一个文档。

您不能在另一个文档中设置元素的样式，因此除非 twitter 提供一个挂钩来将您自己的样式表嵌入到他们的 iframe 中，否则这是不可能的。

Twitter 只允许设置[小部件的链接颜色](https://dev.twitter.com/docs/embedded-timelines#customization)并选择浅色/深色主题。

* * *

[或者，您可以使用twitter API](https://dev.twitter.com/docs)创建自己的小部件，然后您可以随意设置它的样式。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-12-08T19:00:03.543

使用 twitter 事件结构可能会更好。

根据[https://dev.twitter.com/web/javascript/loading](https://dev.twitter.com/web/javascript/loading)

```
<script>window.twttr = (function (d, s, id) {
  var t, js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src= "https://platform.twitter.com/widgets.js";
  fjs.parentNode.insertBefore(js, fjs);
  return window.twttr || (t = { _e: [], ready: function (f) { t._e.push(f) } });
}(document, "script", "twitter-wjs"));</script> 
```

并且根据[https://dev.twitter.com/web/javascript/events](https://dev.twitter.com/web/javascript/events) ，您的事件和连接看起来像这样（请记住，此示例使用 jquery，您可以选择仅使用 javascript 的方法）

```
twttr.ready( function(twttr){
    twttr.events.bind("rendered", function(tw_event){
    var tw_iframe = ev.target;

    //the following is custom jquery code to do various 
    //css overrides based on selectors
    var twitterbody = $(tw_iframe).contents().find( 'body' );
       twitterbody.find(".avatar").hide();
       twitterbody.find("li.tweet").css({padding: "2px"});
    });
}); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-05-15T11:18:44.250

我不知道当时问这个问题时是否有可能，但现在可以了，请查看[文档](https://dev.twitter.com/docs/embedded-timelines#options)：

```
<a class="twitter-timeline" data-chrome="nofooter" ....">Tweets</a> 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-11-13T14:03:02.853

如上所述，您不能在不同来源的 iframe 中更改 CSS，这里有一些信息：

[如何将 CSS 应用于 iframe？](https://stackoverflow.com/questions/217776/how-to-apply-css-to-iframe)

[http://www.jquery4u.com/dom-modification/jquery-change-css-iframe-content/](http://www.jquery4u.com/dom-modification/jquery-change-css-iframe-content/)

# mysql - 从表中选择 count(col), max(col), column_name_data

> ID：13361832
> 
> 赞同：1
> 
> 时间：2012-11-13T13:45:58.200
> 
> 标签：mysql, sql

我该怎么做`select count(artc_id) as cval, max(srt_id) as maxval, artc_title from table where artc_pub = 1`

所以我可以得到如下结果：

```
 cval | maxval | artc_title | artc_pub
    -----------------------------------------
       4         4     Title 1         1 
                       Title 2         1
                       Title 3         1
                       Title 4         1 
```

我的部分表格如下

```
artc_id | srt_id | artc_title | artc_pub
-----------------------------------------
   1         1     Title 1         1 
   2         2     Title 2         1
   3         3     Title 3         1
   4         4     Title 4         1
   1         5     Title 1         2
   2         6     Title 2         2 
```

我试过`select count(artc_id) as cval, max(srt_id) as maxval, artc_title from table where artc_pub = 1`了，但这只给了我一行第一个标题。我想这里肯定不仅仅是一个普通的旧选择。

下面的所有答案都给了我这样的结果：

```
cval;maxval;artc_title
1   ;     1; Title 1
1   ;     2; Title 2
1   ;     3; Title 3
1   ;     4; Title 4
1   ;     5; Title 5 
```

不像我在问题中提到的那样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T16:01:36.377

我认为最好有 2 个查询，一个用于聚合，一个用于标题：

```
SELECT COUNT(*) AS cval, 
       MAX(srt_id) AS maxval
FROM table 
WHERE artc_pub = 1 ;

SELECT artc_title 
FROM table 
WHERE artc_pub = 1 ; 
```

* * *

您还可以使用该`GROUP_CONCAT()`函数将标题组合成一行：

```
SELECT COUNT(*) AS cval, 
       MAX(srt_id) AS maxval,
       GROUP_CONCAT(artc_title ORDER BY srt_id SEPARATOR ', ') 
           AS artc_title  
FROM table 
WHERE artc_pub = 1 ; 
```

* * *

您也可以将这两者与连接结合起来，但您将返回大量重复数据：

```
SELECT ag . cval, 
       ag . maxval, 
       t  . artc_title 
FROM 
    ( SELECT COUNT(*) AS cval, 
             MAX(srt_id) AS maxval
      FROM table 
      WHERE artc_pub = 1 
    ) AS ag
  CROSS JOIN
    table AS t 
WHERE t.artc_pub = 1 ; 
```

如果 MySQL 曾经获得窗口函数（乐观主义者阅读：何时获得），上面的代码将被写成：

```
SELECT COUNT(*) OVER ()    AS cval, 
       MAX(srt_id) OVER () AS maxval, 
       artc_title 
FROM table 
WHERE artc_pub = 1 ; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:48:53.950

您应该可以在`GROUP BY`此处使用“文章标题”对结果进行分组：

```
SELECT
    COUNT(artc_id) AS cval,
    MAX(srt_id) AS maxval,
    artc_title
FROM
    table
WHERE
    artc_pub = 1
GROUP BY
    artc_title
ORDER BY
    artc_title; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:49:01.510

`GROUP BY artc_title`像这样：

```
select 
  count(artc_id) as cval, 
  max(srt_id) as maxval, 
  artc_title 
from table 
where artc_pub = 1
GROUP BY artc_title 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:49:21.633

你错过了你的分组术语

```
 SELECT count(artc_id) AS cval, max(srt_id) AS maxval, artc_title 
       FROM table
       WHERE artc_pub = 1
       GROUP BY artc_title 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-13T13:51:30.930

你试过了吗>>

```
select count(artc_id) as cval, max(srt_id) as maxval, artc_title from table where artc_pub = 1 Group By artc_title 
```

我希望这会奏效。

# java - Android上的SimpleXML和反序列化时出错

> ID：13361839
> 
> 赞同：2
> 
> 时间：2012-11-13T13:46:17.030
> 
> 标签：java, android, deserialization, unmarshalling, simple-framework

我正在尝试使用 SimpleXML 反序列化 Android 设备上的对象。在一个 Maven 文件中，我使用了排除项的依赖项（我在另一个问题中遵循了建议，因为不排除这些依赖项，我无法启动应用程序）：

```
<dependency>
    <groupId>org.simpleframework</groupId>
    <artifactId>simple-xml</artifactId>
    <version>2.6.7</version>
     <exclusions>
    <!-- StAX is not available on Android -->
    <exclusion>
        <artifactId>stax</artifactId>
        <groupId>stax</groupId>
    </exclusion>
    <exclusion>
        <artifactId>stax-api</artifactId>
        <groupId>stax</groupId>
    </exclusion>
    <!-- Provided by Android -->
    <exclusion>
        <artifactId>xpp3</artifactId>
        <groupId>xpp3</groupId>
    </exclusion>
</exclusions> 
```

为了测试，我只写了一个简单的类：

```
class Test {
        String s;
    } 
```

我试图得到一个对象：

```
Test t = null;
try {
    t = serializer.read(Test.class, source);
} catch (Exception e) {
    e.printStackTrace();
}

Log.v("t",t.s); 
```

但在最后一行，当我尝试读取字段 ts 时，我收到了如下错误：

```
Could not find method javax.xml.stream.XMLInputFactory.newInstance, referenced from method org.simpleframework.xml.stream.StreamProvider.<init>

unable to resolve static method 3372: Ljavax/xml/stream/XMLInputFactory;.newInstance ()Ljavax/xml/stream/XMLInputFactory;

dead code 0x0006-0009 in Lorg/simpleframework/xml/stream/StreamProvider;.<init> 

unable to find class referenced in signature (Ljavax/xml/stream/XMLEventReader;) 
```

问题的原因可能是什么，我该如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-04T00:06:42.943

您必须为您的课程添加注释。我用 Simple XML 2.6.9（`simple-xml-2.6.9.jar`仅限）做了一个小测试——>没问题。

**XML:**

```
<test>
   <s>abc</s>
</test> 
```

**测试类：**

```
@Root
public class Test
{
    @Element
    String s;

    @Override
    public String toString()
    {
        return "Test{" + "s=" + s + '}';
    }
} 
```

**反序列化 XML：**

```
final File f =  ...

Serializer ser = new Persister();
Test t = ser.read(Test.class, f);

System.out.println(t); 
```

**输出：**

```
Test{s=abc} 
```

# git - 如何在源代码控制存储库中搜索关键字

> ID：13361841
> 
> 赞同：0
> 
> 时间：2012-11-13T13:46:26.417
> 
> 标签：git, svn, search, version-control, repository

我正在寻找一个脚本或应用程序，它可以使用一些关键字（如错误、缺陷、修复等）在 svn 或 git 的存储库、配置文件、提交历史等中查找。应用程序可以采用任何存储库链接和关键字和然后产生结果。任何帮助深表感谢。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:01:09.393

对于 Subversion，您可以尝试

*   [SVN-搜索](http://sourceforge.net/projects/svn-search/)或
*   [SVN查询](http://svnquery.tigris.org/)。

让 Git 查找提交消息包含您可以使用的给定关键字的所有提交

```
$ git log --grep=keyword 
```

或使用镐搜索

```
$ git log -Skeyword 
```

[OpenGrok](http://opengrok.github.io/OpenGrok/)，一个源代码搜索和交叉引用引擎，也将是一个可能的候选者。

# tridion - 运行 TcmReindex.exe 时出错

> ID：13361842
> 
> 赞同：1
> 
> 时间：2012-11-13T13:46:28.853
> 
> 标签：tridion, tridion-2011

我目前正在尝试在我的 Tridion 2011 安装中进行搜索。我在[另一篇文章](https://stackoverflow.com/questions/10452589/what-fields-does-sdl-tridion-2011-search-use)中读到，我应该在 Tridion/bin 文件夹中运行 TcmReIndex.exe 工具来重新索引我的所有网站。所以我尝试了这个，但它失败了一个消息框，给出了以下详细信息

```
Unable to get list of Publication items.
Unable to Intialize TDSE object.
The wait operation timed out
Connection Timeout Expired.  The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement.  This could be because the pre-login handshake failed or the server was unable to respond back in time.  The duration spent while attempting to connect to this server was - [Pre-Login] initialization=21054; handshake=35; 
The wait operation timed out
A database error occurred while executing Stored Procedure "EDA_TRUSTEES_GETTRUSTEEETOKEN" 
```

我有四个相当大的出版物（总共 100 000 多个项目），我正在尝试编制索引。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T15:09:35.300

每当我收到“无法初始化 TDSE 对象”时。错误，我通常使用 VBScript 编写一个小测试脚本，并尝试在 CMS 服务器上运行它。虽然这并不能直接解决问题，但它通常可以通过在事件查看器中记录信息来深入了解问题。`test.vbs`尝试按如下方式创建文件并运行它：

```
Set tdse = CreateObject("TDS.TDSE")
tdse.initialize()
msgbox(tdse.User.Description)
Set tdse = Nothing 
```

如果它抛出任何错误，请告诉我，它可能会帮助我们解决问题。如果它给你一个带有用户描述的弹出窗口，那么我完全是在找错树。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T08:45:41.377

我还没有得出任何结论，但似乎我的问题可能只是暂时的，因为它刚刚开始工作。我确实将`Tridion MMC`>中的所有超时增加`Timeout Settings`了 100 倍，但我怀疑这不是问题，当它工作时，连接几乎是即时的。

如果其他人有这个问题

1.  重新启动安装了内容管理器的计算机，再试一次。
2.  等一两个小时，再试一次。
3.  增加超时，再试一次。

我已经多次运行该过程，它似乎工作正常。

# jquery - 手风琴中的子元素优先

> ID：13361849
> 
> 赞同：1
> 
> 时间：2012-11-13T13:47:00.543
> 
> 标签：jquery, parent-child

嗨，这是我的第一篇文章！希望有人可以帮助我。

我对 jQuery 和脚本很陌生。

我有一个带有 3 个菜单级别的手风琴式菜单，加载时打开一个特定级别。

第二层内的线是一个跨度，它将使用 onClick 函数更新谷歌地图的位置。

目前，单击跨度会更改地图，但它**不会**激活手风琴菜单的正确功能。

请看这个 jfiddle：[1] (http://jsfiddle.net/chriscdk/WQhvR/1/)

例如，当您单击伯明翰时，地图会发生变化（您在小提琴中看不到），但相应的链接不会显示。您需要单击右侧（在 li 中）才能使其正常工作。

尝试缩小伦敦菜单也是如此。

（上面的两个例子都是默认加载的）我希望这个解释是有道理的！任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T14:22:38.673

您`<span>`在伯明翰和伦敦周围的元素导致您的脚本不符合`if (this == event.target)`条件。

# python - Python中的多个参数类

> ID：13361850
> 
> 赞同：1
> 
> 时间：2012-11-13T13:47:07.190
> 
> 标签：python, class, polynomial-math

我有一个父方程，需要先计算一些值。例如：

```
parent = child1*1 + child2*2 ... 
```

但是，每个孩子都需要灵活地根据可以更改的参数计算其值。我在想一个类可能是在 Python 中执行此操作的方法，但是我不熟悉如何有效地执行此操作。

那么，问题的核心是，我如何编写一个类来接受多个参数，以便稍后与 fsolve 一起使用？像这样的东西？

```
class parent:
    def __init__(self, x):
        self.child1 = 1*x + 2*x ...
        self.child2 = x**2 + x**3 ...

print(parent.child1(500) + parent.child2(1000)) 
```

编辑澄清：

好吧，我试图保持这个概括，但我想我的具体问题可能是有启发性的。我正在尝试计算某些燃料燃烧时的温度。作为第一步，我需要弄清楚理想气体近似值的焓差异。这些焓按以下形式计算：

'H° - H°298.15= A*t + B*t2/2 + C*t3/3 + D*t4/4 - E/t + F - H'

其中 A、B、C 等是特定的数值。但是，如果我更改组件，例如我必须同时计算 O2 和 N2，则 N2 的 A、B、C 值与 O2 不同。我试图将这些组件用作子组件，即：

'self.N2 = A1*t ...' 'self.O2 + A2*t ...'

父方程的形式为：

'0 = h.N2(t) + h.O2(t) + 其他东西'

fsolve 出现是因为我需要找出 't' 等于什么，但我需要在父类级别评估 't'。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:53:49.543

在我看来，您正在寻找`numpy.poly1d`. 这提供了一个比您真正希望自己实现的更强大的多项式类......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:52:53.433

你可以使用这样的方法：

```
class parent:
    def __init__(self, x):
       self.__child1 = 1*x
       self.__child2 = 2*x

    def child1(x):
        return self.__child1*x

    def child2(x):
        return self.__child2*x 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T13:55:13.937

这不会做任何接近我认为你所期望的事情。

您需要的是多个参数。

```
class parent:
    def __init__(self, x1, x2):
        self.child1 = 1*x1 + 2*x1 ...
        self.child2 = x2**2 + x2**3 ...

>> x = parent(500,1000)
>> print(x.child1+x.child2)
987638461 
```

虽然你最好用一个简单的函数而不是一个类......

```
def poly_wants_a_cracker(x1,x2):
    child1 = 1*x1 + 2*x1 ...
    child2 = x2**2 + x2**3 ...
    return child1 + child2

>>poly_wants_a_cracker(500,1000)
987638461 
```

987638461 是您的答案，具体取决于您实际在做什么

# c# - 如何从 bindingContext 中检索我的自定义对象？

> ID：13361855
> 
> 赞同：0
> 
> 时间：2012-11-13T13:47:30.920
> 
> 标签：c#, asp.net-mvc-3, custom-model-binder

我遇到的问题是，当我尝试通过 GetValue("Budget") 检索时，自定义模型活页夹为空，但如您所见，活页夹包含前缀。如果我查看元数据，我也会得到所有的密钥，但仍然是 NULL。任何人都可以解释为什么我得到 NULL ？

**我的视图 > List.cshtml**

```
for (var i = 0; i < Model.Budget.BudgetRader.Count; i++)
    {

        if (Model.Budget.BudgetRader[i].Konto != -1) { 
               <tr id="@Model.Budget.BudgetRader[i].RadNr1 +'-'+ @Model.Budget.BudgetRader[i].RadNr2 +"-"+ @Model.Budget.BudgetRader[i].RadNr3">        
                   <td>@Html.TextBoxFor(m => Model.Budget.BudgetRader[i].BudgetBelopp)</td>
               </tr>}
    } 
```

**我的 ViewModel > BudgetListViewModel**

```
public class BudgetListViewModel
{        
    public Budget Budget { get; set; }

    public IList<BudgetRad> BudgetRaderList { get; set; }        
} 
```

**我的自定义模型绑定器 > BudgetListModelBinder**

```
 public object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {

        //var budgetListViewModel = (BudgetListViewModel) bindingContext.Model;

        //true
        var exists = bindingContext.ValueProvider.ContainsPrefix("Budget"); 

        // gives null
        var tmp = bindingContext.ValueProvider.GetValue(bindingContext.ModelName); 

        // gives null
        var tmp2 = controllerContext.HttpContext.Request.Form.Get("Budget"); 

    } 
```

**环球网**

```
private void RegisterModelBinders()
    {
        ModelBinders.Binders.Add(typeof(BudgetListViewModel), new BudgetListModelBinder());
    } 
```

# c - 为什么我的 webkit 在 /usr/lib/mozilla/plugins 目录下找不到 libflashplayer.so

> ID：13361861
> 
> 赞同：0
> 
> 时间：2012-11-13T13:47:50.333
> 
> 标签：c, linux, flash, webkit, webkitgtk

我正在为 Linux 的 GTk+3.0 和 webkitGTK+ 开发一个应用程序，它应该在 WebView 中播放 swf 文件。首先，我尝试从设备打开 swf 文件，而不是通过互联网打开，但没有成功。WebView 出现了，但在 WebView 内我只能看到一个白屏（缺少插件）。如果我将相同的 URL 加载到设备浏览器，则 Flash 文件可以正常播放。我得到了 libflashplayer.so 并安装

sudo cp libflashplayer.so /usr/lib/mozilla/plugins/libflashplayer.so sudo mkdir /opt/google/chrome/plugins sudo cp libflashplayer.so /opt/google/chrome/plugins

我想我在 WebView 设置上遗漏了一些东西，但是经过几个小时的搜索和谷歌搜索后，我仍然不知道是什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-01-03T02:16:56.920

如今，如果安装到`/usr/lib/mozilla/plugins`. （WebKit 不查看，`/opt/google/chrome/plugins`所以放在那里没有效果。）

在您发布此问题时，WebKitGTK+ 无法处理 Flash，因为 Flash 链接到 GTK+ 2，而您的应用程序正在使用 GTK+ 3。不可能在同一个应用程序中混合使用两个版本的 GTK+；尝试加载 Flash 插件会导致您的应用程序挂起，因此 WebKit 跳过了该插件。所以问题是*Adob​​e Flash 与 GTK+ 3 不兼容*。

如今，WebKitGTK+ 在单独的插件进程中运行插件，因此这不再是问题。它有两个独立的插件进程，一个链接到 GTK+ 3，一个链接到 GTK+ 2，并在运行时选择正确的插件进程用于插件。

# database - node.js关于存储数据的一些问题

> ID：13361869
> 
> 赞同：1
> 
> 时间：2012-11-13T13:48:03.413
> 
> 标签：database, json, node.js

我试图了解 node.js 是如何工作的。

1）我想存储数据，但我不知道哪种方法更快： - 使用 sql - 使用 json 文件（如果这是一个好的解决方案，你有一个最佳实践教程）

2）一个多语言网站，将翻译存储在json文件中是一个好的解决方案还是有最佳实践？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T15:38:58.510

1.  使用 JavaScript 处理 JSON 比使用 SQL 更快，因为它是原生的，所以我总是尽可能使用 JSON 而不是 node.js 的任何其他数据格式。在存储 JSON 方面，您可以选择 NoSql 解决方案，例如：MongoDB 或 CouchDB。

    此[链接](http://www.mongodb.org/display/DOCS/Tutorial)将帮助您开始使用 MongoDB。

2.  多语言网站有很多选择，您可以根据需要使用谷歌翻译或大量其他插件。如果您想存储文字翻译，那么 NoSql DB 可以正常工作。在最佳实践方面，请参阅[此问题](https://stackoverflow.com/questions/487776/what-are-the-best-practices-for-multilanguage-sites)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-02T11:18:51.643

对于翻译，您最好使用国际化模块，无论它是什么语言或框架。在 Node.JS 中，您有 i18n-node 用于国际化。您的翻译将存储在 JSON 文件中。还有其他模块可以将您的翻译存储在数据库中。

# java - 如何使用 Jackson 将 Object 类发送到服务器？

> ID：13361872
> 
> 赞同：2
> 
> 时间：2012-11-13T13:48:19.613
> 
> 标签：java, android, json, casting, jackson

我有一个像这样的消息类：

```
class Message {
   @JsonProperty("content")
   Object content;
} 
```

其中内容属性可以是 a `User`、 a`Post`或 a `String` ，我必须将此对象发送到服务器并将内容转换为正确的类。

我正在使用 Jackson 注释来序列化 JSON，但是当我尝试转换内容时，会出现错误，因为属性内容像`LinkedHashMap`对象一样到达服务器。

错误是：

```
ERROR [org.apache.catalina.core.ContainerBase.[jboss.web].[default-host].[/MegaRadarSocial].[Resteasy]] (http-localhost-127.0.0.1-8080-1) Servlet.service() for servlet Resteasy threw exception: org.jboss.resteasy.spi.UnhandledException: java.lang.ClassCastException: java.util.LinkedHashMap cannot be cast to br.com.megaradar.megaradarsocial.model.User 
```

我想帮助铸造...谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:14:41.637

当您控制两端（服务器和客户端）时，您可以尝试 Genson 库[http://code.google.com/p/genson/](http://code.google.com/p/genson/)。它的一项功能允许您序列化为 json 和类型信息，这使您能够反序列化回正确的类型。

```
Genson genson = new Genson.Builder().setWithClassMetadata(true).create();
json = genson.serialize(yourMessage);

// then deserialize it back
Message message = genson.deserialize(json, Message .class); 
```

序列化的 json 看起来像： {"content": {"@class":"package.path.Message", ...对象值...}}

您甚至可以为序列化的类定义别名

```
new Genson.Builder().addAlias("message", Message.class) 
```

**重要提示**：注意两边需要使用相同的genson配置。因此，使用 setWithClassMetadata 启用类型信息，如果使用别名，则必须在客户端定义相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T01:13:05.253

您需要的是`@JsonTypeInfo`注释，如下所示：

```
class Message {
 @JsonTypeInfo(use=JsonTypeInfo.Id.CLASS, include=JsonTypeInfo.As.PROPERTY property="type")
 @JsonProperty("content")
 Object content;
} 
```

（您可以查看[http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html](http://programmerbruce.blogspot.com/2011/05/deserialize-json-with-jackson-into.html)示例）

这将在序列化时添加以类名作为值的属性“类型”（也有许多替代方法），并在反序列化时使用它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-10T13:25:46.727

谢谢你的所有答案。但我找到了另一种将我的对象转换为我想要的任何类型的方法。我正在使用对象中的`convertValue`方法`ObjectMapper`。然后，我可以模拟铸造。

再次感谢

# bash - 如何在 AWK 中一次删除多个列和字段分隔符？

> ID：13361876
> 
> 赞同：6
> 
> 时间：2012-11-13T13:48:24.723
> 
> 标签：bash, csv, awk

我有一个包含数千列的大文件。我想在 Bash 中使用 AWK 一次删除一些特定的列和字段分隔符。

我可以使用这个 oneliner 一次删除一列（将删除第 3 列及其相应的字段分隔符）：

```
awk -vkf=3 -vFS="\t" -vOFS="\t" '{for(i=kf; i<NF;i++){ $i=$(i+1);}; NF--; print}' < Big_File 
```

但是，我想一次删除几列...有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T14:01:13.163

您可以将要从 shell 中删除的列列表传递给`awk`这样的：

```
awk -vkf="3,5,11" ... 
```

然后在`awk`程序中将其解析为数组：

```
split(kf,kf_array,",") 
```

然后遍历所有列并测试每个特定列是否在 kf_array 中并可能跳过它

另一种可能性是多次致电您的oneliner :-)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-13T14:19:30.367

这是卡米尔想法的实现：

```
awk -v remove="3,8,5" '
  BEGIN {
    OFS=FS="\t"
    split(remove,a,",")
    for (i in a) b[a[i]]=1
  }                                                          
  {
    j=1
    for (i=1;i<=NF;++i) {
      if (!(i in b)) { 
        $j=$i
        ++j
      }
    }
    NF=j-1
    print
  }
' 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-13T14:41:46.927

如果您可以使用`cut`代替`awk`，则使用以下内容更容易`cut`：

例如，这会从文件中获取第 1,3 列和第 50 列：

`cut -f1,3,50- file`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T13:39:55.090

像这样的东西应该工作：

```
awk -F'\t' -v remove='3|8|5' '
{
   rec=ofs=""
   for (i=1;i<=NF;i++) {
      if (i !~ "^(" remove ")$" ) {
         rec = rec ofs $i
         ofs = FS
      }
   }
   print rec
}
' file 
```

# sql - MS Access 表单中的查询驱动列表框：选择仅在与查询匹配时可见

> ID：13361878
> 
> 赞同：1
> 
> 时间：2012-11-13T13:48:31.413
> 
> 标签：sql, ms-access, listbox

我之间有 1:1 的关系，让我们简单地称它们为对象和人。每个对象可以有零个或一个人。该对象具有由对象组 ID 和对象 ID 组成的复合主键。现在我的用户想要一种方便的方式来填写缺失的数据，所以我创建了一个表单，显示所有没有指定人员的对象。该表单是一个包含三列的数据表：组 ID、对象 ID 和人员键（当打开表单时，所有行当然是空的）。

因为某些对象很可能与同一组中的其他对象具有相同的人，所以我将人员 ID 字段创建为列表框，由返回当前所选组的所有人员的查询提供支持，因此用户可以只需通过下拉菜单添加它们。从查询中引用了包含组ID的表单控件，并且在选择更改时将要求列表框。

到目前为止它有效。我现在的问题是，当我分配一个人后选择另一个组的任何对象时，分配人的单元格内容消失了。我将人员分配给几个对象进行测试，并注意到人员列仅显示当前选定对象组的分配人员。如果我从另一个组中选择一个对象，它们就会消失（并且另一个对象的人会出现）。如果我再次从同一组中选择一个对象，则分配的人又在那里。因此，仅当相应行的查询结果包含分配的人员时，分配的人员才可见。

数据虽然被保存。分配的人员立即保存到对象表中。

# asp.net - 带有 asp.net Webmail 助手的友好“发件人”名称

> ID：13361880
> 
> 赞同：1
> 
> 时间：2012-11-13T13:48:37.257
> 
> 标签：asp.net, visual-studio-2010, webmail, webmatrix-2, razor-2

我在我的 ASP.NET 剃须刀网页程序中使用 webmail 帮助程序。我能够完美地发送电子邮件。

我的问题：

WebMail 帮助程序是否允许我使用“友好”发件人名称，而不仅仅是：noreply@mycompany.com？例如：

Webmail.From =*友好名称 + 电子邮件*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-14T14:07:21.863

否 - WebMail 帮助程序不允许您设置显示名称。如果您需要该功能，则必须直接使用 System.Net.Mail 类。这样，您可以使用[接受两个字符串的 MailAddress 类构造函数](http://msdn.microsoft.com/en-us/library/1s17zfkf.aspx)- 一个表示电子邮件地址，另一个表示显示名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-07T15:39:04.563

要添加友好名称，请编辑 WebMail 类的 .From 字段并使其：

```
WebMail.From = "\"Friendly Name\" <friendly.name@example.com>"; 
```

# php - 安全表数据输入 PHP/PDO/MySQL

> ID：13361890
> 
> 赞同：2
> 
> 时间：2012-11-13T13:48:58.870
> 
> 标签：php, mysql, pdo

我正在尝试学习 PDO 的基础知识。我已经构建了以下内容，将数据插入到我的表中，但我想获得有关这是否安全或是否可以做得更好的反馈？

我的帖子变量是否需要像您一样转义`mysql_real_escape_string()`？

```
$firstname = $_POST['First_Name'];
$surname = $_POST['Surname'];
$nicknames = $_POST['Nicknames'];
$age = $_POST['Age'];

// Connection data (server_address, database, name, poassword)
$hostdb = 'localhost';
$namedb = 'tsite_co_uk';
$userdb = 'access@site.co.uk';
$passdb = 'password';

try {
  // Connect and create the PDO object
  $conn = new PDO("mysql:host=$hostdb; dbname=$namedb", $userdb, $passdb);
  $conn->exec("SET CHARACTER SET utf8");      // Sets encoding UTF-8
  $conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

  // Define an insert query
  $sql = "INSERT INTO `directory` 

  (`First_Name`,`Surname`,`Nicknames`,`Age`) 

  VALUES ('$firstname','$surname','$nicknames','$age')

  ";

  $count = $conn->exec($sql);

  $conn = null;        // Disconnect
}
catch(PDOException $e) {
  echo $e->getMessage();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T13:54:30.023

这不安全——您没有采取任何措施来防止用户提供的 $_POST 值进行 SQL 注入。您应该使用准备好的语句并将 vales 绑定到它们：

```
$conn = new PDO("mysql:host=$hostdb; dbname=$namedb", $userdb, $passdb);
$conn->exec("SET CHARACTER SET utf8");      // Sets encoding UTF-8
$conn->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

 $sql = "INSERT INTO `directory`  (`First_Name`,`Surname`,`Nicknames`,`Age`) 
     VALUES (:firstname ,:surname,:nicknames ,:age) ";

 $statement = $conn->prepare($sql);
 $statement->bindValue(":firstname", $firstname);
 $statement->bindValue(":surename", $surename);
 $statement->bindValue(":nicknames", $nicknames);
 $statement->bindValue(":age", $age);

 $count = $statement->execute(); 
```

# ios - 使用 ZBar 扫描 QR 码时出现初始焦点问题

> ID：13361893
> 
> 赞同：1
> 
> 时间：2012-11-13T13:49:05.780
> 
> 标签：ios, qr-code, zbar-sdk, autofocus

我创建了一个使用 ZBar 扫描二维码的应用程序。在测试时，我注意到自动对焦存在问题。当我在开始扫描之前将 iPad 对准 QR 码时，它会在 QR 码周围显示一个绿色矩形并且它不会扫描。我需要将 iPad 重新对准另一个要聚焦的对象，然后再对准 QR 码。

如果我在扫描之前没有瞄准 QR 码，它会起作用。我只需要从启动 Zbar 视图的那一刻起瞄准 QR 码。

我正在使用最低 iOS 6 和 iPad 2 和 3。

我使用了 ZBar 网站上描述的代码，所以没有什么特别需要注意的。我认为这是 ZBar 本身的问题。是否有其他人遇到此问题或对此有解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-24T18:32:57.320

您是否在其他一些 iPad 设备上尝试过？也许这只是你的 iPad 的问题。iPhone呢？我的扫描仪也基于 Zbar - [https://itunes.apple.com/us/app/qr-scan/id568762816?ls=1&mt=8](https://itunes.apple.com/us/app/qr-scan/id568762816?ls=1&mt=8)如果它可以按您的意愿工作，您可以尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-19T08:03:17.347

我们在使用 Zbar 时遇到了同样的问题，我们通过在关闭模型视图之前延迟 2 秒来解决它。

# php - 使用 fpdf 在 pdf 报告上添加字体

> ID：13361900
> 
> 赞同：0
> 
> 时间：2012-11-13T13:49:20.737
> 
> 标签：php, pdf, fonts, report

我正在用 php 上的 fpdf 生成 pdf 报告。我需要为此文档添加 Century Gothic 字体。

我认为我必须做这样的事情：

```
$pdf->AddFont('CenturyGothic','','century.php');
$pdf->SetFont('CenturyGothic','',12); 
```

但这不起作用，我找不到该库的那种字母的文件。请帮忙。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-09-17T10:55:48.240

这对我有用：

转到[http://www.fpdf.org/makefont/index.php](http://www.fpdf.org/makefont/index.php)

转换您的 .ttf 文件

下载 .php 和 .z 文件

将这些文件添加到以下文件夹：fpdf/font（这是您需要下载的默认文件夹结构，以便您的 fpdf 工作）

这是我在文件中使用的代码：

```
$fpdf->AddFont('Gotham','','Gotham-Book.php');
$fpdf->SetFont('Gotham','',11); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-13T13:53:47.760

这是[相关教程](http://fpdf.org/en/tutorial/tuto7.htm)。

我猜你在`MakeFont`尝试添加字体之前忘记做，特别是：

```
<?php
require('makefont/makefont.php');

MakeFont('c:\\Windows\\Fonts\\comic.ttf','cp1252');
?> 
```

一旦您生成了字体定义文件（通常是`.z`扩展名），那么`AddFont`应该可以工作。

# java - 在 Java 中通过 JDBC 使用 Hibernate 和 MySQL 的奇怪错误

> ID：13361901
> 
> 赞同：5
> 
> 时间：2012-11-13T13:49:31.313
> 
> 标签：java, mysql, hibernate, ubuntu, jdbc

在我的程序进行数据库操作大约一分钟后，我得到以下异常：

```
WARN : org.hibernate.util.JDBCExceptionReporter - SQL Error: 0, SQLState: 08S01
ERROR: org.hibernate.util.JDBCExceptionReporter - Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
org.springframework.dao.DataAccessResourceFailureException: Cannot open connection; nested exception is org.hibernate.exception.JDBCConnectionException: Cannot open connection
    at org.springframework.orm.hibernate3.SessionFactoryUtils.convertHibernateAccessException(SessionFactoryUtils.java:631)
    at org.springframework.orm.jpa.vendor.HibernateJpaDialect.translateExceptionIfPossible(HibernateJpaDialect.java:104)
    at org.springframework.orm.jpa.AbstractEntityManagerFactoryBean.translateExceptionIfPossible(AbstractEntityManagerFactoryBean.java:403)
    at org.springframework.dao.support.ChainedPersistenceExceptionTranslator.translateExceptionIfPossible(ChainedPersistenceExceptionTranslator.java:58)
    at org.springframework.dao.support.DataAccessUtils.translateIfNecessary(DataAccessUtils.java:213)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:163)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
    at $Proxy36.getBankResultsForDate(Unknown Source)
    at com.***.service.ScanResultDataServiceImpl.getBankResultsForDate(ScanResultDataServiceImpl.java:138)
    at com.***.CalculateScore.main(CalculateScore.java:63)
Caused by: org.hibernate.exception.JDBCConnectionException: Cannot open connection
    at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:99)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:66)
    at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:52)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:449)
    at org.hibernate.jdbc.ConnectionManager.getConnection(ConnectionManager.java:167)
    at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:161)
    at org.hibernate.loader.Loader.prepareQueryStatement(Loader.java:1596)
    at org.hibernate.loader.Loader.doQuery(Loader.java:717)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:270)
    at org.hibernate.loader.Loader.loadCollection(Loader.java:2062)
    at org.hibernate.loader.collection.CollectionLoader.initialize(CollectionLoader.java:62)
    at org.hibernate.persister.collection.AbstractCollectionPersister.initialize(AbstractCollectionPersister.java:628)
    at org.hibernate.event.def.DefaultInitializeCollectionEventListener.onInitializeCollection(DefaultInitializeCollectionEventListener.java:83)
    at org.hibernate.impl.SessionImpl.initializeCollection(SessionImpl.java:1853)
    at org.hibernate.collection.AbstractPersistentCollection.forceInitialization(AbstractPersistentCollection.java:476)
    at org.hibernate.engine.StatefulPersistenceContext.initializeNonLazyCollections(StatefulPersistenceContext.java:899)
    at org.hibernate.loader.Loader.doQueryAndInitializeNonLazyCollections(Loader.java:275)
    at org.hibernate.loader.Loader.doList(Loader.java:2294)
    at org.hibernate.loader.Loader.listIgnoreQueryCache(Loader.java:2172)
    at org.hibernate.loader.Loader.list(Loader.java:2167)
    at org.hibernate.loader.hql.QueryLoader.list(QueryLoader.java:448)
    at org.hibernate.hql.ast.QueryTranslatorImpl.list(QueryTranslatorImpl.java:363)
    at org.hibernate.engine.query.HQLQueryPlan.performList(HQLQueryPlan.java:196)
    at org.hibernate.impl.SessionImpl.list(SessionImpl.java:1258)
    at org.hibernate.impl.QueryImpl.list(QueryImpl.java:102)
    at org.hibernate.ejb.QueryImpl.getResultList(QueryImpl.java:241)
    at sun.reflect.GeneratedMethodAccessor16.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.springframework.orm.jpa.SharedEntityManagerCreator$DeferredQueryInvocationHandler.invoke(SharedEntityManagerCreator.java:310)
    at $Proxy34.getResultList(Unknown Source)
    at org.springframework.data.jpa.repository.query.JpaQueryExecution$CollectionExecution.doExecute(JpaQueryExecution.java:77)
    at org.springframework.data.jpa.repository.query.JpaQueryExecution.execute(JpaQueryExecution.java:54)
    at org.springframework.data.jpa.repository.query.AbstractJpaQuery.doExecute(AbstractJpaQuery.java:93)
    at org.springframework.data.jpa.repository.query.AbstractJpaQuery.execute(AbstractJpaQuery.java:83)
    at org.springframework.data.repository.core.support.RepositoryFactorySupport$QueryExecutorMethodInterceptor.invoke(RepositoryFactorySupport.java:343)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:110)
    at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
    at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:155)
    ... 5 more
Caused by: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException: Communications link failure

The last packet sent successfully to the server was 0 milliseconds ago. The driver has not received any packets from the server.
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:57)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.SQLError.createCommunicationsException(SQLError.java:1116)
    at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:344)
    at com.mysql.jdbc.ConnectionImpl.coreConnect(ConnectionImpl.java:2333)
    at com.mysql.jdbc.ConnectionImpl.connectOneTryOnly(ConnectionImpl.java:2370)
    at com.mysql.jdbc.ConnectionImpl.createNewIO(ConnectionImpl.java:2154)
    at com.mysql.jdbc.ConnectionImpl.<init>(ConnectionImpl.java:792)
    at com.mysql.jdbc.JDBC4Connection.<init>(JDBC4Connection.java:47)
    at sun.reflect.GeneratedConstructorAccessor37.newInstance(Unknown Source)
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
    at java.lang.reflect.Constructor.newInstance(Constructor.java:525)
    at com.mysql.jdbc.Util.handleNewInstance(Util.java:411)
    at com.mysql.jdbc.ConnectionImpl.getInstance(ConnectionImpl.java:381)
    at com.mysql.jdbc.NonRegisteringDriver.connect(NonRegisteringDriver.java:305)
    at java.sql.DriverManager.getConnection(DriverManager.java:579)
    at java.sql.DriverManager.getConnection(DriverManager.java:190)
    at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriverManager(DriverManagerDataSource.java:173)
    at org.springframework.jdbc.datasource.DriverManagerDataSource.getConnectionFromDriver(DriverManagerDataSource.java:164)
    at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnectionFromDriver(AbstractDriverBasedDataSource.java:149)
    at org.springframework.jdbc.datasource.AbstractDriverBasedDataSource.getConnection(AbstractDriverBasedDataSource.java:119)
    at org.hibernate.ejb.connection.InjectedDataSourceConnectionProvider.getConnection(InjectedDataSourceConnectionProvider.java:71)
    at org.hibernate.jdbc.ConnectionManager.openConnection(ConnectionManager.java:446)
    ... 41 more
Caused by: java.net.NoRouteToHostException: Die angeforderte Adresse kann nicht zugewiesen werden
    at java.net.PlainSocketImpl.socketConnect(Native Method)
    at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:339)
    at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:200)
    at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:182)
    at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:391)
    at java.net.Socket.connect(Socket.java:579)
    at java.net.Socket.connect(Socket.java:528)
    at java.net.Socket.<init>(Socket.java:425)
    at java.net.Socket.<init>(Socket.java:241)
    at com.mysql.jdbc.StandardSocketFactory.connect(StandardSocketFactory.java:257)
    at com.mysql.jdbc.MysqlIO.<init>(MysqlIO.java:294)
    ... 60 more
ERROR: com.***.CalculateScore - org.springframework.dao.DataAccessResourceFailureException: Cannot open connection; nested exception is org.hibernate.exception.JDBCConnectionException: Cannot open connection 
```

我的程序通过 JDBC 在 Java 中使用 Hibernate 和 MySQL。

操作系统为 Ubuntu 12.04。重装系统并没有解决问题。

有人知道出了什么问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:11:19.047

这是由于[`NoRouteToHostException`](https://docs.oracle.com/javase/7/docs/api/java/net/NoRouteToHostException.html). 这种情况为网络配置状态。

> 表示尝试将套接字连接到远程地址和端口时发生错误的信号。通常，由于中间防火墙或中间路由器已关闭，无法访问远程主机。

检查[如何避免 NoRouteToHostException](https://stackoverflow.com/questions/1572215/how-to-avoid-a-noroutetohostexception)。

# javascript - 如何用原型覆盖属性

> ID：13361903
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:49:40.050
> 
> 标签：javascript, prototype

如何在 Javascript 中使用原型覆盖属性？

# 代码

```
function Test(){
    this.prop = false;
}

Test.prototype.prop = true;

var T = new Test();
console.log(T.prop); 
```

这返回`false`但应该返回`true`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:51:13.453

如果您需要更改 t 属性的值，请直接从对象的实例访问该属性或在构造函数中指定它。

**直接访问**

```
var T = new Test();
t.prop = false;
console.log(T.prop); 
```

**构造函数**

```
function Test(prop){
    this.prop = prop;
}

var T = new Test(false); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:54:07.983

构造函数在原型复制**之后执行。**您不能使用原型覆盖由构造函数设置的属性。

但如果你真的想这样做，你可以这样做：

```
function Test(){
    if (this.prop === undefined) {
        this.prop = false;
    }
} 
```

# c++ - 无法分配抽象类型解决方案的对象？

> ID：13361905
> 
> 赞同：1
> 
> 时间：2012-11-13T13:49:46.943
> 
> 标签：c++, oop

我有一个用 C++ 编写大学的家庭作业。我有两个主要的抽象类学生和课程。在 Course 中，有不同的子类，例如 SoftwareEngineering 类...等 在 Student 中，有不同的子类，例如 SoftwareEngineering 学生类.. 等。

现在，在 Course 子类中，每个子类都有一个注册学生的功能

```
void register(Student &s); 
```

当我调用每个课程子类（例如软件工程课程类）的函数寄存器时，我想将该学生引用推入向量中。但我得到了错误

```
 cannot allocate an object of abstract type 'Student' 
```

Student 类是抽象的，并且有子类 SoftwareEngineeringStudent 等。但是我 - 必须 - 让注册函数获取一个抽象对象 Student，而不是像 SoftwareEngineeringStudent 这样的特定类型的学生。

有没有办法解决这个问题？

这是一个骨架（当然不是完整的代码！）：

```
//Course.h
class Course{
virtual void reg(Student &s)=0

}
class SoftwareEngCourse : public Course{
void reg(Student &s);
}

//Student.h
class Student{
virtual void study(Course &c)=0;
}
class SoftwareEngStudent : public Student{
void study(Course &c);
} 
```

现在在 Course.cpp 中：

```
//Course.cpp
void SoftwareEngCourse::reg(Student &s){
   vector_of_Student_object.push_back(s);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T14:37:59.387

In the comments you said that your vector is declared as:

```
std::vector<Student> vector_of_Student_object; 
```

...and therein lies the problem. You trying to store `Student` objects in the `vector`, but you can't store a `Student` object because that class is abstract. Consider the following psudocode:

```
void foo(Student s)
{
}

int main()
{
  SoftwareStudent ss;
  foo(ss);
} 
```

What happens to `ss` when `foo` is called? You are passing a `SoftwareStudent`, but `foo` just takes a `Student`. So `ss` is implicitly converted to its base class, `Student` which, since `foo` takes a `Student` by value, tries to construct a new `Student` by calling:

```
Student::Student(const Student& rhs) 
```

In other words, the `SoftwareStudent`-specific attributes of `ss` You may not have implemented this constructor yourself, in which case the compiler did it for you.

The end result is you are trying to instantiate an abstract class because `foo` takes a `Student` by-value. This obviously won't work since you can't instantiate an abstract class.

This relates to your actual problem because your `vector` is a `vector` of `Student` objects, stored again by value. When you insert an object in to a vector, that object is copied. You end up trying to instantiate `Student` objects, which you can't do because `Student` is abstract.

You need to store something other than `Student`, either a `Student` reference or pointer. Since you can't have a `vector` of references, that leaves you with pointers.

Whenever dealing with pointers, it's best to deal with smart pointers rather than raw pointers as with smart pointers you don't need to worry as much about releasing the object, and very often you don't even have to use `new` explicitly. `std::shared_ptr` is probably the easiest to incorporate here, although `std::unique_ptr` might be a better fit semantically.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-13T13:57:40.967

是的，`vector_of_Student_object`改为创建一个指向学生的（智能）指针向量。

无论如何，对象向量可能不是您想要的，因为对象将被[切片](http://en.wikipedia.org/wiki/Object_slicing)。

# actionscript-3 - flash as3 串口

> ID：13361906
> 
> 赞同：0
> 
> 时间：2012-11-13T13:49:49.930
> 
> 标签：actionscript-3, flash, serial-port

嘿试图通过串行端口输入数据，但我收到此错误。1037: 包不能嵌套。然后我需要获取这些值并使用 1 来控制视频播放和另一个来控制音量

```
package 
{
import flash.display.Sprite;
import flash.net.XMLSocket;
import flash.events.DataEvent;

public class receiveData extends Sprite
{
    public static const PORT:Number = 5331;
    public static const COMMA:String = ",";
    public static const LOCALHOST:String = "127.0.0.1";

    private var socket:XMLSocket = null;

    public function receiveData()
    {
        super();
        init();
    }

    private function init():void
    {
        socket = new XMLSocket();
        socket.addEventListener( DataEvent.DATA, doSocketData );
        socket.connect( LOCALHOST, PORT );
    }

    protected function doSocketData( event:DataEvent ):void
    {
        var parts:Array = null;
        var sensorone:Number = 0;
        var sensortwo:Number = 0;
        var values:String = event.data.toString();
        parts = values.split( COMMA );
        trace( parts[0]);
        trace( parts[1]);
        sensorone = new Number( parts[0] );
        sensortwo = new Number( parts[1] );
    } 
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T17:28:23.253

因此，基本上您需要将该代码放在一个单独的 AS3 文件中，并将其设置为文档类或您在 Flash 中制作的 MovieClip 的类文件。或者，您可以使用不同的 IDE，例如 FlashBuilder 或 FlashDevelop 或 FDT，并避免使用 Flash IDE（作为程序员，我觉得这主要是把事情弄得一团糟）。

[http://www.actionscript.org/forums/showthread.php3?t=136364](http://www.actionscript.org/forums/showthread.php3?t=136364)（哈哈所以不会让我LMGTFY）

看起来你在正确的轨道上，但如果你使用 tinkerproxy 或类似的东西来转发数据（玩得开心，我得让自己回到那个状态，查看我的视频[http://www的描述中的链接.youtube.com/watch?v=71eFWknHKEM&list=UUSz-eugjE1d6yki6ZT51CKg&index=17&feature=plcp](http://www.youtube.com/watch?v=71eFWknHKEM&list=UUSz-eugjE1d6yki6ZT51CKg&index=17&feature=plcp) :)

# jquery - 使用 jQuery 添加带有文本和链接按钮的 div

> ID：13361907
> 
> 赞同：2
> 
> 时间：2012-11-13T13:49:54.087
> 
> 标签：jquery, html, dynamic, add

我想使用 jQuery 在 Div 中添加一些文本和一个 asp: 按钮。

代码：

```
Hi,  <p> Are you sure you want to go ahead</p><p>Please ignore this warning if this is not the first time you are logging in</p>
<asp:button ID="btnProceed" runat="server" Text="Proceed"></asp:button> 
```

执行：

```
jQ('#proceedDiv').append("<div> Hi,  <p> Are you sure you want to go ahead</p><p>Please ignore this warning if this is not the first time you are logging in</p> <asp:button ID="btnProceed" runat="server" Text="Proceed"></asp:button></div>"); 
```

但我收到一条错误消息，提示“预期”

该错误是按钮代码开始的地方。单独使用文本（而不是按钮控件），代码可以正常工作。有人可以帮我解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-03T19:50:13.867

你需要逃避你的报价......

```
<asp:button ID="btnProceed" runat="server" Text="Proceed"> 
```

需要成为

```
<asp:button ID=\"btnProceed\" runat=\"server\" Text=\"Proceed\"> 
```

另请注意

```
<button onclick="doSomething()">Click Me</button> 
```

# javascript - jquery click 函数总是返回最大值

> ID：13361910
> 
> 赞同：1
> 
> 时间：2012-11-13T13:50:08.503
> 
> 标签：javascript, jquery

我将元素插入到 DOM 中，之后我想将点击函数绑定到这些元素。这可行，但由于某种原因，创建的链接都返回相同的值，这是循环后“px_amount”的最大值。很奇怪:) 第一个console.log(); 确实返回正确的值，我可以看到它在每次迭代后递增。为了简单起见，我在 click 函数中添加了一个简单的 console.log()。

```
for(var i=1; i<=bullet_amount; i++)
{               
    $('<a id="bullet-'+i+'">'+i+' </a>').appendTo('#bullet-nav');

    px_amount = (i-1)*ratio*3450;
    console.log(px_amount);
    $("#bullet-"+i).live('click', function() {
        console.log(px_amount);
    });
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-13T13:51:47.873

这是一个非常常见的问题：`i`所有回调的变量都是相同的，即封闭范围之一。

一个常见的解决方案是：

```
for(var i=1; i<=bullet_amount; i++)
{               
    (function(i){
      $('<a id="bullet-'+i+'">'+i+' </a>').appendTo('#bullet-nav');
      px_amount = (i-1)*ratio*3450;
      console.log(px_amount);
      $("#bullet-"+i).live('click', function() {
         console.log(px_amount);
      });
    })(i);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:53:10.060

您应该使用闭包来捕获rether的*值*而不是*reference*：`i`

 *```
for(var i=1; i<=bullet_amount; i++) {
    (function(iVal) {
        $('<a id="bullet-'+iVal+'">'+iVal+' </a>').appendTo('#bullet-nav');

        var px_amount = (iVal-1)*ratio*3450;
        console.log(px_amount);
        $("#bullet-"+iVal).live('click', function() {
            console.log(px_amount);
        });
    })(i);
} 
```*

# ios - 在 xcode 中将源代码控制添加到我的项目

> ID：13361911
> 
> 赞同：0
> 
> 时间：2012-11-13T13:50:09.733
> 
> 标签：ios, xcode, git, github

我在 raywenderlich.com 上关注本教程：[http](http://www.raywenderlich.com/22590/beginning-automated-testing-with-xcode-part-12) ://www.raywenderlich.com/22590/beginning-automated-testing-with-xcode-part-12 。我在将我的项目链接到我的仓库时遇到问题。我已经在我的 github 帐户中创建了 repo 并下载了 starter 项目。

我面临两个问题：

1) xcode 不断询问我的密码，当我输入我的 github 帐户密码和用户名时，它一直说我的身份验证错误。它的用户名总是说 git ......

2) 在教程中，要获得初始提交，它说：转到 File\Source Control\Commit (⌥⌘-C) 并在以下屏幕上输入提交消息，如“initial commit”，然后单击 Commit。但是当我输入初始提交时，提交没有突出显示并且不允许我单击它。

需要一些指导来开始我的 iOS 项目的源代码控制..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T13:54:53.330

诚实地？不要为此使用 Xcode。我知道我没有回答你的问题，但有更好的方法来做。目前我正在使用命令行，这对于我所做的来说已经绰绰有余了。有时我使用[SourceTree](http://www.sourcetreeapp.com/)，但大多数时候它是命令行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T15:44:24.233

`https`1）我认为您使用链接从 github.com 克隆您的项目。您应该选择`git`一个，如下所示：`git@github.com:username/projectname.git`. 或者你应该参考 GitHub 的帮助页面[https://help.github.com/articles/set-up-git#platform-mac](https://help.github.com/articles/set-up-git#platform-mac)，它告诉你安装 osxkeychain 凭证助手。

它写在 GitHub 上：

凭据帮助程序仅在您克隆 HTTPS 存储库 URL 时起作用。如果您改用 SSH 存储库 URL，则使用 SSH 密钥进行身份验证。[本指南](https://help.github.com/articles/ssh-key-setup)提供了生成和使用 SSH 密钥对的帮助。

2）现在还没有什么好主意。

# windows-installer - 使用 msi 安装 jre 和使用 jreXXX.exe 安装程序之间的区别

> ID：13361914
> 
> 赞同：2
> 
> 时间：2012-11-13T13:50:22.603
> 
> 标签：windows-installer, java

我们需要在机器上静默安装 jre，即在命令行上使用 /s 开关。现在我们通过查看 msi 日志在某些情况下看到 jre 的安装已经结束。Windows 安装程序退出并返回代码 o，但 jre 安装程序挂起半个多小时。最终不得不被杀死。这种行为已经多次出现。为了避免这个问题，我们从 jre.exe 包装器中提取 msi 和 cab 文件并直接使用它们进行安装。
现在我的问题是这两种安装有什么区别吗？使用 msi 安装是否会跳过一些配置步骤？这个 jre 环境是否足以运行所有需要 jre 的程序？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T09:28:15.557

不用担心，如果通过引导的 exe 或通过 msi 安装，您将获得相同的结果。实际上，MSI 包含自己的存档，其中包含在自定义操作的帮助下安装的源文件，并且引导的 Exe 仅需要用于漂亮的用户界面。
对于 SCCM 中的分发，我们使用提取的 MSI 多年。

IT-Ninja [How to package JRE上的有用链接](http://www.itninja.com/question/how-to-package-java-runtime-environment-jre)

# jquery - `overflow-x: hidden` 中的元素仍然有宽度（Safari）

> ID：13361919
> 
> 赞同：0
> 
> 时间：2012-11-13T13:50:49.590
> 
> 标签：jquery, css, safari, overflow

以下代码演示了一个元素 ，`p`它使用 CSS3（实际上是 webkit）转换水平折叠和展开：

```
<style>
  div * {
    display: inline-block;
  }

  p {
    overflow-x: hidden;
    white-space: nowrap;
    -webkit-transition: width 1s;
  }​
</style>

<div>
  <a><i>begin</i><p><s>middle</s></p><b>end</b></a>
  <a id="after">after</a>
</div>

<script>
  $('div > a').each(function() {
    var a, p;
    a = $(this);
    p = $('p', a);
    a.toggle((function() {
      p.width(0);
    }), function() {
      p.width(p[0].scrollWidth);
    });
  });
</script> 
```

[http://jsfiddle.net/qrf3E/](http://jsfiddle.net/qrf3E/)

它在使用 Chrome 时具有预期的效果： [http ://www.screenr.com/vJH7](http://www.screenr.com/vJH7)

但是在 Safari（桌面和移动设备）中，容器元素的表观宽度 ,`a`会在内部容器 折叠时恢复到展开后的宽度`p`。这会迫使下面的元素 ,`#after`漂浮在太空中……救命！这是 Safari 的错误吗？任何人都可以提供修复吗？

[http://www.screenr.com/qJH7](http://www.screenr.com/qJH7)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:13:16.650

我刚刚想到的一种可能的解决方法是折叠到一个像素然后隐藏：

```
a.toggle(function() {
  p.one('webkitTransitionEnd', function() {
    p.hide();
  });
  p.width(1);
}, function() {
  p.show();
  p.width(p[0].scrollWidth);
}); 
```

[http://jsfiddle.net/corin/LsSk2/](http://jsfiddle.net/corin/LsSk2/)

谁能更好？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:16:35.647

好吧，这似乎是 safari 开发人员忘记的默认值。

如果你设置`a { display: inline; }`它工作。[http://jsfiddle.net/2t388/](http://jsfiddle.net/2t388/)

# regex - Zend Framework如何配置路由器GET参数

> ID：13361920
> 
> 赞同：0
> 
> 时间：2012-11-13T13:50:48.943
> 
> 标签：regex, zend-framework, get, router

网址

```
somedomain.com/?_escaped_fragment_ 
```

试试看：

```
routes.escaped-fragment.type = "Zend_Controller_Router_Route_Regex"
routes.escaped-fragment.route = "\?_escaped_fragment_"
routes.escaped-fragment.defaults.controller = "index"
routes.escaped-fragment.defaults.action = "someaction" 
```

但他没有看到 GET 参数 ?_escaped_fragment_ 并运行

```
IndexController::indexAction 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T22:01:18.510

ZF 路由器仅在路径上运行，查询字符串参数在路由匹配发生之前被剥离，因此您将无法轻松完成此工作。您的选择是：

*   更改 URL 结构
*   在 .htaccess 中重写此 URL
*   在执行标准路由之前扩展/替换默认路由器以检查查询字符串

# android - 您可以使用 Intent 搜索 Google Play 吗？

> ID：13361937
> 
> 赞同：9
> 
> 时间：2012-11-13T13:51:59.067
> 
> 标签：android, search, android-intent, google-play

情况如下：
我想通过隐式意图打开另一个应用程序，但用户没有足够的应用程序。我可以为他打开“Google Play 搜索活动”，其结果包括包含能够提供此类意图的组件的应用程序（具有适当的意图过滤器）。换句话说，您可以使用“意图数据”进行搜索吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-13T14:58:37.400

要执行搜索，请在 URI 中使用搜索关键字：

```
Intent goToMarket = new Intent(Intent.ACTION_VIEW).setData(Uri.parse("market://search?q=<Your Search Word>"));
startActivity(goToMarket); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:54:39.440

这可以通过 URL 完成。您需要一个带有 Google Play URL 的通用 ACTION_VIEW Intent。Play 商店应用程序将接受 Intent。

例子：

此 URL 用于在商店中搜索“twitter”。 [https://play.google.com/store/search?q=twitter&c=apps](https://play.google.com/store/search?q=twitter&c=apps)

此 URL 加载商店中官方 Twitter 应用程序的记录。 [https://play.google.com/store/apps/details?id=com.twitter.android](https://play.google.com/store/apps/details?id=com.twitter.android)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-13T14:00:52.410

目前没有用于访问 Google Play 信息的 API - 答案是否定的。

有一些替代项目允许 API 访问以获取 Play 市场信息，但目前 Google 不支持官方的 Play Market API。

# node.js - 如何为公司 Intranet 安装私有 Node.js 包存储库？

> ID：13361938
> 
> 赞同：6
> 
> 时间：2012-11-13T13:52:00.767
> 
> 标签：node.js, installation, npm, intranet

将包分发到在公司内部网中运行的 Node.js 服务器的推荐方式是什么？问题是大多数服务器无法直接访问[npm 注册表](https://npmjs.org)。是否可以安装一个私人仓库，与官方同步，然后从这里同步内部服务器？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T02:08:34.107

最佳实践是将 node_modules 检入 git 存储库（从 .gitignore 中删除 node_modules）。然后，只有您的开发人员机器需要访问 npm.org，服务器将从您的内部 git 存储库获取包。

# web-services - Grails 例外：映射 qname 不喜欢包：grails.validation

> ID：13361939
> 
> 赞同：4
> 
> 时间：2012-11-13T13:52:05.760
> 
> 标签：web-services, grails, soap, axis2

我正在尝试使用带有 Apache Axis2 插件的 Grails 构建一个简单的 SOAP Web 服务（基本 CRUD）。

所有方法都适用于具有简单返回类型（如 String、int）的方法。

问题是当我尝试检索域类对象时：

```
class Hotel {

    static mapping = {

        datasource 'hotel'
        table 'hotel'
        version false

        hotelId column:'id', insertable: false, updateable: false
        hotelName column:'hotel_name', sqlType:'varchar', name:'hotelName'
    }

    Integer hotelId
    String hotelName

    static constraints = {

        hotelId(max: 2147483647)
        hotelName(size:1..100)
    }

} 
```

我的服务类中有以下方法：

```
class HotelService {

    static expose=['axis2']
    boolean transactional = false

    String sayHello(String name) {
       return "Hello ${name}!"
    }

    Hotel soapGetHotel(int id){ 
        return Hotel.get(id)
    }
} 
```

为soapGetHotel（int id）执行curl会给我这个错误：

```
| Error 2012-11-13 15:29:46,142 [http-bio-8080-exec-3] ERROR engine.AxisEngine  - java.lang.RuntimeException: org.apache.axis2.AxisFault: Mapping qname not fond for the package: grails.validation
Message: java.lang.RuntimeException: org.apache.axis2.AxisFault: Mapping qname not fond for the package: grails.validation 
```

请看下面我的soap-xml文件：

```
<soap:Envelope
  xmlns:soap="http://www.w3.org/2003/05/soap-envelope"
  soap:encodingStyle="http://www.w3.org/2003/05/soap-encoding">
  <soap:Body xmlns:m="http://ws.com">
    <m:soapGetHotel>    
      <m:id>13</m:id>
    </m:soapGetHotel>
  </soap:Body>
</soap:Envelope> 
```

和 curl 命令：

```
curl --verbose --request POST --header "Content-Type: application/soap+xml" --data @gethotel.xml http://localhost:8080/wsexample/services/hotel 
```

我相信这与找不到对象映射的轴有关。我尝试解决这里接受的答案中描述的问题：[Axis2 not return own objects](https://stackoverflow.com/questions/3069659/axis2-not-returning-own-objects)，但没有运气，我仍然得到错误。

我遵循了[axis2 grails 文档](http://www.grails.org/Apache+Axis2+Plugin)中描述的所有步骤。

关于如何解决这个问题的任何想法？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-29T07:49:15.300

Axis 插件是一个相当老的插件，它似乎在过去 3 年没有更新。我建议使用 CXF 插件作为替代方案。在我们的项目中，效果很好！

# installation - 使用 FileBrowse 对话框设置的属性更新编辑字段

> ID：13361943
> 
> 赞同：1
> 
> 时间：2012-11-13T13:52:14.580
> 
> 标签：installation, windows-installer, installshield, custom-action

我有一个开始为空的编辑字段。用户使用一个按钮来启动 FileBrowse 对话框并允许他们选择一个文件。这一切正常，文件存储在属性中，功能符合预期。

但是，一旦用户选择文件，编辑字段就不会更新。前进然后后退，一个对话框会显示该字段中的属性，但我不能要求用户这样做。我已经读到这是一个 MSI 限制，并且想知道是否有任何解决方法。

本质上，我需要在用户选择文件后“刷新”对话框，或者至少是编辑字段控件。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T07:39:29.343

这确实是 Windows Installer 的限制。从 MSI 包中克服此问题的唯一解决方案是使用[双对话方法。](http://www.advancedinstaller.com/user-guide/tutorial-combobox-listbox.html#combolist-twin-dialog)

# android - SGS 2 上的 Android.content.ActivityNotFoundException 与 Android 4.0.4

> ID：13361944
> 
> 赞同：1
> 
> 时间：2012-11-13T13:52:17.787
> 
> 标签：android, android-intent, calendar

我有一个应用程序可以让用户在他的设备的默认日历中插入一个事件

我正在使用以下代码开始将事件插入默认日历的活动：

```
Intent intent = new Intent(Intent.ACTION_INSERT)
                .setData(Events.CONTENT_URI)
                .putExtra(CalendarContract.EXTRA_EVENT_BEGIN_TIME, beginTime.getTimeInMillis())
                .putExtra(CalendarContract.EXTRA_EVENT_END_TIME, endTime.getTimeInMillis())
                .putExtra(CalendarContract.EXTRA_EVENT_ALL_DAY, true)
                .putExtra(Events.RRULE, "FREQ=YEARLY;")
                .putExtra(Events.AVAILABILITY, Events.AVAILABILITY_FREE)
                .putExtra(Events.TITLE, title)
                .putExtra(Events.DESCRIPTION, description)
                .putExtra(Events.HAS_ALARM, false);
            context.startActivity(intent); 
```

根据[http://developer.android.com/guide/topics/providers/calendar-provider.html#intent-insert](http://developer.android.com/guide/topics/providers/calendar-provider.html#intent-insert)上的 SDK 文档，这是在 Android 4 及更高版本中执行此操作的正确且推荐的方法。

这在我的带有 Android 4.0.3 的旧三星 Galaxy S（旧三星 Galaxy S 的 TEAMSGS 准系统 ICS 自定义 ROM）中运行良好。

但是，在将朋友的三星 Galaxy S2 更新到 Samsung Stock Android 4.0.4 后，这段代码会导致 ActivityNotFound Exception：

> android.content.ActivityNotFoundException：在 android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1535) 上找不到处理 Intent { act=android.intent.action.INSERT dat=content:xxxxx (has extras) } 的活动。 app.Instrumentation.execStartActivity(Instrumentation.java:1387) 在 android.app.Activity.startActivityForResult(Activity.java:3195) 在 android.app.Activity.startActivity(Activity.java:3302) 在 com.radlmaier.heiligenkalender.rk .OptionsMenuHandler.onOptionsItemSelected(OptionsMenuHandler.java:119) 在 com.radlmaier.heiligenkalender.rk.Main.onOptionsItemSelected(Main.java:994) 在 android.app.Activity.onMenuItemSelected(Activity.java:2507) 在 com.android。 internal.policy.impl.PhoneWindow.onMenuItemSelected(PhoneWindow.java:979) 在 com.android.internal.view.menu.MenuBuilder。dispatchMenuItemSelected(MenuBuilder.java:735) 在 com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:149) 在 com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:874)在 com.android.internal.view.menu.ListMenuPresenter.onItemClick(ListMenuPresenter.java:178) 在 android.widget.AdapterView.performItemClick(AdapterView.java:292) 在 android.widget.AbsListView.performItemClick(AbsListView.java:1181 ) 在 android.widget.AbsListView$PerformClick.run(AbsListView.java:2709) 在 android.widget.AbsListView$1.run(AbsListView.java:3464) 在 android.os.Handler.handleCallback(Handler.java:605) 在android.os.Handler.dispatchMessage(Handler.java:92) 在 android.os.Looper.loop(Looper.java:137) 在 android.app.ActivityThread.main(ActivityThread.java:4511) 在 java.lang.reflect 。方法。在 com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:980) 在 com.android.internal 的 java.lang.reflect.Method.invoke(Method.java:511) 的 invokeNative(Native Method)。 os.ZygoteInit.main(ZygoteInit.java:747) 在 dalvik.system.NativeStart.main(Native Method)

尽管我使用的是 SDK 文档推荐的确切方式，但有什么想法会失败吗？

这真的让我很困扰，因为我不知道是否还有其他似乎不符合 SDK 文档的 Android 4 设备......

# php - 使用 PHP 准备好的语句

> ID：13361948
> 
> 赞同：2
> 
> 时间：2012-11-13T13:52:24.643
> 
> 标签：php, mysql, prepared-statement

我是 PHP 新手 .. 我被困在如何将我的 sql 语句转移到准备好的语句上 .. 我得到的错误消息是你“无法连接” ..

我的代码如下

```
$connection = mysql_connect($host,$username,$password) or die ("can't connect"); 

$select_database = mysql_select_db($db_name);
$id = mysql_real_escape_string ($_GET ['id']); 

$query = 'SELECT * from &tbl_name where id=?';
$stmt = $connection->prepare($query);
$stmt->bind_param("d", $id);
$stmt->execute();
$rows=mysql_fetch_array($stmt);
$stmt->close(); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T13:54:30.817

你实际上有两个问题。

第一个与您的问题相关的是在这一行：

```
$connection = mysql_connect($host,$username,$password) or die ("can't connect"); 
```

你说你收到错误`can't connect`。这意味着您的数据库连接的主机、用户名和/或密码无效。检查连接信息是否正确，您应该能够解决问题。

第二个是您正在使用[`mysql_`](http://php.net/manual/en/book.mysql.php)函数连接到数据库，然后尝试使用[`mysqli_`](http://php.net/manual/en/book.mysqli.php)绑定/执行函数。你不能混搭。

因为您正在尝试使用 OOP 样式绑定/执行，所以这里有一个重新编码的示例，应该会有所帮助：

```
$connection = new mysqli($host, $username, $password);
if ($connection->connect_error) {
    die("can't connect");
}
$query = 'SELECT * from tbl_name where id=?';
$stmt = $connecton->prepare($query);
$stmt->bind_param("d", $id);
$results = $stmt->execute();
$rows = $results->fetch_array();
$stmt->close(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-13T13:56:12.997

您不能使用遗留`mysql_*`函数集执行准备好的语句。您需要使用 PDO 或 MySQLi：

```
$dbh = new PDO("mysql:dbname=testdb;host=127.0.0.1", "username", "password");

$query = "SELECT * FROM myTable WHERE id=?";
$stmt = $dbh->prepare($query);
$stmt->execute(array($my_id));

$result = $stmt->fetchAll(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-13T13:56:20.143

您拥有的“无法连接”来自如果失败`die()`将停止执行脚本的功能。`mysql_connect`这意味着您的代码无法成功创建连接，请检查您的`$host`和`$username`参数`$password`。如果您的主机是远程主机，请确保您有权连接到它。

正如 pce 所说，你还有一个错字`$connecton`，应该是`$connection`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-13T13:57:38.907

尝试

1.定义数据库常量供以后在项目中使用；（这段代码应该只执行一次）

```
define( "DBN","foo");//where foo is the database name
define( "DB_USERNAME", "rootuser" ); //generally root
define( "DB_PASSWORD", "my_very_hard_password" ); //be more creative
define( "DB_DSN", "mysql:host=localhost;dbname=".DBN ); 
```

...

2.创建PDO对象并执行

```
$conn = new PDO( DB_DSN, DB_USERNAME, DB_PASSWORD );
$sql = "SELECT * from &tbl_name where id=:id";
$st = $conn->prepare( $sql );
$st->bindValue( ":id", $obj->id, PDO::PARAM_INT );  
// or $st->bindValue( ":id", 5, PDO::PARAM_INT );   
$st->execute();
return $st->fetchAll(); 
```

# php - jQuery：基于第一个下拉列表的值的数组中的第二个下拉列表

> ID：13361950
> 
> 赞同：1
> 
> 时间：2012-11-13T13:52:39.937
> 
> 标签：php, jquery, drop-down-menu

**问题：**我有两个下拉框。使用 jQuery，我想在选择第一个下拉框时填充第二个下拉框（帮助我现有的代码）。我在下面的 jQuery 代码中标记了我需要帮助的区域，并在“代码帮助”中解释了我想要实现的目标。

*我意识到这是 SO 上一个非常频繁请求的项目，我看到很多评论说这可以在简单的 JS 中完成，但是由于页面上已经使用了其他 jQuery 元素（不是我编码的），为了简单起见，我想用JQ。*

我对任何 jQuery 代码都是全新的，我研究了很多示例，但是由于我不熟悉 JS 或 JQ 编码约定，所以我迷失在逻辑中，所以保持简单很重要，这样我才能理解内部发生的事情代码（我不仅*在*寻求帮助以使我的代码正常工作，而且我还可以*学习和理解正在发生的事情*）。

通过以下教程，我几乎完全找到了我想要实现的操作（***除了下面“代码帮助”中解释的一个重要点***[）：http: //jqueryfordesigners.com/populate-select-boxes/](http://jqueryfordesigners.com/populate-select-boxes/)。显示操作的示例页面在这里：http: [//jqueryfordesigners.com/demo/select-boxes.html](http://jqueryfordesigners.com/demo/select-boxes.html)

**代码帮助：**在教程中，第二个下拉列表是从静态 html 文件的内容中填充的：`$article.load('select-boxes-' + categoryName + '.html');`
我需要根据第一个下拉列表中的选定值从 JS 变量`$st_list`和 PHP 变量中填充第二个下拉`$student_block`列表，如图所示我的代码如下。

任何人都可以帮助如何调整代码以实现这一目标吗？

谢谢

**我的代码：**
为简单起见，第一个下拉列表是静态的，带有简单的整数值，但将从`$test_seq`工作代码中的数据库中填充，其整数值与下面的示例代码相同（如果重要的话）。此外，在单独的 PHP 进程（稍后）中`$test_seq`， ,`$student_id`和 other`new variables`将用于将数据发送回数据库*（仅供参考，但与此请求无关）。*

*选择框.php*

```
$sql = "SELECT * FROM TBL_NAME";
$result = mysql_query($sql) or die(mysql_error());
while($row = mysql_fetch_array( $result ))
{
  $test_seq = $row['SEQ'];
  $student_id = $row['st_num'];
  $student_name = $row['st_name'];
  $student_block .= '<OPTION value="'.$student_id.'">'.$student_id.' - '.$student_name.'</OPTION>';
} 
```

*形式：*

```
<form action="select-boxes.php">
<label for="test_day">Test day:</label>
   <select name="test_day" id="test_day">
    <option selected value="">&nbsp;</option>
    <option value="1">Day 1</option>
    <option value="2">Day 2</option>
    <option value="3">Day 3</option>
   </select>
<input type="submit" id="next" value="next &raquo;" />
</form> 
```

*jQuery：*

```
<script src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
<script>
  $(document).ready(function () {
    var $test_day = $('#test_day'),
    $st_list = null;
    $test_day.change(function () {
      var test_dayVal = $test_day.val();
      if ($st_list == null) {
        $st_list = $('<select name="st_name" id="st_name"><?php echo $student_block; ?></select>').appendTo('form');
        $next.remove();
        $('form').append('<input type="submit" value="process &raquo;" />');
      }

      $st_list.load('#test_dayVal'); //<--I think this is where I need help.. What do I do here?

    });

    var $next = $('#next');

    $next[0].setAttribute('type', 'button');
  });
</script> 
```

# xml - 二进制序列化 vs. JSON vs. xml

> ID：13361951
> 
> 赞同：7
> 
> 时间：2012-11-13T13:52:48.237
> 
> 标签：xml, json, serialization, deserialization, binary-serialization

如果数据结构有很多小（字符串）字段，有谁知道在使用二进制序列化与 JSON 与 xml 并通过网络发送数据时，就时间而言，性能增益大约是多少？

序列化程序在多大程度上负责性能？编程语言呢？

完美的场景是我们忽略了可移植性问题，我们假设我们拥有对所有 3 种格式进行序列化/反序列化所需的库。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-14T07:38:32.513

充分回答您的问题是不可能的，因为这取决于您的具体要求和需求。

在某种程度上，您可以说是用于描述序列化表示的数据量，这会影响性能。

例如，XML 文档需要像 ... 这样的开始和结束标记，而 JSON 使用 prop1:"..." 就足够了，这减少了描述实例所需的字符数据量。二进制甚至可以跳过属性命名，这会进一步减少描述序列化实例所需的数据量。

尽管这可能描绘出二进制序列化是最快的，但并非总是如此。这取决于序列化程序从对象实例到序列化描述需要多少时间。

如果你真的需要性能，那么你应该看看谷歌协议缓冲区。以我的经验，这些速度快如闪电，而且非常易于使用。

# c# - 需要一些关于 C# 中日期验证的指导

> ID：13361957
> 
> 赞同：-2
> 
> 时间：2012-11-13T13:53:15.983
> 
> 标签：c#, validation, date

我被要求编写一个程序来验证用户输入的日期。日期必须输入为三个整数变量，分别代表日、月和年。输出必须说明日期是否有效。

听起来很简单……我需要做的就是让用户输入日期、月份和年份。然后调用它并将其显示为日期。但是我可能希望用户先输入月份，因为这样我就可以计算出该月有多少天。

我认为我需要做的是从一个数组或 3 开始，我需要让程序记住每个月有多少天，所以如果月份输入为 2 月，它不会接受任何大于 29 的输入。

在我开始晚上看 Visual Studio 之前，我是否认为任何地方都是正确的？或者我可以采取另一个角度吗？

好的，所以我一直在努力，这就是我所拥有的。

```
int monthentered = 0;
            int dayentered = 0;
            int year = 0000;
            int [] month = new int [12];
            int [] day = new int [31];
            bool leap = false;

            for (int x = 0; x <= 11; x++)
            {
                month[x] = x+1;
            }

            for (int x = 0; x <= 30; x++)
            {
                day[x] = x+1;
            }
            Console.WriteLine("Please enter a year...");
            year = (Convert.ToInt16(Console.ReadLine()));
            Console.WriteLine("{0}", year);

            Console.WriteLine("Please enter a month...");
            monthentered = (Convert.ToInt16(Console.ReadLine()));

            Console.WriteLine("Please enter a day...");
            dayentered = (Convert.ToInt16(Console.ReadLine()));

            while (monthentered == 01 || 03 || 05 || 07 || 08 || 10 || 12)
            {
                while (dayentered == 31)
                {
                    Console.WriteLine("There are only 30 days in this month please re-enter your day...");
                    dayentered = (Convert.ToInt16(Console.ReadLine()));
                }
            }

            while (monthentered == 02)
            {
                while (dayentered > 28)
                {
                    Console.WriteLine("There are only 28 days in this month please re-enter your day...");
                    dayentered = (Convert.ToInt16(Console.ReadLine()));
                }
            }

            Console.WriteLine("{0}/{1}/{2}", dayentered, monthentered, year);
            Console.ReadKey(); 
```

while monthenter = bit 的问题。有人可以为我做错什么提供帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T14:00:07.730

```
bool inputOk = false;
try
{
    try
    {
        int y = int.Parse(yearTextBox.Text);
        int m = int.Parse(monthTextBox.Text);
        int d = int.Parse(dayTextBox.Text);
        inputOk = true;
    }
    catch
    {
        Debug.Writeline("Invalid input");
    }

    if(inputOk)
    {
        DateTime value = new DateTime(y, m, d);
        Debug.Writeline("It's a valid date");
    }
}
catch
{
    Debug.Writeline("It isn't a valid date");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T13:59:49.380

[DateTime.ParseExact](http://msdn.microsoft.com/en-us/library/system.datetime.tryparseexact.aspx)可以为您进行解析，只要您给它一个格式。

这个问题之前已经在[这里回答过了](https://stackoverflow.com/questions/4718960/datetime-tryparse-issue-with-dates-of-yyyy-dd-mm-format)。您使用数组的方法会起作用，但 .NET API 要好得多。

# javascript - 在javascript“.click”方法中嵌入ruby

> ID：13361959
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:53:16.560
> 
> 标签：javascript, ruby-on-rails, ruby

当单击“查看对话”时，以下 javascript 会显示隐藏的视图代码。当单击“查看对话”并显示对话时，我想将对话中最后一条消息的状态从“未读”更新为“已读”。不过，我无法嵌入此 Ruby 代码以在点击时触发。作为测试，我能够在单击“查看对话”时弹出一个 javascript 警报，所以我相信这是插入我的代码以更新最后一条消息状态的正确位置。但是，我得到的结果与我在测试警报消息中看到的不一致。将不胜感激任何输入！谢谢。

```
$('#inbox .btn-view-conversation').toggle(function(){
    $(this).text('Hide Conversation');
    $(this).parents('.row-message').find('.message-conversation').slideDown();

    // alert('message!') triggers on click correctly
    $(this).click(alert('message!'));

    // the code below sometimes triggers when the page loads (before click), 
    // but sometimes not at all. 
    $(this).click('<% Message.last.update_attributes(:state => 'read') %>')

    return false;
  }, function(){
    $(this).text('View Conversation');
    $(this).parents('.row-message').find('.message-conversation').slideUp();
    return false;
  }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T15:14:00.913

您需要使用 Ajax 从 Javascript 触发 Ruby 代码。您不能在 Javascript 中“嵌入”Ruby 代码。您需要了解客户端脚本和服务器端脚本之间的区别。

例如阅读：[http ://answers.yahoo.com/question/index?qid=20080529114633AAHE4DE](http://answers.yahoo.com/question/index?qid=20080529114633AAHE4DE)

在您理解了这些概念之后，解决方案应该是显而易见的。

# css - Chrome和IE9中的垂直节奏

> ID：13361964
> 
> 赞同：-1
> 
> 时间：2012-11-13T13:53:27.607
> 
> 标签：css

我正在研究我的 css 框架的垂直节奏——它在 Firefox 中看起来很完美，但在 chrome 和 ie9 中却不同。有谁知道是什么原因？

我的框架排版页面： http: [//kenhty.github.com/Natural/typography.htm](http://kenhty.github.com/Natural/typography.htm)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T18:09:54.550

如果您指的是 box-flex 网格，请查看[MDN 页面](https://developer.mozilla.org/en-US/docs/CSS/Using_CSS_flexible_boxes)中关于使用灵活框的规范。您遇到了几个问题...

一方面，支持极为有限。Firefox 18+、Chrome 21+，不支持 IE 和 Safari。因此，您在 Chrome 中遇到了问题，因为生产版 Chrome 是唯一真正支持您的代码的版本，而且您缺少以下样式：

`-webkit-flex-direction: column`

您的默认设置为`row`，这导致您在 Chrome 中出现问题。

更令人困惑的是，我使用的是 Firefox 15 并且它正在正确显示您的 Grid ......但是在查看计算机样式时，它甚至不显示您的网格样式，因为 Firefox 15 还不支持它。所以我真的很惊讶你的网格在 Firefox 中正确显示。

无论如何，请检查哪些浏览器支持它，并确保您覆盖了任何需要覆盖的默认设置。

# session - 具有 SSL 和共享会话的 Haproxy

> ID：13361968
> 
> 赞同：0
> 
> 时间：2012-11-13T13:53:44.483
> 
> 标签：session, ssl, shared, haproxy

实际上，我使用本机 ssl 支持测试了最新的 haproxy 开发版本。它工作正常，但我有一个问题。共享 ssl 会话是否像 Stud 一样可用？如果答案是真的，我该如何设置她？我在 haproxy 文档中没有找到这个...

提前致谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T18:26:36.730

会话可以在多个进程之间共享，但不能在多个主机之间共享。然而，为 Stud 做这项工作的开发人员考虑到了 haproxy，而且他也是做多进程缓存的人，所以理论上他应该不需要很长时间才能完成这项工作，当然前提是我们不这样做' t 在处理 UDP 侦听器时遇到新的讨厌的问题 :-)

# cocos2d-iphone - Cocos2D UITextView 不随 GLView 旋转

> ID：13361971
> 
> 赞同：0
> 
> 时间：2012-11-13T13:53:52.570
> 
> 标签：cocos2d-iphone, orientation, uitextview, autorotate

所以我在 Cocos2D 中的 OpenGL 视图中添加了一个 UITextView。做了一些旋转以适合我的风景和所有。但不知何故，当整个场景旋转时，textview 不会。我试过了

```
[[[CCDirector sharedDirector] openGLView] window].autoresizesSubviews = YES; 
```

并包括这些功能，但它仍然保持不变..

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
- (void) willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration 
```

有任何想法吗？

我已使用以下方法将其添加到我的 openGLView 中：

```
[[[[CCDirector sharedDirector] openGLView] window] addSubview:self]; 
```

我的类继承自 UITextView。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T03:55:48.060

打开文件`GameConfig.h`，定义自动旋转类型。希望它会有所帮助。

# php - 在没有在线转换器的情况下在 php 中将 json 转换为 xml

> ID：13361972
> 
> 赞同：0
> 
> 时间：2012-11-13T13:53:59.710
> 
> 标签：php, json, converter

我已经为此努力了一段时间，但找不到关于如何通过 file_get_contents 在 php 中将 json 转换为 xml 的解决方案。我不想使用在线转换器，但想将它放在我的网站根目录中。提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T13:57:15.130

您可以使用 将 JSON 转换为数组/对象[`json_decode()`](http://php.net/manual/en/function.json-decode.php)，一旦将它包含在数组中，您就可以使用任何[XML 操作方法](http://www.php.net/manual/en/refs.xml.php)从中构建 XML。

例如，您可以像这样构建 XML 结构：

```
<array>
  <data name="atrribute1">string 1</data>
  <array name="array_atribute">
     <data name="attribute2">string 2</data>
     <data name="attribute2">string 2</data>
  </array>
</array> 
```

通过[`DOMDocument`](http://www.php.net/manual/en/book.dom.php), 和方法[`DOMDocument::createElement()`](http://www.php.net/manual/en/domdocument.createelement.php)

```
class XMLSerialize {

    protected $dom = null;

    public function serialize( $array)
    {
        $this->dom = new DOMDocument('1.0', 'utf-8');
        $element = $this->dom->createElement('array');
        $this->dom->appendChild($element);
        $this->addData( $element, $array);
    }

    protected function addData( DOMElement &$element, $array)
    {
        foreach($array as $k => $v){
            $e = null;
            if( is_array( $v)){
                // Add recursive data
                $e = $this->dom->createElement( 'array', $v);
                $e->setAttribute( 'name', $k);       
                $this->addData( $e, $v);

            } else {
                // Add linear data
                $e = $this->dom->createElement( 'data', $v);
                $e->setAttribute( 'name', $k);
            }

            $element->appendChild($e);
        }

    }

    public function get_xml()
    {
         return $this->dom->saveXML();
    }
} 
```

# image - 如何向表达式引擎博客帖子添加图像、标题和学分

> ID：13361975
> 
> 赞同：2
> 
> 时间：2012-11-13T13:54:14.123
> 
> 标签：image, expressionengine

博客文章（单入口页面）由文本和图像组成。频道“blog”具有字段组“blog_entries”。字段组中有趣的字段是“blog_body”，三个关系字段分别称为“image1”、“image2”、“image3”。图像存储在称为“images”的不同通道中。字段组“image_entries”有几个字段。图片上传字段本身、标题、学分等等。

我可以通过关系字段组合图像和文本。

我的问题是：编辑器应该将图像放置在内容中必须出现的位置。他应该能够选择图像的大小（应该跨越 4、8 或 12 列） 下面的示例有一个 8 列宽的图像。

添加图像将添加以下代码

```
<div class="eight columns picture">
    <div id="copyright" class="text-right">
      &copy; <a href="#">Photographer name</a>, <a href="#">Flickr</a>
    </div>
    <img src="http://placehold.it/700x525&text=[700x525]" />
   <div class="panel">
     <p>I am the caption. Nulla corned beefsunt ball tip.</p>
  </div> 
```

我想要实现的是：编辑器将文本输入到 CP 中的 blog_entries 字段中。该字段是一个带有自定义 HTML 按钮的文本区域。在写了两段之后，他需要一个图像来说明他所写的内容。他单击自定义 HTML 按钮，查看相关图像，选择图像大小（应该跨越 4,8 或 12 列），然后单击 EE 将所有必要的代码集成到条目中。因此，编辑不必担心 DIV 和所有代码，而是可以将之前上传的图像放置在文章中他想要的任何位置。

我怎样才能做到这一点？我不一定要这样做。如果有其他方法或插件可以解决该问题，我想听听。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-13T16:09:52.677

一种完全不同的方法，但我过去曾用于此类事情的是 Matrix。您将 blog_body 设置为矩阵字段，旨在为文章中的每个断点添加一行（例如，断点是插入图像）。因此，矩阵可能包括 3 列 - 一列用于图像，一列用于图像宽度（例如，三个不同跨度宽度之间的无线电）和一列用于“段落内容”。

不过，这里的挑战是您正在为图像使用关系字段，而不是将图像作为博客条目的一部分。据我所知，由于关系字段不是可以在矩阵字段中使用的字段类型，因此采用这种方法变得更加困难。但是，如果您保持固定数量的关系字段 - 正如您所建议的那样，image1、image2、image3，那么矩阵中的第一列可能只是一个单选按钮，供编辑器在 image1、image2 和 image3 之间进行选择以插入这个断点。不是 Matrix 的典型用法，但它可以让您在编辑器对内容的控制方面相对面向对象。

希望这个想法能帮助或激发新的想法！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T16:00:13.030

我经常在内容丰富的网站上使用这种方法，但我通常使用默认字段类型。只是 Jean 提出的一种变体，基本逻辑保持不变。

1.  同一频道中博文的图片和文字
2.  确定每个帖子所需的最小和最大图像数量（通常我选择 3 个）
3.  不是只有一个正文字段、一个标题字段、一个图像字段和一个图像尺寸字段（我通常使用 P&T 字段），而是将整个批次复制三次（如果最多使用 3 张图像）。
4.  我通常只将第一个文本 + 图像 + 图像配置字段设为必填
5.  您的客户现在可以用一张、两张或三张图片“组成”他们自己的页面，以各种方式显示，但将保持在您定义的范围内。

希望能帮助到你

# ruby - JSON.parse 中的 create_additions 选项有什么作用

> ID：13361982
> 
> 赞同：7
> 
> 时间：2012-11-13T13:54:33.817
> 
> 标签：ruby, json

我在 ruby​​s JSON.parse docs 中遇到了这个`create_additions`选项，但我似乎找不到任何关于它的文档。

rdoc 描述了该选项：

> create_additions：如果设置为 false，即使找到匹配的类和 ::create_id，解析器也不会创建添加。此选项默认为 true。

出于好奇，谁能解释这个选项的实际作用以及 JSON.parse 的这个“附加”功能到底是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-13T15:46:32.297

“添加”是对纯 JSON 的添加。如果散列具有`json_class`键（可使用 自定义[`JSON.create_id`](http://www.ruby-doc.org/stdlib-2.0/libdoc/json/rdoc/JSON.html#create_id)），则将其反序列化为该类而不是普通散列。

# asp.net-mvc - c# mvc 4 EF 5 在不知道表名的情况下从 dbcontext 获取 dbset

> ID：13361983
> 
> 赞同：0
> 
> 时间：2012-11-13T13:54:35.110
> 
> 标签：asp.net-mvc, asp.net-mvc-4, entity-framework-5

我有一个`Users`实体集和一个`Administrators`实体集。我想从 DBContext中获取可以是 a`IEnumerable<Users>`或 a的项目列表`IEnumerable<Administrators>`

我希望能够做到

```
Type dbContextType = db.GetType();

Type tableType = dbContextType.GetProperty("users", 
    BindingFlags.IgnoreCase | BindingFlags.Public | BindingFlags.Instance
).PropertyType;

var items = db.Database.SqlQuery(tableType , "SELECT * FROM users"); 
```

问题是 tableType 是 typeof `DbSet`，我需要 typeof`Users`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-14T13:39:57.383

比我想象的要简单

```
Type typeDB = Type.GetType("Models.User");

var items = db.Database.SqlQuery(typeDB, "SELECT * FROM users WHERE IdUser = '"+id+"'"); 
```

items 现在是一个`System.Data.Entity.Internal.InternalSqlQuery`女巫，我们的对象有一个枚举器。问题是我们无法将此对象发送到强类型视图。

因此我们必须对其进行强制转换。如果我们不知道我们希望将其强制转换为的类，那么我们可以将其强制转换为对象类型。我们要将它发送到的视图将对强类型对象进行特定的转换。

```
return View("Users", items.Cast< object >().ElementAt(0)); 
```

现在我们有了一个可以用于多个强类型视图的控制器。

# google-chrome-extension - 从背景到内容脚本的 chrome 扩展消息传递给：端口错误：无法建立连接。接收端不存在

> ID：13361984
> 
> 赞同：1
> 
> 时间：2012-11-13T13:54:35.613
> 
> 标签：google-chrome-extension, messaging

我看到了关于我遇到的类似问题的所有与 stackoverflow 相关的答案。但他们都没有解决我的问题

我有这个：

清单.json

```
{
   "background": {
      "page": "background.html" 
   },
   "content_scripts": [
    {
      "matches": ["http://*/*","https://*/*"],       
      "js": ["contentscript.js"],
      "run_at": "document_end",
      "all_frames": true
    }
   ],
   "web_accessible_resources": [
    "script_inpage.js"
   ],
   "browser_action": {
      "default_icon": "icon19.png",
      "default_popup": "popup.html",
      "default_title": "Player"
   },
   "content_security_policy": "script-src 'self'; media-src *; object-src 'self'",
   "description": "blah.",
   "icons": {
      "128": "icon128.png",
      "16": "icon16.png",
      "32": "icon32.png",
      "48": "icon48.png"
   },

   "manifest_version": 2,
   "minimum_chrome_version": "18",
   "name": "Player",
   "permissions": [ 
        "unlimitedStorage",
        "http://*/",
        "tabs"
   ],
   "update_url": "http://clients2.google.com/service/update2/crx",
   "version": "2.6"
} 
```

背景.html

```
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="background.js"></script>

</head>
<body>
    <audio src="" id="mplayer"></audio>
</body>
</html> 
```

背景.js

```
function playMusicFile() {

    console.log("playMusicPlayer() from background.js");

    var id="";
    chrome.tabs.getSelected(null, function(tab) {
          id=tab.id; 
          console.log(tab.id);
          var port = chrome.tabs.connect(id);
          port.postMessage({text: "post from plugin",name:"playermsg"});
    });  

    document.getElementById("mplayer").play()
} 
```

内容脚本.js

```
var portRec = chrome.extension.connect();
chrome.extension.onConnect.addListener(function(port) {
  portRec.onMessage.addListener(function(msg) {
    alert(msg["text"]+"  "+msg["name"]);
    portRec.postMessage({text: "hello"});
  });
}); 
```

在看到日志打印后，我不断收到此错误：

> 端口错误：无法建立连接。接收端不存在。miscellaneous_bindings:235 chromeHidden.Port.dispatchOnDisconnect

# java - 读取excel文件并添加到java实体类中

> ID：13361990
> 
> 赞同：0
> 
> 时间：2012-11-13T13:55:14.217
> 
> 标签：java, excel

我正在使用 jxl 库读取 excel 文件。但是当我想将单元格内容添加到 pojo 类属性中时，我遇到了一个问题。这样我有 Employee 类；

```
public class Employee {

    private String id;
    private String name;
    private String email;
    public String getId() {
        return id;
    }
    public void setId(String id) {
        this.id = id;
    }
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }
    public String getEmail() {
        return email;
    }
    public void setEmail(String email) {
        this.email = email;
    }

}

public static void read(String path) throws IOException {
        File inputWorkbook = new File(path);
        Workbook w;
        String[] excel_data  = new String[3]; 
        try {
            w = Workbook.getWorkbook(inputWorkbook);
            // Get the first sheet
            Sheet sheet = w.getSheet(0);
            // Loop over first 10 column and lines

            Vector<Employee> data = new Vector<Employee>();
            for (int j = 1; j < sheet.getRows(); j++) 
              { 

                          Employee emp = new Employee()
               for (int i = 0; i < sheet.getColumns(); i++) 
               { 
                   Cell cell = sheet.getCell(i, j);
                 //  d.add(cell.getContents());
                               emp.setId(cell.getContents());
                              emp.setName(cell.getContents());
                              emp.setEmail(cell.getContents());
                }
                 //  d.add("\n");
                   data.add(emp);   

                //insertEmployee(emp);
            } 
```

在这里，我的代码可以将单元格内容添加到矢量对象中。但我想将单元格内容值设置为 Employee 类属性。请告诉我如何实现这一点。我没有从 emp 对象中获得正确的值。当我将内容添加到列表中时，我在代码中做错了什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T14:05:00.947

您必须手动设置这些值。

您可以编写一个 switch 语句并为每个列索引设置值，如下所示：

```
List<Employee> employees = new ArrayList<Employee>();
...
Employee emp = new Employee();
for (int i = 0; i < sheet.getColumns(); i++) 
{ 
    Cell cell = sheet.getCell(i, j);
    switch (i) {
    // column 0 = ID
    case 0:
        emp.setId(cell.getContents());
        break;
    // column 1 = Name
    case 1:
        emp.setName(cell.getContents());
        break;
    // column 2 = Email
    case 2:
        //... etc
        break;
    }

}
employees.add(emp); 
```

# mysql - 在 Excel 2010 中关闭 MySQL 查询的参数中的转义

> ID：13361994
> 
> 赞同：2
> 
> 时间：2012-11-13T13:55:34.110
> 
> 标签：mysql, excel, parameters, odbc

我正在使用 Excel 2010 和 ODBC 连接器从 MySQL 数据库中提取数据。

我只想根据用户名列表提取某些记录。

我已将登录列表放入正确格式化的单元格中

```
SELECT * FROM table WHERE login IN (?) 
```

参数指向包含表单列表的单元格（使用自定义连接函数从列构造）：

'login1','login2',...'loginN'

但是，当我运行查询时，我得到 0 行返回；玩弄它，似乎 Excel 正在转义单引号，因此发送到 MySQL 服务器的查询是：

```
SELECT * FROM table WHERE login IN (\'login1\',\'login2\',...\'loginN\') 
```

...什么都不匹配。

有什么方法可以防止转义，或者“SELECT ... WHERE IN”查询的另一种方法可行吗？

# ruby-on-rails - 如何在 Rails 代码中找到方法

> ID：13361998
> 
> 赞同：0
> 
> 时间：2012-11-13T13:55:43.510
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在查看一些开源代码以更好地熟悉 Rails 代码。

我在下面看到`application_controller`

```
 def can_signup?
    [ :allowed, :needs_approval ].include? Setting.user_signup
  end 
```

我似乎无法找到该方法在代码中的定义位置`Setting.user_signup`

`Setting`是一个模型

我能错过什么？代码链接：[https ://github.com/fatfreecrm/fat_free_crm/blob/master/app/controllers/application_controller.rb#L155-157](https://github.com/fatfreecrm/fat_free_crm/blob/master/app/controllers/application_controller.rb#L155-157)

grep 输出：

```
/rails_projects/fat_free_crm $ grep -r --include="*.rb" "user_signup" .
./app/controllers/application_controller.rb:    [ :allowed, :needs_approval ].include? Setting.user_signup
./app/controllers/users_controller.rb:      if Setting.user_signup == :needs_approval
./app/models/users/user.rb:    self.suspended? && self.login_count == 0 && Setting.user_signup == :needs_approval
./app/models/users/user.rb:    self.suspended_at = Time.now if Setting.user_signup == :needs_approval && !self.admin
./spec/controllers/authentications_controller_spec.rb:          Setting.stub!(:user_signup).and_return(:needs_approval)
./spec/controllers/users_controller_spec.rb:        Setting.stub!(:user_signup).and_return(:needs_approval)
./spec/models/users/user_spec.rb:    Setting.stub(:user_signup).and_return(:needs_approval)
./spec/models/users/user_spec.rb:    Setting.stub(:user_signup).and_return(:needs_approval) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-13T14:20:04.897

在这种情况下，`Setting`模型正在使用`method_missing`，这是一个在`NoMethodError`引发异常时调用的特殊方法（如果已定义）。

更多信息在`method_missing`这里： [http ://rubylearning.com/satishtalim/ruby_method_missing.html](http://rubylearning.com/satishtalim/ruby_method_missing.html)

如果您查看以下`method_missing`实现`Setting`： [https ://github.com/fatfreecrm/fat_free_crm/blob/master/app/models/setting.rb#L54-65](https://github.com/fatfreecrm/fat_free_crm/blob/master/app/models/setting.rb#L54-65)

您会发现`Setting.user_signup`它将变为`Setting['user_signup']`，因此该`[]`方法将`user_signup`作为第一个参数调用： [https ://github.com/fatfreecrm/fat_free_crm/blob/master/app/models/setting.rb#L69-84](https://github.com/fatfreecrm/fat_free_crm/blob/master/app/models/setting.rb#L69-84)

根据文档，该方法 ( `[]`) 将在数据库表或 .yml 文件中搜索名称等于第一个参数的设置，然后返回相对值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-13T14:01:37.663

由于 Ruby 是一种动态语言，因此查找方法的最佳方式是搜索字符串本身。请记住，由于方法可能是动态创建的，因此代码中可能没有实际的`def user_signup`任何地方，但该方法仍然可能存在。

要在所有项目中搜索字符串，您可以使用您的编辑器（无论哪个 - 他们都有这个选项），或者只是`grep -r user_signup .`从您的应用程序根目录中使用。