# StackOverflow 问答 14102000-14102999

# java - 无法使用 java 反射更改静态最终字段？

> ID：14102000
> 
> 赞同：8
> 
> 时间：2012-12-31T13:06:42.297
> 
> 标签：java

我最近偶然发现了[使用 Java 反射更改私有静态最终字段](https://stackoverflow.com/questions/3301635/change-private-static-final-field-using-java-reflection)并测试了 polygenelubricants 的`EverythingIsTrue`类，工作正常，确实可以`System.out.format("Everything is %s", false);`打印。`Everything is true`但是当我将代码更改为

```
public class EverythingIsTrue {

    public static final boolean FALSE = false;

    static void setFinalStatic(Field field, Object newValue) throws Exception {
        field.setAccessible(true);
        Field modifiersField = Field.class.getDeclaredField("modifiers");
        modifiersField.setAccessible(true);
        modifiersField.setInt(field, field.getModifiers() & ~Modifier.FINAL);
        field.set(null, newValue);
    }

    public static void main(String[] args) throws Exception {
        setFinalStatic(EverythingIsTrue.class.getField("FALSE"), true);
        System.out.format("Everything is %s", FALSE);
    }
} 
```

它打印

```
Everything is false 
```

有人知道为什么吗？setFinalStatic 是否真的有效？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-12-31T13:27:55.923

您可以通过使该值成为方法调用的结果（甚至是虚拟的结果）来避免编译器内联。

```
public class Main {
    // value is not known at compile time, so not inlined
    public static final boolean FLAG = Boolean.parseBoolean("false");

    static void setFinalStatic(Class clazz, String fieldName, Object newValue) throws NoSuchFieldException, IllegalAccessException {
        Field field = clazz.getDeclaredField(fieldName);
        field.setAccessible(true);
        Field modifiers = field.getClass().getDeclaredField("modifiers");
        modifiers.setAccessible(true);
        modifiers.setInt(field, field.getModifiers() & ~Modifier.FINAL);
        field.set(null, newValue);
    }

    public static void main(String... args) throws Exception {
        System.out.printf("Everything is %s%n", FLAG);
        setFinalStatic(Main.class, "FLAG", true);
        System.out.printf("Everything is %s%n", FLAG);
    }
} 
```

印刷

```
Everything is false
Everything is true 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-12-31T13:18:43.040

当访问原始静态最终字段时，Java 编译器将假定该值是一个常量并内联该值，而不是生成访问该字段的代码。这意味着编译器将替换为对`FALSE`具有 value 的字段的引用`false`。如果你使用反射来访问字段，你会看到字段的值实际上已经改变了。

这不适用于非原始字段，因为对象引用的值不能在编译时内联。

# scala - 如何从另一个对象实例访问私有字段？

> ID：14102002
> 
> 赞同：2
> 
> 时间：2012-12-31T13:06:52.653
> 
> 标签：scala

我目前正在研究如何在 Scala 中处理协变和逆变类型参数化。还有一种特殊情况，var 字段必须是 private[this] 才能编译。来自此代码片段中的示例（取自此问题：[private[this] vs private](https://stackoverflow.com/questions/9698677/privatethis-vs-private)）：

```
class Holder[+T] (initialValue: Option[T]) {
    // without [this] it will not compile
    private[this] var value = initialValue

    def getValue = value
    def makeEmpty { value = None }
} 
```

我理解这个例子。但是我不明白的是，在什么情况下可以从其他实例访问私有字段而不是 itelt（this）？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T13:18:26.520

如果成员是纯私有的，则可以从同一类的其他实例访问它。`[this]`后缀使其仅对包含它的实例可见。

# c++ - C ++中的小写到大写

> ID：14102007
> 
> 赞同：-2
> 
> 时间：2012-12-31T13:07:27.887
> 
> 标签：c++, uppercase, lowercase

请注意，我不是在问在 C++ 中将小写字母转换为大写字母的方法是什么，而是我想知道下面代码（Upper1 和 Upper2）中这两种方法中的哪一种比另一种更好，原因是什么，编程明智。

```
#include <string>
#include <iostream>
#include <locale> //Upper2 requires this module

using namespace std;

void Upper1(string &inputStr);
void Upper2(string &inputStr);

int main(){

    string test1 = "ABcdefgHIjklmno3434dfsdf3434PQRStuvwxyz";
    string test2 = "ABcdefgHIjklmnoPQRStuvwxyz";

    Upper1(test1);
    cout << endl << endl << "test1 (Upper1): ";
    for (int i = 0; i < test1.length(); i++){
        cout << test1[i] << " ";
    }

    Upper2(test2);
    cout << endl << endl << "test2 (Upper2): ";
    for (int i = 0; i < test2.length(); i++){
        cout << test2[i] << " ";
    }

    return 0;
}

void Upper1(string &test1){

    for (int i = 0; i < 27; i++){ 
        if (test1[i] > 96 && test1[i] <123){ //convert only those of lowercase letters
            test1[i] = (char)(test1[i]-(char)32);
        }

    }
}

void Upper2(string &test2){

    locale loc;

    for (size_t i=0; i<test2.length(); ++i)
        test2[i] = toupper(test2[i],loc);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T13:37:08.483

两种提议的解决方案之间的主要区别在于 `Upper2`这种工作方式，无论平台如何；`Upper1` 对编码做出假设，并且不适用于我所知道的任何现代平台。（它假定 ASCII，而 ASCII 出于所有意图和目的，已经死了。）

当然，两者都不起作用，原因有两个：首先，大多数现代机器使用多字节编码 (UTF-8)，因此您不能一次将字符串从低字节转换为高字节。第二个是因为一般来说不存在下到上的一对一关系：经典的例子是`'ß'`，它的大写等价物是两个字符串`"SS"`。尽管如此，对于函数的稍微简单的定义，以及像 ISO 8859-1 （可能是最近使用最广泛的）这样的单字节编码， `Upper2`将做得相当好（假设`'ß'` 输入中没有），足够用于许多用途，而`Upper1`将可悲地失败。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T13:39:55.523

如果您有来自英语 AZ 字母以外的其他语言的字母，例如日耳曼语 ä、ö 或 ü，以及法语/西班牙语中的各种重音字母，当然，如果输入是“germano”，则使用 toupper 将没有意义-latin” 语言，例如俄语。[正如 James 所指出的，这可能需要 Unicode 解析，这完全是一个全新的球赛，虽然']

显然，第一个函数也被硬编码以转换输入的前 27 个字符，这是不好的编码，因为函数不应该依赖字符串的大小 - 特别是因为 "std::string" 确实有长度第一！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T13:23:47.867

1.  *toupper()*可以处理非ASCII字符
2.  语法方面，*Upper2()*不易出错
3.  对此不太确定，但我认为*toupper()*较慢

# c# - NServiceBus：调用 MarkAsComplete() 时删除延迟消息

> ID：14102008
> 
> 赞同：1
> 
> 时间：2012-12-31T13:07:32.600
> 
> 标签：c#, nservicebus

使用 NServiceBus 3.2.7。当调用 MarkAsComplete 时（当有延迟消息输出时，一个人取消了他们的订单。）看起来调用 MarkAsComplete 确实消除了 saga，但之前延迟的消息仍在超时队列中。当他们最终处理时，他们陷入了 SagaNotFound 异常。我希望能够明确区分未找到合法的传奇和因取消订单而被删除的传奇之间的区别。

如何从 Raven 中删除延迟消息？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:23:07.740

在超时和取消之间存在固有的竞争条件。可能是在取消发生时超时已经在传递中，因此无法清除。

正是出于这个原因，NServiceBus 将 SagaNotFound 作为事件而不是异常引发。

希望有帮助。

# c# - 在 asp.net 中显示来自二进制数据/Blob 的图像

> ID：14102011
> 
> 赞同：2
> 
> 时间：2012-12-31T13:07:52.570
> 
> 标签：c#, asp.net, sql-server, visual-studio-2010, visual-studio

我已经设法使用 imagehandler 从数据库中检索我的图像，但问题是，它只使用第一个图像检索，而不是在不同的数据上显示不同的图像。

所以这是我的图像处理程序代码我对这一行（`string volunteerNames = imageRequest.QueryString["VolunteerName"];`）有问题，它只显示`System.Byte[]`而不是显示名称

```
<%@ WebHandler Language="C#" Class=".ShowImage" %>

using System;
using System.Web;
using System.Configuration;
using System.Data.SqlClient;

public class ShowImage : IHttpHandler
{

public void ProcessRequest(HttpContext context)
{
    HttpRequest imageRequest = context.Request;
    HttpResponse imageResponse = context.Response;

    //string connStr = ConfigurationManager.ConnectionStrings["DBconnStr"].ConnectionString;
    using (SqlConnection conn = new SqlConnection())
    {
        conn.ConnectionString = "Data Source=.\\SQLEXPRESS;AttachDbFilename=\"C:\\Users\\User\\Desktop\\ProjectAV2.9\\ProjectA\\ProjectA\\App_Data\\ProjectA.mdf\";Integrated Security=True;Connect Timeout=30;User Instance=True";
        string queryStr = "SELECT * FROM TVolunteer WHERE VolunteerName = @Name";
        string bQueryStr = "SELECT * FROM BVolunteer WHERE VolunteerName = @Name";
        string volunteerNames = imageRequest.QueryString["VolunteerName"];

        SqlCommand bCMD = new SqlCommand(bQueryStr, conn);
        SqlCommand cmd = new SqlCommand(queryStr, conn);
        bCMD.Parameters.AddWithValue("@Name", volunteerNames);
        cmd.Parameters.AddWithValue("@Name", volunteerNames);
        conn.Open();

        SqlDataReader dr = cmd.ExecuteReader();

        if (dr.HasRows)
        {
            dr.Read();
            string volunteerNRIC = dr["VolunteerNRIC"].ToString();
            byte[] volunteerProfilePicture = (byte[])dr["VolunteerProfilePicture"];
            string volunteerName = dr["VolunteerName"].ToString();
            string volunteerContact = dr["VolunteerContact"].ToString();
            string volunteerAddress = dr["VolunteerAddress"].ToString();
            string volunteerEmail = dr["VolunteerEmail"].ToString();
            imageResponse.BinaryWrite(volunteerProfilePicture);

        }
        dr.Close();

        SqlDataReader bDR = bCMD.ExecuteReader();
        if (bDR.HasRows)
        {
            bDR.Read();
            byte[] volunteerProfilePicture = (byte[])bDR["VolunteerProfilePicture"];
            string volunteerName = bDR["VolunteerName"].ToString();
            string volunteerContact = bDR["VolunteerContact"].ToString();
            string volunteerAddress = bDR["VolunteerAddress"].ToString();
            string volunteerEmail = bDR["VolunteerEmail"].ToString();
            imageResponse.BinaryWrite(volunteerProfilePicture);

            bDR.Close();
        }
    }
}

 public bool IsReusable
 {
    get
    {
        return false;
    }

 }
} 
```

这是我的数据列表

```
 <asp:DataList ID="dl_tvolunteer" runat="server" CellPadding="3" 
        ForeColor="#333333" RepeatColumns="3"
    RepeatDirection="Horizontal" Width="375px" Height="193px" GridLines="Both">
        <ItemTemplate>
            <asp:Image ID="Image1" runat="server" ImageUrl='<%# DataBinder.Eval(Container.DataItem, "VolunteerProfilePicture","~/ShowImage.ashx?VolunteerName="+ Eval("VolunteerName") %>'  />
            <br />
            <asp:Label ID="lbl_Name" runat="server" Text='<%# Bind("VolunteerName") %>'></asp:Label>
            <br />
            <asp:Label ID="lbl_Contact" runat="server" Text='<%# Bind("VolunteerContact") %>'></asp:Label>
            <br />
            <asp:Label ID="lbl_Address" runat="server" Text='<%# Bind("VolunteerAddress") %>'></asp:Label>
            <br />
            <asp:Label ID="lbl_Email" runat="server" Text='<%# Bind("VolunteerEmail") %>'></asp:Label>
        </ItemTemplate>
    </asp:DataList> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:17:14.447

您应该像这样在图像处理程序中定义您的 mime 类型：

```
imageResponse.ContentType = "Image/Jpeg"; 
```

**编辑：**看起来你应该像这样改变你的图像列。那一个获取您的志愿者姓名并将其传递给您的查询字符串参数：

```
<asp:Image ID="Image1" runat="server" ImageUrl='<%# 
       DataBinder.Eval(Container.DataItem, 
                       "VolunteerName", 
                       "~/ShowImage.ashx?VolunteerName={0}") 
       %>'/> 
```

# objective-c - 如何在标签栏上添加客户徽标

> ID：14102016
> 
> 赞同：1
> 
> 时间：2012-12-31T13:08:01.950
> 
> 标签：objective-c, ios, ipad, tabbar

在我的 iPad 应用程序中，**如何在右下角添加客户徽标的图像？** 我的应用程序包含 5 个选项卡。我正在为 iOS 4.3 工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:16:50.027

```
UIImage *navBarImage = [UIImage imageNamed:@"images/menubar.png"];
[[UINavigationBar appearance] setBackgroundImage:navBarImage
                               forBarMetrics:UIBarMetricsDefault];

UIImage *barButton = [UIImage imageNamed:@"images/barbutton.png"];
[[UIBarButtonItem appearance] setBackgroundImage:barButton
                                    forState:UIControlStateNormal
                                  barMetrics:UIBarMetricsDefault];

UIImage *backButton = [UIImage imageNamed:@"images/back.png"];
[[UIBarButtonItem appearance] setBackButtonBackgroundImage:backButton
                                              forState:UIControlStateNormal
                                            barMetrics:UIBarMetricsDefault];

UIImage *tabBarBackground = [UIImage imageNamed:@"images/tabbar.png"];
[[UITabBar appearance] setBackgroundImage:tabBarBackground];
[[UITabBar appearance] setSelectionIndicatorImage:[UIImage imageNamed:@"images/selection-tab.png"]]; 
```

更多你可以在这里找到 [http://alexyoung.org/2011/12/07/ios-5-redemption/](http://alexyoung.org/2011/12/07/ios-5-redemption/)

或谷歌的 UIAppearance

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:57:57.993

您需要设置标签栏的宽度，以便您的 UIImageView 有空间。

将您的 UIImageView 添加为子视图 UITabBarcontroller.view 并定位它。

使用以下代码设置UITabBarController的宽度

```
 for(UIView *view in tabBarController.view.subviews)
{

    if([view isKindOfClass:[UITabBar class]])
    {
      view.frame = //set your rect
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:15:42.777

一种方法是控制 UITabBar。使该控件为每个选项卡提供一个 UIButton，然后在将这些按钮连接到以编程方式调用选项卡栏按下的方法时，使用 setSelected 和按下选项卡的索引。

不过，我认为您可以使用 iOS 5 及更高版本进行更好（不那么骇人听闻）的自定义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T16:47:50.843

我建议添加一个常规`UITabBarItem`并禁用它：

```
[[tabBar items][4] setEnabled:NO]; 
```

“4”是 tabBar 中的第 5 个也是最后一个项目。`tabBar.items.count-1`如果您不确定将来是否会添加任何其他人，可以将其替换为。

由于被禁用，静态项目将具有一种水印效果。

# sql - SQL查询计算一个月的天数

> ID：14102020
> 
> 赞同：0
> 
> 时间：2012-12-31T13:08:17.563
> 
> 标签：sql, postgis

> **可能重复：**
> [如何在mysql中找出一个月的天数](https://stackoverflow.com/questions/10736989/how-to-find-out-number-of-days-in-month-in-mysql)

我需要计算特定月份的天数。假设用户给出了 2012 年 11 月 25 日。查询需要将其返回为 30。请帮助我在 Postgres 中编写 sql 代码。

提前致谢。纳文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:17:09.467

```
SELECT  DATE_PART('days', DATE_TRUNC('month', NOW())
 + '1 MONTH'::INTERVAL -    DATE_TRUNC('month', NOW())) 
```

在这里，您只需要提供您的月份数或日期，而不是 now()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:25:58.117

在***mysql***中工作：

```
SELECT DAY(LAST_DAY('2003-02-05')); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T13:26:34.020

声明@DateTimeE datetime=Convert(Datetime,'03-25-2012',101) 声明@days int Select @days= DATEDIFF(Day, DATEADD(mm, DATEDIFF(m,0,@DateTimeE),0),DATEADD( s,-1,DATEADD(mm, DATEDIFF(m,0,@DateTimeE)+1,0)))+1 选择 @days

# yii - 如何以所需格式获取 json 输出

> ID：14102023
> 
> 赞同：0
> 
> 时间：2012-12-31T13:08:27.220
> 
> 标签：yii, json

我在yii工作。我的控制器功能为-

```
public function actiongetPublicQuestion()
{
    $model=new Qbquestion();
    $new = Yii::app()->db->createCommand()->select('max(tranId)')->from('qbpublicuserquestion')->queryScalar();
    $CurrentQuestionId=Qbpublicuserquestion::model()->findByPk($new);
    $currentQuestion=Qbquestion::model()->findByPk($CurrentQuestionId->questionId);
    echo "Currently displayed question is=".$currentQuestion->question."</Br>";
//  $answer=Qbquestionoption::model()->findAllByAttributes(array('questionId'=>$currentQuestion1->questionId));

    $old = Yii::app()->db->createCommand()->select('max(tranId-1)')->from('qbpublicuserquestion')->queryScalar();
    $PreviousQuestionId=Qbpublicuserquestion::model()->findByPk($old);
    $currentQuestion1=Qbquestion::model()->findByPk($PreviousQuestionId->questionId);
    echo "previously displayed question is=".$currentQuestion1->question;
    $answer=Qbquestionoption::model()->findAllByAttributes(array('questionId'=>$currentQuestion1->questionId));

    foreach($answer as $ans)
    {
    //  var_dump($ans);

        if($ans->isAnswer==1)
        {
            echo "</br>"."correct Answer is=".$ans->option."with optionId=".$ans->optionId;
            $true=$ans->option;
            echo "</br>";
            echo "{'questions':[".CJSON::encode(array("question"=>$currentQuestion1->question,"answer"=>$true,"question1"=>$currentQuestion->question))."] }";
        }
    }
} 
```

所以我从数据库中检索两个问题，这样表的最后一个条目是当前显示的问题，而倒数第二个条目是以前显示的问题。我也想发布以前显示的问题的答案。我以 json 编码格式发送此信息。我想以格式输出=

```
"Questions": [
    {"question": "Who is the prime minister of india?","answer":"Manmohan sinh"},
    {"question": "2 when who will win the test?"},
] 
```

但是当我在 CJSON::encode(array("question"=>$currentQuestion1->question,"answer"=>$true,"question"=>$currentQuestion->question))."] 中使用相同的变量时";}，如果我们在编码的 cjson 数组中使用相同的变量，它只给出一个问题。那么如何获得所需的输出。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T01:15:15.773

由于您想要的输出有两个 JSON 对象（即大括号中的两个项目），因此您传递给 CJSON::encode 的数据结构需要是对象或数组的数组，即：

```
CJSON::encode(array(array("question"=>$currentQuestion1->question,"answer"=>$true), 
                    array("question"=>$currentQuestion->question),
                    )
            ); 
```

# c# - 我可以将多个值传递给 C# 中的 Setter 吗？

> ID：14102028
> 
> 赞同：2
> 
> 时间：2012-12-31T13:09:14.613
> 
> 标签：c#, xml, properties, resx

大家好，我正在尝试构建保存设置并且不公开我的方法我试图从实际运行时隐藏尽可能多的方法，并从我所有的 IO 的 setter 和 getter 中运行它们。

我需要能够将文件位置的 Uri 和 Dictionary 都传递到方法中才能进行调用。我会将文件位置放入 resx，但我必须能够允许系统管理员更改文件的位置。我正在加载的只是键值对到 xml 中。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T13:29:25.333

您可以使用元组（使用 .Net Framework 4.0+ 时）。

```
class SettingsClass
{
    public Tuple<string, Dictionary<string, string>> TwoValuesProperty { get; set; }
} 
```

然后您可以通过以下方式使用它：

```
SettingsClass settings = new SettingsClass();

settings.TwoValuesProperty = new Tuple<string, Dictionary<string, string>>("URI", new Dictionary<string, string>()); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:13:11.273

你不能。但是您可以改为创建属性的集合类并设置每个属性的值。

# google-maps-android-api-2 - Google Maps API v2 中的绘制路径

> ID：14102030
> 
> 赞同：0
> 
> 时间：2012-12-31T13:09:20.457
> 
> 标签：google-maps-android-api-2

我想使用 Android Google Maps 的新 API v2 在 Google Maps 中绘制路径，但我不知道该怎么做。

此时，我正在使用 gps，并且对于每个提供程序更新，我都会在我的地图上获得一个标记，但我想绘制一条路径而不是标记。

提前致谢。

问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T20:16:19.580

查看 API 的这一部分。我还没有尝试过，但看起来你通过了一组 LatLng，它在点之间画了线。

[https://developers.google.com/maps/documentation/android/lines](https://developers.google.com/maps/documentation/android/lines)

# c++ - 列出 C++ 如何编辑特定元素

> ID：14102031
> 
> 赞同：0
> 
> 时间：2012-12-31T13:09:27.210
> 
> 标签：c++, list, pointers

我对列表有点困惑。见下文：

```
int ParticleSystemManager::CreateParticleSystem()
{
    ParticleSystem* system = new ParticleSystem(Vector3(), Vector3(), 10, 1);
    system->SetLifeTime(200);

    list<ParticleSystem>::iterator it = particleSystems.begin();

    particleSystems.insert(it, *system);

    selectedParticleSystem = system;

    return 0;
} 
```

我想要做的是让我刚刚创建的粒子系统将它添加到粒子系统列表中，但我也想将添加的粒子系统存储在指针中。我注意到，当遍历列表时，内存位置与 selectedParticleSystem 指针存储的位置不同。我怎样才能使它们相同？更新如下：

```
void ParticleSystemManager::Update(float elapsedTime)
{
    for (std::list<ParticleSystem>::iterator iterator = particleSystems.begin(), end = particleSystems.end(); iterator != end; ++iterator) 
    {
        iterator->Update(elapsedTime);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:11:53.593

> 我注意到，当遍历列表时，内存位置与 selectedParticleSystem 指针存储的位置不同。

那是因为`std::list::insert`创建了对象的**副本**。

您的选择是：

1.  改为创建 a `list`of 指针（尽管出于多种原因，您可能希望改用*智能指针*）。

2.  获取指向列表内对象的指针，并将其存储起来。就像是：

    ```
    selectedParticleSystem = &(*particleSystems.insert(it, *system)); 
    ```

    如果你这样做，你当然需要`delete`原始对象，否则你会有内存泄漏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:16:16.407

添加到 Oli 的答案：如果您使用 C++11，则可以使用[emplace](http://en.cppreference.com/w/cpp/container/list/emplace)代替，在列表中创建新的 ParticleSystem 直接：

```
particleSystems.emplace(particleSystems.begin(),Vector3(), Vector3(), 10, 1);
particleSystems.begin()->SetLifeTime(200);

selectedParticleSystem=particleSystems.begin(); 
```

# mysql - MYSQL，错误 150

> ID：14102035
> 
> 赞同：1
> 
> 时间：2012-12-31T13:09:52.960
> 
> 标签：mysql, foreign-keys, constraints

我有错误＃150。
我在不同的论坛上寻找，但他们只是说外键必须有相同的类型。

这是我的代码：

```
USE `dbask`;
set names utf8;

/*users*/
CREATE  TABLE IF NOT EXISTS `users` (
    `id`                INT NOT NULL AUTO_INCREMENT,
    `username`          VARCHAR(30) NOT NULL,
    `password`          VARCHAR(255) NOT NULL,
    `permission`        VARCHAR(10) NULL,
    `firstname`         VARCHAR(40) NULL,
    `lastname`          VARCHAR(40) NULL,
    `birthdate`         VARCHAR(255) NULL,
    `picture_link`      VARCHAR(255) NULL,
    PRIMARY KEY (`id`))
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

/*questions*/
CREATE  TABLE IF NOT EXISTS `questions` (
    `id`                INT NOT NULL AUTO_INCREMENT,
    `username`          VARCHAR(30) NOT NULL,
    `asked_username`    VARCHAR(30) NULL,
    `question`          VARCHAR(255) NOT NULL,
    `answer`            VARCHAR(255) NULL,
    `time_asked`        VARCHAR(255) NOT NULL,
    PRIMARY KEY (`id`),
    CONSTRAINT `fk_questions_to_users`
        FOREIGN KEY (`username`)
        REFERENCES `users`(`username`)
        ON DELETE CASCADE
        ON UPDATE CASCADE
     )
ENGINE = InnoDB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci; 
```

两种类型都是`VARCHAR(30)`，所以我不知道是什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:13:51.100

您必须在**用户表中创建****用户**名作为主**键**，然后您可以在**问题**表中创建**外键。**或者您可以使用**UNIQUE KEY**创建**FOREIGN KEY**，如下所示

 ********偏离 SQL 标准：**引用非唯一键的 FOREIGN KEY 约束不是标准 SQL。它是标准 SQL 的 InnoDB 扩展。

```
USE `dbask`;
SET NAMES utf8;

/*users*/
CREATE  TABLE IF NOT EXISTS `users` (
    `id`                INT NOT NULL AUTO_INCREMENT,
    `username`          VARCHAR(30) NOT NULL,
    `password`          VARCHAR(255) NOT NULL,
    `permission`        VARCHAR(10) NULL,
    `firstname`         VARCHAR(40) NULL,
    `lastname`          VARCHAR(40) NULL,
    `birthdate`         VARCHAR(255) NULL,
    `picture_link`      VARCHAR(255) NULL,
    PRIMARY KEY (`id`), UNIQUE KEY (username))
ENGINE = INNODB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci;

/*questions*/
CREATE  TABLE IF NOT EXISTS `questions` (
    `id`                INT NOT NULL AUTO_INCREMENT,
    `username`          VARCHAR(30) NOT NULL,
    `asked_username`    VARCHAR(30) NULL,
    `question`          VARCHAR(255) NOT NULL,
    `answer`            VARCHAR(255) NULL,
    `time_asked`        VARCHAR(255) NOT NULL,
    PRIMARY KEY (`id`),
    CONSTRAINT `fk_questions_to_users`
        FOREIGN KEY (`username`)
        REFERENCES `users`(`username`)
        ON DELETE CASCADE
        ON UPDATE CASCADE
     )
ENGINE = INNODB
DEFAULT CHARACTER SET = utf8
COLLATE = utf8_unicode_ci; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:18:35.143

[我的 SQL 文档](http://dev.mysql.com/doc/refman/5.0/en/innodb-foreign-key-constraints.html)

> 偏离 SQL 标准：引用非唯一键的 FOREIGN KEY 约束不是标准 SQL。它是标准 SQL 的 InnoDB 扩展。******

# c# - 如何在c#中将特定类型的列表转换为泛型类型的列表

> ID：14102039
> 
> 赞同：2
> 
> 时间：2012-12-31T13:10:35.887
> 
> 标签：c#, list, generics, casting

我有我想映射到列表的列表。但是，没有编译器错误，但在运行时结果为空。获得一个泛型`List<T>`将帮助我使我的代码具有通用性并重用于不同的对象。

```
private static List<T> GetIndexData(DataAdapter dataAdapter)
{
  Type type = typeof(T);
  List<T> result = new List<T>();

  if (typeof(Category).IsAssignableFrom(typeof(T)))
  {
    var output = ItemStoreDataManager.GetAllCategoryNames(dataAdapter);                
    result = output as List<T>;                    
  }
  return result;
} 
```

上面的代码**结果**为空。

```
internal static List<Category> GetAllCategoryNames(DataAdapter dataAdapter)
{
  List<Category> result = new List<Category>();

  ...........
  return result;
} 
```

请帮忙。

谢谢

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T13:20:08.190

错误在以下代码行中：

```
result = output as List<T>; 
```

C# 不会让您使用运算符强制`List<TSomething>`转换。由于 MSDN 中指定的原因，您看到了一个值...`List<TSomethingElse>`[`as`](http://msdn.microsoft.com/en-us/library/cscsdfbt.aspx)`null`

> as 运算符类似于强制转换操作。但是，如果无法进行转换，则 as 返回 null 而不是引发异常。
> 
> 请注意， as 运算符仅执行引用转换和装箱转换。as 运算符不能执行其他转换，例如用户定义的转换，而应使用强制转换表达式来执行。

`foreach`您的选择是使用循环逐项构建新列表，或者使用[`Enumerable.Cast`](http://msdn.microsoft.com/en-us/library/bb341406.aspx)(from `System.Linq`) 为您执行此操作：

```
output.Cast<T>().ToList(); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T13:20:57.997

如果您专注于类型，坦率地说泛型可能不是最佳选择。我想知道是否举个`Type`例子，并返回非泛型`IList`会更合适。但是：如果我们使用**类型相等**，您可以通过以下方式进行转换`object`：

```
if (typeof(Category) == typeof(T))
{
    var output = ItemStoreDataManager.GetAllCategoryNames(dataAdapter);
    result = (List<T>)(object)output;
} 
```

如果您对 . 很挑剔`IsAssignableFrom`，那就更难了；a`List<SuperCategory>` **不能**转换为 a `List<Category>`（或相反）。您可以创建一个**新**列表（请参阅 Richard Ev 的答案），也可以使用`IEnumerable<Category>`（*确实*支持方差）。

# performance - 加载Collection，为自己或普通sql保存每个产品

> ID：14102046
> 
> 赞同：1
> 
> 时间：2012-12-31T13:11:36.157
> 
> 标签：performance, magento

我写了一个扩展来计算产品销量——目标是获得畅销书。

我为所有产品创建了一个新的静态属性（意味着：我在 catalog_product_entity 表中添加了一个列）`items_sold`

我参与了`sales_order_save_before`活动

```
public function salesOrderSaveBefore(Varien_Event_Observer $observer)
{
    /* @var $order Mage_Sales_Model_Order */
    $order = $observer->getOrder();

    // if the order will be created and has no id yet
    if(!$order->getId()) {
        $productIds = array();
        foreach($order->getAllItems() as $item) {
            /* @var $item Mage_Sales_Model_Order_Item */
            $productIds[] = $item->getProductId();
        }
    }

    // what to do here :-)

} 
```

现在我看到了两种方法：

1.  我加载产品集合，遍历所有产品，提高 items_sold (+1) 并保存所有产品
2.  我发出一个像这样的查询`UPDATE catalog_product_entity SET items_sold = items_sold + 1 WHERE entity_id IN $productIds`

有什么建议么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:09:07.473

使用报告模型与 magento 一样，有几种方法可以实现这一点。一种方法可能是（这是 adminhtml 中使用的方法，它不考虑复杂的产品类型）：

```
$limit = 5;
$storeId = Mage::app()->getStore()->getId();
$bestSellers = Mage::getResourceModel('sales/report_bestsellers_collection')
    ->setModel('catalog/product')
    ->addStoreFilter($storeId)
    ->setPageSize($limit)
    ->setCurPage(1); 
```

根据您的问题，您可能正在寻找以下内容：

```
$limit = 5;
$storeId = Mage::app()->getStore()->getId();
$bestSellers = Mage::getResourceModel('reports/product_sold_collection')
    ->addOrderedQty()
    ->addAttributeToSelect('name')
    ->addStoreFilter($storeId)
    ->setOrder('ordered_qty', 'desc')
    ->setPageSize($limit)
    ->setCurPage(1); 
```

要应用块缓存（这将需要刷新块/html 标记），还将 更改为`cache_lifetime`您喜欢的图形：

```
protected function _construct()
{
    $this->addData(array (
        'cache_lifetime' => false,
        'cache_tags'     => array(Mage_Core_Model_Store::CACHE_TAG)
    ));
} 
```

您可以更进一步，为您的模块/畅销书添加[自定义缓存标签。](https://stackoverflow.com/questions/12663722/magento-custom-caching-with-admin-switch)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:43:23.017

您是否考虑过 Magento 报告系统？它是一个单独的索引过程，写入平面表。转到 /admin/report_sales/bestsellers/ 下的管理员

# django - 并行请求相同的会话 django

> ID：14102047
> 
> 赞同：0
> 
> 时间：2012-12-31T13:11:45.890
> 
> 标签：django

我正在建立一个网站，向用户发送随机物品。每个视图都将涉及更新许多变量，例如最后看到的内容以及下一个随机选择的类别。但是当我想到它时，我觉得这段代码只有在请求一个接一个发生的情况下才能工作，如果用户发出并行请求就会出现问题。我想知道这个问题是真实的还是 django 通过排队并行请求来处理它。如果这是真的，那么我正在考虑将新请求（第二个或第三个并行请求）重定向到“每个会话页面一个请求”。我知道用户发出并行请求并破坏逻辑的机会很小，但我仍然必须处理它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:41:17.267

做出这些决定不是 Django 的工作。这更多地与您将要使用的服务器技术有关（例如 nginx、gunicorn、postgresql 等）。

如果您按照 Web 应用程序的功能（即**无状态**）设计应用程序，则无需担心，所有与并发相关的内容都应该从您的“单一事实来源”透明地处理，在您的情况下应该是数据库。

如果您的 Web 应用程序的设计/逻辑不符合这些原则，则很可能存在缺陷，您需要重新设计它。

如果您真的认为您的应用程序是特殊情况，请给我们一些更具体的示例，或者更好的是，向我们展示一些代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:20:50.197

Django 应用程序可以对同一用户进行并行请求，因此您必须自己处理。好的原则是尽量避免在后端有状态。您可能会考虑是否可以重新设计前端来处理状态。然而，这并不总是可能的。

一种将状态保存在后端的方法是使用快速的内存数据库，如 Memcached、MongoDB 或 Redis。我相信如果使用正确，这些将允许原子操作。一种选择是使用暴露原子操作的[Django 缓存框架](https://docs.djangoproject.com/en/1.4/topics/cache/)（至少在由 memcached 支持时）。

# javascript - 使用 Javascript 进行 HtmlEditorExtender 的 Google 翻译不起作用

> ID：14102054
> 
> 赞同：1
> 
> 时间：2012-12-31T13:12:31.990
> 
> 标签：javascript, asp.net, ajax, google-translate

我已经使用带有 ajaxtoolkit HtmlEditorExtender(Rich textbox) 的文本框使用谷歌翻译 Javascript 将英语翻译成古吉拉特语。它仅适用于文本框，但当我使用 HtmlEditorExtender(Rich textbox) 时它不起作用。

下面是我使用的 Javascript。

```
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript">
        google.load("elements", "1", {
            packages: "transliteration"
        });
        function onLoad() {
            var options = {
                sourceLanguage:
                google.elements.transliteration.LanguageCode.ENGLISH,
                destinationLanguage:
                google.elements.transliteration.LanguageCode.GUJARATI,

                shortcutKey: 'ctrl+g',
                transliterationEnabled: true
            };
            var control =
            new google.elements.transliteration.TransliterationControl(options);
            control.makeTransliteratable(['<%=TextBox1.ClientID%>']);
        }
        google.setOnLoadCallback(onLoad);

        var finalString = "";
        function Changed(textControl) {

            var _txtUnicodeName = document.getElementById('<%=TextBox1.ClientID%>');

            var _EnteredString = _txtUnicodeName.value;
        }
    </script>

    <asp:UpdatePanel ID="Activistupdatepanel" runat="server">
                    <ContentTemplate>
                        <div>
                            <asp:Button ID="Button1" runat="server" Text="Button" onclick="Button1_Click" />
                            <asp:TextBox ID="TextBox1" runat="server"></asp:TextBox>
                    <ajaxtoolkit:HtmlEditorExtender ID="htmlEditorExtender1" TargetControlID="TextBox1"
                        runat="server" EnableSanitization="False" Enabled="True">
                    </ajaxtoolkit:HtmlEditorExtender>
                        </div>
                    </ContentTemplate>
                </asp:UpdatePanel> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:48:01.303

它不起作用，因为您不应该使用隐藏的 TextBox。相反，您应该使用`HtmlEditorExtender`'s editor div。试试这个：

```
 function onLoad() {
        document.getElementById('<%=htmlEditorExtender1.ClientID%>_ExtenderContentEditable').setAttribute("contentEditable", "true"); //*** added this
        var options = {
            sourceLanguage:
            google.elements.transliteration.LanguageCode.ENGLISH,
            destinationLanguage:
            google.elements.transliteration.LanguageCode.GUJARATI,

            shortcutKey: 'ctrl+g',
            transliterationEnabled: true
        };
        var control =
        new google.elements.transliteration.TransliterationControl(options);
        control.makeTransliteratable(['<%=htmlEditorExtender1.ClientID%>_ExtenderContentEditable']); //**** changed this
    }
    google.setOnLoadCallback(onLoad); 
```

基本上，我只是将 TextBox 更改为`HtmlEditorExtender`的编辑器 div，即`<%=htmlEditorExtender1.ClientID%>_ExtenderContentEditable`

根据[官方文档](https://developers.google.com/transliterate/v1/reference)使用 div 你需要`contentEditable=true`属性。下面的第一行`onLoad()`将该自定义属性添加到 div。

```
.makeTransliteratable(elementIds, opt_options) 在提供的 HTML 元素上启用音译。此方法的参数是：

elementIds 是一个数组，其中包含您希望启用音译的可编辑元素 ID 或元素引用字符串。可编辑元素可以是：
一个文本字段
一个文本区域
** contentEditable="true" 的 div **
带有 designMode="on" 的 iframe
具有 contentEditable="true" 正文的 iFrame。确保在启用音译之前加载 iFrame。
```

**这对我有用。**如果您在完成这项工作时遇到困难，请告诉我。

# design-patterns - 具有派生算法在上下文中调用方法的策略模式

> ID：14102055
> 
> 赞同：3
> 
> 时间：2012-12-31T13:12:44.703
> 
> 标签：design-patterns, strategy-pattern

我需要一些设计帮助。我有一个类，我们称它为可以实现多种行为的宇宙飞船。我已经定义了一个接口来声明每个行为支持的操作。到目前为止，这是经典的策略模式。

但是，实现的策略需要能够调用上下文类的动作和方法。我一直在考虑将上下文作为接口本身传递给封装的算法。

这是最好的方法吗？如果没有，你会推荐什么？

![在此处输入图像描述](../Images/a452fafe3a7a253149a9cfeaac995026.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-01T06:36:10.097

你打算做的事情对我来说似乎很好。要考虑的一件事是不要过多地传递给行为类的方法。例如，如果你的飞船有一个`engine behaviour`，只传递你的`fuel tank`and `drive unit`，而不是整个宇宙飞船。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:29:51.163

根据您的策略需要上下文的内容，您可以考虑使用观察者模式使其基于事件，这样您的策略就不会与上下文耦合。

例如，如果您的策略导致上下文中的某些内容发生变化，这些可能是某些中介（或您的上下文本身）订阅的事件。

# c# - Silverlight 应用程序中的 RIA 服务代码生成

> ID：14102056
> 
> 赞同：2
> 
> 时间：2012-12-31T13:12:49.740
> 
> 标签：c#, silverlight, ria, domainservices

有什么方法可以避免为使用多个域时已经引用的类型生成代码？

让我解释。

* * *

我有一个用于 silverlight 应用程序的应用程序基础设施。这个基础设施包包括服务器端的 3 个 (RIA) 域服务（身份验证、日志记录、服务发现） - **Infra.Web.dll**和一个 Silverlight DLL - **ClientInfra.dll**，它在应用程序启动时实现用户身份验证和一些其他基类（像 BaseApp 和 BaseView），而**Infra.Web.dll**被定义为**ClientInfra.dll**的 WCF RIA 服务链接。

现在我正在开发一些演示 silverlight 应用程序来测试我的基础设施。我创建了

**DemoApp.Web**至极 **引用 Infra.Web.dll**（为了获得基础设施服务）

和2个silverlight项目：

**DemoApp.Data**将 **DemoApp.Web.dll**定义为 WCF RIA Services Link 以获取生成的代码并引用**ClientInfra.dll**

**DemoApp**是引用**ClientInfra.dll的实际 silverlight 应用程序**

问题是，当我尝试使用 silverlight 应用程序中的 RIA 服务之一时，我遇到了一个错误，即域服务类是在**ClientInfra.dll**和 **DemoApp.Data**中定义的。据我了解，问题是来自**Infra.Web.dll**的代码已生成两次：第一次为**ClientInfra.dll**，第二次为**DemoApp.Data**。

有什么方法可以避免为已经被引用的类型生成代码，就像我的情况一样， **ClientInfra.dll**已经生成了基础设施服务，因此不需要在**DemoApp.Data**中再次生成它？

我会尽量让我的问题更简单。如何避免已经为我引用的 dll 生成的类型的 ria 服务类型生成（在 silverlight 中）？类型生成重复导致错误 CS0433 在 2 个不同的 dll 中定义了相同的类型

我发现了一些有趣的事实。如果我 直接从**DemoApp （silverlight 应用程序项目）引用****ClientInfra.dll ，那么在****ClientInfra.dll**中已经生成的数据类型不会再次生成。但是，如果我 从**DemoApp.Data引用****ClientInfra.dll** ，我确实会生成重复类型代码，并带有编译警告，即在引用的 dll 和生成的代码中都定义了相同的类型。

 ******* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-07T08:30:35.337

我在 msdn 文档中找到了以下内容

> 分析中间层项目为域服务类、实体类或共享代码构建或引用的所有程序集。
> 
> RIA 服务在生成代理类之前检查现有成员。任何已定义的成员都不会在代理类中生成。

这意味着我的场景应该像我预期的那样工作！

为了检查代码生成过程，我将 MSBuild 项目设置为构建*输出详细程度*（工具->选项->项目和解决方案->构建和运行）为正常（而不是默认的最小）。然后在编译后我发现**DemoApp.Data**项目无法加载包含已生成代理的**ClientInfra.dll 。**所以生成器只是忽略它并从头生成所有类。

我已经解决了这个加载问题，现在一切正常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-05T19:52:14.050

我有类似的基础架构，但我使用 SOAP 公开了 DomainServices 并在其他应用程序中使用这些服务，所以，我应该对你的项目做同样的事情。******

# javascript - 如何创建自定义 JSON 数据结构？

> ID：14102059
> 
> 赞同：0
> 
> 时间：2012-12-31T13:13:02.660
> 
> 标签：javascript, json, logic

包含 100 个对象的 JSON 数据结构的输出应如下所示：

```
[{
    "Value": "Sens1_001",
    "Parent": Null,
    "Child": {
        "Value": "Sens2_068",
        "Parent":"Sens1_001",
        "Child" : {
            "Value": "Sens3_034",
            "Parent": "Sen2_068",
            "Child": null,
            "z_cordinate": 5
                  },
        "z_cordinate": 0
            },
        "z_cordonate": -5
    },
{
    "Value": "Sens1_002",
    "Parent": Null,
    "Child": {
        "Value": "Sens2_037",
        "Parent":"Sens1_002",
        "Child" : {
            "Value": "Sens3_099",
                              "Parent": "Sen2_037",
                              "Child": null,
                              "z_cordinate": 5
                   },
             "z_cordinate": 0
             },
  "z_cordonate": -5
},
{
   "Value": "Sens1_003",
    "Parent": Null,
    "Child": {
        "Value": "Sens2_012",
        "Parent":"Sens1_003",
        "Child" : {
            "Value": "Sens3_054",
            "Parent": "Sen2_012",
            "Child": null,
            "z_cordinate": 5
                  },
        "z_cordinate": 0
             },   
        "z_cordonate": -5
},
.
.
. // till 100th object
{
    "Value": "Sens1_100",
    "Parent": Null,
    "Child": {
        "Value": "Sens2_001",
        "Parent":"Sens1_100",
        "Child" : {
            "Value": "Sens3_021",
            "Parent": "Sen2_001",
            "Child": null,
            "z_cordinate": 5
                  },
    "z_cordinate": 0
             },
    "z_cordonate": -5
}] 
```

**注意：**我编辑了示例对象，请再查看一次，我将端括号更改为看起来更像一个数组而不是普通对象。JSON 是次要的，我的数组应该服务于我的目的。

**目的：**

我怎样才能访问对象 X.parent.child 时尚。我有一些知识，但不足以构建这个对象。我还计划以两种方式访问​​对象，Grapndparent - Parent - Child 和 Me - Parent - Grandparent。我怎么能那样做？对象的父子关系应该是有意义的，而且是随机的，而且父母可以有多个孩子。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T13:31:25.550

由于所有“值”键都是唯一的，因此您可以将其作为字典键。所以设计它像：

```
{
 "Sens1_001": {
               "value": "Sens1_001",
               "parent": null,
               "child": "Sen2_068",
               "z_coordinate": 5
              },
 "Sens2_068": {
               "value": "Sens2_068",
               "parent": "Sens1_001",
               "child": "Sen3_098",
               "z_coordinate": -5
              }
 .
 .
 .
} 
```

一旦这个字典'dict'准备好了，如果你知道祖父母的价值，那么：

```
grandparent = dict[value];
parent = dict[grandparent[child]];
child = dict[parent[child]]; 
```

同样，如果你知道孩子的价值，

```
child = dict[value];
parent = dict[child[parent]];
grandparent = dict[parent[parent]]; 
```

如果你还不明白，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:00:19.513

由于 json 本身就是一个 javascript 数组，因此您可以像访问数组一样访问 json 对象；

```
<script>
  var json = [
        {'SMAK' : 1, 'parent': 'i m perent 1', 'child' : 'i m child'}, 
        {'SMAK' : 2, 'parent': 'i m perent 2', 'child' : 'i m child'}, 
        {'SMAK' : 3, 'parent': 'i m perent 3', 'child' : 'i m child'}, 
        {'SMAK' : 4, 'parent': 'i m perent 4', 'child' : 'i m child'}        
      ]
  console.log(json[0]);
  console.log(json[1].parent);
  console.log(json[3]['child']);
</script> 
```

因此，如果您知道索引，则可以访问该对象的任何属性；

# javascript - 使用 Wordpress 主题，在 JavaScript 中找不到点击事件

> ID：14102060
> 
> 赞同：1
> 
> 时间：2012-12-31T13:13:04.240
> 
> 标签：javascript, javascript-events

我正在为摄影网站使用 Wordpress 主题，主题中的一些 javascript 正在禁用我正在尝试创建的链接。

[http://www.joesingh.samcampsall.co.uk/login/](http://www.joesingh.samcampsall.co.uk/login/)

最初，此页面上的图像会在灯箱中弹出（我认为这就是链接被禁用的原因），但我制作了一个模板，允许图像链接到另一个页面。标签中的链接是正确的，但是单击时没有任何反应。

使用 Chrome，我可以看到包含 div（'one_third'，'gallery3'）的类上有一个“click”事件侦听器，这在 [http://www.joesingh.samcampsall.co.uk/wp-includes /js/jquery/jquery.js?ver=1.8.3](http://www.joesingh.samcampsall.co.uk/wp-includes/js/jquery/jquery.js?ver=1.8.3)

不幸的是，我是一个新手，大量的搜索和阅读并没有让我确定我需要进行哪些更改。任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:07:26.847

如果您可以访问代码并且您是新手，则可以通过执行以下代码来取消绑定单击事件。这将使您的链接以正常方式运行。只需将以下内容放在您的其他 js 文件之后。

```
jQuery('.one_third').unbind('click'); 
```

您可能需要在课堂上玩耍，以确保获得正确的课程。

祝你好运

# iphone - 朋友不会被邀请参加在 Facebook 中创建的活动

> ID：14102067
> 
> 赞同：0
> 
> 时间：2012-12-31T13:13:44.127
> 
> 标签：iphone, objective-c, ios, facebook, events

我正在创建一个在 facebook 中创建事件的应用程序。我已经通过我的应用程序在 facebook 中成功创建了活动，但我无法邀请朋友参加。这就是我所做的。

为了创建事件，我使用了以下代码。

```
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                   @"Birthday Party",@"name",
                                   @"Hotel Taj",@"location",
                                   @"2013-02-02T20:00:00+0530",@"start_time",
                                   @"2013-04-02T20:00:00+0530",@"end_time", nil];

    [facebook requestWithGraphPath:@"me/events"
                         andParams:params
                     andHttpMethod:@"POST"
                       andDelegate:self]; 
```

在此之后，我将事件 ID 作为响应，并使用以下代码邀请朋友参加该事件。

```
NSString *graphPath = [NSString stringWithFormat:@"%@/invited?users=%@",event,[@[@"friend1",@"friend2"] componentsJoinedByString:@","]];
[facebook requestWithGraphPath:graphPath andDelegate:self]; 
```

在此之后，我收到如下回复。

str = {"data":[{"name":"Testtesttest Testtest","id":"100003064304910","rsvp_status":"attending"}],"paging":{"next":"https:// graph.facebook.com/191592177650963/invited?users\u00255B0\u00255D=friend1&users\u00255B1\u00255D=friend2&format=json&access_token=AAADicrEWZCQsBALS5ESFGlzrmQIFgY8nqAibPDOl6830qrPW4zZANeaMVFGslefLQfGLvZCSKrNt61vcKYkeZA2ubCRZADJhwStZCUfEXdPgZDZD&limit=5000&offset=5000&__after_id=100003064304910" }}

朋友没有被邀请。

但是，当我在 Graph API Explorer 中进行测试时，它返回“true”并邀请朋友。请帮我解决我的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T03:56:18.737

创建事件后，从您收到的响应中，您只需将参数发送到带有事件 id 的事件，我们选择的用户（即 uids）就会收到您创建的事件的邀请。

```
-(void)request:(FBRequest *)request didLoadRawResponse:(NSData *)data
{

NSDictionary *results = [NSJSONSerialization JSONObjectWithData:data options:kNilOptions error:nil];
eventAddress = [results objectForKey:@"id"];
NSString *formattedAddress = [results objectForKey:@"id"];
NSMutableDictionary *params = [NSMutableDictionary dictionaryWithObjectsAndKeys:
                                formattedAddress,@"eid",
                                @"events.invite",@"method",
                            @"uid1,uid2",@"uids",
                                nil];
[facebook requestWithParams:params andDelegate:self];
} 
```

# ant - 无法使用 ant 定位 org.openqa.selenium 类来运行 webdriver 脚本

> ID：14102070
> 
> 赞同：0
> 
> 时间：2012-12-31T13:14:02.270
> 
> 标签：ant, classpath, selenium-webdriver

我正在使用 Apache ANT 来运行我的 webdriver 脚本。我的项目结构如下：

```
ant_webdriver_project
 - src
   - test.ant.webdriver
     - TestLogin.java
 - JRE System Libraries
 - Referenced Libraries
    - all jars including selenium-java-2.25.0.jar, selenium-java-2.25.0-srcs.jar
 - build
 - lib
    - all jars including selenium-java-2.25.0.jar, selenium-java-2.25.0-srcs.jar
 - resources
    - myproperties.properties
 - build.xml 
```

我的 build.xml 文件是：

```
<project basedir=".">

<property name="lib.dir" value="lib"/>

<path id="classpath">
    <fileset dir="${lib.dir}" includes="**/*.jar"/>
</path>

 <target name="clean">
     <delete dir="build"/>
 </target>

 <target name="compile">
     <mkdir dir="build"/>
     <javac srcdir="src" destdir="build"/>
</target>

<target name="jar">
    <mkdir dir="build/jar"/>
    <jar destfile="build/jar/testlogin.jar" basedir="build">
         <manifest>
           <attribute name="Main-Class" value="test.ant.webdriver.TestLogin"/>
         </manifest>
    </jar>
</target>

<target name="run" depends="jar">
    <java fork="true">
    <classpath>
        <path refid="classpath"/>
        <path location="build/jar/testlogin.jar"/>
    </classpath>
    </java>

</target> 
```

现在，当我进行 ant 编译时，我得到了这个：

> [javac] 将 1 个源文件编译到 /home/abhijeet/Automation_Dev/automation_workspace/ant_webdriver_project/build [javac] /home/abhijeet/Automation_Dev/automation_workspace/ant_webdriver_project/src/test/ant/webdriver/TestLogin.java:11：包 org .openqa.selenium 不存在 [javac] import org.openqa.selenium.By; [javac] ^ [javac] /home/abhijeet/Automation_Dev/automation_workspace/ant_webdriver_project/src/test/ant/webdriver/TestLogin.java:12: 包 org.openqa.selenium 不存在 [javac] 导入 o​​rg.openqa.selenium .NoSuchElementException; [javac] ^ [javac] /home/abhijeet/Automation_Dev/automation_workspace/ant_webdriver_project/src/test/ant/webdriver/TestLogin.java:13: 包 org.openqa.selenium 不存在 [javac] 导入 o​​rg. openqa.selenium.WebDriver; . . .
> 
> 构建失败/home/abhijeet/Automation_Dev/automation_workspace/ant_webdriver/build.xml:18：编译失败；有关详细信息，请参阅编译器错误输出。

这些错误与我在课堂上使用的所有 webdriver 对象有关。我认为我构建 build.xml 的方式肯定存在问题，但我查看了许多来源但找不到任何解决方案。我对 ANT 完全陌生。有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T22:11:56.893

自从我使用 ant 很久以来，但在你的`compile`目标中，你没有`classpathref`：

```
<target name="compile">
     <mkdir dir="build"/>
     <javac srcdir="src" destdir="build" classpathref="classpath" />
</target> 
```

# mysql - mySQL 分区

> ID：14102073
> 
> 赞同：0
> 
> 时间：2012-12-31T13:14:43.987
> 
> 标签：mysql, performance, partitioning

我安装了 osCommerce，网站上有 140k 产品，product_description 表大小约为**300MB**。页面加载需要 15 秒到**20 秒**，为了测试目的，我将表格削减到 100MB，现在它似乎正常工作。

所以我决定使用 mySQL 分区并制作

```
PARTITION BY KEY()
PARTITIONS 10; 
```

在此更改之后，我对其进行了测试，但没有任何更改。

现在我决定将数据库表拆分为 3 个或更多，名称如下

```
 product_description1
 product_description2
 product_description3
 ...
 ... 
```

我做错了吗？为什么 mySQL 分区不影响性能或速度？请提出建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:45:58.960

如果您没有有用的线索，请不要机械地应用分区。首先做通常的事情：索引调整。

您从分区中获得的收益完全取决于查询模式。我怀疑您的查询不会从中受益。但他们肯定会从正确的索引中受益。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-01T10:09:41.170

除非你对你的分区模式非常有意识和聪明，否则你会通过引入分区来*损害*性能，而不是帮助它。

尝试提高性能时，您需要做的第一件事是分析您的查询。通过这样做，您可能会发现通过一些索引调整和/或一些服务器配置调整可以获得所需的性能提升。

300mb 不是一个很大的表。但根据您的查询，它可能会将大量表吞入内存。如果您的 MySQL 内存参数没有正确调整，您可能会过早地交换到磁盘，从而使您的查询非常慢。

# objective-c - 自定义uiview下的阴影

> ID：14102076
> 
> 赞同：1
> 
> 时间：2012-12-31T13:15:03.363
> 
> 标签：objective-c, ios, core-graphics

我正在尝试在自定义视图下添加阴影，我有以下代码：

```
CGContextSaveGState(context);
CGContextSetShadow(context, CGSizeMake(0, 2), 3.0);
CGRect shadowRect = CGRectMake(self.bounds.origin.x,
                               self.bounds.origin.y + self.bounds.size.height,
                               self.bounds.size.width,
                               3.0);
CGContextFillRect(context, shadowRect);
CGContextRestoreGState(context); 
```

但影子是看不见的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:31:34.427

试试这个：

```
 UIColor *color = [UIColor grayColor];
    CGColorRef gray = color.CGColor;
    self.layer.shadowColor = gray;
    self.layer.shadowOffset = CGSizeMake(0, 0);
    self.layer.shadowRadius = 2;
    self.layer.shadowOpacity = 1;
    self.layer.borderColor = red;
    self.layer.shadowPath = [UIBezierPath bezierPathWithRect:self.bounds].CGPath;
    self.layer.masksToBounds = NO; 
```

# android - OnTouchEvent getPointerCount() 在释放屏幕触摸后始终检测到 1 个指针

> ID：14102079
> 
> 赞同：1
> 
> 时间：2012-12-31T13:15:21.657
> 
> 标签：android, touch-event

我只是想让这个功能工作，但我遇到了麻烦。当我启动应用程序时，getPointerCount 返回 0 指针，当我用一根手指触摸屏幕时，1。（如果我用几根手指触摸屏幕，它会识别 2,3 4... 手指）。然而，释放屏幕后，它总是返回 1，如果我再次用超过一根手指触摸，它会返回正确数量的指针。

这是我的简单代码：

```
 public boolean onTouchEvent(MotionEvent event) {
        int count=event.getPointerCount();

        tv.setText(String.valueOf(count));

        return true;
    } 
```

为什么释放屏幕后不返回0？

谢谢你们

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:23:54.127

请在询问之前阅读文档。

[getPointerCount() 总是返回等于或大于 1 的 int](http://developer.android.com/reference/android/view/MotionEvent.html#getPointerCount%28%29)

# java - 为什么指定 BigDecimal.equals 来分别比较值和比例？

> ID：14102083
> 
> 赞同：44
> 
> 时间：2012-12-31T13:16:13.113
> 
> 标签：java, bigdecimal

这不是关于如何比较两个`BigDecimal`对象的问题 - 我知道您可以使用`compareTo`而不是`equals`这样做，因为`equals`记录为：

> 与 compareTo 不同，此方法仅当两个 BigDecimal 对象的值和比例相等时才认为它们相等（因此，通过此方法进行比较时，2.0 不等于 2.00）。

问题是：为什么`equals`以这种看似违反直觉的方式来指定？也就是说，为什么能够区分 2.0 和 2.00很**重要？**

这似乎一定是有原因的，因为`Comparable`指定`compareTo`方法的文档指出：

> 强烈建议（尽管不是必需的）自然排序与 equals 一致

我想一定有充分的理由忽略这个建议。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-31T13:20:33.807

因为在某些情况下，精度指示（即误差范围）可能很重要。

例如，如果您要存储由两个物理传感器进行的测量，那么一个传感器的精度可能是另一个传感器的 10 倍。代表这一事实可能很重要。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2021-02-12T23:49:28.103

的一般规则`equals`是两个相等的值应该可以相互替代。也就是说，如果使用一个值执行计算会产生一些结果，那么将一个`equals`值代入相同的计算应该会得到`equals`与第一个结果相同的结果。这适用于作为值的对象，例如`String`、`Integer`、`BigDecimal`等。

现在考虑`BigDecimal`值 2.0 和 2.00。我们知道它们在数值`compareTo`上相等，并且它们返回 0。但`equals`返回 false。为什么？

这是它们*不可替代*的示例：

```
var a = new BigDecimal("2.0");
var b = new BigDecimal("2.00");
var three = new BigDecimal(3);

a.divide(three, RoundingMode.HALF_UP)
==> 0.7

b.divide(three, RoundingMode.HALF_UP)
==> 0.67 
```

结果显然不相等，因此 的值`a`不能替代`b`。所以，`a.equals(b)`应该是假的。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-07-25T23:25:37.967

在任何其他答案中尚未考虑的一点是，`equals`它需要与 一致`hashCode`，并且实现的成本`hashCode`需要为 123.0 和 123.00 产生相同的值（但仍然可以合理地完成区分不同的值）将比不需要这样做的 hashCode 实现大得多。在目前的语义下，`hashCode`需要对每 32 位存储的值进行乘以 31 和相加。如果`hashCode`需要在具有不同精度的值之间保持一致，它要么必须计算任何值的归一化形式（昂贵），要么至少做一些类似计算值的 base-999999999 数字根并将其相乘，mod 999999999，基于精度。这种方法的内部循环是：

```
temp = (temp + (mag[i] & LONG_MASK) * scale_factor[i]) % 999999999; 
```

用 64 位模数运算代替乘以 31 的运算要贵得多。如果想要一个将数值等价的`BigDecimal`值视为等价的哈希表，并且可以找到在表中查找的大多数键，那么实现所需结果的有效方法是使用存储值包装器的哈希表，而不是直接存储值。要在表中查找值，首先要查找值本身。如果没有找到，则规范化该值并查找它。如果没有找到，创建一个空包装器并在数字的原始和规范化形式下存储一个条目。

查找不在表中且之前未搜索过的内容将需要昂贵的标准化步骤，但查找已搜索过的内容会快得多。相比之下，如果 HashCode 需要为由于精度不同而以完全不同的方式存储的数字返回等效值，这将使所有哈希表操作变得更慢。

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2012-12-31T13:21:14.503

在数学中，10.0 等于 10.00。在物理学中，10.0m 和 10.00m 可以说是不同的（不同的精度），当谈论 OOP 中的对象时，我肯定会说它们不相等。

如果 equals 忽略了比例，也很容易想到意想不到的功能（例如：如果 a.equals(b)，你不会期望 a.add(0.1).equals(b.add(0.1) 吗？）。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2012-12-31T13:22:45.830

如果数字四舍五入，它会显示计算的精度 - 换句话说：

*   10.0 可能意味着确切的数字在 9.95 和 10.05 之间
*   10.00 可能意味着确切的数字在 9.995 和 10.005 之间

换句话说，它与[算术精度](http://en.wikipedia.org/wiki/Arithmetic_precision)有关。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-21T20:20:20.017

该`compareTo`方法知道尾随零不会影响由 a 表示的数值`BigDecimal`，这是唯一`compareTo`关心的方面。相比之下，该`equals`方法通常无法知道某人关心对象的哪些方面，因此只有`true`当两个对象在程序员可能感兴趣的*所有*`x.equals(y)`方面都等效时才应该返回。如果是真的，那将是相当令人惊讶的为`x.toString().equals(y.toString())`产生错误。

另一个可能更重要的问题是它`BigDecimal`本质上结合了 a`BigInteger`和一个比例因子，这样如果两个数字代表相同的值但具有不同数量的尾随零，则一个将持有一个`bigInteger`其值是另一个的十倍的幂。如果相等性要求尾数和小数位数都匹配，则`hashCode()`for`BigDecimal`可以使用 的哈希码`BigInteger`。但是，如果两个值可能被认为是“相等的”，即使它们包含不同的`BigInteger`值，那会使事情变得非常复杂。`BigDecimal`使用自己的后备存储的类型，而不是`BigInteger`, 可以通过多种方式实现，以允许数字被快速散列，使得表示相同数字的值比较相等（作为一个简单的例子，一个在每个`long`值中包含九个十进制数字的版本，并且总是要求小数点位于九个组之间，可以以忽略值为零的尾随组的方式计算哈希码）但是`BigDecimal`封装 a`BigInteger`不能这样做。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2014-07-11T08:24:41.043

> 我想一定有充分的理由忽略这个建议。

也许不吧。我提出了一个简单的解释，即设计师`BigDecimal`刚刚做出了错误的设计选择。

1.  一个好的设计会针对常见的用例进行优化。大多数情况下（>95%），人们希望基于数学等式比较两个量。在少数情况下，您确实关心这两个数字在规模和价值上是否相等，为此目的可能还有另一种方法。
2.  它违背了人们的期望，并造成了一个很容易陷入的陷阱。一个好的 API 遵循“最小意外原则”。
3.  `Comparable`它打破了与相等性一致的通常的 Java 约定。

有趣的是，Scala 的`BigDecimal`类（在底层使用 Java 实现`BigDecimal`）做出了相反的选择：

```
BigDecimal("2.0") == BigDecimal("2.00")     // true 
```

# c# - 每个循环的 HTMLAgilityPack 新选择

> ID：14102098
> 
> 赞同：1
> 
> 时间：2012-12-31T13:17:50.870
> 
> 标签：c#, .net, vb.net, html-parsing, html-agility-pack

我有这个 html 代码

```
<div class="featuredTorrent">
                    <ul>
                        <li>
                            <div class="torrentName">
                                <a href="/sub/2/0/" class="Movies" title="Movies > Divx/Xvid"></a>
                                <span class="nameComment">2</span>                                    <h3 class="org"><a href="/torrent/394358/Batman-Dark-Knight-Returns-2012-Part-1-DVDRip-Xvid-AC3-Legend-Rg/" class="org">Batman.Dark.Knight.Returns.2012.Part.1.DVDRip.Xvid.AC3.Legend-Rg</a></h3>
                                <div class="clr"></div>
                            </div>
                            <span class="seed">1541</span>
                            <span class="leech">139</span>
                            <span class="size">803.67 MB</span>
                            <div class="user"><h4 class="vip"><a href="/user/scene4all/">scene4all</a> <sup title="Reputation Points">*5061</sup></h4></div>
                            <div class="clr"></div>
                        </li>
                        <li class="odd">
                            <div class="torrentName">
                                <a href="/sub/2/0/" class="Movies" title="Movies > Divx/Xvid"></a>
                                <h3 class="org"><a href="/torrent/394330/Batman-The-Dark-Knight-Returns-Part-1-2012-FRENCH-DVDRip-XviD-SLaP/" class="org">Batman.The.Dark.Knight.Returns.Part 1.2012.FRENCH.DVDRip.XviD-SLaP </a></h3>
                                <div class="clr"></div>
                            </div>
                            <span class="seed">1257</span>
                            <span class="leech">94</span>
                            <span class="size">699.04 MB</span>
                            <div class="user"><h4 class="uploader"><a href="/user/maximersk/">maximersk</a> <sup title="Reputation Points">*5003</sup></h4></div>
                            <div class="clr"></div>
                        </li> 
```

我想用类种子、水蛭和大小检索“h3 class=org”和跨度。

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    url = "http://1337x.org/search/2012/0/"
    document = webGet.Load(url)
    Dim a, b As HtmlAgilityPack.HtmlNodeCollection
    Dim s As HtmlAgilityPack.HtmlNode
    Dim name, dUrl, seed, peer, size As String
    a = document.DocumentNode.SelectNodes("//div[@class='torrentName']/h3[@class='org']")
    For Each div As HtmlAgilityPack.HtmlNode In a
        name = div.InnerText

    Next
    b = document.DocumentNode.SelectNodes("//div[@class='featuredTorrent']/ul/li")
    For Each div As HtmlAgilityPack.HtmlNode In b
        s = div.SelectSingleNode(".//span[@class='seed']")
        TextBox1.Text = TextBox1.Text & s.InnerText & vbCrLf

    Next 
End Sub 
```

我可以得到“h3”，但是跨度它给了我一个错误..我在敏捷包上找不到任何文档，也许我做错了方法..

如何在 for each 循环中选择所有需要类的跨度（应该已经在“li”节点中）？

提前致谢

# javascript - Ajax 发布后更新事件

> ID：14102099
> 
> 赞同：3
> 
> 时间：2012-12-31T13:17:52.683
> 
> 标签：javascript, fullcalendar, dom-events

我正在尝试在 ajax 发布后更新事件以更改事件的标题并给它一个类，以便我可以更改它的颜色。我还想知道来自我的 JSON 源的事件是否被批准，如果是，改变它的颜色。我在下面评论了我的代码：

更新代码：

```
$(document).ready(function () {

var liveDate = new Date();
var date = new Date();
var d = date.getDate();
var m = date.getMonth();
var y = date.getFullYear();

var calendar = $('#calendar').fullCalendar({
    disableDragging: true,
    header: {
        left: 'prev,next today',
        center: 'title',
        right: 'year'
    },

    eventClick: function (calEvent, jsEvent, view, eventid) {

        var eventid = calEvent.id;
        var start = calEvent.start;
        var end = calEvent.end;
        var fullname = calEvent.fullname;

        var fancyContent = ('<div class="header">approve booking for ' + eventid + calEvent.title + '<a href="#" class="approve" id="' + eventid + '">yes</a><a href="#" class="approve">no</a></div>');
        $.fancybox({
            content: fancyContent
        });

        var getid = $('.approve').attr('id');

        // approve function

        $('.approve').click(function (calEvent, jsEvent, view, getid) {
            var getid = $('.approve').attr('id');

            if ($(this).html() == "yes") {

                // AJAX post to insert into DB 

                $.post("ajax.php", {
                    action: 'approve',
                    eventid: getid,
                    color: 'green'
                },

                function (data) {
                    var fancyContent = ('<div class="header"><p>' + data.msge + '</p></div>');
                    $.fancybox({
                        content: fancyContent
                    });
                }, "json");

              // attemping to add class to event to change color, this does not work

                $('#calendar').fullCalendar('clientEvents', calEvent).addClass('fc-event-updated');

              // trying to get id from last updated event so I can change it but this also does not work

                var eventObject = $('#calendar').fullCalendar('clientEvents', eventid);

                if (eventObject != null) {
                    eventObject.title = fullname + ' approved';
                    eventObject.color = 'green';

                    $('#calendar').fullCalendar('updateEvent', eventObject);
                }

            } else {
                // close fancybox

                $.fancybox.close();

            } // end of  if

        }); // end of approve click

    },

    selectable: true,
    selectHelper: true,
    select: function (start, end, allDay, approved, title) {

        // disable booking dates in the past

        if (liveDate > start) {
            var fancyContent = ('<div class="header">Canot book dates in the past</div>');
            $.fancybox({
                content: fancyContent
            });

            return false;

        } else {

            // get user to confirm selection

            var fancyContent = ('<div class="header">Book the following days off</div>Start Time: </b></label>' + $.fullCalendar.formatDate(start, "yyyy-MM-dd") + '<br>' + '<label><b>End Time: </b></label>' + $.fullCalendar.formatDate(end, "yyyy-MM-dd") + '<br>' + '<label><a href="#" class="button">yes</a><a class="button" href="#">no</a></div>');
            $.fancybox({
                content: fancyContent
            });

            $('.button').click(function () {

                if ($(this).html() == "yes") {

                    // ajax to insert into DB 

                    $.post("ajax.php", {
                        start: $.fullCalendar.formatDate(start, "yyyy-MM-dd"),
                        end: $.fullCalendar.formatDate(end, "yyyy-MM-dd"),
                        action: 'add',
                        userid: userid
                    },

                    function (data) {

                        // render event an insert id generated from query

                        calendar.fullCalendar('renderEvent', {
                            id: data,
                            title: fullname + 'pending approval',
                            start: start,
                            end: end,
                            className: 'unapproved'
                        },

                        false // make the event "stick"     

                        );

                    }, "json");

                    // close fancybox

                    $.fancybox.close();

                } else {
                    // close fancybox

                    $.fancybox.close();

                } // end of  if

            });

            //if ajax post successful then show booking on page - not sure how to get value from previous fancybox

        } // end liveDate > start else

        calendar.fullCalendar('unselect');
    },
    editable: true,

    eventSources: [

    // event sources from json

    {
        url: 'json-events.php',
        type: 'POST',
        error: function (data) {
            alert('there was an error while fetching events!' + data.msge);
        },

    // if event is approved = 1 then change color and title of event. This does not work

        success: function (data) {
            var event = data.approved;

            if (data.approved == "1") {

                var title = title + "approved";
                var className = "approved";

            } else {

                var title = title + "awaiting approval";

                var className = "unapproved";

            }
        }

    }

    ]

});

}); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-30T18:29:07.943

我通过从日历中删除过时的事件并使用更新的信息重新创建它来解决这个问题。

**注意：**只需确保为每个事件分配一个唯一的 id 以避免不必要的行为。

这是一个例子：

```
$('#calendar').fullCalendar( 'removeEvents', [5] );

$('#calendar').fullCalendar( 'renderEvent', {
    id: 5,
    title: 'Some Title',
    start: '2013-03-30',
    end: '2013-03-30',
    className: 'fancy-color'
}, true ); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-19T18:53:20.933

您将错误地更改给定事件的样式/外观。

对于 fullCalendar，正确的代码流程是这样的：

1.  ajax 获取/更新/创建事件随你的便（即通过点击或事件源选项）。
2.  利用 eventClick 回调来处理事件的点击（如您的示例）。
3.  通过 fullCalendar('clientEvents', your_event) 找到原始事件（如您的示例）。
4.  **使用来自 ajax 请求的新数据（或通过硬编码变量，如下面的简单示例）**扩展原始事件。****
***   通过 fullCalendar('updateEvent', your_event) 通知 fullCalendar 您更新的事件。这样，fullCalendar 会在内部更新事件，然后将事件（以及其他事件的位置）重新呈现在日历上。*   利用**eventRender** fullCalendar 回调函数来确定哪些事件在渲染时获取哪些样式/css 类。**

 **您的原始示例不起作用的原因是，每次您尝试向事件添加类时，永远不会通知完整日历更新（fullCalendar 不会在所有属性/类/等上创建绑定/监视每个事件和响应都是动态的……那会有点荒谬/浪费内存）。这就是 fullCalendar('updateEvent', your_event) 有用的地方。此外，您必须首先使用**eventRender**回调来添加类，因为每次刷新/重新渲染事件时，实际的事件元素本身**并不相同**，但 fullCalendar 为您的事件存储的事件对象**是一样**。因此，您确定要**重新应用哪些类/样式**当发生重新渲染时，通过**eventRender**回调。

这是一个超级快速的例子：

```
var cal = $("#calendar");
cal.fullCalendar({
  eventClick: function(event){
     // you can do an ajax request here if you want, which is what
     // you might do if you are trying to lazy-load event information
     // as a performance optimization upon initiliation of the calendar, 
     // but for simplicities sake, I'm just hard coding it. 
     event.loading = true;
     event.site = "internal";
     event.category_list = [{name:"Fun Event Tag", bgc:"red"}, 
                           {name:"Crappy Event Tag", bgc:"black"}];
     // Calling updateEvent updates the original event with the data you just
     // set above, and then rerenders it to the calendar, and your eventRender
     // callback is called:
     cal.fullCalendar('updateEvent', event);
  },
  eventRender: function(event, element) {
    // event.site and event.loading are simply supplemental data
    // that I've added to the original full calendar event object(s)
    if(event.site == 'internal' && event.loading){
      element.addClass("loading");
      element.find(".fc-content").prepend("<i class='spinner-dark'>");
    }

    if(event.id == panel_showing_event_id){
      element.addClass("showing");
    }

    // event.category_list is an array that I have also attached
    // to the original event object(s), to show that supplemental arrays/objects
    // that are set on the original event object(s) persist as well
    if(event.category_list && !!event.category_list.length){
      for(i = 0; i < event.category_list.length; i++){
        var tag = event.category_list[i];
        element.css("background-color", tag.bgc);
      }
    }else{
      element.css("background-color", "");
    }
  } 
```

如果您需要完整的解释，请告诉我，但这应该会让您重回正轨。**

# oracle10g - 哪种数据类型用于小数？

> ID：14102102
> 
> 赞同：0
> 
> 时间：2012-12-31T13:17:59.530
> 
> 标签：oracle10g

哪种数据类型可用于在`0.0000001`和之间存储数字`1000`？

我尝试使用 number(10) 作为数据 -`0.01124.`但它存储为`'0`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:04:56.737

您至少需要将其存储为`number(11,7)`. 旧值将被保留，但由于您首先使用 (10)，它们不会恢复任何丢失的精度。即，在您更改列之后仍然会`0.01124`变成这样，因为当您将数据推入数字（10,0）字段时，精度会丢失。`0``0`

```
alter table foo modify(your_col number(x,y)); 
```

但是，如果您的表已经是 number(10)，那么现在可以使用的精度为 7 的 MINIMUM 是：

```
alter table foo modify(your_col number(17,7)); 
```

要说 (11​​,7) 将需要旧列中根本没有数据。

# sqlite - 如何将 sqllite 语句从“=”转换为 MATCH

> ID：14102104
> 
> 赞同：1
> 
> 时间：2012-12-31T13:17:58.593
> 
> 标签：sqlite, union, intersect, fts3

我正在尝试为电子邮件线程创建一个 dbase 解决方案。当我收到一封电子邮件时.. 我想知道这封电子邮件是否属于现有线程。

所以我匹配主题*即主题='cool bro'匹配're：cool bro'*

我也想匹配发送者和接收者对

IE

`(sender = 'A@gmail.com' and receiver = 'B@gmail.com')`

或者

`(sender ='B@gmail.com' and receiver = 'A@gmail.com')`

对于那些确切的情况..这个查询工作正常（[在这里](https://stackoverflow.com/questions/14056134/reusing-result-of-select-statement-within-a-case-statement-sqllite)查看更多细节）：

```
(SELECT COUNT(search_email.threadID) FROM search_email 
                                                        WHERE search_email.subject MATCH '%query%'  AND 
                                                        (
                                                            (search_email.sender = '%sender' AND search_email.tos = '%receiver%')
                                                            OR 
                                                            (search_email.sender = '%receiver%' AND search_email.tos = '%sender%')
                                                        ) 
```

问题是当您遇到这样的情况时：

`(sender = 'Amanda Collins A@gmail.com' and receiver = 'B@gmail.com')`

或者

`(sender ='Billy Bob B@gmail.com' and receiver = 'A@gmail.com')`

显然.. MATCH 子句（或一些正则表达式或其他东西）在这里是有序的..

问题是 sqllite[不允许](https://stackoverflow.com/questions/2621308/sqlite-fts3-search-for-a-string-in-a-column) `MATCH`使用`OR`:`UNION`而是需要 a ..

但我想不出一种方法将上述语句转换为具有以下内容的语句`UNION/INTERSECT`：

```
SELECT * FROM search_email WHERE 
                    search_email.subject MATCH '%query%'  INTERSECT SELECT * FROM 
                                        (SELECT * FROM  (SELECT * FROM search_email WHERE 
                                                                                    search_email.sender MATCH '%sender%' 
                                                                                 INTERSECT SELECT * FROM search_email WHERE search_email.tos MATCH '%receiver%' )
                                        UNION 
                                                                            SELECT * FROM(      SELECT * FROM search_email WHERE search_email.sender MATCH '%sender%' 
                                                                                 INTERSECT SELECT * FROM search_email WHERE search_email.tos MATCH '%receiver%')) 
```

有任何想法吗？

**更新：** 似乎答案只是将第`intersect`一个更改为`union`：

```
SELECT * FROM search_email WHERE 
                    search_email.subject MATCH '%query%'  UNION SELECT * FROM 
                                        (SELECT * FROM  (SELECT * FROM search_email WHERE 
                                                                                    search_email.sender MATCH '%sender%' 
                                                                                 INTERSECT SELECT * FROM search_email WHERE search_email.tos MATCH '%receiver%' )
                                        UNION 
                                                                            SELECT * FROM(      SELECT * FROM search_email WHERE search_email.sender MATCH '%sender%' 
                                                                                 INTERSECT SELECT * FROM search_email WHERE search_email.tos MATCH '%receiver%')) 
```

但是这个解决方案似乎效率*很低*..mysql编译器需要一段时间才能弄清楚..有没有更有效的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T21:24:23.027

使用`MATCH`or`LIKE '%string%'`总是很慢。您也许可以使用全文搜索来改善这一点，但您仍然不会走得太远。

还有另一种方法可以做到这一点，它更有效并且得到广泛支持。

根据[RFC2822](https://www.rfc-editor.org/rfc/rfc2822)（和较旧的[RFC822](https://www.rfc-editor.org/rfc/rfc822)），邮件客户端程序应该在邮件头中创建和维护有助于线程支持的字段。实际上，所有已知的邮件客户端实际上都支持这一点。这些字段是：

*   **Message-ID**：通常看起来像`<randomstring@sender.com>`
*   **In-Reply-To**：回复此消息的消息 ID
*   **参考**：此消息可能链接到的消息 ID 列表

如果您提取这些标题并将它们保存在数据库中的单独列和/或表中，您应该能够通过使用精确比较（没有`MATCH '%string%`'）轻松创建线程，因此它会非常快。

# javascript - Jqgrid在使用RTL方向时没有完美显示负值

> ID：14102107
> 
> 赞同：0
> 
> 时间：2012-12-31T13:18:34.600
> 
> 标签：javascript, jquery, jqgrid

我正在使用 Jqgrid 进行报告。我已经为此应用了**方向：“rtl”**，它工作得很好，但是当负值出现时，它不能完美地显示出来。见下图。

![在此处输入图像描述](../Images/de45cafbd31d5623df6d3e5027580f88.png)

在此图中，请参阅**总发票金额**和**总现金销售额**列。两者的值均为 -11,828，底部的总计应为 -9,013.57。但它看起来很奇怪。

# python - 语法：python smtplib 在脚本中不起作用

> ID：14102113
> 
> 赞同：1
> 
> 时间：2012-12-31T13:20:00.453
> 
> 标签：python, syntax, smtplib

我尝试运行以下代码（命名为`email.py`）：

```
import smtplib    
GMAIL_USERNAME = raw_input("Enter your username: ")
GMAIL_PASSWORD = raw_input("Enter your password: ")    
session = smtplib.SMTP('smtp.gmail.com', 587)
session.ehlo()
session.starttls()
session.login(GMAIL_USERNAME, GMAIL_PASSWORD) 
```

这是错误：

```
Traceback (most recent call last):
  File "email.py", line 1, in <module>
    import smtplib
  File "/usr/lib/python2.7/smtplib.py", line 46, in <module>
    import email.utils
  File "/home/sourya/VProgramming/projects/email.py", line 6, in <module>
    session = smtplib.SMTP('smtp.gmail.com', 587)
AttributeError: 'module' object has no attribute 'SMTP' 
```

但是，当我在解释器中输入代码时，它会运行。

怎么了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T13:25:17.483

尝试重命名您的脚本（改名为 以外的名称`email.py`）。

`email`是一个 Python 模块，但您的脚本名称会影响它，并且无法导入。

**注意：**不要忘记删除`email.pyc`。

# github - 如何使用终端在 Github 上生成 SSH

> ID：14102116
> 
> 赞同：-1
> 
> 时间：2012-12-31T13:20:08.843
> 
> 标签：github, ssh

我在 Github 帐户上错误地通过 SSH 密钥删除了，现在我不知道如何添加该密钥或生成新密钥。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T13:21:40.323

谷歌...

[生成 GitHub SSH 密钥](https://help.github.com/articles/generating-ssh-keys)

> ssh-keygen -t rsa -C "your_email@youremail.com"

这将在您的 ~/.ssh/ 目录中生成新的`id_rsa`和`id_rsa.pub`密钥。

要将这个新创建的密钥上传到 GitHub，请转到：

1.  帐号设定
2.  SSH 密钥
3.  添加 SSH 密钥
4.  在适用的地方粘贴您的密钥 -`cat ~/.ssh/id_rsa.pub`或在 Windows 中粘贴记事本以获取内容。
5.  添加密钥
6.  连接

# ruby-on-rails - 在 simple_form 中集成 select2

> ID：14102117
> 
> 赞同：0
> 
> 时间：2012-12-31T13:20:13.283
> 
> 标签：ruby-on-rails, simple-form, jquery-select2

我在表单上使用 select2。但是想在整个应用程序中使用它。

我的 application.html.erb 中有这部分

```
<script type="text/javascript">
  $(document).ready(function() {
    <%= yield :document_ready %>
  });
</script> 
```

在我看来，这是：

```
<% content_for :document_ready do %>
  $("#menu_category_id").select2({minimumResultsForSearch: 10});
<% end %> 
```

这是视图中的实际输入：

```
<%= f.input :menu_category_id, :collection => @product.menu.menu_categories, 
  :label_method => :name, :value_method => :id, :label => "Category" %> 
```

这工作没有任何问题。但是我不想在所有视图中重复这一点，而是想用 simple_view 处理它。

最好是如果我使用：

```
<%= f.input :menu_category_id, :collection => @product.menu.menu_categories, 
:label_method => :name, :value_method => :id, :label => "Category", 
:select2 => 'minimumResultsForSearch: 10' %> 
```

它会自动将其放入 :document_ready 部分。因此，如果页面上有 3 个选择，它将使用 :select2 中指定的所有选项对所有选择执行此操作

这可以通过自定义输入实现吗？还是有什么其他方式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:36:16.633

我认为您不需要自定义输入或 content_for 帮助器。将 CSS 类分配给您想要的输入`select2`，例如`with_select2`. 接下来，为它们分配一个指定`minimumResultsForSearch`值的数据属性，比如`data-minimum-results`。`document.ready`然后循环遍历所有带有类的输入，并使用from data 属性`with_select2`调用`select2`它们。`minimumResultsForSearch`

# python - 读取数字时出现 xlrd 错误

> ID：14102118
> 
> 赞同：0
> 
> 时间：2012-12-31T13:20:30.837
> 
> 标签：python, numbers, xlrd

我编写了一个小脚本来读取多个 excel 文件并将数据写入 xml 文件。我稍微剥离了脚本以解释出了什么问题。它看起来像这样：

```
import glob, xlrd

xmlFile = 'example.xml'
xmlData = open(xmlFile, 'a')

for xlsfile in glob.glob('*.xls'):

    wb = xlrd.open_workbook(xlsfile)
    sh1 = wb.sheet_by_index(0)
    sh1c1 = sh1.col_values(1)   

    for cell in sh1c1: xmlData.write(cell + "\n") 
```

只要我的 excel 文件中的单元格中只有文本，一切都会很好。当其中一个单元格中有数字时；我收到一个错误：

```
 Traceback (most recent call last):
    File "test.py", line 14, in <module>
   for cell in sh1c1: xmlData.write(cell + "\n")
TypeError: unsupported operand type(s) for +: 'float' and 'str' 
```

它仅在某些单元格和某些文件中包含数字。我已经阅读了很多关于浮点数、整数和字符串的内容，但我还没有找到将其应用于上述代码的方法。我对 python 完全陌生，我还无法理解所有内容。有人想指出我正确的方向吗？

提前谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:48:53.237

正如评论者所建议的，您需要将浮点数转换为字符串才能使用`+`运算符：

```
for cell in sh1c1: xmlData.write(str(cell) + "\n") 
```

或者，您可以将其重写为：

```
for cell in sh1c1: xmlData.write("{0}\n".format(cell)) 
```

或者，如：

```
for cell in sh1c1: xmlData.write("%s\n" % cell) 
```

# curl - 如何配置 cURL 以使用 PHP 发送特定的 HTTP 标头？

> ID：14102121
> 
> 赞同：0
> 
> 时间：2012-12-31T13:20:46.937
> 
> 标签：curl

我正在尝试使用 cURL 和 PHP 将特定的 HTTP 标头发送到网站。

当我在单击该站点的链接时使用 FireBug 分析网络时，我会看到调用此链接的所有 POST 和 GET 方法。这里有标题。

* * *

响应标头：

```
Connection  Keep-Alive
Content-Encoding    gzip
Content-Length  20
Content-Type    text/html; charset=utf-8
Date    Mon, 31 Dec 2012 12:55:57 GMT
Keep-Alive  timeout=5, max=100
Location    http://www.example.com/a/b/11111
Server  Apache/2.2.22
Vary    Accept-Encoding
X-Powered-By    PHP/5.3.10-1ubuntu3.4 
```

请求标头：

```
Accept  text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Encoding gzip, deflate
Accept-Language es-ES,es;q=0.8,en-US;q=0.5,en;q=0.3
Connection  keep-alive
Cookie  referee_id=number;authautologin=number;session=number;uber_video=number
DNT 1
Host    www.example.com
Referer http://www.referersite.com
User-Agent  Mozilla/5.0 (Windows NT 6.1;WOW64;rv:17.0) Gecko/17.0 Firefox/17.0 
```

发送的数据响应标头

```
Content-Length  6
Content-Type    application/x-www-form-urlencoded 
```

* * *

然后，在 FireBug 中，可以选择在新选项卡中再次发送您想要的方法。它发送它并显示为我单击了链接，但实际上我没有单击，我使用了 HTTP 标头。我想要的是这样做，但使用 cURL。在这里你有我说的选项：[http](http://img5.imageshack.us/img5/3841/sinttulodho.png) ://img5.imageshack.us/img5/3841/sinttulodho.png （Abrir en nuevapestaña = Open in new tab）

所以这是我的尝试：

* * *

```
<?
$url = 'http://www.example.com/a/b/1?c=1'; 

function disguise_curl($url) { 
  $curl = curl_init(); 

  $header[] = "Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"; 
  $header[] = "Cache-Control: max-age=0"; 
  $header[] = "Connection: keep-alive"; 
  $header[] = "Keep-Alive:timeout=5, max=100"; 
  $header[] = "Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.3"; 
  $header[] = "Accept-Language:es-ES,es;q=0.8"; 
  $header[] = "Pragma: "; 

  curl_setopt($curl, CURLOPT_URL, $url); 
  curl_setopt($curl, CURLOPT_USERAGENT, 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.97 Safari/537.11'); 
  curl_setopt($curl, CURLOPT_HTTPHEADER, $header); 
  curl_setopt($curl, CURLOPT_REFERER, 'http://www.referersite.com'); 
  curl_setopt($curl, CURLOPT_ENCODING, 'gzip,deflate,sdch'); 
  curl_setopt($curl, CURLOPT_AUTOREFERER, true); 
  curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1); 
  curl_setopt($curl, CURLOPT_TIMEOUT, 10); 

  $html = curl_exec($curl); 
  curl_close($curl);
} 
echo disguise_curl($url); 
?> 
```

我不让它工作。任何其他使用 HTTP 标头的方法或代码中的错误？

# android - 我在内容提供程序中遇到错误，这可能是线程安全特定的

> ID：14102126
> 
> 赞同：6
> 
> 时间：2012-12-31T13:21:11.150
> 
> 标签：android, thread-safety, android-contentprovider

我对Android开发很陌生。我已经研究了文档并阅读了大量关于如何做这个和那个的教程，但是 1 个问题仍然困扰着我。

我的项目有 3 个实体：作者、小说和章节。

我有一个片段，其中包含在某个服务器上发布的最新章节列表，当它滚动到底部时会动态加载更多项目（使用 LoaderManager）。机制是这样的：fragment 向 SQLite 数据库查询有限的记录，负责 uri 的内容提供者调用服务（我自己的）下载更多的章节并将它们保存到数据库中。然后通知该特定 uri 的内容观察者并刷新片段列表。

每次我在列表中向下滚动太快（我猜应用程序在尝试从数据库加载新数据时正在下载和插入新内容）我都会收到此错误：

```
ERROR/AndroidRuntime(689): FATAL EXCEPTION: IntentService[DatabaseService]
    java.lang.IllegalStateException: attempt to re-open an already-closed object: SQLiteDatabase: /data/data/cz.muni.fi.WebNovelReader/databases/Live
    at android.database.sqlite.SQLiteClosable.acquireReference(SQLiteClosable.java:55)
    at android.database.sqlite.SQLiteDatabase.beginTransaction(SQLiteDatabase.java:503)
    at android.database.sqlite.SQLiteDatabase.beginTransaction(SQLiteDatabase.java:416)
    at cz.muni.fi.WebNovelReader.Downloader.LiveProvider.bulkInsertOrUpdate(LiveProvider.java:2040)
    at cz.muni.fi.WebNovelReader.Downloader.LiveProvider.bulkInsert(LiveProvider.java:1804)
    at android.content.ContentProvider$Transport.bulkInsert(ContentProvider.java:207)
    at android.content.ContentResolver.bulkInsert(ContentResolver.java:925)
    at cz.muni.fi.WebNovelReader.Downloader.DatabaseService.onHandleIntent(DatabaseService.java:90)
    at android.app.IntentService$ServiceHandler.handleMessage(IntentService.java:65)
    at android.os.Handler.dispatchMessage(Handler.java:99)
    at android.os.Looper.loop(Looper.java:137)
    at android.os.HandlerThread.run(HandlerThread.java:60) 
```

第 2040 行标记在下面的源代码中。当我在加载（下载和插入）更多数据时尝试向上滚动时出现另一个错误，我收到另一个错误：

```
ERROR/AndroidRuntime(619): FATAL EXCEPTION: ModernAsyncTask #4
    java.lang.RuntimeException: An error occured while executing doInBackground()
    at android.support.v4.content.ModernAsyncTask$3.done(ModernAsyncTask.java:137)
    at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
    at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
    at java.util.concurrent.FutureTask.run(FutureTask.java:137)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
    at java.lang.Thread.run(Thread.java:856)
    Caused by: java.lang.IllegalStateException: Cannot perform this operation because the connection pool has been closed.
    at android.database.sqlite.SQLiteConnectionPool.throwIfClosedLocked(SQLiteConnectionPool.java:962)
    at android.database.sqlite.SQLiteConnectionPool.waitForConnection(SQLiteConnectionPool.java:599)
    at android.database.sqlite.SQLiteConnectionPool.acquireConnection(SQLiteConnectionPool.java:348)
    at android.database.sqlite.SQLiteSession.acquireConnection(SQLiteSession.java:894)
    at android.database.sqlite.SQLiteSession.executeForCursorWindow(SQLiteSession.java:834)
    at android.database.sqlite.SQLiteQuery.fillWindow(SQLiteQuery.java:62)
    at android.database.sqlite.SQLiteCursor.fillWindow(SQLiteCursor.java:143)
    at android.database.sqlite.SQLiteCursor.getCount(SQLiteCursor.java:133)
    at android.content.ContentResolver.query(ContentResolver.java:388)
    at android.content.ContentResolver.query(ContentResolver.java:313)
    at android.support.v4.content.CursorLoader.loadInBackground(CursorLoader.java:49)
    at android.support.v4.content.CursorLoader.loadInBackground(CursorLoader.java:35)
    at android.support.v4.content.AsyncTaskLoader.onLoadInBackground(AsyncTaskLoader.java:240)
    at android.support.v4.content.AsyncTaskLoader$LoadTask.doInBackground(AsyncTaskLoader.java:51)
    at android.support.v4.content.AsyncTaskLoader$LoadTask.doInBackground(AsyncTaskLoader.java:40)
    at android.support.v4.content.ModernAsyncTask$2.call(ModernAsyncTask.java:123)
    at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
    ... 4 more 
```

我从错误消息中了解到，内容提供者的查询方法是关闭可写数据库。我想这与内容提供者的线程安全有关。作为线程安全问题的临时解决方法，我创建了一个服务（DatabaseService），它只负责数据库写入操作（按顺序执行它们）。我想我了解在 java 中使用多线程的基础知识，但是对我来说将这些知识应用到这个特定的问题上实在是太过分了，所以我来这里寻求帮助。

这是**带有列表的frament的完整来源**

```
package cz.muni.fi.WebNovelReader.Fragments;

import android.content.ContentUris;
import android.content.Intent;
import android.database.Cursor;
import android.net.Uri;
import android.os.Bundle;
import android.support.v4.app.LoaderManager;
import android.support.v4.content.CursorLoader;
import android.support.v4.content.Loader;
import android.support.v4.widget.SimpleCursorAdapter;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AbsListView;
import android.widget.ListView;
import com.actionbarsherlock.app.SherlockListFragment;
import cz.muni.fi.WebNovelReader.Library.ReaderActivity;
import cz.muni.fi.WebNovelReader.R;
import cz.muni.fi.WebNovelReader.Tools.Provider;

public class LiveNewestChaptersFragment extends SherlockListFragment implements LoaderManager.LoaderCallbacks<Cursor> {
    Uri uri;
    ListView list;
    SimpleCursorAdapter adapter;
    View footer = null;

    int offset;
    int lastEverVisible = 0;
    int count = 0;
    boolean loadingMore = false;

    String orderBy = Provider.Columns.CHAPTER_PUBLISHED;
    String sortOrder = " DESC";

    /* **********************
    *   Fragment Lifecycle  *
    ************************/
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.live_servers_fragment, container, false);
        list = (ListView)view.findViewById(android.R.id.list);
        list.setOnScrollListener(new AbsListView.OnScrollListener() {
            @Override
            public void onScrollStateChanged(AbsListView absListView, int i) {
                //To change body of implemented methods use File | Settings | File Templates.
            }

            @Override
            public void onScroll(AbsListView absListView, int firstVisibleItem, int visibleItemCount, int totalItemCount) {
                //what is the bottom item that is visible
                int lastInScreen = firstVisibleItem + visibleItemCount;

                if (lastEverVisible < lastInScreen)
                    lastEverVisible = lastInScreen;

                //is the bottom item visible & not loading more already ? Load more !
                if ((totalItemCount >= 10) && (lastInScreen == totalItemCount) && (lastEverVisible == lastInScreen) && !(loadingMore)){
                    if (footer != null)
                        footer.setVisibility(View.VISIBLE);

                    offset += 10;
                    loadingMore = true;
                    count = totalItemCount;
                    getLoaderManager().restartLoader(0, null,         LiveNewestChaptersFragment.this);
                }
            }
        });

        footer = inflater.inflate(R.layout.loading_footer, null, false);
        footer.setVisibility(View.GONE);
        list.addFooterView(footer);
        return view;
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);
        uri = getActivity().getIntent().getData();

        offset = 0;
        getLoaderManager().initLoader(0, null, this);

        adapter = new SimpleCursorAdapter(
                getActivity(),
                R.layout.live_newest_chapters_item,
                null,
                new String[] {Provider.Columns.CHAPTER_INDEX, Provider.Columns.CHAPTER_TITLE, Provider.Columns.NOVEL_TITLE, Provider.Columns.AUTHOR_NICKNAME},
                new int[] {R.id.chapter_index, R.id.chapter_title, R.id.novel_title, R.id.author_nickname},
                0
        );
        setListAdapter(adapter);

        getSherlockActivity().getSupportActionBar().setDisplayShowTitleEnabled(true);
        getSherlockActivity().getSupportActionBar().setDisplayShowHomeEnabled(true);
    }

    @Override
    public void onListItemClick(ListView l, View v, int position, long id) {
        Intent i = new Intent(getActivity(), ReaderActivity.class);
        i.setData(ContentUris.appendId(
                Provider.BaseUris.LIVE.buildUpon().path(Provider.UriPaths.CHAPTERS),
                id
        ).build());
        startActivity(i);
    }

    /* **********************************
    *   LoaderManager.LoaderCallbacks   *
    ************************************/

    @Override
    public Loader<Cursor> onCreateLoader(int i, Bundle bundle) {
        getSherlockActivity().setSupportProgressBarIndeterminateVisibility(true);

        return new CursorLoader(getActivity(),
                uri,
                new String[] {Provider.Columns.BASE_ID, Provider.Columns.CHAPTER_TITLE, Provider.Columns.CHAPTER_INDEX, Provider.Columns.NOVEL_TITLE, Provider.Columns.AUTHOR_NICKNAME},
                null,
                new String[] {String.valueOf(offset + 10)},
                orderBy + " COLLATE LOCALIZED" + sortOrder
        );
    }

    @Override
    public void onLoadFinished(Loader<Cursor> cursorLoader, Cursor cursor) {
        if (cursor.getCount() > count) {
            if (footer != null)
                footer.setVisibility(View.GONE);
            adapter.swapCursor(cursor);
            loadingMore = false;
        }
        getSherlockActivity().setSupportProgressBarIndeterminateVisibility(false);
    }

    @Override
    public void onLoaderReset(Loader loader) {
        adapter.swapCursor(null);
        if (loader.isStarted())
            loader.reset();
    }
} 
```

**简化查询法**

```
public Cursor query(Uri uri, String[] proj, String sel, String[] selectionArgs, String orderBy) {
    String selection = sel;

    String[] projection;
    if ((proj == null) || (proj.length == 0)) {
        projection = new String[] {"*"};
    }else{
        projection = new String[proj.length];
        System.arraycopy(proj, 0, projection, 0, proj.length);
    }
    String table;
    String groupBy = null;
    String limit = null;
    StringBuilder temp;

    boolean distinct = false;
    switch (uriMatcher.match(uri)) {
        // initialize variables needed to make the query
    }
    SQLiteDatabase db = dbHelper.getReadableDatabase();
    Cursor result = null;
    try{
        result = db.query(distinct, table, projection, selection, SelectionArgs, groupBy, null, orderBy, limit);
        if (result != null) {
            result.setNotificationUri(getContext().getContentResolver(), uri);

            if ((uriMatcher.match(uri) == URI_MATCHER_CHAPTERS_BY_SERVER_ID) && (ContentUris.parseId(uri) == 0)) {
                int offset = Integer.valueOf(limit);
                if (lastLiveLimit < offset) {
                    lastLiveLimit = offset;
                    DownloaderItemContent download = new DownloaderItemContent(url, insertUri);
                    Intent i = new Intent(getContext(), DownloaderService.class);
                    i.putExtra(DownloaderService.EXTRA_DOWNLOAD_ITEM, download);
                    getContext().startService(i);
                }
            }
        }
    }catch (SQLiteException e) {
        Log.e("WebNovel Reader", "LibraryProvider: query(): SQLiteException thrown:\n" + e.getMessage());
    } catch (MalformedURLException e) {
        e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
    }

    return result;
} 
```

**简化**
的 bulkInsert 方法 来源说明：我使用 bulkInsert 方法插入数据。我需要所有 3 个实体一起运行检查，因此我决定构建 ContentValues 数组以在单个方法调用中获取所有 3 个实体。其结构为：作者内容值依次是作者小说内容值、小说章节内容值。下一个内容值是另一个作者的小说的值，依此类推（模式 [author1, novel1, chapter1, chapter2, novel2, chapter1, chapter2, author2, novel1, chapter1]）。它类似于通过 DFS 对树图进行序列化，然后将它们一个接一个地放置。

```
private int bulkInsertOrUpdate(Uri uri, ContentValues[] values) {
    //basic checking
    .
    .
    .
    //loop through authors
    while (i < values.length) {
        int offset = 0;
        List<ContentValues> novels_with_children = new ArrayList<ContentValues>();
        List<ContentValues[]> chapters = new ArrayList<ContentValues[]>();
        int max1 = 0;

        // check if content values of author or identifier of child count are incorrect. If so, skip to the next author

        // shift 1 array entry to novel content values
        offset++;
        // loop through author's novels
        for (int j = 0; j < max1; j++) {

            int novelIndex = i + offset;
            int max2;
             // check if content values of novel or identifier of child count are incorrect. If so, skip to the next novel

            // shift  1 array entry to chapter content values
            offset++;
            ContentValues[] temp = new ContentValues[max2];
            for (int a = 0; a < max2; a++) {
                temp[a] = null;
            }

            boolean flag_empty = true;
            // loop through chapters
            for (int k = 0; k < max2; k++) {
                // check if content values of chapter or identifier of child count are incorrect. If so, skip to the next chapter

                // at least 1 chapter was added, novel is not without chapters
                flag_empty = false;
            }

            // if novel has no chapters skip it

            offset += max2;

            // if novel is OK, add it for SQLite insert
            novels_with_children.add(values[novelIndex]);
            // add novel chapters for SQLite insert
            chapters.add(temp);
        }

        // if author has no novels skip him

        /****************
         *  ACTIVE SQL  *
         ****************/

         boolean authorInserted = false;
         boolean novelInserted = false;
         boolean chapterInserted = false;

         int count_author_instance = 0;
         int count_novel_instance = 0;

         serverID = values[i].getAsLong(Columns.AUTHOR_SERVER_ID);

         picturesToDownload.clear();

         String authorPictureUrl = values[i].getAsString(Columns.AUTHOR_PICTURE);
         if (values[i].containsKey(Columns.AUTHOR_PICTURE))
             values[i].remove(Columns.AUTHOR_PICTURE);

         SQLiteDatabase dbwrite = dbHelper.getWritableDatabase();
         SQLiteStatement insertGenresChaptersConnector = dbwrite.compileStatement ("INSERT OR IGNORE INTO " + Tables.GENRES_CHAPTERS_CONNECTOR + "(" + Columns.CHAPTER_ID + ", " + Columns.GENRE_ID + ", " + Columns.NOVEL_ID + ") VALUES (?, ?, ?)");

         //transaction author start
(2040)  dbwrite.beginTransaction();
        try{
            // serach for author
             Cursor authorIDcursor = dbwrite.query(Tables.AUTHORS, new String[] {Columns.BASE_ID}, "(" + Columns.AUTHOR_NICKNAME + " = ?) AND (" + Columns.AUTHOR_SERVER_ID + " = ?)", new String[]{values[i].getAsString(Columns.AUTHOR_NICKNAME), Integer.toString(values[i].getAsInteger(Columns.AUTHOR_SERVER_ID))}, null, null, null);
            long authorID;
            boolean flag_transaction2_successful = false;

            if (authorIDcursor.moveToFirst()) {
                // if found, get his id
                authorID = authorIDcursor.getInt(0);
            }else{
                // create if not found
                authorID = dbwrite.insert(Tables.AUTHORS, null, values[i]);
            }
            authorIDcursor.close();

            // for every author's novel
            for (int j = 0; j < novels_with_children.size(); j++) {
                ContentValues cvn = novels_with_children.get(j);
                ContentValues[] cvc = chapters.get(j);
                boolean flag_transaction3_successful = false;

                //transaction novel start
                dbwrite.beginTransaction();
                try {
                    // search for novel
                    Cursor novelIDcursor = dbwrite.query(Tables.NOVELS, new String[]{Columns.BASE_ID}, "(" + Columns.NOVEL_TITLE + " = ?)", new String[]{cvn.getAsString(Columns.NOVEL_TITLE)}, null, null, null);
                    long novelID;

                    if (novelIDcursor.moveToFirst()) {
                        // if found get its id
                        novelID = novelIDcursor.getInt(0);
                    }else{
                        //create if not found
                        novelID = dbwrite.insert(Tables.NOVELS, null, cvn);
                    }
                    novelIDcursor.close();

                    // for every chapter
                    for (ContentValues chapterCV : cvc) {
                        //skip if chapter did not pass through initial control tests
                        if (chapterCV == null) {
                            continue;
                        }

                        //find previous chapter if exists
                        Cursor previous = dbwrite.query(Tables.CHAPTERS, new String[] {Columns.BASE_ID}, "(" + Columns.NOVEL_ID + " = ?) AND (" + Columns.CHAPTER_INDEX + " = ?)", new String[] {String.valueOf(novelID), String.valueOf(chapterIndex - 1)}, null, null, null);
                        if ((previous != null) && (previous.moveToFirst()))
                            chapterCV.put(Columns.CHAPTER_ID_PREVIOUS, previous.getLong(previous.getColumnIndex(Columns.BASE_ID)));
                        previous.close();

                        //find next chapter if exists
                        Cursor next = dbwrite.query(Tables.CHAPTERS, new String[] {Columns.BASE_ID}, "(" + Columns.NOVEL_ID + " = ?) AND (" + Columns.CHAPTER_INDEX + " = ?)", new String[] {String.valueOf(novelID), String.valueOf(chapterIndex + 1)}, null, null, null);
                        if ((next != null) && (next.moveToFirst()))
                            chapterCV.put(Columns.CHAPTER_ID_NEXT, next.getLong(next.getColumnIndex(Columns.BASE_ID)));
                        next.close();

                        //transaction chapter start
                        dbwrite.beginTransaction();

                        try {
                            // search for chapter
                            Cursor chapterIDcursor = dbwrite.query(Tables.CHAPTERS, new String[]{Columns.BASE_ID}, "(" + Columns.NOVEL_ID + " = ?) AND (" + Columns.CHAPTER_INDEX + " = ?)", new String[]{Long.toString(novelID), chapterCV.getAsInteger(Columns.CHAPTER_INDEX).toString()}, null, null, null);
                            long chapterID;

                            if (chapterIDcursor.moveToFirst()) {
                                // if found get its id
                                chapterID = chapterIDcursor.getInt(0);
                            } else {
                                // create if not found
                                chapterID = dbwrite.insert(Tables.CHAPTERS, null, chapterCV);
                            }
                            chapterIDcursor.close();

                            // use pre-compiled statement to create connection between genre and chapter (insert entry into connector table)
                            for (byte genreID : genres) {
                                insertGenresChaptersConnector.bindLong(1, chapterID);
                                insertGenresChaptersConnector.bindLong(2, genreID);
                                insertGenresChaptersConnector.bindLong(3, novelID);
                                insertGenresChaptersConnector.executeInsert();
                            }

                            //tie consequent chapters together
                            //write this chapter as NEXT in previous chapter if exests
                            ContentValues cv = new ContentValues();
                            cv.put(Columns.CHAPTER_ID_PREVIOUS, chapterID);
                            dbwrite.update(Tables.CHAPTERS, cv, "(" + Columns.NOVEL_ID + " = ?) AND (" + Columns.CHAPTER_INDEX + " = ?)", new String[] {String.valueOf(novelID), String.valueOf(chapterIndex + 1)});//Tables.CHAPTERS, new String[]{Columns.BASE_ID}, "(" + Columns.NOVEL_TITLE + " = ?)", new String[]{novelValues.getAsString(Columns.AUTHOR_NICKNAME)}, null, null, null);

                            //write this chapter as PREVIOUS in next chapter if exests
                            cv.clear();
                            cv.put(Columns.CHAPTER_ID_NEXT, chapterID);
                            dbwrite.update(Tables.CHAPTERS, cv, "(" + Columns.NOVEL_ID + " = ?) AND (" + Columns.CHAPTER_INDEX + " = ?)", new String[] {String.valueOf(novelID), String.valueOf(chapterIndex - 1)});

                            //if chapter and connector entries added successfully
                            dbwrite.setTransactionSuccessful();
                            flag_transaction3_successful = true;
                            count_novel_instance++;
                        } catch (SQLiteException e) {
                            //TODO Log
                        } finally {
                            //transaction chapter end
                            dbwrite.endTransaction();
                        }
                    }

                    // if at least one chapter of this novel was successfully added
                    if (flag_transaction3_successful) {
                        dbwrite.setTransactionSuccessful();
                        flag_transaction2_successful = true;
                        count_novel_instance++;
                    }else{
                        count_novel_instance = 0;
                    }
                }catch(SQLiteException e) {
                    count_novel_instance = 0;
                    //TODO Log
                }finally {
                    //transaction novel end
                    dbwrite.endTransaction();
                }
            }

            count_author_instance += count_novel_instance;

            // if at least one novel of this author was successfully added
            if (flag_transaction2_successful) {
                dbwrite.setTransactionSuccessful();
                count_author_instance++;
            }else{
                count_author_instance = 0;
            }

        }catch (SQLiteException e) {
            count_author_instance = 0;
            //log
        }finally {
            //transaction1 end
            dbwrite.endTransaction();
            dbwrite.close();
        }

        count += count_author_instance;

        i += offset;
    }

    // notify all uris to be notified

    return count;
} 
```

先感谢您。如果需要任何其他信息，请告诉我。

# c# - 是否可以在不换行的情况下使用多行 DataGridView 单元格？

> ID：14102130
> 
> 赞同：10
> 
> 时间：2012-12-31T13:21:41.587
> 
> 标签：c#, winforms, datagridview

我知道我可以在 的 上设置为`WrapMode`true ，但这并没有给我想要的行为。我在每个单元格中显示一个字符串列表，因此我希望回车被识别，但我不希望长项目中的文本换行。`DefaultCellStyle``RowTemplate`

有谁知道是否有可能实现这一目标？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T14:59:23.017

我希望这是您正在寻找的： ![截屏](../Images/5b5b7c2c97dadd9919bcc6bbeceb190b.png)

我使用了两个事件：

1.  我在单元格编辑后测量了高度。
2.  我在绘制单元格时测量了文本，并在需要时对其进行修剪，然后重复直到合适为止。

代码：

```
public partial class Form1 : Form
{
    private readonly int _rowMargins;

    public Form1()
    {
        InitializeComponent();
        int rowHeight = dataGridView1.Rows[0].Height;
        _rowMargins = rowHeight - dataGridView1.Font.Height;
    }

    private void dataGridView1_CellEndEdit(object sender, DataGridViewCellEventArgs e)
    {
        DataGridView view = sender as DataGridView;
        DataGridViewCell cell = view.Rows[e.RowIndex].Cells[e.ColumnIndex];
        string text = string.Format("{0}", cell.FormattedValue);
        if (!string.IsNullOrEmpty(text))
        {
            Size size = TextRenderer.MeasureText(text, view.Font);
            view.Rows[e.RowIndex].Height = Math.Max(size.Height + _rowMargins, view.Rows[e.RowIndex].Height);
        }
    }

    private void dataGridView1_CellPainting(object sender, DataGridViewCellPaintingEventArgs e)
    {
        if (e.ColumnIndex == -1 || e.RowIndex == -1)
        {
            return;
        }
        e.Paint(e.ClipBounds, DataGridViewPaintParts.All ^ DataGridViewPaintParts.ContentForeground);

        DataGridView view = sender as DataGridView;

        string textToDisplay = TrimTextToFit(string.Format("{0}", e.FormattedValue), (int) (e.CellBounds.Width * 0.96), view.Font);

        bool selected = view.Rows[e.RowIndex].Cells[e.ColumnIndex].Selected;
        SolidBrush brush = new SolidBrush(selected ? e.CellStyle.SelectionForeColor : e.CellStyle.ForeColor);

        e.Graphics.DrawString(textToDisplay, view.Font, brush, e.CellBounds.X, e.CellBounds.Y + _rowMargins / 2);

        e.Handled = true;
    }

    private static string TrimTextToFit(string text, int contentWidth, Font font)
    {
        Size size = TextRenderer.MeasureText(text, font);

        if (size.Width < contentWidth)
        {
            return text;
        }

        int i = 0;
        StringBuilder sb = new StringBuilder();
        while (i < text.Length)
        {
            sb.Append(text[i++]);
            size = TextRenderer.MeasureText(sb.ToString(), font);

            if (size.Width <= contentWidth) continue;

            sb.Append("...");

            while (sb.Length > 3 && size.Width > contentWidth)
            {
                sb.Remove(sb.Length - 4, 1);
                size = TextRenderer.MeasureText(sb.ToString(), font);
            }

            while (i < text.Length && text[i] != Environment.NewLine[0])
            {
                i++;
            }
        }
        return sb.ToString();
    }

} 
```

享受吧，
奥菲尔

## 设计师代码：

```
partial class Form1
{
    /// <summary>
    /// Required designer variable.
    /// </summary>
    private System.ComponentModel.IContainer components = null;

    /// <summary>
    /// Clean up any resources being used.
    /// </summary>
    /// <param name="disposing">true if managed resources should be disposed; otherwise, false.</param>
    protected override void Dispose(bool disposing)
    {
        if (disposing && (components != null))
        {
            components.Dispose();
        }
        base.Dispose(disposing);
    }

    #region Windows Form Designer generated code

    /// <summary>
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// </summary>
    private void InitializeComponent()
    {
        this.dataGridView1 = new System.Windows.Forms.DataGridView();
        this.LineNumber = new System.Windows.Forms.DataGridViewTextBoxColumn();
        this.Content = new System.Windows.Forms.DataGridViewTextBoxColumn();
        ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).BeginInit();
        this.SuspendLayout();
        // 
        // dataGridView1
        // 
        this.dataGridView1.AllowUserToDeleteRows = false;
        this.dataGridView1.Anchor = ((System.Windows.Forms.AnchorStyles)((((System.Windows.Forms.AnchorStyles.Top | System.Windows.Forms.AnchorStyles.Bottom) 
        | System.Windows.Forms.AnchorStyles.Left) 
        | System.Windows.Forms.AnchorStyles.Right)));
        this.dataGridView1.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
        this.dataGridView1.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
        this.LineNumber,
        this.Content});
        this.dataGridView1.Location = new System.Drawing.Point(13, 13);
        this.dataGridView1.Name = "dataGridView1";
        this.dataGridView1.RowHeadersWidth = 55;
        this.dataGridView1.RowTemplate.DefaultCellStyle.WrapMode = System.Windows.Forms.DataGridViewTriState.False;
        this.dataGridView1.Size = new System.Drawing.Size(493, 237);
        this.dataGridView1.TabIndex = 0;
        this.dataGridView1.CellEndEdit += new System.Windows.Forms.DataGridViewCellEventHandler(this.dataGridView1_CellEndEdit);
        this.dataGridView1.CellPainting += new System.Windows.Forms.DataGridViewCellPaintingEventHandler(this.dataGridView1_CellPainting);
        // 
        // LineNumber
        // 
        this.LineNumber.FillWeight = 30F;
        this.LineNumber.Frozen = true;
        this.LineNumber.HeaderText = "#";
        this.LineNumber.MaxInputLength = 3;
        this.LineNumber.Name = "LineNumber";
        this.LineNumber.ReadOnly = true;
        this.LineNumber.Resizable = System.Windows.Forms.DataGridViewTriState.False;
        this.LineNumber.Width = 30;
        // 
        // Content
        // 
        this.Content.HeaderText = "Content";
        this.Content.Name = "Content";
        // 
        // Form1
        // 
        this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
        this.ClientSize = new System.Drawing.Size(518, 262);
        this.Controls.Add(this.dataGridView1);
        this.Name = "Form1";
        this.Text = "Is it possible to have Multi-line DataGridView cells without wrapping text?";
        ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).EndInit();
        this.ResumeLayout(false);

    }

    #endregion

    private System.Windows.Forms.DataGridView dataGridView1;
    private System.Windows.Forms.DataGridViewTextBoxColumn LineNumber;
    private System.Windows.Forms.DataGridViewTextBoxColumn Content;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-21T18:24:09.960

我测试了这段代码，结果很好，请测试一下：

注意：在创建表单和Datagrid时，设置以下datagrid属性

1- AutoSizeRowsMo​​de 到 AllCells。
2- 目标列的 WrapMode 为 True

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Text;
using System.Windows.Forms;

namespace DGMultiLine
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        private void button1_Click(object sender, EventArgs e)
        {
            int max = 12; //min Column Width in Char
            //do this for all rows of column for max Line Size in values

            string str = "Hello\r\nI am mojtaba\r\ni like programming very very \r\nrun this code and  pay attention to result\r\n Datagrid Must show this Line Good are you see whole of this Thats Finished!";
            string[] ss = str.Split(new string[] { "\r\n" }, StringSplitOptions.RemoveEmptyEntries);

            //find max Line Size To Now
            for (int i = 0; i < ss.Length; i++)
                if (ss[i] != null && ss[i] != "")
                    if (ss[i].Length > max)
                        max = ss[i].Length;
            //Set target Column Width
            dataGridView1.Columns[0].Width = max*5;//for adequate value you must refer to screen resolution
            //filling datagrigView for all values
            dataGridView1.Rows[0].Cells[0].Value = str;
        }

    }
} 
```

您可以通过真正的全文添加一个隐藏的列和一个可见的列，这些列通过上面的代码显示字符串值，但字符串行的大小超过了您的 Max Column Size 剪辑字符串，并添加 ... 到 end 。（如果不清楚请写完整的代码）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T00:59:09.617

它通过与字符串一起执行 \r\n 对我有用。

例如“你好”+ \r\n。然后它转到下一行。

编辑：

刚刚看到这是WinForms。上面的技巧只适用于 WPF。

编辑2：

您可以使用：

```
dataGridView1.DefaultCellStyle.WrapMode = DataGridViewTriState.True; 
```

如果您不想包装长物品，您只需：

```
String stringTest = "1234567891";
if (stringTest.Length > 8)
{
   stringTest = stringTest.Replace(stringTest.Substring(8), "...");
} 
```

如果字符串长于 8，这将添加“...”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:02:09.563

一种方法是您可以只放置一些可见的单词，然后将鼠标悬停在该单元格上时，可以在工具提示中显示全文。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-17T16:30:26.663

如果不将 WrapMode 设置为 true，我还没有找到一种方法。但是，您应该能够通过将单元格的宽度设置为足够宽以在一行上显示所有项目来“欺骗”DataGridView 执行此操作。

[这是](http://www.codeproject.com/Articles/5801/Adjust-combo-box-drop-down-list-width-to-longest-s)一个使用 ComboBo 完成的示例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-25T08:08:48.323

此类获取`DataGridView`实例并添加用于修剪多行省略号 (...) 的宽度和高度的行为。

用法：

```
MultilineTriming.Init(ref dataGridView); // that's it! 
```

享受，

```
public static class MultilineTriming
{
    private static int _rowMargins;

    public static void Init(ref DataGridView dataGridView)
    {
        dataGridView.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.None;
        dataGridView.DefaultCellStyle.WrapMode = DataGridViewTriState.False;

        _rowMargins = dataGridView.RowTemplate.Height - dataGridView.Font.Height;

        Unregister(dataGridView);

        dataGridView.CellEndEdit += DataGridViewOnCellEndEdit;
        dataGridView.CellPainting += DataGridViewOnCellPainting;
        dataGridView.RowsAdded += DataGridViewOnRowsAdded;
        dataGridView.Disposed += DataGridViewOnDisposed;
    }

    private static void DataGridViewOnRowsAdded(object sender, DataGridViewRowsAddedEventArgs e)
    {
        DataGridView view = sender as DataGridView;
        DataGridViewRow row = view.Rows[e.RowIndex];
        foreach (DataGridViewCell cell in row.Cells)
        {
            if (cell.FormattedValue == null)
            {
                continue;
            }
            Size size = TextRenderer.MeasureText((string)cell.FormattedValue, view.Font);
            row.Height = Math.Max(size.Height + _rowMargins, row.Height);
        }
    }

    private static void DataGridViewOnDisposed(object sender, EventArgs eventArgs)
    {
        DataGridView dataGridView = sender as DataGridView;
        Unregister(dataGridView);

    }

    public static void Unregister(DataGridView dataGridView)
    {
        dataGridView.RowsAdded -= DataGridViewOnRowsAdded;
        dataGridView.CellEndEdit -= DataGridViewOnCellEndEdit;
        dataGridView.CellPainting -= DataGridViewOnCellPainting;
    }

    private static void DataGridViewOnCellEndEdit(object sender, DataGridViewCellEventArgs e)
    {
        DataGridView view = sender as DataGridView;
        DataGridViewRow row = view.Rows[e.RowIndex];
        DataGridViewCell cell = row.Cells[e.ColumnIndex];

        string text = (string)cell.FormattedValue;

        if (string.IsNullOrEmpty(text)) return;

        Size size = TextRenderer.MeasureText(text, view.Font);
        row.Height = Math.Max(size.Height + _rowMargins, row.Height);
    }

    private static void DataGridViewOnCellPainting(object sender, DataGridViewCellPaintingEventArgs e)
    {
        if (e.ColumnIndex == -1 || e.RowIndex == -1 || e.FormattedValue == null)
        {
            return;
        }
        e.Paint(e.ClipBounds, DataGridViewPaintParts.All ^ DataGridViewPaintParts.ContentForeground);

        DataGridView view = sender as DataGridView;

        string textToDisplay = TrimTextToFit(string.Format("{0}", e.FormattedValue), (int)(e.CellBounds.Width * 0.96) - 3, e.CellBounds.Height - _rowMargins, view.Font);

        bool selected = view.Rows[e.RowIndex].Cells[e.ColumnIndex].Selected;
        SolidBrush brush = new SolidBrush(selected ? e.CellStyle.SelectionForeColor : e.CellStyle.ForeColor);

        e.Graphics.DrawString(textToDisplay, view.Font, brush, e.CellBounds.X + 1, e.CellBounds.Y + _rowMargins / 2);

        e.Handled = true;
    }

    private static string TrimTextToFit(string text, int contentWidth, int contentHeight, Font font)
    {
        Size size = TextRenderer.MeasureText(text, font);

        if (size.Width < contentWidth && size.Height < contentHeight)
        {
            return text;
        }

        int i = 0;
        StringBuilder sb = new StringBuilder();
        while (i < text.Length)
        {
            sb.Append(text[i++]);
            size = TextRenderer.MeasureText(sb.ToString(), font);

            if (size.Width < contentWidth) continue;

            sb.Append("...");

            while (sb.Length > 3 && size.Width >= contentWidth)
            {
                sb.Remove(sb.Length - 4, 1);
                size = TextRenderer.MeasureText(sb.ToString(), font);
            }

            while (i < text.Length && text[i] != Environment.NewLine[0])
            {
                i++;
            }
        }
        string res = sb.ToString();

        if (size.Height <= contentHeight)
        {
            return res;
        }

        string[] lines = res.Split(new string[] { Environment.NewLine }, StringSplitOptions.None);
        i = lines.Length;
        while (i > 1 && size.Height > contentHeight)
        {
            res = string.Join(Environment.NewLine, lines, 0, --i);
            size = TextRenderer.MeasureText(res, font);
        }

        return res;
    }
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-09-25T02:02:38.520

```
 if ((!e.Value.Equals("OK")) && e.ColumnIndex == 6)
        {
            e.CellStyle.WrapMode = DataGridViewTriState.True;
            //dgvObjetivos.Columns[2].AutoSizeMode = DataGridViewAutoSizeColumnMode.DisplayedCells;
            dgvObjetivos.AutoSizeRowsMode = DataGridViewAutoSizeRowsMode.AllCells;
        } 
```

[http://kshitijharma.net/2010/08/23/showing-multiline-string-in-a-datagridview-cell/](http://kshitijsharma.net/2010/08/23/showing-multiline-string-in-a-datagridview-cell/)

# android - TextSwitcher 动画定制

> ID：14102131
> 
> 赞同：1
> 
> 时间：2012-12-31T13:21:48.763
> 
> 标签：android, animation, textview

我可以将 TextSwitcher 动画与 TextView 一起使用吗？（我想在 Char 更改时更改它）
或者
我可以通过代码（如`TextView : txtView.setTextSize();`）更改文本大小并更改 TextColor。

代码很简单

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:52:06.877

将 textswitcher 视图放在代码的上部后：

```
 TextSwitcher questionTextSwitcher = (TextSwitcher) findViewById(R.id.textSwitcher);
    questionTextSwitcher.setFactory(new MyTextSwitcherFactory()); 
```

在这里你可以操纵你的文本视图：

```
 private class MyTextSwitcherFactory implements ViewSwitcher.ViewFactory {
           public View makeView() {
                 TextView textView = new TextView(CurrentClass.this);
                 textView.setGravity(Gravity);
                 textView.setTextSize(size);
                 textView.setTextColor(Color);
                }
            } 
```

# javascript - 通过 http 保护 POSTED 数据的最佳方法？

> ID：14102132
> 
> 赞同：3
> 
> 时间：2012-12-31T13:21:54.580
> 
> 标签：javascript, google-chrome, google-chrome-extension, rsa, public-key-encryption

我有一个正在开发的 Chrome 扩展程序，可以将数据发布到远程服务器。我希望在发送数据之前对其进行加密。我的服务器没有 HTTPS，所以我必须通过纯 HTTP 发送它。

我目前在 Javascript 的扩展中使用 RSA 4096 位公钥加密，SHA1 对数据进行哈希处理，并通过 Ajax 发布请求发送哈希和加密数据。

这种可接受的加密是通过 HTTP 发送的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:59:20.710

客户：散列你的信息。将哈希附加到您的消息中。加密您的消息 + 哈希。发送您的加密消息 + 哈希。
服务器：解密您的消息 + 哈希。拆分消息和哈希。散列消息。确保服务器端的哈希值与客户端的哈希值相同。如果这些不匹配，那么要么有一些比特接通了电线，要么有人改变了你的信息。是的，RSA 4096 位公钥加密已经绰绰有余了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:32:27.483

好吧，维基百科告诉的是：

> ...并且 2048 位密钥在 2030 年之前就足够了...
> 如果在 2030 年之后需要安全性，则应使用 3072 位的 RSA 密钥长度

所以我猜使用 4k 位加密有点偏执

# android - 复选框不起作用

> ID：14102133
> 
> 赞同：0
> 
> 时间：2012-12-31T13:22:07.237
> 
> 标签：android

在以下情况下，我需要您的帮助。

我有三个复选框 A、B 和 C 以及变量 a。如果我单击复选框 B，a 的值应保持为 2，如果我选中 A，则应将其更改为 3，如果我取消选择，则应返回 2。

如何动态获取？

我正在使用 onCheckedChangeListener ，它仅在我更改复选框的选中状态时更改变量。

任何帮助深表感谢。

几个代码：

ChkBxA 的代码：

```
 ChkBxA.setOnCheckedChangeListener(new OnCheckedChangeListener() {

    public void onCheckedChanged(CompoundButton buttonView,boolean isChecked) 
    {
        if (buttonView.isChecked()) 
        {
            variable_a = 1;
        }
        else 
        {
            variable_a = 0;
        }
    }
}); 
```

ChkBxB 代码：

```
ChkBxB.setOnCheckedChangeListener(new OnCheckedChangeListener() {

    public void onCheckedChanged(CompoundButton buttonView,boolean isChecked) 
    {
        if (buttonView.isChecked()) 
        {
            if(variable_a == 1)
            {
                variable_b = 3;
            }
            else 
            {
                variable_b = 2;

            }
        }
        else 
        {
            variable_b = 0;
        }
    }
}); 
```

问题是当复选框 A 的状态时 variable_a 的值发生变化，variable_b 的值不会改变，因为这是在 checkedChangeListener 中。因此，非常感谢任何克服这一问题的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:31:19.043

创建一个根据选中状态计算值的方法：

```
void CalculateValues(bool CheckBoxA, bool CheckBoxB)
{
  variable_a = CheckBoxA ? 1 : 0;
  variable_b = CheckBoxB? (variable_a==1 ? 3 : 2) : 0;
} 
```

现在只需从两个事件处理程序调用此方法并传递两个复选框的选中状态。事实上，两个复选框的事件处理程序（调用）将是相同的。我不知道如何从 ChkBxA 中检索检查状态，但我们假设这很简单：

```
public void onCheckedChanged(CompoundButton buttonView, boolean isChecked) 
{
  CalculateValues(ChkBxA.IsChecked(), ChkBxB.IsChecked() );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:44:52.880

尽管您的问题尚不清楚，但是在您在以前的答案中发表评论后，我可能找到了解决此问题的方法。

您可以使用 a`stack`来存储当前的复选框值。**TOS**的值将是您的复选框选择值。通过使用`onCheckedChangeListener()`和使用正确的逻辑，您可以更改 TOS [使用`push()`或`pop()`] 的值。我认为您可以使用这种方式获得当前选择或先前选择。

这只是一个想法，你必须实现逻辑:) 祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T13:25:12.703

写下条件...

```
if (isChecked()) //<<===buttonView remove
{
    if(variable_a == 1)
    {
           variable_b = 3;
     }
     else 
     {
           variable_b = 2;

     }
} 
```

# c# - 在异步委托中捕获异常

> ID：14102135
> 
> 赞同：2
> 
> 时间：2012-12-31T13:22:33.753
> 
> 标签：c#, async-await

我有这个代码：

```
 public async Task AsyncMethod()
    {
        await Task.Factory.StartNew(() =>
        {
            throw new Exception();
        });
    }

    public ActionResult Index()
    {
        var t1 = Task.Factory.StartNew(() => { throw new Exception(); });
        var t2 = Task.Factory.StartNew(() => { throw new Exception();});
        var t3 = Task.Factory.StartNew(async () => { await AsyncMethod(); });

        try 
        {
            Task.WaitAll(t1, t2, t3);
        }
        catch (AggregateException ex)
        {
            var count1 = ex.InnerExceptions.Count;
            var count2 = ex.Flatten().InnerExceptions.Count;

            throw;
        }

        return View();
    } 
```

我想了解为什么 count1 和 count2 变量是 2 而不是 3，我怎样才能在 AsyncMethod 中获得第三个异常？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T13:41:32.757

改变这个

```
 var t3 = Task.Factory.StartNew(async () => { await AsyncMethod(); }); 
```

对此：

```
 var t3 = AsyncMethod(); 
```

你已经*有*任务了。无需通过在线程池上执行来包装它。

通过包装它，您可以将`Task`您已经拥有的（最终会出错）转换为`Task<Task>`永远不会出错的（只有它的`Task.Result`错误）。当然`WaitAll`，它对外部任务进行操作，因此它永远不会看到异常。

使用调试器单步执行此类代码以检查所有变量的运行时值是一种很好的技术。以这种方式发现这个错误比仅仅通过查看代码要容易得多（“查看”对我来说就足够了，因为我有这方面的经验 - 但如果我没有经验，我将需要运行这段代码并调试它）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T15:40:44.203

> 我想了解为什么 count1 和 count2 变量是 2 而不是 3，我怎样才能在 AsyncMethod 中获得第三个异常？

`Task.Factory.StartNew`返回一个基本的`Task`. 如果您将`async`委托传递给它，则返回的`Task`仅代表`async`方法的开始（直到它屈服于其调用者）。

您应该使用`Task.Run`代码`async`。`Task.Run`将为委托创建一个`Task`包装器`async`，因此`Task`返回的 from`Task.Run`代表整个`async`方法。

Stephen Toub 有一篇优秀的博客文章详细介绍了[和](http://blogs.msdn.com/b/pfxteam/archive/2011/10/24/10229468.aspx)[之间的区别`Task.Run``Task.Factory.StartNew`](http://blogs.msdn.com/b/pfxteam/archive/2011/10/24/10229468.aspx)。

`Task`此外，正如 usr 所提到的，每当您阻塞而不是`await`在 GUI 或 ASP.NET 上下文中时，都会遇到死锁问题。我有[一篇博文详细介绍了这个死锁问题](http://nitoprograms.blogspot.com/2012/07/dont-block-on-async-code.html)。您应该使用`await Task.WhenAll`而不是`Task.WaitAll`.

因此，这是您应用了两项更改的代码：

```
public async Task AsyncMethod()
{
    await Task.Run(() =>
    {
        throw new Exception();
    });
}

public async Task<ActionResult> Index()
{
    var t1 = Task.Run(() => { throw new Exception(); });
    var t2 = Task.Run(() => { throw new Exception();});
    var t3 = Task.Run(async () => { await AsyncMethod(); });

    try 
    {
        await Task.WhenAll(t1, t2, t3);
    }
    catch (Exception)
    {
        var ex1 = t1.Exception.InnerException;
        var ex2 = t2.Exception.InnerException;
        var ex3 = t3.Exception.InnerException;

        throw;
    }

    return View();
} 
```

# sql-server - 需要一种方法来仅拦截 MSSQL 中的重复键异常

> ID：14102138
> 
> 赞同：6
> 
> 时间：2012-12-31T13:22:54.360
> 
> 标签：sql-server, exception-handling, unique-constraint, duplicate-data

假设您的 MSSQL 2008 数据库中存在唯一索引约束违规，如下所示：

```
Violation of PRIMARY KEY constraint 'PK_ManufacturerCode'. Cannot insert duplicate key in object 'dbo.ManufacturerCode'. The duplicate key value is (8410179) 
```

目前我正在通过胖客户端中的全局异常处理程序处理此异常（使用 ADO 用 Delphi 6 编写，但没关系，我计划将来使用 C#.NET）并且异常消息附加到日志框.

但我想亲自处理这个特定的**重复键**异常，并使用厚客户端自己的文本在客户端中显示适当的错误消息。我可以解析匹配的错误消息，但出于两个原因不会这样做：

*   这不是做这件事的正确方法——最好依靠一些错误代码；
*   胖客户端旨在使用不同语言的各种 MSSQL 服务器版本，这些版本可能有不同的错误文本

使用带有自定义退出代码的 RETURN 或不断调用特殊的存储过程来检查重复项并不会让我感到高兴。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T13:27:05.170

AFAIK，区分重复键异常的唯一方法是解析错误消息。

更好的解决方案是首先防止重复键异常。编写插入不插入重复键，并检查`@@rowcount`是否添加了一行：

```
insert  YourTable
        (id, col1, col2)
select  1, 'a', 'b'
where   not exists
        (
        select  *
        from    YourTable yt2
        where   yt2.id = 1
        )

if @@rowcount = 0
    -- Duplicate key! 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T13:37:32.670

幸运的是，您不必解析文本。A`SqlException`有一个`Number`属性。观察，返回什么号码并匹配它。数字定义明确。您甚至可以在其中一个系统目录表中查看所有这些表（没有方便的名称）。

您最好只捕获一个非常具体的错误，而不是只捕获所有`SqlException`s（例如）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T13:38:15.647

在 ADO 中，您将[`Errors`](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms678380%28v=vs.85%29.aspx)在发生错误后访问连接属性，并检查该`NativeError`属性以获取 SQL Server 特定的错误号。

当您切换到 .NET 时，相同的数字会作为or的`Number`属性公开[`SqlException`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlexception.number.aspx)[`SqlError`](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlerror.aspx)

但是，查找特定的错误号可能有点麻烦 - 对于重复键，它的错误号为 2627。

# actionscript-3 - AS3 Flash CS6 addChild 层设置错误

> ID：14102145
> 
> 赞同：1
> 
> 时间：2012-12-31T13:23:21.977
> 
> 标签：actionscript-3, flash, air

目前我正在尝试创建一个关卡类和一个怪物类，现在在我的 AS 代码中创建了关卡，然后创建了怪物，但是怪物似乎被放在了关卡图形的顶部，我想要怪物在它们生成并移动到中间屏幕时位于图形下方，

此代码在文件开头运行

```
addChild( levelStage ); 
```

创建 levelStage 时，也会运行此代码

```
addChild( newMonster ); 
```

现在怪物在 levelStage 图形的顶部，我希望怪物图形在下面，我是否应该创建一个名为 monsterManager 的新类，它将首先添加到舞台上，然后以这种方式生成怪物？还是不能解决我的问题？

帆布

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:51:09.947

您需要管理显示列表

从这里开始：[http ://www.republicofcode.com/tutorials/flash/as3displaylist/](http://www.republicofcode.com/tutorials/flash/as3displaylist/)

但现在一个简单的解决方案是更改 addChild(newMonster); 到

```
addChildAt( newMonster, 0 ); 
```

它将它放在显示列表的底部，位于其他所有内容之后。要查看它，您需要使用 swapChild。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:02:39.710

我建议在添加 levelStage 之前添加一个 monsterLayer。然后将你的怪物添加到 monsterLayer。

```
var monsterLayer:Sprite = new Sprite;
addChild(monsterLayer);
addChild(levelStage);

// when adding monsters 
monsterLayer.addChild(newMonster); 
```

# haskell - Rand 的 MonadParallel 实例

> ID：14102146
> 
> 赞同：7
> 
> 时间：2012-12-31T13:23:29.543
> 
> 标签：haskell, random, parallel-processing

我目前正在处理`ReaderT r (Rand StdGen) a`我想并行运行的计算。我遇到了[Monad Parallel](http://hackage.haskell.org/package/monad-parallel)，它似乎会做我想做的事。

已经有一个 MonadParallel for 的实例，但我必须从[monad-random](http://hackage.haskell.org/package/MonadRandom)`ReaderT`创建自己的 for 。但是，我不确定我做对了。我对 Haskell 中的并行编程不太熟悉，但我相信在并行中运行计算应该给出与正常运行时相同的值。因为我为 Rand 使用的 bindM2 实例（因此从同一个初始生成器获得了一组不同的随机数），所以我的实例并非如此。`Rand``split`

```
instance P.MonadParallel (Rand StdGen) where
    bindM2 f ma mb = do
        split1 <- getSplit
        split2 <- getSplit
        let a = evalRand ma split1
        let b = evalRand mb split2
        a `par` b `pseq` f a b 
```

虽然我觉得有理由忽略这一点（数字仍然是随机的，对吗？）我也忍不住觉得我错过了一些东西。这没问题还是有更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-30T08:28:40.120

我主要担心的是这违反了以下保证：

> 除了可能的副作用排序之外，这个函数等价于`\f ma mb-> do {a <- ma; b <- mb; f a b}`

这些会有不同的结果：

```
let g = mkStdGen 0
    r = evalRand (do x <- getRandom
                     y <- getRandom
                     return (x, y)) g 
```

对比

```
let g = mkStdGen 0
    r = evalRand (P.bindM2 (\x y -> return (x,y)) getRandom getRandom) g 
```

这确实引发了一些有趣的问题`split`，例如伪随机数以及随机数在纯度方面的性质。我很难想象您的实例会产生不利影响的情况，但是软件系统的复杂性从未停止让我感到惊讶。`bindM2`因此，即使是随机数，我也不会违反对 的期望。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-30T13:04:24.653

`MonadParallel`'s中存在一个固有的问题`bindM2`。它的文档说：

> 并行执行两个一元计算；当它们都完成后，将结果传递给函数。*除了可能的副作用排序之外，*这个函数等价于`\f ma mb-> do {a <- ma; b <- mb; f a b}`

问题在于，在单子计算中（与应用函子不同） ，**值可能取决于 effects**以及它们的顺序。所以这个要求没有多大意义。考虑

```
do
  a <- getCurrentTime -- from Date.Time
  b <- getCurrentTime
  return (a <= b) 
```

这总是返回`True`，但如果你重新排序效果，它将开始返回`False`。显然，通过并行化这两个计算，你会得到一个非常不确定的结果。

所以很难解读其意图`bindM2`。我想说我们可以将实例`MonadParallel`分为两类：

1.  那些真正具有确定性且`bindM2`始终等于 的`\f ma mb-> do {a <- ma; b <- mb; f a b}`。也就是说，效果的顺序不会改变。这些实现通常使用 定义`par`，它不会改变程序的语义，只会并行运行一些部分。
2.  那些确实依赖于效果排序的，因此`bindM2`可以与 任意不同`\f ma mb-> do {a <- ma; b <- mb; f a b}`。似乎目前唯一这样的实例是`IO`，它用于`forkIO`为其中一个计算生成一个新线程。

因此，您是否接受您`bindM2`作为有效实例取决于您如何解释文档。如果您认为 (2.) 无效，那么您的实现也是无效的（您也应该拒绝`IO`）。如果您将 (2.) 解释为有效，那么您不必担心。

# visual-studio-2012 - 在 Visual Studio 2012 中导出和导入测试结果

> ID：14102147
> 
> 赞同：7
> 
> 时间：2012-12-31T13:23:36.833
> 
> 标签：visual-studio-2012

在 Visual Studio 2010 中，我可以导出/导入“测试运行结果”

我如何在 Visual Studio 2012 中做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-07T11:48:29.683

您现在无法使用 VS2012 导出测试结果。可用的替代方法是 a) 将测试资源管理器的内容复制粘贴到记事本中 b) 在命令行上通过 vstest.console.exe 使用 /logger:trx 标志运行测试以生成 .trx 文件。

一旦你有了一个 .trx 文件，它在 VS 中仍然是一个有效的文件，你会在测试结果窗口中看到你的结果。

# soa - 什么是不可知的服务

> ID：14102156
> 
> 赞同：7
> 
> 时间：2012-12-31T13:24:03.600
> 
> 标签：soa

我正在阅读有关 SOA 原则和模式的信息，但我无法理解什么是不可知的服务。你有什么直截了当的定义吗？是什么概念和用法？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T18:37:17.100

[在Agnostic/non-agnostic revisited](http://soa-ind.blogspot.com/2011/02/agnosticnon-agnostic-revisited.html)中可以找到一个很好的解释 ：

> (i) 不可知的服务**不知道它们被调用的上下文**，也不知道服务的实现方式、平台、技术等。
> 
> (ii) 非不可知的服务**可以具有一种或多种形式的耦合或上下文**（即过程功能上下文）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-07T12:18:53.640

不可知论服务本质上是通用的/它独立于上下文。服务是一种通用化的东西，可以在各种系统之间进行互操作。

一种自包含的自治服务。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-31T13:33:24.300

我认为这意味着实现任何可以向其发出 HTTP 请求的语言都可以使用的服务。实现语言可以是您的选择 - Java、.NET、Python 或其他任何语言。对客户也一样。

# xpath - 多节点树选择器 xpath 过滤器

> ID：14102157
> 
> 赞同：0
> 
> 时间：2012-12-31T13:24:06.370
> 
> 标签：xpath, umbraco

我在编写允许我从当前类别中选择节点的 xpath 表达式时遇到问题。简而言之，我有 products 文件夹，这个文件夹包含 categories ， categories 包含产品。我的意图是只从我当前位置的树选择器的类别中选择产品。例如，我在名为计算机的类别中，因此我必须能够仅从该类别中选择产品。

任何想法 ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T21:29:15.637

您可以尝试使用 $currentPage 变量作为 XPath 表达式的起点。类似于以下示例的内容在我脑海中浮现，未经测试，但值得一试：

```
$currentPage//product 
```

或者

```
$currentPage/descendant-or-self::Product 
```

如果您发布您当前的 XPath 表达式，它还可以帮助其他人了解您已经在哪里，并提供更具体的帮助。

# android - 如何更新封装在 Framelayout 中的表面视图？

> ID：14102158
> 
> 赞同：1
> 
> 时间：2012-12-31T13:24:07.210
> 
> 标签：android, camera, draw, surfaceview, android-framelayout

我有一个表面视图更新问题。我想创建一个轻量级的增强现实应用程序，所以我做了一个框架布局，后面有camerapreview，前面有一个扩展的surfaceview。

```
alParent = new FrameLayout(this);
        alParent.setLayoutParams(new LayoutParams(
                LayoutParams.FILL_PARENT,
                LayoutParams.FILL_PARENT));

        // Create a new camera view and add it to the layout
        cv = new CameraPreview(this,c);
        alParent.addView(cv);

        // Create a new draw view and add it to the layout
        dv = new DrawView(this);
        dv.reDraw();
        alParent.addView(dv); 
```

之后，我可以在相机图片上画一个圆圈，这很棒：

```
public class DrawView extends SurfaceView 
```

{

```
private Paint textPaint = new Paint();
int x;
int y;
public DrawView(Context context) {

    super(context);

    // Create out paint to use for drawing
    textPaint.setARGB(255, 255, 255, 10);
    textPaint.setTextSize(60);
    x=100;
    y=100;
    /* This call is necessary, or else the 
     * draw method will not be called. 
     */
    setWillNotDraw(false);
}

@Override
protected void onDraw(Canvas canvas){
    // A Simple Text Render to test the display
    canvas.drawText("Sunfinder", 50, 50, textPaint);
    canvas.drawCircle(x, y, 30, textPaint);
} 
```

问题是，我想改变 x 和 y，并经常重画圆圈。我已经知道我必须使用这样的东西：

```
protected void reDraw()
{
    x+=10;
    SurfaceHolder surfaceHolder;
    surfaceHolder = getHolder();
     if(surfaceHolder.getSurface().isValid())
    {onDraw(surfaceHolder.lockCanvas());}
     else System.out.println("problem");
} 
```

（注意这是一个测试圆圈是否移动的例子）我的问题是如何以及在哪里调用这个函数？我认为这是由框架布局引起的复杂。

如果我在我首先复制的活动中调用它（dv.redraw），我得到一个空指针异常。无论如何，是否可以在活动中有一个while循环来一直调用这个函数？我知道在一个线程中会更好，但是框架布局把它搞砸了。感谢您的阅读和任何帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T10:02:33.013

我找到了一个解决方案：

我必须使用 invalidate() 函数，并覆盖该`ondraw()`方法。

所以下面的链接将重绘和更新屏幕。它不会改变 cv 在 a 中的 a `Framelayout`。

```
public void onSensorChanged(SensorEvent event)
{ 
    dv.invalidate(); 
} 
```

希望它可以帮助某人！

# html - 向基于 css 的水平菜单添加活动状态而不显示子菜单

> ID：14102160
> 
> 赞同：0
> 
> 时间：2012-12-31T13:24:22.457
> 
> 标签：html, css, drop-down-menu, html-lists

[我已经根据我的需要修改了示例中的](http://www.lwis.net/free-css-drop-down-menu/)线性菜单显示到目前为止我没有任何问题，除了我无法找到一种方法来显示与页面加载时特定页面相关的菜单，或者换句话说我想添加一个活动的状态为`li`& 基于它的父菜单显示 thouse 子菜单。

假设如果用户点击`About Us`链接，那么它应该默认显示菜单。

这是我在[jsFiddle上的示例](http://jsfiddle.net/ym5PJ/)

我的问题让读者感到困惑，我只需要在页面加载时显示特定页面的菜单我需要对 css 进行哪些更改，以便我可以在 jquery 的帮助下显示子菜单，可能仅使用 css。

我尝试了几件事，但最终搞砸了整个..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:40:55.957

我会向列表元素添加一个 .active 类，它是当前显示的页面，而不是子菜单无序列表（因为从语义上讲，它是处于活动状态的页面，而不是它的子菜单）。因此，在您的标记中，您将 `<li class="active"><span class="dir"><a href="ultimate.linear-active.html">About Us</a></span> ....`在样式表中添加

```
li.active > ul {
  visibility: visible;
} 
```

​ 然后您可以相应地设置当前页面选项卡的样式，使用`li.active`.

# c++ - 如何使用 C 中的 WINAPI 创建具有多个任何类型的参数的线程？

> ID：14102161
> 
> 赞同：-5
> 
> 时间：2012-12-31T13:24:22.253
> 
> 标签：c++, multithreading, winapi, cross-platform

我正在开发一个多线程套接字库（与平台无关）。目前我正在使用 WINAPI 在 Windows 上开发它来创建线程，尽管我需要将库移植到 Linux。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T13:26:40.660

如果您的程序需要在 Linux 和 win32 上编译，我不会将代码移植到 pthreads 或一些 Win32 线程包装器。

我会使用 std::thread

```
 std::thread th ( my_func, arg1, arg2...); 
```

# jquery - 用于 jquery 操作的图像的自定义映射

> ID：14102172
> 
> 赞同：0
> 
> 时间：2012-12-31T13:25:55.507
> 
> 标签：jquery, html, css, graphic-design

我正在做一个网站。我正在使用一些 jquery 来执行不同的操作。

我的背景图片有一个中央气球。在背景图像之上，我放置了四个不同的图像。这些也是气球形状的。如果有人点击这些小气球，我会执行某些 jquery 操作。现在我想如果一个人点击中央气球之外的背景图像而不是小气球，我想触发一个 jquery 脚本。

我被困在如何选择这个可点击区域上。在我搜索过的互联网上的任何地方，他们都告诉我要制作一个矩形可点击区域。这不是我需要的。我可以使用许多微矩形来实现我的目的，但这是非常粗糙的方法。

有人可以告诉我一些优雅的方法吗？我附上将详细说明问题的图像。

非常感谢

![在此处输入图像描述](../Images/a2b4ee1f62be85f06557a8ad6af3db28.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T13:45:28.687

我建议你这样做：

1.  [使用Inkscape](http://inkscape.org/download/)创建图像映射。此工具将允许您直观地选择图像中您希望可点击的区域（或对其他事件做出反应，例如*mouseover*）。一旦你这样做了，它会生成带有坐标的标签，你只需要复制粘贴到你的 html 页面中。
2.  下载[maphilight jquery 插件](http://davidlynch.org/projects/maphilight/docs/)，它将使您能够将*click*、*mouseover*、*mouseout*和其他事件绑定到您喜欢的某些区域并执行相应的操作。

将点击事件绑定到所有四个气球后，它将正常工作。关于点击气球以外的背景的其他部分，您可以将*点击*处理程序绑定到整个图像，一旦点击，您检查 event.target 是否是气球。如果不是气球，用户点击气球外的背景。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:48:31.160

使用[图像映射](http://en.wikipedia.org/wiki/Image_map)。它是 HTML[标准](http://www.w3.org/html/wg/drafts/html/master/embedded-content-0.html#the-map-element)的一部分。有许多免费的在线工具可以轻松创建图像地图，只需 Google 一下。我个人最喜欢的是[这个](http://www.maschek.hu/imagemap/imgmap)。

然后您可以像往常一样将事件绑定到`<area>`标签。maphilight [jQuery 插件](http://davidlynch.org/projects/maphilight/docs/)为悬停状态添加了很好的触感。

进一步阅读：

*   [`<map>`MDN 上的元素](https://developer.mozilla.org/en-US/docs/HTML/Element/map)
*   [HTML 教程 - 图像映射](http://www.howtocreate.co.uk/tutorials/html/imagemaps)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T17:45:58.403

给你的气球图像一些通用类（让 balloonImg），现在使用 jquery 你可以像这样在你的 html 上点击事件。

```
var htmlClickFun=function(e){
    if(!$(e.target).is('.balloonImg')){
   //your code
};

$('html').click(htmlClickFun); 
```

然而，在 html 和 body 上添加事件并不是一个好主意。因此，如果您将任何事件添加到整个 html 中，则必须`$('html').unbind('click',htmlClickFun);` 在不需要时取消绑定。

检查[http://jsfiddle.net/tAhV2/](http://jsfiddle.net/tAhV2/)

# azure - 检测 *last* 角色实例何时在 Azure 上关闭

> ID：14102175
> 
> 赞同：3
> 
> 时间：2012-12-31T13:26:07.650
> 
> 标签：azure, servicebus, azure-role-environment

我知道有用于检测角色实例何时关闭或启动的*事件*`RoleEnvironment`，但是，有没有办法检测*最后一个*角色实例何时关闭？（即整个角色正在关闭）

 **我意识到这在硬件崩溃的情况下不会完全证明，但是当角色被终止以摆脱不再需要的服务总线订阅时，我需要做一些清理工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:53:17.083

一个想法：如果您`OnStop()`的角色实例中有一个事件处理程序，您可以枚举角色的实例 ( `RoleEnvironment.CurrentRoleInstance.Role.Instances`) 以查看它是否是列表中唯一的一个。这可能有点问题，因为两个实例可能同时处理`OnStop()`，但它至少应该让你朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T16:17:32.910

注意：这里最初的选择只是理论上的：我没有尝试过。

另一种选择是让代码在启动和关闭时获得一个 BLOB 的租约，该 BLOB 包含卷的所有实例的名称。当一个实例启动时，它会获得一个租约并查看列表是否已经包含它的名称。如果列表中没有它添加到列表中的实例名称，则保存并释放 BLOB 上的租约。

在运行 OnStop 时关闭每个实例可以获取列表，然后删除它自己的名称，并且它还可以使用 David 提到的 RoleEnvironment.CurrentRoleInstance.Role.Instances 集合进行快速检查以“清除”任何实例名称那可能现在已经死了，但没有机会自己清理。如果在您完成时列表为空，那么您就是最后一个实例。

我仍然认为这不是万无一失的，但至少它解决了 David 提到的问题，因为一次只有一个客户可以在 BLOB 上获得租约。它仍然在很大程度上依赖于 Instances 集合，这些集合有时可能会不断变化。

在我看来，更好的方法是使用完全在角色本身之外的东西，它使用服务管理 API 来确定角色是否正在运行，如果没有，则执行清理。当然，在删除订阅之前，您需要做一些额外的检查以 100% 确定角色已关闭，因为有些人不时报告来自 API 的数据不准确/冲突。至少应该使用角色本身之外的某种机制来向您提供警告，表明您的关闭代码可能不起作用。一些为您监控 Azure 服务的第三方提供商甚至可以检测到该角色已关闭并让您运行脚本。**

# php - 更新头像并删除当前头像。PHP MySQL

> ID：14102176
> 
> 赞同：0
> 
> 时间：2012-12-31T13:26:16.887
> 
> 标签：php, mysql

是否可以在 PHP 中更新个人资料图片并从文件夹中删除当前图片及其从数据库中的链接？

如果是，请帮助：我设法从数据库中删除了链接，但文件夹中的图片仍然存在。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T13:27:00.817

使用[取消链接](http://php.net/manual/en/function.unlink.php)功能。

```
//before deleting the path from database, get it in one variable using php
$filename = path from database;
unlink($filename); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:30:20.743

PHP`unlink`函数用于从目录中删除现有文件

```
$filename = 'define file name here with proper path';
unlink($filename); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T08:29:15.053

假设您有一个名为 Images 的文件夹，您将图片上传到该文件夹​​中，因此在该文件夹中有一个名为 test.jpg 的图像。此代码将删除文件夹中的该图像。@David Rabinowitz 感谢他给了他一个使用数据库的好答案，但我也试图给他第二个不使用数据库的例子，也许它也会帮助他

```
<?php 
$file ="test.jpg";
$filedel="images/".$file;
if(file_exists($file)){
echo "file exits";
unlink($filedel);
else{
echo "the file you want to delete does nto exist ";
}
?> 
```

# django - get_absolute_url 在 Django 中不起作用

> ID：14102191
> 
> 赞同：0
> 
> 时间：2012-12-31T13:27:53.293
> 
> 标签：django

模型：

```
class Car(models.Model):
    name = models.CharField(max_length=10, unique=True)
    def __unicode__(self):
            return self.name
    def get_absolute_url(self):
        return reverse('cars.views.car', args=[str(self.id)]) 
```

看法：

```
def car(request):
    all_cars = Car.objects.all().filter(active=1).values('id', 'name')
    return render(request, 'car.html', {'all_cars': all_cars}) 
```

网址映射：

```
url(r'^car/$', 'cars.views.car'), 
```

在`car.html`，我正在使用：

```
<li><a href="{{ car.get_absolute_url }}">{{ car.name }}</a></li> 
```

但它没有打印/car/N/，只有/car/。如何解决？有了[这个](https://docs.djangoproject.com/en/dev/ref/models/instances/?from=olddocs#get-absolute-url)( `<!-- BAD template code. Avoid! -->`) 它可以工作，但不能与`get_absolute_url`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T13:31:39.073

您的 URL 模式不接受任何参数，因此 django 无法生成带有参数的 URL！

```
url(r'^car/$', 'cars.views.car'), # Where would django add the parameter?! 
```

应该：

```
url(r'^car/(?P<car_id>\d+)/$', 'cars.views.car'), 
```

但是您的`car`视图将不起作用，因为它看起来像是列出了汽车。

您可能需要两个 URL：一个用于汽车列表，一个用于特定汽车。他们需要映射到两个不同的视图：

```
url(r'^car/$', 'cars.views.list_cars'), # List of all cars.
url(r'^car/(?P<car_id>\d+)/$', 'cars.views.view_car'), # View a specific car, map get_aboluste_url to this view. 
```

* * *

在旁注中，您应该查看[通用视图](https://docs.djangoproject.com/en/dev/topics/class-based-views/)，它们会使整个过程更简单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:39:34.733

您可以拥有一个可以完全满足您的两个要求的 url，但这取决于模板的结构（您如何扩展子模板）。让它工作：

```
url(r'^car/(?:(?P<car_id>\d+)/)?$', 'cars.views.car', name="car_url"),
# you notice i have make car_id optional 
```

现在你的观点应该是：

```
def car(request, car_id=None):
    if car_id:
        # just get a single car
        all_cars = Car.objects.filter(active=1, pk=car_id).values('id', 'name')
    else:
        # get all cars
        all_cars = Car.objects.filter(active=1).values('id', 'name')
    return render(request, 'car.html', {'all_cars': all_cars}) 
```

在模板中使用[url 标签](https://docs.djangoproject.com/en/dev/ref/templates/builtins/?from=olddocs#url)进行 url 解析：

```
<li><a href="{% url car_url car_id=car.id %}">{{ car.name }}</a></li> 
```

对于列表 url，请不要通过`car_id`：

```
<li><a href="{% url car_url %}">Browse Cars</a></li> 
```

# android - “adb devices”无法识别我的 G-Tide E56

> ID：14102194
> 
> 赞同：0
> 
> 时间：2012-12-31T13:28:24.080
> 
> 标签：android, adb

我有一个运行 android 2.3.9 的 G-Tide E56 “adb devices”命令找不到我的设备，我已经尝试了我为其他设备找到的所有解决方案，但仍然没有结果，因为我找不到关于 G-Tide E56 的单一答案。任何人都可以点我开始。我正在使用运行 OSX 10.7.4 的 mac

我尝试过的事情：
1.检查设备上启用的USB调试
2.更新adb
3.重新启动adb（kill-server，start-server）

USB 大容量存储工作正常，所以我确定 USB 端口没有问题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:34:28.557

1.  确保在设备上启用了 USB 调试
2.  Windows 键 + R ->`devmgmt.msc`
3.  找到连接的设备并右键单击
    1.  更新驱动程序软件
    2.  浏览...
    3.  让我挑...
    4.  下一个...
    5.  有磁盘...
    6.  %AndroidSKDLocation%`/extras/google/usb_driver/android_winusb.inf`
    7.  打开

看看这是否有效，这将尝试使用 Android SDK 默认 ADB 驱动程序。

**编辑**如果 USB 连接设置为类型`MTP`/ ，我的 DROID4 将仅在 ADB 连接模式下工作，因此请尝试更改 USB 连接模式并在每个模式下`Media Device`运行。`adb devices`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:37:51.733

您是否尝试过打开 adb.exe 并单击它。它的运行速度将比 dissapear 为我工作一次要快。Aldo 另一次我不得不进入任务管理器并杀死当前正在运行的 adb

USB 驱动程序可以在您的 sdk 管理器中的 extras 下找到

# python - 熊猫列加法/减法

> ID：14102195
> 
> 赞同：11
> 
> 时间：2012-12-31T13:28:27.133
> 
> 标签：python, pandas

我正在使用熊猫/python 数据框。我正在尝试进行滞后减法。

我目前正在使用：

```
newCol = df.col - df.col.shift() 
```

这导致第一个位置出现 NaN：

```
NaN
45
63
23
... 
```

第一个问题：这是做这样的减法的最好方法吗？

第二：如果我想在这个新列中添加一列（相同的行数）。有没有一种方法可以让所有 NaN 的 0 用于计算？

前任：

```
col_1 = 
Nan
45
63
23

col_2 = 
10
10
10
10

new_col = 
10
55
73
33 
```

并不是

```
NaN
55
73
33 
```

谢谢你。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-31T14:41:17.433

我认为您计算滞后的方法很好：

```
import pandas as pd
df = pd.DataFrame(range(4), columns = ['col'])

print(df['col'] - df['col'].shift())
# 0   NaN
# 1     1
# 2     1
# 3     1
# Name: col

print(df['col'] + df['col'].shift())
# 0   NaN
# 1     1
# 2     3
# 3     5
# Name: col 
```

如果您希望`NaN`加（或减）一个数字是数字（不是`NaN`），请使用`add`（或`sub`）方法`fill_value = 0`：

```
print(df['col'].sub(df['col'].shift(), fill_value = 0))
# 0    0
# 1    1
# 2    1
# 3    1
# Name: col

print(df['col'].add(df['col'].shift(), fill_value = 0))
# 0    0
# 1    1
# 2    3
# 3    5
# Name: col 
```

# java - 为什么 Java 接口方法参数需要声明 ID？

> ID：14102196
> 
> 赞同：3
> 
> 时间：2012-12-31T13:28:42.530
> 
> 标签：java, interface, named-parameters

这个问题总结了一下。

在 C++ 中，您可以使用仅包含类型的参数列表来声明接口方法，但在 Java 中，您需要将变量名与类型相关联。我知道这会增加可读性，但如果这是可选的，那就太好了。参数名称甚至不必与实现名称匹配，那么为什么还要在接口中命名它们呢？

```
public interface Foo() {
  setName(String, String) // Why can't this be enough?
}

public class FooImpl implements Foo {
  private String name = "";

  @override
  setName(String fname, String lname) {
    this.name = String.format("%s %s", fname, lname);
  }
} 
```

# java - 如何通过 android 2.3.6 中的联系人提供者获取联系人照片？

> ID：14102201
> 
> 赞同：4
> 
> 时间：2012-12-31T13:29:07.090
> 
> 标签：java, android, android-contacts

我有这个适用于 android 4 的版本（`String email`是一个 gmail 地址）：

```
private Uri getPhotoUriFromEmail(String email) {
    Uri u = null;
    String[] projection = { ContactsContract.CommonDataKinds.Email.PHOTO_URI };
    String photoUri;
    ContentResolver cr = context.getContentResolver();
    Cursor emailCur = cr.query(ContactsContract.CommonDataKinds.Email.CONTENT_URI, projection,
            ContactsContract.CommonDataKinds.Email.ADDRESS + " = ?", 
            new String[]{email}, null);
    if (emailCur.moveToNext()) { 
        photoUri = emailCur.getString(
                emailCur.getColumnIndex(ContactsContract.CommonDataKinds.Email.PHOTO_URI));
        u = Uri.parse(photoUri);
    }
    return u;
} 
```

它的 2.3.6 版本是什么？（当我将 API 8 设置为我的最小 API 支持时，android SDK 也不应该警告我使用 API 11 吗？因为它没有......）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:21:49.240

`ContactsContract.CommonDataKinds.Email.PHOTO_URI` 您可以在不使用这种方式的情况下获取联系人照片 uri ：

```
private Uri getPhotoUriFromEmail(String email) {
    Uri u = null;
    String[] projection = { ContactsContract.CommonDataKinds.Photo.CONTACT_ID };
    String photoUri;
    ContentResolver cr = getContentResolver();
    Cursor emailCur = cr.query(ContactsContract.CommonDataKinds.Email.CONTENT_URI, 
            projection,
            ContactsContract.CommonDataKinds.Email.ADDRESS + " = ?",
            new String[]{email}, null);
    if (emailCur.moveToNext()) {
        int columnIndex = emailCur.getColumnIndex(
                              ContactsContract.CommonDataKinds.Photo.CONTACT_ID);
        long contactId = emailCur.getLong(columnIndex);

        u = ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI, 
                                       contactId);
        u = Uri.withAppendedPath(u, 
                                ContactsContract.Contacts.Photo.CONTENT_DIRECTORY);
    }
    return u;
} 
```

或者，您可以通过以下方式获取照片流`ContactsContract.Contacts .openContactPhotoInputStream(ContentResolver, Uri)`：

```
private InputStream getPhotoInputStreamFromEmail(String email) {
    Uri u = null;
    String[] projection = { ContactsContract.CommonDataKinds.Photo.CONTACT_ID };
    String photoUri;
    ContentResolver cr = getContentResolver();
    Cursor emailCur = cr.query(ContactsContract.CommonDataKinds.Email.CONTENT_URI,
            projection,
            ContactsContract.CommonDataKinds.Email.ADDRESS + " = ?",
            new String[]{email}, null);
    if (emailCur.moveToNext()) {
        int columnIndex = emailCur.getColumnIndex(
                ContactsContract.CommonDataKinds.Photo.CONTACT_ID);
        long contactId = emailCur.getLong(columnIndex);

        u = ContentUris.withAppendedId(ContactsContract.Contacts.CONTENT_URI,
                contactId);
        return ContactsContract.Contacts.openContactPhotoInputStream(cr, u);
    }
    return null;
} 
```

# ios - UIbutton图像更改为默认值

> ID：14102202
> 
> 赞同：0
> 
> 时间：2012-12-31T13:29:11.070
> 
> 标签：ios, uibutton

我有一个 Uibutton 并设置了它的默认背景图像，我在运行时更改了它的图像，但我想保留选定的图像。但每次我点击 uibutton 图像更改为默认值。这是代码

```
- (void)changeColorOnRuntTime:(UIColor *)color{

    [btnTmpForColorPicker setBackgroundImage:[self imageNamed:@"customColor.png" withTint:color] forState:UIControlStateNormal];
    [btnTmpForColorPicker setBackgroundImage:[self imageNamed:@"customColor.png" withTint:color] forState:UIControlStateHighlighted];

//    [btnTmpForColorPicker seti];
//    tmpColor = [UIColor alloc]ini;
    tmpColor = [color copy];
//    NSUserDefaults* defaults = [NSUserDefaults standardUserDefaults];
//    [defaults setValue:color forKey:@"CustomPreColor"];

[[NSUserDefaults standardUserDefaults] setObject:[NSKeyedArchiver archivedDataWithRootObject:color] forKey:@"CustomPreColor"];

} 
```

并在 btnHandler

```
if (popOverColorPicker.popoverVisible) {
                [popOverColorPicker dismissPopoverAnimated:YES];
            }
            else
            {
            sdViewController = [[SDColorPickerViewController alloc]init];
            sdViewController.color = [UIColor whiteColor];
            sdViewController.tag = 1;
            sdViewController.delegate = self;
        //    CGRect rect = CGRectMake(viewController.view.frame.origin.x, viewController.view.frame.origin.y, viewController.view.frame.size.width, 380);
            //   viewController.view.frame = rect;
                btnTmpForColorPicker = (UIButton*)sender;
            UIButton *senderbt = (UIButton*) sender;
                if (tmpColor) {
                    [btnTmpForColorPicker setBackgroundImage:[self imageNamed:@"customColor.png" withTint:tmpColor] forState:UIControlStateNormal];
                     [btnTmpForColorPicker setBackgroundImage:[self imageNamed:@"customColor.png" withTint:tmpColor] forState:UIControlStateHighlighted];
                }

     //       [popOverColorPicker setPopoverContentSize:CGSizeMake(viewController.view.frame.size.width, 380)];
            popOverColorPicker = [[UIPopoverController alloc]initWithContentViewController:sdViewController];
                [popOverColorPicker setPopoverContentSize:CGSizeMake(300, 390)];
            [popOverColorPicker presentPopoverFromRect:senderbt.frame inView:self permittedArrowDirections:UIPopoverArrowDirectionDown animated:YES]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T17:42:43.470

替换这个：

```
[btnTmpForColorPicker setBackgroundImage:[self imageNamed:@"customColor.png" withTint:color] forState:UIControlStateHighlighted]; 
```

有了这个：

```
[btnTmpForColorPicker setBackgroundImage:[self imageNamed:@"customColor.png" withTint:color] forState:UIControlStateHighlighted] || UIControlStateSelected]; 
```

并对 btnHandler 按钮应用相同的更改

# android - 恢复我的密钥库的密码

> ID：14102204
> 
> 赞同：6
> 
> 时间：2012-12-31T13:29:17.957
> 
> 标签：android, passwords, keystore

我丢失了密钥库的密码。我下载了一个jar库休闲地址。 [http://code.google.com/p/android-keystore-password-recover/wiki/HowTo](http://code.google.com/p/android-keystore-password-recover/wiki/HowTo)

但是这个应用程序搜索每个目标。我知道，我的密码是 13 个字符，我没有使用特殊字符。

有没有办法找到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-05-04T13:49:22.060

正如您原始问题的评论中所述，这可能需要一段时间。

我还制作了一个密钥库暴力破解程序，您可以使用该程序配置要用于搜索的字符。

您可以从这里获取源代码并根据需要进行修改：[https ://github.com/bes/KeystoreBrute](https://github.com/bes/KeystoreBrute)

更改此文件的构造函数以限制搜索中使用的字符[https://github.com/bes/KeystoreBrute/blob/master/src/se/bes/br/Breaker.java](https://github.com/bes/KeystoreBrute/blob/master/src/se/bes/br/Breaker.java)

您使用的字符越少，运行速度就越快。

我还建议您使用 13 的 startdepth，因为您知道密码的长度。

狩猎愉快！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-25T04:52:04.813

**2018 最新工作答案**

搜索文件夹 **.gradle**

在它下面转到最新的文件夹，在我的情况下它是**4.6**

转到**任务历史**文件夹

在它下面打开**taskHistory.bin**文件

在该文件中搜索**密码关键字**

您最终会找到该密钥库文件的存储密码。

参考截图。

[![在此处输入图像描述](../Images/220c54469ba33a9f67579f3fd8fde9b3.png)](https://i.stack.imgur.com/U4bLI.png)

[![在此处输入图像描述](../Images/9367a96e6f4d60cdc017bc400e3699ef.png)](https://i.stack.imgur.com/nK3Ej.png)

# iphone - iOS 自动布局在更新前有延迟

> ID：14102206
> 
> 赞同：2
> 
> 时间：2012-12-31T13:29:31.210
> 
> 标签：iphone, ios, ios6, autolayout

我正在尝试在我的应用程序中使用自动布局。我有一个按钮，当它被按下时会改变 UIView 的大小和位置。

我使用下面的代码，但布局没有立即更新。在 UI 更新之前有大约 20 秒的延迟。如果我将代码放入 viewDidLoad 但是它会在视图出现时立即出现。

有没有强制更新布局的方法？

```
NSArray *constraintArray = [NSLayoutConstraint constraintsWithVisualFormat:@"V:[_response]-335-|" options:NSLayoutFormatDirectionLeadingToTrailing metrics:nil views:viewDictionary];

[self.view addConstraints:constraintArray];
[self.view setNeedsUpdateConstraints];

[UIView animateWithDuration:0.2 animations:^{
    [self.view layoutIfNeeded];
}]; 
```

# email - Mule ESB：如何根据主题或发件人过滤电子邮件？

> ID：14102207
> 
> 赞同：3
> 
> 时间：2012-12-31T13:29:33.363
> 
> 标签：email, filter, header, esb, mule

我是 Mule 3.3 的新手，如果发件人字段和主题字段包含某些关键字，我正在尝试使用它从 POP3 服务器检索电子邮件并下载 CSV 附件。我已经使用了 Mulesoft 网站上提供的示例，并且成功地扫描了我的收件箱中的新电子邮件，并且只下载了 CSV 附件。但是，我现在卡住了，因为我不知道如何按主题和发件人字段过滤电子邮件。

在做一些研究时，我遇到了一个可以应用于端点的*消息属性过滤器模式*标签，但我不确定将它应用到哪个端点，传入或传出。这两种方法似乎都不起作用，我找不到一个像样的例子来展示如何使用这个标签。我要实现的基本算法如下：

```
if email is from "Bob"
  if attachment of type "CSV"
    then download CSV attachment

if email subject field contains "keyword"
  if attachment of type CSV
    then download CSV attachment 
```

这是我到目前为止的 Mule xml：

```
<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:file="http://www.mulesoft.org/schema/mule/file" xmlns:pop3s="http://www.mulesoft.org/schema/mule/pop3s" xmlns:pop3="http://www.mulesoft.org/schema/mule/pop3" 
xmlns="http://www.mulesoft.org/schema/mule/core" 
xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" 
xmlns:spring="http://www.springframework.org/schema/beans" version="CE-3.3.1" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="
http://www.mulesoft.org/schema/mule/pop3s http://www.mulesoft.org/schema/mule/pop3s/current/mule-pop3s.xsd 
http://www.mulesoft.org/schema/mule/file http://www.mulesoft.org/schema/mule/file/current/mule-file.xsd 
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-current.xsd 
http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd 
http://www.mulesoft.org/schema/mule/pop3 http://www.mulesoft.org/schema/mule/pop3/current/mule-pop3.xsd ">

<expression-transformer expression="#[attachments-list:*.csv]" 
   name="returnAttachments" doc:name="Expression">
</expression-transformer>

<pop3s:connector name="POP3Connector" 
    checkFrequency="5000" 
    deleteReadMessages="false" 
    defaultProcessMessageAction="RECENT" 
    doc:name="POP3" 
    validateConnections="true">
</pop3s:connector>

<file:connector name="fileName" doc:name="File">
    <file:expression-filename-parser />
</file:connector>

<flow name="incoming-orders" doc:name="incoming-orders">

    <pop3s:inbound-endpoint user="my_username" 
        password="my_password" 
        host="pop.gmail.com" 
        port="995" 
        transformer-refs="returnAttachments"
        doc:name="GetMail" 
        connector-ref="POP3Connector" 
        responseTimeout="10000"/>
    <collection-splitter doc:name="Collection Splitter"/>

    <echo-component doc:name="Echo"/>

    <file:outbound-endpoint path="/attachments" 
        outputPattern="#[function:datestamp].csv"
        doc:name="File" responseTimeout="10000"> 
        <expression-transformer expression="payload.inputStream"/>
        <message-property-filter pattern="from=(.*)(bob@email.com)(.*)" caseSensitive="false"/>
    </file:outbound-endpoint>           
</flow> 
```

解决这个问题的最佳方法是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-31T17:49:46.633

To help you, here are two configuration bits:

*   The following filter accepts only messages where `fromAddress` is 'Bob' and where subject contains 'keyword':

    ```
    <expression-filter
        expression="#[message.inboundProperties.fromAddress == 'Bob' || message.inboundProperties.subject contains 'keyword']" /> 
    ```

*   The following transformer extracts all the attachments whose names end with '.csv':

    ```
    <expression-transformer
        expression="#[($.value in message.inboundAttachments.entrySet() if $.key ~= '.*\\.csv')]" /> 
    ```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T17:07:34.310

欢迎来到骡！几个月前，我为客户实施了一个类似的项目。我看看你的流程，让我们开始重构。

*   从入站端点中删除 transformer-refs="returnAttachments"
*   将以下元素添加到您的流程中

    ```
    <pop3:inbound-endpoint ... />
    <custom-filter class="com.benasmussen.mail.filter.RecipientFilter"> 
        <spring:property name="regex" value=".*bob.bent@.*" />
    </custom-filter>
    <expression-transformer>
        <return-argument expression="*.csv" evaluator="attachments-list" />
    </expression-transformer>
    <collection-splitter doc:name="Collection Splitter" /> 
    ```

*   将我的 RecipientFilter 作为 java 类添加到您的项目中。如果所有消息与正则表达式模式不匹配，它们将被丢弃。

    ```
    package com.benasmussen.mail.filter;

    import java.util.Collection;
    import java.util.Set;
    import java.util.regex.Pattern;      
    import org.mule.api.MuleMessage;
    import org.mule.api.lifecycle.Initialisable;
    import org.mule.api.lifecycle.InitialisationException;
    import org.mule.api.routing.filter.Filter;
    import org.mule.config.i18n.CoreMessages;
    import org.mule.transport.email.MailProperties;

    public class RecipientFilter implements Filter, Initialisable
    {
        private String regex;
        private Pattern pattern;

        public boolean accept(MuleMessage message)
        {
            String from = message.findPropertyInAnyScope(MailProperties.FROM_ADDRESS_PROPERTY, null);
            return isMatch(from);
        }

        public void initialise() throws InitialisationException
        {
            if (regex == null)
            {
                throw new InitialisationException(CoreMessages.createStaticMessage("Property regex is not set"), this);
            }
            pattern = Pattern.compile(regex);
        }

        public boolean isMatch(String from)
        {
            return pattern.matcher(from).matches();
        }

        public void setRegex(String regex)
        {
            this.regex = regex;
        }
    } 
    ```

The mule expression framework is powerful, but in some use cases I prefer my own business logic.

### Improvment

*   Use application properties (mule-app.properties) > [mule documentation](http://www.mulesoft.org/documentation/display/MULE3USER/Using+Parameters+in+Your+Configuration+Files)

### Documentation

*   [MailProperties](http://grepcode.com/file/repo1.maven.org/maven2/org.mule.transports/mule-transport-email/3.3.0/org/mule/transport/email/MailProperties.java?av=f) shows you all available message properties (EMail)
*   Take a look at the [mule schema doc](http://www.mulesoft.org/docs/site/3.3.0/schemadocs/) to see all available elements
*   Incoming payload (mails, etc) are transported by an [DefaultMuleMessage](http://grepcode.com/file/repo1.maven.org/maven2/org.mule/mule-core/3.3.0/org/mule/DefaultMuleMessage.java/) (Payload, Properties, Attachments)

# javascript - 具有自适应时间间隔的 AJAX 刷新

> ID：14102215
> 
> 赞同：1
> 
> 时间：2012-12-31T13:30:46.353
> 
> 标签：javascript, ajax, refresh

我有一个页面，其中包括倒计时和一些我用 AJAX 刷新的数据。为了减少服务器上的负载，我按照[http://reallifejs.com/brainchunks/repeated-events-timeout-or-interval/上的说明使 AJAX 刷新间隔取决于倒计时的剩余时间](http://reallifejs.com/brainchunks/repeated-events-timeout-or-interval/)

例如，如果剩余时间少于一天，则刷新间隔为一分钟，如果剩余时间大于一天，则刷新间隔为 5 分钟，我有这样的事情：

```
var doStuff = function () {
    // Do stuff
    var remainingTime = JSONData.restTime;

    if(remainingTime > one day) {
        setTimeout(doStuff, 300000);
    } else {
        setTimeout(doStuff, 60000);
    }
};

setTimeout(doStuff, 60000); 
```

“剩余时间”取自用于刷新的 JSON。现在一切正常。我仍然想做一个改进，因为第一个 AJAX 调用是在加载页面后一分钟完成的（基于上面代码中的最后一个“SetTimeout”）。理想情况下，我会以相同的方式根据休息时间进行第一次通话，即如果还剩一天以上，则在 5 分钟后第一次通话，如果还剩不到一天，则在 1 分钟后第一次通话。

我怎样才能使这取决于剩余的时间？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:34:29.040

而不是最初调用`setTimeout`，你不能只调用doStuff吗？

```
var doStuff = function () {
  // Do stuff
  var remainingTime=JSONData.restTime;
  if(remainingTime>one day) {
    setTimeout(doStuff, 300000);
  } else {
    setTimeout(doStuff, 60000);
  }
};

doStuff(); 
```

或者如果`JSONData`尚未加载，`doStuff`则从第一个 AJAX 成功回调中调用。

# image - 将moviclips添加到舞台时出现白色矩形

> ID：14102221
> 
> 赞同：3
> 
> 时间：2012-12-31T13:31:36.513
> 
> 标签：image, actionscript-3, flash, dynamic

我正在做一个非常复杂的 AS3 项目。我有几个“屏幕”（它们只是我添加到舞台的电影剪辑），其中包含几个 .PNG 图像。这些图像是从我服务器上的文件动态加载的。它们显示正确，但有时（据我所知，仅在 Chrome 中）我也有白色矩形出现在这些图像旁边，或者在我将它们从舞台上移除后它们曾经出现的位置。我已经尝试解决这个问题几天了，但仍然不知道为什么会发生这种情况......

**问题解决了！**

经过许多令人沮丧的测试，我将 wmode 从透明更改为不透明，瞧……一切都按预期工作。我不知道为什么，但现在效果很好......感谢您的建议！

# java - 箭头键在自定义搜索组件中不起作用

> ID：14102223
> 
> 赞同：1
> 
> 时间：2012-12-31T13:32:04.453
> 
> 标签：java, swing, jtable, jbutton, tablerowsorter

我正在开发一个自定义搜索组件。单击文本字段内的按钮（搜索图像图标）时，将显示一个表格。代码处于非常初级的阶段，所以很多东西都不存在。

到目前为止，我被卡住了，因为我无法使用箭头键导航表格。一旦我在表格中选择了一行，我也无法使用“tab”键移动到下一个文本字段。

该组件的目标是从表中选择一行，然后在支持方法（尚未写入）的帮助下，来自其他标签和文本字段的值将被默认，而在文本字段中默认第一列值是附于。

非常感谢您的帮助。谢谢 ！！

```
 package myTableCombo;

import java.awt.Component;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.JWindow;
import javax.swing.ListSelectionModel;
import javax.swing.RowFilter;
import javax.swing.ScrollPaneConstants;
import javax.swing.SwingConstants;
import javax.swing.WindowConstants;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.plaf.basic.BasicArrowButton;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableRowSorter;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;

public class SearchBox extends JPanel {

        private static final long serialVersionUID = 1L;
        private JTextField editor;
        private JButton arrowButton;
        private JWindow jWindow;
        private Component userComponent;

        public SearchBox() {
                super(new FlowLayout(FlowLayout.LEFT, 0, 0));
                editor = new JTextField();
                editor.setPreferredSize(new Dimension(250, 25));
                initialize();
                addListeners();
                setBorders();
        }

        private void addListeners() {
                arrowButton.addActionListener(new ActionListener() {
                        public void actionPerformed(ActionEvent e) {
                                showWindow();
                        }
                });
        }

        protected void showWindow() {
                if (null != getWindowComponent()) {
                        jWindow = new JWindow();
                        jWindow.getContentPane().add(getWindowComponent());
                        jWindow.setLocation(new Point(SearchBox.this.getLocationOnScreen().x, SearchBox.this.getLocationOnScreen().y + 25));
                        jWindow.pack();
                        jWindow.setVisible(true);
                }
        }

        private Component getWindowComponent() {
                return userComponent;
        }

        public void setWindowComponent(Component component) {
                userComponent = component;
        }

        private void initialize() {
                arrowButton = new BasicArrowButton(SwingConstants.SOUTH);//In my code there is an icon here
                arrowButton.setBorder(null);
                arrowButton.setContentAreaFilled(false);
        }

        private void setBorders() {
                add(editor);
                add(arrowButton);
                setBackground(editor.getBackground());
                setBorder(editor.getBorder());
                editor.setBorder(null);
        }

        public JTextField getTextComponent() {
                return editor;
        }

        public JButton getActionButton() {
                return arrowButton;
        }

        public static void main(String args[]) {
                EventQueue.invokeLater(new Runnable() {
                        @Override
                        public void run() {
                                createAndShowGUI();
                        }
                });
        }

        protected static void createAndShowGUI() {
                JFrame frame = new JFrame();
                JPanel panel = new JPanel();

                frame.setPreferredSize(new Dimension(500, 400));
                frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

                panel.add(new JLabel("Test Table Combo"));
                SearchBox searchBox = new SearchBox();
                searchBox.userComponent = searchBox.new SearchBoxTable();
                panel.add(searchBox);

                frame.getContentPane().add(panel);
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
        }

        private class SearchBoxTable extends JScrollPane implements DocumentListener {

                private static final long serialVersionUID = 1L;
                private JTable table;
                private Object[] columnNames;
                private DefaultTableModel tableModel;
                private Object[][] sheetDataInString;
                private TableRowSorter<DefaultTableModel> rowSorter;

                public SearchBoxTable() {
                        columnNames = new Object[]{"Column 1", "Column 2", "Column 3", "Column 4", "Column 5", "Column 6"};
                        sheetDataInString = new Object[21][6];
                        for(int i =0; i < sheetDataInString.length; i++) {
                                for(int j = 0; j< 6; j++) {
                                        sheetDataInString[i][j] = "Row Value : " + i + ", Column Value : " + j;
                                }
                        }

                        tableModel = new DefaultTableModel(sheetDataInString, columnNames) {
                                private static final long serialVersionUID = 1L;

                                @Override
                                public boolean isCellEditable(int row, int column) {
                                        return false;
                                }
                        };
                        rowSorter = new TableRowSorter<DefaultTableModel>(tableModel);

                        table = new JTable(tableModel);
                        table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
                        table.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
                        table.setAutoCreateRowSorter(true);
                        table.setFillsViewportHeight(true);
                        table.getTableHeader().setFont(new Font(null, Font.PLAIN, 13));

                        setPreferredSize(new Dimension(500, 225));
                        setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
                        setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_AS_NEEDED);
                        getViewport().add(table);
                }

                @Override
                public void changedUpdate(DocumentEvent e) {
                        newFilter(e);
                }

                @Override
                public void insertUpdate(DocumentEvent e) {
                        newFilter(e);
                }

                @Override
                public void removeUpdate(DocumentEvent e) {
                        newFilter(e);
                }

                /**
                 * Update the row filter regular expression from the expression/string/data in the text box.
                 * 
                 * @param documentEvent
                 */
                private void newFilter(DocumentEvent documentEvent) {
                        RowFilter<DefaultTableModel, Object> rowFilter = null;
                        Document document = documentEvent.getDocument();
                        String filterText;

                        try {
                                filterText = document.getText(0, document.getLength()).trim();
                                rowFilter = RowFilter.regexFilter("(?i)" + filterText);
                        } catch (java.util.regex.PatternSyntaxException e) {
                                return;
                        } catch (BadLocationException badLocationException) {
                                return;
                        }
                        rowSorter.setRowFilter(rowFilter);
                        table.setRowSorter(rowSorter);

                }

        }

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:29:03.717

你是什​​么意思

*   使用 undecorated`JDialog`代替`JWindow`，否则`JTextComponets`不可编辑

*   `JDialog``AlwaysOnTop`对and有更好的支持`ModalityTypes`（仅硬编码到`setAlwaysOnTop`）

*   不要一次又一次地重新创建基本设置，不要重新创建弹出窗口，使用 lolac 变量，删除所有内容并添加一个新的，一次为 JDialog 定义所有设置，请参阅异常（对话框可显示。）在弹出窗口被隐藏并且 JTextField 中的值不为空的情况下

*   `JDialog`hide on `ESC key event`, hide `JDialog`, if 的错过动作被`JFrame`最小化

*   `JDialog`如果调整大小，则错过移动，`JFrame`在另一个屏幕上移动`Point`，

*   直接附加`Document`到定义`JTextField`中，而不是迷失在某个地方`JScrollPane`

*   您的[代码缺少一些好的实践](https://stackoverflow.com/questions/7053283/sending-messages-between-two-jpanel-objects)，那么一切皆有可能，但使用此代码并非如此（在我的编辑之后）

*   搜索`JCalendar by Kay Toedter`（我看到的弹出窗口的最佳弹出解决方法）

只删除了 uselles 方法，移至 from-to，notice `non_optimized_code`，简单地放到 the`recyclebin`并再次写入

```
import java.awt.Component;
import java.awt.Dimension;
import java.awt.EventQueue;
import java.awt.FlowLayout;
import java.awt.Font;
import java.awt.Point;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.ListSelectionModel;
import javax.swing.RowFilter;
import javax.swing.ScrollPaneConstants;
import javax.swing.SwingConstants;
import javax.swing.SwingUtilities;
import javax.swing.WindowConstants;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.plaf.basic.BasicArrowButton;
import javax.swing.table.DefaultTableModel;
import javax.swing.table.TableRowSorter;
import javax.swing.text.BadLocationException;
import javax.swing.text.Document;

public class SearchBox extends JPanel {

    private static final long serialVersionUID = 1L;
    private static JFrame frame = new JFrame();
    private JTextField editor;
    private JButton arrowButton;
    //private JToggleButton arrowButton;
    private JDialog popupWindow = new JDialog(frame);
    private Component userComponent;
    private JTable table;
    private TableRowSorter<DefaultTableModel> rowSorter;
    private Object[] columnNames;
    private DefaultTableModel tableModel;
    private Object[][] sheetDataInString;

    public SearchBox() {
        super(new FlowLayout(FlowLayout.LEFT, 0, 0));
        editor = new JTextField();
        editor.setPreferredSize(new Dimension(250, 25));
        editor.getDocument().addDocumentListener(new DocumentListener() {

            @Override
            public void changedUpdate(DocumentEvent e) {
                newFilter();
            }

            @Override
            public void insertUpdate(DocumentEvent e) {
                newFilter();
            }

            @Override
            public void removeUpdate(DocumentEvent e) {
                newFilter();
            }

            private void newFilter() {
                RowFilter<DefaultTableModel, Object> rowFilter = null;
                Document document = editor.getDocument();
                String filterText;
                try {
                    filterText = document.getText(0, document.getLength()).trim();
                    rowFilter = RowFilter.regexFilter("(?i)" + filterText);
                } catch (java.util.regex.PatternSyntaxException e) {
                    return;
                } catch (BadLocationException badLocationException) {
                    return;
                }
                rowSorter.setRowFilter(rowFilter);
                table.setRowSorter(rowSorter);
            }
        });
        initialize();
        addListeners();
        setBorders();
    }

    private void addListeners() {
        arrowButton.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                if (!popupWindow.isVisible()) {
                    showWindow();
                } else {
                    hideWindow();
                }
            }
        });
    }

    protected void showWindow() {
        if (null != getWindowComponent()) {
            popupWindow.getContentPane().add(getWindowComponent());
            popupWindow.setLocation(new Point(SearchBox.this.getLocationOnScreen().x, SearchBox.this.getLocationOnScreen().y + 25));
            popupWindow.setUndecorated(true);
            popupWindow.setAlwaysOnTop(true);
            popupWindow.pack();
            SwingUtilities.invokeLater(new Runnable() {

                @Override
                public void run() {
                    popupWindow.setVisible(true);
                }
            });
        }
    }

    protected void hideWindow() {
        popupWindow.setVisible(false);
    }

    private Component getWindowComponent() {
        return userComponent;
    }

    public void setWindowComponent(Component component) {
        userComponent = component;
    }

    private void initialize() {
        arrowButton = new BasicArrowButton(SwingConstants.SOUTH);//In my code there is an icon here
        arrowButton.setBorder(null);
        arrowButton.setContentAreaFilled(false);
    }

    private void setBorders() {
        add(editor);
        add(arrowButton);
        setBackground(editor.getBackground());
        setBorder(editor.getBorder());
        editor.setBorder(null);
    }

    public JTextField getTextComponent() {
        return editor;
    }

    public JButton getActionButton() {
        return arrowButton;
    }

    public static void main(String args[]) {
        EventQueue.invokeLater(new Runnable() {

            @Override
            public void run() {
                createAndShowGUI();
            }
        });
    }

    protected static void createAndShowGUI() {
        JPanel panel = new JPanel();

        frame.setPreferredSize(new Dimension(500, 400));
        frame.setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

        panel.add(new JLabel("Test Table Combo"));
        SearchBox searchBox = new SearchBox();
        searchBox.userComponent = searchBox.new SearchBoxTable();
        panel.add(searchBox);

        frame.getContentPane().add(panel);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    private class SearchBoxTable extends JScrollPane {

        private static final long serialVersionUID = 1L;

        public SearchBoxTable() {
            columnNames = new Object[]{"Column 1", "Column 2", "Column 3", "Column 4", "Column 5", "Column 6"};
            sheetDataInString = new Object[21][6];
            for (int i = 0; i < sheetDataInString.length; i++) {
                for (int j = 0; j < 6; j++) {
                    sheetDataInString[i][j] = "Row Value : " + i + ", Column Value : " + j;
                }
            }

            tableModel = new DefaultTableModel(sheetDataInString, columnNames) {

                private static final long serialVersionUID = 1L;

                @Override
                public boolean isCellEditable(int row, int column) {
                    return true;
                }
            };
            rowSorter = new TableRowSorter<DefaultTableModel>(tableModel);
            table = new JTable(tableModel);
            table.setAutoResizeMode(JTable.AUTO_RESIZE_OFF);
            table.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
            table.setAutoCreateRowSorter(true);
            table.setFillsViewportHeight(true);
            table.getTableHeader().setFont(new Font(null, Font.PLAIN, 13));
            table.setPreferredScrollableViewportSize(table.getPreferredSize());
            setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);
            setHorizontalScrollBarPolicy(ScrollPaneConstants.HORIZONTAL_SCROLLBAR_AS_NEEDED);
            getViewport().add(table);
        }
    }
} 
```

# php - 我正在尝试制作爬虫，如何获取一些标签并访问内部标签？

> ID：14102225
> 
> 赞同：-1
> 
> 时间：2012-12-31T13:32:38.800
> 
> 标签：php, html, xml, function, web-crawler

首先很抱歉，因为很难解释我想要做什么。

我用 php 制作了一个爬虫并使用函数 getElementsByTag() 来获取我想要的一些标签，例如我想从网站上获取一些 img 但不是按类别分类，所以我无法过滤。代码如下：

```
<div class="separator" style="clear: both; text-align: center;">
<a href="www.xxx.com" target="_blank"><img alt="Athletic de Bilbao" border="0" src="http://2.bp.blogspot.com/-2UBftyhYArw/T0v9vguvZuI/AAAAAAAAA9s/vLQ8GSo6v5A/s1600/athletic.png" title="Athletic de Bilbao" /></a></div>
<img border="0" src="www.xxx.com/TOl2NhAAFBI/AAAAAAAAAJk/KxHrumDQ48M/s1600/down.gif" /> <b style="color: red;">Bajas</b> <br />
<ul> 
```

我在想我得到的唯一机会是获取标签 div（分隔符），然后使用任何功能访问内部的图像标签，但我不知道是否可以使用任何功能？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:32:20.123

您可以将其编写为*Xpath 表达式*，例如获取所有此类图像的列表：

```
//div[@class="separator"]/img 
```

您可以在 PHP 中使用[`DOMXPath`](http://php.net/DOMXPath).

与 一样[`DOMDocument::getElementsByTagName()`](http://php.net/domdocument.getelementsbytagname)，也[`DOMXPath::query()`](http://php.net/domxpath.query)返回 a [`DOMNodeList`](http://php.net/domnodelist)。

# css - 由于表格，页脚不会停留在页面底部

> ID：14102228
> 
> 赞同：0
> 
> 时间：2012-12-31T13:33:23.443
> 
> 标签：css, html, html-table, footer

我正在制作一个简单的内容管理系统，我的 CSS 和布局适用于所有内容，除了我制作了一个表格，然后以某种方式移动页脚部分以移动到其上方的包装类部分。甚至表格下方的文本也会在表格上方输出。

我的基本布局...

```
 <?php
        session_start();
        //nav bar //top part of page which fully works etc
        include "header.php";
    ?>

    <section class= "mainSection">

    <section class = "subMain">
    <p> this should be above </p>

    <?php include "/mysql/catgoryShow.php"; ?>

    <p> this should be below the table </p>

    </section>

    </section>
    <footer class = "mainFooter">

    </footer>

</body> 
```

我的css的重要部分......

```
section.mainSection{

margin-left: 4%;
margin-right:4%;
min-height: 1000px;
background-color: #ffffff;

border-left-style:solid;
border-left-color:#DAE3ED;
border-left-width:5px;

border-right-style:solid;
border-right-color:#DAE3ED;
border-right-width:5px;

   }

section.subMain{
margin-left: 10%;
margin-right: 10%;
padding-top:10%;
padding-bottom: 2%;

 } 
```

我的页脚 css

```
footer.mainFooter{

margin-left: 4%;
margin-right:4%;
height: 75px;
background-color:#78B0F0;
border-top-style:solid;
border-top-color:#DAE3ED;
border-top-width:5px;
 } 
```

最后是我的桌子

```
 <?php
$result=mysql_query($query);

$num=mysql_numrows($result);
    echo "<p>'$query' returns $num rows:<p>\r\n";
?>
<table border="0" cellspacing="2" cellpadding="2">
<tr>
<td><font face="Arial, Helvetica, sans-serif">|Product ID|</font></td>
<td><font face="Arial, Helvetica, sans-serif">|Product Name|</font></td>
<td><font face="Arial, Helvetica, sans-serif">Product Category|</font></td>
<td><font face="Arial, Helvetica, sans-serif">Product Minimum Age|</font></td>
<td><font face="Arial, Helvetica, sans-serif">Product Discription|</font></td>
<td><font face="Arial, Helvetica, sans-serif">Product Price|</font></td>
<td><font face="Arial, Helvetica, sans-serif">Product Quantily Available|</font></td>
<td><font face="Arial, Helvetica, sans-serif">View Product Page|</font></td>
</tr>

<?php
$i=0;
while ($i < $num) {

$f1=mysql_result($result,$i,"ProductID");
$f2=mysql_result($result,$i,"ProductName");
$f3=mysql_result($result,$i,"ProductCategory");
$f4=mysql_result($result,$i,"SuitableAge");
$f5=mysql_result($result,$i,"ProductDiscription");
$f6=mysql_result($result,$i,"ProductPrice");
$f7=mysql_result($result,$i,"ProductAvailable");
?>

<tr>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f1; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f2; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f3; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f4; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f5; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f6; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f7; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><?php echo $f7; ?></font></td>
<td><font face="Arial, Helvetica, sans-serif"><a href="../cw/itemPage.php?id=<?php echo $f1?>">View Details</a></font></td>
</tr>

<?php

$i++;
}
   echo "<p>'$query' returns $num rows:<p>\r\n";

?> 
```

显示查询的两个回声也以某种方式在表格之前打印：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:49:19.633

如前所述 - 您必须使用适当的`</table>`标签关闭该表格元素。在极少数情况下，表也可能会继承一些浮动值，因此`footer.mainFooter { clear: both; }`应该修复它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:42:43.457

正如@cimmonon 所说，关闭这个`<table>`标签将是一个非常好的开始

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T13:41:26.033

对于主页脚的 css，添加`position:relative`和`bottom:0`。它将始终固定在底部。

# .net - 更改或移动 PDF 文件中的文本位置

> ID：14102229
> 
> 赞同：0
> 
> 时间：2012-12-31T13:33:43.363
> 
> 标签：.net, c#-4.0, pdf

通过 .net 应用程序，我想通过向下移动第一行或第一个单词的小空间来修改 pdf 文档。

是否有任何库可以帮助我以编程方式更改 pdf 文档上的某些文本位置？

我想更改 pdf 上文本对象的 y 位置，此操作将对许多文件进行，并且我不想使用任何中间过程，例如转换为 svg 或 word，我想直接修改 pdf文件。

我检查了一些库，如 PdfSharp 、 iTextSharp 、 PDFLibNet 、 Amyuni 、 pdfclown ，但我没有找到解决这个问题的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T08:18:33.143

一个多月来研究在 pdf 文件上移动文本对象的解决方案，我检查了许多库，如 [Docotic、pdfclown、iTextSharp、PdfSharp、PDFLibNet、Amyuni、asppdf、PDFTechLib 等]，我找到了两个库可以做这个操作

1.  [amyuni](http://www.amyuni.com/en/developer/pdfcreator/features/)它的代码很简单，但是在修改位置后我又遇到了另一个问题：图形颜色已更改，
2.  另一个库是[foxitsoftware](http://www.foxitsoftware.com/products/sdk/dll/)，这是我如何做到的示例代码。

    ```
    public static void Modify(string pdfFile)
    {
        IntPtr pdf_doc = IntPtr.Zero;
        IntPtr pdf_page = IntPtr.Zero;
        TextInfo TxtInfo = null;
        ObjectInfo ObjInfo = null;
        ArrBuf = new ArrayList();
        FPDFView.FPDF_InitLibrary(System.Diagnostics.Process.GetCurrentProcess().Handle);
        FPDFView.FPDF_UnlockDLL("xxxxxx", "xxxxxxxxxxxxxxxxxxxxxxxxxxxx");
        pdf_doc = FPDFLIB.FPDFView.FPDF_LoadDocument(pdfFile, "");
        pdf_page = FPDFView.FPDF_LoadPage(pdf_doc, 0);

        IntPtr Page_Obj = FPDFEditBase.FPDFPage_GetObject(pdf_page, 0);

        FPDFEditBase.FPDFPageObj_Transform(Page_Obj, 1, 0,0, 1, 0, -40);

        ObjInfo = new ObjectInfo(pdf_doc, pdf_page, -1);
        ObjInfo.Delete(-1);

        FPDFLIB.FPDFEditBase.FPDF_FILEWRITE pFileWriter = new FPDFLIB.FPDFEditBase.FPDF_FILEWRITE();
        pFileWriter.wb = new FPDFEditBase.WriteBlock(MyDelegateFunc);
        //FPDFEditBase.FPDF_SaveDocument(pdf_doc, ref pFileWriter, 0, null, 0, null, 0, 0);
        bool flag = FPDFEditBase.FPDF_SaveDocument(pdf_doc, ref pFileWriter, 0, null, 0, null, 0, 0);
        if (flag == false)
            return;
        FileStream fs = new FileStream(pdfFile, FileMode.Create, FileAccess.Write);
        object[] myArr = ArrBuf.ToArray();
        for (int i = 0; i < myArr.Length; i++)
        {
            byte[] mybyte = (byte[])myArr[i];
            fs.Write(mybyte, 0, mybyte.Length);
        }

        fs.Close();
        fs.Dispose();

        FPDFLIB.FPDFView.FPDF_CloseDocument(pdf_doc);

    }
    static ArrayList ArrBuf = new ArrayList();

    public static int MyDelegateFunc(ref FPDFEditBase.FPDF_FILEWRITE pThis, IntPtr pData, UInt32 size)
    {

        byte[] byteData = new byte[size];

        System.Runtime.InteropServices.Marshal.Copy(pData, byteData, 0, (int)size);
        ArrBuf.Add(byteData);

        return 1;
    } 
    ```

我希望这对遇到同样问题的其他人有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:37:11.870

我认为您可以使用 .NET 的特定 API（例如 iTextSharp）重新编辑 pdf 文件。

# laravel - Laravel 4 上的刀片模板引擎语法问题

> ID：14102231
> 
> 赞同：13
> 
> 时间：2012-12-31T13:33:48.933
> 
> 标签：laravel, laravel-4, blade

我目前正在[Laravel 4的 beta 版本上启动一个项目](https://github.com/laravel/framework)

当我尝试使用模板引擎时，有些标签可以工作，有些则不能。例如：

```
@layout('layouts.master')
@section('container')
    <h1>About US</h1>
@endsection 
```

显示为：

```
@layout('layouts.master')

About US

@endsection 
```

这意味着`@section`标签被解析，但另一个被称为纯文本。另外，如果我将其更改`@layout`为`@include`，它确实包含模板。

有没有人遇到过类似的问题？有没有我不知道的语法变化？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-31T14:50:27.790

`@layout``@extends`在 Laravel 4中已更改为。此外，`@endsection`已更改为`@stop`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-13T12:37:19.523

问题的根源在于许多在线教程（youtube 和博客）仍然使用@layout 和@endsection。这些教程通常也声称是 Laravel4 教程。

所以很多人在开始他们的第一个 Laravel4 应用程序时就掉进了这个小陷阱。

提示：我在开发时使用这个人的备忘单[页面](http://cheats.jesse-obrien.ca)（Jesse O'Brien 专有）。这就是我发现自己使用过时的刀片标签的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-06T14:35:42.050

如果您在使用 Laravel 时遇到问题，或者如果您不知道 Laravel 是否内置了您需要的功能，请务必查看您使用的 Laravel 版本的文档。

当前发布版本的**在线文档（撰写本文时为 4）：http:** [//laravel.com/docs/](http://laravel.com/docs/)

和**Laravel API**在线深入了解源代码，并解释例如函数参数： http: [//laravel.com/api/](http://laravel.com/api/)

# internet-explorer - 允许受信任站点的 ActiveXObject

> ID：14102232
> 
> 赞同：1
> 
> 时间：2012-12-31T13:34:04.673
> 
> 标签：internet-explorer, activex, prompt, activexobject

我有一个想法可以极大地改善组织的 Intranet 主页，但是这个想法需要 activexobject。在测试过程中，我一直无法禁用要求确认是否运行控件的提示。我该如何克服呢？

（本组织只用IE，有的地方8个，但大多是9个）

所有帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-07T12:11:37.070

**请按照以下步骤禁用打开 ActiveX 提示以允许运行。**

ActiveX 控件本质上是可以由不同的 Windows 应用程序共享的小程序。

注意：ActiveX 控件是将病毒、间谍软件和其他恶意软件加载到计算机上的最常用工具。因此，每次网站尝试安装 ActiveX 控件时，Internet Explorer 都会询问您是否要允许它。这些提示可以防止对您的计算机造成损害

按照下面提到的步骤禁用 ActiveX 提示。

1.  单击 Internet Explorer 图标以打开 Internet Explorer。

2.  单击工具，然后从列表中选择 Internet 选项。

3.  单击安全选项卡，然后单击自定义级别按钮。

4.  这将打开一个“安全设置”窗口，其中列出了可能危及您的计算机安全的操作。对于每一个，您可以告诉 Explorer 在所有实例中自动阻止该操作（“禁用”）、在所有实例中允许它（“启用”）或询问您是否阻止它（“提示”）。

5.  向下滚动到标有“ActiveX 控件和插件”的部分。

6.  为以下操作选择“启用”：

一个。“允许以前未使用的 ActiveX 控件在没有提示的情况下运行”

湾。“下载签名的 ActiveX 控件”

C。“下载未签名的 ActiveX 控件”

d。“初始化并编写未标记为可安全执行脚本的 ActiveX 控件”

e. “运行 ActiveX 控件和插件”

F。“为标记为安全的脚本编写 ActiveX 控件编写脚本。”

1.  为“ActiveX 控件的自动提示”操作选择“禁用”。

2.  单击“确定”关闭“安全设置”窗口，然后再次单击“确定”关闭“Internet 选项”窗口。

3.  重新启动计算机，新的安全设置生效，您应该不再看到 ActiveX 提示。

**如果您无法理解任何一点，请告诉我，我将指导您完成。**

# php - 根据php中的数字拆分字符串数组？

> ID：14102235
> 
> 赞同：-2
> 
> 时间：2012-12-31T13:34:16.500
> 
> 标签：php, regex, preg-match, preg-split

我有一个字符串

```
 $str = "101WE3P-1An Electrically-Small104TU5A-3,Signal-Interference Duplexers Gomez-GarciaRobertoTU5A-3-01" 
```

我想用数字分割这个字符串，例如：“101WE3P-1An....”应该是第一个元素，“104TUA...”应该是第二个元素？

[有人在我之前的问题](https://stackoverflow.com/q/14100965/367456)*preg_match 中给我写了以下代码[*来连续匹配三个数字的子字符串？*](https://stackoverflow.com/q/14100965/367456)几分钟前：*

 *```
$result = preg_split('/^\d{3}$/', $page, -1, PREG_SPLIT_DELIM_CAPTURE | PREG_SPLIT_NO_EMPTY); 
```

基线是我想匹配三个数字，后跟任何大写字母，然后是包括 \t 在内的任何内容？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T13:46:30.313

您可以通过使用[前瞻断言](http://www.regular-expressions.info/lookaround.html)`preg_split()`来告诉在字符串中的任何点拆分后跟三位数字。

```
$str = "101WE3P-1An Electrically-Small104TU5A-3,Signal-Interference Duplexers Gomez-GarciaRobertoTU5A-3-01";
$result = preg_split('/(?=\d{3})/', $str, -1, PREG_SPLIT_NO_EMPTY);

var_export($result); 
```

给出以下数组：

```
array (
  0 => '101WE3P-1An Electrically-Small',
  1 => '104TU5A-3,Signal-Interference Duplexers Gomez-GarciaRobertoTU5A-3-01',
) 
```

使用该`PREG_SPLIT_NO_EMPTY`标志是因为字符串的开头也是三个数字的点，因此此处发生空拆分。我们可以将正则表达式更改为不在字符串的开头拆分，但这会使一目了然地理解起来有点困难，而标志非常清晰。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-31T13:48:29.877

我尝试了匹配而不是拆分

```
preg_match_all('/^(\d{3}.*?)*$/', $str, $matches);
var_dump($matches); 
```

似乎为您的样品获得了正确的结果*

# solr - Solr 复制带宽控制

> ID：14102236
> 
> 赞同：1
> 
> 时间：2012-12-31T13:34:26.190
> 
> 标签：solr

有没有办法限制 Solr 从站用于从主站下载数据的网络带宽量？它目前默认使用所有可用带宽，这会导致其他应用程序出现问题。我正在使用 Solr v3.5。

编辑：我正在使用基于 Java 的复制。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:41:04.367

是的，您可以使用[SOLR-2099](https://issues.apache.org/jira/browse/SOLR-2099)问题中描述的命令进行设置。

# obfuscation - TypeScript 混淆

> ID：14102242
> 
> 赞同：21
> 
> 时间：2012-12-31T13:34:35.830
> 
> 标签：obfuscation, typescript

是否有任何 TypeScript 工具或分支来支持公共命名空间混淆？即转：

```
class MyUtil {
   print(): void { ... }
} 
```

变成这样的东西：

```
class xxy {
   aab(): void { ... }
} 
```

如果没有，会直接派出编译器来提供这个吗？也许通过某种类型的类注释指示应该/不应该混淆什么。

（显然，公共混淆必须谨慎使用，对库没有好处！但如果在您的项目中始终如一地使用，那就太好了）

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2017-06-05T19:29:14.540

我有完全相同的问题，它立即被SO删除。

[https://github.com/angular/ts-minify](https://github.com/angular/ts-minify)

这正是您（和我）正在寻找的工具，它似乎工作得很好，我需要注释掉作者采取的一些我认为不适用的预防措施的部分。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-31T17:09:54.343

我不相信有任何理由在 TypeScript 中这样做。您可以改为使用 Closure Compiler 之类的工具对 JavaScript 输出进行混淆处理。具体查看 Closure 的[高级编译](https://developers.google.com/closure/compiler/docs/api-tutorial3)设置。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-30T20:05:09.283

#  不是直接回答！Js 混淆器

[https://github.com/javascript-obfuscator/javascript-obfuscator](https://github.com/javascript-obfuscator/javascript-obfuscator)

> 插件：
> 
> ```
> Webpack plugin: webpack-obfuscator
> Webpack loader: obfuscator-loader
> Gulp: gulp-javascript-obfuscator
> Grunt: grunt-contrib-obfuscator
> Rollup: rollup-plugin-javascript-obfuscator 
> ```

笔记：

> 只混淆属于你的代码。
> 
> 不建议混淆供应商脚本和 polyfill，因为 **混淆后的代码会慢 15-80%（取决于选项）并且文件要大得多。**

# serialization - .vbs 脚本中的序列化是否可能？

> ID：14102243
> 
> 赞同：0
> 
> 时间：2012-12-31T13:34:43.203
> 
> 标签：serialization, vbscript, wsh

我已将我的一些代码合并到以下内容中：

```
 Option Explicit

    Dim oShell : Set oShell = WScript.CreateObject ("WScript.Shell")
    Dim FSO : set FSO = CreateObject("Scripting.FileSystemObject") 
    Dim StartTime,Elapsed 

    'msgBox(oShell.CurrentDirectory)
    'MsgBox(FSO.GetFile(Wscript.ScriptFullName).ParentFolder )
    oShell.CurrentDirectory = FSO.GetFile(Wscript.ScriptFullName).ParentFolder

    StartTime = Timer

    oShell.run "ParentChildLinkFinal.vbs", 1, True
    oShell.run "Parent_Child_Merge_final.vbs", 1, True
    oShell.run "CycleTime.vbs", 1, True
    oShell.run "Baddata.vbs", 1, True
    oShell.run "Matrixrefresh.vbs", 1, True

    Elapsed = Timer - StartTime

    MsgBox("Total time taken to finish this task:" & Elapsed & "in Seconds") 
```

现在这里的一个问题是 - 假设任何文件中发生错误`CycleTime.vbs`，但控件然后转到下一个`Baddata.vbs`文件，而不杀死文件。`Main.vbs`那么如何处理这个，如果发生错误，停止`main.vbs`那里本身或让执行继续。

**根据丹尼尔**

"IF NOT oShell.run("CycleTime.vbs", 1, True) = 0 then Wscript.Quit 将替换您当前用于在 Main.vbs 中调用“CycleTime.vbs”的行

IF oShell.run("CycleTime.vbs", 1, True) = 99 then Wscript.Quit 还将替换您当前用于调用“CycleTime.vbs”的行。不同之处在于您没有指定 CycleTime.vbs 如何出错。如果它可能以出现运行时错误并停止执行的方式失败，您将需要使用第一个选项。如果发生错误，即您使用错误捕获进行捕获，您可以使用代码退出。就像 WScript.Quit 99。然后您可以通过我提供给您的第二个版本检查脚本是否以该代码结尾。这真的取决于你想如何处理你正在调用的脚本的失败。”

***为什么采用这种方法***

@Daniel`True`帮助脚本暂停执行，直到当前 .vbs 完成。但是我正在寻找任何特殊值，如果我可以从每个 .vbs 返回一个特殊值，通过它`main.vbs`可以知道它当前的 .vbs 已成功完成，让我们开始下一个 .vbs 。但是是的，如果只有成功，那么下一个将开始。目前我看到假设任何.vbs都发生错误，然后一旦我关闭错误窗口，下一个脚本就开始运行。因此，我正在尝试至少思考是否可以将任何成功的完整通信发送到`main.vbs`. 那么有可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T21:52:53.030

要扩展 Hiten 指示的内容，您需要在 Main.vbs 中检查调用的 .vbs 文件的返回值。您可以利用[Run 的返回值来做到这一点。](http://ss64.com/vb/run.html)

例如：

而不是`oShell.run "CycleTime.vbs", 1, True`做

`IF NOT oShell.run( "CycleTime.vbs", 1, True) = 0 then Wscript.Quit`

如果由于运行时错误而暂停，这将退出您当前的执行线程`CycleTime.vbs`（运行脚本的调用将返回 false）。

现在，如果您能够在 CycleTime.vbs 中优雅地处理错误，则可以在关闭它时发送一条消息，`Wscript.Quit code`如另一个答案中所述。

因此，如果您想在 CycleTime.vbs 中优雅地处理错误，您仍然可以指示发生了错误。只需使用以下内容检查主脚本中的返回代码：

`IF oShell.run( "CycleTime.vbs", 1, True) = 99 then Wscript.Quit`

这样，如果`CycleTime.vbs`以代码 99 结尾，您的脚本将结束。如果在 CycleTime.vbs 中具有如下代码，则会发生这种情况：

```
If err then
    'Exit script with code 99 to indicate an error occurred.
    Wscript.Quit 99
End if 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:12:28.497

在 main.vbs 中使用 vbscript 错误处理来停止代码并退出 main.vbs

有关详细信息，请单击此链接： [VBScript -- 使用错误处理](https://stackoverflow.com/questions/157747/vbscript-using-error-handling)

样本：

```
On Error Resume myErrCatch
'Do step 1
'Do step 2
'Do step 3

myErrCatch:
'log error
Resume Next 
```

* * *

从 .VBS创建一个[Exist 代码](https://stackoverflow.com/questions/187040/how-do-i-return-an-exit-code-from-a-vbscript-console-application)，然后退出 Main.vbs

```
DIM returnValue
 returnValue = 99
 WScript.Quit(returnValue) 
```

# web-services - 如何编写网络服务？

> ID：14102244
> 
> 赞同：0
> 
> 时间：2012-12-31T13:34:54.177
> 
> 标签：web-services

对于我的 iOS 应用程序，我将需要一个 web 服务来处理登录和用户数据的存储。出于测试目的，我使用了一个简单的 php 文件作为登录脚本，它需要一个电子邮件和一个密码，如果登录正确，它会返回一个 xml 响应。通用功能是查询数据库并返回 JSON 或 XML。

现在，我已经阅读了一些关于 web 服务的教程，有人说 RESTful web 服务是最好的，其他人说使用 SOAP。目前我不知道如何继续。我需要为我的应用程序编写一个 Web 服务，使用任何语言和任何技术。

你能给我一些关于我应该使用什么的建议，也许还有一些好的教程或类似的东西吗？

# sql-server - SQL Server Compact - 连接到 SDF 数据文件

> ID：14102245
> 
> 赞同：2
> 
> 时间：2012-12-31T13:35:02.630
> 
> 标签：sql-server

我在 Visual Studio Express 2012 中为 Web 简单 CRUD Web 应用程序（库）创建作为学校项目。我受到这个非常好的教程的启发 - [http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-1](http://www.asp.net/mvc/tutorials/mvc-music-store/mvc-music-store-part-1)

现在我在连接到 SQL Server Compact 版本`.sdf`数据文件时遇到问题。

在`web.config`我有这个连接字符串：

```
<connectionStrings>
    <add name="LibraryEntities"
     connectionString="Data Source=C:\Users\Administrator\Documents\Visual Studio 2012\Projects\2OBOP3_KU1\R10491\App_Data\R10491_library.sdf;"
     providerName="System.Data.SqlServerCe.4.0"/>
  </connectionStrings> 
```

我为数据库连接测试创建了简单的 ASPX 文件：

```
<script runat="server">
  protected void Page_Load(object sender, EventArgs e)
  {
      using (SqlConnection cn = new SqlConnection(ConfigurationManager.ConnectionStrings["LibraryEntities"].ToString()))
      {
          SqlCommand cmd = new SqlCommand("SELECT COUNT(*) FROM Writers", cn);
          cn.Open();
          SqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);
          rdr.Read();
          Response.Write(rdr[0].ToString()); //read a value
      }
  }
</script> 
```

当我运行应用程序时，它会引发异常：

> *异常详细信息：System.Data.SqlClient.SqlException：建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，错误：26 - 错误定位服务器/指定的实例）*

但是，当我尝试`.sdf`在“数据库资源管理器”菜单（“解决方案资源管理器”旁边）的“数据库资源管理器”选项卡中连接到我的文件时，我连接成功。

所以我假设连接字符串应该有问题 - 不是吗？谢谢你的建议。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T13:36:54.360

您正在连接到 SQL Server Compact 而不是 SQL Server。

你应该使用`SqlCeConnection`not `SqlConnection`。

```
 using System.Data.SqlServerCe;

  protected void Page_Load(object sender, EventArgs e)
  {
      using (SqlCeConnection cn = new SqlCeConnection(ConfigurationManager.ConnectionStrings["LibraryEntities"].ToString()))
      {
          SqlCeCommand cmd = new SqlCeCommand("SELECT COUNT(*) FROM Writers", cn);
          cn.Open();
          SqlCeDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);
          rdr.Read();
          Response.Write(rdr[0].ToString()); //read a value
      }
  } 
```

你也需要参考`system.data.sqlserverce.dll`

# css - 计算机数据库 jpa 示例中表头的 CSS？

> ID：14102246
> 
> 赞同：1
> 
> 时间：2012-12-31T13:35:07.860
> 
> 标签：css, playframework-2.0, styles, css-shapes

在 Play 2 中，有一个`computer-database-jpa`支持列排序的示例。默认按计算机排序，箭头表示排序顺序。我在另一个项目中需要这个 CSS 样式/箭头，但即使在检查了这个表头的 CSS 代码之后

```
<th class="name header headerSortDown">
    <a href="/computers?o=desc">Computer name</a>
</th>> 
```

我还是看不到箭头是从哪里来的？对此有任何提示吗？谢谢！

![在此处输入图像描述](../Images/aadb458a125c1f9e0484ca6790f2cb1e.png)

更新：

可以在这里浏览 CSS：[https ://github.com/playframework/Play20/tree/master/samples/java/computer-database-jpa/public/stylesheets](https://github.com/playframework/Play20/tree/master/samples/java/computer-database-jpa/public/stylesheets)

但是在例如 headerSortDown 我找不到看起来像箭头的东西）：

**对于后续问题：**

如何直接在文本旁边获取箭头？ ![在此处输入图像描述](../Images/05e9390db681cbba0f31fbc640efa977.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:54:23.833

最简单的方法是使用浏览器的检查工具（即 Firefox 中的 FireBug 或 Chrome 中的内置检查器）

这是箭头的独立摘录，您可以看到它们正在“绘制”带有 CSS 边框的箭头（不需要图像）

```
<!DOCTYPE html>
<html>
    <head>
        <title>Arrows a'la Twitter Bootstrap</title>
        <style type="text/css">

            .header {
                width: 200px;
                background-color: #c2ccd1;
                padding: 4px;
                margin: 2px;
            }

            .header:after {
                content: "";
                float: right;
                margin-top: 7px;
                visibility: hidden;
            }

            .headerSortDown:after, .header:hover:after {
                border-width: 0 4px 4px;
                border-style: solid;
                border-color: #000 transparent;
                visibility: visible;
            }

            .headerSortUp:after {
                border-bottom: none;
                border-left: 4px solid transparent;
                border-right: 4px solid transparent;
                border-top: 4px solid #000;
                visibility: visible;
            }

        </style>
    </head>
    <body>
        <div class="header">Not selected</div>
        <div class="header headerSortDown">Arrow up (sorting ASC)</div>
        <div class="header headerSortUp">Arrow down (sorting DESC)</div>
    </body>
</html> 
```

这是[关于使用 CSS 边框绘制三角形的好教程](http://jonrohan.me/guide/css/creating-triangles-in-css/)。

**编辑**

**DIV**标记使用`block`显示，因此它会尝试使用全宽或 CSS 样式中给出的宽度（在上面的示例中`200px`），如果您将使用带有某些`inline`元素的箭头，`A`或者`SPAN`箭头将“粘”到文本上。当然，您也可以强制将 DIV 显示为内联，这是最简单的方法（通过修改示例）

声明：`.header`删除`width`并添加`display: inline-block;`：

```
.header {
    /* width: 200px; don't set width anymore */
    background-color: #c2ccd1;
    padding: 4px;
    margin: 2px;
    display: inline-block; /* force displaying DIV as an inline element */
} 
```

要控制文本和箭头之间的空间，只需使用部分`margin-left`属性`.header:after`：

```
.header:after {
    content: "";
    float: right;
    margin-top: 7px;
    visibility: hidden;
    margin-left:4px; /* space between text and arrow for inline elements */
} 
```

或者，如果您想在内联元素中为箭头保留一个空间（以避免悬停时更改宽度） - 您还可以添加透明的“箭头”

```
.header:after {
    content: "";
    float: right;
    margin-top: 7px;
    visibility: visible; /* make it visible by default */
    margin-left:4px; /* space between text and arrow for inline elements */
    border: 4px solid transparent; /* set borders to transparent, so they won't show */
} 
```

# ios - UIPickerView 老虎机效果通过减慢和错开微调器动画

> ID：14102247
> 
> 赞同：1
> 
> 时间：2012-12-31T13:35:08.433
> 
> 标签：ios, uipickerview

我想放慢pickerview的动画速度来模拟老虎机效果。

如何减慢动画速度

```
[pickerView selectRow:601 inComponent:0 animated:YES]; 
```

另外，我怎样才能错开动画，以便组件 1 在组件 0 动画之后进行动画，等等。就像老虎机一样。

我尝试了以下代码来错开旋转，它们似乎都在同时旋转。

```
- (void) viewDidAppear:(BOOL)animated
{

    [UIView beginAnimations:@"reel1" context:nil]; // nil = dummy
    [UIPickerView setAnimationDelegate:self];
    [UIPickerView setAnimationDidStopSelector:@selector(reelAnimationFinished:finished:context:)];
    [reel selectRow:24 inComponent:0 animated:YES];
    [UIView commitAnimations];

}

- (void) reelAnimationFinished:(NSString *)animationID finished:(BOOL)finished context:(void *)context {
    if (animationID == @"reel1")
    {
        [UIView beginAnimations:@"reel2" context:nil]; // nil = dummy
        [UIPickerView setAnimationDelegate:self];
        [UIPickerView setAnimationDidStopSelector:@selector(reelAnimationFinished:finished:context:)];
        [reel selectRow:26 inComponent:1 animated:YES];
        [UIView commitAnimations];
    }
    else if (animationID == @"reel2")
    {
        [reel selectRow:29 inComponent:2 animated:YES];
    }
} 
```

# javascript - KnockoutJS 数组

> ID：14102248
> 
> 赞同：2
> 
> 时间：2012-12-31T13:35:09.433
> 
> 标签：javascript, arrays, knockout.js, observable

请查看这个 JS Bin [http://jsbin.com/iqikuf/3/edit](http://jsbin.com/iqikuf/3/edit)

在控制台中运行以下命令时，显示的结果对我来说很有意义。

> 声明：vd.tools.push(dataItem);
> 结果：2

但是为什么我们在控制台中运行时会得到以下结果？

> 声明：vd.tools.length
> 结果：0

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T06:03:16.380

正如 DCoder 指出的那样

需要括号

vd.tools().length

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-06T18:34:57.007

我想整合和解释 DCoder 的答案。

`vd.tools`指一个*observableArray*，它是一个 Javascript 对象，其`length`属性不指存储项目的数量。

通过“添加括号” `vd.tools()`，我们**获得了对***由 KnockoutJS 的 observableArray 包装的***底层数组的引用。****

 *这是存储我们数据的真实数组，在这里我们可以请求`length`期望正确结果的属性。

因此，DCoder 的回答非常有意义。*

# tfs - 在 Team Foundation Server 2010 中向迭代或版本添加注释

> ID：14102254
> 
> 赞同：2
> 
> 时间：2012-12-31T13:35:41.767
> 
> 标签：tfs

我的团队和内部业务客户经常询问 sprint 的开始/结束日期和预计的发布日期。有没有办法将注释附加到 TFS 中的迭代，以便可以发布和/或查询这些日期？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T21:59:03.923

查看以下链接，这些链接描述了如何为您的 sprint 设置开始和结束日期并能够跟踪这些日期。此外，请查看新的 Microsoft Visual Studio Scrum 1.0 流程模板。由于它具有 sprint 工作项类型，因此它可能能够为您的迭代添加注释或更多信息。TFS 2012 也具有您提到的功能类型。

[在 TFS 2010 中让敏捷为您服务](http://msdn.microsoft.com/en-us/magazine/hh205635.aspx)

[微软 Visual Studio Scrum 1.0](http://visualstudiogallery.msdn.microsoft.com/59ac03e3-df99-4776-be39-1917cbfc5d8e/)

# c# - 在每个函数调用上创建类实例与将类实例作为参数传递

> ID：14102255
> 
> 赞同：1
> 
> 时间：2012-12-31T13:35:44.887
> 
> 标签：c#, .net

正如问题的标题所说，我想知道哪种方法是正确的。为了澄清我的问题，我想举一个例子。

假设在我的程序的主要方法中，我对方法/方法进行了一系列调用，这些方法/方法都使用了一个类的实例。所以-

1.  我是否应该在每次调用时在方法体中创建此类的实例。
2.  或者我应该在主方法中创建一次类的实例，然后将此实例作为参数传递给从主方法调用的所有方法。

混淆是因为我从未见过任何使用第二种方法的示例，我认为在第一种方法中处理时间会更多，因为每次调用使用此类的方法时都会创建类的实例。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:55:10.493

这取决于上下文：

*   有时您需要在方法之间共享同一个对象，因为创建实例的计算成本很高，或者拥有多个同一个对象的实例是完全错误的（想想字段、文件缓冲区、数据库连接等）。

*   有时您需要一次又一次地创建对象，即使计算成本很高，因为这是解决问题的正确方法（散列、OCR、搜索、解压缩等）。

*   大多数时候，创建另一个实例的成本可以忽略不计，并且您将模块化和良好的代码放在首位。

# c# - 从另一个线程中操作 UI 元素

> ID：14102257
> 
> 赞同：4
> 
> 时间：2012-12-31T13:36:05.113
> 
> 标签：c#, winforms, multithreading, user-interface, invoke

我试图让 WinForms C# 应用程序中的单独线程启动一个控制 ProgressBar（选取框）的后台工作程序。问题是，当我尝试将栏设置为可见时，它什么也不做，而且我尝试了多种形式的 Invoke，但它们似乎没有帮助。

`progressBarCycle`从单独的线程调用以下方法。

```
 BackgroundWorker backgroundWorker = new BackgroundWorker();

    public void progressBarCycle(int duration)
    {
        backgroundWorker.DoWork += new DoWorkEventHandler(backgroundWorker_DoWork);
        backgroundWorker.ProgressChanged += new ProgressChangedEventHandler(backgroundWorker_ProgressChanged);
        backgroundWorker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(backgroundWorker_RunWorkerCompleted);
        backgroundWorker.WorkerReportsProgress = true;
        backgroundWorker.WorkerSupportsCancellation = true;
        backgroundWorker.RunWorkerAsync(duration);
    }

    private void backgroundWorker_DoWork(object sender, DoWorkEventArgs e)
    {
        BackgroundWorker worker = sender as BackgroundWorker;

        worker.ReportProgress(0);

        DateTime end = DateTime.Now.AddMilliseconds((int)e.Argument);
        while (DateTime.Now <= end)
        {
            System.Threading.Thread.Sleep(1000);
        }
    }

    private void backgroundWorker_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
    {
        if (!this.IsHandleCreated)
            this.CreateHandle();
        statusStrip1.Invoke((MethodInvoker)delegate
        {
            progressBar1.Visible = false;
        });
        //    if (!this.IsHandleCreated)
        //    {
        //        this.CreateHandle();
        //        if (InvokeRequired) this.Invoke((MethodInvoker)(() => progressBar1.Visible = false));
        //        else progressBar1.Visible = false;
        //    }
        //    else
        //        if (InvokeRequired) this.Invoke((MethodInvoker)(() => progressBar1.Visible = false));
        //        else progressBar1.Visible = false;
    }

    private void backgroundWorker_ProgressChanged(object sender, ProgressChangedEventArgs e)
    {
        if (!this.IsHandleCreated)
            this.CreateHandle();
        statusStrip1.Invoke((MethodInvoker)delegate
        {
            progressBar1.Visible = true;
        });
        //    if (!this.IsHandleCreated)
        //    {
        //        this.CreateHandle();
        //        if (InvokeRequired) this.Invoke((MethodInvoker)(() => progressBar1.Visible = true));
        //        else progressBar1.Visible = true;
        //    }
        //    else
        //        if (InvokeRequired) this.Invoke((MethodInvoker)(() => progressBar1.Visible = true));
        //        else progressBar1.Visible = true;
    } 
```

我在这里遗漏了一些明显的东西吗？评论部分是我尝试过的其他事情。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T13:38:15.760

`ProgressChanged`已在 UI 线程*上*引发（通过同步上下文）；您`ProgressChanged`不需要这样做`Invoke`- 它可以直接操作 UI（相比之下，`DoWork`绝对**不能**这样做）。也许真正的问题是你没有在循环`worker.ReportProgress(...)` *内*做任何事情——所以它只在开始时发生一次。

这是一个完整的例子：

```
using System;
using System.ComponentModel;
using System.Threading;
using System.Windows.Forms;
static class Program
{
    [STAThread]
    static void Main()
    {
        Application.EnableVisualStyles();
        using (var worker = new BackgroundWorker {
            WorkerReportsProgress = true })
        using (var progBar = new ProgressBar {
            Visible = false, Step = 1, Maximum = 100,
            Dock = DockStyle.Bottom })
        using (var btn = new Button { Dock = DockStyle.Top, Text = "Start" })
        using (var form = new Form { Controls = { btn, progBar } })
        {
            worker.ProgressChanged += (s,a) => {
                progBar.Visible = true;
                progBar.Value = a.ProgressPercentage;
            };
            worker.RunWorkerCompleted += delegate
            {
                progBar.Visible = false;
            };
            worker.DoWork += delegate
            {
                for (int i = 0; i < 100; i++)
                {
                    worker.ReportProgress(i);
                    Thread.Sleep(100);
                }
            };
            btn.Click += delegate
            {
                worker.RunWorkerAsync();
            };
            Application.Run(form);
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T20:24:06.837

另一种需要注意的可能性是进度条正在您的 UI 线程上运行。为了显示进度条并重绘自身以显示新的进度量，UI 线程必须自由运行，在主应用程序循环中处理 windows 消息。

因此，如果您启动后台工作线程，但您的 UI 线程处于繁忙的等待循环中等待它完成，或者关闭并执行大量其他工作，那么它将不会处理 Windows 消息并且您的进度条将是“反应迟钝”。您需要释放 UI 线程，以便这种更新仍然发生（即从您的事件处理程序返回并允许 UI 继续正常运行）。

这样做的危险在于，如果 UI 处于活动状态，那么用户仍然可以与之交互。因此，您必须编写 UI 以了解后台工作程序何时处于活动状态，并正确处理这种情况（问题可能包括：允许用户在后台工作程序已经运行时再次启动它，UI 尝试在工作程序时显示信息线程忙于更新它，用户决定在后台工作人员忙时加载新文档或退出等）。对此的两个主要解决方案是将 UI 的每一点都包裹在一个保护罩中，以阻止在后台工作运行时启动任何危险（如果您有很多控件要以这种方式包裹，这可能是很多工作，并且很容易犯错误，导致错误溜走）或让 UI “不受保护”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T18:48:25.090

1.  `progressBarCycle`从 UI 线程运行。`RunWorkerAsync`将为您创建新线程。
2.  在`backgroundWorker_ProgressChanged`简单地调用 `progressBar1.Visible = true;`. 没有必要`Invoke`。
3.  最好还添加一个`progressBar1.Refresh();`.

# opengl-es - OpenGLES 2.0 设置顶点颜色

> ID：14102266
> 
> 赞同：1
> 
> 时间：2012-12-31T13:37:08.617
> 
> 标签：opengl-es, opengl-es-2.0

我正在创建一个绘图应用程序，需要定期更改颜色。所以，一个点可能是绿色的，另一个是红色的。

我正在尝试按以下方式进行操作：-

程序

```
glBindAttribLocation(_program, ATTRIB_COLOR, "color"); 
```

顶点着色器

```
attribute vec4 position;
attribute float size;
attribute vec4 color;
varying vec4 fragColor;

void main()
{
    gl_Position = position;
    gl_PointSize = 30.0;
    fragColor = color;
} 
```

片段着色器

```
precision mediump float;
varying vec4 fragColor;

void main() {

    gl_FragColor = fragColor;

} 
```

问题是，颜色会根据点在屏幕上的位置而有所不同。如果我将红色设置为属性的颜色，我需要它在屏幕上出现的任何位置都是纯红色。

![在此处输入图像描述](../Images/af5c7373ff0425d71feabb1e38c3b0c7.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T17:04:19.320

该问题与上述代码无关。我没有对齐程序发送到着色器的属性数据。

# android - 使用 KSOAP 调用 Web 服务时出现 NumberFormatException

> ID：14102271
> 
> 赞同：1
> 
> 时间：2012-12-31T13:37:42.770
> 
> 标签：android, android-ksoap2, numberformatexception

我正在调用`PHP`使用此代码创建的网络服务

```
SoapObject request = new SoapObject("getCustomerInfo",  "getCustomerInfo");
    request.addProperty("user_id", Info.userId);
    request.addProperty("authToken", Info.authToken);
    request.addProperty("request_id", Integer.toString(CUSTOMERACCOUNTINFO));

SoapSerializationEnvelope envelope = new SoapSerializationEnvelope(SoapEnvelope.VER11);
        envelope.dotNet = true;
        envelope.setOutputSoapObject(request);
        HttpTransportSE httpTransport = new HttpTransportSE(soapURL);
        httpTransport.debug=true;
        try {               
            httpTransport.call(soap, envelope); //Throwing Exception here
            System.out.println("dump state "+httpTransport.responseDump);
            client.success((Object) envelope.getResponse());
        }catch(NumberFormatException e){
            e.printStackTrace();
            System.out.println(" exception  num format");
            //client.error("NumberFormatException");
            client.error(e.getLocalizedMessage());
        }catch(XmlPullParserException xppe){
            System.out.println(" exception  pullparser");
            //client.error("XmlPullParserException");
            client.error(xppe.getLocalizedMessage());
        }catch(IOException ioe){
            System.out.println(" exception  io"+ ioe.toString());
            //client.error("IOException");
            client.error(ioe.getLocalizedMessage());
        } 
```

并得到以下错误

```
12-31 10:52:03.024: W/System.err(2306): java.lang.NumberFormatException: Invalid int: ""
12-31 10:52:03.074: W/System.err(2306):     at java.lang.Integer.invalidInt(Integer.java:138)
12-31 10:52:03.104: W/System.err(2306):     at java.lang.Integer.parseInt(Integer.java:359)
12-31 10:52:03.124: W/System.err(2306):     at java.lang.Integer.parseInt(Integer.java:332)
12-31 10:52:03.134: W/System.err(2306):     at org.ksoap2.serialization.DM.readInstance(DM.java:39)
12-31 10:52:03.145: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.readInstance(SoapSerializationEnvelope.java:406)
12-31 10:52:03.155: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:364)
12-31 10:52:03.174: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.readUnknown(SoapSerializationEnvelope.java:233)
12-31 10:52:03.184: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:366)
12-31 10:52:03.194: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.readVector(SoapSerializationEnvelope.java:287)
12-31 10:52:03.214: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.readInstance(SoapSerializationEnvelope.java:432)
12-31 10:52:03.224: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:364)
12-31 10:52:03.234: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.readUnknown(SoapSerializationEnvelope.java:233)
12-31 10:52:03.254: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.read(SoapSerializationEnvelope.java:366)
12-31 10:52:03.264: W/System.err(2306):     at org.ksoap2.serialization.SoapSerializationEnvelope.parseBody(SoapSerializationEnvelope.java:121)
12-31 10:52:03.274: W/System.err(2306):     at org.ksoap2.SoapEnvelope.parse(SoapEnvelope.java:137)
12-31 10:52:03.284: W/System.err(2306):     at org.ksoap2.transport.Transport.parseResponse(Transport.java:63)
12-31 10:52:03.294: W/System.err(2306):     at org.ksoap2.transport.HttpTransportSE.call(HttpTransportSE.java:100)
12-31 10:52:03.334: W/System.err(2306):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
12-31 10:52:03.344: W/System.err(2306):     at java.util.concurrent.FutureTask.run(FutureTask.java:234)
12-31 10:52:03.364: W/System.err(2306):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
12-31 10:52:03.374: W/System.err(2306):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1080)
12-31 10:52:03.384: W/System.err(2306):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:573)
12-31 10:52:03.394: W/System.err(2306):     at java.lang.Thread.run(Thread.java:856) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:45:22.600

此错误意味着您正在传递空字符串“”，而被调用的方法需要一个数字的字符串表示形式。或者更准确地说，您应该发送的消息必须在某处包含一个数字，而不是*可以解释为数字的东西，*您传递的是空字符串。

仔细检查您放入的参数的值`request`。我猜其中之一是导致异常的空字符串。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:02:29.553

我认为在 CUSTOMERACCOUNTINFO 中的值为 null ...因此，请确保向 CUSTOMERACCOUNTINFO 添加一些值并将解析为 Integer ..

**或者**

做出这样的条件..

```
if(CUSTOMERACCOUNTINFO.length()>0)
{
   SoapObject request = new SoapObject("getCustomerInfo",  "getCustomerInfo");
   request.addProperty("user_id", Info.userId);
   request.addProperty("authToken", Info.authToken);
   request.addProperty("request_id", Integer.toString(CUSTOMERACCOUNTINFO));
} 
```

# svn - Subversion：为单个用户在不同机器上提交多个签出

> ID：14102272
> 
> 赞同：0
> 
> 时间：2012-12-31T13:37:45.870
> 
> 标签：svn, svn-checkout

在我的 linux 虚拟服务器上，我正在运行 subversion，一切正常。作为一个单一的开发人员，我在我的本地机器（max osx）上使用 1 checkout，编辑文件，提交等等，一切都很好。我想要什么：我想在另一台机器上进行第二次结账（没问题）。在那个位置我想编辑文件（没问题）并将其提交到存储库。所以我的问题是：使用第二个结帐目录时使用第二个“虚拟”用户更好（或必要）吗？- 就像“模拟”好像有两个开发人员一样？或者使用我创建的唯一一个颠覆用户来管理和使用两个或多个结帐目录是否没有问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T16:12:11.210

Subversion 不介意任何一种方式。

通常，您会在两台机器上使用相同的用户。

如果您认为使用两个不同的帐户很有用，您也可以这样做。

# iphone - 如何在 xcode 4.1 中使用 json 类

> ID：14102273
> 
> 赞同：1
> 
> 时间：2012-12-31T13:37:46.570
> 
> 标签：iphone, json

我想在 xcode 4.1 中使用 nsjsonseraliazation 类....如何使用它？我应该下载一些框架吗？如果是，那么我在哪里可以下载它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T13:41:10.433

它是原生的，并且从 iOS 5.0 开始可用，使用它所需要做的就是调用它。
无需下载额外的框架。它实际上是构成 Objective C 应用程序基础的 Foundation 框架的一部分。

您可以[在 Apple 的网站上找到文档](http://developer.apple.com/library/ios/documentation/Foundation/Reference/NSJSONSerialization_Class/)。

# javascript - 平滑加速度计值

> ID：14102283
> 
> 赞同：1
> 
> 时间：2012-12-31T13:38:27.050
> 
> 标签：javascript, android, html, cordova, lowpass-filter

我正在创建一个 android phonegap 应用程序，它使用加速度计来检测道路上的缺陷。但是，当我使用原始加速度计值（x、y 和 z）时，它们从一次尝试到另一次尝试变化太大。我尝试使用相同的设备、相同的车辆和位置来获取相同的缺陷，但是加速度计给出的值完全不同。我每 0.25 秒获取一次加速度计值，所以每秒我会得到 4 个 x、y 和 z 值。

谁能告诉我如何平滑这些值以获得更平滑和更可靠的值？我将需要使用这些值对它们进行进一步处理，因此 x、y 和 z 值的准确性至关重要。是否有任何公式可以应用于这些值以获得更平滑的输出？

更新：添加我的代码片段：

```
function acc() {
var accOpt = { frequency: 1000 };  
previousReading = {
    x   :   null,
    y   :   null,
    z   :   null,
    lr  :   null,
    fb  :   null            
  }; 
watchID = navigator.accelerometer.watchAcceleration(win, fail, accOpt);    
}

function win (acceleration) {

var tiltLR = 0;
var tiltFB = 0;

var facingUp = -1;
if (acceleration.z > 0) {
  facingUp = +1;
}

tiltLR = Math.round(((acceleration.x) / 9.81) * -90);
tiltFB = Math.round(((acceleration.y + 9.81) / 9.81) * 90 * facingUp);

  var changes = {};

  if (previousReading.x !== null) {
      changes.x = Math.abs(previousReading.x-acceleration.x);
      changes.y = Math.abs(previousReading.y-acceleration.y);
      changes.z = Math.abs(previousReading.z-acceleration.z);
      changes.lr = Math.abs(previousReading.lr-tiltLR);
      changes.fb = Math.abs(previousReading.fb-tiltFB);
  }

  previousReading = {
      x: acceleration.x,
      y: acceleration.y,
      z: acceleration.z,
      lr: tiltLR,
      fb: tiltFB
  };

console.log('previousReading x: ' + previousReading.x + ' previousReading y: ' + previousReading.y + ' previousReading z: ' + previousReading.z+ ' previousReading lr: ' + tiltLR + ' previousReading fb: ' + tiltFB);

console.log('changes x: ' + changes.x  + ' changes y: ' + changes.y + ' changes z: ' + changes.z + ' changes lr: ' + changes.lr + ' changes fb: ' + changes.fb);

console.log(acceleration.x + ' ' + acceleration.y + ' ' + acceleration.z);

 } 
```

过滤器：我遇到过这段代码来平滑 x、y 和 z 值。如果我将此应用于当前的 x、y、z 值，然后将它们与以前的值（也被过滤掉）进行比较，这对我来说是否有效？

```
 #define kFilteringFactor 0.1

 // Use a basic low-pass filter to keep only the gravity component of each axis.
 grav_accelX = (acceleration.x * kFilteringFactor) + ( grav_accelX * (1.0 - kFilteringFactor));
 grav_accelY = (acceleration.y * kFilteringFactor) + ( grav_accelY * (1.0 - kFilteringFactor));
 grav_accelZ = (acceleration.z * kFilteringFactor) + ( grav_accelZ * (1.0 - kFilteringFactor));

 // Subtract the low-pass value from the current value to get a simplified high-pass filter
 instant_accelX = acceleration.x - ( (acceleration.x * kFilteringFactor) + (instant_accelX * (1.0 - kFilteringFactor)) );
 instant_accelY = acceleration.y - ( (acceleration.y * kFilteringFactor) + (instant_accelY * (1.0 - kFilteringFactor)) );
 instant_accelZ = acceleration.z - ( (acceleration.z * kFilteringFactor) + (instant_accelZ * (1.0 - kFilteringFactor)) ); 
```

# java - 删除android中底部布局和滚动视图之间的空格

> ID：14102285
> 
> 赞同：1
> 
> 时间：2012-12-31T13:39:02.223
> 
> 标签：java, android

![在此处输入图像描述](../Images/220fb016850b8330b16302dd5719b5e4.png)

下面是xml代码....

朋友帮我如何避免scrollview和bottomLayout之间的空间

xml文件：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="@color/addNewEventsCommonbg" >

    <TextView
        android:id="@+id/addNewEventsTitle"
        android:layout_width="match_parent"
        android:layout_height="35dp"
        android:layout_alignParentTop="true"
        android:background="@drawable/dialog_title_bg"
        android:gravity="center_vertical"
        android:paddingLeft="20dp"
        android:text="@string/AddNewEvents"
        android:textColor="@color/whiteColor"
        android:textSize="16sp"
        android:textStyle="normal" />

    <TextView
        android:id="@+id/addNewEventsTitleName"
        android:layout_width="match_parent"
        android:layout_height="35dp"
        android:layout_below="@+id/addNewEventsTitle"
        android:background="@color/addNewEventsTitleNamebg"
        android:drawableLeft="@drawable/mail_sent_icon"
        android:drawablePadding="10dp"
        android:gravity="center_vertical"
        android:paddingLeft="20dp"
        android:text="@string/AddNewEvent"
        android:textColor="@color/whiteColor"
        android:textSize="16sp"
        android:textStyle="normal" />

    <ScrollView
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_above="@+id/bottomLayout"
        android:layout_below="@+id/addNewEventsTitleName" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <LinearLayout
                android:id="@+id/addNewEventsEventLayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:orientation="horizontal" >

                <TextView
                    android:layout_width="100dp"
                    android:layout_height="wrap_content"
                    android:gravity="left|center_vertical"
                    android:paddingLeft="20dp"
                    android:text="@string/AddNewEvent"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />

                <EditText
                    android:id="@+id/addNewEventsName"
                    style="@style/edittext_style"
                    android:layout_width="match_parent"
                    android:layout_height="@dimen/AddNewEventsHeight"
                    android:layout_marginRight="10dp"
                    android:gravity="center_vertical|left"
                    android:inputType="text|textCapSentences"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/addNewEventsDateTimeLayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:orientation="horizontal" >

                <LinearLayout
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:orientation="horizontal" >

                    <TextView
                        android:layout_width="100dp"
                        android:layout_height="match_parent"
                        android:gravity="left|center_vertical"
                        android:paddingLeft="20dp"
                        android:text="@string/addNewEventsDate"
                        android:textColor="@color/addNewEventsTextColor"
                        android:textSize="16sp" />

                    <TextView
                        android:id="@+id/addNewEventsDate"
                        android:layout_width="match_parent"
                        android:layout_height="@dimen/AddNewEventsHeight"
                        android:layout_marginLeft="5dp"
                        android:background="@drawable/wedding_date_bg"
                        android:gravity="center"
                        android:text="@string/setDate"
                        android:textColor="@color/whiteColor"
                        android:textSize="16sp" />
                </LinearLayout>

                <LinearLayout
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_marginRight="10dp"
                    android:layout_weight="1"
                    android:orientation="horizontal" >

                    <TextView
                        android:layout_width="100dp"
                        android:layout_height="match_parent"
                        android:gravity="right|center_vertical"
                        android:paddingRight="20dp"
                        android:text="@string/AddNewEventsTime"
                        android:textColor="@color/addNewEventsTextColor"
                        android:textSize="16sp" />

                    <TextView
                        android:id="@+id/addNewEventsTime"
                        android:layout_width="match_parent"
                        android:layout_height="@dimen/AddNewEventsHeight"
                        android:layout_marginLeft="5dp"
                        android:background="@drawable/wedding_date_bg"
                        android:gravity="center"
                        android:text="@string/setTime"
                        android:textColor="@color/whiteColor"
                        android:textSize="16sp" />
                </LinearLayout>
            </LinearLayout>

            <LinearLayout
                android:id="@+id/addNewEventsAddressLayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:orientation="horizontal" >

                <TextView
                    android:layout_width="100dp"
                    android:layout_height="match_parent"
                    android:gravity="center_vertical"
                    android:paddingLeft="20dp"
                    android:text="@string/address"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />

                <EditText
                    android:id="@+id/addNewEventsAddress"
                    style="@style/edittext_style"
                    android:layout_width="match_parent"
                    android:layout_height="@dimen/AddNewEventsAddressHeight"
                    android:layout_marginRight="10dp"
                    android:gravity="center_vertical|left"
                    android:inputType="textPostalAddress"
                    android:paddingBottom="5dp"
                    android:paddingLeft="5dp"
                    android:paddingRight="5dp"
                    android:paddingTop="5dp"
                    android:singleLine="false"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/addNewEventsContactLayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:orientation="horizontal" >

                <TextView
                    android:layout_width="100dp"
                    android:layout_height="match_parent"
                    android:gravity="left|center_vertical"
                    android:paddingLeft="20dp"
                    android:text="@string/AddNewEventContact"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />

                <EditText
                    android:id="@+id/addNewEventsContacts"
                    style="@style/edittext_style"
                    android:layout_width="match_parent"
                    android:layout_height="@dimen/AddNewEventsHeight"
                    android:layout_marginRight="10dp"
                    android:gravity="center_vertical|left"
                    android:inputType="text|textCapSentences"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/addNewEventsPhoneFaxLayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:baselineAligned="false"
                android:orientation="horizontal" >

                <LinearLayout
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_weight="1"
                    android:orientation="horizontal" >

                    <TextView
                        android:layout_width="100dp"
                        android:layout_height="match_parent"
                        android:gravity="left|center_vertical"
                        android:paddingLeft="20dp"
                        android:text="@string/AddNewEventsPhone"
                        android:textColor="@color/addNewEventsTextColor"
                        android:textSize="16sp" />

                    <EditText
                        android:id="@+id/addNewEventsPhone"
                        style="@style/edittext_style"
                        android:layout_width="match_parent"
                        android:layout_height="@dimen/AddNewEventsHeight"
                        android:inputType="phone"
                        android:textColor="@color/addNewEventsTextColor"
                        android:textSize="16sp" />
                </LinearLayout>

                <LinearLayout
                    android:layout_width="0dp"
                    android:layout_height="wrap_content"
                    android:layout_marginRight="10dp"
                    android:layout_weight="1"
                    android:orientation="horizontal" >

                    <TextView
                        android:layout_width="100dp"
                        android:layout_height="match_parent"
                        android:gravity="right|center_vertical"
                        android:paddingRight="20dp"
                        android:text="@string/AddNewEventsFax"
                        android:textColor="@color/addNewEventsTextColor"
                        android:textSize="16sp" />

                    <EditText
                        android:id="@+id/addNewEventsFax"
                        style="@style/edittext_style"
                        android:layout_width="match_parent"
                        android:layout_height="@dimen/AddNewEventsHeight"
                        android:inputType="text|phone"
                        android:textColor="@color/addNewEventsTextColor"
                        android:textSize="16sp" />
                </LinearLayout>
            </LinearLayout>

            <LinearLayout
                android:id="@+id/addNewEventsEmailLayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:orientation="horizontal" >

                <TextView
                    android:layout_width="100dp"
                    android:layout_height="match_parent"
                    android:gravity="left|center_vertical"
                    android:paddingLeft="20dp"
                    android:text="@string/email"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />

                <EditText
                    android:id="@+id/addNewEventsEmail"
                    style="@style/edittext_style"
                    android:layout_width="match_parent"
                    android:layout_height="@dimen/AddNewEventsHeight"
                    android:layout_marginRight="10dp"
                    android:gravity="center_vertical|left"
                    android:inputType="textWebEmailAddress"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />
            </LinearLayout>

            <LinearLayout
                android:id="@+id/addNewEventsWebsiteLayout"
                android:layout_width="fill_parent"
                android:layout_height="wrap_content"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:orientation="horizontal" >

                <TextView
                    android:layout_width="100dp"
                    android:layout_height="match_parent"
                    android:gravity="left|center_vertical"
                    android:paddingLeft="20dp"
                    android:text="@string/AddNewEventsWebsite"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />

                <EditText
                    android:id="@+id/addNewEventsWebsite"
                    style="@style/edittext_style"
                    android:layout_width="match_parent"
                    android:layout_height="@dimen/AddNewEventsHeight"
                    android:layout_marginRight="10dp"
                    android:gravity="center_vertical|left"
                    android:inputType="textWebEditText"
                    android:textColor="@color/addNewEventsTextColor"
                    android:textSize="16sp" />
            </LinearLayout>

            <EditText
                android:id="@+id/AddNewEventsComments"
                style="@style/edittext_style"
                android:layout_width="match_parent"
                android:layout_height="@dimen/AddNewEventsCommentsHeight"
                android:layout_marginLeft="10dp"
                android:layout_marginRight="10dp"
                android:layout_marginTop="@dimen/AddNewEventsTopMargin"
                android:gravity="left"
                android:inputType="textMultiLine"
                android:paddingBottom="5dp"
                android:paddingLeft="5dp"
                android:paddingRight="5dp"
                android:paddingTop="5dp"
                android:singleLine="false"
                android:textColor="@color/addNewEventsTextColor"
                android:textSize="16sp" />
        </LinearLayout>
    </ScrollView>

    <LinearLayout
        android:id="@+id/bottomLayout"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:orientation="horizontal" >

        <Button
            android:id="@+id/addNewEventsCancelBtn"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_marginBottom="3dp"
            android:layout_marginLeft="5dp"
            android:layout_marginRight="2dp"
            android:layout_weight="1"
            android:background="@drawable/cancel_btn_selector"
            android:text="@string/cancel"
            android:textColor="@color/whiteColor"
            android:textSize="18sp" />

        <Button
            android:id="@+id/addNewEventsSaveBtn"
            android:layout_width="0dp"
            android:layout_height="wrap_content"
            android:layout_marginBottom="3dp"
            android:layout_marginLeft="2dp"
            android:layout_marginRight="5dp"
            android:layout_weight="1"
            android:background="@drawable/save_btn_selector"
            android:text="@string/save"
            android:textColor="@color/whiteColor"
            android:textSize="18sp" />
    </LinearLayout>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:05:10.957

```
 <ScrollView
    android:layout_width="match_parent"
    android:layout_height="match_parent"// Gained the whole vertical space
    android:layout_weight="1"   // Adding weight makes another layout fix and adjustable after these
    android:layout_above="@+id/bottomLayout"
    android:layout_below="@+id/addNewEventsTitleName" > 
```

希望这些可能有效！

# paypal - 贝宝 IPN 唯一 ID

> ID：14102289
> 
> 赞同：0
> 
> 时间：2012-12-31T13:39:42.783
> 
> 标签：paypal, paypal-ipn

我正在使用贝宝通过让他们支付 0.01 美元并获取他们的 IPN 信息来验证我网站上的用户。

因此，为了防止双重订阅，我需要一条通过**绝对**唯一的通知发送的信息。

我注意到人们可以通过贝宝更改他们的电子邮件，所以电子邮件是不可行的。IPN 中是否存在独特且不会随时间变化的内容，例如进行其他付款或更改电子邮件地址？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T19:20:01.957

PayPal 提供了一个 PayerID，它是 PayPal 账户的唯一标识符。无论用户如何使用他们的电子邮件地址或其他任何东西，它都不会改变。它作为 payer_id 在 IPN 中返回。

# c# - Resharper 查找模式和替换 - 如何插入字符串

> ID：14102291
> 
> 赞同：10
> 
> 时间：2012-12-31T13:39:45.360
> 
> 标签：c#, refactoring, resharper, automated-refactoring

我们有一个健全的检查方法

```
void IsNotNull<T>(T obj){...} 
```

调用

```
IsNotNull(obj); 
```

我想替换它来调用另一个重载，该重载需要第二个字符串类型的参数（消息）

```
void IsNotNull<T>(T obj, string message){...} 
```

所以我想将调用更改为

```
IsNotNull(obj, "obj is null"); 
```

我正在尝试使用 resharper 的查找模式和替换来实现这一点。

所以我的查找模式是：`IsNotNull($args$)`- 这工作正常，它找到方法调用

替换模式：`IsNotNull($args$, "$args$ is null")` - 这没有任何作用

我也试过这个`IsNotNull($args$, """" + $args$ + """")`

--Edited-- 建议框显示正确的措辞（对于参数和标识符），但一旦应用它就不同了。我正在使用 Resharper 6

![在此处输入图像描述](../Images/b5a12bf60005f48192138096b498bce8.png)

应用建议后，我得到了这个 ![在此处输入图像描述](../Images/868ccb26e31f0645d34e24fb5b050bb9.png)

当我单击编辑模式时 ![在此处输入图像描述](../Images/8d52ced7cbac13f96596bbaf2462683f.png)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T14:55:40.907

您`$args$`在搜索和替换中定义的参数是什么？如果你做到了`Identifier`，那么你替换应该工作：

> 查找：`IsNotNull($args$)`- 替换在`$args$`哪里：`Identifier`
> `IsNotNull($args$, "$args$ is null")`

你应该有你想要的结果，即`IsNotNull(obj, "obj is null")`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:10:45.377

您可以考虑尝试使用这种模式：

```
IsNotNull($args$, string.Format("{0} is null", $args$)) 
```

ReSharper 7.1 非常适合我。

看起来，R# 通常不想在字符串文字内评估参数表达式。鉴于你的模式

```
IsNotNull($args$, "$args$ is null") 
```

取而代之`IsNotNull(5);`的`IsNotNull(5, 5);`是奇怪的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-02T16:40:54.223

最简单的方法是像这样重写原始方法：

```
void IsNotNull<T>(T obj){
    IsNotNull(obj, "obj is null");
} 
```

然后单击方法签名，并选择 Refactor->Inline Method (Ctrl+R, Ctrl+I)。如果您需要保留原始方法签名，您可以，或者您可以选中“删除内联方法声明”框。

编辑：看起来 hmemcpy 的解决方案适用于 7.1，所以我建议升级。但是，如果这不可行，请在 Visual Studio 中尝试以下正则表达式查找和替换。

```
Find: IsNotNull\(([^\),]+)\);
Replace: IsNotNull($1, "$1 is null"); 
```

确保选中“使用正则表达式”，并且“查找范围：”应该是“整个解决方案”。

# iphone - MKMapView：缩放到默认的“国家级别”

> ID：14102292
> 
> 赞同：3
> 
> 时间：2012-12-31T13:39:46.720
> 
> 标签：iphone, ios, mkmapview, core-location

当将 MKMapView 放入 UIViewController 并将其设置为卫星视图时，地图会缩放并调整以显示用户当前所在的整个国家：例如美国，如下所示。

当用户现在正在缩放地图或我正在以编程方式缩放地图时，它似乎无法恢复此默认缩放级别。

当然，我可以找出这个默认缩放的坐标以便缩放回那个设置，但实际上我需要为每个国家都这样做，这并不值得。

有人知道如何解决这个问题吗？

![具有默认缩放级别的 MKMapView 显示美国](../Images/fd6a50d99c1837c7c7cc3dd6c917141a.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T14:57:38.147

为此，它需要两种类型的信息。所选国家/地区的中心坐标以及要在地图上为 region.span 设置的正确值。它可能可以访问 Apple Maps 数据库中的数据。我不知道这会向我们公开。但是，如果您四处搜索，互联网上还有其他地理编码数据库可能会为您提供这两个值。

如果你找到一个有你想要的，然后你在地图上设置它使用：

```
myMKMapView.region.center = // Center coordinates of country
myMKMapView.region.span = // A value large enough to enclose the country. 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-09-25T14:29:31.520

您可以简单地将默认区域保存在 viewDidAppear 上，然后在需要时使用它：}

```
class MyController: UIViewController {
    @IBOutlet weak var mapView: MKMapView!
    var defaultRegion: MKCoordinateRegion?

    override func viewDidAppear(animated: Bool) {
        defaultRegion = mapView.region
    }

    func showDefaultMapArea() {
        if let region = defaultRegion {
            mapView.setRegion(region, animated: true)
        }
    } 
```

# java - 什么是默认 jvm 错误日志位置？

> ID：14102293
> 
> 赞同：12
> 
> 时间：2012-12-31T13:39:52.073
> 
> 标签：java

如果执行时未指定错误日志位置`java -cp ../blah someplace/somejar.jar`，jvm 错误日志将写入何处？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T13:43:54.877

“jvm错误”是什么意思？如果您参考堆栈跟踪，这些被写入`System.err`导致`standard error stream`. 这通常按原样打印在您的终端`System.out`中。如果需要，您可以在调用 JVM 时（使用`2> /my/file.log`）或在代码中通过重定向来重定向它`System.err`。

一些日志框架重定向标准错误，然后它取决于你的配置。

如果您参考 JVM 崩溃日志（如果 JVM 崩溃则创建该日志，如果您不使用 JNI，则永远不会发生这种情况，但实际上它们有时会发生）情况就不同了。这些通常在启动 jvm 的文件夹中创建。如果此文件夹不可写，`/tmp`则在 Unix 系统上使用该目录。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-05-18T17:09:31.787

根据[Java Platform, Standard Edition Troubleshooting Guide: Location of Fatal Error Log](https://docs.oracle.com/javase/8/docs/technotes/guides/troubleshoot/felog001.html) ，如果未指定标志，系统会尝试**在进程的工作目录中创建文件。**`-XX:ErrorFile=file`

如果无法在工作目录中创建文件（空间不足、权限问题或其他问题），则在操作系统的临时目录中创建文件。

*   在**Oracle Solaris**和**Linux**操作系统上，临时目录是`/tmp`.

*   在**Windows**上，临时目录由`TMP`环境变量的值指定；如果未定义该`TEMP`环境变量，则使用环境变量的值。

# vba - Word2010 形状 GroupItems 无法获取 TextFrame2.TextRange

> ID：14102297
> 
> 赞同：0
> 
> 时间：2012-12-31T13:40:41.383
> 
> 标签：vba, vsto, ms-office, ms-word, shapes

我打开了一个由 word2010 编辑的 docx，在这个文档中，我有一些使用组的形状。但是当我得到子形状时，我无法得到子形状文本。这是我的代码。有人能告诉我为什么吗？谢谢。

```
Word.Application woradApp = new Word.Application();
            Word.Document doc = woradApp.Documents.Open(@"D:\ABC\a.docx");
            Word.Shapes Shapes =doc.Shapes;
            List<Word.Shape> list = Shapes.Cast<Word.Shape>().ToList<Word.Shape>();
            foreach (Word.Shape shape in list)
            {
                if (shape.Type == MsoShapeType.msoGroup)
                {
                    Word.GroupShapes dyShapes = shape.GroupItems;                  
                    foreach (dynamic item in dyShapes)
                    {
                        var range = item.TextFrame2.TextRange;
                    }
                }
            } 
```

“item.TextFrame2.TextRange.Text”代码给出了一个异常，因为“TextRange”为空，这应该有文本，在哪里可以得到文本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-06T11:47:14.800

请展示你的什么是`var range`，它是一个`Range`对象还是`TextRange`对象？我假设它只是一个`variant array`.

以下是一些尝试的步骤：

1.  确保每个形状都支持[`TextFrame2`](http://msdn.microsoft.com/en-us/library/office/ff862416.aspx)属性
2.  `Ungroup`第`shapes`一个
3.  像您这样做一样循环遍历形状以检查所需的值
4.  确保处理`null`if `TextRange`has no value ...在您的情况下，这很可能是罪魁祸首。
5.  对形状进行分组。

    foreach（dyShapes 中的动态项目）{ if not IsNull(item.TextFrame2.TextRange.Characters.Text) { var range = item.TextFrame2.TextRange.Characters.Text; } }

`Null`首先，您可以通过处理当前代码来尝试。如果失败，请尝试该`ungrouping`建议。

# wcf - 如何限制 WCF MSMQ 终结点？

> ID：14102301
> 
> 赞同：2
> 
> 时间：2012-12-31T13:40:56.470
> 
> 标签：wcf, msmq

我是 WCF 的新手，刚刚学习如何让客户端使用 MSMQ 与主机（都在控制台应用程序中）对话。

我希望能够从客户端向主机发送消息并让主机立即接收它们，或者，如果主机停止，则在重新启动时从中断的地方继续。

我几乎可以正常工作，但是我发现当我重新启动主机时队列中有十条消息时，消息没有按队列顺序处理。我认为有一些多线程正在进行，使它们看起来乱序。我希望能够将 WCF 服务限制为一次处理一条消息以阻止这种情况发生（除非有更好的解决方案）。

对于我将要处理的系统而言，MSMQ 消息按顺序处理而不是并行处理是必不可少的。

我的服务合同的代码是：

```
[ServiceContract(Namespace = "http://www.heronfoods.com/DemoService")]
public interface IDemoService
{
    [OperationContract(IsOneWay = true)]
    void SendMessage(string message);
} 
```

对于服务合同实施，我有这个。（控制台输出是因为这是一个供我学习的演示应用程序）：

```
public class DemoService : IDemoService
{
    public void SendMessage(string message)
    {
        Console.WriteLine("{0} : {1}", DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss"), message);
    }
} 
```

我的主机应用程序是一个控制台应用程序，代码如下：

```
class Program
{
    static void Main(string[] args)
    {
        Console.Title = "WCF Host";

        using (var host = new ServiceHost(typeof(Library.DemoService)))
        {
            var endpoint = new ServiceEndpoint(
                ContractDescription.GetContract(typeof(Library.IDemoService)),
                new NetMsmqBinding(NetMsmqSecurityMode.None),
                new EndpointAddress("net.msmq://localhost/private/test"));

            host.AddServiceEndpoint(endpoint);

            host.Open();
            Console.WriteLine("Host Active");
            Console.ReadLine();
        }
    }
} 
```

客户端同样简单：

```
class Program
{
    static void Main(string[] args)
    {
        Console.Title = "WCF Client";

        IDemoService proxy = ChannelFactory<IDemoService>.CreateChannel(
            new NetMsmqBinding(NetMsmqSecurityMode.None),
            new EndpointAddress("net.msmq://localhost/private/test")
            );

        do
        {
            string msg = Console.ReadLine();
            if (msg=="")
                break;
            else
                proxy.SendMessage(msg);
        } while (true);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:43:35.227

我假设您的队列不是事务性的。

虽然我不确定是否有办法将 netMsmqBinding 限制为单个线程，但您不需要应用此限制。

为保证按顺序交付，您只需将队列设置为事务性，然后将该`exactlyOnce`属性应用于 netMsmqBinding 配置。

[请参见此处](https://stackoverflow.com/a/13634658/569662)的示例。

# c# - WPF 数据绑定与 ResourceDictionary MVVM

> ID：14102310
> 
> 赞同：5
> 
> 时间：2012-12-31T13:41:35.817
> 
> 标签：c#, wpf, mvvm, binding

我正在尝试将 View 与 ResourceDictionary 中的 ViewModel 绑定，但它不起作用。

该应用程序是一个非常简单的窗口，带有 2 个文本框。当我向 textbox1 键入文本时，textbox2 必须自动获得相同的文本。当然，视图中的文本框必须绑定到视图模型中的属性。

我是 WPF 新手，我开始绑定 View 和 ViewModel 的方式是在 View 的代码隐藏中：

```
DataContext = new MyViewModel(); 
```

现在我正在尝试实现更清洁的分离。我的代码是

应用程序.xaml：

```
<Application x:Class="NavigationCleanBinding.App"
         xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
         xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
         StartupUri="/Views/MainWindowView.xaml">
    <Application.Resources>
        <ResourceDictionary Source="MainResourceDictionary.xaml" />
    </Application.Resources>
</Application> 
```

MainResourceDictionary.xaml：

```
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xamlpresentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Views="clr-namespace:NavigationCleanBinding.Views"
    xmlns:ViewModels="clr-namespace:NavigationCleanBinding.ViewModels">

    <DataTemplate DataType="{x:Type ViewModels:MainWindowViewModel}">
        <Views:MainWindowView />
    </DataTemplate>

</ResourceDictionary> 
```

MainWindowView.xaml：

```
<Window x:Class="NavigationCleanBinding.Views.MainWindowView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">

<Grid>
    <TextBox Height="23" HorizontalAlignment="Left" Margin="61,14,0,0" 
             Name="textBox1" VerticalAlignment="Top" Width="120" 
             Text="{Binding TestData, Mode=TwoWay,
             UpdateSourceTrigger=PropertyChanged}"/>
    <Label Content="Test:" Height="28" HorizontalAlignment="Left" Margin="12,12,0,0"
      Name="label1" VerticalAlignment="Top" Width="43" />
    <Label Content="Result:" Height="28" HorizontalAlignment="Left" Margin="10,46,0,0"
      Name="label2" VerticalAlignment="Top" />

    <TextBox Height="23" HorizontalAlignment="Left" Margin="61,48,0,0"
             Name="textBox2" VerticalAlignment="Top" Width="120" 

             Text="{Binding TestData, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
    </Grid>
</Window> 
```

主窗口视图模型：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace NavigationCleanBinding.ViewModels
{
    class MainWindowViewModel
    {
        private String _testData;
        public String TestData
        {
            get { return _testData; }
            set { _testData = value; }
        }

        private MainWindowViewModel()
        {
            _testData = null;
        }
    }
} 
```

更新：

我将属性 TestData 更改为：

```
public String TestData
    {
        get { return _testData; }
        set
        { 
            _testData = value;
            OnPropertyChanged("TestData");

        }
    } 
```

并像这样实现了 INotifyPropertyChanged：

```
public event PropertyChangedEventHandler PropertyChanged;
    private void OnPropertyChanged(String propertyName)
    {
        PropertyChangedEventHandler handler = PropertyChanged;
        if (handler != null)
        {
            handler(this, new PropertyChangedEventArgs(propertyName));
        }
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-03T21:15:36.013

所以 user1064519 是在正确的轨道上：

*   View 需要是 a `UserControl`，而不是 a `Window`，因为它托管在 MainWindow
*   ViewModel 需要加载到 MainWindow 中，这就是触发`DataTemplate`被发现和加载的原因。

    ```
    <Window x:Class="WpfTemplateBootstrap.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:WpfTemplateBootstrap"
        Title="MainWindow" Height="350" Width="525">
        <ContentControl>
            <ContentControl.Content>
                <local:MainWindowViewModel />
            </ContentControl.Content>
        </ContentControl> 
    ```

之后，您应该启动并运行。我在这里发布了一个深入的示例：[wpf bootstrapping datatemplates--the chicken and the egg](http://www.thezenker.com/Blog/post/2013/01/03/wpf-bootstrapping-datatemplates-the-chicken-and-the-egg.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:56:05.403

您的 ViewModel 必须实现该接口[`INotifyPropertyChanged`](http://msdn.microsoft.com/en-us/library/system.componentmodel.inotifypropertychanged.propertychanged%28v=vs.100%29.aspx)并在任何绑定的属性值更改时引发`PropertyChanged`事件，以便您的视图可以知道发生了更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T17:32:22.063

DataTemplate 应该包含窗口，它可以包含任何类型的控件。

**数据模板：**

```
 <DataTemplate DataType="{x:Type ViewModels:MainWindowViewModel}">
        <Views:MainWindowView />
 </DataTemplate> 
```

**用户控制：**

```
 <UserControl x:Class="NavigationCleanBinding.Views.MainView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Height="350" Width="525">

<Grid>
    <TextBox Height="23" HorizontalAlignment="Left" Margin="61,14,0,0" 
             Name="textBox1" VerticalAlignment="Top" Width="120" 
             Text="{Binding TestData, Mode=TwoWay,
             UpdateSourceTrigger=PropertyChanged}"/>
    <Label Content="Test:" Height="28" HorizontalAlignment="Left" Margin="12,12,0,0"
      Name="label1" VerticalAlignment="Top" Width="43" />
    <Label Content="Result:" Height="28" HorizontalAlignment="Left" Margin="10,46,0,0"
      Name="label2" VerticalAlignment="Top" />

    <TextBox Height="23" HorizontalAlignment="Left" Margin="61,48,0,0"
             Name="textBox2" VerticalAlignment="Top" Width="120" 

             Text="{Binding TestData, Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"/>
    </Grid>
</UserControl> 
```

**窗户 ：**

```
 <Window x:Class="NavigationCleanBinding.Views.MainWindowView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Height="350" Width="525">

<ContentControl Content={Binding}/>
</Window> 
```

# java - 为什么我在写 ';' 时没有收到任何警告或错误？

> ID：14102311
> 
> 赞同：2
> 
> 时间：2012-12-31T13:41:45.570
> 
> 标签：java, syntax, format

我在我的 Java 代码中写了下面这三行：

```
ArrayList<String> QuestionID = new ArrayList<String>();
;
ArrayList<String> QuestionType = new ArrayList<String>(); 
```

它编译并运行完美，没有任何问题。

为什么会这样做？

我不明白为什么我在第二行没有收到任何警告或错误。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T13:43:06.490

有人认为空语句是有效的。这里的所有都是它的。允许空语句有时很有用，例如对于`for`具有空主体的循环。

例如，以下是查找树的根节点的方法（假设存在父链接，并且根节点没有父节点）：

```
for (Node parent = anyChildNode; parent.getParent() != null; parent = parent.getParent())
    ; // this for loop has no body, so an empty statement takes its place 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T13:43:10.673

因为您正在编写一个`empty statement`，这是完全有效的。

[在这里](http://wiki.answers.com/Q/In_java_what_is_empty_statement.Explain_its_usefulness)你会找到更多的解释。

从上面的链接 -

> 这种类型的语句的用处是有限的。我能想到的主要用途是完成循环结构所需的语句。
> 
> 这是我最近使用的一个示例：
> 
> 而 ( sf(++n) != i) ;
> 
> 该循环将不断调用方法 sf 并增加 n 的值，直到 sf(n) 的返回值等于 i。Java 中的每个循环都必须有一些代码在循环体中执行。在这种情况下，所有必要的工作都在条件中完成，因此强制循环体是一个空语句。
> 
> 虽然可能有其他（更清晰）的方式来编写这段代码，但这是可以使用空语句的示例。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-12-31T13:51:30.337

它不仅是允许的，而且[在 JLS 中有自己的部分](http://docs.oracle.com/javase/specs/jls/se7/html/jls-14.html#jls-14.6)。正如预期的那样：

> 空语句什么都不做。

更：

> 空语句的执行总是正常完成。

这意味着以下代码：

```
; 
```

永远不会抛出异常。很高兴知道 ;-）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T13:43:53.550

```
#if DEBUG
    #define ASSERT(_x) Assert(x)
#else
    #define ASSERT(_x)
#endif

ASSERT(test);    // Results in null statement in non-debug builds 
```

空分号表示之前有“空语句”。那是完全有效的情况。

`;`意思是“什么都不做”；

关于空语句用法的[好文章](http://thedailywtf.com/Articles/The-Speedup-Loop.aspx)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-31T13:44:51.007

“;” 被视为没有任何指令的行代码。

没有语法错误。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-31T13:44:33.933

它是一个有效的声明，类似于指示编译器什么都不做。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-31T13:44:59.837

空语句来自 C 语言的 Java，您会发现它对诸如此类的事情非常有用

```
strcpy(char *s, char *t) {
    while(*s++ = *t++);
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-31T13:47:51.393

Empty Semi Colon 是 JAVA 中的有效标记，它表示空语句。

# web-services - Apache CXF 2.7.1 响应读取器

> ID：14102314
> 
> 赞同：0
> 
> 时间：2012-12-31T13:42:35.733
> 
> 标签：web-services, rest, jakarta-ee, cxf

我正在学习使用 Apache CXF 2.6.2 创建 RESTful Web 服务的教程。我安装了 2.7.1 版（当时最新的），因为教程表明任何 2.6.2 或更高版本都可以工作，我想为什么不使用最新的。我正在创建客户端，教程指导我使用`org.apache.cxf.jaxrs.client.ResponseReader`. 问题是 Eclipse 告诉我“ResponseReader 无法解析为类型”并且尝试导入该类也会出错。我在互联网上搜索了一些，听起来 ResponseReader 在 CXF 2.7.x 中不再可用。我的问题是，2.7.x 中的 ResponseReader 有什么替代方法来将 REST 调用的返回值表示为 XML？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T11:43:38.643

引用[此网页](http://cxf.apache.org/docs/27-migration-guide.html)：

> JAX-RS：已从 org.apache.cxf.jaxrs.client 包中删除了 3 个类：ResponseReader... JAX-RS 2.0 响应类不需要列表中的第一个类...

所以，我想这回答了我的问题。本身没有替代品，只是不再需要了。

# html5-canvas - 使用 html5 画布绘制图表的垂直文本

> ID：14102322
> 
> 赞同：0
> 
> 时间：2012-12-31T13:43:45.087
> 
> 标签：html5-canvas, vertical-text

我正在使用 HTML5 画布开发图表 PoC。

每个文字AA、BB等都是canvas。我通过 h 生成它们`var canvas = $("<canvas></canvas>").appendTo(elementDiv);`并使用循环来显示文本。

我`ctx.fillText(txt, x - txt.length * 2, 18);`用来显示文本。

在这里，我的问题是如何使它们成为垂直文本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:55:26.323

要将文本转换为垂直文本，您只需使用该`rotate`方法将旋转变换应用于您的画布：

[https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Transformations#Rotating](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Transformations#Rotating)

您可能还需要`translate`变换以在旋转后正确定位文本，玩转变换直到弄清楚它们是如何工作的（如果您知道矩阵，则可以跳过此步骤）

# .net - 无法连接到 Azure 存储帐户

> ID：14102326
> 
> 赞同：0
> 
> 时间：2012-12-31T13:44:21.647
> 
> 标签：.net, networking, azure, storage

我在 Azure 上有一个可以从计算机成功连接的存储帐户。而且我无法使用相同的帐户名和密钥从另一台计算机连接到它。是什么导致了这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T06:51:52.150

造成这种情况的一个原因可能是您拥有的第二台计算机位于防火墙后面，其中存储通信所需的端口被阻止。您的第二台计算机是否在组织 VPN/LAN 如果是，那么您的组织防火墙可能会阻止通信

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-10T22:47:28.980

这发生在我身上的原因与 OP 相同，但我的时钟只是偏移了几分钟。要在 Windows 8 上解决此问题，请转到“更改日期和时间设置”，单击“Internet 时间”选项卡，单击“更改设置”，然后单击“立即更新”，系统将与 Windows 服务器同步，一切都会好起来的:)

# java - 如何使用 JPA 和 Hibernate 防止 SQL 注入？

> ID：14102334
> 
> 赞同：30
> 
> 时间：2012-12-31T13:45:03.617
> 
> 标签：java, sql, hibernate, jpa, sql-injection

我正在使用休眠开发应用程序。当我尝试创建登录页面时，出现了 Sql Injection 的问题。我有以下代码：

```
@Component
@Transactional(propagation = Propagation.SUPPORTS)
public class LoginInfoDAOImpl implements LoginInfoDAO{

@Autowired
private SessionFactory sessionFactory;      
@Override
public LoginInfo getLoginInfo(String userName,String password){
    List<LoginInfo> loginList = sessionFactory.getCurrentSession().createQuery("from LoginInfo where userName='"+userName+"' and password='"+password+"'").list();
    if(loginList!=null )
        return loginList.get(0);
    else return null;   
          }
      } 
```

在这种情况下我将如何防止 Sql Injection？loginInfo 表的创建表语法如下：

```
create table login_info
  (user_name varchar(16) not null primary key,
  pass_word varchar(16) not null); 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-31T13:48:36.170

```
Query q = sessionFactory.getCurrentSession().createQuery("from LoginInfo where userName = :name");
q.setParameter("name", userName);
List<LoginInfo> loginList = q.list(); 
```

您还有其他选择，请参阅 mkyong 的这篇好[文章](http://www.mkyong.com/hibernate/hibernate-parameter-binding-examples/)。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-31T13:51:00.760

您需要使用命名参数来避免 sql 注入。此外（与 sql 注入无关，但通常与安全性有关）不返回第一个结果，但使用**getSingleResult**所以如果由于某种原因有多个结果，查询将失败并出现**NonUniqueResultException**并且登录不会成功

```
 Query query= sessionFactory.getCurrentSession().createQuery("from LoginInfo where userName=:userName  and password= :password");
 query.setParameter("username", userName);
 query.setParameter("password", password);
 LoginInfo loginList = (LoginInfo)query.getSingleResult(); 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2019-01-10T05:39:41.930

## 什么是 SQL 注入？

> 当恶意攻击者可以操纵查询构建过程以便执行与应用程序开发人员最初预期不同的 SQL 语句时，就会发生 SQL 注入

## 如何防止 SQL 注入攻击

解决方案非常简单直接。您只需要确保始终使用绑定参数：

```
public PostComment getPostCommentByReview(String review) {
    return doInJPA(entityManager -> {
        return entityManager.createQuery("""
            select p
            from PostComment p
            where p.review = :review
            """, PostComment.class)
        .setParameter("review", review)
        .getSingleResult();
    });
} 
```

现在，如果有人试图破解这个查询：

```
getPostCommentByReview("1 AND 1 >= ALL ( SELECT 1 FROM pg_locks, pg_sleep(10) )"); 
```

SQL注入攻击将被阻止：

```
Time:1, Query:["select postcommen0_.id as id1_1_, postcommen0_.post_id as post_id3_1_, postcommen0_.review as review2_1_ from post_comment postcommen0_ where postcommen0_.review=?"], Params:[(1 AND 1 >= ALL ( SELECT 1 FROM pg_locks, pg_sleep(10) ))] 
```

## JPQL 注射液

SQL 注入也可能在使用 JPQL 或 HQL 查询时发生，如以下示例所示：

```
public List<Post> getPostsByTitle(String title) {
    return doInJPA(entityManager -> {
        return entityManager.createQuery(
            "select p " +
            "from Post p " +
            "where" +
            "   p.title = '" + title + "'", Post.class)
        .getResultList();
    });
} 
```

上面的 JPQL 查询没有使用绑定参数，因此很容易受到[SQL 注入](https://vladmihalcea.com/a-beginners-guide-to-sql-injection-and-how-you-should-prevent-it/)的攻击。

看看当我像这样执行这个 JPQL 查询时会发生什么：

```
List<Post> posts = getPostsByTitle(
    "High-Performance Java Persistence' and " +
    "FUNCTION('1 >= ALL ( SELECT 1 FROM pg_locks, pg_sleep(10) ) --',) is '"
); 
```

Hibernate 执行以下 SQL 查询：

```
Time:10003, QuerySize:1, BatchSize:0, Query:["select p.id as id1_0_, p.title as title2_0_ from post p where p.title='High-Performance Java Persistence' and 1 >= ALL ( SELECT 1 FROM pg_locks, pg_sleep(10) ) --()=''"], Params:[()] 
```

## 动态查询

您应该避免使用字符串连接来动态构建查询的查询：

```
String hql = " select e.id as id,function('getActiveUser') as name from " + domainClass.getName() + " e ";
Query query=session.createQuery(hql);
return query.list(); 
```

如果要使用动态查询，则需要使用 Criteria API：

```
Class<Post> entityClass = Post.class;
CriteriaBuilder cb = entityManager.getCriteriaBuilder();
CriteriaQuery<Tuple> query = cb.createTupleQuery();
Root<?> root = query.from(entityClass);
query.select(
    cb.tuple(
        root.get("id"),
        cb.function("now", Date.class)
    )
);

return entityManager.createQuery(query).getResultList(); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-03-14T18:02:07.543

我想在这里添加一个特殊的 SQL 注入，可以在搜索中使用 Like 查询。

假设我们有一个查询字符串，如下所示：

```
queryString = queryString + " and c.name like :name"; 
```

在设置名称参数时，大多数人通常会使用它。

```
query.setParameter("name", "%" + name + "%"); 
```

现在，如上所述，由于 TypedQuery 和 Hibernate 将默认处理它，因此无法注入像“ **1=1 ”这样的传统参数。**

但是这里可能存在特殊的 SQL 注入，这是因为 LIKE 查询结构使用了**下划线**

> 下划线通配符用于精确匹配 MySQL 含义中的一个字符，例如 select * from users where user like 'abc_de'；这将产生以 abc 开头、以 de 结尾并且中间只有 1 个字符的用户的输出。

现在，如果在我们的场景中，如果我们设置

*   name="_" **生成名称至少为 1 个字母的客户**
*   name="__" **生成名称至少为 2 个字母的客户**
*   name="___"**生成名称至少为 3 个字母的客户**

等等。

***理想的修复：***

> 为了缓解这种情况，我们需要使用前缀转义所有下划线。

___ 将变为 \_\_\_ （相当于 3 个原始下划线）

同样，反之亦然的查询也将导致需要转义 % 的注入。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T13:50:27.760

我们应该始终尝试使用存储过程来防止 SQLInjection。如果存储过程是不可能的；我们应该尝试使用Prepared Statements。

# sql - where 子句不起作用

> ID：14102340
> 
> 赞同：0
> 
> 时间：2012-12-31T13:45:36.263
> 
> 标签：sql, visual-studio-2010, where-clause

我正在使用 Visual Studio2010，使用 asp.net。我希望查询像示例一样工作，但我的不起作用！

我在数据库中有这些行：

```
Fullname=joe.address=earth,work=5656,home=23,mobile=55
Fullname=Michel.address=earth,work=5,home=2343,mobile=5435 
```

用户只需输入：

```
Fullname=joe ,address=earth 
```

程序应该只返回第一行。0 是文本框的默认值。

```
SELECT fullName, address, work, home, mobile, registrationNo
  FROM contacts
 WHERE (fullName = @fullName OR fullName = '0')
   AND (address = @address OR address = '0')
   AND (work = @work OR work = '0')
   AND (home = @home OR home = '0')
   AND (mobile = @mobile OR mobile = '0') 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T13:50:08.913

当我认为您打算检查参数时，您正在检查*列*是否等于：`'0'`

```
SELECT fullName, address, work, home, mobile, registrationNo
FROM   contacts
WHERE  (fullName = @fullName OR @fullName = '0')
AND    (address = @address   OR @address = '0')
AND    (work = @work         OR @work = '0')
AND    (home = @home         OR @home = '0')
AND    (mobile = @mobile     OR @mobile = '0') 
```

正如评论中指出的那样，您确实应该使用缺少值 - 这是它*存在**`NULL`*于 SQL中的主要原因- 并且还意味着您可以使用适当的数据类型（在必要时），而不是总是将事物视为字符串. （然而，在这种情况下，一切似乎都是一个字符串）。

# c++ - 宏输出不起作用

> ID：14102342
> 
> 赞同：0
> 
> 时间：2012-12-31T13:45:51.453
> 
> 标签：c++

我正在学习 c++，宏的行为不像预期的那样。

```
 1     #include<cstdlib>
  2     #include<iostream>
  3     #include<cstring>
  4     #define die(x) std::cout << x << std::endl ; exit(-1) 
  5     const char *help = "Usage: coffee --help --version";
  6     const char *version = "alpha";
  7     int main(int argc,char **argv)
  8     {
  9               if(argc<2||!strcmp(argv[1],"--help"))
 10                       die(help);
 11               if(!strcmp(argv[1],"--version"))
 12                       die(version);
 13 
 14               return 0;
 15               
 16     } 
```

* * *

```
g++ -o sample ./*
./sample --help 
```

**输出**：用法：coffee --help --version

```
./sample --version 
```

**输出**：

 `* * *

我很困惑为什么`--version`不输出 string `alpha`。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T13:48:41.613

`std::cout << x << std::endl ; exit(-1)`这两行中的宏预处理器何时扩展

```
 9               if(argc<2||!strcmp(argv[1],"--help"))
 10                       die(help); 
```

结果代码是：

```
 if(argc<2||!strcmp(argv[1],"--help"))
       std::cout << help << std::endl; 
 exit(-1); 
```

这可能不是您想要的；

“多语句宏”的常见技巧是`do { ... } while(0)`围绕您希望在宏中包含的语句使用。

您可以使用`gcc -E`或`cl -E`从 C 预处理器获取输出，因此您可以看到编译器实际看到的内容。

编辑：我应该指出，在这种情况下，我个人更喜欢“die（msg）函数”而不是修复宏。然后你可以，例如，在 die() 中设置一个断点，并找出当某些东西不能正常工作时你是如何到达那里的！您不能在宏中设置断点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:48:55.483

只需尝试粗暴地替换宏的主体，您就会明白为什么：

```
if(argc<2||!strcmp(argv[1],"--help"))
  die(help); 
```

变成：

```
if(argc<2||!strcmp(argv[1],"--help"))
  std::cout << help << std::endl;
exit(-1); 
```

`{ }`该语句没有大括号`if`，主体仅由一条指令组成，因此`exit(-1)`始终执行。

您会发现，如果使用 an`if / else if`而不是 that 和`if / if`couple，因为第二个`else if`会错过它的父母。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T13:49:12.300

你忘了`{ }`。手动展开宏，你会看到结果：

```
if(argc<2||!strcmp(argv[1],"--help"))
   std::cout << help << std::endl ; exit(-1); 
```

IE

```
if(argc<2||!strcmp(argv[1],"--help"))
   std::cout << help << std::endl ;
exit(-1); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T13:50:25.970

替换宏后的代码

```
if(argc<2||!strcmp(argv[1],"--help"))
   std::cout << help << std::endl ; exit(-1) ;  //<-- this exit will work always.
if(!strcmp(argv[1],"--version"))
   std::cout << version << std::endl ; exit(-1) ; 
```

正确方法：

```
#define die(x) do {std::cout << x << std::endl ; exit(-1); } while(false); 
````

# ruby-on-rails - Rails 简单表格 不同表格不同风格

> ID：14102345
> 
> 赞同：0
> 
> 时间：2012-12-31T13:46:18.757
> 
> 标签：ruby-on-rails, twitter-bootstrap, simple-form

我在 rails 3.1 项目中使用 simple-form gem 和 twitter bootstrap。我有几个看起来都很好的表单视图。但是现在我喜欢在其中一种形式中设置文本输入字段的样式，这样它就变得更小了。文本输入字段位于我的一个名为“角色”的控制器的编辑表单视图中。表单的部分如下所示：

```
= simple_form_for @role, :html => { :class => 'form-horizontal' } do |f| 
  = f.error_notification
  = f.input :name
  = f.input :description
  .form-actions
    = f.button :submit, :class => 'btn-primary'
    = link_to t('.cancel', :default => t("helpers.links.cancel")), roles_path, :class => 'btn' 
```

下面有一个样式文件：

`app/assets/stylesheets/roles.css.scss`

它是用脚手架命令创建的。我试图在此处添加一些样式，但这会导致我的应用程序的每种形式都发生变化。有没有一种好方法可以仅针对具有简单表单的一个特殊表单视图更改文本输入字段的样式？如果我希望输入文本字段的大小为：宽度 100 像素到高度 50 像素，我应该在哪里放置样式以及样式会是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:57:17.193

即使您有一个仅用于角色的特殊 CSS 文件，您也需要知道这一点。最后，每个 CSS 文件都捆绑在一起并一起提供。这意味着，roles.css 将加载到每个页面上，这会导致您描述的行为。

如果你想为单个表单设置样式，你可以通过添加一个类来做到这一点：

```
= simple_form_for @role, :html => { :class => 'form-horizontal roles-form' } do |f| 
```

现在您可以将您的 CSS 定义范围限定为`.roles-form`，它们将仅适用于这个单一表单。

# c - C SDL 键盘事件 SDL_KEYUP 按键按下时触发

> ID：14102348
> 
> 赞同：0
> 
> 时间：2012-12-31T13:46:35.373
> 
> 标签：c, events, keyboard, sdl, keyup

我在 C 中使用 SDL，我试图在按下一个键时让一个字符在屏幕上移动，并在它被释放时停止，但似乎 KEYUP 事件在按键仍然被按住时触发下。如果我删除pressed() 中的KEYUP 部分，字符将在屏幕上滑动，但显然不会自行停止。如果我保留 KEYUP 部分，我必须反复按该键才能在屏幕上移动它们。知道我做错了什么吗？

这是我所拥有的：

```
...

int done = 0;
while (done==0)
{
    pressed();
    if (kenter == 1)
    {
        state = 1;
        subscreen();
    }
    if (kescape == 1)
    {
        done = 1;
    }
    if (kup == 1)
    {
        playery += -2;
    }
    if (kdown == 1)
    {
        playery += 2;
    }

    if (kright == 1)
    {
        playerx += 2;
    }
    if (kleft == 1)
    {
        playerx += - 2;
    }

...

int pressed ()
{

SDL_Event keyevent;

while (SDL_PollEvent(&keyevent))
{
    switch(keyevent.type)
    {
        case SDL_KEYDOWN:
        switch(keyevent.key.keysym.sym)
        {
            case SDLK_RETURN:
            {
                kenter = 1;
                break;
            }
            case SDLK_ESCAPE:
            {
                kescape = 1;
                break;
            }
            case SDLK_a:
            {
                ka = 1;
                break;
            }
            case SDLK_s:
            {
                ks = 1;
                break;
            }
            case SDLK_UP:
            {
                kup = 1;
                break;
            }
            case SDLK_DOWN:
            {
                kdown = 1;
                break;
            }
            case SDLK_RIGHT:
            {
                kright = 1;
                break;
            }
            case SDLK_LEFT:
            {
                kleft = 1;
                break;
            }
            default:
            break;
        }
    }
    switch(keyevent.type)
    {
        case SDL_KEYUP:
        switch(keyevent.key.keysym.sym)
        {
            case SDLK_RETURN:
            {
                kenter = 0;
                break;
            }
            case SDLK_ESCAPE:
            {
                kescape = 0;
                break;
            }
            case SDLK_a:
            {
                ka = 0;
                break;
            }
            case SDLK_s:
            {
                ks = 0;
                break;
            }
            case SDLK_UP:
            {
                kup = 0;
                break;
            }
            case SDLK_DOWN:
            {
                kdown = 0;
                break;
            }
            case SDLK_RIGHT:
            {
                kright = 0;
                break;
            }
            case SDLK_LEFT:
            {
                kleft = 0;
                break;
            }
            default:
            break;
        }
    }
}
return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-03T02:36:18.433

我认为您的 switch 语句已损坏。

使用这种不那么混乱的方式

```
int pressed ()
{

    SDL_Event event;

    while(SDL_PollEvent(&event) )
    {
        if(event.type == SDLK_KEYDOWN)
        {
                switch(event.key.keysym.sym)
                {
                    case SDLK_RETURN:
                        doStuff = 1
                        break;
                    default:
                        break;
                }
        }
        if(event.type == SDLK_KEYUP)
        {
                switch(event.key.keysym.sym)
                {
                    case SDLK_RETURN:
                        doStuff = 0;
                        break;
                    default:
                        break;
                }
        }
    }   
} 
```

也很重要：

[SDL 教程：实用键盘输入](https://web.archive.org/web/20151217024611/http://content.gpwiki.org/index.php/SDL:Tutorials:Practical_Keyboard_Input)

哦，避免使用全局变量！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:26:18.223

您对两个`switch`语句的使用既奇怪又令人困惑，您可能应该解决这个问题。

您看到的问题可能是由于键盘重复，请参阅[`SDL_EnableKeyRepeat()`](http://www.libsdl.org/docs/html/sdlenablekeyrepeat.html)有关如何禁用它的调用。

# php - 如何获取设备令牌

> ID：14102349
> 
> 赞同：5
> 
> 时间：2012-12-31T13:46:42.390
> 
> 标签：php, xcode, push-notification, apple-push-notifications, devicetoken

我有一个适用于**iOS**的应用程序，我想在那里集成推送通知。我[在 youtube 上看到了一个教程](http://www.youtube.com/watch?v=_3YlqWWnI6s)，一切都很好，但最近我正在使用开发证书（用于测试 - 不用于 AppStore），并且我的服务器上有 PHP 脚本。在这个文件中存储了我的 iPhone 的 deviceToken，它是用 php 变量 $deviceToken 编写的。但是现在，当我想在 AppStore 中使用它时，如何从每个下载了我的应用程序的人那里获取设备令牌并将其放入 PHP 脚本中？

这是我的 PHP 文件：

```
 if($_POST['message']){

        $deviceToken = '(my device token)';

        $message = stripslashes($_POST['message']);

        $payload = '{
                        "aps" : 

                            { "alert" : "'.$message.'",
                              "badge" : 1,
                              "sound" : "bingbong.aiff"
                            } 
                    }';

        $ctx = stream_context_create();
        stream_context_set_option($ctx, 'ssl', 'local_cert', 'cert.pem');
        stream_context_set_option($ctx, 'ssl', 'passphrase', 'password');
        $fp = stream_socket_client('ssl://gateway.sandbox.push.apple.com:2195', $err, $errstr, 60, STREAM_CLIENT_CONNECT, $ctx);
        if(!$fp){
            print "Failed to connect $err $errstrn";
            return;
        } else {
            print "DONE!";
        }

        $devArray = array();
        $devArray[] = $deviceToken;

        foreach($devArray as $deviceToken){
            $msg = chr(0) . pack("n",32) . pack('H*', str_replace(' ', '', $deviceToken)) . pack        ("n",strlen($payload)) . $payload;
            fwrite($fp, $msg);
        }
        fclose($fp);
    }

<form action="send-notification.php" method="post">
    <input type="text" name="message" maxlength="100">
    <input type="submit" value="SEND">
</form>
</body> 
```

这就是我在 xCode (AppDelegate.m) 中所拥有的

```
 - (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    // Override point for customization after application launch.
    [[UIApplication sharedApplication] registerForRemoteNotificationTypes:(UIRemoteNotificationTypeAlert | UIRemoteNotificationTypeBadge | UIRemoteNotificationTypeSound)];

    return YES;
}

- (void)application:(UIApplication *)application didRegisterForRemoteNotificationsWithDeviceToken:(NSData *)deviceToken
{
    NSString *deviceTokenString = [NSString stringWithFormat:@"%@", deviceToken];
    NSLog(deviceTokenString);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T04:39:41.140

嗯，我不懂PHP，所以不能给你具体的代码，但是我可以解释一下大致的原理。

`registerForRemoteNotificationTypes:`当您的应用程序启动时，您应该通过调用该方法注册到 Apple Push Notifications 。

当注册成功并获得设备令牌时，您应该在`application:didRegisterForRemoteNotificationsWithDeviceToken:`.

您的服务器应将其存储在某个数据库中。

发送通知的 PHP 脚本应该从该数据库中获取设备令牌。

# root - 如何在 dashcode 中制作立方根计算器

> ID：14102351
> 
> 赞同：0
> 
> 时间：2012-12-31T13:46:48.023
> 
> 标签：root, cube, dashcode

有人可以将javascript发布到dashcode中的立方根吗

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:49:50.383

我不知道 Dashcode 是什么，但假设它使用标准 JavaScript，只需将其转换为功率计算（就像您在学校学习的那样）并使用`Math.pow`：

```
> Math.pow(27, 1/3)
  9 
```

x 的第 n 个根是 x^(1/n)。

# paypal - PayPal（标准）订阅按钮返回 URL 中 Auth 的含义？

> ID：14102354
> 
> 赞同：8
> 
> 时间：2012-12-31T13:46:58.397
> 
> 标签：paypal, paypal-ipn, paypal-sandbox, paypal-nvp

我的 WordPress 网站上有一个订阅按钮（使用 PayPal Payments 标准集成）。

```
<form action="https://www.sandbox.paypal.com/cgi-bin/webscr" method="post">
<input type="hidden" name="cmd" value="_xclick-subscriptions">
<input type="hidden" name="business" value="FRG9AB9A93MUN">
<input type="hidden" name="lc" value="US">
<input type="hidden" name="item_name" value="Premium Subscription">
<input type="hidden" name="item_number" value="321">
<input type="hidden" name="no_note" value="1">
<input type="hidden" name="no_shipping" value="1">
<input type="hidden" name="rm" value="1">
<input type="hidden" name="return" value="http://example.com/success">
<input type="hidden" name="cancel_return" value="http://example.com/cancel">
<input type="hidden" name="src" value="1">
<input type="hidden" name="a3" value="299.00">
<input type="hidden" name="p3" value="1">
<input type="hidden" name="t3" value="M">
<input type="hidden" name="currency_code" value="USD">
<input type="hidden" name="bn" value="PP-SubscriptionsBF:btn_subscribeCC_LG.gif:NonHosted">
<input type="image" src="https://www.sandbox.paypal.com/en_US/i/btn/btn_subscribeCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.sandbox.paypal.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> 
```

我正在使用 PayPal Sandbox 测试功能。我使用 WordPress PayPal 框架插件（[http://wordpress.org/extend/plugins/paypal-framework](http://wordpress.org/extend/plugins/paypal-framework)）

## 我的问题

成功付款（订阅）后，买家返回带有“auth”和“form_charset”的退货网址（[http://example.com/success/?auth=AtKlH609fYvJhW2wmFr9iMmXboz9JEB64TJjNpLVH8d0OlBbnOpn-TeeCvZT6VWOcoo8XG4GD0AeftCUMdNWCAQ&form_charset=UTF-8](http://example.com/success/?auth=AtKlH609fYvJhW2wmFr9iMmXboz9JEB64TJjNpLVH8d0OlBbnOpn-TeeCvZT6VWOcoo8XG4GD0AeftCUMdNWCAQ&form_charset=UTF-8)）

> 有人可以解释一下“auth”和“form_charset”的含义吗？我可以使用它通过 NVP API 获取有关交易的更多信息吗？那么我应该使用什么 NVP API 方法呢？

我可以正确接收有关这些交易的 IPN 消息。

## 到目前为止我做了什么

我精通 PayPal Express Checkout 集成、捕获 IPN 消息并处理它们等。

我已阅读 PayPal 指南中的 NVP API 方法、请求和响应。 [https://cms.paypal.com/cms_content/CA/en_US/files/developer/PP_NVPAPI_DeveloperGuide.pdf](https://cms.paypal.com/cms_content/CA/en_US/files/developer/PP_NVPAPI_DeveloperGuide.pdf)

我也浏览了其他一些 PayPal 指南。

以下问题提到了“名为 auth 的加密变量”。但这对我没有帮助。（[Paypal 沙箱返回 url](https://stackoverflow.com/questions/13038080/paypal-sandbox-return-url)）

这个问题还涉及成功的回报。（[成功结帐时的贝宝重定向](https://stackoverflow.com/questions/13471639/paypal-redirect-on-successful-checkout)）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-03T13:04:25.723

将“rm”参数更改为“2”。这会导致一个 POST 到成功页面，其中包含所有事务变量。[在这里阅读更多](https://developer.paypal.com/webapps/developer/docs/classic/paypal-payments-standard/integration-guide/Appx_websitestandard_htmlvariables/)。

# html - 顶部：0px；底部：0px；没有按预期工作

> ID：14102355
> 
> 赞同：0
> 
> 时间：2012-12-31T13:46:58.557
> 
> 标签：html, css

为什么以下不显示 200px 高的蓝色块？

```
<div style="position: absolute; height: 500px;">
    <div style="width: 200px; height: 300px; background-color: Green; position: relative;">
        a</div>
    <div style="width: 200px; background-color: Blue; top: 0px; bottom: 0px; position: relative;">
        b</div>
</div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T13:53:24.253

具有相对位置的元素的位置属性（上、左、右、下）表示与其当前位置的偏移量。您在相对定位的元素上设置顶部和底部 0。你基本上告诉它无处可去。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T13:49:52.783

您没有在 div 上设置高度，唯一设置高度的 div 将其设置为 500px

另外，您期望顶部和底部以什么方式工作...您已经说过它们没有按预期工作，但是它们在那里是为了从左上角设置位置。

> 该属性指定元素的顶部位置，包括内边距、滚动条、边框和边距。

引自：[http ://www.w3schools.com/jsref/prop_style_top.asp](http://www.w3schools.com/jsref/prop_style_top.asp)

附带说明的是，您不需要将 px 放在那里`top:0; bottom:0;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T13:50:41.520

应将位置设置`absolute`为元素以重新计算其相对于其相对父级的尺寸。[这里](http://jsfiddle.net/barney/xvbmS/)的例子。

# android - 用字符串标签替换 HTML 标签

> ID：14102358
> 
> 赞同：0
> 
> 时间：2012-12-31T13:47:38.210
> 
> 标签：android, html, string

我的意思是，如果 String 包含**HTML**标签，例如`<br></br>`必须将它们转换为`\n`.

我试过这个：

```
String formatted = android.text.Html.fromHtml(nonFormatted).toString(); 
```

但这似乎只是删除了所有的 HTML 标签。

**输入：**

```
String nonFormatted = "<ul><li>Android v4.0 (Ice Cream Sandwich) OS<\/li><li>2 MP Primary Camera<\/li><li>3-inch TFT Capacitive Touchscreen<\/li><li>850 MHz Processor<\/li><li>QWERTY Keypad<\/li><li>FM Radio<\/li><li>Wi-Fi Enabled<\/li><li>Expandable Storage Capacity of 32 GB<\/li><\/ul>"; 
```

**使用 android.text.Html.fromHtml(nonFormatted).toString(); 后的输出**

```
String formatted = Android v4.0 (Ice Cream Sandwich) OS2 MP Primary Camera3-inch TFT Capacitive Touchscreen850 MHz ProcessorQWERTY KeypadFM RadioWi-Fi EnabledExpandable Storage Capacity of 32 GB 
```

但在网站上看起来是这样的：

![在此处输入图像描述](../Images/1f9b160e1c7b453e194b7f889a54fe5f.png)

我希望我的 java String 像图像中的那样，而不是项目符号，一个换行符。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:35:24.147

因为 Html.fromHtml(string) 只支持一些 html 标签，例如：br p div em b strong au sup sub... 但它不支持 ul, li 标签所以你可以尝试使用`WebView or TagHandler`. " `TagHanlder is notified when HTML tags are encountered that the parser does not know how to interpret`"。这些链接将向您展示如何做到这一点：

[在 android textview 中显示 <ul> <li>](https://stackoverflow.com/questions/11214001/show-ul-li-in-android-textview)

[Html 列表标签在 android textview 中不起作用。我能做些什么？](https://stackoverflow.com/questions/3150400/html-list-tag-not-working-in-android-textview-what-can-i-do)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:52:04.423

您需要进行一些解析以正确替换空格的标签。尝试探索[jsoup](http://jsoup.org/)，它是一个非常强大的库，可让您将标签列入白名单、清理 HTML、选择和查找标签、删除等。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T13:56:42.657

一个简单的正则表达式替换可以解决这个问题。[http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html](http://docs.oracle.com/javase/6/docs/api/java/util/regex/Pattern.html)

# css - CSS3：空选择器和内容属性

> ID：14102362
> 
> 赞同：15
> 
> 时间：2012-12-31T13:47:59.617
> 
> 标签：css, css-selectors, pseudo-element

我***想***一起使用 CSS3 的`:empty`psedo-selector 和 CSS3 的`content`属性来将一些文本添加到空列表中，如下面的小提琴所示：

[http://jsfiddle.net/ZesAC/2/](http://jsfiddle.net/ZesAC/2/)

我***了解到***CSS 只允许`content`输入`:after`或`:before`选择器。是否有允许设置空列表样式的解决方案？

**编辑**

正如我在评论中了解到的那样，您*可以*在 CSS3 中的任何地方使用`content`（在大多数浏览器中无效 [截至 2012 年 12 月 31 日]），并且只能在 CSS2中的`:after`和块中使用。`:before`（感谢[@BoltClock](https://stackoverflow.com/users/106224/boltclock)）

如果您不介意特定于 Firefox，您可以使用`-moz-only-whitespace`选择器使其行为更符合逻辑。（感谢[@robertc](https://stackoverflow.com/users/8655/robertc)）

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-31T13:50:34.487

原来我在提问中回答了我自己的问题：

[http://jsfiddle.net/M6xZj/2/](http://jsfiddle.net/M6xZj/2/)

您可以使用`:after`with`:empty`元素在 UL 之后添加一些内容。毕竟它*是空的，所以它保证位于列表所在的位置。*

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2014-03-18T08:22:02.970

`.some_class_name:empty::after{ content: "-"; }`

# algorithm - 序列的数据结构

> ID：14102364
> 
> 赞同：2
> 
> 时间：2012-12-31T13:48:10.850
> 
> 标签：algorithm, data-structures

我正在训练数据结构的测试，但我无法解决这个问题：

> 设计一个保持序列 a_1, ..., a_n 的数据结构，并且可以对其执行两个操作：
> 
> 1.  将 a_i 设置为值 x
> 2.  计算值 x 在两个索引之间的序列中出现的次数：i 和 j；只是为了确保我说清楚（我不擅长英语），这意味着返回`|{a_k: a_k = x and i <= k <= j}|`给定的：x，i，j。
> 
> 约束：
> 
> *   a_i 来自区间 [0, ..., 10^9]，
> *   n 更小 - 它小于 10^5

这两个操作最多应该在 O(log n) 时间内工作。不幸的是，我看到它的唯一方法是 O(log^2 n)。我们使用 in 节点保留区间树`maps<int,int>`，它计算 x 在子树中出现的次数。同样重要的是不要保留出现 0 次的映射值（内存复杂度）。

我怎样才能更好地解决它？任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T17:03:42.260

这是具有两个数据字段的 BST：

```
BSTNode<E>{
   int index;
   E value;
   BSTNode left, right;
} 
```

按索引对树排序，以便搜索为 O(lg n)：这有助于插入和设置 ( `seta_i to value x`)。

至`count how many times value x occurs in a sequence between two indexes: i, j`

*   找到 i 和 j 的直接公共父级：[http ://www.geekviewpoint.com/java/bst/immediate_common_parent](http://www.geekviewpoint.com/java/bst/immediate_common_parent)
*   然后遍历以公共父节点为根的子树：对于每次访问，只计算值为 的节点`x`。这类似于总结单身儿童[http://www.geekviewpoint.com/java/bst/sum_single_children](http://www.geekviewpoint.com/java/bst/sum_single_children)或按顺序访问树叶（来自同一站点）。

编辑：

`i`在找到and的公共父节点后`j`，可以简单地查找一个值的频率，而不是遍历子树：每个节点（这里是 commonParent）可以有一个频率图：`Map<E,Integer> childrenFreq = new HashMap<E,Integer>()`。一旦在 O(lg n) 中找到共同的父母，这将是 O(1)

# google-bigquery - 使用命令行工具的 bq 作业摘要

> ID：14102366
> 
> 赞同：1
> 
> 时间：2012-12-31T13:48:26.433
> 
> 标签：google-bigquery

有没有办法仅使用大查询命令获取加载作业（不是查询作业）摘要列表？我知道有一个命令可以获取 bq 作业的摘要，但它会返回查询和加载作业摘要。还有我可以看到 bq 命令列表的任何文件吗？

$ bq ls -j --max_results=5 jobId 作业类型 状态 开始时间 持续时间

* * *

dsdsdsdssssssssssssssssdsdsdsdss6c67 query RUNNING 31 Dec 19:06:00
dsdsdsdssssssssssssssssdsdsdsdss6c66 query SUCCESS 31 Dec 19:04:54 0:00:06
r314343434343434343434343434343 load SUCCESS 31 Dec 19:04:25 0:01:33
dsdsdsdssssssssssssssssdsdsdsdss52e7 query SUCCESS 31 Dec 19:03:34 0:00:05
314343434343434343434343434345 加载成功 12 月 31 日 19:02:53 0:00:18

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-04T02:01:55.280

你可以使用下面的“加载”过滤（它尝试将结果行与第二列“加载”匹配并丢弃不匹配的行）：

```
bq ls -j | awk 'NR <= 2 || $2=="load" {print $0}' | head -n7 
```

结果如下所示：

![在此处输入图像描述](../Images/3d44629014637b9b0db9161768a92182.png)

要检查命令，您可以执行

```
bq help
bq help <command> 
```

或参考[bq cli_tools](https://developers.google.com/bigquery/docs/cli_tool)。

# jquery - jQuery 验证工作，但允许使用无效数据提交表单

> ID：14102374
> 
> 赞同：-2
> 
> 时间：2012-12-31T13:48:52.157
> 
> 标签：jquery, regex, jquery-validate

我已经研究了好几个小时了，而且我束手无策。我在同一页面上有两个表单，它们都使用 jQuery 验证在提交之前确认有效数据。

### 编辑：

包括下面的代码。

### 两件事情：

1.  出于某种原因，正在验证第一个表格（注册表），因为我正在输入数据。因此，它似乎在 keyup/blur 事件上触发，但是当我单击提交按钮时没有正确触发。如您所见，它允许使用空或无效数据提交表单。

2.  右侧的登录表单。有用！但我需要单击提交按钮**两次**才能实际提交表单。

这里满是头发。拜托，有人能帮忙解决这个问题吗？

### 编辑：

根据要求在此处添加代码。一、注册验证器：

```
<script type="text/javascript">

$(document).ready(function() {

 $.validator.addMethod("PASSWORD",function(value,element){
        return this.optional(element) || /^(?=.*\d)(?=.*[a-zA-Z]).{5,}$/i.test(value);
        },"Your password must be at least 5 characters long. Please include 1 or more numbers.");
  $.validator.addMethod("lettersnumbers", function(value,element) {
        return this.optional(element) || /^[a-zA-Z0-9]+$/i.test(value);
        }, "Username can only contain letters and numbers. No spaces are allowed.");    
 $.validator.addMethod("BIRTH",function(value,element){
        var age = 18;

        switch($('#Province option:selected').val())
        {
            case "NB":
            case "BC":
            case "NL":
            case "NS":
            case "NY":
            case "YT":
            case "NU":
            case "AL":
            case "DE":
            case "NE":
            case "NV":
            case "OH":
            case "TN":
            case "UT":
            case "VA":
            case "WI":
                age = 19;
                break;
            case "MS":
                age = 21;
                break;      

        }
        if (new Date().getFullYear() - year <= age)
        {                                   
            return false;           
        }
        return true;
        },"In order to be eligible to Register, you must have reached the age of majority in your Province, Territory, or County of residence.");
 var validator = $("#signupForm").validate({
        rules: {
            Captcha: {
                required: true,
                remote: {
                    url: "/js/validate_captcha.php",
                    type: "post",
                    data: {
                        action: function () {
                            return "checkcaptcha";
                        },
                        username: function() {
                            var Captcha = $("#Captcha").val();
                            return Captcha;
                        }
                    }
                }               
            },          
            Password: "required PASSWORD",
            PasswordConfirm: {
                required: true,
                minlength: 5,
                equalTo: "#Password"
            },
            Username: {
                required: true,
                lettersnumbers: true,
                maxlength: 18,
                remote: {
                    url: "/js/validate_username.php",
                    type: "post",
                    data: {
                        action: function () {
                            return "checkusername";
                        },
                        username: function() {
                            var Username = $("#Username").val();
                            return Username;
                        }
                    }
                }

            },
            Country: "required",
            FirstName: "required",
            LastName: "required",
            Email: {
                required: true,
                remote: {
                    url: "/js/validate_email.php",
                    type: "post",
                    data: {
                        action: function () {
                            return "checkemail";
                        },
                        username: function() {
                            var Email = $("#Email").val();
                            return Email;
                        }
                    }
                },
                email: true
            },
            EmailConfirm: {
                required: true,
                email: true,
                equalTo: "#Email"
            },
            BirthDate: { 
                required: true,
                BIRTH: true
            },
            Agreement: "required",
            AgeCheck: "required",

        },
        messages: {
            captcha: "CAPTCHA response is required" ,
            Agreement: "You must agree by checking the box" ,
            AgeCheck: "You must agree by checking the box"  ,       
            EmailConfirm: "Email Addresses do not Match",
            lettersnumbers: "Username can only contain letters and numbers. No spaces allowed.",
            noSpace: "Username cannot have spaces",
            PasswordConfirm: "Please re-enter the same password as above",  
            Username:{
                remote: "This username is already taken. Try another.",
                maxlength: "Username may not be longer than 18 characters."
            },
            Captcha:{
                remote: "You have entered an incorrect CAPTCHA response."
            },              
            Email:{
                remote: "This e-mail is already taken. Try another."
            },          
            Password: {
                required: "Please provide a password",
                minlength: "Your password must be at least 5 characters long. Please include 1 or more numbers."            },
            required: "Required Field" ,
        },
    }); 

});

</script> 
```

现在，登录验证器：

```
<script type="text/javascript">
$(document).ready(function() {

   var loginvalidator = $("#form_login").validate({
      rules: {
          LoginUser: {
              required: true,
              remote: {
                  url: "/js/validate_login_username.php",
                  type: "post",
                  data: {
                      action: function () {
                          return "checkusername";
                      },
                      username: function() {
                          var Email = $("#LoginUser").val();
                          return Email;
                      }
                  }
              }             
          },    

          LoginPassword: "required"

      },
      messages: {               
          LoginUser: {
              required: "Required Field",
              remote: "The username or email entered was not found. Please note, your username must contain only letters and numbers, and never any spaces. Try logging in with your email address instead." },
          LoginPassword: {
              required: "Required Field",
              remote: "Password is incorrect. Please try again." },
      },
   });  
});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:25:46.180

*[以下答案已根据评论进行编辑]*

因为没有什么特别的错误从代码中跳出来：

*   尝试在每个验证器中启用调试选项 {debug:true} 以获得一些输出到控制台以发现问题。

*   您没有明确说明要验证哪些事件，请考虑将 {onkeydown:false, onfocusout:false, onclick:false} 添加到选项哈希中，以便将验证限制为仅提交事件。

*   在右括号后的规则哈希中还有一些不必要的尾随逗号。也许不足以导致错误，但当我遇到意外行为时，我总是很想清理类似的东西。[注意：@Sparky，这只是旧版本 IE 中的问题。]

PS：原始海报解决了由于使用隐藏字段而导致出生功能失败的问题，该隐藏字段被浏览器（firefox）的无效数据静默填充并导致验证失败。

# c# - 动态 Asp.net 按钮未触发

> ID：14102375
> 
> 赞同：0
> 
> 时间：2012-12-31T13:48:54.107
> 
> 标签：c#, asp.net, .net, c#-4.0

在我的程序中，我使用了一个带有以下代码的动态按钮：

```
Button button = new Button();  
button.ID = counter.ToString();
button.Text = "ok";
button.Click += new EventHandler(this.ButtonClick);

list.Controls.Add(button); 
```

我添加了如下点击事件的代码：

```
private void ButtonClick(object sender, EventArgs e)
{
    //..
} 
```

有几种解决方案：

[C# 按钮不触发？](https://stackoverflow.com/questions/3791762/c-sharp-button-not-firing)

[动态创建的按钮不触发 Click 事件](https://stackoverflow.com/questions/8324585/dynamically-created-button-not-firing-click-event)

我已阅读并应用它们，但我无法解决问题。

我的动态按钮操作放在`Page_Load`. （我试过了`Page_Init`，它没有再次被解雇。）

为了调试，我使用断点。我把它放到了`Page_Load`，第一次页面工作并且程序在断点处停止，然后我继续..点击动态按钮后，代码没有被触发......

我的`Page_Load`喜欢如下：

```
protected void Page_Load(object sender, EventArgs e)
{
    if (!IsPostBack)
    {
         //..
         case "button":

         Button button = new Button();  
         button.ID = counter.ToString();
         button.Text = "ok";
         button.Click += new EventHandler(this.ButtonClick);

         list.Controls.Add(button);
         break;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:03:04.517

当您在 web 表单中动态创建控件时，您需要在每次回发时再次动态地重新创建它们。

确保您了解 Web 表单页面的生命周期，并在预初始化阶段在事件触发之前重新注册控件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T18:16:59.480

要在 web 表单中创建**动态**按钮控件，请在您想要的按钮上赋予**偏移值。**

# c# - llblgen AND-OR 运算符存在 AND-OR

> ID：14102377
> 
> 赞同：0
> 
> 时间：2012-12-31T13:48:59.037
> 
> 标签：c#, sql, llblgenpro

我想在下面生成llblgen形式的sql语句

```
select * from sometable where

c1=4 AND (  c2 <> 'true' OR c2 IS NULL ) 
```

但是我无法获得确切的过滤器选项运算符`AND`存在于运算符之上，`OR`所以我很困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T12:04:37.807

您可以在 PredicateExpression 中使用括号。您还可以使用单独的谓词并根据需要混合它们。

这是 LLBLGenPro 文档中的相关信息：[构建谓词表达式](http://llblgen.com/documentation/3.5/LLBLGen%20Pro%20RTF/hh_goto.htm#Using%20the%20generated%20code/Adapter/Filtering%20and%20Sorting/gencode_filteringpredicateclasses_adapter.htm#constructingpredicateexpressions)

# ruby - 不能要求 Ruby 模块

> ID：14102382
> 
> 赞同：1
> 
> 时间：2012-12-31T13:49:44.203
> 
> 标签：ruby

执行文件“dbTest.rb”时：

```
require 'mysql'
con = Mysql::new("192.168.10.70", "dbuser", "asd1234", "asd")
puts con.get_server_info 
```

经过 ：

```
ruby dbTest.rb 
```

我得到错误：

```
dbTest.rb:1:in `require': no such file to load -- mysql (LoadError) 
```

当我执行 "gem list" 时，我看到 mysql、mysql2 和 dbd-mysql 都在那里。你能指出我的错误吗？提前谢谢您的时间。

干杯！

编辑 ：

由于我不知道的原因，我有两个 1.8 版本，但 gem 正在与正确的 ruby​​ 对话：

```
cem@skynet:/usr/bin$ sudo update-alternatives --config ruby
[sudo] password for cem: 
There are 2 choices for the alternative ruby (providing /usr/bin/ruby).

  Selection    Path                Priority   Status
------------------------------------------------------------
* 0            /usr/bin/ruby1.8     50        auto mode
  1            /usr/bin/ruby1.8     50        manual mode
  2            /usr/bin/ruby1.9.1   10        manual mode

Press enter to keep the current choice[*], or type selection number: 
cem@skynet:/usr/bin$ sudo update-alternatives --config gem
There are 2 choices for the alternative gem (providing /usr/bin/gem).

  Selection    Path               Priority   Status
------------------------------------------------------------
* 0            /usr/bin/gem1.8     180       auto mode
  1            /usr/bin/gem1.8     180       manual mode
  2            /usr/bin/gem1.9.1   10        manual mode

Press enter to keep the current choice[*], or type selection number: 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T14:12:10.083

由于您使用的是 Ruby 1.8，我认为这`require 'rubygems'`是必需的：

```
require 'rubygems'
require 'mysql'
con = Mysql::new("192.168.10.70", "dbuser", "asd1234", "asd")
puts con.get_server_info 
```

如果您想了解更多信息，请查看“ [require ruby​​gems 如何帮助查找 ruby​​gem 文件？](https://stackoverflow.com/questions/6181684/how-does-require-rubygems-help-find-rubygem-files) ”中的答案。

# ios - 从 NSObject 呈现模态视图控制器

> ID：14102383
> 
> 赞同：0
> 
> 时间：2012-12-31T13:49:47.623
> 
> 标签：ios, model-view-controller

我有一个在后台不断运行的自定义类（NSObject）。在某些时候，它会弹出一个 UIAlertView，用户有两个选项。自定义类是 UIAlertView 的委托，因此处理按钮按下。

如果用户按下特定按钮，我想向用户展示一个模态视图控制器。我的问题是，这一切都是从 NSObject 处理的。它不是从 UIViewcontroller 处理的，所以我想不出一种方法来从这个并行运行的 NSObject 中呈现这个新的 View Controller。

我是否需要以某种方式确定当前哪个 VC 处于顶部且处于活动状态，以便在其之上展示一个新的 VC？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T14:13:03.633

基本上，您需要访问对导航控制器的引用（假设您有一个）或来自 AppDelegate 的类似内容，以便呈现视图控制器。类似于以下内容：

```
MyAppDelegate *appDelegate = (MyAppDelegate *)[[UIApplication sharedApplication] delegate];
[appDelegate.navigationController presentViewController:myNewViewController animated:YES completion:nil]; 
```

# vb.net - 使用哪个控件来显示从查询返回的多个行和列？

> ID：14102388
> 
> 赞同：0
> 
> 时间：2012-12-31T13:50:01.177
> 
> 标签：vb.net, data-binding

我有这个 SQL 查询：

```
SELECT        exitHour, [date], enterHour, total
FROM            enterAndExit
WHERE        (id = ?) 
```

我应该使用哪个控件来显示从该查询中获得的“新表”？因为标签只适合显示单行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:56:57.003

您应该使用 DataGridView。这是 Microsoft 关于[DataGridView](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx)的文档。[您可以在此处](http://vb.net-informations.com/datagridview/vb.net_datagridview_tutorial.htm)找到有关使用 DataGridView 的教程。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:54:47.153

在 WinForm 项目中用于此类任务的最常用控件是[DataGridView](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.aspx)控件。

# javascript - JavaScript 中的属性初始化

> ID：14102395
> 
> 赞同：7
> 
> 时间：2012-12-31T13:50:31.927
> 
> 标签：javascript, oop, class, properties

我在 JavaScript 中创建了一个类，如下所示：

```
var Test = function(){
    this.element = null;
    this.init = function() {
        if(Test.html == "") {
            Test.loadHtml(this);
            return;
        }
        this.initElements();
        this.someMethodInternalCall();
    };
    this.initElements = function() {
        // append the loaded html to body
        // etc...
        this.element = $("some-element-contained-in-loaded-html-apended-to-body");
    }
    this.someMethodInternalCall = function() {
        this.element.css({some:style}); // works in this place
    }
    this.someMethodExternalCall = function() {
        this.element.css({some:style}); // dosn't work in this place
        // I mean here this.element is null. WHY?
    }
};
Test.html = "";
Test.loadHtml = function() {
    // load html content by an ajax request (jQuery $.ajax method)
    // and put it in Test.html
    // then recall the Test.init ethod
    return function(caller) {
        Test.html = // load html by ajax... etc...
        caller.init();
    };
}();

function someUsage(){
    var t = new Test();
    t.init();
    t.element.css({some:style}); // error: t.element is null WHY?
    t.someMethodExternalCall(); // error: this.element is null WHY?
} 
```

如您所见，我在上面的代码中进行了解释。为什么我们在初始化后设置属性时，它只是在内部调用中生效？如何创建可以更改其值的属性？

**更新：**

看来我必须解释我的代码。问题全在于`element`属性，而`Test.html`不是`Test.loadHtml`方法或调用它。`Test.loadHtml`立即触发（您可以对其进行测试）并`Test.html`获取加载的html，并将加载的html附加到`body`等等。这是一个 JavaScript 模式（我忘了它的名字是什么）并且可以正常工作。唯一错误的是关于属性初始化 - `element`.

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T14:28:10.233

问题是异步性。当您要通过 AJAX 加载 HTML 时，其余功能将继续...

```
function someUsage(){
  var t = new Test();
  t.init();
  // The following carries on whilst the request is loading it does not wait
  t.element.css({some:style}); // This is why I am null
  t.someMethodExternalCall(); // This is why I am also null
} 
```

为了解决这个问题，您可以使用回调...

```
function someUsage(){
  var t = new Test();
  t.init(function() {
    // I do not continue until the loadHtml request has completed
    t.element.css({some:style}); // I am not null anymore
    t.someMethodExternalCall(); // I am not null anymore
  });
} 
```

你需要修改你的 init 函数和你的 loadHtml 函数来调用回调而不是调用者对象的 init 方法，init 函数......

```
this.init = function(callback) {

  // Using blank Test.html to determine whether the html has been loaded
  if(Test.html == "") {
    var me = this;

    // Call loadHtml with a callback function
    Text.loadHtml(function() {

      // I want to keep the this reference to the object and callback argument
      me.init(callback);
    });

  // It is loaded so continue set up and then trigger the callback
  } else {
    this.initElements();
    this.someMethodInternalCall();
    callback();
  }
}; 
```

如果您创建了许多这样的 Test 类，仍然会导致问题，因为每个类都会在其他类加载时尝试获取 HTML。

要解决这个问题，您只需要有一个由第一次调用设置的标志。任何后续调用都将被忽略，但会记录回调以在 HTML 完成加载时调用...

```
Test.loadHtml = function(callback) {

  // If already loading roll up callbacks
  if(Test.loading) {

    // Callback becomes a function that calls the original callback function 
    // and then the new one
    Test.callback = (function(original) {
      return function() {
        original();
        callback();
      }
    }) (Test.callback);

  // First time it has been called set the flag to prevent multiple loads 
  // and add the callback
  } else {
    Test.loading = true;
    Test.callback = callback;

    // Added to illustrate the AJAX callback functionality
    ajax("html", function(response) {
      Test.html = response;
      Test.callback();
    });
  }
}(); 
```

首选方法是在实例化时强制执行对象有效性，这可以防止这些竞争条件。如果无法有效地构造类，则会引发错误，这会从类中移动围绕操作顺序的复杂性。正如您在下面看到的那样，它并不那么漂亮，您必须自己调用加载步骤（或让其他东西触发它）。

```
new Test(); // Errors not loaded!
// We must perform the load step to use the class
Test.load(function() {
  new Test(); // Works!
}); 
```

更优雅的解决方案，尤其是对于大型应用程序，涉及管理对类的访问。如果不先执行加载步骤，您将无法访问该类，这强制加载将始终在类实例化之前完成。

```
// views is some object managing the loading of view classes when asked for
// one or more views it will load the required HTML and return the class(es)
// so we can create instances...
views.load("Test", function(Test) {
  var t = new Test();
  t.element.css({some: style});
  t.someMethodExternalCall();
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:33:44.860

你是在做`caller.init();`ajax函数的回调`loadHtml`吗？

如果没有，您的 init 函数将在加载 html 之前添加到执行堆栈（这就是为什么`this.element`为 null）

```
Test.loadHtml = function() {
    // load html content by an ajax request (jQuery $.ajax method)
    // and put it in Test.html
    // then recall the Test.init ethod
    return function(caller) {
      $.ajax({
        url: 'somethinghere',
        success: function(data) {
            Test.html = data;
            caller.init();
        }
      });
    }; 
```

# php - 为什么这个 mysql 查询没有成功插入到我的数据库中？

> ID：14102402
> 
> 赞同：0
> 
> 时间：2012-12-31T13:50:57.893
> 
> 标签：php, mysql, mysqli

我正在尝试获取以下脚本以将提交的数据发送到我的数据库。看来我失败了，并且从 mysqli_error 得到一个错误，告诉我我的 sql 语法是错误的。然而，我正在遵循我书中所述的语法。

如果设置了 Get['save']，则表示表单已提交。我尝试按照stackoverflow其他地方的建议在列名周围添加反引号，但无济于事。

以下是我得到的错误：

> “您的 SQL 语法有错误；请查看与您的 MySQL 服务器版本相对应的手册，了解在 '[(`person`, `age`)] VALUES ({$person, $age})' 附近使用的正确语法在第 1 行"
> 
> 警告：mysqli_fetch_array() 期望参数 1 为 mysqli_result，布尔值在第 33 行的 C:\wamp\www\contacthmw3\index.php 中给出
> 
> ```
> Call Stack  
> # Time    Memory  Function    Location  
> 1 0.0024  148104  {main}( )   ..\index.php:0  
> 2 0.0163  157640  mysqli_fetch_array ( )  ..\index.php:33 
> ```

```
 <?php
    include_once 'magicquotes.php';
    include_once 'db.inc.php'; // connects, sets chars, selects db
    include_once 'form.php'; // just saves form to $form

    $sqlselect = 'SELECT person, age FROM people;
      SELECT email, phone FROM contacts;';
    if (!isset($_GET['save'])) {
        echo $form;
    } else {
        $person = $_GET['person'];
        $age = $_GET['age'];
        $email = $_GET['email'];
        $phone = $_GET['phone'];
        $sqlsave = 'INSERT INTO people (`person`, `age`) VALUES ($person, $age);';
        $savedtodb = mysqli_query($link, $sqlsave);
        if (!$savedtodb)
        {echo 'Failed to save to db' . mysqli_error($link);}
        // send form submission to db with sanitized data
    }

    $contacts = mysqli_query($link, $sqlselect); //retrieve data into $contacts array
    if (!$contacts) {
        echo 'Failed to get contacts from db.' . mysqli_error($link);
    }
    while ($row = mysqli_fetch_array($contacts)) {
        $showme[] = array('person' => $row['person'], 'age' => $row['age']);

        foreach ($showme as $indiv => $age) {
            echo $indiv . $age;
        }
    }
    ?>

    <?php
    if (isset($_GET['save'])):
    ?>
        <p>Last details entered into the table:</p>
        <table border="1">
            <tr> <th>Person</th><th>Age</th><th>Email</th><th>Phone</th></tr>
            <tr>

                <td> <?php echo $_GET['person']; ?></td>
                <td> <?php echo $_GET['age']; ?></td>
                <td> <?php echo $_GET['email']; ?></td>
                <td> <?php echo $_GET['phone']; ?></td>
            </tr>
        </table>
    <?php
        endif;
    ?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T13:53:48.477

您正在尝试使用[mysqli_query()](http://www.php.net/manual/en/mysqli.query.php)而不是[mysqli_multi_query()](http://www.php.net/manual/en/mysqli.multi-query.php)执行多个查询；并且您可能应该使用连接运行单个查询以获得所需的结果

# c++ - 动态二维数组：空间问题

> ID：14102404
> 
> 赞同：1
> 
> 时间：2012-12-31T13:51:07.667
> 
> 标签：c++

我正在使用以下代码创建动态二维数组。

```
uint32_t** arrays = new uint32_t*[1000]; 
uint32_t number = take input from console ;
arrays[0] = new uint32_t[number];
number = take input from console ;
arrays[1] = new uint32_t[number];
delete arrays[0] ;
number = take input from console ;
arrays[0] = new uint32_t[number] ; 
```

我正在使用 64 位 Unix 机器来执行上述代码。

在上面的代码中，机器使用 64 位指针指向二维数组，这就是代码占用更多空间的原因。

谁能帮助我，如何转换代码，因此它需要 32 位指针？或者另一种解决空间复杂性的方法？我不想使用向量的向量，因为我的教授没有要求这样做。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:49:56.000

Actually, your code is already pretty much memory optimized as it is.

You allocate a 1000 64-bit pointers in your first line. That's unavoidable since that is what your machine uses. However, that only takes 8000 bytes, hardly worth the effort optimizing these days.

In the next lines, you dynamically allocate space for int32_t arrays, which only take 4 bytes per entry. So if you allocate 30 million entries, it will take 120.000.000 bytes. I think you are mistaken in thinking that this secondary array will take 30 million * 8 bytes = 240.000.000 bytes, which it doesn't. Only the pointer is 64 bit, the data itself will take up as much or as little space as it needs.

**Addendum**: I want to add that allocating a two dimensional array, as some have suggested, will actually waste more memory, since your clearly don't know how long each secondary entry will be. Your solution allocates only as much space as needed.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T13:55:09.460

您无法控制系统上的指针大小。

选择不关心，或者更好的是，使用实际的二维数组而不是指针数组。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T14:45:51.990

这可能是一个疯狂的想法，但同样，您的问题也不是最标准的。

为什么不只使用堆基地址的偏移量？您将被限制为 32 位堆地址空间（4GB 堆），但如果您不想放弃 64 位指针所需的额外 4 个字节，那么您将很难克服这一限制。

这个想法是获取你的堆的基地址（可能，即使不是完全简单），它在一个全局变量中 - 让我们称之为 heap_base ......或类似的东西。

Now, when you create a pointer, don't store it's whole value in the first array, only store it's its offset (the difference) from heap_base.
When you want to access an element, restore the correct pointer value with addition.

This might not work - it depends on how the OS will allocate data on the heap - but I figured it might give you a nice idea for a solution.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:10:28.950

另一种（更确切地说是 f*#@&d 向上的方式）查看它是使用 1 个 64 位指针来存储 2 个 32 位数字。所以有 64 位数字的数组，然后在每个元素中存储两个 32 位数字。

然后编写单独的方法，使用位操作和其他方式将这些访问为 32 位值，例如您的 get 看起来像这样。

```
 uint32_t get (int i, int j)
{
   if (j % 2 == 0) 
    {
      return array[i][j/2] % (2^32)
    }
    else
    {
      return array[i][j/2] / (2^32)
    }
}; 

```

# python - 在新型类中实现 __getitem__

> ID：14102407
> 
> 赞同：5
> 
> 时间：2012-12-31T13:51:10.913
> 
> 标签：python, python-2.7

我有这个代码：

```
class A:
    def __init__(self):
        def method(self, item):
            print self, ": Getting item", item
        self.__getitem__ = types.MethodType(method, self, self.__class__)

class B(object):
    def __init__(self):
        def method(self, item):
            print self, ": Getting item", item
        self.__getitem__ = types.MethodType(method, self, self.__class__) 
```

然后这工作正常：

```
a = A()
a[0] 
```

但这不会：

```
b = B()
b[0] 
```

引发类型错误。

我发现新式类在类 __dict__ 而不是实例 __dict__ 中寻找魔术方法。这是正确的吗？为什么会这样？你知道任何解释背后想法的文章吗？我尝试了 RTFM，但可能不是正确的，或者没有抓住东西......

非常感谢！保罗

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:08:22.550

这记录在 Python 数据模型文档中：[新式类的特殊方法查找](http://docs.python.org/2/reference/datamodel.html#new-style-special-lookup)：

> 对于新式类，特殊方法的隐式调用只有在对象类型上定义时才能保证正常工作，而不是在对象的实例字典中。

和

> 这种行为背后的基本原理在于许多特殊方法，例如`__hash__()`和`__repr__()`由所有对象实现，包括类型对象。如果这些方法的隐式查找使用常规查找过程，则在类型对象本身上调用它们时会失败[.]

因此，因为两者都`hash(int)` *必须* `hash(1)`工作，所以在类型而不是实例上查找特殊方法。如果`__hash__()`直接在对象上查找，`hash(int)`将被转换为`int.__hash__()`，这将失败，因为它是一个未绑定的方法，并且它期望在(eg )`int.__hash__()`的实际*实例*上调用；所以对于,应该改为：`int()``1``hash(int)``type.__hash__()`

```
>>> hash(1) == int.__hash__(1)
True
>>> hash(int) == type.__hash__(int)
True
>>> int.__hash__()
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: descriptor '__hash__' of 'int' object needs an argument 
```

这是一个向后不兼容的更改，因此它仅适用于新样式对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:59:56.763

特殊方法仅在对象的类是新式类时才针对其进行查找，这与旧式类不同。您正在`__getitem__`实例上定义方法，这对新样式类没有影响。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:08:04.193

默认迭代器不在`__getitem__`新样式类中使用。有关示例，请参见[http://grokbase.com/t/python/tutor/085k143q1r/new-style-classes-getitem-and-iteration](http://grokbase.com/t/python/tutor/085k143q1r/new-style-classes-getitem-and-iteration)。似乎`__getitem__`随着 python 2.2 和新样式的类的行为发生了变化

# ruby - 从方法调用中生成哈希的最简单方法

> ID：14102408
> 
> 赞同：0
> 
> 时间：2012-12-31T13:51:12.403
> 
> 标签：ruby, map, dry

我有这样的代码：

```
class Foo

  # (method definitions)

  def make_hash
    {
      some_method: some_method,
      some_other_method: some_other_method 
    }
  end

end 
```

我怎样才能简化或干燥`make_hash`？我想要类似`slice`or Rails' 的东西`attributes.slice`，但适用于普通类的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:01:15.890

这样的事情会有所帮助。

```
mlist = {}

Foo.instance_methods(false).each do |name|
  mlist[name] = Foo.instance_method(name)
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:15:28.680

一种方法是使用默认值块创建哈希：

```
def methods_hash
    @methods_hash ||= Hash.new {|hash, key| hash[key] = self.class.instance_method(key) }
end 
```

因此，每次您请求哈希的密钥时，它都会动态加载 instance_method 而无需预先加载所有内容。instance_method 方法返回对象，因此您可能想要`.to_s`或`.to_sym`满足您的需要。

不过，我对这个问题很感兴趣，并且有兴趣知道您使用这种方法的最终目标是什么。

# php - Drupal 7 模块 shell_exec 问题

> ID：14102409
> 
> 赞同：0
> 
> 时间：2012-12-31T13:51:16.700
> 
> 标签：php, linux, command-line, drupal-7, shell-exec

我正在尝试在我的 Linux 服务器上创建一个包含通过 PHP 输出的 XML 的文件。

我正在使用以下代码行：

```
print "CHECKING: " . shell_exec("echo {$output} > tested.xml"); 
```

$output 变量包含格式良好的 XML，我正在尝试动态创建 test.xml 并填充它......但它不起作用。

修正：

我刚刚尝试了以下方法：

```
print "CHECKING: " . shell_exec("echo {$output} > /var/www/mysite/sites/all/modules/my_module/output/tested.xml"); 
```

然后我给了输出目录完整的 777 权限，但我的 XML 文件仍然没有被创建。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:16:23.390

提供的代码中唯一缺少的是 shell_exec 命令中指定的重定向中的绝对路径指定。假设 Web 服务器运行的 OS 用户（例如，'apache'）对目标目录具有写入权限，则输出将写入 IO 重定向中指定的文件。

例如，要将 XML 文件的输出写入 /tmp，请使用以下代码：

```
print "CHECKING: " . shell_exec("echo {$output} > /tmp/tested.xml"); 
```

**修正：**

我没有提供我自己的答案，而是决定以您的出色工作为基础 :-) 您的建议与完整的 XML 标记一起使用，并带有以下稍微调整的代码：

```
print "CHECKING: " . shell_exec("echo '{$output}' > /tmp/tested.xml"); 
```

*ps：您也正确的是，绝对需要在其中创建文件的apache允许目录的完整路径。*

# email - 如何检查电子邮件地址是否正确且存在？

> ID：14102414
> 
> 赞同：0
> 
> 时间：2012-12-31T13:51:41.743
> 
> 标签：email, smtp, telnet, email-verification

> **可能重复：**
> [如何在不发送电子邮件的情况下检查电子邮件地址是否存在？](https://stackoverflow.com/questions/565504/how-to-check-if-an-email-address-exists-without-sending-an-email)

*我想知道：有没有办法使用Telnet*或*SMTP 协议 cmd-line*在发送电子邮件之前检查电子邮件地址是否*正确*以及它是否*存在*？

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:58:34.667

检测电子邮件地址是否存在的唯一有效解决方案是发送电子邮件并等待答复。

大多数时候，您还希望确保您的用户是帐户的所有者，并且此解决方案会同时进行这两项检查。

您不能只在客户端执行此操作，您需要一个服务器端 API。**

# javascript - Typescript 和 ExpressJs 提供的脚本未运行

> ID：14102415
> 
> 赞同：2
> 
> 时间：2012-12-31T13:51:55.820
> 
> 标签：javascript, node.js, coffeescript, express, typescript

我想将我的简约服务器从 Coffeescript 翻译成 Typescript。这是原始代码：

```
express = require("express")
app=express()
app.use(express.static(__dirname))
app.set("views", __dirname + "/views")
app.set("view engine", "jade")
app.get("/", (req,res)->
        res.render "index")
port = process.env.PORT or 5000
server=app.listen(port)

io=require("socket.io").listen(server)
io.sockets.on("connection", (socket)->socket.emit("news", "data")) 
```

这是打字稿版本：

```
/// <reference path="d.ts/node.d.ts"/>
/// <reference path="d.ts/socket.io.d.ts"/>
/// <reference path="d.ts/express3.d.ts"/>

import express3 = module("express3");
var express = require("express");
var app = express();
app.use(express.static(__dirname));
app.set("views", __dirname+"/views");
app.set("view engine", "jade");

app.get("/", (req, res) => { res.render("index"); });

var port = 5000;
var server=app.listen(port);

import socketio = module("socket.io");
var io=socketio.listen(app);
io.sockets.on("connection", (socket) => { socket.emit("news", "data"); }); 
```

两个版本都编译为 server.js 没有问题。生成的代码有不同的风格，但据我所知，语义应该是相同的。您可以查看 pastebin 上的两个输出文件。

[咖啡脚本： http](http://pastebin.com/38LZhcPZ) ://pastebin.com/38LZhcPZ

打字稿： http: [//pastebin.com/95ABVsB2](http://pastebin.com/95ABVsB2)

响应“index.jade”包含一个未完成的小型 RaphaelJs 游戏。现在问题来了。如果我启动咖啡脚本生成的 server.js 并打开 localhost:5000，一切都很好。游戏开始运行。

但是如果我运行编译后的打字稿版本，游戏就不会启动。打开 localhost:5000 没有问题。该网站的服务没有错误，如果我检查页面源，它​​就在那里。起初我以为 express 的静态文件服务器可能无法正常工作。但是当我点击`<script src="../scripts/game.js"/>`页面源代码时，代码就在那里。游戏逻辑是从window.onload开始的，也许有问题，但那看起来很奇怪。

我能做些什么 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:28:18.910

乍一看，它似乎不是相同的代码：

原始和 CoffeeScript 生成：

```
io = require("socket.io").listen(server); 
```

但是您的 TypeScript 代码具有：

```
var io = socketio.listen(app); 
```

如果您将 TypeScript 代码修改为以下内容，我认为您应该采取行动：

```
var io = socketio.listen(server); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:30:44.123

Your call to socketio.listen() is passing **app** in the CoffeeScript example but **server** in the TypeScript example.

```
var io = socketio.listen(app);

io = require("socket.io").listen(server); 
```

# python - Python Requests requests.exceptions.SSLError: [Errno 8] _ssl.c:504: EOF 发生违反协议

> ID：14102416
> 
> 赞同：65
> 
> 时间：2012-12-31T13:51:58.670
> 
> 标签：python, openssl, httprequest, python-requests, ubuntu-12.10

我在 Ubuntu 12.10 上使用 OpenSSL 1.0.1c、python 2.7.3、[Requests](http://www.python-requests.org/en/latest/) 1.0.3 和 1.0.4（都尝试过），并且在尝试使用以下代码在 url 变量中连接到网站时。

```
def SendInitialRequest(xmlmessage, redirecturl):
    url = 'https://centineltest.cardinalcommerce.com/maps/txns.asp'

    payload = 'cmpi_msg=' + ET.tostring(xmlmessage)
    headers = {
        'Content-Type': 'application/x-www-form-urlencoded',
    }
    r = requests.post(url, data=payload, headers=headers, verify=None)
    print r.text 
```

它抛出以下错误：

```
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "clams/libs/centinel/thinclient.py", line 134, in SendInitialRequest
    r = requests.post(url, data=payload, headers=headers, verify=None)
  File "/home/jasonamyers/.virtualenv/clams/lib/python2.7/site-packages/requests/api.py", line 87, in post
    return request('post', url, data=data, **kwargs)
  File "/home/jasonamyers/.virtualenv/clams/lib/python2.7/site-packages/requests/api.py", line 44, in request
    return session.request(method=method, url=url, **kwargs)
  File "/home/jasonamyers/.virtualenv/clams/lib/python2.7/site-packages/requests/sessions.py", line 269, in request
    resp = self.send(prep, stream=stream, timeout=timeout, verify=verify, cert=cert, proxies=proxies)
  File "/home/jasonamyers/.virtualenv/clams/lib/python2.7/site-packages/requests/sessions.py", line 364, in send
    r = adapter.send(request, **kwargs)
  File "/home/jasonamyers/.virtualenv/clams/lib/python2.7/site-packages/requests/adapters.py", line 163, in send
    raise SSLError(e)
requests.exceptions.SSLError: [Errno 8] _ssl.c:504: EOF occurred in violation of protocol 
```

尝试使用 openssl 连接会返回以下内容：

```
$ openssl s_client -connect centineltest.cardinalcommerce.com:443
CONNECTED(00000003)
140019346777760:error:140790E5:SSL routines:SSL23_WRITE:ssl handshake failure:s23_lib.c:177:
---
no peer certificate available
---
No client certificate CA names sent
---
SSL handshake has read 0 bytes and written 226 bytes
---
New, (NONE), Cipher is (NONE)
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
--- 
```

如果我强制它使用 tls1 它可以工作（输出被截断）：

```
$ openssl s_client -tls1 -connect centineltest.cardinalcommerce.com:443
CONNECTED(00000003)
depth=2 C = US, O = "thawte, Inc.", OU = Certification Services Division, OU
verify error:num=20:unable to get local issuer certificate
verify return:0
--- 
```

我已经看到了很多关于这个的[错误报告](https://bugs.launchpad.net/ubuntu/+source/openssl/+bug/965371)；但是，我还没有找到使用 python requests 库解决它的方法。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-01-03T19:45:42.123

从[请求问题页面](https://github.com/kennethreitz/requests/issues/1083#issuecomment-11853729)为其他人重新发布此内容：

在版本 1 之前，Requests' 不支持这样做。在版本 1 之后，您应该继承 HTTPAdapter，如下所示：

```
from requests.adapters import HTTPAdapter
from requests.packages.urllib3.poolmanager import PoolManager
import ssl

class MyAdapter(HTTPAdapter):
    def init_poolmanager(self, connections, maxsize, block=False):
        self.poolmanager = PoolManager(num_pools=connections,
                                       maxsize=maxsize,
                                       block=block,
                                       ssl_version=ssl.PROTOCOL_TLSv1) 
```

完成后，您可以执行以下操作：

```
import requests
s = requests.Session()
s.mount('https://', MyAdapter()) 
```

然后通过该会话对象的任何请求都将使用 TLSv1。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2014-06-11T15:10:55.560

设置 verify=False 只会跳过验证服务器证书，但无助于解决 SSL 协议错误。

此问题可能是由于在 Web 服务器上禁用了 SSLv2，但 Python 2.x 默认尝试与 PROTOCOL_SSLv23 建立连接。这发生在[https://github.com/python/cpython/blob/360aa60b2a36f5f6e9e20325efd8d472f7559b1e/Lib/ssl.py#L1057](https://github.com/python/cpython/blob/360aa60b2a36f5f6e9e20325efd8d472f7559b1e/Lib/ssl.py#L1057)

您可以通过覆盖 ssl_version 关键字参数来对 ssl 模块中的 ssl.wrap_socket() 进行猴子补丁。以下代码可以按原样使用。在发出任何请求之前，将其放在程序的开头。

```
import ssl
from functools import wraps
def sslwrap(func):
    @wraps(func)
    def bar(*args, **kw):
        kw['ssl_version'] = ssl.PROTOCOL_TLSv1
        return func(*args, **kw)
    return bar

ssl.wrap_socket = sslwrap(ssl.wrap_socket) 
```

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2016-02-15T21:35:38.097

安装“安全”包附加为`requests`我解决：

```
sudo apt-get install libffi-dev
sudo pip install -U requests[security] 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2012-12-31T14:07:49.370

这是一个已知的错误，您可以通过 hack 解决它：

打开`site-packages/requests/packages/urllib3/connectionpool.py`（或者只是在您自己的项目中制作请求的本地副本），并更改显示以下内容的块：

```
def connect(self):
    # Add certificate verification
    sock = socket.create_connection((self.host, self.port), self.timeout)

    # Wrap socket using verification with the root certs in
    # trusted_root_certs
    self.sock = ssl_wrap_socket(sock, self.key_file, self.cert_file,
                                cert_reqs=self.cert_reqs,
                                ca_certs=self.ca_certs,
                                server_hostname=self.host,
                                ssl_version=self.ssl_version) 
```

至：

```
def connect(self):
    # Add certificate verification
    sock = socket.create_connection((self.host, self.port), self.timeout)

    # Wrap socket using verification with the root certs in
    # trusted_root_certs
    self.sock = ssl_wrap_socket(sock, self.key_file, self.cert_file,
                                cert_reqs=self.cert_reqs,
                                ca_certs=self.ca_certs,
                                server_hostname=self.host,
                                ssl_version=ssl.PROTOCOL_TLSv1) 
```

否则，我想在某个地方有一个不那么骇人听闻的覆盖，但我看了几眼就找不到一个。

*注意*：在旁注中，`requests`MacOS 上的 PIP (1.0.4) 仅适用于您提供的 URL。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-08-28T00:34:52.303

我遇到过同样的问题：

> 引发 SSLError(e)
> requests.exceptions.SSLError: [Errno 8] _ssl.c:504: EOF 发生违反协议

我让提琴手运行，我停止了提琴手捕获并且没有看到这个错误。可能是因为提琴手。

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2013-12-07T04:34:53.747

我遇到了这个错误，修复似乎是关闭了 Python 2.7 不支持的 SNI：

[http://bugs.python.org/issue5639](http://bugs.python.org/issue5639)

[Google App Engine 上 python 2.7 SNI 上的 urllib3 错误](https://stackoverflow.com/questions/19477214/urllib3-on-python-2-7-sni-error-on-google-app-engine)

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2016-08-31T13:39:08.047

对于那些无法超越修复工作的人。

不得不更改文件 ssl.py 来修复它。查找函数 create_default_context 并更改行：

```
context = SSLContext(PROTOCOL_SSLv23) 
```

至

```
context = SSLContext(PROTOCOL_TLSv1) 
```

也许有人可以在不编辑 ssl.py 的情况下创建更简单的解决方案？

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-06T11:00:09.090

不幸的是，接受的答案对我不起作用。作为临时解决方法，您也可以`verify=False`在连接到安全网站时使用。

从[Python Requests 抛出 SSLError](https://stackoverflow.com/questions/10667960/python-requests-throwing-up-sslerror)

```
requests.get('https://example.com', verify=True) 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-27T07:36:43.580

I was having similar issue and I think if we simply ignore the `ssl` verification will work like charm as it worked for me. So connecting to server with `https` scheme but directing them not to verify the certificate.

Using `requests`. Just mention `verify=False` instead of `None`

```
 requests.post(url, data=payload, headers=headers, verify=False) 
```

Hoping this will work for those who needs :).

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-13T15:27:17.787

通过 TLS 连接到 RabbitMQ MQTT 服务器时出现此错误。我很确定服务器坏了，但无论如何它可以与 OpenSSL 1.0.1 一起使用，但*不能*与OpenSSL 1.0.2 一起使用。

您可以使用以下命令在 Python 中检查您的版本：

```
import ssl
ssl.OPENSSL_VERSION 
```

除了使用旧版本的 Python 之外，我不确定如何在 Python 中降级 OpenSSL（至少在 Windows 上似乎是静态链接的）。

# javascript - html5画布，当用户点击图片时显示文本

> ID：14102421
> 
> 赞同：2
> 
> 时间：2012-12-31T13:52:21.510
> 
> 标签：javascript, html, html5-canvas, kineticjs

我有一个带有 HTML5 画布的页面，上面显示了几个图像。有四个“描述框”图像和一些其他图像，每个图像都属于一个描述框。

用户需要将每个图像拖到其对应的描述框中。

目前可以在画布周围拖动图像，尽管我还没有添加将它们拖放到框中的功能。

在此之前，我想为用户添加一些“提示和提示”。我想要执行此操作的方式是，每次用户单击“可拖动”图像之一或将光标悬停在描述框上时，都会在画布区域外向用户显示文本提示。文本提示将仅包含有关用户选择/悬停在哪个图标上的更多信息。

我在画布下方的页面上添加了一个 HTML5 文本区域，这是我想要显示提示和提示的地方。

我有几个 JS 数组，一个包含画布上显示的所有图像，另一个包含所有提示。提示只会在一个项目上显示一个，因为显然，光标在任何给定时间只能在一个位置。

所以，我想要发生的是使用'if'语句，这样如果用户单击图像，则与该图像对应的文本提示将显示在文本框中，或者如果光标悬停在一个描述框，则该描述框对应的文本提示将显示在文本框中。

我使用了 kinetic.js 库将拖放功能添加到画布上的图像中，尽管我使用的是我在本地保存的库的副本，因为我需要更改一些关于它的功能。（我需要改变的事情是，最初，库在拖放功能之外清除画布上已绘制的任何内容，只要拖放图像，只需重新绘制拖放功能的图像正在被添加回它，所以我丢失了一些我在画布上绘制的其他东西，我不想被拖动。）

我知道我需要编辑我正在使用的 kinetic.js 库，以便通过提示添加此功能，但我只是想知道是否有人知道如何在文本区域中显示我的数组中的提示'已添加到我的页面？

我查看了 w3schools 上的“HTML5 textarea tag”页面，但看不到任何允许您定义文本区域中显示的文本的属性。我还查看了从该页面链接的“事件属性”页面，但在那里看不到任何看起来可以执行我想要的功能的属性。

当用户选择图像或将鼠标悬停在我的一个描述框上时，文本区域是用来显示我想要显示的文本的最佳选择吗？还是有其他东西可以显示文本（最好在页面的画布区域之外），并允许我更改动态显示的文本？

**编辑以显示 HTML 31/12/2012 @ 14:40**

```
<!DOCTYPE HTML>
<html>
  <head>
  <style>
    body {
      margin: 0px;
      padding: 0px;
    }
  canvas{
    border: 1px solid #9C9898;
    background:#F5F5F5;
  }
</style>
<div id="container"></div>
<script src="kinetic.js"></script>
<script src="drawdescriptionboxes.js"></script>
<script src="drawLevelOneElements.js"></script>
<script src="startgamedrawgameelementsdrawstartbutton.js"></script>
<script>
/*Add the game elements' global variables */
var currentLevel = 1;
var totalLevels = 3;
var currentScore = 0;
var currentScorePositionX = 950;
var currentScorePositionY = 10;

/*Add code to draw images to random locations here */
    //var imageX = Math.floor(Math.random()*950);
    //var imageY = Math.floor(Math.random()*450);

    var stage = new Kinetic.Stage({
      container: "container",
      width: 1000,
      height: 500
    });
    var imagesLayer = new Kinetic.Layer();
    var canvas = imagesLayer.getCanvas();
    var context = canvas.getContext("2d");
    console.log("Foo ");

/*Load the images from the HTML into the JavaScript */
function loadImages(sources, callback){
    var imagesDir = "";
    var images = {};
    var loadedImages = 0;
    var numImages = 0;

    //console.log("length " + sources.length);
    for (var src in sources){
        numImages++;
    }
    //console.log("Num Images " + numImages);

    var index=0;
    console.log("length " + sources.length);
    for (index=0;index < numImages ;index++){
        console.log(index);
        images[index] = new Image();
        images[index].src = sources[index];
        console.log("Adding " + sources[index]);
        callback(images[index]);
        console.log("images array length = " + images.length);
    }

    stage.add(imagesLayer); // should only be added once!!
}

/*Function to check whether the item being dragged is near its description box */
function isNearDescriptionBox(itemImage, descriptionBox){
    var ii = itemImage;
    var db = descriptionBox;
    if(ii.attrs.x > db.x - 20 && ii.attrs.x < db.x + 20 && ii.attrs.y > db.y - 20 && ii.attrs.y < db.y +20){
        return true;
    }else{
        return false;
    }
}

/* This function draws the game elements */
function drawGameElements(){
    /* Draw a line for the 'score bar'. */
    context.moveTo(0, 25);
    context.lineTo(1000, 25);
    context.stroke();

    /* Draw current level/ total levels on the left, and current score on the right. */
    context.font = "11pt Calibri"; /* Text font & size */
    context.strokeStyle = "black"; /* Font colour */
    context.strokeText(currentLevel + "/" + totalLevels, 10, 15);
    context.strokeText(currentScore, 750, 15);
}

function initStage(images){
    var stage = new Kinetic.Stage({
        container: "container",
        width: 1000,
        height: 500
    });
    var descriptionLayer = new Kinetic.Layer();
    //var imagesLayer = new Kinetic.Layer();
    var allImages = [];
    var currentScore = 0;

    var descriptionBoxes = {
        assetsDescriptionBox: {
            x: 70,
            y: 400
        },
        liabilitiesDescriptionBox: {
            x: 300,
            y: 400
        },
        incomeDescriptionBox: {
            x: 530,
            y: 400
        },
        expenditureDescriptionBox: {
            x: 760,
            y: 400
        },
    };

    /*Code to detect whether image has been dragged to correct description box */
    for (var key in sources){
        /*Anonymous function to induce scope */
        (function(){
            var privateKey = key;
            var imageSource = sources[key];

            /*Check if image has been dragged to the correct box, and add it to that box's
                array and remove from canvas if it has */
            canvasImage.on("dragend", function(){
                var descriptionBox = descriptionBoxes[privateKey];
                if(!canvasImage.inRightPlace && isNearDescriptionBox(itemImage, descriptionBox)){
                    context.remove(canvasImage);
                    /*Will need to add a line in here to add the image to the box's array */
                }
            })

        })();
    }

}

function drawImage(imageObj) {
    //var layer = new Kinetic.Layer();

    var canvasImage = new Kinetic.Image({
      image: imageObj,
      width: 50,
      height: 50,
      // puts the image in teh middle of the canvas
      x: stage.getWidth() / 2 - 50 / 2,
      y: stage.getHeight() / 2 - 50 / 2,
      draggable: true
    });

    // add cursor styling
    canvasImage.on('mouseover', function() {
      document.body.style.cursor = 'pointer';
    });
    canvasImage.on('mouseout', function() {
      document.body.style.cursor = 'default';
    });

    imagesLayer.add(canvasImage);
}

/*This code loads the images to the canvas when the browser window loads */
window.onload = function(){
    var sources = {};
        /*I've removed the code from here which simply adds the images in the hidden section of the html to the 'sources' JS array */

    loadImages(sources, drawImage);
    drawGameElements();
    drawDescriptionBoxes();
};
/*Try adding an if statement to display the text corresponding to whichever icon is selected */
if(document.body.innerText){
    var message = div.innerText;
} else {
    var message = div.innerHTML.replace(/\&lt;br\&gt;/gi,"\n").replace(/(&lt;([^&gt;]+)&gt;)/gi, "");
}

/*What I want to do here is, detect where on the canvas the mouse has been clicked, then if the click is
    on a part of the canvas that is displaying an image, get the ID belonging to that image, and display 
    the corresponding tip from the tips array in tips.js on the page below the canvas.*/
function isClickOnImage(event){
    var clickX = event.clientX;
    var clickY = event.clientY;

    var imageCheckIteration = 0;
    while(imageCheckIteration < sources.length){
        if((clickX > sources[imageCheckIteration].x && clickX < sources[imageCheckIteration].x + imageWidth) &&
        (clickY > sources[imageCheckIteration].y && clickY < sources[imageCheckIteration].y + imageHeight)){
            /*This is where I need to print the variable that holds the text I want to display, but I need to display its contents
            outside the canvas, in the <p></p> tags below. */
            document.getElementById("tipsParagraph").innerHTML = tips[imageCheckIteration];
        }
    }
}

</script>

</head>
<body>

<p><textarea>This is where the text will be displayed.</textarea></p>

<section hidden>
/*The code in this hidden section simply loads a number of images into the html, giving them an 'id', a 'src' and an 'alt' tag. */

</section>
</body>
</html> 
```

我已经删除了用于将图像添加到 HTML 中的隐藏部分以及将它们从那里添加到 JS 数组中的代码，只是为了减少显示的代码量。

**编辑 07/01/2013 @ 15:00**

我编辑了代码以显示函数“isClickOnImage(event)”。当我写这个函数时，我希望它会改变

标记为“tipsParagraph”的标签对应于“tips”数组的任何元素，对应于被点击的图像。但是由于某种原因，当我单击画布上的图像时，我希望更新的段落没有任何反应。知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T19:36:17.220

你不需要使用 KineticJS 的一些原生实现，在这种情况下你只需要它来处理事件，只需将 JQuery 添加到你的项目中，并使用选择器来更改文本区域的文本。

```
 //this can easily be used in your KineticJS event function.
  $("textarea").val(message); 
```

我建议你给你的文本区域一个 id 并使用 $('#textAreaId').val('hello world'); 设置您的信息

# java - 一次从文本文件中读取所有数据的最合适方法是什么？

> ID：14102427
> 
> 赞同：5
> 
> 时间：2012-12-31T13:52:57.933
> 
> 标签：java, android, inputstream

我有一个文本文件，我想将它的全部内容读入一个字符串变量。**当我使用 Android 的方法****时，该文件正在作为 InputStream 打开。`assetManager.open()`**

将全部内容读入字符串的最佳实践方法是什么？我目前正在用 InputStreamReader 和 BufferedReader 包装 InputStream，并使用我使用 readLine() 方法逐行读取文本的 while 循环。

考虑到我不需要逐行阅读，是否有更好的阅读方式，如果可能的话，我想一口气读完

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T13:54:35.607

这就是[Java 7`Files.readAllLines`方法](http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/7-b147/java/nio/file/Files.java#Files.readAllLines%28java.nio.file.Path%2Cjava.nio.charset.Charset%29)的作用——我希望它是一种非常好的方法（它使用 try-with-resources 语法，该语法很容易在 android 上工作）：

```
public static List<String> readAllLines(Path path, Charset cs) throws IOException {
    try (BufferedReader reader = newBufferedReader(path, cs)) {
        List<String> result = new ArrayList<String>();
        for (;;) {
            String line = reader.readLine();
            if (line == null)
                break;
            result.add(line);
        }
        return result;
    }
} 
```

在您的情况下，您可以将字符串附加到 StringBuilder 而不是将它们添加到列表中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:10:40.887

通常不应该重新发明轮子，所以如果开销在 Android 上是可以承受的，请使用 apache commons 库。使用[org.apache.commons.io.IOUtils.toString](http://commons.apache.org/io/api-1.4/org/apache/commons/io/IOUtils.html#toString%28java.io.InputStream,%20java.lang.String%29)。

```
InputStream in = new FileInputStream(new File("a.txt"));
String s = IOUtils.toString(in, "UTF-8"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:44:43.167

这是另一种可能的方式。

```
BufferedReader br = new BufferedReader(new FileReader("a.txt"));
char[] cbuf = new char[500];
br.read(cbuf);
String fileContents = new String(cbuf); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:54:10.203

```
Scanner scanner = new Scanner(file, encoding);      
scanner.useDelimiter("\\A");
if (!scanner.hasNext()) {       // corner case -- file is empty
    return "";
}
String result = scanner.next();
scanner.close(); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-31T13:57:30.537

您还可以使用 Scanner 类

```
Scanner scan = new Scanner(file);  
String content = scan.next(); 
```

# web - 将“Visual Studio 网站”添加到“MVC 4 Web 项目”

> ID：14102431
> 
> 赞同：0
> 
> 时间：2012-12-31T13:53:28.747
> 
> 标签：web, visual-studio-2012, webproject

将“Visual Studio 网站”添加到“MVC 4 Web 项目”。

我已完成以下步骤： - 使用 Visual Studio 2012 创建了一个新的 MVC 4 Web 项目。 - 在此项目下创建了一个文件夹。- 将网站的所有内容复制到此文件夹。- 在项目中包含此文件夹。- 构建这个项目。

出现错误“已经包含...的定义”

我认为错误是由于网站和 Web 项目的构建模型不同，在 Web 项目中它试图构建单个程序集，而在网站中它为每个页面创建单独的程序集。我不知道如何解决这个问题。

我只能想到一个选项来配置 web 项目，以便为每个页面生成单独的程序集。我尝试了“不要合并，为每个页面和控件生成单独的程序集”选项，但它不能解决问题。

我不确定如何配置 Web 项目，使其在每个页面/文件夹中生成单独的程序集。

# ruby-on-rails - 如何使数据库迁移创建具有特定属性的表？

> ID：14102432
> 
> 赞同：1
> 
> 时间：2012-12-31T13:53:42.407
> 
> 标签：ruby-on-rails, activerecord, sqlite, migration

我正在尝试学习rails，但遇到了一些问题。

我有一个旧的 sqlite3 数据库，它有一个`Accounts`我之前用一些 GUI 程序制作的表。我想看看是否可以通过数据库迁移重新创建该表。

这是我之前的描述（我的目标）：

```
-- desired
CREATE TABLE "accounts" (
  "id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL DEFAULT (0),
  "username" TEXT NOT NULL COLLATE NOCASE,
  "password_hash" BLOB NOT NULL,
  "creation_time" INTEGER NOT NULL DEFAULT(strftime('%s', 'now')),
  "expiration_time" INTEGER NOT NULL DEFAULT(strftime('%s', 'now') + 2592000)
) 
```

我当前的迁移代码将无法正常工作。我在某个地方读到了可以`:options`用来指定 ActiveRecord 无法封装的东西的地方，但我可能做错了。当我使用`:default => Time.now.to_i`时，它只是硬编码了一些默认值；当我使用时`:default => "strftime('%s', 'now')"`，它根本不起作用。

```
class CreateAccounts < ActiveRecord::Migration
  def change
    create_table :accounts do |t|
      t.column 'username', :text, :null => false, :options => 'COLLATE NOCASE'
      t.column 'password_hash', :binary, :null => false
      t.column 'creation_time', :integer, :null => false, :options => "DEFAULT(strftime('%s', 'now'))"
      t.column 'expiration_time', :integer, :null => false, :options => "DEFAULT(strftime('%s', 'now') + 2592000)"
    end
  end
end 
```

我最终得到下表。看起来所有的`:option`值都被忽略了。

```
-- what i actually get
CREATE TABLE "accounts" (
  "id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL,
  "username" text NOT NULL,
  "password_hash" blob NOT NULL,
  "creation_time" integer NOT NULL,
  "expiration_time" integer NOT NULL
) 
```

创建列时如何指定 SQL 位？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:07:50.787

您可以做的最简单的事情就是执行原始 SQL 来定义表。这看起来像：

```
class CreateAccounts < ActiveRecord::Migration
  def up
    execute <<-SQL
    CREATE TABLE "accounts" (
      "id" INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL DEFAULT (0),
      "username" TEXT NOT NULL COLLATE NOCASE,
      "password_hash" BLOB NOT NULL,
      "creation_time" INTEGER NOT NULL DEFAULT(strftime('%s', 'now')),
      "expiration_time" INTEGER NOT NULL DEFAULT(strftime('%s', 'now') + 2592000)
    )
    SQL
  end

  def down
    remove_table :accounts
  end
end 
```

这样，您最终将得到与以前相同的表。我不完全确定您是否可以使用当前的迁移 DSL 来表达这样的表定义。不过，您应该能够验证它。如果您使用上述原始 SQL 进行迁移，则可以运行`rake db:migrate`. 这应该会生成一个新的`db/schema.rb`. 然后，您可以打开该文件并搜索帐户表并查看定义。如果所有内容都包含在内，您可以将该定义复制回迁移中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:07:48.733

默认设置为：

```
t.column :creation_time, :integer, :null => false, :default => "strftime('%s', 'now'))" 
```

collat​​e 和 nocase 无法通过 ruby​​ 完成，但可以使用 execute 方法运行原始 sql：

```
execute "ALTER TABLE accounts ADD COLUMN username TEXT NOT NULL COLLATE NOCASE AFTER id 
```

或者，您可以简单地将排序规则替换为：

```
class Account < ActiveRecord::Base
  def username=(username)
    write_attribute :username, username.downcase
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T14:26:58.647

您的迁移看起来不错。

既然您确实想真正学习 Rails，我会坚持使用它并尝试解决具体问题。

For rails, for created and updated date/time stamps what you do is create fields called updated_at and created_at (or _on for each) and then when rails uses active record to do a database table row update it will update those fields appropriately and automatically (or automagically as some would say).

This is a basic tenant of Rails - convention over configuration> Pick the right names and strictures and it will do the 'heavy-lifting' for you.

Your issue both using a default of now but it being hardcoded makes sense on reflection, but the above will address it

# ruby - “rvmsudo”的问题

> ID：14102437
> 
> 赞同：4
> 
> 时间：2012-12-31T13:54:18.687
> 
> 标签：ruby, rvm, thin

我正在使用运行 Ruby 1.9.3 的 RVM。当我尝试通过以下方式瘦身时：

```
rvmsudo thin start -p 90 
```

我得到：

```
sudo: thin: command not found 
```

我`gem list`告诉我我已经`thin (1.5.0)`安装了。此外，`rvmsudo which ruby`返回：

```
/home/ec2-user/.rvm/rubies/ruby-1.9.3-p327/bin/ruby 
```

但`rvmsudo ruby -v`返回：

```
ruby 1.8.7 (2012-10-12 patchlevel 371) [x86_64-linux] 
```

我不确定发生了什么。我主要关心的是运行`thin`，但我也很惊讶`which`返回 Ruby 1.9.3 但`ruby -v`返回 1.8.7。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:03:44.370

使用以下命令更新 RVM：

```
rvm get head 
```

这是一个错误：
[https ://github.com/wayneeseguin/rvm/issues/1337](https://github.com/wayneeseguin/rvm/issues/1337)

# html - 我可以使用哪种 CSS 选择器来选择具有多个类的元素？

> ID：14102442
> 
> 赞同：2
> 
> 时间：2012-12-31T13:54:39.423
> 
> 标签：html, css

我有以下 HTML：

```
<div class="block-content no-title grey-bg"> 
```

如何将此 div 的背景设置为 #333 的颜色？

是否有某种 CSS 选择器可用于仅选择具有 gray-bg 的块内容 div？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T13:56:29.703

你的问题有些奇怪。
这：

> 如何将此 div 的背景设置为 #333 的颜色？

表示您需要此选择器：（`[.grey-bg][.no-title][.block-content]`使用方括号中的一个或多个部分）。
这：

> 是否有某种 CSS 选择器可用于仅选择具有 gray-bg 的块内容 div？

表示你想要这个：`.grey-bg.block-content`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:11:24.393

在 css 中，选择器之间的空格（或缺少空格）表示后代或相同的 dom 对象，即

```
<span class="a b">
    <span class="c"></span>
    <span class="b"></span>
</span> 
```

//一些css选择器示例

```
.a.b{} //gets the first span (get all elements which have class .a and .b)
.a .b{} //gets the third (nested in a.b after .c - get all .b that are descendants of .a)
.b{}   //gets the first and third (get all .b)
.b>.b{} //gets the third (get all direct descendants of .b which are .b)
.b>.c+.b{} //gets the third (next sibling .b of a .c which is direct descendant of a .b) 
```

# php - 选择要从源上传的文件

> ID：14102443
> 
> 赞同：0
> 
> 时间：2012-12-31T13:54:43.520
> 
> 标签：php

在网页上，用户可以选择要上传的文件，然后如果他提交表单，他将被定向到具有类似但更大表单的下一个网页。表单元素填充了他在最后一页输入的数据

第一页.html

```
<form name="MyForm" action="nextpage.php" enctype="multipart/form-data" method="post">
       <input type="text" name="name" size="50">
    <input type="file" name="file" id="file" size="40">
</form> 
```

nextpage.php（部分形式，两个元素相同）

```
<form name="MyForm" action="thirdpage.php" enctype="multipart/form-data" method="post">
       <input type="text" name="name" size="50"  value="<?php echo $name?>">
    <input type="file" name="file" id="file" size="40">
</form> 
```

是否可以在文件上传元素中预选文件？如果他在 firstpage.html 上的 name 元素中键入他的名字，那么在 nextpage.php 上的名字将填充相同的元素。但是如果他在firstpage.html上选择了一个文件，是不是他不需要在nextpage.php上再次选择呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T13:56:58.897

这是不可能的，出于安全原因。

如果文件已经上传，应该有关于它的信息，可以删除它并上传新的东西。

# asp.net - 我可以在共享主机中使用 Roslyn CTP 吗？

> ID：14102448
> 
> 赞同：1
> 
> 时间：2012-12-31T13:55:24.327
> 
> 标签：asp.net, roslyn

我想知道是否可以使用 Roslyn 的一些很酷的功能，例如在共享主机中托管的 ASP.NET 应用程序中的动态编译。那可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:42:08.793

应该工作得很好。您可能想查看[compilify.net](https://compilify.net/)以及他们在做什么，因为它由 Roslyn 提供支持。

# google-maps - 谷歌地图按物业地址显示多个项目

> ID：14102452
> 
> 赞同：1
> 
> 时间：2012-12-31T13:55:50.693
> 
> 标签：google-maps

> **可能重复：**
> [Google Map V3：仅显示一些标记](https://stackoverflow.com/questions/10062624/google-map-v3-only-some-markers-are-displayed)

我需要谷歌地图的帮助。我有以下代码使用地图上显示的 1 个属性，但我有许多地址/属性可以在同一张地图上显示它们并且没有成功。

```
var address = "<?php echo $address?>";
       var map = new google.maps.Map(document.getElementById('map'), {
           mapTypeId: google.maps.MapTypeId.ROADMAP,
           zoom: 16
       });
       var geocoder = new google.maps.Geocoder();
       geocoder.geocode({
          'address': address
       }, 
       function(results, status) {
          if(status == google.maps.GeocoderStatus.OK) {
             new google.maps.Marker({
                position: results[0].geometry.location,
                map: map
             });
             map.setCenter(results[0].geometry.location);
          }
       }); 
```

从 php 我得到了地址，但 JS 端脚本对我来说很难。请帮助并告诉我需要更改的内容，以便将地址设置为 JS 数组以及如何显示所有地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:18:05.903

我猜你正在寻找一个简单的 Javascript`for`循环在你的数组上，所以这应该是这样的（假设`address`是一个有效的 Javascript 数组）：

```
// address = ... //define address array here

var map = new google.maps.Map(document.getElementById('map'), {
       mapTypeId: google.maps.MapTypeId.ROADMAP,
       zoom: 16
   });
var geocoder = new google.maps.Geocoder();

var nbAddresses = address.length;

for (var i=0;i<nbAddresses;i++)
{ 

  geocoder.geocode({
          'address': address[i]
   }, 
   function(results, status) {
      if(status == google.maps.GeocoderStatus.OK) {
         new google.maps.Marker({
            position: results[0].geometry.location,
            map: map
         });
         map.setCenter(results[0].geometry.location);
      }
   });

} 
```

*编辑：请注意，此代码片段可以进行优化，这只是满足您需求的一种快速方法（没有双关语）；）*

# javascript - 在声纳中显示 jsHint 和 cssLint 结果

> ID：14102455
> 
> 赞同：8
> 
> 时间：2012-12-31T13:56:16.823
> 
> 标签：javascript, sonarqube, checkstyle, jshint, csslint

jsHint 和 cssLint 可以将它们的结果输出到标准 xml（sjlint.xml 和 csslint.xml 格式）文件。

有没有办法用声纳显示这些结果？

我要做的是运行一个 jenkins 作业，它将在 java 脚本上运行验证并在 Sonar 中显示结果。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:55:14.963

我认为您需要开发一个新的声纳插件。查看以下可能对您有所帮助的链接。

*   [http://docs.codehaus.org/display/SONAR/Developing+Plugins](http://docs.codehaus.org/display/SONAR/Developing+Plugins)
*   [http://docs.codehaus.org/display/SONAR/Plugin+hosting](http://docs.codehaus.org/display/SONAR/Plugin+hosting)

挖掘了一下，我发现这个关闭的声纳问题表明声纳的[Javascript 插件](http://docs.codehaus.org/display/SONAR/JavaScript+Plugin)比 jsLint 工作得更好：

*   [声纳插件-1829](http://jira.codehaus.org/browse/SONARPLUGINS-1829)

# bash - 通配符 bash 不起作用

> ID：14102457
> 
> 赞同：0
> 
> 时间：2012-12-31T13:56:32.893
> 
> 标签：bash, shell

我正在尝试做一个案例陈述，并且我正在使用以下通配符来区分参数之间的差异：

这是针对单个 IP 的：

```
case $1 in
//the argument is a single IP    
*.*.*.0|1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31`|32|33|34|35|36|37|38|39|40|41|42|43|44|45|46|47|48|49|50|51|52|53|54|55|56|57|58|59|60|61|62|63|64|65|66|67|68|69|70|71|72|73|74|75|76|77|78|79|80|81|82|83|84|85|86|87|88|89|90|91|92|93|94|95|96|97|98|99|100|101|102|103|104|105|106|107|108|109|110|111|112|113|114|115|116|117|118|119|120|121|122|123|124|125|126|127|128|129|130|131|132|133|134|135|136|137|138|139|140|141|142|143|144|145|146|147|148|149|150|151|152|153|154|155|156|157|158|159|160|161|162|163|164|165|166|167|168|169|170|171|172|173|174|175|176|177|178|179|180|181|182|183|184|185|186|187|188|189|190|191|192|193|194|195|196|197|198|199|200|201|202|203|204|205|206|207|208|209|210|211|212|213|214|215|216|217|218|219|220|221|222|223|224|225|226|227|228|229|230|231|232|233|234|235|236|237|238|239|240|241|242|243|244|245|246|247|248|249|250|251|252|253|254|255 )

        ....`
//the argument is a IP range

    `*.*.*.*-*.*.*.* )

    ....` 
```

即使这样，它似乎也不起作用，我做错了什么？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:04:19.667

对于单个 IP，您已经定义了这些替代方案

*   `*.*.*.0`
*   `1`
*   `2`
*   ...

而*不是*

*   `*.*.*.0`
*   `*.*.*.1`
*   `*.*.*.2`
*   ...

此处使用的模式类型称为[`glob`](http://en.wikipedia.org/wiki/Glob_%28programming%29).

如果你真的想把它拼出来，你必须说

```
*.*.*.0|*.*.*.1|*.*.*.2|...) 
```

当您希望最多包含三个字符时，您也可以指定它

```
*.*.*.?|*.*.*.??|*.*.*.???) 
```

或最多三位数字

```
*.*.*.[0-9]|*.*.*.[0-9][0-9]|*.*.*.[0-9][0-9][0-9]) 
```

但这`127.1.3.843`也允许。

如果你有

```
case "$arg" in
single-IP) ... ;;
IP-range) ... ;;
esac 
```

它将首先测试始终匹配的单 IP。要同时匹配范围，您必须首先列出 IP 范围的模式

```
case "$arg" in
IP-range) ... ;;
single-IP) ... ;;
esac 
```

然后它首先测试 IP 范围的情况，并且仅当它与单个 IP 模式的测试不匹配时。

有关简化测试，请参阅

```
case "$1" in
*.*.*.*-*.*.*.*) echo range ;;
*.*.*.*) echo single ;;
*) echo else ;;
esac 
```

这给了

```
$ sh /tmp/a.sh 1.2.3.4
single
$ sh /tmp/a.sh 1.2.3.4-5.6.7.8
range
$ sh /tmp/a.sh 1.2.3
else 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:01:47.573

也许这个小循环可以帮助你：

```
#!/bin/bash

shopt -s extglob

is_a_byte() {
    local i
    for i do
       [[ "$i" = +([[:digit:]]) ]] && ((10#$i<=255)) || return 1 
    done
}

is_ip() {
    local ipn
    read -a ipn <<< "${1//./ }"
    if [[ "${#ipn[@]}" = 4 ]] && is_a_byte "${ipn[@]}"; then
       [[ "$2" ]] && printf -v "$2" "%s" $(( ((((((10#${ipn[0]}<<8)|10#${ipn[1]})<<8)|10#${ipn[2]})<<8)|10#${ipn[3]}) ))
       return 0
    else
       return 1
    fi
}

while IFS=- read -e -r -p "Enter an IP or an IP range: " -a ip; do
   if [[ -z ${ip[1]} ]]; then
      if is_ip "${ip[0]}" N; then
         echo "Valid IP ---> $N"
      else
         echo "${ip[0]} is not a valid IP"
      fi
   else
      if is_ip "${ip[0]}" N[0] && is_ip "${ip[1]}" N[1]; then
         ((N[0]>N[1])) && N=( "${N[1]}" "${N[0]}" )
         echo "Valid IP range ---> ${N[0]}-${N[1]}"
      else
         echo "${ip[0]}-${ip[1]} is not a valid IP range"
      fi
   fi
done 
```

没有 grep，没有 subshel​​l，只有纯 bash，而且它比笨拙的 glob/regex 更健壮，我会说它相当优雅`;-)`。

# hibernate - Hibernate 继承 Single_table

> ID：14102459
> 
> 赞同：1
> 
> 时间：2012-12-31T13:56:43.187
> 
> 标签：hibernate, inheritance

我已经设置了我的课程，如下所示。Hibernate ddl 生成 2 个表 Admin 和 Customer。根据 SINGLE_TABLE 策略，我预计只有一个表。

```
@MappedSuperclass
public abstract class BaseUser{
...
}

@Entity
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
public class Admin extends BaseUser{
...
}

@Entity
@Inheritance(strategy=InheritanceType.SINGLE_TABLE)
public class Customer extends BaseUser{
@OneToMany
private List<Order> orders;
...
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:11:10.507

不，单表继承的工作方式不同。继承策略需要在超类上定义。请参阅[JPA Wikibook](http://en.wikibooks.org/wiki/Java_Persistence/Inheritance#Example_single_table_inheritance_table)以供参考。

```
@Entity
@Inheritance
@DiscriminatorColumn(name="USER_TYPE")
@Table(name="USER")
public abstract class BaseUser{
...
}

@Entity
@DiscriminatorValue("A")
public class Admin extends BaseUser{
...
}

@Entity
@DiscriminatorValue("C")
public class Customer extends BaseUser{
@OneToMany
private List<Order> orders;
...
} 
```

请注意，根据您的数据库，您可能会或可能不会被允许调用您的表`USER`。还有一个[如何使用 @MappedSuperclass 的示例](http://en.wikibooks.org/wiki/Java_Persistence/Inheritance#Example_mapped_superclass_tables)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-31T15:17:37.967

尽管不确定为什么 @MappedSuperclass 不起作用，但这似乎仍然有效。

```
@Entity
@Inheritance
public abstract class BaseUser{
...
}

@Entity
public class Admin extends BaseUser{
...
}

@Entity
public class Customer extends BaseUser{
@OneToMany
private List<Order> orders;
...
} 
```

# iphone - 在创建指向对象的指针后删除对象 [Objective-C]

> ID：14102460
> 
> 赞同：3
> 
> 时间：2012-12-31T13:56:50.053
> 
> 标签：iphone, objective-c, ios

> **可能重复：**
> [NSMutableArray 中的 lastObject 是否返回对象的副本？](https://stackoverflow.com/questions/9354215/does-lastobject-in-nsmutablearray-return-a-copy-of-the-object)

我正在学习有关 iOS 开发的斯坦福课程，但我对此表示怀疑。问题是我有一个带有“操作数”（NSNumbers）的数组（operandStack），我想要一个弹出最后一个元素然后从数组中删除它的函数。这就是教程所说的（并且有效）：

```
- (double)popOperand
{
    NSNumber *operand = [self.operandStack lastObject];
    if(operand) [self.operandStack removeLastObject];
    return [operand doubleValue];
} 
```

我的问题是：如果使用 NSNumber *operand 我们只是“指向”最后一个对象，并且在下一行中我们删除了最后一个对象，那么我们怎么可能返回它？我的意思是，如果我们删除最后一个对象并且操作数只是指向该对象，那么操作数应该不指向任何内容，所以我不明白我们怎么可能返回操作数......我会理解代码如果操作数是数组最后一个对象的副本，但事实并非如此......

对不起我的英语：SI希望我说清楚了。

谢谢，

卡洛斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:43:38.587

该`removeLastObject`方法从数组中删除一个对象，而不是从内存中。在从数组中删除对象之前，将其分配给局部变量。使用 ARC 编译时，指向对象的局部变量具有隐式的生命周期限定符`__strong`.

由于您在将对象从数组中删除之前添加了对对象的强引用，因此您的方法会暂时获得它的所有权。即使方法返回对象本身而不是其值，这仍然可以正常工作，因为 ARC 会在方法末尾插入`autorelease`调用而不是 a 。`release`

# ruby-on-rails - cancan和devise的配置

> ID：14102464
> 
> 赞同：0
> 
> 时间：2012-12-31T13:57:12.627
> 
> 标签：ruby-on-rails, devise, cancan

我使用本教程：

[http://www.roberthuberdeau.com/articles/9-Blog-tutorial-part-3](http://www.roberthuberdeau.com/articles/9-Blog-tutorial-part-3)

我不明白如何执行这些步骤：

> 我们只创建了一个角色模型。我们有两个选择——完成角色类的脚手架或使用命令控制台创建角色。我选择了后者，因为我可以通过命令行访问我的生产环境。我按照这个确切的顺序创建了以下角色，管理员、版主和作者。当我们设置默认用户角色时，这将很重要。

我想做第二个选项：

我不知道如何使用命令控制台创建角色。我想创建以下角色：管理员和工人按这个确切的顺序。

有人可以给我写命令吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:01:18.890

从外壳运行`bundle exec rails console`。这将打开一个加载了 Rails 环境的 IRB 终端，您将可以访问以下方法：`Role.create({name: "Admin"})`

# algorithm - 如果叶子从左到右的顺序是固定的，那么有多少二叉树？

> ID：14102465
> 
> 赞同：3
> 
> 时间：2012-12-31T13:57:12.753
> 
> 标签：algorithm, binary-tree, catalan

让我们通过列表来表示树。

如果叶子的数量是两个，A 和 B。那么只有一棵树 (AB)。

如果叶子的数量是三，A，B和C。那么有两棵树（（AB）C）和（A（BC））。

那么如果有 N 片叶子，那么有多少棵树呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T16:43:55.997

`N`设有叶子的二叉树的数目为`T(N)`。

可以立即看出，我们有`T(1) = T(2) = 1`，因为`N > 2`我们可以在根部进行分裂，从而获得两个叶子较少的子树。`N`或者，等价地，我们可以从两个非空二叉树中分别组装一棵带有叶子`k`的二叉树`N-k`。两个子树都不为空的条件转换为`1 <= k <= N-1`。所以我们有递归

```
 N-1
T(N) = ∑  T(k) * T(N-k)
      k=1 
```

如果递归还不知道，计算前几个值并不难

```
1,1,2,5,14,42,132,429,1430,4862,16796 
```

并谷歌他们。人们发现这些是[加泰罗尼亚数字](http://en.wikipedia.org/wiki/Catalan_number)，

```
C(n) = (2*n)! / (n! * (n+1)!) 
```

偏移一，所以

```
T(N) = C(N-1) 
```

它的计算速度比递归快得多。

# android - android市场中自动安装android应用程序（如Plan B App）的代码？

> ID：14102469
> 
> 赞同：-3
> 
> 时间：2012-12-31T13:57:34.013
> 
> 标签：android, installation

我们开发了一个应用程序，我们希望将其自动安装在用户的 Android 手机上，就像 B 计划应用程序一样，即使手机丢失并帮助恢复它，它也会安装应用程序。

任何帮助编写代码表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:19:31.407

> 我们希望将其自动安装在用户的 Android 手机上，就像 Plan B App 一样，即使手机丢失，它也会安装该应用程序并帮助恢复它

B计划不这样做。

首先，Plan B 不会“手机丢了也安装应用”。这是不可能的。如果用户丢失了他们的设备*并且*他们的设备上仍然配置了他们的 Google 帐户，则*用户*可以进入网络上的 Play 商店并仍然在他们现在丢失的设备上安装应用程序。作为开发人员，您不参与此过程。

B计划过去能够做的是在一段时间后自动获得控制权，无需用户干预。幸运的是，这在 Android 3.1 中不再可行，因为它是恶意软件作者中流行的技术。

# vb.net - 绑定源过滤

> ID：14102474
> 
> 赞同：4
> 
> 时间：2012-12-31T13:58:15.510
> 
> 标签：vb.net, datagridview, filter, bindingsource

希望你能帮我解决这个问题。

我想`datagridview`通过使用某个关键字（例如名称）来过滤我的。我使用了一个数据集，然后将其绑定到数据源，然后绑定到我的数据源以`datagridview`供查看。

当我使用时，`bindingsource.filter`我无法得到任何结果。

这是我的代码：

```
 Dim ds As New DataSet
    Dim bs As New BindingSource

    Dim sql As String = "SELECT TOP 10 * FROM dbo.DimCustomer"
    Dim connection As New SqlConnection(sqlconnectionstring)
    Dim dataadapter As New SqlDataAdapter(sql, connection)

    connection.Open()
    ds.Clear()
    dataadapter.Fill(ds, "Customer")
    connection.Close()

    bs.DataSource = ds

    dgv1.DataSource = bs
    dgv1.DataMember = "Customer"
    bs.Filter = "FirstName = 'Jon'" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-01T14:53:54.007

谢谢你们的帮助，但我得到了它使用以下代码：

```
Dim sql As String = "select * from HumanResources.vEmployee"
Dim connection As New SqlConnection(sqlconnectionstring)
Dim dataadapter As New SqlDataAdapter(sql, connection)
Dim dsView As New DataView()

Try
  connection.Open()
  ds.Clear()
  dataadapter.Fill(ds, "test")
  dsView = ds.Tables(0).DefaultView
  bs.DataSource = dsView
  dgv1.DataSource = bs
  bs.Filter = "FirstName like 'J%'"
Catch ex As Exception
  MessageBox.Show("Error while connecting to SQL Server." & ex.Message)
Finally
  connection.Close()
End Try 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T20:29:19.810

我的名字是穆罕默德·霍斯尼

您的代码很好，没有错误，但我需要您进行一些更改 首先：将表名添加到数据集 bs.DataSource = ds.Tables["DimCustomer"] 第二：我认为过滤器行必须在分配之前绑定源到 datagridview

bs.Filter = "FirstName = 'Jon'" dgv1.DataSource = bs

另外我认为您不需要 dgv1.DataMember = "Customer" 这一行

试试这个，如果这不起作用，我会给你完整的代码，但是通过 c# 我之前做了很多次。

在 www.hcsmedia.org 或 www.hosysys.com 上找到我

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:06:19.543

我认为问题在于您的绑定源应该指向数据视图而不是数据集。这是 MSDN 站点的链接，其中包含更多[解释](http://msdn.microsoft.com/en-us/library/system.windows.forms.bindingsource.filter%28v=vs.100%29.aspx)。这里还有关于[Dataview](http://msdn.microsoft.com/en-us/library/system.data.dataview%28v=vs.100%29.aspx)的更多信息。

我还没有时间测试这个，但我相信它在逻辑上是正确的。你能试试这个吗？

```
 dim dsView as new DataView(ds.Tables("Customer"))

   bs.DataSource = dsView
   dgv1.DataSource = bs
   dgv1.DataMember = "Customer"
   bs.Filter = "FirstName = 'Jon'" 
```

# c# - 如何在 Visual Studio 2012 中创建安装文件

> ID：14102483
> 
> 赞同：0
> 
> 时间：2012-12-31T13:58:41.640
> 
> 标签：c#, visual-studio-2012, wix

我正在编写一个小项目，这是我的作业，是关于学校的。我在 Visual Studio 2012 中编码，它不支持创建设置文件。我使用 Wix 创建设置文件，但它不包括我的数据库。当我创建成功的设置文件并单击设置文件进行设置时，只需创建 1 个文件 .exe，就像 ../Debug/ 中的文件一样。我不知道如何创建包含我的数据库的安装文件。有谁能够帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:11:26.733

我认为您想创建一个 Windows 安装程序，其中包括您的数据库（如果是精简版或任何其他非服务器数据库）和您的可执行程序（位于 /Debug 文件夹中的程序）。您必须阅读文档才能了解如何在安装程序中包含文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:07:59.230

> 我在 Visual Studio 2012 中编码，它不支持创建设置文件。

猜猜看 - 感谢天堂。那些项目一开始就很糟糕，没有通过验证。

> 我使用 Wix 创建设置文件，但它不包括我的数据库

不，您不包括您的数据库。WIX 不在乎。

> 我不知道如何创建包含我的数据库的安装文件。有谁能够帮我？

是的。WIX 有文档。重点是，什么数据库。SQL Server - 制作另一个刻录项目，如果需要，预安装 SQL Server。然后使用 WIX 中的 SQL 机制（例如[http://wix.sourceforge.net/manual-wix2/wix_xsd_sqldatabase.htm](http://wix.sourceforge.net/manual-wix2/wix_xsd_sqldatabase.htm)）来创建数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:11:16.483

创建安装文件的另一个选项是[Excelsior Installer](http://installer.excelsior-usa.com/en/)。它是一个免费工具，可能比 Wix 更容易。您可以定义安装中应包含哪些文件。

# objective-c - SBJSON 失败，包含二进制数据的 json

> ID：14102485
> 
> 赞同：1
> 
> 时间：2012-12-31T13:59:05.840
> 
> 标签：objective-c, ios, json, sbjson

我正在使用 Web 服务并使用 sbjson 解析接收到的数据，如下所示：

```
NSDictionary *response = [[[NSString alloc]initWithData:data encoding:NSUTF8StringEncoding]JSONValue]; 
```

它运行良好，但使用包含二进制数据（应用程序/pdf）的 json 失败，我在控制台中得到了这个：

```
-JSONValue failed. Error trace is: (
    "Error Domain=org.brautaset.JSON.ErrorDomain Code=6 \"Invalid high character in surrogate pair\" UserInfo=0x1e0e1700 {NSLocalizedDescription=Invalid high character in surrogate pair}",
    "Error Domain=org.brautaset.JSON.ErrorDomain Code=6 \"Broken unicode character\" UserInfo=0x1e0e1740 {NSUnderlyingError=0x1e0e1720 \"Invalid high character in surrogate pair\", NSLocalizedDescription=Broken unicode character}",
    "Error Domain=org.brautaset.JSON.ErrorDomain Code=3 \"Expected value while parsing array\" UserInfo=0x1e0e1780 {NSUnderlyingError=0x1e0e1760 \"Broken unicode character\", NSLocalizedDescription=Expected value while parsing array}",
    "Error Domain=org.brautaset.JSON.ErrorDomain Code=3 \"Object value expected for key: content\" UserInfo=0x1e0e17c0 {NSUnderlyingError=0x1e0e17a0 \"Expected value while parsing array\", NSLocalizedDescription=Object value expected for key: content}",
    "Error Domain=org.brautaset.JSON.ErrorDomain Code=3 \"Object value expected for key: params\" UserInfo=0x1e0e1800 {NSUnderlyingError=0x1e0e17e0 \"Object value expected for key: content\", NSLocalizedDescription=Object value expected for key: params}",
    "Error Domain=org.brautaset.JSON.ErrorDomain Code=3 \"Object value expected for key: request\" UserInfo=0x1e0e18d0 {NSUnderlyingError=0x1e0e1890 \"Object value expected for key: params\", NSLocalizedDescription=Object value expected for key: request}"
)

*** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '*** -[__NSPlaceholderDictionary initWithObjects:forKeys:count:]: attempt to insert nil object from objects[0]'
*** First throw call stack:
(0x3397d2a3 0x3314f97f 0x338ce55f 0x339050d3 0x576c1 0x5c631 0x5d9bf 0x389a7ef5 0x388e79f1 0x388e790d 0x36bf65df 0x36bf5ccb 0x36c1e133 0x338c374d 0x36c1e593 0x36b8215d 0x33952683 0x33951ee9 0x33950cb7 0x338c3ebd 0x338c3d49 0x3462c2eb 0x36509301 0x46ab9 0x38548b20)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

现在我想知道如何在不移动到另一个 json 库的情况下解决它。还有其他人曾经处理过包括二进制在内的json吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:06:19.530

来自：[json.org](http://www.json.org) “JSON 是一种文本格式”。Base64 对二进制数据进行编码。

请参阅[SO 问题](https://stackoverflow.com/questions/1443158)“JSON 字符串中的二进制数据”

# vba - 是否可以给出特定行使用的最大列数

> ID：14102495
> 
> 赞同：0
> 
> 时间：2012-12-31T14:00:09.720
> 
> 标签：vba, excel, vbscript

我有一个如下的 Excel 矩阵：

```
PID#      T1    T2   T3    T4    T5   T6    T7

11        1                1      
14        1     1          1     
21                   1     1     
41        1          1     1     1
71                   1     
88        1          1           1 
```

`PID#`只不过是进程，所有的进程都是由多个任务组成的。但并非所有进程都应该使用所有`T1 - T5`任务。在这种情况下，可以获得`PID#`使用的最大任务。`1`用于表示某项任务是否已被使用。这里 PID# 41 和 88 使用的最大任务说是`5`。我只需要最大使用的列数和使用该列数的任何行#。

***笔记***

这里我习惯`1`说有数据，但实际上有不同类型的数据。我需要找出哪一行使用了最大列。但是如果一行的任何单元格`blank`在左侧，则应该在计数中。比如说——

<> 1 <> 1 给出的计数为 4

<> <> 1 <> 将计数为 3

1 1 <> 将计数为 2 ' 在这里我用来`<>`表示`no values`

**编辑**

```
Option Explicit

Dim ArrayListTaskDetails : Set ArrayListTaskDetails = CreateObject("System.Collections.ArrayList")
Dim i,colcount

i=2
Do while i < = objExcel1.Application.WorksheetFunction.CountA(ob.Rows(1))

colcount=objExcel1.Application.WorksheetFunction.CountA(ob.Rows(i))
ArrayListTaskDetails.Add(colcount)

i=i+1
Loop

ArrayListTaskDetails.Sort()
i=ArrayListTaskDetails.Count
MsgBox("HighestColumnNumner:" & ArrayListTaskDetails(i-1)) 
```

***问题：***

*我无法计算没有连续值的行的空白列。因此计数不是由我正确产生的。*

***编辑1***

这里的问题仍然是我无法计算左边的空白单元格（如果有的话），因为这些也被视为已使用的列，其中其他行可以有值。因此需要找出最右边的已使用的列一行，之后没有任何行使用任何列。希望我能够清楚我在寻找什么：

```
Option Explicit

Dim objExcel1
Dim strPathExcel1
Dim objSheet1,objWB,ColCount
Dim ArrayListTaskDetails : Set ArrayListTaskDetails = CreateObject("System.Collections.ArrayList")

Set objExcel1 = CreateObject("Excel.Application")
strPathExcel1 = "D:\AravoVB\.xlsx"
Set objWB = objExcel1.Workbooks.open(strPathExcel1)

Set objSheet1 = objExcel1.ActiveWorkbook.Worksheets(1)

Do Untill count > objExcel1.Application.WorksheetFunction.CountA(objSheet1.Rows(1)) 

Range = objSheet1.("count:count")
ColCount=objExcel1.Application.WorksheetFunction.CountIf(Range,<> "")
ArrayListTaskDetails.Add(ColCount)

Loop

ArrayListTaskDetails.Sort()
MsgBox(ArrayListTaskDetails(ArrayListTaskDetails.Count - 1)) 
```

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T07:39:40.953

仍然不相信为什么 Vikas 的答案对你不起作用。请尝试此代码。它突出显示最后一个最大值。唯一的缺陷是它没有跟踪所有`PID`具有相同最大值的东西。如果您也需要，我可以改进代码。

代码：

```
Option Explicit

Sub getRealUsedColumns()
Dim rngInput As Range
Dim arrInput As Variant, arrRowTotal As Variant
Dim i As Integer, j As Integer, counter As Integer, iTemp  As Integer
Dim iPID As Integer, maxRowNum As Integer

    arrInput = Application.WorksheetFunction.Transpose(Sheets(3).Range("B3:I8").Value2)
    ReDim arrRowTotal(LBound(arrInput, 2) To UBound(arrInput, 2))

    For i = LBound(arrInput, 2) To UBound(arrInput, 2)
        counter = 0
        For j = LBound(arrInput) + 1 To UBound(arrInput)
            If arrInput(j, i) <> "" Or Not IsEmpty(arrInput(j, i)) Then
                counter = counter + 1
            End If
        Next j

        '-- most recent max value (if you have two of the same, this doens't catch)
        '-- you need to save in a proper array to catch multiple PIDs with same max value
        If iTemp <= counter Then
            iTemp = counter
            iPID = arrInput(1, i)
            maxRowNum = i
        End If

        arrRowTotal(i) = counter
    Next i

    '-- Row total into the sheet output
    Sheets(3).Range("J3").Resize(UBound(arrRowTotal)) = _
                     Application.WorksheetFunction.Transpose(arrRowTotal)

    '-- highlight the max total row.
    With Sheets(3).Range("B3").Offset(maxRowNum - 1, 0).Resize(1, UBound(arrInput, 1) + 1)
        .Interior.Color = 200
    End With

End Sub 
```

结果：

![在此处输入图像描述](../Images/3a23486ffeed90442aaff206a0392fbc.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T17:37:39.257

Excel 在计算矩阵方面非常强大。我会使用 Excel 公式而不是代码来计算它。我将在右侧添加一列，它将添加一个进程使用的任务总数，如下面的矩阵所示。

```
    ABCDEFG
1 PID T1 T2 T3 T4 T5 总计
2 #11 1 1
3 #14 1 1 1 3
4 #21 1 1 1 1 1 5
5 #41 1 1 2

```

然后我将编写两个[数组公式](http://www.cpearson.com/excel/arrayformulas.aspx)来计算一个进程使用的最大任务数和该进程的名称。

计算示例中使用的最大任务的公式：=SUM(IF($G$2:$G$5=MAX($G$2:$G$5),G2:G5,0))

找到使用最多任务的价格的公式： =OFFSET(A1,SUM(IF($G$2:$G$5=MAX($G$2:$G$5),ROW(G2:G5)-1,0) ),0,1,1)

请注意，我曾提到我使用了数组公式。为了在 Excel 中添加数组公式，您需要输入公式，然后按“Ctrl+Shift+Enter”使该公式成为数组公式。

希望这可以帮助。维卡斯 B

> - - - - - - - - -编辑 - - - - - - - - - - - - - - - - ---------------------

在此处添加代码。我刚刚使用了示例，如矩阵所示并产生了正确的结果。

```
 Sub FindMax()

'assuming column 1 is the task ID and Row one has the headings.

Const LastColumn As Integer = 7 ' you can use xl end to get the last used column in the range
Const LastRow As Integer = 5

Dim rowCounter As Integer
Dim prevValue As Integer
Dim rngToTotal As Range
Dim sht As Worksheet
Dim maxRowName As String
Dim value As Integer
Dim maxValue As Integer

Set sht = ActiveSheet 

For rowCounter = 2 To LastRow
    Set rngToTotal = sht.Range(sht.Cells(rowCounter, 2), sht.Cells(rowCounter, LastColumn))
    value = WorksheetFunction.Sum(rngToTotal)

    If value > prevValue Then
        maxRowName = sht.Cells(rowCounter, 1).value
        maxValue = value
    End If
    prevValue = value
Next rowCounter

MsgBox "Process name " & maxRowName & "  =  " & maxValue

End Sub 
```

# android - 如果我的应用程序只需要一次购买项目，我是否需要使用消费一次购买？

> ID：14102496
> 
> 赞同：5
> 
> 时间：2012-12-31T14:00:15.973
> 
> 标签：android, in-app-purchase

我在我的应用程序中使用第 3 版 API 进行应用内购买。我很困惑我应该打电话

```
mHelper.consumeAsync(inventory.getPurchase(SKU_GAS), 
   mConsumeFinishedListener); 
```

如果我的应用程序只需要一次购买我的应用内产品，则上述方法。

在 In App purchase API 3 的演示示例中，他们正在为以下侦听器调用 consumeAsync，那么为什么他们要调用 consumeAsync ？

1.QueryInventoryFinishedListener 当您的产品 id 已购买。

2.OnIabPurchaseFinishedListener 当您的产品购买成功时。

请解释我何时使用 consumeAyncs 方法进行应用内购买。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-13T15:27:43.157

应用内购买版本 3 仅支持托管产品。当应用程序想要实现非托管产品以便最终用户可以在需要时再次购买相同的产品时，应用程序需要消耗先前购买的产品以使其可以再次购买。根据您的应用程序要求，您的产品类型是托管的。这意味着您根本不需要调用 consumeAsync。因为在这种情况下，如果设备执行出厂重置操作，您可以将产品恢复到最终用户设备。

# android - 如何在与 Android 一起使用的 FFmpeg 库中添加更多编解码器支持？

> ID：14102497
> 
> 赞同：1
> 
> 时间：2012-12-31T14:00:16.400
> 
> 标签：android, android-ndk, ffmpeg

我想在我的 Android 应用程序中使用 ffmpeg 库来播放 .ts 视频文件格式。我正在尝试运行[GitHub Appunite](https://github.com/appunite/AndroidFFmpeg)提供的示例应用程序。

到目前为止，我已经设法编译 ffmpeg 库并构建 .so 文件。我正在使用 Ubuntu 10.10 并使用 NDK r8。

示例应用程序运行良好，可以播放 .mp4 和 .3gp 等文件格式，但不能播放 .FLV 和 .ts 文件（这是我的要求）。

每当我尝试播放 .ts 或 .FLV 文件时，它都会显示“无法打开流”

在 Logcat 中它显示

```
E/player.c(28005): player_set_data_source Could not open video file: file:///mnt/sdcard/football.ts (-1094995529: Invalid data found when processing input) 
```

我正在尝试这个几周。到目前为止我还没有任何办法。请帮忙

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T10:07:44.753

问题出在某些`ts`文件上，但某些`ts`文件工作正常。文件之间可能存在属性差异`ts`。

# r - 合并数据帧，不同的长度

> ID：14102498
> 
> 赞同：17
> 
> 时间：2012-12-31T14:00:17.527
> 
> 标签：r, merge

我想从以下位置添加变量`dat2`：

```
 concreteness familiarity typicality
amoeba            3.60        1.30       1.71
bacterium         3.82        3.48       2.13
leech             5.71        1.83       4.50 
```

至`dat1`：

```
 ID  variable value
1    1    amoeba     0
2    2    amoeba     0
3    3    amoeba    NA
251  1 bacterium     0
252  2 bacterium     0
253  3 bacterium     0
501  1     leech     1
502  2     leech     1
503  3     leech     0 
```

给出以下输出：

```
 X ID  variable value concreteness familiarity typicality
1   1  1    amoeba     0         3.60        1.30       1.71
2   2  2    amoeba     0         3.60        1.30       1.71
3   3  3    amoeba    NA         3.60        1.30       1.71
4 251  1 bacterium     0         3.82        3.48       2.13
5 252  2 bacterium     0         3.82        3.48       2.13
6 253  3 bacterium     0         3.82        3.48       2.13
7 501  1     leech     1         5.71        1.83       4.50
8 502  2     leech     1         5.71        1.83       4.50
9 503  3     leech     0         5.71        1.83       4.50 
```

如您所见，来自的信息`dat1`必须在`dat2`.

这是我失败的尝试：

```
dat3 <- merge(dat1, dat2, by=intersect(dat1$variable(dat1), dat2$row.names(dat2))) 
```

给出以下错误：

```
Error in as.vector(y) : attempt to apply non-function 
```

请在此处找到复制示例：

数据1：

```
structure(list(ID = c(1L, 2L, 3L, 1L, 2L, 3L, 1L, 2L, 3L), variable = structure(c(1L, 
1L, 1L, 2L, 2L, 2L, 3L, 3L, 3L), .Label = c("amoeba", "bacterium", 
"leech", "centipede", "lizard", "tapeworm", "head lice", "maggot", 
"ant", "moth", "mosquito", "earthworm", "caterpillar", "scorpion", 
"snail", "spider", "grasshopper", "dust mite", "tarantula", "termite", 
"bat", "wasp", "silkworm"), class = "factor"), value = c(0L, 
0L, NA, 0L, 0L, 0L, 1L, 1L, 0L)), .Names = c("ID", "variable", 
"value"), row.names = c(1L, 2L, 3L, 251L, 252L, 253L, 501L, 502L, 
503L), class = "data.frame") 
```

数据2：

```
structure(list(concreteness = c(3.6, 3.82, 5.71), familiarity = c(1.3, 
3.48, 1.83), typicality = c(1.71, 2.13, 4.5)), .Names = c("concreteness", 
"familiarity", "typicality"), row.names = c("amoeba", "bacterium", 
"leech"), class = "data.frame") 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-31T14:12:12.710

您可以将连接变量添加到 dat2 然后使用合并：

```
dat2$variable <- rownames(dat2)
merge(dat1, dat2)
   variable ID value concreteness familiarity typicality
1    amoeba  1     0         3.60        1.30       1.71
2    amoeba  2     0         3.60        1.30       1.71
3    amoeba  3    NA         3.60        1.30       1.71
4 bacterium  1     0         3.82        3.48       2.13
5 bacterium  2     0         3.82        3.48       2.13
6 bacterium  3     0         3.82        3.48       2.13
7     leech  1     1         5.71        1.83       4.50
8     leech  2     1         5.71        1.83       4.50
9     leech  3     0         5.71        1.83       4.50 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-31T15:33:42.807

试试这个：

```
merge(dat1, dat2, by.x = 2, by.y = 0, all.x = TRUE) 
```

这假设如果有任何`dat1`不匹配的行，那么`dat2`结果中的列应该被填充，`NA`如果有不匹配的值，`dat2`那么它们被忽略。例如：

```
dat2a <- dat2
rownames(2a)[3] <- "elephant"
# the above still works:
merge(dat1, dat2a, by.x = 2, by.y = 0, all.x = TRUE) 
```

以上在 SQL 中称为**左连接**，可以在 sqldf 中像这样完成（忽略警告）：

```
library(sqldf)
sqldf("select * 
         from dat1 left join dat2 
         on dat1.variable = dat2.row_names", 
       row.names = TRUE) 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2012-12-31T14:26:10.140

@agstudy 的回答没有错，但是您可以通过创建一个匿名临时文件来实际修改 dat2 来做到这一点。添加 X 类似：

```
> merge(cbind(dat1, X=rownames(dat1)), cbind(dat2, variable=rownames(dat2)))
   variable ID value   X concreteness familiarity typicality
1    amoeba  1     0   1         3.60        1.30       1.71
2    amoeba  2     0   2         3.60        1.30       1.71
3    amoeba  3    NA   3         3.60        1.30       1.71
4 bacterium  1     0 251         3.82        3.48       2.13
5 bacterium  2     0 252         3.82        3.48       2.13
6 bacterium  3     0 253         3.82        3.48       2.13
7     leech  1     1 501         5.71        1.83       4.50
8     leech  2     1 502         5.71        1.83       4.50
9     leech  3     0 503         5.71        1.83       4.50 
```

# java - Java用纹理画线

> ID：14102501
> 
> 赞同：0
> 
> 时间：2012-12-31T14:01:00.163
> 
> 标签：java, awt, textures, java-2d

我试图解决这个问题，但没有成功。我可以绘制带有纹理的矩形，但是如何使用纹理以一定角度绘制一条 4 像素宽的线？像`/`or`\`的例子

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:10:19.947

使用[TexturePaint](http://docs.oracle.com/javase/7/docs/api/java/awt/TexturePaint.html)。

```
TexturePaint paint = new TexturePaint(bufferedImage, anchorRect);
g.setPaint(paint);
g.setStroke(new BasicStroke(4.0F); 
```

# linux - 用基于匹配组的评估字符串替换字符串（优雅的方式，不使用 for .. in）

> ID：14102504
> 
> 赞同：3
> 
> 时间：2012-12-31T14:01:25.027
> 
> 标签：linux, shell, unix, sed, awk

我正在寻找一种方法来替换由正则表达式匹配的文件字符串，并用另一个字符串来生成/评估匹配的字符串。

比如我想替换这个文件中的时间戳（timestamp + duration）

```
1357222500 3600 ...
Maybe intermediate strings...
1357226100 3600 ...
Maybe intermediate strings...
... 
```

通过人类可读的日期表示（日期范围）。

直到现在，我总是使用像 Bash 这样的 shell 脚本来遍历每一行，匹配行 X，获取匹配的组字符串并在处理后打印该行，例如这种方式（从内存中）：

```
IFS="
"
for L in `cat file.txt`; do
  if [[ "${L}" =~ ^([0-9]{1,10})\ ([0-9]{1,4})\ .*$ ]]; then
    # Written as three lines for better readability/recognition
    echo -n "`date --date=@${BASH_REMATCH[1]}` - "
    echo -n "`date --date=@$(( ${BASH_REMATCH[1]} + ${BASH_REMATCH[2]} ))`"
    echo ""
  else
    echo "$L"
  fi
done 
```

我想知道虚构的（？）“sed-2.0”是否有类似的东西：

```
cat file.txt | sed-2.0 's+/^\([0-9]\{1,10\}\) \([0-9]\{1,4\}\) .*$+`date --date="@\1"` - `date --date="@$(( \1 + \2 ))`' 
```

而 sed-2.0 替换中的反引号将被评估为传递匹配组的 shell 命令`\1`和`\2`.

我知道这不能按预期工作，但我想写这样的东西。

## 编辑 1

**编辑上述问题：**`echo ""`在`if`Bash 脚本示例中添加了缺失。

这应该是预期的输出：

```
Do 3\. Jan 15:15:00 CET 2013 - Do 3\. Jan 16:15:00 CET 2013
Maybe intermediate strings...
Do 3\. Jan 16:15:00 CET 2013 - Do 3\. Jan 17:15:00 CET 2013
Maybe intermediate strings...
... 
```

请注意，时间戳取决于时区。

## 编辑 2

**编辑上述问题：**修复了 Bash 脚本示例的语法错误，添加了注释。

## 编辑 3

**编辑上述问题：**修复了 Bash 脚本示例的语法错误。将短语“老派示例”更改为“Bash 脚本示例”。

* * *

# [肯特](https://stackoverflow.com/questions/14102504/replace-strings-with-evaluated-string-based-on-matched-group-elegant-way-not-u#14102681)和[格伦杰克曼](https://stackoverflow.com/questions/14102504/replace-strings-with-evaluated-string-based-on-matched-group-elegant-way-not-u#14103201)的回答总结

两种方法都有很大的不同：执行时间。我已经比较了所有四种方法，结果如下：

**呆呆地使用`strftime()`**

```
/usr/bin/time gawk '/^[0-9]+ [0-9]+ / {t1=$1; $1=strftime("%c -",t1); $2=strftime("%c",t1+$2)} 1' /tmp/test
...
0.06user 0.12system 0:00.30elapsed 60%CPU (0avgtext+0avgdata 1148maxresident)k
0inputs+0outputs (0major+327minor)pagefaults 0swaps 
```

**gawk 使用执行通过`getline`（[Gnu AWK 手册](http://www.gnu.org/software/gawk/manual/html_node/Getline_002fVariable_002fPipe.html#Getline_002fVariable_002fPipe)）**

```
/usr/bin/time gawk '/^[0-9]{1,10} [0-9]{1,4}/{l=$1+$2; "date --date=@"$1|getline d1; "date --date=@"l|getline d2;print d1" - "d2;next;}1' /tmp/test
...
1.89user 7.59system 0:10.34elapsed 91%CPU (0avgtext+0avgdata 5376maxresident)k
0inputs+0outputs (0major+557419minor)pagefaults 0swaps 
```

**自定义 Bash 脚本**

```
./sed-2.0.sh /tmp/test
...
3.98user 10.33system 0:15.41elapsed 92%CPU (0avgtext+0avgdata 1536maxresident)k
0inputs+0outputs (0major+759829minor)pagefaults 0swaps 
```

**sed 使用`e`选项**

```
/usr/bin/time sed -r 's#^([0-9]{1,10}) ([0-9]{1,4})(.*$)#echo $(date --date=@\1 )" - "$(date --date=@$((\1+\2)))#ge' /tmp/test
...
3.88user 16.76system 0:21.89elapsed 94%CPU (0avgtext+0avgdata 1272maxresident)k
0inputs+0outputs (0major+1253409minor)pagefaults 0swaps 
```

**输入数据**

```
for N in `seq 1 1000`; do echo -e "$(( 1357226100 + ( $N * 3600 ) )) 3600 ...\nSomething else ..." >> /tmp/test ; done 
```

我们可以看到 AWK 使用该`strffime()`方法是最快的。但即使是 Bash 脚本也比`sed`shell 执行要快。

**肯特**向我们展示了一种更通用、更通用的方法来完成我所要求的。我的问题实际上不仅限于我的时间戳示例。在这种情况下，我必须这样做（用人类可读的日期表示替换时间戳+持续时间），但是我遇到了必须执行其他代码的情况。

**glenn jackman**向我们展示了一个特定的解决方案，该解决方案适用于您可以直接在 AWK 中进行字符串操作和计算的情况。

因此，这取决于您拥有的时间（或您的脚本可能运行的时间）、数据量以及应首选哪种方法的用例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:13:13.637

根据您的样本输入：

```
gawk '/^[0-9]+ [0-9]+ / {t1=$1; $1=strftime("%c -",t1); $2=strftime("%c",t1+$2)} 1' 
```

输出

```
Thu 03 Jan 2013 09:15:00 AM EST - Thu 03 Jan 2013 10:15:00 AM EST ...
Maybe intermediate strings...
Thu 03 Jan 2013 10:15:00 AM EST - Thu 03 Jan 2013 11:15:00 AM EST ...
Maybe intermediate strings...
... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:21:36.093

**awk oneliner：（**日期时间格式可能与您的输出不同）

```
awk '/^[0-9]{1,10} [0-9]{1,4}/{l=$1+$2; "date --date=@"$1|getline d1; "date --date=@"l|getline d2;print d1" - "d2;next;}1' file 
```

测试：

```
kent$  echo "1357222500 3600 ...
Maybe intermediate strings...
1357226100 3600 ...
Maybe intermediate strings...
..."|awk '/^[0-9]{1,10} [0-9]{1,4}/{l=$1+$2; "date --date=@"$1|getline d1; "date --date=@"l|getline d2;print d1" - "d2;next;}1'    
Thu Jan  3 15:15:00 CET 2013 - Thu Jan  3 16:15:00 CET 2013
Maybe intermediate strings...
Thu Jan  3 15:15:00 CET 2013 - Thu Jan  3 17:15:00 CET 2013
Maybe intermediate strings...
... 
```

**Gnu sed**

如果你有 gnu sed，你的“不工作” sed 行的想法可以通过应用 gnu sed 在现实世界中工作，`s/foo/shell cmds/ge`见下文：

```
sed -r 's#^([0-9]{1,10}) ([0-9]{1,4})(.*$)#echo $(date --date=@\1 )" - "$(date --date=@$((\1+\2)))#ge'  file 
```

测试

```
kent$  echo "1357222500 3600 ...
Maybe intermediate strings...
1357226100 3600 ...
Maybe intermediate strings...
..."|sed -r 's#^([0-9]{1,10}) ([0-9]{1,4})(.*$)#echo $(date --date=@\1 )" - "$(date --date=@$((\1+\2)))#ge'                                                                 
Thu Jan 3 15:15:00 CET 2013 - Thu Jan 3 16:15:00 CET 2013
Maybe intermediate strings...
Thu Jan 3 16:15:00 CET 2013 - Thu Jan 3 17:15:00 CET 2013
Maybe intermediate strings...
... 
```

如果我要解决这个问题，我个人会选择 awk。因为它简单易写。

最后我粘贴我的 sed/awk 版本信息：

```
kent$  sed --version|head -1
sed (GNU sed) 4.2.2

kent$  awk -V|head -1
GNU Awk 4.0.1 
```

# javascript - False 值未传播到 classNameBindings

> ID：14102513
> 
> 赞同：0
> 
> 时间：2012-12-31T14:02:24.567
> 
> 标签：javascript, ember.js

我已经设置了一个 classNameBindings

```
classNameBindings: ["App.controller.value:class1:class2"] 
```

它不起作用。没有类被添加。如果我删除了错误值（这部分：class2），如果 App.controller.value 为真，则将添加 class1。这是一个已知问题还是我做错了什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T23:58:02.400

您确定某物存在于`App.controller.value`吗？

您正在尝试做的事情应该可以正常工作。如果您了解全局应用程序，您的观点会很危险，请参阅[此 jsfiddle](http://jsfiddle.net/ad44g/)以获取示例。

这是小提琴的javascript部分：

```
App = Ember.Application.create();

App.someGlobal = Ember.Object.create({
    isEverythingOk: true
});

App.OkView = Ember.View.extend({
  classNameBindings: ['App.someGlobal.isEverythingOk:class1:class2']
  , templateName: 'ok'
});​ 
```

# image - 在 OpenCL 上通过凹多边形进行图像裁剪

> ID：14102515
> 
> 赞同：1
> 
> 时间：2012-12-31T14:02:33.727
> 
> 标签：image, opencl, polygon, clipping, image-clipping

是否可以直接在 OpenCL 上进行图像多边形裁剪？或者为此需要OpenGL互操作性吗？

如果这可以直接在 OpenCL 上实现，我认为这个问题可以归结为填充凹多边形来改变 alpha 通道；事实上，我想使用一个（本机）内核，将图像（image2d_t）和多边形（uint2数组）作为参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T22:27:52.777

不，多边形裁剪在 OpenCL 中不直接可用。

您可以使用 OpenCL/OpenGL 互操作，或在 OpenCL 中编写并行扫描转换函数。

# tomcat - grails 是否需要在 tomcat 上运行应用程序？

> ID：14102518
> 
> 赞同：0
> 
> 时间：2012-12-31T14:02:40.630
> 
> 标签：tomcat, grails

我对网络开发很陌生。

我看到人们在 tomcat 上运行 grails 应用程序，但该系统中没有安装 grails！这怎么可能？tomcat 怎么能理解“grails”的术语和语义呢？

我在这里有什么遗漏吗？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:14:00.983

应用程序所需的一切都在您部署的 WAR 文件中，包括 Grails JAR。Tomcat 仅托管应用程序。它不需要知道 Grails 的术语和语义。到 Tomcat 知道它的时候，它已经被翻译成它知道的东西：HTTP、HTML 等。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-31T14:37:51.370

您可以使用命令构建一个普通的[WAR](http://en.wikipedia.org/wiki/WAR_file_format_%28Sun%29)文件`grails war`。请参阅有关命令[的文档。](http://grails.org/doc/latest/ref/Command%20Line/war.html)`war`

因为一切都编译为 JVM 字节码，并且包含了 Groovy 库，所以这个 WAR 可以部署在任何 servlet 容器上——只要它支持您正在编译的 servlet 规范。您很可能需要一个支持 servlet 2.5 的容器。

# .htaccess - 这些 RewriteBase 和 RewriteRule 对我的 SEO 有用吗？

> ID：14102520
> 
> 赞同：1
> 
> 时间：2012-12-31T14:02:45.427
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, seo

我使用了一个开发子目录来安装一个 wordpress 平台。当我要求程序员将所有内容移至根目录时，他们以这种方式使用重写 htaccess 文件中的 urls 规则：

```
 <IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /test/
    RewriteRule ^index\.php$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /test/index.php [L] 
    </IfModule> 
```

规则有效，但我想知道这是否是 SEO 的好方法。搜索引擎是否以透明的方式看到这些规则，或者我会被禁止？我可以永久使用这些规则还是应该使用其他规则？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:24:05.917

> 规则有效，但我想知道这是否是 SEO 的好方法。

规则本身不会为您改善 SEO，正确设置您的 wordpress 链接更为重要。我很确定开箱即用的 wordpress 永久链接对于 SEO 来说设置得很好。确保它们已打开并按照您想要的方式进行设置。您必须[查看 wordpress 文档以获取更多信息](http://codex.wordpress.org/Using_Permalinks)

> 搜索引擎是否以透明的方式看到这些规则，或者我会被禁止？

这些规则对客户端透明地起作用。因此，搜索引擎机器人将请求一个 wordpress 永久链接，而根本看不到任何`/test/index.php`东西。你不会被禁止的。

> 我可以永久使用这些规则还是应该使用其他规则？

这些看起来像默认的 wordpress 生成规则，没有理由更改它们。

# asp.net - ASP.NET 网站发布与复制？

> ID：14102521
> 
> 赞同：8
> 
> 时间：2012-12-31T14:02:59.730
> 
> 标签：asp.net, web, publishing

我在发布时遇到了很多问题，例如当您需要对代码进行小的更改时，有时生成的 DLL 文件（例如`default.aspx.CS`发布时的 dll 文件）无法被 IIS 识别，说代码隐藏错误或其他什么。很抱歉没有记住确切的错误信息。我希望你现在知道我的意思。

因此，我通常做一个简单的`Copy Paste`操作而不是Publishing。

你能告诉我不使用 Publish 方法我错过了什么吗？出版如何更好？或者你更喜欢哪一个，为什么？

基本上这是一个利弊的情况。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-31T15:14:09.673

好吧，这取决于您所说的“复制”是什么意思：

`Publishing`您可以选择`pre-compile`全部或部分应用程序。您可以`publish`复制到文件系统中的本地文件夹（而不是目标/主机），然后*复制*更新的文件（仅）。如果您正在进行“代码隐藏”（c#/vb 代码）更改，这意味着您可能只需要“复制”/覆盖`dlls`。不用说，如果您进行了“内容”更改（html/razor/script/etc）更改，那么您也需要复制/覆盖这些更改。

如果您不熟悉部署，您可能会发现自己只是复制/覆盖“所有内容” *，这是最安全的方法*。一旦获得更多经验，您将“识别”哪些资产只需要更新（一个或几个`dlls`和/或内容代码，而不是“一切”）。这没有什么神奇之处，通常，它只是在您`published`（本地）或`rebuild`您的 Web 应用程序之后查看 dll/文件的时间戳。

我建议您这样做，`local publish`以便您可以查看服务器上实际需要的内容。发布到本地文件系统/文件夹的文件需要在您的主机/服务器上。这样做将可视化并消除任何“神秘” `Publishing`：

*   您会看到（在您的服务器上）实际需要什么与不需要什么
*   您将看到文件时间戳，这将帮助您识别哪些文件实际更改了哪些文件没有更改（因此不需要更新）。
*   一旦掌握了窍门，您就不需要“复制”/ftp“所有内容”，只需更新实际修改的文件（仅）。

因此，“复制”可以表示上述内容，或者如果您说您将简单地将所有开发代码（原始`(vb/cs)html/cs/vb`）复制到您的主机，那么这意味着您的站点将`dynamically compiled`是需要/请求的每个资源（没有`pre-compiled`）。也“容易”，但你确实输了`pre-compilation`，这意味着当你的每个网页被请求/需要时会有延迟（ASP.net 需要动态编译）。此外，您还将在服务器上公开您的源代码。根据您的情况，这可能意义不大，但这是要考虑的另一件事。

这是[有关预编译和选项的更多信息](http://www.dotnetperls.com/precompiled)。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-31T16:00:02.823

假设我们考虑一个 aspx 页面及其隐藏文件的 aspx.cs 代码，则可以使用三种替代方法来部署您的站点：

1.  您可以将两者都复制到 iis。aspx 将在第一次请求时编译为 .cs，然后两个 .cses 都将编译为临时 .dll
2.  您可以“发布”到 iis，这会将类后面的代码编译为 .dll，但会原封不动地复制 aspx。aspx 将在第一次请求时转换为 .cs，然后转换为 .dll
3.  您可以“发布”该站点，然后使用 aspnet_compiler 手动对其进行预编译。发布将像以前一样将后面的代码编译为 .dll，但随后预编译将通过删除 .aspx 文件的内容并将已编译的代码移动到另一个 .dll 来清除您的 .aspx 文件。

这三种模式各有利弊。

第一个是最容易增量更新的，但同时对不需要的修改最开放。

第二个也很简单，可以从 vs 调用，它消除了在服务器上进行一些不需要的修改的可能性，但是 .aspxses 在第一次请求时仍然需要时间来编译

第三需要时间和一些手动操作，但可以防止任何更改，并且还可以加快站点的预热，因为不需要编译资产。它非常适合共享环境。

# mysql - 计算赞成票和反对票

> ID：14102525
> 
> 赞同：-8
> 
> 时间：2012-12-31T14:03:43.333
> 
> 标签：mysql

我有一个这样的 SQL 表：

```
id  cid     u_id  vote  user_ip     date_added 
--------------------------------------------------------------
67  188     13      0   127.0.0.1   1356686070
68  188     15      1   127.0.0.1   1356686765
69  291     13      1   127.0.0.1   1356688859
70  62      15      1   127.0.0.1   1356695284
71  370     23      1   127.0.0.1   1356892215
73  232     23      1   127.0.0.1   1356893261
74  152     23      1   127.0.0.1   1356893591
76  75      15      1   127.0.0.1   1356924002
77  201     15      1   127.0.0.1   1356927284 
```

在`vote`列中，`0`代表反对票，`1`代表赞成票。我将如何计算每个人的反对票和赞成票`cid`？

结果将是这样的：

```
cid   upvotes  downvotes
188   1        1
291   1        0
291   1        0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:07:21.190

```
SELECT cid,
  SUM(vote) AS upvoted,
  SUM(CASE
        WHEN vote = 0
        THEN 1
        ELSE 0
      END) AS downvoted
FROM yourtablename
GROUP BY cid; 
```

# java - 将字符串数组转换为整数数组

> ID：14102527
> 
> 赞同：0
> 
> 时间：2012-12-31T14:03:51.190
> 
> 标签：java, string, integer

假设：

1.  字符串数组中的每个字符串都是 Double 类型。

2.  字符串数组中的某些字符串可能为空。

3.  每当 String Array 中的字符串为 null 时，其对应的 Integer Array 中的 Integer 的值应为 0。

编辑：成功转换后，我想返回这个创建的整数数组。

我被困在字符串为空的地方，在字符串为空的地方得到 NumberFormatException。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:07:28.337

在将 String 转换为 Double 之前，使用 if 语句检查 String 是否等于 null。

如果 String 等于 null，则将零移动到 Integer 数组，否则进行 String 到 Double 的转换，将 Double 转换为 Integer，并将 Integer 放入 Integer 数组。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T14:23:27.067

希望这可以帮助！

```
 public class Test {

        public static void main(String[] args) {
            String[] strArray = {"1.1", "2.2", null, "3.3"};
            Integer[] intArray = new Integer[4];
            for (int i = 0; i < strArray.length; i++) {
                intArray[i] = (strArray[i] == null) ? 0 : (int) Double.parseDouble(strArray[i]);
            }
            System.out.println("String array = ");
            for (String str : strArray) {
                System.out.print(str + " ");
            }
            System.out.println();
            System.out.println("Integer array = ");
            for (Integer integer : intArray) {
                System.out.print(integer + " ");
            }
        }
    } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T14:12:31.433

一个简单的三元运算符就可以做到：

```
String[] s = //Array instantiation
double d = new double[s.length];
for(int i = 0; i < s.length; i++)
{
    d[i] = s[i] == null ? 0 : Double.parse(s[i]);
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-31T14:15:31.103

因此，即使它们存储双精度值，您也想将字符串转换为整数？如果是这样，那么这样的事情应该可以工作：

```
for (int i = 0; i < stringArray.length; i++) {
    String s = stringArray[i];
    if (s == null || s.isEmpty()) {
        integerArray[i] = new Integer(0);
    } else {
        integerArray[i] = new Integer(s.substring(0,s.indexOf(".")));
    }
} 
```

# google-apps-script - 如何使用 Apps 脚本将日期插入 YYYY-MM-DD 纯文本到 Google 电子表格中

> ID：14102528
> 
> 赞同：2
> 
> 时间：2012-12-31T14:04:02.233
> 
> 标签：google-apps-script, google-sheets

本质上，我希望在将新电子表格创建为纯文本时将 YYYY-MM-DD 格式插入到新电子表格的单元格中。问题在于，当插入的值插入新工作表时，它显示为 DD/MM/YYYY，后台运行的其他程序无法读取。

这是以下代码：

```
function dateTest() 
{
var template = SpreadsheetApp.openById('ABC------1234')
var test = template.getSheetByName('TEST');
var database = SpreadsheetApp.getActive().getSheetByName('DASHBOARD');

//start & endDates are in YYYY-MM-DD format in these cells
var startDate = database.getRange('A10').getValue();
var endDate = database.getRange('A11').getValue();

//The results come up as DD/MM/YYYY when they are set into TEST
//Formatted to YYYY-MM-DD has already been done 
test.getRange('D1').setValue(startDate);
test.getRange('D2').setValue(endDate);

} 
```

如有必要，可以将日期拆分为 YYYY + '-' + 'MM' + '-' + 'DD' 然后作为纯文本插入，但是我不知道如何执行此壮举。任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T20:12:53.803

它可以清理，但这里是基础知识。

```
//start & endDates are in YYYY-MM-DD format in these cells
var startDate = database.getRange('A10').getValue();
var strStartDate = startDate.getFullYear() + "-" + (startDate.getMonth() + 1) + "-" + startDate.getDate();
var endDate = database.getRange('A11').getValue();
var strEndDate = endDate.getFullYear() + "-" + (endDate.getMonth() + 1) + "-" + endDate.getDate();

//The results come up as DD/MM/YYYY when they are set into TEST
//Formatted to YYYY-MM-DD has already been done 
test.getRange('D1').setNumberFormat('@STRING@');
test.getRange('D1').setValue(strStartDate);

test.getRange('D2').setNumberFormat('@STRING@');
test.getRange('D2').setValue(strEndDate); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T20:43:50.837

在 Google 电子表格中，前导撇号表示忽略格式。因此，这有效：

```
range.setValue("'2007-09-12"); 
```

或者，文本可以被引用并设置为“公式”：

```
range.setFormula('"2007-09-12"'); 
```

（确保字符串包含双引号而不是单引号 - Apps 脚本是 JavaScript，因此两者都支持，但电子表格公式不能以同样的方式理解单引号。）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T16:04:23.237

这将重新格式化日期并将其设置为字符串：

```
 var tz = ss.getSpreadsheetTimeZone();
  var newDate = Utilities.formatDate(startDate, tz, 'yyyy-MM-dd'); // Requested format
  s.getRange('D1').setValue("'" + newDate);  // Set as string 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:43:38.083

尝试此解决方法：在工作表中手动将单元格格式设置为不参与操作的“纯文本”。我们称这个单元格为 J1。现在在调用之前：

```
test.getRange('D1').setValue(startDate);
test.getRange('D2').setValue(endDate); 
```

执行以下操作：

```
test.getRange('J1').copyFormatToRange(test,3,3,0,1); // This is D1 and D2
test.getRange('D1').setValue(startDate);
test.getRange('D2').setValue(endDate); 
```

这应该让您在目标单元格上有清晰的文本格式。

# html - 定位元素在 MSIE7 流中的下一个定位元素下消失

> ID：14102529
> 
> 赞同：2
> 
> 时间：2012-12-31T14:04:05.177
> 
> 标签：html, css, internet-explorer-7

有时会遇到这个问题，但我总是使用一些替代代码来避免它。

不幸的是，这一次我需要帮助。

在 IE7 中，如果两个兄弟 DIVS 有“position:relative”绝对定位的孩子他们的“下一个兄弟 DIV”下消失

[http://jsfiddle.net/qN74X/](http://jsfiddle.net/qN74X/)

```
<div style="width:200px;position:relative;background:yellow;">XXX
    <div style="position:absolute;z-index:1;background:red;
                height:70px;top:0;left:50%;">ZZZ</div>
</div>

<div style="position:relative;width:200px;background:pink;">YYY</div> 
```

我该如何解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:53:06.217

将鼠标悬停在元素上时，也将其设置为 z-index（不仅仅是提示）。这是主要的变化：

```
body > div{
    position:relative;
    z-index:1;
}
body > div:hover{
    z-index:5;
    border:0 none;
} 
```

基本上，在外部容器（背景所在的位置）上需要改变它的 z-index。我也不确定为什么我需要放置border：0 none，但没有它，它不起作用。

**jsfiddle**：http: [//jsfiddle.net/qN74X/3/](http://jsfiddle.net/qN74X/3/)

# makefile - Doxygen：从 Windows 为 Linux 生成 makefile

> ID：14102530
> 
> 赞同：0
> 
> 时间：2012-12-31T14:04:05.607
> 
> 标签：makefile, doxygen, gnu-make

我正在解决一个已经存在的项目中的一些问题。在这个项目中，文档是使用 Doxygen 生成的。需要PDF文档。

该项目必须在 Windows 上运行。我们正在使用来自 DDC-I 的套件（用于安全关键软件），它有自己的命令提示符。这个命令提示符“模拟”（如 cygwin）一些 Unix 命令和工具，如“make”，这就是问题所在。

当我生成文档时，Doxygen 创建了一些 Makefile，并且由于我在 Windows 上，所以这个 makefile 包含命令“del”，但是当我从命令提示符调用“make clean”时，我收到了这个错误：

```
/bin/sh: del: command not found make: *** [clean] Error 12 
```

这是因为命令提示符使用类 Unix 的 make 和 aspect 来查看“rm”命令而不是“del”命令。我尝试了不同的解决方案，但最简单的方法是为 Linux 生成 makefile，即使我在 Windows 上也是如此。可能吗？

先感谢您！

这是系统： Doxygen 1.7.4 Windows XP GNU Make 3.81

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-01T10:26:44.317

没有办法对此进行配置，但由于 1.8.0 版 doxygen 编写了一个可以在纯 Windows 环境中使用的 make.bat（使用 del）和一个可以在类似 Cygwin 的环境中使用的 Makefile（使用 rm）。

# c++ - 在向量中存储各种类型

> ID：14102531
> 
> 赞同：0
> 
> 时间：2012-12-31T14:04:12.600
> 
> 标签：c++, class, object, types, vector

我正在尝试将各种不同类型的数据存储在数组或向量中。到目前为止，我通过使用一个基类来做到这一点，该基类将作为指向每个对象的指针存储在向量中，然后进行类型转换以获取数据。这对 int 非常有效，但任何其他类型的数据都会引发访问冲突异常。

抱歉，如果我的解释不是很好，这是我的代码，其中包含我希望对您有所帮助的注释：

```
//Base class
class MenuProperty
{
private:
    std::string Name;

public:
    MenuProperty(std::string Name) : Name(Name) {};
    ~MenuProperty() {};

    std::string GetName();

};

//Typed class used to store data
template<class T>
class TMenuProperty : public MenuProperty
{
private:
    T Data;

public:
    TMenuProperty(std::string Name, T Data) : MenuProperty(Name), Data(Data) {};

    T GetData()
    {
       return this->Data;
    }
};

//Class with no type and data pointer to retrieve data
class cpMenuProperty : public MenuProperty
{
private:
    VOID* Data;

public:
    cpMenuProperty(std::string Name) : MenuProperty(Name) {};

    VOID* GetPointer()
    {
       return this->Data;
    }
}; 
```

希望这有点道理，这是我的测试代码：

```
int main()
{
    TMenuProperty<double> fP("Test2", 33.7354); //Create instance of property

    MenuProperty* fMP = &fP;                    //Make a pointer to the object

    cpMenuProperty* Test;                       //Make a pointer to the retrieving
                                                //object

    std::vector<MenuProperty*>              Vec;
    std::vector<MenuProperty*>::iterator    it;

    Vec.push_back(fMP);                         

    it = Vec.begin();

    Test = static_cast<cpMenuProperty*>(*it);   //Cast the first object in the list 
                                                //list to the same type as the
                                                //retrieveing object

    double Data = *(double*)Test->GetPointer(); //Dereference and access, this is
                                                //where the exception is thrown

    std::cout << Data;

    int Ret;
    std::cin >> Ret;
} 
```

我可能在这里犯了一些巨大的错误，但感谢您花时间阅读到目前为止:) 感谢您提供任何帮助，以及建设性的批评！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:50:55.657

您正在初始化堆栈上的 TMenuProperty 对象，然后将其转换为 cpMenuProperty。cpMenuProperty 中永远不会为 void* 数据分配任何内存。TMenuProperty 和 cpMenuProperty 之间没有关系，只是它们派生自同一个类。这种设计永远行不通。

*   摆脱所有的 void*。那是自找麻烦。
*   不要使用 static_cast<> 除非你 100% 知道你在做什么。使用 dynamic_cast，它会告诉你转换无效（我猜你尝试过这个但后来又回到 static_cast 以强制代码至少编译:)）
*   为什么不一直使用 TMenuProperty 呢？这种方法应该奏效。
*   对于其他方式来做你所追求的，看看 boost::variant 和 boost::any。
*   如果你很勇敢并且真的知道你在做什么（没有冒犯，但我认为你没有资格这样做），并且如果你需要包装的数据类型在内存布局方面足够统一，你也许可以使您的代码使用适当的内存填充设置并以某种方式强制内存对齐。但是，无论多么不可能，我都想不出*任何*方案来找到这样做的理由。因此，从这篇文章中我可以看出，我只能建议删除 cpMenuProperty 并仅使用抽象基类/模板化派生类方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:45:32.913

```
 #include<iostream>
 #include<vector>
 #include<iterator>
 #include<memory>
 class base {
 public:
 virtual void foo(){
      std::cout << "in base" << std::endl;
  }
 };

 class derived : public base {
 public:
 virtual void foo(){
      std::cout << "in derived" << std::endl;
   }
 };

 int main()
 {
    std::vector<std::unique_ptr<base>> vec;
    vec.emplace_back(new derived);
    static_cast<derived*>(vec[0].get())->foo();
    return 0;
  } 
```

经典的例子，使用现代实践。

# iphone - 仅通过唯一标识符向经过验证的 IOS 设备授予对服务器的访问权限

> ID：14102533
> 
> 赞同：1
> 
> 时间：2012-12-31T14:04:23.970
> 
> 标签：iphone, ipad, validation, ios6, udid

我的公司有 10 台 IOS 设备，主要是运行 IOS 6 的 ipad。我有一个服务器，我在其中为我的设备创建了适当的 Web 服务以与之通信。我希望通过仅允许经过验证的设备访问 Web 服务来扩展当前设置。

我已经考虑将 UDID 作为额外属性传递给 Web 服务器，然后该服务器将针对包含加密 UDID 的数据库运行，如果找到匹配项，则验证设备并允许 Web 服务进程继续。

但是我知道UDID现在已经贬值了。我可以为每个设备实现一个唯一的 UDID 的最简单方法是什么，这也适用于未来的内部应用程序更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:28:06.557

为什么不创建一个标准的登录系统，让用户使用用户名和密码登录设备，然后服务器返回一个可用于验证未来交互的证书？当您只需要登录时，为什么要将用户限制在特定设备上。最终结果 - 限制哪些用户可以使用系统 - 仍然可以实现，但以更灵活和可扩展的方式实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:27:21.950

使用 UIDevice identifierForVendor 来识别 iOS6 下的设备。

```
[[UIDevice currentDevice] identifierForVendor] 
```

来自Apple docs：“对于来自同一供应商在同一设备上运行的应用程序，此属性的值是相同的。对于来自不同供应商的同一设备上的应用程序以及不同设备上的应用程序，返回不同的值供应商的。”

我使用的另一种方法是在服务器上生成 UUID，通过电子邮件将其发送给用户，并使用 URL 方案打开应用程序，然后应用程序将其保存在钥匙串中。钥匙串在应用程序删除/重新安装时保存 UUID。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:38:43.670

使用设备的 MAC 地址。它不违反 Apple 政策，并且永远不会改变。

# c++ - c++向量没有正确填充

> ID：14102536
> 
> 赞同：2
> 
> 时间：2012-12-31T14:05:01.677
> 
> 标签：c++, vector

我正在制作一个引擎，它应该读取格式化的文本文件并将它们作为基于文本的冒险输出。世界正在被写入一个向量矩阵。但是，我的程序似乎只在一个维度中填充矩阵，并且只使用来自矩阵第一个单元格的信息。

WorldReader 读取 World 文件并返回指定的行：

```
std::string WorldReader(std::string file,int line)
{

    std::string out[n];
    int i = 0;
    World.open(file + "World.txt");
    if(!World.good())
        return "Bad File";
    else while(i<n && getline(World, out[i]))
    {
        i++;
    }
    World.close();
    return out[line];
} 
```

这是写循环：

```
 for(j=0; j<(width*height); j++)
            {
                int x;
                int y;
                stringstream Coordx(WorldReader(loc, 4+j*10));
                Coordx >>  x;
                stringstream Coordy(WorldReader(loc, 5+j*10));              
                Coordy >>  y;
                std::string Desc = WorldReader(loc, 6+j*10);
                W1.writeCell(x,y,0,Desc);
            } 
```

这是 writeCell 函数：

```
 std::vector<std::string> Value;
    std::vector<std::vector<std::string> > wH;
    std::vector< std::vector<std::vector<std::string> > > grid;

void World::writeCell(int writelocW, int writelocH, int ValLoc, std::string input)
{
    if (wH.size() > writelocH)
    {
        Value.insert(Value.begin()+ValLoc,1,input);
        wH.insert(wH.begin() + writelocH,1,Value);
        grid.insert(grid.begin() + writelocW,1,wH);
    }
    else
    {
        wH.insert(wH.begin(),1,Value);    
        grid.insert(grid.begin(),1,wH);
    }
} 
```

即使我将其调整为 3x3，矩阵也变得非常臃肿。

提示和帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T20:39:34.540

行。我*想*我知道你的问题在哪里。请注意，如果没有真正可运行的代码，这将*非常*难以分析。最重要的是：您正在为您处理*的每个**值***`grid`插入一个新的二维矩阵到您的中，我希望很清楚为什么会这样。它解释了您遇到的大量膨胀（和不准确的数据）。

**您的原始代码**

```
void World::writeCell(int writelocW, int writelocH, int ValLoc, std::string input)
{
    if (wH.size() > writelocH)
    {
        // inserts "input" into the Value member.
        Value.insert(Value.begin()+ValLoc,1,input);

        // inserts a **copy** of Value into wH
        wH.insert(wH.begin() + writelocH,1,Value);

        // inserts a **copy** of wH into the grid.
        grid.insert(grid.begin() + writelocW,1,wH);
    }
    else
    {   // inserts a **copy** of Value into wH
        wH.insert(wH.begin(),1,Value);    

        // inserts a **copy** of wH into the grid.
        grid.insert(grid.begin(),1,wH);
    }
} 
```

如您所见。这里有很多无意的复制。您有三个变量，每个变量都是独立的。

```
std::vector<std::string> Value;
std::vector<std::vector<std::string> > wH;
std::vector< std::vector<std::vector<std::string> > > grid; 
```

在`writeCell`您尝试将字符串插入 3D 位置的过程中，但最多只能“取消引用”这些维度中的一个。和复制 o-festival 接踵而至

根据您的变量名称，我假设您的网格维度基于：

```
writeocW * writelocH * ValLoc 
```

您需要以从高到低的顺序展开维度，从`grid`. 最终这就是它的访问方式。我个人会为此使用稀疏的 std::map<> 系列，因为空间利用会*更有*效率，但我们正在使用你所拥有的。我正在写这篇即兴的文章，没有附近的编译器来检查错误，所以请给我一点自由度。

* * *

**建议的解决方案**

这是您毫无疑问拥有的 World 级的精简版。我已将参数的名称更改为传统的 3D 坐标 (x,y,z)，以明确如何执行我*认为*您想要的操作：

```
class World
{
public:
    typedef std::vector<std::string> ValueRow;
    typedef std::vector<ValueRow> ValueTable;
    typedef std::vector<ValueTable> ValueGrid;
    ValueGrid grid;

    // code omitted to get to your writeCell()

    void writeCell(size_t x, size_t y, size_t z, const std::string& val)
    {
        // resize grid to hold enough tables if we would
        //  otherwise be out of range.
        if (grid.size() < (x+1))
            grid.resize(x+1);

        // get referenced table, then do the same as above,
        //  this time making appropriate space for rows.
        ValueTable& table = grid[x];
        if (table.size() < (y+1))
            table.resize(y+1);

        // get referenced row, then once again, just as above
        //  make space if needed to reach the requested value
        ValueRow& row = table[y];
        if (row.size() < (z+1))
            row.resize(z+1);

        // and finally. store the value.
        row[z] = val;
    }
}; 
```

我认为这会让你到达你想要的地方。请注意，使用大坐标可以快速增长这个立方体。

* * *

**替代解决方案**

如果由我决定，我会使用这样的东西：

```
typedef std::map<size_t, std::string> ValueMap;
typedef std::map<size_t, ValueMap> ValueRowMap;
typedef std::map<size_t, ValueRowMap> ValueGridMap;
ValueGridMap grid; 
```

由于您在使用此网格执行任何操作时都会枚举这些，因此键的顺序（基于 0 的索引）很重要，因此使用`std::map`而不是`std::unordered_map`. An 的访问`std::map`器有一个*非常*好的特性`operator[]()`：*如果引用的键槽不存在，它会添加它*。因此，您的 writeCell 函数将崩溃为：

```
void writeCell(size_t x, size_t y, size_t z, const std::string& val)
{
    grid[x][y][z] = val;
} 
```

显然，这会从根本上改变您使用容器的方式，因为您必须意识到您没有使用的“跳过”索引，并且您会在使用适当的迭代器枚举正在使用的维度时检测到这一点. 无论如何，您的存储会*更有*效率。

无论如何，我希望这至少有一点帮助。

# java - 为什么即使鼠标不在文本上，viewToModel 也会返回最后一个字符的位置？

> ID：14102540
> 
> 赞同：0
> 
> 时间：2012-12-31T14:05:26.480
> 
> 标签：java, swing, jtextpane, mouseclick-event

我有一个`JTextPane`并使用一个`MouseAdapter`我需要获得被点击的字符的位置。当我直接单击字符时，使用`viewToModel`确实会返回所需位置，但是，当我单击`JTextPane`.

有谁知道当我不点击字符时如何避免获得最后一个字符的位置？

她的获得该职位的代码：

```
public void mouseClicked(MouseEvent e) {
    JTextPane editor = (JTextPane) e.getSource();
    Point pt = new Point(e.getX(), e.getY());
    int pos = editor.viewToModel(pt);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:17:59.590

单击空白区域时，您期望什么结果？实际上它返回最接近点击点的位置。

您可以从 viewToModel() 获取位置并使用 modelToView() 传递获得的偏移量。然后只需将返回的矩形与单击的点进行比较。

# java - 排序 String[][] 意外输出

> ID：14102541
> 
> 赞同：0
> 
> 时间：2012-12-31T14:05:37.197
> 
> 标签：java, arrays, sorting

我想根据第二列对我的 String[][] 进行排序。我试过这个

```
public static String[][] sorting_minn(String[][] list){ 
    double[] temp = new double[list.length];
    String[][] tempf = list;

    if(list[1][1]!=null){
    for(int i = 0; i<list.length; i++){
        if(list[i][2]==null){
            break;

        } else {
            temp[i]=Double.parseDouble(list[i][2]);

        }

    }

Arrays.sort(temp);

for(int f = 0; f<list.length-1;f++){
    for(int m = 0; m<list.length;m++){
        if(list[m][2]!=null && Double.parseDouble(list[m][2])==temp[f]){
             for(int n = 0; n<4; n++){
                 tempf[list.length-f-1][n]=list[m][n];

             }
        m = list.length;
            }
        }

    }
}
return tempf;

} 
```

作为输出，我得到这个：![输出](../Images/295323c63e4f06122efd10ca19195ac9.png). 我需要有关如何改进此代码的建议。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:10:46.163

尝试类似：

```
 Arrays.sort(list, new Comparator<String[]>() {
            @Override
            public int compare(String[] o1, String[] o2) {
                String left = o1[1]!=null ? o1[1] : "";
                String right = o2[1]!=null ? o2[1] : "";
                return left.compareTo(right);
            }
        }); 
```

这将 null 视为空字符串，并利用字符串可比较的事实，尽管是字典顺序的。如果你想要相反的顺序，只需这样做：

```
right.compareTo(left) 
```

如果你想要整数排序，你可以从两边解析一个整数（Integer.MIN for null）并比较2个整数

# winapi - 对话框 WinApi

> ID：14102546
> 
> 赞同：-1
> 
> 时间：2012-12-31T14:06:50.460
> 
> 标签：winapi

有一些代码，创建对话框窗口

```
HWND CreateDlg( HWND hwnd, WORD *pdlgtemplate) 
{ 
TCHAR const caption[ ]=_T("Change state of programm"); 
TCHAR const stattxt[ ]=_T("Now should"); 
TCHAR const modeoff[ ]=_T("Close"); 
TCHAR const modedat[ ]=_T("Reload"); 
TCHAR const modepsw[ ]=_T("Change user"); 
WORD *p; p=pdlgtemplate; 
int cxChar, cyChar;
{TEXTMETRIC tm; 
HDC hdc=GetDC(hwnd);
GetTextMetrics(hdc,&tm); 
ReleaseDC(hwnd,hdc); 
cxChar=tm.tmAveCharWidth+1;
cyChar=tm.tmHeight+tm.tmExternalLeading; }
DWORD dlgunit =GetDialogBaseUnits();
int dlgwunit=LOWORD(dlgunit), dlghunit=HIWORD(dlgunit); 
cxChar=cxChar*4/dlgwunit;
cyChar=cyChar*8/dlghunit;
int wDlg, hDlg, wItem, hItem, left, top;
DWORD IStyle; 
//Записываем в шаблон данные панели
IStyle = DS_CENTER | DS_MODALFRAME | WS_POPUPWINDOW | WS_CAPTION;
wDlg=lstrlen(caption)*cxChar; 
hDlg=cyChar*10; 
DlgTemplate(p,IStyle, 7,0,0, wDlg, hDlg, (LPSTR)caption);
//Далее добавляем записи для элементов управления 
//1 
hItem=cyChar;
top=left=hItem/2; 
hItem+=left; 
wItem=(wDlg-left-left);
IStyle = WS_CHILD | WS_VISIBLE | BS_GROUPBOX | WS_TABSTOP; 
DlgItemTemplate(p, IStyle, left, top, wItem, 4*hItem+left, ID_STATIC,(LPSTR) "button",(LPSTR)stattxt); 
//2
wItem=lstrlen(modeoff)*cxChar+10; top+=hItem; IStyle = BS_AUTORADIOBUTTON | WS_CHILD | WS_VISIBLE | WS_TABSTOP;
DlgItemTemplate(p, IStyle, hItem, top, wItem, hItem, ID_BUTTON1, (LPSTR)"button", (LPSTR)modeoff); 
//3
wItem=lstrlen(modedat)*cxChar+10; top+=hItem; IStyle = BS_AUTORADIOBUTTON | WS_CHILD | WS_VISIBLE; 
DlgItemTemplate(p, IStyle, hItem, top, wItem, hItem, ID_BUTTON2, "button", (LPSTR)modedat); 
//4 
wItem=lstrlen(modepsw)*cxChar+10; top+=hItem; IStyle = BS_AUTORADIOBUTTON | WS_CHILD | WS_VISIBLE;
DlgItemTemplate(p, IStyle, hItem, top, wItem, hItem, ID_BUTTON3, (LPSTR)"button", (LPSTR)modepsw);
//5 
wItem=(wDlg-left-left-hItem-hItem)/3; top+=hItem+hItem/2+left; IStyle = BS_DEFPUSHBUTTON | WS_VISIBLE | WS_CHILD | WS_TABSTOP;
DlgItemTemplate(p, IStyle, left, top, wItem, hItem, IDOK,(LPSTR)"button",(LPSTR)"Ok"); 
//6 
IStyle = BS_PUSHBUTTON | WS_VISIBLE | WS_CHILD | WS_TABSTOP; 
DlgItemTemplate(p, IStyle, left+wItem+hItem, top, wItem, hItem, IDCANCEL,(LPSTR)"button",(LPSTR)"No"); 
//7 
DlgItemTemplate(p, IStyle, left+wItem+hItem+wItem+hItem, top, wItem, hItem, ID_HELP, (LPSTR)"button",(LPSTR)"help");

//Создаем немодальное диалоговое окно 
HWND hdlg=CreateDialogIndirect(hInstance, (LPDLGTEMPLATE)pdlgtemplate,hwnd, (DLGPROC)DlgProc);
return hdlg; } 
```

还有一些代码，将模板写入内存。

```
int nCopyAnsiToWideChar (LPWORD lpWCStr, LPSTR lpAnsiIn)
{  int nChar = 0;
do {
*lpWCStr++ = (WORD) *lpAnsiIn;
nChar++;
 } while (*lpAnsiIn++);
 return nChar;
 }

LPWORD lpwAlign( LPWORD lpIn)
{
ULONG ul;
 ul = (ULONG) lpIn;
 ul +=3;
 ul >>=2;
 ul <<=2;
 return (LPWORD) ul;
 } 

void DlgItemTemplate(PWORD& p, DWORD IStyle, int x, int у, int cx, int cy, WORD id, LPSTR
classname,  LPSTR txt) 
{ 
 *p++ = LOWORD(IStyle); // В первые два слова
 *p++ = HIWORD(IStyle); //записываем стиль элемента управления 
 *p++ = 0; //В следующие две строки можно 
 *p++ = 0; //записать расширенный стиль окна 
 *p++ = x; //Координата левого края элемента управления 
 *p++ = у; //Координата верхнего фая элемента управления 
 *p++ = cx; //Ширина элемента управления
 *p++ = cy; //Высота элемента управления 
 *p++ = id; //Идентификатор элемента управления int nchar= nCopyAnsiToWideChar( p, (LPSTR)(classname)); 
  p += nchar; //Смещаем указатель на количество символов //Преобразуем Ansi-строку заголовка в строку Unicode 
  if (!strlen( txt) > 0) nchar = nCopyAnsiToWideChar( p, (LPSTR)( txt)); else nchar =  nCopyAnsiToWideChar(p,(LPSTR)("")); p += nchar; //Смещаем указатель на число символов 
 *p++ = 0; //Дополнительные данные не используем //Выравниваем шаблон по границе
  p=lpwAlign((LPWORD)p); 
 }

 void DlgTemplate(PWORD& p, DWORD IStyle, int items, int x, int y, int cx, int cy, LPSTR txt) 
 {
 *p++ = LOWORD(IStyle); //В первые два слова 
 *p++ = HIWORD(IStyle); //записываем стиль панели 
 *p++ = 0; //В следующие две строки можно
 *p++ = 0; //записать расширенный стиль окна 
 *p++ = items; //Число элементов управления панели 
 *p++ = x; //Координата левого края панели 
 *p++ = y; //Координата верхнего края панели 
 *p++ = cx; //Ширина панели 
 *p++ = cy; //Высота панели 
 *p++ = 0; //Меню не подключается 
 *p++ = 0; //Используем стандартный класс 
 //Преобразуем Ansi-строку заголовка в строку Unicode 
 int nchar=nCopyAnsiToWideChar(p,(LPSTR)txt); 
 p += nchar; //Смещаем указатель на количество символов 
 //Выравниваем шаблон по границе WORD 
 p=lpwAlign((LPWORD)p); } 
```

最后他给出了一些奇怪的东西...... [http://s14.postimage.org/z7wg0ang1/image.png](http://s14.postimage.org/z7wg0ang1/image.png)
我的代码中的错误在哪里？

PS对不起我的英语不好。
PPS 新年快乐！！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T21:45:59.693

将其重写为资源并使用 DialogBox 启动它大约需要 5 分钟。没有疯狂的字符串转换。没有指针数学。

resource.rc 有这个：

```
IDD_DIALOG1 DIALOGEX 0, 0, 187, 90
STYLE DS_SETFONT | DS_MODALFRAME | DS_FIXEDSYS | DS_CENTER | WS_POPUP | WS_CAPTION | WS_SYSMENU
CAPTION "Your caption here"
FONT 8, "MS Shell Dlg", 400, 0, 0x1
BEGIN
    CONTROL         "Radio1",IDC_RADIO1,"Button",BS_AUTORADIOBUTTON,7,15,38,10
    CONTROL         "Radio2",IDC_RADIO2,"Button",BS_AUTORADIOBUTTON,7,31,38,10
    CONTROL         "Radio3",IDC_RADIO3,"Button",BS_AUTORADIOBUTTON,7,46,38,10
    PUSHBUTTON      "Button1",IDC_BUTTON1,130,69,50,14
    PUSHBUTTON      "Button2",IDC_BUTTON2,71,69,50,14
    PUSHBUTTON      "Button3",IDC_BUTTON3,7,69,50,14
END 
```

而对应的代码就是这样：

```
#include <Windows.h>
#include "resource.h"

BOOL __stdcall DlgProc(HWND hwnd, UINT uMsg, WPARAM wParam, LPARAM lParam)
{
    switch (uMsg)
    {
        case WM_COMMAND:
        {
            if (LOWORD(wParam) == IDCANCEL || LOWORD(wParam) == IDOK)
            {
                EndDialog(hwnd, 0);
                return 1;
            }
        }
    }
    return 0;
}

int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpcmdline, int nCmdShow)
{
    DialogBox(hInstance, MAKEINTRESOURCE(IDD_DIALOG1), NULL, DlgProc);
    return 0;
} 
```

您可以在以下网址下载整个项目供您使用：[http ://www.selbie.com/dialogapp.zip](http://www.selbie.com/dialogapp.zip)

# objective-c - 代表 AVCaptureVideoDataOutput 和 AVCaptureAudioDataOutput

> ID：14102548
> 
> 赞同：4
> 
> 时间：2012-12-31T14:06:59.497
> 
> 标签：objective-c, ios, xcode

我尝试`CMSampleBufferRef`从两者中获取`AVCaptureVideoDataOutput`和`AVCaptureAudioDataOutput`。

**AVCamRecorder.h**

```
#import <AVFoundation/AVFoundation.h>

@interface AVCamRecorder : NSObject {
}
    @property (nonatomic,retain) AVCaptureVideoDataOutput *videoDataOutput;
    @property (nonatomic,retain) AVCaptureAudioDataOutput *audioDataOutput;

@end 
```

**AVCamRecorder.m**

```
#import "AVCamRecorder.h"
#import <AVFoundation/AVFoundation.h>

@interface AVCamRecorder (VideoDataOutputDelegate) <AVCaptureVideoDataOutputSampleBufferDelegate>
@end
@interface AVCamRecorder (AudioDataOutputDelegate) <AVCaptureAudioDataOutputSampleBufferDelegate>
@end

-(id)initWithSession:(AVCaptureSession *)aSession
{

    self = [super init];
    if (self != nil) {

        //AudioDataoutput
        AVCaptureAudioDataOutput *aAudioDataOutput =  [[AVCaptureAudioDataOutput alloc] init];

        //VideoDataoutput
        AVCaptureVideoDataOutput *aMovieDataOutput = [[AVCaptureVideoDataOutput alloc] init];

        if ([aSession canAddOutput:aAudioDataOutput]) {
            [aSession addOutput:aAudioDataOutput];
        }        
        if ([aSession canAddOutput:aMovieDataOutput]) {
        [aSession addOutput:aMovieDataOutput];
        }

        [aAudioDataOutput setSampleBufferDelegate:self queue:dispatch_get_main_queue()];
        [aMovieDataOutput setSampleBufferDelegate:self queue:dispatch_get_main_queue()];

        [self setAudioDataOutput:aAudioDataOutput];
        [self setVideoDataOutput:aMovieDataOutput];

        [self setSession:aSession];

    }
    return self;
}

@implementation AVCamRecorder (VideoDataOutputDelegate)
- (void)captureOutput:(AVCaptureOutput *)captureOutput
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
       fromConnection:(AVCaptureConnection *)connection
{
    NSLog(@"VideoDataOutputDelegate = %@", captureOutput);
}    
@end

@implementation AVCamRecorder (AudioDataOutputDelegate)
- (void)captureOutput:(AVCaptureOutput *)captureOutput
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
       fromConnection:(AVCaptureConnection *)connection
{
    NSLog(@"AudioDataOutputDelegate = %@", captureOutput);
}
@end 
```

奇怪的是，我在“ `@implementation AVCamRecorder (AudioDataOutputDelegate)`”中得到了视频数据

```
AudioDataOutputDelegate = <AVCaptureVideoDataOutput: 0x208a7df0> 
```

我调换了“ `@implementation AVCamRecorder (VideoDataOutputDelegate)`”和“ `@implementation AVCamRecorder (VideoDataOutputDelegate)`”的顺序，得到了

```
VideoDataOutputDelegate = <AVCaptureVideoDataOutput: 0x208a7df0> 
```

看来我无法设置 2“ `captureOutput:didOutputSampleBuffer:fromConnection:`”。否则，数据进入其中之一。

或者，我是否错误地设置了“ `@implementation AVCamRecorder (VideoDataOutputDelegate)`”和“ `@implementation AVCamRecorder (AudioDataOutputDelegate)`”？

我想我不需要单独的回调，但我只是想知道出了什么问题。

提前谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T17:52:55.583

您在同一类上定义了 2 个类别

```
AVCamRecorder (VideoDataOutputDelegate)
AVCamRecorder (AudioDataOutputDelegate) 
```

声明相同的方法

```
- (void)captureOutput:(AVCaptureOutput *)captureOutput
didOutputSampleBuffer:(CMSampleBufferRef)sampleBuffer
       fromConnection:(AVCaptureConnection *)connection; 
```

这会导致***未定义的行为***。请参阅“使用 Objective-C 编程”指南中的[避免类别方法名称冲突：](http://developer.apple.com/library/ios/#documentation/cocoa/conceptual/ProgrammingWithObjectiveC/CustomizingExistingClasses/CustomizingExistingClasses.html#//apple_ref/doc/uid/TP40011210-CH6-SW4)

> 如果在一个类别中声明的方法的名称与原始类中的方法相同，或者与同一类（甚至超类）上的另一个类别中的方法相同，则行为未定义至使用哪种方法实现运行。
> ...

所以你的设置无法工作。你可以改为

*   定义两个单独的*类*，一个作为音频，一个作为视频代理，
*   定义一个单独的类类别作为音频 + 视频委托（并检查调用它的函数的回调方法），
*   只需将`AVCamRecorder`自己用作音频+视频代表。

# cocoa - 在 Cocoa 中创建 SIMBL 插件

> ID：14102550
> 
> 赞同：0
> 
> 时间：2012-12-31T14:07:17.603
> 
> 标签：cocoa, plugins, nsmenuitem, nsmenu, simbl

我想制作一个非常基本的 SIMBL 插件 - 只需在 Safari 中添加一个新菜单。这是我尝试过的：我将此添加到我的 plist 中：

```
<key>NSPrincipalClass</key>
<string>MySamplePlugin</string>
<key>SIMBLTargetApplications</key>
<array>
    <dict>
        <key>BundleIdentifier</key>
        <string>com.apple.Safari</string>
        <key>MaxBundleVersion</key>
        <string>*</string>
        <key>MinBundleVersion</key>
        <string>*</string>
    </dict>
</array> 
```

然后我创建了 MySamplePlugin 类和 Menu.xib。（所有连接都已建立，这不会是错误）我的 .h

```
-(IBAction)clickAbout:(id)sender;
@property (assign) IBOutlet NSMenu *topMenu; 
```

和我的 .main 文件

```
- (id) init {
self = [super init];
if (! self)
    return nil;

[NSBundle loadNibNamed: @"Menu.xib" owner: self];
return self;
}

- (IBAction) clickAbout: (id) sender {
 NSLog(@"do some stuff here");
}

+ (void) load
{
MySamplePlugin* plugin = [MySamplePlugin sharedInstance];
NSMenuItem* item;

item = [[NSMenuItem alloc] init];
[item setSubmenu: [plugin topMenu]];

[[plugin topMenu] setTitle: @"George"];

[[NSApp mainMenu] addItem: item];

NSLog(@"MySamplePlugin installed");
}

+ (MySamplePlugin*) sharedInstance
{
static MySamplePlugin* plugin = nil;

if (plugin == nil)
    plugin = [[MySamplePlugin alloc] init];

return plugin;
} 
```

知道为什么我的插件不工作吗？它在没有警告的情况下构建，我将其复制到 ~/Library/Application Support/SIMBL/Plugins/

这是我的 console.app 输出：[http ://cl.ly/LsH9](http://cl.ly/LsH9)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:40:29.547

没关系，我通过这个小小的代码修改得到了它：

```
 NSMenu* mainMenu = [NSApp mainMenu];

NSMenu* debugMenu = [[NSMenu alloc] initWithTitle:@"Menu"];
NSMenuItem* newItem = [[NSMenuItem alloc] initWithTitle:@"Item" action:nil keyEquivalent:@""];

[newItem setSubmenu:debugMenu];
[mainMenu addItem:newItem];
[debugMenu addItemWithTitle:@"Run Unit Tests" action:nil keyEquivalent:@""]; 
```

# ruby-on-rails - 为什么我的 heroku 应用程序在资产编译期间尝试连接到数据库？

> ID：14102554
> 
> 赞同：0
> 
> 时间：2012-12-31T14:07:32.100
> 
> 标签：ruby-on-rails, heroku, asset-pipeline

我最近在 Heroku 上放了一个我一直在开发的 Rails 应用程序。当我推送到我的 Heroku git 存储库时，它会运行资产编译作为生成 slug 的一部分。它在这里失败并出现以下错误：

```
could not connect to server: Connection refused
Is the server running on host "127.0.0.1" and accepting
TCP/IP connections on port xxxx? 
```

问题是 rake 任务`rake assets:precompile`正在尝试连接到数据库，而我的应用程序在 slug 编译期间无权访问配置变量。我在 Heroku 的[故障排除文档](https://devcenter.heroku.com/articles/rails3x-asset-pipeline-cedar#troubleshooting)中找到了这些信息，并在我的文件中添加了规定的修复`application.rb`：

```
config.assets.initialize_on_precompile = false 
```

现在我的资产已正确编译，并且我的 gem 供应商/资产中的图像可用。

## 问题

1.  为什么资产编译 rake 任务首先尝试连接到数据库？
2.  Heroku 还允许在本地编译资产并添加到 git 存储库或在运行时。我相信这其他两个选项不会遇到相同的问题，因为它只发生在 slug 编译期间。这两个有什么优势吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:13:45.333

1.  该任务可能会依赖于`:environment`，它将加载您的整个应用程序，包括建立数据库连接的启动代码。

2.  资产预编译旨在缩短请求时间 - rails 不必在每次请求时都编译资产。如果您在本地编译资产，则您使用的是您自己的机器，这很可能比 heroku 环境更快。您可以轻松地使用挂钩自动进行编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:12:31.353

config.initialize_on_precompile 告诉 rake 在资产编译任务期间是否加载完整的 rails 应用程序，包括连接到数据库。至于在本地编译，不，这样做没有多大好处。

# php - php中的语言词存在

> ID：14102565
> 
> 赞同：1
> 
> 时间：2012-12-31T14:08:20.330
> 
> 标签：php, wamp, pspell

我使用 php 扩展 pspell 来识别英文单词的存在，但是，有些组合实际上不是从服务器返回的真实单词。

例如组合“kt”返回“true”，我不知道为什么。

有没有办法“硬化” pspell 中的词汇？如果是这样，我该怎么做？

附魔会带来更好的效果吗？（我正在尝试在我的 wampserver 上启用）。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:53:17.577

从 php 5.3 开始。`Pspell`不再支持/捆绑。相反，您可以使用`enchant`5.3 中默认捆绑的。

Kt 是一个合法的词，只要谷歌它。一种选择是使用[pspell_config_ignore](http://php.net/manual/en/function.pspell-config-ignore.php)忽略非常短的单词。

# soundcloud - 如何访问用户的流？

> ID：14102567
> 
> 赞同：6
> 
> 时间：2012-12-31T14:08:24.367
> 
> 标签：soundcloud

SoundCloud API 的新手。

假设我是注册用户。我上传了几首曲目，当我登录 soundcloud 时它们出现在我的页面上：[https ://soundcloud.com/stream](https://soundcloud.com/stream)

使用 API，我现在可以访问我上传的曲目的数据。

如果我随后关注其他用户，这些用户的曲目也会出现在[https://soundcloud.com/stream](https://soundcloud.com/stream)上。但是，我在 API Docs 中找不到任何方法来访问我的曲目 + 我关注的用户的曲目的数据。有什么办法可以做到这一点？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-05T21:31:37.457

It seems the SoundCloud documentation got updated: the user's activities, quoted as being "the items on the logged in user's dashboard" *can* be fetched. You can even get specific types of items on this Dashboard.

When you process a `GET` request with this URL `$ curl 'https://api.soundcloud.com/me/activities?limit=1&oauth_token=A_VALID_TOKEN'`, you have a JSON or XML file (see at the bottom of the answer) that contains the informations you requested. In this URL, you can replace `/me/activities` by these expressions:

`/me/activities` gives you user's recent activities
`/me/activities/all` is the same as the one above (Recent activities) `/me/activities/tracks/affiliated` is the recent tracks from users the logged-in user follows (the *stream*)
`/me/activities/tracks/exclusive` is recent exclusively shared tracks
`/me/activities/all/own` is recent activities on the logged-in users tracks

JSON responses follow this scheme:

```
{
  "next_href": "https://api.soundcloud.com/...?cursor=81923e19...",
  "collection": [
    {
      "type":       "comment",
      "created_at": "2011/07/21 09:55:19 +0000",
      "tags":       "own, affiliated",
      "origin": {
        ...
      }
    },
    ...
   ]
} 
```

XML responses follow this one:

```
<?xml version="1.0" encoding="UTF-8"?>
<activities next-href="https://api.soundcloud.com/me/activities?cursor=0fc02662-1d76-11e0-8c9a-48ea6afb1384" type="array">
  <activity>
    ...
  </activity>
  ...
</activities> 
```

For deeper and more precise informations about this functionnality, check [SoundCloud's API Reference documentation](http://developers.soundcloud.com/docs/api/reference#activities).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T14:59:41.333

谢谢你的问题。我们目前不为此类混合数据提供公共 API。

# java - RSA 2048 加密解密跳过特殊字符

> ID：14102568
> 
> 赞同：-2
> 
> 时间：2012-12-31T14:08:30.043
> 
> 标签：java, cryptography, base64, rsa

我正在尝试使用带有公钥和私钥的 RSA 2048 加密和解密数据。一切正常，除了一件事，解密的文本没有一些特殊字符。

我尝试了Base64的各种编码和解码方法，但找不到问题

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:26:34.790

你在滥用你的课。

您的类采用**Base64**字符串，而不是任意文本字符串。

显然，您使用的 Base64 解码器会默默地剥离非 base64 字符，而不是抛出异常。

如果您想将此类与任意文本一起使用，则需要使用 Unicode 编码（通常为 UTF-8）将文本转换为字节数组，然后将该字节数组转换为 base64，以便该类可以将其转换回来到一个字节数组。

我建议你直接把类改成字节数组而不是base64字符串；当前的设计具有误导性且毫无意义。

# javascript - 在 JavaScript 中调用/执行后是否需要删除回调函数？

> ID：14102569
> 
> 赞同：3
> 
> 时间：2012-12-31T14:08:44.450
> 
> 标签：javascript, memory-management, callback, garbage-collection, jsonp

我有一个网络应用程序，它定期向 3rd 方服务（比如 Facebook、Twitter 等）轮询数据。此轮询/请求是通过 JSONP 进行的（以避免跨域问题）。

例如，一个简单的请求会是这样的：

```
function jsonp_callback() {
    // Do something
}

var url = 'http://some.service.com/getresult?callback=jsonp_callback';
$http.jsonp(url); 
```

但是，由于可以在任何给定时间发出另一种类型的请求（例如：发送或发布更新），我创建了一个包装器来处理回调。

实现是这样的：

```
// Callback handler
var myCb = (function() {
    var F = function() {};
    F.prototype.fn = {};
    F.prototype.create = function(fn, scope) {
        var self = this;
        var id = new Date().getTime();
        self.fn[id] = function() {
            if (typeof fn === 'function') {
                fn.call(scope);
            }
        }
        return 'myCb.fn.' + id;
    }
    return new F();
})();

// JSONP request
var cb = myCb.create(function() {
    // Do something
});
var url = 'http://some.service.com/getresult?callback=' + cb;
$http.jsonp(url); 
```

如果您注意到，一段时间后，**myCb.fn**将变得臃肿，因为旧的或已经执行的回调。Mu 的问题是，我是否需要创建一种机制来垃圾收集那些已被执行且不再需要的人？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:13:07.657

如果您每页只进行几次调用，则不一定*需要删除旧的回调，但是如果您的页面运行时间很长并且反复进行调用，那么删除它们可能是个好主意。*

“机制”可以很简单

```
delete self.fn[id]; 
```

调用函数后。

# javascript - document.evaluate 使用 iterateNext 返回 null

> ID：14102573
> 
> 赞同：0
> 
> 时间：2012-12-31T14:09:29.347
> 
> 标签：javascript, xml, xpath, document.evaluate

我一直在关注 w3 学校关于使用 xpath 浏览我的 xml 文档的示例，但是我从 iterateNext() 返回的所有内容都是空的。下面是我的 blog.xml 文件。

```
<blog
xmlns ="http://www.w3schools.com" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="blogschema.xsd">
<Title>My blog</Title>

<Entry>
    <Heading id="101">week1</Heading>   
    <body>
        <text>enter text right here</text>
        <pictures>pictures in the body</pictures>

    </body>
    <labels>Seperate labels with commas</labels>
    <date> 20121119</date>

</Entry>

</blog> 
```

这是我的 html 脚本，while 语句永远不会到达，因为结果总是返回 null，这可能是我忽略的东西，但我认为如果它在 w3 学校它应该真的有效。

```
xmlDoc=loadXMLDoc("blog.xml");//loads xml file  
//loadXmlContent(xmlDoc); using xml dom

path="/blog/Title"
if(document.implementation && document.implementation.createDocument)
{

    var nodes = xmlDoc.evaluate(path, xmlDoc, null, 5, null);
    alert(nodes);
    var result = nodes.iterateNext();

    while (result)
    {document.write(result.childNodes[0].nodeValue);}

}
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:05:03.673

输入中有一个默认命名空间声明`xmlns="http://www.w3schools.com"`，您需要考虑例如

```
var nodes = xmlDoc.evaluate("df:blog/df:Title", xmlDoc, function(prefix) { if (prefix === "df") return "http://www.w3schools.com"; }, 5, null);

var result;

while ((result = nodes.iterateNext()) != null)
{
  document.write(result.textContent);
} 
```

# svn - 使用 commit-email.pl 的旧 svn 提交的电子邮件

> ID：14102574
> 
> 赞同：1
> 
> 时间：2012-12-31T14:09:55.710
> 
> 标签：svn, email, commit

由于我们的邮件服务器存在一些问题，我们丢失了一些`svn commit`电子邮件。

有没有办法为那些错过的 svn 提交手动发送电子邮件？

我尝试了以下

```
COMMIT_EMAIL="/usr/share/doc/subversion-1.6.11/tools/hook-scripts/commit-email.pl"
perl  $COMMIT_EMAIL --revprop-change <REPO> <REV> test test --from svnadmin@example.com -r recipient@example.com 
```

但这会返回 0 退出代码，并且不会触发电子邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:23:10.997

对于提交电子邮件，您应该能够手动运行挂钩脚本本身：

```
/path/to/repo/hooks/post-commit /path/to/repo revnum 
```

# php - 如何使用 findAllByPk() 读取数组中具有 ID 的行

> ID：14102577
> 
> 赞同：1
> 
> 时间：2012-12-31T14:10:23.567
> 
> 标签：php, yii

我有一个保存相关帖子 ID 的表。

```
$criteria = new CDbCriteria;
$criteria -> select = 'content_2';
$criteria -> condition = 'content_1=:c';
$criteria -> limit = $count;
$criteria -> params = array(':c' => $id);
$posts_id = SiteContentRelated::model() -> findAll($criteria);

$ids = array();

foreach ($posts_id as $value) {
    $ids[] = intval($value['content_2']);
}

$posts = SiteContent::model()->findAllByPk($ids);

echo '<pre style="direction:ltr;">';
print_r(count($posts));
echo "</pre>";
die(); 
```

结果：

```
1 
```

而且我确定表中的行数（3行）。我的错误在哪里？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-08T12:29:14.300

由于我们不知道您的数据集，您应该先尝试调试：

相比 ：

```
count(SiteContent::model()->findAll()) 
```

和

```
count(SiteContent::model()->findAllByPk($ids)) 
```

如果结果不同，则您的查询不是您想要的。如果它们都不正确，则说明您没有正确的数据集。

其次，您应该使用 var_dump 而不是 print_r 进行调试。Print_r 将布尔值显示为 1 或 0，而不是它们的实际值

# java - Javamail-android 商用

> ID：14102584
> 
> 赞同：0
> 
> 时间：2012-12-31T14:10:56.983
> 
> 标签：java, android, licensing, jakarta-mail, gpl

我有一个想在 Google Play 中销售的应用程序。我的应用程序使用[javamail-android](http://code.google.com/p/javamail-android/)作为反馈表的库。因此，它可以在没有它的情况下轻松运行。[这里](http://code.google.com/p/javamail-android/)写着，源代码在这些许可证下可用：

*   CDDL-1.0
*   GNU GPLv2
*   BSD

这是否意味着我可以选择许可类型？例如，我可以选择 CDDL-1.0 并且不开源我的项目吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:20:42.387

是的; 您可以选择在这三个许可证中的任何一个下使用该库。

但是，您不应该这样做。
从客户端发送电子邮件要求您在应用程序中包含 SMTP 登录，从而允许垃圾邮件发送者窃取登录并发送任意电子邮件。

相反，您应该将包含反馈的 POST 请求发送到您控制的 Web 服务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-04T18:11:07.957

> 当软件是多许可时，接收者可以选择他们想要使用或分发软件的条款。

来源：[http ://en.wikipedia.org/wiki/Multi-licensing](http://en.wikipedia.org/wiki/Multi-licensing)

# php - 使用 phar Stream 写入 PharData 文件

> ID：14102585
> 
> 赞同：13
> 
> 时间：2012-12-31T14:11:02.360
> 
> 标签：php, stream, phar

当我尝试这个时：

```
$phar = new PharData('./phar.tar', 0, null, Phar::TAR);
$phar->addEmptyDir('test');

file_put_contents('phar://./phar.tar/test/foo.txt', 'bar'); 
```

我收到以下错误：

> 警告：file_put_contents(phar://./phar.tar/test/foo.txt)：未能打开流：无法创建 phar './phar.tar'，文件扩展名（或组合）无法识别或目录不存在

我可以使用 file_get_contents 但[file_put_contents 也不应该工作](http://php.net/manual/en/phar.using.stream.php)吗？

* * *

为了让事情变得更奇怪，我尝试了@hakre 在他的评论中提出的想法，它奏效了！

```
$phar = new PharData('./phar.tar', 0, null, Phar::TAR);
$phar->addEmptyDir('test');

if (file_exists('./phar.phar') !== true)
{
    symlink('./phar.tar', './phar.phar');
}

file_put_contents('phar://./phar.phar/test/foo.txt', 'bar');
var_dump(file_get_contents('phar://./phar.tar/test/foo.txt')); // string(3) "bar" 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-23T23:55:10.657

**介绍**

我认为这基本上与您正在处理`Phar::TAR`文件这一事实有关，因为

```
file_put_contents("phar://./test.tar/foo.txt", "hello world");
                                  ^
                                  |+---- Note this tar 
```

退货

> 警告：file_put_contents(phar://./test.tar/foo.txt)：无法打开流：无法创建 phar './test.tar'，无法识别文件扩展名（或组合）或目录不存在

尽管

```
file_put_contents("phar://./test.phar/foo.txt", "hello world"); // Works file
                                  ^
                                  |+---- Note This phar 
```

退货

```
//No Errors 
```

**知道问题**

如果您查看 PHP 文档中的[详细示例](http://www.php.net/manual/en/phar.using.stream.php#103893)，这在过去是一个已知问题，`2 years`给出的示例如下

例子

```
$p = new PharData(dirname(__FILE__) . '/phartest.zip', 0, 'phartest', Phar::ZIP);
$p->addFromString('testfile.txt', 'this is just some test text');

// This works
echo file_get_contents('phar://phartest.zip/testfile.txt');

// This Fails
file_put_contents('phar://phartest.zip/testfile.txt', 'Thist is text for testfile.txt');

$context = stream_context_create(array(
        'phar' => array(
                'compress' => Phar::ZIP
        )
));

// This Fails
file_put_contents('phar://phartest.zip/testfile.txt', 'Thist is text for testfile.txt', 0, $context);

// This works but only with 'r' readonly mode.
$f = fopen('phar://C:\\Inetpub\\wwwroot\\PACT\\test\\phartest.zip\\testfile.txt', 'r'); 
```

**工作选择**

不要使用`.tar`或`.zip`拥有您的文件，而是按照[PHP DOC](http://php.net/manual/en/phar.using.stream.php)`extension`中的说明设置压缩

我是什么意思？

```
$context = stream_context_create(array(
        'phar' => array(
                'compress' => Phar::GZ //set compression
        )
));

file_put_contents('phar://sample.phar/somefile.txt', "Sample Data", 0, $context);
                                   ^
                                   |= Use phar not tar 
```

**建议**

我真的认为你应该坚持`PharData`是可以实现的并且被证明是有效的。唯一的制作方法

**我必须使用 file_put_contents**

然后编写自己的包装器并将其注册到`stream_wrapper_register`这里是一个简单的Prof of Concept

```
stream_wrapper_register("alixphar", "AlixPhar");
file_put_contents('alixphar://phar.tar/test/foo.txt', 'hey'); 
                         ^
                         |+-- Write with alixphar

echo file_get_contents('alixphar://phar.tar/test/foo.txt'),PHP_EOL;
echo file_get_contents('phar://phar.tar/test/foo.txt'),PHP_EOL; 
```

输出

```
hey     <----- alixphar
hey     <----- phar 
```

*注意：这个类不应该在生产中使用......它只是一个示例，并且会失败一些测试用例*

```
class AlixPhar {
    private $pos;
    private $stream;
    private $types;
    private $dir;
    private $pharContainer, $pharType, $pharFile, $pharDir = null;
    private $fp;

    function __construct() {
        $this->types = array(
                "tar" => Phar::TAR,
                "zip" => Phar::ZIP,
                "phar" => Phar::PHAR
        );
        // your phar dir to help avoid using path before the phar file
        $this->dir = __DIR__;
    }

    private function parsePath($path) {
        $url = parse_url($path);
        $this->pharContainer = $url['host'];
        $this->pharType = $this->types[pathinfo($this->pharContainer, PATHINFO_EXTENSION)];
        if (strpos($url['path'], ".") !== false) {
            list($this->pharDir, $this->pharFile, , ) = array_values(pathinfo($url['path']));
        } else {
            $this->pharDir = $url['path'];
        }
    }

    public function stream_open($path, $mode, $options, &$opened_path) {
        $this->parsePath($path);
        $this->stream = new PharData($this->dir . "/" . $this->pharContainer, 0, null, $this->pharType);
        if (! empty($this->pharDir))
            $this->stream->addEmptyDir($this->pharDir);

        if ($mode == "rb") {
            $this->fp = fopen("phar://" . $this->pharContainer . "/" . $this->pharDir . "/" . $this->pharFile, $mode);
        }
        return true;
    }

    public function stream_write($data) {
        $this->pos += strlen($data);
        $this->stream->addFromString($this->pharDir . "/" . $this->pharFile, $data);
        return $this->pos;
    }

    public function stream_read($count) {
        return fread($this->fp, $count);
    }

    public function stream_tell() {
        return ftell($this->fp);
    }

    public function stream_eof() {
        return feof($this->fp);
    }

    public function stream_stat() {
        return fstat($this->fp);
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T13:46:41.227

我有一些答案给你 - 希望这会对你有所帮助。

首先，使用 file_put_contents()，我注意到了一些奇怪之处。首先，我所做的是按照您发布的链接的示例进行操作。我能够添加 $context 变量，但仍然有错误。对我有用的是将文件名更改为 phar.phar。也许 phar:// 处理程序无法理解 .tar 扩展名？

无论如何，这似乎是工作代码 -**但我不推荐它**

```
$context = stream_context_create(array('phar' =>
                                array('compress' => Phar::GZ)),
                                array('metadata' => array('user' => 'cellog')));

file_put_contents('phar://./phar.phar/test/foo.txt', 'bar', 0, $context); 
```

相反，使用它。

**使用我 - 我被推荐**

```
$phar = new PharData('./phar.tar', 0, null, Phar::TAR);
$phar->addEmptyDir('test');
$phar->addFile('./bar', 'foo.txt'); 
```

如果您确实需要使用 file_put_contents() ，也许存在另一个问题，也许我们可以提供帮助。谢谢，祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-04T00:22:58.973

我还有其他一些我认为更整洁的替代方法。他们避免自定义包装器、符号链接或创建额外文件以使用[addFile](http://php.net/manual/en/phar.addfile.php)函数。

**选项 A**

使用与[file_put_contents](http://php.net/manual/en/function.file-put-contents.php)类似的[addFromString](http://php.net/manual/en/phar.addfromstring.php)函数。下面的代码创建一个 TAR 存档，向其中添加一个文件并对其进行压缩。

```
$phar = new PharData("./archive.tar", 0, null, Phar::TAR);
$phar->addFromString('out/fileA.txt','The quick brown fox jumped over the lazy dog');
$phar->compress(Phar::GZ); # Creates archive.tar.gz 
```

**选项 B**

如果您出于某种原因确实需要使用[file_put_contents 。](http://php.net/manual/en/function.file-put-contents.php)您可以使用它创建 PHAR 存档，然后重新打开它并将其转换为另一种存档类型。

```
file_put_contents('phar://archive2.phar/out/fileB.txt', "Colourless green ideas sleep furiously");
$tarphar = new Phar('archive2.phar');
$tar = $tarphar->convertToData(Phar::TAR); # Creates archive2.tar
$zip = $tarphar->convertToData(Phar::ZIP); # Creates archive2.zip
$tgz = $tarphar->convertToData(Phar::TAR, Phar::GZ, '.tar.gz'); # Creates archive2.tar.gz 
```

# wpf - 如何将额外的变量传递给 aa 数据模板

> ID：14102586
> 
> 赞同：0
> 
> 时间：2012-12-31T14:11:05.497
> 
> 标签：wpf

我有一个 DataTemplate（以及两个数据模板），我想将其用作一些基本表单视图模型的视图（包含一个值和布尔值，指示我是否要使用该值）。

我想为单独的表单项多次使用数据模板。我认为正确的方法是将其设置为 ContentControl 的 ContentTemplate （在这种情况下它将具有相同的数据上下文对吗？）但我也想传递标签字符串，因为标签字符串是 ui 的一部分，并且不会改变将它放在 viewmodel 对象中似乎是错误的。如何将标签字符串的访问权限授予 DataTemplate 实例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:39:25.480

就像它的名字一样，a`DataTemplate`用于模板化*数据*......例如，如果你有一个名为的类`MyItem`，它有 a`Name`并且`Value`你希望它以特定的方式显示，你将为 Item 设置一个数据模板并在任何时候使用它需要。

在您的情况下，您说的是非常相似`views`，它们之间只有很小的变化。这个微小的变化（如果我正确理解了你的问题）不是来自模型或视图模型，而是完全面向视图的东西（例如，页面的不同标题）。

如果您计划为每个视图使用不同的视图模型，并且每个视图模型都有不同的用途 - 我认为`Title`向 VM 添加属性并绑定到它没有问题（请记住，MVVM 是一组准则，而不是规则...）

如果您仍然希望将其与视图模型分开，那么您可以使用**[Attached Property](http://msdn.microsoft.com/en-us/library/ms749011.aspx)**。例如，创建一个名为 的附加属性`TemplateTitle`，并让每个视图中的每个内容控件更改它。当然，标签将绑定到该附加属性。

# php - 实时数据更新php+mysql

> ID：14102592
> 
> 赞同：1
> 
> 时间：2012-12-31T14:11:29.287
> 
> 标签：php, mysql, ajax, real-time

我目前正在使用长轮询方法使用 ajax 和 php 循环实时更新数据：

```
function getdata(){
 //database request...
 if(new data){
 echo new data;
 }
 }else{ 
 getdata(); //loop again
 }
} 
```

问题是这种方法需要为每个用户使用一个唯一的 Apache 进程并且占用大量内存，因此我的站点无法处理超过 100 个用户。

还有其他更有效的方法从 mysql 数据库获取实时数据吗？

编辑：我需要为每个循环使用额外的 php 函数 file_get _contents() 来检查数据是否已更改。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:17:28.273

我认为，如果您将为每个用户使用唯一的密钥，则无法解决....例如，只需在每个客户请求上放置一个新的 num，然后使用 DESC 获取最后一个，然后检查新的。

# java - ISO 时间的意外输出 (8601)

> ID：14102593
> 
> 赞同：0
> 
> 时间：2012-12-31T14:11:46.140
> 
> 标签：java, date, iso8601

```
Date now = new Date();
long timeInterval = now.getTime() - (15705 * 24 * 60 * 60 * 1000L);
long hours = timeInterval / (60 * 60 * 1000L);
LOG.debug(String.format("current date:%s, timeInterval:%d,hours:%d",now.toString(),timeInterval, hours)); 
```

系统打印的结果是（15705 表示自 1970 年代以来的天数）：

> 12/12/31 22:06:47 DEBUG stat.TimeTest: 当前日期:Mon Dec 31 22:06:47 CST 2012, timeInterval:50807153, hours:14

您可以看到当前小时为 21 小时，但结果显示为 14 小时。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:15:39.943

`Mon Dec 31 22:06:47 CST 2012`是`Mon Dec 31 14:06:47 2012`GMT 时间，这是用于纪元开始的时区。

换句话说，`now.getTime()`返回自 1970 年 1 月 1 日 00:00:00 GMT 以来的毫秒数，并且您使用不同的时区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:18:31.720

now.getTime() 将为您提供 UTC 毫秒的值 - 那是 GMT+0。您显示的日志打印可能使用系统时区，当时是 22:06:47，可能不在英国附近:-)

另外，请使用[Calendar](http://docs.oracle.com/javase/7/docs/api/java/util/Calendar.html)类进行日期算术运算，因为它与您的代码不同，它会考虑闰年、闰秒和时区变化等因素（在 UTC 中不会发生，在任何其他区域可能会发生）

# relationship - 从表格中提取信息三元组

> ID：14102595
> 
> 赞同：0
> 
> 时间：2012-12-31T14:11:54.067
> 
> 标签：relationship, semantics, ontology, wikipedia

我有一个非常大的 HTML 表数据集（最初从 Wikipedia 中提取）。我想从这些表中提取有意义的tripleSet（这不会与从维基百科信息框中提取三元组相冲突，这是相对容易得多的任务）。

对于人类来说，三元组必须在语义上有意义，而不是像 DBpedia 那样将三元组提取为 URI 和其他格式。所以我可以只提取表格文本值。

请记住桌子方向和形状的多样性。我看到的主要任务是提取表记录的主要实体（例如学校记录中的学生姓名），以便它可以用作三元组的“主题”。

**例子** ![在此处输入图像描述](../Images/e0a0cff060899d526d5b0de6e6c2b75e.png)

对于这样的表，我们应该知道主要实体是“服务器”，其他只是对象，所以关系应该是这样的：

```
<AOLserver> <Developed by> <NaviSoft>.
<AOLserver> <Open Source> <Yes>.
<AOLserver> <Software license> <Mozilla>.
<AOLserver> <Last stable version> <4.5.1>.
<AOLserver> <Release date> <2009-02-02>. 
```

另外，请记住，主要实体并不总是位于表格的第一列，甚至有些表格根本不谈论同一主题。

这是一个表，其中主实体是最后一列而不是第一列：

![在此处输入图像描述](../Images/95504198e6b6956106866c8aa632411f.png)

该表应生成如下关系：

```
<Arsène Wenger> <Position> <Manager>.
<Steve Bould> <Position> <Assistant manager> 
```

**问题**

我的第一个问题是这是否可以使用基于规则的方法来完成，围绕示例制定一些规则并尝试进行概括，以便我可以检测到正确的实体？你能建议示例规则吗？

第二个问题是关于评估，我该如何评估这样的系统？我如何衡量我的表现，以便提高它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-12T09:56:55.633

所以，最后我已经能够实现我的项目的目标，它需要大量的工作和测试，但它实现了。

这个想法主要停留在如下管道中：

1-提取表并将它们导入内存对象的组件

2-排除坏表的组件，这些是在表标签中使用的东西，但它们并不是真正的表（有时页面的编写者想要组织数据外观，所以他们将它们放在表中）

3-剥离表格样式并通过按跨度数重复数据来解决列/行跨度的组件

4-一个基于机器学习的分类器，用于对表格的方向（水平/垂直）和该表格的标题行/列进行分类。

5-一个基于机器学习的分类器，用于对应该是关系三元组的“主题”的行/列进行分类<主题><谓词><对象>

第一个分类器是支持向量机分类器，它采用字符计数、表/行单元格计数比率、数字与文本比率、大写等特征。我们在准确率和召回率上都达到了大约 80~85%

第二个分类器是一个随机森林分类器，它采用与一行/列内的单元格相关性更相关的特征。我们在准确率和召回率方面也达到了大约 85%。

该过程中涉及了一些其他细化组件和启发式方法，以使输出更加清晰并与表格的上下文相关

一般来说，维基百科没有使用额外的数据来使该工具更适用于网络上的任何 html 表格。但是分类器的训练数据主要偏向于维基百科的内容！

完成后，我将使用源代码更新问题代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-11T22:37:07.253

很棒的项目！！如果你让它工作，def尝试将它纳入 dbpedias crawlers/extractors - [http://wiki.dbpedia.org/Documentation](http://wiki.dbpedia.org/Documentation)。

供参考 - [http://en.wikipedia.org/wiki/Comparison_of_web_server_software](http://en.wikipedia.org/wiki/Comparison_of_web_server_software)

如果您查看 HTML，列标题在 thead 元素中，而行都包含在 tbody 元素内的 tr 元素中，实体的标题 (/rdfs:label) 在 th 元素中 - 这应该是很长的路要解决你的问题而不会变得太脏和不精确。

我认为检查 html 结构以查看有多少行元素是值得评估这种方法的。

在第二个示例（[http://en.wikipedia.org/wiki/Arsenal_F.C.](http://en.wikipedia.org/wiki/Arsenal_F.C.)）中，它没有一个thead元素帮助，即。- 允许我们假设页面本身即。阿森纳是表中数据的主体。

还有一些微格式，如关于维基百科的 vcard scatter 可能会阻止阐明这些关系

我不确定它在维基百科的所有表格中的通用性，但应该是一个好的开始。我想尽可能地坚持 html 结构和微格式而不是陷入任何太棘手的事情，这将是非常优越的

另外 - 每个链接都有一个 dbpedia uri 来识别它，这在这些情况下非常有用。例如。[http://example.com/resource/AOLserver](http://example.com/resource/AOLserver) [http://example.com/property/Server](http://example.com/property/Server) [http://dbpedia.org/resource/AOLserver](http://dbpedia.org/resource/AOLserver)。[http://example.com/resource/AOLserver](http://example.com/resource/AOLserver) [http://example.com/property/Developed_by](http://example.com/property/Developed_by) [http://dbpedia.org/resource/NaviSoft](http://dbpedia.org/resource/NaviSoft)。[http://example.com/property/Developed_by](http://example.com/property/Developed_by)一个 rdf:Property。[http://example.com/property/Developed_by](http://example.com/property/Developed_by) rdfs:label "开发者"@en

你见过 - [http://wifo5-03.informatik.uni-mannheim.de/bizer/silk/](http://wifo5-03.informatik.uni-mannheim.de/bizer/silk/) -可能值得生成映射

# mongodb - MongoDB 中的条件 $sum

> ID：14102596
> 
> 赞同：62
> 
> 时间：2012-12-31T14:12:09.387
> 
> 标签：mongodb, mongodb-query, aggregation-framework

我在 mongodb 中的集合类似于 SQL 中的下表：

情绪（公司，情绪）

现在，我需要执行这样的查询：

```
SELECT
  Company, 
  SUM(CASE WHEN Sentiment >0 THEN Sentiment ELSE 0 END) AS SumPosSenti, 
  SUM(CASE WHEN Sentiment <0 THEN Sentiment ELSE 0 END) AS SumNegSenti
FROM Sentiments
GROUP BY Company 
```

我应该怎么做才能在 Mongo 中编写这个查询？我被困在以下查询中：

```
db.Sentiments.aggregate(
{ $project: {_id:0, Company:1, Sentiment: 1} },
{ $group: {_id: "$Company", SumPosSenti: {$sum: ? }, SumNegSenti: {$sum: ? } } }
); 
```

* * *

## 回答 #1

> 赞同：77
> 
> 时间：2012-12-31T14:43:26.460

正如 Sammaye 建议的那样，您需要使用[`$cond`](https://docs.mongodb.com/manual/reference/operator/aggregation/cond)聚合投影运算符来执行此操作：

```
db.Sentiments.aggregate(
    { $project: {
        _id: 0,
        Company: 1,
        PosSentiment: {$cond: [{$gt: ['$Sentiment', 0]}, '$Sentiment', 0]},
        NegSentiment: {$cond: [{$lt: ['$Sentiment', 0]}, '$Sentiment', 0]}
    }},
    { $group: {
        _id: "$Company",
        SumPosSentiment: {$sum: '$PosSentiment'},
        SumNegSentiment: {$sum: '$NegSentiment'}
    }}); 
```

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2016-08-06T07:10:19.100

从 3.4 版本开始，我们可以使用允许在阶段[`$switch`](https://docs.mongodb.com/manual/reference/operator/aggregation/switch/)进行逻辑条件处理的运算符。[`$group`](https://docs.mongodb.com/manual/reference/operator/aggregation/group/)当然，我们仍然需要使用[`$sum`](https://docs.mongodb.com/manual/reference/operator/aggregation/sum)累加器来返回总和。

```
db.Sentiments.aggregate(
    [
        { "$group": { 
            "_id": "$Company",  
            "SumPosSenti": { 
                "$sum": { 
                    "$switch": { 
                        "branches": [ 
                            { 
                                "case": { "$gt": [ "$Sentiment", 0 ] }, 
                                "then": "$Sentiment"
                            }
                        ], 
                        "default": 0 
                    }
                }
            }, 
            "SumNegSenti": {
                "$sum": { 
                    "$switch": { 
                        "branches": [ 
                            { 
                                "case": { "$lt": [ "$Sentiment", 0 ] }, 
                                "then": "$Sentiment"
                            }
                        ], 
                        "default": 0 
                    } 
                }
            }
        }}
    ]
) 
```

* * *

如果您尚未迁移`mongod`到 3.4 或更高版本，请注意此[答案](https://stackoverflow.com/a/14102916/)[`$project`](https://docs.mongodb.com/manual/reference/operator/aggregation/project)中的阶段是多余的，因为运算符返回一个数值，这意味着您可以将文档应用于表达式。[`$cond`](https://docs.mongodb.com/manual/reference/operator/aggregation/cond)[`$group`](https://docs.mongodb.com/manual/reference/operator/aggregation/group/)[`$sum`](https://docs.mongodb.com/manual/reference/operator/aggregation/sum/)`$cond`

这将提高您的应用程序的性能，尤其是对于大型集合。

```
db.Sentiments.aggregate(
    [
        { '$group': {
            '_id': '$Company',
            'PosSentiment': { 
                '$sum': {
                    '$cond': [
                        { '$gt': ['$Sentiment', 0]}, 
                        '$Sentiment', 
                        0
                    ]
                }
            },
            'NegSentiment': { 
                '$sum': {
                    '$cond': [
                        { '$lt': ['$Sentiment', 0]}, 
                        '$Sentiment', 
                        0
                    ]
                }
            }
        }}
    ]
) 
```

* * *

考虑一个包含以下文档的集合 Sentiments：

```
{ "Company": "a", "Sentiment" : 2 }
{ "Company": "a", "Sentiment" : 3 }
{ "Company": "a", "Sentiment" : -1 }
{ "Company": "a", "Sentiment" : -5 } 
```

聚合查询产生：

```
{ "_id" : "a", "SumPosSenti" : 5, "SumNegSenti" : -6 } 
```

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-02-23T21:51:24.317

解释上面的片段，它使用数组语法：

```
PosSentiment: {$cond: [{$gt: ['$Sentiment', 0]}, '$Sentiment', 0]} 
```

等于：

```
PosSentiment: {$cond: { if: {$gt: ['$Sentiment', 0]}, then: '$Sentiment', else: 0} } 
```

数组语法将长语法总结为`{ $cond: [if, then, else] }`

# javascript - facebook sharer.php 错误 chrome

> ID：14102608
> 
> 赞同：2
> 
> 时间：2012-12-31T14:12:44.460
> 
> 标签：javascript, facebook, google-chrome

我正在使用 Facebook 应用程序中的共享按钮。它适用于除 Chrome 之外的所有浏览器。docs.google.com/open?id=0B4wxEQ6Do659WmcwdkN5VlFDZ2s

我检查了 tools->javascript 控制台，我看到我有一个警告：

> [阻止] [https://mywebsite.com上的页面运行来自](https://mywebsite.com)[http://static.ak.fbcdn.net/connect.php/js/FB.Share](http://static.ak.fbcdn.net/connect.php/js/FB.Share)的不安全内容。

此按钮中使用的代码是：

```
<a name="fb_share" type="button" share_url="http://mywebsite.com" href="http://www.facebook.com/sharer.php">Share</a><script src="http://static.ak.fbcdn.net/connect.php/js/FB.Share" type="text/javascript"></script> 
```

谷歌搜索它，Stackoverflowed 它但没有任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:26:16.367

这是因为，您的站点正在使用`https`协议，但由于该脚本位于 http 上，因此 chrome 认为这是一个安全问题。

使用位于**https://facebook.com/connect.php/js/FB.Share的文件的 https 版本**

你应该没事。

# c# - 将对象列表添加到实体数据库

> ID：14102610
> 
> 赞同：3
> 
> 时间：2012-12-31T14:12:53.320
> 
> 标签：c#, entity-framework, lambda

我是 EF 的新手。我从数据库创建了实体模型。

我有表格`CurrencyMaster`([ *FromCurrency* ],[ *ToCurrency* ] ,[ *ActiveStatus* ]) 和`CurrencyConversion`([ *ID* ],[ *FromCurrency* ], [ *ToCurrency* ] ,[ *Date* ],[ *CurrencyFactor* ])

我正在循环`CurrencyMaster`记录，因此`DownloadCurrencyRates`我会得到这些`List<CurrencyRate>`对象。我只想将这些对象添加到实体数据库中。

我尝试过这样的事情

```
public DownloadStatus DownloadUpdateCurrency(DateTime toDate, DateTime fromDate)
{
    CurrencyEntities db = new CurrencyEntities();
    var curMasters = db.CurrencyMasters.Where(x => x.ActiveStatus == 0);
    foreach (var item in curMasters)
    {

        var curcRatesList = DownloadCurrencyRates(fromDate, toDate, 
                                          item.FromCurrency, item.ToCurrency);

        //I know this is a bad code
        curcRatesList.Select(x =>  
                              {   
                                  db.AddToCurrencyConversions(
                                     new CurrencyEntity.CurrencyConversion { 
                                        Date = x.date, 
                                        CurrencyFactor = x.value, 
                                        FromCurrency = item.FromCurrency, 
                                        ToCurrency = item.ToCurrency 
                                      }
                                  ); 
                                  return true; 
                              }); 
    }
    db.SaveChanges();
    return DownloadStatus.DownloadSuccess;
} 
```

我怎样才能以正确的方式做同样的事情？
有什么方法可以在不循环 for 的情况下做到这一点`curcRatesList`？

我正在使用 .NET 3.5，不确定 EF 版本。我没有尝试执行代码（我需要一些其他设置），但我很确定我所做的是不正确的。所以我是在这里发帖。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:41:56.980

程序是正确的。EF 中没有允许在单个方法调用中添加整个实体列表的批量插入功能。您必须遍历这些项目并一一添加。

作为旁注：我只会使用普通`foreach`循环而不是那种奇怪的`Select`技巧（它滥用了该`Select`方法，但它会起作用）。或者 - 如果`curcRatesList`是类型`List<T>`- 您可以使用`Foreach`方法`List<T>`代替`Select`。

# c++ - 单元测试：如何测试返回当前时间的方法

> ID：14102616
> 
> 赞同：1
> 
> 时间：2012-12-31T14:13:45.490
> 
> 标签：c++, unit-testing, epoch

假设我有一个调用的方法`Now`，一旦调用它应该以纪元格式（以毫秒为单位）返回当前时间。是否可以测试这种方法是否返回正确的值？测试这种方法是否有意义？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:24:58.423

此方法很可能只是对标准库的调用的包装。标准库不需要任何测试。您需要测试的只是从标准库中获取某些内容并将其转换为您需要的格式的代码。因此，我建议您将此代码移至单独的方法并通过不向其提供从标准库返回的当前值来测试它，而是提供具有已知正确结果的固定值。

# javascript - 无法使用 Ajax + JSON 调用操作

> ID：14102617
> 
> 赞同：0
> 
> 时间：2012-12-31T14:13:55.160
> 
> 标签：javascript, ajax, json, struts2

在我的`Ajax`请求中，我正在调用这样的动作类：

```
var ajaxRequest;
ajaxRequest = new XMLHttpRequest();
ajaxRequest.open("GET", "../displayProjects.action?userMasterID=" + userMasterDTO.id );
ajaxRequest.send(null); 
```

我`struts.xml`的如下：

```
<package name="default" extends="json-default">
  <action name="displayProjects"
      class="com.activitymanager.action.ExpenseTrackerAction"
      method="doGetProjectDetails">
    <result type="json"/>
  </action>
</package> 
```

我无法使用上面的 JavaScript 调用动作类。我如何让这个工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:33:10.820

您可能希望使用 Jquery 来处理您的 AJAX 调用。请参考这个答案：[Stackoverflow #12137803](https://stackoverflow.com/a/12137803/1762224)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:37:56.110

使用 Firebug 的 Network 选项卡或一些此类工具来查看您发送的 ajax 请求。然后尝试将相同的请求 URL 放入浏览器的地址栏中，看看它是否有效。我的猜测是它与您在 URL 中输入的“../”有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T19:31:34.913

只需输入正确`url`的操作即可

```
ajaxRequest.open("GET", "/displayProjects.action!doGetProjectDetails?userMasterID=" + userMasterDTO.id ); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-02T13:05:38.057

你为什么不使用 Jquery Ajax apis 来进行 ajax 调用。它让事情变得如此简单:) 示例：

```
function Ajaxcall() {

        var xhttp = $.ajax({
            success : function(response) {
                alert("Ajax call was Successful");

            },
            url : "someAction.action",
            type : "POST",
            async : true,
            data : "name=" + str

        });

    } 
```

并且您的 struts.xml 文件需要是这样的：

```
<struts>
    <constant name="struts.enable.DynamicMethodInvocation" value="false" />
    <constant name="struts.devMode" value="false" />

    <package name="default" extends="struts-default,json-default" namespace="/">
<action name="displayProjects"
      class="com.activitymanager.action.ExpenseTrackerAction"
      method="doGetProjectDetails">
    <result name="success" type="json">/path/to/JSP-file/making/ajax/call</result>
  </action>
</package>
</struts> 
```

# svn - 无法将项目文件夹导入本地 svn 存储库

> ID：14102620
> 
> 赞同：0
> 
> 时间：2012-12-31T14:14:05.923
> 
> 标签：svn

我尝试在本地电脑上使用 svn。我创建了本地 svn 存储库。然后为我的项目创建文件夹。尝试将此文件夹添加到 svn 存储库，但得到错误

```
Command: Import E:\Project1 to file:///E:/SVN_new  
Error: Unable to connect to a repository at URL 'file:///E:/SVN_new'  
Error: Unable to open an ra_local session to URL  
Error: Unable to open repository 'file:///E:/SVN_new'  
Completed!: 
```

如何导入 ny 项目文件夹以及 svn 的 url 应该设置什么？

# php - PHP strtotime：获取上个月

> ID：14102625
> 
> 赞同：20
> 
> 时间：2012-12-31T14:14:54.800
> 
> 标签：php, date, strtotime

> **可能重复：**
> [如何使用strtotime和日期获取相对于今天的上个月和上年？](https://stackoverflow.com/questions/5489502/how-to-get-previous-month-and-year-relative-to-today-using-strtotime-and-date)

今天是 12 月 31 日，但`strtotime("-1 months")`返回 12 月：

```
echo date("Y-m", strtotime("-1 months")); 
```

相同的`strtotime("last month")`

如何正确返回上个月（11月）？

测试：[http ://codepad.viper-7.com/XvMaMB](http://codepad.viper-7.com/XvMaMB)

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-12-31T14:17:53.937

```
strtotime("first day of last month") 
```

这`first day of`是[相对格式](http://php.net/datetime.formats.relative)手册页中详述的重要部分。

* * *

示例：[http](http://codepad.viper-7.com/dB35q8) ://codepad.viper-7.com/dB35q8 （硬编码今天的日期）

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-12-31T14:26:22.943

`strtotime("-1 months")`会`2012-11-31`，但没有 11 月 31 日。这是过去的一天`2012-11-30`，它给了`2012-12-01`。当你这样做时，你会看到它

```
echo date("Y-m-d", strtotime("-1 months")); 
```

给出作为输出

> 2012-12-01

见[键盘](http://codepad.org/PxA63tYN)

# android - 按通知打开一个新的 xml 文件

> ID：14102634
> 
> 赞同：0
> 
> 时间：2012-12-31T14:15:49.770
> 
> 标签：android

> 包 com.mmu.mpo；
> 
> 导入android.app.Notification；导入android.app.NotificationManager；导入 android.app.PendingIntent；导入 android.content.BroadcastReceiver；导入android.content.Context；导入android.content.Intent；导入android.net.Uri；导入android.os.Bundle；导入 android.widget.Toast；公共类 AlarmReceiver 扩展 BroadcastReceiver { private static int NOTIFICATION_ID = 1;
> 
> @Override public void onReceive(Context context, Intent intent) {
> 
> ```
>  NotificationManager manger = (NotificationManager) context.getSystemService(Context.NOTIFICATION_SERVICE);      Notification 
> ```
> 
> notification = new Notification(R.drawable.ic_launcher, "Combi Note", System.currentTimeMillis());
> 
> ```
>  PendingIntent contentIntent = PendingIntent.getActivity(context, NOTIFICATION_ID, new Intent(context, AlarmReceiver.class), 0);
>           Bundle extras=intent.getExtras();       String title=extras.getString("title");         String 
> ```
> 
> note=extras.getString("note");
> 
> ```
>  notification.setLatestEventInfo(context, title, "Venue : " + note, contentIntent);      //notification.flags = 
> ```
> 
> Notification.FLAG_INSISTENT；notification.defaults |= Notification.DEFAULT_SOUND;
> 
> ```
>  manger.notify(NOTIFICATION_ID++, notification);
> 
>       }
> 
>  }; 
> ```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:44:32.777

试试这是否有帮助！

```
Context context = getApplicationContext();

CharSequence contentTitle = "Notification";

CharSequence contentText = "New Notification";

final Notification notifyDetails = new Notification(R.drawable.icon, "Consider yourself notified", System.currentTimeMillis());

Intent notifyIntent = new Intent(context, YourActivity.class);

PendingIntent intent = PendingIntent.getActivity(context, 0, notifyIntent,  PendingIntent.FLAG_UPDATE_CURRENT | Notification.FLAG_AUTO_CANCEL);

notifyDetails.setLatestEventInfo(context, contentTitle, contentText, intent);

((NotificationManager)getSystemService(NOTIFICATION_SERVICE)).notify(NOTIFICATION_ID, notifyDetails); 
```

# asp.net - 如何获得对 trace.axd 的请求以返回 404？

> ID：14102635
> 
> 赞同：5
> 
> 时间：2012-12-31T14:15:59.400
> 
> 标签：asp.net, iis, webforms, iis-7.5

在我的生产环境中，我想将所有请求重定向到 /trace.axd 以返回 HTTP 404。目前，默认的 HTTP 500 正在返回。这会在我们的分析工具中产生各种不必要的噪音。环境是 IIS 7.5 上的 ASP.NET 4.0 Web 表单。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-03-04T12:27:43.517

删除 Web.config 文件中的跟踪 HTTP 处理程序：

```
 <system.webServer>
    <!-- remove TraceHandler-Integrated - Remove the tracing handlers so that navigating to /trace.axd gives us a 
         404 Not Found instead of 500 Internal Server Error. -->
    <handlers>
      <remove name="TraceHandler-Integrated" />
      <remove name="TraceHandler-Integrated-4.0" />
    </handlers>
  </system.webServer> 
```

导航到 /trace.axd 现在给我们一个 404 Not Found 而不是 500 Internal Server Error。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-03T22:08:50.033

我首先想到的是在以下位置拦截[BeginRequest](http://msdn.microsoft.com/en-us/library/system.web.httpapplication.beginrequest%28v=vs.100%29.aspx)事件`global.asax`：

```
protected void Application_BeginRequest()
{
    // assuming that in your production environment debugging is off
    if (!HttpContext.Current.IsDebuggingEnabled && Request.RawUrl.Contains("trace.axd"))
    {
        HttpContext.Current.Response.StatusCode = 404;
        HttpContext.Current.Response.End();
        // or alternatively throw HttpException like this:
        // throw new HttpException(404, "");
    }
} 
```

# android - if 和广播接收器

> ID：14102636
> 
> 赞同：0
> 
> 时间：2012-12-31T14:16:04.310
> 
> 标签：android

在 BroadcastReceiver 类中，我有这段代码，但我不明白为什么第一次通知不运行。如果我删除 if 循环，alarmmanager 会完美运行。价值观也还可以（我有一个向我展示的祝酒词）。是“如果”问题吗？

```
CheckboxPreference = prefs.getBoolean("checkboxPref", true);
    notify = prefs.getString("notify", "");

if (CheckboxPreference){
        if (notify.equals("1")){
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
        }
        if (notify.equals("2")){
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal3.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, eveningAlarm);
        }
        if (notify.equals("3")){
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal2.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, middleAlarm);
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal3.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, eveningAlarm);
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:59:09.097

你应该`if`用`else`. `else`如果您点击's ，则记录错误

还要检查您的所有条件，例如CheckBoxPreference`if`的值是什么。`notify`这应该可以帮助您自己调试代码。

```
 if (CheckboxPreference){
        if (notify.equals("1")){
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
        }

        else if (notify.equals("2")){
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal3.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, eveningAlarm);
        }
        else if (notify.equals("3")){
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal1.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, morningAlarm);
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal2.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, middleAlarm);
            alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, cal3.getTimeInMillis(), DateUtils.DAY_IN_MILLIS, eveningAlarm);
        }
        else {
           // Log something
        }
    }  
    else {
       // Log CheckBoxPref false

    } 
```

# multithreading - Python中的简单多线程

> ID：14102642
> 
> 赞同：1
> 
> 时间：2012-12-31T14:17:06.083
> 
> 标签：multithreading, python-3.x

我是 python 新手，尝试同时执行两个任务。这些任务只是在 Web 服务器上获取页面，一个可以先于另一个终止。我只想在所有请求都得到处理时才显示结果。在 linux shell 中很容易，但我对 python 毫无用处，而且我读到的所有方法对于像我这样的初学者来说都像是黑魔法。与下面的 bash 脚本的简单性相比，它们在我看来都过于复杂。

这是我想在 python 中模拟的 bash 脚本：

```
# First request (in background). Result stored in file /tmp/p1
wget -q -O /tmp/p1 "http://ursule/test/test.php?p=1&w=5" &
PID_1=$!

# Second request. Result stored in file /tmp/p2
wget -q -O /tmp/p2 "http://ursule/test/test.php?p=2&w=2"
PID_2=$!

# Wait for the two processes to terminate before displaying the result
wait $PID_1 && wait $PID_2 && cat /tmp/p1 /tmp/p2 
```

test.php脚本**很**简单：

```
<?php
printf('Process %s (sleep %s) started at %s ', $_GET['p'], $_GET['w'], date("H:i:s"));
sleep($_GET['w']);
printf('finished at %s', date("H:i:s"));
?> 
```

bash 脚本返回以下内容：

```
$ ./multiThread.sh
Process 1 (sleep 5) started at 15:12:59 finished at 15:12:04
Process 2 (sleep 2) started at 15:12:59 finished at 15:12:01 
```

到目前为止我在 python 3 中尝试过的内容：

```
#!/usr/bin/python3.2

import urllib.request, threading

def wget (address):
    url = urllib.request.urlopen(address)
    mybytes = url.read()
    mystr = mybytes.decode("latin_1")
    print(mystr)
    url.close()

thread1 = threading.Thread(None, wget, None, ("http://ursule/test/test.php?p=1&w=5",))
thread2 = threading.Thread(None, wget, None, ("http://ursule/test/test.php?p=1&w=2",))

thread1.run()
thread2.run() 
```

这在返回时无法按预期工作：

```
$ ./c.py 
Process 1 (sleep 5) started at 15:12:58 finished at 15:13:03
Process 1 (sleep 2) started at 15:13:03 finished at 15:13:05 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T08:16:23.800

与其使用线程，不如使用多处理模块作为独立的每个任务。您可能想阅读有关 GIL 的更多信息 (http://wiki.python.org/moin/GlobalInterpreterLock)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T20:21:30.487

根据您的建议，我深入研究了有关多线程和多处理的文档页面，并且在完成了几个基准测试之后，我得出的结论是多处理更适合这项工作。随着线程/进程数量的增加，它可以更好地扩展。我面临的另一个问题是如何存储所有这些过程的结果。使用 Queue.Queue 就可以了。这是我想出的解决方案：

此代码段将并发 http 请求发送到我的测试平台，该请求在发送 anwser 之前暂停一秒钟（请参阅上面的 php 脚本）。

```
import urllib.request

# function wget arg(queue, adresse)
def wget (resultQueue, address):
    url = urllib.request.urlopen(address)
    mybytes = url.read()
    url.close()
    resultQueue.put(mybytes.decode("latin_1"))

numberOfProcesses = 20

from multiprocessing import Process, Queue

# initialisation
proc = []
results = []
resultQueue = Queue()

# creation of the processes and their result queue
for i in range(numberOfProcesses):
    # The url just passes the process number (p) to the my testing web-server
    proc.append(Process(target=wget, args=(resultQueue, "http://ursule/test/test.php?p="+str(i)+"&w=1",)))
    proc[i].start()

# Wait for a process to terminate and get its result from the queue
for i in range(numberOfProcesses):
    proc[i].join()
    results.append(resultQueue.get())

# display results
for result in results:
    print(result) 
```

# php - MongoDB Yii 和 URL 管理器

> ID：14102644
> 
> 赞同：0
> 
> 时间：2012-12-31T14:17:23.533
> 
> 标签：php, mongodb, yii

我在使用 MongoID 和 Yii 中的 url 管理器时遇到了一些麻烦。

如果我有这样的网址：

```
http://www.example.com/article/1 
```

或者

```
http://www.example.com/article/view/1 
```

一切正常。现在解决问题。我正在使用 MongoDB，所以我的网址如下所示：

```
http://www.example.com/article/50e18c655b0c4dce75000033 
```

或者

> [http://www.example.com/article/view/50e18c655b0c4dce75000033](http://www.example.com/article/view/50e18c655b0c4dce75000033)

并且每个场景都会抛出 404 not found 错误，就像它无法进入 actionView。我在配置中的 url 管理器如下所示：

```
'urlManager'=>array(
            'urlFormat'=>'path',
            'rules'=>array(
                '<controller:\w+>/<id:\d+>'=>'<controller>/view',
                '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>/<id:\d+>/<cid:\d+>'=>'<controller>/<action>',
            ),
        ), 
```

我做错了什么，如何让 MongoID 注册为 id？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T19:37:07.080

有同样的问题。我的情况是邀请系统，准确地规则十六进制非常重要，因为我也有 InviteController。

```
'invite/<invite_key:[a-fA-F0-9-]+>'=>'site/invite', 
```

在你的情况下，我想它应该是这样的

```
'urlManager'=>array(
            'urlFormat'=>'path',
            'rules'=>array(
                '<controller:\w+>/<id:\d+>'=>'<controller>/view',
                '<controller:\w+>/<action:\w+>/<id:\d+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>/<id:[a-fA-F0-9-]+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>'=>'<controller>/<action>',
                '<controller:\w+>/<action:\w+>/<id:\d+>/<cid:\d+>'=>'<controller>/<action>',
            ),
        ), 
```

也许您应该更改`<id:[a-fA-F0-9-]+>`为`<cid:[a-fA-F0-9-]+>`，我真的不知道您的控制器是如何工作的。

我希望你早一点找到解决方案。但是谷歌在这里指出了几个请求。

# r - 用户在 r 中拥有 pch（剪辑）

> ID：14102655
> 
> 赞同：11
> 
> 时间：2012-12-31T14:18:57.273
> 
> 标签：r, plot, ggplot2, pch

> **可能重复：**
> [如何使用图像作为 ggplot 中的一个点？](https://stackoverflow.com/questions/2181902/how-to-use-an-image-as-a-point-in-ggplot)

是否可以将用户定义的 pch（剪贴画或图标或其他类型的文件）用作 R 基础或 ggplot 或其他图形设备中的点。

例如：

![在此处输入图像描述](../Images/1212e6b44b31436bb00d0503910fb71c.png)

```
set.seed(123)
mydt <- data.frame (x = rnorm(5, 5,2), y = rnorm (5,10,3), z = rnorm (5, 1,0.5)) 
```

![在此处输入图像描述](../Images/3613d893bedecd0ff706326b1435f1d9.png)

这里大小与 z 成正比。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-31T15:45:49.813

使用`grid.raster`

```
library(png)
flower <- readPNG("flower.png")
pushViewport(plotViewport(margins=c(5,5,5,5)))
grid.rect(gp = gpar(fill=NA))
pushViewport(plotViewport(margins=c(5,5,5,5),
                          xscale=extendrange(mydt$x),
                          yscale=extendrange(mydt$y)))

grid.raster(image=flower,x=mydt$x,y=mydt$y,width=mydt$z, 
                interpolate=FALSE,default.units = 'native')
grid.polyline(mydt$x,mydt$y,default.units='native')
upViewport(2) 
```

![在此处输入图像描述](../Images/2d2df4cbb1d6eef15c74b2136b783aa4.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-31T18:38:51.680

对于基本图形，请查看 TeachingDemos 包中的`my.symbols`和`ms.image`函数。

# c# - 无法从 aspx 页面中的代码访问变量

> ID：14102659
> 
> 赞同：1
> 
> 时间：2012-12-31T14:19:21.440
> 
> 标签：c#, asp.net, asp.net-mvc

我在变量名后面的代码中声明了一个变量，它是 int 类型的进度条

要在同一个 asp.net 页面中访问此变量，我正在使用此代码

```
 <table align="center" border="1" cellpadding="0" cellspacing="0" frame="border" 
        style="border-color: #FF0000" width="100%">
    <tr>
        <td bgcolor="#FF0066" colspan="0" rowspan="0" width="<%= progressbar %>%">
            &nbsp;</td>
        <td colspan="0" rowspan="0">
            &nbsp;</td>
    </tr> 
```

我两者都使用过`<%= progressbar %>`，`<%# progressbar %>`但无法访问此变量。
你能告诉我如何从后面的 c# 代码访问这个变量到 asp.net 页面吗

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:26:52.470

1.  确保您尝试访问的变量不是私有的

2.  您应该可以像这样访问它`<%= progressbar %>`

在课堂上写

```
public int progressbar = 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:22:02.633

C# 中的所有变量都是局部变量，它们只在声明它们的函数中可见。将你的东西设为字段或属性，并确保它是`protected`or 或`public`.

# networking - Aptana Studio 3 - 本地网络上的项目

> ID：14102663
> 
> 赞同：0
> 
> 时间：2012-12-31T14:19:35.937
> 
> 标签：networking, debian, aptana

我安装了 Aptana Studio 3，在本地网络上导入项目时遇到问题。示例：我们有 2 台计算机，第一台是包含所有文件的服务器。php项目创建了一些。我想打开在本地网络中创建的这个项目。谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:57:04.353

您可以通过创建一个新项目并将 Aptana Studio 指向现有项目的主目录，将一组现有文件导入 Aptana Studio。参考[这里](https://wiki.appcelerator.org/display/tis/Importing+an+Existing+Project)

**使用导入向导**

要将现有项目导入 Studio：

1.  从**File**菜单中，选择**Import... > Existing Folder as New Project**。
2.  在**目录**文本字段中，浏览到包含您的 Dreamweaver 或 HomeSite 项目的文件夹。
3.  为您的项目命名。
4.  为您的项目选择性质。在几乎所有情况下，您都需要选择 Web，以及您的项目类型（PHP、Rails 等）
5.  单击**完成**按钮。

* * *

**使用提升到项目**

将文件夹提升为项目允许您获取磁盘上的任何文件夹并将其转换为项目。您将在工作区中看到该项目，但文件位于磁盘上的前一个位置。

1.  打开项目资源管理器视图。
2.  将本地文件系统节点展开到相关文件夹。
3.  选择**提升到项目**。
4.  适当地命名您的项目，然后单击**OK**。
5.  根据项目的类型，您可能需要更改与项目关联的“性质”。

* * *

**使用源代码控制系统**

如果您使用它，您还可以从源代码控制系统导入项目。[原生支持CVS](https://wiki.appcelerator.org/display/tis/CVS)、[Git](https://wiki.appcelerator.org/display/tis/Git)、[Mercurial](https://wiki.appcelerator.org/display/tis/Mercurial)、[Perforce](https://wiki.appcelerator.org/display/tis/Perforce)和[Subversion](https://wiki.appcelerator.org/display/tis/Subversion)。（单击链接以获取每个源代码控制系统的具体说明）

使用特定插件可以支持其他源代码控制系统。例如使用[BzrEclipse的](http://wiki.bazaar.canonical.com/BzrEclipse)[Bazaar](http://bazaar.canonical.com/)（感谢 mutil）

# sql - 使用多个表从数据库中获取正确的 ID

> ID：14102664
> 
> 赞同：1
> 
> 时间：2012-12-31T14:19:37.403
> 
> 标签：sql, multiple-tables

我有这个 SQL 查询来获取特定类别中的所有博客文章：

```
SELECT * FROM blogposts AS bp, blogpost_categories AS bpc
WHERE bpc.id_category = '3'
AND bpc.id_blogpost = bp.id
ORDER BY bp.date_published DESC 
```

问题是，当我获取博客文章的 ID 号时，我得到的是类别 ID 号，这是错误的。

我该如何解决这个问题？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:21:39.640

指定您想要的 ID（fe`bp.id`或`bpc.id`.）并考虑使用 a`join`来澄清查询：

```
SELECT  bp.id as BlogPostId
,       bpc.id as CategoryId
FROM    blogposts AS bp
JOIN    blogpost_categories AS bpc
ON      bpc.id_blogpost = bp.id
WHERE   bpc.id_category = '3' 
```

# uiview - 使用 CALayer 的 UIView 动画暂停恢复在方向更改时冻结用户交互

> ID：14102669
> 
> 赞同：1
> 
> 时间：2012-12-31T14:19:57.317
> 
> 标签：uiview, uiinterfaceorientation, uiviewanimation

我正在实施以下解决方案来暂停 UIView 动画：

[https://stackoverflow.com/a/3003922/1014164](https://stackoverflow.com/a/3003922/1014164)

暂停和恢复动画正在工作，但是：

在我暂停动画并继续旋转我的设备后，屏幕上的其他视图开始调整大小，但由于某种原因，这会冻结屏幕上的所有交互和视图 - 方向更改不再起作用，按钮无响应.

但是，如果我在动画运动时旋转设备，则一切正常。

我进行的另一项测试是取消外部视图的自动调整大小，其中包含动画视图，这可以让事情正常工作。

暂停的图层和父图层的自动调整大小之间似乎存在一些冲突。我只是不知道如何绕过它。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-11T15:35:00.603

正如您所发现的，视图层被暂停的事实意味着当您旋转设备时它无法动画到新的大小，这会冻结 UI。

然而，有一个更干净的解决方案不会放弃 iOS 的漂亮的调整大小动画或自动布局。您可以在根层下方创建一个中间层，并将所有其他层放在其下。然后你应该使用这个中间层来控制动画的速度（或暂停它们）。

由于 iOS 不会在设备旋转时调整子图层的大小，因此图层暂停并不重要。

（我意识到这个答案很晚，但它可能仍然为某人服务）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-08T16:00:08.867

由于方向更改会导致使用其他视图上的动画，因此我必须禁用这些视图的自动调整大小遮罩，从而避免在暂停动画时发生冲突。那些正在自动调整大小的视图在方向通知方法中手动调整大小。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-02-03T12:45:46.533

在@tarmes 的后续行动中，您还可以尝试以下操作：

```
override func viewWillTransitionToSize(size: CGSize, withTransitionCoordinator coordinator: UIViewControllerTransitionCoordinator)
{
    super.viewWillTransitionToSize(size, withTransitionCoordinator: coordinator)

    if let myView = self.view
    {
        let currentLayerSpeed = myView.layer.speed

        coordinator.animateAlongsideTransition(
        {
            (context) -> Void in

            // Animating alongside… nothing to animate.
            if currentLayerSpeed == 0
            {
                myView.layer.speed = 1.0
            }
        })
        {
            // Completion
            (context) -> Void in

            // Rotation animation completed – resetting the layer speed
            myView.layer.speed = currentLayerSpeed
        }
    }
} 
```

# session - 如何识别没有登录信息的重访用户

> ID：14102670
> 
> 赞同：4
> 
> 时间：2012-12-31T14:20:03.413
> 
> 标签：session, cookies, machine-learning, artificial-intelligence

我想为我的网站创建一个推荐引擎。假设用户访问我的网站。我想向他推荐他可以查看的其他产品。我可以创建一个推荐引擎。但是，如何找到模式？我的想法是，如果我可以通过任何方式知道用户浏览了哪些产品，我可以在其中找到一个模式并建议给另一个用户。但是，这种信息跟踪是否可以在不让用户登录的情况下进行？跟踪 IP 地址可能是一种方式，但 IP 可能是动态的。我听说过饼干。请帮我。有没有这方面的 API？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-15T10:57:34.453

设置 cookie 非常简单。根据我的经验，设置它们的最简单方法是通过[JQuery](http://jquery.com/)插件：[jquery-cookie](https://github.com/carhartl/jquery-cookie)。

对于您的任务，您可以在用户第一次打开您的网站时设置一个具有随机*几乎唯一*ID 的 cookie（查看[此问题以了解如何操作）。](https://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript)例如

```
$.cookie('user_id', 'the_random_id'); 
```

当用户回来时，您可以读取该值

```
user_id = $.cookie('user_id') 
```

并在您的数据库中检查有关该用户的相关信息。

显然，如果用户不接受 cookie 或删除它们，您将无法识别他。

# java - 在 Python 和 Groovy 之间传输简单对象

> ID：14102674
> 
> 赞同：0
> 
> 时间：2012-12-31T14:20:22.107
> 
> 标签：java, python, groovy, python-3.x, python-2.7

可以使用序列化/反序列化（pickle/marshal/shelve）在两个 Python 进程之间传输对象，在 Groovy/Java 进程之间也可以实现同样的事情。

大多数简单的 Python 和 Groovy 数据结构，如列表、字典、字符串、整数，甚至文件对象，都可以以某种通用的序列化格式进行序列化，并从 Python 传输到 Groovy 进程，反之亦然。

我的问题：是否有任何 Groovy 模块可以解释 Python 腌制对象流并在 Groovy 中重新创建简单的数据结构，或者任何可以解释 Groovy 序列化对象流的 Python 模块？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:26:29.683

我认为没有用于阅读“对面”格式的库（但也许我错了），特别是如果您要（反）序列化复杂的特定于语言的对象（如文件）。

我建议寻找一些成熟的跨语言解决方案，例如[Thrift](http://thrift.apache.org/)或[Protocol Buffers](http://code.google.com/p/protobuf/)，或者简化通信协议并使用 JSON 等简单的东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:34:34.660

我建议使用 Google Protocol Buffers，因为它现在在行业中被广泛使用。

甚至，我在 Perl 序列化对象和 Java 对象之间使用相同的通信，反之亦然。

[ProtoBuf RPC 示例](https://github.com/orbekk/protobuf-simple-rpc/tree/master/src)

[协议缓冲区 Java 教程](https://developers.google.com/protocol-buffers/docs/javatutorial)

# c# - 中继器中的条件加载

> ID：14102677
> 
> 赞同：1
> 
> 时间：2012-12-31T14:21:10.337
> 
> 标签：c#, asp.net, repeater, asprepeater

在我的中继器中，我必须根据某些条件加载 4 个不同图像中的 2 个。

这里有 4 张图片

```
if (<%# DataBinder.Eval(Container.DataItem, "Voted") %> == "true") 'load these 2 images
    <img style="cursor: pointer" onclick="Dostuff"
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/badge-circle-plus-24-ns.png" />
    <img style="cursor: pointer" onclick="Dostuff"
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/arrow-down-24-ns.png" />
else 'load these 2 
    <img style="cursor: pointer" onclick="Dostuff" 
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/arrow-up-24-ns.png"  />
    <img style="cursor: pointer" onclick="Dostuff"
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/arrow-down-24-ns.png"  /> 
```

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T16:27:43.557

你可以; [有关更多信息](http://forums.asp.net/t/1509415.aspx/1)，请参阅此内容。本质上，您应该将其格式化为：

```
<% if (DataBinder.Eval(Container.DataItem, "Voted")  == "true") {  %>
    <img style="cursor: pointer" onclick="Dostuff"
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/badge-circle-plus-24-ns.png" />
    <img style="cursor: pointer" onclick="Dostuff"
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/arrow-down-24-ns.png" />
<% } else { %>
    <img style="cursor: pointer" onclick="Dostuff" 
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/arrow-up-24-ns.png"  />
    <img style="cursor: pointer" onclick="Dostuff"
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src="../../Images/arrow-down-24-ns.png"  />
<% } %> 
```

我不确定这是否完全受支持，因此您也可以考虑尝试：

```
<img style="cursor: pointer" onclick="Dostuff"
         id='<%# DataBinder.Eval(Container.DataItem, "Uid") %>'
         src='../../Images/<%# DataBinder.Eval(Container.DataItem, "Voted")  == "true" ? "badge-circle-plus-24-ns.png" : "arrow-up-24-ns.png" %>' />
  .
  . 
```

后者使用条件并根据条件渲染适当的图像。

# c++ - 在这种情况下，哪种索引方式最合适？

> ID：14102678
> 
> 赞同：0
> 
> 时间：2012-12-31T14:21:16.133
> 
> 标签：c++, pointers

你能告诉我哪个功能会更快吗？或者也许他们都错了，你知道更好的方法来做到这一点。提前致谢。

```
double* solveDiagonal(double* A, double* B, int n)
{
    double* X = new double[n];

    for(int i = 0; i < n; i++)
        X[i] = B[i] / A[i*n + i];

    return X;
}

double* solveDiagonal(double* A, double* B, int n)
{
    double* X = new double[n];
    double** pA = new double*[n];

    for(int i = 0; i < n; i++)
        pA[i] = &A[i*n];

    for(int i = 0; i < n; i++)
        X[i] = B[i] / pA[i][i];

    delete [] pA;

    return X;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:28:13.313

虽然我猜第二个由于更多的间接和分配而速度较慢，但​​您确实需要测试和配置文件才能回答此类问题。

# iphone - appDelegate 和 ViewControllers

> ID：14102680
> 
> 赞同：1
> 
> 时间：2012-12-31T14:21:23.293
> 
> 标签：iphone, objective-c, ios, uitableview

我是 Objective-C 的新手，我想知道我的方法是否有意义。

我的应用程序是基于选项卡视图的。每个选项卡都会调用对服务器的请求。

1.  在我`appDelegate`的服务器中，我创建了一个异步套接字连接实例。
2.  我单击“获取状态”选项卡，该选项卡加载了`TableViewController`我需要在其中创建内部请求消息并将其发送到服务器。
3.  我的问题是我无法访问 中的套接字`TableViewController`，所以我可以通过`appDelegate sharedApplication`然后将请求消息发送到服务器来访问套接字。

4.  由于我使用异步套接字模型，接收服务器响应的委托就是它`appDelegate`本身，现在我需要以某种方式将响应传播回 "Get status" `TableViewController`。

我的问题是如何做到这一点？

也许我的方法不好开始，我需要使用同步套接字模型。或者我可能需要将套接字连接作为上下文传递给我打开的每个视图控制器。

我错过了什么？？我怎样才能从我发送它的视图中轻松访问对服务器的响应？任何帮助，将不胜感激！！

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:59:44.843

我建议一个不同的设计。发出请求的东西应该是任何 VC 都可以实例化并用来发出请求的类，可能是 NSURLRequest 的子类。

因为它是一个单例，所以很容易让应用程序委托一个全局数据和行为的持有者，但这不是它的工作。

如果你对服务器请求有很多自定义工作要做，请子类化 NSURLRequest。使用 NSURLConnection 的 sendAsynchronousRequest: 方法运行它。它允许调用者在完成时传递一个块以执行请求结果。

例如 MyRequest.h

```
@interface MyRequest : NSMutableURLRequest
- (id)initWithParams:(NSDictionary *)params;
- (void)runWithCompletion:(void (^)(id result, NSError *error))completion;
@end 
```

例如 MyRequest.m

```
@implementation MyRequest

- (id)initWithParams:(NSDictionary *)params {

    self = [self init];
    if (self) {
        // do custom init here, e.g.
        self.URL = @"http://www.myservice.com/myrequest.json"
        [self setValue:@"bar" forHTTPHeaderField:@"foo"];      // more realistically, using key value pairs in the params dictionary
        // and so on
    }
    return self;
}

- (void)runWithCompletion:(void (^)(id result, NSError *error))completion {

    [NSURLConnection sendAsynchronousRequest:self
                                       queue:[NSOperationQueue mainQueue]
                           completionHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                               if (data) {
                                   // do something custom with the received data here,
                                   // like convert to a string and parse as json, etc.
                                   completion(data, nil);
                               } else {
                                   completion(nil, error);
                               }
                           }];
}

@end 
```

现在，任何 VC——或任何其他类——都可以创建其中一个并使用它：

```
// in MyVC.m

MyRequest *myRequest = [[MyRequest alloc] initWithParams:[NSDictionary dictionary]];
[myRequest runWithCompletion:^(id result, NSError *error) {
    // do main thread ui stuff with the result in hand, e.g.
    [self.tableView reloadData];
}]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:53:52.930

我同意 Talha 对此的评论，不建议使用通知中心。最好创建一个从 NSObject 继承的新类来处理套接字事件，但如果需要，您也可以仅使用应用程序委托使其工作。为了方便您...

创建从套接字类到视图控制器的链接

在两个文件都可以看到的地方定义 TableViewSocketEventsDelegate。您可以创建一个公共的 Constants.h 或其他东西。

```
@protocol TableViewSocketEventsDelegate <NSObject>

@required
- (void) someSocketEvent:(int)statusCode;
//TODO: Add callbacks that make sense here
@end 
```

为套接字类（在您的情况下为应用程序委托 .h 文件）提供对最终处理操作的内容（在您的情况下为表视图控制器）的引用

```
@property (nonatomic, assign) id<TableViewSocketEventsDelegate> socketDelegate; 
```

并且在 .m 中一定要合成 socketDelegate 并将其分配给适当的视图控制器。

接下来告诉视图控制器它可以处理这些委托回调。

在.h中：

```
ViewController : UITableViewController<TableViewSocketEventsDelegate> 
```

以 .m 为单位：

```
#pragma mark - TableViewSocketEventsDelegate

- (void) someSocketEvent:(int)statusCode
{
    NSLog(@"Some socket event happened %I", statusCode);
} 
```

现在您所要做的就是更改应用程序委托中处理套接字的现有方法以调用新方法

```
if (self.socketDelegate) {
        [self.socketDelegate someSocketEvent:2];
    } 
```

这对你有意义吗？如果它们都需要处理同一个委托，我还建议为所有选项卡视图控制器创建一个基类。

祝你好运！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:35:44.123

您可以让您的代理人在通知中心发布通知。然后您的表视图控制器注册到该通知，它可以接收信息。

就像是

**在您的 AppDelegate**中，当接收到套接字响应时

```
NSDictionary * userInfo = @{@"socketResponse" : response}; // assuming that response is the object to pass around
[[NSNotificationCenter defaultCenter] postNotificationName:@"kDidReceiveSocketResponse"
                                                    object:self
                                                  userInfo:userInfo 
```

**在你的 UITableViewController**

```
- (void)viewDidLoad {
    [super viewDidLoad];
    //...
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(socketResponseReceived:) 
                                                 name:@"kDidReceiveSocketResponse"
                                               object:nil];
    //...
}

- (void)socketResponseReceived:(NSDictionary *)userInfo {
     id response = userInfo[@"socketResponse"];
     // do whatever you like
}

- (void)dealloc {
     [[NSNotificationCenter defaultCenter] removeObserver:self];
} 
```

# database - 如何将包含数据的表列从一个数据库复制到另一个数据库？

> ID：14102688
> 
> 赞同：0
> 
> 时间：2012-12-31T14:22:28.317
> 
> 标签：database, sql-server-2005, calculated-columns

故事是我想将一个数据库中的表列数据复制到另一个数据库的另一个表中。两个数据库都在同一个sql server 2005上。这是否可以以这种方式复制数据或用于任何软件来执行此操作。我只使用具有不同表名的一列，并且只复制列数据。请只做那些需要的。

注意：这个问题可能是重复的，但我没有得到解决方案。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:24:27.517

如果您只想将行从源数据库复制到目标数据库，假设数据库位于同一台服务器上，这样的事情应该可以工作，您说它们是：

```
Insert Into TargetDatabase.SchemaName.TableName (TargetColumn)
Select SouorceColumn
From SourceDatabase.SchemaName.TableName 
```

如果您想在两个不同数据库中的两个表之间同步行（例如，根据某些条件更新或删除行），这要复杂得多。我建议使用像 Red-Gate Data Compare 这样的工具，或者一些免费软件应用程序可以做到这一点。如果您使用的是 SQL Server 2008，则[MERGE](http://blog.sqlauthority.com/2008/08/28/sql-server-2008-introduction-to-merge-statement-one-statement-for-insert-update-delete/)语句也可能适用于您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:26:12.653

如果您希望同步数据而不是进行简单的插入，我强烈建议您使用[http://www.red-gate.com/](http://www.red-gate.com/)中的工具。具体sql数据比较。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:28:28.020

```
-- Destitination Test2.dbo.AA not existing
Select * 
Into Test2.dbo.AA
from Test.dbo.AA

-- Destitination Test2.dbo.AA  existing
INSERT 
Into Test2.dbo.AA
Select *
from Test.dbo.AA 
```

# ruby-on-rails - 为什么在安装 gem 'pg' 时出现错误？

> ID：14102691
> 
> 赞同：3
> 
> 时间：2012-12-31T14:22:45.520
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql

> **可能重复：**
> [无法在 ubuntu 上安装 pg gem - 找不到 'libpq-fe.h 标头](https://stackoverflow.com/questions/6040583/unable-to-install-pg-gem-on-ubuntu-cant-find-the-libpq-fe-h-header)

我正在尝试将 gem **pg**添加到我的本地环境中。
但它返回此错误

```
Errno::EACCES: Permission denied - /Users/me/.rvm/gems/ruby-1.9.3-p362/gems/pg-0.14.1/.gemtest
An error occurred while installing pg (0.14.1), and Bundler cannot continue.
Make sure that `gem install pg -v '0.14.1'` succeeds before bundling. 
```

我应该怎么办？

在该错误消失后，现在它返回此错误

```
Installing pg (0.14.1) with native extensions 
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

        /Users/me/.rvm/rubies/ruby-1.9.3-p362/bin/ruby extconf.rb 
checking for pg_config... no
No pg_config... trying anyway. If building fails, please try again with
 --with-pg-config=/path/to/pg_config
checking for libpq-fe.h... no
Can't find the 'libpq-fe.h header
*** extconf.rb failed ***
Could not create Makefile due to some reason, probably lack of
necessary libraries and/or headers.  Check the mkmf.log file for more
details.  You may need configuration options.

Provided configuration options:
    --with-opt-dir
    --with-opt-include
    --without-opt-include=${opt-dir}/include
    --with-opt-lib
    --without-opt-lib=${opt-dir}/lib
    --with-make-prog
    --without-make-prog
    --srcdir=.
    --curdir
    --ruby=/Users/me/.rvm/rubies/ruby-1.9.3-p362/bin/ruby
    --with-pg
    --without-pg
    --with-pg-dir
    --without-pg-dir
    --with-pg-include
    --without-pg-include=${pg-dir}/include
    --with-pg-lib
    --without-pg-lib=${pg-dir}/lib
    --with-pg-config
    --without-pg-config
    --with-pg_config
    --without-pg_config

Gem files will remain installed in /Users/me/.rvm/gems/ruby-1.9.3-p362/gems/pg-0.14.1 for inspection.
Results logged to /Users/me/.rvm/gems/ruby-1.9.3-p362/gems/pg-0.14.1/ext/gem_make.out
An error occurred while installing pg (0.14.1), and Bundler cannot continue.
Make sure that `gem install pg -v '0.14.1'` succeeds before bundling. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:28:37.960

我相信你在尝试之前会弄乱 sudo

```
chown -R `whoami`:staff ~/.rvm/gems/ruby-1.9.3-p362/gems 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:25:50.793

看起来有人过去曾试图以 sudo 的形式安装它。我会检查该目录的权限，如果文件看起来有问题，我会 chown 文件。

# java - 修改 ArrayList 中所有 JPanel 的字体大小

> ID：14102692
> 
> 赞同：1
> 
> 时间：2012-12-31T14:22:45.727
> 
> 标签：java, swing, jpanel, jtextarea, font-size

所以，我有一个包含 JPanels 的 ArrayList；所有的 JPanel 都有一个 BorderLayout，在 NORTH 上设置了一个 JPanel（包含两个 JLabel），在 CENTER 上设置了一个 JTextArea（当然包含文本）。我的问题是如何修改每个 JTextArea 的字体大小？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:23:24.737

这是一些允许`JTextArea`通过`setFontSize(int index, int fontSize)`方法设置字体大小的简单代码。请注意，这仅适用于`panels`数组列表中的文本区域。在以下示例中，我更改了文本区域 #1 和 #3 的字体（请参阅`main`执行此操作的调用的方法）。

![在此处输入图像描述](../Images/d646c9c948328c3eb26c201ccecfbd08.png)

```
import java.awt.BorderLayout;
import java.awt.FlowLayout;
import java.awt.Font;
import java.util.ArrayList;

import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JTextArea;
import javax.swing.SwingUtilities;

public class SimpleFrame extends JFrame {
   ArrayList<JPanel> panels = new ArrayList<JPanel>();

   public SimpleFrame() {
      super("Simple Panel List Example");

      JPanel content = (JPanel)getContentPane();
      content.setLayout(new FlowLayout(FlowLayout.CENTER, 10, 10));

      // add some panels to the array list
      for(int i = 0; i < 5; i++) {
         BorderLayout b = new BorderLayout();
         JPanel p = new JPanel(b);
         JLabel north = new JLabel("Label #"+i);
         JTextArea center = new JTextArea("TextArea #"+i);
         p.add("North", north);
         p.add("Center", center);

         panels.add(p);
         content.add(p);
      }
   }

   // change the font size of the JTextArea on panel #i
   public void setFontSize(int i, int fontSize) {
      JPanel p = panels.get(i);
      JTextArea t = (JTextArea)((BorderLayout)p.getLayout()).getLayoutComponent("Center");
      Font f = t.getFont();
      Font f2 = f.deriveFont((float)fontSize);
      t.setFont(f2);
   }

   public static void main(String[] argv) {
      SwingUtilities.invokeLater(new Runnable() {
         public void run() {
            SimpleFrame c = new SimpleFrame();
            c.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
            c.pack();
            c.setVisible(true);

            // we can change the font size using our setFontSize method
            c.setFontSize(1, 8);
            c.setFontSize(3, 16);
         }
      });
   }
} 
```

# teamcity - TeamCity Nuget 安装构建步骤不适用于多个源，其中之一是 TC 的私有 NuGet 源

> ID：14102695
> 
> 赞同：9
> 
> 时间：2012-12-31T14:23:11.587
> 
> 标签：teamcity, nuget, teamcity-7.1

在将源设置为 TeamCity 的 NuGet 服务器时，我在 NuGet 安装构建步骤中收到以下错误：

```
Step 1/4: NuGet install (NuGet Installer) (3s)

[15:11:19][Step 1/4] scan: Searching for nuget.config files

[15:11:19][Step 1/4] install: Installing NuGet packages for packages.config (3s)

[15:11:19][install] NuGet command: C:\TeamCity\buildAgent\tools\NuGet.CommandLine.2.2.0.nupkg\tools\NuGet.exe install C:\TeamCity\buildAgent\work\a4b9de5be22a981\packages.config -OutputDirectory C:\TeamCity\buildAgent\work\a4b9de5be22a981\packages -Source http://localhost:9090/guestAuth/app/nuget/v1/FeedService.svc

[15:11:19][install] Starting: C:\TeamCity\buildAgent\temp\agentTmp\custom_script96367186180319830.cmd

[15:11:19][install] in directory: C:\TeamCity\buildAgent\work\a4b9de5be22a981

[15:11:22][install] The remote server returned an error: (404) Not Found.

[15:11:22][install] Process exited with code 1

[15:11:22][Step 1/4] Step NuGet install (NuGet Installer) failed 
```

如果我将源字段留空，它将从默认提要（NuGet 社区提要）中找到 NuGet 包，而不是在本地构建和打包并托管在 TC 的 NuGet 提要中的包。

如何在 NuGet 安装程序构建步骤中同时使用默认提要和内部 TC 的 NuGet 提要？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-02T17:51:51.450

您可以通过`nuget.config`文件为解决方案指定自定义提要。

关键是提供`packageSourceCredentials`这样的凭据部分：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <packageSources>
    <add key="Local" value="http://localhost:9090/httpAuth/app/nuget/v1/FeedService.svc" />
  </packageSources>
  <activePackageSource>
    <add key="Local" value="http://localhost:9090/httpAuth/app/nuget/v1/FeedService.svc" />
  </activePackageSource>
  <packageSourceCredentials>
    <Local>
      <Username>login</Username>
      <Password>pa$$w0rd</Password>
    </Local>
  </packageSourceCredentials>
</configuration> 
```

此`config`文件应`sln`位于存储库中的文件旁边。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-02T18:02:10.087

这似乎是 TeamCity 的一个[已知问题](http://youtrack.jetbrains.com/issue/TW-25052#tab=Comments)。解决方法建议通过命令行客户端添加包源，然后使用授权凭据更新这些源：

```
nuget sources add -name [name] -source [feedUrl]
nuget sources update -Name [name] -User [username] -pass [password] 
```

据我了解，Nuget 将为将来的请求缓存这些凭据。我不知道该缓存多久被清除一次；您可能需要`nget sources update`在开始构建之前运行它以确保缓存是一致的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T08:29:34.400

我们在 TeamCity 插件中实现了经过身份验证的提要支持。请关注问题的评论 http://youtrack.jetbrains.com/issue/TW-20764

# c++ - 为什么在没有明确的 return 语句的情况下，递归的 return 调用会脱离堆栈？

> ID：14102700
> 
> 赞同：18
> 
> 时间：2012-12-31T14:23:58.860
> 
> 标签：c++, recursion

我看到了一个示例程序来演示递归，它看起来不应该工作但确实有效。逻辑很清楚，但为什么即使没有返回递归函数调用，它也能工作呢？`return`即使没有请求，该命令似乎也脱离了堆栈。这是语言标准还是 gcc 的东西？我在 Windows 和 Linux 上用 gcc 编译的 C 和 C++ 看到了它。

```
#include <iostream>
#include <cstdlib>

using namespace std;

int isprime(int num, int i)
{
   if (i == 1) {
      return 1;
   }
   else {
      if (num % i == 0)
         return 0;
      else
         isprime(num, i-1); // should be returned
   }
}

int main(int argc, char** argv)
{
   int input = atoi(argv[1]);
   cout << input << "\t" << isprime(input, input/2) << "\n";
} 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-31T14:28:47.270

只有当返回值意外地出现在调用者期望的寄存器中时，这样的事情才会起作用。这仅在您的编译器将其作为递归函数实现时才有效。从技术上讲，使用不提供返回值的函数的返回值**是未定义的行为。**

*编辑：*在现代架构上，函数的返回值可能是在特定的硬件寄存器中传递的。当您递归调用函数时，在所有情况下，硬件寄存器的底部都设置为期望值。如果偶然从递归中弹出硬件寄存器从未更改过，那么您最终会得到正确的值。

如果将返回值放置在（递归）调用者堆栈的某个位置，那么所有这种模式都不起作用。

无论如何，所有这些都应该被任何现代编译器捕获并给你一个警告。如果不是，则说明您没有一个好的编译器，或者您使用了过于防御性的命令行选项。

*除夕特别：*在现实世界中，像这样（带有`return`）的代码甚至不会被实现为递归函数。无需太多努力，您就会找到该函数的迭代变体，如果您要求最大优化，任何现代体面的编译器都应该能够找到它。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-31T14:47:31.193

这里很大程度上取决于您所说的“它有效”是什么意思？

为了尝试回答您问题的要点，无论是否满足 return 语句，函数都会在到达函数末尾时返回。

我希望看到编译器警告告诉您可能的控制路径可能不会返回值，无论如何在 C++ 中。导致未定义的行为，请参阅此问题： [not return a value from a non-void return function](https://stackoverflow.com/questions/1735038/why-not-all-control-paths-return-a-value-is-warning-and-not-an-error)

我会说这个示例“有效”，因为在找到素数并且 isPrime 返回之后，堆栈中的下一个函数也可以自由返回。也不依赖于 isPrime 的返回值，因此程序将运行备份堆栈并输出一些东西。

...但由于行为未定义，实际获得输出的值可能是垃圾。如果您看到 0 和 1 与素数一致作为输入，那么哇。

如果您认为这是可行的，我会考虑使用不同的值进行更广泛的测试。

您还使用任何“调试”设置进行构建吗？如果是这样，请在关闭调试设置的情况下再次尝试，因为这些有时会做额外的工作来保持未初始化的内存清洁。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-31T15:08:53.337

我可以准确地解释会发生什么：

该函数被调用，它递归回到自身，直到它在模数（返回 0）或递归结束（返回 1）处返回。此时函数返回给调用者，即 is_prime。但是函数中没有更多代码可以执行，所以它立即返回，没有任何进一步的操作。

但是，您可以轻松地打破这一点，例如，`printf("Done for %d, %d\n", num, i);`在 is_prime() 调用后面添加 [不必在 if 语句中]。或者添加一个在函数进入/退出时创建和销毁的 C++ 对象，作为另一个示例。

你只是很幸运它有效。而且它非常脆弱且容易破解——用不同的编译器（或不同的优化设置，或新版本的编译器，或一百万个其他东西）编译它，它很可能会坏掉。

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2012-12-31T14:26:52.027

你不会忘记退货声明吗？对于正常递归，您还需要在前面加上一个 return `isprime(num,i-1);`。

我想如果你使用严格的规则编译它，这甚至应该给出一个编译警告，因为函数必须总是返回一个 int，现在它不会（至少如果你的编译器没有修复这个）。

# ios - (null) 使用 NSDateFormatter 后

> ID：14102701
> 
> 赞同：1
> 
> 时间：2012-12-31T14:24:01.987
> 
> 标签：ios, nsdate, xcode4.5, nsdateformatter

我正在尝试从 NSString 格式化 NSDate：

```
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
[dateFormatter setDateFormat:@"EEEE, dd.MM.yyyy"];

NSString * appStart = [appointment start];
NSLog(@"app start: %@", appStart);
NSString *startDateFormatted = [dateFormatter stringFromDate:appStart];
NSLog(@"formatted date: %@", startDateFormatted ); 
```

输出：

```
2012-12-31 15:21:04.722 App[3296:907] app start: 2012-12-31 15:00:00
2012-12-31 15:21:04.723 App[3296:907] formatted date: (null) 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:25:30.033

`stringFromDate`将`NSDate`* 作为参数，而不是`NSString`*。如果您需要进一步的帮助，请告诉我...

# android - Android 应用程序中的 Scala REPL

> ID：14102702
> 
> 赞同：3
> 
> 时间：2012-12-31T14:24:14.430
> 
> 标签：android, scala

我创建了一个在 Windows 上模拟 Scala REPL 的应用程序。这个想法是在 Android 上的应用程序中使用它。但我了解 Scala REPL 或解释器实际上会编译代码然后生成字节码。根据[此线程](http://scala-programming-language.1934581.n4.nabble.com/scala-Scala-Interpreter-in-Android-td2000177.html)，由于 Dalvik 字节码（Android）与 Java 字节码（Scala）不兼容，因此无法在 Android 中执行此操作。这是真的？如果有人能指出一个工作的应用程序/实现以及它是否存在，我将不胜感激。

PS：我花了一天一夜试图让它在Android应用程序中运行。它引发了无数异常，重新启动了模拟器并崩溃了 Eclipse。因此问题:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-03T06:38:36.987

“这是真的？” 是的。当然，除非您将 Scala 生成的字节码转换为 dalvik 字节码。但在 Android 上不运行 REPL 可能更容易。

# objective-c - CocoaPods/Podspec 和 *.framework

> ID：14102703
> 
> 赞同：21
> 
> 时间：2012-12-31T14:24:24.943
> 
> 标签：objective-c, ios, ios-frameworks, cocoapods

CocoaPods 问题：

我创建了一个与内部静态库捆绑的框架，具体取决于 AFNetworking 和资源包（基于这两个教程来创建 FWK [http://www.blackjaguarstudios.com/blog/programming/2012/11/22/xcode- 45-creating-ios-framework-and-hold-my-hand-im-3-years-old](http://www.blackjaguarstudios.com/blog/programming/2012/11/22/xcode-45-creating-ios-framework-and-hold-my-hand-im-3-years-old)和[https://github.com/bclubb/iOS-Framework](https://github.com/bclubb/iOS-Framework) )

我很想创建一个 podspec，这样人们只需在他们的 Podfile 中添加一行，如果需要，它会在 pod 安装时添加我的框架和 AFNetworking。

这可能吗？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-02T18:22:26.953

实际上，我在办公室做了很多这样的事情。我们有大量重复使用的私有源代码。CocoaPods 帮助更快地启动新项目，并使它们更容易更新。

虽然可以将您的框架添加到 podspec，但我发现通过 CocoaPods 传递静态库和标头要容易得多，而不用担心框架。

您必须根据您的项目更新您的 podspec，但以下是重要部分：

```
s.source_files = 'StaticLib/Headers/*.h'
s.preserve_paths = 'StaticLib/libYourLibrary.a'
s.library = 'YourLibrary'
s.xcconfig = { 'LIBRARY_SEARCH_PATHS' => '$(PODS_ROOT)/ProjectFolder/LibraryFolder' }    

s.dependency = 'AFNetworking' 
```

这将复制您的静态库以及将 AFNetworking 带入您的 pod。这将使您的静态库更小（不必构建它）并加快用户导入您的 pod 的速度。

如果您必须使用框架，上面的相同内容仍然适用，但您可能需要做一些细微的调整。无论如何，所有框架都是静态库和头文件的漂亮文件夹结构，所以为什么要为额外的东西烦恼。无论如何，源代码仍然内置在 lPods.a 静态库中。希望这可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-29T08:00:28.130

事实上，您现在可以使用 Cocoapods 创建自己的 libxxx.a 或 xxxx.framework。Cocoapods 将处理诸如通用二进制和公共标头之类的细节。请检查：[https](https://guides.cocoapods.org/making/using-pod-lib-create.html) ://guides.cocoapods.org/making/using-pod-lib-create.html和[http://blog.cocoapods.org/Pod-Authors-Guide-to-CocoaPods-Frameworks/](http://blog.cocoapods.org/Pod-Authors-Guide-to-CocoaPods-Frameworks/)

# jquery - KnockoutJS foreach 中的 jQuery 单击绑定不起作用

> ID：14102706
> 
> 赞同：2
> 
> 时间：2012-12-31T14:24:27.640
> 
> 标签：jquery, knockout.js

我在一个 knockoutJS foreach 中有一个 jQuery 点击绑定，但它不工作。我相信淘汰赛正在阻止传播。

有没有办法让它工作？我试图避免通过淘汰赛绑定到点击事件。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T14:30:22.843

在没有看到任何代码的情况下，我只能假设您正在做类似的事情

```
$('element').on('click', function(e){}); 
```

要将点击事件绑定到动态生成的对象，您需要有这样的点击事件

```
$('body').on('click', 'element', function(e){}); 
```

# c# - 使用 dotCover 在执行单元测试期间访问构建为“内容”的文件

> ID：14102707
> 
> 赞同：1
> 
> 时间：2012-12-31T14:24:37.237
> 
> 标签：c#, .net, unit-testing, dotcover

我正在使用[JetBrains DotCover](http://www.jetbrains.com/dotcover/)为我的测试和代码执行和获取代码覆盖率。

我的项目有一些文件设置为“内容”。这些从测试中使用，如下所示：

```
// Get executing assembly dir.
var dir = Path.GetDirectoryName(Assembly.GetExecutingAssembly().Location);

// Combine to get the full path to test page.
var page = Path.Combine(dir, @"Pages\Page.htm");

// Open web page.
manager.OpenBrowser(page); 
```

不幸的是，当使用 dotCover 执行此测试时，*Page.htm*不会复制到程序集的位置。

有没有办法将内容放入测试执行目录，或者克服这个问题并以其他方式访问该文件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-25T12:24:41.457

这可能是卷影复制的副作用。在这种情况下，“Assembly.GetExecutingAssembly().Location”将提供到影子复制程序集的路径。尝试改用“Assembly.GetExecutingAssembly().CodeBase”。

# ruby - 在 watir webdriver 中鼠标右键/左键单击屏幕

> ID：14102708
> 
> 赞同：3
> 
> 时间：2012-12-31T14:24:43.303
> 
> 标签：ruby, watir-webdriver

有没有办法在屏幕上的特定位置模拟鼠标右键/左键单击？

不是`element#click`，而是简单地在屏幕上指定一个位置（500、500）？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T15:16:37.287

```
@browser.execute_script("$(document.elementFromPoint(x, y)).click();") 
```

**更新**
问题是它可能无法满足您对右键单击的期望

```
@browser.execute_script("$(document.elementFromPoint(2, 2)).trigger({type: 'mousedown', which: 3});") 
```

它可能与 watir webdriver 解决方案无关，但应该可以工作

# eclipse - Google AppEngine 开发服务器参数

> ID：14102712
> 
> 赞同：2
> 
> 时间：2012-12-31T14:25:21.827
> 
> 标签：eclipse, gwt

在 Eclipse Run Configurations for Google Web Applications 中，我看到了一个程序参数列表，如下所示：

> -remoteUI "${gwt_remote_ui_server_port}:${unique_id}" -startupUrl Test_AppEngine.html -logLevel INFO -codeServerPort 9997 -port 8888 ...

两个问题：1）“gwt_remote_ui_server_port”和“unique_id”在哪里定义，更一般地说，2）我在哪里可以找到所有可能参数的描述？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:09:23.677

要在 GWT 编译器的托管模式和编译模式下传递的参数列表 - [https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging](https://developers.google.com/web-toolkit/doc/latest/DevGuideCompilingAndDebugging)

这些参数`-remoteUI "${gwt_remote_ui_server_port}:${unique_id}"`与 GAE 无关，而是与在**Eclipse 的开发模式视图**中启动的 GWT 托管模式有关，而不是与 Eclipse之外的独立应用程序有关。

![在此处输入图像描述](../Images/4c4e61ede83f6590f90f24ea61623e72.png)

如果您删除 arguments `-remoteUI "${gwt_remote_ui_server_port}:${unique_id}"`，GPE 仍将启动。这次作为独立应用程序。

![在此处输入图像描述](../Images/35a38c53f2f48d8ef670d3516318f374.png)

# python - 是否有基于 JVM 的指标库的 python 版本

> ID：14102717
> 
> 赞同：12
> 
> 时间：2012-12-31T14:25:55.807
> 
> 标签：python, performance, performancecounter, metrics

我正在寻找 python 中的性能指标库。

我熟悉Coda Hale 的[指标](http://metrics.codahale.com/)，它是为 JVM 编写的，所以我想知道是否有对应的 Python（并且不使用 JVM）。

简而言之，该工具的要求列表将是：

*   在执行时计算不同类型的指标。计数器、仪表、仪表、计时器、直方图等。这里有一个很好的[列表](http://metrics.codahale.com/getting-started/)
*   允许通过 HTTP API 轻松访问运行时数据。（我可以自己包装 HTTP 层，但如果它已经被烘烤，那就更好了）
*   特别是石墨或其他插件。CopperEgg会很好。或新遗物。
*   为常用库（例如 memcached）提供检测支持。

到目前为止，我发现[PyCounters](http://pycounters.readthedocs.org/en/latest/index.html)完成了一些工作，但不是全部。它有点满足我的第一个项目符号（但它没有所有的度量类型，只有三个），仅此而已。

PyCounters 有更好的替代品吗？

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-12T21:40:56.367

我遇到了这个库，它是 Python 的 CodaHale 指标的一个端口。

缺少一些东西，即记者，但它可以做大多数其他事情。

[https://github.com/omergertel/pyformance/](https://github.com/omergertel/pyformance/)

无耻的插件，这是我的叉子，它添加了一个托管的石墨报告器。将记者添加到其他系统应该是微不足道的。

[https://github.com/usmanismail/pyformance](https://github.com/usmanismail/pyformance)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-01T09:45:52.333

我不知道有什么东西可以做到这一点，但我确实为一个项目写了一些东西，该项目通过简单地将装饰器添加到相关函数来实现这一点。

我创建了一组装饰器，用于测量函数的运行时间、测量 DB 访问函数的时间等。

这种装饰器的一个例子是：

```
def func_runtime(method):
    @functools.wraps(method)
    def wrapper(self, *args, **kwargs):
        start_time = datetime.datetime.utcnow()
        try:
            class_name = type(self).__name__
            method_name = method.__name__
            return method(self, *args, **kwargs)
        finally:
            end_time = datetime.datetime.utcnow() - start_time
            time_taken_ms = end_time.microseconds / 1000
            if _statsd:
                # Send the data to statsD, but you can do that for CopperEgg or anything else
                self.stats.timing("func.runtime.%s.%s" % (class_name, method_name), time_taken_ms) 
```

稍后你会像这样使用它：

```
@func_runtime
def myfunc(a, b, c):
    pass 
```

我还为从数据库读取的函数和写入数据库的函数添加了一个装饰器，这样我就可以得到关于代码等待读取数据或写入数据所花费的时间以及我称之为“读取”的次数的图表操作和“写”操作。

所以，总而言之，我有以下装饰器： - @func_runtime - 测量函数的运行时间 - @func_dbread - 放置在执行读取的函数上。增加一个 database.reads 计数器并将计时数据发送到 read_timing - @func_dbwrite - 与 @func_dbread 相同，但用于写入 - @func dbruntime - 用于测量 DB 特定函数的运行时间以及调用次数和总计时所有数据库功能

您可以组合装饰器，它们以最接近函数的顺序运行，例如：

```
@func_dbruntime
@func_dbread
def some_db_read_function(a, b, c,d):
    pass 
```

所以，@func_dbread 在@func_dbruntime 之前运行。

总而言之，它易于定制且非常强大，您可以将其扩展为支持 3rd 方服务以及添加代码以在相关时动态打开和关闭这些计数器。据我所知，性能损失充其量是最小的。

只是关于向 CopperEgg 和其他服务等地方发送数据的通知，StatsD 使用 UDP，由于它的统计数据，您可能会丢失一些数据，但仍然可以获得有意义的见解，它不会阻止任何事情。如果您想将数据发送到像 CopperEgg 这样的 3rd 方站点，我会考虑将数据发送到本地队列，然后使用不同的流程将其推送到 CopperEgg，以便将 3rd 方服务问题与您自己的问题解耦。

就个人而言，对于此类数据，StatsD 非常棒，graphite 为您提供了所有您需要的东西，包括 90th percentile、average、max、绘图能力等，并且基本上具有您需要的大多数计数器类型。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-01T13:11:15.733

没有机会尝试，但我几天前遇到了这个： [https ://github.com/Cue/scales](https://github.com/Cue/scales)

**scales - Python** 跟踪服务器状态和统计数据的度量标准，允许您查看服务器正在做什么。它还可以将指标发送到 Graphite 以进行绘图或发送到文件以进行崩溃取证。

scales 的灵感来自于奇妙的度量库，尽管它绝不是一个端口。

# objective-c - 在objective-c中覆盖setter

> ID：14102718
> 
> 赞同：1
> 
> 时间：2012-12-31T14:25:56.787
> 
> 标签：objective-c, ios

我想设置`NSDate`，`NSInteger`我有`@property`：

`@property (strong,nonatomic) NSDate *date;`

我想要二传手：

```
-(void)setDate:(NSInteger *)tStamp {
    thumbImgUrl = [NSDate dateWithTimeIntervalSince1970:tStamp];
} 
```

所以我想从`NSInteger`价值而不是`NSDate`价值来设置我的日期。我如何声明这个二传手？当我尝试将它放在头文件中时，它可以正常工作，但我收到警告：

`Type of property 'date' does not match type of accessor 'setDate:`

如果我想在*.m*文件中声明它，我会收到错误消息：

`duplicate declaration of method setDate:`

为什么？有一种方法可以声明具有不同输入类型的 setter？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T14:29:39.517

一般来说，这是在 Objective-C 中做事的一种非常糟糕的方式，我强烈建议您将方法名称更改为其他名称，例如`-(void)setDateWithInteger:(NSInteger)tStamp`. （说到这， NSInteger 是一个原语，而不是一个对象）回答你的问题，不，如果你使用`@property`. 如果您确实坚持按照自己的方式进行操作，那么您将不得不声明该方法而不使用`@property`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:32:09.803

您可能可以接受一个类型`id`作为 setter 函数的输入参数。

你得到了，`duplicate declaration of method setDate:`因为你很可能`@synthesize date`在你的实现文件中有这行。这会自动为您生成 getter/setter。删除该行，因为您提供自己的实现。

# php - Smarty 中的多语言站点（配置文件或 parse_ini_file）

> ID：14102719
> 
> 赞同：0
> 
> 时间：2012-12-31T14:25:59.043
> 
> 标签：php, smarty, multilingual

现在我使用 parse_ini_file() 在 Smarty php 文件中创建多语言站点：

```
$lang_file=parse_ini_file("lang/". $_SESSION["lang_folder"] ."/lang_file.ini",true);
$this->tpl->assignByref("lang",$lang_file);
$this->tpl->display('page.tpl'); 
```

比在 page.tpl 中调用它：

```
{$lang.VARIABLE} 
```

但是我读到 parse_ini_file() 由于安全原因被禁用了一些托管，所以我想找出解决这个问题的方法。我找到了配置文件，所以在 page.tpl 的顶部应该放置这个：

```
{config_load file='en_lang.conf'} {* depending on current language stored in session *} 
```

它是好的还是有一些简单而通用的方法？

# c# - 试图获取输入和选择数量的所有名称和值

> ID：14102724
> 
> 赞同：1
> 
> 时间：2012-12-31T14:26:21.043
> 
> 标签：c#, html, regex, input, match

我有一个包含许多html 元素`input`的表单。`select`问题是每个输入和选择都有一个名称，但不是所有的都有值（默认选择），并且至少一个选择元素`"`在名称属性中没有引号。

我愿意用一个表达式来获取所有的名称和值。

这是表格（没有`\n`和`\r`符号）：

[http://pastebin.com/QaXNqcHH](http://pastebin.com/QaXNqcHH)

这是他的我的代码：

```
MatchCollection mtches;

mtches = Regex.Matches(registerForm, "(?:(?:<input)|(?:<select))[^>]*?name=\"?(?<name>.+?)(?:(?:\")|(?:>))[^>]*?(?:value=\"(?<value>.*?)\")?[^>]*?> "); 
```

我成功地获得了每个输入和选择的所有名称，但问题是它没有提取值匹配。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:29:24.493

不要使用正则表达式来解析 html。这是一个处于精神错乱边缘的 SO 成员，与主题相关：[https ://stackoverflow.com/a/1732454/1548853](https://stackoverflow.com/a/1732454/1548853)

为自己找到一个你喜欢的并且易于使用的 html 解析器。

# jquery - 我可以将数据添加到已经序列化的数组吗？

> ID：14102732
> 
> 赞同：21
> 
> 时间：2012-12-31T14:26:41.060
> 
> 标签：jquery, serialization

我正在使用 CKEditor 并希望将 textarea 数据与所有其他元素一起序列化。这可能吗？

如果可能的话，我想将 taData 附加到 vals 中。

```
var vals = $("#post").find('input,select').serialize();
var taData = CKEDITOR.instances.ta1.getData(); 
```

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-12-31T14:45:11.000

`.serialize`返回一个字符串，因此您可以随时修改字符串，但我不建议这样做，字符串操作会变得混乱。

相反，使用[`.serializeArray` *^([docs])*](http://api.jquery.com/serializeArray/)创建数据的数组表示，然后将数据添加到其中。数组的每个元素都是一个具有`name`and`value`属性的对象：

```
var vals = $("#post").find('input,select').serializeArray();
vals.push({name: 'nameOfTextarea', value: CKEDITOR.instances.ta1.getData()}); 
```

所有 jQuery Ajax 方法都会理解这种结构并正确地序列化数据。如果您想创建一个序列化字符串（就像`.serialize`），您可以将数组传递给[`$.param` *^([docs])*](http://api.jquery.com/jQuery.param/)：

```
var query_string = $.param(vals); 
```

# sql - SQL concat 选择计数和 varchar

> ID：14102733
> 
> 赞同：1
> 
> 时间：2012-12-31T14:26:43.557
> 
> 标签：sql, sql-server, sql-server-2008, count, concatenation

我目前正在结合`SELECT COUNT (column)`一个用户定义的函数，`varchar`如下所示：

```
'Express 24: ' + (SELECT COUNT(Product) FROM [DHL].[dbo].[F_SubBetsy](@startdate, @enddate, 'EXPRESS EXPRESS 24', @contract, @account)) +
'\r\nExpress 48: ' + (SEL... 
```

我收到错误：

> *将 varchar 值“Express 24:”转换为数据类型 int 时转换失败。*

大概`SELECT COUNT`是返回一个`int`并且`varchar`比 int 更不受欢迎，但尽管尝试了几次，我还没有弄清楚如何正确组合`CAST( AS NVARCHAR())`或`VARCHAR()`使用 SELECT COUNT。

有人可以为我解决这个问题吗？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:30:50.517

```
'Express 24: ' + CAST(
    (
    SELECT  COUNT(Product) 
    FROM    [DHL].[dbo].[F_SubBetsy](@startdate, @enddate, 
                                    'EXPRESS EXPRESS 24', @contract, @account) 
    ) as varchar(16)) +
'\r\nExpress 48: ' + (SEL... 
```

# java - 如何使用新文件类型的新向导使 NetBeans 7.1 教程与 NetBeans 7.2 一起使用

> ID：14102739
> 
> 赞同：0
> 
> 时间：2012-12-31T14:27:08.770
> 
> 标签：java, module, netbeans-7, netbeans-platform

标题有点长，但是问题的描述还是很容易理解的。

我有 NetBeans 7.2 并且我正在关注针对 NetBeans 7.1 的教程。本教程展示了如何添加语言支持以突出显示自定义语法。

[http://platform.netbeans.org/tutorials/nbm-javacc-lexer.html](http://platform.netbeans.org/tutorials/nbm-javacc-lexer.html)

问题是 NetBeans 7.1 的“新文件类型”向导正在创建两个文件（layer.xml 和 SJResolver.xml），这两个文件不是由该向导的 NetBeans 7.2 版本创建的。

我找到了一个链接，解释 layer.xml 可以由另一个向导创建（见下面的链接）

[http://platform.netbeans.org/whatsnew/71.html](http://platform.netbeans.org/whatsnew/71.html)

但还没有找到关于缺少 Resolver.xml 以及如何创建它的任何解释。

因此，在我安装 NetBeans 7.1 并重试之前，我想在这里检查是否有更简单的方法可以实现从 7.1 到 7.2 的飞跃，并使本教程适合我。

谢谢，

--- 拉姆伊

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-03T12:17:28.640

两天前我问过这个问题，今天我安装了 NetBeans 7.1 并打开了教程再次关注它。

从今天到 2 天前，Netbeans.org 更新了教程，现在适用于 NetBeans 7.2

该教程位于与上述相同的链接下。旧的 7.1 教程已移动。

拉姆EE

# arrays - 试图弄清楚如何从单独的数组中调用数组

> ID：14102742
> 
> 赞同：-2
> 
> 时间：2012-12-31T14:27:18.277
> 
> 标签：arrays, actionscript-3, flash, actionscript, actionscript-2

我对 Flash 很陌生，但我学得很快。我了解数组等，但我已经向我的孩子们保证我会尝试为他们制作一个 Yu-Gi-Oh 游戏。我知道有一些已经出来了，但我想对原作做一些改动。我无法解决的问题是数组名称。您使用的大多数纸牌游戏有 2 种类型，`rank`并且`suit`. 使用 Yu-Gi-Oh，您可以使用大约 10 个，例如`name`、`type`、`attack`等`defense`。

考虑到所有这些，我通过谷歌搜索并找到了两种方法，一个我不知道如何使用的 XML 文件，但最有希望的似乎是制作一个`class`卡类使用的卡定义只存储卡名。

本质上，卡定义类，比如一张名为龙的卡，持有它的所有值，而卡类持有所有不同的卡名。这样我就可以从卡片类中分配出 6 个卡片名称，并且每张卡片都可以调用卡片 def 中的值。当然，知道该做什么和知道如何编程是两件不同的事情。谁能告诉我一种可行的方法，请记住，我一直在尝试学习 Flash 仅几个星期。

编辑，我不允许在另外 5 小时内回答我自己的问题，所以现在只编辑这个以回复下面的答案。

感谢弗洛兰的回复。我想我可以很容易地计算出比较器。困难的部分是需要保存的所有数据。例如 ["Alexandrite Dragon1", "monster", "light", 4, "dragon", 2000, 100] 是 Alexandrite Dragon 的统计数据。我正在考虑将其作为紫翠玉龙的阵列，并为每张卡片都在卡片 def 类中执行其中 1 个。

在那之后，我想要一个卡片阵列，它可以容纳其中的每一个，这样阵列可能是 [亚历山大变石龙，ganbara 骑士] 等，所以当我发牌时，如果有人从卡片阵列 [0] 中抽出亚历克斯龙，那么我想也许要获得那张卡片，可能会得到卡片 [0] [5] 甚至卡片 [0[5]] 之类的东西。我显然不确定这是否可行，在花了 3 天时间搜索谷歌等之后，我认为问起来可能更容易。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T16:01:06.327

您目前正在解决两个问题。

1.  结构体
2.  规则

考虑结构和规则可能会分开进行，但由于您必须将规则应用于卡牌，这决定了很多游戏的基本理念，我尝试对其进行压缩。

如前所述，卡片应该包含代表游戏卡片所需的所有数据。这意味着它拥有一个标签，给它一个可以显示的有意义的名称，一些属性，如类型、攻击或防御或更多。

```
package net.icodeapps.examples {
  public class Card {
    public var label:String,
               type:String,
               attack:int,
               defense:int;
  }
} 
```

这是创建卡片的最基本方法。但是为了与卡片所持有的数据进行交互，您需要某种比较器：哪张卡片更强大。

```
package net.icodeapps.examples {
  public class CardComparator {
     public function attackCompare(card1:Card, card2:Card):Card {
       if (card1.attack < card2.attack) return -1;
       if (card1.attack > card2.attack) return 1;
       return 0;
     }

     public function defenseCompare(card1:Card, card2:Card):Card {
       if (card1.defense < card2.defense) return -1;
       if (card1.defense > card2.defense) return 1;
       return 0;
     }
  }
} 
```

通过这种方式，您可以确定攻击或防御中更强的卡。如果您需要更复杂的方法来确定值：

```
package net.icodeapps.examples {
  public class CardComparator {
    public function compare(card1:Card, card2:Card):Card {
      const diff1:int = card1.attack - card2.defense,
            diff2:int = card2.attack - card1.defense;
      if (diff1 < diff2) return -1;
      if (diff1 > diff2) return 1;
      return 0;
    }
  }
} 
```

但是你看，模式是一样的。将状态与“行为”隔离开来（尽管它只是说明的一个小上下文）。如果像类型这样的属性起作用，请增强比较器。如果需要增强类属性，则需要向 Card 类添加方法。

现在，您可以创建卡片并进行比较。接下来是一个集合，它可以是一个数组或向量。但不要使用这些来存储属性。这只会带你进入地狱的厨房。

但我想这是一个首发。

# android - 在 Activity 方法期间多次更新 UI

> ID：14102745
> 
> 赞同：0
> 
> 时间：2012-12-31T14:27:34.153
> 
> 标签：android, multithreading, user-interface, android-activity

在我的主要活动中，我有一个链接到按钮的方法，当按下按钮时，它应该被禁用，然后发出 HTTP 请求，在方法完成后，应该再次启用按钮。

```
public void onClick(View view) {        
    Button button = (Button) findViewById(R.id.my_button);
    button.setEnabled(false);
        button.setTextColor(Color.GRAY);
    try {
        // make HTTP request
    } catch (IOException e) {
        // error
    } finally {
        button.setEnabled(true);
        button.setTextColor(Color.GRAY);
    }
} 
```

所以通常按钮在我点击后应该改变颜色，然后我等待请求发生，这将超时，因此我等待 3 秒，然后按钮的颜色应该变回来。

不幸的是，颜色/按钮不会更新一次，直到方法完成。这是什么原因？它是如何正确完成的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:31:57.677

使用[AsyncTask](https://developer.android.com/reference/android/os/AsyncTask.html)进行 HTTP 调用（将其放在方法中：[doInBackground()](https://developer.android.com/reference/android/os/AsyncTask.html#doInBackground%28Params...%29)）并将代码再次重新启用按钮放在方法[onPostExecute()](https://developer.android.com/reference/android/os/AsyncTask.html#onPostExecute%28Result%29)上。

# arduino - 如何随机选择 Arduino 引脚输出？

> ID：14102748
> 
> 赞同：0
> 
> 时间：2012-12-31T14:27:41.240
> 
> 标签：arduino, output, processing

我有一系列八个 LED，我试图从 ON 开始随机淡入和淡出。这就是我到目前为止的位置。

```
#define LED1 2
#define LED2 3
#define LED3 4
#define LED4 5
#define LED5 6
#define LED6 7
#define LED7 8
#define LED8 9

void setup() {
pinMode(LED1,output);
pinMode(LED2,output);
pinMode(LED3,output);
pinMode(LED4,output);
pinMode(LED5,output);
pinMode(LED6,output);
pinMode(LED7,output);
pinMode(LED8,output);
}

    void cycleLED() {
        timeOn = random(600,1800);
        timeOff = random(600,1800);
        for (fadeOut = 255; fadeOut > 0; fadeOut--) { 
            analogWrite(LED, fadeout);
            delay(timeOff); 
        }

        for (fadeIn = 0;fadeIn < 255; fadeIn++) { 
            analogWrite(LED,fadeIn);      
            delay(timeOn); 
        }
    } 
```

这就是我卡住的地方。我想做类似于以下伪代码的事情。

```
activeLED = random(2,10);             // choose a random LED pin
LEDtoCycle = pinNumber-activeLED;     // set the active LED to the random LED pin 
cycleLED(pinNumber-activeLED);        // run cycleLED on the active LED 
```

我的意图是随机选择一个 LED，然后`cycleLED`在该 LED 上运行，无限重复。通过选择随机但是，我很难想出一个好的方法来做到这一点。如何将 pin 变量传递给 cycleLED()？或者我应该重复`#define`单个随机 LED？或者我应该只硬编码`cycleLED1()`、`cycleLED2()`、`cycleLED3()`等的八个独立实例。

提示或建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:39:13.387

您可以使 cycleLED 函数接受一个参数，如下所示：

```
void cycleLED(int led) 
```

然后只需在您的模拟写入调用中使用 led 变量来代替您当前拥有的神秘 LED 东西。

# android - 如何为不同的用户选择的显示字体大小显示图形布局预览

> ID：14102749
> 
> 赞同：14
> 
> 时间：2012-12-31T14:27:44.047
> 
> 标签：android, adt, layout-editor

**背景：**
ADT（版本 21）允许预览各种显示的缩略图。
Android 允许用户在设置->显示中选择小/正常/大/大字体大小。
Android 设置可能会影响显示设置，需要额外的设计考虑。

**问题：**
有没有办法预览“正常”显示字体选择以及“巨大”字体选择？

# vba - 有没有办法自动执行 VBA 宏？

> ID：14102750
> 
> 赞同：4
> 
> 时间：2012-12-31T14:27:46.730
> 
> 标签：vba, windows-7

我想设置我的计算机，使其每天自动执行我在电子表格或访问数据库中编写的 VBA 宏。

那么有什么方法可以从批处理文件中调用 VBA 宏，或者类似的东西？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T15:14:04.230

当然。使用命令行开关，提供的链接是关于命令行开关的页面。[对于 Access](http://support.microsoft.com/kb/209207) ,[对于 Excel](http://office.microsoft.com/en-us/excel-help/command-line-switches-for-excel-HA010158030.aspx)

这是我在加载 msaccess 文件然后运行存储的宏的 .bat 文件中的示例。

`start msaccess "%localFolder%%localFileName%" /x %macroName%` 在这种情况下`%localFolder%%localFileName%`，加起来就是包含 mdb/accdb 文件的完整路径，并且`%macroName%`是宏的名称。

对于 Excel，只需将要运行的任何内容放入`Workbook.Open`事件中。然后使用如下命令加载它： `start excel %workbookPath%`

这将创建一个新的 Excel 实例，打开工作簿并触发`Workbook.Open`事件。如果您认为您可能打开了工作簿，您可能还希望传递只读参数`/r`，以便在无需用户输入的情况下重新打开工作簿。

设置好 .bat 文件后，只需使用 Windows 调度程序对其进行调度。

就个人而言，除非您的脚本是 Access 或 Excel 特定的，否则我建议您在 .VBS 中重写您的脚本，以便它可以在没有 Excel 或 Access 开销的情况下运行并安排它。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-03T11:50:09.223

如果要更改电子表格或 Access 数据库中的*数据*，您可能希望使用 VBS 和 DAO 对象：

```
Set Dbe = CreateObject("DAO.DBEngine.36") 
```

使用 DAO 更新数据的优点是它比 Excel 或 Access 应用程序更小、更快、更轻。更健壮，更稳定。崩溃时不会弹出消息框：不需要 GUI 登录用户。

只使用 DAO（或 ADO）的缺点是它是一个更小、更快、更轻的对象：它不能做任何事情，比如打印或 VBA（虽然你可以读取一个单元格，做一个 VBS 计算，然后插入数据）。

特别是，DAO/ADO 对象不能使 Excel 重新计算单元格值。为此，您需要 Excel。它不能在 Access 中使用 UDF。为此，您需要 Access。

（您可以使用 VBS 自动化 Access/Excel，但这只是在 Access/Excel 之上添加了另一层，因此这通常不是一个好主意。）

# c# - ServiceStack/Funq 无法解析 System.Boolean 异常

> ID：14102752
> 
> 赞同：1
> 
> 时间：2012-12-31T14:28:01.207
> 
> 标签：c#, servicestack, funq

我使用内置的 Funq IoC 容器设置了一个 ServiceStack api 来解析我的存储库。但是，当我调用 api 方法时，出现以下异常：

> 无法解析 System.Boolean 类型的必需依赖项。

上次我检查 System.Boolean 不需要任何解析。我已经在 AppHost 配置中注册了我的存储库，如下所示：

```
container.RegisterAutoWiredAs<OrganisationRepository, IOrganisationRepository>().ReusedWithin(ReuseScope.Request); 
```

这是我第一次使用 ServiceStack 或 Funq。我做错什么了吗？有没有解决的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-02T05:33:54.440

如果您使用`container.RegisterAutoWiredAs<T,IT>()`，那么 Funq 将按照约定自动连接存储库，即使用**最大的构造函数**并解析和注入存储库的每个公共属性依赖项。

要使用替代的特定构造函数，或仅自动装配特定属性，您必须手动指定注册：

```
container.Register<IOrganisationRepository>(c => 
    new OrganisationRepository(c.Resolve<IFoo>()) { Bar = c.Resolve<IBar>() } ); 
```

注意：每当你遇到这样的 IOC 问题时，你还应该包括你的类的骨架。

# objective-c - 检测并删除文本中的日期字符串

> ID：14102756
> 
> 赞同：3
> 
> 时间：2012-12-31T14:28:19.007
> 
> 标签：objective-c, ios, nsstring

我想知道是否可以在文本中检测并删除字符串格式的日期，如下所示：

```
Title 31 December 2012
Title December 2012
Title 31-12-12
Title (31-12-12) 
```

在这三个示例中，在所有情况下，我都想删除所有内容并仅保留世界“标题”，例如，我发现此方法可以删除括号内的文本：

```
 searchText = [searchText stringByReplacingOccurrencesOfString:@" \\([^()]*\\)" withString:@"" options:NSRegularExpressionSearch|NSCaseInsensitiveSearch range:NSMakeRange(0, [searchText length])]; 
```

我可以删除这个（31-12-12），但我不明白我该如何处理其他情况......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T15:42:40.373

合并为一个 RE：

```
NSString *reText = @" ((\\d{2} )?\\w+ \\d{4})|(\\(?\\d{2}-\\d{2}-\\d{2}\\)?)"; 
```

请注意，这实际上由两个 RE 或一起组成：

`(\\d{2} )?\\w+ \\d{4}`
和
`\\(?\\d{2}-\\d{2}-\\d{2}\\)?`

请参阅[NSRegularExpression 类参考](https://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)

```
NSArray *testList = @[
    @"Title 31 December 2012",
    @"Title December 2012",
    @"Title 31-12-12",
    @"Title (31-12-12)"
];
NSString *reText = @"( (\\d{2} )?\\w+ \\d{4})|( \\(?\\d{2}-\\d{2}-\\d{2}\\)?)";

for (NSString *test in testList) {
    NSString *result = [test
                        stringByReplacingOccurrencesOfString:reText
                        withString:@""
                        options:NSRegularExpressionSearch|NSCaseInsensitiveSearch
                        range:NSMakeRange(0, [test length])];
    NSLog(@"result: '%@' test: '%@'", result, test);
} 
```

NSLog 输出：
结果：'Title' 测试：'Title 31 December 2012'
结果：'Title' 测试：'Title December 2012'
结果：'Title' 测试：'Title 31-12-12'
结果：'Title' 测试： '标题（31-12-12）'

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:08:59.467

您必须使用不同的正则表达式。

这个应该能抓住你所有的 4 个案例。

```
searchText = [searchText stringByReplacingOccurrencesOfString:@"\\W+((\\(?\\d+(-|\\.)\\d+(-|\\.)\\d+\\)?)|((\\d+ )?\\w+ \\d+))" withString:@"" options:NSRegularExpressionSearch|NSCaseInsensitiveSearch range:NSMakeRange(0, [searchText length])]; 
```

# macos - 如何在 MAC OS Lion 10.7.5 上使用 JRE7 运行 JavaFX jar？

> ID：14102761
> 
> 赞同：1
> 
> 时间：2012-12-31T14:28:51.083
> 
> 标签：macos, jar, path, javafx-2, java

我在 Windows 8 操作系统、64 位机器上创建了一个捆绑的 JavaFX 应用程序 jar。我的 Window 操作系统上安装了 JavaFx2.0 和 Java 1.7.0_09

```
<target name="CreatingJars" depends="Compiling" description="generate the distribution" >
                <taskdef resource="com/sun/javafx/tools/ant/antlib.xml"      
                        uri="javafx:com.sun.javafx.tools.ant" classpath="${env.JAVA_HOME}/lib/ant-javafx.jar"/>

                        <mkdir dir="${WorkingFolder}/temp/libs"/>
                    <copy todir="${WorkingFolder}/temp/libs">
                    <fileset file="${WorkingFolder}/CustomJars/ProjectLib.jar">
                    </fileset>
                    </copy>
                    <copy todir="${WorkingFolder}/temp/libs">
                    <fileset dir="${WorkingFolder}/libs">
                    </fileset>
                </copy>

                <fx:jar destfile="${WorkingFolder}/${app.name}.jar">
                <fx:application mainClass="${main.class}"/>
                <fx:resources>
                    <fx:fileset dir="${WorkingFolder}/temp/"/>
                </fx:resources>

                <fileset dir="${WorkingFolder}/build"/>
                <fileset dir="${WorkingFolder}/resources"/>
                </fx:jar>
    </target> 
```

当我尝试在 MAC OS Lion 10.7.5 上运行该 JavaFX 应用程序 jar 时，使用

java -jar 应用程序.jar

它总是显示带有下载链接的对话框“应用程序需要更新版本的 Java 运行时”。即使我已经在我的 MAC 机器上下载并成功安装了它，但它仍然显示相同的窗口。

java -version 始终指向 1.6。

然后我搜索 Java Preferences 以指向当前的 JRE 1.7，但我可以在 Applications -> Utilities -> Java -> Java Preferences 中找到 Java Preferences。

我想知道——如何在 MAC OS Lion 10.7.5 上使用 JRE7 运行 JavaFX jar？他们是否有任何其他方式可以使用 JRE7 运行 JavaFX 应用程序 JAR？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:39:15.263

请参阅[相关论坛帖子](https://forums.oracle.com/forums/thread.jspa?threadID=2479860&tstart=0)。

要为最新安装的 Oracle jre 版本运行应用程序：

```
/Library/Internet\ Plug-Ins/JavaAppletPlugin.plugin/Contents/Home/bin/java -jar application.jar 
```

要为给定的已安装 jdk 版本运行应用程序：

```
export JAVA_HOME=`/usr/libexec/java_home -v 1.7`
java -jar application.jar 
```

# php - 如何重置 $_SERVER['REQUEST_METHOD'] == 'POST';

> ID：14102762
> 
> 赞同：-5
> 
> 时间：2012-12-31T14:28:53.450
> 
> 标签：php

我有一个通过提交的表格，`$_SERVER['REQUEST_METHOD'] == 'POST';`然后前进到下一页。在下一页上，我想让用户选择返回并编辑表单数据。当我尝试返回表单页面时，浏览器会发布“确认表单提交”消息。

这似乎只发生在谷歌浏览器上，在 Safari 上运行良好。

有没有人对它为什么这样做有任何想法？`$_SERVER['REQUEST_METHOD']`返回页面时是否必须重置变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:33:25.763

您应该将用户重定向到编辑页面，而不是浏览器中的上一页。您可以将信息临时存储在会话中，然后在编辑页面上加载该信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:31:41.673

您可以更好地在数据库中添加值。当某人返回时重新加载存储在数据库中的值。这是做你想做的事情的更干净的方法。在 Firefox 中，您会收到此消息，我猜也在 IE 中。

# actionscript-3 - 通过 flex 发送大型电子邮件

> ID：14102778
> 
> 赞同：0
> 
> 时间：2012-12-31T14:30:27.567
> 
> 标签：actionscript-3, apache-flex, email, flex4

我在从 flex 发送文件时遇到了一些问题。我目前使用下面的代码。如果 bodyVar 小于 1967，则电子邮件填充良好。当我调用此代码时，会打开一条 Outlook 消息，其中包含 bodyVar 中的任何内容。如果超过 1967 年，则会打开一个空白页。

```
var mailMsg:URLRequest = new URLRequest("mailto:");
var variables:URLVariables = new URLVariables();
variables.subject = subVar;
variables.body = bodyVar;
mailMsg.data = variables;
mailMsg.method = URLRequestMethod.GET;
navigateToURL(mailMsg, "_self"); 
```

我正在使用 Firefox，我认为这个 1967 来自那个。如果我使用 IE，那么电子邮件甚至不会打开。

有谁知道一种在 flex 中发送电子邮件的方法，它允许我发送大量文本？我不受格式或图像等的困扰。我只需要能够发送文本

谢谢

**编辑**

我刚刚发现这段代码显示了另一种不使用 URLVariables 对象的方式。我认为这里的限制是在 http

```
var s:String = "";
s += "mailto:";
s+= sendTo.text;
s+= "?";
s+= "subject=";
s+= subjectVar;
s+= "&";
s+= "body=";
s+= bodyVar;
navigateToURL(new URLRequest(s)); 
```

**编辑 2** 明确地说，我想使用用户的电子邮件客户端打开一封新电子邮件。因此，如果他们安装了 Outlook，我希望打开一个 Outlook 消息，其中包含应发送的文本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-03T15:42:41.163

作为想法的组合：

1.  在具有选择地址、编辑文本等功能的弹性面板/窗口中显示消息文本。
2.  获取此信息并将其发送到服务器端对象（PHP 电子邮件、MAPI 等）以进行传递

本质上，您可以在 flex 中创建/编辑消息，您可以在其中看到所有内容。然后，您使用更强大的方法来发送它。

顺便说一句：服务器端并不意味着你有一个服务器——而是你有一些在 flex 之外的功能，用于实际的消息创建和传递。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-04T19:30:38.857

不久前我遇到了这个确切的事情。经过一番深入挖掘，我发现了这个问题：

问题是 Outlook（如 Internet Explorer）的 URI 字符限制为 2048 个字符（总长度这就是你被切断的原因）。Outlook 还具有 75 个收件人的最大收件人长度。

所以你的硬限制来自前景。我认为将 Firefox 设置为默认浏览器时它执行不同的原因是因为 firefox 支持的字符比 Internet Explorer 多得多。所以它会通过firefox......然后在outlook中死去。但是当你使用 IE 时，它会在 IE 中死掉，因为它们具有相同的小字符限制。

它显示为空白的原因是因为一旦达到这些限制之一，浏览器就会将 mailto:long 字符串转换为 mailto:"" （一个空字符串）。

我会推荐：

a) 强制 UI 中的字符限制保持较小 b) 使用服务器端脚本来发送电子邮件。

这是一个链接，显示所有不同的浏览器和电子邮件客户端及其相应的字符限制[Link to Limits Page](https://ronna-afghan.harmonieweb.org/helpdesk/Pages/MassEmaiTips.aspx)

# javascript - 以不同的方式访问 DOM 元素

> ID：14102782
> 
> 赞同：1
> 
> 时间：2012-12-31T14:31:09.273
> 
> 标签：javascript, html

我想在下面的 html 文档中访问 DOM 的 li2 元素，但是即使我指向 li2 我的访问方法也不起作用。这个问题只是为了了解基本的 DOM 访问方式。

```
<ol id="ol1">
    <li id="li1">
        <span id="span1">
            This is Text 1
        </span>
    </li>
    <li id="li2">
        <span id="span2">
            This is Text 2
         </span>
    </li>
    <li id="li3">
        <span id="span3">
            This is Text 3
        </span>
    </li>
</ol>

<div id="divContainer" ></div> 
```

我使用以下每个 liNode 来附加 divContainer 但它不起作用。

```
window.onload= initall;

function initall(){
     var liNode = document.getElementById("li1").nextSibling; 

    //var liNode = document.getElementById("li3").previousSibling; 

    //var liNode = document.getElementsByTagName("span").item(2).parentNode.previousSibling; 

    //var liNode = document.getELementsByTagName("ol").childNodes.item(1).parentNode.childNodes.item(1).parentNode.childNodes.item(1); 

    //var liNode = document.getElementsByTagName("body").item(0).firstChild.firstChild.nextSibling;

    //var liNode = document.body.childNodes.item(0).lastChild.previousSibling;

    document.getElementById("divContainer").appendChild(liNode);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:14:21.703

我相信您正在寻找的功能是[nextElementSibling](https://developer.mozilla.org/en-US/docs/DOM/element.nextElementSibling)，因为[nextSibling](https://developer.mozilla.org/en-US/docs/DOM/node.nextSibling)将检索文本节点，包括空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:39:21.223

看起来您正在尝试将元素附加到`<div>`元素内`<li id="li2">`。如果是这样，你就倒退了。我不确定您为什么要尝试获取上一个或下一个元素，而不是`li2`直接获取，但是如果我理解正确，您想这样做：

```
var div = document.getElementById('divContainer');
var liNode = document.getElementById('li2');

liNode.appendChild(div); 
```

* * *

或者，也许您正试图获取 的内容`li2`并将其放入`divContainer`. 如果是这种情况，那么试试这个：     [jsFiddle](http://jsfiddle.net/s2ms9/)

```
var div = document.getElementById('divContainer');
var liNode = document.getElementById('li2');

// firstChild gets you the text node after the li element (because of whitespace)
// nextSibling gets the next sibling of the text node, which is the span.
var newNode = liNode.firstChild.nextSibling.clone();
newNode.id = ''; // IDs should be unique on the page

div.appendChild(newNode); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:44:43.533

这将获得您正在寻找的元素：

```
 var liNode = document.getElementById("li1").nextSibling;
 while(liNode != null && liNode.tagName !="LI") liNode = liNode.nextSibling; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:48:58.730

问题`nextSibling`在于大多数浏览器会将空白或新行视为文本节点，而 Internet Explorer 不会。这就是为什么当您尝试获取下一个兄弟姐妹时，`nextSibling`您会得到一个空文本节点而不是下一个`<li>`元素。

如果您的 HTML 代码是这样的：

```
<ol id="ol1">
    <li id="li1">
        <span id="span1">
            This is Text 1
        </span>
    </li><li id="li2">
        <span id="span2">
            This is Text 2
         </span>
    </li><li id="li3">
        <span id="span3">
            This is Text 3
        </span>
    </li>
</ol> 
```

那么你的 javascript 代码就可以`nextSibling`像现在一样工作了。

但是如果你不想改变你的 HTML 代码，你可以使用`nextElementSibling`which 不会检索那些文本节点。

# javascript - 如何重新定位 SimpleDialog2？

> ID：14102783
> 
> 赞同：0
> 
> 时间：2012-12-31T14:31:10.393
> 
> 标签：javascript, html, jquery-mobile

我有[SimpleDialog2](http://dev.jtsage.com/jQM-SimpleDialog/demos2/index.html)，我显示和隐藏了一些内容，我想在隐藏一些数据后重新定位对话框，怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T15:07:16.283

我找到了一个解决方案，通过触发窗口的调整大小事件，这将为 SimpleDialog2 重新定位。

这是代码：

```
var evt = document.createEvent('UIEvents');
evt.initUIEvent('resize', true, false,window,0);
window.dispatchEvent(evt); 
```

在这里查看它的实际效果：http: [//jsfiddle.net/9hsBA/](http://jsfiddle.net/9hsBA/)

# apache - 山狮中的阿帕奇

> ID：14102785
> 
> 赞同：0
> 
> 时间：2012-12-31T14:31:25.247
> 
> 标签：apache, osx-mountain-lion

我正在尝试在 Mountain Lion 中设置 Apache，但对某些事情感到困惑。如果我去本地主机它说“它有效！”，但这是我能得到的。有很多关于如何将您的网站放在 localhost/~USERNAME 下的教程，但这似乎很烦人。我需要做什么才能在 localhost 而不是 localhost/~USERNAME 下获取网站？谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:53:30.820

您可以使用以下命令打开标准 Apache 配置

```
sudo vi /etc/apache2/httpd.conf 
```

在那里您可以更改标准文档根目录

```
DocumentRoot "/Library/WebServer/Documents" 
```

不管你喜欢什么，并忽略 ~/Sites 中的用户特定站点，不要忘记在进行配置更改后重新启动服务器。

# php - 将 Cakephp 会话设置为数据库

> ID：14102792
> 
> 赞同：4
> 
> 时间：2012-12-31T14:32:09.850
> 
> 标签：php, session, cakephp, cakephp-2.0, session-variables

我刚刚将我的应用程序从 cakephp1.3 迁移到 cakephp2.0。我在配置数据库会话时遇到问题。

我在 core.php 中更改了会话配置

```
Configure::write('Session', array(
    'defaults' => 'database',
        'handler' => array(
        'model' => 'Session'
        )
)); 
```

我有一个 db 表和一个**会话**。有什么我错过的吗。当我在登录时编写会话并重定向时，我可以很好地读取会话变量。但是在页面刷新时，会话被删除。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:48:50.860

据我了解，您正在尝试使用 Cake 的默认数据库会话处理，并且您没有使用自定义处理程序模型，如果是这样：

为 Cake 设置这些配置选项以使用以下数据库会话`app/config/core.php`：

```
Configure::write('Session', array(
    'defaults' => 'database'
)); 
```

确保为将用于创建正确表的数据库运行此命令，因为 Cake 会将会话存储在那里：

```
CREATE TABLE cake_sessions (
  id varchar(255) NOT NULL default '',
  data text,
  expires int(11) default NULL,
  PRIMARY KEY  (id)
); 
```

# sql - T-SQL 日期时间转换

> ID：14102793
> 
> 赞同：0
> 
> 时间：2012-12-31T14:32:14.250
> 
> 标签：sql, sql-server, tsql

我正在使用第 3 方数据库，该数据库（无论出于何种原因）内部以格式存储日期，`yyyymm`例如`201212`.`Dec 2012``INT`

有没有一种简单的方法可以将其转换为 SQL Server`DateTime`类型？

我已经尝试手动将上述转换为长度为 6 的字符序列，将其与 '01' 连接以获得给定月份的开始，如下所示：

```
(CONVERT(char(6), Period) + '01')` 
```

然后将其包装在`datetime`转换中：

```
CONVERT(datetime, (CONVERT(char(6), Period) + '01')) 
```

但这似乎扔了；

> *从字符串转换日期和/或时间时转换失败*

谁能阐明我做错了什么？

谢谢！:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:35:27.140

这是一种方法：

```
Declare @val as int = 20121231;
select DATEADD (YEAR,@val/10000-1900,DATEADD(MONTH,(@val%10000)/100-1,DATEADD(DAY,@val%100-1,0 ))) 
```

这是另一个：

```
Declare @val as int = 20121231;
    Cast(Cast(@val as char(8)) as date) 
```

第一个很好，因为您不会有任何区域设置依赖性。第二个很好，因为它很简短。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:38:23.653

您需要使用正确的参数。这是 msdn 图表[http://msdn.microsoft.com/en-us/library/ms187928.aspx](http://msdn.microsoft.com/en-us/library/ms187928.aspx)

在您的情况下，我相信您需要附加“01”并使用它

```
declare @val VARCHAR(8)

SET @val = '201212'

set @val = @val + '01'

print CONVERT(DATETIME, @val, 12) 
```

12 是 ISO 格式，将采用 yymmdd 或 yyyymmdd

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:50:56.850

我发现以下工作非常好。假设日期的 INT 格式为 YYYYMM。首先乘以 100，然后加 1（这导致 DD 为 01 的 INT），因此您现在有 YYYYMMDD 而不是 YYYYMM。然后在转换为 DATETIME 之前转换为 CHAR(8)。希望对你有效。

```
DECLARE @SourceDT   INT = 201212
SELECT CAST( CAST((@SourceDT * 100) + 1 AS CHAR(8)) AS DATETIME) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:44:59.093

你可以使用如下：

```
Select CAST( CAST(datepart(year,getdate()) AS VARCHAR(4))+ CAST (datepart(MONTH,getdate()) as VARCHAR(2)) AS INT) as YYYYMM 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T14:35:14.963

这应该做的东西：

```
DECLARE @Period INTEGER = 201212 
SELECT  CAST( CAST( @Period * 100 + 1 AS CHAR(8) ) AS DATETIME ) 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-31T14:38:33.593

将整数转换为`yyyy-mm-dd`样式字符串：

```
select  convert(datetime, 
            left(cast(dt as char(6)),4) + '-' +
            right(cast(dt as char(6)),2) + '-01',
            121) -- 121 = ODBC = yyyy-mm-dd hh:mi:ss.mmm (24h)
from    YourTable 
```

[SQL Fiddle 上的实时示例。](http://sqlfiddle.com/#!6/110cd/9/0)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-31T14:40:17.527

您可以通过一些简单的数学来做到这一点，尽可能避免使用字符串：

```
declare @Start int
set @Start = 201212

select DATEADD(month,((@Start/100)-1970)*12 + (@Start%100-1),'19700101') 
```

话虽这么说，我已经预料到你最初发布的内容，因为`YYYYMMDD`它是一种明确的格式。

* * *

如果您从可能包含一系列值的表中选择这些值，其中只有一些是这些值，并且您依赖该`WHERE`子句在转换发生之前过滤掉无效值，那么您就不走运了- SQL Server 有一个令人讨厌的移动操作的习惯，并且可以按照它喜欢的任何顺序应用过滤器和转换。

如果是这种情况，请将过滤步骤（以排除无效`Period`值）移动到填充表变量或临时表的单独查询中，然后在单独的查询中对这些值执行转换。

# javascript - 循环获取 - document.getElementById("random_0" + i).value = rnd;

> ID：14102794
> 
> 赞同：0
> 
> 时间：2012-12-31T14:32:21.347
> 
> 标签：javascript

经过大量修改后的项目（感谢每个人的投入）我仍然无法循环我的automateLottery（）；我的控制台一直告诉我-

TypeError: document.getElementById(...) is null document.getElementById("random_0" + i).value = rnd;

我已经在[http://jsfiddle.net/Ulleruller/2q2ne/17/上提出了我的项目](http://jsfiddle.net/Ulleruller/2q2ne/17/)

任何机构都可以让我知道这意味着什么吗？

比我能完成它-

坦克

```
 var match3 = 0, match4 = 0, match5 = 0, match6 = 0;
 var startLottery = false;
 var numberOfWeeks = 0;
 var numberOfMatches = 0;
 var totalWinnings = 0;
 var totalMatchedThisRound=0;
 var matchedNumbers = 0;

 var addUpMatches = function(matched){
matchedNumbers = matchedNumbers + matched;//---add up amount of matched numbers
totalMatchedThisRound = matchedNumbers; // ----store in new variable for 
};

var declareMatches = function(){//----declare matched numbers and keep totals 
switch(totalMatchedThisRound){
        case 3:
        console.log("Ching!! 3 matches");
        //console.log(amountOfThreeMatches);
        match3 = match3 + 1;
        totalWinnings = totalWinnings + 10;
        break;
        case 4:
        console.log("Ching!! 4 matches");
        match4 = match4 + 1;
        totalWinnings = totalWinnings + 70;
        break;
        case 5:
        console.log("Ching!! 5 matches");
        match5 = match5 + 1;
        totalWinnings = totalWinnings + 60000;
        break;
        case 6:
        console.log("Ching!! 6 matches");
        match6 = match6 + 1;
        totalWinnings = totalWinnings + 1000000;
        break;

        default:
        console.log("Alas only 2 or less matches");
        break;
           };

                   };

var clearCount = function(matched){ 
matchedNumbers = 0; //clears amount of matched numbers per round
};

var cleartempTotal = function(matched){ 
totalMatchedThisRound = 0; //clears amount of matched numbers per round
};

var start = function(){
startLottery = true;

};

var stop = function(){
startLottery = false;

};

function chooseNumbers() {//---chosen numbers check for doubles
    var checkForDouble ;
    var pickedNumbersArray= [];

    for(var t = 1; t < 7; t++){
        checkForDouble = parseInt(document.getElementById("picked_number_0" + t ).value);
                        document.getElementById("confirm_0" + t).value =  ("You have picked"+" " +document.getElementById("picked_number_0" + t ).value);
                        document.getElementById("confirm_0" + t).style.backgroundColor="green";

        for(var s = 0; s < 6; s++){
                if(checkForDouble == pickedNumbersArray[s]){
                    document.getElementById("confirm_0" + t).value =  ("Already chosen");
                    document.getElementById("confirm_0" + t).style.backgroundColor="red"
                }
        }
    pickedNumbersArray.push(checkForDouble);
    }
    };

var drawLotteryNumbers = function() { //generate numbers ensure unique
 var compareArray= []; 
 var rnd =0;

for(var i = 1; i < 7; i++){
            rnd = Math.floor((Math.random()*10)+1);
    while(rnd === compareArray[0]||rnd === compareArray[1]||rnd === compareArray[2]||rnd    === compareArray[3]||rnd === compareArray[4]||rnd === compareArray[5]){
                rnd = Math.floor((Math.random()*10)+1);
            };
            compareArray.push(rnd);
            document.getElementById("random_0" + i).value = rnd;
                    };
                };              

function automateLottery(){// generate - compare - stats
numberOfWeeks = numberOfWeeks + 1;//tally up rounds
drawLotteryNumbers();

var pickedNumber;
    for(var e = 1; e < 7; e++){
        document.getElementById("compare_0" + e).style.backgroundColor="white";
        document.getElementById("compare_0" + e).value=("No matches");
        pickedNumber = parseInt(document.getElementById("picked_number_0" + e).value);

        for(var i = 1; i < 7; i++){
            if(pickedNumber == document.getElementById("random_0" + i).value){
                document.getElementById("compare_0" + e).style.backgroundColor="green";
                document.getElementById("compare_0" + e).value=("You have matched number" + " "+ pickedNumber );
                addUpMatches(1); 
            }
        }
    }

    declareMatches();//----Add up per round and total
    document.getElementById("amountOfMatched").value = ("You have matched" + " " +totalMatchedThisRound + " "+ "numbers"); 
    document.getElementById("weeks").value = ("You have played for" + " " +numberOfWeeks + " "+ "weeks" );
    document.getElementById("moneyWon").value = ("You have won in total £"+ totalWinnings );
    document.getElementById("amountOfThreeMatches").value = ("You have so far had" + " " +match3 + " "+ "matches of three"  );
    document.getElementById("amountOffourMatches").value = ("You have so far had" + " " +match4 + " "+ "matches of four"  );
    document.getElementById("amountOffiveMatches").value = ("You have so far had" + " " +match5 + " "+ "matches of five"  );
    document.getElementById("amountOfsixMatches").value = ("You have so far had" + " " +match6 + " "+ "matches of six"  );

    clearCount();//clears amount matched every round
    cleartempTotal();//clears total matched every round
  };

 while(startLottery === true){
automateLottery();
  }; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:34:48.853

这正是它告诉你的意思。没有 ID 为“random_0”+ i 的元素，在本例中为“random_01”到“random_06”

# youtube - 如何在不使用 AS3 播放器的情况下将 youtube 视频集成到 Flex

> ID：14102795
> 
> 赞同：0
> 
> 时间：2012-12-31T14:32:20.877
> 
> 标签：youtube, flex4, youtube-api

我想只使用 Flex 视频播放器或任何其他媒体播放器来获取 youtube 视频，而不是在 Flex4 中使用 youtube AS3 播放器。

我已经提到了这个链接

[http://thanksmister.com/2007/04/27/flex-youtube-grabber/](http://thanksmister.com/2007/04/27/flex-youtube-grabber/)。

但是由于某种原因它不起作用。

youtube 是否允许在不使用 AS3 播放器的情况下播放视频？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-02T22:12:21.687

执行此操作的官方方法是[ActionScript 3 播放器](https://developers.google.com/youtube/flash_api_reference)。它几乎是为您的场景设计的，所以我不确定您为什么不愿意使用它。

一般来说，请确保您遵守[YouTube API 服务条款，](https://developers.google.com/youtube/terms)并且不要尝试通过任何非官方方式访问 YouTube 内容。

# python - python os.path.expanduser() 这总是真的吗

> ID：14102796
> 
> 赞同：2
> 
> 时间：2012-12-31T14:32:24.360
> 
> 标签：python, windows, macos, python-2.7

解决方案：正如 Thomas 在下面指出的那样，我被赋予的任务几乎不可能实现，并且必须动态确定数据，因为任何操作系统使用的模板结构都可以很容易地被覆盖，而且永远没有办法以保证可以正确应用预先构建的模板。我感谢所有回复的人（即使我一开始就很密集......）：-P

我目前无法访问基于 Mac 或 Windows 的机器，我正在开发一个跨平台项目（Win/Lin/Mac）。

在 linux 上，调用返回

```
os.path.expanduser('~') 
```

返回`/home/<user>`

现在在任何操作系统中，$home 目录结构都包含一个所有路径共有的最后一个点（在我的 linux 安装上`/home/<user>`，默认情况下主路径是`/home`最后一个公共点）。

所以我的问题（我现在不能简单地测试）是这样的：在 windows 和 mac 上，除非进行一些不寻常的重新配置（软件产品适用于普通家庭用户和青少年），否则返回路径的最后部分始终是第一个非-公共路径部分？

（这个问题可以说得更清楚，但我对如何解释这个问题感到困惑。这是重写三。）

编辑：在阅读下面评论中由 phihag 链接的文章后，我认为他要求更好地澄清我的预期用途（不可能的规范事情）。我要做的是确定返回的部分`os.path.expanduser('~')`，我可以从中转换为新的相对路径定义的第一部分，然后我可以从中创建更多的目录结构，这些目录结构是每个用户特定的应用程序。相当于`/home/<user>/.config/<MyAppHere>`或`\Documents and Settings\<user>\Application Data\Roaming\<MyAppHere>`。我的最终结果将使用（如果可以根据我的意图确定此问题为真）以下内容：

```
# Assumes linux system and home path of /home/<user
head, tail = os.path.split(os.path.expanduser('~'))
userConfigPath = os.path.join(tail,'.config',MYAPPNAME)

# userConfigPath then gets written to a config file which is used by the program
# to determine where (within a greater structure) to look for a user based
# configuration which expands or overrides system configuration options. 
```

编辑：与 Thomas Orozco（下）交换信息后：在软件执行的这个阶段，它不知道在哪里寻找自定义用户配置。从配置文件中读取的不是绝对地址，而是如何为配置文件构建绝对地址的模板。

有问题的软件与视频游戏有关，目标用户群是使用标准家用计算机的青少年或成年人。这些用户中的大多数不使用特殊的配置选项，例如自定义的主用户目录位置。这部分代码适用于任何操作系统的所谓规范，并且忽略了对相关操作系统进行定制的可能性。虽然以编程方式是不好的做法，但这是我目前所坚持的。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T15:10:19.343

在 Linux 上甚至都不是这样。看看`/etc/adduser.conf`：

*   `GROUPHOMES=yes`将让`adduser`创建房屋，例如：`/home/groupname/user.`
*   `LETTERHOMES=yes`会创建一个看起来像：`/home/u/user`.

这只是默认设置。你可以把你家放在任何你喜欢的地方。

* * *

关于您要实现的目标，为什么以下内容不合适？

```
from os.path import join, expanduser
join(expanduser('~'), '.config') # You could have something more funky if you want to. 
```

然后，只需在应用程序运行时即时计算此路径，无需将其硬编码到您的应用程序中。

# java - 如何在 RESTful Web 服务中使用 jersey 框架抛出 HTTP 204 状态代码？

> ID：14102797
> 
> 赞同：16
> 
> 时间：2012-12-31T14:32:37.553
> 
> 标签：java, web-services, rest, jersey, jax-rs

我正在使用 jersey 框架来开发 RESTful Web 服务。我使用以下代码响应各种 HTTP 状态代码：

```
public class RestNoContentException extends WebApplicationException 
{
    public RestNoContentException(String message) 
    {
        super(Response.status(Status.NO_CONTENT)
            .entity(message).type("text/plain")
            .build());
        }
} 
```

使用 Firefox Mozilla REST 客户端工具测试 REST Web 服务时，它显示的是`200 OK`状态而不是`204 NO CONTENT`. 我正在以与处理状态代码相同的方式处理其他状态代码`204`。其他状态代码在休息客户端工具上正确显示，但是当显示`204`状态代码时，它正在显示`200 OK`状态代码。

有人可以帮我吗？我错过了什么？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-01-01T04:58:34.187

首先，204 属于响应代码的“成功”类别，因此将其作为异常结果返回是一件非常非常奇怪的事情。

其次，204 表示“No Content”，表示响应不包含实体，但您在其中放入了一个实体。Jersey 很可能会为您将其切换为 200，这与 204 基本相同，只是它包含一个响应实体。

最后，您可以通过几个内置行为非常简单地获得 204 响应：void 方法和 null 返回值都映射到 204 响应。否则，只需 return `Response.status(204).build()`。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-01T02:21:04.160

You shouldn't give entity if you want throw 204:

```
@GET
@Produces(MediaType.TEXT_PLAIN)
public Response test() {
    //return Response.status(Status.NO_CONTENT).entity("hello").build(); //this will throw 200
    return Response.status(Status.NO_CONTENT).build();
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-01-04T13:08:26.940

只需添加到现有响应中的一件事。泽西正在做的是[规范的正确行为](http://download.oracle.com/otndocs/jcp/jaxrs-1.1-mrel-eval-oth-JSpec/)：

> **3.3.3 返回类型**
> 
> 资源方法可以返回 void、Response、GenericEntity 或其他 Java 类型，这些返回类型映射到响应实体主体，如下所示：
> 
> **void**产生一个带有 204 状态代码的空实体主体。
> 
> **响应**生成从响应的实体属性映射的实体主体，其状态代码由响应的状态属性指定。空返回值导致 204 状态代码。如果未设置 Response 的状态属性：非空实体属性使用 200 状态码，如果实体属性为空，则使用 204 状态码。
> 
> **GenericEntity**生成从 GenericEntity 的 Entity 属性映射的实体主体。如果返回值不为空，则使用 200 状态代码，空返回值将导致 204 状态代码。
> 
> **从返回的实例的类映射的实体主体中的其他**结果。如果返回值不为空，则使用 200 状态代码，空返回值将导致 204 状态代码。
> 
> [...]

由于您使用的是异常，因此以下部分适用（强调我的）：

> **3.3.4 例外情况**
> 
> 资源方法、子资源方法或子资源定位器可能会抛出任何已检查或未检查的异常。实现必须捕获所有异常并按如下方式处理它们：
> 
> 1.  WebApplicationException 的实例必须按如下方式映射到响应。如果异常的响应属性不包含实体并且异常映射提供者（参见第 4.4 节）可用于 WebApplicationException，则实现必须使用提供者创建新的响应实例，**否则直接使用响应属性。然后根据第 3.3.3 节处理生成的 Response 实例。**
> 
> [...]

因此，您应该返回 null、void 或构建 204 响应。只有当它是您的应用程序中的例外情况时，您才抛出异常，并且抛出异常[可以明确这一点](https://stackoverflow.com/questions/13359396/webapplicationexception-vs-response/)。

# c# - 访问 GUI 元素未按预期工作

> ID：14102800
> 
> 赞同：1
> 
> 时间：2012-12-31T14:33:19.393
> 
> 标签：c#, wpf, multithreading, user-interface, task

当我运行下面的代码时，它应该`ListBox`用 each`DataRow`的值填充，但它`ListBox`用 single`DataRow`的值填充。

有什么问题，我该如何解决？这是一个 C# 4.0 WPF 应用程序。

```
 Task.Factory.StartNew(() =>
    {
        myThread();
    });

void myThread()
{
    using (DataTable dtTemp = DbConnection.db_Select_DataTable(srQuery))
    {
        foreach (DataRow drw in dtTemp.Rows)
        {   
            this.Dispatcher.BeginInvoke(new Action(delegate()
            {
                listBox1.Items.Add(drw["Value"].ToString());
            }));
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:37:44.457

问题是您正在`drw`匿名方法中捕获变量。该变量正在`foreach`循环中更新，因此当您的委托在调度程序线程上被调用时，您每次都会获得相同的值。在 C# 5 中，这是可以的（这是一个常见的错误，语言已经改变以避免它）但在 C# 5 之前，您需要在循环中复制变量：

```
foreach (DataRow drw in dtTemp.Rows)
{   
    DataRow copy = drw;
    this.Dispatcher.BeginInvoke(new Action(delegate()
    {
        listBox1.Items.Add(copy["Value"].ToString());
    }));
} 
```

或者更好的是，在后台线程中进行所有数据访问：

```
foreach (DataRow drw in dtTemp.Rows)
{   
    string item = drw["Value"].ToString();
    this.Dispatcher.BeginInvoke(new Action(delegate()
    {
        listBox1.Items.Add(item);
    }));
} 
```

请注意，对 C# 5 的更改*仅*影响`foreach`- 而不是`for`循环。

另请注意，您的代码可以使用 lambda 表达式而不是匿名方法稍微缩短：

```
foreach (DataRow drw in dtTemp.Rows)
{   
    string item = drw["Value"].ToString();
    Action action = () => listBox1.Items.Add(item);
    this.Dispatcher.BeginInvoke(action);
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-31T14:36:54.380

变量捕捉再次来袭。（谷歌：[变量捕获](http://google.com/search?q=variable+capture)）

尝试创建一个临时变量并将其传递给线程，如下所示：

```
void myThread()
{
    using (DataTable dtTemp = DbConnection.db_Select_DataTable(srQuery))
    {
        foreach (DataRow drw in dtTemp.Rows)
        {
            DataRow tmp = drw;
            this.Dispatcher.BeginInvoke(new Action(delegate()
            {
                listBox1.Items.Add(tmp["Value"].ToString());
            }));
        }
    }
} 
```

# c++ - C++ 按条款包含文件

> ID：14102808
> 
> 赞同：1
> 
> 时间：2012-12-31T14:33:54.940
> 
> 标签：c++, visual-c++, include, preprocessor-directive

假设我在 VC++ 环境中有一个程序。该程序需要修改自身才能将某些代码用于不同的操作系统。

例如，假设程序将修改代码为 do和 for`A`它将修改代码为 do 。位于文件上的操作代码和位于文件上的操作代码。`Windows XP``Windows 7``B``A``"a.h"``B``"b.h"`

假设我有一个功能，其目的是检测操作系统。如果我希望通过检测操作系统仅加载其中一个文件，如何通过激活功能等术语包含文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:38:28.800

你不能做你暴露它的事情。

该`#include`机制由预编译器处理，它在编译时运行，而不是在运行时运行，因此，一旦你的二进制文件被编译，所有的预编译器选择都已经做出并进入最终的可执行文件。

要根据 Windows 的版本做不同的事情，您必须包含两种行为的代码并在运行时选择正确的行为，例如使用`GetVersionEx`API 的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T15:15:17.007

您暗示您希望使用预处理器有条件地构建不同的可执行文件，而不是影响运行时行为。这样做的结果是您将拥有每个不同操作系统的可执行文件。这可能是也可能不是你想要的，并带来了它自己的陷阱。

一般来说，避免条件编译是值得的，除非你的代码*根本不会*在任何其他环境上构建。可能更好的解决方案是在运行时派生特定功能。这可以通过检测操作系统或配置等来完成。

您可能需要考虑一些专门在运行时动态加载库的方法。您可以使用`dlopen`Linux 上的函数族来执行此操作（不确定 Windows，但我确信有类似的东西。）一个缺点是几乎没有检查方法，因此如果您弄错界面，请期待 seg故障。此外，接口仅限于 C 链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T15:23:25.703

是的，因此完全有可能创建在现代和旧版本的 Windows 上运行的可执行文件。执行此操作的典型方法是检查实际版本，然后更改代码。MS在这里告诉你如何检查版本：

[http://msdn.microsoft.com/en-gb/library/windows/desktop/ms724429(v=vs.85).aspx](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms724429(v=vs.85).aspx)

然后你只需做一个标志，说它`bool isWndowsXP`是由检查代码设置的，并且在相关的地方做`if(isWindowsXP) do_stuff_xp_way(); else do_stuff_otherway();`

如果您需要更具体的建议，您确实需要提供隐藏在问题中 A 和 B 后面的功能。

# video.js - VIDEO JS：海报图片未在 IE8 上的 Flash 后备中显示

> ID：14102810
> 
> 赞同：0
> 
> 时间：2012-12-31T14:34:01.527
> 
> 标签：video.js

我在使用新的 videojs 时遇到了一个小问题。除了 Flash 中的后备图像外，一切正常。以下是示例：[http](http://www.360-webdesign.fr/preprod/seasonsgreetings2012/) ://www.360-webdesign.fr/preprod/seasonsgreetings2012/ 注意：无论您使用的是什么浏览器或版本，我都故意将其作为 Flash 的后备。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-01T21:49:51.960

[http://browsershots.org](http://browsershots.org)

360-webdesign.fr/--- 未出现在 msie 5、6、7、8 中。在 msie9 工作

浏览器截图

[http://s1300.beta.photobucket.com/user/aberrated/media/360webdesignnotappearinginmsei556070806_zps7f8a9385.jpg.html](http://s1300.beta.photobucket.com/user/aberrated/media/360webdesignnotappearinginmsei556070806_zps7f8a9385.jpg.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-01T21:26:42.303

我按照您的页面源代码返回您的照片，但一无所获。这意味着文件名不正确。检查拼写错误和拼写错误。

你的海报 照片应该在这里

[http://360-webdesign.fr/img/chaumet.jpg](http://360-webdesign.fr/img/chaumet.jpg)

这是您的主站点上的一张照片，通过以相同方式链接它出现。

[http://360-webdesign.fr/img/contact_label_open.png](http://360-webdesign.fr/img/contact_label_open.png)

海报图像未出现，因为调用的文件不正确。

只是为了让您知道您的网站甚至不会在我的 Internet Explorer 8 上显示文本或图像。您的页面未出现在 msie 5、6、7 或 8 中。 msie 9 显示正常

要检查您的图像的广泛显示方式，您可以访问 browsershots.org

# python - Reddit 的一行代码（排名功能）让我很困惑

> ID：14102819
> 
> 赞同：3
> 
> 时间：2012-12-31T14:34:58.007
> 
> 标签：python, reddit

代码来自此页面： [https ://github.com/reddit/reddit/blob/master/r2/r2/lib/db/_sorts.pyx](https://github.com/reddit/reddit/blob/master/r2/r2/lib/db/_sorts.pyx)

这是代码片段：

```
cpdef double epoch_seconds(date):
"""Returns the number of seconds from the epoch to date. Should
   match the number returned by the equivalent function in
   postgres."""
td = date - epoch
return td.days * 86400 + td.seconds + (float(td.microseconds) / 1000000) 
```

我认为`td.days * 86400`应该等于`td.seconds`以及`(float(td.microseconds) / 1000000)`，我想知道他们为什么不简单地让 td.seconds 乘以 3？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-31T14:40:13.000

你的假设是错误的，这就是为什么这看起来很奇怪。`td.days`包含自您正确假设的纪元以来的天数，但`td.seconds`分别`td.microseconds`包含自一天开始以来的秒数和自一秒开始以来的微秒数。因此，返回值变为自纪元以来的秒数，微秒作为逗号后的部分。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:39:46.183

`td.days`是整数天数，截断一天的任何部分。同样，`td.seconds`是该“一天的小数部分”内的整数秒数，任何一秒的小数部分都会被截断。因此，您必须将组件拼凑在一起。

# macos - OS X 上的 libstdc++ gcc

> ID：14102823
> 
> 赞同：0
> 
> 时间：2012-12-31T14:35:27.060
> 
> 标签：macos, gcc, libstdc++

是否可以在 OS X 上使用`libstdc++`from ？`gcc`我必须下载完整版`gcc`还是`LLVM`好？标题是`#include`什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T18:59:10.363

从[您之前的问题](https://stackoverflow.com/q/14096026/981959)和评论来看，您对 libstdc++ 中包含的十进制扩展感兴趣，而不仅仅是 libstdc++ 本身。

您可以在 OS X 上轻松使用 libstdc++ 和/或 GCC，它们应该包含在 Xcode 中，但只有一个非常旧的版本 GCC 4.2，它不包含您感兴趣的小数扩展。

要使用这些扩展，您需要安装 GCC 4.5 或更高版本并使用它而不是默认的 clang 或 gcc-4.2 编译器。

# ivy - 使用版本匹配器/状态的常春藤内联解析

> ID：14102826
> 
> 赞同：1
> 
> 时间：2012-12-31T14:35:36.720
> 
> 标签：ivy

我有兴趣知道如何使用版本匹配器进行“内联”解析。

问题陈述：我在共享存储库中发布了来自两个版本的工件。Rel 1 有订单的修订版 - 1.1、1.2 等等，Rel 2 有订单的修订版 - 2.1、2.2、2.3 等等。

我需要用来自不同版本（Rel 1、Rel 2 等）的最新战争来创建一个耳朵。为此，我试图通过迭代以下代码段来内联解决不同的战争：

```
 <ivy:resolve  organisation="com.barclays.eps" module="scp-eps-cards" 
                changing="true" revision="latest.LIVE-build-rel-@{i}" inline="true" transitive="false" keep="true" refresh="true" type="war"/>

            <ivy:retrieve pattern="target/ear/[artifact]-[revision]-@{i}.[ext]" 
                organisation="com.barclays.eps" module="scp-eps-cards" revision="latest.LIVE-build-rel-@{i}" inline="true" transitive="false" type="war" />
            <ivy:retrieve ivypattern="target/ear/[artifact]-[revision]-2.[ext]" 
                organisation="com.barclays.eps" module="scp-eps-cards" revision="latest.LIVE-build-rel-@{i}" inline="true" transitive="false" type="xml" /> 
```

已按以下顺序在 ivy-settings.xml 文件中设置状态：

```
 <statuses default="dev-build-rel-2">
    <status name="LIVE-build-rel-2" integration="true"/>
    <status name="daily-build-rel-2" integration="true"/>
    <status name="dev-build-rel-2" integration="true"/>
    <status name="dev-build-rel-1" integration="true"/>
    <status name="release" integration="false"/>
    <status name="integration" integration="true"/>
</statuses> 
```

但是，当我尝试解决时，由于提到它的顺序，我只得到了 status="LIVE-build-rel-2" 的工件。

我想知道这是否可以通过在执行内联解析时使用版本匹配器来实现。我尝试过使用相同的方法，但出现错误：找不到 foo(2)

有人可以帮我吗？

提前致谢。

# android - 如何延迟加载煎茶视图

> ID：14102830
> 
> 赞同：0
> 
> 时间：2012-12-31T14:35:56.423
> 
> 标签：android, cordova, extjs, sencha-touch, sencha-touch-2

在我的应用程序完成加载后，我正在显示选项卡面板，默认的第一个选项卡（选项卡面板中的第一项）将出现在屏幕中。

```
 Ext.Viewport.add({
        xtype : 'myTab'
    }); 
```

当标签面板加载时，我将根据纬度和经度在第一个标签中显示一组消息。

我在控制器初始化方法中使用phonegap获取纬度和经度，控制器初始化方法将在其他任何事情之前首先被调用。

我正在向我的服务器发送一个 ajax 请求，并在第一次绘制选项卡时将纬度和经度作为参数。

**我的问题是 phonegap 需要一些时间给出纬度和经度，在我得到纬度和经度之前，我的观点很痛苦并且 ajax 请求正在发生。**

**所以我无法使用 ajax 请求将纬度和经度作为参数发送。**

我怎样才能延迟标签面板被痛苦一段时间？

这是我获取纬度和经度的电话间隙代码（在控制器初始化方法中）。

```
 var gotLocation = false;
    var GEO_OPTS = {
        enableHighAccuracy : true,
        maximumAge : 120000,
        timeout : 6000
    };
    var onSuccess = function(position) {
        if (gotLocation)
            return;
        console.log('inside onsuccess');
        if (position.coords.accuracy <= 1000) {
            var lat = position.coords.latitude;
            var lon = position.coords.longitude;

            console.log('Got location at end');
            gotLocation = true;
            // proceed to fetch messages
            var radius = localStorage.radius ? localStorage.radius : 5;

            console.log('radius :' + radius);
            var unit = localStorage.unit ? localStorage.unit : "M";
            var rangeText = ' ' + radius;
            if (unit == 'M')
                rangeText = rangeText + ' mi';
            else
                rangeText = rangeText + ' km';
            var listCaption = 'All wants within' + rangeText;

            localStorage.latitude = lat;
            localStorage.longitude = lon;
            localStorage.radius = radius;
            localStorage.unit = unit;
            localStorage.rangeText = rangeText;
            localStorage.listCation = listCaption;
            console.log('Range Text:' + rangeText);
            console.log('list Caption:' + listCaption);
        }
    };

    var onError = function (error) {
        navigator.notification
                .alert("oops..." + error.code + error.message);
    };

    navigator.geolocation.getCurrentPosition(onSuccess, onError, GEO_OPTS); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T05:16:16.543

您可以做 2 件事
1\. 为将选项卡面板添加到视口的代码添加一些延迟

```
Ext.defer(function(){ 
    Ext.Viewport.add({
      xtype : 'myTab'
    });
}, 500, this); 
```

2.在success handler函数中添加mytab

```
var onSuccess = function(position) {
    /* All the existing code*/
    Ext.Viewport.add({
        xtype : 'myTab'
    });
} 
```

# android - 应用程序 xyz 已意外停止。请重试

> ID：14102834
> 
> 赞同：-2
> 
> 时间：2012-12-31T14:36:39.217
> 
> 标签：android

我开发了一个`android`应用程序，起初几天它运行良好。但后来，当我检查时，它不起作用。现在，当我以前在我的设备或模拟器中启动它时，它会显示消息，如**应用程序 xyz 已意外停止。请重试。**有谁能够帮我？

这是我的 Logcat

```
12-31 20:20:52.142: D/AndroidRuntime(303): Shutting down VM
12-31 20:20:52.172: W/dalvikvm(303): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
12-31 20:20:52.202: E/AndroidRuntime(303): FATAL EXCEPTION: main
12-31 20:20:52.202: E/AndroidRuntime(303): java.lang.RuntimeException: Unable to instantiate activity ComponentInfo{a.b.c/a.b.c.MapsActivity}: java.lang.ClassNotFoundException: a.b.c.MapsActivity in loader dalvik.system.PathClassLoader[/system/framework/com.google.android.maps.jar:/data/app/a.b.c-2.apk]
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2585)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.app.ActivityThread.access$2300(ActivityThread.java:125)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:2033)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.os.Looper.loop(Looper.java:123)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-31 20:20:52.202: E/AndroidRuntime(303):  at java.lang.reflect.Method.invokeNative(Native Method)
12-31 20:20:52.202: E/AndroidRuntime(303):  at java.lang.reflect.Method.invoke(Method.java:521)
12-31 20:20:52.202: E/AndroidRuntime(303):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-31 20:20:52.202: E/AndroidRuntime(303):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-31 20:20:52.202: E/AndroidRuntime(303):  at dalvik.system.NativeStart.main(Native Method)
12-31 20:20:52.202: E/AndroidRuntime(303): Caused by: java.lang.ClassNotFoundException: a.b.c.MapsActivity in loader dalvik.system.PathClassLoader[/system/framework/com.google.android.maps.jar:/data/app/a.b.c-2.apk]
12-31 20:20:52.202: E/AndroidRuntime(303):  at dalvik.system.PathClassLoader.findClass(PathClassLoader.java:243)
12-31 20:20:52.202: E/AndroidRuntime(303):  at java.lang.ClassLoader.loadClass(ClassLoader.java:573)
12-31 20:20:52.202: E/AndroidRuntime(303):  at java.lang.ClassLoader.loadClass(ClassLoader.java:532)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.app.Instrumentation.newActivity(Instrumentation.java:1021)
12-31 20:20:52.202: E/AndroidRuntime(303):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2577)
12-31 20:20:52.202: E/AndroidRuntime(303):  ... 11 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:51:07.197

你的应用程序有一个BUG。

检查 LogCat 看看会发生什么，也许这是一个未经处理的异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:43:33.823

尝试

在清单文件中添加这样的“uses-library”。

```
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="com.example.package.name">
      ...
      <application android:name="MyApplication" >
        <uses-library android:name="com.google.android.maps" />
        ...
      </application>
     ...
    </manifest> 
```

并清理并重建您的项目并尝试。

如果这不起作用，请尝试添加一些代码，以便我们进行调查。

# php - Paypal Express 结帐超时

> ID：14102835
> 
> 赞同：0
> 
> 时间：2012-12-31T14:36:52.570
> 
> 标签：php, paypal

与 Paypal Express Checkout、PHP SDK 集成，在沙盒中测试并运行良好，在现场测试，运行良好。

刚收到一些付款失败的通知。就我而言，一切正常，没有任何改变，但现在它停止工作了:(

当我尝试它时，我得到一个致命错误，并且调试返回：

```
[url:PPConnectionException:private] => https://api-3t.paypal.com/2.0/
[message:protected] => connect() timed out! 
```

它在 SetExpressCheckout() 上失败，我检查了 API 密码和签名，自从它工作以来没有改变。代码本身也没有。

有点生气，因为它的 NYE，我的另一半生日，就在一周前，我们有了第二个孩子，所以我正在享受陪产假，现在必须处理这个:(我很难过，有什么想法吗？

# android - 具有自定义布局的 Android 对话框：返回数据

> ID：14102839
> 
> 赞同：5
> 
> 时间：2012-12-31T14:37:03.880
> 
> 标签：android, layout, dialog

我在获取数据时遇到问题，用户输入`dialog`（使用自定义布局）。看代码：

单位.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent">

<EditText
    android:id="@+id/editText1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content">
</EditText>
</RelativeLayout> 
```

代码：

```
 AlertDialog.Builder builder = new AlertDialog.Builder(this);
    LayoutInflater inflater = this.getLayoutInflater();
    builder.setView(inflater.inflate(R.layout.unit, null)); 
    AlertDialog dialog = builder.create();
    dialog.show(); 
```

`Dialog`以我创建的布局打开，但是

```
 builder.setPositiveButton("Add", new DialogInterface.OnClickListener() {
          @Override
          public void onClick(DialogInterface dialog, int which) {
                        EditText text = (EditText)findViewById(R.id.editText1);
                        Toast.makeText(getApplicationContext(), text.getText(), Toast.LENGTH_SHORT).show();
            dialog.dismiss();
          }

        }); 
```

产生运行时错误：`java.lang.NullPointerException`。哪里有问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T18:47:58.860

用这个..

```
 builder.setPositiveButton("Add", new DialogInterface.OnClickListener() {
      @Override
      public void onClick(DialogInterface dialog, int which) {
                    EditText text = (EditText) dialog.findViewById(R.id.editText1);
                    Toast.makeText(getApplicationContext(), text.getText(), Toast.LENGTH_SHORT).show();
        dialog.dismiss();
      }

    }); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:43:44.733

找到了：

```
AlertDialog aDialog = (AlertDialog) dialog;
EditText name = (EditText) aDialog.findViewById(R.id.editText1); 
```

# templates - 在 Go 中显示 html 模板的计数

> ID：14102845
> 
> 赞同：7
> 
> 时间：2012-12-31T14:37:37.660
> 
> 标签：templates, go

在 Go 中使用 html/templates 可以执行以下操作：

```
<table class="table table-striped table-hover" id="todolist">
    {{$i:=1}}
    {{range .}}         
    <tr>
        <td><a href="id/{{.Id}}">{{$i}}</a></td>
        <td>{{.Title}}</td>
        <td>{{.Description}}</td>
        </tr>
        {{$i++}}

    {{end}}
</table> 
```

每次我添加 $i 变量时，应用程序都会崩溃。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-31T20:31:45.377

在我的[html 模板](http://golang.org/pkg/html/template/)中：

```
<table class="table table-striped table-hover" id="todolist">
        {{range $index, $results := .}}         
        <tr>
            <td>{{add $index 1}}</td>
            <td>{{.Title}}</td>
            <td>{{.Description}}</td>
            </tr>
        {{end}}
    </table> 
```

在 go 代码中，我编写了一个传递给 FuncMap 的函数：

```
func add(x, y int) int {
    return x + y
} 
```

在我的处理程序中：

```
type ToDo struct {
    Id          int
    Title       string
    Description string
}

func IndexHandler(writer http.ResponseWriter, request *http.Request) {
    results := []ToDo{ToDo{5323, "foo", "bar"}, ToDo{632, "foo", "bar"}}
    funcs := template.FuncMap{"add": add} 
  temp := template.Must(template.New("index.html").Funcs(funcs).ParseFiles(templateDir + "/index.html"))
    temp.Execute(writer, results)
} 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-31T14:56:53.673

查看`Variables`部分`text/template`

[http://golang.org/pkg/text/template/](http://golang.org/pkg/text/template/)

```
range $index, $element := pipeline 
```

# c - 跟随 malloc(0) 返回的指针

> ID：14102850
> 
> 赞同：0
> 
> 时间：2012-12-31T14:37:57.913
> 
> 标签：c, variables, pointers, malloc

我试图理解一部分代码。我省略**了很多**代码，以使其更易于解释，并避免不必要的混淆。

```
typedef void *UP_T;

void FunctionC(void *pvD, int Offset) {
    unsigned long long int temp;
    void *pvFD = NULL;

    pvFD = pvD + Offset;
    temp = (unsigned long long int)*(int *)pvFD;
}

void FunctionB(UP_T s) {
    FunctionC(s, 8);
}

void FunctionA() {
    char *tempstorage=(char *)malloc(0);
    FunctionB(tempstorage);
}

int main () {
    FunctionA();
    return 0;
} 
```

就像我说的，我遗漏了大量代码，因此这些函数*看起来*毫无用处，因为它们只有两行代码。

是什么`temp`？这就是让我感到困惑的地方。当我运行与此代码类似的东西并`printf()`沿途使用语句时，我得到一个随机数`pvD`，并且`pvFD`是该随机数加八。

但是，我也可能错误地打印了值（使用`%llu`而不是`%d`，或类似的东西）。我很确定它是指向内存中`tempstorage`加 8 位置的指针。这是正确的吗？在我继续这个假设之前，我只想确定一下。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:42:06.550

该标准指定`malloc(0)`返回 NULL 或有效指针，**但该指针永远不会被取消引用。**实际实现没有任何限制，因此您不能依赖返回的指针是另一个加 8。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:39:59.943

它在某种意义上是随机的，`malloc`通常是不确定的（即每次运行都会给出不同的结果）。

结果`malloc(0)`是实现定义的（但完全有效），你永远不应该取消引用它。您也不应该尝试对其进行算术运算（但这通常是正确的；您不应该使用算术来创建超出分配内存范围的指针）。但是，调用`free`它仍然可以。

# c#-4.0 - 如果可能的话，为 Enum 写一个扩展

> ID：14102858
> 
> 赞同：0
> 
> 时间：2012-12-31T14:38:27.527
> 
> 标签：c#-4.0, extension-methods

> **可能重复：**
> [枚举扩展方法](https://stackoverflow.com/questions/276585/enumeration-extension-methods)

我有一种情况，我想在我`extension`的几个枚举器中添加一个以快速提取信息。已经编写了一个静态方法来作为辅助方法执行此操作，但想知道是否也可以将其缩短为扩展？

现在的签名，再次不确定它的可能。只是推动我的知识门槛和界限；）

```
public static string EnumString( this Type par , object val ) {
    return Enum.GetName( typeof( par ) , val );
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:58:00.853

### 所描述的结果方法`JordonKaye`

延期：

```
/// <summary>
/// Returns the string value of the Enumerator
/// </summary>
/// <param name="par">Type object, Should be an Enumerator Type</param>
/// <param name="val">Object type, Should be the value of the Enumerator to return as string</param>
/// <returns>String value, the String value form of the Enumerator item.
/// If the passed object value (@val) is NOT valid, Returns NULL
/// If passed object value (@val) IS valid, Returns string value of @val</returns>
public static string EnumString( this Enum par , object val ) {
    if( Enum.IsDefined( par.GetType() , val ) ) {
        return Enum.GetName( par.GetType() , val );
    } else {
        return null;
    }
} 
```

共享方法，Helper 行：

```
public static string EnumString( Enum par , object val ) {
    if( Enum.IsDefined( par.GetType() , val ) ) {
        return Enum.GetName( par.GetType() , val );
    } else {
        return null;
    }
} 
```

# doctrine-orm - Doctrine 2 - EntityRepository 的排序方法？

> ID：14102860
> 
> 赞同：2
> 
> 时间：2012-12-31T14:38:32.967
> 
> 标签：doctrine-orm

有没有办法`EntityRepository`使用特定标准对 Doctrine 2 对象进行排序，或者如果我想传递特定的排序参数，我是否必须使用 DQL 查询？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T15:21:43.423

您可以通过将第二个参数传递给 find___ 方法来返回一组有序的元素，此参数必须是一个关联数组，其中键是您要排序的字段的名称，值是“ASC”或“DESC” .

```
// query for one product matching be name and price
$product = $repository->findOneBy(array('name' => 'foo', 'price' => 19.99));

// query for all products matching the name, ordered by price
$product = $repository->findBy(
    array('name' => 'foo'),
    array('price' => 'ASC')
); 
```

[http://symfony.com/doc/current/book/doctrine.html#fetching-objects-from-the-database](http://symfony.com/doc/current/book/doctrine.html#fetching-objects-from-the-database)

当然，如果你想要一个最复杂的行为，你应该实现一个自定义存储库。

# c# - WebSocket 无法发送大数据

> ID：14102862
> 
> 赞同：5
> 
> 时间：2012-12-31T14:38:39.627
> 
> 标签：c#, javascript, websocket

如何在 Java Script 中将大数据发送到 WebSocket？

使用下面的代码，我可以发送 126 个字符的数据，但不能超过这个。（用 C# 编写）

```
public static void SendData(string text)
    {

        foreach (SocketClient client in ClientList)
        {
            if (client.Client.Connected)
            {
                try
                {

                    NetworkStream l_Stream = client.Client.GetStream();

                    List<byte> lb = new List<byte>();
                    lb = new List<byte>();
                    lb.Add(0x81);
                    int size = text.Length;
                    lb.Add((byte)size);
                    lb.AddRange(Encoding.UTF8.GetBytes(text));
                    l_Stream.Write(lb.ToArray(), 0, size + 2);

                }
                catch
                {
                    CloseClient(client);
                }
            }
        }
    }
} 
```

有人可以帮帮我吗？我尝试使用很多东西，但没有一个对我有用。

我正在使用 Chrome 25。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-02T08:49:45.413

这是根据 RFC 6455 的 websocket 框架的外观：

```
 0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-------+-+-------------+-------------------------------+
 |F|R|R|R| opcode|M| Payload len |    Extended payload length    |
 |I|S|S|S|  (4)  |A|     (7)     |             (16/64)           |
 |N|V|V|V|       |S|             |   (if payload len==126/127)   |
 | |1|2|3|       |K|             |                               |
 +-+-+-+-+-------+-+-------------+ - - - - - - - - - - - - - - - +
 |     Extended payload length continued, if payload len == 127  |
 + - - - - - - - - - - - - - - - +-------------------------------+
 |                               |Masking-key, if MASK set to 1  |
 +-------------------------------+-------------------------------+
 | Masking-key (continued)       |          Payload Data         |
 +-------------------------------- - - - - - - - - - - - - - - - +
 :                     Payload Data continued ...                :
 + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - +
 |                     Payload Data continued ...                |
 +---------------------------------------------------------------+ 
```

您正在字节 1 中设置 websocket 帧的有效负载长度（第二个字节 - 第一个字节是字节 0）。一个字节只能有 256 个状态。但是字节 1 的第一位用于屏蔽标志。所以你只能表示从 0 到 127 的值。

当有效载荷长度大于 125 时，您必须将字节 1 设置为 126，并将长度放入字节 2 和 3（“扩展有效载荷长度”）。当您的有效负载甚至超过 65535 字节时，您必须将字节 1 设置为 127 并将有效负载长度放入字节 2-9（“扩展有效负载长度”和“扩展有效负载长度”）。当您的有效负载长度甚至大于 64 位（16 艾字节，或大约 1600 万太字节）时，那么……您应该发送一堆装满硬盘的卡车。

更多细节可以[在官方 Websocket RFC](https://www.rfc-editor.org/rfc/rfc6455#section-5.2)中找到。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T18:03:16.417

您可以向 WebSocket 发送任意大小的数据，但大数据会被分割。

检查这个：[https](https://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-17#section-5) ://datatracker.ietf.org/doc/html/draft-ietf-hybi-thewebsocketprotocol-17#section-5和 5.4

和

[pastebin.com/TxGZaHTY](http://pastebin.com/TxGZaHTY)

和

[http://buildnewgames.com/websockets/](http://buildnewgames.com/websockets/)

了解更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-04-09T11:29:08.583

引用自此[博客](https://webfirmframework.github.io/blog/unable-to-send-large-data-through-websocket.html)。在 WebSocket 服务器中发送和接收的单个有效负载大小可能存在限制。例如，在 tomcat 中，默认为 8192 字节， `org.apache.tomcat.websocket.textBufferSize`在[tomcat 的 doc](https://ci.apache.org/projects/tomcat/tomcat85/docs/web-socket-howto.html)中签出。

因此，请确保您的 WebSocket 服务器中是否有任何有效负载大小限制，如果是，则将其作为部分有效负载接收。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-12-16T07:26:25.437

```
package GoodExample;

import java.io.BufferedOutputStream;
import java.io.BufferedReader;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStreamReader;
import java.io.PrintWriter;
import java.net.ServerSocket;
import java.net.Socket;
import java.security.MessageDigest;
import java.security.NoSuchAlgorithmException;
import java.util.Arrays;
import java.util.HashMap;
import sun.misc.BASE64Encoder;

/**
*
* @author
* Anders, Improved by Christopher Price
 */
public class WebRTCSignal {

public static final int MASK_SIZE = 4;
public static final int SINGLE_FRAME_UNMASKED = 0x81;
private ServerSocket serverSocket;
private Socket socket;

public WebRTCSignal() throws IOException {
serverSocket = new ServerSocket(1337);
connect();
}

private void connect() throws IOException {
System.out.println("Listening");
socket = serverSocket.accept();
System.out.println("Got connection");
if(handshake()) {
    listenerThread();
}
}

private boolean handshake() throws IOException {
PrintWriter out = new PrintWriter(socket.getOutputStream());
BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));

HashMap<String, String> keys = new HashMap<>();
String str;
//Reading client handshake
while (!(str = in.readLine()).equals("")) {
    String[] s = str.split(": ");
    System.out.println();
    System.out.println(str);
    if (s.length == 2) {
    keys.put(s[0], s[1]);
    }
}
//Do what you want with the keys here, we will just use "Sec-WebSocket-Key"

String hash;
try {
    hash = new BASE64Encoder().encode(MessageDigest.getInstance("SHA-    1").digest((keys.get("Sec-WebSocket-Key") + "258EAFA5-E914-47DA-95CA-C5AB0DC85B11").getBytes()));
} catch (NoSuchAlgorithmException ex) {
    ex.printStackTrace();
    return false;
}

//Write handshake response
out.write("HTTP/1.1 101 Switching Protocols\r\n"
    + "Upgrade: websocket\r\n"
    + "Connection: Upgrade\r\n"
    + "Sec-WebSocket-Accept: " + hash + "\r\n"
     + "Origin: http://face2fame.com\r\n"
    + "\r\n");

out.flush();

return true;
}

private byte[] readBytes(int numOfBytes) throws IOException {
byte[] b = new byte[numOfBytes];
socket.getInputStream().read(b);
return b;
}

public void sendMessage(byte[] msg) throws IOException {
System.out.println("Sending to client");
ByteArrayOutputStream baos = new ByteArrayOutputStream();
BufferedOutputStream os = new BufferedOutputStream(socket.getOutputStream());
baos.write(SINGLE_FRAME_UNMASKED);
baos.write(msg.length);
baos.write(msg);
baos.flush();
baos.close();
convertAndPrint(baos.toByteArray());
os.write(baos.toByteArray(), 0, baos.size());
os.flush();
}

public void listenerThread() {
Thread t = new Thread(new Runnable() {
    @Override
    public void run() {
    try {
        while (true) {
        System.out.println("Recieved from client: " + reiceveMessage());
        System.out.println("Enter data to send");
        }
    } catch (IOException ex) {
        ex.printStackTrace();
    }
    }
});
t.start();
}

public String reiceveMessage() throws IOException {
byte[] buf = readBytes(2);
//dont use this byte[] buf2 = readBytes(4);
int extendedsize = 0;
System.out.println("Headers:");
if(!convertAndPrintHeader(buf)){ // This means we detected an extended message
    String CaryOverDetectiona = new String("");
    byte[] bufadder1 = buf.clone();
    byte[] bufadder2 = readBytes(2);
    byte[] array1and2 = new byte[bufadder1.length + bufadder2.length];
    System.arraycopy(bufadder1, 0, array1and2, 0, bufadder1.length);
    System.arraycopy(bufadder2, 0, array1and2, bufadder1.length, bufadder2.length);
    for (byte b : array1and2) {
        CaryOverDetectiona = (String.format("%02X ", b));
        System.out.print(CaryOverDetectiona);

}
    int i = ((array1and2[1] & 0xFF) - 0x80);
    //int c = ((array1and2[2] & 0xFF) - 0x80);
    //System.out.println(c+128);
    int j = ((array1and2[3] & 0xFF) - 0x80)+2;
    //System.out.println("The size of this uber message is" + j);
    extendedsize = i+j;
    System.out.println("Extended Size is" + extendedsize);
    //System.exit(0);

}
//convertAndPrint(buf2);// Check out the byte sizes
int opcode = buf[0] & 0x0F;
if (opcode == 8) {
    //Client want to close connection!
    System.out.println("Client closed!");
    socket.close();
    System.exit(0);
    return null;
} else {
   int payloadSize = getSizeOfPayload(buf[1]);
    if (extendedsize>=126){   
    payloadSize = extendedsize;}
    System.out.println("Payloadsize: " + payloadSize);
    buf = readBytes(MASK_SIZE + payloadSize);
    System.out.println("Payload:");
    convertAndPrint(buf);
    buf = unMask(Arrays.copyOfRange(buf, 0, 4), Arrays.copyOfRange(buf, 4, buf.length));

    String message = new String(buf);

    return message;
}
}

private int getSizeOfPayload(byte b) {
//Must subtract 0x80 from masked frames

int a = b & 0xff;
//System.out.println("PAYLOAD SIZE INT" + a);
return ((b & 0xFF) - 0x80);
}

private byte[] unMask(byte[] mask, byte[] data) {
for (int i = 0; i < data.length; i++) {
    data[i] = (byte) (data[i] ^ mask[i % mask.length]);
}
return data;
}
private boolean convertAndPrintHeader(byte[] bytes) {
   StringBuilder sb = new StringBuilder();
   String CaryOverDetection = new String();
   // We must test byte 2 specifically for this. In the next step we add length bytes perhaps?
   //for(int i = 0; i < bytes.length; i++) {
       //}
    for (byte b : bytes) {
        CaryOverDetection = (String.format("%02X ", b));
        if (CaryOverDetection.contains("FE")){

            return false;
        }
        sb.append(String.format("%02X ", b));
    }
    System.out.println(sb.toString());
    return true;

    }

private void convertAndPrint(byte[] bytes) {
StringBuilder sb = new StringBuilder();
for (byte b : bytes) {
    sb.append(String.format("%02X ", b));
}
System.out.println(sb.toString());
}

public static void main(String[] args) throws IOException, InterruptedException, NoSuchAlgorithmException {
WebRTCSignal j = new WebRTCSignal();
BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
while (true) {
   System.out.println("Write something to the client!");
   j.sendMessage(br.readLine().getBytes());
}
}
} 
```

# php - jQuery试图在GET变量中插入一个空格

> ID：14102863
> 
> 赞同：1
> 
> 时间：2012-12-31T14:38:40.857
> 
> 标签：php, jquery, get

> **可能重复：**
> [替换 URL JavaScript 中的空格](https://stackoverflow.com/questions/2145743/replace-space-in-url-javascript)

```
jQuery("#changeCoinCountrySelect").change(function(){
      // Get value from select box
      var country = jQuery('#changeCoinCountrySelect option:selected').val();

      jQuery("#coinTable").load(".../.../.../tables.php?country="+country);
}); 
```

我的问题是，如果**country**有值**Great British**例如，那么在 tables.php 中，查看时`$_GET['country']`，只有**Great**被记录。

因此，我认为 jQuery 未对 HTML 进行编码可能存在问题。

可能的解决方案，html 编码国家变量，然后在 php 脚本中解码。问题是这似乎对空格没有任何作用！

我是 jQuery 的灾难，所以如果有人能指出我正确的方向吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:40:15.153

尝试：

```
jQuery("#coinTable").load(".../.../.../tables.php?country="+encodeURIComponent(country)); 
```

您需要对放入 URL 中的数据进行编码。在 javascript 中，您需要使用`encodeURIComponent`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:44:01.483

您可以使用[encodeURIComponent](https://stackoverflow.com/a/14102883/306480)（如 j0k 所建议的那样）。但是，鉴于您使用的是 jQuery，我会这样做：

```
jQuery("#coinTable").load("../../../tables.php", { country: country }); 
```

这会将一个简单的 JS 对象传递给 jquery，它将为您编码所有键/值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:44:41.470

我最好为你使用 uri-safe 值，`select`顺便说一下，这对 i18n 更友好：

```
<select id="changeCoinCountrySelect">
  <option value="uk">Great Britain</option>
  <option value="us">USA</option>
  ...
</select> 
```

这样，您就可以依赖更强大的标签。

# java - 计算布尔变量大小的程序

> ID：14102865
> 
> 赞同：5
> 
> 时间：2012-12-31T14:38:49.187
> 
> 标签：java, boolean, primitive-types

> **可能重复：**
> [Java - 布尔原始类型 - 大小](https://stackoverflow.com/questions/1907318/java-boolean-primitive-type-size)

我设计了这个程序来计算`boolean`Java 中 a 的大小。

```
public class BooleanSizeTest{
    /**
     * This method attempts to calculate the size of a boolean.
     */
    public static void main(String[] args){
        System.gc();//Request garbage collection so that any arbitrary objects are removed.
        long a1, a2, a3;//The variables to hold the free memory at different times.
        Runtime r = Runtime.getRuntime();//Get the runtime.
        System.gc();//Request garbage collection so that any arbitrary objects are removed.
        a1 = r.freeMemory();//The initial amount of free memory in bytes.
        boolean[] lotsOfBools = new boolean[10_000_000];//Declare a boolean array.
        a2 = r.freeMemory();
        System.gc();//Request garbage collection.
        a3 = r.freeMemory();// Amount of free memory after creating 10,000,000 booleans.
        System.out.println("a1 = "+a1+", a2 = "+a2+", a3 = "+a3);
        double bSize = (double)(a1-a2)/10_000_000;/*Calculate the size of a boolean 
        using the difference of a1 and a2*/  
        System.out.println("boolean = "+bSize);
    }
} 
```

当我运行程序时，它说大小是 1.0000016 字节。现在，Oracle Java 文档说 a 的大小`boolean`是**“未定义的”**。[见[链接](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html)]。为什么会这样？另外，一个`boolean`变量代表 1 位信息（`true`和`false`），那么剩下的 7 位会发生什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T14:56:23.317

访问 1 位是一项昂贵的操作；如果您从内存中检索数据，您最有可能按字或按字节进行。在 Java 中，布尔值的内部表示是一个实现细节，除非您正在执行 VM 实现，否则您不应该关心它。

# php - 如果“模式”不匹配，则使用 preg_replace 删除“替换”

> ID：14102872
> 
> 赞同：0
> 
> 时间：2012-12-31T14:39:23.080
> 
> 标签：php, regex, preg-replace

我正在使用一个使用`preg_replace`如下函数的函数：

```
function replace($pattern, $replacement, $subject){
    preg_replace("/^$pattern$/", $replacement, $subject);
}

replace('(\w+)/((\w+)/)?', 'name=\1&family=\2', 'Jame/'); 
```

我无法编辑`replace`函数，只是应该对参数做一些事情。
如您所见，第二种模式`((\w+)/)?`是可选的，可能不存在。我想知道`family`如果模式不存在，是否有办法得到结果，这意味着它`\2`是空的。

所以我应该有：

```
'name=Jame' 
```

**请注意**
，由于团队合作的限制， 我无法更改`preg_replace`签名或使用替代功能。寻找`replacement pattern`是否存在。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T14:47:28.167

对于[`preg_replace`](http://php.net/preg_replace)，不要让它成为可选的，让它显式。处理两种情况：

```
$pattern     = [
    '((\w+)/(\w+)/)',
    '((\w+)/)',
];

$replacement = [
    'name=\1&family=\2',
    'name=\1',
];

echo preg_replace($pattern, $replacement, 'Jame/'); 
```

另一种选择是匹配所有部分，然后用第二个数组给它们一个名称，但根据匹配的数量对该数组进行切片。取决于您要在哪个字段中进行替换。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:43:11.707

我想你应该`preg_replace_callback`试一试（http://php.net/manual/en/function.preg-replace-callback.php）。

```
$name = preg_replace_callback(
    '/(\w+)\/(?:(\w+)\/)?/',
    create_function(
        '$matches',
        'return "name={$matches[0]}" . ( !$matches[1] ? '' : "&family={$matches[1]}" );'
    ),
    'Jame/'
); 
```

此代码尚未测试...只是一个想法

# sql-server - 在 SQL Server 2008 中自动增加两个字段

> ID：14102876
> 
> 赞同：0
> 
> 时间：2012-12-31T14:39:36.200
> 
> 标签：sql-server, sql-server-2008

> **可能重复：**
> [如何在 SQL Server 自动增量中有两列？](https://stackoverflow.com/questions/3622627/how-can-i-have-two-columns-in-sql-server-auto-increment)

如何在 SQL Server 2008 数据库表中自动增加两个字段 [注意：一个是主键字段，另一个字段只是 bigint 数据类型列]，我浏览了论坛但看不到如何。

我已将带有“身份”选项的主键设置为自动递增，但如何处理其他字段，因为我们不能在同一个表中设置两个“身份”列。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:54:05.493

如此处所示 没有要求将 IDENTITY 列设为主键[。](https://stackoverflow.com/questions/7418017/sql-server-auto-increment-a-column-without-primary-key)您可以使用多列作为主列，并在第二列中使用 IDENTITY。

如[这里](https://stackoverflow.com/questions/3622627/how-can-i-have-two-columns-in-sql-server-auto-increment)所见，如果您首先需要 IDENTITY，则可以在插入时触发。

# java - Java类超级查询

> ID：14102878
> 
> 赞同：-2
> 
> 时间：2012-12-31T14:39:47.237
> 
> 标签：java, android, class

这里真的很愚蠢的问题。我知道类和继承是如何工作的，但我一直在做一些`android`编程，并设法让自己对超类声明有点困惑

以下代码实现了`SQLiteOpenHelper`该类。现在就我而言，这是超级类。发送变量是为了满足超类而不是从它继承吗？

显然，我总是认为超类引用了超类变量以在另一个类中使用。

代码：

```
private static class DBHelper extends SQLiteOpenHelper
{
    public DBHelper(Context context) {
        super(context, KEY_NAME, null, DATABASE_VERSION);

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:46:03.347

当我阅读您的问题时-不是很清楚-您不明白这是什么：

```
super(context, KEY_NAME, null, DATABASE_VERSION); 
```

方法。

好吧，这是调用超类的构造函数的唯一方法。大多数时候，所讨论的超类有一个没有参数的构造函数，因此可以省略对超类的构造函数的调用。但是如果它没有这样的构造函数，或者你想调用另一个需要一些参数的构造函数，你需要使用它。注意：调用`super()`应该始终是构造函数中的第一条语句，否则在调用构造函数时超类将不存在，这可能导致非常讨厌、非常不可预测的行为。（Java 工程师也意识到了这一点，因此调用`super()`太晚或在不允许时忽略它会导致编译时错误。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:44:53.777

根据您的代码声明，SQLiteOpenHelper 的构造函数应该有四个参数，否则编译时错误。

当然，如果父类和子类中存在相同的变量以及超类的对象引用，那么该对象将仅引用超类变量。

希望现在你的疑虑是清楚的！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:45:25.233

super(context, KEY_NAME, null, DATABASE_VERSION) 表示传入的变量将用于 SQLiteOpenHelper 的构造函数。如果您正在扩展该类，则可能需要这些变量才能正确创建它。

在您自己的扩展类构造函数或方法中，您可以做自己的事情，但您似乎知道：P

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:43:12.373

您正在扩展`SQLiteOpenHelper`，而不是像接口那样实现它。调用`super(...)`，您确实将参数传递给了超级构造函数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T14:43:51.220

DBHelper 是子类，SQLiteOpenHelper 是超类。DBHelper 在创建实例时调用超级构造函数。为此，使用了 SQLiteOpenHelper 的构造函数，它需要一些参数来初始化超类中的变量。

# php - 在我的情况下避免在循环内进行查询

> ID：14102881
> 
> 赞同：4
> 
> 时间：2012-12-31T14:40:10.953
> 
> 标签：php, mysql, loops, select

我这里的情况相当复杂。如果不将 SELECT 查询放在一个循环中，当我进入该页面时，我找不到更好的方法来解决这个问题（别担心，我使用`array_chunk`将数组拆分为页面）。如果我在这里使用查询，我想这将是一个资源杀手。正因为如此，我在这里，问一个问题。

我有一个需要循环的大数组：

```
$images = scandir($imgit_root_path . '/' . IMAGES_PATH);

$indexhtm = array_search('index.htm', $images);
unset($images[0], $images[1], $images[$indexhtm]); 
```

现在我有一个数组，其中包含我的`IMAGES_PATH`. 现在问题来了：

其中一些图像已在数据库中注册，因为注册用户的图像已列在我的数据库中。现在我需要`user_id`根据上面数组给我的图像名称来检索。

在一个循环中，我只是这样做了：

```
foreach ($images as $image_name)
{
    $query = $db->prepare('SELECT user_id FROM imgit_images WHERE image_name = :name');
    $query->bindValue(':name', $image_name, PDO::PARAM_STR);
    $query->execute();
    $row = $query->fetch(PDO::FETCH_ASSOC);
    $user_id = $row['user_id'];

    echo $user_id;
} 
```

这工作得很好，但效率等于 0。使用它`user_id`我计划从`imgit_users`表中获取其他内容，例如`username`，这将需要在该循环中进行另一个查询。

这太多了，我需要一种更简单的方法来处理这个问题。

有没有办法`user_id`在进入循环之前获取那些 s 并在循环中使用它们？

这是来自的表结构`imgit_images`： ![imgit_images 表架构](../Images/4399ea80dbd9ff39e6771a95a7a37355.png)

虽然这是 的架构`imgit_users`： ![imgit_users 表架构](../Images/f4ca9f278b3296082dc53c4b768e5052.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T14:54:13.113

像这样的东西会起作用（我不确定是否可以准备`WHERE IN`查询，因为值的 # 是未知的......否则，**请确保你 sanatize`$images`**）：

```
$image_names = "'".implode("', '", $images)."'";
$query = $db->prepare("SELECT img.user_id, image_name, username 
                         FROM imgit_images img
                         INNER JOIN imgit_users u ON u.user_id = img.user_id 
                         WHERE image_name IN(".$image_names.")");
$query->execute();
while($row = $query->fetch(PDO::FETCH_ASSOC))
{
    echo $row['user_id']."'s image is ".$row['image_name'];
} 
```

你可能需要稍微调整一下（还没有测试过），但你似乎可以做到，所以我不担心！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:49:26.937

不确定它是否会有所帮助，但我看到了一些可能的优化：

1.  在循环外准备查询，在循环内反弹/执行/获取结果。如果查询准备很昂贵，您可能会节省很多时间。

2.  您可以像[使用 WHERE 子句将数组传递给查询中一样传递数组](https://stackoverflow.com/questions/907806/php-mysql-using-an-array-in-where-clause)并获取图像和用户 ID，这样您就可以将查询分成较少数量的查询。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T14:48:46.063

你能不能只`INNER JOIN`在查询中使用，这样循环的每次迭代都会返回相应用户的详细信息。将您的查询更改为类似的内容（我在这里假设您的表结构）：

```
SELECT imgit_users.user_id 
,imgit_users.username
,imgit_users.other_column_and_so_on
FROM imgit_images 
INNER JOIN imgit_users ON imgit_users.user_id = imgit_images.user_id
WHERE imgit_images.image_name = :name 
```

这显然不能避免循环的需要（您可能会使用字符串连接来构建`IN`where 子句的一部分，但无论如何您可能会在这里使用连接）但它会在每次迭代时返回用户的信息和防止需要进一步迭代来获取用户的信息。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-06-22T12:56:26.623

PDO 使安全地编写查询变得轻而易举。

```
$placeholders = implode(',', array_fill(0, count($images), '?'));
$sql = "SELECT u.username 
        FROM imgit_images i
        INNER JOIN imgit_users u ON i.user_id = u.id
        WHERE i.image_name IN ({$placeholders})";
$stmt = $db->prepare($sql);
$stmt->execute($images);

while($row = $stmt->fetch(PDO::FETCH_ASSOC)) {
    // use $row['username']
} 
```

创建一串逗号分隔`?`的 s 并将它们写入`IN`' 括号中。然后将图像数组传递给`execute()`. 轻松完成，现在您所有想要的数据都可以在单个查询的单个结果集中获得。（根据需要向查询的 SELECT 子句添加其他列。）

# wcf - 如何托管 WCF 服务以从 LAN 网络外调用

> ID：14102885
> 
> 赞同：0
> 
> 时间：2012-12-31T14:40:29.697
> 
> 标签：wcf

我创建了一个 WCF 服务并将其托管在我的 IIS 上。它在我的 LAN 上运行良好，但我无法从 LAN 网络外部调用该服务。有什么解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:57:47.223

> 我无法从我的 LAN 网络中调用该服务

我假设该服务在 IIS 的端口 80 上运行，而您在[NAT](http://en.wikipedia.org/wiki/Network_address_translation)后面。

您可以通过将路由器 NAT 或虚拟服务器页面（请参阅 portforward.com）中外部 IP 的端口 80 映射到托管 IIS 的机器的私有范围 IP 来解决此问题。

还要注意在机器上托管可公开访问的网站的安全隐患，您不希望它被盗用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:43:59.900

首先尝试ping IIS 的IP。如果收到回复，请尝试 ping 服务，因为从网络外访问服务不需要什么特别的东西，只有静态 ip 必须在您托管它的机器上

# php - 重复事件检查中的 SQL 错误

> ID：14102889
> 
> 赞同：0
> 
> 时间：2012-12-31T14:41:09.477
> 
> 标签：php, sql

我正在制作一个重复事件系统，并且必须对检查进行硬编码以查看事件是否已通过以创建新事件。（不，我无法进行 cron 作业，因为系统基础是 Windows，不，我无权访问任务调度程序。）

这是我到目前为止的代码：

```
<?php
require('common.php');
$query = "SELECT 
             *
          FROM 
             DD_events
      ";
try{
$stmt = $db->prepare($query);
$result = $stmt->execute();
}
catch(PDOException $ex){
die("Failed to run query: " . $ex->getMessage());
}
$chk = $stmt->fetchall();
//print_r($chk);

foreach ($chk as $chks) {
if (time() > $chks['event_date']) {
//Add 1 day to event time
$time = strtotime($chks['event_date']);
$newTime = $time + 86400; // 24 * 60 * 60

// Create query to make the next event
    $query = "INSERT INTO
            DD_events (event_name, event_date, initiator, min_lvl, max_level)
              VALUES 
            ({$chks['event_name']}, {$newTime}, 0, {$chks['min_lvl']}, {$chks['max_level']})
      ";
    try
    {
        // These two statements run the query against your database table.
        $stmt = $db->prepare($query);
        $stmt->execute();
    }
    catch(PDOException $ex)
    {
        // Note: On a production website, you should not output $ex->getMessage().
        // It may provide an attacker with helpful information about your code. 
        die("Failed to run query: " . $ex->getMessage());
    }
}
} 
```

它返回此错误：

> `Failed to run query: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ' 200)' at line 4`

任何人都可以发现我正在犯的错误，因为我在过去 30 分钟内一直在查看它并且看不到它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T14:47:16.170

您需要引用变量，但这会使您的查询容易受到 sql 注入的影响，因此正确的解决方案是使用绑定变量：

```
$query = "INSERT INTO
        DD_events (event_name, event_date, initiator, min_lvl, max_level)
          VALUES 
        (:event_name, :event_date, 0, :min_lvl, :max_level)
  ";
try
{
    // These two statements run the query against your database table.
    $stmt = $db->prepare($query);
    $stmt->execute(array(':event_name' => $chks['event_name'],
                         ':event_date' => $newTime,
                         ':min_lvl' => $chks['min_lvl'],
                         ':max_level' => $chks['max_level']));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T14:46:42.103

假设您需要替换`event_name`为. 根据数据类型，这也可能适用于`VARCHAR``{$chks['event_name']}``'{$chks['event_name']}'``event_date`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:47:31.010

也许更简单的方法来做同样的事情：

```
INSERT INTO DD_events
(event_name, event_date, initiator, min_lvl, max_level)
SELECT event_name, DATE_ADD(event_date, INTERVAL 1 DAY), 0, min_lvl, max_lvl
FROM DD_events 
```

这将在一天后为每个现有事件创建一个新事件（这是你所说的代码应该做的），并且基本上不需要你的整个脚本

# java - 无法在检查的异常上清理 java.sql.Statement

> ID：14102897
> 
> 赞同：2
> 
> 时间：2012-12-31T14:41:51.053
> 
> 标签：java, jdbc, findbugs

在下面显示的我的方法中，发现错误是指定**Fail to cleanup java.sql.Statement on checked Exception**

```
 public int updateSecurityCodeHistoryForMessage(String phone, String securityCodeHistoryId, String messageState, String messageId, String parentMessageId)
    {
            CaptivePortalLogger.appLog.error(MODULE+"Start : updateSecurityCodeHistoryForMessage::"+messageState);
            int result=-1;

        String query=null;
        Connection con = null;
        PreparedStatement pstmt =null;
        try
        {
            CaptivePortalLogger.sysOut.debug(MODULE + " (Method : isSecurityCodeUsed) Available Connection : "+ CaptivePortalDBConnection.getNumIdleConnections());
            CaptivePortalLogger.sysOut.debug(MODULE + " (Method : isSecurityCodeUsed) Active Connection : "+ CaptivePortalDBConnection.getNumActiveConnections() );

            con = CaptivePortalDBConnection.getDataSource().getConnection();
            CaptivePortalLogger.appLog.error(MODULE+" Before updateSecurityCodeHistoryForMessage into SendMessageAndReceiveReport: ");              

            query="UPDATE tblsecuritycodehistory SET messagestate = ?,messageid = ? WHERE securitycodehistoryid = ? AND mobileno = ?";

            CaptivePortalLogger.appLog.debug(MODULE + "for updateSecurityCodeHistoryForMessage in SendMessageAndReceiveReport Query : "+ query);

            pstmt = con.prepareStatement(query);
            pstmt.setString(1,messageState); //<b>line 556</b>
            pstmt.setString(2,messageId);
            pstmt.setString(3,securityCodeHistoryId);
            pstmt.setString(4,phone);
            result = pstmt.executeUpdate();

            CaptivePortalLogger.appLog.error(MODULE+" After updateSecurityCodeHistoryForMessage into SendMessageAndReceiveReport: result::"+result);
        }
        catch (Exception e) {
            result = -1;
            CaptivePortalLogger.traceLog.debug("Got an exception while updateSecurityCodeHistoryForMessage in SendMessageAndReceiveReport: ",e);
        }
        finally
        {
            CaptivePortalLogger.appLog.debug(MODULE+"Finally Start");
            try
            {
                if(pstmt!=null)
                    pstmt.close();
                if(con !=null)
                    con.close();

                CaptivePortalLogger.sysOut.debug(MODULE + " (Method : updateSecurityCodeHistoryForMessage) Closing connections done ....");

            }
            catch(Exception e)
            {
                CaptivePortalLogger.traceLog.debug("Error in closing sqlReader.",e);
            }
        }
    CaptivePortalLogger.appLog.error(MODULE+"End : updateSecurityCodeHistoryForMessage");
    return result;
} 
```

![无法清理 java.sql.Statement](../Images/bccf40f8020ac51bbcc995d50a62ece1.png)

我在堆栈上找到了很多链接，但没有一个能够解决我的问题（可能我无法正确理解它们）。任何帮助将不胜感激。

提前致谢..........

在使用@Mark 指定的解决方案更新我的 finally 块后，**问题**仍然存在

```
finally
{
    CaptivePortalLogger.appLog.debug(MODULE+"Finally Start");
    try {
        if(pstmt!=null)
            pstmt.close();
    } catch (Exception ex) {
        // Log, ignore, etc
    }
    try {
        if(con !=null)
            con.close();
    } catch (Exception ex) {
        // Log, ignore, etc
    }
    CaptivePortalLogger.sysOut.debug(MODULE + " (Method : updateSecurityCodeHistoryForMessage) Closing connections done ....");
} 
```

使用@Jon 建议后，我的问题得到解决。最终解决的代码是::

```
public int updateSecurityCodeHistoryForMessage(String phone, String securityCodeHistoryId, String messageState, String messageId, String parentMessageId)
    {
            CaptivePortalLogger.appLog.error(MODULE+"Start : updateSecurityCodeHistoryForMessage::"+messageState);
            int result=-1;
            String query=null;
            Connection con = null;
            PreparedStatement pstmt =null;
            try
            {
                CaptivePortalLogger.sysOut.debug(MODULE + " (Method : isSecurityCodeUsed) Available Connection : "+ CaptivePortalDBConnection.getNumIdleConnections());
                CaptivePortalLogger.sysOut.debug(MODULE + " (Method : isSecurityCodeUsed) Active Connection : "+ CaptivePortalDBConnection.getNumActiveConnections() );

                con = CaptivePortalDBConnection.getDataSource().getConnection();
                CaptivePortalLogger.appLog.error(MODULE+" Before updateSecurityCodeHistoryForMessage into SendMessageAndReceiveReport: ");              

                query="UPDATE tblsecuritycodehistory SET messagestate = ?,messageid = ? WHERE securitycodehistoryid = ? AND mobileno = ?";

                CaptivePortalLogger.appLog.debug(MODULE + "for updateSecurityCodeHistoryForMessage in SendMessageAndReceiveReport Query : "+ query);
                try
                {
                    pstmt = con.prepareStatement(query);
                    pstmt.setString(1,messageState);
                    pstmt.setString(2,messageId);
                    pstmt.setString(3,securityCodeHistoryId);
                    pstmt.setString(4,phone);
                    result = pstmt.executeUpdate();
                }
                catch(SQLException e1)
                {
                    CaptivePortalLogger.traceLog.debug("Error in closing sqlReader.",e1);
                }
                finally{
                    if(pstmt!=null)
                    pstmt.close();
                }

                CaptivePortalLogger.appLog.error(MODULE+" After updateSecurityCodeHistoryForMessage into SendMessageAndReceiveReport: result::"+result);
            }
            catch (SQLException e2) {
                result = -1;
                CaptivePortalLogger.traceLog.debug("Got an exception while updateSecurityCodeHistoryForMessage in SendMessageAndReceiveReport: ",e2);
            }
            finally
            {
                CaptivePortalLogger.appLog.debug(MODULE+"Finally Start");
                try
                {
                    if(con !=null)
                        con.close();

                    CaptivePortalLogger.sysOut.debug(MODULE + " (Method : updateSecurityCodeHistoryForMessage) Closing connections done ....");

                }
                catch(SQLException e)
                {
                    CaptivePortalLogger.traceLog.debug("Error in closing sqlReader.",e);
                }
            }
        CaptivePortalLogger.appLog.error(MODULE+"End : updateSecurityCodeHistoryForMessage");
        return result;
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-31T14:45:44.797

看看这段代码：

```
if(pstmt!=null)
    pstmt.close();
if(con !=null)
    con.close(); 
```

现在考虑`pstmt.close()`可以抛出异常......这意味着`con.close()`不会被调用。

如果您使用的是 Java 7，请改用 try-with-resources 语句，否则您应该为每个资源使用单独的 try/finally 块。

```
try {
   connection = ...;
   try {
      statement = ...;
   } finally {
      // Clean up statement
   }
} finally {
   // Clean up connection
} 
```

我还*强烈*建议不要捕获毯子`Exception`- 最好捕获您实际可以处理的*特定*异常，并让其他异常传播到堆栈中。此外，您似乎正在使用整数值来表示您的方法成功或失败 - 这不是惯用的 Java；一般来说，异常是错误处理的首选。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T14:49:42.800

问题是如果`pstmt.close()`抛出异常，则连接永远不会关闭。

要么不要关闭 finally 中的语句（因为`Statement`如果关闭了驱动程序，则需要关闭对象`Connection`），或者将两者都放在它们自己的`try..catch`块中。例如：

```
finally
{
    CaptivePortalLogger.appLog.debug(MODULE+"Finally Start");
    try {
        if(pstmt!=null)
            pstmt.close();
    } catch (Exception ex) {
        // Log, ignore, etc
    }
    try {
        if(con !=null)
            con.close();
    } catch (Exception ex) {
        // Log, ignore, etc
    }
    CaptivePortalLogger.sysOut.debug(MODULE + " (Method : updateSecurityCodeHistoryForMessage) Closing connections done ....");
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T14:43:16.363

萤火虫是正确的。

您应该在 finally 块中关闭所有 SQL 资源，使用*单独*包装的调用关闭方法。

您可以使用实用程序类来做到这一点：

```
package persistence;

public class DatabaseUtils {
    // similar methods for ResultSet and Connection
    public static void close(Statement s) {
        try {
            if (s != null) {
                s.close();
            }
        } catch (SQLException e) {
            // Log the exception
        }       
    }
} 
```

在创建资源的方法的 finally 块中调用 close 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-31T14:49:57.933

尝试在单独的 try/catch/finally 块中清理/关闭资源，否则如果有人抛出异常，则其余部分将保持未关闭状态。

# service - 在 ZF2 中注入 Service Manager 以构建 Doctrine 存储库

> ID：14102902
> 
> 赞同：0
> 
> 时间：2012-12-31T14:42:13.450
> 
> 标签：service, dependency-injection, doctrine, zend-framework2

如何将服务管理器注入 Doctrine 存储库以允许我检索 Doctrine 实体管理器？

我使用 ZF2-Commons DoctrineORMModule 并尝试实现 Doctrine Tutorial 中列出的存储库示例（下面链接中的教程底部）：

[http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/getting-started.html](http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/tutorials/getting-started.html)

但是，我不断收到消息“*致命错误：调用 C:\zendProject\zf2 中的非对象上的成员函数 get() ...* ”，这表明我没有服务定位器的工作实例.

我的 Doctrine 存储库如下所示：

```
namespace Calendar\Repository;

use  Doctrine\ORM\EntityRepository,
     Calendar\Entity\Appointment,
     Calendar\Entity\Diary;

use Zend\ServiceManager\ServiceLocatorAwareInterface;
use Zend\ServiceManager\ServiceLocatorInterface;

class ApptRepository extends EntityRepository implements ServiceLocatorAwareInterface 
{
   protected $services;

   public function setServiceLocator(ServiceLocatorInterface $serviceLocator)
   {
       $this->services = $serviceLocator;
   }

   public function getServiceLocator()
   {
        return $this->services;
   }

  public function getUserApptsByDate()
  {
     $dql = "SELECT a FROM Appointment a";

     $em = $this->getServiceLocator()->get('Doctrine\ORM\EntityManager');

     $query = $em()->createQuery($dql);

     return $query->getResult();
   }
} 
```

然后我想在我的控制器中使用以下模式调用它：

```
$diary = $em->getRepository('Calendar\Entity\Appointment')->getUserApptsByDate(); 
```

**编辑：**附加链接表明我可能需要将类转换为服务，
[https://stackoverflow.com/a/13508799/1325365](https://stackoverflow.com/a/13508799/1325365)

但是，如果这是最好的路线，那么我将如何让我的 Doctrine Entity 了解该服务。目前，我在 doc 块中包含一个指向该类的注释。

```
@ORM\Entity (repositoryClass="Calendar\Repository\ApptRepository") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T15:31:17.700

我处理事情的方式是这样的：

首先，我为每个实体注册一个服务。这是在**Module.php中完成的**

```
public function getServiceConfig()
{
    return array(
        'factories' => array(
            'my-service-entityname' => 'My\Factory\EntitynameServiceFactory',
        )
    );
} 
```

接下来是创建工厂类**src\My\Factory\EntitynameServiceFactory.php**。这是您将 EntityManager 注入 Entity-Services 的部分（而不是注入实体本身，实体根本不需要这种依赖关系）

这个类看起来像这样：

```
<?php
namespace My\Factory;

use Zend\ServiceManager\ServiceLocatorInterface;
use Zend\ServiceManager\FactoryInterface;
use My\Service\EntitynameService;

class EntitynameServiceFactory implements FactoryInterface
{
    public function createService(ServiceLocatorInterface $serviceLocator)
    {
        $service = new EntitynameService();
        $service->setEntityManager($serviceLocator->get('Doctrine\ORM\EntityManager'));
        return $service;
    }
} 
```

接下来是创建**src\My\Service\EntitynameService.php**。这实际上是您创建所有 getter 函数和东西的部分。我个人从全局**DoctrineEntityService**扩展这些服务，现在我将首先为您提供**EntitynameService**的代码。所有这一切都是为了获得正确的存储库！

```
<?php
namespace My\Service;

class EntitynameService extends DoctrineEntityService
{
    public function getEntityRepository()
    {
        if (null === $this->entityRepository) {
            $this->setEntityRepository($this->getEntityManager()->getRepository('My\Entity\Entityname'));
        }
        return $this->entityRepository;
    }
} 
```

到这里为止的这一部分应该很容易理解（我希望），但这还不是很有趣。魔术正在全球**DoctrineEntityService**发生。这就是代码！

```
<?php
namespace My\Service;

use Zend\EventManager\EventManagerAwareInterface;
use Zend\EventManager\EventManagerInterface;
use Zend\ServiceManager\ServiceManagerAwareInterface;
use Zend\ServiceManager\ServiceManager;
use Doctrine\ORM\EntityManager;
use Doctrine\ORM\EntityRepository;

class DoctrineEntityService implements
    ServiceManagerAwareInterface,
    EventManagerAwareInterface
{
    protected $serviceManager;
    protected $eventManager;
    protected $entityManager;
    protected $entityRepository;

    /**
     * Returns all Entities
     *
     * @return EntityRepository
     */
    public function findAll()
    {
        $this->getEventManager()->trigger(__FUNCTION__ . '.pre', $this, array('entities' => $entities));
        $entities = $this->getEntityRepository()->findAll();
        $this->getEventManager()->trigger(__FUNCTION__ . '.post', $this, array('entities' => $entities));
        return $entities;
    }

    public function find($id) {
        return $this->getEntityRepository()->find($id);
    }

    public function findByQuery(\Closure $query)
    {
        $queryBuilder = $this->getEntityRepository()->createQueryBuilder('entity');
        $currentQuery = call_user_func($query, $queryBuilder);
       // \Zend\Debug\Debug::dump($currentQuery->getQuery());
        return $currentQuery->getQuery()->getResult();
    }

    /**
     * Persists and Entity into the Repository
     *
     * @param Entity $entity
     * @return Entity
     */
    public function persist($entity)
    {
        $this->getEventManager()->trigger(__FUNCTION__ . '.pre', $this, array('entity'=>$entity));
        $this->getEntityManager()->persist($entity);
        $this->getEntityManager()->flush();
        $this->getEventManager()->trigger(__FUNCTION__ . '.post', $this, array('entity'=>$entity));

        return $entity;
    }

    /**
     * @param \Doctrine\ORM\EntityRepository $entityRepository
     * @return \Haushaltportal\Service\DoctrineEntityService
     */
    public function setEntityRepository(EntityRepository $entityRepository)
    {
        $this->entityRepository = $entityRepository;
        return $this;
    }

    /**
     * @param EntityManager $entityManager
     * @return \Haushaltportal\Service\DoctrineEntityService
     */
    public function setEntityManager(EntityManager $entityManager)
    {
        $this->entityManager = $entityManager;
        return $this;
    }

    /**
     * @return EntityManager
     */
    public function getEntityManager()
    {
        return $this->entityManager;
    }

    /**
     * Inject an EventManager instance
     *
     * @param  EventManagerInterface $eventManager
     * @return \Haushaltportal\Service\DoctrineEntityService
     */
    public function setEventManager(EventManagerInterface $eventManager)
    {
        $this->eventManager = $eventManager;
        return $this;
    }

    /**
     * Retrieve the event manager
     * Lazy-loads an EventManager instance if none registered.
     *
     * @return EventManagerInterface
     */
    public function getEventManager()
    {
        return $this->eventManager;
    }

    /**
     * Set service manager
     *
     * @param ServiceManager $serviceManager
     * @return \Haushaltportal\Service\DoctrineEntityService
     */
    public function setServiceManager(ServiceManager $serviceManager)
    {
        $this->serviceManager = $serviceManager;
        return $this;
    }

    /**
     * Get service manager
     *
     * @return ServiceManager
     */
    public function getServiceManager()
    {
        return $this->serviceManager;
    }
} 
```

那么这有什么作用呢？这个**DoctrineEntityService**几乎是您在全球范围内所需要的（根据我目前的经验）。它有`fincAll()`,`find($id)`和`findByQuery($closure)`

您的下一个问题（希望如此）只会是“现在如何从我的控制器中使用它？”。就像调用您在第一步中设置的服务一样简单！假设您的**控制器中有此代码**

```
public function someAction()
{
    /** @var $entityService \my\Service\EntitynameService */
    $entityService = $this->getServiceLocator()->get('my-service-entityname');

    // A query that finds all stuff
    $allEntities = $entityService->findAll();

    // A query that finds an ID 
    $idEntity = $entityService->find(1);

    // A query that finds entities based on a Query
    $queryEntity = $entityService->findByQuery(function($queryBuilder){
        /** @var $queryBuilder\Doctrine\DBAL\Query\QueryBuilder */
        return $queryBuilder->orderBy('entity.somekey', 'ASC'); 
    });
} 
```

该函数`findByQuery()`需要一个闭包。（`$queryBuilder`或者您可以选择如何命名该变量）将是`\Doctrine\DBAL\Query\QueryBuilder`. 不过，这将永远联系在一起`ONE Repository`！因此`entity.somekey`，这`entity.`将是您当前正在使用的任何存储库。

如果您需要访问，`EntityManager`您要么只实例化，`DoctrineEntityService`要么调用`$entityService->getEntityManager()`并从那里继续。

我不知道这种方法是否过于复杂或其他什么。在设置新的 Entity/EntityRepository 时，您需要做的就是添加一个新的工厂和一个新的服务。这两个几乎都是复制粘贴，每个类中都有两行代码更改。

我希望这已经回答了您的问题，并让您了解如何组织 ZF2 的工作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-31T17:45:59.120

只要您扩展 Doctrine\ORM\EntityRepository，您就可以通过调用`EntityRepository::getEntityManager()`或`$_em`属性立即访问实体管理器。从 Doctrine\ORM\EntityRepository 类的继承允许您这样做。

您的方法现在应该如下所示：

```
public function getUserApptsByDate()
{
    $dql = "SELECT a FROM Appointment a";
    $em = $this->getEntityManager();// Or $em=$this->_em;
    $query = $em()->createQuery($dql);
    return $query->getResult();
} 
```

我始终牢记，对我的数据的访问应该从 Web 前端（Zend MVC、服务管理器）到持久层（Doctrine）。我的持久性（实体、存储库...）层不应该引用网络前端，也不应该知道它的存在。如果我的系统在某种程度上做相反的事情，那么可能我做错了什么。

年末快乐

# django - 使用 Django 的 call 命令用 celerybeat 启动 celery worker

> ID：14102905
> 
> 赞同：1
> 
> 时间：2012-12-31T14:42:42.983
> 
> 标签：django, celery

我想用 celerybeat 从 Python 脚本启动一个 Django celery worker。在命令行上，我会这样做：

```
python manage.py celery worker --beat --schedule celerybeat-schedule.db 
```

我从一个脚本中尝试了这个，但它抛出了一个异常：

```
from django.core.management import call_command
call_command("cerlery", "worker", "--beat", "--schedule", "celerybeat-schedule.db") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T05:24:39.243

我倾向于这样做..

```
./manage.py celeryd --event --beat --loglevel=INFO --logfile=./celeryd.log 
```

然后运行相机..

```
./manage.py celeryev --camera=djcelery.snapshot.Camera --logfile=./celeryev.log 
```

希望这可以帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:48:54.040

我通过这样做来解决它：

```
from djcelery.management.commands import celery
args = ['manage.py', 'celery', 'worker', '--beat', '--schedule',
        'celerybeat-schedule']
command = celery.Command()
command.run_from_argv(args) 
```

但如果可以使用`call_command`，我想知道如何使用。

# jquery - iScroll，如何检测用户何时滚动到底部？

> ID：14102907
> 
> 赞同：2
> 
> 时间：2012-12-31T14:42:56.810
> 
> 标签：jquery, iscroll4, iscroll

**有没有办法使用iScroll v4**检测用户何时位于页面底部？

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T17:39:01.113

它不是内置的，但这是一种在滚动结束时添加回调的简单方法..（查看[https://github.com/cubiq/iscroll/blob/master/src/iscroll.js](https://github.com/cubiq/iscroll/blob/master/src/iscroll.js)）

声明一个新事件（第 139 行）

```
onScrollLimit: null 
```

然后在 _move 函数中调用它（第 490 行）

```
if (newY<that.maxScrollY) that.options.onScrollLimit.call(that, e); 
```

并在 _startAni 函数中调用它（第 768 行）

```
if (step.y<that.maxScrollY) that.options.onScrollLimit.call(that); 
```

最后一点的缺点是它会在开始动画时触发事件（当您抛出滚动区域时），而不是在物理上超过结束时。否则，在使用 css 转换时很难判断。

然后您所要做的就是在设置 iScroll 时将此添加到您的选项中

```
myScroll = new iScroll('view', {onScrollLimit: function(){
    console.log("I've past the end!");
}}); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-08T17:25:25.347

您可以使用“onScrollEnd”监听来检测滚动何时结束。

例子：

```
var thingScroll = new iScroll('thing', {
        vScroll: false,
        hScrollbar: true,
        snap: '.page',
        bounce: true,
        inertia: false,

        onScrollEnd: function() {

                          //do stuff

        } 
    }); 
```

我相信这会让你知道它何时触及底部（或底部捕捉区域），如果你想更具体地尝试一下，你可以使用 thingScroll.x 和 thingScroll.y 方法和一些 jquery 数学来亲自配置它。

希望这可以帮助！**

# javascript - 在Javascript中的return语句之后执行语句

> ID：14102912
> 
> 赞同：8
> 
> 时间：2012-12-31T14:43:14.680
> 
> 标签：javascript, jquery, html, dom-events

```
window.onbeforeunload = function() {
    if (document.getElementById("parentpan").style.display == "block") {
        return "You are logged out.";
            Logout();
    }
}; 
```

我希望在`logout()`return语句之后调用该函数，可以吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-31T14:44:05.337

在 return 语句之后你不能执行任何东西。

编辑：该`finally`语句允许在 a 之后执行代码以`return`进行清理。

（这是 XY 问题的一个很好的例子：你问的是 Y，却从来没有告诉我们你真正需要什么 X）。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-31T14:44:57.823

return 语句结束一个函数，你不能在它之后执行代码。你可以这样做：

```
ret = "You are logged out.";
Logout();
return ret; 
```

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-31T15:04:22.423

您需要的是`Logout`异步执行。这可以通过使用`setTimeout`其他人所说的函数在 JavaScript 中轻松实现。这是我常用来异步调用函数的一种方法：

```
Function.prototype.async = function () {
    setTimeout.bind(null, this, 0).apply(null, arguments);
}; 
```

`0`此方法立即（在ms 之后）将函数调用推送到事件循环中。因此，该函数在当前代码完成后执行（对您来说是在您返回之后）。这是一个如何使用它的简单示例：

```
alert.async("This will be displayed later.");
alert("This will be displayed first."); 
```

由于第一个`alert`是异步调用的，它将在第二次调用之后执行`alert`。就像在函数调用之前使用`async`. 这就是你在你的情况下会做的事情：

```
window.onbeforeunload = function () {
    if (document.getElementById("parentpan").style.display === "block") {
        Logout.async();
        return "You are logged out.";
    }
}; 
```

有什么缺点？由于该函数在事件循环中被阻塞，它可能永远不会有机会执行（因此用户永远不会注销）。**可能会**出现这样的情况。它通常发生在控件进入无限循环或由于阻塞的 AJAX 请求而挂起时。

但是，对您来说是个好消息，这种情况**很少**发生。所以不用担心。就像`setTimeout`其他人在取笑你一样使用，你会做得很好。我个人认为您应该在返回消息之前注销`"You are logged out."`，但这是您的应用程序。

新年快乐。干杯!

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-12-23T01:27:59.343

最好的方法和最有效的方法是**`try, catch and finally`**

> catch 在这里是可选的

```
 `try{ 
     // do something
     return;
   } finally {
    // call function after return
   }` 
```

[https://youtu.be/Is_o_L-ZIS8](https://youtu.be/Is_o_L-ZIS8)这对你有帮助

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-31T14:50:20.783

一般来说，如果您希望在函数返回后执行某些操作，您可以设置一个计时器：

```
function myFunction() {
    if (document.getElementById("parentpan").style.display == "block") {
        setTimeout(Logout, 50); // Logout will be called 50ms later
        return "You are logged out.";
    }
}; 
```

但是，正如评论中所指出的，这对于 onbeforeunload 不是一个好主意，因为如果页面首先完成卸载，则不会触发计时器事件。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-31T15:10:11.600

大多数其他回答者都错过了您在这里尝试做的事情。你想`window.onbeforeunload`表现得像`window.confirm()`。没有办法对 onbeforeunload 事件中的 ok 操作采取行动。

您需要做的就是将它连接到 onunload 以执行操作。

```
window.onbeforeunload = function () { 
    return "Your session will be logged out" 
};
window.onunload = function () { 
    logout(); 
} 
```

问题在于现代浏览器会杀死很多在卸载/卸载前运行的进程，以“加速”浏览器，使其更快。所以如果它是异步的，你将有一个竞争条件。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-31T14:51:08.847

return 表示你正在从被调用函数的执行中返回。当return语句被执行时，系统知道函数执行已经结束，它会切换到调用函数的主程序。

在程序中，你可以看到return后的语句。但系统甚至不会检查。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2012-12-31T15:14:19.740

如果您的项目中有 jquery，则可以使用延迟机制。您可以为正在进行的任务返回 promise 对象，如下所示：

```
function task() {

   var defered = $.Deferred();
   setTimeout(defered.resolve , 5000);
   return defered.promise();

}  

function task2() {

   var defered = $.Deferred();
   setTimeout(defered.resolve , 10000);
   return defered.promise();
}   

function run() {
     return $.when(task(),task2());
}

var promise = run();

promise.done(function(){        
      alert("All tasks has been completed");        
}); 
```

[演示](http://jsfiddle.net/4Primes/bZWrb/)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2017-07-10T12:46:58.833

您可以使用`setTimeout`来实现这一点。您的代码应如下所示

```
window.onbeforeunload = function() {
    if (document.getElementById("parentpan").style.display == "block") {
        setTimeout(function(){
            Logout();
        }, 0);
        return "You are logged out.";
    }
}; 
```

这将确保`Logout`在 return 语句之后执行。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-09-24T07:54:41.703

```
 var a = 10;
function b(){
    a = 25;
  return;
    function a(){}
}
b();
document.write(a); 
```

尝试一下

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-05-05T11:39:59.013

我找到了两种方法来解决这个问题。第一个是[如上所述的 Bhavsar Japan](https://stackoverflow.com/a/47949026/4742733)

## 1.示例`try, catch and finally`

```
const example1 = () => {
  try {
    return console.log('will execute first')
  } finally{
    console.log('will execute second')
  }
  return 'will never execute'
}

const main = () => {
  const message = example1();
  console.log(message)
}

main()
```

## 2.示例`Promise.resolve`

```
const example2 = () => {
  Promise.resolve()
    .then(() => console.log('will execute after return'));
  return 'will execute first'

}

const main = () => {
  const message = example2();
  console.log(message);
}

main();
```

* * *

## 回答 #12

> 赞同：-1
> 
> 时间：2012-12-31T14:50:52.793

我猜 Logout 是一个耗时的过程，您想在执行之前向用户提供反馈：

```
setTimeout(Logout,1);
return "You are logged out."; 
```

# c# - 在 Windows Media Center 中以编程方式导航

> ID：14102938
> 
> 赞同：0
> 
> 时间：2012-12-31T14:45:10.887
> 
> 标签：c#, windows-7, windows-media-center

我正在 Win-7 机器上开发 Windows Media Center 加载项（如果相关）。

与所有加载项一样，它实现

```
public void Launch(AddInHost host)
{
} 
```

在进一步的代码中，我收到在媒体中心向上/向下/向左/向右导航的说明。这意味着，如果我在 Windows Media Center 的开始屏幕上，我只想从to上移或从`TV`to`Movies`左移`Libary``Play DVD`

如何使用 以编程方式执行此操作`AddInHost`？有这个`MediaCenterEnvironment.NavigateToPage()`功能，这似乎不是我想要的。甚至有可能做我想做的事吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-14T17:07:37.220

事实证明，没有办法通过任何 API 左右来做到这一点。WMC 不提供任何内容。

相反，我通过使用解决了我的问题`System.Windows.Forms.SendKeys.SendWait(key);`

我在 StackOverflow 上发布了我的解决方案作为另一个问题的答案：[https ://stackoverflow.com/a/14880133/1403593](https://stackoverflow.com/a/14880133/1403593)

# javascript - how can i limit showing comments in disqus comment box

> ID：14102939
> 
> 赞同：6
> 
> 时间：2012-12-31T14:45:21.333
> 
> 标签：javascript, web, disqus

I put a disqus comment box in my website, but that shows all comments at once. I want to configure the limit of showing comments. How can I do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T14:51:49.973

On this page: [disqus, the missing manual](http://blog.slashpoundbang.com/post/2592867566/disqus-the-missing-manual)

> `disqus_per_page` Number of comments per page. 0 for no limit. Default: 25.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-02T20:52:31.993

With Disqus 2012, there's no supported way to limit the number of comments shown on a page. By default the pagination begins after 50 comments, however.

# ios - 在 iOS 模拟器中“实际”测试低内存条件的策略

> ID：14102947
> 
> 赞同：3
> 
> 时间：2012-12-31T14:46:23.867
> 
> 标签：ios, cocoa-touch, ios-simulator, didreceivememorywarning

我正在开发[我的小应用程序](http://github.com/GarrettAlbright/wptrans)，我正在实施 didReceiveMemoryWarning 等，但我觉得我没有很好地掌握测试我正在实施的内容的最佳方法。

首先，显然在模拟器中，didReceiveMemoryWarning 对于不在前台的应用程序不会触发，*直到*该应用程序被带回前台，根据[这个问题](https://stackoverflow.com/questions/6078090/not-getting-didreceivememorywarning-when-app-is-in-the-background)- 实际上，这符合我自己的经验，但我很容易忽略它，因为它没有任何意义。（为什么我要延迟清理内存，直到我回到前台并可能再次需要该数据？）这是否与实际硬件的行为相匹配？如果是这样，除了 didReceiveMemoryWarning 之外，清理 applicationWillEnterBackground 中的任务是否有意义？

其次，一般来说，在模拟器中触发“模拟内存警告”菜单项的好策略是什么，以便以可能在实际硬件上发生的方式触发内存警告？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T17:51:12.117

Q1：这是否与实际硬件的行为相匹配？

*   A: 是的，模拟器和实际设备在这方面的行为是相同的（例如，如果您的应用程序被挂起并且没有运行后台任务，则它不会接收`applicationDidReceiveMemoryWarning`）。

Q2：清理任务有意义`applicationWillEnterBackground`吗？

*   A1：只有在您的应用程序必须为完全重启做好准备的情况下。如果您的应用程序保持暂停状态并且用户对其他应用程序执行了很多操作，则您的应用程序可能会完全卸载 - 即使该应用程序可能仍然在任务切换器中可见，当用户下次激活它时，您的应用程序委托将接收`application:didFinishLaunchingWithOptions:`（**不** `applicationWillEnterForeground:`）。
*   A2：我不会费心清理内存，但您应该确保在`applicationWillEnterBackground`完成时，所有用户偏好和其他内容都已保存，以便应用程序知道下次激活时再次占用的位置。

Q3：触发“模拟内存警告”菜单项的好策略是什么？

*   A1：我怀疑是否可以制定通用策略，因为每个应用程序都不同。
*   A2：使用一个特定的案例：在我的应用程序中，我不使用应用程序委托`applicationDidReceiveMemoryWarning`来缓解内存压力，而是依靠这样一个事实，即当发送内存警告时，iOS 也会调用`viewDidUnload`某些不在其中的视图控制器采用。因此我通常使用内存警告模拟来测试我的视图控制器是否`viewDidLoad`正确`viewDidUnload`平衡。
*   A3：具体示例：我的应用程序使用选项卡，所以我最喜欢的场景是 1）使用被测视图控制器（VC）显示选项卡；2) 导航到不同的选项卡；3）模拟内存警告（iOS`viewDidUnload`在被测VC中调用）；4) 导航回原始选项卡（iOS`viewDidLoad`在被测 VC 中调用）。
*   A4：如果您想使用类似的方法，那么您必须为您的应用确定哪些视图可能会被 iOS 卸载。在我（有限的）经验中，这些往往是不相关的视图，例如不同选项卡上的视图。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:02:55.453

这是我对你的第二个问题的回答——它也回答了你的第一个问题：

我使用“模拟内存警告”功能有效地重现了子视图控制器消耗足够内存以致其父视图控制器必须释放资源的问题。

例如，考虑一个显示相机/照片库（即 UIImagePickerController）的子视图控制器。这会占用大量内存。如果选择器控制器消耗的内存超过可用内存，父视图控制器将被卸载，一旦父视图控制器再次显示（当子弹出时），将再次调用父视图控制器。这意味着 viewDidLoad 中设置的任何变量都将被再次设置，可能存在内存泄漏或错误指针。

“模拟内存警告”有助于发现这些问题。您可以进入子视图控制器，选择“模拟内存警告”，然后弹出视图控制器并检查问题。

请注意，“didReceiveMemoryWarning”比实际尝试释放内存更相关（恕我直言）让您知道它发生了。

# c# - Socket编程——客户端服务器原理

> ID：14102950
> 
> 赞同：4
> 
> 时间：2012-12-31T14:46:52.163
> 
> 标签：c#, tcpclient

我什至不好意思问这个问题，但是在谷歌搜索完之后（开始有 MSDN ......），我决定发布它：

刚刚开始学习客户端-服务器编程（使用 C#），并尝试使用 tcpClient 编写我的第一个代码。我正在编写服务器端和客户端。这是我的问题：客户端不断地向服务器发送一个字符串，然后服务器将一个字符串发送回客户端，依此类推。服务器不能连续发送2个字符串吗？他必须等待客户响应？**这是客户端-服务器的原理吗？？**

再次，对不起这个糟糕的问题。谢谢...

<> 我会尝试发布我的一些代码（很长的......）。我试着剪掉多余的部分，所以希望代码有意义......（我用//*********标记了主要问题）

```
public class MServer2
{
Dictionary<String, String> nameAndPass = new Dictionary<String, String>();
Dictionary<String, List<String> > nameAndMail = new Dictionary<String, List<String>>();

public static void Main()
{
    new MServer2();
}

public MServer2()
{
    TcpListener server = new TcpListener(8500);
    try
    {
        server.Start();
        Console.WriteLine("started " + server);
        while (true)
        {
            TcpClient client = server.AcceptTcpClient();
            Console.WriteLine("connection accepted " + client);
            new Server1(client, nameAndPass, nameAndMail);
        }
    }
    catch (Exception e)
    {
        Console.WriteLine("exception" + e);
    }
    finally
    {
        server.Stop();
    }
}

class Server1
{
TcpClient client;
NetworkStream netStream;
Dictionary<String, String> nameAndPass1 = new Dictionary<String, String>();
Dictionary<String, List<String>> nameAndMail1 = new Dictionary<String, List<String>>();

internal Server1(TcpClient client, Dictionary<String, String> nameandPassFromFile, Dictionary<String, List<String> > nameAndMailsFromFile)
{
    nameAndPass1 = nameandPassFromFile;
    nameAndMail1 = nameAndMailsFromFile;

    this.client = client;
    Thread thr = new Thread(new ThreadStart(Run));
    thr.Start();
}

public void Run()
{
    try
    {
        netStream = client.GetStream();
        StreamReader reader = new StreamReader(netStream);
        StreamWriter writer = new StreamWriter(netStream);
        writer.AutoFlush = true;
        Console.WriteLine("beginning to receive loop");

        writer.WriteLine("Choose your user name.");
        strFromClient = reader.ReadLine();
        userName = strFromClient;

        writer.WriteLine("Choose your user password.");
        strFromClient = reader.ReadLine();

        password = strFromClient;

        writer.WriteLine("Do you want to see the list of email addresses? (y/n)");
        strFromClient = reader.ReadLine();

//***********************************************************************************
//HERE'S MY PROBLAM:
//HERE THE CLIENT WILL GET A STRING SHOWING HIS EMAILS, AND I WANT HIM TO GET ANOTHER     STRING ASKING "Do you want to add an email address? (y/n)", BUT IT LOOKS LIKE THE SERVER     "WAITS" FOR A RESPONSE FROM THE CLIENT TO SHOW THE NEXT STRING...
        if (strFromClient == "y")
        {   
            String tmpStr = null;
            List<String> tmp = nameAndMail1[userName];
            for(int i=0; i<nameAndMail1[userName].Count; i++)
            {
                tmpStr += tmp[i] + " ";
            }

            writer.WriteLine(tmpStr);                            
        } 
        writer.WriteLine("Do you want to add an email address? (y/n)");
        strFromClient = reader.ReadLine();

    }    

}
    catch (Exception e)
    {
        Console.WriteLine("{0} Exception caught.", e);
    } 
```

* * *

## 编辑第 2 卷

好的！经过 2 小时的痛苦，我*想*我找到了问题，这要归功于**Phil Frost**（天才！）——问题可能出在客户身上……（我真是个大坑！）。

服务器确实连续发送了 2 个字符串，但是我愚蠢的客户端实现没有显示不遵循客户端发送的消息的消息（从服务器接收）...

所以我再次需要你的帮助。这是我如何设计客户表单的视图： ![在此处输入图像描述](../Images/bbcf83efd2cb97635d9c94090bcdd1e6.png)

我缺乏经验导致我在按下“连接到服务器”按钮时连接到服务器，并且只有当按下“发送消息”按钮时，才会显示来自服务器的消息。问题是当接收到来自服务器的 2 条（或更多）消息而没有从客户端向服务器发送消息时 - 客户端不知道接收到了新消息！我应该在哪里接收来自服务器的消息？（'where' 表示在哪个函数下，例如 - 现在它发生在 sendMessage_click 函数中）。

再次感谢到目前为止的所有帮助！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-31T14:53:05.837

这个问题既不糟糕也不琐碎。您正在触及协议设计中的一个重要点。

AFAIK，有两种方法可以给这只猫剥皮：

*   “对话”（你的方式）......请求后是回复，然后是下一个请求，依此类推。这有一个很大的优点是简单，但一个很大的缺点是每个连接在任何时间点都只处理一个命令
*   “异步”（双方无需等待答案即可发送）......这具有实现困难，您需要某种请求ID才能知道哪个回复属于哪个请求：想象一下客户端发送两个请求，第一个比第二个需要更长的处理时间：回复的顺序与请求的顺序不同。

这些变体之间的选择并不总是一件容易的事，但趋势趋向于异步模型。

异步风格的其他困难包括确保一次只发送一条消息的机制（交织消息很可能导致无法解析的流）和超时注意事项。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-31T14:49:26.580

是的，服务器可以连续发送两个字符串。但如果您的服务器在`read()`. 也许如果您包含有关您的程序的更多详细信息，则可以提供更具体的答案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-31T14:48:26.763

在 TCP 中，客户端到服务器和服务器到客户端的通道是两个独立的流。任何一方都可以随时发送。

# c# - 如果在第一个“return”之后有一个“else”，这对性能有影响吗？

> ID：14102954
> 
> 赞同：19
> 
> 时间：2012-12-31T14:47:18.187
> 
> 标签：c#, .net, performance, if-statement, return

我现在已经看到了两种不同的方法来制作布尔返回方法：

```
bool Case1()
{
    if (A)
        return true;
    else
        return false;
}
bool Case2()
{
    if (A)
        return true;
    return false;
} 
```

哪个更快？不写`else`只是为了节省一行，使它更清晰，或者性能提升可以忽略不计，是否有意义？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2012-12-31T14:56:29.597

## 不。

即使我们查看它们的`IL`代码，它们也具有相同的`IL`代码，因此它们之间没有性能差异。**使用对您来说更具可读性的那个**。

```
.method private hidebysig instance bool  Case1() cil managed
{
  // Code size       9 (0x9)
  .maxstack  1
  .locals init ([0] bool CS$1$0000,
           [1] bool CS$4$0001)
  IL_0000:  nop
  IL_0001:  ldc.i4.0
  IL_0002:  stloc.1
  IL_0003:  ldc.i4.1
  IL_0004:  stloc.0
  IL_0005:  br.s       IL_0007
  IL_0007:  ldloc.0
  IL_0008:  ret
} // end of method Program::Case1 
```

查看这些代码的性能；

> [http://ideone.com/8Sc7Ho](http://ideone.com/8Sc7Ho) --> 内存：33856 kB
> 
> [http://ideone.com/MrnaAl](http://ideone.com/MrnaAl) --> 内存：33808 kB

因此，即使您使用它们 10.000 次，也无需担心。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-31T14:49:35.640

c# 编译器应该为这两种情况生成相同的 IL，因此性能上应该没有差异。如果您对实际发生的事情感到好奇（尝试教如何钓鱼），您可以随时[查看生成的 IL 。](https://stackoverflow.com/questions/3326571/how-can-i-view-msil-cil-generated-by-c-sharp-compiler-why-is-it-called-assemb)

恕我直言，`Case1`更容易阅读，这是值得的。我的第二个选择是`return A;`（如其他一些答案中所述）。如果`A`不是`bool`，则存在隐式转换，在某些情况下可能会令人困惑。

我认为可读性应该胜出，除非你可以用分析器*证明*你有问题。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-31T14:52:51.583

不会有（可以忽略不计的）差异。从编码的角度来看，你真的应该这样做：

```
return A; 
```

但假设代码只是一个例子，那么我建议：

```
bool Case3()
{
    bool retValue;
    if (A)
    {
        retValue = true;
    } 
    else
    { 
        retValue = false;
    }
    return retValue;
} 
```

这样你就很清楚正在发生什么，以及要返回什么值。如果您需要返回并更改该方法的功能，则要容易得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T14:51:15.137

在性能方面它们是相同的。从良好的编码实践的角度来看，更喜欢后者 - 以便清楚函数始终返回有效值。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-31T14:49:43.100

他们是一样的。

如果`A`为假，则`return false`在这两种情况下都会跳转到该语句。

# java - Java：为什么需要在浮点文字中指定“f”？

> ID：14102955
> 
> 赞同：42
> 
> 时间：2012-12-31T14:47:27.060
> 
> 标签：java, floating-point

为什么需要`f`在浮点文字中指定后缀？

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2012-12-31T14:48:06.703

因为否则它默认为`double`，这是一种比 . 更常用的浮点类型`float`。

来自[Java 语言规范，第 3.10.2 节](http://docs.oracle.com/javase/specs/jls/se7/html/jls-3.html#jls-3.10.2)：

> 如果浮点文字以 ASCII 字母 F 或 f 为后缀，则它的类型为 float；否则，它的类型是双精度的，并且可以选择以 ASCII 字母 D 或 d 为后缀（第 4.2.3 节）。

（我个人宁愿没有默认值，以便在所有情况下都清楚，但这是另一回事。）

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2012-12-31T14:52:52.553

因为无后缀的浮点文字是双精度数，而舍入意味着即使是小的文字在舍入为浮点数和双精度数时也可以采用不同的值。这可以在以下示例中观察到：

```
float f = (float) 0.67;
if(f == 0.67) 
  System.out.print("yes");
else 
  System.out.print("no"); 
```

这将输出`no`，因为 0.67 在舍入为浮点数时与舍入为双精度时的值不同。另一方面：

```
float f = (float) 0.67;
if(f == 0.67f) 
  System.out.print("yes");
else 
  System.out.print("no"); 
```

……输出`yes`。

**编辑**
第二个例子：

```
if(0.67 == 0.67f) 
  System.out.print("Equal");
else 
  System.out.print("Not Equal"); 
```

……输出`Not Equal`。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-31T15:20:54.653

有两种浮点类型可以表示为例如`100.0`。只有一个可能是默认值。由于精度有限，float 是一种极其特殊的类型。正常情况是双倍的，所以它是适当的默认值。

在现代处理器上，float 和 double 具有相似的计算性能。使用浮点的唯一情况是在需要有限精度的性能关键情况下的大型数组。使用 float 会使适合一个高速缓存行的浮点值的数量加倍。即使这样，确定 float 是否为给定的计算提供足够的精度也不是一件容易的事。

# sql-server-2005 - SQL Server 中 SET LANGUAGE 子句的范围是什么？

> ID：14102959
> 
> 赞同：3
> 
> 时间：2012-12-31T14:47:31.647
> 
> 标签：sql-server-2005

SQL Server 2005 及更高版本中 SET LANGUAGE 子句的范围是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-31T22:04:32.487

[SET LANGUAGE](http://msdn.microsoft.com/en-us/library/ms174398.aspx)的范围是会话。

# c++ - 设置类变量时代码崩溃

> ID：14102964
> 
> 赞同：0
> 
> 时间：2012-12-31T14:48:21.773
> 
> 标签：c++, string, class

我只是在编写小 OOP 应用程序，并在通过设置器设置类的私有字符串变量时运行（而不是编译）应用程序时崩溃，这是头文件：

```
class Car
{
private:
int year;
std::string brand;
std::string model;
int price;
std::string currency;
public:
int setYear(int x){this->year = x;}
std::string setBrand(std::string x){this->brand = x;}
std::string setModel(std::string x){this->model = x;}
int setPrice(int x){this->price = x;};
std::string setCurrency(std::string x){this->currency = x;}
}; 
```

这是主要的： n - 对象数 temp - 用于传递整数的临时变量 temp1 - 用于传递字符串的临时变量

```
ifstream fd("input.in");
int n;
fd >> n;
int temp;
string temp1;
Car A[n];
for(int i = 0; i < 3; i++)
{
    fd >> temp;
    A[i].setYear(temp);
    fd >> temp1;
    A[i].setBrand(temp1);  //Crashes Here
    fd >> temp1;
    A[i].setModel(temp1);
    fd >> temp;
    A[i].setPrice(temp);
    fd >> temp1;
    A[i].setCurrency(temp1);
} 
```

经过少量测试后，我发现它崩溃了，然后代码尝试设置“品牌”变量。有什么问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-31T14:50:08.113

数组维度必须在编译时已知，因此：

```
C A[n]; 
```

是错的。

GCC 支持可变长度数组作为非标准扩展，但是，即使您不小心使用它们，您的循环也会假定`n == 3`没有明显的迹象表明这一定是正确的。

相反，使用向量：

```
std::vector<C> A(n); 
```

并正确迭代它：

```
std::vector<C>::iterator it = A.begin(), end = A.end();
for ( ; it != end; ++it) {
   // your for loop stuff with *it
} 
```

或者，在 C++11 中：

```
for (auto& a : A) {
   // your for loop stuff with a
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:10:44.177

除了 Lightness 的回答，我注意到你的`Car`类的方法有返回类型但没有返回语句。运行时错误通常会掩盖大多数编译错误，所以这可能就是它没有引起您注意的原因。要解决此问题，请将“set”方法的返回值替换为`void`，这意味着该函数不返回任何内容。对所有方法执行此操作，因为它们都缺少返回语句。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-31T18:56:34.503

它怎么没有给出任何编译时错误？下面的语句应该会导致错误，因为 n 在编译时是未知的。您应该将 A 作为 std::vector 或使用宏定义或静态 const 来表示“n”。

```
 Car A[n]; 
```

此外，setter 函数不需要任何返回值。尽管函数签名表明它们应该返回，但它们不返回任何内容。

# jquery - 快速连续触发的jQuery会导致问题

> ID：14102967
> 
> 赞同：0
> 
> 时间：2012-12-31T13:25:10.527
> 
> 标签：jquery

我制作了一个比较图表，用户漂浮在一个功能上，一个小框（div）滑出提供详细信息（比如'somethingBox1'）

我已经完全正常工作了，但是当鼠标离开一个活动区域（带有 id="something1" 的图像）到另一个bedore 幻灯片动画结束时（图像 id="something2" 可以说），我遇到了问题

似乎浏览器在运行下一个事件之前没有等待上一行/动画完成，并导致诸如框是否可见或不可见之类的问题。

我正在为每个元素触发此代码：

```
$('#something1').mouseleave(function() {$("#somethingBox1").animate({width:'toggle'},0);});
$('#something1').mouseover(function(){timeout = window.setTimeout(function() {$("#somethingBox1").animate({width:'toggle'},0);}, 350);}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T14:57:01.717

尝试使用[`stop`](http://api.jquery.com/stop/)，这将停止任何当前动画。我喜欢让动画（立即）完成动画，以确保新动画按预期运行。

像这样的东西：

```
$('#something1').hover(
    function() {
        $(this).stop(true, true).wait(350).animate({width:'toggle'}, 0);
    },            
    function() {
        $(this).stop(true, true).animate({width:'toggle'},0);
    }
); 
```

*（我没有测试过这段代码。）*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T15:00:32.727

在阅读了有关该主题的更多内容后，我遇到了完整的调用功能，

我在每个 .animate 函数的末尾添加了 function(){}，它似乎让浏览器等待（在 ie、chrome、safari、opera、firefox 中测试）

```
$('#infolink6').mouseleave(function() {$("#infoBox6").animate({width:'toggle'},350, function(){});});
$('#infolink6').mouseover(function(){timeout = window.setTimeout(function() {$("#infoBox6").animate({width:'toggle'},350, function(){});}, 0);}); 
```

# javascript - Chrome 扩展在运行 Javascript 循环时播放加载 Gif

> ID：14102968
> 
> 赞同：0
> 
> 时间：2012-12-31T14:48:36.243
> 
> 标签：javascript, google-chrome-extension

我有一个循环通过 xml 来显示内容的 JavaScript。大约需要 3-5 秒才能完成。同时，我想合并一个加载 gif，但是，在 JavaScript 完成之前，gif 是加载动画的。到那个时候，我想消失。（出于测试目的，我没有让它消失以确保 gif 确实有效。下面我有显示和隐藏 gif 内容的方法，因此我不需要帮助。

我认为我的想法与[如何在加载通过 javascript 调用的内容时显示加载 gif 图像有关？](https://stackoverflow.com/questions/7769892/how-to-show-loading-gif-image-while-content-called-via-javascript-is-loading)但是不同的是它不使用按钮来调用 JavaScript，它是在页面加载时调用的。

在 .html 中

```
<div id="loading"><img src="loading.gif"/>Starting Content</div> 
```

在 .js 中

```
function Loaded(quantity) {
  $(document).ready(function() {
        $("#loading").html("New Content");
  });
} 
```

正如我所说，这个想法可以显示/隐藏 gif，只是 gif 无法动画化，这违背了拥有它的目的。:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:01:04.433

长时间运行的 JavaScript 作业会阻塞浏览器的 UI，包括图像动画。要查看此操作：

1.  转到[http://www.ajaxload.info/](http://www.ajaxload.info/)并单击“生成它！” 制作一个 GIF 旋转器。

2.  `i=0; while(i < 100000000) i++;`在浏览器控制台中运行。循环完成时图像将冻结。

为了防止这种情况发生，您需要使您的循环具有某种异步组件，如[Javascript 中所述 - 如何在执行繁重的工作时避免阻塞浏览器？](https://stackoverflow.com/questions/10180391/javascript-how-to-avoid-blocking-the-browser-while-doing-heavy-work/)（事实上​​，这个问题几乎是那个问题的重复）：

```
for(var i=0; i < 1000000; ++i) {
    setTimeout(function(i) {
        return function() { doSomethingHeavy(i); }
    }(i), 0);
} 
```

这将循环的步骤排队，但它允许 JavaScript 线程在循环的迭代之间“休息”，这反过来又允许 UI 线程为 GIF 设置动画。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-31T15:23:21.263

你应该在 web worker 中做繁重的工作，它允许在另一个线程中完成繁重的工作，而不是阻塞主线程。此外，Chrome 也很好地支持它。

# spring-security - Spring Security LDAP IncorrectResultSizeDataAccessException

> ID：14102975
> 
> 赞同：2
> 
> 时间：2012-12-31T14:49:14.253
> 
> 标签：spring-security

我已经为此绞尽脑汁了一段时间，但一无所获。这就是我的 security-context.xml 中的内容。这将是一个 servlet。

```
<security:http auto-config="true">
    <security:intercept-url pattern="/"
        access="IS_AUTHENTICATED_REMEMBERED" />
    <security:intercept-url pattern="/login.html"
        access="IS_AUTHENTICATED_ANONYMOUSLY" />
    <security:form-login login-page="/login.html"
        authentication-failure-url="/loginFailed.html" default-target-url="" />
    <security:anonymous />
    <security:logout />
</security:http>

<security:authentication-manager alias="authenticationManager">
    <security:authentication-provider
        ref="ldapAuthProvider" />
</security:authentication-manager>

<beans:bean id="ldapAuthProvider"
    class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">
    <beans:constructor-arg>
        <beans:bean
            class="org.springframework.security.ldap.authentication.BindAuthenticator">
            <beans:constructor-arg ref="contextSource" />
            <beans:property name="userSearch" ref="userSearch">
            </beans:property>
        </beans:bean>
    </beans:constructor-arg>
    <beans:constructor-arg>
        <beans:bean id="authoritiesPopulator"
            class="org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator">
            <beans:constructor-arg ref="contextSource" />
            <beans:constructor-arg value="" />
            <beans:property name="groupRoleAttribute" value="cn" />
            <beans:property name="searchSubtree" value="true" />
            <beans:property name="rolePrefix" value="ROLE_" />
            <beans:property name="convertToUpperCase" value="true" />
        </beans:bean>
    </beans:constructor-arg>
</beans:bean>

<beans:bean id="contextSource"
    class="org.springframework.security.ldap.DefaultSpringSecurityContextSource">
    <beans:constructor-arg
        value="thepathtomyLDAPdatabase" />
    <beans:property name="userDn"
        value="theuserpathforLDAP" />
    <beans:property name="password" value="mypassword" />
</beans:bean>

<beans:bean id="userSearch"
    class="org.springframework.security.ldap.search.FilterBasedLdapUserSearch">
    <beans:constructor-arg index="0" value="CN=Users" />
    <beans:constructor-arg index="1"
        value="(sAMAccountName={0})" />
    <beans:constructor-arg index="2" ref="contextSource" />
    <beans:property name="searchSubtree" value="true" />
</beans:bean> 
```

我不断收到以下错误：

```
nested exception is java.lang.NoClassDefFoundError: org/springframework/dao/IncorrectResultSizeDataAccessException 
```

有人可以告诉我我做错了什么吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-31T17:17:10.783

您需要确保您的类路径中有 spring-tx。如果您使用的是构建工具，则可以通过查看类似[search.maven.org](http://search.maven.org/#artifactdetails%7Corg.springframework%7Cspring-tx%7C3.2.0.RELEASE%7Cjar)的内容来了解​​其配置，以解释配置的外观。例如，如果您使用 Spring 3.2.0.RELEASE 和 Maven，您将需要确保您的 pom.xml 中有以下内容：

```
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-tx</artifactId>
    <version>3.2.0.RELEASE</version>
</dependency> 
```

请注意，确保您的 Spring 依赖版本匹配至关重要（即，具有组 org.springframework 的工件应该匹配），因此如果您没有在其他地方使用 Spring 3.2.0.RELEASE，您将需要确保更改版本编号以匹配您的其他 Spring 依赖项。

# javascript - Twitter-Bootstrap 词缀

> ID：14102987
> 
> 赞同：1
> 
> 时间：2012-12-31T14:50:13.473
> 
> 标签：javascript, css, twitter-bootstrap

我正在尝试 twitter-bootstrap 上的词缀功能，这个 js 方法的作用是什么，因为我看到它只是将选择的元素放入：

`position:fixed;`

或者我错了，它也控制元素`window offsets TOP,BOTTOM,LEFT,RIGHT ..`？

我指的主要方法是：

```
$('.element').affix(); 
```

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-31T15:14:32.717

使用 affix 的一个例子是[bootstrap 文档](http://twitter.github.com/bootstrap/javascript.html)中的菜单。

在该位置的顶部，菜单就在它的正常位置上。但是，如果您向下滚动，菜单的位置会发生变化，因此它会停留在屏幕上。

您可能需要为 CSS 中的特定元素设置顶部。

```
.bs-docs-sidenav.affix {
  top: 40px;
} 
```

# javascript - 如何为移动设备优化高度详细的 jQuery 动画

> ID：14102990
> 
> 赞同：1
> 
> 时间：2012-12-31T14:50:23.707
> 
> 标签：javascript, jquery, animation, optimization, mobile

我正在做一个没有 BoilerPlate 的项目，现在它使用了很多 jQuery 动画，例如几个元素的视差和背景中 20 个小的 .png 云图像的移动（以制作云延时），在移动设备上运行非常缓慢和滞后。我希望桌面和移动环境都使用相同的 UX。我正在使用 mediaQueries 为较小的屏幕使用较小的图像/元素，但这似乎并没有像我想象的那样优化移动性能。我熟悉 HTML5-Boilerplate 和 BP-Mobile，但不确定其中任何一个是否能帮助解决我的问题。

**如何让这些特殊效果在移动设备上流畅运行？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-31T15:35:38.537

我会尝试看看 CSS3 动画是否有任何效果。与 CSS3 相比，jQuery animate 有严重的性能缺陷。即使在普通计算机上，它也更加流畅。

# java - GLES2.0：通过 glEGLImageTargetTexture2DOES 使用 GL_TEXTURE_EXTERNAL_OES

> ID：14102992
> 
> 赞同：7
> 
> 时间：2012-12-31T14:50:34.107
> 
> 标签：java, android, opengl-es-2.0, egl

我想在*Java*中渲染一个图像缓冲区（在这种情况下*NDK*不是选项）并通过`GL_TEXTURE_EXTERNAL_OES`.

`glTexImage2D`不起作用，如[规范](http://www.khronos.org/registry/gles/extensions/OES/OES_EGL_image_external.txt)中所述。但是该功能`glEGLImageTargetTexture2DOES`只能通过`GLES11Ext`类使用，这似乎有点错误。

无论如何，我试过了，它给了我`GL_INVALID_OPERATION`，如果：

> 如果 GL 无法使用提供的 eglImageOES 指定纹理对象（例如，如果引用多重采样 eglImageOES），则会生成错误 INVALID_OPERATION。

遗憾的是，我无法从这个描述中得出正面或反面，特别是因为 Android Java API 似乎没有让我访问`eglImageOES`函数。我也没有找到使用此函数的*Java*示例。

附上一个小例子：

```
// Bind the texture unit 0
GLES20.glActiveTexture( GLES20.GL_TEXTURE0 );
throwOnError( "glActiveTexture" );

GLES20.glBindTexture( GL_TEXTURE_EXTERNAL_OES, _samplerLocation );
throwOnError( "glBindTexture" );

// _output is ByteBuffer.allocateDirect(pixels * Integer.SIZE / Byte.SIZE).order(ByteOrder.nativeOrder()).asIntBuffer()
_output.rewind();
_output.limit( pixels );
GLES11Ext.glEGLImageTargetTexture2DOES( GL_TEXTURE_EXTERNAL_OES, _output );
throwOnError( "glEGLImageTargetTexture2DOES" ); // <-- throws

GLES20.glDrawArrays( GLES20.GL_TRIANGLE_STRIP, 0, 4 );
throwOnError( "glDrawArrays" ); 
```

有没有人这样做过或知道这是否可能？

编辑：

我查看了`glEGLImageTargetTexture2DOES`实现，看来我必须正确设置缓冲区。补充说，但仍然是同样的错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-20T16:51:12.143

此页面中有一些评论可能会有所帮助： http: [//developer.android.com/reference/android/graphics/Sur​​faceTexture.html](http://developer.android.com/reference/android/graphics/SurfaceTexture.html)

# github - 没有 component.json 的 Bower 组件

> ID：14102993
> 
> 赞同：0
> 
> 时间：2012-12-31T14:50:40.213
> 
> 标签：github, bower

查看 Bower 上的[可用组件](http://sindresorhus.com/bower-components/)，第一个存储库 ( [accounting.js](https://github.com/josscrowcroft/accounting.js) ) 似乎没有`component.json`-file。通读文档，这似乎是添加为 Bower 组件所必需的。

这怎么可能？

* * *

**编辑：除了添加一个 component.json 文件，当你遵循**[semver-specification](http://semver.org/) 时它也可以工作。情况似乎并非如此，因为根目录中有两个 JS 文件（accounting.js 和 accounting.min.js）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:19:40.710

不幸的是，Bower在注册组件时还没有任何[验证，这意味着任何人都可以注册任何东西。](https://github.com/twitter/bower/issues/53)这就是注册表中某些组件无效的原因。验证主要是等待服务器部分被[移植到 Node.js](https://github.com/twitter/bower-server/issues/1)。

`component.json`始终建议使用A ，但仅当您有多个文件和/或依赖项时才需要，否则 Bower 将根据 git 标签推断版本。