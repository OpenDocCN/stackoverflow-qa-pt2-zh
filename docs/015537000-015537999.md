# StackOverflow 问答 15537000-15537999

# ios - NSLineSeparatorCharacter 在哪里定义？

> ID：15537001
> 
> 赞同：1
> 
> 时间：2013-03-20T23:52:09.540
> 
> 标签：ios, cocoa-touch, constants, newline

我一直在谷歌搜索，搜索和搜索，但找不到答案。我需要包含哪个头文件才能在**iOS**中获取这些常量的定义？

```
NSLineSeparatorCharacter
NSNewLineCharacter
NSParagraphSeparatorCharacter 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T01:21:20.070

这些常量是在`NSText.h`其中定义的，仅适用于 OS X，不适用于 iOS。因此，您不能在 iOS 中使用这些常量。

`NSLineSeparatorCharacter`定义为：`0x2028`

`NSNewLineCharacter`定义为：`0x000a`

`NSParagraphSeparatorCharacter`定义为：`0x2029`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-02T15:21:40.297

在 Swift 中，这可以定义为：

```
let NSNewLineCharacter = "\u{000a}"
let NSLineSeparatorCharacter = "\u{2028}"
let NSParagraphSeparatorCharacter = "\u{2029}" 
```

# xpath - XPATH 查询优化

> ID：15537005
> 
> 赞同：0
> 
> 时间：2013-03-20T23:52:43.283
> 
> 标签：xpath

我有以下 xml 文件

```
<site>
  <people>
    <person id="person0">
      <emailaddress>0@concordia.ca</emailaddress>
    </person>
     <person id="person1">
      <emailaddress>1@concordia.ca</emailaddress>
    </person>
     <person id="person2">
      <emailaddress>2@concordia.ca</emailaddress>
    </person>
  </people>

  <closed_auctions>
    <closed_auction>
    <annotation>123</annotation>
    <seller person="person1"/>
    </closed_auction>
    <closed_auction>
    <annotation></annotation>
    <seller person="person2"/>
    </closed_auction>
     <closed_auction>
    <annotation></annotation>
    <seller person="person3"/>
    </closed_auction>
  </closed_auctions>
</site> 
```

我们有一个人员列表和一个拍卖列表，如您所见，卖家部分包含对人员 ID 的引用

我想检查所有 closed_auction 标签，如果它有非空注释标签，我必须获取卖家人员 ID 并打印此卖家（此人的）的电子邮件地址

当前查询如下所示：

/site/people/person[@id=/site/closed_auctions/closed_auction[annotation/text()]/seller/@person]/emailaddress/text()

此查询适用于小 xml 文件大小，但它永远不会结束大 xml 文件。（我认为问题与嵌套的 xpath 有关，但我找不到任何其他方法）

你能建议任何改进吗

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:33:07.060

> 我想检查所有 closed_auction 标签，如果它有非空注释标签，我必须获取卖家人员 ID 并打印此卖家（此人的）的电子邮件地址

**这是一种通过 XSLT 转换获取所需`emailaddress`元素的有效方法——使用[键](http://www.w3.org/TR/xslt#key)**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kPersonById" match="person" use="@id"/>

 <xsl:template match="/">
     <xsl:copy-of select=
     "key('kPersonById',
          /*/closed_auctions/*[string(annotation)]/seller/@person)/emailaddress"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的 XML 文档时：**

```
<site>
  <people>
    <person id="person0">
      <emailaddress>0@concordia.ca</emailaddress>
    </person>
     <person id="person1">
      <emailaddress>1@concordia.ca</emailaddress>
    </person>
     <person id="person2">
      <emailaddress>2@concordia.ca</emailaddress>
    </person>
  </people>

  <closed_auctions>
    <closed_auction>
    <annotation>123</annotation>
    <seller person="person1"/>
    </closed_auction>
    <closed_auction>
    <annotation></annotation>
    <seller person="person2"/>
    </closed_auction>
     <closed_auction>
    <annotation></annotation>
    <seller person="person3"/>
    </closed_auction>
  </closed_auctions>
</site> 
```

**产生了想要的正确结果：**

```
<emailaddress>1@concordia.ca</emailaddress> 
```

# java - 如何一次检查多个变量？

> ID：15537009
> 
> 赞同：1
> 
> 时间：2013-03-20T23:53:05.627
> 
> 标签：java, arrays, arraylist, null

是否可以编写一段代码来检查某个类型的所有或所有对象/变量的某个特征？（不为每个创建一个 if 语句）
然后将其设置为 true 或 false。

就像如果你有 3 个变量并且......

```
 if(a=0||b=0||c=0){
//set any variable equal to zero to 4
} 
```

执行评论中描述的操作

或者，复杂的示例，4 个整数类型的数组列表：

```
List<Integer> even = new ArrayList<Integer>(), //positive even ints
odd = new ArrayList<Integer>(), //positive odd ints
negaodd = new ArrayList<Integer>() //negative even ints
negaeven = new ArrayList<Integer>(); //negative odd ints 
```

然后是这样的：

```
if("AnyArray".isEmpty()){
whatever-array-is-being-tested/tried = null;
} 
```

因此，如果任何数组最终为空，那么它们将返回“null”而不是 []。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:01:36.940

嗯，如果你想做一些更有趣的事情，然后只是对集合进行迭代，它看起来确实非常实用，就像应用过滤器然后映射一样。尝试 lambdaj 或 google 集合（请参阅此处以获取不错的帖子[http://codemunchies.com/2009/11/functional-java-filtering-and-ordering-with-google-collections-part-3/](http://codemunchies.com/2009/11/functional-java-filtering-and-ordering-with-google-collections-part-3/)）。这是一个使用来自[https://code.google.com/p/lambdaj/wiki/LambdajFeatures](https://code.google.com/p/lambdaj/wiki/LambdajFeatures)的 lambdaj 的示例。

```
List<Integer> oddNumbers = filter(odd, asList(1, 2, 3, 4, 5)); 
```

有关更多潜在想法，请参见此处：[过滤 Java 集合的最佳方法是什么？](https://stackoverflow.com/questions/122105/java-what-is-the-best-way-to-filter-a-collection)

**免责声明** 有时过度使用这种东西（当一个简单的循环就足够了）会使代码更加模糊，所以要小心。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:19:07.663

您可以使用数组或列表以及辅助方法来实现。

```
int[] intArray = { a, b, c };
setZeroes(intArray);

public void setZeroes(int[] a) {
    for (int i = 0; i < a.length; i++) {
        a[i] = (a[i] == 0) ? a[i] : 4;
    }
} 
```

请注意，这不会将`a`、`b`或设置`c`为 0，而是将数组中的元素设置为。

但是......也许它们应该只是数组（或列表）的元素。这是我的预感。

你可以用 List of Lists 做同样的事情。

```
List<List<Integer>> listOfLists = new ArrayList<List<Integer>>();
listOfLists.add(listA);
listOfLists.add(listB);
listOfLists.add(listB);
setListsToNull(listArray);

public void setListsToNull(List<List<Integer>> a) {
    for (int i = 0; i < a.length; i++) {
        List<Integer> thisList = a.get(i);
        a.set(i, thisList.isEmpty() ? null : thisList);
    }
} 
```

我通常会使用 if 语句而不是`?`运算符，但您不需要 ifs....

* * *

您可以轻松地使这两种方法都通用（对于第一个示例，您必须使用对象），但我们将把它留给您......

# php - PHP MySQL如何关联一个表行中的两个字段？

> ID：15537015
> 
> 赞同：0
> 
> 时间：2013-03-20T23:53:58.060
> 
> 标签：php, mysql

如果我可以与我的数据库表对话，我会说“如果 client_id 和 salesrep_id 在同一行，请执行此操作！

我拥有的大多数条件逻辑。这是我正在努力解决的“同一行”部分。

本质上，我正在构建一个系统，允许所有销售代表查看整个数据表，但允许每个代表只更新他们自己的特定条目。

这个想法是禁用显示中其他所有人的“编辑”链接。

像这样...

```
 <?php if ($row_listClients['client_id'] && $row_listClients['salesrep_id']) { ?>
    <td><a href="edit_clients.php?client_id=<?php echo $row_listClients['client_id']; ?>">Edit</a>
    </td>
    <?php } else { ?>
    <td>Edit</td>
    <?php } ?> 
```

显然初始条件不起作用（ && 将始终为真），但其他一切都很好。这只是我坚持的一点。

希望这是有道理的，我知道这可能是非常基本的东西。

谢谢一堆家伙，任何指针将不胜感激。

--

这是查询：

```
 $query_listClients = "SELECT client_id, user_id, repname, date, client_type, company,
    contact_firstname, contact_lastname, phone, email, property, address, city, province,
    repnotes FROM clientdata ORDER BY company ASC";
    $listClients = mysql_query($query_listClients, $connAdmin) or die(mysql_error());
    $row_listClients = mysql_fetch_assoc($listClients); 
```

再次感谢 ...

--

数据库数据样本 - 我仅作为测试输入。前两个数字分别是 client_id 和 user_id：

```
 19;"33"; "Ronald Wharton"; "March 20 2013"; "Commercial"; "Bonkers Inc."; "Brett";
    "Bonkers"; "987   654 3211"; "brentbonkers@bonkersinc.com"; "Retail Outlet"; 
    "12765 34 Ave"; "Lost Soul City"; "Sask"; "Brett wants to meet with Keith and Dean 
    before the end of the week.  Please call before Friday." 
```

不知道这是否有帮助，但你走了，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:14:58.753

您应该将当前的salesrep_id（登录的那个人）存储在会话中，然后将其与mySql查询返回的salesrep_id进行比较（在下面的示例中，我将当前登录的salesrep_id设为1）

在 SQL 语句中添加 WHERE 子句，如下所示：

`SELECT * FROM $tableName WHERE salesrep_id = 1`

你只得到 salesrep_id = 1 的行

或者，如果您想从数据库中获取所有行，然后

`SELECT * FROM $tableName`

进而

// 检查返回的 salesrep_id = current Sales Rep. Id (本例中为 1)

`<?php if ($row_listClients['client_id'] && $row_listClients['salesrep_id'] == 1) : ?>`

// 显示编辑链接

`<?php endif; ?>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T20:22:07.917

我重读了你的问题。听起来好像您正在查询以获取所有记录，但只想显示应允许特定销售代表编辑的项目的编辑链接。

由于您想要所有记录，因此不应该通过 SQL 来完成，听起来您需要做的就是更改：

```
<?php if ($row_listClients['client_id'] && $row_listClients['salesrep_id']) { ?> 
```

类似于：

```
<?php if ($row_listClients['salesrep_id'] == $currentSalesRepId) { ?> 
```

您显然需要为`$currentSalesRepId`.

# c - linux c 套接字

> ID：15537016
> 
> 赞同：1
> 
> 时间：2013-03-20T23:53:59.850
> 
> 标签：c, linux, sockets, protocols

晚上好，我是在 c 编程语言下使用 linux sockets 的新手。

现在我正在尝试让客户端与服务器通信。基本上我坚持的事情是让服务器接受来自客户端的连接并在接收到它们后打印数字。到目前为止，这是服务器的源代码：

```
#include <sys/socket.h>
#include <netinet/in.h>
#include <arpa/inet.h>
#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <errno.h>
#include <string.h>
#include <sys/types.h>
#include <time.h>

int main(int argc, char *argv[])
{
    int listenfd = 0, connfd = 0, n = 0;
    struct sockaddr_in serv_addr;
    char sendBuff[1024], recvBuff[1024];

    listenfd = socket(AF_INET, SOCK_STREAM, 0);
    memset(&serv_addr, '0', sizeof(serv_addr));
    memset(sendBuff, '0', sizeof(sendBuff));

    serv_addr.sin_family = AF_INET;
    serv_addr.sin_addr.s_addr = htonl(INADDR_ANY);
    serv_addr.sin_port = htons(5000);

    bind(listenfd, (struct sockaddr*)&serv_addr, sizeof(serv_addr));

    listen(listenfd, 10);

    while(1)
    {
        printf("in first while loop\n");
        connfd = accept(listenfd, (struct sockaddr*)NULL, NULL);
        while( (n = read(listenfd, recvBuff, sizeof(recvBuff)-1)) > 0)
        {
                printf("in second while loop\n");
                recvBuff[n] = 0;

                fputs(recvBuff, stdout);
        }
    }
} 
```

我没有发布客户端代码，因为我认为它不相关。我已经制作了一个服务器，它可以向客户端发送一些东西，它工作得很好。但我对如何让服务器接受来自客户端的输入感到非常困惑。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T05:07:26.997

给出的其他答案（读取`connfd`和不读取`listenfd`）将解决代码中的问题；提出这个答案可能有助于解决围绕服务器套接字的“严重混乱”。

“套接字”通常被认为是两个应用程序之间的管道，这就是*接受和连接*的套接字在我们的代码中的行为方式（`connfd`在上面的示例中）。

但是，一般来说，“套接字”只是一个“句柄”，也可以以其他方式使用，例如希望通过绑定到特定端口来接受新连接的服务器。在上面的示例中，`listenfd`是用于绑定到特定端口的套接字句柄，因此可以接受连接。每个成功的返回`accept`实际上都返回一个**新**的套接字句柄到一个已连接的套接字（例如`connfd`），其中数据实际上可以被读取和写入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:03:56.860

你需要改变

```
connfd = accept(listenfd, (struct sockaddr*)NULL, NULL);
while( (n = read(listenfd, recvBuff, sizeof(recvBuff)-1)) > 0) 
```

对此

```
connfd = accept(listenfd, (struct sockaddr*)NULL, NULL);
while( (n = read(connfd, recvBuff, sizeof(recvBuff)-1)) > 0) 
```

因为监听套接字只能接受连接

# c++ - 数独求解器为无法求解的数独找到解决方案

> ID：15537017
> 
> 赞同：-1
> 
> 时间：2013-03-20T23:54:06.217
> 
> 标签：c++, algorithm, recursion

我写了一个数独求解器，当数独可解时它工作得很好。但是，当数独无法解决时，它会在回溯时更改谜题的原始数字。

```
bool Sudoku::solve(int row, int col){
if (board[row][col] != 0){
    int next_col = col;
    int next_row = row;

    next_col++;

    if (next_col > 8){
        next_row++;
        next_col = 0;
    }

    if (next_row > 8){
        return true;
    } else {
        if (solve(next_row, next_col))
            return true;
    }
}

for (int number = 1; number <= 9; number++){
    board[row][col] = number;

    if (check_row(row, number)
     && check_col(col, number)
     && check_box(row, col, number)){
        int next_row = row;
        int next_col = col+1;

        if (next_col > 8){
            next_col = 0;
            next_row++;
        }

        if (next_row > 8){
            return true;
        }

        if (solve(next_row, next_col))
            return true;
     }
}

board[row][col] = 0;
return false; 
```

}

board 是一个 2D int 数组。我知道我可以使用某种结构而不是整数，它会存储数字是否最初存在，但是这个解决方案对我来说并不是很有吸引力。还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:06:21.830

在开始的检查中，当单元格被设置时，

```
if (board[row][col] != 0){
    int next_col = col;
    int next_row = row;

    next_col++;

    if (next_col > 8){
        next_row++;
        next_col = 0;
    }

    if (next_row > 8){
        return true;
    } else {
        if (solve(next_row, next_col))
            return true;
    }
} 
```

添加一个

```
else {
    return false;
} 
```

或将最后一个更改为

```
return solve(next_row, next_col); 
```

以避免更改给定的数字。照原样，如果无法解决难题 - 即使在错误地猜测了可以解决原始单元格的前一个单元格之后 - 它会很高兴地继续更改单元格中的数字。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:03:29.283

您可以创建一组所有访问过的位置。

一个示例实现是创建`std::set<pair<int, int> > visited`包含已访问的每个位置。然后，如果该位置已被访问，则不要更改该值。

# php - 出现联系表单消息但没有电子邮件

> ID：15537021
> 
> 赞同：1
> 
> 时间：2013-03-20T23:54:35.243
> 
> 标签：php, forms, input

我已经建立了一个联系表单，但问题是，有时它会发送消息，有时它不会，我在网站上添加了一个搜索栏，并为输入提交按钮设置了不同的样式，这可能是干扰吗？

这是代码。

```
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];
$from = 'From: info@epicconcepts.nl'; 
$to = 'info@epicconcepts.nl'; 
$subject = 'Contact formulier bericht';
$human = $_POST['human']; 

$headers = "From: info@epicconcepts.nl\r\n";
$headers .= "Reply-To: ". strip_tags($_POST['email']) . "\r\n";
$headers .= "CC: quincynorbert@gmail.com\r\n";
$headers .= 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

$body = '<!DOCTYPE html>
<html>
  <head>
<style type="text/css">
  body
      {background: #fff;
  width:100%;
  height:auto;
  margin: 0;}
  #header-mail{background:#110f10;
  width:650px;
  height:70px;
  margin: 0 auto;}
  #content{background:#fff;
  width:630px;
  height:auto;
  padding: 20px;
  word-wrap:break-word;
  margin: 0 auto;}
  .mail-text{font-family:arial;
  color:#808080;
  font-size:12pt;
  line-height:130%;
  margin: 0 auto;
  text-align: left;}
  .bold{font-family:arial;
  color:#1f669a;
  font-size:14pt;
  font-weight:bold;
  margin: 0 auto;
  text-align: left;}
</style>
  </head>
<body>
  <center>
<img src="http://k2stuc.nl/img/bg-mailer.jpg" alt="Header" />
<div id="content">
      <p class="bold">'.$name.'<br>'.$email.'</p><br>
      <p class="mail-text">'.nl2br($message).'</p> 
</div>
<a href="http://www.k2stuc.nl">
<img src="http://k2stuc.nl/img/mailer-footer.jpg" alt="Footer" />
</a>
  </center>
</body>
</html>';
if ($_POST['submit']) {
if ($name != '' && $email != '') {
if ($human == '4') {                 
if (mail ($to, $subject, $body, $headers)) { 
echo '<p class="correct-message">Uw bericht is succesvol verzonden!</p>';
} else { 
echo '<p class="correct-message">Er is iets verkeerd gegaan, probeer het nog eens!</p>'; 
} 
} else if ($_POST['submit'] && $human != '4') {
echo '<p class="correct-message">U heeft de veiligheidsvraag verkeerd beantwoord!</p>';
}
} else {
echo '<p class="correct-message">U heeft niet alle verplichte velden ingevuld!</p>';
}
}
?>

        <form method="post" action="contact.php">

            <label>Naam</label>
            <input name="name" placeholder="Type hier">

            <label>Email</label>
            <input name="email" type="email" placeholder="Type hier">

            <label>Bericht</label>
            <textarea name="message" placeholder="Type hier"></textarea>

            <label>Hoeveel is 2+2?</label>
            <input name="human" placeholder="Type hier">

            <input id="submit" name="submit" type="submit" value="Verzend">

        </form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:43:21.460

试试这个。我注释掉了几行。用我自己的邮件测试后，我用下面的代码发送了 10 封测试邮件并全部收到。

```
<?php
$name = $_POST['name'];
$email = $_POST['email'];
$message = $_POST['message'];
// $from = 'From: info@epicconcepts.nl'; // COMMENTED OUT - conflicting
$to = 'info@epicconcepts.nl'; 
$subject = 'Contact formulier bericht';
$human = $_POST['human']; 

$headers = "From: info@epicconcepts.nl\r\n";
$headers .= "Reply-To: ". strip_tags($_POST['email']) . "\r\n";
// $headers .= "CC: quincynorbert@gmail.com\r\n"; // Commented out for testing. May be a problem
$headers .= 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";

$body = '<!DOCTYPE html>
<html>
<head>
<style type="text/css">
body{background: #fff;
width:100%;
height:auto;
margin: 0;}
#header-mail{background:#110f10;
width:650px;
height:70px;
margin: 0 auto;}
#content{background:#fff;
width:630px;
height:auto;
padding: 20px;
word-wrap:break-word;
margin: 0 auto;}
.mail-text{font-family:arial;
color:#808080;
font-size:12pt;
line-height:130%;
margin: 0 auto;
text-align: left;}
.bold{font-family:arial;
color:#1f669a;
font-size:14pt;
font-weight:bold;
margin: 0 auto;
text-align: left;}
</style>
</head>
<body>
<center>
<img src="http://k2stuc.nl/img/bg-mailer.jpg" alt="Header" />
<div id="content"><p class="bold">'.$name.'<br>'.$email.'</p><br><p class="mail-text">
'.nl2br($message).'</p> 
</div>
<a href="http://www.k2stuc.nl">
<img src="http://k2stuc.nl/img/mailer-footer.jpg" alt="Footer" />
</a>
</center>
</body>
</html>';

if ($_POST['submit']) {
if ($name != '' && $email != '') {
if ($human == '4') {                 
if (mail ($to, $subject, $body, $headers)) { 
echo '<p class="correct-message">Uw bericht is succesvol verzonden!</p>';
} else { 
echo '<p class="correct-message">Er is iets verkeerd gegaan, probeer het nog eens!</p>'; 
} 
} else if ($_POST['submit'] && $human != '4') {
echo '<p class="correct-message">U heeft de veiligheidsvraag verkeerd beantwoord!</p>';
}
} else {
echo '<p class="correct-message">U heeft niet alle verplichte velden ingevuld!</p>';
}
}
?> 
```

# c++ - 方法的声明改变了符号的含义

> ID：15537023
> 
> 赞同：21
> 
> 时间：2013-03-20T23:54:36.040
> 
> 标签：c++, token-name-resolution

对于以下代码：

```
struct foo {};

struct A
{
    typedef foo foo_type;

    void foo();
}; 
```

GCC 给出一个编译器错误：

```
test.cpp:7:14: error: declaration of 'void A::foo()' [-fpermissive]
     void foo();
              ^
test.cpp:1:8: error: changes meaning of 'foo' from 'struct foo' [-fpermissive]
 struct foo {};
        ^ 
```

但是 clang 接受它而没有编译器错误。谁是对的？

请注意，如果 typedef 被删除或更改为`typedef ::foo foo_type`，则 gcc 和 clang 都接受该代码。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-21T03:07:13.143

gcc 是正确的，但 clang 不需要给出诊断（3.3.7）：

> 在 S 类中使用的名称 N 应在其上下文中引用相同的声明，并且在 S 的完整范围内重新评估时。违反此规则不需要诊断。

这是因为类范围是如何工作的。`foo`of在类的**整个**范围`void foo();`内都是可见的，因此声明的 typedef 中的含义从引用函数的名称发生了变化。**`A``void foo();``foo``struct foo``foo`**

# glob - python修复由py2exe创建的独立exe，包括pyd/dll

> ID：15537028
> 
> 赞同：1
> 
> 时间：2013-03-20T23:54:54.400
> 
> 标签：glob, loadlibrary

我有一个非常简单的脚本，我将它转换为`exe`使用`py2exe`. 然后我将它移到没有 Python 的 Windows 7 机器上。

当我运行它时，我收到以下错误：

> LoadLibrary(pythondll) failed
> 找不到指定的模块。C:\PYTHON27.DLL

我试图阅读和测试一些包含 dll 的代码，但没有任何效果。我怎样才能包含这个dll？

如果有帮助，我的 python 脚本只是将基本的东西导入为

```
import os 
import getpass
import urllib2
import os
import re
import time 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:31:19.617

您必须将 DLL 分发到与可执行文件相同的目录中，或者将其放在要运行可执行文件的机器上的环境 PATH 中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-06T17:36:06.857

这可能是由于在路径上安装了 32 位和 64 位 Python 造成的。

仔细查看输出`python setup.py py2exe`

```
. . .
*** copy extensions ***
copying C:\Python27\DLLs\_hashlib.pyd -> C:\path\to\project\dist
copying C:\Python27\DLLs\_socket.pyd -> C:\path\to\project\dist
copying C:\Python27\DLLs\_ssl.pyd -> C:\path\to\project\dist
copying C:\Python27\DLLs\bz2.pyd -> C:\path\to\project\dist
copying C:\Python27\DLLs\select.pyd -> C:\path\to\project\dist
copying C:\Python27\DLLs\unicodedata.pyd -> C:\path\to\project\dist
copying C:\PythonEnvs\some_virtualenv\lib\site-packages\pyodbc-3.0.7-py2.7-win32.egg\pyodbc.pyd -> C:\path\to\project\dist
copying C:\PythonEnvs\some_virtualenv\lib\site-packages\win32\win32print.pyd -> C:\path\to\project\dist
*** copy dlls ***
copying C:\Windows\system32\python27.dll -> C:\path\to\project\dist
setting sys.winver for 'C:\path\to\project\dist\python27.dll' to 'ProjectNameHere'
copying C:\PythonEnvs\some_virtualenv\lib\site-packages\pywin32_system32\pywintypes27.dll -> C:\path\to\project\dist
copying C:\Windows\system32\CRYPT32.dll -> C:\path\to\project\dist
copying C:\PythonEnvs\some_virtualenv\lib\site-packages\py2exe-0.6.9-py2.7-win32.egg\py2exe\run.exe -> C:\path\to\project\dist\mlr_startup.exe 
```

确保 py2exe 只从你想要的地方拉取。

在上面的运行示例中，py2exe 正在从 Python 2.7 的系统安装中提取，`C:\Python27`. 它还从当前的虚拟环境中引入，`C:\PythonEnvs\some_virtualenv\lib\site-packages`. 这将产生一个工作可执行文件。

当我遇到这个问题时，我看到 py2exe 也在从其他地方拉取东西，这些地方有不兼容的 Python 版本。

例如，我有 32 位的官方 Python，然后安装了 64 位版本的 Mercurial。Mercurial 安装了它自己的 64 位版本的 Python，而 py2exe`C:\Python27`从`C:\Program Files\Mercurial\Python27`.

为了解决这个问题，我刚刚卸载了 Mercurial。或者，您可以修改 Python 路径，以便 py2exe 不知道安装 Mercurial 的 Python 版本或任何其他不受欢迎的 Python 安装。

# ios - UILabel 中不同大小的顶部对齐文本

> ID：15537033
> 
> 赞同：24
> 
> 时间：2013-03-20T23:55:16.557
> 
> 标签：ios, ios6, uilabel, nsattributedstring

如何在 UILabel 中对齐不同大小的文本？一个例子是在价格横幅中将较小的美分金额与较大的美元金额对齐。

![示例图像](../Images/21fbaf05a5549e1a47a9e55f7fe9f2ec.png)

iOS6 中的 UILabel 支持`NSAttributedString`允许我在同一个 UILabel 中拥有不同大小的文本。但是，它似乎没有顶部对齐文本的属性。有哪些实施方案？在我看来，提供自定义绘图逻辑以基于自定义属性字符串键进行顶部对齐可能是最好的，但我不知道如何去做。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2014-08-26T23:23:11.220

我能够使用单个标签达到您想要的结果。

使用一点数学，您可以偏移较小文本的基线以达到您想要的结果。

Objective-C

```
- (NSMutableAttributedString *)styleSalePriceLabel:(NSString *)salePrice withFont:(UIFont *)font
{
    if ([salePrice rangeOfString:@"."].location == NSNotFound) {
        return [[NSMutableAttributedString alloc] initWithString:salePrice];
    } else {
        NSRange range = [salePrice rangeOfString:@"."];
        range.length = (salePrice.length - range.location);
        NSMutableAttributedString *stylizedPriceLabel = [[NSMutableAttributedString alloc] initWithString:salePrice];
        UIFont *smallFont = [UIFont fontWithName:font.fontName size:(font.pointSize / 2)];
        NSNumber *offsetAmount = @(font.capHeight - smallFont.capHeight);
        [stylizedPriceLabel addAttribute:NSFontAttributeName value:smallFont range:range];
        [stylizedPriceLabel addAttribute:NSBaselineOffsetAttributeName value:offsetAmount range:range];
        return stylizedPriceLabel;
    }
} 
```

迅速

```
extension Range where Bound == String.Index {
    func asNSRange() -> NSRange {
        let location = self.lowerBound.encodedOffset
        let length = self.lowerBound.encodedOffset - self.upperBound.encodedOffset
        return NSRange(location: location, length: length)
    }
}

extension String {
    func asStylizedPrice(using font: UIFont) -> NSMutableAttributedString {
        let stylizedPrice = NSMutableAttributedString(string: self, attributes: [.font: font])

        guard var changeRange = self.range(of: ".")?.asNSRange() else {
            return stylizedPrice
        }

        changeRange.length = self.count - changeRange.location
        // forgive the force unwrapping
        let changeFont = UIFont(name: font.fontName, size: (font.pointSize / 2))!
        let offset = font.capHeight - changeFont.capHeight
        stylizedPrice.addAttribute(.font, value: changeFont, range: changeRange)
        stylizedPrice.addAttribute(.baselineOffset, value: offset, range: changeRange)
        return stylizedPrice
    }
} 
```

这会产生以下结果：

![](../Images/38cd6596b8dc8b0bd26ea8c73ae2797b.png)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-03-21T04:22:52.483

尝试简单地通过对齐框架的原点来做到这一点的问题是，“正常”字符通常最终会在它们周围加上一些额外的填充，因为标签必须容纳*所有*字体的字符，包括那些将上升的字符和长的下降字符。您会在您发布的图片中注意到，如果较小的“99”是一个单独的标签，并且设置为与较大的文本相同的来源，那么由于美元符号的最高点，它会太高。

幸运的是，`UIFont`它为我们提供了正确执行此操作所需的所有信息。我们需要测量标签正在使用的空上升空间并调整相对位置以解决它，如下所示：

```
//Make sure the labels hug their contents
[self.bigTextLabel sizeToFit];
[self.smallTextLabel sizeToFit];

//Figure out the "blank" space above normal character height for the big text
UIFont *bigFont = self.bigTextLabel.font;
CGFloat bigAscenderSpace = (bigFont.ascender - bigFont.capHeight);

//Move the small text down by that ammount
CGFloat smallTextOrigin = CGRectGetMinY(self.bigTextLabel.frame) + bigAscenderSpace;

//Figure out the "blank" space above normal character height for the little text
UIFont *smallFont = self.smallTextLabel.font;
CGFloat smallAscenderSpace = smallFont.ascender - smallFont.capHeight;

//Move the small text back up by that ammount
smallTextOrigin -= smallAscenderSpace;

//Actually assign the frames
CGRect smallTextFrame = self.smallTextLabel.frame;
smallTextFrame.origin.y = smallTextOrigin;
self.smallTextLabel.frame = smallTextFrame; 
```

（此代码假设您有两个标签属性，分别名为`bigTextLabel`和`smallTextLabel`）

* * *

编辑：

在没有两个标签的情况下执行此操作非常相似。您可以创建一个自定义 UIView 子类并`NSAttributedStrings`使用该`-drawInRect:options:context:`方法在其中绘制（确保`NSStringDrawingUsesLineFragmentOrigin`在您的选项中使用）。计算顶部对齐的数学应该是相同的，唯一的区别是您通过`NSFontAttributeName`属性而不是标签从属性字符串中获取字体。2012 WWDC 关于属性字符串绘制的视频是一个很好的参考。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-10-13T20:38:12.393

这太糟糕了。在稍作修改后，我没有足够的声誉来评论我使用得很好的答案。我只想指出使用`smallfont`cents 而不是`font`，这可能是一个错字。

下面是修改后的代码

```
- (NSMutableAttributedString *)styleSalePriceLabel:(NSString *)salePrice withFont:(UIFont *)font
{
    if ([salePrice rangeOfString:@"."].location == NSNotFound) {
        return [[NSMutableAttributedString alloc]  
                   initWithString:salePrice];
    } else {
        NSRange range = [salePrice rangeOfString:@"."];
        range.length = (salePrice.length - range.location);
        NSMutableAttributedString *stylizedPriceLabel =
            [[NSMutableAttributedString alloc] initWithString:salePrice];
        UIFont *smallfont = [UIFont fontWithName:font.fontName 
                                            size:(font.pointSize / 2)];
        NSNumber *offsetAmount = @(font.capHeight - smallfont.capHeight);
        [stylizedPriceLabel addAttribute:NSFontAttributeName 
                                   value:smallfont 
                                   range:range];
        [stylizedPriceLabel addAttribute:NSBaselineOffsetAttributeName 
                                   value:offsetAmount 
                                   range:range];
        return stylizedPriceLabel;
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T00:54:46.013

一种可能的方法是使标签与您输入的文本的大小完全相同。

```
CGRect labelFrame;
//Set the origin of the label to whatever you want
labelFrame.size = [label.text sizeWithFont:label.font];  //If using NSString
labelFrame.size = [label.text size];                     //If using NSAttributedString
label.frame = labelFrame; 
```

有关更多详细信息，请参阅此类[似的 SO 帖子](https://stackoverflow.com/questions/1054558/vertically-align-text-within-a-uilabel)。

# iphone - XCode 工具链：如何将应用程序从一个帐户移动到另一个帐户？

> ID：15537039
> 
> 赞同：1
> 
> 时间：2013-03-20T23:55:43.693
> 
> 标签：iphone, ios, xcode, account, toolchain

类似于[这种情况](https://stackoverflow.com/questions/10676961/two-ios-developer-licenses-on-one-mac?rq=1)[*]。

请跟进澄清，因为我在平行宇宙中：

*   A.***我***，作为单一的 Apple 开发者。

和

*   B.***客户***，由两人组成的团队 - 我刚刚被添加为第 2 个人，一个管理员

    （不是代理 - 他是第 1 个人）。

客户给了我一个*** 应用程序重写/修复的源代码。***第一个版本还在 App Store 上，我的升级是它的替代品。

我在我的机器上重写了应用程序，*使用我的 Apple 开发帐户*和我的开发人员证书进行设备测试。所以，在这一点上，它似乎是“我的”应用程序。请注意，我还没有为我或客户端分发或 iTunes Connect。但他们确实有它们用于应用程序的早期版本，我的升级是要替换的，如前所述。)

现在，它没有错误 :-/ 并且需要***在客户的帐户下上线，而不是我的。***

这就是我被困和困惑的地方。（我与 Apple 交谈过，他们有些帮助，但我担心会损坏/混淆我机器上的所有证书/帐户。）

问题：

1a。客户可以只使用门户（在他们的 ID 下）生成新的分发证书/规定供我使用吗？

1b。我应该把它们放到我的 XCODE 中吗？

“2。” 那我可以在他们的帐号下分发吗？

3a。他们是否也必须（从他们的帐户）为我生成开发者证书？（Apple 的两个人建议这样做，但不确定。）

3b。在这种情况下，在进行分发之前，我必须在我的机器上根据他们的开发证书重新编译吗？

这似乎几乎火箭科学困难，但它不应该！

感谢您的*任何*帮助。

（我希望这确实符合FAQ第3条“工具链”中的编程问题！）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:08:19.763

我认为您可以共享客户的分发证书或重新生成一个新证书。

对于后一种情况，客户端不能再分发应用程序。你可以用谷歌搜索第一个解决方案，有很多。

# cocos2d-iphone - Cocos2d 中的动作序列

> ID：15537042
> 
> 赞同：0
> 
> 时间：2013-03-20T23:55:55.517
> 
> 标签：cocos2d-iphone, ccsprite, ccaction

我有一组精灵。我想遍历数组并告诉每个精灵以随机角度移动一定距离，并在这样做时淡出。最好有缓动。有没有办法设置一个序列来做到这一点？您是否可以有一个可变序列，您可以在循环遍历 sprite 数组时添加动作，然后在添加完所有动作后运行该序列？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T04:41:52.643

我不太明白你的问题，但也许这个例子可以帮助你：

```
CCArray *spritesArray; //array with sprites

float timeToMove = 1.0;
float timeToRotate = 1.0;
float timeToFadeOut = 1.0;
CGPoint initialMovePos = CGPointMake(100, 100);

for (int i = 0; i<[spritesArray count]; i++) {
    id moveDistance;
    if (i == 0) {
        moveDistance = [CCMoveTo actionWithDuration:timeToMove position:initialMovePos];
    }else{
        CGPoint lastSpritePos = ((CCSprite *)[spritesArray objectAtIndex:(i-1)]).position;
        moveDistance = [CCMoveTo actionWithDuration:timeToMove position:ccpAdd(lastSpritePos, CGPointMake(10, 10))];
    }

    float angleToRotate = random()%360;
    id rotateAction = [CCRotateTo actionWithDuration:timeToRotate angle:angleToRotate];
    id fadeOutAction = [CCFadeOut actionWithDuration:timeToFadeOut];

    CCSprite *sprite = [spritesArray objectAtIndex:i];

    [sprite runAction:[CCSpawn actions:moveDistance,rotateAction,fadeOutAction, nil]];
} 
```

# c# - 记录 Windows 服务

> ID：15537047
> 
> 赞同：4
> 
> 时间：2013-03-20T23:56:24.390
> 
> 标签：c#, logging, windows-services, log4net, event-log

我有以下代码用于记录我通过在线研究找到的 Windows 服务。它在我的服务类中完成，然后像下面这样被初始化。

```
public GBBInvService()
        {
            InitializeComponent();
            if (!System.Diagnostics.EventLog.SourceExists("MyLogSource"))
                System.Diagnostics.EventLog.CreateEventSource("MyLogSource",
                                                                      "MyDoLog");
            eventLog1.Source = "MyLogSource";
            eventLog1.Log = "MyDoLog";
        } 
```

记录时的代码：

```
eventLog1.WriteEntry("GBBInvService Service Started"); 
```

然而，我们的顾问建议我不要这样做。他的评论如下：

*我会避免让服务在运行时创建事件源。这要求服务以高权限运行（即对计算机的访问权限比实际需要的更多）。设置 Windows 事件日志源实际上是一项安装时的工作。您可能能够将事件日志安装程序添加到项目安装程序文件（连同服务安装程序），然后事件源将始终存在*

这个建议的问题是我无法找到在项目安装程序文件中创建日志的任何示例。我还尝试将此日志创建部分移动到我的项目安装程序中，但它不会让我从我的 Web 服务 cs 页面调用或写入 eventlog1。他还建议使用 log4net，但这对我来说是新事物，而且很难掌握。我刚刚完成了我的第一个 Windows 服务项目，我对 Windows 服务仍然很陌生，并且非常感谢在项目安装程序中创建日志、从我的服务 cs 页面或 log4net 上的任何提示中写入日志的任何方向。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T23:59:45.757

您的顾问是正确的，在服务中这样做是个坏主意。

以下是在安装程序中创建事件源的方法：

[http://blogs.msdn.com/b/helloworld/archive/2008/12/11/creating-an-event-log.aspx?Redirected=true](http://blogs.msdn.com/b/helloworld/archive/2008/12/11/creating-an-event-log.aspx?Redirected=true)

短版：子类安装程序，并在子类安装程序的构造函数中创建事件日志源。

**更新**

从链接：

> 执行服务安装程序后，日志已“注册”，但尚未创建。要创建它，必须编写一个事件。如果服务使用受限用户帐户运行，则该帐户可能没有足够的安全权限来写入第一个日志，因为需要创建日志。

示例代码未显示正在写入的一个事件。确保你正在这样做。

> 安装服务时，用户必须以管理员身份运行安装程序

确保以管理员身份运行安装程序。

从您的评论中：

> 服务无法启动。

在事件日志中查找它未启动的原因。也许它会抛出异常，例如，如果您没有在安装程序中编写一个事件，或者您没有以管理员身份运行安装程序。

# php - PHP HTML Word Doc不显示通过URL生成的图像

> ID：15537055
> 
> 赞同：3
> 
> 时间：2013-03-20T23:57:11.800
> 
> 标签：php, html, ms-office, doc

我有一个 php 脚本，它通过在 HTML 中创建并在从我的网站附加静态图像时将其输出到生成 word 文档，`.doc`图像在 Microsoft Word 03 和 2010 中加载良好。但是当尝试使用 URL 生成图像时（通过解析参数）图像似乎没有加载。

```
header('Content-type: application/ms-word');
header('Content-Disposition: attachement;filename="report.doc"');
header('Content-Transfer-Encoding: binary');
print($output); 
```

这是我想要做的，我有一个 URL (website.com/signature.php?form=XXXX)，`XXX`表单 ID 在哪里。signature.php 接受 ID 编号，定位存储在服务器上的 JSON，并使用此 jquery 插件[http://thomasjbradley.ca/lab/signature-to-image/从 JSON 文件生成图像](http://thomasjbradley.ca/lab/signature-to-image/)

签名/图像转换得很好，当我针对一些示例对其进行测试时，我看到了它，但是当用 word 打开文档时，它没有显示。

```
<img style="display: block;" alt = "" width="200" height="74" src = "http://myWebsite.net/signature.php?form=' . $results[$i]['id'] . '" /> 
```

这就是我的 HTML 所拥有的。

编辑：

在我的 signature.php 中，我有以下内容：

```
 require("DB/DBConnection.php");
  require("signature-to-image.php");

  $formID = $_REQUEST['form'];
  $dbh = DBConnection::connection();
  $sql = "SELECT signature FROM forms where id = ?";
  $stmt = $dbh->prepare($sql); 
  $stmt->bindValue(1, $formID, PDO::PARAM_STR);
  $stmt->execute();
  $result = $stmt->fetch();
  if ($result != null) {
    $img = sigJsonToImage($result['signature']);
    header('Content-Type: image/jpeg');
    imagejpeg($img);
    imagedestroy($img);
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:04:32.550

我想它正在查看标题，而不是看到它想要什么。

在`signature.php`脚本中，直接在输出图像之前，尝试添加：

```
header('Content-Type: image/jpeg'); 
```

... 用图像输出的任何格式替换 jpeg。

让我知道这是否有效，我们可以从那里得到它。

# python - python 3的美丽汤4

> ID：15537056
> 
> 赞同：0
> 
> 时间：2013-03-20T23:57:15.033
> 
> 标签：python, parsing, web, python-3.x, beautifulsoup

有谁知道我在哪里可以找到有关使用 Python 3 和 Beautifulsoup 4 的视频教程？我真的需要知道如何使用它，以便我可以用它编写脚本。提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:09:22.120

[noobniche](http://www.noobniche.com/)的Chris Hawkes有几个 BeautifulSoup 视频教程。它们是第[7](http://www.youtube.com/watch?v=keefYknSbt4)集和[第 8](http://www.youtube.com/watch?v=i9G6SJLtFm0)集。

另一个例子，也可以在 youtube 上找到，涵盖了使用 BeautifulSoup 处理天气预报数据。可以在[这里](http://www.youtube.com/watch?v=4mZ3R8M-8Mk)查看。

# ios - 在 IOS 应用中播放 SoundCloud 文件

> ID：15537080
> 
> 赞同：6
> 
> 时间：2013-03-21T00:00:09.977
> 
> 标签：ios, soundcloud

使用提供的快速入门指南想在 IOS 应用程序中播放 SoundCloud 曲目。

提供播放流的代码在这里：

```
SCAccount *account = [SCSoundCloud account];

    [SCRequest performMethod:SCRequestMethodGET
                  onResource:[NSURL URLWithString:audioFile]
             usingParameters:nil
                 withAccount:account
      sendingProgressHandler:nil
             responseHandler:^(NSURLResponse *response, NSData *data, NSError *error) {
                 NSError *playerError;
                 audioPlayer = [[AVAudioPlayer alloc] initWithData:data error:&playerError];
                 audioPlayer.numberOfLoops = 0;

                 [audioPlayer prepareToPlay];
                 [audioPlayer play];
             }]; 
```

问题：有没有一种无需先登录 SoundCloud 帐户即可播放 SoundCloud 文件的方法？我们希望所有用户都考虑使用 SoundCloud - 但是，如果新用户之前可以收听许多曲目，那么出于可用性考虑，这将很有用。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-25T16:53:53.183

对于 IOS Soundcloud SDK 的公共访问，您需要将 Soundcloud clientID 作为参数添加到您的请求字符串中：

```
NSString *urlString = [NSString stringWithFormat:@"%@?client_id=%@", publicTrackUrlString, yourSCClientID];
[SCRequest performMethod: SCRequestMethodGET 
              onResource: [NSURL URLWithString:urlString]
         usingParameters: nil 
             withAccount: nil
  sendingProgressHandler: nil 
         responseHandler:^(NSURLResponse *response, NSData *data, NSError *error){
                      // 
         }]; 
```

然后，当 withAccount: 参数为 nil 时，它将适用于公共轨道。

更优雅的是，您还可以将“client_id”打包到字典中并与 usingParameters 一起使用：

`NSDictionary *params = @{@"client_id": yourSCClientID} ;`

# php - How to change a value permanently in another PHP file

> ID：15537084
> 
> 赞同：1
> 
> 时间：2013-03-21T00:00:26.493
> 
> 标签：php, file-io

I am using a configuration file for something I am working on. In that configuration file, I have a line like `$twelveHourTimeEnabled = true;`. I want to be able to switch true to false in this but am not sure the way to change just that line from `true` to `false`.

Currently, I am using separate files that switches the two, but I know this must be grossly inefficient.

```
$fn = "config.php"; 
$file = fopen($fn, "w+"); 
$size = filesize($fn); 

$twelveHourConfig = "12hrconfig.php";
$twelveHourConfigFile = file_get_contents($twelveHourConfig);

fwrite($file, $twelveHourConfigFile);

fclose($file); 
```

How would I switch the true value to false, or vice versa without requiring two other files to read in?

EDIT:

This project is a PHP plug-in for a desktop app (Alfred App for Mac OS X) which returns TV information to the user wherever they are. For this reason, this action is being done when a keyword is called. For this reason there is no way to use a database, etc.

EDIT 2: Sorry, I have no experience with JSON or other file IO operations as I normally deal with CRUD. Also, know that I have no control over the user machines, etc. This needs to function with PHP that would be installed by default when someone installs Mac OS X. Nothing more. If someone can explain JSON I would be happy to use it, I just don't know anything about it, how to use it, etc.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:21:54.417

For configuration files I would recommend the following setup.

Let's assume this is the contents of `config.php`:

```
<?php

return array(
    'opt1' => 'value1',
    'opt2' => 'value2',
); 
```

Then, to load this configuration:

```
<?php

$config = require 'config.php';
// $config['opt1'] == 'value1' 
```

Modifying the configuration can be done by changing the array and writing it back:

```
$config['opt2'] = 'value2 but different'; 

file_put_contents('config.php', '<?php return ' . var_export($config, true) . ';'); 
```

To swap configuration files in your case, you could simply use `copy()`:

```
copy('12hrconfig.php', 'config.php'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:32:40.850

I'm not sure why you think JSON is overkill. You really only need four PHP methods for this - 2 for reading/writing files, and 2 for encoding/decoding JSON. Heck, you don't even need to understand JSON to use it as described below, but it might be nice to be able to look at the configfilename and read it, so you could learn a bit of JSON as you go ;)

The basics are let's say you have an array with your config in it, e.g.:

```
$configArray['key'] = 'value'; 
```

To write this out in json:

```
file_put_contents('configfilename', json_encode($configArray)); 
```

To read the file:

```
$configArray = json_decode(file_get_contents('configfilename'), true); 
```

Note the second argument to [json_decode](http://php.net/manual/en/function.json-decode.php) has been explicitly set to true, so that $configArray will be an associative array. That's a personal preference; by default it'll be an object.

(This answer is based heavily on this question regarding [reading/writing JSON](https://stackoverflow.com/questions/8858848/php-read-and-write-json-from-file).)

# android - 从 ArrayList 中删除时出错

> ID：15537097
> 
> 赞同：0
> 
> 时间：2013-03-21T00:01:51.810
> 
> 标签：android, arrays, arraylist, runtime-error

当我在与其他东西碰撞后尝试从数组列表中删除一个项目时，我收到了这个错误。下面是我的 AsyncTask 和随之而来的 logcat 错误。有谁知道我哪里出错了？

这是我的异步任务：

```
public class handleCollisions extends AsyncTask<String, Integer, String>
    {
        @Override
        protected String doInBackground(String... arg0) {
            Enemy tempE;
            for(int i = 0; i < enemies.size(); i++)
            {
                tempE = enemies.get(i);
                playerR = new Rect((int)x, (int)y, (int)x + player.getWidth(),(int) y + player.getHeight());
                enemyR = new Rect(tempE.x, tempE.y, tempE.x + tempE.width, tempE.y + tempE.height);
                if(Rect.intersects(playerR, enemyR))
                {
                    collision = true;
                    int exX = (int)tempE.x + (int)tempE.width - explosionBig.getWidth();
                    int exY = (int)tempE.y + (int)tempE.height + (int)tempE.height/2 - explosionBig.getHeight();
                    Explosion tempEX = new Explosion(exX, exY);
                    explosions.add(tempEX);
                    int ex2X = (int)x + (int)player.getWidth() - explosionBig.getWidth();
                    int ex2Y = (int)y + (int)player.getHeight() + (int)player.getHeight()/2 - explosionBig.getHeight();
                    Explosion temp2EX = new Explosion(ex2X, ex2Y);
                    explosions.add(temp2EX);
                    enemies.remove(i);
                    x = -200;
                    y = 300;
                    lives--;
                }
                Bullet tempB;
                for(int b = 0; b < bullets.size(); b++)
                {
                    tempB = bullets.get(b);
                    playerBulletR = new Rect(tempB.x, tempB.y, tempB.x + playerBullet.getWidth(), tempB.y + playerBullet.getHeight());
                    if(Rect.intersects(playerBulletR, enemyR) && tempE.x <= SCREEN_WIDTH)
                    {
                        int exX = (int)tempE.x + (int)tempE.width - explosionBig.getWidth();
                        int exY = (int)tempE.y + (int)tempE.height + (int)tempE.height/2 - explosionBig.getHeight();
                        Explosion tempEX = new Explosion(exX, exY);
                        explosions.add(tempEX);
                        enemies.remove(i);
                        bullets.remove(b);
                        score++;
                    }
                }
            }
            for(int i = 0; i < enemyBullets.size(); i++)
            {
                EnemyBullet tempEB = enemyBullets.get(i);
                playerR = new Rect((int)x, (int)y, (int)x + player.getWidth(),(int) y + player.getHeight());
                Rect enemyBR = new Rect((int)tempEB.x, (int)tempEB.y, (int)tempEB.x + tempEB.width, (int)tempEB.y + tempEB.height);
                if(Rect.intersects(playerR, enemyBR))
                {
                    collision = true;
                    int ex2X = (int)x + (int)player.getWidth() - explosionBig.getWidth();
                    int ex2Y = (int)y + (int)player.getHeight() + (int)player.getHeight()/2 - explosionBig.getHeight();
                    Explosion temp2EX = new Explosion(ex2X, ex2Y);
                    explosions.add(temp2EX);
                    x = -200;
                    y = 300;
                    enemyBullets.remove(i);
                    lives--;
                }
                Bullet tempB;
                for(int b = 0; b < bullets.size(); b++)
                {
                    tempB = bullets.get(b);
                    playerBulletR = new Rect(tempB.x, tempB.y, tempB.x + playerBullet.getWidth(), tempB.y + playerBullet.getHeight());
                    if(Rect.intersects(playerBulletR, enemyBR))
                    {
                        enemyBullets.remove(i);
                        bullets.remove(b);
                    }
                }
            }
            if(lives <= 0)
            {
                for(int i = 0; i < enemies.size(); i++)
                    enemies.remove(i);
                for(int i = 0; i < enemyBullets.size(); i++)
                    enemyBullets.remove(i);
                for(int i = 0; i < bullets.size(); i++)
                    bullets.remove(i);
                for(int i = 0; i < explosions.size(); i++)
                    explosions.remove(i);
                for(int i = 0; i < clouds.size(); i++)
                    clouds.remove(i);
                v.isItOk = false;
                FileOutputStream fos;
                try
                {
                    String mode = "touch";
                    fos = openFileOutput("current_score", Context.MODE_PRIVATE);
                    fos.write(mode.getBytes());
                    fos.close();
                } 
                catch (FileNotFoundException e) 
                {
                    e.printStackTrace();
                } 
                catch (IOException e) 
                {
                    e.printStackTrace();
                }
                score = 0;
                finish();
            }
            return null;
        } 
```

**日志猫**

```
03-20 20:00:25.426: E/AndroidRuntime(4905): FATAL EXCEPTION: AsyncTask #3
03-20 20:00:25.426: E/AndroidRuntime(4905): java.lang.RuntimeException: An error occured while executing doInBackground()
03-20 20:00:25.426: E/AndroidRuntime(4905):     at android.os.AsyncTask$3.done(AsyncTask.java:299)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:273)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.concurrent.FutureTask.setException(FutureTask.java:124)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:307)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.concurrent.FutureTask.run(FutureTask.java:137)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at android.os.AsyncTask$SerialExecutor$1.run(AsyncTask.java:230)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1076)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:569)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.lang.Thread.run(Thread.java:856)
03-20 20:00:25.426: E/AndroidRuntime(4905): Caused by: java.lang.IndexOutOfBoundsException: Invalid index 1, size is 1
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.ArrayList.remove(ArrayList.java:399)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at com.jister13.plane.Main$handleCollisions.doInBackground(Main.java:462)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at com.jister13.plane.Main$handleCollisions.doInBackground(Main.java:1)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at android.os.AsyncTask$2.call(AsyncTask.java:287)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:305)
03-20 20:00:25.426: E/AndroidRuntime(4905):     ... 5 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:06:45.253

正如logcat所说

```
 Caused by: java.lang.IndexOutOfBoundsException: Invalid index 1, size is 1
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.ArrayList.throwIndexOutOfBoundsException(ArrayList.java:251)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at java.util.ArrayList.remove(ArrayList.java:399)
03-20 20:00:25.426: E/AndroidRuntime(4905):     at com.jister13.plane.Main$handleCollisions.doInBackground(Main.java:462) 
```

`Array`当大小仅为 1 时，您尝试访问索引 1（ 的第二项），这意味着唯一可用的索引为 0。它发生在 的第 462 行`Main.java`。至少发布以`AsyncTask`获得更多帮助，但您可以查看那里，看看为什么它试图访问已删除或不存在的内容

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:32:24.110

对于所有具有该方法的循环，`remove`将代码更改为以下示例

```
for(int i = 0; i < enemies.size(); i++) 
```

改成

```
for(int i = enemies.size() - 1; i > -1; i--) 
```

换句话说，从数组的末尾开始，当您尝试删除元素时向后退。

# haskell - HW：以特定方式展开列表

> ID：15537100
> 
> 赞同：3
> 
> 时间：2013-03-21T00:02:18.003
> 
> 标签：haskell, functional-programming, unfold

在 Haskell 编程中，Graham Hutton 为列表定义展开如下：

```
unfold :: (b -> Bool ) -> (b -> a) -> (b -> b) -> b -> [a]
unfold p h t x | p x = []
| otherwise = h x : unfold p h t (t x) 
```

定义一个函数

```
• listUnfold :: (b -> Bool) -> (b -> a) -> (b -> b) -> b -> [a] 
```

这与上面的类似，但在其实现中使用了展开器并且是非递归的。

我已经尝试了一段时间来解决上面的问题，但我仍然可以做到（在 Haskell 和一般的函数式编程中相当新）。

我的尝试：

```
listUnfold :: (b -> Bool) -> (b -> a) -> (b -> b) -> b -> [a]
listUnfold f h t x 
    | f x == True   = []
    | otherwise     = h x : 
        listUnfoldr (\x -> if f x then Nothing else Just ((h x), (t x))) x 
```

在英语中，如果`f x`为真，则返回空列表。否则，`h x`用作头部并将展开器的结果附加为尾部。Unfoldr 将一个列表作为头部和尾部`(x:xs)`进行递归。`x``xs`

p/s：我可能这样做非常非常错误。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T00:19:16.813

你几乎明白了！原始函数使用函数`p`（用于“谓词”）来确定我们是否已完成展开，`h`应用于每个元素，以及`t`（用于“转换”）将元素转换为列表其余部分的种子。

`unfoldr`需要一个函数，如果我们已经完成展开`f :: b -> Maybe (a,b)`，它会返回，或者，要添加到列表中的元素在哪里，并且是列表其余部分的种子。`Nothing``Just (x, y)``x``y`

所以`f`in`unfoldr`负责 ,`p`和`h`的所有三个功能`t`。`Nothing`-or - `Just`dichotomy 扮演布尔函数的一部分，元`p`组的第二个元素负责`t`为列表的其余部分提供种子。

这是我的解决方案（为清楚起见，我已从您的问题中重命名变量）：

```
listUnfold pred f trans seed =
    unfoldr (\x -> if pred x
                   then Nothing
                   else Just (f x, trans x)) seed 
```

当然，当一个值出现在定义的右侧时，就像`seed`这里一样，您可以利用 Haskell 的性感语法进行柯里化并将其完全丢弃：

```
listUnfold pred f trans = unfoldr (\x -> if pred x
                                         then Nothing
                                         else Just (f x, trans x)) 
```

形式上，这种转换称为[eta 缩减](http://www.haskell.org/haskellwiki/Eta_conversion)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T00:42:51.987

这是 的[定义`unfoldr`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/src/Data-List.html#unfoldr)：

```
unfoldr                 :: (b -> Maybe (a, b)) -> b -> [a]
unfoldr f b  =
  case f b of
   Just (a,new_b) -> a : unfoldr f new_b
   Nothing        -> [] 
```

这里是 Hutton 的`unfold`，稍微改写来`case`代替守卫：

```
unfold :: (b -> Bool ) -> (b -> a) -> (b -> b) -> b -> [a]
unfold p h t x =
  case p x of
    True  -> []
    False -> h x : unfold p h t (t x) 
```

一些观察：

*   通过比较类型，我们可以看到`unfoldr`并`unfold`共享相同的最终参数类型和相同的结果类型。
    *   `b`indefinition`unfoldr`和`x`indefinition`unfold`基本上是同一个变量。
    *   希望我们也可以匹配两个函数的定义，以使结果相同。
*   每个函数由一个`case`表达式组成，有两个分支。
*   在每个函数中，其中一个分支导致`[]`.
    *   所以什么时候`p x = True`，我们要`f x = Nothing`。
*   在每个函数中，另一个分支导致`{-something-} : {-recursive-call-}`.
    *   所以什么时候`p x = False`，我们要`f x = Just ({-something-}, {-something-else-})`。

至此应该清楚了`unfold p h t x = unfoldr f x where f = ...`，继续推理链，填写 的定义也不是什么难事`f`。

# javascript - Knockout.js 净化 html

> ID：15537104
> 
> 赞同：0
> 
> 时间：2013-03-21T00:02:42.787
> 
> 标签：javascript, knockout.js

我有一个使用模板呈现行的表。应用的模板取决于底层的行视图模型状态，可以是“编辑”或“视图”。所以我需要在每个特定情况下使用“编辑模板”或“视图模板”模板。
我希望视图模型不知道它的表示，所以我不使用一些*myViewModel.getTemplateName()*函数。此外，将来可能会有不止一个 2 模板。
所以我决定在 html 代码中控制模板，如下所示：

```
<table>
    <thead>..</thead>
    <tbody>
        <!-- ko foreach: dicts -->
        <!-- ko template: { name: function(){ return (state() == "view")? 'row-etpd-view-template' : 'row-etpd-edit-template' } } -->
        <!-- /ko -->
        <!-- /ko -->
    </tbody>
</table> 
```

显然，它呈现为：

```
<!-- ko template: { name: function(){ return (state() == "view")? 'row-etpd-view-template' : 'row-etpd-edit-template' } } -->
<tr>...</tr> 
```

对于**每一**行。我想避免太多额外的行以及其他内联 KO 使用的情况。有没有办法做到这一点？我想 KO 在视图模型和 DOM 元素之间有内存绑定，所以渲染后可能不需要这些注释......有想法吗？
谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:49:11.223

处理此问题的一个好方法是`foreach`使用[`template`](http://knockoutjs.com/documentation/template-binding.html).

```
<tbody>
    <!-- ko template: { foreach: dicts, name: function(item) { return (item.state() == "view")? 'row-etpd-view-template' : 'row-etpd-edit-template' } } -->
    <!-- /ko -->
</tbody> 
```

# c# - 打印 ref 变量

> ID：15537106
> 
> 赞同：-1
> 
> 时间：2013-03-21T00:02:47.430
> 
> 标签：c#, variables, reference

我的任务是打印数组中一组数字的平均值和方差，为此我需要引用我所做的 avg 。但我不明白我现在如何打印 avg 是什么。当我运行程序时，我目前正在打印 0。这是我的代码：

```
 static double varianceValue(ref double avg, params double[] intValues)
    {
        double sum = 0;
        double f = 0;
        double number = 0;
        double sv = 0;
        double variance= 0;

        foreach (int value in intValues)
        {
            sum += value;
        }

        for (int i = 0; i < intValues.Length; i++)
        {
            number = intValues[i];
            avg = sum / intValues.Length;
            f = number - avg;
            sv += Math.Pow(f, 2);

        }
        variance = sv / (intValues.Length - 1);
        return variance;

    }
    static void Main(string[] args)
    {
        double avg = 0;
        Console.WriteLine("The avg of the variables in the array are: {0}", varianceValue(ref avg));
        Console.WriteLine("\nThe variance of 11, 13, 17, 19, 23 is: {0}", varianceValue(ref avg, 11.0, 13.0, 17.0, 19.0, 23.0));
        Console.ReadKey();
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:07:44.913

此时您正在打印零，因为您调用时数组为空

```
 Console.WriteLine("The avg of the variables in the array are: {0}", varianceValue(ref avg)); 
```

首先调用带有数组参数的方差函数（这也将设置平均值）。然后自己调用 avg 。

```
static void Main(string[] args)
{
    double avg = 0;
    Console.WriteLine("\nThe variance of 11, 13, 17, 19, 23 is: {0}", varianceValue(ref avg, 11.0, 13.0, 17.0, 19.0, 23.0));
   Console.WriteLine("The avg of the variables in the array are: {0}", avg);
    Console.ReadKey();
} 
```

# development-environment - 无需安装或维护服务器即可编程

> ID：15537107
> 
> 赞同：0
> 
> 时间：2013-03-21T00:02:54.230
> 
> 标签：development-environment

**== 问题 ==**

Mukesh 是一位称职的 PHP 和 ASP 程序员类型，主要从事 Web 开发。他希望扩展到基于不同编程语言的项目。

问题是，Mukesh 上的系统管理员确实坚持不允许设置或安装*任何东西*，除了本地机器上的绝对最低限度。此外，Mukesh 被基于 Windows 的机器所困。

Mukesh 将有一个 ssh 终端和一个文本编辑器，也许还有一个本地安装的 Git。就是这样。

**== 基本原理 ==**

Mukesh 想了解在一堆不同的环境中全栈开发是什么样的，但他无法安装程序并且预算有限。

Mukesh 只是想集思广益，他可以在许多不同的环境中获得全栈编程经验，同时仍然只有文本编辑器和 SSH 访问权限。

**== 问题 ==**

有多少产品、服务或策略可以让 Mukesh 在一堆不同的环境中进行常规开发，在这些环境中，他相当锁定他可以在自己的机器上安装什么，并且没有很多替代方案（例如， Mukesh 没有电脑）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:08:04.307

看看您是否可以获得安装 VM 产品的权限。它将允许您在与主机操作系统分开的虚拟机中运行多个操作系统。例如，VirtualBox（免费）（[https://www.virtualbox.org](https://www.virtualbox.org)）将允许您托管任意数量的 Linux、UNIX、Windows、DOS，甚至还有大量实验性操作系统。

运行它们的唯一真正限制是您拥有的内存量、CPU 马力和保存 VM 映像的磁盘空间。在具有大量 RAM 和多个 CPU 和/或内核的现代系统上，您甚至可以同时运行多个不同的 VM。

您还应该知道，大多数时候图形硬件加速不存在，因此您可以在 VM 中运行视频游戏、CAD 或其他图形密集型软件，但它通常性能不佳。对于几乎任何其他目的（如编程、测试编译器等），它都非常有用。

如果不允许您在系统本身上放置任何东西，您可能会将所有内容托管在外部驱动器甚至 USB 密钥上。

另一种选择是使用托管服务提供商，该服务提供商允许对您在本地没有的目标平台进行 shell 访问。我见过的大多数都需要少量的钱，但也可能有免费的供应商。

# javascript - 拖放 Html 5 文件上传 - 防止加载

> ID：15537112
> 
> 赞同：3
> 
> 时间：2013-03-21T00:03:23.767
> 
> 标签：javascript, html, drag-and-drop

到目前为止我有这个代码。我可以看到`dragenter`和`dragleave`事件，但是当我删除文件时，浏览器（Chrome 或 Firefox）即使`preventDefault()`被调用也只会打开文件（图片）。任何人都看到任何错误？我应该改变什么？

```
 <script type="text/javascript">
    $(function () {
        var $box = $("#ulbox");
        $box.bind("dragenter", dragEnter);

        $box.bind("dragleave", dragLeave);
        $box.bind("drop", drop);

        function dragEnter(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            console.log("dragEnter...");
            $(evt.target).addClass('over');
            return false;
        }
        function dragLeave(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            console.log("drag leave...");
            $(evt.target).removeClass('over');
            return false;
        }

        function drop(evt) {
            evt.stopPropagation();
            evt.preventDefault();
            $(evt.target).removeClass('over');

            var files = evt.originalEvent.dataTransfer.files;

            if (files.length > 0) {
                alert("dropped");
                if (window.FormData !== undefined) {
                    var data = new FormData();
                    for (i = 0; i < files.length; i++) {
                        data.append("file" + i, files[i]);
                    }

                    $.ajax({
                        type: "POST",
                        url: "/api/upload",
                        contentType: false,
                        processData: false,
                        data: data,
                        success: function (res) {
                        }
                    });
                } else {
                    alert("browser sucks!");
                }
            }
            return false;
        }
         });
    </script>
 }

 <div id="ulbox" style="border: 5px dashed black; width: 300px; height: 100px;">
 </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:58:47.987

删除 $box.bind("dragleave", dragLeave);

添加这个： $box.bind("dragover", dragLeave);

它很有魅力。

# python - 使用字符串作为参数时出错

> ID：15537114
> 
> 赞同：2
> 
> 时间：2013-03-21T00:03:31.837
> 
> 标签：python, string, arguments

我有一个浮动列表`[234, 533, 734, 964, 623, 744, 244, 353, 264]`。然后，我将其格式化为类似`"(234, 533, 734), (964, 623, 744), (244, 353, 264)"`.

这是我将其传递给的函数的格式示例：

```
cmds.curve( p=[(0, 0, 0), (3, 5, 6), (5, 6, 7), (9, 9, 9)] ) 
```

这是我使用的返回错误的内容：

```
cmds.curve( p = [ pStr ] ) 
```

这是错误：

> 第 142 行：标志“p”的参数无效。预期（距离，距离，距离），得到[str，str]#

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:25:02.920

试试这个，看看它是否适合你。我有一种感觉，您正在不必要地转换为字符串。

```
floats = [234, 533, 734, 964, 623, 744, 244, 353, 264]
groups = [tuple(floats[i:i+3]) for i in range(0, len(floats), 3] 
cmds.curve(p=groups) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:26:37.133

尝试使用[zip](https://stackoverflow.com/a/10364399/322909)，单击[此处](http://docs.python.org/2/library/functions.html#zip)查看 python 文档。

```
>>> my_list = [234, 533, 734, 964, 623, 744, 244, 353, 264]
>>> zip(*[iter(my_list)]*3)
[(234, 533, 734), (964, 623, 744), (244, 353, 264)] 
```

# batch-file - EQU这个时候出乎意料？

> ID：15537122
> 
> 赞同：1
> 
> 时间：2013-03-21T00:04:16.813
> 
> 标签：batch-file

[http://pastebin.com/qDZ0Eckq](http://pastebin.com/qDZ0Eckq)

嗨，当我尝试运行我的批处理代码时，它说此时 EQU 是不合格的..？我试过 %input% == 并且在某种程度上说同样的信息。顺便说一下，当我启动程序时，它会自动将其带到底部的最后一部分。我把它移到那里试图看看这是否能解决我的问题（它曾经在顶部）。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:30:23.337

由于您没有发布任何关于您收到错误的 140 多行代码行的任何线索，因此我们只能猜测。

此错误的正常原因是，从您在（大概）有问题的行的**PART**`%input% ==`的帖子中，原因很简单。该变量`input`没有值，因此该行变为

```
IF EQU [well, I don't know the rest since you haven't indicated what it might be] 
```

治愈（1）如果没有定义输入转到某个地方如果％输入％等...

治愈 (2) 如果 "%input%" equ "whatever" ...

治愈 (3) 如果 X%input% equ Xwhatever ...

（其中 X 几乎可以是任何字符，或者可以作为后缀而不是前缀附加）

目的是确保比较的两边都是非空的

...顺便提一句，

```
if ERRORLEVEL == 1 goto AdminChat 
```

也不会工作。`ERRORLEVEL`是一个字符串 - 它永远不会等于`1`

```
if %ERRORLEVEL% == 1 goto AdminChat 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:25:08.447

这不起作用：

```
set /p adminpassword=Password:
if errorlevel equ thebulldogtheo goto AdminChatRoom 
```

将其更改为：

```
set /p "adminpassword=Password: "
if "%adminpassword%" equ "thebulldogtheo" goto :AdminChatRoom 
```

顺便说一句：您从`choice`命令中获得错误级别，而不是从`set /p`.

# php - 替换无效的 UTF-8，而不是替换

> ID：15537123
> 
> 赞同：0
> 
> 时间：2013-03-21T00:04:17.280
> 
> 标签：php, regex, unicode, encoding, character-encoding

晚上，

我有要清理的 HTML 文件。这些有一些无效的 Unicode 字符出现在我的文本编辑器中，例如：

/B7

我想用它们应该是的字符或我选择的替换字符替换它们。例如，/B7 字符是中点，但我想用句号替换它。

这里的功能：[PHP - 从 utf8 字符串中去除浏览器中不可显示的所有字符的快速方法](https://stackoverflow.com/questions/7634941/php-fast-way-to-strip-all-characters-not-displayable-in-browser-from-utf8-stri)

删除无效字符，但我对编码没有足够的把握，无法对它做更多的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T14:59:31.680

您的文件很可能在 Windows-1252 中编码（其中`0xB7`解码为`·`），并且 gEdit 将其解码为 UTF-8 并`0xB7`直接显示无效的 UTF-8 字节（在特定序列之外时在 UTF-8 中无效）作为它们的值 I猜测。您可以通过多种方式修复文件，但在 PHP 中您可以：

```
<?php
$file_contents = file_get_contents("brokenfile.txt");
$file_contents = mb_convert_encoding($file_contents, "UTF-8", "Windows-1252");
file_put_contents("brokenfile.txt", $file_contents); 
```

上面的脚本会将文件解码为 Windows-1252 并将其编码为 UTF-8。

文本编辑器允许您通常在“另存为”对话框或某些配置中指定保存文件的编码。在使用它之前，您应该始终配置您的编辑器编码。

如果您`Â·`在此转换后在您的网站上看到，这意味着您告诉浏览器您的内容是 Windows-1252 或 ISO-8859-1 等。您必须告诉浏览器您的内容是 UTF-8：

```
header("Content-Type: text/html; charset=utf-8"); 
```

# android - Android 上用于方位角/偏航和滚动的方向传感器值不一致

> ID：15537125
> 
> 赞同：5
> 
> 时间：2013-03-21T00:04:48.340
> 
> 标签：android, orientation, android-sensors, sensormanager

我无法获得良好的方向传感器读数。传感器读数似乎不可靠，因此我针对两个免费的传感器测试应用程序（[Sensor Tester (Dicotomica)](https://play.google.com/store/apps/details?id=com.dicotomica.sensortester&hl=en)和[Sensor Monitoring (R's Software)](https://play.google.com/store/apps/details?id=jp.holy.rssoftware.app.sensor)）测试了我的代码。我发现虽然我的读数通常与传感器测试应用程序一致，但有时方位角/偏航角和滚动的值相差高达 40 度，尽管俯仰读数大多一致。这两个免费应用程序似乎总是相互一致。

我将我的代码放入一个很小的 ​​Android 活动中并得到了同样的不一致。代码如下：

```
public class MainActivity extends Activity implements  SensorEventListener {

    private SensorManager mSensorManager;
    private float[] AccelerometerValues;
    private float[] MagneticFieldValues;
    private float[] RotationMatrix;
    private long nextRefreshTime;           // used to ensure dump to LogCat occurs no more than 4 times a second
    private DecimalFormat df;               // used for dumping sensors to LogCat

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mSensorManager = (SensorManager)getSystemService(android.content.Context.SENSOR_SERVICE);
        Sensor SensorAccelerometer = mSensorManager.getDefaultSensor(Sensor.TYPE_ACCELEROMETER);
        mSensorManager.registerListener(this, SensorAccelerometer, SensorManager.SENSOR_DELAY_UI);  
        Sensor SensorMagField = mSensorManager.getDefaultSensor(Sensor.TYPE_MAGNETIC_FIELD);
        mSensorManager.registerListener(this, SensorMagField, SensorManager.SENSOR_DELAY_UI);
        AccelerometerValues = new float[3];
        MagneticFieldValues = new float[3];
        RotationMatrix = new float[9];
        nextRefreshTime = 0;
        df = new DecimalFormat("#.00");
    }

    @Override
    public void onSensorChanged(SensorEvent event) {

        if (event.sensor.getType() == Sensor.TYPE_ACCELEROMETER)
            System.arraycopy(event.values, 0, AccelerometerValues, 0, AccelerometerValues.length);
        else if (event.sensor.getType() == Sensor.TYPE_MAGNETIC_FIELD)
                System.arraycopy(event.values, 0, MagneticFieldValues, 0, MagneticFieldValues.length);

        if (AccelerometerValues != null && MagneticFieldValues != null) {
            if(SensorManager.getRotationMatrix(RotationMatrix, null, AccelerometerValues, MagneticFieldValues)) {
                float[] OrientationValues = new float[3];
                SensorManager.getOrientation(RotationMatrix, OrientationValues);

                // chance conventions to match sample apps
                if (OrientationValues[0] < 0) OrientationValues[0] += 2*(float)Math.PI;
                OrientationValues[2] *= -1;

                // dump to logcat 4 times a second
                long currentTimeMillis = System.currentTimeMillis();
                if (currentTimeMillis > nextRefreshTime) {
                    nextRefreshTime = currentTimeMillis+250;
                    Log.i("Sensors",    // arrange output so that numbers line up in columns :-)
                            "(" + AngleToStr(OrientationValues[0]) + "," + AngleToStr(OrientationValues[1]) + "," + AngleToStr(OrientationValues[2])
                            + ") ("+FloatToStr(AccelerometerValues[0]) + "," + FloatToStr(AccelerometerValues[1]) + "," + FloatToStr(AccelerometerValues[2])
                            + ") ("+FloatToStr(MagneticFieldValues[0]) + "," + FloatToStr(MagneticFieldValues[1]) + "," + FloatToStr(MagneticFieldValues[2])+")");
                }               
            }
        }               
    }

    private String AngleToStr(double AngleInRadians) {
        String Str = "   "+Integer.toString((int)Math.toDegrees(AngleInRadians));
        return Str.substring(Str.length() - 3);
    }
    private String FloatToStr(float flt) {
        String Str = "      "+df.format(flt);
        return Str.substring(Str.length() - 6);
    }   

    @Override
    protected void onDestroy() {
        super.onDestroy();
        mSensorManager.unregisterListener(this);
    }

    @Override
    public void onAccuracyChanged(Sensor arg0, int arg1) { }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

我正在使用运行 Jelly Bean 4.1.1 的 Galaxy Note 2。谁能告诉我我做错了什么？

2013 年 3 月 24 日更新：更多信息。(1) 我在清单中禁用了纵向和横向之间的切换，因此 getWindowManager().getDefaultDisplay().getRotation() 始终为零。因此，我认为 remapCoordSystem 在这里没有帮助，因为那是用于切换轴，而我看到的错误并不是大错误，它们更加微妙。（2）我检查了精度灵敏度，当两个传感器都声称具有高精度时，就会出现不一致的情况。

作为我看到的不一致的示例，当上面的代码给我 (azimuth,pitch,roll) = (235,-52,-11) 时，这两个免费应用程序显示相似的值。但是当我看到 (278, -58, -52) 应用程序显示 (256, -58, -26) 时，方位角和滚动的差异如此之大，尽管俯仰似乎还可以。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-07T11:36:50.340

我认为当设备不平坦时定义方向角的最佳方法是使用更合适的角坐标系，该坐标系是您从中获得的标准欧拉角`SensorManager.getOrientation(...)`。我建议我[在 math.stackexchange.com 上](https://math.stackexchange.com/questions/381649/whats-the-best-3d-angular-co-ordinate-system-for-working-with-smartfone-apps/382048#382048)描述的那个。我还在[此处的答案](https://stackoverflow.com/questions/16317599/android-compass-that-can-compensate-for-tilt-and-pitch/16386066#16386066)中放了一些实现它的代码。除了方位角的良好定义外，它还对俯仰角有更好的定义，该方法将其定义为水平面外的旋转，而不管旋转发生在哪个轴上。

您可以从我在第一段中给出的两个链接中获得完整的详细信息。但是，总而言之，来自 SensorManager.getRotationMatrix(...)的旋转矩阵**R是**

![旋转矩阵R的定义](../Images/7287d4ac420861a25f0ef6f643c6a80c.png)

其中 (E [x] , E [y] , E [z] ), (N [x] , N [y] , N [z] ) 和 (G [x] , G [y] , G [z] ) 是指向正东、正北和重力方向的向量。然后你想要的方位角由下式给出

![方位角phi的定义](../Images/bdeab8d7551640a512ff1b16ee926f0c.png)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T00:20:04.923

这完全取决于设备的**方向**。如果设备不是**平**的并且有一些**旋转**，即不是完全**纵向**或**横向**，那么**方位角**是错误的。在这种情况下，您必须先打电话`remapCoordSystem`再打电话。`getOrientation`您还应该至少过滤**加速度计**值。[有关更多详细信息，请参阅我在将磁场 X、Y、Z 值从设备转换为全局参考框架](https://stackoverflow.com/questions/15315129/convert-magnetic-field-x-y-z-values-from-device-into-global-reference-frame/15317814#15317814)
中的 回答 有关平坦度的含义，请参阅[如何使用 Android 中的加速度计测量手机在 XY 平面中的倾斜度](https://stackoverflow.com/questions/11175599/how-to-measure-the-tilt-of-the-phone-in-xy-plane-using-accelerometer-in-android/15149421#15149421)

您应该按如下方式测试您的应用程序：

1.  将您的设备平放并启动您的应用程序并将您的价值与其他应用程序进行比较。给每个读数大约 30 秒，并且在此步骤中不要移动设备。
    我对这一步的猜测：您的值应该与其他应用程序的值相差不大，但一开始它可能不如其他应用程序稳定。

2.  在您的应用程序运行时，将您的设备旋转到一个新位置，等待该值稳定（不必是相同的值，但变化大约为 1 或 2 度）。在同一位置将您的价值与其他应用程序的价值进行比较。重复相同的操作，但在旋转时运行其他应用程序。
    我对这一步的猜测：您的稳定值应该与其他应用程序的值相差不大，但您的值需要更长的时间才能变得稳定。此外，当停在新位置时，您的应用程序的前几个值和稳定值之间的差异比另一个更大。

3.  现在将以下代码放在注释之前 //dump 到 logcat 并像为方向那样记录它
    float rotation = (float) Math.atan2(RotationMatrix[6], RotationMatrix[7]);
    将您的设备直立放置在盒子中，使其无法旋转。确保上面给出的旋转值尽可能接近 0（它会跳跃一点）。
    现在重复步骤 1 和 2，设备直立。
    我的猜测是，您的结果将与我对上述步骤 1 和 2 的猜测相同。

4.  将您的设备倾斜直立放置在盒子中，使其无法进一步旋转。确保上面给出的旋转值尽可能接近 25 或 -25（它会跳跃一点）。
    现在重复步骤 1，将设备倾斜直立。
    我的猜测是您的结果将与其他应用程序完全不同。
    您可以使用不同的旋转值重复步骤 4。

如果我的猜测是正确的回来，我会给你解释。同时，您可以在[磁场、旋转矩阵和全局坐标中阅读我的答案](https://stackoverflow.com/questions/15547691/magnetic-fields-rotation-matrix-and-global-coordinates/15556771#15556771)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-26T00:12:38.177

我可以回答这个难题的一部分。当设备平放在桌子上时一切都很好，但是当它直立并且俯仰为正负 90 度时，您会遇到[云台锁定](http://en.wikipedia.org/wiki/Gimbal_lock)。发生这种情况时，方位角和滚动是未定义的。在这种情况下，方位角和滚动意味着同一件事，如果您查看数学，您会发现定义了方位角+滚动（当俯仰 = +90 度时）或方位角滚动（当俯仰 = -90 度时） )，但他们两个不是自己定义的。在您给出的示例中，请注意您的应用程序和其他应用程序之间的方位角+滚动总和大致相同。

此外，您可以使用 android Sensor.TYPE_GRAVITY，这样您就不需要在加速度计读数上使用低通滤波器。Sensor.TYPE_GRAVITY 是一个传感器，它是从其他传感器计算出来的，以尝试消除加速度计传感器的加速度影响。但是，如果您希望您的应用在引入 Sensor.TYPE_GRAVITY 之前在旧版本的 Android 上运行，那么您需要自己完成这项工作。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-21T01:37:13.283

@Stochastically 说对于 getOrientation()，使用：

```
azimuth = atan2((Ey-Nx), (Ex-Ny)) 
```

但是，如果你看 Android 的实现，它实际上是

```
azimuth = atan2(Ey, Ny) 
```

这也将为您提供 -180 和 180 范围内的值。

下面是 SensorManager.class 中给出的源代码

```
public static float[] getOrientation(float[] R, float values[]) {
    /*
     * 4x4 (length=16) case:
     *   /  R[ 0]   R[ 1]   R[ 2]   0  \
     *   |  R[ 4]   R[ 5]   R[ 6]   0  |
     *   |  R[ 8]   R[ 9]   R[10]   0  |
     *   \      0       0       0   1  /
     *
     * 3x3 (length=9) case:
     *   /  R[ 0]   R[ 1]   R[ 2]  \
     *   |  R[ 3]   R[ 4]   R[ 5]  |
     *   \  R[ 6]   R[ 7]   R[ 8]  /
     *
     */
    if (R.length == 9) {
        values[0] = (float)Math.atan2(R[1], R[4]);
        values[1] = (float)Math.asin(-R[7]);
        values[2] = (float)Math.atan2(-R[6], R[8]);
    } else {
        values[0] = (float)Math.atan2(R[1], R[5]);
        values[1] = (float)Math.asin(-R[9]);
        values[2] = (float)Math.atan2(-R[8], R[10]);
    }
    return values;
} 
```

# c++ - 编译Template类时出现上百个错误（第一个Template类）

> ID：15537126
> 
> 赞同：0
> 
> 时间：2013-03-21T00:04:51.180
> 
> 标签：c++, templates, compiler-errors, set

**原谅冗长的代码包含，但我通常在发布有关问题时遇到问题，包括正确的内容。**

我花了大约 2 个小时阅读模板类和故障排除，但我显然错过了一些非常重要的东西。

我一直在研究 Set 数据结构以提高我的编码效率（我在旅行中发布了各种问题），我最近完成了它。我现在已经开始（显然很繁重）将它变成一个模板类！*然而*，我在编译它时遇到了数百行错误。

我有一种感觉，所有这些都源于我反复犯的一个错误，所以我只包括了大约 1/5 的错误。我花了大约 2 个小时阅读模板类和故障排除，但我显然错过了一些非常重要的东西。

再次，我为包含我的整个文件而道歉。

谢谢！

myset.h：

```
// a string set implemented with doubly and head sentinal linked list

#ifndef SET_H
#define SET_H
#include <iostream>
#include <string>

using namespace std;

template< class T >
class Set{
private:
    struct Elem {
        T info;
        Elem *prev, *next;
    };
    Elem *_head, *_tail;
    int _size;

    void copyCode(const Set & v);
    // common code for copy constructor and assignment
    void destructCode();
    // common code for deallocation
    ostream& dump(ostream& out, const Set &v);
    // output set elements

public:
    Set();
    // constructs empty set

    Set(const Set &rhs);
    // copy constructor

    ~Set();
    // destructor

    Set& operator=(const Set &rhs);
    // assignment operator

    bool insert( T );
    // insert an int into the set; return true if successful

    bool erase( T );
    // remove an int from the set; return true if successful

    void clear();
    // remove all elements from set

    int size() const { return _size; }
    // return size of the set

    bool find( T ) const;
    // return true if an element is found; false otherwise

    class Iterator{
    private:
    Elem * _cur;

    public:
        Iterator(){}
        explicit Iterator( Elem* );

    Iterator operator++( int );
    Iterator operator++();
    Iterator operator--( int);
    Iterator operator--();

    bool operator==( const Iterator& rhs );
    bool operator!=( const Iterator& rhs );

    T& operator*();

    };

    Iterator begin() const; 
    Iterator end() const;

    friend ostream& operator<< <>(ostream&, Set<T>&);

};

template< class Y >
bool operator==(const Set<T>&, const Set<T>&);

template< class Y >
bool operator!=(const Set<T>&, const Set<T>&);

template< class Y >
Set operator&(const Set<T>&, const Set<T>&);

template< class Y >
Set operator|(const Set<T>&, const Set<T>&);

#include "myset.cpp"
#endif 
```

myset.cpp：

```
#include <iostream>
#include <string>
#include "myset.h"

using namespace std;

// common code for copy constructor and assignment
void Set<T>::copyCode(const Set<T> & v){

    Elem * p1 = 0;//current
    Elem * p2 = 0;//next
    Elem * p3 = 0;

    if( v._head == 0 )
        _head = _tail = 0;

    else
    {
        _head = new Elem;
        _head -> info = v._head -> info;
    _head -> prev = 0;

        p1 = p2 = _head;
        p3 = v._head -> next;
    }

    while( p3 != v._tail )
    {
        p1 -> next = new Elem;
        p1 = p1 -> next;
        p1 -> info = p3 -> info;
    p1 -> prev = p2;

    p2 = p1;
        p3 = p3 -> next;
    }

    _tail = new Elem;
    _tail -> info = v._tail -> info;
    _tail -> next = 0;
    _tail -> prev = p1;

    p1 -> next = _tail;

    _size = v._size;
}

// common code for deallocation
void Set<T>::destructCode(){

    Elem * p1 = _head;
    Elem * p2 = _head -> next;

    while( p2 ){

    delete p1;
    p1 = p2;
    p2 = p2 -> next;

    }

    delete p1;

    _head = _tail = 0;
    _size = 0;
}

// output set elements
template< class T >
ostream& Set<T>::dump(ostream& out, const Set<T> &v){

    Elem * temp;
    temp = v._head -> next;

    while( temp != v._tail){

    out << temp -> info << " ";
    temp = temp -> next;

    }

    return out;
}

template< class T >
Set<T>::Set(){

    _head = new Elem;
    _tail = new Elem;

    _head -> info = "";
    _head -> next = _tail;
    _head -> prev = 0;

    _tail -> info = "";
    _tail -> next = 0;
    _tail -> prev = _head;

    _size = 0;
}

//Copy Constructor
template< class T >
Set<T>::Set(const Set<T> &rhs){

    copyCode( rhs );
}

//Destructor
template< class T >
Set<T>::~Set(){

    destructCode();
}

//Assignment Operator
template< class T >
Set<T>& Set<T>::operator=(const Set<T> &rhs){

    //Avoid self assignment
    if( this != &rhs ){

    destructCode();
    copyCode( rhs );

    }
    return *this;
}

// insert an int into the set; return true if successful
template< class T >
bool Set<T>::insert( T val ){

    if( !find ( val ) ){
        Elem * temp = new Elem;
        temp -> info = val;

        temp -> prev = _head;
        temp -> next = _head -> next;

        _head -> next -> prev = temp;
    _head -> next = temp;
        _size++;

    return true;
    }

    return false;
}

// remove an int from the set; return true if successful
template< class T >
bool Set<T>::erase( T val ){

    Elem * temp = _head -> next;

    while ( temp && temp != _tail ){

        //Empty Set
        if( temp == _tail )
        return false;

        if( temp -> info == val ){

        temp -> prev -> next = temp -> next;
        temp -> next -> prev = temp -> prev;

        delete temp;
        _size--;
        return true;
        }

        temp = temp -> next;
    }

    return false;
}

// remove all elements from set
template< class T >
void Set<T>::clear(){

    Elem * p1 = _head -> next;
    Elem * p2 = p1 -> next;;

    while( p2 ){

        delete p1;
        p1 = p2;
        p2 = p2 -> next;

    }

    _head -> next = _tail;
    _head -> prev = 0;

    _tail -> next = 0;
    _tail -> prev = _head;

    _size = 0;
}

// return true if an element is found; false otherwise
template< class T >
bool Set<T>::find( T val ) const{

    Elem * temp = _head;

    while( temp ){

    if( temp -> info == val )
        return true;

    else
        temp = temp -> next;
    }

    return false;
}

template< class T >
ostream& operator<< (ostream& out , Set<T>& s ){

    s.dump( out , s );
    return out;
}

//Iterator class
///////////////

//Pass head sentinel of Set.
template< class T >
Set<T>::Iterator::Iterator( Elem * e ){

    _cur = e;

}

//Member prefix
template< class T >
Set<T>::Iterator Set<T>::Iterator::operator++(){

    return Iterator(_cur = _cur -> next);
}

//Member postfix
template< class T >
Set<T>::Iterator Set<T>::Iterator::operator++( int ){

    Elem * temp = _cur;
    _cur = _cur -> next;

    return Iterator(temp);
}

//Member prefix
template< class T >
Set<T>::Iterator Set<T>::Iterator::operator--(){

    return Iterator(_cur = _cur -> prev);
}

//Member postfix 
template< class T >
Set<T>::Iterator Set<T>::Iterator::operator--( int ){

    Elem * temp = _cur;
    _cur = _cur -> prev;

    return Iterator( temp );
}

template< class T > 
T& Set<T>::Iterator::operator*(){

    return _cur -> info;
}

template< class T >
Set<T>::Iterator Set<T>::begin() const{

    return Iterator( _head -> next );
}

template< class T > 
Set<T>::Iterator Set<T>::end() const{

    return Iterator( _tail );
}

template< class T >
bool Set<T>::Iterator::operator==( const Set<T>::Iterator& rhs ){

    return this -> _cur->info == rhs._cur->info;
}

template< class T >
bool Set<T>::Iterator::operator!=( const Set<T>::Iterator& rhs ){

    return this -> _cur->info != rhs._cur->info;
}

template< class T >
bool operator==(const Set<T>& s1 , const Set<T>& s2 ){

    Set<T>::Iterator lit = s1.begin();
    Set<T>::Iterator lit = s2.begin();

    while( lit != lSet.begin() ){

    if( s2.find( *lit )
        lit++;
    else
        return false;
    }

    while( rit != rSet.begin() ){

        if( s1.find( *rit )  
            rit++;
        else
            return false;
    }

    return true;
}

template< class T >
bool operator!=(const Set<T>& s1 , const Set<T>& s2 ){

    Set<T>::Iterator lit = s1.begin();
    Set<T>::Iterator lit = s2.begin();

    while( lit != lSet.begin() ){

        if( s2.find( *lit )  
            lit++;
        else
            return true;
    }

    while( rit != rSet.begin() ){

        if( s1.find( *rit )
            rit++;
        else
            return true;
    }

    return false;

}

//Intersection
template< class T >
Set<T> operator&(const Set<T>& lSet , const Set<T>& rSet ){

    Set<T>::Iterator lit = lSet.begin();
    Set<T> temp;    

    while( lit != lSet.end() ){

    if( rSet.find( *lit ) )
        temp.insert( *lit );

    lit++;
    }
    return temp;
}

//Union
template< class T >
Set<T> operator|(const Set<T>& lSet, const Set<T>& rSet ){

    Set<T>::Iterator lit = lSet.begin();
    Set<T>::Iterator rit = rSet.begin();

    Set<T> temp;

    while( lit != lSet.end() ){
    temp.insert( *lit );
    lit++;
    }

    while( rit != rSet.end() ){
        temp.insert( *rit );
    rit++;
    }

    return temp;
} 
```

错误（在 g++ -g myset.cpp 之后）：

```
bash-4.2$ g++ -g myset.cpp mysettest.cpp 
In file included from myset.cpp:3:0:
myset.h:84:27: error: ‘T’ was not declared in this scope
myset.h:84:28: error: template argument 1 is invalid
myset.h:84:42: error: ‘T’ was not declared in this scope
myset.h:84:43: error: template argument 1 is invalid
myset.h:84:45: error: ‘bool operator==(const int&, const int&)’ must have an argument of class or enumerated type
myset.h:87:27: error: ‘T’ was not declared in this scope
myset.h:87:28: error: template argument 1 is invalid
myset.h:87:42: error: ‘T’ was not declared in this scope
myset.h:87:43: error: template argument 1 is invalid
myset.h:87:45: error: ‘bool operator!=(const int&, const int&)’ must have an argument of class or enumerated type
myset.h:90:1: error: invalid use of template-name ‘Set’ without an argument list
myset.h:93:1: error: invalid use of template-name ‘Set’ without an argument list
In file included from myset.h:95:0,
                 from myset.cpp:3:
myset.cpp:9:10: error: ‘T’ was not declared in this scope
myset.cpp:9:11: error: template argument 1 is invalid
myset.cpp:9:33: error: ‘T’ was not declared in this scope
myset.cpp:9:34: error: template argument 1 is invalid
myset.cpp: In function ‘void copyCode(const int&)’:
myset.cpp:11:5: error: ‘Elem’ was not declared in this scope
myset.cpp:11:12: error: ‘p1’ was not declared in this scope
myset.cpp:12:12: error: ‘p2’ was not declared in this scope
myset.cpp:13:12: error: ‘p3’ was not declared in this scope
myset.cpp:15:11: error: request for member ‘_head’ in ‘v’, which is of non-class type ‘const int’
myset.cpp:16:9: error: ‘_head’ was not declared in this scope
myset.cpp:16:17: error: ‘_tail’ was not declared in this scope
myset.cpp:20:9: error: ‘_head’ was not declared in this scope
myset.cpp:20:21: error: expected type-specifier before ‘Elem’
myset.cpp:20:21: error: expected ‘;’ before ‘Elem’
myset.cpp:21:27: error: request for member ‘_head’ in ‘v’, which is of non-class type ‘const int’
myset.cpp:25:16: error: request for member ‘_head’ in ‘v’, which is of non-class type ‘const int’
myset.cpp:28:20: error: request for member ‘_tail’ in ‘v’, which is of non-class type ‘const int’
myset.cpp:30:26: error: expected type-specifier before ‘Elem’
myset.cpp:30:26: error: expected ‘;’ before ‘Elem’
myset.cpp:39:5: error: ‘_tail’ was not declared in this scope
myset.cpp:39:17: error: expected type-specifier before ‘Elem’
myset.cpp:39:17: error: expected ‘;’ before ‘Elem’
myset.cpp:40:23: error: request for member ‘_tail’ in ‘v’, which is of non-class type ‘const int’
myset.cpp:46:5: error: ‘_size’ was not declared in this scope
myset.cpp:46:15: error: request for member ‘_size’ in ‘v’, which is of non-class type ‘const int’
myset.cpp: At global scope:
myset.cpp:51:10: error: ‘T’ was not declared in this scope
myset.cpp:51:11: error: template argument 1 is invalid
myset.cpp: In function ‘void destructCode()’:
myset.cpp:53:5: error: ‘Elem’ was not declared in this scope
myset.cpp:53:12: error: ‘p1’ was not declared in this scope
myset.cpp:53:17: error: ‘_head’ was not declared in this scope
myset.cpp:54:12: error: ‘p2’ was not declared in this scope
myset.cpp:58:9: error: type ‘&lt;type error>’ argument given to ‘delete’, expected pointer
myset.cpp:64:12: error: type ‘&lt;type error>’ argument given to ‘delete’, expected pointer
myset.cpp:66:13: error: ‘_tail’ was not declared in this scope
myset.cpp:67:5: error: ‘_size’ was not declared in this scope
myset.cpp: At global scope:
myset.cpp:256:1: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope
myset.cpp:264:1: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope
myset.cpp:275:1: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope
myset.cpp:283:1: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope
myset.cpp:299:1: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope
myset.cpp:306:1: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope
myset.cpp: In function ‘bool operator==(const Set<T>&, const Set<T>&)’:
myset.cpp:329:5: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope
myset.cpp:329:22: error: expected ‘;’ before ‘lit’
myset.cpp:330:5: error: need ‘typename’ before ‘Set<T>::Iterator’ because ‘Set<T>’ is a dependent scope 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T00:07:11.507

类模板的成员函数定义应该这样定义：

```
 template<typename T> // <== MIND THIS!
    void Set<T>::copyCode(const Set<T> & v) {
        // ...
    } 
```

你忘记了这个`template<typename T>`部分。此外，[您不能将类模板的成员函数定义委托给单独的`.cpp`文件](https://stackoverflow.com/questions/495021/why-can-templates-only-be-implemented-in-the-header-file)。除非您提供显式实例化，否则链接器最终会抱怨未解析的引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:32:03.093

第一条错误消息在`myset.h`; 我没有计算行数，但它可能在这里：

```
template< class Y >
bool operator==(const Set<T>&, const Set<T>&); 
```

The code says the the template argument type is named `Y`, but the declarations of `Set` use `T`. Once you fix those, as @AndyProwl says, you need to define the member function in `myset.cpp` properly.

You've also got a circular include. `myset.h` has a `#include` that pulls in `myset.cpp`, and `myset.cpp` has a `#include` that pulls in `myset.h`. Get rid of the one in `myset.cpp`. Oh, and get rid of `using namespace std;`.

# php - 在每个按钮独有的 foreach 循环中设置会话

> ID：15537128
> 
> 赞同：0
> 
> 时间：2013-03-21T00:05:13.667
> 
> 标签：php

我有一个使用 foreach 循环和会话变量生成的结果页面

这就是它的样子

```
<?php

  if(count($degree) > 0){
      foreach ($degree as $key => $val){
          $url = "http://www.concordiauniversity.com/".$val.'/'.$classname[$key];
          echo "<form method='post' enctype='multipart/form-data' action='/classname_handler'><div class='control-group' align='center'><ul class='thumbnails'><a href=$url class='thumbnail'><img src=$url onerror=this.src='images.png' alt=Click the empty space here to see the class :) width=60 height=100></a><h4>$classname[$key]</h4><a href='/classname_handler' type='text' id='follower' name='follower' class='btn btn-large btn-block btn-primary' type='button'>follow class <i class='icon-hand-right icon-white'></i> $val <i class='icon-user icon-white'></i></a></ul></div></form>";
          $_SESSION['degree'] = $degree;
          $_SESSION['classname'] = $classname;
      }
  }
  ?> 
```

我的问题是如何为每个 $classname 设置会话，以便当我单击关注类按钮时，会话仅适用于该特定类。我现在拥有它的方式，我得到了一个数组。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:13:32.913

您可以在`$_SESSION`.

```
$_SESSION['degree'][] = $degree;
$_SESSION['classname'][] = $classname; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:14:47.430

我不完全确定您在这里尝试做什么，但据我了解，您的会话变量会被每次迭代覆盖。使用类似的东西

```
 $_SESSION['degree'] = $degree;

  foreach ($degree as $key => $val){
      $url = "http://www.concordiauniversity.com/".$val.'/'.$classname[$key];
      echo " ..... ";
  } 
```

然后在实际的课程页面中使用会话来获取您的值，例如

```
$_SESSION['degree'][KEY_FROM_URL] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:14:23.763

原来答案是两个答案的组合

```
$_SESSION['degree'] = $val;
$_SESSION['classname'] = $classname[$key]; 
```

在结果页面而不是处理程序上！谢谢！

# rabbitmq - 如何解决这个 rabbitmq/celery 错误？

> ID：15537129
> 
> 赞同：3
> 
> 时间：2013-03-21T00:05:15.217
> 
> 标签：rabbitmq, celery

所以我在带有集群rabbitmq后端的多台服务器上运行芹菜。最近，我对 celery 所做的任何事情都开始无限期地挂起，检查 rabbitmq 的日志为我提供了这个晦涩的错误消息：

```
=ERROR REPORT==== 20-Mar-2013::23:52:25 ===
connection <0.15823.3>, channel 1 - soft error:
{amqp_error,not_found,
        "no binding i-69995906 between exchange 'i-69995906' in vhost 'celery' and queue 'i-69995906' in vhost 'celery'",
        'queue.bind'} 
```

运行 rabbitmqctl list_bindings 给了我这个：

```
# rabbitmqctl list_bindings -p celery
Listing bindings ...
        exchange    celery  queue   celery  []
celery  exchange    celery  queue   celery  []
...done. 
```

我需要做什么才能摆脱错误？我已经重新启动了 Rabbitmq，重新安装了 Rabbitmq，并删除并恢复了集群。我猜我需要恢复预先存在的绑定，但我不知道如何从 rabbitmqctl 或 celery 中恢复。如果这不起作用，我的芹菜任务根本不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-11-27T21:51:30.913

我遇到了同样的问题，并且无需关闭集群或重置虚拟主机即可修复它。

我有一个队列，其中有 3 个路由键绑定在一个集群中。我必须在其中 1 个节点关闭时删除队列，然后在尝试在新创建的同名队列中再次注册路由键时，总是出现“虚拟主机和队列中的交换之间没有绑定”错误。

原始队列被创建为“持久”，解决方案是：

*   删除队列
*   创建一个具有相同名称但“瞬态”（非持久）的新队列
*   在队列中注册原始的 3 个路由键。它停止提出错误。

因为我想要一个持久队列，所以我再次删除了队列，创建了一个具有相同名称的新“持久”队列，然后绑定路由键工作得很好。

也许通过创建具有不同“耐用性”类型的新队列，确实重置了仍保留在某处的旧绑定。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-06-28T16:20:26.100

谢谢你的问题。我最终来到了完全相同的地方。

我能够通过删除虚拟主机并重新创建它来纠正这个问题

```
rabbitmqctl delete_vhost celery
rabbitmqctl add_vhost celery
rabbitmqctl set_permissions -p celery <user> ".*" ".*" ".*" 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-05-07T14:40:48.477

我也有这个错误，解决它的唯一方法是立即关闭整个集群并让它关闭几秒钟。

*前言*：我们之前确实遇到过一些分区，无法推送到一个队列，也无法重新创建绑定并得到与您相同的错误。

一个一个地停止和启动是行不通的。错误仍然存​​在，我假设集群的某个节点确实缓存了一些错误的 ip/config。

*检测*：确定这是否是您的错误的好方法是`rabbitmqctl list_queues`在所有节点上运行。如果节点显示不同的队列，则出现问题。

*解决方案*：如上所述，解决方案是停止所有兔子服务器几秒钟，因此没有“缓存”。当然，这只是您不依赖于永久队列的解决方案。

# vb.net - Visual Basic - 动态更新标签中的数据？

> ID：15537131
> 
> 赞同：1
> 
> 时间：2013-03-21T00:05:44.653
> 
> 标签：vb.net

这是我的代码的一部分.. 这是一个骰子游戏，检查所有 3 个骰子是否相同。用户可以持有/取消持有任何 3 和骰子使用计时器来滚动。如果它们都相同，点数会增加 1。问题是，标签不会更新，直到再次按下滚动按钮。**一旦**有 3 个相同的骰子数字，我该如何做到这一点，标签就会增加 1 ？

**用所有代码编辑**

```
Dim randomObject As New Random()
Dim n, m, o, p As Integer
Dim RollNumber = 1
Dim TurnNumber As Integer
Dim Points = 0
Dim Restart As Boolean = True

Private Sub btnRoll_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRoll.Click

    If btnHold.Enabled = True Then
        Timer1.Enabled = True
    End If
    If btnHold2.Enabled = True Then
        Timer2.Enabled = True
    End If
    If btnHold3.Enabled = True Then
        Timer3.Enabled = True
    End If

    TurnNumber += 1
    lblTurns.Text = TurnNumber

    If TurnNumber = 3 Then
        RollNumber += 1
        TurnNumber = 0
    End If

    lblRolls.Text = RollNumber

    If Not Restart Then
        If (lblDice.Text = lblDice2.Text) And (lblDice2.Text = lblDice3.Text) Then
            Points += 1

        End If
        lblPoints.Text = Points
    End If
    Restart = False

End Sub

Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    m = m + 1
    If m < 10 Then
        n = randomObject.Next(1, 7)
        lblDice.Text = n
        die1PictureBox.Image = ImageList1.Images(n - 1)
    Else
        Timer1.Enabled = False
        m = 0
    End If
End Sub

Private Sub Timer2_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer2.Tick
    m = m + 1
    If m < 10 Then
        n = randomObject.Next(1, 7)
        lblDice2.Text = n
        die2PictureBox.Image = ImageList1.Images(n - 1)
    Else
        Timer2.Enabled = False
        m = 0
    End If
End Sub

Private Sub Timer3_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer3.Tick
    m = m + 1
    If m < 10 Then
        n = randomObject.Next(1, 7)
        lblDice3.Text = n
        die3PictureBox.Image = ImageList1.Images(n - 1)
    Else
        Timer3.Enabled = False
        m = 0
    End If
End Sub

Private Sub btnHold_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnHold.Click
    btnHold.Enabled = False
    btnUnhold.Enabled = True
End Sub

Private Sub btnUnhold_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnUnhold.Click
    btnHold.Enabled = True
    btnUnhold.Enabled = False
End Sub

Private Sub btnHold2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnHold2.Click
    btnHold2.Enabled = False
    btnUnhold2.Enabled = True
End Sub

Private Sub btnUnhold2_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnUnhold2.Click
    btnHold2.Enabled = True
    btnUnhold2.Enabled = False
End Sub

Private Sub btnHold3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnHold3.Click
    btnHold3.Enabled = False
    btnUnhold3.Enabled = True
End Sub

Private Sub btnUnhold3_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnUnhold3.Click
    btnHold3.Enabled = True
    btnUnhold3.Enabled = False
End Sub

Private Sub btnRestart_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnRestart.Click
    Dim msg As String
    Dim title As String
    Dim style As MsgBoxStyle
    Dim response As MsgBoxResult
    msg = "Are you sure you want to start a new game? If not, you can select 'No' to continue with your current game."
    style = MsgBoxStyle.DefaultButton2 Or _
       MsgBoxStyle.Critical Or MsgBoxStyle.YesNo
    title = "New Game"

    response = MsgBox(msg, style, title)
    If response = MsgBoxResult.Yes Then
        Reset()

    End If

    Restart = True

End Sub

Private Sub ColorChangeToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles ColorChangeToolStripMenuItem.Click

    'Notice the ... in the menu...that means a dialog box will come

    Dim dialog As New ColorDialog   ' Color Dialog
    Dim result As DialogResult ' stores Button clicked

    dialog.FullOpen = True ' show all colors
    result = dialog.ShowDialog

    ' do nothing if user clicked dialog's Cancel Button
    If result <> Windows.Forms.DialogResult.Cancel Then
        ' assign new color to Paint object
        Label1.ForeColor = dialog.Color
    End If

End Sub

Private Sub FontChangeToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles FontChangeToolStripMenuItem.Click
    'Notice the ... in the menu...that means a dialog box will come

    Dim dialog As New FontDialog   ' Font Dialog
    Dim result As DialogResult ' stores Button clicked

    ' show dialog and get result
    result = dialog.ShowDialog()

    ' do nothing if user clicked dialog's Cancel Button
    If result <> Windows.Forms.DialogResult.Cancel Then
        ' assign new font value to TextBox
        If Windows.Forms.DialogResult.OK = MessageBox.Show("Changing Font. Click Ok to Change,\n Cancel for no change to occur.", _
                                 "Warning", MessageBoxButtons.OKCancel) Then
            Label1.Font = dialog.Font
        End If

    End If

End Sub

Private Sub SelectAColorToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SelectAColorToolStripMenuItem.Click

    Dim dialog As New ColorDialog   ' Color Dialog
    Dim result As DialogResult ' stores Button clicked

    dialog.FullOpen = True ' show all colors
    result = dialog.ShowDialog()

    ' do nothing if user clicked dialog's Cancel Button
    If result <> Windows.Forms.DialogResult.Cancel Then
        Me.BackColor = dialog.Color
    End If

End Sub

Private Sub SelectAnImageToolStripMenuItem_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles SelectAnImageToolStripMenuItem.Click
    Dim msg As String
    Dim title As String
    Dim style As MsgBoxStyle
    Dim response As MsgBoxResult
    msg = "Are you sure you want to see what happens when you get a perfect score without actually playing? That's cheating.. and will reset the game!"
    style = MsgBoxStyle.DefaultButton2 Or _
       MsgBoxStyle.Critical Or MsgBoxStyle.YesNo
    title = "New Game"

    response = MsgBox(msg, style, title)
    If response = MsgBoxResult.Yes Then
        Dim FileChooser As New OpenFileDialog()
        Dim result As DialogResult

        result = DialogResult = FileChooser.ShowDialog()

        If result <> Windows.Forms.DialogResult.Cancel Then
            If FileChooser.FileName <> "" Then
                Me.BackgroundImage = System.Drawing.Image.FromFile(FileChooser.FileName)
                Reset()
            Else
                MessageBox.Show("No Change Made. File Not Selected!", "Warning", _
                                System.Windows.Forms.MessageBoxButtons.OK, _
                                System.Windows.Forms.MessageBoxIcon.Exclamation)
            End If
        End If
    End If

End Sub

Private Sub btnHow_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnHow.Click
    MessageBox.Show(" You will have 5 rolls.  In each roll you have up to 3 turns. Your object in each of the turns is to get three of a kind on the dice.  You can hold some die and roll only some of the die, or you can reroll all the dice.  If in a turn you get three of a kind, you get a point.  At the end of 5 turns you could have a maximum of 5 points and you will get a special prize.")
End Sub

Sub Reset()
    RollNumber = 1
    lblRolls.Text = RollNumber
    TurnNumber = 0
    lblTurns.Text = TurnNumber
    Points = 0
    lblPoints.Text = Points
    lblPoints2.Text = ""

    btnRoll.Enabled = True
    btnHold.Enabled = True
    btnHold2.Enabled = True
    btnHold3.Enabled = True
    btnUnhold.Enabled = False
    btnUnhold2.Enabled = False
    btnUnhold3.Enabled = False

    die1PictureBox.Image = Nothing
    die2PictureBox.Image = Nothing
    die3PictureBox.Image = Nothing
    lblDice.Text = ""
    lblDice2.Text = ""
    lblDice3.Text = ""

End Sub

Private Sub btnTriple_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnTriple.Click
    Points += 1
    lblPoints.Text = Points

    btnTriple.Visible = False
End Sub 
```

结束类

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:27:03.687

这个答案将消除我在您的其他问题上给您的答案的需要。由于您使用计时器来生成您的骰子号码，因此在禁用每个计时器后创建一个您调用的方法，此方法将检查所有计时器是否已禁用，然后检查是否相等。看看它是否适合你。您可能还希望将更多代码从`btnRoll_Click`EventHandler 移动到此方法。

检查相等性的方法。

```
Private Sub CheckForMatch()
    If Not Timer1.Enabled And Not Timer2.Enabled And Not Timer3.Enabled Then
        If (lblDice.Text = lblDice2.Text) And (lblDice2.Text = lblDice3.Text) Then
            Points += 1
            lblPoints.Text = Points
        End If
    End If
End Sub 
```

修改计时器方法示例添加到所有三个计时器

```
Private Sub Timer1_Tick(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Timer1.Tick
    m = m + 1
    If m < 10 Then
        n = randomObject.Next(1, 7)
        lblDice.Text = n
        die1PictureBox.Image = ImageList1.Images(n - 1)
    Else
        Timer1.Enabled = False
        CheckForMatch()
        m = 0
    End If
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:14:53.503

设置 lblRolls.Text 后尝试调用 DoEvents：

```
....

lblRolls.Text = RollNumber
Application.DoEvents()

.... 
```

**编辑**

```
Private Sub SetTimers(Enable As Boolean)
    Timer1.Enabled = Enable
    Timer2.Enabled = Enable
    Timer3.Enabled = Enable
End Sub

''''
SetTImers(True)
....

If TurnNumber = 3 Then
    RollNumber += 1
    TurnNumber = 0
    SetTimers(False)
    Application.DoEvents()
    lblRolls.Text = RollNumber        
    Application.DoEvents()
    SetTimers(True)
Else
    lblRolls.Text = RollNumber
End If

.... 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:24:55.163

在结束后将标签线向下移动，看看是否有帮助。我看不到你在哪里增加积分 - 所以很难说。

```
If (lblDice.Text = lblDice2.Text) And (lblDice2.Text = lblDice3.Text) Then
    btnTriple.Visible = True
End If 
```

甚至将它放在 restart=false 行之前，而不是现在的位置。

```
lblPoints.Text = Points
Restart = False 
```

# ruby-on-rails - 我希望用户只输入一次密码，这样他们以后就不必再输入一次了

> ID：15537132
> 
> 赞同：0
> 
> 时间：2013-03-21T00:05:52.670
> 
> 标签：ruby-on-rails

在我的 rails 应用程序中，我使用 http 基本身份验证。该应用程序仅适用于移动设备，我不希望用户每次打开页面时都必须继续登录。有什么方法可以存储用户/通行证以供将来使用该应用程序。我真的不需要它永远过期，但我只想在第一次访问后至少将登录保持在最低限度。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:11:20.943

iOS 上的 Safari 至少不记得这种凭据。如果您设置使用 http 基本身份验证，则可以使用[http://username:password@domain.com/](http://username:password@domain.com/)之类的 URL 访问该站点，如果您愿意将密码保存在书签中，则可以将其保存为书签.

# c - typedef struct的标识符是什么

> ID：15537135
> 
> 赞同：0
> 
> 时间：2013-03-21T00:06:22.123
> 
> 标签：c

我上来学习链表。但是，我对用 struct 声明链表的几种方法感到很困惑。

这是一种方式，

```
typedef struct Nodetag {
int dataNum;
struct Nodetag* nextNode;
} NODE; 
```

这是不使用 typedef 的另一种方式

```
struct NODE {
int dataNum;
struct NODE* nextNode;
}; 
```

我很好奇，当我们用 声明时`typedef`，我知道`Nodetag`用于让编译器知道是什么`struct Nodetag* nextNode;`。但是， 的实际标识符是`struct`什么？`Nodetag`还是`NODE`？如果是`Nodetag`，什么时候`NODE`使用？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T00:13:25.957

您可以选择给结构一个标签，如`struct Nodetag`或`struct NODE`。这些标签（以及联合标签和枚举标签）位于与普通标识符不同的命名空间中。

该`typedef`版本为`struct Nodetag`:

```
typedef struct Nodetag { ... } NODE; 
```

Now`NODE`是普通标识符名称空间中的类型名称，它是 . 的同义词或别名`struct Nodetag`。

请注意，您还可以编写：

```
typedef struct Nodetag NODE;

struct Nodetag
{
    int   dataNum;
    NODE *nextNode;
}; 
```

第一行说“存在带有标签的结构类型，`Nodetag`并且`NODE`是该类型的别名”。第二个块说“`struct Nodetag`由这些项目组成”，将 a`NODE *`列为成员之一。

* * *

### C和C++是两种不同的语言

请注意，这个问题被标记为 C，并且您得到的是直接 C 的答案（这很好）。但是，如果您遇到过 C++，您会发现：

```
struct Nodetag
{
    int      dataNum;
    Nodetag *nextNode;
}; 
```

`Nodetag`是有效的 C++ 并在普通标识符命名空间（以及（结构）标记命名空间中的标记）中生成类型名称`Nodetag`。这在 C 中无效。如果您最终使用 C++ 编译器编译 C，您可能会感到困惑代码，虽然。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T00:16:15.247

这：

```
struct Nodetag {
    /* ... */
}; 
```

创建一个名为`struct Nodetag`. 同样，这个：

```
struct NODE {
    /* ... */
}; 
```

创建一个名为`struct NODE`.

在任何一种情况下，您都可以用声明包装该声明`typedef`，为同一类型创建第二个名称：

```
typedef struct S {
    /* ... */
} T; 
```

这让您可以将类型称为 as`struct S`或 as `T`。（你不能只调用它`S`——尽管如果你使用 C++ 而不是 C 编程，你可以调用它。）

编写上述内容的等效方法是：

```
struct S {
    /* ... */
};
typedef struct S T; 
```

请注意，struct 标签和 typedef 名称位于不同的命名空间中（不是 C++ 意义上的“命名空间”一词），因为 struct 标签只能跟在关键字之后`struct`。所以没有必要区分它们。

```
typedef struct Node {
    /* ... */
} Node; 
```

现在您可以将类型称为`struct Node`或仅称为`Node`.

添加这样的 typedef 并没有太大的优势；如果你喜欢，你可以省略它，只将类型称为`struct Node`. （但是很多 C 程序员喜欢能够为类型使用一个单词的名称，而 typedef 是唯一的好方法（a`#define`是另一种方法，但不是好方法。）

也可以省略标签名称，只使用 typedef：

```
typedef struct {
    /* ... */
} Node; 
```

这为您提供了一个*匿名*结构类型，然后立即创建`Node`引用它的名称。但是使用这种方法，结构不能包含指向自身的指针，因为名称`Node`直到结构定义结束后才可见。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:09:51.667

第一个结构被调用`struct Nodetag`，第二个结构被调用`struct NODE`。

在第一个实例中，已经定义了一个 typedef 为 的“别名” `NODE`，`struct Nodetag`但它不会更改结构的名称。例如，它的作用是让您输入，`NODE*`而不是`struct Nodetag*`. 这是简写​​，仅此而已。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T00:12:52.867

结构标签和类型存在于不同的命名空间中。你可以有一个`struct node`也可以有一个类型`node`。结构标签必须与说明`struct`符/前缀一起使用以区分它们。当你这样做时：

```
typedef struct Nodetag {
int dataNum;
struct Nodetag* nextNode;
} NODE; 
```

您正在定义一个新类型并定义一个结构标记，但您实际上并不需要定义一个类型，这只是为了方便。在结构定义中，由于编译器在读取部分之前不知道类型，因此`} NODE;`您必须使用结构标签来引用您正在定义的结构。

# asp.net-mvc - 如何使用 HttpPostedFileBase 类型播种我的 MVC 模型？

> ID：15537140
> 
> 赞同：1
> 
> 时间：2013-03-21T00:07:00.743
> 
> 标签：asp.net-mvc, seeding, httppostedfilebase

我已经搜索了这个答案的高低，但找不到任何东西......我是不是很愚蠢？

```
 protected override void Seed(MyContext context)
    {
        context.Items.Add(new Item
        {
            URL = "my-url-field",
            Title = "My Title for this Item",
            Image = "some-image-file.jpg"  // this is httppostedfilebase  - how to seed this?
        });
    } 
```

我想我必须实例化一个 httppostedfilebase 的对象，但我该怎么做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:52:14.163

我认为`HttpPostedFileBase`您的模型的属性是错误的。您可能希望将`Image`属性作为 a `byte[]`- 这将存储在数据库中。如果您还需要文件名，则可以将其设为字符串属性`Item`

然后，你的种子方法看起来像

```
...
Image = File.ReadAllBytes("some-image-file.jpg"),
Filename = "some-image-file.jpg"
... 
```

# github - 如何从 GitHub 上的拉取请求的 5 个提交中挑选 2 个？

> ID：15537145
> 
> 赞同：10
> 
> 时间：2013-03-21T00:07:16.453
> 
> 标签：github, commit, pull-request, git-cherry-pick

我是 GitHub 的新手。有人提交了一个包含 5 次提交的拉取请求。不过，其中 3 个有一个小错误，所以必须等待。如何为我的项目选择其中 2 个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T07:26:15.500

理想的解决方案是留下评论，要求贡献者再次提交他/她的拉取请求，只需要 2 次提交，以便您应用所述 PR（拉取请求）而无需做任何工作。

另一个解决方案，来自“[合并拉取请求](https://help.github.com/articles/merging-a-pull-request)”页面，是在本地克隆上的专用分支中本地**合并。**
然后，您可以挑选您想要的正确提交，并将它们推送回您的仓库，但请确保在拉取请求的讨论部分留下评论，解释

*   您只考虑了 5 个提交中的 2 个，
*   贡献者应该将他的工作重新建立在您新更新的 master 之上（现在包括上述 2 个提交），并重新提交与最后（并希望已修复）3 个提交相同的拉取请求。

这类似于第一个选项，除了您不必等待修复：您可以在本地获取您想要的内容，测试和推送。

# macos - 如何在 mappstack 上安装 mod_xsendfile

> ID：15537146
> 
> 赞同：0
> 
> 时间：2013-03-21T00:07:29.623
> 
> 标签：macos, apache, bitnami, x-sendfile

最终更新：Bitnami 将在计划于 2013 年 4 月 8 日左右发布的下一个版本中将 mod_xsendfile 包含到 MAPP 堆栈中。

* * *

`mod_xsendfile`我已经尝试在我的 mappstack5.4.12-0 上编译和安装。我尝试了两种方法，但每次都失败了：

*   **方法一：使用apxs自动安装。**问题 => 运行命令“apxs **-cia** mod_xsendfile.c”时，apxs 试图在我的 Mac 上安装 mod_xsendfile，而不是在 mappstack 上安装它并且失败，因为尝试在该保护区创建 .so 文件时权限被拒绝。

*   **方法二：用apxs编译，在Apache中手动安装。**问题 => 在我完全拥有的文件夹中运行命令“apxs **-c** mod_xsendfile.c”时，它会生成 .slo 文件而不是 .so 文件。

如何将此 .slo 文件转换为 .so 文件？我在 google 中找不到任何与 .slo 文件相关的结果，也找不到关于我的 2 个问题的任何有用信息。

使用 .so 文件，我可以`mod_xsendfile`使用以下参考资料中的说明在 Apache 中手动安装：

*   [https://tn123.org/mod_xsendfile/](https://tn123.org/mod_xsendfile/)

我不能发布超过 2 个网址，但这里是每个网址的相关部分：

*   web-developpeur-php.com/blog/article/mod-xsendfile-forcer-le-telechargement-avec-apache-php
*   codeutopia.net/blog/2009/03/06/sending-files-better-apache-mod_xsendfile-and-php/
*   elivz.com/blog/single/mod_xsendfile/

apxs 的 Apache 手册： [http ://httpd.apache.org/docs/2.2/programs/apxs.html](http://httpd.apache.org/docs/2.2/programs/apxs.html)

这是我第一次使用apxs，我对编译c代码不太了解

谢谢。

PS：我能够按照 stackoverflow 答案[https://stackoverflow.com/a/9615149/2193168](https://stackoverflow.com/a/9615149/2193168)`mod_xsendfile`中的说明安装在 MAPPstack 上，但是在重新启动 Apache 时出现错误。

```
httpd: Syntax error on line 529 of /Applications/mappstack-5.4.12-0/apache2/conf/httpd.conf:
 Cannot load /Applications/mappstack-5.4.12-0/apache2/modules/mod_xsendfile.so into server:
   dlopen(/Applications/mappstack-5.4.12-0/apache2/modules/mod_xsendfile.so, 10):
     Symbol not found: _ap_log_rerror
       Referenced from: /Applications/mappstack-5.4.12-0/apache2/modules/mod_xsendfile.so
         Expected in: flat namespace
           in /Applications/mappstack-5.4.12-0/apache2/modules/mod_xsendfile.so 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T16:35:21.923

问题是“如何在 Bitnami MAPPStack 上安装 mod_xsendfile”。

答案是：升级到最新版本，因为 Bitnami 将它包含在堆栈中以响应我的问题和对 mod_xsendfile 的普遍兴趣。此外，您可以从 Bitnami阅读这些[附加说明。](http://wiki.bitnami.com/Components/Apache#How_to_add_mod_xsendfile_module_in_Apache.3f)

# visual-studio-2010 - 将类从 MFC 移植到 C++ 控制台应用程序。使用 /MD[d]（CRT dll 版本）构建 MFC 应用程序需要

> ID：15537152
> 
> 赞同：2
> 
> 时间：2013-03-21T00:07:47.457
> 
> 标签：visual-studio-2010, sockets, visual-c++, mfc

我正在尝试从基于 MFC 的应用程序中移植某些功能。显然我没有使用 MFC 的经验。我感兴趣的类继承自 CAsyncSocket。在 MSDN 上查找该类时，它声明该类派生自`afxsock.h`. 当我将它添加到我的控制台应用程序代码时，我收到以下错误消息

```
Error   1   error C1189: #error :  Building MFC application with /MD[d] (CRT dll version) requires MFC shared dll version. Please #define _AFXDLL or do not use /MD[d]  d:\program files (x86)\microsoft visual studio 10.0\vc\atlmfc\include\afx.h 
```

关于如何解决此问题的任何建议？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T01:13:40.837

为了使用任何 MFC 的东西，您需要将您的程序与 MFC 链接。最简单的方法是通过项目属性。打开您的项目属性并转到“常规”。选择“使用 MFC”或者“在静态库中使用 MFC”或“在共享 dll 中使用 MFC”。尝试重新构建您的程序。之后您可能需要调整其他一些选项

# database - 插入行前大写

> ID：15537153
> 
> 赞同：1
> 
> 时间：2013-03-21T00:07:50.790
> 
> 标签：database, oracle, triggers, uppercase

我需要以大写形式插入所有数据。我正在使用 Oracle 数据库，并且我编写了一个可以完成这项工作的触发器。问题是我不知道 :NEW 是否可以被覆盖。

这是我的代码。

```
CREATE OR REPLACE TRIGGER my_trigger
    BEFORE INSERT OR UPDATE ON MY_TABLE
    FOR EACH ROW
        DECLARE
          CURSOR fields IS
                SELECT COLUMN_NAME FROM user_tab_columns WHERE table_name='MY_TABLE';
           field  user_tab_columns%ROWTYPE;
    BEGIN
       FOR field IN fields LOOP
            DECLARE
                theField VARCHAR2(100) := field.COLUMN_NAME;
                newValue NVARCHAR2(1000) := :NEW."MY_FIELD";
                BEGIN
                    :NEW."MY_FIELD" := UPPER(nValor);
                END;
        END LOOP;
    END;
/ 
```

这适用于“MY_FIELD”字段，但我需要使用我的变量“theField”。这样我认为表中的所有字段都可以替换。

我希望有人可以帮助我，或者建议我另一种方法来做到这一点。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T06:18:22.903

您希望代码工作的方式显然是低效的。想象一下，对于每个修改的行，Oracle 必须循环遍历表中的所有列！

以正常方式编写触发器，如下所示

```
:NEW.FIRST_NAME = UPPER(:NEW.FIRST_NAME);
:NEW.LAST_NAME = UPPER(:NEW.LAST_NAME); 
```

现在，您面临将其写入所有表的挑战。为此，我建议编写为您生成代码的 PL/SQL 代码。您提供表名，代码会为您生成 CREATE TRIGGER 代码。它可能是这样的

```
FOR C IN ( SELECT COLUMN_NAME AS CNAME FROM user_tab_columns WHERE table_name='MY_TABLE')
 DBMS_OUTPUT.PUT_LINE(':NEW.'||CNAME || ':=UPPER(:NEW.'||CNAME ||')' );
END LOOP; 
```

如果您有太多的列和表，DBMS_OUT 缓冲区可能会变满。我更愿意将代码插入到临时表中。

# ffmpeg - 使用 ffmpeg 组合多个媒体文件的代码

> ID：15537154
> 
> 赞同：1
> 
> 时间：2013-03-21T00:07:58.387
> 
> 标签：ffmpeg

我是ffmpeg的新手

我正在尝试使用 ffmpeg 组合多个媒体文件，我知道 ffmpeg 连接协议允许通过命令行争论来实现这一点。我想知道这个函数的 C 代码是否在任何地方都可用，以便我可以在我的程序中包含相同的代码。如果没有，如果有人能就如何做到这一点发表任何建议，我将不胜感激。基本上，我想组合多个文件而不进行文件的解码和编码。

我尝试将数据从一个文件复制到另一个文件，虽然我能够创建一个新文件，但我无法播放它。

我搜索了 ffmpeg 库，但无法找到有关串联功能如何工作的代码。

# perl - Perl 嵌套结构

> ID：15537157
> 
> 赞同：3
> 
> 时间：2013-03-21T00:08:13.100
> 
> 标签：perl

我对 Perl 中的复杂结构有疑问

```
my $data1 = [
  +{ id => 1, name => 'A' },
  +{ id => 2, name => 'B' },
  +{ id => 3, name => 'C' },
];

my $data3 = +{
   1 => +{ id => 1, name => 'A' },
   2 => +{ id => 2, name => 'B' },
   3 => +{ id => 3, name => 'C' },
}; 
```

我应该如何打印“B”？那是什么样的数据结构？还有任何易于理解的关于 Perl 嵌套结构（散列引用、数组引用等）的很好的参考资料？

先感谢您

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T00:15:54.337

尝试这样做：

```
print $data1->[1]->{name}; # ARRAY ref
print $data3->{2}->{name}; # HASH ref 
```

这是从 perl ARRAY 和 HASH ref*取消引用。*

显式`->` *取消引用*。只有第一层“楼层”才需要它，例如：

```
print $data1->[1]{name};
print $data3->{2}{name}; 
```

也可以。第二个和更多是可选的。

就像 Chris Charley 说的，看看[关于数据结构的教程](http://perldoc.perl.org/perldsc.html)

* * *

为了帮助您了解标量 ref 的外观，请使用[Data::Dumper](https://metacpan.org/module/Data::Dumper)，例如：

```
print Dumper $data1;
print Dumper $data3; 
```

应该输出：

```
$VAR1 = [
          {
            'name' => 'A',
            'id' => 1
          },
          {
            'name' => 'B',
            'id' => 2
          },
          {
            'name' => 'C',
            'id' => 3
          }
        ];
$VAR1 = {
          '1' => {
                   'name' => 'A',
                   'id' => 1
                 },
          '3' => {
                   'name' => 'C',
                   'id' => 3
                 },
          '2' => {
                   'name' => 'B',
                   'id' => 2
                 }
        }; 
```

* * *

对于`+{ }`语法，[rra](https://stackoverflow.com/users/2178404/rra)给出了很好的响应：

> 在可以将大括号视为代码块而不是匿名哈希引用的地方消除歧义，但很少需要这样做。我猜代码包含它们是出于一种错误的愿望，即清晰并与可能模棱两可的地方保持一致。

# r - R：spatstat：Thomas 集群进程的残差分析

> ID：15537158
> 
> 赞同：0
> 
> 时间：2013-03-21T00:08:14.307
> 
> 标签：r, spatstat

我希望测试同质 Thomas 集群过程的拟合度，理想情况下使用诊断.ppm 和 qqplot.ppm 等残差图。由于适合 Thomas 集群进程的最直接方法是使用 kppm，因此我无法使用上述函数。任何人都可以建议这样做的方法吗？例如将 kppm 转换为 ppm 或使用 ppm 来适应 Thomas 集群过程，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-08T00:31:10.880

只是为了可能关闭这个老问题：

没有办法做到这一点。这不是实现问题，而是由于 ppm 类（函数 diagnostic.ppm 和 qqplot.ppm 适用）表示拟合的吉布斯点过程模型，这与拟合的 Thomas 集群过程模型（的kppm 级）。

通常，Thomas 过程的拟合优度是使用基于汇总统计的模拟信封之类的东西来判断的，但是应该注意不要使用与通过最小对比度拟合模型的汇总统计密切相关的汇总统计（如果使用拟合方法）。

# perl - Perl 模式匹配可选标记

> ID：15537161
> 
> 赞同：0
> 
> 时间：2013-03-21T00:08:35.303
> 
> 标签：perl, permutation

我有一个这样的字符串：

```
$words = "[a] (good|bad) word [for fun]"; 
```

在哪里：

1.  [] 内的所有内容都是可选的
2.  并且 (..|..) 内的值是 OR 强制值

因此，上述字符串的可能结果如下：

```
a good word for fun

a bad word for fun

a good word

a bad Word

good word for fun 

bad word for fun

good word 

bad word 
```

有人可以帮我找到一种方法来提取所有可能的结果（如上面的示例）并将它们存储在数组中吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:51:52.287

```
use warnings;
use strict;
use constant { OPT => 0, OR => 1, FIXED => 2 };

my $words = "[a] (good|bad) word [for fun]";
my @tokens;
# parse input
my @v = grep {$_} split /(\[|\]|\(|\||\))/, $words;
while (my $token = shift @v) {
  if ($token eq '[') {
    push @tokens, [ OPT, shift @v ];
    shift @v; # ]
  } elsif ($token eq '(') {
    my @list;
    do {
      push (@list, [ FIXED, shift @v] );
    } until (shift @v eq ')'); # '|,)'
    push @tokens, [ OR, \@list ];
  }
  else {
    push @tokens, [FIXED, $token];
  }
}
# generate output
my @phrases = ("");
for my $token (@tokens) {
  my @additions;
  if ($token->[0] == OPT) {
    push @additions, $_.$token->[1] for @phrases;
  } elsif ($token->[0] == FIXED) {
    $_ .= $token->[1] for @phrases;
  } elsif ($token->[0] == OR) {
    foreach my $list (@{$token->[1]}) {
      push @additions, $_.$list->[1] for @phrases;
    }   
    @phrases = (); 
  }
  push @phrases, @additions;
}

print "$_\n" for map {s/^\s+//;s/[ ]+/ /g;$_} @phrases; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T02:39:45.017

I saw this as an opportunity to try using [Parse::RecDescent](http://search.cpan.org/perldoc). I don't understand these things very well, so there might have been a better way to write the grammar.

The parser allows me to generate a list of sets of phrases to use. Then, I feed that list of sets to [Set::CrossProduct](http://search.cpan.org/perldoc/Set%3a%3aCrossProduct) to generate the Cartesian product of sets.

```
#!/usr/bin/env perl

use strict;
use warnings;

use Parse::RecDescent;
use Set::CrossProduct;

our @list;

my $parser = Parse::RecDescent->new(q{
    List: OptionalPhrase |
          AlternatingMandatoryPhrases |
          FixedPhrase

    OptionalPhrase:
        OptionalPhraseStart
        OptionalPhraseContent
        OptionalPhraseEnd

    OptionalPhraseStart: /\\[/

    OptionalPhraseContent: /[^\\]]+/
        {
            push @::list, [ $item[-1], '' ];
        }

    OptionalPhraseEnd: /\\]/

    AlternatingMandatoryPhrases:
        AlternatingMandatoryPhrasesStart
        AlternatingMandatoryPhrasesContent
        AlternatingMandatoryPhraseEnd

    AlternatingMandatoryPhrasesStart: /\\(/

    AlternatingMandatoryPhrasesContent: /[^|)]+(?:[|][^|)]+)*/
        {
            push @::list, [ split /[|]/, $item[-1] ];
        }

    AlternatingMandatoryPhraseEnd: /\\)/

    FixedPhrase: /[^\\[\\]()]+/
        {
            $item[-1] =~ s/\\A\\s+//;
            $item[-1] =~ s/\s+\z//;
            push @::list, [ $item[-1] ];
        }
});

my $words = "[a] (good|bad) word [for fun]";

1 while defined $parser->List(\$words);

my $iterator = Set::CrossProduct->new(\@list);

while (my $next = $iterator->get) {
    print join(' ', grep length, @$next), "\n";
} 
```

Output:

```
a good word for fun
a good word
a bad word for fun
a bad word
good word for fun
good word
bad word for fun
bad word
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T00:48:39.130

使用正则表达式，您可以确定“bad word”是否与您的模式“[a] (good|bad) word [for fun]”匹配（作为正则表达式匹配，可能拼写为`/(a )?(good|bad) word( for fun)?/`）。但听起来你实际上想要做相反的事情，即。从您的模式中生成所有可能的输入。这不是正则表达式可以做的事情。

您应该查看的内容称为*permutations*。您的模板字符串包含以下部分：

1.  “一个”或什么都没有
2.  “是好是坏”
3.  “ 单词”
4.  “为了好玩”或没有

因此，片段 1 和 2 有两种可能性，片段 3 仅有一种可能性，片段 4 也有两种可能性，为您提供 2 * 2 * 1 * 2 = 8 种可能性。

只需将所有这些可能性存储在一个多维数组中，例如

```
my $sentence = [["a ", ""], ["good", "bad"], ["word"], ["for fun", ""]]; 
```

然后在 CPAN 上查找置换算法或置换模块以找到所有组合。

作为单个排列的示例，“坏词”将表示为：

```
 my $badword = 
    $sentence->[0]->[0] 
  . $sentence->[1]->[1] 
  . $sentence->[2]->[0] 
  . $sentence->[3]->[0]; 
```

# java - pom.xml 中的 Maven 部署参数

> ID：15537165
> 
> 赞同：1
> 
> 时间：2013-03-21T00:09:02.993
> 
> 标签：java, git, maven, deployment, github

我有一个 Maven 项目，应该将它们的编译文件部署在另一个文件夹中。目前，我通过指定参数来做到这一点`altDeploymentRepository`：

```
mvn -DaltDeploymentRepository=snapshot-repo::default::file:/home/user/some/folder/mvn-repo/snapshots deploy 
```

我的问题：是否可以做一个简单的`mvn deploy`代替并将参数声明移动到 pom.xml 中？如果是，如何？

## 更新

有人问我为什么要这样做。我已将我的项目与源代码和 Maven 存储库分离为 Maven 项目。两者都是不同的 Github 项目，因此位于不同的文件夹中。我配置了 Maven，以便将目标文件部署在 repo 文件夹中。之后，我只需要 git add、commit 和 push 更改。

如果有任何方法可以将目标文件直接推送到所需的 Github 存储库，`maven deploy`或者让这个过程更简单，我全都在听！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T03:57:46.353

只是为了确保您真正理解 Maven 中“部署”的含义，因为像您正在做的那样“部署到其他文件夹”是很奇怪的。

Maven Deploy 意味着将工件部署到远程存储库。远程存储库是 Maven 搜索工件并下载到本地存储库的地方。它很少是“另一个文件夹”。我们通常使用`<distributionManagement>`配置远程存储库进行部署。通常，我们曾经`altDeploymentRepository`部署到不同的远程仓库，如`distrubutionManagement`.

如果您只是想将构建的工件放到一个单独的文件夹中，而不是针对“远程存储库”，我相信程序集（或类似的插件）是您需要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-14T14:52:59.070

与上面的答案类似，可以通过最初部署到目标文件夹下的文件系统存储库作为构建的一部分，然后使用 wagon 插件将本地（和私有）暂存存储库同步到一个更公共的存储库。

预先道歉，这是基于 *nix 的（请参阅`pwd`）

```
mvn -DaltDeploymentRepository=local-staged-repo::default::file://`pwd`/target/staged-repo \
    clean \
    deploy 
```

或者，它可以像这样在你的 pom.xml 中编码：

```
<pluginManagement>
  <plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-deploy-plugin</artifactId>
    <version>2.7</version>
    <configuration>
      <altDeploymentRepository>
        staged-repo::default::file:${project.basedir}/target/staged-repo
      </altDeploymentRepository>
    </configuration>
  </plugin>
</pluginManagement>
    ... 
```

然后在稍后阶段，从项目的根文件夹运行。您可以使用以下插件将根 pom.xml 的目标文件夹中的暂存存储库合并到更永久的存储库：

```
mvn org.codehaus.mojo:wagon-maven-plugin:1.0-beta-5:merge-maven-repos \
  -Dwagon.source=file://`pwd`/target/staged-repo \ 
  -Dwagon.target=http://<some-repo>/release \
  -Djava.io.tmpdir=/tmp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:16:00.210

好的，这比预期的要容易。我需要在我的插件中添加一个配置块：

```
 <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-deploy-plugin</artifactId>
            <version>2.7</version>
            <configuration>
                <altDeploymentRepository>
                  snapshot-repo::default::file:/home/user/some/folder/mvn-repo/snapshots
                </altDeploymentRepository>
            </configuration>
            <dependencies>
                <dependency>
                    <groupId>com.google.code.maven-svn-wagon</groupId>
                    <artifactId>maven-svn-wagon</artifactId>
                    <version>1.4</version>
                </dependency>
            </dependencies>
        </plugin> 
```

# c - 如何使用 OpenMP 将任务分配给单个线程？

> ID：15537168
> 
> 赞同：0
> 
> 时间：2013-03-21T00:09:27.467
> 
> 标签：c, openmp

我正在使用 20 个数组。并使用 openMP 将 1/4 任务按顺序分配给四个线程中的每个线程。然后将整个数组的结果存储到文件中。这里有什么问题？

在第一个数组中，我为每个元素分配 i*j 值，然后进行 20 x 20 的矩阵乘法。

```
#include<stdio.h>
#include<omp.h>
#include "head.h"

int sum=0;  
int c[20][20];
//#include<conio.h>

int main(void) {
    int A[20][20],B[20][20],C[20][20];
    int i,j,e;
    static sum=0;
    FILE *fp;

    unsigned long long a,b,c,d;
    int threadno;
    fp=fopen("m2.txt","w");
    //    clrscr();
    printf("\n%d \n",h[20][20]);

    #pragma omp parallel shared(a,b,c,d)
    {
        threadno=omp_get_thread_num();

        if(threadno==0)
        {   
            for (i=0;i<5;i++)
            for (j=0;j<5;j++)
                A[i][j]=i*j;
                B[i][j]=i*j;

            for (i=0;i<5;i++)
            for (j=0;j<5;j++)
                    for (e=0;e<5;e++)
                sum+=A[i][e]*B[e][j];
                    C[i][j]=sum;
            //fprintf(fp,"%d \t",C[i][j]);
        }

    }

    if(threadno==1)
    {   
        for (i=5;i<10;i++)
        for (j=5;j<10;j++)
            A[i][j]=i*j;
            B[i][j]=i*j;

        for (i=5;i<10;i++)
         for (j=5;j<10;j++) {
             sum=0;
             for (e=5;e<10;e++)
             sum+=A[i][e]*B[e][j];
             C[i][j]=sum;
            //fprintf(fp,"%d \t",C[i][j]);
           }
        }

    if(threadno==2)
    {   
        for (i=10;i<15;i++)
        for (j=10;j<15;j++)
            A[i][j]=i*j;
                B[i][j]=i*j;

        for (i=10;i<15;i++)
        for (j=10;j<15;j++) {
            for (e=10;e<15;e++)
                sum+=A[i][e]*B[e][j];
            C[i][j]=sum;
                //fprintf(fp,"%d \t",C[i][j]);
        }
    }

    if(threadno==3)
    {   
        for (i=15;i<20;i++)
        for (j=15;j<20;j++)
                A[i][j]=i*j;
            B[i][j]=i*j;

        for (i=15;i<20;i++)
        for (j=15;j<20;j++) {
            for (e=15;e<20;e++)
            sum+=A[i][e]*B[e][j];
            C[i][j]=sum;
                //fprintf(fp,"%d \t",C[i][j]);
        }
    }

    for (i=0;i<20;i++){
        for (j=0;j<20;j++) {
        fprintf(fp,"%d \t",C[i][j]);
        }
    }
}

fclose(fp); 
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:28:47.410

您不匹配大括号。`if(threadno==0)`在if 部分之后立即关闭并行部分。

此外，您的代码末尾似乎有一个额外的大括号。

正如 Dave 所提到的，您的 for 语句中还缺少几个大括号。这不是问题的原因，但会导致您的算法无法返回预期结果。

在 C 中

```
for(i = 0; i < n; i++)
     function(i); 
```

用于在 for 循环中执行单个操作

或者如果您希望 for 循环包含多个操作，请使用大括号

```
for(i = 0; i < n; i++){
     function(i);
     function2(i);
     function3(i);
} 
```

# objective-c - 等待来自后台线程的标志

> ID：15537179
> 
> 赞同：1
> 
> 时间：2013-03-21T00:10:52.063
> 
> 标签：objective-c, multithreading, cocoa

在启动我的程序后，我启动了第二个线程来做一些后台工作。这个线程永远不会死，但我需要等待它完成它正在做的事情，然后才允许主线程继续。

在等待第二个线程更新其状态时，如何阻止和恢复主线程？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T03:58:04.180

首先，不要阻塞主线程。永远不会。在 iOS 上阻塞主线程足够长的时间会导致你的应用程序被杀死。在 OS X 上，它会导致死亡的彩虹披萨出现。

最终，阻塞主线程会导致您的应用程序无响应。

相反，让应用程序抛出一个模态对话框或模态表或其他一些状态指示器，表明应用程序正在做一些必须在继续进行之前完成的事情。确保“退出”菜单项仍处于启用状态，以防用户决定“哦，废话！没有时间！中止！中止！中止！”。

然后，当您的后台线程完成后，使用任何各种机制来分派到主线程（GCD、performSelector:...等...），然后使“初始化”模式消失。

根本不需要轮询、睡眠或 while(){}。

* * *

> 我的后台线程没有完成，它或多或少地永远存在。而且我需要它在主线程执行此操作之前达到某个状态。

确切地; 因此，当它达到该状态时，您可以使用：

```
 [someObject performSelectorOnMainThread:@selector(sshConnectionEstablished:) withObject:nil]; 
```

`someObject`您的应用程序委托可能在哪里。

或者您可以使用通知并执行以下操作：

```
 dispatch_async(dispatch_get_main_queue(), ^{
    [[NSNotificationCenter defaultCenter] postNotificationNamed:@"MySSHConnectionEstablished" ....];
 }); 
```

请注意，您希望它是异步还是同步取决于您。

# assembly - 在运行时获取汇编语言中变量的大小

> ID：15537183
> 
> 赞同：1
> 
> 时间：2013-03-21T00:11:35.720
> 
> 标签：assembly, x86

我试图在运行时以 x86 汇编语言获取寄存器的大小（以字节为单位），但我不知道它是否可能。在 x86 汇编语言中，是否可以在运行时获取寄存器的大小？例如，是否可以获取一个寄存器或变量的大小（如`ebx`），并将其移至另一个寄存器（如`eax`）？

当我尝试运行指令`mov bx, sizeof bx`时，MASM 汇编器产生以下错误：`1>p4.asm(57): error A2009: syntax error in expression`.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T00:20:20.320

是的，只是做

```
mov eax, 4 ; eax = size of ebx in bytes 
```

CPU寄存器的大小不灵活，它们是固定的。

至于变量，只需在变量后添加标签并使用差异，如下所示：

```
mystring db "blah blah blah",10,0
mystringend label $ ; or simply "mystringend:"
...
mov eax, mystringend - mystring ; or "offset mystringend - offset mystring" 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T00:18:07.917

如果您正在编程 x86 汇编，通用寄存器（包括`eax`和`ebx`）始终是 32 位字。有指令可以访问每个寄存器的低 16 位，以及分别访问这 16 位的每个字节，但您必须明确使用它们并自己跟踪每个寄存器中预期数据大小的大小。一个警告：如果您正在执行 x86_64 编程，那么寄存器将扩展为 64 位，并且名称从 example 更改`eax`为`rax`or `r0`。

汇编中也没有变量之类的东西；当您引用内存地址时，操作码位中会进行编码，告诉进程内存访问是字节、字、双字还是更大。如果您使用的是像 MASM 这样的汇编程序，那么您可以“声明”变量具有一定的大小，然后汇编程序将为您跟踪基本类型检查，但处理器本身无法知道变量的“大小”变量。

# c# - MigrateDatabaseToLatestVersion 初始化程序无法创建数据库

> ID：15537185
> 
> 赞同：8
> 
> 时间：2013-03-21T00:11:42.850
> 
> 标签：c#, entity-framework-5, entity-framework-migrations

如果数据库不存在，我正在尝试使用 EF 代码优先迁移来构建数据库。到目前为止，我已经`Enabled-Migrations`成功了。我还曾经`Add-Migrations`进行过构建数据库的初始迁移。该脚本在迁移方向上，看起来是正确的。

这是我的 Main 方法的主体

```
Database.SetInitializer(new MigrateDatabaseToLatestVersion<MyDbContext, Configuration>());
var directConfigContext = new MyDbContext(); 
```

我读过的所有内容都表明这就是我所需要的。`MyDbContext`在`app.config`里面，看起来像这样：

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
    <connectionStrings>
        <add name="MyDbContext" connectionString="Data Source=(localdb)\v11.0;Initial Catalog=DbConfig;Integrated Security=True;MultipleActiveResultSets=True" providerName="System.Data.SqlClient" />
    </connectionStrings>
    <startup>
        <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.5" />
    </startup>
</configuration> 
```

此外，如果我使用 EF 提供的 DbMigrator 类，则可以正确构建数据库（大概使用初始数据库迁移脚本）。

```
// This is how it actually works including creating the database if it doesn't exist.
var dbMigrator = new DbMigrator(new Configuration());
dbMigrator.Update(); 
```

据我了解，设置初始化程序`MyDbContext`并随后实例化`DbContext`应该创建数据库到最新迁移......我错过了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-25T22:41:28.113

实例化 DbContext 不会执行绑定到它的初始化程序。相反，您需要更新数据库或直接调用底层数据库的初始化程序。

```
MyDbContext.MyEntity.Add(new MyEntity { Name = "Nelson" });
// Or
MyDb.Context.Database.Initialize(true); // force the initialization 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-07-07T16:33:57.430

接受的答案将解决其他人的问题，但我遇到了同样的问题，原因不同：我删除了我的数据库并通过更改我的`DbContext`.

当我运行我的应用程序，它第一次实例化并尝试使用`DbContext`时，没有创建数据库，因为上次迁移没有反映我在`DbContext`. 为了解决这个问题，我简单地通过`Add-Migration`在包管理器控制台上运行命令添加了一个新的迁移，并且在下次应用程序启动时，数据库被正确地创建和 sed。

# java - awt eventqueue 0 nullpointerexception（示例代码）

> ID：15537190
> 
> 赞同：-2
> 
> 时间：2013-03-21T00:11:50.113
> 
> 标签：java, swing, user-interface

好的，我收到此错误 awt eventqueue 0 nullpointerexception 错误。当我尝试删除 JPanel 时。

令我困惑的是，当我点击价格按钮时，它会删除 JPanel 的时间。它工作得很好，但是当我点击时间按钮时，它不会删除价格面板，而是我得到一个 awt eventqueue 错误。下面的第一个代码显示了我的主类、时间类和价格类。抱歉，我重新发布了我想发布我的代码。下面是代码示例

```
 import javax.swing.JOptionPane;
   import javax.swing.border.TitledBorder;
   import java.awt.*;
   import java.awt.event.*;
   import javax.swing.*;

   public class events extends JFrame {
   // variables for JPanel

  private JButton timeButton;
  private JButton priceButton;

       setLayout(new BorderLayout()); 

  buttonPanel = new JPanel();
  buttonPanel.setBackground(Color.lightGray);
  buttonPanel.setBorder( new TitledBorder("Main Menu"));

         timeButton = new JButton("Time"); 
  buttonPanel.add(timeButton);

  priceButton = new JButton("Price");
  buttonPanel.add(priceButton);

           buttontime clickTime = new buttontime(); // event created when time button is clicked
  timeButton.addActionListener(clickTime);

         //ActionListener created for price
   buttonprice ClickPrice = new buttonprice(); // event created when price button is clicked
   priceButton.addActionListener(ClickPrice);

         public class buttontime implements ActionListener { //creating actionlistener for clicking on timebutton to bring up a combobox

public void actionPerformed(ActionEvent clickTime) {
    Price priceObject = new Price();
    priceObject.getPricepanel();
    remove(priceObject.getPricepanel());
    priceObject.getPricepanel().revalidate();

    add(timeObject.getTimePanel(), BorderLayout.EAST);
    timeObject.getTimePanel().revalidate();

   }
}

      //This one gives me 0 errors.
           public class buttonprice implements ActionListener { //creating actionlistener for clicking on      timebutton to bring up a combobox

   public void actionPerformed(ActionEvent ClickPrice) {
    Price priceObject = new Price();
    priceObject.SelectPrice();
    remove(timeObject.getTimePanel());
    timeObject.getTimePanel().revalidate();

    add(priceObject.getPricepanel(), BorderLayout.EAST);
    priceObject.getPricepanel().revalidate(); 
```

} }

```
 TIME CLASS

             class Time
 {

   private JComboBox    timeAirportbox;//comboboxes declared

     private String[] airport = {"","East Midlands", "Birmingham", "Manchester", "Heathrow"};//array of    airports declared
    private String[] destination = {"","New York", "Dahab", "Rome", "Sydney", "Tokyo"};//array of destinations declared
 private JPanel timePanel;
 private JLabel airportLabel;  
  private JLabel destinationLabel;
 public void SelectTime() {   

 //combobox objects created
      timePanel = new JPanel();
  timePanel.setBackground(Color.GRAY);

      timePanel.setBorder( new TitledBorder("Time"));
  timeAirportbox = new JComboBox(airport);//array is inserted into the JComboBox
  timePanel.add(timeAirportbox);
  timeAirportbox.setVisible(true);

}
   public JPanel getTimePanel() {
    return timePanel;
    }

     public JComboBox getAirportBox() {
    return timeAirportbox;      
    }

    }

            PRICE CLASS

                class Price {

     private JPanel pricePanel;
      private JLabel tester;

    public void SelectPrice() {
    pricePanel = new JPanel();
  pricePanel.setBackground(Color.YELLOW);
  pricePanel.setPreferredSize(new Dimension(400, 400));
  tester = new JLabel("HIFHI");
  pricePanel.add(tester);

  }

   public JPanel getPricepanel() {
    return pricePanel;
    }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:23:16.323

你有无穷无尽的问题和问题清单。

两个直接是...

在你你`Price`的课上，你从不初始化`pricePanel`....

```
class Price {

    private JPanel pricePanel;
    private JLabel tester;

    public void SelectPrice() {
        pricePanel = new JPanel();
        pricePanel.setBackground(Color.YELLOW);

        tester = new JLabel("HIFHI");
        pricePanel.add(tester);

    }

    public JPanel getPricepanel() {
        return pricePanel;
    }
} 
```

这就是导致您的`NullPointerException`.

您将面临的第二个问题是您创建了 的本地副本`PriceObject`，但是有些期望能够删除先前实例化对象添加的面板

```
public class buttontime implements ActionListener { //creating actionlistener for clicking on timebutton to bring up a combobox

    public void actionPerformed(ActionEvent clickTime) {
        Price priceObject = new Price();
        priceObject.getPricepanel();
//----> Remove a local reference of price panel <---- //       
        remove(priceObject.getPricepanel());
        priceObject.getPricepanel().revalidate();

        add(timeObject.getTimePanel(), BorderLayout.EAST);
        timeObject.getTimePanel().revalidate();

    }
}

//This one gives me 0 errors.
public class buttonprice implements ActionListener { //creating actionlistener for clicking on      timebutton to bring up a combobox

    public void actionPerformed(ActionEvent ClickPrice) {
        Price priceObject = new Price();
        priceObject.SelectPrice();
        remove(timeObject.getTimePanel());
        timeObject.getTimePanel().revalidate();

//----> Adding a local reference of price panel <---- //       
        add(priceObject.getPricepanel(), BorderLayout.EAST);
        priceObject.getPricepanel().revalidate();

    }
} 
```

# ruby-on-rails - 为什么安装 Ruby on Rails 会生成错误“数组 'ruby_check_sizeof_voidp' 的大小为负数”？

> ID：15537191
> 
> 赞同：19
> 
> 时间：2013-03-21T00:11:58.913
> 
> 标签：ruby-on-rails, ruby, windows

在安装 Ruby on Rails（通过`gem install rails`）时，您可能会收到以下错误消息：

```
c:/Ruby193/include/ruby-1.9.1/ruby/ruby.h:109:14: error: size of array 'ruby_check_sizeof_voidp' is negative 
```

还会有很多这样的警告：

```
c:/Ruby193/include/ruby-1.9.1/ruby/ruby.h:1333:12: warning: cast to pointer from integer of different size [-Wint-to-pointer-cast] 
```

和一个额外的错误

```
c:/Ruby193/include/ruby-1.9.1/ruby/missing.h:41:8: error: redefinition of 'struct timespec' 
```

为什么会发生这种情况，如何成功安装 Rails？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-03-21T00:11:58.913

当您为您的 Ruby 版本安装了错误的 DevKit 版本时会发生这种情况，例如，如果您安装`DevKit-mingw64-64-4.7.2-20130224-1432-sfx.exe`到 Ruby 版本 1.9.3。

要更正此问题，请重新安装 Ruby 并为您的 Ruby 版本安装正确的 DevKit，如标题为“哪个开发工具包？”的部分所示。在[http://rubyinstaller.org/downloads](http://rubyinstaller.org/downloads)。

# php - MySQL 和 PHP - 从数据库中获取最后的评论

> ID：15537195
> 
> 赞同：0
> 
> 时间：2013-03-21T00:12:25.553
> 
> 标签：php, mysql, database, limit

我有这个代码：

```
 $sql = "SELECT * FROM deptcomment WHERE deptPostID ='$postID' ORDER BY deptCommentRegDate ASC, deptCommentRegTime ASC LIMIT 4"; 
```

它正在工作，但它只能获得特定帖子的前 4 条评论。我需要此代码才能按 ASC 顺序获取最后 4 条评论。这可能吗。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:13:33.090

尝试

```
$sql = "SELECT * FROM deptcomment WHERE deptPostID ='$postID' ORDER BY deptCommentRegDate ASC, deptCommentRegTime DESC LIMIT 4"; 
```

...然后运行`array_reverse();`结果。

* * *

当我有你的时候，我注意到你正在构建你的查询，这种方式暗示你打算将它传递给一个`mysql_*`类型函数。请记住，这些类型的函数已被弃用，建议您使用诸如**[PDO](http://php.net/manual/en/book.pdo.php)**之类的库来与数据库通信。

# mysql - MySQL将制表符分隔的文件加载到具有特殊字符的表中

> ID：15537199
> 
> 赞同：7
> 
> 时间：2013-03-21T00:13:01.847
> 
> 标签：mysql, sql

我希望能够将文件加载到其中包含反斜杠的 MySQL 表中，如下所示：

```
Fred          Los Angeles        I am Fred
Nick          Madison            Great Lakes Whoo
JOHN          San Diego          Hello world!\
Bob           NYC                Big apple 
```

用户 JOHN`\`在第 3 列的末尾放了 a。当我将其加载到表中时，MySQL 将反斜杠解释为某种行继续，并将第 3 行，第 3 行）与（第 4 行，第 1 行）连接起来。

我不能只是复制和粘贴来修复它，因为有数百万行这样的反斜杠在各个地方都会造成严重破坏。

将制表符分隔的文件加载到带有反斜杠的 MySQL 表中的正确方法是什么？我应该用引号将每个（列）字段括起来吗？我应该编写一个删除特殊字符的解析器吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T02:14:39.807

加载文件时必须指定`ESCAPED BY`选项。在以下示例中，我假设您的字段按选项卡（这是默认行为）划分，并且文件位于客户端主机上：

```
LOAD DATA LOCAL INFILE '/path/to/file/my.txt' INTO TABLE t
FIELDS TERMINATED BY '\t' ESCAPED BY '\b'; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-01-17T04:52:54.533

## 如何驯服mysql加载数据infile工具中的反斜杠：

**第 1 步，创建您的表：**

```
mysql> create table penguin (id int primary key, chucknorris VARCHAR(4000));
Query OK, 0 rows affected (0.01 sec) 
```

**第 2 步，创建要导入的文件并将这些数据放入其中。**

```
1   aliens are on route
2   scramble the nimitz\
3   \its species 8472
4   \\\\\\\\\\\\\\\\\\
5   Bonus characters:!@#$%^&*()_+=-[]\|}{;'":/.?>,< anything but tab 
```

**第 3 步，插入表格：**

```
mysql> load data local infile '/home/el/foo/textfile.txt' into table penguin 
       fields terminated by '\t' lines terminated by '\n' 
       (@col1, @col2) set id=@col1, chucknorris=@col2;
Query OK, 4 rows affected, 1 warning (0.00 sec)
Records: 4  Deleted: 0  Skipped: 0  Warnings: 1 
```

**第 4 步，当然，它会导致这个奇怪的输出：**

```
mysql> select * from penguin;
+----+-----------------------------------------------------------------+
| id | chucknorris                                                     |
+----+-----------------------------------------------------------------+
|  1 | aliens are on route                                             |
|  2 | scramble the nimitz
3                                           |
|  4 | \\\\\\\\\                                                       |
|  5 | Bonus characters:!@#$%^&*()_+=-[]|}{;'":/.?>,< anything but tab |
+----+-----------------------------------------------------------------+ 
```

**第五步，分析警告：**

```
mysql> show warnings;
+---------+------+--------------------------------------------------------+
| Level   | Code | Message                                                |
+---------+------+------------------------------------- ------------------+
| Warning | 1262 | Row 2 was truncated; it contained more data than there |
|         |      | were input columns                                     |
+---------+------+--------------------------------------------------------+
1 row in set (0.00 sec) 
```

**第 6 步，想一想到底出了什么问题：**

左侧的反斜杠`nimitz`导致 mysql 加载数据解析器将第 2 行的结尾与第 3 行的开头连接起来。然后它撞到一个制表符并将 'scramble the nimitz\n3 放入第 2 行。

第 3 行的其余部分被跳过，因为多余的单词`its species 8472`不适合任何地方，它会产生您在上面看到的警告。

第 4 行有 18 个反斜杠，所以没有问题，并且显示为 9 个反斜杠，因为每个反斜杠都被转义了。如果有一个奇数，第 2 行的错误就会发生在第 4 行。

第 5 行的奖励字符正常通过。除了制表符之外，一切都是允许的。

**第7步，重置企鹅：**

```
mysql> delete from penguin; 
```

**`fields escaped by`第 8 步，使用以下子句加载到您的表中：**

```
mysql> load data local infile '/home/el/foo/textfile.txt' into table penguin 
       fields terminated by '\t' escaped by '\b' 
       lines terminated by '\n' (@col1, @col2) set id=@col1, 
       chucknorris=@col2;

Query OK, 5 rows affected (0.00 sec)
Records: 5  Deleted: 0  Skipped: 0  Warnings: 0 
```

**第 9 步，从您的表格中选择，解释结果：**

```
mysql> select * from penguin;
+----+------------------------------------------------------------------+
| id | chucknorris                                                      |
+----+------------------------------------------------------------------+
|  1 | aliens are on route                                              |
|  2 | scramble the nimitz\                                             |
|  3 | \its species 8472                                                |
|  4 | \\\\\\\\\\\\\\\\\\                                               |
|  5 | Bonus characters:!@#$%^&*()_+=-[]\|}{;'":/.?>,< anything but tab |
+----+------------------------------------------------------------------+
5 rows in set (0.00 sec) 
```

现在一切都如我们所料。第 2 行末尾的反斜杠不会转义换行符。第 3 行之前的反斜杠`i`没有任何作用。第 4 行的 18 个反斜杠没有被转义。并且奖金字符通过确定。

# ios - 如何在 ios 上的谷歌地图标记信息窗口中添加按钮？

> ID：15537206
> 
> 赞同：7
> 
> 时间：2013-03-21T00:13:44.593
> 
> 标签：ios, objective-c, button, google-maps-markers, google-maps-sdk-ios

我已将 Google maps sdk for ios 添加到我的 Iphone 应用程序中，如果单击的信息窗口弹出标题，我有一些自定义标记，我如何在此信息窗口中添加一个按钮，以便如果按下将转到新页面？现在我尝试使用这篇文章来解决这个问题[在 Google Maps SDK for native iOS/objective C 中的 InfoWindow/Marker 上添加 Click Event](https://stackoverflow.com/questions/15360483/adding-click-event-on-infowindow-marker-in-google-maps-sdk-for-native-ios-object)它不会给我错误，但它不会工作。

这就是我想要的结果：[http ://www.flickr.com/photos/74719051@N05/6728157477/](http://www.flickr.com/photos/74719051@N05/6728157477/)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T00:32:25.920

您链接的问题的答案显示了使用 MapKit 的代码，因此它不适用于 iOS 版 Google Maps SDK。

请参阅此问题以了解如何使用适用于 iOS 的 Google Maps SDK 返回自定义视图：

[Google Maps SDK 中的自定义注释视图](https://stackoverflow.com/questions/15267183/custom-annotation-view-in-google-maps-sdk)

但是请注意，根据这个问题，看起来显示的内容可能是视图的视觉副本而不是实际视图，这可能会限制您可以与视图进行的交互：

[添加按钮以查看由 markerInfoWindow 委托方法返回的视图](https://stackoverflow.com/questions/15213049/add-buttons-to-view-returned-by-markerinfowindow-delegate-method)

不过应该可以简单地检测信息窗口上的点击并转到不同的页面`didTapWindowOfMarker`。

请注意，Google 的问题跟踪器中有一个功能请求来添加对此的直接支持：

[https://code.google.com/p/gmaps-api-issues/issues/detail?id=4961](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4961)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-11-30T13:22:53.207

这段代码完全符合您的要求。它的灵感来自 Saxon Druce 推荐的[链接](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4961)中的 #9，但做得不同且更完整。它检测到点击添加到我的自定义信息窗口的按钮。我创建了一个带有 2 个假按钮的自定义 infoWindow（它们实际上可以被图像替换，因为它们无论如何都不会触发任何操作），并且我在 infoWindow 上添加了一个带有 2 个真实但透明的按钮的透明 UIView。这些按钮将触发动作。

最后，我使用了一些委托方法或 KVC，以便在 infoWindow 本身移动时移动覆盖的 UIView。

```
- (UIView *)mapView:(GMSMapView *)mapView markerInfoWindow:(GMSMarker *)marker {
    [self.actionOverlayCalloutView removeFromSuperview];
    UIView *calloutView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, infoWindowWidth, infoWindowHeight)];

    float offset = anchorSize * M_SQRT2;
    CGAffineTransform rotateBy45Degrees = CGAffineTransformMakeRotation(M_PI_4);
    UIView *arrow = [[UIView alloc] initWithFrame:CGRectMake((infoWindowWidth - anchorSize)/2.0, infoWindowHeight - offset, anchorSize, anchorSize)];
    arrow.transform = rotateBy45Degrees;
    arrow.backgroundColor = [UIColor lightGrayColor];
    [calloutView addSubview:arrow];

    UIView *contentView = [[UIView alloc] initWithFrame:CGRectMake(0, 0, infoWindowWidth, infoWindowHeight - offset/2)];
    [contentView setBackgroundColor:[UIColor whiteColor]];

    contentView.layer.cornerRadius = 5;
    contentView.layer.masksToBounds = YES;

    contentView.layer.borderColor = [UIColor lightGrayColor].CGColor;
    contentView.layer.borderWidth = 1.0f;

    self.actionOverlayCalloutView =
    [NSKeyedUnarchiver unarchiveObjectWithData:[NSKeyedArchiver archivedDataWithRootObject:contentView]]; //hack to copy a view...
    self.actionOverlayCalloutView.backgroundColor = [UIColor lightGrayColorWithAlpha:0.5];
    self.actionOverlayCalloutView.layer.cornerRadius = 5;
    NSMutableArray *falseButtons = [NSMutableArray array];
    NSMutableArray *actionButtons = [NSMutableArray array];
    PointMapItem *pointAnnotation = marker.userData;
    if ([pointAnnotation canPerformSend]) {
        UIButton *button = [[UIButton alloc] init];
        [button setImage:[UIImage imageNamed:@"imageButton1.png"] forState:UIControlStateNormal];
        [falseButtons addObject:button];
        UIButton *activableButton = [[UIButton alloc] init];
        [activableButton addTarget:self action:@selector(onButton1Clicked) forControlEvents:UIControlEventTouchUpInside];
        [actionButtons addObject:activableButton];
    }
    if ([pointAnnotation canPerformShowDetails]) {
        UIButton *button = [[UIButton alloc] init];
        [button setImage:[UIImage imageNamed:@"imageButton1.png"] forState:UIControlStateNormal];
        [falseButtons addObject:button];
        UIButton *activableButton = [[UIButton alloc] init];
        [activableButton addTarget:self action:@selector(onButton2Clicked) forControlEvents:UIControlEventTouchUpInside];
        [actionButtons addObject:activableButton];
    }
    int buttonWidth = contentView.frame.size.width / [falseButtons count];
    int currentOffset = 0;
    for (int i=0; i<falseButtons.count; i++) {
        UIButton *falseButton = [falseButtons objectAtIndex:i];
        UIButton *activableButton = [actionButtons objectAtIndex:i];
        [falseButton setFrame:CGRectMake(currentOffset, 0, buttonWidth, contentView.frame.size.height)];
        currentOffset += buttonWidth;
        activableButton.frame = falseButton.frame;
        [activableButton setTitle:@"" forState:UIControlStateNormal];
        [self.actionOverlayCalloutView addSubview:activableButton];
        [contentView addSubview:falseButton];
    }
    [calloutView addSubview:contentView];

    CLLocationCoordinate2D anchor = [self.mapView.selectedMarker position];
    CGPoint point = [self.mapView.projection pointForCoordinate:anchor];
    point.y -= self.mapView.selectedMarker.icon.size.height + offset/2 + (infoWindowHeight - offset/2)/2;
    self.actionOverlayCalloutView.center = point;

    [self.mapView addSubview:self.actionOverlayCalloutView];
    return calloutView;
}

- (void)mapView:(GMSMapView *)pMapView didChangeCameraPosition:(GMSCameraPosition *)position {
    if (pMapView.selectedMarker != nil && self.actionOverlayCalloutView.superview) {
        CLLocationCoordinate2D anchor = [self.mapView.selectedMarker position];
        CGPoint point = [self.mapView.projection pointForCoordinate:anchor];
        float offset = anchorSize * M_SQRT2;
        point.y -= self.mapView.selectedMarker.icon.size.height + offset/2 + (infoWindowHeight - offset/2)/2;
        self.actionOverlayCalloutView.center = point;
    } else {
        [self.actionOverlayCalloutView removeFromSuperview];
    }
}

- (void)mapView:(GMSMapView *)mapView didTapAtCoordinate:(CLLocationCoordinate2D)coordinate {
    [self.actionOverlayCalloutView removeFromSuperview];
}

- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context {
    if ([keyPath isEqualToString:@"mapView.selectedMarker"]) {
        if (!self.mapView.selectedMarker) {
            [self.actionOverlayCalloutView removeFromSuperview];
        }
    }
}

- (void)onButton2Clicked {
    //your code
    self.mapView.selectedMarker = nil;
}

- (void)onButton1Clicked {
    // your code;
    self.mapView.selectedMarker = nil;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-18T15:47:50.020

**CustomInfoWindow 上按钮处理的**Swift 3.0 解决方案****

 **[https://stackoverflow.com/a/40681031/3933302](https://stackoverflow.com/a/40681031/3933302)

更多详细信息请访问此博客

[自定义和交互式谷歌地图（IOS SDK）信息窗口](http://kevinxh.github.io/swift/custom-and-interactive-googlemaps-ios-sdk-infowindow.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-11-24T06:22:31.150

1) 创建一个要在 infoWindow 中显示的子视图。2）设置子视图的框架等于infoWindow视图的框架。

```
 subView =  [[[NSBundle mainBundle] loadNibNamed:@"viewName" owner:self options:nil] objectAtIndex:0];
  [subView setFrame:infoview.frame];
  [self.mapview addSubview:subView]; 
```**

# batch-file - Asterisk 在 for 循环中不起作用

> ID：15537210
> 
> 赞同：0
> 
> 时间：2013-03-21T00:14:13.133
> 
> 标签：batch-file, cmd

我正在构建代码。我似乎无法让 for 循环“*.map”中的星号工作？这有什么原因吗？是因为它们是另一个循环`for`内的循环吗？`findstr``for`

谢谢！

```
SETLOCAL ENABLEDELAYEDEXPANSION

for /f "delims=" %%A in (Marks.txt) do (
  set var1=!var1!%%A

  findstr /e "!var1!" "*.map" 

  if not errorlevel 1 (
    for /f "tokens=2 delims==,." %%B in ('findstr /e "!var1!" *.map') do (
      set var2=!var2!%%B

      set /a linecount+=1
      if !linecount! GEQ %maxlines% GOTO part2
    )

:part2
    for /f "tokens=4 delims==,." %%C in ('findstr /e "!var1!" *.map') do (
      set var3=!var3!%%C
      if !linecount! GEQ %maxlines% GOTO exitloop
    )
  ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:04:20.397

你错过了一个结束的父母

# validation - 根据用户语言而不是在 JVM 上显示 JSF2 消息？

> ID：15537212
> 
> 赞同：0
> 
> 时间：2013-03-20T23:40:14.177
> 
> 标签：validation, jsf, internationalization

我正在使用 JSF2，我有一个注册表单。用户可以切换语言（英语...）。我通过使用配置文件 faces-config.xml 中的资源包来管理不同的语言。到目前为止，一切都很好。

这是注册表的一部分：

```
 <h:outputLabel value="#{bundle.RegistrationLabel_email}" for="username" />
                        <h:inputText id="username" value="#{registrationController.current.username}" label="#{bundle.RegistrationTitle_email}" title="#{bundle.RegistrationTitle_email}" size="40" required="true" requiredMessage="#{bundle.CreateUserRequiredMessage_username}">
                            <f:validator validatorId="emailValidator" />
                            <f:validateLength maximum="60" />
                        </h:inputText> 
```

我使用 JSF2 验证器来验证输入大小，这是一个 JSF2 功能：

```
 <f:validateLength maximum="60" /> 
```

如果大小大于 60，它将向用户显示一条错误消息，在这种情况下，消息的语言取决于 JVM。

我想要那个 JSF2，根据用户语言而不是在 JVM 上显示它的消息。

无论 JVM 如何管理 JSF2 消息？

# .net - 以小块复制文件

> ID：15537214
> 
> 赞同：3
> 
> 时间：2013-03-21T00:14:22.220
> 
> 标签：.net, vb.net, visual-studio, file-io, chunks

我想以小块复制文件（如果需要取消复制操作）。

我正在尝试遵循此处未标记的解决方案：[如何复制具有取消复制功能的文件？](https://stackoverflow.com/questions/7680640/how-to-copy-a-file-with-the-ability-to-cancel-the-copy)

但我得到一个 0 字节的文件

我做错了什么？

```
Public Class Form1

   Dim cancelled As Boolean = Nothing
   Dim input = New System.IO.FileStream("C:\1.txt", System.IO.FileMode.Open, System.IO.FileAccess.Read, System.IO.FileShare.Read)
   Dim output = New System.IO.FileStream("C:\Nueva carpeta\1.txt", System.IO.FileMode.CreateNew, System.IO.FileAccess.Write, System.IO.FileShare.Write)

   Public Sub CopyStream(ByVal inputStream As System.IO.Stream, ByVal outputStream As System.IO.Stream)
       'Dim buffer = System.IO.File.ReadAllBytes("C:\1.txt")

       Dim buffer = New Byte((1024) - 1) {}
       Dim bytesRead As Integer = 1

       While (inputStream.Read(buffer, 0, buffer.Length) > 0)
           outputStream.Write(buffer, 0, bytesRead)
           'bytesRead += 1

           If cancelled Then
               MsgBox("operacion cancelada")
               Return
           End If
       End While

       inputStream.Close()
       outputStream.Close()
       MsgBox("operacion terminada")

   End Sub

   Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
       CopyStream(input, output)
   End Sub

End Class 
```

**

> 更新 1：

**

我尝试按照 Virtlink answer 的步骤将缺失的部分放入我的原始代码中，但我仍然得到一个零字节文件。

```
> Public Class Form1

    Dim input = New System.IO.FileStream("C:\Test.txt", System.IO.FileMode.Open, System.IO.FileAccess.Read, System.IO.FileShare.Read)
    Dim output = New System.IO.FileStream("C:\Test_New.txt", System.IO.FileMode.CreateNew, System.IO.FileAccess.Write, System.IO.FileShare.Write)

    Public Sub CopyStream(ByVal inputStream As System.IO.Stream, ByVal outputStream As System.IO.Stream)

        Dim buffer = New Byte(1024) {}
        Dim bytesRead As Integer

        ' Read some bytes
        While (bytesRead = inputStream.Read(buffer, 0, buffer.Length) > 0)
            ' Write them to the output
            outputStream.Write(buffer, 0, bytesRead)
        End While

    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        CopyStream(input, output)
    End Sub

End Class 
```

**

> 更新 2：

**

> 我最近失败的尝试：

```
 Public Class Form1

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click

        Dim input_filepath As String = "C:\Test.txt", output_filepath As String = "C:\Test_New.txt"

        Dim input = New System.IO.FileStream(input_filepath, System.IO.FileMode.Open, System.IO.FileAccess.ReadWrite)
        Dim output = New System.IO.FileStream(output_filepath, System.IO.FileMode.Create, System.IO.FileAccess.ReadWrite)

        CopyStream(input, output)

        ' For Testing:
        If New IO.FileInfo(output_filepath).Length = 0 Then IO.File.Delete(output_filepath) : Application.Exit() Else Process.Start("Notepad", output_filepath)

    End Sub

    Public Sub CopyStream(ByVal inputStream As System.IO.Stream, ByVal outputStream As System.IO.Stream)

        Dim buffer = New Byte(1024) {}, bytesRead As Integer

        While ((bytesRead = inputStream.Read(buffer, 0, buffer.Length)) > 0)
            outputStream.Write(buffer, 0, bytesRead)
        End While

        inputStream.Flush() : outputStream.Flush()
        inputStream.Close() : outputStream.Close()

    End Sub

End Class 
```

**

> 更新 3：

**

> 解决方案

问题出在 VB.NET 中，我无法在循环条件中为变量赋值，所以这是工作 Sub：

```
 Public Sub CopyStream(ByVal inputStream As Stream, ByVal outputStream As Stream)

    Dim buffer = New Byte(1025) {}
    Dim bytesRead As Integer = 0

    Do
        bytesRead = inputStream.Read(buffer, 0, buffer.Length)
        If bytesRead > 0 Then
            outputStream.Write(buffer, 0, bytesRead)
        End If
    Loop While (bytesRead > 0)

    outputStream.Flush()
    inputStream.Close() : outputStream.Close()

End Sub 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-22T01:45:37.167

你必须了解你在做什么以及它是如何工作的。

首先，您分配一个缓冲区。

```
Dim buffer = New Byte(1024) {} 
```

然后你去从输入流中读取一些数据。数据被放入`buffer`, 从`0`, 最多`buffer.Length`字节开始。该方法返回它*实际*读取并放入缓冲区的字节数。

```
bytesRead = inputStream.Read(buffer, 0, buffer.Length) 
```

如果您读取的字节数大于 0，那么您还没有到达文件末尾。

```
While (bytesRead > 0) 
```

然后，您将读取的那些字节（`bytesRead`字节）准确地写入输出流。从 写入字节`buffer`，从索引开始`0`并写入`bytesRead`字节数。

```
outputStream.Write(buffer, 0, bytesRead) 
```

由于出于效率原因，流将缓冲您编写的内容，因此您必须刷新并关闭输出流。

```
outputStream.Flush()
outputStream.Close() 
```

把它放在一起：

```
Dim buffer = New Byte(1024) {}
Dim bytesRead As Integer

' Read some bytes
While ((bytesRead = inputStream.Read(buffer, 0, buffer.Length)) > 0)
    ' Write them to the output
    outputStream.Write(buffer, 0, bytesRead)

    If cancelled Then
        MsgBox("operacion cancelada")
        Return
    End If

    ' Repeat
End

outputStream.Flush()
outputStream.Close() 
```

[上一次写VB是十多年前的事了。您必须确保语法正确。]

* * *

注意原始代码如何包含这一行：

```
While ((bytesRead = inputStream.Read(buffer, 0, buffer.Length)) > 0) 
```

你看到那个`bytesRead =`部分了吗？您还没有将其复制到您的代码中。必须存储读取的字节数。

* * *

最终代码：这适用于我的电脑：

```
Imports System
Imports System.IO

Namespace ConsoleApplication1
    Friend Class Program
        Private Shared Sub Main(args As String())
            Program.CopyMyFiles()
            Console.WriteLine("DONE!")
            Console.ReadLine()
        End Sub

        Private Shared Sub CopyMyFiles()
            Dim input_filepath As String = "Test.txt"
            Dim output_filepath As String = "Test_New.txt"
            Dim input As FileStream = New FileStream(input_filepath, FileMode.Open, FileAccess.ReadWrite)
            Dim output As FileStream = New FileStream(output_filepath, FileMode.Create, FileAccess.ReadWrite)
            Program.CopyStream(input, output)
        End Sub

        Public Shared Sub CopyStream(inputStream As Stream, outputStream As Stream)
            Dim buffer As Byte() = New Byte(1025)
            Dim bytesRead As Integer
            bytesRead = inputStream.Read(buffer, 0, buffer.Length)
            While bytesRead > 0
                outputStream.Write(buffer, 0, bytesRead)
                bytesRead = inputStream.Read(buffer, 0, buffer.Length)
            End While
            outputStream.Flush()
            inputStream.Close()
            outputStream.Close()
        End Sub
    End Class
End Namespace 
```

# ruby - “没有这样的文件或目录 - config.ru”与Passenger + Sinatra + Apache

> ID：15537216
> 
> 赞同：1
> 
> 时间：2013-03-21T00:14:50.943
> 
> 标签：ruby, apache, sinatra, passenger, vhosts

我似乎无法确定问题出在哪里，但我似乎无法将我的应用程序部署到子 URI。我的直觉说它在我的虚拟主机配置和我的符号链接之间，但这是我第一次广泛使用虚拟主机和乘客。

当我尝试点击[http://example.com/app](http://example.com/app)时，我遇到了乘客错误...

```
No such file or directory - config.ru 
```

它显示应用程序根：

```
/home/username/public/example.com/public 
```

就其他一切而言……网站的目录结构：

```
example.com/
    |-- public/
        |-- index.php
        |-- app/
            |-- config.ru         
            |-- app.rb      
            |-- public/           
            `-- tmp/              
                `-- restart.txt 
```

/etc/apache2/sites-available/example.com 中的虚拟主机：

```
# domain: example.com
# public: /home/username/public/example.com/

<VirtualHost *:80>
  # Admin email, Server Name (domain name), and any aliases
  ServerAdmin email@example.com
  ServerName  www.example.com
  ServerAlias example.com

  # Index file and Document Root (where the public files are located)
  DirectoryIndex index.html index.php
  DocumentRoot /home/username/public/example.com/public
   <Directory /home/username/public/example.com/public>
      Allow from all
   </Directory>

  RackBaseURI /app
  <Directory /home/username/public/example.com/public/app>
      Options -MultiViews
  </Directory>

  # Log file locations
  LogLevel warn
  ErrorLog  /home/username/public/example.com/log/error.log
  CustomLog /home/username/public/example.com/log/access.log combined
</VirtualHost> 
```

我制作的符号链接：

```
ln -s /home/username/public/example.com/public/app/public /home/username/public/example.com/app 
```

配置.ru：

```
#!/usr/bin/env ruby
require 'sinatra'

require File.expand_path('app.rb',__FILE__)

run Sinatra::Application 
```

和 app.rb：

```
#!/usr/bin/env ruby
# encoding: UTF-8
require 'sinatra'

get '/' do
    "App!"
end 
```

不太确定这里可能出了什么问题，但我在这个 VPS 上有多个站点，所以目录结构有点时髦，有这么多公共文件夹。我可能会混淆自己。

# java - 添加到列表时需要使用“新”吗？

> ID：15537220
> 
> 赞同：3
> 
> 时间：2013-03-21T00:15:15.357
> 
> 标签：java, list

我是 Java 新手，并试图弄清楚在将条目添加到列表时是否需要传递一个类的新实例，如下所示：

```
CCustEntry entry = new CCustEntry();
List<CCustEntry> CustList = new ArrayList<CCustEntry>();
do
{
    // set all entry fields
    entry.id = [...];
    [fill other fields of entry from DB]

    // add entry (constructor copies entry)
    CustList.add( new CCustEntry( entry ) );

} while( C.moveToNext() == true ); 
```

或者...我可以删除 new 并简单地将条目传递给 add() 方法，如下所示：

> ```
>  CustList.add( entry ); 
> ```

我一直在阅读有关列表的内容，但我比以前更加困惑。来自 Delphi 和 C++，我对语法很好，但 Java 的一些“语法”仍然让我摸不着头脑。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:18:29.517

这取决于条目是否会被修改。听起来你有一个 bean 对条目进行了浅拷贝，所以如果`entry`要修改的字段，那么你应该添加一个副本。否则，构建一个新的只是浪费内存。

在这里，您似乎在整个循环中使用相同的条目，因此您需要制作一个副本。否则，整个列表将包含相同的对象 - 即，每个项目都是相同的对象。

另一条评论：在 Java 中，通常以小写字母开头命名字段和值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T00:18:35.473

这取决于：如果您不是每次都创建一个新实例，那么您将多次将*同一个实例添加到列表中。*这意味着如果您在列表的一个索引处修改一个元素，那么所有其他元素也将以相同的方式被修改（因为它们都是同一个实例）。`new`如果您想要不同但相等的实例，那么您必须每次都创建一个。

# ios - 导航控制器不显示视图

> ID：15537221
> 
> 赞同：1
> 
> 时间：2013-03-21T00:15:23.747
> 
> 标签：ios, uiview, uiviewcontroller, uinavigationcontroller

PS：请不要建议我使用应用代理方式，因为我将在我的应用程序视图中使用它。谢谢。

我尝试使用 a`UINavigationController`来显示一个`UITableView` 喜欢的`settings`应用程序。所以我试图一步一步开始。到目前为止，我尝试在导航堆栈中显示包含在视图控制器中的视图。但我在某处遗漏了一些东西。

这是我的相关代码：

**`.h file:`**

```
@interface ViewController : UINavigationController{

    UINavigationController *navigationController;
    UIViewController *viewController;
}

@property(nonatomic, strong)IBOutlet UINavigationController *navigationController;
@property(nonatomic, strong)IBOutlet UIViewController *viewController;
@end 
```

**.m 文件：**

```
@implementation ViewController
@synthesize navigationController;
@synthesize viewController;

- (void)viewDidLoad
{
    [super viewDidLoad];
    //Do any additional setup after loading the view, typically from a nib.

    self.viewController = [[UIViewController alloc]init];

    self.navigationController = [[UINavigationController alloc] initWithRootViewController:self.viewController];

    [self.navigationController.view addSubview:self.viewController.view];

}

**The xib file:** 
```

![在此处输入图像描述](../Images/66ddefd641a57cfab5f896f1fa43eeed.png)

当我运行应用程序时，我希望看到蓝色视图，但我看到的只是默认的蓝色导航栏，甚至没有“根视图控制器”标题消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:48:17.317

如果您从 IB 连接 UI，请尝试删除这些行（delete alloc, init）

```
//  self.viewController = [[UIViewController alloc]init];
//  self.navigationController = [[UINavigationController alloc] initWithRootViewController:self.viewController];
//  [self.navigationController.view addSubview:self.viewController.view]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-25T21:17:33.767

此链接应该对您有所帮助。您可能想通过这个来更好地了解您遇到的问题。

[https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/Introduction/Introduction.html](https://developer.apple.com/library/ios/#documentation/iPhone/Conceptual/SecondiOSAppTutorial/Introduction/Introduction.html)

# blackberry - 以编程方式关闭/打开网络

> ID：15537223
> 
> 赞同：0
> 
> 时间：2013-03-21T00:15:43.463
> 
> 标签：blackberry

我正在尝试访问网络状态以将其关闭或打开。
我已经编写了代码来获取网络使用的状态，`RadioInfo`但我不知道如何打开/关闭它们。我已经研究了`Radio`API `RadioInfo`，但我找不到允许我控制网络的 API。这是我获取网络状态的代码：

```
    私人布尔 GetRadInfo() {
        if(RadioInfo.getState() == RadioInfo.STATE_ON)
        {
            返回真；
        }
        别的{
            返回假；
        }
    }

```

有什么想法如何关闭/打开？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:22:00.483

**解决了**我用`Radio.deactivateWAFs(int);`

# java - 方法 onLocationChanged

> ID：15537226
> 
> 赞同：0
> 
> 时间：2013-03-21T00:15:48.190
> 
> 标签：java, android, google-maps, locationmanager

我正在尝试在当前位置更改时运行一种方法。每次当前位置更改时，它都会计算距离，然后将其显示在文本视图中。

```
public GoogleMap googleMap;
@Override
public void onCreate(Bundle savedInstanceState) {

    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

  //  final MediaPlayer mPlayer = MediaPlayer.create(FakeCallScreen.this, R.raw.mysoundfile);

 // Getting Google Play availability status
    int status = GooglePlayServicesUtil.isGooglePlayServicesAvailable(getBaseContext());

    // Showing status
    if(status!=ConnectionResult.SUCCESS){ // Google Play Services are not available

        int requestCode = 10;
        Dialog dialog = GooglePlayServicesUtil.getErrorDialog(status, this, requestCode);
        dialog.show();

    }else { // Google Play Services are available
        // Getting reference to the SupportMapFragment of activity_main.xml
        SupportMapFragment fm = (SupportMapFragment) getSupportFragmentManager().findFragmentById(R.id.map);
        // Getting GoogleMap object from the fragment
        googleMap = fm.getMap();
        // Enabling MyLocation Layer of Google Map
        googleMap.setMyLocationEnabled(true);
        // Getting LocationManager object from System Service LOCATION_SERVICE
        LocationManager locationManager = (LocationManager) getSystemService(LOCATION_SERVICE);
        // Creating a criteria object to retrieve provider
        Criteria criteria = new Criteria();
        // Getting the name of the best provider
        String provider = locationManager.getBestProvider(criteria, true);
        // Getting Current Location
        Location location = locationManager.getLastKnownLocation(provider);

        if(location!=null){
            onLocationChanged(location);    
            locationManager.requestLocationUpdates(provider, 20000, 0, (LocationListener) this); 

        Location marker = new Location("");
        marker.setLatitude(lat);
        marker.setLongitude(long1);

        if(select==false){
            TextView t = (TextView) findViewById(R.id.tv_location);
            t.setText("Please select a marker" + lat + long1);
            Toast.makeText(this, "not selected", Toast.LENGTH_LONG).show();

        } else if(select==true){

            float distanceBetweenPoints = location.distanceTo(marker);
            TextView t = (TextView) findViewById(R.id.tv_location);
            t.setText("Distance to station is "+ distanceBetweenPoints);
            Toast.makeText(this, "Distance is "+distanceBetweenPoints, Toast.LENGTH_LONG).show();

            if(distanceBetweenPoints<1000){
            //do something
        }

    }
} 
```

和 onInfoWindow 代码

```
googleMap.setOnInfoWindowClickListener(
    new OnInfoWindowClickListener(){
        public void onInfoWindowClick(Marker marker) {

            LatLng clickedMarkerLatLng = marker.getPosition();
            lat =  clickedMarkerLatLng.latitude;
            long1 =  clickedMarkerLatLng.longitude;
            String name = marker.getTitle();
            select=true;

            TextView t = (TextView) findViewById(R.id.tv_location);
            t.setText("Location of "+ name +" is "+ lat + " by " + long1); 
```

当位置发生变化时，我将如何进行此运行？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:39:43.667

您应该将您的类声明为
`public MyClassName extends Activity implements LocationListener`
然后将您的代码放入`onLocationChanged`

# sql-server-2008 - 帮助“过程或函数指定了太多参数”错误

> ID：15537228
> 
> 赞同：1
> 
> 时间：2013-03-21T00:15:51.483
> 
> 标签：sql-server-2008, stored-procedures

我需要第二双眼睛。当我尝试调用有问题的存储过程时，我的 C# 代码中出现了该错误。

我们正在运行 SQL Server 2008，这是我的 C# 代码和存储过程设置：

```
 SqlConnection oConn = null;
            string Name = "Frank";
            bool IsEmp = true;
            int RID = 31;

    oConn = SQLConnectionHelper.GetConnection(SQLConnectionHelper.OurDB);

    var sqlParams = new SqlParameter[3];
    sqlParams[0] = new SqlParameter("@RID", RID);
    sqlParams[1] = new SqlParameter("@Name", Name);
    sqlParams[2] = new SqlParameter("@IsEmp", IsEmp);

    SqlHelper.ExecuteNonQuery(oConn, CommandType.StoredProcedure, "dbo.OurStoredProc", sqlParams); 
```

存储过程的开始：

```
ALTER PROCEDURE [dbo].[OurStoredProc]
(
    @RID            INT,    
    @Name           nvarchar(20),
    @IsEmp          BIT
)
As

BEGIN TRANSACTION 
```

我在这里想念什么？

# php - 使用 javascript 数组从 PHP/MySQL 填充选择菜单

> ID：15537232
> 
> 赞同：0
> 
> 时间：2013-03-21T00:16:03.750
> 
> 标签：php, javascript, mysql

我有这个代码：

```
<script>
var values = <?php
$sql="SELECT * FROM billing_sagenominalcodes order by code ASC";
$rs=mysql_query($sql,$conn) or die(mysql_error());
$nominalcodes = array();
while($result=mysql_fetch_assoc($rs))
{
    $nominalcodes[] = $result['code'];
}
echo json_encode($nominalcodes);
?>;
</script>

<select name="sagenominalcode" id="sagenominalcode">
<script>addOptions(document.getElementById('sagenominalcode'), values);</script>
</select> 
```

它完全按照我的需要工作，但我想知道是否可以在选择选项以及代码中显示数据库中的列名“名称”？

例如，而不仅仅是

123

像这样

123 - 名称

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:27:27.340

你会想要严格地分开你的 php 和你的 js。编写代码的方式将按原样工作，但*非常*脆弱，并且可能会发生灾难性的破坏，从而导致[远距离操作](http://en.wikipedia.org/wiki/Action_at_a_distance_%28computer_science%29)风格的错误。

例如，如果您的数据库架构被重构以删除该`code`列，那么您的 javascript 将被破坏，其原因是没有人会怀疑的。

* * *

也就是说，如果您还想`name`在选择选项的列中显示数据，您还必须将该数据传递到其中`$nominalcodes`。现在，它包含一个索引数据数组（可能是 an`int`或 a `string`），但您需要更改它，使其包含一个索引数组。

所以，之前：

```
$nominalcodes = array(1,3,5,78,3,2,234); 
```

之后：

```
$nominalcodes = array(
    array(1, 'foobar'),
    array(3, 'larry'),
    array(5, 'bob'),
    ...
); 
```

此时，您必须重构您的 javascript`addOptions`函数，以便它可以正确解析数组数组，而不是单个值数组。

# arrays - 使此代码中的每个变量 Dynamic Visual Basic 2010

> ID：15537235
> 
> 赞同：0
> 
> 时间：2013-03-21T00:16:17.490
> 
> 标签：arrays, vb.net, checkbox

对不起，很长的一段代码。在我正在设计的游戏中，我的代码从 checkbox.checked if 语句开始，对于每个单击的复选框，当前重复 5 次——每个复选框等于游戏中玩家手中的一张牌。

我想知道的是我能做些什么来让它变得更有活力。即 CardCheckBox1.Checked 对象/方法。如上所述，代码重复了 5 次，因为我有 5 个现有复选框。有没有办法将复选框放入数组或集合中，所以当我单击复选框并点击播放按钮时，它相当于点击 CardCheckBox2.checked = true、CardCheckBox2.checked = true 等。一旦我弄清楚如何为了使该部分动态化，我终于可以开始使其余代码动态化，因为我假设制作动态标签代码的过程与复选框等非常相似。

我有过

```
Dim CardCheckBoxArray() As CheckBox = {CardCheckBox1, CardCheckBox2, CardCheckBox3, CardCheckBox4, CardCheckBox5} 
```

在模块化级别、Form_Load 过程甚至 Play_Button 过程中发布，但我总是在 CardCheckBox(n).Checked 部分出现空引用异常

```
If CardCheckBoxArray(0).Checked = True And Player1HandGroup(Number1).QuantityInteger > 0 Then 
```

所以我不知道该去哪里。长一段代码是我的整个 PlayButton_Click 过程，除了其他 CardCheckBox if 语句。

```
Private Sub PlayButton_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles PlayButton.Click
        Dim n As Integer
        Dim WeaponDiscardInteger As Integer = 1
        AtkPlayerDialog.ShowDialog()
        'Code for choosing which player to attack
        If AtkPlayerDialog.DialogResult = Windows.Forms.DialogResult.Cancel Then
            n = 2
        ElseIf AtkPlayerDialog.DialogResult = Windows.Forms.DialogResult.OK Then
            n = 1
        ElseIf AtkPlayerDialog.DialogResult = Windows.Forms.DialogResult.Abort Then
            n = 3
        ElseIf AtkPlayerDialog.DialogResult = Windows.Forms.DialogResult.Retry Then
            n = 4
        ElseIf AtkPlayerDialog.DialogResult = Windows.Forms.DialogResult.Ignore Then
            n = 5
        End If

'playing card 1
        If CardCheckBox1.Checked = True And Player1HandGroup(Number1).QuantityInteger > 0 Then
            'Subtract Hitpoints when damage is delt
            Player1HandGroup(n).HitPoints -= Player1HandGroup(Number1).DamageInteger
            HitPoints1.Text = Player1HandGroup(1).HitPoints.ToString
            HitPoints2.Text = Player1HandGroup(2).HitPoints.ToString
            HitPoints3.Text = Player1HandGroup(3).HitPoints.ToString
            HitPoints4.Text = Player1HandGroup(4).HitPoints.ToString
            HitPoints5.Text = Player1HandGroup(5).HitPoints.ToString
            'When player plays hand, card quantity is removed from hand to discard pile.
            Player1HandGroup(Number1).QuantityInteger -= 1
            DiscardGroup(Number1).QuantityInteger += 1
            'Shuffle Deck from Discard Pile if Deck is out of cards
            Call DiscardPile()
            'Reset Number Generator, unless weapon isn't discard
            Number = (DeckGroup(Rnd.Next(0, DeckGroup.Count)).ID)
            If DeckGroup(Number).QuantityInteger > 0 Then
                'Grab New Card From Deck
                DeckGroup(Number).QuantityInteger -= 1
                Player1HandGroup(Number).QuantityInteger += 1
                Card1Type = Player1HandGroup(Number).CardType
                CardCheckBox1.Text = Player1HandGroup(Number).CardNameString
                Number1 = Number
            Else
                Call PlayElse()
            End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:31:41.783

如果您在大多数表单代码中/通过大多数表单代码使用复选框数组，则将其从表单加载事件中移出直到表单级别范围。当它在 forn_load 事件子例程内时，与模块级范围不同。

所以你会有......

```
Dim CardCheckBoxArray() As CheckBox = {CardCheckBox1, CardCheckBox2, CardCheckBox3, CardCheckBox4, CardCheckBox5}

Sub Form_Load(blah blah blah)
  ...
End Sub

Sub Play_Button(blah blah blah)
  ...
End Sub 
```

等等等等

# mysql - MySQL - 计算与最近访问相关的事务

> ID：15537240
> 
> 赞同：0
> 
> 时间：2013-03-21T00:16:39.493
> 
> 标签：mysql, sql, group-by

假设我在同一个 MySQL DB 中有两个表：

第一个是 inbound_campaign_visit 表。它看起来像这样。

```
+----+------------+------------------+------------- --------+
| 编号 | 用户 ID | 入站活动 | 日期 |
+----+------------+------------------+------------- --------+
| 1 | 1 | 1 | 2013-02-18 13:00:00 |
| 2 | 1 | 2 | 2013-02-24 13:00:00 |
| 3 | 2 | 3 | 2013-01-01 01:00:00 |
| 4 | 2 | 2 | 2013-02-24 19:00:00 |
+----+------------+------------------+------------- --------+

```

每次用户通过点击促销活动访问我的网站时，都会在此表上生成一行。“日期”列代表他们来到该站点的时间。

第二张表是我的交易表。

```
+--------+---------+---------+
| 编号 | 用户 ID | 创建日期 |
+--------+---------+---------+
| 321639 | 1 | 2013-02-18 14:00:00 |
| 321640 | 1 | 2013-02-24 15:00:00 |
| 321641 | 1 | 2013-02-25 13:00:00 |
| 321642 | 1 | 2013-04-05 12:00:00 |
| 321643 | 2 | 2013-01-01 12:00:00 |
| 321644 | 2 | 2013-02-23 12:00:00 |
+--------+---------+---------+

```

每当发生事务时，都会在此表上创建一行。“creation_date”列表示事务发生的时间。

我想创建一个报告来计算每个入站活动的交易数量。必须适用以下规则：

1.  如果 user_id 值与交易的值匹配并且交易发生在创建 inbound_campaign_visit 行的 30 天内，则认为交易与入站活动相关。
2.  事务只能应用于给定用户的最新入站campaign_visit。

结果表应如下所示：

```
+------------------+------------------+
| 入站活动 | 交易计数 |
+------------------+------------------+
| 1 | 1 |
| 2 | 2 |
| 3 | 1 |
+------------------+------------------+

```

请注意，事务 321644 和 321642 不计入规则 1，因为它们不符合规则 1。还要注意事务 321641 如何仅适用于 inbound_campaign 2 而不是 inbound_campaign 1（即使两个活动都在规则 1 中定义的 30 天限制范围内）。

我已经为此苦苦挣扎了一段时间，因此将不胜感激。当然我可以在代码中做到这一点，但必须有一种方法可以在 SQL 中做到这一点。TIA。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:26:45.863

```
SELECT  a.inbound_campaign,
        COUNT(b.user_ID) TotalCount
FROM    inbound_campaign_visit a
        LEFT JOIN transaction b
            ON a.user_ID = b.user_ID AND
               DATEDIFF(CURDATE(), b.creation_date) > 30
GROUP   BY a.inbound_campaign 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/c8629/10)

# java - 在安卓屏幕上绘制和创建画布

> ID：15537241
> 
> 赞同：0
> 
> 时间：2013-03-21T00:16:53.970
> 
> 标签：java, android, bitmap, android-canvas, ondraw

代码将通过一个数组运行。如果在数组中看到字符“X”，它将在屏幕上的相应位置绘制矩形。

问题是实际上并没有在屏幕上绘制颜色。一些 android 网站谈到了如何需要画布、位图等。

我的问题：**我需要做什么才能让 drawRect 方法中的颜色真正显示在屏幕上？**

```
package com.example.routedrawingtest;

import android.app.Activity;
import android.graphics.Canvas;
import android.graphics.Color;
import android.graphics.Point;
import android.os.Bundle;
import android.view.Display;
import android.graphics.Paint;
import android.view.View;

public class MainActivity extends Activity {
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    float scale_x;
    float scale_y;

    public void main(String[] args){
        @SuppressWarnings("unused")
        Display display = getWindowManager().getDefaultDisplay();
        Point size = new Point();

        int screen_width = size.x;
        int screen_height = size.y;
        scale_x = screen_width/125;
        scale_y = screen_height/100;

    }

    public void onDraw(Canvas canvas) { 

        int i;
        Paint paint = new Paint();
        paint.setColor(Color.RED);
     paint.setStrokeWidth(10);
        int j;

        for (i=0; i<125; i++)
            for (j=0; j<100; j++)
                if (charMap[i][j]=='X')

                canvas.drawRect(i*scale_x, j*scale_y, scale_x,scale_y, paint);
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-16T05:07:58.210

该方法`onDraw`不被调用`Activity`来做你想做的事，你需要扩展类 View 并在那里实现该方法。在您将视图添加到父视图时了解更多信息之前，您必须为其指定明确的大小，`fill_parent`否则它不会显示在屏幕上。例如：

```
 public class Drawer extends View
    {
        Paint paint =  new Paint();

         public Drawer()
         {
             paint.setStyle(Style.STROKE);
             paint.setStrokeColor(Color.BlUE);
             // etc...

         }

    public void onDraw(Canvas canvas)
    {
      for (i=0; i<125; i++)
        for (j=0; j<100; j++)
            if (charMap[i][j]=='X')

            canvas.drawRect(i*scale_x, j*scale_y, scale_x,scale_y, paint);
    } 

    } 
```

通过 XML 或通过代码（例如使用它的完全限定名称）将视图添加到您的代码中：

XML:

```
 <com.example.comp.Drawer
      android:layout_width="fill_parent"<<<< specify a size
       etc...
     /> 
```

# python - 从网站获取 csv 数据

> ID：15537245
> 
> 赞同：4
> 
> 时间：2013-03-21T00:17:11.420
> 
> 标签：python, csv, python-3.x

如何使用 Python下载和读取[本网站上的 CSV 数据：](http://earthquake.usgs.gov/earthquakes/feed/csv/1.0/hour)

[http://earthquake.usgs.gov/earthquakes/feed/csv/1.0/hour](http://earthquake.usgs.gov/earthquakes/feed/csv/1.0/hour)

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-21T00:19:58.363

这取决于你想对数据做什么。如果您只是想下载数据，您可以使用[urllib2](http://docs.python.org/2/library/urllib2.html)。

```
import urllib2

downloaded_data  = urllib2.urlopen('http://...')

for line in downloaded_data.readlines():
    print line 
```

如果您需要解析[csv](http://en.wikipedia.org/wiki/Comma-separated_values)，您可以使用[urrlib2](http://docs.python.org/2/library/urllib2.html)和[csv](http://docs.python.org/2/library/csv.html)模块。

**蟒蛇2.X**

```
import csv
import urllib2

downloaded_data  = urllib2.urlopen('http://...')
csv_data = csv.reader(downloaded_data)

for row in csv_data:
    print row 
```

**Python 3.X**

```
import csv
import urllib.request

downloaded_data  = urllib.request.urlopen('http://...')
csv_data = csv.reader(downloaded_data)

for row in csv_data:
    print(row) 
```

# c++ - 在 C++ 中解析/拆分数据

> ID：15537251
> 
> 赞同：-1
> 
> 时间：2013-03-21T00:18:24.173
> 
> 标签：c++, parsing

我从带有头部和尾部的传感器发送 6 个数据，数据之间带有 (,)

```
$data0,data1,data2,data3,data4,data5%. 
```

我想解析/排序这些数据并成为：

```
y0=data0
y1=data1... 
```

怎么做？我使用 Visual Studio C++ 2010。

我的程序是：

```
#include <iostream>
#include <string>
#include <sstream>
#include "stdafx.h"
using namespace std;

int main()
  {
string str = "$data1,data2,data3,data4,data5,data6%";
string word;
stringstream stream(str);
while( getline(stream, word, ',') )
cout << word << "\n";
 } 
```

价值是

```
$data1
data2
data3
data4
data5
data6% 
```

如何擦除头部和尾部，以及如何使缓冲区中的数据

```
Y1=data1
y2=data2
 ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:39:29.937

This code shows how it can be done:

```
#include <iostream>
#include <sstream>
#include <string>
#include <vector>

int main() {
    std::string s("$data0,data1,data2,data3,data4,data5%");

    s.erase(0, 1); // Remove header.
    s.erase(s.size() - 1, 1); // Remove tail.

    // Parse tokens.
    std::vector<std::string> tokens; // Vector will store tokens.
    std::istringstream iss(s);
    for (std::string token; std::getline(iss, token, ',');) {
        tokens.push_back(token);
    }

    // Output tokens.
    for (const auto& t : tokens) {
        std::cout << t << std::endl;
    }
} 
```

Output:

```
data0
data1
data2
data3
data4
data5 
```

# javascript - 将数据从 javascript 传递到 Flask

> ID：15537254
> 
> 赞同：16
> 
> 时间：2013-03-21T00:18:36.663
> 
> 标签：javascript, python, flask, jinja2

我知道如何使用 jinja 模板将数据从 python 传递到 javascript，但我想将 javascript 变量传递给 python。我想在不重新加载页面的情况下做到这一点。那可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T01:51:22.247

是的，就像蒙库特所说的那样——我相信你想使用 JSON 和 Javascript/jQuery。

这将允许从客户端到服务器的通信并再次返回。

我发现的最适用的例子是在 Flask 片段/模式中：http: [//flask.pocoo.org/docs/patterns/jquery/](http://flask.pocoo.org/docs/patterns/jquery/)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2016-06-21T13:11:46.027

我在我的项目中做了类似的工作，并想在这里分享我的代码。我需要找出选择了哪个帖子，并且我将所选帖子设置为服务器端的全局变量，以便我可以将其用于以后的比较。这就是我将我选择的帖子传递给 Javascript 的方式。

```
<a class="label label-primary"  onclick="myFunction({{very.id}})" > Compare</a> 
```

现在从 Javascript 到 Flask。

```
function myFunction(x) {
        $.getJSON($SCRIPT_ROOT + '/check_selected', {
        post: x
        }, function(data) {
            var response = data.result;
            console.log(response);
            }
        });
} 
```

这就是我使用 JSON 从烧瓶返回结果的方式。

```
import json
@main.route('/check_selected', methods=['GET','POST'])
def check_selected():
    global selected
    post = request.args.get('post', 0, type=int)
    return json.dumps({'selected post': str(post)}); 
```

[如此处](http://flask.pocoo.org/docs/0.11/patterns/jquery/)所述，我们需要包含 Google AJAX API 才能加载 jquery：

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="{{
  url_for('static', filename='jquery.js') }}">\x3C/script>')</script> 
```

* * *

## 回答 #3

> 赞同：-3
> 
> 时间：2013-03-31T07:55:38.510

从您的视图代码创建一个 JSON 字符串，`jsonData`然后在您的 Jinja 模板中，编写类似

```
<script type="text/javascript">
    var data = {{ jsonData }};
</script> 
```

# c++ - 使用来自不同项目的命名空间的 C++“未解析的外部符号”

> ID：15537255
> 
> 赞同：1
> 
> 时间：2013-03-21T00:18:44.797
> 
> 标签：c++, namespaces, linker-errors

我有两个项目（称它们为 Test 和 Intrados）。在 Intrados 中，我有以下命名空间：

```
#include "Mapper.h"
#include "Director.h"
#include "Driver.h"
#include <iostream>
#include <string>
using namespace std;

namespace IntradosMediator {
    void addVehicle(string);
}

void IntradosMediator::addVehicle(string vehicleName) {
    Mapper* mapper = Mapper::getInstance();
    mapper->addVehicle(vehicleName);
} 
```

在 Intrados 项目中，调用“IntradosMediator::Mapper(addVehicle)”就可以了；然而，在项目测试中，以下代码会产生链接错误：

```
#include "IntradosMediator.cpp"
#include "Mapper.h"
using namespace IntradosMediator;

int main(){
    IntradosMediator::addVehicle("Car X");
    return 0;
} 
```

错误是：

```
Test.obj : error LNK2019: unresolved external symbol "public: static class Mapper *
 __cdecl Mapper::getInstance(void)" (?getInstance@Mapper@@SAPAV1@XZ) referenced in 
function "void __cdecl IntradosMediator::addVehicle(class std::basic_string<char,struct 
std::char_traits<char>,class std::allocator<char> >)" 
(?addVehicle@IntradosMediator@@YAXV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@
std@@@Z) 
```

我确保将 Intrados 添加为 Test 的参考，并将其包含在 Include Directories 中。不知道在这里做什么，因为我是 C++ 新手。提前感谢您的任何建议。

**编辑：** 我在这里添加映射器代码：

```
//.h
#ifndef MAPPER_H
#define MAPPER_H
#include <string>
using std::string;

class Mapper {
public:
    static Mapper* getInstance();
    void addVehicle(string);
private:
    //this is a singleton
    Mapper(){};
};
#endif

//.cpp
#include "Mapper.h"
#include <vector>
#include <iostream>
#include <string>
using namespace std;

vector<string> vehicleList;

Mapper* Mapper::getInstance(){
    static Mapper instance;
    return &instance;
}

void
Mapper::addVehicle(string vehicleName) {
    vehicleList.push_back(vehicleName);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:24:27.697

错误说链接器找不到`Mapper::getInstance`（它似乎找到你的`addVehicle`函数就好了）。您可能没有在链接中包含实现“映射器”的库吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:31:44.563

你能粘贴你的类 Mapper 的代码吗？似乎您在该类中缺少 addVehicle 函数，这是编译器所抱怨的。

# qt - QTableView 的单元格是空的，但标题显示

> ID：15537259
> 
> 赞同：0
> 
> 时间：2013-03-21T00:19:28.203
> 
> 标签：qt, delegates, qtableview

我创建了一个几乎从 Qt 的 Spin Box Delegate Example 复制的委托，并且我正在尝试填充 QTableView。但是，我遇到了一个奇怪的问题，表格标题显示但单元格为空且无法单击。

![QTableView 和委托的问题](../Images/9f1e5ecf41ecd7395560133a4c306677.png)

代表代码：

```
#include "double_spinbox_delegate.h"

DoubleSpinBoxDelegate::DoubleSpinBoxDelegate(QObject *parent) : QItemDelegate(parent){}

QWidget *DoubleSpinBoxDelegate::createEditor(QWidget *parent, const QStyleOptionViewItem &option, const QModelIndex &index) const{
    QDoubleSpinBox *editor = new QDoubleSpinBox(parent);
    editor->setValue(0);

//    if (index.column() == 0){
//        editor->setMinimum(0);
//        editor->setMaximum(255);
//    }
//    else{
//        editor->setMinimum(0);
//        editor->setMaximum(1);
//    }

    return editor;
}

void DoubleSpinBoxDelegate::setEditorData(QWidget *editor, const QModelIndex &index) const{
    double value = index.model()->data(index, Qt::EditRole).toDouble();

    QDoubleSpinBox *doubleSpinBox = static_cast<QDoubleSpinBox*>(editor);
    doubleSpinBox->setValue(value);
}

void DoubleSpinBoxDelegate::setModelData(QWidget *editor, QAbstractItemModel *model, const QModelIndex &index) const{
    QDoubleSpinBox *doubleSpinBox = static_cast<QDoubleSpinBox*>(editor);
    doubleSpinBox->interpretText();
    double value = doubleSpinBox->value();

    model->setData(index, value, Qt::EditRole);
}

void DoubleSpinBoxDelegate::updateEditorGeometry(QWidget *editor, const QStyleOptionViewItem &option, const QModelIndex &index) const{
    editor->setGeometry(option.rect);
} 
```

以及我在表单构造函数中调用的函数

```
void MainWindow::InitializeColorTable(){
    QTableView *tableColor = ui->tableColor;

    QStandardItemModel *model = new QStandardItemModel(4, 4, ui->tableColor);
    // QStandardItemModel *model = this->colorTableModel;
    tableColor->setModel(model);

    DoubleSpinBoxDelegate delegate;
    tableColor->setItemDelegate(&delegate);

    model->setHorizontalHeaderLabels(QStringList() << tr("Value") << tr("R") << tr("G") << tr("B"));

    for (int row = 0; row < model->rowCount(); ++row){
        for (int col = 0; col < model->columnCount(); ++col){
            QModelIndex index = model->index(row, col, QModelIndex());
            model->setData(index, QVariant((row + 1.0) * (col + 1.0)), Qt::EditRole);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T02:54:39.263

您的委托在堆栈上分配，并在超出范围后被删除。

```
DoubleSpinBoxDelegate delegate;
tableColor->setItemDelegate(&delegate); 
```

改为使用 new 创建您的委托。

# mysql - MySQL全文：有一个结果更重

> ID：15537264
> 
> 赞同：0
> 
> 时间：2013-03-21T00:19:43.833
> 
> 标签：mysql, full-text-search

我有一个城市和州的数据库（大约 43,000 个）。我对它进行全文搜索，如下所示：

```
select city, state, match(city, state_short, state) against (:q in boolean mode) as score
from zipcodes where
match(city, state_short, state) against (:q in boolean mode)
group by city, state order by score desc limit 6 
```

当我`:q`用有意义的字符串替换时，它可以工作，但假设我搜索`houston texas`，我希望结果是第一个，但它是第 3 个：

*   `North Houston, Texas`
*   `South Houston, Texas`
*   `Houston, Texas`

我怎样才能使`Houston, Texas`体重比其他两个重？这显然对于其他类似的城市也应该是一样的。

**编辑**

这行得通，有什么想法吗？

```
SELECT * FROM (
    SELECT city, state, MATCH(city, state_short, state) AGAINST (:q IN BOOLEAN MODE) as score
    FROM zipcodes
    WHERE MATCH(city, state_short, state) AGAINST (:q IN BOOLEAN MODE)
    GROUP BY city, state
    ORDER BY score DESC LIMIT 6
) AS tbl
ORDER BY score DESC, LENGTH(city) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T14:16:21.113

您的新查询可能有效，但这完全是间接的。而不是做`ORDER BY LENGTH(city)`，类似的事情`ORDER BY ABS(LENGTH(:q) - (LENGTH(city) + LENGTH(state)))`会更好。这并不完美，但它应该会更好，因为任何与输入具有相同长度和高分的东西可能就是您正在寻找的东西。最终查询看起来像这样：

```
SELECT city, state, MATCH(city, state_short, state) AGAINST (:q IN BOOLEAN MODE) AS score
FROM zipcodes
WHERE MATCH(city, state_short, state) AGAINST (:q IN BOOLEAN MODE)
GROUP BY city, state
ORDER BY score DESC, ABS(LENGTH(:q) - (LENGTH(city) + LENGTH(state))) DESC LIMIT 6 
```

我将新`ORDER BY`子句移到主查询中以删除子查询。这应该会产生相同（或可能更准确）的结果。

Levenshtein 距离可能是对此更准确的度量，但在 MySQL 中没有它的本机实现。 [这篇文章](https://stackoverflow.com/questions/4671378/levenshtein-mysql-php)有更多关于 Levenshtein Distance 函数的 MySQL 实现的信息。

# google-tv - 在 Google TV 中访问用户对电视提供商的设置？

> ID：15537267
> 
> 赞同：0
> 
> 时间：2013-03-21T00:20:01.890
> 
> 标签：google-tv

有没有办法访问用户在设置 Google TV 时指定的电视提供商？例如，我的邮政编码设置包括 Comcast、Dish、DirecTV 等电视提供商。

我的应用复制了这个设置小部件，因为它也需要知道用户的电视提供商。相反，我想向 Google TV 系统询问用户已经进行的设置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-25T22:51:58.063

提供者的 URI 已在最新更新中从**content://com.google.android.tv.provider/devices**更改为**content://com.google.tv.mediadevicesapp.MediaDevicesProvider/devices**

```
 DEVICE_ID = "device_id";   // like Atsc01
 LINEUP_ID = "lineup_id";   // like TMS:OTA94043
 DEFAULT = "is_default";    // 0 or 1  -- Also changed from "default" 
```

自从我在去年的发行说明中提到它以来，我在这里回答这个问题。由于使用这是一个罕见的用例，因此无法保证我们会长期支持它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:45:44.253

您无法获取服务提供商信息，但可以获取位置。使用“静态”位置提供程序从设备设置期间配置的邮政编码获取位置：

```
LocationManager locationManager = (LocationManager) this.getSystemService(Context.LOCATION_SERVICE);
Location location = locationManager.getLastKnownLocation("static");
Geocoder geocoder = new Geocoder(this);
Address address = null;
try {
  address = geocoder.getFromLocation(location.getLatitude(), location.getLongitude(), 1).get(0);
  Log.d("Zip code", address.getPostalCode());
} catch (IOException e) {
  Log.e(TAG, "Geocoder error", e);
} 
```

清单中需要“android.permission.ACCESS_COARSE_LOCATION”权限。

# facebook-opengraph - 通过 API 引入新客户的正确工作流程（我们是 PMD 合作伙伴）

> ID：15537269
> 
> 赞同：1
> 
> 时间：2013-03-21T00:20:09.860
> 
> 标签：facebook-opengraph, ads

我们正在积极开发我们的 PMD 广告管理工具。我们有许多想要做广告但没有任何类型的 Facebook 帐户的客户。我有一个两部分的问题：

(1) 它们是否是我们为客户创建适当用户帐户的 API/编程方式，以便客户可以依次登录到他们的新 Facebook 帐户并输入广告支付信息？例如，我可以想象一个像这样的开放图调用：

`createFBUserAccount(f_name:"Joe",l_name:"Smith",email:"joesmith@gmail.com",isbusiness:"false");`

或为一个人

`createFBUserAccount(business_entity_name:"ACME Corp",email:"contact@acmecorp.com",isbusiness:"true");`

(2) 对于不想要 Facebook 帐户但仍想通过我们在 Facebook 上做广告的用户，创建广告的正确方法是什么？假设这是一家有兴趣购买外部网站广告（或移动应用安装，或任何数量的其他广告单元）的企业。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-31T22:59:33.337

我们目前无法通过 API 创建广告帐户。用户必须直接通过[https://www.facebook.com/advertising](https://www.facebook.com/advertising)创建一个帐户。

我们也有商业账户（文档：[https](https://www.facebook.com/help/131976240210052) ://www.facebook.com/help/131976240210052 ）

我们需要用户帐户或企业帐户才能与我们一起做广告。

希望这会有所帮助。

# html - 反馈表单 HTML 文件意外结束 PHP

> ID：15537271
> 
> 赞同：0
> 
> 时间：2013-03-21T00:20:21.773
> 
> 标签：html, file, post, printing

此 php 文件看似正确，但返回“文件意外结束”错误。是 html 文件中某处的错误。我尝试将标签放在“”中的 print 中，删除了 php 行上的一个额外空格，在变量行上的括号 [] 和引号''之间添加了空格，当我按 enter 时仍然有相同的错误将数据发送到 php 脚本。这是html代码： http: [//pastebin.com/Rb62pZcy](http://pastebin.com/Rb62pZcy)

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>Your Feedback</title>
</head>
<body>
<?php // Script 3.3 handle_form.php
// This page receives the data from feedback.html
// It will receive: title, name, email, comments in $_POST

$title = $_POST [ 'title' ] ;
$name = $_POST [ 'name' ] ;
$email = $_POST [ 'email' ] ;
$comments = $_POST [ 'comments' ] ;

print "<p>Thank you, $title $name, for your comments.</p>"
"<p>You stated that you found this example to be '$response' and added:<br />$comments</p>"

?>
</body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:56:20.507

而不是这个：

```
print "<p>Thank you, $title $name, for your comments.</p>"
"<p>You stated that you found this example to be '$response' and added:<br />$comments</p>" 
```

用这个：

```
echo "<p>Thank you, $title $name, for your comments.</p>";
echo "<p>You stated that you found this example to be '$response' and added:<br />$comments</p>"; 
```

我想你错过了“;” 特点。

- - - - - - - - - 更新 - - - - - - - - - - - - - - -

我尝试这段代码并且有效：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>Your Feedback</title>
    </head>
    <body>
    <?php 

    if (isset($_POST['email'])){
    $title = $_POST['title'];
    $name = $_POST['name'];
    $email = $_POST['email'];
    $comments = $_POST['comments'];
    }
    else
    {
     $title = "No title arrived";
     $name = "No name arrived";
     $comments = "No comments arrived";
    }

    //$response is not defined??
    $response = "Live long and prosper";
    //so i defined

    echo "<p>Thank you, $title $name, for your comments.</p>";
    echo "<p>You stated that you found this example to be '$response' and added:<br />$comments</p>";
    ?>
    </body>

    </html> 
```

PS：尝试单独执行此脚本...将其命名为“handle_form.php”并将其放在导航地址栏中：

```
localhost/your_project/handle_form.php 
```

在我的本地主机上工作.....如果您的问题继续存在，那么问题可能出在提交页面中。

萨卢多斯。

# c++ - 函数中的参数化变量类型（c ++）

> ID：15537272
> 
> 赞同：0
> 
> 时间：2013-03-21T00:20:24.427
> 
> 标签：c++, function, variables, arguments, parameterized

我正在尝试按照以下方式写一些东西：

```
void setData<T>(char * environmentVariable, T &data, T defaultValue)
{
    bool ret = false;
    // Try to get the environmentVariable
    ret = handle.getParam(environmentVariable, data);
    if(!ret)
    {
        data = defaultValue
    }
}

int main()
{
    int valOne;
    float valTwo;

    // Get a value of type int
    setData("some_int_value", valOne, 10);  // 10 is the default value

    // Get a value of type float
    setData("some_float_value", valTwo, 0.05f);  // 0.05 is the default value

} 
```

一种方法是使用 va_list。有没有办法我可以通过一个类来完成这个？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:26:16.510

我猜你几乎在那里：

```
template<typename T>
void setData(char * environmentVariable, T &data, T defaultValue)
{
    // ...
} 
```

这应该做你想要的。但是请注意，`T`最后两个参数使用相同，因此此函数调用将无法推断`T`：

```
setData("some_float_value", valTwo, 0.05); 
```

因为`0.05`是 a `double`，while`valTwo`是浮点数。在类型推导期间，不会执行类似的转换，因为编译器正在尝试匹配*确切的*类型。

不过，这很容易解决：

```
setData("some_float_value", valTwo, 0.05f); 
//                                      ^ 
```

`f`后缀使最后一个参数是类型的纯右值，`float`因此`T`可以推导出为`float`。

* * *

可能，您可能希望第二个和第三个参数允许不同的类型，只要第三个可以转换为第二个即可。在这种情况下，您可以重新定义函数模板，如下所示：

```
template<typename T, typename U>
void setData(char * environmentVariable, T &data, U defaultValue)
{
    // ...
} 
```

但是，请注意，这将使您可以自由地`setData()`使用*任何*两种类型`T`和进行实例化`U`，而您可能希望您的模板仅针对`U`可转换为`T`s 的 s 进行实例化。一些 SFINAE 技巧与`std::is_convertible<>`类型特征相结合将完成这项工作：

```
#include <type_traits>

template<typename T, typename U,
         typename std::enable_if<
             std::is_convertible<U, T>::value
             >::type* = nullptr>
void setData(char * environmentVariable, T &data, U defaultValue)
{
    // ...
} 
```

现在您甚至可以使用原始调用而不会出现编译器错误：

```
setData("some_float_value", valTwo, 0.05); 
//                                  ^^^^ 
```

# php - 显示数组中的唯一链接

> ID：15537281
> 
> 赞同：0
> 
> 时间：2013-03-21T00:21:18.917
> 
> 标签：php, arrays

我有一个函数显示数组中的随机横幅：

```
//func.php
function rand_rek($rek_array){
$numberOfBanners = count($rek_array);
$numberOfBanners = $numberOfBanners - 1;
$randomBanner = rand(0,$numberOfBanners);
$rek = $rek_array[$randomBanner];
return $rek;
} 
```

我有`$reklamas`数组，其中包含 3 个横幅：

```
//ads.php
$reklamas = array($rek1, $rek2, $rek3); 
```

如果 $_GET["noa"] 不是真的，我想向 $reklamas 数组添加更多横幅：

```
if (!isset($_GET["noa"]))
array_push($reklamas, $rek_adc1, $rek_adc2, $rek_adc3, $rek_adc4); 
```

我想显示一个随机横幅 x 次：

```
for ($i=0;$i<$banneri;$i++) {
    echo rand_rek($reklamas);
    } 
```

问题：这些可以重复多次`array($rek1, $rek2, $rek3);`，而这些`array_push($reklamas, $rek_adc1, $rek_adc2, $rek_adc3, $rek_adc4);`只能显示1次。

函数 rand_rek() 在 func.php 中，它包含在 ads.php 中，其余代码在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T19:56:18.230

我认为您可能完全错误地解决了这个问题，但无论如何，解决方案可能是

```
function rand_rek($rek_array){
    $numberOfBanners = count($rek_array);
    $numberOfBanners = $numberOfBanners - 1;
    $randomBanner = rand(0,$numberOfBanners);
    $rek = $rek_array[$randomBanner];
    return [$randomBanner, $rek];
}

list($bannerNum, $banner) = rand_rek($reklamas);
if ($bannerNum < 3) {
    $repeats = $x;
} else {
    $repeats = 1;
}

for ($i=0;$i<$repeats;$i++) {
    echo $banner;
} 
```

它检索横幅的索引并在运行循环之前对其进行检查。我还使用了您`$x`在文本中但未在代码中提到的值。

# android - 在 SQLite 查询中使用变量

> ID：15537282
> 
> 赞同：1
> 
> 时间：2013-03-21T00:21:19.290
> 
> 标签：android, sqlite

首先，我查找了几个关于此的主题，但没有专门解决 Java 中的这个问题。

我有以下方法。

```
public String getCount() {
    SQLiteDatabase db = smokinDBOpenHelper.getWritableDatabase();
    String w = "Home";
    Cursor cursor = db.rawQuery("select * from " + smokinDBOpenHelper.INCIDENTS_TABLE + 
            " where " + KEY_LOCATION + " = 'Home'", null);

    int i = cursor.getCount();
    String s = ("You have " + i + " entries in this column");

    return s;
} 
```

我希望它`query`使用它上面的变量而不是特定的硬编码`String`“Home”。

我已经尝试过`+ {w}` `+ {w%}` `+ w`和其他一些，似乎没有任何工作

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:24:29.847

尝试

```
Cursor cursor = db.rawQuery("select * from " + smokinDBOpenHelper.INCIDENTS_TABLE + 
        " where " + KEY_LOCATION + " = '" + w + "'", null); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T00:27:04.797

最好使用您在 rawQuery 方法中设置为 null 的 selectionArgs 参数。

可以在这里找到一个示例[rawQuery(query, selectionArgs)](https://stackoverflow.com/questions/10598137/rawqueryquery-selectionargs)

# php - 防止搜索滥用

> ID：15537283
> 
> 赞同：1
> 
> 时间：2013-03-21T00:21:20.743
> 
> 标签：php, search, optimization, bots

我无法在谷歌上搜索有关此主题的有用信息，因此我将不胜感激涉及该主题的文章的链接或此处的直接答案，两者都可以。

我正在一个有很多访问者的网站上用 PHP/MySQL 实现搜索系统，所以我将对允许访问者在搜索字段中输入的字符长度和所需的最短时间实施一些限制在两次搜索之间。由于我对这些问题有点陌生，而且我真的不知道为什么通常这样做的“真正原因”，所以我只是假设实现字符最小长度以最小化数据库将返回的结果数量，并实施搜索之间的时间，以防止机器人向搜索系统发送垃圾邮件并减慢网站速度。那正确吗？

最后，如何实现两次搜索之间的最短时间的问题。我用伪代码提出的解决方案是这样的

1.  在提交搜索表单的 URL 处设置测试 cookie
2.  将用户重定向到应输出搜索结果的 URL
3.  检查测试cookie是否存在
    *   如果不是，输出一个警告，他不允许使用搜索系统（可能是机器人）
4.  检查是否存在告知上次搜索时间的 cookie
    *   如果这不到 5 秒前，输出一个警告，他应该在再次搜索之前等待
5.  搜索
6.  将上次搜索时间设置为当前时间的 cookie
7.  输出搜索结果

这是最好的方法吗？

我理解这意味着禁用 cookie 的访问者将无法使用搜索系统，但如今这真的是个问题吗？我找不到 2012 年的统计数据，但我设法找到数据表明 3.7% 的人在 2009 年禁用了 cookie。这似乎并不多，我想这些天可能会更少。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:33:20.140

"only my assumptions that the character minimum length is implemented to minimize the number of results the database will return". Your assumption is absolutely correct. It reduces the number of potential results, by forcing the user to think about, what it is they wish to search.

As far as bots spamming your search, you could implement a [captcha](http://en.wikipedia.org/wiki/CAPTCHA), the most frequently used is [recaptcha](http://www.google.com/recaptcha). If you don't want to show a captcha right away, you can track (via session) the number of times the user submitted search, and if X amount of searches occur within a certain time frame, then render the captcha.

I've seen sites like SO and thechive.com implement this type of strategy, where captcha isn't rendered right away, but will be rendered if a threshold is encountered.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:33:27.837

This way you're preventing Search Engine from indexing your search results. A cleaner way of doing this would be:

1.  Get IP where search originated
2.  Store that IP in a cache system such as memcached and the time that query was made
3.  If another query is sent from same IP and less then x second passed simply reject it or make the user wait

Another thing you can do to increase performance is to take a look at analytics and see which queries are made most often and cache those so when a request comes in you serve the cached version and not make a full db query, parsing, etc...

Another naive option would be to have a script run 1-2 times a day running all common queries and create static HTML files that users hit when making particular search queries instead of hitting the db.

# ios - 在 Safari 中打开 WebView 链接

> ID：15537289
> 
> 赞同：0
> 
> 时间：2013-03-21T00:22:01.647
> 
> 标签：ios, uiwebview, uiwebviewdelegate

运行应用程序时，它首先加载，然后在 safari 中加载网页。我将如何使页面加载并在 safari`UIWebView`中打开外部链接？`webView`

这是 webviewcontroller.m 的一些代码 -

```
#import "WebViewController.h"

@implementation WebViewController

@synthesize webView;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil {
if (self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil]) {
    // Initialization code
}
return self;
}

/*
 If you need to do additional setup after loading the view, override viewDidLoad. */
- (void)viewDidLoad {

NSString *urlAddress = @"url link goes here";

//Create a URL object.
NSURL *url = [NSURL URLWithString:urlAddress];
[[UIApplication sharedApplication] openURL:url];

//URL Requst Object
NSURLRequest *requestObj = [NSURLRequest requestWithURL:url];

//Load the request in the UIWebView.
[webView loadRequest:requestObj];
} 
```

@结尾

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-09T13:57:31.310

第一个页面在 Safari 中而不是`UIWebView`在您的应用程序中加载的原因是这行代码：

```
[[UIApplication sharedApplication] openURL:url]; 
```

`viewDidLoad`从您的方法中删除此行。

为了在 Safari 应用程序的负载中创建链接，首先在方法内部将`webView`视图控制器设置为 webView 的委托。`webView.delegate = self;``viewDidLoad`

然后将以下代码添加到您的`viewController`：

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {

    if (navigationType == UIWebViewNavigationTypeLinkClicked)
    {
        [[UIApplication sharedApplication] openURL:request.URL];
        return NO;
    }
    return YES;
} 
```

每次`webView`即将开始加载请求时都会调用此方法。它的作用是检查请求是否由用户单击发起。如果是这样，它会打开 Safari 并在那里加载请求。任何其他不是由单击发起的请求都将加载到您的应用程序中，例如对您的起始页的请求。

# java - 为什么我不能正确解析字符串数组？

> ID：15537292
> 
> 赞同：-3
> 
> 时间：2013-03-21T00:22:22.670
> 
> 标签：java, arrays, string, parsing

我在解析字符串时遇到问题；我似乎无法找出为什么我的字符串数组的值不等于它们应该的值！这可能看起来很奇怪，所以这里是代码的简化版本（应用程序要大得多，所以我只是做了一个小程序来解释我的观点）

```
public class Test {

public static void main(String[] args) {

    String src = "beep zap derp flop";
    String delims = "[ ]+";
    String[] tokens = src.split(delims);

    if (tokens[0] == "beep") {
        System.out.println("you said beep!");
    } else {

               for (int i = 0; i < tokens.length; i++) {
                    System.err.println("'" + tokens[i] + "'");
               }
          }
     }
} 
```

我的输出是

```
'beep'
'zap'
'derp'
'flop' 
```

我知道令牌 [0] 是哔哔声，但 Java 似乎没有注意到。有什么我做错了吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T00:23:44.797

你不应该使用`==`运算符来比较`Strings`Java 中的内容。当与`Objects`such一起使用时`Strings`，`==`运算符会比较*引用*是否相等。换句话说，只有当两个引用都指向同一个对象时，`==`才会返回`true`对象。如果你有两个*不同的* `String`对象，那么即使内容相同`==`也会返回。`false`

用于[`String#equals`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equals(java.lang.Object))比较`Strings`. 此方法将`String`逐个字符比较对象的内容，以确定内容是否相同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T02:14:02.960

在 Java 中，您必须使用`equals`方法来比较两个字符串。例如，如果要与 比较`String a`，`String b`可以说`if (a.equals(b))`。`==`运算符检查两个字符串是否是对同一对象的引用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T00:24:56.980

您应该使用`.equals`比较字符串。

*equals*方法检查字符串的实际内容，`==`运算符检查两个对象是否引用同一个实例。

```
String.equals(String other) 
```

看到这个：http: [//blogs.adobe.com/cantrell/archives/2003/04/how_equals_work.html](http://blogs.adobe.com/cantrell/archives/2003/04/how_equals_work.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T05:41:47.677

公共类测试{

```
public static void main(String[] args)    {
String src = "beep zap derp flop";
String delims = "[ ]+";
String[] tokens = src.split(delims);

if ("beep".equals(tokens[0]))
{
    System.out.println("you said beep!");
} 
else
{

           for (int i = 0; i < tokens.length; i++) {
                System.err.println("'" + tokens[i] + "'");
           }
      }

} 
```

}

# delphi - TWebResponse 没有解析我发布的文件

> ID：15537296
> 
> 赞同：3
> 
> 时间：2013-03-21T00:22:37.860
> 
> 标签：delphi, rest, post, delphi-xe3

我有一个简单的 DataSnap REST 服务器，在 TWebModule 上我添加了一个动作来监听路径“/upload_file”上的 POST 请求。在 onAction 事件中，我有以下代码：

```
procedure TWebModule.WebModulePostFileAction(Sender: TObject;
  Request: TWebRequest; Response: TWebResponse; var Handled: Boolean);
var i: Integer;
  str: String;
begin
  for i :=0 to Request.Files.Count-1 do
  Begin
    Str:= Str +','+ Request.Files.Items[i].FileName;
    // I will like to save or move the uploaded file to i.e. c:\myFiles\
  End;
  Response.Content:= Str;
end; 
```

Request.Files.Count 始终为 0，但是当我检查 Request.content 对象时，我可以看到多部分文件内容。如何从请求中获取发布的文件？并将其保存在磁盘中的某个位置。
我发布的 HTML 表单如下所示：

```
<form action="/upload_file" method="POST" enctype="multipart/form-data">
  Notes: <input type="text" name="notes"/>
  File: <input type="file" name="my_file"/>
  <input type="submit" value="Submit">
</form> 
```

不幸的是，没有太多关于这个主题的信息，我已经尝试了几个小时但没有成功。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T10:32:44.900

See related question [TIdHTTPServer file upload](https://stackoverflow.com/questions/6191402/tidhttpserver-file-upload) and answer [https://stackoverflow.com/a/6197138/80901](https://stackoverflow.com/a/6197138/80901):

> TIdHTTPServer does not currently support multipart/form-data submissions natively. That is on the todo list for Indy 11\. In the meantime, you have to parse the posted MIME data manually using TIdDecoderMIME, as mjn suggested. There have been examples of that posted in the Embarcadero and Indy forums before.

# tkinter - 使用 python 绑定 Tk Canvas 上的线条/椭圆的事件

> ID：15537298
> 
> 赞同：1
> 
> 时间：2013-03-21T00:22:50.397
> 
> 标签：tkinter, mouseevent, python-2.x

这是一个地图导航应用程序。也许这个功能是现成的，但从头开始构建它将是一个非常丰富的学习练习。Windows XP 下的 Python 2.6。

作为 OO 设计，我有一个基于 tk.canvas 的地图类，它是可滚动的。这将通过从 openstreetmap 下载图块来获取其背景，我对此没有任何问题（目前）。地图滚动得很好。

作为地图的子项创建的是可编辑路径类的多个实例。此类将包含加载/保存/编辑/显示路径所需的所有功能。路径是坐标元组的列表。坐标显示为圆圈，它们之间的边缘显示为线。我希望能够将圆圈拖到新位置。

如果可能的话，我希望它是无模式的。因此，当我不在路径上时，拖动会滚动地图。当我在路径上时，并且 activefill 显示我在，我编辑路径。

我开始在尝试 vertex_drag 函数中注释掉的语句时遇到问题。首先，在我试图移动顶点的地方，我收到错误数量的参数错误，得到 2 而不是预期的 0 或 4，并且地图拖动。在第二个中，我确实在似乎正确的地方找到了新圈子的踪迹，但地图仍在拖动。

我需要做的是在拖动顶点时抑制地图滚动。我用谷歌搜索并发现断言，如果我在第一个事件处理程序中放置中断，则事件不会从小部件向下传播到父级。但是，如果我这样做，python 会抱怨我在循环外使用了 break。那是因为椭圆不是小部件而是其他东西，还是我一直在错误地查看 3.0 文档？

我该如何做到这一点，以保持地图和路径处理之间的良好客观分离？我想我可以想到一些可能的方法，在两者之间有一些笨拙的东西。

```
import Tkinter as tki

class Map(tki.Canvas):
    """ will implement a scrollable by dragging slippy map background"""
    def __init__(self, parent):
        tki.Canvas.__init__(self, parent)        
        self.config(height=600, width=600, xscrollincrement=1,yscrollincrement=1)

        self.bind('<ButtonPress-1>',self.grab)
        self.bind('<ButtonRelease-1>',self.release)
        self.bind('<B1-Motion>',self.drag)

        # before we get the map, this will do
        for x in range(-500, 500, 100):
            for y in range(-500, 500, 100):
                self.create_text((x,y), anchor=tki.CENTER, text='{0} {1}'.format(x,y), activefill = 'red')       

    def grab(self,event):
        self._y = event.y
        self._x = event.x
        self.config(cursor='fleur')

    def release(self,event):
        self.config(cursor='arrow')

    def drag(self, event):
        self.yview('scroll',self._y-event.y,'units')
        self.xview('scroll',self._x-event.x,'units')
        self._y = event.y
        self._x = event.x

class Path():
    """ maintains an edittable path as a sequence of coordinates, drawn on the map"""
    def __init__(self, parent, route):
        self.parent=parent
        self.path=route
        self.draw_path(self.path)        

    def draw_path(self, path):
        """ draws the list of coordinates supplied in the arguments
        creates a list of edges and vertices, binding them to handlers"""

        self.vs=[]
        V_RAD=7
        self.edges=[]
        LINE_WIDTH=3

        (xl, yl)=self.path[0]
        self.vs.append(self.parent.create_oval(xl-V_RAD, yl-V_RAD, xl+V_RAD, yl+V_RAD, activefill='blue', tag='vertex'))

        for (xn, yn) in self.path[1:]:
            self.vs.append(self.parent.create_oval(xn-V_RAD, yn-V_RAD, xn+V_RAD, yn+V_RAD, activefill='blue', tag='vertex'))
            self.edges.append(self.parent.create_line(xl, yl, xn, yn, activefill='blue', width=LINE_WIDTH, tag='edge'))
            (xl, yl)= (xn, yn)

        self.parent.tag_bind('vertex', '<ButtonPress-1>', self.vertex_click)
        self.parent.tag_bind('vertex', '<B1-Motion>', self.vertex_drag)
        self.parent.tag_bind('vertex', '<ButtonRelease-1>', self.vertex_release)
        self.parent.tag_bind('edge', '<ButtonPress-1>', self.edge_click)        

    def vertex_click(self,event):
        print 'vertex clicked ', event
        cx=self.parent.canvasx(event.x)
        cy=self.parent.canvasy(event.y)        
        d=self.parent.find_closest(cx,cy)[0] # closest returns a 1-tuple of an ID, not an ID
        print 'we think ',d, ' is the one thats clicked'
        self.moving_vertex=d
        print event.widget

    def vertex_drag(self,event):
        print 'vertex dragging ', event
        cx=self.parent.canvasx(event.x)
        cy=self.parent.canvasy(event.y)
        print cx,cy

        # self.parent.coords(self.moving_vertex,(cx,cy))
        # self.parent.create_oval(cx-5, cy-5, cx+5, cy+5)

        self.parent.update_idletasks()

    def vertex_release(self,event):
        print 'vertex released ', event

    def edge_click(self, event):
        print 'edge clicked', event     

if __name__ == '__main__':

    root=tki.Tk()
    background_map=Map(root)
    background_map.pack()
    route1=[(10,20), (100,100), (100,0), (150, -30), (100, -100)]
    path=Path(background_map, route1)    
    root.mainloop() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:59:11.367

在对`self.parent.coords`commented in的调用中`vertex_drag`，您将偏移量作为元组传递。实际上，在 4 个预期参数中，您必须将画布算作第一个 ( `self`)，再加上另外三个参数：项目的 ID、水平偏移量和垂直偏移量。

```
self.parent.move(self.moving_vertex, dx, dy) 
```

要忽略事件处理程序，您不必使用`break`语句，而是在事件处理程序中返回字符串`"break"`。但是，在这种情况下，您可以做一些更简单的事情：`False`在您单击该项目时设置一个标志，并`True`在您释放它时再次设置它：

```
class Map(tki.Canvas):
    def __init__(self, parent):
        tki.Canvas.__init__(self, parent)
        self.can_drag = True
        #...

    def drag(self, event):
        if self.can_drag:
            self.yview('scroll',self._y-event.y,'units')
            self.xview('scroll',self._x-event.x,'units')
            self._y = event.y
            self._x = event.x

class Path():
    #...

    def vertex_click(self,event):
        self.parent.can_drag = False
        cx=self.parent.canvasx(event.x)
        cy=self.parent.canvasy(event.y)
        d=self.parent.find_closest(cx,cy)[0] # closest returns a 1-tuple of an ID, not an ID
        self.offset = cx, cy
        self.moving_vertex = d

    def vertex_drag(self,event):
        cx = self.parent.canvasx(event.x)
        cy = self.parent.canvasy(event.y)
        dx = cx-self.offset[0]
        dy = cy-self.offset[1]
        self.parent.move(self.moving_vertex, dx, dy)
        self.offset = cx, cy

    def vertex_release(self,event):
        self.parent.can_drag = True 
```

# sql - 交点计数返回意外值

> ID：15537301
> 
> 赞同：0
> 
> 时间：2013-03-21T00:23:33.323
> 
> 标签：sql, sql-server, tsql, count

我必须要表格，比如 A 和 B 以及一个**不可为空**的公共列 X 。

查询一：

```
SELECT COUNT(*)
FROM A
WHERE A.X in                       
(SELECT distinct(B.X) FROM B) 
```

查询 2：

```
SELECT COUNT(*)
FROM B
WHERE B.X in
(SELECT distinct(X) FROM A) 
```

查询 3：

```
SELECT COUNT(*)
FROM A, B
WHERE A.X=B.X 
```

查询 1 结果 5990。查询 2 和 3 结果 6222。删除`distinct`或检查顶部的不同计数不会更改结果。有人可以解释为什么所有查询的结果都不相同，因为它们都返回交集计数？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:34:03.123

假设 A 的值为 A B C

假设 B 的值为 A B C D E C

在这种情况下，A 的计数为 3（QRY1），而 B 的计数为 4，因为当您使用连接时 c 重复（QRY2）C 将匹配 C 的所有值是否具有比 A 更多的重复项。A 可能有重复但数量较少。4 再次 (QRY3)

# jquery - 选项卡和 Ajax 中的 jQuery EasyUI 选项卡

> ID：15537303
> 
> 赞同：3
> 
> 时间：2013-03-21T00:23:42.687
> 
> 标签：jquery, ajax, jquery-easyui

假设我在其他一些选项卡中有一些[jQuery EasyUI 选项](https://www.jeasyui.com/documentation/tabs.php)卡。单击外部选项卡时，内部选项卡通过 Ajax 加载。单击内部选项卡时，我想通过 Ajax 在单击的内部选项卡的面板中加载一些内容。我遇到的问题是，因为内部选项卡是通过 Ajax 加载的，所以我不能使用它：

```
$('.inner_tabs').tabs({
    onSelect: function(title, index){                           
        // do stuff
    }       
}); 
```

在我的内部选项卡面板中加载内容（因为内部选项卡是稍后在 DOM 中添加的（所以，`$('.inner_tabs')`甚至无法识别）。我知道通常这个问题是通过使用[`.on()`](https://api.jquery.com/on/)jQuery 的方法来解决的。但是我怎样才能将它应用到我的目前情况？如何`.on()`配合`onSelect`jQuery EasyUI的回调使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T17:44:14.860

将内部选项卡添加到 DOM**后**`success`，您需要在 ajax 请求的回调中重新初始化内部选项卡。

 **你可以这样做：

```
$('#outer_tabsid').tabs({
    onSelect: function(title, index){                           
    $.ajax({type: "POST",
       url: "ajaxurl.jsp?param="+index,                    
       success: function (response) {
       var innertabid='innerTab'+index;
       $('#outer_tabsid').tabs('add',{  
             title:'New Tab',  
             content:'<div id="'+innertabid+'" class="easyui-tabs" style= "width:500px;    height:250px;">',
          });
          $('#'+innertabid).tabs({
              onSelect: function(title1, index1){
                  // ajax call to load the selected innertab;
               }
         });

   });
    }       
}); 
```**

# javascript - 是什么删除了我注入的元素？

> ID：15537307
> 
> 赞同：0
> 
> 时间：2013-03-21T00:24:03.510
> 
> 标签：javascript, jquery, dom

我正在尝试使用 jquery 对 UI 进行原型设计，它允许在列表末尾添加一对 li 元素。第一对运行良好，但随着其他对的添加，两个较早注入的元素（li.box）中的一个消失了。页面上只会保留一个 li.box。我不知道为什么。

**HTML**

```
<ul id="ruleset" class="ruleset">
    <li class="rule"">
        <div class="text">Rule </div>
        <select name="join" class="join">
            <option value="+">+</option>
            <option value="AND">AND</option>
            <option value="OR">OR</option>
        </select>
    </li>
</ul> 
```

**Javascript**

```
$(document).ready(function(){
    var liBox=$('<li>').attr('class','box').text('>');
    $('body').on('change', 'select.join', function(){ 
        var copy=$(this).parent().clone();
        var li = $(this).parent();
        var par=li.parent();
        li.after(liBox); //an item between each rule to eventually contain controls
        par.append(copy); //a copy of the rule item
    });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:30:37.647

JQuery 实际上不会克隆 li.box，而只是移动它。所以你的代码应该是：

```
li.after(liBox.clone()); 
```

小提琴：http: [//jsfiddle.net/yqXhM/1/](http://jsfiddle.net/yqXhM/1/)

# java - 如何将 ArrayList 转换为数组数组？

> ID：15537317
> 
> 赞同：0
> 
> 时间：2013-03-21T00:25:03.927
> 
> 标签：java, arrays, collections, multidimensional-array, arraylist

我正在做我的大学二年级软件工程项目并且遇到了问题。我对 Java 语言（和一般编程）相当陌生，所以我有可能只是不太了解语法。

我有一个方法，我想用它来返回一个 Object 类型的数组。这将在摆动 JTable 中使用。因此，数组的每个元素（它们本身就是数组）是表中的行，而“内部”数组的元素是该行中每一列的值。

我不知道在编码时会有多少列，因此我制作了一个方法来生成这个依赖于其他对象的数组数组。

这是我的代码：

```
 public Object[][] getData(ArrayList<IModule> modules) {

    ArrayList<String[]> data = new ArrayList();

    for (Iterator<IModule> m = modules.iterator() ; m.hasNext(); ) {
        IModule module = m.next();
        for (Iterator<ICoursework> c = module.getCoursework().iterator() ; c.hasNext() ; ) {
            ICoursework coursework = c.next();
            String[] row = new String[6];

            row[0] = module.getModuleTitle();
            row[1] = module.getModuleCode();
            row[2] = coursework.getTitle();
            row[3] = coursework.dateToString();
            row[4] = coursework.getLecturer().getFirstName() 
                    + coursework.getLecturer().getSecondName();
            row[5] = getSubmissionDetails(coursework, row);

            data.add(row);
        }
    }
    data.trimToSize();

    return data.toArray();
} 
```

这显然不能编译，因为 ArrayList.toArray() 方法返回一个 Object[]，我需要它返回一个 Object[][]。

据我了解，因为我有一个数组的 ArrayList，所以应该将它转换为一个包含数组的数组。但事实并非如此。

如果您可以发布一个有用的答案。谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:32:37.730

尝试`return data.toArray(new String[][]);`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:38:04.457

你不能那样做。尝试：

```
public Object[][] getData(ArrayList<IModule> modules) {

    ArrayList<String[]> data = new ArrayList<String[]>();

    for (Iterator<IModule> m = modules.iterator() ; m.hasNext(); ) {
        IModule module = m.next();
        for (Iterator<ICoursework> c = module.getCoursework().iterator() ; c.hasNext() ; ) {
            ICoursework coursework = c.next();
            String[] row = new String[6];

            row[0] = module.getModuleTitle();
            row[1] = module.getModuleCode();
            row[2] = coursework.getTitle();
            row[3] = coursework.dateToString();
            row[4] = coursework.getLecturer().getFirstName() 
                    + coursework.getLecturer().getSecondName();
            row[5] = getSubmissionDetails(coursework, row);

            data.add(row);
        }
    }

    Object[][] arr = new Object[data.size()][6];

    for (int i = 0; i < data.size(); i++) {
        String[] strings = data.get(i);
        for (int j = 0; j < strings.length; j++) {
            arr[i][j] = strings[j];
        }
    }

    return arr;
} 
```

# javascript - 使用 UIWebView 从 HTML 代码调用目标 c 代码中的方法

> ID：15537320
> 
> 赞同：21
> 
> 时间：2013-03-21T00:25:23.343
> 
> 标签：javascript, ios, uiwebview

我的 iOS 应用中有 .html 文件。HTML 文件几乎没有带有 onClick 方法的 div 块。当我点击这些块时，我会在 Web 视图中调用一些 javascript 代码，但我还需要在我的源代码中了解这些事件。

例如，当我点击 web 元素并调用 onClick 时，我需要在代码中调用一些方法，例如`- (void)didTouchedWebElementWithId`

我可以做这件事吗。谢谢。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-03-21T07:19:54.737

在 JS 中调用 Objective-C 的方法：

下面的网址有助于做到这一点

[如何从 Javascript 调用 Objective C 方法并将数据发送回 iOS 中的 Javascript？](https://stackoverflow.com/questions/9826792/how-to-invoke-objective-c-method-from-javascript-and-send-back-data-to-javascrip)

无法执行，我们通过导航到其他页面来解决问题，并且在导航期间，webview 委托将监视导航的前缀并执行我们指定的方法。

**示例.html**

```
<html>
    <head>
        <script type='text/javascript'>
            function getText()
            {
                return document.getElementById('txtinput').value;
            }
            function locationChange()
            {
                window.location = 'ios:webToNativeCall';
            }
        </script>
    </head>
    <body style='overflow-x:hidden;overflow-y:hidden;'>
        <h2 style = "font-size:16px;" align='center'>Hi Welcome to Webpage</h2>
        <br/>
        <p align='center' style = "font-size:12px;">Please Click the button after entering the text</p>
        <br/>
        <center>
            <input type='text' style='width:90px;height:30px;' id='txtinput'/>
        </center>
        <br/>
        <center>
            <input type='button' style='width:90px;height:30px;' onclick='locationChange()' value='click me'>
        </center>
    </body>
</html> 
```

**Objective-C 代码**

当您单击 html 页面中的按钮时，将触发以下委托并取消导航，因为我们返回 NO 并调用相应的方法

```
- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    if ([[[request URL] absoluteString] hasPrefix:@"ios:"]) {

        // Call the given selector
        [self performSelector:@selector(webToNativeCall)];        
        // Cancel the location change
        return NO;
    }
    return YES;
}

- (void)webToNativeCall
{
    NSString *returnvalue =  [self.webviewForHtml stringByEvaluatingJavaScriptFromString:@"getText()"];

    self.valueFromBrowser.text = [NSString stringWithFormat:@"From browser : %@", returnvalue ];
} 
```

# batch-file - FOR /f，解析但包含不需要的字符。

> ID：15537321
> 
> 赞同：0
> 
> 时间：2013-03-21T00:25:35.053
> 
> 标签：batch-file

我是这个委员会和批处理文件编程的新成员——你好！

几天来，我尝试了以下脚本，结果喜忧参半：

> @Echo 关闭
> 
> FOR /f "tokens=3 delims=^:^(" %%G In ('PING "hostname.com"') DO (Echo %%G)

该脚本的目的是 ping 主机并从 Ping 摘要中解析出（N% loss）中的数字（N）。脚本会这样做，但我得到的不是数字，而是“N% loss)”，而不仅仅是整数。我很好奇为什么会发生这种情况以及如何使脚本只输出百分比的整数而不输出其他字符。这个批处理文件在Win7下运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:38:27.580

括号给你带来了麻烦。但在我们开始之前......你刚刚所做的事情恰好在工作，因为在你感兴趣的那一行之后没有行中有一个“：”。我会通过使用 FIND 进行区分，以便我们只检查带有单词“loss”（不区分大小写）的行。“usebackq”是必要的，因为我们在命令中使用引号。下面的“SET Scratch”行去掉了括号。

```
@Echo OFF
FOR /f "usebackq tokens=3* delims==" %%G In (`PING hostname.com ^| FIND /I "loss"`) DO SET Scratch=%%H
SET Scratch=%Scratch:(=%
SET Scratch=%Scratch:)=%
FOR /f "tokens=2" %%G In ('echo.%Scratch%') DO SET Percent=%%G
ECHO.%Percent:~0,-1% 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T01:38:35.270

```
FOR /f "tokens=3 delims=:(%%" %%G In ('PING "hostname.com"') DO (Echo %%G) 
```

几乎不需要转义说明符中的任何字符`delims`，除了`%`通过加倍转义的字符 - 插入符号 ( `^`) 不起作用。

哦——为什么？

如果该行被解析，包括 ONLY`(`和`:`作为分隔符，则该行

`Packets: Sent = 4, Received = 4, Lost = 0 (0% loss),`

有令牌

1.  `Packets`
2.  `Sent = 4, Received = 4, Lost = 0`
3.  `0% loss),`

# unit-testing - 如何测试 Ember.js 路由

> ID：15537330
> 
> 赞同：4
> 
> 时间：2013-03-21T00:26:46.007
> 
> 标签：unit-testing, ember.js

我想为我的 ember.js 应用程序编写一个看起来像这样的测试，但是在谷歌搜索之后我没有任何运气：

```
... setup fixtures here ...

App.navigate_to_path('/some_resource')
equal($('#some-element').text(), 'expected value', 'message') 
```

这是可能的还是我从错误的方向接近这个？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T09:42:26.610

你可以像这样创建一个函数：

```
function navigateTo(url) {
  App.__container_.lookup('router:main').handleURL(url);
} 
```

你可以在这里查看 ember 核心团队是如何测试路由[的](https://github.com/emberjs/ember.js/blob/master/packages/ember/tests/routing/basic_test.js)

# python - 使用 pisa 和非 ascii 字符创建 PDF

> ID：15537331
> 
> 赞同：2
> 
> 时间：2013-03-21T00:26:55.620
> 
> 标签：python, pisa

我正在尝试使用包含用户输入的比萨创建 PDF 文档。用户输入可以是其他语言。尝试输入中文或日文时，字符显示为黑框。即使我不知道用户输入的语言，如何让 PDF 正确显示？

这是我正在尝试的示例：

```
import ho.pisa as pisa
import StringIO
import sys

data = """
<html>
    <head>
        <title>Testing</title>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
    </head>
    <body>
        <p>%s</p>
    </body>
</html>
"""

text = ""
for line in sys.stdin:
    text += line

pisa.pisaDocument(StringIO.StringIO(data % text), file('final.pdf', 'w'), encoding='UTF-8') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-09T21:10:30.400

pisa 使用的默认字体不支持中文或日文字符。我能够通过包含支持这些字符的字体文件并在 css 中使用它来显示字符。

```
@font-face {
   font-family: OtherFont;
   src: url(font/OtherFont.ttf);
}
body {
   font-family: OtherFont;
} 
```

[请参阅本文档](http://xhtml2pdf.appspot.com/static/pisa-en.html)的第 8 节

# c# - 使用firebird嵌入式数据库时如何解决c#中的连接错误？

> ID：15537332
> 
> 赞同：0
> 
> 时间：2013-03-21T00:27:03.293
> 
> 标签：c#, .net, firebird

我开发了一个带有 firebird 嵌入式数据库的桌面应用程序。我下载了 FirebirdSql.Data.FirebirdClient.dll。我添加了这个 dll 以供参考。我将这些文件添加到输出文件夹

```
aliases.conf
fbembed.dll
firebird.conf
firebird.msg
ib_util.dll
icudt30.dll
icuin30.dll
icuuc30.dll 
```

我使用这个连接字符串

```
 String connectionString="ServerType=0;User=SYSDBA;Password=masterkey;Dialect=3;Database=mydb.fdb"; 
 FbConnection con = new FbConnection(connectionString);
                try
                {
                    con.Open();

                }
                catch (Exception ex)
                {
                    MessageBox.Show(ex.ToString());
                } 
```

但是我得到了这个错误，我从谷歌搜索，但我找不到解决方案有没有人帮助我？注意：我看了这个，但没有用。

```
http://stackoverflow.com/questions/4014097/how-to-connect-and-use-firebird-db-embedded-server-with-visual-c-sharp-2010?answertab=votes#tab-top

FirebirdSql.Data.FirebirdClient.FbException (0x80004005): Unable to complete network request to host "localhost". ---> Unable to complete network request to host "localhost".
    FirebirdSql.Data.FirebirdClient.FbConnectionInternal.Connect()
    FirebirdSql.Data.FirebirdClient.FbConnectionPool.Create()
    FirebirdSql.Data.FirebirdClient.FbConnectionPool.CheckOut()
    FirebirdSql.Data.FirebirdClient.FbConnection.Open() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:24:53.323

连接字符串错误。`ServerType`应该是`1`。

# c - 结构，并将变量定义为同义词

> ID：15537342
> 
> 赞同：-1
> 
> 时间：2013-03-21T00:27:39.063
> 
> 标签：c, struct, structure, synonym

我正在与结构作斗争，并且有一些我不知道该怎么做的问题。首先，我必须定义一个结构调用部分，其中包含 int 变量 part_number,i 和一个 25 个字符的字符数组。其次，我必须将 part 定义为 struct 部分的同义词。第三次从键盘读入part_number 和part_name 到变量a 的各个成员中。

```
include <stdio.h>

int main(void)
{
 struct part_containg

{
    int     part_number,i;
char    part_name[25] !='\0';   
    // set up array of 25 characters and include terminating null character
};

struct  part_containg   part_number,part_number[i];

for(part_number=0; part_number<25;++part_number)  // part_number goes up 1 for each    part_name
{
    printf("Intersert Part Name"\n);
    scanf("%c", &part_name[i]);         // scans for part_name
}
 return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:32:19.737

你有很多语法错误。您应该查阅介绍性教科书：它们真的很有帮助！我已经读了半打，我对自己的评价很低~“C技能连续体”~

无论如何，我们都是从底部开始的。这是一个有很多评论的替代版本：

```
#include <stdio.h>  /* you need a hash sign to include libraries...!     */
#include <string.h> /* i use this library to copy input rather than loop */

int main() {                      // main does not take an argument

  struct part_containing {
    int part_number;              // what is i for? I removed it
    char part_name[25];           // do the null later, this  is not the time!
  };

  struct part_containing name;    // only declare the struct, not its variables
                                  // p.s. name is an awful name-choice :P

  char input[25];                 // make a local var for input
  puts("Enter part name:\n");     // prompt user for input
  scanf("%s", input);             // capture local var
  strcpy(name.part_name, input);  // copy it into the struct
  name.part_name[25] = '\0';      // null just to be sure!

  puts("Enter number:\n");        // same for the number now
  scanf("%i", &name.part_number); // notice the syntax: &name.part_number...!

  printf("%s and %i", name.part_name, name.part_number); 
  // simple error check
  // did we get the expected input? It can be helpful to check in test runs!

  return 0;
} 
```

它不能回答你作业中的所有问题，但它应该足以让你开始。

希望这会有所帮助！如果您正在研究它并有更多问题，请提问！

# mysql - WSREP：无法准备“rsync”SST。不可恢复

> ID：15537343
> 
> 赞同：2
> 
> 时间：2013-03-21T00:27:46.957
> 
> 标签：mysql, percona, galera

我正在使用具有 5 个节点的 Percona Xtradb 集群。我无法启动节点并面临以下错误。

我使用该命令`mysqld --console`来跟踪和查看此错误。

```
WSREP: Failed to prepare for 'rsync' SST. Unrecoverable.

130320 18:49:37 [Warning] You need to use --log-bin to make --log-slave-updates work.
130320 18:49:37 [Note] WSREP: Read nil XID from storage engines, skipping position init
130320 18:49:37 [Note] WSREP: wsrep_load(): loading provider library '/usr/lib/libgalera_smm.so'
130320 18:49:37 [Note] WSREP: wsrep_load(): Galera 2.3(r143) by Codership Oy <info@codership.com> loaded succesfully.
130320 18:49:37 [ERROR] WSREP: Process completed with error: /sbin/ifconfig | grep -E '^[[:space:]]+inet addr:' | grep -m1 -v 'inet addr:127' | sed 's/:/ /' | awk '{ print $3 }': 2 (No such file or directory)
130320 18:49:37 [Warning] WSREP: Failed to guess base node address. Set it explicitly via wsrep_node_address.
130320 18:49:37 [Warning] WSREP: Guessing address for incoming client connections failed. Try setting wsrep_node_incoming_address explicitly.
130320 18:49:37 [Note] WSREP: Found saved state: 9ad38334-9082-11e2-0800-6edb31989fd4:-1
130320 18:49:37 [Note] WSREP: Reusing existing '/var/lib/mysql//galera.cache'.
130320 18:49:37 [Note] WSREP: Passing config to GCS: base_port = 4567; cert.log_conflicts = no; gcache.dir = /var/lib/mysql/; gcache.keep_pages_size = 0; gcache.mem_size = 0; gcache.name = /var/lib/mysql//galera.cache; gcache.page_size = 128M; gcache.size = 128M; gcs.fc_debug = 0; gcs.fc_factor = 1; gcs.fc_limit = 16; gcs.fc_master_slave = NO; gcs.max_packet_size = 64500; gcs.max_throttle = 0.25; gcs.recv_q_hard_limit = 9223372036854775807; gcs.recv_q_soft_limit = 0.25; gcs.sync_donor = NO; pc.ignore_sb = true; replicator.causal_read_timeout = PT30S; replicator.commit_order = 3
130320 18:49:37 [Note] WSREP: Assign initial position for certification: -1, protocol version: -1
130320 18:49:37 [Note] WSREP: wsrep_sst_grab()
130320 18:49:37 [Note] WSREP: Start replication
130320 18:49:37 [Note] WSREP: Setting initial position to 00000000-0000-0000-0000-000000000000:-1
130320 18:49:37 [Note] WSREP: protonet asio version 0
130320 18:49:37 [Note] WSREP: backend: asio
130320 18:49:37 [Note] WSREP: GMCast version 0
130320 18:49:37 [Note] WSREP: (70fd13f2-91b0-11e2-0800-73cacdb90501, 'tcp://0.0.0.0:4567') listening at tcp://0.0.0.0:4567
130320 18:49:37 [Note] WSREP: (70fd13f2-91b0-11e2-0800-73cacdb90501, 'tcp://0.0.0.0:4567') multicast: , ttl: 1
130320 18:49:37 [Note] WSREP: EVS version 0
130320 18:49:37 [Note] WSREP: PC version 0
130320 18:49:37 [Note] WSREP: gcomm: connecting to group 'eclickz', peer '192.168.133.66:'
130320 18:49:37 [Note] WSREP: (70fd13f2-91b0-11e2-0800-73cacdb90501, 'tcp://0.0.0.0:4567') turning message relay requesting on, nonlive peers: tcp://192.168.133.68:4567
130320 18:49:37 [Note] WSREP: (70fd13f2-91b0-11e2-0800-73cacdb90501, 'tcp://0.0.0.0:4567') turning message relay requesting off
130320 18:49:37 [Note] WSREP: declaring 60a03c55-919b-11e2-0800-5b5a359d2cb3 stable
130320 18:49:37 [Note] WSREP: declaring c96d5052-918c-11e2-0800-210b57b08c72 stable
130320 18:49:38 [Note] WSREP: view(view_id(PRIM,60a03c55-919b-11e2-0800-5b5a359d2cb3,352) memb {
60a03c55-919b-11e2-0800-5b5a359d2cb3,
70fd13f2-91b0-11e2-0800-73cacdb90501,
c96d5052-918c-11e2-0800-210b57b08c72,
} joined {
} left {
} partitioned {
})
130320 18:49:38 [Note] WSREP: gcomm: connected
130320 18:49:38 [Note] WSREP: Changing maximum packet size to 64500, resulting msg size: 32636
130320 18:49:38 [Note] WSREP: Shifting CLOSED -> OPEN (TO: 0)
130320 18:49:38 [Note] WSREP: Opened channel 'eclickz'
130320 18:49:38 [Note] WSREP: New COMPONENT: primary = yes, bootstrap = no, my_idx = 1, memb_num = 3
130320 18:49:38 [Note] WSREP: Waiting for SST to complete.
130320 18:49:38 [Note] WSREP: STATE EXCHANGE: Waiting for state UUID.
130320 18:49:38 [Note] WSREP: STATE EXCHANGE: sent state msg: 45816f5a-91b0-11e2-0800-a4fd5a8bbd3c
130320 18:49:38 [Note] WSREP: STATE EXCHANGE: got state msg: 45816f5a-91b0-11e2-0800-a4fd5a8bbd3c from 0 (node03)
130320 18:49:38 [Note] WSREP: STATE EXCHANGE: got state msg: 45816f5a-91b0-11e2-0800-a4fd5a8bbd3c from 2 (node1)
130320 18:49:38 [Note] WSREP: STATE EXCHANGE: got state msg: 45816f5a-91b0-11e2-0800-a4fd5a8bbd3c from 1 (slave5.eclickz.com)
130320 18:49:38 [Note] WSREP: Quorum results:
version = 2,
component = PRIMARY,
conf_id = 346,
members = 2/3 (joined/total),
act_id = 832701,
last_appl. = -1,
protocols = 0/4/2 (gcs/repl/appl),
group UUID = 9ad38334-9082-11e2-0800-6edb31989fd4
130320 18:49:38 [Note] WSREP: Flow-control interval: [28, 28]
130320 18:49:38 [Note] WSREP: Shifting OPEN -> PRIMARY (TO: 832701)
130320 18:49:38 [Note] WSREP: State transfer required:
Group state: 9ad38334-9082-11e2-0800-6edb31989fd4:832701
Local state: 9ad38334-9082-11e2-0800-6edb31989fd4:-1
130320 18:49:38 [Note] WSREP: New cluster view: global state: 9ad38334-9082-11e2-0800-6edb31989fd4:832701, view# 347: Primary, number of nodes: 3, my index: 1, protocol version 2
130320 18:49:38 [Warning] WSREP: Gap in state sequence. Need state transfer.
130320 18:49:40 [Note] WSREP: Running: 'wsrep_sst_rsync --role 'joiner' --address '192.168.133.70:4567' --auth '' --datadir '/var/lib/mysql/' --defaults-file '/etc/my.cnf' --parent '38994''
130320 18:49:40 [ERROR] WSREP: Failed to read 'ready <addr>' from: wsrep_sst_rsync --role 'joiner' --address '192.168.133.70:4567' --auth '' --datadir '/var/lib/mysql/' --defaults-file '/etc/my.cnf' --parent '38994'
Read: '(null)'
130320 18:49:40 [ERROR] WSREP: Process completed with error: wsrep_sst_rsync --role 'joiner' --address '192.168.133.70:4567' --auth '' --datadir '/var/lib/mysql/' --defaults-file '/etc/my.cnf' --parent '38994': 2 (No such file or directory)
130320 18:49:40 [ERROR] WSREP: Failed to prepare for 'rsync' SST. Unrecoverable.
130320 18:49:40 [ERROR] Aborting

130320 18:49:42 [Note] WSREP: Closing send monitor...
130320 18:49:42 [Note] WSREP: Closed send monitor.
130320 18:49:42 [Note] WSREP: gcomm: terminating thread
130320 18:49:42 [Note] WSREP: gcomm: joining thread
130320 18:49:42 [Note] WSREP: gcomm: closing backend
130320 18:49:42 [Note] WSREP: view(view_id(NON_PRIM,60a03c55-919b-11e2-0800-5b5a359d2cb3,3 52) memb {
70fd13f2-91b0-11e2-0800-73cacdb90501,
} joined {
} left {
} partitioned {
60a03c55-919b-11e2-0800-5b5a359d2cb3,
c96d5052-918c-11e2-0800-210b57b08c72,
})
130320 18:49:42 [Note] WSREP: view((empty))
130320 18:49:42 [Note] WSREP: New COMPONENT: primary = no, bootstrap = no, my_idx = 0, memb_num = 1
130320 18:49:42 [Note] WSREP: gcomm: closed
130320 18:49:42 [Note] WSREP: Flow-control interval: [16, 16]
130320 18:49:42 [Note] WSREP: Received NON-PRIMARY.
130320 18:49:42 [Note] WSREP: Shifting PRIMARY -> OPEN (TO: 832701)
130320 18:49:42 [Note] WSREP: Received self-leave message.
130320 18:49:42 [Note] WSREP: Flow-control interval: [0, 0]
130320 18:49:42 [Note] WSREP: Received SELF-LEAVE. Closing connection.
130320 18:49:42 [Note] WSREP: Shifting OPEN -> CLOSED (TO: 832701)
130320 18:49:42 [Note] WSREP: RECV thread exiting 0: Success
130320 18:49:42 [Note] WSREP: recv_thread() joined.
130320 18:49:42 [Note] WSREP: Closing slave action queue.
130320 18:49:42 [Note] WSREP: Service disconnected.
130320 18:49:42 [Note] WSREP: rollbacker thread exiting
130320 18:49:43 [Note] WSREP: Some threads may fail to exit. 
```

还有一件事，其他一些节点可以启动，但他们无法绑定端口 3306，这很奇怪。

我无法解决这个问题。请帮我。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:08:19.640

I figured it out by installing libssl0.9.8.

# java - 一次解析 JSON 对象一项

> ID：15537344
> 
> 赞同：0
> 
> 时间：2013-03-21T00:27:53.747
> 
> 标签：java, android

我第一次玩android开发。我正在尝试制作一个简单的货币转换器应用程序。我正在处理的特定部分是使用所有可用货币填充一个微调框，而无需手动将其全部编码。我有一个 json 文件，看起来像：
`{
"AED": "United Arab Emirates Dirham",
"AFN": "Afghan Afghani",
"ALL": "Albanian Lek",
"AMD": "Armenian Dram",
"ANG": "Netherlands Antillean Guilder",
"AOA": "Angolan Kwanza",
"ARS": "Argentine Peso",
"AUD": "Australian Dollar",
"AWG": "Aruban Florin",
...
}`

我想一次读取该对象一种货币，以便可以使用它来填充微调器。类似于以下内容：

```
/*PSEUDOCODE*/
spinner = (Spinner) findViewById(R.id.currencyTo);
List<String> list = new ArrayList<String>();
JSONParser jParser = new JSONParser();
JSONObject json = jParser.getJSONFromUrl(url);
while (rates != null) {
rates = json.getString(first item in json);
list.add(rates);
... 
```

我知道如何通过单独调用每个项目来做到这一点，例如rates = json.getString("AED") 等等，但我不希望它像那样硬编码。我想单独解析每个货币项目，然后将其放在微调器中。抓住下一个货币，将其放入微调器中，依此类推。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:01:42.623

是的，您可以遍历所有 JSON 元素。

尝试这个：

```
final JSONParser jParser = new JSONParser();
final JSONObject jObject = jParser.getJSONFromUrl(url);
Iterator<?> keys = jObject.keys();

while(keys.hasNext()){
    final String key = (String)keys.next();
    final Object obj = jObject.get(key);
    if(obj instanceof JSONObject){
        final String rate = jObject.getString(key);
        System.out.println(key + " => " + rate);
        list.add(rate);
    }
} 
```

# java - Google Drive SDK 将共享权限更新为私有

> ID：15537345
> 
> 赞同：0
> 
> 时间：2013-03-21T00:27:58.600
> 
> 标签：java, google-api, google-drive-api

我喜欢将具有链接的任何人的文档权限更新为私有，以将权限设置为（具有链接的任何人）使用此功能并有效：

```
newPermission.setType("anyone");
newPermission.setWithLink(true);
newPermission.setRole("reader"); 
```

但是尝试将权限设置为私有不起作用，我正在使用这个：

```
newPermission.setType("user");
newPermission.setValue("me");
newPermission.setRole("owner"); 
```

回应是这样的

```
500 Internal Server Error

- Show headers -

{
 "error": {
  "errors": [
   {
    "domain": "global",
    "reason": "internalError",
    "message": "Internal Error"
   }
  ],
  "code": 500,
  "message": "Internal Error"
 }
} 
```

我必须传递哪些参数才能将权限设置为私有？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:15:54.713

您是文件的所有者吗？如果没有，您不能将自己设置为所有者。如果您是，那么文档的权限列表将有两个条目，一个是您作为所有者，另一个是让其他人成为读者。找到后者并删除它，你应该已经准备好了。

# collections - Meteor 重新应用集合转换

> ID：15537346
> 
> 赞同：1
> 
> 时间：2013-03-21T00:28:00.833
> 
> 标签：collections, meteor

在最新版本的 Meteor 中，添加了变换功能。

示例用法：

```
var myCollection = new Meteor.Collection("mycollection",
{
    transform: function(doc){ 
        doc["newProperty"] = "test"; return doc; 
    })
} 
```

**有没有办法重新计算这些转换？**

我在 DOM 中使用时间人性化功能（MomentJS 人性化），这实际上是对集合进行的唯一转换，因此每 10 秒重新应用一次（大约 15 个条目）*应该*不多性能受到打击。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T12:55:18.170

一种方法可能是将您的集合结果放在[依赖项中](http://docs.meteor.com/#deps_dependency)

**客户端JS：**

```
var times = [];
var timesDeps = new Deps.Dependency;

var getTimes = function () {
   Deps.depend(timesDeps);
   return myCollection.find();  //Your Query
};

Template.home.times = function() {
    return getTimes();
}

Meteor.setInterval(function() {
    timesDeps.changed();
}, 10000) //Recalculate ever 10000 ms 
```

所以正在做的是使用 getTimes() 调用您的集合，并且当您调用`timesDeps.changed()`它的反应式上下文时，它会失效并刷新数据，从而再次调用转换。

# java - TexturePacking 与 Libgdx -

> ID：15537347
> 
> 赞同：0
> 
> 时间：2013-03-21T00:28:08.850
> 
> 标签：java, textures, libgdx

我的程序打包了一系列图像并将它们输出到 aste.png 和 aste.atlas 中。我的打包代码如下：

```
public void pack(){
    System.out.println("Packing should not be ordinarily called!  If you did not have explicit intentions of Packing, please check ImageAtlas constructor.");
    Settings settings = new Settings();
    settings.maxWidth = 512;
    settings.maxHeight = 512;
    TexturePacker2.process(settings, "E:/Files/Eclipse Projects/StarFighters/StarFighters-android/assets/sprites/" + name, 
            "E:/Files/Eclipse Projects/StarFighters/StarFighters-android/assets/sprites/", name.substring(0,4));
} 
```

我不需要每次运行程序时都打包，这就是为什么我可以摆脱绝对文件路径（我只会在运行桌面并添加新图像时打包），但是，我只使用绝对文件路径因为我不知道该怎么做。我正在使用 android 资产文件夹。（桌面链接到 android 资产文件夹）当我从桌面版本运行它时，它试图转到桌面路径，当我需要它使用 Gdx.files.internal 为我处理的资产路径时。（这个问题对我的程序的功能不是必需的）

打包图像后，我将执行以下操作：

```
atlas = new TextureAtlas(Gdx.files.internal("sprites/aste.atlas"));
public Texture getTex(String imgname){
    return atlas.findRegion(imgname).getTexture();
} 
```

当我尝试 getTex(); 时，我将“sma_a2”作为 imgname 传递；

我的 assets/sprites/asteroids 目录有以下图片： big_a1.png big_a2.png med_a1.png med_a2.png sma_a1.png sma_a2.png 都成功打包到aste.png和aste.atlas

我的问题是，无论我在收到的图像中传递什么 fname 都是整个 aste.png

我也很好奇为什么我会使用包而不是图像，因为我从图像开始，然后打包它们，只是为了再次获取图像..

* * *

* * *

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T00:38:05.150

Don't call `getTexture()` on the `TextureRegion` returned from `findRegion`.

The whole point of an atlas is that *all* of the textures you look up in it are in the "same" texture, but at different regions within that texture. This way you can "bind" one large texture in OpenGL (which is somewhat expensive) and then render lots of different pieces out of the texture.

Most of the other APIs in Libgdx that take a `Texture` should also work with a `TextureRegion`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:06:29.657

# **我的解决方案：**

使用“getTexture”返回整个图像，纹理区域基本上存储一个矩形，该矩形表示作为单个图像的打包图像的区域。所以，基本上画TextureRegions和画Textures没有太大区别，所以我只画了TextureRegion。就我而言，这涉及添加到超类，以便它支持子类中的纹理和纹理区域。子类使用布尔值指定是使用 Textures 还是 TextureRegions，并且为每个子类调用不同的 SpriteBatch.draw() 方法。

至于为什么要使用上面贴的PT如下：

> 地图集的全部意义在于，您在其中查找的所有纹理都位于“相同”纹理中，但位于该纹理内的不同区域。这样，您可以在 OpenGL 中“绑定”一个大纹理（这有点昂贵），然后从纹理中渲染出许多不同的部分。
> 
> Libgdx 中大多数采用 Texture 的其他 API 也应该适用于 TextureRegion。

所以在我看来它更有效/更快。

# ruby - 在 resque - ruby 中查找时间表

> ID：15537350
> 
> 赞同：2
> 
> 时间：2013-03-21T00:28:22.757
> 
> 标签：ruby, resque

我正在使用 resque 来处理一些后台作业（如 cron 作业）。所以我启动了这两个 rake 任务：
$> rake resque:work
$> rake resque:scheduler

我的问题是如何找到工作程序和调度程序正在运行？对于我可以使用的工人

`Resque::Worker.all`列出所有正在运行的工作人员。它工作正常。但是我无法找到如何找到调度程序是否正在运行（或列出所有已调度的作业）。我试过`Resque::Scheduler.print_schedule`了，但它不打印时间表并且即使我已经运行也总是返回 epmty 哈希`rake resque:scheduler`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-14T21:22:51.810

你需要的方法是

```
Resque.get_schedules 
```

它显示当前计划作业及其相关元数据的哈希值。

```
 {
    "job1"=> {
       "every"=>"30s",
       "class"=>"JobClass",
       "args"=>[1],
       "queue"=>"default",
       "description"=> "Testing..."
    }
} 
```

如果您没有动态添加任何作业，即您没有使用 resque-scheduler 的动态设置

```
Resque::Scheduler.dynamic = true 
```

然后

```
Resque.schedule 
```

会给你同样的结果。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-30T12:48:59.313

我也在搜索列出所有预定的工作......

```
Resque.count_all_scheduled_jobs 
```

这仅显示数字。

我尝试了几种方法

```
Resque.metaclass.instance_methods-Class.methods 
```

但没有运气。必须进入他们的 Github 源

# c# - c# WCF LDAP登录认证

> ID：15537353
> 
> 赞同：1
> 
> 时间：2013-03-21T00:28:51.430
> 
> 标签：c#, ldap

我看过一些关于 LDAP 的主题，但似乎没有任何帮助。我正在寻找最基本的东西。

我有一个 WCF (c#) 服务，并且要求调用该服务的任何人都必须是经过身份验证的 Windows 用户。

如果用户已经登录（例如：正在从网络上的桌面连接），那么应用程序应该允许他拨打电话，但是如果他没有登录（远程连接）一个 windows 窗口或类似的东西应该弹出起来并要求他的用户名和密码。

为了澄清这一点，他将从 Web 应用程序远程调用 WCF 服务。

我不需要有关用户或任何设置的任何信息，规则是，如果他是 Windows 网络用户，他可以访问。

我在某处找到了一个 LDAP 示例，这就是我从中得到的：

```
LdapConnection connection = new LdapConnection(host);
connection.AuthType = AuthType.Basic;
connection.Bind(); 
```

现在，如果绑定有效，那么如果抛出异常，则用户被授权，那么他不是。

现在我很确定我走错了路，所以对如何完成我的任务的任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:11:47.863

> 如果他没有登录（远程连接）

他们仍将拥有 Windows 凭据。

我建议研究 WS-Http 绑定。[basicHttp 与 Ws-Http](http://www.codeproject.com/Articles/36396/Difference-between-BasicHttpBinding-and-WsHttpBind)。它将允许您将凭据传递给绑定对象。因此，无论您是使用 asp.net 成员身份进行身份验证还是仅使用 Windows 身份验证，它都可以非常轻松地处理这两者。

# jquery - 在 css 中设置 jQuery 显示隐藏切换的显示

> ID：15537355
> 
> 赞同：1
> 
> 时间：2013-03-21T00:28:55.823
> 
> 标签：jquery, css, toggle

我想在 CSS 中设置显示的原因是因为所有页面都需要扩展或折叠的特定内容因页面而异。就像现在一样，我似乎需要为每个页面的显示首选项加载不同的 JS 文件。我只想将所有内容集中在一个文件中...

CSS：

```
div.expandable1 {display:block;}
div.expandable2 {display:none;}  [etc] 
```

HTML：

```
<p id="tab1" class="button plus1">NEWS -</p>
<div class="expandable1 panel1" id="one">
[content]
</div> 
```

JS：

```
 $(".button").show();
        $('.plus1').toggle(function(){
            $("#one").slideDown(
            function(){
                $(".plus1").text("NEWS -")
            }
            );
        },function(){
            $("#one").slideUp(
                function(){
                    $(".plus1").text("NEWS +")
                }
            );
        });       [etc] 
```

## 我的问题：

如何使用 css 控制以下内容：

例如：

```
page A- expandable1 is expanded, expandable2 collapsed 
page B- expandable1 is collapsed, expandable2 expanded 
```

等。大约有 6-8 个不同的页面配置，其中 4-5 个部分 [expandables 1-6] 需要以各种组合显示。

就像现在一样，我可以像上面那样使用 {display:block/none,etc.} 但我的 JS 按钮有点摇摆不定。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:17:56.313

# 想法1：

听起来您正在尝试为每个页面编写逻辑。这里有几种方法：

我的建议是使用正文类并将其全部放在 CSS 中。

**HTML：**

```
<html>
<head>
</head>
<body class="pageA">
</body>
</html> 
```

**CSS**

```
/* PageA Styles */
.pageA div.expandable1 {display:block;}
.pageA div.expandable2 {display:none;}

/* PageB Styles */
.pageB div.expandable1 {display:none;}
.pageB div.expandable2 {display:block;} 
```

# 想法 2

**仅 Javascript** 如果您需要使用 javascript 来完成这一切，则必须使用 window.location 检测页面名称。不是一个好方法，但绝对可行。

```
if (window.location.pathname === '/pageA/') {
$('div.expandable1').show();
$('div.expandable2').hide();
} 
```

# php - Wordstrip 功能会无缘无故地跳过单词。

> ID：15537361
> 
> 赞同：0
> 
> 时间：2013-03-21T00:30:00.237
> 
> 标签：php, regex, sanitization

今晚意识到我正在使用的剥离功能之一似乎是随机跳过单词。

```
<?php
function wordstrip($document){ 
  //I truncated the list here for brevity
$wordlist = array(
"it39s",
"039",
"the",
"while",
"message");

//convert all uppercase to lower so matches work correctly
$document = strtolower($document);
            foreach($wordlist as $word)

            $document = preg_replace("/\s". $word ."\s/", " ", $document);
            //echo $word;
            //echo $document;
            $nopunc = preg_replace('/[^a-z0-9]+/i', ' ', $document);
            $trimmed = trim($nopunc);
            return $trimmed; 
    } 
```

?>

它跳过了“the”这个词，我不知道为什么。该列表大约有 200 个字长，我知道它的工作原理，因为它去掉了大多数其他单词。

我给它喂了“垂死的退伍军人给乔治·W·布什和迪克·切尼的最后一封信”，然后取回了“一位垂死的退伍军人写给乔治·W·布什和迪克·切尼的最后一封信”

我认为这是由于“/\s”，因为“the”位于字符串的开头。我试过“/\s？” 但这没有用。我想我只需要使空格可选吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:35:58.343

You could use `\b` to represent a word boundary and not fiddle with the spaces or periods or whatever else might surround a word:

```
$document = strtolower($document);

foreach($wordlist as $word)
    $document = preg_replace("/\b". $word ."\b/", " ", $document);

$nopunc = preg_replace('/[^a-z0-9]+/i', ' ', $document);
$trimmed = trim($nopunc);
return $trimmed; 
```

# xml - PLSQL 的 extractValue 方法中的 XPath 不正确

> ID：15537367
> 
> 赞同：1
> 
> 时间：2013-03-21T00:30:59.693
> 
> 标签：xml, oracle, xpath, plsql

有人可以帮我更正进入 SQL (Oracle) 语句的 XPath 语句，以从下面的 XML 中提取模型的价格，其`<BrandName>`为“Bravo”，模型名称为“XYZ789”：

```
<CarDetails>
<Wheels>
    <Rims>
        <BrandName>Acme</BrandName>
        <Model>
            <Name>ABC123</Name>
            <Price>$350.00</Price>
        </Model>

    </Rims>
    <Rims>
        <BrandName>Bravo</BrandName>
        <Model>
            <Name>XYZ789</Name>
            <Price>$250.00</Price>
        </Model>
        <Model>
            <Name>GHI456</Name>
            <Price>$300.00</Price>
        </Model>
    </Rims>
</Wheels>
</CarDetails> 
```

上述 XML Clob 存储在名为 的 Oracle 表中`Cars`，该表具有标题为“id”、“version”和“xml_document”的列。

用于提取我想要的信息的 SQL 语句如下所示：

```
SELECT * 
FROM ( 
  SELECT x.xml_document.GetClobVal() 
  FROM Cars x 
  WHERE
    extractValue(x.xml_document,
      '/a:CarDetails/b:Wheels/b:Rims[b:BrandName="Bravo"]/b:Model/b:Name',
      'xmlns:a="cars:instance:3_1" xmlns:b="cars:conceptualcomponent:3_1"'
    ) in ('XYZ789')
  ORDER BY x.id, x.version
) 
where ROWNUM <= 100 
```

...但它根本没有提取任何信息。它应该拉出一个记录。我确定数据存在于 XML 中，并且当我在`extractValue`调用内部更改 XPath 以获取其他值时，此语句有效，因此很明显我的 SQL 中的 XPath 是错误的。

```
/a:CarDetails/b:Wheels/b:Rims[b:BrandName="Bravo"]/b:Model/b:Name 
```

`extractValue`任何人都可以就我的 SQL命令应该是什么样的 XPath 提供任何建议吗？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T21:07:18.123

如果您想要品牌名称为“Bravo”且型号名称为“XYZ789”的汽车的价格，则应获取以下 XPath：

```
/a:CarDetails/b:Wheels/b:Rims[b:BrandName="Bravo"]/b:Model[b:Name="XYZ789"]/b:Price 
```

事实上，这里是，在行动：

```
SQL> SET SERVEROUTPUT ON
SQL> DECLARE
  2     v_xml_string     VARCHAR2(4000) := '<a:CarDetails xmlns:a="cars:instance:3_1">
  3  <b:Wheels xmlns:b="cars:conceptualcomponent:3_1">
  4      <b:Rims>
  5          <b:BrandName>Acme</b:BrandName>
  6          <b:Model>
  7              <b:Name>ABC123</b:Name>
  8              <b:Price>$350.00</b:Price>
  9          </b:Model>
 10
 11      </b:Rims>
 12      <b:Rims>
 13          <b:BrandName>Bravo</b:BrandName>
 14          <b:Model>
 15              <b:Name>XYZ789</b:Name>
 16              <b:Price>$250.00</b:Price>
 17          </b:Model>
 18          <b:Model>
 19              <b:Name>GHI456</b:Name>
 20              <b:Price>$300.00</b:Price>
 21          </b:Model>
 22      </b:Rims>
 23  </b:Wheels>
 24  </a:CarDetails>';
 25      v_result    VARCHAR2(4000);
 26  BEGIN
 27    SELECT extractValue(XMLTYPE(v_xml_string),
 28        '/a:CarDetails/b:Wheels/b:Rims[b:BrandName="Bravo"]/b:Model[b:Name="XYZ789"]/b:Price',
 29        'xmlns:a="cars:instance:3_1" xmlns:b="cars:conceptualcomponent:3_1"'
 30      ) INTO v_result FROM DUAL;
 31
 32     dbms_output.put_line(v_result);
 33  END;
 34  /
$250.00

PL/SQL procedure successfully completed.

SQL> 
```

当我尝试在您的 XML 上运行您的 XPath 时（在向其中添加`a`和`b`命名空间之后），我收到一个错误“ORA-19025：EXTRACTVALUE 返回仅一个节点的值”。这是因为[`EXTRACTVALUE`](http://docs.oracle.com/cd/B28359_01/server.111/b28286/functions054.htm)只能处理返回单个结果节点的 XPath。在您的 XML 中，有两个节点与您的 XPath 匹配：`<Name>`具有内容的两个元素`XYZ789`和`GHI456`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T11:25:28.490

在您的 extractvalue 语句中，您声明命名空间，而它们在您的 xml 数据中不存在（至少不在您发布的代码段中）。从 extractvalue 语句中删除命名空间和本地名称，或者将它们添加到数据库中的 xml。

# sql-server - SQL Server 中的 SQL 注入如何击败转义单引号的卫生设施？

> ID：15537368
> 
> 赞同：78
> 
> 时间：2013-03-21T00:31:08.587
> 
> 标签：sql-server, security, tsql, sql-injection, sanitization

首先，我很清楚参数化查询是最好的选择，但我想知道是什么让我在下面提出的策略容易受到攻击。人们坚持以下解决方案不起作用，所以我正在寻找一个为什么它不起作用的例子。

如果动态 SQL 在被发送到 SQL Server 之前使用以下转义在代码中构建，什么样的注入可以解决这个问题？

```
string userInput= "N'" + userInput.Replace("'", "''") + "'" 
```

[在这里](https://stackoverflow.com/questions/139199/can-i-protect-against-sql-injection-by-escaping-single-quote-and-surrounding-use)回答了一个类似的问题，但我不相信任何答案都适用于此。

在 SQL Server 中无法使用“\”转义单引号。

我相信使用 Unicode 的**SQL Smuggling （**[在此处](https://www.owasp.org/images/d/d4/OWASP_IL_2007_SQL_Smuggling.pdf)概述）会因为正在生成的字符串被单引号前面的 N 标记为 Unicode 的事实而受阻。据我所知，SQL Server 不会自动将其他字符集转换为单引号。如果没有未转义的单引号，我不相信注入是可能的。

我也不相信**字符串截断**是一个可行的向量。[根据微软](http://msdn.microsoft.com/en-us/library/ms186939.aspx)的说法， SQL Server 肯定不会进行截断，因为 an 的最大大小为`nvarchar`2GB 。2 GB 的字符串在大多数情况下是不可行的，在我的情况下也是不可能的。

**二阶注射**是可能的，但如果：

1.  使用上述方法对进入数据库的所有数据进行清理
2.  数据库中的值永远不会附加到动态 SQL 中（当您可以在任何动态 SQL 字符串的静态部分中引用表值时，您为什么还要这样做呢？）。

我并不是说这比使用参数化查询更好或替代，但我想知道我概述的内容是如何易受攻击的。有任何想法吗？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2013-03-24T07:52:01.467

在某些情况下，此转义功能会失败。最明显的是不使用单引号时：

```
string table= "\"" + table.Replace("'", "''") + "\""
string var= "`" + var.Replace("'", "''") + "`"
string index= " " + index.Replace("'", "''") + " "
string query = "select * from `"+table+"` where name=\""+var+"\" or id="+index 
```

在这种情况下，您可以使用双引号、反引号“突破”。在最后一种情况下，没有什么可以“突破”的，因此您可以编写`1 union select password from users--`攻击者想要的任何 sql 有效负载。

此转义函数将失败的下一个条件是，如果在转义字符串后获取子字符串（**是**的，我在野外发现了这样的漏洞）：

```
string userPassword= userPassword.Replace("'", "''")
string userName= userInput.Replace("'", "''")
userName = substr(userName,0,10)
string query = "select * from users where name='"+userName+"' and password='"+userPassword+"'"; 
```

在这种情况下，用户`abcdefgji'`名将`abcdefgji''`由转义函数转换为，然后`abcdefgji'`通过获取子字符串转换回。这可以通过将密码值设置为任何 sql 语句来利用，在这种情况下`or 1=1--`将被解释为 sql 而用户名将被解释为`abcdefgji'' and password=`. 结果查询如下：

```
select * from users where name='abcdefgji'' and password=' or 1=1-- 
```

T-SQL 和其他已经提到的高级 sql 注入技术。[SQL Server 应用程序中的高级 SQL 注入](http://www.cgisecurity.com/lib/advanced_sql_injection.pdf)是一篇很棒的论文，如果您还没有阅读它，那么您应该阅读它。

最后一个问题是 unicode 攻击。此类漏洞的出现是因为转义函数不知道多字节编码，[攻击者可以使用它来“消耗”转义字符](http://shiflett.org/blog/2006/jan/addslashes-versus-mysql-real-escape-string)。在字符串前面添加“N”将无济于事，因为这不会影响字符串后面的多字节字符的值。但是，这种类型的攻击非常少见，因为必须将数据库配置为接受 GBK unicode 字符串（我不确定 MS-SQL 是否可以做到这一点）。

二阶代码注入仍然是可能的，这种攻击模式是通过信任攻击者控制的数据源创建的。转义用于将控制字符表示为其字符文字。如果开发人员忘记转义从 a 获得的值`select`，然后在另一个查询中使用该值，那么**bam**攻击者将可以使用字符文字单引号。

**测试一切，什么都不相信。**

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2013-03-29T19:18:47.213

通过一些额外的规定，您的上述方法不易受到 SQL 注入的影响。要考虑的主要攻击媒介是 SQL Smuggling。SQL Smuggling 发生在类似的 unicode 字符以意想不到的方式被翻译时（例如 ` 更改为 ' ）。有几个位置应用程序堆栈可能容易受到 SQL Smuggling 的攻击。

*   **编程语言是否正确处理 unicode 字符串？** 如果语言不支持 unicode，它可能会将 unicode 字符中的字节错误地识别为单引号并将其转义。

*   **客户端数据库库（例如 ODBC 等）是否正确处理 unicode 字符串？** .Net 框架中的 System.Data.SqlClient 可以，但是 Windows 95 时代的旧库呢？第三方 ODBC 库确实存在。如果 ODBC 驱动程序不支持查询字符串中的 unicode，会发生什么情况？

*   **数据库是否正确处理输入？** 假设您使用的是 N''，现代版本的 SQL 是免疫的，但是 SQL 6.5 呢？SQL 7.0？我不知道有任何特定的漏洞，但是在 1990 年代，开发人员并没有注意到这个漏洞。

*   **缓冲区溢出？**另一个问题是引用的字符串比原始字符串长。在哪个版本的 Sql Server 中引入了 2GB 的输入限制？在那之前有什么限制？在旧版本的 SQL 上，当查询超出限制时会发生什么？从网络库的角度来看，查询的长度是否存在任何限制？还是关于编程语言中字符串的长度？

*   **是否有任何语言设置会影响 Replace() 函数中使用的比较？** .Net 总是对 Replace() 函数进行二进制比较。会一直这样吗？如果 .NET 的未来版本支持在 app.config 级别覆盖该行为，会发生什么情况？如果我们使用正则表达式而不是 Replace() 来插入单引号会怎样？计算机的区域设置是否会影响此比较？如果确实发生了行为变化，它可能不容易受到 sql 注入的攻击，但是，它可能在到达数据库之前通过将看起来像单引号的 uni-code 字符更改为单引号来无意中编辑了字符串。

因此，假设您在当前版本的 .Net 上使用 C# 中的 System.String.Replace() 函数以及针对当前（2005-2012）版本的 SQL 服务器的内置 SqlClient 库，那么您的方法不是易受伤害的。当您开始改变事物时，就无法做出任何承诺。参数化查询方法是提高效率、性能和（在某些情况下）安全性的正确方法。

**警告**上述评论不是对这种技术的认可。这种生成 SQL 的错误方法还有其他几个很好的原因。但是，详细说明它们超出了此问题的范围。

***不要将此技术用于新的开发。***

***不要将此技术用于新的开发。***

***不要将此技术用于新的开发。***

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-03-21T00:50:55.560

[使用查询参数](http://www.sommarskog.se/dynamic_sql.html)比转义引号更好、更容易、更快。

* * *

关于您的评论，我看到您承认参数化，但值得强调。当您可以参数化时，为什么要使用转义？

在[Advanced SQL Injection In SQL Server Applications](http://www.thomascookegypt.com/holidays/pdfpkgs/931.pdf)中，在文本中搜索单词“replace”，然后阅读一些示例，即使在转义用户输入后，开发人员也会无意中允许 SQL 注入攻击。

* * *

存在一种极端情况，即转义引号`\`会导致漏洞，因为`\`在某些字符集中，引号变成了有效多字节字符的一半。但这不适用于您的情况，因为`\`它不是转义字符。

正如其他人所指出的那样，您可能还会为您的 SQL 添加动态内容，而不是字符串文字或日期文字。`"`在 SQL 或`[` `]`Microsoft/Sybase中，表或列标识符由分隔。SQL 关键字当然没有任何分隔符。对于这些情况，我建议将要插入的值*列入白名单。*

底线是，逃避*是*一种有效的防御，如果你能确保你始终如一地做到这一点。这就是风险：您的应用程序的开发人员团队之一可能会省略一个步骤并不安全地进行一些字符串插值。

当然，其他方法也是如此，比如参数化。它们只有在您始终如一地执行时才有效。但是我发现使用参数比找出正确的转义类型更容易和更快。开发人员更有可能使用方便且不会减慢速度的方法。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-21T06:27:00.827

如果用户提供的输入被解释为命令，就会发生 SQL 注入。这里的命令表示任何不被解释为可识别的[数据类型](http://msdn.microsoft.com/en-us/library/ms187752.aspx)文字的东西。

现在，如果您仅在数据文字中使用用户输入，特别是仅在字符串文字中，则用户输入只有在能够离开字符串文字上下文时才会被解释为与字符串数据不同的内容。对于字符串或 Unicode 字符串字面量，用单引号括住字面量数据，而嵌入的单引号需要用两个单引号表示。

因此，要留下字符串文字上下文，需要提供一个单引号 (sic)，因为两个单引号被解释为字符串文字数据，而不是字符串文字结束分隔符。

因此，如果您将用户提供的数据中的任何单引号替换为两个单引号，则用户将不可能离开字符串文字上下文。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-07-30T14:24:37.337

SQL 注入可以通过 unicode 发生。如果 Web 应用有这样的 URL：

[http://mywebapp/widgets/?Code=ABC](http://mywebapp/widgets/?Code=ABC)

生成 SQL，如 select * from widgets where Code = 'ABC'

但是黑客输入了这个：

[http://mywebapp/widgets/?Code=ABC%CA%BC;drop](http://mywebapp/widgets/?Code=ABC%CA%BC;drop) table widgets--

SQL 看起来像 select * from widgets where Code = 'ABC';drop table widgets--'

SQL Server 将运行两条 SQL 语句。一个做选择，一个做删除。您的代码可能会将 url 编码的 %CA%BC 转换为 unicode U02BC ，这是一个“修饰符字母撇号”。.Net 中的 Replace 函数不会将其视为单引号。但是，Microsoft SQL Server 将其视为单引号。这是一个可能允许 SQL 注入的示例：

```
string badValue = ((char)0x02BC).ToString();
badValue = badValue + ";delete from widgets--";
string sql = "SELECT * FROM WIDGETS WHERE ID=" + badValue.Replace("'","''");
TestTheSQL(sql); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-21T10:14:47.003

如果您进行字符串连接，可能没有 100% 安全的方法。您可以做的是尝试检查每个参数的数据类型，如果所有参数都通过了此类验证，则继续执行。例如，如果你的参数应该是 int 类型，而你得到的东西不能转换为 int，那么就拒绝它。

如果您接受 nvarchar 参数，这将不起作用。

正如其他人已经指出的那样。最安全的方法是使用参数化查询。

# quickbooks - QuickBooks 英国版更改增值税字段

> ID：15537369
> 
> 赞同：0
> 
> 时间：2013-03-21T00:31:09.637
> 
> 标签：quickbooks

我正在尝试更改 QuickBooks UK 中的增值税字段。我想说 E 而不是 S。我正在发送这个 XML，但是，增值税字段无法更改。我使用了错误的字段吗？

这是我的 XML：

[http://pastebin.com/QWmB7jKF](http://pastebin.com/QWmB7jKF)

我正在使用 SalesTaxCodeRef - FullName as E

在我的回复中，我注意到 SalesTaxCodeRef 全名是 S 并且已包括税：

```
<SalesTaxPercentage>17.50</SalesTaxPercentage>
<SalesTaxTotal>6.50</SalesTaxTotal> 
```

我是否需要更改 SalesTaxCodeRef - FullName 顶部的另一个字段来更改增值税？

我注意到我使用的任何代码都会发生这种情况，例如 EGS。我尝试使用 ListID 字段，但是没有效果。也许 QuickBooks UK 中有一个设置可以更改增值税字段？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T16:42:38.560

尝试更新版本的 qbXML。您正在使用：

```
<?qbxml version="3.0"?> 
```

这是面向 QuickBooks 2004 的。

更有可能的是，如果您使用更新版本的 qbXML，您的运气会更好。尝试 8.0 或更高版本。

```
<?qbxml version="8.0"?> 
```

# jsf - 空白页返回primefaces

> ID：15537380
> 
> 赞同：1
> 
> 时间：2013-03-21T00:32:14.360
> 
> 标签：jsf, primefaces

我想在我正在进行的项目中使用 primefaces。所以我认为获得一些简单的 hello world 程序是个好主意。它工作得很好，所以我想我必须放在 lib 文件夹中的所有库（我正在使用 apache tomcat）工作得很好。接下来我尝试绘制一些图表，为此我查看了示例并决定使用一个，但是我得到了一个空白页...我尝试使用 faces-config.xml 但是我得到了空白页或以下消息：找不到托管 bean ChartBean 的 Bean 或属性类 try.ChartBean

我尝试使用 xml 文件 - 但它没有用......有人可以在这里看到任何错误！？也许有人以前有类似的错误！？任何帮助都非常感谢！！！

测试 - 显示图表的网页

```
<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.prime.com.tr/ui">

<h:body>
<f:view contentType="text/html">

<p:barChart id="basic" value="#{chartBean.categoryModel}" legendPosition="ne"  
            title="Basic Bar Chart" min="0" max="200" style="height:300px"/>  

<p:barChart id="horizontal" value="#{chartBean.categoryModel}" legendPosition="se" style="height:300px"  
            title="Horizontal Bar Chart" orientation="horizontal" min="0" max="200"/>  

<p:barChart id="stacked" value="#{chartBean.categoryModel}" legendPosition="ne" style="height:300px"  
            title="Stacked Bar Chart" stacked="true" barMargin="50" min="0" max="300"/>  
</f:view>

</h:body>
</html> 
```

web.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app version="2.5" 
   xmlns="http://java.sun.com/xml/ns/javaee" 
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
   xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd" >

  <welcome-file-list>
    <welcome-file>imageUpload.jsf</welcome-file>
    </welcome-file-list>

    <servlet>
        <servlet-name>Faces Servlet</servlet-name>
        <servlet-class>javax.faces.webapp.FacesServlet</servlet-class>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>Faces Servlet</servlet-name>
        <url-pattern>*.xhtml</url-pattern>
    </servlet-mapping>
</web-app> 
```

面孔-config.xml

```
<?xml version="1.0" encoding="utf-8"?>
<faces-config xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
    version="2.0">

    <managed-bean>
        <managed-bean-name>ChartBean</managed-bean-name>
        <managed-bean-class>org.primefaces.examples.view.ChartBean</managed-bean-class>
        <managed-bean-scope>session</managed-bean-scope>
    </managed-bean>

</faces-config> 
```

ChartBean.java

```
package org.primefaces.examples.view;

import java.io.Serializable;

import org.primefaces.model.chart.CartesianChartModel;
import org.primefaces.model.chart.ChartSeries;

public class ChartBean implements Serializable {

    private CartesianChartModel categoryModel;

    public ChartBean() {
        createCategoryModel();
    }

    public CartesianChartModel getCategoryModel() {
        return categoryModel;
    }

    private void createCategoryModel() {
        categoryModel = new CartesianChartModel();

        ChartSeries boys = new ChartSeries();
        boys.setLabel("Boys");

        boys.set("2004", 120);
        boys.set("2005", 100);
        boys.set("2006", 44);
        boys.set("2007", 150);
        boys.set("2008", 25);

        ChartSeries girls = new ChartSeries();
        girls.setLabel("Girls");

        girls.set("2004", 52);
        girls.set("2005", 60);
        girls.set("2006", 110);
        girls.set("2007", 135);
        girls.set("2008", 120);

        categoryModel.addSeries(boys);
        categoryModel.addSeries(girls);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T05:18:23.863

我直接看到的三个问题。promefaces xml 命名空间是错误的。它应该是**xmlns:p="http://primefaces.org/ui"**

现在将您在 html 中创建的所有 dom 保存在视图中。IE。您的视图定义应该是

```
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.prime.com.tr/ui">

<f:view>
    <h:head/>
    <h:body>
        <h:form>
            <p:somecomponentofyourchoice />
        </h:form>
    </h:body>
</f:view> 
```

**注意 head 元素**。要使 primefaces 组件正确渲染，您应该有一个 head 占位符。

*   使用 Web App 3 / JSF2.x 配置。不需要面部配置，只需注释并且更干净。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T11:38:33.420

您指定了`ChartBean`in的托管 bean 名称`faces-config.xml`：

```
<managed-bean-name>ChartBean</managed-bean-name> 
```

但是，您尝试通过以下托管 bean 名称访问它`chartBean`：

```
<p:barChart ... value="#{chartBean.categoryModel}"> 
```

那些不匹配。相应地修复托管 bean 名称符合标准 Java 约定：

```
<managed-bean-name>chartBean</managed-bean-name> 
```

或者，摆脱老式 JSF 1.x 配置托管 bean 的风格；完全删除`<managed-bean>`条目`faces-config.xml`并将以下注释放在类上：

```
import javax.faces.bean.ManagedBean;
import javax.faces.bean.SessionScoped;

@ManagedBean
@SessionScoped
public class ChartBean implements Serializable { 
```

它已经默认为正确的托管 bean 名称`chartBean`。

* * *

**与具体问题无关**，PrimeFaces XML 命名空间 URI`http://primefaces.prime.com.tr/ui`来自 PrimeFaces 2.x，而我们自 2 年前就已经使用 PrimeFaces 3.x。我不确定这是否是故意的和/或您是否已阅读正确且最新的指南/教程，但这可能会导致与您当前的问题无关的另一个问题：PrimeFaces 3.x 标签不会在使用旧的 PrimeFaces 2.x XML 命名空间 URI 而不是 3.x 时识别和解析`http://primefaces.org/ui`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-06T04:09:29.510

我有一个类似的问题。我替换了 WebContent/WEB-INF/lib 中的 primefaces.jar 并且它起作用了。我猜 primefaces.jar 有时会损坏。

# javascript - 顶级域的电子邮件地址验证

> ID：15537384
> 
> 赞同：7
> 
> 时间：2013-03-21T00:32:24.333
> 
> 标签：javascript, email, email-validation, tld

我们的 QA 提交了一个错误，指出电子邮件地址的顶级域不能是一个字符。

```
foo@bar.z 
```

我很难研究标准。有人可以确认设置顶级域最小长度是否正确吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:37:52.200

The rules for validating email addresses are as complicated as they are likely to be buggy in their implementation.

Rather than validating an email address, consider verifying it directly instead: [http://davidcel.is/blog/2012/09/06/stop-validating-email-addresses-with-regex/](http://davidcel.is/blog/2012/09/06/stop-validating-email-addresses-with-regex/)

The problem with your case, is that there is a very real possibility that ICANN might introduce single-letter top-level domain names, and individual DNS labels **can** be of length 1, in fact "bar.z" is a valid email address domain name if sent from within a DNS tree/organization where that exists as a sub-domain (i.e. if the mailserver is `smtp.mycompany.org` and I've also defined an MX server for `bar.z.mycompany.org`).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-25T10:02:51.410

请注意，我为此编写了一个名为[libtld](http://snapwebsites.org/project/libtld)的小型 C 库。它可能对你有用。请注意，支持全球所有 TLD 所需的数据量非常惊人，因此我不会在 Javascript 中实现此类。话虽如此，也许如果您可以更多地压缩数据...该库还包括一个 PHP 扩展，因此您可以直接使用 PHP 的函数和结果。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-12-13T02:45:48.277

到目前为止，电子邮件顶级域的长度应该在[2,6]，但它不是一个恒定的标准，因为一切都在变化。验证电子邮件非常困难，在您尝试向其发送电子邮件之前，您无法知道一个电子邮件地址是否真的可以接收电子邮件，尽管它符合电子邮件的正式标准。

# c# - 根据先前的下拉列表选择填充下拉列表

> ID：15537385
> 
> 赞同：1
> 
> 时间：2013-03-21T00:32:25.200
> 
> 标签：c#, asp.net

在我的 ASP 网站中，我有两个下拉列表，第一个有四个用户选择的选项，基于此，第二个下拉列表将从选定的数据库列数据中填充。我正在尝试以编程方式填充这些列表，而不是通过数据源绑定它们

我目前的代码有两个问题：

**1\. 在我的“onselectedIndex changed”方法中，如果我想单击下拉列表中的第一个元素，我无法触发我的事件，我必须单击另一个项目，然后重新单击第一个元素以触发它。我确实将 AutoPostBack 设置为 true**

**2\. 当事件触发数据库数据未填充第二个下拉列表时，它正确填充了数据集的正确行数，但不显示数据。**

一旦从第一个下拉列表中选择了第一个元素，即“咖啡名称”，那么第二个列表将填充正确的行号，即 3，但不是正确的数据

当前代码：

```
 protected void DropDownList1_SelectedIndexChanged(object sender, EventArgs e)
    {
        string option = DropDownList1.SelectedValue;
        // If the selected element is 'Coffee Name' run the method.
        if (option == "Coffee Name")
        {
            bindCoffeeNames();
        }
    }

    private void bindCoffeeNames()
    {
        Query the DB and bind the data to the second dropdown list.
        SqlConnection sqlcon = new SqlConnection(connstring);
        SqlCommand sqlcmd = new SqlCommand("select coffeeName from Coffees ORDER BY coffeeName ASC", sqlcon);
        SqlDataAdapter adp = new SqlDataAdapter(sqlcmd);
        DataSet ds = new DataSet();
        adp.Fill(ds);
        DropDownList2.DataSource = ds.Tables[0];
        DropDownList2.DataBind();

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:34:49.220

1.  自动回发只会在更改时触发。您想将默认占位符插入
    下拉列表。你可以用这样的代码来做：

    ```
    dropdownlist1.Items.Insert(0, new ListItem("Select an item", String.Empty));
    dropdownlist1.SelectedIndex = 0; 
    ```

    或在标记中：

    ```
     <asp:DropDownList ID="ddlPersons" runat="server" AppendDataBoundItems="true" DataValueField="ID" DataTextField="Name">
    <asp:ListItem> -- please select person -- </asp:ListItem>
    </asp:DropDownList> 
    ```

2.  将此行添加到 bindCoffeeNames：

    `DropDownList2.DataTextField = "coffeeName";`

此外，最好`DataValueField`指定一个（您还必须更改查询以返回`CoffeeId`，但这不是必需的）

# c# - 如何从 .net 类访问 UserControl 资源

> ID：15537387
> 
> 赞同：0
> 
> 时间：2013-03-21T00:32:26.637
> 
> 标签：c#, wpf, xaml, user-controls, resourcedictionary

我正在尝试`UserControl`从我的`TreeViewGroupItemTemplateSelector`班级访问 a 中的资源。我无权访问`UserControl`班级内的`TreeViewGroupItemTemplateSelector`班级。我在格式化`Uri`.

`PackageExplorer.xaml`是`UserControl`并且驻留在也包含`TreeViewGroupItemTemplateSelector`该类的本地程序集的根命名空间中。

我收到以下错误：

> 找不到资源'resources/packageexplorer.xaml'

在 Uri 的实例化期间。

```
public class TreeViewGroupItemTemplateSelector : DataTemplateSelector
{
        public override DataTemplate SelectTemplate(object item, DependencyObject container)
        {
            var configGroup = item as IConfigurationGroup;
            if (configGroup == null)
                return null;
            var resourceDictionary = new ResourceDictionary();
            resourceDictionary.Source = new Uri
               ("/myAssembly;component/Resources/myUserControl.xaml",
               UriKind.RelativeOrAbsolute);

            if (configGroup.ItemType == typeof (ReferencePackageConfigurationItem))
                return resourceDictionary["RefreshableHierarchicalDataTemplate"] as DataTemplate;
            else
                return resourceDictionary["DefaultHierarchicalDataTemplate"] as DataTemplate;

        }
    }
} 
```

XAML（代码段）如下所示：

```
<UserControl.Resources>
  <ResourceDictionary>
    <ResourceDictionary.MergedDictionaries>
      <ResourceDictionary>
        <HierarchicalDataTemplate x:Key="DefaultHierarchicalDataTemplate" 
            DataType="{x:Type localconfig:ConfigurationGroup}" 
            ItemsSource="{Binding Path=Items}" 
            ItemTemplateSelector="{StaticResource TreeViewGroupItemTemplateSelector}"/>
        <HierarchicalDataTemplate x:Key="RefreshableHierarchicalDataTemplate" 
            DataType="{x:Type localconfig:ConfigurationGroup}" 
            ItemsSource="{Binding Path=Items}" 
            ItemTemplateSelector="{StaticResource TreeViewGroupItemTemplateSelector}"/> 
```

我还尝试访问资源，如下所示，结果相同：

```
 resourceDictionary.Source = new 
         Uri("/Resources/myUserControl.xaml", UriKind.RelativeOrAbsolute); 
```

和：

```
resourceDictionary.Source = new 
     Uri("myUserControl.xaml", UriKind.RelativeOrAbsolute); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T11:36:15.990

目前尚不清楚您要达到的目标-但据我了解...

> 如果您尝试加载整个用户控制 XAML 文件 - 作为资源
> 
> 用户控制 XAML 不是“资源字典”——我不确定可能会产生什么错误。

但**只是分开的东西**。您可以使用 MergeDictionary 将任何外部“资源字典”XAML 合并到 UserControl.Resources - 但将该“资源”作为文件单独保存 - 加载它，而不是整个用户控件，希望对您有所帮助

# sql - 分区表，但基于多列组合在一起

> ID：15537391
> 
> 赞同：0
> 
> 时间：2013-03-21T00:32:43.967
> 
> 标签：sql, sql-server, sql-server-2008, tsql, sqlperformance

我有一个有趣的问题是将表分成组。我有一群游客 - 每个人都说一种语言和/或是一个家庭的一部分。**我需要将表格分成几组，但我想让家人和语言相似的人聚在一起。**

假设我想将游客分成最多 3 人的组（如果组*必须*更大，这是可以接受的）。该解决方案不必太聪明以至于完全填满所有组，但我正在尽最大努力。

输入：

```
TouristID | LanguageID | FamilyID
---------------------------------
    1     |     1      |    1
    2     |     1      |    1
    3     |     1      |    1
    4     |     2      |    1
    5     |     3      |    2
    6     |     4      |    2
    7     |     5      |    3
    8     |     5      |    4
    9     |     7      |    5 
```

期望的结果：

```
TouristID | GroupID
-------------------
    1     |    1
    2     |    1
    3     |    1
    4     |    1
    5     |    2
    6     |    2
    7     |    3
    8     |    3
    9     |    2 
```

第 1 组由所有使用 1 语言的人组成，包括一位不能被排除在外的家庭成员。

第 2 组由两名家庭成员 (5, 6) 和一名随机成员 (9) 组成，组成 3 人组。

第 3 组由两个相同语言的人 (7, 8) 组成

**我做了什么**：

```
INSERT TouristGroup
SELECT
  t.TouristID,
  DENSE_RANK() OVER (ORDER BY GroupID) AS [GroupID]
FROM Tourists t
CROSS APPLY (
  SELECT MIN(TouristID) AS [GroupID]
  FROM Tourists t2
  WHERE
    ( t2.LanguageID = t.LanguageID
    OR t2.FamilyID = t.FamilyID )
) x;

INSERT Groups
SELECT GroupID, COUNT(*)
FROM TouristGroup
GROUP BY GroupID;

declare 
  @matchID int = 0,
  @currentCount int,
  @desiredCount int = 0,
  @candidateGroupID int = null,
  @chunk int = 1

while exists (
  select null
  from Groups g
  left join Matches m
    on m.GroupID = g.GroupID
  where m.GroupID is null
)
begin
  set @currentCount = null
  set @candidateGroupID = null

  select
    @currentCount = isnull(SUM([Count]), 0)
  from Matches m
  join Groups g
    on g.GroupID = m.GroupID
  where m.MatchID = @matchID

  if @CurrentCount is not null
  begin
    set @desiredCount = @chunk - @desiredCount

    select top 1
      @candidateGroupID = g.GroupID
    from Groups g
    left join Matches m
      on m.GroupID = g.GroupID
    where g.[Count] <= @desiredCount
      and m.GroupID is null
    order by [Count] DESC

    if @candidateGroupID is not null
    begin
      insert Matches
      select @matchID, @candidateGroupID
    end
    else begin
      set @matchID = @matchID + 1
    end
  end
  else begin
    set @matchid = @matchID + 1
  end
end 
```

**问题**

是否有更好的方法来对表进行分区，但根据多列将行分组在一起？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T21:21:47.167

这将产生您的“第 1 步”。也许它比你现在拥有的更好（没有循环）。

```
SELECT t.TouristID, DENSE_RANK() OVER (ORDER BY x.GroupNum) as GroupId
FROM Tourists t
CROSS APPLY (SELECT MIN(TouristId) AS GroupNum 
             FROM @Tourist t2 
             WHERE t2.LanguageId = t.LanguageId OR t2.FamilyId = t.FamilyId
            ) x 
```

至于您至少获得至少三个小组成员的其他要求，如果可能的话，您可能必须做一个类似于您正在做的循环（我不确定它是否可以改进，因为您没有' t共享它）。

[更新] 这是我对“第 2 步”的建议：

```
DECLARE @MinGroupSize int = 3, @rc int = 1
WHILE @rc>0
BEGIN
    WITH GroupCount AS (
    SELECT GroupID, COUNT(*) AS GroupCount
    FROM TouristGroup
    GROUP BY GroupID
    ), CandidateGroups AS (
    SELECT TOP 1 gc1.GroupID AS ShortGroupId, singleton.GroupID as SingletonGroupID
    FROM GroupCount gc1
    CROSS APPLY (SELECT TOP 1 GroupID
                 FROM GroupCount AS gc2
                 WHERE gc2.GroupCount = 1 AND gc2.GroupID != gc1.GroupID
                 ORDER BY gc2.GroupID
                 ) AS singleton
    WHERE gc1.GroupCount < @MinGroupSize
    ORDER BY GroupCount DESC, gc1.GroupID ASC
    )
    UPDATE tg
    SET GroupID = cg.ShortGroupID
    FROM TouristGroup tg
    JOIN CandidateGroups cg ON cg.SingletonGroupID = tg.GroupID;
    SET @rc = @@ROWCOUNT;
END
--
-- If you're anal like me and want to eliminate gaps in GroupID values
--
UPDATE tg
SET GroupID = tg2.GroupID
FROM TouristGroup tg
JOIN (SELECT TouristID,  DENSE_RANK() OVER (ORDER BY GroupID) AS [GroupID]
      FROM TouristGroup) AS tg2 ON tg2.TouristID = tg.TouristID
WHERE tg.GroupID != tg2.GroupID; 
```

这将找到小于所需最小组大小的组，并找到一个单例组（只有 1 个成员）并使用另一个 GroupID 更新单例，逐个执行此操作，直到没有更多候选者为止。按顺序选择较小的组（按 GroupCount 降序，然后按 GroupID 升序），以便首先填充较大的组。只选择单例进行更新，这样自然组就不会被分解。

# python - PyQt multiple QDilaog class signal catching

> ID：15537399
> 
> 赞同：0
> 
> 时间：2013-03-21T00:33:37.807
> 
> 标签：python, signals, pyqt4, qdialog

I have a PyQt Gui application that has multiple QDialog windows that I use to plot data using matplotlib widget. This is the code I'm using is below.

Only one emitted signal is caught. Which ever QDialog is created last catches it's emitted signal. If the `TempBox` dialog is created last the `NewTemp_signal` is caught, or if the `RealBox` dialog is created last the `NewReal_signal` is caught. But, the other signal is not caught. How do I catch both signals to update all dialogs? Thanks

Dialog window class

```
class GUIgraph(QtGui.QDialog):
    def __init__(self,parent=None):
       QtGui.QDialog.__init__(self,parent)
       print 'This is the Histograph dialog class function'
       self.graph = Ui_histogram_Dialog()
       self.graph.setupUi(self) 
```

Functions that create new windwos

```
def TempgraphFunc(self):
    QtGui.QWidget.__init__(self,parent=None)
    self.TempBox = GUIgraph()
    self.TempBox.setWindowTitle("Temperature")
    self.NewTemp_signal.connect(self.TempPlotFunc)
    self.TempBox.show()

def RealgraphFunc(self):
    QtGui.QWidget.__init__(self,parent=None)
    self.RealBox = GUIgraph()
    self.RealBox.setWindowTitle("Real Space")
    self.NewReal_signal.connect(self.RealPlotFunc)
    print 'Real is connected'
    self.RealBox.show() 
```

In another function I emit a signal

```
def loadFiles(self):
    ....
    self.NewTemp_signal.emit()
    self.NewReal_signal.emit()
    print ' signals emitted' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T08:32:25.787

我认为你有架构问题。我没有看到你所有的代码，但至少这很奇怪：

```
def TempgraphFunc(self):
    QtGui.QWidget.__init__(self,parent=None)
    self.TempBox = GUIgraph()
    self.TempBox.setWindowTitle("Temperature")
    self.NewTemp_signal.connect(self.TempPlotFunc)
    self.TempBox.show() 
```

在您正在调用的方法中`QtGui.QWidget.__init__`？？？`__init__`是父“构造函数”方法，你应该从重写的子类中调用它`__init__`

# bash - using command on a gnplot script

> ID：15537402
> 
> 赞同：0
> 
> 时间：2013-03-21T00:34:11.173
> 
> 标签：bash, gnuplot

Im using a script on a mac bash shell that uses gnuplot.

When I use

```
using 1:($2*100.0) 
```

on the script, I get

```
using 1: (*100.0)
 line 0: invalid expression 
```

However, if I use the same command on the gnuplot prompt line I have no problems.

Is there a different format for the `using` command when using it on a script?

Thanks for your time.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:44:12.973

由于您尚未发布脚本，因此我只能猜测。

问题可能来自 bash 将 $2 解释为“脚本的第二个参数”这一事实。您应该使用反斜杠转义美元符号。

```
using 1:(\$2*100.0) 
```

# r - R中的grep具有多个数值或定义的变量

> ID：15537408
> 
> 赞同：1
> 
> 时间：2013-03-21T00:34:48.663
> 
> 标签：r, regex

示例数据

```
A<-c(1,4,5,6)
B<-c(4,6,7,8)
C<-c(6,9,1,2)
D<-c(5,6,7,3)
E<-c(10,11,12,19)
DF<-data.frame(A,B,C,D,E)

colnames(DF)<-c("A_1","B_1","C_2","D_2","TEST")

One<-1
Two<-2 
```

我想使用 grep 根据最后一列中的条件删除（使 NA）我的数据。

```
DF[DF$TEST>15,grep(Two,colnames(DF))]<-NA 
```

工作得很好

```
DF[DF$TEST>15,grep(Two|One,colnames(DF))]<-NA 
```

才不是

以防万一数值数据略有不同

```
DF[DF$TEST>15,grep(2,colnames(DF))]<-NA 
```

这工作正常

```
DF[DF$TEST>15,grep(2|1,colnames(DF))]<-NA 
```

这不

理想情况下，我希望能够使用 grep 基于几个自定义变量删除数据：

```
grep(One|Two|Three|Four) 
```

或者如果处理数字

```
 grep(1:4) 
```

而且我不确定是否可以在正则表达式中添加加法，但最终如果我能做到这一点将是最简单的：

```
DF[DF$TEST>15,grep(One+1,colnames(DF))]<-NA   #If I were trying to grep on 2 
```

或者

```
DF[DF$TEST>15,grep(One+1:One,colnames(DF))]<-NA   #If I were trying to grep on 1:2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:47:38.323

您需要从变量名称创建一个正则表达式模式。

就像是

```
or <- function(...) paste0('(', paste(..., sep = '|'), ')')
or(One,Two)
## [1]  '(1|2)'
grep(or(One,Two), colnames(DF)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T00:48:54.033

尝试使用`sapply`包裹在`c`

```
 c(sapply(One:Two, grep, colnames(DF)) 
```

`unique`如果需要，可能会包裹起来。

--

我发现函数中的参数顺序（与`grep`函数相反`stringr`）使得 *apply 调用非常简洁。

# actionscript-3 - 将加载器从类添加到舞台

> ID：15537410
> 
> 赞同：0
> 
> 时间：2013-03-21T00:34:52.780
> 
> 标签：actionscript-3, actionscript, flash-cs4

我的班级似乎无法进入舞台......几乎就像它不想达到一样。我不知道什么一直出错。这是我现在拥有的课程：

```
package {

import flash.events.*;
import flash.display.*;
import flash.net.*;

public class gallery extends Sprite{

    private var imgPath:String = 'images/';
    private var imgCurrent:int = 0;
    private var images:Array = new Array();
    private var iLoader:Loader;

    function gallery()
    {
        this.addEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
    }

    private function onAddedToStage(e:Event):void {
        this.removeEventListener(Event.ADDED_TO_STAGE, onAddedToStage);
        sayStage();
    }

    public function sayStage():void {
        trace(this.stage);
    }

    public function setImgs(val:Array):void
    {
        for (var index:String in val){
            images[index] = val[index];
        }
    }

    public function getImgs():void
    {
        for (var index:String in images){
            trace(index + ':' + images[index] + ';');
        }
    }

    public function loadImg():void{

        iLoader = new Loader();
        iLoader.contentLoaderInfo.addEventListener(ProgressEvent.PROGRESS, onProgressStatus);
        iLoader.contentLoaderInfo.addEventListener(Event.COMPLETE, onLoaderReady);

        var fileRequest:URLRequest = new URLRequest(imgPath+'testimg.JPG');
        iLoader.load(fileRequest);

    }

    public function onProgressStatus(e:ProgressEvent) {   
        trace(e.bytesLoaded, e.bytesTotal); 
    }

    public function onLoaderReady(e:Event) {     
        stage.addChild(iLoader); // error!
    }

    public function updateImgCurrent(val:int):void
    {
        imgCurrent = imgCurrent + val;
    }

    public function getImgCurrent():int
    {
        return(imgCurrent);
    }

} 
```

}

这就是我在我的 swf 文件中所做的：

```
var gal:gallery = new gallery();
var imagesGallery:Array = new Array();
imagesGallery.push('testimg.JPG');
imagesGallery.push('img2.JPG');
imagesGallery.push('img3.JPG');
gal.setImgs(imagesGallery);
gal.loadImg(); 
```

问题是将 iLoader 添加到舞台。当我这样做时，我收到错误：

```
TypeError: Error #1009: Cannot access a property or method of a null object reference.
at gallery/onLoaderReady() 
```

为什么我无法访问 Stage？或者我想要达到的目标是完全错误的，我应该以另一种方式感知舞台吗？我真的希望你能帮助我，非常感谢提前！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:01:02.213

如果显示对象未添加到显示列表中，则其 stage 属性设置为`null` [(source)](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/DisplayObject.html#stage)。
将其添加到显示列表后，它将被设置为对舞台对象的引用。
试试这个：

```
var gal:gallery = new gallery();
addChild(gal); // this will trigger ADDED_TO_STAGE event and initialize stage property
var imagesGallery:Array = new Array();
imagesGallery.push('testimg.JPG');
imagesGallery.push('img2.JPG');
imagesGallery.push('img3.JPG');
gal.setImgs(imagesGallery);
gal.loadImg(); 
```

# android - Sending objects through bluetooth on android, how do I serialise object and send?

> ID：15537412
> 
> 赞同：1
> 
> 时间：2013-03-21T00:35:41.237
> 
> 标签：android, bluetooth

I've read a ton of SO threads on this and im still confused. I need to send a ship object, for a battleships game. I've made the ship class implement serializable, but I can't seem to send the object. I've basically just used code I've found online and incorparated it into my code for connectedThread (same as android dev site). Code is below. Can anyone tell me where I'm going wrong, any help is greatly appreciated. I get errors when i run the code, which seem to be coming from the objectinputstream side

```
public class ConnectedThread extends Thread {
    private final BluetoothSocket mmSocket;
    private final InputStream mmInStream;
    private final OutputStream mmOutStream;
    ByteArrayOutputStream bos = new ByteArrayOutputStream();
    private ObjectOutput out = null;
    byte[] yourBytes = new byte[1024];

    public ConnectedThread(BluetoothSocket socket) {
        Log.d(TAG, "connectedthread started");
        // mHandler.obtainMessage(TEST).sendToTarget();
        mmSocket = socket;
        InputStream tmpIn = null;
        OutputStream tmpOut = null;
        yourBytes = null;

        // Get the input and output streams, using temp objects because
        // member streams are final
        try {

            tmpIn = socket.getInputStream();
            tmpOut = socket.getOutputStream();
            out = new ObjectOutputStream(bos);

        } catch (IOException e) {
            Log.e(TAG, "temp sockets not created");
        }

        mmInStream = tmpIn;
        mmOutStream = tmpOut;

    }

    public void run() {

        Log.i(TAG, "Begin mConnectedThread");
        byte[] buffer = new byte[1024]; // buffer store for the stream
        int bytes; // bytes returned from read()

        // Keep listening to the InputStream until an exception occurs
        while (true) {
            try {
                    // Read from the InputStream
                    bytes = mmInStream.read(buffer);
                    // Send the obtained bytes to the UI activity
                    Log.i(TAG, "reaaaad msg");
                    mHandler.obtainMessage(SetUpGame.MESSAGE_READ2, bytes,
                            -1, buffer).sendToTarget();

                Log.i(TAG, "READ OBJECT");
                    // ........................................THIS IS CODE THAT HAS ERRORS-----------
                    ByteArrayInputStream bis = new ByteArrayInputStream(yourBytes);
                    ObjectInput in = null;
                    try {
                        in = new ObjectInputStream(mmInStream);
                        Ship yourObject = (Ship) in.readObject();
                        //Log.i("Object received maybe", yourObject.toString());
                        if(yourObject!=null)
                        mHandler.obtainMessage(SetUpGame.MESSAGE_READ_OBJ, -1, -1, yourObject).sendToTarget();
                    } catch (ClassNotFoundException e) {
                        // TODO Auto-generated catch block
                        e.printStackTrace();
                    } finally {
                        bis.close();
                        in.close();
                    }

 // -----------------------------------IF I DELETE THE ABOVE CODE IT WORKS FOR STRINGS PERFECTLY------
                }

            catch (IOException e) {
                Log.e(TAG, "disconnectd");
                break;
            }
        }
    }

    /*
     * Call this from the main activity to send data to the remote device
     */
    public void write(byte[] buffer) {

        try {

            mmOutStream.write(buffer);
            Log.i(TAG, "writeeee msg");
            mHandler.obtainMessage(SetUpGame.MESSAGE_WRITE, -1, -1, buffer)
                    .sendToTarget();
        } catch (IOException e) {
            Log.e(TAG, "Exception during write");
        }
    }

    public void writeObj(Ship ship) {
        bos = new ByteArrayOutputStream();
        ObjectOutput out = null;
        try {
            out = new ObjectOutputStream(mmOutStream);
            out.writeObject(ship);
            yourBytes = bos.toByteArray();
        } catch (Exception e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        }

    }

    /* Call this from the main activity to shutdown the connection */
    public void cancel() {
        try {
            mmSocket.close();
            out.close();
            bos.close();
        } catch (IOException e) {
            Log.e(TAG, "close of connect socket failed");
        }
    }

} 
```

and logcat:

```
03-21 02:41:41.594: E/AndroidRuntime(12529): java.lang.NullPointerException
03-21 02:41:41.594: E/AndroidRuntime(12529):    at java.io.ByteArrayInputStream.<init>(ByteArrayInputStream.java:58)
03-21 02:41:41.594: E/AndroidRuntime(12529):    at com.example.battleships.v2.ChatService$ConnectedThread.run(ChatService.java:280)
03-21 02:41:41.875: E/ActivityThread(12529): Activity com.example.battleships.v2.MainScreen has leaked IntentReceiver com.example.battleships.v2.MainScreen$2@40521320 that was originally registered here. Are you missing a call to unregisterReceiver()?
03-21 02:41:41.875: E/ActivityThread(12529): android.app.IntentReceiverLeaked: Activity com.example.battleships.v2.MainScreen has leaked IntentReceiver com.example.battleships.v2.MainScreen$2@40521320 that was originally registered here. Are you missing a call to unregisterReceiver()?
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.LoadedApk$ReceiverDispatcher.<init>(LoadedApk.java:799)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.LoadedApk.getReceiverDispatcher(LoadedApk.java:575)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.ContextImpl.registerReceiverInternal(ContextImpl.java:865)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.ContextImpl.registerReceiver(ContextImpl.java:852)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.ContextImpl.registerReceiver(ContextImpl.java:846)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.content.ContextWrapper.registerReceiver(ContextWrapper.java:318)
03-21 02:41:41.875: E/ActivityThread(12529):    at com.example.battleships.v2.MainScreen.setUpUI(MainScreen.java:167)
03-21 02:41:41.875: E/ActivityThread(12529):    at com.example.battleships.v2.MainScreen.onCreate(MainScreen.java:160)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1072)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1836)
03-21 02:41:41.875: E/ActivityThread(12529):    at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1893) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:16:50.600

看起来您已经通过在方法 writeObj() 中重新声明它来覆盖类变量“out”。删除“ObjectOutput out = null;” 来自 writeObj()。

此外，当您不断重置类变量“bos”时，您似乎有点不确定要写入哪个流。

您可能会收到 NullPointerException 异常，因为您正试图以您认为的方式使用不在范围内的变量。

# opengl - OpenGL 将着色器附加到程序

> ID：15537415
> 
> 赞同：6
> 
> 时间：2013-03-21T00:36:05.027
> 
> 标签：opengl, glsl

有没有办法访问附加到程序的着色器？也就是说，给定一个程序，我可以执行以下操作：

```
vertexShader = getVertexShaderFromProgram(program); 
```

（我想在验证我的程序的函数中记录着色器编译状态，但我只保留对程序的引用，而不是着色器。）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T01:59:37.423

1.  [`glGetAttachedShaders()`](http://www.opengl.org/sdk/docs/man/html/glGetAttachedShaders.xhtml)获取附加到给定程序对象的着色器的名称。

2.  [`glGetShaderiv( ..., GL_SHADER_TYPE, ... )`](http://www.opengl.org/sdk/docs/man/html/glGetShader.xhtml)获取着色器的类型（顶点、几何、片段）。

3.  [`glGetShaderiv( ..., GL_SHADER_SOURCE_LENGTH, ... )`](http://www.opengl.org/sdk/docs/man/html/glGetShader.xhtml)在每个着色器名称上确定源的长度。

4.  [`glGetShaderSource()`](http://www.opengl.org/sdk/docs/man/html/glGetShaderSource.xhtml)获取每个附加着色器的源字符串。

**编辑**：如果您只需要着色器名称和类型，您可以在第 2 步之后停止。

# javascript - 使用 2 个函数和 onchange 事件处理程序计算 5 个数字的平均值

> ID：15537419
> 
> 赞同：1
> 
> 时间：2013-03-21T00:37:06.790
> 
> 标签：javascript, html, function, average

它应该做的是将文本框中的每个数字相加，然后通过将其除以 5 来计算平均值。我必须使用 onchange 事件处理程序和 2 个函数并将结果返回给 calcAvg 函数。对于每个文本box 添加一个 onchange 事件处理程序，该处理程序调用名为 calcavg() 的函数并通过引用其文档对象将文本框的值传递给该函数。在 performCalc() 函数中计算五个数字的平均值，然后将结果返回给 calcAvg 函数这是我所拥有的：

```
<html>
<head>
<title></title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<script type="text/javascript">

function calcAvg(one, two, three, four, five){
var one = document.totalf.one.value;
var two = document.totalf.two.value;
var three = document.totalf.three.value;
var four = document.totalf.four.value;
var five = document.totalf.five.value;
return}
function performCalc() {
var one = document.totalf.one.value;
var two = document.totalf.two.value;
var three = document.totalf.three.value;
var four = document.totalf.four.value;
var five = document.totalf.five.value;
var res = parseFloat(one + two + three + four + five);
var calcResult = parseFloat(res/5);
return}
</script>
</head>
<body>
<form name="totalf" action="%20">
<p>Input <input type="text" value="0" name="one"     onchange="calcAvg(document.totalf.one.value)"></p>                                           
<p>Input <input type="text" value="0" name="two"     onchange="calcAvg(document.totalf.two.value)"></p> 
<p>Input <input type="text" value="0" name="three"     onchange="calcAvg(document.totalf.three.value)" ></p> 
<p>Input <input type="text" value="0" name="four"     onchange="calcAvg(document.totalf.four.value)"></p> 
<p>Input <input type="text" value="0" name="five"     onchange="calcAvg(document.totalf.five.value)"></p> 
<p>Result:<input type="text" name="res"></p>

</form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:42:38.300

你有一个好的开始。请注意，函数可以传递任意数量的参数，但只能返回一个值。在这种情况下，您希望 calcAvg 将多个值传递给 performCalc..

您可以通过将它们作为形式参数包含在调用中或作为值数组来实现。第二种方法更灵活，因为您可以轻松传递任意数量的值。您可以按如下方式修改您的功能：

```
function calcAvg(one, two, three, four, five) {

  // Note that these could be collected using a loop
  var one = document.totalf.one.value;
  var two = document.totalf.two.value;
  var three = document.totalf.three.value;
  var four = document.totalf.four.value;
  var five = document.totalf.five.value;

  // At this point you'd normally validate the values retrieved from
  // the form and deal with any junk (remove it, stop processing, 
  // ask for another value, etc.)

  // pass values to performCalc and store result
  var average = performCalc([one, two, three, four, five]);

  // Now do something with the result
  document.totalf.res.value = average;

  // There's no need for a return statement as
  // the function doesn't need to return a value
  // Though an empty return statement is harmless
  // return
} 
```

现在执行计算。您不需要所有这些变量，因为这些值是从 calcAvg 传递的。所以这个函数只是计算它给出的平均值并返回值：

```
function performCalc(values) {

  // No need for any of these
  // var one = document.totalf.one.value;
  // var two = document.totalf.two.value;
  // var three = document.totalf.three.value;
  // var four = document.totalf.four.value;
  // var five = document.totalf.five.value;

  // Initialise sum with a number value
  var sum = 0;

  // Loop over values, note that values are strings so they
  // need to be converted to numbers before being added
  for (var i=0, iLen=values.length; i<iLen; i++) {

    // the unary "+" operator will cooerce the value to a number
    // In real life, the value would be checked before being added
    // to avoid errors from junk input
    sum += +values[i];
  }

  // You need to convert each value, this will concatenate the values
  // then convert that to a number, e.g. 1, 2, 3 will become 123 not 6
  // var res = parseFloat(one + two + three + four + five);

  // You've already converted res to a number (badly, but it's a number)
  // and division will coerce strings to number anyway. 
  // But you don't need this
  // var calcResult = parseFloat(res/5);

  // Just return the result of the calculation
  return sum / values.length;
} 
```

HTH。

# android - 如何在android视图类中居中文本？

> ID：15537420
> 
> 赞同：2
> 
> 时间：2013-03-21T00:37:15.870
> 
> 标签：android, android-view

当我有一个扩展 View 的类时，如何将文本绘制到该 View 的中心？要绘制我正在使用的文本，`canvas.drawText`但由于绘制后无法移动文本，我不确定如何将文本居中。那么我将如何在 android 视图类中居中文本

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:43:25.300

```
Paint mPaint = new Paint();
mPaint.setARGB(200, 254, 0, 0); //example
mPaint.setTextAlign(Align.CENTER);
int positionX = (canvas.getWidth() / 2);
int positionY = (int) ((canvas.getHeight() / 2) - ((mPaint.descent() + mPaint.ascent()) / 2)) ;
canvas.drawText("Hello", positionX, positionY, mPaint); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T00:50:17.513

在精神上，Maver1ck 走在了正确的轨道上，尽管这比实践中要困难一些。您需要设置一个`TextPaint`并进行一些测量：

```
TextPaint paint = new TextPaint(Paint.ANTI_ALIAS_FLAG | Paint.SUBPIXEL_TEXT_FLAG);
paint.setTextAlign(Paint.Align.CENTER); //Draw text from center
//setup any text size or color attributes 
```

现在，确定如何垂直居中文本。您想以可见文本为中心吗？你想要基线在中心吗？您想基于文本顶部或上升居中吗？文字很复杂。对于简单的情况，假设我们将在字体的底部和顶部之间居中（注意这不是绝对的顶部和底部——这将是上升和下降）：

```
//Do this somewhere where you can cache it -- no need to do this on every draw.
//onSizeChanged() is a good place.

FontMetrics metrics = paint.getFontMetrics();
float height = Math.abs(metrics.top - metrics.bottom);
float x = getWidth() / 2;
float y = (getHeight() / 2) + (height / 2); 
```

然后，在你的`onDraw()`：

```
canvas.drawText("My Text", x, y, paint); 
```

# javascript - 获取目录中所有文件夹的列表

> ID：15537424
> 
> 赞同：12
> 
> 时间：2013-03-21T00:37:36.027
> 
> 标签：javascript, jquery, html

所以我有一个看起来像这样的文件系统：

```
Music
- 001
-- song.mp3
- 002
-- song.mp3
- 003
- 004
- 005
-- song.mp3
musicplayer.html
musicplayer.js 
```

我很好奇是否可以获得所有文件夹名称的列表？

这个javascript，html5，甚至jQuery，我什么都安装不了。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-21T00:53:13.697

**他的问题*有道理（HTML5）***

* * *

> 我很好奇是否可以获得有关所有文件夹名称的列表？这个 javascript，甚至 jQuery，我什么都安装不了

***根本没有，但不是最后的答案！***

JavaScript (JS) 是一种解释型计算机编程语言。它最初是作为 Web 浏览器的一部分实现的，因此客户端脚本可以与用户交互、控制浏览器、异步通信以及更改显示的文档内容。

JavaScript 有 3 种主要类型，即：

```
Client-Side JavaScript (CSJS) -- an extended version of JavaScript that enables the enhancement and manipulation of web pages and client browsers

Server-Side JavaScript (SSJS) -- an extended version of JavaScript that enables back-end access to databases, file systems, and servers

Core JavaScript -- the base JavaScript language 
```

客户端 JavaScript (CSJS) 和服务器端 JavaScript (SSJS) 依赖于核心 JavaScript，没有它就无法工作。

JavaScript 和 DOM 为恶意作者提供了通过 Web 传递脚本以在客户端计算机上运行的可能性。浏览器作者使用两个限制来控制这种风险。首先，脚本在**沙箱**中运行，它们只能执行与 Web 相关的操作，***而不是创建文件等通用编程任务***。其次，脚本受同源策略的约束：来自一个网站的脚本无法访问发送到另一个站点的用户名、密码或 cookie 等信息。大多数与 JavaScript 相关的安全漏洞都是对同源策略或沙箱的破坏。

通用 JavaScript 的子集 — ADsafe、安全 ECMA 脚本 (SES) — 可提供更高级别的安全性，尤其是在第三方创建的代码（例如广告）上。

> 我很好奇是否可以获得有关所有文件夹名称的列表？使用**HTML5**

HTML5 提供了 FileSystem API 可以解决你的渴望，至少知道 :)
在这里阅读教程：http: [//www.html5rocks.com/en/tutorials/file/filesystem/](http://www.html5rocks.com/en/tutorials/file/filesystem/)

另一种解决方案是使用丑陋的浏览器 Api，我从不推荐
**最好的解决方案** ***是使用像 php 这样的服务器端语言***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:47:04.863

您是否正在尝试获取客户端的文件系统？如果是这样，出于安全原因，Web 浏览器通常会禁止此类行为。

如果您尝试在 Web 服务器上列出内容，那么如果没有[AJAX](http://en.wikipedia.org/wiki/Ajax_%28programming%29) ，这将无法完成，因为 JavaScript 在客户端计算机上运行。您需要一些服务器代码来为您列出目录，但这可能会带来潜在的安全风险。

我认为您最好的选择是运行服务器端代码来列出目录，在客户端代码上这样做并不是最安全的事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:03:29.043

如果您在客户端询问 Javascript，是的，我们可以使用 File API 在 Mozilla Firefox 中访问，我不知道其他浏览器。

[https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O](https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O)

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-03-21T01:01:42.617

正如@Tariq 所说，您绝对可以使用一些服务器端代码（如 php）来完成此操作。您可以通过 ajax 提交与根目录相关的目录路径（查看 jquery $.post() @ [http://api.jquery.com/jQuery.post/](http://api.jquery.com/jQuery.post/)）。

```
<?php
  if (isset($_POST['submit'])) {
  //capture post varibles, sanitizing of course.
  $dir = "";
  $dir = $_POST['input'];

    $dh  = opendir($dir);
    while (false !== ($filename = readdir($dh))) {
      $files[] = $filename;
    }
//now, do stuf with files

    sort($files);
    print_r($files);
  }

?> 
```

这是输出：

```
Array
(
[0] => .
[1] => ..
[2] => bar.php
[3] => foo.txt
[4] => somedir
) 
```

希望这可以帮助。

# python - 如何干净地退出cmd模块的cmd循环

> ID：15537427
> 
> 赞同：10
> 
> 时间：2013-03-21T00:37:47.847
> 
> 标签：python, cmd

我正在使用`cmd`Python 中的模块来构建一个小的交互式命令行程序。但是，从这个文档：[http](http://docs.python.org/2/library/cmd.html) : //docs.python.org/2/library/cmd.html，不清楚什么是以编程方式退出程序（即cmdloop）的干净方式。

理想情况下，我想`exit`在提示符下发出一些命令，然后退出程序。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-21T01:20:44.760

您需要覆盖该`postcmd`方法：

> Cmd.postcmd（停止，行）
> 
> 在命令调度完成后执行的钩子方法。这个方法是 Cmd 中的一个存根；它的存在是为了被子类覆盖。line 是执行的命令行，stop 是一个标志，指示调用 postcmd() 后是否终止执行；这将是 onecmd() 方法的返回值。该方法的返回值将作为stop对应的内部标志的新值；返回 false 将导致解释继续。

从`cmdloop`文档中：

> 当 postcmd() 方法返回真值时，此方法将返回。postcmd() 的 stop 参数是命令对应的 do_*() 方法的返回值。

换句话说：

```
import cmd
class Test(cmd.Cmd):
    # your stuff (do_XXX methods should return nothing or False)
    def do_exit(self,*args):
        return True 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-05-11T18:42:18.770

另一个解决方案是简单地引发并捕获自定义异常。

```
import cmd

class ExitCmdException(Exception):
    pass #Could do something but just make a simple exception

class myCmd(cmd.Cmd):
    #...
    def do_quit(self, args):
        """ Quits the command loop """
        raise ExitCmdException()

#...
try:
    foo.cmdloop()
except ExitCmdException as e:
    print('Good Bye') 
```

# algorithm - 将递归转换为尾递归

> ID：15537432
> 
> 赞同：17
> 
> 时间：2013-03-21T00:38:26.330
> 
> 标签：algorithm, recursion, tail-recursion

我有一个关于如何将“递归”转换为“尾递归”的问题。

这不是作业，只是当我试图从一本关于算法的书中完善递归定理时出现的一个问题。

我熟悉使用递归（阶乘和斐波那契数列）的 2 个典型示例，也知道如何以递归方式和尾递归方式实现它们。

我的代码如下（我使用 Perl 只是为了简化，但可以轻松转换为 C/Java/C++）。

```
# This is the recursive function
sub recP {
    my ($n) = @_;
    if ($n == 0 or $n == 1 or $n == 2) {
        return 1;
    } else {
        return (recP($n-3) * recP($n-1)) + 1;
    }
}

for my $k (1 .. 10) {
    print "recP($k) = ", recP($k), "\n";
} 
```

运行代码时，输​​出如下：

```
recP(1) = 1
recP(2) = 1
recP(3) = 2
recP(4) = 3
recP(5) = 4
recP(6) = 9
recP(7) = 28
recP(8) = 113
recP(9) = 1018 
```

递归函数在返回之前使用不同的参数调用自己两次。我尝试了几种方法将其转换为尾递归函数，但结果都是错误的。

任何人都可以看一下代码并向我展示使其尾递归的正确方法吗？特别是我相信这个树递归的转换有一个例程（在返回之前多次调用递归函数），任何人都可以对此有所了解吗？所以我以后可以使用相同的逻辑来处理不同的问题。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-03-21T05:33:27.837

尽管您经常将以下示例视为将阶乘转换为尾调用的示例：

```
int factorial(int n, int acc=1) {
  if (n <= 1) return acc;
  else        return factorial(n-1, n*acc);
} 
```

这不太正确，因为它要求乘法既是关联的又是可交换的。（乘法*是*关联的和可交换的，但以上不能作为不满足这些约束的其他操作的模型。）更好的解决方案可能是：

```
int factorial(int n, int k=1, int acc=1) {
  if (n == 0) return acc;
  else        return factorial(n-1, k+1, acc*k);
} 
```

这也可以作为斐波那契变换的模型：

```
int fibonacci(int n, int a=1, int b=0) {
  if (n == 0) return a;
  else        return fibonacci(n-1, a+b, a);
} 
```

请注意，这些计算从开头开始的序列，而不是在调用堆栈中排队挂起的延续。所以它们在结构上更像是迭代解决方案而不是递归解决方案。然而，与迭代程序不同的是，它们从不修改任何变量。所有绑定都是不变的。这是一个有趣且有用的属性；在这些简单的情况下，它并没有太大的区别，但是在不重新分配的情况下编写代码会使一些编译器优化更容易。

无论如何，最后一个确实为您的递归函数提供了模型；像斐波那契数列一样，我们需要保留相关的过去值，但我们需要三个而不是两个：

```
int mouse(int n, int a=1, int b=1, int c=1) {
  if (n <=2 ) return a;
  else        return mouse(n-1, a*c+1, a, b);
} 
```

**附加物**

在评论中，提出了两个问题。我将尝试在这里回答他们（以及更多）。

首先，应该清楚（从没有函数调用概念的底层机器架构的考虑）任何函数调用都可以改写为 goto（可能使用无界中间存储）；此外，任何 goto 都可以表示为尾调用。所以有可能（但不一定漂亮）将任何递归重写为尾递归。

通常的机制是“延续传递风格”，这是一种奇特的说法，每次你想调用一个函数时，你将当前函数的其余部分打包为一个新函数（“延续”），然后传递继续调用的函数。由于每个函数都接收一个延续作为参数，它必须通过调用它收到的延续来完成它创建的任何延续。

这可能足以让你头晕目眩，所以我换一种说法：不是将参数和返回位置压入堆栈并调用函数（稍后将返回），而是将参数和延续位置压入堆栈并转到一个函数，该函数稍后将转到延续位置。简而言之，您只需将堆栈设置为显式参数，然后您就无需返回。这种编程风格在事件驱动代码中很常见（请参阅 Python Twisted），编写（和阅读）真的很痛苦。所以我强烈建议让编译器为你做这个转换，如果你能找到一个可以做到的。

*@xxmouse*建议我把递归方程从帽子里拿出来，然后问它是如何推导出来的。它只是原始的递归，但被重新表述为单个元组的转换：

`f[n] = f[n-1]*f[n-3] + 1
=>
F^n = <F^(n-1)[1]*F^(n-1)[3]+1, F^(n-1)[1], F^(n-1)[2]>`

我不知道这是否更清楚，但这是我能做的最好的。查看斐波那契示例以了解稍微简单的情况。

*@j_random_hacker*询问这种转换的限制是什么。它适用于递归序列，其中每个元素都可以用前面`k`元素的某个公式表示，其中`k`是一个常数。还有其他方法可以产生尾调用递归。例如：

```
// For didactic purposes only
bool is_odd(int n) { return n%2 == 1; }

int power(int x, int n, int acc=1) {
  if (n == 0)         return acc;
  else if (is_odd(n)) return power(x, n-1, acc*x);
  else                return power(x*x, n/2, acc);
} 
```

以上与通常的*非*尾调用递归不同，后者执行不同（但等效且同样长）的乘法序列。

```
int squared(n) { return n * n; }

int power(int x, int n) {
  if (n == 0)         return 1;
  else if (is_odd(n)) return x * power(x, n-1));
  else                return squared(power(x, n/2));
} 
```

* * *

感谢 Alexey Frunze 进行以下测试：输出（[ideone](http://ideone.com/jFRw71)）：

```
mouse(0) = 1
mouse(1) = 1
mouse(2) = 1
mouse(3) = 2
mouse(4) = 3
mouse(5) = 4
mouse(6) = 9
mouse(7) = 28
mouse(8) = 113
mouse(9) = 1018 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-21T00:48:38.583

使用谷歌，我发现这个页面描述了[Tail Recursion](http://c2.com/cgi/wiki?TailRecursion)。基本上，您需要将该函数拆分为至少两个其他函数：一个执行工作，保持当前值的“累积”，另一个是您的济贫院功能的驱动程序。C中的阶乘示例如下：

```
/* not tail recursive */
unsigned int
factorial1(unsigned int n)
{
    if(n == 0)
        return 1;
    return n * factorial1(n-1);
}

/* tail recursive version */
unsigned int 
factorial_driver(unsigned int n, unsigned int acc)
{
    if(n == 0)
        return acc;

    /* notice that the multiplication happens in the function call */
    return factorial_driver(n - 1, n * acc);
}

/* driver function for tail recursive factorial */
unsigned int
factorial2(unsigned int n)
{
    return factorial_driver(n, 1);
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T05:40:46.657

@Alexey Frunze 的回答还可以，但并不完全正确。[通过将任何程序转换为Continuation Passing Style](http://en.wikipedia.org/wiki/Continuation-passing_style)，确实可以将任何程序转换为所有递归都是尾递归的程序。

我现在没有时间，但如果我有时间的话，我会尝试在 CPS 中重新实现你的程序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T00:55:14.950

你可以这样做：

```
#include <stdio.h>

void fr(int n, int a[])
{
  int tmp;

  if (n == 0)
    return;

  tmp = a[0] * a[2] + 1;
  a[2] = a[1];
  a[1] = a[0];
  a[0] = tmp;

  fr(n - 1, a);
}

int f(int n)
{
  int a[3] = { 1, 1, 1 };

  if (n <= 2)
    return 1;

  fr(n - 2, a);

  return a[0];
}

int main(void)
{
  int k;
  for (k = 0; k < 10; k++)
    printf("f(%d) = %d\n", k, f(k));
  return 0;
} 
```

输出（[ideone](http://ideone.com/mBiqnM)）：

```
f(0) = 1
f(1) = 1
f(2) = 1
f(3) = 2
f(4) = 3
f(5) = 4
f(6) = 9
f(7) = 28
f(8) = 113
f(9) = 1018 
```

编译器可能会`fr()`变成这样的东西：

```
void fr(int n, int a[])
{
  int tmp;

label:    

  if (n == 0)
    return;

  tmp = a[0] * a[2] + 1;
  a[2] = a[1];
  a[1] = a[0];
  a[0] = tmp;

  n--;

  goto label;
} 
```

那将是尾调用优化。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-21T06:34:40.190

问题是最后一个操作不是递归调用之一，而是乘法加 1。您在 C 中的功能：

```
unsigned faa (int n)  // Ordinary recursion
{
    return n<3 ? 1 :
                 faa(n-3)*faa(n-1) + 1;  // Call, call, multiply, add
} 
```

如果您更改请求值的顺序，您可以将其中一个调用变成一个循环：

```
unsigned foo (int n)  // Similar to tail recursion
{                     // (reverse order)
    int i;
    unsigned f;

    for (i=3, f=1; i<=n; i++)
        f = f*foo(i-3) + 1;

    return f;
} 
```

关键是考虑在原始函数中实际计算值的顺序，而不是请求它们的顺序。

请注意，我假设您要删除一个递归调用。如果您想在函数末尾编写递归调用，期望编译器为您优化它，请参阅其他答案。

虽然，这里要做的“正确的事情（TM）”是使用动态编程来避免多次计算相同的值：

```
unsigned fuu (int n)  // Dynamic programming
{
    int i;
    unsigned A[4]={1,1,1,1};

    for (i=3; i<=n; i++)
    {
        memmove (A+1, A, 3*sizeof(int));
        A[0] = A[1]*A[3] + 1;
    }

    return A[0];
} 
```

数组A包含序列的滑动窗口：A[0]==f(i), A[1]==f(i-1), A[2]==f(i-2) 等等.

`memmove`可能写成：

```
 A[3] = A[2];
        A[2] = A[1];
        A[1] = A[0]; 
```

# yii - Yii：没有数据库服务器的单元测试模型

> ID：15537435
> 
> 赞同：2
> 
> 时间：2013-03-21T00:38:52.610
> 
> 标签：yii

在没有访问数据库服务器（或其他外部资源）的情况下对 Yii 模型执行单元测试的首选/正确方法是什么？我发现的所有单元测试文档都建议您必须拥有一个活动的数据库服务器，但显然这对于​​单元测试来说并不理想。

对于它的价值，这是我的 config/test.php 和我的 bootstrap.php：

```
<?php

return CMap::mergeArray(
    require(dirname(__FILE__).'/main.php'),
    array(
        'components'=>array(
            'fixture'=>array(
                'class'=>'system.test.CDbFixtureManager',
            ),
        ),
    )
); 
```

和

```
<?php

// change the following paths if necessary
$yiit=dirname(__FILE__).'/../../yii-1.1.13.e9e4a0/framework/yiit.php';
$config=dirname(__FILE__).'/../config/test.php';

require_once($yiit);
require_once(dirname(__FILE__).'/WebTestCase.php');

Yii::createWebApplication($config); 
```

当我运行测试时，我得到：

```
CDbException: CDbConnection.connectionString cannot be empty. 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-13T04:26:40.297

Yii 作者的集成测试有一个误导性的名称。他们称它们为“单位”。事实上，如果你需要连接到数据库服务器，它就不再是单元测试了。

如果你想单独测试你的 ActiveRecords，首先你应该实现一个假的 CDbConnection，它将映射到一些内存数据集（或基于文件系统的数据集）。Yii 没有内置这样的东西。

之后，您只需`CActiveRecord::$db = new FakeDbConnection()`在您的`bootstrap.php`和我相信您根本不需要更改现有的测试套件。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T13:50:40.507

我能想到的唯一选择是使用 SQLite 并为您的单元测试提供一个 DB 文件。但这也有一些限制，例如它不支持外键和来自“真实”数据库的一些其他功能。毕竟，如果你想测试模型，你*需要*某种数据库。

# java - 检查数组索引中的数据

> ID：15537438
> 
> 赞同：0
> 
> 时间：2013-03-21T00:39:02.357
> 
> 标签：java, arrays, file

我正在尝试创建一个程序，它将读取一个文件，将该文件拆分为一个数组，只要有一个“/”，然后将变量“theOutput”设置为数组中索引的值。麻烦的是，索引总是等于null。这是我的代码：

```
String theOutput = null;
        String content = new Scanner(new File("URL.txt")).useDelimiter("\\Z").next();
        theInput = content;
        String[] URL = theInput.split("/");
        System.out.println(theInput);
        System.out.println(URL.length);

            if (URL.length == 1) {
                theOutput = URL[0];
                if (URL.length == 3) {
                    theOutput = URL[2];
                    if (URL.length == 4) {
                        theOutput = URL[3];
                        if (URL.length == 5) {
                            theOutput = URL[4];
                            if (URL.length == 6) {
                                theOutput = URL[5];
                            }
                        }
                    } 
```

在文件中找到的数据示例是“coffee://localhost/brew”，因此它并不总是在数组中使用 5 个索引。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:46:28.153

您的 if 语句相互嵌套，因此`if(URL.length == 3)`仅当 URL 的长度为 1 时才会运行。因此，您应该执行以下操作：

```
if(URL.length == 1){
    theOutput = URL[0];
}
if(URL.length == 2){
    theOutput = URL[1]
}
//etc. 
```

或者，您可以说`theOutput = URL[URL.length-1]`获取数组的最后一个元素。

# php - PHP glob 模式问题

> ID：15537440
> 
> 赞同：1
> 
> 时间：2013-03-21T00:39:18.870
> 
> 标签：php, glob

我正在尝试使用 glob 在我的目录中获取某些文件。

我的模式就像

```
foreach(glob($root . "../test/te[0-9]{2}.xml") as $filename){
  echo $filename;
} 
```

这些文件是

```
0051_001.xml
0071_001_as01.xml
0485_001_te01.xml
0485_001_te02.xml
0485_001_teh03.xml 
```

它什么也不输出。

我只想要`teh01`而`te03.xml`不是其余的。我不确定我的模式有什么问题。有人可以帮我吗？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:42:13.127

`glob`不支持`[0-9]{2}`，你必须写`[0-9][0-9]`：

```
foreach(glob($root . "../test/te[0-9][0-9].xml") as $filename){
  echo $filename;
} 
```

对于您的文件，您需要使用：

```
foreach(glob($root . "../test/[0-9][0-9][0-9][0-9]_[0-9][0-9][0-9]_te[0-9][0-9].xml") as $filename){
  echo $filename;
} 
```

或者您可以添加正则表达式检查：

```
foreach(glob($root . "../test/*.xml") as $filename){
  if (preg_match('/_te\d{2}\.xml$/', $filename, $matches)){
     echo $filename;
  }
} 
```

# javascript - 你如何得到一个字段的整数值？

> ID：15537442
> 
> 赞同：-1
> 
> 时间：2013-03-21T00:39:30.187
> 
> 标签：javascript

我不得不使用它来获取字段的整数值：

```
var local = {};
local.result = $('#myID').val();
local.result = parseInt(0 + local.result);
return local.result; 
```

问：是否有最佳实践，例如某种 jQuery 方法，它返回一个值或数字 0（如果它不是一个值）？

我得有更多的jQuery！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:43:08.893

您的代码在某些浏览器中会失败，因为它们会看到以`0`base-8 开头的数字。试试这个：

```
return parseInt(document.getElementById('myID').value,10) || 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:41:46.443

您可以`+val`尝试将任何字符串强制`str`转换为数字。

如果您有可能的非数字值，并且希望默认为 0，如原始帖子中所示：

```
var num = +str || 0; 
```

JSFiddle：http: [//jsfiddle.net/F8wWN/2/](http://jsfiddle.net/F8wWN/2/)

相关的 JS 忍者技巧：[在 JavaScript 中 = +_ 是什么意思](https://stackoverflow.com/questions/15129137/what-does-mean-in-javascript)

我不确定您是否暗示任何浮点转换。看起来它已经是一个整数了，否则你将无法使用`parseInt`它，对吧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:06:28.333

“最佳实践”是相对的：对别人最好的不一定对你最好。

如果您想检查该值是否为正整数，那么正则表达式可能适合该法案：

```
var intRe = /^\d+$/;
var el = document.getElementById('id');
el.value = intRe.test(el.value)? el.value || 0; 
```

如果要测试负整数，请修改正则表达式以允许可选的前导减号 (-)：

```
var intRe = /^\-?d+$/; 
```

为方便起见，您可能希望修剪前导和尾随空白。请注意，2.343e3 是一个有效的正整数。

# jquery - Ant最小化JS文件的问题

> ID：15537445
> 
> 赞同：1
> 
> 时间：2013-03-21T00:40:14.480
> 
> 标签：jquery, ant, build, minimize

我正在使用 Ant 来最小化我项目中的所有 JS 文件。它将我的各种 JS 文件（即：file1.js、file2.js、file3.js）编译成一个文件（即：file.min.js），然后将此最小化版本与我的 HTML 源文件一起复制到构建文件夹中.

它工作得很好，但被复制到构建文件夹的 HTML 源文件仍然引用旧的未最小化版本（file1.js、file2.js 等...）

所以我的问题是，当我运行 Ant 构建时，是否有一个函数/特性可以更改 HTML 源代码中的任何相关文件引用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:08:30.387

最简单的方法是简单地始终使用缩小的 JS。只要您永远不需要通过调试器运行 JS 或获得可理解的回溯，这将非常有效。

一种称为“源地图”的技术解决了这个问题。如果您使用源映射，则始终可以使用缩小版，当您需要调试时，调试器会按需加载未缩小版。不幸的是，在撰写本文时（2013 年 3 月），源映射*还很*新，并且该技术需要浏览器和缩小器的支持。

如果您的 HTML 是从模板生成的，您最好将设置传递给模板，以告诉它您是在构建开发还是生产，然后相应地更改标题文本。

如果上述解决方案都不适合您，解决您的问题的一个 hacky 解决方案是在您的 HTML 中标记单独的注释，如下所示：

```
<!-- BEGIN DEVELOPMENT -->
<script src="src/js/file1.js"></script>
<script src="src/js/file2.js"></script>
<script src="src/js/file3.js"></script>
<!-- END DEVELOPMENT -->

<!-- BEGIN PRODUCTION
<script src="dist/js/file.js.min"></script>
     END PRODUCTION --> 
```

然后让 Ant 运行一些 sed 脚本来注释掉开发语句并添加生产语句：

```
# run this command to create production version of project.html
cat src/html/project.html                                       \
| sed -e 's/<!-- BEGIN DEVELOPMENT -->/<!-- BEGIN DEVELOPMENT/' \
| sed -e 's/<!-- END DEVELOPMENT -->/     END DEVELOPMENT -->/' \
| sed -e 's/<!-- BEGIN PRODUCTION/<!-- BEGIN PRODUCTION -->/'   \
| sed -e 's/     END PRODUCTION -->/<!-- END PRODUCTION -->/'   \
> dist/html/project.html 
```

我建议将此命令放入 shell 脚本中，并让 Ant 使用 execfile 运行该脚本。在 ant-contrib 或其他地方可能还存在用于这种替换的第三方任务，但是对于构建您的代码的任何人来说，使用它们将是一件痛苦的事情，因为他们必须安装您使用的相同的 ant 扩展。

如果您正在构建一个缺少 sed 的非类 UNIX 系统（即 Windows），您也许可以使用 gnuwin32 项目中的 sed 的 Windows 版本。或者只是在 Virtualbox VM 中的 Linux 上构建

# google-chrome-extension - captureVisibleTab text rendering is blurry

> ID：15537448
> 
> 赞同：2
> 
> 时间：2013-03-21T00:40:31.280
> 
> 标签：google-chrome-extension, retina-display

I seem to get noticeably lower quality text rendering from captureVisibleTab than I see on screen. From what I've read, captureVisibleTab just grabs its image from memory (see Chromium issue 44758), so I'm not quite sure why this would be. I've got a retina MacBook but the images are noticeably worse on a regular screen too. I'm writing an extension for a web typography tool that depends specifically on text rendering so any workaround or alternative approach would be much appreciated.

Here's a screenshot of the BBC home page as I see it:

[https://www.evernote.com/shard/s1/sh/e49a2865-cac5-4f57-b9fe-0703d5676ca2/ebb6455a83a15d70ea99f0c153001947/deep/0/Screen%20Shot%202013-03-20%20at%2023.31.23.jpg](https://www.evernote.com/shard/s1/sh/e49a2865-cac5-4f57-b9fe-0703d5676ca2/ebb6455a83a15d70ea99f0c153001947/deep/0/Screen%20Shot%202013-03-20%20at%2023.31.23.jpg)

And the dataURI loaded with the following code:

```
chrome.tabs.captureVisibleTab(null, {format: "png"}, function(dataURI) {
    console.log(dataURI);
}); 
```

Looks like this:

[https://www.evernote.com/shard/s1/sh/295c8694-5f34-4b37-a754-b396644b0b82/55e1466a939d0f8e5677b25a93c5bc2b/deep/0/Screen%20Shot%202013-03-20%20at%2023.33.59.jpg](https://www.evernote.com/shard/s1/sh/295c8694-5f34-4b37-a754-b396644b0b82/55e1466a939d0f8e5677b25a93c5bc2b/deep/0/Screen%20Shot%202013-03-20%20at%2023.33.59.jpg)

(Open those two screenshots in tabs and flick back and forth between them to see what I mean.)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-01T02:03:15.713

尝试将格式更改为 jpeg 并提高质量

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-28T04:00:22.913

这看起来像是 Chromium 中的一个已知问题 - [code.google.com/p/chromium/issues/detail?id=415297](http://code.google.com/p/chromium/issues/detail?id=415297)

# java - 如何在java中重载相等和打印？

> ID：15537450
> 
> 赞同：0
> 
> 时间：2013-03-21T00:40:38.143
> 
> 标签：java, python, operator-overloading, overloading

在java中，如何重载一个类的相等操作和打印操作？

就像在 python 中一样，你可以通过做`def __eq__(self):`or来做到这一点`def __str__(self):`，但是如何在 java 中做到这一点呢？

我知道您可以手动创建一个方法并调用它之类的`equals`东西，但我想知道是否有一个实际的方法可以与`==`运算符和`System.out.print()`函数一起使用。

有人知道吗？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T00:42:15.380

Java 不支持运算符重载。`==`将*始终*测试参考相等性。

[`System.out.print()`](http://docs.oracle.com/javase/7/docs/api/java/io/PrintStream.html#print%28java.lang.Object%29)用于[`Object.toString()`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#toString%28%29)生成其输出。`toString`你可以在你的类中覆盖。

并且您对重写该[`equals`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#equals%28java.lang.Object%29)方法有一个警告是正确的：如果您要重写该`equals`方法，则还应该重写该[`hashCode`](http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode%28%29)方法，以便您的对象在使用`HashSet`s 等时可以正确运行。`hashCode`关于和之间的合同的详细信息`equals`可以在我链接到的文档中找到。

/编辑

```
public class Point {
    private int x;
    private int y;

    public Point(int x, int y) {
        this.x = x;
        this.y = y;
    }

    @Override
    public String toString() {
        return "(" + x + ", " + y + ")";
    }

    public static void main(String[] args) {
        System.out.println(new Point(1, 2));
    }
} 
```

# jquery - 如果元素存在，则分配不同的值

> ID：15537453
> 
> 赞同：-1
> 
> 时间：2013-03-21T00:40:52.463
> 
> 标签：jquery

我正在尝试将两个值之一分配给变量，具体取决于元素是否存在。我认为这样的事情应该工作......

```
$optsH = function(){
    if ( jQ('#options').length > 0 ) {
        return jQ('#options').outerHeight();
    } else {
        return 0;
    }
} 
```

... 但不是。

我知道这应该很简单，但这是漫长的一天。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:43:00.747

很确定你只是忘了调用你的函数；

```
$optsH = (function(){
    if ( jQ('#options').length > 0 ) {
        return jQ('#options').outerHeight();
    } else {
        return 0;
    }
})() 
```

如果你想优化它，这是一个更好的方法：

```
$optsH = jQ('#options').outerHeight() || 0; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T00:47:32.457

如果选择器[`outerHeight`](http://api.jquery.com/outerHeight/)不匹配任何元素，则调用将返回 null，并且 null 是虚假的，因此您应该能够执行以下操作：

```
$optsH = jQ('#options').outerHeight() || 0; 
```

（我现在无法测试，但我很确定它应该可以工作。）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T00:42:53.507

你可以这样做

```
$(document).ready(function(){
       $('#input_field').val($('#options').length > 0 ? $('#options').outerHeight() : 0);
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T00:42:57.943

如果元素不存在`jQ('#options')`将返回一个空集合，为什么还要检查？

# python - Simulating 1K web clients with different mac addresses as sources

> ID：15537454
> 
> 赞同：2
> 
> 时间：2013-03-21T00:41:22.220
> 
> 标签：python, linux, simulation, eventlet

I have the following need:

*   Simulate 1K (or more) web clients (i.e., http requests) to an ip address.
*   Each client has to use a different mac as source.
*   Solution has to be somewhat realistic, i.e., i am hoping to get (under fundamental limits) maximum simultaneous requests from this clients.
*   All this in the same machine
*   Using linux.

My Question: How can I do this maximising the number of users and requests per second?

I am quite certain (99% :)) of what I am doing. I really need these requests to be send with a different mac address as source since it is a special use case based on OpenFlow switches. But it is irrelevant to expand this scenario into the question.

P.S. I am currently working in python using the [Eventlet Networking Library](http://eventlet.net/). Python/Eventlet is not a requirement, but I include it here since i have a certain urgency and a fast implementation/modification of my code would be beneficial. I was thinking that maybe i could associate virtual interfaces with different mac addresses but i am lacking a way to specify the request interface.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:53:49.523

> 我在想也许我可以将虚拟接口与不同的 mac 地址相关联，但我缺乏指定请求接口的方法。

如果你的意思是创建 1000 个虚拟接口，它们都绑定到一个真实接口，每个都有不同的假 MAC 地址，是的，你可以这样做。

据我所知，如果`eventlet.connect`不深入挖掘，您将无法轻易提供特定的界面`libevent`。但是你*可以*很容易地给出一个本地地址（IP、端口）。[`eventlet.connect`](http://eventlet.net/doc/basic_usage.html#eventlet.connect)接受一个`bind`参数，该参数接受一个本地地址并绑定到它。

因此，如果您只是为每个虚拟接口提供不同的 IP 地址，并通过您的真实接口将它们全部桥接，那应该就是您所需要的。

我不完全确定这将如何*运作*，但它应该*有效*。试试看。

有一个明显的缺点：您需要 1000 个可路由的 IP 地址。但是假设您在您控制的 NAT 后面，这很容易——例如，10.0.xy.1zw。

如果您不在您控制的 NAT 后面，只需抛出一个。您甚至可以在同一台机器上的真实接口上运行它，并将其设置为虚拟接口的路由器而不是网桥。

但是，一旦你这样做了……你可能*不需要*1000 个虚拟接口，或者在你的`eventlet`代码中做任何事情。如果您只是将 NAT 配置为随机分配 MAC 地址，那么您可能已经完成了。我对此并不积极；它可能会尝试变得聪明，并在很短的时间内将多个连接处理到相同的（主机、端口）作为路由的相同连接，这会妨碍你。但是，再试一次，看看。

当然，无论哪种方式，服务器都会将它们视为来自同一 NAT 路由器的 1000 个客户端。除了欺骗之外，没有办法解决这个问题（除非您实际上在互联网的不同部分拥有 1000 个地址）。但是，除非您试图真正愚弄服务器中的某些逻辑，而不是仅仅模拟某些行为，否则这不会有任何区别。

同时，请记住，在现实生活中，网络服务器的主机只会看到它连接到互联网的路由器的 MAC 地址，而网络服务器软件根本看不到任何东西，所以……我必须对您可能要测试的内容做出一些假设，而我很可能走错了方向。如果是这样，您可能希望更好地描述您的用例。

# c - 这是什么原因？（研究段错误的原因）

> ID：15537457
> 
> 赞同：0
> 
> 时间：2013-03-21T00:41:41.487
> 
> 标签：c, segmentation-fault

我只是在观察分段错误的原因。我在这里分配了内存，但它仍然给出了段错误。这可能是什么原因？

```
#include<stdio.h>
#include<unistd.h>
#include<stdlib.h>

void main()
{
    int **matrix,i,j;
    matrix = malloc(sizeof(int));
    **matrix = 10;
    printf("%d", **matrix);

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:45:41.167

`matrix`是一个指针（它恰好是一个指向 的指针`int`），并且您已经分配了内存（尽管可能还不够）让它指向。

`*matrix`也是一个指针（它恰好是一个指向 的指针`int`），并且您*没有*为其指向的内存分配内存，因此`*matrix`包含垃圾（或者如果您的`malloc()`调用没有分配足够的内存，则不存在）。

所以取消引用`*matrix`具有未定义的行为。你很幸运，症状很明显。

为什么要为指向分配`sizeof(int)`字节？`matrix`

你为什么要定义`void main()`而不是正确的`int main(void)`？`(void main()`最有用的方法是检测那些不太了解该语言的作者所写的书籍和教程。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:38:48.833

因为您没有正确分配内存。`matrix`是一个指向整数指针的指针，而不仅仅是一个整数指针。

正确的方法是：

（警告：我直接在浏览器上输入，不要在生产中使用）

```
#include<stdio.h>
#include<unistd.h>
#include<stdlib.h>

void main()
{
    int **matrix,i,j;
    matrix = (int **) malloc(sizeof(void *));
    *matrix = (int *) malloc(sizeof(void *));
    **matrix = 10;
    printf("%d", **matrix);

    free(*matrix);
    free(matrix);
    return 0;
} 
```

通过想象内存在每一行中的样子（地址 | 类型 | 值 {value_type}）会更容易理解发生了什么：

```
        int **矩阵，i，j；

```

```
堆：
    矩阵：0x00 | &int ** | 空{int **}
    我：0x04 | &int | 垃圾{int}
    j: 0x08 | &int | 垃圾{int}

```

因为虚拟内存，操作系统通常使用 0（或 NULL）初始化内存，但由于没有授予它，因此计算它是不好的编程。

```
        矩阵 = (int **) malloc(sizeof(void *));

```

malloc 将返回堆上空间的地址：

```
堆：
    矩阵：0x00 | &int ** | 0xA0 {int **}
    我：0x04 | &int | 垃圾{int}
    j: 0x08 | &int | 垃圾{int}
堆：
    *矩阵：0xA0 | &int * | 垃圾{int *}

```

```
        *matrix = (int *) malloc(sizeof(void *));

```

```
堆：
    矩阵：0x00 | &int ** | 0xA0 {int **}
    我：0x04 | &int | 垃圾{int}
    j: 0x08 | &int | 垃圾{int}
堆：
    *矩阵：0xA0 | &int * | 0xA4 {int *}
    **矩阵：0xA4 | &int | 垃圾{int}

```

```
        **矩阵 = 10;

```

```
堆：
    矩阵：0x00 | &int ** | 0xA0 {int **}
    我：0x04 | &int | 垃圾{int}
    j: 0x08 | &int | 垃圾{int}
堆：
    *矩阵：0xA0 | &int * | 0xA4 {int *}
    **矩阵：0xA4 | &int | 10 {int}

```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:44:50.577

```
sizeof(int) 
```

存储大小和 int、whilist

```
sizeof(*int) 
```

将大小存储到指向 int 的指针。您保留的是 a 的大小，`int`而不是 a 的大小`*int`。这就是造成问题的原因。

此外，如果您还想进行一些实际计算，您应该将 int 分配给 *int 指针。

# playframework-2.0 - 将 Play Framework 2.1 应用程序部署到 Jelastic

> ID：15537463
> 
> 赞同：1
> 
> 时间：2013-03-21T00:42:22.110
> 
> 标签：playframework-2.0, jelastic

我在这个主题上找到的资源似乎都与 Play 1.x 有关。我的应用程序是基于 Play 2.1 RC1 构建的。我的应用程序是使用 sbt 和 sbt-Play 插件构建的。我没有运行标准的 Play 安装程序（这意味着我没有“play”命令。）

我已经在本地编译并暂存了我的应用程序，它为我提供了一个充满 .jar 文件的目录以及一个名为“start”的 shell 脚本，内容如下：

```
#!/usr/bin/env sh

exec java $@ -cp "`dirname $0`/staged/*" play.core.server.NettyServer `dirname $0`/.. 
```

我想将此目录上传到 Jelastic，然后告诉它运行上面的脚本。不幸的是，我看到的所有文档都告诉我上传 .war 文件。如何将目录上传到 Jelastic，包括启动脚本，然后告诉 Jelastic 运行启动脚本？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T11:47:35.333

这看起来像一个解决方案：[https](https://github.com/dlecan/play2-war-plugin/) ://github.com/dlecan/play2-war-plugin/ - 它将 Play 打包为 WAR。

我已经成功构建了 WAR，目前正试图让数据库设置在 Jelastic 上运行。

# javascript - 使用 JavaScript 在 Safari 中意外崩溃

> ID：15537464
> 
> 赞同：1
> 
> 时间：2013-03-21T00:42:44.317
> 
> 标签：javascript, html5-canvas

我正在处理 HTML5 画布中呈现的可滚动时间轴。我已经开发了大部分功能，但我注意到 Safari 上出现意外崩溃（在 chrome 和 firefox 中不会崩溃），所以我删除了所有功能（只留下非常基本的时间线）以验证这是否成功不要改变现状。

在这里您可能会看到时间线的演示（简化为似乎导致崩溃的基本构建块）：http: [//jsfiddle.net/Saturnix/uUQtH/3/](http://jsfiddle.net/Saturnix/uUQtH/3/)

您可以单击并拖动以滚动浏览天数，如果您取消注释某些代码行，您还将看到天数和月数。

尝试从左到右滚动时间线，重复此操作，直到您的浏览器崩溃（您可能需要强制退出）。

这是我在崩溃前得到的错误：

```
TypeError: 'undefined' is not a function (evaluating 'g.ctx.lineTo(x, g.height / 1.4)') 
```

它总是看起来`g.ctx.lineTo`工作正常，但没有任何明显的原因，它停止工作。您可以尝试记录`x`，或者`g.height / 1.4`您会看到崩溃与这些值不一致。

此外，如果您取消注释打印年份和月份的行，浏览器报告的错误将不一样。这意味着**很明显，崩溃与渲染本身的功能无关**。

**可能的原因**：需要过多的 CPU。

由于它是如何实现的，所有在屏幕之外的时间线部分都被考虑在循环中（即使没有渲染）{这仅适用于从*左侧*超出屏幕的时间线部分，不是从*右边*}。我无法避免它。因此，您向右滚动的次数越多，完成循环的时间就越长（直到 javascript 阻止您）。这是绘制循环的超级简化伪代码版本：

```
start = 0;

function draw(){
    day = 0;

    for (x = start; x <= screen.width; x += 10, d += 1){

        // check if first day of the month
        if (d days from now is 1)
            draw long line at position x
        else
            draw short line at position x

    }
}

function mouseDragging(){

    // users dragging mouse cursor
    // start changes accordingly but always stays minor than 0

} 
```

如您所见，`start`将很快（如果用户愿意）达到非常低的值，从而使绘制循环很长时间才能完成。这可能是坠机的原因吗？我不认为它是：**通常当我编写长循环时，计算机开始滞后，但它永远不会在控制台中引发错误并立即崩溃**。但是，这是我看到的唯一可能的原因。

# excel - Excel VBA自动填充只返回公式

> ID：15537472
> 
> 赞同：0
> 
> 时间：2013-03-21T00:43:06.097
> 
> 标签：excel, autofill, vlookup, vba

我创建了一个宏并将其放入personal.xls 文件中。该宏假设自动填充 PhanCong.xls 中 J 列的 vlookup，但它只返回确切的公式。这是我的 Excel 文件的一部分，以说明我所说的。

![在此处输入图像描述](../Images/821e1c90b8d6d4388578ed075170e0fc.png)

第一列应该有 vlookup 值，而不是这样的公式。这是我的宏，自动填充数据的部分。

```
 "C:\Users\khoale\Desktop\PhanCong.xls"
Windows("test.xlsx").Activate
ActiveSheet.Cells(2, 1).Activate
ActiveCell.FormulaR1C1 = _
    "=VLOOKUP(RC[9],'[PhanCong.xls]Bang ma CC'!C1:C7,7,FALSE)"
Dim autoFillRow As Long
With ActiveSheet
autoFillRow = .Range("C" & Rows.Count).End(xlUp).Row
End With
Range("A2").Select
Selection.AutoFill Destination:=Range("A2:A" & autoFillRow), Type:=xlFillDefault 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:54:39.410

单元格格式`Text`将单元格的值视为文本。它不会评估任何公式。如果您希望对其进行评估，我认为您必须使用`General`. （不是 100% 确定的）

~~如果您需要将结果格式化为文本，我相信您可以做到这一点。~~

~~`=TEXT(VLOOKUP(RC[9],'[PhanCong.xls]Bang ma CC'!C1:C7,7,FALSE))`~~

只是试了一下，不，它不会有帮助！

# signalr - SignalR 超时属性

> ID：15537474
> 
> 赞同：18
> 
> 时间：2013-03-21T00:43:18.610
> 
> 标签：signalr, signalr-hub, signalr.client

我们遇到了这个链接，它指定了不同的超时属性： [https ://github.com/SignalR/SignalR/wiki/Configuring-SignalR](https://github.com/SignalR/SignalR/wiki/Configuring-SignalR)

还有这篇关于 SignalR 客户端和 SignalR 服务器之间如何断开和重新连接的精彩帖子（[何时重新连接 signalR？ ）。](https://stackoverflow.com/questions/14455916/when-does-a-reconnect-in-signalr-occour)

只是为了从上面的帖子中重新迭代不同的情况：

“当客户端脱机然后很快重新连接时会发生集线器重新连接。SignalR 配置值在很大程度上决定了以下示例的时间戳，因此不要逐字记录时间。

以下是涉及重新连接行为的几个示例及其结果（时间格式 m:ss）：

**情况一**

0:00 - 客户端连接到服务器，触发 OnConnected

0:10 - 客户端由于 ISP 问题而失去连接（并意识到它失去了连接）

0:15 - 客户端重新连接

0:16 - OnReconnected 事件被触发

**情况2**

0:00 - 客户端连接到服务器，触发 OnConnected

0:10 - 客户端由于拉动以太网电缆而失去连接（没有意识到它已断开连接）

0:15 - 客户端重新连接

这里可能会发生两件事

A: 0:16 - 没有任何反应，客户端继续之前的连接

B: 0:~45 - 客户端意识到其断开连接 *

B: 0:46 - 客户端转换到重新连接状态

B: 0:47 - 客户端成功重新连接并触发 OnReconnected 事件。

**情况 3**

0:00 - 客户端连接到服务器，触发 OnConnected

0:10 - 客户端由于拉动以太网电缆而失去连接（没有意识到它已断开连接）

0:~45 - 客户端意识到其断开连接 *

0:46 - 客户端转换到重新连接状态

1:15 - 服务器确定客户端已经离开太久然后忘记它，排队等待客户端接收的“断开连接”命令，如果它稍后重新连接。***

1:15 - OnDisconnect 被触发 1:16 - 客户端重新连接

1:17 - 客户端执行“软”重新连接（不触发 OnReconnected）

1:18 - 客户端检索“断开连接”命令

1:19 - 客户端调用“停止”并进行软断开（不触发 OnDisconnected）

**情况4**

0:00 - 客户端连接到服务器，触发 OnConnected

0:10 - 客户端由于拉动以太网电缆而失去连接（没有意识到它已断开连接）

0:~45 - 客户端意识到其断开连接 *

0:46 - 客户端转换到重新连接状态

1:15 - 服务器确定客户端已经离开太久然后忘记它，排队等待客户端接收的“断开连接”命令，如果它稍后重新连接。***

1:15 - 触发 OnDisconnect 1:30 - 客户端停止尝试重新连接（尝试时间过长）**

1:30 - 客户端转换为断开连接状态

*   由于客户端保持活动检查：用于确定客户端何时由于缺乏保持活动而离线。不用于长轮询传输

** 由于客户端断开连接超时：用于确定客户端何时重新连接太长时间，并且服务器可能在此期间忘记了客户端

*** 由于服务器断开连接超时：用于确定何时应该忘记客户端。这是一个时间跨度，一旦连接在服务器上被标记为死，就会开始累积。最终，服务器为客户端的主题排队一个断开命令，告诉客户端（如果它重新连接）它需要开始一个新的连接。清理主题后，该命令将从服务器中消失。”

* * *

我们发现，我们经常在 .NET SignalR 客户端和 ASP.NET MVC SignalR 服务器之间断开和重新连接（上面的 1 和 2），并且断开连接不会导致重新连接（上面的 3 和 4）。我们知道正在使用 ServerSentEvents 协议。

很难知道我们需要调整（增加或减少）哪些超时属性：

1.  减少断开和重新连接的次数。
2.  根本不会出现在情况 3 和 4 中。

这里需要注意的重要一点是，我们的 .NET SignalR 客户端实际上是一个始终连接到服务器的 Windows 服务。

我们目前只保留了默认值，它们是：

*   连接超时 = 110 秒
*   DisconnectTimeout = 30 秒
*   KeepAlive = 30 秒

此外，我们使用的是 SignalR 1.0.1。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T03:18:00.020

.NET 客户端还*没有*这种行为。如果客户端突然断开连接，它将不会重新连接。它将在 1.1 中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-21T01:06:43.457

您的超时设置正确。在当前版本中，.net 客户端没有客户端保持活动状态，以确保客户端保持连接。

在下一个版本中，您将拥有一个 .net 客户端保持活动状态。如果您愿意使用该项目的开发版本，则该功能目前在开发分支[https://github.com/SignalR/SignalR/tree/dev](https://github.com/SignalR/SignalR/tree/dev)上可用。

同样作为参考，这里是与您所看到的内容相关的问题[https://github.com/SignalR/SignalR/issues/741](https://github.com/SignalR/SignalR/issues/741)。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-21T01:15:24.677

您使用的是 SignalR 1.0.1 吗？Taylor 对重新连接过程的描述适用于 SignalR 版本 >= 1.0 和 JS 客户端。我问的原因是因为在 SignalR >= 1.0 中，`KeepAlive`必须不超过`DisconnectTimeout`. the`KeepAlive`和 the`DisconnectTimeout`绝对不能相等。

但是，如果 1.0.* 您设置`DisconnectTimeout`after `KeepAlive`，keep-alive 将设置为`DisconnectTimeout`. 在您的情况下，这将是 10 秒的默认值。

SignalR 1.0 中解决了很多问题，因此如果您还没有升级，那么绝对值得升级。但是，正如其他答案所指出的那样，.NET 客户端将不支持保持活动检查，并且在 1.1 之前不会识别网络电缆已被拔出

`Connection`PS如果您意识到它以某种方式断开连接，您可以随时手动重新启动。在这种情况下，您的连接 ID 当然会改变。

# java - 缺少返回语句，递归方法

> ID：15537477
> 
> 赞同：-2
> 
> 时间：2013-03-21T00:43:26.520
> 
> 标签：java, recursion, return

我不断收到错误

> Palindrome.java:36：错误：缺少返回语句 } ^ 1 错误

当我尝试编译时，对于实验室我必须有一个递归方法，如果输入字符串是忽略非字母字符的回文，则返回 true。那么问题是什么，我该如何解决它。

```
package lab07;

import java.util.Scanner;

public class Palindrome{
   public static void main(String[] args){
      Scanner input = new Scanner(System.in);
      while ( input.hasNext()){
        String line =  normalise(input.next());
      System.out.println(isPalindrome(line));
      }
}
   public static String normalise(String line){
    String s = "";
    char[] chars = line.toCharArray();
    for (int i = 0; i < chars.length; i++){
        if ( Character.isLetter(chars[i]))
        s += Character.toLowerCase(chars[i]);
}
    return s;
   }
   public static boolean isPalindrome(String line){
    if ( line.length() > 1 ){
        if (line.charAt(0) == line.charAt(line.length()-1)){
            isPalindrome(line.substring(1, line.length()-1));
        }
        else
            return false;

    }
    else
        return true;
   } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:45:45.890

您缺少`return`内部`if`条件中的语句

```
 public static boolean isPalindrome(String line){
    if ( line.length() > 1 ){
        if (line.charAt(0) == line.charAt(line.length()-1)){
            isPalindrome(line.substring(1, line.length()-1));
               // MISSING RETURN HERE
        }
        else
            return false;

    }
    else
        return true;
   } 
```

*每个可能的*`return`条件都需要有一个。

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T00:53:18.410

您需要返回递归案例的结果：

```
 public static boolean isPalindrome(String line){
    if ( line.length() > 1 ){
        if (line.charAt(0) == line.charAt(line.length()-1)){
            return isPalindrome(line.substring(1, line.length()-1));

        }
        else
            return false;

    }
    else
        return true;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:45:26.017

```
if (line.charAt(0) == line.charAt(line.length()-1)){
            isPalindrome(line.substring(1, line.length()-1));
    //specify return here    
        }

Here  no return; 
```

您指定了返回类型布尔值。因此，在所有可能的情况下，您都需要提供返回类型。*

# javascript - 如何将 JavaScript 变量传递给 Raphael 函数？

> ID：15537478
> 
> 赞同：0
> 
> 时间：2013-03-21T00:43:27.523
> 
> 标签：javascript, raphael

这段代码应该在 Raphael 论文上画出两个正方形：

```
var paper = Raphael("canvas", 1100, 750);
var numbers = "0,0,250,180";
var box1 = paper.rect(numbers);
var box2 = paper.rect(250, 0, 250, 180); 
```

但是，实际上只有 box2 被绘制。如何传入变量集以绘制框 1？

[http://jsfiddle.net/xqwBB/](http://jsfiddle.net/xqwBB/)

谢谢，凯文

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:36:18.313

通常，您可以使用[`Function#apply`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/apply)字符串并将其拆分为数组。 `apply`将调用函数，第一个参数为 as `this`，第二个参数为参数数组：

```
var box1 = paper.rect.apply(paper, numbers.split(",")); 
```

[jsFiddle](http://jsfiddle.net/xqwBB/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:51:06.550

1个变量数字=“0,0,250,180”；

在这里，您正在创建一个字符串，同时`.rect()`将四个数字作为参数。

如果您的参数以字符串的形式出现，请将其拆分并调用 .rect()

```
var numbers = "0,0,250,180";
numbers = numbers.split(","); // now numbers is an array
canvas.rect(numbers[0], numbers[1], numbers[2], numbers[3]); 
```

# python - 乘法组合算法

> ID：15537479
> 
> 赞同：11
> 
> 时间：2013-03-21T00:43:29.987
> 
> 标签：python, algorithm, iteration

### 问题：

给定一个数字 n，是否有一种有效的算法可以从集合 {1...n} 中获取 2 个组合的列表，按组合乘积的值排序？

我需要这个来确定满足特定条件的两个 * 数字的最大乘积。如果列表是未排序的，我必须首先确定所有满足条件的组合，然后遍历这些组合以找到具有最大产品的组合，这是低效的。

例如，给定 n = 3，可能的组合是：

```
Combination:      Product:
   3, 3              9
   3, 2              6
   3, 1              3
   2, 2              4
   2, 1              2
   1, 1              1 
```

按产品的价值降序排列，这是：

```
Combination:      Product:
   3, 3              9
   2, 3              6
   2, 2              4
   1, 3              3
   1, 2              2
   1, 1              1 
```

### 额外背景：

我刚刚解决了一个 Project Euler 问题，该问题是关于找到两个 3 位数字乘积的最大回文数。我的方法是从 999（最大的 3 位数字）用两个因素向下迭代并找到每个组合的乘积，另外检查该数字是否是回文：

```
def maxpal():
    for i in reversed(range(100,1000)):

        # Since we only want unique combinations, we only
        # need to iterate up to i

        for j in reversed(range(100,i)):   
            if str(i*j) == str(i*j)[::-1]:
                yield i*j

print max(maxpal()) 
```

请注意，示例中的第一个列表以与此代码完全相同的顺序迭代因子。我最初的假设是，由于我向下迭代，我发现的第一个回文将是最大的。这显然不是这种情况，因为在递减`j`之前一直迭代到 100 。`i`

我正在寻找一种迭代方法，使产生的值按降序排列，因为这使我只需调用`next(maxpal)`一次就可以得到答案，这样效率更高。

编辑：

为了不取消非 Python 语言的好答案的资格，我可以尝试使用任何语言，只要您解释它以便我（或其他任何人）能够充分理解它。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T01:12:19.107

您可以使用堆/优先级 Q。

从 (n,n) 开始，插入到堆中。您的比较功能 = 比较产品。

每当您提取 (x,y) 时，如果需要，您可以插入 (x-1,y) 和 (x,y-1)（如果需要，您可以维护一个哈希表来检查是否存在欺骗）。

这是一些快速（且外观丑陋）的代码来演示上述内容。请注意，这是一个惰性迭代器，允许我们执行下一步并在满足您的条件后立即停止。（注意：使用 larsman 的建议（下面的评论）会更好，但想法是相似的）

```
import heapq

def mult_comb(n):
    heap = []
    visited = {}
    visited[n*n] = True
    prod = n*n
    heapq.heappush(heap, (-prod, n, n))
    while prod > 1:
        (prod,x,y) = heapq.heappop(heap)
        yield -prod,x,y
        prod = -prod

        prod1 = (x-1)*y
        prod2 = x*(y-1)
        if not prod1 in visited:
            heapq.heappush(heap, (-prod1, x-1,y))
            visited[prod1] = True
        if not prod2 in visited:
            heapq.heappush(heap, (-prod2, x,y-1))
            visited[prod2] = True

def main():
    for tup in mult_comb(10):
        print tup

if __name__ == "__main__":
    main() 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T05:32:28.157

问题中的循环模式就像

```
for i in reversed(range(100,1000)):
    for j in reversed(range(100,i)):   
        if str(i*j) is palindromic, yield i*j 
```

并且要求的解决方案是找到一种方法以降序传递与循环测试相同的数字。上面的代码生成了 404550 个 i,j 对；其中 1231 对是回文；2180 对大于最终结果 906609 = 913*993。

到目前为止建议的方法可能会生成所有或许多可能的配对；那些只生成少数可能对的人仍然会测试比必要更多的数字对。

相比之下，以下代码仅测试 572 对，其中 3 对是回文。它主要取决于两个观察结果：首先，任何六位回文数都是 11 的倍数，因为任何数字形式的数字`abccba`都等于`a*100001 + b*10010 + c*1100`，并且 100001、10010 和 1100 中的所有三个都是 11 的倍数。其次，如果我们最好找到到目前为止有值 k 并且我们正在测试 i 的给定值，`i≤j`然后不需要测试 any`j < k/i`或 any `j<i`。

```
def pal():
    nTop = 1000;    best, jin, jpal = 0, 0, 0
    # Test pairs (i, j) with i <= j
    for i in range(nTop, nTop//10-1, -1):
        jDel = 11 if i%11 else 1
        jHi = (nTop//jDel)*jDel
        jLo = max(i, best//i) - 1;
        for j in range(jHi, jLo, -jDel):
            jin += 1
            if str(i*j)==str(i*j)[::-1] :
                jpal += 1
                best = max(best, i*j)
    return (best, jin, jpal) 
```

使用上面的代码，`pal()`返回元组 (906609, 572, 3)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T01:35:07.390

您可以像这样生成集合：

```
>>> n=3
>>> s={(min(x,y),max(x,y)) for x in range(1,n+1) for y in range(1,n+1)}
>>> s
set([(1, 2), (1, 3), (3, 3), (2, 3), (2, 2), (1, 1)]) 
```

并像这样排序：

```
>>> sorted(s,key=lambda t: -t[0]*t[1])
[(3, 3), (2, 3), (2, 2), (1, 3), (1, 2), (1, 1)] 
```

但是你根本不需要这样做。只需使用嵌套理解：

```
>>> [(x,y) for x in range(3,0,-1) for y in range(3,x-1,-1)]
[(3, 3), (2, 3), (2, 2), (1, 3), (1, 2), (1, 1)] 
```

这导致了针对该特殊问题的一条线：

```
print max(x*y for x in range(1000,100,-1) for y in range(1000,x-1,-1) 
          if str(x*y)==str(x*y)[::-1]) 
```

如果你真的想按照你建议的方式去做，你可以使用`bisect`：

```
def PE4():
    import bisect

    def ispal(n):
        return str(n)==str(n)[::-1]

    r=[]
    for x in xrange(1000,100,-1):
        for y in xrange(1000,x-1,-1):
            if ispal(x*y): bisect.insort(r,(x*y,x,y))

    return r[-1] 
```

该列表`r`以递增顺序结束，因为这是 bisect 支持的唯一顺序。

您还可以使用`heapq`：

```
def PE4_4():
    import heapq

    def ispal(n): return str(n)==str(n)[::-1]

    r=[]
    for x in xrange(100,1001):
        for y in xrange(x,1001):
            if ispal(x*y): heapq.heappush(r,(-x*y,x,y))     

    return (-r[0][0],r[0][1],r[0][2]) 
```

如果我计时这些：

```
import timeit

def PE4_1():
    def ispal(n): return str(n)==str(n)[::-1]
    return max((x*y,x,y) for x in xrange(1000,99,-1) for y in xrange(1000,x-1,-1) if ispal(x*y))

def PE4_2():
    import bisect
    def ispal(n): return str(n)==str(n)[::-1]
    r=[]
    for x in xrange(1000,99,-1):
        for y in xrange(1000,x-1,-1):
            if ispal(x*y): bisect.insort(r,(x*y,x,y))

    return r[-1]

def PE4_3():
    import bisect
    def ispal(n): return str(n)==str(n)[::-1]
    r=[]
    for x in xrange(100,1001):
        for y in xrange(x,1001):
            if ispal(x*y): bisect.insort(r,(x*y,x,y))

    return r[-1]

def PE4_4():
    import heapq
    def ispal(n): return str(n)==str(n)[::-1]
    r=[]
    for x in xrange(100,1001):
        for y in xrange(x,1001):
            if ispal(x*y): heapq.heappush(r,(-x*y,x,y))     

    return (-r[0][0],r[0][1],r[0][2])         

n=25
for f in (PE4_1,PE4_2,PE4_3,PE4_4):
    fn=f.__name__
    print fn+':'
    print '\t',f()
    res=str(timeit.timeit('{}()'.format(fn),setup="from __main__ import {}".format(fn), number=n))
    print '\t'+res+' seconds\n' 
```

它打印：

```
PE4_1:
    (906609, 913, 993)
    10.9998581409 seconds

PE4_2:
    (906609, 913, 993)
    10.5356709957 seconds

PE4_3:
    (906609, 913, 993)
    10.9682159424 seconds

PE4_4:
    (906609, 913, 993)
    11.3141870499 seconds 
```

表明该`bisect`方法略快，其次是生成器的最大值。`heapq`是最慢的方法（勉强）

长答案，但可能产生您想要的列表顺序的最佳方法是以这种方式排序：

* * *

我对 Knooth 的解决方案进行了计时，找到第一个带有约束的数字非常优越：

```
def PE4_6():
    def ispal(n): return str(n)==str(n)[::-1]
    def gen(n=1000):
        heap=[]
        visited=set([n*n])
        prod=n*n
        heapq.heappush(heap,(-prod,n,n))
        while abs(prod)>1:
            (prod,x,y)=heapq.heappop(heap)
            yield -prod,x,y
            p1,p2=(x-1)*y, x*(y-1)
            if p1 not in visited:
                heapq.heappush(heap, (-p1, x-1,y))
                visited.add(p1)
            if p2 not in visited:
                heapq.heappush(heap, (-p2, x,y-1))
                visited.add(p2)

    it=iter(gen())
    t=next(it)
    while not ispal(t[0]):
        t=next(it)

    return t 
```

但是找到整个列表的速度较慢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T00:58:18.933

给定一个数字 n，是否有一种有效的算法可以从集合 {1...n} 中获取 2 个组合的列表，按组合乘积的值排序？

不太确定你在追求什么，但这是在 python 中编码的一种简单方法：

```
n = SOME_INTEGER
from itertools import combinations
sorted(combinations(set(xrange(1,n+1)),2),key=lambda x: x[0]*x[1]) 
```

或者，首先是最大的产品：

```
sorted(combinations(set(xrange(1,n+1)),2),key=lambda x: x[0]*x[1],reverse=True) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-21T01:37:38.737

你知道当 b > c 时 (a, b) 总是在 (a, c) 之前。所以你可以只保留每个类的一个代表 [(a, b), (a, b-1), (a, b-2), ...]，然后在这些中进行选择。使用堆。此实现需要 O(n^2*log(n)) 时间和 O(n) 空间：

```
import heapq

def combinations_prod_desc(n):
    h = [(-i*i, i, i) for i in xrange(1, n+1)]
    h.reverse()

    while len(h) > 0:
        u = h[0]
        yield u
        b = u[2]
        if b <= 1:
            heapq.heappop(h)
            continue
        a = u[1]
        b -= 1
        heapq.heappushpop(h, (-a*b, a, b))
    return 
```

从 Python 2.6 开始，heapq 模块内置了合并算法。利用这一点，我们可以获得相同算法的单行实现：

```
def combinations_prod_desc_compact(n):
    return heapq.merge(*[(lambda a : ((-a*b, a, b) for b in xrange(a, 0, -1)))(a) for a in xrange(1, n+1)]) 
```

由于 Python 推导式的语义上的怪异，上面的以下幼稚版本不起作用。如果有人有兴趣探索 Python 的语言规范，那么查找以下代码没有给出我们想要的结果的确切原因会很有趣，即使它看起来“应该”：

```
def combinations_prod_desc_nonworking(n):
    return heapq.merge(*[((-a*b, a, b) for b in xrange(a, 0, -1)) for a in xrange(1, n+1)]) 
```

# cordova - 如果没有互联网连接（PhoneGap），如何显示消息/图片警报？

> ID：15537486
> 
> 赞同：1
> 
> 时间：2013-03-21T00:44:41.773
> 
> 标签：cordova, wifi, alert

**问题（PhoneGap）：**

1.  如果没有互联网连接，如何显示消息/图片警报？
2.  如何防止用户在警报后使用/完全打开应用程序（退出应用程序并稍后显示警报，直到用户连接到 Internet）？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T23:04:04.743

[这里](http://docs.phonegap.com/en/2.5.0/cordova_connection_connection.md.html#Connection)有关于这方面的 Phonegap 文档。它讨论了为各种连接状态创建“警报”。

我在 Android 以外的平台上没有太多经验，但如果您使用 Phonegap[数据库功能](http://docs.phonegap.com/en/2.5.0/cordova_storage_storage.md.html#Storage)，如果应用程序被“强制关闭”或只是暂停，数据存储在表中是持久的。

为了实现您要查找的内容，我将创建一个非常简单的表，其布尔值对应于是否存在网络可用性，该表通过基于[定时 javascript 函数](https://stackoverflow.com/questions/2170923/whats-the-easiest-way-to-call-a-function-every-5-seconds-in-jquery)的函数调用进行更新。然后，一个简单的`if(){}`语句可以检查数据库值并限制或启用应用程序中的功能。

根据您希望数据的持久性，您还可以取消数据库，只需进行定时调用以返回网络状态。

# javascript - JavaScript 数组有一个导致麻烦的第 3 方原型，我怎样才能恢复正常行为？

> ID：15537488
> 
> 赞同：0
> 
> 时间：2013-03-21T00:44:57.887
> 
> 标签：javascript, wordpress

我正在解决网站上我的 WP 插件中的 JS 冲突。当我使用创建一个空数组时

```
var myArray = []; 
```

或者

```
var myArray = new Array(); 
```

说`console.log(myArray);`：

```
[randomize: function] 
```

代替

```
[] 
```

数组的长度保持为 0。可以在这里看到随机化函数的位置：http: [//postimage.org/image/j67yqby5t/](http://postimage.org/image/j67yqby5t/)在 chrome 中，我单击了“显示函数定义”，它是由一个名为 LayerSlider 的 WP 插件添加的。

```
 Array.prototype.randomize = function () {
    var e = this.length,
        t, n, r;
    if (e == 0) return false;
    while (--e) {
        t = Math.floor(Math.random() * (e + 1));
        n = this[e];
        r = this[t];
        this[e] = r;
        this[t] = n
    }
    return this
}; 
```

我应该怎么做（也许是暂时的）将其恢复为正常的空数组？或者只是从数组中删除所有非本地元素？

顺便说一句，当我迭代它时出现了问题

```
for(var i in myArray ){ ... } 
```

并将函数视为额外元素。当时我已经添加了数字索引元素。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:53:22.567

第一条规则是，如果您只想遍历数组的数字属性（即索引），请使用带有计数器的 for、do 或 while 循环。

如果您使用 for..in，那么您应该包含一个[`hasOwnProperty`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.2.4.5)测试以避免迭代通过`[[Prototype]]`链继承的命名属性。

```
for (var p in obj) {
  if (obj.hasOwnProperty(p)) {
    // p isn't inherited, do stuff with obj[p]
  }
} 
```

最后，您可能可以使用`delete`运算符从 Array.prototype 中删除该方法，但您加载的库可能正在使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:54:04.810

如果 wordpress 插件覆盖了原生的 javascript 数组，你什么也做不了。他们可以通过将函数绑定到数组的原型来做到这一点：

```
Array.prototype.randomise = function(){
    //some code...
}; 
```

如果它是索引数组，您可以制作 for(var i=0.. 循环，如果它是 hashmap，您可以使用 typeof 询问 item 是否是函数：

```
for(var val in arr){
    if(typeof(arr[val]) != 'function'){
        //do something
    }
} 
```

# python - 带有 mod_wsgi 和 python 的 Apache 定期返回 500

> ID：15537500
> 
> 赞同：1
> 
> 时间：2013-03-21T00:45:48.210
> 
> 标签：python, apache2, flask, wsgi

我有一个在 Python 和 Flask 上运行的网站。10 次中有 4 次返回 500 错误，据我所知是随机的。

```
from flask import Flask

app = Flask(__name__)

@app.route("/")
def index():
    return "Hello world!" 
```

这是我的 .wsgi 文件（我正在使用 virtualenv，并在导入应用程序之前激活它）：

```
activate_this = '/path/to/app/venv/bin/activate_this.py'
execfile(activate_this, dict(__file__=activate_this))

from myapp import app as application 
```

这是我的 Apache 主机配置：

```
<VirtualHost *:80>
    ServerName website.com

    WSGIDaemonProcess myapp user=ubuntu group=ubuntu processes=2 threads=5
    WSGIScriptAlias / /path/to/app/myapp.wsgi

    <Directory /path/to/app>
        WSGIProcessGroup myapp
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
    </Directory>
</VirtualHost> 
```

欢迎任何调试这个的指针！

**编辑：**

Apache 错误日志：

```
mod_wsgi (pid=29581): Target WSGI script '/path/to/app/myapp.wsgi' cannot be loaded as Python module.
mod_wsgi (pid=29581): Exception occurred processing WSGI script '/path/to/app/myapp.wsgi'.
Traceback (most recent call last):
  File "/path/to/app/myapp.wsgi", line 4, in <module>
    from myapp import app as application
ImportError: No module named myapp 
```

两个进程之一（29581）似乎没有运行 virtualenv 位，因此没有找到要导入的文件。

**编辑2：**

这是在 PATH 中找不到的本地文件 myapp.py。我需要将它包含在我的 .wsgi 文件的顶部：

```
import sys
sys.path.insert(0, '/path/to/myapp')

activate_this = '/path/to/myapp/venv/bin/activate_this.py'
execfile(activate_this, dict(__file__=activate_this))

from myapp import app as application 
```

# collections - pop 是否抛出异常？

> ID：15537505
> 
> 赞同：3
> 
> 时间：2013-03-21T00:46:23.950
> 
> 标签：collections, concurrency, clojure

该`pop`函数的文档说：

```
user> (doc pop)
-------------------------
clojure.core/pop
([coll])
  For a list or queue, returns a new list/queue without the first
  item, for a vector, returns a new vector without the last item. If
  the collection is empty, throws an exception. 
```

但是我似乎无法重现应该抛出异常的行为。

例如，在这里我将三个元素添加到队列中，然后`pop`五次：根据文档，这不应该工作。但是，我没有例外，而是零。

```
(peek (pop (pop (pop (pop (pop (conj (conj (conj clojure.lang.PersistentQueue/EMPTY 4) 5) 6))))))) 
```

现在我很喜欢在尝试从空队列中返回一个空队列而不是抛出异常`pop`但我想了解为什么行为与文档不同（至少从我阅读文档中了解到的） .

基本上我想知道我是否应该在这里“保护”自己免受异常的影响，或者我是否可以安全地假设`pop`一个空队列应该总是返回一个空队列（这与文档相矛盾）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:35:17.173

您是对的，文档字符串中确实存在矛盾。目前，弹出一个空队列会给出一个空队列。[从PersistentQueue 源代码中](https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/PersistentQueue.java)的评论来看，核心开发人员似乎正在讨论所需的行为：

```
public PersistentQueue pop(){
    if(f == null) //hmmm... pop of empty queue -> empty queue?
        return this;
    //throw new IllegalStateException("popping empty queue");
    ISeq f1 = f.next();
    PersistentVector r1 = r;
    if(f1 == null)
        {
        f1 = RT.seq(r);
        r1 = null;
        }
    return new PersistentQueue(meta(), cnt - 1, f1, r1);
} 
```

假设这种行为将来永远不会改变，我认为自己不安全。

# uml - 表示用户与网络不同部分的交互的图表

> ID：15537506
> 
> 赞同：1
> 
> 时间：2013-03-21T00:46:24.800
> 
> 标签：uml, cloud, system, interaction

谁能推荐一个合适的图表来表示用户在执行不同任务时与不同物理系统的交互？

我认为类似于 UML 序列图的东西会很好，但我认为它们更多地用于 OO 编程而不是系统交互..？

这是代表一个非 OO PHP 软件，它与不同的云技术交互，以评估在当前技术状态下某个概念是否可行。该软件已经构建，图表的目的是用于随附的研究论文。

有三个关键过程可以测试同一系统的不同区域，尽管它们都是相关的。我不确定是一张大图还是三个小图更好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:57:47.153

如果您想强调正在交换**哪些消息，那么序列图是合适的。**虽然它们用于 OO 模型，但经常在网络文献中找到它们（例如[此图](http://upload.wikimedia.org/wikipedia/commons/5/55/TCP_CLOSE.svg)）。

如果您想强调**控制流**，那么您可以使用*活动图*或*交互概览图*（这是一个活动图，其中节点将交互描述为序列片段）。

# jquery - AngularJS 和指令的初学者问题 - 包装 jQuery 组件

> ID：15537508
> 
> 赞同：6
> 
> 时间：2013-03-21T00:46:30.793
> 
> 标签：jquery, angularjs

首先，我应该提到我正在努力过渡到客户端编程。我对 js 很陌生。我以前的经验主要是 C 和一些汇编。几年前我还做了一些非常简单的 php，当时它还是 4.0。简而言之，对 javascript 来说是新手，但我会稍微考虑一下。

我已经做了很多搜索和潜伏，但无法纠正我的问题。

我正在弄清楚 AngularJS 的一些基础知识，它非常好，但是我很难理解指令的工作原理以及如何从自定义控件访问数据。

长话短说，我正在尝试使用 angularjs 为引导程序制作一个自定义控件，以便我可以在表单中正确使用它。

这是控件：[http ://tarruda.github.com/bootstrap-datetimepicker/](http://tarruda.github.com/bootstrap-datetimepicker/)

我还有一些其他的控件想要进行，但我想如果我可以让这个控件运行起来，我可能会很容易地得到其他控件。

这是我目前拥有的基本框架的链接：http: [//jsfiddle.net/uwC9k/6/](http://jsfiddle.net/uwC9k/6/)

首先，我试图在模板工作后如何初始化控件（我认为此时我几乎是这样做的）

```
link: function(scope, element, attr) {
            attr.$observe('dpid', function(value) {
                if(value) {
              $('#' + scope.dpid).datetimepicker({
                  language: 'en',
                  pick12HourFormat: true
            });
} 
```

当我把它放在链接指令中时，它什么也不做。我什至没有看到任何错误。scope.dpid 确实显示了控件的 ID，所以我认为它会起作用。但是，唉，我对 javascript 的微弱理解告诉我，我超出了范围，或者一些我无法访问该元素的废话。

一旦我开始这样做，我也不完全确定如何以表格形式访问这些数据。

任何帮助是极大的赞赏。

**更新** 得到了基本的工作，现在我需要知道如何将数据从新控件获取到我的控制器中。这是更新的新 jsfiddle 的链接。 [http://jsfiddle.net/tmZDY/1/](http://jsfiddle.net/tmZDY/1/)

**更新 2** 我想我对如何使这些数据可访问有一个想法，但是我对 javascript 知识的缺乏让我再次感到厌烦。

当我创建对象时，我就是这样做的。

```
var elDatepicker = element.datetimepicker({
language : 'en',
pick12HourFormat : true,
}); 
```

但是，当我尝试使用这个对象时，它似乎没有得到正确的对象，或者我只是缺少一些基本知识。无论哪种方式，这肯定会让我感到愚蠢。

```
console.log(elDatepicker.getDate()); 
```

这个失败了，getDate确实是一个方法，至少在插件的代码中看起来是这样的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:54:51.590

`find()`您可以先`div`使用模板，然后再应用，而不是隔离范围`datetimepicker()`。所以你不需要`id`在你的HTML中：

```
<datepicker model="mydate"></datepicker>
mydate = {{mydate}} 
```

我还建议`replace: true`：

```
.directive('datepicker', function ($parse) {
    return {
        restrict: 'E',
        replace: true,
        template: '<div class=\"well\"><div class=\"input-append\">'
         + '<input data-format=\"MM/dd/yyyy HH:mm:ss PP\" type=\"text\"></input>'
         + '<span class=\"add-on\"><i data-time-icon=\"icon-time\" data-date-icon=\"icon-calendar\"></i></span>'
         + '</div></div>',
        link: function (scope, element, attr) {
            var picker = element.find('div').datetimepicker({
                language: 'en',
                pick12HourFormat: true
            });
            var model = $parse(attrs.model);
            picker.on('changeDate', function(e) {
               console.log(e.date.toString());
               console.log(e.localDate.toString());
               model.assign(scope, e.date.toString());
               scope.$apply();
           });
        }
    };
}) 
```

[小提琴](http://jsfiddle.net/mrajcok/B9bt7/)

[$parse](http://docs.angularjs.org/api/ng.%24parse)有点棘手。我展示的是它的主要用例：我们解析一个属性并返回一个函数，该函数有一个`assign()`允许我们更改范围属性的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T02:14:05.490

一种方法可能是这样，如this fiddle所示。[http://jsfiddle.net/uwC9k/10/](http://jsfiddle.net/uwC9k/10/)

由于`datepicker`必须用模板字符串替换元素，这将是使用 compile 函数的一个很好的用例。所以在编译函数里面我用模板字符串替换`datepicker`元素。

编译完成后，我们将进入链接函数，它只是从编译函数内部返回的函数。链接函数将`<div class=\"input-append\">`使用日期选择器功能初始化此元素

```
element.datetimepicker({
                      language: 'en',
                      pick12HourFormat: true
                }); 
```

由于您包含 jquery，因此链接函数中的元素属性是 jquery 扭曲元素。因此，您可以立即调用该`datetimepicker`方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T03:04:10.647

您可以向必须转换为 datetimepicker 的 div 添加一个类`datetimepicker`，然后使用该类查找元素。

```
.directive('datepicker', function() {
    return {
        restrict: 'E',
        template: '<div class=\"well\"><div id={{dpid}} class=\"input-append datetimepicker\"><input data-format=\"MM/dd/yyyy HH:mm:ss PP\" type=\"text\"></input>    <span class=\"add-on\"><i data-time-icon=\"icon-time\" data-date-icon=\"icon-calendar\">      </i>    </span>  </div></div>',
        scope: { dpid: '@'},
        link: function(scope, element, attr) {
            attr.$observe('dpid', function(value) {
                if(value) {
              $(element).find('.datetimepicker').datetimepicker({
                  language: 'en',
                  pick12HourFormat: true
            });
                }
            });
        }
    };
}) 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/uwC9k/11/)

# c# - 将这种字符串解析为 DateTime -“2013 年 3 月 22 日星期五”（C#）

> ID：15537510
> 
> 赞同：5
> 
> 时间：2013-03-21T00:46:44.097
> 
> 标签：c#, datetime-parsing

我有一大堆这样的文字：

*....建议 2013 年 3 月 22 日星期五有可能被宣布为一天......*

我必须在其中找到并解析 DateTime（2013 年 3 月 22 日星期五）。我可以找到它并使用 DateTime.TryParse 来获取几乎所有内容，但是序数后缀 (st,nd,rd,th) 让我失望。

当我在调用 TryParse 方法之前构造格式字符串时，是否有任何通配符可以用来考虑这些后缀？或者有什么其他建议？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T00:51:20.170

使用 替换不需要的字符怎么样`regex`？

例如，以下正则表达式应该可以完成这项工作：`"(?<=\d)[a-z]{2}"`.

**示例代码**

```
string date = "Friday 22nd March 2013";
var r = new Regex(@"(?<=\d)[a-z]{2}");
String result = r.Replace(date, "");
Console.WriteLine(DateTime.Parse(result, CultureInfo.InvariantCulture)); 
```

**输出：**

```
22/03/2013 00:00:00 
```

这应该处理大多数情况，但请确保正确测试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T02:03:56.410

你总是可以蛮力它。

注意：我将借用 Fuji 的一些代码，以便我们拥有相同的外观和感觉。

```
string date = "Friday 22nd March 2013";
string[] split = date.Split(' ');
string dayOfWeek = split[0]; // throw away & don't need
int day = Convert.ToInt32(split[1].SubString(0, split[1].Length - 2);
int month = 0;
switch (split[2]) {
  case "January": month = 1; break;
  case "February": month = 2; break;
  case "March": month = 3; break;
  case "April": month = 4; break;
  case "May": month = 5; break;
  case "June": month = 6; break;
  case "July": month = 7; break;
  case "August": month = 8; break;
  case "September": month = 9; break;
  case "October": month = 10; break;
  case "November": month = 11; break;
  case "December": month = 12; break;
}
int year = Convert.ToInt32(split[3]);
var dateTime = new DateTime(year, month, day);
Console.WriteLine(dateTime); 
```

不是 100% 我得到了正确的“新日期时间”构造函数。我现在没有运行我的 IDE。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-06-09T11:47:05.253

有一个[允许多个格式字符串](https://msdn.microsoft.com/en-us/library/332de853(v=vs.110).aspx)[的重载`DateTime.Parse`](https://msdn.microsoft.com/en-us/library/332de853(v=vs.110).aspx)- 您可以将序数作为文字字符串传递，就像这个辅助方法（使用线程语言环境来计算月/日名称拼写）：

```
private static DateTime ParseOrdinalDateTime(string dt)
{
    string[] expectedFormats = new[] {
                                        "dddd d'st' MMMM yyyy",
                                        "dddd d'nd' MMMM yyyy",
                                        "dddd d'rd' MMMM yyyy",
                                        "dddd d'th' MMMM yyyy"
                                      };

    return DateTime.ParseExact(dt, expectedFormats, null, DateTimeStyles.None);
} 
```

# cocos2d-iphone - cocos2d中精灵的边界？

> ID：15537516
> 
> 赞同：0
> 
> 时间：2013-03-21T00:47:28.530
> 
> 标签：cocos2d-iphone

我的屏幕上有各种精灵，它们正在追逐他们的目标。这一切都很好。

我的问题是，有没有办法设置边界？我不希望他们能够在屏幕上移动到 160 点以上？

我看到的每个示例总是使用box2d，有没有办法严格使用cocos2d？

```
- (void)addPlayers {
    winSize = [CCDirector sharedDirector].winSize;
    _officer = [[Officer alloc] initWithLayer:self];
    _officer.position = ccp(winSize.width/2, 40);
    _officer.tag = 1;
    [_batchNode addChild:_officer];

    _shotCaller = [[ShotCaller alloc] initWithTeam:2 layer:self];
    //create spawn point
    _shotCaller.position = ccp(100, 100);
    [_batchNode addChild:_shotCaller];

    NSString *gunName = [NSString stringWithFormat:@"gun.png"];
    _gun = [CCSprite spriteWithSpriteFrameName:gunName];
    _gun.anchorPoint = ccp(0.5, 0.25);
    _gun.position = ccp(_shotCaller.contentSize.width/2, _shotCaller.contentSize.height/2 -   20);
    [_shotCaller addChild:_gun];
    [self moveRandom:_shotCaller];

    NSMutableArray *team1GameObjects = [NSMutableArray arrayWithObject:_officer];
    NSMutableArray *team2GameObjects = [NSMutableArray arrayWithObject:_shotCaller];
    _gameObjects = [NSMutableArray arrayWithObjects:team1GameObjects, team2GameObjects, nil];
}

for(CCSprite *myNode in _gameObjects)
{
    if (myNode.position.y == 160 ) {
        NSLog(@"1");
        [self checkCollision];
    }
} 
```

我一直收到这个错误？-[__NSArrayM 位置]：无法识别的选择器发送到实例 0x84597b0

我想要做的就是让精灵在 160 处停止，以及 checkCollision 方法的用途。只需将其位置设置为 160。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:53:39.707

当他们达到他们的门槛时，你希望他们做什么？

您可以在预定的更新方法中检查它们。

在你的 init 的某个地方你可以运行

```
[self schedule:@selector(update:)]; 
```

这将在每一帧调用更新方法。

```
- (void)update:(ccTime)dt
{
     for (CCSprite *s in self.arrayOfSpritesToCheck)
     {
           if(s.position.y > 160) {
                 //Do something
           }
     }
} 
```

至于您更新的问题，您在`NSMutableArray`. 您的 gameObjects 数组是一个数组数组。当您这样做`for (CCNode *myNode in _gameObjects)`时，不能保证出来的对象将是 CCNode 的，实际上在您的情况下它们是`NSMutableArray`'。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T19:50:18.533

您可以在 sprite（游戏对象）类中覆盖 setPosition 方法，并将垂直位置限制为永远不会超过 160。

# java - 如何重置默认启动器/主屏幕更换？

> ID：15537522
> 
> 赞同：0
> 
> 时间：2013-03-21T00:47:58.940
> 
> 标签：java, android, launcher, homescreen

当用户单击主页时，他可以选择启动器，他还可以选择是否将其设置为默认值。问题是之后很难再改变它。

为了解决这个问题，我添加了一个触发此问题的“重置首选启动器”：

```
getPackageManager().clearPackagePreferredActivities(getPackageName()); 
```

但是，如果他选择了我的启动器，此行只会重置首选启动器。我需要一个片段来清除首选启动器，因此下次用户单击主页时，他会再次获得选项。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T00:58:37.950

这不是直接可能的，Android 开发人员表示他们不希望任何应用程序改变用户的偏好。但是，有一个基于 Android 如何维护这些首选项的解决方法。

让你的清单看起来像这样：

```
 <activity
        android:name="MyLauncherActivity"
        android:exported="true" />

    <activity-alias
        android:name="LauncherAlias1"
        android:targetActivity="MyLauncherActivity" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.HOME" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity-alias>

    <activity-alias
        android:name="LauncherAlias2"
        android:enabled="false"
        android:targetActivity="MyLauncherActivity" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />
            <category android:name="android.intent.category.HOME" />
            <category android:name="android.intent.category.DEFAULT" />
        </intent-filter>
    </activity-alias> 
```

为简单起见，我省略了与手头任务无关的附加属性。

无论如何，一旦您的清单看起来像这样，您就可以使用如下代码清除默认启动器：

```
 PackageManager pm = getPackageManager();
    ComponentName cn1 = new ComponentName("com.mypackage", "com.mypackage.LauncherAlias1");
    ComponentName cn2 = new ComponentName("com.mypackage", "com.mypackage.LauncherAlias2");
    int dis = PackageManager.COMPONENT_ENABLED_STATE_DISABLED;
    if(pm.getComponentEnabledSetting(cn1) == dis) dis = 3 - dis;
    pm.setComponentEnabledSetting(cn1, dis, PackageManager.DONT_KILL_APP);
    pm.setComponentEnabledSetting(cn2, 3 - dis, PackageManager.DONT_KILL_APP); 
```

通过启用一个别名并禁用另一个别名，您会导致 Android 将用户的选项视为已更改，就好像您安装了一个启动器并卸载了另一个启动器一样。因此，用户下次按下主页按钮时将被要求再次选择。无论哪个启动器是当前默认值，这种方法都有效。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-12-10T08:21:24.767

别名活动会导致一些问题，例如您的启动器在选择默认启动器时会提供两个条目。

以下是我的解决方案，它适用于我。 [如何使 Launcher-Pick-Up 弹出窗口显示？](https://stackoverflow.com/questions/20471350/how-to-make-the-launcher-pick-up-popup-window-showing/20489262#20489262)

# gwt - 将图表添加到

> ID：15537527
> 
> 赞同：1
> 
> 时间：2013-03-21T00:48:25.317
> 
> 标签：gwt, extjs

在 RPC 之后，我想通过 DOM 获取特定的非 gwt 生成的 div 以在其中放置图表。

```
 final VerticalPanel contentHome = new VerticalPanel();

  // ...

  public void onSuccess(String result) {

    if(result == null) {
      contentHome.add(new HTML("Could not load content from server."));
      return;
    }

    contentHome.getElement().setId("inner");
    contentHome.add(new HTML(result));

    Element el = DOM.getElementById("whatever");

    LineChart lc = new LineChart();

    el.appendChild(lc.asWidget().getElement());  // <-- this DOESN'T work
    contentHome.add(lc.asWidget());              // <-- this works
  }
}); 
```

不知何故

```
lc.asWidget().getElement() 
```

只返回

```
< div >< /div > 
```

如果我只将小部件添加到 contentHome 它就可以工作。显示图表。

如果有人能帮我解决这个问题，我会很高兴

**编辑：**

也试过这个：

```
 contentHome.getElement().setId("inner");
    contentHome.add(new HTML(result));

    Element el = DOM.getElementById("whatever");
    LineChart lc = new LineChart();

    HTML html = HTML.wrap(lc.asWidget().getElement());

    el.appendChild(html.getElement()); 
```

但它也不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:23:32.140

包裹`div`在一个[`HTLMPanel`](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/ui/HTMLPanel.html)

**更新：**

```
HTMLPanel panel = new HTMLPanel(result);
panel.add(lc, "whatever"); 
```

# html - CSS 过渡制作奇怪的效果？

> ID：15537533
> 
> 赞同：0
> 
> 时间：2013-03-21T00:48:52.770
> 
> 标签：html, css, css-transitions

我正在尝试创建类似于引导输入的东西。当用户点击输入时，它会播放一个漂亮的过渡和发光。我把所有的样式都放下了，但是过渡显得很奇怪，但所有其他网站都正确地对其进行了动画处理。我的盒子阴影显示得非常快，然后变暗，但在[这个链接](http://codepen.io/chriscoyier/pen/glowing_blue_inputs/)上一切正常，但在`http://67.184.73.19/Website/Login/`它的动画与之前的链接不同。我在下面有一些代码。

CSS 输入

```
.Field {
-webkit-transition: all 0.30s ease-in-out;
-moz-transition: all 0.30s ease-in-out;
-ms-transition: all 0.30s ease-in-out;
-o-transition: all 0.30s ease-in-out;
min-height:34px;
padding:7px 8px;
outline:none;
color:#333;
background-color:#fff;
background-repeat:no-repeat;
background-position:right center;
border:1px solid #ccc;
border-radius:3px;
box-shadow:inset 0 1px 2px rgba(0,0,0,0.075);
-moz-box-sizing:border-box;
box-sizing:border-box;
vertical-align:middle;  
}

.Field:focus {
box-shadow:0 0 10px rgba(0,153,255,.75);
border:1px solid #09F;
} 
```

顺便说一句，我使用的是最新版本的 Google Chrome。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T00:58:52.450

这与插入的原始框阴影有关。浏览器似乎在插入和非插入框阴影之间转换时遇到了麻烦，只是没有尝试。不过有一个简单的解决方法 - 为焦点样式添加原始框阴影：

```
.Field:focus {
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.075), 0 0 10px rgba(0,153,255,.75);
    border: 1px solid #09F;
} 
```

这会保留您已经拥有的框阴影（它被您的焦点框阴影覆盖/替换）*并将*新的框阴影添加到焦点上，当您单击框时，它会正确淡入和淡出。

# mutex - PCL中的快速三角剖分

> ID：15537536
> 
> 赞同：0
> 
> 时间：2013-03-21T00:49:28.073
> 
> 标签：mutex, triangulation, point-cloud-library

我想在对它们应用 Passthrough 过滤器后对点云进行三角测量。它可以编译，但查看器什么也没显示。

这是我的源代码：

```
#include <boost/thread/thread.hpp>
#include <boost/date_time/posix_time/posix_time.hpp>
#include <pcl/point_cloud.h>
#include <pcl/point_types.h>
#include <pcl/io/openni_grabber.h>
#include <pcl/io/pcd_io.h>
#include <pcl/io/openni_camera/openni_driver.h>
#include <pcl/surface/organized_fast_mesh.h>
#include <pcl/console/parse.h>
#include <pcl/common/time.h>
#include <pcl/console/time.h>
#include <pcl/visualization/cloud_viewer.h>
#include <pcl/filters/passthrough.h>

using namespace pcl;
using namespace pcl::visualization;
using namespace std;

#define FPS_CALC(_WHAT_) \
do \
{ \
    static unsigned count = 0;\
    static double last = pcl::getTime ();\
    if (++count == 100) \
    { \
      double now = pcl::getTime (); \
      std::cout << "Average framerate("<< _WHAT_ << "): " << double(count)/double(now - last) << " Hz" <<  std::endl; \
      count = 0; \
      last = now; \
    } \
}while(false)

template <typename PointType>
class OpenNIFastMesh
{
  public:
    typedef pcl::PointCloud<PointType> Cloud;
    typedef typename Cloud::Ptr CloudPtr;
    typedef typename Cloud::ConstPtr CloudConstPtr;

    OpenNIFastMesh (const std::string& device_id = "")
      : device_id_(device_id), vertices_ ()
    {
      ofm.setTrianglePixelSize (3);
      ofm.setTriangulationType (pcl::OrganizedFastMesh<PointType>::QUAD_MESH);

      pass_.setFilterFieldName("z");
      pass_.setFilterLimits(0.0, 1.0);
    }

    void 
    cloud_cb (const CloudConstPtr& cloud)
    {

      FPS_CALC ("computation");
      boost::mutex::scoped_lock lock(mtx_);
      cloud_ = cloud;

    }

    void
    run (int argc, char **argv)
    {
      pcl::Grabber* interface = new pcl::OpenNIGrabber (device_id_);

      boost::function<void (const CloudConstPtr&)> f = boost::bind (&OpenNIFastMesh::cloud_cb, this, _1);
      boost::signals2::connection c = interface->registerCallback (f);

      view.reset (new pcl::visualization::PCLVisualizer (argc, argv, "PCL OpenNI Mesh Viewer"));

      interface->start ();

      CloudConstPtr temp_cloud;
      boost::shared_ptr<std::vector<pcl::Vertices> > temp_verts;
      pcl::console::TicToc t1;

      while (!view->wasStopped ())

      {

        if (!cloud_ || !mtx_.try_lock ())
        {
          boost::this_thread::sleep (boost::posix_time::milliseconds (1));
          continue;
        }

        //CloudPtr temp;
        //temp.reset(new Cloud);
        //pass_.setInputCloud(cloud_);
        //pass_.filter(*temp);

        ofm.setInputCloud(cloud_);
        boost::shared_ptr<std::vector<pcl::Vertices> > temp_verts (new std::vector<pcl::Vertices>);
        ofm.reconstruct(*temp_verts);

        //vertices_ = temp_verts;
        mtx_.unlock();

        if (!view->updatePolygonMesh<PointType> (cloud_, *vertices_, "surface"))
        {
          view->addPolygonMesh<PointType> (cloud_, *vertices_, "surface");

        }

        FPS_CALC ("visualization");
        view->spinOnce (1);
      }

      interface->stop ();
    }

    pcl::OrganizedFastMesh<PointType> ofm;
    pcl::PassThrough<PointType> pass_;
    std::string device_id_;

    boost::mutex mtx_;

    CloudConstPtr cloud_;
    boost::shared_ptr<std::vector<pcl::Vertices> > vertices_;
    pcl::PolygonMesh::Ptr mesh_;

    boost::shared_ptr<pcl::visualization::PCLVisualizer> view;
};

int
main (int argc, char ** argv)
{

    OpenNIFastMesh<pcl::PointXYZ> v ("");
    v.run (argc, argv);

  return (0);
} 
```

我认为探针来自互斥锁。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-16T13:32:30.140

查看函数“运行”。你已经把代码

```
 ofm.setInputCloud(cloud_);
    boost::shared_ptr<std::vector<pcl::Vertices> > temp_verts (new  td::vector<pcl::Vertices>);
    ofm.reconstruct(*temp_verts); 
```

在错误的地方。

它们应该在回调函数“cloud_cb_”中，而不是在“run”中。当有新的点云可用时，它应该被执行。

有关更多信息，请查看 pcl 的源文件夹，该文件夹位于 app/src/openni_fast_mash.cpp 中。

# c++ - 读入字符并创建数组c ++

> ID：15537539
> 
> 赞同：0
> 
> 时间：2013-03-21T00:50:07.663
> 
> 标签：c++, arrays, file, input

如何从文件中读取一行字符。首先，程序从文件中读取一个整数。该数字表示下一步要读取多少个字符。下一步读取字符并将它们存储在一个数组中。那么如何创建“char”变量，以便我可以正确读取 Michael 的字符以将它们显示在数组中。

```
file.txt: 
8 
Michael 
```

我使用 inputFile >> integer，从那里我需要使用该整数来制作这个数组 char mike[integer];，然后我可以将字符读入数组

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:54:38.963

要回答您的问题：

```
#include <fstream>
using namespace std;

int main() {
    ifstream f("file.txt");
    int n;
    f >> n;
    char chs = new char[n];
    for (int i = 0; i < n; ++i) f >> chs[i];

    // do something about chs

    delete [] chs;
} 
```

但是，我会选择（如果您`Michael`出现在自己的行中）：

```
#include <fstream>
#include <string>
using namespace std;

int main() {
    ifstream f("file.txt");
    int n;
    f >> n;
    string str;
    getline(f, str);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T15:13:56.387

```
#include <fstream.h>
#include <string.h>

int main() 

    {
        ifstream f("file.txt",ios::in);
        int n;
        f >> n;
        char string[n];
        f.getline(string,n);
       cout<<string;

    } 
```

这给出了以下字符串的输出`file.txt`。

# knockout.js - KnockoutJS - 可观察对象未定义？

> ID：15537543
> 
> 赞同：2
> 
> 时间：2013-03-21T00:50:24.683
> 
> 标签：knockout.js, knockout-mapping-plugin

我还是 Knockout 的新手，所以我希望有人能够帮助我解决这个问题。

这是我的视图模型：

```
baseModel = {
    logged_in : ko.observable(),
    alerts : ko.observableArray(),
    errors: ko.observable()
}; 
```

在我的 HTML 中，我有：

`<span data-bind="text: ($root.errors['myerror1'] === undefined)? 'undefined':$root.errors['myerror1']"></span>`

我希望通过 AJAX 拉入任意对象并将其分配给我的 .errors 属性。例如，当我的回应是这样的：

`Object {myerror1: "password is wrong", error2: "something else is wrong"}`

我希望它`span`在我的 AJAX 成功回调中执行以下操作时显示错误：

```
if( response.errors !== undefined )
     baseModel.errors = ko.mapping.fromJS(response.errors, {}, baseModel.errors); 
```

或者，

```
if( response.errors !== undefined )
     baseModel.errors = response.errors; 
```

两者都没有显示`myerror1`我在 HTML 中绑定的内容。我可能在这里做错了很多事情。我不确定出了什么问题。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T00:56:05.363

如果您尝试`errors`使用新值更新 observable，则不应使用 设置它`=`，而是将新值作为参数传递给它：

```
baseModel.errors({myerror1: "password is wrong", error2: "something else is wrong"}); 
```

**更新：**我发现您的代码有两个额外的问题：

1.  `errors`开始为`undefined`; 最好将其设置为空对象，这样在首次评估绑定时不会出现错误：

    ```
    errors: ko.observable({}) 
    ```

2.  如果您想要`errors`in 表达式中的值`data-bind`，您应该“调用”它以获取它的值 - 而不是直接使用它：

    ```
    <span data-bind="text: ($root.errors()['myerror1'] === undefined)?
    'undefined':$root.errors()['myerror1']"></span> 
    ```

[例子](http://jsfiddle.net/mgibsonbr/AETWV/)。

# python - 有很多选择的 Django 选择字段 - 是否有一个简单有效的解决方案？

> ID：15537545
> 
> 赞同：2
> 
> 时间：2013-03-21T00:50:32.100
> 
> 标签：python, django, forms, django-forms

Django 的选择字段，使用一个选择小部件，将渲染出无限数量的`<option>`元素。当然，当有数百个选择时，这会花费很长时间并浪费大量内存。当涉及到外键时，可以使用类似于`contrib.admin`'s 的东西`raw_id_fields`，但是对于硬编码值（例如，世界上所有可供选择的[细分](http://en.wikipedia.org/wiki/Administrative_subdivision)，来自`pycountry`），我不确定该怎么做，除了**A)**使用 AJAX 提供列表（仍然有很多值要输出）或**B)**为小部件使用 char 字段，允许表单验证错误的输入。

是否有任何不涉及上述**A**或**B**选项的最佳实践，或者甚至是涉及选项**A**的 easy|clean|pluggable 的最佳实践？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T04:59:38.853

我曾经遇到过同样的问题，在我看来，解决这个问题的最好方法是使用自动完成字段。这就像一个文本字段，但用户在该文本输入中写入时会获得选项。

这比简单的文本字段要好得多，因为您不必验证值是否正确：您只能选择一个有效值。

我尝试了一些应用程序以实现自动完成功能，最适合我需要的是：

[https://github.com/yourlabs/django-autocomplete-light](https://github.com/yourlabs/django-autocomplete-light)

希望能帮助到你！

# r - 使用 gWidgetstcltk 绘图

> ID：15537549
> 
> 赞同：0
> 
> 时间：2013-03-21T00:50:58.107
> 
> 标签：r, graphics, plot, gwidgets

我用一个按钮制作了一个 gui，它的处理程序执行我制作的一个类的绘图方法，它在正常的 R 会话中使用 ggplot2 和 grid/gridExtra 来组合绘图。使用控制台中的 plot() 函数可以正常工作。我的按钮/处理程序如下：

```
Plotbutton <- gbutton("Plot!", container=MainWindow,
                  handler=function(h,...){
                    plot(analysis, linesplot=svalue(linecheck), lineplot.legend=svalue(linelegcheck), baseannotate=svalue(bpcheck), bpfreq=as.numeric(svalue(bpspin)), mosaic.bars=svalue(mosaiccheck), mosaic.scale=as.numeric(svalue(mosaicspin)), combine.plots=svalue(combinecheck), condense.mosaics=svalue(condensecheck), labfontsize=as.numeric(svalue(fontspin1)), legfontsize=as.numeric(svalue(fontspin2)))
                  }) 
```

我不确定原因，但是加载 gWidgets、gWidgetstcltk 和我的绘图方法所需的包，然后单击按钮，没有任何内容被绘制到 R 图形环境中，但是在 RStudio 中，绘图面板直到GUI 已退出。该图形确实出现在普通 Windows RGui 的窗口中。

谁能建议为什么会这样？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T17:29:00.317

它从 R 控制台而不是函数工作的原因是，`print()`如果没有其他说明，R 控制台将自动调用。在函数内 R 不这样做，所以如果你想打印一个图形，你必须明确声明`print(graph)`. 尝试

```
print(plot(analysis, linesplot=svalue(linecheck), lineplot.legend=svalue(linelegcheck), baseannotate=svalue(bpcheck), bpfreq=as.numeric(svalue(bpspin)), mosaic.bars=svalue(mosaiccheck), mosaic.scale=as.numeric(svalue(mosaicspin)), combine.plots=svalue(combinecheck), condense.mosaics=svalue(condensecheck), labfontsize=as.numeric(svalue(fontspin1)), legfontsize=as.numeric(svalue(fontspin2))) 
```

# php - 将内联图像添加到使用 swiftmailer 发送的消息中

> ID：15537551
> 
> 赞同：13
> 
> 时间：2013-03-21T00:51:09.223
> 
> 标签：php, swiftmailer

请原谅我的 php，但我使用 Swiftmailer 从客户网站发送电子邮件。他们要求添加一两个图像作为签名等，因此请查看此处的 swiftmailer 规范

[http://swiftmailer.org/docs/messages.html](http://swiftmailer.org/docs/messages.html)

他们建议添加这样的内联图像

```
$message->embed(Swift_Image::fromPath('http://site.tld/image here')) 
```

或像这样（分两步）

```
$cid = $message->embed(Swift_Image::fromPath('image here')); 
```

然后在电子邮件正文部分添加

```
<img src="' . $cid . '" alt="Image" />' 
```

这两个步骤我都试过了，但都无济于事。当我点击发送电子邮件按钮时，我收到了这个错误，我不知道该怎么做。

```
Call to a member function embed() on a non-object in /home/content/78/5152878/html/4testing/erase/ask-doc-proc2.php on line 89 
```

我添加到我已经工作的代码和电子邮件中的唯一内容是直接来自文档页面中示例的图像代码。此错误显然会阻止发送电子邮件。如果我删除它然后它发送电子邮件罚款。由于我需要为此添加图像，

任何帮助是极大的赞赏。谢谢

***编辑：这是构建和发送电子邮件的部分*** $cid= $message->embed(Swift_EmbeddedFile::fromPath(' [http://myforecyte.com/dev/pic.jpg](http://myforecyte.com/dev/pic.jpg) '));

```
->setTo( $docEmail)

->setBody("Hello" . "\r\n\r\n" .  
$fullName . " has visited MyForeCYTE.com. Upon their visit they have requested to learn more about the test. \r\n\r\n" . 
"Please visit www.ClarityWomensHealth.com to find out more about The ForeCYTE Breast Health Test, or call our customer support line at 1 (877) 722-6339\.  \r\n\r\n" .
"We look forward to hearing from you. \r\n\r\n" .
"Thank You," , 'text/plain')

->addPart("Hello" . ",</b><br/><br/>" . 
"<b>" . $fullName . "</b> has visited www.MyForeCYTE.com. Upon their visit they have requested to learn more about the test. <br/>" . 
"Please visit www.ClarityWomensHealth.com to find out more about The ForeCYTE Breast Health Test, or call our customer support line at 1 (877) 722-6339.<br/> " . 
"We look forward to hearing from you. <br/><br/><br/>" . "<img src='" . $cid. "' alt='pic'/>" .

"Thank you " , 'text/html')
; 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T03:34:32.720

经过所有的奔跑，我找到了一个替代解决方案。Swiftmailer 允许使用 2 种方法来执行相同的操作。

一个是 embed() 函数

另一个是 attach() 函数

所以对于上面的代码，我删除了“embed()”，因为它对我不起作用，并在下面添加了这两行并且它可以工作

```
 ->attach(Swift_Attachment::fromPath('path to image here.jpg')  
->setDisposition('inline')); 
```

它工作100％

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-06-09T08:31:48.987

没有一个答案真的对我有用。我必须使用 CID 包含内联图像。我必须做的是让它发挥作用：

```
$attachment = Swift_Image::newInstance($data, $filename, $mimeType)
    ->setDisposition('inline');

$cid = $message->embed($attachment); // Generates "cid:something" 
```

重要的部分是使用 Swift_Image 类。那么html中的图片应该是：

```
<img src="cid:something" ... /> 
```

我认为这个解决方案无需使用 swiftmailer（版本 5.4.2）做一些骇人听闻的事情就可以工作。这正是文档所说的。

如果内联图像有效，请记住测试多个电子邮件客户端（gmail、thunderbird、apple mail、web 客户端......）。例如，使用 Swift_Attachment，内联图像显示在 gmail 中，但在某些 Web 客户端中不显示。使用 Swift_Image，它无处不在。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-05-19T23:54:17.543

接受的答案不起作用（测试版本：5.4.2）。（我的作品，但可以完善）

相反，查看“原始”（Gmail：显示原始）我发现 swiftmailer 省略了在附件中添加 2 个标题，即：

```
Content-ID: <ABC123>
X-Attachment-Id: ABC123 
```

ABC123 是我们必须放入要显示内联的正文中的 cid：

所以多亏了[这个问题](http://forum.kohanaframework.org/discussion/9236/solved-kohana-mail-adding-a-custom-header-to-an-attachment/p1)：我找到了为 swiftmailer 修复它的方法（这甚至违反了 swiftmailer 文档，但它可以工作，而他们的没有）

这是最终的（丑陋的）代码：

```
$attachment = Swift_Attachment::fromPath('image.jpg')->setDisposition('inline');
$attachment->getHeaders()->addTextHeader('Content-ID', '<ABC123>');
$attachment->getHeaders()->addTextHeader('X-Attachment-Id', 'ABC123');
$cid = $message->embed($attachment);
$img = '<img src="cid:ABC123"/>';
$html = "
<html>
<head>
</head>
<body>
$img
</body>
</html>
";
$message->setBody($html, 'text/html'); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-07-20T15:25:30.753

我知道这是一个老问题（有一个公认的答案），但对于任何有同样问题的人，该[`Swift_Image::fromPath($image_path)`](http://apigen.juzna.cz/doc/swiftmailer/swiftmailer/class-Swift_Image.html)方法期望图像路径是本地的（文件系统路径）：

```
Swift_Image::fromPath("/local/path/to/image.jpg");
// Local path = great success 
```

`https://`因此，如果您的图像路径是外部的（以等开头），则以下内容将失败：

```
Swift_Image::fromPath("https://external.path/to/image.jpg");
// External path = epic fail 
```

对于外部图像，您应该使用：

```
# Load the image file
$data = file_get_contents($image_path);
# Get the filename
$filename = explode("?",basename($image_path))[0];
# Get the mime type
$finfo = new \finfo(FILEINFO_MIME_TYPE);
$mime_type = $finfo->buffer($buffer);
# Load the image file
$image_file = new \Swift_Image($data, $filename, $mime_type);
# Set the disposition to inline
$image_file->setDisposition('inline'); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-01-16T06:54:02.457

如果您使用 laravel，请尝试`public_path()`在路径的开头添加，例如：

```
<img src="<?php echo $message->embed(public_path().'/img/backend/name.jpg); ?>"> 
```

# ruby - 从 ruby gems "gem update" 命令中排除某些宝石

> ID：15537552
> 
> 赞同：0
> 
> 时间：2013-03-21T00:51:15.813
> 
> 标签：ruby, rubygems

我有一个纯粹为个人使用而维护的 gem，它恰好与 ruby​​gems.org 上托管的旧 gem 发生名称冲突。当我运行时`gem update`，会下载 ruby​​gems.org 版本。我想防止这种情况发生。我知道我可以明确指定要包含哪些 gem `gem update`，但是我可以指定要排除的内容吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T01:09:07.467

很确定你不能，但你可以很容易地编写一个解决方案（在 unix 上）

```
gem list --local | awk '{print $1}' | grep -v YOUR_GEMNAME | xargs gem update 
```

此外，最近几次查看 Rubygems 源代码给我留下了深刻的印象，添加此功能可能不会很困难。他们可能会接受它的拉取请求。

# screen-resolution - 在高分辨率显示器上测试低分辨率

> ID：15537554
> 
> 赞同：2
> 
> 时间：2013-03-21T00:51:32.593
> 
> 标签：screen-resolution, dpi

我在高分辨率设备上进行所有应用程序开发（即本例中的 HTML/CSS）——Macbook Retina 显示器和/或 Retina-ready 21" mac 显示器。然而，我们的两个产品之一实际上已安装在质量极低的 640x480 显示器上。

问题在于字体、渐变、阴影等，在 2001 年之后制造的显示器上看起来很棒，但在我们可爱的二战前设备显示器上看起来像垃圾（太像素化）。

（好吧，也许不是二战前，但是伙计，他们真的很烂）。

我已经有了一个分辨率切换器，可以很容易地将我巨大的浏览器缩小到 640x480 像素，但它仍然是漂亮的高分辨率形式。

（编辑）：我意识到我要问的不是分辨率，而是 DPI。

有谁知道我可以运行一个方法/插件/应用程序来模拟我们设备的可怕、蹩脚、不太好的分辨率/dpi？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T00:56:48.743

这似乎是一个不错的选择：

[http://www.browserstack.com/](http://www.browserstack.com/)

或者这可能是你需要的：

[http://www.themobilewebdesignblog.com/2012/05/19/online-tools-emulators-for-responsive-design-testing/](http://www.themobilewebdesignblog.com/2012/05/19/online-tools-emulators-for-responsive-design-testing/)

# jquery - 在 Colorbox 中显示 Postback 上的数据

> ID：15537555
> 
> 赞同：0
> 
> 时间：2013-03-21T00:51:43.453
> 
> 标签：jquery, ajax, postback, colorbox

首先感谢观看。首先让我声明我真的不擅长 Javascript。我会尽力提供帮助。我有 2 个 ASP.NET 表单。1 上面有一个按钮。第二个是带有提交按钮的表单。我没有使用内联隐藏的 div。我正在使用 Colorbox，这是截至 2013 年 3 月 20 日的最新版本。我正在使用 VS 2012 4.5。jQuery 1.9。我想从表单 1 启动表单 2... 让用户填写信息，单击其上的提交按钮并显示在提交的相同颜色框中，并允许他们使用 X 关闭颜色框。到目前为止这里是我在哪里。我已经改变了很多次，我有点迷路了。这个 ick 大部分来自我找到的代码。

Form 1 启动 Form 2（按预期工作）

```
$(".nameofbuttonclassform1").colorbox({ transition: "fade", width: "800", height: "680", overlayClose: false, href: "Form2.aspx" }); 
```

表单 2 按钮单击在颜色框中显示表单 1 并终止回发以执行服务器端工作 不能按需要工作。我已经尝试了很多变体，所以我将其插入，因为它比其他任何东西都更接近。

```
 $('#Form2Submitbutton').click(function(e){

            e.preventDefault();

            var url = $(this).attr('href');

            $.ajax({
                type: 'GET',
                url: url,
                dataType: 'html',
                cache: true,
                beforeSend: function () {
                    $('#cboxLoadedContent').empty();
                    $('#cboxLoadingGraphic').show();
                },
                complete: function () {
                    $('#cboxLoadingGraphic').hide();
                },
                success: function (data) {
                    $('#cboxLoadedContent').append(data);
                }
            });

        }); 
```

所以我完全被卡住了。如果你有任何想法，他们必须比我的更好。

# sql-server - 在存储过程中执行 SQL 语句，如何将该 SQL 语句的结果存储到变量中以备后用？

> ID：15537560
> 
> 赞同：0
> 
> 时间：2013-03-21T00:52:17.943
> 
> 标签：sql-server, sql-server-2008, tsql, stored-procedures

我需要在存储过程中执行几个 SQL 语句，将结果保存到变量中以备后用。

```
 SET NOCOUNT OFF
  DECLARE @P TABLE
  @P  = SELECT d.Periodo 
  from [SISACT].DEPRECIACIONES d, [SISACT].CONTROL_PERIODO c 
  where c.vigente = 1 AND d.Periodo = c.periodo

  IF @@ROWCOUNT > 0
     PRINT 'Periodo ya depreciado' 
```

所以以后我可以做这样的事情

```
UPDATE [SISACT].ACTIVOS_FIJOS set ultimo_periodo = @p.periodo ... 
```

我知道`@P = SELECT is wrong`，我看到一个[例子](https://stackoverflow.com/questions/9377775/store-the-result-of-a-stored-procedure-without-using-an-output-parameter)，他们使用另一个存储过程而不是 SELECT 语句，我想知道这是否可能不使用存储过程。如果是这样，怎么做？我将只在一个存储过程中使用一次查询，所以我认为将它放在另一个存储过程中没有意义。我是 T-SQL 和 SQL server 的新手，我也在自学，如果这是一个愚蠢的问题，我很抱歉。

PS：这种情况下的查询应该只返回一条记录。我正在使用 SQL SERVER 2008 Express。

感谢您提前提供任何帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:14:56.550

我认为那是你想要的。

```
 SET NOCOUNT OFF
  DECLARE @P as CHAR(6)
  SELECT p@ = d.Periodo from [SISACT].DEPRECIACIONES d, [SISACT].CONTROL_PERIODO c where c.vigente = 1 AND d.Periodo = c.periodo
  IF @@ROWCOUNT > 0
     PRINT 'Periodo ya depreciado' 
```

稍后您可以使用

```
UPDATE [SISACT].ACTIVOS_FIJOS set ultimo_periodo = @p 
```

# ios - iOS 触摸事件通知（私有 API）

> ID：15537564
> 
> 赞同：8
> 
> 时间：2013-03-21T00:52:36.600
> 
> 标签：ios, jailbreak, iphone-privateapi

可以[在 iOS 上模拟触摸事件](http://www.cocoawithlove.com/2008/10/synthesizing-touch-event-on-iphone.html)，并且您可以在后台使用 CTTelephonyCenterAddObserver 和 CFNotificationCenterAddObserver 接收各种系统范围的通知，例如：

*   [IOS越狱如何拦截短信/短信](https://stackoverflow.com/questions/8680764/ios-jailbreak-how-do-intercept-sms-text-messages)
*   [如何检测 iPhone 上的屏幕锁定/解锁事件？](https://stackoverflow.com/questions/7888490/how-can-i-detect-screen-lock-unlock-events-on-the-iphone)

不过，我还没有找到一种在后台获取触摸通知的方法。是否有可以与 CFNotificationCenterAddObserver 一起使用的“触摸事件”，可以使用不同的通知中心，或者完全不同的方法？

我会对低级触摸信息（例如 x、y 坐标和触摸类型）感到满意，但更高级别的信息（例如按下键、按下后退按钮等）会更好！

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-21T14:54:59.883

您可以使用 IOKit 中的**IOHID**来获取 x、y 坐标。

```
#include <IOHIDEventSystem.h> 
```

创建 IOHIDEventSystemClient：

```
void *ioHIDEventSystem = IOHIDEventSystemClientCreate(kCFAllocatorDefault); 
```

注册回调：

```
IOHIDEventSystemClientScheduleWithRunLoop(ioHIDEventSystem, CFRunLoopGetCurrent(), kCFRunLoopDefaultMode);
IOHIDEventSystemClientRegisterEventCallback(ioHIDEventSystem, handle_event, NULL, NULL); 
```

注销回调：

```
IOHIDEventSystemClientUnregisterEventCallback(ioHIDEventSystem, handle_event, NULL, NULL);
IOHIDEventSystemClientUnscheduleWithRunLoop(ioHIDEventSystem, CFRunLoopGetCurrent(), kCFRunLoopDefaultMode); 
```

打回来：

```
void handle_event (void* target, void* refcon, IOHIDServiceRef service, IOHIDEventRef event) {
   if (IOHIDEventGetType(event)==kIOHIDEventTypeDigitizer){
       IOHIDFloat x=IOHIDEventGetFloatValue(event, (IOHIDEventField)kIOHIDEventFieldDigitizerX);
       IOHIDFloat y=IOHIDEventGetFloatValue(event, (IOHIDEventField)kIOHIDEventFieldDigitizerY);
       int width = [[UIScreen mainScreen] bounds].size.width;
       int height = [[UIScreen mainScreen] bounds].size.height;
       NSLog(@"click : %f, %f", x*width, y*height) ;
   }
} 
```

此外，您可以查看： [IOHIDEventSystemCreate on iOS6 failed](https://stackoverflow.com/questions/14354240/iohideventsystemcreate-on-ios6-failed)。希望这可以帮助。

编辑：请查看日志中的结果。在 iPhone 4 和 5 上测试。

```
void handle_event (void* target, void* refcon, IOHIDServiceRef service, IOHIDEventRef event) {
    NSLog(@"handle_event : %d", IOHIDEventGetType(event));
if (IOHIDEventGetType(event)==kIOHIDEventTypeDigitizer){
    IOHIDFloat x=IOHIDEventGetFloatValue(event, (IOHIDEventField)kIOHIDEventFieldDigitizerX);
    IOHIDFloat y=IOHIDEventGetFloatValue(event, (IOHIDEventField)kIOHIDEventFieldDigitizerY);
    NSLog(@" x %f : y %f", x, y);
//2013-03-28 10:02:52.169 MyIOKit[143:907] handle_event : 11
//2013-03-28 10:02:52.182 MyIOKit[143:907]  x 0.766754 : y 0.555023
}
} 
```

# html - Cordova - Windows Phone 8，camera.getPicture + 在标签中查看图像？

> ID：15537566
> 
> 赞同：0
> 
> 时间：2013-03-21T00:52:47.960
> 
> 标签：html, image, cordova, windows-phone-8

我不知道如何解析外部获取的图像（也就是通过相机/照片库）

```
<img src="///myAppFolder/photoTaken.jpg" /> 
```

我通过 window.requestFileSystem(); 解析本地存储，在其他平台（Android + iPhone）上做到了这一点；并附加正确的文件夹路径（它看起来比 windows phone 提供的绝对路径 - 它只返回一个相对路径）并且它可以工作，但是我不确定在这种情况下在 windows phone 解决方案上该怎么做。

使用科尔多瓦 2.5.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:01:07.273

啊! 我多么愚蠢，在闲逛了几个小时然后最终发布后，我找到了解决问题的方法:)当我应该在解决后使用**toURL(** **)**时，我使用了 toURI() 。结果一切都很好！

# c# - 2 个不同长度的列表用于创建第三个列表

> ID：15537568
> 
> 赞同：1
> 
> 时间：2013-03-21T00:53:12.380
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-4

我有一个类似于结构的列表（字母是数据）：

```
|A|B|C|D|E|F|G| 
```

我还有另一个类似的列表：

```
|A|B|E|G| 
```

我想创建一个与第一个列表长度相同但在第二个列表中不存在的列中放置“NULL”的第三个列表，例如：

```
|A|B|NULL|NULL|E|NULL|G| 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:01:39.603

你可以使用 Linq：

```
var result = 
    firstList.Select(p => secondList.Contains(p) ? p : null).ToList(); 
```

如果列表很大，那么 O(N^2) 的事实可能很重要。如果您可以将 secondList 表示为 HashSet，则可以提高性能，因为 HashSet 的集合成员资格查找是 O(1)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:19:14.813

您可以按照以下方式做一些事情：

```
var list1 = new List<string>() {"A", "B", "C", "D", "E", "F", "G"};
var list2 = new List<string>() { "A", "B", "E","G" };
var list3 = new List<string>();
int j = 0;
for(int i=0; i < list1.Count; i++)
{
    var item = list1[i];
    if (item == list2[j])
    {
     list3.Add(item);
     j++;
    }
    else
    {
      list3.Add(null);
    }
 } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:59:03.480

迭代您的第一个列表，对于每个元素，将其与第二个列表中的相应元素进行比较，如果有匹配输出，否则输出空值，继续直到到达第一个列表的末尾。

# mysql - Mysql跨数据库外键

> ID：15537582
> 
> 赞同：8
> 
> 时间：2013-03-21T00:54:20.613
> 
> 标签：mysql, foreign-keys, cross-database

我正在尝试创建一个跨数据库外键。当我在同一个数据库上运行以下代码时

```
CREATE TABLE `t1` (
  `id` int(11) NOT NULL AUTO_INCREMENT,  
  `int_id` varchar(128) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `int_id` (`int_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci;

CREATE TABLE `t2` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `ext_id` varchar(128) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `ext_id` (`ext_id`),
  CONSTRAINT `t2_ibfk_1` FOREIGN KEY (`ext_id`) REFERENCES `t1` (`int_id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

但是，当在一个数据库 (d1) 上创建 t1 然后在第二个数据库 (d2) 上运行以下代码时，我收到一般错误：**#1005 - Can't create table 'userdata.t2' (errno: 150)**

```
CREATE TABLE `t2` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `ext_id` varchar(128) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `ext_id` (`ext_id`),
  CONSTRAINT `t2_ibfk_1` FOREIGN KEY (`ext_id`) REFERENCES `d1.t1` (`int_id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

任何帮助将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-21T02:31:11.617

你的语法不正确，试试这个

```
CREATE TABLE `t2` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `ext_id` varchar(128) COLLATE utf8_unicode_ci NOT NULL,
  PRIMARY KEY (`id`),
  KEY `ext_id` (`ext_id`),
  CONSTRAINT `t2_ibfk_1` FOREIGN KEY (`ext_id`) REFERENCES `d1`.`t1` (`int_id`) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

# mysql - 需要 Sql 选择查询帮助

> ID：15537583
> 
> 赞同：0
> 
> 时间：2013-03-21T00:54:21.897
> 
> 标签：mysql, sql, select

我的 aanmeldingen 表中有以下表结构：

```
username      varchar(16) NOT NULL
introduce_van varchar(16) NULL 
```

我有以下 3 行数据：

```
Username Introduce_van   
Test1    NULL
Test2    Test1
Test3    NULL 
```

现在我想选择所有不在 Introduce_van 中的用户名，并且 Introduce_van 的值为 NULL。

我用这个 sql 试了一下：

```
SELECT username 
FROM aanmeldingen 
WHERE username NOT IN
      (SELECT introduce_van  
       FROM aanmeldingen 
       WHERE introduce_van != 'NULL') 
```

此查询返回：

```
Test2, Test3 
```

所以我想如果我要添加：

```
AND introduce_van = 'NULL' 
```

它只会返回 Test3。

但它返回 0 行。

我只是不知道如何修复我的选择查询以确保它只返回 Test3（不在 Introduce_van 中并且 Introduce_van 为 NULL。

有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:01:00.507

您的意思是“现在我要选择所有用户名不在 Introduce_van 中***或***Introduce_van 的值为 NULL”。？？？

如果是这样，请使用：

```
 SELECT Distinct username 
 FROM aanmeldingen a 
 WHERE introduce_van Is Null  
     Or Not exists 
      (SELECT * FROM aanmeldingen 
       WHERE introduce_van = a.userName) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T00:56:22.530

检查空值时，它要么是

```
is null 
```

或者

```
is not null 
```

你的其余逻辑几乎没问题。您必须将空值检查移到子查询之外，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T00:57:27.517

另一种方法是使用and not使用`LEFT JOIN`和过滤*NULL*值。`IS NULL``=! NULL`

```
SELECT  a.UserName
FROM   tableName a
        LEFT JOIN tableName b
            ON a.username = b.Introduce_van
WHERE   b.Introduce_van IS NULL AND   
        a.Introduce_van IS NULL 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/8e6a3/2)

输出

```
╔══════════╗
║ USERNAME ║
╠══════════╣
║ Test3    ║
╚══════════╝ 
```

# mysql - 使用 BIT 作为 INT 以提高存储卷效率

> ID：15537586
> 
> 赞同：1
> 
> 时间：2013-03-21T00:54:40.663
> 
> 标签：mysql, casting, int, bit, space-efficiency

如果我理解正确，那么`BIT`磁盘效率非常高。就我而言，我知道我将始终只有三个我想处理的值，例如`INT`s: `1`, `2`, & `3`。

我是`b'00'`正确`3`的`b'0'`吗`1`？

如果我尝试使用s 和s 的`INT`值，mysql 会在这些查询中自动转换为 s 吗？`INSERT` `VALUE``SELECT` `WHERE``BIT`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:40:06.977

```
insert into t (bits) values (b'11'); /* 3 = 2^1+2^0 */
insert into t (bits) values (b'10'); /* 2 = 2^1 */
insert into t (bits) values (b'1'); /*  1 = 2^0 */ 
```

是的可以插入`INT`；

# c# - 二维球之间的吸引力

> ID：15537593
> 
> 赞同：1
> 
> 时间：2013-03-21T00:55:16.360
> 
> 标签：c#, gravity

我有一个模拟，多个圆圈在 2D 空间中移动，它们之间有弹性碰撞。

我想在粒子之间添加吸引力，以便粒子根据质量等向其他粒子移动。我该怎么做？

我的碰撞管理功能如下所示：

```
void manageCollision(Particle particleA, Particle particleB)
{
    float distanceX = particleA.Position.X - particleB.Position.X;
    float distanceY = particleA.Position.Y - particleB.Position.Y;
    double collisionAngle = Math.Atan2(distanceY, distanceX);
    double pA_magnitude = Math.Sqrt(particleA.Velocity.X * particleA.Velocity.X + particleA.Velocity.Y * particleA.Velocity.Y);
    double pB_magnitude = Math.Sqrt(particleB.Velocity.X * particleB.Velocity.X + particleB.Velocity.Y * particleB.Velocity.Y);
    double pA_direction = Math.Atan2(particleA.Velocity.Y, particleA.Velocity.X);
    double pB_direction = Math.Atan2(particleB.Velocity.Y, particleB.Velocity.X);
    double pA_newVelocityX = pA_magnitude * Math.Cos(pA_direction - collisionAngle);
    double pA_newVelocityY = pA_magnitude * Math.Sin(pA_direction - collisionAngle);
    double pB_newVelocityX = pB_magnitude * Math.Cos(pB_direction - collisionAngle);
    double pB_newVelocityY = pB_magnitude * Math.Sin(pB_direction - collisionAngle);
    double pA_finalVelocityX = ((particleA.Mass - particleB.Mass) * pA_newVelocityX + (particleB.Mass + particleB.Mass) * pB_newVelocityX) / (particleA.Mass + particleB.Mass);
    double pB_finalVelocityX = ((particleA.Mass + particleA.Mass) * pA_newVelocityX + (particleB.Mass - particleA.Mass) * pB_newVelocityX) / (particleA.Mass + particleB.Mass);
    double pA_finalVelocityY = pA_newVelocityY;
    double pB_finalVelocityY = pB_newVelocityY;
    particleA.Velocity = new Vector2((float)(Math.Cos(collisionAngle) * pA_finalVelocityX + Math.Cos(collisionAngle + Math.PI / 2) * pA_finalVelocityY), (float)(Math.Sin(collisionAngle) * pA_finalVelocityX + Math.Sin(collisionAngle + Math.PI / 2) * pA_finalVelocityY));
    particleB.Velocity = new Vector2((float)(Math.Cos(collisionAngle) * pB_finalVelocityX + Math.Cos(collisionAngle + Math.PI / 2) * pB_finalVelocityY), (float)(Math.Sin(collisionAngle) * pB_finalVelocityX + Math.Sin(collisionAngle + Math.PI / 2) * pB_finalVelocityY));
} 
```

每个球或粒子以随机的质量和半径生成。

该函数在更新类型的方法中调用，如下所示：

```
Vector2 globalGravity = new Vector2(0f, gravityScale / 6000);

    for (int i = 0; i < particles.Count(); i++)
{
    particles[i].Update((float)updateTimer.Interval, globalGravity);
    Vector2 position = particles[i].Position;
    Vector2 velocity = particles[i].Velocity;
    collisionWallCheck(ref position, ref velocity, particles[i].Radius);
    particles[i].Position = position;
    particles[i].Velocity = velocity;

    Particle pA = particles[i];
    for (int k = i + 1; k < particles.Count(); k++)
    {
        Particle pB = particles[k];
        Vector2 delta = pA.Position - pB.Position;
        float dist = delta.Length();

        if (dist < particles[i].Radius + particles[k].Radius && !particles[i].Colliding && !particles[k].Colliding)
        {
            particles[i].Colliding = true;
            particles[k].Colliding = true;
            manageCollision(particles[i], particles[k]);
            particles[i].initColorTable(); // Upon collision, change the color
            particles[k].initColorTable();
            totalCollisions++;
        }
        else
        {
            particles[i].Colliding = false;
            particles[k].Colliding = false;
        }
    }
} 
```

我正在存储每个球的初始位置、速度和质量。

我显然需要做但不知道如何实施的是：

*   计算重力的大小和方向。
*   知道了力，就可以计算出每个物体的加速度。
*   知道加速度，您可以计算出新的速度。
*   知道速度，您可以计算新位置。

我基本上对它的方程式感到不安，我想从只在两个球之间产生吸引力开始。

使用 Steven 的建议，这是新的集成代码。

```
void updateTimer_Tick(object sender, EventArgs e)
{
    const double G = 6.67398 * 0.00000000001;

    for (int i = 0; i < particles.Count(); i++)
    {
        double sumX = 0;
        double sumY = 0;

        Particle pA = particles[i];
        for (int k = i + 1; k < particles.Count(); k++)
        {
            Particle pB = particles[k];
            Vector2 delta = pA.Position - pB.Position;
            float dist = delta.Length();

            if (dist < particles[i].Radius + particles[k].Radius && !particles[i].Colliding && !particles[k].Colliding)
            {
                particles[i].Colliding = true;
                particles[k].Colliding = true;
                manageCollision(particles[i], particles[k]);
                particles[i].initColorTable();
                particles[k].initColorTable();
                totalCollisions++;
                particles[i].Colliding = false;
                particles[k].Colliding = false;
            }
            else
            {
                double distanceX = particles[i].Position.X - particles[k].Position.X;
                double distanceY = particles[i].Position.Y - particles[k].Position.Y;
                double r = Math.Sqrt(Math.Pow(distanceX, 2) + Math.Pow(distanceY, 2));
                double force = G * particles[i].Mass * particles[k].Mass / (r * r);
                double theta = Math.Tan(distanceY / distanceX);
                sumX += force * Math.Cos(theta);
                sumY += force * Math.Sin(theta);
                particles[i].Colliding = false;
                particles[k].Colliding = false;
            }
        }
        double netForce = Math.Sqrt(Math.Pow(sumX, 2) + Math.Pow(sumY, 2));
        double a = netForce / particles[i].Mass;
        double aTheta = Math.Tan(sumY / sumX);

        // Here we get accelerations for X and Y.  You can probably figure out velocities from here.
        double aX = a * Math.Cos(aTheta);
        double aY = a * Math.Sin(aTheta);
        Vector2 accel = new Vector2((float)aX, (float)aY);

        particles[i].Update((float)updateTimer.Interval, accel);
        //particles[i].Update((float)updateTimer.Interval, globalGravity);
        Vector2 position = particles[i].Position;
        Vector2 velocity = particles[i].Velocity;
        collisionWallCheck(ref position, ref velocity, particles[i].Radius);
        particles[i].Position = position;
        particles[i].Velocity = velocity + accel;
    }
    Draw();
} 
```

粒子的更新函数很简单，之前它使用的是 0,0 的全局重力向量。

```
 public void Update(float timeStep, Vector2 gravity)
        {
            velocity = velocity + timeStep * gravity;
            position = position + timeStep * velocity;
        } 
```

我现在不确定如何处理 0 的情况。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T01:59:35.143

首先计算作用在每个物体上的重力。这是由

```
F = Gm1m2/r*r 
```

其中 m1 和 m2 是两个物体的质量，G 是[引力常数](http://en.wikipedia.org/wiki/Gravitational_constant)，r 是两个物体之间的距离。

现在，r 是一个向量，因此您可能希望将其拆分为单独的组件 - Fx 和 Fy。您可以按如下方式执行此操作：

```
Fx = F * cos(theta)
Fy = F * sin(theta) 
```

对于每个质量，计算作用在它和所有其他物体上的重力。 [对向量求和](http://www.physicsclassroom.com/class/vectors/u3l1b.cfm)以获得净重力。（注意 - 该链接可供您感兴趣，但需要很长时间才能达到目的）。此时，您将对每个对象产生一个净力，您可以从中计算加速度。这是到达这一点的代码：

```
const double G = 6.67398 * 0.00000000001;

for (int i = 0; i < particles.Count(); i++)
{
    double sumX = 0;
    double sumY = 0;

    for (int j = 0; j < particles.Count(); j++)
    {
        // Don't add attraction to self
        if (i == j)
            continue;

        double distanceX = particles[i].Position.X - particles[j].Position.X;
        double distanceY = particles[i].Position.Y - particles[j].Position.Y;
        double r = Math.Sqrt(Math.Pow(distanceX, 2) + Math.Pow(distanceY, 2));
        double force = G * particles[i].Mass * particles[j].Mass / (r * r);
        double theta = Math.Tan(distanceY / distanceX);
        sumX += force * Math.Cos(theta);
        sumY += force * Math.Sin(theta);
    }

    double netForce = Math.Sqrt(Math.Pow(sumX, 2) + Math.Pow(sumY, 2));
    double a = netForce / particles[i].Mass;
    double aTheta = Math.Tan(sumY / sumX);

    // Here we get accelerations for X and Y.  You can probably figure out velocities from here.
    double aX = a * Math.Cos(aTheta);
    double aY = a * Math.Sin(aTheta);
} 
```

**笔记**

这不考虑 0 值之类的东西 - 您必须清理此代码以处理特殊情况，然后它才能运行而不会崩溃。

在计算完所有力之前不要更新任何位置，否则您将离开列表中的后续元素。

另一件值得注意的事情：这个算法是 O(n^2)，所以如果你有多个身体，它将需要大量的运算。不幸的是，事情就是这样。如果你找到一种快速计算大量物体引力的方法，你应该打电话给 NASA。

根据您的坐标系，您可能会发现 y 向量正在反转。这是因为欧几里得几何将 y 的正值视为“向上”，而程序员倾向于以正单位从屏幕顶部“向下”测量 y。这会对你的角度和事物造成严重破坏。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:59:12.163

知道所有球的位置和它们的质量，你就可以计算出任意两个物体之间的力矢量。找到从球“A”到所有其他球的向量——“A”到“B”球、“A”到“C”、“A”到“D”等。然后，简单地将所有 A 的向量相加到获得作用在 A 上的最终力矢量。对 B -> A、B -> C 等重复以找到 B 的矢量。对所有人都这样做，计算新的速度，并根据步骤之间的时间调整位置。

# python - 我的算法的加密分析

> ID：15537595
> 
> 赞同：-1
> 
> 时间：2013-03-21T00:55:48.463
> 
> 标签：python, encryption, python-2.7, cryptography, complexity-theory

```
import string,random,platform,os,sys
def rPass():
    sent =  os.urandom(random.randrange(900,7899))
    print sent,"\n"
    intsent=0
    for i in sent:
        intsent += ord(i)
    print intsent
    intset=0
rPass() 
```

我需要帮助确定该算法的字节码部分的总可能输出。不要担心 for 循环和用于下线的 ord 东西。-新手加密货币的家伙。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T01:22:02.823

我不会担心循环和这些`ord`东西，所以让我们把它扔掉，看看剩下的。

另外，我不明白“我需要帮助确定该算法的 unicode 部分的全部可能输出”，因为该算法没有 Unicode 部分，或者实际上代码中没有任何 Unicode 部分。但我可以帮助你弄清楚整个事情的总可能输出。我们将逐步简化它。

第一的：

```
li=[]
for a in range(900,7899):
    li.append(a) 
```

这完全等同于：

```
li = range(900, 7899) 
```

同时：

```
li[random.randint(0,7000)] 
```

因为`li`恰好是 6999 个元素长，所以这与`random.choice(li)`.

并且，将最后两个放在一起，这意味着它相当于：

```
random.choice(range(900,7899)) 
```

…相当于：

```
random.randrange(900,7899) 
```

但是等等，那又如何`random.shuffle(li, random.random)`呢？好吧（忽略第二个参数已经是默认值的事实`random.random`），选择已经是随机的，但不是加密的，所以添加另一个 shuffle 不会改变这一点。如果有人试图从数学上预测你的 RNG，用相同的 RNG 添加一个更简单的 shuffle 不会使其更难预测（而基于结果添加更多的工作可能会使计时攻击更容易）。

事实上，即使你使用了一个子集`li`而不是整个东西，也没有办法让你的代码更加不可预测。你将有一个更小的值范围来蛮力通过，没有任何好处。

所以，你的整个事情就变成了这样：

```
sent = os.urandom(random.randrange(900, 7899)) 
```

可能的输出是：长度在 900 到 7899 字节之间的任何字节字符串。

长度是随机的，并且大致均匀分布，但在密码学不可预测的意义上它不是随机的。幸运的是，这可能并不重要，因为大概攻击者可以看到他正在处理的字节数，而不必预测它。

内容是随机的，既均匀分布又在密码学上不可预测，至少在您的系统的范围内`urandom`是这样。

这就是所有要说的。

但是，您使阅读、编写、维护和思考变得更加困难这一事实给您带来了重大劣势，而攻击者却没有任何补偿劣势。

因此，只需使用单线。

* * *

我认为在您的后续问题中，您是在询问 900-7898 字节的随机数据有多少个可能的值。

那么，900 字节有多少个值？`256**900`. 901多少钱？`256**901`. 所以，答案是：

```
sum(256**i for i in range(900, 7899)) 
```

……大约是`2**63184`, 或`10**19020`。

所以，63184 位的安全性听起来很令人印象深刻，对吧？可能不是。如果您的算法没有缺陷，那么 100 位就超出了您的需要。如果您的算法有缺陷（当然是有缺陷，因为它们都是），盲目地向它扔数千位将无济于事。

另外，请记住，加密的全部意义在于`2**N`，对于一​​些较大的 N，您希望破解比合法解密慢。因此，使合法解密慢得多会使您的方案变得更糟。这就是为什么每个现实生活中的加密方案都使用几百位密钥、盐等（是的，公钥加密使用*几千*位作为其密钥，但那是因为它的密钥不是随机分布的。而且通常，您使用这些密钥所做的一切都是为了加密随机生成的几百位的会话/文档密钥。）

* * *

最后一件事：我知道你说过忽略`ord`，但是......

首先，您可以将整个部分写为`intsent=sum(bytearray(sent))`.

但是，更重要的是，如果你对这个缓冲区所做的只是总结它，你就会使用大量的熵来生成一个熵少得多的数字。（想一想这应该很明显。如果有两个单独的字节，则有 65536 种可能性；如果将它们加在一起，则只有 512 种可能性。）

此外，通过生成几千个单字节随机数并将它们相加，这基本上是正态或高斯分布的非常接近的近似值。（如果你是一名 D&D 玩家，想想 3D6 如何比 3 和 18 更频繁地给出 10 和 11……以及 3D6 比 2D6 更是如此……然后考虑 6000D6。）但是，通过使字节数范围从 900 到 7899，您将其拉平，使其趋向从 700*127.5 到 7899*127.5 的均匀分布。无论如何，如果您可以描述您想要获得的分布，您可能可以直接生成它，而不会浪费所有这些 urandom 熵和计算。

值得注意的是，很少有加密应用程序可以利用这么多的熵。甚至像生成 SSL 证书这样的东西也使用 128-1024 位，而不是 64K 位。

* * *

你说：

> 试图杀死密码。

如果您尝试对密码进行加密，以便将其存储在磁盘上或通过网络发送，那么这几乎总是错误的方法。您想使用某种零知识证明——存储密码的哈希值，或者使用质询-响应而不是发送数据等。如果您想构建“让我保持登录功能”，请通过实际保持用户登录（创建并存储会话身份验证令牌，而不是存储密码）。有关基础知识，请参阅 Wikipedia 文章[密码](http://en.wikipedia.org/wiki/Password)。

有时，您*确实*需要加密和存储密码。例如，也许您正在为用户构建一个“密码锁”程序来存储一堆密码。或者是一个设计糟糕的服务器（或 70 年代设计的协议）的客户端。管他呢。如果您需要这样做，您需要使用相对较小的密钥进行一层加密（请记住，典型的密码本身只有大约 256 位长，实际信息不到 64 位，因此使用绝对没有任何好处一个密钥的长度是它们的数千倍）。使它更安全的唯一方法是使用更好的算法——但实际上，加密算法几乎永远不会成为最好的攻击面（除非你自己尝试设计一个）；将精力投入到基础设施最薄弱的领域，

* * *

你问：

> urandom 的输出是否也依赖于它正在使用的汇编程序？

嗯……没有它正在使用的汇编程序，我想不出你提到的任何其他任何有意义的东西。

所`urandom`依赖的只是您的操作系统的熵池和 PRNG。正如[文档](http://docs.python.org/2/library/os.html#os.urandom)所说，`urandom`只需读取`/dev/urandom`（Unix）或调用`CryptGenRandom`（Windows）。

如果您想确切地知道它在您的系统上是如何工作的，或者在 MSDN 中`man urandom`查找。`CryptGenRandom`但是所有主要的操作系统都可以产生足够的熵并将其混合得足够好，您基本上不必担心这一点。在幕后，它们都有效地拥有一些熵池，以及一些用于“拉伸”该池的加密安全 PRNG，以及一些收集任何熵的内核设备（Linux、Windows）或用户空间守护程序（OS X）。从用户操作等不可预知的事情中获取，将其混合到池中。

那么，这取决于什么？假设您没有任何浪费大量熵的应用程序，并且您的机器没有受到损害，并且您的操作系统没有重大安全漏洞……它基本上不依赖于任何东西。或者，换句话说，它取决于这三个假设。

引用[linux 手册页](http://linux.die.net/man/4/urandom)，`/dev/urandom`对于“除了长寿命的 GPG/SSL/SSH 密钥之外的所有内容”已经足够了。（在许多系统上，如果有人试图运行一个程序，就像你的代码一样，读取数千字节的`urandom`.可以处理。）

* * *

> 嗯 python 通过它自己的解释器，所以我不确定它是如何发挥作用的

它没有。显然，调用`urandom(8)`在系统调用之前和之后做了一堆额外的事情来读取 8 个字节，`/dev/urandom`而不是你在 C 问题中所做的……但实际的系统调用是相同的。所以`urandom`设备甚至无法区分两者之间的区别。

> 但我只是问 urandom 是否会在不同的架构上产生不同的结果。

嗯，是的，很明显。例如，Linux 和 OS X 使用完全不同的 CSPRNG 和不同的熵累积方式。但重点是它*应该*是不同的，即使在同一台机器上，或者在同一台机器上的不同时间。只要它在每个平台上都能产生“足够好”的结果，那才是最重要的。

> 例如，处理器\组装器\解释器是否会导致特定于所述架构的指纹，这在随机可预测的范围内？

如上所述，解释器最终会进行与编译代码相同的系统调用。

至于汇编器……可能在任何地方都不涉及任何汇编器。Python 解释器、随机设备、熵收集服务或驱动程序等的相关部分很可能是用 C 编写的。即使它们*是*在汇编中手工编码的，汇编中编码的全部意义在于你几乎直接控制生成的机器代码，因此不同的汇编程序不会有任何区别。

处理器在某种意义上可能会留下“指纹”。例如，我敢打赌，如果您知道 RNG 算法并直接控制其状态，您可以编写代码来区分 x86 与 x86_64，或者甚至可能是一代 i7 与另一代，基于时间。但我不确定这对你有什么好处。该算法仍然会从相同的状态生成相同的结果。用于 RNG 的实际攻击是关于攻击熵累加器和/或熵估计器的算法。

无论如何，我愿意赌一大笔钱，`urandom`比起你自己想出的任何东西，你都更安全。如果你需要更好的东西（而你不需要），实现——或者，更好的是，找到一个经过良好测试的实现——<a href="http://en.wikipedia.org/wiki/Fortuna_%28PRNG%29" rel="nofollow">Fortuna 或[BBS](http://en.wikipedia.org/wiki/Blum_Blum_Shub)，或购买硬件熵生成设备。

# django - django 可重用重定向最佳实践

> ID：15537599
> 
> 赞同：0
> 
> 时间：2013-03-21T00:56:13.897
> 
> 标签：django, redirect

我有许多需要相同功能的视图，所以我试图将该逻辑移动到一个单独的函数中（而不是视图函数）。该函数在 GET 或会话中找到一个值并返回一个模型实例**或**重定向到一个新页面（有点像强制登录）。问题是你不能从一个被调用的函数（我知道）重定向。我应该如何处理这种情况？

这是我的代码：

```
# This is the called function
def getActiveShowOrRedirect(request):
    show_pk = request.GET.get('s', False)
    if not show_pk:
        show_pk = request.session.get('show_pk', False)
        if not show_pk:
            return HttpResponseRedirect('/setup/')
    active_show = Show.objects.get(pk=show_pk)
    return active_show

def overview(request):
    active_show = getActiveShowOrRedirect(request)

    scenes = Scene.objects.filter(show=active_show)
    scenes = sorted(scenes, key=lambda s: s.name) 

    if request.method == 'POST':
        form = SceneForm(request.POST)
        if form.is_valid():
            name = form.cleaned_data['name']
            desc = form.cleaned_data['description']
            scene = Scene(name=name.lower(), show=active_show, description=desc, creator=request.user)
            scene.save()

            return HttpResponseRedirect('/overview/')
    else:
        form = SceneForm(initial={'creator':request.user,'show':active_show})

    return render_to_response('vfx_app/overview.html', {'active_show':active_show,'scenes':scenes,'form':form}, context_instance=RequestContext(request)) 
```

我想我可以在视图函数中检查返回类型，但这似乎有点乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:16:05.520

装修师怎么样？

```
def requires_active_show(view):
    "The decorated view must take active show as a second argument."

    def wrapped(request, *args, **kw):
        show_pk = request.GET.get('s') or request.session.get('show_pk')
        if not show_pk:
            return HttpResponseRedirect('/setup/')

        return view(request, Show.objects.get(pk=show_pk), *args, **kw)

    return wrapped

@requires_active_show
def overview(request, active_show):
    scenes = Scene.objects.filter(show=active_show).order_by('name')

    if request.method == 'POST':
        form = SceneForm(request.POST)
        if form.is_valid():
            name = form.cleaned_data['name']
            desc = form.cleaned_data['description']
            scene = Scene.objects.create(
                         name=name.lower(),
                         show=active_show,
                         description=desc,
                         creator=request.user)

            return HttpResponseRedirect('/overview/')
    else:
        form = SceneForm(initial={'creator': request.user, 'show': active_show})

    return render('vfx_app/overview.html', {
               'active_show': active_show,
               'scenes': scenes,
               'form': form
            }) 
```

# html - Html 页面使用 doctype 变得很奇怪

> ID：15537600
> 
> 赞同：0
> 
> 时间：2013-03-21T00:56:14.503
> 
> 标签：html, doctype

我写了一个 html 页面，在一个单独的文件中有一些 css，它运行良好。然后我意识到我应该在我的 html 中添加一个 doctype 声明。我这样做了，我的页面完全搞砸了！我尝试了所有类型的声明，但结果都一样！！！

这是我的 html（目前仅适用于 Chrome，并且没有 doctype）：

```
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <link rel="stylesheet" type="text/css" href="style.css">
        <title>Luca Rood - Home</title>
    </head>
    <body background="images\background.jpg">
        <div id="header">
            <div id="header-back"></div>
            <div id="top-spacing"></div>
            <div id="content">
                <a href="index.html" title="Luca Rood - Home">
                    <img id="image" src="images\logo.png" alt="Luca Rood">
                </a>
            </div>
        </div>
    </body>
</html> 
```

这是我的CSS：

```
body {
    background-repeat: no-repeat;
    background-position: center center;
    background-size: 100% 100%;
    margin: 0px 0px 0px 0px;
    }

#header {
    position: relative;
    height: 15%;
    }

#header-back {
    position: absolute;
    width: 100%;
    height: 100%;
    background: #000000;
    opacity: 0.3;
    z-index:1;
    }

#top-spacing {
    height: 20%;
    width: 100%;
    }

#content {
    position: relative;
    width: 80%;
    height: 60%;
    margin-top: 0px;
    margin-bottom: 0px;
    margin-left: auto;
    margin-right: auto;
    z-index:2;
    }

#image {
    height: 100%;
    } 
```

请帮忙。

提前致谢，

卢卡

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:27:13.420

您遇到了经典的百分比高度问题。要修复它，您必须添加`height:100%`到`body`样式并在具有以下内容的`html`元素上添加样式`height:100%`：

```
<style>
    body{
        /*...*/
        height:100%;
    }
    html{
        height:100%;
    }
</style> 
```

希望它有效！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-21T01:12:20.967

试试上面的 <html> 标签

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd"> 
```

# c++ - 创建 is_primitive 或 is_inheritable 模板

> ID：15537604
> 
> 赞同：1
> 
> 时间：2013-03-21T00:56:27.620
> 
> 标签：c++, templates, c++11, std

我想创建一个模板来检查类类型是否为原始类型（int、char、float、float*** 等）。这样做的原因是为了防止另一个模板尝试扩展原语并导致编译时错误。到目前为止，我有一些类似的东西：

```
#include <typeinfo>
template<typename T>
struct is_primitive{
   const static bool value=std::is_fundamental<T>::value;
}; 
```

显然，这只是现在转发 is_fundamental 的结果。我想添加 remove_pointer、remove_reference 等...以去除输入类的所有这些额外修饰符。 **使 T 尽可能裸露的所有必要删除是什么？**

或者，类似以下的解决方案同样出色：

```
template<typename T>
struct is_inheritable{
   const static bool value=???;
}; 
```

但我很确定不可继承类的集合等于原始类的集合。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-22T00:12:20.807

这听起来像你想要`std::is_class<T>`的。只能从类类型继承。这是描述 C++11 类型分类特征的图表：[这里 http://howardhinnant.github.io/TypeHiearchy.pdf](http://howardhinnant.github.io/TypeHiearchy.pdf)

[http://howardhinnant.github.io/TypeHiarchy.pdf](http://howardhinnant.github.io/TypeHiearchy.pdf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T07:56:43.300

我建议您尝试专注于检测*在您的情况下*需要可继承的类型的属性，而不是考虑检测那些不可继承的类型。运气好的话，您的类需要基类中可以检查的其他属性，因为您的派生类将需要调用基类的至少一个构造函数。

尝试使用[`is_constructible`](http://en.cppreference.com/w/cpp/types/is_constructible)或一些相关的类型特征：

```
// check that T::T(std::string,int); exists:
std::is_constructible< T, std::string, int >::value

// or these direct traits for the usual suspects...
std::is_default_constructible< T >::value
std::is_copy_constructible< T >::value
std::is_move_constructible< T >::value 
```

对于您的其他问题，如果在上述之后仍然相关，请检查[`std::decay`](http://en.cppreference.com/w/cpp/types/decay)并将其与其他特征结合以根据需要剥离类型：

```
template< typename T, typename = void >
struct strip
{
     typedef T type;
};

template< typename T >
struct strip< T, typename std::enable_if<
  !std::is_same< typename std::decay< T >::type, T >::value
>::type >
    : strip< typename std::decay< T >::type >
{
};

template< typename T >
struct strip< T, typename std::enable_if<
  std::rank< T >::value != 0
>::type >
    : strip< typename std::remove_all_extents< T >::type >
{
};

template< typename T >
struct strip< T, typename std::enable_if< std::is_pointer< T >::value >::type >
    : strip< typename std::remove_pointer< T >::type >
{
};

typedef const int*(&Test)[42];
static_assert( std::is_same< typename strip< Test >::type, int >::value, "" ); 
```

但是当然，您需要弄清楚您的情况到底适合什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:41:05.837

```
template <typename T>
struct remove_all { typedef typename std::remove_cv<T>::type type; };
template <typename T>
struct remove_all<T*> { typedef typename remove_all<T>::type type; };
template <typename T>
struct remove_all<T&> { typedef typename remove_all<T>::type type; };
template <typename T>
struct remove_all<T&&> { typedef typename remove_all<T>::type type; };

template<typename T>
struct is_primitive{
    typedef typename remove_all<T>::type TF;
    const static bool value=std::is_fundamental<TF>::value;
}; 
```

[在这里](https://stackoverflow.com/questions/14951868/recursive-stdremove-pointer)找到 remove_all 结构讨论。

# java - Android：条形图上的 AChartEngine 垂直渐变？

> ID：15537606
> 
> 赞同：0
> 
> 时间：2013-03-21T00:56:45.847
> 
> 标签：java, android, achartengine

我一直在使用 Android 中的 AChartEngine，但似乎找不到在堆叠条形图的条上放置垂直渐变的方法。这是我的酒吧代码。

```
renderer.getSeriesRendererAt(1).setGradientEnabled(true);
renderer.getSeriesRendererAt(1).setGradientStart(0, Color.rgb(192, 192, 192));
renderer.getSeriesRendererAt(1).setGradientStop(45, Color.rgb(25, 25, 112)); 
```

这是它的样子：

![在此处输入图像描述](../Images/5f86271b61ab7bf6383280e00f20f413.png)

我希望渐变从左到右，而不是从下到上。任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:35:33.883

AChartEngine 中的渐变基于显示的数据值。条形图中的值从下到上升高，因此渐变显示在同一方向上。

# android - 带有字符串数组的Android DialogFragment在数组中间打开？

> ID：15537607
> 
> 赞同：0
> 
> 时间：2013-03-21T00:56:46.133
> 
> 标签：android, dialog, android-dialogfragment

我正在打开一个对话框，以便我的用户可以从列表中选择一年。

```
AlertDialog.Builder builder = new AlertDialog.Builder(getActivity());
builder.setTitle("Choose Year")
       .setItems(years, new DialogInterface.OnClickListener() {
           public void onClick(DialogInterface dialog, int which) {
               // The 'which' argument contains the index position
               // of the selected item

           }
       });
return builder.create(); 
```

`years`变量是 a ，`String[]`但它最多可以包含 100 个项目。有没有办法让对话框打开，在可见的初始范围内显示列表中的特定项目？例如，如果年份数组从 1913 年到 2013 年，它总是打开到 1913 年。有没有办法让它在 1980 年的列表中间打开？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T02:23:43.500

尝试在 DialogFragment 的 onCreateView 方法中使用 ListView 膨胀布局。

# c# - 使用数据库数据更新 winforms 标签或文本框

> ID：15537609
> 
> 赞同：-4
> 
> 时间：2013-03-21T00:57:00.877
> 
> 标签：c#, database, data-binding

我想从数据库中检索一些文本并使用这些数据来更新标签或文本框的值。到目前为止，我唯一的经验是将数据库绑定到 gridview，但该方法在这种情况下不起作用。请问你能建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:19:28.470

这是一个粗略的例子。在现实世界中，您希望重用您的连接对象/也许使用 DatabaseFactories 和 ConnectionPooling。此示例仅显示使用数据库中的信息填充标签文本的简单方法。

```
const string ConnectionString = "Initial Catalog=Northwind;Data Source=localhost;Integrated Security=SSPI;";
const string GetLabelText = "select labeltext from myLabelTextTable where id={0}";
const string DefaultLabelText = "-undefined-";

public void UpdateLabel(Label myLabel, int labelTextId)
{
    string labelText;
    using (SqlConnection connection = new SqlConnection(ConnectionString))
    {
        connection.Open();
        using (SqlCommand command = new System.Data.SqlClient.SqlCommand(string.Format(GetLabelText,labelTextId), connection))
        {
            labelText = (command.ExecuteScalar() ?? DefaultLabelText).ToString();
        }
        connection.Close();
    }
    myLabel.Text = labelText;
} 
```

# mongodb - mongodb geoNear vs near

> ID：15537611
> 
> 赞同：14
> 
> 时间：2013-03-21T00:57:02.220
> 
> 标签：mongodb, geospatial

看起来 mongodb 为地理空间查询提供了两个类似的功能 -`$near`和`$geoNear`. 根据 mongo 文档

> geoNear 命令提供了 $near 运算符的替代方法。除了 $near 的功能之外，geoNear 还返回其他诊断信息。

它看起来`geoNear`提供了`near`功能的超集。例如，`near`似乎只返回最接近的 100 个文档，而`geoNear`让您指定最大值。有理由使用`near`而不是`geoNear`吗？一个比另一个更有效吗？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-21T02:48:18.187

两者的效率应该相同。

`geoNear`的主要限制是，作为命令，它可以返回设置为最大文档大小的结果，因为所有匹配的文档都在单个结果文档中返回。它还要求在每个结果文档中添加一个距离字段，这可能是也可能不是问题，具体取决于您的使用情况。

`$near`是一个查询运算符，因此结果可以大于单个文档（它们仍然在单个响应中返回，但不是单个文档）。您还可以通过查询的 limit() 设置最大文档数。

我倾向于建议用户坚持使用，`$near`除非他们需要命令中的`diagnostics`（例如，距离或位置匹配）`geonear`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-25T07:15:02.180

这些是主要区别：-

1.  $geoNear 还可以为您提供与该点的距离，但 $near 命令没有。

2.  $geoNear 命令要求集合最多只有一个 2d 索引和/或只有一个 2dsphere 索引，而像 $near 和 $geoWithin 这样的地理空间查询运算符允许集合具有多个地理空间索引。这是因为在 $geoNear 命令中没有指定要搜索的字段的选项，而在 $near 命令中您可以指定字段名称。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2019-07-30T08:39:58.677

主要区别在于 $near 是一个查询运算符，但`$geoNear`它是一个聚合阶段。两者都按离给定点最近到最远的顺序返回文档。

这意味着 $near 可以在 find() 查询或`$match` [聚合](https://docs.mongodb.com/manual/aggregation/)阶段使用，但`$geoNear`不能。而是`$geoNear`必须仅用作单独的聚合阶段。

每个功能提供的选项也不同。我邀请您查看相应文档部分中的详细信息：

[$near 文档](https://docs.mongodb.com/manual/reference/operator/query/near/index.html)
[$geoNear 文档](https://docs.mongodb.com/manual/reference/operator/aggregation/geoNear/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T04:14:56.743

GeoNear 的 100 个文档限制是默认行为，但您可以按照 mongodb 文档 ( [http://docs.mongodb.org/manual/reference/command/geoNear/](http://docs.mongodb.org/manual/reference/command/geoNear/) )中的说明设置**num字段**

默认设置为 100，但您可以设置更多。不幸的是，目前缺少**跳过参数（请参阅**[https://jira.mongodb.org/browse/SERVER-3925](https://jira.mongodb.org/browse/SERVER-3925)）

# vim - 由两个键调用的 Vim 键绑定

> ID：15537614
> 
> 赞同：1
> 
> 时间：2013-03-21T00:57:12.977
> 
> 标签：vim, key-bindings

**我想要做什么：**如何在 vim 中创建自定义键绑定以在插入模式下编写“hello world”，首先按住'w'然后按'2'？

**请注意**，我不希望通过按 w 然后按 2 来调用我的命令——必须按住 w 键然后按 2。另请注意，如果先按住 2 键然后按下 w，则不应调用该命令。

希望先按住 w 然后按 2 的原因是，如果我想按字面意思输入“w2”，我可以通过按+按 w 然后按 2 来做到这一点

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T06:18:59.087

您是否尝试[过 TextExpander](http://smilesoftware.com/TextExpander/index.html)或者更好的是[TypeIt4Me](http://www.ettoresoftware.com/products/typeit4me/)？

无论如何，您描述的确切机制在 Vim 中以本机插入模式是不可能的。由于`w`不是修饰键，因此您不能按住它并期望 Vim 注册第二个按键。

我能想到的更接近的是[琶音](http://www.vim.org/scripts/script.php?script_id=2425)，它可以让您将事物映射到*同时按下的键*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:01:55.710

输入`:inoreab w2 hello world`或写`inoreab w2 hello world`在您的`.vimrc`

然后当你处于 INSERT 模式时，输入`w2<space>`，这两个词就会出现在上面。

leader key ( `<leader>`) 可以是anykey，用户可以自己映射。默认为`\`. 顺便说一句，我认为映射`w`为领导键不是一个好主意。`w`它在正常模式下与 (word forward)冲突。

我将（逗号）映射`,`为领导键。

更多细节请检查`:h <leader>`

**编辑**OP 的评论

> 我可以以某种方式做到这一点而不必按下`<space>`？

是的，你可以。（但我不建议这样做。）

你可以去映射的方式来跳过空间。

```
:inoremap w2 hello world 
```

请注意，如果您有该映射，则在 INSERT 模式下，只要您按下`w2`“hello world”，就会立即出现。我不确定这对你是否方便，对我来说不是。

# regex - 如何使用 Windows 命令行正则表达式

> ID：15537616
> 
> 赞同：14
> 
> 时间：2013-03-21T00:57:21.073
> 
> 标签：regex, command-line, command-prompt

我无法找到如何在 Windows 命令行中执行正则表达式。我想在很多情况下使用正则表达式，但基本上现在我要做的就是打开一个名称中包含正则表达式的文件。

示例：启动 s.html 工作正常，但启动 *.html 不起作用。需要什么？

谢谢

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-21T01:10:56.807

与许多 Unix shell 不同，Windows 命令行处理器不会自动扩展通配符。每个程序都有责任在它认为合适的时候扩展通配符。许多程序根本不支持通配符。在这些情况下，您始终可以创建一个 FOR 循环，以对通配符指定的一组文件重复发出相同的命令。

例如`for %f in (*.txt) do echo %f`

将回显目录中所有 *.txt 文件的名称。

使用 help 命令获取有关任何 Windows 命令的更详细帮助。IE

```
help for 
```

至于正则表达式：除了`findstr`，我不知道任何支持正则表达式的内置 Windows 命令。

# sql-server-2012 - 在 MDX 中将“YYYYMMDD”格式字符串转换为日期？

> ID：15537618
> 
> 赞同：4
> 
> 时间：2013-03-21T00:57:25.253
> 
> 标签：sql-server-2012, mdx, date-format, date-conversion

我在 MDX 中的“YYYYMMDD”格式字符串上应用与日期相关的函数时遇到了一些问题。例如，如果我在下面有这个查询：

```
with 
    member foo as WEEKDay("2013-03-21")
select
    foo on 0
from 
    [Some Cube] 
```

它将在 SSMS 中为 foo 正确输出“5”。但是，如果我将第二行更改为：

```
 member foo as WEEKDay("20130321") 
```

不幸的是，它会抛出“类型不匹配”错误。

所以我想要做的是将字符串转换为一些可识别的日期格式，然后在其上应用函数。最简单方法的任何想法，例如使用现有功能？

**请注意**，该字符串实际上是从运行 MDX 的任何多维数据集中的成员输入的。所以字符串格式可以被识别，例如“YYYY-MM-DD”。所以硬编码的字符串转换算法可能不行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-27T15:10:46.663

主题太旧了，但也许这可能对某人有所帮助。技术相当粗鲁，但可扩展。

```
with 
    member foo_false as WeekDay("20130321")
    member foo_true as WeekDay("2013-03-21")
    member foo_brute as 
    case when IsError(WeekDay("20130321"))=False then WeekDay("20130321") else
        case
        /* YYYYMMDD */
        when 
        IsError(WeekDay("20130321"))=True AND IsNumeric("20130321")=True
        and IsError(WeekDay(Left("20130321",4)+'-'+Right(Left("20130321",6),2)+'-'+Right("20130321",2)))=False
            then WeekDay(Left("20130321",4)+'-'+Right(Left("20130321",6),2)+'-'+Right("20130321",2))

        /* DDMMYYYY */
        when 
        IsError(WeekDay("20130321"))=True AND IsNumeric("20130321")=True
        and IsError(WeekDay(Right("20130321",4)+'-'+Right(Left("20130321",4),2)+'-'+Left("20130321",2)))=False
            then WeekDay(Right("20130321",4)+'-'+Right(Left("20130321",4),2)+'-'+Left("20130321",2))

        /* MMDDYYYY */
        when 
        IsError(WeekDay("20130321"))=True AND IsNumeric("20130321")=True
        and IsError(WeekDay(Right("20130321",4)+'-'+Left("20130321",2)+'-'+Right(Left("20130321",4),2)))=False
            then WeekDay(Right("20130321",4)+'-'+Left("20130321",2)+'-'+Right(Left("20130321",4),2))

        /* Unsupported Message */
        else "Unsupported Format" end
    end
select
    {foo_false,foo_true,foo_brute} on 0
from 
    [DATA Cube] 
```

在“不支持”之前将支持的格式添加到末尾，使用任何输入字符串而不是`"20130321"`.

但最简单的方法是在插入到 MDX 之前使用另一层（例如 SQL 函数 CONVERT），如果可能的话，当然可以。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-04T06:55:47.603

vba 函数`isDate`可用于检查传递的日期是否格式正确。如果不是，则首先使用`dateserial`和格式化它`mid`并使用它们。

```
with 
member foo as "20130321"

member bar as   
iif(vba!isdate(foo) = TRUE, 
    WEEKDay(foo), //--if the date is already well formatted, it can be used
    WEEKday(vba!dateserial(vba!mid(foo, 0, 4), vba!mid(foo, 5, 2), vba!right(foo, 2))))
select
    bar on 0
from 
    [some cube] 
```

**编辑**

上面的代码*可以*修改以适应其他检查，例如`MMDDYYYY`or `DDMMYYYY`，但在很多情况下，引擎不可能直观地知道传递的值是否在`YYYYMMDDDD`or`DDMMYYYY`或`MMDDYYYY`中。以字符串为例`1111111`

这可以很容易地采用任何日期格式，因为它是一个有效的日期，无论你如何打破它。

我建议您有另一个成员也可以存储日期格式。这样看这个成员，就可以解析字符串。

例如

```
with 
member foo as 
//  "20130321" //YYYYMMDD
//  "03212013"//MMDDYYYY
"21032013"//DDMMYYYY

MEMBER dateformat as "ddmmyyyy"

member bar as   
iif(vba!isdate(foo) = TRUE, 
    WEEKDay(foo), 
    IIF(dateformat = "yyyymmdd", //YYYYMMDD
        WEEKday(vba!dateserial(vba!mid(foo, 0, 4), vba!mid(foo, 5, 2), vba!right(foo, 2))), 
        IIF(dateformat = "mmddyyyy", //MMDDYYYY
            WEEKday(vba!dateserial(right(foo, 4), vba!mid(foo, 0, 2), vba!mid(foo, 3, 2))),
            IIF(dateformat = "ddmmyyyy", //DDMMYYYY
                WEEKday(vba!dateserial(right(foo, 4), vba!mid(foo, 3, 2), vba!mid(foo, 0, 2))),
                null
               )
            )
        )
    )

select
    bar on 0
from 
    [aw cube] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-01-28T14:06:09.973

在`FooMember`这里是一个 int，代表一个`yyyyMMdd`日期，我可以使用以下代码将其转换为 Date

```
 =Format(CDate(Left(CSTR(Fields!FooMember.Value),4)
   + "-" + Mid(CSTR(Fields!FooMember.Value), 5, 2)
   + "-" + Right(CSTR(Fields!FooMember.Value), 2)),
   "dd/MM/yyyy") 
```

使用以下代码在多维数据集中使用它

```
 Format(CDate(Left([Measures].[FooMember],4)
 + "-" + Mid([Measures].[FooMember], 5, 2)
 + "-" + Right([Measures].[FooMember], 2)),"yyyy/MM/dd") 
```

# iphone - 视频处理问题

> ID：15537622
> 
> 赞同：1
> 
> 时间：2013-03-21T00:57:29.393
> 
> 标签：iphone, ios, objective-c, xcode, video-processing

我有一些相关的问题：iOS 上的视频处理。

1) 是否可以暂停然后恢复 AVVideoComposition 处理会话？我问这个是因为当我的应用程序在后台运行时（即应用程序的 10 分钟后台处理限制），我遇到了将大型 1080p 视频文件合并在一起的问题。到目前为止，我的经验是，如果应用程序在后台运行时达到 10 分钟的限制并且应用程序被 iOS 停止，则视频处理会话会失败。如果我能够暂停视频处理会话，我可以检测到 10 分钟限制的临近，然后暂停视频处理，直到用户将应用程序带回最前沿，然后恢复它，等等等等。

2) 代替上述能力，有没有办法将后台处理“延长”超过 10 分钟？我的应用程序不属于允许在后台连续运行的任何应用程序类别。但我对我的应用程序这样做的需要是合法且真实的——原因是 iphone 上的视频很大——新 iPhone 上的视频为 1080p——并且处理它们需要一段时间。在某种程度上，限制应用程序处理代表他们在视频拍摄设备上拍摄的视频的能力对用户来说是不公平的。底线：只要应用程序处于 AVComposition 视频处理会话的中间，就应该允许应用程序继续完成它，或者暂停并稍后恢复。

3）如果上述选项均不可用，请您推荐一个处理此问题的策略。我想让我的应用程序在可靠性方面坚如磐石，让用户确切地知道发生了什么。

4）是否可以将较低质量的视频上转换为较高（尽管更模糊）质量？例如：假设我想合并两个视频剪辑，一个质量较低，一个质量较高。目前，如果我将这两者合并在一起，生成的视频将以更高质量视频的分辨率播放；包含较低质量视频的部分在较大视频帧左上角的较小视频帧中播放，其余帧被涂黑。我更喜欢让质量较低的视频填充较大的帧，即使结果变得模糊。（注意：我确实想保持较低质量视频的纵横比，但是，顶部/底部或左侧/右侧的黑色条纹是可以的。）

谢谢！

# linux - 离开指令返回一个段错误

> ID：15537623
> 
> 赞同：2
> 
> 时间：2013-03-21T00:57:32.493
> 
> 标签：linux, assembly, nasm, 32-bit

我有一个例程调用一个例程，在该例程中需要一个值到`ebp`寄存器中。我在例程中更改了几次。所以，我不能这样做：`mov ebp,esp`在代码的顶部。我尝试将`esp`地址保存在另一个寄存器中在`leave`指令将这样的地址放入之前，`ebp`但我仍然遇到分段错误。

如何解决这个问题？

代码非常庞大（在这里发布，但如果需要我可以发布），但想法是这样的：

```
;a lot of arguments are passed in stack
foo:
xor ebx,ebx
mov ecx,esp
loop0:
sub edx,1
jz end
;etc
mov eax,[esp+ebx]
mov ebp,eax
call routinex
;etc..
;...
mov ebp,edx
call printx
add ebx,4
jmp loop0
end:
mov ebp,ecx
leave
ret 
```

我希望这段代码足以让你明白。我也喜欢解释。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:07:09.020

这`leave`是什么：

```
mov esp, ebp
pop ebp 
```

如果你想使用它并让它工作，你应该写类似

```
push ebp
mov ebp, ecx
leave 
```

在您的功能结束时。当然，`leave`如果你这样做，你可以完全放弃使用：

```
mov esp, ecx
ret 
```

因为您使用`ecx`的是帧指针。

# asp.net - 如何清除主 Web 应用程序和虚拟子应用程序中的会话？(ASP.NET)

> ID：15537632
> 
> 赞同：2
> 
> 时间：2013-03-21T00:58:28.447
> 
> 标签：asp.net, session, iis, logout, application-pool

我们的 Web 应用程序`(asp.net 4.0)`具有以下结构`IIS (7.5 / 8.0)`

```
-MainWebApp (application pool: MainWebApp)
--VirtualWepApp1 (application pool: VirtualWepApp1)
--VirtualWepApp2 (application pool: VirtualWepApp2)
--VirtualWepApp3 (application pool: VirtualWepApp3) 
```

单一登录页面位于`MainWebApp`. 与用户相关的数据存储在会话中，并根据用户访问这些虚拟应用程序下的资产（.net 页面）时重新`VirtualWepApp1, VirtualWepApp2, VirtualWepApp3`创建`HttpContext.Current.Profile.UserName`。`MainWebApp/logout`我们面临的问题是，如果用户浏览该页面，他/她没有从系统中完全注销。

我所做的工作是：

```
- create logout page for every application with Session.Abandon() and System.Web.Security.FormsAuthentication.SignOut()
- the logout link goes to the VirtualWepApp3/logout
- from VirtualWepApp3/logout redirect to VirtualWepApp2/logout
- from VirtualWepApp2/logout redirect to VirtualWepApp1/logout
- from VirtualWepApp1/logout redirect to MainWebApp/logout 
```

其他解决方案是将所有应用程序放在同一个应用程序池下，但是由于其他一些编码困难，这是不行的。

**问题**：有没有简单的方法从所有应用程序（主要和虚拟）中清除会话/注销用户？

——
**附言**。我继承了虚拟应用程序的这种结构/架构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-07T08:49:32.927

应用程序池的主要目标是（除其他外）隔离您的应用程序，因此可能的（推荐解决方案）是向每个应用程序发出信号以执行所需的注销：

```
System.Web.Security.FormsAuthentication.SignOut(); 
```

如何？

创建一个[HTTP 处理](http://msdn.microsoft.com/en-us/library/bb398986%28v=vs.100%29.aspx)程序（保证安全性，限制它访问调用者允许的主机/IP 或/并在请求上使用加密密钥），当调用该处理程序时，将退出当前应用程序上的用户。

然后，当您在其中一个应用程序上注销时，您可以为其余应用程序注销处理程序调用（信号）传递用户信息（密钥等）。

[这个](https://stackoverflow.com/questions/852942/how-do-you-programatically-end-a-session-in-asp-net)答案也可能适用于您的需求。

# android - Mono for android - Android.OS 和 Android.Provider 程序集？

> ID：15537636
> 
> 赞同：2
> 
> 时间：2013-03-21T00:58:56.830
> 
> 标签：android, mono, xamarin.android

我正在为 android 4.6 使用单声道，试图获取设备信息。我见过的样本如下，但我不确定要添加什么参考才能获得这些？

```
var device = Android.OS.Build.Device;  //type or namespace OS does not exist...(missing     assembly?)
var id = Android.Provider.Settings.Secure.GetString(ContentResolver, Android.Provider.Settings.Secure.AndroidId); //type or namespace 'Provider' does not exist..(missing assembly?) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-25T12:30:59.513

试试这种方式：

```
using Android.OS;
using Android.Provider;
using Android.Content;
using Android.App;

var device = Build.Device;
var id = Settings.Secure.GetString(Application.Context.ContentResolver, Settings.Secure.AndroidId); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-04-21T20:24:22.973

这是一个非常古老的问题，但如果有人仍然遇到这个问题，只需附加`global::`如下：

```
var device = global::Android.OS.Build.Device;  //type or namespace OS does not exist...(missing     assembly?)
var id = global::Android.Provider.Settings.Secure.GetString(ContentResolver, global::Android.Provider.Settings.Secure.AndroidId); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T06:55:46.633

[http://androidapi.xamarin.com/?link=P%3aAndroid.OS.Build.Device](http://androidapi.xamarin.com/?link=P%3aAndroid.OS.Build.Device)

它定义在`Mono.Android.dll`

# java - 在多个索引上对 Int[] 的 ArrayList 进行排序

> ID：15537640
> 
> 赞同：0
> 
> 时间：2013-03-21T00:59:38.773
> 
> 标签：java, sorting, arraylist

我目前有一个`ArrayList`. `int[]`有`int[]`5个元素。我希望能够`ArrayList`根据 my 的第二个和第四个索引对其进行排序`int[]`。我如何在 Java 中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:04:44.580

```
package com.sandbox;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;

public class Sandbox {

    public static void main(String[] args) {
        List<int[]> list = new ArrayList<int[]>();
        list.add(new int[]{1, 4, 6, 8, 9});
        list.add(new int[]{1,3,6,7,8});
        list.add(new int[]{1,4,6,7,9});
        Collections.sort(list, new Comparator<int[]>() {
            public int compare(int[] o1, int[] o2) {
                int compare = Integer.compare(o1[1], o2[1]);
                //if they're equal on this element then compare the next element
                return compare == 0 ? Integer.compare(o1[3], o2[3]) : compare;
            }
        });
        for (int[] ints : list) {
            System.out.println(Arrays.toString(ints));
        }
    }
} 
```

这是输出：

> [1, 3, 6, 7, 8] [1, 4, 6, 7, 9] [1, 4, 6, 8, 9]

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T05:15:08.173

你需要一个像这样的自定义比较器

```
 class IntArrayComparator implements Comparator<int[]> {
        private final int[] ai;

        IntArrayComparator(int[] ai) {
            this.ai = ai;
        }

        @Override
        public int compare(int[] a1, int[] a2) {
            for (int i : ai) {
                int c = Integer.compare(a1[i], a2[i]);
                if (c != 0) {
                    return c;
                }
            }
            return 0;
        }
    } 
```

请注意，Java 7 中添加了 Integer.compare(int, int)，在早期版本中使用

```
int c = (a1[i] < a2[i]) ? -1 : a1[i] == a2[i] ? 0 : 1; 
```

# ruby-on-rails - Rails 2：#to_xml(:methods => :method_name) 当#method_name 返回一个数组时

> ID：15537641
> 
> 赞同：1
> 
> 时间：2013-03-21T00:59:47.320
> 
> 标签：ruby-on-rails, xml-serialization, ruby-on-rails-2, ruby-1.8.7

如果它是一个数组，是否可以覆盖#to_xml 如何呈现方法结果？

给定 #numbers 不是字段而是方法 And @object.numbers #=> [0,1,2,3,4,5]

目前它确实：

```
@object.to_xml(:methods => :numbers)
=> "<object><numbers>012345</numbers></object>" 
```

是否可以覆盖此行为，使其返回：

```
@object.to_xml(:methods => :numbers)
=> "<object>
      <numbers>
        <number>0</number>
        <number>1</number>
        <number>2</number>
        <number>3</number>
        <number>4</number>
        <number>5</number>
      </numbers>
    </object>" 
```

（格式化以便于阅读）

提前感谢您的建议！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T03:26:43.243

你有两个选择：

1.  升级到 Rails 3。它已经有了所需的输出。

    ```
    gem "activemodel", '~> 3.2.12'
    require "active_model"

    # This could be an Active Record model
    class Result
      include ActiveModel::Serializers::Xml

      def numbers
        (0..5).to_a
      end

      def attributes
        {}
      end
    end

    result = Result.new
    puts result.to_xml(:methods => :numbers) 
    ```

    输出：

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <result>
      <numbers type="array">
        <number type="integer">0</number>
        <number type="integer">1</number>
        <number type="integer">2</number>
        <number type="integer">3</number>
        <number type="integer">4</number>
        <number type="integer">5</number>
      </numbers>
    </result> 
    ```

2.  在您可以完全控制输出的情况下使用 XML Builder。您必须手动指定所有属性。

    ```
    # app/views/results/show.xml.builder
    xml.instruct!
    xml.result {
      xml.numbers {
        result.numbers.each do |n|
          xml.number n
        end
      }
    } 
    ```

    输出：

    ```
    <?xml version="1.0" encoding="UTF-8"?>
    <result>
      <numbers>
        <number>0</number>
        <number>1</number>
        <number>2</number>
        <number>3</number>
        <number>4</number>
        <number>5</number>
      </numbers>
    </result> 
    ```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-19T15:19:44.013

您可以使用该`:procs`选项在模型中为您的方法添加自定义渲染：

```
def to_xml(options={})
  numbers_proc = Proc.new do |options|
    xml = options[:builder]
    xml.numbers do
      numbers.each do |n|
        xml.number n
      end
    end
  end
  super options.merge(:procs => numbers_proc)
end 
```

# php - 如何从数据库中检索信息并显示在表格中？

> ID：15537643
> 
> 赞同：-1
> 
> 时间：2013-03-21T01:00:05.347
> 
> 标签：php, formatting, html-table

这是我的 php 代码。

```
<?php
session_start();
foreach($_POST AS $key => $val) {
$_SESSION[$key]=$val;
}

mysql_connect('localhost', 'bikec_user', '4348@TxState');
mysql_select_db('bikecats_database');

$cnetid=$_POST['cnetid'];
$cpassword=$_POST['cpassword'];

$cnetid = stripslashes($cnetid);
$cpassword = stripslashes($cpassword);
$cnetid = mysql_real_escape_string($cnetid);
$cpassword = mysql_real_escape_string($cpassword);

$sql="SELECT RentalID, BikeID, RentalStartDate, RentalEndDate
  FROM rental  
  WHERE CustTxStateNetID = '$cnetid'";
$result=mysql_query($sql) OR die(mysql_error());
$row=mysql_fetch_assoc($result);

$rentalid=$row['RentalID'];
$bikeid=$row['BikeID'];
?> 
```

这是html代码。它应该显示从数据库中检索到的查询，但由于某种原因，当我运行它时，表出现空白。我知道我只是在呼应两个变量，但即使这些变量也是空的。

```
 <div class="span9">  
          <h2>My Account</h2>
          <p><strong>My Rentals</strong></p>
        <table class="table table-striped">  
            <thead>  
              <tr>  
                <th>Rental ID</th>   
                <th>Bike ID  
                <th>Check-Out Date</th>  
                <th>Return Date</th>  
              </tr>  
            </thead>  
            <tbody>  
              <tr>  
                <td><?php echo $rentalid ?></td>    
                <td><?php echo $bikeid ?></td>   
                <td></td> 
                <td></td>  
              </tr>   
              <tr>  
                <td></td>  
                <td></td>   
                <td></td>   
                <td></td>  
              </tr>
            </tbody> 
        </table><br>
        </div><!-- end span --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:15:39.697

尝试这个：

---------------------------------------已编辑---------- ------------------

```
<?php
   session_start();

  if(isset($_POST['cnetid'])){
  mysql_connect('localhost', 'bikec_user', '4348@TxState');
  mysql_select_db('bikecats_database');  
  $cnetid = mysql_real_escape_string($_POST['cnetid']);
  $cpassword = mysql_real_escape_string($_POST['cpassword']);
  $table = "<table class='table table-striped' >  
              <thead>  
                <tr>  
                  <th>Rental ID</th>   
                  <th>Bike ID  
                  <th>Check-Out Date</th>  
                  <th>Return Date</th>  
                </tr>  
              </thead>  
              <tbody>  
              ";
  $sql="SELECT RentalID, BikeID, RentalStartDate, RentalEndDate
    FROM rental  
    WHERE CustTxStateNetID = '$cnetid'";
    $body = "";
  $result=mysql_query($sql) OR die(mysql_error());
   while ($row=mysql_fetch_assoc($result))
   {
     $body = $body." <tr><td>".$row['RentalID']."</td>  
                     <td>".$row['BikeID']."</td>   
                     <td>".$row['RentalStartDate']."</td> 
                     <td>".$row['RentalEndDate']."</td></tr> ";
   }
   $table = $table.$body."   
                <tr>  
                  <td></td>  
                  <td></td>   
                  <td></td>   
                  <td></td>  
                </tr>
              </tbody> 
          </table>" ;

  }
  else
  {
    $table = "No data..";
  }

  ?>

  <div class="span9">  
        <h2>My Account</h2>
        <p><strong>My Rentals</strong></p>
        <?php echo $table; ?>
        <br>
  </div> 
```

PS：发现错误，更正，并测试代码 xD

萨卢多斯 ;)

# ruby-on-rails - 使用包含比较两个数组？

> ID：15537645
> 
> 赞同：1
> 
> 时间：2013-03-21T01:00:14.607
> 
> 标签：ruby-on-rails, ruby

我有两个数组：

```
@all_genres = [#<Genre id: 1, name: "Action", created_at: "2013-03-01 07:44:51", updated_at: "2013-03-01 07:44:51">,
               #<Genre id: 2, name: "Adventure", created_at: "2013-03-01 07:44:51", updated_at: "2013-03-01 07:44:51">,
               #<Genre id: 3, name: "Animation", created_at: "2013-03-01 07:44:51", updated_at: "2013-03-01 07:44:51">]

@genres = ["Action", "Animation"] 
```

我试图找到与表格相比的`Genre.id`from 。例如我的结果应该是：`@genres``@all_genres`

```
@genre_ids = [1, 3] 
```

我试过这个：

```
@all_genres.each do |g|
  if g.name.include?((@genres.each {|g| g}).to_s)
    @genre_ids << g.id
  end
end 
```

我在控制台中尝试了这个，它似乎可以工作，但是当我将它放入我的应用程序时它返回：

```
@genre_ids = [] 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-21T01:58:34.617

一个更轨道式的版本：

```
@genre_ids = Genre.where(name: @genres).pluck(:id) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T01:09:49.203

我假设您正在`@genres`通过调用来填充您的数组`Genre.all`。

你可以简单地做这样的事情：

```
Genre.where("name IN (?)", %w[name action]).collect { |x| x.id } 
```

如果您想`ids`使用这些名称检索流派。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T01:12:56.147

或者你可以试试这个单行：

```
@genre_ids = @all_genres.select{|g| @genres.include? g.name }.map(&:id) 
```

# mysql - SQL触发器在插入后更新另一个表列

> ID：15537653
> 
> 赞同：0
> 
> 时间：2013-03-21T01:01:07.333
> 
> 标签：mysql, sql, triggers, insert, average

我有一个名为`Ratings`columns `User_No`、`Recipe_No`和`Rating`

插入后，我想更新`Avg_Rating`另一个名为`Recipes`.

我是 SQL 语法的新手，但这基本上是我想要做的

```
CREATE TRIGGER `Update_Avg` AFTER INSERT ON `Ratings`
FOR EACH ROW 
SELECT @recipeNo = Recipe_No FROM INSERTED;

SELECT @avg = AVG(Rating) FROM databs.Ratings WHERE
`Recipe_No` = @recipeNo;

INSERT INTO databs.Recipes (`Avg_Rating`) VALUES (@avg)
WHERE `Recipe_No` = @recipeNo; 
```

# actionscript-3 - 华氏到摄氏转换器有更好的方法吗？

> ID：15537654
> 
> 赞同：-3
> 
> 时间：2013-03-21T01:01:38.397
> 
> 标签：actionscript-3

在这里，我有一个 AS3 华氏到摄氏转换器，我想知道是否有更好的方法来完成相同的功能，暂时记住这个剂量工作？<< 虽然只有 2 位小数。>>

```
function RandomNumber(min:Number, max:Number = 0):Number
{
    return Math.round(Math.random() * (max - min)) + min;
}

for(var i:int = 0; i < 20; i++)
{
    var fahrenheit:Number = RandomNumber(-50, 100)

    function fahrenheit2celsius(fahrenheit):Number
    {
        var celsius:Number = fahrenheit
        celsius = fahrenheit - 32
        celsius = celsius / 1.8
        celsius = celsius * 10 ^ 2
        celsius = celsius + .5
        celsius = celsius / 10
        return(celsius)
    }

    trace(fahrenheit + " fahrenheit",fahrenheit2celsius(fahrenheit) + " celsius",)
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:07:05.557

为什么不这样：

```
function fahrenheit2celsius(fahrenheit):Number
{
    var celsius:Number = (5/9)*(fahrenheit-32);
    return Math.round(celsius); // <-- if you want to round to nearest int ?
} 
```

# php - AJAX 仅在数据库发生更改时更新 - Codeigniter

> ID：15537656
> 
> 赞同：1
> 
> 时间：2013-03-21T01:01:42.163
> 
> 标签：php, javascript, ajax, codeigniter

我试图仅在数据库中更新页面时更新页面，但我不确定如何执行此操作。

我正在考虑比较存储到数据库中的 id，因为每个 ID 都是唯一的，所以如果我制作某种表达式，将 AJAX 存储或获取的当前数组与数据库中的 id 进行比较。但我不确定如何比较 id 并检查它们是否是新更新

任何帮助，将不胜感激

控制器

```
public function insertJSON()
    {
        $this->load->model("values");
        $queryresults = $this->values->getDb();

        $id = array();
        $arr = array();
        $arr2 = array();

        foreach($queryresults as $row)
        {
            $id[] = $row->id;
            $arr[] =  $row->post;
            $arr2[] = $row->img;
        }

            $data = array();
            $data[] = $id
            $data[] = $arr;
            $data[] = $arr2;

            echo json_encode($data);
    } 
```

看法

```
 <script type='text/javascript' language='javascript'>
      $('#getdata').click(function () {
        $.ajax({
          url: '<?php echo base_url().'index.php/welcome/insertJSON';?>',
          async: false,
          type: "POST",
          success: function(data) {

            // thought i could do something like
                   if(data.change in database) do bla bla

            var id = data[0];
            var arr = data[1];
            var arr2 = data[2]

          }
        })
      });
    </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T04:57:27.220

有一个简单的方法可以做到这一点。创建一个会话变量并为其分配最后一个 id。比在页面上在隐藏输入上获取此会话 ID。现在，当您发送 ajax 请求时，您可以获取隐藏输入的值并将其发送到控制器函数，您可以在其中查询最后一个 id。如果查询中的最后一个 id 不等于会话 id，您应该回显其他明智的 echo 0。在 ajax 请求中检查响应是否来自控制器并且它大于 0 使用新 id 更改页面。比使用 ajax 更新会话 id

# java - 使用泛型将集合添加到 hashmap

> ID：15537665
> 
> 赞同：2
> 
> 时间：2013-03-21T01:02:17.860
> 
> 标签：java, generics

我收到了大量扩展我的对象的对象数组列表。我想将它们插入到哈希图中以便更快地引用。我决定创建一种方法来避免重复代码，因为它经常发生，只是为了好玩，我想更加花哨并使用泛型。我知道有几种方法可以做到这一点，但没有一种方法看起来很干净或漂亮；我想知道我是否缺少更简单的解决方案。所以我想做这样的事情......

```
private void addToMap(Collections<? extends myObject> collection, Map<String, ? extends myObject> map){

  for(MyObject myObject: collection){
    map.put(myObject.getName(), myObject);
  }
} 
```

该方法的约定将要求提供的集合存储与 map 相同的类。如果该方法抛出异常，我很好，如果有人打破该合同并尝试传入两个集合，该集合存储了 myObject 的不同实现，然后存储了映射。

上面的代码失败了，因为我不能将“myObject”放入期望“？扩展 MyObject”的集合中以鼓励类型安全。我只是投射它很好，但他们唯一知道如何投射它的方法涉及一些丑陋的反射步骤，而且看起来很复杂。我还可以创建某种内部类来为我提供更强大的泛型（强制收集和映射存储相同的类型），但这也感觉有点矫枉过正。

那么，是否有一种简单或漂亮的方式来以最直观的方式创建这种方法？我知道我可以完全抛弃泛型并从对象中转换所有内容，我只是想找出一种更优雅的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:07:57.660

听起来您想要以下内容：

```
private <T extends MyObject> void addToMap(
        Collection<T> collection,
        Map<String, ? super T> map
) {
    for (T myObject : collection) {
        map.put(myObject.getName(), myObject);
    }
} 
```

更多信息：

*   [泛型方法（Java 教程文章）](http://docs.oracle.com/javase/tutorial/extra/generics/methods.html)

*   [什么是PECS（Producer Extends Consumer Super）？](https://stackoverflow.com/questions/2723397/java-generics-what-is-pecs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T04:53:05.947

我认为这取决于。

***泛型***被设计并适用于一些场景，其中客户端代码和服务代码紧密收缩，用于强类型传输和评估。所以泛型在这种情况下***只是为我们提供了预编译时安全性*****，但是**当客户端代码对错误的类型进行愚蠢的转换并将它们输入到泛型集合时，它并不是绝对安全和方便的。正如我们所知，colleciton 在运行时会崩溃，但在编译时是可以的。

***泛型***在某些情况下是**不合适的，在这种情况下，****我们自己可以保证**我们添加到泛型集合中的一些对象是正确的，即使它们不能统一或强制转换为一个超类强类型。在这种情况下，我们可以通过使用原始类型集合或使用一些集合（如`List<Object>`. 这是正确的方法。 **我想你可能就是这种情况**。

# perl - 如何使用命令行获取whois信息？

> ID：15537666
> 
> 赞同：4
> 
> 时间：2013-03-21T01:02:21.720
> 
> 标签：perl, command-line, command

我的服务器上有一个大文本文件，其中包含我需要获取其联系信息的域列表。这是我在 stackoverflow.com 上运行 whois 时显示的一个示例：

```
root@server [~]# whois stackoverflow.com
[Querying whois.verisign-grs.com]
[Redirected to whois.name.com]
[Querying whois.name.com]
[whois.name.com]

__   _                             ____
| \ | | __ _ _ __ ___   ___       / ___|___  _ __ ___
|  \| |/ _` | '_ ` _ \ / _ \     | |   / _ \| '_ ` _ \
| |\  | (_| | | | | | |  __/  _  | |__| (_) | | | | | |
|_| \_|\__,_|_| |_| |_|\___| (_)  \____\___/|_| |_| |_|
      On a first name basis with the rest of the world.

Get your <a href="http://www.name.com">domains</a> at Name.com.

Domain Name:     stackoverflow.com
Registrar:       Name.com LLC

Expiration Date: 2015-12-26 19:18:07
Creation Date:   2003-12-26 19:18:07

Name Servers:
        ns1.serverfault.com
        ns2.serverfault.com
        ns3.serverfault.com
        ns4.serverfault.com

REGISTRANT CONTACT INFO
Stack Exchange, Inc.
Sysadmin Team
1 Exchange Plaza
Floor 26
New York
NY
10006
US
Phone:         +1.2122328280
Email Address: sysadmin-team@stackoverflow.com

ADMINISTRATIVE CONTACT INFO
Stack Exchange, Inc.
Sysadmin Team
1 Exchange Plaza
Floor 26
New York
NY
10006
US
Phone:         +1.2122328280
Email Address: sysadmin-team@stackoverflow.com

TECHNICAL CONTACT INFO
Stack Exchange, Inc.
Sysadmin Team
1 Exchange Plaza
Floor 26
New York
NY
10006
US
Phone:         +1.2122328280
Email Address: sysadmin-team@stackoverflow.com

BILLING CONTACT INFO
Stack Exchange, Inc.
Sysadmin Team
1 Exchange Plaza
Floor 26
New York
NY
10006
US
Phone:         +1.2122328280
Email Address: sysadmin-team@stackoverflow.com

Timestamp: 1363827248.6992

The Data in the Name.com LLC WHOIS database is provided by Name.com LLC for information purposes, and to assist persons in obtaining information about or related to a domain name registration record.  Name.com LLC does not guarantee its accuracy.  By submitting a WHOIS query, you agree that you will use this Data only for lawful purposes and that, under no circumstances will you use this Data to:  (1) allow, enable, or otherwise support the transmission of mass unsolicited, commercial advertising or solicitations via e-mail (spam); or (2) enable high volume, automated, electronic processes that apply to Name.com LLC (or its systems). Name.com LLC reserves the right to modify these terms at any time.  By submitting this query, you agree to abide by this policy.

Cached on: 2013-03-20T18:54:08-06:00 
```

我需要做的是从每个查询中提取某些信息。问题是我不明白如何仅从每个域 whois 中提取联系电子邮件，因为每个 whois 结果因注册商而异。

例如，这就是我希望它的工作方式：

通过命令行，我的服务器应该检查每个域名的 whois 信息，并将所有结果导出到一个新的文本文件，该文件只包含域名所有者的电子邮件地址。包含所有域的文件的名称是 domain.txt，如果可能的话，我希望将新文件命名为 new.txt。

对此的任何帮助将不胜感激。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:05:54.290

您首先应该[在 cpan 上搜索 whois](https://metacpan.org/search?q=whois)，然后选择不那么过时、最受关注和最相关的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-10T19:20:46.853

不一定是 Perl，但由于您是在命令行（可能是 linux）上执行此操作，因此您可以使用 shell 脚本执行以下操作。

```
cat domain.txt | while read line
do
echo "$line - `whois $line | grep \"@\"`" >> new.txt
done 
```

如果您的 domain.txt 文件如下所示：

```
stackoverflow.com 
```

然后你的 new.txt 看起来像：

```
stackoverflow.com - sysadmin-team@stackoverflow.com
stackoverflow.com - sysadmin-team@stackoverflow.com
stackoverflow.com - sysadmin-team@stackoverflow.com
stackoverflow.com - sysadmin-team@stackoverflow.com 
```

您可以添加一些 'sort' 和 'uniq' 命令来清理重复的值。如有必要，请告诉我，我会详细说明。

# java - 如何基于布尔表达式将对象添加到网格世界

> ID：15537668
> 
> 赞同：0
> 
> 时间：2013-03-21T01:02:26.167
> 
> 标签：java, object, boolean, gridworld

我正在尝试创建一个程序，如果这些位置是空的，则将另一个花对象放置到原始位置的东北南和西部，但我不明白如何向世界添加另一个对象。这是我的代码

```
import info.gridworld.actor.Flower;
import info.gridworld.grid.Location;

import java.util.ArrayList;

public class Weed extends Flower{

    static  boolean N;
    static  boolean E;
    static  boolean S;
    static  boolean W;
    static boolean done = true;
    static Location n; //new            Location(this.getLocation().getRow()-1,this.getLocation().getCol());
    static Location e; //= new Location(this.getLocation().getRow(),this.getLocation().getCol()+1);
    static Location s; //= new Location(this.getLocation().getRow()+1,this.getLocation().getCol());
    static Location w; //= new Location(this.getLocation().getRow(),this.getLocation().getCol()-1);

    public void act(){
        ArrayList<Location> EL = this.getGrid().getEmptyAdjacentLocations(getLocation());
        checkDirection(EL);

    }

    public void checkDirection(ArrayList<Location> el){
        n = new Location(this.getLocation().getRow()-1,this.getLocation().getCol());
        e = new Location(this.getLocation().getRow(),this.getLocation().getCol()+1);
        s = new Location(this.getLocation().getRow()+1,this.getLocation().getCol());
        w = new Location(this.getLocation().getRow(),this.getLocation().getCol()-1);

        for(int x=0; x<el.size(); x++){
            System.out.println("el"+el.get(x));
            if(el.get(x).equals(n)){
                N = false;
            }
            else if(!el.get(x).equals(n)){
                N = true;
            }

            else if(el.get(x).equals(e)){
                E = false;
            }
            else if(!el.get(x).equals(e)){
                E = true;
            }

            else if(el.get(x).equals(s)){
                S = false;
            }
            else if(!el.get(x).equals(s)){
                S = true;
            }

            else if(el.get(x).equals(w)){
                W = false;
            }
            else if(!el.get(x).equals(w)){
                W = true;
            }

        }
        if(N==false&&W==false&&E==false&&S==false) done = true;

        System.out.println(N); 
        System.out.println(E);
        System.out.println(S);
        System.out.println(W);

        System.out.println(n); 
        System.out.println(e);
        System.out.println(s);
        System.out.println(w);
    }

} 
```

* * *

```
import info.gridworld.actor.ActorWorld;
import info.gridworld.actor.Flower;
import info.gridworld.grid.Location;

public class WeedRunner extends Weed  {
    public static void main(String args[]){

        ActorWorld world = new ActorWorld();
        Weed we = new Weed();
        world.add(new Location (5,4), we);
        world.show();

        while(done == false){
            if(N==false)world.add(new Location(n.getRow(),n.getCol()),we);
            if(E==false)world.add(new Location(e.getRow(),e.getCol()),we);
            if(S==false)world.add(new Location(s.getRow(),s.getCol()),we);
            if(W==false)world.add(new Location(w.getRow(),w.getCol()),we);

        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:28:21.957

el.get(x).equals(n) 和 !el.get(x).equals(n) 是相反的布尔表达式。至少其中一个总是正确的 这意味着你的长长的 if-elseifs 列表将总是停在其中一个上。我不知道你认为你的代码在做什么，但我可以告诉你，E、S 和 W 的值永远不会改变它们的默认值。

# report - 一种关闭 canoo webtest 报告生成的方法

> ID：15537678
> 
> 赞同：0
> 
> 时间：2013-03-21T01:03:43.980
> 
> 标签：report, webtest, canoo, canoo-webtest

我正在针对一个包含 1000 多个测试的套件运行 canoo webtest。整个过程比我想要的要长一点。我的问题是：有没有办法完全关闭 html 报告生成？或者一种只为测试失败编写报告的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-08T14:24:27.570

迟到总比没有好...您可以关闭 html 报告生成。不幸的是，您不能只为失败生成 html 报告。

如果您编辑 webtest.xml，您可以将 wt.config.saveresponse 默认属性更改为 false。

```
<property name="wt.config.saveresponse" value="false"/> 
```

或者，我更喜欢将*wt.config.saveresponse=false*放在 canoo.properties 文件中，并通过使用将属性文件导入我的 canoo 测试目录的**build.xml中**

```
<property file="../canoo.properties" /> 
```

通过这种方式，很容易打开和关闭保存结果以调试问题。

问候， SazD

# regex - 如何消除上下文无关语法中的左递归？

> ID：15537683
> 
> 赞同：-1
> 
> 时间：2013-03-21T01:04:08.927
> 
> 标签：regex, parsing, context-free-grammar, recursive-descent

我将如何消除此 CFG 中的左递归？

```
<RE> -> <RE>'|'<CONCAT> | <CONCAT>
<CONCAT> -> <CONCAT><KLEEN> | <KLEEN>
<KLEEN> -> <KLEEN>'*' | <ELEM>
<ELEM> -> 'a' | 'b' | 'c' | 'd' | '('<RE>')' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:08:20.603

查看Wikipedia上有关[删除左递归](http://en.wikipedia.org/wiki/Left_recursion#Removing_left_recursion)的部分。

有一个关于如何做到这一点的描述，如下;

Moore, Robert C.（2000 年 5 月）。“从上下文无关语法中删除左递归”。第六届应用自然语言处理会议：249-255。[http://aclweb.org/anthology-new/A/A00/A00-2033.pdf](http://aclweb.org/anthology-new/A/A00/A00-2033.pdf)。

# freepascal - 我知道缓冲区中的 DWORD 模式的 IndexDWord 总是返回 False (FreePascal)

> ID：15537685
> 
> 赞同：2
> 
> 时间：2013-03-21T01:04:17.717
> 
> 标签：freepascal, lazarus

根据 Marco 在[这个线程](https://stackoverflow.com/questions/10018739/how-to-search-an-array-of-bytes-for-stringa)中的建议，我有一个原始字节数据缓冲区，4096 字节，从文件循环读取。

然后我想在该缓冲区中搜索一个已知的 4 个字节的十六进制字符串。我有以下代码可以编译，我知道缓冲区中有数据字节，包括我寻找的十六进制字符串，但 IndexDWord 总是返回 false (-1)，我不明白为什么。奇怪的“读取然后再次读取”行为是因为我需要两个单独的缓冲区——一个包含原始字节数据，一个包含字符数据。

```
var
 Buffer               : array [1..4096] of char;
 Buffer2              : array [1..4096] of byte;

 const BinaryMarker : DWord = ($54435054); // (instead of Hex, Hex, Hex, etc. It now compiles)

begin
// Code relating to opening the file etc....then
   BytesRead := SourceFile.Read(Buffer, SizeOf(Buffer));         // Read a buffer as an array of chars
   SourceFile.Position := SourceFile.Position - BytesRead;       // Go back to where you just were
   BinaryBytesRead := SourceFile.Read(Buffer2, SizeOf(Buffer2)); // And read it again as byte buffer

   J := IndexDWord(Buffer2, SizeOf(Buffer2), BinaryMarker);
   if J > 0 then  // this is never true, even though I know the byte hex pattern exists in the buffer
     ShowMessage('Found at offset ' + IntToStr(J));    
end; 
```

帮助！我正在使用 FPC 2.7.1 和 Lazarus 1.1。IndexDWord 的页面在[这里](http://community.freepascal.org/docs-html/rtl/system/indexdword.html)

# git - 如何告诉 Git 使用与“.gitignore”不同的 gitignore 文件？

> ID：15537686
> 
> 赞同：5
> 
> 时间：2013-03-21T01:04:27.710
> 
> 标签：git, gitignore

我可以告诉 Git Git 存储库在哪里`--git-dir`。我可以告诉 Git 工作树在哪里`--work-tree`。如何告诉 Git gitignore 文件在哪里？

问：我为什么要做这样的事情？

A. 对于一些工作树，我有两个不同的 Git 存储库。一是在标准位置`.git`。我用于正常版本控制的这个存储库。另一个存储库位于`.git.sync`. 我使用此存储库在计算机之间定期自动同步。即，这是我自己用 Git 和一个定期运行的小脚本实现的小 Dropbox 克隆。

理想情况下，我可以告诉 Git`.gitignore.sync`用于`.git.sync`存储库，而不是让 Git 使用`.gitignore`它用于正常版本控制的相同内容。

问：我为什么不直接使用 Dropbox？

A. 它不同步符号链接。糟糕的 Dropbox！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T01:29:15.303

您可以使用`core.excludesfile`来指定新的忽略文件。默认情况下，这只会影响当前存储库；`--global`如果要更改默认值，可以使用该选项。

```
git config core.excludesfile ".new_gitignore" 
```

**编辑 1**

AFAIK，`.gitignore`不能被*禁用*。它优先于`.git/info/excludes`and `core.excludesfile`。我能想到的唯一方法是使用过滤器进行一些黑客攻击。[这个答案](https://stackoverflow.com/a/2316728/326543)很好地解释了过滤器的使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-04-03T13:48:16.890

在大多数命令中，“.gitignore”似乎被硬编码为 git 中的每个目录的排除文件，优先于所有其他忽略文件。

但是，我为 Git 创建了一个小补丁来克服这个限制：[https ://gist.github.com/rev22/9954517](https://gist.github.com/rev22/9954517)

它添加了以下配置选项：

**core.ignoreperdir**：指定 '.gitignore' 的替代品作为每个目录的排除文件。如果未设置，则使用默认的“.gitignore”。如果为空，则不使用每个目录的排除文件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T01:29:30.583

每个存储库都有一个`info/exclude`文件 - 应该有一个 in`.git/info/exclude`和 in `.git.sync/info/exclude`。像您一样填充这些排除文件`.gitignore`。

# javascript - 骨干 js 没有使用 fetch() 用数据填充模型

> ID：15537687
> 
> 赞同：0
> 
> 时间：2013-03-21T01:04:27.957
> 
> 标签：javascript, jquery, backbone.js

我正在使用 Backbone.js 并尝试使用 fetch() 填充我的模型。我遇到的问题是返回的数据没有填充我的模型。我在[这里](https://stackoverflow.com/questions/10768595/backbone-js-and-populating-a-model-with-data-using-fetch)发现了一个类似的问题。不同之处在于，在我的成功函数内部，我没有看到任何数据更改，也没有触发“更改”事件。

编码：

**模型**

```
window.Company = Backbone.Model.extend({
    urlRoot: "/api/company",
    defaults:{
        "id":null,
        "name":"",
        "address":"",
        "city":"",
        "state":"",
        "phone":""
    },
    events: {
        'change': 'doChange'
    },

    doChange: function(event) {
        alert('company changed');
    }
}) 
```

**路由器**

```
var AppRouter = Backbone.Router.extend({

    routes:{
        "":"home",
        "company/:id":"companyDetails"
    },

    initialize:function () {
        var user = new User();
        this.headerView = new HeaderView({
            model: user
        });
        $('.header').html(this.headerView.el);
        console.log("router initialized.");
    },

    companyDetails: function (id) {
        var company = new Company({
            id: id
        });
        company.fetch({
            success: function(){
                console.log('company.id is ' + company.id);
                console.log('company.name is ' + company.name);
                console.log('company.address is ' + company.address);
                $("#content").html(new CompanyView({
                    model: company
                }).el);
            }
        });
}

}); 
```

**JSON**

```
{"address":"555 Main St","name":"Confused Technologies","id":"8dc206cc-1524-4623-a6cd-97c185a76392","state":"CO","city":"Denver","zip":"80206","phone":"5551212"} 
```

名称和地址始终未定义。我必须忽略一些简单的东西？？？

**编辑**

包括错误地忽略了将模型传递给模板的视图。

**看法**

```
window.CompanyView = Backbone.View.extend({

    initialize:function () {
        this.render();
        console.log('CompanyView initialized');
    },

    render:function (eventName) {
        $(this.el).html(this.template());
        return this;
    }

}) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T02:44:14.243

属性不直接存储在模型上。它们存储在[属性 hash](http://backbonejs.org/#Model-attributes)中，因此您可以通过 访问它们`company.attributes`，尽管`company.get(attribute)`这是通常的方式。同样，您将传递`company.toJSON()`给您的模板函数，因为它返回模型属性的克隆散列。

至于您的更改事件未触发，我假设您的意思是`change: doChange`模型的事件哈希中的。骨干模型实际上并没有对事件哈希做任何事情。这是为了在 Backbone Views 上委派 DOM 事件。我敢打赌，如果您`company.on("change", function (model) { console.log(model.toJSON()); })`在 fetch 调用之前放置并删除了成功回调，您会在控制台中看到您的模型。

另外，我认为您的`$("#content").html...`生产线不会像您期望的那样工作。我会像这样重写你的路由器回调：

```
companyDetails: function (id) {
  var company = new CompanyView({
    el: "#content", 
    model: new Company({ id: id })
  });

  // This line would be better in your view's initialize, replacing company with this.
  company.listenTo(company.model, "change", company.render);

  company.model.fetch();
} 
```

CompanyView#render 通常会传递`this.model.toJSON()`给返回 html 的模板函数，并将其传递给`this.$el.html()`. 所以像`this.$el.html(this.template(this.model.toJSON()));`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T16:18:57.253

好的。据我所知，不更新模型的问题是异步问题。我更新了成功回调以包含数据参数，如下所示：

```
success: function (data) {
    $('#content').html(new CompanyView({
        model: data
    }).el);
} 
```

请注意，我没有将公司对象作为模型传递，而是原始返回数据。这解决了我的模型问题。

我在评论中提到，这始于我的下划线模板变量 `<%= name %>' 等...为空。我改变了看法：

```
window.CompanyView = Backbone.View.extend({

    initialize:function () {
        this.render();
        console.log('CompanyView initialized');
    },

    render:function (eventName) {
        $(this.el).html(this.template(this.model.toJSON()));
        return this;
    }

}) 
```

这些东西让我的模型更新了，变量也传播到了模板。

# sql-server - 无法更新列窗口函数错误

> ID：15537688
> 
> 赞同：0
> 
> 时间：2013-03-21T01:04:28.520
> 
> 标签：sql-server, sql-server-2008

假设我之前声明了一个名为 #temp 的表，它的值是 NULL，后来我想在我的脚本中更新该列，我该怎么做？

```
count --- CAM 

 1        201 
 1        2
 1        2012
 2        20 
```

我有更新声明，它将是：

更新#temp set [count]= ((ROW_NUMBER() over(order by CAM desc)-1/3)+1

但是，它给了我以下错误：窗口函数只能出现在 SELECT 或 ORDER BY 子句中。

我使用 select 语句尝试了许多不同的方法，但没有运气！对此有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:10:50.473

如果我了解您想要做什么，尽管`count`考虑到它似乎包含的数据，这里的列名有点奇怪：

```
WITH cte AS
(
    SELECT (row_number() OVER(ORDER BY CAM DESC) - 1)/3 + 1 AS [count],
        CAM
    FROM #temp
)
UPDATE #temp
SET #temp.[count] = cte.[count]
FROM #temp
INNER JOIN cte ON #temp.CAM = cte.CAM 
```

请注意，我还删除`/3`了括号的外部 - 我相信这就是您的意图。

只要`CAM`是唯一的，这将起作用。

# php - 在动态创建的选择菜单上运行 js 函数

> ID：15537696
> 
> 赞同：1
> 
> 时间：2013-03-21T01:05:31.337
> 
> 标签：php, javascript, mysql

我有这个代码：

这是 addOptions 函数

```
<script>
var values = <?php
$sql="SELECT * FROM billing_sagenominalcodes order by code ASC";
$rs=mysql_query($sql,$conn) or die(mysql_error());
$nominalcodes = array();
while($result=mysql_fetch_assoc($rs))
{
    $nominalcodes[] = $result['code'];
}
echo json_encode($nominalcodes);
?>;
var names = <?php
$sql="SELECT * FROM billing_sagenominalcodes order by code ASC";
$rs=mysql_query($sql,$conn) or die(mysql_error());
$nominalcodesname = array();
while($result=mysql_fetch_assoc($rs))
{
    $nominalcodesname[] = $result['code'] . ' - ' . $result['name'];
}
echo json_encode($nominalcodesname);
?>;
function addOptions(select, values)
{
    for (var i=0, iLen=values.length; i<iLen; i++)
    {
        select.appendChild(new Option(names[i],values[i]));
     }
}
</script> 
```

然后添加行功能

```
<script language="javascript" type="text/javascript">
var i=1;
function addRow()
{
          var tbl = document.getElementById('table1');
          var lastRow = tbl.rows.length;
          var iteration = lastRow - 1;
          var row = tbl.insertRow(lastRow);

          var sagenominalcodeCell = row.insertCell(3);
          var elSageNominalCode = document.createElement('select');
          elSageNominalCode.type = 'select';
          elSageNominalCode.name = 'sagenominalcode' + i;
          elSageNominalCode.id = 'sagenominalcode' + i;
          sagenominalcodeCell.appendChild(elSageNominalCode);
 i++;
 }
 </script> 
```

然后是 HTML

```
<select name="sagenominalcode" id="sagenominalcode">
        <script>addOptions(document.getElementById('sagenominalcode'), values);</script>
        </select>
            <input type="button" value="Add" onclick="addRow();" /> 
```

它可以添加新行，但没有使用 addOptions 函数填充选择菜单。

一旦动态创建了新的行/选择菜单，是否有任何方法让它运行该函数，然后在调用 addRow 函数时创建的所有其他菜单都相同？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:21:30.877

所以，多读一点你的代码，我看到你有

```
new Option(names[i],values[i]) 
```

我的问题是`new Option`返回什么？我在您的问题中的任何地方都没有看到它的代码。查看 appendChild 的规范： [https ://developer.mozilla.org/en-US/docs/DOM/Node.appendChild](https://developer.mozilla.org/en-US/docs/DOM/Node.appendChild)

它需要`element`传入。您要做的是使用如下`createElement()`函数创建一个新元素：

```
var option = document.createElement("option"); 
```

然后将内部 html 编辑为您需要的内容，如下所示：

option.innerHTML = "你的选项内容在这里";

然后将元素传递给 append 子函数：

appendChild（选项）；

~~在这里使用 jQuery 而不是直接的 js。我敢打赌，您的点击监听器仅绑定到页面创建时出现的项目。如果您通过 jQuery 设置侦听器，那么它甚至会在动态添加的组件上触发。~~

同样从代码结构的角度来看，用 php 编写 js 时要非常小心。尽管听起来很有趣（就像在高中吸毒一样），但它是危险的、令人沮丧的，并且会导致无法测试的代码（就像在高中吸毒一样）。

# php - 如何在 Symfony2 中重新启动会话

> ID：15537701
> 
> 赞同：2
> 
> 时间：2013-03-21T01:06:23.367
> 
> 标签：php, session, symfony

当用户点击任何地方时，如何重新启动会话？我创建了一个请求侦听器：

```
public function onKernelRequest(GetResponseEvent $event)
    {
        $session = new Session();
        $session->start();
        //$event->getRequest()->getSession()->start();
    } 
```

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T02:18:37.383

正常工作。

```
public function onKernelRequest(GetResponseEvent $event)
{
    $event->getRequest()->getSession()->migrate();
} 
```

谢谢。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T01:38:00.910

我想你实际上是在追求：

```
$session->invalidate(); 
```

正确的？

# z3 - Z3 中位向量的成员

> ID：15537704
> 
> 赞同：2
> 
> 时间：2013-03-21T01:06:33.943
> 
> 标签：z3, bitvector

我需要知道如何在 z3 中执行以下操作：

forall x 在 L4 中。x < l2

forall x 在 L0 中，forall y 在 L1 中。x < y

```
(declare-const L4 (_ BitVec 6))
(declare-const L1 (_ BitVec 6))
(declare-const L0 (_ BitVec 6))
(declare-const l2 Int)
(declare-const l1 Int) 
```

断言 L0 和 L1 使得 x < y

```
(check-sat) 
```

结果是星期六

断言 L0 和 L1 使得 y < x

```
(check-sat) 
```

结果是未饱和

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-25T23:06:48.213

我假设您正在使用位向量来编码有限集。因此，这是一种可能的编码（也可以[在此处](http://rise4fun.com/Z3/DjHE)在线获得）：

```
;; You use bit-vectors of size 6\. That is, we are encoding sets that are subsets of {0, 1, 2, ... 5}
(declare-const L4 (_ BitVec 6))
(declare-const L1 (_ BitVec 6))
(declare-const L0 (_ BitVec 6))
;; I will also encode l1 and l2 as Bit-Vectors.
;; Thus, I don't need to convert them into Bit-vectors to be able to use them in Bit-vector operations.
(declare-const l1 (_ BitVec 6))
(declare-const l2 (_ BitVec 6))
;; To make the problems more interesting let us assume that l1 and l2 are <= 5
(assert (bvsle l1 (_ bv5 6)))
(assert (bvsle l2 (_ bv5 6)))

;; All is encoding the set that contains {0, 1, 2, 3, 4, 5}
(define-const All (_ BitVec 6) #b111111) 
;; Empty is encoding the empty set
(define-const Empty (_ BitVec 6) #b000000) 

(define-fun LT_l ((S (_ BitVec 6)) (l (_ BitVec 6))) Bool
    ;; True if for all x in S x < l
    ;; Note that: All << l is the set of values greater than l
    ;; In SMT-LIB, bvshl is the left shift operator <<  
    (= (bvand (bvshl All l) S) Empty))

;; We can use shifting to encode the set that contains all values in {0, 1, 2, 3, 4, 5} that greater than or equal to l2
(define-const GE_l2 (_ BitVec 6) (bvshl All l2))
;; To assert that forall x in L4\. x < l2, we assert that the intersection of L4 and GE_l2 is empty 
(assert (= (bvand GE_l2 L4) Empty))

(check-sat)
(get-model) 

(define-fun is_in ((e (_ BitVec 6)) (S (_ BitVec 6))) Bool
   ;; True if e is an element of the "set" S.
   ;; That is, it checks whether the (1 << e) && S is 0
   (not (= (bvand (bvshl (_ bv1 6) e) S) Empty))) 

(echo "is_in tests")
;; Test: is 2 in the set {0,3}
(simplify (is_in (_ bv2 6) #b001001))
;; Test: is 0 in the set {0, 3}
(simplify (is_in (_ bv0 6) #b001001))
;; Test: is 3 in the set {0, 3}
(simplify (is_in (_ bv3 6) #b001001))
;; Test: is 4 in the set {0, 3}
(simplify (is_in (_ bv4 6) #b001001))
(echo "end is_in tests")

(define-fun is_minimal ((e (_ BitVec 6)) (S (_ BitVec 6))) Bool
    ;; True if e is the minimal element of S
    (and (is_in e S) ;; S contains e
         ;; (1 << e) - 1 represents the set of elements that are smaller than e
         (= (bvand (bvsub (bvshl (_ bv1 6) e) (_ bv1 6)) S) Empty))) 

(echo "is_minimal tests")
;; is 2 the minimal element in {5, 3}
(simplify (is_minimal (_ bv2 6) #b101000))
;; is 3 the minimal element in {5, 3}
(simplify (is_minimal (_ bv3 6) #b101000))
;; is 4 the minimal element in {5, 3}
(simplify (is_minimal (_ bv4 6) #b101000))
;; is 0 the minimal element in {4, 0}
(simplify (is_minimal (_ bv0 6) #b010001))
;; is 4 the minimal element in {4, 0}
(simplify (is_minimal (_ bv4 6) #b010001))
(echo "end is_minimal tests")

;; To encode that forall x in L0 and forall y in L1\. x < y
(define-fun LT ((L0 (_ BitVec 6)) (L1 (_ BitVec 6))) Bool
    ; True if forall x in L0 and forall y in L1, x < y
    ; We encode that by saying that 
    ;    - L0 is empty OR
    ;    - L1 is empty OR
    ;    - Or Let min be the minimal value of L1 and Forall x in L0, x < min
    (or (= L0 Empty)
        (= L1 Empty)
        (exists ((min (_ BitVec 6))) (and (is_minimal min L1) (LT_l L0 min)))))

;; To make the problem non-trivial, let us assume that L0 and L1 are not empty
(assert (not (= L0 Empty)))
(assert (not (= L1 Empty)))
(assert (LT L0 L1))
(check-sat)
(get-model)
(assert (LT L1 L0))
(check-sat) 
```

# c# - C#文件在制作后被锁定

> ID：15537705
> 
> 赞同：0
> 
> 时间：2013-03-21T01:06:37.533
> 
> 标签：c#, file, filestream, streamwriter, filelock

我正在制作一个 Windows 服务，其中一部分是使用 FileStream 和 StreamWriter 制作一个 .eml/txt 文件，它运行良好，可以完成我需要它做的所有事情。唯一的问题是它生成的新文件由于某种原因之后仍然被服务使用，我不知道为什么。有什么线索吗？修复？

我认为它必须与 FileStream 和 StreamWriter 有关，因为它们是唯一接触新文件的东西。提前致谢！

服务1.cs

```
 public partial class emlService : ServiceBase
{
    Boolean _isRunning;

    public emlService()
    {
        InitializeComponent();
        if (!System.Diagnostics.EventLog.SourceExists("emlServiceSource"))
        {
            System.Diagnostics.EventLog.CreateEventSource(
                "emlServiceSource", "emlServiceLog");
        }
        eventLog1.Source = "emlSerivceSource";
        eventLog1.Log = "emlServiceLog";
    }

    protected override void OnStart(string[] args)
    {
        eventLog1.WriteEntry("In OnStart");
        Thread NewThread = new Thread(new ThreadStart(runProc));
        _isRunning = true;
        //Creates bool to start thread loop
        if (_isRunning)
        {
            NewThread.Start();
        }
    }

    protected override void OnStop()
    {
        eventLog1.WriteEntry("In OnStop");
        _isRunning = false;             
    }

    protected override void OnContinue()
    {

    }

    public void runProc()
    {         

        //Directory of the drop location
        DirectoryInfo drop = new DirectoryInfo(@"C:\inetpub\mailroot\drop");

        //Directory of the pickup location
        string destpath = @"C:\inetpub\mailroot\pickup\";

        //Inits ParserCommands and DropDirectory object
        ParserCommands parserObject = new ParserCommands();

        //Inits array to hold number of messages in drop location
        FileInfo[] listfiles;

        //Inits CFG
        string conf_mailsender = ConfigurationSettings.AppSettings["conf_mailsender"];
        string conf_rcpt = ConfigurationSettings.AppSettings["conf_rcpt"];
        string conf_username_and_password = ConfigurationSettings.AppSettings["conf_username_and_password"];
        string conf_sender = ConfigurationSettings.AppSettings["conf_sender"];
        string conf_raport = ConfigurationSettings.AppSettings["conf_raport"];

        //Loop that never ends
        while (true) 
        {
            Thread.Sleep(1000);
            //Checks if there is a message waiting to be processed and begins processing if so
            listfiles = drop.GetFiles();
            if (listfiles.Length >= 1)
            {
                for (int j = 0; j <= (listfiles.Length - 1); j++)
                {
                    //Gives it time to breathe
                    Thread.Sleep(250);

                    //Gets each line of the original .eml into a string array
                    try
                    {

                        //reader.

                        var lines = File.ReadAllLines(listfiles[j].FullName);
                        string[] linestring = lines.Select(c => c.ToString()).ToArray();

                        //Opens up steam and writer in the new dest, creates new .eml file
                        FileStream fs = new FileStream(destpath + listfiles[j].Name, FileMode.CreateNew);
                        StreamWriter writer = new StreamWriter(fs);

                        //Writes all .eml content into buffer
                        writer.WriteLine("x-sender: " + conf_mailsender);
                        writer.WriteLine("x-receiver: " + conf_rcpt);
                        writer.WriteLine(linestring[2]);
                        writer.WriteLine(linestring[3]);
                        writer.WriteLine(linestring[4]);
                        writer.WriteLine(linestring[5]);
                        writer.WriteLine(linestring[6]);
                        writer.WriteLine(linestring[7]);
                        writer.WriteLine(linestring[8]);
                        writer.WriteLine("From: " + conf_mailsender);
                        writer.WriteLine(linestring[10]);
                        writer.WriteLine("Reply-To: " + conf_mailsender);
                        writer.WriteLine("To: " + conf_rcpt);
                        writer.WriteLine("Subject: " + conf_username_and_password);
                        writer.WriteLine("Return-Path: " + conf_mailsender);
                        writer.WriteLine(linestring[15]);
                        writer.WriteLine();

                        //Seperates start of email from the rest and decode parameter_content
                        string parameter_to = parserObject.getReciever(linestring[12]);
                        string parameter_content = parserObject.DecodeFrom64(linestring[17]);

                        //Creates string ready for base64 encode
                        string encode = "from=" + conf_sender + "&to=" + parameter_to + "&raport=" + conf_raport + "&message=" + parameter_content;

                        //Writes encoded string into buffer
                        writer.WriteLine(parserObject.EncodeTo64(encode));

                        //Writes buffer into .eml file
                        writer.Flush();
                        fs.Flush();

                        fs = null;
                        writer = null;
                        lines = null;
                    }
                        catch (System.IO.IOException e)
                    {
                        Console.WriteLine("no");

                    }

                    //Deletes the file
                    File.Delete(listfiles[j].FullName);
                }

                //Sets the number of files needing sent to 0
                listfiles = null;
            }
        }
    }
} 
```

程序.cs

```
static class Program
{
    /// <summary>
    /// The main entry point for the application.
    /// </summary>
    static void Main()
    {           
        //Starts the Service
        System.ServiceProcess.ServiceBase[] ServicesToRun;
        ServicesToRun = new System.ServiceProcess.ServiceBase[]
            { new emlService() };
        System.ServiceProcess.ServiceBase.Run(ServicesToRun);
    }
}

public class ParserCommands
{
    /// <summary>
    /// Seperates the address before @ from an email address
    /// </summary>
    /// <param name="email"> the email to be split </param>
    /// <returns> everything before @ on an email address </returns>
    public string getReciever(string email)
    {
        string[] Split = email.Split(new Char[] { '@' });
        string Split2 = Split[0];
        char[] chars = { 'T', 'o', ':', ' ' };
        string FinalSplit = Split2.TrimStart(chars);

        return FinalSplit;

    }

    /// <summary>
    /// Decodes base64 into string
    /// </summary>
    /// <param name="encodedData"> the base64 encoded data</param>
    /// <returns>decoded data as string</returns>
    public string DecodeFrom64(string encodedData)
    {
        //Turns into bytes and then turns bytes into string
        byte[] encodedDataAsBytes = System.Convert.FromBase64String(encodedData);
        string returnValue = System.Text.Encoding.UTF8.GetString(encodedDataAsBytes);

        return returnValue;
    }

    /// <summary>
    /// Decodes base64 data
    /// </summary>
    /// <param name="toEncode"> data that nees to be decoded</param>
    /// <returns> encoded data as string</returns>
    public string EncodeTo64(string toEncode)
    {
        //Turns string into bytes and then encodes it
        byte[] toEncodeAsBytes = System.Text.Encoding.UTF8.GetBytes(toEncode);
        string returnValue = System.Convert.ToBase64String(toEncodeAsBytes);

        return returnValue;
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T01:10:55.067

`FileStream`和`StreamWriter`are `IDisposable`，因此您应该将它们包装在`using`语句中，以确保在您完成它们时将它们关闭。

```
using (FileStream fs = new FileStream(destpath + listfiles[j].Name, FileMode.CreateNew))
using (StreamWriter writer = new StreamWriter(fs)) {
   // .. your writing code here
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-21T01:11:09.203

从[StreamWriter](http://msdn.microsoft.com/en-us/library/system.io.streamwriter.aspx)文档：

> 一个好的做法是在 using 语句中使用这些对象，以便正确处置非托管资源。当使用它的代码完成时，using 语句会自动调用对象上的 Dispose。

它们是 IDisposable ，因此应该包含在[using 中](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)。Dispose 也应该调用 close。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-21T01:09:57.540

你有没有在写完东西后关闭文件流？

# postgresql - :: 在 PostgreSQL 中做什么？

> ID：15537709
> 
> 赞同：92
> 
> 时间：2013-03-21T01:06:58.283
> 
> 标签：postgresql, syntax, types, casting, typecast-operator

我`::`在网上看到过很多涉及 postgres 代码的地方。例如：

```
SELECT '{apple,cherry apple, avocado}'::text[]; 
```

这似乎是某种演员。postgres 中到底有什么，什么`::`时候应该使用它？

我尝试了一些谷歌搜索并搜索了 Postgres 文档，`::`但没有得到好的结果。
我尝试在 Google 中进行以下搜索：

*   postgres 双冒号
*   postgres ::
*   ::

我在 postgres 文档搜索按钮中尝试了以下搜索

*   双冒号
*   双结肠管型
*   ::

在 SO 上问这个问题几乎令人尴尬，但我认为 Google 将来有望为其他人看到这个答案。

* * *

## 回答 #1

> 赞同：94
> 
> 时间：2013-03-21T01:12:33.297

类型转换指定从一种数据类型到另一种数据类型的转换。

PostgreSQL 接受两种等效的类型转换语法，即 PostgreSQL-specific`value::type`和 SQL-standard `CAST(value AS type)`。

在这种特定情况下，`'{apple,cherry apple, avocado}'::text[];`获取字符串文字`{apple,cherry apple, avocado}`并告诉 PostgreSQL 将其解释*为`text`*.

有关详细信息，请参阅有关[SQL 表达式](http://www.postgresql.org/docs/current/static/sql-expressions.html)和[数组](http://www.postgresql.org/docs/current/static/arrays.html)的文档。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-21T01:57:29.010

[@PSR 和 @Craig 写了什么](https://stackoverflow.com/a/15537761/939860)。
另外，还有*两种语法变体*：

1.`type value`

这种形式只转换常量（字符串文字）。像：

```
SELECT date '2013-03-21'; 
```

更多在手册中的[**其他类型的常量**](https://www.postgresql.org/docs/current/sql-syntax-lexical.html#SQL-SYNTAX-CONSTANTS-GENERIC)一章中。

2.`type(value)`

这就是类似函数的语法。仅适用于名称作为函数名称有效的类型。像：

```
SELECT date(date_as_text_col) FROM tbl; 
```

更多内容请参见[**Type Casts**](https://www.postgresql.org/docs/current/sql-expressions.html#SQL-SYNTAX-TYPE-CASTS)一章的手册。

**更全面的答案：**

*   [Postgres 数据类型转换](https://stackoverflow.com/questions/13676816/postgres-data-type-cast/13676871#13676871)

# c# - C# 正确的方法来关闭多个 Excel 对象并破坏 Excel 进程

> ID：15537713
> 
> 赞同：4
> 
> 时间：2013-03-21T01:07:32.090
> 
> 标签：c#, excel, com, excel-interop

我有一个 C# 控制台程序。当它运行时，它会实例化一些 Excel 对象，例如：(openExcelO)。

程序运行完毕后，我有一个关闭 Excel 的方法（closeExcel），它应该可以正确清理 Excel 进程。在任务管理器中，我可以看到剩余的 Excel 残余。关闭程序是从互联网示例中拼凑而成的：

```
 private void openExcelO (string dir) {

        try {
            xlApp = new Excel.Application();
            xlWorkBook = xlApp.Workbooks.Open(dir + "PortfolioOptimization5.xlsm",
                0, false, 5, "", "", true, 
                Microsoft.Office.Interop.Excel.XlPlatform.xlWindows, 
                "\t", false, false, 0, true, 1, 0);
            xlMarkowitz = (Excel.Worksheet)xlWorkBook.Sheets["Markowitz"];
            xlWeights = (Excel.Worksheet)xlWorkBook.Sheets["Weights"];

        } catch (Exception ex) {
            ReportError("PortfolioOptimization", "openExcel", ex.ToString());
        }

    }

    private void closeExcel () {
        object misValue = System.Reflection.Missing.Value;
        try {

            if (xlWeights != null) releaseObject(xlWeights);
            if (xlMarkowitz != null) releaseObject(xlMarkowitz);

            xlWorkBook.Close(false, misValue, misValue);
            if (xlApp != null) xlApp.Quit();

            if (xlWorkBook != null) releaseObject(xlWorkBook);
            if (xlApp != null) releaseObject(xlApp);

        } catch (Exception ex) {
            ReportError("PortfolioOptimization", "closeExcel", ex.ToString());
        }
    }

    private void releaseObject (object obj) {
        try {
            System.Runtime.InteropServices.Marshal.ReleaseComObject(obj);
            obj = null;
        } catch (Exception ex) {
            obj = null;
            ReportError("PortfolioOptimization", "releaseObject", "Unable to release object " + ex.ToString());
        } finally {
            GC.Collect();
        }
    } 
```

如何更改关闭例程以正确关闭和清理 Excel 对象，以便任务管理器中没有延迟的 Excel 进程？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-21T01:26:20.257

看起来您没有以正确的顺序释放对象 -`xlApp.Quit`可能无法干净地退出，因为您仍然持有对工作簿的引用。您需要在调用*之前*`Quit`释放工作簿：

```
xlWorkBook.Close(false, misValue, misValue);
releaseObject(xlWorkBook);

xlApp.Quit();
releaseObject(xlApp); 
```

信用必须[归功于这个 StackOverflow 答案](https://stackoverflow.com/a/158752/622391)：还有一些其他的隐式引用你没有关闭，即在以下几行中：

```
xlWorkBook = xlApp.Workbooks.Open(...)
xlWorkBook.Sheets["Markowitz"]; 
```

“Workbooks”对象没有被释放，“Sheets”对象也没有被释放。您还需要发布这些引用，即：

```
var books = xlApp.Workbooks;
books.Open(...);
releaseObject(books);

var sheets = xlWorkBook.Sheets;
xlMarkowitz = (Excel.Worksheet)sheets["Markowitz"];
xlWeights = (Excel.Worksheet)sheets["Weights"];
releaseObject(sheets); 
```

[Bruce Barker](http://www.velocityreviews.com/forums/showpost.php?p=528575)的好建议：“永远不要在 COM 对象中使用两个点”！

# c# - 将 byte[] 转换为 HttpWebResponse

> ID：15537717
> 
> 赞同：0
> 
> 时间：2013-03-21T01:08:11.047
> 
> 标签：c#, .net, sockets, tcp, httpwebresponse

我在原始套接字上编写 tcp worker，它只是与服务器交换 http 流量。不幸的是，使用原始套接字是强制性的。到目前为止，输出中有一个 byte[] 数组，看起来是这样的：

```
HTTP/1.1 200 OK
Cache-Control: private, max-age=0
Content-Type: text/html; charset=utf-8
Date: Thu, 21 Mar 2013 00:58:11 GMT
Transfer-Encoding:  chunked
Connection: keep-alive
Connection: Transfer-Encoding

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html lang="en" xml:lang="en" 
xmlns="http://www.w3.org
... 
```

等等。问题是 - 我可以以某种方式将此 byte[] 数组（或其字符串表示形式，或任何其他形式）转换为 HttpWebResponse 吗？或者也许有一种方法可以将套接字作为流传递给 WebResponse？

渴望任何答案，多拉

# javascript - UIWebView 检索链接并导航到它

> ID：15537721
> 
> 赞同：2
> 
> 时间：2013-03-21T01:08:43.427
> 
> 标签：javascript, ios, objective-c, uiwebview, nsregularexpression

我正在向`UIWebView`我的应用程序添加一个应该加载受密码保护的网页的应用程序。然后它应该自动从该页面中选择一个链接并导航到该页面。该网站不断更改其链接，因此无法选择目标页面的 URL。我需要先登录，然后从主页中选择一个链接。

登录后如何编写代码来搜索我的主页并导航到所需的链接？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T02:24:31.140

您可以使用 Javascript 通过其 id 检索链接，然后加载它：

```
[yourWebView stringByEvaluatingJavaScriptFromString:@"document.getElementById('yourLinkID').click();"]; 
```

要查找链接的 id 是什么，请检查页面上的 html 标记以获取 id 属性的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:12:32.560

我认为[正则表达式](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSRegularExpression_Class/Reference/Reference.html)会有所帮助。

```
//NSError will handle errors
NSError *error;
//Create URL for you page. http://example.com/index.php just an example
NSURL *pageURL = [NSURL URLWithString:@"http://example.com/index.php"];
//Retrive page code to parse it using regex
NSString *pageHtml = [NSString stringWithContentsOfURL:pageURL           
                                              encoding:NSUTF8StringEncoding 
                                                 error:&error];
if (error)
{
    NSLog(@"Error during retrieving page HTML: %@", error);
    //Will terminate your app
    abort();
    //TODO: handle connection error here
}
error = nil;
//Creating regex to parsing page html
//Information about regex patters you can easily find.
NSRegularExpression *regex = [[NSRegularExpression alloc] initWithPattern:@"<a[^>]*href=\"([^\"]*)\"[^>]*>mylink</a>"
                                                                  options:NSRegularExpressionCaseInsensitive
                                                                    error:&error];
if (error)
{
    NSLog(@"Error during creating regex: %@", error);
    //Will terminate your app
    abort();
    //TODO: handle regex error here
}
//Retrieving first match of our regex to extract first group
NSTextCheckingResult *match = [regex firstMatchInString:pageHtml
                                                options:0
                                                  range:NSMakeRange(0, [pageHtml length])];
NSString *pageUrl = [pageHtml substringWithRange:[match rangeAtIndex:1]];
NSLog(@"Page URL = %@", pageUrl);
[webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:pageUrl]]]; 
```

如果您`UIWebView`已经下载了带有 HTML 的页面，您可以替换

```
NSURL *pageURL = [NSURL URLWithString:@"http://example.com/index.php"];
NSString *pageHtml = [NSString stringWithContentsOfURL:pageURL encoding:NSUTF8StringEncoding error:&error]; 
```

有了这个：

```
NSString *pageHtml = [webview stringByEvaluatingJavaScriptFromString:@"document.body.innerHTML"]; 
```

# graphics - uv.zw 在 HLSL 中是什么意思？

> ID：15537725
> 
> 赞同：0
> 
> 时间：2013-03-21T01:09:01.783
> 
> 标签：graphics, 3d, shader, hlsl

我正在尝试使用 HLSL 代码作为实验的基础，但我不明白 uv.zw 代表什么？表明：

```
float4 uv0      : TEXCOORD0
...
uv0.zw; 
```

紫外线不是只有2吗？我知道 uvw 支持 3 但第四个组件是什么？Α？

在网上的例子中，我只能找到`TEXCOORD0`used for `float2`values，而不是`float4`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T05:13:47.817

纹理可以是 3D 的，因此纹理坐标可以有第三维，z。

如果您熟悉齐次坐标，您就会知道在 3D 坐标上表示各种变换的一种方法是通过齐次坐标进行 4D，它添加了一个“w”坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T05:23:49.087

GPU中的所有值实际上都是float4的幕后——声明float或float2等只是限制了使用的通道数。

如果 float2 值访问 .zw 通道，它在技术上是未定义的，但编译器可能会接受它。所以要小心。

在 HLSL 中，名称“uv”没有内在定义——您可以使用该名称声明任何类型的变量。

# c - 结构员工 {...} em1,em2; 或 struct EMPLOYEE {...};

> ID：15537726
> 
> 赞同：2
> 
> 时间：2013-03-21T01:09:02.707
> 
> 标签：c, struct

这两个是一样的吗？

```
struct EMPLOYEE {
...
};

int main (void)
{
    //Local Declaration
    struct EMPLOYEE em1;
    struct EMPLOYEE em2;
    ...

    return 0;
} 
```

和

```
struct EMPLOYEE {
...
}em1,em2; 
```

如果我使用后一种情况，我是否不需要像前一种情况那样在主函数中声明这些结构？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:12:05.213

```
struct EMPLOYEE {
...
}; 
```

定义了一个名为 EMPLOYEE 的结构，但不创建任何实例。

```
struct EMPLOYEE {
...
}em1,em2; 
```

`em1`定义结构 EMPLOYEE 并创建两个名为和的实例`em2`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:46:41.817

使用

```
struct EMPLOYEE {
...
}em1,em2; 
```

然后您可以通过以下方式主要使用它们

```
int main (void)
{
    em1.memberx = 2; /*assuming memberx is a member of your structure.*/
    return 0;
} 
```

否则，您必须像在 main 函数示例中那样声明它们。

你有另一个选择这样做：

```
typedef struct
{
...
}EMPLOYEE; 
```

然后像这样声明它们：

```
EMPLOYEE em1;
EMPLOYEE em2; 
```

并在你的 main 中像这样使用它们：

```
int main (void)
    {
        em1.memberx = 2; /*assuming memberx is a member of your structure.*/
        return 0;
    } 
```

# ruby-on-rails - 尝试按照 railscast 教程部署到亚马逊 ec2

> ID：15537730
> 
> 赞同：0
> 
> 时间：2013-03-21T01:09:43.000
> 
> 标签：ruby-on-rails, amazon-ec2, capistrano, rubber

我一直在关注这个 railscast 教程，我很确定我正确地遵循了所有步骤，但是当我去运行 cap Rubber:create_staging 时，我得到了以下错误。

甚至不知道从哪里开始调试。

```
 The key pair 'gsg-keypair' does not exist (Fog::Compute::AWS::NotFound)
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/excon-0.20.1/lib/excon/connection.rb:332:in `response'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/excon-0.20.1/lib/excon/connection.rb:226:in `request'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/fog-1.10.0/lib/fog/core/connection.rb:21:in `request'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/fog-1.10.0/lib/fog/aws/compute.rb:384:in `_request'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/fog-1.10.0/lib/fog/aws/compute.rb:379:in `request'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/fog-1.10.0/lib/fog/aws/requests/compute/run_instances.rb:119:in `run_instances'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/fog-1.10.0/lib/fog/aws/models/compute/server.rb:173:in `save'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/fog-1.10.0/lib/fog/core/collection.rb:52:in `create'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/rubber-2.2.4/lib/rubber/cloud/fog.rb:27:in `create_instance'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/rubber-2.2.4/lib/rubber/thread_safe_proxy.rb:13:in `method_missing'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/rubber-2.2.4/lib/rubber/recipes/rubber/instances.rb:310:in `create_instance'
    from /Users/anderskitson/.rbenv/versions/1.9.3-p374/lib/ruby/gems/1.9.1/gems/rubber-2.2.4/lib/rubber/recipes/rubber/instances.rb:230:in `block (2 levels) in create_instances' 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T16:05:11.710

它说它找不到您的“gsg-keypair”，回到视频的部分，它教您如何从亚马逊保存 gsg-keypair 以及 mkdir 在根目录中保存的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-18T13:30:26.593

您需要创建您的虚拟实例。然后下载密钥对（例如 xyz.pem）文件并按照这些命令进行操作。

```
$ mkdir ~/.ec2
$ mv ~/Downloads/xyz.pem ~/.ec2/xyz
$ chmod 600 ~/.ec2/xyz 
```

制作公钥版本——

```
$ ssh-keygen -y -f ~/.ec2/xyz > ~/.ec2/xyz.pub 
```

然后转到 config/rubber/rubber.yml 并将您的 key_name 更改为此

```
key_name: xyz
key_file: "#{Dir[(File.expand_path('~') rescue '/root') + '/.ec2/*' + cloud_providers.aws.key_name].first}" 
```

希望这可以解决您的问题。

# java - Android中来自apache的HttpClient？

> ID：15537731
> 
> 赞同：0
> 
> 时间：2013-03-21T01:09:47.890
> 
> 标签：java, android, httpclient, apache-httpclient-4.x

我已经使用 Java 开发了一个桌面应用程序，现在我需要为 Android 开发相同的应用程序。在我的 java 应用程序中，我使用 apache 的 httpclient 库进行所有 http 事务，我的问题是：我可以在我的新 Android 应用程序中使用我在 java 应用程序中使用的同一个类 HttpUtil 和 HttpClient 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:16:25.567

是的。您的大部分、大部分或所有代码都可以在 Android 中运行。只需确保继续使用 Apache 导入而不是 Google 的（接近）等效项。

例如，而不是：

```
import com.google.api.client.http.HttpResponse; 
```

确保您继续使用它：

```
import org.apache.http.HttpResponse; 
```

# c - 从c中的整数值中获取位

> ID：15537733
> 
> 赞同：-4
> 
> 时间：2013-03-21T01:09:51.070
> 
> 标签：c, integer, int, complexity-theory, bits

我得到一个名为 temp 的整数，它很复杂，由 3 个温度高、低和电流组成。我需要抓取 0-9 位作为高位，中间 10-19 位代表低位，20-29 位代表当前温度，其中 2 位代表错误。我不知道该怎么做，但我知道它涉及按位运算符。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:13:43.527

```
int high = temp & (2^10-1);
int middle = (temp >> 10) & (2^10-1);
int low = (temp >> 20) & (2^10-1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:13:23.090

您可以执行按位运算，或者您可以创建一个包含您的数据类型和具有指定模式的位字段的联合。然后您所要做的就是将您的数据类型添加到联合中并从位域数据类型中读出位。

注意位域可能不可移植。

```
union helper
{
    struct
    {
          int low : 10;
          int current : 10;
          int high : 10;
          int error : 2;
     };
     int temp;
}; 
```

用法：

```
Helper h;
h.temp = input;
int low = h.low;
int current = h.current;
int high = h.high;
int error = h.error; 
```

这个解决方案的优点是它的可读性很强，编译器会自动生成位操作来读取每个变量。

# android - 一些 Android 客户端断开连接，然后在 15 秒后重试 HTTP 请求，即使超时时间更长

> ID：15537736
> 
> 赞同：2
> 
> 时间：2013-03-21T01:10:22.380
> 
> 标签：android, http

我有一个 Android 应用程序向我控制的服务器发出 HTTP 请求。该服务器将请求中继到另一台服务器，我无法控制该服务器，并且当前严重超载。为了应对远程服务器的延迟，我增加了我知道的所有超时。

在我自己的服务器中，我看到一些客户端（Android 应用程序）在 15 秒后中止 HTTP 请求，然后重试相同的请求，即使我已将连接和读取超时设置得比这大得多。

我服务器中的 nginx 在日志中报告为 499 错误，并且它总是在请求到达后 15 秒左右发生。

在我的服务器上使用wireshark，我已经确认它是客户端断开连接（发送一个FIN数据包），然后立即重试相同的请求。

我无法使用自己的手机重现该问题。即使我让服务器引入人为延迟，我的手机也会遵守我设置的超时。在最近的一次更新中，我开始发送有关用户的一些基本信息（手机型号、Android 版本、当前连接类型），以查看是否可以检测到有问题手机的模式，但到目前为止还没有发现任何模式。

我之前`HttpClient`在应用程序上使用过，并尝试了几种方法来纠正这个问题，但超时和重试一直在发生。然后我切换到`HttpURLConnection`，我看到了同样的行为。代码的`HttpURLConnection`版本非常简单，几乎从示例中逐字逐句，除了不同的超时值：

```
InputStream is = null;
try
{
  URL url = new URL("my.server.com" + paramString);
  HttpURLConnection conn = (HttpURLConnection) url.openConnection();
  conn.setReadTimeout(180 * 1000);
  conn.setConnectTimeout(30 * 1000);
  conn.setRequestMethod("GET");
  conn.setDoInput(true);
  conn.connect();

  int response = conn.getResponseCode();
  is = conn.getInputStream();
} 
```

我在文档中的任何地方都没有提到这种行为。关于这个 15 秒超时设置的位置以及为什么我自己的超时不被尊重的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-02T16:52:44.983

我自己也遇到了这个问题，在查看了[这个](https://stackoverflow.com/questions/2172752/httpsurlconnection-and-intermittent-connections)问题之后，我能够用最佳答案解决它。更改后您的请求将如下所示：

```
...
URL url = new URL("my.server.com" + paramString);
System.setProperty("http.keepAlive", "false");
HttpURLConnection conn = (HttpURLConnection) url.openConnection();
... 
```

# java - 如何将 ArrayList 中对象的所有值的总成本相加？

> ID：15537744
> 
> 赞同：0
> 
> 时间：2013-03-21T01:11:19.633
> 
> 标签：java, inheritance, arraylist, foreach, super

```
Print all boats
Color= blue Length= 22 Engine size= 60 Price= $12,800.00
Color= white Length= 18 Num of Sails= 1 Price= $20,000.00
Color= red Length= 42 Num of Sails= 3 Price= $48,000.00
Color= yellow Length= 35 Engine size= 80 Price= $17,100.00
Color= red Length= 50 Engine size= 120 Price= $22,400.00
Color= blue Length= 33 Num of Sails= 2 Price= $37,000.00
Color= white Length= 14 Engine size= 10 Price= $9,400.00

Total price of all boats is $166,700.00\. 
```

如何在 ArrayList 中获取 totalCost？

```
Most Expensive Boat: Color= red Length= 42 Num of Sails= Cost= $48,000.00 
```

如何让 ArrayList 搜索成本最高的船？

我还不太了解如何在 ArrayList 中获取任何内容（除了只在一行代码中一遍又一遍地打印），但测试类本身中没有变量。这是我正在使用的所有三个类的代码。希望我能更好地为你们理解如何获取和使用数组中的任何内容，例如计算、最高成本、低成本、最便宜等。

Boat 是继承（超类） SailBoat 和 PowerBoat 扩展了 Boat（子类） Inventory（测试类）

```
public class Boat
{
//attributes
String color; //holds boat color
int lengthBoat; //contains boat length

//default constructor
public Boat()
{
    color = "white";
    lengthBoat = 0;
}
//parameterized constructor
public Boat(String _color, int _lengthBoat)
{
    setColor(_color);
    setLengthBoat(_lengthBoat);
}
//mutator method for color
public boolean setColor(String _color)
{
    if(_color == "white" || _color == "red" || _color == "yellow" || _color == "blue")
    {
        color = _color;
        return true;
    }
    else 
    {
        System.out.println("ERROR - The color must be one of these following choices, \"white\", \"red\", \"yellow\",  or \"blue\".");
        return false;
    }
}
//accessor method for color
public String getColor()
{
    return color;
}
//mutator method for lengthBoat
public boolean setLengthBoat(int _lengthBoat)
{
    if(_lengthBoat >= 0 && _lengthBoat <= 50)
    {
        lengthBoat = _lengthBoat;
        return true;
    }
    else
    {
        System.out.println("ERROR - The length must be between 0 and 50 inclusively.");
        return false;
    }
}
//accessor method for lengthBoat
public int getLengthBoat()
{
    return lengthBoat;
}
//toString method for printing results
public String toString()
{
    return "Color= " + getColor() + " Length= " + getLengthBoat();
}
} 
```

帆船类

```
import java.text.NumberFormat;

 public class SailBoat extends Boat
 {
//attribute
int numOfSails; //holds the number of Sails

//default constructor
public SailBoat()
{
    numOfSails = 1;
}
//parameterized constructor
public SailBoat(String _color, int _lengthBoat, int _numOfSails)
{
    super(_color, _lengthBoat);//taken from the parent and inherited to be recognized in this class's constructor
    setNumOfSails(_numOfSails);
}

//mutator method for numOfSails
public boolean setNumOfSails(int _numOfSails)
{
    if(_numOfSails >= 1 && _numOfSails <= 4)
    {
        numOfSails = _numOfSails;
        return true;
    }
    else 
    {
        System.out.println("ERROR - The number of sails must be between 1 and 4 inclusively.");
        return false;
    }
}
//accessor method for numOfSails
public int getNumOfSails()
{
    return numOfSails;
}
//calculates the price of the SailBoat as follows:
public int calcPrice()
{
    return lengthBoat * 1000 + getNumOfSails() * 2000;
}
//toString method
public String toString()
{
    NumberFormat nf = NumberFormat.getCurrencyInstance();//use to make the numbers as currency with $ automatically added
    nf.setMinimumFractionDigits(2);//decimal is moved over 2 places
    nf.setMaximumFractionDigits(2);//decimal is moved over 2 places
    return super.toString() + " Num of Sails= " + getNumOfSails() + " Price= " + nf.format(calcPrice());
}
//get the total Cost of all boats printed in arraylist
public int getTotalCost()
{
    int totalCost = 0;
    totalCost += calcPrice();//as calcPrice() is printed, it is therefore added/updated to totalCost
    return totalCost;
}
} 
```

动力艇类

```
import java.text.NumberFormat;

public class PowerBoat extends Boat
{
//attributes
int sizeOfEngine; //holds the engine size

//default constructor
public PowerBoat()
{
    sizeOfEngine = 5;
}
//parameterized constructor
public PowerBoat(String _color, int _lengthBoat, int _sizeOfEngine)
{
    super(_color, _lengthBoat);
    setSizeOfEngine(_sizeOfEngine);
}
//mutator method for sizeOfEngine
public boolean setSizeOfEngine(int _sizeOfEngine)
{
    if(_sizeOfEngine >= 1 && _sizeOfEngine <= 350)
    {
        sizeOfEngine = _sizeOfEngine;
        return true;
    }
    else
    {
        System.out.println("ERROR - The size of Engine must be between 1 to 350 inclusively.");
        return false;
    }
}
//accessor for sizeOfEngine
public int getSizeOfEngine()
{
    return sizeOfEngine;
}
//caculates the price of the PowerBoat as follows:
public int calcPrice()
{
    return 5000 + lengthBoat * 300 + getSizeOfEngine() * 20;
}
//toString method for printing the results
public String toString()
{
    NumberFormat nf = NumberFormat.getCurrencyInstance(); //formats all the numbers a currency
    nf.setMinimumFractionDigits(2); //sets the decimal place as a currency
    nf.setMaximumFractionDigits(2); //sets the decimal place as a currency
    return super.toString() + " Engine size= " + getSizeOfEngine() + " Price= " + nf.format(calcPrice());
}
//get the total Cost of all boats printed in arraylist
public int getTotalCost()
{
    int totalCost = 0;
    totalCost += calcPrice();//as calcPrice() is printed, it is therefore added/updated to totalCost
    return totalCost;
}
} 
```

存货

```
import java.util.ArrayList;

public class Inventory
{
  public static void main(String [] args)
  {
  //boat objects
     Boat pb1 = new PowerBoat("blue", 22, 60);
     Boat sb1 = new SailBoat("white", 18, 1);
     Boat sb2 = new SailBoat("red", 42, 3);
     Boat pb2 = new PowerBoat("yellow",35, 80);
     Boat pb3 = new PowerBoat("red", 50, 120);
     Boat sb3 = new SailBoat("blue", 33, 2);
     Boat pb4 = new PowerBoat("white", 14, 10);

     ArrayList<Boat> AL = new ArrayList<Boat>();
  //add boat objects to arraylist
     AL.add(pb1);
     AL.add(sb1);
     AL.add(sb2);
     AL.add(pb2);
     AL.add(pb3);
     AL.add(sb3);
     AL.add(pb4);

  //print all boat objects
    System.out.println("Print all boats");
     for(Boat anyBoat : AL)
     {
        System.out.println(anyBoat.toString());
        //System.out.println("Total price of  all boats is " + anyBoat.getTotalCost());
     }
  }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:32:56.727

```
int sumCost = 0;
for(Boat b : AL)
{
  sumCost += b.calcPrice();
}
return sumCost; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:34:10.990

“如何在 ArrayList 中获取 totalCost？”
和
“如何让 ArrayList 搜索成本最高的船？”
回答：

```
 int max = 0;
 int totalcost = 0;
 Boat mostExpensiveBoat = null;
 for (Boat anyBoat : AL)
 {
    if (anyBoat instanceof SailBoat) {
        totalcost += anyBoat.calcPrice();
        if (anyBoat.calcPrice() > max) {
            max = anyBoat.calcPrice();
            mostExpensiveBoat = anyBoat;
        }
    }
 }     
 // if not null print out most expensive boat here 
```

注意：如果您想为可能具有相同最高价格的船只提供服务，请使用数组列表来存储最昂贵的船只。

# python - 使用 pygame.image.load() 时出错

> ID：15537745
> 
> 赞同：4
> 
> 时间：2013-03-21T01:11:28.417
> 
> 标签：python, pygame, pycharm

当我尝试在另一个文件夹中加载图像时，我得到...

pygame.error: 无法打开 sprites/testtile.png

如果它们位于同一目录中，我可以很好地加载 .png 文件，但是一旦它们位于另一个文件夹中，我就会收到此错误。

我知道 python 也可以访问该其他文件夹，因为从折叠中导入 .py 文件时没有错误。

当我尝试 pygame.image.get_extended 时，它返回 0，但从同一目录加载 .png 文件没有问题，所以我认为这不是导致此问题的原因。

顺便说一句，我正在运行 PyCharm，这样的事情似乎总是给我这个 IDE 带来麻烦。我什至不认为这是一个 pygame 问题。不知道此时该做什么。

文件夹结构：

脚本/GraphicsDriver.py

精灵/testtile.png

驱动程序正在尝试访问 testile.png 文件

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:22:02.040

有GraphicsDriver.py的目录中的sprites目录吗？PyGame 图像加载器可能会遇到一些问题。它在初始化 PyGame 的同一目录中查找文件。使用 'os.path.join' 将其指向文件的绝对路径。

我通常围绕它编写自己的小图像加载器，因为它为该过程提供了更多的灵活性。像这样将返回图像和矩形的东西：

```
def load_image(name, colorkey = None):
    """loads an image and converts it to pixels. raises an exception if image not found"""
    fullname = os.path.join('data', name)
    try:
        image = pygame.image.load(fullname)
    except pygame.error, message:
        print 'Cannot load image:', name
        raise SystemExit, message
    image = image.convert()
    # set the colorkey to be the color of the top left pixel
    if colorkey is not None:
        if colorkey is -1:
            colorkey = image.get_at((0,0))
        image.set_colorkey(colorkey, RLEACCEL)
    return image, image.get_rect() 
```

希望这会有所帮助。

# verilog - 我可以将 $urandom_range 与时间变量一起使用吗？

> ID：15537748
> 
> 赞同：1
> 
> 时间：2013-03-21T01:11:35.940
> 
> 标签：verilog, verification, system-verilog

我想知道我是否可以简单地写：

```
 time time_var;
 time_var = $urandom_range (10ms, 7ms); 
```

我已经尝试直接使用它，并且没有发出错误/警告。但是，返回值不在 7-10ms 之间。我想与时间文字一起使用是合法的`$urandom_range`，因为我没有收到任何错误。但是，为什么我不能在适当的范围内得到一个值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:50:07.203

IEEE Std (1800-2009) 声明参数`$urandom_range`的类型`int unsigned`与`time`. 我认为即使您没有从模拟器中收到错误或警告，您也不能依靠系统功能来实现可预测的行为。

这是 VCS 中的编译错误和 Incisive 的警告。

你能用这样的东西吗？

```
int unsigned del = $urandom_range(10, 7);
#(1ms * del); 
```

# c# - 在 MVC 中使用 ASP.NET 图表

> ID：15537749
> 
> 赞同：2
> 
> 时间：2013-03-21T01:11:38.010
> 
> 标签：c#, asp.net-mvc

我可以像下面那样在 MVC 中构建图表，但问题是我无法添加颜色，并且可以在 ASP.NET 图表控件中完成很多花哨的事情。有没有办法用这种图表类型或在 MVC 中这样做的替代方法。

```
public ActionResult GetRainfallChart()
{

    var key = new Chart(width: 600, height: 400)
        .AddSeries(
            chartType: "bar",
            xValue: new[] { "Jan", "Feb", "Mar", "Apr", "May" },
            yValues: new[] { "40", "10", "20", "20", "10" })
        .AddTitle("Title")
        .Write();

    return null;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:18:40.300

如果您想使用 ASP.NET 图表控件，那么也许您可以将 Web 窗体页面（或根据您的应用程序设计等的页面）添加到您的项目中。Web Forms 和 MVC[应该](http://www.packtpub.com/article/mixing-aspnet-webforms-and-aspnet-mvc)能够共存，并且应该有相当多的博客文章、SO 问题等围绕它。也有[可能](http://malvinly.com/2011/02/28/using-web-forms-user-controls-in-an-asp-net-mvc-project/)在同一页面上有一个 Web 窗体控件，但我自己从未尝试过，所以不能 100% 评论。

替代方法可能是使用基于 JavaScript 的图形库，例如 flot ( [http://www.flotcharts.org/](http://www.flotcharts.org/) )。所以你会在那里做的是：

1.  让您的控制器收集（或协调收集）图表的所有适当数据
2.  渲染或以其他方式将数据放入您的视图中
3.  使用 flot 渲染（flot 也需要 JQuery，但这应该不是问题）

我只提到 flot 是因为它是我所知道的；我个人的经验是，进入 YMMV 可能有点困难。

不过，内森。

# uiview - 如何调用标记的文本字段

> ID：15537750
> 
> 赞同：0
> 
> 时间：2013-03-21T01:11:37.897
> 
> 标签：uiview, tags, textfield, nstextfield

我正在使用标签以编程方式创建一系列文本字段。我希望能够访问每个文本字段中的数据，但它会不断恢复到最后一个标签。

在此示例中，我创建了 10 个文本字段。当您单击一个字段时，它应该将该字段变为蓝色，但它总是将最后一个字段变为蓝色。

如何访问字段标签以便访问正确的文本字段？

我添加了 NSlog 来测试发件人#。

```
@implementation ViewController
@synthesize name = _name ;
- (void)viewDidLoad
{
    [super viewDidLoad];
    int y = 20 ;
    for(int i=1; i <= 10; i++)
    {
      CGRect frame = CGRectMake(20, y, 100, 30 ) ;
      name = [[UITextField alloc] initWithFrame:frame];
      [name setTag:i] ;
      [name setBackgroundColor:[UIColor whiteColor]] ;
      [name addTarget:self action:@selector(makeBlue:) forControlEvents:UIControlEventTouchDown];
      [self.view addSubview:name];
      y += 38;
    }
}

- (void)makeBlue:(id)sender
{
    int i = (int)[sender tag] ;
    [name setTag:i] ;
    NSLog(@"%d", i);
    [name setBackgroundColor:[UIColor blueColor]] ;
} 
```

**编辑：** 太好了。谢谢你。它确实解决了我的一个问题。我想我期待一个不同的答案，这将引导我解决我的第二个问题。我想从标记的文本字段中获取输入以在其他地方使用它。我有同样的问题，我只从最后一个文本字段中获取输入。

```
- (void)viewDidLoad
{
[super viewDidLoad];

int y = 20 ;
for(int tag=1; tag <= 10; tag++)
{
    CGRect frame = CGRectMake(20, y, 100, 30 ) ;
    name = [[UITextField alloc] initWithFrame:frame];
    [name setTag:tag] ;
    [name setBackgroundColor:[UIColor whiteColor]] ;
    [name addTarget:self action:@selector(makeItSo:) forControlEvents:UIControlEventEditingDidEnd];
    [self.view addSubview:name];
    [name setDelegate:self] ;
    y += 38;
}
}

- (void)makeItSo:(id)sender
{
int tag = (int)[sender tag] ;
[name setTag:tag] ;
NSString * aName = [name text] ;
NSLog(@"%@", aName) ;
} 
```

在此示例中，我不需要在 makeItSo 方法中再次使用 setTag，但我不知道如何从特定标记中获取值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T12:33:26.217

在您的`makeBlue:` 方法中，您只是无缘无故地重新分配标签。这不会改变视图。`name`即使您更改其标签，该变量也将指向循环中创建的最后一个视图。如果您想按标签访问视图，请使用：

```
[self.view viewWithTag:<tag>] 
```

所以你的`makeBlue:`代码看起来像：

```
- (void)makeBlue:(id)sender
{
    int tag = (int)[sender tag] ;
    UIView *tagView = [self.view viewWithTag:tag]
    [tagView setBackgroundColor:[UIColor blueColor]] ;
} 
```

因此，要获取文本字段的值，您将使用：

```
 name = [self.view viewWithTag:[sender tag]];
 NSString *fieldText = name.text; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-30T06:31:31.710

```
NSInteger i =    [sender tag]; 
```

# cordova - PhoneGap 相机在拍摄图像后无法确认

> ID：15537753
> 
> 赞同：4
> 
> 时间：2013-03-21T01:11:50.863
> 
> 标签：cordova

我正在制作一个应用程序来测试 PhoneGap 的功能，以便以后可以将其用于更大的项目。我试图通过构建一个仅捕获和显示图像的简单测试应用程序来使相机 API 正常工作。奇怪的是，当我按下触发的捕获按钮时，`navigate.camera.getPicture()`我可以拍照但不确认图片，以便该过程返回到我的应用程序并给我捕获的图像。所有其他按钮都按预期工作，因此我可以例如按下取消，它会正确返回到我的应用程序并运行作为第二个参数传递给`navigate.camera.getPicture()`（错误处理程序）的函数。

这是我的称呼`navigate.camera.getPicture()`：

```
navigator.camera.getPicture( function( uri ) {
    // code to handle success
}, function( msg ) {
    // code to handle error
}, {
    quality: 100,
    destinationType: Camera.DestinationType.FILE_URI,
    encodingType: Camera.EncodingType.PNG,
    targetWidth: 2000,
    targetHeight: 2000,
    correctOrientation: true,
    saveToPhotoAlbum: false
} ); 
```

我试图注释掉除destinationType 之外的所有配置参数，看看是否有帮助。

我的 config.xml 有这些行允许摄像头：

```
<plugin name="Camera" value="org.apache.cordova.CameraLauncher" />
<feature name="http://api.phonegap.com/1.0/camera" /> 
```

我的调试环境是运行 Android 4.2.1 的 Galaxy Nexus。

我还在 Ripple 下运行了该应用程序，该应用程序完全符合预期。

该应用程序是使用 PhoneGap Build 构建的，而不是我机器上的 Android SDK，如果这有所不同的话。

我在这里有什么遗漏吗？

提前感谢=）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-16T00:32:20.203

我在运行 Android 4.2 的 Galaxy Nexus 上运行使用 PhoneGap Build 构建的应用程序时遇到了同样的问题。我能够通过在我的 config.xml 中使用以下两个功能指令来解决这个问题：

```
<feature name="http://api.phonegap.com/1.0/camera"/>
<feature name="http://api.phonegap.com/1.0/file"/> 
```

不幸的是，logcat 没有错误，但这似乎可以解决问题。希望这可以帮助！

# mysql - 尝试从多个表和列中选择所有 ID，并按最多匹配项排序

> ID：15537768
> 
> 赞同：1
> 
> 时间：2013-03-21T01:13:11.153
> 
> 标签：mysql

我想要做的是选择所有匹配最多的 ID，并按点击次数最多的顺序列出它们

```
表 - 星期日

身份证 | 上午 8 点 | 上午 9 点 | 上午 10 点 | 上午11点
一个 | 0 | 1 | 0 | 0
乙| 0 | 0 | 1 | 1
C | 0 | 0 | 0 | 1

表 - 星期一

身份证 | 上午 8 点 | 上午 9 点 | 上午 10 点 | 上午11点
一个 | 0 | 0 | 1 | 1
乙| 0 | 1 | 0 | 0
C | 0 | 0 | 0 | 1

表 - 星期二

身份证 | 上午 8 点 | 上午 9 点 | 上午 10 点 | 上午11点
一个 | 0 | 1 | 0 | 0
乙| 0 | 1 | 0 | 0
C | 0 | 0 | 0 | 1

```

例如：我想查找所有具有周日上午 9 点和 11 点、周一上午 10 点和 11 点以及周二上午 9 点的 ID，然后按点击次数最多排序

我会得到以下回报。

*   A 4 次命中
*   B 2 次安打
*   C 2 次命中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:21:11.610

首先，让我们获取一个查询来将数据处理成更易于使用的东西：

```
SELECT ID, 0 AS dow, 8 as hr, `8AM` AS hits
FROM SUNDAY
UNION ALL
SELECT ID, 0 AS dow, 9 as hr, `9AM` AS hits
FROM SUNDAY
UNION ALL
SELECT ID, 0 AS dow, 10 as hr, `10AM` AS hits
FROM SUNDAY
UNION ALL
SELECT ID, 0 AS dow, 11 as hr, `11AM` AS hits
FROM SUNDAY
UNION ALL
SELECT ID, 1 AS dow, 8 as hr, `8AM` AS hits
FROM MONDAY
UNION ALL
SELECT ID, 1 AS dow, 9 as hr, `9AM` AS hits
FROM MONDAY
UNION ALL
SELECT ID, 1 AS dow, 10 as hr, `10AM` AS hits
FROM MONDAY
UNION ALL
SELECT ID, 1 AS dow, 11 as hr, `11AM` AS hits
FROM MONDAY
UNION ALL
SELECT ID, 2 AS dow, 8 as hr, `8AM` AS hits
FROM TUESDAY
UNION ALL
SELECT ID, 2 AS dow, 9 as hr, `9AM` AS hits
FROM TUESDAY
UNION ALL
SELECT ID, 2 AS dow, 10 as hr, `10AM` AS hits
FROM TUESDAY
UNION ALL
SELECT ID, 2 AS dow, 11 as hr, `11AM` AS hits
FROM TUESDAY 
```

[返回的数据的 SQL Fiddle 示例](http://www.sqlfiddle.com/#!2/8ac39/3)

然后你可以从这个（派生的）表中选择：

```
SELECT ID, SUM(hits) AS hits
FROM
(
    --above query, either as a view or derived table
    --or permanently changed
) hitsTable
WHERE (dow = 0 AND hr IN (9,11))
OR (dow = 1 AND hr IN (10,11))
OR (dow = 2 AND hr = 9)
GROUP BY ID
ORDER BY SUM(hits) DESC 
```

[SQL 小提琴示例](http://www.sqlfiddle.com/#!2/8ac39/2)

`WHERE`请注意此处子句的简单性。如果您可以控制您的架构，我建议您永久更改数据存储为此格式的方式。它会让你的生活*更*轻松。如果你不能，我建议至少制作一个以这种方式组合所有表的视图，这样你就可以轻松地查询它们。

* * *

你能用你当前的模式来做吗？当然，它可能看起来“更短”或“更简单”，但如果您动态构建这些查询，它就不那么漂亮了：

```
SELECT ID, SUM(hits) AS hits
FROM
(
    SELECT ID, `9AM` + `11AM` AS hits
    FROM SUNDAY
    UNION ALL
    SELECT ID, `10AM` + `11AM` AS hits
    FROM MONDAY
    UNION ALL
    SELECT ID, `9AM` AS hits
    FROM TUESDAY
) x
GROUP BY ID
ORDER BY SUM(hits) DESC 
```

# c++ - 使用 Pycrypto 的 Python 中的重复 Windows 加密服务提供程序结果

> ID：15537775
> 
> 赞同：4
> 
> 时间：2013-03-21T01:13:43.540
> 
> 标签：c++, python, utf-8, cryptography, utf-16

## **编辑和更新**

2013 年 3 月 24 日：
在转换为 utf-16 并在点击任何“e”或“m”字节之前停止后，我的 Python 输出哈希现在与来自 c++ 的哈希匹配。但是解密的结果不匹配。我知道我的 SHA1 哈希是 20 字节 = 160 位，并且 RC4 密钥的长度可以从 40 位到 2048 位不等，所以在 WinCrypt 中可能会有一些我需要模仿的默认加盐。CryptGetKeyParam KP_LENGTH 或 KP_SALT

2013 年 3 月24 日：
CryptGetKeyParam KP_LENGTH 告诉我我的密钥长度是 128 位。我给它一个 160 位的哈希值。所以也许它只是丢弃了最后 32 位……或 4 个字节。现在测试。

2013 年 3 月 24 日：是的，就是这样。如果我在 python 中丢弃我的 SHA1 哈希的最后 4 个字节......我会得到相同的解密结果。

## **快速信息：**

我有一个 C++ 程序来解密一个数据块。它使用 Windows Crytographic Service Provider，因此它仅适用于 Windows。我希望它可以与其他平台一起使用。

## **方法概述：**

在 Windows Crypto API 中，ASCII 编码的字节密码被转换为宽字符表示，然后使用 SHA1 进行散列以生成 RC4 流密码的密钥。

在 Python PyCrypto 中，一个 ASCII 编码的字节字符串被​​解码为一个 Python 字符串。它根据经验观察到的字节被截断，这导致 mbctowcs 停止在 c++ 中转换。然后，这个被截断的字符串在 utf-16 中进行编码，有效地在字符之间用 0x00 字节填充它。这个新的截断、填充的字节字符串被​​传递给 SHA1 哈希，摘要的前 128 位被传递给 PyCrypto RC4 对象。

**问题 [已解决]**
我似乎无法使用 Python 3.xw/PyCrypto 获得相同的结果

**C++ 代码骨架：**

```
HCRYPTPROV hProv      = 0x00;
HCRYPTHASH hHash      = 0x00;
HCRYPTKEY  hKey       = 0x00;
wchar_t    sBuf[256]  = {0};

CryptAcquireContextW(&hProv, L"FileContainer", L"Microsoft Enhanced RSA and AES Cryptographic Provider", 0x18u, 0);

CryptCreateHash(hProv, 0x8004u, 0, 0, &hHash);
//0x8004u is SHA1 flag

int len = mbstowcs(sBuf, iRec->desc, sizeof(sBuf));
//iRec is my "Record" class
//iRec->desc is 33 bytes within header of my encrypted file
//this will be used to create the hash key. (So this is the password)

CryptHashData(hHash, (const BYTE*)sBuf, len, 0);

CryptDeriveKey(hProv, 0x6801, hHash, 0, &hKey);

DWORD dataLen = iRec->compLen;  
//iRec->compLen is the length of encrypted datablock
//it's also compressed that's why it's called compLen

CryptDecrypt(hKey, 0, 0, 0, (BYTE*)iRec->decrypt, &dataLen);
// iRec is my record that i'm decrypting
// iRec->decrypt is where I store the decrypted data
//&dataLen is how long the encrypted data block is.
//I get this from file header info 
```

**Python代码骨架：**

```
from Crypto.Cipher import ARC4
from Crypto.Hash import SHA

#this is the Decipher method from my record class
def Decipher(self):

    #get string representation of 33byte password
    key_string= self.desc.decode('ASCII')

    #so far, these characters fail, possibly others but
    #for now I will make it a list
    stop_chars = ['e','m']

    #slice off anything beyond where mbstowcs will stop
    for char in stop_chars:
        wc_stop = key_string.find(char)
        if wc_stop != -1:
            #slice operation
            key_string = key_string[:wc_stop]

    #make "wide character"
    #this is equivalent to padding bytes with 0x00

    #Slice off the two byte "Byte Order Mark" 0xff 0xfe 
    wc_byte_string = key_string.encode('utf-16')[2:]

    #slice off the trailing 0x00
    wc_byte_string = wc_byte_string[:len(wc_byte_string)-1] 

    #hash the "wchar" byte string
    #this is the equivalent to sBuf in c++ code above
    #as determined by writing sBuf to file in tests
    my_key = SHA.new(wc_byte_string).digest()

    #create a PyCrypto cipher object
    RC4_Cipher = ARC4.new(my_key[:16])

    #store the decrypted data..these results NOW MATCH
    self.decrypt = RC4_Cipher.decrypt(self.datablock) 
```

**怀疑 [编辑：已确认] 原因**
1\. mbstowcs 密码转换导致输入 SHA1 哈希的“原始数据”在 python 和 c++ 中不一样。mbstowcs 在 0x65 和 0x6D 字节处停止转换。原始数据以仅原始 33 字节密码的一部分的 wide_char 编码结束。

2.  RC4 可以有可变长度的密钥。在增强型 Win Crypt 服务提供程序中，默认长度为 128 位。未指定密钥长度是采用“原始数据”的 160 位 SHA1 摘要的前 128 位

**我如何调查** 编辑：根据我自己的实验和@RolandSmith 的建议，我现在知道我的一个问题是 mbctowcs 的行为方式出乎我的意料。它似乎停止在“e”（0x65）和“m”（0x6d）（可能是其他）上写入 sBuf。因此，我的描述（Ascii 编码字节）中的密码“Monkey”在 sBuf 中看起来像“M on k”，因为 mbstowcs 在 e 处停止，并根据我系统上的 2 字节 wchar typedef 在字节之间放置 0x00。我通过将转换结果写入文本文件发现了这一点。

```
BYTE pbHash[256];  //buffer we will store the hash digest in 
DWORD dwHashLen;  //store the length of the hash
DWORD dwCount;
dwCount = sizeof(DWORD);  //how big is a dword on this system?

//see above "len" is the return value from mbstowcs that tells how
//many multibyte characters were converted from the original
//iRec->desc an placed into sBuf.  In some cases it's 3, 7, 9
//and always seems to stop on "e" or "m"

fstream outFile4("C:/desc_mbstowcs.txt", ios::out | ios::trunc | ios::binary);
outFile4.write((const CHAR*)sBuf, int(len));
outFile4.close();

//now get the hash size from CryptGetHashParam
//an get the acutal hash from the hash object hHash
//write it to a file.
if(CryptGetHashParam(hHash, HP_HASHSIZE, (BYTE *)&dwHashLen, &dwCount, 0)) {
  if(CryptGetHashParam(hHash, 0x0002, pbHash, &dwHashLen,0)){

    fstream outFile3("C:/test_hash.txt", ios::out | ios::trunc | ios::binary);
    outFile3.write((const CHAR*)pbHash, int(dwHashLen));
    outFile3.close();
  }
} 
```

**参考：**
根据环境定义，宽字符会导致问题
[VC++ 6.0 和 VS 2008 之间 Windows 加密服务的差异](https://stackoverflow.com/questions/9820431/difference-in-windows-cryptography-service-between-vc-6-0-and-vs-2008)

将 utf-8 转换为 utf-16 字符串
[Python - 将宽字符字符串从二进制文件转换为 Python unicode 字符串](https://stackoverflow.com/questions/2746426/python-converting-wide-char-strings-from-a-binary-file-to-python-unicode-strin)

PyCrypto RC4 示例
[https://www.dlitz.net/software/pycrypto/api/current/Crypto.Cipher.ARC4-module.html](https://www.dlitz.net/software/pycrypto/api/current/Crypto.Cipher.ARC4-module.html)

[使用 Sha256 散列字符串](https://stackoverflow.com/questions/12416249/hashing-a-string-with-sha256)

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa379916(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379916(v=vs.85).aspx)

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa375599(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa375599(v=vs.85).aspx)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-24T12:44:45.310

您可以`wchar_t`使用小型测试程序（在 C 中）测试 的大小：

```
#include <stdio.h> /* for printf */
#include <stddef.h> /* for wchar_t */

int main(int argc, char *argv[]) {
    printf("The size of wchar_t is %ld bytes.\n", sizeof(wchar_t));
    return 0;
} 
```

如果您可以从终端运行 C++ 程序，您还可以在 C++ 代码中使用`printf()`调用将例如`iRec->desc`和散列的结果写入`sbuf`屏幕。否则使用`fprintf()`将它们转储到文件中。

为了更好地模仿 C++ 程序的行为，您甚至可以使用[`ctypes`](http://docs.python.org/3/library/ctypes.html)来调用`mbstowcs()`您的 Python 代码。

**编辑：**您写道：

> mbctowcs 肯定是一个问题。似乎它正在将不可预测的（对我而言）字节数传输到我的缓冲区中进行散列。

请记住，它`mbctowcs`返回转换后的宽字符数。换句话说，多字节编码中的 33 字节缓冲区可以包含从 5 个（UTF-8 6 字节序列）到 33 个字符的任何内容，具体取决于所使用的编码。

**Edit2：**您使用 0`dwFlags`作为`CryptDeriveKey`. 根据其[文档](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379916%28v=vs.85%29.aspx)，高 16 位应包含密钥长度。您应该检查`CryptDeriveKey`的返回值以查看调用是否成功。

**Edit3**：您可以`mbctowcs`在 Python 中进行测试（我在这里使用[IPython](http://ipython.org/)。）：

```
In [1]: from ctypes import *

In [2]: libc = CDLL('libc.so.7')

In [3]: monkey = c_char_p(u'Monkey')

In [4]: test = c_char_p(u'This is a test')

In [5]: wo = create_unicode_buffer(256)

In [6]: nref = c_size_t(250)

In [7]: libc.mbstowcs(wo, monkey, nref)
Out[7]: 6

In [8]: print wo.value
Monkey

In [9]: libc.mbstowcs(wo, test, nref)
Out[9]: 14

In [10]: print wo.value
This is a test 
```

请注意，在 Windows 中，您可能应该使用`libc = cdll.msvcrt`而不是`libc = CDLL('libc.so.7')`.

# asp.net - 我在使用 LINQ 查询 XDocument 时遇到问题

> ID：15537785
> 
> 赞同：0
> 
> 时间：2013-03-21T01:15:14.943
> 
> 标签：asp.net, vb.net, linq, linq-to-xml

我是 LINQ 的新手，所以我认为我的语法有一些错误。我在网上看了很多例子，但每个人似乎都有自己的风格。

这是我要查询的 XML 数据：

```
<ajax-response>
    <response type="object" id="unknown">
        <generic response="Success" message="Channel status will follow" />
    </response>
    <response type="object" id="unknown">
        <generic event="Status" privilege="Call" channel="SIP/452-000006fc" calleridnum="452" calleridname="Joe" connectedlinenum="430" connectedlinename="device" accountcode="" channelstate="6" channelstatedesc="Up" context="macro-dial-one" extension="s" priority="37" seconds="54" bridgedchannel="SIP/430-000006fd" bridgeduniqueid="1363822334.1829" uniqueid="1363822334.1828" />
    </response>
    <response type="object" id="unknown">
        <generic event="Status" privilege="Call" channel="SIP/430-000006fd" calleridnum="430" calleridname="device" connectedlinenum="452" connectedlinename="Joe" account="" state="Up" bridgedchannel="SIP/452-000006fc" bridgeduniqueid="1363822334.1828" uniqueid="1363822334.1829" />
    </response>
    <response type="object" id="unknown">
        <generic event="StatusComplete" items="2" />
    </response>
</ajax-response> 
```

这是我到目前为止所拥有的：

```
Function ParseXML(statusXML As XmlDocument) As String
    Dim xdoc As XDocument = XDocument.Load(New XmlNodeReader(statusXML))
    Dim parsed As StringBuilder = New StringBuilder()

    Dim query = From generic In xdoc.Descendants("generic") _
                Where generic.Attribute("privilege") IsNot Nothing And generic.Attribute("privilege").Value = "Call" _
                Select connectedlinenum = generic.Attribute("connectedlinenum").ToString, _
                       calleridnum = generic.Attribute("calleridnum").ToString

    For Each i In query
        parsed.Append(i.connectedlinenum).Append(",").Append(i.calleridnum).Append(vbCrLf)
    Next
    Return parsed.ToString
End Function 
```

我猜我误解了我的`generic`对象应该如何工作，因为`NullReferenceException`当我尝试引用它时，我的 Where 子句中有一个。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:30:51.660

我不熟悉 Xml 解析，但在其中两个节点中您没有该`privilege`属性。这会导致错误吗？

在这种情况下，如果您将子句中的`And`to更改为会发生什么？这样，如果没有属性，它将不会评估语句的后半部分。`AndAlso``Where``privilege`

# ruby-on-rails - 尽管在初始化程序中需要模型，但 Rails 3 中未定义的类/模块 X

> ID：15537790
> 
> 赞同：3
> 
> 时间：2013-03-21T01:15:55.773
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我们使用 Rails.cache 并在加载调用类 X 的页面时看到未定义的类/模块 X 错误。我们按照[此处](http://aaronvb.com/articles/37-rails-caching-and-undefined-class-module)的建议包含一个初始化程序，该初始化程序需要开发环境中的所有模型。

但是，我们看到了同样的错误。还有其他建议吗？我们在下面包含了初始化程序代码，从输出到控制台，看起来代码正在被调用。

我们在 Rails 3.2.12 + Ruby 1.9.3 上。

```
if Rails.env == "development"
  Dir.foreach("#{Rails.root}/app/models") do |model_name|
    puts "REQUIRING DEPENDENCY: #{model_name}"
    require_dependency model_name unless model_name == "." || model_name == ".."    
  end 
end 
```

堆栈跟踪：

```
Processing by DandyController#get_apps as JSON
  Parameters: {"category"=>"featured", "country_id"=>"143441", "language_id"=>"EN"}
WARNING: Can't verify CSRF token authenticity
Completed 500 Internal Server Error in 2ms

ArgumentError (undefined class/module App):
  app/controllers/dandy_controller.rb:66:in `get_featured_apps'
  app/controllers/dandy_controller.rb:50:in `get_apps'

      Rendered C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/templat
    es/rescues/_trace.erb (2.0ms)
      Rendered C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/templat
    es/rescues/_request_and_response.erb (2.0ms)
      Rendered C:/RailsInstaller/Ruby1.9.3/lib/ruby/gems/1.9.1/gems/actionpack-3.2.12/lib/action_dispatch/middleware/templat
    es/rescues/diagnostics.erb within rescues/layout (46.0ms) 
```

代码：

```
def get_featured_apps( country_id )
    # Fetch featured apps from cache or from DB
    apps = Rails.cache.fetch( 'featured_apps', {:expires_in => 1.days} ) do
        logger.info '+++ Cache miss: featured apps'
        get_featured_apps_helper country_id     
    end

    # Get sponsored results

    apps = get_featured_apps_helper country_id
    # Return featured apps
    return apps
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-11-28T18:12:01.370

我已经覆盖了 fetch 方法，它为我创造了奇迹！

```
unless Rails.env.production?
  module ActiveSupport
    module Cache
      class Store
        def fetch(name, options = nil)
          if block_given?
            yield
          end
        end
      end
    end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-24T18:15:12.497

一个更优雅的解决方案是编写一个包装器方法，您可以在调用时调用`Rails.cache.fetch`：

```
def some_func
  apps = with_autoload_of(App) do
    Rails.cache.fetch( 'featured_apps', {:expires_in => 1.days} ) do
      logger.info '+++ Cache miss: featured apps'
      get_featured_apps_helper country_id
    end     
  end
end

##
# A simple wrapper around a block that requires the provided class to be
# auto-loaded prior to execution.
#
# This method must be passed a block, which it always yields to.
#
# This is typically used to wrap `Rails.cache.fetch` calls to ensure that
# the autoloader has loaded any class that's about to be referenced.
#
# @param [Class] clazz
#   The class to ensure gets autoloaded.
#
def self.with_autoload_of(clazz)
  yield
end 
```

# java - SSLException：收到致命警报：Java 1.7 升级后的非法参数

> ID：15537794
> 
> 赞同：4
> 
> 时间：2013-03-21T01:16:14.493
> 
> 标签：java, tomcat, upgrade

连接到 LDAP 时从 Tomcat 5 升级 Tomcat 7 会出现错误：

```
main, READ: TLSv1 Alert, length = 2
main, RECV TLSv1 ALERT:  fatal, illegal_parameter
main, called closeSocket()
main, handling exception: javax.net.ssl.SSLException: Received fatal alert: illegal_parameter 
```

相同的代码适用于 Java 1.5 上的 Tomcat 5

有人有解决方案吗？

**Java 5 SSL 请求/响应**

```
init context
trigger seeding of SecureRandom
done seeding SecureRandom
instantiated an instance of class com.sun.net.ssl.internal.ssl.SSLSocketFactoryImpl
%% No cached client session

*** ClientHello, TLSv1

RandomCookie:  GMT: 1363826094 bytes = { 214, 89, 42, 109, 152, 165, 62, 69, 126, 239, 105, 77, 178, 234, 219, 136, 35, 159, 179, 159, 108, 193, 12, 172, 7, 185, 191, 75 }

Session ID:  {}

Cipher Suites: [SSL_RSA_WITH_RC4_128_MD5, SSL_RSA_WITH_RC4_128_SHA, TLS_RSA_WITH_AES_128_CBC_SHA, TLS_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_RSA_WITH_AES_256_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_256_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_DES_CBC_SHA, SSL_DHE_RSA_WITH_DES_CBC_SHA, SSL_DHE_DSS_WITH_DES_CBC_SHA, SSL_RSA_EXPORT_WITH_RC4_40_MD5, SSL_RSA_EXPORT_WITH_DES40_CBC_SHA, SSL_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA, SSL_DHE_DSS_EXPORT_WITH_DES40_CBC_SHA]

Compression Methods:  { 0 }

***

[write] MD5 and SHA1 hashes:  len = 79

0000: 01 00 00 4B 03 01 51 4A   56 AE D6 59 2A 6D 98 A5  ...K..QJV..Y*m..
0010: 3E 45 7E EF 69 4D B2 EA   DB 88 23 9F B3 9F 6C C1  >E..iM....#...l.
0020: 0C AC 07 B9 BF 4B 00 00   24 00 04 00 05 00 2F 00  .....K..$...../.
0030: 35 00 33 00 39 00 32 00   38 00 0A 00 16 00 13 00  5.3.9.2.8.......
0040: 09 00 15 00 12 00 03 00   08 00 14 00 11 01 00     ...............

main, WRITE: TLSv1 Handshake, length = 79

[write] MD5 and SHA1 hashes:  len = 107

0000: 01 03 01 00 42 00 00 00   20 00 00 04 01 00 80 00  ....B... .......
0010: 00 05 00 00 2F 00 00 35   00 00 33 00 00 39 00 00  ..../..5..3..9..
0020: 32 00 00 38 00 00 0A 07   00 C0 00 00 16 00 00 13  2..8............
0030: 00 00 09 06 00 40 00 00   15 00 00 12 00 00 03 02  .....@..........
0040: 00 80 00 00 08 00 00 14   00 00 11 51 4A 56 AE D6  ...........QJV..
0050: 59 2A 6D 98 A5 3E 45 7E   EF 69 4D B2 EA DB 88 23  Y*m..>E..iM....#
0060: 9F B3 9F 6C C1 0C AC 07   B9 BF 4B                 ...l......K

main, WRITE: SSLv2 client hello message, length = 107

[Raw write]: length = 109

0000: 80 6B 01 03 01 00 42 00   00 00 20 00 00 04 01 00  .k....B... .....
0010: 80 00 00 05 00 00 2F 00   00 35 00 00 33 00 00 39  ....../..5..3..9
0020: 00 00 32 00 00 38 00 00   0A 07 00 C0 00 00 16 00  ..2..8..........
0030: 00 13 00 00 09 06 00 40   00 00 15 00 00 12 00 00  .......@........
0040: 03 02 00 80 00 00 08 00   00 14 00 00 11 51 4A 56  .............QJV
0050: AE D6 59 2A 6D 98 A5 3E   45 7E EF 69 4D B2 EA DB  ..Y*m..>E..iM...
0060: 88 23 9F B3 9F 6C C1 0C   AC 07 B9 BF 4B           .#...l......K

[Raw read]: length = 5

0000: 16 03 01 00 2A                                     ....*

[Raw read]: length = 42

0000: 02 00 00 26 03 01 51 4A   56 AE 69 C1 21 C1 51 EF  ...&..QJV.i.!.Q.
0010: 7B 2E 1D 34 1A 72 40 A7   BD FE B6 DF 6D B8 41 A1  ...4.r@.....m.A.
0020: 18 ED C9 AC 15 EE 00 00   04 00                    ..........

main, READ: TLSv1 Handshake, length = 42

*** ServerHello, TLSv1

RandomCookie:  GMT: 1363826094 bytes = { 105, 193, 33, 193, 81, 239, 123, 46, 29, 52, 26, 114, 64, 167, 189, 254, 182, 223, 109, 184, 65, 161, 24, 237, 201, 172, 21, 238 }

Session ID:  {}

Cipher Suite: SSL_RSA_WITH_RC4_128_MD5

Compression Method: 0
</pre>
****Java 7 Requset/Response****
<pre>
trigger seeding of SecureRandom

done seeding SecureRandom

SocketFactory Class sun.security.ssl.SSLSocketFactoryImpl

Ignoring unavailable cipher suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA

Ignoring unavailable cipher suite: TLS_DHE_RSA_WITH_AES_256_CBC_SHA

Ignoring unavailable cipher suite: TLS_ECDH_RSA_WITH_AES_256_CBC_SHA

Ignoring unsupported cipher suite: TLS_DHE_DSS_WITH_AES_128_CBC_SHA256

Ignoring unsupported cipher suite: TLS_DHE_DSS_WITH_AES_256_CBC_SHA256

Ignoring unsupported cipher suite: TLS_DHE_RSA_WITH_AES_128_CBC_SHA256

Ignoring unsupported cipher suite: TLS_ECDH_RSA_WITH_AES_128_CBC_SHA256

Ignoring unsupported cipher suite: TLS_DHE_RSA_WITH_AES_256_CBC_SHA256

Ignoring unsupported cipher suite: TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384

Ignoring unsupported cipher suite: TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA384

Ignoring unsupported cipher suite: TLS_RSA_WITH_AES_256_CBC_SHA256

Ignoring unavailable cipher suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA

Ignoring unsupported cipher suite: TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256

Ignoring unsupported cipher suite: TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA384

Ignoring unavailable cipher suite: TLS_DHE_DSS_WITH_AES_256_CBC_SHA

Ignoring unsupported cipher suite: TLS_ECDH_RSA_WITH_AES_256_CBC_SHA384

Ignoring unsupported cipher suite: TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256

Ignoring unsupported cipher suite: TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA256

Ignoring unavailable cipher suite: TLS_ECDH_ECDSA_WITH_AES_256_CBC_SHA

Ignoring unavailable cipher suite: TLS_RSA_WITH_AES_256_CBC_SHA

Ignoring unsupported cipher suite: TLS_RSA_WITH_AES_128_CBC_SHA256

Connection: creating socket with a timeout using supplied socket factory

Allow unsafe renegotiation: false

Allow legacy hello messages: true

Is initial handshake: true

Is secure renegotiation: false

Catalina-startStop-1, setSoTimeout(5000) called

%% No cached client session

*** ClientHello, TLSv1

RandomCookie:  GMT: 1364411375 bytes = { 252, 62, 19, 89, 117, 105, 113, 92, 8, 241, 158, 190, 129, 34, 137, 245, 24, 92, 177, 17, 164, 204, 114, 199, 68, 55, 199, 3 }

Session ID:  {}

Cipher Suites: [TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA, 
TLS_RSA_WITH_AES_128_CBC_SHA, TLS_ECDH_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDH_RSA_WITH_AES_128_CBC_SHA, TLS_DHE_
RSA_WITH_AES_128_CBC_SHA, TLS_DHE_DSS_WITH_AES_128_CBC_SHA, TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, TLS_ECDHE_RSA_WITH_RC4_128_SHA, SSL_RSA_WITH_RC4_128_SHA, TLS_ECDH_ECDSA_WITH_RC4_128_SHA, TLS_ECDH_RSA_WI
TH_RC4_128_SHA, TLS_ECDHE_ECDSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDH_ECDSA_WITH_3DES_EDE_CBC_SHA, TLS_ECDH_RSA_WITH_3DES_EDE_CBC_SHA, SSL
_DHE_RSA_WITH_3DES_EDE_CBC_SHA, SSL_DHE_DSS_WITH_3DES_EDE_CBC_SHA, SSL_RSA_WITH_RC4_128_MD5, TLS_EMPTY_RENEGOTIATION_INFO_SCSV]

Compression Methods:  { 0 }

Extension elliptic_curves, curve names: {secp256r1, sect163k1, sect163r2, secp192r1, 
secp224r1, sect233k1, sect233r1, sect283k1, sect283r1, secp384r1, sect409k1, sect409r1, secp521r1, sect571k1, sect5
71r1, secp160k1, secp160r1, secp160r2, sect163r1, secp192k1, sect193r1, sect193r2, secp224k1, sect239k1, secp256k1}

Extension ec_point_formats, formats: [uncompressed]

Catalina-startStop-1, WRITE: TLSv1 Handshake, length = 149

Catalina-startStop-1, READ: TLSv1 Alert, length = 2

Catalina-startStop-1, RECV TLSv1 ALERT:  fatal, illegal_parameter

Catalina-startStop-1, called closeSocket()

javax.net.ssl.SSLException: Received fatal alert: illegal_parameter
        at sun.security.ssl.Alerts.getSSLException(Alerts.java:208) 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-28T17:18:23.383

这个问题的解决方法是：

1.  使用命令禁用黄道曲线：`-Dcom.sun.net.ssl.enableECC=false`

2.  禁用服务器扩展名：`-Djsse.enableSNIExtension=false`

3.  安装了不受限制的策略 jar 文件。

这解决了问题，我可以运行应用程序。

# ruby - Ruby watir nokogiri 浏览器集成

> ID：15537795
> 
> 赞同：-3
> 
> 时间：2013-03-21T01:16:17.710
> 
> 标签：ruby, nokogiri, watir

因此，我使用 ruby​​ 和 gem（如 watir 和 nokigiri）创建了一个解析器。我在 Debian 盒子上创建了它。它的效果很棒，但我不知道下一步该做什么。我希望它可以在浏览器和其他平台（例如 Windows、OSX 等）上工作，而无需打开终端窗口。我确信有一个简单的解决方案，但我也希望社区提供意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:42:27.150

> 一个正在运行的 iframe

我不认为那是可能的。它将在服务器上运行，与模仿真实用户操作的真实浏览器进行交互。

你可以让它无头，这样它就不会打开浏览器窗口。我用[capybara](https://github.com/jnicklas/capybara)和[poltergeist](https://github.com/jonleighton/poltergeist)但你也可以结账[watirmelon](http://watirmelon.com/tag/headless/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-25T14:33:01.257

我让它使用宝石工作。'headless' 和 'watir-webdriver' 我的 ruby​​ 脚本在终端中完全无头运行。[无头|Watir WebDriver](http://watirwebdriver.com/headless/)

# opengl-es - 用于索引绘图的预排序 3d 文件类型

> ID：15537796
> 
> 赞同：4
> 
> 时间：2013-03-21T01:16:24.247
> 
> 标签：opengl-es, 3d, opengl-es-2.0, file-format

我一直在研究一些与 android 相关的 3d 东西，特别是 opengl ES 2.0。在我的学习路径中，所有（大多数）示例都向您展示了如何获取 obj 文件（wavefront .obj）并从中提取顶点。但是，在进一步阅读后，您会发现 obj 文件和其他一些文件类型（当时流行的文件类型）都决定“走自己的路”，即使大多数 3d 库不能支持独立索引的网格（顶点、法线和法线的单独索引）纹理坐标）这些文件类型无论如何都使用了多个索引网格。

所以无论如何这是我的问题：

我在一个地方读到，一些现有的文件类型可以轻松导入到 opengl 中（即，没有我必须对 obj 文件中的数据执行的所有疯狂的 shuffle 电动幻灯片哈林摇晃的事情）。有谁知道一些支持索引绘图的单个索引的文件类型（opengl / 友好）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-04T09:18:55.183

尝试查看 Quake 的 MD2 格式（这里有很好的教程）[http://tfc.duke.free.fr/old/models/md2.htm](http://tfc.duke.free.fr/old/models/md2.htm)，它是专门为加载到 OpenGL 中而设计的。学习是一件好事，但是它有点老了。

相比之下，OBJ 格式仍然很强大，并且有很多优点（简单性，广泛支持）。看起来您走在正确的道路上，因为您似乎了解该格式具有顶点、法线和纹理坐标的单独索引，因此需要您为顶点数组创建单独的索引缓冲区。

让它正常工作的技巧是使用快速哈希表解决方案来存储/检索“vert/norm/tex”面部描述。（我在 OBJ 导入器上的第一次尝试需要 7 秒来读取 10000 个面部对象，现在已降至 0.5 秒 - 并且可能仍然可以改进！祝你好运！

# bash - Bash反引号转义

> ID：15537800
> 
> 赞同：2
> 
> 时间：2013-03-21T01:16:59.220
> 
> 标签：bash

这是 Bash 变量声明语句：

```
foo='b'`    `'ar' 
```

*效率*低于此：

```
foo='bar' 
```

这种格式化“悬挂”或“对齐”缩进（续行）的方式：

```
a_long_variable_name='a seemingly infinitely long '`
                    `'string requiring continuatio'`
                    `'n on the next line...' 
```

产生子壳，浪费资源，或以任何方式影响性能，除了惹恼那些不喜欢它的形式（反？）可读性的人？

效率如：*计算机*效率，而不是“人类键入许多字符并创建基于空间的无偿维护债务”。

能否轻松证明对性能的影响（或缺乏影响）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T01:24:49.790

```
tester1() {
  for i in {1..1000}; do
    a_long_variable_name='a seemingly infinitely long '`
                        `'string requiring continuation'`
                        `'on the next line...'
    echo $a_long_variable_name > tmp 
  done
}

tester2() {
  for i in {1..1000}; do
    a_long_variable_name="a seemingly infinitely long\
string requiring continuation\
on the next line..."
    echo $a_long_variable_name > tmp 
  done
}

echo tester1
time tester1
echo tester2
time tester2 
```

**结果**

```
tester1

real    0m1.878s
user    0m0.209s
sys     0m0.566s

tester2

real    0m0.335s
user    0m0.026s
sys     0m0.078s 
```

这些都具有与案例 2 相似的时间：

```
read -r -d '' a_long_variable_name <<EOF
    a seemingly infinitely long
    string requiring continuation
    on the next line...
EOF

a_long_variable_name="a seemingly infinitely long\
                      string requiring continuation\
                      on the next line..." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T14:09:39.240

如果我需要它，我可能会这样构建字符串：

```
x='a seemingly infinitely long '
x="$x"'string requiring continuatio'
x="$x"'n on the next line...'

a_long_variable_name="$x" 
```

或该主题的细微变化。或者我会在每一行重复长变量名。这是我使用的真实脚本——它为我列出了相关的环境变量：

```
informix1="DB[^=]|DELIMIDENT=|SQL|ONCONFIG|TBCONFIG|INFOR"
informix2="CLIENT_LOCALE=|GL_|GLS8BITSYS|CC8BITLEVEL|ESQL|FET_BUF_SIZE="
informix3="INF_ROLE_SEP=|NODEFDAC=|ONCONFIG|OPTCOMPIND|PDQ|PSORT"
informix4="PLCONFIG|SERVER_LOCALE|FGL|C4GL|NE_"
informix5="TCL_LIBRARY|TK_LIBRARY|TERM=|TERMCAP=|TERMINFO="
informix="$informix1|$informix2|$informix3|$informix4|$informix5"
system1="COLLCHAR=|LANG=|LC_"
system2="(DY)?LD_LIBRARY_PATH(_[63][42])?=|PATH=|SHLIB_PATH=|LIBPATH="
system="$system1|$system2"
jlss="IX([A-Z]|D(32|64)?)="

env |
${EGREP:-egrep} "^($informix|$system|$jlss)" |
sort 
```

（当 Mac OS X 10.7.x因为它“太大”而停止处理表达式时，切换使用哪个`egrep`程序的能力变得必要。）`egrep`

# javascript - JavaScript 表格点击

> ID：15537803
> 
> 赞同：2
> 
> 时间：2013-03-21T01:17:19.067
> 
> 标签：javascript, onclick, html-table, appendchild

我正在创建一个在表格中显示谚语的游戏。当您单击其中一个字母（或 td）时，它会显示该字母。

在删除空格/作者/等后，我使用 Javascript 创建表。这是我用来创建表的代码。

```
function createRow(tableRowId, startIndex, endIndex) {
    var row = document.getElementById(tableRowId);
    var index = startIndex;

    while(index <= endIndex){
        //hints array contains the letters to be displayed
        if(hints[index] != undefined){
            var newCell = row.insertCell(-1);
            var newText = document.createTextNode(hints[index]);
            newCell.appendChild(newText);
        }
        else{
            break;
        }
        index++;
} 
```

我遇到的问题是 onclick 不能与刚刚创建的 td 一起使用。

```
var cells = document.getElementsByTagName("td");
cells.onclick = function (){
    cells.style.backgroundColor = "white";
} 
```

我一定是错过了一个步骤或什么，也许是我的代码中的一些小错误。也许有更好的方法来做到这一点。所有来源都可以在这里找到。[http://wikisend.com/download/831324/lab4.zip](http://wikisend.com/download/831324/lab4.zip)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:24:32.963

在这里使用 jQuery 而不是直接的 js。我敢打赌，单击事件的侦听器仅绑定到绑定它时存在的项目（onclick 函数）。如果您通过 jQuery 设置侦听器，那么它甚至会在动态添加的组件上触发。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:26:44.337

你尝试过使用 jQuery 吗？

$(document).on('click', 'td', function(e) { cells.style.backgroundColor = "white"; });

我不确定，但我相信如果您不使用框架，则必须将单击功能显式附加到新添加的单元格。单独创建函数可能是最简单的

```
function onClickHandler (){
    cells.style.backgroundColor = "white";
} 
```

将函数附加到 init 上的单元格

```
cells.onclick = onClickHandler; 
```

然后在创建时将其附加到每个元素

```
newCell.onclick = onClickHandler; 
```

不确定是否有更直接的解决方案，希望它有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:32:18.193

哦，实际上，如果您尝试提醒单元格的类型，您将得到为什么没有触发点击的答案。

在这种情况下，`cells`是一个`NodeList`对象，它是一个数组`HTMLTableCellElement`。

您应该迭代单元格并添加 onclick 事件，如下所示：

```
for(var i=0; i<cells.length; i++) {
     cells[i].onclick = function () {
         cells[i].style.backgroundColor = "white";
     }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-21T01:50:19.860

我将使用一种方法进行更新，以将突出显示切换为仅一个单元格。

**编辑**

好的，这是一种删除`blue`类并将其添加到单击的类的方法：

```
// Remember el.attachEvent('onclick', ...) for IE8 and lower
base.addEventListener('click', function delegate(e){
    var cells = tbody.getElementsByClassName('blue'),
        i = 0,
        cell;

    while (cell = cells[i++]) {
        cell.className = cell.className.replace(/\bblue\b/g, '');
    }

    e.target.className += ' blue';
}); 
```

[http://jsfiddle.net/xwgyK/1/](http://jsfiddle.net/xwgyK/1/)

这使用`el.getElementsByClassName()`，大多数现代浏览器和 IE9 及更高版本都支持。当然，另一种选择是做另一个`tbody.getElementsByTagName('td')`，这是普遍支持的。

**编辑 2**

注意，我注意到有时可以不点击 a `TD`，所以我们应该首先检查它，`table`如果它不是 a 则忽略点击`td`：

```
base.addEventListener('click', function delegate(e){
    var cells = tbody.getElementsByClassName('blue'),
        i = 0,
        cell;

    if (e.target.nodeName.toLowerCase() == 'td') {
        while (cell = cells[i++]) {
            cell.className = cell.className.replace(/\bblue\b/g, '');
        }

        e.target.className += ' blue';
    }
}); 
```

[http://jsfiddle.net/xwgyK/2/](http://jsfiddle.net/xwgyK/2/)

**HTML**

```
<table id="base">
    <tbody></tbody>
</table> 
```

**Javascript**

```
var base = document.getElementById('base'),
    tbody = base.getElementsByTagName('tbody')[0],
    numrows = 30,
    numcols = 10,
    col = 0,
    row = "<tr>{row}</tr>",
    rows = "",
    cell = "<td>{cell}</td>",
    cells = "";

// Remember el.attachEvent('onclick', ...) for IE8 and lower
base.addEventListener('click', function delegate(e){
    e.target.style.backgroundColor = 'blue';
});

while (numrows--) {
    cells = "";
    col = 0;

    while (col++ < numcols) {
        cells += cell.replace('{cell}', col);
    }

    rows += row.replace('{row}', cells);
}

tbody.innerHTML = rows; 
```

[http://jsfiddle.net/xwgyK/](http://jsfiddle.net/xwgyK/)

# git - git ignore 在一个分支上，但不在另一个分支上

> ID：15537809
> 
> 赞同：5
> 
> 时间：2013-03-21T01:18:28.543
> 
> 标签：git, github

github上有一个不是我的存储库。我克隆了它，所以现在我的 github 帐户中有它的副本，我的计算机上也有该 repo 的副本。我创建了一个分支，它有自己的目录和大量文件，然后我将它们提交给该分支，称之为苹果。当我切换回主分支时，我在状态中注意到我在苹果上提交的目录和其中的所有文件都显示在状态中。所以现在我有一百多个文件，每次切换到 master 时都是可见的。

我的问题是如何做到这一点，以便当我切换回 master 时，我在苹果分支中的那些文件被忽略？我确定我可以修改 master 中的 .gitignore，但这会改变项目的 .gitignore。

谢谢

**编辑：**评论者指出，如果文件是在另一个分支中提交的，那么当我切换分支时它们不应该出现，这是正确的。在与在这里帮助我的每个人一起工作之后，我发现发生的事情是我在苹果分支上创建的目录中的一个子目录有自己的 .gitignore 忽略了很多文件。那个 .gitignore 是在苹果分支中提交的，当我切换分支（例如到主分支）时，那个目录特定的 .gitignore 消失了，所有最初在苹果分支上被忽略的文件都出现在 git-gui 的任何其他分支中作为未跟踪。所以我有很多我认为在苹果分支上提交的文件，但实际上并没有。对困惑感到抱歉！我会将 Ryan Stewart 的回答标记为正确。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T01:22:30.530

您可以像这样设置自己的“全局忽略”文件：

```
git config --global core.excludesfile ~/.gitignore_global 
```

然后，您可以随意填充`~/.gitignore_global`。此外，您可以编辑

```
.git/info/exclude 
```

就像`.gitignore`但它只适用于那个 .git 存储库。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T01:33:57.427

如果您确实添加了新文件并将它们提交到分支苹果，然后切换回其历史记录中不包含苹果的 master，那么这些新文件将不会显示。关于您对问题的描述的某些内容没有意义。

也许您没有意识到在 git 中，您必须在它们`git add`之前提交文件`git commit`（除非您专门使用`git commit <files>`）？具体来说，如果您在分支苹果上添加目录香蕉，那么您可以执行以下操作：

```
git add banana
git commit -m "added the banana feature"
git checkout master 
```

然后你会在主分支中，没有香蕉。在 a 之后`git checkout apple`，banana 会再次回来，因为它存在于那个分支中。

# ios - 单击 Shinobi 图表时，如何创建和显示标签以显示 X/Y 值？

> ID：15537810
> 
> 赞同：3
> 
> 时间：2013-03-21T01:18:36.287
> 
> 标签：ios, charts, labels, shinobi

当单击 iOS 的 Shinobi 图表中的一个点时，我正在尝试创建和显示带有 X 和 Y 值的标签。

我在这里找到了答案的第一部分 [ShinobiCharts:How can show the X value and Y value when u click the point of the chart](https://stackoverflow.com/questions/14994605/shinobichartshow-can-show-the-x-value-and-y-value-when-u-click-the-point-of-the/15197819#15197819)

```
- (void)sChart:(ShinobiChart *)chart toggledSelectionForSeries:(SChartSeries *)series     nearPoint:(SChartDataPoint *)dataPoint atPixelCoordinate:(CGPoint)pixelPoint{
NSLog(@"x value:%@",dataPoint.xValue);
NSLog(@"y value:%@",dataPoint.yValue);
//here you can create an label to show the x/y values or even can add an annotation 
} 
```

我可以用这个创建文本字符串：

```
[NSString stringWithFormat:@"Amount:%@ from %@", dataPoint.yValue, dataPoint.xValue]; 
```

但是如何使用 Shinobi Charts 创建标签并将这个 NSString 分配给它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T11:02:23.147

与其在用户点击的任何地方放置标签，不如使用已经提供的 SChartCrosshair 类来担心这个问题？您必须为每个系列启用十字准线 - 这样您就可以只在系列的一个子集上使用十字准线（如果您愿意）。您可以像这样在系列上启用十字准线：

```
mySeries.crosshairEnabled = YES; 
```

然后按住图表以激活十字准线。您可以将 SChartCrosshair 子类化并做一些非常酷的事情，例如在其中放置子图表！

十字准线带来了更多内置功能，而不仅仅是在图表中添加和删除标签 - 尽管这也可以。

# php - haml 类名中的条件 php

> ID：15537813
> 
> 赞同：0
> 
> 时间：2013-03-21T01:18:57.487
> 
> 标签：php, haml

我正在尝试在 haml 中为类名添加条件语句。在常规的 html 中，我会这样做。

```
<a href="/" class=linkHeader<?php if($self) { echo ' active'; } ?></a> 
```

我将如何在haml中做到这一点？

```
%a{:class=>"linkHeader", :href => "/"} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T11:59:18.973

你在用什么？哈姆勒？旧的（和破碎的）phamlp ？

我在 MtHaml 上使用它：

```
%a.linkHeader{class: $self ? 'active' : ''} 
```

# ruby-on-rails - 将异常分配给 pry 中的变量

> ID：15537814
> 
> 赞同：0
> 
> 时间：2013-03-21T01:19:04.837
> 
> 标签：ruby-on-rails, pry

因此，我尝试使用 pry 在我的 Rails 应用程序中调试 method_missing 并得到：

```
[5] pry(#<VoyageArrival>)> puts e
NameError: undefined local variable or method `e' for #<VoyageArrival:0x007fa3f30d13c8> 
```

这是我的代码

```
 21: define_method(save_method) do
    22:   if "@#{method_name}".present?
    23:     begin
    24:       self.send("#{attribute}=", Time.parse(instance_variable_get("@#{method_name}")))
    25:     rescue => e
 => 26:       binding.pry 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T03:01:06.297

我听一位同事谈论过类似的事情。[这个](https://stackoverflow.com/a/7348158/326543)（相当老的）答案说 use`pry-rails`而不是`pry`. 这在我们的案例中有效。

更多关于 pry-rails - [https://github.com/rweng/pry-rails](https://github.com/rweng/pry-rails)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T02:18:52.423

我可能是错的，但试着告诉你在拯救什么。例如：

```
rescue Exception => e 
```

让我知道这是否对你有用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T02:04:41.887

您始终可以通过全局变量访问最后一个异常`$!`。看看这是否适用于您的断点。可能是您在某处设置了另一个断点，并且实际上正在调试错误的行。

# c++ - C ++如何将参数包存储为变量

> ID：15537817
> 
> 赞同：25
> 
> 时间：2013-03-21T01:19:27.783
> 
> 标签：c++

目前我在尝试存储参数包时遇到问题，这是设计的示例代码：

```
template<typename Func, typename... Args>
void handleFunc(Func func, Args&&... args) {
    struct nest {
        Func nestFunc;
        Args... nestArgs; // I DONT KNOW WHAT TO DO HERE
        void setup(Func func, Args... args) {
            nestFunc = func;
            nestArgs = (args)...; // SO I CAN SET IT HERE
        }
        // Later I will forward this and run the function with its arguments
        unsigned process() {
            nestFunc(std::forward<Args>(nestArgs)...); // USE IT HERE
            return 0;
        }
    };
    nest* myNest;
    myNest->setup(func, (args)...);
} 
```

这是问题所涉及的所有内容的示例，我需要将参数存储在我的嵌套结构中以供**以后调用。**另外，如果您有存储它的解决方案但设置它与我的不同，也请让我知道。谢谢。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-21T01:26:27.390

**从 2018 年开始编辑**：在 C++17 中，这个问题的答案是不同的。您仍然必须将参数存储在 a 中`::std::tuple`，但是当调用函数时，会处[`::std::apply`](https://en.cppreference.com/w/cpp/utility/apply)理解包此元组并为您调用函数。如果您需要将索引技巧用于其他用途，`::std::apply`那么您应该调查[`::std::integer_sequence`](https://en.cppreference.com/w/cpp/utility/integer_sequence)相关的辅助函数。`::std::make_index_sequence`

现在回到 2013 年的 C++11/14 答案。

您必须使用`::std::tuple<Args...>`它来存储它。但接下来的问题是如何在需要时打开它。为此，您需要使用一种称为“索引”的技术。

所以，这里有一个链接，指向一个我已经完成了你想要做的事情的地方。这里最相关的类是核心部分`suspended_call`。

[https://bitbucket.org/omnifarious/sparkles/src/tip/sparkles/deferred.hpp?at=default](https://bitbucket.org/omnifarious/sparkles/src/tip/sparkles/deferred.hpp?at=default)

稍后，我将提取最相关的部分并将它们放在您的代码中。

[这一行](https://bitbucket.org/omnifarious/sparkles/src/d78af18c74b812d54f7e20146f465c9002a804a7/sparkles/deferred.hpp?at=default#cl-338)：

```
auto saved_args = ::std::make_tuple(::std::move(args)...); 
```

将参数保存到元组中。我在`::std::move`那里使用过，我认为这是正确的做法。但有可能我错了，我应该使用`::std::forward`. 除了信号意图之外，我一直不清楚确切的区别。

可以在[此处](https://bitbucket.org/omnifarious/sparkles/src/d78af18c74b812d54f7e20146f465c9002a804a7/sparkles/deferred.hpp?at=default#cl-208)找到实际使用保存的参数进行调用的代码。现在该代码完全针对我正在做的事情。实现索引技巧的位包括创建一组整数，这些整数映射到索引以用作`::std::get<I>`模板的参数。一旦你有了这个整数包，你就可以使用它来扩展调用以`::std::get`获取所有元组元素作为单独的参数。

我将尝试以相对简单的方式编写代码：

```
#include <tuple>
#include <cstddef>
#include <string>
#include <utility>

template < ::std::size_t... Indices>
struct indices {};

template < ::std::size_t N, ::std::size_t... Is>
struct build_indices : build_indices<N-1, N-1, Is...>
{};

template < ::std::size_t... Is>
struct build_indices<0, Is...> : indices<Is...>
{};

template <typename FuncT, typename ArgTuple, ::std::size_t... Indices>
auto call(const FuncT &f, ArgTuple &&args, const indices<Indices...> &)
   -> decltype(f(::std::get<Indices>(::std::forward<ArgTuple>(args))...))
{
   return ::std::move(f(::std::get<Indices>(::std::forward<ArgTuple>(args))...));
}

template <typename FuncT, typename ArgTuple>
auto call(const FuncT &f, ArgTuple &&args)
     -> decltype(call(f, args,
                      build_indices< ::std::tuple_size<ArgTuple>::value>{}))
{
    const build_indices< ::std::tuple_size<ArgTuple>::value> indices;

    return ::std::move(call(f, ::std::move(args), indices));
}

int myfunc(::std::string name, const unsigned int foo)
{
   return 0;
}

int foo(::std::tuple< ::std::string, const unsigned int> saved_args)
{
   return call(myfunc, ::std::move(saved_args));
} 
```

很多这段代码是从[这个页面上的索引技巧](http://loungecpp.wikidot.com/tips-and-tricks:indices)中借来的。

此外，这是一个样本，您必须稍微适应您的具体情况。基本上，只是在`call(nestFunc, saved_args)`某个地方打电话。

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2016-12-17T17:20:17.770

我知道已经有一段时间了，但我有类似的需求并想出了这个解决方案，希望它可以帮助某人：

```
#include <functional>

template<typename Func, typename... Args>
struct nest {
    std::function<void()> callBack;

    void setup(Func func1, Args... args) {
        callBack = [func1, args...]()
        {
            (func1)(args...);
        };
    }

    unsigned process() {
        callBack();
        return 0;
    }
};

template<typename Func, typename... Args>
void handleFunc(Func func, Args&&... args) {
    nest<Func, Args...> myNest;
    myNest.setup(func, args...);
} 
```

# sql - 动态 SQL 中的日期时间转换/混合变量

> ID：15537819
> 
> 赞同：0
> 
> 时间：2013-03-21T01:19:55.990
> 
> 标签：sql, tsql

我有一个包含多个 DateTime 列的表—— `TblDate1`、、、`TblDate2`等`TblDate3`...

我需要一个接受参数的查询来指定要与另一个日期比较的日期列。

这是我的查询尝试-

```
DECLARE @DateColumn nvarchar(128) SET @DateColumn = 'TblDate2'
DECLARE @DateStart datetime SET @DateStart = DATEADD(d, -7, getdate())

EXECUTE sp_executesql
N'SELECT * FROM MessagesTable WHERE @DateStartIN < @DateColumnIN'
, N'@DateStartIN datetime, @DateColumnIN nvarchar(128)'
, @DateStartIN = @DateStart
, @DateColumnIN = @DateColumn 
```

返回错误 -

```
Msg 241, Level 16, State 1, Line 1
Conversion failed when converting date and/or time from character string. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:34:05.383

试试这个：

```
DECLARE @DateColumn VARCHAR(128)    SET @DateColumn = 'TblDate2'
DECLARE @DateStart  DATETIME    SET @DateStart  = DATEADD(d, -7, GETDATE())

DECLARE @pvsSQL  NVARCHAR(256)
SET @pvsSQL = 'SELECT * FROM MessagesTable WHERE '+ @DateColumn +' < ''' + CONVERT(VARCHAR, @DateStart ) + ''';'

EXECUTE sp_executesql @pvsSQL 
```

# node.js - 无法通过在 Node.js 中添加 ssh-key 来进行 git clone

> ID：15537822
> 
> 赞同：7
> 
> 时间：2013-03-21T01:20:45.130
> 
> 标签：node.js, command-line, ssh-keys

```
 # Write the SSH-KEY to the disk
  fs.writeFile "/cgrepos/.ssh/#{repo.id}.pub", repo.public_key, (err) ->
    throw err if err

    fs.writeFile "/cgrepos/.ssh/#{repo.id}", repo.private_key, (err) ->
      throw err if err

      exec "chmod 400 /cgrepos/.ssh/#{repo.id} && eval `ssh-agent -s` && ssh-add /cgrepos/.ssh/#{repo.id}", (error) ->
        throw error if error
        # First, delete the git repo on the hard drive, if it exists
        exec "rm -rf #{git_location}", options, (error) ->
          throw error if error
          # Second, clone the repo into the location
          console.log "Cloning repo #{repo.id}: #{repo.repo_name} into #{git_location}. This could take a minute"
          exec "git clone #{repo.url} #{git_location}", options, (error) ->
            throw error if error 
```

我正在节点中尝试（`coffee`用于那些很棒的）。但是由于某种原因，当它运行时，它给了我一个错误：`Error: Command failed: conq: repository access denied. deployment key is not associated with the requested repository.`

不知道我做错了什么。如果我直接从命令行运行这些命令，一切似乎都正常。有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-07T11:23:40.513

当您尝试`git clone`从 node.js 执行进程时，它会在不同的环境中运行。

当您`git clone`在受保护的（基于 ssh 协议的）存储库上使用时，`ssh-agent`首先尝试使用提供的公钥对您进行身份验证。由于`exec`每次调用使用不同的运行时环境，即使您明确添加私钥，由于运行时环境不同，它也不会起作用。

在 ssh 中进行身份验证时，git clone 会查找`SSH_AUTH_SOCK`. 通常，此环境变量具有您的密码密钥环服务的路径，例如（gnome-keyring 或 kde-wallet）。

试试这个先检查一下。

```
env | grep -i ssh 
```

它应该列出 SSH_AGENT_PID 和 SSH_AUTH_SOCK。问题是在运行`git clone`这些环境变量时没有设置。因此，您可以将它们设置为 exec 函数调用中的选项（只需 SSH_AUTH_SOCK 就足够了）。[在这里](http://nodejs.org/api/child_process.html#child_process_child_process_exec_command_options_callback)查看如何将 env 密钥对传递给 exec。

```
var exec = require('child_process').exec,
    child;

child = exec('git clone cloneurl', {
  cwd: cwdhere,      // working dir path for git clone
  env: {
           envVar1: envVarValue1,
           SSH_AUTH_SOCK: socketPathHere
       } 
}, callback); 
```

如果这不起作用，请尝试`ssh -vvv user@git-repo-host`在 exec 函数中执行。查看此过程的输出，您会发现错误。

如果错误显示`debug1: No more authentication methods to try. Permission denied (publickey).`，然后像这样将主机别名添加到 $HOME/.ssh/config 文件。

```
Host hostalias
 Hostname git-repo-host
 IdentityFile ~/.ssh/your_private_key_path 
```

这将对指定主机的所有身份验证请求使用提供的私钥。在此选项中，您还可以更改您的`origin's`url 以使用上面文件中配置的 hostalias。 `reporoot/.git/config`文件将如下所示。

```
[remote "origin"]
    url = user@hostalias:repo.git 
```

# node.js - mongojs [错误：连接关闭]

> ID：15537823
> 
> 赞同：0
> 
> 时间：2013-03-21T01:21:08.757
> 
> 标签：node.js, mongodb, socket.io, mongojs

我正在使用 mognojs 版本 0.7.2 和 socket.io，并且工作正常，但是当我有一段时间没有对数据库进行查询时，可能会超时关闭连接，当我再次尝试进行任何查询时，回调响应是 [错误：连接关闭]

我被添加到添加 auto_reconnect 但我得到同样的错误

```
var db = require("mongojs").connect(databaseUrl, collections, {auto_reconnect:true}); 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-25T11:50:31.880

在 mongojs 的 0.7.7 版本中，没有连接到本机 mongodb 驱动层的转发（服务器）选项。在我的意义上，您的 auto_reconnect 在这里毫无用处。我正在寻找解决此问题的方法

# svn - 您如何使用 TortoiseSVN 将分支重新整合到父分支中？

> ID：15537827
> 
> 赞同：1
> 
> 时间：2013-03-21T01:21:22.997
> 
> 标签：svn, tortoisesvn, branching-and-merging

所以，我又遇到了这个问题，并决定听取专家的意见（请只请那些知道他们在说什么的人）。

我从另一个分支（称为 UAT_BRANCH 并且这个主分支是测试版本的主分支）创建了一个分支（DUMMY-BRANCH）。我在 DUMMY-BRANCH 中进行了更改并测试了这些更改，直到我对这些更改感到满意为止。然后是时候将我的更改合并回主分支，在本例中为 UAT_BRANCH，我继续打开 TortoiseSVN 来完成这项工作。[我在合并两棵不同](http://tortoisesvn.net/docs/release/TortoiseSVN_en/tsvn-dug-merge.html)的树上打开了在线手册，然后再次尝试让这个合并的事情正确。我将 UAT_BRANCH 指定为 FROM（起始 URL），将 DUMMY-BRANCH 指定为 TO（结束 ​​URL）。我测试了合并，然后最后进行了实际合并。当我刷新 UAT_BRANCH 并检查我的分支中的更改是否已重新集成时，我发现它没有。现在随后尝试切换 FROM AND TO url 没有产生任何结果，可能导致损坏已经完成或其他原因（我认为重新集成已经发生并且没有撤消它）。

我想要的是对我在这种情况下做错了什么以及如何在 SVN 或实际上是 tortoiseSVN 中实际进行合并的一些明确解释。提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-02T12:27:07.743

似乎您试图通过“合并两个不同的树”来完成错误的场景。您需要“重新集成分支”场景，在您参考的同一在线手册中进行了描述。请注意，您必须对 UAT_BRANCH 工作副本执行合并操作，并将 DUMMY-BRANCH 用作“来自 URL”。此外，您的 Svn 版本必须支持合并跟踪。确保 UAT_BRANCH 的工作副本在合并之前是最新的，然后对其执行“重新集成分支”合并，然后提交更改。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-03T11:01:14.620

在这一点上 - 正如你做了几个意图，也**从**和切换**到**- 不可能确定到底发生了什么以及现在的情况是什么。不过，我会建议以下内容（通过 TortoiseSVN UI 进行操作）。

当你想重新整合一个分支时，你必须：

1.  更新 Trunk 的本地副本（在您的情况下为 UAT_BRANCH）并提交所有更改（如果有）。
2.  将更改***从 Trunk 移植到分支***。为此，您可以选择“合并一系列修订”选项，然后选择主干作为**“要合并的 URL”**。对于**“要合并的修订范围”，**选择分支创建修订号作为范围中的初始版本，并将 HEAD 修订号作为最终版本（或者您可以将此框留空以获得相同的结果）。尝试“测试合并”，如果一切正常，合并它。您现在拥有的是分支的本地副本，其中包含来自主干的所有修订。（如果您使用“合并一系列修订”来做到这一点，似乎您可能是出于第一个意图这样做的）。
3.  如果上一步一切顺利，您就可以***将分支与 Trunk 合并***。现在选择Trunk本地副本的文件夹，然后从*合并*菜单中选择“重新集成分支”，然后为**“来自URL”**选择分支。对于**“工作副本”**，应该出现您本地中继副本的文件夹。同样，在运行真正的合并之前测试合并它。现在你有了一个更新了分支的本地主干副本。如果您提交它，您将对 repo 进行所有更改。

也许，在你所有的尝试之后，你很幸运仍然拥有更新了主干修订版的分支 (DUMMY-BRANCH) 的本地副本。如果是这样，请执行第 3 步。如果不确定，请尝试还原更改（注意不要丢失分支中的工作，复制一份以防万一）并完成所有过程。

祝你好运！

# java - 使用存储在 main.java 之外的 load() 和 save() 方法时遇到问题

> ID：15537838
> 
> 赞同：0
> 
> 时间：2013-03-21T01:22:35.017
> 
> 标签：java, android

这是我的 io.java 文件的样子，其中包含类“io”，其中包含我的方法 load() 和 save()。

```
 package com.myschedules;

 //FILE I/O
 import java.io.*; 
 import android.content.Context;

 public class io {

Context asdf;

//save file 
public  void save(String filename, String data) { 

    try { 
        FileOutputStream fos = asdf.openFileOutput(filename, Context.MODE_PRIVATE); 
        fos.write(data.getBytes()); 
        fos.close(); 
    } 
    catch (Exception ex) { 
    }
}

//load file
public  String load(String filename) {
    try { 
         FileInputStream fis = asdf.openFileInput(filename);
         BufferedReader reader = new BufferedReader(new InputStreamReader(fis));
         String line = null, input="";
         while ((line = reader.readLine()) != null) input += line; 
         reader.close(); fis.close();
         return input; 
    } 
    catch (Exception ex) {
         return ""; 
    }
 } 
```

}

当我在 main 中调用这些方法时，它看起来像这样：

```
 io login_io = new io();
 String login_preferences = login_io.load("login_preferences.dat"); 
```

不幸的是，这只会导致我的应用程序在启动时崩溃。如何将我的 load() 和 save() 函数存储在一个单独的文件中，以免弄乱我的主文件。划分对我自己的组织极为重要。这在其他语言中使用 #include 或 import 调用非常简单，但我在这里迷路了。

编辑：

好的，现在我有另一个问题......这是来自 MainActivity.java 中的。单击按钮后，我想做一些文件 I/O。但是，它最终会在“io login_io = new io(this);”上产生此错误：

“构造函数 io(new View.OnClickListener(){}) 未定义”

```
 cmd_login.setOnClickListener(new OnClickListener()
    {

        public void onClick(View v) 
        {

            io login_io = new io(this);
            String login_preferences = login_io.load("login_preferences.dat"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:27:23.567

您何时为 asdf 分配上下文？如果不是，您将遇到 NullPointerException。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:27:39.040

崩溃可能是`NullPointerException`Context 变量上的`asdf`。您需要`asdf`在构造函数中设置。

**像这样添加构造函数**：

```
// Constructor
public io(final Context context) {
    asdf = context;
}

public void save... // do not change.
public String load... // do not change. 
```

您还必须将 Activity/Context 'this' 变量添加到`io`MainActivity 类中的类的实例化中，如下所示：

**改变**：

```
io login_io = new io(); // Bad :( 
```

**对此**：

```
io login_io = new io(this); // Good :) 
```

PS 我从您下面的评论中了解到 MainActivity.java 是一个 Android Activity 类（即“ `class MainActivity extends Activity`”），因此“this”是正确的类型。这是个好消息。

# c++ - 如何从文件中读取字符并将它们存储到数组中？

> ID：15537840
> 
> 赞同：-1
> 
> 时间：2013-03-21T01:23:00.670
> 
> 标签：c++, arrays, file, character

我正在尝试获取从文件中读取的一组字符并将它们存储到数组中。

假设我正在从字符串`MICHAEL`中提取每个字母`inputFile`：

```
int limit = 7;
for(int number = 0; number < limit; number++){
    inputFile >> stepc_char;
    cout << stepc_char << endl;
} 
```

我想将它们存储到一个数组中。我怎样才能做到这一点？
*（注意我不能用`std::vector`）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:29:05.390

```
I then want to store them into an array 
```

好的，您已经完成了阅读部分，因为您当前的代码已经正确读取。要将值存储到数组中：

```
// (With minimal changes to your code)
char* my_array = new char[limit];
for (int number = 0; number < limit; number++) {
    inputFile >> stepc_char;
    cout << stepc_char << endl;

    my_array[number] = stepc_char;
} 
```

不要忘记`delete[] my_array;`当你完成它时。我像这样分配内存而不是这样做的唯一原因`char my_array[limit];`是因为给定的数组大小必须是恒定的。（这是我可以从我的编译器中得知的）。

如果您不需要无限期地使用该数组，`delete[] my_array;`请在退出范围之前立即执行。

例如，如果上面的代码在 if 块中，它应该是这样的：

```
if (someExpression) {

    char* my_array = new char[limit];
    for (int number = 0; number < limit; number++) {
        inputFile >> stepc_char;
        cout << stepc_char << endl;

        my_array[number] = stepc_char;
    }

    // process character array

    delete[] my_array;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:32:21.067

假设这个序列不会保存一个公共字符串（这意味着这`std::string`不是你要找的），那么***`std::vector`***在这种情况下似乎是保存这个序列的最合适的方式。

但是由于您添加了一个不允许使用的约束`std::string`，那么（为了避免您自己处理内存管理）我建议可变长度数组（如果它们可用）（即如果您使用 GCC ，请参阅[为什么可变长度数组不是 C++ 标准的一部分？](https://stackoverflow.com/q/1887097/1168156)）：

```
char myArray[limit];
for(int i = 0; i < limit; i++)
{
    std::cin >> myArray[i];
} 
```

请注意，在这种情况下`myArray`，是一个具有自动存储持续时间的数组，其生命周期在执行超出其声明的范围时结束。

否则，您将不得不使用动态分配的数组：

```
char* myArray = new char[limit];
for(int i = 0; i < limit; i++)
{
    std::cin >> myArray[i];
}
delete[] myArray;                   // don't forget to clean it up 
```

# jsf - JSF 和 JPA：在持久性/模型层中使用过滤器

> ID：15537844
> 
> 赞同：0
> 
> 时间：2013-03-21T01:23:36.083
> 
> 标签：jsf, jpa, nullpointerexception, servlet-filters

我正在练习 JSF 和 JPA，我正在遵循的示例是模型/持久层的过滤器类：

```
@WebFilter(servletNames = { "Faces Servlet" })
public class JPAFilter implements Filter {

    private EntityManagerFactory factory;

    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        this.factory = Persistence.createEntityManagerFactory("K19-Futebol-PU");
    }

    @Override
    public void destroy() {
        this.factory.close();
    }

    @Override
    public void doFilter(ServletRequest request, ServletResponse response,
            FilterChain chain) throws IOException, ServletException {

        // in
        EntityManager manager = this.factory.createEntityManager();
        request.setAttribute("EntityManager", manager);
        manager.getTransaction().begin();
        // in

        // FACES SERVLET
        chain.doFilter(request, response);
        // FACES SERVLET

        // out
        try {
            manager.getTransaction().commit();
        } catch (Exception e) {
            manager.getTransaction().rollback();
        } finally {
            manager.close();
        }
        // out
    }
} 
```

运行应用程序时出现 NullPointerException：

```
SEVERE: Error Rendering View[/times.xhtml]
javax.el.ELException: /lista-de-times.xhtml @5,51 rendered="#{empty timeBean.times}": java.lang.NullPointerException
    at com.sun.faces.facelets.el.TagValueExpression.getValue(TagValueExpression.java:114)
    at javax.faces.component.ComponentStateHelper.eval(ComponentStateHelper.java:194)

    at filters.JPAFilter.doFilter(JPAFilter.java:42)

    Caused by: java.lang.NullPointerException
    at repositories.TimeRepository.getLista(TimeRepository.java:44)
    at managedbeans.TimeBean.getTimes(TimeBean.java:68)

    ... 43 more

WARNING: StandardWrapperValve[Faces Servlet]: PWC1406: Servlet.service() for servlet Faces Servlet threw exception
java.lang.NullPointerException
    at repositories.TimeRepository.getLista(TimeRepository.java:44)

    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:343)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at filters.JPAFilter.doFilter(JPAFilter.java:42)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:256)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:217)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:279) 
```

这是“存储库”类：

```
public class TimeRepository {

    private EntityManager manager;

    public TimeRepository(EntityManager manager) {
        this.manager = manager;
    }

    public void adiciona(Time time) {
        this.manager.persist(time);
    }

    @SuppressWarnings("unchecked")
    public void remove(Long id) {
        Time time = this.procura(id);
        Query query = this.manager.createQuery("select x from Jogador x");
        List<Jogador> jogadores = query.getResultList();
        for (Jogador jogador : jogadores) {
            jogador.setTime(null);
        }
        this.manager.remove(time);
    }

    public Time atualiza(Time time) {
        return this.manager.merge(time);
    }

    public Time procura(Long id) {
        return this.manager.find(Time.class, id);
    }

    @SuppressWarnings("unchecked")
    public List<Time> getLista() {
        Query query = this.manager.createQuery("select x from Time x");
        return query.getResultList();
    }
} 
```

表中已经有一些数据，我认为问题与 JSF 生命周期和过滤器类有关，但我不知道如何解决。

有人可以帮帮我吗？而且我也很欣赏关于使用所描述的过滤器的评论，我的意思是，这是一个好的做法，一个“优雅的解决方案”吗？

提前致谢。

这是与存储库相关的 TimeBean 类：

```
@ManagedBean
public class TimeBean {

    private Time time = new Time();
    private List<Time> times;

    public void adiciona() {
        EntityManager manager = this.getManager();
        TimeRepository repository = new TimeRepository(manager);
        if (this.time.getId() == null) {
            repository.adiciona(this.time);
        } else {
            repository.atualiza(this.time);
        }
        this.time = new Time();
        this.times = null;
    }

    public void preparaAlteracao() {
        Map< String, String> params =
                FacesContext.getCurrentInstance().getExternalContext().Ã
                - getRequestParameterMap();
        Long id = Long.parseLong(params.get("id"));
        EntityManager manager = this.getManager();
        TimeRepository repository = new TimeRepository(manager);
        this.time = repository.procura(id);
    }

    public void remove() {
        Map< String, String> params =
                FacesContext.getCurrentInstance().getExternalContext().Ã
                - getRequestParameterMap();
        Long id = Long.parseLong(params.get("id"));
        EntityManager manager = this.getManager();
        TimeRepository repository = new TimeRepository(manager);
        repository.remove(id);
        this.times = null;
    }

    public List<Time> getTimes() {
        if (this.times == null) {
            EntityManager manager = this.getManager();
            TimeRepository repository = new TimeRepository(manager);
            this.times = repository.getLista();
        }
        return this.times;
    }

    private EntityManager getManager() {
        FacesContext fc = FacesContext.getCurrentInstance();
        ExternalContext ec = fc.getExternalContext();
        HttpServletRequest request = (HttpServletRequest) ec.getRequest();
        return (EntityManager) request.getAttribute(" EntityManager ");
    }
    // GETTERS E SETTERS
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T17:51:23.813

看起来您获得了一个空 EntityManager，因为您使用不同的标识符字符串来设置和获取请求属性：“EntityManager”与“EntityManager”。尝试在调用 getAttribute 时删除前导和尾随空格（除非它只是代码清单中的错字）。

# sql - SQL查询输出酒店当前客人

> ID：15537845
> 
> 赞同：0
> 
> 时间：2013-03-21T01:23:48.823
> 
> 标签：sql, oracle, join, union

考虑上述关系。我正在尝试列出当前住在酒店的所有客人和家属，这意味着他们在房间里。

这是我的 SQL 查询：

```
SELECT g.FORENAME, g.SURNAME           
    FROM GUEST g
    INNER JOIN BOOKING b 
            ON g.GUESTID = b.GUESTID
    WHERE (b.DEPARTDATE > TO_CHAR(CURRENT_DATE, 'DD-MON-YYYY') AND b.ARRIVEDATE < TO_CHAR(CURRENT_DATE, 'DD-MON-YYYY'))
    UNION   
    SELECT d.FORENAME, d.SURNAME
    FROM DEPENDANT d
    INNER JOIN BOOKINGDEPENDANT bd 
            ON bd.DEPENDANTID = d.DEPENDANTID
    WHERE bd.BOOKINGID IN (SELECT b.BOOKINGID 
                            FROM BOOKING b
                            WHERE (b.DEPARTDATE > TO_CHAR(CURRENT_DATE, 'DD-MON-YYYY') AND b.ARRIVEDATE < TO_CHAR(CURRENT_DATE, 'DD-MON-YYYY'))); 
```

查询执行但不显示*任何行选择*，当它应该时。

**这是我的BOOKING**插入语句。

```
INSERT INTO BOOKING VALUES (2002, 5445, '19-MAR-2013', '10-JUN-2013', 250.00);

INSERT INTO BOOKING VALUES (2004, 3005, '19-MAR-2013', '21-MAR-2013', 250.00); 
```

尽管客人 5445 和 3005 满足其关联预订的 where 条件，但未显示任何输出。我期待 5445 和 3005 的名称。

如果我删除以下行：

```
b.ARRIVEDATE < TO_CHAR(CURRENT_DATE, 'DD-MON-YYYY') 
```

将显示名称列表。但是这个逻辑是错误的，因为如果不考虑，您将无法检测到现在的客人。

我对你的问题是上面的行被错误地添加了吗？为什么在满足条件时不显示那些客人。他们毕竟是现在的客人。我能做些什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T01:33:43.180

我认为问题在于您正在比较字符串而不是日期。

```
'19-MAR-2013' < '21-MAR-2013' => TRUE
'10-JUN-2013' > '21-MAR-2013' => FALSE (as '10...' < '21...') 
```

将您的日期作为日期保存在数据库中。如果您需要将它们作为文本进行比较，或者将它们转换为格式 YYYY-MM-DD（因为这样字符串比较将匹配日期比较。

注意：虽然正确的解决方案是更改您的列以将数据保存为日期，但下面是 SQL 的更正版本，它将与文本列一起使用（尽管远没有那么高效/正确）：

```
SELECT g.FORENAME, g.SURNAME           
FROM GUEST g
INNER JOIN BOOKING b 
    ON g.GUESTID = b.GUESTID
WHERE CURRENT_DATE BETWEEN TO_DATE(b.ARRIVEDATE, 'DD-MON-YYYY') AND TO_DATE(b.DEPARTDATE, 'DD-MON-YYYY')

UNION   

SELECT d.FORENAME, d.SURNAME
FROM DEPENDANT d
INNER JOIN BOOKINGDEPENDANT bd 
    ON bd.DEPENDANTID = d.DEPENDANTID
WHERE bd.BOOKINGID IN 
(
    SELECT b.BOOKINGID 
    FROM BOOKING b
    WHERE CURRENT_DATE BETWEEN TO_DATE(b.ARRIVEDATE, 'DD-MON-YYYY') AND TO_DATE(b.DEPARTDATE, 'DD-MON-YYYY')
); 
```

# r - 在 plyr 中调用不同的列表元素

> ID：15537854
> 
> 赞同：0
> 
> 时间：2013-03-21T01:25:02.947
> 
> 标签：r, plyr

我有一些看起来像这样的代码

```
reps=128
results = llply(1:reps, function(idx){out<-single.imputation(start.data)},.parallel=TRUE) 
```

start.data 是一个列表，其值范围为 1-128。我该如何编码，以便每个 plyr rep 使用不同的列表元素`start.data`？在 for 循环中很明显，但对我来说如何在 plyr 中做到这一点并不明显。如果这是一个愚蠢的问题，请提前道歉。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:32:41.387

您有几个选择（假设 start.data 是一个包含 128 个元素的列表）

指数`start.data`

```
reps=128

results = llply(seq_len(reps), function(idx){
   out<-single.imputation(start.data[[i]])
   },.parallel=TRUE) 
```

或使用 start.data 作为`.data`参数`llply`

```
results <- llply(start.data, function(xx) single.imputation(xx),.parallel = TRUE) 
```

这可以更简单地完成为

```
results <- llply(start.data, single.imputation, .parallel = TRUE) 
```

# python - Tkinter 'label' 小部件 - 换行符随机添加空格

> ID：15537857
> 
> 赞同：1
> 
> 时间：2013-03-21T01:25:07.240
> 
> 标签：python, tkinter, label, newline

我正在尝试制作一个包含我的程序帮助的“标签”小部件。假设我的标签小部件被称为“菜单”，我使用：

```
menu['text'] = '1\. \n2\. \n3\. \n4\. \n5.' 
```

这应该输出如下内容：

```
1.
2.
3.
4.
5. 
```

但是，它输出：

```
1.
 2.
  3.
   4.
5. 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:43:43.480

在创建 时设置`anchor`和`justify`选项`Label`，如下所示：

`myLabel = Label(self, text='1\. \n2\. \n3\. \n4\. \n5.', anchor=W, justify=LEFT)`

`anchor=W`会将您的文本定位在 内的西边（因此是`W`）`Label`，同时`justify=LEFT`确保任何额外的文本行左对齐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-20T13:08:13.780

我有同样的问题。删除代码中的空格。这似乎只是 Python 文件中的格式化问题。

# c# - 连接条码扫描器与微控制器

> ID：15537858
> 
> 赞同：-1
> 
> 时间：2013-03-21T01:25:07.450
> 
> 标签：c#, serial-port, usb, .net-micro-framework

我正在做一个涉及条形码扫描仪、netduino plus 2（微控制器）的项目。我遇到了用于条形码扫描仪的不同类型的接口（使用的针脚标准，例如 USB 等），它们是键盘楔、RS232、USB（再次充当键盘楔或 RS232）。我入围了支持 USB 和 RS 232 的 datalogic QW2170（条形码扫描仪）。USB 接口是即插即用类型。我想知道我是否可以使用USB（使用条形码扫描仪的usb电缆连接到netduino plus 2）接口在扫描条形码（具体为一维条形码）后捕获来自条形码扫描仪的数据流并将其保存在microsd卡中（netduino plus 2 有一个最大 2 GB 的 microsd 卡插槽）或者我是否需要为此目的使用 RS 232 接口。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T02:34:01.290

您将需要 RS232 阅读器 - 您提到的微控制器似乎没有连接 USB 阅读器所需的任何类型的主机模式 USB 功能。如前所述，我相信您会在electronics.stackexchange.com 获得更多信息

# javascript - if 语句无法正常运行

> ID：15537861
> 
> 赞同：1
> 
> 时间：2013-03-21T01:26:19.737
> 
> 标签：javascript, jquery, if-statement

[当折叠项折叠或展开时（ JSFiddle](http://jsfiddle.net/for3v3rforgott3n/Q63Dx/48/)），我似乎无法让我的箭头显示在正确的方向

代码：

```
$('body').on("click", "span#expandcollapse", function ()
{
    $(this).text(function(i, currentText)
    {
        return currentText === 'Expand All' ? 'Collapse All' : 'Expand All';
    });

    if($(this).text() === 'Expand All')
    {
        //Currently collapsed
        if($('.projectscontainer').find("div.destarrow").hasClass('arrow-right'))
            $('.projectscontainer').find('div.destarrow').toggleClass("arrow-right arrow-down");
        $(".projectscontainer").find(".srcprojects").toggle(false);
    } 
    else 
    {
        //Currently expanded
        $(".projectscontainer").find(".srcprojects").toggle(true);
        if($('.projectscontainer').find("div.destarrow").hasClass('arrow-down'))
            $('.projectscontainer').find('div.destarrow').toggleClass("arrow-down arrow-right");
    }
}); 
```

此行未按预期工作：

```
 if($('.projectscontainer').find("div.destarrow").hasClass('arrow-down'))
        $('.projectscontainer').find('div.destarrow').toggleClass("arrow-down arrow-right"); 
```

当我单击全部展开时，项目应该展开（工作），并且箭头应该指向下方（不工作）。当我单击全部折叠时，应该会发生相反的情况。*例如，如果我单击其中一个绿色项目，然后单击全部展开，则单击的项目的箭头方向不同。*

我究竟做错了什么？如果我有一个庞大的列表，这里是否有任何性能问题需要解决？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:51:11.570

**注意：tutiputes 的答案是正确的，请选择他们的答案。**

这是一个工作[小提琴](http://jsfiddle.net/wuqes/1/)

您更改了文本，然后检查其先前的状态以采取相应的行动。

存储文本，更改后再次检查。

```
var currText = $(this).text();
$(this).text(function(i, currentText){
    return currentText === 'Expand All' ? 'Collapse All' : 'Expand All';
});
if(currText === 'Expand All'){//Currently collapsed 
```

此外，您的切换是向后的。您想在折叠时展开，反之亦然。

* * *

您询问了性能问题。

[http://jsfiddle.net/wuqes/2/](http://jsfiddle.net/wuqes/2/)

您可能会考虑存储您的 jQuery 选择器，这样您就不会一直在 DOM 中查找。这不是什么大不了的事，但根据未来项目的规模，它会派上用场。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:45:22.057

这是一个有效的[JSFiddle](http://jsfiddle.net/t2CKf/)。

您的问题实际上是以下代码

```
$('.projectscontainer').find("div.destarrow").hasClass('arrow-right') 
```

在这种特定情况下总是返回 true，因为 $('.projectscontainer').find("div.destarrow") 返回箭头元素数组，其中包含一些带有右箭头的箭头和一些带有向下箭头类的箭头，因此总是返回真。我已经重构了代码以使用过滤器。

# c# - ASP.Net C# 创建一个在午夜过期的 cookie

> ID：15537863
> 
> 赞同：0
> 
> 时间：2013-03-21T01:26:24.400
> 
> 标签：c#, asp.net

我知道如何为 cookie 添加天数，但我不确定如何使用 ASP.Net 和 C# 创建一个在当天午夜过期的 cookie。提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-21T01:29:39.413

这应该这样做：

```
Response.Cookies["Cookie_SessionID"].Expires = DateTime.Today.AddDays(1); 
```

# php - 从 API 调用返回的复杂数组中隔离特定值

> ID：15537866
> 
> 赞同：0
> 
> 时间：2013-03-21T01:26:40.700
> 
> 标签：php, arrays, api

我正在使用语言分类器的 API。我创建分类器，添加两个类，训练它们，然后发送一个要分类的字符串。分类调用的响应是一个数组：

```
$response = $uclassify->classify($bigString, $title);
print_r($response); 
```

在响应上调用 print_r 会打印以下字符串（我已对其进行了标记以尝试理解它）：

```
Array ( 
    [0] => Array ( 
        [id] => Classify12911363801322 
        [classification] => Array ( 
            [0] => Array ( 
                [class] => Cool [p] => **0.636574** 
            ) 
            [1] => Array ( 
                [class] => Uncool [p] => **0.363426** 
            ) 
        ) [text] => 
    )
) 
```

我感兴趣的数组的唯一部分是数字（以粗体突出显示）。如何编写打印语句来提取这两个数字？

编辑：未修改的 print_r：

Array ( [0] => Array ( [id] => Classify12911363801322 [classify] => Array ( [0] => Array ( [class] => Cool [p] => 0.636574 ) [1] => Array ( [ class] => Uncool [p] => 0.363426 ) ) [text] => 海量文本字符串))

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T02:10:04.913

```
$numbers = array();
foreach($response[0]['classification'] as $o){
    $numbers[] = $o['p'];
}
print_r($numbers); 
```

# javascript - Highcharts xAxis之间的多个数据点

> ID：15537871
> 
> 赞同：0
> 
> 时间：2013-03-21T01:27:11.333
> 
> 标签：javascript, highcharts

我正在使用 Highcharts 并试图在 xAxis 上的任何点之间获得多个点。（例如，我希望在 10 月和 11 月之间获得 4 分。）我该怎么做？

我尝试在 y: 上添加 [] 来指定多个值，但这不起作用。我似乎无法得到任何工作，并且在我可以找到的 highcharts 网站上没有任何示例。

[http://jsfiddle.net/wUDBW/1/](http://jsfiddle.net/wUDBW/1/)

```
$(function () {
    var chart;
    $(document).ready(function () {
        chart = new Highcharts.Chart({
            chart: {
                renderTo: 'container',
                type: 'area'
            },
            title: {
                text: "Title"
            },
            credits: {
                enabled: false
            },
            xAxis: {
                categories: ["October", "November", "December", "January", "February", "March"],
                tickmarkPlacement: 'on',
                title: {
                    enabled: false
                }
            },
            yAxis: {
                title: {
                    text: 'Counts'
                },
                labels: {
                    formatter: function () {
                        return this.value;
                    }
                }
            },
            tooltip: {
                formatter: function () {
                    return '<strong>Count:</strong> ' + this.y + '<br><strong>Date:</strong> ' + this.point.date;
                }
            },
            plotOptions: {
                area: {
                    stacking: 'normal',
                    lineColor: '#666666',
                    lineWidth: 1,
                    marker: {
                        lineWidth: 1,
                        lineColor: '#666666'
                    }
                }
            },
            series: [{
                name: 'Views',
                data: [{
                    y: 3,
                    date: 'October 9th, 2012',
                    unlocked: 1,
                    potential: 1,
                }, {
                    y: 5,
                    date: 'October 12th, 2012',
                    unlocked: 1,
                    potential: 2,
                }, {
                    y: 7,
                    date: 'October 14th, 2012',
                    unlocked: 1,
                    potential: 3,
                }, {
                    y: 7,
                    date: 'October 18th, 2012',
                    unlocked: 1,
                    potential: 3,
                }, {
                    y: 7,
                    date: 'October 22nd, 2012',
                    unlocked: 1,
                    potential: 3,
                }, {
                    y: 7,
                    date: 'October 23rd, 2012',
                    unlocked: 1,
                    potential: 3,
                }, ]
            }, {
                name: 'Replies',
                data: [{
                    y: 3,
                    date: 'October 9th, 2012',
                    unlocked: 1,
                    potential: 1,
                }, {
                    y: 5,
                    date: 'October 12th, 2012',
                    unlocked: 1,
                    potential: 2,
                }, {
                    y: 7,
                    date: 'October 14th, 2012',
                    unlocked: 1,
                    potential: 3,
                }, {
                    y: 7,
                    date: 'October 18th, 2012',
                    unlocked: 1,
                    potential: 3,
                }, {
                    y: 7,
                    date: 'October 22nd, 2012',
                    unlocked: 1,
                    potential: 3,
                }, {
                    y: 7,
                    date: 'October 23rd, 2012',
                    unlocked: 1,
                    potential: 3,
                }, ]
            }],
            exporting: {
                enabled: false
            }
        });
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T07:01:33.000

您需要指定 x 轴值

```
data: [{
                y: 3,
                x: Date.UTC(2012, 9, 9)
                date: 'October 9th, 2012',
                unlocked: 1,
                potential: 1,
            }, { 
```

您还需要删除 xaxis 类别，并使 xa 类型为 'datetime' 一个示例在这里[http://www.highcharts.com/demo/spline-irregular-time](http://www.highcharts.com/demo/spline-irregular-time)

# javascript - 我需要在画布元素上使用直接 js 将服务器端图像加载到用户定义的“框架”中-

> ID：15537873
> 
> 赞同：0
> 
> 时间：2013-03-21T01:27:16.167
> 
> 标签：javascript, canvas, loadimage

我有一个画布，允许用户描边一个矩形 - 我需要这个新绘制的矩形成为来自 db 的图像的目标坐标

我希望你们中的一个 JavaScript 绝地武士能*快速*概述或伪编码解决我的 padawan 问题的最合乎逻辑的方法。“帮助我[你的名字]，你是我唯一的希望。” 我现在停下来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T03:17:46.727

我处理这个问题的方法是使用鼠标事件处理程序 rect.startX 和 rect.startY 作为目标（x，y）和目标 w/h 的 rect.width 和 rect.height：

```
document.getElementById("image").onclick= function() {
    context.drawImage(image,rect.startX,rect.startY,rect.w,rect.h);
}; 
```

来自服务器的图像在“图像准备器”函数中处理，该函数将图像加载到它们所在的屏幕外画布上，直到被调用到可见画布上。

# php - 会话超时和自动重定向

> ID：15537874
> 
> 赞同：1
> 
> 时间：2013-03-21T01:27:20.743
> 
> 标签：php, session

当用户单击链接并进入下一页时，它会启动一个长话短说的会话，告诉数据库使该链接不可用。在数据库重置使链接再次可用之前，他们只有 30 分钟的时间来做他们应该在此页面上做的事情。我怎样才能做到这一点，以便用户不能坐在页面上保持链接不可用或单击刷新以留在同一页面上？

所以基本上，有没有一种方法可以自动将用户重定向到另一个页面而无需他们点击任何东西？无论如何，当会话过期时，该页面都应该将它们重定向到另一个页面。

我认为我不能使用它**，因为我希望重定向取决于会话何时到期。**

```
header("Refresh: 60; Location: /path/somepage.php"); 
```

任何帮助都会非常有帮助！

** 编辑，30 分钟是在会话中定义的。所以这一切都与会议有关..

```
$now = time();

$_SESSION['start'] = time(); // taking now page start time
$_SESSION['expire'] = $_SESSION['start'] + (1 * 60) ; // ending a session in 30

$outOfTime = $_SESSION['expire'] - $_SESSION['start'];

if($now > $_SESSION['expire'])
{

    header("Refresh: $outOfTime ; Location: /path/redirect.php");

} 
```

出于测试目的，会话计时器设置为 1 分钟。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:51:04.423

因为页面的硬刷新是不可取的（对用户来说也不是很好！），你必须有 javascript 来定期查询报告页面剩余时间的监听器，或者页面的 unix 日期时间到期。

在受限页面的顶部：

```
session_start();
if (!isset($_SESSION['page_expiry']) || time() < $_SESSION['page_expiry'])
    $_SESSION['page_expiry'] = time() + (60 * 30);
    // render page
} else {
    echo "time's up!";
} 
```

页面本身内部是 javascript，它可能每 30 秒对以下**listener.php进行一次 ajax 调用。**

### 监听器.php

```
session_start();
if (time() > $_SESSION['page_expiry']) echo 'false';
else echo true; 
```

如果 ajax 调用返回 false，则将它们踢出页面。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:44:55.460

我想让你怎么想

> 蜱虫

滴答是在声明块中解析器执行的每 N 条低级语句发生的事件。N 的值是在声明块的指令部分中使用 ticks=N 指定的。使用 register_tick_function() 指定每个刻度上发生的事件。有关更多详细信息，请参见下面的示例。请注意，每个分时可能会发生多个事件。

> register_tick_function -- 注册一个函数以在每个刻度上执行

```
Description
bool register_tick_function ( callback function [, mixed arg [, mixed ...]] ) 
```

注册由 func 命名的函数，以便在调用滴答时执行。此外，您可以将由对象和方法组成的数组作为 func 传递。

> register_tick_function() 示例

```
<?php
declare(ticks=20);
// using a function as the callback
register_tick_function('my_function', true);
// using an object->method
$object = new my_class();
register_tick_function(array(&$object, 'my_method'), true);
?> 
```

**警告 register_tick_function() 不应与线程网络服务器模块一起使用。Ticks 在 ZTS 模式下不起作用，可能会使您的网络服务器崩溃。**

我只是从我的机架上复制的，希望它可以帮助我们社区的任何一个人

```
<?php 
     /**
     *  ************************ NOTICE ***********************************
     *
     *      The use of Timers WILL slow down your script execution time.
     *      By how much is determined by the user implementation.
     *
     *  *******************************************************************
     *
     *  This pacakge contains one class for handling timers in PHP
     *  and enables the handling of callback functions at given intervals
     *  in microseconds (NOT milliseconds like javascript), as well as 
     *  removing said functions from the stack of callable functions.
     *  
     *  The class is dependent on the PHP language construct declare(ticks=N);
     *  where N represents how many "tickable statements" that get processed
     *  before a registered tick function is called and MUST be declared in the top level script, 
     *  not an included file in order to be effective. 
     *
     *  @see http://us.php.net/manual/en/control-structures.declare.php#control-structures.declare.ticks
     *  
     *  The value of N determines
     *  1) how close to perfect accuracy the timers are (probably never be perfect though)
     *  2) how fast the script will be processed
     *  If N == 1 the script will be very close to perfectly accurate, but will run very slow
     *  but if N is set TOO high (like 10000) it may not be very effective or accurate.
     *  It is up to the user to determine what this number should be for their script.
     *
     *  The package also includes 4 functions for simplifying calls to the static methods of the class:
     *      -- setTimeout, setInterval, clearTimeout, clearInterval

    /**
     *  Just for simplifying the Timers::setTimeout method
     *
     *
     *  @param callable | string $func
     *  @param integer $microseconds - remember this is microseconds NOT milliseconds
     *
     *  @return integer
     */
    function setTimeout ($func, $microseconds)
    {
        return Timers::setTimeout($func, $microseconds);
    }

    /**
     *  Just for simplifying the Timers::setInterval method
     *
     *
     *  @param callable | string $func
     *  @param integer $microseconds - remember this is microseconds NOT milliseconds
     *
     *  @return integer
     */
    function setInterval ($func, $microseconds)
    {
        return Timers::setInterval($func, $microseconds);
    }

    /**
     *  Just for simplifying the Timers::clearTimeout method
     *
     *
     *  @param integer $interval - an integer representing the one returned from a call to setTimeout()
     *
     *  @return boolean
     */
    function clearTimeout ($func, $microseconds)
    {
        return Timers::setTimeout($func, $microseconds);
    }

    /**
     *  Just for simplifying the Timers::clearInterval method
     *
     *
     *  @param integer $interval - an integer representing the one returned from a call to setInterval()
     *
     *  @return boolean
     */
    function clearInterval ($interval)
    {
        return Timers::clearInterval($interval);
    }

    /**
     *  This class contains a series of static properties and functions
     *  that enable the creation and execution of timers
     *
     *  @author Sam Shull
     */
    class Timers
    {
        /**
         *  An array of the arrays that represent
         *  the timer information used by Timers::tick
         *
         *  @access private
         *  @staticvar array
         */
        private static $timers = array();

        /**
         *  Tracker of timers
         *
         *
         *  @access private
         *  @staticvar integer
         */
        private static $numTimers = 0;

        /**
         *  An array of the arrays that represent
         *  the interval information used by Timers::tick
         *
         *  @access private
         *  @staticvar array
         */
        private static $intervals = array();

        /**
         *  Tracker of intervals
         *
         *
         *  @access private
         *  @staticvar integer
         */
        private static $numIntervals = 0;

        /**
         *  Used for debugging
         *
         *
         *  @access private
         *  @staticvar integer
         */
        //private static $ticks = 0;

        /**
         *  A utility method called after N number of ticks by the engine
         *  that checks each timer and interval to see if the desired 
         *  number of microseconds have passed and executes the function 
         *  when appropriate
         *
         *  @static
         *  @return void
         */
        public static function tick ()
        {
            //++self::$ticks;

            $time = self::microtime();

            foreach (self::$timers as $position => $timer)
            {
                if ($time >= $timer['time'])
                {
                    call_user_func($timer['function']);
                    unset(self::$timers[$position]);
                }
            }

            foreach (self::$intervals as $position => $timer)
            {
                if ($time >= $timer['time'])
                {
                    call_user_func($timer['function']);
                    self::$intervals[$position]['time'] = self::microtime() + self::$intervals[$position]['microseconds'];
                }
            }
        }

        /**
         *  A utility method for retrieving the most accurate
         *  microtime available
         *
         *  @static
         *  @return float
         */
        public static function microtime ()
        {
            list($m, $s) = explode(' ', microtime());
            return round(((float)$m + (float)$s) * 1000000);
        }

        /**
         *  A utility method that ensures that all the timeouts have been called
         *  and that calls all the intervals one more time
         *
         *
         *  @static
         *  @return void
         */
        public static function shutdown ()
        {
            foreach (self::$timers as $position => $timer)
            {
                call_user_func($timer['function']);
                unset(self::$timers[$position]);
            }

            foreach (self::$intervals as $position => $interval)
            {
                call_user_func($interval['function']);
                unset(self::$intervals[$position]);
            }

            //print "\nticks: " . self::$ticks;
        }

        /**
         *  Add a function to the be executed after ($microseconds) microsecond
         *
         *  @static
         *
         *  @param callable | string $func
         *  @param integer $microseconds - remember microseconds, not miliseconds
         *
         *  @return integer
         */
        public static function setTimeout ($func, $microseconds)
        {
            if (!is_callable($func))
            {
                if (is_string($func))
                {
                    $func = create_function('', $func);
                }
                else
                {
                    throw new InvalidArgumentException();
                }
            }

            self::$timers[++self::$numTimers] = array(
                                                        'time' => self::microtime() + $microseconds, 
                                                        'function' => $func,
                                                    );

            return self::$numTimers;
        }

        /**
         *  Add a function to the be executed every ($microseconds) microsecond
         *
         *  @static
         *
         *  @param callable | string $func
         *  @param integer $microseconds - remember microseconds, not miliseconds
         *
         *  @return integer
         */
        public static function setInterval ($func, $microseconds)
        {
            if (!is_callable($func))
            {
                if (is_string($func))
                {
                    $func = create_function('', $func);
                }
                else
                {
                    throw new InvalidArgumentException();
                }
            }

            self::$intervals[++self::$numIntervals] = array(
                                                                'time' => self::microtime() + $microseconds, 
                                                                'function' => $func,
                                                                'microseconds' => $microseconds,
                                                            );

            return self::$numIntervals;
        }

        /**
         *  Remove a timeout function from the stack
         *
         *  @static
         *
         *  @param integer $timer
         *
         *  @return boolean
         */
        public static function clearTimeout ($timer)
        {
            if (isset(self::$timers[$timer]))
            {
                unset(self::$timers[$timer]);
                return true;
            }

            return false;
        }

        /**
         *  Remove an interval function from the stack
         *
         *  @static
         *
         *  @param integer $interval
         *
         *  @return boolean
         */
        public static function clearInterval ($interval)
        {
            if (isset(self::$intervals[$interval]))
            {
                unset(self::$intervals[$interval]);
                return true;
            }

            return false;
        }
    }

    /**
     *  Register these methods in order to perform polling a specific intervals
     *  that are set by the user
     */
    register_tick_function(array('Timers','tick'));
    register_shutdown_function(array('Timers','shutdown'));

    ?> 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-21T01:43:20.450

您应该有一个系统来检查在用户进入页面并将重定向设置为该长度时运行的会话到期前多长时间。例如：

```
<?php
#some code to get expiration date of session. Make sure it is in a datetime object.
#get difference between current time and expiration time:
$timeleft=$expirationTime-new DateTime('now');
header("Refresh: {$timeleft};Location: http://example.com");
?> 
```

我不擅长日期/时间，所以你可能必须修复这个代码，但这个概念是这个答案的主要意图。

# email - PHP 邮件在 Gmail 中打开，但在 Outlook 中不打开

> ID：15537877
> 
> 赞同：1
> 
> 时间：2013-03-21T01:27:29.010
> 
> 标签：email, outlook, gmail, php

当我使用 PHP 发送邮件时，它在 Gmail 中显示正确，但在 Outlook 中显示不正确。这是一封带有 PDF 附件和一些文本的邮件。PDF 使用 fpdf 创建并作为附件发送，这在 Gmail 和 Outlook 中运行良好。

唯一的问题是，在 Gmail 中，电子邮件的文本显示正确，而在 Outlook 中，它只是一个空白页，文本是一个额外的附件。

这是我的代码：

```
// encode data 
$pdfdoc = $pdf->Output("", "S");
$attachment = chunk_split(base64_encode($pdfdoc));

// email stuff (change data below)
$to = $contactEmail; 
$from = $myEmail; 
$subject = "MySubjectHere"; 
$message = '<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
            "http://www.w3.org/TR/html4/loose.dtd">
            <html><head></head><body>
            <p>Hi '$contactName.',</p><br>
            <p>Please find your pdf attached per your request.</p>
            <p>Feel free to call or email if you have any questions.</p>
            <p>Kind regards,</p><br>
            <p>MyNameHere</p>
            <p><strong>Manager</strong></p>
            <img alt="image" src="http://LinkToImage.png"/>
            <p style="color:#76923c;">
            <strong>P:</strong> 01 2345 6789| 
            <strong>W:</strong> <a href="http://www.example.com" target="_blank">www.example.com</a></p>
            <p style="color:#76923c;">
            <strong>A:</strong> 94 Test Street. 
            </p></body></html>';

// a random hash will be necessary to send mixed content
$separator = md5(time());

// carriage return type (we use a PHP end of line constant)
$eol = PHP_EOL;

// attachment name
$filename = $id."_".str_replace(" ","_",$Name).'.pdf';

// main header
$headers  = "From: ".$from.$eol;
$headers .= "Bcc: ".$from.$eol;
$headers .= "MIME-Version: 1.0".$eol; 
$headers .= "Content-Type: multipart/mixed; boundary=\"".$separator."\"";

// no more headers after this, we start the body! //

$body = "--".$separator.$eol;
$body .= "Content-Transfer-Encoding: 7bit".$eol.$eol;

// message
$body .= "--".$separator.$eol;
$body .= "Content-Type: text/html; charset=\"iso-8859-1\"".$eol;
$body .= "Content-Transfer-Encoding: 8bit".$eol.$eol;
$body .= $message.$eol;

// attachment
$body .= "--".$separator.$eol;
$body .= "Content-Type: application/octet-stream; name=\"".$filename."\"".$eol; 
$body .= "Content-Transfer-Encoding: base64".$eol;
$body .= "Content-Disposition: attachment".$eol.$eol;
$body .= $attachment.$eol;
$body .= "--".$separator."--";

// send message
mail($to, $subject, $body, $headers); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T09:08:11.493

我发现哪里出错了：

```
 $body .= $message.$eol; 
```

应该

```
 $body .= $message.$eol.$eol; 
```

3天后终于找到了！
无论如何，感谢您的回复！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T08:01:32.797

```
$to = $contactEmail; 
$from = $myEmail; 
$boundary = md5(date('r', time()));
$msg  = "This is a multi-part message in MIME format.\n\n";
$msg .= "--$boundary\n";
$msg .= "Content-Type: text/html; charset=utf-8; format=flowed; delsp=yes\n";
$msg .= "Content-Transfer-Encoding: 7bit\n\n";
$msg .= "<h1>Website Enquiry</h1>
            <p><strong>Name:</strong> $name<br />
            <strong>Email:</strong> $email<br />
            <strong>Phone:</strong> $phone<br />
            <strong>Subject Name:</strong> $subject<br />
            <strong>Question:</strong> $question</p>";

$e_headers = "From: " . $from . "\n";
$e_headers .= "MIME-Version: 1.0\n";
$e_headers .= "Content-Type: multipart/mixed; boundary=\"$boundary\"\n";

mail($to, $subject, $msg, $e_headers); 
```

这是我将用于 HTML 联系表单的代码。您不需要通过 PHP_EOL 传递内容，只需通过附件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-03T06:23:32.813

```
$separator = md5(time());
$eol = "\r\n";
$message="";  // Always empty
$mailmessage="<h1>Yes got it</h1>";  //html content

$headers = "From: ".$email.$eol;
$headers .= "Bcc:". $Bcc. "\n";
$headers .= "Cc:". $cc. "\n"; 
$headers .= "Return-Path: <".$email.">\n";
$headers .= "MIME-Version: 1.0" . $eol;
$headers .= "Content-Type: multipart/mixed; boundary=\"" . $separator . "\"" . $eol;
$headers .= "Content-Transfer-Encoding: 7bit" . $eol;

$body .= "--" . $separator . "\r\n";
$body .= "Content-type:text/plain; charset=iso-8859-1\r\n";
$body .= "Content-Transfer-Encoding: 7bit\r\n";
$body .= $message . "\r\n";

$body = "--" . $separator . $eol;
$body .= "Content-type: text/html; charset=\"utf-8\"\r\n";
$body .= "Content-Transfer-Encoding: 8bit\r\n\r\n";
$body .= $mailmessage . $eol.$eol;

$body .= "--" . $separator . $eol;
$body .= "Content-Type: application/octet-stream; name=\"" . $file . "\"" . $eol;
$body .= "Content-Transfer-Encoding: base64" . $eol.$eol;
$body .= "Content-Disposition: attachment" . $eol;
$body .= $content . $eol;
$body .= "--" . $separator . "--";

mail($to, $subject, $body, $headers); 
```

# android - 从列表视图中获取价值

> ID：15537880
> 
> 赞同：0
> 
> 时间：2013-03-21T01:27:38.673
> 
> 标签：android, android-listview

我有一个列表视图。当任何人单击列表时，它会将列表内容显示为

```
{first_name=abc, last_name=xyz, id=1, address=kolkata} 
```

但我希望那些从那个字符串中单独获取这些值的人。

**我的 onListItemClick 列表器**

```
protected void onListItemClick(ListView l, View v, int position, long id) 
{
    super.onListItemClick(l, v, position, id);
    Object o = this.getListAdapter().getItem(position);
    String return_data = o.toString();

    Toast.makeText(this,  ""+return_data, Toast.LENGTH_LONG).show();

} 
```

**添加了包括列表适配器在内的总类**

```
public class showUserInfoListActivity extends ListActivity {

ArrayList<HashMap<String, String>> menuItems = new ArrayList<HashMap<String, String>>();
static final String KEY_ID         = "id";
static final String KEY_FIRST_NAME = "first_name";
static final String KEY_LAST_NAME  = "last_name";
static final String KEY_ADDRESS    = "address";

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.add_user_info_list);

    //---get all Records---
    DataBaseAdapter db = new DataBaseAdapter(this);
    db.open();
    Cursor c = db.getAllRecords();
    if (c.moveToFirst())
    {
        do 
        {          
            HashMap<String, String> map = new HashMap<String, String>();
            // adding each child node to HashMap key => value
            map.put(KEY_ID, c.getString(0));
            map.put(KEY_FIRST_NAME, c.getString(1));
            map.put(KEY_LAST_NAME, " "+c.getString(2));
            map.put(KEY_ADDRESS, c.getString(3));

            // adding HashList to ArrayList
            menuItems.add(map);
        } while (c.moveToNext());
    }
    db.close();

    // Adding menuItems to ListView
    // All filed data are not shown in the list KEY_ID is hidden
    ListAdapter adapter = new SimpleAdapter(this, menuItems,R.layout.user_info_list_item,
                          new String[] { KEY_FIRST_NAME, KEY_LAST_NAME, KEY_ADDRESS, KEY_ID }, 
                          new int[] {R.id.first_name , R.id.last_name, R.id.address});
    setListAdapter(adapter);
}

//On select from the list show data
protected void onListItemClick(ListView l, View v, int position, long id) 
{
    super.onListItemClick(l, v, position, id);
    Object o = this.getListAdapter().getItem(position);
    //String return_data = o.toString();
    MyClass return_data = (MyClass)o;
    Toast.makeText(this,  ""+return_data, Toast.LENGTH_LONG).show();
}

class MyClass{

} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:31:20.313

代替

```
String return_data = o.toString(); 
```

您需要转换`o`为任何类别的对象。

```
MyClass return_data = (MyClass)o; 
```

然后你可以像往常一样访问它的字段并调用它的方法。

在你的情况下：

```
HashMap<String, String> returndata = (HashMap<String, String>) o; 
```

# javascript - 无法阻止缩放

> ID：15537882
> 
> 赞同：0
> 
> 时间：2013-03-21T01:27:40.147
> 
> 标签：javascript, jquery, zooming, jquery-events, viewport

我正在尝试防止使用元视口进行缩放以及`event.prevent` `default()`捏合事件。

我的最终目标是在捏合时运行一个功能，在捏合时运行另一个功能，但是如果捏合/缩小放大/缩小就不会发生这种情况。

所以，我仍然可以在这些页面中使用捏拉放大和缩小：

[http://the-irf.com/hammer/index1.html](http://the-irf.com/hammer/index1.html)

[http://the-irf.com/hammer/index2.html](http://the-irf.com/hammer/index2.html)

如果您可以帮助我防止缩放甚至在捏合和捏合时触发警报，我将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:31:32.080

您没有正确设置元视口标签，应该如下所示：

```
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" /> 
```

我看到了`initial-scale`，`maximum-scale`并且`user-scalable`没有出现在您的元视口标签中

# bash - Bash 变量连接

> ID：15537884
> 
> 赞同：0
> 
> 时间：2013-03-21T01:27:52.767
> 
> 标签：bash

哪种形式最有效？

1)

```
v=''
v+='a'
v+='b'
v+='c' 
```

2)

```
v2='a'` `'b'` `'c' 
```

假设可读性对你来说是完全一样的，这是一个延伸，1）是否意味着创建和丢弃一些不可变的字符串（如在 Python 中）或充当 Java“StringBuffer”并定期扩展缓冲区容量？在 Bash 内部如何处理字符串连接？

如果 2) 对您来说与 1) 一样可读，那么反引号是否会产生子外壳，并且即使作为潜在的“无操作”，它是否会比 1) 中的操作更昂贵？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:59:22.103

好吧，最简单和最有效的机制是选项 0：

```
v="abc" 
```

第一种机制涉及四个分配。

第二种机制很奇怪（而且绝对不可读）。它（名义上）在两个子外壳（两个`` ``部分）中运行一个空命令，并将输出（一个空字符串）与三个常量连接起来。如果 shell 只是简单地执行了反引号命令而没有注意到它们是空的（它不会注意到它并不是不合理的；尝试这是一件奇怪的事情——我不记得在我之前的 30 年中看到过它shell脚本），这肯定要慢得多。

因此，仅给定选项 (1) 和 (2)，请使用选项 (1)，但一般情况下，请使用上面显示的选项 (0)。

你为什么要像那样零碎地建立字符串？您的示例中缺少的内容使原始代码变得合理，但简化后的代码显得不那么明智。

```
v=""
x=$(...)
v="$v$x"
y=$(...)
v="$v$y"
z=$(...)
v="$v$z" 
```

这会更有意义，特别是如果您使用和以后的每个`$x`，和/或使用中间值（可能在由三个点表示的命令中）。所使用的连接表示法适用于任何 Bourne-shell 导数；替代外壳将使用更少的外壳，但可能效率更高（强调“稍微”）。`$y``$z``$v``+=`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T02:11:32.577

可移植且直接的方法是对变量使用双引号和大括号：

```
VARA="beginning text ${VARB} middle text ${VARC}..." 
```

您甚至可以通过这种方式为空变量设置默认值

```
VARA="${VARB:-default text} substring manipulation 1st 3 characters ${VARC:0:3}" 
```

使用大括号可以防止出现 a`$VARa`并且您想编写`${VAR}a`但最终得到的内容的情况 `${VARa}`

# javascript - 从 javascript 计数器制作进度条

> ID：15537886
> 
> 赞同：0
> 
> 时间：2013-03-21T01:28:04.497
> 
> 标签：javascript, html, css

我有一个从函数中获取时间的 javascript 函数。它就像一个计数器，从 00:00 开始，一直持续到固定时间。计时器可以通过按钮暂停/恢复。它工作正常。

javascript函数给出了经过的时间和总时间！

现在我有两个 CSS：

```
#seek-bg and #seek-bar 
```

我想水平移动 seek-bg 上的搜索栏。没有jquery可以这样做吗？

如何连接计时器和这些 CSS？

**代码！**

```
#seek-bg {
    height:3px;
    background-color:black;
    width:100px;
    position:relative;
}

#seek-bar{
    background-color:white;
    width:4px;
    height:3px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:36:47.060

> 我想水平移动 seek-bg 上的搜索栏。没有jquery可以这样做吗？

对的，这是可能的。看一下 HTML5 进度条：

```
<progress value="10" max="100"></progress> 
```

[http://www.hongkiat.com/blog/html5-progress-bar/](http://www.hongkiat.com/blog/html5-progress-bar/)

[**演示**](http://demo.hongkiat.com/html5-progress-bar/)

# twitter - 是否可以从小型嵌入式系统发布 Twitter“推文”？

> ID：15537888
> 
> 赞同：1
> 
> 时间：2013-03-21T01:28:09.193
> 
> 标签：twitter, embedded

我能找到的一切都假设我可以使用一些“大型”Twitter API，或者运行 PHP 代码。我有一个基于 ARM M0+ 裸机（无操作系统）的非常小的平台，并希望该设备发布“推文”。

例如，我所看到的一切都意味着我必须使用 SSL 连接——在这个小型处理器上，这可能是可能的，但不是很现实。也不是处理 OAuth 等。

我的倾向是在我的家庭服务器上创建我自己的“服务”，它可以接受用户名和密码以及推文，然后代表嵌入式设备完成所有繁重的工作，但这对我来说似乎是一个警察。

发推特真的有那么难吗？

[编辑：我自己用 C 语言编写代码，级别很低]

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T00:28:24.773

好吧，看起来答案是：“公主吧” - 那里没有一个众所周知的轻量级推文制造商。

我必须决定是否应该通过 PC 代理我的帖子，或者尝试在我的小板上支持 SSL 并支持 Twitter API。

感谢您的考虑！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:39:15.903

如果我是你，我会从这里开始： [https ://dev.twitter.com/docs/api/1.1/post/statuses/update](https://dev.twitter.com/docs/api/1.1/post/statuses/update)

# forms - Wicket：在表单内使用列表视图提交数据

> ID：15537889
> 
> 赞同：1
> 
> 时间：2013-03-21T01:28:12.753
> 
> 标签：forms, listview, dynamic, wicket

我有以下问题：

想象一个看起来像这样的检票口列表视图：

```
ListView<Question> lvQuestion = new ListView<Question>("lvQuestion",
            questions) {

        private static final long serialVersionUID = 1L;

        @Override
        protected void populateItem(ListItem<Question> item) {
            Question q = item.getModelObject();
            item.add(new Label("question", q.getQuestion()));

            List<String> possibleAnswers = getFromDb();

            q.setPossibleAnswers(possibleAnswers);
            if(q.getComponent().equals("dropDown")){
                item.add(new DropDownPanel("questionComponent", q));
            }

        }
    }; 
```

这个列表视图是在表单组件中创建的；我需要做的是使用此列表视图回答每个问题并将它们记录在数据库中。

但问题是我不知道会有多少下拉面板，所以总是会返回一组动态的问题。

有没有办法确保在提交父表单时列表视图中的每个模型都提交到数据库。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:17:51.637

对于这些情况，我所做的是为每个问题维护一个带有所选选项的哈希图。我用 AjaxFormComponentUpdatingBehavior 更新它，如下所示：首先，声明和初始化地图（可能有更有效的方法）

```
Map<Question, String> qMap = new HashMap<>();
for(Question q : questions) {
    qMap.put(q, "");
} 
```

然后，更新 ListView 中的地图（您可能希望在初始化时将 q 设置为 final）

```
if(q.getComponent().equals("dropDown")) {
    DropDownPanel ddp = new DropDownPanel("questionComponent", q);
    ddp.add(new AjaxFormComponentUpdatingBehavior("onchange") {
        @Override
        protected void onUpdate(AjaxRequestTarget art) {
            String answer = (String) getFormComponent().getConvertedInput();
            qMap.put(q, answer);
        }
    }
    item.add(ddp);
} 
```

这使您可以使 qMap 保持最新并在提交表单时对其进行处理。

或者，如果您有一个 String 属性来保存 Question 对象的答案，并且您确保 ListView.list 和您的 List 问题保持一致，则可以在 onUpdate() 中执行以下操作而无需映射：

```
q.setAnswer(answer);
questions.set(item.getIndex(), q); 
```

在这种情况下，您只需处理表单的 onSubmit() 中的问题列表。

# c - 函数中结构指针的范围

> ID：15537890
> 
> 赞同：1
> 
> 时间：2013-03-21T01:28:14.290
> 
> 标签：c, pointers, struct, heap-memory, function-pointers

如果我在函数中有以下内容：

```
struct example *A=malloc(sizeof(struct example)); 
```

在函数结束/离开后，A 指向的节点/内存空间是否被销毁？还是留在堆中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:31:49.297

编号分配的内存`malloc`将一直分配到`free`'d。

做这样的事情：

```
char * function(void)
{
    char c = 'a';
    return &c;
} 
```

另一方面，这很糟糕，因为当函数结束时，这个对象确实超出了范围。

`malloc`在堆上分配内存。声明变量会在堆栈上分配空间。栈受作用域影响，堆则不受。

有关指针使用的更多信息，包括各种陷阱，例如内存泄漏（丢失对`malloc`'d 内存的引用以使其永远存在的过程），请访问[此链接](http://www.ibm.com/developerworks/aix/library/au-toughgame/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:31:57.827

你必须对`free`你的一切`malloc`。当您的函数返回时，变量`A`超出范围，但您的内存保持分配状态。由于您丢失了指向内存的指针（除非存储在其他地方），因此您正在[泄漏内存](http://en.wikipedia.org/wiki/Memory_leak)。

如果您仍然需要 指向的内存`A`，您可以返回指向已分配结构的指针，然后释放它。如果函数返回后不需要分配的内存，请使用`free(A)`.

# sql - PostgreSQL SELECT 必须匹配多行

> ID：15537892
> 
> 赞同：4
> 
> 时间：2013-03-21T01:28:25.620
> 
> 标签：sql, postgresql, select, postgresql-9.1

我有一个表，其中包含一对表示时间跨度的时间戳。这些行由用户 ID 限定，每个用户可以有一个或多个与其关联的行。

该数据是从一个抽象的“可用性”表单生成的，该表单表示用户在一周内何时有空。我需要输入一系列时间范围作为查询并返回表中*所有行都*匹配的所有用户 ID。

鉴于此表：

```
CREATE TABLE "public"."availability" (
  "id" int4 NOT NULL,
  "user_id" int4,
  "starts_at" timestamp(6),
  "ends_at" timestamp(6),
  PRIMARY KEY ("id")
) WITH (OIDS=FALSE) 
```

这个数据：

```
User #1 is available Mon-Tue between 08:00 and 17:00

+----+---------+---------------------+---------------------+
| id | user_id | starts_at           | ends_at             |
+----+---------+---------------------+---------------------+
| 1  | 1       | 2013-03-18 08:00:00 | 2013-03-18 17:00:00 |
+----+---------+---------------------+---------------------+
| 2  | 1       | 2013-03-19 08:00:00 | 2013-03-19 17:00:00 |
+----+---------+---------------------+---------------------+

User #2 is available Sun-Sat all day

+----+---------+---------------------+---------------------+
| 3  | 2       | 2013-03-17 00:00:00 | 2013-03-23 23:59:59 |
+----+---------+---------------------+---------------------+

User #3 is available Wed between 06:00 and 18:00

+----+---------+---------------------+---------------------+
| 4  | 3       | 2013-03-20 06:00:00 | 2013-03-20 18:00:00 |
+----+---------+---------------------+---------------------+ 
```

我可以轻松地选择可用于*任何*给定时间戳的用户：

```
SELECT * FROM "public"."availability"
  WHERE ('2013-03-19 08:35:00' BETWEEN starts_at AND ends_at 
     AND '2013-03-19 18:25:00' BETWEEN starts_at AND ends_at)
    OR  ('2013-03-20 12:00:00' BETWEEN starts_at AND ends_at
     AND '2013-03-20 18:00:00' BETWEEN starts_at AND ends_at);

+----+---------+---------------------+---------------------+
| id | user_id | starts_at           | ends_at             |
+----+---------+---------------------+---------------------+
| 3  | 2       | 2013-03-17 00:00:00 | 2013-03-23 23:59:59 |
+----+---------+---------------------+---------------------+
| 4  | 3       | 2013-03-20 06:00:00 | 2013-03-20 18:00:00 |
+----+---------+---------------------+---------------------+ 
```

但我真正需要的是能够查询多个时间跨度并仅返回与**所有**条件`user_id`匹配的 s 。

 **查询：`2013-03-17 10:00:00`- `2013-03-17 16:00:00`，`2013-03-23 10:00:00`-`2013-03-23 16:00:00`应该返回：

```
+----+---------+---------------------+---------------------+
| id | user_id | starts_at           | ends_at             |
+----+---------+---------------------+---------------------+
| 3  | 2       | 2013-03-17 00:00:00 | 2013-03-23 23:59:59 |
+----+---------+---------------------+---------------------+ 
```

查询：`2013-03-18 09:00:00`- `2013-03-18 16:00:00`，`2013-03-19 08:00:00`-`2013-03-19 15:45:00`应该返回：

```
+----+---------+---------------------+---------------------+
| id | user_id | starts_at           | ends_at             |
+----+---------+---------------------+---------------------+
| 1  | 1       | 2013-03-18 08:00:00 | 2013-03-18 17:00:00 |
+----+---------+---------------------+---------------------+
| 2  | 1       | 2013-03-19 08:00:00 | 2013-03-19 17:00:00 |
+----+---------+---------------------+---------------------+
| 3  | 2       | 2013-03-17 00:00:00 | 2013-03-23 23:59:59 |
+----+---------+---------------------+---------------------+ 
```

查询：`2013-03-18 07:00:00`-`2013-03-18 18:00:00`应该什么都不返回。

[SQLFiddle 示例](http://sqlfiddle.com/#!1/e5724/4/0)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-21T21:21:02.877

对于这样的应用程序，如果您使用的是 PostgreSQL 9.2 或更高版本，您可能想尝试使用[range type](http://www.postgresql.org/docs/current/static/rangetypes.html)。以下是创建、加载和显示数据的示例：

```
CREATE TABLE availability (
  id      int4 NOT NULL,
  user_id int4,
  avail   tstzrange,
  PRIMARY KEY (id)
);
INSERT INTO availability VALUES
  (1, 1, '[2013-03-18 08:00:00, 2013-03-18 17:00:00)'),
  (2, 1, '[2013-03-19 08:00:00, 2013-03-19 17:00:00)'),
  (3, 2, '[2013-03-17 00:00:00, 2013-03-23 24:00:00)'),
  (4, 3, '[2013-03-20 06:00:00, 2013-03-20 18:00:00)');
SELECT * FROM availability ; 
```

```
编号 | 用户 ID | 利用                        
----+----------+------------------------------------ ------------------
  1 | 1 | ["2013-03-18 08:00:00-05","2013-03-18 17:00:00-05")
  2 | 1 | ["2013-03-19 08:00:00-05","2013-03-19 17:00:00-05")
  3 | 2 | ["2013-03-17 00:00:00-05","2013-03-24 00:00:00-05")
  4 | 3 | ["2013-03-20 06:00:00-05","2013-03-20 18:00:00-05")
(4 行)

```

然后您可以使用各种运算符进行查询。如果您想要包含*任何*指定查询范围的所有可用性范围：

```
SELECT * FROM availability
  WHERE avail @> '[2013-03-19 08:35:00, 2013-03-19 18:25:00)'
     OR avail @> '[2013-03-20 12:00:00, 2013-03-20 18:00:00)'; 
```

或者：

```
SELECT * FROM availability
  WHERE avail @> ANY
          (ARRAY ['[2013-03-19 08:35:00, 2013-03-19 18:25:00)'::tstzrange,
                  '[2013-03-20 12:00:00, 2013-03-20 18:00:00)'::tstzrange]); 
```

```
编号 | 用户 ID | 利用                        
----+----------+------------------------------------ ------------------
  3 | 2 | ["2013-03-17 00:00:00-05","2013-03-24 00:00:00-05")
  4 | 3 | ["2013-03-20 06:00:00-05","2013-03-20 18:00:00-05")
(2 行)

```

*如果您想要在单个范围内*包含*所有*指定查询范围的所有可用性范围：

 *```
SELECT * FROM availability
  WHERE avail @> '[2013-03-17 10:00:00, 2013-03-17 16:00:00)'
    AND avail @> '[2013-03-23 10:00:00, 2013-03-23 16:00:00)'; 
```

或者：

```
SELECT * FROM availability
  WHERE avail @> ALL
          (ARRAY ['[2013-03-17 10:00:00, 2013-03-17 16:00:00)'::tstzrange,
                  '[2013-03-23 10:00:00, 2013-03-23 16:00:00)'::tstzrange]); 
```

```
编号 | 用户 ID | 利用                        
----+----------+------------------------------------ ------------------
  3 | 2 | ["2013-03-17 00:00:00-05","2013-03-24 00:00:00-05")
(1 行)

```

如果您想要包含*任何*指定查询范围的所有可用性范围，**但仅适用于具有覆盖*所有*指定查询范围的**可用性范围的用户：

```
WITH s(ts) AS
(
  VALUES
    ('[2013-03-18 09:00:00, 2013-03-18 16:00:00)'::tstzrange),
    ('[2013-03-19 08:00:00, 2013-03-19 15:45:00)'::tstzrange)
)
SELECT DISTINCT a1.*
  FROM s s1
  JOIN availability a1 ON a1.avail @> s1.ts
    AND NOT EXISTS
        (
          SELECT * FROM s s2
            WHERE NOT EXISTS
                  (
                    SELECT * FROM availability a2
                      WHERE a2.user_id = a1.user_id
                        AND a2.avail @> s2.ts
                  )
        ); 
```

或（调整 Clodoaldo Neto 的查询以使用范围）：

```
SELECT a.*
  FROM availability a
  JOIN (
         SELECT
             user_id,
             sum(('[2013-03-18 09:00:00, 2013-03-18 16:00:00)'::tstzrange
                   <@ avail)::integer
                 +
                 ('[2013-03-19 08:00:00, 2013-03-19 15:45:00)'::tstzrange
                   <@ avail)::integer
                ) period
           FROM availability
           GROUP BY user_id
       ) s ON a.user_id = s.user_id
  WHERE period >= 2; 
```

您可以创建一个索引，以便在大型表上非常快速地进行此类搜索，如下所示：

```
CREATE INDEX availability_avail ON availability USING gist (avail); 
```

笔记：

*   为了便于阅读，我省略了架构和引号。
*   索引不太可能与四行一起使用，因为通过直接读取一个数据页可以更快地获得所有数据。对于大桌子，它可能会产生很大的不同。
*   我使用范围是`TIMESTAMP WITH TIME ZONE`因为默认（裸机）`TIMESTAMP`时钟每年在夏令时结束时向后移动。要及时捕捉瞬间，请使用`TIMESTAMP WITH TIME ZONE`（`timestamptz`简称）。
*   直接使用时，字面量不需要显式转换；当使用查询的`ANY`or`ALL`形式时，需要显式转换。
*   范围上的方括号表示该范围*包括*相邻时间，而圆括号表示该范围*不包括*相邻时间。时间戳通常被指定为`[)`使得以给定时间结束的范围和以相同时间开始的另一个范围被认为是*相邻*的而不是*重叠*的。
*   `'24:00:00'`一个日期和`'00:00:00'`下一个日期是同一时刻。
*   前面两点允许更轻松地指定在午夜结束的时间戳。不存在“失去一秒”或其他陌生感的风险。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T16:04:00.353

[SQL小提琴](http://sqlfiddle.com/#!1/e5724/13)

这利用了布尔转换为整数作为 0 或 1。

```
select a.*
from
    availability a
    inner join
    (
        select
            user_id,
            sum (
                ('2013-03-18 09:00:00' between starts_at and ends_at
                 and
                 '2013-03-18 16:00:00' between starts_at and ends_at
                )::integer
                +
                ('2013-03-19 08:00:00' between starts_at and ends_at
                 and
                 '2013-03-19 15:45:00' between starts_at and ends_at
                )::integer
            ) period
        from availability
        group by user_id
    ) s on a.user_id = s.user_id
where period >= 2 
```

将条件更改为`where`要匹配的句点数。***

# xml - 为某些模式 Grep 一个 XML 文件

> ID：15537898
> 
> 赞同：1
> 
> 时间：2013-03-21T01:29:37.537
> 
> 标签：xml, linux, grep

我有一个包含数万个相同元素的大型 XML 文件：

```
<rootElem>
    <fizz buzz="true">234</fizz>
    <fizz buzz="false">384</fizz>
    <fizz buzz="true"></fizz>
    <fizz buzz="true">39494</fizz>
    <fizz/>
</rootElem> 
```

我想运行一个`grep`打印出任何`<fizz>`不包含文本/正文数据的元素（开始和结束标签之间的数字）。在上面的示例中，`grep`将为`<fizz>`不包含数字数据的第 3 和第 5 个元素生成 2 行。文件名为`fizzes_20.xml`. 我尝试运行以下但无济于事：

*   `grep fizzes_20.xml "></>"`
*   `grep fizzes_20.xml "/>"`

有任何想法吗？提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T02:14:48.740

xmllint 命令可用于实现空节点的 xpath 表达式测试：

```
$ xmllint --xpath "//fizz[not(text())]" data.xml 
<fizz buzz="true"/><fizz/> 
```

# 更新

```
$ xmllint --version
xmllint: using libxml version 20901
   compiled with: Threads Tree Output Push Reader Patterns Writer SAXv1 FTP HTTP DTDValid HTML Legacy C14N Catalog XPath XPointer XInclude Iconv ISO8859X Unicode Regexps Automata Expr Schemas Schematron Modules Debug Zlib Lzma 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:39:09.553

使用这种模式很容易实现：

```
grep -E '<fizz/>|<fizz.*><' fizzes_20.xml 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:41:42.497

试试这个命令：

```
egrep '<fizz.*(/>|></fizz>)' fizzes_20.xml 
```

`<fizz`匹配标签开头和标题，匹配`.*`任何属性，括号中的最后一部分匹配自闭合标签或没有内容的标签。希望这可以帮助！

# c# - 有没有办法防止 png/jpg 图像被转换为 位图图像

> ID：15537901
> 
> 赞同：1
> 
> 时间：2013-03-21T01:29:53.117
> 
> 标签：c#, windows-8

我正在制作一个 C#/WPF/Windows 8 App Store 应用程序，我正在尝试加载一些 PNG/JPG 以在视图中显示它们。这些图像的分辨率都相当高，但文件大小通常只有 200k 左右。问题是，当我使用 BitmapImage 类（这是我能找到的唯一一个）加载它们时，使用的总内存会上升到 100 兆。据我所知，它采用 png/jpb 并将其转换为位图图像，这大大增加了内存使用量。到目前为止，我还没有找到解决此问题的方法，尽管似乎应该有一个简单的解决方案。

有什么很明显的我想念的吗？

我的代码如下

```
private async Task TestFunction(IReadOnlyList<StorageFile> files)
{
  var images = new ObservableCollection<Image>();
  imagePanel.ItemsSource = coverImages;
  foreach (var file in files)
  {

    var bitmap = new BitmapImage();
    var item = await file.OpenAsync(FileAccessMode.Read);
    bitmap.SetSource(item);
    var image = new Image();
    image.Source = bitmap;
    image.Height = 200;

    images.Add(image);
  }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T02:06:30.480

如果磁盘上的图像是压缩格式（并且大多数图像文件格式使用某种形式的压缩），内存占用会更大。

如果图像大小为 100x100 像素并使用 8 位颜色深度，则该图像的原始数据将占用 100x100=10,000 字节，这就是必须呈现到屏幕上的数据量。

如果您正在寻找一种方法来减少 WPF 应用程序中的内存使用，您可以尝试一些选项。

1.  不要将图像缓存在内存中，或者选择加载图像的最佳时间，使用`BitmapCacheOption`例如：`bitmap.CacheOption = BitmapCacheOption.None` 这将根据需要从磁盘填充图像，如果图像只有 200k，性能下降应该不会太糟糕，但它不会像缓存一样快

2.  确保您渲染的图像不会比他们需要的大，如果`Element`您要显示的图像是 200x200 并且图像是 1024x768，您可以设置`DecodePixelWidth`，这将创建 `Bitmap`您定义的大小而不是实际大小。例如：`bitmap.DecodePixelWidth = 200`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-21T02:07:46.093

PNG、JPG 和所有其他形式的图像压缩仅用于存储。为了在 WPF 中显示压缩的图像内容，您必须将其解压缩为位图，这是图像数据的原始一对一表示。

如果您不将解压后的图像数据存储在内存中，那么每次系统尝试引用图像进行显示时，都必须再次解压图像，使用宝贵的 CPU 资源。对于PNG或JPG等流行格式，压缩和解压缩过程相当复杂。

有一些图像压缩格式是为动态解压缩而设计的。但是，这些格式（例如 DXT1-5）通常仅受 3D 库支持。（[更多信息在这里](http://en.wikipedia.org/wiki/S3_Texture_Compression#DXT4_and_DXT5)）

# node.js - 我们如何使用 node.js 映射路径连接

> ID：15537903
> 
> 赞同：1
> 
> 时间：2013-03-21T01:29:59.350
> 
> 标签：node.js, connect, middleware, gruntjs

我们如何使用 node.js 连接中间件将某个路径映射到另一个路径？

例如，我希望我的服务器`fileA`在请求`fileB`.

*（用于内部使用`grunt-contrib-connect`）*

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-03T02:56:15.373

我有一个愚蠢的方法，但它是一种方法！

```
copy: {
    "mount-server": {
        files: [{
            expand: true,
            dot: true,
            cwd: '<%= yeoman.app %>',
            dest: './.mount-server/search/mobileqq/',
            src: [
               '**/**'
            ]
        }]
    }
}
     connect: {
        options: {
            port: 80,
            // change this to '0.0.0.0' to access the server from outside
            hostname: null
        },
        livereload: {
            options: {
                middleware: function (connect, options) {
                    return [
                        lrSnippet,
                        mountFolder(connect, '.tmp'),
                        mountFolder(connect, "./.mount-server/")
                    ];
                }
            }
        }
   }

grunt.registerTask('prepareServer', [
    "clean:mount-server",
    "copy:mount-server"
]);
grunt.registerTask('server', function (target) {
    if (target === 'dist') {
        return grunt.task.run(['build', 'open', 'connect:dist:keepalive']);
    }

    grunt.task.run([
        'concurrent:server',
        "prepareServer",
        'connect:livereload',
        'open:server',
        'watch'
    ]);
}); 
```

只需复制您的文件并制作另一个安装文件夹！

# git - 从 git 历史记录中删除敏感数据但不删除文件

> ID：15537904
> 
> 赞同：7
> 
> 时间：2013-03-21T01:30:02.637
> 
> 标签：git, version-control, github

我有一个曾经包含敏感配置信息的文件。我将该配置信息移到另一个不受版本控制的文件中。我想将另一个文件保留在版本控制之下，但我想删除它的历史记录，因为人们可以轻松地浏览 github 上的源代码并在以前的提交中找到敏感信息。最好的方法是什么？我只看到如何从版本控制中删除文件本身并清除其历史记录。

git有点新，所以请原谅新手。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:38:05.530

你可能想看看这篇文章[https://help.github.com/articles/remove-sensitive-data](https://help.github.com/articles/remove-sensitive-data)

差不多说这个命令

```
git filter-branch --force --index-filter 'git rm --cached --ignore-unmatch Rakefile' \
  --prune-empty --tag-name-filter cat -- --all 
```

`Rakefile`将从 git中删除历史记录。但是，他们继续将该文件添加到他们的 gitignore 中。您可能应该跳过该部分，因为您希望将文件保留在版本控制中。

# sql - LEFT OUTER JOIN + RIGHT OUTER JOIN 和 FULL OUTER JOIN 一样吗？

> ID：15537906
> 
> 赞同：1
> 
> 时间：2013-03-21T01:30:09.940
> 
> 标签：sql, sqlite

当然随着骗子的崩溃。

我需要在 SQLite 中进行 FULL OUTER JOIN，但它似乎不支持它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:37:00.960

尝试

```
Left Outer Join 

UNION

Right Outer Join 
```

他们是一样的。

# php - 为每个新用户创建一个新数据库的 PHP 脚本注册表单

> ID：15537908
> 
> 赞同：0
> 
> 时间：2013-03-21T01:30:22.557
> 
> 标签：php, mysql, database, amazon-web-services

我需要为我正在制作的 Web 应用程序创建一个注册页面，并且在注册脚本后，该脚本将为我的虚拟主机（Amazon ASW）上的用户创建一个新数据库，有谁知道如何制作一个简单的 PHP 脚本来获取价值并添加他们到一个预定义的数据库？

# svg - “任意形状”是什么意思？

> ID：15537912
> 
> 赞同：0
> 
> 时间：2013-03-21T01:30:36.120
> 
> 标签：svg

我已经开始研究 SVG 图形，并且经常遇到“任意形状”这个词。

究竟什么是任意形状？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:33:29.330

一个`arbitrary shape`就是这样..一个任意的形状。

在这种情况下，任意一词的含义`any`如下：**不是指定的或特定的形状**。

虽然这不是一个真正的编程问题.. 而是一个英语问题。

# xml - 如何从 XML 文档中找到带有 XPath 查询的祖先元素？

> ID：15537928
> 
> 赞同：2
> 
> 时间：2013-03-21T01:32:21.483
> 
> 标签：xml, xpath, nodes, ancestor

我试图从我粘贴在下面的 Xml 文档中显示 JK Rowling 创作的所有项目的 ASIN。我不知道如何编写 XPath，因为 ASIN 在 ItemAttributes 之外。我知道它应该是这样的：/ItemSearchResponse/Items/Item/ItemAttributes[Author="JK Rowling"]/Author 但我不知道除了 ASIN 在哪里。有没有人有什么建议？

```
<Item>
  <ASIN>0747557462</ASIN>
  <ItemAttributes>
    <Author>Sarah Brown</Author>
    <Author>Gil McNeil</Author>
    <Creator Role="Foreword">J.K. Rowling</Creator>
    <Manufacturer>Bloomsbury UK</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>Magic</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>0826452329</ASIN>t
  <ItemAttributes>
    <Author>Philip Nel</Author>
    <Manufacturer>Continuum</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>J.K. Rowling's Harry Potter Novels: A Reader's Guide (Continuum Contemporaries) - Unauthorized</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>1571745424</ASIN>
  <ItemAttributes>
    <Author>George W. Beahm</Author>
    <Creator Role="Illustrator">Tim Kirk</Creator>
    <Manufacturer>Hampton Roads Pub Co</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>Muggles and Magic: An Unofficial Guide to J.k. Rowling and the Harry Potter Phenomenon</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>0737716681</ASIN>
  <ItemAttributes>
    <Creator Role="Editor">Gary Wiener</Creator>
    <Manufacturer>Greenhaven Press</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>JK Rowling (hardcover edition) (Literary Companion to Contemporary Authors)</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>1586638394</ASIN>
  <ItemAttributes>
    <Author>SparkNotes Editors</Author>
    <Manufacturer>SparkNotes</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>J.K. Rowling (SparkNotes Library of Great Authors)</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>0972322108</ASIN>
  <ItemAttributes>
    <Author>John Granger</Author>
    <Manufacturer>Zossima Press</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>The Hidden Key to Harry Potter: Understanding the Meaning, Genius, and Popularity of Joanne Rowling's Harry Potter Novels</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>1414321880</ASIN>
  <ItemAttributes>
    <Author>John Granger</Author>
    <Manufacturer>SaltRiver</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>How Harry Cast His Spell: The Meaning Behind the Mania for J. K. Rowling's Bestselling Books</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>0545010225</ASIN>
  <ItemAttributes>
    <Author>J. K. Rowling</Author>
    <Creator Role="Illustrator">Mary GrandPré</Creator>
    <Manufacturer>Arthur A. Levine Books</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>Harry Potter and the Deathly Hallows (Book 7)</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>B000RBZM6E</ASIN>
  <ItemAttributes>
    <Author>J.K. Rowling</Author>
    <Creator Role="Translator">Gili Bar-Hillel</Creator>
    <Manufacturer>Yediot Acharonot</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>Harry Potter and the Goblet of Fire (Hebrew) (English and Hebrew Edition)</Title>
  </ItemAttributes>
</Item>
<Item>
  <ASIN>0439705908</ASIN>
  <ItemAttributes>
    <Author>J. K. Rowling</Author>
    <Manufacturer>Scholastic</Manufacturer>
    <ProductGroup>Book</ProductGroup>
    <Title>Harry Potter and the Order of the Phoenix (Year 5)</Title>
  </ItemAttributes>
</Item> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T03:28:34.443

**这是一个*只向前的*XPath 表达式，它准确地选择了想要的**节点：

```
/*/*[translate(ItemAttributes/Author, ' ', '')='J.K.Rowling']/ASIN 
```

**基于 XSLT 的验证**：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
  <xsl:copy-of select=
  "/*/*[translate(ItemAttributes/Author, ' ', '')='J.K.Rowling']/ASIN"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于提供的（片段，包裹在单个顶部元素中以成为格式良好的）XML 文档时**：

```
<t>
    <Item>
        <ASIN>0747557462</ASIN>
        <ItemAttributes>
            <Author>Sarah Brown</Author>
            <Author>Gil McNeil</Author>
            <Creator Role="Foreword">J.K. Rowling</Creator>
            <Manufacturer>Bloomsbury UK</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>Magic</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>0826452329</ASIN>t
        <ItemAttributes>
            <Author>Philip Nel</Author>
            <Manufacturer>Continuum</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>J.K. Rowling's Harry Potter Novels: A Reader's Guide (Continuum Contemporaries) - Unauthorized</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>1571745424</ASIN>
        <ItemAttributes>
            <Author>George W. Beahm</Author>
            <Creator Role="Illustrator">Tim Kirk</Creator>
            <Manufacturer>Hampton Roads Pub Co</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>Muggles and Magic: An Unofficial Guide to J.k. Rowling and the Harry Potter Phenomenon</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>0737716681</ASIN>
        <ItemAttributes>
            <Creator Role="Editor">Gary Wiener</Creator>
            <Manufacturer>Greenhaven Press</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>JK Rowling (hardcover edition) (Literary Companion to Contemporary Authors)</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>1586638394</ASIN>
        <ItemAttributes>
            <Author>SparkNotes Editors</Author>
            <Manufacturer>SparkNotes</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>J.K. Rowling (SparkNotes Library of Great Authors)</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>0972322108</ASIN>
        <ItemAttributes>
            <Author>John Granger</Author>
            <Manufacturer>Zossima Press</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>The Hidden Key to Harry Potter: Understanding the Meaning, Genius, and Popularity of Joanne Rowling's Harry Potter Novels</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>1414321880</ASIN>
        <ItemAttributes>
            <Author>John Granger</Author>
            <Manufacturer>SaltRiver</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>How Harry Cast His Spell: The Meaning Behind the Mania for J. K. Rowling's Bestselling Books</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>0545010225</ASIN>
        <ItemAttributes>
            <Author>J. K. Rowling</Author>
            <Creator Role="Illustrator">Mary GrandPré</Creator>
            <Manufacturer>Arthur A. Levine Books</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>Harry Potter and the Deathly Hallows (Book 7)</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>B000RBZM6E</ASIN>
        <ItemAttributes>
            <Author>J.K. Rowling</Author>
            <Creator Role="Translator">Gili Bar-Hillel</Creator>
            <Manufacturer>Yediot Acharonot</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>Harry Potter and the Goblet of Fire (Hebrew) (English and Hebrew Edition)</Title>
        </ItemAttributes>
    </Item>
    <Item>
        <ASIN>0439705908</ASIN>
        <ItemAttributes>
            <Author>J. K. Rowling</Author>
            <Manufacturer>Scholastic</Manufacturer>
            <ProductGroup>Book</ProductGroup>
            <Title>Harry Potter and the Order of the Phoenix (Year 5)</Title>
        </ItemAttributes>
    </Item>
</t> 
```

**计算 XPath 表达式并将选定节点复制到输出：**

```
<ASIN>0545010225</ASIN>
<ASIN>B000RBZM6E</ASIN>
<ASIN>0439705908</ASIN> 
```

**请注意：**`Author`我们在比较之前通过消除任何空格来忽略任何元素的字符串值中不同数量的空格。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T02:42:28.617

您可以使用`..`访问父项目，然后进入 ASIN 标签，添加`/../ASIN`到您的当前路径。

尝试这个：

```
/ItemSearchResponse/Items/Item/ItemAttributes[Author="J. K. Rowling"]/../ASIN 
```

# java - 使用 Selenium Webdriver 获取 div 中的项目列表

> ID：15537930
> 
> 赞同：6
> 
> 时间：2013-03-21T01:32:49.080
> 
> 标签：java, selenium, selenium-webdriver

说我有以下

```
<div class="facetContainerDiv">
    <div>
        <label class="facetLabel">
            <input class="facetCheck" type="checkbox" />
        </label>
        <label class="facetLabel">
            <input class="facetCheck" type="checkbox" />
        </label>
        <label class="facetLabel">
            <input class="facetCheck" type="checkbox" />
        </label>
        <label class="facetLabel">
            <input class="facetCheck" type="checkbox" />
        </label>
        <label class="facetLabel">
            <input class="facetCheck" type="checkbox" />
        </label>
    </div>
</div> 
```

现在我想根据我提供的索引在复选框上打一个复选标记。所以我写了一个如下的方法

如何访问 div class="facetContainerDiv" 中的所有元素？

我试过

```
List<WebElements> elementsList =  driver.findElements(By.cssSelector(".facetContainerDiv"));
for(WebElement checkBox:elementsList) {
    int i=0;
    checkBox = elementsList.get(i);
     bla bla bla..
} 
```

在上面的代码中，elementsList 只有一个“type”为空的元素。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-21T07:53:36.427

请按照以下与您的情况完全匹配的代码进行操作。

1.  为div下的div创建web元素的接口，**类**为**facetContainerDiv**

即对于

```
<div class="facetContainerDiv">
    <div>

    </div>
</div> 
```

2\. 创建一个 IList，其中包含第二个 div 中的所有元素，即

```
<label class="facetLabel">
   <input class="facetCheck" type="checkbox" />
</label>
<label class="facetLabel">
   <input class="facetCheck" type="checkbox" />
</label>
<label class="facetLabel">
   <input class="facetCheck" type="checkbox" />
</label>
<label class="facetLabel">
   <input class="facetCheck" type="checkbox" />
</label>
<label class="facetLabel">
   <input class="facetCheck" type="checkbox" />
</label> 
```

3.使用索引访问每个复选框

请在下面找到代码

```
using System;
using System.Collections.Generic;
using OpenQA.Selenium;
using OpenQA.Selenium.Firefox;
using OpenQA.Selenium.Support.UI;

namespace SeleniumTests
{
  class ChechBoxClickWthIndex
    {
        static void Main(string[] args)
        {

            IWebDriver driver = new FirefoxDriver();

            driver.Navigate().GoToUrl("file:///C:/Users/chery/Desktop/CheckBox.html");

            // Create an interface WebElement of the div under div with **class as facetContainerDiv**
            IWebElement WebElement =    driver.FindElement(By.XPath("//div[@class='facetContainerDiv']/div"));
            // Create an IList and intialize it with all the elements of div under div with **class as facetContainerDiv**
            IList<IWebElement> AllCheckBoxes = WebElement.FindElements(By.XPath("//label/input"));
            int RowCount = AllCheckBoxes.Count;
            for (int i = 0; i < RowCount; i++)
            {
            // Check the check boxes based on index
               AllCheckBoxes[i].Click();

            }
            Console.WriteLine(RowCount);
            Console.ReadLine(); 

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-21T03:52:47.287

我不确定您的 findElements 语句是否为您提供了所有 div。我会尝试以下方法：

```
List<WebElement> elementsRoot = driver.findElements(By.xpath("//div[@class=\"facetContainerDiv\"]/div));

for(int i = 0; i < elementsRoot.size(); ++i) {
     WebElement checkbox = elementsRoot.get(i).findElement(By.xpath("./label/input"));
     checkbox.click();
     blah blah blah
} 
```

这里的想法是您获取根元素，然后使用另一个“子”xpath 或您喜欢的任何选择器来查找节点元素。当然，可能需要调整 xpath 或选择器以正确找到所需的元素。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-21T03:49:56.787

您要求提供 class 的所有元素`facetContainerDiv`，其中只有一个（最外层的 div）。为什么不做

```
List<WebElement> checks =  driver.findElements(By.class("facetCheck"));
// click the 3rd checkbox
checks.get(2).click(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-02-25T16:10:24.053

或者，您可以尝试编写特定元素：

```
 //label[1] is the first element.
    el =  await driver.findElement(By.xpath("//div[@class=\"facetContainerDiv\"]/div/label[1]/input")));
    await el.click(); 
```

更多信息可以在这里找到：[https ://www.browserstack.com/guide/locators-in-selenium](https://www.browserstack.com/guide/locators-in-selenium)

# iphone - 如何从我的应用程序调用消息应用程序？

> ID：15537932
> 
> 赞同：0
> 
> 时间：2013-03-21T01:33:10.583
> 
> 标签：iphone, sms

如何从我当前的应用程序调用消息应用程序。
我知道使用此代码...

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:@"sms:"]]; 
```

或者

```
[[UIApplication sharedApplication] openURL:[NSURL URLWithString:
@"sms:1-408-555-1212"]]; 
```

但是我想要的只是调用Message App，我不想要电话号码或没有电话号码。
只想打开当前的消息应用程序视图。
请帮我....

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T04:29:43.230

```
MFMessageComposeViewController *messagComposer = [[MFMessageComposeViewController alloc] init];
            if([MFMessageComposeViewController canSendText])
            {
                messagComposer.messageComposeDelegate = self; 
                messagComposer.recipients = recipientsArray; // here give array of recipints
                messagComposer.body = @"Some text";
                [self presentModalViewController:picker animated:YES];                    
             } 
```

尝试这样发送消息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T04:51:01.813

尝试这个 ：：

在项目中导入**MessageUI**框架。

在 .h 文件中，

```
#import <MessageUI/MessageUI.h> 
```

发送短信的调用方法：**`[self SendSMS:@"YOUR_MESSAGE" recipientList:ARRAY_OF_RECIPIENTS];`**

在这里，如果您没有任何收件人，则将数组传递为**`nil`**.

方法 ：：

```
- (void)sendSMS:(NSString *)bodyOfMessage recipientList:(NSArray *)recipients
{
    MFMessageComposeViewController *controller = [[MFMessageComposeViewController alloc] init];
    if([MFMessageComposeViewController canSendText])
    {
        controller.body = bodyOfMessage;
        controller.recipients = recipients;
        controller.messageComposeDelegate = self;
        [self presentModalViewController:controller animated:YES];
    }
    [controller release];
} 
```

消息框架方法 ::

```
- (void)messageComposeViewController:(MFMessageComposeViewController *)controller didFinishWithResult:(MessageComposeResult)result {

    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Status:" message:@"" delegate:nil cancelButtonTitle:@"ok" otherButtonTitles:nil];

    switch (result) {
        case MessageComposeResultCancelled:
           alert.message = @"Cancelled";

           break;
        case MessageComposeResultFailed:
           alert.message = @"Failed";

           break;
        case MessageComposeResultSent:
           alert.message = @"Send";

           break;
        default:
           break;
    }

    [self dismissModalViewControllerAnimated:YES];
    [alert show];
    [alert release];
} 
```

希望，它会帮助你。

谢谢。

# android - Facebook Android SDK 始终显示 Web 身份验证对话框而不是本机身份验证对话框/单点登录

> ID：15537934
> 
> 赞同：0
> 
> 时间：2013-03-21T01:33:28.630
> 
> 标签：android, facebook, single-sign-on, facebook-android-sdk

我在 Android 应用程序中使用来自 GitHub 的 facebook-android-sdk 的 3.0 版本。

出于某种原因，在进行身份验证时，Facebook SDK 似乎总是显示“网络对话框”以手动输入用户名和密码，而不是使用带有单点登录的内置本机对话框。

输入用户名和密码时，应用程序验证成功并且一切正常，但由于某种原因，SSO 似乎永远无法正常工作。

关于如何解决这个问题的任何想法？日志中不会调用 Facebook 错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T04:30:06.730

您的手机中似乎没有 facebook 应用程序，因此 android sdk 必须使用网络对话框。另一种情况是你设置的登录行为是SessionLoginBehavior.SUPPRESS_SSO，试着把它改成SSO_WITH_FALLBACK。有关更多信息，请查看[此](http://developers.facebook.com/docs/reference/android/3.0/SessionLoginBehavior/)

# python - 在 python 中：子进程失效而其他进程没有，不确定为什么

> ID：15537938
> 
> 赞同：1
> 
> 时间：2013-03-21T01:33:59.860
> 
> 标签：python, parallel-processing, multiprocessing

编辑：答案是操作系统正在取消进程，因为我正在消耗所有内存

我正在生成足够多的子进程以保持内核的平均负载为 1:1，但是在一小时内的某个时间点，此脚本可能会运行数天，其中 3 个进程会运行：

```
tipu   14804  0.0  0.0 328776   428 pts/1    Sl   00:20   0:00 python run.py
tipu   14808 64.4 24.1 2163796 1848156 pts/1 Rl   00:20  44:41 python run.py
tipu   14809  8.2  0.0      0     0 pts/1    Z    00:20   5:43 [python] <defunct>
tipu   14810 60.3 24.3 2180308 1864664 pts/1 Rl   00:20  41:49 python run.py
tipu   14811 20.2  0.0      0     0 pts/1    Z    00:20  14:04 [python] <defunct>
tipu   14812 22.0  0.0      0     0 pts/1    Z    00:20  15:18 [python] <defunct>
tipu   15358  0.0  0.0 103292   872 pts/1    S+   01:30   0:00 grep python 
```

我不知道为什么会这样，附加的是主从。如果需要，我也可以附加 mysql/pg 包装器，有什么建议吗？

`slave.py`：

```
from boto.s3.key import Key
import multiprocessing
import gzip
import os
from  mysql_wrapper import MySQLWrap
from pgsql_wrapper import PGSQLWrap
import boto
import re

class Slave:

    CHUNKS = 250000

    BUCKET_NAME = "bucket"
    AWS_ACCESS_KEY = ""
    AWS_ACCESS_SECRET = ""
    KEY = Key(boto.connect_s3(AWS_ACCESS_KEY, AWS_ACCESS_SECRET).get_bucket(BUCKET_NAME))
    S3_ROOT = "redshift_data_imports"
    COLUMN_CACHE = {}
    DEFAULT_COLUMN_VALUES = {}

    def __init__(self, job_queue):
        self.log_handler = open("logs/%s" % str(multiprocessing.current_process().name), "a");
        self.mysql = MySQLWrap(self.log_handler)
        self.pg = PGSQLWrap(self.log_handler)
        self.job_queue = job_queue

    def do_work(self):
        self.log(str(os.getpid()))
        while True:

            #sample job in the abstract: mysql_db.table_with_date-iteration
            job = self.job_queue.get()

            #queue is empty
            if job is None:
                self.log_handler.close()
                self.pg.close()
                self.mysql.close()
                print("good bye and good day from %d" % (os.getpid()))
                self.job_queue.task_done()
                break

            #curtail iteration
            table = job.split('-')[0]

            #strip redshift table from job name
            redshift_table = re.sub(r"(_[1-9].*)", "", table.split(".")[1])

            iteration = int(job.split("-")[1])
            offset = (iteration - 1) * self.CHUNKS

            #columns redshift is expecting
            #bad tables will slip through and error out, so we catch it
            try:
                colnames = self.COLUMN_CACHE[redshift_table]
            except KeyError:
                self.job_queue.task_done()
                continue

            #mysql fields to use in SELECT statement
            fields = self.get_fields(table)

            #list subtraction determining which columns redshift has that mysql does not
            delta = (list(set(colnames) - set(fields.keys())))

            #subtract columns that have a default value and so do not need padding
            if delta:
                delta = list(set(delta) - set(self.DEFAULT_COLUMN_VALUES[redshift_table]))

            #concatinate columns with padded \N
            select_fields = ",".join(fields.values()) + (",\\N" * len(delta))

            query = "SELECT %s FROM %s LIMIT %d, %d" % (select_fields, table,
                    offset, self.CHUNKS)

            rows = self.mysql.execute(query)

            self.log("%s: %s\n" % (table, len(rows)))

            if not rows:
                self.job_queue.task_done()
                continue

            #if there is more data potentially, add it to the queue
            if len(rows) == self.CHUNKS:
                self.log("putting %s-%s" % (table, (iteration+1)))
                self.job_queue.put("%s-%s" % (table, (iteration+1)))

            #various characters need escaping
            clean_rows = []
            redshift_escape_chars = set( ["\\", "|", "\t", "\r", "\n"] )
            in_chars = ""

            for row in rows:
                new_row = []
                for value in row:
                    if value is not None:
                        in_chars = str(value)
                    else:
                        in_chars = ""

                    #escape any naughty characters
                    new_row.append("".join(["\\" + c if c in redshift_escape_chars else c for c in in_chars]))
                new_row = "\t".join(new_row)
                clean_rows.append(new_row)

            rows = ",".join(fields.keys() + delta)
            rows += "\n" + "\n".join(clean_rows)

            offset = offset + self.CHUNKS

            filename = "%s-%s.gz" % (table, iteration) 
            self.move_file_to_s3(filename, rows)

            self.begin_data_import(job, redshift_table, ",".join(fields.keys() +
               delta))

            self.job_queue.task_done()

    def move_file_to_s3(self, uri, contents):

        tmp_file = "/dev/shm/%s" % str(os.getpid())

        self.KEY.key = "%s/%s" % (self.S3_ROOT, uri)
        self.log("key is %s" % self.KEY.key )

        f = gzip.open(tmp_file, "wb")
        f.write(contents)
        f.close()

        #local saving allows for debugging when copy commands fail
        #text_file = open("tsv/%s" % uri, "w")
        #text_file.write(contents)
        #text_file.close()

        self.KEY.set_contents_from_filename(tmp_file, replace=True)

    def get_fields(self, table):
        """
            Returns a dict used as: 
                {"column_name": "altered_column_name"}
            Currently only the debug column gets altered
        """
        exclude_fields = ["_qproc_id", "_mob_id", "_gw_id", "_batch_id", "Field"]

        query = "show columns from %s" % (table)
        fields = self.mysql.execute(query)

        #key raw field, value mysql formatted field
        new_fields = {}

        #for field in fields:
        for field in [val[0] for val in fields]:
            if field in exclude_fields:
                continue
            old_field = field

            if "debug_mode" == field.strip():
                field = "IFNULL(debug_mode, 0)"

            new_fields[old_field] = field

        return new_fields

    def log(self, text):
        self.log_handler.write("\n%s" % text)

    def begin_data_import(self, table, redshift_table, fields):
        query = "copy %s (%s) from 's3://bucket/redshift_data_imports/%s' \
            credentials 'aws_access_key_id=%s;aws_secret_access_key=%s' delimiter '\\t' \
            gzip NULL AS '' COMPUPDATE ON ESCAPE IGNOREHEADER 1;" \
            % (redshift_table, fields, table, self.AWS_ACCESS_KEY, self.AWS_ACCESS_SECRET)
        self.pg.execute(query) 
```

`master.py`：

```
from slave import Slave as Slave 
import multiprocessing
from mysql_wrapper import MySQLWrap as MySQLWrap
from pgsql_wrapper import PGSQLWrap as PGSQLWrap

class Master:

    SLAVE_COUNT = 5

    def __init__(self):
        self.mysql = MySQLWrap()
        self.pg = PGSQLWrap()

    def do_work(table):
        pass

    def get_table_listings(self):
        """Gathers a list of MySQL log tables needed to be imported"""

        query = 'show databases'
        result = self.mysql.execute(query)

        #turns list[tuple] into a flat list
        databases = list(sum(result, ()))

        #overriding during development
        databases = ['db1', 'db2', 'db3']]

        exclude = ('mysql', 'Database', 'information_schema')
        scannable_tables = []

        for database in databases:
            if database in exclude:
                continue

            query = "show tables from %s" % database
            result = self.mysql.execute(query)

            #turns list[tuple] into a flat list
            tables = list(sum(result, ()))

            for table in tables:
                exclude = ("Tables_in_%s" % database, "(", "201303", "detailed", "ltv")

                #exclude any of the unfavorables
                if any(s in table for s in exclude):
                    continue

                scannable_tables.append("%s.%s-1" % (database, table))

        return scannable_tables

    def init(self):
        #fetch redshift columns once and cache
        #get columns from redshift so we can pad the mysql column delta with nulls
        tables = ('table1', 'table2', 'table3')

        for table in tables:

            #cache columns
            query = "SELECT column_name FROM information_schema.columns WHERE \
            table_name = '%s'" % (table)
            result = self.pg.execute(query, async=False, ret=True)
            Slave.COLUMN_CACHE[table] = list(sum(result, ()))

            #cache default values
            query = "SELECT column_name FROM information_schema.columns WHERE \
            table_name = '%s' and column_default is not \
            null" % (table)

            result = self.pg.execute(query, async=False, ret=True)

            #turns list[tuple] into a flat list
            result = list(sum(result, ()))

            Slave.DEFAULT_COLUMN_VALUES[table] = result

    def run(self):
        self.init()

        job_queue = multiprocessing.JoinableQueue()
        tables = self.get_table_listings()
        for table in tables:
            job_queue.put(table)

        processes = []
        for i in range(Master.SLAVE_COUNT):
            process = multiprocessing.Process(target=slave_runner, args=(job_queue,))
            process.daemon = True
            process.start()
            processes.append(process)

        #blocks this process until queue reaches 0
        job_queue.join()

        #signal each child process to GTFO
        for i in range(Master.SLAVE_COUNT):
            job_queue.put(None)

        #blocks this process until queue reaches 0
        job_queue.join()

        job_queue.close()

        #do not end this process until child processes close out
        for process in processes:
            process.join()

        #toodles !
        print("this is master saying goodbye")

def slave_runner(queue):
    slave = Slave(queue)
    slave.do_work() 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-26T21:38:04.177

没有足够的信息可以确定，但问题很可能`Slave.do_work`是引发未处理的异常。（有很多行代码可以在各种不同的条件下做到这一点。）

当你这样做时，子进程将退出。

在 POSIX 系统上......好吧，完整的细节有点复杂，但在简单的情况下（你在这里有什么），一个退出的子进程将作为一个`<defunct>`进程一直存在直到它被收割（因为父进程要么`wait`在它上面，或退出）。由于您的父代码在队列完成之前不会等待子代码，这正是发生的事情。

所以，有一个简单的胶带修复：

```
def do_work(self):
    self.log(str(os.getpid()))
    while True:
        try:
            # the rest of your code
        except Exception as e:
            self.log("something appropriate {}".format(e))
            # you may also want to post a reply back to the parent 
```

您可能还想将大量内容分解`try`为不同的部分，以便区分可能出错的所有不同阶段（特别是如果其中一些意味着您需要回复，而有些则意味着您不需要）。

* * *

但是，看起来您尝试做的是完全复制 的行为`multiprocessing.Pool`，但在几个地方错过了该栏。这就提出了一个问题：为什么不`Pool`首先使用呢？`map`然后，您可以使用其中一种家庭方法进一步简化/优化事情。例如，您的整体`Master.run`可以简化为：

```
self.init()
pool = multiprocessing.Pool(Master.SLAVE_COUNT, initializer=slave_setup)
pool.map(slave_job, tables)
pool.join() 
```

这将为您处理异常，并允许您在以后需要时返回值/异常，并让您使用内置`logging`库而不是尝试构建自己的库，等等。并且只需要对`Slave`.

* * *

如果您想从作业中提交新作业，最简单的方法可能是使用[`Future`](http://docs.python.org/3/library/concurrent.futures.html#future-objects)基于 - 的 API（它可以扭转局面，使未来的结果成为焦点，而池/执行器成为提供它们的愚蠢事物，而不是使池成为焦点，结果成为它回馈的愚蠢事物），但也有多种方法可以做到这`Pool`一点。例如，现在，您不会从每个作业中返回任何内容，因此，您可以只返回`tables`要执行的列表。这是一个简单的示例，展示了如何做到这一点：

```
import multiprocessing

def foo(x):
    print(x, x**2)
    return list(range(x))

if __name__ == '__main__':
    pool = multiprocessing.Pool(2)
    jobs = [5]
    while jobs:
        jobs, oldjobs = [], jobs
        for job in oldjobs:
            jobs.extend(pool.apply(foo, [job]))
    pool.close()
    pool.join() 
```

显然，您可以通过将整个循环替换为例如馈入的列表理解来稍微压缩这一点`itertools.chain`，并且您可以通过将“提交者”对象传递给每个作业并添加到该对象而不是返回一个新工作列表等。但我想尽可能明确地表明它是多么少。

* * *

无论如何，如果您认为显式队列更容易理解和管理，那就去吧。只需查看来源[`multiprocessing.worker`](http://hg.python.org/cpython/file/65e8ac5f073f/Lib/multiprocessing/pool.py#l66)和/或[`concurrent.futures.ProcessPoolExecutor`](http://hg.python.org/cpython/file/3.3/Lib/concurrent/futures/process.py#l318)查看您需要自己做什么。这并不难，但有足够多的事情你可能会出错（就我个人而言，当我自己尝试做这样的事情时，我总是会忘记至少一个边缘情况），这是在寻找正确的代码的工作。

* * *

或者，您不能在这里使用的唯一原因似乎[`concurrent.futures.ProcessPoolExecutor`](http://docs.python.org/3/library/concurrent.futures.html#processpoolexecutor)是您需要初始化一些每个进程的状态（`boto.s3.key.Key`、`MySqlWrap`等），这可能是非常好的缓存原因。（如果这涉及到 Web 服务查询、数据库连接等，您当然不希望每个任务都这样做一次！）但是有几种不同的方法可以解决这个问题。

但是您可以继承`ProcessPoolExecutor`并覆盖未记录的函数`_adjust_process_count`（请参阅[源代码](http://hg.python.org/cpython/file/3.3/Lib/concurrent/futures/process.py#l376)了解它的简单程度）以传递您的 setup 函数，并且……这就是您所要做的。

或者你可以混合搭配。将from包裹在`Future`from`concurrent.futures`周围。`AsyncResult``multiprocessing`

# c# - 使用精确词的 LINQ 过滤列表

> ID：15537941
> 
> 赞同：2
> 
> 时间：2013-03-21T01:34:15.310
> 
> 标签：c#, linq

我有这个字符串列表。我只想过滤掉那些与我搜索的关键字完全匹配的项目。例如，我有关键字“in”，我希望结果只过滤那些具有确切单词“in”的项目。请帮忙。

**代码**

```
static IEnumerable<string> GetData()
       {
           var strList = new List<string> 
           { "I'm in love",
            "Coffee contains caffeine",
            "The best inn so far",
            "Inside of me",
            "in the darkness"};
           var filteredItems = strList.Where(x => x.Contains("in"));
           return filteredItems;
       } 
```

从我的列表中，我只想返回项目 1 和项目 5，因为它们是具有确切单词“in”的项目。

![在此处输入图像描述](../Images/202d93a04d238dfa6cd6ad8d61c91252.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T01:38:25.090

这是一种方法：

```
var filteredItems = strList.Where(x => (" " + x + " ").Contains(" in ")); 
```

或这个：

```
var filteredItems = strList.Where(x => Regex.IsMatch(x, "(^| )in($| )")); 
```

不区分大小写的版本：

```
var filteredItems = strList.Where(x => (" " + x .ToLower() + " ").Contains(" in "));
var filteredItems = strList.Where(x => Regex.IsMatch(x, "(^|\s)in($|\s)",
                                                     RegexOptions.IgnoreCase)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T01:41:05.157

我希望使用[Regex.IsMatch](http://msdn.microsoft.com/en-us/library/sdx2bds0.aspx)方法。例如：

```
string pattern = "<your pattern here>";

static IEnumerable<string> GetData()
   {
       var strList = new List<string> 
       { "I'm in love",
        "Coffee contains caffeine",
        "The best inn so far",
        "Inside of me",
        "in the darkness"};
       var filteredItems = strList.Where(x => Regex.IsMatch(x, pattern));
       return filteredItems;
   } 
```

应该匹配的模式是：`^(.*)\sin\s(.*)$`

所以零个或多个字符，然后是“in”（即被空格包围），然后是零个或多个字符。您可以使用诸如[Rubular](http://rubular.com/)之类的东西或网络上的许多其他类似的东西来用您的字符串测试您的正则表达式，以确保您获得正确的里程:-)

有点口不择言，但正则表达式可能会给您带来更多[问题](http://www.codinghorror.com/blog/2008/06/regular-expressions-now-you-have-two-problems.html):-)

HTH，弥敦道

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T01:39:31.080

正确的方法是构造一个正则表达式。

便宜的方法，在字符串的前后添加空格以匹配，匹配你正在寻找的单词，前后有空格：

```
static IEnumerable<string> GetData(string match)
   {
       var strList = new List<string> 
       { "I'm in love",
        "Coffee contains caffeine",
        "The best inn so far",
        "Inside of me",
        "in the darkness"};

       match = match.ToLower(); //to do case insensitive matching
       var filteredItems = strList.Where(x => (" " +x.ToLower() + " ").Contains(" "+match+" "));
       return filteredItems;
   } 
```

# git - Git - 如何撤消未同步的丢弃所有回滚？

> ID：15537942
> 
> 赞同：0
> 
> 时间：2013-03-21T01:34:15.520
> 
> 标签：git

我在 git 中做了三个提交，但没有同步我的更改。我使用 GUI 回滚到本地提交，并且一些提交在 GUI 中丢失了。我可以恢复那些提交吗？我害怕同步我当前的更改，因为我希望将这些本地提交存档在存储库中。

是否可以恢复那些本地提交？如果是这样，怎么做？

这是一个示例，除了我的更改未同步：

![提交历史](../Images/4b587ca79a93bdecebf7d91c71e599bd.png) 上图是提交历史。

![在此处输入图像描述](../Images/0d54679819e153c50933dd82a25005be.png) 上图是当我回滚我的更改[，丢弃我的更改，然后执行`git -reset`] 时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:41:16.007

由于您知道要回滚的提交的 HASH 代码，因此您只需键入`git reset --hard d513712892`即可返回。

# ios - 我可以在 Xcode 中获取 Unity3D 引擎版本以及如何根据版本进行条件编译吗？

> ID：15537943
> 
> 赞同：1
> 
> 时间：2013-03-21T01:34:48.907
> 
> 标签：ios, xcode, compilation, unity3d

我正在为 iOS 开发 Unity3D 中的插件。出于某种原因，我需要在本机代码（Xcode 中的.mm）中指定一些代码在 Unity3D 4.1 之前编译，而其他代码在 Unity3D 4.1（包括）之后编译。也许是这样的：

```
#if UNITY_VERSION < UNITY_4_1
    //Some code be compiled before Unity4.1
#else
    //Some code for new version
#endif 
```

我知道 Unity3D 编辑器中有一个[平台相关编译](http://docs.unity3d.com/Documentation/Manual/PlatformDependentCompilation.html)，但是如何在 Xcode 中获取引擎的版本并进行“基于 Unity 引擎版本的条件编译”？任何建议将不胜感激！

编辑：也许我可以为不同的版本编写两个 .mm 文件并在[[PostProcessAttribute]](http://docs.unity3d.com/Documentation/ScriptReference/PostProcessAttribute.html)中删除其中一个。但我不认为这是一个好主意...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T19:33:36.947

目前还不清楚您要做什么。您是否通过注入 Unity 创建的 XCode 项目来构建您的本机代码？或者您是否将本机代码构建到 Unity 在构建期间包含的库中？

AFAIK 如果不检查 Unity 的安装并找出确定的方法，XCode 无法提前知道您正在使用哪个版本的 Unity。

如果您执行后者，即构建包含在 Unity 构建中的本机代码库。在这种情况下，您将需要两个单独的库，并指示用户包含任何一个相关的库。

如果您正在执行前者，即将新的本地代码注入 Unity 创建的 XCode 项目，那么 Unity 会导出 #defines，这样您就可以确定您的本地代码需要针对哪个版本的 Unity 进行编译。

# c# - 在预期条件的上下文中指定的非布尔类型的表达式，靠近“ID”

> ID：15537945
> 
> 赞同：0
> 
> 时间：2013-03-21T01:35:16.903
> 
> 标签：c#, asp.net, visual-studio

有人可以指出导致此错误的原因吗？我一直在尝试修复它，但我失败了。我不明白“ID”有什么问题......究竟是哪个部分产生了这个错误？

这是我的代码：

```
protected void Button1_Click(object sender, EventArgs e)
{
    SqlConnection conn = new SqlConnection();
    conn.ConnectionString = SqlDataSource1.ConnectionString;

    string str = "SELECT * FROM Student "
        + " WHERE Student ID = '" + StudentID.Text + "' AND "
        + " Password = '" + SPassword.Text + "'";

    SqlCommand cmdSelect = new SqlCommand(str, conn);
    SqlDataReader reader;

    conn.Open();
    reader = cmdSelect.ExecuteReader();

    if (reader.Read())
    {

        if (StudentID.Text == "900000000")

            Response.Write("<body onload=\"window.open('Admin.aspx', '_top')\"></body>");

        else

            Response.Write("<body onload=\"window.open('user.aspx', '_top')\"></body>");

    }
    else
        lblMsg.Text = "Invalid Username and/or Password, please re-try!!";

    conn.Close();

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:36:57.240

`SELECT * FROM Student WHERE Student.ID ...`（你有一个空格而不是一个点）

您可以完全省略`Student`并仅使用`ID`（就像您的 for 一样`Password`）。

# c# - 使用 Where 子句首先更新实体框架代码

> ID：15537947
> 
> 赞同：3
> 
> 时间：2013-03-21T01:35:28.607
> 
> 标签：c#, .net, entity-framework, entity, entity-framework-5

我正在使用[FilteredSet](http://patrickdesjardins.com/blog/using-a-filtereddbset-with-entity-framework-to-have-dynamic-filtering)自动获取系统当前登录用户的数据。它为我提供了一种从当前用户返回数据而不访问其他用户数据的动态方式。

我想在更新实体时做同样的事情。我可以使用 FilteredSet 从数据库中获取实体，如果实体 id 不属于用户抛出异常但我不想先加载实体并简单地附加这个实体并更新。

到目前为止，我尝试过：

```
public void UpdateOwnable<TEntity>(TEntity entity) where TEntity : class, IEntity, IUserOwnable
{
       var entityLocal = SetOwnable<TEntity>().Local.SingleOrDefault(d => d.Id == entityId);
       if (entityLocal==null)
       {
          entityLocal = this.SetOwnable<TEntity>().Attach(entity);
       }
       this.ChangeTracker.Entries<TEntity>().Single(d => d.Entity == entityLocal).State = EntityState.Modified;
} 
```

问题是生成的查询不包含 WHERE 子句。我希望找到一种方法，即 Where 子句不仅是实体的主键，而且是用户 ID。

```
Update Workout
SET name ..
WHERE id = 1
AND idUser = 123; 
```

这个 SQL 查询是我希望实体框架生成的。idUser 带有“AND”子句。

这可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-21T08:44:47.763

EF 不提供开箱即用的功能来将 where 条件添加到 Update 语句。例如，您可以使用此开源项目的[批量更新。](http://weblogs.asp.net/pwelter34/archive/2011/11/29/entity-framework-batch-update-and-future-queries.aspx)不同之处在于您的更新不会成为`SaveChanges`通话的一部分（因为 EF 不支持它）。

# php - 在控制器中进行事务管理是不好的做法吗？

> ID：15537950
> 
> 赞同：22
> 
> 时间：2013-03-21T01:35:57.547
> 
> 标签：php, mysql, design-patterns, transactions

我正在使用 Yii 框架开发一个 PHP/MySQL 应用程序。

我遇到过以下情况：

在我的`VideoController`中，我有一个`actionCreate`创建新视频并`actionPrivacy` 设置视频隐私的方法。问题在于，在调用当前具有事务的模型`actionCreate`方法`setPrivacy`期间。`Video`我希望视频的创建也可以在事务中进行，这会导致错误，因为事务已经处于活动状态。

在对此[答案](https://stackoverflow.com/a/319939/47278)的评论中，比尔卡尔文写道

> 所以没有必要让域模型类或 DAO 类管理事务——只需在控制器级别进行即可

在[这个答案](https://stackoverflow.com/a/1677753/47278)中：

> 由于您使用的是 PHP，因此您的事务范围至多是一个请求。所以你应该只使用容器管理的事务，而不是服务层事务。也就是说，在开始处理请求时启动事务，并在处理完请求时提交（或回滚）。

如果我在控制器中管理事务，我会有一堆代码，如下所示：

```
public function actionCreate() {
  $trans = Yii::app()->getDb()->beginTransaction();
  ...action code...
  $trans->commit();
} 
```

这会导致在我需要为操作进行事务处理的许多地方重复代码。

或者我可以将它重构为父类的`beforeAction()`and方法，然后它会为每个正在执行的操作自动创建事务。`afterAction()``Controller`

这种方法会有问题吗？PHP 应用程序的事务管理的良好做法是什么？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-03-29T16:49:05.650

我说事务不属于模型层的原因基本上是这样的：

**模型可以调用其他模型中的方法。**

如果模型尝试启动事务，但它不知道其调用者是否已经启动事务，则模型必须*有条件*地启动事务，如[@Bubba 答案](https://stackoverflow.com/a/15688987/20860)中的代码示例所示。模型的方法必须接受一个标志，以便调用者可以告诉它是否允许开始自己的事务。否则模型必须能够查询其调用者的“事务中”状态。

```
public function setPrivacy($privacy, $caller){
    if (! $caller->isInTransaction() ) $this->beginTransaction();

    $this->privacy = $privacy;
    // ...action code..

    if (! $caller->isInTransaction() ) $this->commit();
} 
```

如果调用者不是对象怎么办？在 PHP 中，它可以是静态方法，也可以是简单的非面向对象代码。这变得非常混乱，并导致模型中出现大量重复代码。

这也是[*控制耦合*](http://en.wikipedia.org/wiki/Coupling_%28computer_programming%29)的一个例子，这被认为是不好的，因为调用者必须了解被调用对象的内部工作原理。例如，您的模型的*某些*方法可能具有 $transactional 参数，但其他方法可能没有该参数。调用者应该如何知道参数何时重要？

```
// I need to override method's attempt to commit
$video->setPrivacy($privacy, false);  

// But I have no idea if this method might attempt to commit
$video->setFormat($format); 
```

我看到的另一个解决方案（甚至在 Propel 等一些框架中实现）是在 DBAL 知道它已经在事务中时进行`beginTransaction()`和`commit()`无操作。但是，如果您的模型尝试提交并发现它并没有真正提交，这可能会导致异常。或者尝试回滚并忽略该请求。我以前写过关于这些异常的文章。

我建议的折衷方案是**Models 不知道 transactions**。模型不知道它的请求`setPrivacy()`是否应该立即提交，或者它是否是更大图景的一部分，涉及多个模型的更复杂的一系列更改，并且只有在所有这些更改都成功 *时才应该提交。**这就是交易的重点。*

因此，如果模型不知道他们是否可以或应该开始并提交自己的事务，那么谁知道呢？GRASP 包括一个[控制器模式](http://en.wikipedia.org/wiki/GRASP_%28object-oriented_design%29#Controller)，它是一个用例的非 UI 类，它被分配了创建和控制所有部分以完成该用例的责任。 **控制器了解事务**，因为这是所有关于完整用例是否复杂的信息都可以访问的地方，并且需要在模型中、在一个事务中（或者可能在多个事务中）进行多次更改。

我之前写过的例子，就是在`beforeAction()`一个MVC Controller的方法中启动一个事务，然后在方法中提交`afterAction()`，就是一个**简化**。Controller 应该可以自由地启动和提交逻辑上需要的尽可能多的事务以完成当前操作。或者有时控制器可以避免显式事务控制，并允许模型自动提交每个更改。

但关键是关于哪些交易是必要的信息是模型不知道的——必须告诉他们（以 $transactional 参数的形式）或者从他们的调用者那里查询它，这无论如何，都必须将问题一直委托给控制器的行动。

You may also create a [Service Layer](http://martinfowler.com/eaaCatalog/serviceLayer.html) of classes that each know how to execute such complex use cases, and whether to enclose all the changes in a single transaction. That way you avoid a lot of repeated code. But it's not common for PHP apps to include a distinct Service Layer; the Controller's action is usually coincident with a Service Layer.

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-28T18:00:53.777

**最佳实践：** *将事务放在模型中，不要将事务放在控制器中。*

MVC 设计模式的主要优点是：*MVC 使模型类无需修改即可重用。*使维护和实施新功能变得容易。

例如，假设您主要为浏览器开发，其中用户一次输入一个数据集合，并且您将数据操作移动到控制器中。后来你意识到你需要支持允许用户上传大量的数据集合，以便从命令行导入到服务器上。

如果所有数据操作都在模型中，您可以简单地吞入数据并将其传递给模型进行处理。如果控制器中有必要的（事务性）功能，则必须在 CLI 脚本中复制它。

另一方面，也许您最终会得到另一个需要从不同点执行相同功能的控制器。您现在也需要在该其他控制器中复制代码。

为此，您只需要解决模型中的事务挑战。

假设您有一个带有 setPrivacy() 方法的 Video 类（模型），该方法已经内置了事务；并且您想从另一个方法 persist() 调用它，该方法还需要将其功能包装在更大的事务中，您只需修改 setPrivacy() 以执行条件事务。

也许是这样的。

```
class Video{
    private $privacy;
    private $transaction;

    public function __construct($privacy){

        $this->privacy = $privacy;
    }

    public function persist(){
        $this->beginTransaction();
        // ...action code...
        $this->setPrivacy($this->privacy, false);
        // ...action code...
        $this->commit();
    }

    public function setPrivacy($privacy, $transactional = true){
        if ($transactional) $this->beginTransaction();

        $this->privacy = $privacy;
        // ...action code..

        if ($transactional) $this->commit();
    }

    private function beginTransaction(){
        $this->transaction = Yii::app()->getDb()->beginTransaction();
    }

    private function commit(){
        $this->transaction->commit();
    }
} 
```

最后，您的直觉是正确的（回复：*这会导致我在很多地方需要重复的代码来执行操作。*）。构建您的模型以支持您拥有的无数事务需求，并让控制器仅确定它将在自己的上下文中使用哪个入口点（方法）。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-25T02:09:12.623

不，你是对的。事务由控制器应该做的“创建”方法委托。您建议使用像 beforeAction() 这样的“包装器”是可行的方法。只需让控制器扩展或实现此类。看起来您正在寻找观察者类型模式或类似工厂的实现。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-25T02:24:29.707

好吧，这些广泛事务（在整个请求上）的一个缺点是您限制了数据库引擎的并发能力，并且还增加了死锁的可能性。从这个角度来看，将事务只放在需要它们的地方并让它们只覆盖需要覆盖的代码可能会有所回报。

如果可能的话，我肯定会在模型中放置交易。可以通过在该模型中引入 BaseModel（所有模型的祖先）和变量 transactionLock 来解决重叠事务的问题。然后，您只需将开始/提交事务指令包装到尊重此变量的 BaseModel 方法中。

# matlab - Matlab NQueens算法递归

> ID：15537955
> 
> 赞同：1
> 
> 时间：2013-03-21T01:36:35.723
> 
> 标签：matlab, recursion, n-queens

对于一项任务，我的任务是使用 Matlab 和递归设计一个 NQueens 算法。所以我设置它的方式是我有 2 个辅助函数 isValid，它测试有效的放置，以及 recursiveQueen，它从 0 的 MxM 板上放置或删除一个皇后，并从每一个可能的移动中添加一个或删除一个皇后可以使。为了空间，我从 recursiveQueen 函数中删除了 add 函数，但它所做的只是在 8 个方向上加或减 1。

我遇到的主要问题是在我的 solveNQ 函数中，如果没有为前一行找到解决方案，它会转到下一列。我将步骤分解为 6 ​​件事：

1）在第一排放置一个皇后

2）在下一行的下一个有效位置放置一个皇后

3) 重复第 2 步，直到没有找到该行的有效位置

4）从最后一行删除女王

5）将皇后放在该行的下一个有效位置

6）重复步骤 1-5 直到所有行都包含一个皇后（我没有编码这一步）

```
function out = NQueens(m) %main function
board = zeros(m,m); %intializes board
out = solveNQ(1,board) %recursive function
end

function out = solveNQ(col,board)
n = length(board);
out = false; %returns false if no solutions found
if col > n  
else
    for i = col:n 
        for j = 1:n
            if isValid(board,i,j)
                board = recursiveQueen(board,i,j,'place') %place queen
                out = solveNQ(col+1,board) %recursive call
            end
        end
        board = recursiveQueen(board,i-1,col,'remove') %if no valid placement for row
        out = solveNQ(col-1,board) %try again
    end
end
end

function out = isValid(board,row,col)
    if board(row,col) == 0
       out = true;
    else
       out = false;
end

function board = recursiveQueen(board,row,col,move)
board = goRight(board,row,col,move); %right
board = goLeft(board,row,col,move); %left
board = goDown(board,row,col,move); %down
board = goUp(board,row,col,move); %up
board = goRightUp(board,row,col,move); %diagnol up right
board = goLeftUp(board,row,col,move); %diagnol up left
board = goRightDown(board,row,col,move); %diagnol right down
board = goLeftDown(board,row,col,move); %diagnol left down
    if strcmp(move,'place') %places queen
        board(row,col) = -1; 
    elseif strcmp(move,'remove') %removes queen
        board(row,col) = 0;
     end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T05:48:57.627

您不需要 j= 的第二个循环，因为您的 col+1 将允许您移动到下一列。

我的概念如下

1）在左上角放置一个皇后

2）移动到下一列并在有效的地方放置一个皇后

3) 重复第 2 步，所以现在我们在第 3 列。如果您不能在其中放置任何皇后，则删除前一个皇后。您当前代码的主要问题可以通过在 if 语句中移动 Queen remove 来解决。这背后的逻辑是，当该列中不能放置皇后时，for 循环将运行而不实际执行任何操作（因为 isValid 为 false）。当 for 循环（这是递归内部的 for 循环）停止运行时，MATLAB 会从之前停止的地方开始，即您的克隆 solveNQ，并跳转到下一行，您应该在其中删除您的皇后。

不要忘记，如果 n>col，这意味着您可以将 N 个皇后放在棋盘上，则您的输出为真。

我也必须有一个朋友帮助我解决这个问题。如果我的解释不好，请随时回复。

# objective-c - Objective C - 方法的调用者对象

> ID：15537958
> 
> 赞同：0
> 
> 时间：2013-03-21T01:36:58.580
> 
> 标签：objective-c, function, call

我有一个实用程序类，其中包含一个静态方法，可以从代码中的任何位置调用。在 Utility 方法中，有没有一种方法可以获取调用对象的引用。例如：

```
//Utility class method
+ (void) doA {
       // something similar to _sender.doB
} 
```

# javascript - 你如何在 jquery 中使用 twitter 引导按钮？

> ID：15537959
> 
> 赞同：7
> 
> 时间：2013-03-21T01:37:00.457
> 
> 标签：javascript, jquery, twitter-bootstrap

我想要做的是当用户点击论坛中的提交按钮时，它应该将收集到的数据发送到 php 脚本，理想情况下，保持在同一页面上。目前，我在表单中（我在表单中有其他标签，但这是我需要关注的两件事）

```
<form name = "reply" id="replyForm" action="sqlinserter.php" method = "POST">
<button id = "newThread" class="btn btn-primary" type="submit">Submit</button> 
```

如您所见，我使用了一个表单，当用户单击提交按钮时，该表单将数据发送到 sqlinserter.php。基本形式的东西。现在，当它单击提交时，它会转到实际的 sqlinsert.php 页面，该页面是空白的，因为它只是将数据发送到数据库。

但是，我想创建一个简单的 jquery 脚本，您可以在其中单击它使用 ajax 发送数据的按钮。我一直注意到 twitter bootstrap 与按钮的工作方式不同，我不确定如何将他们的按钮与 jquery 一起使用。对此的任何帮助都会很棒。

所以，

1.  我需要弄清楚如何在 jquery 中使用 twitter 引导按钮。具体来说，我需要弄清楚如何使用提交按钮。
2.  如何使用ajax发送数据？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-21T01:59:47.007

> 1.  我需要弄清楚如何在 jquery 中使用 twitter 引导按钮。具体来说，我需要弄清楚如何使用提交按钮。

Bootstrap 可以和 jQuery 一起使用，不需要额外的步骤。实际上，甚至 bootstrap 本身也在其框架中使用 jQuery。

您仍然可以像往常一样使用 jQuery，并像往常一样使用引导程序。两者都可以工作，没有任何冲突。

> 2.  如何使用ajax发送数据？

它可以通过使用 jQuery AJAX 函数之一来完成，例如`$.ajax`.

`click`只需在您的按钮上添加新事件 , `#newThread`。在事件处理程序中编写 AJAX。基于您的代码的示例如下所示。

**HTML**

```
<form name = "reply" id="replyForm" action="sqlinserter.php" method = "POST">
    <button id = "newThread" class="btn btn-primary" type="submit">Submit</button>
</form> 
```

**JS**

```
$(function() {
    $('#newThread').on('click', function (e) {
        e.preventDefault(); // disable the default form submit event

        var $form = $('#replyForm');

        $.ajax({
            url: $form.attr("action"),
            type: $form.attr("method"),
            data: $form.serialize(),
            success: function (response) {
                alert('response received');
                // ajax success callback
            },
            error: function (response) {
                alert('ajax failed');
                // ajax error callback
            },
        });
    });
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-21T01:42:01.850

没有任何特定方法可以使用 twitter 引导按钮。只需获取此提交的 id 并通过 ajax 提交数据，如下所示：

```
$.ajax({
            type:'GET',
            dataType:'xml',
            url:'path/to/phpfile.php',
            success:function(data) {
                // Do the handling here
            },
            error:function() {
                alert("Sorry, Ajax call Failed");  
            }
        }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T01:55:21.820

使用引导程序提交表单没有什么特别的。您只需要确保按钮在表单中（即使它不是引导程序，您也应该想要它）。

```
<form name = "reply" id="replyForm" action="sqlinserter.php" method = "POST">
<button id = "newThread" class="btn btn-primary" type="submit">Submit</button>
</form> 
```

你错过了结束`</form>`标签

# linux-kernel - Beaglebone 中的 do_gettimeofday() 给出了错误的时间

> ID：15537961
> 
> 赞同：0
> 
> 时间：2013-03-21T01:37:06.817
> 
> 标签：linux-kernel, arm, interrupt, beagleboard, gpio

我正在尝试在运行 Angstrom OS 的 Beaglebone 上测量方波的时间段。我编写了一个内核驱动程序来注册一个 ISR，我在其中对脉冲进行计时。一切正常，但测量的时间间隔完全错误。我正在使用 do_gettimeofday() 函数来测量时间。当我在用户空间程序中使用 poll() 函数执行相同操作时，我能够获得正确的值（对于 1000us 波它显示大约 1007us），但是当我使用驱动程序测量脉冲时，我得到的间隔为1923 年。我不知道为什么内核中的时间间隔高于用户空间中的时间间隔。我在下面附上了我的代码。如果有人能在我的程序中找到错误，我将不胜感激。

内核 ISR：

```
static irqreturn_t ISR ( int irq, void *dev_id)
{

prev = c;
do_gettimeofday(&c);

printk(KERN_ALERT "%ld", (c.tv_usec - prev.tv_usec));
return IRQ_HANDLED;
} 
```

用户空间编：

```
while(1){
    prev = start;
    gettimeofday(&start, NULL);
    rc = poll(&fdset, 1, 20000);
    if(rc < 0){
        printf("Error in rc\n");
        return -1;
    }

    if(rc == 0){
        printf("Timed out\n");
        return -1;
    }

    if (fdset.revents & POLLPRI) {
        len = read(fdset.fd, buf, 2);
        printf("%ld\n", (start.tv_usec - prev.tv_usec));
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-31T00:33:21.193

对于分析中断延迟，我发现懒惰并设置一个 GPIO 引脚然后用示波器测量时间非常有用。可能不是您想要的答案，但它可能会帮助您快速克服障碍。

# jquery - 引导弹出未加载 ReferenceError: jQuery is not defined

> ID：15537962
> 
> 赞同：1
> 
> 时间：2013-03-21T01:37:08.490
> 
> 标签：jquery, twitter-bootstrap, defined, referenceerror

多年来，我一直在尝试各种不同的解决方案，但我无法弄清楚为什么我的引导弹出窗口不起作用。

我得到一个：ReferenceError: $ is not defined for

```
$(function () 
```

这是我想将鼠标悬停在上面以显示弹出窗口的按钮：

```
<div class="span3 offset2">
    <a `href="http://automationrecruitment.com.au/apply/">
        <button 
            class="btn btn-large btn-block btn-primary" 
            id="lefty" 
            rel="popover" 
            data-content="this is the content to show" 
            style="min-width:116px; margin:5px;" >
                Apply
        </button>
    </a> 
```

这是我附上的脚本：

```
<script language="JavaScript" type="text/javascript" src="css/bootstrap/js/jquery-1.8.3.min.js"></script>  
<script type="text/javascript" src="/css/bootstrap/js/bootstrap-popover.js"></script>
<script type="text/javascript" src="/css/bootstrap/js/bootstrap-tooltip.js"></script> 
```

这是函数调用：

```
$(function ()  
{ 
    $("#lefty").popover();  
}); 
```

如果您认为它们可能会发生冲突，我也附加了其他引导 js

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:49:56.907

指定的语言（区分大小写）不正确。它导致这不会被解释为 javascript。错误的：

```
<script language="JavaScript" type="text/javascript" src="css/bootstrap/js/jquery-1.8.3.min.js"></script> 
```

把它改成我最喜欢的：

```
<script src="css/bootstrap/js/jquery-1.8.3.min.js"></script> 
```

或者

```
<script type="text/javascript" src="css/bootstrap/js/jquery-1.8.3.min.js"></script> 
```

或者

```
<script language="javascript" type="text/javascript" src="css/bootstrap/js/jquery-1.8.3.min.js"></script> 
```

它将成功地被解释为 javascript 并定义 jQuery / $

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T16:15:13.613

在引用 bootstrap.js**之前**，您必须引用 jquery 。像这样：

```
<!-- include jQuery first!!! -->
<script src="/lib/jquery/jquery-1.10.2.min.js"></script>

<script src="/lib/bt/js/bootstrap.js"></script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-12-23T09:55:29.710

在Script标签中将defer属性放在type属性之前，defer='defer'在每个脚本中一个一个地渲染页面并检查弹出功能。

有时，js 中写入的功能会相互冲突，或者不使用更新的插件文件。所以为了两个或多个文件不会相互冲突，请将 defer 属性放在 script 标签中。

我希望它对你有用。

谢谢。

# php - 无法使用php将数据插入mysql

> ID：15537966
> 
> 赞同：0
> 
> 时间：2013-03-21T01:37:42.180
> 
> 标签：php, mysql

我已经尝试了两天来解决这个问题。我从教程中逐字复制，但仍然无法将数据插入表中。这是我的表单代码

```
<font face="Verdana" size="2"> 
<form method="post" action="Manage_cust.php" >
Customer Name 
<font face="Verdana"> 
<input type="text" name="Company" size="50"></font>
<br>
Customer Type 
<font face="Verdana"> 
<select name="custType" size="1">
  <option>Non-Contract</option>
  <option>Contract</option>
</select></font>
<br>
Contract Hours 
<font face="Verdana"> 
<input type="text" name="contractHours" value="0"></font>
<br>
<font face="Verdana">
<input type="submit" name="dothis" value="Add Customer"></font>
</form>
</font> 
<font face="Verdana" size="2">

<?php
    if (isset($_POST['dothis'])) {

    $con = mysql_connect ("localhost","root","password");
    if (!$con){
    die ("Cannot Connect: " . mysql_error());
    }

    mysql_select_db("averyit_net",$con);

    $sql = "INSERT INTO cust_profile (Customer_Name, Customer_Type, Contract_Hours)   VALUES 
    ('$_POST[Company]','$_POST[custType]','$_POST[contractHours]')";

    mysql_query($sql, $con);

    print_r($sql);

    mysql_close($con);
    }
?> 
```

这是我的 PHPmyadmin 服务器信息：

服务器：127.0.0.1 通过 TCP/IP 软件：MySQL 软件版本：5.5.27 - MySQL Community Server (GPL) 协议版本：10 用户：root@localhost 服务器字符集：UTF-8 Unicode (utf8)

请告诉我为什么这不起作用。当我运行该站点时，它会将信息放入其中，当我按下提交按钮时它会消失，但它不会进入表格。没有显示错误消息。帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-18T20:36:00.877

将 $sql 更改为：

```
$sql = "INSERT INTO cust_profile (Customer_Name, Customer_Type, Contract_Hours)   VALUES ('".$_POST[Company]."','".$_POST[custType]."','".$_POST[contractHours]."') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T02:00:54.380

我对您的 SQL 语句进行了一些改进，将其存储在一个数组中，这是为了确保您的帖子数据确实已设置，否则它将抛出一个空值。请始终清理您的输入。

在您的 Manage_cust.php 中：

```
<?php

if (isset($_POST['dothis'])) 
{

$con = mysql_connect ("localhost","root","password");
    if (!$con)
    {
        die ("Cannot Connect: " . mysql_error());
    }

mysql_select_db("averyit_net",$con);

$company = isset($_POST['Company'])?$_POST['Company']:NULL;
$custype = isset($_POST['custType'])?$_POST['custType']:NULL;
$hours   = isset($_POST['contractHours'])?$_POST['contractHours']:NULL;

$sql = "INSERT INTO cust_profile(Customer_Name, 
                                 Customer_Type, 
                                 Contract_Hours)   
        VALUES('$company',
               '$custype',
               '$hours')
       ";

       mysql_query($sql, $con);

       mysql_close($con);
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-21T02:01:29.280

首先，不要使用`font`标签......[永远](http://www.w3.org/TR/html4/present/graphics.html#h-15.2)

其次，因为这条线：

```
if (isset($_POST['dothis'])) { 
```

看起来您的 HTML 和 PHP 合并为一个脚本？在这种情况下，您需要将表单上的操作更改为以下内容：

```
<form method="post" action="<?php echo $_SERVER['PHP_SELF']; ?>" > 
```

另外，您可以在一行中终止不良连接：

```
$con = mysql_connect("localhost","root","password") or die("I died, sorry." . mysql_error() ); 
```

检查您的帖子，`isset()`然后将值分配给变量。

```
var $company;
if(isset($_POST['Company']) {
    $company = $_POST['Company'];
} else {
    $company = null;
}
//so on and so forth for the other fields 
```

或者使用[三元运算符](http://davidwalsh.name/php-shorthand-if-else-ternary-operators)

此外，使用原始`mysql`PHP API 通常是一个糟糕的选择。[它甚至在API 的 PHP 手册中](http://www.php.net/manual/en/function.mysql-connect.php)提到

总是更好，`mysqli`所以`PDO`让我们转换一下：

```
//your connection
$conn = mysqli_connect("localhost","username","password","averyit_net");

if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$sql = "INSERT INTO cust_profile (Customer_Name, Customer_Type, Contract_Hours) 
        VALUES ($company,$custType,$contractHours)";
            //  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
            //  Assuming you set these

$stmt = mysqli_prepare($conn, $sql);
$stmt->execute();
$stmt->close(); 
```

有人告诉我这是不是错的，所以我可以纠正它。我有`mysqli`一段时间没用了。

# php - 使用 PHP 和 MySQL 的嵌套列表

> ID：15537968
> 
> 赞同：0
> 
> 时间：2013-03-21T01:37:54.453
> 
> 标签：php, mysql, html-lists

我只需要使用 PHP 和 MySQL 创建一个嵌套或多级列表。我怎样才能让这个显示所有客户，然后显示与每个给定客户相关的所有电话号码。

例如：

约翰

555 555-5555

666 666-6666

克里斯汀

777 777-7777

艾米

888 888-8888

999 999-9999

222 222-2222

```
<?php
$result = mysqli_query($dbc,"
SELECT 
fname,
phone
FROM 
customer,
phone,
customer_phone
WHERE
customer.id=customer_phone.customer_id
AND
phone.id=customer_phone.phone_id
");
while($row = mysqli_fetch_array($result))
{
echo $row['fname'];
echo "<br />";
echo $row['phone'];
echo "<br />";
}
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T01:50:11.050

查看 order by 以及我如何仅在第一次出现时打印名称。另外，学习使用“on”子句正确加入。

```
<?php
$result = mysqli_query($dbc,"
SELECT fname, phone
FROM customer
join customer_phone on customer.id=customer_phone.customer_id
join phone on customer_phone.phone_id=phone.id
order by fname
");
$oldname = null;
while($row = mysqli_fetch_array($result))
{
    if($oldname != $row['fname'])
    {
        echo $row['fname']."<br>";
        $oldname = $row['fname'];
    }
    echo $row['phone']."<br>";
}
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T01:53:28.683

我会做一个客户课程，这样我可以存储更多信息，而不仅仅是电话或姓名

```
class Customer {
   public $phone = array();
   public $name = '';
}
while($row = mysqli_fetch_array($result))
{
$customerList[$row['fname']] = new Customer;
$customerList[$row['fname']]->name = $row['fname'];
array_push($customerList[$row['fname']]->phone, $row['phone'])
} 
```

但是你也可以只做一个简单的数组，键是客户姓名，值是客户电话的数组，如果你没有其他想要存储的话

# c# - 我如何找出 KERNELBASE.dll 错误？

> ID：15537977
> 
> 赞同：1
> 
> 时间：2013-03-21T01:38:30.773
> 
> 标签：c#

我的 Windows 应用程序出现以下错误。异常我无法弄清楚它为什么会出现，因为特定错误没有登录到我的异常记录器文件中。

```
应用程序名称失败：Test.exe，版本：1.0.0.15，时间戳：0x51481394
失败的模块名称：KERNELBASE.dll，版本：6.1.7601.18015，时间戳：0x50b83b16
异常代码：0xe053534f
故障偏移量：0x0000812f
进程 ID 失败：0x%9
应用程序的启动时间失败：0x% 10
应用程序路径失败：% 11
模块路径失败：% 12
报告 ID：% 13

```

请在下面找到代码

```
private void frmSetTime_Load(object sender, EventArgs e)
{
    try
    {
        string[] cmds = System.Environment.GetCommandLineArgs();
        //Here i gets Command Line Arguments
    }
    catch (Exception ex)
    {
        MessageBox.show(ex.message);
    }
    finally
    {
        GC.Collect();
    }
}

public void ExecuteLogic(Object obj)
{
    try
    {
        //My set of Statements
        Therad.sleep(5000);
        ExecuteLogic(obj);
    }
    catch (Exception ex)
    {
        MessageBox.show(ex.message);
    }
    finally
    {
        GC.Collect();
        ApplicationRestart();
    }
}

private void ApplicationRestart()
{
    try
    {
        if (Process.GetCurrentProcess().WorkingSet64 >= 10000000)
        {                         
            Application.Restart();                    
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.message);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T02:56:05.463

你有无限递归，`ExecuteLogic`它不断地调用自己。这最终会使系统耗尽堆栈空间。如果您不想离开，请`ExecuteLogic`使用 while 循环

# php - 如何获取每个类别的最新文章日期

> ID：15537978
> 
> 赞同：0
> 
> 时间：2013-03-21T01:38:32.667
> 
> 标签：php, mysql

我有一张`articles`桌子和一张`categories`这样的桌子：

```
 articles
-----------------------------------------------
| id | datetime | title | categoryid | status |
-----------------------------------------------

 categories
-------------
| id | name |
------------- 
```

我需要从选择中的每个类别中获取最新文章的日期，例如：

```
 result
----------------------------------------------------------
| category id | category name | most recent article date | 
---------------------------------------------------------- 
```

结果必须包含所有类别 + 每个类别的最新文章（状态 = 0）日期。

它的结果必须与`select * from categories`PLUS 一个新行显示该`datetime`类别的最新文章的结果完全相同，**但仅当文章状态为 0**时。

明白了吗？

我需要它的原因是因为我正在尝试制作动态站点地图，并且我需要每个类别的最新文章的时间才能显示在`<lastmod>`类别列表的标签上。

```
$sql = mysql_query(".....?......");

while ($string = mysql_fetch_array($sql)){?>
    <url>
        <loc>http://www.url.com/<?echo $string['id'];?>/<?echo generate_seo_link($string['name']);?>/</loc>
        <priority>0.5</priority>
        <changefreq>daily</changefreq>
        <lastmod><? echo date("d/m/Y H:i:s", strtotime($string['date'])); ?></lastmod>
    </url>
<?} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:42:27.707

**UPDATE2**容纳`status`

```
SELECT c.id, c.name, MAX(a.datetime) most_recent
  FROM articles a RIGHT JOIN
       categories c ON a.categoryid = c.id
 WHERE a.status IS NULL OR a.status = 0
 GROUP BY c.id, c.name 
```

输出

```
| ID |      NAME |  RECENT_DT |
-------------------------------
|  1 | Category1 | 2013-03-19 |
|  2 | Category2 | 2013-03-17 |
|  3 | Category3 |     (null) | 
```

这是**[SQLFiddle](http://sqlfiddle.com/#!2/40efd/2)**

附带说明

> 请不要将 mysql_* 函数用于新代码。它们已被 [弃用](http://php.net/manual/en/intro.mysql.php)。对[PDO](http://php.net/pdo) 或[MySQLi](http://php.net/mysqli)使用 [准备好的语句](http://goo.gl/vn8zQ)。这是一个很好的[PDO 教程](http://goo.gl/vFWnC)。

# azure - 为什么没有为我的 Azure Web 角色复制我的 IIS 日志？

> ID：15537981
> 
> 赞同：0
> 
> 时间：2013-03-21T01:38:54.010
> 
> 标签：azure, azure-diagnostics

[这是对这个问题](https://stackoverflow.com/questions/15501473/do-i-have-to-redeploy-an-azure-web-role-to-turn-on-iis-logging/15502243)的跟进。我使用 Cerebrata 诊断管理器远程诊断来尝试打开 IIS 日志。我没有部署它。它似乎有效，并且复制了一些文件。然后它似乎再也没有工作了。我再次调整了设置。我尝试删除与 iis 相关的 blob 和表存储条目，以查看是否可以重新开始。这是 wad-control-container 中配置的样子，表明它似乎是基于 Cerebrata 工具更新的。

```
<?xml version="1.0"?>
<ConfigRequest xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <OnDemandTransfers />
  <DataSources>
    <OverallQuotaInMB>4096</OverallQuotaInMB>
    <Logs>
      <BufferQuotaInMB>1024</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>1</ScheduledTransferPeriodInMinutes>
      <ScheduledTransferLogLevelFilter>Undefined</ScheduledTransferLogLevelFilter>
    </Logs>
    <DiagnosticInfrastructureLogs>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>0</ScheduledTransferPeriodInMinutes>
      <ScheduledTransferLogLevelFilter>Undefined</ScheduledTransferLogLevelFilter>
    </DiagnosticInfrastructureLogs>
    <PerformanceCounters>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>0</ScheduledTransferPeriodInMinutes>
      <Subscriptions />
    </PerformanceCounters>
    <WindowsEventLog>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>0</ScheduledTransferPeriodInMinutes>
      <Subscriptions />
      <ScheduledTransferLogLevelFilter>Undefined</ScheduledTransferLogLevelFilter>
    </WindowsEventLog>
    <Directories>
      <BufferQuotaInMB>0</BufferQuotaInMB>
      <ScheduledTransferPeriodInMinutes>1</ScheduledTransferPeriodInMinutes>
      <Subscriptions>
        <DirectoryConfiguration>
          <Path>C:\Resources\directory\8973cd09642f4dfeafe830612cc8c1fe.AllRole.DiagnosticStore\FailedReqLogFiles</Path>
          <Container>wad-iis-failedreqlogfiles</Container>
          <DirectoryQuotaInMB>1024</DirectoryQuotaInMB>
        </DirectoryConfiguration>
        <DirectoryConfiguration>
          <Path>C:\Resources\directory\8973cd09642f4dfeafe830612cc8c1fe.AllRole.DiagnosticStore\LogFiles</Path>
          <Container>wad-iis-logfiles</Container>
          <DirectoryQuotaInMB>1024</DirectoryQuotaInMB>
        </DirectoryConfiguration>
        <DirectoryConfiguration>
          <Path>C:\Resources\directory\8973cd09642f4dfeafe830612cc8c1fe.AllRole.DiagnosticStore\CrashDumps</Path>
          <Container>wad-crash-dumps</Container>
          <DirectoryQuotaInMB>1024</DirectoryQuotaInMB>
        </DirectoryConfiguration>
      </Subscriptions>
    </Directories>
  </DataSources>
  <IsDefault>false</IsDefault>
</ConfigRequest> 
```

关于为什么它似乎不起作用的任何想法？

**更新**

我们今天使用以下 diagnostics.wadcfg 重新部署，但仍然没有 IISLogs。跟踪日志正在工作。我们没有任何调用诊断的代码，因为我的理解是该文件可以处理所有这些。我错过了什么吗？

```
<DiagnosticMonitorConfiguration xmlns="http://schemas.microsoft.com/ServiceHosting/2010/10/DiagnosticsConfiguration"
      configurationChangePollInterval="PT1M"
      overallQuotaInMB="4096">
  <Logs bufferQuotaInMB="1024"
     scheduledTransferLogLevelFilter="Verbose"
     scheduledTransferPeriod="PT1M" />
  <Directories bufferQuotaInMB="1024"
   scheduledTransferPeriod="PT1M">

    <!-- These three elements specify the special directories 
           that are set up for the log types -->
    <CrashDumps container="wad-crash-dumps" directoryQuotaInMB="256" />
    <FailedRequestLogs container="wad-frq" directoryQuotaInMB="256" />
    <IISLogs container="wad-iis" directoryQuotaInMB="256" />

  </Directories>
</DiagnosticMonitorConfiguration> 
```

会不会是 Web 角色是 XS 实例（因为我们现在只是在测试）？同样，它确实工作过一次，但现在似乎已经死了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T02:32:52.490

几点建议：

1.  将OverallQuotaInMB 降低到4000

2.  将 Directories 节点下的 BufferQuotaInMB 增加到一个数字（比如 1 gig）

3.  降低其他单独的目录配额，使它们加起来略低于 #2 中的 BufferQuotaInMB，并且所有配额（包括整个目录和单个文件夹都在OverallQuotaInMB 之下）。IE：日志 - 1gig（这是跟踪数据），目录：1 gig，FailedRequests：256mb，IISLogs：256mb，CrashDumps：256mb

4.  重新启动服务器（以防万一）

5.  祝你好运

基本上，当整体配额设置为 Azure 为诊断存储分配的最大空间 (4gig) 时，我已经看到诊断行为很挑剔。降低单个配额以使它们加起来小于总配额也有帮助，因为如果 Azure 诊断已满，在 Azure 删除旧数据之前还有喘息的空间。

总体而言，设置 Azure 诊断是一种黑魔法。两年来我一直在帮助 AzureWatch 客户做到这一点，但我仍然觉得我对配额感到摸不着头脑。希望他们只是让用户打开或关闭这个东西，让整个配置由约定与配置驱动。几乎没有人关心将数据捕获到他们的 VM 上，而不是将其传输到 Azure 存储，因此对于大多数情况来说，小配额是完全可以的，因为大多数人每隔几分钟就会将他们的数据传输到存储中。

高温高压

# unity3d - 需要 Unity 角色控制器进行 90 度急转弯并且转弯时不滑动

> ID：15537983
> 
> 赞同：1
> 
> 时间：2013-03-21T01:39:09.697
> 
> 标签：unity3d, physics, momentum

我正在使用第一人称控制器进行角色移动。在左箭头键上，我希望角色立即旋转 90 度并继续前进。目前，当我按下箭头键时，角色进行了 90 度的急转弯，但角色之前的前进动力需要一秒钟才能消退，因此角色最终会朝他之前移动的方向滑动。

我能想到的最接近的例子来直观地解释我正在尝试做的事情是角色如何在 Temple Run 中变得敏锐。我的游戏目前是如何运作的，如果我让壁架上的角色向左急转，他很可能会保持原来的动力并在转弯后立即滑出边缘。

由于我的角色在 x/z 轴上运行，我想知道是否有某种方法可以交换方向速度/动量？角色在 x 轴上的速度在它转动时会立即切换到 z 轴，而另一个将设置为零。我显然愿意接受任何可以完成我正在寻找的解决方案。

我深入研究了第一人称控制器中的 CharacterMotor 类，但还没有找到我可以调整的部分来实现这一点。

我将不胜感激任何帮助。

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T08:52:02.220

您可以尝试在转弯前停止刚体的速度。

```
this.rigidbody.velocity = Vector3.zero;
this.rigidbody.angularVelocity = Vector3.zero; 
```

如果您希望对象像它一样继续，您可以尝试通过将当前速度保存在变量中，将其设置为 0，旋转它然后放回旧速度（仍然向前）来尝试使用它。

如果它适用于全局向量（所以从世界的角度来看，而不是对象），那么你可以尝试否定速度，实际上导致它“向后”。我现在无法测试它，但无论哪种方式，我认为您需要先将速度设置为零，然后再转动角色。

# php - 如何在 JSON 中构造数组数组

> ID：15537987
> 
> 赞同：0
> 
> 时间：2013-03-21T01:39:23.837
> 
> 标签：php, json, ios5, ios6

如果有几个数组称它们为颜色、植物、汽车、家庭，每个数组或这些数组的长度相同 5 项

我想创建另一个称为分组的数组，它的设置如下

项目将包含包含的组

```
group[0]=>( color=>color[0],plant=>plant[0],car=>car[0],family=>family[0] )
group[1]=>( color=>color[1],plant=>plant[1],car=>car[1],family=>family[1] )
group[2]=>( color=>color[2],plant=>plant[2],car=>car[2],family=>family[2] )
group[3]=>( color=>color[3],plant=>plant[3],car=>car[3],family=>family[3] )
group[4]=>( color=>color[4],plant=>plant[4],car=>car[4],family=>family[4] ) 
```

如何将其设置为 for 循环实际上我有 50 个项目，每个项目有 13 个元素

然后我将使用 PHP json_encode 将其放入 JSON 以便我可以传输它

我需要把它放到 iOS 字典中，这样我就可以调用组中的一个元素并轻松访问任何元素

如果我调用 group3 我可以获得所有匹配的元素

这将如何在 PHP 中设置

很抱歉说清楚上面显示的是我想要的结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T06:35:12.977

如果我错了，请纠正我。但我做过这些事情的最简单方法如下：

```
var group= [];

for(var i=0;i<50;i++)
{

    var aGroup={};
    for(var j=0;j<13;j++)
    {
    aGroup.color[j]=color[j]; // colors array
    aGroup.plant[j]=plant[j]; //plant array
    aGroup.family[j]=family[j];//family array
    }
    group[i]=aGroup; //finally add aGroup to group

    }
    //to access color you can do following
    group[0].aGroup.color[0]; //not tested 
```

如果您发现任何问题，请告诉我。

# javascript - 太多的递归方案 javascript

> ID：15537996
> 
> 赞同：1
> 
> 时间：2013-03-21T01:40:18.217
> 
> 标签：javascript, recursion, scheme

我在 javascript 中使用方案解释器

当我尝试此代码时，我收到错误“递归过多”：

```
;;;basic things
(define map 
  (lambda (f l) 
    (if (null? l) l 
        (cons (f (car l)) (map f (cdr l))))))

(define filter 
  (lambda (p l)
    (if (null? l) l 
        (if (p (car l))
            (cons (car l) (filter p (cdr l)))
            (filter p (cdr l))))))

(define accumulate 
  (lambda (op initial sequence)
    (if (null? sequence)
        initial
        (op (car sequence)
        (accumulate op initial (cdr sequence))))))

(define reduce 
  (lambda (op sequence)
    (accumulate op (car sequence) (cdr sequence))))

(define append 
  (lambda (l1 l2)
    (if (null? l2) l1
        (append (cons (car l2) l1) (cdr l2)))))

(define make-list 
  (lambda (n f l)
    (if (= n 0) l
        (make-list (- n 1) f (cons (f n) l)))))

(define make-list2-
  (lambda (f n1 n2 l)
    (if (> n1 n2) l
        (make-list2- f (+ n1 1) n2 (cons (f n1) l)))))
(define make-list2 (lambda (f n1 n2) (make-list2- f n1 n2 null)))
(define identity (lambda (x) x))
(define randomitem (lambda (l) (nth (ceil (* (random ) (length l))) l))) 
;;;

(define random0to3 (lambda () (floor (* 4 (random )))))

(define moverandom (lambda (this) (move this (random0to3 ))))

(define searchforcreature 
  (lambda (this cx cy)    ;search only for neighbor tiles
    (begin (define y (make-list2 identity (- cy 5) (+ cy 5)))
         (define L (map (lambda (x) (map (lambda (y2) (cons x y2)) y))
           (make-list2 identity (- cx 5) (+ cx 5))))
        (define L2 (reduce append L))
        (define listoftiles (map (lambda (x) (tile-from-pos (car x) (cdr x))) L2))
        (define listoftiles2 (filter identity listoftiles))    ;remove the falses you get from trying invalid positions
        (define listofcreatures (filter (lambda (x) (and (creature? x) (not (= x this)))) (map topthing listoftiles2)))
        ;(pairtostring listofcreatures)
        (if (null? listofcreatures)
            #f
            (car listofcreatures)))))

(define update 
  (lambda (this world) 
    (begin
      (define target (searchforcreature this (creature-x this) (creature-y this)))
      (begin (print target)
      (if target
          (attack this target)
          (moverandom this)))))) 
```

但是在 searchforcreatures 函数中使用 10 而不是 5，这意味着我创建了一个包含 400 个项目的列表，然后使用 tile-from-pos 函数映射它们但是当我在 drScheme 中测试相同的函数时它运行良好，是因为 javascript 没有'不优化递归？

我的游戏，您可以在其中测试上述代码：thesamesite/textarea.html

游戏的主要代码，在scheme：thesamesite/env0.sc

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:45:28.047

需要方案实现来优化尾调用，以便递归在恒定空间中执行。最有可能的是，假设您的代码是尾递归的，那么基于 Javascript 的“解释器”并没有进行这种优化。[实际上，可能考虑到优化将在编译期间完成，而不太可能在解释期间完成。]

# c - 为什么我在这个程序中使用指针时会出现垃圾？C语言

> ID：15537997
> 
> 赞同：0
> 
> 时间：2013-03-21T01:40:39.390
> 
> 标签：c, function, pointers, garbage

我是一名 C++ 程序员，试图掌握 C 语言语法，但我不明白为什么在此函数中使用指针时会得到垃圾值。

```
#include<stdio.h>
#include <math.h>

void separate(double, double *dollar, double *quarter, double *dime, double *nickle,  double *penny);
int
main(void)
{
double amount = 38.39, change, paid = 40.0, dollar, quarter, dime, nickle, penny;

change = paid - amount;
separate(change, &dollar, &quarter, &dime, &nickle, &penny);

printf("Your total change is: $%d\n", change);
printf("Dollars: %d\n", dollar);
printf("Quarters: %d\n", quarter);
printf("Dimes: %d\n", dime);
printf("Nickles: %d\n", nickle);
printf("Pennies: %d\n", penny);

getchar();
return (0);
}

void separate(double change, double *dollar, double *quarter, double *dime, double *nickle, double *penny)
{
double coins;
coins = change - floor(change);
*dollar = floor(change);
*quarter = coins / 25;
coins = coins - (*quarter * 25);
*dime = coins / 10;
coins = coins - (*dime * 10);
*nickle = coins / 5;
*penny = coins - (*nickle * 5);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T01:50:43.117

您正在使用 %d 打印双打！试试 %f

```
printf("Your total change is: $%f\n", change);
printf("Dollars: %f\n", dollar);
printf("Quarters: %f\n", quarter);
printf("Dimes: %f\n", dime);
printf("Nickles: %f\n", nickle);
printf("Pennies: %f\n", penny); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T01:52:39.700

确实。相当不直观，但 printf 语句中的 %d 用于*整数*。尝试使用 %f 打印*浮点数*。

我还建议你看看[这个](http://www.cplusplus.com/reference/cstdio/printf/)：

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-21T01:52:59.610

您正在尝试使用 打印双精度变量`%d`，`printf`然后将双精度（或其一部分）的内存作为整数变量的内存，因为`printf`用作`va_list`指向参数的指针，如果您分配不适当的格式，则 arg 点的类型将也会出错。

全部替换`%d`为`%f`。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-21T01:54:35.453

我怀疑您的问题是您没有正确进行除法。

看一看：

```
void separate(double change, double *dollar, double *quarter, double *dime, double *nickle, double *penny)
{
    // for your example, change is initially 1.61
    double coins;
    coins = change - floor(change);  // .61
    *dollar = floor(change);         // 1
    *quarter = coins / 25;           // .0244
    coins = coins - (*quarter * 25); // 0
    *dime = coins / 10;              // 0
    coins = coins - (*dime * 10);    // 0
    *nickle = coins / 5;             // 0
    *penny = coins - (*nickle * 5);  // 0
} 
```

整数除法和浮点除法的工作方式不同。相反，您应该乘以 100 得到美分数，除以 25 得到四分之一数，然后按地板求整数。

```
*quarters = floor(coins * (100 / 25)); // floor(2.44) = 2
coins = coins - *quarters * 25;        // .11 
```

根据需要重复以获得其他硬币的数量。

此外，其他人都提到您正在使用`%d`打印双精度而不是`%f`(`%d`是整数格式字符串) 所以我也会提到它，因为它是问题的一部分。