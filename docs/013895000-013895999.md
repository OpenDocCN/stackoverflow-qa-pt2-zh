# StackOverflow 问答 13895000-13895999

# c - 从大型 C 库中创建一个子集

> ID：13895003
> 
> 赞同：4
> 
> 时间：2012-12-15T18:36:27.463
> 
> 标签：c, embedded, gsl

我在我的 C 应用程序中使用 GSL 库的一些功能。这个库很大，有很多功能和设施，我只想要其中的几个。我的问题是我想在一个小型嵌入式系统上使用我的应用程序，而使用这个大型库会使我编译的应用程序变得如此之大。

是否有任何工具可以从如此大的库中提取特定的函数和文件子集？

谢谢大家，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-16T09:21:26.023

> 是否有任何工具可以从如此大的库中提取特定的函数和文件子集？

是的 - 这就是链接器已经做的事情。

如果单个目标代码文件，库是一个集合。链接器将仅链接那些实际解析代码中的引用所必需的目标文件。只要库设计者使库足够*细化*（理想情况下，每个目标文件一个公共函数），那么您链接的应用程序代码将与库的大小完全无关，仅与您明确引用的代码的总和有关。

所以我的建议是先构建代码，然后看看你是否真的有问题——很有可能你没有。请记住，您的应用程序可能已经链接了标准 C 库，而这本身并不会使您的应用程序具有整个库的大小！

链接器将能够输出一个 MAP 文件，该文件将详细说明链接的目标代码以及其中的函数和数据对象。您将能够确定链接的效率 - 请记住，尽管您调用的函数很可能会调用您自己未明确引用的库中的其他函数。您的链接器还可以输出详细说明此类依赖关系的交叉引用表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-20T14:49:55.787

您实际上可以使用 mklibs：[https ://launchpad.net/mklibs](https://launchpad.net/mklibs)

它能够基于一组取决于该库的可执行文件剥离共享库中未使用的部分。

您甚至不必拥有库的代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T18:50:34.813

如果您可以修改 GLS 库，您可以尝试制作一个精简版本。

最好的方法是使用类似工具生成调用者/被调用者图`doxygen`，而不是只选择使用和需要的东西。可能您也可能会忽略一些依赖项（例如日志记录、管理状态、您不需要的选项）。

然而，这种方法将需要大量的工作。但是，如果您使用的是小型嵌入式系统，那么“精简版”可能没有那么多代码行，因此挑选樱桃可能是合理的。

# mongodb - $unwind 空数组

> ID：13895006
> 
> 赞同：38
> 
> 时间：2012-12-15T18:37:08.473
> 
> 标签：mongodb, aggregation-framework

我有一组用户，其中每个文档都具有以下结构：

```
{
  "_id": "<id>",
  "login": "xxx",
  "solved": [
    {
      "problem": "<problemID>",
      "points": 10
    },
    ...
  ]
} 
```

该字段`solved`可能为空或包含任意多个子文档。我的目标是获取用户列表以及总分（总和`points`），其中尚未解决任何问题的用户将被分配总分 0。这是否可以通过单个查询来做到这一点（理想情况下使用聚合框架）？

我试图在聚合框架中使用以下查询：

```
{ "$group": {
  "_id": "$_id",
  "login": { "$first": "$login" },
  "solved": { "$addToSet": { "points": 0 } }
} }
{ "$unwind": "$solved" }
{ "$group": {
  "_id": "$_id",
  "login": { "$first": "$login" },
  "solved": { "$sum": "$solved.points" }
} } 
```

但是我收到以下错误：

```
exception: The top-level _id field is the only field currently supported for exclusion 
```

先感谢您

* * *

## 回答 #1

> 赞同：117
> 
> 时间：2016-05-24T08:32:07.330

使用 MongoDB 3.2 和更高版本，**[`$unwind`](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/)**操作员现在有一些选项，特别是该`preserveNullAndEmptyArrays`选项可以解决这个问题。

如果此选项设置为 true，并且路径为 null、缺失或空数组，**[`$unwind`](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/)**则输出文档。如果为 false，**[`$unwind`](https://docs.mongodb.com/manual/reference/operator/aggregation/unwind/)**则在路径为 null、缺失或空数组时不输出文档。在您的情况下，将其设置为 true：

```
db.collection.aggregate([
    { "$unwind": {
        "path": "$solved",
        "preserveNullAndEmptyArrays": true
    } },
    { "$group": {
        "_id": "$_id",
        "login": { "$first": "$login" },
        "solved": { "$sum": "$solved.points" }
    } }
]) 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-16T04:14:59.623

这是解决方案 - 它假设“已解决”字段不存在、等于 null 或解决了一系列问题和分数。它不处理的情况是“解决”为空数组 - 尽管这将是您可以添加的简单附加调整。

```
project = {$project : {
        "s" : {
            "$ifNull" : [
                "$solved",
                [
                    {
                        "points" : 0
                    }
                ]
            ]
        },
        "login" : 1
    }
};
unwind={$unwind:"$s"};
group= { "$group" : {
        "_id" : "$_id",
        "login" : {
            "$first" : "$login"
        },
        "score" : {
            "$sum" : "$s.points"
        }
    }
} 
```

`db.students.aggregate( [ project, unwind, group ] );`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2022-03-05T12:25:07.693

$lookup 然后 $unwind 在查找数组中，这可能是空的

```
 let posts = await Post.aggregate<ActivityDoc>([
    {
      $match: {
        _id: new mongoose.Types.ObjectId(req.params.id),
      },
    },
    {
      $lookup: {
        from: 'users',
        localField: 'user',
        foreignField: '_id',
        as: 'user',
      },
    },
    {
      $unwind: '$user',
    },
    {
      $unwind: {
        path: '$user.follower',
        preserveNullAndEmptyArrays: true,
      },
    },
    {
      $match: {
        $or: [
          {
            $and: [
              {
                'privacy.mode': {
                  $eq: PrivacyMode.EveryOne,
                },
              },
            ],
          },
          {
            $and: [
              {
                'privacy.mode': {
                  $eq: PrivacyMode.MyCircle,
                },
              },
              {
                'user.follower.id': {
                  $eq: req.currentUser?.id,
                },
              },
            ],
          },
        ],
      },
    },
  ]); 
```

# google-chrome - 从 popup.js 和 content-scripts 向 background.html 传递消息

> ID：13895007
> 
> 赞同：0
> 
> 时间：2012-12-15T18:37:08.390
> 
> 标签：google-chrome, google-chrome-extension, chromium, message-passing

我正在尝试获取弹出/弹出菜单以根据当前页面 URL 向用户显示不同的内容，但无法获得连接。我读过只有**background.html**可以访问 Chrome 框架中的 current-tabs 的 URL，所以我试图让它通过消息传递告诉我的 content-script 和我的 popup.js——背景。 html 将收到一条消息，并将在响应中包含正确的信息。Popup 应该能够使用 getBackgroundPage() 但不允许使用内容注入脚本，所以我想对两者都使用消息传递并有一个通用的解决方案。

所以......关于失败连接的控制台消息被隐藏在一些我什至无法查看的随机实现代码中，即： miscellaneous_bindings:236 或 miscellaneous_bindings:235，具体取决于 cal 的参数。试图查看我们击中的位置让我知道：

> **位于 chrome-devtools://devtools/miscellaneous_bindings 的网页可能暂时关闭，或者它可能已永久移动到新的网址。**

我确信我在做一些愚蠢的事情，否则我的系统就搞砸了，但我不知道是哪个。我看到的大多数示例和问题要么需要*beta*发布通道功能，要么使用 v1.0 清单，使用不推荐使用的功能（来自 2011 年的问题），或者没有接受的答案。我使用的是 Chrome 24.0.1312.40 m，并且我禁用了其他扩展。

这是我们的设置方式...

**popup.html**

```
<!doctype html>
<html>
    <head>
        <title>Working title popup</title>
        <script src="popup.js">
            // nothing allowed in here
        </script>
    </head>
    <body>

    <form>
        <fieldset>
        <button>Demo</button>
        <!--^ push to try again to get response string from background -->
        </fieldset>
    </form>

    </body>
</html> 
```

**popup.js：**

```
asky();

function asky(){
        catchersMit=null;
        console.log("Going to get info.");
        // Below causing Port error: 
        //"Could not establish connection. Receiving end does not exist.":
        chrome.extension.sendMessage({msg:"need some info"} //arg1
                                     ,function(response){   //arg2
                                        alert(reponse.msg);
                                        //^ yields undefined in alert window
                                        catchersMit=response;}
                                    );
        //_*_ catchersMit still appears undefined out here.
} 
```

**背景.html：**

```
<!doctype html>
<html><head><script type="text/javascript">
chrome.extension.onMessage.addListener(

function(message,sender,sendResponse){
                sendResponse( {msg: "info you wanted"} );
} // anonymous (1st parameter) function OUT

); // onRequest listener OUT
</script></head><body></body></html> 
```

**清单.json：**

```
{
  "name": "Extension Working Title",
  "version": "1.0",
  "manifest_version": 2,
  "description": "Coolest functionality.",
        "browser_action": {
    "default_icon": "lnr_icon.png",
        "default_popup": "popup.html"
  },

  "permissions": [ "tabs","http://*/*" ],
  "background": { "page": "background.html" }
} 
```

现在我只是在使用 popup.js，因为我发现它更容易调试，但如果我没记错的话，这个问题的解决方案与内容脚本应该没有什么不同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T18:48:55.267

假设您需要问题陈述（`I'm trying to get the popup/popopen menu to show the user different content based off the current page-URL`）中的当前浏览选项卡 URL，以下代码将获取当前浏览选项卡 URL，您可以[在其上播放](https://developer.chrome.com/extensions/tabs.html#method-query)以过滤所需信息。

```
chrome.tabs.query({
            "status": "complete",
            "currentWindow": true,
            "active": true
        }, function (tabs) {
            for(tab in tabs)console.log(tabs[tab].url);
}); 
```

无需在后台和浏览器操作 HTML 页面之间添加消息传递。

内容脚本已经通过`window.location.href`

# calendar - viewContainer 选项对 DojoX 日历有什么作用？

> ID：13895009
> 
> 赞同：-1
> 
> 时间：2012-12-15T18:37:21.217
> 
> 标签：calendar, dojo

我将日历包含在`<div id="calendardiv">`具有相对位置的 a 中，因此日历不会与我的应用程序的主菜单重叠。参数的作用是`viewContainer`什么？该[文档](http://dojotoolkit.org/api/)只是说它包含您的日历视图。那是什么意思？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T11:12:02.163

正如您在文档中看到的那样，这将返回一个`domNode`. 由于没有更多关于它的内容，在我看来，这似乎是一个“占位符`domNode`”，用于存储`views`可以显示在您的`calendar`小部件中的内容。

在每个包含小部件实际出现的表示中还有另一个`domNode`-property 。`widget`在我看来，小部件图片似乎`viewContainer`从他们需要的视图中构建并构建所需的表示......您可以通过在运行时将其打印出来并检查其 id 或某事来测试它。在页面的解析源代码中......无论如何你都可以看到它包含的内容......

# javascript - 使用 jQuery Mobile 和 RequireJS 进行国际化的插件是什么？

> ID：13895012
> 
> 赞同：3
> 
> 时间：2012-12-15T18:37:54.387
> 
> 标签：javascript, jquery-mobile, internationalization, requirejs

我正在使用`requireJS`并`Jquery Mobile`开始研究国际化应用程序的选项。

目前可用的语言（EN/DE/FR）是从数据库中提供的。当用户选择一种新语言时，我正在当前页面设置上进行更改页面`jqm option` `allowSamePageTransition=true`，它重新获取页面并将其添加到 DOM（它在 DOM 中两次，但现在没关系。

由于应用程序最终应该离线工作，我想通过 JSON/Javascript 从数据库和存储/服务器中删除语言，所以切换语言会触发相同的事件，只是这次翻译将作为 JSON 提供，我正在构建客户端上的东西。

我一直在尝试使用由`i18n`提供的插件来执行此操作`requireJS`，虽然这非常容易设置，但当用户手动切换语言时，我不得不重新加载完整的应用程序以显示新语言，这是不行的去。

**问题**：
我已经阅读了一些关于国际化和建议框架的问题，但不确定该走哪条路，也没有真正找到任何替代方案。

考虑到这些：
- 应该小而快
- 需要与 JQM 一起工作
- 应该使用 JSON/.po 文件 我可以构建服务器端以供下载并保存在缓存/本地存储中
- 复数规则等是可以的，但不是必须的

你推荐使用什么？你的经历是什么？

感谢分享！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T07:39:27.273

你可以看看[http://i18next.com](http://i18next.com)：

*   相当主要
*   附带requirejs支持
*   你可以使用 JSON -> 但有一个 .mo/.po 文件的转换器
*   适当的复数
*   更多功能（上下文、stringf、插值、本地存储缓存……）
*   甚至有一个 UI 来翻译你的东西
*   应该与 jqm 一起运行

我们个人经常将它与backbone.js 和handlebars 模板引擎结合使用。但也适用于不同的设置。

我开始 i18next 的工作是因为我对目前的情况不满意。大多数图书馆很复杂或不足以提供适当的本地化 - 所以我开始了 i18next - 现在相当流行。

# mobile - 使用 ASP.Net MVC4 进行自适应渲染

> ID：13895016
> 
> 赞同：0
> 
> 时间：2012-12-15T18:38:10.093
> 
> 标签：mobile, asp.net-mvc-4, rendering

通过 Google Chrome 浏览器模拟器，我的网站已针对 iPhone5 正确格式化。请注意，这不是通过 Visual Studio 完成的，而是通过使用 Chrome 浏览器访问网站 www.yeagertech.com 来完成的。

右上角登录的凭据是： 用户名：stageadmin 电子邮件地址：wsyeager36@msn.com 密码：1234567

当我尝试直接从 iPhone5 本身访问该站点时，它的格式仍然像桌面浏览器一样。当我直接通过手机本身而不是模拟器查看网站时，Android 手机和 Windows 手机也会发生同样的情况。

有人知道我还需要做什么才能使格式正确吗？

在我的 Global.asax 文件中，我需要以下内容：

```
protected void Application_Start()
        {
            DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("windowsphone")
            {
                ContextCondition = (context => context.GetOverriddenUserAgent().IndexOf
                    ("windowsphone", StringComparison.OrdinalIgnoreCase) >= 0)
            });

            DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("iPhone")
            {
                ContextCondition = (context => context.GetOverriddenUserAgent().IndexOf
                    ("iPhone", StringComparison.OrdinalIgnoreCase) >= 0)
            });

            DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("Android")
            {
                ContextCondition = (context => context.GetOverriddenUserAgent().IndexOf
                    ("Android", StringComparison.OrdinalIgnoreCase) >= 0)
            });

            DisplayModeProvider.Instance.Modes.Insert(0, new DefaultDisplayMode("iPad")
            {
                ContextCondition = (context => context.GetOverriddenUserAgent().IndexOf
                    ("iPad", StringComparison.OrdinalIgnoreCase) >= 0)
            });

            AreaRegistration.RegisterAllAreas();

            RegisterGlobalFilters(GlobalFilters.Filters);
            RegisterRoutes(RouteTable.Routes);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:07:33.053

iPhone 5 将屏幕分辨率提高到 1,136 x 640 像素，与之前的 Retina 设备相同，每英寸 326 像素 (ppi)。iPhone 会自动缩放视口以适应 980 像素，因此它适用于大多数网页而无需任何更改。如果您想专门针对移动网站的 iPhone 的默认屏幕尺寸，您可以在布局的头部添加以下元标记：`<meta name="viewport" content="initial-scale=1.0">` 并查看[Safari 视口参考](http://developer.apple.com/library/safari/#documentation/appleapplications/reference/SafariHTMLRef/Articles/MetaTags.html)

[您可以使用 Opera Mobile Emulator - http://www.opera.com/developer/tools/mobile/](http://www.opera.com/developer/tools/mobile/)复制 Android 上发生的事情。此外，在 Global.asax.cs 中放置一些断点，并确保您从用户代理获得预期的结果。

我还建议在您的每个设备唯一视图中放置一些调试代码，以确保为每个设备呈现预期的视图。

在查看渲染之前，您需要修复您的 JS 错误。您在加载 JQuery 之前加载 jquery 库。先解决这个问题。然后，请注意 iPhone 5 在 4 英寸屏幕上呈现 @ 640px x 1136px。Galaxy S-III 在稍大一点的屏幕上呈现 720 像素宽——这给许多开发人员带来了问题。对于快速入门，我建议回到默认的桌面和移动显示模式，然后看看 Bootstrap - [http://twitter.github.com/bootstrap/index.html](http://twitter.github.com/bootstrap/index.html) - Bootstrap 是响应式设计的一个很好的快速入门。

# php - 记录器类，如何从任何方法访问它

> ID：13895019
> 
> 赞同：0
> 
> 时间：2012-12-15T18:38:33.277
> 
> 标签：php, static-methods

我有一个我制作的记录器类，但我不确定哪个是实现它的最佳方式。

此类中的`write()`方法需要能够从应用程序中每个类中的任何方法调用。

以前我在做 Logger::write() 将方法作为静态方法。它既快速又简单，但我觉得这不是最好的方法。

我是否应该将记录器类的实例注入我的其他对象（通过构造函数或设置器方法），然后当我需要写入日志时调用它：

```
$this->logger->write() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:46:57.480

如果您`public static function write()`不需要访问 logger 类中的任何属性或方法，那么绝对没有理由不将其设为静态。（如可通过 Logger::write() 访问。如果没有适当的理由，强制初始化对象是多余的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T18:47:57.247

这实际上取决于您希望如何使用该类。

如果您不需要实例来使用该方法，则将该方法定义为静态并静态调用它`Logger::write()`，这很好。

但是，如果您需要一个实例，那么您将需要决定如何在整个代码中使用该实例。例如，您可以使用[依赖注入](http://net.tutsplus.com/tutorials/php/dependency-injection-huh/)将实例传递给需要它的代码。这就是我建议你这样做的方式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T18:49:10.350

为什么你希望它在每个对象中都可用？到处注入看起来很繁琐，也不是很实用。如果您需要在静态方法、常规函数或全局范围内记录某些内容怎么办？

或者简单地说：打电话有什么问题`Logger::write()`？也许你是想多了？

# prolog - Prolog DCG 使用 separotr 从文件中读取

> ID：13895020
> 
> 赞同：3
> 
> 时间：2012-12-15T18:38:43.980
> 
> 标签：prolog, readfile, comma, dcg

我正在 Prolog 中迈出第一步，但遇到了问题。

我正在尝试从用逗号分隔的文件记录中读取

```
upto_comma(Codes) --> string(Codes), ",", !.
list_w([W|Ws]) --> upto_comma(W), [W] ,list_w(Ws).
string([]) -->  [].
string([H|T]) -->[H],string(T). 
```

但我得到的只是一个包含单个字符的列表，而我想要的是一个元素列表。例如从

```
cat,dog,table 
```

我想要`[cat,dog,table]`，我得到了`[c,a,t,d,o,g,t,a,b,l,e]`。

我试图`upto_comma`改变

```
upto_comma(Atom) --> string(Codes), ",", !,{ atom_codes(Atom, Codes) }. 
```

但没有任何改变。

我想我误解了一些基本概念，有人可以帮忙吗？我正在使用 SWIProlog

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T21:56:36.940

您的语法错过了 list_w//1 的基本情况，我不明白为什么在 upto_comma(W) 之后您需要阅读相同的内容。

我会这样写

```
list_w([W|Ws]) --> string(W), ",", !, list_w(Ws).
list_w([W]) --> string(W).

string([]) -->  [].
string([H|T]) -->[H],string(T). 
```

测试：

```
?- phrase(list_w(S),"cat,dog").
S = [[99, 97, 116], [100, 111, 103]] ;
false. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T23:10:51.653

有趣的; 我没有从您显示的代码中得到该结果；我只是无法解析输入。

首先，想想你的`string`规则认可什么。它可以识别任何字符串吗？还是只有没有逗号的字符串？

然后想想 list_w 是如何终止的。什么代码处理输入中最终“表”的情况？它不能是 upto_comma，因为这要求“table”后面跟一个逗号。并且 list_w 没有任何不包含 upto_comma 的右手边。

# c++ - 在运行时研究 C++ 软件中的类

> ID：13895025
> 
> 赞同：2
> 
> 时间：2012-12-15T18:39:35.753
> 
> 标签：c++, valgrind, performance-testing, perf

我有一个基于 C++ 的程序正在运行，我的问题是我想知道：

*   调用次数最多的top10、top5、topX方法是什么
*   什么是最重的计算类或哪些线程需要最大时钟周期

在 Linux 下可以使用类似或类似`valgrind`的工具来做到这一点吗？`perf`

我不应该说这个应用程序使用了许多第三方库，但我对那些不感兴趣，因为我想要修改和改进的是应用程序本身的核心，所以我可以将所有可能的方法列表缩减为实现的方法只有通过“实际应用”。

一般来说，如何检测导致分支和性能损失最大的类或方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T18:42:29.017

您正在寻找探查器，例如[`gprof`](http://en.wikipedia.org/wiki/Gprof).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T18:43:56.810

您正在搜索的程序称为分析器。它为您提供调用的方法列表以及它们使用的程序运行时间的百分比。如果你在 Linux 下，你可以使用 valgrind 之类的工具，在 Windows 上我个人使用 Very Sleepy。您还可以在此线程中查看 Linux 下的探查器列表： [线程](https://stackoverflow.com/questions/1168766/what-is-a-good-easy-to-use-profiler-for-c-on-linux)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T19:36:03.923

要计算函数的机器周期或调用深度，您可以使用 QUANTIFY 工具。

# css - CSS分词结合文本溢出

> ID：13895028
> 
> 赞同：6
> 
> 时间：2012-12-15T18:40:16.000
> 
> 标签：css

所以我试图结合`word-break`which`text-overflow`在某些时候确实有效，但不是它应该如何。

例如，我已经设置了这个[**Fiddle**](http://jsfiddle.net/43Ske/)

CSS：

```
width: 200px;
padding: 8px;
border:1px solid blue;
word-break: break-word;
height: 100px;
overflow: hidden;
text-overflow:ellipsis;
white-space:nowrap; 
```

为了澄清起见，一旦文本被分成几部分，它应该填满方框，并且在文本的末尾应该有 3 个点。目前只有一条线可以工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:02:50.720

据我所知，使用 CSS 是不可能的。

您唯一能做的就是指定`height`, 和`overflow:hidden`. （最后没有省略号。）

这在[text-overflow 的 W3 规范中](http://www.w3.org/TR/2002/WD-css3-text-20021024/#text-overflow-ellipsis)有所说明。

> **ellipsis**
> 在发生文本溢出的每个框边界处插入一个省略号字符串。这些省略号字符串的值由“文本溢出省略号”属性确定。插入发生在一行文本的最后一个完整字形表示的边界处
> ……
> 换句话说，文本溢出模式仅影响参与其自身内联流的块元素的文本内容。

您将需要使用 JavaScript 来实现这一点。

这是一个 jQuery 插件的示例：http: [//pvdspek.github.com/jquery.autoellipsis/](http://pvdspek.github.com/jquery.autoellipsis/)

# java - 无法在java中连接到mysql

> ID：13895030
> 
> 赞同：1
> 
> 时间：2012-12-15T18:40:29.027
> 
> 标签：java, mysql

我试图`MySQL`使用`JAVA`相同的代码连接本地主机中的数据库。现在我尝试在我的系统中使用它来更新远程数据库。这是我的代码：

```
import java.sql.*;
class mysqlConnect { 

public static void main (String[] args) { 
    try { 
        String url = "jdbc:mysql://dibyaranjan.net76.net/a3932573_product";
        Connection conn = DriverManager.getConnection(url,"a3932573_dibya","*****"); 
        Statement st = conn.createStatement(); 
        st.executeUpdate("INSERT INTO emp_oracle " + "VALUES (1001, 'Dibya', 'AAA')"); 
        conn.close(); 
    } catch (Exception e) { 
        System.err.println(e.getMessage()); 
    } 

}
} 
```

我收到此错误消息： **null, message from server: "Host '49.204.14.98' is not allowed to connect to this MySQL server"**。

ip是我的公共ip。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:42:06.113

Error is clear. You cant connect to the remote mysql server from your machine. `a3932573_dibya` this user is not having permission to connect from this IP.

When you create a user in mysql, we can also specify which all IP's this user will connect from. If you want to allow all IPs you should give host as `%`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T18:49:37.473

您的主机在`mysql.user`表中配置不正确。

打开并在表格`PHPMyAdmin`中找到您的记录。表，以便主机名而不是或任何其他 IP 反映您的实际 IP（或者如果您希望允许来自每个 IP 的连接。但是请注意，大多数共享主机不允许这种配置。`mysql.user``ALTER``localhost``127.0.0.1``%`

更多参考：[http ://blog.wassupy.com/2011/02/host-is-not-allowed-to-connect-to-this.html](http://blog.wassupy.com/2011/02/host-is-not-allowed-to-connect-to-this.html)

# html - 打印网页时在 CSS 中指定物理尺寸（例如 2 英寸）

> ID：13895041
> 
> 赞同：10
> 
> 时间：2012-12-15T18:41:40.970
> 
> 标签：html, css, printing

是否有一种可靠的方法可以在 CSS 中指定物理尺寸，以便在打印页面时，我的元素在打印页面上处于特定大小和位置？

我看到 CSS 有 in 和 cm 的单位，但（不足为奇）当我执行以下操作时，Firefox 和 Chrome 都没有实际打印 2x2 英寸的框：

```
.test {
    width: 2in;
    height: 2in;
    border: solid 1px #aaa;
} 
```

我是否过于乐观，希望有某种方法可以指定尺寸并让浏览器根据打印机的分辨率等调整其打印尺寸？

谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T19:01:14.283

尝试添加`margin: 0; padding: 0`以避免任何额外的间距。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-15T19:08:46.150

理论上，由 CSS3 值和单位模块第 3 级第[5.2 节。绝对长度](http://www.w3.org/TR/css3-values/#absolute-lengths)，`cm`单位应该与“打印介质和类似高分辨率设备”上的物理厘米相匹配，而在低分辨率设备上，像素应该是锚单位，这通常意味着`cm`与物理单位不同。

在实践中，情况甚至更糟。我刚刚测试了一个设置为`15cm`宽的元素。在屏幕上（包括打印预览）它实际上是 15.8 厘米，当在物理打印机上打印时，它是 14.7 厘米（所以它基本上更接近，但仍然远非精确）。

# statistics - 多元正态分布的抽样复杂度

> ID：13895048
> 
> 赞同：2
> 
> 时间：2012-12-15T18:42:06.483
> 
> 标签：statistics, complexity-theory, sampling

从多元正态分布抽样的计算复杂度是多少？

是否需要先反转协方差矩阵，产生 O(n^3) 算法或存在复杂度 O(n^2) 的算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:59:31.587

如果*C*是您的协方差矩阵，并且*C=LL ^T*是其 Cholesky 分解，则*Lx*将具有所需的协方差结构。这里，*x*是标准正态变量的*n向量。*

Cholesky 分解需要 O(n^3) 时间来计算。但是，如果您预先执行此操作，然后仅使用*L*，您将在您计算的所有随机样本中摊销成本。

# ruby - 在 rails 之外使用 rails 方法

> ID：13895050
> 
> 赞同：4
> 
> 时间：2012-12-15T18:42:35.100
> 
> 标签：ruby

我非常怀疑这是可能的，但我想我会发布并要求确认。

我编写了一个非常小的 ruby​​ 脚本来批量重命名一个文件夹，但我需要在文件名上使用 Rail 的参数化方法。我不在 Rails 项目中，因为我是在我希望重命名的文件目录中运行它。我也不希望让它成为一个成熟的 Rails 应用程序。

有人对我如何实现这一目标有任何想法吗？

尼尔

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T18:44:52.517

此方法在 ActiveSupport（Rails 的一部分）中定义。您可以在 Rails 之外使用 ActiveSupport。只需要库

```
require 'active_support/core_ext'

# now parameterize method should be available 
```

# mvvm - 带有 ZK 框架的 MVVM

> ID：13895053
> 
> 赞同：1
> 
> 时间：2012-12-15T18:43:13.387
> 
> 标签：mvvm, frameworks, zk, web-application-project

正在使用带有 zk 框架的 MVVM 来开发电信应用程序，这是一个好的框架吗？谁能和我分享他的经验？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T05:18:31.763

是的，ZK 对 RAD 有好处，因为它的 veiw 层非常简单，而且事情可以很快完成。我们使用 ZK 开发了电子商务应用程序，它很好。

# excel - How to get the address of any cell from range in excel

> ID：13895056
> 
> 赞同：-1
> 
> 时间：2012-12-15T18:43:50.220
> 
> 标签：excel, vba

I wrote a macro and calling from excel automatically. The macro is working only for Cell `A1`, I have played with range and tried different things to get the address of `A2` or `A3` so on but no success. We have range like `A1:A30` and as user will give data I want macro to execute automatically and give result.

Here is the link where I can call macro one time or for 'A1' but how do I to use this macro for `A1:A30`? [How to call VBA function from excel](https://stackoverflow.com/questions/13886383/how-to-call-vba-function-from-excel/13894502#13894502)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T18:51:49.713

代替： `If Target.Address = "$A$1" Then 'assumes user input cell is A1`

有了这个： `If Not Intersect(Target.Parent.Range("A1:A30"), Target) Is Nothing Then`

并确保检查 Scott Holtzman 对您的其他问题的回答是否正确。

# javascript - 如何在Javascript中粘贴事件后发出警报？

> ID：13895059
> 
> 赞同：22
> 
> 时间：2012-12-15T18:43:57.230
> 
> 标签：javascript, dom-events

我有一个简单的过去事件

```
document.getElementById('paste_area').addEventListener('paste', function() {
    document.getElementById('notice').innerHTML='Text was successfully pasted!';
    alert('Pasted');
}, true); 
```

可以在这里找到一个工作示例[http://jsfiddle.net/XEQzz/](http://jsfiddle.net/XEQzz/)

警告和通知将在粘贴前出现。**如何在粘贴事件实际完成后延迟警报操作？**

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-12-15T18:48:18.643

您可以将警报放在`setTimeout`.

```
setTimeout(function() {alert('Pasted');}, 0); 
```

这将延迟代码直到值更新之后。

请记住，`this`回调`setTimeout`中的值与封闭环境中的值不同。

如果您需要对 external 的引用`this`，这将是元素，然后在变量中引用它......

```
var self = this;
setTimeout(function() {alert(self.value);}, 0); 
```

或使用`.bind()` *（在大多数支持的浏览器中支持`addEventListener`。旧版 Safari 不支持。）* ...

```
setTimeout(function() {alert(this.value);}.bind(this), 0); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T23:38:33.470

setTimeout 似乎是最好的选择，你可以使用这样的东西来概括

// 对象定义

```
 function PasteMonitor(element)
    {
        if(typeof element == "string")
        {
            this.target = document.getElementById(element);
        }
        else if(typeof element == "object" || typeof element == "function")
        {
            this.target = element;
        }

        if(this.target != null && this.target != undefined)
        {
            this.target.addEventListener('paste',this.inPaste.bind(this),false);
            this.target.addEventListener('change',this.changed.bind(this),false);
        }
        this.oldstate = "";
    }
    PasteMonitor.prototype = Object.create({},{
        pasted:{ value: false, enumerable: true, configurable: true, writable: true },
        changed:{ value: function(evt){
            //elements content is changed
            if(typeof this.onChange == "function")
            {
                this.onChange(evt);
            }
            if(this.pasted)
            {
                if(typeof this.afterPaste == "function")
                {
                    this.afterPaste(evt);
                    this.pasted = false;
                }
            }
        }, enumerable: true, configurable: true, writable: true },
        inPaste:{ value: function(evt){
            var cancelPaste = false;
            if(typeof this.beforePaste == "function")
            {
                // process pasted data
                cancelPaste = this.beforePaste(evt);
            }
            if(cancelPaste == true)
            {
                evt.preventDefault();
                return false;
            }
            this.pasted = true;
            setTimeout(function(){
                var evt = document.createEvent("HTMLEvents");
                evt.initEvent("change", false, true);
                this.target.dispatchEvent(evt);
            }.bind(this),0);
        }, enumerable: true, configurable: true, writable: true }
    })
    PasteMonitor.prototype.constructor = PasteMonitor; 
```

//PasteMonitor 用法

```
 //var element = document.getElementById('paste_area');
    var msgArea = document.getElementById('message');
    var myMonitor = new PasteMonitor("paste_area");
    //or use and object as argument => var myMonitor = new PasteMonitor(element);

    myMonitor.onChange = function(evt){
        if(this.pasted)
        {
            //do something on paste change
            msgArea.innerHTML = "onChange by paste";
            this.oldstate = this.target.value;
        }
        //check to prevent processing change event when the element loses focus if the change is done by paste
        else if(this.target.value != this.oldstate)
        {
            msgArea.innerHTML = "onChange by typing";
        }
    };
    myMonitor.afterPaste = function(evt){
       // do something after paste
        msgArea.innerHTML = "afterPaste";
    };
    myMonitor.beforePaste = function(evt){
        // do something before the actual paste
        msgArea.innerHTML = "beforePaste";
        //return true to prevent paste
        return false;
    }; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-10-04T09:37:11.330

用于更新自身价值

```
 $(".number").on("paste", function (e) {
        var Value = e.originalEvent.clipboardData.getData('text');
        var Self=this
        setTimeout(function () {
            if (Value != Value.replace(/[^\d\.]/g, "")) {
                $(Self).val(Value.replace(/[^\d\.]/g, ""));
            }
        }, 0);
    }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-08-01T12:12:21.530

我通常这样做是为了模仿 onafterpaste。

我有一个名为“onafterpaste”的特殊功能，我像这样使用它：

onpaste="onafterpaste(myFunction, this)"

如您所见，它还接受一个额外的参数，该参数将在调用 myFunction 时使用。

请参阅（并在其中尝试）以下实时代码段：

```
function onafterpaste(f,elm) {
  setTimeout(function() {f(elm)},0);
}

function  myFunction(elm) {
  alert('After the paste, the input has the following text:\r\n\r\n'+elm.value);
}
```

```
<p>Paste something down here:</p>
<input type="text" onpaste="onafterpaste(myFunction,this)" value="The original text">
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2022-01-28T19:18:19.450

是`paste_area`输入吗？ `input`也是[一个事件](https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/input_event)。

```
document.getElementById('paste_area').addEventListener('input', 
    function(event) {
        alert('Pasted');
}); 
```

# android - android图库的类图

> ID：13895062
> 
> 赞同：-1
> 
> 时间：2012-12-15T18:44:04.330
> 
> 标签：android, architecture, gallery, class-diagram

我正在做一个安卓项目。我的参考源代码是 android Gallery 应用程序。我想创建一个这样的用户界面。但我发现很难理解和分析图库应用程序代码。是否有可用的画廊应用程序的“类图”或“架构”？

谁能给我一个解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:50:02.010

我不知道有一个，但您可以使用[http://www.objectaid.com/之类的东西从](http://www.objectaid.com/)[代码](http://grepcode.com/file/repository.grepcode.com/java/ext/com.google.android/android-apps/4.1.1_r1/com/android/camera/gallery/)中生成一个。

# objective-c - AppDelegate.m 类中的@interface 错误

> ID：13895064
> 
> 赞同：3
> 
> 时间：2012-12-15T18:44:13.580
> 
> 标签：objective-c, ios, cocoa-touch, appdelegate

应该是我缺少的简单解决方案。我有一个选项卡视图控制器驱动的应用程序，我想在用户启动或打开应用程序时对其进行密码保护。我在 IB 中创建了一个密码类和视图控制器。

我正在尝试将 AppDelegate.m 类 applicationDidLoadInForeground 方法与以下代码一起使用：

```
- (void)applicationWillEnterForeground:(UIApplication *)application
{
    NSUserDefaults *submissionDefaults = [NSUserDefaults standardUserDefaults];
    if ([submissionDefaults boolForKey:@"passcodeActive"] == true)
    {   
        PINAuthViewController *pinController = [[PINAuthViewController alloc] init];
        [self presentViewController:pinController animated:YES completion:nil];
    }
} 
```

我已经在标题中导入了我的 PINAuthViewController 类

```
#import "PINAuthViewController.h" 
```

但我在编译“没有可见的@interface for 'AppDelegate' 声明选择器'presentViewController:animated:completion'时收到错误。

谁能告诉我我做错了什么？如果密码输入正确，目的是关闭密码视图控制器。

非常感谢，詹姆斯

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-15T19:05:28.910

应用程序委托不能呈现视图控制器，因为它不是 UIViewController 本身的子类。

您需要将代码更改为：

```
[self.window.rootViewController presentViewController:pinController animated:YES completion:nil]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-10-20T06:50:38.587

你也可以试试这个代码......

```
self.viewController = [[FirstViewController  alloc] initWithNibName:@"FirstViewController" bundle:nil];
self.window.rootViewController = self.viewController;
[self.window makeKeyAndVisible]; 
```

# c++ - Func returning array

> ID：13895065
> 
> 赞同：2
> 
> 时间：2012-12-15T18:44:14.727
> 
> 标签：c++

Please, help me with such common task as to write function that must return array. I spent 2 hours with solving this problem, but no results. Here is my code:

```
 VERTEX* ConstructVertices(float R, unsigned int Slices)
{
    //const unsigned int n = static_cast<const unsigned int>(Slices);
    VERTEX *__vertices = new VERTEX[100];

    float dx = (2 * R) / Slices;
    float dz = dx;
    float x, y, z;
    x = -R;
    y = 0.5f;
    z = 0;
    int x_sign = 1;
    int z_sign = -1;

    __vertices[0].Color = D3DXCOLOR(0.0f, 1.0f, 0.0f, 1.0f);
    __vertices[0].Pos = D3DXVECTOR3(x, y, z);

    for (int i=1; i<Slices * 4 + 1; i++)
    {
        __vertices[i].Color = D3DXCOLOR(0.0f, 1.0f, 0.0f, 1.0f);

        y = -y;

        if (y < 0)
        {
            __vertices[i].Pos = D3DXVECTOR3(x, y, z);
            continue;
        }

        x += x_sign * dx;
        z += z_sign * dz;

        x = round_up(x, 2);
        z = round_up(z, 2);

        if (abs(x) == abs(R))
        {
            x_sign = -x_sign;
        }
        if (abs(z) == abs(R))
        {
            z_sign = -z_sign;
        }

        __vertices[i].Pos = D3DXVECTOR3(x, y, z);   
    }

    return __vertices;
} 
```

Code for accessing the array:

```
VERTEX *vertices = new VERTEX[100];
vertices = ConstructVertices(1, 10); 
```

With Watches window i can see values like vertices[0], vertices[1],.. But i can't see it as an array & the main is sizeof(vertices) returns 4 instead of 160!!

Thank a lot!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:50:28.220

只需返回一个`std::vector<VERTEX>`.

返回指向在堆上分配的内存的指针有几个主要问题：

1.  如果处理不当，内存很容易泄漏。
2.  从界面上不清楚如何释放内存，编译器无法帮助使用正确的方法（尽管使用`delete[] a;`可能会猜测正确的方法是什么）。
3.  您无法从指针确定返回数组的大小。

显然，您可以创建一个提供合适操作的类，但这就是事实`std::vector<T>`。如果您需要指向元素的指针，只需使用非空向量 ( `&a[0]`) 或`a.data()`. 后者是在 C++ 2011 中引入的，并且具有处理空数组的优势（当然，返回的指针不能被取消引用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T18:51:29.437

在您的代码中，您首先动态分配内存：

```
VERTEX *vertices = new VERTEX[100];
vertices = ConstructVertices(1, 10); 
```

然后在函数中使用 new 分配内存：

```
//const unsigned int n = static_cast<const unsigned int>(Slices);
VERTEX *__vertices = new VERTEX[100]; 
```

最后你返回这个指针并替换你创建的第一个指针。内存被分配了两次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T18:51:07.737

“主要是 sizeof(vertices) 返回 4 而不是 160！！” 那是因为 vertices 是一个指针，而且显然你使用的是一台高科技的 32 位计算机，所以指针的大小是 4 个字节。
还有一点是：

```
VERTEX *vertices = new VERTEX[100];
vertices = ConstructVertices(1, 10); 
```

第一个分配是无用的，因为被第二个覆盖而没有使用过，所以你只是用 100 VERTEX 泄漏内存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-15T19:54:41.520

而不是这个

```
VERTEX *vertices = new VERTEX[100];
vertices = ConstructVertices(1, 10); 
```

将顶点数组作为参数添加到函数并告诉函数大小

```
VERTEX *vertices = new VERTEX[100];
ConstructVertices(1, 10,vertices,100); 
```

然后在你的函数里面填充传递的数组

```
void ConstructVertices(float R, 
                       unsigned int Slices,
                       VERTEX* vertices, 
                       size_t verticesArraySz )
{
    //const unsigned int n = static_cast<const unsigned int>(Slices);

    float dx = (2 * R) / Slices;
    float dz = dx;

... 
```

不要使用类似的名称`__vertices`，这不是一个好习惯，因为通常编译器特定的东西使用该语法。

# c++ - How to check that the OS is at least Windows XP SP3?

> ID：13895067
> 
> 赞同：0
> 
> 时间：2012-12-15T18:44:30.240
> 
> 标签：c++, windows, winapi, version, windows-xp-sp3

> **Possible Duplicate:**
> [How do I determine if a computer is running XP Service pack 3](https://stackoverflow.com/questions/862940/how-do-i-determine-if-a-computer-is-running-xp-service-pack-3)

There's a ton of C++ code illustrating how to check that OS is Windows XP, but I need to know if it's at least Windows XP SP3\. Is there any way to do that?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T18:51:21.387

这个页面应该有帮助：

[获取系统版本 (Windows)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724429%28v=vs.85%29.aspx)

# c - Store an int in a char* [C]

> ID：13895073
> 
> 赞同：0
> 
> 时间：2012-12-15T18:45:34.453
> 
> 标签：c, printf

```
int main()
{
   int n = 56;
   char buf[10]; //want char* buf instead
   sprintf(buf, "%i", n);
   printf("%s\n", buf);

   return 0;
} 
```

This piece of code works, my question is what if i want the same behaviour, with buf being a char* ?

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T18:50:15.273

写作时的主要区别

```
char* buf; 
```

是它未初始化并且没有分配内存，所以你必须照顾好自己：

```
char* buf = malloc(10 * sizeof(char));
// ... more code here
free(buf); // don't forget this or you'll get a memory leak 
```

这称为[动态内存分配](http://en.wikipedia.org/wiki/C_dynamic_memory_allocation)（与静态分配相反），它允许您在运行时使用或在调用中使用变量[更改分配的内存量。](http://www.cplusplus.com/reference/cstdlib/realloc/)另请注意，如果内存量太大，内存分配可能会失败，在这种情况下，返回的指针将为.`realloc``malloc``NULL`

从技术上讲，`sizeof(char)`不需要上述内容，因为 1`char`的大小始终为 1 字节，但大多数其他数据类型更大并且乘法很重要 -`malloc(100)`分配 100 字节，`malloc(100 * sizeof(int))`分配 100 秒所需的内存量`int`，通常是 32 上的 400 字节位系统，但可能会有所不同。

```
int amount = calculate_my_memory_needs_function();
int* buf = malloc(amount * sizeof(int));
if (buf == NULL) {
  // oops!
}
// ...
if (more_memory_needed_suddenly) {
   amount *= 2; // we just double it
   buf = realloc(buf, amount * sizeof(int));
   if (!buf) { // Another way to check for NULL
     // oops again!
   }
}
// ...
free(buf); 
```

另一个有用的函数是`calloc`接受两个参数（第一个：要分配的元素数，第二个：元素的大小（以字节为单位））并将内存初始化为 0。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T18:47:19.083

I think calloc (or malloc if you don't have calloc) is what you're after.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T18:47:31.893

`buf` is an array statically allocated on the stack. For it to be of type `char *` you need to allocate dynamically the memory. I guess what you want is something like this:

```
int main()
{
   int n = 56;
   char * buf = NULL;
   buf = malloc(10 * sizeof(char));
   sprintf(buf, "%i", n);
   printf("%s\n", buf);

   // don't forget to free the allocated memory
   free(buf);

   return 0;
} 
```

EDIT: As pointed out by 'Thomas Padron-McCarthy' in the comments, you should not cast the return of `malloc()`. You will find more info [here](https://stackoverflow.com/questions/605845/do-i-cast-the-result-of-malloc). You could also remove completely the `sizeof(char)` as it will always by `1`.

# c# - Download and Excel file from an aspx webpage

> ID：13895078
> 
> 赞同：0
> 
> 时间：2012-12-15T18:46:06.557
> 
> 标签：c#, download, web-scraping, webclient, xls

I am stuck trying to download an excel xls file from a website. The file is downloaded when a link is clicked and I need to either control where the file is saved using c# or be able to download the file in c# all together.

Here is the site - you will see the link on the top right.

```
http://reo.wellsfargo.com/WBREOHome.aspx?&srchState=AK&srchCity=&srchCounty=&srchZip=&srchPriceLower=0&srchPriceUpper=9999999&srchPropertyType=&srchBeds=0&srchBaths=0&srchStatus= 
```

Here is a link to a description of what looks like the method to do this kind of download, but I cannot make this work and am in great need of help. Please let me know if anyone knows how to use a webclient or basic httpwebrequest to download an xls file.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-23T08:30:33.217

您可以在任何 ASP.NET LinkBut​​ton 的 onclick 上调用此方法。可以设置要下载的excel文件的路径。进行适合您的更改。

```
protected void download(object sender, EventArgs e)
        {
            string fname = "Excel_Sheet_Format.xlsx";
            string path = "C:/Users/dell/Desktop/Excel_Sheet_Format.xlsx";
            string name = Path.GetFileName(path);
            string ext = Path.GetExtension(path);
            Response.AppendHeader("content-disposition","attachment; filename=" + name);
            Response.ContentType = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";
            Response.WriteFile(path);
            Response.End();    
        } 
```

# jquery - jQuery form validation showing Uncaught TypeError: Object [object Object] has no method 'validate'

> ID：13895090
> 
> 赞同：0
> 
> 时间：2012-12-15T18:47:55.150
> 
> 标签：jquery, jquery-plugins, jquery-selectors

I am using wordpress. In wordpress I want to live validate a form. So after searching different jQuery form validation I got [http://www.geektantra.com/projects/jquery-form-validate/](http://www.geektantra.com/projects/jquery-form-validate/) link. I used all the source codes in my site. But after all that when I rendered the page I got this errors in my chrome console tab

```
Uncaught TypeError: Object [object Object] has no method 'validate' localhost:70
(anonymous function) localhost:70
o jquery.js:2
p.fireWith jquery.js:2
e.extend.ready jquery.js:2
c.addEventListener.B 
```

all of my jquery files are included in header file like this

```
<?php
  wp_enqueue_script('jQuery', get_bloginfo('template_url').'/js/jquery-1.3.2.min.js');
  wp_enqueue_script('Validations', get_bloginfo('template_url').'/js/jquery.validate.js');
  wp_enqueue_script('Validations Function', get_bloginfo('template_url').'/js/jquery.validation.functions.js');
?> 
```

and the jQuery code inside head is like this

```
<script type="text/javascript">
 jQuery(document).ready(function() {
    jQuery("#ValidTitle").validate({
        expression: "if (VAL != '0') return true; else return false;",
        message: "Please make a right selection for the title"
    });
    jQuery("#Name").validate({
        expression: "if (VAL) return true; else return false;",
        message: "Please enter your name"
    });
    jQuery("#BusinessPhone").validate({
        expression: "if (VAL.match(/^[9][0-9]{9}$/)) return true; else return false;",
        message: "Should be a valid Phone Number"
    });
    jQuery("#ValidEmail").validate({
        expression: "if (VAL.match(/^[^\\W][a-zA-Z0-9\\_\\-\\.]+([a-zA-Z0-9\\_\\-\\.]+)*\\@[a-zA-Z0-9_]+(\\.[a-zA-Z0-9_]+)*\\.[a-zA-Z]{2,4}$/)) return true; else return false;",
        message: "Please enter a valid Email ID"
    });
    jQuery("#NumberOfEmployee").validate({
        expression: "if (!isNaN(VAL) && VAL) return true; else return false;",
        message: "Please enter a valid number of employees"
    });
    jQuery("#ValueSoftware").validate({
        expression: "if (VAL != '0') return true; else return false;",
        message: "Please make a right selection for Value Software"
    });                
    jQuery("#TaxYear").validate({
        expression: "if (VAL != '0') return true; else return false;",
        message: "Please make a selection"
    });
});

</script> 
```

Can someone kindly help me how to solve this. It will be really appreciable.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-29T10:50:34.377

通过查看您的错误代码，我认为可能存在一些问题，例如

*   jQuery 未在您的站点中正确加载

*   jQuery 框架在您的 jQuery 插件之后加载

因此，要检查它们，只需通过页面源代码，即`ctrl+u`在您的键盘中检查每个文件是否与其外部文件正确链接。应该检查一个主要的事情是检查 jQuery 是第一次加载，然后是在你的 jQuery 插件加载之后。

希望这些步骤将帮助您检查错误。

# android - 在eclipse中构建phonegap项目

> ID：13895092
> 
> 赞同：0
> 
> 时间：2012-12-15T18:48:09.477
> 
> 标签：android, gwt, cordova

我在 Eclipse 中建立了一个电话间隙项目，它在我的设备上运行良好。我还构建了一个 gwt 应用程序，我可以将它生成的 js 放到我的 phonegap 应用程序中，它运行良好。我现在想要的是使用 get 创建我的 ui/app 并将生成的 javascript 直接部署到我的设备。这可能在 Eclipse 中还是仅通过 ant 脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T18:58:58.620

如果您询问是否可以在不在 Eclipse 中重新编译的情况下更新 PhoneGap 应用程序中的 Web 内容，答案是否定的。您应用程序中的 Web 内容存储在 中，`.apk`并在加载到您的设备之前进行签名。`.apk`无法在设备上重新签名。

另一种方法是将应用程序的 Web 内容托管在远程服务器上，并从该服务器位置加载 PhoneGap 网络视图。只需将远程位置设置为`super.loadUrl()`通话中的第一个参数即可。

请记住在您的应用设置中将您的域列入白名单。可以在[此处](http://docs.phonegap.com/en/1.9.0/guide_whitelist_index.md.html)找到有关白名单的文档。

# c# - C# - 如何删除字符串的特定部分？

> ID：13895095
> 
> 赞同：-6
> 
> 时间：2012-12-15T18:48:18.370
> 
> 标签：c#, string

作为[这个](https://stackoverflow.com/questions/13891062/c-sharp-trimming-string-when-specific-char-found-on-string-is-it-possible/13891121#comment19137656_13891121)问题的延续

假设我有一个字符串：

```
String myString = "violet are blue|roses are red|this is a terrible poet"; 
```

我想修剪它说“玫瑰是红色的|”的特定部分 使它成为：

```
myString = "violet are blue|this is a terrible poet"; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T18:53:51.630

你可以使用[`String.Replace`](http://msdn.microsoft.com/en-us/library/fk49wtc1.aspx)方法

```
string input = "violet are blue|roses are red|this is a terrible poet";
string expected = "violet are blue|this is a terrible poet";
string actual = input.Replace("roses are red|", String.Empty);        

Debug.Assert(expected == actual); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T18:55:15.070

我假设`|`您要使用这些字符来查找要删除的内容。

`|`使用获取第一个索引`IndexOf`，然后是第二个，然后使用 获取字符串的其余部分`Remove`：

```
int index1 = myString.IndexOf('|');
int index2 = myString.IndexOf('|', index1 + 1);
myString = myString.Remove(index1, index2 - index1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T18:56:06.603

使用拆分：

```
const string myString = "violet are blue|roses are red|this is a terrible poet";
const char itemToSplitOn = '|';

var arr = myString.Split(itemToSplitOn);
var newString = arr[0] + itemToSplitOn + arr[2]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-15T19:45:24.140

如果没有正则表达式的答案，这个问题就不会是一个完整的问题:)

```
String myString = "violet are blue|roses are red|this is a terrible poet";
var newstr = Regex.Replace(myString, @"\|.+?\|", "|"); 
```

# php - 更新记录 codeigniter

> ID：13895098
> 
> 赞同：10
> 
> 时间：2012-12-15T18:48:36.180
> 
> 标签：php, database, codeigniter, sql-update

我正在尝试更新输入行的 id 并通过下拉列表选择标题的表，但我有两个问题。首先我不确定如何将数据传递给模型，第二个问题实际上是使用活动记录更新表。

控制器类

```
class Update extends CI_Controller {

public function __construct()
{
        parent::__construct();
        //$this->load->model('addmodel');
        //$this->load->helper('form');
}

public function index()
{
    $this->load->view('updview');

}

public function updtitle() 
{   

    $data = array(
    'id' => $this->input->post('id'),
    'title' => $this->input->post('title') );
    //$data1['data'] = $data;

    $data1['data'] = $this->updmodel->upddata($data);
    $this->load->view('updview', $data1);
}
}

?> 
```

模型类

```
class Updmodel extends CI_Model {
// model constructor function
function __construct() {
    parent::__construct(); // call parent constructor
    $this->load->database();
}

public function upddata($data) {

    $this->db->where('emp_no', $data['id']);
    $this->db->update('title', $data['title']);

    return;
}
}

?> 
```

看法

# 更新员工头衔

```
<form action="http://localhost/ecwm604/index.php/update/updtitle" method="POST">
    employee id: 
        <input type=text name="id"><br />
    change title to: 
        <select name="title">
            <option value="Assistant Engineer">Assistant Engineer</option>
            <option value="Engineer">Engineer</option>
            <option value="Senior Engineer">Senior Engineer</option>
            <option value="Senior Staff">Senior Staff</option>
            <option value="Staff">Staff</option> 
        </select><br />
    <input type="submit" value="submit"/>
    <br />
<?php
    print_r($data);
    //echo $data['title'];
?>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-12-15T19:36:46.397

## 在你的控制器中

```
public function updtitle() 
{   
    $data = array(
        'table_name' => 'your_table_name_to_update', // pass the real table name
        'id' => $this->input->post('id'),
        'title' => $this->input->post('title')
    );

    $this->load->model('Updmodel'); // load the model first
    if($this->Updmodel->upddata($data)) // call the method from the model
    {
        // update successful
    }
    else
    {
        // update not successful
    }

} 
```

## 在您的模型中

```
public function upddata($data) {
    extract($data);
    $this->db->where('emp_no', $id);
    $this->db->update($table_name, array('title' => $title));
    return true;
} 
```

活动记录查询类似于

```
"update $table_name set title='$title' where emp_no=$id" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-15T12:45:46.783

在 your_controller 写这个...

```
public function update_title() 
{   
    $data = array
      (
        'table_id' => $this->input->post('table_id'),
        'table_title' => $this->input->post('table_title')
      );

    $this->load->model('your_model'); // First load the model
    if($this->your_model->update_title($data)) // call the method from the controller
    {
        // update successful...
    }
    else
    {
        // update not successful...
    }

} 
```

在你的模型中...

```
public function update_title($data)
{
   $this->db->set('table_title',$data['title'])
         ->where('table_id',$data['table_id'])
        ->update('your_table');
} 
```

这将工作正常...

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-16T04:43:19.387

如何在codeignitor中更新？

每当您想用多行更新相同的状态时，您可以使用 where_in insteam of where 或者如果您只想更改单个记录可以使用 where。

下面是我的代码

```
$conditionArray = array(1, 3, 4, 6);
$this->db->where_in("ip_id", $conditionArray);
$this->db->update($this->table, array("status" => 'active')); 
```

它的工作完美。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-11T03:51:16.137

在 codeigniter 文档中，如果您更新特定字段，只需执行此操作

```
$data = array(
    'yourfieldname' => value,
    'name' => $name,
    'date' => $date
);

$this->db->where('yourfieldname', yourfieldvalue);
$this->db->update('yourtablename', $data); 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2021-12-10T12:12:41.510

```
function getBankMaster()
{

    $this->db->select('kr.id as kr,bk.id as bk_id ');    
    $this->db->from("ut_axis_klot as kr");       
    $this->db->join("ut_axis_bankmaster as bk","right(rtrim(kr.funding_ac),7) = right(rtrim(bk.funding_ac),7)","left");       
    $this->db->having('bk_id is null');     

    $query = $this->db->get();  

    // echo $this->db->last_query();die;

    if($query->num_rows() > 0)
    {
        $data = $query->result();

        foreach($data as $val)
        {
            $id = $val->kr;

            $this->db->where('id', $id);
            $this->db->update($this->db_sdip, array('amc_remark' => 'Wrong Account Number'));                
        }

    }
    else
    {
        return NULL;
    }
} 
```

# php - 如何使用 Twilio PHP 库在收集语句中嵌套动词？

> ID：13895101
> 
> 赞同：3
> 
> 时间：2012-12-15T18:48:56.763
> 
> 标签：php, twilio

我有一个使用 Twilio 构建的简单呼叫应用程序。我没有使用静态 twiml，而是使用 Twilio 的 PHP 库提供的 Services_Twilio_Twiml 类构建动态 Twiml。

我让它在简单的事情上工作得很好，但是，我一生都无法弄清楚如何在 php 库的 collect 语句中嵌套 say/play 动词。

这是我所拥有的：

```
$this->gather(array ("action" => "http://pbx.somedomain.com/twilio/inbound/step/mainmenu_ivr")); (when keypad entry occurs it hits the action url) 
```

我需要复制的是这种 twiml 行为以某种方式使用传入的数组：

```
<gather action="http://pbx.somedomain.com/twilio/inbound/step/mainmenu_ivr">
    <say>Please enter your extension.</say>
</gather> 
```

我将如何构造我传递给gather函数的数组以将say嵌套在gather语句中？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:16:55.890

尝试这个：

```
require('/path/to/twilio-php/Services/Twilio.php');
$response = new Services_Twilio_Twiml();
$gather = $response->gather(array('action' => 'http://pbx.example.com'));
$gather->say('Please enter your extension');
print $response; 
```

此页面上列出了更多示例，[使用 PHP 创建 TwiML](https://twilio-php.readthedocs.org/en/latest/usage/twiml.html#usage-twiml)。

# android - 删除列表视图上的行及其值

> ID：13895102
> 
> 赞同：0
> 
> 时间：2012-12-15T18:49:00.703
> 
> 标签：android, listview, touch-event

我有一个用数字填充的列表视图，以及一个汇总列表视图中数字数量的编辑文本，我编写了 ontouch 的实现，以删除列表视图中的行，我的问题是：有没有办法删除我在编辑文本的列表视图中删除的值。例如，如果我删除了 10 行中的第 7 行，其值为 5，并且数量为 35 显示在编辑文本上，那么现在编辑文本必须有 30。

谢谢你，我会很感激的

这里有一些代码：

```
 private void showListViewData() {

    String z = "";
    String zQN = "Nu";
    String zPL = "Pl";  
    String zTR = "Tr";

    int x = Integer.parseInt(inJugada.getText().toString());
    int y = Integer.parseInt(inValor.getText().toString());

    String s = Integer.toString(x); 

    inJugada.setText(s);

    inValor.setText(String.valueOf(y));

   if(s.length() == 2){
       z = zQN;

   }else if(s.length() == 4){

       z = zPL;

   }else if(s.length() == 6){
       z = zTR;
   }

    for(int i=0; i<mData.size(); i++)
        mData.get(i);

    mData.add(new Data(z, x, y));
    Collections.sort(mData);
    Collections.synchronizedCollection(mData);

    // add new data to list and refresh
    mAdapter.notifyDataSetChanged(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T18:57:01.783

如果您需要在 ontouch 或单击时删除项目，您将需要适配器和 onClick。我有一个数组列表，我在其中设置了不同的变量“ArrayList items”。每次我得到变量时，我把它放在这个“项目”中，然后我在列表视图中显示白色适配器，然后点击我可以制作我想要的任何东西。

```
MyAdapter adapter = new MyAdapter(getActivity(), R.layout.row, items);
    ListView myList = (ListView) view.findViewById(R.id.list);
    myList.setAdapter(adapter);
    myList.setOnItemClickListener(new OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2, long arg3) {
            File f = new File(path.get(arg2));

            //your delete code here for clicked item
    }}); 
```

然后你可以调用一个方法来计算你的变量，方法很简单。

# ios - 如何检查我的 iPhone 应用程序在 iTunes 备份中占用了多少空间？

> ID：13895106
> 
> 赞同：0
> 
> 时间：2012-12-15T18:49:30.463
> 
> 标签：ios, ios5

如何检查我的 iPhone 应用程序在 iTunes 备份中占用了多少空间？

-

如果您好奇我为什么要问，请继续阅读...

我写了一个应用程序，但它被拒绝了，因为我没有使用 NSURLIsExcludedFromBackupKey 属性从 iTunes 备份中排除一些大文件。

现在我修复了它，也许它可以工作:) 我如何检查它是否有效？如果有效，则该应用程序的备份少于 20MB。如果它不起作用，我的该应用程序的本地 iTunes 备份是 >300MB。如何检查我的应用在 iTunes 备份中占用了多少空间？如果我查看，`~/Library/Application Support/MobileSync/Backup/`我只会看到两个名称随机的文件夹。每个文件夹包含一堆随机名称的文件。（随机，我的意思是真的随机，就像`4287436df27ac72...`）顺便说一句，我在 Mac OS X 10.6.8 上使用 iTunes 11.0 (163)，在 iOS 5.0.1 上使用 iPhone 4S（我知道不支持 NSURLIsExcludedFromBackupKey，但另一个作用相同的机制。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:59:19.970

打开`Settings>iCloud>Storage & Backup>Manage Storage>Your device`，您的应用程序应该会列出。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:08:43.240

**在 Mac 上的 iTunes 中：**到目前为止，我还没有找到一种方法可以准确地告诉您备份中应用程序的大小。但是有可能获得以千字节为单位的备份的总大小`du -k ~/Library/Application\ Support/MobileSync |tail -n1`（后面有一个空格`\`）。所以你可以卸载应用程序，与iTunes同步，检查备份大小，安装应用程序，下载，杀死应用程序，再次同步，再次检查备份大小。然后你可以比较大小。如果有人找到更简单的方法，我可能会接受这个答案......

**使用 iCloud：**在设备上，打开设置应用程序并转到`iCloud > Storage & Backup > Manage Storage`（正如 hwaxxer 已经指出的那样）。但在某些情况下，这个数字并没有什么用处，因为 iPhone 并非每秒同步一次，而且同步需要时间。因此，如果应用程序仅在其文件夹中存储 20MB，`Documents`我们不能指望该数字仅在 2 秒后在设置中可用。如果我们有 WLAN，也许我们可以在一个小时后检查，也许 10 分钟后。如果 2 分钟后我们看到备份需要 20MB，我们知道它已经同步，但是如果我们在两分钟后看到设置中的 33kb，我们不知道数据是否不会进入备份，或者同步是否只是'还没有完成。（如果我错了，请纠正我，我会接受比这个更有帮助的答案。）

# java - SWT 可调整大小的布局

> ID：13895108
> 
> 赞同：2
> 
> 时间：2012-12-15T18:49:51.013
> 
> 标签：java, layout, swt, desktop

SWT 上有任何可调整大小的布局吗？

如果我想构建一个包含两个组件的窗口。第一个组件将具有最小尺寸，但用户应该能够通过选择“边框”来更改宽度。

有任何 SWT 布局吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T21:39:04.613

最简单的方法是使用[`SashForm`](http://help.eclipse.org/indigo/index.jsp?topic=%2Forg.eclipse.platform.doc.isv%2Freference%2Fapi%2Forg%2Feclipse%2Fswt%2Fcustom%2FSashForm.html). [这](http://www.java2s.com/Code/Java/SWT-JFace-Eclipse/SashFormExample.htm)是一个示例，它看起来是这样的：

![在此处输入图像描述](../Images/57fa855b967a83cc0e63eea045e7990a.png)

# jquery - Fullcalendar Rails 可拖动/调整大小不起作用

> ID：13895110
> 
> 赞同：3
> 
> 时间：2012-12-15T18:50:05.257
> 
> 标签：jquery, ruby-on-rails, json, jquery-ui, fullcalendar

我的第一个问题已经解决，[事件没有出现](https://stackoverflow.com/q/13893107/1699254) ，但出现了另一个问题，我无法拖动和调整大小。

在 events.js.coffee 上：

```
$(document).ready ->
  $('#calendar').fullCalendar
    editable: true,
    header:
      left: 'prev,next today',
      center: 'title',
      right: 'month,agendaWeek,agendaDay'
    defaultView: 'month',
    height: 500,
    slotMinutes: 30,

    eventSources: [{
      url: '/admin/events',
    }],

    timeFormat: 'h:mm t{ - h:mm t} ',
    dragOpacity: "0.5"

    eventDrop: (event, dayDelta, minuteDelta, allDay, revertFunc) ->
      updateEvent(event);

    eventResize: (event, dayDelta, minuteDelta, revertFunc) ->
      updateEvent(event);

updateEvent = (the_event) ->
  $.update "/admin/events/" + the_event.id,
    event:
      name: the_event.title,
      starts_at: "" + the_event.start,
      ends_at: "" + the_event.end,
      ket: the_event.description 
```

在浏览器控制台上

```
Uncaught TypeError: Object [object Object] has no method 'draggable' fullcalendar.js:2676
draggableDayEvent fullcalendar.js:2676
bindDaySeg fullcalendar.js:2658
(anonymous function) fullcalendar.js:1717
jQuery.event.dispatch jquery.js:3059
elemData.handle.eventHandle jquery.js:2677 
```

资产/javascript/application.js

```
//= require jquery
//= require jquery_ujs
//= require dataTables/jquery.dataTables
//= require dataTables/jquery.dataTables.bootstrap
//= require redactor-rails
//= require_tree .
//= require bootstrap-alert
//= require bootstrap-dropdown
//= require jquery.rest
//= require jquery.ui.slider
//= require jquery.ui.datepicker
//= require fullcalendar 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T08:17:39.983

问题解决了

改变

```
//= require jquery.ui.slider
//= require jquery.ui.datepicker 
```

至

```
//= require jquery.ui.all 
```

# perl - 来自 tarball 的 perl + SOAP + WSDL 的完整工作 HelloWorld 示例

> ID：13895120
> 
> 赞同：6
> 
> 时间：2012-12-15T18:50:33.840
> 
> 标签：perl, soap

`SOAP 1.2`我想知道是否有人可以提供带有文件的服务器（否`CGI`）+`SOAP 1.2`客户端的完整工作示例`WSDL`。

自 1 周以来我尝试的任何事情都失败了。

我对模块的最后一次尝试`SOAP::Transport::HTTP::Daemon`给了我：

```
SOAP::Serializer::envelope: Client Denied access to method (AnalyzeDocument) in class (main) at /usr/share/perl5/site_perl/SOAP/Lite.pm line 2806 
```

我打开了很多 Firefox 标签页，但在 2012 年没有一个解决方案有效。

`/usr/share/perl5/site_perl/SOAP/Lite.pm`相关部分是

```
# TODO - sort this mess out:
# The task is to test whether the class in question has already been loaded.
#
# SOAP::Lite 0.60:
#  unless (defined %{"${class}::"}) {
# Patch to SOAP::Lite 0.60:
# The following patch does not work for packages defined within a BEGIN block
#  unless (exists($INC{join '/', split /::/, $class.'.pm'})) {
# Combination of 0.60 and patch did not work reliably, either.
#
# Now we do the following: Check whether the class is main (always loaded)
# or the class implements the method in question
# or the package exists as file in %INC.
#
# This is still sort of a hack - but I don't know anything better
# If you have some idea, please help me out...
#
    unless (($class eq 'main') || $class->can($method_name)
        || exists($INC{join '/', split /::/, $class . '.pm'})) {

        # allow all for static and only specified path for dynamic bindings
        local @INC = (($static ? @INC : ()), grep {!ref && m![/\\.]!} $self->dispatch_to());
        eval 'local $^W; ' . "require $class";
        die "Failed to access class ($class): $@" if $@;
        $self->dispatched($class) unless $static;
    }

    die "Denied access to method ($method_name) in class ($class)"
        unless $static || grep {/^$class$/} $self->dispatched;

    return ($class, $method_uri, $method_name);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T16:39:26.943

**解决方案**

此解决方案使用`Apache`server + `mod_perl`on `Debian`（或派生）

```
vi /etc/apache2/sites-available/default 
```

添加块：

```
<Location /SOAP/>
    SetHandler perl-script
    PerlHandler Apache::SOAP
    PerlSetVar dispatch_to '/usr/share/perl5/'
</Location 
```

`/usr/share/perl5/HelloWorld.pm`模块文件：

```
package HelloWorld;

use strict;
use warnings;

sub sayHello {
    return "Hello @_\n";
}

1; 
```

SOAP 客户端：

```
use SOAP::Lite +trace;

use strict; use warnings;

my $client = SOAP::Lite->new;
my $ua = $client->schema->useragent;
$ua->agent("Fubar! 0.1");

my $response = $client
    # WSDL url
    ->service("http://example.com/HelloWorld.xml") // the below exposed wsdl

    # method from SOAP server Module
    ->sayHello("foo", "bar");

print $response; 
```

`WSDL`文件：

```
 <definitions xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
   xmlns:s="http://www.w3.org/2001/XMLSchema"
   xmlns:s0="urn:HelloWorld"
   targetNamespace="urn:HelloWorld"
   xmlns="http://schemas.xmlsoap.org/wsdl/">
   <types>
     <s:schema targetNamespace="urn:HelloWorld">
     </s:schema>
   </types>
   <message name="sayHello">
     <part name="name" type="s:string" />
     <part name="givenName" type="s:string" />
   </message>
   <message name="sayHelloResponse">
     <part name="sayHelloResult" type="s:string" />
   </message>

   <portType name="Service1Soap">
     <operation name="sayHello">
       <input message="s0:sayHello" />
       <output message="s0:sayHelloResponse" />
     </operation>
   </portType>

   <binding name="Service1Soap" type="s0:Service1Soap">
     <soap:binding transport="http://schemas.xmlsoap.org/soap/http"
         style="rpc" />
     <operation name="sayHello">
       <soap:operation soapAction="urn:HelloWorld#sayHello"/>
       <input>
         <soap:body use="encoded"
           encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
       </input>
       <output>
         <soap:body use="encoded"
           encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"/>
       </output>
     </operation>
   </binding>
   <service name="HelloWorld">
     <port name="HelloWorldSoap" binding="s0:Service1Soap">
         <soap:address location="http://localhost:80/SOAP/" />
     </port>
   </service>
 </definitions> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T09:11:22.750

你找到这个例子了吗？

[http://jeredsutton.com/2010/05/28/perl-soaplite-example/](http://jeredsutton.com/2010/05/28/perl-soaplite-example/)

我更正了原文中的错别字。

```
**use strict;
use warnings;
use LWP::Protocol::https;
use SOAP::Lite;

# Set SOAP username
my $USER = "user";

# Set SOAP password
my $PASSWORD = "password";

# Set SOAP API URL
my $SERVICE_LOC = 'https://localhost:2443';

# XML namespace
my $SERVICE_NS = 'http://name.space.domain/widget';
my $URI = $SERVICE_NS;

my $OUTPUT_XML = 'true';

# we use this lat
# The username and password are set by overriding the
# SOAP::Transport::HTTP::Client::get_basic_credentials method
#### Authentication

sub SOAP::Transport::HTTP::Client::get_basic_credentials {
   return $USER => $PASSWORD;
}

#### prototypes

sub method1;
sub method2;

#### CONNECT TO SERVICE

my $Service = SOAP::Lite-> proxy ($SERVICE_LOC);

$Service->outputxml($OUTPUT_XML);

#### Invoking Calls

print "\nHey does SOAP work?\n";

#### method1 Test

print "==> Invoking method1";
my $result1 = method1($Service);
if($OUTPUT_XML eq 'true'){
   print $result1;
} else {
   if($result1){
       for my $t ($result1->valueof('//tag/subtag')) {
         print $t->{value1} . " - " . $t->{value2} . "\n";
       }
   } else {
       print "no SOAP for you";
   }
}

#### method2 Test
my %DataStructure1 = (
   'data1'         => 'John Doe',
   'data2'         => '1234',
   );
my %DataStructure2 = (
   'data1'         => 'Jane Doe',
   'data2'         => '4321',
   );
my $result2 = method2($Service, \%DataStructure1, \%DataStructure2);
if($OUTPUT_XML eq 'true'){
   print $result2;
} else {
   if($result2){
       for my $t ($result2->valueof('//tag/subtag')) {
         print " " . $t->{value1} . " - " . $t->{value2} . " - " .
$t->{subsubtag}{value3} . "\n";
       }
   } else {
       print "no SOAP for you";
   }
}

#### Accessing Functions

sub method1{
   my $SOAP = shift;
   print "\n==> Invoking call method1\n";

   my $URIs;
   my $SOM = $SOAP->method1('');

   if($SOM){
       if($OUTPUT_XML eq 'true'){
           return $SOM;
       }elsif($SOM->fault) {
               die $SOM->faultstring;
       }else{
               return $SOM;
       }
   }

 return 0;
}

sub method2{
   my $Service            = $_[0];
   my $DataStructure1 = $_[1];
   my $DataStructure2 = $_[2];
   print "\n==> Invoking call method2\n";
   my  $Location = 'loc';

   my $Structure1 = SOAP::Data->name('structure1')->value([
                           SOAP::Data->name('data1')->value($DataStructure1->{'data1'}),
                           SOAP::Data->name('data2')->value($DataStructure1->{'data2'}),
                       ]);

   my $Structure2 = SOAP::Data->name('structure2')->value([
                           SOAP::Data->name('data1')->value($DataStructure2->{'data1'}),
                           SOAP::Data->name('data2')->value($DataStructure2->{'data2'}),
                       ]);

   my $Meth        = SOAP::Data->name('method2')->uri($SERVICE_NS);

   my $SOM         = $Service->call($Meth, $SERVICE_NS, $Location);

   if($SOM){
       if($OUTPUT_XML eq 'true'){
           return $SOM;
       }elsif($SOM->fault) {
               die $SOM->faultstring;
       }else{
               return $SOM;
       }
   }

   return 0;
}** 
```

# c# - 是否可以在不使用任何 LINQ 查询的情况下递归地构建 XML？

> ID：13895122
> 
> 赞同：0
> 
> 时间：2012-12-15T18:50:35.827
> 
> 标签：c#, xml, linq, reflection, linq-to-xml

1.  我之前问过一个问题，可以在[这里](https://stackoverflow.com/questions/13893662/building-xml-with-xelement-dynamically-through-recursion#comment19143146_13894023)找到，我想知道接受的答案的代码是否可以在*没有* `Linq`查询的情况下在正常编程中完成，任何示例都将不胜感激。
    请注意，这是我开始实施它的方式，并且在实施过程中遇到了一些问题。

2.  我已经设法通过反射而不使用属性来获取私有字段值，这有问题吗？我应该总是通过反射中的属性来获取值吗？

代码：

```
public static class Extensions
{
    public static XElement ToXml<T>(this T obj)
    {
        Type type = typeof(T);

        return new XElement("Class",
                    new XElement(type.Name,
                        from pi in type.GetProperties()
                        where !pi.GetIndexParameters().Any()
                        let value = (dynamic)pi.GetValue(obj, null)
                        select pi.PropertyType.IsPrimitive || 
                               pi.PropertyType == typeof(string) ?
                                new XElement(pi.Name, value) : 
                                Extensions.ToXml(value)
                        )
                    );
    }
} 
```

提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:17:33.767

如果您不想使用 LINQ：

```
public static class Extensions
{
    public static void ToXml<T>(this T obj, XmlWriter writer)
    {
        Type type = typeof(T);
        writer.WriteStartElement("Class");
        writer.WriteStartElement(type.Name);

        foreach (PropertyInfo pi in type.GetProperties())
        {
            if (pi.GetIndexParameters().Length > 0)
                continue;

            var value = pi.GetValue(obj, null);            

            if (pi.PropertyType.IsPrimitive ||
                pi.PropertyType == typeof(string))
            {
                writer.WriteElementString(pi.Name, 
                                   (value == null) ? "" : value.ToString());
                continue;
            }

            if (value == null)
                continue;

            Extensions.ToXml((dynamic)value, writer);
        }

        writer.WriteEndElement();
        writer.WriteEndElement();
    }   
} 
```

用法：

```
StringBuilder sb = new StringBuilder();
using(var writer = XmlWriter.Create(sb))
    worker.ToXml(writer);

string xml = sb.ToString(); 
```

# angularjs - 无法在指令范围内访问 rootscope var

> ID：13895124
> 
> 赞同：13
> 
> 时间：2012-12-15T18:51:09.577
> 
> 标签：angularjs, angularjs-scope

下面的函数在根作用域中定义了一个变量。

```
function MyCtrl($scope, $rootScope) {
  $rootScope.buttons = [{href: '#/students', icon:'icon-ok'},
                         {href: '#/students', icon:'icon-remove'},
                         {href: '#/students/new', icon:'icon-plus'}];
}
MyCtrl.$inject = ['$scope', '$rootScope']; 
```

下面指令中的 html 取决于 rootscope 中的一个变量 -

```
angular.module('btnbar.directive', []).
directive("btnBar", function(){
  return {
    restrict: 'E',
    scope :{},
    controller: function($scope, $element,$rootScope) {
    },
    template:'<div class="btn-toolbar">' +
      '<a class="btn" ng-repeat="b in buttons" href={{b.href}}>' +
      '<i class={{b.icon}}></i></a></div>',
    replace:true
  }
}); 
```

但是上面的代码不起作用。如果我在指令范围内直接定义“按钮”变量，它会起作用。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-12-16T02:18:20.640

您的指令中有一个**隔离**范围

```
scope:{} 
```

这意味着该指令无权访问上层作用域 - 请记住，隔离作用域在原型上不会从父作用域继承。因此，您要么删除隔离范围，要么告诉指令将某些属性从父范围绑定到其本地范围。

```
scope: {buttons: '='} 
```

然后像这样调用指令

```
<btn-bar buttons="buttons"></btn-bar> 
```

示例：[http ://plnkr.co/edit/88R66L7uAHoezDZvuoH5?p=preview](http://plnkr.co/edit/88R66L7uAHoezDZvuoH5?p=preview)

* * *

`$rootScope`此外，您可能希望从`run`方法中进行修改，而不是从控制器中修改

```
var app = angular.module('app', ['btnbar.directive']);

app.run(function($rootScope){
  $rootScope.buttons = [{href: '#/students', icon:'icon-ok'},
                        {href: '#/students', icon:'icon-remove'},
                        {href: '#/students/new', icon:'icon-plus'}];
}); 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2014-02-21T14:50:09.937

尝试：

`<a class="btn" ng-repeat="b in $root.buttons" href={{b.href}}>`

# javascript - jquery jcarousel 错误：未捕获的类型错误：对象# has no method 'jcarousel' I know that the obvious answer to this problem would be to check if the jquery and jcarousel scripts were loaded correctly, but I can see the resources in my browser debu 问问题 问问题 2012-12-15T18:52:20.250 6477 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I know that the obvious answer to this problem would be to check if the jquery and jcarousel scripts were loaded correctly, but I can see the resources in my browser debugger, and thus think that this is not the problem. I cannot seem to get it to run the script: <asp:content id="Content1" contentplaceholderid="head" runat="Server">   <link rel="stylesheet" type="text/css" href="../../App_Themes/Default/skin.css">  Obviously adjust the filename/path according to what you have and you should be good to go. javascriptjqueryasp.net-mvc-4jcarousel 4 2 回答 2 This answer is useful 3 Ok; the guy who actually answered the question but then deleted his answer never posted back, so here is the solution that worked: I had loaded the jQuery library once in the .master page and once on the .aspx page. I guess they cancelled each other out ~shrug~, because when I removed one reference, everything fell into line. 于 2013-01-02T02:57:27.727 回答 This answer is useful 3 不。基本上，您的插件没有jquery.fn.init按应有的方式绑定。你可以做的是：console.dir(jQuery.fn.init.prototype);. 这将列出绑定到一个元素的所有函数。然后检查您是否正确加载插件。基本上，javascript 告诉您它找不到名称jcarousel在 下的方法jquery.fn.init.prototype，这很可能意味着您没有正确加载它。 基本上你只需要加载脚本。  显然，根据您所拥有的调整文件名/路径，您应该一切顺利。 于 2012-12-15T18:58:02.743 回答 Related 2 angularjs - Angularjs 嵌套表单输入验证 ng-repeat 2 android - 如何将文件存储在我想稍后编辑的 Android 中？ 0 r - R中多边形的指南针方向（北，西......） 1 eclipse - JUnit - 通过 Eclipse 以相同的顺序重新运行测试 1 excel - 如何在 VBA 2003 中使用 InStr 函数？ 7 android - Android facebook 登录不适用于已安装的 Facebook 应用程序 1 c++ - 预期的 C++ 虚函数没有被调用 3 jquery - 固定标题对齐问题 3 html - 表头上的按钮 3 git - Git 命令了解当前存储库 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641</asp:content>

> ID：13895131
> 
> 赞同：1
> 
> 时间：
> 
> 标签：javascript, jquery, asp.net-mvc-4, jcarousel

I know that the obvious answer to this problem would be to check if the jquery and jcarousel scripts were loaded correctly, but I can see the resources in my browser debugger, and thus think that this is not the problem. I cannot seem to get it to run the script:

```
<asp:Content ID="Content1" ContentPlaceHolderID="head" Runat="Server">
<meta name="description" content="Support and Information for the Trail Tracker application" />

<script type="text/javascript" language="javascript" src="../../Scripts/jquery-1.4.2.min.js"></script>
<script type="text/javascript" language="javascript" src="../../Scripts/jquery.jcarousel.min.js"></script>
<link rel="stylesheet" type="text/css" href="../../App_Themes/Default/skin.css" />
   <script type="text/javascript">
    jQuery(document).ready(function () {
        jQuery('#mycarousel').jcarousel({
            // Configuration goes here
        });
    }); 
```

Here is the markup that corresponds to the method call:

```
<asp:Content ID="Content2" ContentPlaceHolderID="mainContent" Runat="Server">
<ul id="mycarousel" class="jcarousel-skin-tango">
<li>yo</li>
<li>soy</li>
</ul> 
```

please help; I have minimal experience with javascript.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T02:57:27.727

Ok; the guy who actually answered the question but then deleted his answer never posted back, so here is the solution that worked:

I had loaded the jQuery library once in the .master page and once on the .aspx page. I guess they cancelled each other out *~shrug~*, because when I removed one reference, everything fell into line.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-15T18:58:02.743

不。基本上，您的插件没有`jquery.fn.init`按应有的方式绑定。你可以做的是：`console.dir(jQuery.fn.init.prototype);`. 这将列出绑定到一个元素的所有函数。然后检查您是否正确加载插件。基本上，javascript 告诉您它找不到名称`jcarousel`在 下的方法`jquery.fn.init.prototype`，这很可能意味着您没有正确加载它。

基本上你只需要加载脚本。

```
<script type = "text/javascript" src = "../jCarousel.min.js"></script> 
```

显然，根据您所拥有的调整文件名/路径，您应该一切顺利。

# php - 扩展类时 Zend Studio 自动完成

> ID：13895132
> 
> 赞同：2
> 
> 时间：2012-12-15T18:52:21.030
> 
> 标签：php, autocomplete, zend-studio

我已经编写 PHP 7 年了——真的很喜欢 MVC 和 Zend Studio 自动完成的 OOP 方法。

尽管它不像 Visual Studio 那样复杂，但您通常可以通过以下提示来解决任何自动完成错误，例如：

```
/* @var $this Model_User */ 
```

我的问题是 - 在扩展其他类时，你究竟如何欺骗 Zend Studio - 而无需再次创建所有方法并全部评论它们。

**例如：**

```
class LivingPerson extends DeadPerson {
    // This class is just to demonstrate 
}

class DeadPerson {

    public $name;
    public $lastname;

    /**
     * Get the most popular DOH' out there
     * @param string|NULL $param
     * @return DeadPerson
     */
    public static function GetDead($param=NULL) {
        $caller = get_called_class();
        $person = new $caller();
        $person->name = 'Michael';
        $person->lastname = 'Jackson';
        return $person;
    }
} 
```

现在 - 如果我这样做：

```
var $person = DeadPerson::GetDead(); 
```

Zend Studio 现在将重新调整返回为“DeadPerson”的对象，这是真的......但是，如果我从我扩展的类中调用它，它显然仍然认为它是一个“DeadPerson”对象，即使它是实际上现在是一个“LivingPerson”对象，因为我使用 get_call_class() 来创建 LivingPerson 类的新实例。

我能想到解决此问题的唯一方法是执行以下操作：

```
class LivingPerson extends DeadPerson {
    // This class is just to demonstrate 

    /**
     * Get the most popular DOH' out there
     * @param string|NULL $param
     * @return LivingPerson
     */
    public static function GetDead($param=NULL) {
        return parent::GetDead($param);
    }
} 
```

但这有点愚蠢，因为我需要同时维护 DeadPerson 和 LivingPerson 类的参数。在对大型企业网站进行编程时，自动完成功能非常重要——程序员来这里...

* * *

# 1 感谢您的回复 - 我没有机会尝试一下 - 但我可以看到我在示例中犯了一些错误。

我可能错过了重点，因为我真的不明白为什么它应该是糟糕的抽象。:)

问题是，第二个类是一个抽象类。如果我调用 self - 我将获得 B 类的一个实例，它可能没有我需要的方法（就像它们在 A 类上一样）。

例子：

```
interface Model_Interface {
    public function setData($data);
}

abstract class Model implements Model_Interface
{
    protected $data;

    // I do some mysql magic
    public static function FetchSingle($sql,$args=NULL) {
        $args=func_get_args();

        // DO mysql query etc. etc.

        $caller=get_called_class(); // This will make new instance of Shopping_User class instead of Model_User
        $class=new $caller();
        $caller->setData($sql->UserID);

    }

    public function setData($data) {
        $this->data = (object)$data;
    }

    public function __get($name) {
        return (isset($this->data->$name)) ? $this->data->$name : NULL;
    }
}

abstract class Model_User extends Model{

    /**
    /* Get user by user id.
    /* @param $userId
    /* @return Model_User
     **/
    public static function GetById($userId) {
        return self::FetchSingle('SELECT * FROM `User` WHERE `UserID` = %s', $userId);
    }

    public function getUrl() {
        return '/what/ever/';
    }

    public function getName() {
        return $this->name;
    }
}

class Shopping_User extends Model_User {
    public function getCart() {
        return 'shopping card stuff';
    }
} 
```

尚未测试上述内容-但它应该让您了解我要完成的工作。

请参阅.. 它与 Shopping 用户相同的类具有与“普通”用户相同的属性。但是 IDE 无法重新调整新类

西蒙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:28:57.647

您的示例代码不起作用。

首先，调用`B::GetDead()`不会调用`DeadPerson::GetDead()`。在语句中分配 this`var $person = B::GetDead()`听起来完全倒退，因为这是旧的 PHP 4 公共属性语法，另外它不起作用：您不能分配需要执行代码的默认值。

第二：能够实例化自身副本的类很奇怪。除非你想实现一个 Singleton，否则应该不惜一切代价避免。在您已经知道名称的类上调用静态方法听起来像是糟糕的抽象。

因此，您可能认为您的 IDE 仅支持糟糕的自动完成功能，但实际上您会遭受糟糕的代码抽象，即没有足够正确地分离关注点。

您的示例没有充分展示您的实际问题，但如果您前往[Codereview](http://codereview.stackexchange.com)，您的代码问题可能会得到解决。

# linux - C Linux tcp 代理服务器套接字

> ID：13895137
> 
> 赞同：2
> 
> 时间：2012-12-15T18:53:26.657
> 
> 标签：linux, tcp, proxy, serversocket

我一直在 Linux 中进行一些套接字编程，我正在尝试做一个并发代理服务器。基本上我希望每个连接到代理服务器的客户端都会遇到 2 个问题。第一个是介绍命运的IP，第二个是端口号。发送此信息后，代理服务器会将每个客户端连接到他们选择的 IP（即和回显服务器）。

我的问题是我将如何以及在哪里保存每个用户回答的 2 个问题，然后将它们连接到他们选择的回声服务器。

这是我认为我们必须处理的代码部分：

```
/*============ WARNS THAT SERVER IS READY TO ACCEPT REQUESTS ==================*/
if(listen(sockfd,5)==-1) Abort("Impossible to accept requests");

/*========== STARTS ANSWERING CLIENTS BY CONCURRENT FORM  =============*/
cliaddr_len=sizeof(cli_addr);
while(1){

    FD_ZERO(&fd_read);
    FD_SET(STDIN_FILENO, &fd_read);
    FD_SET(sockfd, &fd_read);

    fflush(stdin);

    n=select(32, &fd_read, NULL, NULL, NULL);

    if(n<0)
        if( errno!=EINTR){
            close(sockfd);
            Abort("Error on select");
        }else
            continue; 

    if(FD_ISSET(STDIN_FILENO, &fd_read)){
        gets(comando);
        if(strcmp(comand, "exit")==0){
            close(sockfd);
            printf("Goodbye...\n");
            exit(0);
        }
    }

    if(FD_ISSET(sockfd, &fd_read))
        if((newsockfd=accept(sockfd,(struct sockaddr *)&cli_addr,&cliaddr_len))
                      ==-1)
            fprintf(stderr,"<SERV>Impossible to accept clients...\n");
        else{
            switch(fork()){/*Goes to backgroud*/
                case -1:fprintf(stderr,"Impossible to answer...");
                    close(newsockfd);
                    break;
                case  0:close(sockfd); /* SON */
                    AnswerClient(newsockfd);
                    exit(EXIT_SUCCESS);
                default:close(newsockfd); /* DAD */
            }
        }
}
}

/*___________________________ AnswerClient ____________________________________

______________________________________________________________________________*/

void AnswerClient(int sockfd){
static char buffer[BUFFERSIZE];
static unsigned int cont=0U;
int nbytes;
pid_t pid=getpid();

while(1){
    /*==================== PROCESS REQUEST ==========================*/
    cont++;

    switch((nbytes=ReadLine(sockfd,buffer,BUFFERSIZE))){
        case -1:fprintf(stderr,"Error receiving data...\n");
                return;
        case  0:fprintf(stderr,"Client didnt sent data...\n");
                return;
        default:printf("\n<%d>Message received: %s\n",pid,buffer);
                if(!strncmp(buffer,"exit",4)){
                    printf("<%d>Going shutdown...\n",pid);
                    close(sockfd);
                    return;
                }
                /*============ Sends Confirmation =============*/
                sprintf(buffer,"<%d>",pid);
                nbytes=strlen(buffer);
                if(WriteN(sockfd,buffer,nbytes)!=nbytes)
                    fprintf(stderr,"Impossible to confirm.\n");

    }
}
}

/*_____________________________ ReadLine _______________________________________
Reads a line (until find the caracter '\n') of a socket.
Returns:
-1 : if error
 0 : EOF
!= : if read some bytes
______________________________________________________________________________*/

int ReadLine(int sockfd,char* buffer,int maxlen){
int n,rc;
char c;

for(n=0;n<maxlen-1;n++){
    if((rc=read(sockfd,&c,1))==1){
        *buffer++=c;
        if(c=='\n') break;
    }else if (rc==0) {
        if(n==0) return(0); /*EOF*/
        else break; /*EOF but has already read some bytes*/
    } else return(-1); /*Error*/
}
*buffer=0;
return(n);
}

/*______________________________ WriteN _______________________________________
Writes n bytes on socket in case. Returns the number of bytes writen.
______________________________________________________________________________*/
int WriteN(int sockfd,char * buffer,int nbytes){

int nleft,nwritten;

nleft=nbytes;
while(nleft>0){
    if((nwritten=write(sockfd,buffer,nleft))<=0) return(nwritten);
    nleft-=nwritten;
    buffer+=nwritten;
}
return(nbytes-nleft);
} 

 void Abort(char *msg){
fprintf(stderr,"\a<SER1>Fatal error: <%s>\n",msg);
perror("Erro do sistema");
exit(EXIT_FAILURE);
}

void buryZombie()
{
static int status;
wait(&status);

} 
```

有人可以给我一个提示或只是告诉我正确的方法吗？

里卡多科斯塔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:10:35.820

要通过 TCP 连接，一侧必须连接到另一侧。代理可以决定哪一个连接，并通知一个客户端作为服务器，另一个作为客户端。

# shopify - Shopify 的替代结帐方法？

> ID：13895142
> 
> 赞同：3
> 
> 时间：2012-12-15T18:54:31.530
> 
> 标签：shopify

有没有办法将 Shopify 购物车中的“继续结帐”按钮重定向到另一个系统来处理销售？开发人员/设计师无法访问销售过程的最后一部分这一事实意味着即使是最轻微的变化也会成为一个无法克服的问题。有谁知道是否可以用另一个系统替换最后一个阶段？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-10T23:22:40.780

托管结帐流程以通过 Shopify 实现 PCI 合规性。Shopify 使用单个域来处理结帐，`checkout.shopify.com`因此无法自定义单个结帐页面，只能自定义 css。然而，有一种疯狂的方法。PCI 合规性是大多数支付网关接口软件的要求，通常需要进行季度审计。如果 Shopify 允许更改这些步骤，则可能会破坏其 PCI 合规性并导致各种问题。

我不认为这是一个设计错误，而是两全其美的权衡。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-16T08:19:33.057

不，那是不可能的。唯一的选择是使用 Google Wallet（AKA Checkout）或 PayPal 进行结帐。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-17T16:14:03.963

这是一个耻辱。结账流程是高度可定制、灵活的购物车系统的最薄弱环节。大设计监督，恕我直言。

# django-templates - 在 Django 模板中直接使用 GET 和 POST 变量

> ID：13895144
> 
> 赞同：8
> 
> 时间：2012-12-15T18:54:33.847
> 
> 标签：django-templates

我希望能够访问某人在页面模板中放置在 GET 变量中的一些信息（当然是 HTML 转义。）我将如何去做呢？我知道您可以通过视图获取此信息，但在这种情况下，我宁愿在 HTML 端处理它。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-15T19:05:37.667

您可以将该信息从视图传递到模板，就像传递另一个变量一样。渲染模板时，只需添加一个变量并传递`request.GET`QueryDict。您将能够访问模板中的所有 GET 参数。

## 编辑

`direct_to_template`自动包含`RequestContext(request)`，因此您将能够在设置中使用所有上下文实例。请`'django.core.context_processors.request'`在您`TEMPLATE_CONTEXT_PROCESSORS`的 settings.py 中添加。之后，您将能够`{{ request }}`在模板中使用访问 Django 的 HttpRequest 。示例设置、网址和模板如下：

**设置.py**

```
TEMPLATE_CONTEXT_PROCESSORS = (                                         
    'django.core.context_processors.request',

     # these are the default values from django. I am not sure whether they
     # are overritten when setting this variable, so I am including them             "django.contrib.auth.context_processors.auth",                  
    "django.core.context_processors.debug",                         
    "django.core.context_processors.i18n",                          
    "django.core.context_processors.media",                         
    "django.core.context_processors.static",                        
    "django.core.context_processors.tz",                            
    "django.contrib.messages.context_processors.messages"           
    ) 
```

**网址.py**

```
urlpatterns = patterns('django.views.generic.simple',                      

    url(r'^about/$', 'direct_to_template', {'template':                    
        'about.html'}),
) 
```

**about.html**

```
Your request is: <br /><br />                                                                                                                                                                                           

{{ request.GET }} 
```

另请参阅有关该主题的文档：

[https://docs.djangoproject.com/en/dev/ref/templates/api/#subclassing-context-requestcontext](https://docs.djangoproject.com/en/dev/ref/templates/api/#subclassing-context-requestcontext)

[https://docs.djangoproject.com/en/dev/ref/settings/#std:setting-TEMPLATE_CONTEXT_PROCESSORS](https://docs.djangoproject.com/en/dev/ref/settings/#std:setting-TEMPLATE_CONTEXT_PROCESSORS)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2021-02-24T01:02:01.780

在新的 Django 中，您可以直接在模板中使用，例如：

如果在 view.py 中使用 request.POST['name'] 发布请求，则可以在模板中使用：

```
{{request.POST.name}} 
```

如果在模板中获取请求，您可以使用：

```
{{request.GET.name}} 
```

# .net - 没有行为的实体框架 POCO - 需要重新设计以消除代码异味

> ID：13895146
> 
> 赞同：9
> 
> 时间：2012-12-15T18:54:38.910
> 
> 标签：.net, entity-framework, design-patterns, linq-to-entities

我使用 Entity Framework Model-First`Repository`和`Unit of Work`模式，存储库返回 EF POCO。

我假设我无法向 Entity Framework 生成的 POCO 添加行为，所以我的代码现在充满了诸如`XyzService`which 是实现 Entity Framework 生成的业务逻辑的单独类之类的东西`Xyz POCO`。

我有以下问题：

1.  这有一种不好的代码味道，因为我不仅有 EF POCO，而且我为每个 POCO 提供服务。除了许多类之外，业务逻辑还被拆分到业务实体之外。这是贫血反模式的一个例子吗？

2.  如果我坚持使用 EF，有什么方法可以添加行为（即通过部分类）或其他方式？

3.  看到使用从数据层（在我们的例子中是存储库）返回业务实体的持久无知模式，如果我想从`EF-MODEL -> REPOSITORY-DAL -> BIZ-ENTITY`我看到在业务实体和 EF 模型 POCO 之间会有很多双向映射。Automapper 等实用程序能否优雅地处理我可能面临的嵌套对象的复杂关系？

4.  为了减少与其对应的 EF 模型实体重复的业务实体，我是否最好删除 EF 并使用 LINQ to SQL 为每个存储库编写我自己的存储库实现？

5.  任何可以让我专注于代码的推荐方式（而不是像我一样首先将目标固定在 EF 模型上），然后在我准备好编写持久层时仍然使用实体框架，但避免了很多这样做的额外工作和映射？EF Code-First 在这方面会更好吗？

如果我错过了可以帮助开发的其他技术（例如 NHibernate），请随时提及。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T21:36:37.790

1.  是的，根据[Fowler](http://martinfowler.com/bliki/AnemicDomainModel.html)的说法，这是一种反模式。我个人并不觉得这种反模式太冒犯，但有些人会。在这里使用最佳判断。如果感觉不对并且处理起来很痛苦，那就改变它。
2.  [是](http://robbincremers.me/2012/01/31/entity-framework-using-partial-classes-to-add-business-logic-and-validation-to-generated-entities/)的。部分课程可以帮助解决这个问题。您可以将行为放在您编写的部分中。
3.  [是](https://github.com/AutoMapper/AutoMapper/wiki/Nested-mappings)的，如果嵌套对象有映射设置，Automapper 将自动处理它们
4.  再次，这取决于你。如果 EF 让您发疯，请不要使用它。使用有效的方法和让您在使用时感觉良好的方法。
5.  [Code first](http://weblogs.asp.net/scottgu/archive/2010/07/16/code-first-development-with-entity-framework-4.aspx)正是为此而构建的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T08:38:51.130

1.  确实如此，但这种方法并非没有优势。例如，在 POCO 和业务逻辑之间强制分离可以允许该逻辑被解耦并通过依赖注入或其他方式提供。
2.  请记住，部分类不能跨越多个程序集（来自[MSDN](http://msdn.microsoft.com/en-us/library/wa80x488%28v=vs.100%29.aspx)）：

    > 所有属于同一类型的部分类型定义必须在同一程序集和同一模块（.exe 或 .dll 文件）中定义。部分定义不能跨越多个模块。

    尽管您可以改为使用扩展方法来实现所需的行为，但这种限制可能是不可取的。

3.  我没有使用过 Automapper，所以 Ryan 的建议在这里适用。

4.  & 5\. 我将这些组合在一起，因为使用 Code-First 会影响您的特定存储库实现。如果您还没有尝试过 Code-First，我建议您看看它。

在存储库方面，我更喜欢存储库在我们正在处理的 POCO 类型和可用操作方面完全通用。例如，使用 LINQ，存储库可以具有`Get`基于`IEnumerable<T>`给定`Expression<Func<T, bool>>`.

我喜欢这种方法，因为它允许对存储库进行依赖注入，将标准 CRUD 操作与更多特定于域的操作完全分开，同时为消费者/派生类的代码重用提供了很好的机会。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-23T03:24:39.990

设计书籍、模式书籍和著名博主都可以，但是我们开发人员倾向于认为我们必须按照他们的建议开发我们的项目，即使这些书籍/文章没有为我们提供足够的上下文来理解它们适用于哪些情况以及它们何时适用不。

对于所有类型的应用程序都没有像好的设计这样的东西。我看到您专注于技术点，这没关系，但首先您应该回答最重要的问题：您的要求是否适合该设计？

请记住，您有需求、约束、资源和时间以及其他考虑因素，这迫使您参与必须指导您的设计的一些权衡。

例如：

*   你真的需要存储库吗？您直接使用 EF 获得的实体是什么？
*   你需要 DataModels 和 BizModels 吗？如果您只使用 TransactionScripts 会怎样？
*   你需要UoW吗？为什么？EF 不能很好地为您处理这个问题吗？

这些问题的答案不是绝对的，它们取决于您的要求、时间、预算等。

现在，让我告诉你我对你的问题的看法：

1.  **是**的，由于某些原因，它闻起来很糟糕：a）POCO 对象应该是，嗯... POCO，这是因为您有 biz-object ，当然，它有逻辑但是...... POCO 对象有什么样的逻辑?
2.  **是**的，应该使用部分类而不是您的 xyzService。这更清楚，因为您的 xysServices 根本不是服务！
3.  **是**的，Automapper 可以处理映射问题。但是，它并不能解决您可能有很多映射的问题。同样，如果您不需要它，请避免使用它们。
4.  您（或您的公司）是否有足够的金钱和时间来做到这一点？如今，没有人在没有绝对充分理由的情况下避免使用 ORM。所以，不，不要这样做！
5.  同上 4。

这是我的意见。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-22T13:51:35.250

您可能想走**“代码优先”**的道路。我曾经使用带有部分类的 EF 建模工具，但仍然存在重大问题，例如对生成的代码缺乏控制 - 更不用说建模器的零星问题，需要我重新创建关系。

使用“代码优先”，您可以更好地控制您的 POCO，以及许多额外的好处，例如数据库迁移，以及使用 T4 模板等以您喜欢的方式构建 POCO 的能力。

我不会回到 LinqToSQL，EF 功能更丰富，未来更光明，IMO。EF 现在是开源的，我查看了一些源代码以帮助解决我遇到的某些问题。

# parallel-processing - go是使用共享内存还是分布式计算

> ID：13895147
> 
> 赞同：7
> 
> 时间：2012-12-15T18:54:48.673
> 
> 标签：parallel-processing, go, shared-memory, distributed-computing

Go 的口号是“不要通过共享内存进行通信；而是通过通信来共享内存”。我想知道 Go 是使用共享内存还是分布式计算方法。例如，对于 MPI，它显然是分布式的，OpenMP 显然是共享内存；但我不确定 Go 是独一无二的。

我看过很多帖子，例如[Shared memory vs. Go channel communication](https://stackoverflow.com/q/1730655/984260)，有效的 Go 文档等，但无法澄清。提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-15T22:30:56.517

Go 不会阻止您在 goroutines/线程之间共享内存。他们所说的通信的意思是，您通过通道发送数据块或指向该块的指针。这有效地将数据的“所有权”转移给了通道的目标阅读器。请注意，这种所有权转移不是由语言或运行时强制执行的，它只是按照惯例。

如果你愿意的话，你仍然完全有能力从两个 goroutine 写入相同的内存。换句话说：Go 不会阻止你在脚下开枪，它只是提供了语言语义，使这些错误更容易被发现。

如果一个值被传递到一个通道，程序员必须假设该值不再是他在同一个 goroutine 中写入的。

```
func F(c chan *T) {
    // Create/load some data.
    data := getSomeData()

    // Send data into the channel.
    c <- data

    // 'data' should now be considered out-of-bounds for the remainder of
    // this function. This is purely by convention, and is not enforced
    // anywhere. For example, the following is still valid Go code, but will
    // lead to problems.
    data.Field = 123
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-16T13:52:28.677

该问题假设共享内存和分布式计算是相反的。这有点像问：RAM 和 LAN 是对立的吗？区分 CPU/内存节点内的共享内存并发和 CPU/内存节点之间的共享内存并发会更清楚。

这是并行处理研究大局的一部分。有许多研究项目，包括：

*   开发具有多个 CPU 共享单个内存的非冯诺依曼计算机，并通过某种形式的交换结构（通常是 Clos 网络）加入。OpenMP 非常适合这些。

*   开发由一组 CPU 组成的并行计算机，每个 CPU 都有自己独立的内存，并且在节点之间有一些通信结构。这通常是 MPI 的所在地。

第一个案例专门针对高性能计算兄弟会。我们大多数人都熟悉后一种情况。在这种情况下，这些天通信通常只是通过以太网，但是已经（成功地）为某些特定领域开发了各种更快的低延迟替代方案（例如， [IEEE1355 SpaceWire](http://en.wikipedia.org/wiki/IEEE_1355)，它来自 Transputer 串行链路）。

多年来，主流观点是只有在共享内存的情况下才能实现有效的并行性，因为（天真地）假设通过传递消息进行通信的成本是令人望而却步的。对于共享内存并发，困难在于软件：因为一切都是相互依赖的，所以随着系统变得越来越大，设计并发变得越来越难。需要核心专业知识。

对于我们其他人来说，Go 遵循 Erlang、Limbo，当然还有 Occam，以促进**消息传递**作为编排要完成的工作的手段。这源于[通信顺序过程](http://en.wikipedia.org/wiki/Communicating_sequential_processes)的代数，它为创建任何规模的并行系统提供了基础。CSP 设计是可组合的：每个子系统本身都可以是更大系统的一个组件，没有理论上的限制。

您的问题提到了 OpenMP（共享内存）和 MPI（分布式内存消息传递），它们可以一起使用。Go 可以被认为与 MPI 大致等效，因为它促进了消息传递。然而，它也允许锁和共享内存。Go 与 MPI 和 OpenMP 都不同，因为它没有明确关注多处理器系统。要进入使用 Go 进行并行处理的世界，需要一个网络消息传递框架，例如[OpenCL](http://en.wikipedia.org/wiki/OpenCL)，有人正在为此开发 Go API。

# android - 滑动菜单锁定上视图上的触摸事件

> ID：13895149
> 
> 赞同：10
> 
> 时间：2012-12-15T18:55:00.517
> 
> 标签：android, menu, android-viewpager, slidingdrawer

我正在尝试在我的应用程序中使用[滑动菜单](https://github.com/jfeinstein10/SlidingMenu)。在我的 Sony Xperia S 上它工作得非常好，但是当我尝试在 HTC Desire HD 上启动应用程序时，菜单通过手势完美打开，但其他触摸事件被阻止并且顶部视图（`ViewPager`，滑动菜单在其后面）没有滚动。

有人知道如何解决这个问题吗？

给出答案可能会有所帮助（这就是我使用菜单的方式）：

```
private void initSlidingMenu()  
{       
    mSlidingMenu = new SlidingMenu(getApplicationContext());

    mSlidingMenu.setMode(SlidingMenu.LEFT);
    mSlidingMenu.setTouchModeAbove(SlidingMenu.TOUCHMODE_MARGIN);
    mSlidingMenu.setShadowWidthRes(R.dimen.default_shadow_width);
    mSlidingMenu.setShadowDrawable(R.drawable.defaultshadow);
    mSlidingMenu.setBehindOffsetRes(R.dimen.default_behind_offset);
    mSlidingMenu.setFadeDegree(0.35f);
    mSlidingMenu.setMenu(firstPage);
    mSlidingMenu.attachToActivity(this,SlidingMenu.SLIDING_CONTENT);    
} 
```

在`onPageSelected()`中，我禁用或启用菜单，因此菜单仅出现在左侧页面：

```
@Override public void onPageSelected(int arg0)
{
    ActivityCompat.invalidateOptionsMenu(this);

    if (arg0 == Utils.DEFAULT_PAGE)

        mSlidingMenu.setTouchModeAbove(SlidingMenu.TOUCHMODE_FULLSCREEN);

    else

        mSlidingMenu.setTouchModeAbove(SlidingMenu.TOUCHMODE_NONE);
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-16T01:43:42.363

我只是在运行 ICS 的三星 Galaxy S2 上运行良好的滑动菜单时遇到了同样的问题，但在运行 Gingerbread 的 HTC Desire 上却没有。

我使用与您相同的方法来实现滑动菜单，但我发现另一种实现解决了这个问题。

而不是手动将菜单附加到您的活动：

```
mSlidingMenu.attachToActivity(this,SlidingMenu.SLIDING_CONTENT); 
```

我选择通过 SlidingMenu 库中的一项滑动活动来扩展我的活动。就我而言，我的活动一开始是在扩展`FragmentActivity`，但我将其替换为`SlidingFragmentActivity`

然后你应该在方法中设置 behindView`onCreate`否则你的活动会崩溃。

```
setBehindContentView(R.layout.slidingmenu); //Replace with the layout of your menu 
```

它应该可以解决问题。

这是我的 Activity 的示例代码：

```
public class MainActivity extends SlidingFragmentActivity {

SlidingMenu menu;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    // Main view layout for the activity
    setContentView(R.layout.activity_listing); 

    // set the Behind View : REQUIRED (replace with your menu's layout)
    setBehindContentView(R.layout.slidingmenu);

    menu = getSlidingMenu();

    //Now you can customize your sliding menu if you want
    menu.setMode(SlidingMenu.LEFT);
    menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_MARGIN);
    menu.setShadowWidthRes(R.dimen.shadow_width);
    menu.setShadowDrawable(R.drawable.slidingmenu_shadow);
    menu.setBehindOffsetRes(R.dimen.slidingmenu_offset);
    menu.setFadeDegree(0.35f); 
```

您会注意到，使用此解决方案您无需致电

```
mSlidingMenu.setMenu(firstPage);
mSlidingMenu.attachToActivity(this,SlidingMenu.SLIDING_CONTENT); 
```

我没有分析 SlidingMenu 库的所有源代码，但`attachToActivity`在某些情况下，当前方法可能存在错误，如果我们使用库提供的特殊活动，这些错误不会出现。

**编辑：**对于那些使用 SlidingMenu 库和 ActionBarSherlock (ABS) 的人来说还可以。首先，您必须确保在 SlidingMenu 库中引用了 ABS。这样，您就可以通过 ABS 扩展 SlidingMenu 提供的活动类。

例如，如果我想将 FragmentActivity 与 ABS 和滑动菜单一起使用：您必须在滑动菜单库中进行更改

```
class SlidingFragmentActivity extends FragmentActivity implements SlidingActivityBase 
```

经过

```
class SlidingFragmentActivity extends SherlockFragmentActivity implements SlidingActivityBase 
```

然后在您的应用程序中，`SlidingFragmentActivity`正常使用。

这是我的应用程序的代码，它就像我发布的一样，但支持 ABS：

```
public class MainActivity extends SlidingFragmentActivity {

ActionBar mActionBar;
SlidingMenu menu;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_listing); //Layout of the above view

    /*
     * ABS initialization
     */
    mActionBar = getSupportActionBar();
    mActionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_STANDARD);
    mActionBar.setDisplayHomeAsUpEnabled(true);

    /*
     * Sliding menu initialization
     */
    menu = getSlidingMenu();
    menu.setMode(SlidingMenu.LEFT);
    menu.setTouchModeAbove(SlidingMenu.TOUCHMODE_MARGIN);
    menu.setShadowWidthRes(R.dimen.shadow_width);
    menu.setShadowDrawable(R.drawable.slidingmenu_shadow);
    menu.setBehindOffsetRes(R.dimen.slidingmenu_offset);
    menu.setFadeDegree(0.35f);

            /* This line initializes the way the sliding menu is working
            if you set the boolean to true, the ActionBar will slide along with the content.
            if you set to false, only the content will slide and the ActionBar will not move */
    setSlidingActionBarEnabled(true);

    // set the Behind View
    setBehindContentView(R.layout.slidingmenu); //Menu view 
```

# testing - 如何在haskell中测试count_if函数

> ID：13895152
> 
> 赞同：1
> 
> 时间：2012-12-15T18:55:12.283
> 
> 标签：testing, haskell

我正在尝试编写一个函数，该函数接受谓词和列表并返回满足谓词的列表。

所以，例如，我想要这样的东西：

```
haskell> count_if (x > 3) [2,3,4,5,6] 
[4,5,6] 
```

这是我到目前为止所拥有的：

```
count_if f [] = 0 
count_if f (x:xs) 
  | f x = x : count_if f xs
  | otherwise = count_if f xs 
```

我的问题是，如何使用谓词测试这个函数？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T18:59:09.670

`filter`为此目的有一个功能。无论如何，要测试 count_if 或过滤器，您可以执行类似的操作

```
filter (>3) [2,3,4,5,6] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T17:15:29.380

您的`countif`函数正在努力计算任何内容，因为您告诉它列出一个列表：

```
count_if f [] = 0  -- fine, makes sense
count_if f (x:xs) 
  | f x = x : count_if f xs  -- Oops, no!
  | otherwise = count_if f xs  -- yup 
```

请注意`1:[2,3]`= `[1,2,3]`，所以`:`用于在列表的前面放置一个额外的元素。如果你想数数，你需要一个数字，而不是一个列表。（放在`x`前面听起来很像`filter`，它为您提供了谓词为真的所有元素，但您想计数，这是不同的。）

如果您通过给出明确的类型签名（如`count_if :: (a -> Bool) -> [a] -> Int`. 不是把`x`with 放在前面`x:`，让我们加上一个 with `1+`，给

```
count_if :: (a -> Bool) -> [a] -> Int
count_if f [] = 0 
count_if f (x:xs) 
  | f x = 1 + count_if f xs  -- adds one to the total from the rest
  | otherwise = count_if f xs 
```

现在可以这样测试：

```
> count_if (>5) [1..10]
5
> count_if (=='e') "Time is of the essence"
5
> count_if even [1..100]
50 
```

现在您*可以*使用`count_if`. `filter`过滤器的类型是`filter :: (a -> Bool) -> [a] -> [a]`，它只提供您需要的元素：

```
> filter (>5) [1..10]
[6,7,8,9,10]
> filter (=='e') "Time is of the essence"
"eeeee" 
```

但然后对结果做长度：

```
countif' :: (a -> Bool) -> [a] -> Int
countif' f xs = length (filter f xs) 
```

但这可以写得更简洁

```
countif :: (a -> Bool) -> [a] -> Int
countif f = length . filter f 
```

因为`.`是函数组合 - 这表示过滤器`f`，然后取长度。

（Pointfree 极客们更愿意写这个，`countif = (length.).filter`但这是另一天的教训！）

`filter`使用像and这样的标准函数`length`可能会导致您自己可能无法发现的性能增强。如果您`countif (>0) [1..1000000]`针对 进行测试`count_if (>0) [1..1000000]`，您会发现它的运行速度明显更快。因此，从 prelude中了解诸如`filter`、等前奏函数是一个好主意。`foldr``scanr`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-15T23:12:57.913

有几种方法可以编写谓词。有一些内置函数是谓词，例如：

```
even :: Integer -> Bool
odd  :: Integer -> Bool
null :: [a] -> Bool 
```

您可以将运算符部分与比较运算符一起使用：

```
(== 0) :: Integer -> Bool
(3 >)  :: Integer -> Bool 
```

或者，您可以使用 lambda 表达式编写更复杂的谓词：

```
(\x -> 1 < x && x < 5) :: Integer -> Bool 
```

例如，你应该有：

```
count_if even [1,2,3,4,5,6]                   -->  [2,4,6]
count_if (3 >) [1,2,3,4,5,6]                  -->  [1,2]
count_if (\x -> 1 < x && x < 5) [1,2,3,4,5,6] -->  [2,3,4] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-15T18:59:08.440

有一个称为过滤器的现有功能

见：[http ://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:filter](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:filter)

编辑：

所以问题是你的实现几乎是正确的：

```
count_if f [] = 0 
```

需要是

```
count_if :: (a -> Bool) -> [a] -> [a]
count_if f [] = []
count_if f (x:xs) 
| f x = x:count_if f xs
| otherwise = count_if f xs 
```

如果您指定函数的类型，它会有所帮助，然后编译器会帮助您

# jquery - 无需悬停/单击即可选择浮点图表数据点的任何方式（外部按钮）

> ID：13895154
> 
> 赞同：2
> 
> 时间：2012-12-15T18:55:15.357
> 
> 标签：jquery, flot

我正在寻找一种方法来通过触发单击外部按钮来激活 jquery flot 折线图上的一个/一些数据点。我怎么能做到这一点 - 我如何在不使用鼠标的情况下获得数据点的句柄 - 我将如何激活它并激活工具提示？

感谢任何专家的建议！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T20:18:42.547

在我之前的评论中，我不知道 FLOT 中存在的 API 钩子和方法。旧文档是一个非常原始的`txt`文件。这是一个简单的示例，使用`highlight/unhighlight`以及使用该`pointOffset()`方法计算图表中数据点的像素位置以定位工具提示。

```
<button data-index="4">Highlight 5th point</button>
<button data-index="9">Highlight 10th point</button>
<button data-index="19">Highlight 20th point</button> 
```

JS：

```
var plotData =/* data array*/

$('button').click(function(){
    var idx=$(this).data('index');
    plot.unhighlight()
    plot.highlight(dataSeriesIndex, idx);
    var dataPoint=plotData[idx];
    var position=plot.pointOffset({ x: dataPoint[0], y:  dataPoint[1] })
    var tipHTML='Data:<br> X='+dataPoint[0] +'<br> Y=' +dataPoint[1];
    $('#tooltip').css({left: position.left+10, top: position.top-10}).show().html(tipHTML)     
}) 
```

演示：http: [//jsfiddle.net/et87Y/73/](http://jsfiddle.net/et87Y/73/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T19:29:32.137

Flot 在绘图对象上提供了 highlight 和 unhighlight 方法，如文档的[Plot Methods](https://github.com/flot/flot/blob/master/API.md#plot-methods)部分所述。

传入系列的索引和系列内点的索引，它会突出显示该点。

在与 Flot 捆绑的示例文件夹中找到的“交互”示例具有此功能的实时演示。

# objective-c - 在本地存储数据直到应用程序打开

> ID：13895155
> 
> 赞同：2
> 
> 时间：2012-12-15T18:55:39.913
> 
> 标签：objective-c, ios, ipad

我有一个本地 Sqlite DB，其中包含 3 个表（高级经理、经理、员工）& 所有 3 个表都是相互关联的。我为数据创建了 3 个 NSObject 类（wrt 表）。现在我有一个 Controller 类，我可以在其中查询这些表并创建那些 NSobject 类的对象并更新它。最后，我将这些对象添加到该类中的数组中。

现在假设我有 3 个视图控制器（VC1、VC2、VC3）。所以当我从 VC1 来到 VC2 时，我调用数据控制器类，进行查询并从数据控制器类获取数组并在 3 个表视图中显示这些数据在我的 VC2 中。所以现在我可以添加/删除一个新的高级经理/经理并在 VC2 的不同表格视图中显示它。

所以我的问题是当我再次从 VC2 回到 VC1 并再次回到 VC2 时，我看不到添加/删除的行。因为在我的 viewDidLoad 中，我再次尝试从 Data 控制器类中获取我的数组，因此它将再次显示 DB 中存在的数据。

注意我有一个限制，我不想将这些添加/删除操作数据写入任何数据库。因此，每次重新启动应用程序时，我都必须显示数据库中存在的默认数据。

任何机构都可以帮我解决这个问题吗？因此，从应用程序的打开到关闭，我可以维护这些数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:04:54.790

如果您希望数据从启动到启动持续存在，您将需要将其存储在持久的地方、文件、数据库、iCloud 等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:07:21.633

您是从捆绑包中打开数据库吗？您无法将更改保存到包中的数据库。您需要将数据库从捆绑包复制到`Documents`然后打开该数据库。如果您不想在会话之间保存数据库，只需确保始终将数据库从捆绑包复制到`Documents`应用程序首次启动时。`Documents`（通常，只有当数据库不存在于 中时，人们才会从 bundle 复制到`Documents`，但听起来您总是想复制它。）

要复制数据库，您可以执行以下操作：

```
NSString *databaseName = kDatabaseName; // obviously, replace this with your database filename

NSString *documentsFolder      = [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0];
NSString *databaseDocumentPath = [documentsFolder stringByAppendingPathComponent:databaseName];
NSString *databaseBundlePath   = [[NSBundle mainBundle] pathForResource:databaseName ofType:@""];

NSFileManager *fileManager = [NSFileManager defaultManager];
NSError *error;

if (![fileManager copyItemAtPath:databaseBundlePath
                          toPath:databaseDocumentPath
                           error:&error])
    NSLog(@"Unable to copy database from '%@' to '%@': error = %@", databaseBundlePath, databaseDocumentPath, error); 
```

一旦你这样做，你可以打开指向的数据库`databaseDocumentPath`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T20:23:43.700

从数据库加载后，您只需要缓存数组。这大致是你可以做的：

```
@implementation DataController

static NSMutableArray *managers;

//Note: not thread-safe
- (NSMutableArray*) managers {
    if (!managers)
      managers = loadDefaultManagers();//queries default data from sqlite db and loads array

    return managers;
}

- (void) addManager:(NSDictionary*) manager {
  [managers addObject:manager];
}
...

@end 
```

# javascript - 奇怪的 javascript 错误 Uncaught SyntaxError: Unexpected token ILLEGAL

> ID：13895157
> 
> 赞同：2
> 
> 时间：2012-12-15T18:55:55.553
> 
> 标签：javascript, syntax-error

> **可能重复：**
> [SyntaxError: Unexpected token ILLEGAL](https://stackoverflow.com/questions/12719859/syntaxerror-unexpected-token-illegal)

我工作了 2 个小时，现在我回到了我的代码上，我在 chrome 控制台中

Uncaught SyntaxError: Unexpected token ILLEGAL

在我的 function.js 中

我只有：

```
function test(){
    alert("aa")​
} 
```

我在firefox上也有错误

谢谢

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-15T18:58:29.493

看我发现了什么：

![在此处输入图像描述](../Images/48a175c5d75b43fa5bd12bd2a48a4e68.png)

看起来你在右括号后面有一个非法字符。我不知道它是如何到达那里的，但删除它应该使它工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T18:58:18.697

尝试检查您的原始来源是否有尾随空格字符，并在警报调用后添加行终止符。分号是可选的，但最好真的包含它们。

```
function test()
{
    alert('aa');//<-- check for trailing white-space here
}//<-- and here, too 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T19:01:37.437

重新输入代码而不是复制粘贴，代码中可能有一些不可见的字符。

# regex - .htaccess URL重写跳过其他/

> ID：13895160
> 
> 赞同：2
> 
> 时间：2012-12-15T18:55:58.240
> 
> 标签：regex, .htaccess, expression

我的 .htaccess 文件中有以下代码

```
RewriteEngine on
RewriteRule ^thumbnail/(.*).png thumbnail.php?url=$1 [NC] 
```

而它的作用是转

```
http://mydomain.com/thumbnail.php?url=http%3A%2F%2Fwww.example.com%2F 
```

进入

```
http://www.mydomain.com/thumbnail/http%3A%2F%2Fwww.example.com%2F.png 
```

但是当我`echo`输出文件`url`中的变量时，`thumbnail.php`它会返回

`http:/www.example.com/`不是`http://www.example.com/`

另一个`/`去哪儿了？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T19:23:32.350

因为它`http://www.example.com/`是 URI 路径的一部分（而不是查询字符串的一部分），所以 apache 会自动规范化路径，从而删除多个连续的斜杠。例如，如果您尝试访问：

```
http://www.mydomain.com/thumbnail/foo//////////////bar.png 
```

然后打印出 的值`url`，你会得到`foo/bar.png`，因为在 URI 甚至到达处理管道中的 mod_rewrite 之前，多余的斜杠就被清除了。

或者，您可以删除该`http://`部分并将其添加到重写中：

```
RewriteEngine on
RewriteRule ^thumbnail/(.*).png thumbnail.php?url=http://$1 [NC] 
```

那么你的网址就是：

```
http://www.mydomain.com/thumbnail/www.example.com%2F.png 
```

当你打印出 的值时`url`，你会得到`http://www.example.com/.png`

# magento - 如果在 magento 1.7 中为 0，则隐藏产品价格？

> ID：13895175
> 
> 赞同：1
> 
> 时间：2012-12-15T18:57:28.933
> 
> 标签：magento, magento-1.7

我正在使用 magento 1.7.0.2 。在我的商店中，我想展示一些没有价格的产品，默认情况下在 magento 中它们变为 0.00 。有一些解决方案，用于替换：this

```
<?php echo $this->getPriceHtml($_product, true) ?> 
```

和

```
<?php if($_product->price==0): ?> 
<?php echo 'Free'; /?> 
<?php else: ?> 
<?php echo $this->getPriceHtml($_product, true) ?>
<?php endif; ?> 
```

是的，只有当我在 list.phtml（列表和网格）中替换时才能解决问题，但是当我打开包含所有详细信息的产品页面时，仍然有 0.00。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T14:05:52.993

我解决了这个问题，只需要替换这段代码，在路径 app\design\frontend\default\YOURTHEME\template\catalog\product 中：

```
 <?php echo $this->getTierPriceHtml() ?>
 <?php echo $this->getChildHtml('alert_urls') ?>
 <?php echo $this->getChildHtml('product_type_data') ?>
 <?php echo $this->getChildHtml('extrahint') ?> 
```

有了这个：

```
<?php if($_product->price==0): ?> 
<?php echo 'Free'; ?> 
<?php else: ?> 
<?php echo $this->getPriceHtml($_product, true) ?>
<?php endif; ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T08:15:44.080

你可以试试这个——

[http://www.magikcommerce.com/magento-hide-price-extension](http://www.magikcommerce.com/magento-hide-price-extension)

希望这会帮助你。

# python - SQLAlchemy 和 SQLite：数据库被锁定

> ID：13895176
> 
> 赞同：15
> 
> 时间：2012-12-15T18:57:31.513
> 
> 标签：python, sqlite, python-2.7, sqlalchemy

我有一个使用最新 sqlalchemy 的 python 脚本。当我使用 sqlite，只有 sqlite，其他数据库运行良好时，我收到以下错误：

```
sqlalchemy.exc.OperationalError: (OperationalError) database is locked u'SELECT blabla.... 
```

有什么提示吗？

我的代码示例（简化），我有几个这样的方法来选择、更新和删除东西：

```
class MyDb(object):
    def __init__(self):
        engine = create_engine("sqlite:///file", poolclass=NullPool, pool_threadlocal=True)
        engine.pool_size=1
        engine.pool_timeout = 60
        self.sess = sessionmaker(bind=engine)

    def del_stuff(self):
        sess = self.sess()
        sess.query(Stuff).delete()
        try:
            sess.commit()
        except:
            sess.rollback()

    def set_stuff(self, id, bar):
        sess = self.sess()
        sess.query(Foo).get(id).bar = bar
        try:
            sess.commit()
        except:
            sess.rollback() 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2015-02-26T16:36:28.630

SQLite 在对数据库进行写入时锁定数据库，例如发送 UPDATE、INSERT 或 DELETE 时。使用 ORM 时，这些会在刷新时发送。数据库将保持锁定状态，直到出现 COMMIT 或 ROLLBACK。

我主要在多线程情况下看到“数据库被锁定”错误。一个线程将锁定数据库，另一个线程将尝试自己的写入。如果第一个线程没有在超时期限内释放锁（默认情况下为 4-5 秒，如果我记得的话），则会在第二个线程上引发 OperationalError。

`autoflush=True`知道何时刷新可能很棘手，因此当会话具有（默认设置）时写入数据库，因为*任何*查询都会导致刷新。有时打开 SQL 日志记录可以帮助澄清事情何时发生：

```
logging.getLogger('sqlalchemy.engine').setLevel(logging.INFO) 
```

这里有一些相关文档：http: [//docs.sqlalchemy.org/en/rel_0_9/dialects/sqlite.html#database-locking-behavior-concurrency](http://docs.sqlalchemy.org/en/rel_0_9/dialects/sqlite.html#database-locking-behavior-concurrency)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-15T19:07:44.627

sqlite 数据库一次只允许一个进程访问它。也许您有一个使用数据库的单独进程？

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2019-04-04T02:44:40.903

Check any commits pending in database through any developer tools.

As everyone told above sqlite databases only allow one process to access it at a time. In my case, I am using **DB browser for sqlite** and in the same, I didn't commit a query. That's also lock the DB and will not allow the application to write to database.

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-02-05T22:39:15.837

您应该在线程中的所有对象中使用单个会话。sqlite 真的不喜欢多个连接，而 sqlalchemy 实际上是每个会话的连接（看起来每个类可能都有一个会话，这意味着单个线程中有多个会话）。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2019-07-24T22:15:05.993

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2012-12-18T10:17:18.137

检查您的代码以了解以下几点：

1.  MyDb 的实例必须是所有应用程序生命周期中的一个。MyDb 必须是单例。
2.  尝试对引擎使用“普通”策略，但不要`pool_threadlocal=True`
3.  每个逻辑请求的关闭会话都已完成。

例如：

```
def set_stuff(self, id, bar):
    sess = self.sess()
    sess.query(Foo).get(id).bar = bar
    try:
        sess.commit()
    except:
        sess.rollback()
    finally:
        sess.close() 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-07-21T09:34:00.330

我有同样的错误，我可以通过以下方式修复：

```
db.session.close_all() 
```

对我来说，由于打开的数据库连接太多而发生错误，因为我使用的是 Spyder 控制台而不是终端

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-05-11T09:09:51.430

也遇到了同样的问题：

```
 File "/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/default.py", line 590, in do_execute
    cursor.execute(statement, parameters)
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) database is locked
[SQL: DELETE FROM vminds4 WHERE vminds4.id = ?]
[parameters: (2,)]
(Background on this error at: http://sqlalche.me/e/e3q8) 
```

最后，到这里，因为我只是打开另一个终端打开 sqlite3 文件，在我关闭窗口后，它就可以工作了！

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-07-25T13:10:27.127

只需使用`StaticPool`. 并遵循这个答案（scoped_session）：[https ://stackoverflow.com/a/9621251](https://stackoverflow.com/a/9621251)

`create_engine(DB_PATH, echo=False, poolclass=StaticPool, connect_args={'check_same_thread': False})`

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-11-19T14:40:44.257

对于未来的人，在我的情况下，用于写入 CIFS 共享挂载上的 sqlite 文件的 pandas`to_sql`函数（带有 sqlalchemy 连接字符串）失败了。相同的功能可以在 ext4 磁盘上运行。解决方法是添加`nobrl`到 中的选项`/etc/fstab`，卸载，然后重新安装磁盘。然后`to_sql`命令起作用了。

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2019-11-22T11:07:55.837

我的答案只适用于那些正在试验烧瓶数据库并且他们准备删除他们的数据库以移除数据库锁的人。如果您正在试验，那么您当然可以通过运行 python 脚本再次将数据添加到表中。

开始了....

1.  删除烧瓶项目中存在的 data.sqlite 文件

2.  删除烧瓶项目中存在的迁移文件夹

3.  现在运行以下命令来创建一个新数据库：

    *   烧瓶数据库初始化
    *   烧瓶数据库迁移-m“表”
    *   烧瓶数据库升级
4.  现在您可以运行 python 脚本将数据添加到数据库中，也可以使用 python promt/flask shell 手动将数据添加到表中。

* * *

## 回答 #12

> 赞同：-3
> 
> 时间：2020-11-26T09:44:45.070

如果表中存在重复记录，则可能会发生这种情况

# node.js - nodejs - 下载的图像已损坏

> ID：13895186
> 
> 赞同：2
> 
> 时间：2012-12-15T18:58:45.117
> 
> 标签：node.js

我正在尝试在 nodejs 中使用 http.get 下载和图像。图像似乎可以下载，但无法打开。操作系统抱怨文件的格式不正确。有人可以告诉我我在这里做错了什么吗？

下面是我只是想获取 Google 徽标的示例：

```
 var options = {
    host:'www.google.com',
    port:80,
    path:'/images/srpr/logo3w.png'
};

    var downloadImage = function (options, fileName) {
        http.get(options, function (res) {
            var imageData;
            res.setEncoding('binary');
            res.on('data', function (chunk) {
                imageData += chunk;
            });
            res.on('end', function () {
                fs.writeFile(fileName, imageData, 'binary', function(err){
                    if(err) throw err;
                    console.log('File: ' + fileName + " written!");
                })
            });
        });
    };

downloadImage(options,'test.png'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:18:14.223

除了初始化 imageData 之外，该代码看起来不错。

```
 var imageData = ''; 
```

应该解决这个问题。[https://stackoverflow.com/a/5294619/1135590](https://stackoverflow.com/a/5294619/1135590)有更详细的讨论。

# iphone - 地理编码地址字符串iOS 6时返回多个地标

> ID：13895188
> 
> 赞同：4
> 
> 时间：2012-12-15T18:58:56.007
> 
> 标签：iphone, objective-c, ios6, ios6-maps

这是我在堆栈上的第一篇文章。我是 iOS 开发新手，需要地理编码方面的帮助。

特别是，根据 Apple 的文档：“返回的地标对象的数量在很大程度上取决于所提供信息的特异性。因此，提供街道、城市、省和国家/地区信息更有可能返回单个地址，而不仅仅是街道和城市信息。”

因此，在提供地址字符串时宽泛，应该（理论上）返回多个结果。

例子：

```
-(void)geocodeAddress {
CLGeocoder *geocoder = [[CLGeocoder alloc]init];
[geocoder geocodeAddressString:@"DMV, San Francisco, CA" completionHandler:^(NSArray *placemarks, NSError *error) {
    if (!error) {
        NSLog(@"Found: %i", [placemarks count]);
        for (CLPlacemark *placemark in placemarks) {
            CLLocationCoordinate2D coordinate = CLLocationCoordinate2DMake(placemark.location.coordinate.latitude, placemark.location.coordinate.longitude);
            MapAnnotation *annotation = [MapAnnotation mapAnnotationWithCoordinate:coordinate title:@"DMV" subtitle:@"Great service?"];
            [self.mapView addAnnotation:annotation];
        }
    } else {
        NSLog(@"Error code: %i", [error code]);
    }
}]; 
```

}

让我有点困惑的是，无论我的“搜索”有多广泛（星巴克，DMV，与 1234 S 312th Place，City，State），我总是会返回一个位置。

所以，我的问题是，有没有办法为特定搜索返回多个结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T10:25:31.227

看起来 CLGeocoder 在这个阶段非常有限。在更新解决此问题之前，您最好的选择是使用其他服务（例如 Google Maps Geocoding API）。请注意，您只能将 Google 地理编码与谷歌地图一起使用：[https ://developers.google.com/maps/documentation/geocoding/](https://developers.google.com/maps/documentation/geocoding/)

# powershell - 使用自定义字段格式化 PowerShell 输出

> ID：13895197
> 
> 赞同：0
> 
> 时间：2012-12-15T18:59:47.083
> 
> 标签：powershell, scripting

我对 PowerShell 有点陌生，并且无法正确格式化我正在编写的脚本的输出。

代码段的第一行返回我要格式化的对象数组（打印机事件日志中的事件 ID 372）。第二行打印出我需要的位置 3 对象的属性：

```
$error_372 = Get-WinEvent -LogName 'Microsoft-Windows-PrintService/Admin'| ? {$_.Id -eq '372'}
$error_372[3].Properties[0,1,2,4] 
```

上面的输出返回以下内容：

```
Value                                                     
-----                                                     
Print Document                                            
Ahmet                                                     
Canon MP560 series Printer                                
131072 
```

我希望以如下格式返回所有对象：

```
Document Name        User Name        Printer Name        Document Size 
-------------        ---------        ------------        -------------
Print Document        Ahmet           Canon MP560...      131072
 yada yada            yada             yada                yada 
```

最终，我需要在 CSV 中使用它，但我想我会先尝试在屏幕上正确打印它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:31:56.387

您可以像这样构造所需的对象：

```
$error_372 | % { 
    $out =  new-object psobject;
    $out | add-member -Type noteproperty -Name "Document Name" -Value $_.Properties[0];
    $out | add-member -Type noteproperty -Name "User Name" -Value $_.Properties[1]
    $out | add-member -Type noteproperty -Name "Printer Name e" -Value $_.Properties[2]
    $out | add-member -Type noteproperty -Name "Document Size" -Value $_.Properties[4] -PassThru 
} 
```

请注意`-PassThru`最后`Add-Member`一行将构造的对象返回到管道的最后一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:10:49.090

试试这个：

```
$error_372 | % { 
    $out =  new-object psobject;
    $out | add-member -Type noteproperty -Name "Document Name" -Value ($_.Properties[0] | select -expa value)
    $out | add-member -Type noteproperty -Name "User Name" -Value ($_.Properties[1] | select -expa value)
    $out | add-member -Type noteproperty -Name "Printer Name e" -Value ($_.Properties[2]| select -expa value)
    $out | add-member -Type noteproperty -Name "Document Size" -Value ($_.Properties[4] | select -expa value) -PassThru 
} 
```

或更好：

```
$error_372 | % { 
    $out =  new-object psobject;
    $out | add-member -Type noteproperty -Name "Document Name" -Value ($_.Properties[0].value)
    $out | add-member -Type noteproperty -Name "User Name" -Value ($_.Properties[1].value)
    $out | add-member -Type noteproperty -Name "Printer Name e" -Value ($_.Properties[2].value)
    $out | add-member -Type noteproperty -Name "Document Size" -Value ($_.Properties[4].value) -PassThru 
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T07:12:53.483

您还可以使用 New-Object cmdlet（而不是多个 Add-Member 调用）：

```
Get-WinEvent -FilterHashtable @{LogName='Microsoft-Windows-PrintService/Admin'; Id=372} | Foreach-Object{

    New-Object PSObject -Property @{
        DocumentName = $_.Properties[0].Value
        UserName = $_.Properties[1].Value       
        PrinterName = $_.Properties[2].Value
        DocumentSize = $_.Properties[4].Value
    }

} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-15T19:21:07.757

您可以为每个事件创建具有所需属性（文档名、用户名...）的自定义 PSobject。使用来自事件对象的值填充属性。将它们收集在一个数组中并导出到 csv。[此处](http://technet.microsoft.com/en-us/magazine/hh750381.aspx)解释了自定义对象的创建

```
$array = @()

$error_372 | % { 
$out =  new-object psobject;
$out | add-member -NotePropertyName "Document Name" -NotePropertyValue ($_.Properties[0].value)
$out | add-member -NotePropertyName "User Name" -NotePropertyValue ($_.Properties[1].value)
$out | add-member -NotePropertyName "Printer Name" -NotePropertyValue ($_.Properties[2].value)
$out | add-member -NotePropertyName "Document Size" -NotePropertyValue ($_.Properties[4].value)
$array += $out
}

$array | export-csv -path events.csv 
```

编辑：`-Noteproperty...`参数似乎需要 PS3.0。

# c# - 从外部网站导航和下载文件

> ID：13895199
> 
> 赞同：-1
> 
> 时间：2012-12-15T19:00:04.540
> 
> 标签：c#, .net

我的项目中有一个请求，我需要登录到外部网站并需要从该网站下载文件。除了用于登录的用户名/密码外，我无权访问该网站。有没有办法使用 C# 来实现这个功能。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:06:33.450

这取决于网站类型和身份验证：

1) 使用 WebClient 类

```
WebClient wc = new WebClient();
wc.Credentials = new NetworkCredential(username, password);
wc.DownloadFile(url, "c:\\"); 
```

2）如果第一个不起作用，您可以使用webbrowser控件实现它

```
 HtmlElement ele = webBrowser1.Document.GetElementById("email");
 if (ele != null)
    ele.InnerText = "username";

 ele = webBrowser1.Document.GetElementById("pass");
 if (ele != null)
    ele.InnerText = "pass";

 ele = webBrowser1.Document.GetElementById("Login");
 if (ele != null)
    ele.InvokeMember("click"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:06:30.890

您可以将 WebBrowser 控件与 WATIN 库一起使用来浏览站点并单击下载按钮。

WebBrowser 控件有一个可以处理的“下载文件”事件

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T19:08:40.477

如果您可以手动完成，您可以使用 C# 或任何其他支持 HTTP 请求的语言以编程方式完成。所有你需要的是 ：

1.  弄清楚如何正确地向服务器进行身份验证。完成此操作后，您将获得一个身份验证令牌和与此令牌相关的会话。然后，您会将令牌附加到对服务器的所有后续请求。

2.  找出要发送哪个请求以获取该特定资源。我会假设它是对特定 URL 的 GET 请求。如果您手动执行，请使用[Fiddler检查发送了哪些请求。](http://www.fiddler2.com/fiddler2/version.asp)

# php - 重定向后获取最终 url

> ID：13895200
> 
> 赞同：0
> 
> 时间：2012-12-15T19:00:20.403
> 
> 标签：php, url

我在板上发现了类似的问题，但没有对我有用的答案...

我的问题很简单

当（在我的浏览器，chrome）我去这个网址：[https://w.soundcloud.com/player/?url=https%3a%2f%2fsoundcloud.com%2fdubz-cooker%2fdies-irae](https://w.soundcloud.com/player/?url=https%3a%2f%2fsoundcloud.com%2fdubz-cooker%2fdies-irae)

我被自动重定向到这个网址[https://w.soundcloud.com/player/?url=http://api.soundcloud.com/tracks/71231482](https://w.soundcloud.com/player/?url=http://api.soundcloud.com/tracks/71231482)

我有兴趣使用 php 获取最终 url 的 ID（最后一部分），只有第一个链接。

关于如何做到这一点的任何想法？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:26:34.820

如果您从第一个 URL 获取 url 参数并使用 http 而不是 https（由于某种原因它重定向到 http）即

```
 https://w.soundcloud.com/player/?url=https%3a%2f%2fsoundcloud.com%2fdubz-cooker%2fdies-irae

becomes http://soundcloud.com/dubz-cooker/dies-irae 
```

然后，您将不得不使用一些 PHP 函数来检索 URL（file_get_contents、cURL 扩展或使用 curl / wget 的 shell_exec）。IE

```
 <?php 
 $page = file_get_contents('http://soundcloud.com/dubz-cooker/dies-irae');
 preg_match('/"track_id"\:(\d+)/si', $page, $id);
 $id = $id[1]; 
```

您现在应该在 $id 中有轨道 ID

# sql - 连接表以查找 SUM

> ID：13895203
> 
> 赞同：1
> 
> 时间：2012-12-15T19:00:37.357
> 
> 标签：sql, join

我需要一些有关此 SQL 连接的帮助..

我有一张“销售”表，看起来像这样

```
date        idpart
1311316400   5
1321316400   6
1341216400   7
1351516400   8 
```

和一个看起来像这样的表格“零件”

```
idpart   name    inprice  outprice
 5        a        10       40
 6        b        20       55
 7        c        20       55 
 8        d        20       55 
```

现在我想通过执行以下操作来查找给定日期 A 和日期 B 的用户之间的所有 partsales 的总和：

```
SELECT idpart, SUM( inprice ) 
FROM parts, sales
WHERE parts.idpart = sales.idpart
GROUP BY idpart
LIMIT 0 , 30 
```

但是通过这样做，我得到了每次零件在销售表中的价格价值。我想要 A 和 B 之间整个期间的总数。我不知道应该在哪里插入：

```
WHERE date BETWEEN A AND B 
```

给 SQL 初学者的任何提示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:06:48.133

如果我的问题是正确的，那么您可以使用关键字组合您的条件`AND`：

```
SELECT SUM( inprice ) 
FROM parts, sales
WHERE parts.idpart = sales.idpart
AND sales.date BETWEEN A AND B
LIMIT 0 , 30 
```

为了更好的可读性，请始终使用“new” `JOIN`-syntax。一旦您的查询变得更加复杂，这将使您更容易理解您的查询：

```
SELECT SUM( parts.inprice ) 
FROM sales
JOIN parts ON ( parts.idpart = sales.idpart )
WHERE sales.date BETWEEN a AND b
LIMIT 0, 30 
```

# apache-flex - 在 flex 中实现可重用组件

> ID：13895204
> 
> 赞同：0
> 
> 时间：2012-12-15T19:00:43.663
> 
> 标签：apache-flex, actionscript

我正在尝试在 flex 3 中实现可重用组件。我有一个动态的选项卡导航器。在屏幕上，我有一个带有单击操作的按钮，一个带有 vbox 的选项卡导航器将被创建为子级，在 vbox 中我有一个接受输入的文本框来自用户的信息。

我在点击按钮旁边有一个显示按钮。当用户单击显示按钮并且打开四个选项卡时，我们需要将 VBox 的所有文本框放入文本区域。

这是我的代码。

```
 <?xml version="1.0" encoding="utf-8"?>
    <mx:Application xmlns:mx="http://www.adobe.com/2006/mxml">

    <mx:Script>
        <![CDATA[
            import Repeat;
    private var input:String;

    private var i:int=0;
            private function addNextTab(event:Event):void {
                tabs.addChild(new Repeat("Tab"));
            }
            private function show()
            {

                var child:DisplayObject;

            for(i=0;i<tabs.numChildren;i++)
            {

      child=tabs.getChildAt(i);
              input=TextInput(child.getChildAt(0)).text;//error
              textArea.text=textArea.text+input;
            }
            }
        ]]>
    </mx:Script>
    <mx:TabNavigator id="tabs" width="100%" height="100%">

    </mx:TabNavigator>

        <mx:TextArea id="textArea"/>
    <mx:Button label="Add Next Tab" click="addNextTab(event)" />
    <mx:Button label="Show Values" click="show()" />

    </mx:Application> 
```

一行显示错误。我是 flex 的初始学习者。但我试着学习并做我自己的。这是我的Repeat.as

```
package {
import mx.containers.VBox;
import mx.controls.Label;
import mx.controls.TextInput;

public class Repeat extends VBox {
    public function Repeat(name:String) {
        label = name;

    }

    override protected function createChildren():void {
        super.createChildren();

        var box:VBox = new VBox();
        var t1:TextInput = new TextInput();

        box.addChild(t1);

        addChild(box);
    }
}
} 
```

我必须访问所有选项卡的文本框信息并将其放在 textArea 中。

有谁能够帮助我。？

顺便说一句：这是 flex 3 应用程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:38:52.273

您应该使文本成为公共属性，并且不要创建嵌套的 VBox 来添加它。您已经在扩展 VBox，所以只需 addChild.. 像这样：

```
package {
    import mx.containers.VBox;
    import mx.controls.Label;
    import mx.controls.TextInput;

    public class Repeat extends VBox {

        public var text:TextInput;

        public function Repeat(name:String) {
            label = name;
        }

        override protected function createChildren():void {
            super.createChildren();
            text = new TextInput();
            addChild(text);
        }
    }
} 
```

编辑：显示以访问它。

```
child = tabs.getChildAt(i) as Repeat;
child.text.text = someNewValue; 
```

# assembly - 接收器控制寄存器的中断级别是多少

> ID：13895205
> 
> 赞同：0
> 
> 时间：2012-12-15T19:01:04.010
> 
> 标签：assembly, mips, interrupt-handling

我正在尝试创建一个处理键盘输入的硬件中断处理程序。问题是我的处理程序只有在接收器控制寄存器的值为 1 时才应该继续。目前，我的代码产生的值为 3，所以我的处理程序只是退出，因为我只想处理硬件中断。我在网上找不到任何描述什么是 3 级中断以及如何修复我的代码以提供 1 级中断的地方。

有人可以告诉我第 3 级是什么，或者至少给我指出一个资源吗？谢谢

添加到此。我也得到 256 作为我的原因寄存器的值。我认为所有代码都是十六进制的，因此那将是代码 4。我可以看到这是来自非法地址的负载。这没有任何意义，因为直到我按下键盘上的一个键才调用中断处理程序。继承人的代码：

```
.data 0xffff0000 
RecvCtrlReg: .word 0

.ktext  0x80000180

    #move   $k1, $at

    #la $k0, frogger    # save the address to frogger function for long call

    mfc0    $k1, $13
    beq $k1, 0, keyboard    # If cause register is not zero, exit

    li  $v0, 10     # Do nothing and exit
    syscall

    keyboard:           # else check interupt level

    lw  $t7, RecvCtrlReg    
    beq $t7, 1, continue    # if the Reciever Control Reg is 1, its a hardware interrupt, so continue

    li  $v0, 10     # else do nothing and exit
    syscall
    continue:

    jalr    $k0     # long call frogger function

    mtc0    $0, $13     # set cause register to 0

    mfc0    $k0, $12        # Fix status register
    andi    $k0, 0xfffd # clear EXL bit
    ori $k0, 0x1        # Enable interrupts
    mtc0    $k0, $12        # Store value back into status register

    #move   $at, $k1

    eret 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T22:36:32.817

它不仅仅是`Cause`寄存器中断位字段的单独足够并接受请求。通常原因寄存器的中断字段`Status`也与寄存器的中断字段按位与。结果位被或在一起，值与`Status`寄存器的 IE（中断主使能）位相与将导致中断。

# ios - iOS 网站交互（NSURLConnection）设计/模式

> ID：13895208
> 
> 赞同：2
> 
> 时间：2012-12-15T19:01:19.020
> 
> 标签：ios, web-services, web, nsurlconnection

这是一个关于如何设计与网站交互的应用程序的问题。

我有一个应用程序查询网站信息，使用异步完成`NSURLConnection`（我认为这是 iOS 中的首选方法）。有问题的网站没有 api/web-service 接口。交互就像浏览器一样完成，发送请求，接收答案，解释答案以确定下一步行动。

该站点还使用用户名和密码进行保护，并且确实如此。因此，当我想与网站交互时（比如说，用例，例如：“获取照片列表”、“下载照片”、“上传照片”），我需要先登录，完成后我要退出.

我想这样写我的函数（但我很愿意接受建议，也许我看错了）

```
login
if login successful
  get list of photos
logout 
```

然后当用户要求它之后，我想

```
login
if login successful
  download photo
logout 
```

我遇到的问题是，每次你触发 an`NSURLConnection`时，都会收到回复`-connectionDidFinishLoading`。所以我需要保持某种状态才能知道下一步该做什么，是获取照片列表的登录名还是下载照片的登录名。

现在，问题不是我不能让它工作，问题是如何干净有效地设置这样的东西，以便它可以扩展，以便它可以支持 20 多个甚至 50 多个用例并且仍然易于维护。强调并非所有用例都像上面说明的那样简单。

我试图实现的一个例子是 facebook 应用程序。该应用程序还需要登录 facebook 以支持各种用例，例如发布项目、下载帖子、发布帖子、上传照片等。他们是如何设计出这样的东西的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:32:20.653

如果问题是如何登录到您的服务器，则实施细节将根据您的服务器如何验证“登录”而有所不同。一种模型是简单的 HTTP POST。另一种模型是*URL 加载系统编程指南*中讨论的[身份验证挑战。](http://developer.apple.com/library/ios/documentation/Cocoa/Conceptual/URLLoadingSystem/Articles/AuthenticationChallenges.html#//apple_ref/doc/uid/TP40009507-SW1)

 *如果您不知道您的 Web 服务器采用了哪种样式，您通常可以通过您的 Web 浏览器尝试使用 URL 访问其中一个受保护的文件来弄清楚。如果您看到这样的屏幕，您的服务器正在使用身份验证挑战：

![身份验证质询](../Images/960d02bdb389c409f57f58ed9acd3cf0.png)

如果您没有看到 Web 浏览器生成的弹出窗口，而是看到类似 HTML 的“请登录”消息，那么您可能必须执行 POST 登录过程。请注意，如果您的服务器正在使用这种过程，如果登录成功或失败是通过 HTML 页面报告的，那么让您的应用程序解密有点麻烦。如果您有一个提供 JSON 或 XML 响应而不是 HTML 响应的登录页面版本，这将是理想的。我不知道您是否有能力在您的服务器上执行此操作，但如果您可以这样做，它将极大地简化您的 iOS 开发。

如果您正在登录并执行 POST，请参阅[SimpleURLConnections 示例应用程序](http://developer.apple.com/library/ios/samplecode/SimpleURLConnections/Introduction/Intro.html#//apple_ref/doc/uid/DTS40009245)，了解如何对您的 Web 服务器发出简单的 POST（和 GET）请求。

有关如何处理身份验证质询的示例，请参阅[AdvancedURLConnections 示例应用程序。](http://developer.apple.com/library/ios/samplecode/AdvancedURLConnections/Introduction/Intro.html#//apple_ref/doc/uid/DTS40009558)*

# android - JSoup 不适用于 AsyncTask

> ID：13895211
> 
> 赞同：2
> 
> 时间：2012-12-15T19:01:40.403
> 
> 标签：android, android-asynctask, jsoup

我注意到我的应用程序有一件有趣的事情（我在 AsyncTask 中使用 Jsoup）

之后我的应用程序崩溃了。LogCat 是：

```
 12-15 11:16:43.023: I/dalvikvm(371): Could not find method org.jsoup.Jsoup.connect, referenced from method com.example.myexample.MainActivity$MyTask.doInBackground
12-15 11:16:43.033: W/dalvikvm(371): VFY: unable to resolve static method 3462: Lorg/jsoup/Jsoup;.connect (Ljava/lang/String;)Lorg/jsoup/Connection;
12-15 11:16:43.033: D/dalvikvm(371): VFY: replacing opcode 0x71 at 0x0003
12-15 11:16:43.033: D/dalvikvm(371): VFY: dead code 0x0006-000d in Lcom/example/myexample/MainActivity$MyTask;.doInBackground ([Ljava/lang/String;)Ljava/lang/String;
12-15 11:16:43.113: W/dalvikvm(371): threadid=9: thread exiting with uncaught exception (group=0x40015560)
12-15 11:16:43.133: E/AndroidRuntime(371): FATAL EXCEPTION: AsyncTask #1
12-15 11:16:43.133: E/AndroidRuntime(371): java.lang.RuntimeException: An error occured while executing doInBackground()
12-15 11:16:43.133: E/AndroidRuntime(371):  at android.os.AsyncTask$3.done(AsyncTask.java:200)
12-15 11:16:43.133: E/AndroidRuntime(371):  at java.util.concurrent.FutureTask$Sync.innerSetException(FutureTask.java:274)
12-15 11:16:43.133: E/AndroidRuntime(371):  at java.util.concurrent.FutureTask.setException(FutureTask.java:125)
12-15 11:16:43.133: E/AndroidRuntime(371):  at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:308)
12-15 11:16:43.133: E/AndroidRuntime(371):  at java.util.concurrent.FutureTask.run(FutureTask.java:138)
12-15 11:16:43.133: E/AndroidRuntime(371):  at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1088)
12-15 11:16:43.133: E/AndroidRuntime(371):  at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:581)
12-15 11:16:43.133: E/AndroidRuntime(371):  at java.lang.Thread.run(Thread.java:1019) 
```

与异步有关的致命异常！但我不明白为什么我的应用程序：

```
public class MainActivity extends Activity {
MyTask mt;
  TextView tvInfo;
  String URL="http://en.wikipedia.org/";
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    tvInfo = (TextView) findViewById(R.id.tvInfo);
  }

  public void onclick(View v) {
    mt = new MyTask();
    mt.execute(URL);
  }

  class MyTask extends AsyncTask<String, Void, String> {
      Document doc;
      String title=null;
      String what1=null;
    @Override
    protected void onPreExecute() {
      super.onPreExecute();
      tvInfo.setText("Please wait...");
    }

    protected String doInBackground(String... params) {
      // TimeUnit.SECONDS.sleep(2);
       String url=params[0];
       Document doc;

    try {
        doc = Jsoup.connect(url).get();
        String what1=doc.title();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

      return what1;
    }

    protected void onPostExecute(String result) {
      super.onPostExecute(result);
      tvInfo.setText(result);
    }
  }
} 
```

如果我更改我的代码（没有 JSoup）异步效果很好：

```
public class MainActivity extends Activity {
MyTask mt;
  TextView tvInfo;
  String URL="http://en.wikipedia.org/";
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    tvInfo = (TextView) findViewById(R.id.tvInfo);
  }

  public void onclick(View v) {
    mt = new MyTask();
    mt.execute(URL);
  }

  class MyTask extends AsyncTask<String, Void, String> {
      Document doc;
      String title=null;
    @Override
    protected void onPreExecute() {
      super.onPreExecute();
      tvInfo.setText("Please wait");
    }

    protected String doInBackground(String... params) {
      // TimeUnit.SECONDS.sleep(2);
       String url=params[0];
       //doc = Jsoup.connect(url).get();
       //String title = doc.title();
      // Log.d("AsyncTask doInBackground","URL: " + params[0]);
      return url;
    }

    protected void onPostExecute(String result) {
      super.onPostExecute(result);
      tvInfo.setText(result);
    }
  }
} 
```

在 TextView 中，我得到了一个 Wiki 的 URL。拜托，任何人都可以帮助我解决这个问题。谢谢！

PS 我在 Manifest 文件中添加 Internet 权限 PPS 我使用 JSoup 版本 1.7.1（作为外部 jar 文件添加）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T19:18:16.983

> 我这样做是右键单击项目->构建路径->添加外部档案

如果您还没有目录，请撤消该操作，然后`libs/`在您的项目中创建一个目录（作为`src/`、等的对等）。`res/`然后，将 JSoup JAR 放入`libs/`目录中。这会将其添加到您的构建路径中*并将*其内容包含在您的 APK 文件中。

# mysql - sqlall 不工作不返回任何内容

> ID：13895213
> 
> 赞同：1
> 
> 时间：2012-12-15T19:02:02.990
> 
> 标签：mysql, django, django-models

您好，我正在运行 python manage.py sqlall groups（也尝试过 sql），当我运行此命令时，它只是返回到命令提示符：

```
david@mint-desktop ~/workspace/newapp $ python manage.py sqlall groups 

david@mint-desktop ~/workspace/newapp $ 
```

我已经成功运行了命令syncdb、validate、inspectdb，并且这个命令似乎没有出错，但没有返回任何DDL。我的印象是这个命令为我的 mysql 模型创建了 DLL。我错过了一步吗？我尝试在 mysql 中构建模型，并在手动构建表后能够访问它们。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:11:04.497

似乎 Django 的管理员有时会在遇到错误时丢弃模型，而不是报告它。

根据我的经验，使用“南”扩展来管理我的模型有助于解决这个问题。（总的来说，如果您需要更改模型，这也是一个好主意……）

# r - 计算差异并在单独的列中汇总

> ID：13895216
> 
> 赞同：2
> 
> 时间：2012-12-15T19:02:31.703
> 
> 标签：r

我有很多变量有很多观察。我有一个标准变量。现在，我只想在观察值大于标准时计算标准变量和观察变量之间的差异，并将所有差异总结为单独的变量。此外，大于标准的变量的名称在单独的列中。

```
Names   Standard    Das Dss Tri Tet
Aa  32  42  21  45  34
Ab  23  25  43  43  32
Ac  43  34  23  32  23
Ad  23  24  33  12  23
Ae  14  24  12  20  24
Af  43  42  13  12  43
Ag  12  13  22  13  22
Ah  32  32  42  42  23 
```

输出：

```
Names   Standard    Das Dss Tri Tet Difference  No_Difference   Names_Difference
Aa  32  42  21  45  34  15  3   Das, Tri, Tet
Ab  23  25  43  43  32  52  4   Das,Dss,Tri,Tet
Ac  43  34  23  32  23  0   0   NA
Ad  23  24  33  12  23  10  2   Das,Dss
Ae  14  24  12  20  24  26  4   Das,Tri,Tet
Af  43  42  13  12  43  0   0   NA
Ag  12  13  22  13  22  22  4   Das,Dss,Tri,Tet
Ah  32  32  42  42  23  20  2   Dss,Tri 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:00:39.190

假设您上面的数据存储在 object 中`df`。那么这应该工作

```
df2 <- do.call(rbind, apply(df[, -1], 1, function(z) {
        ind <- z[2:5] > z[1]
        return(cbind.data.frame(
                        Difference = sum(z[2:5][ind] - z[1]), 
                        No_Difference = sum(ind), 
                        Names_Difference = paste(colnames(df[3:6])[ind], 
                                collapse = ", ")
                ))
    }))

df <- cbind(df, df2)
df

  Names Standard Das Dss Tri Tet Difference No_Difference   Names_Difference
1    Aa       32  42  21  45  34         25             3      Das, Tri, Tet
2    Ab       23  25  43  43  32         51             4 Das, Dss, Tri, Tet
3    Ac       43  34  23  32  23          0             0                   
4    Ad       23  24  33  12  23         11             2           Das, Dss
5    Ae       14  24  12  20  24         26             3      Das, Tri, Tet
6    Af       43  42  13  12  43          0             0                   
7    Ag       12  13  22  13  22         22             4 Das, Dss, Tri, Tet
8    Ah       32  32  42  42  23         20             2           Dss, Tri 
```

尽管这不是很优雅，并且使用整数来索引列也不是很健壮，以防变量的顺序在某些时候发生变化

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T22:20:10.743

要仅添加标准 val 小于 obs 的值，这是一种简单的方法。我的示例是针对单行的，因此我将使用向量。

```
> foo<- sample(10,10,replace=TRUE)
> foo
 [1]  7  5 10  8  8  7  4  1  8  2
> sum((foo[-1]-foo[1])*(foo[-1]>foo[1]))
 [1] 6 
```

其他人可以进行名称收集:-)

# java - maven 2.2 war build 不会将类放在关联的 *-classes.jar 文件中

> ID：13895220
> 
> 赞同：2
> 
> 时间：2012-12-15T19:03:06.103
> 
> 标签：java, maven, build, maven-2

我正在尝试构建一个（战争）项目，在该项目中我从另一段代码中复制并修改了 pom.xml 文件，并且由于某种原因，当我`mvn clean package`使用该软件时，它没有将类包含到关联的 *-classes.jar 中文件。Maven 版本在 Ubuntu 12.10 上为 2.2.1。

我是 maven 的新手，主要通过示例中的复制和粘贴来管理，所以我基本上不知道我的 pom 是如何工作的（它包含在下面的全部内容中）。

该项目有一个`<packaging>war</packaging>`元素，并且`maven-war-plugin`配置部分说`archiveClasses`and `attachClasses`，我认为这是导致构建 *-classes.jar 文件的原因。运行构建后，我的目标目录如下所示：

```
richard@holly:~/Code/External/JavaServer2.0/target$ ls 
apidocs  generated-sources  surefire           sword2-server-1.0-classes.jar  sword2-server-1.0-sources.jar
classes  maven-archiver     sword2-server-1.0  sword2-server-1.0-javadoc.jar  sword2-server-1.0.war 
```

但是 Sword2-server-1.0-classes.jar 不包含任何类：

```
richard@holly:~/Code/External/JavaServer2.0/target$ jar tf sword2-server-1.0-classes.jar
META-INF/
META-INF/MANIFEST.MF
META-INF/maven/
META-INF/maven/org.swordapp/
META-INF/maven/org.swordapp/sword2-server/
META-INF/maven/org.swordapp/sword2-server/pom.xml
META-INF/maven/org.swordapp/sword2-server/pom.properties 
```

同时该目录下的所有其他 *.jar 文件都包含了源文件的所有相关信息（javadocs、source 等，都是完整的）。

毫无疑问，我错过了某种形式的插件配置，但到目前为止我无法理解 maven 插件文档，因此非常感谢任何帮助。

（几乎）完整的 pom.xml（为了简洁省略了实际的依赖项）：

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">

<modelVersion>4.0.0</modelVersion>
<groupId>org.swordapp</groupId>
<artifactId>sword2-server</artifactId>
<version>1.0</version>
<packaging>war</packaging>

<name>SWORD v2 :: Common Server Library</name>
<description>
    Common Server Library with interfaces to be implemented by servers
    wishing to provide SWORD v2 support
</description>
<url>http://www.swordapp.org/</url>

<build>
    <plugins>
        <plugin>
            <artifactId>maven-release-plugin</artifactId>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <source>6</source>
                <target>6</target>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <configuration>
                <archive>
                    <manifest>
                        <addDefaultImplementationEntries>
                            true
                        </addDefaultImplementationEntries>
                        <addDefaultSpecificationEntries>
                            true
                        </addDefaultSpecificationEntries>
                    </manifest>
                </archive>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-source-plugin</artifactId>
            <executions>
                <execution>
                    <id>default</id>
                    <phase>package</phase>
                    <goals>
                        <goal>jar</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-javadoc-plugin</artifactId>
            <executions>
                <execution>
                    <id>default</id>
                    <phase>package</phase>
                    <goals>
                        <goal>jar</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>

        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <configuration>
                <archiveClasses>true</archiveClasses>
                <attachClasses>true</attachClasses>
                <packagingExcludes>WEB-INF/lib/*.jar</packagingExcludes>
                <warSourceExcludes>WEB-INF/lib/*.jar</warSourceExcludes>
                <webResources>
                    <resource>
                        <filtering>true</filtering>
                        <directory>${basedir}/src/main/webapp</directory>
                        <includes>
                            <include>WEB-INF/web.xml</include>
                        </includes>
                    </resource>
                </webResources>
            </configuration>
            <executions>
                <execution>
                    <phase>prepare-package</phase>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>

<dependencies>
    ....
</dependencies>
</project> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T16:53:10.810

It turns out that `archiveClasses` and `attachClasses` don't play well together. The documentation for `attachClasses` says that it will put the files in the webapps `classes` directory into a *-classes.jar during the war build. But `archiveClasses` places the content of the `classes` directory in the webapp into a jar file in the webapp's `lib` directory. Since this means that there are no classes in the `classes` directory to be put into the *-classes.jar if both these configuration flags are set to true.

The answer is to remove `archiveClasses` from the configuration, and then everything behaves as expected.

This seems like it's probably a maven bug, and it behaves the same in both maven 2 and maven 3.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-15T19:15:45.757

您应该尝试通过降低复杂性来归结问题，只需先尝试如下简单配置：

```
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-war-plugin</artifactId>
    <configuration>
        <archiveClasses>true</archiveClasses>
        <attachClasses>true</attachClasses>
    </configuration>
</plugin> 
```

之后，只需尝试：

```
mvn clean package 
```

# c# - 使用 C# 类生成 (my)sql(ite) 创建表？

> ID：13895221
> 
> 赞同：1
> 
> 时间：2012-12-15T19:03:08.343
> 
> 标签：c#, mysql, sqlite

我想标记一个类似于下面的 C# 类。是否有任何工具或库使用反射来创建 mysql 或 sqlite create table 语句？

```
class MyTable {
    public int id;
    [FK("User")] //assumes table user, field id. FK("User.id") is just as fine
    public int user;
    [Index]
    public int flags;
    [unique]
    public string email;
    [unique, nullable]
    public string something_else;
} 
```

# sql - 如何在 PostgreSQL 中以正确的顺序返回记录

> ID：13895225
> 
> 赞同：2
> 
> 时间：2012-12-15T19:03:37.743
> 
> 标签：sql, postgresql, sql-order-by, locale, collation

询问

```
select 'T' union all select 'Z'  order by 1 
```

返回

```
Z
T 
```

但正确的顺序应该是

```
T
Z 
```

在 3 种不同的操作系统中尝试过

*   Windows 2003 服务器“PostgreSQL 9.1.3，由 Visual C++ build 1500 编译，32 位”
*   Windows 7 “PostgreSQL 9.2.1，由 Visual C++ build 1600 编译，32 位”
*   Debian“x86_64-unknown-linux-gnu 上的 PostgreSQL 9.1.2，由 gcc-4.4.real (Debian 4.4.5-8) 4.4.5 编译，64 位”

数据库设置为：

```
Collation:      et_EE.UTF-8 
Character type: et_EE.UTF-8 
```

如何解决这个问题？

**更新**

数据库是使用创建的

```
CREATE DATABASE mydb WITH TEMPLATE=template0 OWNER=mydb_owner ENCODING='UNICODE' 
```

操作系统语言环境在所有情况下都是爱沙尼亚语，因此数据库是在爱沙尼亚语语言环境中创建的。

```
select 'Z' collate "et_EE" union all select 'S' collate "et_EE" order by 1 
```

返回正确的顺序：

```
S
Z 
```

但

```
select 'Z' collate "et_EE" union all select 'T' collate "et_EE" order by 1 
```

如答案中所述，返回无效订单：

```
Z
T 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:05:54.220

原始 SQL 没有任何问题。

它似乎没有按您期望的方式工作的原因是因为您使用爱沙尼亚语语言环境，但[爱沙尼亚语排序规则](http://developer.mimer.com/charts/estonian.htm)要求“Z”在“T”之前。

您可以使用不同的排序规则或在 en_US.UTF-8 语言环境中创建数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T23:33:56.197

**查询没有任何**问题。

一个`UNION [ALL]`（或`INTERSECT`或`EXCEPT`）查询被认为是*一个*查询。`ORDER BY`适用于所有腿的联合，而不仅仅是最后一条。您必须使用括号来使`ORDER BY`查询的一个分支成为局部变量。[在这里](http://www.postgresql.org/docs/current/interactive/sql-select.html#SQL-UNION)引用手册：

> **`select_statement`** `UNION [ ALL | DISTINCT ]` **`select_statement`**
> 
> **`select_statement`**是任何`SELECT`没有`ORDER BY`, `LIMIT`, `FOR UPDATE`, or`FOR SHARE`子句的语句。（`ORDER BY`并且`LIMIT`可以附加到一个子表达式，如果它被括在括号中。没有括号，这些子句将被应用到 的结果，而 `UNION`不是它的右手输入表达式。）

这只是工作（`a`排序之前`b`）：

```
SELECT 'b'
UNION ALL
SELECT 'a'
ORDER BY 1 
```

与问题中的原始查询一样：

```
SELECT 'T' 
UNION ALL
SELECT 'Z'
ORDER BY 1 
```

要检查您的排序规则：

```
SHOW lc_collate; 
```

`et_EE.UTF-8`是爱沙尼亚语语言环境，`Z`在[爱沙尼亚语字母表](http://en.wikipedia.org/wiki/Estonian_alphabet)`T`中排在前面。就这样。

**整理没有任何**问题。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-15T19:33:39.813

问题是排序规则：

```
select 'T' collate "et_EE.utf8" a union all select 'Z' collate "et_EE.utf8" order by 1;
 a 
---
 Z
 T 
```

使用`en_US`排序规则时，它可以工作：

```
select 'T' collate "en_US.utf8" a union all select 'Z' collate "en_US.utf8" order by 1;
 a 
---
 T
 Z 
```

# php - APC 缓存不断消失

> ID：13895226
> 
> 赞同：2
> 
> 时间：2012-12-15T19:03:48.967
> 
> 标签：php, apc

缓存似乎每 10 分钟或更长时间随机重置一次。我想我用错了。我正在使用 APC 缓存 3 兆字节的 HTML 响应。在任何给定时间大约有 50 个。据我了解，使用 mmap_file_mask 将使用文件而不是内存，因此它不会占用我的内存，但我仍然认为它会耗尽内存并自行重置。

它是一个具有 1 GB 内存的 VPS，通常在运行`free`时显示使用了 512MB 到 750 MB（这是我当前的 256 MB SHM 大小）。我应该将我的 SHM 大小从 256 增加到更高的值吗？

我应该使用 APC 来执行此操作，还是将响应存储在文件中并直接使用它更好？

我的 APC INI 如下：

```
extension = apc.so

apc.enabled = 1
apc.shm_segments = 1
apc.shm_size = 256
apc.optimization = 0
apc.num_files_hint = 10000
apc.ttl = 0
apc.user_ttl = 0
apc.gc_ttl = 0
apc.cache_by_default = 1
apc.filters = ""
apc.mmap_file_mask = "/tmp/apc.XXXXXX"
apc.slam_defense = 0
apc.file_update_protection = 2
apc.enable_cli = 0
apc.max_file_size = 10M
apc.stat = 1
apc.write_lock = 1
apc.report_autofilter = 0
apc.include_once_override = 0
apc.localcache = 0
apc.localcache.size = 512
apc.coredump_unmap = 0
apc.stat_ctime = 0 
```

编辑：我将内存更新为 512 MB，持续了几个小时，然后我就去睡觉了。当我醒来时，所有的缓存都不见了。好像是内存问题？我可能只依赖文件或 MySQL，调试 APC 不值得在页面加载上节省几毫秒的时间。

这是询问的信息：

```
[num_slots] => 8192
[ttl] => 0
[num_hits] => 490
[num_misses] => 390
[num_inserts] => 13663
[expunges] => 0
[start_time] => 1355644615
[mem_size] => 5271328
[num_entries] => 204
[file_upload_progress] => 1
[memory_type] => mmap
[locking_type] => pthread mutex
[cache_list] => Array 
```

然后它只显示缓存数组，对于调试我认为的任何问题没有什么真正有用的。没有什么突出预缓存清除。前后随机缓存清除器没有太大变化。不知道这个问题，512 MB 的内存应该足以容纳 3 MB x 50 个条目。即使那样，我什至不希望它使用内存。我希望它使用文件。

编辑2：

根据要求，这是我使用的 APC 代码：

```
<?php
$unique_options = "query_options_that_are_unique_to_1_of_the_50_caches";

$refresh_interval = 60*15;
$refresh_triggered = (isset($_REQUEST['refresh']));

// Try to get the APC Cache, if fails, then it was never created
if ($cache_array = apc_fetch(md5($unique_options))) {
    // I got the cache, using its creation_time, see if its refreshable
    $seconds_since_last_refresh = (time() - $cache_array['creation_time']);
    $can_refresh = ($seconds_since_last_refresh >= $refresh_interval);
} else {
    // Apparently this has never had a cache created, so create it
    apc_store(md5($unique_options), array('data'=> get_json($unique_options), 'creation_time'=>time()), 0);
    $cache_array = apc_fetch(md5($unique_options));
    $refresh_triggered = false;
}

// If the cache already existed, and the user is attempting to refresh the cache, and they are allowed to refresh it, then refresh it.
if($refresh_triggered) {
    if($can_refresh) {
        apc_store(md5($unique_options), array('data'=> get_json($unique_options), 'creation_time'=>time()), 0);
        $cache_array = apc_fetch(md5($unique_options));
    } else {
        echo "You can only refresh every 15 minutes<br><br>";
    }
}

$current_url = (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] && !in_array(strtolower($_SERVER['HTTPS']),array('off','no'))) ? 'https' : 'http' . '://'.$_SERVER['HTTP_HOST'] . $_SERVER['REQUEST_URI'];
$url_parts = parse_url($current_url);
$url_without_query = $url_parts['scheme'] . '://' . $url_parts['host'] . $url_parts['path'];

foreach($_GET as $key => $value) {
    if($key != "refresh")
        $query .= "$key=$value&";
}
echo "Data was last refreshed " . ($seconds_since_last_refresh) . "seconds  ago  (<a href='$url_without_query?{$query}refresh'>Refresh Now</a>)<br><br>";

$data = $cache_array['data'];

// Now process the the information that was cached
// ...
?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-02T09:22:56.203

我遇到了完全相同的问题，这让我发疯了！

造成这种情况的实际原因是**服务器时间与脚本设置时间不同。**

在命令行上使用以下命令检查服务器上的日期：

```
date 
```

然后使用以下命令检查您的 PHP 时间：

```
<?php echo date("Y-m-d H:i:s"); ?> 
```

如果存在差异（这就是我所拥有的），那么这就是缓存被清除的原因。

检查我的 apc.php 文件，我现在有超过 40 分钟的条目，然后它们会在 10 分钟后被清除。呜呼！

如果您的日期/时间不同，那么您可以使用 date 命令设置服务器时间（[参见此处](http://www.computerhope.com/unix/udate.htm)）或设置 PHP 时区以匹配服务器使用：

```
date_default_timezone_set('UTC'); 
```

您可以在此处找到此功能支持的时区列表：[http ://www.php.net/manual/en/timezones.php](http://www.php.net/manual/en/timezones.php)

我希望这对您有所帮助，我花了很长时间将我的脚本转换为使用 APC，它的速度很快，现在它们被存储和保存了我指定的时间长度。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T14:22:15.787

永远不要使用 0 的 ttl。APC 将在内存不足时刷新所有缓存。

使用 apc.php 脚本查看内存的使用情况。您应该保留 20% 的可用内存（运行数小时后）。

如果您没有足够的内存，只需微调 APC 以仅缓存最频繁访问的文件。

在这里检查我的答案（不是 46 票赞成的那个是错误的） [是什么导致 PHP 中“无法为池分配内存”？](https://stackoverflow.com/questions/3723316/warning-require-once-function-require-once-unable-to-allocate-memory-for-p)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-10T14:27:43.797

我今天遇到了同样的问题，在这里找到了解决方案： [http ://www.itofy.com/linux/cpanel/apc-cache-reset-every-2-hours/](http://www.itofy.com/linux/cpanel/apc-cache-reset-every-2-hours/)

你需要去`AccesWHM > Apache Configuration > Piped Log Configuration`和`Enable Piped Apache Logs`。

# java - 使用远程源自动完成

> ID：13895227
> 
> 赞同：1
> 
> 时间：2012-12-15T19:03:57.290
> 
> 标签：java, service, web, autocomplete

我有一个应用程序需要对其项目进行自动完成。我身边没有这些物品，但是我调用了 Web 服务来获取这些物品。我应该以某种方式将这些项目存储在我身边（大约有 1000 亿个项目），还是只是为每个客户在文本框中输入的信件调用网络服务？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:20:36.917

用这些知识很难有一个好的答案，但理想情况下：

*   在 Web 服务中实现它的 API：getSuggestions
*   每次按键调用 Web 服务
    *   如果该方法在服务器上产生过多负载，则仅在文本字段更改后 X 毫秒才调用它，前提是同时没有其他更改。（例如 X = 300 毫秒）
        *   这样您就可以在键入时避免自动完成。
*   无论它是否基于服务器/客户端，您都需要一些索引（使用一些复杂的[数据结构](https://stackoverflow.com/questions/10017808/best-data-structure-for-dictionary-implementation)）才能获得不错的性能。您可以使用`lucene`几乎“免费”获得它。

# asp.net - 具有潜在危险的输入 ASP.NET

> ID：13895228
> 
> 赞同：2
> 
> 时间：2012-12-15T19:03:59.933
> 
> 标签：asp.net

.NET 4.0
与 2012
IIS 7

我有一个应用程序可以接收各个页面上的电子邮件地址，我发现用户正在直接复制/粘贴到一些输入中，并且它触发了标题中提到的错误，这是一个示例。

```
"blah blah" <blah@blah.com> 
```

显然，括号引发了问题。我意识到我可以简单地将验证切换到 2.0，但我不想这样做，所以这是我的问题。

*   有没有办法让运行时做出更好的反应？当遇到这种情况时，它不会抛出一个超级可怕的页面，而是将其视为输入错误并向用户显示一条消息（在一般情况下）例如，在我所说的场景中，我可以显示一条错误消息关于电子邮件地址中不允许使用 < 和 >。我喜欢这种保护，但我不喜欢每次有人输入有潜在危险的输入时都会显示“oops”页面的想法。

*   如果我要放松验证：

    *   我可以在每页的基础上做吗？我不相信，但我要求完整性
    *   ASP.NET 为我提供了哪些工具来手动保护自己免受此类问题的影响？我真的不想参与编写东西的游戏来查看输入中是否存在潜在危险的东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:13:59.857

您可以通过将 ValidateRequest="false" 放在页面标题中来放松对每页的验证。

然后，您可以使用正则表达式来验证电子邮件地址，如下所示：

```
<asp:RegularExpressionValidator ID="RegularExpressionValidator1" runat="server"
ControlToValidate="Email" ErrorMessage="Enter a valid e-mail address" 
ValidationExpression="\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*" /> 
```

对于其他控件，您可以使用正则表达式“^[^<>]+$”来检查尖括号。实际上，您无需担心“潜在危险”的用户输入，除非您将其输出到客户端（HTML / JavaScript），或者您将其包含在 SQL 语句中。

或者，您可以尝试在您的页面中编写页面级错误处理程序或在 Global.asax 中编写应用程序级错误处理程序。

页面级错误处理： http: [//msdn.microsoft.com/en-us/library/ed577840 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ed577840%28v=vs.100%29.aspx)

应用程序级错误处理： http: [//msdn.microsoft.com/en-us/library/24395wz3 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/24395wz3%28v=vs.100%29.aspx)

此页面提供了一些有关在 ASP.NET 中禁用请求验证的有用信息：http: [//msdn.microsoft.com/en-us/library/hh882339 (v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/hh882339%28v=vs.100%29.aspx)

# typescript - 来自 Typescript 错误的 Javascript =>Uncaught TypeError: undefined is not a function

> ID：13895231
> 
> 赞同：0
> 
> 时间：2012-12-15T19:04:09.490
> 
> 标签：typescript

我在 game.js 文件的顶部（来自 game.ts 编译）得到了这个定义语句：

```
define(["require", "exports", "GameObjects"], function(require, exports, __GameObjects__) {
var GameObjects = __GameObjects__;

$(document).ready(function () {
    var game = new Game();
    $(document).keydown(game.onKeyDown);
    $(document).keyup(game.onKeyUp);
    $(document).keyup(game.onKeyUp);
});
function collides(a, b) { 
```

和这个错误： Uncaught TypeError: undefined is not a function

从这个页面：

```
 <head>
    <title>Space Demo</title>
    <link href="/stylesheets/screen.css" media="all" rel="stylesheet" type="text/css" />

    <script language="javascript" src="javascripts/require.js" type="text/javascript" data-main="ts/game.js"> </script>
    <script language="javascript" src="javascripts/jquery-1.8.2.min.js" type="text/javascript"> </script>

</head> 
```

有任何想法吗？

编辑***_ _* __ *_* __ *_* __ *_* __ *_* __ *_***

游戏类在game.js文件中

类游戏{

```
//  canvas: JQuery;

CANVAS_WIDTH: number = 400;
CANVAS_HEIGHT: number = 400;

FPS: number = 30;

enemies = [];
playerBullets: Array = new Array[40];
player: GameObjects.GameObjects.Player;

canvas: HTMLCanvasElement = <HTMLCanvasElement> document.getElementById('canvas');

context2D: CanvasRenderingContext2D;

constructor () {
    // this.canvas = canvas;

    this.context2D = this.canvas.getContext("2d");
    this.canvas.width = this.CANVAS_WIDTH;
    this.canvas.height = this.CANVAS_HEIGHT;

    this.initGame();
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T03:00:16.977

您正在尝试调用某些未定义/初始化的函数。

*   `Game`可以从那里访问您正在构建的类吗？
*   元素是否带有`ID="canvas"`-element `<canvas>`？
*   `Game`类有`initGame`方法吗？

如果您使用 Google Chrome 打开页面，并查看开发人员控制台，您应该会看到堆栈跟踪。这应该告诉您错误来自哪里。

# sql - 如何为此表编写嵌套查询？

> ID：13895235
> 
> 赞同：2
> 
> 时间：2012-12-15T19:05:11.390
> 
> 标签：sql, sql-server, tsql

想象一下，我的数据库中有一个类似于下表的表，我如何编写一个查询来返回作为该查询输入的地方的一部分的所有地方？

例如，如果我发送：

```
(this is the input)   (I want this result)
1 (Europe)            France, Italy, Paris, PartA, PartAA
3 (France)            Paris, PartA, PartAA
4 (Paris)             PartA, PartAA 
```

![带有示例表的图片](../Images/a8daa58db56569d2339488d94dbe15e5.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:20:47.273

正如 Martin Smith 所建议的，我查看了递归 CTE，这就是我想出的：

```
with place_hierarchy (code, place, parent_code)
as (
    select p.code, p.place, p.parent_code
    from places p
    where p.code = :code
    union all
    select p.code, p.place, p.parent_code
    from places p
    inner join place_hierarchy ph on p.parent_code = ph.code
)
select ph.place
from place_hierarchy ph 
```

不过，它完全未经测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:24:22.727

递归 CTE 构建子树，将所有位置聚合到单行。

```
with placesreq(code, place, parent, depth)
as
(
  select code, place, parentCode, 0 as depth
  from places
  where place = 'France'

  union all

  select p.code, p.place, p.parentCode, r.depth+1
  from places as p
    join placesreq as r  on r.code = p.parentCode
)
select place+',' as 'data()'
from placesreq
where depth > 0
for xml path('') 
```

唯一的小问题是列表中最后一个位置后面的逗号。您可以在查询中或稍后在代码中摆脱它。

# math - 确定对象在距点特定距离和角度处的坐标

> ID：13895237
> 
> 赞同：1
> 
> 时间：2012-12-15T19:05:18.867
> 
> 标签：math, rotation, geometry, 2d, coordinates

在二维空间中，我有一个坐标为 x1 和 y1 的对象，它面向特定的方向，我们称之为“查看器”。开始时，测量对象旋转的角度为 0，因此对象开始时始终面​​向相同的方向。角度由称为 yrot 的变量测量。

令 D 为与由 sqrt ((x1-x2)^2 + (y1-y2)^2) 确定的对象的距离，考虑此距离已知。

现在，知道了观察者坐标、D 距离和 yrot 角，我想确定距离观察者对象面部距离为 D 的对象的坐标 x2、y2。

为了澄清这一点，我将添加一个简单的矩阵来解释我想要的：

Z 0 0

0 0 0

0 0 伏

V 是观察者，V 面向 Z。我只对 V 前面有一个物体感兴趣（在特定距离处）。换句话说，假设 Z 与 V 的距离为 D（已知），我只对 Z 是一个对象感兴趣，没有别的。

我相信所需的坐标是 x2 = x1 (+/-) d* sin yrot; y2 = y1 (+/-) d*cos yrot; 我不确定这是否是正确的公式，而且它似乎不起作用。我也不确定第二个操作数的符号。

如果有什么不清楚的地方，请留下评论，我会尽我所能尽快回答。

谢谢！

稍后编辑：|| <- 面向观众的位置，yrot = 0; [] <-查看器

```
 = [] <- viewer yrot = 90 degrees. 
```

这应该澄清什么是yrot。此外，对象可以随心所欲地旋转（> 2 PI），它可以顺时针和逆时针旋转。

Charles Bretana 的回答似乎几乎是正确的，我不确定它是否涵盖过度旋转（旋转 > 360 度）和不同方向的旋转。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-15T19:13:55.363

给定一个点 A (ax, ay)，点 B (bx, by) 的坐标是在角度 t 表示的方向上与 A 的距离 d（其中`t: - pi < t < + pi`和从正 x 方向逆时针测量），将是：

```
 bx = ax + d*cos(t)
 by = ay + d*sin(t) 
```

我不确定这种方法是否符合您的问题，因为从您的问题中不清楚角度`yrot`代表什么。但是，如果您`yrot`将观察者的视线与正 X 轴的点 B 之间的角度确定为简单的角度，则上述方法应该有效。

要覆盖过度旋转，只需取 yRot 并减去 2*Pi，直到结果介于 - Pi 和 + Pi 之间

# c - OpenCV 模板匹配 - 比较结果

> ID：13895238
> 
> 赞同：1
> 
> 时间：2012-12-15T19:05:22.473
> 
> 标签：c, templates, opencv, matching

使用 cvMatchTemplate 后是否可以比较生成的图像？我的“干草堆”中有两个对象。一个与模板的规模相似，由匹配器找到。然而，另一个更大的对象与模板完全相同，但由于比例关系未找到。

我想编写一个循环，在其中缩放模板并收集有关每个尝试缩放的结果。然后我想取“最强”的比赛结果。

是否可以比较比赛结果？我该怎么做呢？

提前致谢！

# php - php 表单在特定服务器上不起作用

> ID：13895243
> 
> 赞同：-2
> 
> 时间：2012-12-15T19:05:49.917
> 
> 标签：php, javascript, jquery

我有使用 php 脚本的表单，它在其他服务器上工作正常，但是我在实时服务器上遇到了问题。下面我提到了细节：

使用 ajax 调用和 php 发送的联系表格。它在我检查过的两台服务器上工作，其中一台链接在 [http://www.virtualmob.co.uk/products/test_landing_pages/UrbanSpot/contact.html下面](http://www.virtualmob.co.uk/products/test_landing_pages/UrbanSpot/contact.html)

但是，当我将其上传到实时服务器上时，相同的表格无法正常工作，我不知道为什么？:( 实时链接如下： [http ://www.urban-spot.co.uk/contact.html](http://www.urban-spot.co.uk/contact.html)

php 已安装在服务器上，如果服务器中关闭了任何必要的东西，请告诉我，这是 php 信息链接：

**这是php代码**

```
<?php

// Change this with your blog name and email address
$the_blogname   = 'MobilityApp';
$the_myemail    = 'info@urban-spot.co.uk';

if(isset($_POST['email'])){
    error_reporting(0); 
    $errorC = false;

    $the_email      = $_POST['email'];
    $the_name       = $_POST['yourname'];
    $the_message    = $_POST['message'];

    $the_phone      = $_POST['phone'];
    $the_fax        = $_POST['fax'];
    $the_company    = $_POST['company'];
    $the_website    = $_POST['website'];

    # want to add aditional fields? just add them to the form in template_contact.php,
    # you dont have to edit this file

    //added fields that are not set explicit like the once above are combined and added before the actual message
    $already_used = array('email','yourname','message','phone','fax','company','website','myblogname','tempcode','temp_url','ajax');
    $attach = '';

    foreach ($_POST as $key => $field)
    {
        if(!in_array($key,$already_used))
        {
            $attach.= $key.": ".$field."<br /> \n";
        }
    }
    $attach.= "<br /> \n";

    if(!checkmymail($the_email))
    {
        $errorC = true;
        $the_emailclass = "error";
    }else{
        $the_emailclass = "valid";
        }

    if($the_message == "")
    {
        $errorC = true;
        $the_messageclass = "error";
    }else{
        $the_messageclass = "valid";
        }

    if($errorC == false)
    {   
        $to      =  $the_myemail;
        $subject = "New Message from " . $the_blogname;
        $header  = 'MIME-Version: 1.0' . "\r\n";
        $header .= 'Content-type: text/html; charset=utf-8' . "\r\n";
        $header .= 'From:'. $the_email  . " \r\n";

        $message1 = nl2br($the_message);

        if(!empty($the_name))       $the_name       = "Name:    $the_name <br/>";
        if(!empty($the_company))    $the_company    = "Company: $the_company <br/>";
        if(!empty($the_phone))      $the_phone      = "Phone:   $the_phone <br/>";
        if(!empty($the_fax))        $the_fax        = "Fax:     $the_fax <br/>";
        if(!empty($the_website))    $the_website    = "Website: $the_website <br/>";

        $message = "
        You have a new message! <br/>
        $the_name
        $the_company
        $the_phone
        $the_website

        $attach <br />

        Message: $message1 <br />";

        if(@mail($to,$subject,$message,$header)) $send = true; else $send = false;

        if(isset($_POST['ajax'])){

        if ($send)
        echo '<h3><img src="images/icon_check.png">&nbsp;&nbsp;Your message has been sent!</h3><div class="confirm">

              </div>';
        else
        echo '<h3>Oops!</h3><div class="confirm">
                <p class="texterror">Due to an unknown error, your form was not submitted, please resubmit it or try later.</p>
              </div>'; 

        }
    }

}

function checkmymail($mailadresse){
$email_flag=preg_match("!^\w[\w|\.|\-]+@\w[\w|\.|\-]+\.[a-zA-Z]   {2,4}$!",$mailadresse);
return $email_flag;
}

?> 
```

**为了参考，我使用下面的 ajax 调用**

```
 function tfuse_form1(){

var my_error;
var url = jQuery("input[name=temp_url]").attr('value');
jQuery(".ajax_form #send").bind("click", function(){

my_error = false;
jQuery(".ajax_form input, .ajax_form textarea, .ajax_form radio, .ajax_form select").each(function(i)
{
            var surrounding_element = jQuery(this);
            var value               = jQuery(this).attr("value"); 
            var check_for           = jQuery(this).attr("id");
            var required            = jQuery(this).hasClass("required"); 

            if(check_for == "email"){
                surrounding_element.removeClass("error valid");
                baseclases = surrounding_element.attr("class");
                if(!value.match(/^\w[\w|\.|\-]+@\w[\w|\.|\-]+\.[a-zA-Z]{2,4}$/)){
                    surrounding_element.attr("class",baseclases).addClass("error");
                    my_error = true;
                }else{
                    surrounding_element.attr("class",baseclases).addClass("valid"); 
                }
            }

            if(check_for == "name" || check_for == "message"){
                surrounding_element.removeClass("error valid");
                baseclases = surrounding_element.attr("class");

                if(value == "" || value == 'Name (required)' || value == 'Type your message' ){ 
                    surrounding_element.attr("class",baseclases).addClass("error");
                    my_error = true;
                }else{
                    surrounding_element.attr("class",baseclases).addClass("valid");
                }
            }

            if(required && check_for != "name" && check_for != "email" && check_for != "message"){
                surrounding_element.removeClass("error valid");
                baseclases = surrounding_element.attr("class");
                if(value == ""){                    
                    surrounding_element.attr("class",baseclases).addClass("error");
                    my_error = true;
                }else{
                    surrounding_element.attr("class",baseclases).addClass("valid"); 
                }
            }

            if(jQuery(".ajax_form input, .ajax_form textarea, .ajax_form radio, .ajax_form select").length  == i+1){
                    if(my_error == false){
                        jQuery(".ajax_form").slideUp(400);

                        var $datastring = "ajax=true";
                        jQuery(".ajax_form input, .ajax_form textarea, .ajax_form radio, .ajax_form select").each(function(i)
                        {
                            var $name = jQuery(this).attr('name');  
                            var $value = encodeURIComponent(jQuery(this).attr('value'));
                            $datastring = $datastring + "&" + $name + "=" + $value;
                        });

                        jQuery(".ajax_form #send").fadeOut(100);    

                        jQuery.ajax({
                           type: "POST",
                           url: "./sendmail.php",
                           data: $datastring,
                           success: function(response){
                               jQuery(".ajax_form").before("<div class='ajaxresponse'></div>");
                               jQuery(".ajaxresponse").html(response).slideDown(400); 
                               jQuery(".ajax_form #send").fadeIn(400);
                               jQuery(".ajax_form input, .ajax_form textarea, .ajax_form radio, .ajax_form select").val("");
                            }
                        });
                    } 
                }
        });
        return false;
});
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:30:19.960

它在某些服务器上运行但不在其他服务器上运行的事实使我认为不是代码有问题。您引用了问题服务器的 phpinfo 页面，但您是否将其与其中一台工作服务器的 phpinfo 页面进行了比较？您可能正在运行不同版本的 PHP。还要检查工作服务器和非工作服务器的 php.ini 文件，以验证是否加载了所有正确的扩展。

# iphone - 根据日期从单元格中获取详细信息

> ID：13895244
> 
> 赞同：-2
> 
> 时间：2012-12-15T19:05:52.800
> 
> 标签：iphone, objective-c, ios, uitableview

我创建了一个用于显示“每日提示”的 iOS 程序。该程序有 2 个选项卡：

1.  家
2.  UITableView（带天数）

您可以通过单击要在其中编写提示的单元格在*UITableView*上编写提示。在正确的日期，我想在“*主页”*选项卡中显示提示。我怎么做？

例如：如果 11 月 1 日的提示是“快乐”，那么当是 11 月 1 日时，我想在“*主页*”选项卡上显示“快乐”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:30:28.993

在主页中保留如下方法。

```
-(void)updateHomePageWithData:(NSDictionary *)selectedCellData {
    self.labelDetails.text = [selectedCellData valueForKey:@"Message"];
} 
```

在 UITableView 页面中，调用 cellForRowAtIndexpath 中的方法如下。

```
[self.delegate performSelector:@selector(updateHomePageWithData:) withObject:[arrayOfDates objectAtIndex:indexPath.row]]; 
```

# c# - 如何为 Windows 应用程序中托管的 WCF 服务创建代理

> ID：13895246
> 
> 赞同：0
> 
> 时间：2012-12-15T19:05:58.177
> 
> 标签：c#, wcf

我是 WCF 的初学者。所以我正在在线阅读小型 wcf 聊天的代码。我被困在为那个 wcf 聊天创建 wcf 客户端。我正在阅读的网址[http://islameldemery.blogspot.in/2008/05/wcf-serverclient-chat-sample.html](http://islameldemery.blogspot.in/2008/05/wcf-serverclient-chat-sample.html)

**在ServiceHost**的帮助下，接口和服务的一部分以win形式托管，但我无法理解代理是如何在客户端创建的。

他们在下面使用这个事件

```
InnerDuplexChannel.Opened
InnerDuplexChannel.Closed
InnerDuplexChannel.Faulted 
```

我真的不明白。谁能告诉我客户端是如何创建的。请访问该网址并告诉我该人如何在客户端为该聊天服务创建代理。

我尝试像自托管一样动态创建代理

```
var myBinding = new NetTcpBinding(SecurityMode.None);
  DuplexChannelFactory<ISampleChatCallback> cf =
          new DuplexChannelFactory<ISampleChatCallback>(
              new CallbackImpl(),
              myBinding,
              new EndpointAddress("net.tcp://192.168.1.2:8080/DataService")); 
  IServerWithCallback srv = cf.CreateChannel(); 
```

但 srv 没有称为打开、关闭或故障等的事件。我真的需要了解代理是如何在客户端创建的。请帮我创建代理，这样我就可以完成客户端的代码。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:22:36.920

.NET 的 WCF 客户端是使用名为的命令行工具生成的，该工具`svcutil.exe`可以生成代理，此处记录：http: [//msdn.microsoft.com/en-us/library/aa751905.aspx](http://msdn.microsoft.com/en-us/library/aa751905.aspx)。生成它们的另一种非常常见的方法是在 Visual Studio 中为您的项目添加服务引用，最终生成与使用`svcutil`. 此过程记录在这里：http: [//msdn.microsoft.com/en-us/library/ms733133.aspx](http://msdn.microsoft.com/en-us/library/ms733133.aspx)

Svcutil 将为您生成必要的代理类，并在`Channel`内部使用 a 进行通信。`Opened`状态和是为此通道定义的`Closed`。`Faulted`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:23:58.440

看看`private void buttonConnect_Click(object sender, EventArgs e)`

```
if (CheckServer()) //this seems to get metadata (MEX) from server
{
    proxy = null;
    InstanceContext context = new InstanceContext(this);

    // Step into this method and see what code gets executed.
    // This code can be generated by Visual Studio or written manually
    proxy = new Client.SampleService.SampleChatClient(context);

    proxy.InnerDuplexChannel.Opened += new EventHandler(InnerDuplexChannel_Opened);
    ...
} 
```

`proxy`暴露了一些事件（我想）只是 WCF 双工通道通信类的包装器（不管它是什么）。当新连接打开、关闭或出现故障状态时，这些事件会被触发。

# magento - 基于所选客户组的成功注册

> ID：13895247
> 
> 赞同：1
> 
> 时间：2012-12-15T19:06:20.523
> 
> 标签：magento, registration

我正在建立一个 Magento 网站。目前在我已经建立的帐户注册表格上，因此有一个下拉框，允许客户选择他们的“客户组”。

例如，如果有四个不同的客户组，则有四个不同的成功电子邮件，默认 Magento 一个，我将创建 3 个）。我需要的是根据选择哪个客户组发送适当的电子邮件。

我在 AccountController.php 中找到了发送新电子邮件的功能：

```
$customer->sendNewAccountEmail(
        $isJustConfirmed ? 'confirmed' : 'registered',
        '',
        Mage::app()->getStore()->getId()
    ); 
```

我最初的想法是在 app/locale/en_US/template/email 中创建其他电子邮件文件

但我不知道哪个文件/函数选择“account_new.html”作为默认电子邮件文件，所以我可以根据客户组 ID 实施一些检查。

我不确定接下来的步骤来解决这个问题，例如如何编辑这个文件以及在哪里创建不同的成功电子邮件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T00:34:18.677

您可能需要覆盖 Mage_Customer_Model_Customer 类来控制函数 sendNewAccountEmail()。此功能是系统决定发送哪封电子邮件的方式，理论上您可以覆盖此功能。

您可能知道如何进行覆盖，但以防万一：

```
<models>
    <customer>
        <rewrite>
            <customer>Namespace_Module_Model_Customer</customer>
        </rewrite>
    </customer>
</models> 
```

接下来，您需要创建系统配置值 System.xml，您需要为您拥有的每个“组”创建一个新条目。这不是最优雅的解决方案，因为这是一个静态列表，您的组可能是动态的。但是要分配一个模板，你要么需要一个全新的模块，要么更新这个文件。但是，现在您可以创建事务性电子邮件并将其分配给此 system.xml 文件中的每个组。

```
<?xml version="1.0"?>
<config>
    <sections>
        <yourmodule translate="label" module="yourmodule">
            <class>separator-top</class>
            <label>your module</label>
            <tab>general</tab>
            <frontend_type>text</frontend_type>
            <sort_order>30</sort_order>
            <show_in_default>1</show_in_default>
            <show_in_website>1</show_in_website>
            <show_in_store>0</show_in_store>
            <groups>
                <email translate="label">
                    <label>Email Templates</label>
                    <sort_order>1</sort_order>
                    <show_in_default>1</show_in_default>
                    <show_in_website>1</show_in_website>
                    <fields>
                        <group1_template translate="label comment">
                            <label>Group 1 Template</label>
                            <frontend_type>select</frontend_type>
                            <source_model>adminhtml/system_config_source_email_template</source_model>
                            <sort_order>1</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>0</show_in_store>
                        </group1_template>
                        <group2_template translate="label comment">
                            <label>Group 2 Template</label>
                            <frontend_type>select</frontend_type>
                            <source_model>adminhtml/system_config_source_email_template</source_model>
                            <sort_order>1</sort_order>
                            <show_in_default>1</show_in_default>
                            <show_in_website>1</show_in_website>
                            <show_in_store>0</show_in_store>
                        </group2_template>
                    </fields>
                </email>
            </groups>
        </yourmodule>
    </sections>
</config> 
```

最后，覆盖您的 sendNewAccountEmail()：

```
class Namespace_Module_Model_Customer {
    public function sendNewAccountEmail($type = 'registered', $backUrl = '', $storeId = '0')
    {
        $types = array(
            'registered'   => self::XML_PATH_REGISTER_EMAIL_TEMPLATE,  // welcome email, when confirmation is disabled
            'confirmed'    => self::XML_PATH_CONFIRMED_EMAIL_TEMPLATE, // welcome email, when confirmation is enabled
            'confirmation' => self::XML_PATH_CONFIRM_EMAIL_TEMPLATE,   // email with confirmation link
            'group1' => 'yourmodule/email/group1_template',
            'group2' => 'yourmodule/email/group2_template',
        );
        if (!isset($types[$type])) {
            Mage::throwException(Mage::helper('customer')->__('Wrong transactional account email type'));
        }

        if (!$storeId) {
            $storeId = $this->_getWebsiteStoreId($this->getSendemailStoreId());
        }

        $this->_sendEmailTemplate($types[$type], self::XML_PATH_REGISTER_EMAIL_IDENTITY,
            array('customer' => $this, 'back_url' => $backUrl), $storeId);

        return $this;
    }
} 
```

显然还有很大的改进空间，即提出一种动态拉取客户组并从中创建配置的方法，并为此功能添加相同的动态检查，但这是一个简单的静态解决方案。

# delphi - 如何使用 WriteComponent 方法编写 TComponent 后代？

> ID：13895258
> 
> 赞同：1
> 
> 时间：2012-12-15T19:07:34.267
> 
> 标签：delphi, delphi-2010

我有一个带有属性列表的基本类。然后创建子类并添加另一个属性。我需要将组件存储到文件中。但是不是存储子组件，而是写入父组件。

下面是一个演示该问题的示例。

```
 MyComp1 = class(TComponent)
  strict private
    FS: string;
    FI: Integer;
  published
    property S: string read FS write FS;
    property I: Integer read FI write FI;
  end;

  MyComp2 = class(MyComp1)
  strict private
    FS2: string;
  published
    property S2: string read FS2 write FS2;
  end;

procedure SaveIt;
var
  MS: TMemoryStream;
  C1: MyComp1;
  C2: MyComp2;
begin
  MS := TMemoryStream.Create;
  try
    C1 := MyComp1.Create(nil);
    C1.S := 'Hallo, World!';
    C1.I := 100500;
    C2 := MyComp2(C1);
    C2.S2 := 'Second string';
    MS.WriteComponent(C2);
    MS.Position := 0;
    MS.SaveToFile('C:\test.dat');
  finally
    MS.Free;
  end;
end; 
```

细节：

我有随时间扩展的功能。所以我创建了 TComponent 的基类（我们称之为 MyComp1）和这种类型的变量（MyComp: MyComp1）。一旦我扩展功能，我从以前的版本创建后代类 (MyComp2 = class(MyComp1)) 添加新的需要的属性并像这样分配它的值

```
MyComp2(MyComp).S2 := 'Second string'; 
```

然后我需要将 MyComp 组件保存到文件中，但带有子属性。我确实像这样创建它

```
MyComp := MyComp2.Create(nil) 
```

但将其保存到文件中只有 MyComp1 的属性

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T01:18:07.883

它不起作用，因为您正在实例化 的对象，`MyComp1`然后将其类型转换为`MyComp2`. 它不是`MyComp2`内存中的实际对象，因此将值写入对象的`MyComp2`属性`MyComp1`是访问不属于 MyComp1 对象的内存的无效操作，因此它充其量会崩溃，更糟的是会损坏内存。

处理这种情况的正确方法是自己创建一个对象实例`MyComp2`，根本不创建`MyComp1`。 `MyComp2`从 继承成员`MyComp1`，因此您可以访问对象`MyComp1`的属性`MyComp2`，例如：

```
procedure SaveIt;
var
  MS: TMemoryStream;
  Comp: MyComp2;
begin
  MS := TMemoryStream.Create;
  try
    Comp := MyComp2.Create(nil);
    try
      Comp.S := 'Hallo, World!';
      Comp.I := 100500;
      Comp.S2 := 'Second string';
      MS.WriteComponent(Comp);
    finally
      Comp.Free;
    end;
    MS.Position := 0;
    MS.SaveToFile('C:\test.dat');
  finally
    MS.Free;
  end;
end; 
```

# ruby-on-rails - 验证相关模型导轨

> ID：13895263
> 
> 赞同：1
> 
> 时间：2012-12-15T19:07:51.833
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, forms, validation

我在一种形式中有几个模型关联。我想验证每个嵌套属性的存在。

我有 Product 模型，例如我有这个：

产品.rb

```
 has_many :ships, :dependent => :destroy
  has_many :sizes, :dependent => :destroy

  accepts_nested_attributes_for :ships
  attr_accessible :ships_attributes
  attr_accessible :size_tokens
  attr_reader :size_tokens 
```

因此，当我发送产品表单的操作时，我想验证 :ships 和 :size_tokens 的存在。如何验证这些属性的存在？

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:11:13.067

你可以`validates_presence_of`同时使用。[你可以在这里](http://guides.rubyonrails.org/active_record_validations_callbacks.html)找到详细的解释。

# java - 尝试解决游戏循环中的限制（二维数组中的镜头）

> ID：13895267
> 
> 赞同：0
> 
> 时间：2012-12-15T19:08:25.447
> 
> 标签：java, loops

问题是我有几种方法可以在 Java 板上拍摄。您可以在代码中修改数组大小，它适用于任何维度。您可以选择许多不同的拍摄方向。例如，如果 a[x][9] ，您可以从 -4 拍摄到 4（不是 0）。问题是它适用于所有维度的所有方向，但不适用于限制（在本例中为 -4 和 4）。

我想问题一定出在常量上，但我不确定。我将代码粘贴在这里，以便您能够编译；)

```
public class Shooting{

    public static char [][] b = new char [25][9];

        public static char EMPTY = '-';
        public static char SHOT = 'x';
        public static Scanner sc = new Scanner(System.in);
        public static int shootDirection;
        public static int BOTTOM = b.length - 1;
        public static int RIGHT_WALL = b[0].length - 1;
        public static int LEFT_WALL = 0;
        public static int TOP = 0;
        public static int CENTER = ((RIGHT_WALL)/2);
        public static int START = ((RIGHT_WALL)/2) + shootDirection;

        public static void fill (char [][] b){
            for (int x = 0; x < b.length; x++){
                for (int y = 0; y < b[x].length;y++){
                    b [x][y] = EMPTY;
//                  b [10][y] = 'A';
                }
            }
        }    
        public static void show (char [][] b){
            for (int x = 0; x < b.length; x++){
                System.out.println();
                for (int y = 0; y < b[x].length; y++){
                    System.out.print(" "+b [x][y]+" ");
                }       
            }
        }
        public static boolean isOut (int x,int y){
            if(x < TOP)return true;
            if(y > RIGHT_WALL)return true;
            if(y < LEFT_WALL)return true;
            return false;     
        }
        static boolean emptyCell(int i, int j){
              return b [i][j] == EMPTY;
            }
        public static void shootDude (char [][] a , int shootDirection){
            START = ((RIGHT_WALL)/2) + shootDirection;
            boolean shotRight = false;
            if(shootDirection < 0)
                shotRight = false;
            else if(shootDirection > 0)
                shotRight = true;
            for(int i = a.length-1,j = START ;i >= 0;--i) {
                if(!isOut(i,j) && !emptyCell(i,j)) break;
                if(!isOut(i,j) && shotRight) {
                    a[i][j] = SHOT;
                    ++j;
                }
                else {
                    a[i][j] = SHOT;
                    --j;
                }
                if(j <= LEFT_WALL) 
                    shotRight = true;
                if(j >= RIGHT_WALL) 
                    shotRight = false;
            }
        }

        public static void main (String[] args){
            System.out.println("Introduce shot direction:");
            // With b[x][9] you can shot from -4 to 4\. The thing is that 
            //it doesnt work for -4 and 4, the edges. Can anyone solve it? 
            // Must be a silly thing ;)
            int shootDirection = sc.nextInt();
            fill (b);
            shootDude(b,shootDirection);
            show(b);

        }
} 
```

必须导入扫描仪；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T22:56:49.607

就像在 if 循环中修改布尔条件的使用一样简单；）

```
public static void shootDude (char [][] a , int shootDirection){
        START = ((RIGHT_WALL)/2) + shootDirection;
        boolean shotRight = false;
        if(shootDirection < 0)
            shotRight = false;
        else if(shootDirection > 0)
            shotRight = true;
        for(int x = BOTTOM,y = START ;x >= 0;x--) {
            if(!isOut(x,y) && !emptyCell(x,y)) break;
            if(y <= LEFT_WALL) 
                shotRight = true;
            if(y >= RIGHT_WALL) 
                shotRight = false;
            if(!isOut(x,y) && shotRight == true) {
                a[x][y] = SHOT;
                ++y;
            }
            if(!isOut(x,y) && shotRight == false){
                a[x][y] = SHOT;
                --y;
            }
        }
    } 
```

# java - 引用 Arraylist 中的元素

> ID：13895268
> 
> 赞同：-1
> 
> 时间：2012-12-15T19:08:38.973
> 
> 标签：java, oop, arraylist, 2d

所以我的 Player 扩展了 Mob，后者扩展了 Entity。在我的 Level 类中，我有一个数组列表，在主 Game 类中，我添加了他。

```
 public Level level;
     public Player player;

    player = new Player(level, 100, 100, input, JOptionPane.showInputDialog(this, "Username:"));
    level.addEntity(player); 
```

当我想引用玩家 X 和 Y 时问题就来了，这样我就可以将它们插入我的简单史莱姆怪物 AI！

我总是在这里得到一个 NullpointerException （第 7 行）：

```
public void tick() {
     int xa = 0;
     int ya = 0;

    if (randomWalkTime == 0) {
        int xd = level.player.x - x;
        int yd = level.player.y - y;
        if (xd * xd + yd * yd < 50 * 50) {
            xa = 0;
            ya = 0;
            if (xd < 0) xa = -1;
            if (xd > 0) xa = +1;
            if (yd < 0) ya = -1;
            if (yd > 0) ya = +1;
        }
    }
     move(xa, ya);
     randomWalkTime++;
     tickCount++;

} 
```

在第一级.player.x :(无论我如何尝试引用它。通过game.player.x或我能想到的任何其他东西。

**这是主要问题：**有一个新的“播放器”来自另一个类的数组列表。如何在我的 (Entites>Mob>) Sprite 类中引用他的 x 和 y？

如果上面的代码还不够，这里是其余的重要部分：

这是我的实体数组列表的 LEVEL 类！

```
public class Level {

private byte[] tiles;
public int width;
public int height;
public List<Entity> entities = new ArrayList<Entity>();
private String imagePath;
private BufferedImage image; 
```

实体类！

```
public abstract class Entity {

public int x, y;
protected Level level;

public Entity(Level level) {
    init(level);
}

public final void init(Level level) {
    this.level = level;
}

public abstract void tick();

public abstract void render(Screen screen); 
```

}

黑帮类：

```
public abstract class Mob extends Entity {

protected String name;
protected int speed;
protected int numSteps = 0;
protected boolean isMoving;
protected int movingDir = 1;
protected int scale = 1;

public Mob(Level level, String name, int x, int y, int speed) {
    super(level);
    this.name = name;
    this.x = x;
    this.y = y;
    this.speed = speed;
}

public void move(int xa, int ya) {
    if (xa != 0 && ya != 0) {
        move(xa, 0);
        move(0, ya);
        numSteps--;
        return;
    }
    numSteps++;
    if (!hasCollided(xa, ya)) {
        if (ya < 0)
            movingDir = 0;
        if (ya > 0)
            movingDir = 1;
        if (xa < 0)
            movingDir = 2;
        if (xa > 0)
            movingDir = 3;
        x += xa * speed;
        y += ya * speed;
    }
}

public abstract boolean hasCollided(int xa, int ya);

protected boolean isSolidTile(int xa, int ya, int x, int y) {
    if (level == null) {
        return false;
    }
    Tile lastTile = level.getTile((this.x + x) >> 3, (this.y + y) >> 3);
    Tile newTile = level.getTile((this.x + x + xa) >> 3, (this.y + y + ya) >> 3);
    if (!lastTile.equals(newTile) && newTile.isSolid()) {
        return true;
    }
    return false;
}

public String getName() {
    return name;
} 
```

}

这是我的 SLIME 课程的主要部分！

```
public class Slime extends Mob{

int xa, ya;
private int colour = Colours.get(-1, 111, 145, 543);

private int randomWalkTime = 0;
private boolean isSwimming;
private int tickCount = 0;

public Slime(Level level, String name, int x, int y, int speed) {
    super(level, "Slime", x, y, 1);
    x = this.x;
    y = this.y;

}

public void tick() {
     int xa = 0;
     int ya = 0;

    if (randomWalkTime == 0) {
        int xd = level.player.x - x;
        int yd = level.player.y - y;
        if (xd * xd + yd * yd < 50 * 50) {
            xa = 0;
            ya = 0;
            if (xd < 0) xa = -1;
            if (xd > 0) xa = +1;
            if (yd < 0) ya = -1;
            if (yd > 0) ya = +1;
        }
    }
     move(xa, ya);
     randomWalkTime++;
     tickCount++;

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:12:57.183

由于`level.player.x`给出了 NPE，因此您有两种可能性：eitehr`level`为空或`level.player`为空。您有两种方法可以确定它是哪个：

1.  最好使用调试器在有问题的行设置断点并监视这两个变量。

2.  添加`System.out.println()`调用以打印出这两个变量的值。

# javascript - CSS 背景幻灯片太慢？

> ID：13895270
> 
> 赞同：0
> 
> 时间：2012-12-15T19:08:43.190
> 
> 标签：javascript, html, css, slideshow

我正在尝试建立我的网站，我是新手，但我曾尝试将此代码用于背景幻灯片，不幸的是，加载页面需要很长时间。我已将 3-500KB 的图像优化为现在的 90-100KB，但仍然需要很长时间才能加载...帮助！

[我的网站的更新版本](http://globalplayernetwork.com/in.html)。我正在尝试使用我在网上找到的这些提示使其加载更快，但我很难让它加载得足够快。

*   [我的 CSS 文件](http://globalplayernetwork.com/css/style.css)（太大而无法发布）。
*   [我的 HTML 页面](http://pastebin.com/wHvPwKby)无法在此处发布，它似乎不起作用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:44:46.477

在检查时，您正在加载的图像似乎太多了，而且一下子就使网站变慢了。

![在此处输入图像描述](../Images/4def839f3cfb781c6ddf736cd4730cd8.png)

( [http://i.stack.imgur.com/xPRxM.png](https://i.stack.imgur.com/xPRxM.png) )

您应该使用延迟加载来更快地加载站点，因为这样只会加载所需的图像。

在需要时请求图像（或者可能在需要之前一点），但您绝对**不**应该将所有请求放在一起。

其次，你应该有不同的图像尺寸，根据需要准备好，而不是让浏览器调整图像的大小。它消耗时间和处理来让浏览器调整图像大小。如果你有图像的副本，它会让生活更简单。

有很多插件可用于实现延迟加载。由于您使用的是 jQuery，因此这里有一些：

1.  [http://www.appelsiini.net/projects/lazyload （](http://www.appelsiini.net/projects/lazyload)[这里](http://www.appelsiini.net/projects/lazyload/enabled.html)有简单的演示）
2.  [http://css-tricks.com/snippets/javascript/lazy-loading-images/](http://css-tricks.com/snippets/javascript/lazy-loading-images/)
3.  [http://www.google.com/search?q=lazy+loading+jquery](http://www.google.com/search?q=lazy+loading+jquery)

其他提示：

将所有脚本合并为一个，并制作一个`js`文件。

因此，以下内容：

```
 - <script type="text/javascript" src="js/pop-ups.js"></script>
 - <script type="text/javascript" src="js/jquery.easing.1.3.js"></script> 
 - <script type="text/javascript" src="js/jquery.mousewheel.js"></script> 
 - <script type="text/javascript" src="js/jquery.jscrollpane.min.js"></script> 
 - <script type="text/javascript" src="js/cufon.js"></script> 
```

变成`<script type="text/javascript" src="js/all.js"></script>`

现在，为了进一步优化，缩小它们。

有很多在线工具，但我喜欢[这个](http://closure-compiler.appspot.com/home)。

另外，我建议您看一下[Chris](http://speakerdeck.com/player/87fa761026bf013092b722000a1d8877#) Coyier 的演示文稿（从幻灯片 97 开始）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:08:45.720

@Pranav 的回答非常好。

你绝对应该看看 chrome 检查器拥有的所有工具（我确定是 firefox）

加载您的网站会给我 94 个错误。

你需要看很多东西，但我肯定会推荐使用 css sprites，特别是对于那些疯狂数量的图片。

您**需要最小化请求**。看看我在说[什么](http://css-tricks.com/css-sprites/)。

* * *

这是 chrome 审核告诉您的网站的内容，您不需要执行所有这些操作，但您应该尝试执行以下操作：

```
Combine external JavaScript (16)
There are multiple resources served from same domain. Consider combining them into as few files as possible.
8 JavaScript resources served from globalplayernetwork.com.
5 JavaScript resources served from maps.gstatic.com.
3 JavaScript resources served from maps.google.com.
Enable gzip compression (20)
Compressing the following resources with gzip could reduce their transfer size by about two thirds (~668.95KB):
in.html could save ~10.15KB
style.css could save ~12.02KB
jquery.min.js could save ~46.99KB
pop-ups.js could save ~4.91KB
jquery.easing.1.3.js could save ~3.54KB
jquery.mousewheel.js could save ~881B
jquery.jscrollpane.min.js could save ~9.52KB
cufon.js could save ~14.03KB
Quicksand_Book_400.font.js could save ~17.13KB
functions.js could save ~2.10KB
jquery.mCustomScrollbar.js could save ~8.67KB
%7Bmain,mod_util,mod_act,mod_act_s,mod_actbr,mod_adf,mod_appiw,mod_gmmp,mod_mg,mod_mssvt,mod_pphover,mod_rst,mod_strr%7D.js could save ~354.18KB
click could save ~343B
main.js could save ~103.37KB
hosts.js could save ~8.07KB
%7Bmod_ctrapp,mod_touch,mod_rot,mod_exdom,mod_kbrd,mod_lyrs,mod_blyr,mod_qdt,mod_trtlr%7D.js could save ~57.23KB
mod_svau.js could save ~2.14KB
%7Bmod_tfcapp,mod_lyctr%7D.js could save ~12.15KB
maps.google.com/cbk?output=xml&hl=en&ll=36.131931,-115.160451&cb_client=&v=4 could save ~659B
mod_ls.js could save ~926B
Leverage browser caching (120)
The following resources specify a "Vary" header that disables caching in most versions of Internet Explorer:
icon_mhlasvegasdowntownbj.png
The following resources are explicitly non-cacheable. Consider making them cacheable if possible:
in.html
style.css
90.jpg
GPNLogo.png
1joe.jpg
5.jpg
thestrip.jpg
gpn13.jpg
gpnSStrip.jpg
gpn3.jpg
10.jpg
gpn11.jpg
gpn9.jpg
gpn4.jpg
gpnSW.jpg
close.png
200x200.png
CritterPokerIcon.jpg
p48_baccarat_comp.jpg
roulette_icon.png
street-craps-icon.png
slide4.png
maps
facebook.png
linkedin.png
twitter.png
jquery.min.js
pop-ups.js
jquery.easing.1.3.js
jquery.mousewheel.js
jquery.jscrollpane.min.js
cufon.js
Quicksand_Book_400.font.js
functions.js
jquery.mCustomScrollbar.js
home3.html
v=123&src=app&x=2950&y=6425&z=14&s=Gal
v=123&src=app&x=2951&y=6425&z=14&s=Galile
lyrs=h@202000000&hl=en&src=api&x=2950&y=6425&z=14&s=Gal
lyrs=h@202000000&hl=en&src=api&x=2951&y=6425&z=14&s=Galile
lyrs=h@202000000&hl=en&src=api&x=2950&y=6426&z=14&s=Gali
lyrs=h@202000000&hl=en&src=api&x=2951&y=6426&z=14&s=Galileo
transparent.png
%7Bmain,mod_util,mod_act,mod_act_s,mod_actbr,mod_adf,mod_appiw,mod_gmmp,mod_mg,mod_mssvt,mod_pphover,mod_rst,mod_strr%7D.js
90.jpg
91.jpg
overlay.png
down.png
up.png
main.js
hosts.js
pt
vp
%7Bmod_ctrapp,mod_touch,mod_rot,mod_exdom,mod_kbrd,mod_lyrs,mod_blyr,mod_qdt,mod_trtlr%7D.js
lyrs=h@202000000&hl=en&src=api&x=2950&y=6427&z=14&s=Galil
lyrs=h@202000000&hl=en&src=api&x=2951&y=6427&z=14&s=
transparent.png
red_markers_A_J2.png
shadow50.png
transparent.png
transparent.png
transparent.png
lyrs=h@202219229&hl=en&src=api&x=2950&y=6426&z=14&s=Gali
lyrs=h@202208787&hl=en&src=api&x=2951&y=6426&z=14&s=Galileo
lyrs=h@202220091&hl=en&src=api&x=2950&y=6425&z=14&s=Gal
lyrs=h@202153576&hl=en&src=api&x=2951&y=6425&z=14&s=Galile
red_markers_A_J2.png
shadow50.png
markerTransparent.png
dithshadow.gif
mod_svau.js
%7Bmod_tfcapp,mod_lyctr%7D.js
lyrs=h@202000000&hl=en&src=api&x=2952&y=6426&z=14&s=Ga
lyrs=h@202000000&hl=en&src=api&x=2952&y=6425&z=14&s=G
iw3.png
iws3.png
transparent.png
red_grow_markers_A_J2.png
shadow50.png
transparent.png
markerTransparent.png
transparent.png
transparent.png
maps.google.com/cbk?output=xml&hl=en&ll=36.131931,-115.160451&cb_client=&v=4
red_grow_markers_A_J2.png
transparent.png
shadow50.png
lyrs=h@202000000&hl=en&src=api&x=2952&y=6427&z=14&s=Gal
v=123&src=app&x=2950&y=6427&z=14&s=Galil
transparent.png
transparent.png
transparent.png
transparent.png
v=123&src=app&x=2951&y=6427&z=14&s=
transparent.png
transparent.png
transparent.png
transparent.png
v=123&src=app&x=2952&y=6426&z=14&s=Ga
v=123&src=app&x=2952&y=6425&z=14&s=G
v=123&src=app&x=2952&y=6427&z=14&s=Gal
transparent.png
transparent.png
transparent.png
transparent.png
lyrs=h@202214362&hl=en&src=api&x=2950&y=6427&z=14&s=Galil
lyrs=h@202216272&hl=en&src=api&x=2951&y=6427&z=14&s=
transparent.png
transparent.png
transparent.png
transparent.png
lyrs=h@202208787&hl=en&src=api&x=2952&y=6426&z=14&s=Ga
lyrs=h@202179311&hl=en&src=api&x=2952&y=6425&z=14&s=G
transparent.png
transparent.png
transparent.png
transparent.png
lyrs=h@202219273&hl=en&src=api&x=2952&y=6427&z=14&s=Gal
mod_ls.js
Leverage proxy caching (5)
The following publicly cacheable resources contain a Set-Cookie header. This security vulnerability can cause cookies to be shared by multiple users.
icon_mhlasvegasdowntownbj.png
480_icon.png
v=123&src=app&x=2950&y=6426&z=14&s=Gali
v=123&src=app&x=2951&y=6426&z=14&s=Galileo
cbk
Minimize cookie size
The average cookie size for all requests on this page is 99B
Parallelize downloads across hostnames (51)
This page makes 51 parallelizable requests to maps.gstatic.com. Increase download parallelization by distributing the following requests across multiple hostnames.
back_gray.png
smc.png
poweredby.png
transparent.png
transparent.png
emulate_iphone_full2.png
iw2.png
transparent.png
red_markers_A_J2.png
shadow50.png
transparent.png
transparent.png
transparent.png
mp4.png
hpimgs28.png
red_markers_A_J2.png
shadow50.png
markerTransparent.png
dithshadow.gif
iw3.png
iws3.png
transparent.png
red_grow_markers_A_J2.png
shadow50.png
transparent.png
markerTransparent.png
transparent.png
transparent.png
red_grow_markers_A_J2.png
transparent.png
shadow50.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
transparent.png
Serve static content from a cookieless domain (32)
29.32KB of cookies were sent with the following static resources. Serve these static resources from a domain that does not set cookies:
icon_mhlasvegasdowntownbj.png
p48_baccarat_comp.jpg
p
transparent.png
v=123&src=app&x=2950&y=6425&z=14&s=Gal
v=123&src=app&x=2950&y=6426&z=14&s=Gali
v=123&src=app&x=2950&y=6427&z=14&s=Galil
v=123&src=app&x=2952&y=6426&z=14&s=Ga
v=123&src=app&x=2952&y=6425&z=14&s=G
v=123&src=app&x=2952&y=6427&z=14&s=Gal
v=123&src=app&x=2951&y=6425&z=14&s=Galile
v=123&src=app&x=2951&y=6426&z=14&s=Galileo
v=123&src=app&x=2951&y=6427&z=14&s=
lyrs=h@202000000&hl=en&src=api&x=2950&y=6425&z=14&s=Gal
lyrs=h@202000000&hl=en&src=api&x=2950&y=6426&z=14&s=Gali
lyrs=h@202000000&hl=en&src=api&x=2950&y=6427&z=14&s=Galil
lyrs=h@202219229&hl=en&src=api&x=2950&y=6426&z=14&s=Gali
lyrs=h@202220091&hl=en&src=api&x=2950&y=6425&z=14&s=Gal
lyrs=h@202000000&hl=en&src=api&x=2952&y=6426&z=14&s=Ga
lyrs=h@202000000&hl=en&src=api&x=2952&y=6425&z=14&s=G
lyrs=h@202000000&hl=en&src=api&x=2952&y=6427&z=14&s=Gal
lyrs=h@202214362&hl=en&src=api&x=2950&y=6427&z=14&s=Galil
lyrs=h@202208787&hl=en&src=api&x=2952&y=6426&z=14&s=Ga
lyrs=h@202179311&hl=en&src=api&x=2952&y=6425&z=14&s=G
lyrs=h@202219273&hl=en&src=api&x=2952&y=6427&z=14&s=Gal
lyrs=h@202000000&hl=en&src=api&x=2951&y=6425&z=14&s=Galile
lyrs=h@202000000&hl=en&src=api&x=2951&y=6426&z=14&s=Galileo
lyrs=h@202000000&hl=en&src=api&x=2951&y=6427&z=14&s=
lyrs=h@202208787&hl=en&src=api&x=2951&y=6426&z=14&s=Galileo
lyrs=h@202153576&hl=en&src=api&x=2951&y=6425&z=14&s=Galile
lyrs=h@202216272&hl=en&src=api&x=2951&y=6427&z=14&s=
cbk
Specify image dimensions (16)
A width and height should be specified for all images in order to speed up page display. The following image(s) are missing a width and/or height:
1joe.jpg
5.jpg
thestrip.jpg
gpn13.jpg
gpnSStrip.jpg
gpn3.jpg
10.jpg
gpn11.jpg
gpn9.jpg
gpn4.jpg
gpnSW.jpg
close.png (4 uses)
200x200.png
facebook.png
linkedin.png
twitter.png
Web Page Performance
Optimize the order of styles and scripts (1)
The following external CSS files were included after an external JavaScript file in the document head. To ensure CSS files are downloaded in parallel, always include external CSS before external JavaScript.
1 inline script block was found in the head between an external CSS file and another resource. To allow parallel downloading, move the inline script before the external CSS file, or after the next resource.
Remove unused CSS rules (2287)
93.85KB (80%) of CSS is not used by the current page.
style.css: 5.24KB (37%) is not used by the current page.
Inline block #1: 222B (31%) is not used by the current page.
Inline block #2: 0B (0%) is not used by the current page.
Inline block #3: 54.91KB (90%) is not used by the current page.
Inline block #4: 20.84KB (72%) is not used by the current page.
Inline block #5: 4.16KB (93%) is not used by the current page.
Inline block #6: 908B (100%) is not used by the current page.
Inline block #7: 723B (100%) is not used by the current page.
Inline block #8: 1.37KB (100%) is not used by the current page.
Inline block #9: 96B (100%) is not used by the current page.
Inline block #10: 2.14KB (83%) is not used by the current page.
Inline block #11: 2.00KB (100%) is not used by the current page.
Inline block #12: 636B (93%) is not used by the current page.
Inline block #13: 267B (100%) is not used by the current page.
Inline block #14: 269B (100%) is not used by the current page.
Inline block #15: 149B (100%) is not used by the current page.
Inline block #16: 0B (0%) is not used by the current page.
Inline block #17: 0B (0%) is not used by the current page. 
```

# python - 在 Python 中使用 QtCreator 转换的文件

> ID：13895274
> 
> 赞同：1
> 
> 时间：2012-12-15T19:09:08.107
> 
> 标签：python, qt, pyside, qwidget

我有一个由命令转换的文件：`pyside-uic -o ui_name.py name.ui`我尝试在我的项目中使用它。第一个文件：

```
class Example(QWidget):
    def __init__(self):
        super(Example, self).__init__()
        self.initUI()

    def initUI(self):
        self.ui_window = ui_window.Ui_MainWindow()

        self.btn5 = QPushButton(QIcon(),"Open", self)
        self.btn5.move(0, 20)
        self.btn5.resize(70, 20)
        self.btn5.clicked.connect(self.doAction5)

    def doAction5(self):
        self.ui_window.Show() 
```

第二个（ui_window.py）：

```
class Ui_MainWindow(object):
.......
    def Show(self):
    self.show() 
```

当我执行项目并按下按钮时，出现错误：

```
AttributeError: 'Ui_MainWindow' object has no attribute 'show' 
```

我不知道用什么来代替它。

编辑：第一个文件代码已编辑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:21:06.770

运行后`pyside-uic -o ui_name.py name.ui`，您将得到一个用于接口的 python 文件 ui_name.py。**不要更改此文件中的任何内容。**该文件旨在导入到您的主代码中，如下所示：

```
from ui_name import Ui_MainWindow

class MainWindow(QMainWindow, Ui_MainWindow):
    def __init__(self):
        super(MainWindow, self).__init__()
        self.setupUi(self)

        self.btn5 = QPushButton(QIcon(),"Open", self)
        self.btn5.move(0, 20)
        self.btn5.resize(70, 20)
        self.btn5.clicked.connect(self.doAction5)

        self.show() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:16:41.260

在您的文件中尝试以下代码`window.py`：

```
from Ui_MyWindow import Ui_myWindow

class myWindow(QMainWindow, Ui_myWindow):
    def __init__(self, parent=None):
        super(myWindow, self).__init__(parent)
        self.setupUi(self) 
```

您的**Ui**文件的名称应该类似于`Ui_MyWindow.py`，并且您从那里导入的类应该类似于`Ui_myWindow`

要显示您的窗口，请在您的末尾添加此代码`window.py`：

```
if __name__ == "__main__":
    import  sys

    app = QApplication(sys.argv)
    main = myWindow()
    main.show()
    sys.exit(app.exec_()) 
```

# wordpress - 如何保存 wordpress 测验的分数？

> ID：13895279
> 
> 赞同：1
> 
> 时间：2012-12-15T19:09:33.387
> 
> 标签：wordpress

我研究了几个用于参加和评分测验的 Wordpress 插件，看起来都不错。但似乎没有一个使用用户 ID 存储分数。在用户通过我的测验之前，我需要限制对我网站某些页面的访问。谁能推荐一个插件/流程来做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T08:05:53.170

我正在做一些稍微不同的事情。我只是修补其中一个插件来更新用户的角色。

# java - java.util.Calendar 混乱

> ID：13895284
> 
> 赞同：0
> 
> 时间：2012-12-15T19:10:01.820
> 
> 标签：java, internationalization, calendar, locale, cloudbees

我在使用 java.util.Calendar 和 commons-lang DateUtil 时遇到问题 问题是我的测试在本地机器上正常工作，而在 CloudBees 上失败。似乎语言环境存在问题，但我不确定。

这是代码：

```
import org.testng.Assert;
import org.testng.annotations.BeforeClass;
import org.testng.annotations.Test;

//bla-bla-bla

public static final String TEST_DATE_AS_STRING = "13 10 2012 20:50:44";
public static final int MILLIS_IN_HOUR = 3600000;
private static final String LEAP_WEEK_DATE_AS_STRING = "31 10 2012 20:50:44";

private final SimpleDateFormat sdf = new SimpleDateFormat("dd MM yyyy HH:mm:ss");

@Test
public void getWeekDatePair() throws ParseException{
    Date date = sdf.parse(TEST_DATE_AS_STRING);
    DatePair dp = Util.DateTime.getWeekDatePair(date);
    Assert.assertEquals(sdf.format(new Date(dp.getStart())), "08 10 2012 00:00:00");
    //java.lang.AssertionError: expected [14 10 2012 00:00:00] but found [07 10 2012 00:00:00]
    Assert.assertEquals(sdf.format(new Date(dp.getEnd())), "14 10 2012 00:00:00");
}

@Test
public void getLeapWeekDatePair() throws ParseException {
    Date leapDate = sdf.parse(LEAP_WEEK_DATE_AS_STRING);
    DatePair dp  = Util.DateTime.getWeekDatePair(leapDate);
    Assert.assertEquals(sdf.format(new Date(dp.getStart())), "29 10 2012 00:00:00");

    //java.lang.AssertionError: expected [04 11 2012 00:00:00] but found [28 10 2012 00:00:00]
    Assert.assertEquals(sdf.format(new Date(dp.getEnd())), "04 11 2012 00:00:00");
} 
```

这是失败的测试输出：

```
 java.lang.AssertionError: expected [04 11 2012 00:00:00] but found [28 10 2012 00:00:00]
    at org.testng.Assert.fail(Assert.java:94)
    at org.testng.Assert.failNotEquals(Assert.java:494)
    at org.testng.Assert.assertEquals(Assert.java:123)
    at org.testng.Assert.assertEquals(Assert.java:176)
    at org.testng.Assert.assertEquals(Assert.java:186)
    at ru.rating.utils.UtilDateTimeTest.getLeapWeekDatePair(UtilDateTimeTest.java:77)

expected [14 10 2012 00:00:00] but found [07 10 2012 00:00:00]
Stacktrace

java.lang.AssertionError: expected [14 10 2012 00:00:00] but found [07 10 2012 00:00:00]
at org.testng.Assert.fail(Assert.java:94)
at org.testng.Assert.failNotEquals(Assert.java:494)
at org.testng.Assert.assertEquals(Assert.java:123)
at org.testng.Assert.assertEquals(Assert.java:176)
at org.testng.Assert.assertEquals(Assert.java:186)
at ru.rating.utils.UtilDateTimeTest.getWeekDatePair(UtilDateTimeTest.java:69) 
```

这是实现：

```
 public static DatePair getWeekDatePair(){
        return getWeekDatePair(new Date());
    }

/**
 * This is test method
 * */
        static DatePair getWeekDatePair( Date date){
            Date truncDay = truncate(date.getTime(), Calendar.DAY_OF_MONTH);
            Calendar calStart = getCalendarInstance(date, Calendar.DAY_OF_MONTH);
            calStart.setTime(truncDay);
            calStart.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);        

            Calendar calEnd = Calendar.getInstance();
            calEnd.setTime(calStart.getTime());
            calEnd.set(Calendar.DAY_OF_WEEK, Calendar.SUNDAY);

            return new DatePair(calStart.getTime(), calEnd.getTime());
        }
    public static Date truncate(long date, int calField) {
        Calendar cal = getCalendarInstance(new Date(date), calField);
    cal = DateUtils.truncate(cal, calField);
        return cal.getTime();
    }

static Calendar getCalendarInstance(Date date, int calendarField){
    //Calendar cal = Calendar.getInstance();
    Calendar cal = new GregorianCalendar(Locale.ENGLISH);

    cal.setTime(date);
    if(calendarField!=Calendar.HOUR){
        cal.set(Calendar.HOUR_OF_DAY, 0);
    }
    cal.set(Calendar.MINUTE, 0);
    cal.set(Calendar.SECOND, 0);
    cal.set(Calendar.MILLISECOND, 0);
    return cal;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:41:20.437

尽管我们在这里缺少关键信息（如何`Util.DateTime.getWeekDatePair(java.util.Date)`实现），但我怀疑您在那里所做的事情是`java.util.Calendar`使用默认值进行实例化`Locale`，然后搜索一周的第一天。

我的怀疑来自这样一个事实，即您没有将 Locale 实例传递给该`getWeekDatePair()`方法。

现在，这里有什么问题？好吧，一周的第一天取决于语言环境。因此，当您实例化`Calendar`这样的：`Calendar.getInstance()`时，您实际上所做的是：`Calendar.getInstance(Locale.getDefault(Locale.Category.FORMAT)`。当然，一周的第一天在两台不同的机器上可能会有所不同，因为语言环境*可能*不同。
例如，一周的第一天在美国是星期日，但在波兰是星期一（我相信在俄罗斯是这样的，不是吗？）因此，如果您在两台不同的机器上进行此测试，其中的第一天设置了 Locale到 en-US 和第二到 ru-RU，您*可能会*期待不同的结果。

如果只是测试的问题，你也可以设置默认的语言环境，一切都应该正常工作。但是，请记住，如果您正在测试 Web 应用程序，使用默认区域设置是一件坏事，因为它会返回服务器区域设置，而不是来自 Web 浏览器的区域设置（或某些用户配置文件，如果有的话）。如果此区域设置不同，您可能会使用一些令最终用户感到困惑的东西。

* * *

## 编辑

从实现中发生这种情况的原因很明显，我之前给过你提示。考虑这段代码：

```
Calendar cal = Calendar.getInstance(Locale.ENGLISH);
System.out.println(sdf.format(cal.getTime()));
// Cloning so that Calendar could be re-used
Calendar calEnd = (Calendar) cal.clone();
// Setting start of the week date
cal.set(Calendar.DAY_OF_WEEK, Calendar.MONDAY);
System.out.println(sdf.format(cal.getTime()));
calEnd.set(Calendar.DAY_OF_WEEK, Calendar.SUNDAY);
System.out.println(sdf.format(calEnd.getTime())); 
```

这打印（正确）：

> 13 10 2012 00:00:00
> 08 10 2012 00:00:00
> 07 10 2012 00:00:00

现在，让我们将日历实例更改为：

```
Calendar cal = Calendar.getInstance(Locale.forLanguageTag("ru-RU")); 
```

瞧，现在你会看到：

> 13 10 2012 00:00:00
> 08 10 2012 00:00:00
> 14 10 2012 00:00:00

要了解为什么*这是正确的行为*，让我们也测试一下这段代码：

```
System.out.println(cal.getFirstDayOfWeek()); 
```

对于英语语言环境，它将返回 1（星期日），而不是 2（星期一），这是俄语语言环境的结果。此代码行为正确，因为它返回给定周的星期一和星期日。唯一的“问题”是这样一个事实，那一周在世界各地都意味着其他事情。

如您所见，它与 DateUtils 无关，它仅与 Calendar 的行为有关。由于这段代码：`Calendar cal = new GregorianCalendar(Locale.ENGLISH);`行为实际上应该是一致的，所以无论你在什么机器上测试代码，你都应该总是得到一个错误。不是这样的，我真的不明白为什么。

根据您要实现的目标，将 Locale 作为参数添加到您的方法（并相应地实例化 Calendar）可能是有意义的，然后编写一些涵盖少数 Locale 的测试（一些阿拉伯语 Locale 也可能很有趣，因为没有人说第一天周必须是星期日或星期一）**或**仅修改测试日期以使其与正确的日历行为相匹配。

# javascript - 用于填充表单的书签？

> ID：13895285
> 
> 赞同：0
> 
> 时间：2012-12-15T19:10:02.920
> 
> 标签：javascript

我想创建一个书签，它将获取该人所在的当前 URL 并将其传递给另一个网站上的表单。该表单是 POST，不能转换为 GET。听起来类似于：[将 URL 传递给表单字段的书签，](https://stackoverflow.com/questions/11024021/bookmarklet-to-pass-url-to-form-field)但这对我不起作用（页面根本没有改变）。我要填充的表单非常简单，只有 1 个请求 URL 的字段。

提前致谢！

# php - php foreach 在变量中添加 += 字符串返回 0

> ID：13895287
> 
> 赞同：-1
> 
> 时间：2012-12-15T19:10:09.487
> 
> 标签：php, sql, arrays, foreach

我已经创建了这个代码

```
 $cities = arrary('city1','city2','city3','city4','city5');

       $query = "SELECT * FROM data_entry WHERE ";

        foreach($cities as $city){

           $query += " AND city = '$city' ";

        }

        echo $query; 
```

此代码打印零

我想像这样制作 $query 输出

```
 SELECT * FROM data_entry WHERE city = 'city1' AND city = 'city2' .... etc. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-15T19:26:02.167

$cities = array('city1','city2','city3','city4','city5');

```
 $query = "SELECT * FROM data_entry WHERE ";

    foreach($cities as $key => $city){
      if($key ==0){
        $query .= " city = '$city' ";
       }
       else{
       $query .= " AND city = '$city' ";
       }
    }

    echo $query; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-15T19:40:58.863

```
 $cities = array('city1','city2','city3','city4','city5');

   $query = "SELECT * FROM data_entry WHERE city='"
          .implode("' AND city='", $cities)."'";

   echo $query; 
```

但是这个查询总是返回空结果，如果数组中有不同的城市，也许你需要选择查询如下：

```
$cities = array('city1','city2','city3','city4','city5');
$query = 'SELECT * FROM data_entry '
    .'WHERE city IN("'.implode('","',$cities).'")'; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T19:15:25.337

```
$query = "SELECT * FROM data_entry WHERE 1=1";
foreach($cities as $city){
    $query .= " AND city = '$city' ";
} 
```

不要忘记转义`$city`值以避免安全问题......（SQL注入）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-12-15T19:18:11.907

此代码应该可以工作：

```
$cities=array('city1','city2','city3','city4','city5');
$query="SELECT * FROM data_entry WHERE city='".$cities[0]."'";
foreach(array_slice($cities,1) as $city)
{
    $query.=" OR city='$city'";
}
echo $query; 
```

或者，从 didierc 的想法：

```
$cities=array('city1','city2','city3','city4','city5');
$query="SELECT * FROM data_entry WHERE city='".$cities[0].implode("' OR city='",array_slice($cities,1))."'";
echo $query; 
```

# javascript - chrome 扩展 tabAction 没有背景页面

> ID：13895291
> 
> 赞同：1
> 
> 时间：2012-12-15T19:10:27.993
> 
> 标签：javascript, google-chrome-extension

有没有办法为一个网站定义 pageAction？我看到了样本，它们都用于在该文件`background.js`中显示。`chrome.pageAction.show(tabId)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T21:03:47.227

要显示特定网站的 pageAction，有两种方法。

## 使用内容脚本

在特定网站上运行内容脚本，并向后台传递一条请求页面操作的消息：

```
// contentscript.js
chrome.extension.sendMessage('showPageAction');
// background.js
chrome.extension.onMessage.addListener(function(message, sender) {
    if (message == 'showPageAction') {
        chrome.pageAction.show(sender.tab.id);
    }
}); 
```

部分`manifest.json`：

```
"content_scripts": [{
    "js": ["contentscript.js"],
    "run_at": "document_start",
    "matches": ["http://example.com/"]
}] 
```

的有效值在文档[match patterns](http://developer.chrome.com/extensions/match_patterns.html)`matches`中完全定义。^(请注意，此示例中的匹配模式匹配)^(而不是)^。^(如果您想匹配网站上的任何内容，请使用)^(（附加星号）。)
^(`http://example.com/``http://example.com/index.html``http://example.com/*`)

## 使用`chrome.tabs`API

如果您不想使用内容脚本，可以使用`chrome.tabs`事件来显示页面操作：

```
// background.js
chrome.tabs.onUpdated.addListener(function(tabId, changeInfo, tab) {
    if (changeInfo.url == 'http://example.com/') {
        chrome.pageAction.show(tabId);
    }
}); 
```

我推荐使用内容脚本方法，除非您已经在使用[`chrome.tabs`](http://developer.chrome.com/extensions/tabs.html)API。为什么？如果您`"tabs"`在清单文件中请求权限，您的用户将在安装时看到以下警告：

> 安装`<name of your extension>`？
>   它可以访问：
>   **访问您的标签和浏览活动**

# linux - 如何将可移动媒体设为私有

> ID：13895294
> 
> 赞同：1
> 
> 时间：2012-12-15T19:10:56.843
> 
> 标签：linux

怎么可能装配一个系统，使得用户可以安装一些可移动媒体，如 USB 记忆棒，而不需要任何 root 权限，但又对该用户保密？我正在考虑一些多用户情况，例如学校或图书馆，那里有很多终端。我坐在终端前，插入我的 U 盘，挂载它，不需要任何特权，可以完全访问它，但它对我来说完全是私有的。我知道我可以在我的主目录中安装棒获得隐私，但我需要 root 权限才能进行安装。在 fstab 中，我可以使用 'user,noauto' 选项，它可以让我或其他任何人挂载 OTOH，然后，一旦挂载，任何人都可以看到病人。有什么方法可以使设备本身私有化吗？修改' 获取内容是不够的，因为其他用户仍然可以执行诸如写入新文件之类的操作。我认为这应该是可行的，但如果我能弄清楚的话，我该死的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T23:26:06.673

这个问题不在于可移动媒体，而在于文件系统。FAT 文件系统不支持单独的访问控制。

您可以通过在 fstab 中定义默认访问权限来解决您的问题。从手册页：

```
 umask=value
          Set the umask (the bitmask of  the  permissions  that  are  not
          present). The default is the umask of the current process.  The
          value is given in octal.

   dmask=value
          Set the umask applied to directories only.  The default is  the
          umask of the current process.  The value is given in octal.

   fmask=value
          Set  the  umask  applied to regular files only.  The default is
          the umask of the current process.  The value is given in octal. 
```

因此，例如“user,noauto,umask=077”应该剥夺其他任何人的所有权利，然后是执行挂载的用户。请注意，这已经是大多数系统上的默认 dmask！也许您的设置有问题。

# opengl-es - 使用 glDrawElements 绘制此数据时应该使用哪些参数？

> ID：13895298
> 
> 赞同：0
> 
> 时间：2012-12-15T19:11:33.033
> 
> 标签：opengl-es, indices

我正在尝试加载如下所示的层格式：

```
0.000000 0.000000 -1.543509 0.000000 0.000000 -1.000000 0.838731 0.300864 106 34 22
vertex pos/ normal dir/texture coords/ vertex color 
```

脸的定义是这样的：

```
3 0 1 2
how much vertices per face/ which vertex for x/ which vertex for y/which vertex for z/ 
```

然后我将它们读入一个顶点数组和一个面数组，像这样绘制它们：

```
//bind buffer first of course)
glDrawElements(GL_TRIANGLE_FAN,vert_amount,GL_UNSIGNED_INT,faces); 
```

我正在使用 opengles 1.1，所以我被 TRIANGLE_FAN 卡住了，我猜结果搞砸了，所以我猜默认的层面定义不适合 opengl 对吧？如果我想使用 glDrawElements 如何重新组织面孔？

这是层模型文件的简单立方体：

```
1.000000 1.000000 -1.000000 0.000000 0.000000 -1.000000
1.000000 -1.000000 -1.000000 0.000000 0.000000 -1.000000
-1.000000 -1.000000 -1.000000 0.000000 0.000000 -1.000000
1.000000 0.999999 1.000000 -0.000000 0.000000 1.000000
-1.000000 1.000000 1.000000 -0.000000 0.000000 1.000000
-1.000000 -1.000000 1.000000 -0.000000 0.000000 1.000000
1.000000 1.000000 -1.000000 1.000000 -0.000001 -0.000000
1.000000 0.999999 1.000000 1.000000 -0.000001 -0.000000
0.999999 -1.000001 1.000000 1.000000 -0.000001 -0.000000
1.000000 -1.000000 -1.000000 -0.000000 -1.000000 -0.000000
0.999999 -1.000001 1.000000 -0.000000 -1.000000 -0.000000
-1.000000 -1.000000 1.000000 -0.000000 -1.000000 -0.000000
-1.000000 -1.000000 -1.000000 -1.000000 0.000000 -0.000000
-1.000000 -1.000000 1.000000 -1.000000 0.000000 -0.000000
-1.000000 1.000000 1.000000 -1.000000 0.000000 -0.000000
1.000000 0.999999 1.000000 0.000000 1.000000 0.000000
1.000000 1.000000 -1.000000 0.000000 1.000000 0.000000
-1.000000 1.000000 -1.000000 0.000000 1.000000 0.000000
-1.000000 1.000000 -1.000000 0.000000 0.000000 -1.000000
0.999999 -1.000001 1.000000 -0.000000 0.000000 1.000000
1.000000 -1.000000 -1.000000 1.000000 0.000000 0.000000
1.000000 1.000000 -1.000000 1.000000 0.000000 0.000000
0.999999 -1.000001 1.000000 1.000000 0.000000 0.000000
-1.000000 -1.000000 -1.000000 -0.000000 -1.000000 0.000000
-1.000000 1.000000 -1.000000 -1.000000 0.000000 -0.000000
-1.000000 1.000000 1.000000 0.000000 1.000000 0.000000
3 0 1 2
3 3 4 5
3 6 7 8
3 9 10 11
3 12 13 14
3 15 16 17
3 18 0 2
3 19 3 5
3 20 21 22
3 23 9 11
3 24 12 14
3 25 15 17 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:21:39.217

GL_TRIANGLE_FAN 在这里是错误的原语 - 三角形扇形有一个由所有三角形共享的固定顶点。如果你只有三角形，GL_TRIANGLES 是更好的选择。如果没有，请考虑进行三角测量，或者以其他方式构建三角形条带。

# c++ - 正确使用 MPI 和 std::string

> ID：13895299
> 
> 赞同：2
> 
> 时间：2012-12-15T19:11:35.287
> 
> 标签：c++, c++11, mpi

`std::string`使用mpi send 和 mpi recv 命令的正确方法是什么？

我有一个主从模型设置，其中主从首先从数据库加载相当大量的字符串，我将它们存储在`vector<string>`容器中的内存中，然后我想一次将它们发送给从属以计算文本分析。我最初编写文本分析函数以接受字符串作为输入参数。

我是否应该让主服务器将字符串转换`const char*`为从服务器将其转换回字符串以进行计算？还是我应该只发送字符串`s.c_str()`作为消息缓冲区？有没有更好的方法来做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T02:34:38.877

您必须首先将向量/字符串的大小发送到从属进程。然后您可以在从属进程中分配所需的内存。在第二遍中，您可以再次发送所有向量。

# ios - “调整”我当前的 UISwipeGestureRecognizer 代码，用于使用 UIPanGestureRecognizer 将图像轻拂到 iPhoto 样式

> ID：13895301
> 
> 赞同：1
> 
> 时间：2012-12-15T19:12:08.560
> 
> 标签：ios, uiimageview, drag, uipangesturerecognizer, uiswipegesturerecognizer

**我使用以下代码使用UISwipeGestureRecognizer**左右滑动，以类似于 iPhoto 的方式在我的应用程序中显示照片。

```
 CATransition *animation = [CATransition animation];
    [animation setDuration:0.5];
    [animation setType:kCATransitionPush];
    [animation setSubtype:kCATransitionFromRight];
    [animation setTimingFunction:[CAMediaTimingFunction functionWithName:kCAMediaTimingFunctionEaseInEaseOut]];
    [[self.imageHolder layer] addAnimation:animation forKey:@"SwitchToView"]; 
```

这会将下一张图像滑入并滑出旧图像，如下图所示：

图一：

![图一](../Images/cff099261a3d3254ab721d7d1a0e92ee.png)

过渡：

![过渡视图](../Images/a087828e3530c73830fde7646613a98b.png)

图二：

![图二](../Images/97edfb8e08989a7dc99fbfa9fd0cd23d.png)

当我突然意识到我应该使用**UIPanGestureRecognizer**时，我想知道如何让它像 iPhoto 一样。

我需要像 iPhoto 那样用手指“控制”动画，即允许我开始拖动到下一张图像，然后反转拖动方向。此外，以与 iPhoto 类似的方式，如果在显示的下一张图像比第一张图像更多时松开手指，我希望下一张图像滑入（这在上面的过渡图片中没有发生，如果我释放我的手指此时在 iPhoto 中它会滑回第一张图像。

我以前从未使用过**UIPanGestureRecognizer**，所以如果有人可以帮助我，那就太好了。

编辑：

使用**Levi**提供的代码，我创建了一个适用于 3 个示例图像的解决方案。对于任何有兴趣使用**UIPanGestureRecognizer**的人，代码是：

界面：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <UIGestureRecognizerDelegate>
{
int imageIndex;
}

@property (nonatomic, strong) UIImageView* imageView;
@property (nonatomic, strong) UIImageView* leftImageView;
@property (nonatomic, strong) UIImageView* rightImageView;

@end 
```

执行：

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
[super viewDidLoad];

self->imageIndex = 0;

float xFactor;

UIInterfaceOrientation currentOrientation = self.interfaceOrientation;
if(UIInterfaceOrientationIsLandscape(currentOrientation)){

    xFactor = 256;

}
else{

    xFactor = 0;

}

self.imageView = [[UIImageView alloc] initWithFrame:self.view.frame];
self.imageView.contentMode = UIViewContentModeScaleAspectFit;
self.imageView.image = [UIImage imageNamed:@"69B4356B-1CB2-4A2F-867E-9C086251DF11-12668-0000036A534E9B6D"];
self.imageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

CGRect leftFrame = self.view.frame;
leftFrame.origin.x -= leftFrame.size.width+xFactor;
self.leftImageView = [[UIImageView alloc] initWithFrame:leftFrame];
self.leftImageView.contentMode = UIViewContentModeScaleAspectFit;
self.leftImageView.image = [UIImage imageNamed:@"42517D93-F8BF-42E7-BB44-53B099A482AA-12668-0000036A49BCECAA"];
self.leftImageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

CGRect rightFrame = self.view.frame;
rightFrame.origin.x += rightFrame.size.width+xFactor;
self.rightImageView = [[UIImageView alloc] initWithFrame:rightFrame];
self.rightImageView.contentMode = UIViewContentModeScaleAspectFit;
self.rightImageView.image = [UIImage imageNamed:@"C6AC2508-243B-464B-A71F-96DD7F18673D-12668-00000369F3AFD3FC"];
self.rightImageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

[self.view addSubview:self.imageView];
[self.view addSubview:self.leftImageView];
[self.view addSubview:self.rightImageView];

UIPanGestureRecognizer *recognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan:)];
[self.view addGestureRecognizer:recognizer];
}

- (void)didReceiveMemoryWarning
{
[super didReceiveMemoryWarning];

}

- (void)handlePan:(UIPanGestureRecognizer *)recognizer {
if (recognizer.state == UIGestureRecognizerStateEnded) {
    CGRect leftFrame = self.leftImageView.frame;
    CGRect currentFrame = self.imageView.frame;
    CGRect rightFrame = self.rightImageView.frame;

    float duration = 0.0;

    float factor;

    UIInterfaceOrientation currentOrientation = self.interfaceOrientation;
    if(UIInterfaceOrientationIsPortrait(currentOrientation)){

        factor = 768;
    }
    else{
        factor = 1024;
    }

    if (self.imageView.center.x < 0) { // Present the right image
        duration = 0.3 * ABS(self.rightImageView.frame.origin.x / factor);
        leftFrame.origin.x = -2 * factor;
        currentFrame.origin.x = -1 * factor;
        rightFrame.origin.x = 0;
        self->imageIndex = 1;

    } else if (self.imageView.center.x > factor) { // Present the left image
        duration = 0.3 * ABS(self.leftImageView.frame.origin.x / factor);
        leftFrame.origin.x = 0;
        currentFrame.origin.x = factor;
        rightFrame.origin.x = 2 * factor;
        self->imageIndex = -1;

    } else { // leave the middle image
        duration = 0.3 * ABS(self.imageView.frame.origin.x / factor);
        leftFrame.origin.x = -1 * factor;
        currentFrame.origin.x = 0;
        rightFrame.origin.x = factor;
        self->imageIndex = 0;

    }

    [UIView animateWithDuration:duration
                          delay:0
                        options:UIViewAnimationOptionCurveEaseInOut
                     animations:^{
                         self.leftImageView.frame = leftFrame;
                         self.imageView.frame = currentFrame;
                         self.rightImageView.frame = rightFrame;
                     } completion:^(BOOL finished) {
                     }];

} else {
    CGPoint translation = [recognizer translationInView:recognizer.view];
    CGPoint leftCenter = self.leftImageView.center;
    CGPoint currentCenter = self.imageView.center;        
    CGPoint rightCenter = self.rightImageView.center;

    leftCenter.x += translation.x;
    currentCenter.x += translation.x;
    rightCenter.x += translation.x;
    self.leftImageView.center = leftCenter;
    self.imageView.center = currentCenter;
    self.rightImageView.center = rightCenter;

    [recognizer setTranslation:CGPointMake(0, 0) inView:self.imageView];
}

}

- (void)willAnimateRotationToInterfaceOrientation:
(UIInterfaceOrientation)toInterfaceOrientation
                                     duration:(NSTimeInterval)duration
{ 
CGPoint leftCenter = self.leftImageView.center;
CGPoint currentCenter = self.imageView.center;
CGPoint rightCenter = self.rightImageView.center;

if(UIInterfaceOrientationIsPortrait(toInterfaceOrientation)){

    leftCenter.x = 384+(((-self->imageIndex)-1)*768);
    currentCenter.x = 384+((-self->imageIndex)*768);
    rightCenter.x = 384+(((-self->imageIndex)+1)*768);

}
else{

    leftCenter.x = 512+(((-self->imageIndex)-1)*1024);
    currentCenter.x = 512+((-self->imageIndex)*1024);
    rightCenter.x = 512+(((-self->imageIndex)+1)*1024);

}

self.leftImageView.center = leftCenter;
self.imageView.center = currentCenter;
self.rightImageView.center = rightCenter;

}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:45:14.140

如果您想要像照片应用程序这样的滚动行为，则根本不应该使用 a `UIGestureRecognizer`。使用 a `UIPageViewController`with `UIPageViewControllerTransitionStyleScroll`，或者如果您需要支持低于 iOS6 的版本，使用 a `UIScrollView`。

查看 Apple 的示例项目[PhotoScroller](http://developer.apple.com/library/ios/#samplecode/PhotoScroller/Introduction/Intro.html)以获取使用`UIScrollView`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:50:09.333

您可以添加一个`UIPanGestureRecognizer`到您的图像视图。您将有一个分配给它的方法，您可以在其中执行以下操作：

```
- (void)handlePan:(UIPanGestureRecognizer *)recognizer {
    if (recognizer.state == UIGestureRecognizerStateEnded) {

    } else {
        CGPoint translation = [recognizer translationInView:recognizer.view];
        CGPoint center = recognizer.view.center;
        UIImageView *imageViewToPresent = nil;
        if (translation.x > 0) {
            imageViewToPresent = [self leftImageView];
        } else {
            imageViewToPresent = [self leftImageView];
        }
        CGPoint actualCenter = recognizer.view.center;
        CGPoint nextCenter = imageViewToPresent.center;
        actualCenter.x += translation.x;
        nextCenter.x += translation.x;
        recognizer.view.center = actualCenter;
        imageViewToPresent.view.center = nextCenter;
        [recognizer setTranslation:CGPointMake(0, 0) inView:self.imageView];
    }
} 
```

在该`UIGestureRecognizerStateEnded`部分中，您可以决定显示哪张图片。

或者只使用启用分页的 ScrollView。它应该具有相同的效果。但是，它需要同时加载所有图像。使用平移识别器，您需要 3 个顶部图像视图（左、右、当前）。

希望这可以帮助！

编辑：

在头文件中，您应该再添加 2 个图像视图：

```
#import <UIKit/UIKit.h>

@interface ViewController : UIViewController <UIGestureRecognizerDelegate>

@property (nonatomic, strong) UIImageView* imageView;
@property (nonatomic, strong) UIImageView* leftImageView;
@property (nonatomic, strong) UIImageView* rightImageView;

@end 
```

实施将是：

```
#import "ViewController.h"

@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad
{
    [super viewDidLoad];

    self.imageView = [[UIImageView alloc] initWithFrame:self.view.frame];
    self.imageView.contentMode = UIViewContentModeScaleAspectFit;
    self.imageView.image = [UIImage imageNamed:@"69B4356B-1CB2-4A2F-867E-9C086251DF11-12668-0000036A534E9B6D"];
    self.imageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

    CGRect leftFrame = self.view.frame;
    leftFrame.origin.x -= leftFrame.size.width;
    self.leftImageView = [[UIImageView alloc] initWithFrame:leftFrame];
    self.leftImageView.contentMode = UIViewContentModeScaleAspectFit;
    self.leftImageView.image = [UIImage imageNamed:@"42517D93-F8BF-42E7-BB44-53B099A482AA-12668-0000036A49BCECAA"];
    self.leftImageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

    CGRect rightFrame = self.view.frame;
    rightFrame.origin.x += rightFrame.size.width;
    self.rightImageView = [[UIImageView alloc] initWithFrame:rightFrame];
    self.rightImageView.contentMode = UIViewContentModeScaleAspectFit;
    self.rightImageView.image = [UIImage imageNamed:@"C6AC2508-243B-464B-A71F-96DD7F18673D-12668-00000369F3AFD3FC"];
    self.rightImageView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight;

    [self.view addSubview:self.imageView];
    [self.view addSubview:self.leftImageView];
    [self.view addSubview:self.rightImageView];

    UIPanGestureRecognizer *recognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(handlePan:)];
    [self.view addGestureRecognizer:recognizer];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];

}

- (void)handlePan:(UIPanGestureRecognizer *)recognizer {
    if (recognizer.state == UIGestureRecognizerStateEnded) {
        CGRect leftFrame = self.leftImageView.frame;
        CGRect currentFrame = self.imageView.frame;
        CGRect rightFrame = self.rightImageView.frame;
        float duration = 0.0;
        if (self.imageView.center.x < 0) { // Present the right image
            duration = 0.3 * ABS(self.rightImageView.frame.origin.x / self.view.frame.size.width);
            leftFrame.origin.x = -2 * self.view.frame.size.width;
            currentFrame.origin.x = -1 * self.view.frame.size.width;
            rightFrame.origin.x = 0;
        } else if (self.imageView.center.x > self.view.frame.size.width) { // Present the left image
            duration = 0.3 * ABS(self.leftImageView.frame.origin.x / self.view.frame.size.width);
            leftFrame.origin.x = 0;
            currentFrame.origin.x = self.view.frame.size.width;
            rightFrame.origin.x = 2 * self.view.frame.size.width;
        } else { // leave the middle image
            duration = 0.3 * ABS(self.imageView.frame.origin.x / self.view.frame.size.width);
            leftFrame.origin.x = -1 * self.view.frame.size.width;
            currentFrame.origin.x = 0;
            rightFrame.origin.x = self.view.frame.size.width;
        }

        [UIView animateWithDuration:duration
                              delay:0
                            options:UIViewAnimationOptionCurveEaseInOut
                         animations:^{
            self.leftImageView.frame = leftFrame;
            self.imageView.frame = currentFrame;
            self.rightImageView.frame = rightFrame;
        } completion:^(BOOL finished) {
        }];
    } else {
        CGPoint translation = [recognizer translationInView:recognizer.view];
        CGPoint currnetCenter = self.imageView.center;
        CGPoint leftCenter = self.leftImageView.center;
        CGPoint rightCenter = self.rightImageView.center;

        currnetCenter.x += translation.x;
        leftCenter.x += translation.x;
        rightCenter.x += translation.x;
        self.imageView.center = currnetCenter;
        self.leftImageView.center = leftCenter;
        self.rightImageView.center = rightCenter;

        [recognizer setTranslation:CGPointMake(0, 0) inView:self.imageView];
    }

}

@end 
```

当然，它仍然需要工作（例如，支持超过 3 个硬编码图像）。如果您使用 IBOutlets 并从 Interface Builder 设置自动调整大小的掩码，它可能会帮助您解决旋转问题。

玩得开心！

# linux - Ubuntu 12.04 上的 Aptana 3 无法启动

> ID：13895305
> 
> 赞同：2
> 
> 时间：2012-12-15T19:12:45.520
> 
> 标签：linux, aptana, ubuntu-12.04

我在 Ubuntu 12.04 上下载了最新的 Aptana studio，但它没有启动。当尝试从命令行启动它时，它说：

> ./AptanaStudio3：kan een binair bestand niet uitvoeren。（荷兰语）

这意味着“无法运行二进制文件”。

运行 AptanaStudio3.sh 时，它说：

> ./AptanaStudio3：语法错误：“（”意外

这是一个错误还是我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T23:14:36.667

为 Linux 上传的 Aptana Studio 版本不正确（64 位与 32 位）存在问题。它已在最新更新中得到纠正。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T13:07:11.623

您可以尝试在 32 位操作系统上执行 64 位版本。使用 'file AptanaStudio3' 检查是否为 64 位版本。

# perl - 谁在和 Moose 通话？

> ID：13895306
> 
> 赞同：1
> 
> 时间：2012-12-15T19:12:46.903
> 
> 标签：perl, moose

我正在尝试编写一个记录器角色（使用 Log::Dispatchouli，但这不重要），它告诉我来自哪个包、子、行等。我一直在发出日志消息。自然地，我尝试了调用者，但堆栈中充满了 Moose 类，并且帧数在不同情况下会发生变化。有没有办法使用 MOP 或 Moose 获得类似的信息？或者也许有一个模块来过滤调用者堆栈？非常感谢！

```
package logger

sub log {...}

#some_package
log "bla"

#intended output
some_package l.12 bla 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T21:35:25.070

您可以使用[Carp 的 longmess 函数](http://perldoc.perl.org/Carp.html)来生成堆栈跟踪。它的文档记录很差，但它已经存在了很长时间并且使用起来非常安全。 `cluck`并且分别`confess`是公正`warn longmess`的`die longmess`。

使用的优点`longmess()`是[Carp 有几个全局变量](http://perldoc.perl.org/Carp.html#GLOBAL-VARIABLES)来控制它认为是“内部”的内容。这有效地阻止了它们出现在堆栈跟踪中。你关心的两个是`@CARP_NOT`和`%Carp::Internal`。您应该使用哪个取决于您的日志记录方式。

`@CARP_NOT`仅影响源自 set 的包的堆栈跟踪`@CARP_NOT`。所以你可以这样写你的记录器：

```
package MyLogger;

use Carp;
our @CARP_NOT = qw(MyLogger Moose More::Moose::Stuff);

sub trace {
    # For example...
    warn Carp::longmess("Trace message");
} 
```

`MyLogger::trace()`应该报告一条跟踪消息，但忽略它本身、Moose 以及您放入的任何其他内容`@CARP_NOT`。

`%Carp::Internal`有点像这个的全球版本。如果您无法将 Carp 函数的调用位置集中到日志记录包中，则可以将包添加到`%Carp::Internal`. 不幸的是，这是全局的，并且存在设置全局变量的所有问题。如果您要弄乱它，请务必将包添加到它，例如`$Carp::Internal{"Some::Module"}++`. 不要像`%Carp::Internal = ("Some::Module" => 1)`.

# php - 没有收到PHP邮件？

> ID：13895311
> 
> 赞同：1
> 
> 时间：2012-12-15T19:13:33.767
> 
> 标签：php, forms, email, hotmail

> **可能重复：**
> [hotmail.com 未收到邮件](https://stackoverflow.com/questions/13324649/mail-not-being-received-by-hotmail-com)

我的网站上有这个简单的表格，当它发送到我的 Hotmail 帐户时，我没有收到电子邮件，甚至没有收到垃圾文件夹。

这是表单代码：

```
<form action="mail.php" method="POST">
    <p><label title="Name">Name:</label><br />
        <input type="text" name="name" autocomplete="on" required="required"></p>
    <p><label title="Email">Email:</label><br />
        <input type="text" name="email" autocomplete="on" required="required"></p>
    <p><label title="About">My message is about...</label><br />
        <select name="about">
            <option value="general">General Query</option>
            <option value="wedding">Wedding</option>
            <option value="corporate">Corporate Event or Trade Show</option>
            <option value="other">Other Event</option>
        </select>
    <p><label title="Message">Message:</label><br />
        <textarea name="message" rows="6" cols="25" required="required"></textarea></p>
    <input type="submit" value="Send">
</form> 
```

和 mail.php 文件：

```
<?php 
        $name = $_POST['name'];
        $email = $_POST['email'];
        $message = $_POST['message'];
        $about = $_POST['about'];
        $formcontent="From: $name \n About: $about \n Message: $message";
        $recipient = "MyEmailAddress@Live.co.uk";
        $subject = "Contact Form";
        $mailheader = "Reply-To: $email \r\n";
    mail($recipient, $subject, $formcontent, $mailheader) or die("Error!");
    echo "Thank You!";
?> 
```

我最终确实看到了一个带有“谢谢！”的页面。显示但未收到电子邮件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:31:38.113

邮件递送是一项棘手的业务……仅仅因为您发送邮件并不意味着任何人都会收到它。如果传入的邮件不符合某些标准，许多接收服务器会简单地忽略它（根据我的经验，Gmail 和 Hotmail 特别容易默默地拒绝传递，因此它甚至不会成为垃圾邮件）。有几件事可以确保您已完成：

1) 您在 DNS 记录中设置了 PTR/ [SPF](http://www.openspf.org/)（反向查找）条目

2) 确保您不在任何黑名单上 ( [http://www.mxtoolbox.com/blacklists.aspx](http://www.mxtoolbox.com/blacklists.aspx) )

3）展开你的标题

```
$headers = "MIME-Version: 1.0\r\n"
          ."Content-Type: $contentType; charset=utf-8\r\n"
          ."Content-Transfer-Encoding: 8bit\r\n"
          ."From: =?UTF-8?B?". base64_encode("Your sending display name") ."?= <$from>\r\n"
          ."Reply-To: $replyTo\r\n"
          ."X-Mailer: PHP/". phpversion(); 
```

但是，如果您真的想确保邮件通过，请[通过 SMTP](http://pear.php.net/package/Mail/redirected)发送邮件。您永远无法保证邮件的传递，但它会更加可靠。如果您不发送大量邮件，您可以尝试使用[Mandrill](http://mandrill.com/)或类似服务为您中继电子邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:40:02.980

您可以使用以下方法。成功时返回 true。

```
function sendMail($email, $subject, $message)
{
    $supportEmail = 'info@abc.com';
    $from = 'Abc';
    $msg  = $message;
    $from = str_replace(' ', '-', $from);
    $frm  = $from.' <'.$supportEmail.'>';
    preg_match("<(.*)@(.*\..*)>", $frm, $match);

    ///////////////////Headers/////////////////
    $hdr='';
    $hdr.='MIME-Version: 1.0'."\n";
    $hdr.='content-type: text/html; charset=iso-8859-1'."\n";
    $hdr.="From: {$frm}\n";
    $hdr.="Reply-To: {$frm}\n";
    $hdr.="Message-ID: <".time()."@{$match[2]}>\n";
    $hdr.='X-Mailer: PHP v'.phpversion();
    $x=@mail($email, $subject, $msg, $hdr);
    if($x==0)
    {
        $email=str_replace('@','\@', $email);
        $hdr=str_replace('@','\@',$hdr);
        $x=@mail($email, $subject, $msg, $hdr);
    }
    return $x;
} 
```

# antlr3 - antlr3：在不同的上下文中区分相同的字符

> ID：13895312
> 
> 赞同：1
> 
> 时间：2012-12-15T19:13:35.047
> 
> 标签：antlr3

我需要从这里翻译简单的文本

```
Some title - possibly with dashes inside
---
other text 
```

对此：

```
<h1>Some title - possibly with dashes inside</h1>
<div>other text</div> 
```

换句话说，单独一行上的一个或多个破折号将标题与其他文本分开

我做了这个语法：

```
grammar Foo;
options { output=template; }

text : t+=title? -> lesson(title={$t}) ;

title : PLAIN_TEXT titleSeparator -> title(txt={$PLAIN_TEXT.text});

titleSeparator : NL '-'+ NL ;

PLAIN_TEXT : LETTER+ ;
NL  : '\r'? '\n' ;

fragment LETTER : 'a'..'z' | '-' | ' '; 
```

尽管抛出警告，但语法会产生正确的输出：第 2:0 行不匹配输入 '--' 期望 '-'。我在这里看到了一个关于这个问题的问题，但它对我没有帮助。

我觉得我错过了一些东西，但无法得到确切的东西。

我需要的是一种语法，它可以区分文本中的单独破折号和由几个破折号组成的行

提前致谢

# android - Twitter4j TwitterStream 停止/关闭

> ID：13895319
> 
> 赞同：3
> 
> 时间：2012-12-15T19:14:33.770
> 
> 标签：android, twitter, twitter4j, twitter-streaming-api

我有一个`TwitterStream`以 Twitter4j 开头的 Android 应用程序，如果我不再需要流，我正在寻求有关如何停止/关闭它的帮助。我在偏好更改时启动流，但需要根据用户操作在我的应用程序的其他部分停止它。

这是我启动流的方式，这是我在文档中找到的典型方式：

```
ConfigurationBuilder cb = new ConfigurationBuilder();

cb.setDebugEnabled(true);

cb.setOAuthConsumerKey(A);

cb.setOAuthConsumerSecret(B);

cb.setOAuthAccessToken(C);

cb.setOAuthAccessTokenSecret(D));

TwitterStream twitterStream = new TwitterStreamFactory(cb.build()).getInstance();
StatusListener listener = new StatusListener() {

    @Override
    public void onDeletionNotice(StatusDeletionNotice arg0) {

    }
    .
    .   
    .

};
FilterQuery fq = new FilterQuery();
fq.follow(new long[]{X});

twitterStream.addListener(listener);
twitterStream.filter(fq); 
```

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-04T08:10:05.530

您可以通过以下命令停止流：

```
twitterStream.cleanUp(); // shutdown internal stream consuming thread
twitterStream.shutdown(); // Shuts down internal dispatcher thread shared by all TwitterStream instances. 
```

您可以从以下链接查看 api 以了解 api 的详细信息。 [http://twitter4j.org/javadoc/twitter4j/TwitterStream.html](http://twitter4j.org/javadoc/twitter4j/TwitterStream.html)

# xcode - xcode 中的选项卡式应用程序问题

> ID：13895321
> 
> 赞同：0
> 
> 时间：2012-12-15T19:15:08.313
> 
> 标签：xcode

我正在使用 xcode 中的第一个选项卡式应用程序。我只是在测试一些东西，因为我对编程比较陌生。我只是使用已经放入模板的 2 个视图。我将滑块放入第一个视图，并将其附加到带有数字的文本框。但这不是问题！这可能真的很愚蠢和简单，但是当我运行应用程序只是为了查看模拟器上的内容时，它只是显示黑屏。不知道为什么！但它杀了我，并希望得到一些帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T22:50:10.120

您不应该在 AppDelegate 中建立连接。您应该为每个类使用一个 ViewController。IE FirstViewController、SecondViewController。AppDelegate 通常只用于调用保存/恢复消息。

您收到错误是因为情节提要视图假设您将其分配给正确的视图。当您创建故事板时说您将其命名为 TestApp。然后，你应该有几节课。TestAppDelegate、TestAppDelegateFirstViewController、TestAppDelegateSecondViewController。或类似的规定。FirstViewController 应该连接到选项卡视图上的第一个视图。第二个应该附加到第二个。

AppDelegate 几乎从不用于 UI。我建议你找一本关于这个问题的书。我会建议“iOS 编程。大书呆子牧场指南”。当我开始时，它对我帮助很大。

照片示例：

![自定义类的示例](../Images/97a678430e4493bd61305e551375aea9.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-13T15:19:01.947

我确实最终开始了一个新项目。奇怪的是黑屏出现了..不确定为什么会弹出这个错误..我对程序可能存在的不同错误和错误还不是很了解！虽然越来越近了！

# security - Qemu/KVM：来宾之间的保护

> ID：13895322
> 
> 赞同：1
> 
> 时间：2012-12-15T19:15:20.293
> 
> 标签：security, qemu, kvm, libvirt, apparmor

在[http://libvirt.org/drvqemu.html#securitysvirtaa](http://libvirt.org/drvqemu.html#securitysvirtaa)上，它说 Apparmor 没有来宾之间的保护。当我在具有活动 apparmor 的 ubuntu 下使用 libvirt 来启动来宾时，它会自动为每个来宾创建策略文件。它们是否意味着特定于过程的保护？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:18:51.277

Apparmor 默认仅包括保护主机免受访客危害。带有 libvirt 的 Apparmor 增加了额外的安全保护来保护客人免受彼此的伤害。看到[这个](http://wiki.apparmor.net/index.php/Libvirt)和[这个](http://libvirt.org/drvqemu.html)。

# css - 精灵出现在按钮上的问题

> ID：13895324
> 
> 赞同：0
> 
> 时间：2012-12-15T19:15:37.920
> 
> 标签：css, button, css-sprites, sprite, submit-button

我已经尝试了很多东西，我无法弄清楚为什么精灵没有出现。按钮有 3 种状态：正常、悬停和活动。

```
#continue_btn {
    float: right;
    margin-right: 15px;
    width: auto;
    width: 229px;
    height: 43px;
    background-image:url(_img/continue_btn.png);
    background-repeat: no-repeat; 
    float: none;
    margin-left: -23px;
    margin-bottom: 12px;
    border-radius: 8px;    
    }
#continue_btn a{
    background: url(_img/button_sprite.png) 0 0 no-repeat -13px -11px;
    width: 229px;
    height: 43px;
}

continue_btn a:hover {
    background: url(_img/button_sprite.png) 0 0 no-repeat -14px -58px;
    width: 229px;
    height: 43px;
}
continue_btn a:active {
    background: url(_img/button_sprite.png) 0 0 no-repeat -14px -106px;
    width: 229px;
    height: 43px;
} 
```

[你可以在这里看到它](http://www.myproduction-1.info/jquery_tools_org_css/index_closebutton.html)（点击左上角的用户输入按钮）。[这是精灵](http://www.myproduction-1.info/jquery_tools_org_css/_img/button_sprite.png)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:27:59.440

首先，您忘记了最后两个声明中的前导哈希。

其次，在您的 html`#continue_btn`中是输入元素，但是在您的 css 中，您为一些嵌套`a`标签定义了背景，这些标签在您的输入字段中不存在（并且不能，因为输入不是[块](http://en.wikipedia.org/wiki/HTML_element#Block_elements)而是[内联](http://en.wikipedia.org/wiki/HTML_element#Inline_elements)元素）。

第三，我应该删除属性中的奇怪`0 0`声明`background`，它不适合方案。

第四，`_img/button_sprite.png`指向错误的方向。您的案例的网址是`../_img/button_sprite.png`.

最后，我认为你需要这样的东西：

```
#continue_btn {
    background: url(../_img/button_sprite.png) no-repeat -13px -11px;
    width: 229px;
    height: 43px;
}

#continue_btn:hover {
    background: url(../_img/button_sprite.png) no-repeat -14px -58px;
    width: 229px;
    height: 43px;
}
#continue_btn:active {
    background: url(../_img/button_sprite.png) no-repeat -14px -106px;
    width: 229px;
    height: 43px;
} 
```

# java - 将外键添加到 Java DB

> ID：13895331
> 
> 赞同：-6
> 
> 时间：2012-12-15T19:16:26.830
> 
> 标签：java, netbeans

如何在**Java DB中添加****外键**？

 *** * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:35:05.283

以下是在 MySQL 中更改表的方法：

[https://dev.mysql.com/doc/refman/5.5/en/alter-table.html](https://dev.mysql.com/doc/refman/5.5/en/alter-table.html)

您不会说使用 JDBC 连接到哪个数据库。

你只需要`executeUpdate()`在有问题的桌子上。我不会使用 Java 来做到这一点。只需使用管理工具。**

# wpf - WPF Canvas - 类似拆分视图的 Visual Studio

> ID：13895334
> 
> 赞同：4
> 
> 时间：2012-12-15T19:16:42.517
> 
> 标签：wpf, canvas, view, split

我正在开发一个应用程序，它在 wpf 画布中显示巨大的（10000 多个元素）图表。我想要一个像 Visual Studio 中的功能，当您可以拆分编辑器的视图时（这样我可以同时查看同一个图表的两个遥远部分）。

我有一些限制：

*   图元素的数据绑定（创建绑定）使得大图的加载非常慢，所以我没有使用 MVVM，“VM”知道视图并在需要时直接更新它
*   画布的子元素是框架元素，因为我使用 Tag 属性
*   由于图形元素的数量，我不想为拆分视图的两个部分的每个元素保留两个不同的视图

所以它应该就像在不同的地方显示同一画布的多个部分。您不能在 WPF 中为 FrameworkElements 设置两个父级，因此最简单的方法是毫无疑问的 :(

我有哪些选择？我应该重新考虑我的限制还是有一些解决方法？

如果您需要更多详细信息，请告诉我（这是一个大型应用程序，因此我无法为您提供所有信息）。

**编辑**：由于我需要正确的输入事件通知，所以不能使用视觉画笔进行复制，因此两个视图都必须是可编辑的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:20:57.527

选项：

*   将相同的数据绑定到两个控件。
*   使用视觉画笔并在真实控件上复制输入。
*   创建一个自定义图形控件，可以一次输出图形的两个部分。

如果绑定到两个控件太慢，那么我认为您需要重新考虑您的应用程序。一次显示的数据如此之多，以至于您需要双视图才能看到单独的部分，这一事实令人不安。这应该引发一个危险信号。危险信号会通知您，“我需要什么，我拥有什么是不同的。” 你应该回到绘图板上，找出你真正需要的东西。

否则，最好创建一个自定义控件。即使您只需要显示一小部分，该图也会完整呈现。如果您有自己的自定义控件，则可以通过一次仅渲染可见部分并在控件内拆分来加速整个应用程序。

# html - 表奇偶 td 与多色

> ID：13895335
> 
> 赞同：1
> 
> 时间：2012-12-15T19:16:45.817
> 
> 标签：html, css

[我有一张用 CSS 样式的表格，带有 even 和 odd](http://jsfiddle.net/UFG2n/1/)。`td`偶数/奇数 CSS 代码：

```
#table_box tr:nth-child(odd) td { background-color:#ffffff } /*odd*/
#table_box tr:nth-child(even) td { background-color:#f5f9fa } /* even*/
#table_box tr:hover td { background-color:#fffbae; } /* hovering */ 
```

![在此处输入图像描述](../Images/2207a76a398f2f1344e8fad29fc75879.png)

我想要多偶/奇颜色行样式，如下图所示：
![在此处输入图像描述](../Images/e31bdcb88f41281d1bb959b3c5265563.png)

我可以用 CSS 做到这一点吗？我试图这样做，但颜色不显示，只是偶数/奇数样式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:32:14.617

使用此片段：
HTML 更改：

```
 <tr>
                <td class="blueh2">1</td>
                <td class="blueh2">&#1777;&#1779;&#1785;&#1777;/&#1776;&#1780;/&#1779; &#1776;&#1785;:&#1780;&#1785;:&#1780;&#1783;</td>
                <td class="blueh2">&#1777;&#1779;&#1785;&#1777;/&#1776;&#1780;/&#1779; &#1777;&#1778;:&#1777;&#1785;:&#1780;&#1776;</td>
                <td class="greenh2">2.5</td>
                <td class="greenh2">2.5</td>
                <td class="purpleh2">6.75MB</td>
                <td class="purpleh2">54.13MB</td>
                <td class="purpleh2">60.87MB</td>
                <td class="purpleh2">60.87MB</td>
            </tr> 
```

CSS 更改：

```
#table_box tr:nth-child(odd) td { background-color:#ffffff } /*odd*/
#table_box tr:nth-child(even) td.greenh2 { background-color:#f00} /* even*/
#table_box tr:nth-child(even) td.blueh2 { background-color:#0f0} /* even*/
#table_box tr:nth-child(even) td.purpleh2 { background-color:#00f} /* even*/
#table_box tr:hover td { background-color:#fffbae; } /* hovering */

th.grey{
color:#7c7c7c!important;
}
th.blueh{
background-color:#174797;
color:#FFF!important;
}
th.blueh2{
background-color:#5492cf;
color:#FFF!important;
padding:3px!important;
}
th.greenh{
background-color:#579f0f;
color:#FFF!important;
}
th.greenh2{
background-color:#a4dd4f;
color:#FFF!important;
padding:3px!important;
}
th.purpleh{
background-color:#8e04ca;
color:#FFF!important;
}
th.purpleh2{
background-color:#d984fd;
color:#FFF!important;
padding:3px!important;
} 
```

您需要对其进行更多调整以适应您想要的输出，但我想总体思路很清楚。
如果需要，您也可以使用纯 CSS 来完成此操作，而无需更改 HTML 代码：

```
#table_box tr:nth-child(odd) td { background-color:#ffffff } /*odd*/
#table_box tr:nth-child(even) td:nth-child(1) { background-color:#f00} /* even*/
#table_box tr:nth-child(even) td:nth-child(2) { background-color:#0f0} /* even*/
#table_box tr:nth-child(even) td:nth-child(3) { background-color:#00f} /* even*/
#table_box tr:hover td { background-color:#fffbae; } /* hovering */ 
```

等等

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:03:51.483

看一下[`<colgroup>`](http://www.w3schools.com/tags/tag_colgroup.asp)标签。

# android - 将文件从资产文件夹复制到应用程序私有/数据/数据文件夹和chmod？

> ID：13895339
> 
> 赞同：0
> 
> 时间：2012-12-15T19:17:32.547
> 
> 标签：android

我的应用程序资产文件夹中有一个名为 flash_image 的文件。

我想将其复制到我的应用程序私有数据文件夹中，并使其可执行（如果这有帮助，我的应用程序将以 root 权限运行）。

所以，我希望该文件位于`/data/data/com.liamwli.flash/flash_image`并具有该文件可执行文件。

我尝试了很多我在网上找到的方法，但我无法让它发挥作用。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-12-15T20:49:28.400

如果您想在 /data 文件夹中保存一些数据，那么您确实希望将数据保存在设备内部存储器中。看看这个：[Android 开发者存储选项链接](http://developer.android.com/guide/topics/data/data-storage.html#filesInternal)。也尝试将模式更改为 Context.MODE_WORLD_READABLE。我希望这会以某种方式引导你。

# android - 我在 onCreat() 方法中得到 ClassCastException？

> ID：13895348
> 
> 赞同：-2
> 
> 时间：2012-12-15T19:18:23.827
> 
> 标签：android

我想改变视图的高度和宽度，（可能是按钮视图、图像视图、线性布局、框架布局或任何类型的视图）。我使用方法 traverseRootViewAndSetLayoutParam(View, double , double) 来更改此操作。如果我评论了这些行，它就会起作用。

```
 if (view.getClass().equals(LinearLayout.class)) {
         LinearLayout.LayoutParams layoutParams = new
         LinearLayout.LayoutParams(
         (int) (((double) widthRatio) * (view.getWidth())),
         (int) (((double) heightRatio) * (view.getHeight())));
         view.setLayoutParams(layoutParams);
    } else if (view.getClass().equals(FrameLayout.class)) {
        FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(
                (int) (((double) widthRatio) * (view.getWidth())),
                (int) (((double) heightRatio) * (view.getHeight())));
        view.setLayoutParams(layoutParams);
    } 
```

，但是如果我运行所有代码而不是在 onCreate() 方法中得到 ClassCastException，

我调试代码，方法 traverseRootViewAndSetLayoutParam(View, double , double) 没有给出异常，但是在控制权通过 onCreate() 之后，它给出了 ClassCastException。我检查它控制是否上线，System.outprintln(>> oncreate end >>)。此时我没有收到任何错误，但是发生了跨越 oncreate 方法的异常。

我在 onCreate 方法中调用的代码行，

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
            ...
            ...
            ...
    try {
        traverseRootViewAndSetLayoutParam(rootLinearLayout, widthRatio,
                heightRatio);
    } catch (Exception e) {
        e.printStackTrace();
    }
System.out.println(">>> oncreate end >>> ");
   } 
```

traverseRootViewAndSetLayoutParam() 方法，

```
public void traverseRootViewAndSetLayoutParam(View view,
        double heightRatio, double widthRatio) {

    System.out.println(">>> iCount >>> " + iCount++);

    if (view.getClass().equals(LinearLayout.class)) {
         LinearLayout.LayoutParams layoutParams = new
         LinearLayout.LayoutParams(
         (int) (((double) widthRatio) * (view.getWidth())),
         (int) (((double) heightRatio) * (view.getHeight())));
         view.setLayoutParams(layoutParams);
    } else if (view.getClass().equals(FrameLayout.class)) {
        FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(
                (int) (((double) widthRatio) * (view.getWidth())),
                (int) (((double) heightRatio) * (view.getHeight())));
        view.setLayoutParams(layoutParams);
    }
    // else {
    // ViewGroup.LayoutParams layoutParams = new ViewGroup.LayoutParams(
    // (int) (((double) widthRatio) * (view.getWidth())),
    // (int) (((double) heightRatio) * (view.getHeight())));
    // view.setLayoutParams(layoutParams);
    // }

    if (view instanceof LinearLayout || view instanceof FrameLayout) {
        if (view instanceof LinearLayout) {
            System.out.println(">>> LinearLayout Class >>> "
                    + view.getClass());
            int childcount = ((LinearLayout) view).getChildCount();
            for (int i = 0; i < childcount; i++) {
                View childView = ((LinearLayout) view).getChildAt(i);
                traverseRootViewAndSetLayoutParam(childView, heightRatio,
                        widthRatio);
            }
        } else if (view instanceof FrameLayout) {
            System.out.println(">>> FrameLayout Class >>> "
                    + view.getClass());
            int childcount = ((FrameLayout) view).getChildCount();
            for (int i = 0; i < childcount; i++) {
                View childView = ((FrameLayout) view).getChildAt(i);
                traverseRootViewAndSetLayoutParam(childView, heightRatio,
                        widthRatio);
            }
        }
    }
} 
```

错误日志，

```
12-16 00:30:12.791: W/dalvikvm(277): threadid=1: thread exiting with uncaught exception (group=0x4001d800)
12-16 00:30:12.952: E/AndroidRuntime(277): FATAL EXCEPTION: main
12-16 00:30:12.952: E/AndroidRuntime(277): java.lang.ClassCastException: android.widget.FrameLayout$LayoutParams
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.measureVertical(LinearLayout.java:355)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.onMeasure(LinearLayout.java:304)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.View.measure(View.java:8171)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1012)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.measureHorizontal(LinearLayout.java:696)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.onMeasure(LinearLayout.java:306)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.View.measure(View.java:8171)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1012)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.measureVertical(LinearLayout.java:381)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.onMeasure(LinearLayout.java:304)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.View.measure(View.java:8171)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.measureChildBeforeLayout(LinearLayout.java:1012)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.measureVertical(LinearLayout.java:381)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.LinearLayout.onMeasure(LinearLayout.java:304)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.View.measure(View.java:8171)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.FrameLayout.onMeasure(FrameLayout.java:245)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.View.measure(View.java:8171)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3132)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.widget.FrameLayout.onMeasure(FrameLayout.java:245)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.View.measure(View.java:8171)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.ViewRoot.performTraversals(ViewRoot.java:801)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.view.ViewRoot.handleMessage(ViewRoot.java:1727)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.os.Handler.dispatchMessage(Handler.java:99)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.os.Looper.loop(Looper.java:123)
12-16 00:30:12.952: E/AndroidRuntime(277):  at android.app.ActivityThread.main(ActivityThread.java:4627)
12-16 00:30:12.952: E/AndroidRuntime(277):  at java.lang.reflect.Method.invokeNative(Native Method)
12-16 00:30:12.952: E/AndroidRuntime(277):  at java.lang.reflect.Method.invoke(Method.java:521)
12-16 00:30:12.952: E/AndroidRuntime(277):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
12-16 00:30:12.952: E/AndroidRuntime(277):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
12-16 00:30:12.952: E/AndroidRuntime(277):  at dalvik.system.NativeStart.main(Native Method)
12-16 00:30:42.751: I/Process(277): Sending signal. PID: 277 SIG: 9 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:24:15.350

你得到这个异常是因为 LayoutParams 总是相对于父视图组。

例如，你有一个RelativeLayout，在这个RelativeLayout 里面你有一个LinearLayout，这个LinearLayout 的LayoutParams 将是一个RelativeLayout.LayoutParams。

这是因为这些参数与父级在其区域内布局其视图的方式有关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:23:16.450

```
if (view.getClass().equals(LinearLayout.class)) {
     LinearLayout.LayoutParams layoutParams = new
     LinearLayout.LayoutParams(
     (int) (((double) widthRatio) * (view.getWidth())),
     (int) (((double) heightRatio) * (view.getHeight())));
     view.setLayoutParams(layoutParams);
} else if (view.getClass().equals(FrameLayout.class)) {
    FrameLayout.LayoutParams layoutParams = new FrameLayout.LayoutParams(
            (int) (((double) widthRatio) * (view.getWidth())),
            (int) (((double) heightRatio) * (view.getHeight())));
    view.setLayoutParams(layoutParams);
} 
```

在这里，您正在检查视图的类型，而不是视图的父级。如果视图的父级是 a`LinearLayout`并且视图本身是 a `FrameLayout`，那么您将给出它`FrameLayout.LayoutParams`，这是不对的。

由于您没有使用重量或任何特定于布局类型的东西，我建议只使用`ViewGroup.LayoutParams`：

```
ViewGroup.LayoutParams layoutParams = new
ViewGroup.LayoutParams(
    (int) (((double) widthRatio) * (view.getWidth())),
    (int) (((double) heightRatio) * (view.getHeight())));
view.setLayoutParams(layoutParams); 
```

# qt - when choose customized qcompleter dropdown list item, it does not appear in customized lineditor

> ID：13895350
> 
> 赞同：0
> 
> 时间：2012-12-15T19:18:27.467
> 
> 标签：qt, qcompleter

我遵循了这个很好的[示例](http://qt-project.org/doc/qt-4.8/tools-customcompleter.html)，但是当我使用箭头键浏览自定义`QCompleter`下拉列表项时，该项目不会出现在自定义行编辑器中（它在下拉列表中以蓝色突出显示）。当我点击回车按钮时，该项目将出现在以蓝色突出显示的行编辑器中。然后我必须再次按下回车按钮让编辑器获取该项目。

这与`QCompleter`行为方式不同。中`QCompleter`，当使用箭头键浏览项目时，它们将自动出现在编辑器中，不会突出显示。当按下回车按钮时，编辑器将获取该项目。

我花了很多时间调试，但无法弄清楚出了什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T12:39:15.373

我认为这是这里描述的错误：[QTBUG-3745](https://bugreports.qt-project.org/browse/QTBUG-3745)。在那里您还可以找到解决方法。

# c++ - DirectX 当我将纹理添加到四边形时，三角形会以某种方式混乱，修复吗？

> ID：13895353
> 
> 赞同：1
> 
> 时间：2012-12-15T19:19:02.297
> 
> 标签：c++, geometry, directx, textures

首先，这里是我的代码的重要部分。

创建顶点。

```
D3DVertexTexture Vertices[] =
{
    {-1.0f,  1.0f, 0.0f, 0.0f, 0.0f, },
    { 1.0f,  1.0f, 0.0f, 1.0f, 0.0f, },
    { 1.0f, -1.0f, 0.0f, 1.0f, 1.0f, },
    {-1.0f, -1.0f, 0.0f, 0.0f, 1.0f, },
}; 
```

创建顶点缓冲区。

```
D3DDevice->CreateVertexBuffer(sizeof(Vertices),
                              0,
                              D3DFVF_CUSTOMVERTEXTEXTURE,
                              D3DPOOL_MANAGED,
                              &vb,
                              NULL); 
```

内存垃圾。

```
void* pVoid;

vb->Lock(0, sizeof(pVoid), (void**) &pVoid, 0);
    memcpy(pVoid, Vertices, sizeof(Vertices));
vb->Unlock(); 
```

加载纹理。

```
D3DXCreateTextureFromFile(D3DDevice, "images/tex.png", &t); 
```

渲染。

```
D3DDevice->SetFVF(D3DFVF_CUSTOMVERTEXTEXTURE);

D3DDevice->SetTexture(0, t);
D3DDevice->SetStreamSource(0, vb, 0, sizeof(D3DVertexTexture));
D3DDevice->DrawPrimitive(D3DPT_TRIANGLESTRIP, 0, 2); 
```

我的问题在哪里。

它显示了一个正方形，但是像这样的三角形缺少侧面的左侧。

![在此处输入图像描述](../Images/5f5d40b79a06b2357814114de4ad6c77.png)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:03:52.653

三角形带中的顶点 A、B、C、D 将产生两个三角形：A、B、C 和 B、C、D

```
A -- B A--BB
| | \ | /|
| | \| / |
D--CC D--C

```

看那张图，画出这两个三角形……

然后去把你的顶点按正确的顺序排列——三角形带应该是“之字形”，而不是顺时针或逆时针的顺序。

如果您订购它们：A、B、D、C - 四边形将正确绘制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-01-16T10:58:13.753

您是否尝试过按以下顺序定义顶点：

```
D3DVertexTexture Vertices[] =
{
    { 1.0f, -1.0f, 0.0f, 1.0f, 1.0f, },
    {-1.0f, -1.0f, 0.0f, 0.0f, 1.0f, },
    {-1.0f,  1.0f, 0.0f, 0.0f, 0.0f, },
    { 1.0f,  1.0f, 0.0f, 1.0f, 0.0f, },
}; 
```

我相信绘制顶点的顺序默认是顺时针顺序。您定义的顺序不正确。

# mysql - 如果我自然加入这两个表会发生什么？

> ID：13895354
> 
> 赞同：0
> 
> 时间：2012-12-15T19:19:10.113
> 
> 标签：mysql, sql, database, natural-join

我有两张桌子。员工和经理。员工表存储公司所有员工的信息。经理表显示哪些员工在哪个经理手下工作。经理也是该公司的雇员。下表给出。

> 员工（**姓名**，城市，街道）
> 
> 经理（**姓名**，员工姓名）

粗体表示它们是主键。现在的问题是，在经理表中，姓名和员工姓名都是引用员工的外键。那么如果我自然地加入他们会发生什么。不会有什么问题吗？自然加入他们之后，我会在决赛桌看到谁的城市和街道？经理的还是员工的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:56:41.380

如果你很幸运，你很可能一无所有，如果你不走运，你很可能一无所有。`Natural join`会做这样的事情：

```
SELECT * FROM managers LEFT JOIN employees
         WHERE managers.name = employees.name 
```

`Natural join`尝试使用*COMMONLY NAMED COLUMNS*。

当我假设你想要更像这样的东西时：

```
SELECT * FROM managers LEFT JOIN employees
         WHERE managers.employee_name = employees.name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:48:37.200

您将获得所有经理城市、街道和员工姓名的列表

姓名、城市、街道、Employee_Name

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T20:29:48.150

否则加入的东西，我建议审查你的数据库的架构。如果在经理表中，名称是 PK，则同一经理不能有超过一名员工。

# html - AJAX 不显示在 chrome 中，其他所有浏览器都很好

> ID：13895356
> 
> 赞同：0
> 
> 时间：2012-12-15T19:19:58.403
> 
> 标签：html, ajax, google-chrome, jquery

我在 Chrome 中正确显示网站时遇到了一些问题。AJAX 加载但不进行最终调用以仅在 Chrome 中显示。我已经在 Safari 和 Firefox 中进行了测试，效果很好。

我有点新，没有检测浏览器特定错误的工具，希望这里有人可以。该网站是

[http://www.veracycolab.com](http://www.veracitycolab.com)

如您所见，页面内容在 FF 和 Safari 中加载，但在 Chrome 中没有到达最终显示点。你能提供的任何帮助都会很棒。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:30:18.843

将`#main`css 设置为`opacity:0`to`opacity:1`并且它可以正常工作`Chrome`

# javascript - HTML5 验证和添加自定义字符串比较

> ID：13895368
> 
> 赞同：0
> 
> 时间：2012-12-15T19:21:10.717
> 
> 标签：javascript, html

我有一些可以正常工作的 HTML 5 验证，但我现在需要向它添加一些自定义验证以检查 2 个输入元素是否具有相同的值。但到目前为止，它只是被忽略了。这是我的代码，对无效的更改进行了注释：

```
<script type="text/javascript">
    $(document).ready(function () {

        //set up buttons
        $(function () {
            $("input:submit").button();
        });
    });
</script>    

<!--IE doesn't support setCustomValidity--> 
<![if !IE]>
<script type="text/javascript">
    //http://www.whatwg.org/specs/web-apps/current-work/multipage/association-of-controls-and-forms.html#the-constraint-validation-api
    $(document).ready(function () {

        //set up buttons
        $(function () {
            $("input:submit").button();
        });

        //added to compare Name and Email Address
        var name = $("#Name").val();
        var emailAddress = $("#EmailAddress").val();

        if ((name == emailAddress) && (name != "")) {
            $("#Name").setCustomValidity("Name must not be equal to Email Address");
            return false;
        }

        var elementsInput = document.getElementsByTagName("input");
        var elementsTextArea = document.getElementsByTagName("textarea");

        for (var i = 0; i < elementsInput.length; i++) {

            elementsInput[i].oninvalid = function (e) {
                e.target.setCustomValidity("");
                if (!e.target.validity.valid) {

                    switch (e.target.name) {

                        case "Name":
                            e.target.setCustomValidity("@Html.Raw(Resources.Validation.FullNameRequired)");
                            break;

                        case "EmailAddress":
                            //e.preventDefault();

                            //later you decide you want to submit
                            //$(this).unbind('submit').submit();

                            if (e.target.validity.valueMissing) {
                                e.target.setCustomValidity("@Html.Raw(Resources.Validation.EmailAddressRequired)");
                            }
                            else if (e.target.validity.patternMismatch) {
                                e.target.setCustomValidity("@Html.Raw(Resources.Validation.EmailAddressInvalid)");
                            }
                            break;

                        case "PhoneNumber":
                            //e.preventDefault();
                            if (e.target.validity.valueMissing) {
                                e.target.setCustomValidity("@Html.Raw(Resources.Validation.PhoneNumberRequired)");
                            }
                            else if (e.target.validity.patternMismatch) {
                                e.target.setCustomValidity("@Html.Raw(Resources.Validation.PhoneNumberInvalid)");
                            }
                            break;
                        }
                    }
            };
                elementsInput[i].oninput = function (e) {
                    e.target.setCustomValidity("");
                };
            }

        for (var j = 0; j < elementsTextArea.length; j++) {
            elementsTextArea[j].oninvalid = function (e) {
                e.target.setCustomValidity("");
                if (!e.target.validity.valid) {
                    switch (e.target.name) {
                        case "Details":
                            e.target.setCustomValidity("@Html.Raw(Resources.Validation.DetailsRequired)");
                            break;
                    }
                }
            };
            elementsTextArea[j].oninput = function (e) {
                e.target.setCustomValidity("");
            };
        }
    });

</script>
<![endif]> 
```

# c# - 小巧的彩虹 MissingMethodException

> ID：13895369
> 
> 赞同：3
> 
> 时间：2012-12-15T19:21:18.087
> 
> 标签：c#, dapper, dapper-rainbow

为什么我会得到这个异常？代码不一样，但接近“演示” [https://gist.github.com/1599013](https://gist.github.com/1599013)

异常：MissingMethodException

描述：

> > 找不到方法：'System.Collections.Generic.IEnumerable `1<System.Object> Dapper.SqlMapper.Query(System.Data.IDbConnection, System.String, System.Object, System.Data.IDbTransaction, Boolean, System.Nullable`1，System.Nullable`1)'。

代码

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Net.Mail;
using Dapper;
using System.Data.SqlClient;
using MySql.Data.MySqlClient;

namespace daconsole2
{
    class Program
    {
        class Product
        {
            public int Id { get; set; }
            public string Name { get; set; }
            public string Description { get; set; }
            public DateTime? LastPurchase { get; set; }
        }

        // container with all the tables
        class MyDatabase : Database<MyDatabase>
        {
            public Table<Product> Products { get; set; }
        }
        //*/
        static void Main(string[] args)
        {
            var cnn = new MySqlConnection("uid=name;pwd=pw;Port=3306;database=test");
            cnn.Open();
            var db = MyDatabase.Init(cnn, commandTimeout: 2);
            //if(false)
            db.Execute(@"create table Products (
Id int primary key,
Name varchar(20),
Description TEXT,
LastPurchase datetime)");
            var productId = db.Products.Insert(new { Name = "Hello", Description = "Nothing" });
            //var db = cnn;
            Console.ReadKey();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-05-09T18:24:38.303

我们遇到了同样的问题，结果证明解决方案中的一些项目引用了不同版本的 Dapper。例如，一个项目使用的运行时版本在“属性”窗口中显示为 v4.0.30319。另一个项目有一个 Dapper 运行时版本 v2.0.50727 (.NET 3.5)。

一旦我将它们全部设置为 v2.0.50727 版本，这个错误就消失了。

*应注意，它们都显示文件版本 1.12.0.0，因此这不是区分它们的可靠方法。

# sql - 如何在 Teradata 中执行动态 SQL

> ID：13895370
> 
> 赞同：2
> 
> 时间：2012-12-15T19:21:19.653
> 
> 标签：sql, teradata

有没有办法将动态生成的 SQL 提交给 Teradata？我编写了一个查询，该查询将创建代码以对表进行非规范化。现在，我将代码拉到我的客户 (SAS) 并在第二步中重新提交。我对 Teradata 宏或程序都不熟悉；类似的东西会起作用吗？

为了说明，我有一个这样定义的表：

```
create multiset table MYTABLE
    (  RECID  integer generated always as identity
              ( start with 1
               increment by 1
               minvalue -2147483647
               maxvalue 2147483647
               no cycle )
     , SNAP_DATE  date format 'YYYY/MM/DD'
     , EMAIL_DATE date format 'YYYY/MM/DD'
     , FREQ integer
    )
unique primary index ( RECID  ) 
```

该表每天都会填充 ( `SNAP_DATE`)，用于监控另一个表中 email_date 的更改。以下查询返回我可以运行以创建非规范化视图的代码：

```
select RUN_THIS
from (
    select RUN_THIS, RN
    from (
        select 'select EMAIL_DATE ' (varchar(100)) as RUN_THIS
              , 0 (int) as RN
          ) x

    union all
    select ', sum( case when SNAP_DATE = date '''
             || (SNAP_DATE (format 'yyyy-mm-dd') (char(10)) )
             || ''' then FREQ else 0 end ) as D'
             || (SNAP_DATE (format 'yyyymmdd') (char(8)) ) as RUN_THIS
          , row_number() over ( partition by 1 order by SNAP_DATE ) as RN
    from ( select distinct SNAP_DATE 
           from MYTABLE 
           where SNAP_DATE > current_date - 30) t1

    union all
    select RUN_THIS, RN
    from (
        select 'from MYTABLE group by 1 order by 1;' as RUN_THIS
                , 10000 as RN
          ) y
    ) t
order by RN 
```

我将上述查询的结果导出到客户端上的文件，然后转身将该文件提交回 Teradata。我希望有某种方法可以将这个完整的定义存储在某个 Teradata 对象中，以便可以直接执行。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:53:22.203

`DBC.SysExecSQL`您可能会发现使用该命令将其放入存储过程中是成功的。

以下是 Teradata 中存储过程的过度简化示例。显然，在生产中需要定义一个错误处理程序来解决无效数据库对象之类的问题。此外，您可以将`SQLSTATE`back 作为参数返回，以测试存储过程是否成功完成。

```
CREATE PROCEDURE SYSDBA.CommentDatabase
(
  IN P_Database VARCHAR(30),
  IN P_Comment VARCHAR(255), 
  OUT MSG
)
MAIN:  --Label
BEGIN

  DECLARE  P_SQL_TEXT     VARCHAR(4000);

  SET P_SQL_TEXT='COMMENT ON DATABASE '||P_DATABASE||' AS '''||P_COMMENT||'''';
  CALL dbc.SysExecSQL (:P_SQL_TEXT);

  SET MSG = 'Database '||P_DBNAME||' commented successfully!';
END; 
```

# c++ - 从内存中加载文件

> ID：13895371
> 
> 赞同：-1
> 
> 时间：2012-12-15T19:21:22.313
> 
> 标签：c++, file

我有一个加密的图像文件。现在我的程序将读取加密文件并在 char 数组中创建图像。现在我的问题是我需要用一些图像查看器打开图像而不将图像文件写入硬盘。这应该是可能的，因为图像数据已经加载到内存中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:28:24.920

我不知道任何能够从内存区域加载图像的图像查看器。即使您要创建自己的图像查看器，您也必须共享内存区域，否则出于安全原因，查看器很可能无法访问您的程序内存。

折衷方案是将图像写入硬盘上的临时目录，用图像查看器打开它并用随机数据覆盖它并在使用后删除文件（对于小文件，您甚至可以在图像查看器完成加载后将其删除）。

从您所写的内容来看，您似乎希望避免将解密的数据写入硬盘，这很好，因为写入硬盘的数据在关机后仍然存在，而 RAM 中的数据将无法生存。但正如 JasonD 在他的评论中指出的那样，这可能会导致一种错误的安全感——操作系统可以随时将内存区域自由地移动到虚拟内存（以及硬盘）。

编辑：打开内存区域可能是可能的，例如您可以尝试使用[十六进制编辑器 HxD](http://mh-nexus.de/en/hxd/) - 它可以打开和编辑进程分配的内存区域，尽管我不知道它是如何做到的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-16T09:50:31.693

正如其他人所指出的那样，除非图像查看器支持通过进程间通信机制加载图像（我还没有看到这样的查看器），否则数据存在于内存中的事实不会给您任何帮助。

因此，您的选择是使用一些用于 C++ 的图像查看库（这可能是一个完美的选择，顺便说一句）或创建一个虚拟磁盘。

关于交换到磁盘的内存 - 您可以将内存标记为不可交换，但您需要确保可以分配这样的内存块（对于大图像，这是不可能的）。

您可以创建一个虚拟磁盘来公开存储在 RAM 中的数据，但您需要一个内核模式虚拟磁盘驱动程序。不过，这需要在内核模式开发方面有扎实的经验。我们公司提供多种产品（SolFS OS 版本、CallbackDisk），您可以将它们用于您的任务并获得几乎无需编程的加密内存存储。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T19:36:56.173

只有一种方法可以做到，而且绝对不是简单的方法！您需要一个过滤器驱动程序将虚拟文件系统链接到用户空间。您可以查看“dokan”项目以获取更多信息。

如果这是一个商业项目，你应该非常熟悉 NTFS 驱动程序，因为我认为不支持 dokan。

我用过它，它工作得很好，但我花了大约三个月的时间才开始研究这些东西。

如果它不是“高安全性应用程序”，您可以使用临时文件。

# java - Java学习使用SWT gridlayout和griddata

> ID：13895372
> 
> 赞同：2
> 
> 时间：2012-12-15T19:21:31.343
> 
> 标签：java, grid, swt, alignment, grid-layout

我了解并且可以使用 FormLayout、FormData、FormAttachment，但我不明白 GridLayout、GridData 是如何工作的。我想学习使用 GridLayout 和 GridData，因为它更像一个表格，它有一个结构并且不依赖于其他小部件。

我是一名 Web 开发人员（前端、后端），我迷失在 Java“网格”结构中。我应该如何对齐，在单元格内移动小部件（水平/垂直 Aling，hor./vert. Indent）？就像在 HTML/CSS 中一样：边距、填充等。例如：将块从左侧移动 100 像素。(margin-left: 100px)，但是在 Java 中？

当我作为 Web 开发人员工作时，我创建了一个页面（这里是 Java 视图），我知道如何组织父级和块。我可以将 Composite 与 div 进行比较，例如 HTML/CSS 中的块元素吗？

我需要创建以下应用程序：

![在此处输入图像描述](../Images/1d66fabb25dd55a21edec8f55fbcfbad.png)

我需要使用 4 个复合材料吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T21:48:11.357

以下文章应该`GridLayout`为您提供一些启示：

[了解 SWT 中的布局](http://www.eclipse.org/articles/article.php?file=Article-Understanding-Layouts/index.html)

要实现类似于您在那里的形式，您需要这样的东西：

```
shell.setLayout(new GridLayout(3, false));

Label title = new Label(shell, SWT.NONE);
title.setText("My first text editor");
GridData data = new GridData(SWT.FILL, SWT.BEGINNING, true, false);
data.horizontalSpan = 3;
title.setLayoutData(data);

Label select = new Label(shell, SWT.NONE);
select.setText("Select a file:");
data = new GridData(SWT.FILL, SWT.BEGINNING, true, false);
select.setLayoutData(data);

Text text = new Text(shell, SWT.BORDER);
data = new GridData(SWT.FILL, SWT.BEGINNING, true, false);
text.setLayoutData(data);

Button button = new Button(shell, SWT.PUSH);
button.setText("Browse...");
data = new GridData(SWT.FILL, SWT.BEGINNING, true, false);
button.setLayoutData(data);

List result = new List(shell, SWT.BORDER);
data = new GridData(SWT.FILL, SWT.FILL, true, true);
data.horizontalSpan = 3;
result.setLayoutData(data); 
```

`GridData`我们用于定义布局中组件的行为。您可以定义垂直/水平对齐、边距等。`horizontalSpan`用于告诉布局小部件将覆盖多少列。

# javascript - JavaScript 等价于 Ruby 的 String#scan

> ID：13895373
> 
> 赞同：17
> 
> 时间：2012-12-15T19:21:33.603
> 
> 标签：javascript, ruby, regex

这存在吗？

我需要解析一个字符串，如：

```
the dog from the tree 
```

并得到类似的东西

```
[[null, "the dog"], ["from", "the tree"]] 
```

我可以在 Ruby 中使用一个 RegExp 和`String#scan`.

JavaScript`String#match`无法处理这个问题，因为它只返回匹配的正则表达式而不是捕获组，所以它返回类似

```
["the dog", "from the tree"] 
```

因为我`String#scan`在我的 Ruby 应用程序中使用了很多次，所以如果有一种快速的方法可以在我的 JavaScript 端口中复制这种行为，那就太好了。

编辑：这是我正在使用的正则表达式：http: [//pastebin.com/bncXtgYA](http://pastebin.com/bncXtgYA)

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-15T19:32:37.430

```
String.prototype.scan = function (re) {
    if (!re.global) throw "ducks";
    var s = this;
    var m, r = [];
    while (m = re.exec(s)) {
        m.shift();
        r.push(m);
    }
    return r;
}; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-05-31T15:05:31.117

ruby 的 scan() 方法只有在指定捕获组时才会返回嵌套数组。 [http://ruby-doc.org/core-2.5.1/String.html#method-i-scan](http://ruby-doc.org/core-2.5.1/String.html#method-i-scan)

```
a = "cruel world"
a.scan(/\w+/)        #=> ["cruel", "world"]
a.scan(/.../)        #=> ["cru", "el ", "wor"]
a.scan(/(...)/)      #=> [["cru"], ["el "], ["wor"]]
a.scan(/(..)(..)/)   #=> [["cr", "ue"], ["l ", "wo"]] 
```

下面是 melpomene 答案的修改版本，如果合适，可以返回平面数组。

```
function scan(str, regexp) {
    if (!regexp.global) {
        throw new Error("RegExp without global (g) flag is not supported.");
    }
    var result = [];
    var m;
    while (m = regexp.exec(str)) {
        if (m.length >= 2) {
            result.push(m.slice(1));
        } else {
            result.push(m[0]);
        }
    }
    return result;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-15T20:22:37.133

这是另一个使用`String.replace`：

```
String.prototype.scan = function(regex) {
    if (!regex.global) throw "regex must have 'global' flag set";
    var r = []
    this.replace(regex, function() {
        r.push(Array.prototype.slice.call(arguments, 1, -2));
    });
    return r;
} 
```

它是如何工作的：`replace`将在每次匹配时调用回调，将匹配的子字符串、匹配的组、偏移量和完整的字符串传递给它。我们只想要匹配的组，所以我们`slice`排除了其他参数。

# window - 使 JFXtras 窗口不可移动和可调整大小

> ID：13895375
> 
> 赞同：1
> 
> 时间：2012-12-15T19:21:43.110
> 
> 标签：window, javafx-2, resizable, movable, jfxtras

有没有办法使 JFXtras 窗口 (jfxtras.labs.scene.control.window.Window) 不可调整大小且不可移动？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T14:12:49.487

jfxtras.labs.scene.control.window.Window 得到了更新，添加了以下方法：

```
setMovable(Boolean v);
setResizableWindow(Boolean v); 
```

# java - 查找已提交的行的百分比 SVN

> ID：13895377
> 
> 赞同：1
> 
> 时间：2012-12-15T19:22:09.660
> 
> 标签：java, svn

> **可能重复：**
> [SVN分析工具](https://stackoverflow.com/questions/960213/svn-analysis-tool)

在SVN中，我怎样才能得到这样的输出

```
username1    12.4%
username2    97.6% 
```

这意味着 username1 贡献了（提交）12.4% 的代码，而 username2 贡献了 97.6% 的代码，我希望它只为 .java 文件计算这个（因此，忽略图像上传和其他东西）

我能怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:25:15.803

使用 StatSVN 这为我工作了多年。

# html - 如何使一个 div 的高度取决于另一个 div 的高度？

> ID：13895379
> 
> 赞同：5
> 
> 时间：2012-12-15T19:22:24.933
> 
> 标签：html, css, height

好吧，我有这么简单的 divs 结构：

```
<div id="wrapper">
    <div id="1" class="block">
    1            
    </div>
    <div id="2" class="block">
    2
    </div>
</div> 
```

[JS小提琴](http://jsfiddle.net/SdMrs/14/)

的内容`#1`可以通过javascript动态更改，并且可以根据内容更改其高度。我想要的是`#2`与`#1`. 我知道我可以为此目的使用 javascript，但我建议必须有一些不那么棘手的方法来使这些 div 的高度相等，仅使用 CSS 和/或以某种方式更改 div 的定位。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-15T19:38:28.590

要扩展我的评论，你不能在语义上这样做。你必须使用一个小技巧来伪造 100% 的高度。它被称为仿列，您可以[在此处](http://css-tricks.com/fluid-width-equal-height-columns/)阅读更多内容。

在您的情况下，我们可以通过添加一些背景 div 来伪造它：

```
<div class="background bg1"></div>
<div class="background bg2"></div> 
```

然后像这样改变你的CSS：

```
#wrapper {
    border: 1px solid black;
    position: relative;
}

#wrapper:after {
    display: block;
    content: " ";
    height: 0;
    clear: both;
}

.block {
    position: relative;
    float: left;
    vertical-align: top;
    width: 200px;
    text-align: left;
    min-height: 200px;
    padding-left: 20px;
    z-index: 2;
}

.background {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 200px;
    z-index: 1;
}

.bg1 {
    background-color: #eee;
}

.bg2 {
    left: 200px;
    background-color: #aaa;
}​ 
```

这是一个有效的[jsFiddle](http://jsfiddle.net/SdMrs/18/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:26:47.533

jQuery 方式：使用 .height() 返回 Div1 的高度，然后简单地使用 .css() 将 Div2 设置为 Div1 的高度。当 div 1 发生变化时，您可以使用 resize 事件来触发会改变 div2 高度的函数。

CSS 方式：Christian Varga 的回答似乎很完美。

# android - 我的项目根目录中的 ic_launcher-web.png 有什么作用？

> ID：13895390
> 
> 赞同：81
> 
> 时间：2012-12-15T19:24:48.780
> 
> 标签：android, eclipse, icons, project

令人难以置信的是，在谷歌搜索这个非常基本的问题时，我找不到答案！

我注意到，自从我从 Eclipse Helios 升级到 Eclipse Juno 并更新了 Android SDK，每当我创建一个新的 Android 项目时，Eclipse 都会在项目根目录中放置一个名为 ic_launcher-web.png 的文件。该文件与在项目创建对话框中选择的应用程序图标相同，但它的作用是什么？如前所述，它位于项目根目录中，而不是任何 /res/ 文件夹中。那么它是否包含在完成的 .apk 文件中，它的目的是什么？

* * *

## 回答 #1

> 赞同：104
> 
> 时间：2012-12-15T19:26:26.410

它适用于 Play 商店，它接受 512x512 高分辨率图标：

> *   高分辨率应用程序图标（必需）：
>     *   使用：在 Google Play 的不同位置。
>     *   规格：512x512，32 位 PNG，带 alpha；最大大小为 1024KB。
> 
> [-- 谷歌支持](http://support.google.com/googleplay/android-developer/bin/answer.py?hl=en&answer=1078870)

（可以在[这里](https://web.archive.org/web/20140616162825/http://developer.xamarin.com/guides/android/deployment,_testing,_and_metrics/publishing_an_application/part_2_-_publishing_an_application_on_google_play/#High_Resolution_Application_Icon)找到更多类似解释的教程。）

它不会在您的实际应用程序或启动器中使用，因此未打包在 APK 中。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T19:27:02.177

这是 google play 商店的图标。您需要提供一个 512 x 512 的图标。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-15T19:29:39.797

这个页面上有一点解释：

[http://developer.android.com/guide/practices/ui_guidelines/icon_design_launcher.html#size](http://developer.android.com/guide/practices/ui_guidelines/icon_design_launcher.html#size)

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-09-11T21:40:51.020

如果您保留此文件，请确保将其更改为复制您的常规启动器文件。无论如何，您在提交项目时手动将常规启动器文件添加到播放站点，因此可能不需要额外的网络启动器文件。我的第一个项目从未有过。

# python - 寻找化学物种中的独特元素

> ID：13895391
> 
> 赞同：1
> 
> 时间：2012-12-15T19:25:07.733
> 
> 标签：python

确定独特元素：编写一个函数，当给定物种列表时，将返回物种集中包含的独特元素的按字母顺序排列的列表。利用上一步中的解析器。示例：使用 ['CO', 'H2O', 'CO2', 'CH4'] 的输入调用您的函数应该返回 ['C', 'H', 'O'] 的输出

这是我正在做的一个更大项目的一部分。

我遇到的问题是如何查看每个元素的单个字符。一旦我有了这个，我应该能够检查它是否独特。我知道这是不对的，这只是我在想的事情的一个粗略想法。

```
def unique_elements(x):

    if x in y

    else
    y.append(x)
return y 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:43:44.937

```
>>> def sanitize(compound):
    return compound.translate(None,string.digits)

>>> def elementazie(compoud):
    return re.findall("([A-Z][a-z]*)",compoud)

>>> sorted(set(chain(*(elementazie(sanitize(s)) for s in species))))
['Au', 'C', 'H', 'O'] 
```

# selenium - 硒 - jUnit4

> ID：13895392
> 
> 赞同：1
> 
> 时间：2012-12-15T19:25:12.667
> 
> 标签：selenium, junit4, selenium-ide

我正在尝试运行以下代码，但徒劳无功。

代码未编译并给出错误，因为“**硒无法解析**”。任何人都可以查看以下代码 -

```
package com.example.tests;

import com.thoughtworks.selenium.*;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import java.util.regex.Pattern;

public class prashantk {
    @Before
    public void setUp() throws Exception {
        selenium = new DefaultSelenium("localhost", 4444, "*chrome", "http://book.theautomatedtester.co.uk/");
        selenium.start();
    }

    @Test
    public void testAuto_1() throws Exception {
        selenium.open("/chapter2");
        verifyEquals("Button with name", selenium.getValue("name=but2"));
        verifyEquals("chocolate", selenium.getValue("xpath=(//input[@name='verifybutton'])[2]"));
        selenium.click("link=Index");
        selenium.waitForPageToLoad("60000");
        verifyTrue(selenium.isTextPresent("Chapter4"));
    }

    @After
    public void tearDown() throws Exception {
        selenium.stop();
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T19:52:51.083

您引用了一个名为 的字段`selenium`，但没有定义这样的字段。

在你的课堂上的某个地方，可能在 之前的一行`@Before`，你想要添加这个字段：

```
Selenium selenium; 
```

显然，从评论中您也没有方法`verifyEquals`并`verifyTrue`在您的代码中引用。`SeleneseTestCase`这些方法在您的测试应扩展的基类中定义：

```
public class prashantk extends SeleneseTestCase { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T05:27:01.113

替换代码中的以下行，如下所示

selenium = new DefaultSelenium("localhost", 4444, "*chrome", "http://book.theautomatedtester.co.uk/");

```
 to 
```

DefaultSelenium selenium = new DefaultSelenium("localhost", 4444, "*chrome", "http://book.theautomatedtester.co.uk/");

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-09T11:12:58.413

查看代码给人的印象是它首先在 Selenium IDE 中完成，然后导出到像 eclipse 这样的工具。我真的不认为 WebDriver 中存在“verifyEquals”，而是使用 JUnit 断言或 Hamcrest 断言。尝试用 Java 从头开始​​编写代码，这样麻烦会少很多。

# javascript - 两端拆分url

> ID：13895394
> 
> 赞同：0
> 
> 时间：2012-12-15T19:25:15.037
> 
> 标签：javascript, jquery, url, split

我有一个这样的网址：

```
http://mywebsite.nl/url?q=http://SomeWebsite.com/&sa=U&ei=nszMUIi_GOm-0QXV-IGgDA&ved=0CBgQFjAA&usg=AFQjCNHaN4L8nQBIDfpgcOpD0hCsEuI1vA 
```

我想通过将 url 分成 3 个部分来清理它并保留中间部分。我知道如何拆分和摆脱这样的第一部分：

```
var href =  $(this).attr('href'); 
    url  = href.split('='); 
    url  = url[1]; 
```

问题是我也想摆脱最后一部分，就像这样：

```
var href =  $(this).attr('href'); 
    url  = href.split('&'); 
    url  = url[0]; 
```

这样会留下一个干净的网址：

```
http://SomeWebsite.com/ 
```

如何将拆分部分组合成一个代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:27:05.930

为什么不是这个？

```
var href = (this.getAttribute("href").match(/=(.*?)&/) || ["",""])[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:28:35.583

尝试这个，

**[现场演示](http://jsfiddle.net/rajaadil/Z5nkR/1/)**

```
str = "http://mywebsite.nl/url?q=http://SomeWebsite.com/&sa=U&ei=nszMUIi_GOm-0QXV-IGgDA&ved=0CBgQFjAA&usg=AFQjCNHaN4L8nQBIDfpgcOpD0hCsEuI1vA";
resultUrl = str.split('=')[1].split('/&sa')[0]; 
```

# webgl - Three.js 中的灯光不影响灯光后添加到场景中的网格

> ID：13895396
> 
> 赞同：0
> 
> 时间：2012-12-15T19:25:17.313
> 
> 标签：webgl, three.js

基本上，当我向场景添加灯光时，我需要等待约 100 毫秒才能添加网格，否则动态照明将不会应用于网格。在我当前的实现中，每当添加新灯时，我都会替换所有相关部分，尽管这似乎效率低下且错误。有更简单的方法吗？

# matlab - 在matlab中将标签放在节点上

> ID：13895399
> 
> 赞同：2
> 
> 时间：2012-12-15T19:25:52.333
> 
> 标签：matlab

我想在任何节点上放置标签，我用它的边缘绘制节点

```
gplot(adjacencyM,[A(1:2:end)',A(2:2:end)'],'-*'); 
```

结果是 ![在此处输入图像描述](../Images/56562b2a2477c467810e1a4ec2ea7a7f.png)

**如何在节点上放置标签？像 1 ,2,3 ,4 ,5,...**

`A=[52.4804497434472 27.6195191737248 4.21212076867730 30.4259790113270 48.7710166342266 39.0235130272618 77.6293705126495 27.8870044967533 8.53744606710097 96.9598745936163 17.0082513400534 1.22018736621158 45.2910471948658 19.6246954290650 32.3671095309084 46.6923831457201 52.0721582460992 13.2199644010638 9.61840162265927 40.9950628287157 ]`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:30:08.483

您可以使用 [Matlab 的`text`命令](http://www.mathworks.com/help/matlab/ref/text.html) 例如：

```
text( A(1,1), A(1,2), 'Label first node'); 
```

或循环：

```
for li=1:2:numel(A)
    text( A(li), A(li+1), sprintf('<--%d', li) );
end 
```

# java - Scanner 构造函数导致 bufferedReader 返回 null

> ID：13895401
> 
> 赞同：5
> 
> 时间：2012-12-15T19:25:59.560
> 
> 标签：java, constructor, null, java.util.scanner, bufferedreader

我试图做 -

```
BufferedReader br = new BuffereReader(file);
Scanner s = new Scanner(br);
sys.out(s.next());
sys.out(buffReader.readLine()); 
```

我期望发生的是现在文件上有两个不同的阅读器指向不同的位置。但是，buffReader 在 readLine 上返回 null，而扫描仪似乎工作正常。我有可能像我想要的那样拥有 2 个读者吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T00:21:47.420

> 我期望发生的是现在文件上有两个不同的阅读器指向不同的位置。

你的期望是错误的。首先，两者都连接到同一个基础文件，该文件只有一个当前位置。其次，Scanner 包裹在 BufferedReader 周围，因此由 Scanner 引起的任何位置变化都是*通过*BufferedReader 发生的。

# php - mysqli::$affected_rows 和 mysqli_stmt::$affected_rows 有什么区别？

> ID：13895406
> 
> 赞同：3
> 
> 时间：2012-12-15T19:26:32.963
> 
> 标签：php, mysqli

显然，`mysqli_stmt::$affected_rows`除非使用准备好的语句，否则不可用。但是当使用准备好的语句时*，*`mysqli::$affected_rows`和之间有什么区别`mysqli_stmt::$affected_rows`？

关于`mysqli::$insert_id`vs ，我有同样的问题`mysqli_stmt::$insert_id`。

我正在尝试决定是否应该使用一个来支持另一个。

我已经阅读了这些属性的 PHP 手册条目。我使用单次执行和多次执行进行了一些测试（PHP 5.3.17）。我看不出有什么不同。

所以我想知道在某些情况下（或某些版本）是否可能存在一些差异。如果它们完全相同，为什么两者都有？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:35:52.527

[`mysqli_stmt::$affected_rows`](http://php.net/manual/en/mysqli-stmt.affected-rows.php)：

> 返回最后执行的语句更改、删除或插入的总行数

[`mysqli::$affected_rows`](http://php.net/manual/en/mysqli.affected-rows.php)：

> 获取上一个 MySQL 操作中受影响的行数

因此，如果 mysqli_stmt 对象是最后执行的语句，则两个查询应该给出相同的结果。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:40:18.647

我认为保留的唯一原因`mysqli:$affected_rows`是`mysqli::query`and `mysqli::multi_query`，因为它们都不使用准备好的语句。唯一保留的原因`mysqli_stmt:$affected_rows`是OOP：将查询相关信息封装在语句对象中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-16T11:30:00.787

`mysqli_stmt::$affected_rows`我刚刚发现了和`mysqli::$affected_rows`我没想到的区别。

我假设`mysqli::$affected_rows`可以在关闭语句后调用它，因为我希望它根据*连接*上执行的最后一个查询进行报告。我认为如果声明被关闭并不重要。然而，它似乎确实有所作为。

**这段代码：**

```
$db_err_msg = 'Database Error: Failed to update profile';
$sql = "UPDATE tblProfiles SET lngPhoneNumber = ? WHERE lngProfileId = ?";
$stmt = $mysqli->prepare($sql) or output_error($db_err_msg);

$phone = 5555555555;
$id = 10773;
$stmt->bind_param('ii', $phone, $id) or output_error($db_err_msg);
$stmt->execute() or output_error($db_err_msg);

if ($mysqli->warning_count) {
    $warnings = $mysqli->get_warnings();
    do {
        trigger_error('Database Warning (' . $warnings->errno . '): '
            . $warnings->message, E_USER_WARNING);
    } while ( $warnings->next() );
}
else {
    echo 'no warnings', "\n\n";
}

echo 'Before $stmt->close()', "\n";
echo '$mysqli->affected_rows is ', $mysqli->affected_rows, "\n";
echo '$stmt->affected_rows is ', $stmt->affected_rows, "\n";
echo '$mysqli->affected_rows is ', $mysqli->affected_rows, "\n";

$stmt->close();
echo "\n", 'After $stmt->close()', "\n";
echo '$mysqli->affected_rows is ', $mysqli->affected_rows, "\n"; 
```

**产生这个输出：**

> 没有警告
> 
> $stmt->close() 之前
> $mysqli->affected_rows 为 1
> $stmt->affected_rows 为 1
> $mysqli->affected_rows 为 1
> 
> $stmt->close() 之后
> $mysqli->affected_rows 为 -1

请注意最终值如何为负 1。

**PHP手册`mysqli::$affected_rows`说：**

> -1 表示查询返回错误

查询按预期更新了记录，并且没有返回错误或警告。然而，这意味着有一个错误。我不确定这是否是一个错误，但这肯定不是我所期望的。无论您使用哪一种，显然最安全的方法是在执行语句之后立即检查它。

# javascript - 从 HTML 中动态加载和解析本地 HTML？

> ID：13895408
> 
> 赞同：0
> 
> 时间：2012-12-15T19:26:36.847
> 
> 标签：javascript, jquery

有点不寻常的设置：

我正在编写一个 html 页面，该页面又加载另一个 html 页面，对其进行解析、分析并显示有关它的信息。

使用 jQuery 进行解析相当容易。我只需要弄清楚如何加载外部页面 - 即当页面A在浏览器中显示时，它需要加载页面B，分析页面B，并显示有关页面B的信息。

两个页面都是本地的（不通过 Web 服务器提供）。

jQuery都`load`遇到`ajax`了跨域权限问题：

```
XMLHttpRequest cannot load file://localhost/Users/me/test.html. Origin null is not allowed by Access-Control-Allow-Origin. 
```

我可以用*脚本*标签加载页面，但是我不知道如何访问它，所以我可以解析它：

```
<script type="text/html" src="test.html"></script> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:33:58.997

您是否考虑过使用 JavaScript/jQuery 来创建 iframe？（您可以使用 CSS 使 iframe 对最终用户隐藏。）然后您可以侦听 iframe 的 onload 事件，并通过 iframe 的`contentDocument`元素解析它（我相信）。

# c - 改变茶壶的颜色有时不起作用

> ID：13895411
> 
> 赞同：0
> 
> 时间：2012-12-15T19:27:03.410
> 
> 标签：c, opengl, glut

这个程序应该允许用户选择茶壶的材料，它会动态变化。所以我做了一个菜单。
我使用 setRGB（在实用程序文件中声明）来设置 3 个 GLfloat 数组的颜色。
createMenu 只是创建从 va_list 读取声音的菜单。
setMaterial 根据通过枚举传递的值设置材质：

```
typedef enum
{
    BlackPlastic= 0,
    Brass,
    Bronze,
    Chrome,
    Copper,
    Gold,
    Peweter,
    Silver,
    PolishedSilver
}MaterialType; 
```

*我将省略我测试过的函数的主体，因为它们工作*：

```
int createMenu(void (*callback) (int),int key, const char* const first, ...)
{
    // creates a menu, the number of entries depends on the list length,
    // the value starts from zero
}

void setRGB( GLfloat* color, GLfloat red, GLfloat green, GLfloat blue)
{
    // Sets the color
}

void setMaterial (GLfloat** material, MaterialType type)
{
    // Sets the material color (ambient, diffuse, specular).
} 
```

这就是整个程序。我在这里担心的是我做错了什么，所以茶壶没有被绘制，因为 OpenGL 进入了无效状态。
*问题是有时我看不到在窗口中绘制的茶壶，我只是得到一个黑色的窗口*。令人难以置信的是，有时工作并且我看到了茶壶，并且我能够更改材料颜色。

```
#include <OpenGL/OpenGL.h>
#include <GLUT/GLUT.h>
#include "utility.h"
#include <stdlib.h>

GLfloat width=500, height=500;
GLfloat** material;
GLfloat light[3][3]= { {1,1,0}, {1,0.5,0}, {1,0,0} };

void menuCallback (int choice)
{
    setMaterial((GLfloat**)material, choice);
    glutPostRedisplay();
}

void init()
{
    glEnable(GL_DEPTH_TEST);
    glEnable(GL_BLEND);
    glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA);
    glMatrixMode(GL_PROJECTION);
    glLoadIdentity();
    glOrtho(-width/2, width/2, -height/2, height/2, 1, 1000);

    material= malloc(4*sizeof(GLfloat*));
    for(GLuint i=0; i<4; i++)
    {
        material[i]=malloc(3*sizeof(GLfloat));
    }

    setRGB(material[3], 1, 1, 0);
    setMaterial(material, BlackPlastic);
}

void display()
{
    glClearColor(0, 0, 0, 0);
    glClear(GL_COLOR_BUFFER_BIT);

    glShadeModel(GL_FLAT);

    glMaterialfv(GL_FRONT, GL_AMBIENT, material[0] );
    glMaterialfv(GL_FRONT, GL_DIFFUSE, material[1]);
    glMaterialfv(GL_FRONT, GL_SPECULAR, material[2]);
    glMaterialfv(GL_FRONT, GL_SHININESS, material[3] );

    glLightfv(GL_LIGHT0, GL_AMBIENT, light[0]);
    glLightfv(GL_LIGHT0, GL_DIFFUSE, light[1]);
    glLightfv(GL_LIGHT0, GL_SPECULAR, light[2]);

    glEnable(GL_LIGHT0);
    glEnable(GL_LIGHTING);

    glutSolidTeapot(100);

    glutSwapBuffers();
}

void keyboard(unsigned char key, int x, int y)
{
}

int main(int argc,char * argv[])
{
    glutInit(&argc, argv);
    glutInitDisplayMode(GLUT_RGBA | GLUT_DOUBLE );
    glutInitWindowPosition(100, 100);
    glutInitWindowSize(width,height);
    glutCreateWindow(*argv);
    createMenu(menuCallback, GLUT_LEFT_BUTTON, "Black Plastic", "Brass", "Bronze", "Chrome", "Copper", "Gold", "Peweter", "Silver", "Polished Silver", NULL);
    glutDisplayFunc(display);
    glutKeyboardFunc(keyboard);
    init();
    glutMainLoop();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T15:01:36.067

你画的是实心茶壶？我假设您启用了深度测试（尽管您的 glutInitDisplayMode 缺少深度缓冲区位）。无论如何，您可能还应该清除深度缓冲区。现在你只清除颜色缓冲区

```
glClear(GL_COLOR_BUFFER_BIT); 
```

把它改成

```
glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT); 
```

# android - RelativeLayout - 拖动自定义视图

> ID：13895422
> 
> 赞同：1
> 
> 时间：2012-12-15T19:28:37.283
> 
> 标签：android

我有一个带有 onTouch() 监听器的自定义视图。此视图被添加到 RelativeLayout，因此：

```
CustomView mv = new CustomView(mActivity);
RelativeLayout rl = ((RelativeLayout) mActivity.findViewById(R.id.main_layout));
rl.addView(mv); 
```

我希望在 API8 下用手指拖动视图，最好是通过驻留在视图自己的 onTouch() 侦听器中的代码。

大概就是setPadding()或者RelativeLayout.LayoutParams()边缘的几行代码，但是经过一小时的反复试验，还是找不到。

有什么线索吗？非常感谢。

PS：onTouch 工作正常，我只是不知道我可以添加哪些代码行来移动视图。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T00:54:55.430

我建议使用 FrameLayout 然后像这样更改 CustomView 的边距：

```
LayoutParams params = (FrameLayout.LayoutParams) mv.getLayoutParams();
params.leftMargin = x;
params.topMargin = y;
mv.setLayoutParams(params); 
```

希望这可以帮助。

# c# - 如何在运行时分隔字符串？

> ID：13895427
> 
> 赞同：0
> 
> 时间：2012-12-15T19:29:29.377
> 
> 标签：c#, regex

我正在寻找一个实用程序来使用正则表达式一次批量重命名一堆文件。我将一次重命名的文件遵循特定的命名约定，我想使用文件名中已有的数据将它们更改为新的命名约定；但目前并非我所有的文件都遵循相同的约定。

所以我希望能够编写一个通用程序，让我在运行时将文件名的模式输入到文本框中，以及我想从文件名中提取哪些标记以用于重命名。

例如 - 假设我有一个名为`[Coalgirls]_Suite_Precure_02_(1280x720_Blu-Ray_FLAC)_[33D74D55].mkv`. 我希望能够将此文件重命名为`Suite Precure - Ep 02 [Coalgirls][33D74D55].mkv`

这意味着我最好能够在重命名类似的东西之前进入我的程序`[%group%]_Suite_Precure_%ep%_(...)_[%crc%].mkv`，它会填充局部变量`group`,`ep`和`crc`在批量重命名中使用。

我正在考虑的一个特定程序是 mp3tag，用于将文件名转换为 id3 标签。它可以让您输入 %artist% - %album% - %tracknumber% - %title% 之类的内容，然后将这 4 个标记放入相应的 id3 标签中。

如何在不让用户知道正则表达式语法的情况下制作类似于此的系统？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T01:09:34.813

正如 usr 所提到的，您可以使用`%(?<name>[^%]+)%`. 这将为您提供“组”、“ep”和“crc”。

现在您需要扫描占位符之间的所有片段，并在正则表达式中的每个占位符处进行捕获。我将从上面遍历匹配项（您可以获得每个匹配项的开始偏移量和长度以浏览非占位符片段）。

（你的例子中有错误，我假设最后一部分是正确的，我放弃了神秘的（...））

它将构建一个如下所示的正则表达式：

`^%(?<group>.*?)_Suite_Precure_(?<ep>.*?)_(?<crc>.*?).mkv$`

将文字片段传递给 Regex.Escape，然后在正则表达式中使用它以正确处理麻烦的字符。

现在，对于每个文件名，您尝试将正则表达式与其匹配。如果匹配，您将获得该文件的占位符的值。然后获取这些占位符值并将它们合并到输出模式中，适当地替换占位符。这为您提供了新名称，您可以进行重命名。

```
using System;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Text.RegularExpressions;

namespace renamer
{
    class RenameImpl
    {
        public static IEnumerable<Tuple<string,string>> RenameWithPatterns(
            string path, string curpattern, string newpattern,
            bool caseSensitive)
        {
            var placeholderNames = new List<string>();

            // Extract all the cur_placeholders from the user's input pattern
            var input_regex = new Regex(@"(\%[^%]+\%)");
            var cur_matches = input_regex.Matches(curpattern);
            var new_matches = input_regex.Matches(newpattern);
            var regex_pattern = new StringBuilder();

            if (!caseSensitive)
                regex_pattern.Append("(?i)");
            regex_pattern.Append('^');

            // Do a pass over the matches and grab info about each capture
            var cur_placeholders = new List<Tuple<string, int, int>>();
            var new_placeholders = new List<Tuple<string, int, int>>();
            for (var i = 0; i < cur_matches.Count; ++i)
            {
                var m = cur_matches[i];
                cur_placeholders.Add(new Tuple<string, int, int>(
                    m.Value, m.Index, m.Length));
            }
            for (var i = 0; i < new_matches.Count; ++i)
            {
                var m = new_matches[i];
                new_placeholders.Add(new Tuple<string, int, int>(
                    m.Value, m.Index, m.Length));
            }

            // Build the regular expression
            for (var i = 0; i < cur_placeholders.Count; ++i)
            {
                var ph = cur_placeholders[i];

                // Get the literal before the first capture if it is the first
                if (i == 0 && ph.Item2 > 0)
                    regex_pattern.Append(Regex.Escape(
                        curpattern.Substring(0, ph.Item2)));

                // Generate the capture for the placeholder
                regex_pattern.AppendFormat("(?<{0}>.*?)",
                    ph.Item1.Replace("%", ""));

                // The literal after the placeholder
                if (i + 1 == cur_placeholders.Count)
                    regex_pattern.Append(Regex.Escape(
                        curpattern.Substring(ph.Item2 + ph.Item3)));
                else
                    regex_pattern.Append(Regex.Escape(
                        curpattern.Substring(ph.Item2 + ph.Item3,
                        cur_placeholders[i + 1].Item2 - (ph.Item2 + ph.Item3))));
            }

            regex_pattern.Append('$');

            var re = new Regex(regex_pattern.ToString());

            foreach (var pathname in Directory.EnumerateFileSystemEntries(path))
            {
                var file = Path.GetFileName(pathname);
                var m = re.Match(file);

                if (!m.Success)
                    continue;

                // New name is initially same as target pattern 
                var newname = newpattern;

                // Iterate through the placeholder names
                for (var i = new_placeholders.Count; i > 0; --i)
                {
                    // Target placeholder name
                    var tn = new_placeholders[i-1].Item1.Replace("%", "");

                    // Get captured value for this capture
                    var ct = m.Groups[tn].Value;

                    // Perform the replacement
                    newname = newname.Remove(new_placeholders[i - 1].Item2,
                        new_placeholders[i - 1].Item3);
                    newname = newname.Insert(new_placeholders[i - 1].Item2, ct);
                }

                newname = Path.Combine(path, newname);
                yield return new Tuple<string, string>(pathname, newname);
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:43:04.823

制作正则表达式模式`%(?<name>[^%]+)%`。这将捕获字符串中被百分号包围的所有标记。

然后，用于`Regex.Replace`替换它们：

```
var replaced = Regex.Replace(input, pattern, (Match m) => EvaluateToken(m.Groups["name"].Value)); 
```

`Regex.Replace`可以接受允许您提供动态值的回调。

# php - 中断父 IF（条件）

> ID：13895430
> 
> 赞同：-2
> 
> 时间：2012-12-15T19:29:34.090
> 
> 标签：php, conditional, break

如果在 PHP 中，我如何打破父级？

例如这段代码：

```
if(true){ // This is parent conditional
    if(true) { // This is child conditional
        break parent conditinal
    }
}

afterBreakDoMe(); 
```

从上面的代码。我想要当孩子条件为真时。然后它打破父条件（退出该条件）并继续其余代码（afterBreakDoMe（））。

更新 - 真实代码

```
 $errorMessage = '';
    if(isset($_POST) && count($_POST)) { // Detect some user input
        // validation
        $countryName = trim($_POST['countryName']);         
        if($countryName == ''){ // validation user input, if false. exit from parent if and continue show html input (refer to $Render->output())
            $errorMessage = 'Name must not be empty!'; 
        }

        header('Location: '.$baseUrl.'&page=tableShipping');
    }

    $Render->setTitle('Create New Country');
    $form = $Render->parser('createCountry', array(
        'errorMessage' => $errorMessage,
    ));
    $Render->addContent($form);

    $Render->output(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:03:14.633

你不能那样做（除了使用`goto`，这是禁忌），也不应该那样做。为了简单而交换功能是一个坏主意。

根据您的“真实”代码，您的程序流程没有意义。

```
if($countryName == ''){ // validation user input, if false. exit from parent if and continue show html input (refer to $Render->output()) 
```

那么，如果是`true`，您要设置`$errorMessage`，然后退出，离开页面，再也不使用它吗？为什么？您还不如忘记错误消息，调用`header()`，然后调用`exit;`.

我根据我*认为*您想要发生的事情创建了以下代码，并将其注释为解释：

```
$errorMessage = '';
if(isset($_POST) && count($_POST)) { // Detect some user input
    // validation
    $countryName = trim($_POST['countryName']);         
    if($countryName == ''){ // validation user input, if false. exit from parent if and continue show html input (refer to $Render->output())
        $errorMessage = 'Name must not be empty!'; 
    } else {
        // If there is no error, continue forward.
        header('Location: '.$baseUrl.'&page=tableShipping');
        exit; // Leave the page execution since you've applied a header.
    }
}

// This will only execute if there is an error, since we left the page otherwise.
$Render->setTitle('Create New Country');
$form = $Render->parser('createCountry', array(
    'errorMessage' => $errorMessage,
));
$Render->addContent($form);

$Render->output(); 
```

总而言之，考虑程序的流程以确定*接下来会发生什么*，而不是*跳过什么*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:37:44.410

简单的

```
if (true) {
   if (true) {
       // Do stuff
       // It will then break automaticly
       // but if the condition here is false you got the else ;)
   } else {

   }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T19:42:54.950

使用[goto](http://php.net/manual/en/control-structures.goto.php)。这用于跳转代码

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-15T19:48:19.027

```
$errorMessage = '';
do {
     if(isset($_POST) && count($_POST)) { // Detect some user input
        // validation
        $countryName = trim($_POST['countryName']);         
        if($countryName == ''){ // validation user input, if false. exit from parent if and continue show html input (refer to $Render->output())
            $errorMessage = 'Name must not be empty!';
            break;
        }

        header('Location: '.$baseUrl.'&page=tableShipping');
    }
while(false);// only for break 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-15T19:50:39.957

现在我可以阅读真正的代码示例，我认为您需要做的就是将所有条件放在一个单一的。使用`goto`将完成工作，但很容易使您的代码难以阅读和维护。也许是时候重新考虑程序流程了。无论如何，我要说的是这样的：

```
if(!empty($_POST) && isset($_POST['countryName']) && (trim($_POST['countryName']) == '')){
    $errorMessage = '名字不能为空！';
}

...

```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-15T20:37:08.063

您可以使用一个变量和一个额外的 if 语句：

```
$errorMessage = '';
$emptyCountry = false;
if(isset($_POST) && count($_POST)) { // Detect some user input
    // validation
    $emptyCountry = trim($_POST['countryName']) == '';
    if($emptyCountry){ // validation user input, if false.
        $errorMessage = 'Name must not be empty!'; 
    }

    header('Location: '.$baseUrl.'&page=tableShipping');
}
if (!emptyCountry) {
    $Render->setTitle('Create New Country');
    $form = $Render->parser('createCountry', array(
        'errorMessage' => $errorMessage,
    ));
    $Render->addContent($form);
}

$Render->output(); 
```

# c# - GridView 可以在没有包装 ScrollViewer 的情况下垂直滚动吗？

> ID：13895436
> 
> 赞同：2
> 
> 时间：2012-12-15T19:30:09.627
> 
> 标签：c#, xaml, windows-8

我有一个 GridView 绑定到我的 C# 中的数据源，当用户水平滚动时它会加载更多数据：

从 GridView.xaml：

```
<GridView Grid.Row="1" x:Name="GridViewStories" ItemsPanel="{StaticResource GridViewVerticalTemplate}" IsSwipeEnabled="False" SelectionMode="None" IsItemClickEnabled="True" ItemClick="GridViewStories_ItemClick" IncrementalLoadingTrigger="Edge">
    <GridView.ItemContainerTransitions>
        <TransitionCollection />
    </GridView.ItemContainerTransitions>
    <GridView.ItemTemplate>
        <DataTemplate>
            <Image Source="{Binding SquareImageURL}" Margin="10" Width="240" Height="160" />
        </DataTemplate>
    </GridView.ItemTemplate>
</GridView> 
```

我希望它在快照视图中表现得像 ListView，这意味着它应该垂直滚动而不是水平滚动。除了这个问题，我已经能够通过 VisualStateManager 改变我需要的一切：

从 GridView.xaml：

```
<VisualState x:Name="Snapped">
    <Storyboard>
        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="StackPanelHeader" Storyboard.TargetProperty="Visibility">
            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
        </ObjectAnimationUsingKeyFrames>
        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="StackPanelHeaderSnapped" Storyboard.TargetProperty="Visibility">
            <DiscreteObjectKeyFrame KeyTime="0" Value="Visible"/>
        </ObjectAnimationUsingKeyFrames>
        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="StackPanelHeaderPortrait" Storyboard.TargetProperty="Visibility">
            <DiscreteObjectKeyFrame KeyTime="0" Value="Collapsed"/>
        </ObjectAnimationUsingKeyFrames>
        <ObjectAnimationUsingKeyFrames Storyboard.TargetName="GridViewStories" Storyboard.TargetProperty="ItemsPanel">
            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource GridViewHorizontalTemplate}"/>
        </ObjectAnimationUsingKeyFrames>
    </Storyboard>
</VisualState> 
```

来自 StandardStyles.xaml：

```
<ItemsPanelTemplate x:Key="GridViewHorizontalTemplate">
    <WrapGrid Orientation="Horizontal" HorizontalAlignment="Center" MaximumRowsOrColumns="1" />
</ItemsPanelTemplate> 
```

我不想将 GridView 包装在 Scrollviewer 中，因为这样做会破坏我正在使用的内置增量加载。我意识到我可以只创建一个 ListView 并切换它和 GridView 的可见性，但我宁愿不必绑定到额外的控件并复制其他相关代码。想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T00:31:22.630

尝试将以下内容添加到您的`GridView`：

```
<GridView.ItemsPanel>
    <ItemsPanelTemplate>
        <StackPanel Orientation="Vertical"/>
    </ItemsPanelTemplate>
</GridView.ItemsPanel> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-06T11:58:34.600

```
<GridView Name="display"  ItemsSource="{Binding}" ScrollViewer.HorizontalScrollBarVisibility="Disabled" ScrollViewer.VerticalScrollMode="Enabled" ScrollViewer.VerticalScrollBarVisibility="Visible"  Height="550" Margin="0,0,0,0"  Grid.Row="1" RenderTransformOrigin="0.5,0.5"  SelectionMode="Single" >
    <GridView.RenderTransform>
        <CompositeTransform Rotation="0"/>
    </GridView.RenderTransform>
    <GridView.ItemsPanel>
        <ItemsPanelTemplate>
            <VariableSizedWrapGrid Orientation="Vertical" />
        </ItemsPanelTemplate>
    </GridView.ItemsPanel>
    <GridView.ItemTemplate>
        <DataTemplate>
            <StackPanel Orientation="Vertical">
                <StackPanel.Background>
                    <LinearGradientBrush EndPoint="0.5,1" StartPoint="0.5,0">
                        <GradientStop Color="#FFD3D9DE" Offset="1"/>
                        <GradientStop Color="#FFFAFBFB"/>
                    </LinearGradientBrush>

                </StackPanel.Background>
                <Grid x:Name="grdResultTxtBlock" VerticalAlignment="Center" HorizontalAlignment="Left" Width="500" Height="250" Margin="0,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="55" />
                        <RowDefinition Height="55" />
                        <RowDefinition Height="70"  />
                        <RowDefinition Height="50" />
                    </Grid.RowDefinitions>
                    <Grid Grid.Row="0">
                        <Button  Content="{Binding Call}" Height="40" Style="{StaticResource PnxButtonStyle}"   HorizontalAlignment="Left"
                         Margin="0,10,200,0" x:Name="btnXmit" VerticalAlignment="Top" Width="122" />

                        <TextBlock  x:Name="txtAddress" FontWeight="Bold"  Text="{Binding Address}" Margin="150,0,400,0" HorizontalAlignment="Left"  VerticalAlignment="Center"   Width="200"  />
                        </Grid>
                    </Grid>
              </StackPanel>
            </DataTemplate>
    </GridView.ItemTemplate>
</GridView> 
```

# c# - 分配数据源时，ASP.NET 元素为空

> ID：13895441
> 
> 赞同：0
> 
> 时间：2012-12-15T19:30:54.170
> 
> 标签：c#, asp.net, .net

出于某种原因，当我尝试在后面的代码中为其属性分配值时，我的 ASP.NET 标记中的所有对象现在都为空。

我的项目进展顺利，然后当我尝试将数据源分配给 GridView 时，出现空引用错误。

我不知道它为什么这样做。我没有做任何特别的事情。我只是想为页面上的 asp.net 元素的属性分配一个值。智能感知知道该元素在那里，并且在构建项目时我没有收到任何错误。就在我运行网站时，我得到了空引用。

几周以来，我一直在尝试解决此问题。请帮忙。

谢谢。

这是代码：

```
protected void Page_PreRender(object sender, EventArgs e)
{
    LoadData();
}

private void LoadData()
{
    Entities context = new Entities();
    var types = (from t in context.CustomerTypes
                 select t).OrderBy(t => t.TypeName);

    gvCustomerTypes.DataSource = types;
    gvCustomerTypes.DataBind();

} 
```

在标记中，gridview 看起来像这样：

```
<asp:GridView ID="gvCustomerTypes" runat="server" ShowHeader="true" GridLines="Both"
    AutoGenerateColumns="false" AlternatingRowStyle-BackColor="AliceBlue" Width="100%">
    <Columns>
        <asp:TemplateField HeaderText="Customer Type Name" HeaderStyle-HorizontalAlign="Left"
            ItemStyle-HorizontalAlign="Left">
            <ItemTemplate>
                <asp:Label ID="lblType" runat="server" Text='<%# Eval("TypeName") %>' />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Edit" HeaderStyle-HorizontalAlign="Center" ItemStyle-HorizontalAlign="Center">
            <ItemTemplate>
                <asp:HyperLink ID="HyperLink1" NavigateUrl='<%#Eval("CustomerTypeID", "CreateEditCustomerType.aspx?ID={0}") %>'
                    Text="Edit" runat="server" />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:TemplateField HeaderText="Delete" HeaderStyle-HorizontalAlign="Center" ItemStyle-HorizontalAlign="Center">
            <ItemTemplate>
                <asp:LinkButton ID="LinkButton1" CommandName='<%#Eval("CustomerTypeID") %>' OnClientClick="javascript:return confirm('Are you sure you want to delete this Customer Type?');"
                    OnCommand="DeleteCustomerType" Text="Delete" runat="server" />
            </ItemTemplate>
        </asp:TemplateField>
    </Columns>
</asp:GridView> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:57:06.803

我解决了这个问题！！耶！

我有一个带有 LoginView 控件的母版页。

在 LoginView 控件的登录视图中，我为使用该母版页的页面放置了内容占位符。因此，由于 LoginView 控件的登录视图模板，所有控件都返回 null。

我不完全确定为什么会这样，但至少我发现了我的空引用问题。

希望这可以避免其他人头疼。

# html - 用html5播放mp4文件

> ID：13895442
> 
> 赞同：0
> 
> 时间：2012-12-15T19:30:57.487
> 
> 标签：html

我正在尝试在 google chrome 上从我的服务器播放 mp4 文件。但是当按下播放时没有任何反应，它会亮一秒钟（这表明确实存在）但随后无法流式传输。如果我在 chrome 上启用 divx webplayer 扩展，它会通过 divx 播放器播放它，但是我需要它能够在没有该扩展的情况下播放它。这是我正在使用的代码：

```
<video width="560" height="340" controls>
<source src="hood.mp4" type='video/mp4; codecs="avc1.42E01E, mp4a.40.2" '>
</video> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:35:27.077

半答案：尝试使用[JWPlayer](http://www.longtailvideo.com/jw-player/)，它几乎可以播放任何东西，如果需要它会自动降级。（使用 HTML5 或 Flash）

# facebook - 如何向所有使用我的应用程序的用户发送群发通知

> ID：13895443
> 
> 赞同：0
> 
> 时间：2012-12-15T19:31:03.183
> 
> 标签：facebook, notifications

我正在使用 PHP SDK 开发 Facebook 应用程序。根据 FB Developer 文档，可以使用此方法发送通知；

POST /{recipient_userid}/notifications?access_token= … &template= … &href= …</p>

但是这个方法让我用“{recipient_userid}”值向用户发送通知。但我正在尝试向所有用户发送通知。我该怎么做？

通过查找所有使用应用程序的成员并在循环中一一发送通知？

感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-09T15:54:04.050

我还没有尝试过，但我认为 facebook 批处理请求是答案。

[https://developers.facebook.com/docs/reference/api/batch/](https://developers.facebook.com/docs/reference/api/batch/)

我经常需要向我的所有应用用户（大约 30000 名用户）发送通知，而且时间太长。逐个发送不能让您为所有用户发送即时通知，如果它有效，那么它也是可能的。

# node.js - 摩卡猫鼬错误

> ID：13895448
> 
> 赞同：4
> 
> 时间：2012-12-15T19:31:19.373
> 
> 标签：node.js, mongodb, mongoose, mocha.js

当 mongoose 尝试连接到 mongodb 时，我在 mocha 测试中收到以下错误：

```
Error: Trying to open unclosed connection. 
```

这是我的测试：

```
var cfg = require('../config')
, mongoose = require('mongoose')
, db = mongoose.connect(cfg.mongo.uri, cfg.mongo.db)
, User = require('../models/user')
, Item = require('../models/item')
, should = require('should')
, fakeUser
, fakeItem;

mongoose.connection.on('error', function(err){
    console.log(err);
});

describe('User', function(){
    beforeEach(function(done){
        //clear out db
        User.remove(done);

    });

    after(function(done){
        //clear out db
        User.remove(function(err){
            Item.remove(done);
        });
    });

}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-16T03:40:07.503

完成后关闭连接：

```
after(function(done){
    //clear out db
    User.remove(function(err){
        Item.remove(function() {
            mongoose.connection.close();
            done();
        });        
    });
}); 
```

# python - 允许 Python 应用程序继续运行直到用户结束

> ID：13895449
> 
> 赞同：1
> 
> 时间：2012-12-15T19:31:19.597
> 
> 标签：python, user-input

我对python很陌生，我写了一个简单的二十一点算牌应用程序。该应用程序运行并在用户输入结束后，我希望它继续要求用户输入并打印计数。我不希望它重新启动，我希望它继续。我已经包含了源代码。多谢你们。

```
count = 0

var = int(raw_input("Enter the value of the card: "))

if var == 1 :
      print count + 1
elif var == 2 :
      print count + 1
elif var == 3 :
      print count + 1
elif var == 4 :
      print count + 1
elif var == 5 :
      print count + 1
elif var == 6 :
      print count + 1
elif var == 7 :
      print count + 0
elif var == 8 :
      print count + 0 
elif var == 9 :
      print count + 0 
elif var == 10 :
      print count - 1 
elif var == 11 :
      print count - 1 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:46:03.397

要让程序一直运行到用户停止提供输入，您可能需要将代码放入循环中。当`while`您提前不知道需要循环多长时间时，循环通常是最好的。

```
count = 0
while True: # runs forever
    var = int(raw_input("Enter the value of the card: "))

    # if/elif block goes here 
```

但是，一旦这样做，您会发现代码中存在逻辑错误。`count + 1`目前，您每次都在 if/elif 块之一中打印或类似内容。但是，这不会修改 的值`count`，它只是直接打印新值。我认为您需要做的是更改代码以直接`count`在 if/else 块中修改，然后在单独的步骤中将其写出来。您还可以使用`<`or组合您的几个条件`>`，如下所示：

```
 if var < 7:
        count += 1
    elif var > 9:
        count -= 1

    print count 
```

您可以选择添加一些额外的错误检查以确保输入的值是适当的（例如，介于 1 和 11 之间），但为了清楚起见，我在此处将其关闭。

# c++ - 如何有效地用向量填充结构？

> ID：13895450
> 
> 赞同：1
> 
> 时间：2012-12-15T19:31:24.447
> 
> 标签：c++

我不是 C++ 专家，但我相信这不是最优雅的解决方案：

```
#include <iostream>
#include <vector>

struct coord {
    int x;
    int y;
};

int main()
{ std::vector<int> a {1,2,3,4,5};
  std::vector<int> b {10,20,30,40,50};
  int i;
  std::vector<coord> loc (5);
  for (i=0;i<5;i++)
  { loc[i].x = a[i];
    loc[i].y = b[i];
  }
  return 0;
} 
```

有没有人有更好的解决方案？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:34:34.117

看起来您正在使用 C++11。虽然我不是 100% 确定这应该有效：

```
std::vector<coord> loc { {1, 10}, {2, 20}, {3, 30}, {4, 40}, {5, 50} }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:35:29.160

你想通过创建两个向量来填充一个向量来完成什么？在将两个独立的向量声明为一个向量时，您的方法效率低下，而且还很混乱。删除两个向量并使用括号设置向量的值

* * *

`= { {val1,val2} {val1,val2} {val1,val2} }`

但是，如果您想坚持使用向量填充方法并且必须使用向量，那么只需一个向量即可同时保存 a 和 b 的值并像这样循环

```
//check to make sure size is even
for(int i = 0; i < vect.size(); i +=2)
{
    vect[i].x = a[i];
    vect[i].y = a[i+1];
} 
```

# string - S[3i]S[3i + 1]S[3i + 2] 的含义

> ID：13895454
> 
> 赞同：0
> 
> 时间：2012-12-15T19:31:48.677
> 
> 标签：string, algorithm, data-structures, suffix-array, array-algorithms

我无法理解以下内容：
我们有 String `ABRACADABRA`。我们以分组为例： `S`分组：

`S0 = <S[3i]S[3i + 1]S[3i + 2] for i = 0,1,2...>` where`<>`表示一个数组，S[i] 表示`S`position 中的字符`i`。

我期待这一点，`S0=<S[0]S[4]S[8]S[11]>`但根据我阅读的书中的“解决方案”，它`S0=[ABR][ACA][DAB][RA]`本质上不是`S[0]S[3]S[6]S[9]`.
那么我在公式中读错了`S0 = <S[3i]S[3i + 1]S[3i + 2] for i = 0,1,2...>`什么？

如果重要的话，它来自我读过的关于后缀数组的一章。我只有公式有问题

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:40:17.503

`S0=[ABR][ACA][DAB][RA]`不是`S[0]S[3]S[6]S[9]`。`S[0]S[3]S[6]S[9]`将是`AADR`。

这就是发生的事情：

对于`i=0`：
`<S[3i]S[3i+1]S[3i+2]> = <S[3*0]S[3*0+1]S[3*0+2]> = <S[0]S[1]S[2]> = <ABR>`

对于`i=1`：
`<S[3i]S[3i+1]S[3i+2]> = <S[3*1]S[3*1+1]S[3*1+2]> = <S[3]S[4]S[5]> = <ACA>`

对于`i=2`：
`<S[3i]S[3i+1]S[3i+2]> = <S[3*2]S[3*2+1]S[3*2+2]> = <S[6]S[7]S[8]> = <DAB>`

对于`i=3`：
`<S[3i]S[3i+1]S[3i+2]> = <S[3*3]S[3*3+1]S[3*3+2]> = <S[9]S[10]S[11]> = <RA >`

# java - 更改机器中的时区后，MYSQL 查询不起作用

> ID：13895458
> 
> 赞同：1
> 
> 时间：2012-12-15T19:32:18.470
> 
> 标签：java, mysql, date

对于我有时间戳和日期字段的大多数查询，我遇到了一些奇怪的问题，在我将时区从 PST 更改为 IST 后，工作正常的查询现在无法正常工作。

考虑这个查询，

```
select SQL_CALC_FOUND_ROWS * from `mydb`.`mytable` WHERE (Date(timestamp) BETWEEN '2013-12-01' and '2012-12-16') and scpets= 'accessories' and images = 'Yes' and videoflag = 'Yes' and maps = 'Yes' and flag = 1 and title LIKE '%Book%' order  by Date(timestamp) desc Limit 0, 100 
```

当我知道存在 2 条符合查询条件的记录时，我给了我 0 条记录。

现在，当我从查询中删除 between 子句时，它给了我正确的记录。我在这里迷失了现在在哪里进行更正，因为查询看起来非常好，并且正确的输入从我的程序传递到 sql 查询。所有标记为 Yes 的字段是枚举列。

此外，我的 SimpleDataParser 类在 2 周前工作正常，现在因无法解析的日期异常而失败。我修复了这个，但我的上述功能仍然被破坏。

有人可以建议我在我对笔记本电脑所做的更改之间有什么关系吗（我将笔记本电脑的时区从 PST 更改为 IST）。我的笔记本电脑上有 mysql 和 jdk 以及所有服务器。

现在我很害怕撤销更改，因为它可能会完全破坏我的应用程序，我真的不想做不必要的返工。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:18:45.887

啊，我的错，我正在搜索未来的日期（**2013-12-01** '和'2012-12-16），我在jquery datepicker中不好，我添加了默认日期+365而不是-365。问题已解决。我真的不知道为什么继续犯愚蠢的错误，然后浪费时间来纠正这些错误。

# jquery - MVC 3 动作获取参数为空

> ID：13895461
> 
> 赞同：0
> 
> 时间：2012-12-15T19:32:31.890
> 
> 标签：jquery, asp.net-mvc, asp.net-mvc-3

我`Fpr,`使用 jquery 将其序列化并发布到服务器。在 action 方法中，我尝试获取`List<T>`or的 or `IEnumerable<T>`，`object`但`List<T>`or`IEnumerable<T>`为空。如何将其发布到方法中，以便我将其作为 List 或`IEnumerable`.

```
var div = $("#TableForm").serialize();
$.post("../Controller/Action?Mode=" + Mode, div , function () { }); 
```

我序列化表单，序列化就可以了。问题只出在行动上——我得到了空值，请帮忙

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:56:47.083

首先，你不能序列化一个`table`对象：

HTML：

```
​&lt;table id="myTable">
    <tr>
        <td><input id='one' name='one' value='blah' /></td>
        <td><input id='two' name='two' value='moreblah' /></td>
    </tr>
</table>​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​​ 
```

JavaScript：

```
var serialized = ​$("#myTable").serialize();
debugger;​​​​​ 
```

`serialized`当代码在调试器中暂停时，您可以看到`""`空字符串。MVC 不知道如何将它模型绑定到您的 IEnumerable，因此它为空。

另一方面，如果你这样做：

```
var serialized = ​$("#one, #two").serialize();
debugger;​​​​​ 
```

那么`serialized`将等于`"one=blah&two=moreblah"`。

其次，如果您实际上绑定到 a`form`那么表中的所有输入元素都将被正确序列化。**但是**，输入元素的名称非常重要，因为您尝试将模型绑定到`IEnumerable<CafePlaced>`. 阅读 Phil Haack 撰写的关于模型绑定到列表的文章：http: [//haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

如果您没有正确执行此操作，那么 MVC 将不知道如何对绑定进行建模，并且您的参数将作为 null 传入。

# java - java中的二维字符串数组（带有本地土耳其字符）排序

> ID：13895464
> 
> 赞同：0
> 
> 时间：2012-12-15T19:32:36.673
> 
> 标签：java, sorting, multidimensional-array, arrays

我有一个二维字符串数组，它就像：

```
gsdfsdf | awfdsf 
asdasd  | sjd    
çsadsfd | kdjfkj 
bsdmfbs | skfjef 
ıfjdhsb | döjfn  
zewkjf  | skjfkj 
iadsa   | dfjdkj 
```

我想根据第一列对其进行排序，因为您看到它有本地（土耳其语）字符，排序后它必须像：

```
asdasd  | sjd    
bsdmfbs | skfjef 
çsadsfd | kdjfkj 
gsdfsdf | awfdsf 
ıfjdhsb | döjfn  
iadsa   | dfjdkj 
zewkjf  | skjfkj 
```

任何想法，教程或建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:04:55.323

不是一个完整的工作解决方案，而是一个提示。

Java 提供了一个[`Collator`](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/Collator.html)用于区域敏感字符串比较的类。

样品（含番石榴）：

## 富

```
package com.stackoverflow.so13895464;

import com.google.common.base.Joiner;
import com.google.common.base.Splitter;
import com.google.common.collect.Lists;

import java.text.Collator;
import java.util.Collections;
import java.util.Comparator;
import java.util.List;
import java.util.Locale;

public class Foo {
    public static String sortAndOutput(final String in)
    {
        final List<String> split = Lists.newArrayList(Splitter.on('\n').split(in));
        Collections.sort(split, new Comparator<String>() {
            @Override
            public int compare(String o1, String o2)
            {
               final Collator collator = Collator.getInstance(Locale.forLanguageTag("tr_TR"));
               // XXX: toUpperCase to avoid a dotless i problem (was at the end)
               return collator.compare(o1.toUpperCase(), o2.toUpperCase()); 
            }
        });
        return Joiner.on('\n').join(split);
    }
} 
```

## 足试

```
package com.stackoverflow.so13895464;

import org.junit.Test;

import static org.junit.Assert.*;

public class FooTest {
    @Test
    public void testSort()
    {
        final String in = "gsdfsdf | awfdsf\nasdasdsjd\nçsadsfd | kdjfkj\nbsdmfbs | skfjef\n" +  
            "ıfjdhsb | döjfn\nzewkjf  | skjfkj\niadsa   | dfjdkj";
        final String exp = "asdasd  | sjd\nbsdmfbs | skfjef\nçsadsfd | kdjfkj\ngsdfsdf | awfdsf\n" +
            "ıfjdhsb | döjfn\niadsa   | dfjdkj\nzewkjf  | skjfkj";
        assertEquals(exp, Foo.sortAndOutput(in));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:24:42.750

应该改进比较器以进行空检查，.. 等等，但这应该可以工作！

```
final String alphabet = "0123456789AaBbCcÇçDdEeFfGgĞğHhIıİiJjKkLlMmNnOoÖöPpQqRrSsŞşTtUuÜüVvWwXxYyZz";
SortedMap<String,String> map = new TreeMap(new Comparator<String>() {

        @Override
        public int compare(String o1, String o2) {
            int n = Math.min(o1.length(), o2.length());
            int i=0;
            while((i < n) && (o1.charAt(i) == o2.charAt(i))){
                i++;
            }
            if(i==n){
                return 0;
            }
            if(alphabet.indexOf(o1.charAt(i)) < alphabet.indexOf(o2.charAt(i))){
                return -1;
            }
            return 1;
        }
    }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T19:45:26.043

我不会使用二维字符串数组，而是使用[TreeMap](http://docs.oracle.com/javase/6/docs/api/java/util/TreeMap.html)。这将使您能够对 TreeMap 的键进行排序。默认情况下，这是自然排序的，因此它将按字母顺序排列，这是您需要的，尽管我不确定您想要土耳其字符的字母顺序。

```
TreeMap tm = new TreeMap(); 
// Put elements to the map 
tm.put("Zoe Doe", "First entry"); 
tm.put("Alex Smith", "Second entry"); 
tm.put("Gareth Baker", "Third entry");
// Get a set of the entries 
Set set = tm.entrySet(); 
// Get an iterator 
Iterator i = set.iterator(); 
// Display elements 
while(i.hasNext()) { 
Map.Entry me = (Map.Entry)i.next(); 
System.out.print(me.getKey() + ": "); 
System.out.println(me.getValue()); 
} 
```

这应该按字母顺序输出 TreeMap 的值：

*   亚历克斯·史密斯
*   加雷斯·贝克
*   佐伊·多伊

如果您需要更改它，那么您可以实现可比较并将其传递给 TreeMap 的构造函数：

```
TreeMap tm = new TreeMap(new Comparator<Foo>()
             {
                 public int compare(Foo f1, Foo f2)
                 {
                     return f1.toString().compareTo(f2.toString());
                 }        
             }); 
```

您必须将所需的逻辑放在上面的比较方法中。看起来您可能需要与标准字母顺序不同的实现。

# c++ - OpenCL C++ 绑定：等待单个 cl::Event？

> ID：13895467
> 
> 赞同：3
> 
> 时间：2012-12-15T19:32:57.497
> 
> 标签：c++, opencl

使用[OpenCL C++ 绑定](http://www.khronos.org/registry/cl/api/1.2/cl.hpp)（[文档](http://www.khronos.org/registry/cl/specs/opencl-cplusplus-1.1.pdf)），是否可以让排队的命令只等待**一个** `cl::Event`？

我们以`enqueueReadBuffer()`'s 的签名为例：

```
cl_int cl::CommandQueue::enqueueReadBuffer(
   ...
   const VECTOR_CLASS<Event>* events = NULL,
   ... ) 
```

它需要一个指向 a `VECTOR_CLASS`(eg `std::vector`) of的指针，`cl::Event`并且对于单个 的情况没有重载`cl::Event`。当然，可以将单个包装`cl::Event`成`VECTOR_CLASS`1 号的，但这似乎不是一个很好的解决方案。我想知道是否有更好的解决方案，因为等待单身`cl::Event`似乎是一件很常见的事情......

[请注意， OpenCL C API](http://www.khronos.org/registry/cl/api/1.2/cl.h)（[文档](http://www.khronos.org/registry/cl/sdk/1.2/docs/man/xhtml/)）中不存在此问题，您将指针传递给 a`cl_event`和`cl_event`读取的 s 数量。

```
cl_int clEnqueueReadBuffer ( 
    cl_command_queue command_queue,
    ...
    cl_uint num_events_in_wait_list,
    const cl_event* event_wait_list,
    ... ) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-29T23:17:38.817

也许您可以执行`event.wait()`然后将另一个事件排入队列。请参阅[此链接](http://kosobucki.pl/cl_doc/classcl_1_1Event.html#abb1dccd98dc3cee29bd6638bc71005cb)。

# java - Swing：更改选定的选项卡值

> ID：13895469
> 
> 赞同：1
> 
> 时间：2012-12-15T19:33:16.243
> 
> 标签：java, swing, jtabbedpane

我想更改所选选项卡的值，但我不知道如何！

```
private JTabbedPane tab = new JTabbedPane(); 
```

我用它来激活第二个选项卡，但它不起作用：`tab.getSelectedIndex()= 2`

如何更改选定的选项卡值？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:36:19.370

那将是：

```
tab.setSelectedIndex(2); 
```

所有可用的方法都可以在[这里](http://docs.oracle.com/javase/7/docs/api/javax/swing/JTabbedPane.html)找到。

# python - 如何将大量数据发布到 Django？

> ID：13895470
> 
> 赞同：5
> 
> 时间：2012-12-15T19:33:26.187
> 
> 标签：python, ajax, django, web

我正在尝试将文件列表发送到我的 Django 网站。每组传输以下信息：

*   文件名，
*   文件大小，
*   文件位置，
*   文件类型

**现在，假设我有 100 组这样的数据，我想将它发送到我的 Django 网站，我应该使用什么最好的方法？**

PS：我正在考虑使用 JSON，然后将该 JSON 数据发布到我的 Django URL。然后数据可能如下所示：

```
{
  "files": [
    { "filename":"Movie1" , "filesize":"702", "filelocation":"C:/", "filetype":"avi" }, 
    { "filename":"Movie2" , "filesize":"800", "filelocation":"C:/", "filetype":"avi" }, 
    { "filename":"Movie3" , "filesize":"900", "filelocation":"C:/", "filetype":"avi" }
  ]
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T06:56:28.817

我认为将 json 数据发送到您的服务器是有意义的。现在要实际实现它，您需要您的服务器接受`POST`您将用来发送有关文件的数据的 http 请求。

因此，服务器代码可能如下所示：

# 网址.py：

```
import myapp
#  ...
urlpatterns = patterns('', url(r'^json/$',myapp.serve_json), #http://<site_url>/json/ will accept your post requests, myapp is the app containing view functions
                         #add other urls
                      )
#other code 
```

# 视图.py

```
import json
def serve_json(request):
    if request.method == 'POST':
        if 'files' in request.POST:
            file_list = json.loads(request.POST['files'])

            for file in file_list:
                #do something with each file dictionary in file_list
                #...
            return HttpResponse("Sample message") #You may return a message 
    raise Http404 
```

现在在你的桌面应用程序中，一旦你有了文件字典的列表，你可以这样做：

```
import urllib,json
data = urllib.urlencode({'files':json.dumps(file_dict)}) #file_dict has the list of stats about the files
response = urllib.urlopen('http://example.com/json/', data)
print response.read() 
```

您也可以查看`urllib2`并`httplib`使用它们来代替`urllib`.

# c# - 为 windows phone 8 应用程序项目创建控制台窗口的最简单方法是什么？

> ID：13895473
> 
> 赞同：1
> 
> 时间：2012-12-15T19:33:37.720
> 
> 标签：c#, windows-phone-8

我有一个 windows phone 8 应用程序并希望创建一个控制台窗口用于调试输出目的。

我发现[这个链接](http://social.msdn.microsoft.com/forums/en-US/csharplanguage/thread/b7a14400-6d72-4fbf-9927-0966f69ef4a2/)基本上使用 DllImport 从 kernel32.dll 获取 AllocConsole()。

有没有更简单的方法？说，是否已经提供了任何 c# 函数，所以我不必 DllImport？

Visual Studio 中的调试输出窗口怎么样。从来没有用过。我应该使用它而不是创建控制台吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-15T20:20:10.817

您无法从 Windows Phone 访问控制台。您可以使用`System.Diagnostics.Debug.WriteLine()`. 当然，这仅在您连接了调试器时才有效...

# c# - 在 Visual Studio 2008 中打开 Visual Studio 2012 项目

> ID：13895479
> 
> 赞同：1
> 
> 时间：2012-12-15T19:34:24.520
> 
> 标签：c#, .net, visual-studio-2010, visual-studio, visual-studio-2012

我在 Visual Studio 2012 中使用 C# 编写应用程序，但我想在 Visual Studio 2008 的另一个地方打开该项目。我该怎么做？在储蓄我必须做点什么？还是在visualstudio 2008 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-14T11:38:00.473

由于我在家用计算机上使用 VS 2008，因此我经常必须这样做。

您可以手动修改解决方案文件 (*.sln)。大多数情况下，您只需更改定义解决方案的 VS 版本的前两行。

从[这个链接](http://bliblablog.net/open-vs-2012-solution-in-vs2008/)：

> 您可以手动编辑 sln 和 csproj/vbproj 文件并尝试这种方式，我使用这种方法没有副作用。在 sln 文件中，VS2010 的第一行会说
> 
> ```
> Microsoft Visual Studio Solution File, Format Version 11.00
> # Visual Studio 2010 
> ```
> 
> 对于 VS2008 解决方案：
> 
> ```
> Microsoft Visual Studio Solution File, Format Version 10.00
> # Visual Studio 2008 
> ```
> 
> 此外，在 2010 年的项目文件中，您可能会找到类似的部分
> 
> ```
> <Import Project="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v10.0\WebApplications\Microsoft.WebApplication.targets" /> 
> ```
> 
> 这将需要修改为
> 
> ```
> <Import Project="$(MSBuildExtensionsPath)\Microsoft\VisualStudio\v9.0\WebApplications\Microsoft.WebApplication.targets" /> 
> ```
> 
> 仅通过这两种类型的更改，我就能够使用 VS 2008 打开解决方案和项目。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:37:19.333

这是不可能的。

Visual Studio 通常不支持*前向兼容性*，即在旧版本的 Visual Studio 中打开新项目。它通常支持*向后兼容性*——在较新的 Visual Studio 中打开较旧的解决方案。

您唯一真正的选择是将其保留为 2008 年的解决方案；即使那样，当您在 2012 年打开它时，它可能会要求您将其转换为 2012 年的解决方案格式，这将使其在 2008 年无法使用。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T19:43:57.963

我在谷歌搜索时发现了这个。它可能对您的情况有用：

[Visual Studio 项目转换器](http://vsprojectconverter.codeplex.com/)

*免责声明：我没有亲自尝试过这个程序。*

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-22T07:46:33.920

我基本上有同样的需求，因为我想保持与 .net 3.5 的兼容性。尽管 VS2010 和 VS2012 支持在此 FW 版本上运行的项目，但仍有许多用户被公司强制使用 VS2008 或 2010。

我也可以在 2008 年发展，但作为一个极客，我什至不考虑它！:)

因此，我的解决方案是为每个 VS 版本创建单独的 *.sln 和 *.csproj 文件。这样，您就可以保证每个 VS 版本的一切都可以开箱即用。

我发现这样做的更简单快捷的方法是打开 eash VS 版本并创建空的解决方案和项目，其结构与原始版本相同，但名称上的 vs 版本如下：

*   我的解决方案.sln
*   我的.project.csproj
*   ...
*   我的.solution.vs2008.sln
*   my.project.vs2008.csproj
*   ...
*   我的.solution.vs2010.sln
*   my.project.vs2010.csproj
*   ...

请记住，您必须手动打开所有版本并添加新文件等等......它们不会自动同步，但它几乎可以工作。

希望这会有所帮助，干杯！

# r - 如何在 Levelplot 上显示矩阵值

> ID：13895480
> 
> 赞同：5
> 
> 时间：2012-12-15T19:34:25.513
> 
> 标签：r, visualization, data-visualization, lattice

[我在这里](https://www.dropbox.com/s/cqxj4wx2czi9j4e/J_H2S1T6_PassTraffic.csv)有一个矩阵数据，我用 `levelplot`. 地块放在下面。但我只是无法将这些值放入情节中，我的意思是我读[了这个问题](https://stackoverflow.com/questions/6569666/showing-data-values-on-levelplot-in-r)，但仍然无法弄清楚。

我怎样才能做到这一点 ？谢谢。

![](../Images/7f3ca3a9f3ea76e7b25b804b9a1e315c.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-15T20:10:07.017

您链接到的答案中的代码问题在于，它仅在 levelplot 公式中的对象命名为`x`、`y`和时才有效`z`。

这是一个使用更标准的习惯用法来处理传入自定义面板函数的参数的示例，因此变得更普遍适用：

```
library("lattice")

## Example data
x <- seq(pi/4, 5*pi, length.out=10)
y <- seq(pi/4, 5*pi, length.out=10)
grid <- expand.grid(X=x, Y=y)
grid$Z <- runif(100, -1, 1)

## Write a panel function (after examining 'args(panel.levelplot) to see what
## will be being passed on to the panel function by levelplot())
myPanel <- function(x, y, z, ...) {
    panel.levelplot(x,y,z,...)
    panel.text(x, y, round(z,1))
}

## Try it out
levelplot(Z ~ X*Y, grid, panel = myPanel) 
```

![在此处输入图像描述](../Images/849c337f3d11bdc02b1cb9a8f7b28be7.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-15T20:31:04.883

```
mat <- read.csv("J_H2S1T6_PassTraffic.csv", header=F)

y        <- as.numeric(mat[1,-1])
mat      <- mat[-1,-1]
n        <- dim(mat)[1] 
```

这里有一个修改，我生成一个新的比例

```
x <- seq(min(y), max(y), length.out=n)
grid     <- expand.grid(x=x, y=x)
mat      <- as.matrix(mat)
dim(mat) <- c(n*n,1)
grid$z   <- mat 
```

这里修改。我将矩阵的维度更改为向量以将其放入网格中。

```
mat <- as.matrix(mat)
dim(mat) <- c(n*n,1)
grid$z <- mat

p <- levelplot(z~x*y, grid, 
           panel=function(...) {
             arg <- list(...)
             panel.levelplot(...)
             panel.text(arg$x, arg$y,arg$z)},
           scales = list(y = list(at=y,labels=y),
                         x = list(at=y,labels=y)))

print(p) 
```

![在此处输入图像描述](../Images/533cd67d1e7c55c5a5b6131d501eb32d.png)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-15T20:27:44.840

另一种选择是使用`layer()`from **latticeExtra**。**它允许您使用ggplot2**爱好者`+`熟悉的运算符将一个图叠加在另一个图上：

 **```
library(latticeExtra)

## Applied to the example data in my other answer, this will produce
## an identical plot
levelplot(Z ~ X*Y, data = grid) +
layer(panel.text(X, Y, round(Z, 1)), data = grid) 
```**

# android - 将库包含到 android 项目中

> ID：13895488
> 
> 赞同：0
> 
> 时间：2012-12-15T19:35:20.667
> 
> 标签：android, eclipse, import, github, shared-libraries

我从 github 下载了一个库，并将其作为 android 项目导入。在这个在首选项-> Android 下调用库的库中，我将其设置为库项目，如下所示： ![在此处输入图像描述](../Images/520fa2c718bda5fbecfad8d9baef7d9b.png)

现在我想将这个库添加到我的名为 test 的 Android 项目中。所以我右键单击它，然后单击首选项-> Android，然后单击添加...并选择库，如下所示： ![在此处输入图像描述](../Images/e4345a93fa4a9e74b60e6e5c2d740997.png) 然后我点击确定并再次应用并确定。什么都没发生。之后，我再次单击右键单击我的项目，然后单击首选项-> Android，这是我看到的： ![在此处输入图像描述](../Images/31371ec42ab795536ddeaa330e244b43.png)

我应该怎么做才能让它正常工作？github 项目链接在[这里](https://github.com/SimonVT/android-numberpicker)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T03:59:11.573

我从git下载了项目并检查了它，eclipse的**.project**文件丢失了。

我的解决方案是创建一个新项目并使用这些资源

# php - 如何将路由器/路由注入到 phalcon 框架的应用程序中？

> ID：13895491
> 
> 赞同：0
> 
> 时间：2012-12-15T19:35:31.027
> 
> 标签：php, routing, phalcon

在这里，在文档中，写了关于如何创建路由： [http ://docs.phalconphp.com/en/latest/reference/routing.html](http://docs.phalconphp.com/en/latest/reference/routing.html)

但我找不到如何将它们注入应用程序。我需要做什么，让我的应用程序使用定义的路由？

我应该注入路由器（或如何注入？）

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-12-15T20:15:41.313

路由器可以通过这种方式在 DI 中注册（在您的 public/index.php 中）：

```
$di->set('router', function() {

    $router = new \Phalcon\Mvc\Router();

    $router->add("/login", array(       
        'controller' => 'login',
        'action' => 'index',
    ));

    $router->add("/products/:action", array(        
        'controller' => 'products',
        'action' => 1,
    ));

    return $router;
}); 
```

也可以通过这种方式将路由注册移动到应用程序中的单独文件（即 app/config/routes.php）：

```
$di->set('router', function(){
    require __DIR__.'/../app/config/routes.php';
    return $router;
}); 
```

然后在 app/config/routes.php 文件中：

```
<?php

$router = new \Phalcon\Mvc\Router();

$router->add("/login", array(       
    'controller' => 'login',
    'action' => 'index',
));

$router->add("/products/:action", array(        
    'controller' => 'products',
    'action' => 1,
));

return $router; 
```

示例：[https](https://github.com/phalcon/php-site/blob/master/public/index.php#L33) ://github.com/phalcon/php-site/blob/master/public/index.php#L33和[https://github.com/phalcon/php-site/blob/master/app/config/路由.php](https://github.com/phalcon/php-site/blob/master/app/config/routes.php)

# objective-c - 获取数组中最后一个对象的元素

> ID：13895494
> 
> 赞同：-1
> 
> 时间：2012-12-15T19:35:36.280
> 
> 标签：objective-c, ios

我有一个具有以下属性的`Person`( ) 类： , , .`NSObject``Number``Pin``Name`

假设我在一个数组中有“N”个人。我怎样才能找出最后一个人的`Number`, `pin`, `Name`.

我找到了以下方法，但我没有从中得到任何东西

```
id object=[myPersonArray lastObject]; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:37:44.573

利用：

```
Person *lastPerson = [myPersonArray lastObject]; 
```

现在您可以访问`lastPerson`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:45:34.243

您可以简单地找到数组的总大小，然后`count-1`给出最后一个对象的值。

```
int countArray = [myPersonArray count];

NSString *stringLastIndex = [myPersonArray objectAtIndex:countArray-1]; 
```

你`another solution`可以使用`[myPersonArray lastObject]`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T19:37:46.220

这是你应该做的：

```
Person *person = [myPersonArray lastObject];
NSLog("Name: %@", person.name); 
```

# ruby-on-rails - 如何从模块中调用此类方法？

> ID：13895508
> 
> 赞同：1
> 
> 时间：2012-12-15T19:36:46.533
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

首先，假设我对 Ruby 对象模型的理解非常不完整，我来自 C、PHP 和 Java。

现在，我的应用程序包含由多个模型共享的功能，因此我试图将该功能移动到一个模块中以保持干燥。每个模型都有一个需要序列化的“数据”属性。但是，当我将`serialize`调用移动到模块中时，我无法使其工作。这是基本模型：

```
class MyModel < ActiveRecord::Base
  include MyApp::Data
end 
```

这是模块：

```
module MyApp
  module Data
    serialize :data, ActiveRecord::Coders::Hstore

    def get_data(key)
      data && data[key]
    end

    def set_data(key, value)
      self.data = (data || {}).merge(key => value)
    end
  end
end 
```

当我尝试实例化包含 的模型时，`MyApp:Data`出现以下错误：

```
NoMethodError: undefined method `serialize' for MyApp::Data:Module 
```

我如何使它在我实例化时`MyModel`，`data`通过简单地包含来序列化属性`MyApp::Data`？

编辑：

我也试过这个：

```
module MyApp
  module Data
    def self.included(base)
      base.extend(ClassMethods)
    end

    module ClassMethods
      serialize :data, ActiveRecord::Coders::Hstore
    end

    def get_data(key)
      data && data[key]
    end

    def set_data(key, value)
      self.data = (data || {}).merge(key => value)
    end
  end
end 
```

不幸的是，我仍然遇到同样的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:47:36.567

正如您所写，它`serialize`在模块加载时被调用。serialize 的方法调用没有接收器，因此它是在 Data 模块上进行的。另一方面，您想在包含该模块的类上调用它。

您可以使用`self.included`钩子来执行此操作 - 每当包含模块并且正在执行包含的类作为参数传递时都会调用它，例如

```
module Data
  def self.included(base)
    base.serialize ...
  end
end 
```

有了主动支持，您还可以

```
module Data
  extend ActiveSupport::Concern

  included do
    serialize :data, ...
  end
end 
```

它为您设置 self.included 并评估该块，以便 self 成为包含类，而不是模块（如果您要调用的方法恰好是受保护/私有的，这可能很方便 - dsl 的东西不是充满时可读`base.send :blah`）

# css - 是否可以在 svg 节点上应用 css 转换？如果是，如何？

> ID：13895510
> 
> 赞同：1
> 
> 时间：2012-12-15T19:37:02.940
> 
> 标签：css, svg

假设我有一个简单的圆圈，我想使用 CSS 对其进行缩放。这种交互将通过侦听圆圈上的点击事件并以某种方式向其添加 CSS 类（结束帧动画类）来完成。

```
<svg xmlns="http://www.w3.org/2000/svg" version="1.1">
    <circle class='main-circle' cx="100" cy="50" r="40" 
      stroke="black" stroke-width="2" fill="red"/>
</svg> 
```

这个元素的类名是：

```
circleNode[0].className // SVGAnimatedString {animVal: "main-circle", baseVal: "main-circle"} 
```

jQuery在这里尝试：

[http://jsfiddle.net/EHfej/](http://jsfiddle.net/EHfej/)

在这种情况下 jQuery 将不起作用（请参阅错误[http://bugs.jquery.com/ticket/10329](http://bugs.jquery.com/ticket/10329)）。具有普通 dom 节点的 className 也不起作用。

我的猜测是，即使 jQuery 不支持 SVG 上的类操作，它仍然应该是可能的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T12:01:43.043

是的，这是可能的，但请注意并非所有属性都适用于 svg 元素。特别是由于您似乎对此感兴趣，`transform`因此您应该意识到这可能尚未在所有浏览器中的 svg 元素上都有效。如果该属性[在 SVG 1.1 中按要求](http://www.w3.org/TR/SVG11/styling.html)列出，那么它更有可能在当今的浏览器中工作。

在 svg 内容中设置类：

```
elm.className.baseVal = "yourclass"; 
```

或使用 setAttribute：

```
elm.setAttribute("class", "yourclass"); 
```

Firefox 和 Opera 还支持svg 元素上的HTML5 [classList ：](https://hacks.mozilla.org/2012/01/hidden-gems-of-html5-classlist/)

```
elm.classList.add("yourclass"); 
```

一些例子可以在[这里](http://xn--dahlstrm-t4a.net/svg/css3/transitions/)找到。

# jquery - 在同一选项卡中提交表单后，Jquery选项卡更新选项卡

> ID：13895513
> 
> 赞同：0
> 
> 时间：2012-12-15T19:37:23.810
> 
> 标签：jquery

我有一个包含 6 个选项卡（Jquery 选项卡）的页面，每个选项卡上都有一个表单。我看起来像一个简单的问题，但我正在打破我的头。我想`submit`在表单之后更新 div（选项卡） `submit`，当然还有一些操作（数据库更新）。

```
<form name="prijzen_huidige_jaar" method="post" action="<?php $_SERVER["PHP_SELF"] ?>"> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:48:41.347

你可以从这样的事情开始：

```
$(document).ready(function(){
  $('.form-to-submit').submit(function(){ // a class to give all your forms
    content = $(this).serialize();
    $.post('/path/to/script.php', content, function(data){
      if(data){ 
        // The script returned something in the "data" variable. Do things like:
        $('container').replaceWith(data);
      }
    });
  })
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:41:54.930

您是通过 ajax 获得更改吗？

如果是...您可以使用成功事件进行更改。

```
$.post(Url , function(data){
}).success(function(data){
  //Here you could do another post call to get your new data 
  $.post(refreshUrl,function(dataRefresh){
     //Your refresh here
  });
}); 
```

# c# - 没有为 .winmd 文件提供实现文件

> ID：13895517
> 
> 赞同：6
> 
> 时间：2012-12-15T19:37:49.160
> 
> 标签：c#, windows-8, bing-maps

在 VS2012 中构建 Windows 8 App 项目时出现警告：

```
No implementation file was provided for the .winmd file 'C:\Users\luke\LApp\LApp\bin\x86\Debug\Bing.Maps.winmd'. To generate registration information in the app manifest, specify the 'Implementation' metadata on the .winmd reference item in the project file. 
```

我真的不知道要提供什么其他信息。我用谷歌搜索过，它没有提供任何相关结果。它提供了一个链接：http: [//msdn.microsoft.com/en-us/library/hh708954.aspx](http://msdn.microsoft.com/en-us/library/hh708954.aspx)但我不确定它是否正确。我很确定我有正确的参考：

![在此处输入图像描述](../Images/5cf601a03df6dd2037fc236b232fc788.png)

这是一个 C# 项目。我使用 NuGet 添加 Bing Maps SDK，它在我的应用程序中运行 - 我可以在地图界面上拖动并在应用程序中使用它。这只是在构建时出现的警告，我不知道如何摆脱它。

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T09:51:57.947

你的项目是ac#项目吗？

通常使用 .NET 实现的 WinRT 组件只是 .winmd 文件。接口和实现都包含在 .winmd 文件中。而本机组件（用 C++ 编写的）将分别具有单独的 .winmd 和 .dll 文件用于接口和实现。

如果您可以提供有关您的应用程序项目和重现步骤的更多详细信息，将会很有帮助。

# php - MySQL 数据库条目不会加载？

> ID：13895518
> 
> 赞同：0
> 
> 时间：2012-12-15T19:38:03.747
> 
> 标签：php, mysql, codeigniter

这来自一个登录表单，其中电子邮件和密码作为 to 字段：

```
echo form_open('main/login_validation');

echo "<P>Email: </br>";
echo form_input('email',$this->input->post('email'));
echo "</P>";

echo "<P>Password: </br>";
echo form_password('password');
echo "</P>";

echo "<P>";

$img_path = base_url()."imgs/log_in_0.png";

echo '<input type="image" src="'.$img_path.'">';
echo "</P>";

echo form_close(); 
```

转到控制器进行表单验证：

```
$this->load->library('form_validation');

$this->form_validation->set_rules('email', 'Email', 'required|trim|xss_clean|callback_validate_credentials');

$this->form_validation->set_rules('password', 'Password', 'required|trim');

if($this->form_validation->run()){
        $data = array(
            'email' => $this->input->post('email'),
            'is_logged_in' => 1
        );
        $this->session->set_userdata($data);

        $nKey ='members';
        $this->page($nKey);
    } else {
        $nKey ='login';
        $this->page($nKey);
    } 
```

回调将其发送到：

```
public function validate_credentials(){
    $this->load->model('model_users');

    $salt = $this->model_users->get_salt();

    if($this->model_users->can_log_in($salt)){

        return true;
    }else{

    $this->form_validation->set_message('validate_credentials', 'Incorrect Email/Password.');
    return false;
    }

} 
```

当它调用 get_salt() 时，它会从模型中加载：

```
public function get_salt(){

    $this->db->where('email', $this->input->post('email'));

    $query = $this->db->get('users');

    if($query){

        $row = $query->row();

        $salt =  $row->salt;

        return $salt;
    }else{
        echo 'failed salt';

    }

} 
```

两天前同样的代码字很好，现在它给出了一个非对象错误：

```
$salt =  $row->salt; 
```

不会正确加载查询，我使用 codeigniter 从 post 数组`function $this->input->post('email')`回显，它回显了正确的电子邮件。

但是当我`print_r`查询时它返回一个空的查询对象，但是电子邮件在用户数据库表中（在电子邮件字段和所有内容中），我已经检查过了，几天前我正在使用同一个帐户进行测试

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:08:32.710

所以我收到了错误，因为我输入了错误的密码并且它确实测试了用户是否存在。

测试用户是否存在的代码：

[CodeIgniter - Checking to see if a value already exists in the database](https://stackoverflow.com/questions/4296930/codeigniter-checking-to-see-if-a-value-already-exists-in-the-database)

in the accepted answer

# javascript - 如何获取html元素的绝对DOM路径

> ID：13895522
> 
> 赞同：2
> 
> 时间：2012-12-15T19:38:48.283
> 
> 标签：javascript, html, dom

我在使用 html DOM 时遇到问题。

如何从此路径获取值：

`html body div table tbody tr td table tbody tr td table tbody tr td table tbody tr td form table tbody tr td`

我只能找到诸如此类的东西`getElementbyID/tag/name/class`。

如何获取`td`元素的绝对 DOM '路径'（假设该表中第二行的第三个单元格）？我一直在到处寻找，但如果不涉及 ID/Class 等，就找不到简单的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:45:17.247

您可以使用 querySelector()，[但它没有很好的支持](http://caniuse.com/queryselector)...

```
var elem = document.querySelector('html body div table tbody tr td table tbody tr td table tbody tr td table tbody tr td form table tbody tr td'); 
```

否则，只需使用允许您使用 CSS 选择器的库，例如 jQuery。

```
var $elem = $('html body div table tbody tr td table tbody tr td table tbody tr td table tbody tr td form table tbody tr td'); 
```

顺便说一句，像这样选择对于性能来说是*可怕的。*绝对可怕。阅读[CSS 选择器](http://csswizardry.com/2011/09/writing-efficient-css-selectors/)以了解原因。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T21:14:11.100

看起来你可能想要这样的东西：

对于以下示例 HTML，

```
<html>
  <head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="findit.js"></script>
  </head>
  <body>
    <div id="header">
      <h1>Welcome to my ASP.net site!</h1>
    </div>
    <div id="h440292">
      <table>
        <!-- tbody omitted, but some (all?) browsers add it -->
        <tr>
          <td>junk</td>
          <td>junk</td>
          <td>junk</td>
        </tr>
        <tr>
          <td>junk</td>
          <td>junk</td>
          <td>pick me!</td>
        </tr>
      </table>
    </div>
  </body>
</html> 
```

这个 jQuery 代码将找到显示“pick me!”的单元格。

```
$(function () {
    var $resultCell = $("body")
        .children("div").eq(1)
        .children("table")

        // Note I have to add this even though
        // I omitted the tbody in the HTML markup
        .children("tbody") 
        .children("tr").eq(1)
        .children("td").eq(2);
    alert($resultCell.text());
}); 
```

如果性能成为问题，您可能需要使用原生 DOM 方法进行类似的操作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T20:37:36.150

首先，考虑您是否真的需要完整路径。引用 ID 或类更健壮，因为它们的移动部分更少。

如果您需要完整路径，您可能希望使用 XPath，因为它是专门为按路径查找元素而设计的。

这是一个[简单的跨浏览器 XPath 库](https://github.com/andrejpavlovic/xpathjs)——还有很多其他的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-07-27T20:46:54.180

我正在玩这个想法。我希望能够在页面上找到任何节点（使用无头浏览器）。试图构建一个绝对节点路径我创建了一个递归函数，但我发现它并不完全独特，这很烦人。例如，在这里，每个帖子都是模板化的，因此在第三个响应中选择文本将显示与第一个帖子相同的 HTML 标签上的节点路径

```
const buildPath = (node) => {
  console.log(node);
  if(node.tagName !== "HTML") {
    path.unshift(node.tagName.toLowerCase())
    buildPath(node.parentNode)
  }
};
const path = [];
builtPath(<start node>);
document.querySelector(path.join(" ")) 
```

但这就是我现在卡住的地方。有些东西没有任何特定的类或名称或 ID 可以添加到其中。我可能需要捕获 innertext 或 innerhtml 并尝试匹配它。有点烦。我想您可以像 D3 一样加载并注入一个增量 ID 作为数据，但是站点根本无法更改，这对于这种方法也可能是正确的，但我认为更少。

# python - 读取过程输出

> ID：13895526
> 
> 赞同：2
> 
> 时间：2012-12-15T19:38:57.040
> 
> 标签：python, console, popen

我正在 python 调试器（pdb）上编写一个简单的包装器，我需要解析 pdb 输出。但是我从进程管道中读取文本时遇到问题。

我的代码示例：

```
import subprocess, threading, time

def readProcessOutput(process):
    while not process.poll():
        print(process.stdout.readline())

process = subprocess.Popen('python -m pdb script.py', shell=True, universal_newlines=True,
                           stdout=subprocess.PIPE, stderr=subprocess.STDOUT, stdin=subprocess.PIPE)
read_thread = threading.Thread(target=readProcessOutput, args=(process,))
read_thread.start()

while True:
    time.sleep(0.5) 
```

当我在 OS shell 中执行给定的命令（python -m pdb script.py）时，我得到如下结果：

```
> c:\develop\script.py(1)<module>()
-> print('hello, world!')
(Pdb) 
```

但是当我运行我的脚本时，我只得到两行，但不能得到 pdb 提示。在此之后向标准输入写入命令无效。所以我的问题是：为什么我不能阅读第三行？我怎样才能避免这个问题并获得正确的输出？

平台：Windows XP、Python 3.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T03:53:13.967

第三行无法读取，`readline()`因为它尚未在行尾终止。您通常会在“（pdb）”之后看到光标，直到您写任何东西+输入。

与有一些提示的进程的通信通常更复杂。它向我证明，首先还要为数据写入器编写一个独立线程，以便更轻松地测试通信，以确保在尝试写入或读取过多时主线程永远不会冻结。然后可以再次简化。

# c# - 调用带有按键异常的隐藏表单

> ID：13895535
> 
> 赞同：1
> 
> 时间：2012-12-15T19:41:18.270
> 
> 标签：c#, winforms, exception

> **可能重复：**
> [检测到 globalKeyboardHook 中的 CallbackOnCollectedDelegate](https://stackoverflow.com/questions/9957544/callbackoncollecteddelegate-in-globalkeyboardhook-was-detected)

我遇到了一个异常，将我的主要（也是唯一的）表单从不可见状态中调用回来。我有一个钥匙钩来观察一个让它再次可见的钥匙。但是，问题是，当按下键并加载表单时，我遇到了这个异常

> 对“MyProgram!Utilities.globalKeyboardHook+keyboardHookProc::Invoke”类型的垃圾收集委托进行了回调。这可能会导致应用程序崩溃、损坏和数据丢失。将委托传递给非托管代码时，托管应用程序必须使它们保持活动状态，直到保证它们永远不会被调用。

因为这是我第一次处理关键钩子，或者在不使用其他表单的情况下带回一个表单，所以我在这里有点茫然。我不确定它想要达到什么目的。我是否应该将表单的不透明度设置为 0，以防止程序尝试关闭表单？

> 公共部分类Form1：Form {

```
 //Variables

    globalKeyboardHook gkh = new globalKeyboardHook();

    public Form1()
    {
        InitializeComponent();
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        gkh.HookedKeys.Add(Keys.A);
        gkh.HookedKeys.Add(Keys.Left);
        gkh.KeyDown += new KeyEventHandler(gkh_KeyDown);
        gkh.KeyUp += new KeyEventHandler(gkh_KeyUp);
    }

    private void OpacityBar_ValueChanged(object sender, EventArgs e)
    {
        //Do stuff

    private void VisibleTSMI_Click(object sender, EventArgs e)
    {
        //Do more un-important stuff
    }

    void gkh_KeyUp(object sender, KeyEventArgs e)
    {
        if (KeyDown == true)
        {
            this.Visible = true;
        }

        e.Handled = true;
    }

    void gkh_KeyDown(object sender, KeyEventArgs e)
    {
        KeyDown = true;
        e.Handled = true;
    }

    class globalKeyboardHook
    {
        #region Constant, Structure and Delegate Definitions
        /// <summary>
        /// defines the callback type for the hook
        /// </summary>
        public delegate int keyboardHookProc(int code, int wParam, ref keyboardHookStruct lParam);

        public struct keyboardHookStruct
        {
            public int vkCode;
            public int scanCode;
            public int flags;
            public int time;
            public int dwExtraInfo;
        }

        const int WH_KEYBOARD_LL = 13;
        const int WM_KEYDOWN = 0x100;
        const int WM_KEYUP = 0x101;
        const int WM_SYSKEYDOWN = 0x104;
        const int WM_SYSKEYUP = 0x105;
        #endregion

        #region Instance Variables
        /// <summary>
        /// The collections of keys to watch for
        /// </summary>
        public List<Keys> HookedKeys = new List<Keys>();
        /// <summary>
        /// Handle to the hook, need this to unhook and call the next hook
        /// </summary>
        IntPtr hhook = IntPtr.Zero;
        #endregion

        #region Events
        /// <summary>
        /// Occurs when one of the hooked keys is pressed
        /// </summary>
        public event KeyEventHandler KeyDown;
        /// <summary>
        /// Occurs when one of the hooked keys is released
        /// </summary>
        public event KeyEventHandler KeyUp;
        #endregion

        #region Constructors and Destructors
        /// <summary>
        /// Initializes a new instance of the <see cref="globalKeyboardHook"/> class and installs the keyboard hook.
        /// </summary>
        public globalKeyboardHook()
        {
            hook();
        }

        /// <summary>
        /// Releases unmanaged resources and performs other cleanup operations before the
        /// <see cref="globalKeyboardHook"/> is reclaimed by garbage collection and uninstalls the keyboard hook.
        /// </summary>
        ~globalKeyboardHook()
        {
            unhook();
        }
        #endregion

        #region Public Methods
        /// <summary>
        /// Installs the global hook
        /// </summary>
        public void hook()
        {
            IntPtr hInstance = LoadLibrary("User32");
            hhook = SetWindowsHookEx(WH_KEYBOARD_LL, hookProc, hInstance, 0);
        }

        /// <summary>
        /// Uninstalls the global hook
        /// </summary>
        public void unhook()
        {
            UnhookWindowsHookEx(hhook);
        }

        /// <summary>
        /// The callback for the keyboard hook
        /// </summary>
        /// <param name="code">The hook code, if it isn't >= 0, the function shouldn't do anyting</param>
        /// <param name="wParam">The event type</param>
        /// <param name="lParam">The keyhook event information</param>
        /// <returns></returns>
        public int hookProc(int code, int wParam, ref keyboardHookStruct lParam)
        {
            if (code >= 0)
            {
                Keys key = (Keys)lParam.vkCode;
                if (HookedKeys.Contains(key))
                {
                    KeyEventArgs kea = new KeyEventArgs(key);
                    if ((wParam == WM_KEYDOWN || wParam == WM_SYSKEYDOWN) && (KeyDown != null))
                    {
                        KeyDown(this, kea);
                    }
                    else if ((wParam == WM_KEYUP || wParam == WM_SYSKEYUP) && (KeyUp != null))
                    {
                        KeyUp(this, kea);
                    }
                    if (kea.Handled)
                        return 1;
                }
            }
            return CallNextHookEx(hhook, code, wParam, ref lParam);
        }
        #endregion

        #region DLL imports
        /// <summary>
        /// Sets the windows hook, do the desired event, one of hInstance or threadId must be non-null
        /// </summary>
        /// <param name="idHook">The id of the event you want to hook</param>
        /// <param name="callback">The callback.</param>
        /// <param name="hInstance">The handle you want to attach the event to, can be null</param>
        /// <param name="threadId">The thread you want to attach the event to, can be null</param>
        /// <returns>a handle to the desired hook</returns>
        [DllImport("user32.dll")]
        static extern IntPtr SetWindowsHookEx(int idHook, keyboardHookProc callback, IntPtr hInstance, uint threadId);

        /// <summary>
        /// Unhooks the windows hook.
        /// </summary>
        /// <param name="hInstance">The hook handle that was returned from SetWindowsHookEx</param>
        /// <returns>True if successful, false otherwise</returns>
        [DllImport("user32.dll")]
        static extern bool UnhookWindowsHookEx(IntPtr hInstance);

        /// <summary>
        /// Calls the next hook.
        /// </summary>
        /// <param name="idHook">The hook id</param>
        /// <param name="nCode">The hook code</param>
        /// <param name="wParam">The wparam.</param>
        /// <param name="lParam">The lparam.</param>
        /// <returns></returns>
        [DllImport("user32.dll")]
        static extern int CallNextHookEx(IntPtr idHook, int nCode, int wParam, ref keyboardHookStruct lParam);

        /// <summary>
        /// Loads the library.
        /// </summary>
        /// <param name="lpFileName">Name of the library</param>
        /// <returns>A handle to the library</returns>
        [DllImport("kernel32.dll")]
        static extern IntPtr LoadLibrary(string lpFileName);
        #endregion
    }

} 
```

请注意; 没有更多的 Utilities 命名空间，因为我在将它与我的 Form1 代码合并后对其进行了刮擦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T21:42:32.027

我认为您在删除对实例的引用后试图访问您的`Utilities`实例，例如：

```
Utilities utilities = new Utilities();
SomeMethodDelegate method = utilities.SomeMethod();
// ...
utilities = someOtherUtilitiesInstanceOrNull;
method(); // This is referencing a method that is now probably collected by the garbage collector. 
```

`Utilities`当然，根据您的模型，将类设为静态可能是一个更好的主意。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T21:59:37.307

## 问题

您的问题是您将委托传递给非托管代码，但未在托管代码中保留对它的引用。由于您没有对它的引用，GC 假定它是安全的收集。

我无法在您的代码中查明它，因为您尚未发布任何内容，但这是一种可能性。

您可以隐式创建委托：

```
SomeUnmanagedMethod(someCallback); 
```

这转化为这样的东西：

```
SomeUnmanagedMethod(new SomeDelegate(someCallback)); 
```

如您所见，委托的新实例从未被引用，因此超出范围并被收集。

* * *

## 解决方案

您需要在托管代码中维护对您的委托的引用。一种方法是在您的`Utilities`类中创建一个静态变量：

```
static SomeDelegate callback; 
```

然后，您可以存储对委托的引用，替换原始代码。：

```
callback = someCallback;
SomeUnmanagedMethod(callback); 
```

* * *

不幸的是，我无法给出更具体的答案，因为您还没有发布任何代码。

另请参阅[此答案](https://stackoverflow.com/a/4855725/785745)。

# extjs - 动态添加项目到面板和列到网格

> ID：13895537
> 
> 赞同：3
> 
> 时间：2012-12-15T19:41:26.773
> 
> 标签：extjs, extjs4, extjs4.1, extjs4.2, extjs-grid

我正在使用 ExtJs 4.1 并尝试将项目动态添加到面板和列到网格。

我的要求

MainPanel`(Ext.panel.Panel)`有 2 个子项：

*   动态面板`(Ext.panel.Panel)`

    1.  我想将此面板动态添加到主面板。
    2.  然后...我想动态地将项目添加到 DynamicPanel，这些项目是**MainPanel**的配置，称为：“元素”
*   动态网格`(Ext.grid.Panel)`

    1.  我想再次将其动态添加到主面板。
    2.  我想动态地将列添加到 DynamicGrid，这些列又是**MainPanel**配置网格列的一部分。

我收到以下错误：

> this.dpanel 未定义
> [Break On This Error] this.dpanel.add(this.elements)

我的代码如下：

```
Ext.create('Ext.data.Store', {
    storeId: 'simpsonsStore',
    fields: ['name', 'email', 'phone', 'date', 'time'],
    data: {
        'items': [{
            "name": "Lisa",
                "email": "[EMAIL="
            lisa@simpsons.com "]lisa@simpsons.com[/EMAIL]",
                "phone": "555-111-1224",
                "date": "12/21/2012",
                "time": "12:22:33"
        }, {
            "name": "Bart",
                "email": "[EMAIL="
            bart@simpsons.com "]bart@simpsons.com[/EMAIL]",
                "phone": "555-222-1234",
                "date": "12/21/2012",
                "time": "12:22:33"
        }, {
            "name": "Homer",
                "email": "[EMAIL="
            home@simpsons.com "]home@simpsons.com[/EMAIL]",
                "phone": "555-222-1244",
                "date": "12/21/2012",
                "time": "12:22:33"
        }, {
            "name": "Marge",
                "email": "[EMAIL="
            marge@simpsons.com "]marge@simpsons.com[/EMAIL]",
                "phone": "555-222-1254",
                "date": "12/21/2012",
                "time": "12:22:33"
        }]
    },
    proxy: {
        type: 'memory',
        reader: {
            type: 'json',
            root: 'items'
        }
    }
});
Ext.define('DynamicGridPanel', {
    extends: 'Ext.grid.Panel',
    alias: 'widget.dynamicGridPanel',
    title: 'Simpsons',
    store: Ext.data.StoreManager.lookup('simpsonsStore'),
    selType: 'rowmodel',
    plugins: [
    Ext.create('Ext.grid.plugin.CellEditing', {
        clicksToEdit: 1
    })],
    height: 200,
    width: 200
});

Ext.define('DynamicPanel', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.dynamicPanel',
    title: 'DynamicAdd',
    width: 200,
    height: 200
});
Ext.define('MainPanel', {
    extend: 'Ext.panel.Panel',
    alias: 'widget.dynamicMainPanel',
    title: 'MainPanel',
    renderTo: Ext.getBody(),
    width: 600,
    height: 600,
    constructor: function (config) {
        var me = this;
        me.callParent(arguments);
        me.dpanel = Ext.create('DynamicPanel');
        me.dgridpanel = Ext.create('DynamicGridPanel');
        me.items = [this.dpanel, this.dgridpanel];
    }, //eo constructor
    onRender: function () {
        var me = this;
        me.callParent(arguments);
        //I am getting  error at the below lines saying the dpanel and dynamicGridPanel  undefined
        me.dpanel.add(this.elements);
        me.dynamicGridPanel.columns.add(this.gridcolumns);
    }
});
var panel1 = Ext.create('MainPanel', {
    gridcolumns: [{
        xtype: 'actioncolumn',
        width: 42,
        dataIndex: 'notes',
        processEvent: function () {
            return false;
        }
    }, {
        xtype: 'gridcolumn',
        header: 'Name',
        dataIndex: 'name',
        editor: 'textfield'
    }, {
        xtype: 'gridcolumn',
        header: 'Email',
        dataIndex: 'email',
        flex: 1,
        editor: {
            xtype: 'textfield',
            allowBlank: false
        }
    }, {
        header: 'Phone',
        dataIndex: 'phone'
    }, {
        xtype: 'gridcolumn',
        header: 'Date',
        dataIndex: 'date',
        flex: 1,
        editor: {
            xtype: 'datetextfield',
            allowBlank: false
        }
    }, {
        xtype: 'gridcolumn',
        header: 'Time',
        dataIndex: 'time',
        flex: 1,
        editor: {
            xtype: 'timetextfield',
            allowBlank: false
        }
    }],
    elements: [{
        xtype: 'numberfield',
        width: 70,
        tabIndex: 1,
        fieldLabel: 'Account No',
        itemId: 'acctno',
        labelAlign: 'top'
    }, {
        xtype: 'textfield',
        itemId: 'lastname',
        width: 90,
        tabIndex: 2,
        fieldLabel: 'Last Name',
        labelAlign: 'top'
    }, {
        xtype: 'textfield',
        itemId: 'firstname',
        width: 100,
        tabIndex: 3,
        fieldLabel: 'First Name',
        labelAlign: 'top'
    }]
}); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T00:47:29.553

在 initComponent 中创建子元素：

```
initComponent: function() {
   var me = this;
   me.dpanel = Ext.create('DynamicPanel');
   me.dgridpanel = Ext.create('DynamicGridPanel');
   me.items = [this.dpanel, this.dgridpanel]; 
   me.callParent(arguments);
} 
```

不要忘记为网格中的列定义要求配置：

```
columns: [] 
```

在此处查看该示例以在网格中动态添加列[http://neiliscoding.blogspot.de/2011/09/extjs4-dynamically-add-columns.html](http://neiliscoding.blogspot.de/2011/09/extjs4-dynamically-add-columns.html)

# windows - http.sys 实现

> ID：13895542
> 
> 赞同：3
> 
> 时间：2012-12-15T19:42:39.837
> 
> 标签：windows, communication, winsock, http.sys

我们都知道在我们的 Windows 中有一个名为 http.sys**内核模式驱动程序**的大型二进制文件，它为我们进行 HTTP 处理。这基本上就是我们所知道的一切。

但是今天我想：嘿，我们所有的网络东西，比如 TCP/IP 和诸如此类的东西都在这里，在用户空间——ws2_32.dll 的提供者（在 mswsock.dll 中）和它的所有朋友。由于有用户态组件，http.sys 无法使用它们。问题是：他们是怎么做到的？任何信息链接将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T21:34:04.013

我想 HTTP.SYS 利用[Windows 内核套接字](http://msdn.microsoft.com/en-us/library/windows/hardware/ff571093%28v=vs.85%29.aspx)来实现它的目标。也见[这里](http://blogs.msdn.com/b/wndp/archive/2006/02/24/538746.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T21:28:16.213

在这里找到了一个很好的答案：http: [//www.codemachine.com/article_tdi.html](http://www.codemachine.com/article_tdi.html)

Windows 中的网络似乎比 Winsock 向我们展示的要多得多。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T19:58:17.373

`http.sys`仅用作侦听 HTTP/HTTPS 请求的服务器组件 - 基本上 IIS 依赖它来实现良好的性能。它不用于使用 Winsock 库发出任何客户端请求。[你可以在这里](http://www.codeproject.com/Articles/437733/Demystify-http-sys-with-HttpSysManager)阅读更多。

# php - PHP：如何检测外部访问者的直接请求？

> ID：13895543
> 
> 赞同：3
> 
> 时间：2012-12-15T19:42:50.270
> 
> 标签：php, jquery, dialog, http-referer

我想检测/防止/转发外部访问者的直接请求。某些脚本只应显示在 jQuery 对话框中。

我当前的代码：

```
<script>
$(".dialog").click(function() {
    // some code for validation
    // ...
    $("#dialog").load(this.href).dialog();
});
</script>    

<a href="http://domain.de/path/to/form/" class="dialog">Open me in a dialog</a> 
```

这很好，但如果我在新选项卡/窗口中打开此链接（例如，通过单击鼠标中键），表单将显示为“裸”。

在这种情况下，我想将用户转发到所引用的页面，例如：

```
if ($requester != $server) {
    header ("Location: " . $_SERVER["HTTP_REFERER"];
} 
```

如何检测 $requester 和 $server？我不想阻止每个脚本或整个目录！

提前致谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:12:03.713

要添加@Dharman 建议的内容，jQuery 会在其所有调用的 ajax 请求中添加一个标头，以便您可以简单地检查全局数组`HTTP_X_REQUESTED_WITH`中的此标头。`$_SERVER`

例子：

```
if($_SERVER['HTTP_REFERER']!=$_SERVER["HTTP_HOST"].$_SERVER["REQUEST_URI"])
{
    // check if the request is ajax 
    if(isset($_SERVER['HTTP_X_REQUESTED_WITH']) &&
          $_SERVER['HTTP_X_REQUESTED_WITH']  == 'XMLHttpRequest' ){
          // ajax content loading
    }

    header ("Location: index.php");
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T19:48:06.187

```
if($_SERVER['HTTP_REFERER']!=$_SERVER["HTTP_HOST"].$_SERVER["REQUEST_URI"])
{
    header ("Location: index.php");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-06-01T15:00:45.033

我有这些值来自外部请求：

> [HTTP_HOST] => 104.219.42.237
> 
> [HTTP_REFERER] => http://someurl.com

所以，我的解决方案是：

```
if (strpos($_SERVER['HTTP_REFERER'], $_SERVER['HTTP_HOST']) !== FALSE) {

    echo 'same origin/request';

} else {

   echo 'different origin/request';
} 
```

...

...

...

以前的解决方案不起作用的原因！

在我的情况下： $_SERVER['HTTP_REFERER'] == 'http://someurl.com'

而 $_SERVER["HTTP_HOST"] 不包含 'http' 和 'https'

所以，

```
if($_SERVER['HTTP_REFERER']!=$_SERVER["HTTP_HOST"].$_SERVER["REQUEST_URI"]) 
```

不匹配

另一个答案

```
if( $_SERVER['REMOTE_ADDR'] == $your_Server_IP_Address) 
```

不能在本地主机上工作

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-15T19:50:53.383

是的，您可以使用 $_SERVER['REMOTE_ADDR'] 检查请求发送者的 IP 地址的远程地址。像这样做：

```
if( $_SERVER['REMOTE_ADDR'] == $your_Server_IP_Address)
     echo 'From same server';
else
     echo 'from different server'; 
```

另一个可能的想法解决方案可能是使用[nonce](https://en.wikipedia.org/wiki/Cryptographic_nonce)：

*   显示表单时，在其中放置一个隐藏的输入字段，其中包含一个随机值

*   同时，将该随机值存储到与用户对应的会话中。

*   提交表单后，检查隐藏字段的值是否与会话中存储的值相同。

如果这两个值不相同，则拒绝使用提交的数据。

注意：这个想法经常被用来帮助对抗 CSRF——并集成在一些框架（例如 Zend 框架）的“表单”组件中。

# python - 从 django-cms CMSAttachMenu 获取视图 pk

> ID：13895548
> 
> 赞同：0
> 
> 时间：2012-12-15T19:43:13.113
> 
> 标签：python, django, django-cms

我在 django-cms 中有一个自定义应用程序，并且需要将子菜单附加到我的应用程序。我已经按照我找到的指南和示例来执行此操作（请参阅 Brandon 在此处给出的 Portfolio 示例：[Djangocms 中的自定义视图？](https://stackoverflow.com/questions/5964973/custom-views-within-djangocms#answer-5965596)），并设法启动并运行子菜单。

通过扩展上面提供的示例；如果这里展示的这个 Portfolio 应用程序包含少量不同的视图（创建视图、详细视图以及可能的其他几个相关视图）会怎样。如果我需要在这个小应用程序中构建一个子菜单来保存与用户导航相关的选项怎么办？如果导航应该根据视图中的所选内容呈现选择，则何时才能（仅选择“选项”或“类似”）。子菜单必须知道选择了什么投资组合，对吗？或者至少实际上选择并考虑了投资组合。

如何将我的视图已经知道的转移到我的 CMSAttachMenu 实现中？就我而言，我正在实现一个处理聚会或“事件”的应用程序。下面的示例不起作用，因为 Event 对象显然没有在请求中注册，但它说明了我想要的：

```
# menu.py
from django.core.urlresolvers import reverse
from menus.base import NavigationNode
from menus.menu_pool import menu_pool
from cms.menu_bases import CMSAttachMenu
from App.apps.event.models import Event
from django.utils.translation import ugettext_lazy as _
import logging

logger = logging.getLogger('instant.event')

class EventMenu(CMSAttachMenu):

    name = _("Event Sub-Menu")

    def get_nodes(self, request):
        nodes = []
        nodes.append(NavigationNode(_('Create new events'), reverse("admin:event_event_add"), 1 + len(nodes), 0))

        if hasattr(request, 'event'):
            if request.event.is_registered_to_event(request.user):
                nodes.append(NavigationNode(_('Unregister from this event'), reverse("unregister_from_event"), 1 + len(nodes), 0))
            else:
                nodes.append(NavigationNode(_('Register to participate in this event'), reverse("unregister_from_event"), 1 + len(nodes), 0))

        if request.user.is_superuser():
            nodes.append(NavigationNode(_('Register other participant to this event'), reverse("register_admin", args=(request.event.id)), 1 + len(nodes), 0))

        nodes.append(NavigationNode(_('Back to list of events'), reverse("events"), 1 + len(nodes), 0))
    return nodes

menu_pool.register_menu(EventMenu) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T21:45:24.463

这是一个困难的问题，但以下将解决它（仅显示相关部分）：

**cms_app.py**

```
from cms.app_base import CMSApp
from cms.apphook_pool import apphook_pool
from django.utils.translation import ugettext_lazy as _

class EventsApphook(CMSApp):
    name = _("Event")
    urls = ["App.apps.event.urls"]
apphook_pool.register(EventsApphook) 
```

**菜单.py**

```
from cms.menu_bases import CMSAttachMenu
from menus.base import NavigationNode
from menus.menu_pool import menu_pool
from django.utils.translation import ugettext_lazy as _

menuNodes = []

class EventMenu(CMSAttachMenu):
    name = _("Event Sub-Menu")
    def get_nodes(self, request):
        return menuNodes
menu_pool.register_menu(EventMenu)

def add_menu_node(text, url):
    # only add a given url once
    if len(list(n for n in menuNodes if n.url == url)) == 0:
        menuNodes.append(NavigationNode(text, url, 1 + len(menuNodes), 0))
        menu_pool.clear() 
```

**视图.py**

```
from django.views.generic.detail import DetailView
from django.core.urlresolvers import reverse
from django.utils.translation import ugettext_lazy as _
from App.apps.event.menu import add_menu_node
from App.apps.event.models import Event

class EventMenuMixin(object):
    def get_context_data(self, **kwargs):
        context = super(EventMenuMixin, self).get_context_data(**kwargs)
        member = self.request.user

        if 'pk' in self.kwargs.keys():
            event = Event.objects.get(id=self.kwargs['pk'])
            if event.is_registered_to_event(member):
                add_menu_node(_('Unregister from this event'), reverse("unregister_from_event"))
            else:
                add_menu_node(_('Register to participate in this event'), reverse("register_to_event", args=(self.kwargs['pk'])))

        add_menu_node(_("Create new events"), reverse("admin:event_event_add"))
        return context

class EventDetailView(EventMenuMixin, DetailView):
    model = Event
    template_name = 'event/event_detail.html'
    context_object_name = 'event' 
```

我希望这能帮助和我遇到同样困境的其他人。

# java - 扫描仪和 nullPointerException

> ID：13895550
> 
> 赞同：-2
> 
> 时间：2012-12-15T19:43:24.370
> 
> 标签：java, arrays, input, nullpointerexception, java.util.scanner

我不知道为什么我会得到这个例外！我的方法很简单，它会循环填充我的并行数组这是我的方法

```
public void fillPhoneBook(){
    Scanner in = new Scanner(System.in);
    for(int i=0;i<this.names.length;i++){
        System.out.println("Enter Name:");
        this.names[i] =in.next();
        System.out.println("Enter Phone Number:");
        this.telephones[i]=in.next();//here start rising exception 
    }
    in.close(); 
```

我在第二次输入后得到了这个异常！`

**- - 更新 - -**

抱歉，问题在于初始化电话阵列

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:50:04.560

我已经创建了与您解释的相同的场景，但奇怪的是我没有遇到任何此类异常。请看下面的代码

```
public class TestScanner {
    String names[] = new String[10];
    String telephones[] = new String[10];

    public static void main(String a[]) {

        TestScanner p = new TestScanner();

        Scanner in = new Scanner(System.in);
        for (int i = 0; i < p.names.length; i++) {
            System.out.println("Enter Name:");
            p.names[i] = in.next();
            System.out.println("Enter Phone Number:");
            p.telephones[i] = in.next();// here start rising exception
        }
        in.close();

    }
} 
```

**输出**

```
Enter Name:
test1
Enter Phone Number:
123456
Enter Name:
test2
Enter Phone Number:
456789
Enter Name: 
```

# c# - 未插入 SQL 查询

> ID：13895551
> 
> 赞同：0
> 
> 时间：2012-12-15T19:43:24.703
> 
> 标签：c#, sql-server

我一直试图让我的查询运行一段时间，但它没有插入任何东西，也没有返回任何错误。

数据库连接已打开，连接成功。

该表称为错误日志并保存以下数据

```
- id (int autoincremental, Primary key, Unique)
- exception (varchar)
- time (DateTime)

exception = String(error message)
time = DateTime.Now 
```

这是代码：

```
 public void insertError(string error, DateTime time)
    {
        SqlCeParameter[] sqlParams = new SqlCeParameter[]  
        {  
           new SqlCeParameter("@exception", error), 
           new SqlCeParameter("@time", time)
        };

        try
        {
            cmd = new SqlCeCommand();
            cmd.Connection = connection;
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = "INSERT INTO errorlog (exception, time) VALUES(@exception, @time)";
            cmd.Parameters.AddRange(sqlParams);
            cmd.ExecuteNonQuery();
        }
        catch (Exception e)
        {
            Console.WriteLine(e.Message);
        }
    } 
```

任何帮助将不胜感激，在此先感谢。

**编辑** 删除了@exception 周围的引号

继承人的连接：

```
protected DataController()
    {
        try
        {
            string appPath = System.IO.Path.GetDirectoryName(Assembly.GetAssembly(typeof(DataController)).CodeBase).Replace(@"file:\", "") + @"\";
            string strCon = @"Data Source = " + appPath + @"Data\EasyShop.sdf";
            connection = new SqlCeConnection(strCon);
        }
        catch (Exception e)
        {

        }

        connection.Open();
    } 
```

最后它被调用的方式：

```
public bool log(string msg, bool timestamp = true)
    {
        DataController dc = DataController.Instance();
        dc.insertError(msg, DateTime.Today);

        return true;
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:54:28.347

1.  调试您的应用程序并查看是否`connection`准确指向您想要的数据库。还要检查您是否在同一数据库中查找插入的记录。
2.  如果您`connection`属于该事务，请检查它是否已提交。在事务提交之前，您不会看到插入的这些记录。
3.  在我看来，你`INSERT`错了。去掉周围的引号`@exception`
4.  打开 SQL Server Profiler，连接到您的数据库并检查您是否`INSERT`出现在其中。

# java - 了解Spring MVC中@ModelAttribute和@RequestAttribute注解的使用

> ID：13895552
> 
> 赞同：7
> 
> 时间：2012-12-15T19:43:34.670
> 
> 标签：java, spring, spring-mvc, data-binding, spring-annotations

我在 Spring MVC 中很新。目前我正在研究[Spring MVC Showcase](https://github.com/spring-projects/spring-mvc-showcase)，它展示了 Spring MVC Web 框架的特性。

我在理解此示例中如何处理自定义可解析 Web 参数时遇到了一些问题。

在实践中，我有以下情况。在我的*home.jsp*视图中，我有以下链接：

```
<a id="customArg" class="textLink" href="<c:url value="/data/custom" />">Custom</a> 
```

此链接生成一个对 URL 的 HTTP 请求：**“/data/custom”**

包含处理此请求的方法的控制器类具有以下代码：

```
@Controller
public class CustomArgumentController {

    @ModelAttribute
    void beforeInvokingHandlerMethod(HttpServletRequest request) {
        request.setAttribute("foo", "bar");
    }

    @RequestMapping(value="/data/custom", method=RequestMethod.GET)
    public @ResponseBody String custom(@RequestAttribute("foo") String foo) {
        return "Got 'foo' request attribute value '" + foo + "'";
    }

} 
```

处理这个 HTTP 请求的方法是**custom()**。因此当点击上一个链接时，HTTP 请求由自定义方法处理。

**我有一些问题要理解@RequestAttribute**注释究竟做了什么。我认为，在这种情况下，它将名为 foo 的请求属性绑定到一个新的 String foo 变量。但是这个属性是从哪里来的呢？这个变量是由 Spring 采用的吗？

好的，我的想法是这个请求属性取自 HttpServletRequest 对象。我是这么认为的，因为在这个类中，我还有一个**beforeInvokingHandlerMethod()**方法，它有一个说话的名字，所以这个方法似乎在 HttpServletRequest 对象中设置了一个属性，它有*name=foo*和*value=bar*，然后所以 custom() 方法可以使用这个值。

实际上我的输出是：

> 得到 'foo' 请求属性值 'bar'

为什么在**custom()**方法之前调用**beforeInvokingHandlerMethod()**？

 **以及为什么**beforeInvokingHandlerMethod()**被**@ModelAttribute**注释注释了？在这种情况下是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:59:22.537

这`RequestAttribute` 只不过是您在表单提交中传递的参数。让我们通过一个示例来理解

假设我有以下表格

```
<form action="...">
<input type=hidden name=param1 id=param1 value=test/>
</form> 
```

现在，如果我有以下控制器，该控制器与请求 url 映射，该请求 url 与以下表单提交映射。

```
@Controller
public class CustomArgumentController {

@ModelAttribute
void beforeInvokingHandlerMethod(HttpServletRequest request) {
    request.setAttribute("foo", "bar");
}

@RequestMapping(value="/data/custom", method=RequestMethod.GET)
public @ResponseBody String custom(@RequestAttribute("param1") String param1 ) {
    // Here, I will have value of param1 as test in String object which will be mapped my Spring itself
} 
```**

# web - WWW重写后Nginx重启警告

> ID：13895553
> 
> 赞同：1
> 
> 时间：2012-12-15T19:43:44.483
> 
> 标签：web, nginx, rewrite

我正在尝试对我的网站进行重写，以便将 eosgaming.com 重写为 www.eosgaming.com。

这是我的 virtual.conf

```
#
# A virtual host using mix of IP-, name-, and port-based configuration
#

#server {
#    listen       8000;
#    listen       somename:8080;
#    server_name  somename  alias  another.alias;

#    location / {
#        root   html;
#        index  index.html index.htm;
#    }
#}

server {
  listen 80;
  server_name eosgaming.com;
  rewrite ^/(.*) http://www.eosgaming.com/$1 permanent;
}

server {
    listen       80;
    server_name  .eosgaming.com;

    error_log /home/web/eosgaming.com/logs/error.log;

    root   /home/web/eosgaming.com/public_html/;
    index  index.html index.htm index.php;

    location ~ \.php$
    {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
}

server {
    listen       80;
    server_name  .forum.eosgaming.com;

    error_log /home/web/forums.eosgaming.com/logs/error.log;

    root   /home/web/forums.eosgaming.com/public_html/;
    index  index.html index.htm index.php;

    location ~ \.php$
    {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
}

server {
       listen   80;
       server_name .mysql.eosgaming.com;

       error_log /home/web/mysql.eosgaming.com/logs/error.log;

       root /usr/share/phpMyAdmin;

       location / {
           index  index.php;
       }

       ## Images and static content is treated different
       location ~* ^.+.(jpg|jpeg|gif|css|png|js|ico|xml)$ {
           access_log        off;
           expires           360d;
       }

       location ~ /\.ht {
           deny  all;
       }

       location ~ /(libraries|setup/frames|setup/libs) {
           deny all;
           return 404;
       }

       location ~ \.php$ {
           include /etc/nginx/fastcgi_params;
           fastcgi_pass 127.0.0.1:9000;
           fastcgi_index index.php;
           fastcgi_param SCRIPT_FILENAME /usr/share/phpMyAdmin$fastcgi_script_name;
       }
}

server {
    listen       80;
    server_name  .source.eosgaming.com;

    error_log /home/web/source.eosgaming.com/logs/error.log;

    root   /home/web/source.eosgaming.com/public_html/;
    index  index.html index.htm index.php;

    location ~ \.php$
    {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
} 
```

这是我得到的错误

```
[root@vd1 ~]# service nginx restart
nginx: [warn] conflicting server name "eosgaming.com" on 0.0.0.0:80, ignored
Stopping nginx:                                            [  OK  ]
Starting nginx: nginx: [warn] conflicting server name "eosgaming.com" on 0.0.0.0:80, ignored 
```

我该如何解决这个问题？我只想让我的网站添加 www。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:46:18.373

我建议将您的前两个服务器指令组合成一个，例如：

```
server {
    listen       80;
    server_name  eosgaming.com; #removed the . because its not needed

    if ($host ~* ^[^.]+\.[^.]+$) { #check if the host has no subdomain
        rewrite ^(.*)$ http://www.$host$1 permanent; #Rewrite the url to include www.
    }

    error_log /home/web/eosgaming.com/logs/error.log;

    root   /home/web/eosgaming.com/public_html/;
    index  index.html index.htm index.php;

    location ~ \.php$
    {
        fastcgi_pass 127.0.0.1:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:19:27.777

as`.eosgaming.com;`等价于`eosgaming.com *.eosgaming.com;`，会与 冲突`server_name eosgaming.com;`。

# c++ - EventType 不是类或命名空间

> ID：13895555
> 
> 赞同：1
> 
> 时间：2012-12-15T19:43:46.697
> 
> 标签：c++, codeblocks, sfml

我正在尝试使用 SFML 和[本](http://www.gamefromscratch.com/page/Game-From-Scratch-CPP-Edition-Part-3.aspx)教程制作一个简单的 2D 游戏。这是我在本教程中当前进度的代码：我遇到了 Event 类的枚举 EventType 的问题。成员变量名称为 Type。

```
 #include "stdafx.h"
 #include "SplashScreen.h"

 void SplashScreen::Show(sf::RenderWindow & renderWindow)
 {
    sf::Image image;
    if(image.LoadFromFile("images/SplashScreen.png") != true)
    {
     return;
    }

   sf::Sprite sprite(image);

   renderWindow.Draw(sprite);
   renderWindow.Display();

   sf::Event event;
   while(true)
   {
     while(renderWindow.GetEvent(event))
     {
       if( event.Type == sf::Event::EventType::KeyPressed
         || event.Type == sf::Event::EventType::MouseButtonPressed
         || event.Type == sf::Event::EventType::Closed )
       {
          return;
       }
     }
   }
 } 
```

这是我的 stdafx.h：

```
 // stdafx.h : include file for standard system include files,
 // or project specific include files that are used frequently, but
 // are changed infrequently
 //

 #ifndef STDAFX_H
 #define STDAFX_H

 #include <stdio.h>

 // TODO: reference additional headers your program requires here
 #include <SFML/System.hpp>
 #include <SFML/Graphics.hpp>
 #include <SFML/Window.hpp>
 #include <SFML/Audio.hpp>

 #include <map>
 #include <iostream>
 #include <cassert>

 #endif //STDAFX_H 
```

似乎它已包含 Event.hpp，因为我已经为事件自动完成工作。MouseButtonPressed 和所有其他枚举值出现`sf::Event::EventType::`在代码块中的作用域之后。我还检查了 Event.hpp 文件，它是正确的。我不明白为什么编译器会惹恼我。

当我尝试删除范围并只编写“event.Type == KeyPressed”时，编译器会说“Keypressed 未在此范围内声明”。我在 Ubuntu 12.04 上运行 Code Blocks 10.05。

知道怎么了？

编辑：[这](http://www.sfml-dev.org/documentation/1.6/Event_8hpp_source.php)是我的 Event.hpp

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:01:11.907

枚举的名称不是范围。只需替换`sf::Event::EventType::KeyPressed`为`sf::Event::KeyPressed`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-10-20T15:17:23.633

同事，你不直接包括 SF.h 吗？像这样：

# 包括

////// 并使用命名空间： using namespace sf;

//// 避免在整个句子之前使用 sf::=> //// sf::Event....

while(window.isOpen()) { //. `enter code here`..

```
Event event
while(window.pollEvent(event)
{`enter code here`
if(event.type == Event::KeyPressed)
  if(event.key.code == Keyboard::Up)
  `enter code here` 
```

# wpf - MVVM 绑定嵌套用户控件

> ID：13895556
> 
> 赞同：0
> 
> 时间：2012-12-15T19:43:46.697
> 
> 标签：wpf, mvvm, binding

我有 MainViewModel ，其中包含选项卡视图模型的集合。每个选项卡可以是不同类型的视图模型（不同的视图）。当用户添加新标签时，标签视图的正确类型被识别（基于视图模型），但它根本没有绑定。例如，一个视图模型包含 GridView，其中 itemsSource 设置为集合，但如果我在该集合的 get 属性上设置断点，它永远不会被命中。（但是当我实例化此视图模型时，我将此集合设置为新的 ObservableCollection，因此会触发 NotifyPropertyChanged 事件） - 所以我认为嵌套用户控件（视图模型）的数据上下文设置错误

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T00:57:52.900

通常在 MVVM 模型中，您使用数据模板绑定数据，该模板将您的视图模型对齐为数据类型，将视图对齐为您指定的视图。MVVM 通常遵循作为表示形式的视图模型和作为数据的视图模型，并且通常与 XAML 中的数据模板绑定，通常在 app.xaml 或专门创建的 MainWindowResources.xaml 文件中，用于类型和绑定的关系。

通常，当某些内容未正确绑定时，我经常发现因为视图已显示但视图模型未绑定到它，因此数据不知道如何显示或更新。

EG：在常用的MSDN参考MVVM： http: [//archive.msdn.microsoft.com/mag200902MVVM/Release/ProjectReleases.aspx? ReleaseId=2026](http://archive.msdn.microsoft.com/mag200902MVVM/Release/ProjectReleases.aspx?ReleaseId=2026)

```
<DataTemplate DataType="{x:Type vm:AllCustomersViewModel}">
<view:AllCustomersView />
</DataTemplate> 
```

# regex - notepad++ 正则表达式 - 删除括号和单独的值

> ID：13895560
> 
> 赞同：0
> 
> 时间：2012-12-15T19:44:23.517
> 
> 标签：regex, notepad++, replace

我有清单：

```
(1, 'Apple', '["5","8"]'),
...
(22, 'Mango', '["5","8"]'),
(23, 'Orange', '["5","8"]'),
(24, 'Banana', '["2","0"]'),
(25, 'Milk', '["2","0"]'),
...
(749, 'Bread', '["2","10"]'), 
```

我想像这样分隔括号中的值

```
(1, 'Apple', '5', '8'),
...
(22, 'Mango', '5', '8'),
(23, 'Orange', '5', '8'),
(24, 'Banana', '2', '0'),
(25, 'Milk', '2', "0'),
...
(749, 'Bread', '2','10'), 
```

使用记事本++“替换为”功能。我也对其他解决方案持开放态度。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T19:46:52.047

正则表达式替换以下所有实例：

```
'\["(.*?)","(.*?)"\]' 
```

和：

```
'\1','\2' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T19:46:29.590

这甚至不需要正则表达式。使用正常更换模式。然后你有三个通行证：

```
Find what:    ["
Replace with: (empty string)
Find what:    "]
Replace with: (empty string)
Find what:    "
Replace with: ' 
```

# django - 在 virtualenv 中下载 mod_wsgi

> ID：13895563
> 
> 赞同：0
> 
> 时间：2012-12-15T19:44:59.997
> 
> 标签：django, mod-wsgi

我正在尝试在安装了 Django 的 virtualenv 中配置 mod_wsgi。当我运行`./configure`命令时，我得到以下内容，看起来没问题：

```
checking for apxs2... no
checking for apxs... /usr/sbin/apxs
checking Apache version... 2.2.22
checking for python... /Users/talaniz/tmp/newproject/DJANGO/bin/python
configure: creating ./config.status
config.status: creating Makefile 
```

但是当我尝试运行时`make`，我得到了错误：`-bash: make: command not found`

问题：我看到下一步是`sudo make install`，我是否需要在 virtualenv 之外对其进行配置才能使其正常工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:50:38.297

我认为您不能将 mod_wsgi 安装到虚拟环境中。但是，您可以告诉 mod_wsgi 为每个站点使用特定的虚拟环境。

# c++ - DLL 中的 C++ 异常处理

> ID：13895564
> 
> 赞同：0
> 
> 时间：2012-12-15T19:45:08.727
> 
> 标签：c++, exception, dll, mingw, thrift

我知道，在 Stackoverflow 上有很多类似的问题。但是没有一个答案可以解决我的问题。

我正在创建以这种方式导出一些函数的 DLL：

```
extern "C" __declspec(dllexport) int init() { ... } 
```

我在 Windows XP 上使用 MinGW 4.4。中有例外`init()`，因为我使用的是 Apache Thrift，并且有类似`ttransport->open()`, where `ttransport`is`boost::shared_ptr<TTransport>`和`TTransport`-- Apache Thrift 的类的代码。`ttransport->open()`抛出`TTransportException`异常（`TTransportException`继承自）有可能出现的情况`std::exception`。

该异常使加载我的 DLL 的主机程序崩溃。主机程序是由第三个人编写的，我没有主机程序的代码。

因此，我在徘徊，为什么像这样的包装方法无济于事（主机程序以同样的方式崩溃）：

```
try
{
    ttransport->open();        
}
// or just catch(...)
catch (std::exception &e) // or, using TTransportException
{
    return 42;
} 
```

有人可以说我做错了什么吗？

*例外不是我的——全部都是在 Apache Thrifts 库中编写的，所以我别无选择。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T22:33:25.770

这只能通过[SEH](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680657%28v=vs.85%29.aspx)支持 - 大多数 C / C++ 编译器为此提供`__try`// ...... MINGW 不是其中之一......`__except``__finally`

有一些努力通过[宏](http://www.programmingunlimited.net/siteexec/content.cgi?page=mingw-seh)和/或[库添加对](http://www.programmingunlimited.net/siteexec/content.cgi?page=libseh)[SEH](http://msdn.microsoft.com/en-us/library/windows/desktop/ms680657%28v=vs.85%29.aspx)的支持。这些并不是真正的生产质量，它更像是“阿尔法代码”......所以我会避免在生产中未经彻底测试（并且很可能进行一些修改）的情况下使用它们......

另一点是，即使你让它在 MINGW 上工作，它仍然可能导致堆栈展开问题，因为为此你需要 MINGW 不为 SEH 提供的编译器支持 - 一些详细信息请参见[此处](https://stackoverflow.com/a/7244824/847363)。

# actionscript-3 - AS3 - 如何从位图中删除所有黑色和灰色，但保留颜色？

> ID：13895571
> 
> 赞同：1
> 
> 时间：2012-12-15T19:45:41.443
> 
> 标签：actionscript-3, flash, matrix, colormatrix, colormatrixfilter

我希望能够更改图像（特别是位图），以便在 ActionScript 3 中用白色替换所有深灰色和黑色像素，但保留图像中的所有其他颜色。我熟悉 ColorMatrixFilter 和 bitmapdata.threshold，但我不知道如何使用它们来定位我想要删除的颜色或在特定颜色范围内检查。有没有（有效的）方法可以做到这一点？

谢谢你的尽心帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T22:20:25.330

AS3 API 提供了关于如何使用阈值的很好的文档。你可以在[这里](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/display/BitmapData.html)找到它。他们的示例实际上检查了一定范围的颜色。我已经修改了他们的示例以解决您的问题。我还没有测试它，所以它可能需要一些调整。

```
var bmd2:BitmapData = new BitmapData(200, 200, true, 0xFFCCCCCC);
var pt:Point = new Point(0, 0);
var rect:Rectangle = new Rectangle(0, 0, 200, 200);
var threshold:uint =  0x00A9A9A9; //Dark Grey
var color:uint = 0x00000000; //Replacement color (white)
var maskColor:uint = 0xFFFFFFFF; //What channels to affect (this is the default).
bmd2.threshold(bmd1, rect, pt, ">", threshold, color, maskColor, true); 
```

另一种选择是使用双 for 循环，迭代所有像素并根据像素的值采取特定操作。

```
for(var y:int = 0; y < height; y++){
  for(var x:int = 0; x < width; x++){
    var currentPixel:uint = image.getPixel( x, y );
    if(currentPixel != color){
      image.setPixel( destPoint.x + j, destPoint.y + i, currentPixel );
    }          
  }
} 
```

# jsf - 将数据传递给 JSF facelet

> ID：13895572
> 
> 赞同：1
> 
> 时间：2012-12-15T19:45:46.573
> 
> 标签：jsf, jstl

在我的 JSF 应用程序中显示的第一页上，我想以表格的形式显示数据库中的数据。我有一个名为 ProductList 的 ManagedBean，它有一个产品对象的 ArrayList，我想将所有产品放在一个表中。我正在使用 jstl c:forEach 标签，但由于某种原因，我得到一个编译错误：

致命错误：元素“c:forEach”的前缀“c”未绑定。

我是否正确使用了 forEach 标签？

```
<c:forEach items="#{productList.allProducts}" var="product">

</c:forEach> 
```

以下是命名空间标签：

```
 <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T19:53:28.957

您必须定义您在页面中使用的所有名称空间（xml 标记的`h:`,前缀）。`f:`

的正确定义`xmlns:c`是`xmlns:c="http://java.sun.com/jsp/jstl/core"`

你可以在这里有一个更长的例子：[<c:if test> 在 JSF2 Facelets 中似乎总是评估为真](https://stackoverflow.com/questions/3335670/cif-test-is-not-being-invoked-in-facelet-jsf2)

# winforms - Winforms 上的实体框架

> ID：13895573
> 
> 赞同：1
> 
> 时间：2012-12-15T19:45:52.813
> 
> 标签：winforms, entity-framework, ef-code-first, localdb

Windows 7 64 位、VS 2012、SQL 2012 localdb、EF 5.0、.net 4.5

我首先使用 EF 代码开发一个新的 Winforms 应用程序。我一直在关注 Julie Lermans 有关 EF、Code First 和 Dbcontext 的书籍和示例。她的示例使用控制台应用程序，我可以毫不费力地让它们工作并创建我的数据库。但是，当我使用相同代码将控制台应用程序替换为表单应用程序时，不会创建数据库。唯一的区别是我将控制台应用程序 Sub Main 代码放在 Form1 加载事件中。其他一切都相同，我不明白为什么它不起作用。它必须与控制台应用程序与表单应用程序中的启动顺序有关，但我不知道该怎么做才能使其工作。任何帮助将不胜感激。

# f# - 无点函数中的异常处理

> ID：13895574
> 
> 赞同：3
> 
> 时间：2012-12-15T19:45:53.360
> 
> 标签：f#, pointfree

我遇到了一个看似微不足道的问题：如果函数中的异常是以无点方式编写的，我将无法处理它。

考虑这两个函数：

```
let divide1 x y =
    try
        x / y
    with
        | :? System.DivideByZeroException -> 42

let divide2 =
    try
        (/)
    with
        | :? System.DivideByZeroException -> fun _ _ -> 42

let x1 = divide1 5 0 // works fine
let x2 = divide2 5 0 // doesn't handle an exception 
```

虽然这两个功能看起来相同，但它们有不同的类型：

```
val divide1: int -> int -> int
val divide2: (int -> int -> int) 
```

显然，`divide2`甚至没有尝试处理异常。它只是返回一个运算符。

我该怎么做才能以`divide2`适当的方式处理异常（除非专门声明其参数）？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-16T01:08:42.770

这是我发现无点样式有问题的原因之一。它使使用标准语言结构`try .. with`（或标准循环和其他 F# 功能）变得困难，您需要用自定义组合器替换它们。在这种情况下，您可以定义`tryWith2`在异常处理程序中包装两个参数函数的组合器：

```
let tryWith2 f h a b = 
  try f a b // Call the function with two arguments
  with e -> 
    // Try running the error handler with the exception
    match h e with 
    | Some g -> g a b // Error handler provided another function
    | _ -> reraise()  // Error was not handled - reraise 
```

然后你可以像这样以无点风格编写函数（错误处理仍然不是无点的，但我不想让它太傻:-)）

```
let divide2 =
  tryWith2 (/) (function
      | :? System.DivideByZeroException -> Some(fun _ _ -> 42)
      | _ -> None)

let x1 = divide2 5 0 // returns 42
let x2 = divide2 5 1 // returns 5 
```

当然，无点样式很有用，即使在 F# 中也是如此。例如，在编写 DSL 时，它是编写声明式规范的好方法（因为原语使用更高级别的抽象来表达某些东西）。在这里，您需要表达一些非常接近普通 F# 代码的内容，我相信，最好将其表达为普通 F# 代码。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-16T23:47:43.437

您需要记住的是，在 中`divide2`，您不是返回 X 除以 Y 的结果，而是返回一个将 X 除以 Y 的函数。 let 绑定的代码将立即执行，因为它没有给出函数语法。让我们看一下具有较长函数语法的两个除法绑定：

```
let divide1 =
    fun x ->
        fun y ->
            try
                x / y
            with
                | :? System.DivideByZeroException -> 42

let divide2 =
    try
        fun x ->
            fun y ->
                x / y
    with
        | :? System.DivideByZeroException -> fun _ _ -> 42 
```

以这种方式显示时，应该更清楚这两个定义的不同之处。该`try`块位于完全不同的位置，并在不同的时间点执行。

将异常处理等逻辑添加到现有函数的唯一方法是包装它，或者像在 中所做的那样`divide1`，或者像 Tomas 所示的那样使用更高阶的函数。

# asp.net - ajax 仅在 IE 中失败

> ID：13895577
> 
> 赞同：-2
> 
> 时间：2012-12-15T19:46:28.600
> 
> 标签：asp.net, ajax, internet-explorer, jquery

我有这个 jquery 代码

```
$("#ProfileBtn").click(function () {
    if (true) {
        $.ajax({
            type: "POST",
            url: "sMaster.Master/outClick",
            data: "{}",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function () {
                alert("~");
                location.reload();
            },
            error: function () {
                alert("!");
            }
        });
    }
}); 
```

调用 asp.net 函数：

```
[ScriptMethod, WebMethod]
public static void outClick()
{

} 
```

当我使用 chrome 或 firefox 尝试时，一切都很好（警报（“~”）），但在 Internet Explorer 上它失败了（警报（“！”））。

知道为什么..？

**更新**：我试过把这个而不是错误：

```
error: function (jqXHR, textStatus, errorThrown) {
    alert(jqXHR);
    alert(textStatus);
    alert(errorThrown);
} 
```

我在警报中得到的是：

[object XMLHttpRequest] 错误未定义

我也尝试过 jqXHR.Status，它在警报中给了我 404。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T19:50:30.190

据我了解，问题在于 ajax（可能仅在 IE 中）无法从母版页调用函数。（我尝试将 jQuery 和 asp.net 函数移动到一个 aspx 和 aspx.cs 页面并且一切正常）

以为我确实也找到了一种更好的方法来做我想做的事。

不管怎么说，还是要谢谢你。

# objective-c - iPad 应用程序在其沙盒中可以有多大？

> ID：13895583
> 
> 赞同：0
> 
> 时间：2012-12-15T19:47:02.680
> 
> 标签：objective-c

我将制作一个包含许多图像（嵌入）的 iPad 应用程序，大小约为 2gbs。我以前为 b2b 制作过这种大小的应用程序，没有任何问题。我的问题是，这个 2gb 限制苹果是否已经扩展到新内容包的下载？因此，该应用程序的发布与杂志应用程序非常相似——例如，大约 30-50mbs。然后您可以下载可能使整个应用程序达到 12gbs 的软件包。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:56:57.187

Apple 的应用程序大小限制（目前为 50MB）仅适用于移动下载，但不适用于 WiFi 下载或在您的计算机上购买。今天有许多应用程序超过了这个限制（对于一些附带自定义离线地图数据的导航包，超过 1GB）。

但是，这并不是一个很好的用户体验。由于 App Store 上仍然没有增量更新系统，用户必须在每次更新后下载完整的应用程序。

如果您负担得起流量，购买后从您自己的服务器下载此内容可能是更好的选择，因为更新期间不会清除该数据。不过，请确保为它禁用 iCloud 备份。

话虽如此，我想知道什么样的应用程序需要 2GB 的基本图像。您确定每个用户*都**同时*需要它们吗？你不能只下载必要的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:20:56.593

2 GB 的大小限制仅适用于应用程序本身，即从 App Store 下载的内容。应用程序安装后下载的东西的大小并没有真正的限制，但您必须确保不通过 iTunes/iCloud 备份大数据，否则您的应用程序很可能会因违反[iOS 数据存储指南](https://developer.apple.com/icloud/documentation/data-storage/)而被拒绝。

# ruby-on-rails - 重定向后闪存消息的功能测试

> ID：13895584
> 
> 赞同：7
> 
> 时间：2012-12-15T19:47:07.017
> 
> 标签：ruby-on-rails, testing, redirect, functional-testing

我不确定如何通过功能测试检查闪存消息。我的问题与我的测试有关，`redirect_to`因为我的测试`flash[:error]`通过了。这是我的`create`操作的样子：

```
def create
  @user = User.new(params[:user])
  if @user.save
    redirect_to @user, flash: { success: "Welcome!" }
  else
    flash.now[:error] = "Signup failed:"
    render 'new'
  end
end 
```

我有一个通过测试`flash[:error]`1) 检查这`flash[:error]`是正确的值，2) 检查页面的 flash div，3) 获取一个新页面并检查 flash 消息是否已被清除。我试图做一个类似的测试，`flash[:success]`但是当它试图在页面上找到 div 时它失败了。这是失败的测试：

```
 should "show flash[:success] message" do
    post :create, user: { name: "valid user",
                          password: "userpw",
                          password_confirmation: "userpw",
                          email: "a@b.com" }        
    assert_redirected_to user_path(assigns(:user)), "user isn't being redirected to their page after registration"
    assert_equal flash[:success], "Welcome!", "flash[:success] isn't being set properly"
    assert_select "div.alert-success", flash[:success]
    get :new
    assert flash.empty?, "there shouldn't be any flash messages left after getting new page"
  end 
```

当我在浏览器中手动测试它时，它的行为符合预期，但我不确定如何编写测试来反映这一点。前两个断言通过（因此测试识别出它被正确重定向，并且`flash[:success]`被设置为`"Welcome!"`）。基于此，我认为该`assert_select`语句将能够找到 div，但如果失败并显示此错误消息：

```
Expected at least 1 element matching "div.alert-success", found 0. 
```

所以我尝试在语句`puts @response.body`之前添加，它打印了这个：`assert_select`

```
<html><body>You are being <a href="http://test.host/users/3">redirected</a>.</body></html> 
```

这解释了为什么它找不到 flash div，但我不确定如何“完成”重定向，以便它使用 flash div 呈现正确的视图。如果我在`get`语句之前添加一个语句`assert_select`，则测试通过，因为现在`@response.body`有 flash div。然而，这似乎不是一个有效的测试，因为它没有反映我的应用程序的行为——用户不必提出新的请求来查看 Flash 消息。

它也不保证 Flash 消息显示在正确的页面上。如果我使用 statement `get :new`，断言仍然通过，这意味着 flash 消息将出现在`users#new`视图上。即使我使用

```
get :show, id: assigns(:user).id 
```

为了确保 Flash 消息显示在正确的页面上，这仍然感觉不对，因为 1）现在它是`success`响应而不是`redirect`响应，并且 2）它仍然没有解释为什么我必须手动请求任何页面来查找flash div - 根据[文档](http://guides.rubyonrails.org/action_controller_overview.html#the-flash)，“flash 是会话的特殊部分，**每个请求都会清除它。** ”

无论如何，有没有办法测试重定向后闪烁消息是否正确显示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-16T01:52:55.863

我正在从 POV 回答这个问题，即您尝试测试的内容将在其他地方进行更好的测试。如果您在设置测试时遇到很多麻烦，那么很有可能有更好的方法来测试它:)

1.  测试是否清除了 Flash 消息 - Rails 中内置了 Flash 消息，因此测试框架正在为您处理的内容没有多大意义。

2.  测试页面上显示的元素 - 视图规范不属于控制器。下面是对控制器角色的描述：

    > 因此，控制器可以被认为是模型和视图之间的中间人。它使模型数据对视图可用，因此它可以向用户显示该数据。

    控制器应该使数据对视图可用，而不是指定如何呈现数据。想象一下，如果您更改了 CSS 类的名称，那么您还必须更新您的控制器规范。

    如果您真的想测试显示的 Flash 消息，我会使用集成测试。

# winforms - 是否可以在多个表单上拥有一个用户控件实例？

> ID：13895585
> 
> 赞同：0
> 
> 时间：2012-12-15T19:47:11.427
> 
> 标签：winforms, user-controls

是否可以让用户控件的一个实例在两种不同的表单上运行？

* * *

我做了以下操作，但它不起作用（控件只显示在最后一个表单中）。

```
static void Main()
        {
            Application.EnableVisualStyles();
            Application.SetCompatibleTextRenderingDefault(false);

            var control = new UserControl1();

            var form2 = new Form2();
            form2.UserControl1 = control;
            form2.Show();

            var form1 = new Form1();
            form1.UserControl1 = control;

            Application.Run(form1);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:17:56.717

我不得不说不。至少在正常的.Net 操作下。如果我创建一个文本框并将其添加到 form1，然后将相同的文本框实例添加到 form2，则 form1 中的文本框实际上会移动到 form2。即使它有效，位置、父窗体等属性也会在这两种形式之间出现问题。

如果您需要公共实例数据，则单例类可能适合您。

# google-apps-script - 电子表格中最近的时区更改？

> ID：13895586
> 
> 赞同：0
> 
> 时间：2012-12-15T19:47:17.983
> 
> 标签：google-apps-script, google-sheets

是我自己还是谷歌最近发生了变化？我有一个功能可以为编辑添加时间戳，它工作得很好，就在前几天它坏了。

从某种意义上说，它曾经在我的时区标记时间——正如我使用的函数格式所指定的那样，它现在似乎是在 GMT 而不是 GMT-8 中标记时间戳。我的脚本没有任何变化，所以发生了什么？

```
function happyFunTime() {
  var s = SpreadsheetApp.getActiveSheet();
  var r = s.getActiveCell();
  var columnNum = r.getColumn();
  var timeLastCalledColumnOffset = getTimeLastCalledColumnOffset();
  var rowNum = r.getRow();

if (rowNum <=1) return;

  timeLastCalledColumnOffset++;
  // set dateCell = the current row at column J
  var dateCell = s.getRange(rowNum, timeLastCalledColumnOffset);

  var tZone= "GMT-8";
  // Format the current date into datetime format 
  var dateTime = Utilities.formatDate(new Date(), tZone, "MMM-dd-yyyy h:mm a");

  // Set the cell value.  Add apostrophe to force text treatment & keep the spreadsheet from reformatting
    dateCell.setValue("'" + dateTime);

} 
```

`getTimeLastCalledColumnOffset()`是一个自定义函数，用于返回包含我感兴趣的值的列的编号（J，在这种情况下为 9）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T22:12:40.583

是的，昨天有一个问题，因为这个字符串“GMT-2”或“GMT-0200”一直工作正常，现在出现故障。

您可以更改此行：

```
 var tZone= "GMT-8" 
```

对这个

```
 var tZone= "GMT-08:00" 
```

或者您可以使用以下代码行获取时区：

```
 var FUS1 = new Date().toString().substr(25,8);  // I use FUS1 instead of tZone

  // GMT-0800  ->  GMT-08:00 , ...
  var FUS1 = FUS1.substr(0,6) + ':' + FUS1.substr(6)

  // Format the current date into datetime format 
  var dateTime = Utilities.formatDate(new Date(), FUS1 , "MMM-dd-yyyy h:mm a"); 
```

或者你可以从这里写下你的时区：

[http://en.wikipedia.org/wiki/List_of_tz_database_time_zones](http://en.wikipedia.org/wiki/List_of_tz_database_time_zones)

“美国/道森” -> -08:00（我不知道你住在哪里 :-( ）

这个代码：

```
 var dateTime = Utilities.formatDate(new Date(), "America/Dawson" , "MMM-dd-yyyy h:mm a"); 
```

注意：如果您想格式化从 DateBox（标签、文本框、...）捕获的日期，那么最后一行可以类似于：

```
 var dateTime = Utilities.formatDate(new Date(e.paramameter.datebox), "America/Dawson" , "MMM-dd-yyyy h:mm 
```

塞尔吉

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T10:56:00.533

另一个获得正确字符串的简单解决方案`Utilities.formatDate()`是使用 `Session.getTimeZone()`which`'Europe/Paris'`在我的情况下返回并且是一个有效的参数。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-01-30T05:42:42.893

> 我们可以使用下面的行直接更改电子表格的时区

`SpreadsheetApp.getActive().setSpreadsheetTimeZone(Session.getScriptTimeZone())`

# vba - 使用 VBScript 排序顺序检查

> ID：13895587
> 
> 赞同：0
> 
> 时间：2012-12-15T19:47:19.890
> 
> 标签：vba, date, excel, vbscript, sorting

假设我有一个数组 arr1 ，其中包含如下日期值：

Arr1(50)=("9/3/2012 4:57:02 AM","22/3/2012 5:57:02 AM","9/5/2012 8:57:02 AM","9 /3/2011 凌晨 4:57:02")

***编辑***

```
 Dim CellCount
 Dim Arr(10)

 CellCount=0
 Do Untill arr(CellCount)="" And Ubound(Arr)>9

  If CStr(arr(CellCount) < arr(CellCount+1)) Then

    MsgBox(arr(CellCount)&"is good")

   Else

     MsgBox(arr(CellCount +1)&"is bad")
     Exit Do

   End if

CellCount=CellCount+1
Loop 
```

现在，有没有直接的方法，不使用任何循环技术，来找出 Arr1() 的日期值是否上升？

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:30:31.670

不，因为您必须检查元素直到/直到第一个反例（可能是最后一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T16:23:05.553

他正在回答你的问题。你问，***有没有办法在没有循环的情况下找到排序？*** 他说不。你的眼睛，我的眼睛可以看出它是否已分类。但是您如何期望 Excel/计算机在不通过集合元素的情况下这样做呢？

当数据在数组中时，您需要遍历其元素。希望很清楚。

所以我能说的最好的，

*   如果需要，用逗号分隔符将其拆分为变体。但不是必需的，因为 Array() 可以将元素放入一维变体中
*   将其转储到`Range`使用转置
*   使用工作表排序方法/功能对整个范围进行排序

    ---> 所以你知道它现在已经排序了。

*   然后转回一个变体数组

一些代码片段可以让您朝着这个方向前进：

```
Option Explicit

    Sub omgArraySort()
       Dim inputArray As Variant
       Dim outputArray As Variant
       Dim upperB as Long

       inputArray = Array("9/3/2012 4:57:02 AM","22/3/2012 5:57:02 AM", _ 
                          "9/5/2012 8:57:02 AM","9/3/2011 4:57:02 AM")
       '-- sorted array
       outputArray = sortRange(inputArray)

          upperB = UBound(iArray, 1) '-- for 1D array you may also use UBound(iArray)
          If (Err.Number <> 0) Then '-- if there's an error, it's erro code is > 0
            MsgBox "Dates sorted, not empty"
          End If
    End Sub

    '-- dump into sheet and sort in the sheet and dump back into the array
    Function sortRange(ByVal iArray As Variant) As Variant
       Dim rngSort as Range
       Dim i As Long

       Set rngSort = WorkSheets(1).Range("B2")
       i = Ubound(iArray,1)

       With rngSort.Resize(i)
          .Value = WorksheetFunction.Transpose(iArray)
          .Sort rngSort, xlDescending, Header:=xlNo
          sortRange = .Value              
       End With
    End Function 
```

* * *

在处理大量数据时，从工作表到代码的流量会降低性能。

*请务必知道，当 SO 中具有可信度的人回答（例如 Ekkehard 的回答）时，您必须注意。他们没有正当理由不说。*

# printing - F# 类型打印机：类型打印机的标准和质量示例

> ID：13895590
> 
> 赞同：0
> 
> 时间：2012-12-15T19:47:57.840
> 
> 标签：printing, f#, printf, standards

作为[F# fsi.AddPrinter 的后续：AddPrinter 是否有能力将列表分开？](https://stackoverflow.com/q/13893375/1243762)

我不知道类型打印机应该提供处理列表作为输入。

因此，对于类型打印机的要求/应该要求，是否有任何已发布的标准？

您能否提供此类代码示例的参考。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:27:28.263

> 我不知道类型打印机应该提供处理列表作为输入。

我建议你不要这样做。如果你这样做了，你就违反了 KISS 原则，并且可能会以一种非常标准的奇怪方式让其他团队成员感到惊讶`'T list`。只需提供一台打印机`'T`，让 F# Interactive 解决剩下的问题。

你可以考虑这种情况

```
type Theorem = Axiom list 
```

在您关心`Theorem`并希望以适当方式显示它的地方。然后定义打印机是有意义的，以便将 a`Theorem`打印为

```
:- axiom 1, axiom 2, ..., axiom n. 
```

此示例不是一个很好的示例，因为您可能更喜欢类型安全的解决方案

```
type Theorem = Theorem of Axiom list 
```

也就是说，你可能会问你是否应该去`fsi.AddPrinter`。由于遗留原因，这些`fsi.AddPrinter`位可能存在。更通用的解决方案是覆盖`ToString()`方法并使用[StructuredFormatDisplay](http://msdn.microsoft.com/en-us/library/ee370334.aspx)属性，以便为 和 提供良好的打印机，`fsc`与`fsi`,`printf "%A"`等`printf "%O"`一起使用。

# python - 更改 Paypal Adaptive Payments 登录语言

> ID：13895593
> 
> 赞同：0
> 
> 时间：2012-12-15T19:48:06.857
> 
> 标签：python, paypal, paypal-adaptive-payments

我的网站通过贝宝接收付款。我的用户抱怨他们只看到葡萄牙语的登录屏幕，他们不明白。我已经尝试过[这里](https://www.x.com/developers/paypal/forums/digital-goods/language-settings)提出的解决方案（如下面的代码所示），但到目前为止还没有运气。

这是我正在做的一个小测试：下面的代码使用[paypalx](https://github.com/e-loue/python-paypalx)，并且可以作为[要点](https://gist.github.com/4298454)

```
from django.conf import settings
from paypalx import AdaptivePayments
from urllib import urlencode
from urllib2 import urlopen, Request
import logging

paypal = AdaptivePayments(settings.PAYPAL_API_USERNAME, 
    settings.PAYPAL_API_PASSWORD, 
    settings.PAYPAL_API_SIGNATURE, 
    settings.PAYPAL_API_APPLICATION_ID, 
    settings.PAYPAL_API_EMAIL, 
    sandbox=settings.PAYPAL_USE_SANDBOX)

receivers = []
receivers.append({'amount' : '10.00', 'email' : 'penepoleb@gmail.com'})
response = paypal.pay(
    actionType = 'PAY',
    cancelUrl = settings.PAYPAL_CANCEL_URL,
    currencyCode = 'USD',
    feesPayer = 'EACHRECEIVER',
    receiverList = { 'receiver': receivers},
    returnUrl = settings.PAYPAL_RETURN_URL,
    ipnNotificationUrl = settings.PAYPAL_IPNNOTIFY_URL,
    errorLanguage = "en_US"
)
paykey = response['payKey']
print('https://www.paypal.com/webapps/adaptivepayment/flow/pay?paykey=%s&expType=light&country.x=us&locale=en_US&change_locale=1' % paykey) 
```

这是使用我的 paypal 凭据生成的一个这样的 paykey：AP-2AG393088X128224K 现在，您可以尝试打开生成的 URL 并查看它是否为葡萄牙语： [https ://www.paypal.com/webapps/adaptivepayment/flow/pay?paykey =AP-2AG393088X128224K&expType=light&country.x=us&locale=en_US&change_locale=1](https://www.paypal.com/webapps/adaptivepayment/flow/pay?paykey=AP-2AG393088X128224K&expType=light&country.x=us&locale=en_US&change_locale=1)

但是，如果您尝试使用不同的支付密钥，则区域设置参数有效（我使用的是从[这个示例](https://www.x.com/developers/paypal/forums/digital-goods/language-settings)中获得的支付密钥：AP-7LB18162J0578713L）如果您转到下面的链接，您会看到它是英文的。

[https://www.paypal.com/webapps/adaptivepayment/flow/pay?paykey=AP-7LB18162J0578713L&expType=light&country.x=us&locale=en_US&change_locale=1](https://www.paypal.com/webapps/adaptivepayment/flow/pay?paykey=AP-7LB18162J0578713L&expType=light&country.x=us&locale=en_US&change_locale=1)

我需要做什么才能向用户显示英文登录页面？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T21:09:27.893

请检查[这篇](http://www.tipsandtricks-hq.com/forum/topic/paypal-link-redirecting-to-wrong-language)文章 - 它似乎指的是你遇到的同样的问题。

谢谢，

亚瑟

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T01:08:09.647

按照@casals 的提示，我发现还有另一个我可以使用的paypal URL。

[1] - [https://www.paypal.com/webapps/adaptivepayment/flow/pay?paykey=](https://www.paypal.com/webapps/adaptivepayment/flow/pay?paykey=) ...

[2] - [https://www.paypal.com/webscr?cmd=_ap-payment&paykey=](https://www.paypal.com/webscr?cmd=_ap-payment&paykey=) ...

我在 iframe 中使用 [1]。

现在我将 [2] 与浏览器重定向一起使用。重定向到 [2] 将使贝宝根据需要以英文显示登录页面。

这稍微改变了支付体验——用户实际上必须离开我的网站，然后被重定向回它。但这很好，我认为用户实际上更喜欢这种方式，因为他们在输入凭据时可以看到 Paypal 的 url。

我仍然相信 [1] 的当前行为是贝宝中的一个错误。

我的应用程序 - [http://www.freedomsponsors.org](http://www.freedomsponsors.org) - 在 Github 上是开源的，你可以在[这里](https://github.com/freedomsponsors/www.freedomsponsors.org/blob/54aa5a5ce06561b6d1d1da4552f9ad50cb6b33a3/djangoproject/core/views/paypal_views.py)看到修改后的代码）

# c# - 在大型 DataTable 中设置 DataRow 值的性能

> ID：13895596
> 
> 赞同：1
> 
> 时间：2012-12-15T19:48:27.077
> 
> 标签：c#, performance, datatable, datarow

我有一个大的 DataTable - 大约 15000 行和 100 列 - 我需要为每一行中的一些列设置值。

```
// Creating the DataTable
DataTable dt = new DataTable();
for (int i = 0; i < COLS_NUM; i++)
{
    dt.Columns.Add("COL" + i);
}    
for (int i = 0; i < ROWS_NUM; i++)
{
    dt.Rows.Add(dt.NewRow());
}

// Setting several values in every row
Stopwatch sw2 = new Stopwatch();
sw2.Start();
foreach (DataRow row in dt.Rows)
{
    for (int j = 0; j < 15; j++)
    {
        row["Col" + j] = 5;
    }
}
sw2.Stop(); 
```

上面测得的时间约为4.5秒。有什么简单的方法可以改善这一点吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-11-19T18:35:54.480

在填充数据之前，请在 DataTable 上调用 BeginLoadData() 方法。完成数据加载后，调用 EndLoadData()。这将关闭所有通知、索引维护和约束，从而提高性能。

作为替代方案，在更新每一行之前调用 BeginEdit()，并在该行的编辑完成时调用 EndEdit()。

Here is a link with more information on improving DataSet performance: [http://www.softwire.com/blog/2011/08/04/dataset-performance-in-net-web-applications/](http://www.softwire.com/blog/2011/08/04/dataset-performance-in-net-web-applications/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:00:26.363

我能想到的一项改进是通过索引而不是名称来编辑列。

```
foreach (DataRow row in dt.Rows)
{
    for (int j = 0; j < 15; j++)
    {
        row[j] = 5;
    }
} 
```

通过经验测试，您的方法在我的计算机上似乎在 ~1500 毫秒内运行，而这个基于索引的版本在 ~1100 毫秒内运行。

另外，请参阅 Marc 在这篇文章中的回答：

[在没有 for 循环的情况下为数据表中的所有行设置值](https://stackoverflow.com/questions/5063551/set-value-for-all-rows-in-a-datatable-without-for-loop)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T20:04:12.527

这取决于您的业务逻辑，这在您的问题中并不清楚，但是，如果您想为每行中的某些列设置值，请尝试以下操作，

*   创建一个单独的临时列，您可以在创建原始数据表时在同一个循环中创建它

*   将新值填入此列，

*   删除旧列并在其位置插入新列。

如果您可以期待新值，或者如果您对所有行都有相同的值（如在您的示例中），或者如果您有某种重复，那么这个解决方案将是合乎逻辑的，在这种情况下，添加一个加载的新列将会更多比循环所有行更快。

# export - Highcharts JS：一键下载当前站点的所有图表

> ID：13895597
> 
> 赞同：1
> 
> 时间：2012-12-15T19:48:29.267
> 
> 标签：export, highcharts

我们在 Web 应用程序中使用[Highcharts JS](http://www.highcharts.com/)。我们还使用“highcharts exporting”，以便我们的客户只需单击一下即可下载图表或饼图。

现在我想添加一个功能，您可以一键下载所有由 highcharts 显示的图表。这样我们的客户就不必单独下载每个图表。highcharts 中已经有这样的功能了吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T15:51:24.493

我找不到一个简单的方法来做到这一点。

highcharts[导出模块正在向 highcharts 服务器提交 POST](http://code.highcharts.com/modules/exporting.src.js)请求（传入图表的 SVG）以生成 PDF 或 PNG。

我尝试`chart.exportChart()`连续调用，但这不起作用，因为第一次调用更改了文档焦点，后续调用不会触发。所以我认为你有两个选择：

1.  做服务器端。让您的 javascript 返回`chart.getSVG()`所有图表的 SVG ()，并编写一个生成[POST 请求](http://docs.python.org/2/library/urllib2.html?highlight=urllib2#urllib2)的服务器端脚本，[压缩](http://docs.python.org/2/library/zipfile.html?highlight=zip#zipfile)生成的文件并在客户端返回它们。

2.  留在客户端。获取图表对象的 SVG 并对其进行操作以在一个 SVG 文档中嵌入多个图表。然后向 highcharts 服务器发出请求。这样，您可以获得一个包含多个图表的 PDF 文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-06T21:29:53.780

我会这样做：

1.  使用 PhantomJS 的 hekp 设置您自己的导出服务器。（这是[http://www.highcharts.com/articles/2-news/52-serverside-generated-charts](http://www.highcharts.com/articles/2-news/52-serverside-generated-charts)的快捷方式）
2.  通过 AJAX 将每个图表数据发送到 PhantomJS 导出服务。
3.  将导出的 PNG 与服务器端脚本（php 或 py）或在 PhantomJS 的帮助下通过在一个页面中呈现所有内容，光栅化并导出为一个图像，并通过 AJAX 将其路径发送回前端。
4.  接收图像并让用户下载它:)。

前两个步骤在我最近为 Packt 创建的教程视频中进行了详细说明：[https ://www.packtpub.com/web-development/learning-highcharts-video](https://www.packtpub.com/web-development/learning-highcharts-video)

我希望它有所帮助。

# c++ - Win32：位图实例化中断功能

> ID：13895604
> 
> 赞同：1
> 
> 时间：2012-12-15T19:49:07.650
> 
> 标签：c++, winapi, bitmap

我的一个位图（它是一个精灵表）遇到了这个奇怪的问题。我的游戏运行完美，但如果我取消注释这行代码，初始化位图和精灵的 GameStart 函数会中断：

```
g_pPowerup100Bitmap = new Bitmap(hDC, IDB_POWERUP_100, g_hInstance); 
```

结果是该**函数**在遇到该行代码时就退出了，但必须调用 GamePaint()，因为位图被 blitted 到屏幕上。我知道该功能没有正确执行，因为它们不是精灵 - 只是图像（并且音乐永远不会初始化）。精灵和音乐初始化低于同一函数中的位图初始化。

更令人沮丧的是，游戏实际上**可以运行……有时**。然后我可以正常玩游戏并看到新的动画精灵。然而，在尝试调试该东西数十次之后，它根本无法正确构建。

***我试过的：***

```
1) Try/catch of entire GameStart() contents. Exception is not thrown
2) Extensive breakpoint checking - it's definitely this line
3) Spell-checking variable name - exact same as in header file
4) Re-saving bitmap as 24-bit RGB instead of 32-bit
5) Cleaning & rebuilding both the solution & project file
6) Restarting Visual C++ 2008 
```

位图为 64x1536。那是问题吗？我有 8GB 的​​ RAM 和 GTX 570 Classified。这是整个函数：

```
void GameStart(HWND hWindow)
{
    try
  {
    // Initialize global variables
    g_iInputDelay = 0;
    g_iNumLives = 3;
    g_iScore = 0;
    g_iGameState = 1;
    g_iDifficulty = 1;

    // Seed the random number generator
    srand(GetTickCount());

    // Create the offscreen device context and bitmap
    g_hOffscreenDC = CreateCompatibleDC(GetDC(hWindow));
    g_hOffscreenBitmap = CreateCompatibleBitmap(GetDC(hWindow),
    g_pGame->GetWidth(), g_pGame->GetHeight());
    SelectObject(g_hOffscreenDC, g_hOffscreenBitmap);

    // Create and load the bitmaps
    HDC hDC = GetDC(hWindow);
    g_pHighwayBitmap = new Bitmap(hDC, IDB_HIGHWAY, g_hInstance);
    g_pChickenBitmap = new Bitmap(hDC, IDB_CHICKEN, g_hInstance);
    g_pCarBitmaps[0] = new Bitmap(hDC, IDB_CAR1, g_hInstance);
    g_pCarBitmaps[1] = new Bitmap(hDC, IDB_CAR2, g_hInstance);
    g_pCarBitmaps[2] = new Bitmap(hDC, IDB_CAR3, g_hInstance);
    g_pCarBitmaps[3] = new Bitmap(hDC, IDB_CAR4, g_hInstance);
    g_pChickenHeadBitmap = new Bitmap(hDC, IDB_CHICKENHEAD, g_hInstance);
    g_pMainMenuBitmap = new Bitmap(hDC, IDB_MAIN_MENU, g_hInstance);
    g_pHighScoresMenuBitmap = new Bitmap(hDC, IDB_HIGH_SCORES_MENU, g_hInstance);
    g_pGameOverMenuBitmap =  new Bitmap(hDC, IDB_GAME_OVER_MENU, g_hInstance);
    g_pNormalModeBtnBitmap = new Bitmap(hDC, IDB_NORMAL_MODE_BTN, g_hInstance);
    g_pHardModeBtnBitmap = new Bitmap(hDC, IDB_HARD_MODE_BTN, g_hInstance);
    g_pHighScoresBtnBitmap = new Bitmap(hDC, IDB_HIGH_SCORES_BTN, g_hInstance);
    g_pReplayBtnBitmap = new Bitmap(hDC, IDB_REPLAY_BTN, g_hInstance);
    g_pMainMenuBtnBitmap = new Bitmap(hDC, IDB_MAIN_MENU_BTN, g_hInstance);
    g_pPowerup100Bitmap = new Bitmap(hDC, IDB_POWERUP_100, g_hInstance);

    RECT    rcBounds = { 0, 0, 465, 400 };

    //Button Sprites - Main Menu
    Sprite* pBtnSprite = new Sprite(g_pNormalModeBtnBitmap, 77,228, 0,0, 1, rcBounds, BA_STOP);
    pBtnSprite->SetStateChange(0);
    g_pGame->AddSprite(pBtnSprite, 1);

    pBtnSprite = new Sprite(g_pHardModeBtnBitmap, 254,228, 0,0, 1, rcBounds, BA_STOP);
    pBtnSprite->SetStateChange(0);
    g_pGame->AddSprite(pBtnSprite, 1);

    pBtnSprite = new Sprite(g_pHighScoresBtnBitmap, 166,310, 0,0, 1, rcBounds, BA_STOP);
    pBtnSprite->SetStateChange(3);
    g_pGame->AddSprite(pBtnSprite, 1);

    //Button Sprites - Game Over Menu
    pBtnSprite = new Sprite(g_pReplayBtnBitmap, 167,249, 0,0, 1, rcBounds, BA_STOP);
    pBtnSprite->SetStateChange(0);
    g_pGame->AddSprite(pBtnSprite, 2);

    pBtnSprite = new Sprite(g_pMainMenuBtnBitmap, 82,332, 0,0, 1, rcBounds, BA_STOP);
    pBtnSprite->SetStateChange(1);
    g_pGame->AddSprite(pBtnSprite, 2);

    pBtnSprite = new Sprite(g_pHighScoresBtnBitmap, 252,332, 0,0, 1, rcBounds, BA_STOP);
    pBtnSprite->SetStateChange(3);
    g_pGame->AddSprite(pBtnSprite, 2);

    //Button Sprites - High Scores Menu
    pBtnSprite = new Sprite(g_pMainMenuBtnBitmap, 166,332, 0,0, 1, rcBounds, BA_STOP);
    pBtnSprite->SetStateChange(1);
    g_pGame->AddSprite(pBtnSprite, 3);

        // Create the chicken and car sprites
    g_pChickenSprite = new Sprite(g_pChickenBitmap, rcBounds, BA_STOP);
    g_pChickenSprite->SetPosition(4, 175);
    g_pChickenSprite->SetVelocity(0, 0);
    g_pChickenSprite->SetZOrder(1);
    g_pChickenSprite->SetNumFrames(2);
    g_pChickenSprite->SetAsInputControlled(); //stops auto-frame update
    //DEBUGGING ONLY!!!!!
    g_pChickenSprite->SetID(1);
    g_pGame->AddSprite(g_pChickenSprite, 0);

    Sprite* pSprite = new Sprite(g_pCarBitmaps[0], rcBounds, BA_WRAP);
    pSprite->SetPosition(70, 0);
    pSprite->SetVelocity(0, 6);
    pSprite->SetZOrder(2);
    g_pGame->AddSprite(pSprite, 0);
    pSprite = new Sprite(g_pCarBitmaps[1], rcBounds, BA_WRAP);
    pSprite->SetPosition(160, 0);
    pSprite->SetVelocity(0, 2);
    pSprite->SetZOrder(2);
    g_pGame->AddSprite(pSprite, 0);
    pSprite = new Sprite(g_pCarBitmaps[2], rcBounds, BA_WRAP);
    pSprite->SetPosition(239, 400);
    pSprite->SetVelocity(0, -4);
    pSprite->SetZOrder(2);
    g_pGame->AddSprite(pSprite, 0);
    pSprite = new Sprite(g_pCarBitmaps[3], rcBounds, BA_WRAP);
    pSprite->SetPosition(329, 400);
    pSprite->SetVelocity(0, -9);
    pSprite->SetZOrder(2);
    g_pGame->AddSprite(pSprite, 0);

    // Load the background music
    g_pGame->PlayMIDISong(TEXT("Music.mid"));

    getHighScores(scoreData, g_scoreTop);

    scoreData.close();

  }
  catch (int e)
  {
    cout << "An exception occurred. Exception Nr. " << e << endl;
    system("PAUSE");
  }
} 
```

GameStart() 在这种情况下被调用：

```
switch (msg)
  {
    case WM_CREATE:
      // Set the game window and start the game
      SetWindow(hWindow);
      GameStart(hWindow);
      return 0; 
```

如果有人能解释为什么该位图会杀死该功能，我将不胜感激！

**编辑**：Hans 直接解决了这个问题——我勾选了“Win32 Exceptions”复选框，并且这行代码出现了内存访问错误：

```
 CopyMemory(pBitmapBits, pTempBits, pBitmapInfo->bmiHeader.biSizeImage); 
```

图片是不是太大了？我会继续调查，但欢迎任何建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:16:19.537

不要使用 WM_CREATE 消息来初始化您的游戏。当您在 64 位操作系统上运行 32 位代码时，会出现一个非常具体的问题，当消息处理代码中引发 SEH 异常（如访问冲突）时，它们会被吞没。WM_CREATE 是显示问题的消息之一。[这个答案](https://stackoverflow.com/questions/4933958/vs2010-does-not-show-unhandled-exception-message-in-a-winforms-application-on-a/4934010#4934010)中有很多关于这种行为的细节，尽管它非常特定于 Winforms。然而，当您用 C 或 C++ 编写代码时，也会存在完全相同的问题。

（通常）不需要使用 WM_CREATE 来初始化东西，您最好在 CreateWindowsEx() 调用之后移动它，因为您应该只需要窗口句柄。调试器现在将再次提供帮助，并向您显示代码崩溃的位置。

如果您确实需要在 WM_CREATE 中使用它，请使用 Debug + Exceptions 对其进行调试，勾选 Thrown 复选框以获得 Win32 异常。也是验证此答案是否准确的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:02:04.257

就像我现在一样，在调用 GetDC 之后，您必须调用 ReleaseDC。但是您拨打了三个 GetDC 电话。留下一个电话，存储 HDC 并在最后释放它。

# java - 如何在 Java 中获取线程信息/统计信息

> ID：13895605
> 
> 赞同：3
> 
> 时间：2012-12-15T19:49:13.030
> 
> 标签：java, multithreading

标题说明了一切。我有一些包含在下面的代码，我想知道如何获取与线程相关的统计信息/信息（即正在运行多少个不同的线程，不同线程的名称）。为了一致性起见，图像代码`22 33 44 55`作为命令行参数运行。

我还想知道这个特定示例中 try 块的目的是什么。我了解 try 块一般做什么，但特别是 try 块对线程有什么作用。

```
public class SimpleThreads {
//Display a message, preceded by the name of the current thread
static void threadMessage(String message) {
long threadName = Thread.currentThread().getId();
System.out.format("id is %d: %s%n", threadName, message);
}
private static class MessageLoop implements Runnable {
    String info[];
    MessageLoop(String x[]) {
        info = x;
    }
    public void run() {
        try {
            for (int i = 1; i < info.length; i++) {
                //Pause for 4 seconds
                Thread.sleep(4000);
                //Print a message
                threadMessage(info[i]);
            }
        } catch (InterruptedException e) {
            threadMessage("I wasn't done!");
        }
    }
}

public static void main(String args[])throws InterruptedException {
    //Delay, in milliseconds before we interrupt MessageLoop
    //thread (default one minute).
    long extent = 1000 * 60;//one minute
    String[] nargs =  {"33","ONE", "TWO"};
    if (args.length != 0) nargs = args;
    else System.out.println("assumed: java SimpleThreads 33 ONE TWO");
    try {
        extent = Long.parseLong(nargs[0]) * 1000;
    } catch (NumberFormatException e) {
        System.err.println("First Argument must be an integer.");
        System.exit(1);
    }
    threadMessage("Starting MessageLoop thread");
    long startTime = System.currentTimeMillis();
    Thread t = new Thread(new MessageLoop(nargs));
    t.start();

    threadMessage("Waiting for MessageLoop thread to finish");
    //loop until MessageLoop thread exits
    int seconds = 0;
    while (t.isAlive()) {
        threadMessage("Seconds:  " + seconds++);
        //Wait maximum of 1 second for MessageLoop thread to
        //finish.
        t.join(1000);
        if (((System.currentTimeMillis() - startTime) > extent) &&
                t.isAlive()) {
            threadMessage("Tired of waiting!");
            t.interrupt();
            //Shouldn't be long now -- wait indefinitely
            t.join();
        }

    }
    threadMessage("All done!");
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T19:55:38.660

您可以使用[VisualVM](http://visualvm.java.net/threads.html)进行线程监控。它包含在 JDK 6 update 7 及更高版本中。您可以在 JDK 路径/bin 文件夹中找到 visualVm。

> VisualVM 在特定于该应用程序的选项卡中显示本地和远程应用程序的数据。应用程序选项卡显示在应用程序窗口右侧的主窗口中。您可以一次打开多个应用程序选项卡。每个应用程序选项卡都包含显示有关应用程序的不同类型信息的子选项卡。**VisualVM 在“线程”选项卡中显示有关线程活动的实时高级数据。**

![在此处输入图像描述](../Images/85b3886ac44442e6e70f969e5a1341db.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T19:56:57.000

对于第一个问题：考虑使用[VisualVM](http://docs.oracle.com/javase/6/docs/technotes/guides/visualvm/index.html)来监控这些线程。或者只是使用你的 IDE 调试器（eclipse 有这样的功能 imo）。

```
I am also wondering what the purpose of the try blocks are in this particular example. 
```

`InterruptedException`s 如果`Thread.interrupt()`在线程休眠时被调用，则发生。然后`Thread.sleep()`被中断，线程将跳转到捕获代码中。
在您的示例中，您的线程休眠 4 秒。如果另一个线程`Thread.interrupt()`在您的睡眠线程上调用，它将执行`threadMessage("I wasn't done!");`.
嗯.. 正如你现在可能已经理解的那样，catch 块处理`sleep()`- 方法，而不是线程抛出的异常。它会引发一个已检查的异常，您必须捕获该异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T20:20:00.107

如果您不能使用 VisualVM 之类的工具（这非常有用，恕我直言），您还可以将 Java 中的线程堆栈转储到您的日志文件中。当超过某些阈值时，我在我的服务器程序上使用此类转储。我发现将此类快照作为程序的一部分非常有帮助。为您提供一些关于系统崩溃之前发生的事情的提示，并且使用分析器为时已晚（死锁、OutOfMemory、减速等）。看看这里的代码：以[编程方式触发完整的堆栈转储？](https://stackoverflow.com/questions/12965836/trigger-complete-stack-dump-programmatically/12970158#12970158)

# arrays - MIPS 中数组的动态分配

> ID：13895606
> 
> 赞同：1
> 
> 时间：2012-12-15T19:49:26.057
> 
> 标签：arrays, assembly, mips

我们的团队正在尝试创建一个输入代码并从中生成 MIPS 程序集的编译器。

为了在全局范围内处理数组声明，我们在 .text 中为数组创建一个标签，并保留 4 个字节来保存指向内存中数组开头的地址。

```
 .text
arr:    .space 4
    .data
...
li $t0, N         # (where N = number of elements in arr)
li $v0, 9         # Load system instruction to allocate dynamic memory
li $t1, 4         # 4 bytes per element
mult $t0, $t1     # Calculates how big the allocated memory has to be in bytes.
mflo $a0          # Loads this value into $a0
syscall           # Allocates memory and returns address into $v0
la $s0, arr       # load address of arr into $s0
sw $v0, ($s0)     # Save allocated memory address into the space reserved in .text 
```

但是，最后一条指令似乎对我们不起作用。

[此图像](http://puu.sh/1BfLU)准确显示了错误发生的位置以及当时寄存器的状态。我不确定它为什么会导致错误。

编辑：有关产生的错误的更多信息，已更新以包含最后修改的说明

```
[00400000] 8fa40000  lw $4, 0($29)            ; 183: lw $a0 0($sp) # argc 
[00400004] 27a50004  addiu $5, $29, 4         ; 184: addiu $a1 $sp 4 # argv 
[00400008] 24a60004  addiu $6, $5, 4          ; 185: addiu $a2 $a1 4 # envp 
[0040000c] 00041080  sll $2, $4, 2            ; 186: sll $v0 $a0 2 
[00400010] 00c23021  addu $6, $6, $2          ; 187: addu $a2 $a2 $v0 
[00400014] 0c100009  jal 0x00400024 [main]    ; 188: jal main 
[00400018] 00000000  nop                      ; 189: nop 
[0040001c] 3402000a  ori $2, $0, 10           ; 191: li $v0 10 
[00400020] 0000000c  syscall                  ; 192: syscall # syscall 10 (exit) 
[00400024] 34080003  ori $8, $0, 3            ; 9: li $t0, 3 # Load immediate value into register $t0 
[00400028] 34020009  ori $2, $0, 9            ; 10: li $v0, 9 
[0040002c] 34090004  ori $9, $0, 4            ; 11: li $t1, 4 
[00400030] 01090018  mult $8, $9              ; 12: mult $t0, $t1 
[00400034] 00002012  mflo $4                  ; 13: mflo $a0 
[00400038] 0000000c  syscall                  ; 14: syscall 
[0040003c] 3c101001  lui $16, 4097 [arr0]     ; 15: la $s0, arr0 
[00400040] ae020000  sw $2, 0($16)            ; 16: sw $v0, ($s0)

PC       = 400040
EPC      = 40003c
Cause    = 1c
BadVAddr = 1004002f
Status   = 3000ff12 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T21:40:00.493

最后一条指令`sw $v0, arr0($0)`=`MEM[$0 + arr0] = $v0`不正确。但是，您将获得请求的内存量，并且需要将该内存指针保存在寄存器中，直到程序范围。作业可能看起来像这样，

```
arr:    .space 4

syscall             # Allocates memory and returns address into $v0
la     $s0, arr     # arr is pointer address
st     $v0, 0($s0)  # start base address of array 
```

现在`arr`是 4 字节内存的基地址，用于保存内存内容的地址。为了获得良好的实践，重要的是取消分配给操作系统的内存，因为，

```
li      $v0,10      # return back to OS
syscall 
```

# jquery - 如何使函数/方法在 jQuery 中协同工作

> ID：13895608
> 
> 赞同：0
> 
> 时间：2012-12-15T19:49:45.200
> 
> 标签：jquery, function, methods

出于某种原因，在以下代码中，第一个函数完美运行时，淡入淡出方法不起作用。我如何让它们一起工作？

```
$(document).ready(function(){

    function updown() {
        $("#freccia")
            .animate( {"top": "+=20px"}, 2000, "easeInOutQuad" )
            .animate( {"top": "-=20px"}, 2000, "easeInOutQuad" );
        updown();
    }

    updown();

    $("#frontespizio")
        .hide()
        .fadeIn(2000)
        .delay(2000);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:56:33.347

```
$(document).ready(function(){    
     updown();
     fadeMe();     
});

function updown() {
    $("#freccia")
        .animate( {"top": "+=20px"}, 2000, "easeInOutQuad" )
        .animate( {"top": "-=20px"}, 2000, "easeInOutQuad" );
}

function fadeMe() {
    $("#frontespizio")
        .hide()
        .fadeIn(2000)
        .delay(2000);
} 
```

# python - CherryPy wsgi 基本http认证

> ID：13895612
> 
> 赞同：3
> 
> 时间：2012-12-15T19:50:06.960
> 
> 标签：python, cherrypy, basic-authentication

是否可以使用对象的`cherrypy.lib.auth_basic`方法`CherryPyWSGIServer`？

即使我调用`cherrypy.config.update`包含允许用户列表的函数，客户端仍然可以在没有任何身份验证凭据的情况下访问和使用应用程序。

```
 from soaplib.core import Application
    from cherrypy import wsgiserver
    import cherrypy
    from cherrypy.wsgiserver import CherryPyWSGIServer

    userpassdict = {'bird' : 'bebop', 'ornette' : 'wayout'}
    checkpassword = cherrypy.lib.auth_basic.checkpassword_dict(userpassdict)
    basic_auth = {'tools.auth_basic.on': True,
                    'tools.auth_basic.realm': 'earth',
                    'tools.auth_basic.checkpassword': checkpassword,
    }
    app_config = { '/' : basic_auth }
    cherrypy.config.update(app_config)

    #initialize service
    soap_app = Application([MySoapMethods], tns, app_name);
    wsgi_app = cherrypy.Application(soap_app);
    server = wsgiserver.CherryPyWSGIServer((server_addr, server_port), wsgi_app);
    server.start() 
```

# java - 为自定义驱动程序创建 GraphicsDevice

> ID：13895614
> 
> 赞同：0
> 
> 时间：2012-12-15T19:50:10.493
> 
> 标签：java, swing, user-interface, headless

我正在开发一个在嵌入式系统中使用 Java 的项目。我有用于屏幕和触摸输入的驱动程序，以及用于文本输入的虚拟键盘。我的屏幕驱动程序有一个`Graphics2D`可以绘制的对象和一个`repaint(Rectangle)`更新方法。类似地，触摸驱动程序能够`MouseEvents`为听众生成。

现在我正在直接在屏幕上绘图。这很好，但我真正想要的是允许我的库的用户创建一个 JFrame 并使用普通的 Swing 元素。但是，默认的 GraphicsEnvironment 是无头的，因为 Java 看不到我的`EInkDriver`班级或我的`TouchDriver`班级。

我知道有一些方法可以调用组件的`paint`方法来获取图像；但是，当您绘制 a 时，这会出现问题`Container`，我还想向用户展示 a `GraphicsConfiguration`，这样他们就可以编写类似的东西`JFrame frame = new JFrame(getEInkGraphicsConfiguration());`并继续进行，就好像他们正在编写桌面 Swing 应用程序一样。

鉴于我已经拥有这些功能，我将如何创建一个`GraphicsDevice`或`GraphicsEnvironment`允许我在我的项目中使用 Swing？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:09:33.133

我看了一眼抽象类[GraphicsEnvironment](http://javasourcecode.org/html/open-source/jdk/jdk-6u23/java/awt/GraphicsEnvironment.java.html)，猜想，可能派生出自己的类，并使用第 64 行的“java.awt.graphicsenv”键注册它。

好在有一个抽象类，代码很少。

* * *

***此后***

以下来自 GraphicsEnvironment 的代码显示：

1.  用于无头或不使用的系统属性（您可以设置）。
2.  环境设置 DISPLAY。

也许您可以使用此信息。

```
 String osName = System.getProperty("os.name");
                        if (osName.contains("OS X") && "sun.awt.HToolkit".equals(
                                System.getProperty("awt.toolkit")))
                        {
                            headless = defaultHeadless = Boolean.TRUE;
                        } else {
                            headless = defaultHeadless =
                                Boolean.valueOf(("Linux".equals(osName) ||
                                                 "SunOS".equals(osName) ||
                                                 "FreeBSD".equals(osName) ||
                                                 "NetBSD".equals(osName) ||
                                                 "OpenBSD".equals(osName)) &&
                                                 (System.getenv("DISPLAY") == null));
                        } 
```

# java - 框架。在一帧中添加 2 个 Jpanel 组件。不工作

> ID：13895615
> 
> 赞同：0
> 
> 时间：2012-12-15T19:50:32.743
> 
> 标签：java, user-interface, jframe, jpanel

问题：我正在尝试在我的框架中添加第二个 Jpanel，但是当我添加后者时，它会覆盖前一个。目的是在同一个框架中有 2 个组件（Jpanels），但它似乎只接受一个而不是两个。出现顺序应为一列两行：1：输入名称：2：TextField

```
 import javax.swing.*;

import java.awt.*;

public class Money2 extends JFrame {
    public Money2() {

        // setLayout(new GridLayout(2,2));

        JPanel p1 = new JPanel();
        p1.setLayout(new FlowLayout(FlowLayout.CENTER));
        p1.add(new JLabel("Enter name:"));
        // -------------------------------------------------------------------------
        // p2.setLayout(new FlowLayout(FlowLayout.CENTER));
        JPanel p2 = new JPanel(new FlowLayout());
        p2.add(new JTextField(8));

        add(p1); // add to Jframe
        add(p2);
    }

    /** Main method */
    public static void main(String[] args) {
        Money2 frame = new Money2();
        frame.setTitle("Money Converter App");
        frame.setLocationRelativeTo(null); // Center the frame
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        frame.setSize(350, 400);
        frame.setVisible(true);
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:52:36.883

两个面板不能在`BorderLayout`. 您可以将面板`p1`放在不同的位置：

```
add(p1, BorderLayout.PAGE_START); 
```

# java - 从列表中吐出播放次数最多的歌曲

> ID：13895618
> 
> 赞同：-2
> 
> 时间：2012-12-15T19:50:41.860
> 
> 标签：java, arrays, for-loop, arraylist, while-loop

您将如何编写代码让用户比较列表中的每首歌曲并返回播放次数最多的歌曲？另外，如果播放次数最多的歌曲不止一首，如何全部显示？

这是我到目前为止所拥有的：

```
case 5:
        boolean max = false;
        int mostPlays = 1;
        song = new Song(artist,title);

        for(int i = 0; i < songCollection.size(); i++)
        {
        song = songCollection.get(mostPlays);
        if (songCollection.get(i).getNoPlays() < song.getNoPlays())
        {
        songCollection.get(mostPlays).getTitle();
        mostPlays++;
        max = true;
        }
    else
        {
        mostPlays++;
        }
    }

    while (max)
        {
        System.out.println(song.getTitle());
        }
break; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T19:58:15.517

1.  按播放次数降序对列表进行排序。
2.  从头开始，显示歌曲，保存播放次数。
3.  转到下一首，如果播放次数相同则显示，否则停止。重复。

相关文档：

[集合.sort()](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html)

[比较](http://docs.oracle.com/javase/6/docs/api/java/util/Comparator.html)器（用于排序）

# oop - 在整个系统中创建具有相同参数的对象

> ID：13895620
> 
> 赞同：1
> 
> 时间：2012-12-15T19:51:32.887
> 
> 标签：oop, design-patterns, parameters, arguments, instantiation

我有一个执行非常特定任务的对象。要创建此对象，需要一些参数。我在系统的某些部分创建了一个新实例。但是有问题。如果将来必须更改参数或参数怎么办？我需要在任何地方进行更改。然后我想：“好吧，也许我可以将它的创建封装在一个类中，如果某些参数发生变化，我只需要在一个地方进行更改！”。

这对我来说确实很有意义。真正的问题是，这个“包装”对象是工厂吗？它的职责是“创建一个具有特定参数的新对象并返回它”。消费者只会使用这个对象......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T21:03:51.297

您重构代码以避免重复，这本身可能会提高您的整体可维护性。

如果这段重构代码正在创建对象，那么，是的，它是一个工厂。你怎么称呼它真的没关系 - 现在你的代码结构更好了吗？那就去做吧！

但是，鉴于它是工厂，研究有关工厂的经典设计模式，并了解是什么导致人们使用这种模式的更复杂形式。决定你是否有任何力量导致他们使用“聪明”的工厂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T15:13:28.667

您描述的问题是，当该类的构造函数参数更改时，您的类的所有客户端都必须更改。引入工厂可以帮助防止重新编译客户端。但这真的能解决问题吗？如果您修改要使用另一个参数构造的类，则必须在某处确定该参数，可能在启动构造的客户端的上下文中。工厂类应该怎么知道？客户是否必须将任何上下文信息传递给工厂？

构造对象需要哪些参数？客户是否提供它们，或者是否可以事先创建对象，然后像注入工厂一样将其注入客户端（据我了解，您的问题似乎是这种情况）？考虑使用[DI 框架](http://en.wikipedia.org/wiki/Dependency_injection)。这通常会使工厂过时。

你为什么害怕你的班级可能被改变？会不会是你的课做的太多了？注意[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)。在您的情况下，[开放/封闭原则](http://en.wikipedia.org/wiki/Open/closed_principle)也是一项有趣的研究。

据我了解，工厂不一定能解决您描述的问题。工厂负责创建远离客户端的对象，因此客户端不必知道对象的具体类型。也可以通过将参数包装在单个对象中来防止签名保持稳定。这也是众所周知的[重构模式](http://sourcemaking.com/refactoring/introduce-parameter-object)。但这也没有解决新参数从何而来的问题。

# html - 我需要向 div 添加什么属性才能为 AdBlock 用户隐藏它？

> ID：13895621
> 
> 赞同：2
> 
> 时间：2012-12-15T19:51:38.207
> 
> 标签：html, ads, adblock

复杂的标题，但这就是我想知道的。我的网站上有很多 Adblock 用户，我想为他们优化。

那么我必须向广告容器 div 添加什么样的类（例如）属性才能使它们对 Adblock 用户不可见？

你看，我想做的是让一个 div 看起来像一个广告，所以 Adblock 将它隐藏起来。

编辑：我知道的一个解决方案是根据 Javascript 检测 Adblock，然后据此隐藏我的 div。但我希望访问者的广告块隐藏 div 本身！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:10:25.283

请尝试使用`.banner-adv`类。在我看来，使用 id 并不是最好的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:02:23.950

试验了一下，找到了解决办法：

```
<div id="adright"><!-- Ad Content --></div> 
```

默认情况下，所有使用 Adblock 的访问者都会隐藏。

编辑：我只能在 2 天内接受我自己的回复作为答案吗？哦，来吧，stackoverflow。我以为你比这更好！

# ruby - ActiveRecord::HasManyThroughAssociationPolymorphicSourceError

> ID：13895622
> 
> 赞同：9
> 
> 时间：2012-12-15T19:51:46.973
> 
> 标签：ruby, polymorphic-associations, jointable

我需要一个玩家拥有许多结构和属于玩家的结构。结构是一种多态关系。

```
class Player < ActiveRecord::Base
  has_many :player_structures
  has_many :structures, :through => player_structures
end

class PlayerStructures < ActiveRecord::Base
  belongs_to :structure, polymorphic: true
  belongs_to :player
end

class StructureA < ActiveRecord::Base
  has_one :player_structure, :as => :structure
  has_one :player, :through => :player_structure
end

class StructureB < ActiveRecord::Base
  has_one :player_structure, :as => :structure
  has_one :player, :through => :player_structure
end 
```

但是如果我退出`Player.first`并询问它的结构，它会给出：

```
ActiveRecord::HasManyThroughAssociationPolymorphicSourceError: Cannot have a has_many :through association 'Player#structures' on the polymorphic object 'Structure#structure'. 
```

但它应该能够生成一个 SQL 查询，在其中找到所有带有其 id 的 player_structures，然后根据 structure_id 和 structure_type 获取结构。为什么这会失败，我怎样才能有效地构造一个多态连接表？

## 更新

如果我手动执行我希望它执行的操作，它会起作用：

```
player_structures.collect(&:structure) 
```

Rails，你不这样做吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-15T21:02:51.607

我认为您需要更具体地定义`Player`模型中的关系。例如：

```
class Player < ActiveRecord::Base
  has_many :player_structures
  has_many :structureas, :through => player_structures, :source => :structure, :source_type => 'StructureA'
  has_many :structurebs, :through => player_structures, :source => :structure, :source_type => 'StructureB'
end 
```

然后，您可以创建一个方法来返回关系中定义的所有结构，而不必单独访问每个结构。

# android - LibGDX 中元素之间的边距和填充

> ID：13895623
> 
> 赞同：8
> 
> 时间：2012-12-15T19:51:59.117
> 
> 标签：android, layout, libgdx

我的屏幕上有一个`VerticalGroup`of s。`Button`问题是按钮的位置非常接近一对一。我想在按钮之间添加一些空格，例如填充或边距。我在 API 中找到`pad`了方法，但没有扩展 Table，因此不包含此方法。请指出我如何在里面的按钮之间添加一些间距`Table``VerticalGroup``VerticalGroup`

示例代码

```
VerticalGroup buttons = new VerticalGroup();
buttons.addActor(btn1);
buttons.addActor(bnt2);
// ... and so on 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-11-29T12:43:40.520

迟到总比没有好：libGDX 使用 TableLayout ( [https://github.com/EsotericSoftware/tablelayout](https://github.com/EsotericSoftware/tablelayout) ) 来订购小部件。当您点击链接并转到“填充”部分时，您将看到一张图片来说明您的情况。为了获得边距（按钮**外**的间距），您必须使用以下代码：

```
 table.add(button).width(100).pad(10);
 table.row();
 table.add(lastButton); 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-02-26T12:59:04.567

这是非常*非常*新的，但是对于将来阅读此问题的任何人，VerticalGroup 中有一个**space**方法，旨在允许您定义元素之间的间距：

[http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/ui/VerticalGroup.html#space(float)](http://libgdx.badlogicgames.com/nightlies/docs/api/com/badlogic/gdx/scenes/scene2d/ui/VerticalGroup.html#space(float))

你可以在这里找到它的一个例子：

[https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/Scene2dTest.java](https://github.com/libgdx/libgdx/blob/master/tests/gdx-tests/src/com/badlogic/gdx/tests/Scene2dTest.java)

对于那些使用稍旧版本的 libgdx 的人，可以使用**setSpacing方法。**

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-15T20:39:36.967

不是从父元素（the `VerticalGroup`）添加填充，而是将填充添加到每个元素（`Button`s）。

libGDX[按钮](http://libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/scenes/scene2d/ui/Button.html)也是一个[表格](http://libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/scenes/scene2d/ui/tablelayout/Table.html)，表格支持各种[填充](http://libgdx.l33tlabs.org/docs/api/com/badlogic/gdx/scenes/scene2d/ui/tablelayout/Table.html#pad%28int%29)方法。这些记录在案以更改表格外部（或您的情况下的按钮）周围的填充。

# zip - 将单独文件夹中的 zip 文件提取到自己的文件夹中的脚本

> ID：13895624
> 
> 赞同：0
> 
> 时间：2012-12-15T19:52:04.277
> 
> 标签：zip, unzip

我有数百个文件夹，每个文件夹都包含一个 zip 文件。我想将每个 zip 文件提取到它们所在的位置。是否有一个简单的技巧或脚本来做到这一点？

编辑：

每个文件夹都在同一个父文件夹下。所以层次结构如下：

```
PARENT FOLDER
-SubFolder1
--somefile.zip
-Subfolder2
--somefile.zip
...
-SubfolderN
--somefile.zip 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:55:36.033

在 unix 下你可以使用类似的东西

`find <dir> -iname '*.zip' -execdir unzip {} \;`

程序 find 递归遍历`<dir>`并在它找到的每个 .zip 文件上更改到该文件目录并对其执行解压缩。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:05:28.727

视窗版本：

```
for /r "C:\Some\Directory" %f in (*.zip) do unzip "%f" -d "%~dpf" 
```

*警告：完全未经测试。*

参考：

*   [http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/for.mspx](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/for.mspx)
*   [http://www.info-zip.org/mans/unzip.html](http://www.info-zip.org/mans/unzip.html)

我认为使用 7-zip 会是

```
for /r "C:\Some\Directory" %f in (*.zip) do 7z x -o "%~dpf" "%f" 
```

但这甚至是未经测试的。

# mysql - 如何从 MySQL 文本字段中以空格分隔的列表中选择数字？

> ID：13895625
> 
> 赞同：0
> 
> 时间：2012-12-15T19:52:07.447
> 
> 标签：mysql

我正在使用现有数据库，该数据库在单个字段中列出了多个关联的 id 代码，用空格分隔。例如：“21 1894 774”

我正在尝试运行一个查询，在该查询中我提取包含该字段中某些数字的所有记录。例如，如果我搜索“21”，我想匹配包含“21 1894 744”、“21 4”、“1723 21 192”等的记录。

问题是它也匹配其他数字的部分。LIKE '%21%' 的查询匹配“221”、“215”、“1821”等。

我尝试了各种带空格的组合（'% 21%'、'%21 %' 等），效果更好，但它们仍然匹配其他数字的一部分。我也不能只做被空格包围的数字，因为它们可能在初始位置。

如何查询此表以获取在空格分隔的字段中具有独立“21”的所有记录？我难住了！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T19:56:05.760

试试这个条件：

```
SELECT * FROM your_table WHERE the_text_field LIKE '21 %' OR the_text_field LIKE '% 21 %' OR the_text_field LIKE '% 21' OR the_text_field = '21' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:01:48.670

MySQL 支持正则表达式。虽然最好拆分您的号码，但您可以搜索匹配项：

> select * from your_table where the_text_field regexp '\b21\b';

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T20:02:05.490

如果你想要一个简单的查询，[aurel.g 的答案](https://stackoverflow.com/a/13895654/11649)是唯一的方法；但它会在每次查询时对整个数据库进行全面扫描，因此性能会很糟糕。

如果您必须经常这样做，最好修复数据库。添加一个只有两个字段的新表，一个用于单个数字，一个外键指向您找到该数字的原始记录。然后对整个数据运行一次扫描，为该文本字段上的每个数字创建一条记录。最后，在两列上添加一个复合索引。

之后，用一个数字查询所有记录将非常快速和准确。

# apache - Apache RewriteRule 标记代理 NS

> ID：13895629
> 
> 赞同：0
> 
> 时间：2012-12-15T19:52:48.487
> 
> 标签：apache, mod-rewrite, url-rewriting, rewrite, mod-proxy

我正在尝试编写以下规则（请参阅评论）

```
# Redirect example.org/sub/* to sub.example.org/* explicitly
RewriteCond %{REQUEST_URI} ^/sub(.+)$ [NC]
RewriteRule ^ http://sub.%{HTTP_HOST}%1 [L,R=301,NS]

# Redirect sub.example.org/* to example.org/sub/* internally
RewriteCond %{HTTP_HOST} ^sub\.(.+)$ [NC]
RewriteRule ^ http://%1/sub%{REQUEST_URI} [L,P,NS] 
```

即使使用 NS 标志，当我点击 sub.example.org/foo 时，我得到的重定向太多，这里是 RewriteLog

```
applying pattern '^' to uri 'foo'
rewrite 'foo' -> 'http://example.org/sub/foo'
escaped URI in per-dir context for proxy, http://example.org/sub/foo -> http://example.org/sub/foo
forcing proxy-throughput with http://example.org/sub/foo
go-ahead with proxy request proxy:http://example.org/sub/foo [OK]

applying pattern '^' to uri 'sub/foo'
rewrite 'sub/foo' -> 'http://sub.example.org/foo'
explicitly forcing redirect with http://sub.example.org/foo
escaping http://sub.example.org/foo for redirect
redirect to http://sub.example.org/foo [REDIRECT/301] 
```

开启和开启

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:03:16.350

```
# Redirect example.org/sub/* to sub.example.org/* explicitly
RewriteCond %{REQUEST_URI} ^/sub(.+)$ [NC]
RewriteRule ^ http://sub.%{HTTP_HOST}%1 [L,R=301]

# Redirect sub.example.org/* to example.org/sub/* internally
RewriteCond %{HTTP_HOST} ^sub\.(.+)$ [NC]
RewriteRule - http://%1/sub%{REQUEST_URI} [L,P] 
```

没有 NS 标志，只是破折号...... doh

# c# - 如何使用标签属性删除动态添加的控件

> ID：13895632
> 
> 赞同：0
> 
> 时间：2012-12-15T19:53:24.430
> 
> 标签：c#, winforms

我有一个带有按钮的窗口窗体，当单击按钮时，它会动态生成控件，还添加了一个动态生成的按钮，以便它将删除对齐的控件，这意味着除了按钮之外，还有一行控件单击按钮时删除我的代码是

```
诠释 c = 0;
        私人无效按钮1_Click（对象发送者，EventArgs e）
        {
            诠释诉;
            v = c++;
            panel1.VerticalScroll.Value = VerticalScroll.Minimum;

            按钮 btn = new Button();
            btn.Name = "btn" + v;
            btn.Text = "删除";
            btn.Location = new Point(750, 5 + (30 * v));
            btn.Click += new EventHandler(btn_Click);

            组合框组合 = 新组合框（）；
            combo.Name = "组合框" + v;
            combo.Location = new Point(30, 5 + (30 * v));
            组合.标签 = btn;

            组合框combo2 =新组合框（）；
            combo2.Name = "combobox2" + v;
            combo2.Location = new Point(170, 5 + (30 * v));
            组合2.标签= btn；

            文本框 txt = 新文本框（）；
            txt.Name = "txtbx" + v;
            txt.Location = new Point(300, 5 + (30 * v));
            txt.标签 = btn;

            文本框 txt2 = 新文本框（）；
            txt2.Name = "txtbx2" + v;
            txt2.Location = new Point(450, 5 + (30 * v));
            txt2.标签 = btn;

            文本框 txt3 = 新文本框（）；
            txt3.Name = "txtbx3" + v;
            txt3.Location = new Point(600, 5 + (30 * v));
            txt3.标签 = btn;

            panel1.Controls.Add(组合);
            panel1.Controls.Add(btn);
            panel1.Controls.Add(txt);
            panel1.Controls.Add(combo2);
            panel1.Controls.Add(txt2);
            panel1.Controls.Add(txt3);   
        }
        private void btn_Click(object sender, EventArgs e)// 这是动态添加的按钮事件，它将删除组合框和文本框
        {
            按钮 btnh = 作为按钮的发送者；
            foreach（panel1.Controls.OfType<TextBox>() 中的控制项）
            {
                if (item.Tag == 发件人 || item == 发件人)
                    panel1.Controls.Remove(item);
            }
            foreach（panel1.Controls.OfType<ComboBox>() 中的控制项）
            {
                if (item.Tag == 发件人 || item == 发件人)
                    panel1.Controls.Remove(item);
            }
            panel1.Controls.Remove(btnh);
        }
```

我的错误没什么，但问题是它不会删除它留下的所有控件，我不知道问题是什么我的代码简单易行，但我不知道它缺少什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:07:54.410

问题是您在遍历集合时正在删除项目。在这种情况下，foreach 语句可能会跳过项目。首先将要删除的项目存储在列表中：

```
List<Control> toBeRemoved = panel1.Controls
    .Cast<Control>()
    .Where(c => c.Tag == sender)
    .ToList();
foreach (Control c in toBeRemoved) {
    panel1.Controls.Remove(c);
} 
```

如果您向后循环，您也可以轻松地在循环中删除：

```
for (int i = panel1.Controls.Count - 1; i >= 0; i--) {
    if (panel1.Controls[i].Tag == sender) {
        panel1.Controls.RemoveAt(i);
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-15T20:22:03.023

在 foreach 循环中删除项目通常会导致列表在您遍历时发生更改。

这个 linq 应该可以解决问题：

```
private void btn_Click(object sender, EventArgs e)// this is the dynamically added button's event which will remove the combobox and textbox
    {
        Button btnh = sender as Button;
        panel1.Controls.OfType<TextBox>().Where(i => i.Tag == sender || i == sender).ToList().ForEach(i => panel1.Controls.Remove(i));
        panel1.Controls.OfType<ComboBox>().Where(i => i.Tag == sender || i == sender).ToList().ForEach(i => panel1.Controls.Remove(i));

        panel1.Controls.Remove(btnh);
    } 
```

为什么 linq foreach 有效，但我不确定:)

# mpi - 提升 mpi 等效于 status.MPI_SOURCE

> ID：13895633
> 
> 赞同：0
> 
> 时间：2012-12-15T19:53:27.317
> 
> 标签：mpi, boost-mpi

是否有`boost::MPI`等效于以下 C MPI 代码？我正在尝试移植以下标准 MPI 代码，这是在[此处](http://www.lam-mpi.org/tutorials/one-step/ezstart.php)找到的基本主从模板。在 boost mpi 文档之后，只有 3 个参数，用于 mpi_send 或 mpi_recv 等级、标记和缓冲区。

```
while (work != NULL) {

    /* Receive results from a slave */

    MPI_Recv(&result,           /* message buffer */
             1,                 /* one data item */
             MPI_INT,        /* of type double real */
             MPI_ANY_SOURCE,    /* receive from any sender */
             MPI_ANY_TAG,       /* any type of message */
             MPI_COMM_WORLD,    /* default communicator */
             &status);          /* info about the received message */

    /* Send the slave a new work unit */

    MPI_Send(&work,             /* message buffer */
             1,                 /* one data item */
             MPI_INT,           /* data item is an integer */
             status.MPI_SOURCE, /* to who we just received from */
             WORKTAG,           /* user chosen message tag */
             MPI_COMM_WORLD);   /* default communicator */

    /* Get the next unit of work to be done */

    work = get_next_work_item();
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T21:37:40.280

从[boost.MPI 文档](http://www.boost.org/doc/libs/1_52_0/doc/html/mpi/tutorial.html#mpi.c_mapping)：

*   `MPI_ANY_SOURCE`变成`any_source`
*   `MPI_ANY_TAG`变成`any_tag`

该方法返回提供您需要的所有信息的[状态](http://www.boost.org/doc/libs/1_52_0/doc/html/boost/mpi/status.html)`communicator::recv()`类的实例：

*   `status.MPI_SOURCE`由返回`status::source()`
*   `status.MPI_TAG`由返回`status::tag()`

它还提供了两个转换运算符来将其内容转换为`MPI_Status`结构。

# c++ - 直接访问 boost::mapped_region 数据？

> ID：13895637
> 
> 赞同：3
> 
> 时间：2012-12-15T19:53:56.820
> 
> 标签：c++, arrays, memory, boost

在下面的代码中：

```
file_mapping fm(FilePath, read_only); 
mapped_region region(fm,read_only);
char* const data = static_cast<char *>(region.get_address());
for(size_t n=0; n<region.get_size(); ++n){
    cout << data[n];
} 
```

有什么方法可以在不需要创建`data`数组的情况下从映射内存中访问字符？

编辑代码是指`using namespace boost:interprocess;`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-20T23:47:08.117

“`data`数组”实际上并不是作为昂贵的分配或复制创建的——它只是指向操作系统用来表示内存中文件内容的虚拟内存空间的指针。所以这是一些簿记，但没有实际的重要工作。

当您第一次访问它时（即 data[0]），第一个文件块中的 OS 页面使用优化的例程比 C++ 流或 C 的 (f) 读取更有效。好的操作系统还会预加载第二个和后续块并静默丢弃旧的使用块，因此有效地管理物理内存，同时比您预期的要快。只需确保您的文件适合您的可用虚拟内存空间 - 通常只有 1+ GB 的 32 位代码文件才有问题。

所以不，没有其他方式 - 想要或知道 - 访问内容。（我不赞成使用标准 I/O 例程重新打开文件！）

# android - 画布安卓

> ID：13895642
> 
> 赞同：1
> 
> 时间：2012-12-15T19:55:07.223
> 
> 标签：android, canvas, paint

我正在用 android 开发，我必须`Paint`为 android 做一个。

我正在使用下面的代码，当我执行代码时，绘图工作，但是，似乎有 2 个表面要绘制，当你绘制一个时，另一个消失了。

我正在寻找确切的错误，但找不到它。

这是代码：

```
import java.util.Random; 

import android.annotation.SuppressLint;
import android.annotation.TargetApi;
import android.app.Activity;
import android.content.Context;
import android.graphics.Canvas;
import android.graphics.Paint;
import android.graphics.Path;
import android.os.Bundle;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
 import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.RelativeLayout;

public class MainActivity extends Activity {
  MySurfaceView mySurfaceView;
  Button Cuadrado;
  Button Circulo;
  Button Color;
  Button Linea;
  private boolean Bcuadrado,Bcirculo,Bcolor=false;
  private boolean Blinea=true;
    Canvas canvas = new Canvas();

  @TargetApi(11)
@SuppressLint("NewApi")
@Override
  public void onCreate(Bundle savedInstanceState) {
   super.onCreate(savedInstanceState);
       setContentView(R.layout.activity_main);
       RelativeLayout mainLayout =(RelativeLayout)findViewById(R.id.main_layout_id );
       View view =getLayoutInflater().inflate(R.layout.itemlayout, mainLayout,false);
       mainLayout.addView(view);
       mySurfaceView = new MySurfaceView(this);
       Cuadrado=(Button)findViewById(R.id.button1);
       Circulo=(Button)findViewById(R.id.button2);
       Color=(Button)findViewById(R.id.button3 );
       Linea=(Button)findViewById(R.id.button4 );
       int w= view.getWidth();
       int h= view.getHeight();
       float x=view.getX();
       float y= view.getY();
       mySurfaceView.setY(100);
       mainLayout.addView(mySurfaceView);
       Cuadrado.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            if(Bcuadrado==false){
                Bcuadrado=true;
                Bcirculo=false;
                Bcolor=false;
                Blinea=false;
            }
        }
       });

       Circulo.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            if(!Bcirculo){
            Bcuadrado=false;
            Bcirculo=true;
            Bcolor=false;
            Blinea=false;
        }
    }
   });

       Color.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
        if(!Bcolor){
            Bcuadrado=false;
            Bcirculo=false;
            Bcolor=true;
            Blinea=false;
        }
    }
   });

       Linea.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
        if(!Blinea){
            Bcuadrado=false;
            Bcirculo=false;
            Bcolor=false;
            Blinea=true;
        }
    }
   });
}

  class MySurfaceView extends SurfaceView{
   Path path;
   SurfaceHolder surfaceHolder;
   volatile boolean running = false;        
   private Paint paint = new Paint();
   float x0=0;
    float x1=0;
    float y0=0;
    float y1=0;
    Random random = new Random();

   public MySurfaceView(Context context) {
    super(context);
    surfaceHolder = getHolder();
    paint.setStyle(Paint.Style.STROKE);
    paint.setStrokeWidth(3);
    paint.setColor(android.graphics.Color.WHITE);

   }

   @Override
   public boolean onTouchEvent(MotionEvent event) {

       if(Blinea){
            if(event.getAction() == MotionEvent.ACTION_DOWN){
             path = new Path();
             path.moveTo(event.getX(), event.getY());
            }else if(event.getAction() == MotionEvent.ACTION_MOVE){
             path.lineTo(event.getX(), event.getY());
            }else if(event.getAction() == MotionEvent.ACTION_UP){
             path.lineTo(event.getX(), event.getY());
            }
            if(path != null){
                 canvas = surfaceHolder.lockCanvas();
                 canvas.drawPath(path, paint);
                 surfaceHolder.unlockCanvasAndPost(canvas);
                }

       }else if(Bcuadrado){
           if(event.getAction()==MotionEvent.ACTION_DOWN){
               x0=event.getX();
               y0=event.getY();
           }
           else if(event.getAction()==MotionEvent.ACTION_UP){
               x1=event.getX();
               y1=event.getY();
               canvas = surfaceHolder.lockCanvas();
               canvas.drawRect(x0, y0, x1, y1, paint);
               surfaceHolder.unlockCanvasAndPost(canvas);
           }

       }else if(Bcirculo){
           if(event.getAction()==MotionEvent.ACTION_DOWN){
               x0=event.getX();
               y0=event.getY();
           }
           else if(event.getAction()==MotionEvent.ACTION_UP){
               x1=event.getX();
               canvas=surfaceHolder.lockCanvas();
               canvas.drawCircle(x0, y0,(x1-x0), paint);
               surfaceHolder.unlockCanvasAndPost(canvas);
           }
       }else if(Bcolor){
             int r = random.nextInt(255);
             int g = random.nextInt(255);
             int b = random.nextInt(255);
             canvas=surfaceHolder.lockCanvas();
             paint.setColor(0xff000000 + (r << 16) + (g << 8) + b);
             surfaceHolder.unlockCanvasAndPost(canvas);
       }

    return true; 
   }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:47:45.037

> 似乎有 2 个要绘制的表面，当您绘制一个时，另一个消失了。

这正是`SurfaceView`它的工作原理——它是双缓冲的。每次都需要重绘整个帧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:50:55.443

来自 Android 的文档：[SurfaceHolder](http://developer.android.com/reference/android/view/SurfaceHolder.html#lockCanvas%28%29)

> 在 unlockCanvas() 和 lockCanvas() 之间永远不会保留 Surface 的内容，因此，必须写入 Surface 区域内的每个像素。此规则的唯一例外是指定脏矩形时，在这种情况下，将保留非脏像素。

画布不会保存您之前写入的内容。每次调用 unlock() 时，都必须重新绘制所有内容。

# jquery - 使用 JQuery 更改多个元素 OnResize 的类

> ID：13895645
> 
> 赞同：0
> 
> 时间：2012-12-15T19:55:32.077
> 
> 标签：jquery, class, onresize

好的，我对 jQuery 完全陌生，看起来我应该早点进入这一切，因为它确实提供了一大堆非常棒的选项。现在..我想做以下事情：

当用户调整页面大小时，我希望能够同时为各种元素设置 ClassName。因此，如果宽度在范围 A 和 B 之间，则设置类 1，在 B 和 C 之间，设置类 2，依此类推。到目前为止，我有这个：

```
<Script>
var sClass;
sClass = 'v11';
$(window).resize(function(){
CW = document.body.clientWidth;

if (CW >= 1 && CW <= 460) {sClass = 'v10';}
if (CW >= 461 && CW <= 770) {sClass = 'v11';}
if (CW >= 771 && CW <= 1100) {sClass = 'v12';}
document.getElementById('ZVal').value=CW;
document.getElementById('CVal').value=sClass;
    $(".zahbib").attr('class',sClass);
});
</script>

<Body LeftMargin='0' TopMargin='0' MarginHeight='0' MarginWidth='0'>

<InPut Type='Text' ID='ZVal'>
<InPut Type='Text' ID='CVal'>

<Table Width='100%' CellSpacing='0' CellPadding='0' Border='0'>
<Tr>
<Td class='zahbib' Width='40%'>Name:</Td>
<Td Width='60%'><InPut class='zahbib' Type='Text' Style='Width:100%'></Td>
</Tr>
<Tr>
<Td class='zahbib' Width='40%'>Email:</Td>
<Td Width='60%'><InPut class='zahbib' Type='Text' Style='Width:100%'></Td>
</Tr>
<Tr>
<Td class='zahbib' Width='40%'>Phone:</Td>
<Td Width='60%'><Select class='zahbib' Style='Width:100%'></Select></Td>
</Tr>
</Table>

</Body> 
```

我从其他 Stack Overflow 帖子中得到了大部分内容（尤其是 jquery 的东西），但是更改类只发生一次，然后它不会再次根据宽度更改。我认为它似乎只完成了 1 次任务，而不是文本字段。

那么我做错了什么？sClass 值可以正常工作，更新调试文本字段，宽度读数也是如此。我知道它可以根据浏览器返回略有不同的值，但这没关系，它不需要它非常精确。

非常感谢，我希望开始更彻底地了解这个 jQuery :) W

我现在使用的 CSS 是：

```
@media screen and (min-width: 1px) and (max-width: 460px){
zeb{font-size:12px}
zah{font-size:12px}
input.text{font-size:12px}
}
@media screen and (min-width: 461px) and (max-width: 770px){
zeb{font-size:16px}
zah{font-size:16px}
input.text{font-size:12px}
}
@media screen and (min-width: 771px) and (max-width: 1920px){
zeb{font-size:22px}
zah{font-size:22px}
input{font-size:12px}
} 
```

zeb 和 zah 是你通常放置 div 的地方。我只是不想使用 DIV，因为可能有一些我不想受到影响的 div。这样，我可以随意制作自己的标签，效果很好。（所以不是`<div></div>` 我输入`<zah>`and `</zah>`）他们工作。只是输入字段不会让步。谢谢你 ：）

好的，这是表格：

```
<Table Width='100%' CellSpacing='0' CellPadding='0' Border='0'>
<Tr>
<Td Class='v11' Width='40%'><zeb>Name:</zeb></Td>
<Td Width='60%'><input Type='Text' Style='Width:100%'></Td>
</Tr>
<Tr>
<Td Class='v11' Width='40%'><zah>Email:</zah></Td>
<Td Width='60%'><input Type='Text' Style='Width:100%'></Td>
</Tr>
<Tr>
<Td Class='v11' Width='40%'><zah>Phone:</zah></Td>
<Td Width='60%'><Select Style='Width:100%'></Select></Td>
</Tr>
</Table> 
```

正如我所说，zeb 和 zah 上的字体大小调整得很好 :) 当我调整窗口大小时，输入字段不会改变。zeb 和 zah 做 :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T19:58:47.630

我觉得使用媒体查询可以更轻松地完成您尝试做的事情。您可以将规则封装在媒体查询中，以确保应用的样式规则取决于视口的宽度。

因此，例如，当屏幕宽度在 1 到 460 像素之间时，要为所有 div 设置样式，您可以使用：

```
@media screen and (min-width: 1px) and (max-width: 460px){
  div {
      color: red;
  }
} 
```

此外，当宽度在 461 到 770 像素之间时，我们可以说我们希望颜色为绿色：

```
@media screen and (min-width: 1px) and (max-width: 460px){
  div {
      color: red;
  }
}

@media screen and (min-width: 461px) and (max-width: 770px){
  div {
      color: green;
  }
} 
```

您正在使用非标准 HTML 元素。尝试使用`span`元素并使用 ID 在 CSS 中隔离它们：

```
<Table Width="100%" CellSpacing="0" CellPadding="0" Border="0">
   <Tr>
      <Td Class="v11" Width="40%">
         <span class="zeb">Name:</span>
      </Td>
      <Td Width="60%"><input Type="Text" Style="Width:100%" /></Td>
   </Tr>
   <Tr>
      <Td Class="v11" Width="40%">
         <span class="zah">Email:</span>
      </Td>
      <Td Width="60%"><input Type="Text" Style="Width:100%" /></Td>
   </Tr>
   <Tr>
      <Td Class="v11" Width="40%">
         <span class="zah">Phone:</span>
      </Td>
      <Td Width="60%"><Select Style="Width:100%"></Select></Td>
   </Tr>
</Table> 
```

现在你可以将你的 CSS 应用到所有**类**zeb 和 zah 的元素上：

```
@media screen and min-width 1px and max-width 460px {
    .zeb, .zah, input.text
    {
        font-size:12px;
    }
}

@media screen and min-width 461px and max-width 770px {
    input.text
    {
        font-size:12px;
    }

    .zeb, .zah
    {
        font-size:16px;
    }
}

@media screen and min-width 771px and max-width 1920px {
    input
    {
        font-size:12px;
    }

    .zeb, .zah
    {
        font-size:22px;
    }
} 
```

请注意，我通过用逗号分隔选择器来压缩相同的规则。

# c++ - 在 C++ 中创建类错误

> ID：13895647
> 
> 赞同：1
> 
> 时间：2012-12-15T19:55:36.880
> 
> 标签：c++

我有一个测试类，除了类的骨骼之外，它什么都没有。

H：

```
#ifndef TEST_H_
#define TEST_H_

class Test
{
public:
    Test();
};

#endif /* TEST_H_ */ 
```

cpp

```
#include "test.h"

Test::Test()
{
} 
```

然后在我的主要课程中，我有：

```
Test *test = new Test(); 
```

我还包括 test.h。

我得到错误：

```
 Undefined reference to Test::Test() 
```

谁能告诉我哪里出错了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:09:02.087

想通了，即使在清理项目并重新启动 IDE 之后它仍然无法工作。我必须手动将 test.h 和 test.cpp 添加到我的 config.pri

# android - 如何在android中逐字符读取文本文件？

> ID：13895649
> 
> 赞同：0
> 
> 时间：2012-12-15T19:55:37.880
> 
> 标签：android, text, character, bufferedreader, filereader

我想知道如何逐个字符地从资产中读取文本文件。

例如，如果我有这个文件“text.txt”，里面有“12345”，我想一个一个地读取所有数字。

我已经在寻找这个，但我找不到任何解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T23:43:40.640

用于`getAssets().open("name.txt")`检索`InputStream`on `assets/name.txt`，然后根据需要读入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T00:04:00.647

感谢 CommonsWare 的回答 :) 连同我回复 Eric 的链接，我确实添加了您的代码，结果如下（完全正常）：

```
AssetManager manager = getContext().getAssets();
    InputStream input = null;
    try {
        input = manager.open("test.txt");
    } catch (IOException e1) {
        Log.d("ERROR DETECTED", "ERROR WHILE TRYING TO OPEN FILE");
    }
    try {
      char current;
      while (input.available() > 0) {
        current = (char) input.read();
        Log.d("caracter", ""+current);
      }
    } catch (IOException e) {
      e.printStackTrace();
    } 
```

谢谢你们的帮助：）

编辑：下一个代码将读取所有文件行，而上面不是：

```
AssetManager manager = getContext().getAssets();
    InputStream input = null;
    InputStreamReader in = null;
    try {
        input = manager.open("teste.txt");
        in = new InputStreamReader(input);
    } catch (IOException e1) {
        Log.d("ERROR DETECTED", "ERROR WHILE TRYING TO OPEN FILE");
    }
    try {
      char current;
      while (in.ready()) {
        current = (char) in.read();
        Log.d("caracter", ""+current);
      }
    } catch (IOException e) {
      e.printStackTrace();
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-11-09T10:50:29.600

以字符为单位读取文件，通常用于读取文本、数字和其他类型的文件

```
public static char[] readFileByChars(File file) {
        CharArrayWriter charArrayWriter = new CharArrayWriter();
        char[] tempBuf = new char[100];
        int charRead;

        try {
            BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(new FileInputStream(file)));
            while ((charRead = bufferedReader.read(tempBuf)) != -1) {
                charArrayWriter.write(tempBuf, 0, charRead);
            }
            bufferedReader.close();
            return charArrayWriter.toCharArray();
        } catch (Exception e) {
            e.printStackTrace();
            return null;
        }
    } 
```

# php - PHP继承问题

> ID：13895650
> 
> 赞同：0
> 
> 时间：2012-12-15T19:55:41.483
> 
> 标签：php

我用谷歌搜索了很长时间。我想我错过了一些重要的概念，但我不明白为什么这不起作用

//SomeClass.php

```
class SomeClass 
{
    protected $something;
    public function __construct() {
        $this->something = 'password';
    }
    public function test() {
        return ($this->something);
    }
} 
```

//其他类.php

```
require_once('SomeClass.php');
class OtherClass extends SomeClass
{   
    public function __construct() {
        echo parent::test();
    }
} 
```

这里有什么交易？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T20:05:00.517

您应该在调用 parent::test() 之前调用 parent::__construct()

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T19:58:10.623

构造函数不得返回任何值。

# javascript - node.js和浏览器之间关键字“this”的不同行为

> ID：13895651
> 
> 赞同：5
> 
> 时间：2012-12-15T19:55:49.570
> 
> 标签：javascript, node.js, browser

我在 ie，firefox 和 node.js 中尝试过以下代码

```
var x = 10;
var o = { x: 15 };
function f(){
     console.log(this.x);
}
f();
f.call(o); 
```

浏览器中的结果是 10、15，但 node.js 中的结果是未定义的，15。

请向我解释一下“this”关键字在浏览器和 node.js 中的不同行为是什么？我已经阅读了很多页，但没有任何明显的答案。提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-15T20:16:08.593

在 Nodejs 中加载的 Javascript 文件会自动包装在匿名函数中。

所以在 Node 中你真正运行的是：

```
(function(/* There are args here, but they aren't important for this answer */){
  var x = 10;
  var o = { x: 15 };
  function f(){
    console.log(this.x);
  }
  f();
  f.call(o);
})(); 
```

浏览器不这样做。问题是现在在 Node`x`中只是函数范围内的一个普通变量，它不是全局范围的一部分。当您`f()`以这种方式调用时，`this`within`f`是全局范围。

如果直接放在`x`全局作用域上，这两种情况都可以。

```
this.x = 10; 
```

这将放置`x`在`window`浏览器中的`global`全局对象和 Node.js 中的全局对象上。

通常，您不会在 Node 中全局加载内容，而是将代码分组到模块中，如此[处所述](http://nodejs.org/docs/latest/api/modules.html)。您可以[在此处](http://nodejs.org/api/globals.html)访问有关各种全球事物的信息。如果您对包装器感到好奇，可以[在这里查看](https://github.com/joyent/node/blob/master/src/node.js#L735)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:03:59.707

在调用常规函数时`f()`，严格模式与常规模式的行为不同。在常规模式下，`this`将是全局对象（例如`window`）。在严格模式下，`this`将`undefined`.

除了这种差异之外，`this`函数调用中的分配完全在 javascript 标准中指定，因此如果您在不同情况下看到差异，则可能是由于`strict`模式。将`strict`模式添加到两种环境中，您应该会看到一致的行为。

您可以阅读此[MDN 参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Functions_and_function_scope/Strict_mode)中的“保护 Javascript”部分以获取更多信息。

# iphone - AVAudioPlayer 的 XCODE IOS 内存泄漏

> ID：13895655
> 
> 赞同：1
> 
> 时间：2012-12-15T19:56:18.517
> 
> 标签：iphone, ios, xcode, avaudioplayer

我使用 ARC。

这是在我的代码中启动音频的方法：

.h 文件：

```
 @property (retain,nonatomic)AVAudioPlayer *myAudio; 
```

和 .m 文件

```
-(void)myPlaySound:(NSString *)mySoundFile NumberOfLoops:(int)loopsCount ofType:(NSString     *)fileType
{
    if([myAudio isPlaying])
    {
        [myAudio stop];
    }
    NSURL* musicFile = [NSURL fileURLWithPath:[[NSBundle mainBundle]
                                           pathForResource:mySoundFile
                                           ofType:fileType]];

    NSError *error;
    myAudio  = [[AVAudioPlayer alloc] initWithContentsOfURL:musicFile error:&error];

    self.theAudio = myAudio;
    myAudio.volume = audioVolume;
    myAudio.numberOfLoops = loopsCount;
    myAudio.currentTime = 0.0;
    [myAudio prepareToPlay];
    if([myAudio play] == NO)
    {
       NSLog(@"error");
    }
} 
```

基于按钮按下，我播放不同长度、比特率和类型的不同音频文件。

它的工作，但我得到内存泄漏问题。

# sql - Oracle SQL 生成查询

> ID：13895659
> 
> 赞同：1
> 
> 时间：2012-12-15T19:56:42.897
> 
> 标签：sql, database, oracle, oracle10g

以下是我的表架构。

频道列表表：

```
 CHAN_NUMBER  CHAN_NAME   CHAN_TYPE
 ----------- -----------------------------------
      1 MTV                   Music
      2 ESPN                  Sports
      3 TNT                   Movies
      4 Fox                   Movies
      5 Fox                   Sports 
```

客户调查表：

```
 SURV_ID SURV_DATE SURV_FAV_CHAN CUST_NUMBER
 ---------- --------- ------------- -----------
     1     25-NOV-12             1           2
     2     24-NOV-12             2           1
     3     24-NOV-12             3           3
     4     24-NOV-12             4           4
     5     24-NOV-12             5           5
     6     24-NOV-12             1           6
     7     24-NOV-12             2           7
     8     24-NOV-12             3           8
     9     24-NOV-12             4           9
    10     24-NOV-12             5          10
    11     24-NOV-12             1          11 
```

我有这两个表，我需要生成一个报告，列出每个`channel`和有多少`count of`作为他们的.`customers``selected that channel``favorite`

在 oracle 数据库上，我开始计算每次从 SURVEY 表中选择一个频道作为收藏夹时的计数。但我不**知道如何加入他们**来创建一个频道列表，显示`channel number`、`name`和`count of customers`谁选择它作为他们的最爱。

```
-- my channel table query

SELECT CHAN_NUMBER, CHAN_NAME FROM CHANNEL;

-- here is how I'm generating the couNt

SELECT COUNT(SURV_FAV_CHAN) FROM SURVEY
GROUP BY SURV_FAV_CHAN HAVING COUNT(SURV_FAV_CHAN) > 1; 
```

任何帮助都是极好的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:20:53.973

请检查此参考 * [SQLFIDDLE](http://sqlfiddle.com/#!2/9f779/4)

您说要**列出每个频道，并计算有多少客户选择了该频道作为他们的最爱**。

让我们从嵌套到外部。嵌套查询，您计算`Survery`表分组中的客户数量`favourite channel`。每个通道都意味着，您需要做一个`LEFT JOIN`on `Channels`table 来获取所有记录。

询问：

```
(select c.*, s.ct from 
channel c
left join
(select count(cust_number) as ct
 , surv_fav_chan from survey
group by surv_fav_chan) as s
on c.chan_number = s.surv_fav_chan
; 
```

结果：

```
CHAN_NUMBER     CHAN_NAME   CHAN_TYPE   CT
1               MTV         Music       3
2               ESPN        Sports      2
3               TNT         Movies      2
4               Fox         Movies      2
5               Fox         Sports      2 
```

您似乎将其`FOX`视为提供两种不同类型节目的两个频道。所以我保持原样。如果您甚至想按渠道类型计算客户，请澄清。

PS：您可能会忽略该 SQLFIDDLE 表示例中的其他旧表模式。**请注意**，它在 MYSQL 中，但这是一个**ANSI**查询 - 因此您也可以将其应用于 ORACLE。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:12:17.247

你可以尝试这样的事情：

```
SELECT MAX(CH.CHAN_NUMBER), MAX(CH.CHAN_NAME), COUNT(SRV.SURV_FAV_CHAN) FROM SURVEY SRV  
LEFT JOIN CHANNEL CH ON CH.CHAN_NUMBER = SRV.SURV_FAV_CHAN
GROUP BY SRV.SURV_FAV_CHAN HAVING COUNT(SRV.SURV_FAV_CHAN) > 1; 
```

如果我正确理解您的问题，如果您真的需要客户总数，您可能想要使用 SUM(SRV.SURV_FAV_CHAN)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T20:29:33.123

假设`SURV_FAV_CHAN`and`CHAN_NUMBER`是关系，将其用于您的`JOIN`，所以试试这个：

```
SELECT CHAN_NUMBER
     , CHAN_NAME
     , COUNT(DISTINCT SURVEY.CUST_NUMBER) AS FAV_CHANNEL_CNT
FROM   CHANNEL
LEFT JOIN SURVEY
ON     SURVEY.SURV_FAV_CHAN = CHANNEL.CHAN_NUMBER
GROUP BY CHAN_NUMBER, CHAN_NAME 
```

# prolog - 如何在 SWI-Prolog 中编写可选项

> ID：13895668
> 
> 赞同：2
> 
> 时间：2012-12-15T19:58:18.747
> 
> 标签：prolog, dcg

我需要通过 Prolog 实现一些规则

前任：

`S ---> A,[b],{c}.`

在哪里：

[b] 可能发生一次，也可能不发生，例如 0 或 1 次

{c} 可能发生 0,1,2,...次

我该怎么写？

***编辑：***

我用这个：

```
:- op(700,xfx,--->).
s ---> [vp].
s ---> [vp,conj,vp].
s ---> [vp,conj,np].
vp ---> [feal_amr],
        ([mfoal_beh];[]),
        ([mfoal_beh];[]),
        ([bdl];[]),
        [sefa_optional],
        ([hal];[]),
        ([shbh_gomla];[]),
        ([mfoal_motlk];[]). 
```

它给了我一个错误“句号正文中的句号？无法重新定义，/2”

在这一行的逗号中“vp ---> [feal_amr], ...”

***编辑***

我使用“--->”因为我有这个

```
parse_topdown(Category,String,Reststring,[Category|Subtrees]) :-
        Category ---> RHS,
        matches(RHS,String,Reststring,Subtrees). 
```

并且 "-->" 给出了操作符 ":-" 的错误？！！

***这是我的*** [阿拉伯语解析器代码](https://www.yousendit.com/download/WUJZblFPdzh3TGhESjlVag)

**很抱歉给您带来不便，但我不是 Prolog 专家**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:58:10.913

首先，您可能希望将 S 和 A 小写；Prolog 对变量名使用首字母大写。

允许 'b' 出现一次或根本不出现的一种方法是编写如下内容：

```
s --> a, b_optional, {c}.

b_optional --> [b].
b_optional --> []. 
```

如果您愿意，也可以将 b_optional 的两个规则编写为单个规则的语法；请参阅您最喜欢的 Prolog 文本中有关定子句语法的章节。

我不知道你所说的 c 发生 0、1、2、... 次是什么意思，所以我认为我无法帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T22:05:18.513

从你的描述

```
s --> [a], ([b] ; []), c_1.
c_1 --> [c], c_1 ; []. 
```

一些测试模式：

```
?- phrase(s, [a,b,c,c,c]).
true

?- phrase(s, [a]).
true 
```

**编辑**

关于您的代码：您应该使用`-->`. 为什么要声明`--->`（而不是定义）？这样你就应该编写*自己的*分析器，而*不是*使用 DCG。

请注意， [vp,conj,vp] 它是一个**终端**列表，

不确定 feal_amr、mfoal_beh 等，但 vp 它肯定是一个**非终端**（它被重写）。

那我觉得你应该写

```
s --> vp.
s --> vp,conj,vp.
s --> vp,conj,np.

vp -->
  [feal_amr],
  ([mfoal_beh];[]),
  ([mfoal_beh];[]),
  ([bdl];[]),
  [sefa_optional],
  ([hal];[]),
  ([shbh_gomla];[]),
  ([mfoal_motlk];[]).

% I hypotesize it's a comma.
conj --> [',']. 
```

**如评论中所述进行编辑**，您使用的*不是*DCG，而是您自己的解释器。我用一个最小的例子测试了它

```
:- op(700,xfx,--->).

s ---> [name,verb,names].

names ---> [name, conj, names].
names ---> [name].
names ---> [].

lex(anne, name).
lex(bob, name).
lex(charlie, name).

lex(call, verb).
lex(and, conj).

parse_topdown(Category,[Word|Reststring],Reststring,[Category,Word]) :-
        lex(Word,Category).

parse_topdown(Category,String,Reststring,[Category|Subtrees]) :-
        Category ---> RHS,
        matches(RHS,String,Reststring,Subtrees).

matches([],String,String,[]).
matches([Category|Categories],String,RestString,[Subtree|Subtrees]) :-
        parse_topdown(Category,String,String1,Subtree),
        matches(Categories,String1,RestString,Subtrees). 
```

该程序接受 0,1 或更多名称：

```
?- parse_topdown(s,[anne,call,bob,and,charlie],R,P).
R = [],
P = [s, [name, anne], [verb, call], [names, [name, bob], [conj, and], [names|...]]] ;
R = [charlie],
P = [s, [name, anne], [verb, call], [names, [name, bob], [conj, and], [names]]] ;
R = [and, charlie],
P = [s, [name, anne], [verb, call], [names, [name, bob]]] ;
R = [bob, and, charlie],
P = [s, [name, anne], [verb, call], [names]] ;
false. 
```

注意我让 R 自由，以检查部分匹配。回到最初的问题，您可以看到非终结符如何`names`接受 0,1 或许多（由 分隔`and`）值。

请注意，这样的解释器在任何实质性输入上都会非常慢。我建议您使用 DCG 重写您的语法。

# vb.net - Visual Basic 控制台应用程序复制百分比？

> ID：13895676
> 
> 赞同：-1
> 
> 时间：2012-12-15T20:00:08.673
> 
> 标签：vb.net, copy, console-application, percentage

我正在制作一个控制台应用程序，它将复制更大的文件（最多 2 GB）（使用 My.Computer.FileSystem.CopyDirectory），我想制作一个百分比指示器。我只是希望它显示当前的数字百分比（例如 23%）。我是 Visual Basic 的新手，我不知道该怎么做。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T02:35:25.690

这是一个在控制台应用程序中显示百分比指示器的代码示例：

```
For i = 1 To 100
  Console.Write(String.Format("Copy progress: {0}%" & vbCr, i))
  Threading.Thread.Sleep(100)
Next 
```

VB.NET 对 没有反应`\r`，您需要使用`vbCr`const 代替。

另请注意，您最后不需要额外的空格，因为百分比值总是会增加 - 不需要清理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:08:30.790

您可以像这样简单地打印行：

```
“复制过程：完成 30% \r”
```

到控制台（注意最后几个额外的空格 - 你需要它们来擦除旧垃圾）。另请注意，`\r`将光标返回行的开头，因此下一次打印将占用同一行。

# security - 如何保护 REST API 调用？

> ID：13895679
> 
> 赞同：103
> 
> 时间：2012-12-15T20:00:16.163
> 
> 标签：security, web-applications, backbone.js, rest

我正在开发一个在后端使用一些流行的 web 框架的 restful web 应用程序，比如（rails、sinatra、flask、express.js）。理想情况下，我想用 Backbone.js 开发客户端。如何只让我的 javascript 客户端与这些 API 调用交互？我不希望这些 API 调用是公开的，并且不希望`curl`通过在浏览器上输入链接来调用或简单地调用。

* * *

## 回答 #1

> 赞同：101
> 
> 时间：2012-12-15T20:15:22.433

作为第一个原则，如果你的 API 被你的 JS 客户端使用，你必须假设它是公开的：一个简单的 JS 调试器将攻击者置于一个位置，在那里他可以从他选择的工具。

也就是说，如果我正确阅读了您的问题，这不是您想要避免的：您真正不希望发生的是，您的 API 被使用（定期）而没有涉及您的 JS 客户端。以下是一些关于如果不强制执行的想法，那么至少鼓励使用您的客户端：

*   我敢肯定，您的 API 有某种身份验证字段（例如在客户端计算的哈希）。如果没有，请查看[This SO question](https://stackoverflow.com/questions/9386930/rest-api-authorization-authentication-web-mobile/9387289#9387289)。**确保使用基于会话**（aot 硬编码）提供给 JS 客户端的盐（甚至 API 密钥）。这样一来，未经授权的 API 使用者就会被迫做更多的工作。

*   在加载 JS 客户端时，请记住一些 HTTP 标头（想到用户代理）和 IP 地址，并在它们发生变化时要求重新验证，为通常的嫌疑人使用黑名单。这迫使攻击者再次更彻底地完成作业。

*   在服务器端，记住最后几个 API 调用，在允许另一个 API 调用之前，检查业务逻辑现在是否允许新的调用：这使攻击者无法将他的许多会话集中到与您的服务器的一个会话中：结合其他措施，这将使施虐者很容易被发现。

我可能没有说得那么清楚：我认为**不可能**让施虐者完全不可能消费你的服务，但你可以让它变得如此困难，这可能不值得麻烦。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-12-15T20:17:39.567

您应该实施某种身份验证系统。处理此问题的一种好方法是定义一些预期的标头变量。例如，您可以有一个返回会话令牌的 auth/login API 调用。对您的 API 的后续调用将期望在 HTTP 标头变量中设置一个会话令牌，该变量具有特定名称，例如“your-api-token”。

或者，许多系统使用某种 api 帐户系统创建预期的访问令牌或密钥（如 youtube、facebook 或 twitter）。在这些情况下，您的客户必须以某种方式将这些存储在客户端中。

然后只需将会话检查添加到您的 REST 框架并引发异常即可。如果可能的话，状态码（要安静）将是 401 错误。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2016-07-27T08:57:31.103

现在有一个开放标准称为“JSON Web Token”，

见[https://jwt.io/](https://jwt.io/) & [https://en.wikipedia.org/wiki/JSON_Web_Token](https://en.wikipedia.org/wiki/JSON_Web_Token)

> JSON Web Token (JWT) 是一种基于 JSON 的开放标准 (RFC 7519)，用于创建声明一些声明的令牌。例如，服务器可以生成具有“以管理员身份登录”声明的令牌并将其提供给客户端。然后，客户端可以使用该令牌来证明他们以管理员身份登录。令牌由服务器的密钥签名，因此服务器能够验证令牌是否合法。这些令牌被设计为紧凑、URL 安全和可用，尤其是在 Web 浏览器单点登录 (SSO) 上下文中。JWT 声明通常可用于在身份提供者和服务提供者之间传递经过身份验证的用户的身份，或业务流程所需的任何其他类型的声明。[1][2] 令牌也可以进行身份​​验证和加密。[3][4]

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-11-12T14:58:34.870

对不起@MarkAmery 和 Eugene，但这是不正确的。

您在浏览器中运行的 js+html（客户端）应用程序可以设置为排除对 API 的**未经授权**的直接调用，如下所示：

> 1.  第一步：设置 API 以要求身份验证。**客户端必须首先通过服务器（或其他一些安全服务器）对自己进行身份验证**，例如要求人类用户提供正确的密码。
> 
> **在进行身份验证之前，不接受对 API 的调用。**

在身份验证期间，会返回一个“令牌”。

身份验证后，仅接受带有身份验证“令牌”的 API 调用。

当然在这个阶段只有拥有密码的授权用户才能访问API，尽管如果他们是调试应用程序的程序员，他们可以直接访问它进行测试。

2.  第二步：现在设置一个额外的安全 API，在客户端 js+html 应用程序最初从服务器请求后的短时间内调用。这个“回调”会告诉服务器客户端下载成功。仅当最近成功请求客户端时才限制您的 REST API 调用。

现在，为了使用您的 API，他们必须首先下载客户端并在浏览器中实际运行它。只有在成功接收到回调，并在短时间内用户进入后，API才会接受调用。

因此，您不必担心这可能是没有凭据的未经授权的用户。

（问题的标题是“我如何保护 REST API 调用”，从你所说的大部分内容来看，这是你主要关心的问题，而不是如何调用你的 API 的字面问题，而是由谁来调用，对吗？ )

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-30T14:50:10.353

1.  当客户端首次加载您的`index.html`（或`backbone.js`等）时，在服务器上设置一个 SESSION var

2.  在每次 API 调用时在服务器端检查这个 var。

PS这不是一个“安全”解决方案！！！这只是为了减轻服务器上的负载，这样人们就不会滥用它或从其他网站和应用程序“热链接”您的 API。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-07-23T07:32:51.650

这就是我所做的：

1.  使用 X-APITOKEN 等调用使用 HTTP 标头保护 API：

2.  在 PHP 中使用会话变量。有一个登录系统并将用户令牌保存在会话变量中。

3.  使用 Ajax 调用 JS 代码到 PHP 并使用带有 curl 的 session 变量调用 API。这样，如果会话变量未设置，它将不会调用并且 PHP 代码包含 API 的访问令牌。

# c++ - 在不同模板化的类型上实现的链表

> ID：13895686
> 
> 赞同：3
> 
> 时间：2012-12-15T20:01:19.050
> 
> 标签：c++, templates, c++11

我已经实现了一个`Node`如下所示的类：

```
template<unsigned int Size>
class Node
{
    private:
        Eigen::Matrix<float, Size, Size> m_matrix;

        Node<?> *m_previousNode;
        Node<?> *m_nextNode;
}; 
```

它有一个成员变量，其维度由模板参数设置。此外，这是重要的部分，它存储指向前一个和下一个节点的指针（它们的大小可以不同于它自己的大小）。

现在，我有固定数量的这个类的不同大小的节点，我想将它们存储在一个`Network`类中。一开始可能是三维的：

```
template<unsigned int S0, unsigned int S1, unsigned int S2>
class Network
{
    private:
        Node<S0> *m_firstNode;
        Node<S1> *m_secondNode;
        Node<S2> *m_thirdNode;
}; 
```

这是我想实例化它的方式：

```
Network<10, 20, 5> network; 
```

如您所见，**节点的数量和每个节点的大小都是固定的**；之后无法对其进行修改。

我的问题是如何存储指向上一个和下一个节点的指针（`Node<?> *`在上面的代码中）。

我首先想到的是像这样扩展模板参数列表：

```
template<unsigned int PreviousSize, unsigned int Size, unsigned int NextSize>
class Node
private:
    Eigen::Matrix<float, Size, Size> m_matrix;

    Node<?, PreviousSize, Size> *m_previousNode;
    Node<Size, NextSize, ?> *m_nextNode; 
```

但显然，我必须知道前一个节点的前任的大小，导致同样的问题——我仍然无法填写`?`.

任何想法如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T13:01:09.010

我可以看到几个涉及链表的解决方案，但恐怕它们都是丑陋的；）

但是，鉴于列表的所有节点都属于一个共同的实体`Network`，我认为这就是我们的魔法卡。如果我们放弃列表的想法，而是瞄准网络中的“定位”节点，那么它会变得容易得多！

```
template <typename Network, unsigned Index, unsigned Size>
class Node {
public:

private:
    Network* m_network;
    Eigen::Matrix<float, Size, Size> m_matrix;
}; // class Node 
```

和网络：

```
template <unsigned Size0, unsigned Size1, unsigned Size2>
class Network {
public:
    template <unsigned Index>
    auto access() -> decltype(m_nodes.get<Index>()) {
        return m_nodes.get<Index>();
    }

    template <unsigned Index>
    auto get() const -> decltype(m_nodes.get<Index>()) {
        return m_nodes.get<Index>();
    }

private:
    std::tuple< Node<Network, 0u, Size0>,
                Node<Network, 1u, Size1>,
                Node<Network, 2u, Size2>> m_nodes;
}; 
```

最后，迭代？

```
template <typename Network, unsigned Index, unsigned Size>
auto Node<Network, Index, Size>::prev() -> decltype(m_network->access<Index-1>()) {
    return m_network->access<Index-1>();
}

template <typename Network, unsigned Index, unsigned Size>
auto Node<Network, Index, Size>::next() -> decltype(m_network->access<Index+1>()) {
    return m_network->access<Index+1>();
} 
```

好吧，除了我们在这里遇到了一个鸡和蛋的小问题......我们可以通过`Node`在`Network`类中嵌套定义来欺骗我们的出路。我可能会这样做，但是，为什么不接受迭代应该总是从网络类开始呢？

最后，这是我的建议：

```
template <unsigned Size>
class Node {
public:
    // ...
private:
    Eigen::Matrix<float, Size, Size> m_matrix;
};

template <unsigned Size>
std::ostream& operator<<(std::ostream& out, Node<Size> const&) {
    return out << "Node<" << Size << ">";
}

template <unsigned S, unsigned... Sizes>
class Network {
private:
    // Hack for gcc, using m_nodes in decltype requires that it's already been declared
    typedef std::tuple< Node<S>, Node<Sizes>... > Nodes;
    Nodes m_nodes;

public:

    static constexpr unsigned Size() { return sizeof...(Sizes) + 1; }

    template <unsigned Index>
    auto access() -> decltype(std::get<Index>(this->m_nodes)) {
        return std::get<Index>(this->m_nodes);
    }

    template <unsigned Index>
    auto get() const -> decltype(std::get<Index>(this->m_nodes)) {
        return std::get<Index>(this->m_nodes);
    }

}; // class Network 
```

当然，a`Node`不再知道它的位置，但你可以将它包装在一个迭代器中好吧：

```
template <typename Network, unsigned Index>
class NetworkIterator {
private:
    // Hack for gcc, using m_network in decltype requires that it's already been declared
    Network& m_network;

public:
    static_assert(Index < Network::Size(), "Index cannot exceed network size by more than one");

    NetworkIterator(Network& n): m_network(n) {}

    auto element() -> decltype(this->m_network.template access<Index>()) {
        return m_network.template access<Index>();
    }

    template <unsigned U = Index - 1>
    NetworkIterator<Network, U> prev() {
       return NetworkIterator<Network, U>(m_network);
    }

    template <unsigned U = Index + 1>
    NetworkIterator<Network, U> next() {
       return NetworkIterator<Network, U>(m_network);
    }
}; // class NetworkIterator 
```

是的，[它有效](http://liveworkspace.org/code/4pCuoL%2430)。

# c# - 使用 NHibernate 重用线程的会话

> ID：13895687
> 
> 赞同：1
> 
> 时间：2012-12-15T20:01:37.133
> 
> 标签：c#, wpf, multithreading, nhibernate, mvvm

我知道已经讨论了有关该主题的几个主题，因为我一直在阅读很多内容以尝试解决我的问题，但不知何故它们碰巧不能满足我的需求（可能是因为缺乏细节）。无论如何，如果您认为某些特定的“主题”可能有用，请链接它。

我正在使用 WPF（和 MVVM）开发桌面应用程序，并且正在使用 NHibernate。在研究了管理会话的可能方法后，我决定使用每表单会话的方法。通过这种方式，我想我可以充分利用 NHibernate 的延迟加载、缓存等特性。当我使用数据库时，我不想在加载或保存我的实体时冻结我的 UI，所以我认为我应该使用专用线程（在每种形式中，我认为这可以简化开发）处理数据库交互。但是，问题是我应该如何“重用”线程（假设我有一个与该线程关联的会话）来进行“数据库调用”。

*   我想我不能使用 TPL，因为我不能保证这两个任务会在同一个线程中运行（甚至不能保证它们会在与调用者不同的线程中运行）
*   我更喜欢使用 session-per-form，因为我已经看到类似的讨论以使用 session-per-conversation 或类似的方式结束。但是无论如何，如果您发现每次会话会话会更好，请告诉我（并希望解释原因）
*   线程不提供直接运行多个方法的方法，所以我认为我必须“监听”请求，但我仍然不确定我是否真的必须这样做以及如何“使用”会话（并保存）仅在线程内。

编辑：也许我遇到了这个问题，因为我将线程安全与其他东西混淆了。当 NHibernate 文档说 ISession 实例不是线程安全的时，这是否意味着如果两个线程同时尝试使用它，我会（或可能）遇到麻烦**，**对吗？就我而言，如果我使用 TPL，不同的线程可以使用同一个会话，但我不会同时在同一个会话中执行多个操作。那么，在那种情况下我会遇到麻烦吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T21:56:13.867

如果我可以提出建议，桌面应用程序不太适合直接与数据库交互。通信没有加密，即使是最有知识的人也很容易获取数据库密码并开始使用 SQL 连接弄乱记录并破坏您的数据库。

最好在桌面应用程序和数据库之间创建一个具有身份验证的 Web 服务，因为您可以为每个人创建凭据，并且每笔交易都将强制遵守您的各种业务规则。

这也将解决您的线程问题，因为您将能够在另一个线程上创建 HTTP 连接，而会话管理几乎没有问题。一个 cookie 值可能就是所有需要的，而 RestSharp 使这变得相当简单。

# yii - 乙。无法从模块注销

> ID：13895693
> 
> 赞同：1
> 
> 时间：2012-12-15T20:02:07.397
> 
> 标签：yii, yii-components

我有该模块的管理模块和不同的 CWebUser(adminuser)。它适用于登录。所以我可以通过不同的用户登录主应用程序和模块。但是当我在模块中调用注销方法时

```
Yii::app()->getModule('admin')->adminuser->logout(); 
```

它也将我从模块和主应用程序中注销。
我该如何解决？
预先感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-08-29T09:16:53.703

我认为关键是`stateKeyPrefix`可以用来告诉不同的模块使用不同的会话密钥。我将放置`main`配置文件`user`部分。

```
'user' => [
     'allowAutoLogin' => true,
     **'stateKeyPrefix' => 'YOUR-DEFAULT_',**
     'loginUrl' => array('/login'),
     'class' => 'application.wsi.auth.WSIWebUser',
     'authTimeout' => 3600 * 24 // 1 hour
], 
```

我有管理模块，我会`AdminModule.php`为您提供。

```
class AdminModule extends \CWebModule 
{   
      public $defaultController = 'index';

      public function init()
      {
          $this->setImport(array(
             'admin.components.*',
          ));
          $this->layout = 'main';
          \Yii::app()->setComponents(array(
              'authManager' => array(
                   'class' => 'CPhpAuthManager',
                   'authFile' => \Yii::getPathOfAlias('admin.data.auth') .'php',
                   'showErrors' => true,
              ),
              'user' => array(
                   'stateKeyPrefix' => 'admin_',
                   'loginUrl' => \Yii::app()->createUrl('/admin/index/login'),
                   'class' => 'AdminWebUser',
                   'authTimeout' => 3600 * 24 // 1 day
              ),
          ), false);

      }

} 
```

我在模块中有`components`文件夹，里面也有类。`admin``AdminWebUser`

```
class AdminWebUser extends \CWebUser {

    public function getId() {
        return Yii::app ()->user->getState ( 'id' );
    }
    public function getName() {
        return Yii::app ()->user->getState ( 'name' );
    }

    public function getRole() {
        return Yii::app ()->user->getState ( 'role' );
    }

    public function getEmail() {
        return Yii::app ()->user->getState ( 'email' );
    }
} 
```

其余登录和注销控制器代码相同。希望能帮助到你。如果没有，请告诉我。

# c# - C# 实体框架插入而不是更新

> ID：13895696
> 
> 赞同：1
> 
> 时间：2012-12-15T20:02:34.460
> 
> 标签：c#, entity-framework-4.1

假设我在“customersFromFile”列表中有 11,000 个客户，在 DB 中有 8000 个客户

使用下面的代码，我希望 EF 将更新 DB 中现有的 8000 个客户，并将剩下的 3000 个添加到 DB

控制台正确打印“更新的客户：8000”和“添加到客户：3000

但是在 DB 现在我总共有 19000 个客户，尽管现有的 8000 个已成功更新。

请帮助我。

```
DEMOEntities context = new DEMOEntities();
context.Configuration.AutoDetectChangesEnabled = false;
context.Configuration.ValidateOnSaveEnabled = false;

int i = 0;
foreach (var customerInDB in context.Customers)
{
    //Console.WriteLine("Update customer: " + customerInDB.CustomerID.ToString());
    customerInDB.Name = customersFromFile[i].Name;
    customerInDB.CIC = customersFromFile[i].CIC;
    customerInDB.IndustryCode = customersFromFile[i].IndustryCode;
    context.Entry(customerInDB).State = EntityState.Modified;
    i++;
}

Console.WriteLine("Updated customers: " + i.ToString());

int j = 0;
for (; i < customersFromFile.Count; i++)
{
    context.Customers.Add(customersFromFile[i]);
    j++;
}
Console.WriteLine("Added to customer:" + j.ToString());    

Console.WriteLine("Saving changes to customer...");
context.SaveChanges(); 
```

更新 2：感谢 TomTom 的回答，我在形成 CustomerFromFile 列表时将客户添加到上下文中的错误。我花了几个小时才发现这个:(

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:11:46.127

这听起来像您的客户没有唯一标识符。

在第二个循环中，您应该在添加之前检查“来自文件的客户”是否已经在数据库中（可能基本上相同的名称、相同的 CIC 和相同的 IndustryCode）。

# java - 在 Eclipse 上安装 Java 3D

> ID：13895701
> 
> 赞同：7
> 
> 时间：2012-12-15T20:03:28.270
> 
> 标签：java, eclipse, jar, java-3d, bin

我已经设置了我的变量路径以包含 j3d 的 bin 和 lib 文件。当我打开eclipse时，我必须手动构建路径->配置构建路径->添加jar并为每个项目添加所有.jar文件。然后我必须将它们的本机路径设置为 .bin 文件夹。这是一个非常乏味的过程。我想知道是否有一种方法可以将 j3D 安装到我的 Eclipse 中，以便所有库都已添加到所有项目中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:42:12.670

您创建包含所有必要 jar 的用户库。然后你可以在任何项目中使用这个库。要在另一个 Eclipse 工作区中使用它，只需将其导出即可。

`Preferences`您可以在-> `Java`-> `Build Path`->中找到用户库`User Libraries`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T23:15:28.590

如果您尝试过或者看起来很明显，请原谅我，但也许您可以使用像[Maven](http://maven.apache.org/plugins/maven-eclipse-plugin/)或 ANT（Eclipse 附带）这样的库管理工具。

这些工具允许您将 bulid 的所有必要库包含到 pom.xml 文件中。然后 ANT/Maven 软件会在构建过程中为您完成所有繁琐的工作。这些工具涉及一些开销，但是有很多[教程](http://maven.apache.org/guides/mini/guide-ide-eclipse.html)可以帮助您学习它们。我们通常在所有较大的 Eclipse 项目中使用 Maven。

# objective-c - 目标 C UIColor 到 NSString

> ID：13895703
> 
> 赞同：5
> 
> 时间：2012-12-15T20:03:48.673
> 
> 标签：objective-c, ios, ios6, nsstring, uicolor

我需要将 UIColor 转换为带有颜色名称的 NSString，即

```
[UIColor redColor]; 
```

应该成为

```
@"RedColor" 
```

我已经尝试过`[UIColor redColor].CIColor.stringRepresentation` ，但它会导致编译器错误

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-15T20:14:36.803

只是扩展@Luke链接到的答案，它创建了一个CGColorRef传递给CIColor：

```
CGColorRef colorRef = [UIColor grayColor].CGColor; 
```

您可以改为简单地传递您正在处理的 UIColor 的 CGColor 属性，例如：

```
NSString *colorString = [[CIColor colorWithCGColor:[[UIColor redColor] CGColor]] stringRepresentation]; 
```

不要忘记导入 Core Image 框架。

旁注，从字符串转换回 UIColor 的快速简便的方法可能是这样的：

```
NSArray *parts = [colorString componentsSeparatedByString:@" "];
UIColor *colorFromString = [UIColor colorWithRed:[parts[0] floatValue] green:[parts[1] floatValue] blue:[parts[2] floatValue] alpha:[parts[3] floatValue]]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-06T07:12:17.593

这是将 UIColor 转换为 NSString 的最短方法：

```
- (NSString *)stringFromColor:(UIColor *)color
{
    const size_t totalComponents = CGColorGetNumberOfComponents(color.CGColor);
    const CGFloat * components = CGColorGetComponents(color.CGColor);
    return [NSString stringWithFormat:@"#%02X%02X%02X",
            (int)(255 * components[MIN(0,totalComponents-2)]),
            (int)(255 * components[MIN(1,totalComponents-2)]),
            (int)(255 * components[MIN(2,totalComponents-2)])];
} 
```

# django - admin.autodiscover() 的问题

> ID：13895710
> 
> 赞同：0
> 
> 时间：2012-12-15T20:04:16.710
> 
> 标签：django, django-models, django-admin

我遇到了问题`admin.autodiscover()`。我刚刚将我的站点从我正在构建它的系统移到它将保留用于生产使用的服务器上。用于构建它的系统是 Windows 7，但生产服务器是 Debian Squeeze 64 位。

问题是我得到了错误`The model UserProfile is already registered`。我的 Windows 7 计算机没有这个问题，只有当它迁移到 Debian 时才会出现。

管理员.py

```
class UserProfileadmin(admin.ModelAdmin):
    list_display = ['user', 'country', 'totalflights', 'totalhours', 'hub']
    search_fields = ['user']
    list_filter = ['hub']
    def formfield_for_foreignkey(self, db_field, request, **kwargs):
         if db_field.name == 'hub':
             kwargs['queryset'] = Airports.objects.filter(hub=True)

    return super(UserProfileadmin, self).formfield_for_foreignkey(db_field, request, **kwargs)

admin.site.register(UserProfile,UserProfileadmin)
class PilotRankadmin(admin.ModelAdmin):
    list_display = ['ranktitle', 'minimumhours', 'pay']
    search_fields = ['ranktitle']

admin.site.register(PilotRank, PilotRankadmin)

class PIREPadmin(admin.ModelAdmin):
    list_display = ['user', 'flightnumber']
    search_fields = ['ranktitle']

admin.site.register(PIREP, PIREPadmin) 
```

有任何想法吗？在 Windows 系统上工作然后转移到 Linux 系统进行生产时，我以前从未遇到过这种情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T21:09:17.297

您可以发布错误堆栈详细信息...您是否在调用 register 之前尝试过使用 admin.site.unregister(UserProfile) ？

编辑：这对我来说似乎很好 -

```
if not admin.site._registry.has_key(UserProfile):
        admin.site.register(UserProfile) 
```

# jquery - 如果 id 为 A，则制作图像 opaq 如果 id 为 B，则制作图像不是 opaq

> ID：13895714
> 
> 赞同：0
> 
> 时间：2012-12-15T20:05:21.370
> 
> 标签：jquery, image

```
$(document).ready(function(){
var $message = $('div.utilul3 .moveThis img');
$message.filter('[id="i_icon_mini_message"]')
   .find('.utilities img').addClass('opaqimg');
$message.filter('[id="i_icon_mini_new_message"]')
   .find('.utilities img').removeClass('opaqimg');
});​ 
```

我想要做的是`id`等于`i_icon_mini_message`然后使图像`.utilities`不透明，我 addClass`.opaqimg`

如果`id`等于`i_icon_mini_new_message`然后什么都不做使图像不透明，尽管我创建修复只是为了确保通过执行`.removeClass`

上面的代码似乎对我不起作用。我也试过而不是做

`.filter('[id="i_icon_mini_message]')`这样做`.attr('id','i_icon_mini_message')`似乎会因未读取正确的值而引发控制台错误。

有人可以帮我实现我在这里想要实现的目标吗

[http://jsfiddle.net/3tG2x/1/](http://jsfiddle.net/3tG2x/1/) 搜索id名称

[http://jsfiddle.net/3tG2x/2/](http://jsfiddle.net/3tG2x/2/) 搜索标题

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:09:56.107

您似乎正在调用`find`一组`img`元素。这永远不会起作用，因为`img`元素没有后代。

要将 opaque 类添加到具有 id 的所有图像`i_icon_mini_message`，请使用：

```
$('img#i_icon_mini_message').addClass('opaqimg'); 
```

同样，要删除类：

```
$('img#i_icon_mini_new_message').removeClass('opaqimg'); 
```

# sqlite - SQLite - 使用随机唯一值更新

> ID：13895716
> 
> 赞同：3
> 
> 时间：2012-12-15T20:05:33.403
> 
> 标签：sqlite, random, unique

我正在尝试用从 0 到行数的随机值填充列中的每一行。到目前为止我有这个

```
UPDATE table
SET column = ABS (RANDOM() % (SELECT COUNT(id) FROM table)) 
```

这可以完成工作，但会产生重复的值，结果很糟糕。我添加了一个唯一约束，但这只会导致它崩溃。

有没有办法用特定范围内的随机唯一值更新列？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T22:19:45.393

如果您想稍后以随机顺序读取记录，您可以在当时进行排序：

```
SELECT * FROM MyTable ORDER BY random() 
```

（如果您在多个查询中需要相同的顺序，这将不起作用。）

* * *

否则，您可以使用临时表来存储表的`rowid`s 和数字 1..N 之间的随机映射。（这些数字是由`rowid`临时表的 s 自动生成的。）

```
CREATE TEMP TABLE MyOrder AS
  SELECT rowid AS original_rowid
  FROM MyTable
  ORDER BY random();
UPDATE MyTable
  SET MyColumn = (SELECT rowid
                  FROM MyOrder
                  WHERE original_rowid = MyTable.rowid) - 1;
DROP TABLE MyOrder; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:40:25.813

您似乎在寻找的不仅仅是一组随机数，而是数字 1..N 的随机排列。这更难做到。如果您查看 Knuth（计算机编程艺术）或 Bentley（编程珍珠或更多编程珍珠），建议的一种方法是创建一个值为 1..N 的数组，然后为每个位置交换当前位置值与从数组中随机选择的其他值。（我需要挖掘书籍以检查它是否是数组中的任意位置，或者仅在数组中跟随它的值。）在您的上下文中，然后将此排列应用于下表中的行一些排序，因此排序下的第 1 行获取数组中位置 1 的值（使用基于 1 的索引）等。

在 Programming Pearls 的第 1 版第 11 列搜索中，Bentley 说：

> 3.4.2 节中的 Knuth 算法 P 将数组 X[1..N] 打乱。
> 
> ```
> for I := 1 to N do
>     Swap(X[I], X[RandInt(I,N)]) 
> ```

其中`RandInt(n,m)`函数返回范围 [n..m]（含）内的随机整数。如果不简洁，那也不算什么。

另一种方法是在还有一个值要更新时让您的代码不停地跳动，等到随机数生成器选择一个尚未使用的值。作为一个命中注定的过程，这可能需要一段时间，尤其是在总行数很大的情况下。

实际上将其翻译成 SQLite 是一个单独的练习。你的桌子有多大？上面是否有一个方便的唯一键（除了你随机化的那个）？

* * *

假设您有一个主键，您可以轻松地生成一个结构数组，以便为​​每个主键分配一个 1..N 范围内的数字。然后，您使用算法 P 来排列数字。然后，您可以使用适当的随机数从主键更新表。您可能可以使用 SQL 中的第二个（临时）表来完成这一切，特别是如果 SQLite 支持在两个表之间连接的 UPDATE 语句。但是使用数组来驱动单例更新可能几乎一样简单。在此更新进行时，您可能不希望对随机数列有唯一约束。

# java - Android MediaPlayer seekTo 方法在 JellyBean 设备上不起作用，但在 Gingebread、Froyo 上运行良好

> ID：13895717
> 
> 赞同：2
> 
> 时间：2012-12-15T20:05:43.780
> 
> 标签：java, android, audio-streaming, android-mediaplayer

我在使用 MediaPlayer.seekTo(int msec) 方法时遇到了一些问题。基本上我正在使用 SeekBar 来跟踪流的进度（正在流式传输的 .mp3 文件）。我允许用户移动搜索栏来搜索流的不同部分。当他们寻找时，我使用 OnSeekBarChangeListener 中的 onStopTrackingTouch() 来准确跟踪他们寻找的位置。然后我将此毫秒值传递给我的流媒体服务：

```
Intent intent = new Intent(mContext, StreamingService.class);
intent.setAction(StreamingService.SERVICE_SEEK_TO);
intent.putExtra(StreamingService.EXTRA_SEEK_TO, seekBar.getProgress());
mContext.startService(intent); 
```

流服务处理此意图并尝试调用 mediaPlayer.seekTo()。这适用于我的 Froyo 和 Gingerbread 设备，但不适用于我的 JellyBean 设备。例如，如果我寻求 40,000 毫秒，我的 JellyBean 设备会跳回到 10,000 毫秒。而在 Gingerbread 或 Froyo 上，搜索实际上从 40,000 毫秒开始工作和播放。JellyBean 中的 MediaPlayer 有什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-02T18:14:13.220

正如tokudu在他的评论中提到的那样；流类型非常重要。它适用于 NPR，因为他们使用的是 ShoutCast。

# ios - 使用 Google Drive 上传 GTLService 中的断言失败

> ID：13895719
> 
> 赞同：0
> 
> 时间：2012-12-15T20:05:58.890
> 
> 标签：ios, google-drive-api

我正在尝试在我的 iOS 应用中使用 Google Drive。它验证并浏览正常，但是当我尝试上传文件时，出现以下错误：

```
*** Assertion failure in -[GTLService uploadFetcherWithRequest:fetcherService:params:](), /google-api-objectivec-client-read-only/Source/Objects/GTLService.m:565 
```

这是我的相关代码：

```
GTLUploadParameters *uploadParameters = [GTLUploadParameters uploadParametersWithData:fileContent MIMEType:@"application/pdf"];

GTLDriveFile *file = [[GTLDriveFile alloc] init];
file.title = @"test.pdf";

GTLQueryDrive *query = [GTLQueryDrive queryForFilesInsertWithObject:file uploadParameters:uploadParameters];

[self.driveService executeQuery:query completionHandler:^(GTLServiceTicket *ticket,
                                                        GTLDriveFile *updatedFile,
                                                        NSError *error) {
  NSLog(@"Done");
}]; 
```

有没有人遇到过这个问题？显然，我猜我在设置的某个地方遗漏了一些东西，但我不知道是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-19T14:32:06.487

将 -ObjC -all_load 添加到应用程序项目的 Build Settings 中的 Other Linker Flags 设置。

检查[https://developers.google.com/drive/quickstart-ios中的上述步骤](https://developers.google.com/drive/quickstart-ios)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:13:24.067

我浏览了源码，对应的行是：

```
GTL_ASSERT(uploadClass != nil, @"GTMHTTPUploadFetcher needed"); 
```

在stackoverflow上搜索导致了[这个答案](https://stackoverflow.com/a/6463772/254422)：

> 它表明 GTMHTTPUploadFetcher 类未链接到您的应用程序。由于类文件未在调试或发布构建目标中链接，或者由于未设置预处理器定义 GDATA_INCLUDE_YOUTUBE_SERVICE，该类可能会丢失，如[http://code.google.com上的“删除不需要的代码”中所述/p/gdata-objectivec-client/wiki/BuildingTheLibrary](http://code.google.com/p/gdata-objectivec-client/wiki/BuildingTheLibrary)

# android - Android Spinner 每半秒将自身重新选择为第一个值

> ID：13895720
> 
> 赞同：-1
> 
> 时间：2012-12-15T20:06:18.680
> 
> 标签：android, spinner, android-spinner

所以，我有一个微调器，填充了 ~35 个值。如果我选择第五个项目，那么当它被选中时，它会做它应该做的事情（填充第二个微调器）。我的问题是，不久之后（<1/2 秒），它会将第二个微调器中的值恢复为选择第一个微调器中的选项 1 时的值。第一个微调器中的第五个项目仍处于选中状态，但它的作用就像第一个项目每秒被选中两次。

我已经尝试了我能找到的所有东西（几乎没有任何东西），到目前为止没有任何效果。这基本上让我坚持在我的应用程序中走得更远。

完整代码：

```
package com.nicotera.colton.londontransitguide;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

import org.jsoup.*;
import org.jsoup.nodes.Attributes;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import android.app.Activity;
import android.os.AsyncTask;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemSelectedListener;
import android.widget.ArrayAdapter;
import android.widget.Spinner;

public class RoutesActivity extends Activity implements OnItemSelectedListener {
    Spinner dirSpinner;
    Spinner routeSpinner;

static String [] namedDirections = new String [2];
private static final String TAG = "RoutesActivity";

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState){
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_routes);
    dirSpinner = (Spinner) findViewById(R.id.route_direction_spinner); // Create an ArrayAdapter using the string array and a default spinner layout
    routeSpinner = (Spinner) findViewById(R.id.route_name_spinner); // Create an ArrayAdapter using the string array and a default spinner layout
    routeSpinner.setOnItemSelectedListener(this);
    ArrayAdapter<CharSequence> adapter = ArrayAdapter.createFromResource(this, R.array.routes_array, android.R.layout.simple_spinner_item);
    // Specify the layout to use when the list of choices appears
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item); // Apply the adapter to the spinner
    routeSpinner.setAdapter(adapter);
}
@Override
public void onItemSelected(AdapterView<?> parent, View view, 
        int pos, long id) {
    Log.i(TAG, "Item selected");
    //DecimalFormat df = new DecimalFormat("00##");
    int tempPos = pos;
    Log.i(TAG, ("Position of selected item: " + tempPos));
    int routeSelected;
    if (tempPos < 17)
        routeSelected = (tempPos + 1);
    else if (tempPos >= 17 && tempPos < 29)
        routeSelected = (tempPos + 2);
    else
        routeSelected = (tempPos + 3);
    String temp;
    if (routeSelected < 10)
        temp = ("0") + routeSelected;
    else
        temp = ("") + routeSelected;
    String url = "http://www.ltconline.ca/WebWatch/MobileAda.aspx?r=" + temp;
    new MyInnerClass().execute(url);

}

public void directionSpinner (String directions []) {
    int temp;
    for (int i = 1; i <=2; i++)
    {
        temp = Integer.parseInt(directions[i]);
        if (temp == 1)
            namedDirections[(i-1)] = "Eastbound";
        else if (temp == 2)
            namedDirections[(i-1)] = "Northbound";
        else if (temp == 3)
            namedDirections[(i-1)] = "Southbound";
        else if (temp == 4)
            namedDirections[(i-1)] = "Westbound";               
    }
    //setContentView(R.layout.activity_routes);

    dirSpinner.setOnItemSelectedListener(this);
    ArrayAdapter<CharSequence> adapter = new ArrayAdapter(this, android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    adapter.add(namedDirections[0]);
    adapter.add(namedDirections[1]);
    dirSpinner.setAdapter(adapter);
    Log.i(TAG, "spinner populated");
}

public void onNothingSelected(AdapterView<?> parent) {
    // Another interface callback
}

class MyInnerClass extends AsyncTask<String, Void, String> {
    String [] directions = new String [3];
    String [] directionNames = new String [3];
    private static final String TAG = "RoutesActivity";
       @Override
       protected void onPreExecute() {
       super.onPreExecute();

       }

       @Override
       protected void onPostExecute(String result) {
       super.onPostExecute(result);
       RoutesActivity.this.directionSpinner(directions);
       }

    @Override
    protected String doInBackground(String... params) {
        try{
            Pattern routeDirPattern = Pattern.compile("\\&d=(\\d{1,2})");
            Connection conn = Jsoup.connect(params[0]);
            Document doc = conn.get();
            int i = 0;
            Elements routeLinks = doc.select("a[href]");
            for (Element routeLink : routeLinks) {
                i = (i + 1);
                String name = routeLink.text();
                Attributes attrs = routeLink.attributes();
                String href = attrs.get("href");
                Matcher m = routeDirPattern.matcher(href);
                if (m.find()) {
                        String number = m.group(1);
                        directions [i] = number;
                        directionNames [i] = name;
                        Log.i(TAG, directionNames [i]);
                }
            }
            }catch(Exception e){Log.d("doinbackground exception", e.toString());}

               return ("Done");
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T21:05:20.207

我对两者都使用了相同的 onselected 侦听器，而没有使用 if 语句来检查哪个被点击了，所以它只是认为第一个被点击了。

这是更正后的代码：

```
@Override
public void onItemSelected(AdapterView<?> parent, View view, 
        int pos, long id) {
    Spinner spnr = (Spinner) parent;
    Log.i(TAG, "Item selected");
    switch(parent.getId()) {
    case R.id.route_name_spinner:
    //DecimalFormat df = new DecimalFormat("00##");
    int tempPos = pos;
    Log.i(TAG, ("Position of selected item: " + tempPos));
    int routeSelected;
    if (tempPos < 17)
        routeSelected = (tempPos + 1);
    else if (tempPos >= 17 && tempPos < 29)
        routeSelected = (tempPos + 2);
    else
        routeSelected = (tempPos + 3);
    String temp;
    if (routeSelected < 10)
        temp = ("0") + routeSelected;
    else
        temp = ("") + routeSelected;
    String url = "http://www.ltconline.ca/WebWatch/MobileAda.aspx?r=" + temp;
    new MyInnerClass().execute(url);
    case R.id.route_direction_spinner:

    }

} 
```

# java - JButtons AWT 控件 java

> ID：13895721
> 
> 赞同：1
> 
> 时间：2012-12-15T20:06:29.020
> 
> 标签：java, swing, awt, jbutton

我有两个基本问题。

*   我有一个带有 Java Swing 的 GUI 项目。当我将按钮放在框架上并双击它们时，我有 的代码`actionPerformed`，但它被阻止了。

    我怎样才能放一个按钮，然后在一个按钮上使用它`actionListener`？

*   我的项目是关于服务器客户端（多线程和套接字）

    我调用一种方法来接收一个我们可以在 JtextField 上写入的字符串，它会在 PrintWriter 和 getOutputStream 上停留一段时间。

    就像是：

* * *

```
do{
...
}while(thisstring!=null || thisstring!="exit") 
```

所以..当我写东西并按下按钮发送它时，它会停留在 cicle 和按钮块上。如何解锁按钮以编写其他内容？
**编辑：**
我了解 EDT 问题，但我无法解决。

我尝试使用 Timer 但没有成功，如下所示：

```
 int delay = 1000; //milliseconds
  ActionListener listener = new ActionListener() {
  public void actionPerformed(ActionEvent e) {
  //My action calling the Thread class with the while cicle that has the PrintWriter
       }

  };
new Timer(delay, listener).start(); 
```

当我按下按钮时，如何处理这个来做计时器？

每当一个用户在文本字段中输入内容时，我如何才能留在那个 cicle（阅读评论行）以通过 OutputStream 发送信息？我知道，例如对于控制台应用程序，我使用 BufferedReader，然后使用 ReadLine() 等待从控制台发送的任何内容，但使用 GUI 界面时，它会一直冻结。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:18:21.223

Java GUI 开发中有一个基本概念，即开发人员在哪个线程中实现用户交互处理，例如按钮单击。

简而言之，您需要在调用您的操作处理方法的线程之外执行您的处理。这个单线程称为事件调度线程 (EDT)，如果您的逻辑运行时间超过几毫秒，它将阻止 UI 继续绘制按钮释放等内容。

您需要将长时间运行的套接字代码移出 EDT。这样做将允许按钮释放并让用户与其他控件（甚至同一个按钮）进行交互。

为避免重复有关该主题的其他讨论，我将您引向[这个相当不错](https://stackoverflow.com/questions/5780936/java-eventqueue-why-should-everything-be-in-invokelater-method?rq=1)的讨论。此外，[本文](http://docs.oracle.com/javase/tutorial/uiswing/concurrency/index.html)简要概述了 Swing 中的线程概念。

问候，

斯科特

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-15T20:42:53.653

根据您的评论，您在那里有一些命名问题。你需要一个`ActionListener`像这样实现 -interface 的类：`class YourListenerClass implements ActionListener`，但你也可以通过一个匿名类来做到这一点，比如 new ActionListener { public void actionPerformed(ActionEvent e) { //your code for your button here } }); 当你设置你的`ActionListener`.
关键是您需要以正确的方式命名您的方法。它必须是 `public void actionPerformed(ActionEvent e)`并且你肯定必须实现`ActionListener`-interface。接下来是您必须在按钮中注册您的侦听器，例如：

```
yourButton.addActionListener(new YourListenerClass); 
```

或者像我之前向你展示的那样插入一个匿名类。

第二件事听起来像是我在评论中提到的多线程问题。我没有关注 scott 的链接，但根据他的描述，这可能是您想要阅读以解决任何进一步的阻塞问题的来源。
**编辑：** 嗯，起初我不想解释它，因为它是一大块代码，但由于问题仍然存在，我想`SwingWorker`在我的答案中添加一些关于 s 的内容。
如果您有长时间运行的代码，则使用 a 将无济于事，`Timer`因为它调用的代码也将在 EDT 上，因为它是由事件触发的。
取而代之的是，您可以使用 a`SwingWorker`来解决此问题。不过，这需要一些额外的代码。这是您可以遵循的简单方法：

```
public class WorkingHard{
  SwingWorker<String, String> worker;
  JButton yourButton = ...;
  ...
  //do some cool stuff, as register those listeners!
  ...

  public void actionPerformed(ActionEvent evt){
      if(evt.getSource().equals(yourButton);
      // Construct a new SwingWorker
      worker = new SwingWorker<String, Void>(){

    @Override
    protected String doInBackground(){
      //do your reading in this method, it will be executed in an own thread
      String readText = "i will be read".
      /*your reading algorithm, you could also call publish(...) to post your results,
      e.g. likewise), then you also have to override process(...). this process will be
      thread save, too*/
      readText += ... ;

      ...
      return readText;
    }

    @Override
    protected void done(){
      try {
        //do sth. with your result, now thread safe.
        someGuiElement.setText(get());
      } catch (InterruptedException e) {
        e.printStackTrace();
      } catch (ExecutionException e) {
        e.printStackTrace();
      }
    }
  };
  // Execute the SwingWorker; the GUI will not freeze
  worker.execute();
}

} 
```

如果您想了解更多关于这些工人的信息......有几个线程处理它，例如[这个](https://stackoverflow.com/questions/3159547/java-gui-threads-swingworker)。

# ruby - 如何确定猴子修补方法的文件/宝石？

> ID：13895725
> 
> 赞同：1
> 
> 时间：2012-12-15T20:07:03.583
> 
> 标签：ruby

我的依赖列表中有一个 Gem 是 Monkey Patching to_json on String。

我怎么知道这个猴子补丁发生在哪里？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-15T20:13:02.340

使用[`source_location`](http://www.ruby-doc.org/core-1.9.3/Method.html#method-i-source_location).

> 返回包含此方法的 Ruby 源文件名和行号，如果此方法未在 Ruby（即本机）中定义，则返回 nil

```
$ cat monkey.rb
class String
  def reverse
    ""
  end
end

p String.instance_method(:reverse).source_location
$ ruby monkey.rb
["monkey.rb", 2] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T21:25:00.357

```
puts String.instance_method(:to_json).source_location 
```

# mysql - 在mysql中用2行替换1行

> ID：13895726
> 
> 赞同：2
> 
> 时间：2012-12-15T20:07:20.413
> 
> 标签：mysql, sql

如何在 mysql.for 中用 5 行相同的数据替换一行。例如我有这个表

```
 id   |   companyId   |      name       |  open  |  close
 1    |    1          |    mon-fri      |  10:00 |  19:00  
 2    |    1          |      sat        |  10:00 |  12:00 
 3    |    1          |      sun        |  10:00 |  12:00 
 4    |    2          |    mon-fri      |  10:00 |  16:00  
 5    |    2          |      sat        |  10:00 |  13:00 
 6    |    2          |      sun        |  10:00 |  13:00 
```

我想将其 mon-fri 的名称字段转换为 mon 、 tues 、 wed 、 thur 、 fri 。

```
 id   |   companyId   |      name       |  open  |  close
 1    |    1          |    mon     |  10:00 |  19:00  
 2    |    1          |    tues    |  10:00 |  19:00 
 3    |    1          |    wed     |  10:00 |  19:00 
 4    |    1          |    thur    |  10:00 |  19:00   
 5    |    1          |    fri     |  10:00 |  19:00  
 6    |    1          |    sat     |  10:00 |  12:00 
 7    |    1          |    sun     |  10:00 |  12:00 
.
.
. 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:14:17.997

你不能通过 a 来做到这一点`UPDATE`，但你可以做的是一系列`INSERT INTO ... SELECT`使用一些字符串文字，然后是 a`DELETE`来删除你展开的行。

```
/* First insert a row for each mon,tue,wed,thur,fri */
/* Column values are copied from the existing mon-fri row, and use the literal strings 'mon', 'tue', etc as the new `name` */
INSERT INTO yourtable (`companyId`, `name`, `open`, `close`)
  SELECT `companyId`, 'mon', `open`, `close` FROM yourtable WHERE `name` = 'mon-fri'
INSERT INTO yourtable (`companyId`, `name`, `open`, `close`)
  SELECT `companyId`, 'tue', `open`, `close` FROM yourtable WHERE `name` = 'mon-fri'
INSERT INTO yourtable (`companyId`, `name`, `open`, `close`)
  SELECT `companyId`, 'wed', `open`, `close` FROM yourtable WHERE `name` = 'mon-fri'
INSERT INTO yourtable (`companyId`, `name`, `open`, `close`)
  SELECT `companyId`, 'thur', `open`, `close` FROM yourtable WHERE `name` = 'mon-fri'
INSERT INTO yourtable (`companyId`, `name`, `open`, `close`)
  SELECT `companyId`, 'fri', `open`, `close` FROM yourtable WHERE `name` = 'mon-fri'

/* Then delete the original mon-fri rows which you just expanded out */
DELETE FROM yourtable WHERE `name` = 'mon-fri' 
```

[http://sqlfiddle.com/#!2/cae33/1](http://sqlfiddle.com/#!2/cae33/1)

*（归功于：这个出色的建议是[Andriy M](https://stackoverflow.com/users/297408/andriy-m)在未经请求的编辑中的作品）*

您还可以通过使用虚拟表来减少语句的数量以及表扫描的数量，如下所示：

```
/* Cross-join the existing 'mon-fri' rows with a virtual table of day names
   of 'mon' through 'fri' and insert the resulting set back into your table */
INSERT INTO yourtable (`companyId`, `name`, `open`, `close`)
  SELECT t.`companyId`, v.`name`, t.`open`, t.`close`
  FROM yourtable t
  CROSS JOIN (
    SELECT 'mon' AS `name` UNION ALL
    SELECT 'tue' UNION ALL
    SELECT 'wed' UNION ALL
    SELECT 'thur' UNION ALL
    SELECT 'fri'
  ) v
  WHERE t.`name` = 'mon-fri';

/* Then delete the original mon-fri rows which you just expanded out */
DELETE FROM yourtable WHERE `name` = 'mon-fri'; 
```

[http://sqlfiddle.com/#!2/98e35/1](http://sqlfiddle.com/#!2/98e35/1)

### 评论后更新：

插入行时强制它们的顺序没有真正的价值，最好在`SELECT`.

要按天订购，`companyId`无论采用哪种方式，都需要做一些工作。您可以调用`LOWER(STR_TO_DATE())`并`%a`比较工作日值，但是您还需要更改您的`thur`to，`thu`因为这是 MySQL 的缩写方式。这会导致一堆函数调用。

相反，您可以使用 a`CASE....`来`ORDER BY`为每一天分配序数值，例如：

```
ORDER BY
 companyId,
 CASE `name`
   WHEN 'sun' THEN 1 
   WHEN 'mon' THEN 2
   WHEN 'tue' THEN 3
   WHEN 'wed' THEN 4
   WHEN 'thur' THEN 5
   WHEN 'fri' THEN 6
   WHEN 'sat' THEN 7
 ELSE 8 END 
```

### 不过，上述两种方法都不会对索引友好。

如果您需要提高性能，我建议您`'mon','tue','wed'`首先不要存储字符串等，而是存储它们关联的工作日值。详情请参阅[`DAYOFWEEK()`](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_dayofweek)。

# c - 空格键是字符吗？

> ID：13895729
> 
> 赞同：4
> 
> 时间：2012-12-15T20:07:40.413
> 
> 标签：c, arrays, string, char

考虑这行文本：

> 第一行文字。

如果使用字符数组`string`加载数组中的前 10 个字符，它将输出为：

```
First lin'\0' 
```

`First`包含 5 个字母，`lin`包含 3 个字母。其他两个字符在哪里使用？

算不算`\0`两个字符？

或者单词之间的空格是否被视为一个字符，因此 '\0` 是一个字符？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-15T20:09:58.157

是的，空间是一个字符。在 ASCII 编码中，它的代码编号为 32。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-15T20:10:26.487

两个字之间的空格有 ASCII 码 0x20（040 [8]或 32 [10]）；它占用一个字节。

字符串末尾的空值，ASCII 码 0x00（八进制和十进制均为 0）占用另一个字节。

请注意，空格键只是键盘上键入时生成空格字符的键。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-15T20:10:14.920

`'\0'`是[null-terminator](http://en.wikipedia.org/wiki/Null_character)，它实际上是所有实现中的零值。

`'\0'`被认为是单个字符，因为反斜杠`\`意味着[转义字符](http://en.wikipedia.org/wiki/Escape_character)。`'\0'`因此`'0'`都是单个字符，但含义非常不同。

请注意，空格由不同的[ascii 值](http://www.asciitable.com/)表示。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-08-10T21:35:53.950

空格在字符串中表示为“\s”，可能空格表示为“\s”作为字符

# javascript - Javascript“控制台”无限循环

> ID：13895734
> 
> 赞同：1
> 
> 时间：2012-12-15T20:08:03.780
> 
> 标签：javascript, infinite-loop, freeze

我正在尝试使用 javascript 程序，但遇到了障碍。该程序突然滞后于我的浏览器（可能是无限循环），不知道为什么。

```
function fullscreen() {
    if (document.body.requestFullScreen) {document.body.requestFullScreen();}
    else if (document.body.webkitRequestFullScreen) {document.body.webkitRequestFullScreen();}
    else if (document.body.mozRequestFullScreen) {document.body.mozRequestFullScreen();}
}

var bash = document.createElement('span');
bash.setAttribute('id', 'bash');
document.body.appendChild(bash);

var cursor = document.createElement('span');
cursor.setAttribute('id', 'bashCursor');
cursor.textContent = '_';
cursor.style.display = 'none';
cursor.style.fontWeight = 'bold';
document.body.appendChild(cursor);

window.Bash = {};
window.Bash.printing = false;
window.Bash.queue = Array();
window.Bash.span = bash;
window.Bash.span.cursor = cursor;

delete bash; delete bash;

function bashPrint() {
    window.Bash.writing = true;
    var bash = window.Bash.span
    var i;
    while (window.Bash.queue.length) {
        if (window.Bash.queue[0] == undefined) {
            i = 0;
            while (i < window.Bash.queue.length) {
                window.Bash.queue[i] = window.Bash.queue[i+1];
                console.log('l:'+window.Bash.queue.length);
                console.log(window.Bash.queue);
                delete window.Bash.queue[i+1];
                window.Bash.queue.splice(i,1);
                i++;
            }

        } else if (window.Bash.queue[0]['type'] == 'instant') {
            bash.textContent += window.Bash.queue[0]['value'];
            delete window.Bash.queue[0];
            window.Bash.queue.splice(0,1);

        } else if (window.Bash.queue[0]['type'] == 'wait') {
            setTimeout(bashPrintWaiting, window.Bash.queue[0]['wait']);
            break;

        } else if (window.Bash.queue[0]['type'] == 'cursor') {
            if (window.Bash.queue[0]['value']) {
                window.Bash.span.cursor.style.display = 'inline';
            } else {
                window.Bash.span.cursor.style.display = 'none';
            }
        }
    }
    window.Bash.writing = false;
}

function bashPrintWaiting() {
    window.Bash.writing = true;
    var bash = window.Bash.span;
    bash.textContent += window.Bash.queue[0]['value'];
    delete window.Bash.queue[0];
    window.Bash.queue.splice(0,1);
    window.Bash.writing = false;
    setTimeout(bashPrint, 0);
}

function bashWrite(string) {
    var array = Array();
    array['type'] = 'instant';
    array['value'] = string;
    window.Bash.queue[window.Bash.queue.length] = array
}

function bashPause(times, string) {
    if (!string) {string='';}
    while (times > 0) {
        var array = Array();
        array['type'] = 'wait';
        array['value'] = string;
        array['wait'] = 50 + Math.floor(Math.random()*450);
        window.Bash.queue[window.Bash.queue.length] = array;
        times--;
    }
}

function bashCursor(enabled) {
    var array = Array();
    array['type'] = 'cursor';
    array['value'] = enabled;
    window.Bash.queue[window.Bash.queue.length] = array;
}

bashWrite('Uncompressing');
bashPause(12, '.');
bashWrite('OK\n');

bashPause(3);
bashWrite('Build v. 0.1.01-release (x86_64-pc)\n');

bashPause(2);
bashWrite('Connecting');
bashPause(35, '.');
bashWrite('Error, unknown user. See connect.log for futher information.\n');

bashPause(2);
bashWrite('none@m ~ $ >>');
bashCursor(true);

bashPrint(); 
```

我把它上传到 jsFiddle - [http://jsfiddle.net/uQcCP/](http://jsfiddle.net/uQcCP/)

程序在以下之间冻结：

```
bashWrite('Error, unknown user. See connect.log for futher information.\n'); 
```

和

```
bashPause(2); 
```

拜托，你能帮帮我吗？非常感谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:14:23.950

无限循环从第 51 行开始：`while (window.Bash.queue.length) {`

然后它在第 74 行的 if 语句中结束，并且在此队列中永远不会缩短：

```
else if (window.Bash.queue[0]['type'] == 'cursor') {
   if (window.Bash.queue[0]['value']) {
      window.Bash.span.cursor.style.display = 'inline'; 
```

如果您发现自己在 Chrome 中遇到无限循环问题，请在打开页面之前打开您的开发工具并转到脚本选项卡。打开页面并开始循环后，您可以单击暂停按钮在代码当前执行的任何位置抛出断点。从那里可以更容易地确定您在哪里得到错误。

# c# - 非虚拟方法解析 - 为什么会发生这种情况

> ID：13895737
> 
> 赞同：2
> 
> 时间：2012-12-15T20:08:41.523
> 
> 标签：c#, polymorphism, overload-resolution

我对如何解析非虚拟方法的理解（在 C# 中）是它取决于变量的类型（而不是实例的类型）。

看看下面的代码。

```
class Program
{
    static void Main(string[] args)
    {
        Sedan vehicle = new Sedan();
        vehicle.Drive();
        vehicle.Accelerate();
    }
}

abstract class VehicleBase
{
    public void Drive()
    {
        ShiftIntoGear();
        Accelerate();
        Steer();
    }

    protected abstract void ShiftIntoGear();
    protected abstract void Steer();

    public void Accelerate()
    {
        Console.WriteLine("VehicleBase.Accelerate");
    }
}

class Sedan : VehicleBase
{
    protected override void ShiftIntoGear()
    {
        Console.WriteLine("Sedan.ShiftIntoGear");
    }

    protected override void Steer()
    {
        Console.WriteLine("Sedan.Steer");
    }

    public new void Accelerate()
    {
        Console.WriteLine("Sedan.Accelerate");
    }
} 
```

控制台窗口显示以下内容：

```
Sedan.ShiftIntoGear
VehicleBase.Accelerate
Sedan.Steer
Sedan.Accelerate 
```

这对我来说没有意义，我相信会让很多人陷入困境。如果您现在将变量车辆声明为 VehicleBase 类型，您将得到

```
Sedan.ShiftIntoGear
VehicleBase.Accelerate
Sedan.Steer
VehicleBase.Accelerate 
```

这也是我在前一种情况下所期望的，因为方法 Accelerate 是非虚拟的。

在前面的输出中，（变量车辆类型为 Sedan，我希望调用 Sedan.Accelerate 而不是 VehicleBase.Accelerate。就目前而言，取决于您从哪里调用它（从类中或从外部）行为正在改变。

在我看来，重新引入方法的重载解决规则优先，但我很难相信这是正确/预期的行为。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:14:57.943

所有这些都非常有意义 - 当您将车辆声明为`Sedan`时，两个调用`Accelerate`的解析方式不同：

*   当`Accelerate`从`Drive`方法中调用到时，它不知道 中有一个`new`方法`Sedan`，所以它调用了基的相应方法
*   当`Accelerate`从`Main`方法调用 to 时，编译器知道您正在调用该`new`方法，因为它知道`vehicle`变量的确切类型是`Sedan`.

另一方面，当`Accelerate`从`Main`方法调用 to ，但变量声明为`VehicleBase`时，编译器不能假定类型为`Sedan`，因此它`Accelerate`再次将 解析为基类的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T18:28:07.917

非虚方法在编译时根据表达式的类型进行解析，调用目的地在编译时是固定的。编译器在调用的源代码上下文中的编译时可用的符号信息中查找方法名称，并发出调用指令来调用它能够找到的非虚拟方法。实例的实际类型是什么并不重要，调用总是转到在编译时从静态类型信息中找出的非虚拟方法。

这就是为什么在Main 的上下文中调用 to `Accelerate`，但在 的上下文中调用：`Sedan.Accelerate``VehicleBase.Accelerate``VehicleBase.Drive`

在你的`Main`函数体中，你已经声明了一个 type 的变量`Sedan`，并且你使用这个变量来调用方法。编译器在用于进行调用的变量类型中查找名为“Accelerate”的方法，键入 Sedan，然后找到`Sedan.Accelerate`.

在方法内部，“self”`VehicleBase.Drive`的**编译时**类型是`VehicleBase`. 这是编译器可以在此源代码上下文中看到的唯一类型，因此在“VehicleBase.Drive”中对 Accelerate 的调用将始终转到`VehicleBase.Accelerate`，即使运行时对象实例的类型实际上是`Sedan`。

在`Sedan`类型中声明的方法的主体中，编译器将通过首先查看该类型的方法来解析非虚拟方法调用，然后如果没有找到匹配项`Sedan`，则查看该类型。`VehicleBase``Sedan`

如果要根据实际对象实例类型改变调用目的地，则必须使用虚方法。使用虚拟方法也将提供更加一致的执行结果，因为调用将始终转到由对象实例在运行时确定的最具体的实现。

非虚拟方法调用目的地是根据编译时类型选择的，不知道运行时。在运行时根据实例类型选择虚拟方法调用目的地。

# scala - 在 Play 2.0 中无法理解 Iteratee.fold

> ID：13895738
> 
> 赞同：3
> 
> 时间：2012-12-15T20:08:45.033
> 
> 标签：scala, playframework-2.0, iterate

我正在阅读 Iteratee.scala 的源代码：[https://github.com/playframework/Play20/blob/master/framework/src/iteratees/src/main/scala/play/api/libs/iteratee/Iteratee。斯卡拉](https://github.com/playframework/Play20/blob/master/framework/src/iteratees/src/main/scala/play/api/libs/iteratee/Iteratee.scala)

特别是构造“折叠”迭代的便捷方法。

```
def fold[E, A](state: A)(f: (A, E) => A): Iteratee[E, A] = {
  def step(s: A)(i: Input[E]): Iteratee[E, A] = i match {

    case Input.EOF => Done(s, Input.EOF)
    case Input.Empty => Cont[E, A](i => step(s)(i))
    case Input.El(e) => { val s1 = f(s, e); Cont[E, A](i => step(s1)(i)) }
  }
  (Cont[E, A](i => step(state)(i)))
} 
```

在每个 case 语句中，我们都调用了**Done**或**Cont**构造函数。但是这些构造函数是在哪里定义的呢？我推断这些必须是**Iteratee**特征的实现者，但我无法通过为“扩展 Iteratee”执行 ctrl+F 来找到它们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:32:07.103

请参阅[文档](http://www.playframework.org/documentation/api/2.0/scala/play/api/libs/iteratee/Done$.html)或[来源](https://github.com/playframework/Play20/blob/master/framework/src/iteratees/src/main/scala/play/api/libs/iteratee/Iteratee.scala)：

```
object Done {
/**
* Create an [[play.api.libs.iteratee.Iteratee]] in the “done” state.
* @param a Result
* @param e Remaining unused input
*/
  def apply[E, A](a: A, e: Input[E] = Input.Empty): Iteratee[E, A] = new Iteratee[E, A] {
    def fold[B](folder: Step[E, A] => Future[B]): Future[B] = folder(Step.Done(a, e))
  }
} 
```

它不是构造函数。`Done(s, Input.EOF)` [意味着](https://stackoverflow.com/a/9738862/406435) `Done.apply(s, Input.EOF)`。与 相同`Cont`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-15T20:30:12.320

`Done`不需要直接扩展`Iteratee`。它可以扩展另一个类或特征，然后扩展`Iteratee`。您可以从那里搜索`class Cont`并遵循继承关系。

# objective-c - 仅下载 Cocoa 中的 HTTP 标头

> ID：13895740
> 
> 赞同：0
> 
> 时间：2012-12-15T20:08:52.693
> 
> 标签：objective-c, cocoa

我正在尝试移植我的一个 Android 应用程序以在 Mac OS X 上本地工作。

对于应用程序的初始化，它需要连接到服务器并仅读取服务器响应的标头。服务器（第 3 方服务器）将响应 82274 字节的数据，但对我来说唯一有用的数据是标题；具体来说，我*只*需要读取会话 cookie 并检索它的值。这意味着所有其他数据都是冗余的。

通过谷歌搜索，唯一有效的响应如下：

```
// Create the request.
    NSMutableURLRequest *theRequest = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@"http://www.grooveshark.com/"]];
    [theRequest setHTTPMethod:@"HEAD"];
    [theRequest setValue:@"MySpecialUserAgent/1.0" forHTTPHeaderField:@"User-Agent"];
    [theRequest setTimeoutInterval:15.0];
    [theRequest setCachePolicy:NSURLRequestReloadIgnoringCacheData]; 
```

但是，这仍然会下载整个页面。

谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:35:24.833

让我们看看如果我们点击那个 URL 会发生什么。

```
› curl -v -X HEAD http://www.grooveshark.com
* About to connect() to www.grooveshark.com port 80 (#0)
*   Trying 8.20.213.76...
* connected
* Connected to www.grooveshark.com (8.20.213.76) port 80 (#0)
> HEAD / HTTP/1.1
> User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
> Host: www.grooveshark.com
> Accept: */*
> 
< HTTP/1.1 301 Moved Permanently
< Server: richhickey
< Date: Sat, 15 Dec 2012 20:27:38 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: close
< Location: http://grooveshark.com
< Vary: Accept-Encoding
< X-Hostname: rhl081
< X-Hostname: rhl081
< 
* Closing connection #0 
```

所以`www.grooveshark.com`重定向到`grooveshark.com`. 让我们看看该页面`HEAD`是否正确处理请求。

```
› curl -v -X HEAD http://grooveshark.com    
* About to connect() to grooveshark.com port 80 (#0)
*   Trying 8.20.213.76...
* connected
* Connected to grooveshark.com (8.20.213.76) port 80 (#0)
> HEAD / HTTP/1.1
> User-Agent: curl/7.24.0 (x86_64-apple-darwin12.0) libcurl/7.24.0 OpenSSL/0.9.8r zlib/1.2.5
> Host: grooveshark.com
> Accept: */*
> 
< HTTP/1.1 200 OK
< Server: richhickey
< Date: Sat, 15 Dec 2012 20:28:06 GMT
< Content-Type: text/html; charset=UTF-8
< Connection: close
< Vary: Accept-Encoding
< Set-Cookie: PHPSESSID=844a5e6bdd6d84a97afd8f42faf4eb95; expires=Sat, 22-Dec-2012 20:28:06 GMT; path=/; domain=.grooveshark.com
< Expires: Thu, 19 Nov 1981 08:52:00 GMT
< Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
< Pragma: no-cache
< Vary: Accept-Encoding
< X-Hostname: rhl061
< Set-Cookie: ismobile=no;domain=.grooveshark.com;path=/
< X-country: US
< 
* Closing connection #0 
```

这看起来不错。我怀疑您的请求在遵循该重定向时会退回到 GET。看起来 Chris Suter 遇到了同样的事情并给出了一个示例解决方案：[http ://sutes.co.uk/2009/12/nsurlconnection-using-head-met.html](http://sutes.co.uk/2009/12/nsurlconnection-using-head-met.html)

将来您可能想尝试通过本地代理运行您的请求，以便您可以看到它们正在运行。这可能会表明您发出`HEAD`请求 to`www.grooveshark.com`后跟 a `GET`to `grooveshark.com`。

# c# - C# 赋予控件数组属性

> ID：13895748
> 
> 赞同：1
> 
> 时间：2012-12-15T20:09:57.997
> 
> 标签：c#, arrays, properties, error-handling, controls

我的项目需要一些控制数组，但我的代码正在生成错误。

这是我如何提供正常的控件属性（此代码工作正常）

```
TextBox stamText = new TextBox()  
{ 
    Location = new Point(15, 50), 
    Text = "55", 
    Width = 30, 
    Height = 30
}; 
```

这是我尝试执行相同操作但针对一组控件的代码

```
TextBox[] stamText = new TextBox[8]  
{ 
    Location = new Point(15, 50), 
    Text = "55", 
    Width = 30, 
    Height = 30 
}; 
```

{} 中的每个属性都说“;”后出现错误 是期待。

有谁知道如何解决这个问题（给控制数组属性）？

* *** *扩展

好的，所以我的程序是一种在我们桌面角色扮演时跟踪玩家统计数据的表格。

所以假设我和比尔、吉姆和我在一个房间里

我单击表单上的“添加播放器”按钮，它添加了一个播放器以及一堆与该播放器有关的控件

```
*AddPlayer Button clicked*
Addplayer()

Public void AddPlayer()
{
*Add a bunch of controls*
 checkbox(i)
 textbox(i)
}
i += 1 
```

现在每个人都打了10。所以我去改变每个人的耐力-10

```
if for i = 0 to players added 
   if checkbox(i) = checked then textbox(i).text = (text - 10) 
```

所以我需要它们成为数组，这样我就可以通过 for 循环一次更改多个人的统计数据。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:12:08.843

您似乎对对象和集合初始化程序感到困惑。您在第一种情况下使用的对象初始化器的工作方式如下：

> 对象初始化器允许您在创建时将值分配给对象的任何可访问字段或属性，而无需显式调用构造函数。

```
class Cat
{
    // Auto-implemented properties. 
    public int Age { get; set; }
    public string Name { get; set; }
}

Cat cat = new Cat { Age = 10, Name = "Fluffy" }; 
```

您在第二种情况下使用的集合初始化程序的工作方式如下：

> 集合初始值设定项允许您在初始化实现 IEnumerable 的集合类时指定一个或多个元素初始值设定项。元素初始值设定项可以是简单值、表达式或对象初始值设定项。通过使用集合初始化器，您不必在源代码中指定对类的 Add 方法的多次调用；编译器添加调用。

```
List<int> digits = new List<int> { 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }; 
```

在您抛出错误的示例中，您正在使用集合初始化器创建一个包含 8 个文本框的数组，但您正在传递对象初始化器。您收到有关错误的原因`;`是因为`;`用于分隔要添加到集合中的对象。编译器希望看到 8 个文本框被添加到集合中，每个文本框由`;`. 这是解决此问题的一种方法：

```
TextBox[] stamText = new TextBox[8]  
{ 
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 },
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 },
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 },
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 },
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 },
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 },
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 },
    new TextBox() { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 } 
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:27:27.990

正如 Ian 所说，您需要在初始化为非默认值时指定每个元素。您正在做的是，您正在尝试初始化数组的“位置、文本、宽度和高度”属性`TextBox`，但数组没有这些属性，`TextBox`确实如此。如果要“初始化*”具有非默认值的数组，最好的方法是使用 for 循环，如下所示：

```
const int numOfElements = 8;
TextBox[] textBoxArray = new TextBox[numOfElements];

for (int i = 0; i < numOfElements; i++)
{
    textBoxArray[i] = new TextBox()  { Location = new Point(15, 50), Text = "55", Width = 30, Height = 30 };
} 
```

* *：这并不是真正的初始化，因为您的数组在声明时已经使用默认值初始化。我猜这更像是“人口”。*

# javascript - 如何获取复选框树视图检查值

> ID：13895755
> 
> 赞同：0
> 
> 时间：2012-12-15T20:10:40.170
> 
> 标签：javascript, jquery, asp.net

我在按钮单击时使用 Jquery 弹出窗口......并在弹出主体中制作 asp 树硬代码......

**代码：**

```
<div class="container">

    <div class="headerpopup">

        <asp:Label ID="lblPopupHeader" runat="server" CssClass="msg" Text="Select Fields" />

        <asp:LinkButton ID="lbtnHideModal" runat="server" CssClass="close" 

                        OnClientClick="$('#divSimplePopup').hideModal(); return false;" />

    </div>

    <div class="bodyAnd">

        <div class="body" style="height: 250px; overflow: auto;">

        <asp:TreeView ID="someTree" runat="server" ShowCheckBoxes="All"  >
<Nodes>
    <asp:TreeNode Text="Root"> 
        <asp:TreeNode Text="Leaf" />
        <asp:TreeNode Text="Branch">
            <asp:TreeNode Text="Leaf" />
            <asp:TreeNode Text="Leaf" />
        </asp:TreeNode>
    </asp:TreeNode>
    <asp:TreeNode Text="Root">
        <asp:TreeNode Text="Leaf" />
        <asp:TreeNode Text="Leaf" />
        <asp:TreeNode Text="Leaf" />
        <asp:TreeNode Text="Leaf" />
    </asp:TreeNode>
</Nodes> 
```

```
 <div class="foot">
        <div class="footerpopup">

            <asp:Button ID="btnOK" runat="server" Text="OK" Width="40px" CssClass="add-but" OnClientClick="treeClick();"  />

            <asp:Button ID="btnCncl" runat="server" Text="Cancel" CssClass="add-but"

                        OnClientClick="$('#divSimplePopup').hideModal(); return false;" />

        </div>
     </div>

</div> 
```

我想要代码隐藏和服务器端的复选框值....知道我是如何在确定按钮上获得复选框值的吗？？？

# jsf - 具有固定位数的 PrimeFaces 微调器

> ID：13895756
> 
> 赞同：2
> 
> 时间：2012-12-15T20:10:47.780
> 
> 标签：jsf, primefaces, facelets

我无法很好地显示`p:spinner`具有固定位数的数字：

```
<p:spinner value="#{myBean.myValue}" stepFactor="0.1"> 
```

作为一个双`myValue`。在第三次向上单击时，显示的数字是 0.30000000000000004 而不是 0.3。我知道这是正常的浮点行为，但我找不到很好地显示数字的方法。

我尝试使用`BigDecimal`初始化为“0.0”而不是双精度。相同的行为。

最后我尝试了一个默认转换器，假设情况太简单以至于需要一个自定义的转换器：

```
<p:spinner value="#{myBean.myValue}" stepFactor="0.1" >
    <f:convertNumber maxFractionDigits="1" />
</p:spinner> 
```

具有相同的效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-12T09:13:31.270

这是 PrimeFaces 中的一个错误（特别是在其客户端 Javasript 中）。它被记录为[问题 4535](https://code.google.com/p/primefaces/issues/detail?id=4535)并在版本 3.5.2 和 4.0 中修复。

# python - 在 linux (pySide) 上为特定版本安装 python 模块

> ID：13895763
> 
> 赞同：0
> 
> 时间：2012-12-15T20:11:32.157
> 
> 标签：python, linux, ubuntu, python-3.x, pyside

所以，为了保持简单。Ubuntu 12.10 预安装了 python 3.2，它链接到“python3”。我下载了python 3.3，它的命令是“python3.3”。但是，我从 synaptic 下载了 python3 的 pySide。在 python3.3 上使用“from PySide.QtCore import *”失败。但是，当我只运行“python3”（又名 3.2）时，一切正常。Synaptic 刚刚为 python3.2 安装了 lib，这是 ubuntu 中 python3 的默认设置。如何强制突触为 python3.3 安装模块？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:14:57.520

[尝试使用virtualenv](http://pypi.python.org/pypi/virtualenv)在虚拟环境中工作。这将使您的 python 版本/包彼此分开，以防出现问题。使用 pip 安装 PySide。

编辑：

一个可能的解决方案是：

```
~$ sudo easy_install pip 
```

要安装 virtualenv，

```
~$ sudo pip install virtualenv 
```

[PyPi](http://pypi.python.org/pypi/PySide)上的 PySide页面有针对不同平台的指南，介绍如何使用 virtualenv 安装 pyqt。祝你好运。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:24:02.463

我认为你应该从它的源文件中安装 pyside，`setup.py`然后运行命令`python3.3 setup.py build`，`sudo python3.3 setup.py install`因为如果你通过 apt 安装，它将使用你提到的默认解释器 3.2。

# sql - Oracle SQL 从查询结果中排除行

> ID：13895764
> 
> 赞同：1
> 
> 时间：2012-12-15T20:11:33.180
> 
> 标签：sql, oracle

我在 Oracle SQL 中有两个表：

项目（**PID**，Pname，预算，*DID*）

部门（**DID**，Dname）

**粗体**= 主键

*斜体*= 外键

我想列出项目比部门营销多的部门。

这是我的代码：

```
select dname as "Division"
from division d, project p
where d.did = p.did
group by dname
having count(pid) >= all
(select count(p.pid)
from project p, division d
where p.did = d.did and d.dname = 'marketing') 
```

我返回了正确的记录，但也返回了营销记录。如何从结果中排除营销记录？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T22:55:34.783

为什么不通过添加以下内容从初始 SQL 中排除营销记录：

```
and d.dname != 'marketing' 
```

到第`where`一句。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T21:23:27.897

您可能会使用公用表表达式（WITH 子句）来按部门聚合计数来提高效率，然后您可以查询它...

```
with cte as (
  select   dname,
           count(*) projects
  from     project p,
           division d
  where    p.did = d.did
  group by dname)
select dname,
       projects
from   cte
where  projects > (select projects
                  from   cte
                  where  dname = 'Marketing) 
```

# c# - WindowsFormsApplication C# 发生了奇怪的事情

> ID：13895766
> 
> 赞同：1
> 
> 时间：2012-12-15T20:11:43.820
> 
> 标签：c#, winforms

我做了一个简单的 WindowsFormsApplication 但我遇到了一些困难。在表单中，我有 10 个文本框和一个按钮。该程序的目的是在我单击按钮时在每个框中生成不同的数字。这是代码的一部分：

```
private void button1_Click(object sender, EventArgs e)
    {
        int p = 0;
        int[] array = GeneratingArray();

        foreach (Control c in tableLayoutPanel1.Controls)
        {
            if (c.GetType().ToString() == "System.Windows.Forms.TextBox")
            {
                c.Text = array[p].ToString();
                p++;
            }
        }
    }

    public int GeneratingInt()
    {
        int random;
        Contract.Ensures(Contract.Result<int>() > -11, "Array out of Bounds(-10 ; 10)");
        Contract.Ensures(Contract.Result<int>() < 11, "Array out of Bounds(-10 ; 10)");
        Random gnr = new Random();
        random = gnr.Next(20);
        return random;
    }

    public int[] GeneratingArray()
    {
        int[] array = new int[10];
        int random;
        for (int i = 0; i < 10; i++)
        {
            random = GeneratingInt();
            array[i] = random;
        }

        return array;
    } 
```

问题是当我使用调试器时一切正常，但是当我在所有框中启动应用程序时生成相同的数字。我找不到导致这种问题的原因，所以我问你。谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T20:14:11.420

问题是您的应用程序运行得很快。

`Random`通过为每次调用创建一个新实例`GeneratingInt`，您将使用当前时间播种随机数。在紧密循环中运行时，这会导致随机生成器每次都提供相同的数字。

将您移动`Random`到类级别变量，构造一次，然后*重用相同的实例*。这将导致它按照您希望的方式运行。

# php - 检测是否设置了某些数据库表行？

> ID：13895773
> 
> 赞同：-1
> 
> 时间：2012-12-15T20:12:35.407
> 
> 标签：php, jquery

您好我想创建一个脚本来检测 mysql 表中的某些行是否不再为空。

我想我需要每 5 秒运行一次 php 脚本来检查某些表行。如果其中任何一个为空，则应继续更新。如果不是，它应该重定向到另一个显示更新/填充表的 php 页面。

关于如何做到这一点的任何想法？

这有点像“谁想成为百万富翁”的游戏，其中 x 个人得到了他们需要回答的相同问题。回答他们会将他们的答案存储在某些表格行中。当这些行不为空时，主页需要显示所有答案以及他们花了多长时间回答这些问题。

我只需要每 5 秒更新一次返回“true”或“false”的脚本（如果任何行为空）。

干杯，

麦兹

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:20:45.170

每 5 秒轮询一次表听起来非常错误。

您应该重新考虑如何对外部事件做出反应的工作流程。

如果您有能力将数据库更改为 PostgreSQL，那么它可以很好地解决这个问题。即，您在感兴趣的表上创建触发器，并在该触发器内使用`NOTIFY`.

另一个想要对表更改做出反应的连接将用于注册通知，然后简单地使用连接句柄`LISTEN`进入睡眠状态。`select()`然后，一旦触发触发，此连接将立即接收此事件并立即对其做出反应。

这种方法允许在服务器和客户端上准确地使用 0 CPU 时间，并立即对更改做出反应。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:23:02.593

一种方法：

当玩家回答问题时设置一个 JavaScript 计时器（例如，显示“等待其他玩家回答”消息）并每 5 秒触发对 php 脚本（比如说 waiting.php）的异步查询。如果 waiting.php 返回 0，则没有任何反应。在 waiting.php 返回 1 时，播放器被重定向到页面上，女巫将显示所有答案和时间

在 waiting.php 中，写下类似的内容：

```
echo (current(mysql_fetch_row(mysqli_query('SELECT count(*) from responses WHERE questionId = '.$_GET['QuestionId'].' AND answer_field IS NULL'))) > 0 ? '0' : '1'); 
```

# ubuntu - 终端日志文件

> ID：13895774
> 
> 赞同：2
> 
> 时间：2012-12-15T20:12:47.343
> 
> 标签：ubuntu, ubuntu-12.04

它是否存在日志文件，其中系统存储 Ubuntu 12.04 终端中键入命令的历史记录？它位于哪里？有人可以分享一个链接，我可以在其中找到有关它的一些信息吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-15T20:19:34.183

如果您使用的是 bash：`~/.bash_history`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T23:41:15.640

您可以使用该`history`命令，然后使用 grep 进行搜索。IE`history | grep ls`

# python - 预签名 URL 和 x-amz-acl

> ID：13895775
> 
> 赞同：9
> 
> 时间：2012-12-15T20:12:49.783
> 
> 标签：python, amazon-web-services, amazon-s3, boto

我想创建一个所谓的“预签名”URL，用于将特定对象 (PUT) 上传到 Amazon S3 存储桶。

到现在为止还挺好。我正在使用 python 库[boto](http://boto.cloudhackers.com/en/latest/ref/s3.html#boto.s3.key.Key.generate_url)创建一个 URL，其中包含所有必要的内容（过期、签名等）。URL 如下所示：

> `https://<bucketname>.s3.amazonaws.com/<key>?Signature=<sig>&Expires=<expires>&AWSAccessKeyId=<my key id>&x-amz-acl=public-read`

注意最后一个参数。

至少，据我了解，这限制了使用此 URL 的人将对象上传到特定存储桶中的特定键，并且还将在对象上设置的罐装 ACL 限制为“公开读取”。

我的最后一个陈述是完全不正确的。

事实证明，如果您使用此 URL，则可以使用 x-amz-acl**标头**执行以下操作（与具有相同名称的**查询字符串参数**相反，您*必须*设置该参数才能使签名检查成功）：

1.  将其设置为“公开阅读”。对象的权限将包含两个条目：“所有人”的“读取”和存储桶所有者的“完全控制”。这在意料之中。
2.  省略 x-amz-acl 标头。对象的权限将与每个存储桶的默认权限相同（存储桶所有者拥有完全控制权）。为什么？
3.  将其设置为“公共读写”。结果与（1）中的完全一样。
4.  将其设置为“经过身份验证的读取”。“经过身份验证的用户”获得“读取”权限，存储桶拥有者拥有完全控制权。
5.  将其设置为“bucket-owner-read”。结果与（2）中的完全一样。存储桶所有者拥有完全控制权，没有定义其他权限。
6.  将其设置为“bucket-owner-full-control”。不出所料，存储桶所有者将拥有完全控制权。
7.  将其设置为不存在的固定 ACL 名称并得到错误。

这样看来，

1.  x-amz-acl *header*不参与签名检查，因为可以随意更改，请求成功。但是，在签名检查期间肯定*会*考虑查询字符串参数。
2.  x-amz-acl*查询字符串参数*不会*直接*影响对象的权限，因为它自己什么也不做。
3.  如果您发送 x-amz-acl 标头，则生成的权限永远不会
    *   对存储桶所有者的限制比默认情况下更严格。
    *   对非存储桶所有者的限制较少。
4.  但是，它们可以对非存储桶所有者*更具限制性。*也就是说，如果您`x-amz-acl=public-read`在查询字符串中指定，您可以将`x-amz-acl`标头设置`authenticated-read`为公共可读对象，而不是获取一个对象，该对象只能由经过身份验证的用户读取。

*x-amz-acl QS 参数和标题之间的真正*关系是什么，同名？有没有办法限制对象的权限，即通过`PUT`请求上传到所谓的“预签名”URL？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-19T13:41:22.130

据我了解（我在这里可能错了），标头`x-amz-acl`优先于查询字符串参数 - 它们确实具有相同的目的。在签名检查期间仅考虑查询字符串参数的原因仅仅是因为标头不是策略签名检查的一部分。

[此页面](http://s3.amazonaws.com/doc/s3-example-code/post/post_sample.html)可能会对您有所帮助；它在创建表单以直接上传到 S3 时帮助了我很多。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-27T23:12:01.073

您似乎为 acl 参数使用了错误的名称。根据他们关于签名请求的指南，尝试使用 acl：

[签署和认证 REST 请求](http://docs.amazonwebservices.com/AmazonS3/latest/dev/RESTAuthentication.html)

> 如果请求涉及子资源，例如 ?versioning、?location、?acl、?torrent、?lifecycle 或 ?versionid，则附加子资源，如果有则其值和问号。请注意，如果有多个子资源，则子资源必须按子资源名称按字典顺序排序，并用“&”分隔。例如 ?acl&versionId=value。
> 
> 构建 CanonicalizedResource 元素时必须包含的子资源列表有：acl、生命周期、位置、日志记录、通知、partNumber、策略、requestPayment、torrent、uploadId、uploads、versionId、versioning、versions 和 website。

# cordova - 插件在 Phonegap 中不起作用

> ID：13895776
> 
> 赞同：0
> 
> 时间：2012-12-15T20:12:50.540
> 
> 标签：cordova, phonegap-plugins

我正在使用 Cordova 2.1.0 开发一个 Android 插件。

## 插件代码如下

```
package org.apache.cordova.example;
import org.apache.cordova.api.Plugin;
import org.apache.cordova.api.PluginResult;
import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

public class MyTestPlugin extends Plugin {
  /**
  * Executes the request and returns PluginResult.
  *
  * @param action        The action to execute.
  * @param args          JSONArry of arguments for the plugin.
  * @param callbackId    The callback id used when calling back into JavaScript.
  * @return              A PluginResult object with a status and message.
  */
  public PluginResult execute(String action, JSONArray args, String callbackId) {
    try {
      if (action.equals("echo")) {
        String echo = args.getString(0);
        if (echo != null && echo.length() > 0) {
          return new PluginResult(PluginResult.Status.OK, echo);
        } else {
          return new PluginResult(PluginResult.Status.ERROR);
        }
      } else {
        return new PluginResult(PluginResult.Status.INVALID_ACTION);
      }
    } catch (JSONException e) {
      return new PluginResult(PluginResult.Status.JSON_EXCEPTION);
    }
  }
} 
```

* * *

## HTML/JS 代码

```
<script type="text/javascript" src="cordova-2.1.0.js"></script>
<script type="text/javascript">
  window.echo = function(str, callback) {
    alert('Started');
    cordova.exec(callback, callback, "MyTestPlugin", "echo", [str]);
    alert('The END');
  };
  window.onload = function () {
    alert('1st Step');
    window.echo("echo", function(echoValue) {
      alert(echoValue == "echo"); // should alert true.
    });
    alert('SecondStep');
  };
</script>
</html> 
```

* * *

## 配置文件

但我无法调用插件。有人可以帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T21:27:41.467

`deviceredy`在事件触发之前无法调用插件。

`window.onload`可能而且很可能*会*在之前发生`deviceready`。

[http://docs.phonegap.com/en/2.2.0/cordova_events_events.md.html#deviceready](http://docs.phonegap.com/en/2.2.0/cordova_events_events.md.html#deviceready)

# c - 做一会儿开关

> ID：13895780
> 
> 赞同：0
> 
> 时间：2012-12-15T20:13:21.430
> 
> 标签：c, while-loop, switch-statement

我想做一个乘法表，用户选择数字，然后显示表。但是在我的代码中，虽然在开关内部不起作用，为什么？前任：

```
#include<stdio.h>

int main(){

int x,y=10;

printf("Welcome!\n");
printf("choose a number for multiplication table \n");
scanf("%i",&x);

switch(x){

    case '1':
        while(y)
        {

            printf(" %i * %i  = %i \n",x,y,x*y);
            y--;

        }
    };break;    
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:15:28.003

你有一个额外的}

```
case '1':
    while(y)
    {

        printf(" %i * %i  = %i \n",x,y,x*y);
        y--;

    }
};break; // This break is outside of your switch 
```

此外，您打开的字符值是 1，而不是整数值 1。您也应该将 更改`case`为匹配。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:15:04.673

`'1'`不是`int`值`1`（而是字符文字`'1'`并且具有`int`值`49`）所以我怀疑它没有在开关中输入这种情况。将 case 标签更改为整数文字`1`：

```
case 1: 
```

检查 的返回值`scanf()`以确保`int`已读取并且后续代码未处理未`x`初始化：

```
if (1 == scanf("%i", &x))
{
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T22:54:44.177

尽管有一个额外的大括号，但将输入值与 switch 语句中的选项进行比较的方式存在问题。在以下行中：

```
scanf("%i",&x); 
```

编译器被告知程序在这里需要一个整数值，所以当用户在标准输入上输入 1 时，0x01 存储在 x 变量中。不幸的是，这里：

```
case '1': 
```

x 变量与等于 0x31 的“1”（ASCII 字符）进行比较。因此，您的案例陈述应如下所示：

```
case 1: 
```

当然，您可以在 case 语句中使用 ASCII 字符。您可以修改程序以将输入视为 char 数据类型：

```
scanf("%c",&x); 
```

然后，0x31 存储在 x 变量中，并将其与“1”进行比较是有意义的。但是，您必须记住将 x 转换为 int 值，以免破坏程序的功能：

```
x -= 0x30; 
```

第一种方法肯定更方便。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-15T20:17:59.650

C++ switch-case 语法：

```
switch ( x) {

  case 1 : //x is an integer

    while(y)
    {
        printf(" %i * %i  = %i \n",x,y,x*y);
        y--;
    }
    break; //Inside the case

} 
```

# php - AJAX：在另一个 div 中打开内容

> ID：13895783
> 
> 赞同：0
> 
> 时间：2012-12-15T20:13:26.647
> 
> 标签：php, javascript, ajax, html

我在一个网站上使用 AJAX，我目前正在制作一些页面以加载到某个 div：“pageContent”。现在我要在另一个 div 上打开另一个内容：“reproductor”。我想在“pageContent”div 中打开“page”，在“reproductor”div 中打开“play”。我不知道如何修改我的 script.js 和 load_page.php 文件以使其正常工作。这是我得到的：

[HTML：]

```
<script type="text/javascript" src="js/script.js"></script>
<a href="#page1">PAGE</a>
<a href="#play1">PLAY</a>
<div id ="pageContent"></div>
<div id="reproductor"></div> 
```

[脚本.js：]

```
var default_content="";
$(document).ready(function(){

    checkURL();
    $('ul li a').click(function (e){
        checkURL(this.hash);
    });

    default_content = $('#pageContent').html();
    setInterval("checkURL()",250);

});

var lasturl="";
function checkURL(hash)
{
    if(!hash) hash=window.location.hash;

    if(hash != lasturl)
    {
        lasturl=hash;
        if(hash=="")
            $('#pageContent').html(default_content);
        else
        loadPage(hash);
    }
}

function loadPage(url)
{
    url=url.replace('#page','');
    $('#loading').css('visibility','visible');
    $.ajax({
        type: "POST",
        url: "load_page.php",
        data: 'page='+url,
        dataType: "html",
        success: function(msg){
            if(parseInt(msg)!=0)
            {
                $('#pageContent').html(msg);
                $('#loading').css('visibility','hidden');
            }
        }   
    });
} 
```

[load_page.php：]

```
<?php

if(!$_POST['page']) die("0");

$page = (int)$_POST['page'];

if(file_exists('pages/page_'.$page.'.html'))
    echo file_get_contents('pages/page_'.$page.'.html');
else 
    echo 'There is no such page!';
?> 
```

我忘了提一下：我的“页面”内容在一个名为“页面”的文件夹中，我的“播放”内容在另一个名为“播放”的文件夹中。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:51:41.793

从提供 HTML 的资源中加载内容到元素中的最简单方法是使用`load`：

```
$('#reproductor').load('public_html/plays/play_1.html', function(){
    //stuff to do after load goes here
}); 
```

您也可以将此技术应用于您尝试将内容加载到的其他 div。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T21:16:37.197

以下不是理想解决方案的原因有很多。最明显的是安全性——通过在单击链接之前修改链接的 href 属性，用户当然可以让您的服务器在您的服务器上提供任何 html。

**编辑**我已经删除了我原来的答案，因为我不能推荐它的用法。

* * *

正如 Asad 所建议的，您还可以使用 jQuery 加载并使用上面的一些代码将相关的 url 传递给它

```
function loadPage(url)
{
    // remove the hash in url
    url=url.replace('#','');
    // extract page or play - only works for four letter words
    var contentType=url.substr(0,4);
    // extract the number
    var contentId=url.substr(4);
    if ( $contentType == "page") {
        $("#pageContent #loading").css('visibility','visible');
        $("#pageContent").load($contentType+'s/'+$contentType+'_'+$contentId+'.html');
        $("#pageContent #loading").css('visibility','hidden');
    } else if ( $contentType == "play") {
        $("#reporductor #loading").css('visibility','visible');
        $("#reproductor").load($contentType+'s/'+$contentType+'_'+$contentId+'.html');
        $("#reporductor #loading").css('visibility','hidden');
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T00:58:00.300

如果我理解，您有两组链接（用于页面和播放列表），每组链接都将加载到不同的容器中。这里可以试试：主要是我去掉了全局变量，把当前的hash放到了每个容器的[data](http://api.jquery.com/data/)里面，把两组link的管理分开了。

在这段代码中，我假设你有一个单独的`load_play.php`文件。如果不是，那么您可以对这两种链接使用相同的页面，但是您必须将 ajax 参数合并`loadPlay`、`loadPage`更改`loadPage(newHash)`为`loadPage(newHash, linkType)`并将 ajax 参数从更改`'page='+newHash`为`'number='+newHash+'&type='+linkType`，并在您的 PHP 页面中进行相应的服务器端更改。我建议您创建两个单独的 PHP 文件以管理这两种类型的内容。

我记得你在哪里对当前页面的 url 的哈希做一些事情，你仍然可以在`loadPage`函数内部的 ajax 的成功中设置它。

这是一个带有一些控制台调用（打开浏览器的控制台）但没有 ajax 调用的工作[sfiddle示例。](http://jsfiddle.net/roimergarcia/3Kxuu/)

**更新**：

我更新了代码，因此您可以管理动态添加的链接（通过 AJAX 加载的新内容），并修复了带有哈希的 url 管理，由于新代码而被破坏。

```
<div id="#page">
    <a href="#page1" class="pageLink">PAGE 1</a>
    <a href="#page2" class="pageLink">PAGE 2</a>
    <a href="#play1" class="playLink">PLAY 1</a>
    <a href="#play2" class="playLink">PLAY 2</a>
    <a href="#play3" class="playLink">PLAY 3</a>
    <div id ="pageContent"></div>
    <div id="reproductor"></div>
</div> 
```

这是javascript：

```
$(document).ready(function(){
    $('#pageContent').data('currentPage', '');
    $('#reproductor').data('currentPlay', '');

    //This will allow it to work even on dynamically created links
    $('#page').on('click', '.pageLink', function (e){
        loadPage(this.hash);
    });

    $('#page').on('click', '.playLink', function (e){
        loadPlay(this.hash);
    });

    //And this is for managing the urls with hashes (for markers)
    var urlLocation = location.hash;
    if(urlLocation.indexOf("#page") > -1){
        $('.pageLink[href='+ urlLocation +']').trigger('click')
    }

});

function loadPage(newHash)
{
    //This is the current Page
    var curHash = $('#pageContent').data('currentPage');
    //and this is the new one
    newHash = newHash.replace('#page', '');

    if(curHash===newHash){
        //If already loaded: do nothing 
        return
    }

    $('#loading').css('visibility','visible');
    $.ajax({
        type: "POST",
        url: "load_page.php",
        data: 'page='+newHash,
        dataType: "html",
        success: function(msg){
            if(parseInt(msg)!=0)
            {
                $('#pageContent').html(msg).data('currentPage',newHash);
                $('#loading').css('visibility','hidden');
            }
        }   
    });
}

function loadPlay(newHash)
{//Similar to loadPage...
    var curHash = $('#reproductor').data('currentPlay');
    newHash = newHash.replace('#play', '');

    if(curHash===newHash){return}

    $('#loading').css('visibility','visible');
    $.ajax({
        type: "POST",
        url: "load_play.php",
        data: 'play='+newHash,
        dataType: "html",
        success: function(msg){
            if(parseInt(msg)!=0)
            {
                $('#reproductor').html(msg).data('currentPlay',newHash);
                $('#loading').css('visibility','hidden');
            }
        }   
    });
} 
```

如果这是您需要的，请检查并评论，或者我有什么问题:)

# objective-c - NSObject-conformant 类中的 -self 方法的目的是什么？

> ID：13895789
> 
> 赞同：11
> 
> 时间：2012-12-15T20:14:42.853
> 
> 标签：objective-c, nsobject, foundation

就是这样。为什么有人想要（至少作为公共 API）这样的方法？它有什么实际用途吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-15T22:36:19.400

该`self`方法对于键值编码 (KVC) 很有用。

使用 KVC，您可以将对象视为字典。您可以使用包含属性名称的字符串访问对象的属性，如下所示`[view valueForKey:@"superview"]`：您使用包含关键路径的字符串遍历属性链，如下所示：`[view valueForKeyPath:@"superview.superview.center"]`.

由于`NSObject`有一个`self`方法，您可以使用`self`作为键或键路径：`[view valueForKey:@"self"]`. 因此，如果您正在以编程方式构建密钥路径，或者从文件中读取它们，使用`"self"`作为密钥可以避免编写特殊情况。

您还可以`self`在谓词中使用，如下所示：

```
NSPredicate *predicate = [NSPredicate predicateWithFormat:@"self beginswith \"foo\""];
NSArray *filteredArray = [arrayOfStrings filteredArrayWithPredicate:predicate]; 
```

我不知道在这种情况下是否`NSPredicate`实际使用该`self`方法（可能通过 KVC）。这当然是可能的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T22:11:40.007

我不确定为什么最初添加了“self”，但它确实派上用场的一件事是保护指向对象的内部指针。Apple 的官方建议是在完成内部指针后插入 [foo self] 调用；该方法调用在功能上没有任何作用，但确保编译器在此之前保持 foo 。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-12-15T20:44:41.603

我认为这与 ObjC 运行时有关。

```
objc_msgSend(autoreleasePool, sel_registerName("drain"));
BOOL AppDel_didFinishLaunching(struct AppDel *self, SEL _cmd, void *application, void *options) 
```

第一个参数是self。我认为这与此有关。老实说，虽然它最终会变成：

```
id self(struct id *self, SEL _cmd) {
    return self;
} 
```

....在我开始写这个回复之前，这更有意义。

# html5-audio - jQuery click() each() 是唯一的吗？

> ID：13895791
> 
> 赞同：-1
> 
> 时间：2012-12-15T20:14:47.490
> 
> 标签：html5-audio, jquery-click-event, jquery

我想要多个 span.play 没有 ID，可以点击并播放一些音频文件。

问题：仅在当前文件 $(this) 上显示持续时间

```
$('.play').each(function() {

    $(this).append('<span class="playIcon"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/76/Fairytale_player_play.png/14px-Fairytale_player_play.png"></span><span class="playDur"></span>');

    $(this).click(function() {
        var file = this.firstChild;
        if (file.paused != false) {
            //+ stop all others before playing new one
            file.play();
        } else {
            file.pause();
        }
        file.addEventListener("timeupdate", function() {
            var len = file.duration,
                ct = file.currentTime,
                s = parseInt(ct % 60),
                m = parseInt((ct / 60) % 60);
            if (s < 10) {
                s = '0' + s;
            }
            $(".playDur").html('&nbsp;(' + m + ':' + s + ')');
            if (ct == len) {
                $(".playDur").html('');
            }
        }, false);
    });

}); 
```

测试：

[http://jsfiddle.net/sQPPP/](http://jsfiddle.net/sQPPP/)

[http://jsfiddle.net/sQPPP/1/](http://jsfiddle.net/sQPPP/1/) - 使用`$(this).children( ".foo" )`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:19:13.677

您需要将`.play`jQuery 对象保存在一个变量中，作为回调中的`this`更改。`addEventListener`

[http://jsfiddle.net/sQPPP/2/](http://jsfiddle.net/sQPPP/2/)

```
$('.play').each(function(index) {
    var $play = $(this);
    $play.append('<span class="playIcon"><img src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/76/Fairytale_player_play.png/14px-Fairytale_player_play.png"></span><span class="playDur"></span>');

    $play.click(function() {
        var file = this.firstChild;
        if (file.paused != false) {
            //+ stop all others before playing new one
            file.play();
        } else {
            file.pause();
        }
        file.addEventListener("timeupdate", function() {
            var len = file.duration,
                ct = file.currentTime,
                s = parseInt(ct % 60),
                m = parseInt((ct / 60) % 60);
            if (s < 10) {
                s = '0' + s;
            }
            $play.children( ".playDur" ).html('&nbsp;(' + m + ':' + s + ')');
            if (ct == len) {
                 $play.children( ".playDur" ).html('');
            }
        }, false);
    });

});​ 
```

# javascript - 如何在 Jquery Mobile 中从 XML 填充另一个页面上的列表

> ID：13895802
> 
> 赞同：0
> 
> 时间：2012-12-15T20:16:20.240
> 
> 标签：javascript, jquery, jquery-mobile

我想要做的是使用 JQuery Mobile 我想根据我单击的选项在#newPage 上动态加载内容。下面是我尝试过的#newPage 代码，但不加载任何内容。我试图提供尽可能多的信息，并逐行评论我想要它做的事情。

示例 XML：

```
<parentOption>
    <option1>
        <name>Stuff</name>
    </option1>
    <potion2>
        <name>More Stuff</name>
    </potion2>
    <option3>
       <name>Even More Stuff</name>
    </option3>
</parentOption> 
```

假设我已经通过 Ajax 连接到 XML 文件：

```
<script>
    function parseXML(xml) { //Parse the XML
        $('selected').click(function(e) { //Once the link is clicked
            var selectedValue = $(this).value(); //Find the value of the clicked link
            e.preventDefault(); //Refresh the new page
            $(xml).find(selectedValue).each(function() { //take the XML info and select all of the elements equaling to the value of the selected link
                var nameValue = $(this).parent(); //Find the parent of the selected element
                $('#dynamicList').append('<li>' + $(nameValue).child('name').text() + '</li>'); //Write out the list on the new page
            });
            $('#dynamicList').listview('refresh');
        });
     }
 </script>
 <div data-role="page" id="home">
     <div data-role="content">
         <ul data-role="listview">
             <li><a class="selected" value="option1" href="#newPage">Option 1</a></li>
             <li><a class="selected" value="option1" href="#newPage">Option 2</a></li>
             <li><a class="selected" value="option1" href="#newPage">Option 3</a></li>
         </ul>
     </div>
</div>
<div data-role="page" id="newPage">
    <div data-role="content">
        <ul id="dynamicList" data-role="listview">

        </ul>
    </div>
</div> 
```

这是单击第一个链接后所需的输出：

```
<div data-role="page" id="home">
    <div data-role="content">
        <ul data-role="listview">
            <li><a class="selected" value="option1" href="#newPage">Option 1</a></li>
            <li><a class="selected" value="option1" href="#newPage">Option 2</a></li>
            <li><a class="selected" value="option1" href="#newPage">Option 3</a></li>
        </ul>
    </div>
 </div>
 <div data-role="page" id="newPage">
     <div data-role="content">
         <ul id="dynamicList" data-role="listview">
             <li>Stuff</li>
         </ul>
     </div>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T10:27:01.387

我给你做了一个工作的例子，看看这里：http: [//jsfiddle.net/Gajotres/AzXdT/](http://jsfiddle.net/Gajotres/AzXdT/)。另外我需要给你一个警告，这个例子只适用于 jsFiddle，因为你不能从其他域加载 xml。如果您想从您的域（您的托管服务器）加载 xml，请使用以下代码：

```
$.ajax({
    type: "GET",
    url: "sites.xml",
    dataType: "xml",
    success: function(xml) {

    }
}); 
```

如果可能，请使用 JSON 而不是 XML。原因是，复杂的 XML 可能会很大，并且会产生大量数据开销。JSON 是为了解决这个问题而创建的。如果你想尝试一下，我给你举了另一个例子：http: [//jsfiddle.net/Gajotres/8uac7/](http://jsfiddle.net/Gajotres/8uac7/)。这个例子可以在任何地方使用，所以请随意使用它。

# javascript - JS Boolean var 不影响 if 语句

> ID：13895803
> 
> 赞同：0
> 
> 时间：2012-12-15T20:16:23.693
> 
> 标签：javascript, html, canvas, if-statement, boolean

我正在做一个 HTML5 画布画家，具有绘制、放置矩形、圆形和不同颜色选项的选项。我的问题是我最初有一个默认值为“铅笔”的 var 工具，我想通过单击将此变量更改为“矩形”（还没有从圆圈开始，因为我想先完成这项工作）在相应的 div 上，这样我就可以有一个用于绘图、矩形或圆形的 if 语句。但这不起作用，我选择了变量，因为我在 onclick 函数中放置了一个警报。之后我尝试使用布尔变量（pencil = true，rect = false，本来是一个“状态”），但这也不起作用。我确实已经写下了 if 语句，所以我现在的结论是，我以某种方式将布尔值作为常量（因为铅笔 = true 是我的 var 的默认状态），这似乎不太可能。更合乎逻辑的解释是我没有通过 div-click 正确更改变量的值。

这是我的代码的一部分：

```
var canvas = document.getElementById("canvas");
var ctx = canvas.getContext("2d");

var color = "black";
var drawing = false;
var pencil = true;
var rect = false;

//Pencil
var pencilDiv = document.getElementById("pencil");
pencilDiv.onclick = function () {
  pencil = true;
  rect = false;
}

//Rect
var rectDiv = document.getElementById("rect");
rectDiv.onclick = function () {
  rect = true;
  pencil = false;
}

if (pencil) {
  canvas.onmousedown = function (event) {
    drawing = true;
  }

  canvas.onmousemove = function (event) {
    if (drawing) {
      draw()
    }
  }

  canvas.onmouseup = function (event) {
    drawing = false;
  }
}

if (rect) {
  canvas.onmousedown = function (event) {
    rect()
  }
} 
```

draw 和 rect 函数都有效。我也试过 if(pencil == true && rect == false)，也没有用。

抱歉，如果答案很明显而我只是没有看到，这是我第二次使用 Javascript 进行编程。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:21:56.127

您已经编写了代码，就好像鼠标事件处理程序的分配在每次条件更改时都会隐式地重新完成。这不是它的工作方式。您应该简单地为绘图控件重新分配事件处理程序中的处理程序，因为该代码**将****在**每个“单击”事件上运行。

例如：

```
pencilDiv.onclick = function () {
  canvas.onmousedown = function (event) {
    drawing = true;
  }

  canvas.onmousemove = function (event) {
    if (drawing) {
      draw()
    }
  }

  canvas.onmouseup = function (event) {
    drawing = false;
  }
}

rectDiv.onclick = function () {
  canvas.onmousedown = function (event) {
    rect()
  }
  canvas.onmousemove = canvas.onmouseup = null;
} 
```

或者，您可以让鼠标事件处理程序的代码检查标志，从而避免在每个控件“单击”事件上重新分配事件处理程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-16T00:33:00.927

变量和方法名称是相同的 rect 和 rect()。JavaScript 不支持同名变量和函数，这就是为什么 rect() 函数会覆盖 rect 变量的值并始终返回 true 但您的期望是 false 的原因。更改 rect 的变量或函数名称。

# c# - 如何使用membershipProvider或usernamePasswordvalidator通过WCF服务创建用户

> ID：13895804
> 
> 赞同：0
> 
> 时间：2012-12-15T20:16:30.637
> 
> 标签：c#, .net, wcf, membership-provider

我有一个连接到 WCF 服务的 WPF 应用程序。我需要对用户进行身份验证才能调用我的服务的任何方法，但如果您没有帐户，我还需要用户能够注册。

我首先考虑使用 usernamePasswordvaldator 但我找不到一种方法来创建一个不通过我的验证器类的验证方法的注册方法。

然后我看到了 MembershipPovider 但没有找到任何与我的情况相匹配的例子。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T12:56:54.503

You can create a special user in the database. Add this user to a special membership role. This special user can **only** create new users, it doesn't have any other permissions to the service methods.

You should add a PriciplePermission attirbute on all of your methods, and allow your new role (CreateUserRole) to access just the CreateUser method.

```
[PrincipalPermission(SecurityAction.Demand, Role = "CreateUserRole")]
public void CreateUser(string username, string password) 
```

All other methods should have different roles:

```
[PrincipalPermission(SecurityAction.Demand, Role = "ADMINISTRATORS")]
public bool DeleteUser(string username) 
```

so that this special user can only access the CreateUser method.

# git - 将 git 文件历史记录保存为多个文件

> ID：13895810
> 
> 赞同：2
> 
> 时间：2012-12-15T20:17:23.563
> 
> 标签：git, bisect

我一直在 perf.txt 中为我的代码保存一些自动生成的性能数据。每次我改进代码时，我都会运行一个脚本，用新的性能数据覆盖 perf.txt。然后我将提交 perf.txt。

回想起来，覆盖 perf.txt 是一个愚蠢的错误，现在，我想对我的改进进行一些分析/绘制图表，但不能。当然，旧的 perf.txt 文件仍然存在于我的提交历史中。有什么简单的方法可以得到它们吗？理想情况下，我希望在新目录中包含 perf~1.txt、perf~2.txt 等以及时间戳。

或者，如果我可以像 git-bisect 那样简单地“重播”提交历史记录（例如 git next perf.txt） - 但线性 - 那也可以。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:38:10.987

好的，我设法为此创建了一个 shell 脚本。让我知道它是否工作正常。

更新：

```
i=0; git rev-list HEAD package.json | while read sha1; do; git show "$sha1:package.json" > "$(printf "%04d" $i)-$sha1-package.json"; ((i++)); done 
```

将输出：

```
$ ls *-package.json | cat
0000-a15147199edff1b1c0fab89c66214abfb8c65d7c-package.json
0001-51feba61197b837b7d55754a56e12f66f0624ba1-package.json
0002-ed9e34482a303e7e64c397f89533dbe64f51cfbf-package.json
0003-d01253e20158f53c08aa6bc0c1cf66806cd19148-package.json
0004-d57363e800535a7400fde56e97d0a4cd424cffbb-package.json
0005-6e995583a11b63bf1d94142da6408955ee93e7cc-package.json
0006-6bc2a87943f59ad277cdee26aec1c25949c0f091-package.json
0007-e06a8cae3a1de58b770a66cbd124cf50e809fb31-package.json
0008-81bf63359641255dfd340714d0635be03bda8de9-package.json
0009-95559f5117c8a21c1b8cc99f4badc320fd3dcbda-package.json
0010-5e906366dd86dda95df050257513c95834020e5e-package.json
0011-717cb2a5c7909ed16f7c599b02759b27fd2e4258-package.json
0012-f18b75940e61a52ef9c0cf41a4bda3bcdae5c46c-package.json
0013-3c86547a3b841807c4744af0fa4ee3894cc17a33-package.json
0014-d5658e978d9a7234e537d57c45069ce223cb3853-package.json
0015-286c4d91dde12ba32f4a56273d05374b1cbb79e7-package.json
0016-46d680458b74fcf956f6161a2b73b6b00fc2541d-package.json
0017-e64f89d9aaf26c2dae6c7f1ef29a2d3cadd0b4b2-package.json
0018-bd84aad6cdde8cf3ce7842df1febb82fe9816647-package.json
0019-6cf1542a8b823c6bdacf7e6e01dfcb58e9949ff4-package.json
0020-1434b5b56756d02190afe552b626823c97b11a49-package.json 
```

排序时将保持正确的顺序。

* * *

原来的：

```
i=0; git rev-list HEAD package.json | while read sha1; do; git show "$sha1:package.json" > "$i-$sha1-package.json"; ((i++)); done 
```

在所有 3 个地方替换`package.json`为您想要的文件。

这将创建如下文件：

```
$ ls *-package.json | cat
0-a15147199edff1b1c0fab89c66214abfb8c65d7c-package.json
1-51feba61197b837b7d55754a56e12f66f0624ba1-package.json
10-5e906366dd86dda95df050257513c95834020e5e-package.json
11-717cb2a5c7909ed16f7c599b02759b27fd2e4258-package.json
12-f18b75940e61a52ef9c0cf41a4bda3bcdae5c46c-package.json
13-3c86547a3b841807c4744af0fa4ee3894cc17a33-package.json
14-d5658e978d9a7234e537d57c45069ce223cb3853-package.json
15-286c4d91dde12ba32f4a56273d05374b1cbb79e7-package.json
16-46d680458b74fcf956f6161a2b73b6b00fc2541d-package.json
17-e64f89d9aaf26c2dae6c7f1ef29a2d3cadd0b4b2-package.json
18-bd84aad6cdde8cf3ce7842df1febb82fe9816647-package.json
19-6cf1542a8b823c6bdacf7e6e01dfcb58e9949ff4-package.json
2-ed9e34482a303e7e64c397f89533dbe64f51cfbf-package.json
20-1434b5b56756d02190afe552b626823c97b11a49-package.json
3-d01253e20158f53c08aa6bc0c1cf66806cd19148-package.json
4-d57363e800535a7400fde56e97d0a4cd424cffbb-package.json
5-6e995583a11b63bf1d94142da6408955ee93e7cc-package.json
6-6bc2a87943f59ad277cdee26aec1c25949c0f091-package.json
7-e06a8cae3a1de58b770a66cbd124cf50e809fb31-package.json
8-81bf63359641255dfd340714d0635be03bda8de9-package.json
9-95559f5117c8a21c1b8cc99f4badc320fd3dcbda-package.json 
```

# r - 组合不等长度和非唯一值的向量

> ID：13895819
> 
> 赞同：4
> 
> 时间：2012-12-15T20:18:09.607
> 
> 标签：r, dataframe, sequence, missing-data

我想做以下事情：

组合成一个数据框，两个向量

*   有不同的长度
*   包含在另一个向量中也发现的序列
*   包含在其他向量中找不到的序列
*   在其他向量中找不到的序列永远不会超过 3 个元素
*   总是有相同的第一个元素

数据框应显示对齐的两个向量中的相等序列，如果一个向量缺少另一个向量中存在的序列，则在列中显示 NA。

例如：

```
vector 1    vector 2                     vector 1        vector 2
   1           1                            a               a
   2           2                            g               g
   3           3                            b               b
   4           1            or              h               a
   1           2                            a               g
   2           3                            g               b   
   5           4                            c               h
               5                                            c 
```

应该组合成数据框

```
 1   1                                    a   a
    2   2                                    g   g
    3   3                                    b   b
    4   NA                                   h   NA
    1   1                  or                a   a 
    2   2                                    g   g
    NA  3                                    NA  b
    NA  4                                    NA  h
    5   5                                    c   c 
```

我所做的是搜索合并、组合、cbind、plyr 示例，但无法找到解决方案。恐怕我需要开始编写一个带有嵌套 for 循环的函数来解决这个问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T21:47:37.157

**注意**- 这是作为对第一版 OP 的回答而提出的。从那时起，该问题已被修改，但我认为该问题仍未明确定义。

* * *

这是一个适用于您的`integer`示例并且也适用于`numeric`向量的解决方案。我还假设：

*   两个向量包含相同数量的序列
*   一个新的序列从哪里开始`value[i+1] <= value[i]`

如果您的向量不是数字的，或者我的假设之一不适合您的问题，您必须澄清。

```
v1 <- c(1,2,3,4,1,2,5)
v2 <- c(1,2,3,1,2,3,4,5)

v1.sequences <- split(v1, cumsum(c(TRUE, diff(v1) <= 0)))
v2.sequences <- split(v2, cumsum(c(TRUE, diff(v2) <= 0)))

align.fun <- function(s1, s2) { #aligns two sequences
  s12 <- sort(unique(c(s1, s2)))
  cbind(ifelse(s12 %in% s1, s12, NA),
        ifelse(s12 %in% s2, s12, NA))
}

do.call(rbind, mapply(align.fun, v1.sequences, v2.sequences))
#       [,1] [,2]
#  [1,]    1    1
#  [2,]    2    2
#  [3,]    3    3
#  [4,]    4   NA
#  [5,]    1    1
#  [6,]    2    2
#  [7,]   NA    3
#  [8,]   NA    4
#  [9,]    5    5 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-16T04:15:21.213

我认为您的问题可能会根据[最短的公共超序列](http://en.wikipedia.org/wiki/Shortest_common_supersequence)来解决。它假设您的两个向量分别代表*一个*序列。请尝试下面的代码。

如果它仍然不能解决您的问题，您必须准确解释“我的向量包含的不是一个而是多个序列”的含义：定义序列的含义并告诉我们如何通过扫描您的序列来识别序列两个向量。

**第一部分**：给定两个序列，找到[最长的公共子序列](http://en.wikipedia.org/wiki/Longest_common_subsequence_problem)

```
LongestCommonSubsequence <- function(X, Y) {
    m <- length(X)
    n <- length(Y)
    C <- matrix(0, 1 + m, 1 + n)
    for (i in seq_len(m)) {
        for (j in seq_len(n)) {
            if (X[i] == Y[j]) {
                C[i + 1, j + 1] = C[i, j] + 1
            } else {
                C[i + 1, j + 1] = max(C[i + 1, j], C[i, j + 1])
            }
        }
    }

    backtrack <- function(C, X, Y, i, j) {
        if (i == 1 | j == 1) {
            return(data.frame(I = c(), J = c(), LCS = c()))
        } else if (X[i - 1] == Y[j - 1]) {
            return(rbind(backtrack(C, X, Y, i - 1, j - 1),
                         data.frame(LCS = X[i - 1], I = i - 1, J = j - 1)))
        } else if (C[i, j - 1] > C[i - 1, j]) {
            return(backtrack(C, X, Y, i, j - 1))
        } else {
            return(backtrack(C, X, Y, i - 1, j))
        }
    }

    return(backtrack(C, X, Y, m + 1, n + 1))
} 
```

**第二部分**：给定两个序列，找到[最短的公共超序列](http://en.wikipedia.org/wiki/Shortest_common_supersequence)

```
ShortestCommonSupersequence <- function(X, Y) {
    LCS <- LongestCommonSubsequence(X, Y)[c("I", "J")]
    X.df <- data.frame(X = X, I = seq_along(X), stringsAsFactors = FALSE)
    Y.df <- data.frame(Y = Y, J = seq_along(Y), stringsAsFactors = FALSE)   
    ALL <- merge(LCS, X.df, by = "I", all = TRUE)
    ALL <- merge(ALL, Y.df, by = "J", all = TRUE)
    ALL <- ALL[order(pmax(ifelse(is.na(ALL$I), 0, ALL$I),
                          ifelse(is.na(ALL$J), 0, ALL$J))), ]
    ALL$SCS <- ifelse(is.na(ALL$X), ALL$Y, ALL$X)
    ALL
} 
```

**你的例子**：

```
ShortestCommonSupersequence(X = c("a","g","b","h","a","g","c"),
                            Y = c("a","g","b","a","g","b","h","c"))
#    J  I    X    Y SCS
# 1  1  1    a    a   a
# 2  2  2    g    g   g
# 3  3  3    b    b   b
# 9 NA  4    h <NA>   h
# 4  4  5    a    a   a
# 5  5  6    g    g   g
# 6  6 NA <NA>    b   b
# 7  7 NA <NA>    h   h
# 8  8  7    c    c   c 
```

（其中两个更新的向量在列`X`和`Y`中。）

# asp.net - Unity - 注册接受类型的接口

> ID：13895820
> 
> 赞同：0
> 
> 时间：2012-12-15T20:18:10.337
> 
> 标签：asp.net, asp.net-mvc-4, unity-container

使用 Unity，我正在尝试将以下接口注册到模型：

```
public interface IGenericRepository<T> : IDisposable where T : class 
```

这是在 Unity 的引导程序中注册它的正确方法吗？

```
 container.RegisterType<IGenericRepository<TypeBasedOverride>, GenericRepository<TypeBasedOverride>>(new HierarchicalLifetimeManager()); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T10:20:48.250

我认为您想为任何具体的 T 注册该接口。如果是这样，您需要将泛型类型注册为开放的泛型类型（没有类型参数）。检查这个[msdn 条目](http://msdn.microsoft.com/en-us/library/ff660936%28PandP.20%29.aspx)。

在您的示例中：

```
container.RegisterType(typeof(IGenericRepository<>), typeof(GenericRepository<>), new HierarchicalLifetimeManager()); 
```

这样，当您请求 的实例时，无论 SomeClass 的具体类型如何`IGenericRepository<SomeClass>`，Unity 都会为您提供 的实例。`GenericRepository<SomeClass>`

# android - 在Android中向AlertDialog添加样式后如何显示文本？

> ID：13895822
> 
> 赞同：2
> 
> 时间：2012-12-15T20:18:21.057
> 
> 标签：android

我在我的 Android(API 15) 应用程序中添加了一个主题，但它产生了将文本隐藏在我的对话框中的意外后果。

这是没有样式的外观

![没有造型](../Images/87fba3aadce4088a1f7d6ef9c026af38.png)

这是添加样式后的外观

![有造型](../Images/be048de08e68f08d365f064ee85049dd.png)

这是我构建对话框的方式：

```
private void showWarning() {
    AlertDialog.Builder builder = new AlertDialog.Builder(this);
    builder.setTitle("Warning");
    builder.setMessage("Information shown might be wrong.");
    builder.setCancelable(false);
    builder.setPositiveButton("Ok", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) { 
            dialogs.remove(DIALOG_WARNING);
        }
    });
    builder.setNegativeButton("Quit", new DialogInterface.OnClickListener() {
        public void onClick(DialogInterface dialog, int which) {
            TravelHealthActivity.mInstance.deleteDatabase("TravelHealth");
            finish();
        }
    });
    AlertDialog dlg = builder.create();
    dlg.setCanceledOnTouchOutside(false);
    dialogs.put(DIALOG_WARNING, dlg);
    dlg.show();
} 
```

这是我完整的 style.xml，[我一直在尝试摆脱微调器下拉菜单的背景](https://stackoverflow.com/questions/13703233/style-android-spinner/)，因此有一大堆背景资料。我是样式的新手，所以我不确定什么是相关的，并且可能导致文本消失。

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">
<style name="appcin" parent="@android:style/Theme.NoTitleBar.Fullscreen">
    <item name="android:spinnerStyle">@style/spinnerStyle</item>
    <item name="android:spinnerItemStyle">@style/SpinnerItem</item>
    <item name="android:spinnerDropDownItemStyle">@style/SpinnerDropDownItem</item> -->
    <item name="android:background">#FFFFFF</item>
    <item name="android:textColor">#000000</item>
    <item name="android:checkboxStyle">@style/checkboxStyle</item>
    <item name="android:popupBackground">@null</item>
    <item name="android:dropDownListViewStyle">@style/DropDownStyler</item>
    <item name="android:dropDownSpinnerStyle">@style/DropDownStyle</item>
    <item name="android:dropDownSelector">@style/DropDownStyle</item>
</style>
<style name="layout">
    <item name="android:padding">10dip</item>
</style>
<style name="title" parent="@android:style/TextAppearance">
    <item name="android:textColor">#993399</item>
</style>
<style name="text" parent="@android:style/TextAppearance">
    <item name="android:textColor">#111111</item>
</style>
<style name="textview" parent="@android:style/TextAppearance">
    <item name="android:textColor">#993399</item>
    <item name="android:background">#FFFFFF</item>
</style>
<style name="edittext" parent="@android:style/TextAppearance">
    <item name="android:textColor">#111111</item>
</style>
<style name="button" parent="@android:style/TextAppearance">
    <item name="android:textColor">#111111</item>
    <item name="android:background">@drawable/rect_white</item>
    <item name="android:padding">10dip</item>
    <item name="android:layout_marginLeft">10dip</item>
</style>
<style name="spinnerStyle">
    <item name="android:background">@drawable/pink_white_dropdown</item>
    <item name="android:popupBackground">@null</item>
    <item name="android:clickable">true</item>
</style>
<style name="SpinnerItem">
    <item name="android:textColor">#993399</item>
    <item name="android:popupBackground">@null</item>
    <item name="android:background">@drawable/pink_white_dropdown</item>
    <item name="android:maxHeight">10dip</item>
</style>
<style name="SpinnerDropDownItem">
    <item name="android:textColor">#993399</item>
    <item name="android:popupBackground">@null</item>
    <!-- <item name="android:background">#FFFFFF</item> -->
</style>
<style name="DropDownStyle">
    <item name="android:background">#FFF000</item>
    <item name="android:popupBackground">@null</item>
    <item name="android:cacheColorHint">#FFF000</item>
</style>

<style name="checkboxStyle" parent="@android:style/Widget.Holo.Light.CompoundButton.CheckBox">
    <item name="android:textColor">#993399</item>
</style> 
```

# aspectj - roo 生成的控制器的推入式重构引发“没有可用的横切模型。重建项目”

> ID：13895823
> 
> 赞同：2
> 
> 时间：2012-12-15T20:18:22.630
> 
> 标签：aspectj, spring-roo, sts-springsourcetoolsuite

该项目编译没有错误并且运行良好。我已经在它上面运行了“Project..Clean”，以及“Maven..Update project”和“mvn clean install”。在这些步骤中的每一个之后，我仍然得到相同的重构错误。

我还选择了“Spring tools..Enable Spring Aspects tooling”只是为了好玩。

我还尝试禁用和重新启用 JDT Weaving，还尝试了“立即索引”选项。

我缺少什么能够重构 roo 控制器？

STS 版本：3.1.0.RELEASE

aspectjrt-1.7.0.RC1 aspectjweaver-1.7.0.RC1

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T16:40:44.487

我将 maven 配置切换为使用嵌入式版本而不是外部命令，并且现在允许重构。我通过使用外部maven发现，横切模型不是在Eclipse环境中构建的。

背景：由于之前的maven问题，建议使用外部版本，解决了Eclipse内部无法编译的问题。显然这个问题已经消失了，因为该项目现在使用嵌入式 maven 构建。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-04-01T14:30:59.090

解决问题的一些提示：

*   右键>禁用maven性质，然后进入你项目的系统目录，做一个`mvn eclipse:clean`，返回eclipse，右键，配置>转换为maven项目。
*   验证您是否有项目 > 自动构建被选中。
*   做一个项目>清理，也许这是你错过的最后一步。

# c++ - 优化计算时间

> ID：13895824
> 
> 赞同：3
> 
> 时间：2012-12-15T20:18:29.293
> 
> 标签：c++, optimization, parallel-processing, openmp

我正在体验并行标量产生两个向量并测量经过的时间。我正在比较顺序与并行标量产品：

序列：`double scalar(int n, double x[], double y[])`

```
for (int i=0; i<n; i++)
{
   sum += x[i]*y[i];
} 
```

平行线：`double scalar_shm(int n, double x[], double y[])`

```
#pragma omp parallel for private(i) shared(x,y) reduction(+:sum)
for (i=0; i<n; i++)
{
   sum += x[i]*y[i];
} 
```

我一个接一个地调用它们：

```
//sequential loop
for (int n=0; n<loops; n++)
{ scalar(vlength,x,y); }

//measure sequential time
t1 = omp_get_wtime() - tstart;

//parallel loop
for (int n=0; n<loops; n++)
{ scalar_shm(vlength,x,y); }

//measure parallel time
t2 = omp_get_wtime() - t1 - tstart;

//print the times elapsed
cout<< "total time (sequential): " <<t1 <<" sec" <<endl;
cout<< "total time (parallel  ): " <<t2 <<" sec" <<endl; 
```

每个循环我用随机双精度填充向量，我删除了那部分，因为我认为它无关紧要。

输出是：

```
total time (sequential): 15.3439 sec
total time (parallel  ): 24.5755 sec 
```

我的问题是为什么并行的速度较慢？如果它更慢有什么好处？我预计它会更快，因为我有点认为像这样的计算是它的重点。

注意：我在 Intel Core i7-740QM 上运行它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-05T14:55:39.310

您正在为每次迭代创建和销毁一个新的并行部分代码。这个操作很慢。您可以尝试在内部循环之外创建并行部分：

```
//parallel loop
int sum;
#pragma omp parallel private(n) reduction(+:sum)
{
    for (int n=0; n<loops; n++)
    { 
       scalar_shm(vlength,x,y, sum); 
    }
} 
```

在 scalar_shm 函数中，OpenMP pragma 将是：

```
#pragma omp for private(i)
for (i=0; i<n; i++)
{
   sum += x[i]*y[i];
} 
```

# objective-c - NSXMLParser RSS 加载更多

> ID：13895825
> 
> 赞同：0
> 
> 时间：2012-12-15T20:18:35.057
> 
> 标签：objective-c, cocoa-touch, xml-parsing, rss, nsxmlparser

我能够成功解析来自 RSS 提要的项目（标题、链接、描述、创建者、pubDate 和 Cdata 图像）。这是我卡住的地方。我想实现“加载更多”选项，以便当用户向下滚动 tableview 时，他将单击一个按钮或只是滚动更多以显示更多 tableview 单元格。

我想要的是解析器一次解析 10 个项目，然后单击加载更多，它应该解析并加载更多 10 个项目。

最后，有什么方法可以格式化 RSS 提要，在第一页显示 10 个项目，在下一页显示 10 个项目，依此类推。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T21:49:59.730

创建如下所示的 RSS 提要。

```
http://www.example.com/rssfeed.php?page=1
http://www.example.com/rssfeed.php?page=2
http://www.example.com/rssfeed.php?page=3 
```

这样您就可以将页面作为参数发送并可以根据页码获取结果，每页仅发送 10 个项目。

# c++ - 在不创建副本的情况下访问作为向量成员的地图元素

> ID：13895828
> 
> 赞同：1
> 
> 时间：2012-12-15T20:18:47.607
> 
> 标签：c++, map, vector

我有以下数据类型

```
typedef     std::map <std::string.std::string> leaf; 
typedef     std::map <std::string,leaf> child;
typedef     std::vector<child> parent; 
```

现在，如果我想访问索引 0 处的父元素和具有键“x”的子元素，然后对其值执行一些操作

第一种方法是：

```
 parentobject[0]["x"]["r"] 
```

但是每次我想要访问该值时都需要重复这些索引。

第二种方法是： std::string value=parentobject[0]["x"]["r"] 然后使用值对象。但是这种方法的问题是这一行将创建字符串的副本。

有没有更好的方法来访问变量而不创建副本？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:30:39.173

使用参考：

```
const std::string& value = parentobject[0]["x"]["r"]; 
```

现在您可以参考`value`您喜欢的任何地方（在同一块范围内），而无需再次执行地图查找。

`const`如果您*确实*需要，请删除。

请购买并阅读其中一[本](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)以了解 C++ 的基本特性。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:29:25.483

您可以使用参考来避免复制：

```
std::string & value = parentobject[x][y][z]; 
```

或者，您是否可以这样做：

```
//define a lambda in the scope
auto get =  [] (int x, std::string const & y, std::string const & z) 
      -> std::string &
{
    return parentobject[x][y][z];
}

//then use it as many times as you want in the scope
std::string & value = get(0, "x", "r");

get(1, "y", "s") = "modify"; 
```

# ios - 当我将 UI 元素放入其中时，为什么 UIScrollView 不滚动？

> ID：13895833
> 
> 赞同：0
> 
> 时间：2012-12-15T20:19:21.863
> 
> 标签：ios, uiscrollview, uikit, interface-builder

使用 Xcode 4.5.2，我创建了一个单一视图应用程序。使用 Interface Builder，我用 UIScrollView 填充了视图。在我的视图控制器中，我添加了一个出口，如下所示：

```
@interface ScrollerViewController : UIViewController {
    IBOutlet UIScrollView *_scrollView;
} 
```

我使用 Interface Builder 将插座连接到实际的滚动视图。

`viewDidLoad`视图控制器的方法是

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    [_scrollView setContentSize:CGSizeMake(320, 700)];
} 
```

现在运行应用程序，我可以像预期的那样滚动滚动视图。我可以看到这是有效的，因为当我滑动视图时会出现滚动条。

现在，当我在滚动视图中放置标签（或按钮）时，滚动视图停止工作。它不再滚动。标签不会移动，滚动条也不会出现。当我删除标签时，它再次起作用（滚动）。

知道我想念什么吗？

编辑：

[你可以在GitHub 上](https://github.com/polaris/Scroller2)找到我的玩具项目。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:37:56.003

我认为滚动仅在内容大小大于滚动视图的框架时才有效。因此，如果不是，请尝试将其放大。

希望这可以帮助！

编辑：

好的，找到问题了。关闭 IB 的自动布局。

# jquery - 联系表格重新加载通知

> ID：13895834
> 
> 赞同：0
> 
> 时间：2012-12-15T20:19:26.507
> 
> 标签：jquery, contact-form

我有一个正在使用的联系表格，我正在使用 jquery load 将其加载到我的网站中，当您单击联系时，您可以在此处看到它：www.klossal.com

当表单试图通知您某些事情时，问题就会发生，无论是您的电子邮件已发送还是您忘记输入您的姓名。我是 php 和 jquery 的新手，所以我不确定如何防止这种情况发生。当它们发生在原始页面 www.klossal.com/contact.php 上时，这些重新加载似乎不会发生。页面似乎完全重新加载，有没有办法在我的页面上保留这些小通知？

我将它加载到我的页面中，如下所示：

```
$("#contact_form").click(function() { $("#content_1").load("contact.php"); }); 
```

联系页面的代码如下，只需访问[http://www.klossal.com/contact.php](http://www.klossal.com/contact.php)并查看源代码即可查看。很长，所以我没有在这里发布它。我能得到的任何帮助都会很棒，这是我需要做的最后一件事。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:24:12.793

注意控制台：你有一个错误：

> 未捕获的 SyntaxError：意外的标识符 contact.php 第 70 行

您不会转义作为字符串一部分的引号。

* * *

您还应该使用类似的东西

```
$("form").on('submit', function (e) {
   e.preventDefault(); 
```

而不是仅仅`return false;`用来停止表单提交，虽然我不认为这是一个问题。

# php - 仅当只有一种测试方法时才能通过测试

> ID：13895837
> 
> 赞同：1
> 
> 时间：2012-12-15T20:19:34.480
> 
> 标签：php, tdd, phpunit, output-buffering, vfs-stream

如果我注释掉下面的测试之一，则测试通过。但是，同时运行两者，最后一个将失败（即使我更改测试顺序）：

生产代码：

```
<?php
class View
{
    private $filename;
    private $data;

    public function __construct($filename)
    {
        $this->filename = $filename;
        $this->data = [];
    }

    public function __set($key, $value)
    {
        $this->data[$key] = $value;
    }

    public function render()
    {
        extract($this->data);
        ob_start();
        require_once $this->filename;
        return ob_get_clean();
    }

    public function __toString()
    {
        return $this->render();
    }
} 
```

测试类：

```
require_once 'vendor/autoload.php';

use org\bovigo\vfs\vfsStream;
use org\bovigo\vfs\vfsStreamWrapper;
/**
 * @outputBuffering enabled
 */
class ViewTest extends PHPUnit_Framework_TestCase
{
    public function setUp()
    {
        vfsStream::setup();
    }

    /**
     * @outputBuffering enabled
     */
    public function testRenderSimpleView()
    {
        $fileContent = 'index file';
        vfsStreamWrapper::getRoot()->addChild(
            vfsStream::newFile('index.php')->withContent($fileContent)
        );
        $view = new View(vfsStream::url('index.php'));
        echo $view->render();
        $this->expectOutputString($fileContent);
    }

    /**
     * @outputBuffering enabled
     */
    public function testRenderViewWithData()
    {
        $filename = 'index.php';
        $fileContent = '<?php echo $a; ?>';
        vfsStreamWrapper::getRoot()->addChild(
            vfsStream::newFile($filename)->withContent($fileContent)
        );
        $view = new View(vfsStream::url($filename));
        $view->a = 1;
        echo $view;
        $this->expectOutputString('1');
    }
} 
```

测试输出：

```
PHPUnit 3.7.10 by Sebastian Bergmann.

.F

Time: 0 seconds, Memory: 3.75Mb

There was 1 failure:

1) ViewTest::testRenderViewWithData
Failed asserting that two strings are equal.
--- Expected
+++ Actual
@@ @@
-'1'
+''

FAILURES!
Tests: 2, Assertions: 2, Failures: 1. 
```

这对我来说没有任何意义。我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T03:23:30.957

When that happens, it's usually because you're not isolating the method that you are testing properly. In other words, PHPUnit doesn't know you mean a different instance of a certain method that you are testing (or similar). Therefore, the second test always fails.

In cases where you use the same method more than once, you should use the "at" declaration with the proper count where executed in the code. This way PHPUnit knows which one you mean, and can fulfill the expectation/assertion properly.

The following is a generic example where method 'run' is used several times:

```
public function testRunUsingAt()
    {
        $test = $this->getMock('Dummy');

        $test->expects($this->at(0))
            ->method('run')
            ->with('f', 'o', 'o')
            ->will($this->returnValue('first'));

        $test->expects($this->at(1))
            ->method('run')
            ->with('b', 'a', 'r')
            ->will($this->returnValue('second'));

        $test->expects($this->at(2))
            ->method('run')
            ->with('l', 'o', 'l')
            ->will($this->returnValue('third'));

        $this->assertEquals($test->run('f', 'o', 'o'), 'first');
        $this->assertEquals($test->run('b', 'a', 'r'), 'second');
        $this->assertEquals($test->run('l', 'o', 'l'), 'third');
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-17T23:18:31.043

您是否尝试在执行测试后调用 $view->Dispose() ？我不是 vfsStream 专家，但看起来文件在测试之间会保持打开状态，如果读取后当前文件位置没有倒带，它将保留在文件末尾，导致第二次和后续测试失败.

# mysql - 我在 mysql 数据库中有 0 的 id

> ID：13895838
> 
> 赞同：1
> 
> 时间：2012-12-15T20:19:44.523
> 
> 标签：mysql, sql

在 mysql 数据库中，我有这个表：

```
CREATE TABLE `actualities` (
  `id` int(11) NOT NULL,
  `title` varchar(255) COLLATE utf8_unicode_ci DEFAULT NULL,
  `body` text COLLATE utf8_unicode_ci,
  `project_id` int(11) DEFAULT NULL,
  `created_at` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  `updated_at` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  PRIMARY KEY (`id`),
  KEY `project_id` (`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci; 
```

当我尝试在此表中创建一个新条目时，ID 设置为 0，如下所示：

```
mysql> insert into actualities (title) VALUES ('title');
Query OK, 1 row affected, 1 warning (0.13 sec)

mysql> select * from actualities order by created_at desc limit 1;
+----+-------+------+------------+---------------------+---------------------+
| id | title | body | project_id | created_at          | updated_at          |
+----+-------+------+------------+---------------------+---------------------+
|  0 | title | NULL |       NULL | 2012-12-15 20:14:20 | 0000-00-00 00:00:00 |
+----+-------+------+------------+---------------------+---------------------+ 
```

我不明白为什么。你有解决方案吗？

**解决方案**

```
ALTER TABLE actualities MODIFY id INT AUTO_INCREMENT; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-15T20:22:15.363

我想你想要的是这个：

```
`id` int(11) NOT NULL AUTO_INCREMENT 
```

如果没有这个，您需要在表中插入新数据时提供特定值，否则它将采用默认值（此处`0`）

有关[AUTO_INCREMENT的 MySQL 文档的更多信息](http://dev.mysql.com/doc/refman/5.6/en/example-auto-increment.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-15T20:22:18.687

int 字段的默认值为`NOT NULL`0。`id`是主键，因此它是`NOT NULL`一种或另一种方式。

根据您的预期行为，您可以：

1.  打开`AUTO_INCREMENT`
2.  在您的声明中包含一个`id`值。`INSERT`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-15T20:23:44.677

> 对于数字类型，默认值为 0，但使用 AUTO_INCREMENT 属性声明的整数或浮点类型除外，默认值为序列中的下一个值。

[MySQL 5.0 参考手册](http://dev.mysql.com/doc/refman/5.0/en/data-type-defaults.html)

# python - GAE/P 存储 SES 连接和线程安全

> ID：13895841
> 
> 赞同：1
> 
> 时间：2012-12-15T20:20:31.817
> 
> 标签：python, google-app-engine, amazon-web-services, thread-safety

我正在使用 Amazon 的 SES 从我的 Python Google App Engine 应用程序发送电子邮件。我想保存 SES 连接，而不是为我发送的每封电子邮件创建它。

对于多线程应用程序，这是一种合理的方法吗？：

```
SES = None

def send_email_AWS(sender, to_addresses, subject, body):
    global SES
    if not SES:
        SES = SESConnection(aws_key, aws_secret)
    [other code for sending the email] 
```

我对什么是线程安全和什么不是线程安全没有很好的理解。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:50:13.850

这是一个可以帮助您的示例：http: [//blog.notdot.net/2011/10/Migrating-to-Python-2-7-part-1-Threadsafe](http://blog.notdot.net/2011/10/Migrating-to-Python-2-7-part-1-Threadsafe)

```
class SesConnection(object):

    _SES = None
    _aws_key = ....
    _aws_secret = ....

    _ses_lock = threading.Lock()

    @classmethod
    def get_ses(cls):

        with cls._ses_lock:

            if not cls._SES:
                cls._SES = SESConnection(cls._aws_key, cls._aws_secret)  # or put the code here
            return cls._SES 
```

或使用 webapp2 应用注册表：[http ://webapp-improved.appspot.com/guide/app.html#registry](http://webapp-improved.appspot.com/guide/app.html#registry)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-23T19:12:52.350

**从您的示例中，如果**您只是**将**其视为常数， 则不会有任何问题。**您的公共变量 SES 不是线程安全**的。这意味着，例如，如果有许多用户写入该全局，那么您将始终读取发生的最后一次写入，而不是每个实例。

线程是人的图像。无法想象您的全局变量是公共 WC。线程安全有一个门（锁）。如果我们没有锁，否则每个人都会在另一个人在里面时尝试做他的工作。

对于您的示例，我看到：

```
SES = NONE 
```

这意味着您的应用程序的每个实例都将重置 SES 全局变量。不是什么好事。

```
global SES
    if not SES: 
```

Then the first request will set it again to something. But its not safe because at the same time some other request might override it. If that is not a problem then its ok. What you need is to create it locally per request handler if that is the intention to be thread safe.

Answer by @voscausa shows you a good implementation example. Check it out

# javascript - 编程新手，变量/数组

> ID：13895842
> 
> 赞同：1
> 
> 时间：2012-12-15T20:20:43.767
> 
> 标签：javascript, arrays, variables

```
 function A(a, b) {
     return a[b] * b;
   }
  function B(a) {

     var x = 0;
     for (var i=5; i>0; i--)
     x += A(a, i);

     return x;
  }
      var aValues = [3,5,9,8,7,1];
      var y = B(aValues); 
```

答案会是： B(1) B(3) B(5) B(7) B(8) B(9) 吗？我迷失在正确的方向上的任何推动将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:39:56.687

执行后 y 为 80。完整的数组被传递给`B()`. 中的循环`B()`迭代`aValues`. Javascript 中的数组从索引 0 开始，因此循环`i=5; i>0; i--`永远不会触及索引为 0 的数组元素

函数`a()`然后将当前项与当前索引相乘并返回结果（与 x 相加）

因此，对于您获得的每个循环索引：

```
i=5 -> x += 1 * 5
i=4 -> x += 7 * 4
i=3 -> x += 8 * 3
i=2 -> x += 9 * 2
i=1 -> x += 5 * 1 
```

所以在循环之后 x 包含返回并分配给 y 的值 80

# jquery - jqGrid 导出数据 AJAX

> ID：13895845
> 
> 赞同：0
> 
> 时间：2012-12-15T20:20:54.297
> 
> 标签：jquery, jqgrid

我正在尝试从网格中导出所有数据。我写了一个函数来完成所有的导出到excel。我只需要从网格中获取数据。

我有它使用：

```
$("#grid").jqGrid('excelExport',{"url":"gridExport.php"}); 
```

我有一个运行它的 jquery click 函数，它可以工作，但它会重定向 gridExport.php。我试图在不移动页面的情况下打开它。

我试图将我自己的 jquery post 函数写入 gridExport.php，但我没有从网格中获得我需要的所有参数。我假设我可以手动获取我需要的所有参数并将它们发送到 gridExport.php 但我不是 100% 如何做到这一点和/或是否有更简单的方法来做到这一点。

对此的任何帮助都会很棒。

谢谢！

**更新：**

我想出了一种方法来完成这项工作。我只是使用了我自己的 jquery post 函数，并从网格中获取了我需要的参数，并通过 post 函数将其传递到我的处理页面。我只需要 postData 和 colModel 形成我的网格。这就是我获取参数并将它们放入 JS 变量的方式：

```
 var gParam = $("#grid").jqGrid('getGridParam','postData');
        var gParamCol = $("#grid").jqGrid('getGridParam','colModel'); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-16T18:17:56.443

我想出了一种方法来完成这项工作。我只是使用了我自己的 jquery post 函数，并从网格中获取了我需要的参数，并通过 post 函数将其传递到我的处理页面。我只需要 postData 和 colModel 形成我的网格。这就是我获取参数并将它们放入 JS 变量的方式：

```
 var gParam = $("#grid").jqGrid('getGridParam','postData');
    var gParamCol = $("#grid").jqGrid('getGridParam','colModel'); 
```

# c# - Dwolla OAuth 提供无效的客户端 ID

> ID：13895849
> 
> 赞同：0
> 
> 时间：2012-12-15T20:21:03.770
> 
> 标签：c#, dwolla

我正在尝试使用 Dwolla OAuth 功能，因此我将用户发送到以下网址：

**https://www.dwolla.com/oauth/v2/authenticate?client_id=mydwollakey&response_type=code&redirect_uri=http://localhost//Payment/OAuthResponse&scope=send%7Ctransactions**

我第一次将它们发送到那里时，它会将它们带到 Dwolla 登录页面。一旦他们输入他们的用户名和密码并单击登录，它会为他们提供：

**我们无法使用 Dwolla 对您进行身份验证：access_denied 无效的客户端 ID。**

客户端 ID 是我的 Dwolla 密钥，我确信它是有效的，因为我可以用它（注册用户）进行另一个呼叫。

之后，每次他们返回该 url 时，它不再将他们带到登录页面，它返回“我们无法使用 Dwolla 对您进行身份验证：access_denied - 无效的客户端 ID。” 马上。

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T17:53:32.907

问题最终是我的 dwolla 键中有一个 / 和 +，我需要在将它传递到查询字符串之前对其进行 UrlEncode。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T21:51:40.010

验证您的密钥是否与正确的权限相关联。我相信 OAuth2 将此称为“范围”。

# javascript - jqGrid - 根据数据值过滤行

> ID：13895859
> 
> 赞同：1
> 
> 时间：2012-12-15T20:22:04.107
> 
> 标签：javascript, jquery, jqgrid

我想根据某些单元格值过滤我的 jqGrid。例如，如果我有一个名为“相关性”的列，一个从 0 到 10 的积分，我只想显示相关性 > 5 的行。这可能与 jqGrid 有关吗？

我不希望用户必须搜索相关性 > 5 的值——我希望表格从一开始就以这种方式加载。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T21:10:45.140

您需要为您需要的过滤器设置`filters`选项，设置jqGrid 和触发器的选项。在[答案中](https://stackoverflow.com/a/5273385/315935)，您将找到相应的代码示例。`postData``search: true``"reloadGrid"`

# c# - 将数据集绑定到仅显示 1 条记录的列表框

> ID：13895860
> 
> 赞同：1
> 
> 时间：2012-12-15T20:22:06.807
> 
> 标签：c#, wpf, mvvm, binding, listbox

我有基于 MVVM 的 WPF 项目。在我看来，我有下一个 ListBox

```
<ListBox BorderBrush="#6797c8" BorderThickness="2" 
    ItemsSource="{Binding  Path=CategoriesDS}" 
    DisplayMemberPath="MainCategories/Category"/> 
```

这是我在 ViewModel 的代码：

```
private DataSet categoriesDS;

public DataSet CategoriesDS
{
    get
    {
        if (categoriesDS == null)
        {
            categoriesDS = _dal.GetCategoriesTables();
        }
        return categoriesDS;
    }
    set
    {
        categoriesDS = value;
        if (this.PropertyChanged != null)
        {
            this.PropertyChanged(this,
                  new PropertyChangedEventArgs("CategoriesDS"));
        }
    }
} 
```

我的数据集包含 2 个表，第一个表（“MainCategories”）包含 3 行。当我运行我的应用程序时，我只看到“MainCategories”表的第一行。

为什么 ListBox 只显示 1 行？我想显示整个表格。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:50:20.077

您需要直接绑定到表。您可以创建另一个仅访问该属性的`CategoriesDS`属性，然后绑定新属性：

```
public DataView MainCategories 
{ 
  get { return CategoriesDS.MainCategories.DefaultView; } 
} 
```

或者

```
public DataView MainCategories 
{ 
  get { return CategoriesDS.Tables[0].DefaultView; } 
} 
```

**XAML**

```
<ListBox BorderBrush="#6797c8" BorderThickness="2" 
    ItemsSource="{Binding  Path=MainCategories}" 
    DisplayMemberPath="Category"/> 
```

# java - Java 连接池 - 垃圾收集或调用 close()？

> ID：13895865
> 
> 赞同：2
> 
> 时间：2012-12-15T20:22:35.030
> 
> 标签：java, connection-pooling

我担心我在理解 Java 中的连接池方面存在一个基本问题。

我使用 IDBCDataSource 作为连接池。在我的应用程序的入口点，我实例化了一个 BasicDataSource，例如 setMaxActive=50。然后将该 DataSource 的实例传递给某些业务逻辑使用的各种 DAO。

每个 DAO 调用 getConnection()，但没有调用单个 close()。我的假设是，在不使用 DAO 后，垃圾收集器会关闭连接。

我的问题是我不断地用完连接（即等待可用连接的代码）。

现在假设我将在每个数据库操作结束时添加一个 close() 调用。抛出的异常会发生什么。我必须捕获 DAO 中的每个异常，确保关闭连接，然后重新抛出发生的异常！

**示例**- 当前方法：

```
public class MyDAO {
     private Connection con;

     public MyDAO (DataSource ds) {
          con = ds.getConnection();     
     }     

     public MyReturnClass execSomeQuery() throws SQLException {
          String sql = String.format("SELECT * FROM foo");
          PreparedStatement ps = con.prepareStatement(sql);
          ResultSet rs = ps.executeQuery();

          while (rs.next()) {
               …     
               ...
          }          

          return result;
     }
}

public class MyAppLogic() {
     DataSource ds; 

     public MyAppLogic(DataSource ds) {
          this.ds = ds;
     }

     public void doSomeStuff() {
          MyDAO myDAO = MyDAO(ds);
          myDAO.execSomeQuery();
     }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:24:45.447

您需要`close`连接，以便它们在连接池中返回。GC 不会关闭您的连接！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:45:31.030

您可以创建一个管理连接的包装器或父类，这样您就不必在每个方法中复制逻辑。这是一个示例（请注意，我实际上并没有编译或测试过这个）。

```
public interface DAOClass {
    public void execSomeQuery() throws SQLException;
}

public class MyDAOWrapper {
    private DAOClass dao;
    private DataSource ds;

    public MyDAOWrapper(DataSource ds, DAOClass dao) {
        this.dao = dao;
        this.ds = ds;
    }

    public void exec() throws SQLException {
        Connection con = ds.getConnection();
        try {
            dao.execSomeQuery();
        }
        finally {
            con.close();
        }
    }

}

// usage
    public void doSomeStuff() throws SQLException {
        MyDAOWrapper dao = new MyDAOWrapper(ds, new MyDAO());
        dao.exec();
    } 
```

关于错误处理，除非您捕获它，否则您不需要重新抛出异常。您的`finally`子句应关闭连接（如果存在），当连接退出时，异常将继续传播。

```
try {
  do_something();
}
finally {
  cleanup();
  // throw is not necessary
} 
```

# java - 为什么 writeObject 会抛出 java.io.NotSerializableException，我该如何解决？

> ID：13895867
> 
> 赞同：125
> 
> 时间：2012-12-15T20:22:40.853
> 
> 标签：java, exception, serialization, notserializableexception

我有这个异常，我不明白为什么会抛出它，或者我应该如何处理它。

```
try {
    os.writeObject(element);
} catch (IOException e) {
    e.printStackTrace();
} 
```

哪里`element`是`TransformGroup`包含其他一些`TransformGroups`类 Atom 的实例：

```
public class Atom extends Group implements Serializable{
    float pozX,pozY;
    Group group= new Group();   
    Color3f blue = new Color3f(new Color(255));
    Color3f black = new Color3f(new Color(0));
    Sphere AtSph=new Sphere();

    public Atom(final float WEIGHT, final int BOUNDS,final float radius,Color3f color)
    {
        AppSetting ap= new AppSetting(color, black);
        AtSph=new Sphere(radius,1,100,ap);
    }
} 
```

完整的错误日志：

```
java.io.NotSerializableException: javax.media.j3d.TransformGroup
    at java.io.ObjectOutputStream.writeObject0(Unknown Source)
    at java.io.ObjectOutputStream.writeObject(Unknown Source)
    at cls.MolecularBuilder.addAtom(MolecularBuilder.java:511)
    at cls.MolecularBuilder$Console.HidrogenItemActionPerformed(MolecularBuilder.java:897)
    at cls.MolecularBuilder$Console$2.actionPerformed(MolecularBuilder.java:746)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.AbstractButton.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEventImpl(Unknown Source)
    at java.awt.EventQueue.access$200(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.awt.EventQueue$3.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.awt.EventQueue$4.run(Unknown Source)
    at java.security.AccessController.doPrivileged(Native Method)
    at java.security.ProtectionDomain$1.doIntersectionPrivilege(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source) 
```

`AppSetting`（在 Atom 类中）只是一个扩展 Appearance 的自定义类。

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2012-12-15T20:26:14.717

您的对象的字段依次具有它们的字段，其中一些不实现`Serializable`. 在你的情况下，违规类是`TransformGroup`. 如何解决？

*   如果这门课是你的，那就去做吧`Serializable`
*   如果该类是第 3 方，但您不需要序列化形式，则将该字段标记为`transient`
*   如果您需要它的数据并且它是第三方的，请考虑其他序列化方式，例如 JSON、XML、BSON、[MessagePack](https://msgpack.org/index.html)等，您可以在不修改其定义的情况下序列化第 3 方对象。

* * *

## 回答 #2

> 赞同：86
> 
> 时间：2015-01-22T03:37:25.697

`java.io.NotSerializableException`**序列化内部类实例**时可能会发生，因为：

> 序列化这样的内部类实例也将导致其关联的外部类实例的序列化
> 
> ****强烈建议不要****序列化内部类**（即不是静态成员类的嵌套类），包括本地和匿名类**

 ****参考：[可序列化接口](http://docs.oracle.com/javase/8/docs/platform/serialization/spec/serial-arch.html#a4539)

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2014-01-07T12:28:35.247

通过实现接口使类可序列化`java.io.Serializable`。

*   `java.io.Serializable`- 没有任何方法的标记接口。
*   标记接口的目的 - 告诉`ObjectOutputStream`这个对象是一个可序列化的对象。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-03-19T12:53:44.433

如上所述，如果该类是第 3 方类，则需要将其转换为 JSON/XML/BSON 对象，因为第 3 方类对象无法序列化。

我正在研究我的项目并且遇到了同样的问题，我使用 gson 库将我的类对象转换为 JSON 字符串。之后，我在该对象中使用了这个字符串，并通过 ObjectOutputStream 对象传递了它。在客户端，我使用相同的方法将 JSON 字符串恢复为第 3 方类对象。

您可以从这里下载 jar：[https](https://jar-download.com/artifacts/com.google.code.gson/gson/2.8.2/source-code) ://jar-download.com/artifacts/com.google.code.gson/gson/2.8.2/source-code ！

我是这样做的：

```
// Method that returns String through a Object as a parameter i.e to be converted

 public static String  generateJSONStringFromObject(ThirdPartyClass object) throws JsonProcessingException{
            ObjectMapper mapper = new ObjectMapper();
            mapper.setVisibility(PropertyAccessor.FIELD, Visibility.ANY);
            String jsonString = mapper.writeValueAsString(object);

                return jsonString;
        }

// Method that returns Object through a String as a parameter 

 public static ThirdPartyClass generateObjectFromJSONString(String jsonString){
            Gson gson = new Gson();
            ThirdPartyClass thirdPartyClassObject = gson.fromJson(jsonString, ThirdPartyClass.class);
            return thirdPartyClassObject;
        } 
```****

# xml - 在 Asp.NET MVC 中将 XSLT 应用于 XML

> ID：13895874
> 
> 赞同：0
> 
> 时间：2012-12-15T20:23:48.583
> 
> 标签：xml, asp.net-mvc, xslt

我使用自定义 ActionResult 从控制器 Action 返回 XML：

```
 public class XmlActionResult : ActionResult
{
    /// <summary>
    /// This class is a custom ActionResult that outputs the content of an XML document to the response stream
    /// </summary>

    private readonly XDocument _document;
    public Formatting Formatting { get; set; }
    public string MimeType { get; set; }

    public XmlActionResult(XDocument document)
    {
        _document = document;
        MimeType = "text/xml";
        Formatting = Formatting.None;

    }

    public override void ExecuteResult(ControllerContext context)
    {
       context.HttpContext.Response.Clear();
       context.HttpContext.Response.ContentType = MimeType;

       using(var writer = new XmlTextWriter(context.HttpContext.Response.OutputStream, null)
           {
               Formatting = Formatting

           })

        _document.WriteTo(writer);
    }
} 
```

这会将 XML 树输出到浏览器。我有一个转换 XML 的 XSL 文件，如何将样式表应用于 XML 输出？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-16T12:40:24.013

[用于`XslCompiledTransform`应用任何 XSLT 1.0 样式表](http://msdn.microsoft.com/en-us/library/0610k0w4.aspx)或使用第三方 XSLT 2.0 处理器（如 Saxon 9 或 XmlPrime）应用任何 XSLT 2.0 样式表。

您可以通过调用扩展方法将您的 XDocument 作为`Transform`方法的第一个参数传递，例如`XslCompiledTransform``CreateNavigator`

```
XslCompiledTransform proc = new XslCompiledTransform();
proc.Load("sheet.xsl");
poc.Transform(_document.CreateNavigator(), null, context.HttpContext.Response.OutputStream); 
```

要使用扩展方法，您需要一个`using System.Xml.XPath;`指令。并且根据转换结果（例如，对于内容类型 text/html 是 HTML 还是对于内容类型 application/xhtml+xml 或其他格式的 XHTML），您可能希望更改发送到浏览器的 ContentType，以便转换结果被适当地解析和呈现。

# mongodb - 获取时对集合中的文档进行排序

> ID：13895876
> 
> 赞同：3
> 
> 时间：2012-12-15T20:23:51.123
> 
> 标签：mongodb, mongodb-java, spring-data-mongodb

我在 MongoDB 有一个名为 resource 的集合。它有以下文件：

```
{ "_id" : "Abb.e", "_class" : "Resource", "resourceEmail" : "test1@test.com" }
{ "_id" : "Dasd.tt", "_class" : "Resource","resourceEmail" : "test2@test.com" }
{ "_id" : "Bbb.rr", "_class" : "Resource", "resourceEmail" : "test3@test.com" } 
```

在 Java 代码中，我将它们列出如下：

```
 MongoOperations mongoOperations = mongoConfiguration.getMongoTemplate();
  List<Resource> resourceList = mongoOperations.findAll(Resource.class);
  return resourceList; 
```

我如何获取这些按 ID 排序的文档！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-16T18:19:14.237

当您使用 Spring Data 时，您可以使用 Query 对象来查询集合中的所有文档并对结果进行排序。

```
MongoOperations mongoOperations = mongoConfiguration.getMongoTemplate();
Query q = new Query().with(new Sort(Sort.Direction.ASC, "_id"));
List<Resource> resourceList = mongoOperations.find(q, Resource.class);
return resourceList; 
```

当然，您可以迭代结果列表并手动对其进行排序，甚至可以使用 Collection.sort 方法，但我认为如果您在用于排序的属性中有索引，那么 mongodb 对结果进行排序会更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:55:09.930

应该是这样的：

```
 MongoOperations mongoOperations = mongoConfiguration.getMongoTemplate();
  List<Resource> resourceList = mongoOperations.findAll(Resource.class).sort({'_id' : 1});
  return resourceList; 
```

您需要附加`.sort({'_id' : 1})`升序或`.sort({'_id' : -1})`降序。

* * *

对于 Java：

```
.sort( new BasicDBObject( "_id" , 1 ) ) 
```

* * *

来自*echo*的解决方案：

```
DBCursor dbCursor = mongoOperations.getCollection(RESOURCE_COLLECTION_NAME).find().sort(new BasicDBObject("_id", 1)); 
List<DBObject> dbObjects = dbCursor.toArray(); 
List<Map> items = new ArrayList<Map>(dbCursor.length()); 
for (DBObject dbObject : dbObjects) { 
 Map map = dbObject.toMap(); 
 items.add(dbObject.toMap()); 
} 
```

# objective-c - Xcode：窗口动画

> ID：13895881
> 
> 赞同：2
> 
> 时间：2012-12-15T20:24:16.287
> 
> 标签：objective-c, xcode, cocoa, animation, window

我想知道如何让一个窗口在打开时像 Xcode 那样“增长”......（当然我正在使用 Xcode 来制作那个窗口，而且我在 Mountain Lion 上）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:35:08.877

对于初学者来说，请看这里：[https ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSViewAnimation_Class/Reference/Reference.html](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/ApplicationKit/Classes/NSViewAnimation_Class/Reference/Reference.html)

NSView动画。尽管它的名字，它也适用于 Windows。

你也可以看这里：[http ://cocoadev.com/wiki/AnimatedWindowOpening](http://cocoadev.com/wiki/AnimatedWindowOpening)

编辑

我还没有尝试过，但它看起来很有希望。`animationResizeTime:`NSWindow 的一部分，我相信应该改变动画时间。现在，我假设所有窗口实际上都有这个动画，我在某处读到它确实有这个动画，但是 Xcode 已经延长了时间。也许 0.2 秒还不够。

这可能只有在你使用它时才有效：[https ://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindow /setFrame：显示：动画](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSWindow_Class/Reference/Reference.html#//apple_ref/occ/instm/NSWindow/setFrame:display:animate)：

祝你好运。

**编辑**

根据 CodaFi，您可以在 Interface Builder 中简单地使用它。选择您的窗口并更改此设置。但是，我似乎无法做到这一点。因此，我的想法已经不多了。你也可以看看这个，虽然不完全是你提到的，它可能会指导正确的方法：[Resize NSWindows with easing animation](https://stackoverflow.com/questions/6225398/resize-nswindows-with-easing-animation)

![解决方案](../Images/31384b8456e64ae9e3c1f9c785be8809.png)

# java - HTC android应用逆向工程期间

> ID：13895887
> 
> 赞同：2
> 
> 时间：2012-12-15T20:25:06.020
> 
> 标签：java, android, reverse-engineering, dex2jar

我正在尝试使用[dex2jar](http://code.google.com/p/dex2jar/)和[apk-tools](http://code.google.com/p/android-apktool/)解码 htc 的消息传递应用程序的 apk 文件。我完美地反转了30多个应用程序，没有任何麻烦！但我不能用 htc 的应用程序做同样的事情！谁能帮我摆脱这个问题？

问题1（dex2jar解码时）：

![在此处输入图像描述](../Images/2ee1a936b176c1dc5b158af9da825f84.png)

> 注意：我也使用了 dex2jar Mms.apk 但 d2j-dex2jar Mms.apk 更可取。

问题 2（获取资源 appk-tool 时）：

![在此处输入图像描述](../Images/f1a7f47d9d5263364ddd23ef72af2e34.png)

> 我知道我需要添加 com.htc.resource.apk 框架但不知道该怎么做！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-16T13:07:31.850

您正在尝试解压缩系统应用程序。`classes.dex`文件从系统应用程序中提取并保存为优化`ODEX`文件。[你可以从这里](http://www.alliance-rom.com/community/wiki/odex-and-deodex/)阅读更多

因此，在使用`dex2jar`这些 APK 之前，您应该将`ODEX`文件转换回`DEX`APK 并将它们放入 APK。或者你可以只`dex2jar`在转换后的`DEX`文件上使用..

# php - PDO 对象为空

> ID：13895888
> 
> 赞同：0
> 
> 时间：2012-12-15T20:25:06.337
> 
> 标签：php, pdo

这是我的代码：

```
class DB {
static $instance;

function get() {
    if (self::$instance === null) {
        self::$instance = new PDO('mysql:host=localhost;dbname=forum', 'root', 'root');
    }
    return self::$instance;
}

function getAllUsers() {
    $users = array();
    $sql = "SELECT * FROM users";
    foreach (self::get()->query($sql) as $row) {
        $users[] = new User($row);
    }
    return $users;    
}
} 
```

现在我在这里调用 getAllUsers 函数：

```
class App {
function showUsers() {
    $users = DB::getAllUsers();
} 
```

除了它给我一个错误：

> 警告：为 foreach() 提供的参数无效

当我在做`var_dump`我`self::get`得到一个`bool(false)`

有人可以告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-15T20:55:57.537

[PDO::query](http://php.net/pdo.query)仅在成功将查询发送到数据库并返回有效响应（即驱动程序没有返回 SQL 错误）**时才**返回[PDOStatement](http://php.net/pdostatement)对象。但是，如果它失败，它将返回。因此*，您必须对此进行检查才能处理错误*。此外，您可以选择将[PDO 置于异常模式](http://php.net/manual/en/pdo.error-handling.php)，使其在遇到错误时抛出异常。这样，您可以在调用 PDO 对象时使用 try/catch 来处理错误。请参阅下面的示例...**`false`**

 *****使用 PDO 的默认错误模式（静默）：**

```
if ($result = self::get()->query($sql)) {
    /* Iterate here */
    foreach ($result as $row) {
        /* Do whatever you want with $row */
    }
} else {
    /* Handle errors here */
    echo "There was an error with the query!";
    var_dump(self::get()->errorInfo());
} 
```

**在异常模式下使用 PDO：**

```
/* Put PDO Into Exception Mode */
self::get()->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
try {
    foreach (self::get()->query($sql) as $row) {
        /* Do whatever you want with $row */
    }
} catch(PDOException $e) {
    /* If PDO fails we handle it here */
    echo "Your query failed: " . $e->getMessage();
} 
```***

# python - 导入 nltk 时 Flask WSGI 应用程序挂起

> ID：13895889
> 
> 赞同：7
> 
> 时间：2012-12-15T20:25:22.407
> 
> 标签：python, flask, wsgi, nltk

我按照[此处](https://beagle.whoi.edu/redmine/projects/ibt/wiki/Deploying_Flask_Apps_with_Apache_and_Mod_WSGI)的说明创建了一个使用 ubuntu 上的 mod-wsgi 部署到 apache2 的 onefile flask-app。使用原始烧瓶应用程序时一切正常。但是，将*import nltk*添加到烧瓶应用程序时，apache 挂起（没有 500）。

我使用 python 2.7 和 nltk 2.0.4

[其他人](https://stackoverflow.com/questions/4236045/django-apache-mod-wsgi-hangs-on-importing-a-python-module-from-so-file)似乎对其他软件包也有类似的问题。环境

```
WSGIApplicationGroup %{GLOBAL} 
```

在 VirtualHost 配置中似乎有所帮助。但是，我仍然得到相同的行为。有人遇到同样的问题吗？谢谢您的帮助！

这是虚拟主机配置文件：

```
<VirtualHost *:8080>

    # ---- Configure VirtualHost Defaults ----

    ServerAdmin jsmith@whoi.edu 

    DocumentRoot /home/bitnami/public_html/http

    <Directory />
            Options FollowSymLinks
            AllowOverride None
    </Directory>

    <Directory /home/bitnami/public_html/http/>
            Options Indexes FollowSymLinks MultiViews
            AllowOverride None
            Order allow,deny
            Allow from all
    </Directory>

    # ---- Configure WSGI Listener(s) ----

    WSGIDaemonProcess flaskapp user=www-data group=www-data processes=1 threads=5
    WSGIScriptAlias /flasktest1 /home/bitnami/public_html/wsgi/flasktest1.wsgi 

    <Directory /home/bitnami/public_html/http/flasktest1>
            WSGIProcessGroup flaskapp
            WSGIApplicationGroup %{GLOBAL}
            Order deny,allow
            Allow from all
    </Directory>

    # ---- Configure Logging ----

ErrorLog /home/bitnami/public_html/logs/error.log
LogLevel warn
CustomLog /home/bitnami/public_html/logs/access.log combined 
```

这是修改后的烧瓶代码

```
#!/usr/bin/python
from flask import Flask

import nltk
app = Flask(__name__)
@app.route('/')
def home():
    return """<html>
    <h2>Hello from Test Application 1</h2>
    </html>"""

@app.route('/<foo>')
def foo(foo):
    return """<html>
    <h2>Test Application 1</2>
    <h3>/%s</h3>
    </html>""" % foo

if __name__ == '__main__':
    "Are we in the __main__ scope? Start test server."
    app.run(host='0.0.0.0',port=5000,debug=True) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-15T23:27:25.797

你在哪里：

```
<Directory /home/bitnami/public_html/http/flasktest1>
        WSGIProcessGroup flaskapp
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
</Directory> 
```

它应该是：

```
<Directory /home/bitnami/public_html/http>
        WSGIProcessGroup flaskapp
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
</Directory> 
```

因为由于指令位于错误的上下文中，您既没有在守护进程模式下运行应用程序，也没有在主解释器中运行应用程序。

然后，该目录指令与上面相同目录的指令冲突，因此将它们合并。

如果使用 mod_wsgi 3.0 或更高版本，则可能会删除第二个 Directory 块并使用：

```
WSGIDaemonProcess flaskapp threads=5
WSGIScriptAlias /flasktest1 /home/bitnami/public_html/wsgi/flasktest1.wsgi process-group=flaskapp application-group=%{GLOBAL} 
```

请注意， processes=1 已被删除，因为这是默认设置，并且设置它意味着您可能不想要的其他内容。您也不需要设置用户/组，因为无论如何它都会自动以 Apache 用户身份运行。

# objective-c - NSMutableArray 使用内存优化排序和分组

> ID：13895891
> 
> 赞同：1
> 
> 时间：2012-12-15T20:25:59.860
> 
> 标签：objective-c, ios, memory, nsmutablearray, nsarray

NSArray 里面有 ItemObject。这个 ItemObject 不是基于 ItemID 分组的

json 的示例如下所示：您会注意到 itemIDs "a123","a124"。可以有 n 个 itemID。

```
[
    {
        "ItemName": "John",
        "ItemID": "a123"
    },
    {
        "ItemName": "Mary",
        "ItemID": "a124"
    },
    {
        "ItemName": "Larry",
        "ItemID": "a123"
    },
    {
        "ItemName": "Michel",
        "ItemID": "a123"
    },
    {
        "ItemName": "Jay",
        "ItemID": "a124"
    }
] 
```

上面的响应存储在 NSArray 中，如下所示：

```
NSMutableArray *itemArray=[[NSMutableArray alloc] init];

ItemObject *obj=[[ItemObject alloc] init];
obj.itemName=@"John";
obj.itemID=@"a123";
[itemArray addObject:obj]

.....

ItemObject *objN=[[ItemObject alloc] init];
objN.itemName=@"Jay";
objN.itemID=@"a124";
[itemArray addObject:objN]. 
```

这表明，如果 JSON 中有 N 个项目，那么它将创建一个包含 N 个项目的数组。

上述项目在 UItableView 中正确显示。

现在，如果想对它们进行排序并按组将它们放入 NSMutableArray 组中，那么编码它的最佳方法是什么，消耗的内存占用更少。[即排序+分组]我试图实现以下目标：

```
NSMutableArray *itemArray=[[NSMutableArray alloc] init];
at index 0: NSArray with itemID "a123"
at index 1: NSArray with itemID "a124" 
```

由于可用的 ItemId 是动态的，正如我解释的那样，可能有“N”个 itemId。

第 1 步：所以，我首先需要找到可用的 itemId。

第2步：

```
NSMutableArray *myArray=[[NSMutableArray alloc] init];
for(NSString *itemID in itemIDS){
 NSArray *itemsForID=[itemArray filterUsingPredicate:[NSPredicate predicateWithFormat:"itemID MATCHES %@",itemID]];
[myArray addObject:itemsForID];
} 
```

myArray 是预期的结果。但是使用 filterUsingPredicate "N" 次会耗费时间和内存。

任何，帮助赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:39:38.650

你能试试下面的代码吗？

```
NSSortDescriptor *descriptor = [[NSSortDescriptor alloc] initWithKey:@"itemID"  ascending:YES];
[itemArray sortedArrayUsingDescriptors:[NSArray arrayWithObjects:descriptor,nil]]; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T21:13:48.293

您可以将数据保存为 NSManagedObjects。然后你可以使用[NSFetchedResultsController](http://developer.apple.com/library/ios/#documentation/CoreData/Reference/NSFetchedResultsController_Class/Reference/Reference.html)作为你的表的数据源（你设置一个排序描述符和一个节名键路径）：

```
NSFetchedResultsController *controller = [[NSFetchedResultsController alloc]
        initWithFetchRequest:fetchRequest
        managedObjectContext:context
        sectionNameKeyPath:nil
        cacheName:nil]; 
```

您还可以设置批量大小（一次从数据库中获取的最大对象数）。

希望这可以帮助！

# d3.js - d3轴方向：中心

> ID：13895895
> 
> 赞同：7
> 
> 时间：2012-12-15T20:26:34.790
> 
> 标签：d3.js

在 D3 中，如何将轴放在图表的中间或中心？[文档](https://github.com/mbostock/d3/wiki/SVG-Axes)说“只有上/下/左/右”。

我知道我的图表的尺寸，假设它是 400 像素 x 400 像素。在 Protovis 我用过

`vis.add(pv.Rule).bottom(200)`

从底部向上放置一个 200px 的轴。我怎样才能在 D3 中做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-15T20:57:23.470

您可以随心所欲地变换轴。方向仅指刻度和数字放置在哪一侧。

参见例如[http://alignedleft.com/tutorials/d3/axes/](http://alignedleft.com/tutorials/d3/axes/)

```
svg.append("g")
 .attr("class", "axis")
 .attr("transform", "translate(0," + (h - padding) + ")")
 .call(xAxis); 
```

您只需将参数更改为转换即可获得所需的任何内容。

# android - 从小部件应用打开日历

> ID：13895897
> 
> 赞同：0
> 
> 时间：2012-12-15T20:26:41.970
> 
> 标签：android, calendar

我想从我的小部件应用程序中打开一个日历（例如，谷歌日历）。我做了这样的事情：

```
 Intent intent2 = new Intent();
    //Froyo or greater 
    ComponentName cn = new ComponentName("com.google.android.calendar", "com.android.calendar.LaunchActivity");
    intent2.setComponent(cn);
    PendingIntent pendingIntent2 = PendingIntent.getActivity(context, 1,
            intent2, 0);

    updateViews.setOnClickPendingIntent(R.id.calendar, pendingIntent2); 
```

但它不起作用。有什么帮助吗？

非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-17T19:14:40.520

最后它起作用了：

```
 Intent intent2 = new Intent();
    ComponentName cn = new ComponentName("com.android.calendar",
            "com.android.calendar.LaunchActivity");
    intent2.setComponent(cn);
    PendingIntent pendingIntent2 = PendingIntent.getActivity(context, 1,
            intent2, 0);
    updateViews.setOnClickPendingIntent(R.id.calendar, pendingIntent2); 
```

在清单中：

```
 <activity
        android:name="com.android.calendar.LaunchActivity">
    </activity> 
```

# jsf - 将 bean 数据从一个 jsf facelet 发送到另一个

> ID：13895903
> 
> 赞同：1
> 
> 时间：2012-12-15T20:27:34.557
> 
> 标签：jsf

我的 jsf 应用程序中有一个表，其中包含数据库中的一些数据。我已将 id 值作为链接，我的目标是将数据从所选行传递到另一个 facelet。我怎样才能做到这一点？我拥有的href是：

```
 <td><a href="editOrDeletePage.xhtml?productid=#{product.id}">#{product.id}</a></td> 
```

所以目标是当用户单击链接时，显示editOrDeletePage，我希望editOrDeletePage“摄取”产品id，以便它知道要显示什么数据？我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:59:10.160

如果你明确地想使用静态链接，你当然可以使用某种事件监听器从目标页面读取请求参数

```
<f:event listener="#{bean.preRender}" type="preRenderView" /> 
```

并从请求中读取参数：

```
FacesContext facesContext = FacesContext.getCurrentInstance();
String productId = (String) facesContext.getExternalContext().
                              getRequestParameterMap().get("productid"); 
```

但我相信，这并不是真正的 JSF 处理导航的方式。您可能想要使用 commandLink 或其他处理用户操作的方式。或者，甚至更好的是，考虑使用数据表，用户可以在其中选择一行，然后您可以处理选择。

# android - 应用程序崩溃并在线程中显示错误（致命信号）

> ID：13895907
> 
> 赞同：4
> 
> 时间：2012-12-15T20:27:54.560
> 
> 标签：android, multithreading, android-layout, thread-synchronization

在 LogCat 中：

```
12-16 01:49:49.139: A/libc(790): Fatal signal 11 (SIGSEGV) at 0x0000000c (code=1), thread 806 (Thread-93)

12-16 01:49:49.169: A/libc(790): Fatal signal 11 (SIGSEGV) at 0x0000000c (code=1), thread 824 (Thread-112) 
```

我写了一个代码，用于在单击按钮时逐个创建线程。它会切换到多个屏幕。当我多次点击按钮时，我的应用程序会自动关闭，如何解决此问题？

# jquery - 如何使用 imagemapster 插件使（可动态调整大小的）图像地图居中

> ID：13895912
> 
> 赞同：2
> 
> 时间：2012-12-15T20:28:43.733
> 
> 标签：jquery, imagemapster

我正在使用 JQuery-plugin [imagemapster](http://www.outsharked.com/imagemapster/)和来自 jsfiddle [http://jsfiddle.net/jamietre/jQG48](http://jsfiddle.net/jamietre/jQG48)的作者示例的代码我能够动态调整我的 imagemap 的大小。现在我试图在我的页面上水平居中我的图像地图，但我无法让它工作。到目前为止我已经尝试过：添加 CSS 样式`margin-left:auto` 和`margin-right:auto`我的图像标签。

任何帮助/提示？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:51:49.610

**解决方案 0**

我能够更新 imagemapster 作者的示例并获得所需的结果。

**CSS**

```
#mapster_wrap_0 {
    margin: 0 auto;
} 
```

示例：http: [//jsfiddle.net/jQG48/399/](http://jsfiddle.net/jQG48/399/)。

`​mapster_wrap_0`看起来是自动生成的，所以可能有一种更简洁的方法来完成这种居中。

**解决方案 1**

在您的地图周围创建一个包装器 div 似乎也可以工作。

```
<div id="MapWrapper" style="margin:auto; width:75%;">
    <img src="https://github.com/jamietre/ImageMapster/raw/master/examples/images/usa_map_720.png" 
usemap="#usa">
</div> 
```

示例：http: [//jsfiddle.net/jQG48/400/](http://jsfiddle.net/jQG48/400/)。

# autohotkey - ahk sendinput 在按钮单击时有效，但在 ^Down 时无效

> ID：13895913
> 
> 赞同：0
> 
> 时间：2012-12-15T20:28:53.577
> 
> 标签：autohotkey

使用 Autohotkey，谁能解释为什么这不起作用？

```
 ^Down::
        Gosub, Close
    return

    Close:
        MsgBox CLOOOOSE
        GuiControlGet, editText,, MyEdit
        WinMinimize TemplateEngine
        SendInput, {raw}%editText%
        MsgBox CLOOOOSE
    return 
```

当我使用按钮时

```
Gui, Add, Button, gClose x30 y44, Close 
```

这行得通，并且 SendInput 做我想要的。

如果我使用 ^Down (CTRL + Arrow Down) SendInput 不会做任何事情

我也试过这个

```
^Down::
Close:
    MsgBox CLOOOOSE
    GuiControlGet, editText,, MyEdit
    WinMinimize TemplateEngine
    SendInput, {raw}%editText%
    MsgBox CLOOOOSE
 return 
```

为什么按钮单击和热键最终会产生不同的结果，即使它们调用相同的操作？请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-17T18:06:37.757

我测试的是：

```
^Down::
    MsgBox, Cntrl down
    Gosub, Close
    MsgBox, Back to Cntrl Down
return

Close:
    editText=My Message
    MsgBox, CLOSE Subroutine
    SendInput, {raw}%editText%
return 
```

它会显示所有 MsgBox 警报并将 My Message 放在记事本中。不知道我能做些什么不同的事情。例程是否在 ^Down 上正确触发，但行为不同？

# php - apache mod rewrite 中的几个条件以生成自定义 URL

> ID：13895915
> 
> 赞同：0
> 
> 时间：2012-12-15T20:28:57.700
> 
> 标签：php, apache, mod-rewrite

在我的域 example.com 中，我想将所有页面文件放在根目录中，例如名为**file**。因此，例如我将*about.php*放在*文件*目录中，并希望让用户使用以下 URL 访问此页面：**example.com/about**
或例如将*用户*目录放在*文件*目录中并将*login.php*放入其中，并希望让用户通过以下方式访问它：**example.com/user/login**
事实上，我想从 URL 中删除 .php 和*文件。*

**和**

如果这些文件不存在，它应该在根目录加载一个默认文件，如*index.php 。*例如 URL example.com/blabla 应该映射到*index.php*

实际上，我想在 mod rewrite 中以上述**优先级**设置两个条件。

**注意：**当然，我应该能够在*about.php 之类的文件中使用 $_GET 之类的变量*

**更新：**总之，它应该使用这个逻辑：

```
if the URI isn't a file or directory{
    if file/URI.php is a file
        load file/URI.php
    else
        load index.php
} 
```

有人给出了使用的答案`ErrorDocument 404 index.php`，但这是一个非常糟糕的主意（现在已经删除了他的答案！）

谢谢你的帮助...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T21:53:29.027

如果可能的话，有条件的重写（如果页面存在）听起来像是一个糟糕而复杂的想法。

我会将所有内容重写`/index.php`并从那里控制所有内容：

*   如果 url 的组件指向现有页面，请使用/包含该内容；
*   如果未找到有效页面，请提供您的原始索引内容。

针对您的情况的示例重定向规则：

```
RewriteEngine on
RewriteBase /

RewriteCond %{SCRIPT_FILENAME} !-f
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteRule ^.*$ /index.php?id=$1 [QSA,L] 
```

将包含请求的路径`id`并附加来自原始查询字符串（`QSA`标志）的变量。

对于您的示例，更具体的`/user/login`是：

```
RewriteRule ^([\w-]+)/([\w-]+)$ /index.php?path=$1&file=$2 [QSA,L] 
```

*   [\w-+] ：任何单词字符（包括`_`）和`-`

# wpf - 使用 Task 与 Dispatcher 进行 ui 线程操作

> ID：13895916
> 
> 赞同：4
> 
> 时间：2012-12-15T20:28:59.120
> 
> 标签：wpf, multithreading, user-interface, task-parallel-library, dispatcher

我知道从另一个线程更新 UI 线程的技术。

所以我有这两种方法/技术，我应该使用哪一种？

使用任务：

```
var uiTask = Task.Factory.StartNew(() => {
  // change something on ui thread
  var action = theActionOnUiThread;
  if (action != null) {
    action();
  }
}, CancellationToken.None, TaskCreationOptions.None, TaskScheduler.FromCurrentSynchronizationContext()); 
```

使用调度程序：

```
Dispatcher.CurrentDispatcher.BeginInvoke(
  new Action(() => {
    // change something on ui thread
    var action = theActionOnUiThread;
    if (action != null) {
      action();
    }
  })); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T21:12:27.060

From a technical point of view I doubt there is a 'best' here. however I'd go with the dispatcher approach:

*   it makes your intent more clear, namely that you want to get something done on the main ui thread
*   you don't need to boter with all the task factory options
*   Dispatcher makes it easier to hide everything behind an interface (1) allowing easy dependency injection and unit testing

(1) see [here](http://msdn.microsoft.com/en-us/library/gg431421%28v=pandp.39%29.aspx) for example

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-17T09:03:08.053

`TaskScheduler.FromCurrentSynchronizationContext()`不保证`TaskScheduler`为 UI 线程返回一个。

实际上它有时会返回`null`，尽管这些情况很少见，并且通常涉及在本机应用程序（例如 WIX 引导程序）中启动您自己的调度程序。

所以我会说使用调度程序版本更安全。

# android - ContentProvider 使用

> ID：13895919
> 
> 赞同：2
> 
> 时间：2012-12-15T20:29:37.317
> 
> 标签：android, android-contentprovider

**仅当您需要在多个应用程序之间共享数据时才需要内容提供程序。**

这是使用它的唯一目的吗？简单地从 WS 获取数据并将其写入 CP，然后在活动中从此处读取数据怎么样？

[iosched](http://code.google.com/p/iosched/source/browse/android/src/com/google/android/apps/iosched/sync/)怎么样：这里使用 CP 来为多个应用共享一个数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:39:18.890

您只需使用数据库即可实现，但我强烈建议使用 contentprovider，即使您不打算在应用程序之间共享数据。诸如 CursorLoader（更正）之类的类直接从 contentprovider 加载数据，如果您仅使用数据库，则必须扩展此类以获得相同的性能，因此可以得出结论，这一切都是为使用 contentprovider 而设计的。

# mongodb - 使用带有 $Divide 表达式的 Mongo 聚合函数时未定义的变量

> ID：13895921
> 
> 赞同：0
> 
> 时间：2012-12-15T20:29:49.207
> 
> 标签：mongodb

在下面的 Mongodb 查询中，我的 $divide 表达式中的“正确”和“guessCount”得到了“未定义”。我该如何纠正？我的意图是返回一个标记为“准确度”的百分比，该百分比是正确猜测的总和除以猜测的数量的结果。从提供的代码中应该可以很清楚地看到这一点。

```
guessCollection.aggregate( { $group :
                     { _id : "$imageFileName",
                       correct : { $sum : "$correct" },
                       guessCount: {$sum: 1 },
                       accuracy: {$divide: [correct, guessCount]}, //guess and guessCount are undefined
                        } },
                   { $match : {guessCount : { $gte : 50 }, user: user, language: language } } ,
                   { $sort: { guessCount: -1 } }, callback) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T21:15:16.297

`$divide`是`$project`运算符，而不是`$group`运算符，因此您需要改为：

```
guessCollection.aggregate( { $group :
    { _id : "$imageFileName",
       correct : { $sum : "$correct" },
       guessCount: {$sum: 1 }
    } },
    { $match : {guessCount : { $gte : 50 }, user: user, language: language } } ,
    { $project : {
        correct: 1,
        guessCount: 1,
        accuracy: {$divide: ['$correct', '$guessCount']}
    }},
    { $sort: { guessCount: -1 } }, callback) 
```

您的下一个问题可能是您引用了`language`and`user`中的字段，`$match`因为您没有包括那些在您的字段中，`$group`因此您可能希望将该部分移动到管道的开头，如下所示：

```
guessCollection.aggregate(
    { $match : { user: user, language: language } } ,
    { $group : { 
        _id : "$imageFileName",
        correct : { $sum : "$correct" },
        guessCount: {$sum: 1 }
    } },
    { $match : {guessCount : { $gte : 50 } } } ,
    { $project : {
        correct: 1,
        guessCount: 1,
        accuracy: {$divide: ['$correct', '$guessCount']}
    }},
    { $sort: { guessCount: -1 } }, callback) 
```

# java - Java 7 无法在 mac osx 10.8.2 中运行

> ID：13895922
> 
> 赞同：-4
> 
> 时间：2012-12-15T20:30:00.710
> 
> 标签：java, macos, terminal, minecraft

我试图玩我的世界，但它甚至不会打开。几天自我我正在将我的应用程序上传到应用程序商店，但我遇到了麻烦，所以我在网站上找到了这个命令来解决问题。

```
cd /System/Library/Frameworks/JavaVM.framework/Versions
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5
sudo ln -s CurrentJDK /System/Library/Frameworks/JavaVM.framework/Versions/1.5.0 
```

但是我做了那个我的世界之后，java设置就不起作用了。我也尝试下载java并再次安装，但它仍然无法正常工作。任何人都没有如何解决这个问题？-谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T22:03:57.903

首先，如果您在 Mountain Lion 上运行所有系统更新，您应该安装 Java 6。尝试在命令行上运行此命令：

`java -version`

输出应该是

```
java version "1.6.0_37"
Java(TM) SE Runtime Environment (build 1.6.0_37-b06-434-11M3909)
Java HotSpot(TM) 64-Bit Server VM (build 20.12-b01-434, mixed mode) 
```

如果你是最新的。我认为这不是你得到的。所以试试

`ls -l /System/Library/Frameworks/JavaVM.framework/Versions`

这应该给你

```
total 64
lrwxr-xr-x  1 root  wheel   10 Oct 20 17:46 1.4 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 20 17:46 1.4.2 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 20 17:46 1.5 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 20 17:46 1.5.0 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 20 17:46 1.6 -> CurrentJDK
lrwxr-xr-x  1 root  wheel   10 Oct 20 17:46 1.6.0 -> CurrentJDK
drwxr-xr-x  8 root  wheel  272 Oct 20 17:47 A
lrwxr-xr-x  1 root  wheel    1 Oct 20 17:46 Current -> A
lrwxr-xr-x  1 root  wheel   59 Oct 20 17:46 CurrentJDK -> /System/Library/Java/JavaVirtualMachines/1.6.0.jdk/Contents 
```

同样，这表明在您运行应用程序时安装并使用了 Java 6。如果是这种情况，那么您对 ​​Minecraft 的问题就出在其他地方。

如果这些输出中的任何一个不是上面列出的，请尝试运行系统更新，如果不能修复它，请将输出与您的原始帖子一起发布到上述命令，以便我们可以为您提供帮助。

# java - 如何使用 this.getClass().getResource(String)？

> ID：13895923
> 
> 赞同：3
> 
> 时间：2012-12-15T20:30:04.060
> 
> 标签：java

我无法理解这段代码的错误。

```
public void run(String url) {

        try {
            FileInputStream file;
            file = new FileInputStream(this.getClass().getResource(url));
            Player p = new Player(file);
            p.play();
        }catch(Exception e){
            System.err.print( url + e);
        }
    } 
```

当我尝试运行它时，它说我“找不到适合 FileInputStream(URL) 的构造函数”。为什么会发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:32:25.643

利用：

*   `getClass().getResourceAsStream(classpathRelativeFile)`对于类路径资源
*   `new FileInputStream(pathtoFile)`用于文件系统资源。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-15T20:44:22.087

将文件放在类路径文件夹的根目录（`.class`生成文件的文件夹），然后使用以下语句：

```
 InputStream inputStream = 
                  getClass().getClassLoader().getResourceAsStream(filePath);
  Player p = new Player(inputStream ); 
```

这`filePath`是根文件夹的相对文件路径。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-15T20:32:00.437

使用 getResourceAsStream 更简单

```
InputStream in = getClass().getResourceAsStream(url);
Player p = new Player(file); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-15T20:43:58.103

FileInputStream 构造函数的参数是 File, String ...（参见[http://docs.oracle.com/javase/6/docs/api/java/io/FileInputStream.html](http://docs.oracle.com/javase/6/docs/api/java/io/FileInputStream.html)），但 Class.getResource 返回 URL（参见[http ://docs.oracle.com/javase/6/docs/api/java/lang/Class.html](http://docs.oracle.com/javase/6/docs/api/java/lang/Class.html)），而不是文件或字符串。尝试使用

```
public void run(String url) {

    try {
        FileInputStream file;
        file = new FileInputStream(new File(this.getClass().getResource(url).toURI()));
        Player p = new Player(file);
        p.play();
    }catch(Exception e){
        System.err.print( url + e);
    }
} 
```

# regex - 使用正则表达式复制变量文本

> ID：13895924
> 
> 赞同：0
> 
> 时间：2012-12-15T20:30:06.383
> 
> 标签：regex, notepad++, replace

（我重写了这个以使其更清楚）

我可以在 Notepad++ 中使用正则表达式来更改它吗：

```
<audio>  
<source src="audio/words/word1.mp3" type='audio/mpeg'>  
</audio>

<audio>  
<source src="audio/words/word2.mp3" type='audio/mpeg'>  
</audio> 
```

进入这个：

```
<audio>  
<source src="audio/words/word1.mp3" type='audio/mpeg'>  
<source src="audio/words/word1.mp3" type='audio/mpeg'>  
</audio>    

<audio>  
<source src="audio/words/word2.mp3" type='audio/mpeg'>  
<source src="audio/words/word2.mp3" type='audio/mpeg'>  
</audio> 
```

等等。

找到解决方案！！非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:32:42.897

搜索`(text-.)`并替换为`$1 $1`。您可以使用括号对文本序列进行分组，并且可以使用 $1、$2、... 访问这些组，其中数字是从左到右的组索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T23:52:58.453

```
^(<source.*[\n|\r])$ 
```

代替

```
$1 $1 
```

使用用户发现更新答案，以便谷歌带到这里的每个人都可以看到答案。

```
 (<source.*) >> \1 \1 
```

# c# - NLog 配置为自动记录所有异常？

> ID：13895929
> 
> 赞同：15
> 
> 时间：2012-12-15T20:30:22.487
> 
> 标签：c#, nlog

有没有办法将 NLog 配置为自动记录我的应用程序可以发送的所有异常？目前，我将访问所有 TRY/CATCH 块并在 CATCH 中手动添加日志记录 - 但如果我错过了一些怎么办？如果将来有人这样做怎么办

有没有办法告诉 NLog 总是记录所有异常？尤其是一些没有被捕获并可能导致弹出窗口的？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-15T20:58:13.160

据我所知，没有办法限制 NLog 记录所有异常。

如果您只想记录**未处理的异常**，则可以在初始化应用程序时将“UnhandledException Handler”添加到 AppDomain。请注意，在某些情况下，可能无法记录错误（例如，在 OutOfMemory 异常或某些可怕的情况下）。

请注意，AppDomain 还具有您可以订阅的**FirstChanceException 事件**，但这意味着您会收到有关发生的每个异常的通知（并且可能由用户代码处理） - 这有很多。

```
AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(AppDomain_CurrentDomain_UnhandledException);

static void AppDomain_CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
{
    // use logger here to log the events exception object
    // before the application quits
} 
```

请注意，这只允许您记录导致应用程序崩溃的异常 - 您无法阻止它崩溃（因此名称：未处理的异常）。

另一种选择是使用**面向方面的编程（AOP）** - 并在每次方法调用后引入一个日志方面，以防出现错误。如果您的应用程序使用分层架构，这可能相对容易做到（例如，为您的业务逻辑层的所有调用添加一个**方面......）。**

您可能会发现[PostSharp](http://www.sharpcrafters.com/)或[Spring.Net](http://www.springframework.net/)这样的框架很有用（通常他们的网站为此提供了一些简单的示例）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-12-22T09:41:36.167

对于**WebApi**应用程序，您可以这样`Global.asax.cs`做

```
protected void Application_Error()
{
    Exception lastException = Server.GetLastError();
    NLog.Logger logger = NLog.LogManager.GetCurrentClassLogger();
    logger.Fatal(lastException);
} 
```

[MSDN 资源](https://msdn.microsoft.com/en-us/library/24395wz3.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2021-06-01T19:17:01.320

Jacek 的回答对 WebApi 有好处。这是控制台应用程序的答案：

```
 private static readonly NLog.Logger Logger = NLog.LogManager.GetCurrentClassLogger();
    static void Main(string[] args)
    {
        AppDomain.CurrentDomain.UnhandledException += new UnhandledExceptionEventHandler(AppDomain_CurrentDomain_UnhandledException);
        Object o = SomeMethodToThrowError(); // Cause an exception
    }

    static void AppDomain_CurrentDomain_UnhandledException(object sender, UnhandledExceptionEventArgs e)
    {
        // use logger here to log the events exception object
        // before the application quits
        Exception ex = (Exception)e.ExceptionObject;
        Logger.Error(ex.Message + " " + ex.StackTrace);
    } 
```

# nginx - nginx: [emerg] 无法构建 server_names_hash，你应该增加 server_names_hash_bucket_size

> ID：13895933
> 
> 赞同：156
> 
> 时间：2012-12-15T20:30:36.350
> 
> 标签：nginx, webserver

我正在设置新服务器。我选择的 http-Server 是 NGINX。我想将域添加`audi-freunde-einbeck.de`为虚拟主机。我那里已经有 2 个其他域并且工作正常，但是当我尝试添加上述域并启动它给我的服务器时，`Job failed. See system journal and 'systemctl status' for details.` 我认为这是因为破折号，所以我尝试了带有和不带连字符的各种其他域，但没有运气。同样的错误。是什么原因造成的？我也试过重启，我真的很茫然。任何帮助将不胜感激。

我玩了一会儿发现，当我只放入一个域时，它就可以工作。但是当我放入另一个域时，它就停止了。这是状态的输出：

```
[root@netzmelone nginx]# systemctl status nginx
nginx.service - A high performance web server and a reverse proxy server
      Loaded: loaded (/usr/lib/systemd/system/nginx.service; enabled)
      Active: failed (Result: exit-code) since Sun, 16 Dec 2012 11:38:08 +0000; 7s ago
     Process: 14239 ExecStop=/usr/sbin/nginx -g pid /run/nginx.pid; -s quit (code=exited, status=1/FAILURE)
     Process: 14232 ExecStart=/usr/sbin/nginx -g pid /run/nginx.pid; daemon on; master_process on; (code=exited, status=0/SUCCESS)
     Process: 14242 ExecStartPre=/usr/sbin/nginx -t -q -g pid /run/nginx.pid; daemon on; master_process on; (code=exited, status=1/FAILURE)
    Main PID: 14234 (code=exited, status=0/SUCCESS)
      CGroup: name=systemd:/system/nginx.service

Dec 16 11:38:08 netzmelone nginx[14242]: nginx: [emerg] could not build the server_names_hash, you should increase server_names_hash_bucket_size: 32
Dec 16 11:38:08 netzmelone nginx[14242]: nginx: configuration file /etc/nginx/nginx.conf test failed 
```

* * *

## 回答 #1

> 赞同：310
> 
> 时间：2012-12-16T23:23:32.277

由于域名过长，这很可能发生。您可以通过添加来解决此问题

```
server_names_hash_bucket_size  64; 
```

在您的`http`街区顶部（可能位于`/etc/nginx/nginx.conf`）。我从 nginx 文档中引用了出现此错误时该怎么做：`In this case, the directive value should be increased to the next power of two`. 因此，在您的情况下，它应该变为 64。

如果您仍然遇到相同的错误，请尝试增加到 128 或更多。

参考： http: [//nginx.org/en/docs/http/server_names.html#optimization](http://nginx.org/en/docs/http/server_names.html#optimization)

* * *

## 回答 #2

> 赞同：50
> 
> 时间：2018-06-12T09:35:06.777

*   `/etc/nginx/nginx.conf`以写权限打开
*   取消注释或添加`server_names_hash_bucket_size 64;`
*   重启 nginx`sudo service nginx restart`

如果错误仍然存​​在：

*   增加`server_names_hash_bucket_size`步骤 128、256、512 等（每次增加 2 的幂）。例如。`server_names_hash_bucket_size 128;`
*   每次重新启动 nginx 直到错误消失（无论您已经设置了什么值，错误总是相同的）

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2018-11-16T06:39:57.967

这听起来可能有点随机，但它可能会帮助像我这样的 nginx 新手。
当我离开在线时，我得到了这个`;`错误`server_name`。

有：

```
server_name    www.mydomain.com  
access_log     /var/log/nginx/www.mydomain.com; 
```

使固定：

```
server_name    www.mydomain.com;  
access_log     /var/log/nginx/www.mydomain.com; 
```

nginx 配置文件中的所有指令必须以`;`
我经常`;`在我的文件中突出显示 s 结尾，然后保存/上传作为编辑后的最终检查。

*（为了突出显示，我使用`Find All`：）`;`*

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2020-05-24T15:53:39.703

我就是这样解决的：

```
cd /etc/nginx/

sudo nano nginx.conf 
```

*   --取消注释或添加 server_names_hash_bucket_size 64 --
*   --增加 server_names_hash_bucket_size "164" --

```
cd /etc/nginx/sites-available/

sudo nginx -t 
```

*   如果一切都好

```
sudo service nginx restart 
```

# python - 从随机的 ascii 字母和数字制作列表

> ID：13895935
> 
> 赞同：0
> 
> 时间：2012-12-15T20:30:37.847
> 
> 标签：python, string, list, random, choice

我想从随机数字和字母生成一个列表。我设法做到了：

```
def rand_num():

    while True:
        random_char= random.choice(string.ascii_letters+string.digits)

        random_lst= [random_char] 
```

但是当我想打印这个列表时，`print random_lst`我得到这样的输出：

```
['W']
['i']
['P']
['6']
['P']
['B']
['d']
['f']
['n']
['j'] 
```

代替：

`['W','i','P'`.... 等等

我应该怎么办？在这种情况下 .choice 是错误的功能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-15T20:35:38.737

试试这个长度为 10 的列表：

```
random_list = [random.choice(string.ascii_letters+string.digits) for n in xrange(10)] 
```

或者对于长度为 10 的字符串：

```
random_string = ''.join(random.choice(string.ascii_letters+string.digits) for n in xrange(10)) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-15T20:33:59.207

你应该有这个：

```
random_lst.append(random_char) 
```

# java - Eclipse xmlns:h="http://java.sun.com/jsf/html" 无法识别？

> ID：13895937
> 
> 赞同：0
> 
> 时间：2012-12-15T20:30:39.803
> 
> 标签：java, xml, jsf

我在我的 Eclipse 项目中加载 JSF 库时遇到问题。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html">
   <h:head>
      <title>#{msgs.windowTitle}</title>
   </h:head>
   <h:body>
      #{msgs.pageTitle}
      <h:form>
         <h:dataTable value="#{tableData.names}" var="name">
            <h:column>
               #{name.last},
            </h:column>

            <h:column>
               #{name.first}
            </h:column>
         </h:dataTable>
      </h:form>
   </h:body>
</html> 
```

似乎`xmlns:h="http://java.sun.com/jsf/html"`没有被识别/解决？当我在 Eclipse 中运行**index.xhtml**文件时，我得到以下输出：

```
#{msgs.pageTitle} #{name.last}, #{name.first} 
```

而不是我的类文件中的预期输出数据表。

下面是我的 faces-config.xml：

```
<?xml version="1.0"?>
<faces-config xmlns="http://java.sun.com/xml/ns/javaee" 
   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
   xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
      http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
   version="2.0">
   <application>
      <resource-bundle>
         <base-name>com.corejsf.messages</base-name>
         <var>msgs</var>
      </resource-bundle>
   </application>
</faces-config> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T23:28:09.007

问题解决了！我实际上是在运行 XHTML 文件而不是整个项目。运行整个项目完美无缺！

# c# - 试图将 zip 保存到流中

> ID：13895938
> 
> 赞同：0
> 
> 时间：2012-12-15T20:30:40.847
> 
> 标签：c#, asp.net, dotnetzip

我正在尝试将文件流保存到 Zip 流中。

编码：

```
public static MemoryStream ZipFiles(Dictionary<string, byte[]> files)
{
    var output = new MemoryStream();
    using (var zip = new ZipFile())
    {
        foreach (var file in files)
        {
            var ms = new MemoryStream(file.Value);
            ms.Seek(0, SeekOrigin.Begin);
            zip.AddEntry(file.Key, ms);
            zip.Save(output);
        }
    }
    return output;
} 
```

它正在工作，但现在在 zip.Save 的第二次循环中抛出 ZipException，并显示消息“无法将其读取为 ZipFile”。InnerException“对象引用未设置为对象的实例”。

任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:41:19.440

尝试使用下一个代码：

```
 var output = new MemoryStream();
        using (var zip = new ZipFile())
        {
            foreach (var file in files)
            {
                var ms = new MemoryStream(file.Value);
                ms.Seek(0, SeekOrigin.Begin);
                zip.AddEntry(file.Key, ms);

            }
            zip.Save(output);
        }
        return output; 
```

# android - 无法通过 Intent 在 Adob e 或 Viewer 中打开下载的 PDF

> ID：13895946
> 
> 赞同：0
> 
> 时间：2012-12-15T20:32:00.140
> 
> 标签：android, pdf

我正在尝试通过新的 Intent 打开 .pdf。意图触发并且 pdf 应用程序选择触发。当我选择任一应用程序时。该应用程序显示“无法打开文档”我正在传递 data/data/com.android.providers.downloads/cache/document.pdf 作为我怀疑是问题的 Uri。没有sd卡。pdf 将通过下载文件夹正常打开。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:35:27.110

> 我将 data/data/com.android.providers.downloads/cache/document.pdf 作为 Uri 传递

第三方应用程序无法读取该文件。

> pdf 将通过下载文件夹正常打开。

您的主要选择是将 PDF 存储在外部存储上（例如“下载文件夹”），或者创建一个`ContentProvider`可以从内部存储中提供文件的文件。[这个示例项目](https://github.com/commonsguy/cw-omnibus/tree/master/ContentProvider/Files)演示了这样一个`ContentProvider`.

# python - Python中的新闻滚动文本

> ID：13895951
> 
> 赞同：5
> 
> 时间：2012-12-15T20:32:25.490
> 
> 标签：python, scroll, news-ticker

我想编写一个小程序，从左到右显示自动滚动新闻代码文本（使用 Tkinter？），或者至少是一些 GUI。

文本应来自文本 .txt 文件。

我仍然是 Python 的初学者，无法真正掌握如何做到这一点？比如如何控制每条线的时间显示等？

调用每一行的循环是否是正确的方法？

或者你会如何处理这个问题？所有帮助/链接将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-15T21:20:06.297

这是一个使用 Tkinter 在框中滚动文本的程序。参见[1](http://www.tutorialspoint.com/python/tk_label.htm)和[2](http://effbot.org/tkinterbook/label.htm)关于`label()`; 方法见[3](http://effbot.org/tkinterbook/widget.htm)。`after()`

```
import Tkinter as tk

root = tk.Tk()
deli = 100           # milliseconds of delay per character
svar = tk.StringVar()
labl = tk.Label(root, textvariable=svar, height=10 )

def shif():
    shif.msg = shif.msg[1:] + shif.msg[0]
    svar.set(shif.msg)
    root.after(deli, shif)

shif.msg = ' Is this an alert, or what? '
shif()
labl.pack()
root.mainloop() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T21:02:54.883

到目前为止，我已经在 Python 中使用了两个不同的库：

[PyQt](http://www.riverbankcomputing.co.uk/software/pyqt/intro) - 包装了 Qt，在我看来是一个不错的 Gui 库，但是我没有像你想要的那样使用任何绝对定位，但我看不出这应该是什么主要问题。

[PyGame](http://www.pygame.org) - 正如您所猜测的，它的主要目的是游戏，但您想做的事情应该很简单。

使用您选择的库浏览几个教程，您的任务应该不会有任何问题。对于您想做的事情，我认为 PyGame 将是最简单的。

# django-views - Django.views 丢失了，为什么？没有名为 django.views 的模块

> ID：13895955
> 
> 赞同：0
> 
> 时间：2012-12-15T20:33:30.583
> 
> 标签：django-views

我的 django.views 有问题 我的代码是

模板

```
<!doctype html>
<html>
  <h1>{{userName}} twoje wycieczki : </h1>
    <a href ="">Dodaj wycieczke>></a>
</html> 
```

带有 url 标签的基本 html 模板。

我的意见.py

```
def tripList(request):
    user = request.user
    print user.username
    tList = Trip.objects.filter(userId = user.id)
    return render_to_response('tripList.html',{'userName' : user.username}, context_instance = RequestContext(request)) 
```

还有 urls.py

```
from django.conf.urls import patterns, url
from views import *

urlpatterns = patterns('',
url(r'^createTrip/$', createTrip, name = 'createTrip'),) 
```

但我得到错误

> 没有名为 django.views 的模块
> 
> 异常位置：/var/src/Django-1.4.2/django/utils/importlib.py in import_module，第 35 行

而且我不知道出了什么问题，因为我在 settings.py 中包含了 django.views 并且在我的 python 控制台中也可以导入 django.views 所以有 django.views

我不知道出了什么问题。我有其他带有 url 标签的视图，但没有这样的错误。也许有人有简单的问题。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:45:11.773

您的项目名称是什么，您的地址在哪里`views.py`？通常，您在导入视图时没有这样的行：

```
from views import * 
```

如果您在项目中导入视图，请使用项目名称作为前缀。如果您在自己的文件夹中有一个应用程序，例如`trip`，您需要将其视图文件导入为

```
from trip.views import * 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-05T08:00:17.647

我的问题在于 django 的配置。您有文件 settings.py ，我的问题是 MEDIA_* 变量配置的配置。您必须记住 MEDIA_ROOT 应该是您文件系统中文件的绝对路径，MEDIA_URL 映射您的媒体文件访问权限，并且 STATIC_URL 也应该填写。这是我的配置。当我正确填写它时，问题就消失了。:) 如果您还有任何问题，请写。

```
MEDIA_ROOT = 'myAbsolutePath\media\\'
MEDIA_URL = '/media/'
STATIC_URL='/static/' 
```

# c++ - Windows 7 中用于 c 套接字编程的 ide

> ID：13895956
> 
> 赞同：-1
> 
> 时间：2012-12-15T20:33:35.537
> 
> 标签：c++, c, sockets, network-programming, dev-c++

我正在尝试学习 c 中的套接字/网络编程。我尝试使用 dev c++ 和 code lite 来构建和编译我的 C 代码。我反复收到缺少头文件的错误（sys/socket.h、sys/param.h 等）。当我下载丢失的文件并将它们放在目录中时，它会不断收到一些文件无法定位错误。我真的受够了。请向我推荐一个好的 c 编译器，其中包含网络编程所需的所有库，并且不会让我头疼要求我下载丢失的头文件。或者无论如何下载使用dev c ++或codelight在C中编译套接字程序所需的完整库文件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:40:44.363

BSD 套接字在 Linux 上。在 Windows 上，有 winsock - 并与 MinGW 捆绑在一起。

您已将您的问题标记为 C++ - 在 C++ 中有用于套接字编程的 Boost.Asio。

并且，作为记录，请不要使用 Dev-C++ 版本 4.9.9.2。它很老了（2005 年）。请改用 Code::Blocks 或 Orwell Dev-C++。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:41:21.313

只需安装 Visual Studio C++ Express，最好花一两天时间了解代码生成的基本原理！;-)

# android - android设备在后台时如何振动？

> ID：13895957
> 
> 赞同：0
> 
> 时间：2012-12-15T20:33:41.870
> 
> 标签：android, service, background, chronometer, vibration

在我的应用程序中，我必须让它在用户定义的时间间隔内振动。

基本上它有一个计时器，当它到达定义的时间时，它会使设备振动。目前，我通过在 onChronometerTick() 方法中读取计时器值并将其与所需值进行比较来做到这一点

我也需要这个应用程序在后台工作。我用谷歌搜索并找到了一些关于 android Service 类的例子。

我的疑问是我的服务类将如何获得计时器值？我已经看到 Service 类无法处理布局组件。

我怎样才能做到这一点？服务是处理此问题的最佳方式吗？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:38:57.857

听起来你想要的是一个[alarmmanager](http://developer.android.com/reference/android/app/AlarmManager.html)。以下是关于警报管理器的说明：

> 这些允许您安排您的应用程序在将来的某个时间点运行。当警报响起时，系统会广播已为其注册的 Intent，如果目标应用程序尚未运行，则会自动启动它。已注册的闹钟在设备处于睡眠状态时会保留（如果在此期间它们响起，可以选择唤醒设备），但如果关闭并重新启动，则会被清除。

因此，如果您希望计数器在关闭后继续运行，您必须找到一个启动选项或其他东西。但是，是的，如果您希望它们在屏幕锁定后继续发生，您需要安排这些事件。

# spring - @AspectJ 基于 AOP 和 Spring 3.1

> ID：13895963
> 
> 赞同：2
> 
> 时间：2012-12-15T20:34:26.303
> 
> 标签：spring, spring-aop

我正在尝试使用 Spring 3.1 运行基于 @AspectJ 的 AOP，但无法正确配置切入点切入点和建议方法是：

切入点：

```
@Pointcut("execution(* point.*.*(..))")
public void selectAll() {} 
```

咨询后：

```
@After("selectAll()")
public void afterAdvice() {
    System.out.println("profile has been setup.");
} 
```

之前的建议：

```
@Before("selectAll()")
public void beforeAdvice() {
    System.out.println("Going to setup profile.");
} 
```

＆运行主程序我得到了异常：

```
Exception in thread "main" org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'student' defined in class path resource [spring.xml]: Initialization of bean failed; nested exception is java.lang.IllegalArgumentException: error at ::0 can't find referenced pointcut selectAll
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)
at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)
at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:294)
at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:225)
at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:291)
at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:193) 
```

虽然当我在 beforeAdvice() 和 afterAdvice() 方法中给出切入点表达式时，删除 PointCuts 方法一切正常

```
@Before("execution(* point.*.*(..))")
public void beforeAdvice() {
    System.out.println("Going to setup profile.");
}

 @After("execution(* point.*.*(..))")
public void afterAdvice() {
    System.out.println("profile has been setup.");
} 
```

我正在尝试将切入点应用于 Student 类的方法：

```
package point;

 public class Student{
private Integer age;
private String name;

public void setAge(Integer age) {
    this.age = age;
}

public Integer getAge() {
    System.out.println("Age : " + age);
    return age;
}

public void setName(String name) {
    this.name = name;
}

public String getName() {
    System.out.println("Name : " + name);
    return name;
}

public void printThrowException() {
    System.out.println("Exception raised");
    throw new IllegalArgumentException();
}
 } 
```

弹簧配置xml：

```
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:aop="http://www.springframework.org/schema/aop"
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd ">

<aop:aspectj-autoproxy />
 <bean id="student" class="point.Student">
    <property name="name" value="Zara" />
    <property name="age" value="11" /> 
</bean>
<bean id="logging" class="point.Logging" />
</beans> 
```

使用的 jar 文件：

```
aopalliance-1.0.jar
asm-3.3.1.jar
aspectj-1.7.1.jar
aspectjrt-1.6.8.jar
aspectjtools-1.5.4.jar
aspectjweaver-1.6.2.jar
cglib-2.2.2.jar 
```

带弹簧 3.1 罐

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T19:17:53.893

解决了问题：**创建 bean 时的问题是由于旧 jars**

更换的罐子：

```
 aopalliance-1.0.jar
 asm-3.3.1.jar
 aspectj-1.7.1.jar
 aspectjrt-1.6.8.jar
 aspectjtools-1.5.4.jar
 aspectjweaver-1.6.2.jar
 cglib-2.2.2.jar 
```

和

```
aopalliance-1.0.jar
asm-3.3.1.jar
aspectj-1.7.1.jar
aspectjrt-1.7.0.jar
aspectjweaver-1.7.0.jar
cglib-2.2.2.jar 
```

# android - Adobe Air Android renderMode direct 和 Textinput

> ID：13895966
> 
> 赞同：2
> 
> 时间：2012-12-15T20:34:55.653
> 
> 标签：android, apache-flex, air, adobe

使用 DIRECT 似乎会阻止 Air 移动应用程序使用软键盘在 TextInput 字段中输入文本。这已经在三星 Galaxy S3 上进行了测试。这个错误有解决方法还是我错过了什么？

# regex - Python：RE 仅捕获第一个和最后一个匹配项

> ID：13895971
> 
> 赞同：0
> 
> 时间：2012-12-15T20:35:32.133
> 
> 标签：regex, python-2.7

我正在尝试制作一个捕获以下内容的正则表达式： - XX 或 XX:XX，最多 6 次重复（XX:XX:XX:XX:XX:XX），其中 X 是十六进制数。

换句话说，我试图捕获范围从 1 到 6 个字节的 MAC 地址。

```
regex = re.compile("^([0-9a-fA-F]{2})(?:(?:\:([0-9a-fA-F]{2})){0,5})$") 
```

问题是，如果我输入例如“11:22:33”，它只会捕获第一个匹配项和最后一个匹配项，从而导致 ["11", "22"]。

问题：有什么方法可以让 {0,5} 字符让我捕捉到所有重复，而不是最后一个？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-15T20:38:27.010

不是在 Python 中，不是。但是您可以先使用正则表达式检查正确的格式，然后简单地将字符串拆分为`:`：

```
result = s.split(':') 
```

另请注意，您应该始终将正则表达式编写为原始字符串（否则您会遇到转义问题）。而你的外部非捕获组什么都不做。

* * *

从技术上讲，有一种方法可以只使用正则表达式，但正则表达式非常可怕：

```
r"^([0-9a-fA-F]{2})(?:([0-9a-fA-F]{2}))?(?:([0-9a-fA-F]{2}))?(?:([0-9a-fA-F]{2}))?(?:([0-9a-fA-F]{2}))?(?:([0-9a-fA-F]{2}))?$" 
```

但是在这里你总是会得到六个捕获，只是有些可能是空的。

# java - 变量必须初始化

> ID：13895972
> 
> 赞同：0
> 
> 时间：2012-12-15T20:35:32.357
> 
> 标签：java

我目前正在用 Java 创建一个类似于下面的程序：它要求初始化变量 AC。

```
double AC;
System.out.println("Please choose A or B")

If(Condition to see if it A)
{
AC = 1
}
else if(Condition to see if it B)
{
AC = 2
}
else 
{
System.out.println("Please Enter a valid choice!")
}

double ab = AC * 2 
```

这将给出“必须初始化变量 AC”的错误。造成这种情况的原因是如果用户不选择 A 或 B，则在双 ab 中将没有 AC 可使用。我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T20:36:42.447

这就是它所说的：您必须确保`AC`在使用它之前进行初始化。

你的问题是，`AC`如果你落到最后，那没有任何价值`else`。

你可以给它一个默认值：

```
double AC = 33.2; // or Double.NaN if you prefer
System.out.println("Please choose A or B")
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T20:46:31.087

在 Java 7 中，您可以将 switch 与字符串一起使用

```
 switch (choose) {
    case "A":
        AC = 1;
        break;

    case "B":
        AC = 2;
        break;

    default:
        AC = -1;
        break;
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-15T20:39:40.057

局部变量和原语应该在使用前初始化，因为你会知道从值中期望什么

因此，您必须初始化变量的值，例如`AC = <<any value>>;`

请考虑以下**示例**

```
int a;  // Valid
int b;
println("a=" + b);  // Not valid since b's value has never been assigned 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-16T06:59:56.743

这里有两件事：

*   执行的`else`子句仅请求使用有效数字。即使这样可以编译，通过程序的流程也会不正确，因为该值永远不会重新建立为有效值；也就是说，您不会再循环检查答案。

*   该`else`子句不尝试将值分配给`AC`，这是编译器查看是否`AC`已分配的位置之一；*不能*保证将遵循其他两个代码路径中的任何一个，但`else`始终遵循。它在那里看不到它，所以你得到“变量可能没有被初始化”错误。

 ** * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-12-15T20:37:12.010

您只需要初始化 AC，因为“如果”的任何选项都不可能。做就是了

```
double AC = -1; 
```

或一些虚拟值。*

# google-maps - 如何在没有 ARC 项目下使用新的 iOS Google Maps SDK

> ID：13895975
> 
> 赞同：0
> 
> 时间：2012-12-15T20:36:43.373
> 
> 标签：google-maps, ios6, mapkit, google-maps-sdk-ios

我正在尝试将新的 Google Maps API 添加到我的 iOS 应用程序中，但是它还没有使用 ARC。因此，查看文档我认为必须有 ARC 才能使 SDK 工作。我怎么能那样做？我的意思是一个选项将激活 ARC 仅用于可与 Google 地图一起使用的资源。（.xib 文件，控制器）怎么能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-17T06:01:58.537

您可以通过添加编译器标志**-fno-objc-arc来禁用单个文件的 ARC**

该标志告诉编译器文件不是基于 ARC 的。

要做到这一点

1.  选择目标
2.  转到构建阶段选项卡
3.  展开编译源
4.  选择不基于 Arc 的文件
5.  按回车
6.  在出现的对话框中输入文本**-fno-objc-arc**
7.  完毕

有关更多参考，请检查此问题[how-can-i-disable-arc-for-a-single-file-in-a-project](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)

# sql-server-2008-r2 - 带参数的动态 SQL 比存储过程快？

> ID：13895977
> 
> 赞同：1
> 
> 时间：2012-12-15T20:36:56.353
> 
> 标签：sql-server-2008-r2

我发现，如果我在代码中使用参数化命令创建了相同的查询，那么它比在带有参数的存储过程中运行相同的查询要快。

为什么会这样？

例如，当我在没有存储过程的情况下运行查询时，需要 2 秒，而如果我在带参数的存储过程中运行它，则需要 4 到 5 秒。

# jquery-mobile - 为什么我提交表单后无法更改页面？

> ID：13895979
> 
> 赞同：0
> 
> 时间：2012-12-15T20:37:03.757
> 
> 标签：jquery-mobile

点击提交后我应该看到：“你好”，但我没有。为什么？

[http://jsfiddle.net/GbfLG/1/](http://jsfiddle.net/GbfLG/1/)

```
<div data-role="page" id="create">
    <script type="text/javascript">
      alert("HERE");
      $('#form').submit(function() {
      $.post("/").success(function(resp) {
        alert("RET");
        $.mobile.changePage($("#final"));
      });
      return false;
      });
    </script>
    <div data-role="content">
        <form id="form">
            <input type="submit" name="g" value="Submit" id="g"/>
        </form>
    </div>
</div>

<div data-role="page" id="final">
   Hello
</div>​ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-15T20:42:21.540

您的表单正在提交 -`return false;`没有正常工作。尝试..

```
$('#form').submit(function(e) {
    e.preventDefault();
    e.stopPropagation();
    ... stuff ...
}); 
```

同样在您的小提琴中，您还没有定义 $.changePage 所以它显示为“未定义”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-15T22:25:54.080

jQM 有一套与普通网页不同的规则。您在错误的地方使用了您的 java 脚本。使用 jQM，如果可能的话，将所有 js 代码写入单独的文件/文件中。

[这](http://jsfiddle.net/Gajotres/993Kd/)是对您的 jsFiddle 代码所做的修复，它现在正在工作，我刚刚将它放在正确的上下文中。你的 js 代码没有改变一点。

例子：

```
$('#create').live('pagebeforeshow',function(e,data){        
    $('#form').submit(function() {    
        $.post("/").success(function(resp) {
            $.mobile.changePage($("#final"));
        });
        return false;
    });
}); 
```

# spring - Spring Web项目部署在tomcat中失败但在码头工作

> ID：13895980
> 
> 赞同：1
> 
> 时间：2012-12-15T20:37:05.000
> 
> 标签：spring, tomcat, jetty

在使用 tomcat 部署我的 spring web 项目时，它给了我以下异常：

```
org.apache.catalina.startup.ContextConfig processAn
notationsJar
SEVERE: Unable to process Jar entry [com/ibm/icu/impl/data/LocaleElements_zh__PI
NYIN.class] from Jar [jar:file:/D:/myproject/WEB-INF/lib/icu4j-2.6.1.jar!/] for annot
ations
org.apache.tomcat.util.bcel.classfile.ClassFormatException: Invalid byte tag in
constant pool: 60
        at org.apache.tomcat.util.bcel.classfile.Constant.readConstant(Constant.
java:133)
        at org.apache.tomcat.util.bcel.classfile.ConstantPool.<init>(ConstantPoo
l.java:60)
        at org.apache.tomcat.util.bcel.classfile.ClassParser.readConstantPool(Cl
assParser.java:209)
        at org.apache.tomcat.util.bcel.classfile.ClassParser.parse(ClassParser.j
ava:119)
        at org.apache.catalina.startup.ContextConfig.processAnnotationsStream(Co
ntextConfig.java:2104)
        at org.apache.catalina.startup.ContextConfig.processAnnotationsJar(Conte
xtConfig.java:1980)
        at org.apache.catalina.startup.ContextConfig.processAnnotationsUrl(Conte
xtConfig.java:1946)
        at org.apache.catalina.startup.ContextConfig.processAnnotations(ContextC
onfig.java:1931)
        at org.apache.catalina.startup.ContextConfig.webConfig(ContextConfig.jav
a:1325)
        at org.apache.catalina.startup.ContextConfig.configureStart(ContextConfi
g.java:878)
        at org.apache.catalina.startup.ContextConfig.lifecycleEvent(ContextConfi
g.java:369)
        at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(Lifecycl
eSupport.java:119)
        at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBa
se.java:90)
        at org.apache.catalina.core.StandardContext.startInternal(StandardContex
t.java:5173)
        at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
        at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase
.java:901)
        at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:87
7)
        at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:633)

        at org.apache.catalina.startup.HostConfig.deployDescriptor(HostConfig.ja
va:657)
        at org.apache.catalina.startup.HostConfig$DeployDescriptor.run(HostConfi
g.java:1637)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:47
1)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.
java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor
.java:603)
        at java.lang.Thread.run(Thread.java:722)

SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further detail 
```

但它在码头工作。谁能告诉我是什么原因？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T21:32:17.430

这似乎与以下问题相同：[Tomcat 7 - Servlet 3.0: Invalid byte tag in constant pool](https://stackoverflow.com/q/6751920/131929) (com.ibm.icu:icu4j 的旧版本)。

# c++ - 我可以使用预处理器功能创建其他#define 吗？

> ID：13895989
> 
> 赞同：1
> 
> 时间：2012-12-15T20:38:17.420
> 
> 标签：c++, preprocessor-directive

我知道在问这个之后我会受到惩罚，但我仍然想做这样的事情：

```
#define DEF_CLASS(x) \ 
  #define CLASS x \
  #define CONSTRUCTOR CLASS::CLASS \
  #define COPY_CONSTRUCTOR(x) CONSTRUCTOR(const CLASS& x) 
```

那就是我想要一个动态定义其他“#defines”的“#define”函数。

我有一个无法重构的 IDE，此外，我想让构造函数，尤其是复制构造函数，因其特殊的作用而脱颖而出。
因此，我的目标是像这样编写我的 c++ 类定义：

```
CONSTRUCTOR(int i):i(i){}
COPY_CONSTRUCTOR(other):i(other.i){}
void CLASS::fun1()
{
  //...
} 
```

为此，目前我需要复制并粘贴三个#define 行。我宁愿自动做这些。有没有办法使用预处理器来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T20:50:01.017

否——第 16.3.4/3 节：

> 生成的完全宏替换的预处理令牌序列不会作为预处理指令处理，即使它类似于一个 [...]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:44:31.530

不，这样的`DEF_CLASS(x)`宏是不可能的。宏不是有状态的。你能做的最好的事情是：

```
#define CONSTRUCTOR CLASS::CLASS
#define COPY_CONSTRUCTOR(x) CONSTRUCTOR(const CLASS& x)

...

#define CLASS X
    CONSTRUCTOR(int i):i(i){}
    COPY_CONSTRUCTOR(other):i(other.i){}
    void CLASS::fun1()
    {
      //...
    }
#undef CLASS

#define CLASS Y
    CONSTRUCTOR(int i):i(i){}
    COPY_CONSTRUCTOR(other):i(other.i){}
    void CLASS::fun1()
    {
      //...
    }
#undef CLASS 
```

但我**强烈**建议你不要像这样滥用预处理器。为什么要用这些宏来混淆普通的 C++ 语法？接受 C++ 的本质；不要试图把它变成一种不同的、更友好的语言。

# c++ - C++ 程序崩溃

> ID：13895990
> 
> 赞同：0
> 
> 时间：2012-12-15T20:38:24.520
> 
> 标签：c++

大家好，我是 C++ 的新手，所以我正在编写一个程序，它运行良好，但是有一个问题。每次我输入大于 100 的数字时，我的程序都会崩溃，我不知道为什么。有人可以帮我吗？

程序代码：

```
#include <iostream>
#include <cmath>

using namespace std;

int main()
{
  int i = 10;

  while(i > 0)
  {
    i--;

    int b = 0, c = 1, d = 0, e, number, how = 0, number1, start, to, number2, split1, split2, mass, start1 = 0, start2 = 0, number3, how1, number4, number5;

    cout << "\nIveskite skaiciu \n";
    cin >> number;
    cout << "\n";

    number1 = number;

    while(number1 > 0)
    {
        number1 = number1 / 10;
        how = how + 1;
    }

    how1 = how - 1;
    start = pow(10, (how - 1));
    to = pow(10, how);
    mass = to - start;
    number2 = start - 1;
    int split[mass][mass], numbers[mass], ok[mass];

    while(start1 < mass)
    {
        start1++;

        e = number2 + start1;

        numbers[start1] = e;
        split[start1][0] = e;
    }

    while(start2 < mass)
    {
        start2++;

        number3 = numbers[start2];

        d = 0;
        b = 0;
        c = 1;

        while(d <= how1)
        {
            d++;

            split1 = number3%10;
            split2 = number3 / 10;
            number3 = split2;
            split[start2][d] = split1;
            number4 = b + split[start2][d];
            b = number4;
            number5 = c * split[start2][d];;
            c = number5;

        }

    if(number4 == number5)
    {
        ok[mass] = numbers[start2];

        cout << number4 << " " << number5 << " >" << ok[mass] << endl;
    }
  }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-15T21:06:58.157

Seems to me its the 2D array split that gets too large for your stack. You could probably try to allocate it dynamically as suggested here: [how to deal with large 2D arrays](https://stackoverflow.com/questions/10249829/how-to-deal-with-large-2d-arrays)

# jquery - Iterate through elements and elements in array

> ID：13895995
> 
> 赞同：1
> 
> 时间：2012-12-15T20:39:04.550
> 
> 标签：jquery, arrays, for-loop, loops, each

I want to pick random product objects from an array and place the info that they contain in four different containers. All the containers is hard coded in html and has the same class name, and I want to iterate through them.

Below you see the code, and that I'm using .each for this task, which of course doesn't work because every time the for loop runs it starts over again.

So, what is the best way to solve this?

```
function AddProducts(products) {

    for(var i = 0; i < 4; i++) {
        var number = Math.floor(Math.random() * products.length);

        $('.product').each(function(index) {
            $(this).find('h3').html(product[number].name);
        });
    }
}

    <div class="row span12">
      <ul class="thumbnails">
        <li class="span3 product">
          <div class="thumbnail padding">
            <h3>Product name</h3>
            <p>Description</p>
          </div>
        </li>
        <li class="span3 product">
          <div class="thumbnail padding">
            <h3>Product name</h3>
            <p>Description</p>
          </div>
        </li>
        <li class="span3 product">
          <div class="thumbnail padding">
            <h3>Product name</h3>
            <p>Description</p>
          </div>
        </li>
        <li class="span3 product">
          <div class="thumbnail padding">
            <h3>Product name</h3>
            <p>Description</p>
          </div>
        </li>
      </ul>
    </div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-15T21:03:44.437

If you want to pick random products and place them into each container without duplicates, you have to shuffle the array first:

```
function shuffle(o)
{ //v1.0
    for(var j, x, i = o.length; i; j = parseInt(Math.random() * i), x = o[--i], o[i] = o[j], o[j] = x);
    return o;
};

function AddProducts(products) 
{
    // this function modifies the array in-place
    // make a copy if you need to
    // products = shuffle(products.slice(0));
    shuffle(products);

    $('.product').each(function(i) {
        if (products[i]) {
            $(this).find('h3').html(products[i].name);
        }
    });
}

AddProducts([{name: 'foo'}, {name: 'bar'}, {name: 'baz'}, {name: 'dude'}]); 
```

[**DEMO**](http://jsfiddle.net/dqxqd/)

The `shuffle()` function is taken from this question: [How can I shuffle an array?](https://stackoverflow.com/questions/6274339/how-can-i-shuffle-an-array-in-javascript)

~~Also, one of your `<li>` elements has the wrong class `.producer` instead of `.product`.~~ Okay, you've fixed that now :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-15T20:41:47.163

Are you looking for something like this?

```
function AddProducts(products) {
    var selectedProducts = [];
    var producers = $('.producer');

    for(var i = 0; i < 4; i++) {
        var number = Math.floor(Math.random() * products.length);
        producers.eq(i).find('h3').html(product[number].name);
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-15T20:51:44.553

You don't need the for loop, when already using the jQuery `.each()` function.

```
var productTmp = product.slice(0);

$( '.product' ).each( function( index ) {

    var number = Math.floor( Math.random() * productTmp.length );

    $( this ).find( 'h3' ).html( productTmp[number].name );

    productTmp[number] = undefined;

} ); 
```

Instead of copying the original array and deleting the used products, you could use a condition or something, to remember which products of the list already were inserted. This should prevent multiple occurrences of one product in the list (as your are picking them randomly).