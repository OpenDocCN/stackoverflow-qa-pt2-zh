# StackOverflow 问答 15165000-15165999

# redis - REDIS：如何将集合相交到列表中

> ID：15165000
> 
> 赞同：1
> 
> 时间：2013-03-01T19:04:27.533
> 
> 标签：redis, intersect

Redis 可以将两个正常集合相交并将结果记录到列表中。

我有多种具有功能的产品。

我需要通过功能与产品相交并仅显示其中的一小部分，例如 LRANGE

我现在有：

```
SMEMBERS feature1 -> product1, product2, product3
SMEMBERS feature2 -> product2, product3, product4

SINTERSTORE mycache feature1, feature2 -> product2, product3 
```

执行`SMEMBERS mycache`需要大量时间（超过 100 万种产品）。但我一次只需要 20 个产品。

如果`mycache`是列表，我会很容易`LRANGE 0 20`地只获得前 20 种产品。

# mysql - 导入大型 sql 文件 (>20GB)

> ID：15165002
> 
> 赞同：8
> 
> 时间：2013-03-01T19:04:42.813
> 
> 标签：mysql, sql, import

我正在尝试将一个非常大的 .sql 文件导入我的数据库。该文件目前为 20GB 大。我尝试使用控制台 mysql database < backup.sql 但这需要超过 24 小时，并且 mysql 服务器不再有任何反应。

如何导入这么大的文件？我认为拆分它是要走的路，但是我怎样才能正确拆分它呢？它只是一个带有多个插入语句的表。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:11:26.680

MySQL 在语言中内置了 api 驱动的表插入。见下文。使用这个：[http ://dev.mysql.com/doc/refman/5.1/en/load-data.html](http://dev.mysql.com/doc/refman/5.1/en/load-data.html)

您需要将文件从插入语句重新格式化为某种形式的 csv 等，但这应该比单个语句更快，因为它是与 RDBMS 通信的一种方式“我即将上传大量数据，将重新索引和簿记开销保存到最后，确保您有足够的空间并抓住该空间一次而不是每次填满，确保使用适当的锁等，等等，等等”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-09T17:39:26.830

您可以拆分sql文件并将其导入数据库。

分割sqldump文件最简单的方法是使用`sqldumpsplitter`软件，下载[链接](http://www.rusiczki.net/2007/01/24/sql-dump-file-splitter/)

否则使用此终端命令拆分

`split -l 5000 ./path/to/mysqldump.sql ./mysqldump/dbpart-`

这里 5000 是 sql 命令的行数，你喜欢拆分。接下来的两个参数分别是源路径和目标路径。单独的拆分文件将被分配一个名称，并在其末尾附加一个字母。

希望它可以帮助其他有这个问题的人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:18:23.527

只需锁定表，然后复制此表数据文件（.frm、.MYI、.MYD）。
您立即获得可以导入任何数据库的现成数据文件。

这种方法对 myisam 非常有效。不确定innodb。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-11-03T16:04:30.790

我建议您在尝试跨拆分文件保留 SQL 查询时考虑以下情况：

*   单个 SQL 查询可以拆分为多行，因此您不能只逐行拆分
*   有效的 SQL 查询将以分号 (;) 结束，并且大多数情况下，这将是行尾。

掌握这两种情况的知识后，您可以编写一个简单的脚本，该脚本逐行处理您的 SQL 转储，并在找到以分号 (;) 结尾的行或 500 行这样的行时将其拆分为块。

我已经为我遇到的类似问题编写了这样一个脚本：[https ://gist.github.com/pratikone/0a8d503ffe893b2111f5a1d70d3999b7](https://gist.github.com/pratikone/0a8d503ffe893b2111f5a1d70d3999b7)

它只检查行中的分号（;）而不是行尾，但我没有任何 SQL 查询在查询中包含分号（;），所以它工作得很好。鉴于此，如果您的数据在查询之间可以有分号，则需要做一个小改动。

# javascript - 硬编码值在 element.val() 不显示结果的情况下有效

> ID：15165003
> 
> 赞同：0
> 
> 时间：2013-03-01T19:04:47.097
> 
> 标签：javascript, jquery

如果 param 的值是硬编码的，则代码可以正常工作，就好像该值是从输入字段中获取的一样，那么该函数`getResults()`不会显示结果（但警报显示该值已成功提供给`param`）。请指导。

```
<script type="text/javascript">

var nexturl ="";
var lastid ="";

$(document).ready(function() {

  //$("#search").keyup(function() {
    //$('#hit').click(function() {  

  //var param = $("#search").val(); 
 $("#search").keypress(function(e) {
    if(e.which == 13) {
    var param = $('#search').val();
        alert(param);

    }
});
  //$(document).ready(function() {
  //var param = "Facebook";
  if (param != "") {
    $("#status").show();
    var u = 'https://graph.facebook.com/search/?callback=&limit=25&q='+param;
    getResults(u);
  };

  $("#more").click(function () { 

    $("#status").show();
    $("#more").hide();  
    pageTracker._trackPageview('/?q=/more');
    var u = nexturl;
    getResults(u);
  });

//};
});
</script> 
```

**编辑：**

```
<script type="text/javascript">

var nexturl ="";
var lastid ="";
var param;
$(document).ready(function() {

 $("#search").keypress(function(e) {
    var param = $('#search').val();
    if (param != "") {
        $("#status").show();
        var u = 'https://graph.facebook.com/search/?callback=&limit=25&q='+param;
        getResults(u);
        }
});
};

  $("#more").click(function () { 

    $("#status").show();
    $("#more").hide();  
    pageTracker._trackPageview('/?q=/more');
    var u = nexturl;
    getResults(u);
  });

});
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:11:12.580

看看你的变量范围。`var param`是在函数中定义的`.keypress`，因此它的作用域是该函数的本地，它不能被下面的其他代码访问（它的作用域在 中`(document).ready`）。

还要考虑即使它具有全局范围，您的代码仍然无法工作，因为`getResults()`在加载时执行，并且该`.keypress`函数显然不会执行，直到按下一个键`#search`。

您最好的选择可能是在之前定义它`getResults()`：

```
var param = $('#search').val();
if (param != "") {
    $("#status").show();
    var u = 'https://graph.facebook.com/search/?callback=&limit=25&q='+param;
    getResults(u);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:12:53.710

进一步思考（见评论）。

定义一个全局参数：

```
var param = ""; 
```

然后在你准备好的jQuery中，像这样为参数赋值..

```
param = somevalue; 
```

不要在此范围内使用 var param。

# bash - 从行中删除文本

> ID：15165005
> 
> 赞同：0
> 
> 时间：2013-03-01T19:05:00.137
> 
> 标签：bash, unix, sed, awk

我有一个日志文件，我基本上将整个日志记录下来，将其切割成字符串，直到只剩下两个字段，在字段一上唯一排序，并在字段编号和字段 1 相同时对右侧的字段求和。例子

```
80 128 
443 40
80 100
25  20 
443 44
80 128 
```

结果将是

```
80 356
443 84
25  20 
```

我遇到的问题是我删除的第一个字段不一致，有时输出看起来像：

80 128

有时是

```
80(LOCAL\randomuser) 128 
```

所以我的输出最终看起来像

```
80 356
80(LOCAL\randomuser) 128
443 84
25  20 
```

这是因为 80(LOCAL\randomuser) 是唯一行。

如何首先规范化第一个字段，以便 (LOCAL\randomuser) 从存在的行中删除，而没有 (LOCAL\randomuser) 的行保持不变。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:10:44.143

利用

```
awk '{a[$1]+=$NF} END{for (i in a) print i, a[i]}' input 
```

即使用第一个字段作为键并添加最后一个字段。

如果在您的示例中第一个数字和 the 之间没有空格`(`，请告诉 awk 也拆分`(`：

```
awk -F"[ (]+" '{a[$1]+=$NF} END{for (i in a) print i, a[i]}' input 
```

输出：

```
$ awk '{a[$1]+=$NF} END{for (i in a) print i, a[i]}' input
25 20
80 356
443 84 
```

另一种删除仅`(LOCAL\randomuser)`存在的方法，您可以使用`sed`：

```
sed 's/(.*)//' input 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:59:41.177

或强制`$1`进入数字上下文：

```
awk '{A[$1+0]+=$NF} END{for (i in A) print i, A[i]}' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:07:13.433

`grep -v`将匹配**不包含**模式的行。在输出`grep`到达`cut`.

# javascript - 谷歌地图自定义信息框

> ID：15165007
> 
> 赞同：2
> 
> 时间：2013-03-01T19:05:18.570
> 
> 标签：javascript, jquery, css, google-maps, google-maps-api-3

我正在尝试按照此示例合并一个自定义信息框，但我的代码不起作用。有人可以看看我哪里出错了吗？

我已经评论了示例代码的开始/结束位置以及我试图调用它的位置。

```
function initialize() {

var mapOptions = {
  zoom: 12,
  center: new google.maps.LatLng(52.204872,0.120163),
  mapTypeId: google.maps.MapTypeId.ROADMAP,
  styles: styles,
  scrollwheel: false
};

var map = new google.maps.Map(document.getElementById('map_canvas'),mapOptions);

setMarkers(map, sites);
            infowindow = new google.maps.InfoWindow({
    content: "loading..."

});
}

var sites = [
    // List all locations for each pin
['The Frontroom', 52.202977,0.138938, 1, '<p>The Frontroom. <br/>23-25 Gwydir Street, Cambridge, CB1 2LG <br/>01223 305 600</p>'],
];

function setMarkers(map, markers) {

for (var i = 0; i < markers.length; i++) {
    var sites = markers[i];
    var siteLatLng = new google.maps.LatLng(sites[1], sites[2]);
    var marker = new google.maps.Marker({
        position: siteLatLng,
        map: map,
        title: sites[0],
        zIndex: sites[3],
        html: sites[4],
        icon: "http://visualartscambridge.org/wp-content/uploads/2013/03/map-pin.png"
    });
    // Begin example code to get custom infobox
    var boxText = document.createElement("div");
    boxText.style.cssText = "border: 1px solid black; margin-top: 8px; background: yellow; padding: 5px;";

    var myOptions = {
             content: boxText
            ,disableAutoPan: false
            ,maxWidth: 0
            ,pixelOffset: new google.maps.Size(-140, 0)
            ,zIndex: null
            ,boxStyle: { 
              background: "url('tipbox.gif') no-repeat"
              ,opacity: 0.75
              ,width: "280px"
             }
            ,closeBoxMargin: "10px 2px 2px 2px"
            ,closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif"
            ,infoBoxClearance: new google.maps.Size(1, 1)
            ,isHidden: false
            ,pane: "floatPane"
            ,enableEventPropagation: false
    };
    // end example code for custom infobox

    google.maps.event.addListener(marker, "click", function () {

        infowindow.setContent(this.html);
        // Call myOptions when marker is clicked and opened
        infowindow.open(map, myOptions, this);
    });
}
}

google.maps.event.addDomListener(window, 'load', initialize); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T04:48:15.213

删除现有代码的这一部分：

```
google.maps.event.addListener(marker, "click", function () {

    infowindow.setContent(this.html);
    // Call myOptions when marker is clicked and opened
    infowindow.open(map, myOptions, this);
}); 
```

用 InfoBox 示例中的这个替换它：

```
var ib = new InfoBox(myOptions);

google.maps.event.addListener(marker, "click", function (e) {
  ib.open(map, this);  // change the map variable appropriately
}); 
```

[工作示例](http://www.geocodezip.com/v3_simpleMap_InfoBox.html)

对于多个点，使用函数闭包（一个 createMarker 函数）来维护标记和 infoBox 之间的关联：

```
function createMarker(site, map){
    var siteLatLng = new google.maps.LatLng(site[1], site[2]);
    var marker = new google.maps.Marker({
        position: siteLatLng,
        map: map,
        title: site[0],
        zIndex: site[3],
        html: site[4] /* ,
        icon: "http://visualartscambridge.org/wp-content/uploads/2013/03/map-pin.png" this icon no longer available */
    });
    // Begin example code to get custom infobox
    var boxText = document.createElement("div");
    boxText.style.cssText = "border: 1px solid black; margin-top: 8px; background: yellow; padding: 5px;";
    boxText.innerHTML = marker.html;

    var myOptions = {
             content: boxText
            ,disableAutoPan: false
            ,maxWidth: 0
            ,pixelOffset: new google.maps.Size(-140, 0)
            ,zIndex: null
            ,boxStyle: { 
              background: "url('http://google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.12/examples/tipbox.gif') no-repeat"
              ,opacity: 0.75
              ,width: "280px"
             }
            ,closeBoxMargin: "10px 2px 2px 2px"
            ,closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif"
            ,infoBoxClearance: new google.maps.Size(1, 1)
            ,isHidden: false
            ,pane: "floatPane"
            ,enableEventPropagation: false
    };
    // end example code for custom infobox

    google.maps.event.addListener(marker, "click", function (e) {
     ib.close();
     ib.setOptions(myOptions);
     ib.open(map, this);
    });
    return marker;
}

function setMarkers(map, markers) {

 for (var i = 0; i < markers.length; i++) {
   createMarker(markers[i], map);
 }
} 
```

[带有来自现场示例的所有要点的工作示例](http://www.geocodezip.com/v3_simpleMap_InfoBoxA.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:31:38.657

请确保**这**是否具有属性 html。因为它指的是当时的标记。

```
google.maps.event.addListener(marker, "click", function () 
{

    infowindow.setContent(this.html);
    // Call myOptions when marker is clicked and opened
    infowindow.open(map, myOptions, this);
}); 
```

还要尝试限制您的全局变量。请尝试这个[小提琴](http://jsfiddle.net/sRDJz/)一次。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:00:55.113

[好吧，比从http://google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/](http://google-maps-utility-library-v3.googlecode.com/svn/tags/infobox/1.1.9/)获取 inbox.js 文件包含在您的 html/jsp 中。您还需要从代码中删除 infowindow 对象

并修改您的代码

```
function setMarkers(map, markers) {
  ......// same as your code
  var ib = new InfoBox(myOptions);
  google.maps.event.addListener(marker, "click", function (e) {
        ib.open(map, this);
    });
  .....//same as your code
} 
```

如果您第一次没有成功，那么我们可能需要尝试几次。请每次发布带有结果的修改代码。

# django - 在 Django Admin 中形成模型的“注释”或“评论”

> ID：15165009
> 
> 赞同：4
> 
> 时间：2013-03-01T19:05:38.360
> 
> 标签：django, django-models, django-admin

基本上，我想要一种让管理员对正在查看的模型发表评论的方法。假设我们有一辆汽车模型，我已经在管理站点中注册了，我想让其他管理员写一个关于这辆车的简短说明，并让它只显示在管理界面中，以及他们的名字和时间戳。

本质上，我想在 django 管理员中为特定模型添加评论表单。

关于如何在不覆盖整个视图的情况下执行此操作的任何建议？

**第 2 轮（编辑）**

这是我使用 GordonsBeards 答案的进展。

![我的管理员现在的样子](../Images/a159bf8d8d530c7f60339c6e3d52378c.png)

它添加了 3 个“额外”的空笔记，这不是破坏交易，但仍然很有趣。

```
# In models.py
class Note(models.Model):
    user = models.ForeignKey(User)
    note = models.TextField()
    created_on = models.DateTimeField(auto_now_add=True)

    def __unicode__(self):
        return "created on: {}".format(self.created_on) 
```

我的用户模型同时处理管理员用户，并且是我想要添加注释功能的对象。如何在创建日期前添加登录用户名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:20:17.503

我不知道您所说的“覆盖整个视图”是什么意思，因为这种事情使 Django 使用起来非常漂亮，能够在不费吹灰之力的情况下增加额外的功能。假设我不打算把整个脚放进嘴里，我会这样处理它：

添加注释应该不会太困难，只需在您的内部定义另一个模型`cars.models`并添加类似`Notes`. 然后让这个模型引用 Cars 模型，因为它是外键和 zippozappo - 你已经得到了一些注释。

至于将其“限制”为仅管理员，除非您的公共视图允许人们添加注释或显示注释，否则它不应该出现在管理应用程序之外。

**网站/models.py**

```
from django.contrib.auth.models import User
# snip your stuff...
class Notes(models.Model)
    user = models.ForeignKey('auth.User')
    author = models.ForeinKey('auth.User')
    note = models.TextField()
    created_on = models.DateTimeField(auto_now_add=True) 
```

*确保`./manage syncdb`在此之后！*

**站点/admin.py**

```
from site.models import Notes
from django.contrib.auth.models import User

class NotesInline(admin.StackedInline):
    model = Notes
    extra = 0

class UserAdmin(UserAdmin):
    inlines = [NotesInline,]

admin.site.unregister(User)
admin.site.register(User, UserAdmin) 
```

以下是使用内联管理内容的一些注意事项，以防您想自定义每辆车末尾的注释显示：[https ://docs.djangoproject.com/en/dev/ref/contrib/admin/#django .contrib.admin.ModelAdmin.inlines](https://docs.djangoproject.com/en/dev/ref/contrib/admin/#django.contrib.admin.ModelAdmin.inlines)

当然，您可以根据自己的喜好扩展/更改/更改它，但是您不必做任何棘手的事情来为模型添加一些额外的功能。

理想情况下，您会创建一个 Notes 应用程序，它可以让您评论您想要的任何对象，而不仅仅是用户。

**编辑**

`class NotesInline`现在有一个`extra=0`。这将停止默认情况下在用户页面上显示 3 条记录。

`class Notes`上面有一个`author = models.ForeinKey('auth.User')`，您需要首先跟踪谁留下了笔记。这将添加一个下拉框，让您选择留下笔记的人。如果我理解正确，您希望当前登录的用户自动填写此字段。强制这样做的问题在于，在管理面板上，所有管理员都是平等创建的（除非受权限限制），因此将此`author`字段限制为当前登录的用户将需要比您应该费心的更多修补。

如果您需要将管理面板扩展到您希望自动填写这些字段的位置，则必须创建一些其他公共视图，然后将访问权限限制为有权访问它的用户。否则，您将不得不自己开始覆盖管理视图/模板。这是 Django 管理面板的一种设计特性——它应该用于修改您的表格，不一定是最终的用户输入面板。

*还有一个让人头疼* 的问题：Django`syncdb`不会改变已经存在的表，所以如果你想从现有模型中添加/删除一列，你需要删除并重新创建表，或者使用类似[django-evolution 的](https://code.google.com/p/django-evolution/)东西。然而，使用它是另一个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-05-20T01:50:01.993

我知道这是一篇旧帖子，但以防万一有人到达这里，这是我的解决方案，受[Django 启发：如何在管理表单中获取当前用户](https://stackoverflow.com/questions/2864955/django-how-to-get-current-user-in-admin-forms)：

模型.py：

```
class Comment(models.Model):
    content_type = models.ForeignKey(ContentType)
    object_id = models.PositiveIntegerField()
    content_object = GenericForeignKey("content_type", "object_id")
    user = models.ForeignKey(User)
    content = models.TextField()
    time = models.DateTimeField(auto_now_add=True) 
```

管理员.py：

```
class CommentInlineForm(forms.ModelForm):
    def __init__(self, *args, **kwargs):
        super(CommentInlineForm, self).__init__(*args, **kwargs)
        instance = getattr(self, 'instance', None)
        if instance and instance.pk:
            self.fields['content'].widget.attrs['readonly'] = True

class CommentInlineFormset(BaseGenericInlineFormSet):
    def save_new(self, form, commit=True):
        setattr(form.instance, "user", self.current_user)
        return super(CommentInlineFormset, self).save_new(
            form, commit=True)

class CommentInline(GenericTabularInline):
    model = Comment
    extra = 1
    form = CommentInlineForm
    formset = CommentInlineFormset
    readonly_fields = ('user', 'time')

    def has_delete_permission(self, request, obj=None):
        return False

    def get_formset(self, request, obj=None, **kwargs):
        formset = super(CommentInline, self).get_formset(
            request, obj, **kwargs)
        formset.current_user = request.user
        return formset 
```

注1：这里的关键是覆盖GenericTabularInline.get_formset()传入request.user，并用它来填充BaseGenericInlineFormSet.save_new()中的“user”字段。以便正确记录登录用户。其他代码只是为了使它更像“评论”。例如，只读字段，不删除等。

注2：这是一个通用的解决方案，所以无论我们要评论哪个模型，只需添加

```
inlines = [CommentInline,] 
```

到管理班，我们很高兴。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-01-15T01:59:09.027

这是一个老问题，但我在Dryice Liu 的回答中*深受启发，制作了一个软件包。*

该包称为[`django-admin-comments`](https://github.com/jamiecounsell/django-admin-comments/). 设置起来非常容易：

安装 Django 管理员评论：

```
$ pip install django-admin-comments 
```

将其添加到您的`INSTALLED_APPS`：

```
INSTALLED_APPS = (
    ...
    'admin_comments',
    ...
) 
```

运行数据库迁移

```
$ manage.py migrate 
```

现在，只需`CommentInline`将`ModelAdmin`

```
from admin_comments.admin import CommentInline

class MyModelAdmin(admin.ModelAdmin):
    model = MyModel
    inlines = [CommentInline,] 
```

就是这样！

欢迎请求请求，如果此线程上的任何人想成为贡献者，只需打开一个 PR，将自己添加到贡献者列表中，我会接受并添加你。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-06-08T22:27:02.103

对于注释，您现在可以添加帮助文本：

```
date = models.DateTimeField('date', help_text="This is a help text") 
```

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-01T19:15:09.807

如果不深入管理，最简单的方法是使用 javascript 将评论表单注入管理界面。您需要创建一个模型来存储评论（您可能可以使用内置的评论系统，尽管这可能比它的价值更麻烦），一些用于检索和保存评论的 ajax，以及一个 javascript 小部件，它将呈现检索到的评论和评论表单。

然后，您只需要在管理模板中包含对脚本的引用，而不必触及任何管理员内部。

# ssis - SSIS导入xls文件并将其拆分为2，在空行之后

> ID：15165012
> 
> 赞同：0
> 
> 时间：2013-03-01T19:05:48.470
> 
> 标签：ssis, null, split, xls

我有一个 excel 文件，其中包含由 2 个空行分隔的一堆数据。我需要将这 2 个数据集分成两个 CSV 文件。因此，在 SSIS 数据流中，我选择了“Excel Source”下的“Conditional Split”和“Flat file destination”。问题是如何设置拆分来完成这项工作？

Excel 数据示例：

服务器名称 | 初级SA | 二级
SA srv1 | SA1 | SA1
伺服器 | SA2 | SA2
srv3 | SA3 | SA3
空行 | |
空行 | |
srvA | SAa | SAa
srvB | 抗体 | SAb
服务 | SAc | 囊肿

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:14:15.717

解决方案1：

1.1 创建阶段表：

```
CREATE TABLE [dbo].[Stage]
(
    [RowID] [int] IDENTITY(1,1) NOT NULL,
    [Server_name ] [varchar](50) NULL,
    [PrimarySA ] [varchar](50) NULL,
    [SecondarySA ] [varchar](50) NULL
) ON [PRIMARY] 
```

2.2 DFT1 - 加载数据。来源：XL 文件，目的地：舞台表

2.3 DFT2 - 源

```
SELECT [RowID]
      ,[Server_name ]
      ,[ PrimarySA ]
      ,[ SecondarySA ]
FROM [dbo].[Stage]
WHERE 
    RowID < (SELECT MIN (RowID) 
             FROM [dbo].[Stage] where [Server_name ] = 'empty row '
             )

Destination: A new flat file File1 
```

2.4 DFT 3：来源：

```
 SELECT [RowID]
      ,[Server_name ]
      ,[ PrimarySA ]
      ,[ SecondarySA ]
 FROM [dbo].[Stage]
 WHERE RowID > (SELECT MAX (RowID) from [dbo].[Stage] where [Server_name ] = 'empty row ')

Destination: Another flat file - File2 
```

解决方案 2：在脚本任务中执行。阅读每一行，检查行的长度或内容。如果未找到空行，则写入文件 1。如果找到空行，则关闭第一个文件，打开一个新的输出文件并写入该文件。

这将需要更多的编程知识，但能够处理具有多个“空行”的文件。如果您需要此解决方案（并且遇到问题），请告诉我们；我或其他人会帮助你。

# ruby-on-rails - 删除protect_from_forgery

> ID：15165013
> 
> 赞同：1
> 
> 时间：2013-03-01T19:05:53.590
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise, xss

我对 Rails 应用程序中的protect_from_forgery 有疑问。我在我的 Rails 项目中使用了 Devise，最近一个关于我一直使用的版本的安全问题得到了解决，即 Devise 的 2.1.2。我已经从 2.1.2 更新到 2.1.3 并使用 Rails 3.2.12

所以我尝试更新它，但更新后我不断收到 401 并且无法再登录。

现在我向社区提出问题，为了让登录过程再次正常工作，我需要从我的 application_controller 中删除protect_from_forgery，一切都恢复正常。

但我想知道我是否通过删除它并没有引入任何其他安全漏洞？要使用该应用程序，您必须先登录，然后才能执行任何操作。所以我假设 XSS 不会影响我的应用程序，还是会影响？

期待得到一些反馈。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-25T11:19:47.143

似乎您正在使用自定义表单进行登录，而不是使用来自设计的默认表单或由 rails 表单助手生成的表单。

如果发布请求没有真实性令牌，则可能会发生此类问题。

对于自定义表单，您需要添加真实性令牌作为隐藏参数。

# eclipse - eclipse中的MVC应用程序包？

> ID：15165014
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:05:59.647
> 
> 标签：eclipse, model-view-controller, jakarta-ee, architecture

我正在开发一个具有 MVC 架构的应用程序。我想知道我应该如何为每个组件（模型、视图、控件）制作包？

是 Web 页面的包，还是 EJB 和 DAO 的包？当然还有一个包含所有 3 个项目的 EAR

感谢您的帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:32:05.347

首先，我认为您需要了解 MVC（模型、视图、控制器）。

模型是将操作数据的类。例如，一个非常基础的模型可能是一个只跟踪你有多少只狗的类。

视图是用户与之交互的应用程序的一部分。在我们的狗应用程序中，这将是用户键入或与按钮交互的图形用户界面或命令行界面。

控制器是项目中的代码，在与视图交互之后，它会告诉数据去哪里，例如告诉模型增加或减少你拥有的狗的数量。控制器也将是应用程序中的按钮侦听器。

您的应用程序结构应该是这样的：

```
/
 main file
 model/
 view/
 controller/ 
```

你应该试试这个链接：[什么是 MVC 模式中的模型](https://stackoverflow.com/questions/10345961/what-is-model-in-mvc-pattern)

# jboss - 在 jboss eap 5.1 中找不到配置文件 run.conf.bat

> ID：15165015
> 
> 赞同：0
> 
> 时间：2013-03-01T19:06:02.447
> 
> 标签：jboss, jboss5.x

当我尝试通过**Windows 中的命令提示符 (cmd)启动****JBoss EAP 5.1**时，我收到以下错误。

 **`Config file not found run.conf.bat Please check that you are in the bin directory when running this script.`

我怎样才能克服这个错误**

# javascript - IE 和 document.implementation.createDocument() - 哪些参数影响正确的 html 节点名大小写？

> ID：15165016
> 
> 赞同：3
> 
> 时间：2013-03-01T19:06:05.913
> 
> 标签：javascript, dom, internet-explorer-9

Chrome 和 Firefox 类似 document.implementation.createDocument()。IE9 没有，它要求提供 namespaceURI 和文档元素名称。这意味着调用类似 document.implementation.createDocument(' [http://www.w3.org/1999/xhtml](http://www.w3.org/1999/xhtml) ','html',null) 之类的东西，但这具有生成不使用官方 HTML 元素 nodeName 案例。它应该是全大写的，IE9 中的普通 document.createElement("a").nodeName 将返回“A”。使用 document.impl... 版本， [...].createElement("a").nodeName 返回“a”。

哪种神奇的论点组合会影响具有正确案例规则的文档？

（问题的原因：一百万个测试 DOM 片段的 QUnit 测试需要大写的节点名，并且会在这个非窗口元素工厂的整个地方抛出错误。这些测试都可以手动修复以忽略大小写，但如果有办法为了使 IE 正常运行，而不是假装小写元素名称是可以的——根据规范，它们不是——我会在手动修复之前接受它）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T17:46:40.430

您将需要改用 createHTMLDocument 方法，如下所示：

```
document.implementation.createHTMLDocument("").createElement("a").nodeName 
```

（几乎符合[DOM4 规范](https://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html#dom-domimplementation-createhtmldocument)）。

根据该规范，createDocument 创建一个 XML 文档，该文档不应将元素名称强制为大写。

# javascript - 如何使用 grunt-contrib-coffee 避免多个帮助器实现，例如 __indexOf()

> ID：15165017
> 
> 赞同：3
> 
> 时间：2013-03-01T19:06:06.820
> 
> 标签：javascript, coffeescript, gruntjs

我有一个像这样`Gruntfile.coffee`的[grunt-contrib-coffee](https://github.com/gruntjs/grunt-contrib-coffee)配置：

```
coffee:
  compile:
    files:
      'public/assets/application.js': [
          'multiple/files' #, ...
      ]
    options:
      bare: true 
```

问题是，它生成了多个辅助方法的实现，例如

```
 var __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; }; 
```

如何让它认识到这些实现已经编译？

# 更新 1

原因显然是编译后的 JavaScript 在编译*后*会被连接起来。如果在编译*之前*将 CoffeeScript 连接起来，则可以避免这种情况。如果这不是我缺少的[grunt-contrib-coffee的配置选项，我将在 github 上提交问题。](https://github.com/gruntjs/grunt-contrib-coffee)

所以剩下的问题是：如何在编译之前连接 CoffeeScript，以避免多个助手实现？

# 更新 2

有一种解决方法，它涉及将源文件与`concat`任务手动连接。这需要一个临时文件，然后可以将其从 CoffeeScript 编译为 JavaScript。[我创建](https://github.com/gruntjs/grunt-contrib-coffee/issues/51)的问题中提到了它。

将来，任务将能够将它们的东西作为缓冲区传递给彼此（参见[问题](https://github.com/gruntjs/grunt-contrib-coffee/issues/51)）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T16:31:32.293

从 grunt-contrib-coffee-0.6.1 开始，这适用于以下`join`选项：

```
coffee:
  compile:
    files:
      'public/assets/application.js': [
          'multiple/files' #, ...
      ]
    options:
      bare: true
      join: true # concatenate coffee files before compiling. default is false 
```

# c# - 有没有更好的方法来做到这一点？ASP.NET/C#/代码背后

> ID：15165018
> 
> 赞同：3
> 
> 时间：2013-03-01T19:06:13.863
> 
> 标签：c#, asp.net, code-behind

我创建了这个方法，所以它会更新页面上的标签。我们这里有一堆复选框，指示此人是否有任何限制。当用户登录并看到复选框时，我希望标签显示已选中的复选框，以便用户更轻松地查看此人有哪些限制。

我是 C# 和 ASP.NET 的新手，我想知道，有没有更好/更简单/更有效的方法来解决这个问题？我发现的第一件事是 String.Concat，这就是我在下面的代码中使用它的原因。另外，我似乎无法在后面的代码中使用 line return (a (br /)) （我知道 (br /) 在后面的代码中不起作用）。我尝试了许多不同的方法，但似乎都没有奏效，这就是为什么我在字符串中添加了一个逗号。有什么建议么？

```
protected void LblLimitsLabel()
{
    String strBend = "", strDryDust = "", strStanding = "", strHearing = "", strHeights = "", strHepatitis = "", strLifting = "", strMachines = "", strPulling = "", strPushing = "", strReaching = "", strSeizures = "", strSuddenTemp = "", strVisual = "", strWalking = "", strWheelchair = "", strHelmet = "", strOther = "";

   if (chkBend.Checked)
       strBend = "Bend/Stoop, ";

   if (chkDryDusty.Checked)
       strDryDust = "Dry/Dusty, ";

   if (chkHearing.Checked)
       strHearing = "Hearing, ";

   if (chkHeights.Checked)
       strHeights = "Heights, ";

   if (chkHepatitis.Checked)
       strHepatitis = "Hepatitis, ";

   if (chkLifting.Checked)
       strLifting = "Lifting, ";

   if (chkMachines.Checked)
       strMachines = "Machines, ";

   if (chkPulling.Checked)
       strPulling = "Pulling, ";

   if (chkPushing.Checked)
       strPushing = "Pushing, ";

   if (chkReaching.Checked)
       strReaching = "Reaching, ";

   if (chkSeizures.Checked)
       strSeizures = "Seizures, ";

   if (chkStanding.Checked)
       strStanding = "Standing, ";

   if (chkSuddenTemp.Checked)
       strSuddenTemp = "Sudden Temp. Changes, ";

   if (chkVisual.Checked)
       strVisual = "Visual, ";

   if (chkWalking.Checked)
       strWalking = "Walking, ";

   if (chkWheelchair.Checked)
       strWheelchair = "Wheelchair, ";

   if (chkHelmet.Checked)
       strHelmet = "Helmet, ";

   strOther = TextBox1.Text;

   LblLimits.Text = String.Concat(strBend, strDryDust, strStanding, strHearing, strHeights, strHepatitis, strLifting, strMachines, strPulling, strPushing, strReaching, strSeizures, strSuddenTemp, strVisual, strWalking, strWheelchair, strHelmet, strOther);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:09:27.440

1.  使用[StringBuilder](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)构建字符串。使用 AppendLine 创建一个新行。
2.  将您的 if 语句放在单行上。像这样的简短 if 语句会更容易阅读。
3.  如果您需要在 ASP.NET 标签中出现新行，则需要嵌入`<br/>`标签。

    ```
    StringBuilder SB = new StringBuilder();

    if (chkBend.Checked) SB.AppendLine("Bend/Stoop, ");
    if (chkDryDusty.Checked) SB.AppendLine("Dry/Dusty, ");
    // and so on

    SB.Append(TextBox1.Text);
    LblLimits.Text = SB.ToString(); 
    ```

当您对 C# 和 ASP.NET 更加熟悉时，我建议您继续使用像[CheckBoxList这样的数据绑定控件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkboxlist.aspx)

**参考**

*   [字符串生成器](http://msdn.microsoft.com/en-us/library/system.text.stringbuilder.aspx)
*   [StringBuilder.AppendLine](http://msdn.microsoft.com/en-us/library/ebk18257.aspx)
*   [复选框列表](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.checkboxlist.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:19:18.383

是的，如果您不使用它，您可以在 CheckBox 的属性（如工具提示）中设置要附加到字符串的文本。然后你可以使用这个循环：

```
string s = "";
        foreach (Control item in this.Controls)
        {
            if (item is CheckBox)
            {
                CheckBox temp = item as CheckBox;
                if (temp.Checked)
                {
                    s += temp.ToolTip + ", ";
                }
            }
        }
s = s.Substring(0,s.length-3); 
```

's' 有你想要的字符串；

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:11:17.587

试试 asp.net 中的 CheckBoxList 控件。这里的例子：[http ://www.w3schools.com/aspnet/showasp.asp?filename=demo_checkboxlist](http://www.w3schools.com/aspnet/showasp.asp?filename=demo_checkboxlist)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T19:24:12.390

您可以使用更少的行代码获得相同的结果。我喜欢以这种方式使用 List，因为我不必处理尾随分隔符。

```
var checkBoxes = new CheckBox[] {chkBend, chkDryDusty, chkHearing, ...}
var values = new string[] {"Bend/Stoop", "Dry/Dusty", "Hearing", ...}

var selectedEntries = new List<string>();

for(var i = 0; i < checkBoxes.Length; i++)
{
    if (checkBoxes[i].Checked)
        selectedEntries.Add(values[i]);
}

if (TextBox1.Text != "")
    selectedEntries.Add(TextBox1.Text);

LblLimits.Text = string.Join(", ", selectedEntries.ToArray()); 
```

正如评论中所建议的，我认为多个复选框是最好的解决方案。

如果需要换行：

```
LblLimits.Text = string.Join("<br/>", selectedEntries.ToArray()); 
```

# python - 从日志文件中提取新错误并通过电子邮件发送结果

> ID：15165019
> 
> 赞同：0
> 
> 时间：2013-03-01T19:06:17.423
> 
> 标签：python, python-2.5

以下 python 2.5 脚本有效，但由于我是初学者，我想知道是否有任何明显的错误，或者是否有更好的方法来实现我想要实现的目标？

目的是打开当天的日志 - '/Library/Application Support/Perceptive Automation/Indigo 5/Logs/' 并提取包含错误一词的行并仅通过电子邮件发送新错误。提取错误行后，将计算 ( `prenumLines`) 中的行数`tmp.txt`。然后将提取的行写入`tmp.txt`文件并再次计算行数 ( `postnumLines`)。大于 的行号`prenumLines`将打印到“theBody”并通过电子邮件发送。

```
from datetime import date
import linecache

fileDate = str(date.today())

theBody = []

tmpFile = open('/Library/Application Support/Perceptive Automation/Indigo 5/Logs/tmp.txt')

prenumLines = sum(1 for line in tmpFile)

log= open( '/Library/Application Support/Perceptive Automation/Indigo 5/Logs/' + fileDate + ' Events.txt', 'r' )

tmpFile = open('/Library/Application Support/Perceptive Automation/Indigo 5/Logs/tmp.txt', 'w')

for line in log:
    if 'Error' in line: 
    tmpFile.write(line )
log.close()
tmpFile.close() 

postnumLines = sum(1 for line in open('/Library/Application Support/Perceptive Automation/Indigo 5/Logs/tmp.txt'))

lineNum  = prenumLines

while lineNum < postnumLines:
    theBody.append(linecache.getline( '/Library/Application Support/Perceptive Automation/Indigo 5/Logs/tmp.txt', lineNum + 1) )
    lineNum = lineNum + 1
tmpFile.close() 

theBody =  "".join(theBody)  

#theBody is the body of  an email which is sent next
#print theBody 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T07:22:43.237

根据我的经验，您确实应该考虑进行一些更改（我使用**must**，但这仍然只是一个建议），还有一些更符合我个人风格的更改（我使用**should**）。

在元级别上：您的问题最初仅被标记为[python-25](/questions/tagged/python-25 "显示标记为“python-25”的问题")，这可能是它没有得到任何关注的原因，您**必须**使用在 SO 上有更多追随者的[python 。](/questions/tagged/python "显示标记为“python”的问题")

您**不能**在文件中使用 TAB 和空格字符。因此，您的来源实际上在 SO 上的缩进不正确。行： `tmpFile.write(line)`应该在`if`它上面的语句下面缩进一级。

您**不能**四次使用相同的字符串作为文件名，将其替换为变量。并使用从公共基目录创建该变量`os.path.join()`

你**应该**考虑遵循[PEP8](http://www.python.org/dev/peps/pep-0008/)的 Python 风格指南。

如果您第一次尝试，您的程序将不会运行，因为“tmp.txt”不存在。以 0 的 prenumLines 优雅地失败（但是我根本不再使用它，见下文）：

```
try:
    # open the file
    # count the lines
except:
    prenumLines = 0 
```

我实际上想知道您是否声明您的代码有效，因为您覆盖`tmp.txt`并仅写入*最后一次登录*的错误行。当你`tmpFile`再次分配到的那一刻，第一个开放阅读就关闭了。然后关闭`tmpFile`打开的两次写入（Python 不会抛出错误）。如果昨天的日志有一个错误，今天有三个，您的电子邮件将只显示两行。要附加到文件，请使用 open(filename, 'a')

你**应该**考虑使用[with](http://docs.python.org/2/whatsnew/2.5.html#pep-343-the-with-statement)语句（Python 2.5 中的新语句），这样就可以省去（错误`.close()`语句）。

你**应该**考虑创建`theBody`为字符串并附加行。首先使用列表并加入它们可能会更快，但此脚本每天只运行一次。

无需计算行数，而是附加错误行，然后重新读取它们并将它们存储在 中`theBody`，您**应该**省去第一部分和第三部分，一次完成所有操作：

```
from __future__ import with_statement

import os
from datetime import date

baseDir = '/Library/Application Support/Perceptive Automation/Indigo 5/Logs'
tmpFileName = os.path.join(baseDir, 'tmp.txt')

fileDate = str(date.today())
eventFileName = os.path.join(baseDir, fileDate + ' Events.txt')

theBody = ''

with open(tmpFileName, 'a') as tmpFile:
    with open( eventFileName, 'r' ) as log:
        for line in log:
            if 'Error' in line:
                tmpFile.write(line)
                theBody += line

# theBody is the body of  an email which is sent next
print theBody 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-26T12:57:14.413

Anthon - 再次感谢您抽出宝贵时间回复。生成日志的软件是 Perceptive Automation Indigo，一个家庭自动化程序。它使用每天生成的新日志不断地写入日志。我设置 python 脚本每 10 分钟解析一次日志并查找错误，然后通过电子邮件将它们发送给我。我面临的挑战是只将新错误通过电子邮件发送给我，并避免以前发送的错误。我这样做的方法是计算 tmp.text 中的行数，然后添加新的错误，如果之前写过任何错误，它们将被覆盖，正如你提到的。因此，如果 tmp.txt 中有 5 行并添加了 3 行，它只会向我发送 3 个新行。我做了一些您建议的更改，即使用 with 语句缩短了脚本并摆脱了 close 语句。我还用变量替换了文件名。完成此操作后，脚本运行良好，但由于软件设计的原因，我无法使用包含“with statements”的脚本。我现在必须重写脚本以删除 with 语句。你帮了我很大的忙，我非常感谢你。

# java - Java & MySQL - 创建登录认证

> ID：15165024
> 
> 赞同：5
> 
> 时间：2013-03-01T19:06:32.403
> 
> 标签：java, mysql, authentication, login

我已经成功地将我的 Java 应用程序连接到 MySQL，然后我希望用户输入他们的用户名和密码。然后它会向 MySQL 发送一个查询并使用该用户名查找一个位置，然后将给出的密码与数据库中的密码进行比较。在大多数情况下，这是可行的。假设用户名是“ABC”，密码是“def”。如果提示输入用户名并输入“ABC def”，则表示成功，密码为“def a”。我相信问题出在 rs.next() 上，它只检查空格前的任何文本。

任何解决方案的想法？

```
 String databaseUsername = "";
    String databasePassword = "";

    // Check Username and Password
    System.out.print("Enter Username: ");
    String name = sc.next();
    System.out.print("Enter Password: ");
    String password = sc.next();

            // Create SQL Query
    Statement stmt = connection.createStatement();
    String SQL = "SELECT * FROM users WHERE users_name='" + name + "' && users_password='" + password+ "'";

    ResultSet rs = stmt.executeQuery(SQL);

            // Check Username and Password
    while (rs.next()) {
        databaseUsername = rs.getString("users_name");
        databasePassword = rs.getString("users_password");
    }

    if (name.equals(databaseUsername) && password.equals(databasePassword)) {
        System.out.println("Successful Login!\n----");
    } else {
        System.out.println("Incorrect Password\n----");
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:10:19.653

如果返回一行，则该语句`ResultSet`已经检查了用户名和密码。`SQL`您无需再次检查。此外，您应该建立一个不能多次使用相同用户名的系统。（`Unique`在数据库中制作或键入它）

此外，使用准备好的语句和散列密码来避免注入和其他攻击。

# php - 如何在 SQL SELECT 中插入条件？

> ID：15165029
> 
> 赞同：1
> 
> 时间：2013-03-01T19:06:56.673
> 
> 标签：php, mysql

我想通过 AJAX（到 PHP 后端）向我的数据库发出查询。我有 4 个表：Company、Users、Invoices、Invoice_Lines。重要关系如下：

```
Users.Company_ID -> Companies.ID
Invoices.Company_ID -> Companies.ID
Invoice_Lines.Invoice_ID -> Invoices.ID 
```

我用 PHP 编写了一个简单的解析器，它将提交的 SQL 查询分解为其组件（列、表和条件）。

我希望用户能够直接编写查询，但在将它们提交到 SQL 服务器之前对其进行修改，以便所有信息都受到登录用户的公司 ID 的限制。例如：

```
SELECT Users.ID, Users.Name, Users.Email
FROM Users 
```

我希望查询变为：

```
SELECT Users.ID, Users.Name, Users.Email
FROM Users
WHERE Users.Company_ID = X 
```

在一个更复杂的例子中：

```
SELECT Invoice_Lines.Subtotal
FROM Invoice_Lines
WHERE Invoice_Lines.Invoice_ID = 4 
```

变成

```
SELECT Invoice_Lines.Subtotal
FROM Invoice_Lines
INNER JOIN Invoices ON (Invoice_Lines.Invoice_ID = Invoice.ID)
INNER JOIN Company ON (Invoice.Company_ID = Company.ID)
WHERE Invoice_Lines.Invoice_ID = 4 AND Company.ID = X 
```

很明显，我必须创建与已经编写的语句不冲突的表别名。我不确定如何分析查询以确定最有效的方法是限制输入。

我打算只支持 SQL 的一个子集（带有别名的直接表列、带有表和别名的左连接和内连接以及简单的 where 表达式）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:34:19.213

同样，我建议查看 Zend Framework 如何使用[Zend_Db_Select](http://framework.zend.com/manual/1.12/en/zend.db.select.html)以 OP 方式描述 SQL 语句。

1) 定义您的基本 SQL 语句，其中包括您从中选择列的所有表。

让我们说：

```
SELECT * 
FROM table1
LEFT JOIN table2 on table2.table1Id = table1.id
LEFT JOIN table3 on table3.table2Id = table2.id
LEFT JOIN table4 on table4.table3Id = table3.id 
```

2）您将允许用户选择列（最终我也想像约束） -*使用当然可以换出对象的数组。*

```
$fields = array(
    'table1' => array(array('col1'/*actual field name*/ => 'col1_Alias' /*assigned alais*/), array('col2'=>'col2_Alias')
    'table2' => array(array('col1'=>'col1_Alias'), array('col2'=>'col2_Alias')
    etc...
); 
```

在控制器上定义它，将其用于您在用户构建查询时为用户提供的选项。然后在他们提交选择以构建 SQL 时使用它...

伪代码...

```
foreach ($selectColumns as $table => $col) {
     $cols[] = "{$table}.{$col['field']} AS {$col['alias']}";
} 
```

在该循环中，您可以跟踪引用的每个表，并可能决定您将执行的 SQL 语句中是否需要它。需要描述 JOINS 的性质才能正确执行此操作 - 再次输入 Zend_Db_Select 之类的 OOP 功能。

我的回答中没有多少肉，但希望它有所帮助。

# backbone.js - Backbonejs gmail

> ID：15165031
> 
> 赞同：0
> 
> 时间：2013-03-01T19:07:00.527
> 
> 标签：backbone.js, gmail, openid

我正在寻找如何将 gmail 登录与 Backbonejs 集成。有谁知道我可以从哪里开始？我完全糊涂了。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-02T04:36:48.750

Gmail 将需要服务器端 oauth 调用。我会推荐 NodeJS，因为它对 oAuth 有大量支持。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-26T15:08:23.337

除了 Ingro 的建议之外，您还可以创建一个简单的 Web 服务（例如使用 Java Jersey），并使用 Java Mail API 连接到您的帐户并使用来自 Backbone 客户端应用程序的一些 Ajax 调用来检索您的数据。

# java - 带有 JavaMailSenderImpl 的 Gmail smtp

> ID：15165033
> 
> 赞同：0
> 
> 时间：2013-03-01T19:07:10.977
> 
> 标签：java, spring, smtp, gmail

我正在使用以下代码用 Java 发送电子邮件。我没有收到任何错误，但电子邮件似乎没有到达（即使是垃圾邮件，我已经等了将近一天了）

```
List<SimpleMailMessage> messages = new ArrayList<>();
...
JavaMailSenderImpl sender = new JavaMailSenderImpl();
sender.setHost("smtp.gmail.com");
sender.setPort(587);
sender.setUsername("mysecretemail@gmail.com");
sender.setPassword("mysecretpassw0rd");
sender.setProtocol("smtp");
Properties mailProperties = new Properties();
mailProperties.setProperty("mail.smtp.auth", "true");
mailProperties.setProperty("mail.smtp.starttls.enable", "true");
mailProperties.setProperty("mail.smtp.quitwait", "false");

mailProperties.setProperty("mail.debug", "true");
sender.setJavaMailProperties(mailProperties);
sender.send(messages.toArray(new SimpleMailMessage[messages.size()])); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T23:20:26.007

检查您是否启用了对您帐户的 POP/IMAP 访问，如果我没记错的话，必须启用它才能使 SMTP 正常工作。至于 java 邮件属性，这个代码在几年前曾经工作过：

```
 Session mailSession = Session.getDefaultInstance(new Properties(), null);
    Properties props = mailSession.getProperties();
    props.put("mail.smtp.host", "smtp.gmail.com");
    props.put("mail.smtp.auth", "true");
    props.put("mail.debug", "true");
    props.put("mail.smtp.port", "465");
    props.put("mail.smtp.socketFactory.port", "465");
    props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
    props.put("mail.smtp.socketFactory.fallback", "false"); 
```

# angularjs - 从 AngularJS 中的父控制器调用指令控制器的方法

> ID：15165036
> 
> 赞同：4
> 
> 时间：2013-03-01T19:07:27.147
> 
> 标签：angularjs

我正在使用 AngularJS，并且我有一个指令，它有自己的控制器。它继承了父控制器的范围。

例如，考虑以下情况：

```
function ParentCtrl() {
    $scope.aMethod = function() {
        // DO SOMETHING
    };
}

function ChildCtrl() {
    $scope.bMethod = function() {
        // DO SOMETHING ELSE
    }
} 
```

现在，`$scope.aMethod`ParentCtrl() 由 ng-click 指令触发。我想做的是调用`$scope.bMethod`ChildCtrl()。我该怎么做？

编辑：更多信息。与 ParentCtrl 关联的模板有一个按钮和多个指令。每个指令加载具有不同输入集的表单。当点击 ParentCtrl 模板中的按钮时，通过 和 依次加载`ng-switch on`指令`ng-switch-when`。
当用户单击按钮时，属于指令的 ChildCtrl 旨在以各自的形式存储数据。
因此，当单击按钮时：
1\. ChildCtrl 保存与已加载的当前指令关联的模型。
2\. ParentCtrl 加载系列中的下一个指令。
`ng-click`绑定到与 ParentCtrl 关联的按钮。但是当单击该按钮时，ChildCtrl 还需要执行一些操作（保存表单数据）。如何做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-01T19:42:38.997

请看以下内容。

我正在使用`$broadcast`. 我已经厌倦了复制您给出的场景，例如父控制器，带有自己的控制器的子指令等：

```
var animateAppModule = angular.module('animateApp', [])
animateAppModule.controller('tst', function($scope) {
  $scope.test = function() {
    $scope.$broadcast('clickMessageFromParent', {
      data: "SOME msg to the child"
    })
  }
}).directive('myDirective', function() {
  return {
    controller: function($scope) {

    },
    link: function($scope, element) {
      $scope.$on('clickMessageFromParent', function(scopeDetails, msgFromParent) {
        //console.log(msgFromParent)
        element[0].innerHTML = msgFromParent.data;
      })
    }
  }
})
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>
<div ng-controller="tst">
  <input type="button" ng-click="test()" value="click" />
  <div my-directive="somvalue"></div>
</div>
```

[JSFiddle](http://jsfiddle.net/CRbKf/)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T20:43:41.340

这类似于 rajkamal 所说的，因为您需要使用广播......但是您需要动态更改广播以针对您需要的任何孩子。

[这是一个显示示例的 plunker](http://plnkr.co/edit/qpPK6p6c4FQ6A3MYI1n3)

这是代码：

```
app.controller('MainCtrl', function($scope) {

  // a method that broadcasts to a selected child.
  $scope.broadcastToSelectedChild = function (){
    $scope.$broadcast('call-' + $scope.broadcastTo);
  };
});

app.directive('testDir', function (){
  return {
    restrict: 'E',
    scope: {
      'name': '@'
    },
    template: '<div>{{name}} called: {{called}}</div>',
    link: function(scope, elem, attr) {

      scope.called = false;

      //a child function to call.
      scope.childFunction = function (){
        scope.called = true;
      };

      //set up the name to be used as the listened to event.
      var removeOn;
      scope.$watch('name', function(v) {
        if(removeOn) removeOn();
        removeOn = scope.$on('call-' + scope.name, function (){
            scope.childFunction();
          });
      });
    }
  };
}); 
```

这里是 HTML：

```
 <div ng-controller="MainCtrl">
    <test-dir name="test1"></test-dir>
    <test-dir name="test2"></test-dir>
    <test-dir name="test3"></test-dir>
    <select ng-model="broadcastTo" ng-options="x as x for x in ['test1', 'test2', 'test3']"></select>
    <button ng-click="broadcastToSelectedChild()">test</button>
  </div> 
```

我在这里所做的是创建一种机制，通过该机制我可以命名我的指令，然后按名称向它们广播。如果代码不是自我解释的，请告诉我。我希望这有帮助。

# extjs3 - extjs 消息框自定义

> ID：15165037
> 
> 赞同：0
> 
> 时间：2013-03-01T19:07:35.877
> 
> 标签：extjs3

在最基本的形式中，EXTJS 提示符是这样的：

```
Ext.MessageBox.prompt('Name', 'Please enter your name:', showResultText);
}); 
```

现在在我的应用程序中，有一个样式表将所有消息框呈现为灰色。并且按钮也是灰色的，因此按钮与提示框的灰色背景无法区分。那么有没有办法自定义提示，以便我可以在按钮 Ok 和 Cancel 周围放置边框？我的另一个问题是：有没有办法在提示框中放置一个帮助图标？在 MessageBox 中，有一个名为 ICON 的配置选项。有没有办法在提示中使用这个选项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-07T18:34:33.150

**1）在提示框中添加图标：**

`Ext.MessageBox.prompt`只是提供一些默认选项的包装器方法，`Ext.MessageBox.show`因此您可以创建一个不同的包装器方法来使用您自己的选项，然后您可以轻松地`Ext.MessageBox.prompt`使用自定义提示包装器覆盖

```
var customPrompt = function(title, msg, fn, scope, multiline, value){
     Ext.MessageBox.show({
          title : title,
          msg : msg,
          buttons: Ext.MessageBox.OKCANCEL,
          fn: fn,
          minWidth: Ext.MessageBox.minPromptWidth,
          scope : scope,
          prompt:true,
          multiline: multiline,
          value: value,
          icon : Ext.MessageBox.QUESTION
     });
     return Ext.MessageBox;
};

customPrompt('title', 'message'); 
```

* * *

**2）改变按钮的样式：**

按钮元素存储在对话框组件中以供参考，因此您可以获取这些元素并将自定义类添加到按钮

```
var dlg =  Ext.MessageBox.getDialog();
var buttons = dlg.buttons;
for(i = 0; i < buttons.length; i++) {
     buttons[i].addClass('custom-css-class');   // class that will do styling of buttons
} 
```

# facebook - 同时喜欢多个 Facebook 页面？

> ID：15165038
> 
> 赞同：0
> 
> 时间：2013-03-01T19:07:36.733
> 
> 标签：facebook, facebook-graph-api, facebook-like, facebook-page

有什么方法可以在 facebook 上同时点赞多个页面？例如，用户可能有一个附加了检查按钮的页面列表，当按下按钮时，所有被检查的页面都应该得到一个赞。那可能吗？

# mysql - UPDATE 查询取决于前一行的值

> ID：15165041
> 
> 赞同：1
> 
> 时间：2013-03-01T19:07:46.877
> 
> 标签：mysql, sql, moving-average

我正在尝试使用带有 MySQL 的 SQL 查询来计算 200 行指数移动平均线 (EMA)。每行取决于前一行的值。公式为：

```
EMA = ((price - EMA(previous_average)) * (2 / (200 + 1))) + EMA(previous_average) 
```

我的桌子最初看起来像

```
id       price      average
---------------------------
1        29.05      29.05000000
2        29.04       0.00000000
3        29.06       0.00000000
4        29.05       0.00000000 
```

（我手动将第一行的“平均值”设置为“价格”，所以下面的查询有一个初始值）

运行此查询

```
UPDATE
  quotes
INNER JOIN
  quotes AS quotes_previous ON quotes_previous.id = table.id - 1
SET
  table.average = ((quotes.price - quotes_previous.average) * (2 / (200 + 1)) + quotes_previous.average)
where
  quotes.id > 1 
```

我的桌子看起来像

```
id       price      average
---------------------------
1        29.05      29.05000000
2        29.04      29.04990050
3        29.06       1.13937059
3        29.05       1.13927205 
```

如您所见，除前两行外，其他所有行的平均值显然不正确。

我认为问题在于查询需要按 id 顺序更新行。但是当我在查询中添加“ORDER BY id”时，我得到“错误 1221 (HY000)：UPDATE 和 ORDER BY 的使用不正确”。我相信我不能在 UPDATE 查询中将 ORDER BY 与 JOIN 一起使用。

那么，如何运行取决于前一行值的 UPDATE 查询？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T09:55:26.753

尝试这个

```
UPDATE quotes q INNER JOIN 
(SELECT id,
       price,
       ((price - @prev) * (2 / (200 + 1))) + @prev average,
       @prev = ((price - @prev) * (2 / (200 + 1))) + @prev
  FROM quotes, (SELECT @prev := (SELECT price FROM quotes ORDER BY id LIMIT 1) i) n
 ORDER BY id) t ON q.id=t.id
   SET q.average = t.average 
```

输出

```
+------+-------+-------------+
| id   | price | average     |
+------+-------+-------------+
|    1 | 29.05 | 29.05000000 |
|    2 | 29.04 | 29.04990050 |
|    3 | 29.06 | 29.05009950 |
|    4 | 29.05 | 29.05000000 |
+------+-------+-------------+ 
```

这意味着重新运行是安全的，因为它从具有最低 id 的行的价格列中获取第一个平均值。

# wpf - Windows Phone 8 Dispatcher.BeginInvoke 无法异步工作

> ID：15165043
> 
> 赞同：2
> 
> 时间：2013-03-01T19:07:54.003
> 
> 标签：wpf, multithreading, asynchronous, windows-phone-8, event-dispatching

我是异步编程和 WP8 的新手，这是我的第一个应用程序，但 Dispatcher.BeginInvoke(..)

在视图类后面的代码中，我试图在第二个选项卡的 Pivot scree 异步中加载数据。

这是我现在拥有的：

```
public partial class ReminderPivot : PhoneApplicationPage
    {
        #region Reminder Members
        private ReminderViewModel _model;
        private IRepository _repository;
        #endregion Reminder Members

        #region Constructors
        public ReminderPivot()
        {
            InitializeComponent();
            _model = new ReminderViewModel();
            _repository = new LocalStorageRepository();

            LoadData();
            LoadAsyncData();

            this.DataContext = _model;

        }
        #endregion Constructors

        public void LoadData()
        {
            IEnumerable<Reminder> activeList = _repository.GetRemindersByStatusId(2);
            if (activeList != null)
            {
                foreach (var reminder in activeList)
                {
                    _model.ActiveReminders.Add(reminder);
                }
            }
        }
        public void LoadAsyncData()
        {            
            Action action = () =>
            {
                Thread.Sleep(5000);

                IEnumerable<Reminder> inactiveList = _repository.GetRemindersByStatusId(3);
                if (inactiveList != null)
                {
                    _model.InctiveReminders = new System.Collections.ObjectModel.ObservableCollection<Reminder>(inactiveList);
                }
            };

           Dispatcher.BeginInvoke(action);
        } 
```

问题是这仍然阻塞了我的 UI 线程。我在这里想念什么？

编辑：想法是将数据异步加载到 ViewModel ObservableCollection 中，它是 XAML 中的 ModelBinded。

如果我尝试使用 Task.Factory(...) 等在另一个线程上进行异步调用，那么这会崩溃，因为我正在从另一个线程而不是 UI 线程更改绑定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:00:37.957

在@PedroLamas 的建议之后，我让它工作，不确定这是最好的方式还是最优雅的方式，但它完成了工作。

我使用 Task.Factory 在另一个线程上完成调用需要时间并使其可等待，最后只需使用 Dispatcher 更新 UI。

```
public async void LoadAsyncDataWithTask()
        {
            IEnumerable<Reminder> inactiveList = null;
            Action action = () =>
            {
                Thread.Sleep(2000);
                inactiveList = _repository.GetRemindersByStatusId(2);
            };

            await Task.Factory.StartNew(action);

            Action action2 = () =>
            {
                if (inactiveList != null)
                {
                    foreach(var item in inactiveList)
                    {
                        _model.InctiveReminders.Add(item);
                    }
                }
            };

            Dispatcher.BeginInvoke(action2);

        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:34:46.653

虽然您发现的工作和使用`Task`是最新的，但通过使用`Thread.Sleep`您仍然会无缘无故地阻塞 ThreadPool 中的线程。

您可以通过使用一次性`System.Threading.Timer`（[请参阅 MSDN 参考](http://msdn.microsoft.com/en-us/library/system.threading.timer%28v=vs.95%29.aspx)）来避免这种情况，它将在（后台）ThreadPool 线程之一上触发。然后`Dispatcher.BeginInvoke(...)`在计时器回调结束时使用 a 来更新 UI。

例如：

```
 var timer = new System.Threading.Timer(
            state =>
                {
                    // ... your code to run in background

                    // ... call BeginInvoke() when done
                    Dispatcher.BeginInvoke(() => MessageBox.Show("done"));
                },
            null,
            5000,
            System.Threading.Timeout.Infinite); 
```

# c# - 如何让实体框架与我的分离对象图一起工作？

> ID：15165047
> 
> 赞同：0
> 
> 时间：2013-03-01T19:08:18.770
> 
> 标签：c#, asp.net-mvc-4, entity-framework-5

在我的应用程序中，我们`DbContext`为每个 HTTP 请求获取了一个新实例。在正常的工作流程中，我们创建一个实体并开始填充它的导航属性的一部分：

```
// Request 1
var foo = new Foo();
SessionStore.Add("Foo", foo);

// Request 2
var bar = BarDataService.GetBar(barId);

var foo = SessionStore.Get<Foo>("Foo");
foo.Bars.Add(bar);

// Request 3
var baz = BazDataService.GetBaz(bazId);

var foo = SessionStore.Get<Foo>("Foo");
foo.Baz = baz; 
```

一旦对象图完全填充，我们将实体插入数据库：

```
var foo = SessionStore.Get<Foo>("Foo");
FooDataService.Add(foo); // BOOM! 
```

Add 通常只是将实体添加到`DbSet`然后调用保存更改：

```
Set.Add(entity);
Context.SaveChanges(); 
```

显然，这失败了，因为该`foo`对象包含多个代理对象，每个代理对象都附加到不同的`DbContexts`. 我们决定的解决方案是分离我们收到的对象：

```
// Request 2 (modified)
var bar = BarDataService.GetBar(barId);
BarDataService.Detach(bar);
foo.Bars.Add(bar);

// Similar code for Request 3

var foo = SessionStore.Get<Foo>("Foo");
FooDataService.Add(foo); // Works 
```

这行得通，*除了*它现在创建了`Bar`和`Baz`对象的新实例。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T00:42:11.757

在添加到上下文之前，您必须附加相关的`Bar`和`Baz`对象。`foo`这会将实体置于状态`Unchanged`，EF 只会创建`foo`相关实体之间的关系，而不是在数据库中创建新的`Bar`和`Baz`对象：

```
foreach (var bar in foo.Bars)
    context.Bars.Attach(bar);
context.Bazs.Attach(foo.Baz);
context.Foos.Add(foo);
context.SaveChanges(); 
```

# python - matplotlib datetime xlabel问题

> ID：15165065
> 
> 赞同：10
> 
> 时间：2013-03-01T19:09:30.717
> 
> 标签：python, datetime, matplotlib, plot

我在 matplotlib 中的日期的 x 轴自动标记中看到一些奇怪的行为。当我发出命令时：

```
from datetime import datetime as dt
plot( [ dt(2013, 1, 1), dt(2013, 5, 17)], [ 1 , 1 ], linestyle='None', marker='.') 
```

我得到了非常合理的标记图表：

![在此处输入图像描述](../Images/0c6406fc209ff5c4efccf1edaec16332.png)

但如果我将结束日期增加 1 天：

```
plot( [ dt(2013, 1, 1), dt(2013, 5, 18)], [ 1 , 1 ], linestyle='None', marker='.') 
```

我明白了：

![在此处输入图像描述](../Images/3dca16c20437ee58f98a64b715e49c2d.png)

我已经在几个不同的日历日期范围（2012 年）复制了这个，每次触发 bug 所需的神奇天数大约是 140 天（在本例中为 136/137）。有人知道这里发生了什么吗？这是一个已知的错误，如果是，是否有解决方法？

几点注意事项：在上面的命令中，我在 --pylab 模式下使用 IPython 来创建绘图，但我第一次遇到这个问题是直接使用 matplotlib 的，它可以以脚本形式重现（即我不认为这是一个 IPython 问题）。此外，我在 matplotlib 1.1.0 和 1.2.X 中都观察到了这一点。

更新：

看起来有一个窗口，如果你向前推得足够远，标签会再次开始正常运行。对于上面的示例，从 5 月 18 日到 5 月 31 日，标签仍然是乱码，但在 6 月 1 日，标签又开始正常绘图。所以，

```
(labels are garbled)
plot( [ dt(2013, 1, 1), dt(2013, 5, 31)], [ 1 , 1 ], linestyle='None', marker='.')

(labels are fine)
plot( [ dt(2013, 1, 1), dt(2013, 6, 1)], [ 1 , 1 ], linestyle='None', marker='.') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-06T14:53:41.947

它是由`AutoDateLocator`. 似乎此错误尚未报告给问题跟踪器。
它看起来很奇怪，只是因为绘制了太多的标签和刻度。

当使用带有日期的数据进行绘图时，默认情况下，matplotlib`matplotlib.dates.AutoDateLocator`用作主要定位器。即，`AutoDateLocator`用于确定刻度间隔和刻度位置。

假设，数据序列由 给出`[datetime(2013, 1, 1), datetime(2013, 5, 18)]`。
时间增量为 4 个月零 17 天。月增量为 4，日增量为 4*31+17=141。

根据[matplotlib 文档](http://matplotlib.org/api/dates_api.html#matplotlib.dates.AutoDateLocator)：

> 类 matplotlib.dates.AutoDateLocator(tz=None, minticks=5, maxticks=None, interval_multiples=False)
> 
> > minticks 是所需的最小刻度数，用于选择刻度类型（每年、每月等）。
> > 
> > maxticks 是所需的最大滴答数，它控制滴答之间的任何间隔（每隔一个、每 3 个等）。对于真正细粒度的控制，这可以是一个字典，将单个规则频率常数（每年、每月等）映射到它们自己的最大刻度数。这可用于保持刻度数适合于在 class:AutoDateFormatter 中选择的格式。此字典中未指定的任何频率都被赋予默认值。
> > 
> > AutoDateLocator 有一个间隔字典，它映射滴答的频率（来自 dateutil.rrule 的常数）和该滴答允许的倍数。默认如下所示：
> > 
> > ```
> >  self.intervald = {
> >       YEARLY  : [1, 2, 4, 5, 10],
> >       MONTHLY : [1, 2, 3, 4, 6],
> >       DAILY   : [1, 2, 3, 7, 14],
> >       HOURLY  : [1, 2, 3, 4, 6, 12],
> >       MINUTELY: [1, 5, 10, 15, 30],
> >       SECONDLY: [1, 5, 10, 15, 30]
> >       }
> > ```
> > 
> > 间隔用于指定适合滴答频率的倍数。例如，对于每日刻度，每 7 天是合理的，但对于分钟/秒，15 或 30 是有意义的。您可以通过执行以下操作自定义此字典：

由于月 delta 为 4，小于 5，而日 delta 为 141，不小于 5。tick 的类型将是每天。
在解析了tick的类型后，`AutoDateLocator`会使用interval字典和maxticks字典来确定tick的间隔。

当`maxticks`is时`None`，`AutoDateLocator`使用其默认的 maxticks 字典。文档向我们展示了默认的区间字典，并没有告诉我们默认的 maxticks 字典是什么样的。
我们可以在[dates.py](https://github.com/matplotlib/matplotlib/blob/v1.2.x/lib/matplotlib/dates.py#L727)中找到它。

```
self.maxticks = {YEARLY : 16, MONTHLY : 12, DAILY : 11, HOURLY : 16,
            MINUTELY : 11, SECONDLY : 11} 
```

[确定刻度间隔的算法](https://github.com/matplotlib/matplotlib/blob/v1.2.x/lib/matplotlib/dates.py#L805)是

```
# Find the first available interval that doesn't give too many ticks
for interval in self.intervald[freq]:
    if num <= interval * (self.maxticks[freq] - 1):
        break
else:
    # We went through the whole loop without breaking, default to 1
    interval = 1 
```

滴答的类型是`DAILY`现在。日差141 也是`freq`如此。上面的代码将等价于`DAILY``num`

```
for interval in [1, 2, 3, 7, 14]:
    if 141 <= interval * (11 - 1):
        break
else:
    interval = 1 
```

141 太大了。所有的每日间隔都会给出太多的滴答声。`else`子句将被执行，刻度间隔将设置为 1。
这意味着将绘制 140 多个标签和刻度。我们可以期待一个丑陋的 x 轴。

如果数据序列由 给出`[datetime(2013, 1, 1), datetime(2013, 5, 17)]`，则仅短一天。日期增量为 140。然后`AutoDateLocator`将选择 14 作为刻度间隔，并且仅绘制 10 个标签。因此，您的第一张图看起来不错。

实际上我不明白为什么如果`maxticks`约束不能满足，matplotlib 选择将间隔设置为 1。如果间隔为 1，它只会导致更多的滴答声。我更喜欢使用最长的间隔。

**结论：**
给定范围大于或等于 4 个月 18 天且小于 5 个月的任何日期序列，`AutoDateLocator`将选择 1 作为刻度间隔。当使用默认的主要定位器（即`AutoDateLocator`.

**解决方案：**
最简单的解决方案是将每日 maxticks 增加到 12。例如：

```
import numpy as np
import matplotlib.pyplot as plt
from matplotlib.dates import DAILY
from datetime import datetime

ax = plt.subplot(111)
plt.plot_date([datetime(2013, 1, 1), datetime(2013, 5, 31)],
              [datetime(2013, 1, 1), datetime(2013, 5, 10)])

loc = ax.xaxis.get_major_locator()
loc.maxticks[DAILY] = 12

plt.show() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T10:00:39.410

它确实感觉像一个错误。我会把它带到 matplotlib 邮件列表，看看那里的人能说些什么。

我可以提供的一种解决方法如下：

```
from datetime import datetime as dt
from matplotlib import pylab as pl

fig = pl.figure()
axes = fig.add_subplot(111)
axes.plot( [ dt(2013, 1, 1), dt(2013, 5, 18)], [ 1 , 1 ], linestyle='None', marker='.')
ticks = axes.get_xticks()
n = len(ticks)//6
axes.set_xticks(ticks[::n])
fig.savefig('dateticks.png') 
```

为 OO 方法道歉（这不是您所做的），但这使得将刻度与情节联系起来变得容易得多。该数字`6`只是我想要沿 x 轴的标签数量，然后我通过计算的`n`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-15T12:01:13.670

您需要将 locator.MAXTICKS 重置为更大的数字以避免错误：超过 Locator.MAXTICKS * 2 (2000)

例如：

```
 alldays = DayLocator()              # minor ticks on the days
    alldays.MAXTICKS = 2000 
```

# c# - 你如何解析这个json（带$）？

> ID：15165067
> 
> 赞同：1
> 
> 时间：2013-03-01T19:09:36.280
> 
> 标签：c#, json, google-api, restsharp

我将我的 google api 结果设置为返回 Json 而不是 xml 但是当我看到这个时我有点困惑

```
 "openSearch$totalResults":{
         "$t":"3"
      }, 
```

我不明白`$t:3`它的用途以及如何将这些信息实际存储在属性中。我正在使用restsharp，但我不能这样做

```
 public string $t3 { get; set; } 
```

因为那是非法字符。如果我`openSearch$totalResults`因为“$”符号而再次这样做。另外，我认为如果我能做到，它会存储“$t:3”，我必须解析它，这会有点蹩脚。

# animation - d3: 像 Heer 和 Robertson 那样将条形图动画化为饼图？

> ID：15165069
> 
> 赞同：1
> 
> 时间：2013-03-01T19:09:45.100
> 
> 标签：animation, d3.js

[使用 d3 制作本研究](http://vis.berkeley.edu/papers/animated_transitions/)中发现的动画有多难？特别是把条形图动画成圆环图成饼状图流畅吗？

我的想法是首先用 d3.svg.arc 形成的“路径”元素替换条形图中的“rect”——使用半径很大的弧，但只取它的楔形，这样它was 看起来几乎像一个“矩形”，但略微弯曲。替换完成后，您可以在“路径”元素中为圆弧的半径和角度设置动画，并将其移动到您想要的甜甜圈形状中。从甜甜圈到派的最终过渡将是微不足道的，只需为 innerRadius 设置动画即可。

但是，我想知道是否有更好的方法来实现这一点，或者可能已经编写了一些插件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T19:30:42.353

[此示例](http://d3-example.herokuapp.com/examples/showreel/showreel.html)具有（几乎）您正在寻找的转换。

# python - py2exe cmd失败

> ID：15165070
> 
> 赞同：0
> 
> 时间：2013-03-01T19:09:46.280
> 
> 标签：python

我编写了一个 python 脚本并将 py2exe 0.6.9 (win32) 安装到具有 Python 2.7 的 32bit-Windows7 机器上。我可以通过 cmd 成功运行“python setup.py py2exe”。现在我将 py2exe 0.6.9 (win64) 安装到第二台 PC（Win7、64 位、Python2.7）并尝试对完全相同的脚本进行相同的操作：但是“python setup.py py2exe”返回了此消息（希望我翻译正确成英文）：“命令'python'要么写错了，要么找不到。” 为什么会这样？我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:12:13.663

这与 无关，`py2exe`与机器的设置有关。

你没有`python`在你的道路上。您可以`python`通过自行运行以打开交互式解释器来测试它。如果`cmd`找不到`python`，则无法运行。

以下是一些解决方法：

*   显式使用 Python 的完整路径——例如，如果它是`C:\Python27\bin\Python.exe`，则键入它而不是仅仅`python`.
*   `cmd`在窗口中临时编辑您的 PATH 环境变量。对于上面的示例，这将是`set PATH=%PATH%;C:\Python27\bin`. 每次重新启动、打开新`cmd`窗口等时，您都必须再次执行此操作。
*   永久编辑您的 PATH 环境变量。这是在“高级系统设置”控件中完成的，我相信仍然可以通过 Windows 7 中“我的电脑”的上下文菜单上的“属性”访问这些控件。
*   卸载并重新安装 Python，这一次让它自己走上你的道路。
*   在超级用户或其他专注于系统配置问题而不是编程问题的站点上寻求进一步的帮助。

# c++ - 使用类方法打印数组的内容

> ID：15165071
> 
> 赞同：0
> 
> 时间：2013-03-01T19:09:51.450
> 
> 标签：c++, arrays, oop, printing

我正在尝试将“房间”对象的二维数组的内容作为数组中内容的一种打印/显示返回。

```
Room* m_map[10][10]; 
```

像这样生成房间的分散：

```
//Initialise array to NULL
for(int x=0;x<10;x++)
{
    for(int y=0;y<10;y++)
        m_map[x][y] = NULL;
}

for(int n=0; n<10; n++)
{       
    for(int ran=0; ran<3; ran++)
    {
        int r_n = rand() % 10 ;

        Room* r = new Room(n, "Normal", true, false, false, true);
        m_map[r_n][n] = r;
    }       

} 
```

然后，我想参考 NULL 为用户显示/打印这些房间所在的位置。

所以我可以例如如果NULL显示'#'，如果它是一个房间离开一个''。

我不确定我应该在方法声明中返回的位？

任何帮助或指出正确的方向将不胜感激

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:18:20.063

添加一个将数组打印到您的类的方法：

```
void print() const 
{
  for(int n=0; n<10; ++n)
  {       
    for(int m=0; m<10; ++m)
    {
      std::cout << m_map[n][m] ? : "# " : ". ";
    }
    std::cout << "\n";
  }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:21:17.843

循环通过两个维度。每次循环通过 x 显示一列中的所有房间并在之后附加一个逗号。

当到达一行的末尾并移动到下一行时，只需附加一个换行符即可在新行上打印下一列。

```
void MyClass::printMap(unsigned int numOfRows, unsigned int numOfCols)
{
  using std;
  for(unsigned int y = 0; y < numOfRows ; y++)
  {
    for(unsigned int x = 0; x < numOfCols ; x++)
    {
       if(m_map[y][x] == NULL)
          cout << # << ",";
       else
          cout << m_map[y][x].roomName() << ",";   
    }

    cout << endl;
  }
} 
```

# ember.js - 资源嵌套是启用多个动态段的唯一方法吗？

> ID：15165072
> 
> 赞同：13
> 
> 时间：2013-03-01T19:09:56.123
> 
> 标签：ember.js, ember-router

这似乎表明答案是肯定的：

[从 Ember Pre1 到 Pre4：每条路线有多个动态分段？更新：动态段允许的语法是什么？](https://stackoverflow.com/questions/14775420/from-ember-pre1-to-pre4-multiple-dynamic-segments-per-route-update-what-is-th)

...但我只是想确认一下。

就我而言，作为一项学习练习，我正在 Ember 中构建一个带有每月显示的日历。我需要能够从给定的月份链接到上个月和下个月。

所以我希望能够

```
{{ linkTo calendar_month year month }} 
```

和

```
this.transitionTo('calendarMonth', year, month) 
```

想知道在不使用嵌套资源的情况下这是否可行。我可以让它与类似的东西一起工作：

```
App.Router.map(function() {
  this.resource("year", { path: "calendar/:year" }, function() {
    this.resource("calendar_month", { path: "/:month" }, function() {
      this.route('index');
    });
  });
}); 
```

...但这涉及引入一个 Year 对象，从建模的角度来看，它可能并不真正需要存在，这样我就可以在 linkTo 中使用它的 id

我更喜欢使用两个参数/动态段设置路线：

```
App.Router.map(function() {
  this.route('calendar_month', { path: 'calendar/:year/:month'});
}); 
```

但我是否正确，这是不可能的？我只是想确保我以最干净、最简洁的方式来做这件事。

换一种方式：

我理解“如果你的用户界面是嵌套的，那么你的路由应该是嵌套的”这个概念，但是，如果我的 url 是嵌套的，这并不一定意味着我的界面也会嵌套。所以我想知道：如果我的 url 是嵌套的，那么构建相应的嵌套模型是否总是最佳实践？

非常感谢任何指导/澄清。

谢谢，

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-02T12:58:32.917

因为我是你提到的问题的提问者，所以我在这里回答。我已经更新了我的问题，这是完全可能的。

您的方法应该有效：

```
App.Router.map(function() {
  this.route('calendar_month', { path: 'calendar/:year/:month'});
}); 
```

您只需添加序列化和模型挂钩实现：

```
serialize: function(context){
    // i assume that you wrap year and month in an Object (maybe App.YearAndMonthObject)
    var ret = {
        year : context.get("year"),
        month : context.get("month")
    };
    return ret;
},
model : function(params){
    //somehow create your object from the params
    var model = App.YearAndMonthObject.create({
        year : params.year,
        month : params.month
    });
    return model;
} 
```

这还需要修改您对 linkTo 的使用：

```
{{ linkTo calendar_month year month }} 
```

...相反，您只需使用：

```
{{ linkTo calendar_month yearAndMonth }} 
```

我认为这是处理这个问题的一种方式。

*摘要：那么路线到底是什么？*

> 它们**用于分离关注点**。在您的情况下，似乎是这样，**那一年和那一个月是同一个问题 (=route) 的一部分**。因此它们应该被包装在一个新的 Ember 对象中，并且您的路线 (CalendarMonthRoute) 应该处理这个新对象（可能是 YearAndMonthObject 或 CalendarMonthObject？）。

# c# - Linq可以做到吗？

> ID：15165074
> 
> 赞同：0
> 
> 时间：2013-03-01T19:09:59.250
> 
> 标签：c#, asp.net, linq, entity-framework

下面我试图传入一个整数列表，以将具有 productID == 的所有产品返回给每个整数。

```
 public IQueryable<Product> GetProductsForSubCat(List<int> prodSubResult)
        {

            if (prodSubResult != null)
            {
                var _db = new ProductContext();

                IQueryable<Product> query = _db.Products;

                foreach (int x in prodSubResult)
                {
                     query = _db.Products.Where(p => p.ProductID == x);

                }
                    return query;
            }
            return null;
        } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T19:11:26.960

是的，您可以，而且非常简单：

```
var query = _db.Products.Where(p => prodSubResult.Contains(p.ProductId)); 
```

# ruby-on-rails - 在数组中切片哈希

> ID：15165081
> 
> 赞同：0
> 
> 时间：2013-03-01T19:10:23.347
> 
> 标签：ruby-on-rails, arrays, hash

我有一个哈希数组，例如：

```
[{"name"=>"John Doe", "id"=>"1"}, {"name"=>"Jane Doe", "id"=>"2"}] 
```

我只想取回一个 id 数组。这样做的有效方法是什么？我宁愿避免使用循环。

谢谢你。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:14:34.457

你应该做：

```
your_array.map {|h| h["id"]} 
```

但基本上有一个伪装的循环。

边注：

想象一下`id`其中一个哈希中没有，那么您将拥有一个`nil`. 追加`compact`解决这个问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-04T05:31:22.457

你应该做：

```
your_array.pluck(:id) 
```

这比`map (loop)`

相同的用途`compact`删除`nil`

# javascript - 在上传期间检查文件大小并使用javascript停止上传超出文件大小限制？

> ID：15165087
> 
> 赞同：0
> 
> 时间：2013-03-01T19:10:50.627
> 
> 标签：javascript, jquery

有没有办法使用 javascript 或 jquery 来检查文件上传的进度（即服务器收到了多少字节或 kb）并在超过一定限制时切断上传，向用户显示警告/错误消息? 谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:14:43.600

这个例子可能会帮助你：http: [//js1.hotblocks.nl/tests/ajax/file-drag-drop.html](http://js1.hotblocks.nl/tests/ajax/file-drag-drop.html)

（它还包括拖放界面，但很容易被忽略。）

基本上它归结为：

```
<input id=files type=file>

<script>
document.getElementById('files').addEventListener('change', function(e) {
    var file = this.files[0];
    var xhr = new XMLHttpRequest();
    xhr.file = file; // not necessary if you create scopes like this
    xhr.addEventListener('progress', function(e) {
        var done = e.position || e.loaded, total = e.totalSize || e.total;
        console.log('xhr progress: ' + (Math.floor(done/total*1000)/10) + '%');
    }, false);
    if ( xhr.upload ) {
        xhr.upload.onprogress = function(e) {
            var done = e.position || e.loaded, total = e.totalSize || e.total;
            console.log('xhr.upload progress: ' + done + ' / ' + total + ' = ' + (Math.floor(done/total*1000)/10) + '%');
        };
    }
    xhr.onreadystatechange = function(e) {
        if ( 4 == this.readyState ) {
            console.log(['xhr upload complete', e]);
        }
    };
    xhr.open('post', url, true);
    xhr.send(file);
}, false);
</script> 
```

在进度方法中，您获得了文件大小等。我希望这可以解决您的问题。问候。

# ruby-on-rails - Railroady 如何在应用程序文件夹中包含所有宝石的类？

> ID：15165089
> 
> 赞同：0
> 
> 时间：2013-03-01T19:10:57.463
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我对 railroady gem ( [https://github.com/preston/railroady](https://github.com/preston/railroady) ) 有疑问。

在我的应用程序根文件夹中，我有：

```
-app
-some_gem
-some_other_gem
-...<others standard folders> 
```

我想使用 railroady 制作图表，但它仅包含 app 文件夹中的类。我尝试使用所有可用的选项 -m -a -p 等等，但它没有帮助。如何在根文件夹中包含所有 gem 的类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:19:10.813

您应该使用 Bundler 来指定您的 gem 依赖项，而不是将它们存储在根文件夹中。

# reporting-services - SSRS 处理在哪里进行？

> ID：15165096
> 
> 赞同：0
> 
> 时间：2013-03-01T19:11:19.653
> 
> 标签：reporting-services, remote-server

我用谷歌搜索了这个问题，但从未找到合适的答案。我想弄清楚的是 SSRS 和 SQL 服务器之间有多少数据流。我需要在远程站点（通过良好的连接）查询数据。我正在尝试决定是否应该在远程站点（所有本地站点）定位 ReportServer 和/或 ReportServer DB。

假设我在服务器 A 上安装了 SSRS，在服务器 B 上安装了 SQL 数据源。我运行一个报告，该报告返回数千行，然后在 SSRS 报告中聚合。显然，源查询运行在 SQL 服务器上。我不确定在哪里处理这些结果（例如计算聚合）。它是在 SQL 服务器上完成的（例如，输出是否被写入 SQL 服务器上的临时表，然后全部在那里处理）？

它是否传递回 SSRS 服务器并在那里完成。

当我有默认折叠的向下钻取报告时，当我向下钻取（展开部分）时是否需要往返服务器，或者客户端中的数据只是不可见？

我敢肯定那里一定有一些文档，只是找不到。

问候

标记

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T08:48:44.837

据我所知，您在 ReportServer 上处理的所有表达式。您可以在此处阅读有关 SSRS 的一些基本信息：http: [//msdn.microsoft.com/en-us/library/ms157231.aspx](http://msdn.microsoft.com/en-us/library/ms157231.aspx)

这是 SSRS 本机模式结构的图像（来自 MSDN）：

![来自 MSDN，SSRS Native 模式架构](../Images/8fc89b6f4e9cae26196a732733976e36.png)

# python - 如何在python中获取完整的类型名称？

> ID：15165101
> 
> 赞同：6
> 
> 时间：2013-03-01T19:11:27.257
> 
> 标签：python

Python 中的打印结果`type()`有时会显示不在当前范围内的类型名称。例如，以下代码将显示`"<type 'frame'>"`

```
import inspect
a = inspect.currentframe()
print( type( a ) ) 
```

但是当前范围内没有`frame`类型！如果我尝试在交互式解释器中使用它，我会收到错误消息：

```
>>> frame
NameError: name 'frame' is not defined 
```

那么有没有办法获得像“inspect.something.frame”这样的“完全限定”类型名称，以便我可以在我的代码中引用它？

**更新**

不幸的是，`__module__`也不起作用：

```
>>> type( a ).__module__
'__builtin__' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:17:27.687

```
"What's in a name? That which we call a frame 
 By any other name would smell as sweet." 
```

* * *

如果您正在寻找与框架类型相对应的 Python 对象，您可以使用：

```
In [38]: import types

In [39]: types.FrameType
Out[39]: <type 'frame'> 
```

* * *

当然，这只是另一种写法`type(a)`：

```
In [42]: import inspect

In [43]: a = inspect.currentframe()

In [44]: types.FrameType == type(a)
Out[44]: True 
```

* * *

如果您查看`types`模块内部，您会发现它`types.FrameType`是这样定义的：

```
try:
    raise TypeError
except TypeError:
    tb = sys.exc_info()[2]
    TracebackType = type(tb)
    FrameType = type(tb.tb_frame)
    del tb 
```

他们所做的只是找到一个实例`frame`并定义`FrameType`为`type`这个实例的实例。

这本质上就是您定义时正在做的事情

```
MyFrameType = type(a) 
```

所以结论是：要掌握实例的类型，只需调用`type(obj)`. 你不需要事先知道*其他*任何事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:18:29.917

没有简单的方法可以做到这一点。通常，您可以使用：

```
x.__module__ + '.' + x.__name__ 
```

但是，如果无法从其模块中访问该对象，这将不起作用；例如，如果模块用于`del`从其命名空间中删除对象，就会发生这种情况。

对于类方法，[PEP 3155](http://www.python.org/dev/peps/pep-3155/)引入了`__qualname__`属性；但这在这种情况下也无济于事。 `type(a).__module__`是`'__builtin__'`，但`frame`不是`__builtin__`模块中的名称。这在 C 中实现的类型中很常见。

在这种情况下，您必须知道该`frame`类型在`types`模块中：

```
from types import FrameType as frame 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:42:43.047

unutbu 的回答已经包含了这里的所有具体细节，但让我们退后一步。

通常，您要尝试做的事情是不可能的。不仅适用于框架，还适用于*任何东西*。

`print(x)`隐式打印出`str(x)`. 如果你幸运的话，这和 是一样的`repr(x)`，但它通常给你一些人类可读的东西，而不是计算机可用的东西。

当然，您可以通过使用`repr(x)`而不是`str(x)`. 但这*仍然*没有帮助。

这是一个很好的经验法则，`repr(a)`它可以给你一些用尖括号括起来的无用的东西，或者可以`eval`返回一个值的东西`== a`。但即使这样也不能依赖；这只是一个经验法则。

而在这种情况下，一旦你得到了`<type 'frame'>`，那显然是第一种`repr`，它是没用的。

但有一个好消息：你需要做的就是保持不变`x`，而不是保持不变并在以后`repr(x)`尝试重建`x`。

或者，在这种情况下，保持不变`type(a)`，你就有了框架类型。

# asp.net - jquery live click 与 onclick 服务器端

> ID：15165102
> 
> 赞同：1
> 
> 时间：2013-03-01T19:11:36.957
> 
> 标签：asp.net, jquery-ui, gridview, jquery

我正在使用 jquery 开发 ASP.Net Web 应用程序，我是 jquery 的新手，我有一个带有展开按钮的网格视图“grdVwFirst”，在单击展开对话框后显示另一个网格视图“grdVwDetails”，这个展开按钮有一个实时点击如下

```
 $("#MainContent_grdVwFirst input[id*='btnDetails'] ").live('click', function (e) {
        $("#dialog").dialog("open");
        $("#MainContent_grdVwDetails").GridviewFix().dataTable({
            "bFilter": false, "bJQueryUI": true
        });

        e.preventDefault();
    }); 
```

并且展开按钮存在于模板项中，如下所示

```
<ItemTemplate>
 <asp:ImageButton ID="btnDetails" runat="server" ImageUrl="~/Styles/images/plus-5-16.png" />
 </ItemTemplate> 
```

这一切都很好， **问题**是我不知道在哪里将我的数据绑定到服务器端的新网格视图“grdVwDetails”，因为 onClick 功能不适用于实时点击，因为我不能使用onclick 因为它在 jquery live click 中使用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:16:34.457

Query.live 已从 1.7 版中弃用并从 1.9 版中删除

您必须使用 .on

[http://api.jquery.com/on/](http://api.jquery.com/on/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T12:47:02.920

如[jQuery.live](http://api.jquery.com/live/)文档中所述，此实用程序在 1.7 版中已被弃用，并在 1.9 版中被删除，取而代之的是 j [jQuery.on](http://api.jquery.com/on/)。

[如果您正在使用使用jQuery.live](http://api.jquery.com/live/)或无法更改为使用[jQuery.on](http://api.jquery.com/on/)的第三方库，则jQuery 发布了一个[迁移插件。](https://github.com/jquery/jquery-migrate/#readme)

迁移插件包含向后兼容所需的所有代码。[将迁移插件 js 文件](http://code.jquery.com/jquery-migrate-1.1.1.js)包含到您的项目中，并且 jQuery.live 应该可以正常工作。

# javascript - 如何根据内容删除表格列？

> ID：15165109
> 
> 赞同：0
> 
> 时间：2013-03-01T19:11:51.183
> 
> 标签：javascript, jquery

我有一张这样的桌子：

```
<table>
    <tbody>
        <tr>
            <td width="50">
                <img title="Image1" 
                     src="images/image1.png" onclick="dosomething()">
            </td>
            <td width="50">
                <img title="Image2" src="images/image2.png" 
                     onclick="dosomethingelse()">
            </td>
        </tr>
    </tbody>
</table> 
```

我想删除`<td>`包含 Image1 的。我知道在 jQuery 中我可以删除图像本身

```
$( "img[title='Image1']" ).remove(); 
```

但我想核对包含`<td>`及其宽度以及折叠表格，就好像该图像及其列从未存在一样......

有没有办法从 备份到包含元素`$("img[title='Image1']")`？还是我需要遍历整个表（可能很大）并搜索它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:14:59.853

我会去

```
$("img[title='Image1']").closest('td').remove(); 
```

或像其他人提到的那样：

```
$("img[title='Image1']").parent().remove(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:14:24.880

你可以做`$("img[title='Image1']").parent().remove();`。这将删除包含图像的单元格（假设图像始终是单元格的直接后代）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:14:30.760

[`.parent()`](http://api.jquery.com/parent/)应该这样做。

```
$("img[title='Image1']").parent().remove(); 
```

虽然我个人会在图像上打一个 ID 并使用：

```
var toremove = document.getElementById('imageid').parentNode;
toremove.parentNode.removeChild(toremove); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T19:14:30.770

使用[`.parent()`](http://api.jquery.com/parent/)：

```
$( "img[title='Image1']" ).parent().remove(); 
```

从文档：

> **.parent( [selector ] )**
> 获取当前匹配元素集中每个元素的父元素，可选地由选择器过滤。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-01T19:14:59.573

```
$( "img[title='Image1']" ).parent().remove(); 
```

这应该做你想要的..

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-01T19:17:20.167

这将根据单击的图像删除列。

```
$('table img').click(function() {
  $(this).closest('td').remove();
}); 
```

# javascript - 验证数组中的文件扩展名

> ID：15165111
> 
> 赞同：2
> 
> 时间：2013-03-01T19:12:12.617
> 
> 标签：javascript

我已经在网上搜索了很多不同的方法来自己解决这个问题，但没有成功。

如果文件扩展名被接受，我想以与“outpush.push”语句相同的方式显示一条消息。

这需要从已接受的文件扩展名（如 JPG、PNG、GIF）的数组中获取，并检测文件扩展名是否为大写并接受（将其转换为小写）。

这是我的脚本。我想知道如何以及在脚本中的何处实现这样的功能？

```
function handleFileSelect(evt) {

    var files = evt.target.files; // FileList object
    var max_size = 5120; // Max file size

    var output = [];
    for (var i = 0, f; f = files[i]; i++) {

        output.push('<li><strong><font size="3" color="FFFFFF">FILE: ', escape(f.name), '</strong> (', f.type || 'n/a', ') - ',
            f.size, ' bytes, last modified: ',
            f.lastModifiedDate ? f.lastModifiedDate.toLocaleDateString() : 'n/a',
            '</font></li>');

        if(f.size > max_size) {

            output.push('<font size="5" color="FFFF00"><b>ERROR!! Sorry, but the file that you selected is too large. Please upload a file that is no larger than ' + max_size + ' KB.');
        }

        if(f.size < max_size) {
            output.push('<font size="5" color="FFFF00"><b>FILE SIZE OK. CLICK TO SEND button below.</font>');

            output.push('<font size="5" color="FFFFFF"><hr><b>IMPORTANT: Do not close this window. Wait till you see the next page when finished uploading your file.</font>');

            document.getElementById("myButton").style.display="all";
        }

    }

    document.getElementById('list').innerHTML = '<ul>' + output.join('') + '</ul>';
}

document.getElementById('files').addEventListener('change', handleFileSelect, false); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T22:00:13.077

您的代码有几个问题。

1）您应该使用`if-else`, 而不是多个`if`语句：

```
if (f.size > max_size) {
    // ...
} else {
    // ...
} 
```

2)不是、或`all`的有效值：`display``block``inline`

```
document.getElementById("myButton").style.display = "block"; 
```

3）您正在使用过时的`<font>`标签。相反，使用样式和 CSS。在您的情况下，我会使用类，一个用于 a `msg`，以及用于`error`、`important`和`ok`.

4) 要进行数组检查，只需使用`indexOf()`：

```
var extensions = ["jpg", "jpeg", "txt", "png"];  // Globally defined

...

// Get extension and make it lowercase
// This uses a regex replace to remove everything up to 
// and including the last dot
var extension = f.name.replace(/.*\./, '').toLowerCase();

if (extensions.indexOf(extension) < 0) {  // Wasn't found
    output.push('<li class="msg error">ERROR!! Sorry, but the file that you selected is not a valid file type.  Valid types are: ', valid, '</li>');
} else ... 
```

演示：http: [//jsfiddle.net/jtbowden/L2Gps/](http://jsfiddle.net/jtbowden/L2Gps/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T19:23:15.997

你可以有这样的数组：

```
var file_types = {'jpg', 'png', 'gif'}; 
```

然后在你的for循环中做这样的事情

```
if ($.inArray(f.ext, file_types) == -1) {
output.push('<font size="5" color="FFFF00"><b>ERROR!! Incorrect file type! Accepted file types are : jpg, png, gif</b></font>');
} 
```

更多关于[inArray()](http://api.jquery.com/jQuery.inArray/)的阅读。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:28:42.633

您可以尝试以下两种方法之一 - 尝试抓取扩展名并将其与允许的扩展名数组或正则表达式匹配。

```
var accepted_types = ['jpg', 'gif', 'png'];
if (accepted_types.indexOf(f.ext) > 0) {
  output.push(...);
} 
```

至于 jQuery - 您可以考虑以下内容来构建您的 HTML

```
var file_list = $("<ul></ul>");
for (var i = 0, f; f = files[i]; i++) {
  // work goes here, simply append the list elements into file_list
  file_list.append($("<li>" ... "</li>"));
}

// to append your new list to id="list"
$("#list").append(file_list);
// or to replace the html with your new html
$("#list").html(file_list.html()); 
```

# android - 无法将 adb 与自定义 Android 设备一起使用

> ID：15165113
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:12:16.643
> 
> 标签：android, installation, driver, adb

我正在尝试在客户构建的 Android 设备上调试应用程序，但无法将其连接到 ADB。我将适当的 %SingleAdbInterface% 和 %CompositeAdbInterface% 行与硬件 ID 放在我的 android-sdk/google-usb_driver/android_winusb.inf 中（在 [Google.NTx86] 和 [Google.NTamd64] 下），并将 VID 放在用户名中/.android/adb_usb.ini。在我的设备管理器中，它说驱动程序已安装（它们位于 Android Phone->Android ADB Interface 下）。但是，如果我从 cygwin 运行“adb devices”，则不会注册任何设备。我试过杀死并重新启动ADB，重新启动我的计算机，并将驱动程序软件更新为Android Composite ADB Interface，但无济于事。PDANet 也无法解决这个问题。任何帮助或朝正确方向轻推将不胜感激！

谢谢！

android_winusb.inf：

```
[Google.NTx86]
;Custom
%SingleAdbInterface%        = USB_Install, USB\VID_1234&PID_5678&REV_9101&MI_00
%CompositeAdbInterface%     = USB_Install, USB\VID_1234&PID_5678&MI_00
...[other drivers]
[Google.NTamd64]
;Custom
%SingleAdbInterface%        = USB_Install, USB\VID_1234&PID_5678&REV_9101&MI_00
%CompositeAdbInterface%     = USB_Install, USB\VID_1234&PID_5678&MI_00 
```

adb_usb.ini：

```
0x1234 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:11:01.260

您需要`adbd`正确配置和运行守护程序。您可以检查它是否从设备上的终端仿真器运行。

构建“客户构建的 Android”软件的个人/公司应该能够提供更详细的信息。

# vba - 提供者 OraOLEDB.Oracle 没有为 vba 返回正确的结果

> ID：15165123
> 
> 赞同：0
> 
> 时间：2013-03-01T19:13:02.570
> 
> 标签：vba, vb6, oracle11g, provider

我有这个 .xls vba 代码，我试图在其中检查记录计数并基于该代码决定进一步的逻辑。

这个 vba 在 Provider = MSDAORA 上运行良好，但是当我更改为 Provider = OraOLEDB.Oracle 这个 vba 检查查询总是返回记录计数 = 0

使用 OraOLEDB.Oracle 的所有其他查询都可以正常工作。

此处附上代码。

提前感谢您在这里指出问题。

```
Public Function CheckJob(BusDate As String, JobName As String) As Boolean
Dim Cnt As ADODB.Connection, rst As ADODB.Recordset
Dim cmdGetComp As New ADODB.Command   
Dim RecCount As Integer
Dim rng As Range
Dim StConn As String
Dim Sql As String

StConn = strETDDBConnStringADO()'This is connection string with all credentials
Set Cnt = New ADODB.Connection
Set rst = New ADODB.Recordset
Set cmdGetComp = New ADODB.Command

Sql = "Select Count(*) from XYZ_DBO.TABLE_STATUS where BUSINESS_DATE='XXXXXX'"

With Cnt
.Open (StConn)

With cmdGetComp
    .ActiveConnection = Cnt ' Reference to a Connection object.
    .CommandType = adCmdText
    .CommandText = Sql
     Set rst = .Execute() ' Set the Recordset to the results of executing the query
End With

RecCount = rst(0)  'rst(0) always return value of 0 even if manual query have 1 record
.Close
End With
If RecCount > 0 Then   
CheckJob = True
Else
CheckJob = False
End If
End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-15T15:38:28.993

MSDAORA 似乎对某些转换更直观，而 OraOLEDB.Oracle 更明确。

因此，虽然 MSDAORA 将 '01-JAN-2015' 理解为与日期列比较时的有效日期，但 OraOLEDB.Oracle 要求将字符串转换为日期，例如 to_date('01-JAN-2015', 'DD -MON-YYYY'）。

TLDR：

```
Sql = "Select Count(*) from XYZ_DBO.TABLE_STATUS where BUSINESS_DATE='XXXXXXXX'" 
```

应该变成类似的东西（取决于 BUSINESS_DATE 数据类型）

```
Sql = "Select Count(*) from XYZ_DBO.TABLE_STATUS where BUSINESS_DATE= to_date('XXXXXXXX','MMDDYYYY')" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-06-19T14:34:10.300

在连接字符串中使用 UseSessionFormat=True，因此它始终使用 Oracle 默认日期格式。

connectionString = "PROVIDER=OraOLEDB.Oracle;Persist Security Info=True;UseSessionFormat=True;USER ID=XXXX;PASSWORD=XXXX;Data Source=(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=XXX) (PORT=XXXX)))(CONNECT_DATA=(SID=XXXX)(SERVER=DEDICATED)))""

# java - 可以将爆炸战争添加/加载到独立的 Java 应用程序吗？

> ID：15165124
> 
> 赞同：1
> 
> 时间：2013-03-01T19:13:05.607
> 
> 标签：java, classpath, war

首先是主要问题：

我们在 tomcat 中有一个 Web 应用程序，当系统试图在 12 点发送电子邮件时，它会过载并关闭。起初它只有数百个（服务器表现良好），但现在它有数千个并且用完了所有东西。

我们想在不同的 JVM 中“运行”这些作业。为此，我被要求**创建一个独立的应用程序来加载 Spring 和休眠上下文并调用发送电子邮件和短信的方法；并通过命令行运行它**。但是他们想使用与tomcat服务器相同的“战争”（避免任何类型的复制）。

![在此处输入图像描述](../Images/7bc46eb6e7d1e97c3c89230e199b534f.png)

我已经通过 Eclipse 创建了应用程序，当我点击运行时，它会发挥它的魔力。但是当我尝试通过命令行运行它时，我得到一个 NoClassDefFoundError，显然，这要归功于 ClassPath 参考问题。我试图将路径放入“WEB-INF”目录而没有成功。如果这意味着运行这个应用程序，我们不在乎扼杀可移植性。

```
C:\Program Files\Java\jdk1.6.0_38\bin>java -jar -cp ".;D:\powerfollowups\trunk\WebContent\WEB-INF\lib\*;D:\powerfollowups\trunk\WebContent\WEB-INF\clases" D:\powerfollowups\workspace\PFUReportSender\target\pwrFU-2.jar 
```

我还尝试将它放在清单的 Class-Path 中，如下所示：

```
Manifest-Version: 1.0
Main-Class: com.powerfollowups.StandAlonePFUReportSender
Class-Path: D:\powerfollowups\trunk\WebContent\WEB-INF\lib\* D:\powerfollowups\trunk\WebContent\WEB-INF\clases 
```

**如何将所有这些添加到类路径中？**

优化代码现在不是一个选项。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:24:22.390

你需要在类路径上做一些事情：

*   WEB-INF/classes - 这包含你所有来自 WAR 的自定义类
*   WAR 中的类所依赖的所有库 jar
*   您的命令行应用程序所依赖的所有 jar

编辑：根据您更新的问题

```
java -jar -cp ".;D:\powerfollowups\trunk\WebContent\WEB-INF\lib\*;D:\powerfollowups\trunk\WebContent\WEB-INF\classes"  D:\powerfollowups\workspace\PFUReportSender\target\pwrFU-2.jar 
```

# ios - GDataXML stringValue 与 XMLString

> ID：15165130
> 
> 赞同：-3
> 
> 时间：2013-03-01T19:13:30.823
> 
> 标签：ios, objective-c, gdataxml

见标题。GDataElement 实例方法的返回值有什么区别：

```
-(NSString *) XMLString; 
```

和

```
-(NSString *) stringValue; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:28:04.847

XMLString 返回节点的原始字符串表示，stringValue 返回标签内的值，如

```
<tag>this is string value</tag>. 
```

# apache-flex - flex textinput 最后限制百分比符号

> ID：15165132
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:13:30.450
> 
> 标签：apache-flex, percentage, textinput, restrict

我想在文本输入中限制我的用户，以便他们最后可以编辑带有百分比符号的数字。现在他们只能输入小数。我如何让他们限制有百分比符号？我正在做这个限制='0-9\.\-'。我感谢您的帮助。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T03:14:05.597

您可以将 % 符号添加到限制值。

```
restrict='0-9\.\-\%' 
```

不知道你是否需要用斜杠转义它。如果您想将百分比限制在文本中的最后一个位置，您将需要监听 change 或 valueCommit 事件，以按照您需要的方式验证和格式化数据。

# php - 保存到两个标签的var内容

> ID：15165133
> 
> 赞同：0
> 
> 时间：2013-03-01T19:13:33.050
> 
> 标签：php, html, xml, variables, tags

在 php 中，您可以提取两个标签 html、xml 或类似标签之间的内容。

例如，如果我有。

```
<div><h1>Title </h1><table><tr><td> Data 1 </td><td> Data 2 </td></tr></table></div> 
```

我可以保存在变量中并用 echo 显示

```
 <h1> Title <h1><table><tr><td> Data 1 </td><td> Data 2 </td></tr></table> 
```

我做了这个例子，它给了我错误。

> $ html = "你好`<p><b>how are you</b></p>`";

```
$ dom = new DOMDocument ('1 .0 ',' utf-8 ');
$ dom-> loadHTML ($ html);
$ dom-> preserveWhiteSpace = false;
$ htwo = $ dom-> getElementsByTagName('div');
echo $ htwo-> item (0) -> nodeValue; 
```

我显示

```
<p> <b> Hello how are you </ b> </ p> 
```

但

```
Hello how are you 
```

我该怎么做？如果是 xml 标签？

非常感谢您

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:18:16.120

`nodeValue`只是节点的文本内容。要获取 HTML 内容，请使用：

```
$dom->saveHTML($htwo->item(0)); 
```

[文档](http://www.php.net/manual/en/domdocument.savehtml.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:19:09.477

原因是它是一个“尽力而为”的解析器，而您的“HTML”只不过是一个片段。它需要一个完整的 HTML 文档。

提供更完整的 HTML 片段，即：

```
<html>
 <head></head>
 <body>Your Text Here</body>
</html> 
```

它会做得更好。

# eclipse - 将 Eclipse Workspace 从 ~ 移动到新目录？

> ID：15165135
> 
> 赞同：40
> 
> 时间：2013-03-01T19:13:51.340
> 
> 标签：eclipse

好的，所以我错误地将我的主目录（~，又名 /home/user）设置为我在 RHEL6 机器上的工作区位置。

我想将我的工作区更改为 ~/workspace。但是，我似乎无法通过复制文件来做到这一点。对于某些背景，我目前正在处理的项目并已在 ~ 工作区下完全设置，所有源文件都存储在其他地方（~/depot/.../../../../src），所以我甚至没有在 ~ 中看到代表我的项目的文件夹。

* * *

## 回答 #1

> 赞同：64
> 
> 时间：2013-03-01T19:39:04.063

执行以下步骤：

*   关闭工作区中的所有项目
*   关闭日食
*   将目录`.metadata`从移动`~`到`~/workspace`
*   打开 Eclipse 并在提示选择工作区时将其设置为`~/workspace`

* * *

## 回答 #2

> 赞同：17
> 
> 时间：2014-09-15T13:19:54.287

在 Windows 8 上，我这样做了：

1.  关闭 Eclipse 中的所有项目
2.  封闭日食
3.  将工作区文件夹物理移动到一个新位置（在我的情况下，我把它放到 c:\projects 中，因为我已经备份了它）。
4.  启动 Eclipse
5.  文件 > 切换工作区并选择新路径。然后eclipse重新启动，所有项目都出现了。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-08-05T15:34:11.480

关闭 Eclipse 项目和 Eclipse 本身后，将所有项目文件夹和`.metadata`文件夹移动到新的工作区文件夹中。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-08-22T10:43:21.653

1.  关闭 Eclipse。
2.  打开工作区的位置并将整个目录（其中包含“.metadata”目录）剪切粘贴到预期位置。
3.  使用新复制的文件夹作为工作区（“.metadata”文件夹的父目录）重新启动 Eclipse。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-12-16T18:21:02.540

我正在测试从工作区手动移动文件，突然我的 Eclipse 没有在我的 Eclipse 视图中显示它们，所以我将它们移回它们来自的相同位置，进入 Eclipse 并单击右键单击我期待的包文件并单击刷新，现在我可以在包下的 Eclipse 上查看它们，所以尝试刷新它可能对你有用。

# c# - MySQL连接字符串不起作用

> ID：15165136
> 
> 赞同：2
> 
> 时间：2013-03-01T19:13:53.583
> 
> 标签：c#, mysql

我有以下连接字符串：

`Data Source=localhost;UserID=root;Password=;Database=eyebus;`

当我尝试连接到数据库时，我收到一条错误消息，提示可能找不到服务器或无法访问服务器。这个字符串有什么问题，？

我还尝试了在 Internet 上找到的其他字符串/单词，但它们都没有真正起作用。

此外，问题不在于服务器，因为它可以被其他应用程序访问。

```
class SQLManager
    {

        private static string conString = ConfigurationManager.ConnectionStrings["DatabaseConnectionString"].ToString();

        public List<PesquisaOcorrenciasExistentesModel> getOcorrencias()
        {
            List<PesquisaOcorrenciasExistentesModel> ocorrencias = new List<PesquisaOcorrenciasExistentesModel>();

            using (SqlConnection con = new SqlConnection(conString))
            {
                try
                {
                    con.Open();
                }
                catch (Exception e)
                {
                    Debug.WriteLine(e.Message);
                }
                using (SqlCommand com = new SqlCommand("SELECT * FROM ocorrencias", con))
                {
                    SqlDataReader reader = com.ExecuteReader();
                    while (reader.Read())
                    {
                        PesquisaOcorrenciasExistentesModel o = new PesquisaOcorrenciasExistentesModel();
                        o.IdOcorrencia = reader.GetInt16(0);
                        o.IdOcorrenciaTipo = reader.GetInt16(1);
                        o.DataInicio = reader.GetDateTime(2);
                        o.DataFim = reader.GetDateTime(3);
                        o.Operador = reader.GetString(4);
                        o.Motorista = reader.GetString(5);
                        o.Cobrador = reader.GetString(6);
                        o.Terceiros = reader.GetString(7);
                        o.Descricao = reader.GetString(8);
                        o.EmailsEnviados = reader.GetString(9);
                        o.TipoOcorrenciaOutro = reader.GetString(10);
                        ocorrencias.Add(o);
                    }
                }
            }

            return ocorrencias;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:18:29.337

尝试使用`Server`而不是数据源，而`UID`不是用户 ID。

或者查看这篇文章，了解更多信息：[如何形成正确的 MySQL 连接字符串？](https://stackoverflow.com/questions/10505952/mysql-connection-string-is-not-working-in-c-sharp)

另外，您不需要使用：

```
ConfigurationManager.ConnectionStrings["DatabaseConnectionString"].ConnectionString 
```

和`SqlConnection`、、、`SqlDataReader`和`SqlCommand`用于 Micrsoft SQL。我相信您应该使用`MySqlConnection`,`MySqlDataReader`和`MySqlCommand`.

看看： http: [//www.codeproject.com/Articles/43438/Connect-C-to-MySQL](http://www.codeproject.com/Articles/43438/Connect-C-to-MySQL)

# php - PHP的未定义索引

> ID：15165137
> 
> 赞同：-2
> 
> 时间：2013-03-01T19:14:05.333
> 
> 标签：php, javascript, ajax, calendar

大家好，我正在使用 AJAX 和 PHP 执行日历功能

```
$showmonth = $_POST['showmonth'];
$showyear = $_POST['showyear'];
$pre_days = date ('w', mktime(0,0,0, $showmonth, 1, $showyear));
$post_days = (6 - (date('w', mktime(0, 0, 0, $showmonth, $day_count, $showyear)))); 
```

我不断收到错误消息说：

> 注意：未定义索引：第 2 行 C:\xampp\htdocs\calendar_start.php 中的 showmonth
> 
> 注意：未定义索引：第 3 行 C:\xampp\htdocs\calendar_start.php 中的 showyear
> 
> 警告：cal_days_in_month() 预计参数 2 很长，字符串在第 8 行的 C:\xampp\htdocs\calendar_start.php 中给出
> 
> 警告：mktime() 期望参数 4 很长，字符串在第 9 行的 C:\xampp\htdocs\calendar_start.php 中给出
> 
> 警告：mktime() 期望参数 4 很长，字符串在第 10 行的 C:\xampp\htdocs\calendar_start.php 中给出

我认为这与我的 AJAX java 脚本有关，但我只是不知道 AJAX 代码还有哪些部分，但我认为这是困扰我的部分

```
function next_month() {
    var nextmonth = showmonth + 1;
    if(nextmonth >12) {
        nextmonth = 1;
        showyear = showyear + 1;
        }
showmonth = nextmonth;
var hr = new XMLHttpRequest();
var url = "calendar_start.php";
var vars = "showmonth="+showmonth+"&showyear="+showyear;
hr.open("POST",url,true);
hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
hr.onreadystatechange = function() {
    if(hr.readyState == 4 && hr.status == 200) {
        var return_data = hr.responseText;
        document.getElementById("showCalendar").innerHML = return_data;
        }
}
    hr.send(vars);
    document.getElementById("showCalendar").innerHTML = "processing...";
}
</script> 
```

这也可能是问题：

```
function initialCalendar() {
var hr = new XMLHttpRequest();
var url = "calendar_start.php";
var currentTime = new Date();
var month = currentTime.getMonth() + 1;
var year = currentTime.getFullYear();
showmonth = month;
showyear = year;
var vars = "showmonth="+showmonth+"&showyear="+showyear;
hr.open("POST", url, true);
hr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
hr.onreadystatechange = function() {
    if(hr.readyState == 4 && hr.status == 200) {
        var return_data = hr.responseText;
        document.getElementById("showCalendar").innerHML = return_data;
        }
}
    hr.send(vars);
    document.getElementById("showCalendar").innerHTML = "processing...";
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T15:14:48.357

在我度过了 5 个小时之后，我发现了这个： [http ://www.openjs.com/articles/ajax_xmlhttp_using_post.php](http://www.openjs.com/articles/ajax_xmlhttp_using_post.php)

在这里您可以发现您只需要 2 行代码：

```
hr.setRequestHeader("Content-length", vars.length);
hr.setRequestHeader("Connection", "close"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:07:18.483

如果你在你的javascript中改变这个？？？

```
var url = "calendar_start.php";
var vars = "showmonth="+showmonth+"&showyear="+showyear;
var final_url = url+"?"+vars;
alert(final_url); //this line should a message with the url, post it please.
hr.open("GET",final,true); 
```

那应该行得通。

PS：您使用 get params 传递您的 url，因此在您的 php 文件中您应该像这样收到它们

```
$showmonth = $_GET['showmonth']; //I change POST by GET
$showyear = $_GET['showyear']; //DONT forget to chenge this in your php file 
```

萨卢多斯 ;)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T20:14:28.460

您是否使用相同的方法（POST/GET）发送和接收参数...？如果不是这样..它可能会给出未定义的索引错误...即，如果您使用 GET 发送参数并使用 POST 接收参数，反之亦然..

# java - 检查字符串或整数

> ID：15165139
> 
> 赞同：0
> 
> 时间：2013-03-01T19:14:17.197
> 
> 标签：java, input

我正在读取具有以下格式的字符串：ID First Name(contain Middle Name) Last NamebirthYear

例如

722 大卫贝克汉姆 1975

现在我只是使用这个代码：

```
ID = scannerStr.nextInt();

FirstName = scannerStr.next();

LastName = scannerStr.next();

BirthYr = scannerStr.nextInt(); 
```

但是你会看到当有中间名的人出现时，这会失败......例如

100 大卫·罗伯特·约瑟夫·贝克汉姆 1958

如何解决这个问题？如何检查我阅读的内容是 word 还是 int？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:21:41.857

您对输入的建模不正确。

您当前的模型（如您的代码中所示）是这样的：

```
int string string int 
```

您输入的真实模型似乎是这样的：

```
int string (string)* string int 
```

您可以使用正确解析它`String.split()`

```
String[] tokens = inputString.split(" ");

actorId = Integer.valueOf(tokens[0]);
actorFirstName = tokens[1];
actorLastName = tokens[tokens.length - 2];
actorBirthYear = Integer.valueOf(tokens[tokens.length - 1]); 
```

查看[Apache Commons Lang](http://commons.apache.org/proper/commons-lang/) StringUtils 类以进行空安全字符串操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:28:17.650

IMO最好的解决方案是将所有内容拆分并将每个单词保存在一个字符串数组中，最后一个单词将是一个数字，第一个将是一个id，您可以知道最后一个单词之前的单词是姓氏，其余的是只是名字！代码未经测试，此代码可以拆分文本上的第一个单词，将其应用于整个字符串，您就完成了！

```
boolean flag = true;
String someWord ="";
int j = 0;
int i = 0;
String[] wordCollector;
while (flag) {
 if (word.substring(i,i+1).equals(" ")) {
  someWord = someWord + word.substring(i,i+1);
  i++;
 }
 else {
 wordCollector[j] = 
 j++;
 flag = false;
 someWord="";
 }
} 
```

# c# - 在 global.asax 中捕获特定错误

> ID：15165140
> 
> 赞同：2
> 
> 时间：2013-03-01T19:14:22.197
> 
> 标签：c#, asp.net, exception-handling, global-asax

我在全局 asax 中使用 Application_Error 事件来捕获错误并将它们写入文件。我可以在网页中看到特定的异常，但在日志文件中我看到的只是一个像这样的一般错误：

```
Exception of type 'System.Web.HttpUnhandledException' was thrown.
   at System.Web.UI.Page.HandleError(Exception e)
   at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
   at System.Web.UI.Page.ProcessRequest()
   at System.Web.UI.Page.ProcessRequestWithNoAssert(HttpContext context)
   at System.Web.UI.Page.ProcessRequest(HttpContext context)
   at ASP.review_aspx.ProcessRequest(HttpContext context) in c:\Windows\Microsoft.NET\Framework\v2.0.50727\Temporary ASP.NET Files\...\ff7eee7c\ff24ade1\App_Web_tddyd4bt.3.cs:line 0
   at System.Web.HttpApplication.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
   at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

我如何将黄页中看到的错误写入日志文件而不是这个一般错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:21:15.370

*这是你要找的吗？*

```
 Exception ex = Server.GetLastError();    
 String ExceptionMessage = (ex.InnerException != null) ? ex.InnerException.Message : ex.Message; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-15T13:08:26.200

在 Global.asax 中，找到 Application_Error 方法并添加以下内容：

```
 protected void Application_Error(object sender, EventArgs e)
    {
       Exception ex = Server.GetLastError();
        LogHelper.WriteLog(ex);
    } 
```

您需要创建一个类来编写日志..

```
public class LogHelper
{
    public static void WriteLog(Exception exception)
    {
       //write to text file the exception.Message ...
    }
} 
```

# asp.net-mvc - 如何在 Typed DataSet (XSD) 视图中显示数据？

> ID：15165148
> 
> 赞同：1
> 
> 时间：2013-03-01T19:14:34.783
> 
> 标签：asp.net-mvc, xsd, dataset, strong-typing

我正在尝试使用类型化的 DataSet，并且我有一个使用名为“Main.mdb”的 NorthWind 数据库的简单应用程序，并且我有一个模型“MainDataSet1.xsd”，我试图用它来列出名为“Main”的 Access 表中的所有项目.

如何编码 HomeController 的 Index 操作以返回列出所有 Main 表内容的强类型视图。

```
My Home Controller:

    public class HomeController : Controller
    {
        //
        // GET: /Home/

        public ActionResult Index()
        {
            MainDataSet1 ds = new MainDataSet1();
            MAINTableAdapter ta = new MAINTableAdapter();

            ta.Fill(ds.MAIN);

            return View();
        } 
```

这是我转到“添加>查看”时的选项：

```
View name: Index
Create a partial view: [unchecked]
Create a strongly-typed view: [checked]; possible options =

AdoExperiment.Models.MainDataset1;
AdoExperiment.Models.MainDataSet1+MAINDataTable;
AdoExperiment.Models.MainDataSet1+MAINRow;
AdoExperiment.Models.MainDataSet1+MAINRowChangeEvent;
AdoExperiment.Models.MainDataSet1+MAINRowChangeEventHandler;
AdoExperiment.Models.MainDataSet1TableAdapters.MAINTableAdapter; AdoExperiment.Models.MainDataSet1TableAdapters.TableAdapterManager;
AdoExperiment.Models.MainDataSet1TableAdapters.TableAdapterManager+SelfReferenceComparer

Select master page: [unselected] 
```

谢谢！

# php - str_replace 的意外行为与数组

> ID：15165152
> 
> 赞同：0
> 
> 时间：2013-03-01T19:14:52.983
> 
> 标签：php, arrays, str-replace

我有以下功能，使用`str_replace`会产生意想不到的结果

```
function repo($text) {
    $search = array("0","1","2","3","4","5","6","7","8","9");
    $replace = array("z30","z31","z32","z33","z34","z35","z36","z37","z38","z99");
    $text = str_replace($search,$replace,$text);
    return $text;
}

echo repo('0'); 
```

预期的答案是

```
z30 
```

相反，我得到

```
zz330 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T19:19:27.317

您的功能以这种方式工作。

0 更改为 z30，php 继续循环数组，然后 z30 包含 '3'，3 更改为 z33。因此返回'z' + 'z33' + '0' = zz330。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:33:08.733

就像[文档](http://www.php.net/manual/en/function.str-replace.php)说的那样：

> 因为 str_replace() 从左到右替换，所以在进行多次替换时，它可能会替换先前插入的值。

你可能想做这样的事情：

```
function repo($text){
    $search = array("0","1","2","3","4","5","6","7","8","9");
    $replace = array("z30","z31","z32","z33","z34","z35","z36","z37","z38","z99");
    $replacePairs = array_combine($search, $replace);
    return strtr($text, $replacePairs);
} 
```

# xml - 使用 XSLT 从我的 XML 文件中删除重复元素

> ID：15165158
> 
> 赞同：4
> 
> 时间：2013-03-01T19:15:04.617
> 
> 标签：xml, xslt

这是一个示例，如果 ID 相同，我想删除重复的条目。我正在从系统'A'和系统'B'中提取命中。我希望系统“A”具有优先权（即，如果 ID 是重复的，则从系统“B”中删除元素）。这是我的例子：

我得到这个结果：

```
<HitList>
   <Hit System="A" ID="1"/>
   <Hit System="A" ID="2"/>
   <Hit System="A" ID="2"/>
   <Hit System="B" ID="1"/>
   <Hit System="B" ID="2"/>
   <Hit System="B" ID="3"/>
   <Hit System="B" ID="4"/>
</HitList>

I want this result (with the duplicates removed):

<HitList>
   <Hit System="A" ID="1"/>
   <Hit System="A" ID="2"/>
   <Hit System="B" ID="3"/>
   <Hit System="B" ID="4"/>
</HitList> 
```

当前代码：

```
 <xsl:template match="/RetrievePersonSearchDataRequest">
                    <HitList>
                                <xsl:if test="string(RetrievePersonSearchDataRequest/SystemA/NamecheckResponse/@Status) = string(Succeeded)">
                                            <xsl:for-each select="SystemA/NamecheckResponse/BATCH/ITEMLIST/ITEM/VISQST/NCHITLIST/NCHIT">
                                                        <Hit>
                                                                    <xsl:attribute name="System"><xsl:text>A</xsl:text></xsl:attribute>
                                                                    <xsl:attribute name="PersonID"><xsl:value-of select="number(
                                                        REFUSAL/@UID)"/></xsl:attribute>
                                                        </Hit>
                                            </xsl:for-each>
                                </xsl:if>
                                <xsl:if test="string(RetrievePersonSearchDataRequest/SystemB/NamecheckResponse/@Status) = string(Succeeded)">
                                            <xsl:for-each select="SystemB/NamecheckResponse/PersonIDSearchResponse/personID">
                                                        <Hit>
                                                                    <xsl:attribute name="System"><xsl:text>B</xsl:text></xsl:attribute>
                                                                    <xsl:attribute name="PersonID"><xsl:value-of select="number(.)"/></xsl:attribute>
                                                        </Hit>
                                            </xsl:for-each>
                                </xsl:if>
                    </HitList>
        </xsl:template> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:57:40.627

这可以通过身份模板的单一覆盖来完成......

**XML 输入**

```
<HitList>
    <Hit System="A" ID="1"/>
    <Hit System="A" ID="2"/>
    <Hit System="A" ID="2"/>
    <Hit System="B" ID="1"/>
    <Hit System="B" ID="2"/>
    <Hit System="B" ID="3"/>
    <Hit System="B" ID="4"/>
</HitList> 
```

**XSLT 1.0**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output indent="yes"/>
    <xsl:strip-space elements="*"/>

    <xsl:template match="@*|node()">
        <xsl:copy>
            <xsl:apply-templates select="@*|node()"/>
        </xsl:copy>
    </xsl:template>

    <xsl:template match="Hit[(@System='B' and @ID=../Hit[@System='A']/@ID) or 
        @ID = preceding-sibling::Hit[@System='A']/@ID]"/>

</xsl:stylesheet> 
```

**输出**

```
<HitList>
   <Hit System="A" ID="1"/>
   <Hit System="A" ID="2"/>
   <Hit System="B" ID="3"/>
   <Hit System="B" ID="4"/>
</HitList> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T20:15:27.060

XSLT 2.0 解决方案：

```
<xsl:template match="HitList">
<HitList>
  <xsl:for-each-group select="*" group-by="@ID">
    <xsl:copy-of select="current-group()[1]"/>
  </xsl:for-each-group>
</HitList>
</xsl:template> 
```

这假设 As 总是在 Bs 之前。如果不是这种情况，您可以将内部指令替换为

```
<xsl:copy-of select="(current-group()[@System='A'], current-group[@System='B'])[1]"/> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-02T03:18:19.087

**这是一个使用键的高效 XSLT 1.0 解决方案：**

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>
 <xsl:strip-space elements="*"/>

 <xsl:key name="kHitById" match="Hit" use="@ID"/>
 <xsl:key name="kHitAById" match="Hit[@System = 'A']" use="@ID"/>

 <xsl:template match=
  "Hit[generate-id() = generate-id(key('kHitById',@ID)[1])]">

  <xsl:copy-of select=
  "key('kHitAById', @ID)[1]|current()[not(key('kHitAById', @ID))]"/>
 </xsl:template>
</xsl:stylesheet> 
```

**当此转换应用于以下 XML 文档时**`B`（特意改编自提供的文档，通过在相应的 s 之前放置一些 s 使其更有趣`A`）：

```
<HitList>
   <Hit System="B" ID="1"/>
   <Hit System="A" ID="1"/>
   <Hit System="B" ID="2"/>
   <Hit System="A" ID="2"/>
   <Hit System="A" ID="2"/>
   <Hit System="B" ID="3"/>
   <Hit System="B" ID="4"/>
</HitList> 
```

**产生了想要的正确结果：**

```
<Hit System="A" ID="1"/>
<Hit System="A" ID="2"/>
<Hit System="B" ID="3"/>
<Hit System="B" ID="4"/> 
```

# tsql - 创建、存储和使用 TIME 值

> ID：15165163
> 
> 赞同：0
> 
> 时间：2013-03-01T19:15:14.080
> 
> 标签：tsql, sql-server-2008-r2, sql-update

我对 SQL 并不陌生，但最近创建了一个表，其中包含一个定义为`TIME`. 出于某种原因，我无法让该字段在 12 AM ( `23:59:99.999`) 以下取值。我的简化 TSQL 如下。

```
DECLARE @Time TIME = '23:59:99.99999'
UPDATE tblProjectSLA
SET colSLATime = @Time
WHERE SLAID IN ( 22, 24) 
```

我收到以下错误：

> 消息 241，级别 16，状态 1，第 1 行
> 从字符串转换日期和/或时间时转换失败。

我能够将时间值设置为尽可能低的时间“分辨率”，并成功更新了该字段。

```
DECLARE @Time DATETIME = '23:59' 
```

这是我查询时出现在 SQL mgr 中的结果：

```
colSLATime
23:59:00.0000000 
```

我还尝试将字符串值转换为 TIME... 同样的错误：

```
DECLARE @Time TIME = CAST('23:59:99.99999' AS TIME) 
```

我觉得奇怪的是，该表的精度为 16，比例为 7，难道我不能使用接近表中保存的值的东西吗？

下面是 colSLATime 列的定义方式...（使用 sp_help 命令并转置以便于阅读）

```
Column_name           colSLATime
Type                  time
Computed              no
Length                5
Prec                  16
Scale                 7
Nullable              yes
TrimTrailingBlanks    (n/a)
FixedLenNullInSource  (n/a)
Collation             NULL 
```

如果有人能指出我对使用 TIME 数据类型的来龙去脉的简单讨论。或者我应该废弃并在运行时只使用 VARCHAR 字段和 CAST （猜不是）。

[参考](http://msdn.microsoft.com/en-us/library/bb677243%28v=sql.105%29.aspx)

```
time (Transact-SQL)
SQL Server 2008 R2
Range      00:00:00.0000000 through 23:59:59.9999999 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:19:22.537

好吧，尝试使用：

```
23:59:59.99999
------^ this digit is pretty important! 
```

代替

```
23:59:99.99999
------^ 
```

一分钟内没有99秒！

# python - 如何在 numpy 中保持向量的行/列方向？

> ID：15165170
> 
> 赞同：14
> 
> 时间：2013-03-01T19:15:38.420
> 
> 标签：python, numpy

来自 Matlab/Octave 的背景，我一直在尝试学习 numpy。一直困扰我的一件事是向量和多维数组之间的区别。对于这个问题，我将给出一个我遇到的具体问题，但如果有人还可以解释 numpy 中一维数组背后的更一般的图片，我将非常感激，为什么你首先想要它们，如何避免混合单维和多维数组等时出现麻烦。无论如何，问题是：

我有一个名为 X 的二维数组：

```
X = numpy.arange(10).reshape(2,5) 
```

我想取 X 的最后一列并将其存储为另一个名为 Y 的二维数组（即列向量）。我能够为此提供的唯一方法是：

```
Y = numpy.atleast_2d(X[:,4]).T 
```

但我不喜欢这样有几个原因：

1.  当 X[:,4] 中应该隐含方向时，我觉得我不应该告诉它转置向量。

2.  在代码中反复使用 atleast_2D 似乎很麻烦，这种情况会出现很多。感觉就像我做错了什么。

那么，简而言之，有没有更好的方法？

谢谢。

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-03-01T19:32:24.650

首先，做你想做的事情的简单方法：

```
Y = X[:,4:] 
```

现在，numpy 在您之前尝试它时没有这样做的原因与数组在 Python 中的工作方式有关，实际上在大多数编程语言中也是如此。当您编写类似`a[4]`的内容时，这是在访问数组的第五个元素，而不是让您查看原始数组的某些部分。例如，如果`a`是一个数字数组，那么`a[4]`将只是一个数字。如果`a`是二维数组，即实际上是数组的数组，那么`a[4]`将是一维数组。基本上，访问数组元素的操作会返回比原始数组少一维的东西。

现在，Python 包含了一种称为“切片表示法”的东西，它使用冒号表示，这是一种访问数组元素的不同方式。它不是返回一个*元素*（维数比原始数组小一的东西），而是返回原始数组的一部分的副本。本质上，`a:b`表示索引`a`（包括）到`b`（不包括）处的所有元素的列表。可以省略其中一个`a`或`b`两个，在这种情况下，切片一直到数组的对应端。

这对您的情况意味着，当您编写 时`X[:,4]`，您有一个切片表示法和一个常规索引表示法。切片表示法表示沿第一维的所有索引（只有 0 和 1，因为数组有两行），而 4 表示沿第二维的第五个元素。常规索引的每个实例基本上都会将返回对象的维数减少一维，因此由于`X`是二维数组，并且有一个常规索引，因此您会得到一维结果。Numpy 只是将一维数组显示为行向量。诀窍是，如果你想得到与开始时相同尺寸的东西，那就是使用所有切片索引，就像我在本文顶部的示例中所做的那样。

如果要提取总列数超过 5 列的内容的第五列，可以使用`X[:,4:5]`. 如果您想要查看第 3-4 行和第 5-7 列的视图，您可以使用`X[3:5,5:8]`. 希望你明白这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-06T04:38:43.600

# 子集

更简单的方法是对矩阵进行子集化。

```
>>> X
[[0 1 2 3 4]
 [5 6 7 8 9]]

>>> X[:, [4]]
[[4]
 [9]]

>>> X[:, 4]
[4 9] 
```

它的工作原理有点类似于 Pandas 数据框。如果你索引数据框，它会给你一个**Series**。如果您对数据框进行子集化或切片，它会为您提供一个**dataframe**。

## 也可以看看

*   [This answer on a similar question](https://stackoverflow.com/a/69861473/16936415)

# php - DOMPDF“图像类型未知”通过 getImage.php 设置

> ID：15165171
> 
> 赞同：2
> 
> 时间：2013-03-01T19:15:45.413
> 
> 标签：php, image, dompdf

```
require_once '../system/conf/options.class.php';

$file = basename(urldecode($_GET['logo']));
$fileDir = Options::getSetting('S_UPLOAD_DIRECTORY');

if (file_exists($fileDir . $file)) {

    // Note: You should probably do some more checks 
    // on the filetype, size, etc.
    $contents = file_get_contents($fileDir . $file);

    $ext = @end(explode('.', $file));
    $file = @end(explode('/', $file));

    // Note: You should probably implement some kind 
    // of check on filetype
    header('Content-type: image/' . $ext);

    echo $contents;

} 
```

`<img class="logo" src="getLogo.php?logo={$PAGE['general']['logo_file']}" />`从 PDF 模板内部执行时，出现此错误

> 图片类型未知 getLogo.php?logo=75c562d5-8718-411c-a464-72c4d1c35f49.png

我也试过`<img class="logo" href="getLogo.php?logo={$PAGE['general']['logo_file']}" />`不显示错误，但也不显示图像。

有简单的解决方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-25T13:01:32.743

根据评论...您正在生成 HTML 文档，然后使用`$dompdf->load_html()`. 在这种情况下，Dompdf 将文档视为来自本地文件系统。这意味着没有域引用的图像将通过本地文件系统获取。因此，作为 PHP 脚本的图像引用将不起作用，因为 PHP 不会被解析。`<img src="http://example.com/getLogo.php...`简而言之，如果可以，请使用 ">之类的东西。

* * *

有一些 SO 答案可能有助于确定在使用[load_html_file](https://stackoverflow.com/a/15725461/264628)和[load_html](https://stackoverflow.com/a/26029788/264628)加载本地文件时如何确定路径。

# razor - 使用其他表中的数据从下拉菜单中插入行

> ID：15165175
> 
> 赞同：0
> 
> 时间：2013-03-01T19:15:59.230
> 
> 标签：razor, asp.net-mvc-4

我有 2 个表我尝试的是在最后一个 div 中 CategoryName 是一个 DrobDown 列表，其中包含我已经插入的名称...如何获取这些数据？如果有关代码的某些内容不清楚，我将解释这是我的模型：

```
public class Profits
{
 [Key]
    public int id { get; set; }    
    public double Value { get; set; }
    public string Description { get; set; }
    public DateTime DateCreation { get; set; }
    public ProfitCategories CategoryName { get; set; }
} 
```

}

这是我的控制器：

```
 public ActionResult DoInsertProf(Profits profits)
        {
            var Profit = new Profits
            {
                CategoryName = profits.CategoryName,
                Value = profits.Value,
              DateCreation = DateTime.Now,
                Description = profits.Description,
            };
            db.Profit.Add(profits);
            db.SaveChanges();
            return Redirect("/SelectData/ReadProfit");
        } 
```

这是我的观点：

```
@using (Html.BeginForm("DoInsertProf","InsertProfit"))
{
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Profits</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Value)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Value)
            @Html.ValidationMessageFor(model => model.Value)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Description)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Description)
            @Html.ValidationMessageFor(model => model.Description)
        </div>

         <div class="editor-label">
            @Html.LabelFor(model => model.CategoryName)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.CategoryName)
            @Html.ValidationMessageFor(model => model.CategoryName)
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:12:44.187

您的问题确实不清楚，并且您的代码无济于事...您是要加载填充了 DropDown 的表单还是在执行保存后显示一些结果？

# django - 在 django 中使用深度模板继承是否有显着的性能损失？

> ID：15165178
> 
> 赞同：1
> 
> 时间：2013-03-01T19:16:17.600
> 
> 标签：django, django-templates, django-testing

在我的 django 应用程序中，我有一个典型的基本模板，其中包含我的 doctype、script 和 css 标签等内容。

为了清晰和代码组织，我将这个基本模板解构为它的组成部分，每个部分都扩展了前一个部分，只添加了一个特定的东西。例如，base/favicon.html：

```
{% extends "base/chromeframe.html" %}
{% load staticlink %}

{% block metatags %}{{ block.super }}
<link href="{% staticlink 'img/favicon.ico' %}" rel="shortcut icon" type="image/x-icon">{% endblock metatags %} 
```

它扩展了 base/chromeframe.html：

```
{% extends "base/mobile.html" %}

{% block metatags %}{{ block.super }}{% if 'chromeframe' in request.META.HTTP_USER_AGENT %}
<meta http-equiv="X-UA-Compatible" content="chrome=1">{% endif %}{% endblock metatags %} 
```

这使我的基本模板更易于管理。 **我是否为这种方法付出了巨大的性能损失？** 基准模板渲染的好方法是什么？

在您建议我使用包含而不是继承之前 - 这不起作用，因为我正在设置被从我的基本模板派生的页面覆盖的块。

我知道我可以对这些模板部分进行某种预编译。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:22:56.197

我从来没有注意到模板执行时间是页面加载时间的一个重要因素，除非您正在运行一个流量极高的网站，否则担心它可能属于过早优化的范畴。

在几乎所有情况下，优化您的代码以便于开发和维护而不是边际执行速度的提高会为您提供最好的服务。

但是，如果您想了解它需要多长时间，请查看[Django 页面上的 profiling](https://code.djangoproject.com/wiki/ProfilingDjango)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T21:24:42.777

我已经证实了传统观点——即使有 22 层“不必要的”继承，渲染时间的差异也很小。

我的测试：

```
import time

from django.core.management.base import BaseCommand
from django.shortcuts import render_to_response as r2r

ITTER=100

class Command(BaseCommand):
    def handle(self, *args, **options):
        start = time.clock()
        for i in range(ITTER):
            r2r('base.html', { 'i': i },)
        middle = time.clock()
        for i in range(ITTER):
            r2r('newbase.html', { 'i': i },)
        end = time.clock()
        print "old way:%f new way:%f" % (middle-start, end-middle) 
```

我煞费苦心地将我的基本模板片段重新集成到 newbase.html 中，发现只有边际性能改进：

旧方式：1.770000 新方式：1.460000

仍然有显着的性能提升，但不足以证明 newbase.html 所导致的不可读的混乱是合理的。

我会在别处寻找优化。

# php - 这是测试已发布变量存在的正确方法吗？

> ID：15165179
> 
> 赞同：0
> 
> 时间：2013-03-01T19:16:19.593
> 
> 标签：php

如果查询可以可选地作为 a`get()` *或*a运行`post()`，以便`$id = $_POST['id']`可能获得空值，那么这些中的任何一个都是测试可能发布的变量是否存在的好方法。

`if (!empty($_POST['id'])){ $id = $_POST['id'];}else{$id = FALSE;}`

`if (isset($_POST['id'])){ $id = $_POST['id'];}else{$id = FALSE;}`

`$id = isset($_POST['id']) ? $_POST['id'] : FALSE;`

还是有其他首选方法？他们都做了`$_REQUEST()`两次，这使我倾向于认为可能有更好的方法。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:38:52.510

我会用

```
if (isset($_POST['id']) && strlen($_POST['id'])) $id = (int)$_POST['id']; 
```

去测试

*   如果设置了一个值（以免触发通知），以及
*   如果它是一个空字符串`''`

问题`empty()`在于它将 0 和 0.0 视为空，这可能是有问题的，因为值有时可能为 0。

单独的问题`isset()`在于它将`''`（空字符串）视为已设置，因此如果有人碰巧提交了表单而没有填写特定字段，`isset()`则会通过返回 TRUE 让它通过。`strlen()`是否可以检查是否确实存在非零长度的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:32:47.280

我会去：

```
$id = isset($_POST['id']) && strlen($_POST['id']) > 0 ? (int)$_POST['id'] : FALSE; 
```

首先它检查是否设置了 var，然后检查长度是否大于 0。

在我看来，它是最好的可读性，因为如果你正确缩进它就不需要 5 行代码，这使得它更难阅读并使你的文件更长：

```
 if (isset($_POST['id'])){ 
   $id = $_POST['id'];
 }else{
   $id = FALSE;
 } 
```

如果你将 $_POST 用作一个简单的 ID，只需使用 (int)$_POST['id'] 将其转换为 int。这样你肯定有一个号码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:50:28.280

> 如果查询可以选择作为 get() 或 post() 运行

如果它与查询字符串一起发布（所以两者都`$_GET`包含`$_POST`）`id`怎么办？

```
POST /yourscript.php?id=4
Host: yoursite.com

id=3 
```

您必须选择`id`使用哪个（这完全取决于您）。

作为其他人建议的替代方法，您可以使用 PHP 的内置[过滤器函数](http://php.net/manual/en/ref.filter.php)：

```
$id = filter_input(INPUT_POST, 'id', FILTER_VALIDATE_INT, FILTER_NULL_ON_FAILURE); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T19:19:18.510

虽然都可以使用，但您的第一个选项是检查的最佳方法：

```
if (!empty($_POST['id'])){ $id = $_POST['id'];}else{$id = FALSE;} 
```

考虑以下事项[`empty()`](http://php.net/manual/en/function.empty.php)：

*   ""（一个空字符串）
*   0（0 为整数）
*   0.0（0 作为浮点数）
*   "0" (0 作为字符串)
*   无效的
*   错误的
*   array() （一个空数组）
*   $var; （声明的变量，但没有值）

[`isset()`](http://php.net/manual/en/function.isset.php)只检查它是否为空。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T19:36:07.753

```
function getByKey($arr, $key, $default = false) {
   return isset($arr[$key]) ? $arr[$key] : $default;
}

$id = getByKey($_POST, 'id'); 
```

其他方式就像

```
 $id = filter_input(INPUT_POST, 'id', FILTER_VALIDATE_INT, array(
        'options' => array(
            'min_range' => 1, 
            'max_range' => 255,
            'default' => 1,
         )
   )); 
```

# c# - 架构问题：共享相同类库的解决方案；项目推广；分叉解决方案

> ID：15165180
> 
> 赞同：1
> 
> 时间：2013-03-01T19:16:27.123
> 
> 标签：c#, visual-studio-2010, architecture

我非常需要了解如何使用 Visual Studio 2010 在 c# 中管理一些非常基本的架构问题，并且在教科书和网站中找到解决方案时遇到了一些麻烦。假设我有一个 MyWinForm.sln 解决方案，它基于：MyWinForm.cs 和两个类库，假设：a.dll、b.dll 我的目标：我想重构我编写的应用程序，以便按顺序学习 C#拥有一个体面的应用程序架构。

1.  我希望设计一个必须包含通用方法的 c.dll，以便在不同的应用程序中重用它：MyWinForm 和，比如说，yawfs.sln（另一个 Windows 窗体解决方案），以便我可以创建对 c 的引用。两种解决方案中的 dll。我想我应该创建一个新的类库*解决方案* 为了重用它的类。但是，据我所知，我无法添加对不同解决方案的引用：我只能添加对当前解决方案中的程序集（当前解决方案中的不同项目）或 .Net 程序集的引用。我应该使用导航面板选择 a.dll 程序集来添加对它的引用吗？也许有一种方法可以将现有程序集包含到当前解决方案中，使其与相应解决方案中执行的更改保持同步？我不明白。

2.  如果我想从 MyWinForm 中提取 b.dll 来推广它，以达到与 c.dll 相同的目的，该怎么办？我如何将其作为新的解决方案进行推广？

3.  现在假设我需要分叉 MyWinForm 以便我拥有 MyWinFormLeft.sln 和 MyWinFormRight.sln；两者都将以与公共共享代码不同的方式发展。他们将使用（并共享）相同的 a.dll 和 b.dll 程序集（相同版本），但 MyWinForm.cs 中的代码将开始更改。从现有解决方案创建新解决方案的正确方法是什么？

我知道我的问题听起来很混乱，但麻烦来自我试图在联合 VS 和 C# 使用模式与我之前使用的 C 编译器/链接器周期之间执行的比较：编译代码以获取您的库然后链接到他们无论应用程序需要它们。时期。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:36:15.657

当面临在多个解决方案之间共享代码的需要时，我倾向于将共享代码放入它自己的解决方案中，然后将其打包为 nuget（请参阅[此处了解如何](https://docs.microsoft.com/en-gb/nuget/create-packages/creating-a-package)。）

然后，任何需要以版本化且易于同步/更新的方式使用其功能的解决方案都可以引用 nuget（[nuget 可以简单地存在于本地文件夹](https://docs.microsoft.com/en-gb/nuget/hosting-packages/overview)中。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:30:10.390

> 我想我应该创建一个新的类库解决方案以便重用它的类

你猜对了。

> 我无法添加对其他解决方案的引用：我只能在当前解决方案中添加对程序集的引用

您只能在当前解决方案中添加对*项目的引用。*您可以添加对作为另一个解决方案输出的已构建*程序集的引用。*

> 如果我想从 MyWinForm 中提取 b.dll 怎么办？

b.dll 将独立于 MyWinForm.exe 进行部署 - 您不需要“提取”它。

> 现在假设我需要分叉 MyWinForm 以便我拥有 MyWinFormLeft.sln 和 MyWinFormRight.sln；...从现有解决方案创建新解决方案的正确方法是什么？

这取决于两个项目之间差异的严重程度。常见的非可视组件可以是共享类库中的类。常见的可视化组件可以是同一类库中的用户控件，也可以是单独的类库中的用户控件。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T20:27:03.070

这和任何事情一样都是个人喜好问题。

您可以在多个解决方案中拥有项目。我个人认为这是等待发生的灾难，但它确实有它的粉丝。我已经看到人们对此陷入严重的混乱依赖。如果您要重构一些东西并且需要打破一些依赖关系，您可以将其拉到一端，然后将整个父解决方案放在您的膝上。它需要一些严肃的纪律，但如果你把事情搞砸了，你就不能那样不小心射中自己的脚。

您可以将所有内容放在一个解决方案中，该解决方案也有它的粉丝，如果我同时开发多个库 + 原型 + 单元测试，它确实可以节省大量切换。

我认为你说你想去的方式以及我们倾向于这样做的方式。

首先，您可以添加对从其他解决方案中的项目构建的 dll 的引用只需进入添加引用，其中一个选项卡是浏览，选择文件夹，选择 dll。

问题是你现在有一个在你的解决方案之外的构建依赖，与使用 3rd 方 dll 没有什么不同。所以如果你想在common.dll中添加另一个通用函数，你必须切换解决方案，添加它，构建它，切换解决方案（或者有两个副本VS去）

之后，这只是一个问题，即如何确保您引用的 dll 是您刚刚构建的那个。这可以将构建路径设置为公共文件夹，或者在构建后事件将其复制到使用项目所期望的位置。如果您喜欢痛苦，可以手动复制它...

找到适合您需求的方式有很多灵活性。

# javascript - gmpanel 上没有显示 infoBubble - EXTJS 4

> ID：15165183
> 
> 赞同：0
> 
> 时间：2013-03-01T19:16:34.687
> 
> 标签：javascript, google-maps, extjs, extjs4, infobubble

```
function addDoctorLocation(options) 
{
    var gm = Ext.getCmp('mygooglemap');
    var mpoint = new google.maps.LatLng(options.lat,options.lng);
    var marker = gm.addMarker(mpoint,options.marker,false,false, options.listeners);
    infoBubble = new InfoBubble({
            map: gm,
            content: '<div class="phoneytext">Some label</div>',
            //position: new google.maps.LatLng(options.lat, options.lng),
            shadowStyle: 1,
            padding: '10px',
            //backgroundColor: 'rgb(57,57,57)',
            borderRadius: 5,
            minWidth: 200,
            arrowSize: 10,
            borderWidth: 1,
            borderColor: '#2c2c2c',
            disableAutoPan: true,
            hideCloseButton: false,
            arrowPosition: 7,
            backgroundClassName: 'phoney',
            pixelOffset: new google.maps.Size(130, 120),
            arrowStyle: 2
        });
        infoBubble.open(map, marker);

} 
```

成功在地图上添加了标记，不幸的是 infoBubble 什么都没有显示？为什么？
并且在 FireBug 上没有任何错误

## 更新如何调用函数

```
tree.on('checkchange', function(node){
        var data = node.data;      
        if (data.checked == true){
        var lati,longi; 
        var record = MarkerStore.findRecord('MainID', data.MainID)
        if (record){
        lati = record.get('Latitude'); 
        longi = record.get('Longitude'); 
        }else{
        Ext.MessageBox.show({
        title: 'Error !',
        msg: 'No Record Found In Database ! <br />',
        icon: Ext.MessageBox.INFO
        }); 
        }       
        var options = {
        lat:lati,
        lng:longi,
        marker: {title:"Hello World!"},
        listeners: {
                     click: function(e){

                                         }
                    },
                    MainID: data.MainID     
        }     
        addDoctorLocation(options);  
        } else {
        markers[data.MainID].setMap(null);
    }   
    }) 
```

## 更新@Ankit

```
var markers = {};
var openedInfoWindow = null;    
function addDoctorLocation(options) 
{
    var gm = Ext.getCmp('mygooglemap');
    var mpoint = new google.maps.LatLng(options.lat,options.lng);
    var marker = gm.addMarker(mpoint,options.marker,false,false, options.listeners);
    markers[options.MainID] = marker;

     var infowindow = new google.maps.InfoWindow({
        content: 'Hello !',
        maxWidth: 200
    });

    google.maps.event.addListener(marker, 'click', function() {
        // added next 4 lines

      google.maps.event.addListener(infowindow, 'closeclick', function() {
          openedInfoWindow = null;
      });

      if (openedInfoWindow != null) openedInfoWindow.close();  // <-- changed this
      openedInfoWindow = infowindow;
      infowindow.open(gm, marker); 

    }); 
```

仍然无法关闭信息窗口，单击标记时出现此错误

```
TypeError: b.O is not a function
[Break On This Error]   

(82 out of range 43) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:28:33.013

```
function addDoctorLocation(options) 
{
 var gm = Ext.getCmp('mygooglemap');
 var mpoint = new google.maps.LatLng(options.lat,options.lng);
 var marker = gm.addMarker(mpoint,options.marker,false,false, options.listeners);
 var infowindow = new google.maps.InfoWindow({content: "Some label"});    
 google.maps.event.addListener(marker, 'click', function(gm,marker) {
                    infowindow.open(gm, marker); // if still you can not open than use infowindow.open(gm, this)
            })
} 
```

但看起来您想要设置信息窗口的样式而不是更好地使用信息框而不是信息窗口。检查 InfoBox ->[使用 Google Maps API 为 InfoWindow 设置样式](https://stackoverflow.com/questions/15140803/styling-infowindow-with-google-maps-api#comment21316211_15140803)

您可以将一些 html 标签（如 br、粗体）添加到 infowindow 内容，但我认为您不能设置 infowindow 的样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T11:23:19.113

我用谷歌地图实例尝试你的例子，它工作正常：

```
var markers = {};
var infowindow;
var openedInfoWindow = null;
var centerPointDefault = new google.maps.LatLng(39.739, -98.984);
function DrawMainMap(centerMap) {
    var myOptions = {
        center: centerMap,
        zoom: 7,
        mapTypeId: google.maps.MapTypeId.ROADMAP
    };
    map = new google.maps.Map(document.getElementById("map"), myOptions);
}
$(document).ready(function () {

var options = {
    lat: centerPointDefault.lat(),
    lng: centerPointDefault.lng(),
    marker: { title: "Hello World!" },
    listeners: {
        click: function(e) {

        }
    }
};

DrawMainMap(centerPointDefault);
addDoctorLocation(options);
}
function addDoctorLocation(options) {
var mpoint = new google.maps.LatLng(options.lat, options.lng);
var marker = new google.maps.Marker({
    position: mpoint
    });
marker.setMap(map);

var infowindow = new google.maps.InfoWindow({
    content: 'Hello !',
    maxWidth: 200
});

google.maps.event.addListener(marker, 'click', function() {
    // added next 4 lines

    google.maps.event.addListener(infowindow, 'closeclick', function() {
        openedInfoWindow = null;
    });

    if (openedInfoWindow != null) openedInfoWindow.close(); // <-- changed this
    openedInfoWindow = infowindow;
    infowindow.open(map, marker);

});
} 
```

# stream - 如何在 Kettle 中合并两个（或多个）转换的流？

> ID：15165187
> 
> 赞同：1
> 
> 时间：2013-03-01T19:16:46.167
> 
> 标签：stream, kettle

我们有几个表来存储报告的二进制 blob 及其元数据。我想做一份总结这些表格内容的报告。我为每个表创建了一个转换，它们都输出相同的变量。然后我有一个转换，读取值，然后格式化并将它们写入 XML 文件。

每个表转换都单独与输出转换一起工作。但是，如果我将它们全部指向输出转换，那么它们似乎只有一个有效，结果只反映一个表（我假设它们每个都运行，但它们相互覆盖）。

所以，我假设我需要以某种方式将流合并在一起。我不想将它硬编码到表转换中，因为我想让它们保持可重用和解耦。我也不想将它硬编码到报告编写器中，因为每当我需要只对表的子集进行报告时，我都需要处理它。

我尝试使用“Join\Merge Rows”或“Flow\Append”流，但这些流在工作级别似乎不可用，而且您似乎无法将转换嵌入到其他转换中。

这在水壶中甚至可能吗？4.1版怎么样？如果没有，它是否在较新的版本中？

我的工作图表看起来像这样。我所有的表转换目前都在使用“将行复制到结果”，而作者正在使用“从结果中获取行”。

```
 Table1
      /    \
     /      \
 Start      Output Report
     \      /
      \    /
      Table2 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T13:56:12.350

您不能合并作业中的流。作业并不是真的打算进行并行处理，我什至不确定当你像你一样拆分流时会发生什么（你可以在作业中做一些基本的分支，但就是这样）。您需要在转换中执行此操作，即使这意味着您只需创建一个包含调用转换的步骤的包装作业，仅此而已。

# java - 在面板上添加面板，两者都是可见的

> ID：15165189
> 
> 赞同：0
> 
> 时间：2013-03-01T19:16:50.530
> 
> 标签：java, swing, jpanel, graphics2d, layered

我正在制作一个音乐/绘图应用程序，您可以用鼠标自由绘制线条，TrackBar 水平穿过它并读取线条并使用 x 和 y 坐标来修改音乐。

*   我遇到的问题是`TrackBar`该类是一个 JPanel，而`DrawBoard`类是一个 JPanel，我将其添加到 Frame 中。但是，最重要的是要显示的那个，我想要的是让它们都显示，并在`TrackBar`绘制的线条之上传递。

下面是这3个类的源代码，并去掉了一些不必要的代码：

我在其中添加它们的 MainFrame 类（在当前设置下，TrackBar 不会出现，但绘图板会出现，因为它与它重叠）：

```
public class MainFrame extends JFrame {

public static ColourToolbar colourBar;
public static TrackBar tb;

public MainFrame(){

    super("VIPE by Prestige WorldWide");

    // Top colour toolbar for tones
    colourBar = new ColourToolbar();
    this.getContentPane().add(colourBar, BorderLayout.NORTH);

    // This class ImagePanel is a JPanel which I overite the paintCOmponent to have background
    ImagePanel bg = new ImagePanel();   
        bg.setLayout(new BorderLayout());
        Dimension size = getPreferredSize();
        size.setSize(1024,800); //w, h
        bg.setPreferredSize(size);
    this.getContentPane().add(bg, BorderLayout.CENTER);

    // I add the TrackBar to the ImagePanel since its the Background
    tb = new TrackBar();
    bg.add(tb, BorderLayout.CENTER);

    // I add the drawing board but It will overlap the Trackbar
    DrawBoard dboard =  new DrawBoard();
    bg.add(dboard, BorderLayout.CENTER);

    // The control toolbar where the settings and control buttons are.
    Toolbar toolBar = new Toolbar();
    this.getContentPane().add(toolBar, BorderLayout.SOUTH);
}

public static void main(String[] args){

    MainFrame frame = new MainFrame();

    frame.setBackground(Color.WHITE);
    frame.setSize(1024,768);
    frame.setLocationRelativeTo(null);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    frame.setResizable(false);
    //frame.pack();
    frame.setVisible(true);

}

} 
```

现在是 TrackBar 类：

```
public class TrackBar extends JPanel{

private TrackBarAction tba = new TrackBarAction(this);
public static int TIME = 9;

public Timer t = new Timer(TIME, tba);
public static double x = 0, y = 0, velX = 1.0, velY = 0;

private int SKIP = 120;

public TrackBar(){

    this.setOpaque(false);
}

@Override
public void paintComponent(Graphics g){
            super.paintComponent(g);

            Graphics2D g2d = (Graphics2D)g;
            //g2d.drawRect((int)x, (int)y, 10, 800);

            Rectangle2D r2d = new Rectangle2D.Double(x, y, 8.0, 800.0);  // x,x, w, h
            g2d.setPaint(Color.DARK_GRAY);
            g2d.fill(r2d);
            g2d.draw(r2d);
}

public void reset(){

    t.stop();
    x = 0;
    y = 0;
    velX = 0.5;
    velY = 0;
    this.repaint();
}

public void skipForward(){

    if(x+SKIP <= 1024){
     x += SKIP;   
    } else {
        x = 1024 - x;
    }

    this.repaint();
}

public void skipBackwards(){

    if(x-SKIP >= 0){
    x -= SKIP;
    } else {
        x = 0;
    }

    this.repaint();
}

} 
```

现在是 DrawBoard 类：

```
public class DrawBoard extends JPanel implements MouseListener, MouseMotionListener{

 (..)

public Color currentColor;

public static boolean eraser = false;

private int xX1, yY1;

public DrawBoard(){  

   Graphics2D g2d = bImage.createGraphics();
   g2d.dispose();

    Dimension size = getPreferredSize();
    size.setSize(1024,800); //w, h
    setPreferredSize(size);
    //status =  new JLabel("default");
    //add(status, BorderLayout.SOUTH);
    addMouseListener(this);
    addMouseMotionListener(this);  

     imgLabel = new JLabel(new ImageIcon(bImage)) {
     @Override
     protected void paintComponent(Graphics g) {
        super.paintComponent(g);
        paintInLabel(g);
     }
   };
     imgLabel.setOpaque(false);
     setOpaque(false);
      add(imgLabel, BorderLayout.CENTER);

}

private void paintInLabel(Graphics g) {

    if(!eraser){
        Graphics2D g2d = (Graphics2D) g;
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2d.setColor(getColor()); // this colour is when mouse is pressed
        g2d.setStroke(new BasicStroke(STROKESIZE));
        if (points.size() < 1) {
            return;
        }
        for (int i = 1; i < points.size(); i++) {
            int x1 = points.get(i - 1).x;
            int y1 = points.get(i - 1).y;
            int x2 = points.get(i).x;
            int y2 = points.get(i).y;
            g2d.drawLine(x1, y1, x2, y2);
        }
    }

}

// Where the drawing happens
@Override
public void mousePressed(MouseEvent e) {
    //status.setText("you pressed down the mouse");
    if(!eraser){
        xX1 = e.getX();
        yY1 = e.getY();
        points.add(e.getPoint());
    }
}

@Override
public void mouseDragged(MouseEvent e) {
  //status.setText("you draged the mouse");
    Graphics2D g2d = bImage.createGraphics();

    // this is the eraser code
    if(eraser){
        //Graphics2D g2d = bImage.createGraphics();
        System.out.println("eraser = true");
        System.out.println("Stroke = " + STROKESIZE);
        g2d.setComposite(AlphaComposite.Clear);
        g2d.setColor(new Color(0, 0, 0, 0));
        g2d.drawRect(e.getX(), e.getY(), STROKESIZE, STROKESIZE);
        g2d.fillRect(e.getX(), e.getY(), STROKESIZE, STROKESIZE);
       // g2d.setColor(c);

        imgLabel.repaint();
    }else {
        //g2d.setComposite();
        points.add(e.getPoint());
        System.out.println("point = " + e.getPoint());
        imgLabel.repaint();
    }

}

@Override
public void mouseReleased(MouseEvent e) {
    //status.setText("you release the mouse click");
    if(!eraser){
        Graphics2D g2d = bImage.createGraphics();
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2d.setColor(getColor()); // this is the final colour
        g2d.setStroke(new BasicStroke(STROKESIZE));

        if (points.size() >= 2) {
            for (int i = 1; i < points.size(); i++) {
                int x1 = points.get(i - 1).x;
                int y1 = points.get(i - 1).y;
                int x2 = points.get(i).x;
                int y2 = points.get(i).y;
                g2d.drawLine(x1, y1, x2, y2);
            }
        }
     g2d.dispose();

     points.clear();
     imgLabel.repaint();
    }
    //imgLabel.repaint();

}
// End of where the drawing happens

public void clearDrawBoard() {

}

private Color getColor() {

    return ColourToolbar.selectedColor;
}

private void setColor(Color col){

    this.currentColor = col;
}

@Override
public void mouseClicked(MouseEvent e) {
    //throw new UnsupportedOperationException("Not supported yet.");
}

} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:30:37.407

BorderLayout 只能有一个组件向每个组件添加 5 个位置。通过将 DrawPanel 添加到中心位置，您实际上是在移除 TrackPanel。

相反，将 TrackBar 的布局管理器设置为 BorderLayout 并将 DrawPanel 添加到其中。

您也可以使用 JLayeredPane，但管理变得更加复杂

# jquery - jQuery悬停/单击功能问题

> ID：15165190
> 
> 赞同：0
> 
> 时间：2013-03-01T19:17:07.883
> 
> 标签：jquery, function, click, hover

我创建了一个函数来处理一些交互。我正在使用点击和悬停的功能。在这种情况下，我将它用于悬停。它工作得很好，但有一个问题。当您将鼠标悬停在链接上并重新悬停在该链接上时，什么也没有发生。您必须先将鼠标悬停在另一个链接上，然后才能将鼠标悬停回来查看反馈。结果与点击相同。如果你点击链接。显示反馈，如果再次单击同一链接，则反馈消失。我为悬停和点击的示例创建了一个 JSFiddle。

悬停：

```
// Applying Best Practices
$(function(){
function applyingBestPractices(event) {

    // Create Vars
    var clickedClass = $(this).attr('class');
    var examples = $(".applying-best-practices .examples");
    var links = $(".applying-best-practices .nav a");

    // Add Tabindex to all Results
    examples.each(function(index) {
        $(this).attr('tabindex', index)
    });

    // Remove class for all
    examples.removeClass("showIT");
    links.removeClass("nav-select");

    // Adds active class to link 
    $(this).addClass("nav-select");

    // Add Class and Focus
    $("#" + clickedClass).addClass("showIT").focus();
    return false;
}
$(".applying-best-practices .nav a").hover(applyingBestPractices);
}); 
```

点击：http: [//jsfiddle.net/xEvav/1/](http://jsfiddle.net/xEvav/1/)

```
// Applying Best Practices
$(function(){
function applyingBestPractices(event) {

    // Create Vars
    var clickedClass = $(this).attr('class');
    var examples = $(".applying-best-practices .examples");
    var links = $(".applying-best-practices .nav a");

    // Add Tabindex to all Results
    examples.each(function(index) {
        $(this).attr('tabindex', index)
    });

    // Remove class for all
    examples.removeClass("showIT");
    links.removeClass("nav-select");

    // Adds active class to link 
    $(this).addClass("nav-select");

    // Add Class and Focus
    $("#" + clickedClass).addClass("showIT").focus();
    return false;
}
$(".applying-best-practices .nav a").click(applyingBestPractices);
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:34:38.697

它不起作用的原因是因为

```
var clickedClass = $(this).attr('class');
...
$(this).addClass("nav-select"); 
```

添加课程后`nav-select`

下次您再次单击导航时，clickedClass 将返回`example1 nav-select`，因为您正在尝试获取现在变为的类的属性`class="example1 nav-select"`

那么这将失败：

```
$("#example1 nav-select").addClass("showIT").focus(); 
```

**解决方案：**

[http://jsfiddle.net/Azefj/](http://jsfiddle.net/Azefj/)

**HTML：**

```
<a href="javascript:void();" alt="example1">example1</a>
<a href="javascript:void();" alt="example2">example2</a>
<a href="javascript:void();" alt="example3">example3</a>
.... 
```

**JS：**

```
// Create Vars
var clickedClass = $(this).attr('alt'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:38:16.517

这是解决方案：

```
$(function(){
    function buildingYourKnowledgeAndSkills(event) {

        if ($(this).hasClass('nav-select')) {
            $(".feedback .examples.showIT").focus();
        }
        else {
            // Create Vars
            var clickedClass = $(this).attr('class');
            var examples = $(".building-your-knowledge-and-skills .examples");
            var links = $(".building-your-knowledge-and-skills .nav a");

            // Add Tabindex to all Results
            examples.each(function(index) {
                $(this).attr('tabindex', index)
            });

            // Remove class for all
            examples.removeClass("showIT");
            links.not(this).removeClass("nav-select");

            // Adds active class to link 
            $(this).addClass("nav-select");
            $("#" + clickedClass).addClass("showIT").focus();
        }
        return false;
    }
    $(".building-your-knowledge-and-skills .nav a").click(buildingYourKnowledgeAndSkills);
}); 
```

我刚刚添加了这个 if else 语句来检查链接是否有类（'nav-select'）。

[http://jsfiddle.net/xEvav/48/](http://jsfiddle.net/xEvav/48/)

# javascript - jQuery选项卡不起作用

> ID：15165191
> 
> 赞同：0
> 
> 时间：2013-03-01T19:17:15.830
> 
> 标签：javascript, jquery, tabs

我不知道为什么这不起作用，尽管它应该：

```
$('#group-tabs').tabs({
    iframe: true,
    load: function(event, ui) {
        $('a', ui.panel).click(function() {
            $("#test").load(this.href);
            return false;
        });
    }
}); 
```

稍旧的版本（jquery 1.8.x 和 jquery-ui 1.9.x）

[http://jsfiddle.net/QGZZT/1/](http://jsfiddle.net/QGZZT/1/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:31:16.410

您需要更改您的 javascript，您访问了错误的元素：

```
$('#group-tabs').tabs({
    iframe: true,
    beforeLoad: function(event, ui) {
        $('a').click(function() {
            alert(this.href);
            $(".tab-content").load(this.href);
            return false;
        });
    }
}); 
```

参考。 [http://jsfiddle.net/QGZZT/2/](http://jsfiddle.net/QGZZT/2/)

但是，我不相信您能够为所欲为，因为“由于浏览器的限制，大多数 Ajax 请求都受制于“同源策略”。”

参考。 [无法使用 jQuery.load 将外部页面加载到我页面中的 div 中](https://stackoverflow.com/questions/5059302/cannot-load-an-external-page-with-jquery-load-into-a-div-in-my-page)

你可以; 但是，尝试使用 $.get 或简单地更改 iFrame 的源（非常简单）。

# php - 如何在 MySQL 中执行此多个 IF 语句

> ID：15165192
> 
> 赞同：0
> 
> 时间：2013-03-01T19:17:19.463
> 
> 标签：php, mysql, if-statement, nested

我有这张桌子：

```
scanner name | maxwidth | maxlength
====================================
scanner A    | 50       | 100
scanner B    | 60       | 120 
```

在我的 PHP 中，我有：

```
$paperW = 70;
$paperL = 55; 
```

如何执行 mysql 查询，以便我的结果返回：

```
scanner name
============
scanner B 
```

*这个想法是找到适合纸张尺寸的扫描仪。虽然纸张宽度为 70，长度为 55，而打印机 B 的最大宽度仅为 60，但我们始终可以旋转纸张方向，使纸张宽度变为 55，长度变为 70，以适合扫描仪 B。*

在伪代码中检查扫描仪是否适合纸张将如下所示：

```
if (paperW <= maxWidth && paperL <= maxLength)
 return true
else{
 if (paperW >  maxWidth){
    if (paperW <= maxLength && paperL <= maxWidth)
       return true;
    else
       return false;
 }
 else
  return false;
} 
```

我不知道将其转换为 MySQL Query .. 任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:51:06.250

尝试这个

```
 select scanner_name from your_table 
 where ('$paperW' <= maxwidth and $paperL <= maxlength ) 
  OR  ('$paperW' <= maxlength and $paperL <= maxwidth ) 
```

[**演示 SQLFIDDLE**](http://sqlfiddle.com/#!2/50369/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:41:37.523

只需在您的 php.ini 中获取矩形区域即可。

```
RectArea = width * length; 
```

并`RectArea`在 where 子句中使用。

```
 SELECT 
     SCANNER_NAME,
     MAX_WIDTH,
     MAX_LENGTH,
     (MAX_WIDTH * MAX_LENGTH) PAGE_AREA 
 FROM Scanners
    WHERE (MAX_WIDTH * MAX_LENGTH)  >=  RectArea ; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:22:06.887

```
$query = 
 "SELECT FROM scanners 
  WHERE ( maxwidth <= ".(int)$paperW." 
       && maxlength <= ".(int)$paperL)." 
  OR
        ( maxwidth <= ".(int)$paperL." 
       && maxlength <= ".(int)$paperW." )
     "; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T19:28:52.330

您可以使用类似于以下的 where 子句：

```
WHERE (paperW <= maxWidth AND paperL <= maxLength) OR 
      (paperL <= maxWidth AND paperW <= maxLength) 
```

这将为您提供大部分的帮助。请注意，它可能会返回多行，因此您可能需要进行一些排序以获得最佳匹配并添加 a`LIMIT 1`以返回单行。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T19:30:10.747

这是正确的答案（我认为 xD）：

```
SELECT * FROM scanners 
WHERE 
(maxwidth >= paperW and maxlength >= paperL) #First case
or 
(maxwidth >= paperL and maxlength >= paperW) #Rotating paper 
```

萨卢多斯 ;)

# ruby - Ruby：循环迭代方法的更清洁返回

> ID：15165194
> 
> 赞同：3
> 
> 时间：2013-03-01T19:17:20.507
> 
> 标签：ruby, methods, return-value, enumerable

我发现我经常使用迭代可枚举的方法以返回不同的可枚举或哈希。这些方法几乎总是看起来像这个简单的例子：

```
 def build_hash(array)
    hash = {}
    array.each do |item|
      hash[ item[:id] ]= item
    end
    hash
  end 
```

这种方法很有效，但我经常想知道是否有更简洁的方法可以做到这一点，特别是不必将循环包装在临时对象中以便返回正确。

有谁知道改进和/或更清洁和/或更快的方法来做到这一点，或者这几乎是最好的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:27:21.223

考虑到您的具体示例，这里有几种方法

```
arr = [{:id => 1, :name => :foo}, {:id => 2, :name => :bar}]

Hash[arr.map{ |o| [o[:id], o] }]
arr.each_with_object({}){ |o, h| h[o[:id]] = o }
arr.reduce({}){ |h, o| h[o[:id]] = o; h }
arr.reduce({}){ |h, o| h.merge o[:id] => o }

# each of these return the same Hash
# {1=>{:id=>1, :name=>:foo}, 2=>{:id=>2, :name=>:bar}} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:54:21.523

您可以使用 ActiveSupport 的[`index_by`](http://api.rubyonrails.org/classes/Enumerable.html#method-i-index_by).

你的例子变得微不足道：

```
def build_hash(array)
  array.index_by{|item| item[:id]}
end 
```

目前，即使在 Ruby 2.0 中，也没有在 Ruby 中构建散列的真正好方法。

你可以使用`Hash[]`，虽然我觉得很丑：

```
def build_hash(array)
  Hash[array.map{|item| [item[:id], item]}]
end 
```

如果[我们能说服 Matz](http://bugs.ruby-lang.org/issues/7292)，你至少可以：

```
def build_hash(array)
  array.map{|item| [item[:id], item]}.to_h
end 
```

还有[其他](https://bugs.ruby-lang.org/issues/4151)关于创建哈希的[新方法的请求。](https://bugs.ruby-lang.org/issues/6669)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:22:08.237

那么在这种情况下，您可以使用[`inject`](http://ruby-doc.org/core-2.0/Enumerable.html#method-i-inject)并执行以下操作：

```
def build_hash(array)
  array.inject({}) { |init, item| init[item[:id]] = item; init }
end 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T19:22:49.593

```
{}.tap { |h| array.each { |a| h[a[:id]] = a } } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-01T19:43:40.430

这里也是一种如何转换`Array`成`Hash`.

```
list_items = ["1", "Foo", "2", "Bar", "3" , "Baz"]

 hss = Hash[*list_items] 
```

*   参数必须是偶数，否则会引发致命错误，因为奇数个参数无法映射到一系列键/值对。

> {"1"=>​​"Foo", "2"=>"Bar", "3"=>"Baz"}

# mediawiki - 在模板内创建的标题

> ID：15165201
> 
> 赞同：6
> 
> 时间：2013-03-01T19:17:48.873
> 
> 标签：mediawiki, mediawiki-templates

我有许多基于公式创建标题的模板。我想知道是否有任何方法可以创建一个“编辑”链接，将您直接带到该部分？它当前的工作方式，编辑链接将带您编辑模板本身。我可以创建一个自定义链接，让您留在页面上并带您进入正确的部分吗？

这是一些示例代码，可帮助您解决问题...

**模板：头**：

```
==={{{1}}}===
This is a heading titled "{{{1}}}" 
```

**测试页**：

```
=Section 1=
{{head|1.1}}
{{head|1.2}}
{{head|1.3}}
=Section 2=
{{head|2.1}}
{{head|2.2}}
{{head|2.3}} 
```

目前，如果我想编辑模板“2.3”的信息，我必须编辑所有第 2 部分。（请注意，对于这个例子，这没什么大不了的。对于我正在使用的实际模板我的网站，模板有几十个参数，有时一个部分有 10 个或更多。）

底线，有没有办法在`{{head}}`模板内创建一个自定义编辑链接，可以直接在“测试页”页面上编辑模板调用？希望这是有道理的。

编辑：有没有办法利用“锚”标签？可以将锚点传递到 URL 中吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:23:33.953

重申您的问题，当您嵌入部分标题时，标题不会被视为目标页面的一部分，因此编辑链接会将您带回源。所以你需要一个单独的模板容器来单独编辑它，一个完整的部分是最小的可编辑容器。

我能想到的唯一方法是使用子页面（或虚拟子页面，如果您在此命名空间中没有启用该功能，则不会改变任何内容）。因此，不要放在`{{head|1.1}}`上`MyPage`，而是放在上面`MyPage/Subpage1`，然后`MyPage`以通常的方式将其转换为 ( `{{:MyPage/Subpage1}}`)。

`{{head}}`然后可以通过使用 HTML 标题标签（`<h2>`等于`==`等）将自定义编辑链接包含到模板输入以抑制标准编辑链接，然后使用[这些模板](http://en.wikipedia.org/wiki/Template%3aEdit_templates)之一（可能是 {{ [ed right](http://en.wikipedia.org/wiki/Template%3aEd_right) }}）创建自定义编辑指向`MyPage/Subpage1`.

顺便说一句，在 Mediawiki 中创建锚点的方法是使用`<span id="name"/>`标签，但这不会创建可以编辑的容器（或者至少，我无法通过 URL 修补来解决）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T17:58:39.830

我很确定没有办法做到这一点。就 MediaWiki 的部分编辑功能而言，*唯一*开始新部分的内容是以下形式的一行：

```
=== Some text here === 
```

标志的数量`=`决定了标题的级别。没有办法让 MediaWiki 让您编辑任何不以这样的行开头和结尾的文档片段（或页面的开头或结尾）。

好吧，好吧，我相信您在技术上*可以*通过扩展来做到这一点，从某种意义上说，您可以使用 MediaWiki 扩展来做*任何事情。*您需要做的就是为用户提供某种方式（例如，编辑 URL 中的特殊参数）以指示“我想编辑此模板”，然后从 wikitext 中提取模板，将其呈现给用户进行编辑, 并将结果写回到原始页面文本中。

棘手的部分是从页面源中提取模板。（在页面上查找和替换模板对于 MediaWiki 机器人编写者来说是一项相当常见的任务，因此您可能想在那里寻找想法。）无论您最终使用哪种方法，都可能存在需要放弃的边缘情况并告诉用户“对不起，我不知道该模板是如何嵌入到这里的。”

# c++ - 具有 Beta 分布的随机数生成器

> ID：15165202
> 
> 赞同：9
> 
> 时间：2013-03-01T19:17:52.923
> 
> 标签：c++, c, random

我需要`betarand(a,b)`生成具有 beta 分布的随机数的函数的 c 或 c++ 源代码。我知道我可以使用*boost*库，但我要将它移植到 CUDA 架构，所以我需要代码。有人可以帮助我吗？
同时我有`betapdf`（Beta概率密度函数）。但我不知道如何使用它来创建随机数:)。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-03-01T20:48:02.537

C++11 随机数库不提供 beta 发行版。但是，可以根据库提供的两个 gamma 分布*对beta 分布进行建模。*我已经为你实施了[`beta_distribution`](https://gist.github.com/sftrabbit/5068941)一个`std::gamma_distribution`。据我所知，它完全符合随机数分布的要求。

```
#include <iostream>
#include <sstream>
#include <string>
#include <random>

namespace sftrabbit {

  template <typename RealType = double>
  class beta_distribution
  {
    public:
      typedef RealType result_type;

      class param_type
      {
        public:
          typedef beta_distribution distribution_type;

          explicit param_type(RealType a = 2.0, RealType b = 2.0)
            : a_param(a), b_param(b) { }

          RealType a() const { return a_param; }
          RealType b() const { return b_param; }

          bool operator==(const param_type& other) const
          {
            return (a_param == other.a_param &&
                    b_param == other.b_param);
          }

          bool operator!=(const param_type& other) const
          {
            return !(*this == other);
          }

        private:
          RealType a_param, b_param;
      };

      explicit beta_distribution(RealType a = 2.0, RealType b = 2.0)
        : a_gamma(a), b_gamma(b) { }
      explicit beta_distribution(const param_type& param)
        : a_gamma(param.a()), b_gamma(param.b()) { }

      void reset() { }

      param_type param() const
      {
        return param_type(a(), b());
      }

      void param(const param_type& param)
      {
        a_gamma = gamma_dist_type(param.a());
        b_gamma = gamma_dist_type(param.b());
      }

      template <typename URNG>
      result_type operator()(URNG& engine)
      {
        return generate(engine, a_gamma, b_gamma);
      }

      template <typename URNG>
      result_type operator()(URNG& engine, const param_type& param)
      {
        gamma_dist_type a_param_gamma(param.a()),
                        b_param_gamma(param.b());
        return generate(engine, a_param_gamma, b_param_gamma); 
      }

      result_type min() const { return 0.0; }
      result_type max() const { return 1.0; }

      result_type a() const { return a_gamma.alpha(); }
      result_type b() const { return b_gamma.alpha(); }

      bool operator==(const beta_distribution<result_type>& other) const
      {
        return (param() == other.param() &&
                a_gamma == other.a_gamma &&
                b_gamma == other.b_gamma);
      }

      bool operator!=(const beta_distribution<result_type>& other) const
      {
        return !(*this == other);
      }

    private:
      typedef std::gamma_distribution<result_type> gamma_dist_type;

      gamma_dist_type a_gamma, b_gamma;

      template <typename URNG>
      result_type generate(URNG& engine,
        gamma_dist_type& x_gamma,
        gamma_dist_type& y_gamma)
      {
        result_type x = x_gamma(engine);
        return x / (x + y_gamma(engine));
      }
  };

  template <typename CharT, typename RealType>
  std::basic_ostream<CharT>& operator<<(std::basic_ostream<CharT>& os,
    const beta_distribution<RealType>& beta)
  {
    os << "~Beta(" << beta.a() << "," << beta.b() << ")";
    return os;
  }

  template <typename CharT, typename RealType>
  std::basic_istream<CharT>& operator>>(std::basic_istream<CharT>& is,
    beta_distribution<RealType>& beta)
  {
    std::string str;
    RealType a, b;
    if (std::getline(is, str, '(') && str == "~Beta" &&
        is >> a && is.get() == ',' && is >> b && is.get() == ')') {
      beta = beta_distribution<RealType>(a, b);
    } else {
      is.setstate(std::ios::failbit);
    }
    return is;
  }

} 
```

像这样使用它：

```
std::random_device rd;
std::mt19937 gen(rd());
sftrabbit::beta_distribution<> beta(2, 2);
for (int i = 0; i < 10000; i++) {
  std::cout << beta(gen) << std::endl;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T19:28:09.547

也许您可以使用`gsl`用于生成带有 beta 分布的随机数的代码。他们使用一种有点奇怪的方式来生成它们，因为你必须将一个随机数生成器传递给函数，但你肯定可以得到你需要的东西。

这是[文档](http://www.gnu.org/software/gsl/manual/html_node/The-Beta-Distribution.html)和[网页](http://www.gnu.org/software/gsl/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-08-19T16:11:20.237

Boost“逆不完全Beta”是另一种模拟Beta的快速（且简单）方法。

```
#include <random>
#include <boost/math/special_functions/beta.hpp>
template<typename URNG>
double beta_sample(URNG& engine, double a, double b)
{
  static std::uniform_real_distribution<double> unif(0,1);
  double p = unif(engine);
  return boost::math::ibeta_inv(a, b, p); 
  // Use Boost policies if it's not fast enough
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T19:26:30.297

查看随机数生成器实现`NumPy`：[NumPy 分发源](http://projects.scipy.org/numpy/browser/trunk/numpy/random/mtrand/distributions.c)

它们是用 C 语言实现的，工作速度非常快。

# database - 在 VS2012 和 windows 8 x64 中使用 MFC CDatabase 连接访问数据库

> ID：15165203
> 
> 赞同：0
> 
> 时间：2013-03-01T19:17:56.547
> 
> 标签：database, visual-c++, mfc

使用MFC编程连接access数据库，使用安装在windows 8 x64上的visual studio 2012 update 1，以下代码抛出异常，这在vs2010和windows 7 x64之前没有发生过。ODBC 管理器有什么变化吗？我应该如何更改连接字符串。

```
CDatabase db;
db.OpenEx(TEXT("ODBC;Driver={Microsoft Access Driver (*.mdb, *.accdb)};Dsn='';Dbq='d:\\databases\\a.mdb'"); 
```

和异常消息：

```
'Data source name not found and no default driver specified' 
```

它也不适用于 accdb 文件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-03-31T09:33:41.330

评论中的 cha 是正确的，因为默认情况下，Windows 8 中仅存在 x64 ODBC 驱动程序，用于在 win32 平台中编译的 MFC 应用程序。必须在 x86 中安装 ODBC 驱动程序。可以从这里下载：http: [//www.microsoft.com/en-us/download/details.aspx?id=13255](http://www.microsoft.com/en-us/download/details.aspx?id=13255)

# asp.net - 从树莓派浏览器访问 Windows 认证网页

> ID：15165212
> 
> 赞同：2
> 
> 时间：2013-03-01T19:18:40.770
> 
> 标签：asp.net, linux, windows-authentication, chromium, raspberry-pi

我们有一个想要从树莓派访问的网页，但是有问题的网页受到 Windows 身份验证的保护。有什么方法可以通过 Raspberry pi 传递此身份验证？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-09T14:37:58.927

Iceweasel 是 Firefox 的一个端口，它支持 Raspberry Pi 上的 NTLM 身份验证。据我所知，这是目前唯一一个在整个会话期间保留身份验证的主动更新浏览器。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-05-24T09:11:09.893

Chrome supports ntlm http auth scheme, you can read more about it [here](https://sites.google.com/a/chromium.org/dev/developers/design-documents/http-authentication).

If you're not using chrome (or chromium) then you need to check that your client has support for ntlm http auth scheme.

# jquery - Fancybox 为弹出的 HTML 页面添加滚动条

> ID：15165214
> 
> 赞同：1
> 
> 时间：2013-03-01T19:18:44.753
> 
> 标签：jquery, fancybox, scrollbar

我正在使用 fancybox 来显示一个 HTML 页面。每当页面弹出时，由于fancybox正在添加额外的空间，就会出现一个滚动条。我该如何删除它？我在这里和[这里](https://stackoverflow.com/questions/5532076/add-css-property-to-jquery)发现了类似的问题，答案显示了一个解决方案，但是每当我尝试它们时，我都无法让它们工作。有人能准确地告诉我我需要在我的脚本中放置“溢出：隐藏”的位置吗？这是我的代码：

```
$(document).ready(
    function(){
        $(".fancylink").fancybox({
            'hideOnContentClick' : true,
            'width' : 500,
            'type' : 'iframe',
            'padding' : 0,
            'onComplete' : function() {
                $('#fancybox-frame').load(function() { 
                    ('#fancybox-content').height($(this).contents().find('body').height()+30);
                });
            }
        });
    }
); 
```

# android - 如何将 Flash 播放功能添加到 Android 应用程序？

> ID：15165215
> 
> 赞同：0
> 
> 时间：2013-03-01T19:18:46.123
> 
> 标签：android, flash

我的 android 应用程序有一个 Web 浏览器组件，它应该可以播放来自 Internet 的 Flash 内容。我不想告诉用户单独下载 adobe flash 来访问我的应用程序上的 flash 内容。如何将 Flash 播放功能添加到我的应用程序中？谢谢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:22:43.187

我还没有听说过任何可以放在应用程序中的第三方 Flash 解释器，比如库。

老实说，您应该重新考虑为移动客户端提供的服务。不再支持所有移动平台 - Adob​​e 已停止开发 Adob​​e Flash Android - 因为有其他方法可以完成 Flash 过去完成的工作。

`<audio>`编辑：这是对 HTML5 中标签的一个很好的介绍。您必须仔细检查哪些格式可以流式传输到所有设备。我相信 MP3 应该适用于 iOS 和 Android。[http://www.position-absolute.com/articles/introduction-to-the-html5-audio-tag-javascript-manipulation/](http://www.position-absolute.com/articles/introduction-to-the-html5-audio-tag-javascript-manipulation/)

# mongodb - MongoDB：如何在数组结构化集合中进行查询。

> ID：15165226
> 
> 赞同：0
> 
> 时间：2013-03-01T19:19:31.083
> 
> 标签：mongodb

我有一个 Mongo DB COllection，如图所示

```
{
    "name": "SAM",
    "collection": [
        {
            "date": "2013-03-16",
            "values": [
                {
                    "price": "24.0"
                }
            ]
        },
        {
            "date": "2013-04-20",
            "values": [
                {
                    "price": "10.0"
                }
            ]
        },
        {
            "date": "2013-05-18",
            "values": [
                {
                    "price": "12.0"
                }
            ]
        },
        {
            "date": "2013-06-22",
            "values": [
                {
                    "price": "10.0"
                }
            ]
        },
        {
            "date": "2013-09-21",
            "values": [
                {
                    "price": "38.0"
                }
            ]
        }
    ]
} 
```

我试图获取与特定日期（2013-03-16）相关的数据，如图所示，但我正在获取所有日期的数据。

这就是我尝试过的。

请告诉我我在哪里做错了。

```
package com;

import java.net.UnknownHostException;

import com.mongodb.BasicDBObject;
import com.mongodb.DB;
import com.mongodb.DBCollection;
import com.mongodb.DBCursor;
import com.mongodb.Mongo;

public class Test {

    public static void main(String args[]) throws UnknownHostException {
        Mongo mongo = new Mongo();
        DB db = mongo.getDB("test");
        DBCollection mycollection = db.getCollection("mycollection");

        BasicDBObject query = new BasicDBObject();
        query.put("name", "SAM");
        query.put("collection.date", "2013-03-16");

        DBCursor cursor = mycollection.find(query);

        while (cursor.hasNext()) {
            System.out.println(cursor.next());
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:52:33.707

您可以[`$`](http://docs.mongodb.org/manual/reference/projection/positional/#_S_)在 的字段选择参数中使用位置投影运算符来执行此操作`find`：

```
BasicDBObject query = new BasicDBObject();
query.put("name", "SAM");
query.put("collection.date", "2013-03-16");
BasicDBObject fields = new BasicDBObject();
fields.put("name", 1);
fields.put("collection.$", 1);

DBCursor cursor = mycollection.find(query, fields); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:45:33.193

您正在尝试查询数组集合中的元素，您需要使用 $elemMatch，而不是，

```
query.put("collection.date", "2013-03-16"); 
```

你可以试试

```
query.put("collection", new BasicDBObject("$elemMatch", new BasicDBObject("date","2013-03-16"))); 
```

在此处阅读更多信息：http: [//docs.mongodb.org/manual/reference/projection/elemMatch/](http://docs.mongodb.org/manual/reference/projection/elemMatch/)

# gwt - GWT 问题 2079 错误消息无法删除

> ID：15165231
> 
> 赞同：1
> 
> 时间：2013-03-01T19:19:54.200
> 
> 标签：gwt, jetty, mgwt

我在我的项目中使用 gwt 和 mgwt。当我在 Eclipse 码头服务器上运行我的项目时，我收到以下警报错误消息：

> 跨站点托管模式尚未实现。请参阅问题 http://code.google.com/p/google-web-toolkit/issues/detail?id=2079

这与 appname.gwt.xml 文件中的以下链接器有关

```
 <add-linker name="xs" /> 
```

但是当我从 gwt.xml 模块中删除链接器时，错误仍然存​​在。我清理了项目并刷新了它，但我仍然收到错误消息。无法再在浏览器中测试应用程序。如何解决问题。请帮忙！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T19:51:51.887

尝试删除 *.nocache.js 文件。

顺便说一句，`xs`不推荐使用链接器，请使用链接器`xsiframe`（支持 DevMode，如 issue 2079 所述）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-03-06T10:54:09.467

**在添加链接器标记中将“ xs** ”替换为“ **xsiframe** ”，然后添加此标记 `<set-configuration-property name='xsiframe.failIfScriptTag' value='FALSE'/>`

然后重建项目

# java - java中的默认初始化

> ID：15165238
> 
> 赞同：13
> 
> 时间：2013-03-01T19:20:20.447
> 
> 标签：java, initialization

我对 Java 中的变量初始化感到困惑。据我了解，类变量默认初始化，而局部变量默认不初始化。但是，如果我使用 new 关键字在方法内创建一个数组，则默认情况下它会被初始化。所有对象都是这样吗？不管它是类变量还是局部变量，使用 new 关键字是否会初始化一个对象？

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2013-03-01T19:24:26.743

来自[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html#jls-4.12.5)

> 每个类变量、实例变量或**数组组件**在创建时都使用默认值进行初始化（第 15.9 节、第 15.10 节）：

*   对于 byte 类型，默认值为 0，即 (byte)0 的值。

*   对于short类型，默认值为0，即(short)0的值。

*   对于 int 类型，默认值为 0，即 0。

*   对于 long 类型，默认值为 0，即 0L。

*   For type float, the default value is positive zero, that is, 0.0f.

*   For type double, the default value is positive zero, that is, 0.0d.

*   For type char, the default value is the null character, that is, '\u0000'.

*   For type boolean, the default value is false.

*   For all reference types (§4.3), the default value is null

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-01T19:22:34.867

经过进一步调查，基元只有在成员变量时才会初始化为默认值，局部变量如果没有初始化就会抛出编译错误。

如果您创建一个基元数组，默认情况下它们都将被初始化（对于本地数组和成员数组都是如此），您将需要实例化一个对象数组。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-01T19:22:44.493

> 所有对象都是这样吗？不管它是类变量还是局部变量，使用 new 关键字是否会初始化一个对象？

当您使用`new`关键字时。这意味着你已经**初始化**了你的对象。不管它是在方法级别还是实例级别声明的。

```
public void method(){
Object obj1;// not initialized
Object obj2 = new Object();//initialized
} 
```

# c# - C# 游戏应用程序使用什么 GUI 技术？

> ID：15165239
> 
> 赞同：-4
> 
> 时间：2013-03-01T19:20:33.163
> 
> 标签：c#, .net

我想知道进行此操作的最佳方法是什么。我的目的是通过制作游戏和适当的 GUI 来更好地学习 C#。

我的游戏可能类似于 ZooTycoon ( [http://www.gamespot.com/zoo-tycoon/](http://www.gamespot.com/zoo-tycoon/) )，但要简单得多。因为我真的不打算学习一门新语言（比如 DirectX），只是为了为这个应用程序编写 GUI，所以我更喜欢更简单但方便的东西。那甚至存在吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:30:13.590

我建议看一下[SlimDX](http://slimdx.org/)或[SharpDX](https://code.google.com/p/sharpdx/)。

# html - 使用 Tab 键时如何更改文本字段选择顺序

> ID：15165241
> 
> 赞同：1
> 
> 时间：2013-03-01T19:20:41.690
> 
> 标签：html, forms, tab-ordering

我还在想如何重新命名这个标题。

无论如何，所以我在我的页面上有这个联系表：http: **[//leongaban.com/](http://leongaban.com/)**

当您单击名称并填写时，您可以**选择**下一个字段电子邮件。输入电子邮件后，用户很自然地再次进入消息框。

但是由于某种原因，我的选项卡选择一直跳到页面顶部，并且似乎选择了我的投资组合主导航链接。再多几个选项卡，我又回到了消息文本区域。

这当然一点也不理想，有没有办法可以强制选项卡选择以正确的顺序排列？即：*姓名>电子邮件>消息>验证码>提交*

**我目前的表格 (HTML)**

```
<div class="the-form">
            <form id="myForm" action="#" method="post">

            <div>
                <label for="name">Your Name</label>
                <input type="text" name="name" id="name" value="" tabindex="1">
            </div>

            <div>
                <label for="email">Your Email</label>
                <input type="text" name="email" id="email" value="" tabindex="1">
            </div>

            <div>
                <label for="textarea">Message:</label>
            </div>

            <div>
                <textarea cols="40" rows="8" name="message" id="message"></textarea>
            </div>

            <p><em>Hi, what is 2 + 3?</em></p>
            <input type="text" name="captcha" id="captcha" />

            <div>
                <input class="submit-button" type="submit" value="Submit">
            </div>

            </form>
        </div>

    </footer> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T19:25:38.170

你必须`tabindex`按照你希望他们去的顺序给你编号。

```
<input type="text" name="name" id="name" value="" tabindex="1">
<input type="text" name="email" id="email" value="" tabindex="2">
<textarea cols="40" rows="8" name="message" id="message" tabindex="3"></textarea>
<input type="text" name="captcha" id="captcha" tabindex="4"/>
<input class="submit-button" type="submit" value="Submit" tabindex="5"> 
```

等等

现在你有两个`tabindex`es 设置为 1，所以它们会先走，因为它们是唯一定义了 tabindex 的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:24:37.227

尝试将`tabindex`属性用于您的输入字段。这将让您控制用户可以通过您的页面元素切换的顺序。

可以在[此处](http://webcheatsheet.com/HTML/controll_tab_order.php)找到示例代码，尽管您已经`tabindex`在名称和电子邮件输入上设置了 a。只需将该属性添加到其余输入中，然后按照您想要的顺序设置它们。

# php - 使用函数时双重进入数据库？

> ID：15165243
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:20:49.180
> 
> 标签：php, mysql, function, mysqli

您好，我在使用函数将用户数据插入数据库时​​遇到问题。查询将执行两次，我不知道为什么会这样。

我确实使用此代码：

if (empty($_POST['submit']) === false && empty($errors) === true) {

```
$random = substr(str_shuffle('./0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'), 0, 22);;

$timezone = 'Europe/Berlin';
date_default_timezone_set($timezone);
$timestamp = time();
$time = date("d.m.Y - H:i:s", $timestamp);

$register_data = array(
    'a'     => $_POST['a'],
    'b'     => $_POST['b'],
    'c'     => $_POST['c'],
    'd'     => $_POST['d'],
    'e'     => $_POST['e'],
    'f'     => md5($_POST['password']),
    'g'     => md5($random),
    'h' => $time,
);
register_user($register_data);

if (register_user($register_data) === true) {
    echo "done";
}   
exit(); 
```

}

功能是：

```
function array_sanitize(&$item){
    global $db;
    return mysqli_real_escape_string($db, $item);
}

function register_user($register_data){
    global $db;
    array_walk($register_data, 'array_sanitize');

    $fields = '`' . implode('`, `', array_keys($register_data)) . '`';
    $data = '\'' . implode('\', \'', $register_data) . '\'';

    $insert = $db->query("INSERT INTO `table1` ($fields) VALUES ($data) "); 
    return (true);
} 
```

但是在替换此功能时：

```
function register_user($register_data){
    global $db;
    array_walk($register_data, 'array_sanitize');

    $fields = '`' . implode('`, `', array_keys($register_data)) . '`';
    $data = '\'' . implode('\', \'', $register_data) . '\'';

    $sql = "INSERT INTO `table1` ($fields) VALUES(?,?,?,?,?,?,?,NOW())";
        if($query = $db->prepare($sql)){
            $query->bind_param('sssssss', $data);
            $query->execute();

            if ($query->affected_rows == 1) {
                echo 'success';
            } else {
                echo 'nope';
            }
        }

    return (true);
} 
```

并从数组 $register_data 中删除最后一个键根本不起作用。

如果有人可以帮助我，那就太好了。

多谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:23:15.880

你打了`register_user($register_data);`两次电话。一次直接和一次 if 语句的一部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:31:50.950

我不知道 php 但尝试这样的事情：

```
$result=register_user($register_data);

if ($result == true) {    
 echo "done";
} 
```

# c# - 更新模型 Linq to Entities 中未包含的表字段

> ID：15165249
> 
> 赞同：0
> 
> 时间：2013-03-01T19:21:06.210
> 
> 标签：c#, entity-framework, nhibernate, audit

因此，我想将其称为“审计 Linq to Entities”或类似名称，但意识到这并不能完全概括我想要做的事情。简而言之，我们的数据建模器需要在我们的应用程序中的每个表上放置 4 列，甚至是我们的交叉引用表（代表多对多关系中间的表）

无论如何，我已经阅读了大量关于更改跟踪的文章，这与我想要做的很接近，但并不准确。我要做的是覆盖 TSQL 生成以附加我需要更新的未包含在模型中的列。

### 编辑

更多地考虑这个问题，我意识到我的例子并不完整......想象一下 User <---> Roles 关系以及它是如何工作的。您通常会创建 3 个表：[Users]、[Roles] 和 [UserRoles]，其中有 2 列用于将许多用户引用到许多角色。

现在，想象一下，对于所有三个表，您喜爱的 DBA 添加了 4 列：CreatedBy、CreatedOn、UpdatedBy、UpdatedOn。

在代码中，您可能有一个针对每个用户的角色集合（列表、集合、堆栈等），如以下 C# 代码所示：

```
public class User
{
    public int Id { get; set;}
    public string Username { get; set;}
    public string Firstname { get; set; }
    public string Lastname { get; set; }
    public string Password { get; set; }
    public List<Role> Roles { get; set; }
}

public class Role
{
    public int Id {get; set; }
    public string Code { get; set; }
    public string Description { get; set; }
} 
```

* * *

有没有人能够成功地更新所有更新和创建的列，而无需使用实体框架将这些字段添加到他们的模型中，如果是这样，他们能否提供这方面的示例？

同样的问题，但对于 NHibernate。如果 NHibernate 将支持这一点，但 Entity Framework 不支持，我很乐意说服权力允许我们使用 NHibernate 而不是 Entity Framework，因为我有一个正当的理由。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:29:58.657

我有一个非常相似的结构。更新字段的唯一方法是将它们作为属性添加到对象（我将它们封装在 AuditInfo 类中）或使用触发器。用户会在我的应用程序中显示审核字段，因此无论如何我都必须将它们作为属性提供。NHibernate 是如此可扩展，以至于您可以完成您的建议，但它会很丑陋。

在我的情况下，触发器是不够的，因为我们的应用程序有自己的用户管理，所以我必须在应用程序中设置 xBy 属性。我们还将触发器作为备份并记录在应用程序之外所做的更改（数据清理）。

多对多表存在一个大问题，因为我必须将它们包含在域模型中才能设置审计字段。我不这样做，所以对于那些表，我只有触发器中可用的审计信息（即除了实际用户名之外的所有内容）。

审计信息类：

```
[Serializable]
public sealed class AuditInfo
{
    public AuditInfo()
    {
        SetCreated(string.Empty, DateTime.Now);
    }

    public string CreatedBy { get; private set; }
    public DateTime CreatedDate { get; private set; }
    public string RevisedBy { get; private set; }
    public DateTime RevisedDate { get; private set; }

    public string CreatedInfo
    {
        get { return "Created: " + CreatedDate.ToShortDateString() + " by " + CreatedBy; }
    }

    public string RevisedInfo
    {
        get { return "Revised: " + RevisedDate.ToShortDateString() + " by " + RevisedBy; }
    }

    internal void SetCreated(string createdBy, DateTime createdDate)
    {
        CreatedBy = createdBy;
        CreatedDate = createdDate;
        SetRevised(createdBy, createdDate);
    }

    internal void SetRevised(string revisedBy, DateTime revisedDate)
    {
        RevisedBy = revisedBy;
        RevisedDate = revisedDate;
    }
} 
```

可审计实体实现的接口：

```
public interface IAuditable
{
    AuditInfo AuditInfo { get; }
} 
```

# garbage-collection - 了解垃圾收集数据

> ID：15165256
> 
> 赞同：0
> 
> 时间：2013-03-01T19:21:32.970
> 
> 标签：garbage-collection

全部，

我在运行我的程序时使用以下 VM 开关。该程序存在已知的内存泄漏。

最初堆满了，我理解 OutOfMemoryError 的原因。但后来（124.283）Full GC 回收了一些空间。那么为什么我仍然收到 OutOfMemoryError 呢？

提前致谢

## 虚拟机参数

-XX:+PrintGCTimeStamps -XX:+PrintGCDetails -Xms32m -Xmx32m

## 这是GC数据

* * *

堆满

* * *

123.540：[Full GC 123.540：[Tenured：21888K->21887K(21888K)，0.1215501 秒] 31679K->31679K(31680K)，[Perm：2054K->2054K(12288K)]，0.121603 秒][0.121603 秒]。 sys=0.00, real=0.13 secs] 123.665: [Full GC 123.665: [Tenured: 21887K->21887K(21888K), 0.1504579 secs] 31679K->31575K(31680K), [Perm : 2054K->2054K1()] 0.1505627 secs] [Times: user=0.16 sys=0.00, real=0.16 secs] 线程“RMI TCP 连接（空闲）”java.lang.OutOfMemoryError 中的异常：线程“AWT-EventQueue-0”java 中的 Java 堆空间异常。 lang.NullPointerException：在 sun.java2d.windows.GDIWindowSurfaceData.(Unknown Source) 在 sun.java2d.windows.GDIWindowSurfaceData.createData(Unknown Source) 在 sun.java2d.windows.GDIWindowSurfaceData.initOps(Native Method) 处的已处置组件。 awt.Win32GraphicsConfig。createSurfaceData(Unknown Source) at sun.java2d.ScreenUpdateManager.createScreenSurface(Unknown Source) at sun.java2d.d3d.D3DScreenUpdateManager.createScreenSurface(Unknown Source) at sun.awt.windows.WComponentPeer.replaceSurfaceData(Unknown Source) at sun.awt。 windows.WComponentPeer.replaceSurfaceData(Unknown Source) at sun.awt.windows.WComponentPeer$2.run(Unknown Source) at javax.swing.RepaintManager.seqPaintDirtyRegions(Unknown Source) at javax.swing.SystemEventQueueUtilities$ComponentWorkRequest.run(Unknown Source)在 java.awt.event.InvocationEvent.dispatch(Unknown Source) 在 java.awt.EventQueue.dispatchEvent(Unknown Source) 在 java.awt.EventDispatchThread.pumpOneEventForFilters(Unknown Source) 在 java.awt.EventDispatchThread.pumpEventsForFilter(Unknown Source)在 java.awt.EventDispatchThread。pumpEventsForHierarchy(Unknown Source) at java.awt.EventDispatchThread.pumpEvents(Unknown Source) at java.awt.EventDispatchThread.pumpEvents(Unknown Source) at java.awt.EventDispatchThread.run(Unknown Source) 123.829: [Full GC 123.829: [Tenured : 21887K->21887K(21888K), 0.1306163 secs] 31679K->30695K(31680K), [Perm : 2056K->2056K(12288K)], 0.1306809 secs] [Times: user=0.113 sys=0.00, real=0.]线程“RMI TCP 连接（空闲）”中的异常 java.lang.OutOfMemoryError：Java 堆空间 线程“RMI TCP 连接（空闲）”中的异常 java.lang.OutOfMemoryError：Java 堆空间 124.040：[Full GC 124.040：[Tenured： 21888K->21887K(21888K), 0.1259948 secs] 31680K->27400K(31680K), [Perm : 2057K->2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.1s]13秒]13秒]java.awt.EventDispatchThread.pumpEvents(Unknown Source) at java.awt.EventDispatchThread.run(Unknown Source) 123.829 处的 EventDispatchThread.pumpEvents(Unknown Source): [Full GC 123.829: [Tenured: 21887K->21887K(21888K), 0.1306163 secs] 31679K->30695K(31680K), [Perm : 2056K->2056K(12288K)], 0.1306809 secs] [Times: user=0.13 sys=0.00, real=0.13 secs] 线程“RMI TCP Connection(idle)”中的异常" java.lang.OutOfMemoryError: Java heap space Exception in thread "RMI TCP Connection(idle)" java.lang.OutOfMemoryError: Java heap space 124.040: [Full GC 124.040: [Tenured: 21888K->21887K(21888K), 0.1259948 secs ] 31680K->27400K(31680K), [Perm : 2057K->2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs]java.awt.EventDispatchThread.pumpEvents(Unknown Source) at java.awt.EventDispatchThread.run(Unknown Source) 123.829 处的 EventDispatchThread.pumpEvents(Unknown Source): [Full GC 123.829: [Tenured: 21887K->21887K(21888K), 0.1306163 secs] 31679K->30695K(31680K), [Perm : 2056K->2056K(12288K)], 0.1306809 secs] [Times: user=0.13 sys=0.00, real=0.13 secs] 线程“RMI TCP Connection(idle)”中的异常“ java.lang.OutOfMemoryError：线程“RMI TCP 连接（空闲）”中的 Java 堆空间异常 java.lang.OutOfMemoryError：Java 堆空间 124.040：[Full GC 124.040：[Tenured：21888K->21887K(21888K)，0.1259948 秒] 31680K->27400K(31680K), [Perm : 2057K->2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs]pumpEvents(Unknown Source) at java.awt.EventDispatchThread.run(Unknown Source) 123.829: [Full GC 123.829: [Tenured: 21887K->21887K(21888K), 0.1306163 secs] 31679K->30695K(31680K), [Perm: 2056K -> 2056K（12288K）]，0.1306809 秒] [时间：用户 = 0.13 系统 = 0.00，真实 = 0.13 秒] 线程“RMI TCP 连接（空闲）”中的异常 java.lang.OutOfMemoryError：线程中的 Java 堆空间异常“ RMI TCP Connection(idle)" java.lang.OutOfMemoryError: Java heap space 124.040: [Full GC 124.040: [Tenured: 21888K->21887K(21888K), 0.1259948 secs] 31680K->27400K(31680K), [Perm : 2057K- >2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs]pumpEvents(Unknown Source) at java.awt.EventDispatchThread.run(Unknown Source) 123.829: [Full GC 123.829: [Tenured: 21887K->21887K(21888K), 0.1306163 secs] 31679K->30695K(31680K), [Perm: 2056K -> 2056K（12288K）]，0.1306809 秒] [时间：用户 = 0.13 系统 = 0.00，真实 = 0.13 秒] 线程“RMI TCP 连接（空闲）”中的异常 java.lang.OutOfMemoryError：线程中的 Java 堆空间异常“ RMI TCP Connection(idle)" java.lang.OutOfMemoryError: Java heap space 124.040: [Full GC 124.040: [Tenured: 21888K->21887K(21888K), 0.1259948 secs] 31680K->27400K(31680K), [Perm : 2057K- >2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs][Perm : 2056K->2056K(12288K)], 0.1306809 secs] [Times: user=0.13 sys=0.00, real=0.13 secs] 线程“RMI TCP Connection(idle)”中的异常 java.lang.OutOfMemoryError: Java heap space线程“RMI TCP Connection(idle)”中的异常 java.lang.OutOfMemoryError：Java 堆空间 124.040：[Full GC 124.040：[Tenured：21888K->21887K(21888K)，0.1259948 秒]31680K->27400K(31680K)，[ Perm : 2057K->2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs][Perm : 2056K->2056K(12288K)], 0.1306809 secs] [Times: user=0.13 sys=0.00, real=0.13 secs] 线程“RMI TCP Connection(idle)”中的异常 java.lang.OutOfMemoryError: Java heap space线程“RMI TCP Connection(idle)”中的异常 java.lang.OutOfMemoryError：Java 堆空间 124.040：[Full GC 124.040：[Tenured：21888K->21887K(21888K)，0.1259948 秒]31680K->27400K(31680K)，[ Perm : 2057K->2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs]1259948 secs] 31680K->27400K(31680K), [Perm : 2057K->2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs]1259948 secs] 31680K->27400K(31680K), [Perm : 2057K->2057K(12288K)], 0.1260596 secs] [Times: user=0.13 sys=0.00, real=0.13 secs]

* * *

堆内存在下面的 Full GC 中回收

* * *

124.283：[Full GC 124.283：[Tenured：21888K->15215K(21888K)，0.0945810 秒] 31680K->15215K(31680K)，[Perm：2057K->2055K(12288K)]，0.0945810 秒]，0.094603 秒。 sys=0.00, real=0.09 secs] 124.829: [GC 124.829: [DefNew: 8704K->988K(9792K), 0.0079326 secs] 23919K->16203K(31680K), 0.0079854 secs] [Times: user=0.00 sys=0.00,真实= 0.00秒]线程“RMI TCP连接（空闲）”中的异常java.lang.OutOfMemoryError：线程“RMI TCP连接（空闲）”中的Java堆空间异常java.lang.OutOfMemoryError：线程“RMI中的Java堆空间异常” TCP 连接（空闲）”java.lang.OutOfMemoryError：线程“RMI TCP 连接（空闲）”中的 Java 堆空间异常 java.lang.OutOfMemoryError：线程“RMI TCP 连接（空闲）”java.lang 中的 Java 堆空间异常。内存不足错误：线程“RMI TCP 连接（空闲）”中的 Java 堆空间异常 java.lang.OutOfMemoryError：线程“RMI TCP 连接（空闲）”中的 Java 堆空间异常 java.lang.OutOfMemoryError：线程“RMI TCP 连接”中的 Java 堆空间异常（空闲）“java.lang.OutOfMemoryError：Java 堆空间异常在线程“RMI TCP 连接（空闲）”java.lang.OutOfMemoryError：Java 堆空间

# ruby-on-rails - Rails Observer 4.0 的替代品

> ID：15165260
> 
> 赞同：156
> 
> 时间：2013-03-01T19:21:39.767
> 
> 标签：ruby-on-rails, ruby-on-rails-4

随着 Observers 正式[从 Rails 4.0](https://github.com/rails/rails-observers)中删除，我很好奇其他开发人员正在使用什么来代替他们。（除了使用提取的 gem。）虽然观察者肯定被滥用并且有时很容易变得笨拙，但除了缓存清除之外，还有许多有用的用例。

例如，需要跟踪模型更改的应用程序。观察者可以轻松地观察模型 A 的变化，并在数据库中记录模型 B 的变化。如果你想观察多个模型的变化，那么一个观察者就可以处理。

在 Rails 4 中，我很好奇其他开发人员使用什么策略来代替观察者来重新创建该功能。

就个人而言，我倾向于一种“胖控制器”实现，在每个模型控制器的创建/更新/删除方法中跟踪这些更改。虽然它略微夸大了每个控制器的行为，但它确实有助于提高可读性和理解性，因为所有代码都在一个地方。缺点是现在有非常相似的代码分散在多个控制器中。将该代码提取到辅助方法中是一种选择，但您仍然需要调用那些到处都是的方法。不是世界末日，但也不完全符合“瘦控制器”的精神。

ActiveRecord 回调是另一种可能的选择，尽管我个人不喜欢这种方法，因为在我看来，它倾向于将两个不同的模型过于紧密地耦合在一起。

所以在 Rails 4，没有观察者的世界里，如果你必须在另一个记录被创建/更新/销毁之后创建一个新记录，你会使用什么设计模式？胖控制器、ActiveRecord 回调，还是完全其他的东西？

谢谢你。

* * *

## 回答 #1

> 赞同：85
> 
> 时间：2013-09-02T22:45:14.207

看看[关注点](http://37signals.com/svn/posts/3372-put-chubby-models-on-a-diet-with-concerns)

在模型目录中创建一个名为关注点的文件夹。在那里添加一个模块：

```
module MyConcernModule
  extend ActiveSupport::Concern

  included do
    after_save :do_something
  end

  def do_something
     ...
  end
end 
```

接下来，将其包含在您希望运行 after_save 的模型中：

```
class MyModel < ActiveRecord::Base
  include MyConcernModule
end 
```

根据你在做什么，这可能会让你在没有观察者的情况下接近。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2013-05-17T14:38:40.717

他们现在在一个[插件](https://github.com/rails/rails-observers)中。

我还可以推荐[一个替代方案](https://github.com/krisleech/wisper)，它会给你这样的控制器：

```
class PostsController < ApplicationController
  def create
    @post = Post.new(params[:post])

    @post.subscribe(PusherListener.new)
    @post.subscribe(ActivityListener.new)
    @post.subscribe(StatisticsListener.new)

    @post.on(:create_post_successful) { |post| redirect_to post }
    @post.on(:create_post_failed)     { |post| render :action => :new }

    @post.create
  end
end 
```

* * *

## 回答 #3

> 赞同：22
> 
> 时间：2013-08-07T03:56:49.523

我的建议是阅读 James Golick 在[http://jamesgolick.com/2010/3/14/crazy-heretical-and-awesome-the-way-i-write-rails-apps.html](http://jamesgolick.com/2010/3/14/crazy-heretical-and-awesome-the-way-i-write-rails-apps.html)上的博客文章（尝试忽略如何不谦虚的标题听起来）。

过去都是“胖模型，瘦控制器”。然后胖模型变得非常头疼，尤其是在测试期间。最近推动的是瘦模型——这个想法是每个类都应该处理一个责任，而模型的工作是将您的数据持久化到数据库中。那么我所有复杂的业务逻辑都到哪里去了？在业务逻辑类中——代表事务的类。

当逻辑开始变得复杂时，这种方法可能会变成一个泥潭（笨拙）。不过这个概念是合理的——与其使用难以测试和调试的回调或观察者隐式触发事物，不如在一个在模型之上分层逻辑的类中显式地触发事物。

* * *

## 回答 #4

> 赞同：13
> 
> 时间：2013-03-01T19:53:51.970

使用活动记录回调只是翻转了耦合的依赖关系。例如，如果你有`modelA`一个`CacheObserver`观察`modelA`rails 3 风格，你可以毫无问题地删除`CacheObserver`。现在，改为`A`必须手动调用`CacheObserver`after save，这将是 rails 4。您只是移动了依赖项，因此您可以安全地删除`A`但不是`CacheObserver`.

现在，从我的象牙塔来看，我更喜欢观察者依赖于它所观察的模型。我是否足够在意弄乱我的控制器？对我来说，答案是否定的。

大概你已经考虑了为什么你想要/需要观察者，因此创建一个依赖于观察者的模型并不是一个可怕的悲剧。

对于依赖控制器动作的任何类型的观察者，我也有（我认为是有理由的）厌恶。突然之间，您必须将观察者注入任何可能更新您想要观察的模型的控制器操作（或另一个模型）中。如果您可以保证您的应用程序只会通过创建/更新控制器操作来修改实例，那么您将获得更多权力，但这不是我对 Rails 应用程序所做的假设（考虑嵌套表单、模型业务逻辑更新关联等）

* * *

## 回答 #5

> 赞同：13
> 
> 时间：2014-03-28T19:21:35.517

[Wisper](https://github.com/krisleech/wisper)是一个很好的解决方案。我个人对回调的偏好是它们由模型触发，但事件仅在请求进来时才被监听，即我不希望在测试等中设置模型时触发回调，但我确实想要它们每当涉及控制器时触发。使用 Wisper 很容易设置，因为您可以告诉它只监听块内的事件。

```
class ApplicationController < ActionController::Base
  around_filter :register_event_listeners

  def register_event_listeners(&around_listener_block)
    Wisper.with_listeners(UserListener.new) do
      around_listener_block.call
    end
  end        
end

class User
  include Wisper::Publisher
  after_create{ |user| publish(:user_registered, user) }
end

class UserListener
  def user_registered(user)
    Analytics.track("user:registered", user.analytics)
  end
end 
```

* * *

## 回答 #6

> 赞同：9
> 
> 时间：2014-07-11T13:08:56.973

在某些情况下，我只是使用[Active Support Instrumentation](http://edgeguides.rubyonrails.org/active_support_instrumentation.html)

```
ActiveSupport::Notifications.instrument "my.custom.event", this: :data do
  # do your stuff here
end

ActiveSupport::Notifications.subscribe "my.custom.event" do |*args|
  data = args.extract_options! # {:this=>:data}
end 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2013-07-18T03:57:58.960

我对 Rails 3 Observers 的替代方案是手动实现，它利用模型中定义的回调但设法（如 agmin 在上面的回答中所述）“翻转依赖关系......耦合”。

我的对象继承自提供注册观察者的基类：

```
class Party411BaseModel

  self.abstract_class = true
  class_attribute :observers

  def self.add_observer(observer)
    observers << observer
    logger.debug("Observer #{observer.name} added to #{self.name}")
  end

  def notify_observers(obj, event_name, *args)
    observers && observers.each do |observer|
    if observer.respond_to?(event_name)
        begin
          observer.public_send(event_name, obj, *args)
        rescue Exception => e
          logger.error("Error notifying observer #{observer.name}")
          logger.error e.message
          logger.error e.backtrace.join("\n")
        end
    end
  end

end 
```

（当然，本着组合优于继承的精神，上述代码可以放在一个模块中并混合在每个模型中。）

初始化器注册观察者：

```
User.add_observer(NotificationSender)
User.add_observer(ProfilePictureCreator) 
```

除了基本的 ActiveRecord 回调之外，每个模型都可以定义自己的可观察事件。例如，我的 User 模型公开了 2 个事件：

```
class User < Party411BaseModel

  self.observers ||= []

  after_commit :notify_observers, :on => :create

  def signed_up_via_lunchwalla
    self.account_source == ACCOUNT_SOURCES['LunchWalla']
  end

  def notify_observers
    notify_observers(self, :new_user_created)
    notify_observers(self, :new_lunchwalla_user_created) if self.signed_up_via_lunchwalla
  end
end 
```

任何希望接收这些事件通知的观察者只需要 (1) 向公开事件的模型注册和 (2) 拥有一个名称与事件匹配的方法。正如人们所预料的那样，多个观察者可以注册同一个事件，并且（参考原始问题的第二段）观察者可以跨多个模型观察事件。

下面的 NotificationSender 和 ProfilePictureCreator 观察者类为各种模型公开的事件定义了方法：

```
NotificationSender
  def new_user_created(user_id)
    ...
  end

  def new_invitation_created(invitation_id)
    ...
  end

  def new_event_created(event_id)
    ...
  end
end

class ProfilePictureCreator
  def new_lunchwalla_user_created(user_id)
    ...
  end

  def new_twitter_user_created(user_id)
    ...
  end
end 
```

一个警告是，所有模型中公开的所有事件的名称必须是唯一的。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2014-10-29T14:51:16.687

我认为观察者被弃用的问题不是观察者本身不好，而是他们被滥用了。

我会告诫不要在你的回调中添加太多的逻辑，或者只是移动代码来模拟观察者的行为，因为观察者模式已经有一个很好的解决方案来解决这个问题。

如果使用观察者有意义，那么一定要使用观察者。只需了解您将需要确保您的观察者逻辑遵循正确的编码实践，例如 SOLID。

如果您想将观察者 gem 添加回您的项目 [https://github.com/rails/rails-observers ，则可以在 ruby​​gems 上使用观察者 gem](https://github.com/rails/rails-observers)

看到这个简短的线程，虽然不是完整的全面讨论，但我认为基本论点是有效的。 [https://github.com/rails/rails-observers/issues/2](https://github.com/rails/rails-observers/issues/2)

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2015-05-02T07:35:50.210

用 PORO 代替怎么样？

这背后的逻辑是您的“保存时的额外操作”可能是业务逻辑。我喜欢将其与 AR 模型（应该尽可能简单）和控制器（正确测试很麻烦）分开

```
class LoggedUpdater

  def self.save!(record)
    record.save!
    #log the change here
  end

end 
```

并简单地这样称呼它：

```
LoggedUpdater.save!(user) 
```

您甚至可以通过注入额外的保存后操作对象来扩展它

```
LoggedUpdater.save(user, [EmailLogger.new, MongoLogger.new]) 
```

并举一个“额外”的例子。不过，您可能想对它们进行一些修饰：

```
class EmailLogger
  def call(msg)
    #send email with msg
  end
end 
```

如果你喜欢这种方法，我推荐阅读[Bryan Helmkamps 7 Patterns](http://blog.codeclimate.com/blog/2012/10/17/7-ways-to-decompose-fat-activerecord-models/)博客文章。

编辑：我还应该提到，上述解决方案还允许在需要时添加事务逻辑。例如，使用 ActiveRecord 和支持的数据库：

```
class LoggedUpdater

  def self.save!([records])
    ActiveRecord::Base.transaction do
      records.each(&:save!)
      #log the changes here
    end
  end

end 
```

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-05-17T14:45:45.283

你可以试试[https://github.com/TiagoCardoso1983/association_observers](https://github.com/TiagoCardoso1983/association_observers)。它尚未针对 rails 4（尚未发布）进行测试，需要更多协作，但您可以检查它是否适合您。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2017-05-08T16:29:47.587

值得一提的是[`Observable`](https://ruby-doc.org/stdlib-2.2.2/libdoc/observer/rdoc/Observable.html)，Ruby 标准库中的模块不能用于类似活动记录的对象，因为实例方法会`changed?`与.`changed`[`ActiveModel::Dirty`](http://api.rubyonrails.org/v4.2.5.2/classes/ActiveModel/Dirty.html#method-i-changed)

[Rails 2.3.2 的错误报告](https://rails.lighthouseapp.com/projects/8994/tickets/4056-rails-232-dirty-tracking-has-error-when-observable-is-included)

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2013-07-27T14:55:00.527

我有同样的问题！我找到了一个解决方案 ActiveModel::Dirty，这样您就可以跟踪您的模型更改！

```
include ActiveModel::Dirty
before_save :notify_categories if :data_changed? 

def notify_categories
  self.categories.map!{|c| c.update_results(self.data)}
end 
```

[http://api.rubyonrails.org/classes/ActiveModel/Dirty.html](http://api.rubyonrails.org/classes/ActiveModel/Dirty.html)

# php - 委托语法

> ID：15165262
> 
> 赞同：0
> 
> 时间：2013-03-01T19:21:46.073
> 
> 标签：php

```
$var = Foo::bar('aaa', 'bbb')
      ->add('something', AnyClass::instance($var, 'something')); 
```

`Foo::bar()`返回它的对象，`add()`做一些事情并把一个新类作为第二个参数。这个类需要当前的 Foo 对象。

有没有办法做到这一点而不将其分成两个语句？Foo::bar()。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:46:07.373

其他一些语言让你说类似

```
(var = Foo::bar('aaa', 'bbb'))->add(...); 
```

（括号中是赋值部分）。不幸的是（至少从 5.3 开始），PHP 的解析器在这方面相当糟糕，当你尝试时会吓坏。

所以看起来你必须把它分成两个语句，或者`return $this`从`add`方法中。

除此之外，我能想到的最好的就是

```
call_user_func(array($var = Foo::bar('aaa', 'bbb'), 'add'), 'something', ...); 
```

我认为没有人会认为更具可读性。:P

# magento - 捆绑产品如何在 price.phtml 中查看模式（网格/列表）

> ID：15165273
> 
> 赞同：0
> 
> 时间：2013-03-01T19:22:47.610
> 
> 标签：magento

我想知道如何检查我们是否有网格或列表

```
\template\bundle\catalog\product\price.phtml 
```

我想根据模式（网格/列表）设置格式价格，在 list.phtml 中我们可以通过以下方式检查模式类型

```
<?php if($this->getMode()!='grid'): ?> 
```

但在 price.phtml 中，此方法无效，谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:26:05.207

$_GET['mode'] 将包含模式，如果未设置它是默认模式（取决于您的配置）。如果它不够干净并且您只使用 1 种模式，您可以通过 getStoreConfig 或使用 Mage_Catalog_Block_Product_List getMode() 方法来获得它；）

# sql - REGEXP_REPLACE - 仅当包含在 () 中时才从字符串中删除新行 \n

> ID：15165274
> 
> 赞同：4
> 
> 时间：2013-03-01T19:22:49.203
> 
> 标签：sql, regex, oracle, plsql

我正在尝试使用 REGEXP_REPLACE 替换字符串中的所有新行 (\n)，但有一个例外 - 它们必须用括号括起来才能替换。

例子：

字符串之前：

```
'a\n, b\n, c (a\n, b, c\n), d\n, e'
var1 := 'a
, b
, c (a
, b, c
), d
, e' 
```

字符串后：

```
'a\n, b\n, c, (a b c), d\n, e'
var2 := 'a
, b
, c (a, b, c), d
, e' 
```

我知道必须有一个干净的正则表达式模式可以做到这一点 - 但我无法理解它。

非常感谢...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T22:26:15.207

```
var2 := regexp_replace(var1, '((\)|^).*?(\(|$))|'||chr(10), '\1', 1, 0, 'n'); 
```

# c# - 使用 BeginAccept 与使用 TcpListener 阻塞 Accept 的专用线程相比，我可以获得什么好处？

> ID：15165277
> 
> 赞同：0
> 
> 时间：2013-03-01T19:22:52.370
> 
> 标签：c#, sockets, asynchronous

我试图考虑是否可以从使用 BeginAccept 中获得任何可伸缩性优势，而不是仅仅阻塞在等待连接的专用线程中。显然，各个客户端将使用 BeginXXX/EndXXX 对来利用 IOCP 进行网络 IO，但我认为等待客户端连接的延迟应该非常低。我计划创建一个任务来处理传入的连接，这样我在接受完成后的后续代码不会阻塞主接受线程很长时间（足够长来创建一个任务对象），我可以马上回到阻塞状态在新的连接上。这几乎是我对 BeginAccept/EndAccept 所做的，只是没有管理异步调用的复杂性。

所以，我的问题是，通过使用 IOCP 接受，我可以获得哪些可扩展性优势（如果有的话）？请注意，这不是用于在单个客户端套接字上发送/接收，而只是用于接受服务器侦听套接字上的连接。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T20:21:29.487

如果您只有一个正在侦听的端口，那可能不值得 - 就像您一次只需要处理几个连接一样，您可能不会费心使用异步操作来处理这些连接。

异步的服务器端好处通常是当你扩大规模时——对于处理连接，当你获得大量连接时；因为`BeginAccept`当你在很多不同的端口上监听时。这可能比较少见，但是如果您*确实*想监听 100 个不同的端口（例如，如果您在一台服务器上托管大量网站，并且出于某种原因只想监听不同的端口而不是使用 Host 标头），那么您不需要想要 100 个线程只占用堆栈空间。

# android - Android Logcat 在模拟器中运行良好，在真实设备中运行不佳

> ID：15165279
> 
> 赞同：3
> 
> 时间：2013-03-01T19:23:01.527
> 
> 标签：android, logging, android-logcat

我从我的应用程序中的服务执行 Logcat。

```
commandLine = "logcat -v time -b main"
process = Runtime.getRuntime().exec(commandLine); 
```

当它在任何 AVD 上运行时，它会捕获来自系统中运行的任何进程的所有日志消息。
当我通过复制apk并以正常方式安装应用程序在真实设备（ASUS TF201）中运行它时，它只捕获来自我自己的应用程序的日志消息。

该应用程序运行良好，没有崩溃，所有活动都正常工作，甚至是启动和停止 logcat 的活动。在 AVD 中运行和在设备中运行之间的唯一区别是缺少消息。我知道缺少消息，因为我在我的应用程序之外运行 aLogCat 并且 aLogCat 确实捕获了所有消息。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:43:47.273

这应该始终是预期的行为，并且在 Jelly Bean 中得到了正确修复。每个应用程序应该只能访问与其自己的进程相关的 logcat 信息。

在您的情况下，您需要以 root 身份运行该命令来访问不属于您的应用程序的 logcat 消息。

- 参考 -

[所以问题](https://stackoverflow.com/questions/12407797/using-logcat-on-jellybean)

[讨论](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/6U4A5irWang)

[安卓问题](https://code.google.com/p/android/issues/detail?id=34450)

[aLogCat 用户评论](https://play.google.com/store/apps/details?id=org.jtb.alogcat)

希望这能满足你的好奇心。

# php - TinyMCE 上的 Javascript 错误

> ID：15165280
> 
> 赞同：1
> 
> 时间：2013-03-01T19:23:02.737
> 
> 标签：php, tinymce

当我尝试将文件插入内容时，我在 TinyMCE 对话框中遇到 javascript 错误。这是我得到的：未捕获的类型错误：无法读取未定义的属性“长度”####.com/editor/jscripts/tiny_mce/plugins/Archiv/php/fileLoader.php?file=javascript 165

最初我认为路径被破坏了，所以我检查了我的链接并意识到一切都很好。我认为这可能是浏览器兼容性问题，但对 Safari、Firefox 甚至，可悲的是，IExplorer 的测试证明情况并非如此。然后我认为问题可能出在我的 TinyMCE 版本上，并用新文件对其进行了修补，但没有成功。我无计可施！请帮助，任何人。

这是 fileLoader.php：

```
 <?php

switch($_GET['file']){
    # Javascript files
    case 'javascript':
        header('Content-type: text/javascript');
        readfile('..' . DIRECTORY_SEPARATOR . '..' . DIRECTORY_SEPARATOR . '..' . DIRECTORY_SEPARATOR . 'tiny_mce_popup.js')."\r\n\r\n";
        readfile('..' . DIRECTORY_SEPARATOR . 'js' . DIRECTORY_SEPARATOR . 'flash_detect_min.js')."\r\n\r\n";
        readfile('..' . DIRECTORY_SEPARATOR . 'js' . DIRECTORY_SEPARATOR . 'jquery' . DIRECTORY_SEPARATOR . 'jquery-1.3.2.min.js')."\r\n\r\n";      
        readfile('..' . DIRECTORY_SEPARATOR . 'js' . DIRECTORY_SEPARATOR . 'jquery' . DIRECTORY_SEPARATOR . 'jquery-ui-1.7.2.custom.min.js')."\r\n\r\n";
        readfile('..' . DIRECTORY_SEPARATOR . 'js' . DIRECTORY_SEPARATOR . 'SWFupload' . DIRECTORY_SEPARATOR . 'swfupload.min.js')."\r\n\r\n";      
        readfile('..' . DIRECTORY_SEPARATOR . 'js' . DIRECTORY_SEPARATOR . 'json2.min.js')."\r\n\r\n";
        readfile('..' . DIRECTORY_SEPARATOR . 'js' . DIRECTORY_SEPARATOR . 'SWFupload' . DIRECTORY_SEPARATOR . 'handlers.min.js')."\r\n\r\n";       
        readfile('..' . DIRECTORY_SEPARATOR . 'js' . DIRECTORY_SEPARATOR . 'archiv.min.js');        
        break;

    # default 404
    default:
        header("HTTP/1.0 404 Not Found");
        break;
}

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:34:40.447

听起来 PHP 正在按预期运行。您提到的错误是 Javascript 错误，因为 PHP 不使用`.length`您不会看到错误`get length of undefined`来自 PHP。

尝试手动包含所有 JS 文件并查看错误在哪里。很可能其中一个库期望页面上没有元素。如果它们被缩小，我建议使用[Source Maps](http://www.html5rocks.com/en/tutorials/developertools/sourcemaps/)。

# internet-explorer - iframe中pdf后面的IE下拉菜单

> ID：15165281
> 
> 赞同：0
> 
> 时间：2013-03-01T19:23:07.677
> 
> 标签：internet-explorer, pdf, iframe

我正在尝试修复一个根据您选择的菜单项将多个 pdf 文件拉入 iframe 的网站。这适用于大多数浏览器，但在 IE7、8 和 9 中，当 iframe 中显示 pdf 时，下拉导航位于 iframe 后面。

这不是 z-index 问题，我知道这是 IE 的问题。我也知道我可以使用 google pdf 视图，一切都会好起来的，但他们不想依赖这个。

任何人都可以提供有关如何解决此问题的建议。有我可以使用的插件吗？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T09:23:57.830

为此，我使用了另一个 iFrame。我将此称为 helperIframe，并将其放在下拉列表后面

您可以在以下来源看到：http: [//neckermann.schmetterling-quadra.de/](http://neckermann.schmetterling-quadra.de/)

希望有帮助。

```
<li rel="id:{$group.id}" onmouseover="showNaviPoints(Navi{$group.id})" onmouseout="hideNaviPoints(Navi{$group.id})"> ...
<ul ...>
</ul>   
<iframe id="helperIframe{$group.id}" style="display:none;"></iframe>

function showNaviPoints(navi)
{
    jQuery(navi).css('display', 'block').next().css({
        'display'   : 'block',
        'width'     : jQuery(navi).width(),
        'height'    : jQuery(navi).height(),
        'position'  : 'absolute',
        'border'    : 'none'

    });
}
function hideNaviPoints(navi)
{
    jQuery(navi).parent().parent().find('li ul').css('display', 'none');
    jQuery(navi).css('display', 'none').next().css('display', 'none');
} 
```

# javascript - 使用 push() 后，数组被记录为数字

> ID：15165288
> 
> 赞同：2
> 
> 时间：2013-03-01T19:23:31.377
> 
> 标签：javascript, arrays, push

我正在尝试获取一些图像数组来翻阅。第一组需要降序，而第二组需要升序，所以我写了这个：

```
var flipArray = [];

function createFlipArray(older, newer){

    flipArray = $("#"+older).children();

    flipArray = flipArray.get().reverse();

    flipArray = flipArray.push($('#'+newer).children());

    console.log(flipArray);

    loopThroughImages();

} 
```

当我将第二组推到第一组时，它将数组记录为 4，即使整个数组中有 6 个项目。

如果我在用较大的孩子填充数组后记录该数组，它会返回 HTML 对象，我希望在我推动较新的孩子之后看到这些对象。

有什么建议么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T19:25:57.243

[`.push`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/push)就地修改数组。它不*返回*新数组，而是返回数组的新长度。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T19:26:08.307

`Array.prototype.push`返回数组的新长度。它*修改*了原始数组。去掉`flipArray =`前面的。

# hash - 散列 unix 影子文件的密码

> ID：15165290
> 
> 赞同：3
> 
> 时间：2013-03-01T19:23:34.027
> 
> 标签：hash, hex, md5, shadow

所以，我在 linux shadow 文件中有这个条目

```
google.:$1$8KdNUQ4R$ZYyUXVGhvLgVNpfqus.GX/::1:0:1:1::: 
```

该用户的密码是`com`

据我了解，`$1$`它是使用 md5 散列的方法； `8KdNUQ4R`是盐；并且`ZYyUXVGhvLgVNpfqus.GX/`是散列密码本身。

让我感到困惑的是，我在网上找到的 md5 生成器会生成一个 32 个字符长的十六进制值，但在这种情况下，哈希密码只有 22 个字符长，而且绝对不是十六进制。

我必须经过哪些步骤才能`com`使用`ZYyUXVGhvLgVNpfqus.GX/`给定的盐？

**编辑**

所以，我找到了我的答案。我的问题是我应该使用 md5crypt 而不是 md5。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T19:46:10.037

如果您需要计算特定密码的哈希值，请使用 crypt(3)：

```
#include <iostream>
#include <unistd.h>

int main()
{
   std::cout << crypt( "com", "$1$8KdNUQ4R" ) << std::endl;
   return 0;
} 
```

如果您想知道如何获取它 - salt + 密码的 md5 哈希结果通过 base64 转换为字符串。

```
slava@bird:~$ g++ crypt.cpp -lcrypt -o crypt_com
slava@bird:~$ ./crypt_com 
$1$8KdNUQ4R$ZYyUXVGhvLgVNpfqus.GX/ 
```

# java - 番石榴表与多个哈希图的效率

> ID：15165293
> 
> 赞同：8
> 
> 时间：2013-03-01T19:23:49.573
> 
> 标签：java, guava, performance

我遇到了一些正在做这样的事情的代码：

```
Map<String,String> fullNameById = buildMap1(dataSource1);
Map<String,String> nameById = buildMap2(dataSource2);
Map<String,String> nameByFullName = new HashMap<String,String>();
Map<String,String> idByName = new HashMap<String,String>();

Set<String> ids = fullNameById.keySet();
for (String nextId : ids) {
  String name = nameById.get(nextId);
  String fullName = fullNameById.get(nextId);
  nameByFullName.put(fullName, name);
  idByName.put(name, nextId);
} 
```

我不得不盯着它看了几分钟才能弄清楚发生了什么。所有这些都相当于对 id 的连接操作和原始地图之一的反转。由于 Id、FullName 和 Name 始终是 1:1:1，在我看来应该有一些方法来简化这一点。我还发现前两张地图再也没有使用过，而且我发现上面的代码有点难以阅读。所以我正在考虑用这样的东西代替它（对我来说）读起来更干净

```
Table<String, String, String> relations = HashBasedTable.create();

addRelationships1(dataSource1, relations);
addRelationships2(dataSource2, relations);

Map<String,String> idByName = relations.column("hasId");
Map<String,String> nameByFullName = relations.column("hasName");
relations = null; // not used hereafter 
```

在 addRelationships1 我做

```
relations.put(id, "hasFullName", fullname); 
```

在我的查询产生值的 addRelationships2 中`id`，`name`我做到了

```
relations.put(relations.remove(id,"hasFullName"), "hasName", name);
relations.put(name, "hasId", id); 
```

所以我的问题是：

1.  我通过处理器或内存或 GC 负载所做的工作是否存在潜在的低效率？我不这么认为，但我对 Table 的效率不是很熟悉。我知道 Table 对象在之后不会被 GC `relations = null`，我只是想说明它不会在随后的相当长的代码部分中再次使用。
2.  我有没有提高效率？我不断地说服自己和不说服自己，我有也没有。
3.  你觉得这更具可读性吗？或者这只是因为我写的而对我来说很容易阅读？我在这方面有点担心，因为事实`Table`并不为人所知。另一方面，顶层现在很清楚地说，“从两个来源收集数据并从中制作这两张地图。” 我也喜欢这样一个事实，即它不会让您想知道其他两张地图是否/在哪里使用（或不使用）。
4.  你有比上述任何一种方法更好、更清洁、更快、更简单的方法吗？

请不要在这里进行优化早期/晚期讨论。我很清楚这个陷阱。如果它在不损害性能的情况下提高了可读性，我很满意。性能提升将是一个不错的奖励。

**注意：**我的变量和方法名称已在这里进行了清理，以防止业务领域分散讨论，我绝对不会将它们命名为 addRelationships1 或 datasource1！同样，最终的代码当然会使用常量而不是原始字符串。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-07T19:15:57.487

所以我自己做了一些小型基准测试，得出的结论是这两种方法在执行时间方面几乎没有区别。我通过交易运行数据集大小来保持正在处理的数据的总大小不变。我进行了 4 次运行，并从所有 4 次运行中为每个实现选择了最短的时间。再次令人欣慰的是，这两种实现在同一次运行中总是最快的。我的代码可以在[这里](https://gist.github.com/anonymous/5110608)找到。这是我的结果：

```
Case                      Maps (ms)   Table (ms)    Table vs Maps
100000 runs of size 10    2931        3035          104%
10000 runs of size 100    2989        3033          101%
1000 runs of size 1000    3129        3160          101%
100 runs of size 10000    4126        4429          107%
10 runs of size 100000    5081        5866          115%
1 run  of size 1000000    5489        5160          94% 
```

因此，对于小型数据集，使用 Table 似乎会稍微慢一些。有趣的事情发生在 100,000 左右，然后到 100 万，表实际上更快。我的数据将在 100 到 1000 范围内徘徊，因此至少在执行时间上性能应该几乎相同。

至于可读性，我的观点是，如果有人试图弄清楚附近发生了什么并阅读代码，那么看到意图会明显容易得多。如果他们必须实际调试这段代码，可能会有点困难，因为`Table`它不太常见，并且需要一些复杂性才能理解。

我不确定的另一件事是创建哈希映射是否更有效，或者在随后迭代映射的所有键的情况下直接查询表。然而，这是一个不同的问题:)

喜剧的结局是，事实上，当我进一步分析代码（数百行）时，我发现 nameByFullname.get() 在日志记录之外的唯一重要用途（价值可疑）是将结果传递给 idByName 。得到（）。所以最后我实际上将构建一个 idByFullName 映射和一个 idByName 映射，而不需要任何连接，并且无论如何都会删除整个表。但我猜它提出了一个有趣的 SO 问题。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-02T00:29:33.087

tl; 博士，但恐怕你需要从原始设计迈出更大的一步。模拟 DB 表可能是一个不错的练习，但对我来说，您的代码并不是真正可读的。

1.  *我所做的事情是否存在潜在的低效率......*不知道。
2.  *我有没有提高效率？*恐怕你需要先测量一下。删除一些间接性肯定会有所帮助，但使用更复杂的数据结构可能会抵消它。总的来说，性能太复杂了。
3.  *你觉得这更具可读性吗？*恐怕不是。
4.  *你有比上述任何一种方法更好、更清洁、更快、更简单的方法吗？*但愿如此....

我在这样的代码中迷失的地方是对所有内容都使用字符串 - 将错误的字符串作为参数传递太容易了。所以我建议将它们聚合成一个对象，并提供通过它们的任何部分访问对象的映射。像这样微不足道的事情应该做：

```
class IdNameAndFullName {
    String id, name, fullName;
}

class IdNameAndFullNameMaps {
    Map<String, IdNameAndFullName> byId;
    Map<String, IdNameAndFullName> byName;
    Map<String, IdNameAndFullName> byFullName;
} 
```

您显然可以`IdNameAndFullNameMaps`用`Table`. 然而，除了使用一个很好的预先存在的数据结构之外，我认为其中没有任何优势。缺点是：

*   效率损失
*   `Table`可读性丧失（出于同样的原因，我不会在这里使用，`Tuple` [应该避免](http://code.google.com/p/guava-libraries/wiki/IdeaGraveyard)）
*   使用字符串键（您的“hasId”和“hasName”）。

# c++ - 在 C++ 类中混合指向 const 结构的指针——在参数列表中声明一个结构？

> ID：15165294
> 
> 赞同：1
> 
> 时间：2013-03-01T19:24:09.897
> 
> 标签：c++, pointers, embedded, constants, rom

我正在使用 C++ 开发嵌入式硬件，并且我经常使用指向 const (ROM) 结构的指针来最小化对象大小。

当我得到一个传递给我的类构造函数的指针时，我希望编译器根据我传递的对象创建另一个 ROM 对象，但更改了一个或两个参数，然后调用父类构造函数 (Display_Element)。关于如何做到这一点的任何想法？

由于可以在参数列表中声明 const 字符串，但我可能还有一种方法可以在参数列表中声明 const 结构。

我想做这样的事情，（这在 C++ 中是非法的）

```
Button::Button(const Colors_const* ecc, const Display_element_const* edc, const Element_const* eec, char* elabel,
    Display_element* eparent, Screen* escreen) :
      Display_element(ecc, cc,Display_element_const {
                        edc->xi+200,
                        edc->xf,
                        edc->yi,
                        edc->yf,
                        edc->font_size,
                        edc->image,
                        edc->image_x_offset,
                        edc->image_y_offset,
                        edc->label_x_offset,
                        edc->label_y_offset,
                        edc->mouse_down_ptr,
                        NULL,
                        edc->largura_borda_externa,
                        edc->borda_panel
                    },
                    eec,elabel,eparent,escreen) {

    flags.largura_borda = 2;
    //flags.largura_borda_externa = 3;
    flags.borda_light_shadow = true;
    flags.sliding_text = true;
    flags.dont_paint_on_click = false;
} 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-18T12:15:48.810

好吧，看来我想做的事情确实是*非法*的，不能在 C 中完成。但从哲学上讲，我一直在问自己：我是否可以分配写在参数列表中的 const char[n]，例如 fn(... "The brow dog",...) 为什么不以同样的方式分配 const 结构呢？如果有人知道答案，请留言！

我发现的解决方法是以规范的方式进行：声明一个 const 结构，然后将适当的指针分配给该结构（我想首先在 Display_element 函数中完成）。它解决了我的问题，但不是我一直试图制定的概念问题......

```
const Display_element_const new_ec = {
        edc->xi+200,
        edc->xf,
        edc->yi,
        edc->yf,
        edc->font_size,
        edc->image,
        edc->image_x_offset,
        edc->image_y_offset,
        edc->label_x_offset,
        edc->label_y_offset,
        edc->mouse_down_ptr,
        NULL,
        edc->largura_borda_externa,
        edc->borda_panel
    };

Button::Button(const Colors_const* ecc, const Display_element_const* new_edc, const Element_const* eec, char* elabel,
    Display_element* eparent, Screen* escreen) :
      Display_element(ecc, edc,eec,elabel,eparent,escreen) {
    //previously dc = edc, assigned inside Display_element fn
    dc = &new_ec; 
```

# powershell - 列出目录中所有文件和文件夹的 PowerShell 脚本

> ID：15165295
> 
> 赞同：7
> 
> 时间：2013-03-01T19:24:10.077
> 
> 标签：powershell, powershell-3.0

我一直在尝试找到一个脚本，它可以递归地打印这样的目录中的所有文件和文件夹，其中反斜杠用于指示目录：

```
Source code\
Source code\Base\
Source code\Base\main.c
Source code\Base\print.c
List.txt 
```

我正在使用 PowerShell 3.0，而我发现的大多数其他脚本都不起作用（尽管它们与我所要求的完全不同）。

另外：我需要它是递归的。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-01T20:02:49.043

您可能正在寻找有助于区分文件和文件夹的东西。幸运的是，有一个属性调用`PSIsContainer`对文件夹为真，对文件为假。

```
dir -r  | % { if ($_.PsIsContainer) { $_.FullName + "\" } else { $_.FullName } }

C:\Source code\Base\
C:\Source code\List.txt
C:\Source code\Base\main.c
C:\Source code\Base\print.c 
```

如果不需要前导路径信息，您可以使用以下方法轻松删除它 `-replace`：

```
dir | % { $_.FullName -replace "C:\\","" } 
```

希望这能让你朝着正确的方向前进。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T19:45:26.100

它可能是这样的：

```
$path = "c:\Source code"
DIR $path -Recurse | % { 
    $_.fullname -replace [regex]::escape($path), (split-path $path -leaf)
} 
```

遵循@Goyuix 的想法：

```
$path = "c:\source code"
DIR $path -Recurse | % {
    $d = "\"
    $o = $_.fullname -replace [regex]::escape($path), (split-path $path -leaf)
    if ( -not $_.psiscontainer) {
        $d = [string]::Empty 
    }
    "$o$d"
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-01T21:25:23.227

```
dir | % {
   $p= (split-path -noqualifier $_.fullname).substring(1)
   if($_.psiscontainer) {$p+'\'} else {$p}
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-28T16:48:30.990

这个显示了完整的路径，就像其他一些答案一样，但更短：

```
ls -r | % { $_.FullName + $(if($_.PsIsContainer){'\'}) } 
```

但是，我认为 OP 要求提供*相对路径*（即相对于当前目录），只有@CB 的回答解决了这一点。因此，只需添加 a`substring`我们就有了：

```
ls -r | % { $_.FullName.substring($pwd.Path.length+1) + $(if($_.PsIsContainer){'\'}) } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-23T09:35:11.090

> 将目录列表转换为 Txt 文件的 PowerShell 命令：

对于文本文件的完整路径目录列表（文件夹和文件）：

```
ls -r | % { $_.FullName + $(if($_.PsIsContainer){'\'}) } > filelist.txt 
```

对于文本文件的相对路径目录列表（文件夹和文件）：

```
ls -r | % { $_.FullName.substring($pwd.Path.length+1) + $(if($_.PsIsContainer){'\'}) } > filelist.txt 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-11-16T02:17:20.513

不是powershell，但您可以在命令提示符下使用以下命令将文件递归地列出到文本文件中：

```
dir *.* /s /b /a:-d > filelist.txt 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-01T21:33:12.847

```
(ls $path -r).FullName | % {if((get-item "$_").psiscontainer){"$_\"}else{$_}} 
```

仅在 PS 3.0 中使用

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-12-08T03:01:36.460

您可以通过 PowerShell 中的 get-childitem 命令实现此目的。请参考以下语法：

**Get-ChildItem "*文件夹名称或路径*" -Recurse | 选择全名 > list.txt**

这将帮助您将所有普通文件和文件夹名称递归地写入一个名为 list.txt 的文件中。有关详细信息，请参阅此内容。[https://ss64.com/ps/get-childitem.html](https://ss64.com/ps/get-childitem.html)

回答晚了，但它可能会帮助别人！

# html - 使用 perl 正则表达式的混合结果，匹配 html 代码中的短语列表

> ID：15165298
> 
> 赞同：0
> 
> 时间：2013-03-01T19:24:14.303
> 
> 标签：html, regex, phrases

正则表达式的混合结果，匹配 html 代码中的短语列表

这篇新帖子是对另一篇帖子的回应，[Perl Regex match lines that contains multiple words](https://stackoverflow.com/questions/4757099/perl-regex-match-lines-that-contain-multiple-words/15163602#15163602)，但由于我不知道的原因被版主删除了。在原始线程中问这个问题对我来说似乎是合乎逻辑的，因为它与尝试使用该线程早期给出的解决方案以及它的问题有关。有一个对[faq](https://stackoverflow.com/faq)的通用引用，它似乎没有显示任何差异，以及消息，“如果您有问题，请发布您自己的问题。” 因此这篇文章。

我正在使用 LWP::Simple 获取网页，然后尝试匹配包含某些短语的行。我在上述线程中的[答案#1](https://stackoverflow.com/questions/4757099/perl-regex-match-lines-that-contain-multiple-words/4757135#4757135)中复制了正则表达式，并替换/添加了我需要匹配的单词，但是我得到的结果与两个相似但不同的网页混合在一起。

我正在使用的正则表达式是：

```
/^(?=.*?\bYear\b)(?=.*?\bNew Moon\b)(?=.*?\bFirst Quarter\b)(?=.*?\bFull Moon\b)(?=.*?\bLast Quarter\b).*$/gim 
```

对于网站#1，它有包含这些单词的裸行，在一系列由`<pre>..</pre>`标签包围的块中，它匹配所有与该行完全相同的行，如预期的那样：

```
 Year        New Moon       First Quarter       Full Moon       Last Quarter 
```

但是对于网站#2，它的单词周围有令人讨厌的小标签：

```
<br><br><span class="prehead"> Year      New Moon       First Quarter       Full Moon       Last Quarter          &#916;T</span><br> 
```

它匹配每一行！

我确定`<span>`标签是执行此操作的“正确”方式，但我想知道如何绕过这些标签，以便我可以为两个站点只使用一个正则表达式。有没有一种简单的方法可以做到这一点，还是我必须学习如何解析 html（我不想这样做）？

我正在寻找一种快速的解决方案，而不是一个强大的解决方案。这可能是一次性的交易。如果这些相对静态的页面发生变化，它可能会很小并且很容易修复。请不要向我介绍所有“反正则表达式换html”页面。我见过他们。请不要让我使用 HTML::TreeBuilder。哦拜托...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:31:59.493

如果我的假设是正确的，您只想匹配特定的单词序列：

```
Year        New Moon       First Quarter       Full Moon       Last Quarter 
```

无论末端的标签如何，都有自由间距。

我们可以使用它来匹配两端任何格式正确的开始和结束标签

```
<[^>]*?> 
```

这意味着，任何介于开头“<”和第一个结尾“>”之间的字符串，

接下来我们要确保我们允许这些标签之间有空格，所以我们使用空格指示符“\s*”来表示两端的零个或多个空格：

```
\s*<[^>]*?>\s* 
```

接下来，我们要将其分组到一个非捕获（为了提高效率）组中，并让它重复零次或多次。这是我们将放在正则表达式两端以确保标签匹配的内容：

```
(?:\s*<[^>]*?>\s*)* 
```

然后我们将使用短语之间的“\s*”填写所需的文本，以确保它们之间有空格并且只允许空格：

```
(?:\s*<[^>]*?>\s*)*\s*Year\s*New Moon\s*First Quarter\s*Full Moon\s*Last Quarter\s*(?:\s*<[^>]*?>\s*)* 
```

然后用线开始和结束线标记结束

```
/^(?:\s*<[^>]*?>\s*)*\s*Year\s*New Moon\s*First Quarter\s*Full Moon\s*Last Quarter\s*(?:\s*<[^>]*?>\s*)*$/gim 
```

这应该匹配在所需短语的任一端包含任意数量标签的任何行，但如果有其他内容（例如附加字符）则不匹配。它也应该非常有效，因为它不使用任何环视。如果我误解了这个问题，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T06:32:35.100

通过直接遍历检索到的 html 文档，我终于使用原始正则表达式为两个 url 工作：

```
for my $line (split qr/\R/, $doc)
{
    next unless $line =~ /^(?=.*?\bYear\b)(?=.*?\bNew Moon\b)(?=.*?\bFirst Quarter\b)(?=.*?\bFull Moon\b)(?=.*?\bLast Quarter\b).*$/gim; # original
    print "$line\n";
} 
```

真的不应该这么难。;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T16:39:44.933

@杰克：

嘿，非常感谢。你就是我要找的人。我试过了，它适用于第一个 url，但没有输出第二个。

使用我原来的正则表达式，我还尝试使用 HTML::TreeBuilder 剥离 html 标签：

```
my $tree = HTML::TreeBuilder->new;
$tree->parse_file($doc);
my $non_html = $tree->as_text();
open FILE, "<", \$non_html or die "can't open $non_html: $!\n"; 
```

两个网址都没有结果。

我试过 HTML::Strip：

```
my $hs = HTML::Strip->new();
my $clean_text = $hs->parse($doc);
$hs->eof;
open FILE, "<", \$clean_text or die "can't open $clean_text: $!\n"; 
```

与原始结果相同 - 第一个 url 按预期工作，第二个输出所有（剥离）行。也许我的代码在这里有问题。我不知道。

这是我的脚本的本质（运行）：

```
use strict;
use warnings;
use LWP::Simple;

my $url = 'http://eclipse.gsfc.nasa.gov/phase/phases2001.html';
#my $url = 'http://www.astropixels.com/ephemeris/moon/phases2001gmt.html';
my $doc = get $url;
die "Couldn't get $url" unless defined $doc;
open FILE, "<", \$doc or die "can't open $doc: $!\n";

while(my $line = <FILE>)
{
    #next unless $line =~ /^(?=.*?\bYear\b)(?=.*?\bNew Moon\b)(?=.*?\bFirst Quarter\b)(?=.*?\bFull Moon\b)(?=.*?\bLast Quarter\b).*$/gim; # original
    next unless $line =~ /^(?:\s*<[^>]*?>\s*)*\s*Year\s*New Moon\s*First Quarter\s*Full Moon\s*Last Quarter\s*(?:\s*<[^>]*?>\s*)*$/gim; # Jake's
    print "$line";
} 
```

# c++ - 编译一个静态二进制文件，其中代码有一个函数 gethostbyname

> ID：15165306
> 
> 赞同：27
> 
> 时间：2013-03-01T19:24:54.517
> 
> 标签：c++, c, linux, gcc, gethostbyname

如何解决编译包含函数 gethostbyname 的代码的静态二进制文件，如果在没有警告的情况下编译，如下所示：

> 警告：在静态链接的应用程序中使用“gethostbyname”需要在运行时使用 glibc 版本中用于链接的共享库

我使用命令在 ubuntu 12.04 上编译：

```
$ gcc -static lookup.c -o lookup 
```

这是lookup.c的代码：

```
 /* lookup.c */

  #include <stdio.h>
  #include <unistd.h>
  #include <stdlib.h>
  #include <string.h>
  #include <errno.h>
  #include <sys/socket.h>
  #include <netinet/in.h>
  #include <arpa/inet.h>
  #include <netdb.h>

  extern int h_errno;

  int main(int argc,char **argv) {
     int x, x2;
     struct hostent *hp;

     for ( x=1; x<argc; ++x ) {
        hp = gethostbyname(argv[x]);
        if ( !hp ) {
           fprintf(stderr,
                   "%s: host '%s'\n",
                   hstrerror(h_errno),
                   argv[x]);
           continue;
        }

        printf("Host %s : \n" ,argv[x]);
        printf(" Officially:\t%s\n", hp->h_name);
        fputs(" Aliases:\t",stdout);
        for ( x2=0; hp->h_aliases[x2]; ++x2 ) {
           if ( x2 ) {
              fputs(", ",stdout);
             }
        fputs(hp->h_aliases[x2],stdout);
        }     
        fputc('\n',stdout);
        printf(" Type:\t\t%s\n",
               hp->h_addrtype == AF_INET
               ? "AF_INET" : "AF_INET6");
        if ( hp->h_addrtype == AF_INET ) {
           for ( x2=0; hp->h_addr_list[x2]; ++x2 ) {
              printf(" Address:\t%s\n",
                     inet_ntoa( *(struct in_addr *)
                      hp->h_addr_list[x2]));
           }
        }
     putchar('\n');
     }
     return 0;
  } 
```

我想如果我检查通过`$ file lookup`会得到这样的输出：

> 查找：ELF 32 位 LSB 可执行文件，Intel 80386，版本 1 (GNU/Linux)，静态链接，适用于 GNU/Linux 2.6.24，BuildID[sha1]=0x6fcb2684ad8e5e842036936abb50911cdde47c73，未剥离

不像这样：

> 查找：ELF 32 位 LSB 可执行文件，Intel 80386，版本 1 (SYSV)，动态链接（使用共享库），适用于 GNU/Linux 2.6.24，BuildID[sha1]=0xf9f18671751927bea80de676d207664abfdcf5dc，未剥离

如果你评论了建议我必须使用无静态，因为我知道的每个 linux 都有不同的 libc，我希望你不需要评论。为什么我坚持静态？因为我需要强制使用静态，所以二进制文件必须是静态的而不是动态的。

我有两个多星期的时间来寻找这个，但到目前为止还没有成功。

感谢您帮助我解决我的严重问题。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-03-01T19:33:01.057

你所要求的将是非常困难的。

请参阅[有关 getaddrinfo 的 StackOverflow 问题](https://stackoverflow.com/questions/2725255/create-statically-linked-binary-that-uses-getaddrinfo)。基本上，`getaddrinfo`/下面`gethostbyname`是 glibc 的 NSS 层。这允许系统管理员说“使用 DNS 将主机名解析为 IP 地址”，或“使用 LDAP”，或“不要使用任何其他东西`/etc/hosts`”。此控件在运行时；系统管理员可以随时更改主机名解析为 IP 的方式。

由于这种灵活性，glibc 中的所有名称解析调用都使用辅助库（基本上是插件）来完成繁琐的解析工作。有一个用于 LDAP 寻址的共享库，一个用于文件，一个用于 DNS，一个用于 YP，等等。

如果您希望您的程序 100% 静态链接，您将不得不去其他地方（不是`gethostbyname`）将主机名转换为 IP 地址。您可以使用像[uDNS](http://www.corpit.ru/mjt/udns.html)这样的解析器库（不是这个确切的库 - 有类似的工具可用）来做到这一点，但您应该记住，**您的二进制文件不会在配置为不使用 DNS 的系统上做正确的事情**！

相反，我建议只让程序（技术上）动态链接。如果您真的想确保它可以在任何平台上运行，您甚至可以`glibc`附带二进制文件——尽管这样做需要符合 LGPL。保留这个动态链接仅意味着您不会在`glibc`版本错误的系统上工作 - 不是一个巨大的兼容性问题。

说到许可证合规性，值得注意的是，如果您静态链接`glibc`，您很可能必须为您的*整个应用程序*提供源代码以符合`glibc`LGPL 许可证。我不是律师，这不是合格的法律建议，但阅读 LGPL 可以清楚地表明，静态链接的应用程序`glibc`必须是开源的。请参阅[有关该主题的 StackOverflow 问题](https://stackoverflow.com/questions/11693320/linking-glibc-statically-and-propreitary-software-licensing)。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2014-02-18T15:22:32.243

我得到了同样的警告，为了修复它，我重新编译了 glibc。配置时打开开关`--enable-static-nss`以使其工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-26T02:01:10.103

我有2个答案-

1.  保持程序的主要部分静态链接，并分离出一个函数程序来调用 gethostbyname()。允许后者动态链接。使用 fork 然后 exec 执行这个单独的程序来获取域名的地址。您可以使用 system() 而不是 fork then exec，尽管它需要更长的时间（整毫秒），这不应该引起关注，因为无论如何您都是在互联网上搜索名称服务器，这需要一些时间。

2.  编写源代码来做DNS，就像我做的那样。将其编译为存档 (.a) 并在静态链接中进行搜索。

# ruby-on-rails - Rails：单个项目的多个树

> ID：15165309
> 
> 赞同：2
> 
> 时间：2013-03-01T19:25:05.340
> 
> 标签：ruby-on-rails, tree, hierarchy, nested-sets

我想对多棵树中的对象进行分类以反映它们的特征并在其上建立导航。

因此，给定以下树：

```
Category1
-Category-1-1
-Category-1-2

Category2
-Category-2-1
-Category-2-2
--Category-2-2-1 
```

一个对象可以例如属于Category-1-2 和Category-2-2-1。

目标是能够从数据库中获取所有对象

*   属于某个类别的
*   属于某个类别或其后代的

一个更实际的例子：

一个类别可能具有“工具 > 园艺工具 > 刀具”的层次结构。

第二类：“硬物 > 金属物 > 小金属物”

对象“Pruners”将被归类为“Cutters”以及“Small metal objects”。

我希望能够

*   检索所有“园艺工具”->“修枝剪”
*   检索“园艺工具”->“刀具”的所有类别子项
*   检索所有“硬对象”->“修剪器”
*   检索所有也是“切割器”->“修枝器”的“硬物”
*   检索所有也是“刀具”的“软对象”-> [] 任何指针？我已经简要地查看了closure_tree、awesome_nested_sets 等，但我不确定它们是否合适。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T13:49:43.670

*请注意，这里的代码都是伪代码。*

我将使用[祖先](https://github.com/stefankroes/ancestry)gem，并使用三个模型类对您的数据进行建模。这样你的数据就被标准化了，这是一个很好的基础。

```
Category - ancestry tree
  has_may Memberships
  has_may Products through Memberships

Membership
  belongs_to Category
  belongs_to Products

Products
  has_may Memberships
  has_may Categories through Memberships 
```

从那里开始，您需要弄清楚如何有效地执行查询。我这样做的方法是了解如何使用 SQL 来完成，然后弄清楚如何使用 activercord 的 DSL 来表达查询。

一些资源：

*   [http://railsantipatterns.com/](https://github.com/stefankroes/ancestry)这本书有一些复杂的 SQL 查询示例，这些示例变成了可重用的作用域和助手
*   [http://guides.rubyonrails.org/active_record_querying.html#joining-tables](https://github.com/stefankroes/ancestry) Rails 的文档，请参阅连接和包含部分
*   [http://stackoverflow.com/questions/38549/difference-between-inner-and-outer-join](https://github.com/stefankroes/ancestry)很好的解释 SQL 连接

查询示例：

找到一个类别。

`Category.find(category_id)`

找到一个类别并将其产品包含在指定的类别中。

`Category.find(category_id).join(:memberships => :products)`

查找类别的子树 ind 包括产品

`Category.subtree_of(category_id).join(:memberships => :products)`

查找产品所属的所有类别。

`Product.find(product_id).categories`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T03:09:58.823

我只是这样做了，我选择不使用祖先，而是使用[closure_tree](https://github.com/mceachen/closure_tree)，因为作者说它更快，我同意他的观点。知道您需要在类别（每当我将多个添加到单个对象时，我喜欢调用标签）和对象之间有一个“has_and_belongs_to_many”。

现在发现者，坏消息是，如果没有您自己的自定义查询，您可能无法使用它来完成。使用 gems 方法，您将执行以下操作：

```
Item.joins(:tags).where(tags: {id: self_and_descendant_ids }) 
```

代码是干净的，它执行两个查询，一个用于descendant_ids，另一个用于Objects。这一点的细微变化，应该给你除了最后一个之外你所需要的一切。那个很难，我还没有实施（我正在处理中）。

现在，您必须同时调用`tag.self_and_ancestor_ids`（查询计数：2）、这些标签中的所有项目（查询计数：4）和相交。在此之后，需要进行一些认真的重构。我认为我们需要编写 SQL 来减少查询次数，我认为 Rails 查询接口还不够。

我选择 *closure_tree* 的另一个原因是使用 parent_id，所有兄弟姐妹共享它（就像任何其他 Rails 关联一样），因此它更容易与其他 gem 交互（例如 RankedModel 排序）。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-08T12:54:18.010

我认为您可以选择其中一颗树宝石，我个人喜欢[Ancestry](https://github.com/stefankroes/ancestry)。然后为每个类别建立一个关联有许多对象，每个对象可以属于许多类别。

您是否已经偶然发现任何问题，或者您只是在研究您的选择？

# performance - 如果是 Chrome，请使用 WebP

> ID：15165311
> 
> 赞同：3
> 
> 时间：2013-03-01T19:25:22.797
> 
> 标签：performance, google-chrome, optimization, opera, webp

因为目前只有 Chrome 和 Opera 支持 WebP，我想知道是否可以针对这两个特定浏览器并将它们重定向以获取我网站的另一个版本，以便我可以帮助优化我的网站下载速度更快？

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-15T21:29:18.420

我这样解决了这个问题：

*   检查客户端是否在 Accept 标头中宣传“image/webp”
*   如果支持 WebP，请检查本地 WebP 文件是否在磁盘上，并提供它
*   如果服务器配置为代理，则附加一个“WebP：true”标头并转发到后端
*   如果提供了 WebP 资产，则附加“Vary: Accept”

在 Nginx 中：

```
location / {
    if ($http_accept ~* "webp") { set $webp "true"; }
    # Use $webp variable to add correct image. 
} 
```

就我而言，我使用拇指软件来转换图像。 [https://github.com/globocom/thumbor](https://github.com/globocom/thumbor)

```
pip install thumbor 
```

我的自信：

```
upstream thumbor  {
    server 127.0.0.1:9990;
    server 127.0.0.1:9991;
    server 127.0.0.1:9992;
    server 127.0.0.1:9993;
    server 127.0.0.1:9994;
}
location / {
    if ($http_accept ~* "webp") {
        set $webp "T";
    }
    if ($uri ~* "(jpg|jpeg)$") {
         set $webp "${webp}T";
    }
    proxy_cache_key $host$request_uri$webp;

    if ($webp = "TT") {
        rewrite ^(.*)$ "/unsafe/smart/filters:format(webp)/exemple.com$uri" break;
        proxy_pass http://thumbor;
        add_header Content-Disposition "inline; filename=image.webp";
    }
    if ($webp != "TT") {
        proxy_pass http://exemple.com;
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-07-20T00:58:39.367

有一段时间，thumbor 支持自动 webp 转换：

[https://github.com/thumbor/thumbor/wiki/Configuration#auto_webp](https://github.com/thumbor/thumbor/wiki/Configuration#auto_webp)

您仍然需要配置负载均衡器以传递 webp 接受标头，但除此之外，thumbor 将为您处理所有事情。

希望有帮助！

# visual-studio-2010 - ISDEV 致命错误 6032 内部构建错误

> ID：15165313
> 
> 赞同：0
> 
> 时间：2013-03-01T19:25:32.113
> 
> 标签：visual-studio-2010, ant, windows-xp, installshield

我正在使用 IS2008、Windows XP 和 VS2010。直到两周前一切都还好，但发生了一些事情，一切都改变了。

我最近遇到了“ISDEV 致命错误 6032 内部构建错误”错误。我已经检查了所有网站，但我无法得到有关此问题的任何答案。我不知道为什么会发生这种情况，我以为我的 InstallShield 已经过期，但是在 IS 执行时我没有收到任何警告消息。

我在上面发送日志，

```
 [exec] Embedding manifest SetupExe.Invoker.manifest into setup.exe
 [exec] **ISDEV : fatal error -6032: Internal build error**
 [exec] Installers\Release 2 - 1 error(s), 0 warning(s)
 [exec] Log file has been created: <file:D:\OutpuT\EnterpriseClient\Release\Installers\Release 2\LogFiles\3-1-2013 10-32-00 AM.txt> 
```

====== 这是 CMD 错误信息：

```
 [exec] Result: -1073741819
 [exec] Result: 1

BUILD FAILED
D:\...\build.xml:26: Following error occured while executing this line
D:\...\build.xml:56: Following error occured while executing this line
D:\...\InstallShield\build.xml:39: Following error occured while executing this line
D:\...\InstallShield\...\build.xml:7: Following error occured while executing this line
D:\...\InstallShield\...\build.xml:107: Following error occured while executing this line
D:\...\InstallShield\...\build.xml:704: Following error occured while executing this line
D:\...\InstallShield\...\build.xml:792: Warning: Could not find file D:\...\OutpuT\EnterpriseClient\Release\Installers\Release 2\DiskImages\DISK1\1028.mst to copy.

Total time: 244 minutes 43 seconds
cmake.pl failed with error : 1 
```

如果有人可以分享解决方案，我会很高兴。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-29T13:28:51.450

问题已经解决了，

我在我的代码或环境中找不到任何问题，然后我决定停用我们的防病毒程序（趋势微）。我认为趋势并没有让我进入一些路径。

幸运的是一切看起来都很好。

# ruby-on-rails - ActiveRecord 在具有特定值的记录之后找到具有值的第一条记录

> ID：15165314
> 
> 赞同：0
> 
> 时间：2013-03-01T19:25:34.527
> 
> 标签：ruby-on-rails, activerecord, stored-procedures

我有一个模型，比如说`Model`，它有一个名为 的列`state`，四种可能的状态是`A`、`B`、`C`和`D`。

是否可以（使用 ActiveRecord）在`Model`类中编写一个方法，该方法包含一个查询，该查询查找最近出现的记录的`created_at`时间，该`B`记录的时间前面有一个`A`（中间可以有其他`C`记录`D`）。如果表中没有`A`'，则返回最早出现的`B`。

表的默认范围是`created_at DESC`，因此调用`Model.first`将是表中的最新记录。

目前，这是我的方法：

```
 class Model < ActiveRecord::Base       

      def self.getLatestBTime
         latestA = self.where("state = ?", "A").first # Record of most recent "A"
         while 1
           if !latestA.nil?
             nextB = self.where("state = ? AND created_at > ?", "B", latestA.created_at).last # Record of the first "B" after the most recent "A"
             return nextB.created_at if !nextB.nil?
           else
             break
           end
           latestA = self.where("state = ? AND created_at < ?", "A", latestA.created_at).first
         end # End while

         firstB = self.where("state = ?", "B").first
         if !firstB.nil?
           return firstB.created_at
         else
           return nil
         end
      end

    end 
```

但我试图找到一种对 ActiveRecord 的“一体化”查询方式，因此我将尽可能多的工作卸载到数据库而不是应用程序。有什么建议么？

此外，还没有选择部署数据库，它可以是最有意义的（当前部署到 Heroku，所以 PostgresQL 是当前用于生产测试的），但我真的很想远离存储过程以及其他将移除 ActiveRecord 提供的抽象层的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:45:24.587

不幸的是，您没有用代码编写您真正想要实现的目标。据我了解，您可能正在寻找状态机。运气好的话，您需要的一切都是使用诸如[https://github.com/pluginaweek/state_machine之类的 gem](https://github.com/pluginaweek/state_machine)

# c# - `1 在 LINQ 中代表什么？

> ID：15165316
> 
> 赞同：3
> 
> 时间：2013-03-01T19:25:36.507
> 
> 标签：c#, .net, linq

在使用 LINQ 时，我遇到了一个异常，它``1`以一些表达式显示。

例如在 stacktrace 中，我得到如下声明：

```
System.Linq.Table`1.Enumerable(); 
```

在一些匿名声明中，我也遇到了同样的情况。我的一个后辈问我这个问题，但我无法给他满意的答案。所以我需要知道。代表什么``1`？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-01T19:29:19.140

C# 将泛型类型标记为

```
System.Linq.Table<T> 
```

VB 将它们记为

```
System.Linq.Table(Of T) 
```

在类型对象上调用 ToString 既不会产生 C# 也不会产生 VB 语法；它产生：

```
System.Linq.Table`1 
```

其中 1 表示类型参数的数量。

在 C# 中，类型如下：

```
Foo<T>.Bar<U> 
```

会产生字符串

```
Foo`1+Bar`1 
```

# windows-phone-7 - 在 Windows Phone 7 的文本文件中写入和读取文本

> ID：15165320
> 
> 赞同：0
> 
> 时间：2013-03-01T19:25:46.937
> 
> 标签：windows-phone-7, text-files

如何在 windows phone 7 的文本文件中写入和读取文本？我尝试使用独立存储，但独立存储会创建一个目录和一个其他人看不到的文件，这将以编程方式完成，但我想写入和读取我在 bin/debug 文件夹中创建的文本文件。 .

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T19:32:13.263

使用独立存储是一个更好的主意。[本博客](http://blogs.msdn.com/b/wriju/archive/2011/07/31/windows-phone-7-how-save-and-read-file-from-isolated-storage.aspx)将帮助您使用独立存储读取数据并将数据保存到独立存储中的文本文件，这更简单、更安全。

# ruby-on-rails - 如何使用简单表单 gem 中的 collection_radio_buttons 获得空白单选按钮选项？

> ID：15165326
> 
> 赞同：0
> 
> 时间：2013-03-01T19:26:09.677
> 
> 标签：ruby-on-rails, radio-button, simple-form

我在使用简单形式 gem 的 rails 视图中有这段代码：

```
<%= simple_form_for :beta_signup, :url => url_for(:action => 'update', :controller => 'survey'), :html => { :id => 'info-form' } do |beta_signup| %>
<%=   beta_signup.collection_radio_buttons :this_excited, [[0,'Not really excited at all'], [1,''], [2, ''], [3, ''], [4, 'Super Excited!!']], :first, :last, :checked => 2, required: false %>
<% end %> 
```

而不是为中间单选按钮显示空白，而是显示“这个兴奋 1”、“这个兴奋 2”、“这个兴奋 3”。有没有办法让中间的 3 个单选按钮不显示标签？

输入 " " 不起作用（显示“这个兴奋的 1”），并且 " " 和 "\t" 不起作用（分别显示 " " 和 "\t"）。

# asp.net - 将焦点设置到 UpdatePanel 中的文本框

> ID：15165327
> 
> 赞同：0
> 
> 时间：2013-03-01T19:26:19.610
> 
> 标签：asp.net, focus, updatepanel

我在 UpdatePanel 中有四个文本框，并且所有文本框的 AutoPostBack 都设置为 True。当用户输入一个值并按 Enter 键时，我希望光标自动移动到下一个文本框。当我在 UpdatePanel 中没有控件时，标准的 textbox.focus 方法可以正常工作。

[我在这里](https://stackoverflow.com/questions/3855047/set-always-focus-on-textbox-asp-net-updatepanel)找到了一些代码，导致我创建了这个：

```
 Protected Sub txtField_TextChanged(ByVal sender As Object, ByVal e As EventArgs) Handles txtField1.TextChanged,
    txtField2.TextChanged, txtField3.TextChanged
    'Based on the textbox where data was changed, move the cursor to the next field.

    Try
        Dim sm As ScriptManager = ScriptManager.GetCurrent(Me)

        'As multiple textboxes fire this same event, determine which textbox triggered this.
        Dim MyTextbox As TextBox = TryCast(sender, TextBox)

        Select Case MyTextbox.ID.ToString
            Case "txtField1"
                sm.SetFocus(txtField2)
            Case "txtField2"
                sm.SetFocus(txtField3)
            Case "txtField3"
                sm.SetFocus(txtField4)
        End Select

    Catch ex As Exception
        lblError.Text = "Error in [txtField_TextChanged]: " & ex.Message
    End Try

End Sub 
```

真正奇怪的是，这在我首先**尝试**的任何领域都有效。之后，事件被触发，但焦点没有改变。后续通话我还需要做些什么吗？

我将不胜感激任何建议。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-03T19:20:39.200

尝试设置to的`EnablePartialRendering`属性，如下所示：`ScriptManager``false`

```
<asp:ScriptManager ID="ScriptManager1" runat="server" EnablePartialRendering="false"></asp:ScriptManager> 
```

我希望这有帮助！祝你好运，编码愉快:)

# android - TimePickerDialog.onTimeSetListener 未调用

> ID：15165328
> 
> 赞同：7
> 
> 时间：2013-03-01T19:26:28.053
> 
> 标签：android

我正在使用以下代码来显示`TimePickerDialog`：

```
TimePickerDialog dialog = new TimePickerDialog(this, new OnTimeSetListener() {

        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minute) {
            System.out.println("onTimeSet");
        }
    }, 20, 15, true);
    dialog.setTitle("Test");
    dialog.setButton(TimePickerDialog.BUTTON_POSITIVE, "Done", new OnClickListener() {

        @Override
        public void onClick(DialogInterface dialog, int which) {
            System.out.println("Done");
        }
    });
    dialog.setButton(TimePickerDialog.BUTTON_NEGATIVE, "Cancel", new OnClickListener() {

        @Override
        public void onClick(DialogInterface dialog, int which) {
            System.out.println("Cancel");
        }
    });
    dialog.show(); 
```

在运行 Android 2.3.7 的设备上，`onTimeSet`不会调用该方法（该`onClick`方法会调用）。在运行 4.2.2 的设备上，`onTimeSet`它确实会被调用。

这里发生了什么？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-03T17:05:54.033

TimePickerDialog 在 Android 4.1.1 之后发生了变化，并且存在关于取消 TimePickerDialog 和 DatePickerDialog 的错误。请先[在这里](https://stackoverflow.com/questions/11444238/jelly-bean-datepickerdialog-is-there-a-way-to-cancel)阅读。默认情况下不需要设置正负按钮。TimePickerDialog 和 DatePickerDialog 为您处理这些。因此，如果此取消问题对您不重要，请删除正负按钮的设置。如果您在用户单击“确定”按钮的情况下删除这两个版本中的那些，您的 onTimeSet 方法将被调用。

但我建议在修复该错误之前，使用带有 TimePicker 小部件的定制 AlertDialog；

```
 final TimePicker timePicker = new TimePicker(this);
    timePicker.setIs24HourView(true);
    timePicker.setCurrentHour(20);
    timePicker.setCurrentMinute(15);

    new AlertDialog.Builder(this)
            .setTitle("Test")
            .setPositiveButton(android.R.string.ok, new OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {
                    Log.d("Picker", timePicker.getCurrentHour() + ":"
                            + timePicker.getCurrentMinute());
                }
            })
            .setNegativeButton(android.R.string.cancel,
                    new OnClickListener() {

                        @Override
                        public void onClick(DialogInterface dialog,
                                int which) {
                            Log.d("Picker", "Cancelled!");
                        }
                    }).setView(timePicker).show(); 
```

# c++ - 制作一个复制构造函数，对输入对象进行深度复制（使用数组）

> ID：15165331
> 
> 赞同：0
> 
> 时间：2013-03-01T19:26:37.800
> 
> 标签：c++, copy-constructor

我需要使用复制构造函数对输入对象进行深层复制。我非常卡住...

到目前为止我的代码：

```
class stringCS   
{   
public:    
     stringCS();
     stringCS(const stringCS &other);

private:
     char *input;
};

stringCS::stringCS(const stringCS &other)
{
} 
```

如何制作深拷贝？我知道我需要使用 for 循环来遍历数组中的所有字符，以将其复制到另一个数组中，最后使用空终止符，但我不了解参数或原始数组的来源。

编辑：

我绝不是在找人给我代码。我正在寻找更多类似于我的问题的伪代码/答案的东西。我不知道如何开始复制，因为我不了解参数。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:36:57.047

这应该做的工作：

```
class stringCS   
{
private:
    string input;
public:    
    stringCS(const string& other) : input(other)
    {
    }
}; 
```

如果你需要使用 cstrings 这个骨架可能会让你走上正轨

```
class stringCS   
{
public:    
    stringCS();
    stringCS(const stringCS &other);
    {
        // a) input is a pointer, allocate enough memory
        // you will need to know the size of other (strlen() + 1)
        ...

        // b) copy character by character from `other.input` to `input` in a loop
        // do not forget the final '\0'
        ...
    }
private:
    char *input;
}; 
```

# svg - 从 js 编写时忽略 SVG 视图框

> ID：15165332
> 
> 赞同：3
> 
> 时间：2013-03-01T19:26:42.880
> 
> 标签：svg, d3.js

我正在使用使用视图框的 d3.js 创建 SVG。

从 JS 中，视图框被忽略，如此[处所示](http://jsfiddle.net/yxhcU/1/)。但是，如果我将 JS 生成的代码作为 HTML 放入，它会使用视图框呈现，如此[处所示](http://jsfiddle.net/8qeHZ/)。

为什么在js中定义时viewbox被忽略，而在html中定义时却没有？

代码如下

```
var svg = d3.select('body')
.append('svg')
  .attr("height", 400)
  .attr("width", 400)
  .attr("viewbox",'0,0,100,100')
  .attr('style','border: 1px solid black')
.append('rect')
  .attr('x',0)
  .attr('y',0)
  .attr('width',100)
  .attr('height',100)
  .attr('fill','red'); 
```

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-01T19:35:01.493

SVG 中的属性区分大小写。多字属性在 camelCase 中定义：

```
.attr("viewBox",'0,0,100,100') 
```

更多信息可以在[W3C 规范中找到](http://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T19:34:15.250

看起来原因是一个简单的错字 - 它应该是`viewBox`而不是`viewbox`。似乎（至少 Chrome）在页面加载时会自动更正此问题。

# eclipse-emf - 列出 EMF 应用程序中的所有可用模型

> ID：15165334
> 
> 赞同：0
> 
> 时间：2013-03-01T19:26:45.017
> 
> 标签：eclipse-emf, emf

我正在开发一个由两个 Eclipse 插件项目组成的项目。一个是 EMF 项目，包含应用程序的元模型。另一个是在该元模型上工作的实际插件。

我现在正在寻找一种方法来列出元模型项目中可用的所有模型类型。因为我基本上需要所有生成的类，所以我可以使用反射来遍历元模型包，但如果有的话，我更喜欢一种更简单的方法。

这些模型已经被列为扩展，`plugin.xml`如下所示：

```
<plugin>
    <extension point="org.eclipse.emf.ecore.generated_package">
        <package
            uri="MyModel"
            class="org.myproject.metamodel.MyModel.MyModelPackage"
            genModel="model/MetaModel.genmodel"/>
    </extension>
</plugin> 
```

类`MyModelPackage`扩展的地方`EPackage`，`org.myproject.metamodel.MyModel`还包含我需要列出的所有其他生成的类。我猜我可以使用该信息，但我仍然不知道如何使用。

**更新**

我正在从事的项目基于[EMFStore](http://eclipse.org/emfstore/)。运行它会提供 EMFStore 透视图。如果我有一个项目的导航器视图，我可以右键单击该项目并选择`New Model Element`. 这将打开一个对话框，其中列出了我的元模型中的所有模型元素，因此它是可能的。它必须在 EMFStore 或其依赖项之一中的某个地方完成。我查看了源代码，但似乎找不到它在哪里完成。

`plugin.xml`项目的是`org.eclipse.emf.emfstore.perspective`指`org.eclipse.emf.emfstore.emfperspective.EMFStorePerspective`我在源代码中找不到的类。我通过 Eclipse 导入插件和片段功能导入了项目，它没有源文件夹。在 EMFStore git 存储库中，我什至找不到该项目。

**更新**

我现在得到了包含使用生成的包的注册表`EPackage.Registry.INSTANCE`。不幸的是，它包含的不仅仅是来自包含元数据的一个项目的 EPackage ( `org.myproject.metamodel`)。现在我只是在寻找一种适当的方法来过滤它，但仍然无法掌握它。

**更新**

由于过滤不是我最初问题的一部分，我接受了@SpaceTrucker 的回答。对于那些好奇的人，这就是我现在的做法：

```
Registry registry = EPackage.Registry.INSTANCE;
for (String key : new HashSet<String>(registry.keySet())) {
    EPackage ePackage = registry.getEPackage(key);
    if (ePackage.getClass().getName().startsWith("org.myproject.metamodel")) {
         //do stuf
    }
} 
```

我找不到过滤项目的方法，但幸运的是所有包都以相同的前缀开头。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T14:22:39.720

EPackage 可以通过[EPackage.Registry](http://download.eclipse.org/modeling/emf/emf/javadoc/2.7.0/org/eclipse/emf/ecore/EPackage.Registry.html)注册。似乎可以通过[ECorePlugin.getDefaultRegistryImplementation()](http://download.eclipse.org/modeling/emf/emf/javadoc/2.7.0/org/eclipse/emf/ecore/plugin/EcorePlugin.html#getDefaultRegistryImplementation%28%29)获得一个全局使用的实例。但是，我对此不是 100% 确定的。

[MoDisco](http://www.eclipse.org/MoDisco)带有一个 EMF 模型浏览器，您还可以在其中选择任何已注册的 EMF 模型。所以你也可以看看这些来源。

# makefile - 图书馆链接

> ID：15165335
> 
> 赞同：3
> 
> 时间：2013-03-01T19:26:46.270
> 
> 标签：makefile

我正在尝试使用 Zed Shaw 的 Learn C 来学习 C 编程。我一直在研究 ex26，我们创建了一个用于安装软件的程序“devpkg”。此练习需要安装 Apache Portable Runtime 库。编写完本练习的代码后，我无法使用以下 makefile 编译程序：

```
 PREFIX?=/user/local
    CFLAGS=-g -Wall -I${PREFIX}/apr/include/apr-1 -I{PREFIX}/apr/include/apr-util-1
    LDFLAGS=-L${PREFIX}/apr/lib -lapr-1 -pthread -laprutil-1

    all: devpkg

    install: all
             install -d${DESTDIR}/${PREFIX}/bin/
             install devpkg ${DESTDIR}/${PREFIX}/bin/

    clean:
            rm -f *.o
            rm -f devpkg
            rm -f *.dSYM 
```

这个 makefile 似乎没有工作，因为当我使用“$make devpkg”时，并不是所有的 APR 库函数都被声明了。作为旁注，我在 Ubuntu 虚拟机上运行它。文中给出的解决方案是更改配置文件，然后“运行 ldconfig”以帮助链接器找到合适的库。
我不太了解 ldconfig 的手册页，无法正确使用该功能。如何正确运行 ldconfig？

此外，经过一番挖掘，我发现在 makefile 中使用“LDLIBS”而不是“LDFLAGS”解决了这个问题。我更改了makefile并编译了程序。

允许 C 编译器正确链接到 APR 库的“LDFLAGS”和“LDLIBS”有什么区别？是否有方便的命令列表可以帮助我更好地理解如何正确生成生成文件？

谢谢你的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-26T05:03:01.270

我只是想添加这个答案作为将“LDFLAGS”更改为“LDLIBS”的替代方法。上述解决方案在我的情况下确实有效，但在我看到其他人可能会觉得有用或有趣的这个线程之前，我找到了一个替代（虽然不太直接）的解决方案。编译时我看到很多“未定义的引用”错误，例如：

```
/MyCode/LCTHW/devpkg/devpkg.c:18: undefined reference to `apr_pool_initialize' 
```

经过多次试验和错误，我更改了makefile（仍然使用LDFLAGS）：

```
CC=gcc
PREFIX?=/usr/local
CFLAGS=-g   -Wall   -I$(PREFIX)/apr/include/apr-1   -I$(PREFIX)/apr/include/apr-util-1
LDFLAGS=-L$(PREFIX)/apr/lib -lapr-1 -laprutil-1 -pthread
OBJECTS=bstrlib.o   db.o    shell.o commands.o  devpkg.o

all:    devpkg

devpkg: $(OBJECTS)
    $(CC)   $(CFLAGS)   $(OBJECTS)  -o  devpkg  $(LDFLAGS)

install:    all
    install -d $(DESTDIR)/$(PREFIX)/bin/
    install devpkg $(DESTDIR)/$(PREFIX)/bin/

clean:
    rm -f *.o
    rm -f devpkg
    rm -rf *.dSYM 
```

然后我必须添加一个 .conf 文件到 /etc/ld.so.conf.d 包含 apr 库的路径，即

```
/usr/local/apr/lib 
```

然后运行

```
sudo ldconfig 
```

所以系统会选择新的 .conf 文件，因此知道在哪里可以找到库。根据我的阅读，这最后一步似乎是必要的，因为该库未存储在 /usr/local/lib 中。如果我删除 .conf 文件并重新运行 ldconfig 进行更新，程序会编译，但无法在运行时找到库（无论是使用我的 makefile 还是 OP 编译的）。

虽然我不完全理解我的解决方案，但它至少让我能够毫无错误地编译和运行程序。希望这个解决方案会引起其他人的兴趣，也许更有知识的人能够更详细地解释它为什么起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T19:42:22.843

来自[GNU Make Manual](http://www.gnu.org/software/make/manual/make.html)的**10.2 隐式规则目录**：

> *通过 C 编译器运行链接器（通常称为）来
> **`n`**自动*链接单个目标文件。*使用的精确配方是“ ”。**`n.o`****`ld`****`$(CC) $(LDFLAGS) n.o $(LOADLIBES) $(LDLIBS)`***

 *如您所见，`LDFLAGS`在您的目标文件之前和`LDLIBS`之后。有时该顺序可能很重要 - 显然在您的情况下确实如此。

编者注：虽然有时使用 make 的隐式规则支持可能很方便，但它几乎总是在以后变得更加混乱。我敦促您编写一个完整的 makefile - 它可以帮助您更好地了解正在发生的事情，并希望将来避免此类问题。*

# ruby-on-rails - 设备升级后无法登录

> ID：15165336
> 
> 赞同：3
> 
> 时间：2013-03-01T19:26:50.227
> 
> 标签：ruby-on-rails, ruby, devise

我尝试将我的设计 gem 从 2.1.2 升级到 2.1.3。升级后我无法登录。日志只向我显示 401 未经授权的消息，没有异常堆栈跟踪。

这是我使用的登录表单：

```
= form_for(resource, as: resource_name, url: session_path(resource_name)) do |f|
  .mail
    = f.label :email
    = f.email_field :email

  .pwd
    = f.label :password
    = f.password_field :password

  - if devise_mapping.rememberable?
    .remember
      = f.check_box :remember_me
      = f.label :remember_me

  .submit
    = f.submit t('login.submit') 
```

我也尝试升级到其他版本，但结果相同。从我的 application_controller 中删除protect_from_forgery 也没有帮助。目前我正在使用 Rails 3.2.12 和 Ruby 1.9.3-p194。

有人有想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-24T10:13:56.320

我在 Devise 也有过类似的经历。它通常归结为设计更改加密算法。

检查应用程序或设计配置文件中选择的加密类型。（bcrypt 或 sha 是这里的常见嫌疑人）

# json - 使用 Play 解析 JSON：为什么要以这种方式解析列表？

> ID：15165337
> 
> 赞同：3
> 
> 时间：2013-03-01T19:27:04.850
> 
> 标签：json, scala, playframework, playframework-2.0

这是我要处理的 JSON 列表：

```
scala> jsonStructure \ "response" \ "docs"
res4: play.api.libs.json.JsValue = [{"title":"the very first document"},{"title":"on brick walls"}] 
```

我尝试将其转换为一个列表，但我得到了一些具有不同语义的东西，一个列表，其唯一元素是该列表：

```
scala> jsonStructure \ "response" \\ "docs"
res3: Seq[play.api.libs.json.JsValue] = List([{"title":"the very first document"},{"title":"on brick walls"}])

scala> res3.size
res4: Int = 1 
```

我尝试了这个kludge，它可以解决问题：

```
scala> (jsonStructure \ "response" \ "docs").as[Seq[play.api.libs.json.JsValue]]
res9: Seq[play.api.libs.json.JsValue] = List({"title":"the very first document"}, {"title":"on brick walls"})

scala> res9 size
res10: Int = 2 
```

* * *

为什么没有`\\`工作？将 JsValue 理解为 JsArray 的惯用方法是什么？在保持“导航使用和\永不失败”的理念的同时？我想解析更深层次的结构，比如 obj 中的 obj 列表，它是一个列表元素；我想要一种对于深度嵌套结构不会变得笨拙的方法。

如果您发现它复杂、脆弱等，请随时纠正我的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-31T12:06:43.760

如果您只想要标题条目列表，您可能想要编写如下内容：

```
json \\ "title" 
```

返回：

```
List("the very first document", "on brick walls") 
```

通过`\\`列出与您的路径选择器匹配的任何元素（在当前级别和所有后代）来工作。由于本质上只有一个`docs`元素，因此它返回一个包含一个元素的列表。只有当您要求标题时，它才会返回标题列表。

但是从您的方法来看，您可能希望在 JsArray 上对 JsValue 进行模式匹配：

```
 def convert(json : JsValue) : Option[Seq[JsValue]] = json match {
    case JsArray(arr) => Some(arr)
    case _ => None
  } 
```

它完全返回您想要的：

```
List({"title":"the very first document"}, {"title":"on brick walls"}) 
```

# c# - 动画 Windows 应用商店应用程序-UI

> ID：15165338
> 
> 赞同：0
> 
> 时间：2013-03-01T19:27:09.953
> 
> 标签：c#, xaml, animation, windows-store-apps

我很难找出正确的方法来为我的 UI 设置动画。我知道我该如何做这两件事，但是我提出的所有解决方案都意味着很多（丑陋的）代码，并且必须有更好的方法。

什么是动画某些值的正确或最“干净”的方式，即绑定到属性。我的模型上有 Color 属性，它定义了元素的背景颜色。当颜色发生变化时，我希望它是平滑的，而不是突然的颜色变化。这可以在 xaml 中完成，这样模型就不必意识到这一点吗？

交叉渐变怎么样？目前，我通过将两个控件放在一起（在网格中）来实现这一点。当我开始更改时，我 1\. 将 element1 的可见性设置为可见 2\. 开始动画，将 element1 的不透明度从 0 更改为 1 3\. 开始动画，将 element2 的不透明度从 1 更改为 0 4\. 动画完成后，将 element2 的可见性设置为折叠（这样它就不会捕获所有鼠标事件）

哦，（MVVM）应用程序是用 C# 和 XAML 编写的，使用 WinRT-api

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-06T18:45:01.307

我意识到这已经很晚了，但是对于那些将来会看到这一点的人：

您应该查看 VisualStates 和 VisualTransitions。它们允许您确定要显示的状态（例如 Opacity 为 0 或 1），以及从一种状态转换到另一种状态时调用的动画。这非常简单，几乎可以完全在 XAML 中完成（调用除外`GoToState`）。不过，您可能想查看一些扩展，因为它们提供了诸如行为之类的东西，允许您触发诸如数据更改之类的状态。

[这里](http://msdn.microsoft.com/en-us/library/windows/apps/jj819808.aspx)有基本 VisualState/VisualTransision 的指南。

# windows-phone-7 - WP7 模拟器、Windows 8、英特尔 GPU 驱动程序

> ID：15165339
> 
> 赞同：1
> 
> 时间：2013-03-01T19:27:10.437
> 
> 标签：windows-phone-7, windows-8

在 Windows 8 x64 上的 WP7 模拟器上运行我的应用程序后，英特尔 GPU 驱动程序崩溃，系统事件日志中显示以下内容：“显示驱动程序 igfx 停止响应并已成功恢复”。它不会在我启动我的应用程序后立即发生，仅在几秒钟后发生。Windows 重置 GPU 并恢复后，模拟器屏幕保持黑色。

GPU 是 Intel HD 3000 内置第二代移动核心 i5 CPU。

在 Windows 7 x64 上一切正常，排除了硬件问题。

我已经尝试过升级 7 -> 8 和全新安装。我已经安装了 WP SDK 7.1.1、Visual Studio 2010 SP1、Windows Market Place Client、XNA Game Studio 4.0。

如何修复模拟器和/或英特尔 GPU 驱动程序和/或我的应用程序？

PS 我有另一个 nVidia 的 GPU。但是 nVidia 有一个预定义的设置 "Windows Phone 7 Emulator" ，所以我无法为模拟器切换图形处理器，该选项设置为 "Integrated graphics" 并变灰。当我使用一些实用程序来克服 nVidia 驱动程序中的该缺陷时，XDE.exe 在启动时开始崩溃，并显示“0xC0000005：访问冲突写入位置 0x00000000”。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:34:00.210

您是否检查了所有内容：磁盘/文件损坏、其他主要驱动程序、BIOS、低级芯片组驱动程序，甚至包括防病毒/反间谍软件/安全程序在内的启动程序/服务。

并在此处获取最新的驱动程序[Intel 驱动程序](http://downloadcenter.intel.com/default.aspx)

# haskell - 10位或更多位数字的加扰数字转换

> ID：15165340
> 
> 赞同：1
> 
> 时间：2013-03-01T19:27:12.217
> 
> 标签：haskell

这是一段非常简单的代码。它接受一个整数并使用商和余数分解其十进制数字。在每次调用时，它打印一行包含 r 个字符“I”，其中 r 是最后一个数字，然后使用商作为其新参数调用自身。

```
decToUnary 0 = return ()
decToUnary n = let (q, r) = quotRem n 10 in 
    do  
      putStrLn (take r "IIIIIIIIII")
      decToUnary q 
```

它适用于少于 10 位的数字，但对于 10 位或更多位的数字，它会打乱输出。我做错了什么，为什么会这样？以下是一些输出示例，第一个是正确的，第二个是错误的：

```
*Main> decToUnary 5432
II
III
IIII
IIIII

*Main> decToUnary 5432101234
IIIIIIII
III
IIIIIIIII
III
III
I
IIIIIII
III
I
I 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-01T19:37:12.087

这是一个整数溢出问题。`maxBound :: Int`是 2147483647（在 32 位机器上），所以值大于溢出。

使用`Integer`代替`Int`:`Integer`不是固定长度的整数，因此它不会溢出。

**编辑：**作为应用说明，您将需要`take r "IIIIIIIIII"`用`take (fromIntegral r) "IIIIIIIIII"`or替换`genericTake r "IIIIIIIIII"`; 我宁愿`genericReplicate r 'I'`.

[`genericTake`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html#v%3agenericTake)并且[`genericReplicate`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html#v%3agenericReplicate)都在 Data.List 中。

# c# - 使用 caliburn micro 和 autofac 填充初始视图模型数据

> ID：15165351
> 
> 赞同：1
> 
> 时间：2013-03-01T19:28:03.143
> 
> 标签：c#, wpf, mvvm, autofac, caliburn

我正在同时学习 Caliburn.Micro 和 Autofac。我正在编写一个简单的应用程序，这样我就可以自学如何正确使用这两种技术。

每次我认为自己到了某个地方时，我总是对如何为我的根视图模型初始化数据感到困惑。此视图模型需要注入一个“类别”视图模型列表。这个“类别”视图模型列表将在应用程序初始化期间加载。

那么，如何向 autofac 注册我的根“Navigator”视图模型并通知 autofac 在创建新实例时视图模型需要注入数据？

如果没有 caliburn 和 autofac，我只需创建自己的启动方法，加载我的数据，然后将其注入到我的视图模型中。使用 caliburn，我试图覆盖引导程序中的配置方法，因为这是我应该使用 ioc 容器注册我的类的地方。

我的根视图模型：

```
public class NavigatorViewModel : Conductor<IScreen>.Collection.OneActive
{
    public NavigatorViewModel(IEnumerable<CategoryViewModel> categories)
    {
        AddCategories(categories);
    }

    public void AddCategories(IEnumerable<CategoryViewModel> categories)
    {
        foreach (var category in categories)
        {
            if (Items.Contains(category))
                continue;
            Items.Add(category);
        }
        SetActiveItem();
    }

    private void SetActiveItem()
    {
        if (Items.Count < 1)
            return;
        ActiveItem = Items[0];
    }
} 
```

这是我使用 Autofac 注册 viewModel 的方式：

```
protected override void Configure()
{
    var builder = new ContainerBuilder();

    builder.RegisterType<CategoryViewModel>().AsSelf();
    builder.RegisterType<NavigatorViewModel>().AsSelf();
    ...
    container = builder.Build();
} 
```

在注册我的 NavigatorViewModel 时，我如何告诉 autofac 它也需要注入 CategoryViewModels 列表？

我猜我会在 caliburn 引导程序中加载我的数据，但我现在不确定如何将它全部连接起来。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T01:42:21.720

这看起来像是一个关于 AutoFac 而不是 MVVM 或 Caliburn.Micro 的问题，无论如何，据我所知 AutoFac 自动支持序列自动连线（IEnumberable），因此当它尝试解析您的 Navigator 时，它应该自行填充列表，但如果您需要为数据加载提供自定义工作，您可以这样做：

```
builder.RegisterType<NavigatorViewModel>()
.AsSelf()
.WithParameter(
(p, c) => true, 
(p, c) => new[] 
{ 
// Load your CategoryViewModels here or any other data that you would like
}); 
```

您可以查看有关该方法的[AutoFac 文档。](http://code.google.com/p/autofac/wiki/Autowiring)`WithParameter`

# html - CSS 背景不可点击 - a href="" 不起作用

> ID：15165352
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:28:05.000
> 
> 标签：html, css, hyperlink

我有以下代码生成一个徽标，该徽标显示在正确的位置，但`a href=""`为什么不起作用？

**HTML：**

```
<div class="banner">
    <span><a href="<?php echo BASE_URL()?>link" title="View information about award"></a></span>
</div> 
```

**CSS：**

```
div.banner{
            width:592px;
            height:1px;
            position: fixed;
            top:0;
            right:0;
            overflow: visible;
        }
        div.banner span{
            display: block;
            position: fixed;
            top: 0;
            right: 0;
            background: url(../../../i/ribbon.png) top right no-repeat;
            width: 197px;
            height: 145px;
            text-indent: -999em;
        }
        div.opens span a{
            display:block;
            width: 197px;
            height: 145px;
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:31:43.367

您的链接类应该是`div.banner span a`而不是`div.opens span a`. 因此，您的链接没有文本，因此没有宽度，因为 CSS 规则不适用。所以没有什么可以点击的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:34:34.050

可能你需要这样的东西

```
<div class="banner">
    <span>
          <a href="<?php echo BASE_URL().'/thisFile.html'; ?>" title="View information about award">
          This is the link to the file
          </a>
    </span>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:01:42.473

[jsfiddle 上的演示](http://jsfiddle.net/sheriffderek/ZygsF/)

我想，我不能告诉你为什么你的代码不能具体工作，但我看到了一些可能的事情......这就是我将如何处理它。如果您将整个横幅设置为链接，那么单击页面外 -999em 的一些文本会更容易吗？

您实际上并不需要定位包装器，但为了保持模块化，它可以帮助您在不同的上下文中一遍又一遍地使用这些横幅类。

如果我偏离了这个问题，请告诉我，我会试着转过头来。

HTML

```
<div class="fixed-wrapper">

    <a class="banner" href="#">

        Some words for robots and for assistive text ?          

        <span class="open">a different image I'm assuming?</span>

    </a> <!-- end .banner -->

</div> <!-- end .fixed-wrapper --> 
```

CSS

```
.fixed-wrapper {
    position: fixed;
    top: 0; right: 0;
}

.banner {
    position: relative;
    display: block;
    width:592px;
    height:145px;

    background-color: #f06;
}

.banner {
    text-indent: -999em;
}

.open {
    display:block;
    position: absolute;
    top: 0; right: 0;
    width: 197px;
    height: 145px;

    background-color: orange;
}

.banner:hover .open {    
    background-color: yellow;
}

/* i assume that your .open does something... */ 
```

[jsfiddle 上的演示](http://jsfiddle.net/sheriffderek/ZygsF/)

# image-processing - 用于计算输入图像帧的行数和列数的 Verilog 代码

> ID：15165353
> 
> 赞同：-2
> 
> 时间：2013-03-01T19:28:05.343
> 
> 标签：image-processing, verilog

我在使用 Verilog 模块时遇到问题，它是一个非常大的 CMOS 相机图像代码的一小部分。该模块将 clk 和 reset 作为输入并吐出 hsync、vsync、pixclk 和像素数据。代码读取图像和将其保存到内存中，然后执行一堆 if else 语句，例如：

```
if (row_count<NUM_ROWS-1) && (col_count< NUM_COLS) 
begin 
 vsync <=1; 
 hsync <=1 ;
 pixe_data <= mem[row_count*NUM_ROWS+col_count];
end
else if
 ...... 
```

到目前为止，图像尺寸是使用 NUM_COLS 和 NUM_ROWS 硬编码的，但我正在尝试更改它，以便代码即时计算传入图像的行和列。我曾尝试使用 $fscanf、$fgets、$Sscanf 等，但我没有得到正确的结果。事实上我根本没有得到任何结果。我的模拟卡住了，或者它说它的内存不足或 fd 是一个空文件描述符.此外，当我将 NUM_ROWS 和 NUM_COLS 转换为变量时，我收到一条错误消息，指出常量操作的操作数非法。

如果有人可以让我对解决此问题的不同方法有所了解，我将不胜感激。

如果这里的信息不充分或不清楚，我提前道歉。

谢谢SK

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T01:01:47.667

约束操作的非法操作数可能是由于`mem`. 尺寸必须是常数，例如，`reg [DATA_SIZE-1:0] mem [ROW_MAX*COL_MAX-1:0];`您需要确定要处理的最大图像尺寸。如果最大尺寸不是`2**N`，那么您将需要实施一些保护措施，例如发出错误信号而不处理任何内容、截断图像或其他内容。

我不确定如何在不编写自定义 PLI 的情况下找到未知图像尺寸的行和列。`$fscanf`可以读取图像数据，您很可能希望将其`"%u"`用于格式组件。如果图像在文件本身中包含有关其尺寸的信息，那么您可以使用`$fscanf`或提取信息`$fread`。

* * *

其他注意事项，来自您的原始代码片段：

```
pixe_data <= mem[row_count*NUM_ROWS+col_count]; 
```

应该：

```
pixe_data <= mem[row_count*NUM_COLS+col_count]; 
```

否则存在从不同地址访问相同数据或超出范围的风险。

# java - 我不明白为什么 BitmapFactory.decodeByteArray 返回 null

> ID：15165355
> 
> 赞同：0
> 
> 时间：2013-03-01T19:28:15.027
> 
> 标签：java, android, base64, bitmapfactory

我已将位图编码为字符串 Base64，并将其存储在 mysql 数据库中。然后我检索了这些信息，并试图从中重建一个位图。

blob 的值不为 null 并且在 base64 中。好吧，它似乎在base64中。当我这样做时

```
//This has the encoded string 
String encodedString = intervention.getUser_sign()

byte[] decodedUserString = Base64.decode(intervention.getUser_sign(), Base64.NO_WRAP);
Bitmap decoded_user_sign = BitmapFactory.decodeByteArray(decodedUserString, 0, decodedUserString.length);
user_sign.setImageBitmap(decoded_user_sign); 
```

decoded_user_sign 为“空”。

在 logcat 中，我拥有的唯一信息是：

```
DEBUG/skia(31358): --- SkImageDecoder::Factory returned null 
```

这是编码的代码：

```
 ByteArrayOutputStream baos = new ByteArrayOutputStream();
        b.compress(Bitmap.CompressFormat.PNG,50,baos);
        byte[] bytes=baos.toByteArray();
        String base64Image = Base64.encodeToString(bytes,Base64.NO_WRAP); 
```

有人可以向我解释我做错了什么吗？

谢谢

# pdf-generation - 使用 iTextSharp ColumnText 居中的多行文本

> ID：15165357
> 
> 赞同：1
> 
> 时间：2013-03-01T19:28:27.987
> 
> 标签：pdf-generation, itextsharp

我正在尝试使用 iTextSharp 将多行文本块居中。我认为使用 ColumnText 可以解决问题，但是我在同时进行中心对齐和正确换行时遇到了一些麻烦。

这是一些代码，显示了我正在尝试的两种方法：

```
private void PrintLocationAddress(PdfContentByte Canvas, string Address)
{
    //define the regions for our ColumnText objects
    Rectangle rect1 = new Rectangle(150f, 300, 350f, 450f);
    Rectangle rect2 = new Rectangle(150f, 50f, 350f, 200f);

    //outline the rectangles so we can visualize placement of the ColumnText
    Canvas.Rectangle(rect1.Left, rect1.Bottom, rect1.Width, rect1.Height);
    Canvas.Rectangle(rect2.Left, rect2.Bottom, rect2.Width, rect2.Height);
    Canvas.SetColorStroke(BaseColor.CYAN);
    Canvas.Stroke();

    //define the text and style
    Chunk c = new Chunk(Address, new Font(Font.FontFamily.COURIER, 12, Font.NORMAL, BaseColor.MAGENTA));
    c.SetTextRenderMode(PdfContentByte.TEXT_RENDER_MODE_FILL, 0, BaseColor.PINK);
    Phrase LongText = new Phrase(c);

    //this text is centered, but will wrap onto itself on the same line
    ColumnText column1 = new ColumnText(Canvas);
    column1.SetSimpleColumn(LongText, rect1.Left, rect1.Bottom, rect1.Right, rect1.Top, 0, PdfContentByte.ALIGN_CENTER);
    column1.Go();

    //this text will wrap, but how to center it?!
    ColumnText column2 = new ColumnText(Canvas);
    column2.SetSimpleColumn(rect2);
    column2.SetText(LongText);
    column2.Go();
} 
```

您可以查看上述代码的输出：http: [//imgur.com/Ty3oD7w](http://imgur.com/Ty3oD7w)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:45:53.473

我错过了 ColumnText.Alignment 属性：

```
column2.Alignment = Element.ALIGN_CENTER; 
```

因此，要使用 ColumnText 在指定尺寸的框中获取居中的多行文本：

```
ColumnText column2 = new ColumnText(Canvas);
column2.SetSimpleColumn(rect2);
column2.SetText(LongText);
column2.Alignment = Element.ALIGN_CENTER;
column2.Go(); 
```

# ruby-on-rails - 如何从 rake 任务中调用 Rails 缓存清理器？

> ID：15165358
> 
> 赞同：3
> 
> 时间：2013-03-01T19:28:32.433
> 
> 标签：ruby-on-rails

我设置了一个 Rails 缓存清理器，如下所示：

```
class ArticleSweeper < ActionController::Caching::Sweeper
  observe Article

  def sweep(article)
    expire_page articles_path
    expire_page author_path(article.author)
    FileUtils.rm_rf "#{page_cache_directory}/articles/page"
  end

  alias_method :after_update, :sweep
  alias_method :after_create, :sweep
end 
```

我将这个缓存清扫器与文章控制器连接起来。

缓存清除工作是由于创建和更新控制器操作的结果。

但是，我更新数据库记录的主要方式是通过 rake 任务，它在数据库记录上使用 save、update_attributes 等活动记录方法。

我想过添加一个模型观察者类，让这个类调用清扫器方法。网上有很多关于缓存清扫器应该如何由模型操作而不是控制器操作触发的评论。

但是对于我的应用程序，rake 任务在执行时可能会添加 100 条记录。所以我不希望缓存清扫器执行 100 次。因为它不会有效率。

我认为最好在 rake 任务结束时执行一次。

所以我尝试在我的 rake 任务中添加这个：

```
ArticleSweeper.instance.sweep(Article.last) 
```

我在其中放了一个“调试器”语句，并看到该 sweep() 方法正在执行。但是，缓存文件不会被删除，即使相同的代码在由控制器操作触发时仍然有效。

所以我的问题是：是否可以从 rake 任务中触发缓存清扫器方法？如果是这样，我该怎么做才能让它发挥作用？

谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-11-21T17:01:27.577

我遇到了同样的问题，偶然发现了这个： http: [//www.madebymade.co.uk/blog/2013/08/cache-sweepers-invalidating-caches-from-outside-the-controller/](http://www.madebymade.co.uk/blog/2013/08/cache-sweepers-invalidating-caches-from-outside-the-controller/)

# javascript - 尝试在 javascript 中构建地图/哈希图

> ID：15165359
> 
> 赞同：1
> 
> 时间：2013-03-01T19:28:40.063
> 
> 标签：javascript, jquery, arrays, hashmap, salesforce

我正在尝试在 javascript 中运行查询并将结果传递给其他查询以提取更多数据。我还希望能够将这些数据全部显示在一个表中，因此我试图将结果安排在 javascript 地图中，但我似乎遇到了问题。

**这是在 salesforce.com 内部使用他们的 AJAX 工具包构建的**

我的代码是...

```
var cn = Query("select id, LastName, FirstName, Middle_Name__c, Gender__c, HomePhone, Birthdate, Birth_City__c," +
    "Birth_Country__c, SSN_Encrypted__c, Provider_NPI_ID__c, Primary_Specialty__c," +
    "Practicing_Specialty__c, Title, GlobalProviderID__c from contact where Name like " +
    "'%" + sBox + "%'");
var PFA;

for (var i = 0; i < cn.length; i++) {
    var x = new Array();
    var PFA = Query("select id, First_Scheduled_Date__c, Region__c " +
        "from Provider_Facility_Associations__c where Provider__c='" + cn[i].Id + "'");
    m['cn'] = cn[i];
    m['PFA'] = PFA;
    m[i] = x;
}

console.log(m['cn']); 
```

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:36:05.410

您可以使用基本的 javascript 对象作为地图。

所以

```
var map = {};
map["key1"] ="value1"
map["key2"] = "value2" 
```

将创建一个像这样的对象：

```
map = {
  key1:"value1",
  key2:"value2"
} 
```

当您将整数传递`i`给您的 m 对象时，它会尝试将其视为数组而不是对象。

你有比这更深层次的问题，因为你不应该从 javascript 运行 SQL 查询。这将允许任何人在访问您的网站时对您的数据库运行任意查询。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:12:20.850

请阅读有关如何在 Salesforce 中工作的[关系](http://www.salesforce.com/us/developer/docs/api/Content/sforce_api_calls_soql_relationships.htm)以及它们的特定“连接”，这些连接在开始时看起来很奇怪，但实际上在类似的常见开发情况下会多次保存你的培根。

```
SELECT Id, FirstName, LastName,
    (SELECT Id, First_Scheduled_Date__c, Region__c 
    FROM Provider_Facility_Associations__r)
FROM contact 
WHERE Name LIKE '%Smith%' 
```

（注意“子查询”中的“__r”）

这将为您提供联系人，并且每个联系人都有一个名为 Provider_Facility_Associations__r 的“字段”，它将是一个项目数组（或者如果没有找到，则只是空数组）。

Salesforce 安全模型不是灵丹妙药，您**应该**担心性能和[SQL 注入](http://www.salesforce.com/us/developer/docs/apexcode/Content/pages_security_tips_soql_injection.htm)。人们不能使用它们删除他们不应该删除的内容，但他们可以了解您不打算公开的信息。

最后但并非最不重要的一点 - 如果您有查询服务器端并在那里传递变量（联系人姓名的一部分），这将表现得更好并且更安全。这可以作为 Web 服务公开，或者如果您在 Visualforce 中 - 操作函数、JavaScript 远程处理......有很多选择！

我并不是说 AJAX 工具包是可憎的......但如果有的话，它应该很少使用。它是所谓的 SControl 时代的产物，随着 Visualforce 的引入（嗯……4 年了？），它的许多用例可以更快、更安全地完成。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:33:53.977

从 JS 运行 SQL 通常是一个坏主意，除非您使用某种 sql-lite 本地存储引擎。无论如何，我相信您的问题可能是您的 m 和 x 混淆了。此外，在 for 循环中运行查询，`IN`在第二个查询中使用 an 或`JOIN`仅执行一个查询可能会更好。

# c# - C# OpenFileDialog 不打开文件

> ID：15165370
> 
> 赞同：0
> 
> 时间：2013-03-01T19:29:33.133
> 
> 标签：c#, openfiledialog

我正在尝试使用 openFileDialog 打开位图图像并将其放在我的表单上。我的表单构造器...

```
 public Form1()
    {
        InitializeComponent();
        drawing = new Bitmap(drawingPanel.Width, drawingPanel.Height, drawingPanel.CreateGraphics());
        Graphics.FromImage(drawing).Clear(Color.White);

        // set default value for line thickness
        tbThickness.Text = "5";
    } 
```

...打开一个带有空白屏幕的新表单，我可以使用鼠标和各种颜色选择器按钮在其上绘图。然后我用这种方法保存文件：

```
private void btnSave_Click(object sender, EventArgs e)
    {
        // save drawing
        if (file == null)   // file is a FileInfo object that I want to use
                            // to check to see if the file already exists 
                            // I haven't worked that out yet
        {
            drawing.Save("test.bmp");
            //SaveBitmap saveForm = new SaveBitmap();
            //saveForm.Show();
        }
        else
        {
            drawing.Save(fi.FullName);
        }
    } 
```

该图像确实以 .bmp 文件的形式保存到调试文件夹中。然后我使用 OpenFileDialog 打开文件：

```
private void btnOpen_Click(object sender, EventArgs e)
    {
        FileStream myStream;
        OpenFileDialog openFile = new OpenFileDialog();
        openFile.Filter = "bmp files (*.bmp)|*.bmp";

        if (openFile.ShowDialog() == DialogResult.OK)
        {
            try
            {
                if ((myStream = (FileStream)openFile.OpenFile()) != null)
                {
                    using (myStream)
                    {
                        PictureBox picBox = new PictureBox();
                        picBox.Location = drawingPanel.Location;
                        picBox.Size = drawingPanel.Size;
                        picBox.Image = new Bitmap(openFile.FileName);
                        this.Controls.Add(picBox);
                    }
                }
            }
            catch (Exception ex)
            {

            }
        }
    } 
```

不幸的是 OpenFileDialog 对话框出现了。当我选择文件 test.bmp 时，屏幕消失然后重新出现，当我再次选择它时，OpenFileDialog 窗口消失，我回到没有图像的表单。希望得到一些指点。没有编译或运行时错误。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:36:58.547

您打`ShowDialogue`了两次电话，这可能是您的问题的根源。只需使用以下代码，从方法中删除所有其他内容。您的使用`using`也不正确。它确实清理了正在处理结果的内容。您需要重构或删除 using 语句。

```
private void btnOpen_Click(object sender, EventArgs e)
{
     OpenFileDialog dlg = new OpenFileDialog()
     {
            dlg.Title = "Open Image";
            dlg.Filter = "bmp files (*.bmp)|*.bmp";

            if (dlg.ShowDialog() == DialogResult.OK)
            {
                PictureBox picBox = new PictureBox();
                picBox.Location = drawingPanel.Location;
                picBox.Size = drawingPanel.Size;
                picBox.Image = new Bitmap (dlg.FileName);
                this.Controls.Add(picBox);
            }
      }
  } 
```

上面的代码有效，但没有清理或错误处理。我会把它留给你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:34:45.327

为什么要打`ShowDialog()`两次电话？

只需调用`ShowDialog`一次，因此它不会像您指示的那样打开*两次。*

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.windows.forms.openfiledialog.aspx)：

```
OpenFileDialog openFileDialog1 = new OpenFileDialog();
openFileDialog1.Filter = "bmp files (*.bmp)|*.bmp";

if(openFileDialog1.ShowDialog() == DialogResult.OK)
{
    try
    {
        if ((myStream = openFileDialog1.OpenFile()) != null)
        {
            using (myStream)
            {
                // Insert code to read the stream here.
                PictureBox picBox = new PictureBox();
                picBox.Location = drawingPanel.Location;
                picBox.Size = drawingPanel.Size;
                picBox.Image = new Bitmap (myStream);
                this.Controls.Add(picBox);
            }
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show("Error: Could not read file from disk. Original error: " + ex.Message);
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:35:39.480

您打开一个对话框面板，然后在它关闭时检查结果是否正常；然后在块中打开另一个新对话框`using`；然后你将它的图像结果分配给，然后在块处理`PictureBox`时扔掉所有东西。`using`

# python - Sqlalchemy：当字符串在左侧，列在右侧时，使用 PSQL 的 `~` 运算符

> ID：15165371
> 
> 赞同：2
> 
> 时间：2013-03-01T19:29:38.713
> 
> 标签：python, regex, postgresql, sqlalchemy

我知道

```
WHERE column ~ 'regexp' 
```

这是 sqlalchemy：

```
where(column.op('~')('regexp')) 
```

但我怎么能创造这个？

```
WHERE 'string' ~ column 
```

（正则表达式存储在数据库中）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:36:01.727

您需要创建 a[`literal()`](https://docs.sqlalchemy.org/core/sqlelement.html#sqlalchemy.sql.expression.literal)或 a [`bindparam()`](https://docs.sqlalchemy.org/core/sqlelement.html#sqlalchemy.sql.expression.bindparam)：

```
from sqlalchemy.sql import expression

expression.literal('string').op('~')(column)
# or
expression.bindparam('text', 'string').op('~')(column) 
```

A`literal()`基本上是`bindparam()`带有隐式名称的 a；在上面的示例`'text'`中是 SQL 语句中使用的参数的名称（键），以及`'string'`您希望出现在运算符左侧的文本。

A`bindparam()`为您提供了更多控制权，包括传入*calleble*而不是具体值的能力：

```
def value_function():
    return some_calculation_result()

expression.bindparam('calculated_value', callable_=value_function).op('~')(column) 
```

并且 SQLAlchemy 将`value_function()`在将语句发送到数据库服务器时调用。`bindparam()`如果您有*一系列*值，您也可以使用，SQLAlchemy 将负责调整表达式以应用于序列中的每个值：

```
strings = ['string1', 'string2', ...]
expression.bindparam('one_or_more', strings).op('~')(column)
# executes `('string1' ~ column OR 'string2' ~ column OR ...)` 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-15T13:10:41.753

一个非 Sqlalchemy 特定的解决方案是在 PostgreSQL 后端创建您自己的操作数反转操作数。这也可以让你做类似的事情

```
string ### ANY(ARRAY[regexp1, regexp2, ...]) 
```

`###`你的接线员在哪里。（找到一个好名字可能是一个挑战。）

# java - 使用字符串查找 Java 非字符串键控 Java HashMap

> ID：15165372
> 
> 赞同：1
> 
> 时间：2013-03-01T19:29:40.433
> 
> 标签：java, hashmap

我正在尝试`HashMap`使用`CircuitId class`. CircuitId 类包含一个 String clci 成员，并且该类`hashCode()/equals()`基本上使用 clci 成员的`hashCode()/equals()`.

我想这样做，以便我可以使用简单的字符串来查找地图，而无需将字符串转换为`CircuitId`对象来查找地图。但它不起作用，我认为因为`HashMap`使用这种评估形式`(key==null ? k==null : key.equals(k))`，其中 key 是输入键，k 是地图中的键条目，特别是 key.equals(k) 部分。我想知道为什么 HashMap 没有这样做`k.equals(key)`？

（至少这样，我认为我正在尝试做的事情会奏效。）但事实并非如此，这样做有诀窍吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:58:17.477

> 如果我用检查覆盖了 equals() 以处理传递的键是字符串还是实际的 CircuitId 对象，我不明白为什么它不起作用。

容器是否将电路与字符串进行比较，或者字符串与电路进行比较是特定于实现的，并且不保证在 JRE 的未来版本中相同。

通常，给定两个对象`a`和`b`，预计`a.equals(b)`何时出现`b.equals(a)`，反之亦然。这称为*对称*属性。

在 and 的情况下`CircuitId`，`String`虽然您可以覆盖`CircuitId.equals()`并`circuit.equals(id)`返回`true`，但`id.equals(circuit)`始终是`false`因为您无法覆盖`String.equals()`。

您应该使用 a `Map<String,CircuitId>`(`Map<CircuitId,SomethingElse>`如果您需要将其`CircuitId`作为另一个地图中的键，则可能使用另一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:56:30.907

如果您想通过 查找条目`String`，您应该使用 a`HashMap<String, CircuitID>`或类似的东西。

如果你想要两者，你可能想要有两个地图，或者做两级查找：

```
CircuitId circ = knownCircuits.get(stringKey);
if (circ != null) {
     return otherMap.get(circ);
} else {
     return null;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:10:45.823

使用 CircuitId 键控映射，但覆盖 的`get()`方法，`HashMap`因此它也适用于`String`对象：

```
Map<CircuitId, CircuitLayout> map = new HashMap<CircuitId, CircuitLayout>() {
    @Override
    public CircuitLayout get(Object key) {
        if (key instanceof String)
            return super.get(new CircuitId((String)key));
        return super.get(key);
    }
} 
```

您可以类似地覆盖`contains()`和您需要的任何其他方法。

这样做的好处是您不必通过使它们与*其他*类“相等”的实例来“破坏”您的类。它将任何“丑陋”隐藏在一个（和正确的）地方。

# eclipse - 有没有办法在 Eclipse 插件中包含 .launch 文件？

> ID：15165373
> 
> 赞同：0
> 
> 时间：2013-03-01T19:29:41.840
> 
> 标签：eclipse, eclipse-plugin, launch

我正在尝试创建一个插件，该插件将在 eclipse 打开时自动生成一个外部工具。我研究了一些选项，似乎完成它的最佳方法是在插件运行时将包含创建外部工具的信息的 .launch 文件加载到 eclipse 中。到目前为止，我还没有找到一种方法来做到这一点，有谁知道它是如何实现的？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T16:38:39.367

您可以使用`DebugUITools`启动您的 .launch 文件。您可以在[这篇](http://www.eclipse.org/articles/Article-Java-launch/launching-java.html)日食文章中找到更多信息。

# eclipse - 有什么方法可以防止 emacs 键绑定在 Eclipse 中出现错误？

> ID：15165375
> 
> 赞同：1
> 
> 时间：2013-03-01T19:29:52.837
> 
> 标签：eclipse, emacs, key-bindings

我想知道我是否是唯一一个努力（即失败）保持 emacs 键绑定在 Eclipse 中工作的人。

我设置它们。它工作正常。它停止正常工作。有些键仍然有效，有些则无效。我发现自己处于一种不确定的键绑定设置叠加的奇怪量子状态。标准集中的一些键绑定有效，emacs 集中的一些有效，有些东西我不能用任何一组绑定来实现。

只有我一个人有这种经历？在过去的几个月里，我在至少 4 台计算机上看到了这一点。

我将键绑定设置回标准集。有时它会起作用。我使用重置为默认值按钮。尝试将其设置回 emacs。不工作。在不同步骤之间按下应用按钮与否……让我发疯。

在某些计算机上，绑定只是随便什么。只能使用鼠标保存，Cd 和 Ck 不能删除/剪切行，大多数 emacs 键仍然有效但返回 C-space 用于自动完成等。

有谁知道是什么原因造成的？如何预防？我是否误按了一些键绑定键绑定？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-10T22:16:05.450

我在使用 Ctl-K、Ctl-D 命令时遇到了类似的问题：升级后（我忘记是 Eclipse 本身还是 Android 插件）我看到 Eclipse 在这两个键上都提供了一个小弹出菜单，提供要么是正确的 Emacs 命令，要么是一些完全不相关的命令。因此，例如，Ctl-D 提供删除下一个字符（正确）或删除行（错误）。

在对键绑定（Windows>Preferences>General>Keys）进行了一些探索之后，我发现果然，Eclipse 项目中的某些人除了正确的绑定之外还提供了这些错误的绑定。所以我删除了不正确的绑定并留下了正确的绑定。

所以我想我会在这一点上走出困境。但我也发现我必须在几次之后重新添加正确的绑定才能粘住。

在 Command 列下寻找 Cut to End of Line 并确保它在编辑文本时和文本编辑类别中具有 Ctl-K。删除下一个（表示下一个字符）也是如此。但请确保 Ctl-D 不会出现在删除行命令中。

在编辑器窗口中测试它；如果失败，请再次编辑绑定，再次测试，重复直到粘住，确保在编辑绑定后单击应用。

# c# - 从 Text Doc 在 C# 中创建 XML 层次结构

> ID：15165382
> 
> 赞同：0
> 
> 时间：2013-03-01T19:30:16.837
> 
> 标签：c#, xml, xml-parsing, xml-serialization, linq-to-xml

我需要从服务器获取文本文档并从中创建 XML 层次结构，以便在 C# 程序中使用它。

这将是一个组织层次结构。这是文本文件的相同内容：

```
EmployeeID; Employee Name; SupervisorID

1; Bob; 3
2; Mark; 1
3; Jill; 0
4; Ann ; 1 
```

上述关系将是：

鲍勃的老板是吉尔。马克的老板是鲍勃，而吉尔没有老板。

我想从该数据创建一个 XML 文件，看起来像这样：

```
<Employee> Jill
   <Employee> Bob
      <Employee> Mark </Employee>
      <Employee> Ann </Employee>
  </Employee>
</Employee> 
```

我不知道这是否有意义，因为我以前从未使用过 C# 或 XML。
随意更改标签的命名方式，我需要做的主要事情是：

1.  能够获得由同一个人监督的每个人的姓名。（例如：马克想要马克和安）

2.  能够获得员工上方所有主管的姓名（例如：马克的姓名将是 Bob 和 Jill）

3.  能够获得当时所有人的姓名（例如：Mark 将没有人，Jill 将拥有所有人，Bob 将拥有 Mark 和 Ann）

我查看了 XElement 和 XDoc 以及各种教程和 SO 问题，但目前大多数 SO 问题对我来说都太高级了，而且大多数教程都没有尝试创建像我这样的层次结构。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:39:36.547

定义一个员工类：

```
public class Employee{
    [XmlIgnore]
    public int ID{get;set;}

    [XmlIgnore]
    public int BossID{get;set;}

    [XmlText]
    public string Name{get;set;}

    [XmlElement("Employee")
    public Employee[] Minions{get;set;}
    public SetMinions(List<Employee> list){
       Minions = list.Where(e=>e.BossID==ID).ToArray();
    }
} 
```

然后解析您的输入：

```
List<Employee> list = File.ReadAllLines("MyInputFile.txt")
   .Select(l=>new Emplyee(){
        ID = l.Split(';')[0],
        Name= l.Split(';')[1],
        BossID = l.Split(';')[2]}).ToList(); 
```

然后为每个设置奴才：

```
list.ForEach(e=>e.SetMinions(list)); 
```

并像这样生成 XML：

```
 XmlSerializer xser = new XmlSerializer(typeof(Employee));
  xser.Serialize(File.OpenWrite("output.txt", list.First(e=>e.BossID==0))); 
```

如果这段代码不是很明显很脏且不可靠，请添加一些检查和清理

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:32:18.510

`Employee`班级：

```
public class Employee
{
    public Employee()
    {
        Subordinates = new List<Employee>();
    }

    public int Id { get; set; }
    public string Name { get; set; }
    public int SupervisorId { get; set; }
    public List<Employee> Subordinates { get; private set; }

    public XElement ToXml()
    {
        return new XElement("Employee",
                   new XElement("Id", Id),
                   new XElement("Name", Name),
                   new XElement("Subordinates", Subordinates.Select(s => s.ToXml())));
    }
} 
```

和解析逻辑：

```
// dictionary as a storage for data read from file
var Employees = new Dictionary<int,Employee>();

// file reading
var file = File.Open("Input.txt", FileMode.Open);
using (var reader = new StreamReader(file))
{
    reader.ReadLine();
    while (!reader.EndOfStream)
    {
        string line = reader.ReadLine();
        string[] fields = line.Split(';');

        var newEmployee = new Employee { Id = int.Parse(fields[0]), Name = fields[1].Trim(), SupervisorId = int.Parse(fields[2]) };
        Employees.Add(newEmployee.Id, newEmployee);
    }
}

// filling Subordinates within every employee
foreach (var emp in Employees.Values)
{
    if (Employees.ContainsKey(emp.SupervisorId))
        Employees[emp.SupervisorId].Subordinates.Add(emp);
}

// taking first (root) employee by selecting the one with supervisorId == 0
var first = Employees.Values.First(e => e.SupervisorId == 0);

// XML generation
var xml = first.ToXml(); 
```

我从该代码中收到的带有您的示例输入的结果：

```
<Employee>
  <Id>3</Id>
  <Name>Jill</Name>
  <Subordinates>
    <Employee>
      <Id>1</Id>
      <Name>Bob</Name>
      <Subordinates>
        <Employee>
          <Id>2</Id>
          <Name>Mark</Name>
          <Subordinates />
        </Employee>
        <Employee>
          <Id>4</Id>
          <Name>Ann</Name>
          <Subordinates />
        </Employee>
      </Subordinates>
    </Employee>
  </Subordinates>
</Employee> 
```

我认为这个结构比你建议的要好。`ToXml`但是，您可以通过修改类中的方法轻松地修改 XML 结构`Employee`。以下一个会给出您建议的输出：

```
public XElement ToXml()
{
    return new XElement("Employee",
               new XText(Name),
               Subordinates.Select(s => s.ToXml()));
} 
```

Result:

```
<Employee>Jill
    <Employee>Bob
        <Employee>Mark</Employee>
        <Employee>Ann</Employee>
    </Employee>
</Employee> 
```

# r - 在ggplot2中添加垂直线时出错

> ID：15165383
> 
> 赞同：1
> 
> 时间：2013-03-01T19:30:21.137
> 
> 标签：r, ggplot2

所以，我有一个拍卖数据的大型数据集（大约 400 000 次观察）。我正在尝试使用 ggplot 按天绘制拍卖价格，同时使用垂直线按颜色和月份表示年份。

我有一个 POSIXlt 向量来保存我的日期，这是我正在使用的：

```
firstmonth<- c(1,32,60,91,121,152,182,213,244,274,305,335)

require(ggplot2)
p <- ggplot(bb, aes(saledate$yday, SalePrice))
p <- p + geom_point(aes(color = factor(saledate$year)), alpha = I(1/30)) #This plot works
p + geom_vline(aes(xintercept = firstmonth))
Error in data.frame(xintercept = c(1, 32, 60, 91, 121, 152, 182, 213,  : 
  arguments imply differing number of rows: 12, 401125 
```

这个错误是怎么回事？为什么我不能得到垂直线？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T19:58:23.127

您需要将新的 data.frame 传递给`geom_vline`：

```
library(ggplot2)

bb <- data.frame(SalePrice=rnorm(1000))
saledate <- data.frame(yday=1:1000,year=rep(1:10,each=100))

firstmonth<- c(1,32,60,91,121,152,182,213,244,274,305,335)

p <- ggplot(bb, aes(saledate$yday, SalePrice))
p <- p + geom_point(aes(color = factor(saledate$year))) #This plot works
p + geom_vline(aes(xintercept = firstmonth))
#error
df2 <- data.frame(firstmonth)
p + geom_vline(data=df2,aes(xintercept = firstmonth))
#works 
```

# localization - Zend 2 中首选的本地化方法是什么？

> ID：15165385
> 
> 赞同：0
> 
> 时间：2013-03-01T19:30:25.067
> 
> 标签：localization, zend-framework2

我正在寻找有关在 Zend 2 中处理本地化的首选方法的教程，但到目前为止我还没有找到任何教程。我能找到的最好的是[这个页面](https://packages.zendframework.com/docs/latest/manual/en/modules/zend.i18n.translating.html)，它没有详细解释实现本地化（特别是应用程序消息）的实际过程，或者[这个问题](https://stackoverflow.com/questions/4259735/how-to-deal-with-localization-is-there-a-standard-i-should-follow)，它在 Zend 2 发布之前被问到，现在已经过时了。

如果在该页面上给出一个选择，假设我选择 GNU Gettext 作为翻译格式。在这种情况下，是否有任何关于本地化 ZF2 应用程序的教程？

或者，假设我将网站上的页面文本存储在数据库表中，例如

```
CREATE TABLE `page` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `title` varchar(255) DEFAULT NULL,
  `body` blob,
  `locale` int(11) NOT NULL,
  `creator` int(11) NOT NULL,
  `created` datetime NOT NULL,
  `modified` datetime NOT NULL,
PRIMARY KEY (`id`),
KEY `pagecreatorfk_idx` (`creator`),
CONSTRAINT `pagecreatorfk` FOREIGN KEY (`creator`)
REFERENCES `user` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8 
```

那么我将如何提供本地化消息呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T20:43:43.190

好的，对于初学者，您需要一个翻译程序，例如[http://www.poedit.net/](http://www.poedit.net/)

这是我的设置方式：

在您的模块文件夹中创建另一个名为“语言”的文件夹。

打开你的 module.config.php 并添加以下内容：

```
'translator' => array(
    'translation_file_patterns' => array(
        array(
            'type'        => 'gettext',
            'base_dir'    => __DIR__ . '/../language',
            'pattern'     => '%s.mo',
            'text_domain' => 'account'
        )
    )
) 
```

对我来说，让事情变得简单的是创建一个 language.php 文件并添加如下行：

```
echo _('text_to_translate_here'); 
```

当您配置 PoEdit 时，您将扫描此文件，该文件会将翻译 ID 添加到 PoEdit。现在您可以添加要显示的真实文本，保存后将输出 2 个文件，如 account.mo 和 account.po。您需要上传到语言文件夹的唯一文件是 account.mo

由于我在整个应用程序中都使用了翻译，因此我已将工厂添加到我的 global.php 文件中：

```
return array(
    'service_manager' => array(
        'factories' => array(
            'translator' => 'Zend\I18n\Translator\TranslatorServiceFactory',
        )
    )
); 
```

在我的 view.phtml 文件中，我现在可以翻译：

```
<?php echo $this->translate('text_to_translate_here', 'account'); ?> 
```

现在，如果您不想像我在 module.config.php 示例中所示的那样使用文本域，那么默认情况下，所有翻译都将使用“默认”文本域。所以你可以这样做：

```
<?php echo $this->translate('text_to_translate_here'); ?> 
```

这也适用于 FormLabels：（这将输出 Priroity 作为标签名称）

```
<?php echo $this->formLabel($this->form->get('prio')); ?> 
```

如果您想使用“默认”以外的文本域翻译表单对象，那么您可以将其添加到您的 view.phtml

```
$this->formSubmit()->setTranslatorTextDomain('account'); 
```

现在您的提交表单标签将使用该文本域而不是默认文本域。任何其他类型的表单对象也是如此。只需将 formSubmit 替换为元素类型。

让我知道这是否有帮助或我是否遗漏了什么。

# visual-studio - 如果我在 vs2012 中的 Azure 角色文件夹上看到一个黄色三角形，我该如何收到错误消息？

> ID：15165392
> 
> 赞同：6
> 
> 时间：2013-03-01T19:30:54.597
> 
> 标签：visual-studio, azure

在痛苦的合并之后，我一直在手动编辑 Azure 云 .cscfg 和 .csdef 文件。我相信我一切正常，并且解决方案构建时没有错误或警告。在构建过程中，输出选项卡中不会出现任何内容。我有许多 Azure 角色和配置文件，我知道它们都需要匹配。

但是，我在 Visual Studio 2012 中的 Azure 角色文件夹上看到一个黄色三角形。如何找出我的配置错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:33:23.860

正如 Jaxidian 评论的那样，解决方案是将所有 8 个 .cscfg 文件与选定的主文件进行比较，并确保标签内的所有标签都存在。

如果您尝试配置远程桌面，则所有远程桌面标记的所有值都必须相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-29T03:06:14.700

对我来说，要么

```
<ServiceConfiguration serviceName="... 
```

或者 ...

```
 <Role name="... 
```

无效（设置为另一个/不正确的服务名称/角色）。

# c# - 使用 UnmanagedMemory.LPTStr 而不是 .ByValTStr 会导致内存损坏吗？为什么？

> ID：15165393
> 
> 赞同：1
> 
> 时间：2013-03-01T19:30:58.673
> 
> 标签：c#, .net, memory, pinvoke, dllimport

我们在 Windows 窗体应用程序中有一个树视图，它使用以下代码使用适当的文件图标显示文件。我的问题是对 GetIcon() 的调用似乎破坏了我的记忆，因为我开始遇到各种程序崩溃，在此调用之后我无法用调试器捕获这些崩溃。
当我更改`managedType.LPTStr`为`managedType.ByValTStr`. 这是一个真正的解决方案还是只是掩盖了问题？

这段代码似乎在我们上一个产品版本中工作，我看不到任何改变。使用 .NET 4.0。我只在发布模式下看到问题。

```
[DllImport("Shell32.dll")]
private static extern int  SHGetFileInfo(string pszPath, uint dwFileAttributes, out SHFILEINFO psfi, uint cbfileInfo, SHGFI uFlags);

 [StructLayout(LayoutKind.Sequential)]
        private struct SHFILEINFO
        {
            public SHFILEINFO(bool b)
            {
                hIcon=IntPtr.Zero;
                iIcon=0;
                dwAttributes=0;
                                szDisplayName = "";
                                szTypeName = "";
            }

            public IntPtr hIcon;
            public int iIcon;
            public uint dwAttributes;

                        [MarshalAs(UnmanagedType.LPTStr, SizeConst = 260)]//works if .ByValTStr is used instead
                        public string szDisplayName;
                        [MarshalAs(UnmanagedType.LPTStr, SizeConst = 80)]//works if .ByValTStr is used instead
                        public string szTypeName;
        };

 public static Icon GetIcon(string strPath, bool bSmall)
        {
            SHFILEINFO info = new SHFILEINFO(true);
            int cbFileInfo = Marshal.SizeOf(info);
            SHGFI flags;
            if (bSmall)
                flags = SHGFI.Icon|SHGFI.SmallIcon|SHGFI.UseFileAttributes;
            else
                flags = SHGFI.Icon|SHGFI.LargeIcon|SHGFI.UseFileAttributes;

            SHGetFileInfo(strPath, 256, out info,(uint)cbFileInfo, flags);
            return Icon.FromHandle(info.hIcon);
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:12:37.680

好吧，它`LPStr`在结构中不是正确的，因此您不能尝试将其编组为一个并期望它起作用：

```
typedef struct _SHFILEINFO {
  HICON hIcon;
  int   iIcon;
  DWORD dwAttributes;
  TCHAR szDisplayName[MAX_PATH];
  TCHAR szTypeName[80];
} SHFILEINFO; 
```

*   `LPTStr`当你分配一个特殊的内存块来保存这个字符串（通常在一个`Marshal.AllocHGlobal`或类似的）时，你会使用它，然后你已经将你的内存复制`string`到那个非托管内存区域。

*   `ByValTStr`当您按值传递实际字符串时使用，而不是通过引用内存中的另一个区域。

该结构需要正确的值，而不是指针。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-07T21:33:31.480

我意识到这是一个老问题，但这帮助我解决了一个似乎突然开始频繁出现的崩溃问题。在通过 Windows 更新推出 .NET 4.5.2 更新后，我似乎开始遇到这些问题。 `LPTStr`在更新之前工作并在更新`ByValTStr`之后工作。

# asp.net - Iphone 没有收到 .ics 日历

> ID：15165395
> 
> 赞同：0
> 
> 时间：2013-03-01T19:31:07.287
> 
> 标签：asp.net

谁能告诉我为什么这个文本不作为我的 iPhone 的附件它适用于 Android 和它的日历事件我单击它以将其添加到我的日历

这是我收到电子邮件时 iPhone 上的样子

```
BEGIN:VCALENDAR
ProdId:-//Mycompany Calendar//ttw
VERSION:2.0
METHOD:REQUEST
BEGIN:VEVENT
DTSTART:20120812T090000Z
DTEND:20120813T160000Z
LOCATION;ENCODING=QUOTED-PRINTABLE:location mine
DESCRIPTION;ENCODING=QUOTED-PRINTABLE:my description
SUMMARY;ENCODING=QUOTED-PRINTABLE:
UID;ENCODING=QUOTED-PRINTABLE:580e0a63-2009-4373-8743-6afdce1f7012
TRIGGER:-PT15M
PRIORITY:3
ORGANIZER:donotreply@Mycompany.com
SEQUENCE:1
END:VEVENT
END:VCALENDAR" 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T00:07:23.990

原来在 write 过程中使用了一种方法，我们使用 writeline 而不是 write，因为 writeline 总是添加一个新行，而 iphone 设备不知道如何处理它。

# objective-c - NSMetadataQuery 返回 searchScopes 之外的结果

> ID：15165396
> 
> 赞同：1
> 
> 时间：2013-03-01T19:31:10.607
> 
> 标签：objective-c, nsmetadataquery

我正在使用一款联合 Mac/iOS 应用程序，该应用程序通过 iCloud 将文档和数据相互同步。为了检测数据何时发生变化，我使用 NSMetadataQuery 来观察相关的 iCloud 文件夹。

这些应用程序还使用另一个纯本地数据存储，我使用 NSMetadataQuery 对象监控它，以防用户从 Finder 删除或添加文档。

每个单独的 NSMetadataQuery 对象都被赋予了不同的 searchScopes，因此它们不会意外地观察到彼此各自的文件夹。

问题是本地 Query 并不总是尊重它的 searchScope 并且会随机返回它之外的值。

这是我发现它行为不端的一个例子。

```
(lldb) po docQuery.searchScopes
$1 = 0x0000000101553ae0 <__NSArrayI 0x101553ae0>(
file://localhost/Users/aschenk/Library/Containers/com.chimpstudios.cloudclipboard/Data/Documents/LargeClippings
) 
```

这是“找到”文件的网址

```
Erroneous query reporting >> file://localhost/Users/aschenk/Library/Mobile%20Documents/8YJAW5LA57~com~chimpstudios~cloudclipboard/Documents/D7D31630-81B7-47AA-BEE7-71A5B8D96B23.ccc/ 
```

现在，我已经再次检查查询结果是否确实存在于 searchScope 中。这感觉像是 API 的一个错误，但在我向 Apple 提交报告之前，我想在这里仔细检查一下，这可能是我忽略的一些愚蠢的事情。

# javascript - 如何保护我的网站免受注入（Cookie 编辑）

> ID：15165401
> 
> 赞同：0
> 
> 时间：2013-03-01T19:31:42.260
> 
> 标签：javascript, jquery, jakarta-ee, cookies, security

我在我的 Java EE 应用程序（客户端上的 jQuery）中使用了 cookie，并且在将安全性作为关键点的同时，我知道人们可以通过阅读[文章](http://www.codeproject.com/Articles/134024/HTML-and-JavaScript-Injection)来读取 cookie 并对其进行编辑。我真的很想从这些攻击中应用。

我在 SO 上阅读[了如何在用户生成的 HTML 中防止 Javascript 注入攻击](https://stackoverflow.com/questions/942011/how-to-prevent-javascript-injection-attacks-within-user-generated-html) ，但没有找到使我的 cookie 安全的解决方案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:35:33.380

除非您的站点（或用户的系统）存在其他漏洞，否则第三方无法修改 cookie。

因此，您可以像对待来自客户端的任何其他数据一样对待它们（除了您不必担心 cookie 数据被[CSRF 攻击](http://en.wikipedia.org/wiki/Cross-site_request_forgery)伪造）。也就是说：信任 cookie 就像信任用户一样。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T01:33:23.697

您可以为 cookie 设置几个标志来降低安全风险。

1.  **安全**标志。它要求 cookie 只能通过 https 发送。这很重要，即使您的网站使用 https。为什么？假设银行网站强制最终用户使用 https。用户通过https连接银行网站，登录成功。银行网站通过 https 将 cookie 发送回用户浏览器。假设黑客可以嗅探网络并查看最终用户和银行站点之间的所有明文通信。显然，目前黑客无法看到任何东西，因为 cookie 是通过安全通道传输的。如果未设置 HttpOnly 标志，黑客可以执行以下操作

    a) 黑客创建了一个网站 www.maliciouscode.com。

    b) 他向最终用户发送带有链接的电子邮件，引诱最终用户访问该站点。

    c) 用户上钩，通过另一个浏览器选项卡连接到[http://www.maliciouscode.com站点。](http://www.maliciouscode.com)

    d) 恶意站点通过http将用户浏览器重定向到银行站点。

    e) 用户浏览器通过 HTTP 将 cookie 发送到银行站点。

    f) 黑客拦截 cookie，因为它是以明文形式发送的，将其放在自己的浏览器中并以用户身份登录

2.  **HttpOnly**标志。这个名字具有误导性。它不是安全标志的对立面。这意味着cookie只能由浏览器通过http（和https）协议使用，而不能通过JavaScript等其他方式使用。如果支持 HttpOnly 的浏览器检测到包含 HttpOnly 标志的 cookie，并且客户端脚本代码尝试读取 cookie，则浏览器将返回一个空字符串作为结果。这是为了防止 XSS 攻击。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-01T22:16:56.297

Cookie 不安全。忘记保护他们。

*   您应该通过在 HTTPS 上进行所有通信来保护您的服务器。HTTPS 比其他任何东西都更能保护您的 cookie（尽管它不能防止会话劫持）。
*   请勿在 cookie 中存储会话 ID 以外的任何敏感信息。
*   确保您的 cookie 配置为仅 HTTP。如果没有，会话 id 将作为查询字符串的一部分发送，并且可以被任何人拦截（和缓存）。
*   在用户登录、密码更改等重大事件上重新生成会话 ID。

# csh - 如何从csh中的字符串中获取数值

> ID：15165403
> 
> 赞同：0
> 
> 时间：2013-03-01T19:31:44.337
> 
> 标签：csh

我正在编写一个 csh 脚本，需要将字符串中的数值分配给一个变量

这是字符串值的示例：“pkt_size=78”

除了数字之外，字符串中的字符将始终相同。

我非常需要提取“=”符号之后的值。

我可以使用什么 Unix 命令来执行此操作？

谢谢，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:35:38.887

```
% set var = pkt_size=78
% set num = `echo $var | sed 's/.*=//'`
% echo $num
78 
```

或者，如果您使用的是 tcsh（不是纯 csh）*并且*前缀是固定字符串：

```
% set var = pkt_size=78
% set num = $var:s/pkt_size=//
% echo $num
78 
```

[强制性参考](http://www.faqs.org/faqs/unix-faq/shell/csh-whynot/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:36:14.597

快速破解...

```
$ NUMBER=`echo pkt_size=78 | sed -e 's/pkt_size=\(\d*\)/\1/'` 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:59:39.787

根据[C-shell Cookbook](http://www.starlink.rl.ac.uk/docs/sc4.htx/node34.html)

> C-shell 没有字符串操作工具。相反，我们主要使用 echo 命令和 awk 实用程序。后者有自己的文本处理语言，您可以编写 awk 脚本来执行复杂的处理，通常来自文件。甚至还有专门介绍 awk 的书籍，例如 Dale Dougherty 的简明标题 sed & awk（O'Reilly & Associates，1990）。当然，详细的描述远远超出了这本食谱的范围。

一个`awk`黑客会是这样的：

```
set var=`echo "$var" | awk -F= '{print $2}'` 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:09:30.170

如果必须使用 csh，可以使用内置修饰符。

```
% set v=pkt_size=78
% echo $v:s/pkt_size=//
78 
```

这可能特定于 tcsh。

但是确实有很多理由使用 bourne shell 衍生物（sh、ksh、bash）来代替。

# c++ - Visual C++ 2012 中的 FREEGLUT 调试和发布库

> ID：15165406
> 
> 赞同：0
> 
> 时间：2013-03-01T19:31:54.213
> 
> 标签：c++, visual-c++, opengl, visual-studio-2012, freeglut

Freeglut 2.8.0 构建了 4 个库：

x86

> > 调试
> > 发布
> 
> x64
> 
> > 调试
> > 发布

但是，在 C:\Program Files (x86)\Windows Kits\8.0\Lib\win8\um 的 lib 目录中，只有 x86 和 x64 子目录。

我应该将“freeglut.lib”和“freeglut_static.lib”放在哪里进行调试和发布？我应该创建一个名为 Debug 的子目录并将调试版本放在那里吗？我的项目在构建时如何区分？

# verilog - Verilog 4位乘法器？

> ID：15165408
> 
> 赞同：0
> 
> 时间：2013-03-01T19:32:01.030
> 
> 标签：verilog

我在如何为以下 Verilog 代码创建测试模块时遇到问题：

```
module Multiplier_4bit(output [8:0] y, input [3:0] i1, input [3:0] i2);
assign y=i1*i2;
endmodule 
```

我想到了以下测试模块：

```
module M4_Tester
reg [3:0] i1;
reg [3:0] i2;
wire [9:0] y;
initial begin
i1=5;
i2=3;
$finish();
Multiplier_4bit device1(
  .out(y),
  .in0(i1),
  .in1(i2)
);  

endmodule 
```

如果我错了，请纠正我并对英语不好感到抱歉，因为我不是母语人士。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:08:06.533

1.  您不能在开始块内实例化模块（将乘数放在`initial begin`块之外的某个位置。

2.  您没有相应`end`的关闭`initial begin`块。

3.  您的模拟将立即终止，因为设置值和`$finish`. 在模拟完成之前放置一些标称时间延迟`#10 $finish()`。

下次请在提问前澄清您的问题，并发布您收到的实际错误消息。

# c# - 连接到客户端计算机上的数据库时出现异常

> ID：15165413
> 
> 赞同：1
> 
> 时间：2013-03-01T19:32:17.217
> 
> 标签：c#, sql-server, entity-framework, deployment, localdb

我创建了一个 WPF 应用程序，它使用实体框架和 SQL Server 2012 作为数据库。它在我的机器上运行良好。但是当我在客户端机器上运行它时，我收到了异常。当我尝试在数据库中添加记录时会发生这种情况。

异常：基础提供程序因打开内部异常而失败：建立与 SQL Server 的连接时发生与网络相关或特定于实例的错误。服务器未找到或无法访问。验证实例名称是否正确以及 SQL Server 是否配置为允许远程连接。（提供者：SQL 网络接口，........

连接字符串：

```
<connectionStrings><add name="SchoolModelContext" 
    connectionString="metadata=res://*/SchoolModel.csdl|res://*/SchoolModel.ssdl|res://*/SchoolModel.msl;
    provider=System.Data.SqlClient;provider connection string='data source=(LocalDB)\v11.0;
    initial catalog=&quot;SCHOOLDB.MDF&quot;
    integrated security=True;MultipleActiveResultSets=True;
    App=EntityFramework'" providerName="System.Data.EntityClient" />
</connectionStrings> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:18:34.563

错误消息......它给出了有时是兔子轨迹的提示。基本上错误是说“我无法连接到 sql Server，有问题”。

但是..你说你在客户端上“安装了 SqlLocalDB”。

您是否“连接”了新数据库 (SCHOOLDB)？

[http://msdn.microsoft.com/en-us/library/hh212961.aspx](http://msdn.microsoft.com/en-us/library/hh212961.aspx)

A. 创建 LocalDB 实例

以下示例使用 SQL Server 2012 二进制文件创建名为 SCHOOLDB 的 SQL Server Express LocalDB 实例并启动该实例。

```
SqlLocalDB.exe create "SCHOOLDB" 11.0 -s 
```

Aka，你跑过这样的事情吗？

（来自 MSDN 文章的其他信息可能与此问题无关）

B. 使用 LocalDB 的共享实例

使用管理员权限打开命令提示符。

```
SqlLocalDB.exe create "SCHOOLDB"
SqlLocalDB.exe share "SCHOOLDB" "SchoolSharedLocalDB"
SqlLocalDB.exe start "SCHOOLDB"
SqlLocalDB.exe info "SCHOOLDB"
REM The previous statement outputs the Instance pipe name for the next step
sqlcmd –S np:\\.\pipe\SCHOOLDB#<use your pipe name>\tsql\query
CREATE LOGIN NewLogin WITH PASSWORD = 'Passw0rd!!@52'; 
GO
CREATE USER NewLogin;
GO
EXIT 
```

执行以下代码以使用 NewLogin 登录连接到 LocalDB 的共享实例。

```
sqlcmd –S (localdb)\.\SchoolSharedLocalDB -U NewLogin -P Passw0rd!!@52 
```

编辑 ::: （仅在此行上方阅读以获得一般理解......请参阅下面我实际执行的步骤）

好的，以上内容有点令人困惑，因为很难知道您是在处理 ~instance 还是数据库。

让我们试试这个：

```
SqlLocalDB.exe create "MySuperCoolLocalExpressInstance"
SqlLocalDB.exe share "MySuperCoolLocalExpressInstance" "MySuperCoolLocalExpressInstanceSHARED"
SqlLocalDB.exe start "MySuperCoolLocalExpressInstance"
SqlLocalDB.exe info "MySuperCoolLocalExpressInstance" 
```

现在，非常重要的是，获得您非常独特的“命名管道”值。

```
np:\\.\pipe\LocalDB#<use your pipe name>\tsql\query 
```

将您的 SchoolDB.mdf 和 SchoolDB.ldf 复制到：

```
c:\MyCoolLocalDatabaseFiles\ 
```

现在将您的连接字符串设置为：

```
<connectionStrings>
  <add name="SchoolModelContext"
    connectionString="metadata=res://*/SchoolModel.csdl|res://*/SchoolModel.ssdl|res://*/SchoolModel.msl;
    provider=System.Data.SqlClient;provider connection string=&quot;data source=np:\\.\pipe\LOCALDB#MYUNIQUEPIPENAME\tsql\query;attachdbfilename=C:\MyCoolLocalDatabaseFiles\SchoolDB.mdf;integrated security=True;multipleactiveresultsets=True;App=EntityFramework&quot;" providerName="System.Data.EntityClient" />
</connectionStrings> 
```

但是用“MYUNIQUEPIPENAME”代替你的值。

关键是“附加数据库文件名”。这就是“即时”附加数据库的方法。

您有一些使用命名管道语法的替代方法。看：

[http://www.connectionstrings.com/sql-server-2012](http://www.connectionstrings.com/sql-server-2012)

*“本地 SQL Server Express 上的用户实例”*

```
enter code here 
```

# jquery - jQuery从变量中选择一个值

> ID：15165414
> 
> 赞同：0
> 
> 时间：2013-03-01T19:32:18.207
> 
> 标签：jquery, this, jquery-click-event

我是 jQuery 新手，我在从变量中获取我需要的值时遇到问题。更具体地说，我在 html 文件中有这个列表。

```
<ul id="menu">
<li class="mainmenu" id="newsarticles"><a href="#">News &amp; articles</a>

    <ul id="newsarticles">
        <li class="submenu" id="news"> <a href="#">News</a>

        </li>
        <li class="submenu" id="articles"> <a href="#">Articles</a>

        </li>
    </ul>
    <li class="mainmenu" id="contactus"><a href="#">Contact Us</a>
    </li>
</ul> 
```

现在我想对主菜单和子菜单使用相同的功能。

```
$("#menu li").click(Menu_function); 
```

我的问题是，当我单击子菜单时，变量 $(this) 有两个值。一个用于子菜单内的 li，一个用于主菜单的 li。

现在我想在我的函数中做这样的事情：

```
var currentId = $(this).attr('id'); 
```

我怎么能只得到一个值？

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:35:54.037

您可以使用“每个”选择器将点击功能添加到这两个项目：

```
$('#menu li').each( function(index) {
    $(this).click( function() {
      var id = $(this).attr('id');

      // do whatever you need to here
    });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:35:02.723

你会想要

```
$('#menu').click(function(evt) {
  var currentId = $(evt.target).closest('li').attr('id');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:39:50.137

您可以使用jquery 的[每种](http://api.jquery.com/jQuery.each/)方法来遍历它们并在它们上添加 onclick。类似于 dcp 在他的回答中提到的内容：

```
$('#menu li').each( function() {
    // add click method on this element ($(this))
    $(this).click( function() {
    });
}); 
```

# zend-framework2 - zend 框架 2 (zfcadmin) 和路由

> ID：15165415
> 
> 赞同：0
> 
> 时间：2013-03-01T19:32:22.443
> 
> 标签：zend-framework2

我想使用 ZfcAdmin 模块创建管理面板。我想创建路由，管理用户。就这个：

```
<?php
    return array(
        'controllers' => array(
            'invokables' => array(
                'AdminUser\Controller\AdminUser' => 'AdminUser\Controller\AdminUserController',
            ),
        ),
        'view_manager' => array(
            'template_path_stack' => array(
                'admin-user' => __DIR__ . '/../view',
            ),
        ),

        'router' => array(
            'routes' => array(
                'zfcadmin' => array(
                    'may_terminate' => true,
                    'child_routes' => array(
                        'user' => array(
                            'type' => 'segment',
                            'options' => array(
                                'route' => '/user',
                                'defaults' => array(
                                    'controller' => 'AdminUser\Controller\AdminUser',
                                    'action'     => 'index',
                                ),
                            ),
                            'may_terminate' => true,
                            'child_routes' =>array(
                                'edit' => array(
                                    'type' => 'segment',
                                    'options' => array(
                                        'route' => '/edit/:user_id',
                                        'defaults' => array(
                                            'controller' => 'AdminUser\Controller\AdminUser',
                                            'action'     => 'edit',
                                        ),
                                    ),
                                ),
                            ),
                        ),
                    ),
                ),
            ),
        ),
    ); 
```

我请求：`/admin/user`没关系，但是当我想接收如下 URL 时：`/admin/user/edit/1`我总是`/admin/user`这样创建链接：

`<?php $this->url('zfcadmin/user/edit', array( 'action' => 'edit', 'user_id' => $user['user_id'], )) ?>`

为什么？怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:06:06.743

[ZF2 Url 视图助手](https://packages.zendframework.com/docs/latest/manual/en/modules/zend.view.helpers.html#url-helper)中的第一个参数是`$name`. 您是否尝试过`'edit'`像您在配置中指定的那样使用？

我也认为您可能需要`echo`该值。

```
<?php echo $this->url('edit', array('action' => 'edit', 'user_id' => $user['user_id'],)); ?> 
```

# c++ - C++ 符号扩展

> ID：15165417
> 
> 赞同：1
> 
> 时间：2013-03-01T19:32:26.350
> 
> 标签：c++

我正在处理一个家庭作业问题，从二进制文件打印。我搜索并发现我的问题是符号扩展问题。

在 c 中，正确的操作是强制转换为 (unsigned char)

我已经尝试过这个解决方案，但它不适用于 cout

带有（无符号）的输出是：

```
4D 5A FFFFFF90 00 03 00 00 00 04 00 00 00 FFFFFFFF FFFFFFFF 00 00 
```

(unsigned char) 的输出是：

```
0M 0Z 0ê 0� 0 0� 0� 0� 0 0� 0� 0� 0ˇ 0ˇ 0� 0� 
```

任何指导都是最有帮助的；

这是代码：

```
void ListHex(ifstream &inFile)
{
    // declare variables
    char buf[NUMCHAR];
    unsigned char bchar;

    while(!inFile.eof())
    {
       inFile.read(buf,NUMCHAR);
       for (int count = 0; count < inFile.gcount(); ++count)
       {

        cout << setfill('0') << setw(2) << uppercase << hex << 
           (unsigned)buf[count] << ' ';
       }
       cout << '\n';
   }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:35:41.337

怎么样`cout <<setfill('0') << setw(2) << uppercase << hex << (0xFF & buf[count])`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:35:24.237

```
void ListHex(std::istream& inFile) {
    // declare variables
    char c;
    while(inFile >> c) {
        std::cout << std::setw(2) << std::hex 
                  << static_cast<int>(c);
    }
} 
```

我建议逐个字符地执行此操作，原因是在处理 rinterpretive int 转换时，我什至不想考虑各种字节序问题。无论如何，`std::ifstream`它将为您缓冲字符（您的操作系统也可能如此）。

请注意我们如何接收文件流，因为`std::istream`它允许我们传入任何类型的`istream`include和.`std::istringstream``std::cin``std::ifstream`

例如：

```
 ListHex(std::cin); 

 std::istringstream iss("hello world!");
 ListHex(iss); 
```

将十六进制您的用户输入。

# 编辑

使用缓冲区

```
void ListHex(std::istream& inFile) {
    // declare variables

    char arr[NUMCHAR];

    while(inFile.read(arr, NUMCHAR)) {
        for(std::size_t i=0; i!=NUMCHAR; ++i) {
            std::cout << std::setw(2) << std::hex 
                      << static_cast<int>(arr[i]);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:38:29.443

您可以通过屏蔽高位来摆脱符号扩展：

```
(((unsigned) buf[count)) & 0xff) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T19:43:13.717

std::cout 将 unsigned char 打印为字符，而不是整数。您可以在这里执行两次演员表 - 类似于以下内容：

```
static_cast <int> (static_cast <unsigned char> (buf[count])) 
```

或者，使用 unsigned char 缓冲区和单个强制转换：

```
void ListHext(ifstream& inFile)
{
    unsigned char buf[NUMCHAR];
    while (inFile.read(reinterpret_cast <char*> (&buf[0]), NUMCHAR))
    {
        for (int i=0; i < NUMCHAR; ++i)
            cout << ... << static_cast <int> (buf[i]) << ' ';
        cout << endl;
    }
} 
```

编辑：此处不应使用掩码，因为它假定特定的字符大小。以下仅在 CHAR_BIT 为 8 时等效：

```
// bad examples
x & 0xFF // note - implicit int conversion
static_cast <int> (x) & 0xFF // note - explicit int conversion

// good example
static_cast <int> (static_cast <unsigned char> (x)) 
```

# javascript - 页面加载时如何为按钮设置ASCII码

> ID：15165418
> 
> 赞同：1
> 
> 时间：2013-03-01T19:32:27.770
> 
> 标签：javascript, html

我正在用 HTML 设计棋盘。`&#9814`是显示白车的代码。我正在尝试在页面加载时设置值并将其显示为字符串，但 ROOK 没有出现在按钮上

```
function load() {
    document.getElementById('A1').value="&#9814";
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:50:21.703

```
 function load() {
    document.getElementById('A1').innerHTML="&#9814;";
 } 
```

[http://jsfiddle.net/RM5VD/2/](http://jsfiddle.net/RM5VD/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:08:13.310

符号`&#9814`or`&#9814;`在 JavaScript 中没有特殊含义；它们只是字符串，尽管这些字符串可以分配给`innerHTML`属性，从而导致 HTML 解析。

最简单的方法是在 JavaScript 中使用 Unicode 字符来插入它，尽管这需要合适的编辑器和使用 UTF-8 字符编码。例子：

```
document.getElementById('A1').value = '♖'; 
```

下一个最简单的是使用*JavaScript*转义符号，即`\u`紧跟四个十六进制数字。由于 WHITE CHESS ROOK 是 U+2656（十六进制 2656 = 十进制 9815），你可以这样使用：

```
document.getElementById('A1').value="\u2656"; 
```

`value`仅当修改的元素具有符合HTML 规范的属性时，这才有意义。例如，`<input type=button>`有，但`button`没有。但这只会影响分配的左手，即您将字符串分配给什么。

请注意，像这样的棋子字符的[字体支持是相当有限的。](http://www.fileformat.info/info/unicode/char/2656/fontsupport.htm)此外，浏览器可能对按钮中使用的字体有自己的想法。在实践中，您可能应该使用一些可下载的字体。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:50:44.377

您需要像这样重写函数：

```
function load() {
    document.getElementById('A1').value=String.fromCharCode(9814);
} 
```

目前尚不清楚您正在修改哪种元素，但您可能需要根据您的情况修改`innerHTML`而不是修改。`value`

您拥有它的方式是将文本作为文字字符串传递，而不是单个字符的表示。

[jsFiddle 示例](http://jsfiddle.net/vKPJn/1/)

# c# - 从离散傅里叶变换数组中获取结果

> ID：15165422
> 
> 赞同：0
> 
> 时间：2013-03-01T19:32:51.093
> 
> 标签：c#, dft

我刚刚写了dft的实现。这是我的代码：

```
 int T = 2205;

        float[] sign = new float[T]; 
        for (int i = 0, j = 0; i < T; i++, j++)
            sign[i] = (float)Math.Sin(2.0f * Math.PI * 120.0f * i/ 44100.0f);

        float[] re = new float[T];
        float[] im = new float[T];
        float[] dft = new float[T];

        for (int k = 0; k < T; k++)
        {
            for (int n = 0; n < T; n++)
            {
                re[k] += sign[n] * (float)Math.Cos(2.0f* Math.PI * k * n / T);
                im[k] += sign[n] * (float)Math.Sin(2.0f* Math.PI * k * n / T);;
            }
            dft[k] = (float)Math.Sqrt(re[k] * re[k] + im[k] * im[k]);
        } 
```

所以采样频率是 44100 Hz，我有一个 120Hz 正弦波的 50ms 段。根据结果​​，我在 pont 7 和 2200 处有一个 dft 函数的峰值。我做错了什么，如果没有，我应该如何解释结果？

* * *

我尝试了AFORGE的FFT方法。这是我的代码。

```
 int T = 2048;

        float[] sign = new float[T];
        AForge.Math.Complex[] input = new AForge.Math.Complex[T];
        for (int i = 0; i < T; i++)
        {
            sign[i] = (float)Math.Sin(2.0f * Math.PI * 125.0f * i / 44100.0f);
            input[i].Re = sign[i];
            input[i].Im = 0.0;
        }

        AForge.Math.FourierTransform.FFT(input, AForge.Math.FourierTransform.Direction.Forward);
        AForge.Math.FourierTransform.FFT(input, AForge.Math.FourierTransform.Direction.Backward); 
```

我曾期望得到原始符号，但我得到了一些不同的东西（一个只有正值的函数）。这正常吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:07:44.503

您的代码看起来正确，但它可能更有效，DFT 通常由 FFT 算法解决（快速傅立叶变换，它不是一种新的变换，它只是一种以更有效的方式解决 DFT 的算法）。

即使您不想实现 FFT（这有点难以理解，并且更难使其适用于非 形式的数据`2^n`）或使用一些开源代码，您也可以使您的实现速度更快例如，通过看到它是内部循环外部的常数，因此您可以为每个 k 计算一次（将其移到内部循环外部），然后在函数中将`2.0f * Math.PI * K / T`其乘以。`n``cos/sin`

至于位置和解释，你已经改变了你的域，现在你的 X 轴，它是表中数据的索引，对应的不是时间而是频率。您有采样`44100Hz`并且您已经捕获了`2205`样本，这意味着每 1 个样本代表频率等于 的输入信号的幅度`44100Hz / 2205 = 20Hz`。您的幅度峰值位于第 7 点（索引 6），因为您的信号为 120Hz，所以`6 * 20Hz = 120Hz`这是您所期望的。

秒峰值似乎代表了一些高频，但这只是一个杂散信号，因为您的采样率是`44100Hz`您无法测量高于`44100Hz / 2`（奈奎斯特定律）的频率，如果您设置截止点，那么在该频率之后 DFT 数据无效。这就是为什么，你的桌子的后半部分是无效的，它基本上是你的前半部分，但是被镜像了，你可以忽略它。

**编辑**//从您的问题中我可以看出您对音频处理感兴趣，您可能想要谷歌 NForge.Net 库，这是一个很棒的音频和视觉处理开源库，它的作者在[codeproject.com](http://codeproject.com)上有很多关于它的许多功能。

# linq - NHibernate 中带有时间戳列比较的 LINQ 查询

> ID：15165423
> 
> 赞同：0
> 
> 时间：2013-03-01T19:32:52.217
> 
> 标签：linq, postgresql, nhibernate, fluent-nhibernate

我正在使用 Fluent NHibernate 的自动映射，并使用以下代码来确保 NHibernate 不会剥离毫秒：

```
public class TimestampTypeConvention : IPropertyConvention, IPropertyConventionAcceptance
{
    public void Accept(IAcceptanceCriteria<IPropertyInspector> criteria)
    {
        criteria.Expect(x => x.Type == typeof(DateTime) || x.Type == typeof(DateTimeOffset));
    }

    public void Apply(IPropertyInstance instance)
    {
        instance.CustomType<TimestampType>();
    }
} 
```

这工作得很好，因此数据正确地存储在数据库中。

但是，当我运行以下 LINQ 查询时，我没有得到预期的匹配：

```
bool isDuplicate = session.Query<TagData>()
                          .Any(x => x.TagName == message.EventTag.TagName
                               && x.TimeStamp == message.EventTag.TimeStamp.UtcDateTime); 
```

生成的 SQL 如下所示，并解释了为什么这不起作用：

```
select tagdata0_."Id" as column1_0_, tagdata0_."TagName" as column2_0_,
tagdata0_."TimeStamp" as column3_0_, tagdata0_."Value" as column4_0_,
tagdata0_."QualityTimeStamp" as column5_0_, tagdata0_."QualitySubstatus" as column6_0_,
tagdata0_."QualityExtendedSubstatus" as column7_0_, tagdata0_."QualityLimit" as column8_0_,
tagdata0_."QualityDataSourceError" as column9_0_, tagdata0_."QualityTagStatus" as column10_0_,
tagdata0_."TagType" as column11_0_ from "TagData" tagdata0_
where tagdata0_."TagName"=:p0 and tagdata0_."TimeStamp"=:p1 limit 1;
:p0 = 'VALVE_HW_CMD' [Type: String (0)],
:p1 = 01.03.2013 16:51:30 [Type: DateTime (0)] 
```

如何强制生成的查询使用完整精度？

顺便说一句，`message.EventTag.TimeStamp`是一个`DateTimeOffset`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T11:25:54.477

我被日志输出愚弄了：实际的 SQL（取自 PostgreSQL 日志文件）如下所示：

```
SELECT this_."Id" as column1_0_0_, this_."TagName" as column2_0_0_,
this_."TimeStamp" as column3_0_0_, this_."Value" as column4_0_0_,
this_."QualityTimeStamp" as column5_0_0_, this_."QualitySubstatus" as column6_0_0_,
this_."QualityExtendedSubstatus" as column7_0_0_, this_."QualityLimit" as column8_0_0_,
this_."QualityDataSourceError" as column9_0_0_, this_."QualityTagStatus" as column10_0_0_,
this_."TagType" as column11_0_0_ FROM "TagData" this_
WHERE this_."TimeStamp" = ((E'2013-03-01 16:51:30.509498')::timestamp) 
```

这就是它没有按预期工作的真正原因：`timestamp`PostgreSQL 中的列只有微秒精度，而`DateTimeDiff`这里的值为 16:51:30.5094984，这意味着 1/10 微秒精度。保持完整准确性的唯一方法似乎是将刻度存储在数据库中。

（让我感到困惑的另一个原因是我在不同线程上或多或少同时收到来自 MassTransit 的重复消息，因此检查数据库中的重复消息当然并不总是有效。哦，多线程的奇迹！）

# php - 为什么php变量范围在函数中不起作用

> ID：15165427
> 
> 赞同：0
> 
> 时间：2013-03-01T19:33:16.000
> 
> 标签：php

我执行了以下代码，但 php 说：

```
Notice: Undefined variable: b in ..\..\..\demo.php on line 4 
Notice: Undefined variable: a in ..\..\..\demo.php on line 4 
```

php代码：

```
<?php
  $a='a';$b='b';
  function test(){
      echo $a.$b;
  }
  test(); // error
?> 
```

但我将代码更改为：

```
<?php
  $a='a';$b='b';
  function test($a,$b){
      echo $a.$b;
  }
  test($a,$b); // ab
?> 
```

为什么`$a`和`$b`在第一种情况下是未定义的，因为我之前定义了它们？为什么参数需要传入php？其他类似的不需要`JavaScript`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:34:49.163

如果变量是在函数外部定义的，则需要指定`global`关键字。如：

```
<?php
$a='a';$b='b';
function test(){
    global $a, $b;
    echo $a.$b;
}
test(); // error
?> 
```

但是您的第二个示例通常是推荐的处理方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:35:02.253

您提供的第一个示例中的 $a 和 $b 分别尝试从本地范围而不是全局范围访问这些变量。您可以尝试像这样声明它们

```
 function test() {
     global $a, $b;
     echo $a . $b; //or $GLOBALS['a'].$GLOBALS['b'];
 } 
```

你会得到正确的值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:51:10.910

尝试这个

```
$a = '101';
$func = function() use($a) {
    echo $a;
};

function func_2() {
    global $func;
    $a = 'not previouse a';
    $func();
}

func_2(); 
```

# sql - 如何只为表格中的每家公司获得一个结果？

> ID：15165431
> 
> 赞同：0
> 
> 时间：2013-03-01T19:33:30.463
> 
> 标签：sql, sql-server-2008

我有查询，但现在我需要将查询更改为数据库，以便只为表中的每个公司获取一个结果`Price`。

为此，我添加`GROUP by p.id_firm`了行，然后得到下一个查询：

```
SELECT TOP 20 
  p.id_price as p_id_price, 
  p.id_service as p_id_service, 
  p.name as p_name, 
  p.name_original as p_name_original, 
  p.id_producer_country as p_id_producer_country, 
  p.id_firm as p_id_firm, 
  f.name as f_name, 
  f.address as f_address, 
  f.phone as f_phone, 
  city.name as city_name, 
  pc.name as pc_name 
FROM Price p 
left join Firm f 
  on f.id_service=p.id_service 
  AND f.id_city=p.id_city 
  AND f.id_firm=p.id_firm 
left join City city 
  on city.id_city = p.id_city 
left join Producer_country pc 
  on pc.id_producer_country = p.id_producer_country 
WHERE p.id_city='73041' 
  AND p.include='1' 
  AND p.blocked='0' 
  AND f.blocked='0' 
  AND ( f.name LIKE 'Окно%' COLLATE SQL_Latin1_General_Cp1251_CI_AS OR p.name LIKE 'Окно%' COLLATE SQL_Latin1_General_Cp1251_CI_AS ) 
GROUP by p.id_firm ORDER BY p.name ASC 
```

但是如果我使用它，我会得到错误：

> 消息 8120，级别 16，状态 1，第 2 行列“Price.id_price”在选择列表中无效，因为它既不包含在聚合函数中，也不包含在 GROUP BY 子句中。

*请告诉我更改此查询或进行其他查询的正确方法？*

**结构化您可以[在此处看到的所有表格](http://sqlfiddle.com/#!3/fad4d1)**

PS：抱歉不准确。按公司名称和产品名称搜索。如果搜索词包含在产品名称或公司名称中，并且有一些结果具有相同的 id_firm，则需要选择一个最合适的值，即结果搜索中的 id_firm 应该是唯一的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T23:11:25.903

使用[`ROW_NUMBER()`](http://msdn.microsoft.com/en-us/library/ms186734.aspx "ROW_NUMBER (Transact-SQL)")而不是分组。

分别编号每个公司的行。对 的行进行排序时`ROW_NUMBER()`，使用`p.name LIKE 'Окно%'`条件将具有匹配产品的行放在其他行之前。

这是一个示例：

```
;
WITH ranked AS (
  SELECT
    p.id_price as p_id_price, 
    p.id_service as p_id_service, 
    p.name as p_name, 
    p.name_original as p_name_original, 
    p.id_producer_country as p_id_producer_country, 
    p.id_firm as p_id_firm, 
    f.name as f_name, 
    f.address as f_address, 
    f.phone as f_phone, 
    city.name as city_name, 
    pc.name as pc_name,
    ROW_NUMBER() OVER (
      PARTITION BY p.id_firm
      ORDER BY
        CASE  -- this criterion puts matching products before non-matching ones
          WHEN p.name LIKE 'Окно%' COLLATE SQL_Latin1_General_Cp1251_CI_AS
          THEN 1 ELSE 2
        END,
        p.id_price  -- you may use any sorting criteria at this point,
                    -- just ensure it makes the results predictable
    ) AS rnk
  FROM Price p 
  left join Firm f 
    on f.id_service=p.id_service 
    AND f.id_city=p.id_city 
    AND f.id_firm=p.id_firm 
  left join City city 
    on city.id_city = p.id_city 
  left join Producer_country pc 
    on pc.id_producer_country = p.id_producer_country 
  WHERE p.id_city='73041' 
    AND p.include='1' 
    AND p.blocked='0' 
    AND f.blocked='0' 
    AND ( f.name LIKE 'Окно%' COLLATE SQL_Latin1_General_Cp1251_CI_AS
       OR p.name LIKE 'Окно%' COLLATE SQL_Latin1_General_Cp1251_CI_AS ) 
)
SELECT TOP 20
  p_id_price, 
  p_id_service, 
  p_name, 
  p_name_original, 
  p_id_producer_country, 
  p_id_firm, 
  f_name, 
  f_address, 
  f_phone, 
  city_name, 
  pc_name
FROM ranked
WHERE rnk = 1
-- the absence of ORDER BY makes your TOP 20 results indeterminate
; 
```

基本上，这对每个公司的行进行排名，然后仅从`1`所有公司中提取具有排名的行，最终使每个公司一行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T01:30:40.830

您可以尝试选择 Distinct 以获得可能的快速修复 [http://www.w3schools.com/sql/sql_distinct.asp](http://www.w3schools.com/sql/sql_distinct.asp)

# javascript - 如何编写一个带有美化、语法高亮的 JSON 结果的 HTML JSON AJAX 测试工具？

> ID：15165434
> 
> 赞同：1
> 
> 时间：2013-03-01T19:34:01.137
> 
> 标签：javascript, jquery, html, json, prettify

我已经编写了一个 JSON API，但我不会处理视图。

如何使用带有**美化、语法突出显示的 JSON 结果**的简单网页来测试 JSON API ？

让我们以以下 GET API 调用为例：

[http://www.google.com/calendar/feeds/developer-calendar@google.com/public/full?alt=json](http://www.google.com/calendar/feeds/developer-calendar@google.com/public/full?alt=json)

注意：这个问题是指导性的，将提供答案。我搜索并没有找到类似的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:34:01.137

这是带有内嵌 javascript 的整个 HTML 文件。

我在解决方案中使用了 jQuery 和[highlight.js](http://softwaremaniacs.org/soft/highlight/en/)。

我在 Chrome 上运行了结果，我不相信它在 IE 中正常工作。

```
<!DOCTYPE html>
<html>
<head>
    <title></title>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/highlight.min.js"></script>
    <link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/7.3/styles/default.min.css" />

    <script>
    $(document).ready(function() {
        hljs.initHighlightingOnLoad();
        $.ajax({
            url: "http://www.google.com/calendar/feeds/developer-calendar@google.com/public/full",
            dataType: "json",
            //contentType: "application/json; charset=utf-8", // NOTE: use this parameter when calling your host server, but doesn't work with this google api
            type: "GET",
            data : { alt: "json" },
            complete: function(xhr, textStatus) {
                // set status
                $("#status").html(textStatus);

                // set plaintext
                $("#result").val(xhr.responseText);

                // set prettytext
                var data = JSON.parse(xhr.responseText);
                var stringify = JSON.stringify(data, undefined, 2);
                var prettify = hljs.highlightAuto(stringify).value;
                prettify = hljs.fixMarkup(prettify);
                $("#prettyResult").html(prettify);
            }
        });
    });
    </script>

</head>
<body>
    <tt>Status: <span id="status">waiting ...</span></tt><br /><br />
    <textarea id="result" style="width: 1024px; height: 100px;"></textarea>
    <pre><code id="prettyResult" class="json" style="width: 1024px;"></code></pre>

</body>
</html> 
```

# forms - 使用 C++ 关闭表单时出错

> ID：15165437
> 
> 赞同：0
> 
> 时间：2013-03-01T19:34:11.127
> 
> 标签：forms, c++-cli

我在关闭 C++ 表单时遇到了麻烦（我已经使用它多年了）。我创建了表单 (form_options.h)，它显示得很好，没有任何控件中的代码。

但是，我的第一个手动编码（在单击“取消”时关闭表单在编译项目时会引发错误 -

> 错误 C2039：“关闭”：不是“MusicRenaming::form_options”的成员

这是有问题的代码 -

```
 private: System::Void btnCancel_Click(System::Object^  sender, System::EventArgs^  e) {
     this->close();
 } 
```

我似乎记得这就是我关闭表单所要做的一切，但错误似乎表明我需要实际编写一个关闭函数？如果是这种情况，我可以就如何关闭表单获得一些帮助吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:36:36.203

`close`应该是`Close`大写的“C”。

# php - 为什么 php 中的某些 DateTime 对象需要 @ 符号

> ID：15165438
> 
> 赞同：6
> 
> 时间：2013-03-01T19:34:12.860
> 
> 标签：php, datetime

创建具有 unix 时间戳的 DateTime 对象时，为什么需要在时间戳之前添加一个“@”符号？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T19:40:46.460

据我所知，可以从其他有效格式中识别时间戳。

[http://www.php.net/manual/en/datetime.formats.php](http://www.php.net/manual/en/datetime.formats.php)

unix 时间戳属于复合格式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-06-18T14:35:39.357

自从提出问题以来已经很长时间了，但是如果有人仍在寻找答案并落在这个问题上。然后就是这样。

### 使用“@”符号

```
echo date("dS M Y \\@\\ g:ia");
// 18th Jun 2020 @ 4:20pm 
```

### 使用“at”文本

```
echo date("dS M Y \\a\\t g:ia");
// 18th Jun 2020 at 4:20pm 
```

### 使用“和”文本

```
echo date("dS M Y \\a\\n\\d g:ia");
// 18th Jun 2020 and 4:20pm 
```

# c++ - 在异步模式下使用会话的 cppcms 示例

> ID：15165444
> 
> 赞同：0
> 
> 时间：2013-03-01T19:34:28.480
> 
> 标签：c++, session, asynchronous, cppcms

cppcms 网站不包含有关在异步模式下使用会话的示例。如何使用 cppcms 创建异步会话管理系统？

**稍后添加：** 我使用此代码保存会话：

```
session()["name"] = ...
session().save(); 
```

我把这个放在某个地方：

```
if(!session().load() || !session().is_set("name"))
    std::cerr<<"error"; 
```

当我运行程序时，它显示错误。这是我的配置文件（会话部分）：

```
"expire": "renew",
"timeout": 604800,
"location": "both",
"client" : {
    "hmac": "sha1",
    "hmac_key": "...",
},
"server":{
    "storage": "files"
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T04:54:19.980

默认情况下，会话配置被禁用。请先启用它。请参阅以下内容以供参考。[http://cppcms.com/wikipp/en/page/cppcms_1x_config#session](http://cppcms.com/wikipp/en/page/cppcms_1x_config#session)。配置会话后。其余的和我之前说的一样。会话管理在此处进行了详细描述。[http://cppcms.com/wikipp/en/page/secure_programming](http://cppcms.com/wikipp/en/page/secure_programming)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:56:08.193

请参阅标题为“现在让我们创建我们的主要异步函数”的部分，它确实提供了会话并将套接字绑定到会话。 [http://cppcms.com/wikipp/en/page/cppcms_1x_aio](http://cppcms.com/wikipp/en/page/cppcms_1x_aio)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T20:18:38.397

只需阅读手册：

[http://cppcms.com/cppcms_ref/latest/classcppcms_1_1session__interface.html#ae63e68dd2ec1d615f5a6a85bcee36605](http://cppcms.com/cppcms_ref/latest/classcppcms_1_1session__interface.html#ae63e68dd2ec1d615f5a6a85bcee36605)

您需要`session().load()`在使用会话对象之前调用。

# ios - 解除视图控制器无法正常工作

> ID：15165446
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:34:32.520
> 
> 标签：ios, cocoa-touch, uiviewcontroller

下面是我的导航控制器的层次结构

```
MainViewController
      |
      |
      DetailViewController 
```

然后我在 DetailViewController 上执行以下操作

```
[self presentViewController:reminderController animated:YES completion:nil]; 
```

导航到 ReminderViewController 后，有时我会这样做

```
[self dismissViewControllerAnimated:YES completion:nil]; 
```

但是，它让我回到 MainViewController 而不是 DetailViewController

这很奇怪。关于这个问题的任何想法......

编辑：

我`presentViewController: reminderController animated: completion:`在 DetailViewController 上做的原因是因为提醒控制器用于发送提醒。就像 goole 应用程序或其他应用程序一样，在发送 sth 时，我们使用的是 presentViewController。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:48:16.660

以下是有关`UIViewController`该类的文档示例：

> 呈现视图控制器负责关闭它呈现的视图控制器。如果您在呈现的视图控制器本身上调用此方法，它会自动将消息转发到呈现的视图控制器。
> 
> 如果您连续呈现多个视图控制器，从而构建一个呈现视图控制器的堆栈，则在堆栈中较低的视图控制器上调用此方法会解除其直接子视图控制器以及堆栈上该子视图控制器上方的所有视图控制器。发生这种情况时，只有最顶层的视图会以动画方式消失；任何中间视图控制器都简单地从堆栈中删除。最顶层的视图使用其模态转换样式被解除，这可能与堆栈中其他视图控制器使用的样式不同。

因此，我认为您应该首先使用 segue 来推送您的`DetailViewController`，然后呈现`reminderController`模态，您以后可以在不关闭的`dismissViewControllerAnimated:completion:`情况下关闭它`DetailViewController`。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-01T19:39:42.040

而不是使用`dismissViewController:animated:`使用

```
[self.navigationController popViewControllerAnimated:YES]; 
```

`dismissViewController:animated`删除其中的所有`UIViewController`s。

如果您阅读 UIViewController 和 UINavigationController 参考资料，您会省去很多麻烦。两次;)

有关更多详细信息，请参阅[此帖子](https://stackoverflow.com/questions/9375191/navigating-back-to-main-viewcontroller-dismissviewcontrolleranimated-dilemma)。

# ruby-on-rails - 安装设计后未定义的方法“视图”

> ID：15165448
> 
> 赞同：1
> 
> 时间：2013-03-01T19:34:34.830
> 
> 标签：ruby-on-rails, ruby, gem

我收到此错误：

`method_missing': undefined method`观看次数为 #

当试图运行'-> rails generate devise user'

我也只是尝试做'-> rails s'来启动服务器，但它不工作并且显示相同的错误。我对 RoR 完全陌生，在学习本教程时可能会搞砸一些事情......

请帮忙！

编辑：完全错误：

```
 /Users/myname/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/railtie/configurable.rb:30:in `method_missing': undefined method `views' for #<FirstApp::Application:0x007fd0a1b02880> (NoMethodError)
from /Users/myname/Desktop/rails-projects/First_App/config/application.rb:61:in `<class:Application>'
from /Users/myname/Desktop/rails-projects/First_App/config/application.rb:13:in `<module:FirstApp>'
from /Users/myname/Desktop/rails-projects/First_App/config/application.rb:12:in `<top (required)>'
from /Users/myname/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:53:in `require'
from /Users/myname/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:53:in `block in <top (required)>'
from /Users/myname/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:50:in `tap'
from /Users/myname/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.9/lib/rails/commands.rb:50:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

谢谢 ：）

# android - 我应该使用 PopupWindow 或 DialogFragment 来接受输入吗？

> ID：15165454
> 
> 赞同：19
> 
> 时间：2013-03-01T19:34:47.343
> 
> 标签：android, android-dialogfragment, android-popupwindow

我正在做一个带有 3 个 Spinners 和一个 EditText的**弹出窗口。**在阅读了许多博客和文章后，我无法决定哪个是最佳选择，**PopupWindow**或**DialogFragment**。

标准是：

1.  **与不同Android版本的**兼容性****
***   **表现****

 **如果有更好的方法可以做到这一点，我愿意改变观点。

非常感谢你。

***对话片段：***

*   优点：
*   缺点：

***弹出窗口：***

*   优点：
*   缺点：

* * *

**编辑：结论**

**DialogFragment**允许您使用更复杂的功能。另一个重要的事情是它对平板电脑更友好，因为它允许用户一次打开多个片段。片段是一种更动态的解决方案，它们是较新 Android 版本的标准。

**PopupWindow**更简单，对用户的简单问题非常有帮助。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-01T19:41:42.980

支持库可以为您提供`DialogFragment`与旧版本的 android 兼容的库。继续使用片段对话框，因为您要问的内容非常具体（3 个微调器和一个编辑文本。只需右键单击您的项目并按“Android 工具”->“添加支持库”确保使用对话框时进口

```
import android.support.v4.app.DialogFragment; 
```

否则，您最终将在没有支持的情况下使用该对话框：P。对话框片段和使用您认为合适的视图（甚至是您自己制作的布局）的能力将更加灵活，而无需付出太多努力。

对话片段

优点：

*   能够添加任何视图
*   易于编辑
*   只需修改布局即可横向或纵向适应平板电脑或手机
*   可以专门开设一个全新的课程，以按照您的方式进行修改

缺点：

*   占用更多内存，您的视图越复杂
*   更难编码

弹出窗口：

优点：

*   更简单
*   更容易编码
*   它更标准，因此用户更难混淆

缺点：

*   更简单，这意味着对它的控制更少
*   仅限于几个模板

这些只是我的想法和经验，但你应该阅读文档

[http://developer.android.com/reference/android/widget/PopupWindow.html](http://developer.android.com/reference/android/widget/PopupWindow.html)

[http://developer.android.com/reference/android/app/DialogFragment.html](http://developer.android.com/reference/android/app/DialogFragment.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-11-27T18:12:54.533

如果您需要在窗口中使用 EditText 并希望您的用户能够长按并粘贴（编辑文本的正常行为），那么不要使用 popupwindow，我发现它很难，所以：

popupwindow 上的一个非常大的**缺点**是，长按编辑文本不会带来默认的上下文菜单（复制/粘贴/全选，...）。在某些设备中也有一些报告，这实际上会导致应用程序崩溃。看到这个 [https://code.google.com/p/android/issues/detail?id=62508](https://code.google.com/p/android/issues/detail?id=62508)**

# ruby - 当 input.file 具有动态 ID 时，如何附加文件？

> ID：15165455
> 
> 赞同：2
> 
> 时间：2013-03-01T19:34:47.310
> 
> 标签：ruby, file-upload, cucumber, capybara

我遇到了动态 ID 的障碍。attach_file 命令需要输入 type="file" 的 id 名称。问题是id是动态的

```
(id="document_22") #indicating the 22nd document uploaded to this section. 
```

有没有办法获取元素的id？就像是...

```
attach_file(find(:xpath, ".//input[@name='file_upload']").get('@id'),
'C:\\Users\\testbox\\Documents\\testdoc.xls') 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T19:53:20.697

[attach_file 在](http://rubydoc.info/github/jnicklas/capybara/master/Capybara/Node/Actions#attach_file-instance_method)内部只是将文件名传递给`Capybara::Node::Element#set`方法。

所以你可以使用：

```
find(:xpath, ".//input[@name='file_upload']").set(filename) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:49:26.850

您可以通过执行以下操作获取元素的属性：

```
element['attribute_name'] 
```

因此，对于您的示例，要获取名称为“file_upload”的输入的 id 属性，您可以执行以下操作：

```
find(:xpath, ".//input[@name='file_upload']")['id']
#=> "document_22" 
```

# sharepoint - 共享点更改内容类型下拉列表

> ID：15165460
> 
> 赞同：0
> 
> 时间：2013-03-01T19:35:06.000
> 
> 标签：sharepoint, sharepoint-2010, contenttype

## SharePoint 更改内容类型下拉

我已将应用程序页面附加到基于自定义文档的内容类型作为其编辑表单。该内容类型在附加了多个内容类型的文档库中使用。

SharePoint 表单字段控件正确呈现各个字段。**更改内容类型**控件还会在下拉列表中列出与列表相关的所有内容类型。但是当我更改选择时，意味着当我选择不同的内容类型时，表单不会显示所选内容类型的字段集，而是保持原样。

代码：

```
<%@ Assembly Name="$SharePoint.Project.AssemblyFullName$" %>
<%@ Import Namespace="Microsoft.SharePoint.ApplicationPages" %>
<%@ Register Tagprefix="SharePoint" Namespace="Microsoft.SharePoint.WebControls" Assembly="Microsoft.SharePoint, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register Tagprefix="Utilities" Namespace="Microsoft.SharePoint.Utilities" Assembly="Microsoft.SharePoint, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Register Tagprefix="asp" Namespace="System.Web.UI" Assembly="System.Web.Extensions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" %>
<%@ Import Namespace="Microsoft.SharePoint" %>
<%@ Assembly Name="Microsoft.Web.CommandUI, Version=15.0.0.0, Culture=neutral, PublicKeyToken=71e9bce111e9429c" %>
<%@ Page Language="C#" AutoEventWireup="true" CodeBehind="ApplicationPage1.aspx.cs" Inherits="DMS_POC.Layouts.DMS_POC.ApplicationPage1" DynamicMasterPageFile="~masterurl/default.master" %>
<%@ Register TagPrefix="wssuc" TagName="ToolBar" src="../../../_controltemplates/15/ToolBar.ascx" %>

<asp:Content ID="PageHead" ContentPlaceHolderID="PlaceHolderAdditionalPageHead" runat="server">

</asp:Content>

<asp:Content ID="Main" ContentPlaceHolderID="PlaceHolderMain" runat="server">
            <table>
            <tr>
                <td>
                    <span id='part1'>
                        <SharePoint:InformationBar ID="InformationBar1" runat="server" />
                        <div id="listFormToolBarTop">
                            <wssuc:ToolBar CssClass="ms-formtoolbar" id="toolBarTbltop" RightButtonSeparator="&amp;#160;" runat="server">
                                <template_rightbuttons>
                                    <SharePoint:NextPageButton ID="NextPageButton1" runat="server"/>
                                    <SharePoint:SaveButton ID="SaveButton1" runat="server"/>
                                    <SharePoint:GoBackButton ID="GoBackButton1" runat="server"/>
                                </template_rightbuttons>
                            </wssuc:ToolBar>
                        </div>

                        <SharePoint:ItemValidationFailedMessage ID="ItemValidationFailedMessage1" runat="server" />
                        <table class="ms-formtable" style="margin-top: 8px;" border="0" cellpadding="0" cellspacing="0" width="100%">
                            <SharePoint:ChangeContentType ID="ChangeContentType1" runat="server" />
                            <SharePoint:FolderFormFields ID="FolderFormFields1" runat="server" />

                            <tr>
                                <td>
                                    <SharePoint:FieldLabel ID="lbl_ProposalNumber" runat="server" FieldName="ProposalNo" />
                                </td>
                                <td>
                                    <SharePoint:FormField ID="field_ProposalNumber" runat="server" FieldName="ProposalNo"
                                        ControlMode="Display" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>

                            <tr>
                                <td>
                                    <SharePoint:FieldLabel ID="lbl_CustName" runat="server" FieldName="CustomerName" />
                                </td>
                                <td>
                                    <SharePoint:FormField ID="field_CustName" runat="server" FieldName="CustomerName"
                                        ControlMode="Edit" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>

                            <tr>
                                <td>
                                    <SharePoint:FieldLabel ID="lbl_ProposalType" runat="server" FieldName="ProposalType" />
                                </td>
                                <td>
                                    <SharePoint:FormField ID="field_ProposalType" runat="server" FieldName="ProposalType"
                                        ControlMode="Edit" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>

                            <tr>
                                <td>
                                    <SharePoint:FieldLabel ID="lbl_RevertBy" runat="server" FieldName="RevertBy" />
                                </td>
                                <td>
                                    <SharePoint:FormField ID="field_RevertBy" runat="server" FieldName="RevertBy"
                                        ControlMode="Edit" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>

                            <tr>
                                <td style="vertical-align:top">
                                    <SharePoint:FieldLabel ID="lbl_Details" runat="server" FieldName="Details" />
                                </td>
                                <td style="vertical-align:top">
                                    <SharePoint:FormField ID="field_Details" runat="server" FieldName="Details"
                                        ControlMode="Edit" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>

                            <tr>
                                <td>
                                    <SharePoint:FieldLabel ID="lbl_SignRequired" runat="server" FieldName="DigitalSignatureRequired" />
                                </td>
                                <td>
                                    <SharePoint:FormField ID="field_SignRequired" runat="server" FieldName="DigitalSignatureRequired"
                                        ControlMode="Edit" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>

                            <tr>
                                <td>
                                    <SharePoint:FieldLabel ID="lbl_Amount" runat="server" FieldName="Amount" />
                                </td>
                                <td>
                                    <SharePoint:FormField ID="field_Amount" runat="server" FieldName="Amount"
                                        ControlMode="Edit" />
                                </td>
                            </tr>

                            <tr>
                                <td colspan="2">&nbsp;</td>
                            </tr>

                            <tr>
                                <td>
                                    <SharePoint:FieldLabel ID="lbl_Final" runat="server" FieldName="Final" />
                                </td>
                                <td>
                                    <SharePoint:FormField ID="field_Final" runat="server" FieldName="Final"
                                        ControlMode="Edit" />
                                </td>
                            </tr>

                            <SharePoint:ApprovalStatus ID="ApprovalStatus1" runat="server" />
                            <SharePoint:FormComponent ID="FormComponent1" TemplateName="AttachmentRows" ComponentRequiresPostback="false" runat="server" />
                        </table>
                        <table cellpadding="0" cellspacing="0" width="100%" style="padding-top: 7px">
                            <tr>
                                <td width="100%">
                                    <SharePoint:ItemHiddenVersion ID="ItemHiddenVersion1" runat="server" />
                                    <SharePoint:ParentInformationField ID="ParentInformationField1" runat="server" />
                                    <SharePoint:InitContentType ID="InitContentType1" runat="server" />
                                    <wssuc:ToolBar CssClass="ms-formtoolbar" id="toolBarTbl" RightButtonSeparator="&amp;#160;" runat="server">
                                        <template_buttons>
                                    <SharePoint:CreatedModifiedInfo ID="CreatedModifiedInfo1" runat="server"/>
                                </template_buttons>
                                        <template_rightbuttons>
                                    <SharePoint:SaveButton ID="SaveButton2" runat="server"/>
                                    <SharePoint:GoBackButton ID="GoBackButton2" runat="server"/>
                                </template_rightbuttons>
                                    </wssuc:ToolBar>
                                </td>
                            </tr>
                        </table>
                    </span>
                </td>
                <td valign="top">
                    <SharePoint:DelegateControl ID="DelegateControl1" runat="server" ControlId="RelatedItemsPlaceHolder" />
                </td>
            </tr>
        </table>

</asp:Content>

<asp:Content ID="PageTitle" ContentPlaceHolderID="PlaceHolderPageTitle" runat="server">
Application Page
</asp:Content>

<asp:Content ID="PageTitleInTitleArea" ContentPlaceHolderID="PlaceHolderPageTitleInTitleArea" runat="server" >
My Application Page
</asp:Content> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-05T04:05:04.807

这是一个老问题，但在寻找其他东西时来到这里。如果您从未找到解决方案或其他人在这里结束，您需要做的是

在您的 aspx 中添加以下内容：

```
<tr><SharePoint:ListFieldIterator  runat="server" ID="ListFieldIterator1" ControlMode="Edit" ExcludeFields="FileLeafRef"/></tr> 
```

这将允许 ChangeContentType 控件根据内容类型刷新字段。您也不需要所有那些硬编码的表单字段，因为 ListFieldIterator 的目的是为您呈现带有正确控件的表单。

您的下一个问题可能是设置每个控件的值，假设这是您想要做的。对于每种控件类型，您必须查看控件并查找 TextBox 或 DropDownList 等控件。大多数情况下，控件将深入内部，例如 ((TextBox)control.Controls[1].Controls[0 ].Control[2]).Text 不是最优雅的方式，但这就是我能找到的所有方法。

如果您不需要映射值，那么我回答的第一部分就是您所需要的并且应该很容易做到。

祝你好运！

# php - 图像显示网站更适合过程式编程还是面向对象编程？

> ID：15165462
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:35:26.893
> 
> 标签：php

我有一个漫画网站[http://hittingtreeswithsticks.com](http://hittingtreeswithsticks.com)，我想我不清楚它是用哪种风格、程序或 OO 编写的。

基本上，有几个“模板”，homepage.php，viewall.php，viewFullSize.php，它们调用各种脚本......即模板都包括imageDisplay.php，它有几个脚本确定如何根据选择了哪个类别、标签或子网站。

我已经阅读了很多关于 OO 编程的好处的文章——什么时候使用它，什么时候不使用它……但我仍然无法回答这个问题。

从示例的角度来看，我理解 OOP 和过程之间的区别的方式是：

OOP：如果您有一个用户可以创建对象的网站，例如用户可以提交帖子的论坛......那么您会想要使用 OOP，因为您希望允许用户创建多个实例文章类。

程序：我选择了我认为是程序的，因为我的漫画网站只是向用户展示漫画。用户可以使用 DISQUS 或喜欢/不喜欢提交评论。我看不出在哪里可以将 OOP 范式放入一个简单的图像显示站点。

**所以，问题是：**

要使用 OOP，您是否一定需要有几个要实例化的对象？还是我缺少其他好处？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:36:46.687

**两者都**做。

只需将程序称为“方法”，或将您的方法称为“程序”。

对象不需要对应于现实世界的对象，它与模块化和将代码移动到隔离（！）块中一样多，就像关于“对象”一样。

总而言之，网站并不是最能理解 OOP 的。发生的继承太少。

相反，**编写一个模拟**。例如，一条可能有十字路口的道路，有几个司机在四处行驶。

从一个愚蠢的驱动程序开始，然后尝试允许使用不同的更聪明的驱动程序对其进行*子类化。*或激进的司机。看看它们是否会导致更多的交通拥堵。

试着从一个问题开始，你的自然物体*有很多共同的特征*，只有少数不同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:36:54.640

始终编​​码 OOP。人们编写程序 PHP 的唯一原因是因为他们使用的是 PHP 5 之前的版本。

要回答你的问题，不。你可以有一个对象。OOP 仅用于代码组织和 DRY 主体的实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:46:42.677

OO 通常是一种更好的方法，只要您正确记录并了解类依赖项/herance/hierarquy。

除了为您的代码添加一点安全性之外，正确实现的 OOP 对于添加和升级新功能、组织代码、重用逻辑非常强大。由于一切都在它的对象定义中，因此您始终知道要查找的位置和内容。

是的，有时有点棘手，但它是值得的。

非 OOP 仅在基本方法、小编码中是一种很好的做法。像“Hello world”这样的东西：p 或者内容的非服务器内容依赖，或者更广为人知的静态网站。

对于 OO，您不需要对象具有参数等定义。在您的情况下，您可以有一个用于 db 处理的对象，另一个用于顶部菜单栏，另一个用于处理与漫画书相关的东西，如排序、列表......基本上将所有内容包装在相应的位置，更有效地重用代码......

希望这有帮助

# c++ - Microsoft 访问的 DAO 代码适用于 Visual Studio 2008，但不适用于 Visual Studio 2012

> ID：15165463
> 
> 赞同：1
> 
> 时间：2013-03-01T19:35:27.573
> 
> 标签：c++, visual-studio, ms-access

我在 Visual Studio 2008 中下载并打开的示例项目中有以下代码行

```
_bstr_t bstrConnect = "PATH to MDB file";

int _tmain(int argc, _TCHAR* argv[]){
HRESULT hr = CoInitialize(NULL);
if (FAILED(hr))
{
    cout<<DAM<<": Failed to CoInitialize() COM."<<endl;
    return hr;
}

DAO::_DBEngine* pEngine = NULL;

hr = CoCreateInstance(
    __uuidof(DAO::DBEngine),
    NULL,
    CLSCTX_ALL,
    IID_IDispatch,
    (LPVOID*)&pEngine);
if (SUCCEEDED(hr) && pEngine)
{
    try
    {
        DAO::DatabasePtr pDbPtr = NULL;
        pDbPtr = pEngine->OpenDatabase(bstrConnect); 
```

此代码有效。然后我将一些非常相似的代码放入 Visual Studio 2012 项目中

```
_bstr_t bstrConnect = "PATH to MDB file";

int _tmain(int argc, _TCHAR* argv[]) {
HRESULT hr = CoInitializeEx(NULL, COINIT_MULTITHREADED);
if (FAILED(hr))
{
    cout<<"Failed to CoInitialize() COM."<<endl;
    cout << _com_error(hr).ErrorMessage() << endl;
    return hr;
}

DAO::_DBEngine* pEngine = NULL;

hr = CoCreateInstance(
    __uuidof(DAO::DBEngine),
    NULL,
    CLSCTX_ALL,
    IID_IDispatch,
    (LPVOID*)&pEngine);

if (SUCCEEDED(hr) && pEngine)
{
    try
    {
        DAO::DatabasePtr pDbPtr = NULL;
        pDbPtr = pEngine->OpenDatabase(bstrConnect); 
```

在 2012 版本中，当我调用 pEngine->OpenDatabase 时，我得到一个 System.AccessViolationException。我需要在 2012 代码中更改什么吗？我最初在 2012 版本中有 CoInitialize，但它一直返回错误，直到我切换到 CoInitializeEx。

# django - raise ImportError("无法导入设置，因为环境变量 %s 未定义

> ID：15165467
> 
> 赞同：3
> 
> 时间：2013-03-01T19:35:35.127
> 
> 标签：django, manage.py

Stack 上有几个关于这个错误的问题，但没有答案对我有帮助，奇怪的是，这个错误突然出现了，而之前一切正常。

我所做的是重新启动服务器，突然出现了这样的情况：

为什么在我没有更改任何内容的情况下突然出现此错误，我该如何解决？

```
Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/2.7/bin/django-admin.py", line 5, in <module>
    management.execute_from_command_line()
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/core/management/__init__.py", line 443, in execute_from_command_line
    utility.execute()
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/core/management/__init__.py", line 382, in execute
    self.fetch_command(subcommand).run_from_argv(self.argv)
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/core/management/__init__.py", line 261, in fetch_command
    klass = load_command_class(app_name, subcommand)
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/core/management/__init__.py", line 69, in load_command_class
    module = import_module('%s.management.commands.%s' % (app_name, name))
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/utils/importlib.py", line 35, in import_module
    __import__(name)
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/core/management/commands/runserver.py", line 8, in <module>
    from django.core.servers.basehttp import AdminMediaHandler, run, WSGIServerException, get_internal_wsgi_application
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/core/servers/basehttp.py", line 26, in <module>
    from django.views import static
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/views/static.py", line 95, in <module>
    template_translatable = ugettext_noop(u"Index of %(directory)s")
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/utils/translation/__init__.py", line 75, in gettext_noop
    return _trans.gettext_noop(message)
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/utils/translation/__init__.py", line 48, in __getattr__
    if settings.USE_I18N:
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/utils/functional.py", line 184, in inner
    self._setup()
  File "/Library/Python/2.7/site-packages/Django-1.4.5-py2.7.egg/django/conf/__init__.py", line 40, in _setup
    raise ImportError("Settings cannot be imported, because environment variable %s is undefined." % ENVIRONMENT_VARIABLE)
ImportError: Settings cannot be imported, because environment variable DJANGO_SETTINGS_MODULE is undefined. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:50:20.610

每当我打开一个新的 shell 时，我都会运行这个脚本：

```
export PYTHONPATH=$PYTHONPATH:/Users/cole/Projects/Sites/my_project.com/my_project
export DJANGO_SETTINGS_MODULE=my_project.settings 
```

更新：我稍微草率地编辑了脚本。所需要的只是：

```
export PYTHONPATH=$PYTHONPATH:/Path/To/Project/Root/Directory
export DJANGO_SETTINGS_MODULE=my_project.settings 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-17T08:27:20.500

转到 manage.py 可用的项目文件夹并运行：

> python manage.py 外壳

运行通过错误的 django 语句。（它应该在这里工作）

# ruby-on-rails - 到同一个控制器的多个嵌套路由。找不到没有 ID 的 XYZ

> ID：15165474
> 
> 赞同：1
> 
> 时间：2013-03-01T19:35:56.127
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, routes, nested-routes

我正在重构我的应用程序以在任何地方使用 1 级深度嵌套资源，它是一个仅限 JSON 的 API。这是我的精简版`routes.rb`：

```
resources :measurements, only: [:index, :show] do
  resource :tag_node, controller: :physical_nodes, only: [:show]
  resource :anchor_node, controller: :physical_nodes, only: [:show]
  resource :experiment, only: [:show]
end

resources :physical_nodes, only: [:index, :show] do
  resources :tag_nodes, controller: :measurements, only: [:index]
  resources :anchor_nodes, controller: :measurements, only: [:index]
end

resources :experiments, only: [:index, :show] do
  resources :measurements, only: [:index]
end 
```

我的修剪下来`models`：

```
class Measurement < ActiveRecord::Base
  self.table_name = 'measurement'
  self.primary_key = 'id'

  belongs_to :physical_node, foreign_key: :tag_node_id
  belongs_to :physical_node, foreign_key: :anchor_node_id
  belongs_to :experiment, foreign_key: :experiment_id
end

class PhysicalNode < ActiveRecord::Base
  self.table_name = 'physical_node'
  self.primary_key = 'id'

  has_many :measurements, foreign_key: :tag_node_id
  has_many :measurements, foreign_key: :anchor_node_id
end

class Experiment < ActiveRecord::Base
  self.table_name = 'experiment'
  self.primary_key = 'id'

  has_many :measurements, foreign_key: :experiment_id
end 
```

## 1.:

**什么有效：**

*   `GET /experiments/4/measurements.json`工作正常

**什么不起作用：（**其他一切;））

*   `GET /measurements/2/experiment.json`

错误信息：

```
Processing by ExperimentsController#show as HTML
Parameters: {"measurement_id"=>"2"}

ActiveRecord::RecordNotFound (Couldn't find Experiment without an ID) 
```

这应该很容易解决。更重要的是：

## 2.:

```
GET "/measurements/2/tag_node"

Processing by PhysicalNodesController#show as HTML
Parameters: {"measurement_id"=>"2"} 
```

我怎样才能让 rails 调用它`tag_node_id`而不是`measurement_id`？

# 解决方案：

在与“dmoss18”长时间交谈后，很明显将`tag_nodes`和`anchor_nodes`作为 的子元素是没有意义的`physical_nodes`，因为它们只存在于测量表中。

所以现在我的`routes.rb`样子是这样的：

```
resources :measurements, only: [:index, :show, :create]

resources :physical_nodes, only: [:index, :show]

resources :tag_nodes, only: [] do
  resources :measurements, only: [:index]
end

resources :anchor_nodes, only: [] do
  resources :measurements, only: [:index]
end

resources :experiments, only: [:index, :show] do
  resources :measurements, only: [:index]
end 
```

我也删除了所有这些`only childs`，因为这不是数据库的设计方式。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:01:49.010

1：当 rails 传入测量 id 时，您的 ExperimentsController#show 操作可能正在寻找 params[:id] 来查找实验。您将需要执行以下操作：

```
@experiment = Experiment.find(params[:measurement_id]) 
```

但是，这不起作用，因为您的实验表没有 measure_id 列。我不建议将嵌套实验作为测量资源。这不是您的数据库的布局方式。如果你仍然想嵌套它，这是你需要做的：

```
@experiment = Measurement.find(measurement.experiment_id).experiment 
```

您的“has_many”和“belongs_to”不需要它们的“foreign_key”属性。Rails 会自己解决这个问题。

2：由于这条路线的父资源是Measurement，rails将假定id参数称为：measurement_id。像这样更新您的关联：

```
class Measurement < ActiveRecord::Base
  self.table_name = 'measurement'
  self.primary_key = 'id'

  belongs_to :tag_node, :class_name => 'PhysicalNode', :foreign_key => :tag_node_id
  belongs_to :anchor_node, :class_name => 'PhysicalNode', :foreign_key => :anchor_node_id
  belongs_to :experiment
end

class PhysicalNode < ActiveRecord::Base
  self.table_name = 'physical_node'
  self.primary_key = 'id'

  has_many :tag_node, :class_name => 'Measurement', :foreign_key => :tag_node_id
  has_many :anchor_node, :class_name => 'Measurement', :foreign_key => :anchor_node_id
end

class Experiment < ActiveRecord::Base
  self.table_name = 'experiment'
  self.primary_key = 'id'

  has_many :measurements
end 
```

我不会在测量资源下嵌套任何东西，因为它是子资源，而不是父资源。由于您的 /measurements/1/[anythingelse] 是**测量**路线，因此 rails 假定 id 称为：measurement_id。 **您将事物嵌套在 id 为 1 的测量资源/对象下。** 换句话说，您说的是测量 x HAS tag_nodes 和 HAS anchor_nodes，这不是真的。

如果您仍然想要，您可以在控制器中为每个资源创建单独的操作，如下所示：

```
resources :measurements, only: [:index, :show] do
  resource :tag_node, controller: :physical_nodes, only: [:show_tag]
  resource :anchor_node, controller: :physical_nodes, only: [:show_anchor]
  resource :experiment, only: [:show]
end 
```

在您的物理节点控制器中创建一个 show_tag 和 show_anchor 操作。然后这些操作将查找 params[:measurement_id)

# mysql - MySQL选择最后一次唯一出现

> ID：15165475
> 
> 赞同：2
> 
> 时间：2013-03-01T19:35:58.277
> 
> 标签：mysql, sql

假设您有下表（这里感兴趣的列是 binid）：

```
id  datetime                 agid   binid   status
 1  2013-02-01 11:03:49        0      25    1
 2  2013-02-01 11:03:53        0      25    1
 3  2013-02-01 11:04:21        0      26    1
 4  2013-02-01 11:04:23        0      26    0
 5  2013-03-01 11:04:26        0      25    0
 6  2013-03-01 11:04:30        0      36    0
 7  2013-03-01 11:04:34        0      36    1
 8  2013-03-01 11:04:35        0      36    1
 9  2013-03-01 11:04:36        0      36    1
 10 2013-03-01 11:04:39        0      36    0
 11 2013-03-01 11:04:41        0      36    1
 13 2013-03-01 11:04:50        0      25    1
 14 2013-03-01 11:04:53        0      26    1
 15 2013-03-01 11:15:25        0      25    1
 16 2013-03-01 11:15:30        0      25    0
 17 2013-03-01 11:15:39        0      23    1
 18 2013-03-01 11:15:43        0      26    1 
```

如何提取在特定时间范围内发生的每个 binid 的最后一次出现？

这是我目前使用的：

```
SELECT * FROM ( reports ORDER BY datetime ASC ) 
WHERE datetime >= TIMESTAMP('2013-03-01') 
GROUP BY binid 
```

但它会返回第一次出现。如何返回每个唯一 binid 的最后一次出现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T19:40:53.267

您应该使用子查询来获取结果：

```
select r1.*
from reports r1
inner join
(
  select max(datetime) MaxDate, binid
  from reports
  WHERE datetime >= TIMESTAMP('2013-03-01') 
  group by binid
) r2
  on r1.binid = r2.binid
  and r1.datetime = r2.maxdate
WHERE r1.datetime >= TIMESTAMP('2013-03-01') 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/6197c/4)

问题是，当您`GROUP BY`在单个列上使用 a 时，MySQL 可能会为不在`GROUP BY`. （参见[MySQL 对 GROUP BY 的扩展](http://dev.mysql.com/doc/refman/5.0/en/group-by-extensions.html)）。

来自 MySQL 文档：

> MySQL 扩展了 GROUP BY 的使用，以便选择列表可以引用未在 GROUP BY 子句中命名的非聚合列。...您可以使用此功能通过避免不必要的列排序和分组来获得更好的性能。但是，这主要在每个未在 GROUP BY 中命名的非聚合列中的所有值对于每个组都相同时很有用。服务器可以从每个组中自由选择任何值，因此除非它们相同，否则选择的值是不确定的。此外，从每个组中选择值不会受到添加 ORDER BY 子句的影响。在选择了值之后对结果集进行排序，并且 ORDER BY 不会影响服务器选择的值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T19:45:54.617

```
SELECT binid, 
       SUBSTRING_INDEX(GROUP_CONCAT(agid ORDER BY datetime DESC), ',', 1) AS agid, 
       SUBSTRING_INDEX(GROUP_CONCAT(status ORDER BY datetime DESC), ',', 1) AS status
FROM reports
WHERE datetime <= TIMESTAMP('2013-03-01')
GROUP BY binid; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:41:00.583

```
SELECT * FROM ( reports ORDER BY datetime DESC) 
WHERE datetime >= TIMESTAMP('2013-03-01') 
GROUP BY binid LIMIT 1 
```

* * *

## 回答 #4

> 赞同：-3
> 
> 时间：2013-03-01T19:39:47.840

更改`ORDER BY ASC`为`ORDER BY DESC`。应该做的伎俩。

# windows - Windows 便携式设备 (WPD) 可再发行用于 Windows XP？

> ID：15165476
> 
> 赞同：0
> 
> 时间：2013-03-01T19:35:58.533
> 
> 标签：windows, windows-xp, redistributable, wpd

我正在尝试在 Windows XP 下使用 Windows 便携式设备 (WPD) API。

MSDN 说[Windows XP 下支持](http://msdn.microsoft.com/en-us/library/windows/desktop/dd388998%28v=vs.85%29.aspx)**Windows** Portable Device API ：

> Windows 7、Windows Vista 和 Windows XP 操作系统支持 WPD 应用程序编程接口。

WPD 对象作为从`PortableDeviceApi.dll`.

除了类：

```
CLSID_PortableDeviceManager = "0af10cec-2ecd-4b92-9581-34f6ae0637f3" 
```

未在 Windows XP（SP3、32 位、Professional）下注册：

![在此处输入图像描述](../Images/a0bb3180baa1b8e10ebb20c922d07853.png)

并且Windows XP 上不存在**PortableDeviceApi.dll ：**

![在此处输入图像描述](../Images/78adc383def03d20f40aa0046b467fea.png)

这意味着必须有一个可再发行的**Windows 便携式设备**，我可以将其发送给我的 Windows XP 客户。

**问题：** **Windows 便携式设备**在哪里可再发行，以便我可以将其发送给我的 Windows XP 客户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T03:19:32.817

您可以在此处下载适用于 XP 的 Windows Media Format 11 SDK：http: [//www.microsoft.com/windows/windowsmedia/licensing/Licensing_Win_Apps_CustApp.aspx](http://www.microsoft.com/windows/windowsmedia/licensing/Licensing_Win_Apps_CustApp.aspx)

这包括一个可再发行包，您可以将它包含在您的应用程序中，供 XP 客户使用。

# html - 将 HTML 页面嵌入另一个页面内联，*not* 使用 src 标签

> ID：15165481
> 
> 赞同：1
> 
> 时间：2013-03-01T19:36:11.087
> 
> 标签：html, iframe

我有一个外部页面，我想嵌入到我的页面中——它有自己的脚本和 CSS，我不想与我的冲突。通常我只会使用一个`<iframe>`并完成它，但这是一个移动优化站点，我想尽可能避免额外的 HTTP 调用。所以，我想在服务器端运行请求并将生成的 HTML 嵌入到我的页面中，这样客户端就不必自己发出请求。

我可以通过执行以下操作来做到这一点：

```
<iframe id="test"></iframe>
<script>
    var doc = $("#test")[0].contentWindow.document;
    var $body = $('body',doc);
    $body.html('<h1>Test</h1>');
</script> 
```

但我宁愿完全不使用 JavaScript 来做这件事。那可能吗？我放在`<iframe>`and`</iframe>`标记之间的任何内容都会被忽略，因为它用于与不支持 iframe 的浏览器的兼容性。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:38:06.920

为什么不只使用 a `<div>`？（可选）设置固定的宽度和高度并添加`overflow:auto`到其 CSS。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:54:58.450

最终，您应该能够在 iframe 上使用 srcdoc 属性。但是，它目前没有得到广泛[支持](http://www.w3schools.com/tags/att_iframe_srcdoc.asp)。与此同时，您唯一的选择是 javascript 或只是让浏览器使用传统的 src 属性进行调用。您可能会看这里，因为我相信这个[stackoverflow 问题](https://stackoverflow.com/questions/13214419/alternatives-to-iframe-srcdoc)非常相关。

# c - R：使用带有 .Call 和 C/C++ 包装器而不是 .Fortran 的 Fortran 子例程的优势？

> ID：15165484
> 
> 赞同：19
> 
> 时间：2013-03-01T19:36:14.800
> 
> 标签：c, performance, r, fortran, wrapper

我有一个 R 包，它使用大量 Fortran 子例程来进行递归线性代数计算的嵌套循环（很大程度上取决于 BLAS 和 LAPACK 例程）。作为 Fortran 的接口，我使用`.Fortran`函数。我刚刚阅读了Jonathan Callahan 的关于使用而不是使用 C/C++ 编写的子例程[的博客文章](http://mazamascience.com/WorkingWithData/?p=1099)，这让我想到，在使用 Fortran 子例程时也使用接口会更好，方法是在 C 中编写一个简单的包装器，然后调用Fortran 子程序？`.Call``.C``.Call`

如前所述，我的 Fortran 代码在某种意义上非常简单，我只是使用双精度或整数类型的多维数组。但是我了解到我必须在 R 端写很多检查以确保一切都不会崩溃，因为我不小心忘记将某些矩阵的存储模式更改为整数或某些矩阵的维度已更改等。

子程序写为 F90/95。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-03T18:21:56.283

如果您使用大型数据集，可能会有优势。.Call 可以更快，因为您每次调用函数时都不会复制数据。对于这个问题中描述的情况，不会有这样的优势，因为 R 2.15.1 发行说明状态

> .C() 和 .Fortran() 复制较少：未命名的原始、逻辑、整数、实数或复数向量的参数在调用之前不会被复制，并且（无论是否命名）在调用之后不会被复制。列表不再被复制（它们应该在 C 代码中以只读方式使用）。

切换到 .Call 意味着您放弃了 .Fortran 接口的便利性。您将 SEXP 传递到 C 代码中，使用（可怕且没有充分记录的）R API 对数据进行任何检查/操作，然后从 C 中调用 Fortran 函数。任何使用您的代码的人都必须了解R API 和 C/Fortran 互操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-04-17T09:00:35.143

R 包**dotCall64**可能是一个有趣的替代方案。它提供了`.C64()`哪个是*Foreign Function Interface*的增强版本，即`.C()`和`.Fortran()`。

该接口`.C64()`可用于连接 Fortran 和 C/C++ 代码。它

*   有类似的用法`.C()`和`.Fortran()`
*   提供一种机制来避免不必要的只读和只写参数副本
*   支持长向量（超过 2^31-1 个元素的向量）
*   支持 64 位整数类型参数

因此，可以避免不必要的只读参数副本，同时避免将`.Call()`接口与 C 包装函数结合使用。

一些链接：

*   R包**dotCall64**：[https ://CRAN.R-project.org/package=dotCall64](https://CRAN.R-project.org/package=dotCall64)
*   **dotCall64**示例说明：https [: //doi.org/10.1016/j.softx.2018.06.002](https://doi.org/10.1016/j.softx.2018.06.002)
*   **dotCall64**用于使稀疏矩阵代数 R 包**垃圾邮件**兼容巨大稀疏矩阵（超过 2^31-1 个非零元素）的插图：https : [//doi.org/10.1016/j.cageo.2016.11。 015](https://doi.org/10.1016/j.cageo.2016.11.015)

我是**dotCall64**和**spam**的作者之一。

# linux - Eclipse GUI 中的滚动条不存在

> ID：15165485
> 
> 赞同：2
> 
> 时间：2013-03-01T19:36:16.067
> 
> 标签：linux, eclipse, user-interface, scrollbar

我正在使用 Eclipse 开发 Android 应用程序。但是当我尝试做任何事情时，我无法在窗口中看到所有选项，因为它不适合屏幕。这是一个例子：

![例子](../Images/3ae0440e22773914be9852ed12f1bdff.png)

我看不到“工作集”以及它下面是否存在的任何内容。在所有不适合屏幕的窗口中，它都是一样的。我已经搜索了一个解决方案，我在[这里](https://askubuntu.com/questions/112084/how-can-i-scroll-down-in-this-window-provided-by-eclipse)找到了一些东西，但是启动 Eclipse`LIBOVERLAY_SCROLLBAR=0 eclipse`也不起作用，因为根本没有滚动条。我已经在 Arch Linux 存储库中的 Eclipse 和 ADT 中的内置 Eclipse 上尝试过它。它只是行不通。令人恼火的是，我无法在选项窗口中向下滚动以查看整个画面。有什么建议/解决方案吗？

如有必要，以下是一些系统和软件信息：

```
Linux fuck 3.7.9-2-ARCH #1 SMP PREEMPT Mon Feb 25 12:04:25 CET 2013 x86_64 GNU/Linux

Built-in Eclipse in ADT version: 3.8

Eclipse from repository version: 4.2.1-1

GNOME Shell version: 3.6.3.1-2 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:15:32.090

如果 SWT 面板 (Eclipse UI) 不是为滚动而编写的，它将不会滚动。您引用的向导页面不会滚动，并且没有可以应用的开关或设置使其滚动。您不能展开向导对话框以查看所有内容吗？

# jquery - 用 jQuery 为系列制作动画，为什么队列会这样工作？

> ID：15165488
> 
> 赞同：1
> 
> 时间：2013-03-01T19:36:24.737
> 
> 标签：jquery

我正在从左到右淡化一系列元素，我正在寻找一种优雅的方式来做到这一点，而不使用嵌套函数。队列似乎可以挽救局面，但我不明白为什么它会这样工作。

这有效：

```
$('.item').queue(function(next) {
  $(this).delay(500).animate({opacity: 1}, 1000);
});

$('.item').queue(function(next) {
  $(this).parent().next('.item').dequeue();
  next();
});

$('.intro i:first').dequeue(); 
```

这不会：

```
$('.item').queue(function(next) {
  $(this).delay(500).animate({opacity: 1}, 1000);
  $(this).parent().next('.item').dequeue();
  next();
});

$('.item').dequeue(); 
```

它一次将它们全部淡化。

我的理解是，队列在动画或出队触发时附加了一系列要执行的项目。那么......为什么这有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:18:39.127

```
 var items  = $('.item'),
     index  = 0,
     itemInterval;

 itemInterval = setInterval(function(){
     items.eq(index).fadeIn(1000);
     index++
     if(index >= items.length){ clearInterval(itemInterval); }
 }, 500); 
```

这只是我的模式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:56:41.513

我不认为这是队列功能的工作方式。文档说它是*一个*元素上的队列，而不是渲染的整个动画队列，就像我认为您正在尝试使用它一样。然而，做你想做的事情很简单。这个怎么样：

```
$(function(){
    var queue = $.makeArray($("div"));    
    (function doAnimation(){
        var item = queue.pop();
        if (item) {
            $(item).delay(500).animate({opacity: 0.8}, 1000, doAnimation);
        }
    })();    
}); 
```

JsFiddle：http: [//jsfiddle.net/6xdeP/1](http://jsfiddle.net/6xdeP/1)

**编辑：**更新为更清洁的解决方案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:56:42.217

我没有直接回答你的队列问题，因为我真的不知道动画队列是如何工作的。我相信正在发生的事情是动画队列一次全部触发`$('.item')`

但是，我正在回答希望能解决您的问题。

**[演示](http://jsfiddle.net/ft5qT/1/)**

HTML

```
<ul>
    <li class="item">Item</li>
    <li class="item">Item</li>
    <li class="item">Item</li>
    <li class="item">Item</li>
    <li class="item">Item</li>
</ul> 
```

CSS

```
.item
{
    display:none;
   position:relative;
   float:left;    
   border:1px solid black;
   background-color:green;
    list-style:none;
    padding:10px;
} 
```

jQuery

```
$.fn.ProgressiveFadeIn=function(delay,speed)
{
    if(!delay) delay=500;
    if(!speed) speed=1000;
    $(this).each(function(i){
        $(this).delay((speed+delay)*i).fadeIn(speed);
    });
}
$(".item").ProgressiveFadeIn(500,1000); 
```

# wpf - 在 XAML 中，是否可以在声明它引用的元素之前使用 ElementName 绑定？

> ID：15165489
> 
> 赞同：3
> 
> 时间：2013-03-01T19:36:35.063
> 
> 标签：wpf

我有一个带有一些 InputBindings 的 UserControl。我想让其中一个输入绑定（箭头键按下）在我的 UserControl 中的 GUI 控件上执行命令。所以

例如

```
<UserControl.InputBindings>
    <KeyBinding Key="Up" Command="{Binding ElementName=MyViewElement, Path=MoveUpCommand}"/>
    <KeyBinding Key="Down" Command="{Binding ElementName=MyViewElement, Path=MoveDownCommand}"/>
</UserControl.InputBindings> 
```

但是，这失败了，因为未找到 MyViewElement，因为我假设它稍后在 XAML 中声明。如果我将 InputBindings 移动到 XAML 文件的末尾，一切都会按预期工作。

我有点喜欢我的 InputBindings 在顶部，是否可以让它忽略声明顺序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T07:21:20.977

@Stewbob 你在说什么？

看看这个：http: [//msdn.microsoft.com/en-us/library/ms752308.aspx](http://msdn.microsoft.com/en-us/library/ms752308.aspx)

```
<Window.CommandBindings>
  <CommandBinding Command="ApplicationCommands.Open"
                  Executed="OpenCmdExecuted"
                  CanExecute="OpenCmdCanExecute"/>
</Window.CommandBindings> 
```

根据您所说，这永远不会正常工作，但确实可以：

```
<StackPanel>
  <Menu>
    <MenuItem Command="ApplicationCommands.Paste"
              CommandTarget="{Binding ElementName=mainTextBox}" />
  </Menu>
  <TextBox Name="mainTextBox"/>
</StackPanel> 
```

从您所说的绑定开始，它也将首先执行，因此与 mainTextBox 的绑定永远不会起作用。那是非常不正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:12:30.177

当然，您可以在 XAML 中执行所有操作，包括在窗口级别进行此类绑定。显示您的 XAML/MyViewElement 的更多代码。也许我们可以告诉你如何做到这一点而不会出错。也请在这里发布您的错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-11-23T10:29:25.657

> 但是，这失败了，因为未找到 MyViewElement，因为我假设它稍后在 XAML 中声明。

为避免这种情况，您可以在后面的代码中使用以下代码**而不是**构造函数：

```
protected override void OnInitialized(EventArgs e)
{
    SomeCommand = new DelegateCommand(SomeExecuteMethod);

    InitializeComponent();
    base.OnInitialized(e);
} 
```

这可确保命令在您使用它们之前已经实例化：

```
Command="{Binding ElementName=MyUserCOntrol, Path=SomeCommand}" 
```

# sql - MS Access 舍入问题

> ID：15165492
> 
> 赞同：0
> 
> 时间：2013-03-01T19:36:47.247
> 
> 标签：sql, ms-access, rounding, ms-access-2003

我有 3 个值 saleprice、productprice 和 reward_price。我需要让它先查找销售价格，如果没有销售价格，则查看产品价格。然后抓住它并将其向上或向下舍入 50 美分。苏..

*   4.49 = 4 奖励价格 = 4
*   4.50 = 5 奖励价格 = 5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:57:50.640

```
SELECT
    Format(IIf(saleprice Is Null, productprice, saleprice), '#') AS reward_price
FROM YourTable; 
```

`Format()`返回一个字符串。如果您需要*将reward_price*作为实际数字，您可以将字段表达式包装在转换函数中，例如`Val()`, `CCur()`,`CInt()`等。

# c++ - 从深度分析器中去除伪影/噪声

> ID：15165496
> 
> 赞同：0
> 
> 时间：2013-03-01T19:36:55.473
> 
> 标签：c++, image, depth, noise, scanning

给定两张图像，您可以通过扫描每一行和差异找到深度，有人知道如何去除噪音吗？

例如，如果预期的输出是左边而我的输出是正确的

[http://sphotos-a.xx.fbcdn.net/hphotos-prn1/28905_10151279071291130_752649318_n.jpg](http://sphotos-a.xx.fbcdn.net/hphotos-prn1/28905_10151279071291130_752649318_n.jpg)

有没有人有任何编码技巧来摆脱一些噪音？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:38:25.240

我假设这是由您使用的硬件引起的。

您可以根据相邻像素平均出像素颜色。遍历每一列/行并根据周围的颜色调整颜色。对整个图像进行多次传递以产生更大的效果。

这不会完全消除噪点，但会提供更柔和的图像。

此外，如果您通过图形卡传递它，您可能会考虑编写一个着色器。这将大大提高速度。

# c++ - 没有科学记数法或尾随零的双倍字符串，有效

> ID：15165502
> 
> 赞同：12
> 
> 时间：2013-03-01T19:37:18.807
> 
> 标签：c++, stringstream

这个例程被称为无数次来创建充满数字的大型 csv 文件。有没有更有效的方法来做到这一点？

```
 static std::string dbl2str(double d)
    {
        std::stringstream ss;
        ss << std::fixed << std::setprecision(10) << d;              //convert double to string w fixed notation, hi precision
        std::string s = ss.str();                                    //output to std::string
        s.erase(s.find_last_not_of('0') + 1, std::string::npos);     //remove trailing 000s    (123.1200 => 123.12,  123.000 => 123.)
        return (s[s.size()-1] == '.') ? s.substr(0, s.size()-1) : s; //remove dangling decimal (123\. => 123)
    } 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-01T21:31:01.843

在开始之前，请检查是否在此功能上花费了大量时间。通过使用分析器或其他方式进行测量来做到这一点。知道你把它称为无数次是很好的，但是如果你的程序仍然只在这个函数上花费了 1% 的时间，那么你在这里所做的任何事情都不可能使你的程序性能提高 1% 以上。如果是这种情况，您的问题的答案将是“出于您的目的，否，此功能无法显着提高效率，如果您尝试，您就是在浪费时间”。

首先，避免`s.substr(0, s.size()-1)`。这会复制大部分字符串*，*并且使您的函数不符合 NRVO 的条件，因此我认为通常您会在返回时获得一份副本。所以我要做的第一个改变是将最后一行替换为：

```
if(s[s.size()-1] == '.') {
    s.erase(s.end()-1);
}
return s; 
```

但是，如果性能是一个严重的问题，那么我会这样做。我不保证这是最快的，但它避免了一些不必要的分配和复制问题。任何涉及`stringstream`的方法都需要从字符串流复制到结果，所以我们需要一个更底层的操作，`snprintf`.

```
static std::string dbl2str(double d)
{
    size_t len = std::snprintf(0, 0, "%.10f", d);
    std::string s(len+1, 0);
    // technically non-portable, see below
    std::snprintf(&s[0], len+1, "%.10f", d);
    // remove nul terminator
    s.pop_back();
    // remove trailing zeros
    s.erase(s.find_last_not_of('0') + 1, std::string::npos);
    // remove trailing point
    if(s.back() == '.') {
        s.pop_back();
    }
    return s;
} 
```

第二次调用`snprintf`假定`std::string`使用连续存储。这在 C++11 中得到保证。在 C++03 中不能保证，但对于`std::string`C++ 委员会已知的所有积极维护的实现都是如此。如果性能真的很重要，那么我认为做出这种不可移植的假设是合理的，因为直接写入字符串可以节省以后复制到字符串的操作。

`s.pop_back()`是 C++11 的说法`s.erase(s.end()-1)`，并且`s.back()`是`s[s.size()-1]`

对于另一个*可能的*改进，您可以摆脱第一次调用`snprintf`，而是将您的大小`s`调整为某个值，例如`std::numeric_limits<double>::max_exponent10 + 14`（基本上，`-DBL_MAX`需要的长度）。问题是这分配和归零的内存比通常需要的多得多（IEEE double 为 322 字节）。我的直觉是这将比第一次调用要慢`snprintf`，更不用说在调用者将字符串返回值保持一段时间的情况下浪费内存。但你总是可以测试它。

或者，`std::max((int)std::log10(d), 0) + 14`计算所需大小的合理严格的上限，并且可能比`snprintf`精确计算更快。

最后，可能是你可以通过改变函数接口来提高性能。例如，您可以附加到调用者传入的字符串，而不是返回一个新字符串：

```
void append_dbl2str(std::string &s, double d) {
    size_t len = std::snprintf(0, 0, "%.10f", d);
    size_t oldsize = s.size();
    s.resize(oldsize + len + 1);
    // technically non-portable
    std::snprintf(&s[oldsize], len+1, "%.10f", d);
    // remove nul terminator
    s.pop_back();
    // remove trailing zeros
    s.erase(s.find_last_not_of('0') + 1, std::string::npos);
    // remove trailing point
    if(s.back() == '.') {
        s.pop_back();
    }
} 
```

然后调用者可以`reserve()`有足够的空间，多次调用您的函数（可能在其间添加其他字符串），然后将生成的数据块一次全部写入文件，除了`reserve`. “大量”不必是整个文件，一次可以是一行或“段落”，但任何避免大量内存分配的东西都是潜在的性能提升。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-12-22T12:04:24.093

在速度或简洁方面有效？

```
char buf[64];
sprintf(buf, "%-.*G", 16, 1.0);
cout << buf << endl; 
```

显示“1”。在恢复为科学记数法之前，最多可格式化 16 位有效数字，没有尾随零。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:48:05.287

*   使用`snprintf`and 数组`char`代替`stringstream`and`string`
*   将指向`char`缓冲区的指针传递给它打印到的 dbl2str（为了避免`string`返回时调用的复制构造函数）。在字符缓冲区中组装要打印的字符串（或在调用时将字符缓冲区转换为字符串或将其添加到现有字符串中）
*   `inline`在头文件中声明函数

    ```
    #include <cstdio>
    inline void dbl2str(char *buffer, int bufsize, double d)
    {
      /** the caller must make sure that there is enough memory allocated for buffer */
      int len = snprintf(buffer, bufsize, "%lf", d);

      /* len is the number of characters put into the buffer excluding the trailing \0
         so buffer[len] is the \0 and buffer[len-1] is the last 'visible' character */

      while (len >= 1 && buffer[len-1] == '0')
        --len;

      /* terminate the string where the last '0' character was or overwrite the existing
         0 if there was no '0' */
      buffer[len] = 0;

      /* check for a trailing decimal point */
      if (len >= 1 && buffer[len-1] == '.')
        buffer[len-1] = 0;
    } 
    ```

# c# - Linq - 如何在列表的最大元素上应用 where 子句

> ID：15165503
> 
> 赞同：3
> 
> 时间：2013-03-01T19:37:24.630
> 
> 标签：c#, linq, linq-to-nhibernate

*   我有一个“人”的列表
*   每个人都有一个“类别”列表
*   类别有两个属性：日期和值

我想选择一个人员列表，其中最后一个类别等于“B”。但我不知道如何用 Linq 语法编写“where 子句”。

我的“人”结构是：

```
<person>
    <id>200</id>
    <name>Peter</name>
    <age>25</age>
    <categories>
        <category>
            <date>2012-05-01<date>
            <value>A</value>
        </category>
        <category>
            <date>2013-01-01<date>
            <value>B</value>
        </category>
        <category>
            <date>2013-02-01<date>
            <value>C</value>
        </category>
    </categories>
</person> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T19:41:22.700

您可以使用以下内容：

```
List<Person> allPersons = GetListOfPersons();

List<Person> selectedPersons = allPersons
    .Where((x) => x.Categories
                   .OrderBy(y => y.Date)
                   .Last()
                   .Value == "B")
    .ToList(); 
```

或查询样式

```
List<Person> selectedPersons = (from person in allPersons
                                where person.Categories.OrderBy(x => x.Date).Last().Value == "B"
                                select person).ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T19:42:36.583

如果我们假设类别可能按日期乱序：

```
var bPersons = persons.Where(p => 
                             p.Categories
                              .OrderByDescending(c => c.Date)
                              .First().Value == "B") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:29:11.053

如果你只是使用 XML，你可以这样做：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Xml.Linq;

namespace ConsoleApplication2
{
    internal class Program
    {
        private static void Main(string[] args)
        {
            var persons = XElement.Parse(xml);

            var seq2 = from person in persons.Descendants("person")
                       where (string) person.Descendants("value").Last() == "B"
                       select person;

            print(seq2);
        }

        private static void print<T>(IEnumerable<T> seq)
        {
            foreach (var item in seq)
            {
                Console.WriteLine("-------------------------------------------------");
                Console.WriteLine(item);
            }

            Console.WriteLine("-------------------------------------------------");
        }

        static string xml =
@"<persons>
<person>
    <id>200</id>
    <name>Peter</name>
    <age>25</age>
    <categories>
        <category>
            <date>2012-05-01</date>
            <value>B</value>
        </category>
        <category>
            <date>2013-01-01</date>
            <value>A</value>
        </category>
        <category>
            <date>2013-02-01</date>
            <value>C</value>
        </category>
    </categories>
</person>
<person>
    <id>201</id>
    <name>Mary</name>
    <age>25</age>
    <categories>
        <category>
            <date>2012-05-01</date>
            <value>A</value>
        </category>
        <category>
            <date>2013-01-01</date>
            <value>B</value>
        </category>
        <category>
            <date>2013-02-01</date>
            <value>C</value>
        </category>
    </categories>
</person>
<person>
    <id>202</id>
    <name>Midge</name>
    <age>25</age>
    <categories>
        <category>
            <date>2012-05-01</date>
            <value>C</value>
        </category>
        <category>
            <date>2013-01-01</date>
            <value>A</value>
        </category>
        <category>
            <date>2013-02-01</date>
            <value>B</value>
        </category>
    </categories>
</person>
</persons>
";

    }
} 
```

这打印：

```
-------------------------------------------------
<person>
  <id>202</id>
  <name>Midge</name>
  <age>25</age>
  <categories>
    <category>
      <date>2012-05-01</date>
      <value>C</value>
    </category>
    <category>
      <date>2013-01-01</date>
      <value>A</value>
    </category>
    <category>
      <date>2013-02-01</date>
      <value>B</value>
    </category>
  </categories>
</person>
------------------------------------------------- 
```

# drupal - Drupal 7 限制每个用户发布的节点

> ID：15165505
> 
> 赞同：1
> 
> 时间：2013-03-01T19:37:34.803
> 
> 标签：drupal, limit

所以我有一个非常具体的情况，我的用户拥有由他们创作的 X（无限）节点......但他们一次只能发布 6 个节点。

我用谷歌搜索了一段时间，发现[http://www.badzilla.co.uk/Drupal-7--Node-Limit-Publish-Module](http://www.badzilla.co.uk/Drupal-7--Node-Limit-Publish-Module)效果很好，除了这限制了特定内容的已发布节点的总数类型。

我需要这个确切的功能，除了每个用户的额外限制......这样每个用户一次只能发布 6 个节点，而不是整个 Drupal 站点只有 X 个特定内容类型一下子发布。

希望这是有道理的......无论如何，上面 URL 中的代码/模块确实运行良好，只是我需要满足它以针对每个用户进行检查！我对模块编码或任何东西都不是很好，所以如果有人能够掌握一点如何更改该站点上的模块代码，那就太好了！TIA

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T15:46:56.750

对于遇到我同样问题的任何人，需要限制特定内容类型的已发布节点的数量，我的一个朋友更改了上面链接的 Badzilla 模块，并将其调整为以下内容。感谢 Badzilla 提供了模块的基础，感谢我的好友对其进行了调整，以检查用户而不是站点范围内的已发布节点数。

```
 <?php

/*
 * File         : node_limit_publish.module
 * Title        : Limits the number of concurrently published node types dependent upon admin configurable limits
 * Sponsor      : Hangar Seven Digital
 * Author       : Badzilla www.badzilla.co.uk @badzillacouk
 *
 * This work is copyright Badzilla under the GPL licence terms and conditions
 *
 */

/**
* Implementation of hook_menu().
*
*/
function node_limit_publish_menu() {

    $items = array();

    $items['admin/config/content/node_limit_publish'] = array(
        'title' => 'Limit Number of Published Nodes per Node Type',
        'description' => t('Zero represents an unlimited amount of published nodes'),
        'page callback' => 'drupal_get_form',
        'page arguments' => array('node_limit_publish_admin_settings'),
        'access arguments' => array('administer node_limit_publish'),
        'type' => MENU_NORMAL_ITEM,
    );

    return $items;
}

function node_limit_publish_admin_settings() {

    $form = array();

    if (is_array($types = node_type_get_types())) {

        $form['title'] = array(
            '#markup' => t('Zero represents an unlimited amount of published nodes'),
        );

        foreach($types as $key => $value) 
            $form['node_limit_publish_'.$key] = array(
                '#type' => 'textfield',
                '#description' => $key,
                '#size' => 4,
                '#maxlength' => 10,
                '#element_validate' => array('node_limit_publish_is_numeric'),
                '#default_value' => variable_get('node_limit_publish_'.$key, 0),                
            );
    }

    return system_settings_form($form);
}

function node_limit_publish_is_numeric($element, &$form_state, $form) {

    if (!is_numeric($element['#value']))
        form_error($element, t('This field must be numeric'));
}

/**
* Implementation of hook_presave().
*
*/
function node_limit_publish_node_presave($node) {
    global $user;

    // Get the limit on this type
    if (($limit = variable_get('node_limit_publish_'.$node->type, 0)) and $node->status == 1) {
        // now check whether we have reached our maximum
        $query = db_select('node')
            ->condition('type', $node->type)
            ->condition('status', 1)
                        ->condition('uid', $user->uid);
        if (isset($node->nid))
            $query->condition('nid', $node->nid, '!=');
        $count = $query->countQuery()
            ->execute()
            ->fetchField();
        if ($count >= $limit) {
            $node->status = 0;
            // use %type for dynamic node type
            drupal_set_message(t('Sorry, the maximum of this node are active already. You must first disable another!', array('%type' => $node->type)), 'warning');
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:22:35.573

[节点限制](http://drupal.org/project/node_limit)是您所追求的...

> 节点限制模块允许管理员限制角色或用户可以创建的特定类型的节点数量。例如，如果站点具有可以创建“广告”节点的“广告商”角色，则节点限制管理员可以将该角色中的所有用户限制为特定数量的节点。他还可以基于每个用户限制用户。

# iphone - Instagram IPHONE HOOKS - 应用程序未打开

> ID：15165507
> 
> 赞同：0
> 
> 时间：2013-03-01T19:37:47.603
> 
> 标签：iphone, webview, instagram

我试图从我自己的应用程序中打开 Instagram，试图获取带有“巴西”标签的照片列表。但是 Instagram 没有打开。请在此处查看代码片段。

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    //Load URL
    NSURL *instagramURL = [NSURL URLWithString:@"instagram://tag?name=brazil"];
   if ([[UIApplication sharedApplication] canOpenURL:instagramURL]) {
        [[UIApplication sharedApplication] openURL:instagramURL];
   }

    NSURLRequest *instagramRequest = [NSURLRequest requestWithURL:instagramURL];

    [instagramWebView loadRequest:instagramRequest];
} 
```

提前致谢！

# wordpress - Wordpress Flash 横幅链接

> ID：15165510
> 
> 赞同：1
> 
> 时间：2013-03-01T19:38:19.247
> 
> 标签：wordpress, flash

代码

```
<a href="http://example.com">
 <embed  src="'.$thead->image_url.'">
</a> 
```

使用图像可以，但使用 swf 文件链接不起作用。

# c# - ASP.NET DropDown 返回 SelectedText 的值而不是 SelectedValue

> ID：15165511
> 
> 赞同：1
> 
> 时间：2013-03-01T19:38:23.867
> 
> 标签：c#, asp.net

我错过了什么？我正在从代码隐藏中构建下拉列表，如下所示：

```
 ListItemCollection oL = new ListItemCollection();
        foreach (var item in edata)
        {
            ListItem oListItem = new ListItem();
            oListItem.Text = item.StatusName; //"StatusName"
            oListItem.Value  = item.Id.ToString(); // "StatusId"

            if(item.Id == statusid)
            {
                oListItem.Selected = true;
            }
            oL.Add(oListItem);

        } 
```

但是当我尝试像这样选择 SelectedItem.Value 时，它​​应该返回 StatusId 但它正在返回 StatusName。我错过了什么？

```
EventStatusDropDownList1.SelectedItem.Value 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:43:34.260

这里代表什么`edata`？如果是 a`DataTable`或 generic `List`，则可以使用`DataSource`and`DataBind`成员。请看下面的代码：

```
var edata = SomeMethodReturnngDataTable();
EventStatusDropDownList1.DataSource = edata;
EventStatusDropDownList1.DataTextField = "StatusName";
EventStatusDropDownList1.DataValueField = "StatusId";
EventStatusDropDownList1.DataBind(); 
```

现在您可以使用它`EventStatusDropDownList1.SelectedItem.Value`来获取 ID。

# asp.net - asp.net 动态数据 NEW 自定义页面 ERROR NOT FOUND

> ID：15165515
> 
> 赞同：0
> 
> 时间：2013-03-01T19:38:46.077
> 
> 标签：asp.net

iv 在我的“customPages”文件夹“Check”中添加了一个新文件夹，然后在“check”文件夹中添加了一个名为“show”的新 webform 页面

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="show.aspx.cs" Inherits="DynamicData_CustomPages_Check_show" %>

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title></title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
    bla bla la
    </div>
    </form>
</body>
</html> 
```

当我尝试从另一个页面导航它时它不会工作错误：28889/CRC/Check/show.aspx

```
The resource cannot be found. 
  Description: HTTP 404\. The resource you are looking for (or one of its dependencies) could have been removed, had its name changed, or is temporarily unavailable.  Please review the following URL and make sure that it is spelled correctly. 

 Requested URL: /CRC/Check/show.aspx 
```

知道为什么吗？

* * *

编辑：iv 甚至将它设置为我的起始页，我右键单击，但它仍然找不到该页面？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:41:39.040

您说您添加了一个名为 List 的 WebForm，因此您应该尝试使用 list.aspx 而不是 show.aspx。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-04T14:01:49.990

打开 Global.asax

应该有这样的东西：

```
routes.Add(new DynamicDataRoute("{table}/{action}.aspx") {
            Constraints = new RouteValueDictionary(new { action = "List|Details|Edit|Insert" }),
            Model = model
        }); 
```

在操作列表中添加“显示”。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T19:56:53.407

如果您`new folder`在您的`custompages`文件夹中，`url`则应该是这样的

> YourApplication/customPages/Check/show.aspx

我认为您缺少`customPages`文件夹

# c# - 无法从另一个类访问变量：无效的表达式术语“公共”

> ID：15165523
> 
> 赞同：1
> 
> 时间：2013-03-01T19:39:27.210
> 
> 标签：c#, winforms

Visual C# 2008 速成版。窗口形式；两个文本框和一个按钮。在 cmdEnter_Click 事件中，我想检查 ValidateForm 类中的布尔变量是否为真（处理文本框是否被清除）。

```
private void cmdEnter_Click(object sender, EventArgs e)
{
     ValidateForm();
     txtName.Clear();
     txtAge.Clear();
}

public void ValidateForm()
{
     bool bValidName = ValidateName();
     bool bValidAge = ValidateAge();
     if (bValidName && bValidAge)
          MessageBox.Show("Entry will be added");               
     else
          MessageBox.Show("Please enter valid data");
} 
```

我将 ValidateFrom() 修饰符从 private 更改为 public，然后将 public 放在布尔变量的前面，以便我可以访问它们，但我收到“Invalid expression term public”错误。我的理解是，如果变量是公共的并且在公共类中，我应该能够从任何地方访问它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:43:33.107

在方法内声明的变量仅在该方法内可用，无论该类是否是公共的。

如果要从公共类外部访问变量，请使用类级别变量。在您的方法之外声明它。公共/私有修饰符在方法内无效，它们需要在类级别使用。

```
public bool bValidName;

public void ValidateForm()
{
     bValidName = ValidateName();
     ... 
```

根据您想要执行的操作，您可能希望将其设为属性，并且可以在 get/set 上使用修饰符。

```
public bool bValidName { get; set; } 
```

# php - 使用 PHP 发布嵌套 JSON 时遇到问题

> ID：15165530
> 
> 赞同：3
> 
> 时间：2013-03-01T19:39:50.473
> 
> 标签：php, jquery, html, json

我正在尝试将一些表单数据作为 JSON 对象发送到[Force.com 上的示例应用程序](https://cmsamp.secure.force.com/GenericApp/services/apexrest/GenericApp)。我使用 jQuery 获取表单数据并将其发布到服务器上的 PHP 文件，然后将其发送到上面链接的示例应用程序。然而，我从示例应用程序中得到的响应告诉我，我在此过程中犯了一些错误。

**与示例 Force.com 应用程序对话的 PHP 文件：**

```
<?php

    $url = 'https://cmsamp.secure.force.com/GenericApp/services/apexrest/GenericApp';
    $data = $_POST[ 'data'];

    $options = array('http' => array('method'  => 'POST','content' => http_build_query($data)));
    $context  = stream_context_create($options);
    $result = file_get_contents($url, false, $context);

    echo $result;

?> 
```

**将表单数据发布到 PHP 文件的客户端 jQuery 代码：**

```
var sample_form_data = {"attributes":{"type":"Generic_App__c"},"Application_Type__c":"iPay","Return_Email__c":"lsmith@cmsrep.com","Name":"Bus Test","ACHRejectFee__c":"123456789","ApplicationDate__c":"2000-01-01","BusinessPhone__c":"(555) 123-4567","Email__c":"thetest@testemail.com","InternetPercentage2__c":"0","MailingState__c":"CA","MOTO7__c":"true","NumOfLocations__c":"15"};

$.post( url, { data: JSON.stringify( sample_form_data ) }, function( result ) { 
    console.log( result );
}); 
```

**我从 Force.com 应用程序得到的回复：**

```
"No content to map to Object due to end of inputInsert failed. 
First exception on row 0; 
first error: REQUIRED_FIELD_MISSING, 
Required fields are missing: [Name]: [Name]" 
```

**期望的“成功”响应：**

```
"Success: 
Generic App Object: Bus Test; was successfully created and inserted" 
```

这是`var_dump($data)`php 代码中的输出（为便于阅读而添加了换行符：

```
string(405)
    "{\"attributes\":
        {\"type\":\"Generic_App__c\"},
    \"Application_Type__c\":\"iPay\",
    \"‌​Return_Email__c\":\"lsmith@cmsrep.com\",
    \"Name\":\"Bus Test\",
    \"ACHRejectFee__c\":\"123456789\",
    \"ApplicationDate__c\":\"2000-01-01\",
    \"B‌​usinessPhone__c\":\"(555) 123-4567\",
    \"Email__c\":\"thetest@testemail.com\",
    \"InternetPercentage2__c\":\"0\"‌​,
    \"MailingState__c\":\"CA\",
    \"MOTO7__c\":\"true\",
    \"NumOfLocations__c\":\"15\"
    }" 
```

通用应用程序只希望获得一个带有正确字段的 JSON 对象。当我通过 REST 客户端提交以下内容时，它按预期工作（再次添加换行符以提高可读性）：

```
{"attributes":
    {"type":"Generic_App__c"},
"Application_Type__c":"iPay",
"Return_Email‌​__c":"test@example.org",
"Name":"Bus Test",
"ACHRejectFee__c":"123456789",
"ApplicationDate__c":"2000-01-01",
"BusinessPho‌​ne__c":"(555) 123-4567",
"Email__c":"thetest@testemail.com",
"InternetPercentage2__c":"0",
"Mailing‌​State__c":"CA",
"MOTO7__c":"true",
"NumOfLocations__c":"15"} 
```

有人对如何解决这个问题有想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:57:38.360

从这些 var_dump 的外观来看，我会说您需要在使用 $data 之前从 $data 中去除这些斜线。试试[stripslashes](http://php.net/manual/en/function.stripslashes.php)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:03:29.740

[http_build_query](http://php.net/manual/en/function.http-build-query.php)也需要一个数组。由于您的数据已经是一个 json 字符串，我认为您应该忽略它。您可能需要对其进行 url 编码，但您应该只使用常规的[urlencode](http://php.net/manual/en/function.urlencode.php)函数。

另外，我不熟悉您正在使用的 php 上下文机制，并且我对 php.net 文档非常不满意，但我无法摆脱这种烦人的感觉，即`'content' => $data`它所做的不仅仅是设置内容。对于实际使用该`'content'`选项的流上下文，您是否有一个很好的文档链接？

# jquery - 执行另一个时 JQuery 临时禁用动画

> ID：15165534
> 
> 赞同：0
> 
> 时间：2013-03-01T19:40:23.857
> 
> 标签：jquery, jquery-animate

如何临时禁用动画？

我有一个`.move_box`，当你点击它时，它会展开。在那`.move_box`上面有一个**X**关闭盒子（相同的动画只有反向参数）。

问题是当您单击该**X**时，它将关闭该框并再次执行打开动画，因为**X**位于`.move_box`触发第一个动画的位置。

**HTML**

```
<div class="box move_box">
    <div class="box_title">
        <label>BODY CONDITION</label><h6 class="exit">X</h6>
    </div>
    <div class="box_image">
        <img src="http://ferringtonpost.com/wp-content/uploads/2012/07/Responsibilities-of-Owning-a-New-Puppy-Photo-by-bestdogsforkids.jpg" alt="" />
    </div>
</div> 
```

**jQuery**

```
$(document).ready(function(){
    $('.move_box').click(function(){
        $(this).find('.exit').show();
        $(this).css({"z-index":"20"});
        $(this).animate({"height": "529px", "width": "460px"}, "slow");
        $(this).find('img').animate({"width": "460px"}, "slow");
    });

    $('.exit').click(function(){
        $(this).parent().parent().find('img').animate({"width": "220px"}, "slow");
        $(this).parent().parent().animate({"height": "163px", "width": "220px"}, "slow");
        $(this).hide();
    });
}); 
```

[JSF](http://jsfiddle.net/SK37k/)中。

如何解决？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:49:18.560

因为 X 元素位于 .movi​​e_box div 内，所以当您单击 X 元素时，事件会传播到其父元素。你必须阻止它。

在 .exit 上为点击函数添加一个参数并调用方法 stopPropagation

```
$('.exit').click(function(e){
        $(this).parent().parent().find('img').animate({"width": "220px"}, "slow");
        $(this).parent().parent().animate({"height": "163px", "width": "220px"}, "slow");
        $(this).hide();
        e.stopPropagation();
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:42:27.367

```
$('.move_box').click(function(e){
    if ($(e.target).hasClass('exit')) {
        // the exit button was clicked, thus escape this handler
        return;
    } 
```

# c# - 从数据集中读取深度 png 图像

> ID：15165536
> 
> 赞同：1
> 
> 时间：2013-03-01T19:40:29.997
> 
> 标签：c#, image, color-depth

我们正在尝试使用[这个美国手语数据集](http://info.ee.surrey.ac.uk/Personal/N.Pugeault/index.php?section=SignLanguage)。该数据集包含美国手语字母的图片，包括 RGB 和深度图像。

我从链接下载了数据集。RGB 图像看起来不错，但深度图像完全是纯黑色。出了点问题。

由于所有数据集都很大，并且需要时间下载所有数据集；我在这里上传一个示例 RGB 图像和一个示例深度图像：

![示例 RGB 图像](../Images/c346567e5efd881178c8d6c1f3a1ab5e.png) ![示例深度图像](../Images/9a9f618161d83bdd2303d43a3306876c.png)

由于深度图像应该有深度数据，我希望它有浮点值（他们说他们使用了 Kinect，而 Kinect 提供了浮点值）。如何使用 C# 读取这些浮动像素？我尝试了以下方法：

```
Bitmap bmp = new Bitmap("depth_0_0002.png");
int R = bmp.GetPixel(0,0).R;
int G = bmp.GetPixel(0,0).G;
int B = bmp.GetPixel(0,0).B; 
```

但是，我需要浮点像素，它们是整数，并且它们具有无意义的值。

我是否需要包含第 3 方库？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:50:21.407

我自己试过了。通常深度数据是 16 位值。13 个高位包含距离，3 个低位包含用户分割图。

仅当骨架跟踪处于活动状态时才构建用户分割图，我相信您的示例中没有。虽然 rgb 值是 24 位，但它似乎可以工作。我从分割的手上得到一张图像。

```
Bitmap bmpOrg = new Bitmap("bKawM.png");
Bitmap bmp = new Bitmap(106, 119);

for (int i = 0; i < 106;i++ )
{
    for (int j = 0; j < 119;j++ )
    {
        Color rgb = bmpOrg.GetPixel(i, j);

        int bit24 = (rgb.B << 16 + rgb.G << 8 + rgb.R);
        int user = bit24 & 0x07;
        int realDepth = bit24 >> 3;

        bmp.SetPixel(i, j, Color.FromArgb(realDepth));
    }
}

pictureBox1.Image = bmp; 
```

我的输出：

![这就是它的样子](../Images/42568c2549ec03477f1b738dc3c42bb5.png)

我又玩过了。首先，我在 Photoshop 中增加了亮度和对比度。因此，如果您不需要以毫米为单位的实际深度值，则可以使用 rgb 值。

![增加亮度和对比度](../Images/2e7d844842645cad45051f1f6d6df537.png)

然后我尝试使用 WPF 从图像中获取 16 位值，因为图像是 16 位灰度编码的。

```
Stream imageStreamSource = new FileStream("bKawM.png", FileMode.Open, FileAccess.Read, FileShare.Read);
PngBitmapDecoder decoder = new PngBitmapDecoder(imageStreamSource, BitmapCreateOptions.PreservePixelFormat, BitmapCacheOption.Default);
BitmapSource bitmapSource = decoder.Frames[0];

int height = bitmapSource.PixelHeight;
int width = bitmapSource.PixelWidth;
int stride = width * ((bitmapSource.Format.BitsPerPixel + 7) / 8);

byte[] bytes = new byte[height * stride];
bitmapSource.CopyPixels(bytes, stride, 0);

for (int x = 0; x < width; x++)
{
    for (int y = 0; y < height; y++)
    {
        byte low = bytes[y * stride + x + 0];
        byte high = bytes[y * stride + x + 1];

        ushort bit16 = (ushort)((high << 8) | low);

        int user = bit16 & 0x07;
        int realDepth = bit16 >> 3;

    }
} 
```

我用深度值创建了一个新图像，它看起来很奇怪。我没有找到图像包含什么数据的任何信息。我不知道它是否包含用户数据（3 位），或者在保存到文件之前是否以某种方式转换了深度。

# asp.net-mvc-3 - 来自 IIS 或 MVC 的间歇性 ProviderException：API 因错误“传递给系统调用的数据区域太小而失败。'

> ID：15165539
> 
> 赞同：3
> 
> 时间：2013-03-01T19:40:38.893
> 
> 标签：asp.net-mvc-3, iis, asp.net-membership, authorization, windows-server-2008-r2

在 Windows Server 2008 R2 Enterprise (7601: SP1) 上运行 IIS 7.5.7600.16385。我们的一个网站设置为全局记录错误，我们每天或两天都会看到这种情况。我们在 web.config 中使用了一个授权属性来检查用户角色的访问权限，以及 IIS 或 MVC 使用的任何代码都会生成此错误。这通常由单个局部视图触发，但我们也看到它偶尔会在获取 css 或 js 资源时触发。

```
System.Configuration.Provider.ProviderException: API failed due to error 'The data area passed to a system call is too small. '
at System.Web.Security.WindowsTokenRoleProvider.GetRolesForUser(String username)
at System.Web.Security.RolePrincipal.IsInRole(String role)
at System.Web.Configuration.AuthorizationRule.IsTheUserInAnyRole(StringCollection roles, IPrincipal principal)
at System.Web.Configuration.AuthorizationRule.IsUserAllowed(IPrincipal user, String verb)
at System.Web.Configuration.AuthorizationRuleCollection.IsUserAllowed(IPrincipal user, String verb)
at System.Web.Security.UrlAuthorizationModule.OnEnter(Object source, EventArgs eventArgs)
at System.Web.HttpApplication.SyncEventExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
at System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean& completedSynchronously) 
```

我们网站的 IIS 设置是否不正确？知道发生了什么吗？我们可以通过日志中的用户名看到该用户正在通过 IWA 正确地进行身份验证。

# perl - Perl Dancer send_file 图像问题

> ID：15165545
> 
> 赞同：2
> 
> 时间：2013-03-01T19:41:06.327
> 
> 标签：perl, dancer

我有一个使用 GD 动态创建图像的 Perl Dancer Web 应用程序。我正在尝试将这些图像以 PNG 格式提供给用户。例如：

```
package MyApp;
use Dancer ':syntax';
use GD;
...
get '/dynamic_image/:var1/:var2' => sub {
   my $im = GD::Image->new(100,100);
   my $black = $im->colorAllocate(0,0,0);
   my $white = $im->colorAllocate(255,255,255);
   $im->rectangle(10,10,90,90,$white);
   my $png = $im->png;
   return send_file( \$png, content_type => 'image/png', filename => params->{var1}."_".params->{var2}.".png" );
}; 
```

但是，在访问上述路由时，Chrome 和 Firefox 似乎不知道如何处理图像数据。如果我尝试在 Lightbox 中使用该路由，Chrome 会抱怨。例如，当单击这样的链接时：

```
<a href="/dynamic_image/my/image" rel="lightbox">link</a> 
```

Chrome 的控制台说：

> 资源被解释为 Image 但使用 MIME 类型 application/octet-stream: " [http://www.example.com/dynamic_image/my/image](http://www.example.com/dynamic_image/my/image) "传输。

看起来 Dancer 没有正确使用 content_type。有趣的是，IE8 似乎可以很好地加载图像。知道发生了什么吗？我目前正在使用 Strawberry Perl v5.16.2 在 Windows 7 上独立运行它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T02:56:09.690

解释 IE 的不同行为：如果 IE 遇到 Content-Type `application/octet-stream`，它将尝试扫描文件以确定更具体的 MIME 类型。这种行为[在这里](https://stackoverflow.com/questions/9046117/chrome-browser-is-unable-to-show-this-image)得到了更多的介绍。

我建议使用 Perl 的 LWP 发行版中的 GET` 命令行工具来确认发生了什么。你可以试试这个：

```
GET -sSe http://www.example.com/dynamic_image/my/image | less 
```

结果应该包括`Content-Type`标题。听起来你会发现它说`application/octet-stream`. 这开始看起来像是 Dancer 的问题。

您没有指定您使用的 Dancer 版本。[旧版本不`content_type`支持`send_file()`](https://github.com/PerlDancer/Dancer/pull/405). 如果您正在阅读 CPAN 上的最新文档并期望它们适用于旧版本，则可能会有些混乱。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T13:03:24.227

这似乎不是舞者的问题。还有其他环境也会发生这种情况。 [资源解释为文档，但使用 MIME 类型图像传输](https://groups.google.com/forum/?fromgroups=#!topic/gsutil-discuss/Dye3xalLb9A)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-06T16:41:25.993

在对此进行了一段时间的抨击之后，我想我可以回答我自己的问题。Firefox 实际上向我提示了我自己代码中的一个错误。基本上，当在 Firefox 中访问动态创建的图像时，它会显示一个带有 HTTP 请求信息以及 PNG 数据的页面。我注意到页面上显示了一些调试文本。事实证明，我`print`在生成图像数据的循环之一中留下了 a （我用它来验证图像是否正确构建），并且该文本以某种方式使其成为“图像”本身 - 我认为这是导致Firefox 和 Chrome 有点吓人。所以这不是 Dancer 或应用程序错误，而是 PEBKAC 问题。谢谢大家的投入。

# html - 为什么这个 .svg 文件不转换为字体？

> ID：15165549
> 
> 赞同：1
> 
> 时间：2013-03-01T19:41:27.960
> 
> 标签：html, fonts, svg, icon-fonts

我正在尝试使用[http://icomoon.io/app/](http://icomoon.io/app/) app 将 .svg 文件转换为字体。我不知道为什么，但它不起作用。我之前已经尝试过使用其他文件，并且它有效。

这是 svg 图像的代码（如果您需要查看图片，只需将其粘贴到编辑器中并保存为 .svg 文件，我猜）我不确定，但我认为 svg 代码中可能有问题，是否取决于最新标准？

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="128pt" height="128pt" viewBox="0 0 128 128" version="1.1" xmlns="http://www.w3.org/2000/svg">
<path fill="#ffffff" d=" M 0.00 0.00 L 128.00 0.00 L 128.00 128.00 L 0.00 128.00 L 0.00 0.00 Z" />
<path fill="#010101" d=" M 53.05 7.85 C 69.60 4.58 87.31 9.41 100.07 20.39 C 100.09 32.60 100.02 44.80 100.02 57.00 C 100.22 60.35 98.92 63.52 97.31 66.38 C 94.98 70.57 92.63 74.75 90.33 78.95 C 89.56 78.96 88.03 78.97 87.27 78.97 C 83.90 84.45 80.91 90.15 77.90 95.83 C 79.17 96.72 80.45 97.58 81.74 98.44 C 80.54 100.57 79.09 102.65 78.71 105.13 C 82.31 106.41 82.80 101.95 84.36 99.87 C 85.56 100.39 86.71 101.06 88.00 101.35 C 89.27 100.96 89.70 99.54 90.37 98.54 C 92.93 93.79 95.58 89.09 98.16 84.36 C 97.57 83.89 96.39 82.95 95.80 82.48 C 98.60 76.74 102.24 71.44 104.82 65.58 C 107.10 60.38 106.35 54.59 106.48 49.08 C 106.59 41.93 106.35 34.77 106.69 27.62 C 115.57 37.75 119.81 51.61 119.26 64.98 C 118.75 80.67 111.02 95.89 98.83 105.75 C 87.62 115.07 72.58 119.59 58.09 118.04 C 42.23 116.69 27.40 107.80 18.19 94.90 C 5.63 77.77 4.45 53.31 15.17 35.00 C 23.09 21.06 37.25 10.76 53.05 7.85 Z" />
<path fill="#ffffff" d=" M 42.57 16.50 C 43.91 15.74 46.15 15.18 46.82 17.24 C 45.33 18.71 43.37 19.45 41.53 20.35 C 31.97 25.09 24.31 33.34 20.08 43.11 C 19.81 45.14 15.82 44.62 17.09 42.48 C 21.83 30.96 31.20 21.53 42.57 16.50 Z" />
<path fill="#ffffff" d=" M 24.15 46.38 C 28.38 35.64 37.29 26.97 48.08 22.92 C 49.71 23.36 49.78 25.53 48.24 26.05 C 39.99 29.47 32.89 35.71 28.77 43.65 C 28.00 45.20 27.09 46.68 26.07 48.08 C 25.59 47.66 24.63 46.81 24.15 46.38 Z" />
<path fill="#ffffff" d=" M 49.39 31.08 C 50.87 30.25 51.93 30.60 52.56 32.14 C 51.39 33.88 49.23 34.34 47.52 35.38 C 42.26 38.38 37.89 43.03 35.31 48.53 C 34.85 49.58 34.15 50.46 33.24 51.18 C 32.37 50.60 31.20 49.45 32.06 48.34 C 35.36 40.67 41.73 34.37 49.39 31.08 Z" />
<path fill="#ffffff" d=" M 57.12 43.35 C 64.70 40.81 73.62 43.30 78.78 49.39 C 85.63 57.22 85.03 70.27 77.30 77.29 C 70.25 84.18 58.20 84.72 50.68 78.29 C 44.68 73.57 41.68 65.19 43.75 57.79 C 45.27 51.06 50.57 45.44 57.12 43.35 Z" />
<path fill="#010101" d=" M 59.35 46.59 C 67.78 44.09 77.35 49.99 79.35 58.47 C 82.31 68.10 74.15 79.10 64.08 79.01 C 56.56 79.62 49.36 74.07 47.41 66.90 C 44.96 58.31 50.63 48.59 59.35 46.59 Z" />
<path fill="#ffffff" d=" M 57.86 62.84 C 57.21 57.61 64.96 54.74 67.86 59.24 C 71.45 63.49 66.35 69.54 61.41 68.10 C 59.77 66.76 57.55 65.28 57.86 62.84 Z" />
</svg> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-08T14:03:12.957

“问题”存在于应用程序中。

基本上它将每条路径更改为相同的颜色，因此白色重叠路径只是混合在一起。您可以删除第一条路径

```
<path fill="#ffffff" d=" M 0.00 0.00 L 128.00 0.00 L 128.00 128.00 L 0.00 128.00 L 0.00 0.00 Z" /> 
```

（这只是背景中不必要的正方形）以查看它是否确实有效。您必须将路径转换为形状，这样就不会有重叠而是“切割”。

* * *

出于无聊，我创建了工作版本：

```
<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 50 50" xml:space="preserve">
    <path d="M50,26.1c-0.2,7-3.7,13.9-9.2,18.3c-5,4.2-11.8,6.2-18.3,5.5 c-7.1-0.6-13.8-4.6-17.9-10.4C-1,31.8-1.5,20.8,3.3,12.6c3.6-6.3,9.9-10.9,17-12.2C27.7-1,35.6,1.1,41.4,6.1c0,5.5,0,11,0,16.4 c0.1,1.5-0.5,2.9-1.2,4.2c-1,1.9-2.1,3.8-3.1,5.6c-0.3,0-1,0-1.4,0c-1.5,2.5-2.9,5-4.2,7.6c0.6,0.4,1.1,0.8,1.7,1.2 c-0.5,1-1.2,1.9-1.4,3c1.6,0.6,1.8-1.4,2.5-2.4c0.5,0.2,1.1,0.5,1.6,0.7c0.6-0.2,0.8-0.8,1.1-1.3c1.1-2.1,2.3-4.2,3.5-6.4 c-0.3-0.2-0.8-0.6-1.1-0.8c1.3-2.6,2.9-5,4-7.6c1-2.3,0.7-4.9,0.7-7.4c0-3.2-0.1-6.4,0.1-9.6C48.3,13.9,50.2,20.1,50,26.1z M15.6,4.3C10.5,6.6,6.3,10.8,4.1,16c-0.6,1,1.2,1.2,1.3,0.3c1.9-4.4,5.3-8.1,9.6-10.2c0.8-0.4,1.7-0.7,2.4-1.4 C17.2,3.7,16.2,4,15.6,4.3z M18,7.2C13.2,9,9.2,12.9,7.3,17.7c0.2,0.2,0.6,0.6,0.9,0.8c0.5-0.6,0.9-1.3,1.2-2c1.8-3.6,5-6.4,8.7-7.9 C18.8,8.4,18.8,7.4,18,7.2z M18.6,10.9c-3.4,1.5-6.3,4.3-7.8,7.7c-0.4,0.5,0.1,1,0.5,1.3c0.4-0.3,0.7-0.7,0.9-1.2 c1.2-2.5,3.1-4.6,5.5-5.9c0.8-0.5,1.7-0.7,2.3-1.5C19.8,10.6,19.3,10.5,18.6,10.9z M31.8,19.1c-2.3-2.7-6.3-3.8-9.7-2.7 c-2.9,0.9-5.3,3.5-6,6.5c-0.9,3.3,0.4,7.1,3.1,9.2c3.4,2.9,8.8,2.6,11.9-0.4C34.6,28.4,34.9,22.6,31.8,19.1z M25.2,32.4 c-3.4,0.3-6.6-2.2-7.5-5.4c-1.1-3.9,1.4-8.2,5.4-9.1c3.8-1.1,8.1,1.5,9,5.3C33.4,27.5,29.7,32.4,25.2,32.4z M26.9,23.5 c-1.3-2-4.8-0.7-4.5,1.6c-0.1,1.1,0.9,1.8,1.6,2.4C26.2,28.1,28.5,25.4,26.9,23.5z"/>
</svg> 
```

# php - 在单个 SELECT 查询中设置 enable_seqscan = off

> ID：15165550
> 
> 赞同：7
> 
> 时间：2013-03-01T19:41:35.587
> 
> 标签：php, postgresql, indexing, query-optimization, settings

在对我的一个查询（Postgres）进行多次测试后，我意识到通过设置`enable_seqscan`= off，查询花费了其原始时间的 1/3（使用`psql`控制台完成`EXPLAIN ANALYZE`）

由于不建议为整个服务器更改此设置，因此我想将其设置为`OFF`仅用于此查询。
我该怎么做？是否可以？

我的实现基于框架 Kohana (PHP)，它使用 DB 对象 ( DB::select ) 来执行查询。

我的 postgres 在 CentOS Linux 上是 8.4.9。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-01T20:04:05.640

你可以[**`SET LOCAL`**](https://www.postgresql.org/docs/current/sql-set.html)在你的交易中使用它。我引用手册：

> 持续到当前事务结束的效果`SET LOCAL`，无论是否已提交。

但这就像在你不断生病而不是找到原因时吃抗生素一样。通常，计划者选择次优计划是有原因的。你应该找到并修复它。看：

*   [防止 PostgreSQL 有时选择错误的查询计划](https://stackoverflow.com/questions/8228326/how-can-i-avoid-postgresql-sometimes-choosing-a-bad-query-plan-for-one-of-two-ne/8229000#8229000)

我怀疑较低的设置[**`random_page_cost`**](https://www.postgresql.org/docs/current/runtime-config-query.html#GUC-RANDOM-PAGE-COST)可能对您有用。默认设置通常过于保守（过高）。如果您的大部分或全部数据库都被缓存（系统缓存会为重复使用并适合 RAM 的任何内容执行此操作），`random_page_cost`则可能几乎与[`seq_page_cost`](https://www.postgresql.org/docs/current/runtime-config-query.html#GUC-SEQ-PAGE-COST). `random_page_cost`是计算索引使用成本的主要因素。

确保它[`autovacuum`](https://www.postgresql.org/docs/current/routine-vacuuming.html)正在运行并正确配置（处理`VACUUM`和[**`ANALYZE`**](https://www.postgresql.org/docs/current/sql-analyze.html)）。您需要最新的列统计信息才能进行正确的查询计划。

并且[**`effective_cache_size`**](https://www.postgresql.org/docs/current/runtime-config-query.html#GUC-EFFECTIVE-CACHE-SIZE)经常开箱即用地设置得太低。

例外情况适用，有时查询规划器无法理解，尤其是旧版本。这让我想到了另一个微妙的问题：[**升级到当前版本**的 PostgreSQL](https://www.postgresql.org/support/versioning/)。你的已经过时了。

# vim - 如何在 Vim 中折叠代码和注释？

> ID：15165555
> 
> 赞同：0
> 
> 时间：2013-03-01T19:41:45.777
> 
> 标签：vim, folding

Vim 可以折叠 Ruby 代码，但不能折叠注释。

在 .vimrc 中添加它以将 foldmethod 更改为注释后，我无法再折叠代码。

```
autocmd FileType ruby,eruby
  \ set foldmethod=expr |
  \ set foldexpr=getline(v:lnum)=~'^\\s*#' 
```

如何配置 Vim 以折叠注释和代码？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-02T11:26:30.383

在我最近的 Vim 7.3.823 快照中，`$VIMRUNTIME/syntax/ruby.vim`（2009 年 12 月 2 日版本）具有 Ruby 构造和注释块的折叠功能。

就放

```
:let g:ruby_fold = 1 
```

进入`~/.vimrc`. （并确保您没有名为 的变量`ruby_no_comment_fold`。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:31:28.550

您可以使用`foldmethod=marker`和添加`{{{`/`}}}`标记（或您选择的其他标记）来指示折叠开始和结束的位置。

您还可以修改定义 ruby​​ 语法突出显示的文件，以调整它认为符合折叠条件的内容`foldmethod=syntax`。

第三种选择是开发一个更复杂的例程以用于`foldmethod=expr`. 例如，我使用[这里](https://github.com/aschrab/dotfiles/blob/master/vim/autoload/ruby.vim)定义的 vim 函数来定义如何折叠 ruby​​ 代码。它自动定义模块、类和方法的折叠以及紧接在它们之前的任何注释行；它支持折叠其他部分的标准折叠标记。它与`foldexpr=ruby#MethodFold(v:lnum)`.

更多关于折叠表达式应该如何表现的信息可以通过做找到`:help fold-expr`。还有一个不错的[vimcast](http://vimcasts.org/episodes/writing-a-custom-fold-expression/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T02:52:23.163

设置`foldmethod`为`indent`将根据缩进级别折叠行，无论该行是注释还是代码。

```
:set foldmethod=indent
:help fold-indent 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-23T16:19:21.573

我想你正在寻找

```
set foldignore=# 
```

如果您想折叠块评论（例如 /* .... */ 多行），请观看我[在 vi.stackechange 中的其他帖子](https://vi.stackexchange.com/questions/3512/how-to-fold-comments/5247#5247)

# php - 如何将金额四舍五入正确？

> ID：15165559
> 
> 赞同：3
> 
> 时间：2013-03-01T19:42:16.013
> 
> 标签：php, rounding

我对 php 中的 round() 有一点问题。我不知道，如果我真的做对了。（是订货系统）

$amount 可以是十进制 14,8 $price 可以是十进制 10,5（在数据库中）

我现在使用以下四舍五入 $price 是一个 $amount

```
function round_amount($amount) {
  return (float) round($amount, 8);
}

function round_price($amount) {
  return (float) round($amount, 5);
}

//if some one have more decimal chars like 10.000000009
round_amount(10.000000009); //will be 10.00000001

//if some one have more decimal chars like 10.000009
round_price(10.000009); //will be 10.00001

//also this is possible
round_price(round_amount(10.000000009)*round_price(10.000009)) 
```

这种方式使用round正确吗？一些用户使用超过 16 位小数。我在用户数据库中扣除/添加结果。

但我看到，有些用户的 5-10 美分太多了！

解决这个问题的唯一方法是只允许 8 位和 5 位小数吗？并警告用户，如果他尝试使用更多？但是我会遇到 round_cur(round_amount(10.000000009)*round_cur(10.000009)) 的问题

我希望有人理解我的意思，或者可以告诉我，如果我的四舍五入方法是正确的。

```
$amount = 10.12398413498579889173459873;
$price = 5.1938457198347695;

echo round_cur(round_amount($amount)*round_cur($price))."<br />";
echo round_cur($amount*$price);

//returns
//52.58245
//52.58241 
```

有趣的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T13:12:04.240

为什么不将数据库中的实际值缓存起来，然后有一个单独的变量来显示。这样，所有计算都可以在缓存的正确值上完成，同时保持干净的 UI。只要确保每次更新缓存变量时都更新显示的变量。

此外，在进行任何舍入之前始终应用数学。将两个精确数字相乘比将两个舍入数字相乘要准确得多。这适用于数学中的每一个运算。因此，加法、减法、除法、乘法然后四舍五入，但切勿将四舍五入的数字用于另一个公式。使用以前的确切数字。

* * *

## 回答 #2

> 赞同：-8
> 
> 时间：2013-03-01T19:52:28.993

我认为你的方式是正确的，但取决于你提到的情况，这两个公式返回不同的值，你是项目经理，哪个系统更适合你（你应该考虑什么最适合你和什么最适合用户并下定决心，看看您是否选择其中一个，交易将是什么），对于这种情况，我推荐第一种方法

```
round_price(round_amount(x)*round_price(y)) 
```

对于您的问题，一个好的通知或警告应该这样做。给用户一个例子。

# java - 在 Java 中使用 .substring 操作字符串

> ID：15165563
> 
> 赞同：0
> 
> 时间：2013-03-01T19:42:27.417
> 
> 标签：java, string, character, substring

我从一个文本文件中逐行读取，该文件包含一个字符串，后跟一个空格，后跟另一个字符串。这是我想用于我的方法的第二个字符串。

文本文件示例：

```
0h e3ne6t
ie 51b0x
6 8qlaqi
ty2 9j5dbb
nwz55 7lrwor 
```

所以我想要'e3ne6t'，然后是'51b0x'等。

我尝试使用 .substring 方法并尝试使用 " " 和 "\s" 作为空格的表示。

这是一段代码，可以让您很好地了解我想要实现的目标。

```
 while ((strLine = br.readLine()) != null) {
            lineNumber++;
            System.out.println("lineNumber = " + lineNumber);
            int index = strLine.indexOf(" "); // tried \\s
            System.out.println("index = " + index);
            strLine.substring(index);
            System.out.println(strLine);
            if (myString.equals(strLine)) {
                System.out.println("Match Found!");;
                System.out.println("myString = " + myString );
                System.out.println("strLine =" + strLine);
            }
        } 
```

我什至尝试将空白更改为“+”，但它仍然无法正常工作。

建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:43:46.030

`substring`不会改变你调用它的字符串的内容——没有任何改变，因为`String`在 Java 中是不可变的。相反，它*返回*一个新字符串，它是相关的子字符串。所以你可以使用：

```
strLine = strLine.substring(index); 
```

（对于类似`toUpperCase`,`trim`等的东西也是如此`replace`）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T19:44:03.100

字符串在 java中是**不可变的。**您需要将检索`substring`到的值重新分配给实际变量。

```
strLine=strLine.substring(index); 
```

另请注意，`indexOf(str)`它不采用正则表达式，因此`indexOf("\\s")`不会给您任何东西。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:52:03.127

正如其他人所提到的，字符串在 Java 中是不可变的。该`substring`方法返回一个新`String`的子字符串。但是如果你传递`index`给`substring`，那么你会得到一个以你的空格字符开头的子字符串，例如“e3ne6t”。所以我会用这个：

```
strLine = strLine.substring(index + 1); 
```

得到你的第二个领域，推进过去的空间字符，只要`index`不是`-1`（未找到）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-11-24T13:41:52.420

`.substring`使用Java操作字符串

[www.gleegrid.com/all_in_one/language/substring](http://www.gleegrid.com/all_in_one/language/substring)

# java - eclipse动态web项目默认起始页

> ID：15165569
> 
> 赞同：1
> 
> 时间：2013-03-01T19:42:43.663
> 
> 标签：java, eclipse, jsp, servlets

我创建了一个 Eclipse 动态 web 项目，home.jsp 在 WEB-INF 文件夹中

我使用的服务器是 Tomcat 7.0.35

项目的名称是 Pilot_1，我有一个 servlet，它在 URL 模式为 /home 时触发

```
@WebServlet(description = "Initalizes the table", urlPatterns = { "/home" }) 
```

我想指定 URL，以便每次按 Project > Run > Run on Server 时，URL 都是 localhost:8080/Pilot_1/home （同时触发 servlet 和 jsp 页面）。

我尝试将上下文根更改为仅“Pilot_1”，它提供了 URL“localhost:8080/Pilot_1”并且不会触发 servlet

我尝试将上下文根更改为“Pilot_1/home”，它提供了 URL“localhost:8080/Pilot/1/home/”，额外的“/”确保 servlet 不会触发

我尝试将 Context Root 更改为“home”，这给出了 URL“localhost:8080/home/”，并且再次，额外的 '/' 确保 servlet 不会触发

我一直在玩 URL，似乎唯一一次触发 servlet 是当 URL 为“localhost:8080/Pilot_1/home”时

有什么解决方法吗？

这是我的 web.xml

```
<welcome-file-list>
<welcome-file>index.jsp</welcome-file>
<welcome-file>default.jsp</welcome-file>
<welcome-file>home.jsp</welcome-file> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:44:25.187

不要弄乱上下文根。相反，转到`web.xml`文件并更改`welcome-file-list`：

```
<welcome-file-list>
    <!-- note that THIS IS NOT home.jsp, just home (the URL mapping of your servlet) -->
    <welcome-file>home</welcome-file>
</welcome-file-list> 
```

顺便说一句，还原您对应用程序上下文根所做的任何更改。

有关示例，请参阅[此答案。](https://stackoverflow.com/a/15150652/1065197)

# coldfusion - ColdBox 环境中的 CFSelect 绑定问题

> ID：15165572
> 
> 赞同：1
> 
> 时间：2013-03-01T19:43:06.753
> 
> 标签：coldfusion, bind, cfml, coldbox

我遇到了绑定问题，所以是时候咨询专家了。

我有一个绑定到 cfc 的 cfselect。

```
 <cfselect name="events" id="events" selected="#form.event_id#" 
 bind="cfc:feat.models.dynform.getEventsByGroup({groups})" display="event_name" 
 value="nd_event_id" queryPosition="below"> 
```

`"feat"`这在我的本地环境中运行良好，在我的本地`/www`目录下定义。我的问题是当我将它移动到我认为位于的开发服务器时`"beat"`，即：

```
 bind="cfc:beat.models.dynform.getEventsByGroup({groups})" 
```

我收到错误“找不到模型”，尽管模型在那里。我认为这是因为开发服务器的排列方式与我的本地服务器不同。ColdBox 配置中是否有关于这应该指向何处的线索？

`rc`我还尝试通过将模型放在集合中来更改绑定以调用模型（因此我不必使用与本地不同的标记） ：

```
 bind="cfc:#rc.dynformservice#.getEventsByGroup({groups})" 
```

但是，我收到一个错误“无法将复杂数据类型转换为字符串”。

有什么建议么？我欠你的任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T19:01:58.867

通过路径的冷箱方式是

```
 cfc:#getSetting('AppMapping')#.model.dynform... 
```

# python - TypeError：需要一个整数

> ID：15165577
> 
> 赞同：0
> 
> 时间：2013-03-01T19:43:25.090
> 
> 标签：python, typeerror

我已经完成了搜索，并且对相同错误的现有评论没有帮助

该行：

```
con = MySQLdb.connect(host = '127.0.0.1', user = 'root', passwd = '', db='vendors', port='3306') 
```

抛出：

```
Traceback (most recent call last):
  File "mysqlpython.py", line 12, in <module>
    con = MySQLdb.connect(host = '127.0.0.1', user = 'root', passwd = '', db='vendors', port='3306')
  File "/apollo/env/AWSSDKMetrics/lib/python2.7/site-packages/MySQLdb/__init__.py", line 81, in Connect
    return Connection(*args, **kwargs)
  File "/apollo/env/AWSSDKMetrics/lib/python2.7/site-packages/MySQLdb/connections.py", line 188, in __init__
    super(Connection, self).__init__(*args, **kwargs2)
TypeError: an integer is required 
```

对整数的引用是什么？它指的是哪个领域？请记住，我不是 Python 程序员或开发人员。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:44:55.850

您需要将端口指定为数字，而不是字符串：

```
con = MySQLdb.connect(
    host='127.0.0.1',
    user='root', passwd='',
    db='vendors', 
    port=3306) 
```

我使用了多行来使上面的示例更具可读性；错误指出 for 的值`port`必须是整数。

# php - 在php中生成组合

> ID：15165580
> 
> 赞同：0
> 
> 时间：2013-03-01T19:43:32.103
> 
> 标签：php, combinations

我有一个包含几个单词的数组，例如`String A`, `String B`, `String C`（或更多）

```
$array = array('A','B','C'); 
```

如何获取新数组中的所有组合，如下所示：

```
$result = array(
                'A,B,C',
                'A,C,B',
                'B,C,A',
                'B,A,C',
                'C,A,B',
                'C,B,A',

                'A,B',                              
                'A,C',
                'B,A',
                'B,C',
                'C,A',
                'C,B',

                'A',
                'B',
                'C'
); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:46:28.813

```
 <?php

$array = array('A', 'B', 'C', 'D');

function depth_picker($arr, $temp_string, &$collect) {
    if ($temp_string != "") 
        $collect []= $temp_string;

    for ($i=0; $i<sizeof($arr);$i++) {
        $arrcopy = $arr;
        $elem = array_splice($arrcopy, $i, 1); // removes and returns the i'th element
        if (sizeof($arrcopy) > 0) {
            depth_picker($arrcopy, $temp_string ." " . $elem[0], $collect);
        } else {
            $collect []= $temp_string. " " . $elem[0];
        }   
    }   
}

$collect = array();
depth_picker($array, "", $collect);
print_r($collect);

?> 
```

代码来自stackoverflow： [StackOverflow Link](https://stackoverflow.com/questions/10834393/php-how-to-get-all-possible-combinations-of-1d-array)

# model-view-controller - Emberjs 我应该为此使用控件吗

> ID：15165583
> 
> 赞同：0
> 
> 时间：2013-03-01T19:43:34.173
> 
> 标签：model-view-controller, ember.js, ember-data

我正在尝试构建一个 FedEx 风格的调度板。这看起来就像日历上的周视图，但它会有驱动列而不是天。行程应该能够在列之间拖放并显示在正确的时间高度。

在处理实际代码之前，我正在抽象以确保我有正确的逻辑。

![白板说明模板中的控制器](../Images/c94f3c57ac01389d8a28335e1e8e5848.png)

所以可以说我在索引控制器上有一个日期。选择一个日期将加载该日期的时间表。时间表包含司机，每个司机都有行程。

我用什么控制器来处理行程？内容因列而异，但每列都需要可见。我还需要向这些可能使用视图的事件添加事件，但 ember 只会加载一次视图。我确定我只是错过了一些基本的东西，但我发现的所有 ember 应用程序示例都涉及单击列表项并为此加载视图。

我是否正在考虑使用正确的 mvc 设置的应用程序？我应该以不同的方式解决问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T19:55:52.513

Ember RC1在遍历把手中的列表时[引入了 itemController 的概念：](http://emberjs.com/blog/2013/02/15/ember-1-0-rc.html)

```
{{each trip in tripList itemController='trips'}}
    {{view YourApp.TripView}}
{{/each}} 
```

这样，您的每个行程实例都可以拥有自己的行程控制器。我们正在做类似的事情，这实际上为我们节省了很多工作。

# c# - 有效地查找两个数组中重叠的值并将它们保存在第三个数组中

> ID：15165585
> 
> 赞同：3
> 
> 时间：2013-03-01T19:43:37.263
> 
> 标签：c#

假设我有2个数组......

```
string[] a = {"a", "b", "c", "d", "e", "f", "h", "i", "j", "k"};
string[] b = {"a", "c", "d", "e", "g"};
string[] c; 
```

我想创建一个结果数组 c ，其中包含重叠值的列表。所以对于上面我会得到以下结果：

```
c = {"a", "c", "d", "e"}; 
```

我怎样才能有效地做到这一点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T19:45:15.373

最简单的方法——也是有效的——是使用 LINQ 的[`Intersect`](http://msdn.microsoft.com/en-gb/library/system.linq.enumerable.intersect.aspx)方法：

```
c = a.Intersect(b).ToArray(); 
```

这将在`HashSet<T>`内部使用 a 来跟踪仍然可以返回的值。有关更多详细信息，请参阅我的[Edulinq 博客文章。`Intersect`](http://msmvps.com/blogs/jon_skeet/archive/2010/12/30/reimplementing-linq-to-objects-part-16-intersect-and-build-fiddling.aspx)

请注意，结果实际上是一个*集合*- 不能保证顺序（尽管实际上它将是元素出现的顺序`a`）并且每个值只会出现*一次*，即使它在两个原始数组中都重复。

请注意，如果您只需要遍历结果，则根本不将其转换为数组会更有效：

```
IEnumerable<string> intersection = a.Intersect(b); 
```

编辑：要查找索引，您可以*使用*LINQ 做一些技巧，或者只是简单地迭代地做：

```
HashSet<string> remaining = new HashSet<string>(b);
List<Tuple<string, int>> pairs = new List<Tuple<string, int>>();
for (int i = 0; i < a.Length; i++)
{
    if (remaining.Remove(a[i]))
    {
        pairs.Add(Tuple.Of(a[i], i));
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T19:45:17.140

Linq 中的[`Intersect`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.intersect.aspx)方法可以满足您的需求。

```
 c = a.Intersect(b).ToArray(); 
```

# sql-server-2008 - sql server 2008 中的循环问题

> ID：15165587
> 
> 赞同：2
> 
> 时间：2013-03-01T19:43:40.310
> 
> 标签：sql-server-2008

我的查询遇到问题：

```
select week_number
    ,year
from accounting_calender
where week_number<=3
and week_number>3-6
and year=2013 
```

在这个查询中，我通过我的报告工具传递了 week_number`3`和 year 。`2013`

我得到以下输出：

```
| Week_number | year |
----------------------
|    3        | 2013 |
|    2        | 2013 |
|    1        | 2013 | 
```

但在我的会计日历表中，我也返回了 2012 年的条目。

所以在这里我要减去`-6`，所以它也必须转到前一年的几周。

我正在寻找类似以下输出的内容：

```
| Week_number | year |
----------------------
|   51        | 2012 |
|   52        | 2012 |
|   53        | 2012 |
|    3        | 2013 |
|    2        | 2013 | 
|    1        | 2013 | 
```

我有只读权限。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:04:41.177

将您的周和年转换为日期将使您更容易对日期范围进行添加：

```
DECLARE @Week_Number INT
DECLARE @Year INT
DECLARE @WeeksToGet INT

SET @Week_Number = 3
SET @Year = 2013
SET @WeeksToGet = 6

DECLARE @StartDate DATETIME
DECLARE @EndDate DATETIME

SET @EndDate = DATEADD(WEEK, @Week_Number, DATEADD(YEAR, @Year - 1900, 0))
SET @StartDate= DATEADD(WEEK, -6, @EndDate)

select
    week_number,
    year
from accounting_calender
where 
    DATEADD(WEEK, week_number, DATEADD(YEAR, year - 1900, 0)) between
    @StartDate AND @EndDate 
```

但是，请注意，这会混淆您在`week_number`和上的任何索引`year`。如果这是一个问题，您可以考虑将这些列更改为一种`DATE`类型，这样您就可以避免将两列转换为一个日期。

## [Sql 小提琴](http://sqlfiddle.com/#!3/361b3/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:05:27.923

您需要添加前 6 周跨越一年边界的特殊情况：

```
select
  week_number,
  year
from
  accounting_calender
where
  (week_number > @week-6 and week_number <= @week and year=@year)
or
  (week_number > @week-6+53 and year=@year-1) 
```

如果`@week >= 6`，则第二个条件将始终`> 53`如此，因此它将无效。但是，如果`@week < 6`，则第二个条件将是`52`，`51`，等等。

# c# - 我将如何在具有压力敏感性的绘画程序中进行绘图？

> ID：15165591
> 
> 赞同：0
> 
> 时间：2013-03-01T19:43:46.260
> 
> 标签：c#, winforms, drawing, tablet, system.drawing

我正在编写一个绘图程序，使用 C# .Net/WinForms 并且压力敏感度是必须的。我已经设置好一切，并且正在从数位板笔获取压力信息。这些都不是问题。

我遇到的麻烦是，我将如何使用您典型的简单绘画程序（即“涂鸦”）并使用我获得的压力数据进行绘制？Scribble 类型的简单应用程序在启用绘图时跟踪当前和以前的光标位置，并在它们之间绘制线条。但是通过捕获光标位置放置的每个点都是使用固定宽度的线绘制的。

假设我有我需要的所有数据：xy 位置和笔压，我将如何开始考虑在应该是不同宽度的点之间绘图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:49:07.553

我会将您的总 xy 位置分解为许多较小的 xy 位置（长度可能是一两个像素），并相应地应用与笔压力相对应的宽度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-11T04:48:14.047

最简单的方法是跟踪前一个点和前一个尺寸（基于压力），然后使用前一个尺寸作为线条尺寸从前一个点到当前点绘制一条线。

如果您确保不在事件处理程序代码中创建新对象，即使这样使用 GDI+ 也很快。

我提到的另一种方法要先进得多（尽管可能会产生更好的结果），我可能会在以后实现它，当我做所有基于向量的事情时。

# python - 在 chromedriver 中使用 python 绑定为 selenium 设置 chrome.prefs

> ID：15165593
> 
> 赞同：13
> 
> 时间：2013-03-01T19:43:49.000
> 
> 标签：python, selenium, selenium-chromedriver

我整天都在寻找这个，似乎目前没有可用的解决方案可以从 python 的 chromedriver 实现中获得。

如何使用 webdriver.Chrome() 方法设置特定的 chrome.prefs（例如 profile.managed_default_content_settings.images = 2 等配置文件设置）？

我已经通过 webdriver.ChromeOptions() 尝试过，但没有成功。在 Java 中，有适当的函数可以实现这一点。

但是Python？这就是我目前正在做的......

```
 options = webdriver.ChromeOptions()
    options.add_argument('--allow-running-insecure-content')
    options.add_argument('--disable-web-security')
    options.add_argument('--disk-cache-dir=/var/www/cake2.2.4/app/tmp/cache/selenium-chrome-cache')
    options.add_argument('--no-referrers')
    options.add_argument('--window-size=1003,719')
    options.add_argument('--proxy-server=localhost:8118')
    options.add_argument("'chrome.prefs': {'profile.managed_default_content_settings.images': 2}")

    self.selenium = webdriver.Chrome(executable_path='/usr/local/bin/chromedriver',chrome_options=options) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-01-16T13:21:04.823

对于任何想要在 chromedriver 中禁用图像的人，以下代码可能会对您有所帮助。

```
from selenium.webdriver.chrome.options import Options
chrome_options = Options()
chrome_options.add_experimental_option( "prefs", {'profile.default_content_settings.images': 2})
driver = webdriver.Chrome(chrome_options=chrome_options) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-04-11T06:49:35.060

对于遇到这个问题的其他人来说，这只是一个小更新。

对于较新的版本，以下代码可以正常工作：

```
options.add_experimental_option('prefs', {'download.default_directory':'C:\\temp'}) 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2015-12-08T10:06:50.290

这适用于从至少 2.15 到当前版本 2.20 的最新 chromedriver 版本：

```
chrome_options = Options()
chrome_options.add_experimental_option( "prefs", {'profile.managed_default_content_settings.images': 2})
chrome = webdriver.Chrome('/path/to/chromedriver',chrome_options=chrome_options)
chrome.get("https://google.com") 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-20T00:25:53.253

使固定：

有一个解决方案是避免使用 chromeoptions 对象并恢复到所需的功能字典（已弃用）。出于某种原因，selenium 库中的 webdriver.py 将一个空的 chromeoptions 字典添加到了 desiredcapabilities 字典中，这使其无用。所以你需要在 webdriver.py 中取消注释第 54 行

```
desired_capabilities.update(options.to_capabilities()) 
```

然后使用此代码将所有所需的功能传递给 chromedriver

```
CHROME = {
"browserName": "chrome",
        "version": "",
        "platform": "ANY",
        "javascriptEnabled": True,
        "chrome.prefs": {"profile.managed_default_content_settings.images": 2},
        "proxy": {
            "httpProxy":"localhost:8118",
            "ftpProxy":None,
            "sslProxy":None,
            "noProxy":None,
            "proxyType":"MANUAL",
            "class":"org.openqa.selenium.Proxy",
            "autodetect":False
            },
        "chrome.switches": ["window-size=1003,719", "allow-running-insecure-content", "disable-web-security", "disk-cache-dir=/var/www/cake2.2.4/app/tmp/cache/selenium-chrome-cache", "no-referrers"],
        }

    self.selenium = webdriver.Chrome(desired_capabilities=CHROME) 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-03-23T19:19:21.260

对于任何在 Python 语法中苦苦挣扎的人，这里有一个完整的工作示例。它会禁用 Chrome 的“您希望 Google Chrome 保存此站点的密码吗？” 迅速的。另请参阅[WebDriver Chrome 浏览器：避免弹出 'Do you want chrome to save your password'](https://stackoverflow.com/questions/16301457/webdriver-chrome-browser-avoid-do-you-want-chrome-to-save-your-password-pop-u/42985071)。

```
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
chrome_options = Options()
chrome_options.add_experimental_option('prefs', {
    'credentials_enable_service': False,
    'profile': {
        'password_manager_enabled': False
    }
})
driver = webdriver.Chrome(chrome_options=chrome_options)
driver.get('https://google.com') 
```

# java - Java：可以仅使用 URL 和 URLConnection 在 ftp 上创建不存在的目录吗？

> ID：15165594
> 
> 赞同：0
> 
> 时间：2013-03-01T19:43:49.960
> 
> 标签：java, url, ftp, java-7

是否可以仅使用 URL 类或 URLConnection 类在 Java 中创建一个不存在的目录？

通常我使用类似的东西

`new URL("ftp://"+usr+":"+pass+"@"+srvr+""+existing_dir+""+file).openConnection()`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-30T06:57:03.320

我现在使用 Commons Net Library 和他们的 FTP 解决方案。

所以现在我只需要运行 `client.makeDirectory("directory");`

# wordpress - wordpress中的ajax错误

> ID：15165596
> 
> 赞同：-2
> 
> 时间：2013-03-01T19:44:03.560
> 
> 标签：wordpress

我已经在 wordpress admin 中创建了页面。我在其中使用了 ajax，但它不工作它总是运行错误部分并显示错误函数中的消息。ajax 中的文件 url 在模板中，我已经尝试了所有路径，但没有显示成功消息。请让我知道如何分配文件路径或获取显示错误警报的原因？

我正在使用以下代码

```
 var jqxhr =
  $.ajax({
    url: "http://www.example.com/data.php",
    data: {
        name : "The name",
        desc : "The description"
    }
})
.success (function(response) { alert("Success: " + response) ; })
.error   (function()     { alert("Error")   ; })
.complete(function()     { alert("complete"); })
; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:18:29.817

根据您从 .success 或 .complete 获得的响应，您可以执行类似的操作

```
if (response == "error") { alert ("Error"); } 
```

您的 Ajax 已成功发送信息，因此不会出错。

如果存在不满足的条件，您的后端 PHP 必须返回错误

```
if (some condition) { 
    //do something 
} else echo "error"; 
```

# ibm-mobilefirst - 工作灯跟踪

> ID：15165597
> 
> 赞同：0
> 
> 时间：2013-03-01T19:44:11.040
> 
> 标签：ibm-mobilefirst, worklight-appcenter

我仍然无法通过 IBM 应用中心成功下载/安装应用程序，以查看新应用程序在移动设备上的外观。

2个简单的问题：

1) 如果一个应用程序，我们称之为 myapp，通过 IBM 应用程序中心成功下载/安装，那么 myapp 是否只是设备上的一个独立的新应用程序，或者 myapp 是如何“嵌入”在 worklight 应用程序中心应用程序中的？

2）如果我通过其他方式（不是通过 IBM 应用中心）将 myapp 部署到三星平板电脑，那么 worklight 服务是否会知道 myadd 安装在这个特定的三星设备中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:59:48.147

1.  该应用程序将是独立的。例如，您可以通过 Application Center 移动客户端或通过设备操作系统允许您执行的常规程序卸载它。

2.  假设应用程序具有 connectOnStartup=true，并且您将应用程序部署到 Worklight Server，答案将是肯定的。（Application Center 不是 Worklight Server 的替代品，如果您打算让您的应用程序使用 Worklight Adapters 等功能，您仍必须将其部署在那里）。

# c - C - 老实说，对这种奇怪的行为不知所措

> ID：15165601
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:44:24.007
> 
> 标签：c

所以......我有一小段代码我已经在早上的大部分时间里工作了。这只是一个帮助我记住语法等的小项目。由于我不明白的原因，代码返回了分段错误，因此我显然错过了某种巨大的错误。

```
#include <stdio.h>
#include <stdio.h>
#include <unistd.h>
#include <time.h>
#include <getopt.h>

struct cards 
{
int card_value[99];
char card_name[99];
char card_suit[99];
int card_tally;
};

struct cards hand[2];

void tally (int a)
{
int k, j;
for (k=0; k<5; k++)
 {
  j = j + hand[a].card_value[k];
 }
hand[a].card_tally = j;
 }

 void check_for_ace (int a)
 {
int d;
for (d=0; d>5; d++)
  { 
    if (hand[a].card_name[d] =='A')
      {
          int y;
          int z = 10;
          for (y=0; y<5; y++)
            z = z + hand[a].card_value[y];
          if (z < 22)
            hand[a].card_value[d]=10;
          else
            hand[a].card_value[d]=1;
      }

   }
}

void draw_card (int a)
{
int z = 1 + rand () % 13;
int x=0;

while (hand[a].card_value[x] !=  0)
    { x++; }

if ((z > 1) && (z < 10))
  {
      hand[a].card_value[x]=z;
      hand[a].card_name[x]=((char) '0' + z);
  }
else if (z == 10)
  {
      hand[a].card_value[x]=z;
      hand[a].card_name[x]='T';
  }
else if (z == 11)
  {
      hand[a].card_value[x]=10;
      hand[a].card_name[x]='J';
  }   
else if (z == 12)
  {
      hand[a].card_value[x]=10;
      hand[a].card_name[x]='Q';
  }
else if (z == 13)
  {
      hand[a].card_value[x]=10;
      hand[a].card_name[x]='K';
  }
else if (z == 1)
  {
      /*Function 'check_for_ace' deals with this more properly*/
      hand[a].card_value[x]=1;
      hand[a].card_name[x]='A';
  }
 check_for_ace(a);
 tally(a);
}

void display_hands ()
{
int x;
printf("\nDealer's Hand Shows: ");
for (x=0; hand[0].card_name[x]!=0; x++)
  {
      printf("%c ", hand[0].card_name[x]);
  }

printf("\nPlayer's Hand Shows: ");
for (x=0; hand[1].card_name[x]!=0; x++)
  {
      printf("%c ", hand[1].card_name[x]);
  }
}

void dealer_turn()
{
  while (hand[0].card_tally < 17)
  draw_card(0);
}

void player_turn()
{
int op=0;
while (op != 2)
  {
    printf("What would you like to do?\n");
    printf("(1)it or (2)tand\n");
    scanf("%d", &op); 
    if (op == 1)
     draw_card(1);

  }
}   

int main(int argc, char **argv)
{
srand(time(NULL));

    draw_card(0);
    draw_card(1);
    draw_card(1);
    display_hands();
    player_turn();

    dealer_turn();
    display_hands();

return 0;
} 
```

现在，真正奇怪的是，看到 player_turn 和 Dealer_turn 之间的空线了吗？如果我将 display_hands 放在那里，代码将毫无错误地执行。

有任何想法吗？

另外，我意识到我确实使用了不需要的标题。我计划稍后使用它们，并将它们留在这篇文章中，这样我就可以将所有内容与错误保持原样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T19:48:28.283

在执行此行之前，您没有初始化 j 。

```
 j = j + hand[a].card_value[k]; 
```

当我`j=0`向您的代码添加初始化时，它不再崩溃。

例如

```
void tally (int a)
{
int k, j;
j=0;  /* <----- added this line */
for (k=0; k<5; k++)
 {
  j = j + hand[a].card_value[k];
 }
hand[a].card_tally = j;
 } 
```

# linux - 为什么 perl 编译的代码占用更多内存？

> ID：15165604
> 
> 赞同：1
> 
> 时间：2013-03-01T19:44:40.410
> 
> 标签：linux, performance, perl, memory

以下是一个示例代码文件，其名称为`while.pl`.

```
#!/usr/bin/perl
use strict;
use warnings;
my $i=0;
while (1)
{
  print "Testing $i\n" ;
  $i++ ;
  sleep(1);
} 
```

我已经通过使用编译了这段代码

```
perlcc -o compiled while.pl 
```

然后我执行正常代码`while.pl`和编译代码`compiled`。我使用`ps`命令观察了内存和 CPU 的使用情况

```
ps axo %cpu,%mem,command | grep "while\|compiled"

0.0  0.0 /usr/bin/perl ./while.pl
0.0  0.1 ./compiled 
```

所以我的问题是：

*   为什么编译后的代码与 相比占用更多内存`while.pl`？
*   以及如何避免编译的 perl 代码的内存使用？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:59:09.267

Perl 代码总是被编译的。您正在做的是提前而不是在运行时编译它。

在运行时加载已编译的表单需要更多内存，因为您将已编译的表单加载器加载到通常加载的所有内容之上。

# javascript - jquery滑块在刷新之前不起作用

> ID：15165610
> 
> 赞同：0
> 
> 时间：2013-03-01T19:45:08.130
> 
> 标签：javascript, jquery, slider, refresh, slideshow

我有一个简单的 jquery 幻灯片，应该在我的主页加载时开始。它有效，但只有在我刷新页面一两次之后。这是我正在使用的代码：

```
 <!-- include jQuery library -->
<script type="text/javascript" src="js/javascript.js"></script>
    <!-- include Cycle plugin -->
<script type="text/javascript" src="js/Jquery2.js"></script>
<script type="text/javascript">
$(document).ready(function() { 
    $('.image').cycle({
          fx: 'fade',
          random: '1'
          });});      
</script> 
```

任何帮助将不胜感激！提前致谢！！

-西奥

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:57:26.663

改变

```
<script type="text/javascript">
$(document).ready(function() { 
$('.image').cycle({
      fx: 'fade',
      random: '1'
      });});      
</script> 
```

和

```
<script type="text/javascript">
$(window).load(function() { 
$('.image').cycle({
      fx: 'fade',
      random: '1'
      });});      
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:50:58.427

我认为所有图像都没有加载

```
$('img').load(function() {
    $('.image').cycle({
          fx: 'fade',
          random: '1'
          });});      
}); 
```

阅读更多：[检查图像是否已加载？](https://stackoverflow.com/questions/5424055/check-if-images-are-loaded)

# c# - 基于 InnerXML 对 XDocument 元素进行排序

> ID：15165612
> 
> 赞同：1
> 
> 时间：2013-03-01T19:45:09.510
> 
> 标签：c#, xml, linq, entity-framework, linq-to-xml

我有一个与此类似的 XML 文档：

```
<document>
    <post>
      <author>Bill Smith</author>
      <subject>Test Article</subject>
      <dates>
          <uploaded>some date</uploaded>
          <published>some date</published>
      </dates>
      <price>
           <provider>Amazon</provider>
           <cost>1540</cost>
      </price>
      <price>
           <provider>WH Smith</provider>
           <cost>2640</cost>
      </price>
    </post>
    <post>
      <author>Bill Smith</author>
      <subject>Test Article</subject>
      <dates>
          <uploaded>some date</uploaded>
          <published>some date</published>
      </dates>
      <price>
           <provider>Amazon</provider>
           <cost>1540</cost>
      </price>
      <price>
           <provider>WH Smith</provider>
           <cost>2640</cost>
      </price>
    </post> 
</document> 
```

我正在使用带有 .NET 4.5 的 XDocument。我知道还有其他方法可以用来排序。

我可以将每个帖子拉出并将其放入帖子模型中。但是，我想对价格元素进行排序并挑选出最低价格（以及提供者），以便我可以将其插入到我的 EF 数据库中。

任何帮助将不胜感激，我完全不知道从哪里开始。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:18:08.367

你可以试试这个：

```
 XDocument doc = XDocument.Load(@"Data.xml");
        var elements = doc.Root
            .Elements("post")
            .Select(post => new
            {
                Author = post.Element("author").Value,
                Subject = post.Element("subject").Value,
                Uploaded = Convert.ToDateTime(post.Element("dates").Element("uploaded").Value),
                Published = Convert.ToDateTime(post.Element("dates").Element("published").Value),
                Price = new
                {
                    P = post
                        .Elements("price")
                        .OrderByDescending(price => Convert.ToDecimal(price.Element("cost").Value))
                        .Select(o => new
                        {
                            Provider = o.Element("provider").Value,
                            Cost = Convert.ToDecimal(o.Element("cost").Value)
                        })
                        .First()
                }
            });

        var p = elements.First(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:33:26.520

根据您提供的代码，看看是否可行：

```
var xmlDocumentElement = xDocument.Load("xmlData.xml").Root;

var posts = xmlDocumentElement.Elements("post").Select(post => new 
    {
    Author = post.Element("author").Value.ToString(),
    Subject = post.Element("subject").Value.ToString(),
    AvailableDate = DateTime.Parse(post.Descendants("dates").FirstOrDefault().Value),
    Price = GetPriceFromPriceXElement(post.Elements("price").Aggregate((prev, next) => 
            Decimal.Parse(prev.Element("cost").Value.ToString()) <= Decimal.Parse(next.Element("cost").Value.ToString()) ? prev : next ))
    }
    );

public Price GetPriceFromPriceXElement(XElement price)
{
   return new Price
    { 
        Provider = price.Element("provider").Value.ToString(),
        Cost = price.Element("cost").Value.ToString()
    };
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:05:59.663

试试这个。它应该工作。一旦你有数据，你可以按摩它。请注意`NULL`等。这只是围绕您的要求的基本想法。

```
 XDocument doc = XDocument.Load(@"XMLFile1.xml");
        var posts = doc.Root.Elements("post")
                   .Select(p =>
                            new
                            {
                               Author = p.Element("author").Value,
                               Price = p.Elements("price").OrderBy(a => decimal.Parse(a.Element("cost").Value)).First()
                     });

        foreach(var a in posts)
        {
            Console.WriteLine(a.Author + " " + a.Price);
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-02T00:23:20.967

这是一个非常简单的尝试（实际上与 Ivan G 的答案非常相似）：

```
var posts = from post in document.Root.Elements("post")
            select new
            {
                Author = post.Element("author").Value,
                Subject = post.Element("subject").Value,
                Uploaded = DateTime.Parse(post.Element("dates").Element("uploaded").Value),
                Published = DateTime.Parse(post.Element("dates").Element("published").Value),
                Price = (from price in post.Elements("price")
                         let cost = decimal.Parse(price.Element("cost").Value)
                         orderby cost
                         select new
                         {
                             Provider = price.Element("provider").Value,
                             Cost = cost
                         }).First()
            }; 
```

它适用于您提供给我们的示例数据（“某个日期”的日期除外）。

如果数据可能不完整或错误（即缺少/拼写错误的节点或错误的数据类型），我建议只取每个`XElement`而不是值：`Author = post.Element("author")`等。也许您希望允许没有上传或发布日期的帖子。这样您就可以稍后检查和/或转换/转换数据，并可能正确解决问题。

# java - Java继承，扩展类如何影响实际类

> ID：15165619
> 
> 赞同：8
> 
> 时间：2013-03-01T19:45:27.307
> 
> 标签：java, inheritance, final

我正在查看 Sun 认证学习指南，其中有一段描述了最终修饰符。它说

“如果程序员可以自由地扩展我们所知道的 String 类文明，它可能会崩溃”

他什么意思 ？如果可以扩展 String Class ...我会不会有一个名为 MyString 的类继承所有 Strings 属性。仅通过扩展它怎么可能以任何方式更改实际的 String 类？

非常感谢您的回答

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T19:51:56.783

嗯，一个问题是，如果您可以继承 String 类，那么您很可能会以多种方式破坏 jvm 的安全性。许多权限检查各种字符串值以确定是否允许给定操作。如果您的代码提供字符串值，那么您可以返回一个 String 实例，当安全管理器查看它时该实例会“检出”，但稍后会像一个完全不同的值一样。

例如，假设您有一些敏感的 jvm 范围配置：

```
public static void registerProvider(String providerName, Provider impl) {
  SecurityManager sm = ...;
  if(sm != null) {
    // say the check provider method doesn't allow strings starting with "com.sun."
    sm.checkProvider(providerName);
  }
  _providerMap.put(providerName, impl);
} 
```

现在，我实现了一个自定义 String ，如果传递了 value ，它会覆盖`startsWith()`要返回的方法，但我的 String 的实际值*确实*以.`false``"com.sun."`*`com.sun.`*

 *当然，更不用说字符串是不可变的一般期望，如果被破坏，可能会导致各种普遍的破坏（如其他答案中更详细地提到的那样）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-01T19:51:48.263

扩展类不会影响基类。但是，它可能会影响基类的*消费者*。

因此，假设您*能够*扩展`String`，您可以编写如下内容：

```
class MyString extends String {

    @Override
    public int length() {
        System.exit();
    }
} 
```

现在你将这个类传递给任何使用字符串的东西，你很可能会很快退出程序。不是文明的终结，而是你可以做一些更险恶的事情。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-01T19:52:07.163

考虑到在整个 Java API 中，您将看到如下结构：

```
HashMap<String, Object> map; 
```

它使用字符串进行索引。一个非常常见的事情，例如对于财产和 - 这**在安全相关的地方**可能是最糟糕的。此代码依赖于未经修改的代码`String`来保持安全。

但是现在让您修改后的`String`类允许例如就地反转字符串。

然后我们所知道的世界就会崩溃，因为到处都是地图会变得一团糟。日志记录会崩溃，等等。

**很多代码依赖于`String`类是不可变**的，好吧，如果它真的是不可变的，那么你还想添加什么功能呢？

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T19:53:41.407

扩展一个类根本不会影响该类。然而，由于任何继承的类也是基类，它应该遵守基类的行为契约。如果程序员要更改常见的框架类型，那么您就不能指望这些类按预期工作。因此，您要防止滥用此类类的选项 - 这是使用**final**关键字完成的

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T20:51:41.610

`String`实际上，问题与扩展或任何其他类无关。

问题实际上出在 Java 本身。问题是您实际上无法在其代码中定义特定对象实现的合同。它实际上并没有在代码中`String`说明它是不可变的，因为不能指定不变性，它只能被编码。该合同仅产生于实际执行`String`。

如果可以**在 Java 语言**中声明`String`等是不可变的，那么我们就不需要创建这些类。在我看来，这是 Java 的一种令人衰弱的疾病，您无法在代码中定义合约。您只能对其进行编码和记录。`Number``Integer``final`

我希望能够扩展字符串并定义，也许，`UppercaseString extends String`但`contract(immutable,interned)`在 Java 中没有关键字，所以我不能这样做，因为为了最接近这个合同，唯一可用的关键字是`final`而不是`immutable`应该的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-01T20:06:10.747

灾难的夸张可能是对 String 的（不）可变性的安全方面的暗示。字符串通常作为参数传递给各种 I/O 资源连接 API（例如 JDBC 和文件 I/O）。这样的字符串通常是资源定位器和身份验证凭据的串联，并且该 API 将在返回连接之前执行检查以确保凭据对请求的资源有效。 **如果 String 是可变的，它将为各种安全漏洞打开网关，**因为资源指针/地址（例如数据库连接的数据库名称或包含用户敏感信息的文件名）*可以在身份验证成功后修改但在为请求的原始资源建立资源连接之前*，导致未经授权的访问和破坏访问控制。

使 String 不可变的另一个原因是使其成为线程安全的。*

# javascript - 计算的淘汰赛仅在 IE 中给出函数预期错误

> ID：15165623
> 
> 赞同：6
> 
> 时间：2013-03-01T19:45:35.547
> 
> 标签：javascript, internet-explorer, knockout.js, knockout-2.0

我得到一个只在 IE 中发生的“SCRIPT5002：预期功能”。我目前正在针对版本 9 进行测试。当我在另一个计算的 observable 中使用先前定义的计算 observable 时会发生这种情况。

我的应用程序比这复杂一点，所以我用下面更简单的代码重现了错误。`z = self.subtotal();`当您在数字 1、数字 2 和数字 3 中输入数字时，错误发生在行上（并用制表符列出）。

这个错误在 Chrome 或 Firefox 中不会发生，我已经用谷歌搜索了很长一段时间。希望有人能帮我解开。

这是 jsfiddle 的链接：http: [//jsfiddle.net/kCmTg/](http://jsfiddle.net/kCmTg/)

这是javascript：

```
 function putVars() {
    self = this;
    self.number1 = ko.observable();
    self.number2 = ko.observable();
    self.subtotal = ko.computed(function () {
        return parseFloat(self.number1()) + parseFloat(self.number2());
    }, self, { deferEvaluation: true });

    self.number3 = ko.observable();
    self.number4 = ko.observable();
    self.total = ko.computed(function () {
        var x, y, z;
        x = self.number3();
        y = self.number4();
        z = self.subtotal();
        return parseFloat(x) + parseFloat(y) + parseFloat(z);
    }, self, { deferEvaluation: true });
}

$(function () {
    ko.applyBindings(new putVars());
}); 
```

这是html：

```
 <h4>Calc 1</h4>
<label for="Number1">Number 1: </label><input id="Number1" type="text" data-bind="value: number1" />
<label for="Number2">Number 2: </label><input id="Number2" type="text" data-bind="value: number2" />
<label for="Subtotal"><b>Subtotal: </b></label><input id="Subtotal" type="text" data-bind="value: subtotal" readonly="readonly" />
<hr />
<h4>Calc 2</h4>
<label for="Number3">Number 3: </label><input id="Number3" type="text" data-bind="value: number3" />
<label for="Number4">Number 4: </label><input id="Number4" type="text" data-bind="value: number4" />
<label for="Total"><b>Total:</b> </label><input id="Total" type="text" readonly="readonly" data-bind="value: total" /> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T02:43:19.163

这与这个原因类似：[knockout.js Computed observable 在 Internet Explorer 中调用了两次，](https://stackoverflow.com/q/14903064/1287183)这是由于在 IE<10 中，Knockout 有一些特殊的代码来处理从字段中获取自动完成值。即使在您的情况下该字段是只读的，它也会这样做。但是，它会检查`autocomplete`属性。所以你可以像这样修复它：

```
<input id="Subtotal" type="text" data-bind="value: subtotal" autocomplete="off" readonly="readonly" /> 
```

这里还有一个[Knockout](https://github.com/SteveSanderson/knockout/pull/639)中的错误——它将覆盖传递给双向绑定的计算 observable。这已经在 Knockout 的开发版本中修复，将作为 2.3.0 版发布（可能在 2013 年 4 月）。要解决这个问题，您可以将 observable 的值传递给绑定，而不是计算出的 observable 本身，如下所示：

```
<input id="Subtotal" type="text" data-bind="value: subtotal()" readonly="readonly" /> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T22:31:29.943

您似乎在 IE 或 KnockoutJS 中发现了一个错误，可能是由 Knockout 的绑定暴露的，其中 Knockout 将一个值推送到可观察对象中，但在 IE9 中，它会覆盖该属性。

这在 IE10 上不会发生，这表明它是 IE9 中的错误。我猜 Knockout 有一些东西可以检查某个值是否是可写的可观察函数，并且它在 IE9 上被错误地报告。

有趣的是，如果您将 KO 计算更改为使用读/写，错误就会停止：

```
self.subtotal = ko.computed({
     read: function() { 
         return parseFloat(this.number1()) + parseFloat(this.number2());
     },
     write: function(val) { }
}, self); 
```

也许这是一个足够的解决方法？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-05T12:38:19.340

请检查您的 observable 是否有一个值作为参数传递。例如budgetlineviewmodel.total = total(5)。我试过使用budgetlineviewmodel.total = 5。但没有成功。

Knockout Observables 只不过是内部函数，您必须在括号内传递一个值，该值在内部返回相同的值。

Chrome 允许budgetlineviewmodel.total() 在没有传递参数时容忍空值。

希望这可以帮助。

干杯！

```
budgetlineviewmodel.Save = function () {        
        var currentTotalAmt = $('#txtTotal').val();
        budgetLineViewModel.Total(currentTotalAmt);
} 
```

# c++ - 快速排序不适用于 10k 个元素

> ID：15165625
> 
> 赞同：1
> 
> 时间：2013-03-01T19:45:37.873
> 
> 标签：c++, quicksort

我的老师给了我一个快速排序函数来使用和测试执行时间，但是当它到达 10,000 个元素列表时，它会引发堆栈溢出，我不知道为什么。我已经在几台不同的计算机上对其进行了测试，在解析的 10,000 个元素中大约有 9375 个结果相同。

快速排序文件

```
#include "swap.h"

/** Chooses a pivot for quicksort's partition algorithm and swaps
 *  it with the first item in an array.
 * @pre theArray[first..last] is an array; first <= last.
 * @post theArray[first] is the pivot.
 * @param theArray  The given array.
 * @param first  The first element to consider in theArray.
 * @param last  The last element to consider in theArray. */
void choosePivot(int theArray[], int first, int last){
    //cerr << "choosePivot(array, " << first << ", " << last << ")\n";
    int mid = (last - first) / 2;
    if( (theArray[first] <= theArray[mid] &&
         theArray[mid] <= theArray[last]) ||
        (theArray[last] <= theArray[mid] &&
         theArray[mid] <= theArray[first]) ){
        // value at mid index is middle of values at first and last indices 
        swap(theArray[first], theArray[mid]);
    }else if( (theArray[first] <= theArray[last] &&
               theArray[last] <= theArray[mid]) ||
              (theArray[mid] <= theArray[last] &&
               theArray[last] <= theArray[first])){
        // value at last index is middle of values
        swap(theArray[first], theArray[last]);
    }
}

/** Partitions an array for quicksort.
 * @pre theArray[first..last] is an array; first <= last.
 * @post Partitions theArray[first..last] such that:
 *    S1 = theArray[first..pivotIndex-1] <  pivot
 *         theArray[pivotIndex]          == pivot
 *    S2 = theArray[pivotIndex+1..last]  >= pivot
 * @param theArray  The given array.
 * @param first  The first element to consider in theArray.
 * @param last  The last element to consider in theArray.
 * @param pivotIndex  The index of the pivot after partitioning. */
void partition(int theArray[],
               int first, int last, int& pivotIndex){
   // place pivot in theArray[first]
   choosePivot(theArray, first, last);
   int pivot = theArray[first];     // copy pivot

   // initially, everything but pivot is in unknown
   int lastS1 = first;           // index of last item in S1
   int firstUnknown = first + 1; // index of first item in
                                 // unknown

   // move one item at a time until unknown region is empty
   for (; firstUnknown <= last; ++firstUnknown)
   {  // Invariant: theArray[first+1..lastS1] < pivot
      //         theArray[lastS1+1..firstUnknown-1] >= pivot

      // move item from unknown to proper region
      if (theArray[firstUnknown] < pivot)
      {  // item from unknown belongs in S1
         ++lastS1;
         swap(theArray[firstUnknown], theArray[lastS1]);
      }  // end if

      // else item from unknown belongs in S2
   }  // end for

   // place pivot in proper position and mark its location
   swap(theArray[first], theArray[lastS1]);
   pivotIndex = lastS1;
}  // end partition

/** sorts the items in an array into ascending order.
 * @pre theArray[first..last] is an array.
 * @post theArray[first..last] is sorted.
 * @param theArray  The given array.
 * @param first  The first element to consider in theArray.
 * @param last  The last element to consider in theArray. */
void quicksort(int theArray[], int first, int last){
    int pivotIndex;

   if (first < last)
   {  // create the partition: S1, pivot, S2
      partition(theArray, first, last, pivotIndex);

      // sort regions S1 and S2
      quicksort(theArray, first, pivotIndex-1);
      quicksort(theArray, pivotIndex+1, last);
   }  // end if
}  // end quicksort 
```

swap.h 文件

```
#ifndef _SWAP_H
#define _SWAP_H

/** Swaps two items.
 * @pre x and y are the items to be swapped.
 * @post Contents of actual locations that x and y represent are
 *       swapped.
 * @param x  Given data item.
 * @param y  Given data item. */
void swap(int& x, int& y){
   int temp = x;
   x = y;
   y = temp;
}  // end swap

#endif /* _SWAP_H */ 
```

以及实现文件

```
//main.cpp
//Angelo Todaro
//Main driverto clock the timing efficiency of different sort algorithms for different sized lists

#include "quickSort.cpp"
#include <iostream>
#include <time.h>
using namespace std;

double diffclock(clock_t,clock_t);

int main(){
    clock_t begin, end;//clocks to store number of ticks at beginning and end
    srand(time(NULL));//initialize seed
    cout << "# of Elements\tQuick\n";
    for(int n = 10; n < 100000; n*=10){
        int* array = new int[n];
        cout << n << "\t\t";
        for(int i =0; i < n; i++){
            array[i]=rand()%1000;
        }

        //quick sort
        begin=clock();
        quicksort(array,0,n);
        end=clock();
        cout << diffclock(end,begin) << "\t";

    }

    return 0;
}

double diffclock(clock_t clock1, clock_t clock2){
    double diffticks = clock1-clock2;//finds difference between ticks
    double diffmili=diffticks/CLOCKS_PER_SEC;//turns tickes into miliseconds
    return diffmili;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:51:23.737

这是一个递归快速排序实现，也没有选择一个很好的枢轴。给定一些输入，它可能会对每个元素进行函数调用。堆栈上的 10k 个调用很难处理。在这一点上，只有带有随机枢轴的迭代就地快速排序才是一个好的算法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T20:21:42.777

当我为您[调试代码](http://stacked-crooked.com/view?id=7650d51cda8d39f85eb273755dad49c3)时，我可以看到当您调用时`choosePivot`，并且只有一个元素，它被*完全删除*：

```
enter quicksort(array, 2, 3)
1  //content of region
enter partition(array, 2, 3)
1  //content of region 
enter choosePivot(array, 2, 3)
1  //content of region 
0  //content of region - WAIT, WHAT HAPPENED TO THE ONE
end choosePivot
0   //content of region
end partition 
```

所以我们至少找到了问题的位置：`choosePivot`. 当我们仔细查看该函数时，我最终意识到了错误：

```
void choosePivot(int theArray[], int first, int last){
    //cerr << "enter choosePivot(array, " << first << ", " << last << ")\n";
    int mid = (last - first) / 2;
    if( (theArray[first] <= theArray[mid] &&
         theArray[mid] <= theArray[last]) ||
        (theArray[last] <= theArray[mid] &&
         theArray[mid] <= theArray[first]) ){ 
```

`theArray[last]`超出范围并超过了数组的末尾。您将一个完全随机且无效的数字交换到数组中，并将其中一个元素交换出数组。这似乎实际上经常发生。这就是为什么我们在进行大量测试之前测试准确性的原因。

当我更改`theArray[last]`为 时`theArray[last-1]`，您的代码[通过了我的所有测试](http://stacked-crooked.com/view?id=84155a029c6d26d74eefcad9dd021316)。笔记：

*   C++ 库已经有`std::swap`.
*   你泄露了所有的记忆。匹配或更好，`delete`使用.`new``std::vector<int>`

# ruby-on-rails - rails中的变量

> ID：15165626
> 
> 赞同：0
> 
> 时间：2013-03-01T19:45:45.243
> 
> 标签：ruby-on-rails

我对 rails 中的变量被引用和/或分配一些值的方式感到非常困惑。

谁能告诉我以下行/语句的含义？

（我来自 C 世界，我很难理解 Ruby/Rails 语法）

<1> 我们在这里声明`:name`和`:email`作为变量吗？另外，为什么`colon`前面有一个`name`and `email`？

```
attr_accessible :name, :email 
```

<2> 赋值给变量 从上面的例子中，如果`name`和`email`是变量，我如何给它们赋值？

```
def foo
  name = 'New Name'
end 
```

或者

```
def foo
  :name => 'New Name'
end 
```

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:55:42.173

在 Rails 中，您使用 ORM 从表中提取字段名称，例如，如果您有一个表`items`：

```
|id | name    |
|1  | a string| 
```

您将拥有`class Item`，假设是一个实例`item`，然后您可以访问：

```
item.id      # -> 1
item.name    # -> a string 
```

根据你的例子：

```
def foo
  name = 'New Name'  # You are not setting the variable, you are creating a local variable called name
  # To set variable
  self.name = 'a name'
end 
```

或者

```
def foo
  :name => 'New Name' # you are returning a hash, but you are lacking brackets, not setting a variable
end 
```

该行`attr_accessible :name, :email`允许您执行此操作：

```
Item.new({
  name: 'asd',
  email: 'sad'
}) 
```

例如，如果您不添加`:email`in `attr_accessible`，则上一个会发出警告，例如：

```
Can't mass-assign protected attributes: email 
```

当您在控制器中收到参数时，这很有用，例如：

```
Item.new(params[:item]) 
```

看到 params，是一个哈希，你可以在 rails 服务器控制台看到它。

# c# - 将 JSON 对象响应解析为 C# 对象的问题

> ID：15165627
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:45:47.107
> 
> 标签：c#, json, rest, arcgis, arcgis-server

我有以下代码：

```
[WebMethod]
public bool AddUser(long warnId, double longitude, double latitude)
{
    try
    {
        string jsonFeature = string.Empty;
        jsonFeature += "[{'geometry': {'x': " + longitude + ",'y': " + latitude +
                       ",'spatialReference': {'wkid': 4326}},'attributes': {'UID': '";
        jsonFeature += warnId + "','Latitude': '" + latitude + "','Longitude': '" + longitude + "'}}]";

        string reqURL = System.Configuration.ConfigurationManager.AppSettings["WARNURL"] + "addFeatures";

        using (System.Net.WebClient client = new System.Net.WebClient())
        {
            client.Headers["Content-type"] = "application/x-www-form-urlencoded";
            client.Encoding = System.Text.Encoding.UTF8;
            var collection = new System.Collections.Specialized.NameValueCollection();
            collection.Add("f", "json");
            collection.Add("features", jsonFeature);
            byte[] response = client.UploadValues(reqURL, "POST", collection);
            MemoryStream stream = new MemoryStream(response);
            StreamReader reader = new StreamReader(stream);
            string aRespStr = reader.ReadToEnd();

            JavaScriptSerializer jss = new JavaScriptSerializer();
            AddResult addResult = jss.Deserialize<AddResult>(aRespStr);

            return aRespStr.Contains("true") && aRespStr.Contains("success");
        }
    }
    catch(Exception e)
    {
        string message = e.Message;
        return false;
    }
} 
```

当我运行它时，字符串 aRespStr 是：

> "{\"addResults\":[{\"objectId\":28,\"globalId\":\"{740490C6-77EE-4AC0-9561-5EBAACE3A0A7}\",\"成功\":true}]} "

反序列化后，我创建了以下类来保存对象：

```
 public class Error
{
    public int code { get; set; }
    public string description { get; set; }
}

public class AddResult
{
    public int objectId { get; set; }
    public object globalId { get; set; }
    public bool success { get; set; }
    public Error error { get; set; }
}

public class RootObject
{
    public List<AddResult> addResults { get; set; }
} 
```

但是当我运行代码时，addResult 对象包含默认对象值而不是 json 对象值。

此特定响应的 api 在这里： [http ://help.arcgis.com/en/arcgisserver/10.0/apis/rest/fsadd.html](http://help.arcgis.com/en/arcgisserver/10.0/apis/rest/fsadd.html)

非常感谢任何有关使其正常工作的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:05:43.350

尝试这个

```
RootObject addResults=jss.Deserialize<RootObject>(aRespStr); 
```

或类似的，你可以试试这个

```
List<AddResult> addResults = jss.Deserialize<List<AddResult>>(aRespStr); 
```

当您在 json 响应中返回 AddResult 列表时。

并将内容类型更改为 application/json

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T19:54:27.827

改变

```
client.Headers["Content-type"] = "application/x-www-form-urlencoded"; 
```

至

```
client.Headers["Content-type"] = "Application/json"; 
```

# c++ - 交替递增顺序反转堆栈

> ID：15165631
> 
> 赞同：0
> 
> 时间：2013-03-01T19:46:02.667
> 
> 标签：c++, loops, stack, reverse, non-recursive

以交替方式以递增顺序反转堆栈的最优雅的方式（更少的代码？）是什么？（非递归）

前任。

```
1 2 3 4 5 6 7 8 9 10

1 [3 2] 4 5 6 [10 9 8 7] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:53:42.663

我会用`std::reverse`. 这对你有用吗？

[http://www.cplusplus.com/reference/algorithm/reverse/](http://www.cplusplus.com/reference/algorithm/reverse/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:57:20.890

[`std::stack`](http://en.cppreference.com/w/cpp/container/stack)被设计为 LIFO（后进先出），因此它不是为您更改值的索引而设计的。如果您必须更改项目的索引，我建议您使用不同的列表。

![在此处输入图像描述](../Images/9615d707e42291754b36c03b2db9a7ce.png) （有谁知道这张图片的原作者是谁，所以我可以给出适当的引用）

# c - 是什么导致以下程序中的分段错误

> ID：15165635
> 
> 赞同：1
> 
> 时间：2013-03-01T19:46:10.693
> 
> 标签：c, arrays

如果我将行的值保持为 100000，则程序可以正常工作，但是，如果我将 100 万行设为 1000000，则程序会给我分段错误。是什么原因？我在 Linux 2.6x RHEL 内核上运行。

```
#include<stdio.h>

#define ROWS 1000000
#define COLS 4

int main(int args, char ** argv)
{
  int matrix[ROWS][COLS];

  for(int col=0;col<COLS;col++)
  for(int row=0;row < ROWS; row++)
    matrix[row][col] = row*col;

  return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:47:51.283

是函数内部的`matrix`局部变量`main`。所以它是在机器调用堆栈上“分配”的。

这个堆栈有一些限制。

您应该将您`matrix`的全局`static`变量或变量设为指针并堆分配（使用例如`calloc`或`malloc`）内存区域。不要忘记这一点，`calloc`否则`malloc`可能会失败（通过返回 NULL）。

堆分配这种东西的一个更好的理由是矩阵的维度实际上应该是一个变量或某个输入。在源代码中连接尺寸的原因很少。

启发式：没有大于一千字节或两千字节的局部帧（局部变量大小的累积总和）。

^([当然，该启发式也有有效的例外])

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T19:47:56.333

您正在分配一个堆栈变量，每个程序的堆栈是有限的。

当您尝试分配过多的堆栈内存时，您的内核将通过发送一个 SEGV 信号（即分段错误）来终止您的程序。

如果要分配更大的内存块，请使用`malloc`，此函数将从堆中获取内存。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:47:43.523

您的系统不能允许您分配那么大的堆栈。`matrix`进行全局或使用动态分配（通过`malloc`和），你`free`应该没问题。

# sql - 存储过程中的条件

> ID：15165643
> 
> 赞同：0
> 
> 时间：2013-03-01T19:46:57.133
> 
> 标签：sql, sql-server-2008, stored-procedures

我有一个执行 2 次更新的存储过程，但我只想在参数`@active`等于时进行第一次更新`'Y'`。

```
alter procedure sp_updateThis
@something varchar(5),
@active char(1)
as begin
-- check to see if active and do the update
update myTable set this=@something

-- run this one regardless
update yourTable set that=@something 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:48:52.263

尝试用这个改变最后一行：

```
if (@active = 'Y')
begin
    update yourTable set that=@something
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T19:50:35.350

```
alter procedure sp_updateThis
@something varchar(5),
@active char(1)
as begin
-- check to see if active and do the update
if(@active = 'Y')
Begin
update myTable set this=@something
End

-- run this one regardless
update yourTable set that=@something 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T19:50:44.083

如果您真的想更新表中的每一行：

```
update myTable set this=@something where @active = 'Y'; 
```

否则你可能想要额外的条款......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-06T12:13:55.203

你可以像这样创建一个过程： create procedure sp_updateThis @something varchar(5), @active char(1) AS Begin

if @active ='y' begin update yourTable set that=@something end else update myTable set this=@something update yourTable set that=@something

结束

# sharepoint - 如何使用 MSBuild 任务构建 .wsp 文件？

> ID：15165650
> 
> 赞同：3
> 
> 时间：2013-03-01T19:47:19.990
> 
> 标签：sharepoint, msbuild

我需要在 MSBuild 文件中构建 .wsp 文件。如何使用本机或扩展 MSBuild 任务执行此操作？请告诉我。我不想使用命令行或使用 MAKECAB.exe

# javascript - 无法使用 db.js 将大数组保存到 IndexedDB

> ID：15165655
> 
> 赞同：0
> 
> 时间：2013-03-01T19:47:32.870
> 
> 标签：javascript, arrays, windows-8, indexeddb, db.js

我尝试使用 db.js 将一个大数组保存到 IndexedDB 数据库中。该数组包含 100-1000 个元素，从用户不同，因为我在 JS 中的 Windows 8 Store-App 工作，并且该数组包含在用户图片库中找到的所有照片的对象。我想将该数组保存到数据库中，因为我不想每次都重新构建它。尝试保存时出现 DataCloneError。

这是我的代码：

```
server.objects.add({
   id: 0,
   pic: nametowrite,
   value: contenttowrite
});

picturesLibrary.getItemsAsync().then(function (items) { 
    if (items.size == 0) { return }; 
    for (var i2 = 0; i2 < items.size; i2++) { 
        if (items[i2].isOfType(Windows.Storage.StorageItemTypes.file)) { 
            if (filetype(items[i2].name) == true) { 
                pictures.push(items[i2]); 
            } 
        } else { 
            folders.push(items[i2]) 
        } 
    } 
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-03T04:29:36.933

如果您尝试保存 DOM 节点，而不是来自太大的数组，则会引发该错误。来自MDN 上[的结构化克隆算法：](https://developer.mozilla.org/en-US/docs/DOM/The_structured_clone_algorithm)

> *   尝试克隆 DOM 节点同样会抛出 DATA_CLONE_ERR 异常。

`contenttowrite`（假设那是您的图像）将需要是`blob`.

这是要`blob`摘录的图像：

```
var ajax = new XMLHttpRequest(),
    blob;
ajax.open( 'GET', 'example.png', true );
ajax.responseType = 'blob'; //the magic
ajax.addEventListener( 'load', function () {
    if ( ajax.status == 200 ) {
        blob = ajax.response;
    };
} );
ajax.send(); 
```

# google-app-engine - GAE Go — 异步数据存储 API？

> ID：15165656
> 
> 赞同：6
> 
> 时间：2013-03-01T19:47:38.517
> 
> 标签：google-app-engine, asynchronous, go

是否有与 Python/Java 的异步数据存储 API 类似的 Go？或者可以只使用带有`go`关键字的普通 API 吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-02T02:13:50.620

对于任何 AppEngine 服务，没有与 Python 或 Java 异步 API 等效的 Go。事实上，Go 标准库也没有任何标准异步风格。原因是在 Go 中，您使用阻塞样式编写函数，并根据需要使用一些基本的并发原语来组合它们。虽然您不能只`go`在`dastore.Get`通话开始时添加，但它仍然相对简单。考虑以下人为的示例：

```
func loadUser(ctx appengine.Context, name strings) (*User, err) {
  var u User
  var entries []*Entry
  done := make(chan error)

  go func() {
    // Load the main features of the User
    key := datastore.NewKey(ctx, "user", name, 0, nil)
    done <- datastore.Get(ctx, key)
  }()

  go func() {
    // Load the entries associated with the user
    q := datastore.NewQuery("entries").Filter("user", name)
    keys, err := q.GetAll(ctx, &entries)
    for i, k := range keys {
      entries[i].key = k
    }
    done <- err
  }()

  success := true
  // Wait for the queries to finish in parallel
  for i := 0; i < 2 /* count the funcs above */; i++ {
    if err := <-done; err != nil {
      ctx.Errorf("loaduser: %s", err)
      success = false
    }
  }
  if !success {
    return
  }

  // maybe more stuff here
} 
```

这种相同的方法几乎可以用于任何需要同时运行多个可能需要一段时间的事情的上下文，无论是数据存储调用、urlfetch、文件加载等。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T22:46:40.590

Go 中没有明确的异步 API。您应该改用 go 例程。我还没有看到任何有关这方面的资料，但我怀疑异步 API 不存在，因为使用 go 例程非常容易。

# php - MySQL计算2个字段中的唯一值

> ID：15165661
> 
> 赞同：-3
> 
> 时间：2013-03-01T19:47:54.340
> 
> 标签：php, mysql, count, field

我需要计算 mysql 表中 2 个不同字段的某些值，如果可能的话，最好使用一个查询。

```
 Number     Answer
 0          Y
 0          N
 1          Y
 2          Y
 0          Y 
```

我需要知道“数字”字段中有多少值为 0。

我还需要知道“答案”字段中有多少值为 N。

你能帮我构造查询，还有 PHP 把这些变成一个变量以供使用吗？

IE

```
 echo "There are ".$number." entries in the number field with a value of 0";
 echo "There are ".$answer." entries in the answer field with a value of N"; 
```

感谢您的帮助，在我什至可以继续使用 php.ini 之前，我一直试图弄清楚 mysql 计数。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T19:52:36.887

您可以使用带有`CASE`表达式的聚合函数在单个查询中执行此操作：

```
select 
  sum(case when number=0 then 1 else 0 end) TotalNumber,
  sum(case when answer='N' then 1 else 0 end) TotalAnswer
from yourtable 
```

请参阅[带有演示的 SQL Fiddle](http://www.sqlfiddle.com/#!2/713a42/2)

要通过 PHP 获取这些结果，您可以使用`mysqli_`或`PDO`API：

```
<?php
$link = mysqli_connect("localhost", "my_user", "my_password", "world");

/* check connection */
if (mysqli_connect_errno()) {
    printf("Connect failed: %s\n", mysqli_connect_error());
    exit();
}

$query = "SELECT Sum(CASE 
             WHEN number = 0 THEN 1 
             ELSE 0 
           end) TotalNumber, 
       Sum(CASE 
             WHEN answer = 'N' THEN 1 
             ELSE 0 
           end) TotalAnswer 
FROM   yourtable";

if ($result = mysqli_query($link, $query)) {

    /* fetch associative array */
    $row = mysqli_fetch_assoc($result);
    echo "There are " . $row['TotalNumber'] . "entries in the number field with a value of 0";
    echo "There are " . $row['TotalAnswer'] . "entries in the answer field with a value of N";

    /* free result set */
    mysqli_free_result($result);
}

/* close connection */
mysqli_close($link);
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T19:55:40.493

试试这个 ：

```
Select SUM(IF(Number = 0, 1, 0)) as count_numbers,
SUM(IF(Answer = 'N', 1, 0)) as count_answers
From table 
```

萨卢多斯 ;)

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2013-03-01T19:51:17.903

```
Select count(`Number`) from yourtable where `Number` = 0;
Select count(`Answer`) from yourtable where `Answer` = 'N'; 
```

# mercurial - 无法使用 tortoiseHg 将更改推送到 mercurial repo

> ID：15165663
> 
> 赞同：1
> 
> 时间：2013-03-01T19:47:57.570
> 
> 标签：mercurial, tortoisehg

在变更集中，它显示我有 12 个要推送的更改，但是当我单击推送到 mercurial repo 时，它显示“没有对 URL 的传出变更集”。这是我第一次尝试使用 TortoiseHg 进行代码推送。请协助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T22:18:01.893

这是描述的问题，在将代码提交到本地 Web 服务器时，我在描述的开头有一个额外的空间。这阻止了它被推到全球回购。

# .htaccess - .htaccess RewriteRule 不起作用，需要生成一个友好的 URL

> ID：15165666
> 
> 赞同：1
> 
> 时间：2013-03-01T19:48:06.957
> 
> 标签：.htaccess, mod-rewrite, url-rewriting, seo, friendly-url

我有这个动态链接：

```
http://www.nortedigital.mx/article.php?id=36175&t=dobla_las_manos_el_snte__avala_reforma_educativa 
```

我需要像这样以友好的 URL 进行转换：

```
http://www.nortedigital.mx/36174/se_enriquecio_elba_en_sexenios_del_pan.html 
```

我有这个 RewriteRule：

```
RewriteRule ^([^/]*)/([^/]*)\.html$ /article.php?id=$1&t=$2 [L] 
```

但不起作用。拜托，有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:54:41.073

您必须在 RewriteCond 中捕获查询字符串并在 RewriteRule 中使用它

```
RewriteEngine On
RewriteCond %{QUERY_STRING} ^id=(\d+)&t=(.+)$
RewriteRule ^/?article\.php$ /%1/%2.html? [R,L] 
```

这会将客户端重定向到请求，即`/36174/se_enriquecio_elba_en_sexenios_del_pan.html`。现在您必须提供真实页面。为此，我们添加了一条附加规则，类似于您在问题中已有的规则

```
RewriteRule ^/?(.+?)/(.+?)\.html$ /article.php?id=$1&t=$2 [L] 
```

但是现在，有一个无限的重定向循环。我们通过使用环境变量来打破这一点。这是整个完整的规则集

```
RewriteEngine On

RewriteCond %{ENV:REDIRECT_SEO} ^$
RewriteCond %{QUERY_STRING} ^id=(\d+)&t=(.+)$
RewriteRule ^/?article\.php$ /%1/%2.html? [R,L]

RewriteRule ^/?(.+?)/(.+?)\.html$ /article.php?id=$1&t=$2 [L,E=SEO:1] 
```

只要未设置环境变量，此规则就会按上述方式进行重定向。并且它同时服务于真实页面`article.php`并设置环境变量以防止循环。

您也可以为此目的使用 cookie。但是，如果在客户端中禁用了 cookie，那将会中断。

# jquery - jQuery通过rel过滤

> ID：15165668
> 
> 赞同：1
> 
> 时间：2013-03-01T19:48:08.990
> 
> 标签：jquery, filter, rel

我正在尝试过滤所有具有 rel 属性的链接，然后更改该属性。我知道它应该很简单......但不能让它工作。

```
$('#selector a[rel]').each(function() {
  $(this).attr('rel', 'lightbox[auto_group999]');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:53:57.803

```
$(function(){ // DOM is ready to be manipulated

    $('#selector a[rel]').each(function() { // now the selector is retrieved
      $(this).attr('rel', 'lightbox[auto_group999]');
    });

}); 
```

`**[jQuery API - .ready()](http://api.jquery.com/ready/)**`

# ios - 将滑动手势识别器添加到 DetailViewContoller

> ID：15165672
> 
> 赞同：22
> 
> 时间：2013-03-01T19:48:23.990
> 
> 标签：ios, objective-c, ipad, uisplitviewcontroller

我有一个简单的 xcode 项目，它是由 iPad 的“Master-Detail Application”模板制作的。当设备处于纵向时，主视图被隐藏，当您在详细视图上向右滑动时，主视图将显示。现在，我想将右滑动手势识别器添加到详细视图中，如下所示：

```
- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [self configureView];

    UISwipeGestureRecognizer *gestureRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeHandler)];
    [self.view addGestureRecognizer:gestureRecognizer];
}

-(void)swipeHandler{
    NSLog(@"SWIPE");
} 
```

但是这段代码导致当我在详细视图上滑动时，控制台中出现“SWIPE”日志，但没有显示主视图。

如何将右滑动手势识别器添加到详细视图，因此它不会阻止主视图显示并且我的识别器处理程序将起作用？

提前致谢。

编辑。我希望我的右滑动识别器处理程序与这个内置的同时工作，它显示主视图，但下面的代码不是这种特定情况的解决方案：

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer{

    return YES;
} 
```

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-01T19:53:04.807

您应该设置滑动的方向以添加正确的滑动

```
UISwipeGestureRecognizer *gestureRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeHandler:)];
    [gestureRecognizer setDirection:(UISwipeGestureRecognizerDirectionRight)];
    [self.view addGestureRecognizer:gestureRecognizer]; 
```

你的滑动处理程序可能看起来像

```
-(void)swipeHandler:(UISwipeGestureRecognizer *)recognizer {
    NSLog(@"Swipe received.");
} 
```

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-01-09T12:36:09.563

```
- (void)viewWillAppear:(BOOL)animated{
    [super viewWillAppear:animated];

    UISwipeGestureRecognizer *recognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeRecognizer:)];
    recognizer.direction = UISwipeGestureRecognizerDirectionRight;
    recognizer.delegate = self;
    [self.view addGestureRecognizer:recognizer];
}

- (void)swipeRecognizer:(UISwipeGestureRecognizer *)sender {
    if (sender.direction == UISwipeGestureRecognizerDirectionRight){
        [UIView animateWithDuration:0.3 animations:^{
            CGPoint Position = CGPointMake(self.view.frame.origin.x + 100.0, self.view.frame.origin.y);
            self.view.frame = CGRectMake(Position.x , Position.y , self.view.frame.size.width, self.view.frame.size.height);
            [self.navigationController popViewControllerAnimated:YES];
        }];
    }
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2015-11-24T07:17:57.590

尝试这个

//向右滑动

```
UISwipeGestureRecognizer *gestureRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeHandlerRight:)];
[gestureRecognizer setDirection:(UISwipeGestureRecognizerDirectionRight)];
[self.view addGestureRecognizer:gestureRecognizer]; 
```

//向左滑动

```
UISwipeGestureRecognizer *gestureRecognizer = [[UISwipeGestureRecognizer alloc] initWithTarget:self action:@selector(swipeHandlerLeft:)];
[gestureRecognizer setDirection:(UISwipeGestureRecognizerDirectionLeft)];
[self.view addGestureRecognizer:gestureRecognizer]; 
```

调用方法

```
-(void)swipeHandlerRight:(id)sender
{
    //Your ViewController
}

-(void)swipeHandlerLeft:(id)sender
{
 //Your ViewController
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:05:57.527

这行得通。它从 navigationController 推送视图控制器。

```
- (void)viewDidLoad
{
     [super viewDidLoad];
     // Do any additional setup after loading the view, typically from a nib.
     UISwipeGestureRecognizer *gestureRecognizer = [[UISwipeGestureRecognizer           alloc] initWithTarget:self  action:@selector(swipeHandler:)];
     [self.view addGestureRecognizer:gestureRecognizer];
}

-(IBAction)swipeHandler:(UISwipeGestureRecognizer *)sender
{
      NSLog(@"SWIPE");
      UIViewController *tb = [[DetailViewController alloc] init];
      tb = [self.storyboard instantiateViewControllerWithIdentifier:@"DetailViewController"];
      [self.navigationController pushViewController: tb animated:YES];
} 
```

然后确保转到情节提要（或者您也可以手动执行此操作） - 单击详细视图控制器并为视图控制器提供标识：DetailViewController

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-05-02T09:34:18.720

迅捷4.0

第 1 步：在 viewDidLoad() 方法中添加滑动手势。

```
override func viewDidLoad() {
    super.viewDidLoad()

    let swipeLeft = UISwipeGestureRecognizer(target: self, action: #selector(handleGesture))
    swipeLeft.direction = .left
    self.view.addGestureRecognizer(swipeLeft)

    let swipeRight = UISwipeGestureRecognizer(target: self, action: #selector(handleGesture))
    swipeRight.direction = .right
    self.view.addGestureRecognizer(swipeRight)

} 
```

第 2 步：检查 handleGesture() 方法中的手势检测

```
@objc func handleGesture(gesture: UISwipeGestureRecognizer) -> Void {
    if gesture.direction == UISwipeGestureRecognizerDirection.right {
        print("Swipe Right")
    }
    else if gesture.direction == UISwipeGestureRecognizerDirection.left {
        print("Swipe Left")
    }

} 
```

# java - 带有图像的随机 GridView

> ID：15165673
> 
> 赞同：0
> 
> 时间：2013-03-01T19:48:26.083
> 
> 标签：java, android

我想为我的应用程序创建一个 DayDream，我想要一个图像墙，但我不知道如何随机化图像。

我希望一些图像比其他图像大（2 倍），而其他图像在它们周围，都是随机的。有没有一种简单的方法可以做到这一点？在将图像加载到 GridView 之前，图像会动态保存在 ImageView 的 ArrayList 中。

目前我有一个简单的水平布局，里面装满了 ImageViews，但这太简单了，不会填满整个屏幕......

我没有一点可以开始的地方，任何帮助都可以！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:51:57.360

我不确定您是否可以使用 GridView 来做到这一点。您实际上是在寻找`TableView`并指定一个项目可以占用多少列。或者，通过一些摆弄，您可以使用`RelativeLayout`.

对于两者`TableView`，`RelativeLayout`您都必须编写自己的适配器才能将内容放入视图中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T22:43:47.683

尝试[http://www.androidviews.net/2013/01/quiltview-library/](http://www.androidviews.net/2013/01/quiltview-library/)或 [http://www.androidviews.net/2013/01/pinterest-like-adapterview/](http://www.androidviews.net/2013/01/pinterest-like-adapterview/) 据我所知被子视图是随机创建的时间，所以也许你应该这样做。

# python - 将 os.walk() 保存在变量中

> ID：15165674
> 
> 赞同：2
> 
> 时间：2013-03-01T19:48:27.320
> 
> 标签：python, os.walk

我可以以某种方式保存`os.walk()`in variables 的输出吗？我试过 `basepath, directories, files = os.walk(path)` 了，但没有用。我想继续目录和一个特定子目录的文件。这有可能吗？谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:56:49.710

`os.walk()`返回一个生成器，它将从它开始的初始路径连续返回*所有*文件/目录树。如果您只想处理一个目录和一个特定子目录中的文件，您应该使用混合`os.listdir()`和混合`os.path.isfile()`来`os.path.isdir()`获得您想要的。

像这样的东西：

```
def files_and_subdirectories(root_path):
    files = []
    directories = []
    for f in os.listdir(root_path):
        if os.path.isfile(f):
            files.append(f)
        elif os.path.isdir(f):
            directories.append(f)
    return directories, files 
```

并像这样使用它：

```
directories,files = files_and_subdirectories(path) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:01:03.343

> 我想继续目录和一个特定子目录的文件。这有可能吗？

如果这就是你想要的，那么只需尝试

```
[e for e in os.listdir('.') if os.path.isfile(e)] + os.listdir(special_dir) 
```

# javascript - 当我将新 URL 推送到 Backbone.history 时，查询参数会保留吗？

> ID：15165678
> 
> 赞同：13
> 
> 时间：2013-03-01T19:48:32.180
> 
> 标签：javascript, html, url, backbone.js, pushstate

假设我正在使用 Backbone pushstate，并导航到带有查询参数的页面：

```
domain.com/user/111?hello=123 
```

当我执行这个：

```
Backbone.history.navigate('/settings', true); 
```

我的设置页面加载完美，但 ?hello=123 保留在 URL 中...

```
domain.com/settings?hello=123 
```

在我浏览网站的任何地方，该查询参数都保留在 URL 中......

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-03-04T13:49:48.740

骨干路由和查询参数是不愉快的结合。[问题在这个 GitHub 问题](https://github.com/documentcloud/backbone/issues/891)中有很好的记录。

核心问题是`Backbone.Router`设计用于处理 URL 哈希片段以及 pushState API。当使用哈希 URL 时，查询字符串在哈希之前，并且在路由中永远不会匹配。对于 pushState，查询字符串是 URL 片段的一部分，并且需要不同的路由表达式。

假设您有一个 route `search`，并且该 route 可以选择带参数`q`,`sort`和`type`. 作为一个查询字符串，看起来像：

```
search?q=kittens&sort=asc&type=images 
```

问题是，对于旧浏览器的用户，Backbone 将恢复为`hashchange` 基于路由，并且路由将变为：

```
?q=kittens&sort=asc&type=images#search 
```

您使用的插件试图解决这个问题，但不能解决核心问题。

如果可能，您应该考虑不使用查询字符串，并使用路由表达式中的可选片段传递任何状态信息。前面的示例路由将变为：

```
//pushState
search/q/kittens/sort/asc/type/images

//hash fragment
#search/q/kittens/sort/asc/type/images 
```

使用`(optional)`路由部分和`:captures`( [docs](http://backbonejs.org/#Router) )，您可以使用以下表达式表示此 URL：

```
var Router = Backbone.Router.extend({
  routes: {
    "search(/q/:query)(/sort/:sort)(/type/:type)": "search"
  },

  search: function(query, sort, type) {
    console.log(query, sort, type); //-> "kittens", "asc", "images" 
  }
}); 
```

只要路由片段按指定的顺序排列，这将匹配带有 none、any 和 all 参数的 url，例如：

```
search                       //->  undefined,  undefined, undefined
search/q/kittens/type/images //->  "kittens",  undefined, "images"
search/sort/asc/type/images  //->  undefined,  "asc",     "images" 
```

这样您就不必担心第三方查询字符串库或浏览器兼容性问题。如果你问我，后一种类型的 URL 看起来也更干净。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-03T23:58:59.883

您不必再使用`backbone-query-parameters`插件来处理这个问题，只需确保您拥有最新版本的 Backbone，然后覆盖`loadUrl`里面的方法`History.prototype`。

```
// Regex to match search query strings
var searchStripper = /\?.*$/g;

// Attempt to load the current URL fragment. If a route succeeds with a
// match, returns `true`. If no defined routes matches the fragment,
// returns `false`.
loadUrl: function(fragmentOverride) {
  var fragment = this.fragment = this.getFragment(fragmentOverride);
  fragment = fragment.replace(searchStripper, ''); // remove the search query parameter
  var matched = _.any(this.handlers, function(handler) {
    if (handler.route.test(fragment)) {
      handler.callback(fragment);
      return true;
    }
  });
  return matched;
}, 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-04T06:57:33.523

不确定是否为时已晚。我遇到了同样的问题，我可以自信地说：这是一个由主干查询参数引起的错误。

我实际上是受到你的帖子的启发。在我当前项目的早期，我引入了主干查询参数，它运行良好。但后来，主干进行了一些更改，因此主干查询参数无法再获取参数。直到最近才发现作者升级了backbone-query-parameters。我又把它拉进去了，它起作用了。

然后，你知道的。我遇到了同样的问题，感到非常沮丧。我从来没有怀疑过骨干查询参数，直到我看到你的帖子。

我删除了插件并配备了我自己的代码，现在我的历史就像一个魅力。

有许多方法可以获取 get 参数。我的只是其中之一，但它为我完成了这项工作。仅供您参考，我将其发布在这里。

```
 getParams: ->
    rtn = {}

    if window.location.search.length > 0
      queryStringRegex =  /^\?(.*)/
      match = queryStringRegex.exec window.location.search
      param_string = match[1]

      if param_string.length > 0
        params_array = param_string.split("&")

        for value in params_array
          temp = value.split("=")
          rtn[temp[0]] = decodeURI(temp[1])

    rtn 
```

以防万一，我的路线会是这样的

```
"path(?*queryString)" : "pathAction" 
```

# java - Java SwingWorker 未在任务完成时终止

> ID：15165680
> 
> 赞同：1
> 
> 时间：2013-03-01T19:48:33.680
> 
> 标签：java, multithreading, swing, progress-bar, swingworker

好的，所以我一直在使用 SwingWorker 并获得了一些用于更新 gui 的简化代码，但我无法弄清楚如何让线程在完成时正确终止。目前，它仅通过停止选项终止。我将如何设置它以在完成其进程时也正确终止线程？目前，在`return null;`它进入包装线并挂起之后。

我的代码如下：

```
 package concurrency;

import java.util.List;
import java.util.Random;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import java.awt.GridBagLayout;
import java.awt.GridBagConstraints;
import java.awt.Insets;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JProgressBar;
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;

public class PBTest extends JFrame implements ActionListener {
    private final GridBagConstraints constraints;
    private final JProgressBar pb, pbF;
    private final JButton theButton;
    private PBTask pbTask;

    private JProgressBar makePB() {
        JProgressBar p = new JProgressBar(0,100);
        p.setValue(0);
        p.setStringPainted(true);
        getContentPane().add(p, constraints);
        return p;       
    }

    public PBTest() {
        super("PBTest");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        //Make text boxes
        getContentPane().setLayout(new GridBagLayout());
        constraints = new GridBagConstraints();
        constraints.insets = new Insets(3, 10, 3, 10);

        pb = makePB();
        pbF = makePB();

        //Make buttons
        theButton = new JButton("Start");
        theButton.setActionCommand("Start");
        theButton.addActionListener(this);
        getContentPane().add(theButton, constraints);

        //Display the window.
        pack();
        setVisible(true);
    }

    private static class UpdatePB {
        private final int pb1, pb2;
        UpdatePB(int pb1s, int pb2s) {
            this.pb1 = pb1s;
            this.pb2 = pb2s;
        }
    }

    private class PBTask extends SwingWorker<Void, UpdatePB> {
        @Override
        protected Void doInBackground() {
            int prog1 = 0;
            int prog2 = 0;
            Random random = new Random();

            while (prog2 < 100) {
                if(prog1 >= 100) {
                    prog1 = 0;
                }
                //Sleep for up to one second.
                try {
                    Thread.sleep(random.nextInt(1000));
                } catch (InterruptedException ignore) {}
                //Make random progress.
                prog1 += random.nextInt(10);
                prog2 += random.nextInt(5);
                publish(new UpdatePB(prog1, prog2));
            }
            return null;
        }

        @Override
        protected void process(List<UpdatePB> pairs) {
            UpdatePB pair = pairs.get(pairs.size() - 1);
                pb.setValue(pair.pb1);
                pbF.setValue(pair.pb2);
        }
    }

    public void actionPerformed(ActionEvent e) {
        if ("Start" == e.getActionCommand() && pbTask == null) {
            theButton.setText("Stop");
            theButton.setActionCommand("Stop");
            (pbTask = new PBTask()).execute();
        } else if ("Stop" == e.getActionCommand()) {
            theButton.setText("Start");
            theButton.setActionCommand("Start");
            pbTask.cancel(true);
            pbTask = null;
        } else {
            alertMsg("Thread still running.");
        }

    }

    static void alertMsg(String theAlert) {
        JOptionPane.showMessageDialog(null, theAlert);
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new PBTest();
            }
        });
    }
} 
```

注意：这基本上是对 Java 教程的“flipper”示例的修改......我现在不是程序员而是代码黑客（/sad face/，lol），所以我有点不知道下一步该去哪里。

无论如何，代码按预期工作，直到完成。我尝试添加该`done()`方法，但它从不尝试运行它，它总是只是转到包行（当单步调试器时）并挂起。我应该返回 null 以外的值吗？

提前感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T20:23:12.600

例如

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
import java.util.ArrayList;

public class SwingWorkerExample extends JFrame implements ActionListener {

    private static final long serialVersionUID = 1L;
    private final JButton startButton, stopButton;
    private JScrollPane scrollPane = new JScrollPane();
    private JList listBox = null;
    private DefaultListModel listModel = new DefaultListModel();
    private final JProgressBar progressBar;
    private mySwingWorker swingWorker;

    public SwingWorkerExample() {
        super("SwingWorkerExample");
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        getContentPane().setLayout(new GridLayout(2, 2));
        startButton = makeButton("Start");
        stopButton = makeButton("Stop");
        stopButton.setEnabled(false);
        progressBar = makeProgressBar(0, 99);
        listBox = new JList(listModel);
        scrollPane.setViewportView(listBox);
        getContentPane().add(scrollPane);
        //Display the window.
        pack();
        setVisible(true);
    }
//Class SwingWorker<T,V> T - the result type returned by this SwingWorker's doInBackground
//and get methods V - the type used for carrying out intermediate results by this SwingWorker's 
//publish and process methods

    private class mySwingWorker extends javax.swing.SwingWorker<ArrayList<Integer>, Integer> {
//The first template argument, in this case, ArrayList<Integer>, is what s returned by doInBackground(), 
//and by get(). The second template argument, in this case, Integer, is what is published with the 
//publish method. It is also the data type which is stored by the java.util.List that is the parameter
//for the process method, which recieves the information published by the publish method.

        @Override
        protected ArrayList<Integer> doInBackground() {
//Returns items of the type given as the first template argument to the SwingWorker class.
            if (javax.swing.SwingUtilities.isEventDispatchThread()) {
                System.out.println("javax.swing.SwingUtilities.isEventDispatchThread() returned true.");
            }
            Integer tmpValue = new Integer(1);
            ArrayList<Integer> list = new ArrayList<Integer>();
            for (int i = 0; i < 100; i++) {
                for (int j = 0; j < 100; j++) { //find every 100th prime, just to make it slower
                    tmpValue = FindNextPrime(tmpValue.intValue());
//isCancelled() returns true if the cancel() method is invoked on this class. That is the proper way
//to stop this thread. See the actionPerformed method.
                    if (isCancelled()) {
                        System.out.println("SwingWorker - isCancelled");
                        return list;
                    }
                }
//Successive calls to publish are coalesced into a java.util.List, which is what is received by process, 
//which in this case, isused to update the JProgressBar. Thus, the values passed to publish range from 
//1 to 100.
                publish(new Integer(i));
                list.add(tmpValue);
            }
            return list;
        }//Note, always use java.util.List here, or it will use the wrong list.

        @Override
        protected void process(java.util.List<Integer> progressList) {
//This method is processing a java.util.List of items given as successive arguments to the publish method.
//Note that these calls are coalesced into a java.util.List. This list holds items of the type given as the
//second template parameter type to SwingWorker. Note that the get method below has nothing to do with the 
//SwingWorker get method; it is the List's get method. This would be a good place to update a progress bar.
            if (!javax.swing.SwingUtilities.isEventDispatchThread()) {
                System.out.println("javax.swing.SwingUtilities.isEventDispatchThread() + returned false.");
            }
            Integer percentComplete = progressList.get(progressList.size() - 1);
            progressBar.setValue(percentComplete.intValue());
        }

        @Override
        protected void done() {
            System.out.println("doInBackground is complete");
            if (!javax.swing.SwingUtilities.isEventDispatchThread()) {
                System.out.println("javax.swing.SwingUtilities.isEventDispatchThread() + returned false.");
            }
            try {
//Here, the SwingWorker's get method returns an item of the same type as specified as the first type parameter
//given to the SwingWorker class.
                ArrayList<Integer> results = get();
                for (Integer i : results) {
                    listModel.addElement(i.toString());
                }
            } catch (Exception e) {
                System.out.println("Caught an exception: " + e);
            }
            startButton();
        }

        boolean IsPrime(int num) { //Checks whether a number is prime
            int i;
            for (i = 2; i <= num / 2; i++) {
                if (num % i == 0) {
                    return false;
                }
            }
            return true;
        }

        protected Integer FindNextPrime(int num) { //Returns next prime number from passed arg.       
            do {
                if (num % 2 == 0) {
                    num++;
                } else {
                    num += 2;
                }
            } while (!IsPrime(num));
            return new Integer(num);
        }
    }

    private JButton makeButton(String caption) {
        JButton b = new JButton(caption);
        b.setActionCommand(caption);
        b.addActionListener(this);
        getContentPane().add(b);
        return b;
    }

    private JProgressBar makeProgressBar(int min, int max) {
        JProgressBar progressBar1 = new JProgressBar();
        progressBar1.setMinimum(min);
        progressBar1.setMaximum(max);
        progressBar1.setStringPainted(true);
        progressBar1.setBorderPainted(true);
        getContentPane().add(progressBar1);
        return progressBar1;
    }

    private void startButton() {
        startButton.setEnabled(true);
        stopButton.setEnabled(false);
        System.out.println("SwingWorker - Done");
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        if ("Start" == null ? e.getActionCommand() == null : "Start".equals(e.getActionCommand())) {
            startButton.setEnabled(false);
            stopButton.setEnabled(true);
// Note that it creates a new instance of the SwingWorker-derived class. Never reuse an old one.
            (swingWorker = new mySwingWorker()).execute(); // new instance
        } else if ("Stop" == null ? e.getActionCommand() == null : "Stop".equals(e.getActionCommand())) {
            startButton.setEnabled(true);
            stopButton.setEnabled(false);
            swingWorker.cancel(true); // causes isCancelled to return true in doInBackground
            swingWorker = null;
        }
    }

    public static void main(String[] args) {
// Notice that it kicks it off on the event-dispatching thread, not the main thread.
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                SwingWorkerExample swingWorkerExample = new SwingWorkerExample();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T20:20:45.930

我不确定你想要达到什么目的。您的示例运行良好。工作线程运行到最后。如果您想等到它结束做某事，您必须在代码中的某处调用方法 pbTask.get() 。否则，它只会安静地完成，而不会影响您的任何 UI 组件。

考虑对您的方法进行以下更改，以查看它现在的行为方式。请注意，UI 冻结是因为您让 UI 等待线程完成，但输出“DONE”仅在 WorkerThread 完成时出现在您的日志中。

```
public void actionPerformed(ActionEvent e) {
    if ("Start" == e.getActionCommand() && pbTask == null) {
        theButton.setText("Stop");
        theButton.setActionCommand("Stop");
        (pbTask = new PBTask()).execute();
    } else if ("Stop" == e.getActionCommand()) {
        theButton.setText("Start");
        theButton.setActionCommand("Start");
        pbTask.cancel(true);
        pbTask = null;
    } else {
        alertMsg("Thread still running.");
    }
    try {
        pbTask.get();
    } catch (InterruptedException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    } catch (ExecutionException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();
    }
    System.out.println("DONE");
} 
```

这种变化只是为了说明差异。为了编写实际代码，我们需要更多地了解您想要实现的目标。

* * *

如果我的超感官技能还可以，那么您可能希望将按钮翻转回“开始”。为此，您需要覆盖 Worker 中的 done() 方法：

```
private class PBTask extends SwingWorker<Void, UpdatePB> {
    @Override
    protected Void doInBackground() {
        int prog1 = 0;
        int prog2 = 0;
        Random random = new Random();

        while (prog2 < 100) {
            if(prog1 >= 100) {
                prog1 = 0;
            }
            //Sleep for up to one second.
            try {
                Thread.sleep(random.nextInt(100));
            } catch (InterruptedException ignore) {}
            //Make random progress.
            prog1 += random.nextInt(10);
            prog2 += random.nextInt(5);
            publish(new UpdatePB(prog1, prog2));
        }
        return null;
    }

    @Override
    protected void process(List<UpdatePB> pairs) {
        UpdatePB pair = pairs.get(pairs.size() - 1);
            pb.setValue(pair.pb1);
            pbF.setValue(pair.pb2);
    }

    @Override
    protected void done() {
        super.done();
        theButton.setText("Start");
        theButton.setActionCommand("Start");
    }
} 
```

# java - 会话关闭后如何重新打开休眠会话？

> ID：15165681
> 
> 赞同：1
> 
> 时间：2013-03-01T19:48:38.547
> 
> 标签：java, hibernate

是否有任何会话/休眠功能可以重新连接/重新打开

日志：严重：连接关闭后不允许任何操作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:51:12.653

不，您应该创建/打开一个新的`Session`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-12T08:23:06.367

这是如何确保会话始终有效的代码示例。第 2 行必须重新分配会话，因为`openSession`返回一个新会话。只是`session.getSessionFactory().openSession()`还不够。

```
if (!session.isOpen()) {
        session = session.getSessionFactory().openSession();
        session.beginTransaction();
}
// operate your session 
Criteria criteria = session.createCriteria(clazz); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-02T06:00:48.427

[关于 Seesion 的 Hibernate Docs](http://docs.jboss.org/hibernate/orm/3.5/javadoc/org/hibernate/Session.html)说

a的`lifecycle`a以 a`Session`的开头和结尾为界`logical transaction`。（长事务可能跨越多个数据库事务。）

一旦你的`transaction committed`，将`Session`不可用。你必须创建一个新的。

# c - 分叉进程的子进程中的 std in/out/err 重定向

> ID：15165686
> 
> 赞同：1
> 
> 时间：2013-03-01T19:48:53.917
> 
> 标签：c, bash, io-redirection, fork

我正在用 C 编写一个基本的反向 shell：

```
if(-1 ==  (myShell->pid = fork()))
{
    PipeSet_close(&myShell->pipeSet);
    return RS_ERROR;
}

if(myShell->pid == 0)
{
    /* close pipe ends child doesn't need */
    close(myShell->pipeSet.stdInPipe[1]);
    close(myShell->pipeSet.stdOutPipe[0]);
    close(myShell->pipeSet.stdErrPipe[0]);

    /* dupe 2 the pipes we DO need frm their originals */
    dup2(myShell->pipeSet.stdInPipe[0], fileno(stdin));
    dup2(myShell->pipeSet.stdOutPipe[1],fileno(stdout));
    dup2(myShell->pipeSet.stdErrPipe[1],fileno(stderr));

    /* bash now replaces child process. only returns after bash terminates */
    execl(getenv("SHELL"),NULL,NULL);
    return RS_SUCCESS;
} 
```

我可以使用我的父进程从我的 3 个管道中读取和写入。这使我可以通过孩子执行基本的 shell 命令。ls -l、ps、chmod +x 等。我遇到的问题是当我使用 shell 运行一个需要用户输入的简单程序时。我使用以下程序对此进行测试：

```
int main()
{
int opt;
while (1==1)
{
    printf("-----Remote Shell Menu test:------\n");
    printf("   1\. print 1\n");
    printf("   2\. print 2\n");
    printf("   3\. exit\n");
    fflush(stdin);
    scanf("%d",&opt);

    switch (opt)
    {
    case 1: printf("Pressed 1\n"); break;
    case 2: printf("Pressed 2\n"); break;
    case 3: return 0;
    default: printf("unknown menu option %d\n",opt);
    }
}
} 
```

我可以像往常一样通过我的反向 shell 与这个子程序进行交互，然后按“1”“2”1”“3”，但我没有通过我的标准输出管道获得菜单或看到任何输出直到整个菜单程序终止并且我按 3。谁能告诉我这是为什么？

如果从我的分叉 bash 中生成另一个 bash shell，则情况并非如此......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T11:30:04.660

您还应该`close`在之后复制管道，`dup2`以便进程有机会检测到 EOF。

您可以在`perror`之后添加`execl`；更好的使用`execlp`；给一个`argv[0]`而不是`NULL`。如果`getenv("SHELL")`是会发生什么`NULL`？你确定是`bash`吗？

主要是`return`一些东西；测试`1==1`是无用的`while`（无限循环通常用`while(1)`of获得`for(;;)`）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T21:22:44.130

你有`fflush(stdin)`它什么都不做。fflush 仅用于输出流。我相信如果您将其更改为`fflush(stdout)`，它将解决您的缓冲问题。

# ruby - 使用远程方法修改对象

> ID：15165687
> 
> 赞同：0
> 
> 时间：2013-03-01T19:48:56.713
> 
> 标签：ruby, scope

我试图获取一个对象，然后在另一个对象的方法中修改它，但它没有返回更新的值。这最好用一个例子来解释：

```
@testobject = "This is a string."
handler=Handler.new
handler.load(@testobject)
puts @testobject
=> "This is a string." 
```

处理程序加载：

```
def load(@testobject)
  @testobject = @testobject + " Modified!"
end 
```

我确信这与对象的范围有关，但我对如何使其他类可以访问和修改原始对象感到困惑。

**编辑**：也许这是一个不好的例子。我正在使用字符串来帮助我理解变量/对象范围的工作原理，但在我的实际程序中，它不是字符串。

更具体地说，我有一个正在使用的对象（“流”）。然后我有一个类似于插件的“处理程序”对象，每个都需要修改第一个“流”对象。对于每个处理程序，我想调用 handler.load，让它运行适当的方法来更改“流”对象的设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:52:02.767

这是因为您将`@testobject`其作为参数名称。

执行此行时：

```
@testobject = @testobject + " Modified!" 
```

真实的参数名称被实例变量遮蔽。

但是，即使您删除了 @，也只会影响变量的本地副本。

您可以使用`String#replace`来有效地更新字符串。

试试看：

```
def load(testobject)
  testobject.replace(testobject + " Modified!")
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:20:18.627

您只能通过对象的方法来修改对象。对于字符串，它可能是`replace`或`gsub`。例如，对于数组，它可能是`<<`方法。

在处理程序范围内

```
@testobject = @testobject + " Modified!" 
```

表示“分配`@testobject + " Modified!`给 Handler 实例的实例变量`@testobject`”，它不会修改 @testobject。

顺便问一下，您使用哪个版本的 ruby​​？ruby 1.9.3 无法解释

```
def load(@testobject)
  @testobject = @testobject + " Modified!"
end 
```

因为没有办法用实例变量作为参数来声明方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T22:14:09.427

该`+`方法产生一个新字符串；@testobject 变量一直引用旧变量。

```
def load(@testobject)
  @testobject = @testobject << " Modified!"
end 
```

`<<`是一种变异方法，它确实修改了@testobject 变量所引用的对象。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-03-01T19:55:53.520

```
@testobject = 'This is a string.'
callback = Proc.new {|suffix| @testobject = @testobject + suffix}
handler.load(callback)

def load(callback)
    callback.call(' Modified!')
end 
```

# javascript - Phonegap Build 播放本地音频

> ID：15165695
> 
> 赞同：1
> 
> 时间：2013-03-01T19:49:47.303
> 
> 标签：javascript, html, cordova, phonegap-build

我想用phonegape build 播放一首歌曲。我的问题是在 phonegap 构建项目中，所有文件都在同一个文件夹中。所以我现在不知道项目中包含的声音文件的正确路径是什么。它适用于您的示例中显示的网址。我尝试了不同的路径来访问音频文件，例如：

```
"/android_asset/www/test.mp3" 
"/asset/test.mp3" 
"test.mp3" 
```

我不知道为什么它不起作用，在这里我在小提琴上展示我的问题：http: [//jsfiddle.net/b7BPV/](http://jsfiddle.net/b7BPV/) 感谢德国的帮助和问候！您真棒！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T04:02:37.113

如果文件位于 www 文件夹中，这将是 test.mp3 的位置

```
src="test.mp3" 
```

您需要对代码进行的更改是

```
<a href="#" class="btn large" onclick="playAudio('test.mp3');">Play Audio</a> 
```

# sql-server - 如何使用 shrinkDBs.bat 文件截断嵌套文件夹中的所有 log.ldf 文件？

> ID：15165696
> 
> 赞同：0
> 
> 时间：2013-03-01T19:49:53.087
> 
> 标签：sql-server, batch-file

我希望能够缩小嵌套文件夹中的所有日志文件。我已经使用这个相同的脚本来修改数据库，但是我在使用shrink 命令时遇到了问题。

当我运行此脚本时，我收到一条错误消息，指出它在 sys.database_files 中找不到数据库。所以我猜我的数据库在 sys.database_files 中使用了不同的名称，或者根本没有添加。你能帮我吗？

```
for /r /d %%i in (*) do (
ECHO  %%i\MY_DB.mdf
osql -S LOCALHOST\SQLEXPRESS -U johan -P johan_j-d master -Q "EXEC sp_attach_db 'MY_DB', '%%i\MY_DB.mdf', '%%i\MY_DB_log.ldf';"
osql -S LOCALHOST\SQLEXPRESS -U johan -P johan_j -d MY_DB -Q "DBCC SHRINKFILE (N'MY_DB_log',0,TRUNCATEONLY);"
osql -S LOCALHOST\SQLEXPRESS -U johan -P johan_j -d master -Q "EXEC sp_detach_db 'MY_DB';"
) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:16:34.700

问题解决了。我应该一直使用逻辑文件名而不是物理文件名。

# reporting-services - ssrs动态文本颜色

> ID：15165697
> 
> 赞同：2
> 
> 时间：2013-03-01T19:50:04.993
> 
> 标签：reporting-services, ssrs-2008

我正在为 MS-SQL 2008 R2 使用 SSRS。我有一列数据将显示 Active Staff、Inactive Staff 或 Null。如果它们是非活动人员或空值，我想将列中文本的颜色更改为红色。我还想将 Null 更改为在列中显示“No Staff”。我可以将其中一个或另一个交给 Red，但不能同时获得两者，目前我有 Inactive Staff。

我用来生成列的两个表达式是： 对于列值：

```
=IIF(IsNothing(Fields!StaffName.Value), 
      "No Staff", 
      Fields!StaffName.Value) 
```

颜色：

```
=IIF(Fields!StaffName.Value.ToString().Contains("Inactive"), "Red",
 IIF(ISNothing(Fields!StaffName.Value), "Red", 
 "Black"
 )) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T22:01:44.110

我对你的数据集做了一些猜测，并整理了一个简单的例子。

数据集：

```
select StaffName = 'Staff 1'
union all select StaffName = 'Staff 2 (Inactive)'
union all select StaffName = null 
```

**Text Box**的表达式，与您的完全相同：

```
=IIf(IsNothing(Fields!StaffName.Value), "No Staff", Fields!StaffName.Value) 
```

**文本框** *颜色*属性的表达式：

```
=IIf(InStr(Fields!StaffName.Value, "Inactive") > 0 or IsNothing(Fields!StaffName.Value)
    , "Red"
    , "Black") 
```

最终结果：

![在此处输入图像描述](../Images/c237b4c70de7b55c7b397ebb9cb7a0bf.png)

`@Preet Sangha`在他的评论中也提出了一个很好的观点，所以你可能需要记住区分大小写。

# highcharts - 为什么更改 x 值会使线向上或向下移动？

> ID：15165700
> 
> 赞同：0
> 
> 时间：2013-03-01T19:50:11.827
> 
> 标签：highcharts

为什么以下代码会更改我的折线图上的 y 值而不是 x 值？（通过改变 y 值，我的意思是线向上或向下移动，而不是左右移动）

```
chart.series[0].data[0].update(x = xMin); 
```

该系列最初加载了以下设置

```
series: [{
    type: 'line',
    name: 'Regression Line',
    data: [[0, 1.11], [5, 4.51]],
    marker: {
        enabled: false
    },
    states: {
        hover: {
            lineWidth: 0
        }
    },
    enableMouseTracking: false
}] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T19:59:17.537

**update** `([Mixed options], [Boolean redraw], [Mixed animation])`
用新值更新点。

**参数**

*   **options**：`Number|Array|Object`
    点选项。**如果 options 是单个数字，该点将被赋予该数字作为 y 值**。如果它是一个数组，它将分别解释为 x 和 y 值。如果它是一个对象，则应用 series.data 下概述的高级选项。

*   **重绘**：`Boolean`
    默认为真。点更新后是否重绘图表。如果对图表做更多的操作，最好将redraw设置为false，之后调用chart.redraw()。

*   **动画**：`Mixed`
    默认为真。如果为 true，更新将使用默认动画选项进行动画处理。动画也可以是具有持续时间和缓动属性的配置对象。

[**来源**](http://api.highcharts.com/highstock#Point.update%28%29)

因此，更改为以下内容：

```
chart.series[0].data[0].update({x: 3}); 
```

[**演示**](http://jsfiddle.net/ricardolohmann/Eybb7/)

# python - 使用 Python httplib “HTTPConnection” 对象，如何发送没有值的标头？

> ID：15165706
> 
> 赞同：0
> 
> 时间：2013-03-01T19:50:34.997
> 
> 标签：python, http, httplib

我有以下代码，但 httplib 仍将标头“emptyheader”视为键：值对。

```
h = httplib.HTTPConnection("somewhere:5000")
headers = {}
headers['emptyheader'] = None
h.request('POST', '/somewhere', '', headers) 
```

如何发送理智的请求但带有无价值的标头“emptyheader”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T19:52:32.467

将标头值设置为`''`：

```
headers['emptyheader'] = '' 
```

会输出：

```
emptyheader: \r\n 
```

这符合[消息头的 HTTP 规范](http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.2)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:12:53.080

没有办法使用httplib来做到这一点。'headers' 参数必须是字典。然后 httplib 将标头构造为以冒号分隔的名称-值对。

我认为 requests 模块做同样的事情。

因此，作为一个选项，尝试 curl：

```
subprocess.call(['curl', '-i', '-H', '"emptyheader"', '"http://somewhere:5000/somewhere"']) 
```

但是，我不确定您为什么需要它：http 标头是设计的键：值对。

# jsoup - 如何使用jsoup从网页中提取特定内容

> ID：15165708
> 
> 赞同：0
> 
> 时间：2013-03-01T19:50:40.597
> 
> 标签：jsoup

我只需要从网页[http://www.informatik.uni-trier.de/~ley/pers/hd/r/Rao:Rahul.html](http://www.informatik.uni-trier.de/~ley/pers/hd/r/Rao:Rahul.html)中提取那些出版物，其中第一作者是 Rahul Rao。

我已经尝试了以下代码，但它没有给我任何输出。

```
for( Element element : doc.select("table span.this-person.title") ){
System.out.println(element.text());
} 
```

我需要什么才能获得首选输出？先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T12:31:49.487

下面的代码会给你预期的输出..看看它是否对你有帮助！

文档 doc = Jsoup.connect(" [http://www.informatik.uni-trier.de/~ley/pers/hd/r/Rao:Rahul.html](http://www.informatik.uni-trier.de/~ley/pers/hd/r/Rao:Rahul.html) ").get(); 元素 span = doc.select(("div[class=data]"));

```
 //System.out.println(span.tagName("span"));
    for (Element src : span) {

        for(int i=0;i<src.childNodeSize();i++){
            if(src.childNodes().get(0).toString().contains("Rahul Rao")){
                if(src.childNodes().get(i).toString().contains("<span class=\"title\">")){
                    System.out.println(src.childNodes().get(i));
                }

            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T08:12:25.327

我试图提取页面上发布的出版物并取得了一些成功。

代码如下：

```
Document doc = Jsoup.connect("http://www.informatik.uni-trier.de/~ley/pers/hd/r/Rao:Rahul.html").get();
    Elements span = doc.select("span");
    for (Element src : span) {
        if (src.tagName().equals("span")){
            System.out.println();
            System.out.print( src.ownText() );
        }
    } 
```

看看有没有帮助！！

# excel - vba excel匹配多个条件

> ID：15165714
> 
> 赞同：0
> 
> 时间：2013-03-01T19:50:52.733
> 
> 标签：excel, vba

任何帮助，将不胜感激。这看起来像一个常见问题，但我在 vba 中找不到任何问题。这是我最好的镜头：

```
Dim oppositeRow As Long
.....
oppositeRow = WorksheetFunction.Match(ddate & campaign, "A3:B62", 0) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-01T20:05:24.810

如果您知道只有一个匹配结果，您可以按照 Excel 公式执行以下操作：

```
=SUMPRODUCT(ROW(A2:A5), N("john"=A2:A5), N("smith"=B2:B5)) 
```

应用于以下工作表：

```
      AB
1 先到后
2 鲍勃史密斯
3 约翰·史密斯    
4 约翰布朗
5山姆布朗

```

这将返回 3（因为 john smith 在第三行），由于标题行，您必须减去 1 才能将索引放入表中。

这是通过将三个向量相乘来实现的：

1.  第一个，ROW(A2:A5)，就是 {2,3,4,5}。
2.  第二个，N("john"=A2:A5)，是 {0,1,1,0}。N() 采用向量 {false,true,true,false} 并将其转换为数字。
3.  第三个，N("smith"=B2:B5)，是 {1,1,0,0}。同样处理 N()。

将向量按元素相乘得到 {0,3,0,0}，其和为 3。

在 VBA 中表达像这样的复杂公式有点尴尬，所以如果你想纯粹在 VBA 中这样做，我建议你只用一个计数器循环并记录你找到符合条件的行的索引。

编辑：这是一些 VBA 代码：

```
Dim index as Integer
For index = 1 to 4
    If Range("A1").Offset(index).Value = "john" And Range("B1").Offset(index).Value = "smith" Then
        Exit For
    End If
Next index 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T20:24:57.103

您可以使用公式完成此`DGET`操作，只要您在工作表中添加一个用于表示行号的列。

```
行 ID 列 1 列 2
1个氨基酸
2 BB
3 立方厘米
4 天
5 EE

```

那么公式是：

```
=DGET(A1:C6;1;E1:F2) 
```

这里假设上面的数据在`A1:C6` 下面的数据块中，其中包括搜索条件被放在`E1:F2`

```
列 1 列 2
抄送

```

`DGET`上面列出的公式的返回值为'3'。

如果您的 VBA 方法将正确的搜索条件放入单元格`E2`并`F2`在运行`DGET`公式之前，您可以纯粹在 VBA 中执行此操作。

# c# - 使用 jquery 进行 AJAX 后调用？

> ID：15165716
> 
> 赞同：-6
> 
> 时间：2013-03-01T19:50:53.810
> 
> 标签：c#, javascript, jquery, asp.net, ajax

我找不到任何明确的例子来说明我想要什么。我想访问*sample.aspx*并希望通过`POST`（不是查询字符串）向它发送一些纯文本参数。如果成功，我想查看 JSON 格式的响应。如果它失败了，我想做一些事情来处理它。所以我需要成功和失败的功能。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:02:20.473

通过 POST 的纯文本参数（不是查询字符串）.. 请详细说明

让我为你分解一下……

现在ajax是如何工作的

1-您发送请求（GET / POST）。

**注意：访问网页是一个获取请求**

2-页面输出响应..

3- jquery 读取页面 .. 它读取页面的 html .. 所以如果我用 $.ajax 查看堆栈溢出，我将获得完整的首页 html ..

这是一个例子

```
$.ajax({
  url: "http://stackoverflow.com",
  type: "GET",
  data: {id : 'myid'}, // the url will become http://stackoverflow.com?id=myid
  dataType: "html", // what type of response your expecting 
  success : function(e){ // e is the response 
              console.log(e); // the will log the html of stackoverflow
             }
}); 
```

但是如果您希望您将获得的数据是 json，那么您在服务器端所要做的就是使页面输出（显示）您想要的 json 作为字符串，jquery 将读取它，您可以将其解析为 json

这是一个小的 php 示例

```
<?php
echo 'hi ' . $_GET['id'] ;
?> 
```

使用上面的 jquery 代码和这个页面我会得到响应

```
'hi myid' 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-01T19:56:25.323

```
var data = ; //POST PARAMS for send 

$.ajax({
    url: '/sample.aspx',
    type: 'POST',
    contentType: "application/json",
    timeout: 10000,
    dataType: "html",
    data: data,
    success: function (response) {

    },
    error: function (error) {

    }
}); 
```

# sencha-touch-2 - 使用 sencha cmd 打包一个 sencha touch 应用程序

> ID：15165726
> 
> 赞同：2
> 
> 时间：2013-03-01T19:51:30.080
> 
> 标签：sencha-touch-2, sencha-cmd

我已经制作了我的应用程序，现在我想打包它，所以我转到终端中的应用程序目录，其中包含

```
/app
/app.js
/app.json
/resources
/index.html
/touch 
```

我跑`sencha app build package`，我遇到

```
[ERR]       Please ensure this command was executed from a valid application directory
[ERR]       Unable to locate 'app.dir' config property from sencha.cfg 
```

我究竟做错了什么？我在应用程序目录中，它包含 touch 文件夹中的 sdk。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-02T12:43:34.903

您使用的是哪个版本的 Sencha SDK 和 CMD？最新版本的 Cmd 不适用于 2.1.1 之前的 SDK 版本。

检查一下：[Sencha Cmd Unable to locate 'app.dir' config property from sencha.cfg](https://stackoverflow.com/questions/14749050/sencha-cmd-unable-to-locate-app-dir-config-property-from-sencha-cfg)

# php - Symfony 2 - 不同页面上的相同表单

> ID：15165727
> 
> 赞同：1
> 
> 时间：2013-03-01T19:51:31.953
> 
> 标签：php, symfony, twig

我有一个在我网站上的许多页面上呈现的联系表格，我需要在许多不同的控制器中处理这个表格。如何在所有这些控制器中处理这种形式？我不想定义特殊的路由和控制器来处理这个表单，我需要在它呈现的所有页面中处理它。

现在我打电话给控制器动作女巫正在以这种方式呈现我的表单：

在控制器中：

```
 $profileAskFormResponse = $this->forward('MyBundle:Profile:profileAskForm', array(
                'user' => $user,
            ));          
    if ($profileAskFormResponse->isRedirection())
                return $profileAskFormResponse;

    return $this->render(MyBundle:Single:index.html.twig', array(
                'myStuff' => $myStuff,
                'profileAskForm' => $profileAskFormResponse,
   )); 
```

在树枝上：

```
{{ profileAskForm.content|raw }} 
```

我在每个需要处理我的联系表的控制器中使用此代码。有没有更简单的方法来做到这一点？我的第一个想法是在 twig 中做这种事情：

```
{% render 'MyBundle:Profile:profileAskForm' with {request: app.request, user: user} %} 
```

但我无法在表单发送后从那里重定向。关键是，是否有一种简单快捷的调用方式（例如

来自 twig）这种组件，例如我的联系表单，该组件不仅呈现一些东西，而且有一些

应用程序逻辑。我会很高兴将这种组件用作砖块的女巫，我可以在任何地方轻松放置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:08:54.943

一种可能性是创建一个类`Contact.php`，其中所有字段都作为类成员。然后，您可以非常轻松地将断言添加到每个字段：

```
/**
  * @Assert\NotBlank(message="Please fill in your e-mail at least")
  * @Assert\Email(checkMX = true)
  */
protected $email; 
```

你可以为这个类创建一个表单类型`ContactType.php`并`FormBuilder`在其中使用：

```
$builder->add('email', 'email', array('label' => 'E-mail')); 
```

然后，您可以在所有控制器中重新使用该表单。您甚至可以使用处理所有外发电子邮件的电子邮件类对其进行扩展，然后将有效的联系表单注入其中：

```
$contact = new Contact();
$form = $this->createForm(new ContactType(), $contact);

if ($request->getMethod() == 'POST') {
    $form->bindRequest($request);

    if ($form->isValid()) {
        // now you can easily inject the class to the one that handles e-mail traffic for example
        $email = new Email();
        $email->sendContactForm($contact);
    }
} 
```

[你可以在Symfony2 Cookbook: Forms](http://symfony.com/doc/2.0/book/forms.html)中深入了解它。

# php - 可以在没有 fwrite 的情况下使用 cURL_setopt 和 PHP 编写大型 XML 文件吗？

> ID：15165730
> 
> 赞同：0
> 
> 时间：2013-03-01T19:51:44.617
> 
> 标签：php, curl, xml-parsing, dynamic-data, fwrite

我遇到了与09 年发布的[这个问题几乎相同的问题。](https://stackoverflow.com/questions/1521241/make-curl-write-data-as-it-receives-it)它似乎没有成功解决，我整天都在研究相关问题并实施我发现的建议。

我正在尝试从 XML 源（不是文件）中提取动态（每天更改）数据并插入到 mySQL 数据库中。当我尝试在没有 fwrite 的情况下提取数据时，数据返回时没有输出中的标签/键。因此，我无法正确地将数据分配给特定的数据库字段。

我决定将信息写入一个文件并从那里开始，但文件每次都以 334kb 的大小中止/“完成”。不幸的是，我是一个 cURL 新手，没有能力确切地了解问题所在。此外，我正在使用 vqMod for OpenCart 来执行此操作，否则我将直接使用 PHP。

我错过了什么？

此外，有没有办法将 xml 作为数组而不是字符串拉出（从而可能绕过 fwrite 步骤）？或者，我应该写入其他文件类型吗？

感谢任何建议或重定向到我错过的已解决问题。

这是相关代码，注释部分是我尝试过的修复：

```
$curl = curl_init();
    $fp = fopen('dir/file.xml' , "w" );
    //w+ will not download any information from the url - file is created but empty.

    //AS IS, downloads first 334KB of file then lands on a blank page
    //and a 500 error when any of these other options are implemented. 
    curl_setopt($curl, CURLOPT_URL, 'http://www.url.com');
    curl_setopt($curl, CURLOPT_FILE, $fp);
    curl_setopt($curl, CURLOPT_FOLLOWLOCATION, true);

    //  curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
    //  curl_setopt($curl, CURLOPT_TIMEOUT,  300);
    //  curl_setopt($curl, CURLOPT_NOPROGRESS, false);
    //  curl_setopt($curl, CURLOPT_RANGE, '0-1000');

    //  $data = array();
    $data = curl_exec($curl);

    fwrite($fp, $data);

    curl_close($curl);
    fclose($fp); 
```

**更新**：尝试使用 simplexml_load_string 而不是 fwrite() 来提取一个产品的信息，但仍然取得了有限的成功。我正在使用的 XML 示例：

```
 <?xml version="1.0"?>
      <response>
        <root>
          <part>
            <![CDATA[PARTNUM]]>
          </part>
          <errorcode>0</errorcode>
          <errormsg></errormsg>
          <special>N</special>
          <description>
            <![CDATA[]]>
          </description>
          <price>75</price>
          <weight>1.02</weight>
          <webpurch>Y</webpurch>
          <altnum>
            <![CDATA[ALT-NUM]]>
          </altnum>
          <active>Y</active>
          <redo>
            <![CDATA[]]>
          </redo>
          <codes> 
              <code>
                <fieldname>
                  <![CDATA[Mfr Part No]]>
                </fieldname>
                <fieldvalue>
                  <![CDATA[PARTNUM]]>
                </fieldvalue>
               </code>
               <code>
                <fieldname>
                  <![CDATA[Special Code 1]]>
                </fieldname>
                <fieldvalue>
                  <![CDATA[XYZ123]]>
                </fieldvalue>
               </code> 
            </codes>
          <customtag>N</customtag>
          <onhand>0</onhand>
          <notes>
            <![CDATA[PRODUCT-SPECIFIC NOTE]]>
          </notes>
          <mfr>
            <mfr_name>
              <![CDATA[MFR]]>
            </mfr_name>
          </mfr>
          <altpartnums>
            <altnum>
              <![CDATA[PARTNUM.12]]>
            </altnum>
          </altpartnums>
          <gtrue>N</gtrue>
          <group>
            <![CDATA[GROUP NAME]]>
          </group>
          <categories>
            <cat>294</cat>
            <cat>475</cat>
          </categories>
        </root>
      </response> 
```

**这是我不**使用 fwrite()时多个产品的 $data 返回示例：0 N 75 1.02 Y Y N 0 N 294 475 0 N 288 12 Y Y 是 18 是 222 456 3786

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:26:12.207

删除这一行：

```
fwrite($fp, $data); 
```

我很确定`$data`它是空的，因为您已指定不返回任何字符串数据，而是将其写入文件。文件也是空的也就不足为奇了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T22:19:54.650

我使用以下代码让它在没有 fwrite() 的情况下工作：

```
 if(extension_loaded('curl')){
                    $curl = curl_init();
                    curl_setopt($curl, CURLOPT_URL, 'http://www.url.com');
                    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
                    curl_setopt($curl, CURLOPT_TIMEOUT, 30);
                    curl_setopt($curl, CURLOPT_NOPROGRESS, FALSE);
                    curl_setopt($curl, CURLOPT_MAXCONNECTS, 1);
                    curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 0); 

                    $newparts = curl_exec($curl);

                    $xml = simplexml_load_string($newparts);

                foreach($xml->modpart as $item){

                      if(($item->active == 'Y') || ($item->active == 'YES')){
                          $status = '1';
                      } else {
                          $status = '0';
                      }

                if(!empty($item->mfr)){ 
                      $rs   = $this->db->query("SELECT manufacturer_id FROM ".DB_PREFIX."manufacturer WHERE name = '".$item->mfr->mfr_name."'");
                      $mfr_id = $rs->row['manufacturer_id'];
                }

                 if(!empty($item->codes)){
                          if($item->codes->code->fieldname == 'Mfr Part No'){
                              $mpn = $item->codes->code->fieldvalue;
                          } 
                  }
                      $this->db->query("INSERT IGNORE INTO " . DB_PREFIX . "product (model, sku, mpn, quantity, date_available, sort_order, manufacturer_id, price, weight, status, date_added) 
                          VALUES ( 
                              '".mysql_real_escape_string($item->description=htmlspecialchars(trim($item->description)))."', 
                              '".mysql_real_escape_string($item->sku)."', 
                               '".$mpn."', 
                              '".mysql_real_escape_string($item->mpn)."', 
                               NOW(), 1000,
                              '".$mfr_id."',
                               '".mysql_real_escape_string($item->price)."', 
                               '".mysql_real_escape_string($item->weight)."', 
                               '".$status."', 
                                 NOW() 
                              )");    

                    $pr = $this->db->query("SELECT product_id FROM ".DB_PREFIX."product WHERE sku = '".$item->part."'");
                    $product_id = $pr->row['product_id'];

                    if(isset($product_id)){

                              $this->db->query("INSERT IGNORE INTO " . DB_PREFIX . "product_description (product_id, language_id, name, meta_keyword, meta_description, description, tag)
                                      VALUES(                                                       
                                              '" . (int)$product_id . "',
                                              '1',
                                              '" . $item->part. "',
                                              '" . $item->part. "',
                                              '".mysql_real_escape_string($item->description=htmlspecialchars(trim($item->description)))."', 
                                              '".mysql_real_escape_string($item->description=htmlspecialchars(trim($item->description)))."', 
                                              '".mysql_real_escape_string($item->description=htmlspecialchars(trim($item->description)))."' 
                                      )");

                            $this->db->query("INSERT IGNORE INTO " . DB_PREFIX . "product_to_store SET product_id = '" . (int)$product_id . "', store_id = '0'");

                            $this->db->query("INSERT IGNORE INTO " . DB_PREFIX . "url_alias SET query = 'product_id=" . (int)$product_id . "', keyword = '" .$item->part . "'");

                        foreach($item->cats as $cats){
                            $category = $cats->cat;
                                foreach($category as $category_id){
                                $this->db->query("INSERT IGNORE INTO " . DB_PREFIX . "product_to_category SET product_id = '" . (int)$product_id . "', category_id = '" . (int)$category_id . "'");
                                } 
                        } 
                             $this->cache->delete('product');
                    } 
            } 

            curl_close($curl);

    } 
```

我仍然没有解决超时问题，但至少我可以通过某种方式将我的产品放入数据库。如果/当我找到它时，我会发布超时解决方案。

# android - 为所有操作系统版本 2.2 及更高版本更改 Android 中的 APN 设置

> ID：15165748
> 
> 赞同：0
> 
> 时间：2013-03-01T19:52:34.270
> 
> 标签：android, apn

如何以编程方式更改 Android 中所有操作系统版本 2.2 及以后的 APN 设置？是否可以在操作系统版本 4.0 以后更改它们？

# ruby-on-rails - 为不同的用户配置文件设计具有多态关联的用户

> ID：15165749
> 
> 赞同：3
> 
> 时间：2013-03-01T19:52:36.030
> 
> 标签：ruby-on-rails, ruby, polymorphism, polymorphic-associations

我有一个 Rails 应用程序。我安装了设计。我想在用户模型和不同的配置文件之间建立多态关联，例如：学生和导师。

这就是我想要做的：有一个学生注册页面，其中包含常规设计字段，例如：`email`、、。但我也希望有特定于学生资料的字段，例如和`password``password_confirmation``residency_type``graduation_year`

```
user.rb
class User < ActiveRecord::Base
  belongs_to :profile, polymorphic: true

student_profile.rb
class StudentProfile < ActiveRecord::Base
  has_one :user, as: :profile, dependent: :destroy

registrations_controller.rb
class RegistrationsController < Devise::RegistrationsController
  def new_student_registration
    resource = build_resource({})
    respond_with resource
  end
... 
```

我可以在控制台上创建一个带有学生个人资料的用户，就像这样......

```
u = User.new
u.email = "something@whatever"
... (password and password confirmation)
u.profile = StudentProfile.new
u.graduation_year = "2014"
u.save 
```

问题是，我不知道如何设置控制器和一个表单来做到这一点。我该怎么做？请注意用户和学生资料之间的关系。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-10-30T05:52:28.393

我最好的建议是覆盖设计视图和注册控制器并使用表单对象来注册用户。这是关于表单对象的一个​​很好的资源：http: [//blog.jasonharrelson.com/blog/2014/04/06/how-i-design-rails-applications-part-2-form-objects/](http://blog.jasonharrelson.com/blog/2014/04/06/how-i-design-rails-applications-part-2-form-objects/)

[ActiveModel::Model](http://api.rubyonrails.org/classes/ActiveModel/Model.html)对于创建表单对象非常有用，尽管有些人更喜欢使用一些 gem，例如[改革](https://github.com/apotonick/reform)。

我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T23:16:50.033

观看此 Rails 演员剧集[http://railscasts.com/episodes/210-customizing-devise](http://railscasts.com/episodes/210-customizing-devise)

对于配置文件，我认为您只需要在新页面表单中添加该字段，并在用户模型中使其接受嵌套属性。要知道配置文件是什么，您可以有一个选择框和一个前置过滤器，以查看基于该值的配置文件

# moodle - 手动注册和到期时间

> ID：15165751
> 
> 赞同：2
> 
> 时间：2013-03-01T19:52:41.740
> 
> 标签：moodle

在手动注册的 Moodle 文档中，可以看到：

注册到期操作 - 指定当用户注册到达到期日期时会发生什么。请注意，“从课程中取消注册用户”选项会从课程中清除成绩、组成员资格、偏好和其他用户相关数据

和

默认注册时长 - 这设置了新课程注册的默认时长。

据我了解，如果我通过手动注册为用户注册课程，并且将默认注册持续时间设置为 10 分钟并将过期操作设置为取消注册，则我使用此插件注册的用户将不再属于在 10 分钟后的课程中（前提是 cron 服务器已经运行）。

但是，用户并没有从课程中删除，我已经检查了 cron 服务器是否正在运行。

我的moodle版本是2.4.1，我想知道我是否是唯一注意到这一点的人，以及它是否适用于任何其他版本......

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-05T13:38:05.213

你是对的，但我想在这里添加一些东西，正如你告诉 cron 服务器必须运行才能完成取消注册过程，但 Moodle 还在该用户访问课程期间检查用户可访问性，如果用户的注册持续时间已经结束，则该用户被阻止访问课程但是除非 cron 没有为此运行，否则用户的等级会保留在课程中。

我还发现了一个有趣的案例，如果我们在课程中允许访客访问，那么它将无法正常工作，因为我之前提到用户将获得课程的完全访问权限，即使他的注册期限已经结束。

# android - 我可以即时操纵回铃音吗？

> ID：15165752
> 
> 赞同：1
> 
> 时间：2013-03-01T19:52:44.500
> 
> 标签：android

我的问题是关于运行 Android 操作系统的智能手机，因为我认为我的请求在 iOS 上是不可能的。

我对实时处理回铃音很感兴趣。

回铃音是呼叫者在等待接听电话时听到的声音。

默认状态下，A呼叫B，B听到铃声，A听到回铃音，直到B接听。

我想知道当 B 听到铃声时，他是否可以更改 A 在接通呼叫之前听到的回铃音。

例如，假设当 A 呼叫 B 时，A 听到一首迈克尔杰克逊的歌曲作为回铃音。是否有可能设计一个应用程序，让 B 可以在正在进行的回铃音中突然添加另一层音效，或者将其实时切换为麦当娜的歌曲，然后接听电话？

谢谢阿维

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:01:05.387

不，这是不可能的，原因与[无法为 Android 制作答录机](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/6JBMgqLEozM)相同。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:01:28.640

我想这不是与任何特定手机或手机操作系统相关的问题，而是 B 运营商的问题。当您等待被叫方应答时，您听到的声音不是由被叫方的电话控制，而是由他们的接线员（电话公司）控制。接线员可以为您提供一些方法来设置呼叫者在尝试联系您时会听到的自定义音调，我可以想象理论上他们可以放弃对某些 API 的访问以从应用程序实时更改音调在您的手机上，尽管我怀疑目前是否有任何运营商这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:01:30.487

据我了解，回铃音是运营商设置。根据主叫号码，网络将播放特定的声音，而不是标准的振铃。

除非无线运营商公开 API 来操纵该功能，否则我认为这是不可能的。

如果您想从应用程序中执行此操作：我相信当电话开始时您的电话状态已经是“通话中”，因此您无法检测到对方何时接听。通话时通过扬声器播放声音是没有用的，因为您无法检测到对方何时接听，因此您无法停止播放歌曲。

# cocoa-touch - PSPDFKit- 目录，错误？

> ID：15165754
> 
> 赞同：0
> 
> 时间：2013-03-01T19:52:56.430
> 
> 标签：cocoa-touch, pspdfkit

我正在考虑为我的公司购买 PSPDFkit，我认为它非常适合我们在这里需要的东西，我不是专业开发人员，但这些天我正在尝试不同的东西来看看它是如何工作的，一切都很棒，而且它做得更多比我需要的多，但是在目录菜单上存在问题，自动搜索块单元格，当它读取 PDF 时，它检测到几乎所有内容都很好，按字母顺序但直到单词“E”之后什么都没有出现......我的意思是，它会读取 pdf 书的所有页面并检测内容和章节，但直到“E”为止，“e”之后的其余页面按字母顺序不会出现在滚动条中......所以我想知道如果这是一个限制，因为是演示版，还是一个错误？？？任何想法？我确实尝试了很多事情，比如，改变我 pdf 上的字体，用数字，字母标记每一页，以便于查找，但它不会超出“E”......在我购买它之前，我真的需要知道如何让这个工作正常，因为我要去的作品制作就像是一种有很多页和章节的目录，所以这个功能对我来说是基础。感谢您的帮助，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T10:26:24.560

好的，我发现发生了什么，它不是错误或类似的东西。解决方案非常简单，我只是通过手动添加索引（儿子、女儿、叔叔等...）来编辑我的 pdf，然后正常添加到项目中，它工作得非常完美。我希望这会有所帮助，以防有人遇到同样的问题。干杯。

# objective-c - NSView drawRect 干扰 NSButton 悬停

> ID：15165757
> 
> 赞同：2
> 
> 时间：2013-03-01T19:53:04.340
> 
> 标签：objective-c, xcode, cocoa, nsview, nsbutton

最好用这两张图来解释。第一张图片显示了一个尚未悬停的 nsbutton，第二张显示了当我将鼠标悬停在它上面时相同的 nsbutton。

如您所见，无论出于何种原因，NSView 外部贝塞尔路径似乎也绘制在按钮上。该按钮是一个普通的 NSButton 实例，没有子类。

![在此处输入图像描述](../Images/f4f0fcd6e06f0803bf42672aa10857c4.png)

![在此处输入图像描述](../Images/8e69e62dafd59896c8b9d4aac775803d.png)

这是我的自定义 NSView ：

```
#import "MyView.h"

@implementation MyView
- (void)drawRect:(NSRect)rect
{    
    NSBezierPath *path;

    path = [NSBezierPath bezierPathWithRect:rect];
    [[NSColor redColor] set];
    [path fill];

    rect.size.width -= 10;
    rect.size.height -= 10;
    rect.origin.x += 5;
    rect.origin.y += 5;

    path = [NSBezierPath bezierPathWithRect:rect];
    [[NSColor whiteColor] set];
    [path fill];
}

- (void)awakeFromNib
{
    NSButton *commandButton = [[NSButton alloc] initWithFrame:NSMakeRect(90, 50, 100, 18)];

    [commandButton setButtonType:NSMomentaryPushInButton];
    [commandButton setBordered:YES];
    [commandButton setTitle:@"Test!"];
    [commandButton setFont:[NSFont fontWithName:@"LucidaGrande" size:14.0]];
    [commandButton setBezelStyle:NSInlineBezelStyle];

    [self addSubview:commandButton];
}

@end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T20:25:02.400

绘图系统将需要重绘的视图矩形作为单个参数传递给`drawRect:`您无条件地使用该矩形作为路径，`path = [NSBezierPath bezierPathWithRect:rect];`假设此矩形始终是视图的完整边界矩形。不是这种情况。当按钮悬停在上面时，它的*框架*是视图中已失效并需要重绘的部分，`rect`就是这样。

您应该进行测试`rect`以确保它适合用于路径，或者 - 更容易并且很好，除非您有可测量的与绘图相关的性能问题 - 始终使用视图的边界作为轮廓路径。

```
path = [NSBezierPath bezierPathWithRect:[self bounds]]; 
```

绘图上下文将把绘图剪辑到它要求的矩形。

# ssis - SSIS 脚本任务在服务器上失败，并出现错误“无法加载脚本以执行”

> ID：15165760
> 
> 赞同：9
> 
> 时间：2013-03-01T19:53:29.193
> 
> 标签：ssis

我有 3 个带有脚本任务的 SSIS 包，它们都做非常相似的事情——查询 SQL Server 数据库，遍历结果，然后为每一行调用一个 SOAP Web 服务。这些包在本地运行良好，在开发和 QA 服务器上运行良好。

在生产服务器上，1 运行正常，2 失败并出现不祥的“无法加载脚本以执行”错误。这些是 Server 2008 SP2 上的 SQL 2008 R2 环境。无论运行它们的用户如何，都会发生错误。

到目前为止，我已经尝试了以下方法：

*   在我的开发环境中运行包，数据库连接指向生产环境（运行良好）
*   在项目设置中将 Run64BitRuntime 设置为 false。没区别。
*   删除包并重新部署它
*   [按照此处](http://blogs.msdn.com/b/mab/archive/2008/11/06/custom-security-and-sql-job-with-ssis-script-task.aspx)的建议，给定对 /Windows/Temp 的显式写访问权限。这最初是在使用代理用户运行时发生的，所以我们尝试了这个修复。但是当我使用我的管理员帐户运行时，我得到了同样的错误。

我无法在生产服务器上重新编译脚本，因为开发堆栈不存在并且它是生产服务器。我也无法按照[此处](http://social.technet.microsoft.com/Forums/en-US/sqlintegrationservices/thread/5fd8ba4c-9db5-47f0-92a7-6ff80da8e006)的建议在此服务器上安装或更新 BIDS 。

根据某些人的发现，似乎可能需要在目标环境中重新编译脚本，但我没有这个选项。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-01T22:14:02.273

因此，不幸的是，答案是重建脚本任务。看来这些东西可能会被破坏。我实际上没有更改任何一行代码，只是重新创建了任务并从损坏的版本中复制了代码。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2017-10-25T09:04:28.687

也可能是版本不匹配。如果 SSIS 项目设置为面向 SQL Server 2012，但部署到 SQL 2016 实例，则会发生此错误。在项目属性中更改目标版本并重新部署。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-06-08T06:04:22.587

Microsoft 在 SSIS2008R2 和 SSIS2012 之间对 ScriptTasks 进行了重大更改。值得庆幸的是，修复非常简单。只需替换这一行：

? 1 [System.AddIn.AddIn("ScriptMain", Version = "1.0", Publisher = "", Description = "")] 用这个：

? 1 [Microsoft.SqlServer.Dts.Tasks.ScriptTask.SSISScriptTaskEntryPointAttribute] 一切都应该按预期为您工作。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-01-15T15:43:25.273

我有类似的问题，但在我的情况下，目标机器在 GAC 中缺少一个 dll，用于使用 Microsoft Webservices3 进行的一些 SOAP Web 服务调用。一旦我从 Microsoft 下载安装并安装在目标机器上，问题就解决了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-10-29T14:57:40.427

在 Visual Studio 2019 上，我必须重建整个包，而不仅仅是脚本任务。我通过将所有包任务、变量和参数复制并粘贴到一个新的中来做到这一点。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-08-25T13:50:58.727

我发现如果您的 C# 脚本是针对旧版本的 SQL 构建但包含新的 C# 语法（例如三元运算符“？：？？”），也会弹出错误。或字符串插值 $"{varaible}"。

# ruby-on-rails-3.2 - 如何在 arel 中相交两个关联？

> ID：15165768
> 
> 赞同：-1
> 
> 时间：2013-03-01T19:53:56.653
> 
> 标签：ruby-on-rails-3.2, arel

我有一个带有此关联的项目模型，该关联描述了已接受（状态）的团队成员

```
Class Project < ActiveRecord::Base
   has_many :participants, :through => :team_members, :source => :user, :conditions => ['team_members.status = ?', TeamMember::STATUS[:accept]] 
```

我有一个活动模型，其中也有参与者

```
Class Activity < ActiveRecord::Base
  belongs_to :project
  has_many :participants, :through => :collaborations, :source => :user 
```

活动参与者可能包括尚未接受的团队成员。所以，我想要这两个关联的交集。我的目标是做 1 次查询，而不是重复关联的 sql，并采摘一列。我发现这里描述了相交[http://www.rubydoc.info/github/rails/arel/Arel/SelectManager#intersect-instance_method](http://www.rubydoc.info/github/rails/arel/Arel/SelectManager#intersect-instance_method)并试图从[https://github.com/rails/arel/commit/推断它的用法74caeaad157e79853b9c6804f561d3c70eea2346](https://github.com/rails/arel/commit/74caeaad157e79853b9c6804f561d3c70eea2346)。但我没有运气。

到目前为止，我最好的方法是：

```
a = Activity.find(1)
team = a.project.participants.select('user_id').to_sql
peeps = a.participants.where("user_id in (#{team})")
peeps.pluck('thecolumn') 
```

这会执行一次查询（好），不会重复关联的逻辑（好），并且不会加载所有 AR 对象，因为我只是在一个值之后（好）。但是，我希望能够：

```
a = Activity.find(1)
peeps = a.project.particpants.intersect a.project.participants 
```

这可行，但返回一个 Arel::Nodes::Intersect ... 不知道如何从中获取结果。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-28T05:49:24.800

由于 Arel 支持 to_sql 你可以这样做：

```
a = Activity.find(1)
peeps = a.project.particpants.intersect a.project.participants #(sic)
Participant.find_by_sql(["SELECT participants.* FROM #{peeps.to_sql}", ...]) 
```

但我认为您的意思不是与自身相交，而是：

```
a = Activity.find(1)
peeps = a.particpants.intersect a.project.participants
Participant.find_by_sql(["SELECT * FROM #{peeps.to_sql}", ...]) 
```

您需要向查询提供参数。

我也成功地做这样的事情来建立关系

```
PublicActivity::Activity.from("(#{activities.to_sql} UNION #{task_activities.to_sql}) as activities").order("created_at DESC") 
```

# java - Java：间歇性 UnknownHostException

> ID：15165770
> 
> 赞同：5
> 
> 时间：2013-03-01T19:54:06.843
> 
> 标签：java, exception, dns, inetaddress, unknown-host

在我在 Jboss 服务器上运行的应用程序中，我们与另一个应用程序建立了 http 连接。两个应用程序都位于同一个数据中心。我们使用 VIP 连接到应用程序。这在生产中工作得很好，除了当我们得到“java.net.UnknownHostException”时的一小部分。这个百分比非常低（~0.2%），但仍然考虑到我们收到的大量请求，实际数量不容忽视。

错误是间歇性的，在时间和频率方面都没有遵循规律。有时我们一天会收到 200 次，有时我们连续 3-4 天都没有收到。有时我们甚至会在预期的流量较低（晚上 1-3 点）时得到它。

AFAIK，当 DNS 无法解析给定主机名的 IP 时，就会出现这种特殊异常。我们查看了 DNS 设置/配置等，一切看起来都不错。不想直接在属性文件或 /etc/hosts 文件中使用 IP 地址。

在这一点上，我不确定下一步我能做些什么来进一步调试。任何帮助/指导将不胜感激。

```
 Caused by: java.net.UnknownHostException: <VIP Name>
at java.net.Inet4AddressImpl.lookupAllHostAddr(Native Method) ~[?:1.6.0_25]
at java.net.InetAddress$1.lookupAllHostAddr(InetAddress.java:850) ~[?:1.6.0_25]
at java.net.InetAddress.getAddressFromNameService(InetAddress.java:1201) ~[?:1.6.0_25]
at java.net.InetAddress.getAllByName0(InetAddress.java:1154) ~[?:1.6.0_25]
at java.net.InetAddress.getAllByName(InetAddress.java:1084) ~[?:1.6.0_25]
at java.net.InetAddress.getAllByName(InetAddress.java:1020) ~[?:1.6.0_25]
at org.apache.http.impl.conn.DefaultClientConnectionOperator.resolveHostname(DefaultClientConnectionOperator.java:242) ~[httpclient-4.1.2.jar:4.1.2]
at org.apache.http.impl.conn.DefaultClientConnectionOperator.openConnection(DefaultClientConnectionOperator.java:130) ~[httpclient-4.1.2.jar:4.1.2]
at org.apache.http.impl.conn.AbstractPoolEntry.open(AbstractPoolEntry.java:149) ~[httpclient-4.1.2.jar:4.1.2]
at org.apache.http.impl.conn.AbstractPooledConnAdapter.open(AbstractPooledConnAdapter.java:121) ~[httpclient-4.1.2.jar:4.1.2]
at org.apache.http.impl.client.DefaultRequestDirector.tryConnect(DefaultRequestDirector.java:573) ~[httpclient-4.1.2.jar:4.1.2]
at org.apache.http.impl.client.DefaultRequestDirector.execute(DefaultRequestDirector.java:425) ~[httpclient-4.1.2.jar:4.1.2]
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:820) ~[httpclient-4.1.2.jar:4.1.2]
at org.apache.http.impl.client.AbstractHttpClient.execute(AbstractHttpClient.java:754) ~[httpclient-4.1.2.jar:4.1.2]
at org.springframework.http.client.HttpComponentsClientHttpRequest.executeInternal(HttpComponentsClientHttpRequest.java:88) ~[spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
at org.springframework.http.client.AbstractBufferingClientHttpRequest.executeInternal(AbstractBufferingClientHttpRequest.java:46) ~[spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
at org.springframework.http.client.AbstractClientHttpRequest.execute(AbstractClientHttpRequest.java:49) ~[spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
at org.springframework.web.client.RestTemplate.doExecute(RestTemplate.java:438) ~[spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE]
at org.springframework.web.client.RestTemplate.execute(RestTemplate.java:401) ~[spring-web-3.1.1.RELEASE.jar:3.1.1.RELEASE] 
```

# elasticsearch - 防止某些模型在 Rails 应用程序中被 Tyre 索引

> ID：15165780
> 
> 赞同：4
> 
> 时间：2013-03-01T19:54:45.887
> 
> 标签：elasticsearch, tire

我的 Rails 应用程序中有一个可搜索的`Item`模型。

我想索引 ElasticSearch 中的大多数，除了那些满足某些条件的。

我怎样才能做到这一点？

在模型中覆盖`update_index`是可接受的解决方案吗？

* * *

我知道我也可以将它们全部编入索引，并在搜索中过滤掉它们。但是它们永远不会被搜索到，所以我根本看不到索引它们的理由。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-02T08:25:29.160

最简单的事情是自己处理索引挂钩，如[README](https://github.com/karmi/tire)中所述：

> 请注意，您可能希望在特殊情况下跳过包含 Tire::Model::Callbacks 模块，例如当您的记录通过某种外部机制（...）进行索引时，或者当您需要更好地控制文档添加到或从索引中删除：

```
class Article < ActiveRecord::Base
  include Tire::Model::Search

  after_save do
    update_index if state == 'published'
  end
end 
```

# git - Git 与远程 master 同步更改

> ID：15165781
> 
> 赞同：1
> 
> 时间：2013-03-01T19:54:52.173
> 
> 标签：git, merge, rebase

我从另一个位置将一些更改推送到我的远程 Git 主分支，然后在我的本地主存储库上我做了一些更改，编辑了一些文件并删除了其他文件，现在我必须将这些更改与远程存储库的更改合并。当我尝试推送更改时会出现问题：我的提交仍然使用远程分支上已编辑和更新的旧文件。我不明白我应该如何下载远程文件的更改并将它们与我的更改合并

**编辑 1**

这是存储库的历史。6fee6bf 提交是一个修改提交，它将一个新文件添加到之前被推送到远程存储库的提交中

*   aef9a19 (tmp-master) 新提交 2
*   6fee6bf 测试提交
*   48ccbc4 (HEAD, origin/master, master) 测试提交
*   1f466df 旧提交
*   f006d29 旧提交 x2
*   aba1ce0 旧提交 x3
*   04f4a67 旧提交 x4
*   e22f33b 旧提交 x5

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T20:24:27.813

我的意见是确保你已经在当前的 master 上提交了所有内容，然后从那里创建一个新的分支。之后将本地主机硬重置为远程主机。然后要么变基要么选择这些更改。类似于以下内容：

```
git branch tmp-master
git fetch origin
git reset --hard origin/master 
```

现在您可以使用以下内容轻松可视化两个分支之间的差异：

```
git log --decorate=short --oneline --graph --all 
```

挑选其他提交并随时修复冲突可能是最简单的，但您也可以尝试变基。如果您需要更具体的步骤，请告诉我，我会写下来。

更新：

既然你在这里，你可以尝试（从`master`）：

```
git merge tmp-master 
```

但是为了更清晰的提交历史，您可能需要尝试以下操作：

```
git checkout tmp-master
git rebase master
git checkout master
git merge --ff tmp-master
git branch -d tmp-master
git push origin master 
```

这将获取您的本地提交并在远程更改之上重新应用它们。由于您本质上是在做相同的工作，但是来自两台不同的机器，您可能不想要很多“好吧，再次切换机器”合并提交。

现在，可能存在一些可能的冲突。有几种方法可以解决这些问题。如果您有冲突并且知道您的本地更改优先，请执行以下操作（假设来自`tmp-master`分支，并且在 rebase 中存在冲突）：

```
git rebase --abort
git branch tmp-master-save
git rebase -X theirs master 
```

然后检查一切是否正常，从上面的步骤继续`git checkout master`。还记得删除另一个`tmp-master-save`分支。创建它只是为了安全保存。当您对此不熟悉时，最好有一个安全机制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:00:21.677

在推送提交之前，您必须请求获取对存储库的更改，您可以使用 git pull --rebase 命令来完成。它将获得更改并合并它可以安全地做的所有事情。如果发生了一些麻烦，它会告诉你自己纠正冲突，做它并使用 git rebase --continue 继续合并。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:04:01.620

我建议你这样做：

```
git fetch origin

git rebase origin/master master --preserve-merges 
```

第一个命令`fetch`将从远程仓库获取信息到您的本地仓库。它会引入所有更改，但不会自动将它们与您的任何分支的本地副本合并。

rebase 命令将首先返回本地主服务器和远程服务器之间的公共点，对来自远程服务器的所有更改进行快进合并，然后在其上应用您的更改。`--preserve-merges`如果您在分支之间的本地副本中进行了合并，则使用会创建更清晰的历史记录。

# javascript - 是否可以将 Web Worker 与不包含在外部文件中的 JavaScript 一起使用？

> ID：15165785
> 
> 赞同：3
> 
> 时间：2013-03-01T19:55:01.617
> 
> 标签：javascript, multithreading, web-worker

我正在尝试以不需要外部文件作为工作人员代码的方式使用网络工作人员，这是可能的还是已经存在将动态代码传送到网络工作人员的解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T20:02:51.993

你可以这样做，但我不确定它的支持程度如何，而且它不再`BlobBuilder`是`Blob`. 会派上用场：

[https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers#Spawning_subworkers](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers#Spawning_subworkers) [http://www.html5rocks.com/en/tutorials/workers/basics/#toc-enviornment-subworkers](http://www.html5rocks.com/en/tutorials/workers/basics/#toc-enviornment-subworkers) [http://updates .html5rocks.com/2012/06/Don-t-Build-Blobs-Construct-Them](http://updates.html5rocks.com/2012/06/Don-t-Build-Blobs-Construct-Them)

# java - 比较 Joda-Time 时区

> ID：15165788
> 
> 赞同：1
> 
> 时间：2013-03-01T19:55:21.753
> 
> 标签：java, timezone, jodatime

在我使用[Joda-Time](http://www.joda.org/joda-time/)的应用程序中，我需要比较两个时间戳（[DateTime](http://www.joda.org/joda-time/apidocs/org/joda/time/DateTime.html)或[LocalDateTime](http://www.joda.org/joda-time/apidocs/org/joda/time/LocalDateTime.html)）...如果`t1.isBefore(t2)`然后允许用户弹出错误...

说，我有 t1 `2013-03-01T10:17:55.872`（总是美国/东部`-0500`或`-0400`标准偏移）

但是，我的 t2 会根据用户的位置而改变，我可以获得偏移量和时间，比如 t2 as`2013-03-01T14:48:09.000`和 offset of `-0800`。

如何使用'isBefore'比较这两者？

任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T19:58:18.150

好吧，如果您将它们都作为`DateTime`值，则应该可以使用[`isBefore`](http://joda-time.sourceforge.net/api-release/org/joda/time/base/AbstractInstant.html#isBefore%28org.joda.time.ReadableInstant%29),`DateTime`继承自`AbstractInstant`.

但是，我很想`Instant`先将它们转换为普通值（通过`toInstant`）。这样就更清楚你*不关心*本地日期/时间；你*只*对它们所代表的瞬间感兴趣。（我假设这确实是您想要的那种比较。如果您真的想比较本地日期/时间，请将两者都转换为`LocalDateTime`！）

# android - Android Calendar App 的日期选择中使用了哪个控件

> ID：15165789
> 
> 赞同：1
> 
> 时间：2013-03-01T19:55:23.807
> 
> 标签：android, android-controls

我正在尝试模仿 Android 日历应用程序的新事件屏幕的日期选择控件。下图中圈出的那个。![在此处输入图像描述](../Images/0f69c9408e21633a93d0d96b12659790.png)

我已经弹出对话框，但是右下角带有图标的日期的控件是什么？是内置控件吗？如果不是，我该如何完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:02:24.730

它是[Spinner](http://developer.android.com/reference/android/widget/Spinner.html)，自 ICS 以来可作为下拉菜单使用。

参考[here](http://developer.android.com/guide/topics/ui/controls/spinner.html)实现。

# java - 继承，从子类调用方法

> ID：15165790
> 
> 赞同：0
> 
> 时间：2013-03-01T19:55:36.180
> 
> 标签：java

我们今天在我的计算机科学讲座中讨论了继承，并讨论了从其他类访问方法。我的一位同学询问子类如何访问最高父类方法，我的教授也对此感到好奇，并建议如下：

```
super.super.toString(); 
```

也许能够工作，但事实并非如此。出于好奇，我试图自己解决这个问题并想出了这个：

```
public class A {
    public static void main(String[] args){
        B b = new B();
        C c = new C();

        System.out.println(b.toString());
        System.out.println(c.toString());
    }

    public String toString(){
        return "Class A";
    }
}

class B extends A {
    public String toString(){
        return "Class B";
    }
}

class C extends B {
    public String toString(){
        return A.class.toString();
    }
} 
```

成功了，现在在测试各种东西时我偶然发现了这个：（这都将在 C 类中完成）

```
super.toString(); 
```

似乎做同样的事情：

```
B.class.toString(); 
```

我的问题是两者之间有什么区别，还是完全相同？同样在我上面的代码中，这是从子类调用方法的正确方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T19:59:58.477

不，`B.class.toString()`将调用类`toString()`上的方法`Class`。这甚至与 call完全*不同*`super.toString()`。

没有办法调用from`A`的实现，绕过。基本上，这会破坏封装。`toString()``C``A`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-01T20:00:11.067

不，它们不是一回事。假设您是`super.toString()`从您的 class调用，这将`C`调用`toString()`on `B`，这将返回“Class B”。

当您调用`A.class.toString()`或根本不调用任何超类方法时，`B.class.toString()`您正在调用`toString`.`Class`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-01T20:00:41.777

```
class Parent{
   public void foo(){

   }
}

class Child extends Parent{

   @Override
   public void foo(){
       super.foo(); //will call the parent class foo method
   }
}

class ChildOfChild extends Child{

    public void bar(){
        super.foo(); //this actually is the method of the Parent that is actually called at the end as Child calls super.foo();
    }
} 
```

`super.toString();`并且`B.class.toString()`完全不同。在后面，您将调用**类 literal**`toString()`的方法。

 **如示例所示，如果子子类调用层次结构中定义的方法，则取决于实现将调用哪个方法。如果直接父级**覆盖**该方法并且不调用，则无法调用**它**`super.method()`（父级的方法）。这就是继承的工作原理。

 **如果直接父级没有覆盖该方法并且您从子子类调用方法，则将调用直接父级的父级方法。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T20:08:53.980

如果您尝试访问 toString() 中的任何状态，您将很快看到您没有做您认为您正在做的事情。

SomeClass.class 是一个特殊的构造。 有关确切定义，请参见[http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.8.2 。](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.8.2)

您可能不会使用 super.super，因为 Java 实际上旨在强制您正确使用对象和面向对象的模式。不应允许您跳过父类的实现，因此是不允许的。与其他不太严格的语言相比，这实际上是关于 Java 的抱怨之一，但它确实迫使你真正考虑你的类层次结构和你在做什么。****

# java - 如何区分 SocketTimeoutException

> ID：15165794
> 
> 赞同：17
> 
> 时间：2013-03-01T19:55:50.640
> 
> 标签：java, exception

当我抓住它时，我需要以不同的方式处理它`SocketTimeoutException`。我发现唯一的事情就是依赖`getMessage()`. 到目前为止，我发现了两个：

```
java.net.SocketTimeoutException: connect timed out
java.net.SocketTimeoutException: Read timed out 
```

消息（连接超时、读取超时）是硬编码的吗？它们是在哪里生成的？至少这些消息的任何常数值？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:23:18.747

您可以检查 Socket.isConnected。但是由于异常是由不同的方法引发的，所以最好使用两个具有不同操作的 catch 块。

```
 try {
       socket.connect(address);
    } catch (SocketTimeoutException e) {
        throw new SocketConnectionException(e);
    }
    try {
       socket.getInputStream();
       ...
    } catch (SocketTimeoutException e) {
        throw new SocketReadException(e);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T22:16:30.307

它们来自不同的方法。隐式或显式调用 connect() 时会发生“连接超时”；调用 read() 或其同源之一时会发生“读取超时”。所以你可以区分只有两个不同的 catch 块。但无论哪种情况，您都可能要关闭连接...

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T22:27:26.157

所以，这是我声名鹊起的地方。在这里，我们沿着 StackTrace 走，寻找异常的起源方法。

```
public class ExceptionOriginTracing {

    public static void main(String[] args){
        try {
            originOne();
            originTwo();
        } catch (Exception e){
            // Now for the magic:
            for (StackTraceElement element : e.getStackTrace()){
                if (element.getMethodName().equals("originOne")){
                    System.out.println("It's a read error!");
                    break;
                } else if (element.getMethodName().equals("originTwo")){
                    System.out.println("It's a write error!");
                    break;
                }
            }
        }
    }

    public static void originOne() throws Exception{
        throw new Exception("Read Failed...", null);
    }

    public static void originTwo() throws Exception{
        throw new Exception("Connect failed...", null);
    }
} 
```

解析异常给出的*消息*的不同之处在于，一个简单的字符串比实际方法的名称更有可能发生变化。

除此之外，**这不是最佳解决方案！**但遗憾的是，这里没有最佳解决方案。

此外，使用这种方法，**在使用源混淆时必须格外小心**，这将改变方法名称，从而改变 的返回值`getMethodName()`。

* * *

*设计*这样的东西时，正确的方法是将异常包装在一个新的异常中，它提供了通过使用标志或枚举来实际找出真正起源的方法。

解析消息/StackTrace 总是感觉很脏，并且**在未来的版本中会被破坏！**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-11-27T10:19:11.610

回复有点晚。我只有一个布尔标志'isConnected'初始化为false。连接后，我将其设置为true。如果连接超时，您将永远无法到达那里。

在抛出异常后检查 Socket.isConnected 听起来是个坏主意。到那时，套接字可能会被关闭。

通过在 之前定义标志`try`，它可以在`catch`处理程序中读取。

# c# - csharp 中的 foreach 语句中都需要类型和标识符

> ID：15165795
> 
> 赞同：2
> 
> 时间：2013-03-01T19:55:52.063
> 
> 标签：c#, vb.net

我正在为这段代码将 VB.net 转换为 C#：

```
Dim files() As String
files = Directory.GetFiles("E:\\text", "*.txt") 
Dim filename As String
Dim file As String
For Each file In files
filename = Path.GetFileName(file) 
```

我在 C# 中尝试过这个但得到了错误

> csharp 中的 foreach 语句中都需要类型和标识符

```
string[] files;
files = Directory.GetFiles("E:\\text", "*.txt");
string[] filenameMove;
string filename;
string file;

foreach (file  in files)
  filename = Path.GetFileName(file); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T19:57:58.493

尝试

```
foreach(var file in files) 
```

您需要指定循环或使用的类型`var`

您已经声明了一个名为 file 的变量。所以你必须使用不同的名字

```
foreach(var f in files)
{
  filename = Path.GetFileName(f);
} 
```

（尽管您的逻辑只是在每次迭代时覆盖文件名，所以除非您只想要最后一个文件名，否则我不确定它的目的是什么）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:01:40.267

你应该看看**[foreach](http://www.dotnetperls.com/foreach)**语法。

```
 Foreach(Type varName in array)
  {
      filename = Path.GetFileName(varName);
  } 
```

那`Type`和数组应该是相同的`Type`，或者你可以使用`var`这样的变量

```
 Foreach(var varName in array)
  {
      filename = Path.GetFileName(varName);
  } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:02:15.020

这是你缺少 var 和 string

试试这个

```
 foreach (var file  in files)

    foreach (string file  in files) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:04:32.440

```
string[] files;
files = Directory.GetFiles("E:\\text", "*.txt");
string[] filenameMove;
string filename;
//string file;

//foreach (file  in files)
  foreach (string file  in files)
  filename = Path.GetFileName(file); 
```

# function - 错误消息：未定义对“printHeader()”的引用和未定义对“calculateArea(double&)”的引用

> ID：15165798
> 
> 赞同：0
> 
> 时间：2013-03-01T19:55:54.690
> 
> 标签：function, reference, undefined

我编写了这个程序来计算圆的面积，它一直给我这个错误消息：“未定义对'printHeader()的引用和对'calculateArea(double&)'的未定义引用”

我无法弄清楚这意味着什么！我到处都看过，包括这个网站，但大多数答案都超出了我的想象。

程序：

```
#include <iostream>
using namespace std;

// Aquire radius value
// Postcondition: print out header and return radius value
double printHeader();

// Precondition: radius has been entered
// Postcondition: calculate and print out area of the circle
void calculateArea(double& radius);

int main()
{
    double area=0.0, radius=0.0;
    printHeader();
    calculateArea(radius);
    return 0;
}

double printHeader(double& radius)
{
    cout << "Program for calculating the area of a circle" << endl;
    cout << "Enter the radius of the circle: ";
    cin >> radius;
    return radius;
}

void calculateArea(double& radius, double area)
{
    double PI=3.14159;
    area = (PI*radius*radius);
    cout << "The area of the circle is: " << area << endl;
} 
```

我正在使用代码块。非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:01:03.417

这个错误是编译器告诉你你声明了一些没有定义的函数。如果您查看函数原型：

```
// Aquire radius value
// Postcondition: print out header and return radius value
double printHeader();

// Precondition: radius has been entered
// Postcondition: calculate and print out area of the circle
void calculateArea(double& radius); 
```

然后看你后面定义的函数：

```
double printHeader(double& radius) { ... }

void calculateArea(double& radius, double area) { ... } 
```

你可以看到你没有定义你有原型的函数——参数的数量是不同的！编译器根据函数的作用域和参数来识别函数。您需要更新前向声明以在定义中包含参数：

```
double printHeader(double& radius);
void calculateArea(double& radius, double area); 
```

另一种描述方式是函数 double printHeader()*与*函数 double printHeader(double& radius) 不同 - 第一个不带参数，第二个需要双重引用。

# maps - Windows Phone - 持续跟踪和 ReverseGeocodeQuery

> ID：15165808
> 
> 赞同：1
> 
> 时间：2013-03-01T19:56:34.807
> 
> 标签：maps, windows-phone-8, windows-phone

我正在使用新的 Windows Phone 8 地图和地图工具包。在每个`PositionChanged`事件中，我将 设置`UserLocationMarker`为新位置。如果用户点击`UserLocationMarker`，我将通过显示地图位置`ReverseGeocodeQuery`并将用户位置图钉设置为可见。为了快速做到这一点，我`ReverseGeocodeQuery`在`PositionChanged`事件中执行。

我的问题是，如果用户位置变化很快，它会执行很多`ReverseGeocodeQuery`s。这是性能问题吗？

```
private void InitializeGeolocator()
{
    geolocator = new Geolocator();
    geolocator.DesiredAccuracy = PositionAccuracy.High;
    geolocator.MovementThreshold = 5;
    geolocator.StatusChanged += geolocator_StatusChanged;
    geolocator.PositionChanged += geolocator_PositionChanged;
}

private void geolocator_PositionChanged(Geolocator sender, PositionChangedEventArgs args)
{
    Dispatcher.BeginInvoke(() =>
    {
        Geoposition geoposition = args.Position;

        this.UserLocationMarker.GeoCoordinate = geoposition.Coordinate.ToGeoCoordinate();
        this.UserLocationMarker.Visibility = System.Windows.Visibility.Visible;

        // execute ReverseGeocodeQuery...
        // set Pushpin
    });
}

private void userLocationMarker_tap(object sender, GestureEventArgs e)
{
    // show user location pushpin...
    UserLocationPushpin.Visibility = Visibility.Visible;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:42:45.373

如果`ReverseGeocodeQuery`在事件内部调用`PositionChanged`，那么是的，这可能会导致性能问题。

作为一般规则，Windows Phone（和 Windows 8 / WinRT）中的任何异步调用通常意味着它可能不会在固定的时间内返回一个值——它可能需要 50 毫秒，也可能需要 5 秒。

使用`ReverseGeocodeQuery`，它向诺基亚的服务器 (geo.nlp.nokia.com) 发起网络调用以获取地址。尽管在使用 Wifi 或良好的 3G 连接时此呼叫会很快返回，但如果您接收不佳，则不会出现这种情况。

虽然我能理解您要做什么 - 提前查找地址，以便当用户点击 时`UserLocationMarker`，地址会立即出现 - 糟糕的网络质量可能会导致延迟或异常。

我的建议是遵循内置地图应用程序已经使用的方法。也就是说，当用户点击 时`UserLocationMarker`，它会显示一个“正在查找...”标签，然后进行异步地址查找，然后使用地址更新该标签。

另请记住，我们不知道 ReverseGeocodeQuery 是否受速率限制。它似乎没有，但将来可能会改变，因为大多数其他服务都是如此 -[例如 Google 的 Geocoding API](https://developers.google.com/maps/documentation/geocoding/#Limits)。

无论您决定做什么，方便的测试工具都是...

1.  [Fiddler](http://www.fiddler2.com/fiddler2/)（[以及如何在 WP8 模拟器中使用 Fiddler](http://www.spikie.be/blog/post/2013/01/04/Windows-Phone-8-and-Fiddler.aspx)）
2.  [Windows Phone 的模拟仪表板](http://msdn.microsoft.com/en-us/library/windowsphone/develop/jj206953%28v=vs.105%29.aspx)（模拟糟糕的网络条件等）

# java - 音频/FFT 库设计

> ID：15165813
> 
> 赞同：0
> 
> 时间：2013-03-01T19:56:51.703
> 
> 标签：java, android, android-audiorecord

我有一个库，它记录实时音频并计算音频的实时 FFT 数据。客户端必须调用 start 方法开始录制，调用 stop 方法结束录制。

我的设计问题是关于将这些数据返回给客户的最佳方式。我考虑了以下方法：

1.  有一个调用方法`getData(int size)`，客户端将在开始录制后定期调用。它将返回最大大小的音频样本，或尽可能多的数据。我对此的想法是客户端会运行一个`AsyncTask`定期调用更多数据。这种方法的问题在于它的效率要低得多，并且对于客户端来说更复杂，但它确实允许他们更好地控制他们何时以及接收多少数据。
2.  让客户端将输出流传递给我的 start 方法，我一有数据就将其发送到该方法。这更简单但更具限制性。
3.  类似地，不是输出流，而是让客户端传入某种结构，如`ArrayList`，它只会在我们之间共享，我会将数据推送到上面。
4.  最后，我考虑过让我的 start 方法返回`ArrayList`客户端刚刚读取的输出流（或类似的）。

从客户的角度来看，您更喜欢哪一个？为什么？还是有一些我完全忽略的其他选择？任何输入将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:07:15.020

1-通过调用定期检查数据`getData`会使客户端效率低下且更复杂，因此我不建议这样做。

2-使用共享`MemoryStream`是一种可以调查的解决方案

另一种选择，可能更简单，解决方案是简单地将一个`callback`对象传递给您的库，只要有新数据可用即调用该库，即`event-driven`通信

# android - android textview 可点击的单词

> ID：15165814
> 
> 赞同：0
> 
> 时间：2013-03-01T19:56:51.560
> 
> 标签：android, textview

所以我有这个**Activity B**和**textview**。要显示到 textview 中的字符串来自我之前**的 Activity A**（包含多个记录/Passed thru Bundle 的结果查询）

我的问题是如何让每条记录都可以点击？请注意，在我的 Activity B 中，我只有一个 textview 用于**Activity A**中的字符串。我希望每个单词都是可点击的，然后它将进入相应的活动。

**仅供参考，** 这是选定的

![在此处输入图像描述](../Images/76c6b38c166447a76387a9b8900962cd.png)

**更新：**

**结果类**

```
 @Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.symptomsresult);

    result = (TextView) findViewById (R.id.tvSymptomResult);

    Bundle extras = getIntent().getExtras();
       if (extras != null) {
            String value = extras.getString("results");
            result.setText(value);
            }
            else{

            }

} 
```

**症状类**

```
 String[] symptoms = alSymptoms.toArray(new String[alSymptoms.size()]);

        String c = dbHelper.getData(symptoms);

        final int result = 1;
        Bundle extras = new Bundle();
        Intent i = new Intent(this, SymptomsResult.class);
        extras.putString("results", c);
        i.putExtras(extras);
        startActivityForResult(i, result); 
```

**DBHelper.class**

```
 public String getData(String[] symptoms) {
    String where = KEY_SYMPTOMS + "= ?";
    String orStr = " OR "; /* Maybe " AND "? */

    StringBuilder builder = new StringBuilder(where);
    for(int i = 1; i < symptoms.length; i++)
        builder.append(orStr).append(where);

    String search = "";
    Cursor c = myDataBase.query(true, DB_TABLE, new String[] 
            {KEY_CONDITIONS}, builder.toString(), symptoms, null, null, null, null);

    c.moveToFirst();

    while (c.isAfterLast() == false) {
        search += c.getString(0) + ", ";
        c.moveToNext();
    }

    return search;

} 
```

任何帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:12:16.267

您可以将`HTML href`其用作文本的值，然后添加此行以使其显示为网络链接

```
txtView.setMovementMethod(LinkMovementMethod.getInstance()); 
```

您可以通过使用自定义链接来打开您的活动`scheme`

示例代码：

```
txtView.setText(Html.fromHtml(String.format("<a href='%s://%s'>%s</a>", 
                                                           schema,action,text))); 
```

对于单击此链接时要打开的活动，您必须在`manifest`

```
<intent-filter>
    <category android:name="android.intent.category.DEFAULT"/>
    <action android:name="android.intent.action.VIEW" />
    <data
       android:host = "YOUR_ACTION"
       anroid:scheme="YOUR_SCHEME" />
</intent-filter> 
```

这里的技巧是您正在创建自定义 URL，而不是`host`您有一个可以设置为启动不同活动的操作。请注意，`action/host`and`scheme`可以是任意字符串，只要它们与您在创建链接时使用的值匹配即可

因此，当您单击带有此类链接的文本时，它将调用匹配的活动`scheme/host`

我在与您的情况非常相似的情况下使用此解决方案，并且运行良好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:13:58.227

您可以使用[Linkify](https://developer.android.com/reference/android/text/util/Linkify.html)类和[Spannables](https://developer.android.com/reference/android/text/SpannableStringBuilder.html)来做到这一点。但我相信[ListView](https://developer.android.com/reference/android/widget/ListView.html)是一个更好的选择，这些项目更容易点击，因为它们更大，而且这种方法有更多的文档。

您仍然可以使用我编写的代码，`getData()`但不要将光标转换为字符串，而是将光标传递给 SimpleCursorAdapter。

* * *

> 那么如何将它们放在列表视图中？

`getData()`像这样修改：

```
public Cursor getData(String[] symptoms) {
    String where = KEY_SYMPTOMS + "= ?";
    String orStr = " OR "; /* Maybe " AND "? */

    StringBuilder builder = new StringBuilder(where);
    for(int i = 1; i < symptoms.length; i++)
        builder.append(orStr).append(where);

    return myDataBase.query(true, DB_TABLE, new String[] 
            {"rowid as _id", KEY_CONDITIONS}, builder.toString(), symptoms, null, null, null, null);
} 
```

然后将此 Cursor 传递给 CursorAdapter 并将其绑定到 ListView：

```
String[] fromColumns = {DBAdapter.KEY_CONDITIONS};
int[] toViews = {android.R.id.text1}; // The TextView in simple_list_item_1

setListAdapter(new SimpleCursorAdapter(this, 
        android.R.layout.simple_list_item_1, getData(symptoms),
        fromColumns, toViews, 0)); 
```

（我在这里做了一些假设，但这是如何将 Cursor 绑定到 ListActivity。）

# jquery - JQM 等到所有元素都已创建

> ID：15165816
> 
> 赞同：0
> 
> 时间：2013-03-01T19:57:10.847
> 
> 标签：jquery, jquery-mobile

有没有办法`jquery mobile`等到从我的数据库结果中创建了所有元素？

1 -`click()`火灾`$.mobile.changePage("somePage.html");`

2 - 我做了一个 `$("body").on("pageinit", "#id-from-page", function(){ loadMyStuffs(); })`开始安装我的东西`database`

3 -`loadMyStuffs();`使用`append();`来自我的`db result`.

基本上，在这三个步骤中工作，但问题是页面显示在元素创建之前。

那么，我怎样才能`4 step`用类似的东西做一个`showpagenow`？

循环是这样的：

```
for(var i = 1; i <= imgNum; i++ ){
    // stats from step

    var imageList = "<li class='img-steps'>"+
                        "<img class='view-step' src='"+ base_url + "/" + data.result[i].IMGPAT + data.result[i].IMGNAM + "'/>"+
                    "</li>";

    // append to ul list image
    $(".img-ul").append(imageList);
} 
```

任何提示，做我的客人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:33:49.180

事件处理程序仅绑定到当前选定的元素，并且在您的代码调用 .on() 时它们必须存在于页面上。在加载任何其他 HTML 之前，文档元素在文档的头部是可用的，因此在此处附加事件是安全的，而无需等待文档准备好。

尝试使用`$(document).on("pageinit", "#id-of-page", function()`

您可以查看以下示例：

```
<!doctype html>
<html lang="en">
   <head>
        <title>Cars example</title>
        <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.css" />
        <script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.3.0/jquery.mobile-1.3.0.min.js"></script>
        <script>
            $(document).on( "pageinit", "#car-details-page", function( e ) {
                var listItems = '';
                for (var i=0; i<50; i++) {
                    listItems += ["<li><a href=\"#\" id=\"acura\">Acura_",i,"</a></li>"].join("");
                }
                $("#car-list").append(listItems).listview("refresh");
            });
        </script>
    </head>
    <body>
        <div id="car-page" data-role="page">
            <div data-role="header">
                <h1><a data-ajax="false" href="/">Car list</a></h1>
            </div>
            <div data-role="content">   
                <a href="#car-details-page">Go to Page 2</a>
            </div>
        </div>
        <div id="car-details-page" data-role="page">
            <div data-role="header">
                <h1><a data-ajax="false" href="/">Car details</a></h1>
                <a data-rel="back">Back</a>
            </div>
            <div data-role="content">   
                <ul data-role="listview" id="car-list">
                </ul>
            </div>
        </div>
    </body>
</html> 
```

我希望这有帮助。

# jquery - jquery 设置 div 以切换复选框中断单击复选框本身

> ID：15165821
> 
> 赞同：3
> 
> 时间：2013-03-01T19:57:30.673
> 
> 标签：jquery, checkbox, toggle

我有这个复选框：

```
<div class="OuterDiv">
   <div class="InnerDiv">
      <input type="checkbox" name="tie" value="tie">Error in tie score<br>
   </div>
</div> 
```

我有这个 jquery 来切换复选框：

```
$(document).ready(function() {
   $('.OuterDiv').click(function() {
      if ($(this).find('input:checkbox').is(':checked')) { 
         $(this).find('input:checkbox').attr('checked',false);
      } else {
         $(this).find('input:checkbox').attr('checked',true);
      }
   });
}); 
```

这似乎有效，可以在单击 div 时切换复选框。但是，当我单击复选框本身时，没有任何反应，也不会切换。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:00:52.487

没有`<label>`围绕输入（整个`DIV`是可点击的）去：

`**[LIVE DEMO](http://jsbin.com/owewey/18/edit)**`

```
$(document).ready(function() {

   $('.OuterDiv').click(function(e) {
     var $chkb = $(':checkbox', this)[0];
     if(e.target !== $chkb) $chkb.checked = !$chkb.checked; 
   });

}); 
```

**（没有 JS :)**
否则，如果您只希望旁边的文本`checkbox`可点击：
`**[LIVE DEMO](http://jsbin.com/owewey/1/edit)**`

```
<div class="OuterDiv">
   <div class="InnerDiv">
     <label>
      <input type="checkbox" name="tie" value="tie">Error in tie score<br>
     </label>
   </div>
</div> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:05:22.357

您需要使用[event.stopPropagation()停止从您的复选框冒泡的事件的传播](http://api.jquery.com/event.stopPropagation/)

```
$('input[type=checkbox]').click(function(e){
    e.stopPropagation();
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:10:19.883

您不需要为此使用 jQuery。只需使用如下标签标签：

```
<div class="OuterDiv">
    <label>
        <input type="checkbox" name="tie" value="tie">Error in tie score
    </label>
</div> 
```

# jsf - Mojarra 到 MyFaces：EL 表达式上的 NPE

> ID：15165822
> 
> 赞同：0
> 
> 时间：2013-03-01T19:57:32.843
> 
> 标签：jsf, myfaces, mojarra

长话短说，当我注意到单个页面的 ViewState*大小超过 18MB时，我正在尝试在我正在开发的应用程序上迁移到 MyFaces。*我怀疑这是因为我在这个页面上有超过 10 个表单，这是必要的，因为该页面有超过 10 个 ajaxified PrimeFaces 对话框，而 Ajax 对话框需要它们自己的内部表单。ViewState 似乎随着每种形式呈指数增长。我读到 MyFaces 在 ViewState 方面的效率要高得多，因此我正在尝试对我的应用程序进行原型化以分析结果。

我注意到一个特定的用例，它从来不是 Mojarra 的问题：

*   我有一个 PrimeFaces 数据表
*   单击一行上的编辑按钮
*   所选行更新为模型
*   我呈现编辑对话框的表单以显示所选行的托管 bean 值
*   编辑按钮`oncomplete`属性执行显示对话框的脚本。
*   用户提交表单的普通 LOB 数据输入表单
*   坚持到数据库
*   Ajax 使用该记录的新值呈现数据表

MyFaces 的问题似乎是它对 EL 表达式更加挑剔，如果它恰好为 null，则在数据表选定值上抛出 NullPointerException。Mojarra 从未发生过这种情况（无论是对还是错）。例如。

```
<h:form>
<p:dataTable var="bla" selection="#{managedBean.selectedValue}" ...>
  <p:column header="Options">
    <p:commandButton ajax="true" value="Edit" process="@this" update=":editDialogForm"
      oncomplete="editDialogWidget.show()" />
  </p:column>
    ...
</p:dataTable>
</h:form>

....

<p:dialog widgetVar="editDialogWidget" header="Edit stuff" ...>
  <h:form id="editDialogForm">
    <h:inputText value="#{managedBean.selectedValue.someHibernateProperty}" />
    ...
  </h:form>
</p:dialog> 
```

你可以清楚地看到这会导致 NPE，但我想知道是否有一个上下文参数可以在 MyFaces 中使用，以便它在这方面与 EL 表达式表现得像 Mojarra？如果不是，那么这是 Mojarra 的一个错误，它根本不应该起作用？

# clojure - Clojure Cassandra 驱动程序性能

> ID：15165828
> 
> 赞同：3
> 
> 时间：2013-03-01T19:57:55.640
> 
> 标签：clojure, cassandra

我正在 6 节点 Cassandra 集群上测试 Clojure 中 Alia 的性能。即使是多线程，我也只能获得大约 400 次写入/秒。使用 Firebrand Cassandra 驱动程序并在 Java 中手动处理线程，我们能够以 96 个线程获得 5000 次写入/秒。

我在这里使用代理时做错了什么吗？运行它的机器上的 CPU 使用率只有约 25%，看起来真的很低。

更新：根据 Alia 的建议，使用准备好的语句而不是原始语句以同步、单线程方式实现了高达 2500/秒的增益。我仍然需要通过 Clojure 的多线程和单独使用 Alia/底层 Java 驱动程序中内置的异步函数来测试这一点，以查看哪个更快。

更新 2：通过另外利用驱动程序中内置的异步功能，我现在看到了与下面的 mpenet 类似的结果。

```
(ns alia-perf-test.core
  (:gen-class)
  (:require [qbits.alia :as alia]
            [qbits.hayt :as hayt]))

(defn exec-query [session query]
  (alia/execute session (hayt/->raw query)))

(defmacro time-query
  [expr]
  `(let [start# (. System (nanoTime))
         ret# ~expr]
     (/ (double (- (. System (nanoTime)) start#)) 1000000.0)))

(defn write-entity
  [total-time session entity]
  (let [query (hayt/->raw (hayt/insert :entities (hayt/values entity) (hayt/using :timestamp 1234)))
        query-time (time-query (alia/execute session query))]
      (+ total-time query-time)))

(defn generate-entity []
  {:id (str (java.util.UUID/randomUUID)) :num 0})

(defn write-something
  [write-agent session]
  (send-off write-agent write-entity
        session 
        (generate-entity)))

(defn -main [& args]
  (let [cluster (alia/cluster ["server1"
                               "server2" 
                               "server3" 
                               "server4" 
                               "server5" 
                               "server6"]
                              :pooling-options {:core-connections-per-host [:local 16 :remote 16]
                                                :max-connections-per-host  [:local 1000 :remote 1000]
                                                :max-simultaneous-requests-per-connection [:local 32 :remote 32]
                                                :min-simultaneous-requests-per-connection [:local 16 :remote 16]})
        session (alia/connect cluster)]
    (alia/set-consistency! :any)
    (exec-query session (hayt/create-keyspace :aliaperftest
                                              (hayt/with {:replication
                                                          {:class "NetworkTopologyStrategy"
                                                           :dc1 3 :dc2 3}})))
    (exec-query session (hayt/use-keyspace :aliaperftest))
    (exec-query session (hayt/create-table :entities
                                           (hayt/column-definitions {:id :varchar
                                                                     :num :int
                                                                     :primary-key [:id]})))
    (let [num-entities 10000
          write-agent (agent 0)]
      (dotimes [n num-entities]
        (write-something write-agent session))
      (await write-agent)
      (println "Wrote" num-entities "entities in" @write-agent "ms -"
           (* (/ num-entities @write-agent) 1000.0) "ops/sec"))

    (exec-query session (hayt/drop-table :entities))
    (exec-query session (hayt/drop-keyspace :aliaperftest))
    (alia/shutdown session)
    (alia/shutdown cluster)
    (shutdown-agents))) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T22:04:06.867

更新：我已经让它在大约 8 秒内以异步模式（使用 alia 的成功处理程序，具有单个节点）执行 100k 请求，使用原子接收结果并等待所有响应到达。

根据您的设置和批处理，也可以通过使用自定义执行器来从中挤出更多性能，我没有走那么远。见：[https ://github.com/mpenet/alia/blob/master/docs/guide.md#executors](https://github.com/mpenet/alia/blob/master/docs/guide.md#executors)

# node.js - Node.js - 如何在我的本地机器上设置服务器并允许某人访问它（用于测试）

> ID：15165830
> 
> 赞同：5
> 
> 时间：2013-03-01T19:58:00.923
> 
> 标签：node.js, testing

我正在编写一个 node.js 应用程序，需要找一个朋友帮我测试它（在不同的位置）。我可以在我的本地机器上设置一些东西以允许他访问它吗？我试过谷歌搜索，但没有找到什么帮助。

有人可以告诉我怎么做吗？我意识到这对于生产目的来说是一个糟糕的想法，但我只打算将它用于测试，因为这个项目的预算有点紧张。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T20:15:23.937

首先，您应该将节点 http(s) 服务器绑定到您的公共 IP，例如：

```
var http = require("http");
// ...
http.createServer(function(req, res) {
    // ...
}).listen(PORT, null); // passing null or nothing as the second argument, will bind the http server to all interfaces. 
```

接下来，如果您在路由器/防火墙后面，您应该在节点服务器正在侦听的端口上添加到计算机（在本地网络上）的路由。

此外，您应该有一个静态 IP 地址或使用动态 DNS，以便您的朋友能够访问您的计算机。

# javascript - 创建后立即访问元素（没有 setTimeout）

> ID：15165836
> 
> 赞同：2
> 
> 时间：2013-03-01T19:58:42.777
> 
> 标签：javascript, jquery, timeout

*我试图寻找答案，但我的措辞与使用 jQuery`on()`方法寻找事件委托的问题太相似了。因此，请不要对我的问题的措辞感到困惑。*

鉴于我编写 jQuery 应用程序的经验，我实际上问这个问题我感到很惭愧，但我必须承认我实际上并不知道这个问题的答案:-(

考虑一下：

```
// Create the div
$('#wrapper').prepend('<div id="test"></div>');

// Add content to the div, and attach events
// Only execute it once the div has been created though, so wait 20 milliseconds
setTimeout(function(){

    // Add some button
    $('#test').html('<button></button>');

    // Add an event to the button
    // ... after 20 milliseconds
    setTimeout(function(){

        // Attach the click event
        $('#test button').click('dosomething');
    });
},20); 
```

在上面的代码中，我不得不使用`setTimeout`来确保在选择元素并添加内容、事件等之前已经创建了元素......

我的问题很简单，有没有更好的方法来做到这一点？没有超时？

**请注意我不是说，*有没有更好的方法来编写上面的确切代码？*我只是想知道是否有办法避免由于指定的原因使用超时。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:06:56.203

这可能会有所帮助。

```
 var _b = $('<button></button>');
    $('#wrapper').prepend(_b);
    _b.click(function(){
     ///do something
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:02:48.207

假设添加代码时包装器存在于 DOM 上，请尝试：

```
$('#wrapper').on('click', '#test button', doSomething) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:05:58.673

这对我[有用 jsFiddle](http://jsfiddle.net/TxNzw/)

```
var $test = $('<div id="test"></div>');
  , $button = $('<button></button>')
$test.append($button);

$button.click(function() {
  console.log('here');
});

$('#wrapper').prepend($test); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:09:53.683

这就是我将如何在一行中做到这一点：http: [//fiddle.jshell.net/4rT6s/1/](http://fiddle.jshell.net/4rT6s/1/)

```
$(function(){
    $('<button type="button">Click!</button>').click(function(){alert('click');}).appendTo($('<div id="test" />').appendTo('#wrapper'));
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-01T20:15:25.967

我认为您可以通过一些技巧将这些方法链接起来以获取刚刚创建的孩子：

```
$('#wrapper').prepend('<div id="test"></div>').children('#test').html('<button></button>').children('button').click('dosomething'); 
```

它很丑，但它似乎有效，我不确定它是否可以根据您的需要进行扩展

# python - 无法生成我的打印语句 n 次并且我的 if 语句在 python 中工作

> ID：15165838
> 
> 赞同：0
> 
> 时间：2013-03-01T19:58:46.307
> 
> 标签：python, for-loop

```
def game(n):
    #teaches children how to add single digit numbers
    import random
    firstNum=random.randrange(0,10) #1st random number
    secondNum=random.randrange(0,10)#2nd random number
    equation=(firstNum + secondNum)
    print(firstNum, '+', secondNum, '=')
    answer=input('Enter answer: ')
    for i in range(n):
            if equation == answer:
                    print('Correct')
            else:
                    print('Incorrect') 
```

输出：

```
>>> game(3)
7 + 2 =
Enter answer: 9
Incorrect
Incorrect
Incorrect 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T20:00:12.173

您正在将整数与字符串进行比较。转换输入值：

```
if equation == int(answer): 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:01:07.497

你需要把这些东西

```
firstNum=random.randrange(0,10) #1st random number
secondNum=random.randrange(0,10)#2nd random number
equation=(firstNum + secondNum)
print(firstNum, '+', secondNum, '=')
answer=input('Enter answer: ') 
```

进入`for`循环

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T20:02:12.960

向上移动`for`：

```
def game(n):
    #teaches children how to add single digit numbers
    import random
    for i in range(n):
        firstNum=random.randrange(0,10) #1st random number
        secondNum=random.randrange(0,10)#2nd random number
        equation=(firstNum + secondNum)
        print(firstNum, '+', secondNum, '=')
        answer=input('Enter answer: ')

        if equation == answer:
            print('Correct')
        else:
            print('Incorrect') 
```

此外（如果您不在 Python 3 上）您可能希望考虑替换：

```
input('Enter answer: ') 
```

和

```
int(raw_input('Enter answer: ')) 
```

因为：

```
input(...)
    input([prompt]) -> value

    Equivalent to eval(raw_input(prompt)). 
```

因为[eval](http://docs.python.org/2/library/functions.html#eval)可能会执行 Python 代码的随机位。你只是不知道那些孩子这些天会输入什么...... :-)

如果您使用的是 Python 3，`int(input('Enter answer: '))`则除了更改循环之外，您还需要...

# msbuild - 使用构建服务器构建一次可行吗？

> ID：15165839
> 
> 赞同：3
> 
> 时间：2013-03-01T19:58:48.133
> 
> 标签：msbuild, msdeploy

我一直在阅读有关构建一次然后为每个环境进行配置的信息。例如，这里有一些如何做到这一点的想法： [使用 msdeploy 和 Visual Studio 2012 构建一次并部署到多个环境](https://stackoverflow.com/questions/13170493/build-once-and-deploy-to-multiple-environments-with-msdeploy-visual-studio-201)

我的问题是，这如何与您的构建服务器一起使用？有没有人启动过一个部署到多个环境的构建？我希望每个环境都有自己的构建定义和自己的规则/时间表。在那种情况下，构建一次真的可行吗？我觉得我错过了什么……

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-02T04:44:04.107

我使用基于 MSDeploy 和 Web Publishing Pipeline 的构建管道，但这不是 MSBuild 脚本直接支持的方案。

我使用的基本前提是在构建的第一个“阶段”构建一个包，然后部署到各种环境，直到它投入生产。您的构建服务器如何处理交叉构建“工件”是您需要研究的事情。

[另一个问题是当前不支持](https://stackoverflow.com/questions/11683243/deploying-an-existing-package-using-publish-profiles)将包部署到发布配置文件。但是，您始终可以选择从命令行部署包（或者甚至将其上传给可以通过 IIS 导入的管理员）。

这些资源（免责声明包括指向我自己的博客和代码的链接）应该会有所帮助：

*   [GitHub 上的 msdeploy-package-publish](https://github.com/richardszalay/msdeploy-package-publish)
*   [我的“使用 MSDeploy 构建部署管道”博客系列](http://blog.richardszalay.com/tag/deployment-pipeline-series/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-02T18:52:58.153

我一直这样做。为每个环境构建一次并重新配置。我不使用 MSdeploy。我确实使用 xdt 模板化转换，这些转换在部署时与环境属性相结合。构建创建一个可以配置的包。

这消除了在部署时对 Visual Studio 的需求。我可以开始部署到多个环境。我还可以在部署时支持新的/更改的环境。您可以使用 msbuild、ctt 工具[http://ctt.codeplex.com/documentation](http://ctt.codeplex.com/documentation) 和令牌转换过程（例如 msbuild 扩展包中的去令牌化任务）轻松实现此目的。如果您构建此过程，您可以托管在 CI 工具（TFS，但 ID 为 Teamcity）以及手动/cmdline/powershell 中。

# joomla - 在 Joomla 中添加命中计数器

> ID：15165840
> 
> 赞同：0
> 
> 时间：2013-03-01T19:59:06.477
> 
> 标签：joomla, joomla2.5

我正在为 Joomla 2.5 创建一个自定义组件。我想为详细视图添加命中计数器（如 Joomla 内容等）

所以我做了一些研究，发现`JTable::hit`我假设的功能是我需要的（Joomla docs page [here](http://docs.joomla.org/JTable%3a%3ahit/11.1)）。但是，我非常不清楚我需要在哪里实现这一点。当我从数据库中检索行时，它是在模型中的某个地方 - 还是在视图中的某个地方？建议将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:49:52.007

如果您看看他们在 Joomla 中是如何做到的，您会看到他们在模型中实现了功能，并从视图中调用了方法。

例如，`article.php`模型有

```
public function hit($pk = 0)
{
        $hitcount = JRequest::getInt('hitcount', 1);

        if ($hitcount)
        {
            // Initialise variables.
            $pk = (!empty($pk)) ? $pk : (int) $this->getState('article.id');
            $db = $this->getDbo();

            $db->setQuery(
                    'UPDATE #__content' .
                    ' SET hits = hits + 1' .
                    ' WHERE id = '.(int) $pk
            );

            if (!$db->query()) {
                    $this->setError($db->getErrorMsg());
                    return false;
            }
        }

        return true;
} 
```

和

`view.html.php`拥有

```
$model = $this->getModel();
$model->hit(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-10-19T21:28:16.397

您可以使用表类。在 Joomla 3 和 Joomla 4 中工作。

**你的模型**

```
use Joomla\CMS\Table\Table;

public function hit($id = 0)
{
    Table::addIncludePath(JPATH_ADMINISTRATOR . '/components/com_mycomp_name/tables');
    $table = Table::getInstance('my_table_name', 'Table', array());
    $table->hit($id);
    return true;
} 
```

**你的*view.html.php***

```
$model = $this->getModel('model_name');
$model->hit($id); 
```

您可以使用它来增加任何列。为此，您需要覆盖该列。

```
$table->setColumnAlias('hits', 'new_column_name');
$table->hit($id); 
```

# c# - 当使用“使用”时，我们是否有任何情况包含我们处理对象的 catch 块并且什么都不做

> ID：15165849
> 
> 赞同：2
> 
> 时间：2013-03-01T19:59:22.050
> 
> 标签：c#, exception-handling, using

我在学习过程中的某个地方遇到了这部分代码。我在这里发现一个观察结果，即使作者使用“using”块并创建“ts”对象，他在 using 块中使用 try catch 块，在 catch 部分中，他显式调用 Dispose 方法处理对象“ts” . 我觉得没必要。如果他必须“只处理对象”，我不明白为什么他需要在这里尝试并抓住。

我的问题：

1.  我们真的需要 try catch 吗？在什么情况下，它将在此示例中发挥作用？

2.  使用“使用”块时这种方式正确吗？它在 GC 过程中如何反应？它的开销对吗？

欣赏这两个问题是否可以以初学者可以理解的方式解释。

```
using (TransactionScope ts = new TransactionScope(TransactionScopeOption.RequiresNew))
{
    try
    {
        ServiceReference1.Service1Client obj = new ServiceReference1.Service1Client();
        obj.UpdateData();
        ServiceReference2.Service1Client obj1 = new ServiceReference2.Service1Client();
        obj1.UpdateData();
        ts.Complete();
    }
    catch (Exception ex)
    {
        ts.Dispose();
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T20:03:27.987

这对我来说确实似乎没有必要。该`using`语句将编译为`finally`包装整个代码块的块，无论是否引发异常，该块都将执行。

本质上，他正在写这个：

```
TransactionScope ts;
try
{
    ts = new TransactionScope(TransactionScopeOption.RequiresNew);
    try
    {
        ServiceReference1.Service1Client obj = new ServiceReference1.Service1Client();
        obj.UpdateData();
        ServiceReference2.Service1Client obj1 = new ServiceReference2.Service1Client();
        obj1.UpdateData();
        ts.Complete();
    }
    catch (Exception ex)
    {
        ts.Dispose();
    }
}
finally
{
    ts.Dispose();
} 
```

这有点愚蠢。*尤其*愚蠢的是，他完全无视（或“吞下”）例外。99.99999993% 的时间，这是个坏主意。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:02:56.157

在这个特定的代码片段中，catch 子句唯一做的就是防止异常冒泡。实际上，它忽略了异常。

这里的 dispose 方法用于回滚事务，但是由于一旦代码在 using 块之外，无论如何都会调用 dispose ，因此它仍然是不必要的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T20:03:52.850

1.  不，你不需要这里的渔获物。
2.  通过“这种方式”，我假设您不是指此处的 try/catch 块实现的双重处置。是的，这是正确的方法（丢失 try/catch 部分）。

当代码离开代码`using`块时，`ts`这里有问题的对象将被处理掉。您的程序可以在不释放对象的情况下离开此块的唯一方法是：

1.  杀死程序
2.  终止线程

因此，您不需要 try/catch 部分来正确处理对象。

然而， try/catch 代码的*作用*是吞下 try 块中代码中的任何异常。然而， dispose 调用是不必要的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-01T20:03:53.250

据我了解，没有理由`Dispose`打电话。然而，有理由`try` `catch`。例如，如果`UpdateData`呼叫失败，您可能需要进行一些调整，然后重试。您可能还希望以不同的方式处理不同的异常，如果没有 catch 块，您将没有任何机会这样做。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-01T20:04:13.383

无论如何使用“使用”时，都会在 finally 部分隐式调用 ts.Dispose。但是，如果您没有捕获异常，它将被抛出，在您的示例中，异常被 catch 块默默地吞噬。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-01T20:04:22.060

[使用语句](http://msdn.microsoft.com/en-us/library/yh598w02.aspx)

> using 语句可确保调用 Dispose，即使在调用对象上的方法时发生异常也是如此。您可以通过将对象放在 try 块中，然后在 finally 块中调用 Dispose 来获得相同的结果；事实上，这就是编译器翻译 using 语句的方式。

所以是的，在您发布的代码中的异常块中进行处理是不必要的。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-01T20:08:43.867

通过定义的任何对象都`using`必须实现`IDisposable`。该对象`Disposed()`一旦超出范围（意味着控制离开`using`块），无论以何种方式——`return`语句、a `goto`、异常等。因此捕获异常以确保`using`变量被正确处理是多余的。

这段代码：

```
using ( MyDisposableObject x = new MyDisposableObject() )
using ( AnotherDisposableObject y = new AnotherDisposableObject() )
{
  x.Foo() ;
  y.Bar( x ) ;
} 
```

与此代码**完全相同：**

```
MyDisposableObject x = new MyDisposableObject() ;
AnotherDisposableObject y = new AnotherDisposableObject() ;
try
{
  x.Foo() ;
  y.Bar( x ) ;
}
finally
{
  x.Dispose() ;
  y.Dispose() ;
} 
```

但是，有一些原因，您可能希望在`using`块中捕获异常。其中：

*   实际*处理*捕获的异常。
*   记录并重新抛出捕获的异常。
*   例如，故意吞下特定异常以允许执行继续。您可能想要这样做的原因包括，例如，[要求获得权限](http://support.microsoft.com/kb/315529)以查看您是否被允许做某事。如果请求失败，则会引发 SecurityException。捕获允许您采取行动，例如，通知用户他们没有打开他们要求的文件的权限。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-01T20:10:27.690

简短的回答是否定的。TransactionScope 实现了 IDiposable，因此 C# using 语句将在执行代码块后自动调用 Dispose()。

在这种情况下，try/catch 块的用处是可能完成某些类型异常的事务。

在大多数情况下，只需调用 ts.Complete(); 就足够了。作为 using 块中的最后一条语句。这确保了之前抛出的任何异常都会导致事务回滚。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2013-03-01T20:03:44.403

您无需在 using 语句中调用 Dispose。它为您处理。

如果您想在那里处理一些异常，那么在 using 中使用 try catch 没有任何问题，只是不要进行处置。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-01T20:03:44.550

不，那个特别`try..catch`是完全没用的（好吧，无论如何，它*确实会*默默地吃掉你可能遇到的任何异常）。

请注意，这不是等价的，该`using`子句更强大，因为它甚至会调用`Dispose`成功，因为它扩展为 a`try..finally`而不仅仅是 a `try..catch`。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2013-03-01T20:05:14.337

1）如果您要真正处理异常或记录并再次抛出它，您只需要try/catch。try/catch 的任何其他用途都是不好的做法。在这种情况下，你要做的就是 dispose `ts`，所以你不需要它，因为你在一个`using`块内。

2）不，您不需要调用 dispose：即使有异常，使用块也会处理它。

# autohotkey - 我需要中断一个自动热键脚本，然后在不同的位置重新启动它。

> ID：15165856
> 
> 赞同：1
> 
> 时间：2013-03-01T19:59:59.507
> 
> 标签：autohotkey

```
loop, read, c:\storefile.txt
{
store_select := A_index - 1
sleep, 1000
gosub, selectstore
gosub, login
gosub, makeandorrunreport
gosub, Emailreport
getout: ; label pointer for logging out and moving on
gosub, logout
gosub, startprism
}
pause 
```

如果该脚本挂在我的一个子程序中，我想中断该脚本，并使其从我的 getout 标签继续。

类似于暂停切换的东西，一旦暂停结束，我就可以更改线程的执行点。

那可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-09-09T17:45:00.943

您可以使用 try/catch，当捕获到错误时，运行您预先在另一个位置编写的单独脚本，然后终止原始脚本。

**例子：**

```
try  ; Attempts to execute code.
{
    loop, read, c:\storefile.txt
    {
        store_select := A_index - 1
        sleep, 1000
        gosub, selectstore
        gosub, login
        gosub, makeandorrunreport
        gosub, Emailreport
        getout: ; label pointer for logging out and moving on
        gosub, logout
        gosub, startprism
    }
    pause
}
catch e  ; Handles the first error/exception raised by the block above.
{
    Run, Script\from\separate\location.ahk  ; Run script from somewhere else.
    ExitApp ; Kill off the current script.
} 
```

# ms-access - Windows 8 Metro App - 如何通过 OleDb 连接到 MS Access？

> ID：15165859
> 
> 赞同：0
> 
> 时间：2013-03-01T20:00:15.153
> 
> 标签：ms-access, windows-8, microsoft-metro, oledb

谁能告诉如何使用 OleDb 将 Windows 8 商店（地铁）应用程序连接到 MS Access ..？而且我找不到名为“System.Data.OleDb”的参考资料......任何想法......在此先感谢......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:02:39.233

不可能，对不起。但是，您也不能直接连接到 SQL Server。不过，您*可以*使用 SQLLite 文件。太棒了，嗯？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-02T17:39:57.617

尝试将dll文件添加到项目中，

就像我为sqllite添加了dll文件以供sqllite参考和使用。尝试添加dll。

# python - 文件名的 Python 子进程传递参数

> ID：15165862
> 
> 赞同：0
> 
> 时间：2013-03-01T20:00:24.943
> 
> 标签：python, cgi, subprocess

我知道有比 subprocess.Popen 更好的方法来做到这一点，但为了时间，这就是我正在使用的。我有一个名为 save_input.cgi 的脚本，它通过网络应用程序将文件保存到我的 linux 机器上。当它保存文件后，我需要它将该文件名作为参数传递给另一个脚本。这可能是我缺少的一些简单的东西，但这是我到目前为止所拥有的：

```
#!/usr/bin/python
import cgi, os
import cgitb; cgitb.enable()

form = cgi.FieldStorage()

# Get filename here.
fileitem = form['filename']

# Test if the file was uploaded
if fileitem.filename:
  # strip leading path from file name to avoid 
  # directory traversal attacks
  fn = os.path.basename(fileitem.filename.replace("\\", "/" ))
  open('/tmp/' + fn, 'wb').write(fileitem.file.read())

  message = 'The file "' + fn + '" was uploaded successfully'
  subprocess.Popen(["python", "mod_check.py", '/tmp/' + fn])      

else:
   message = 'No file was uploaded'

print """\
Content-Type: text/html\n
<html>
<body>
   <p>%s</p>
</body>
</html>
""" % (message,) 
```

想法？非常感谢，我欠这个社区很多哈哈。

*我只是更新它以在 if fileitem.filename 块中包含子进程，但它似乎没有将文件名和位置作为参数传递给脚本。要回答另一个评论，是的，如果我手动输入“sudo python mod_check.py filename.txt”，这个脚本确实有效

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T21:12:53.573

只是我忽略了一个简单的事情。使用 jordanm 的回复解决。添加到代码块“if fileitem.filename”

# opengl - 使用 GLFW + GLEW 时的 glGenFramebuffers() 访问冲突

> ID：15165863
> 
> 赞同：3
> 
> 时间：2013-03-01T20:00:32.753
> 
> 标签：opengl, framebuffer, glew, fbo, glfw

我收到此错误：

> “访问冲突执行位置 0x00000000。”

当我在 Windows 上使用 GLFW + GLEW 时。

我使用的是 Windows 7。我也有自己的实现（从头开始），它创建一个窗口、初始化 OpenGL 上下文、初始化 GLEW 等……一切正常。所以当然我的视频卡具有帧缓冲区功能，并且驱动程序一切都很好......只有当我尝试使用 GLFW 时才会出现问题。

有什么建议吗？

编码：

```
void start()
{
    if( !glfwInit() )
    {
        glfwTerminate();
        throw exception( "Failed to initialize GLFW" );
    }

    glfwOpenWindowHint( GLFW_FSAA_SAMPLES, 4 );
    glfwOpenWindowHint( GLFW_OPENGL_VERSION_MAJOR, 3 );
    glfwOpenWindowHint( GLFW_OPENGL_VERSION_MINOR, 3 );
    glfwOpenWindowHint( GLFW_OPENGL_PROFILE, GLFW_OPENGL_CORE_PROFILE );

    if( !glfwOpenWindow( m_width, m_height, 0, 0, 0, 0, 32, 0, GLFW_WINDOW ) )
    {
        throw exception( "Failed to open GLFW window." );
        glfwTerminate();
    }

    if ( glewInit() != GLEW_OK )
    {
        throw exception( "Failed to initialize GLEW" );
    }

    // texture
    glGenTextures( 1, &m_texture );
    glBindTexture( GL_TEXTURE_2D, m_texture );

    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR );
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR );
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE );
    glTexParameteri( GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE );

    glTexImage2D( GL_TEXTURE_2D, 0, GL_RGBA8, m_width, m_height, 0, GL_RGBA, GL_UNSIGNED_BYTE, 0);

    // frame buffer
    glGenFramebuffers( 1, &m_frameBuffer ); // IT CRASHES HERE! :-(
    glBindFramebuffer( GL_FRAMEBUFFER, m_frameBuffer );

    glBindTexture( GL_TEXTURE_2D, m_texture );

    ...
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-01T20:45:38.277

GLEW 在使用核心 OpenGL 配置文件时存在已知问题。您可以使用[GLEW 变通方法](http://www.opengl.org/wiki/OpenGL_Loading_Library#GLEW)，也可以放弃 GLEW 用于[*实际工作*](http://www.opengl.org/wiki/OpenGL_Loading_Library)[的扩展加载程序](http://www.opengl.org/wiki/OpenGL_Loading_Library)*。*

 ** * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-02T16:06:45.610

我只是偶然发现了同样的问题。解决方案：在使用 glGenFramebuffers 时使用“glGenFramebuffersEXT”，并且在与帧缓冲区有关的任何其他函数上始终将“EXT”放在它的末尾，它应该可以工作。问题就在这里，存在两个版本的扩展，即 ARB 版本和 EXT 版本，如果你不写“EXT”，你会使用“ARB”版本，它几乎都是一样的，但它是核心配置文件的一部分较新的 gl 版本。所以为了兼容，总是使用函数的“EXT”版本:-)*

# visual-studio-2010 - 将 VC++ 项目从 VS 2008 升级到 VS 2010

> ID：15165871
> 
> 赞同：3
> 
> 时间：2013-03-01T20:01:06.497
> 
> 标签：visual-studio-2010, visual-studio-2008

我正在将一个项目从 VS 2008 升级到 VS 2010。我遇到了以下未解决的链接错误。

**链接：错误 LNK2001：未解析的外部符号 __forceCRTManifestCUR**

在对错误进行了一些网络搜索之后......以下链接确实为我指明了正确的方向。

[http://social.msdn.microsoft.com/Forums/da-DK/vcgeneral/thread/af6796af-a1bf-4904-9923-15101956d882](http://social.msdn.microsoft.com/Forums/da-DK/vcgeneral/thread/af6796af-a1bf-4904-9923-15101956d882)

但添加“int __forceCRTManifestCUR=0;” 这个到主文件对我不起作用。

我发现我原来的 VS 2008 项目属性在 Linker->Command Line 下有额外的 /include:__forceCRTManifestCUR 选项。此选项在 VS 2008 版本中运行良好，但在 VS 2010 中出现链接错误。

去掉这个选项后，我可以在 VS 2010 中正常编译。

我的问题是...

1.  这个包含选项 /include:__forceCRTManifestCUR 有什么作用？和
2.  为什么它在 VS 2010 中不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-28T06:03:25.593

看来你必须写

```
extern "C" int _forceCRTManifestCUR=0 
```

为了让它在 C++ 中工作，原始文章忘记提及这一点。

# caching - 网站缓存今天仍然有用吗？

> ID：15165879
> 
> 赞同：1
> 
> 时间：2013-03-01T20:01:41.603
> 
> 标签：caching, browser-cache

在 2000 年的论文“[数据工程中](http://research.microsoft.com/apps/pubs/default.aspx?id=68636)的经验法则”中，他们提出了以下规则：

> "*缓存网页，如果它们有可能在其生命周期内被重新引用。* "

这在今天仍然适用吗？带宽既便宜又快速，而且网站通常是动态的，因此缓存命中率较低（我猜是这样，对吗？）。缓存网站仍然有意义吗？如果是这样，缓存了什么数据？我可以想象图片或文章，但我的个人推特网站呢？即使是文章，也可能有我想了解的突发新闻，所以缓存中数据的生命周期应该很短。

这个经验法则仍然适用吗？它在实践中是如何使用的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:03:37.630

缓存在今天也非常重要。因此，您的网站反应更快，您的服务器可以处理更多的客户端。

基本上你应该让客户端缓存所有静态的东西，比如 css、js 和图像。如果您需要重新加载文件，您可以添加一个新的查询字符串。

恕我直言是使用过期日期的最大技巧。在文件过期之前，客户端不会请求文件。etag 对于检测动态内容的变化也非常有帮助。

您还应该记住，与 DSL 和 co 相比，移动网络非常慢。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-02T21:22:14.080

正如我们社区的其他成员已经说过的那样，缓存是非常重要的工具，当然，如果您想减少服务器负载和延迟））我只想分享一些我在过去 2 中必须学习的技术- 3周：

**第一件事：**您可以实现返回`Last-Modified`http标头以响应请求`If-Modified-Since` （以及`ETag/If-None-Match`，唯一的区别是Etag在Last-Modified表示日期时表示一些散列值）。你只需要比较`If-Modified-Since`和`Last-Modified`日期，如果页面、图像等是陈旧的，你用`200 OK`状态码返回它。如果图像没有被修改你只返回`304 Not Modified`状态（图像是从你的浏览器缓存中提供的）。
在这种情况下，您应该在客户端（浏览器）上缓存图像。

如果您想减少例如数据库查询的数量，您也可以将它们缓存在服务器上。或者您可以同时使用：ServerAndClient。

**第二件事：**过去两周我一直在努力使用这种方法）
我将`Expires`响应标头设置为永恒（例如 1 年）并在客户端上缓存图像。如果图像已更改，我将构建新的 Url（其中包含散列图像的最后写入日期）。

我创建了一个监视图像文件夹的 Windows 服务，如果图像已更改，它将最后修改日期写入数据库。比我将此图像的最后修改日期添加到 URL。

这种方法的好处是只有在图像发生更改时才会访问服务器。

例如，在第一种描述的方法中，浏览器必须在从它自己的缓存中获取图像之前向服务器发送请求以验证图像是否新鲜。

**第三件事：**不要单独使用`Expires`http 标头（不实现`Last-Modified`or `Etag`），因为如果您缓存例如客户端上的图像，浏览器将从缓存中获取该图像，除非时间到期。因此，如果图像已被修改，除非时间到期，否则用户将看不到它。

希望我在缓存方面的一点经验对您有所帮助:)

**PS**缓存一切可能！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-01T20:06:18.857

缓存与图像、CSS 样式表、Javascript 代码文件等静态数据相关，因为它允许页面在重复点击和子页面上加载得更快。也适用于静态 HTML 页面，但正如您所指出的，许多页面现在是动态的，它们通过 HTTP 标头宣布它们不应该被缓存。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:05:21.047

是的，这很重要...尤其是因为它提供了一种从最近关闭的网站中检索信息的方法

# java - 当我尝试从 IP 不是 192.168.XX 的网络上的服务器接收数据包时，MulticastSocket.receive() 挂起

> ID：15165881
> 
> 赞同：2
> 
> 时间：2013-03-01T20:01:47.383
> 
> 标签：java, windows-7, udp, packet, multicastsocket

我在我的 Windows 7 机器上遇到这个问题，当我尝试在连接到非 192.168.XX 网络的服务器上监听时，Java 中对 MulticastSocket.receive() 的调用将无限期挂起（它永远不会接收数据包） . 只要服务器连接在 192.168.XX 网络上，MulticastSocket.receive() 就不会挂起。我相当确定这是我的 Windows 7 机器上的配置问题，因为它适用于我工作场所运行 Windows XP 和 Ubuntu 10.04 的其他开发系统。

任何帮助，将不胜感激。

**更新：**

我想通了为什么 MulticastSocket.receive() 无限期挂起。发生的事情是 Windows 防火墙阻止了来自与我的服务器对应的网络的传入数据包。对此问题的快速解决方法是禁用该网络上的 Windows 防火墙（在我的情况下，我在公共网络上禁用了 Windows 防火墙）。之后，MulticastSocket.receive() 能够获取传入的数据包。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:13:02.793

“非 192.168.XX 网络”表示监听机器*在*192.168.XX 网络上。如果是这种情况，则可能是多播流量没有在网络之间路由（通常不是）。您提到的其他开发机器是否与 Windows 7 机器在同一网络上？还是它们是双宿主的（连接到两个网段）？

您可以查看您的网络管理员是否可以配置其路由器以传递此流量。

# algorithm - 子集总和 - 找到严格低于 m 且子集大小为 k 的最大总和

> ID：15165883
> 
> 赞同：1
> 
> 时间：2013-03-01T20:01:53.087
> 
> 标签：algorithm, dynamic-programming, subset, knapsack-problem

我正在努力解决以下问题：给定一组 n 个项目，找到大小为 k 的子集的最大总和，该子集严格低于并尽可能接近给定数 m。

我已经解决了这个问题，没有子集的大小必须为 k 的约束，这是我的代码（nums 是我保存我的 n 个数字的数组）：

```
// clear the dp array
int dp[n+1][m+1];
for(int i = 0; i < n+1; i++)
    for(int j = 0; j < m+1; j++)
        dp[i][j] = 0;

for(int j = 1; j <= n; j++)
{
    for(int w = 1; w < m; w++)
    {
        if(nums[j-1] <= w) dp[j][w] = max(dp[j-1][w], nums[j-1] + dp[j-1][w - nums[j-1]]);
        else dp[j][w] = dp[j-1][w];
    }
}
cout << dp[n][m-1]; 
```

但是，我不确定如何扩展我的代码以使用大小为 k 的子集给出答案。我正在考虑在表格中使用另一个维度来跟踪已添加的项目，但我不确定如何实现这一点。我已经搜索过这个站点，但没有找到可以帮助我编写代码的具体答案。

谁能帮我解决这个问题？

提前致谢！

# java - 如何使用 spring-ws 从 Web 服务获取肥皂附件

> ID：15165884
> 
> 赞同：0
> 
> 时间：2013-03-01T20:01:53.433
> 
> 标签：java, web-services, spring, spring-ws

我正在使用 Spring-ws。我正在尝试`WebServiceTemplate.sendSourceAndReceive(src, mySourceExtractor);` 在 的`extractData`回调方法中`SourceExtractor`，我得到一个`DOMSource`. 怎么办？

我知道有一个附件，因为当我使用soapUI 调用服务时，我可以获得附件（pdf 文件）。

有没有更好的办法？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-02T03:34:30.483

使用 ClientInterceptor：

```
public class AttachmentInterceptor implements ClientInterceptor {
Iterator<Attachment> attachments;

@Override
public boolean handleResponse(MessageContext msgCtx) throws WebServiceClientException {
    WebServiceMessage msg = msgCtx.getResponse();
    if (msg instanceof SaajSoapMessage) {
        SaajSoapMessage sm = (SaajSoapMessage) msg;
        attachments = sm.getAttachments();
        return false;
    } else {
        return true;
    }
}

public Iterator<Attachment> getAttachments() {
    return attachments; 
}... 
```

然后将拦截器附加到 WebServiceTemplate 并执行调用：

```
 AttachmentInterceptor ai = new AttachmentInterceptor();
    wst.setInterceptors(new ClientInterceptor [] { ai });
    wst.sendSourceAndReceiveToResult(src, result);

    /**
     * get attachment
     */
    Iterator<Attachment> it = ai.getAttachments(); 
```

然后处理附件。

# apache - Nginx 可以缓存 conf 文件吗？

> ID：15165889
> 
> 赞同：0
> 
> 时间：2013-03-01T20:02:12.583
> 
> 标签：apache, nginx, http-headers

我在 centos vps 上将 Nginx 设置为带有 apache 的前端代理。最近，当我去更改特定网站的配置文件或 nginx.conf 文件本身时，我没有看到任何更改。我已经重新启动了 nginx 和 apache，并清除了 nginx 临时目录。

例如，当我将 gzip_http_version 从 1.1 更改为 1.0 时，我首先注意到了这一点。我检查了我的标题，但没有任何变化。我还可以将随机字符添加到 conf 文件中，一切仍然可以正常工作。

这是一个站点 conf 文件的示例。

```
server {
          error_log /var/log/nginx/vhost-error_log warn;
           listen 204.197.248.70:80;
          server_name www.website.com;
          access_log /usr/local/apache/domlogs/www.website.com-bytes_log bytes_log;
          access_log /usr/local/apache/domlogs/www.website.com combined;
          root /home/www.website.com/public_html;
          location / {
          location ~.*\.(3gp|gif|jpg|jpeg|png|ico|wmv|avi|asf|asx|mpg|mpeg|mp4|pls|mp3|mid|wav|swf|flv|html|htm|txt|js|css|exe|zip|tar|rar|gz|tgz|bz2|uha|7z|doc|docx|xls|xlsx|pdf|iso)$ {
          expires 30d;
    add_header Pragma public;
    add_header Cache-Control "public";
          try_files $uri @backend;
          }
          error_page 405 = @backend;
          add_header X-Cache "HIT from Backend";
          proxy_pass http://1.1.1.1.:8081;
          include proxy.inc;
          }
          location @backend {
          internal;
          proxy_pass http://1.1.1.1:8081;
          include proxy.inc;
          }
          location ~ .*\.(php|jsp|cgi|pl|py)?$ {
          proxy_pass http://1.1.1.1:8081;
          include proxy.inc;
          }
          location ~ /\.ht {
          deny all;
          }
} 
```

这是我的 nginx.conf 文件

```
user  user;
# no need for more workers in the proxy mode
worker_processes  2;
error_log  /var/log/nginx/error.log info;
worker_rlimit_nofile 20480;
events {
 worker_connections 5120; # increase for busier servers
 use epoll; # you should use epoll here for Linux kernels 2.6.x
}
http {
 server_name_in_redirect off;
 server_names_hash_max_size 10240;
 server_names_hash_bucket_size 1024;
 include    mime.types;
 default_type  application/octet-stream;
 server_tokens off;
# remove/commentout disable_symlinks if_not_owner;if you get Permission denied error
# disable_symlinks if_not_owner;
 sendfile off;
 tcp_nopush on;
 tcp_nodelay on;
 keepalive_timeout  5;

 ignore_invalid_headers on;
 client_header_timeout  3m;
 client_body_timeout 3m;
 send_timeout     3m;
 reset_timedout_connection on;
 connection_pool_size  256;
 client_header_buffer_size 256k;
 large_client_header_buffers 4 256k;
 client_max_body_size 200M; 
 client_body_buffer_size 128k;
 request_pool_size  32k;
 output_buffers   4 32k;
 postpone_output  1460;
 proxy_temp_path  /tmp/nginx_proxy/;
 client_body_in_file_only on;
 log_format bytes_log "$msec $bytes_sent .";
 include "/etc/nginx/vhosts/*";
} 
```

如果我需要添加任何其他附加信息，请告诉我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T22:13:15.427

服务器端 nginx 的重新启动应该已经激活了新配置（我假设您更改的配置是有效的，请尝试`nginx -t`检查，如果您使用损坏的配置重新加载 nginx，它将继续使用旧配置运行）

所以我的猜测是问题是由您添加的缓存标头引起的：

```
expires 30d;
add_header Pragma public;
add_header Cache-Control "public"; 
```

你基本上是在告诉你下游的一切，在接下来的 30 天里什么都不会改变......

因此，客户端正在使用其浏览器的缓存（或介于两者之间的任何代理的缓存），而不是重新请求（更改的）页面

您可以通过请求更改页面来检查是否`wget`应该`curl`消除任何代理或浏览器缓存的干扰。

# c++ - 运行时检查失败 #2 - 变量“seqA”周围的堆栈已损坏

> ID：15165896
> 
> 赞同：0
> 
> 时间：2013-03-01T20:02:33.380
> 
> 标签：c++, visual-studio-2010

我有带有 vs2010 的 Windows 8，当我运行这部分程序时，显示此错误：运行时检查失败 #2 - 变量“seqA”周围的堆栈已损坏。..................................................... ......................

```
#include <iostream.h>
#include <stdio.h>
#include <string>
#include<stdlib.h>
#include <fstream>
using namespace std;

    int main(){
int lenA = 0;
int lenB = 0;
FILE * fileA, * fileB;
char holder;
char seqA[10], seqB[10];

/*open first file*/
fileA=fopen("c:\\str1.fa", "r");

/*check to see if it opened okay*/
if(fileA == NULL) {
    perror ("Error opening 'str1.fa'\n");
    exit(EXIT_FAILURE);
}

/*open second file*/
fileB = fopen("c:\\str2.fa", "r");

/*check to see if it opened okay*/
if(fileB == NULL) {
    perror ("Error opening 'str1.fa'\n");
    exit(EXIT_FAILURE);
}

/*measure file1 length*/
while(fgetc(fileA) != EOF) {
    holder = fgetc(fileA);
    seqA[lenA]=holder;
    lenA++;
}
lenA--;

fclose(fileA);

holder='0';

/*measure file2 length*/
while(fgetc(fileB) != EOF) {
    holder = fgetc(fileB);
    seqB[lenB]=holder;
    lenB++;
}
lenB--;

fclose(fileB); 
```

此错误的链接[图片](http://i1353.photobucket.com/albums/q671/mahdimb/ad_zps4ef6d8d6.jpg)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:08:49.317

This:`seqB[lenA]=holder; lenA++;`将溢出，除非您的文件*非常*短（10 个字符或更少（同样使用`seqB`and `lenB`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:08:57.740

您将 seqA 和 SeqB 初始化为 10 个字符。我认为该文件比那个大，并且您通过在序列数组之外写入来破坏堆栈。为序列分配更多内存。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:12:21.910

您读取文件的方法不安全。你有一个 char [10] 的变量，但是如果你的文件有超过 10 个字符会发生什么？您将使用`seqA[10] = holder;`（例如）在内存中写入，顺便说一下您将覆盖堆栈。我认为这就是问题所在。一种解决方案是在读取 10 个字符后中断或使用动态分配的数组并在达到其大小时重新分配它。

# javascript - 以编程方式调用 onclick 属性

> ID：15165897
> 
> 赞同：10
> 
> 时间：2013-03-01T20:02:34.987
> 
> 标签：javascript, jquery, html

我在一个页面上有一堆`<a>`标签，看起来像

```
 <a href="#" id="001" onclick="fnaaa();" >...</a>
  ...
 <a href="#" id="002" onclick="fnaba();" >...</a>
  ...
 <a href="#" id="003" onclick="fncda();" >...</a>

 //sometimes maybe like this
 <a href="#" id="004" onclick="fnagg(); return false;" >...</a>
  ... 
```

现在我将 id 作为查询字符串传递给页面，所以我最初想做类似的事情

```
$('a[id="' + id + '"]').click();
$('a[id="' + id + '"]').trigger("click"); 
```

事实证明这两个都是不允许的，所以如果我有 id ，我怎么能调用写在 onclick 属性中的函数呢？我知道我可能会像这样得到它

```
var funcToCall = $('a[id="' + id + '"]').attr('onclick'); 
```

但是我如何调用这个funcToCall？记住 funcToCall 可能不仅仅是一个函数名 ex。“fnagg（）；返回假；”

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-01T20:05:39.017

首先，ID 属性有[一些限制](https://stackoverflow.com/a/79022/54420)，一个是它必须以字母开头。修复该问题后，我建议*不要*使用内联`onclick`处理程序。

```
$("#ID_HERE").click(function(e) {
  fnaaa();
  e.preventDefault();
}); 
```

然后您可以轻松触发它：

```
$("#ID_HERE").triggerHandler("click"); 
```

但是，如果您绝对**必须**使用丑陋的 onclick，您可以[像这样](http://jsfiddle.net/CfAYm/)调用它：

```
<a id="foo" href="#" onclick="alert('test');">Test</a>
var el = document.getElementById('foo');
el.onclick(); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-01T20:09:30.613

您正在使用`onclick`属性来绑定处理程序。尝试如下，

```
document.getElementById(id).click(); 
```

**演示：http:** [//jsfiddle.net/kpvKG/](http://jsfiddle.net/kpvKG/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:15:56.900

[演示](http://jsfiddle.net/PJDxV/)

```
function fnagg()
{
    alert('fired');
}
$(function(){
    eval("var funcToCall=function(){"+$('#004').attr("onclick")+"}");
funcToCall();
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:33:55.603

我会做这样的事情：

对于 html

```
<a href="#" class="dynamicFuncs" id="my001" data-funcName="myFunc">test</a> 
```

而对于 javascript

```
$(document).ready(function(){
    $(".dynamicFuncs").on('click', function(){
        var theFunc = $(this).attr('data-funcName');
        window[theFunc]();
    })
});

var myFunc = function() {
    alert('me');
}; 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2014-08-27T16:42:25.763

最好使用***addEventListener()***。您可以添加所有类型的事件。例如：“点击”、“鼠标移动”等等。最后的 false 是阻止事件向上遍历 DOM 树。通过将第三个属性设置为 true，事件将继续遍历 DOM 树，这样父元素也将接收到该事件。***这也使得删除事件就像使用removeEventListener()***添加事件一样简单。

**添加事件**

```
element.addEventListener(event, function, useCapture) 
```

**移除事件**

```
element.removeEventListener(event, function, useCapture) 
```

**事件：** 必填。一个字符串，它指定事件的名称。

**功能：** 必填。指定事件发生时要运行的函数。

**useCapture** 可选。一个布尔值，指定事件是在捕获阶段还是在冒泡阶段执行。

**可能的值：**

**true** - 事件处理程序在捕获阶段执行

**假**- 默认。事件处理程序在冒泡阶段执行

此示例不需要 JavaScript 库。这只是普通的旧 JavaScript，并且可以在每个浏览器中运行，不需要额外的东西。

```
 <!DOCTYPE html>
    <html>
    <head>
    <title>exampe</title>
    </head>
    <body>
        <a id="test" href="">test</a>
    <script>
        document.getElementById("test").addEventListener("click", function(){
            alert('hello world');
        }, false);
    </script>
    </body>
    </html> 
```

**您可以通过以下链接了解更多信息：**

*   [https://www.w3schools.com/jsref/met_element_addeventlistener.asp](https://www.w3schools.com/jsref/met_element_addeventlistener.asp)
*   [https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener](https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener)
*   [https://www.geeksforgeeks.org/javascript-addeventlistener-with-examples/](https://www.geeksforgeeks.org/javascript-addeventlistener-with-examples/)
*   [https://www.w3schools.com/jsref/met_element_removeeventlistener.asp](https://www.w3schools.com/jsref/met_element_removeeventlistener.asp)

* * *

如果您想使用 JQuery 方法来处理单击事件，您可以执行以下操作。

**使用 .click()**

```
$("#target").click(function() {
  alert("Handler for .click() called.");
}); 
```

更多信息在这里：[https ://api.jquery.com/click/](https://api.jquery.com/click/)

**使用 .on()**

```
$("#target").on("click", function() {
  console.log($(this).text());
}); 
```

更多信息在这里：[http ://api.jquery.com/on/](http://api.jquery.com/on/)

# r - 如何在 R 中绘制 3D 箭头？

> ID：15165899
> 
> 赞同：6
> 
> 时间：2013-03-01T20:02:41.697
> 
> 标签：r, graphics, vector, 3d

我正在使用 rgl 包来创建我的数据的 3D 图。由于某些原因（3D PCA 双图），我需要向量——带箭头的线段。我被困住了，因为我想用 3D 锥体作为箭头。

不知何故，我无法将我的老态龙钟包裹在问题的几何形状上。说，我会用

```
segments3d( rbind( c( 0, 0, 0 ), c( 3, 3, 3 ) ) ) 
```

即从用户坐标系原点到[3,3,3]的向量。

我想创建一个尖端在 [3,3,3] 的圆锥。圆锥的底部可以形成一个圆形。在 xz 平面（垂直于 y 平面）上画一个半径为 r 的圆很容易：

```
n <- 10
sin.t <- sin( seq( 0, 2 * pi, len= n ) )
cos.t <- cos( seq( 0, 2 * pi, len= n ) )
r <- 0.1 
xv <- x + r * sin.t
yv <- rep( y, n )
zv <- z + r * cos.t 
```

但是我现在如何转换这些点，使圆现在垂直于向量？并且它的中心距离沿向量方向的尖端 0.2？一旦我完成了这个转换，我将使用该`triangles3d`函数绘制三角形，每个三角形在尖端有一个角，在圆的点内有两个顶点。

这是基本的数学，我知道 18 岁的我（甚至 28 岁的我）不会有问题。任何钩子（而不是鱼）将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T20:24:43.873

在 rgl 的演示中有一个 cone3d 函数。它分别采用底座和尖端。无论如何，您都可以执行以下操作：

```
vec=rbind( c( 0, 0, 0 ), c( 3, 3, 3 ) )
segments3d( vec )

cone3d(base=vec[2,]-(vec[1,]+vec[2,]/6), 
     #this makes the head go 1/6th the length of the arrow
       rad=0.5,
       tip=vec[2,],
       col="blue",
       front="lines",
       back="lines") 
```

这是 cone3d 函数：

```
 cone3d <- function(base=c(0,0,0),tip=c(0,0,1),rad=1,n=30,draw.base=TRUE,qmesh=FALSE,
                    trans = par3d("userMatrix"), ...) {
   ax <- tip-base
   if (missing(trans) && !rgl.cur()) trans <- diag(4)
   ### is there a better way?
   if (ax[1]!=0) {
     p1 <- c(-ax[2]/ax[1],1,0)
     p1 <- p1/sqrt(sum(p1^2))
     if (p1[1]!=0) {
       p2 <- c(-p1[2]/p1[1],1,0)
       p2[3] <- -sum(p2*ax)
       p2 <- p2/sqrt(sum(p2^2))
     } else {
       p2 <- c(0,0,1)
     }
   } else if (ax[2]!=0) {
     p1 <- c(0,-ax[3]/ax[2],1)
     p1 <- p1/sqrt(sum(p1^2))
     if (p1[1]!=0) {
       p2 <- c(0,-p1[3]/p1[2],1)
       p2[3] <- -sum(p2*ax)
       p2 <- p2/sqrt(sum(p2^2))
     } else {
       p2 <- c(1,0,0)
     }
   } else {
     p1 <- c(0,1,0); p2 <- c(1,0,0)
   }
   degvec <- seq(0,2*pi,length=n+1)[-1]
   ecoord2 <- function(theta) {
     base+rad*(cos(theta)*p1+sin(theta)*p2)
   }
   i <- rbind(1:n,c(2:n,1),rep(n+1,n))
   v <- cbind(sapply(degvec,ecoord2),tip)
   if (qmesh) 
     ## minor kluge for quads -- draw tip twice
     i <- rbind(i,rep(n+1,n))
   if (draw.base) {
     v <- cbind(v,base)
     i.x <- rbind(c(2:n,1),1:n,rep(n+2,n))
     if (qmesh)  ## add base twice
       i.x <-  rbind(i.x,rep(n+2,n))
     i <- cbind(i,i.x)
   }
   if (qmesh) v <- rbind(v,rep(1,ncol(v))) ## homogeneous
   if (!qmesh)
     triangles3d(v[1,i],v[2,i],v[3,i],...)
   else
     return(rotate3d(qmesh3d(v,i,material=...), matrix=trans))
 } 
```

# image - 带图像的codeigniter锚

> ID：15165900
> 
> 赞同：0
> 
> 时间：2013-03-01T20:02:42.710
> 
> 标签：image, codeigniter, anchor, base-url

我正在尝试使用 codeigniter 锚作为链接，该链接调用一种方法来删除我的数据库中的一行。

```
<?php echo anchor("masterdata/delete_customer/$row->id",$row->customer_name) ?> 
```

这很好用，但我想用图像替换文本。就像是：

```
<?php echo anchor('masterdata/delete_customer/$row->id',img(array('src'=>'images/delete_icon.png','border'=>'0','alt'=>'Delete'))); ?> 
```

上面的语法会产生错误：

```
The URI you submitted has disallowed characters. 
```

另外，是否可以将masterdata控制器路径替换为base_url路径？baseurl/masterdata/delete_customer...

非常感谢一如既往，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T21:42:19.913

您的示例代码中的问题是第二个示例在第一个参数周围使用单引号，其中包含 php 变量。它应该是：

```
<?php echo anchor('masterdata/delete_customer/'.$row->id, img(array('src'=>'images/delete_icon.png','border'=>'0','alt'=>'Delete'))); ?> 
```

或者换成双引号。

# javascript - my javascript variables wont add correctly

> ID：15165906
> 
> 赞同：0
> 
> 时间：2013-03-01T20:03:03.573
> 
> 标签：javascript, jquery

im having a problem adding these variables lets say 'pce'=100 and 'epbcac'=200 my result is 100200 instead of 300 what am i doing wrong thanks,

```
var pce = $('#pce').val();
var epbcac=$('#epbcac').val();

var results12 = pce + epbcac;

$('#tc').val(results12); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-01T20:03:40.743

You are adding strings. You need to make them ints [`parseInt(string, radix)`](http://www.w3schools.com/jsref/jsref_parseint.asp).

```
var results12 = parseInt(pce,10) + parseInt(epbcac,10); 
```

As @Joe mentioned `radix` is optional, but if you dont specify it the browser could use a different radix and could cause unpredictable behavior.

* * *

Alternatively, as @DavidMcMullin suggested a Savvier way to do it is to use the [`unary +`](https://stackoverflow.com/questions/9081880/what-is-unary-used-for-in-javascript) operator:

```
var results12  = +pce + + epbcac 
```

* * *

[Radix](http://en.wikipedia.org/wiki/Radix) is the base of the number system. Meaning the numbers that make up the system:

**Binary: radix=2**
01010101

**Decimal: radix=10**
0123456789

**Hex: radix=16**
0123456789ABCDEF

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:04:07.953

Use `parseInt(pce);` and `parseInt(epbcac);` before summing it up.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:07:52.813

As others said, use `parseInt`, but ideally use

```
parseInt(pce,10) + parseInt(epbcac,10) 
```

otherwise strings with leading zeros in the form "012" will be parsed incorrectly as hex digits and the addition won't work correctly.

# facebook - 为什么我的 Facebook 开发者页面顶部没有出现 +Add App 按钮？

> ID：15165911
> 
> 赞同：0
> 
> 时间：2013-03-01T20:03:27.373
> 
> 标签：facebook

我以自己的身份登录，而不是以公司身份登录。我之前注册为开发人员并使用我的手机号码进行了验证。在 www.facebook.com/developers 主页上看不到 +ADD APP 按钮。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T21:29:46.797

这似乎是更改的效果或合法错误。要解决问题，请尝试以下操作：

1.  访问[https://developers.facebook.com/apps](https://developers.facebook.com/apps)。如果您看到“立即注册”链接，请单击它以完成 Facebook 开发者注册流程。

2.  如果注册成为 Facebook 开发者后“创建新应用”仍未出现，请访问[https://developers.facebook.com/setup](https://developers.facebook.com/setup)以创建新应用。

3.  有时，使用设置链接创建应用程序在填写弹出窗口请求的信息后不会显示应用程序。如果是这种情况，您可以通过访问 /apps 页面查看和编辑您的 Facebook 应用程序设置。

# kml - 如何让谷歌地球在大型 kml 文件中显示所有地标

> ID：15165928
> 
> 赞同：4
> 
> 时间：2013-03-01T20:04:01.077
> 
> 标签：kml, google-earth

我创建了一个可以在 google earth 中播放的 kml 文件。在播放过程中，地标在文件播放完成之前停止出现。它是每 0.1 秒 8 小时内移动车辆的地标，最高可达 294,000。有没有办法让谷歌地球在这样的大文件中显示所有地点标记？

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T21:29:51.637

您最多可以同时显示 294K 地标，但如此大的 KML 文件通常会导致性能问题，有时还会导致呈现问题。

在[测试 KML 生成器](http://kml4earth.appspot.com/bigKml.html)中，加载具有 500K 地标的单个 KML 文件时存在严重问题。具有 100K 地标的类似测试有很长的启动延迟（约 2 分钟），但之后运行顺利。这些数字提供了单个 KML 文件中要素限制的粗略顺序。

建议将地标分解为 1 小时的块，然后使用[网络链接](https://developers.google.com/kml/documentation/kmlreference#networklink)创建一个父 KML 文件来加载所有块。每个 NetworkLink 都应该有一个针对其各自时间段的[TimeSpan 。](https://developers.google.com/kml/documentation/kmlreference#timespan)然后只有处于活动状态的段将被加载和显示。如果性能仍然是一个问题，那么可以分成更小的块。

根 KML 看起来像这样：

```
<kml xmlns="http://www.opengis.net/kml/2.2">
<Document>
    <name>Parent Document</name>
    <open>1</open>

    <NetworkLink>
      <name>Group #1</name>
      <TimeSpan>
            <begin>2012-08-12T01:00:00Z</begin>
            <end>2012-08-12T01:59:59Z</end>
      </TimeSpan>
      <Link>
        <href>group_0100.kml</href>
      </Link>
    </NetworkLink>

    <NetworkLink>
      <name>Group #2</name>
      <TimeSpan>
            <begin>2012-08-12T02:00:00Z</begin>
            <end>2012-08-12T02:59:59Z</end>
      </TimeSpan>
      <Link>
        <href>group_0200.kml</href>
      </Link>
    </NetworkLink>
    ...
</Document>
</kml> 
```

# c# - 编码问题和 POST 数据

> ID：15165930
> 
> 赞同：0
> 
> 时间：2013-03-01T20:04:02.923
> 
> 标签：c#

我的应用程序中有一个文本框，文本框中的文本通过 POST 请求作为发布数据发送。如果我在文本中包含任何符号，例如 £ 或 $，它会将它们转换为问号。

我需要做任何编码来阻止这种情况的发生吗

**编辑**我无权访问另一端的服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:11:37.527

我一直在试验 .NET 为 URL 编码提供的各种方法。也许下表会有用：

```
Unencoded UrlEncoded UrlEncodedUnicode UrlPathEncoded EscapedDataString EscapedUriString HtmlEncode HtmlAttributeEncode HexEscape
A         A          A                 A              A                 A                A          A                   %41
B         B          B                 B              B                 B                B          B                   %42
C         C          C                 C              C                 C                C          C                   %43
D         D          D                 D              D                 D                D          D                   %44

a         a          a                 a              a                 a                a          a                   %61
b         b          b                 b              b                 b                b          b                   %62
c         c          c                 c              c                 c                c          c                   %63
d         d          d                 d              d                 d                d          d                   %64

0         0          0                 0              0                 0                0          0                   %30
1         1          1                 1              1                 1                1          1                   %31
2         2          2                 2              2                 2                2          2                   %32
3         3          3                 3              3                 3                3          3                   %33

[space]   +          +                 %20            %20               %20              [space]    [space]             %20
!         !          !                 !              !                 !                !          !                   %21
"         %22        %22               "              %22               %22              &quot;     &quot;              %22
#         %23        %23               #              %23               #                #          #                   %23
$         %24        %24               $              %24               $                $          $                   %24
%         %25        %25               %              %25               %25              %          %                   %25
&         %26        %26               &              %26               &                &amp;      &amp;               %26
'         %27        %27               '              '                 '                &#39;      &#39;               %27
(         (          (                 (              (                 (                (          (                   %28
)         )          )                 )              )                 )                )          )                   %29
*         *          *                 *              *                 *                *          *                   %2A
+         %2b        %2b               +              %2B               +                +          +                   %2B
,         %2c        %2c               ,              %2C               ,                ,          ,                   %2C
-         -          -                 -              -                 -                -          -                   %2D
.         .          .                 .              .                 .                .          .                   %2E
/         %2f        %2f               /              %2F               /                /          /                   %2F
:         %3a        %3a               :              %3A               :                :          :                   %3A
;         %3b        %3b               ;              %3B               ;                ;          ;                   %3B
<         %3c        %3c               <              %3C               %3C              &lt;       &lt;                %3C
>         %3e        %3e               >              %3E               %3E              &gt;       >                   %3E
=         %3d        %3d               =              %3D               =                =          =                   %3D
?         %3f        %3f               ?              %3F               ?                ?          ?                   %3F
@         %40        %40               @              %40               @                @          @                   %40
[         %5b        %5b               [              %5B               %5B              [          [                   %5B
]         %5d        %5d               ]              %5D               %5D              ]          ]                   %5D
\         %5c        %5c               \              %5C               %5C              \          \                   %5C
^         %5e        %5e               ^              %5E               %5E              ^          ^                   %5E
_         _          _                 _              _                 _                _          _                   %5F
`         %60        %60               `              %60               %60              `          `                   %60
{         %7b        %7b               {              %7B               %7B              {          {                   %7B
}         %7d        %7d               }              %7D               %7D              }          }                   %7D
|         %7c        %7c               |              %7C               %7C              |          |                   %7C
~         %7e        %7e               ~              ~                 ~                ~          ~                   %7E

Ā         %c4%80     %u0100            %c4%80         %C4%80            %C4%80           Ā          Ā                   [OoR]
ā         %c4%81     %u0101            %c4%81         %C4%81            %C4%81           ā          ā                   [OoR]
Ē         %c4%92     %u0112            %c4%92         %C4%92            %C4%92           Ē          Ē                   [OoR]
ē         %c4%93     %u0113            %c4%93         %C4%93            %C4%93           ē          ē                   [OoR]
Ī         %c4%aa     %u012a            %c4%aa         %C4%AA            %C4%AA           Ī          Ī                   [OoR]
ī         %c4%ab     %u012b            %c4%ab         %C4%AB            %C4%AB           ī          ī                   [OoR]
Ō         %c5%8c     %u014c            %c5%8c         %C5%8C            %C5%8C           Ō          Ō                   [OoR]
ō         %c5%8d     %u014d            %c5%8d         %C5%8D            %C5%8D           ō          ō                   [OoR]
Ū         %c5%aa     %u016a            %c5%aa         %C5%AA            %C5%AA           Ū          Ū                   [OoR]
ū         %c5%ab     %u016b            %c5%ab         %C5%AB            %C5%AB           ū          ū                   [OoR] 
```

这些列表示编码如下：

UrlEncoded：HttpUtility.UrlEncode

UrlEncodedUnicode：HttpUtility.UrlEncodeUnicode

UrlPathEncoded：HttpUtility.UrlPathEncode

转义数据字符串：Uri.EscapeDataString

EscapedUriString: Uri.EscapeUriString

HtmlEncode：HttpUtility.HtmlEncode

HtmlAttributeEncode：HttpUtility.HtmlAttributeEncode

HexEscape：Uri.HexEscape

**笔记：**

1.  HexEscape 只能处理前 255 个字符。因此，它会为拉丁 A 扩展字符（例如 Ā）抛出 ArgumentOutOfRange 异常。

2.  我表中的字符没有完全按照 ASCII/Unicode 升序排列（例如 [、]、\ 是乱序的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:07:51.127

您可能想查看使用 C#将这些字符转换为可发布数据的 URLEncode [URL Encoding](https://stackoverflow.com/questions/575440/url-encoding-using-c-sharp)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:08:37.507

尝试将`<meta charset='utf-8'>`或添加`<meta http-equiv='Content-Type' content='text/html; charset=utf-8'>`到您的页面标签。

还要检查您网站的 web.config 以查看那里设置了哪些全球化设置。明确设置为 utf-8 可能会有所帮助。
参考：http: [//msdn.microsoft.com/en-us/library/39d1w2xf.aspx](http://msdn.microsoft.com/en-us/library/39d1w2xf.aspx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:09:20.223

基本的 http url 编码会将你的 $ 换成 %24，但这听起来不像是这里的问题。您可能想要使用 URLEncode，然后在另一端对其进行解码。或者，如果您将其作为有效负载的一部分发送，您可能需要指定您正在使用的字符编码（一方面是使用 ASCII，另一个是 UTF-8 或类似的东西，你会得到垃圾作为结果）。

# c# - 将属性列表动态转换为对象

> ID：15165936
> 
> 赞同：0
> 
> 时间：2013-03-01T20:04:12.823
> 
> 标签：c#, asp.net-mvc, custom-attributes

我正在设计一种在 C# MVC(4) 应用程序中声明路由的自动化方式的原型，因此我决定为控制器的方法使用自定义属性：

```
[RouteUrl("foo/{param}")]
[RouteConstraint("param", "[a-z]+[0-9]+")]
public ActionResult MyAction(string param)
{
    return View();
} 
```

自定义属性允许我单独收集信息，然后我可以将这对参数/约束存储在字典中。

问题是`new Route(string url, RouteValueDictionary defaults, RouteValueDictionary constraints, ...)`在 RouteCollection.MapRoute() 中调用的，仅作为参数`RouteValueDictionary(IDictionary<string,object>)`或`RouteValueDictionary(object)`默认值和约束。

所以我不知道如何将这对值转换为一个对象（或一个 RouteValueDictionary）。

是否可以将 Dictionary 转换为 PHP 中的对象？

```
(object)array("prop1" => "value1", "prop2" => "value2", ...) 
```

也许我应该采取不同的方法，知道吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T21:35:29.287

嗯，我刚刚意识到这`Dictionary<string, object>`是兼容的，`Dictionary<string, string>`所以我可以做我想做的所有事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-02T04:31:39.483

具有 C# 4.0 的一些动态特性

```
Dictionary<string, object> dic = new Dictionary<string,object>() {

    { "LastName", "Doe"  },
    { "FirstName", "Joe" },
    { "Age", 35 }
};

dynamic o = new System.Dynamic.ExpandoObject();

foreach(var e in dic)
{
    var oo = o as IDictionary<String, object>;
    oo[e.Key] = e.Value;
}

foreach(var a in o)
{
    Console.WriteLine("{0}={1}", a.Key, (o as IDictionary<String, object>)[a.Key]);
} 
```

另请查看github 上提供的[DynamicSugar.net](http://www.jyos.net/dynamicSugar.net/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T21:52:05.823

像这样的东西））

```
public abstract class DynamicClass
    {
        public override string ToString()
        {
            PropertyInfo[] props = this.GetType().GetProperties(BindingFlags.Instance | BindingFlags.Public);
            StringBuilder sb = new StringBuilder();
            sb.Append("{");
            for (int i = 0; i < props.Length; i++)
            {
                if (i > 0) sb.Append(", ");
                sb.Append(props[i].Name);
                sb.Append("=");
                sb.Append(props[i].GetValue(this, null));
            }
            sb.Append("}");
            return sb.ToString();
        }
    }

    //DynamicTypeFactory
    public static class ExpressionHelper //simplified
    {

        private const string DYNAMIC_ASSEMBLY_NAME = "DynamicAssembly";
        private const string DYNAMIC_MODULE_NAME = "DynamicModule";
        private const string DYNAMIC_CLASS_PREFIX = "DynamicClass";
        private static ModuleBuilder _moduleBuilder;

        [SecurityCritical]
        static ExpressionHelper()
        {
            //var assemblyName = new AssemblyName(DYNAMIC_ASSEMBLY_NAME);

            AssemblyBuilder assembly = Thread.GetDomain().DefineDynamicAssembly(new AssemblyName(DYNAMIC_ASSEMBLY_NAME), AssemblyBuilderAccess.Run);
            assembly.GetName().SetPublicKey(Assembly.GetExecutingAssembly().GetName().GetPublicKey());
            assembly.GetName().SetPublicKeyToken(Assembly.GetExecutingAssembly().GetName().GetPublicKeyToken());
            _moduleBuilder = assembly.DefineDynamicModule(DYNAMIC_MODULE_NAME, true);

        }

        public static Type CreateType(IDictionary<string, Type> propertyTypes)
        {
            var typeName = DYNAMIC_CLASS_PREFIX + propertyTypes.GetHashCode().ToString();
            TypeBuilder typeBuilder = _moduleBuilder.DefineType(typeName, TypeAttributes.Class | TypeAttributes.Public, typeof(DynamicClass));
            FieldInfo[] fields = GenerateProperties(typeBuilder, propertyTypes);
            GenerateEquals(typeBuilder, fields);
            GenerateGetHashCode(typeBuilder, fields);
            Type result = typeBuilder.CreateType();
            return result;
        }

        public static object CreateObject(IDictionary<string, object> propertyValues)
        {
            var propertyTypes = propertyValues.ToDictionary(pair => pair.Key, pair => pair.Value == null ? typeof(object) : pair.Value.GetType());
            var type = CreateType(propertyTypes);

            Expression targetExpression = Expression.New(type.GetConstructors()[0]); 

            var lambda = Expression.Lambda(targetExpression);
            var target = lambda.Compile().DynamicInvoke();

            List<MemberBinding> bindings = new List<MemberBinding>();

            foreach (var pair in propertyValues)
            {
                bindings.Add(Expression.Bind(type.GetProperty(pair.Key), Expression.Constant(pair.Value)));
            }
            return Expression.Lambda(Expression.MemberInit(Expression.New(type), bindings.ToArray())).Compile().DynamicInvoke();
        }

        private static FieldInfo[] GenerateProperties(TypeBuilder typeBuilder, IDictionary<string, Type> propertyTypes)
        {
            FieldInfo[] fields = new FieldBuilder[propertyTypes.Count];
            for (int i = 0; i < propertyTypes.Count; i++)
            {
                var dp = propertyTypes.ElementAt(i);

                var fb = typeBuilder.DefineField("<" + dp.Key + ">k__BackingField", dp.Value, FieldAttributes.Private); //HasDefault?
                var pb = typeBuilder.DefineProperty(dp.Key, PropertyAttributes.HasDefault, dp.Value, null);

                var mbGet = typeBuilder.DefineMethod("get_" + dp.Key,
                    MethodAttributes.Public | MethodAttributes.SpecialName | MethodAttributes.HideBySig, 
                    dp.Value, Type.EmptyTypes);

                var getterGenerator = mbGet.GetILGenerator();
                getterGenerator.Emit(OpCodes.Ldarg_0);
                getterGenerator.Emit(OpCodes.Ldfld, fb);
                getterGenerator.Emit(OpCodes.Ret);
                //setterBuilder
                MethodBuilder mbSet = typeBuilder.DefineMethod("set_" + dp.Key,
                    MethodAttributes.Public | MethodAttributes.SpecialName | MethodAttributes.HideBySig, 
                    null, new Type[] { dp.Value });
                //setterILGenerator
                var setterGenerator = mbSet.GetILGenerator();
                setterGenerator.Emit(OpCodes.Ldarg_0);
                setterGenerator.Emit(OpCodes.Ldarg_1);
                setterGenerator.Emit(OpCodes.Stfld, fb);
                setterGenerator.Emit(OpCodes.Ret);
                pb.SetGetMethod(mbGet);
                pb.SetSetMethod(mbSet);
                fields[i] = fb;
            }
            return fields;
        }

        private static void GenerateEquals(TypeBuilder typeBuilder, FieldInfo[] fields)
        {
            var mb = typeBuilder.DefineMethod("Equals",
                MethodAttributes.Public | MethodAttributes.ReuseSlot |
                MethodAttributes.Virtual | MethodAttributes.HideBySig,
                typeof(bool), new Type[] { typeof(object) });
            var generator = mb.GetILGenerator();
            var other = generator.DeclareLocal(typeBuilder);
            var next = generator.DefineLabel();
            generator.Emit(OpCodes.Ldarg_1);
            generator.Emit(OpCodes.Isinst, typeBuilder);
            generator.Emit(OpCodes.Stloc, other);
            generator.Emit(OpCodes.Ldloc, other);
            generator.Emit(OpCodes.Brtrue_S, next);
            generator.Emit(OpCodes.Ldc_I4_0);
            generator.Emit(OpCodes.Ret);
            generator.MarkLabel(next);
            foreach (var field in fields)
            {
                var ft = field.FieldType;
                var ct = typeof(EqualityComparer<>).MakeGenericType(ft);
                next = generator.DefineLabel();
                generator.EmitCall(OpCodes.Call, ct.GetMethod("get_Default"), null);
                generator.Emit(OpCodes.Ldarg_0);
                generator.Emit(OpCodes.Ldfld, field);
                generator.Emit(OpCodes.Ldloc, other);
                generator.Emit(OpCodes.Ldfld, field);
                generator.EmitCall(OpCodes.Callvirt, ct.GetMethod("Equals", new Type[] { ft, ft }), null);
                generator.Emit(OpCodes.Brtrue_S, next);
                generator.Emit(OpCodes.Ldc_I4_0);
                generator.Emit(OpCodes.Ret);
                generator.MarkLabel(next);
            }
            generator.Emit(OpCodes.Ldc_I4_1);
            generator.Emit(OpCodes.Ret);
        }

        private static void GenerateGetHashCode(TypeBuilder typeBuilder, FieldInfo[] fields)
        {
            var mb = typeBuilder.DefineMethod("GetHashCode",
                MethodAttributes.Public | MethodAttributes.ReuseSlot |
                MethodAttributes.Virtual | MethodAttributes.HideBySig,
                typeof(int), Type.EmptyTypes);
            var generator = mb.GetILGenerator();
            generator.Emit(OpCodes.Ldc_I4_0);
            foreach (FieldInfo field in fields)
            {
                var ft = field.FieldType;
                var ct = typeof(EqualityComparer<>).MakeGenericType(ft);
                generator.EmitCall(OpCodes.Call, ct.GetMethod("get_Default"), null);
                generator.Emit(OpCodes.Ldarg_0);
                generator.Emit(OpCodes.Ldfld, field);
                generator.EmitCall(OpCodes.Callvirt, ct.GetMethod("GetHashCode", new Type[] { ft }), null);
                generator.Emit(OpCodes.Xor);
            }
            generator.Emit(OpCodes.Ret);
        }
    } 
```

使用：

```
var obj = ExpressionHelper.CreateObject(new Dictionary<string, object>()
                                            {
                                                {"testInt32Property", int.MaxValue},
                                                {"testStringProperty", "TestString"}
                                            }); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-01T20:09:29.730

*你在找这个吗？*

```
(object) new { prop1 = "value1", prop2 = "value2", ...} 
```

# asp.net - 在引用自己的服务的 Web 应用程序中找不到默认端点元素错误

> ID：15165937
> 
> 赞同：0
> 
> 时间：2013-03-01T20:04:17.003
> 
> 标签：asp.net, wcf, configuration, endpoint, service-reference

我已经使用 ASP.NET 4 创建了一个 WCF 服务，并试图*在我自己的 Web 应用程序项目*中连接到它，这给了我“找不到默认端点元素”错误。

这个类似问题的答案似乎都对我没有帮助，因为它们似乎都在处理一个引用该服务并且缺少配置文件的外部项目。

该服务在直接使用其方法时起作用（例如：JS 调用）。

有任何想法吗？请在下面查看我的 serviceModel 部分：

```
<system.serviceModel>
  <behaviors>
    <serviceBehaviors>
      <behavior name="metadataBehavior">
        <serviceMetadata httpGetEnabled = "true"/>
      </behavior>
    </serviceBehaviors>
    <endpointBehaviors>
      <behavior name="webHttpBehavior">
        <webHttp />
      </behavior>
    </endpointBehaviors>
  </behaviors>
  <bindings>
    <webHttpBinding>
      <binding name="webHttpBindingWithJsonP" crossDomainScriptAccessEnabled="true" />
    </webHttpBinding>
  </bindings>
  <services>
    <service name="MapiWebService.CrmService" behaviorConfiguration="metadataBehavior">
      <host>
        <baseAddresses>
          <add baseAddress="http://localhost:64049/Service/CrmService.svc"/>
        </baseAddresses>
      </host>
      <endpoint address="" binding="webHttpBinding" bindingConfiguration="webHttpBindingWithJsonP" contract="MapiWebService.CrmService" behaviorConfiguration="webHttpBehavior" />
      <endpoint address="http://localhost:64049/Service/CrmService.svc/mex" binding="mexHttpBinding" contract="IMetadataExchange"/>
    </service>
  </services>
</system.serviceModel> 
```

这是我的服务课程的开场白：

```
namespace MapiWebService
{
    [ServiceContract]
    [AspNetCompatibilityRequirements(RequirementsMode = AspNetCompatibilityRequirementsMode.Allowed)]
    public class CrmService : PortalService
    {
        [OperationContract]
        [WebGet(ResponseFormat = WebMessageFormat.Json)]
        public string Authenticate(string username, string password) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-02T07:12:30.713

您必须为客户端应用程序的服务模型和 WCF 服务模型编写代码。（在 web 配置文件中）

对于客户端应用程序 web 配置..

```
 <system.serviceModel>
<serviceHostingEnvironment aspNetCompatibilityEnabled="true"
  multipleSiteBindingsEnabled="true" />
<services>
  <service name="UserSiteApp.AjxWcfService" >
    <endpoint contract="UserSiteApp.AjxWcfService" binding="webHttpBinding" address=""  behaviorConfiguration="UserSiteApp.MyServiceTypeBehaviors" />
  </service>
</services>
<bindings>
  <basicHttpBinding>
    <binding name="Binding1" closeTimeout="04:10:00" openTimeout="04:10:00" receiveTimeout="04:10:00" sendTimeout="04:10:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="1073741824" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
      <!--<compressionMessageEncoding innerMessageEncoding="binaryMessageEncoding" />-->
      <readerQuotas maxDepth="1073741824" maxStringContentLength="1073741824" maxArrayLength="1073741824" maxBytesPerRead="1073741824" maxNameTableCharCount="1073741824"/>
    </binding>
  </basicHttpBinding>
</bindings>

<behaviors>
  <endpointBehaviors>
    <behavior name="VInfotechEndPointBehavior">
      <dataContractSerializer maxItemsInObjectGraph="1500000000" />
    </behavior>
    <behavior name="UserSiteApp.MyServiceTypeBehaviors">
      <enableWebScript/>
    </behavior>
  </endpointBehaviors>

  <serviceBehaviors>
    <behavior name="">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
  </serviceBehaviors>

</behaviors>

<client>
  <!--Intranet Service-->
  <endpoint address="http://localhost:50004/Service1.svc" binding="basicHttpBinding" bindingConfiguration="Binding1" contract="your contracts Interface address" behaviorConfiguration="VInfotechEndPointBehavior" name="WSHttpBinding_IIntranet">
    <identity>
      <dns value="localhost"/>
    </identity>
  </endpoint>

    <identity>
      <dns value="localhost"/>
    </identity>
  </endpoint>

</client> 
```

对于 WCF 服务 web 配置

```
 <system.serviceModel>
<serviceHostingEnvironment multipleSiteBindingsEnabled="true" />
<services>
  <service name="VInfotech.Server.Intranet.IntranetService" behaviorConfiguration="IntranetService.Service1Behavior">
    <!-- Service Endpoints -->
    <endpoint address="" binding="basicHttpBinding" bindingConfiguration="Binding1" contract="VInfotech.Server.Intranet.IIntranet">
      <!-- 
          Upon deployment, the following identity element should be removed or replaced to reflect the 
          identity under which the deployed service runs.  If removed, WCF will infer an appropriate identity 
          automatically.
      -->
      <identity>
        <dns value="localhost"/>
      </identity>
    </endpoint>
  </service>
  <service name="VInfotech.Server.Intranet.MobileServicesController" behaviorConfiguration="ServBehave">
    <endpoint address="RestService" bindingConfiguration="StreamedRequestWebBinding" binding="webHttpBinding" behaviorConfiguration="restPoxBehavior" contract="VInfotech.Server.Intranet.IMobileServices" />
  </service>
</services>
<bindings>
  <webHttpBinding>
    <binding name="StreamedRequestWebBinding"
    bypassProxyOnLocal="true"
             useDefaultWebProxy="false"
             hostNameComparisonMode="WeakWildcard"
             sendTimeout="10:15:00"
             openTimeout="10:15:00"
             receiveTimeout="10:15:00"
             maxReceivedMessageSize="9223372036854775807"
             maxBufferPoolSize="9223372036854775807"
             maxBufferSize="2147483647"
             transferMode="StreamedRequest" >
      <readerQuotas maxArrayLength="2147483647" maxStringContentLength="2147483647" />
    </binding>
  </webHttpBinding>
  <basicHttpBinding>
    <binding name="Binding1" closeTimeout="04:01:00" openTimeout="04:01:00" receiveTimeout="04:10:00" sendTimeout="04:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="1073741824" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
      <readerQuotas maxDepth="1073741824" maxStringContentLength="1073741824" maxArrayLength="1073741824" maxBytesPerRead="1073741824" maxNameTableCharCount="1073741824"/>
    </binding>
    <!-- For Cyber Source bindings-->
    <binding name="ITransactionProcessor" closeTimeout="04:01:00" openTimeout="04:01:00" receiveTimeout="04:10:00" sendTimeout="04:01:00" allowCookies="false" bypassProxyOnLocal="false" hostNameComparisonMode="StrongWildcard" maxBufferSize="1073741824" maxBufferPoolSize="1073741824" maxReceivedMessageSize="1073741824" messageEncoding="Text" textEncoding="utf-8" transferMode="Buffered" useDefaultWebProxy="true">
      <readerQuotas maxDepth="1073741824" maxStringContentLength="1073741824" maxArrayLength="1073741824" maxBytesPerRead="1073741824" maxNameTableCharCount="1073741824"/>
      <security mode="TransportWithMessageCredential">
        <transport clientCredentialType="None" proxyCredentialType="None" realm=""/>
        <message clientCredentialType="UserName" algorithmSuite="Default"/>
      </security>
    </binding>
  </basicHttpBinding>
  <!--Cyber Source bindings ends here-->
</bindings>
<behaviors>
  <serviceBehaviors>
    <behavior name="IntranetService.Service1Behavior">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="true" />
    </behavior>
    <behavior name="">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
    <behavior name="ServBehave">
      <serviceMetadata httpGetEnabled="true" />
      <serviceDebug includeExceptionDetailInFaults="false" />
    </behavior>
  </serviceBehaviors>
  <endpointBehaviors>
    <!--Behavior for the REST endpoint for Help enability-->
    <behavior name="restPoxBehavior">
      <webHttp helpEnabled="true" />
    </behavior>
    <behavior name="jsonBehavior">
      <enableWebScript />
    </behavior>
  </endpointBehaviors>
</behaviors>
<client>
  <endpoint address="https://ics2wstest.ic3.com/commerce/1.x/transactionProcessor" binding="basicHttpBinding" bindingConfiguration="ITransactionProcessor" contract="ITransactionProcessor" name="portXML"/>
</client>
<diagnostics>
  <messageLogging logEntireMessage="true" logMalformedMessages="true" logMessagesAtServiceLevel="true" logMessagesAtTransportLevel="true" maxMessagesToLog="3000" maxSizeOfMessageToLog="2000"/>
</diagnostics> 
```

希望这会帮助你。:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:08:13.073

将此更改`<endpoint address="http://localhost:64049/Service/CrmService.svc/mex" binding="mexHttpBinding" contract="IMetadataExchange"/>`为

```
<endpoint address="mex" binding="mexHttpBinding" contract="IMetadataExchange"/> 
```

并尝试`http://localhost:64049/Service/CrmService.svc/mex`引用您的服务。

更新：

你的合同应该是你的`[ServiceContract]`界面，除非`CrmService`是你的`ServiceContract`

```
<endpoint address="" binding="webHttpBinding" bindingConfiguration="webHttpBindingWithJsonP" contract="MapiWebService.ICrmService" behaviorConfiguration="webHttpBehavior" /> 
```

# sql - 这是 sql 表列的有效标识符吗？

> ID：15165942
> 
> 赞同：1
> 
> 时间：2013-03-01T20:04:33.660
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures, identifier

我使用 SP_RENAME 存储过程重命名表列时犯了一个错误，现在我无法恢复它。这是 SQL Server 的有效标识符吗？

![在此处输入图像描述](../Images/559c8c71bee526e8b07e8ff48ec6543f.png)

这就是我所做的：

```
SP_RENAME '[WTF].[Name]', '[WhatThisFunction]', 'COLUMN' 
```

然后，在看到意外的结果后，我尝试将其回滚

```
SP_RENAME '[WTF].[WhatThisFunction]', 'Name', 'COLUMN' 
```

但是sql说找不到对象。有什么办法可以逃脱括号？

**更新：** 错误消息是：消息 15248，级别 11，状态 1，过程 sp_rename，第 215 行参数 @objname 不明确或声明的 @objtype (COLUMN) 错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:15:05.810

这对我有用：

```
SP_RENAME '[WTF].[[WhatThisFunction]]]', 'Name', 'COLUMN' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T20:18:58.803

我不确定为什么删除了答案，但该脚本实际上会将列的名称更改回“名称”。

```
SP_RENAME '[WTF]."[WhatThisFunction]"', 'name', 'COLUMN' 
```

所以将

```
SP_RENAME '[WTF].[[WhatThisFunction]]]', 'Name', 'COLUMN' 
```

如 user1948904 所列。

您首先遇到问题的原因（我也做过同样的事情）是 sp_rename 的第一个参数可以有或没有 []，如果你把 []'s 放在第二个参数上这将包含在名称中。所以你的专栏的名字变成了 [WhatThisFunction] 而不是 WhatThisFunction 这可能是你想要的。

有趣的是，如果您进入设计窗口，列名实际上被列为 [[WhatThisFunction]]]，当您编写更改脚本时，它会将其传递给 sp_rename。

# delphi - 显示 bpl 入口点的工具？

> ID：15165944
> 
> 赞同：3
> 
> 时间：2013-03-01T20:04:46.177
> 
> 标签：delphi, entry-point, bpl

当我知道它应该在那里时，试图了解为什么我们会得到“找不到入口点”。除了地图之外，是否有一种工具可以“探索” .bpl 或 .dll 并显示入口点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-01T21:38:15.010

Delphi 附带了[一个名为的命令行程序`tdump`](http://docwiki.embarcadero.com/RADStudio/XE3/en/TDUMP.EXE,_the_File_Dumping_Utility)，该程序将打印二进制文件的导入和导出符号列表等。BPL 文件只是一个具有特殊格式的函数名称的 DLL。

文档说 Tdump 将使用该`-um`选项解开名称，但我认为这可能仅适用于 C++ 名称修饰，而不适用于*Delphi*对标识符所做的更改。试试看。即使名称仍然错位，识别您正在寻找的名称也不*是太难。*

# jquery - jquery ajax element.children.length没有得到更新

> ID：15165947
> 
> 赞同：0
> 
> 时间：2013-03-01T20:05:16.777
> 
> 标签：jquery, ajax, updates

我们每 5 秒进行一次 ajax 调用，目的是将其内容附加到现有的父元素。该父元素最多有 25 个元素，因此任何超过该元素的元素都将从父元素的开头删除。除了我们为输出 contentLength 进行的 console.log 调用外，一切都按预期工作。contentLength 的大小不断增加，但它应该是 25。我认为这与我们正在进行 ajax 调用的事实有关，并且在 ajax 调用中此时 DOM 长度是“不正确的”。难道我做错了什么？我怎样才能解决这个问题？

```
 AJS.$.ajax({
        url: "ajax.action?",
        success: function (data) { 

                            //Cleanup and insert into parent div
                var divID   = "#" + insertContentIntoDiv;
                var wrapped = AJS.$("<div>" + data + "</div>");
                AJS.$(wrapped).find('title').remove().end();
                wrapped     = AJS.$(wrapped).find('meta').remove().end();
                AJS.$(divID + " dt:last-child").after(wrapped.html().trim());

                //Remove any whitespace pre-pended to parent element
                cleanWhiteSpaceFromElement(insertContentIntoDiv);

                //Remove child elements starting at beginning
                var parentElement = document.getElementById(insertContentIntoDiv);
                if(parentElement){

                    var contentLength = parentElement.childNodes.length;

                    console.log("________________cont: " + contentLength);
                    if(contentLength > 0){

                        var difference = contentLength - maxDisplayedLines;
                        console.log("___________removing: " + difference);
                        if(difference > 0){
                            AJS.$(divID + " dt:lt(" + difference + ")").remove();
                        }
                    } else {
                        console.log("ElementID " + insertContentIntoDiv + " appears to have no children. Was this expected?");
                    }
                } else {
                    console.log("ElementID " + insertContentIntoDiv + " NOT found. Log parsing will NOT be done");
                }
        },
        dataType: 'html'
    }); 
```

# image - 如何过滤 RGB 图像并转换为 BW 图像

> ID：15165951
> 
> 赞同：-1
> 
> 时间：2013-03-01T20:05:23.090
> 
> 标签：image, matlab, image-processing

我一直在尝试这样做：

[http://prntscr.com/umv66](http://prntscr.com/umv66) -> [http://goo.gl/Bgmv2](http://goo.gl/Bgmv2)（你可以忽略红线，我只是添加它们来说明最终目标）

所以，我在第一种情况下所做的是：使用 MatLab，我转换了 rgb -> hsv 并拾取了 s 通道（又名饱和度）。然后我使用Otsu（在matlab中称为graythresh）进行二值化并转换成黑白图片。一切都很完美。

现在，在第二种情况下，这不太好用：

基础img( [http://goo.gl/OtK4G](http://goo.gl/OtK4G) ) ->S频道( [http://goo.gl/oo8h6)->Otsu(http://goo.gl/cnfxU](http://goo.gl/oo8h6) [)](http://goo.gl/cnfxU)

如您所见，在这种情况下，Otsu 过滤器变得毫无用处。我应该采取任何解决方法或其他方式吗？提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:14:30.640

您可以使用 k-means 执行图像量化。所以你知道你必须以这样一种方式对图像进行二值化，使黄色阴影变成白色，而其他一切都变成黑色。因此，将您的图像分成合适数量的集群（4 个可能有效）。2 用于黄色色调，2 用于其他色调。不要忘记预定义初始质心。在此之后，您可以说，被标记为黄色质心的像素被重新标记为一个。这可能会奏效。

k-means 颜色量化过程的细节： 1\. 首先将图像中的所有像素收集在一个`nx3`矩阵中。然后使用 k-means 将`nx3`矩阵划分为 3 或 4 个簇。2\. 在将其划分为 4 个集群之前，预定义质心。您可以通过在[此处阅读 MATLAB kmeans 算法的文档来做到这一点](http://www.mathworks.com/help/stats/kmeans.html). 您必须设置的参数是 kmeans 的 'options' 字段中的 'start'。3\. 所以黄色（和其他“接近”它的颜色）应该属于预定义的集群。（因此，如果您为黄色定义了集群 1 和 2，那么您应该将所有黄色像素标记为 1 或 2。其他像素将标记为 3 或 4。） 4\. 现在，将图像转换为二进制，这样像素落入黄色簇（即本例中的簇 1 和 2），应设为 1，其他将为零。

有关预定义集群的更多详细信息：来自 kmeans 文档：起始质心可以在`start`参数中定义为质心起始位置`kmeans`的`k-by-p`矩阵。在您的情况下，它将是`RGB`黄色的值。查看图像中存在的黄色的一些像素值。如果它们的偏差太大，则为它们定义两个集群，否则为一个。如果您定义两个，那么您的`start`参数将具有`2x3`矩阵。您应该始终记住，质心中的列数将等于数据中的列数。

我希望这可以在更高的层次上使过程更加清晰。如果您有任何错误，请发布您的代码。

# iphone - 广告清除IdleCellConnections ios

> ID：15165957
> 
> 赞同：1
> 
> 时间：2013-03-01T20:05:31.170
> 
> 标签：iphone, ios, ads, chartboost

这个问题才开始出现。当我尝试缓存[Chartboost](https://chartboost.com/)广告以便稍后显示时，我得到以下信息。模拟器没有问题，但是当我尝试在实际设备上进行测试时，没有广告显示。有谁知道如何解决这一问题？

```
purgeIdleCellConnections: found one to purge conn = 0x1fd38360
purgeIdleCellConnections: found one to purge conn = 0x1fdf5e20
purgeIdleCellConnections: found one to purge conn = 0x1fde23d0
purgeIdleCellConnections: found one to purge conn = 0x1fdc16e0
purgeIdleCellConnections: found one to purge conn = 0x1fdb5ec0 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T05:27:26.990

您可以通过 2 种方式在真实设备中测试 Chartboost 广告。

« 1\. 在 chartboost App 部分启用 testmod。

« 2\. 添加发布活动并在测试设备中添加您的设备UDID。有关更多信息，请参阅这些屏幕截图。

![在此处输入图像描述](../Images/898df8316f1868d16cb10ce38eb9fcce.png) ![在此处输入图像描述](../Images/93bb59b9c0b7e2b79439a46ab7f2003a.png) ![在此处输入图像描述](../Images/da683be64ebb5419b3f6d8f0bddc487b.png) ![在此处输入图像描述](../Images/6ab4d5314a3474c60310931372da1b95.png)

# c# - 在代理生成中将方法参数值类型更改为可为空的值类型

> ID：15165959
> 
> 赞同：0
> 
> 时间：2013-03-01T20:05:32.020
> 
> 标签：c#, asp.net, web-services, serialization, svcutil.exe

只是为了给我的想法一个大背景。

我必须使用 Java 服务。有些方法具有值类型作为参数，例如`int, decimal.`

我通过 生成了一个代理`svcutil.exe`，当然它生成了具有相应类型的方法，但我想将它们生成为可空值......

而不是`decimal`，我希望他们成为`decimal?`，你可能会问为什么？

那么原因是因为Java Service是通过JBoss自动生成的服务，他们只是制作一个oracle包并通过Jboss将其公开并生成服务。所以有些程序会做这样的事情......

```
WHERE COLUMN = NVL(PARAM_NOT_MARKED_AS_NULLABLE_IN_SERVICE, COLUMN)
AND COLUMN2 = NVL(ANOTHER_PARAM_NOT_NULLABLE_IN_SERVICE, COLUMN2) 
```

所以你必须知道如果像这样消费服务是不一样的

```
WSClient.somemethod(0, 0,0); 
```

比这样

```
WSClient.somemethod(null, null,null); 
```

当第一个不是时，最后一个将返回一些结果。

我无法更改服务，也无法请求他们更改 WSDL 的定义，因为它是为他们自动生成的。他们对Java一无所知，只知道pl-sql。

我手动更改了我的自动生成代理来测试，如果这个想法可行，并将方法的参数类型更改为可空值，我对其进行了测试，并且正如猜测的那样，它就像一个魅力。

服务在不断变化，一些参数被添加、删除、改进等，所以当服务发生变化时我再次生成代理并将其复制并粘贴到我的项目中

我生成这样的服务：

```
svcutil  /ct:System.Collections.Generic.List`1  http://Myurl?wsdl 
```

我认为如果每次重新生成代理时都必须手动更改每种方法，那将是非常痛苦的

我愿意使用其他软件，使用 svcutil 的特殊命令，使用其他工具，无论如何，但我正在寻找一种将方法的值参数类型更改为可空类型的方法，我不得不说只是方法参数不是所有参数，因为某些对象定义实际上具有可为空类型的属性，并且它们可以从原点为空。

我知道我在问一些错误的问题，真正的解决方案应该是服务可以互操作，但正如我所说，我不能这么问。

我不认为手动查找和替换是一种方法并将其更改为“？”应该是最好的主意。

我真的很感激任何帮助。

问候，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:10:26.210

创建一个控制台应用程序，为您执行查找/替换并将其作为构建脚本的一部分运行

# powershell-3.0 - 如何阻止或隐藏我的源代码，但可以正常运行。在 PowerShell 上

> ID：15165963
> 
> 赞同：0
> 
> 时间：2013-03-01T20:05:52.890
> 
> 标签：powershell-3.0

我想正常运行PS脚本，但是当我或任何其他人尝试打开源代码时，您无法打开它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T09:20:18.560

试试[PShellExec](http://powergui.org/entry.jspa?externalID=3122)（应该使用某种混淆原理）

# android - Android 显示与图像文件同名的文本文件

> ID：15165968
> 
> 赞同：0
> 
> 时间：2013-03-01T20:06:00.083
> 
> 标签：android, image, file, text, filenames

现在我有一个非常简单的应用程序，我可以在其中拍照，然后回答问题。我将图片的文件名捆绑到问题类中，然后使用相同的文件名将问题保存为文本文件（这些都保存在 SD 卡上）。现在我要做的是在选择该图片时显示该文本文件（它将显示在 TextView 中）。所以我的问题是有没有办法显示一个文本文件，它与一个选定的图像文件同名`TextView`？我还没有找到其他类似的东西，尽管这似乎不是一个不常见的任务。

我的代码如下：

创建图像文件名：

```
ImageButton button;
static int data = 0;

button.setOnClickListener(new View.OnClickListener() {              
    public void onClick(View v) { 
        i = new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);
        String root = Environment.getExternalStorageDirectory().toString();
        File myDir = new File(root + "/MyDirectory/");    
        myDir.mkdirs();

        if (myDir.exists()) { }

        Random generator = new Random(); 
        int n = 10000;
        n = generator.nextInt(n);
        String fname = "Image-"+ n +".jpg";
        text.setText(fname);

        File file = new File (myDir, fname);
        Uri uriSavedImage = Uri.fromFile(file);  
        Bundle basket = new Bundle();
        basket.putString("key", fname);

        sendBroadcast(new Intent(Intent.ACTION_MEDIA_MOUNTED, Uri.parse("file://"+ Environment.getExternalStorageDirectory())));
        Intent is = new Intent(Home.this, Details.class);
        is.putExtras(basket);
        i.putExtra("output", uriSavedImage);
        startActivity(is);
        startActivityForResult(i, data); 
    }
}); 
```

创建文本文件名：

```
textfileName = (TextView)findViewById(R.id.textFile);
Button save;
TextView question;

Bundle gotBasket = getIntent().getExtras();
gotBread = gotBasket.getString("key");
textfileName.setText(gotBread);

save.setOnClickListener(new View.OnClickListener() {
    public void onClick(View arg0) {
        Toast.makeText(getApplicationContext(), "Details Saved!", Toast.LENGTH_SHORT).show();
        textQuestion= question.getText().toString();

        String root = Environment.getExternalStorageDirectory().toString();
        File myDir = new File(root + "/MyDirectory/");    
        myDir.mkdirs();

        if (myDir.exists()) { }

        detailsFile = textfileName.getText().toString() + ".txt";
        File file = new File (myDir, detailsFile);

        try {
            BufferedWriter writer = new BufferedWriter(new FileWriter(file,true));
            writer.write(textQuestion);
            writer.newLine();
            writer.flush();
            writer.close();
        } catch (IOException e) { e.printStackTrace(); }
    }
}); 
```

显示已选择图像的文件：

```
final Button viewBtn = (Button)findViewById(R.id.detailsBtn);

viewBtn.setOnClickListener(new View.OnClickListener() {
    public void onClick(View v) {
        final int len = thumbnailsselection.length;
        int cnt = 0;
        String selectImages = "";

        for (int i = 0; i<len; i++) {
            if (thumbnailsselection[i]) {
                cnt++;
                selectImages = selectImages + arrPath[i] + "|";
            }
        }

        if (cnt == 0) {
            Toast.makeText(getApplicationContext(), "Please Select One Picture", Toast.LENGTH_SHORT).show();
        } else if  (cnt > 1) {
            Toast.makeText(getApplicationContext(), "Please Select Only One Picture", Toast.LENGTH_SHORT).show();
        } else if (cnt == 1) {

setContentView(R.layout.details_text);
                        detailsView = (TextView)findViewById(R.id.displayDetails); 
                        File dir = Environment.getExternalStorageDirectory();
                        File myFile = new File(dir, "/MyDirectory/" + "detailsFile-.txt");

                        if (myFile.exists()) {
                            StringBuilder text = new StringBuilder();
                            try {
                                BufferedReader br = new BufferedReader(new FileReader(myFile));
                                String line;

                                while ((line = br.readLine()) != null) {
                                    text.append(line);
                                }
                            }
                            catch (IOException e) {

                            }   
                            detailsView.setText(text);
                        }
                        else
                        {
                            Toast.makeText(getApplicationContext(), "File Doesn't Exist", Toast.LENGTH_SHORT).show();
                        }
                        }

                    }

            }); 
```

我`else if`试图在`TextView`.

# json - 将json读入R

> ID：15165969
> 
> 赞同：2
> 
> 时间：2013-03-01T20:06:02.073
> 
> 标签：json, r

经过几天的挣扎，我决定请教stackoverflow的专家。

我想导出这个（例如）“ [http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d =iphone](http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d=iphone) ”进入R。

所以这就是我尝试过的。

```
library(RJSONIO)
library(rjson)
library(RCurl)
appannie <- getURL("http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/.json?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d=iphone")
fromJSON(appannie) 
```

但这给了我一个“没有要解析的数据”的错误。

但我可以清楚地看到有数据（我可以从浏览器中看到数据）。

[{"data": [[1286323200000, 70, "初始发布\n"], [1286409600000, 65, null], [1286496000000, 89, null], [1286582400000, 106, null], [1286668800000, 143, null ], [1286755200000, 172, null], [1286841600000, 106, null], [1286928000000, 116, null], [1287014400000, 78, null], [1287100800000, 102, null], ...... [1338768 , 2, null]], "label": "照片和视频"}]

所以我尝试了这个。

```
fromJSON(paste(readLines('http://www.appannie.com/app/ios/instagram/ranking/history/chart_data/.json?s=2010-10-06&e=2012-06-04&c=143441&f=ranks&d=iphone'), collapse="")) 
```

但是这个给了我一个“意外字符'<'”的错误。

有人可以指导我为什么会发生这种情况以及如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-01T20:49:09.720

鉴于您粘贴的数据：

```
 jsonRaw <- '{"data": [[1286323200000, 70, "Initial release\n"], [1286409600000, 65, null], [1286496000000, 89, null], [1286582400000, 106, null], [1286668800000, 143, null], [1286755200000, 172, null], [1286841600000, 106, null], [1286928000000, 116, null], [1287014400000, 78, null], [1287100800000, 102, null], [1338768000000, 2, null]], "label": "Photo and Video"}]' 
```

一切正常：

```
 jsonParsed <- fromJSON(jsonRaw) 
```

可能发生的是 R 无法访问该网站。看看你的`RCurl`语句的输出。如果它不是`json`类似数据，那么您就有问题了。

编辑：

你说

> *“但我可以清楚地看到有数据（我可以从浏览器中看到数据）。”*

但是你已经登录了，很明显这和在里面看到的不是一回事`R`

# django - 让 django 选择相关对象的列表

> ID：15165970
> 
> 赞同：0
> 
> 时间：2013-03-01T20:06:04.493
> 
> 标签：django, orm, django-models, django-queryset

我有一个这样的模型：

```
class Issue(models.Model):
    project = models.ForeignKey(Project, null=True, blank=True)
    key = models.CharField(max_length=30, null=True, blank=True)
    title = models.CharField(max_length=400)
    description = models.TextField(null=True, blank=True)
    createdByUser = models.ForeignKey(User)
    creationDate = models.DateTimeField()
    updatedDate = models.DateTimeField(null=True, blank=True)
    trackerURL = models.URLField(null=True, blank=True)
    is_feedback = models.BooleanField()
    is_public_suggestion = models.BooleanField()

class IssueWatch(models.Model):
    issue = models.ForeignKey(Issue)
    user = models.ForeignKey(User)
    reason = models.CharField(max_length=30, null=False, blank=False) 
```

完整代码在这里： [https ://github.com/freedomsponsors/www.freedomsponsors.org/blob/master/djangoproject/core/models.py](https://github.com/freedomsponsors/www.freedomsponsors.org/blob/master/djangoproject/core/models.py)

这适用于类似于问题跟踪器的系统。用户`Issues`可以观看问题 ( `IssueWatch`) 以接收电子邮件更新。

我想进行一个查询，该查询将返回用户正在观看的问题列表。就像是：

```
IssueWatch.objects.select('issue').filter(user=17) 
```

当然，没有像上面我想使用的那种“选择”方法。

有什么方法可以让 Django 返回一个惰性的问题（而不是问题观察）对象集合？

- - - - - - - - 更新 - - - - - -

我尝试阅读`user.issue_set.all()`并且它有效。现在我很困惑。为什么用户会得到一个 issue_set？如果我创建了另一个模型，让用户，比如说，最喜欢的问题，比如：

```
class IssueFavorite(models.Model):
    issue = models.ForeignKey(Issue)
    user = models.ForeignKey(User) 
```

那会是什么`issue_set`意思呢？

--------------- 更新2 -----------

呵呵，我找到了答案。issue_set 指的是用户创建的问题（因为属性：）`Issue.createdByUser`这不是我想要的问题列表。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:31:48.097

只是一个简单的`filter`工作。选择查询允许反向关系。所以：

```
Issue.objects.filter(issuewatch__user = 17) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-01T20:32:34.347

所以，如果我理解这个问题，您想选择特定用户正在观看的所有问题吗？这将通过以下方式完成：

```
Issue.objects.filter(issuewatch__user=17) 
```

[来源](https://docs.djangoproject.com/en/dev/topics/db/queries/#lookups-that-span-relationships)

# python - 从 HTTP 迁移到 HTTPS

> ID：15165971
> 
> 赞同：2
> 
> 时间：2013-03-01T20:06:07.977
> 
> 标签：python, django

如何设置项目以使用 HTTPS？我需要什么？

我使用 Django 1.4.2

我添加了

```
#https
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True 
```

如何配置 urls.py？有人有示例配置吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-01T20:47:31.897

**购买**并**安装**证书后，可以通过三种方式从 http 重定向到 https。

1.  代理配置。（仅允许 HTTPS）
2.  在服务器配置文件中创建 http 到 https 重定向
3.  为此使用 Django 中间件，例如：[http ://djangosnippets.org/snippets/880/](http://djangosnippets.org/snippets/880/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-08T15:54:38.357

Maybe this could help: [https://github.com/teddziuba/django-sslserver](https://github.com/teddziuba/django-sslserver)

This will give you the ability to accept HTTPS requests using only Django.

# php - 将 HTML 表格导出为文本或 CSV 文件

> ID：15165974
> 
> 赞同：0
> 
> 时间：2013-03-01T20:06:22.627
> 
> 标签：php, javascript, jquery, html

我有一个将结果输出到 HTML 表的 PHP 搜索页面。我正在使用 jQuery 插件来允许通过单击列标题对列进行排序。我希望允许用户将搜索结果下载到 TXT 或 CSV 文件，但我希望保留排序顺序。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:12:27.513

浏览器端（javascript）无法生成可下载的文件，因此您需要从服务器端（在您的情况下为 php）生成它。您可以跟踪使用 javascript 的最后一个**订单**，并将其传递给 PHP 脚本以按正确的顺序生成文件

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:17:11.330

该 jquery 插件通过更新一个元素来工作，可能是一个带有表的 div。

只需获取 div innerhtml 并使用正则表达式对其进行解析。

在 jquery 中这将是 $(divname).html()

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-03-01T20:08:48.437

这是一个很好的处理表格的 jQuery 插件：

[http://www.datatables.net/](http://www.datatables.net/)

您可以将 tabletools 与数据表一起使用 [http://datatables.net/release-datatables/extras/TableTools/index.html](http://datatables.net/release-datatables/extras/TableTools/index.html)

# c# - 多个自定义微站，维护期间如何关闭？

> ID：15165986
> 
> 赞同：0
> 
> 时间：2013-03-01T20:07:17.957
> 
> 标签：c#, asp.net

我有多个自定义构建的小型微型站点，它们都不是建立在任何通用代码库（遗留）上的。

在维护期间，当我需要关闭这些站点时，这是一个手动设置自定义页面的过程，它会在停机期间进行更新时重定向到该页面。

我想构建一个通用库，我可以将其放入每个站点以在全局级别控制事物以打开/关闭站点。

你会建议我怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T20:24:59.767

目前尚不清楚“维护”是什么意思——如果是代码更新，添加任何新代码都无济于事，因为无论如何您都需要停止站点。如果是某种“数据库/后端维护”，则可以选择添加共享代码，如果您不熟悉代码，则这样做可能会很困难/危险。

更多选择：

*   在 DNS 级别重定向（如果您可以在可接受的时间内重新指向 DNS）到一些特殊的“所有站点关闭”的地方
*   在 IIS 级别重写 URL 以将所有 Url 重定向到自定义站点（将避免接触现有站点）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T21:08:11.133

将[app_offline.htm](http://weblogs.asp.net/scottgu/archive/2005/10/06/426755.aspx)文件添加到每个应用程序。此页面的内容将在网站存在时用于对网站的任何请求。完成后，删除文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-01T20:20:17.430

在提供信息之前，我会在这些站点可以查看的根文件夹（wwwroot？）中放置一个文件。该文件可能包含一个简单的标志，指示是否应该提供信息，并且可能包含一个当站点关闭时他们应该将用户重定向到的 URL。

所有这些都假设您能够修改这些项目以使用该文件。

# javascript - 未捕获的 TypeError：drawImage 的类型错误

> ID：15165991
> 
> 赞同：2
> 
> 时间：2013-03-01T20:07:40.340
> 
> 标签：javascript, html, canvas, drawimage

我是 HTML5 和 canvas 元素的新手，在过去的几周里，我一直在努力更好地理解它。`Uncaught TypeError: Type error`无论如何，当我尝试将红色方块从此代码[http://jsfiddle.net/kmHZt/10/](http://jsfiddle.net/kmHZt/10/)更改为此图像[http://i.imgur.com/k73egsW.png](http://i.imgur.com/k73egsW.png)时，我得到了一个。但是当我尝试时，我总是得到那个`Uncaught TypeError: Type error`。这是我目前拥有的代码[http://jsfiddle.net/cCDFs/](http://jsfiddle.net/cCDFs/)。

如果您需要我更好地解释一些事情，请询问。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-01T20:18:43.330

您正在尝试将 URL 传递到`drawImage`，这是您无法做到的 - 您需要在图像完成加载后加载图像元素并传递它。

[这篇文章](https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial/Using_images)有我所描述的例子。

代码最终会是这样的：

```
var img = new Image();
img.onload = function() {
    context.drawImage(img, 2, 2);
}
img.src = 'http://i.imgur.com/k73egsW.png'; 
```

事实上，您的代码在加载和绘制图块时已经这样做了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-01T20:24:27.823

您需要传递给 drawImage 的第一个参数是 Image 或 Canvas 对象，而不是字符串；

我不太明白你试图用你的代码实现什么，但是如果你用这样的代码替换你对函数的 draw() 调用：

```
var otherImageObj = new Image();
otherImageObj.onload = function() {
        context.clearRect(0,0,canvas.width, canvas.height);
        for (y = 0; y <= vHeight; y++) {
            for (x = 0; x <= vWidth; x++) {
                theX = x * 32;
                theY = y * 32;
                context.drawImage(tiles[board[y+vY][x+vX]], theX, theY, 32, 32);
            }
        }
        context.drawImage(otherImageObj, 2, 2);

};
otherImageObj.src = "http://i.imgur.com/k73egsW.png"; 
```

您的代码实际上可以工作，尽管您的图像出现“403（禁止）”错误。

# asp.net - 我需要在 asp.net 中验证查询字符串

> ID：15165996
> 
> 赞同：-3
> 
> 时间：2013-03-01T20:08:00.260
> 
> 标签：asp.net, sql, vb.net, validate-request

```
 Dim objItems As clsItems

'Loads the pages with the Gridview and Infomation pretaining to the Item selected
Protected Sub Page_Load(sender As Object, e As System.EventArgs) Handles Me.Load

    Dim qryItemNum As String = Request.QueryString("qryItemNum")

    'Populates Gridview
    If Not Page.IsPostBack Then
        gvwCategorySelect.DataSource = clsCategory.GetList
        gvwCategorySelect.DataBind()

        'imgbtnPrev.Visible = False

        'If Not String.IsNullOrEmpty(qryItemNum) Then
        '    Dim ItemNum As Int32
        '    If Int32.TryParse(test, ItemNum) Then
        '        imgbtnPrev.Visible = (-1 < ItemNum)
        '    End If
        'End If
    End If

    objItems = New clsItems(qryItemNum)

    'Set up the from labels
    lblTitle.Text = objItems.Title
    lblPrice.Text = objItems.Price.ToString("C")
    lblDescription.Text = objItems.Description
    ImgItem.ImageUrl = "~/images/ItemImages/Item" & objItems.ItemNum & ".jpg"

End Sub

'Returns to pervious item
Protected Sub imgbtnPrev_Click(sender As Object, e As System.Web.UI.ImageClickEventArgs) Handles imgbtnPrev.Click

    Response.Redirect("~/ItemInfo.aspx?qryItemNum=" & objItems.ItemNum - 1)

End Sub

'Next item
Protected Sub imgbtnNext_Click(sender As Object, e As System.Web.UI.ImageClickEventArgs) Handles imgbtnNext.Click

    Response.Redirect("~/ItemInfo.aspx?qryItemNum=" & objItems.ItemNum + 1)

End Sub 
```

在上面的代码中有 2 个图像按钮，它们在不同的 ItemNum 之间移动。我试图通过在查询字符串为 1 时删除 imgbtnPrev 按钮来阻止用户单击上一个按钮。

错误消息显示位置 0 处没有行

```
dataRowObject = DBMethods.CreateTable(sqlString, sqlArg).Rows(0) 
```

^ 这里是突出显示的地方。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:14:12.547

尝试这个

```
 int number;
   if(Request.QueryString["qryItemNum"]!= null)
    {
     bool isNumeric = int.TryParse(Request.QueryString["qryItemNum"].ToString(), out number);
      if(isNumeric == true)
      {
        if(Convert.ToInt(Request.QueryString["qryItemNum"])<=1)
        {
          imgbtnPrev = false;
        }
      }
   } 
```

**编辑：** 我将其转换为 VB.NET

```
 Dim number As Integer
   If Request.QueryString("qryItemNum") IsNot Nothing Then
Dim isNumeric As Boolean = Integer.TryParse(Request.QueryString("qryItemNum").ToString(), number)
   If isNumeric = True Then
    If Convert.ToInt(Request.QueryString("qryItemNum")) <= 1 Then
        imgbtnPrev = False
    End If
   End If
   End If 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-01T20:21:05.180

我认为这就是VB的做法：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not Page.IsPostBack Then
        imgbtnPrev = False
        Dim qryItemNum As String = Request.QueryString("qryItemNum")
        If Not String.IsNullOrEmpty(qryItemNum) Then
          Dim ItemNum As Int32
          If Int32.TryParse(qryItemNum, ItemNum) Then
            imgbtnPrev = (-1 < ItemNum)
          End If
        End If
    End If
End Sub 
```

当然，这假定它`imgbtnPrev`是在您的代码或 ASPX 页面中的某处定义的。

**编辑：**从您的评论之一`imgbtnPrev.Visible = False`到您的原始问题，它似乎`imgbtnPrev`是您表单上的一个按钮。如果是这种情况，您将编写如下内容：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not Page.IsPostBack Then
        imgbtnPrev.Visible = False
        Dim qryItemNum As String = Request.QueryString("qryItemNum")
        If Not String.IsNullOrEmpty(qryItemNum) Then
          Dim ItemNum As Int32
          If Int32.TryParse(qryItemNum, ItemNum) Then
            imgbtnPrev.Visible = (-1 < ItemNum)
          End If
        End If
    End If
End Sub 
```

**EDIT2：**此版本使用`Try...Catch`来查看错误是什么：

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
    If Not Page.IsPostBack Then
        imgbtnPrev.Visible = False
        Try
          Dim qryItemNum As String = Request.QueryString("qryItemNum")
          If Not String.IsNullOrEmpty(qryItemNum) Then
            Dim ItemNum As Int32
            If Int32.TryParse(qryItemNum, ItemNum) Then
              imgbtnPrev.Visible = (-1 < ItemNum)
            End If
          End If
        Catch err As Exception
          Response.Write(err.Message)
        End Try
    End If
End Sub 
```

希望能帮助到你！

# grails - 将 spock grails 插件添加到项目后尝试与 eclipse 集成时出错

> ID：15165999
> 
> 赞同：0
> 
> 时间：2013-03-01T20:08:13.903
> 
> 标签：grails, grails-plugin

添加到 Grails 2.0.4 项目的 BuildConfig 后：

```
test ":spock:0.7" 
```

在插件文档的 plugins { } 部分中，我想更新我的 eclipse 项目以包含 spock 库以创建测试，所以我运行

```
grails integrate-with --eclipse 
```

但是受到了这个欢迎

```
| Error Error executing script IntegrateWith: The Spock compiler plugin could not run because Spock 0.5.0-groovy-1.7 is not compatible with Groovy 1.8.6\. For more information, see http://versioninfo.spockframework.org
Spock location: file:/C:/Users/fgg/.grails/ivy-cache/org.spockframework/spock-core/jars/spock-core-0.5-groovy-1.7.jar
Groovy location: file:/C:/tools/grails-2.0.4/lib/org.codehaus.groovy/groovy-all/jars/groovy-all-1.8.6.jar (Use --stacktrace to see the full trace) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-01T20:08:13.903

我最终运行它来修复它：

```
grails clean 
```

然后运行这个：

```
grails --refresh-dependencies integrate-with --eclipse 
```

得到这个结果：

```
| Loading Grails 2.0.4
| Created Eclipse project files.. 
```