# StackOverflow 问答 14266000-14266999

# java - 无法使用 ID/xpath 选择复选框。

> ID：14266000
> 
> 赞同：1
> 
> 时间：2013-01-10T19:44:38.907
> 
> 标签：java, selenium-webdriver

在 Java (Eclipse) 中使用 Selenium WebDriver。我正在尝试删除雅虎垃圾邮件文件夹中的邮件。我可以单击左侧面板中的垃圾邮件文件夹链接并查看邮件，但无法选中复选框。我尝试选择将选择下面所有复选框的顶部框。

这是我编写的单击垃圾邮件文件夹然后选中复选框的代码：

```
driver.findElement(By.xpath("//*[@id='spam-label']")).click();

driver.findElement(By.xpath("//*[@id='btn-ml-cbox']")).click();  //selecting the checkbox 
```

请建议如何进一步进行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T12:21:06.327

此代码对我有用，请选中复选框，请查看是否对您有帮助

```
 public class webdriver_firefox 
   {
  public static void main(String[] args) throws InterruptedException
         {
     WebDriver driver = new FirefoxDriver(); 
     driver.get("http://www.gmail.com");
     System.out.println(driver.getTitle());

     driver.findElement(By.id("Email")).sendKeys("abc@gmail.com");
     try{Thread.sleep(4000);}catch(Exception e) {}
      driver.findElement(By.id("Passwd")).sendKeys("123654");
      driver.manage().timeouts().implicitlyWait(10, TimeUnit.SECONDS);
     driver.findElement(By.xpath("/html/body/div/div[2]/div/div/form/label")).click();  // this line select the check box please check this
     synchronized (driver)
     {
         driver.wait(2000);
     }
     //driver.wait(1000, 1 );
     driver.findElement(By.id("signIn")).click(); 
```

# javascript - 阻止表单提交

> ID：14266005
> 
> 赞同：0
> 
> 时间：2013-01-10T19:44:55.777
> 
> 标签：javascript, html, forms, validation, twitter-bootstrap

我使用 Bootstrap 的登录表单示例代码创建了一个注册表单，并且我试图在表单操作发生之前对表单执行粗略的验证。但是，我注意到即使我`return false`仍然提交了表单操作并且我被加载到了表单操作页面。*当表单的值无效时*（即：电子邮件类似于`abcdef`） ，如何阻止这种情况发生。

这是一个小提琴：http: [//jsfiddle.net/CCsJn/1/](http://jsfiddle.net/CCsJn/1/)

请注意，即使代码返回 false，表单也会提交。

搜索使我想到了[这个问题](https://stackoverflow.com/questions/12461755/prevent-form-from-submitting)，但是该代码对我不起作用

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T19:47:52.267

傻我！这是一个错字！

```
if ((email.value.length == 0) || (!validateEmail(email))){
        alert("Valid email is required.");
        elem.focus();
        return false;
} 
```

`elem.focus()`应该`email.focus()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:10:48.767

最后尝试这样的条件

```
event.stopImmediatePropagation();
            event.preventDefault();
             return false; 
```

但为此，您必须定义一个事件 1st，这将是您的条件。如果确切的事情没有帮助，请阅读 stopImmediatePropagation 和 preventDefault。我有同样的问题，这对我有帮助

# c# - PropertyChangedEventHandler 为空

> ID：14266007
> 
> 赞同：1
> 
> 时间：2013-01-10T19:45:01.087
> 
> 标签：c#, .net, wpf, binding, inotifypropertychanged

我有以下类将成为绑定源：

```
public class Timeline : Canvas, INotifyPropertyChanged
{

  public static readonly DependencyProperty TimeTextBindingPropProperty;
  public event PropertyChangedEventHandler PropertyChanged;

  private void OnPropertyChanged(string name)
  {
    if (PropertyChanged != null)
      PropertyChanged(this, new PropertyChangedEventArgs(name));
  }

  public double TimeTextBindingProp
  {
    get { return (double)GetValue(TimeTextBindingPropProperty); }
    set 
    {
      SetValue(TimeTextBindingPropProperty, value);
      OnPropertyChanged("TimeTextBindingProp");
    }
  }

  static Timeline()
  {
    TimeTextBindingPropProperty = DependencyProperty.Register("TimeTextBindingProp", typeof(double), typeof(Timeline));
  }
} 
```

然后我在主窗口中设置文本框`Text`属性和属性之间的绑定：`timeline's TimeTextBindingProp`

```
private void InitTextBinding()
{
  timeTextBinding = new Binding();
  timeTextBinding.Mode = BindingMode.OneWay;
  timeTextBinding.Source = timeline;
  timeTextBinding.Path = new PropertyPath("TimeTextBindingProp");
  timeTextBinding.Converter = new TimeTextConverter();

  BindingOperations.SetBinding(this.timeTextBox, TextBox.TextProperty, timeTextBinding);
} 
```

`PropertyChanged``timeline`即使在绑定设置并`timeline`呈现后，处理程序仍然为空。我究竟做错了什么？

**编辑**：

我在 xaml 中声明 timeTextBox 和时间线如下：

```
<StackPanel Orientation="Horizontal" Margin="0,10,0,5" HorizontalAlignment="Center" VerticalAlignment="Center">
    <TextBox Name="timeTextBox" Margin="0,0,20,0" VerticalAlignment="Center" HorizontalContentAlignment="Center" Height="20" 
                            FontFamily="Tahoma" FontSize="14" BorderBrush="White" Background="White"/>

    <Button Name="playButton" Style="{StaticResource buttonStyle}" Click="PlayButton_Click" Margin="0,0,5,0" HorizontalAlignment="Center" 
                        VerticalAlignment="Center">
                    Play
    </Button>

    <Button Name="stopButton" Style="{StaticResource buttonStyle}" Click="StopButton_Click" Margin="0,0,20,0" HorizontalAlignment="Center" 
                        VerticalAlignment="Center">
                    Stop
    </Button>

    <Slider Name="controlSlider" Height="Auto" Width="200" HorizontalAlignment="Center" VerticalAlignment="Center" IsEnabled="False">
      <Slider.ToolTip>
        <TextBlock Style="{StaticResource textStyleTextBlock}">Time Slider</TextBlock>
      </Slider.ToolTip>
    </Slider>
</StackPanel>

<ScrollViewer Name="scrollViewer" Margin="0,0,10,20" Height="500" HorizontalAlignment="Stretch" VerticalAlignment="Center" Focusable="False"
                      HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
  <StackPanel>
    <UI:FittingCanvas x:Name="containerCanvas">
      <timelinePanel:Timeline x:Name="timeline" TimeCursorEnabled="True" TimeMode="Minutes"  Canvas.Left="0" Canvas.Top="0" Canvas.ZIndex="0" Visibility="Hidden"
                                                CursorAnimBoundaryChanged="Timeline_CursorAnimBoundaryChanged" AnimationCompleted="Timeline_AnimationCompleted"/>
    </UI:FittingCanvas>

    <Canvas x:Name="waveFormCanvas" Height="80" Margin="0,10,0,0"/>
  </StackPanel>
</ScrollViewer> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T23:59:51.710

您的代码是否`timeTextBox.Text`以任何其他方式更新而不是设置`timeTextBinding`？也许您直接在代码隐藏中将 timeTextBox.Text 设置为某个值，或者您有其他绑定？

因为 timeTextBinding 只是*OneWay*，所以这样的更改无法写回`TimeTextBindingProp`，并且绑定将被简单地覆盖和删除（没有任何警告），并将`timeline.PropertyChanged`重置为`null`。

# git - git pull 何时导致多个分支之间的合并？

> ID：14266010
> 
> 赞同：1
> 
> 时间：2013-01-10T19:45:05.930
> 
> 标签：git, git-merge, git-pull, git-subtree

我试图了解导致 git 在切换到开发分支后将我正在处理的功能分支合并到主开发分支的情况。

我能够恢复合并，但花了一天的大部分时间才能完全解决，我想在将来避免它。

这是工作流程：

在我的功能分支上工作后，我需要修复错误。我的功能分支 (refs/heads/feature/uploader/90) 与主开发分支保持同步：

```
git merge origin/develop 
```

然后我需要切换到开发分支：

```
git checkout develop 
```

git输出：

*切换到分支 'develop' 你的分支落后于 'origin/develop' 88 次提交，并且可以快进。*

然后当我发出拉动时：

```
git pull origin refs/heads/develop 
```

出于某种原因，看起来 git 决定将我的功能分支合并到开发中，输出如下所示：

```
branch develop -> FETCH_HEAD
Fast-forwarding to: 102301bcc51fc6d7978e5287df9d031d82e53bc9
Trying simple merge with d139bab0a96df01408f82110e38b6e0b6b98e6e6
Merge made by the 'octopus' strategy. 
```

我的提交日志显示我正在提交： *Merge branch 'feature/uploader/90' and 'develop' of github.com:MakerStudios/dashboard into develop*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:52:51.963

这就是所谓的*快进合并*。

每当您进行合并时（默认情况下）都会发生这种情况，其中您所在的分支中的所有更改都已经存在于您尝试合并的分支中。

因此，由于在您上面的示例中`refs/heads/feature/uploader/90`已经包含所有更改`refs/heads/develop`，而不是创建真正的合并提交，`git`只需移动 ref`develop`以指向与`feature/uploader/90`.

`git merge --no-ff`您可以通过执行不会快进或将`merge.ff`属性更改为来避免这种行为`false`。

撤消不需要的快进合并并不像您想象的那么困难：只是`git reset --hard`到合并中的内容之前的最后一次提交。

# c++ - 跨 g++ 编译器链接器错误

> ID：14266012
> 
> 赞同：2
> 
> 时间：2013-01-10T19:45:13.027
> 
> 标签：c++, c, arm, eclipse-cdt, atmel

我正在使用[Eclipse](http://en.wikipedia.org/wiki/Eclipse_%28software%29)为 ARM 处理器交叉编译一个 g++ 项目。我在 Windows 环境中使用 yagarto 工具链。我对 C 项目没有任何问题，但是对于 C++，我不断收到错误：

```
libc.a(lib_a-abort.o): In function `abort':
abort.c:63: undefined reference to `_exit'

libc.a(lib_a-sbrkr.o): In function `_sbrk_r':
sbrkr.c:58 undefined reference to `_sbrk'

libc.a(lib_a-signalr.o): In function `_kill_r':
signalr.c:61: undefined reference to `_kill' 
```

也：

```
undefined reference to `_getpid'
undefined reference to `_write'
undefined reference to `_close'
undefined reference to `_fstat'
undefined reference to `_isatty'
undefined reference to `_lseek'
undefined reference to `_read' 
```

环顾四周，我似乎遇到了链接器问题。我试图添加链接器 flash.ld。它来自 Atmel Studio 的 ARM 开发套件的 GCC 示例。这没有帮助。某处是否有用于 g++ 的链接器？我还有其他问题吗？

这是我的构建选项：

```
make all
Building target: Foo
Invoking: Cross G++ Linker
arm-none-eabi-g++ -nostartfiles -T C:/Users/kempsa/eclipse_workspace/Foo/flash.ld -o"Foo"  ./HALTimer1.o ./Main.o 
```

我有源文件 Main.cpp、HALTimer1.cpp 和头文件 Haltimer.h。主文件只包含头文件。头文件只定义了一个带有一个变量的 HALTimer 类。我不相信这些会影响错误。我相信这个错误完全是因为在没有正确链接器文件的情况下构建了一个 g++ 项目。

这是链接器文件的内容：

```
/**
 * \file
 *
 * \brief Flash Linker script for SAM.
 *
 * Copyright (c) 2011-2012 Atmel Corporation. All rights reserved.
 *

    OUTPUT_FORMAT("elf32-littlearm", "elf32-littlearm", "elf32-littlearm")
    OUTPUT_ARCH(arm)
    SEARCH_DIR(.)

    /* Memory Spaces Definitions */
    MEMORY
    {
        rom (rx)  : ORIGIN = 0x00400000, LENGTH = 0x00040000 /* flash has two banks, one bank = 256K */
    ram (rwx) : ORIGIN = 0x20000000, LENGTH = 0x00010000 /* sram, 64K */
    }

    /* The stack size used by the application. NOTE: you need to adjust  */
    __stack_size__ = DEFINED(__stack_size__) ? __stack_size__ : 0x2000;

    /* Section Definitions */
    SECTIONS
    {
        .text :
        {
            . = ALIGN(4);
            _sfixed = .;
            KEEP(*(.vectors .vectors.*))
            *(.text .text.* .gnu.linkonce.t.*)
        *(.glue_7t) *(.glue_7)
        *(.rodata .rodata* .gnu.linkonce.r.*)
        *(.ARM.extab* .gnu.linkonce.armextab.*)

        /* Support C constructors, and C destructors in both user code
           and the C library. This also provides support for C++ code. */
        . = ALIGN(4);
        KEEP(*(.init))
        . = ALIGN(4);
        __preinit_array_start = .;
        KEEP (*(.preinit_array))
        __preinit_array_end = .;

        . = ALIGN(4);
        __init_array_start = .;
        KEEP (*(SORT(.init_array.*)))
        KEEP (*(.init_array))
        __init_array_end = .;

        . = ALIGN(0x4);
        KEEP (*crtbegin.o(.ctors))
        KEEP (*(EXCLUDE_FILE (*crtend.o) .ctors))
        KEEP (*(SORT(.ctors.*)))
        KEEP (*crtend.o(.ctors))

        . = ALIGN(4);
        KEEP(*(.fini))

        . = ALIGN(4);
        __fini_array_start = .;
        KEEP (*(.fini_array))
        KEEP (*(SORT(.fini_array.*)))
        __fini_array_end = .;

        KEEP (*crtbegin.o(.dtors))
        KEEP (*(EXCLUDE_FILE (*crtend.o) .dtors))
        KEEP (*(SORT(.dtors.*)))
        KEEP (*crtend.o(.dtors))

        . = ALIGN(4);
        _efixed = .;            /* End of text section */
    } > rom

    /* .ARM.exidx is sorted, so has to go in its own output section.  */
    PROVIDE_HIDDEN (__exidx_start = .);
    .ARM.exidx :
    {
      *(.ARM.exidx* .gnu.linkonce.armexidx.*)
    } > rom
    PROVIDE_HIDDEN (__exidx_end = .);

    . = ALIGN(4);
    _etext = .;

    .relocate : AT (_etext)
    {
        . = ALIGN(4);
        _srelocate = .;
        *(.ramfunc .ramfunc.*);
        *(.data .data.*);
        . = ALIGN(4);
        _erelocate = .;
    } > ram

    /* .bss section which is used for uninitialized data */
    .bss (NOLOAD) :
    {
        . = ALIGN(4);
        _sbss = . ;
        _szero = .;
        *(.bss .bss.*)
        *(COMMON)
        . = ALIGN(4);
        _ebss = . ;
        _ezero = .;
    } > ram

    /* stack section */
    .stack (NOLOAD):
    {
        . = ALIGN(8);
          _sstack = .;
        . = . + __stack_size__;
        . = ALIGN(8);
        _estack = .;
    } > ram

    . = ALIGN(4);
    _end = . ;
} 
```

完整的编译器输出：

```
Building target: Foo
Invoking: Cross G++ Linker
arm-none-eabi-g++ -nostartfiles -T C:/Users/kempsa/eclipse_workspace/Foo/flash.ld -o"Foo"      ./HALTimer.o ./Main.o
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-abort.o): In function `abort':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\stdlib/../../../../../newlib-1.20.0/newlib/libc/stdlib/abort.c:63: undefined reference to `_exit'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-sbrkr.o): In function `_sbrk_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/sbrkr.c:58: undefined reference to `_sbrk'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-signalr.o): In function `_kill_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/signalr.c:61: undefined reference to `_kill'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-signalr.o): In function `_getpid_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/signalr.c:96: undefined reference to `_getpid'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-writer.o): In function `_write_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/writer.c:58: undefined reference to `_write'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-closer.o): In function `_close_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/closer.c:53: undefined reference to `_close'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-fstatr.o): In function `_fstat_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/fstatr.c:62: undefined reference to `_fstat'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-isattyr.o): In function `_isatty_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/isattyr.c:58: undefined reference to `_isatty'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-lseekr.o): In function `_lseek_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/lseekr.c:58: undefined reference to `_lseek'
c:/yagarto/bin/../lib/gcc/arm-none-eabi/4.7.2/../../../../arm-none-eabi/lib\libc.a(lib_a-readr.o): In function `_read_r':
C:\msys\1.0\home\yagarto\newlib-build\arm-none-eabi\newlib\libc\reent/../../../../../newlib-1.20.0/newlib/libc/reent/readr.c:58: undefined reference to `_read'
collect2.exe: error: ld returned 1 exit status
make: *** [Foo] Error 1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:26:19.867

添加链接器选项 -Wl,--gc-sections 应该可以解决问题

# java - 为什么 FileChannel.tryLock 不阻止跨多个进程的访问？

> ID：14266016
> 
> 赞同：1
> 
> 时间：2013-01-10T19:45:26.853
> 
> 标签：java

> **可能重复：**
> [Java 文件锁定机制问题（FileLock 等）](https://stackoverflow.com/questions/2479222/problem-with-java-file-locking-mechanism-filelock-etc)

在下面的代码中，我想测试这个`FileLock`类。

```
import java.io.File;
import java.nio.channels.*;
import java.nio.MappedByteBuffer;
import java.io.RandomAccessFile;

class test{
    File f= new File("./in.txt");
    RandomAccessFile in = new RandomAccessFile(f, "rw");
    FileChannel fc = in.getChannel();

    byte[] t = new byte[20];
    in.read(t, 0, 8);
    System.out.println(new String(t));

    FileLock fl = fc.tryLock(0, 4, false);
    if(fl!=null){
        System.out.println("the file has been locked");
        Thread.sleep(10000);
        fl.release();
        System.out.println("no lock!");
    }
    fc.close();
    in.close();
    }
}; 
```

但问题是，当我运行“java test”两次时，第一个应该锁定文件 in.txt，第二个不应该访问 in.txt，然后不应该在屏幕上打印任何内容。但事实是第二个也在屏幕上打印字符串，即使它按预期返回。并且从 0 到第 3 个字节的区域不应该被其他人读取。但事实上并非如此。

但似乎有些不对劲。如果文件被独占锁定，则其他人无法访问它。但似乎不是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:16:28.863

FileLock 在 Linux 下不起作用（至少不是我上次尝试的 redhat）。编辑：那不是真的。我做错了:-)

在 windows Vista/7/8 下，我上次尝试时它工作正常。

也许有适用于 linux 的文件系统实现。您必须使用创建 [file].lck 临时文件来模拟锁定（尽管在 File.create 的文档中不建议这样做）。

如果文件不存在，有一种特殊的原子方法来创建文件

# unit-testing - WCF 调用在构建服务器上的单元测试中失败

> ID：14266028
> 
> 赞同：0
> 
> 时间：2013-01-10T19:46:12.397
> 
> 标签：unit-testing, msbuild

我们正在运行更新的 2008 服务器，在开发机器上运行 TFS 2012 和 VS 2012。该解决方案使用 MSBuild 在服务器上部署和运行测试。所有测试都通过了开发框，但只有不调用本地部署的 WCF 服务器（托管在 IIS 中）的测试失败。所有服务调用的例外情况如下：

```
>     Test method TestProject.TestClass.TestMethod threw exception: 
>     System.ServiceModel.CommunicationObjectFaultedException: The communication object, System.ServiceModel.Channels.ServiceChannel,
> cannot be used for communication because it is in the Faulted state.
>      
>     Server stack trace: 
>        at System.ServiceModel.Channels.CommunicationObject.Close(TimeSpan
> timeout)
>        at System.ServiceModel.Channels.ServiceChannel.System.IDisposable.Dispose()
>     Exception rethrown at [0
enter code here 
```

NETWORK SERVICE 具有相应的权限。电源已打开。有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T23:49:13.120

解决了。首先介绍一下**设置**的背景：

有问题的服务配置了用户名身份验证，利用 SQL 成员资格提供程序和服务证书。授权是使用 ASP.NET 角色提供程序完成的。正在使用的绑定是一个 NetTcpBinding，消息安全已打开并配置为用户名。

**结果问题**如下：我本地盒子上的MSBuild和MSTest在我的帐户下运行。在这里，我在本地生成的用于授权的证书被添加到 Current User \ Trusted People 中，这很好；但是在构建框上，因为 MSBuild 和 MSTest 在 NETWORK SERVICE 下运行，WCF 拒绝了握手。**此问题的解决方案**是将测试证书添加到本地计算机\受信任的人存储。

# ruby - Ruby 中的“顶级上下文对象”是否类似于 JavaScript 中的全局上下文？

> ID：14266037
> 
> 赞同：2
> 
> 时间：2013-01-10T19:46:34.127
> 
> 标签：ruby, global-object

假设我编写了一个没有类定义的 Ruby 脚本。我仍然可以创建类变量和类级实例变量：

```
@@var = "class variable!";
@var = "class instance variable!";

puts @@var;
puts @var; 
```

这些变量属于顶级上下文对象。

这个顶级上下文对象是否类似于[JavaScript](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this#Global_context)中的全局上下文，因为它可以用作一种顶级命名空间？例如，有没有办法在 Ruby 中使用“顶级上下文对象”来做这样的事情？

```
var arrStore1 = new Ext.data.ArrayStore({/*...*/});
/* same call again, using the global context object */
var global = window;
var arrStore2 = new global.Ext.data.ArrayStore({/*...*/}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:58:28.447

顶级对象与任何其他 ruby​​ 对象一样。您可以在其中包含模块，它可以具有实例变量。但这并不是真正的全球背景。

有关更多详细信息，请参阅 SO：[Ruby 中的“主要”是什么？](https://stackoverflow.com/questions/917811/what-is-main-in-ruby)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:21:40.490

几乎总是最好创建某种顶级名称空间条目并将您的全局或准全局变量放在那里：

```
module GlobalOptions
  def self.option
    @option
  end

  def self.option=(value)
    @option = value
  end
end

GlobalOptions.option = :foo
GlobalOptions.option
# => :foo 
```

在 Rails 内部，您`mattr_accessor`可以自动为您生成这些内容。

# c - Mac OS X - 为什么 netstat 给出错误“得到 %d 两次”？

> ID：14266042
> 
> 赞同：1
> 
> 时间：2013-01-10T19:46:46.147
> 
> 标签：c, macos, freebsd, netstat, darwin

我试图弄清楚为什么`netstat`在我的 Mac OS X 计算机上打印“两次获得 4”之类的东西。

例如：

```
$ netstat | head -15
Active Internet connections
Proto Recv-Q Send-Q  Local Address          Foreign Address        (state)    
[...]
tcp4       0      0  localhost.56892        localhost.26164        ESTABLISHED
got 4 twice
got 16 twice
got 1 twice
got 4 twice
got 4 twice
got 8 twice 
```

该消息由 netstat 的[inet.c](http://www.opensource.apple.com/source/network_cmds/network_cmds-356.8/netstat.tproj/inet.c)打印，在该函数`protopr`中基本上执行以下操作：

*   调用`sysctlbyname(3)`使用例如`net.inet.tcp.pcblist_n`获取多氯联苯列表（我猜？）
*   循环遍历结果，收集指向各种结构的指针，其类型称为`xgn_kind`
*   `xgn_kind`它为它看到的每一个设置一个位。如果它两次看到它们中的任何一个，它就会抱怨消息`"got %d twice"`。

我已经删除了代码的相关部分：

```
void
protopr(uint32_t proto,   /* for sysctl version we pass proto # */
    char *name, int af)
{
  /* ... */

  if (sysctlbyname(mibvar, 0, &len, 0, 0) < 0) {
    if (errno != ENOENT)
      warn("sysctl: %s", mibvar);
    return;
  }

  /* ... */

  for (next = buf + ROUNDUP64(xig->xig_len);
       next < buf + len;
       next += ROUNDUP64(xgn->xgn_len))
  {
    /* ... */

    if ((which & xgn->xgn_kind) == 0) {
      which |= xgn->xgn_kind;
      /* ... */
    } else {
      printf("got %d twice\n", xgn->xgn_kind);
    }

    /* ... */
} 
```

我的问题是，最后：

为什么会这样？是不是从那里传回了错误的数据`sysctl`？上面的循环是否不正确，即`sysctl`每种类型实际上可以返回多个结构？

请注意，我运行的是 Mac OS X —— 代码确实与[FreeBSD 的](http://svnweb.freebsd.org/csrg/usr.bin/netstat/inet.c?view=markup).

# c++ - 指向对象的 C++ 指针作为类成员

> ID：14266048
> 
> 赞同：0
> 
> 时间：2013-01-10T19:47:08.233
> 
> 标签：c++, pointers

我试图让两个不同的类相互交互，因为我在一个类中有一个指向另一个类的对象的指针，该对象在构造函数中指定。到目前为止，交互有效，我可以更改指向对象的参数，并且可以看到更改，因为我正在终端上打印它。但是当我尝试从该对象获取参数并尝试通过指向它的类将其打印到终端时，我只得到一个 Int 的零值，我知道这是调试输出的原因，它不是零，如果直接调用。我会给你一个代码示例：

## **A类：**

```
class Spieler
{
    private:
        int score;
        Schlaeger *schlaeger;
        int adc_wert;
        int channel;

    public:

        Spieler(int x, Schlaeger &schl, int adc_wert_c=0, int channel_c=0 )
        {
            score=x;
            schlaeger=&schl;
            adc_wert=adc_wert_c;
            channel=channel_c;
        }
    //....
        void set_schl(Schlaeger &schl){ schlaeger=&schl;}
        int getPosY(){ schlaeger->getSchlaeger_pos_y();}
        int getPosX(){ schlaeger->getSchlaeger_pos_x();}
        void setPosY(int y){ schlaeger->set_pos_y(y);}      

        void schlaeger_zeichen(){
            schlaeger->schlaeger_zeichen();
        }

        void schlaeger_bewegen(){
            schlaeger->schlaeger_bewegen(getADC());
        }
//...

}; 
```

## B类：

```
class Schlaeger
{
    private:
        int schlaeger_pos_x;
        int schlaeger_hoehe;
        int schlaeger_pos_y;
    public:

        Schlaeger(int x=0, int h=5, int pos_y=15)
        {
            schlaeger_pos_x=x;
            schlaeger_hoehe=h;
            schlaeger_pos_y=pos_y;
        }

        int getSchlaeger_pos_x()
        {
            return schlaeger_pos_x;
        }
        int getSchlaeger_pos_y()
        {
            return schlaeger_pos_y;
        }
        int getSchlaeger_hoehe()
        {
            return schlaeger_hoehe;
        }
        void set_pos_y(int new_y)
        {
            schlaeger_pos_y=new_y;
        }

}; 
```

对更改方法的调用有效，我可以看到更改，并且可以在调试输出中看到它。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T19:51:35.507

您没有返回 getter 中的值

```
int getPosY(){ schlaeger->getSchlaeger_pos_y();} 
```

应该

```
int getPosY(){ return schlaeger->getSchlaeger_pos_y();} 
```

# c# - 如何从 web 服务运行 powershell 脚本文件

> ID：14266050
> 
> 赞同：2
> 
> 时间：2013-01-10T19:47:10.423
> 
> 标签：c#, web-services, powershell, webserver, asmx

我创建了一个网络服务，我想从网络服务运行一个 powershell 脚本。我已将 .ps1 文件存储在存储 Web 服务的服务器的 c:\ 上。当我调用 Web 服务时，我收到一条错误消息，提示“*术语 -- 方法名称 -- 未被识别为 cmdlet、函数、脚本文件或可运行程序的名称*。

**当我从服务器调用 web 服务时，它工作正常。**

这是我的方法：

```
[WebMethod]
public void RunUserProfileSync(string scriptText)
{
    RunspaceConfiguration runspaceConfiguration = RunspaceConfiguration.Create();

    Runspace runspace = RunspaceFactory.CreateRunspace(runspaceConfiguration);
    runspace.Open();

    RunspaceInvoke scriptInvoker = new RunspaceInvoke(runspace);

    Pipeline pipeline = runspace.CreatePipeline();
    pipeline.Commands.Add(scriptText);

    // Execute PowerShell script
    pipeline.Invoke();
} 
```

因此，在调用 webmethod 时，我将“c:\nameofile.ps1”放在参数中。

我应该怎么做才能纠正这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:53:25.083

您应该使用[AddScript](http://msdn.microsoft.com/en-us/library/ms569106%28v=vs.85%29.aspx)方法而不是 Add 方法。现在它正在尝试查找单个命令，而您的脚本可能有多个命令。

编辑：您也可以尝试读取文件的内容，然后将其传递给 AddScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-02-10T17:09:49.590

现在这种方法可能有点矫枉过正，但如果您的脚本需要执行更强大的操作（例如与用户交互或显示 UI），则值得分享。如果不是这种情况，请不要选择这种方法。如果是，此方法将 Web 服务应用程序池作为 SYSTEM 帐户运行，然后该帐户有权在任何用户会话（不仅仅是会话 0）中运行您的脚本，如下所示：

```
[DllImport("kernel32.dll")]
        private static extern IntPtr OpenProcess(uint dwDesiredAccess, bool bInheritHandle, uint dwProcessId);

        [DllImport("advapi32", SetLastError = true), SuppressUnmanagedCodeSecurityAttribute]
        private static extern int OpenProcessToken(System.IntPtr ProcessHandle, int DesiredAccess, ref IntPtr TokenHandle);

        [DllImport("kernel32", SetLastError = true), SuppressUnmanagedCodeSecurityAttribute]
        private static extern bool CloseHandle(IntPtr handle);

        [DllImport("advapi32.dll", CharSet = CharSet.Auto, SetLastError = true)]
        private static extern bool DuplicateTokenEx(IntPtr ExistingTokenHandle, uint dwDesiredAccess, IntPtr lpThreadAttributes, int TokenType, int ImpersonationLevel, ref IntPtr DuplicateTokenHandle);

        [DllImport("advapi32.dll", EntryPoint = "DuplicateTokenEx")]
        extern static Boolean DuplicateTokenEx(IntPtr ExistingTokenHandle, UInt32 dwDesiredAccess, ref SECURITY_ATTRIBUTES lpThreadAttributes, Int32 TokenType, Int32 ImpersonationLevel, ref IntPtr DuplicateTokenHandle);

        [DllImport("advapi32.dll", EntryPoint = "CreateProcessAsUser", SetLastError = true, CharSet = CharSet.Ansi, CallingConvention = CallingConvention.StdCall)]
        private extern static bool CreateProcessAsUser(IntPtr hToken, String lpApplicationName, String lpCommandLine, ref SECURITY_ATTRIBUTES lpProcessAttributes, ref SECURITY_ATTRIBUTES lpThreadAttributes, bool bInheritHandle, int dwCreationFlags, IntPtr lpEnvironment, String lpCurrentDirectory, ref STARTUPINFO lpStartupInfo, out PROCESS_INFORMATION lpProcessInformation);

        #region Win32 Constants

        private const int NORMAL_PRIORITY_CLASS = 0x00000020;
        private const int CREATE_UNICODE_ENVIRONMENT = 0x00000400;
        private const int CREATE_NO_WINDOW = 0x08000000;
        private const int CREATE_NEW_CONSOLE = 0x00000010;
        private const uint INVALID_SESSION_ID = 0xFFFFFFFF;
        private static readonly IntPtr WTS_CURRENT_SERVER_HANDLE = IntPtr.Zero;
        private const int TOKEN_DUPLICATE = 2;
        private const int TOKEN_QUERY = 0X00000008;
        private const int TOKEN_IMPERSONATE = 0X00000004;
        private const uint MAXIMUM_ALLOWED = 0x2000000;
        private const uint PROCESS_QUERY_LIMITED_INFORMATION = 0x1000;
        private const uint PROCESS_QUERY_INFORMATION = 0x0400;

        #endregion

        #region Win32 Structs

        private enum SW
        {
            SW_HIDE = 0,
            SW_SHOWNORMAL = 1,
            SW_NORMAL = 1,
            SW_SHOWMINIMIZED = 2,
            SW_SHOWMAXIMIZED = 3,
            SW_MAXIMIZE = 3,
            SW_SHOWNOACTIVATE = 4,
            SW_SHOW = 5,
            SW_MINIMIZE = 6,
            SW_SHOWMINNOACTIVE = 7,
            SW_SHOWNA = 8,
            SW_RESTORE = 9,
            SW_SHOWDEFAULT = 10,
            SW_MAX = 10
        }

        private enum WTS_CONNECTSTATE_CLASS
        {
            WTSActive,
            WTSConnected,
            WTSConnectQuery,
            WTSShadow,
            WTSDisconnected,
            WTSIdle,
            WTSListen,
            WTSReset,
            WTSDown,
            WTSInit
        }

        [StructLayout(LayoutKind.Sequential)]
        private struct PROCESS_INFORMATION
        {
            public IntPtr hProcess;
            public IntPtr hThread;
            public uint dwProcessId;
            public uint dwThreadId;
        }

        private enum SECURITY_IMPERSONATION_LEVEL
        {
            SecurityAnonymous = 0,
            SecurityIdentification = 1,
            SecurityImpersonation = 2,
            SecurityDelegation = 3,
        }

        [StructLayout(LayoutKind.Sequential)]
        private struct STARTUPINFO
        {
            public int cb;
            public String lpReserved;
            public String lpDesktop;
            public String lpTitle;
            public uint dwX;
            public uint dwY;
            public uint dwXSize;
            public uint dwYSize;
            public uint dwXCountChars;
            public uint dwYCountChars;
            public uint dwFillAttribute;
            public uint dwFlags;
            public short wShowWindow;
            public short cbReserved2;
            public IntPtr lpReserved2;
            public IntPtr hStdInput;
            public IntPtr hStdOutput;
            public IntPtr hStdError;
        }

        private enum TOKEN_TYPE
        {
            TokenPrimary = 1,
            TokenImpersonation = 2
        }

        [StructLayout(LayoutKind.Sequential)]
        private struct WTS_SESSION_INFO
        {
            public readonly UInt32 SessionID;

            [MarshalAs(UnmanagedType.LPStr)]
            public readonly String pWinStationName;

            public readonly WTS_CONNECTSTATE_CLASS State;
        }

        [StructLayout(LayoutKind.Sequential)]
        public struct SECURITY_ATTRIBUTES
        {
            public int Length;
            public IntPtr lpSecurityDescriptor;
            public bool bInheritHandle;
        } 
```

然后，您可以运行类似于我的功能，如下所示：

```
 public string Get(string YOURSCRIPT)
        {
            string command = "C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -File " + YOURSCRIPT;
            bool isSuccessful = false;
            int targetSessionId = 1;
            uint targetWinlogonProcessId = 0;
            IntPtr hToken = IntPtr.Zero, hTokenDup = IntPtr.Zero;
            var procInfo = new PROCESS_INFORMATION();

            Process[] processes = Process.GetProcessesByName("winlogon");
            foreach (Process p in processes)
            {
                if ((uint)p.SessionId == targetSessionId)
                {
                    targetWinlogonProcessId = (uint)p.Id;
                }
            }

            IntPtr hProcess = OpenProcess(MAXIMUM_ALLOWED, false, targetWinlogonProcessId);

            if (OpenProcessToken(hProcess, TOKEN_DUPLICATE, ref hToken) != 0)
            {
                SECURITY_ATTRIBUTES sa = new SECURITY_ATTRIBUTES();
                sa.Length = Marshal.SizeOf(sa);
                if (DuplicateTokenEx(hToken, MAXIMUM_ALLOWED, ref sa, (int)SECURITY_IMPERSONATION_LEVEL.SecurityIdentification, (int)TOKEN_TYPE.TokenPrimary, ref hTokenDup))
                {
                    STARTUPINFO si = new STARTUPINFO();
                    si.cb = (int)Marshal.SizeOf(si);

                    // interactive window station parameter; basically this indicates 
                    // that the process created can display a GUI on the desktop
                    si.lpDesktop = "winsta0\\default";

                    // flags that specify the priority and creation method of the process
                    int dwCreationFlags = NORMAL_PRIORITY_CLASS | CREATE_NEW_CONSOLE;

                    // create a new process in the current User's logon session
                    if (CreateProcessAsUser(hTokenDup,  // client's access token
                                                    null,             // file to execute
                                                    command,          // command line
                                                    ref sa,           // pointer to process SECURITY_ATTRIBUTES
                                                    ref sa,           // pointer to thread SECURITY_ATTRIBUTES
                                                    false,            // handles are not inheritable
                                                    dwCreationFlags,  // creation flags
                                                    IntPtr.Zero,      // pointer to new environment block 
                                                    null,             // name of current directory 
                                                    ref si,           // pointer to STARTUPINFO structure
                                                    out procInfo      // receives information about new process
                                                    ))
                    {
                        isSuccessful = true;
                    }
                    else
                    {
                        int error = Marshal.GetLastWin32Error();
                        int hr = Marshal.GetHRForLastWin32Error();
                    }

                }
                else
                {
                    CloseHandle(hProcess);
                    CloseHandle(hToken);
                }                
            }
            else
                CloseHandle(hProcess);

            return isSuccessful.ToString();
        } 
```

# java - 嵌套类的构造函数问题

> ID：14266052
> 
> 赞同：15
> 
> 时间：2013-01-10T19:47:36.050
> 
> 标签：java, reflection, nested-class

* * *

> 这个问题是关于 Java 的有趣行为：在某些情况下，它会为嵌套类生成额外的（非默认）构造函数。
> 
> 这个问题也是关于奇怪的匿名类，Java 用那个奇怪的构造函数生成的。

* * *

考虑以下代码：

```
package a;

import java.lang.reflect.Constructor;

public class TestNested {    
    class A {    
        A() {
        }   

        A(int a) {
        }
    }    

    public static void main(String[] args) {
        Class<A> aClass = A.class;
        for (Constructor c : aClass.getDeclaredConstructors()) {
            System.out.println(c);
        }

    }
} 
```

这将打印：

```
a.TestNested$A(a.TestNested)
a.TestNested$A(a.TestNested,int) 
```

行。接下来，让构造函数`A(int a)`私有：

```
 private A(int a) {
    } 
```

再次运行程序。收到：

```
a.TestNested$A(a.TestNested)
private a.TestNested$A(a.TestNested,int) 
```

它也可以。但是现在，让我们`main()`以这种方式修改方法（添加新的类`A`创建实例）：

```
public static void main(String[] args) {
    Class<A> aClass = A.class;
    for (Constructor c : aClass.getDeclaredConstructors()) {
        System.out.println(c);
    }

    A a = new TestNested().new A(123);  // new line of code
} 
```

然后输入变为：

```
a.TestNested$A(a.TestNested)
private a.TestNested$A(a.TestNested,int)
a.TestNested$A(a.TestNested,int,a.TestNested$1) 
```

它是什么：**a.TestNested$A(a.TestNested,int,a.TestNested$1)** <<<---??

好的，让我们再次将构造函数`A(int a)`包本地化：

```
 A(int a) {
    } 
```

再次运行程序（我们**不删除**创建实例的行`A`！），输出与第一次一样：

```
a.TestNested$A(a.TestNested)
a.TestNested$A(a.TestNested,int) 
```

* * *

**问题：**

**1）**这怎么解释？

**2）**这第三个奇怪的构造函数是什么？

* * *

**更新：**调查显示如下。

1）让我们尝试使用来自其他类的反射来调用这个奇怪的构造函数。我们将无法做到这一点，因为没有任何方法可以创建那个奇怪`TestNested$1`类的实例。

2）好的。让我们做的伎俩。让我们在类中添加`TestNested`这样的静态字段：

```
public static Object object = new Object() {
    public void print() {
        System.out.println("sss");
    }
}; 
```

好？好的，现在我们可以从另一个类中调用这第三个奇怪的构造函数：

```
 TestNested tn = new TestNested();
    TestNested.A a = (TestNested.A)TestNested.A.class.getDeclaredConstructors()[2].newInstance(tn, 123, TestNested.object); 
```

对不起，但我完全不明白。

* * *

**UPDATE-2：**进一步的问题是：

**3)**为什么 Java 使用特殊的匿名内部类作为第三个合成构造函数的参数类型？为什么不只`Object`键入具有特殊名称的构造函数？

**4）**什么Java可以使用已经定义的匿名内部类来实现这些目的？这不是某种违反安全的行为吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T21:12:36.190

第三个构造函数是编译器生成的*合成*构造函数，以便允许从外部类访问私有构造函数。这是因为内部类（以及它们的封闭类对其私有成员的访问）只存在于 Java 语言而不是 JVM，因此编译器必须在幕后弥合差距。

反射会告诉你一个成员是否是合成的：

```
for (Constructor c : aClass.getDeclaredConstructors()) {
    System.out.println(c + " " + c.isSynthetic());
} 
```

这打印：

```
a.TestNested$A(a.TestNested) false
private a.TestNested$A(a.TestNested,int) false
a.TestNested$A(a.TestNested,int,a.TestNested$1) true 
```

请参阅此帖子以进行进一步讨论：[Eclipse 警告关于 Java 中私有静态嵌套类的合成访问器？](https://stackoverflow.com/q/921025/697449)

**编辑：**有趣的是，eclipse 编译器的做法与 javac 不同。使用 eclipse 时，它​​会添加一个内部类本身类型的参数：

```
a.TestNested$A(a.TestNested) false
private a.TestNested$A(a.TestNested,int) false
a.TestNested$A(a.TestNested,int,a.TestNested$A) true 
```

我试图通过提前暴露该构造函数来将其绊倒：

```
class A {    
    A() {
    }   

    private A(int a) {
    }

    A(int a, A another) { }
} 
```

它通过简单地向合成构造函数添加另一个参数来处理这个问题：

```
a.TestNested$A(a.TestNested) false
private a.TestNested$A(a.TestNested,int) false
a.TestNested$A(a.TestNested,int,a.TestNested$A) false
a.TestNested$A(a.TestNested,int,a.TestNested$A,a.TestNested$A) true 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-10T21:23:20.947

首先，感谢您提出这个有趣的问题。我太感兴趣了，忍不住看了一下字节码。这是的字节码`TestNested`：

```
Compiled from "TestNested.java"
  public class a.TestNested {
    public a.TestNested();
      Code:
         0: aload_0       
         1: invokespecial #1                  // Method java/lang/Object."<init>":()V
         4: return        

    public static void main(java.lang.String[]);
      Code:
         0: ldc_w         #2                  // class a/TestNested$A
         3: astore_1      
         4: aload_1       
         5: invokevirtual #3                  // Method java/lang/Class.getDeclaredConstructors:()[Ljava/lang/reflect/Constructor;
         8: astore_2      
         9: aload_2       
        10: arraylength   
        11: istore_3      
        12: iconst_0      
        13: istore        4
        15: iload         4
        17: iload_3       
        18: if_icmpge     41
        21: aload_2       
        22: iload         4
        24: aaload        
        25: astore        5
        27: getstatic     #4                  // Field java/lang/System.out:Ljava/io/PrintStream;
        30: aload         5
        32: invokevirtual #5                  // Method java/io/PrintStream.println:(Ljava/lang/Object;)V
        35: iinc          4, 1
        38: goto          15
        41: new           #2                  // class a/TestNested$A
        44: dup           
        45: new           #6                  // class a/TestNested
        48: dup           
        49: invokespecial #7                  // Method "<init>":()V
        52: dup           
        53: invokevirtual #8                  // Method java/lang/Object.getClass:()Ljava/lang/Class;
        56: pop           
        57: bipush        123
        59: aconst_null   
        60: invokespecial #9                  // Method a/TestNested$A."<init>":(La/TestNested;ILa/TestNested$1;)V
        63: astore_2      
        64: return        
  } 
```

如您所见，构造函数是从您的方法`a.TestNested$A(a.TestNested,int,a.TestNested$1)`中调用的。`main`此外，`null`作为参数的值传递`a.TestNested$1`。

那么让我们来看看神秘的匿名类`a.TestNested$1`：

```
Compiled from "TestNested.java"
class a.TestNested$1 {
} 
```

奇怪 - 我本来希望这门课真的能做点什么。为了理解它，让我们看一下构造函数`a.TestNested$A`： class a.TestNested$A { final a.TestNested this$0;

```
 a.TestNested$A(a.TestNested);
    Code:
       0: aload_0       
       1: aload_1       
       2: putfield      #2                  // Field this$0:La/TestNested;
       5: aload_0       
       6: invokespecial #3                  // Method java/lang/Object."<init>":()V
       9: return        

  private a.TestNested$A(a.TestNested, int);
    Code:
       0: aload_0       
       1: aload_1       
       2: putfield      #2                  // Field this$0:La/TestNested;
       5: aload_0       
       6: invokespecial #3                  // Method java/lang/Object."<init>":()V
       9: return        

  a.TestNested$A(a.TestNested, int, a.TestNested$1);
    Code:
       0: aload_0       
       1: aload_1       
       2: iload_2       
       3: invokespecial #1                  // Method "<init>":(La/TestNested;I)V
       6: return        
} 
```

查看 package-visible 构造函数`a.TestNested$A(a.TestNested, int, a.TestNested$1)`，我们可以看到第三个参数被忽略了。

现在我们可以解释构造函数和匿名内部类了。为了规避私有构造函数的可见性限制，需要额外的构造函数。这个额外的构造函数只是简单地委托给私有构造函数。但是，它不能具有与私有构造函数完全相同的签名。因此，添加了匿名内部类以提供唯一签名，而不会与其他可能的重载构造函数发生冲突，例如带有签名的构造函数`(int,int)`或`(int,Object)`. 由于这个匿名内部类只需要创建唯一签名，因此不需要实例化，也不需要有内容。

# c# - 使用C#从DetailView中删除数据后刷新GridView

> ID：14266054
> 
> 赞同：2
> 
> 时间：2013-01-10T19:47:41.923
> 
> 标签：c#, asp.net

当用户从 GridView 中选择任何记录时，我的 DetailView 将根据 GridView 的选择进行更新。所以我想做的是，当我从 DetailView 中删除任何内容时，我想刷新 GridView，所以基本上我不想在 GridView 中显示已删除的记录。我试图通过在我的连接和 SQL 语句之后进行数据绑定来解决这个问题，但它不会刷新它。需要注意的一点是，我使用的是 Accordion 窗格，但我的 gridview 和 detailview 都在同一个窗格上。我不确定这是否会破坏任何东西。这是我的代码：

```
protected void Refresh_ItemCommand(object sender, DetailsViewCommandEventArgs e)
    {
        if (e.CommandName.Equals("Delete", StringComparison.CurrentCultureIgnoreCase))
        {

            SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString);
            SqlDataAdapter da = new SqlDataAdapter("select ID, Name, Address from dbo.MyTable", con);
            DataTable dt = new DataTable();
            da.Fill(dt);
            Gridview1.DataSource = dt;
            Gridview1.DataBind();
        }

    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T20:10:32.590

您可以使用名为“ItemDeleted”的数据视图的事件，如下所示：

```
 DetailViewName_ItemDeleted(object sender, 
    DetailsViewDeletedEventArgs e)
  {
    // Refresh the GridView control after a new record is updated 
    // in the DetailsView control.
    GridViewName.DataBind();
  } 
```

以上代码来自[MSDN官方网站](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.detailsview.itemdeleted.aspx)，用于详细视图控制。

另一种方式（我更喜欢）是在`Page_load`过程中处理数据网格，因此当您在详细视图中按下删除按钮时，页面将执行回发。

因此，在该过程中，`Page_load`您可以调用另一个填充数据网格的过程。代码可能是这样的：

```
if (isPostback)
{
  FillGrid();    
} 

private void FillGrid()
{

SqlConnection con = new SqlConnection(ConfigurationManager.ConnectionStrings["MyConnectionString"].ConnectionString);
            SqlDataAdapter da = new SqlDataAdapter("select ID, Name, Address from dbo.MyTable", con);
            DataTable dt = new DataTable();
            da.Fill(dt);
            Gridview1.DataSource = dt;
            Gridview1.DataBind();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:08:48.407

您的代码没有显示实际删除记录的任何内容，因此可以理解的是，当您重新获取数据时仍然包含所有内容。

你需要做的是：

1.  执行sql语句删除记录
2.  重新获取数据
3.  重新绑定数据。

如果您遵循这 3 个步骤，它将起作用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T19:51:06.533

尝试使用在按下 DGV 中的删除键时调用的事件

```
private void DGV_DeleteKeyPressed(object sender, KeyEventArgs e)
{
    //enter code here
} 
```

# java - 更改缓冲图像的图片？

> ID：14266056
> 
> 赞同：0
> 
> 时间：2013-01-10T19:47:49.183
> 
> 标签：java, image, awt, bufferedimage

我想知道如何在调用动作时将正在加载的图片切换到缓冲图像中？

例如，如果缓冲图像当前正在加载“Hand.png”，我希望能够按下按钮或键，并让它加载“Foot.png”。我的动作监听器和缓冲图像设置正确，我只是不确定更改`BufferedImage`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:18:38.490

不要更改图像，创建多个图像并根据事件/动作显示不同的图像

# ios - 如何检测 NSString 是否包含特定字符？

> ID：14266059
> 
> 赞同：14
> 
> 时间：2013-01-10T19:48:05.420
> 
> 标签：ios, objective-c

我有一个 NSString 对象，例如：- ($45,0000)

现在我想知道这个字符串是否包含 ()

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2013-01-10T19:53:30.357

您是否要查找它是否包含至少一个`(`or `)`？您可以使用`-rangeOfCharacterFromSet:`：

```
NSCharacterSet *cset = [NSCharacterSet characterSetWithCharactersInString:@"()"];
NSRange range = [mystr rangeOfCharacterFromSet:cset];
if (range.location == NSNotFound) {
    // no ( or ) in the string
} else {
    // ( or ) are present
} 
```

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-10T22:17:31.147

如果给定的字符串包含给定的字符，下面的方法将返回 Yes

```
-(BOOL)doesString:(NSString *)string containCharacter:(char)character
{
    return [string rangeOfString:[NSString stringWithFormat:@"%c",character]].location != NSNotFound;
} 
```

您可以按如下方式使用它：

```
 NSString *s = @"abcdefg";

    if ([self doesString:s containCharacter:'a'])
        NSLog(@"'a' found");
    else
        NSLog(@"No 'a' found");

    if ([self doesString:s containCharacter:'h'])
        NSLog(@"'h' found");
    else
        NSLog(@"No 'h' found"); 
```

输出：

2013-01-11 11:15:03.830 CharFinder[17539:c07] 'a' 发现

2013-01-11 11:15:03.831 CharFinder[17539:c07] 找不到“h”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-05-24T05:55:27.410

```
- (bool) contains: (NSString*) substring {
    NSRange range = [self rangeOfString:substring];
    return range.location != NSNotFound;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-22T07:27:02.257

我在代码中使用了您的问题的通用答案。此代码包括以下规则： 1\. 没有特殊字符 2\. 至少一个大写字母和一个小英文字母 3\. 至少一个数字数字

```
 BOOL lowerCaseLetter,upperCaseLetter,digit,specialCharacter;
    int asciiValue;
    if([txtPassword.text length] >= 5)
    {
        for (int i = 0; i < [txtPassword.text length]; i++)
        {
            unichar c = [txtPassword.text characterAtIndex:i];
            if(!lowerCaseLetter)
            {
                lowerCaseLetter = [[NSCharacterSet lowercaseLetterCharacterSet] characterIsMember:c];
            }
            if(!upperCaseLetter)
            {
                upperCaseLetter = [[NSCharacterSet uppercaseLetterCharacterSet] characterIsMember:c];
            }
            if(!digit)
            {
                digit = [[NSCharacterSet decimalDigitCharacterSet] characterIsMember:c];
            }

            asciiValue = [txtPassword.text characterAtIndex:i];
            NSLog(@"ascii value---%d",asciiValue);
            if((asciiValue >=33&&asciiValue < 47)||(asciiValue>=58 && asciiValue<=64)||(asciiValue>=91 && asciiValue<=96)||(asciiValue>=91 && asciiValue<=96))
            {
                specialCharacter=1;
            }
            else
            {
                specialCharacter=0;
            }

        }

        if(specialCharacter==0 && digit && lowerCaseLetter && upperCaseLetter)
        {
            //do what u want
            NSLog(@"Valid Password %d",specialCharacter);
        }
        else
        {
            NSLog(@"Invalid Password %d",specialCharacter);
            UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Error"
                                                            message:@"Please Ensure that you have at least one lower case letter, one upper case letter, one digit and No Any special character"
                                                           delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil];
            [alert show];
        } 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-05-13T08:00:35.137

为什么总是使用 NSCharactorSet ？这是简单而强大的解决方案

```
NSString *textStr = @"This is String Containing / Character";

if ([textStr containsString:@"/"])
{
    NSLog(@"Found!!");
}
else
{
   NSLog(@"Not Found!!"); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-10T19:52:03.637

您可以使用

```
NSString rangeOfString: (NSString *) string 
```

见这里：[https](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html%23//apple_ref/occ/instm/NSString/rangeOfString) ://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSString_Class/Reference/NSString.html%23//apple_ref/occ/instm/NSString/rangeOfString ：

如果 NSRange 返回的属性 'location' 等于 NSNotFound，则该字符串不包含传递的字符串（或字符）。

# javascript - 将参数传递给 ANT javascript 任务？

> ID：14266062
> 
> 赞同：5
> 
> 时间：2013-01-10T19:48:16.003
> 
> 标签：javascript, ant

在我的 ANT 脚本中，我有时会[使用 Rhino 编写运行 javascript 的任务](http://ant.apache.org/manual/Tasks/script.html)。

但是，我不知道如何将参数传递给这些任务。有任何想法吗？

例如...这是此类任务的示例：

```
<script language="javascript"> <![CDATA[
//some nonsense to fake out rhino into thinking we've a dom, etc.
this.document = { "fake":true };
this.window = new Object( );
this.head = new Object( );
eval(''+new String(org.apache.tools.ant.util.FileUtils.readFully(new java.io.FileReader('coolJavascript.js'))));

//... do some stuff

var s = java.io.File.separator;
var fstream = new java.io.FileWriter( ".." + s + "build" + s + "web" + s + "js" + s + "coolChangedJavascript.js" );
var out = new java.io.BufferedWriter( fstream );
out.write( jsCode );
out.close( );
]]> </script> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-20T04:02:02.773

要使用脚本定义 ant 任务，您可以使用该`scriptdef`任务而不是`script`. 有`scriptdef`预定义的对象可以访问任务中的属性和嵌套元素。

这适用于从 Ant 中的 javascript 访问属性：

```
<scriptdef name="myFileCheck" language="javascript">
    <attribute name="myAttribute" />
    <![CDATA[
      importClass(java.io.File);
      importClass(java.io.FileReader);
      importClass(java.io.BufferedReader);
      var fileName = attributes.get("myAttribute"); //get attribute for scriptdef
      var reader = new BufferedReader(new FileReader(new File(fileName)));
      //... etc
      project.setProperty("my.result", result));
    ]]> 
</scriptdef> 
```

然后就可以去：`<myFileCheck myAttribute="./some.file" />`就像你做一个普​​通的蚂蚁任务一样。
如果需要，也可以使用文件集等，更多详细信息请访问：[http ://ant.apache.org/manual/Tasks/scriptdef.html](http://ant.apache.org/manual/Tasks/scriptdef.html)

好处是您可以在 ant 脚本中内联定义任务，而不是用 Java 编写它们，然后必须构建和包含类文件。

您将需要使用 Java1.6（或更高版本），或者在您的类路径中有 apache BSF。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T23:04:31.243

我想到了两个建议。首先，您可以从 javascript 中访问 Ant 属性。您参考的文档中有示例：

```
var x = project.getProperty( "my.property" ); 
```

可以在脚本中用于获取 XML 中设置的属性的值，可能像这样：

```
<property name="my.property" value="x" /> 
```

其次，您可能会考虑使用[`scriptdef`](http://ant.apache.org/manual/Tasks/scriptdef.html)，这将允许您定义可以从 javascript 轻松访问的属性和子元素。

# c++ - Visual Studio 无法识别某些类

> ID：14266064
> 
> 赞同：1
> 
> 时间：2013-01-10T19:48:21.400
> 
> 标签：c++, visual-studio-2010

我不断收到错误：

```
error C2146: syntax error : missing ';' before identifier 'mCameraFrame' 
```

对于代码行：

```
Frame mCameraFrame; 
```

很明显，我的框架类没有以某种方式被发现。我在这个文件中直接包含了 frame.h 头文件（它定义了 Frame 类）。为什么视觉工作室无法识别它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T19:52:17.460

错误来自之前的代码行，可能在头文件中。

例如：

```
struct foo
{
    int a;
}

Frame mCameraFrame; 
```

`;`注意 ?后面的缺失`}`？这使得`Frame`合法作为结构的实例，但现在缺少`;`before `mCameraFrame`，导致您报告的那种错误。

编译器不能`;`在之后报告丢失，`}`因为它无法知道那里应该有一个，因为在`Frame`它之后是完全合法的。

单个缺失`;`或缺失`}`导致错误报告比实际问题晚很多行，有时甚至是数百行，这并不罕见。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-15T16:18:33.000

我想我会向任何感兴趣的人报告。问题是应该定义 mCameraFrame 的 Frame 类位于不同的命名空间中，所以我所要做的就是“使用命名空间 ....;”。嗬！:P

# eclipse - 用于更改方法主体中的方法参数变量的 Java 编译器警告

> ID：14266066
> 
> 赞同：0
> 
> 时间：2013-01-10T19:48:33.233
> 
> 标签：eclipse, compiler-warnings

```
public class InsertionSort {
    public static <T extends Comparable<T>> void sort(T[] array) {
        for (int indexOfNextToInsert = 1; indexOfNextToInsert < array.length; indexOfNextToInsert++) {
            // array from array[0] to array[indexOfNextItemToReposition - 1] is sorted
            // now insert array item at "indexOfNextItemToReposition" into
            // the sorted left side of array
            insert(array, indexOfNextToInsert);
        }
    }

    private static <T extends Comparable<T>> void insert(T[] array, int indexOfNextToInsert) {
        T nextValue = array[indexOfNextToInsert];
        while (indexOfNextToInsert > 0 && nextValue.compareTo(array[indexOfNextToInsert - 1]) < 0) {
            array[indexOfNextToInsert] = array[indexOfNextToInsert - 1];
            indexOfNextToInsert--; //<-- I am getting an warning here in eclipse
        }
        array[indexOfNextToInsert] = nextValue;
    }
} 
```

有谁知道如何解决这个警告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:40:39.040

您不应该重新分配方法参数。对参数的赋值可能与试图将其用作[输出参数](http://www.javapractices.com/topic/TopicAction.do?Id=37)相混淆。进一步讨论： http: [//sourcemaking.com/refactoring/remove-assignments-to-parameters](http://sourcemaking.com/refactoring/remove-assignments-to-parameters)。

# google-app-engine - Google App Engine：此应用程序不存在/上传失败

> ID：14266068
> 
> 赞同：1
> 
> 时间：2013-01-10T19:48:52.087
> 
> 标签：google-app-engine, netbeans, deployment

多年来，我一直通过各种应用程序版本成功地使用 Netbeans 开发应用程序并将其部署到 Google App Engine。这一切都正常工作。

但是（问题），通过同一个帐户，我创建了一个新应用程序（在 Google 端），并且在应用程序端，正确的应用程序 ID 位于 appengine-web.xml 中，版本为 1。所有这些都在本地完美运行。但是，一旦我部署到 GAE，它就会失败：

com.google.appengine.tools.admin.HttpIoException：错误发布到 URL：404 未找到此应用程序不存在无法更新应用程序：错误发布到 URL：[https ://appengine.google.com/api/appversion/create ?app_id=](https://appengine.google.com/api/appversion/create?app_id=) 404 Not Found 这个应用程序不存在（app_id=u

为什么？？？？？？

我花了几个小时在网上寻找解决方案。很多人都有类似的问题，但是有什么解决办法呢？如何一个应用程序上传正常而第二个失败？

请有人给我一些关于如何解决问题并成功部署的建议吗？

我使用 Netbeans 并尝试过 6.9、7.1 和 7.2（我什至尝试安装 Eclipse 来解决这个问题，但开始使用起来很可怕，所以我回到了 Netbeans）。JDK 1.6。

帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:29:04.800

当然，它是这样工作的。在最终寻求帮助（从你们那里）之后，几分钟之内我就解决了问题（盲目的运气）。

万一它对其他人有帮助，基本问题是谷歌的帐户身份验证模型......

1.  我需要在 Google 帐户（https://accounts.google.com/IssuedAuthSubTokens#accesscodes - 即对您的 Google 帐户区域的授权访问）中生成一个应用程序专用密码，以便与新应用程序一起使用。

2.  然后我需要清除 Netbeans 中现有的电子邮件/密码。这有点混乱，因为我删除了最终在 C:\Users\User.netbeans\7.1\config\Preferences\org\netbeans\modules\j2ee\appengine 中找到的“deployment.properties”文件。

您会注意到我回到了 Netbeans 7.1，因为 Netbeans 7.2 似乎将它存储在我找不到的不同位置。

1.  返回 Netbeans 并点击“部署到 Google App Engine”菜单选项。它开始然后要求身份验证。我使用了我的正常（帐户）电子邮件 ID，然后使用了新的应用程序专用密码。奇迹的奇迹，它奏效了，该应用程序在现场启动了。

2.  我去喝咖啡

也许 Google 可以提供比 404 Not Found 更有意义的错误代码？？？

希望这可以帮助其他有类似问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-06T15:16:17.343

今天，我遇到了同样的问题。经过反复试验，我找到了解决方案。

基本上，从 Netbeans 7.2 开始。up，用户名和密码存储在一个叫做“keyring”的东西中。

在 Windows 8 中，我在当前用户目录下找到了它：`AppData\Roaming\NetBeans\7.3.1\config\Preferences\org\netbeans\modules\keyring`.

我不得不从那里的配置文件中删除 GAE 密码信息。然后我清除了一些注册表项（这可能不是强制性的）并重新启动了 Netbeans IDE。然后提示输入新凭据。

请参阅下面的完整 HowTo：

[http://donkeytech.wordpress.com/2013/08/06/change-google-app-engine-deployment-userdata-in-netbeans-from-7-2/](http://donkeytech.wordpress.com/2013/08/06/change-google-app-engine-deployment-userdata-in-netbeans-from-7-2/)

# symfony - 从继承的组中撤消用户角色

> ID：14266073
> 
> 赞同：0
> 
> 时间：2013-01-10T19:49:05.397
> 
> 标签：symfony, inheritance, user-roles

我正在使用 FOSUserBundle 并设置用户/组环境。

我可以将角色分配给组和用户。

基本上，我将角色分配给小组。现在，我想撤销组中的一些用户，一个从组继承的角色。

每次我在 UserAdminView （ SonataUserBundle ）中取消选择它时，都会再次重新检查它（当然，因为它是从组中获取的）

任何想法如何实现？

我想到了 Usertable 中的一个额外字段，其中列出了所有应该被撤销的角色。

有没有更容易的机会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:05:21.073

据我所知，您所要求的超出了 FOSUserBundle 的范围。无论如何，当用户登录时，它将加载分配给特定用户的所有角色，以及分配给用户的组中的所有角色。

您可以尝试在名为“denied_roles”或类似性质的用户实体下创建一个自定义字段。然后创建一个删除“denied_roles”的自定义登录侦听器（侦听“security.interactive_login”）。

# iphone - IOS 6.0 忽略了我的启动图像

> ID：14266076
> 
> 赞同：0
> 
> 时间：2013-01-10T19:49:24.027
> 
> 标签：iphone, ios, xcode4.5

在成功进入 Google Play 商店后，我一直试图让我的应用程序在 iPhone 上运行。我发现 iPhone 的流程比我预想的还要糟糕。

我的问题是，虽然我为每个显示器指定了启动图像，但当我在 IOS 6.0 模拟器或 iPhone 5 上进行测试时，我得到的是愚蠢的默认启动图像，而不是我指定的那个。

我以为我的配置有误，但是当我想到在 IOS 5.0 模拟器上尝试它时，它成功了！这非常令人沮丧。

我正在使用 XCODE 来“直观地”执行此操作。我太菜鸟了，无法确定如何在 .plist 中手动执行此操作，而且我无法从苹果那里找到任何关于它的真实文档。

我肯定可以使用指向一些实际有用文档的链接，甚至可以从经历过同样事情并找到解决方案的人那里获得一些帮助。

谢谢！

顺便说一句：我正在使用 xcode 4.5.2

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:09:56.153

有几件事要检查...

首先，您的命名约定：

`Default.png`(320 x 480) 支持原始 iPhone 至 iPhone 3GS

`Default@2x.png`(640 x 960) 支持 iPhone 4 和 4S

`Default-568h@2x.png`(640 x 1136) 支持 iPhone 5

大小写很重要，所以要小心。

其次，确保每张图像都是 72 dpi。

第三，从 Xcode 执行 Product->Clean 以确保您已经摆脱了周围的任何旧文件。还要从模拟器中删除应用程序并再次尝试运行。

最后，尝试在实际硬件上运行。尽管模拟器非常好，但它们的工作方式还是有一些不同——特别是它们对图像的适应程度。

# javascript - KineticJS dragBoundFunc 不起作用

> ID：14266077
> 
> 赞同：2
> 
> 时间：2013-01-10T19:49:23.860
> 
> 标签：javascript, html5-canvas, kineticjs

我有这个调用功能

```
    $(文档).ready(函数(){
       $('#change-background').click(function(){
         层['map'] = new Kinetic.Layer();
         buildMap(layers['map'],'img/test.png');
         stage.add(layers['map']);
       });
    });

```

而且，我有这个功能来显示图像

```
    功能构建地图（层，img_src）{
      var img = new Image();
      img.src = img_src;
      img.onload = 函数（e）{
        var map = new Kinetic.Image({
          id: 'map_img',
          x: 0,
          y: 0,
          图片：img，
          可拖动：真，
          dragBoundFunc：函数（位置）{
            // 这应该执行
            console.log('哈哈哈');
            返回 { x:0, y:0 };
          }
        });
        layer.add(地图);
        图层.draw();
      };
    }

```

我在我的一个单独项目中有一个类似的代码，它就像一个魅力。但是它在这里不能很好地工作，这很尴尬。图像显示在画布中，并且它的**可拖动**，在这种情况下它不应该是因为我明确返回`{ x:0, y:0 }`**（返回值仅用于我的测试）**。我还查看了控制台日志，**“哈哈哈”**文本从未出现过。拖动图像时它没有调用该函数。这两者都在一个``<script>``标签内和一个 html 文档中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:11:42.010

修复了这个：http: [//jsfiddle.net/xpLPT/2/](http://jsfiddle.net/xpLPT/2/)

尝试 ：

```
 dragBoundFunc: function(pos) {
      console.log('hahaha');  //check the jsfiddle, this does work.
      return {
        x: this.getAbsolutePosition().x,  //constrain vertically
        y: this.getAbsolutePosition().y   //constrain horizontally
      }
 } 
```

还可以通过添加 stage.draw(); 来更改您的点击功能：

```
$(document).ready(function(){
   $('#change-background').click(function(){
     //if(layers['map'])
          // layers['map'].remove(); // this is optional, but recommended, as it removes the current map layer before adding a new one
     layers['map'] = new Kinetic.Layer();
     buildMap(layers['map'],'img/test.png');
     stage.add(layers['map']);
     stage.draw();
   });
}); 
```

尝试使用较新版本的动力学：

```
 <script src="http://d3lp1msu2r81bx.cloudfront.net/kjs/js/lib/kinetic-v4.3.0.min.js"></script> 
```

# java - 数字的数据类型

> ID：14266085
> 
> 赞同：-5
> 
> 时间：2013-01-10T19:49:40.047
> 
> 标签：java, algebraic-data-types

我应该如何在 Java 中将几何数据类型更改为字符串？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T19:51:57.500

使用`BigInteger`.

```
BigInteger bi = new BigInteger("01060000000100000...", 16); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T19:51:48.547

你可以使用`BigInteger`. 它有一个以 String 和 radix 作为参数的构造函数。

所以：

```
new BigInteger(theString, 16); 
```

# android - 在 Intent 中为 Chrome 设置浏览器标头

> ID：14266088
> 
> 赞同：3
> 
> 时间：2013-01-10T19:50:13.830
> 
> 标签：android, google-chrome

我的应用程序使用标准 ACTION_VIEW 意图在用户的默认浏览器中启动 url。我还想设置一个http标头，特别是Referer标头。我看到内置浏览器允许您在意图上额外设置 Browser.EXTRA_HEADERS。Chrome 似乎不支持此额外功能，并且设置 Intent.EXTRA_REFERRER 或 Intent.EXTRA_ORIGINATING_URI 似乎也没有设置 Referer 标头。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-01T10:27:30.633

这是一个已知的限制。我提出了这个问题[https://code.google.com/p/chromium/issues/detail?id=179325](https://code.google.com/p/chromium/issues/detail?id=179325)

# java - 如何检索给定域类的弹簧数据存储库实例？

> ID：14266089
> 
> 赞同：22
> 
> 时间：2013-01-10T19:50:15.903
> 
> 标签：java, spring, jpa, spring-data, spring-data-jpa

给定某个类中所有 spring 数据存储库的列表`Bar`：

```
@Autowired
private List<Repository> repositories; 
```

如何`Foo`在上面的列表中找到现有域类的存储库？

假设存在以下情况：

```
@Entity
public class Foo {
  ...
} 
```

和

```
public interface FooRepository extends JpaRepository<Foo, String> {} 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-01-13T20:15:14.460

Spring Data Commons 包含一个类，该类`Repositories`使用 a`ListableBeanFactory`来查找其中定义的所有存储库 bean，并公开一个 API 以通过域类（通过`….getRepository(Class<?> type)`）获取这些实例。

应谨慎使用此类。由于存储库实例正在进行一些重要的代理生成，因此您必须确保在`Repositories`创建过程中尽可能晚地创建实例`ApplicationContext`。首选的方式是`ApplicationListener`通过监听来实现和创建实例`ContextRefreshedEvent`。

如果您正在编写一个 Web 应用程序，最安全的使用方法[是](http://static.springsource.org/spring/docs/current/spring-framework-reference/html/mvc.html#mvc-servlet)`Repositories`引导`ApplicationContext`由.`ContextLoaderListener``Repositories`

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-07-14T10:37:29.990

```
@Service
public class GenericRepository {

    @Autowired
    private WebApplicationContext appContext;

    Repositories repositories = null;

    public GenericRepository() {
        repositories = new Repositories(appContext);
    }

    public JpaRepository getRepository(AbstractPersistable entity) {
        return (JpaRepository) repositories.getRepositoryFor(entity.getClass());
    }

    public Object save(AbstractPersistable entity) {
        return getRepository(entity).save(entity);
    }

    public Object findAll(AbstractPersistable entity) {
        return getRepository(entity).findAll();
    }

    public void delete(AbstractPersistable entity) {
        getRepository(entity).delete(entity);
    }
} 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-11T10:58:58.297

`org.springframework.data.repository.core.support.DefaultRepositoryMetadata`解决方案的关键是提供方法的Spring `getDomainType()`。

`DefaultRepositoryMetadata`需要存储库接口作为构造函数 arg。因此，可以遍历所有现有存储库，检索存储库接口（这仍然是一个棘手的部分，因为存储库实例有多个接口）并找到`getDomainType()`equals的那个`Foo.class`。

# c# - 从 XPathDocument 获取 XML

> ID：14266094
> 
> 赞同：1
> 
> 时间：2013-01-10T19:50:29.923
> 
> 标签：c#, xml, visual-studio-2010, xslt

我正在处理样式表并有一些初始 XML。然而，XML 在造型之前被操纵了一下，我想把最终的 XML 发送到`.Transform()`. 例如， ...

```
XslCompiledTransform.Transform( xpd, xslArg, output ) 
```

...我想获取 xpd 的 Xml 内容（作为字符串），所以我可以在其他工具中处理样式表。

有没有一种快速而肮脏的方法来获得这个？在 VS2010 即时窗口中或在调用`.Transform()`?

编辑：`.Transform()`我正在使用的是

```
public void Transform(IXPathNavigable input,
   XsltArgumentList arguments, TextWriter results); 
```

...并且`xpd`是一个`XPathDocument`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:16:33.617

编辑：我误解了你的问题的意图。简单的答案是获取任何 IXPathNavigable（包括 XPathDocument）的 XML，您可以这样做：

```
string xml = xpd.CreateNavigator().OuterXml; 
```

下面是我的原始答案，它解释了如何在将 XPathDocument 输入到转换之前在代码中修改 XML：

如果`xpd`是 XPathDocument，您也许可以从 XPathDocument 中获取 XPathNavigator：

```
XPathNavigator xpn = xpd.CreateNavigator(); 
```

并使用它来修改 XML。完成修改后，您可以将其中一个`xpn`或传递`xpd`给该`Transform()`方法。另一方面，MSDN 说 XPathDocument`CreateNavigator()`创建了一个只读导航器，所以这可能有点麻烦。

如果它真的是只读的，你应该可以这样做：

```
XmlDocument doc = new XmlDocument();
doc.LoadXml(xpd.CreateNavigator().OuterXml); 
```

然后用于`doc`修改 XML 并`doc`在完成后传递给转换。

# android - this.finish() 到底是做什么的？它会阻止我的代码运行吗？

> ID：14266104
> 
> 赞同：4
> 
> 时间：2013-01-10T19:51:09.407
> 
> 标签：android

我对 this.finish() 到底做了什么有点模糊。具体来说，我只是在一个活动中编写了以下代码行：

```
this.finish();
Globals gs = (Globals) getApplication();
gs.MainActivity.finish(); 
```

该代码旨在关闭当前活动并关闭应用程序的核心活动。而且效果很好。但是，我想知道......显然，在执行第一行之后，当前的活动还没有完全结束。如果我调用 this.finish() 然后开始一些复杂的计算呢？

我的问题是：当我调用 this.finish() 时，我的 Activity 究竟何时被删除？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T19:56:45.960

无论调用什么方法，`finish()`都会在`finish()`方法实际开始之前一直运行。因此，要回答您的问题，在调用方法完成后，您的活动将运行其`finish`方法。如果您不希望该方法继续，那么您可以在之后添加一个 return 语句`finish`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T19:56:48.257

> *我对 this.finish() 到底做了什么有点模糊*

调用`finish()`基本上只是通知 Android 操作系统您的活动已准备好被销毁。然后，Android 将（只要它准备好）调用`onPause()`Activity 并继续销毁它（不会调用保证 onDestroy()），通过 Activity 生命周期。一般来说，您可能不应该在调用`finish()`. 根据[Android 文档](http://developer.android.com/reference/android/app/Activity.html)，您应该`finish()`在准备好关闭活动时调用。

> *我的活动到底什么时候被删除？*

我猜你的活动只会被添加到一些销毁队列中。在此期间，您可能能够继续执行，直到操作系统将其销毁。我相信您肯定可以完成执行`finish()`被调用的方法。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-08-08T05:37:24.183

Activity.finish() 在方法完全执行之前不会停止当前活动，因此要跳过其余部分代码，您可以使用 return；在某些条件下使用它来验证您的跳过。

如果（条件=真）{

```
 this.finish();
      return;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T19:58:19.707

克里斯，我不是专家，但这里[关于 android](https://stackoverflow.com/questions/2590947/about-finish-in-android)中的 finish() 的答案基本上就是 codeMagic 刚刚所说的。该链接很有价值，因为关于 onStop() 和 onDestroy() 的讨论

# c# - 在相同的两种对象类型之间创建两个 Automapper 映射

> ID：14266108
> 
> 赞同：40
> 
> 时间：2013-01-10T19:51:20.653
> 
> 标签：c#, .net, wcf, automapper

我在 WCF 服务中使用 AutoMapper 来返回`User`对象。 `User`具有诸如`AccountTeams`which 本身具有子对象的属性。所有的类都有 AutoMapper 地图。

根据`OperationContract`调用的 WCF，我想返回不同数量的数据。我希望一个`OperationContract`返回`User`没有填充其`AccountTeams`属性（及其子级）的对象，另一个`OperationContract`返回填充`User`了整个属性链的对象。

有没有办法在相同的两个对象之间有两个不同的映射，或者我是否需要执行完整映射并`null`输出我不想从服务返回的属性？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2016-06-12T03:04:18.883

Kevin Kalitowski 对 wal 的回答提出了一个很好的观点：如果我们需要两种配置来处理需要不同的映射，那么我们是否不必复制所有其他常见的映射？

我想我已经找到了一种使用配置文件的方法：每个唯一映射都有一个配置文件，公共映射有第三个配置文件。然后创建两个配置，一个用于每个唯一配置文件，但也将通用配置文件添加到每个配置。

例如，在 AutoMapper 4.2 中：

要映射的类：用户和车辆：

```
public class User
{
    public string Name { get; set; }
    public int Age { get; set; }
}

public class Vehicle
{
    public int FleetNumber { get; set; }
    public string Registration { get; set; }
} 
```

简介：

```
public class Profile1 : Profile
{
    protected override void Configure()
    {
        base.CreateMap<User, User>();
    }
}

public class Profile2 : Profile
{
    protected override void Configure()
    {
        base.CreateMap<User, User>().ForMember(dest => dest.Age, opt => opt.Ignore());
    }
}

public class CommonProfile : Profile
{
    protected override void Configure()
    {
        base.CreateMap<Vehicle, Vehicle>();
    }
} 
```

然后创建配置并映射对象：

```
[TestMethod]
public void TestMethod()
{
    var user = new User() { Name = "John", Age = 42 };
    var vehicle = new Vehicle {FleetNumber = 36, Registration = "XYZ123"};

    var configuration1 = new MapperConfiguration(cfg =>
    {
        cfg.AddProfile<CommonProfile>();
        cfg.AddProfile<Profile1>();
    });

    var mapper1 = configuration1.CreateMapper();
    var mappedUser1 = mapper1.Map<User, User>(user);//maps both Name and Age
    var mappedVehicle1 = mapper1.Map<Vehicle, Vehicle>(vehicle);//Maps both FleetNumber 
                                                                //and Registration.

    var configuration2 = new MapperConfiguration(cfg =>
    {
        cfg.AddProfile<CommonProfile>();
        cfg.AddProfile<Profile2>();
    });

    var mapper2 = configuration2.CreateMapper();
    var mappedUser2 = mapper2.Map<User, User>(user);//maps only Name
    var mappedVehicle2 = mapper2.Map<Vehicle, Vehicle>(vehicle);//Same as mappedVehicle1.
} 
```

我试过了，它有效。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-01-10T22:24:03.703

我假设您正在从映射`User`到`User`（如果不是，那么只需更改目标类型）

假设这个类用于以下示例：

```
public class User
{
    public string Name { get; set; }
    public int Age { get; set; }
} 
```

然后，您可以使用 separate`AutoMapper.Configuration`定义 2 个映射：

```
[TestMethod]
public void TestMethod()
{
    var configuration1 = new Configuration(new TypeMapFactory(), MapperRegistry.AllMappers());
    var mapper1 = new MappingEngine(configuration1);
    configuration1.CreateMap<User, User>();

    var user = new User() { Name = "John", Age = 42 };
    var mappedUser1 = mapper1.Map<User, User>(user);//maps both Name and Age

    var configuration2 = new Configuration(new TypeMapFactory(), MapperRegistry.AllMappers());
    configuration2.CreateMap<User, User>().ForMember(dest => dest.Age, opt => opt.Ignore());
    var mapper2 = new MappingEngine(configuration2);

    var mappedUser2 = mapper2.Map<User, User>(user);
    Assert.AreEqual(0, mappedUser2.Age);//maps only Name
} 
```

为避免将所有其他类型映射两次，您可以添加一个通用方法，该方法采用 a`Configuration`映射可以到达的所有内容，并在调用时和`User`调用后调用它。`configuration1``configuration2``CreateMap`

## 更新

对于 Automapper 4.x，请使用以下内容：

```
var configuration1 = new MapperConfiguration(cfg =>
{
    cfg.CreateMap<User, User>();
});

var mapper1 = configuration1.CreateMapper();
var user = new User() { Name = "John", Age = 42 };
var mappedUser1 = mapper1.Map<User, User>(user);//maps both Name and Age

var configuration2 = new MapperConfiguration(cfg =>
{
    cfg.CreateMap<User, User>().ForMember(dest => dest.Age, opt => opt.Ignore());
});

var mapper2 = configuration2.CreateMapper();
var mappedUser2 = mapper2.Map<User, User>(user);   //maps only Name 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T20:08:15.680

[我认为您可以使用此处](https://stackoverflow.com/questions/2183401/using-profiles-in-automapper-to-map-the-same-types-with-different-logic/2196854#2196854)描述的不同配置对象来解决此问题 ，您可以在[此处](https://stackoverflow.com/questions/1668962/automapper-c-using-the-instance-version-of-createmap-and-map-with-a-wcf-ser/7380377#7380377)找到一个示例

# android - Google+ 应用中使用的类似网格的布局的名称是什么？

> ID：14266113
> 
> 赞同：1
> 
> 时间：2013-01-10T19:51:45.710
> 
> 标签：android, layout, gridview, google-plus

我正在考虑构建一个具有与图片中相同的网格布局的应用程序，但我无法弄清楚我应该使用什么布局。

GridView，或类似的东西？

![谷歌加](../Images/f174c23f7daacf049031a9178aeb37ac.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T16:28:12.457

可以使用 StaggeredGridView 。在 github 上查看以下 repos

[https://github.com/maurycyw/StaggeredGridView](https://github.com/maurycyw/StaggeredGridView)

[https://github.com/chrisjenx/StaggeredGridView/tree/master/demo](https://github.com/chrisjenx/StaggeredGridView/tree/master/demo)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T19:31:31.677

使用 LinearLayout 很简单：

```
<ScrollView
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">
  <!-- Stack rows vertically -->
  <LinearLayout android:orientation="vertical"
      android:layout_width="fill_parent"
      android:layout_height="wrap_content" >
    <!-- First row, two items -->
    <LinearLayout android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >
      <!-- First item, 50% of width -->
      <FooView android:id="@+id/foo1"
          android:layout_width="0px"
          android:layout_weight="1"
          android:layout_height="wrap_content" >
      <!-- Second item, 50% of width -->
      <FooView android:id="@+id/foo2"
          android:layout_width="0px"
          android:layout_weight="1"
          android:layout_height="wrap_content" >
    </LinearLayout>
    <!-- Next row, just one item -->
    <LinearLayout android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content" >
      <!-- Third item, 100% of width -->
      <FooView android:id="@+id/foo2"
          android:layout_width="fill_parent"
          android:layout_height="wrap_content" >
    </LinearLayout>
    <!-- And so on... -->
  </LinearLayout>
</ScrollView> 
```

显然，“FooView”的确切性质取决于您，装饰性边框、阴影等也是如此。在实践中，您希望以编程方式执行此操作，但这个静态 xml 布局向您展示了您所追求的。

GridLayout 也可以使用，但它仅在 4.0 及更高版本中可用，除非您想开始使用兼容性库。由于 LinearLayout 将完成这项工作，这就是我将使用的。RelativeLayout 可能也可以工作，但我自己从来没有让这该死的东西工作。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T18:07:54.977

我不确定他们使用的是什么，但你可以使用 a`GridLayout`或 a来达到相同的效果`ListView`。

# ruby-on-rails - IE8 阻塞压缩 CSS (Rails)

> ID：14266114
> 
> 赞同：4
> 
> 时间：2013-01-10T19:51:46.427
> 
> 标签：ruby-on-rails, internet-explorer-8, sprockets

正如标题所说，我遇到了 IE8 和压缩 CSS 的问题。IE8 看起来完全被顶起来了。*（使用带有资产管道的 Rails 3.1）*

起初我以为是[IE 4095](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&ved=0CD0QFjAB&url=http%3A%2F%2Fmarc.baffl.co.uk%2Fbrowser_bugs%2Fcss-selector-limit%2Findex.html&ei=tBjvUI_gHOXL0AHluYC4DQ&usg=AFQjCNEU-7ilHSCZXUQdfuzcv0t59Da3YA&sig2=AjABM1l916pGDPERvDpQ2A&bvm=bv.1357700187,d.dmQ)错误。原来我只有 1034 个选择器。

在生产中，并且在`bundle exec rake assets precompile`本地运行 CSS 之后也开始出现故障。

出于好奇，我解压了吐出 的 CSS Rails / [Sprockets / Asset Pipeline ..](https://github.com/sstephenson/sprockets) **IE 在未压缩版本上没有中断。**

似乎 IE8 无法处理巨大的压缩文件。

我放了[一张票](https://github.com/sstephenson/sprockets/issues/402)，看看是否有输出压缩和未压缩版本的选项，然后有条件地将未压缩版本加载到 IE。

同时，我将尝试暂时关闭 Rails 压缩。

```
config.assets.compile = false  
// in development.rb

bundle exec rake assets precompile
// assets COMPILED anyway. agghhh! 
```

有点没有想法。欢迎任何建议！
谢谢！

**编辑**

基于[这个脚本](http://bindle.me/blog/index.php/200/splitting-the-asset-destroying-arcane-ie-bugs-on-the-rails-rack)，我开始编写为 IE8 提供未压缩 CSS 的中间件。

我已经走了很远，但注意到缺少**解压缩 CSS**的 Ruby Gems 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-14T03:07:42.683

我使用`sass-rails`gem 进行 CSS 压缩。

然后在 production.rb 中：

```
config.assets.compile = false
config.assets.compress = true
config.sass.style = :compressed 
```

`config.assets.compile`没有做你所期望的。这实际上意味着即时编译，而不是预编译。`config.assets.compress`就是你要找的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-01T23:46:56.650

我遇到过同样的问题。唯一的解决方法是将压缩的 javascript 分解为多个文件。我最终将我的脚本分成两个不同的压缩文件。这解决了这个问题。

希望有帮助。

# php - 显示查询结果的 PDO 错误：无法将类 PDOStatement 的对象转换为字符串

> ID：14266126
> 
> 赞同：1
> 
> 时间：2013-01-10T19:52:27.287
> 
> 标签：php, ajax

所以我第一次尝试 AJAX，我很兴奋！我有一个名为 ajaxtest1.html 的文件，它只有一个简单的文本框，其中输入了里程数，然后传递到另一个文件，它接收它，将其放入查询中并发回结果。这是ajaxtest1 ...

```
<html>
<body>
<script language="javascript" type="text/javascript">// <![CDATA[
function ajaxFunction(){
var ajaxRequest;  

try{
    // Opera 8.0+, Firefox, Safari
    ajaxRequest = new XMLHttpRequest();
} catch (e){
    // Internet Explorer Browsers
    try{
        ajaxRequest = new ActiveXObject("Msxml2.XMLHTTP");
    } catch (e) {
        try{
            ajaxRequest = new ActiveXObject("Microsoft.XMLHTTP");
        } catch (e){
            // Something went wrong
            alert("Your browser broke!");
            return false;
        }
    }
}
// receive data sent from the server
ajaxRequest.onreadystatechange = function(){
    if(ajaxRequest.readyState == 4){
        document.myForm.time.value = ajaxRequest.responseText;
    }
}
var miles = document.getElementById('miles').value;
var queryString = "?miles=" + miles;
ajaxRequest.open("GET", "results.php" + queryString, true);
ajaxRequest.send(null); 
}
// ]]></script>
<form name="myForm">Miles: <input id="miles" type="text" /> <br /> <br /> <input onclick="ajaxFunction()" value="Query MySQL" type="button" /></form>
</body>
</html> 
```

然后，在 results.php 中。我有

```
<?php
$hostname = 'host';

$username = 'user';

$password = 'password';

$miles = $_GET['miles'];

try {
    $dbh = new PDO("mysql:host=$hostname;dbname=ratetable", $username, $password);
    echo 'Connected to database<br />';
    $stmt = $dbh->prepare('SELECT * FROM rates WHERE mileage <= :miles ORDER BY mileage DESC LIMIT 1');
    $stmt->bindParam(':miles', $miles, PDO::PARAM_INT);
    if ($stmt->execute()) {

    // get the rowcount
    $numrows = $stmt->rowCount();
    if ($numrows > 0) {
    // match
    // Fetch rows
      $rowset = $stmt->fetchAll();
    }
    else {
    // no rows
    }
   }

$display_string = "<table>";
$display_string .= "<tr>";
$display_string .= "<th>Mileage</th>";
$display_string .= "<th>Rate Per Mile</th>";
$display_string .= "<th>Inbound skid rate</th>";
$display_string .= "<th>Inbound truckload</th>";
$display_string .= "</tr>";

while($row_object = array($miles)){
$display_string .= "<tr>";
$display_string .= "<td>$row[mileage]</td>";
$display_string .= "<td>$row[ratepermile]</td>";
$display_string .= "<td>$row[skidinbound]</td>";
$display_string .= "<td>$row[truckinbound]</td>";
$display_string .= "</tr>";

   }
    echo "Query: " . $stmt . "<br />";
    $display_string .= "</table>";
    echo $display_string;

/*** close the database connection ***/
    $dbh = null;
}
catch(PDOException $e)
    {
    echo $e->getMessage();
    }
?> 
```

[更新]

我对使用 PDO 很陌生（嗯，一般来说是 PHP，我正在接受它。）

我收到以下错误：

```
Catchable fatal error: Object of class PDOStatement could not be converted to string 
```

这发生在以下行上：

```
echo "Query: " . $stmt . "<br />"; 
```

它连接到数据库很好。有人可以告诉我可能出了什么问题吗？当它试图形成 PDO 语句时，我有点想它，这样它就可以处理我的查询，而且它在最后一点就窒息了。

我已经更新了 PHP 代码以向您展示我尝试过的内容。

谢谢你看。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:00:59.767

在你的 results.php 文件中试试这个：

```
$stmt = $dbh->prepare('SELECT * FROM rates WHERE mileage <= :miles ORDER BY mileage DESC LIMIT 1');
$stmt->bindParam(':miles', $miles, PDO::PARAM_INT); 
```

您可以从此行中删除演员表：

```
$miles = (int) $_GET['miles']; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T15:59:36.963

“可捕获的致命错误：无法将 PDOStatement 类的对象转换为字符串。” 意思正是它所说的。$stmt 变量是一个 PDO 对象，您试图将其作为字符串进行回显。你不能回显一个对象，就像你不能只回显一个数组一样。

替换此行

```
$stmt = $dbh->prepare('SELECT * FROM rates WHERE mileage <= ? ORDER BY mileage DESC LIMIT 1'); 
```

有了这个：

```
$query_text = 'SELECT * FROM rates WHERE mileage <= ? ORDER BY mileage DESC LIMIT 1';
$stmt = $dbh->prepare($query_text); 
```

然后替换这一行

```
echo "Query: " . $stmt . "<br />"; 
```

有了这个

```
echo "Query: " . $query_text . "<br />"; 
```

# gcc - 如何在 gcc/g++ 上使用 -Wall 选项并关闭多行注释警告？

> ID：14266131
> 
> 赞同：4
> 
> 时间：2013-01-10T19:52:40.483
> 
> 标签：gcc, warnings

像标题一样，如何在 gcc/g++ 上使用 -Wall 选项并关闭多行注释警告？

评论看起来像这样：

```
// Comment starts here \
// and end here (the // at the begging is not necessary) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T19:56:59.360

您可以使用 /* .. */ 作为多行注释。

```
 /* foo bar comment
       lala blah
    */ 
```

编辑：

我在这里的另一篇文章中找到了解决方案：[如何在 GCC 中隐藏“已定义但未使用”的警告？](https://stackoverflow.com/questions/386220/how-can-i-hide-defined-but-not-used-warnings-in-gcc)

如果添加选项 -Wno-comment，则警告消失。

```
 gcc -Wall -Wno-comment test.c -o test 
```

它也在这里解释：http: [//gcc.gnu.org/onlinedocs/gcc/Warning-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)

最好的祝愿，马蒂亚斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-12T20:50:27.323

GCC 警告记录在这里： http: [//gcc.gnu.org/onlinedocs/gcc/Warning-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Warning-Options.html)

具体来说，您正在寻找：

> -W评论
> 
> > 每当注释开始序列`/*' appears in a`/*' 注释或反斜杠换行符出现在 `//' 注释中时都会发出警告。此警告由 -Wall 启用。

因此，要关闭该警告，您应该能够使用`-Wno-comment`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T19:32:52.700

反斜杠继续引发警告；如果您以注释开头开始下一行，则没有必要。

删除反斜杠继续并将行开头的反斜杠替换为`//`（如所写，它根本不是评论），您应该消除警告。

你也可以写：

```
/\
\
* A regular C89 comment with trigraphs for good measure.
*??/
??/
/ 
```

并且任何向我提交该代码以供审查的人都会被立即送回以修复它（但可怜的编译器编写者必须正确处理这些废话！）。

至于如何修复它，如果（如评论中提到的）它很普遍，那么您可以查看您的 GCC 版本是否支持`-Wno-comment`抑制有关多行注释的警告。这可能是最简单的。如果做不到这一点，您必须决定是否可以冒险使用启发式解析器来解决问题：

```
sed -e 's%\(//.*\)\\$%\1%' -i.bak *.c 
```

`sed`（假设选择GNU `-i.bak`）。这会从任何此类注释中删除尾部反斜杠。我可以看到这导致麻烦的主要地方是宏定义，例如：

```
#define MACRO(c,d) { (c) = (d) + 1; }  // Comment here \
                                          more comment here 
```

这是一个空洞的宏，但是因为注释的第二行没有注释开始，`sed`脚本中的启发式替换会给你一个语法上无效的程序（除非你碰巧有这样的宏，比如“这里有更多评论”扩展为有效代码，这不太可能）。

如果启发式机制不起作用，那么也许您需要一个完整的 C 注释剥离器。如果你在 Internet 上的某个地方找不到，我有一个这样的程序（它的测试文件包括上面显示的令人毛骨悚然的评论）——请参阅我的个人资料。

# android - 使用 Andengine 对 assets 文件夹进行排序

> ID：14266134
> 
> 赞同：0
> 
> 时间：2013-01-10T19:52:53.973
> 
> 标签：android, directory, andengine, assets, sorted

谷歌翻译

我正在使用 Andengine 制作游戏，在文件夹“assets”中我有三个文件夹 gfx、mfx、font（受保护的文件夹还有更多吗？）

文件夹已满，工作正常。

在我的游戏中，您可以选择几个具有不同特征（速度、跳跃、瞄准）的玩家，随着时间的推移，我会在市场上可用时进行更新，我希望将其全部排序。我可以做这个？如果不可能，我会认真推荐。

```
"assets/player/soldier001.png"
"assets/player/soldier001.xml" 
```

对不起我的英语不好。谷歌翻译

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:36:59.960

just right click on the assets folder - choose New - choose Folder and name it player. then drop your files in there.

Just be sure when you access those you use the correct filepath.

# git - 在 git repo 中安装 AWSDevTools 以在 windows 上使用弹性 beanstalk

> ID：14266135
> 
> 赞同：1
> 
> 时间：2013-01-10T19:52:54.213
> 
> 标签：git, amazon-ec2, amazon-elastic-beanstalk

我正在尝试使用 git bash 在 Windows 上为 git 设置 AWSDevTools，并且在运行 oneTimeSetup.bat 文件时收到错误消息。错误说“未加载，因为在任何模块目录中都找不到有效的模块文件。” 关于我缺少什么或任何特定于 Windows 的教程的任何想法？这是我的第一次 git 部署，所以我是 AWS 上的 git 和 git 新手。我附上了我的 git bash 命令和错误的屏幕。任何帮助表示赞赏。

![在此处输入图像描述](../Images/7e2087fffb1b85785cda2398374a891f.png)

这些是亚马逊提供的步骤http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/GettingStarted.GetSetup-devtools.html

当我运行第 3 步和第 5 步时，会打开 cmd 提示符，但没有任何反应。屏幕截图是从 gitbash 运行时的。

3\. 双击 AWSDevTools-OneTimeSetup.bat。您可以在 AWS DevTools/Windows 目录中找到 AWSDevTools-OneTimeSetup.bat。设置脚本会安装推送 AWS Elastic Beanstalk 应用程序所需的所有部分。您只需运行一次此安装脚本。

5.将 AWSDevTools-RepositorySetup.bat 从 AWS DevTools/Windows 目录复制到您的 Git 存储库目录，然后双击 AWSDevTools-RepositorySetup.bat。您需要为每个 Git 存储库运行此脚本。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T16:59:53.787

我从最初解压缩到的位置 (C:\www\AWS-ElasticBeanstalk-CLI-2.3.1\AWSDevTools\Windows) 运行 AWSDevTools-OneTimeSetup.bat 时遇到问题。

它似乎可以运行，但未能设置各种 aws 别名（例如 git.aws push）。

我将它移到 C:\tmp\Windows\AWSDevTools-OneTimeSetup.bat 并从那里运行它，它运行良好。

希望这对某人有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-11T00:19:06.963

您需要从它所在的目录运行 AWSDevTools-OneTimeSetup.bat。在您的情况下，c/AWS_git/elasticBeanstalk-cli/AWSDevTools/Windows

# iphone - 图像清晰度随着在其上绘制渐变效果而消失

> ID：14266136
> 
> 赞同：0
> 
> 时间：2013-01-10T19:52:59.843
> 
> 标签：iphone, ios, cocoa-touch, uiimageview, uiimage

我有一张在视网膜设备上看起来清晰干净的图像（带有 X 和 2X 变体）。但我想要一个渐变效果。一旦我在上面画了渐变，图像就会失去清晰度，我猜是因为渐变没有放在精确的图像边界上。任何建议如何解决这个问题。我附上了图像（有和没有渐变效果）以及我的渐变代码：

```
- (UIImage *)tintedWithLinearGradientColors:(NSArray *)colorsArray forImageNamed:(NSString *)iImageName {
    // Load image
    UIImage *myIconImage = [UIImage imageNamed:iImageName];
    // Create gradient
    UIColor *colorOne = [colorsArray objectAtIndex:1]; // top color
    UIColor *colorTwo = [colorsArray objectAtIndex:0]; // bottom color

    NSArray *colors = [NSArray arrayWithObjects:(id)colorOne.CGColor, (id)colorTwo.CGColor, nil];
    CGColorSpaceRef space = CGColorSpaceCreateDeviceRGB();
    CGGradientRef gradient = CGGradientCreateWithColors(space, (__bridge CFArrayRef)colors, NULL);

    UIGraphicsBeginImageContext(myIconImage.size);
    CGContextRef context = UIGraphicsGetCurrentContext();

    CGContextTranslateCTM(context, 0, myIconImage.size.height);
    CGContextScaleCTM(context, 1.0, -1.0);

    CGRect rect = CGRectMake(0, 0, myIconImage.size.width, myIconImage.size.height);

    // image drawing code
    CGContextSetBlendMode(context, kCGBlendModeNormal);
    CGContextDrawImage(context, rect, myIconImage.CGImage);

    // draw tint color, preserving alpha values of original image
    CGContextSetBlendMode(context, kCGBlendModeMultiply);
    CGContextClipToMask(context, rect, myIconImage.CGImage);
    CGContextDrawLinearGradient(context, gradient, CGPointMake(0,0), CGPointMake(0, myIconImage.size.height), 0);

    UIImage *coloredImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return coloredImage;
} 
```

![在此处输入图像描述](../Images/1ec7c52ae3c9accfcdb3d730a8a36f14.png)

![在此处输入图像描述](../Images/11f41311b469bb7b6d5f29e364a3f507.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:12:43.997

您需要通过代码添加此渐变吗？如果不这样做，请在 Photoshop 或其他软件上添加渐变，然后将图像添加到已使用渐变的项目中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:37:09.703

更换线路

```
UIGraphicsBeginImageContext(myIconImage.size);
with
UIGraphicsBeginImageContextWithOptions(myIconImage.size, NO, myIconImage.scale); 
```

为我工作。

# iphone - 带有 CCLayer for iOS 6 的 Cocos2d 横向 Gamecenter 身份验证

> ID：14266137
> 
> 赞同：1
> 
> 时间：2013-01-10T19:53:06.273
> 
> 标签：iphone, ios, objective-c, ios6, cocos2d-iphone

我遇到了一个似乎相当普遍的问题，但我对解决方案的搜索和实施并没有成功。

我已经构建了一个 Cocos2d 游戏，该游戏仅用于横向，但需要访问 Gamecenter。Gamecenter 正在运行，启用了纵向模式，但它也允许游戏切换到纵向模式。

我尝试了以下修复：

[游戏中心登录锁定仅在 i OS 6 中](https://stackoverflow.com/questions/12488838/game-center-login-lock-in-landscape-only-in-i-os-6)

[仅横向应用程序中的 GameCenter 身份验证引发 UIApplicationInvalidInterfaceOrientation](https://stackoverflow.com/questions/12427979/gamecenter-authentication-in-landscape-only-app-throws-uiapplicationinvalidinter)

[将 GameCenter 添加到仅限横向的 cocos2d 应用程序后，iOS 6 出现错误](https://stackoverflow.com/questions/13829851/error-in-ios-6-after-adding-gamecenter-to-a-landscape-only-cocos2d-app)

[Cocos 2d 2.0 shouldAutorotate 不工作？](https://stackoverflow.com/questions/13718761/cocos-2d-2-0-shouldautorotate-not-working/13736022#13736022)

我相信问题在于我使用 CCLayers 而不是 UIViewControllers 构建了游戏

示例：MenuLayer.h

```
@interface MenuLayer : CCLayer <GKAchievementViewControllerDelegate, GKLeaderboardViewControllerDelegate, UINavigationControllerDelegate>{
   ..my header info..
} 
```

菜单层.m

```
...
-(NSUInteger)supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskLandscape;
}
-(BOOL)shouldAutorotate {
    return [[UIDevice currentDevice] orientation] != UIInterfaceOrientationPortrait;
}

-(void)authenticateLocalPlayer
{

    GKLocalPlayer * localPlayer= [GKLocalPlayer localPlayer];

    if(localPlayer.authenticated == NO)
    {
        NSString *reqSysVer = @"6.0";
        NSString *currSysVer = [[UIDevice currentDevice] systemVersion];
        if ([currSysVer compare:reqSysVer options:NSNumericSearch] != NSOrderedAscending)
        {
            [[GKLocalPlayer localPlayer] setAuthenticateHandler:(^(UIViewController* viewcontroller, NSError *error) {
                if (viewcontroller != nil) {
                    AppController *app = (AppController*) [[UIApplication sharedApplication] delegate];
                    [[app navController] presentModalViewController:viewcontroller animated:YES];
                }else if ([GKLocalPlayer localPlayer].authenticated)
                {
                    //do some stuff
                }
            })];
        }
        else
        {
            [localPlayer authenticateWithCompletionHandler:^(NSError *error){
                if(localPlayer.isAuthenticated)
                {
                    //Peform Additionl Tasks for the authenticated player.
                }
            }];
        }
    }

}
... 
```

由于我使用 CCLayers 而不是 UIViewControllers 构建了游戏，我有什么替代方案？我假设 CCLayers 不调用 use supportedInterfaceOrientations 或 shouldAutorotate 是否正确？

或者我应该以某种方式更改此代码以解决问题：

```
// Create a Navigation Controller with the Director
navController_ = [[UINavigationController alloc] initWithRootViewController:director_];
navController_.navigationBarHidden = YES; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T23:33:53.617

这也让我沮丧了一段时间。在网上搜索了一段时间后，我发现了一些资源，其中一些使用 iOS 6，一些使用 iOS5，但我必须进行一些修改，以便它在 iOS5 和 iOS6 上都以我想要的方式工作。这是我正在使用的代码，它适用于我使用 5.1 和 6 的 iPhone。请注意，游戏中心登录仍然以纵向显示，您似乎对此无能为力。但游戏的其余部分将保持横向模式。

1.  在构建设置 (info.plist) 中启用纵向模式作为支持的方向。
2.  创建 UINavigationController 的新子类。将这个类命名为对你有意义的任何东西。
3.  在您的 AppDelegate 中，包含新的自定义 UINavigationController 头文件。
4.  在您的 App Delegate 中，注释掉原始调用，而是调用您的自定义类。

这应该够了吧。这是我的自定义类的代码：

```
#import <UIKit/UIKit.h>

@interface CustomNavigationViewController : UINavigationController

-(UIInterfaceOrientation) getCurrentOrientation;

@end 
```

以及实现文件：

```
#import "CustomNavigationViewController.h"

@interface CustomNavigationViewController ()

@end

@implementation CustomNavigationViewController

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view.
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

// This is required to allow GameCenter to login in portrait mode, but only allow landscape mode for the rest of the game play/
// Arrrgg!

-(BOOL) shouldAutorotate {
    return YES;
}

-(NSUInteger) supportedInterfaceOrientations {
    return UIInterfaceOrientationMaskLandscape;
}

-(UIInterfaceOrientation) preferredInterfaceOrientationForPresentation {
    return UIInterfaceOrientationLandscapeRight; // or left if you prefer
}

-(NSUInteger) application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window {
    if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
        return UIInterfaceOrientationMaskLandscape;
    else {
        return UIInterfaceOrientationMaskAllButUpsideDown;
    }
}

-(BOOL) shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return [[UIDevice currentDevice] orientation] != UIInterfaceOrientationPortrait;
}

-(UIInterfaceOrientation) getCurrentOrientation {
    return [[UIDevice currentDevice] orientation];
}

@end 
```

请注意，`getCurrentOrientation`不需要最后一种方法，我只是把它放在那里，以防我想确定当前方向是什么。

自定义类在 AppDelegate.m 中调用如下：（注释掉原代码）

```
navController = [[CustomNavigationViewController alloc] initWithRootViewController:director];
window.rootViewController = navController;
navController.navigationBarHidden = YES;
[window makeKeyAndVisible]; 
```

希望这可以帮助。

# javascript - 您如何使用 HTML5 标签，同时支持不原生识别未知元素的无脚本客户端的渐进增强？

> ID：14266142
> 
> 赞同：7
> 
> 时间：2013-01-10T19:53:22.340
> 
> 标签：javascript, css, html, progressive-enhancement

据我了解渐进增强，基本原则之一是网站应该对*每个人都*有效，无论浏览器版本或设置如何。

我看到的建议细分是：

*   使用语义标记的 HTML 内容层
*   CSS 表示层
*   增强层（通常通过 JavaScript 或 JQuery 等 JS 库）

但是，我对处理 HTML 内容层的正确方法有点困惑。特别是语义标记。

我不断看到诸如导航、文章、页脚等 HTML5 标记是为 PE 维护这种语义标记的理想方法。但是，许多较旧的浏览器不支持 HTML5 标签。解决这个问题的简单方法是使用 CSS 将默认样式设置为 { display: block; } 用于 HTML5 标记，但这仅适用于某些浏览器。例如，可怕的 IE6 无法识别 HTML5 元素。

典型的解决方法是使用 javascript 将缺失的元素直接动态地创建到 DOM 中（例如通过 HTML5 shiv）。

但是...如果客户端运行的环境无法识别 HTML5 元素，**并且**无论出于何种原因，它们都不接受 javascript，那么您如何合并 HTML5 语义标签以支持渐进增强，而不会无法正确呈现无法识别标签的无脚本浏览器？这可能吗，或者您是否必须将这些浏览器排除在您的设计考虑之外（这似乎与 PE 理想背道而驰）？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:11:58.873

如果您对在没有 JS 的情况下以这种方式支持 GhettoIE 过于偏执，那么这可能是时候`if ie`在 HTML 中使用评论，指导人们获取 Chrome Frame，或者获取更好的浏览器，或者单击链接获取它们到一个老式的、功能齐全的页面版本，它遵循 CSS2.1（只是核心功能）和 HTML4.01 严格的标记。

渐进增强的重点是提供关注点分离，并提供受支持的功能......但这里有基线要求。

你也不能指望 Mosaic 和 IE3 运行这些东西。

带有 JS 的 IE6，或非 IE，现代标准浏览器，没有是事实上的，在这里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:48:41.843

[根据雅虎的内部流量分析](http://developer.yahoo.com/blogs/ydn/posts/2010/10/how-many-users-have-javascript-disabled/#comment-17131)，几乎所有禁用 JavaScript 的用户都在使用兼容 HTML5 的浏览器。不要担心不支持禁用 JavaScript 的稀有 IE8 用户。

您的公司不会因为不支持这些用户而失去任何业务。提供这种水平的支持的唯一真正原因是作为一项学术活动来证明它是可以做到的。你的钱没有什么大不了的。

# c++ - C++ - 继承和初始化问题

> ID：14266149
> 
> 赞同：0
> 
> 时间：2013-01-10T19:53:39.577
> 
> 标签：c++, inheritance, initialization

我有 2 个单独的代码文件。一个是主文件，一个是包含函数的文件。

代码可以在下面查看：

## 学生.cpp

```
Student::Student(const string &name, int regNo) : Person(name)
{
    map<string, float> marks;
    this->name = name;
    this->regNo = regNo;
}

int Student::getRegNo() const
{
    return regNo;
}

void Student::addMark(const string& module, float mark)
{
    map<string, float>::const_iterator it;
    marks.insert(make_pair(module, mark));

    for (it = marks.begin(); it != marks.end(); it++)
    {
        if(it->second !=0){
            marks[module] = mark;
        }
    }

} 
```

## 主文件

```
Student stud(name, i);//this is what I want to do

    if(wordfile.is_open() && file2.is_open())
    {
        if(!wordfile.good() || !file2.good())
        {
            cout << "Error reading from file. " << endl;
        }

        while(wordfile.good())
        {
            getline(wordfile, s1);
            istringstream line(s1);
            line >> i;
            line >> name;

            Student stud(name, i);
            cout << stud.getRegNo() << endl;
            itR.push_back(stud.getRegNo());
            vS.push_back(stud);
        }
        wordfile.close();

        while(file2.good())
        {
            getline(file2, s2);
            istringstream line(s2);
            line >> reg;
            line >> mod;
            line >> mark;
                    stud.getRegNo();
        }
        file2.close();
    }
} 
```

我理想中想要做的是使用我的构造函数`student.cpp`来创建一个`student`对象。然后，我希望能够在 main 中的任何位置调用 student.cpp 中的函数。但是，我需要提供给构造函数的值来自我的代码中名为“wordfile”的文件。因此`Student stud(name, i);`在寻找“wordfile”的同时被调用。但是，然后我希望在 while 循环中为“file2”调用“stud.getRegNo()”，但这当然是不允许的。由于 stud 被用作局部变量，因此它的范围没有那么远。

所以我的问题是，无论如何我可以执行我想做的事情吗？也许通过初始化然后`Student stud`调用？或类似的规定？`stud(name, i)``stud.getRegNo()`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:56:43.590

您可以使用在堆上分配 Student`new`并将实例保持在两个上下文都可访问的范围级别。

```
Student* s;

{ //Context 1
    s = new Student();
}

{ //Context 2
    int regNo = s->getRegNo();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T21:30:17.843

除了使用向量 (?)，您可能需要的是 std::map 以便您知道要选择哪个学生。

```
 std::map<int, Student*> students;
    while(wordfile.good())
    {
        getline(wordfile, s1);
        istringstream line(s1);
        line >> i;
        line >> name;

        students[i] = new Student(name, i);
    }
    wordfile.close();

    while(file2.good())
    {
        getline(file2, s2);
        istringstream line(s2);
        line >> reg;
        line >> mod;
        line >> mark;

        students[reg]->addMark(mod, mark);
    }
    file2.close();

    .... 
```

# jquery - 从填写的字段中删除附加

> ID：14266150
> 
> 赞同：0
> 
> 时间：2013-01-10T19:53:43.663
> 
> 标签：jquery, field

这是我写的代码：

```
$('#third_step input[type=text]').each(function(n,element){  
            if ($(element).val()=='') {  
              //alert('Field '+element.id+' must have a value');  
              $("label[for='" +element.id+ "']").append('<p class="input_field_error">Bitte füllen Sie dieses Feld!</p>');
        error++;  
            }else{
        $('.input_field_error').remove();
        }
 }); 
```

然后当我测试它时，我单击提交并且未填写的字段显示错误消息，但是当我填写其中一些时，错误消息将从它们中删除，并且它会从之前的字段中删除消息他们，他们之后的字段仍然有错误消息！也许我需要从那些填写了字段的标签中选择 input_field_error ！或者这不是测试字段是否已填写的好方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T19:57:13.367

```
$('.input_field_error').remove(); 
```

`input_field_error`这将删除所有不属于你想要的类的元素。您只想删除当前正在验证的元素。所以改成：

```
$('.input_field_error', 'label[for="' + element.id + '"]').remove(); 
```

这只会选择具有当前 ID的`input_field_error`类 WITHIN 。`<label>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T19:59:11.247

您需要调整 else 语句，使其不会删除所有类元素。$('.input_field_error') 引用所有项目。

# c - 更新文件中的记录

> ID：14266151
> 
> 赞同：0
> 
> 时间：2013-01-10T19:53:48.963
> 
> 标签：c

我正在尝试更新我的库存数量，这是保存在文件中的结构属性，我希望添加订单数量，这也是保存在文件中的结构属性，我尝试了这行代码，但没有给出任何更改，谁能给我任何想法？

```
fread(arrayBatch, sizeof(struct product), numberOfStructsProd, prodFile);
int k;
for(k=0; k< numberOfStructsProd; k++)
{
    update = arrayBatch[k].quantityInStock + arrayBatch[k].orderQuantity;
    arrayBatch[k].quantityInStock = update;
    printf("Batch file updated...\n");
}
fwrite(arrayBatch, sizeof(struct product), numberOfStructsProd, prodFile); 
```

# linux - 从日志文件中计算具有匹配模式的行

> ID：14266152
> 
> 赞同：0
> 
> 时间：2013-01-10T19:53:49.683
> 
> 标签：linux, shell, unix, awk, grep

我的 abc.log 包含以下条目（片段）：

```
...
INFO #my-service# #add# id=67986324423 isTrial=true
INFO #my-service# #add# id=43536343643 isTrial=false
INFO #my-service# #add# id=43634636365 isTrial=true
INFO #my-service# #add# id=67986324423 isTrial=true
INFO #my-service# #delete# id=43634636365 isTrial=true
INFO #my-service# #delete# id=56543435355 isTrial=false
... 
```

我想计算具有唯一 id 且其中具有`#add#`属性的行并具有`isTrial=true`.

对于上面的代码片段，输出应该是 2

任何人都可以提供我可以针对上述日志文件运行的 linux 命令吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:03:57.257

仅使用`awk`：

```
# Count unique line
$ awk '$3~"add"&&$5~"true"&&!u[$4]++{++c}END{print c}' file
2

# Print unique lines
$ awk '$3~"add"&&$5~"true"&&!u[$4]++' file
INFO #my-service# #add# id=67986324423 isTrial=true
INFO #my-service# #add# id=43634636365 isTrial=true 
```

或者只是`sort`和`grep`

```
$ sort -uk4,4 file | grep "#add#.*true" 
INFO #my-service# #add# id=67986324423 isTrial=true
INFO #my-service# #add# id=43634636365 isTrial=true

$ sort -uk4,4 file | grep -c "#add#.*true"
2 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T21:22:43.470

这个单线给你结果2

```
awk -F'#add# id=' '$2~/true/{a[$2]}END{print length(a)}' abc.log 
```

这个单线为您提供两条独特的线

```
awk -F'#add# id=' '$2~/true/&&!a[$2]++' abc.log 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:01:30.697

组合`grep`,和: `cut`_`sort``wc`

```
grep '#add#.*isTrial=true$' /path/to/file | cut -f4 | sort -u | wc -l 
```

根据您的喜好自定义正则表达式（对其匹配的行更严格/不那么严格）。

（`cut -f4 -d' '`如果您的分隔符是空格而不是制表符）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-10T19:58:29.353

这也算

```
grep "isTrial=true" abc.log | grep "#add#" | awk ' { print $4 }' | sort | uniq | wc -l 
```

# shopify - Shopify 私有应用 api 发布请求

> ID：14266153
> 
> 赞同：1
> 
> 时间：2013-01-10T19:53:53.747
> 
> 标签：shopify, navision, dynamics-nav

我正在编写一个从 MS NAV 到 shopify api 的私有集成应用程序。我可以使用 API 获取请求，例如 [https://API_KEY:PASSWORD@wolf-wiegand-and-davis1433.myshopify.com/admin/orders.xml](https://API_KEY:PASSWORD@wolf-wiegand-and-davis1433.myshopify.com/admin/orders.xml)

但是，发布请求不适用于此格式：[https://API_KEY:PASSWORD@wolf-wiegand-and-davis1433.myshopify.com/admin/products.xml](https://API_KEY:PASSWORD@wolf-wiegand-and-davis1433.myshopify.com/admin/products.xml)。

我收到 403 状态错误。

有谁知道可能出了什么问题？或者 api 不支持发布请求。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T06:27:35.187

您的应用程序的权限似乎已损坏。创建一个新应用程序将为您提供应包含所有权限的凭据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:05:23.210

响应 xml，这似乎是一个权限问题：

您没有产品写入权限。

# android - Andengine Text 不支持阿拉伯语

> ID：14266154
> 
> 赞同：1
> 
> 时间：2013-01-10T19:53:57.207
> 
> 标签：android, andengine, arabic

我现在在支持多种语言的 Android 游戏中工作。我使用 Andengine，但是当我使用 Andengine 绘制文本时**，**如下所示：

```
Text text = new Text(float pX, float pY, IFont pFont, CharSequence pText, VertexBufferObjectManager pVertexBufferObjectManager); 
```

它没有正确显示**阿拉伯语**的字母。有人可以帮我吗？

# sql - 错误“80020009”-但我不在查询中

> ID：14266155
> 
> 赞同：0
> 
> 时间：2013-01-10T19:53:57.787
> 
> 标签：sql, asp-classic

我有一个在 ASP 中下订单的系统，当提交订单时，会发出一封通知电子邮件。

当我提交订单时，我收到错误“80020009”，它指向的行是这样的：

```
email_text = email_text & "<html>" & _ 
```

这是一个简单的行，它刚刚开始构建填充电子邮件的 html 字符串！错误'80020009'不应该用于SQL语句吗？还是我错过了什么？

该页面仍然继续并完成订购过程，它只是首先显示该错误消息。

我意识到这个问题并没有真正提供太多细节，但我不知道还要指定什么，我只是不知所措。

编辑：这里有一些 SQL 是从那行开始的几行。不知道这将如何导致问题，因为它告诉我它在那条电子邮件线上，但把它扔进去也无妨：

```
str = "SELECT creation_date, supplier FROM argus.PURCHASE_ORDER WHERE purchase_order = '" & Trim(Request.Form("order_id")) & "' AND customer = '" & Session("customer_id") & "' AND store = '" & Session("store_id") & "' AND userid = '" & Session("user_id") & "'"
            Set rst = ConnFW.Execute(str)
            str2 = "SELECT a.store_name, a.address1, a.address2, a.city, a.state_cd, a.zipcode, b.customer_name, c.supplier_account FROM argus.STORE a, argus.CUSTOMER b, argus.ELIGIBLE_SUPPLIER c WHERE a.customer = b.customer AND a.customer = c.customer AND a.store = " & Session("store_id") & " AND b.customer = " & Session("customer_id") & " AND c.supplier = " & Trim(rst("supplier")) & ""
            Set rst2 = ConnFW.Execute(str2) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T19:59:12.777

你能提供额外的代码吗？您的代码没有任何问题，除非您需要确保在下划线后面的行中有内容：

```
email_text = email_text + "<html>" & _
               "" 
```

- 编辑

感谢您发布您的编辑。我看到了几个潜在的问题。在您的第二个记录集对象中，您尝试访问`rst("supplier")`，但尚未读取该字段。而不是 using `connfw.execute(str)`which 用于执行 sql 语句，如`INSERT`, `UPDATE`and `DELETE`，使用`rst.open`which 与 . 一起使用`SELECT`。

尝试类似：

```
supplier = ""

rst.open str, connfw

if not rst.eof then
   supplier = rst("supplier")
end if

rst.close 
```

然后在您的第二个 sql 语句中使用供应商。此外，如果合格供应商表中的供应商字段是字符串，则需要在 where 子句中将该字段用单引号括起来。

# ember.js - Ember CollectionView - 删除 ItemView

> ID：14266159
> 
> 赞同：0
> 
> 时间：2013-01-10T19:54:13.177
> 
> 标签：ember.js, collectionview

我很难找到答案，所以也许我做错了。我有一个带有项目视图类的集合视图。每个项目都有一个删除按钮，它指的是动作“removeItem”。这确实删除了该项目，但我需要参考集合视图内容，以便通过 API 调用发布更新后的数组。

```
App.WatchlistTilesView.Collection = Ember.CollectionView.extend({
  tagName: "ul",
  itemViewClass: Ember.View.extend({
    attributeBindings: "role",
    role: "tile",
    classNames: ["tile"],

    removeItem: function() {
      this.remove();
    },

    templateStock: Ember.Handlebars.compile("
      <button {{action removeItem}}>Delete</button> 
      ...
    "),
  })
}); 
```

**编辑：**

我找到了这个特定问题的答案。集合视图上有一个属性需要由项目类访问。我可以使用 this.get("parentView") 访问它。此外，我必须将视图添加为 removeItem 操作的目标。

它看起来像这样：

```
App.WatchlistTilesView.Collection = Ember.CollectionView.extend({
  tagName: "ul",
  itemViewClass: Ember.View.extend({
    attributeBindings: "role",
    role: "tile",
    classNames: ["tile"],
    watchlistBinding: "parentView.watchlist"

    removeItem: ->
      @remove()
      watchlist = @get("watchlist")
      @get("controller").removeSymbol(@content, watchlist)

    templateStock: Ember.Handlebars.compile("
      <button {{action removeItem target="view"}}>Delete</button>
      ...
    "),
  })
});

App.WatchlistTilesController = Ember.Controller.extend({
  account: null,
  watchlists: null,

  removeSymbol: function(entry, watchlist) {
    watchlist.entries.removeObject(entry);
    return WatchlistService.edit(this.account, watchlist);
  }
}); 
```

# perl - 如何使用 Perl 操作哈希引用？

> ID：14266160
> 
> 赞同：1
> 
> 时间：2013-01-10T19:54:14.350
> 
> 标签：perl

看看这段代码。经过数小时的反复试验。我终于找到了解决办法。但是不知道它为什么会起作用，老实说，Perl 让我陷入了一个循环。

```
use Data::Diff 'Diff';
use Data::Dumper;

my $out = Diff(\@comparr,\@grabarr);

my @uniq_a;

@temp = ();
my $x = @$out{uniq_a};
foreach my $y (@$x) {
    @temp = ();
    foreach my $z (@$y) {
        push(@temp, $z);
    }
    push(@uniq_a, [$temp[0], $temp[1], $temp[2], $temp[3]]);
} 
```

为什么我可以访问 $out 数组元素的唯一方法是将哈希键传递给一个标量，该标量已使用 for 循环转换为数组？ `my $x = @$out{uniq_a};`我完全糊涂了。我真的很感谢任何能解释这里发生了什么的人，所以我会知道未来的。提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:04:35.873

`$out`是一个哈希引用，并且您使用解引用运算符`->{...}`来访问它所引用的哈希成员，例如

```
$out->{uniq_a} 
```

您偶然发现的是 Perl 的哈希切片表示法，您可以在其中使用`@`哈希名称前面的符号来方便地从该哈希中提取值列表。例如：

```
%foo = ( a => 123, b => 456, c => 789 );
$foo = { a => 123, b => 456, c => 789 };
print @foo{"b","c"};    # 456,789
print @$foo{"c","a"};   # 789,123 
```

正如您所做的那样，在大括号内使用带有单个元素的哈希切片表示法不是典型用法，并且会意外地为您提供所需的结果。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:06:26.123

该`Diff`函数返回一个哈希引用。您正在`uniq_a`通过提取哈希的单元素切片而不是正确的`$out->{uniq_a}`. 您的代码应如下所示

```
my $out = Diff(\@comparr, \@grabarr);

my @uniq_a;
my $uniq_a = $out->{uniq_a};
for my $list (@$uniq_a) {
  my @temp = @$list;
  push @uniq_a, [ @temp[0..3] ];
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T20:02:11.913

在它的[文档](http://search.cpan.org/~gcampbell/Data-Diff-0.01/Diff.pm)中`Data::Diff`指出：

> 返回的值始终是哈希引用，并且哈希将具有以下一个或多个哈希键：type、same、diff、diff_a、diff_b、uniq_a 和 uniq_b

参考也是如此`$out`，您必须通过上述键访问值。

# python - wxpython：我将如何配置一个 box sizer 以便它有一个中心列，可以在调整大小时移动，但不改变尺寸（里面的图片说明）

> ID：14266161
> 
> 赞同：3
> 
> 时间：2013-01-10T19:54:21.357
> 
> 标签：python, wxpython

我不知道如何嵌套我的尺寸器，以便获得以下行为。

![在此处输入图像描述](../Images/0dec452d64b054ce77d1eab467a3185b.png)

当用户调整窗口大小时，我希望所有小部件的配置保持不变，但让包含所有内容的中央列保持居中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:58:34.080

使用 box sizer，您应该相应地调整*比例*。侧面的垫片应填满剩余空间，而中间部分应有固定的空间。请参阅以下[文档`wx.BoxSizer`](http://wxpython.org/docs/api/wx.BoxSizer-class.html)：

> 这是 box sizer 的独特之处，它可以在两个方向（高度和宽度）上增长，但可以在其子项之间不均匀地分布在主要方向（水平方向）上的增长。这是**由**添加到 sizer 时赋予项目的比例参数决定的。它被解释为权重因子，即它**可以为零，表示窗口可能根本不会调整大小**，或高于零。**如果多个窗口的值大于零，则该值将相对于 sizer 的所有权重因子的总和进行解释**，因此当添加两个值为 1 的窗口时，它们都将得到相同的大小调整，并且每个都将获得可用的一半固定大小的项目调整大小后的空间。

另请参阅这个小示例代码（使用 wxFormBuilder 生成）。我已经强调了垫片的比例为**1**而应用程序的比例为**0**。

```
class MyFrame1 (wx.Frame):
    def __init__(self):
        super(MyFrame1, self).__init__()

        fluid_sizer = wx.BoxSizer(wx.HORIZONTAL)
        fluid_sizer.AddSpacer((0, 0), 1, wx.EXPAND, 5)
        #                             ^--- proportion = 1

        self.fixed_panel = wx.Panel(self, wx.ID_ANY, wx.DefaultPosition, wx.Size(-1,-1), wx.TAB_TRAVERSAL)
        self.fixed_panel.SetBackgroundColour(wx.SystemSettings.GetColour(wx.SYS_COLOUR_HIGHLIGHT))
        fixed_sizer = wx.BoxSizer(wx.VERTICAL)
        fixed_sizer.SetMinSize(wx.Size(150,-1)) 
        self.m_button1 = wx.Button(self.fixed_panel, wx.ID_ANY, u"MyButton", wx.DefaultPosition, wx.DefaultSize, 0)
        fixed_sizer.Add(self.m_button1, 0, wx.ALL, 5)
        self.fixed_panel.SetSizer(fixed_sizer)
        self.fixed_panel.Layout()
        fixed_sizer.Fit(self.fixed_panel)

        fluid_sizer.Add(self.fixed_panel, 0, wx.EXPAND |wx.ALL, 5)
        #                                 ^--- proportion = 0

        fluid_sizer.AddSpacer((0, 0), 1, wx.EXPAND, 5)
        #                             ^--- proportion = 1

        self.SetSizer(fluid_sizer)
        self.Layout() 
```

![示例代码预览](../Images/d8acb01b548e3b14748796358990b326.png)

# php - 如何路由到模块？

> ID：14266162
> 
> 赞同：0
> 
> 时间：2013-01-10T19:54:28.827
> 
> 标签：php, fuelphp

我已经翻阅了文档，但似乎不知道如何将 URI 路由到模块。

我的模块当前包含一个使用正确目录结构的控制器（当前有大量空目录）。我在里面有我的控制器`modules/module_name/classes/controller`和我的路由文件`modules/module_name/config/routes.php`。

`/app/config/routes.php`我在和中都尝试了以下方法`modules/module_name/config/routes.php`：

```
<?php
return array(
    '_root_'  => 'md5_encrypt/index',  // The default route

    'tools/geek/md5_encrypt' => array('md5_encrypt'),
); 
```

控制器如下所示（但我认为这无关紧要）：

```
<?php

/**
 * MD5 Encrypt Controller.
 *
 * Online tool to encrypt a string using MD5
 * 
 * @package  app
 * @extends  Controller
 */

namespace Md5_encrypt;

class Controller_Md5_Encrypt extends Controller_Template
{

    /**
     * The tool
     * 
     * @access  public
     * @return  Response
     */
    public function action_index()
    {
        $data = array();
        $this->template->tab = 'geek';
        $this->template->title = 'MD5 Encrypt Tool';
        $this->template->content = View::forge('welcome/index', $data);     
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:19:42.147

命名空间名称中不能有下划线。控制器名称相同。

自动加载器在查找文件时会将下划线转换为目录分隔符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-09-24T08:19:18.370

首先，您应该在 app/config/config.php 中设置应用程序模块的路径

```
'module_paths' => array(
    APPPATH.'modules'.DS, // path to application modules
) 
```

在 app/config/routes.php 中设置第二个路由

```
'tools/geek/md5_encrypt' => 'md5_encrypt(module_name)/md5_encrypt(controller)', 
```

但是，由于您在 Controller 的 Name 中使用下划线`class Controller_Md5_Encrypt extends Controller_Template`，因此会产生一条新路径。

```
/modules/md5_encrypt/classes/controller/md5/encrypt.php 
```

**[在自动加载http://fuelphp.com/docs/general/coding_standards.html#classes期间，控制器名称中的](http://fuelphp.com/docs/general/coding_standards.html#classes)**下划线 (_)**已转换为目录分隔符**

 **`/modules/md5_encrypt/classes/controller/md5_encrypt.php`自动加载期间未找到您的文件。**

# python - 如何在 SublimeREPL 中运行文件？

> ID：14266164
> 
> 赞同：6
> 
> 时间：2013-01-10T19:54:50.950
> 
> 标签：python, sublimetext2, sublimerepl

要通过 SublimeREPL 插件运行文件，我选择 'Tools' -> 'SublimeREPL' -> 'Eval In REPL' -> 'File'

当我选择“文件”时，什么也没有发生。如何配置 Sublime Text 2 以使用指定的 REPL ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T11:29:08.207

我认为 SublimeREPL 只支持 python 文件，如果你看[这里](https://github.com/wuub/SublimeREPL#readme)你会发现它只是在 python 标题下提到了这个特性。

### Python

*   在本地或远程（1）virtualenv 中启动 python。
*   `Quickly run selected script or launch PDB.`
*   使用带有历史记录和多行输入的 SublimeText2 Python 控制台。

此外，如果您按（在 Windows 上）`shift+ctrl+p`，您会看到，如果您键入`repl current`它会说： `SublimeREPL: Python - RUN Current File`

作为唯一的选择，除了 PDB。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-17T20:53:18.107

正如@daniel-figueroa 所说，据我所知，SublimeREPL 只运行 Python 代码。

如果你只是想用 SublimeREPL*运行Python，试试：*

`Tools`-> `SublimeREPL`-> `Python`-> `Python`->`RUN current file`

或者，如果您真的打算使用 SublimeREPL 进行评估，插件作者 @wuub 会在此处解释并提供解决[方案](https://stackoverflow.com/a/12921385/3185548)。

# image - 有图像

> ID：14266165
> 
> 赞同：5
> 
> 时间：2013-01-10T19:54:56.313
> 
> 标签：image, jsf, primefaces, html-escape, selectonebutton

我正在使用带有 Primefaces 的 JSF，我想使用一个只有图像的单选按钮按钮集，但我无法让它工作。

这是代码：

```
 <p:selectOneButton value="#{LoginBean.user}" >  
        <f:selectItem itemLabel="&lt;img src=&quot;/myApp/faces/javax.faces.resource/myImg1.png?ln=img&quot;/&gt;" itemValue="1"/>
        <f:selectItem itemLabel="&lt;img src=&quot;/myApp/faces/javax.faces.resource/myImg2.png?ln=img&quot;/&gt;" itemValue="2"/>
    </p:selectOneButton> 
```

我尝试使用“escape”、“escapeItem”甚至“itemEscaped”属性来转义字符。[我在另一个问题中](https://stackoverflow.com/questions/14238646/how-to-escape-fselectitem-itemlabel-attribute)读到了最后一个。该问题中的解决方案使用`<h:selectOneRadio>`，而不是`<p:selectOneButton>`。

**注意：**我知道它使用 jQueryUI`buttonset()`方法工作（Primefaces 在后台使用它）所以这不是脚本问题..

那么，可以这样做`<p:selectOneButton>`吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T20:29:31.180

事实上， 的渲染器`<p:selectOneButton>`并没有考虑标签中的任何 HTML。最好的办法是将其设置为 CSS 背景图像。

给定一个

```
<p:selectOneButton ... styleClass="buttons"> 
```

`:nth-child()`您可以使用 CSS3伪选择器设置各个按钮的样式

```
.buttons .ui-button:nth-child(1) {
    background: url("#{resource['img/myImg1.png']}") no-repeat;
}
.buttons .ui-button:nth-child(2) {
    background: url("#{resource['img/myImg2.png']}") no-repeat;
} 
```

但是，如果您的目标浏览器不支持它（[某些 IE 版本](http://caniuse.com/css-sel3)），那么您将无法通过 JS/jQuery 执行这项工作。

```
$(".buttons .ui-button:eq(0)").css("background", "url('resources/img/myImg1.png') no-repeat");
$(".buttons .ui-button:eq(1)").css("background", "url('resources/img/myImg2.png') no-repeat"); 
```

* * *

**与具体问题无关**，您使用资源`library`的方式并不完全正确。仔细阅读[JSF 资源库是干什么用的，应该如何使用？](https://stackoverflow.com/questions/11988415/what-is-the-jsf-resource-library-for-and-how-should-it-be-used)了解更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-31T22:03:56.063

我只是想使用 Font Awesome Icons。这可以通过设置`font-family: FontAwesome`和使用以下代码来实现：[https ://fontawesome.com/v4.7.0/cheatsheet/](https://fontawesome.com/v4.7.0/cheatsheet/)

```
<p:selectOneButton value="#{mybean.alignment}" style="font-family: FontAwesome;">
   <f:selectItem itemValue="align-left" itemLabel="&#xf036;"/>
   <f:selectItem itemValue="align-center" itemLabel="&#xf037;"/>
   <f:selectItem itemValue="align-right" itemLabel="&#xf038;"/>
</p:selectOneButton> 
```

# c - 使用 -Wall 运行 ./configure 会导致找不到库

> ID：14266168
> 
> 赞同：1
> 
> 时间：2013-01-10T19:55:08.363
> 
> 标签：c, autotools, automake

我想在 autotools 项目中使用`-Wall`和`-Werror`作为 gcc 的标志，但我不想将它们放在我的 configure.ac 中。

因此，我尝试使用，只是从我的一个宏调用`./configure CFLAGS='-Wall -Werror'`中得到一个错误：`AC_SEARCH_LIBS`

```
AC_SEARCH_LIBS([pow], [m], , AC_MSG_ERROR([Could not find standard math library.])) 
```

运行配置时产生的错误`CFLAGS`添加：

```
configure: error: Could not find standard math library. 
```

我在这里做错了什么？没有 CFLAGS 变量集，配置工作正常。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T22:56:03.870

如您所知，将编译警告提升为错误会使`./configure`.

你可以做的是通过自定义`CFLAGS`时间`make`：

```
$ ./configure
$ make CFLAGS='-O2 -g -Wall -Wextra -Werror' 
```

另一个选项是 William Pursell 的方法：添加一个选项`./configure`以打开（`-Werror`如果支持）：

（配置.ac）

```
AC_ARG_ENABLE([werror],
              [AS_HELP_STRING([--enable-werror], [Use -Werror @<:@no@:>@])],
              [:],
              [enable_werror=no])
AM_CONDITIONAL([ENABLE_WERROR], [test "$enable_werror" = yes]) 
```

(Makefile.am)

```
if ENABLE_WERROR
AM_CFLAGS += -Werror
endif 
```

# ios - 在 iOS 中单击按钮启动不同的 ViewController

> ID：14266169
> 
> 赞同：1
> 
> 时间：2013-01-10T19:55:11.213
> 
> 标签：ios, uiviewcontroller, segue, pushviewcontroller, choice

我的项目在 iOS6 中。我的 iPhone 故事板上有三个 UIViewController。在第一个 UIVC 上，我有一个复选框和一个继续按钮。如果选中复选框并单击按钮，则我必须启动第二个 UIViewController。如果未选中复选框并单击按钮，则启动第三个 UiViewController。我该怎么做？到目前为止，我已经这样做了：

```
- (IBAction)btnContinue:(UIButton *)sender
{
if (self.shipToDifferentAddress)//Checkbox CLICKED->YES
{
    //Launch ShippingVC
    ITMShippingAddressVC *shippingVC = [[ITMShippingAddressVC alloc]init];
    [[self navigationController]pushViewController:shippingVC animated:YES];
}
else //Checkbox unchecked ->NO
{
    //Launch OrderedItemsVC
    ITMOrderedItemsVC *orderedVC = [[ITMOrderedItemsVC alloc]init];
    [[self navigationController]pushViewController:orderedVC animated:YES];
}
} 
```

self.shipToDifferentAddress 是一个布尔变量，告诉启动这个或那个。我记录了两个 viewDidLoads 并得到了它们的输出。第二个和第三个 UIViewController 上都有一些内容，如按钮、标签等。但它们看起来是黑色的。没有内容。我在它们两个上都有返回按钮，我可以从其中一个返回到第一个 UIVC。所以我错过了什么？我在必须去特定 UIVC 的情况下使用 segues。现在我可以选择第二个或第三个。我该怎么做？如果您需要更多信息，请告诉我。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:21:56.677

要展示 Storyboard 中的 ViewController，请按照以下步骤操作：

```
 UIStoryboard *mainStoryboard = [UIStoryboard storyboardWithName:@"MainStoryboard"
                                                             bundle: nil];
    ITMShippingAddressVC *viewController = (ITMShippingAddressVC*)[mainStoryboard
                                                                         instantiateViewControllerWithIdentifier: @"ITMShippingAddressVC"]; 
```

在情节提要中设置标识符..单击您的视图，然后在右侧的属性菜单中设置情节提要 ID ![在此处输入图像描述](../Images/507ae60000942fecaf58a4118222c9c8.png)

比你可以像往常一样推动：

```
[[self navigationController]pushViewController:viewController animated:YES]; 
```

虽然这对你有用——在使用 Storyboards 时，理想情况下你想使用 Segues。它需要更少的代码。这是一个关于使用 segues 推送/呈现视图控制器并在它们之间传递数据[的好教程。](http://www.scott-sherwood.com/ios-5-storyboards/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:16:20.807

您已经创建了 VC，但它们没有链接到故事板 ITMOrderedItemsVC 和 ITMShippingAddressVC。因此，您在情节提要中添加的界面不会被加载。

您可以做的是为每个 VC 创建一个单独的 xib 文件（新建 > 文件... > 用户界面 > 视图）。将 xib 文件命名为与您的 viewController 相同的名称：

```
ITMOrderedItemsVC.xib
ITMShippingAddressVC.xib 
```

在这些 xib 文件中设计您的界面（它们就像单实体故事板）。

当您`init`创建相应 viewController 的实例时，将自动加载 xib。

这将适用于您当前的代码。

# html - 如何左对齐这些 Bootstrap 表单项？

> ID：14266175
> 
> 赞同：45
> 
> 时间：2013-01-10T19:55:28.080
> 
> 标签：html, css, forms, twitter-bootstrap

我是第一次使用 Bootstrap，在将这个表单水平对齐到左边时遇到了很多麻烦。

列表项应该是水平的，但我希望控制标签（表单标签的 Bootstrap 类）都位于向左浮动的相同位置。

该表单包含在一个跨度为 7 的 div 中，因为我的网站有两列 - 7 列和 4 列。

下面是我的 HTML。如果您查看此页面[http://accounts.tao.tw.shuttle.com/examples_bootstrap/basecss/forms](http://accounts.tao.tw.shuttle.com/examples_bootstrap/basecss/forms)上的“水平表单” ，您会看到标签左对齐，但不是绝对左对齐，因此标签的开头垂直位于同一位置。

```
<form class="form-horizontal">
    <div class="control-group">
        <label class="control-label" for="inputSaving">What are you saving for?</label>
        <div class="controls">
            <input class="span4" type="text" id="inputSaving" placeholder="e.g. Swimming Lessons, Birthday Party, College Fund, etc.">
        </div>
    </div>
    <div class="control-group">
        <label class="control-label" for="description">Add a short description</label>
        <div class="controls">
            <textarea class="span4" rows="4" placeholder="Describe in your own words the saving goal for this piggybank"></textarea>
        </div>
    </div>
    <div class="control-group">
        <label class="control-label" for="categoryselect">Choose a Category</label>
        <div class="controls">
            <select class="span4">
                <!-- Add some CSS and JS to make a placeholder value-->
                <option value="Kittens">Kittens</option>
                <option value="Keyboard Cat">Keyboard Cat</option>
                <option value="Twitter Bird">Twitter Bird</option>
            </select>
        </div>
    </div>
    <div class="control-group">
        <label class="control-label" for="goal">Your Saving Goal</label>
        <div class="controls">
            <input type="text" class="span4" id="goal">
        </div>
    </div>
    <button class="btn btn-large btn-primary" type="button">Submit</button>
</form> 
```

* * *

## 回答 #1

> 赞同：58
> 
> 时间：2015-05-21T10:29:16.023

只是我的两分钱。如果您使用的是 Bootstrap 3，那么我只需在您自己网站的样式表中添加一个额外的样式，该`text-left`样式表控制`control-label`.

如果要添加`text-left`到标签中，默认情况下会有另一种样式覆盖 this `.form-horizontal .control-label`。因此，如果您添加：

```
.form-horizontal .control-label.text-left{
    text-align: left;
} 
```

然后将内置`text-left`样式正确应用于标签。

* * *

## 回答 #2

> 赞同：38
> 
> 时间：2013-01-11T03:01:29.210

如果你说你的问题是如何左对齐表单标签，看看这是否有帮助：http:
[//jsfiddle.net/panchroma/8gYPQ/](http://jsfiddle.net/panchroma/8gYPQ/)

尝试在 CSS 中更改文本左/右对齐

```
.form-horizontal .control-label{
    /* text-align:right; */
    text-align:left;
    background-color:#ffa;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2014-12-17T20:32:54.280

不要更改原始引导 css 类，而是创建一个新的 css 文件，该文件将覆盖默认样式。

确保在包含 bootstrap.css 文件后包含新的 css 文件。

在新的css文件中做

```
.form-horizontal .control-label{
   text-align:left !important; 
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-03-04T15:59:20.947

“拉左”是你需要的，看起来你正在使用 Bootstrap 2，我不确定它是否可用，考虑 bootstrap 3，除非它是一个巨大的返工！... 对于 Bootstrap 3，但您需要确保每行也有 12 列，否则您会遇到问题。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-05-03T15:19:25.497

只需添加`style="text-align: left"`到您的标签。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2021-03-03T19:43:50.043

`text-align:left;`对我不起作用，但通过添加`display:flex;`我能够将标签放在左侧。

* * *

## 回答 #7

> 赞同：-3
> 
> 时间：2016-04-22T15:32:59.327

我遇到了完全相同的问题。我在 bootstrap.min.css 中发现了这个问题。您需要更改标签 `label {display:inline-block;}`：`label {display:block;}`

# iis - Backup-WDServer：如何指定加密密码

> ID：14266180
> 
> 赞同：0
> 
> 时间：2013-01-10T19:55:43.537
> 
> 标签：iis, powershell, msdeploy, iis-8, cmdlet

我阅读了有关[Web Deploy Powershell Cmdlets](http://www.iis.net/learn/publish/using-web-deploy/web-deploy-powershell-cmdlets)的信息，我想开始使用它们。当然，我开始的第一个任务是备份我的测试网络服务器的当前配置状态——这个 cmdlet 应该这样做：

```
Backup-WDServer -ConfigOnly 
```

但是，当我运行它时，我收到了这个投诉——我不确定如何解决它：

```
Backup-WDServer : The property 'password' located at '/webServer/appHostConfig[@path='']/location[@path='']/section[@name='system.applicationHost/applicationPools']/applicationPools/applicationPoolDefaults/processModel' is 
marked as secure. You must specify an encryption password to archive this property.
At line:1 char:1
+ Backup-WDServer -ConfigOnly
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : InvalidOperation: (:) [Backup-WDServer], DeploymentEncryptionException
    + FullyQualifiedErrorId : Microsoft.Web.Deployment.PowerShell.BackupServer 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-11T03:25:53.860

我在查找文档时遇到了麻烦，但是在花了时间使用 IL DASM 之后，在问题中提供的链接中阅读了更多内容并进行了实验，我发现这很有效：

```
Backup-WDServer -SourceSettings @{encryptPassword='password'} -ConfigOnly 
```

如果有人有更完整文档的链接，我将不胜感激——但 Bing 和 Google 并没有找到太多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2018-05-10T17:22:31.923

这是一个旧线程，但是有答案：

```
Restore-WDServer -DestinationSettings @{encryptPassword='password'} -Package /path/to/the/zip/file 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-10-11T19:32:40.540

如何为 Restore-WDServer 设置 encryptpassword？如果你这样做是为了备份

Backup-WDServer -SourceSettings @{encryptPassword='password'} -ConfigOnly

# asp.net - 使用 Ajax Control Toolkit for ASP.net 时如何避免重新发布语言文件夹

> ID：14266182
> 
> 赞同：2
> 
> 时间：2013-01-10T19:55:49.937
> 
> 标签：asp.net, asp.net-ajax

我正在使用 Ajax Control Toolkit for ASP.NET。

每当我更改我的代码（**与 Ajax 控件无关**）并重新发布项目时，似乎 Ajax 控件工具包的所有语言文件夹都不必要地重新发布。

我该如何避免这种情况？如果我的页面只有英文，那么这些文件夹首先是必需的吗？

```
2>Publishing folder bin/ar...
2>Publishing folder bin/cs...
2>Publishing folder bin/de...
2>Publishing folder bin/es...
2>Publishing folder bin/fr...
2>Publishing folder bin/he...
2>Publishing folder bin/hi...
2>Publishing folder bin/it... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-06T16:02:23.220

只是如果您在开发中没有使用它们，请将它们全部删除并保留您正在使用的那个，我记得这样做，只是复制我真正使用的内容

旁注：我建议停止使用 ajax 控制工具包，因为微软很久以前不再推荐它，并且事件 microsoft 正式停止使用它并改用 jquery

# image-processing - 在 calchist opencv 中选择频道

> ID：14266186
> 
> 赞同：3
> 
> 时间：2013-01-10T19:56:02.553
> 
> 标签：image-processing, opencv, computer-vision, vision

我有计算 hsv 和 yuv 图像直方图的代码。当我试图获得仅对应于亮度的值时，我想要来自 hsv 图像的“v”通道值和来自 yuv 图像的亮度（“y”）通道值。这是我使用的代码。

```
 int channels[] = {0};
    calcHist(&src_yuv,1,channels,Mat(),hist,1,histSize,ranges,true,false); 
```

此示例代码适用于 yuv。我只是将 {0} 更改为 {2} 以从 HSV 获取“v”通道值。我得到了某些结果，但不确定是否选择了正确的渠道。你能帮我看看这些数字是否选择了我想要的确切频道吗？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:42:38.607

要绝对确定频道号`X`与您所追求的频道相对应，请查阅[IPL 图像结构](http://opencv.willowgarage.com/documentation/basic_structures.html#iplimage)`channelSeq`的属性。如果给出你所追求的频道的名称（一个字符），那么你找到了它。`channelSeq[X]`

但是，鉴于此属性的记录方式（以及其他有趣的属性），即使您一直使用`IPLImage`，也不能保证其中包含的信息是准确的。因此，要绝对确定图像中的通道序列，您必须信任转换规范并自己记住这一点。因此，如果您从 in 中的图像开始`BGR`并使用 进行转换`BGR2YUV`，那么您相信`Y`通道是第一个，依此类推。如果 OpenCV 曾经更改`BGR2YUV`为意味着`Y`进入最后一个频道，依此类推，那么对你来说太糟糕了。

# excel - 如何阻止/清除与 VBA 中的条件 if 语句匹配的列中每个单元格的数据？

> ID：14266187
> 
> 赞同：1
> 
> 时间：2013-01-10T19:56:18.373
> 
> 标签：excel, vba, if-statement

我是 excel 中的 VBA 编程新手，想知道如何执行以下操作（我已经搜索了 google，并将在此处发布我尝试过的示例代码）。

G 列，从 G11 开始，一直到工作表的末尾，包含 2 个值：“全职”或“兼职”。

在 S 列中，从 S11 开始一直到工作表的末尾，我们的会计师将输入一个美元值。会计师希望 G 列中的 excel 单元格阻止/清除任何数据，并弹出一条消息，提示“您不能在 G 列中编辑此单元格，因为员工是兼职”。

我使用了此代码，但它仅适用于第 11 行。我希望这适用于 G 列中的每一行。您有任何指示或提示吗？提前致谢。我使用 2 个事件 Change 和 SelectionChange

```
Private Sub Worksheet_Change(ByVal Target As Range)
If [$G11] = "Part Time" Then
[$S11].Interior.ColorIndex = 34
[$S11].ClearContents
[$S11].Locked = True
Else
[$S11].Interior.ColorIndex = 12
[$S11].Locked = False
End If
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

If [$G11] = "Part Time" Then
[$S11].ClearContents
[$S11].Locked = True
Else
[$S11].Locked = False

End If
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:00:42.943

试试这个。我根据你写的内容做了一些假设，所以如果它不太适合你的数据，请告诉我。

```
Private Sub Worksheet_Change(ByVal Target As range)

If Not Intersect(Target, .Columns("S:S")) Is Nothing Then 'only do this if column S is changed

    Application.EnableEvents = False

    If range("G" & Target.Row) = "Part Time" Then

        With range("S" & Target.Row)
            .Interior.ColorIndex = 34
            .ClearContents
            .Locked = True
        End With

    Else

        With range("S" & Target.Row)
            .Interior.ColorIndex = 12
            .Locked = False
        End With

    End If

    Application.EnableEvents = True

End If

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As range)

If Not Intersect(Target, .Columns("S:S")) Is Nothing Then 'only do this if column S is changed

    Application.EnableEvents = False

    If range("G" & Target.Row) = "Part Time" Then

        With range("S" & Target.Row)
            .ClearContents
            .Locked = True
        End With

    Else
        range("S" & Target.Row).Locked = False

    End If

    Application.EnableEvents = True

End If

End Sub 
```

# wpf - WPF 列表视图。如何同时支持该行的行背景颜色和alternateIndex

> ID：14266188
> 
> 赞同：0
> 
> 时间：2013-01-10T19:56:19.310
> 
> 标签：wpf, xaml, listview, triggers

我有一个`listview`包含日志消息的。`listview`我想根据相应条目的严重性为每一行设置背景颜色。我使用`DataTrigger` *（参见示例）*执行此操作。

我也想`AlternationIndex`支持`listview`. 如何将它们组合成行*`xaml DataTrigger abd Trigger`*的背景颜色？

对于为行设置背景颜色，我使用以下代码：

```
<ListView ... >
    <ListView.ItemContainerStyle>
        <Style TargetType="{x:Type ListViewItem}">
            <Style.Triggers>
                <DataTrigger Binding="{Binding Path=Severity} Value="Info">

                   <Setter 
                     Property="Background" 
                     Value="{Binding Path=Severity,
                             Converter=
                               {StaticResource msgSeverityToColorConverter}}" 
                   />

                 </DataTrigger>

                 <DataTrigger Binding="{Binding Path=Severity} Value="Error">

                   <Setter 
                     Property="Background" 
                     Value="{Binding Path=Severity, 
                             Converter=
                            {StaticResource msgSeverityToColorConverter}}"
                    />

                 </DataTrigger>

            </Style.Triggers>

        </Style>

    </ListView.ItemContainerStyle>

</ListView> 
```

对于 AlternateIndex 我有以下代码：

```
<Style.Triggers>
    <Trigger Property="ItemsControl.AlternationIndex" Value="1">

        <Setter Property="Background" Value="LightBlue"></Setter>

     </Trigger>

    <Trigger Property="ItemsControl.AlternationIndex" Value="2">

   <Setter Property="Background" Value="LightGray"></Setter>

    </Trigger>

 </Style.Triggers> 
```

我需要当带有消息的行不是`Info`or`Error`时，它将是`AlternationIndex`属性的颜色。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:20:35.537

这都是由于触发器声明的顺序。首先声明交替触发器，然后声明严重性触发器。

```
<Style.Triggers>
    <Trigger Property="ItemsControl.AlternationIndex" Value="1">
        <Setter Property="Background" Value="LightBlue"></Setter>
    </Trigger>
    <Trigger Property="ItemsControl.AlternationIndex" Value="2">
       <Setter Property="Background" Value="LightGray"></Setter>
    </Trigger>
    <DataTrigger Binding="{Binding Path=Severity} Value="Info">
        <Setter Property="Background" 
                Value="{Binding Path=Severity,
                Converter="{StaticResource msgSeverityToColorConverter}}" />
    </DataTrigger>
    <DataTrigger Binding="{Binding Path=Severity} Value="Error">
        <Setter Property="Background" 
                Value="{Binding Path=Severity, 
                Converter="{StaticResource msgSeverityToColorConverter}}" />
    </DataTrigger>
</Style.Triggers> 
```

# objective-c - 如何防止子视图在选择父视图之前绘制？

> ID：14266189
> 
> 赞同：0
> 
> 时间：2013-01-10T19:56:22.260
> 
> 标签：objective-c, nstabview

我有一个带有 3 个选项卡的 NSTabView。我想阻止这些选项卡的子视图在被选中之前绘制。我该怎么做呢？我已经为 NSTabView 设置了一个委托，但无法确定选择了哪个选项卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:03:16.590

我有类似的问题（*我有两个视图，view2 上方的 view1 和 view2 的子视图是在 ai 拖动 view1 时绘制*的）
出路是制作一个包含所有子视图的 tmpView， `[tmpView setHidden:YES];`如果它不是活动视图，则进行切换view2 激活时的可见性。

# codeigniter - Codeigniter - 传递多个参数

> ID：14266190
> 
> 赞同：2
> 
> 时间：2013-01-10T19:56:27.243
> 
> 标签：codeigniter

我正在尝试将多个参数从我的控制器传递给我的模型。在我提交表单后，我试图传递的似乎`$scholId`不会通过模型。但是，`$userId`通过数据库就好了。有什么问题`$this->uri->segment(4)`不能正确通过吗？

```
function apply() 
{
    $this->load->helper('form');
    $this->load->library('form_validation');

    $scholId = $this->uri->segment(4);

    $userId = '2'; //User query -> this will be taken from session

    $this->data['scholarship'] = $this->scholarship_model->getScholarship($scholId);
    $this->data['title'] = "Apply";

    $this->form_validation->set_rules('essay', 'Essay', 'required');

    if ($this->form_validation->run() === FALSE)
    {
        $this->load->view('templates/header', $this->data);
        $this->load->view('student/page_head', $this->data);
        $this->load->view('student/form', $this->data);
        $this->load->view('templates/footer', $this->data);
    }else{
        // Validation passes
        $this->users_model->applySchol($userId,$scholId);
        redirect('/scholarships');
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:18:57.037

您需要在传递之前检查该段是否存在，例如：

```
if ($this->uri->segment(4) === FALSE)
{
    $schoId = 0; //or anything else so that you know that does not exists
}
else
{
    $schoID= $this->uri->segment(4);
} 
```

或者简单地说：

```
$product_id = $this->uri->segment(4, 0);
//which will return 0 if it doesn't exists. 
```

# asp.net - Infragistics WebDropdown 显示问题

> ID：14266197
> 
> 赞同：0
> 
> 时间：2013-01-10T19:56:47.373
> 
> 标签：asp.net, infragistics, netadvantage

我安装了 Infragistics 2012 并在我的网页中添加了一个 WebDropdown。当我将鼠标悬停在 webdropdown 上时，下拉菜单会变大一些，并且箭头图像会消失。这适用于 Internet Explorer。当我尝试使用 Firefox 时，下拉菜单的大小保持不变，但箭头消失了，我无法点击它。有任何想法吗？

PS：我在 IIS 下有一个虚拟目录，它指向 ig_res 样式文件夹。![在此处输入图像描述](../Images/6cc20e2ee50a40454212890a1c3df47d.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T21:35:06.130

确保您在样式库中的图像文件夹中有用于悬停图像的图像。该图像应命名为 igdd_DropDownButtonHover.png 并且应位于 ig_res/[styleset]/images 中。

如果图像确实丢失，您需要从 Infragistics 提供的样式库中复制它。如果图像存在，您应该使用浏览器或提琴手的网络工具来查看请求该图像时服务器的响应是什么。

# php - 区分 bash/shell 和 cmd

> ID：14266203
> 
> 赞同：0
> 
> 时间：2013-01-10T19:57:02.653
> 
> 标签：php, bash, shell, cmd, command-line-interface

是否可以在 PHP CLI 脚本中确定我在哪种 CLI 环境中？

我想自动启用对 bash 实例的颜色支持，包括原生 linux 和 MingW32/Cygwin bash，并在 Windows 命令提示符/Cmd 中禁用它（否则它看起来很难看）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:06:47.717

如果您有权访问`$_ENV`数组 [又名 php.ini 中有一个`E`in `variables_order`]，那么您应该能够读取`SHELL`环境变量。

例如：

```
# echo $SHELL
/bin/bash
# php -r 'echo $_ENV["SHELL"];'
/bin/bash
# php -r 'echo ini_get("variables_order");'
EGPCS 
```

# css - 具有“contenteditable”的元素显示奇怪的光标位置

> ID：14266204
> 
> 赞同：0
> 
> 时间：2013-01-10T19:57:05.383
> 
> 标签：css, html

我正在使用一个慷慨`contenteditable`的`h1`元素`line-height`。当我尝试编辑 时`h1`，我必须将光标定位在元素边界的最顶部。我希望能够直接单击元素并编辑它的文本。

HTML：

```
 <div>
     <h1 contenteditable="true">Edit Me</h1>
   </div> 
```

CSS：

```
 h1 { 
      font: 16px/48px Helvetica, Arial, sans-serif;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
     } 
```

我已经尝试减少`line-height`，但问题仍然存在。下图是问题的表示。

![下图是问题的表示。](../Images/6a5f1c444511f8029514e35dc7a33d5a.png)

# c# - 尝试执行 cs WebMethod 时禁止跨域 AJAX POST 403

> ID：14266209
> 
> 赞同：0
> 
> 时间：2013-01-10T19:57:16.730
> 
> 标签：c#, javascript, ajax, cross-domain, cors

请原谅我对 Web 开发术语的无知。

我正在尝试执行以下 [WebMethod]：

```
public static void CreatePendingCaseFromChat(string userInputs)
{
    //Do a bunch of stuff here with the userInputs string
} 
```

使用以下 AJAX（位于另一台服务器上）：

```
$.ajax({    type: "POST", 
            url: "http://www.MyCoolWebDomain.com/Code/MyCode.aspx/CreatePendingCaseFromChat",
            crossDomain: true,
            data: JSON.stringify(parameters), 
            contentType: "application/json; charset=utf-8", 
            dataType: "json",
            success: function (data){alert("success in ajax call")}, 
            error: function (data){alert("error in ajax call")}
        }); 
```

MyCode.aspx 在 Page_Load() 方法中包含以下行：

```
Response.AppendHeader("Access-Control-Allow-Origin", "*"); //Allow Cross domain AJAX call, update the "*" to be a specific URL
Response.AppendHeader("Access-Control-Allow-Methods", "GET, POST, OPTIONS");
Response.AppendHeader("Access-Control-Allow-Headers", "content-type, x-requested-with"); 
```

如果我执行以下操作，而不是 ajax 调用：

```
var invocation = new XMLHttpRequest();
var url = "http://www.MyCoolWebDomain.com/Code/MyCode.aspx/CreatePendingCaseFromChat"
if (invocation) {
    invocation.open('POST', url, false);
    invocation.send();
    }
else {
    alert("no invocation");
} 
```

然后我可以通过 FireBug 确认设置了以下响应标头：

```
Access-Control-Allow-Head...    content-type, x-requested-with
Access-Control-Allow-Meth...    GET, POST, OPTIONS
Access-Control-Allow-Orig...    * 
```

使用 AJAX 调用，这些标头都不会显示。

无论是使用 AJAX 调用还是使用 XHR 调用，我都想以任何一种方式进行这项工作。

对于 XHR 调用，我不知道如何将 userInputs 字符串发送到 WebMethod。对于 AJAX 调用，我无法通过预检或调用它（OPTIONS 调用）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T13:48:19.207

我已经发布了一堆关于问题的代码：

[CORS - Ajax 错误函数将返回 401 的 API 请求的错误代码报告为 0](https://stackoverflow.com/questions/14268706/cors-ajax-error-function-reports-error-code-as-0-for-an-api-request-returning)

它正在使用 MVC4，但应该为您提供使其正常工作所需的一切。

# oracle - 单行子查询返回多行时的第一行

> ID：14266213
> 
> 赞同：1
> 
> 时间：2013-01-10T19:57:26.493
> 
> 标签：oracle, subquery

我的子查询返回不止一行，我需要第一行并保留我的 max 函数

```
Select ...
Where GHTY_FIRME.FIRME_ID= (Select   FIRME_ID
                           FROM imag_verification_tube 
                           WHERE (numero_dossier =  '12004' OR NUMERO_TIRE= '12004')
                           AND CREE_LE = (select max (CREE_LE) 
                           from tableX where(numero_dossier ='12004' OR 
                           NUMERO_PQDCS= '12004 '))); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:06:59.373

使用[`rownum`](http://docs.oracle.com/cd/B19306_01/server.102/b14200/pseudocolumns009.htm)伪列：

```
Select ...
Where GHTY_FIRME.FIRME_ID= (Select   FIRME_ID
                           FROM imag_verification_tube 
                           WHERE (numero_dossier =  '12004' OR NUMERO_TIRE= '12004')
                           AND CREE_LE = (select max (CREE_LE) 
                                          from tableX 
                                          where(numero_dossier ='12004' 
                                               OR NUMERO_PQDCS= '12004 ') 
                                               and rownum < 2)); 
```

另请参阅[关于 ROWNUM 和限制结果](http://www.oracle.com/technetwork/issue-archive/2006/06-sep/o56asktom-086197.html)。

也就是说，您可以尝试优化 sql。我要做的第一件事就是将内部 SQL 转换为连接。此外，根据您的业务逻辑，也可以消除 or*条件*。

# python - gevent install error: `next' undeclared (first use in this function)

> ID：14266216
> 
> 赞同：1
> 
> 时间：2013-01-10T19:57:37.097
> 
> 标签：python, gevent, python-requests

我正在尝试使用 python 2.7.2 的开发版本在 RHEL 4.8 上安装 gevent。
我已经安装了 libevent2-2.0.10（开发版）和 greenlet。

当我执行 sudo pip install gevent 时，出现以下错误：

```
gevent/core.c: In function `__pyx_pf_6gevent_4core_17http_request_base_12get_input_headers':
gevent/core.c:10388: warning: implicit declaration of function `TAILQ_FIRST'
gevent/core.c:10388: warning: assignment makes pointer from integer without a cast
gevent/core.c:10494: warning: implicit declaration of function `TAILQ_NEXT'
gevent/core.c:10494: error: `next' undeclared (first use in this function) 
```

有谁知道这个错误的来源可能是什么？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-22T15:17:35.563

尝试安装对我有用的 libevent-1.4.13-stable

# google-app-engine - 如何在 GAE 中启用浏览器缓存

> ID：14266219
> 
> 赞同：6
> 
> 时间：2013-01-10T19:57:53.650
> 
> 标签：google-app-engine

尽管这个问题应该是微不足道的，但我没有成功在 web google app engine java 服务器上启用浏览器缓存。

我尝试将这种东西放在我的 appengine-web.xml 中：

```
<static-files>
  <include path="/**.cache.**" expiration="365d" />
... 
```

但是当我查看响应头时，我在本地找到了这个：

```
Content-Length: 196084
Cache-Control: public, max-age=31536000
Expires: Fri, 10 Jan 2014 19:40:45 GMT
Content-Type: image/png
Last-Modified: Tue, 18 Dec 2012 21:41:22 GMT
Server: Jetty(6.1.x) 
```

这很好......但这在生产环境中：

```
HTTP/1.1 304 Not Modified
ETag: "RV4Bpg"
X-AppEngine-Estimated-CPM-US-Dollars: $0.000000
X-AppEngine-Resource-Usage: ms=109 cpu_ms=0
Date: Thu, 10 Jan 2013 19:41:20 GMT
Pragma: no-cache
Expires: Fri, 01 Jan 1990 00:00:00 GMT
Cache-Control: no-cache, must-revalidate
Server: Google Frontend 
```

这绝对不是我想要的:(

任何的想法 ？我错过了什么？

**[编辑]** 对于尚未下载的内容，我的浏览器会收到以下标题：

```
HTTP/1.1 200 OK
ETag: "RV4Bpg"
Date: Fri, 11 Jan 2013 12:50:50 GMT
Expires: Sat, 11 Jan 2014 12:50:50 GMT
Cache-Control: public, max-age=31536000
X-AppEngine-Estimated-CPM-US-Dollars: $0.000000
X-AppEngine-Resource-Usage: ms=3 cpu_ms=0
Date: Fri, 11 Jan 2013 12:50:50 GMT
Pragma: no-cache
Expires: Fri, 01 Jan 1990 00:00:00 GMT
Cache-Control: no-cache, must-revalidate
Content-Type: image/png
Server: Google Frontend
Content-Length: 196084
Proxy-Connection: Keep-Alive
Connection: Keep-Alive
X-RBT-Optimized-By: eu-dcc-sh02 (RiOS 6.5.5b) SC 
```

一个 ETag 和几个相互矛盾的 'Expires' 和 'Cache-Control' ... 有几种方法可以配置缓存策略？它可能来自我的 ISP 吗？还是代理？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-10T01:18:10.207

当您以管理员身份登录 Google App Engine 应用程序时：

1.  `X-AppEngine-*`包括您的问题中显示的标题。
2.  包含标`Cache-Control: no-cache, must-revalidate`头，因为`X-AppEngine-*`标头是私有的，不得缓存。

这隐藏在[https://developers.google.com/appengine/docs/python/runtime#Responses](https://developers.google.com/appengine/docs/python/runtime#Responses)的 Responses 部分的末尾，它说：

> 带有资源使用统计信息的响应将不可缓存。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T21:57:08.260

是，`Cache-Control`已关闭，因为回复是 HTTP 304。

问题是您的浏览器保存了 ETag：[http ://en.wikipedia.org/wiki/HTTP_ETag](http://en.wikipedia.org/wiki/HTTP_ETag)

现在，对于相同 url/内容的每个请求，浏览器都会提供带有 HTTP 304 Not Modified 的 ETag 和 GAE 回复。

尝试更改此 url 的资源（图像），检查您尚未在此浏览器中加载的另一个 url 或完全使用其他浏览器或计算机。

此外，这是相关[的：什么优先：ETag 或 Last-Modified HTTP 标头？](https://stackoverflow.com/questions/824152/what-takes-precedence-the-etag-or-last-modified-http-header)

# regex - Emacs 字体化文档注释

> ID：14266220
> 
> 赞同：3
> 
> 时间：2013-01-10T19:58:03.263
> 
> 标签：regex, emacs

在 emacs 中，当您执行文档注释时，它会正确突出显示以`/**`. 例子：

```
/**
 * @brief: Test
 */ 
```

将使用 font-lock-string-face 和 font-lock-doc-face 正确字体化。

有些人用 doc 注释`///`代替，而 Emacs 没有使用 font-lock-doc-face 和 font-lock-string-face 来字体化。有没有办法让 emacs 也字体化这些类型的文档注释？我正在尝试为 C/C++ 完成此任务，但灵活的解决方案会很好。

编辑：稍微浏览一下emacs源代码后，我发现这是在lisp/progmodes文件夹中的cc-fonts.el中处理的。看起来`c-font-lock-doc-comments`可以用不同的前缀参数调用，修改它可能会修复它。当我有更多时间时，我会尝试看看需要改变什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T21:22:11.107

```
(defconst custom-font-lock-keywords
  `((,(lambda (limit)
        (c-font-lock-doc-comments "///"
                                  limit gtkdoc-font-lock-doc-comments)))))
(setq-default c-doc-comment-style (quote (gtkdoc javadoc autodoc custom))) 
```

只需放入一个 .emacs 文件就可以了。您可以自定义关键字，但我只使用默认的 gtkdoc 关键字，因为这对我有用。

感谢 wvxvw 提供指向`c-doc-comment-style`.

经过一番测试后，这不适用于多行`///`注释（每行都以单独的行开头`///`）。修复后会编辑。

# xcode - 我怎样才能知道消息是从哪里发送的

> ID：14266222
> 
> 赞同：1
> 
> 时间：2013-01-10T19:58:04.553
> 
> 标签：xcode, debugging, release, nszombie

我正在使用开源库的 obj-c 端口，其中似乎存在错误。它非常大，单步通过它并不是一个真正的选择。

我已经能够弄清楚崩溃是由以下原因引起的。

`-[CALayer release]: message sent to deallocated instance 0x1d847aa0`

有没有办法让我找出消息的来源或更好的是什么对象隐藏在后面：`0x1d847aa0`？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:15:55.387

您可以在“编辑方案...”设置的“诊断”选项卡中“启用僵尸对象”。

如果一条消息被发送到一个已释放的实例，Xcode 就会中断。

您还可以使用 Instruments 进行分析，使用“僵尸”工具，这将显示僵尸对象的整个分配/保留/释放历史记录：

![在此处输入图像描述](../Images/4e98c616b0723d921300c086c0b4c42d.png)

# android - 如何从非活动类调用 startactivityforresult 以获取结果

> ID：14266225
> 
> 赞同：16
> 
> 时间：2013-01-10T19:58:22.120
> 
> 标签：android, android-activity

是否可以`startActivityForResult()`从非活动类调用以获取结果？

场景是这样的：

我有一个类`NonActivity`（它不是从 Activity 派生的，因为它不是 UI）。这个类将有一堆功能（基本上是步骤）来运行。其中一个步骤需要显示 UI(Activity)，然后获取结果（用户输入内容）。然后能够在接下来的步骤中使用该数据。

由于我没有 UI 组件，如何在不从活动类派生的情况下实现这一点？另外，由于我不想从活动类派生，这意味着我不能覆盖`OnActivityResult()`. 结果实际上来自哪里？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-01-10T20:00:02.373

`startActivityForResult()`只能从真正的屏幕活动中获得，因为它是 Activity 中的一种方法。请重新设计您的应用程序，以便用户界面由活动驱动。

另一方面，如果您的非 Activity 类是从屏幕上的 Activity 初始化和使用的，则可以将该 Activity 的实例作为构造函数中的参数传递给您的类，并使用它来启动其他 Activity。

不过要小心。使用此方法会增加内存泄漏的风险，因为外部类（在我的示例中为 Utils）可能会保留对 Activity 的引用，即使它消失了。

如果您只想访问数据，那么您可以尝试将其写入 SharedPreferences 或数据库或某些文件，然后使用应用程序上下文（再次通过构造函数传入）来读取它。这降低了内存泄漏的风险。就像是：

```
MyApiClass myApiClass = new MyApiClass(getApplicationContext()); 
```

**示例代码**

主要活动：

```
public class Main extends FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        Utils util = new Utils(this);
        util.startTest();

    }

    @Override
    protected void onActivityResult(int arg0, int arg1, Intent arg2) {
        Toast.makeText(this, "onActivityResult called", Toast.LENGTH_LONG).show();

        super.onActivityResult(arg0, arg1, arg2);
    }

} 
```

Utils 类（为结果而启动）：

```
public class Utils {

    Activity activity;

    public Utils(Activity ac) {
        activity = ac;
    }

    public void startTest() {
        Intent i = new Intent(activity, Test.class);
        activity.startActivityForResult(i, 1);

    }

} 
```

测试活动：

```
public class Test extends FragmentActivity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Toast.makeText(this, "Test", Toast.LENGTH_LONG).show();

        this.setResult(Activity.RESULT_OK);
        this.finish();

    }

} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-10-06T20:04:51.160

使用没有可见 GUI 的片段的类的 StartActivityForResult。您可能会在实用程序类中找到类似的内容。

请参阅下面的 runGetUserAccount。它创建自己的片段并执行 startActivityForResult。然后它有它自己的onActivityResult。

```
public class MyGooglePlay {

    private static final int CONNECTION_FAILURE_RESOLUTION_REQUEST = 31502;
    private ActionBarActivity activity;
    private FragmentManager fragManager;

    public MyGooglePlay(ActionBarActivity activity) {
        this.activity = activity;
        this.fragManager = activity.getSupportFragmentManager();
    }

     /**
     * Starts an activity in Google Play Services so the user can pick an
     * account
     */
    private String mEmail = "";
    static final int REQUEST_CODE_PICK_ACCOUNT = 1000;    
    public void runGetUserAccount() {
        if (TextUtils.isEmpty(mEmail)) {
            // run this code in gui less fragment so we can pickup the 
            // on activity result from inside the mygoogleplay class.
            Fragment f = new Fragment() {
                @Override
                public void onAttach(Activity activity) {
                    super.onAttach(activity);
                    String[] accountTypes = new String[] { "com.google" };
                    Intent intent = AccountPicker.newChooseAccountIntent(null,
                            null, accountTypes, false, null, null, null, null);
                    startActivityForResult(intent, REQUEST_CODE_PICK_ACCOUNT);
                }

                @Override
                public void onActivityResult(int requestCode, int resultCode,
                        Intent data) {
                    if (requestCode == REQUEST_CODE_PICK_ACCOUNT) {
                        if (resultCode == Activity.RESULT_OK) {
                            set_Email(data
                                    .getStringExtra(AccountManager.KEY_ACCOUNT_NAME));
                            // getUsername();
                        }
                    super.onActivityResult(requestCode, resultCode, data);
                }

                //this is to verify the fragment has been removed.
                //you can log or put a breakpoint to verify
                @Override public void onDestroy(){
                    super.onDestroy();
                }
            };
            FragmentTransaction fragmentTransaction = this.fragManager
                    .beginTransaction();
            fragmentTransaction.add(f, "getusername");
            fragmentTransaction.commit();
        }
    }

    /**
     * @param mEmail
     *            the mEmail to set
     */
    private void set_Email(String mEmail) {
        this.mEmail = mEmail;
        if (!TextUtils.isEmpty(mEmail)) {
            // TODO notify caller email is ready;
            // activity.onEmailReady(mEmail);
        }
        //we are done with the "getusername" fragment
        Fragment f = fragManager.findFragmentByTag("getusername");
        if (f!=null) {
            fragManager.beginTransaction().remove(f).commit();
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-12-10T13:17:14.263

您应该将上下文作为活动传递，然后您将获得解决方案。试试下面的代码。它会工作

在非活动类

```
public class nonActivity {

public static void method(Activity activity)
 {
     Intent intent = new Intent(activity, SecondActivity.class);
     activity. startActivityForResult(intent, REQUEST_CODE);
 }
} 
```

在SecondActivity

```
 Intent intent = getIntent();
 intent.putExtra("data", "data");   //here u can pass data to previous activity
 setResult(RESULT_OK, intent);
 finish(); 
```

在第一个活动中

```
protected void onActivityResult(int requestCode, int resultCode, @Nullable Intent data) {
    try {
        super.onActivityResult(requestCode, resultCode, data);
        if (requestCode == REQUEST_CODE && resultCode == RESULT_OK) {
            String status = data.getStringExtra("data");
            //Do what u want with data
        }
    } catch (Exception e) {
        System.out.println("=====Exception=====" + e.toString());
    }
} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-12-01T09:50:12.427

如果您希望将活动的结果返回到您的普通类，假设它是一个带有自定义适配器的类。

1.  您不能使用 startActivityForResult，因为您不在活动中
2.  我所做的是，我有意识地从课堂上发起了活动。然后我计算或做了我必须做的。从这个活动中，我将信息发送到使用方法 MainActivity.the_method() 假定的主类，并且在主活动中我更改了自定义适配器，完成了我必须使用适配器对象并调用 adapter.getItem(position)

希望这可以给你一个想法

# jquery - 使用 Jquery 或 css3 悬停显示导航

> ID：14266226
> 
> 赞同：1
> 
> 时间：2013-01-10T19:58:23.000
> 
> 标签：jquery, hover

我有一个导航栏，可以在悬停时显示内容。你可以在这里看到一个工作演示：http: [//codepen.io/anon/pen/wjciG](http://codepen.io/anon/pen/wjciG)

如您所见，它工作得相当好，但它有点错误。

我的 jquery 很简单，绝对可以改进：

```
$("#navButtons li").hover(function(){
     $(this).find("span#tooltip").stop().fadeIn(300);
}, function(){
     $(this).find("span#tooltip").stop().fadeOut(300);
}); 
```

绝对放置在`span#tooltip`可悬停链接下方，因此当用户将鼠标悬停在链接上，然后尝试悬停在工具提示/框上时，它会闪烁（因为有一段时间用户没有悬停在任何东西上）。我需要允许用户将鼠标悬停在一个元素上，看到该框淡入，然后允许用户将鼠标悬停在该框上并单击其中可能包含的任何链接或内容。

有没有更好的方法来使用 Jquery 或 CSS3 来实现更流畅、更可靠的结果？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:03:16.983

奇怪的是，我在 pass 项目中遇到了同样的问题。解决方案是在使用 javascript 的方法隐藏*工具提示*之前添加延迟。`setTimeout`

这是代码：

```
var closeTip = new Array();
$("#navButtons li").each(function (i) {
  var $this = $(this);
  $this.hover(function () {
    clearTimeout(closeTip[i]); // cancell closing tooltip
    if ($this.hasClass('visible')) {
      return false; // we are still on, do nothing else
    } else {
      // we moved to another "li" element so reset everything
      $("#navButtons li").removeClass('visible');
      $("span.tooltip").hide(); 
    }
    // show "this" tooltip and add class "visible" as flag
    $this.addClass('visible').find("span.tooltip").stop().fadeIn(300).mouseenter(function () {
      clearTimeout(closeTip[i]); // cancell closing itself even if we leave 
    });
  },
  function () {
    // delay closing tooltip unless is cancelled by another mouseenter event
    closeTip[i] = setTimeout(function () {
      $this.removeClass('visible').find("span.tooltip").stop(true, true).fadeOut();
    }, 500);
  });
}); // each 
```

由于您不应该在同一文档中使用相同的**ID**`id="tooltip"` ，因此我将其全部转换为`class="tooltip"`.

还要注意在脚本中我将 a 添加`class="visible"`到悬停的元素并将相同的 css 属性设置为该选择器

```
#navButtons li.hours:hover span, #navButtons li.hours.visible span {
  background-position: -1px -35px;
}
#navButtons li.login:hover span, #navButtons li.login.visible span {
  background-position: -41px -35px;
}
#navButtons li.newsletter:hover span, #navButtons li.newsletter.visible span {
  background-position: -83px -35px;
} 
```

...所以当我们从按钮移到工具提示时，按钮也不会闪烁。

见**[JSFIDDLE](http://jsfiddle.net/jgYtz/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:48:15.043

玩转工具提示的 CSS。添加`padding-top:20px; margin-top:-20px`到`span#tooltip`使提示的位置与图标一样高；因此，没有办法“mouseout”这些链接。由于图标的 z 值高于工具提示，因此从一个图标移动到另一个图标不会产生不良影响。

![在此处输入图像描述](../Images/bbed1cb84dfd36a47b1eb95598be4060.png)

（为说明目的添加了大纲）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T06:39:02.313

[**jsFiddle 演示**](http://jsfiddle.net/A26UX/3/)

**`#navButtons li span`**你忘了给你的CSS 选择器添加一个属性。

```
margin-bottom: 25px; /* 20px is the tooltip distance, but a little extra helps */ 
```

之所以可行，是因为`margin-bottom`它是“盒子模型”的一部分，`hover`事件可以监视任何状态变化。还要更改您的工具提示`id`，以便改为使用**类名**，因为您不能`id`在网页上使用相同的两次。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:58:31.620

一种可能的替代方法是仅使用 CSS 来实现淡入和淡出效果。

[我在这里](http://jsbin.com/iyozed/1/edit)整理了一个快速而肮脏的例子来展示如何做到这一点。有明显的警告，并非所有浏览器都支持它，但在当前示例中禁用 javascript 的用户也可以这样说。CSS 版本仍然可以工作，它只会出现和消失而不会褪色。

此外，仅隐藏具有不透明度的元素将使它们更易于访问。

只是另一种选择:)

# javascript - 将动态缩放的图像宽度用于另一个 div 的左侧定位

> ID：14266231
> 
> 赞同：0
> 
> 时间：2013-01-10T19:58:33.203
> 
> 标签：javascript, jquery, html, dynamic

我有一个动态缩放的图像（固定位置，窗口高度），所以它按比例缩放并改变它的宽度。我想使用它的宽度来设置另一个 div 的左侧位置。我可以使用这样的东西吗？

```
$("#menubar img").ready(function() {
     var bodywidth = $("#menubar img").width();
        $("#text").left(bodywidth);
});

$("#menubar img").resize(function() {
   var bodywidth = $("#menubar img").width();
        $("#text").left(bodywidth);
}); 
```

我迷失在剧本中:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:01:38.330

`var bodywidth = $("#menubar img").width();`会给你一个数字，比如 120。请注意，这是以像素为单位的，但没有单位。为这个值的结果设置任何东西都是没有意义的。

你需要：

```
 $("#text").css('left',bodywidth+'px'); 
```

这假设“另一个 div”正在使用绝对定位。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:04:16.833

```
$("#menubar img").ready(function() {
 var bodywidth = $("#menubar img").width();
    $("#text").css('left',bodywidth.toString().concat('px'));});$("#menubar img").resize(function() {   var bodywidth = $("#menubar img").width();        $("#text").css('left',bodywidth.toString().concat('px'));}); 
```

希望这可以帮助

# ruby - 在表格单元格中获取最后一个单词？

> ID：14266232
> 
> 赞同：2
> 
> 时间：2013-01-10T19:58:33.917
> 
> 标签：ruby, parsing, nokogiri, scraper

我想用 Ruby 和 Nokogiri 从表中抓取数据。

有很多`<td>`元素，但我只需要一个元素后只是文本的国家`<br>`。问题是，`<td>`元素不同。有时不仅仅是国家。

例如：

```
<td><a href="#">Title1</a><br>USA</td>
<td><a href="#">Title2</a><br>Michael Powell<br>UK</td>
<td><a href="#">Title3</a><br>Leopold Lindtberg<br>Ralph Meeker<br>Switzerland</td> 
```

我想解决结束`</td>`标签之前的元素，因为国家总是最后一个元素。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:59:41.317

我会用这个：

```
require 'awesome_print'
require 'nokogiri'

html = '
<td><a href="#">Title1</a><br>USA</td>
<td><a href="#">Title2</a><br>Michael Powell<br>UK</td>
<td><a href="#">Title3</a><br>Leopold Lindtberg<br>Ralph Meeker<br>Switzerland</td>
'

doc = Nokogiri::HTML(html)
ap doc.search('td').map{ |td| td.search('text()').last.text }

[
    [0] "USA",
    [1] "UK",
    [2] "Switzerland"
] 
```

问题是您正在解析的 HTML 没有`<td>`标签行，因此您必须找到要解析的标签。相反，它们将散布在`<tr>`标签之间，甚至可能是不同的`<table>`标签。因为您的 HTML 示例没有显示文档的真实结构，所以我无法为您提供更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T21:05:57.680

有很多不同的解决方案。仅使用标准库的另一种解决方案是对您不想要的东西进行子串化。

```
node_string = <<-STRING
  <td><a href="#">Title1</a><br>USA</td>
  <td><a href="#">Title2</a><br>Michael Powell<br>UK</td>
  <td><a href="#">Title3</a><br>Leopold Lindtberg<br>Ralph Meeker<br>Switzerland</td>
STRING
node_string.split("<td>").collect do |str| 
  last_str = str.split("<br>").last
  last_str.gsub(/[\n,\<\/td\>]/,'') unless last_str.nil?
end.compact 
```

# python - 如何删除文本文件中关键短语之前的所有内容？

> ID：14266235
> 
> 赞同：2
> 
> 时间：2013-01-10T19:58:44.717
> 
> 标签：python

我有超过 5000 个文本文件（也是 csv 格式），每个文件有几百行。

特定短语“城市”上方的所有内容都是不必要的，我需要它下方的所有内容，有没有办法（python 或批处理）删除所有内容？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T20:08:05.837

我*爱*蟒蛇。但有时，[`sed`](http://sed.sourceforge.net/sed1line.txt)也很有用：

```
sed -n '/City/,$p' file_with_city > new_file_with_city_on_first_line 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:32:28.203

`sed -i -n '/City/,$p' file1 file2 etc`Python中的模拟：

```
#!/usr/bin/env python
import fileinput

copy = False
for line in fileinput.input(inplace=True): # edit files inplace
    if fileinput.isfirstline() or not copy: # reset `copy` flag for next file
       copy = "City" in line
    if copy:
       print line, # copy line 
```

用法：

```
$ ./remove-before-city.py file1 file2 etc 
```

此解决方案会修改在命令行中给出的文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T20:02:02.073

一种算法是这样的：

*   从文件中读取，直到遇到文本“City”
*   以写入模式打开第二个文件
*   从第一个文件流到第二个文件
*   关闭两个文件
*   将第二个文件移动到第一个文件先前占用的位置

尽管可以截断文件以删除某个点*之后的内容，但不能使用某个点**之前*的内容就地调整它们的大小。您可以通过反复搜索来使用单个文件来执行此操作，但这可能不值得。

如果文件足够小，您可以将第一个文件的整个内容读入内存，然后将您想要的部分写回同一个磁盘文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T20:04:23.360

```
# Use a context manager to make sure the files are properly closed.
with open('in.csv', 'r') as infile, open('out.csv', 'w') as outfile:
    # Read the file line by line...
    for line in infile:
        # until we have a match.
        if "City" in line:
            # Write the line containing "City" to the output.
            # Comment this line out if you don't want to include it.
            outfile.write(line)

            # Read the rest of the input in one go and write it
            # to the output. If you file is really big you might
            # run out of memory doing this and have to break it
            # into chunks.
            outfile.write(infile.read())

            # Our work here is done, quit the loop.
            break 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T20:35:32.023

```
import os

for file in os.listdir("."):
    infile = open(file, 'rb')
    line = infile.readline()
    # Sequential read is easy on memory if the file is huge.
    while line != '' and not 'City' in line:
        line = infile.readline()     # skip all lines till 'City' line
    # Process the rest of the file after 'City'
    if 'City' in line:
        print line     # prints to stdout (or redirect to outfile)
    while line != '' :
        line = infile.readline()
        print line 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-10T20:01:25.600

```
def removeContent(file, word, n=1, removeword=False):
    with open(fname, "r") as file:
        if removeword:
            content = ''.join(file.read().split(word, n)[n])
        else:
            content = word + ''.join(file.read().split(word, n)[n])
    with open(fname, "w") as file:
        file.write(content)

for fname in filenames:
    removeContent(fname) 
```

参数说明：

`n`告诉我们您希望它使用哪个单词来删除。默认情况下`n = 1`，它会在第一次出现之前删除所有内容。要删除第五个之前的所有内容`city`，请使用 调用该函数`removeContent(fname, "city", 5)`。

`file`明显代表你要编辑的文件名

`word`是您要用于删除的词，在您的情况下是`city`

`removeword`告诉是否保留这个词并且只删除它之前的文本，或者是否也删除这个词本身。

# java - 将 ws-security 添加到 wsdl2java 生成的类

> ID：14266237
> 
> 赞同：4
> 
> 时间：2013-01-10T19:58:53.640
> 
> 标签：java, soap, cxf, ws-security

我使用 CXF 的 wsdl2java 从 WSDL 生成了一堆客户端类。执行以下操作时如何将 WS-Security 添加到标头：

```
URL url = new URL("http://fqdn:8080/service/MessageHandler");
MessageHandlerService service = new MessageHandlerService(url);
MessageHandler handler = service.getMessageHandler();
MyMessage message = new MyMessage();
message.setSender("User 1");
handler.sendMessage(message); 
```

我认为`handler`是一个`javax.xml.ws.Service`例子。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-15T06:50:47.903

通常它是在代码之外完成的。

在这种情况下，[这](http://www.javaranch.com/journal/200709/Journal200709.jsp#a3)可能会有所帮助

如果您想以编程方式添加，

> 以编程方式将 WS-Security UsernameToken 标头添加到 Axis 绑定，非标准，但对快速测试很有用。（存根/绑定：它是以 _PortType 结尾的类）

```
/**
  * Adds WS-Security header with UsernameToken element to the Axis binding
  * @param binding
  * @param wsUser
  * @param wsPass
  * @throws SOAPException
  */
 protected static void addWsSecurityHeader(org.apache.axis.client.Stub binding, String wsUser, String wsPass)
   throws SOAPException {

  // Create the top-level WS-Security SOAP header XML name.
  QName headerName = new QName(
    "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd", "Security");
  SOAPHeaderElement header = new SOAPHeaderElement(headerName);
  //  no intermediate actors are involved.
  header.setActor(null);
  // not important, "wsse" is standard
  header.setPrefix("wsse");
  header.setMustUnderstand(true);

  // Add the UsernameToken element to the WS-Security header
  SOAPElement utElem = header.addChildElement("UsernameToken");
  SOAPElement userNameElem = utElem.addChildElement("Username");
  userNameElem.setValue(wsUser);
  SOAPElement passwordElem = utElem.addChildElement("Password");
  passwordElem.setValue(wsPass);

  // Finally, attach the header to the binding.
  binding.setHeader(header);
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-22T21:13:16.563

```
<jaxws:client id="client"
    serviceClass="com.mycompany.TheServiceInterface"
    address="http://fqdn/service/Endpoint?wsdl">
    <jaxws:outInterceptors>
        <bean class="org.apache.cxf.ws.security.wss4j.WSS4JOutInterceptor">
            <constructor-arg>
                <map>
                    <entry key="action" value="Timestamp UsernameToken"/>
                    <entry key="user" value="test.user"/>
                    <entry key="passwordType" value="PasswordNone"/>
                </map>
            </constructor-arg>
        </bean>
    </jaxws:outInterceptors>
</jaxws:client> 
```

然后，如果您将客户端转换为 a `BindingProvider`，您可以根据需要以编程方式更改端点。

# kendo-ui - kendo：导航栏中的启用/禁用按钮

> ID：14266242
> 
> 赞同：1
> 
> 时间：2013-01-10T19:59:09.363
> 
> 标签：kendo-ui

下面是导航栏的定义，它是在多个屏幕中使用的视图模板的一部分：

```
 <div data-role="layout" data-id="app">
        <header data-role="header">
          <div data-role="navbar">
              <a class="nav-button" data-align="left" data-role="backbutton">Back</a> 
              <span data-role="view-title">Title</span>
              <a class="nav-button" data-align="right" data-role="button" data-click="doneTapped" id="btnDone">Done</a> 
          </div>
        </header>
    </div> 
```

“完成”按钮仅在某些屏幕上需要，因此在主页加载时它会被隐藏：

```
 $("#btnDone").hide(); 
```

隐藏按钮工作正常，但再次显示它不起作用：

```
 $("#btnDone").show(); 
```

按钮不显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:24:02.143

而不是使用`$("#btnDone").hide();`和`$("#btnDone").show();`使用：

隐藏按钮：

```
$("#btnDone").css("visibility", "hidden"); 
```

显示按钮：

```
$("#btnDone").css("visibility", "visible"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-04T21:38:02.177

在这种情况下对我有用的方法是在我想要显示/隐藏的按钮上放置一个类，而不是依赖于 id：

```
<div data-role="layout" data-id="app">
    <header data-role="header">
      <div data-role="navbar">
          <a class="nav-button" data-align="left" data-role="backbutton">Back</a> 
          <span data-role="view-title">Title</span>
          <a class="nav-button btnDone" data-align="right" data-role="button" data-click="doneTapped" id="btnDone">Done</a> 
      </div>
    </header>
</div> 
```

然后使用该类将其隐藏：

```
$(".btnDone").hide(); 
```

希望这也适用于你。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-23T04:54:33.987

萨拉姆，
尝试以下方法：

```
 <!--Home-->
    <div id="tabstrip-home"
         data-role="view"
         data-init="app.home"
         data-title="Home">

        <!--Header-->
        <header data-role="header">
          <div data-role="navbar">
              <a class="nav-button" data-align="left" data-role="backbutton">Back</a> 
              <span data-role="view-title">Title</span>
              <a class="nav-button" data-align="right" data-role="button" data-click="doneTapped" id="btnDone">Done</a> 
          </div>
        </header>

        <!--Content-->
        <div class="view-content">
          <h1>Hide / Show Navbar Elements</h1>
            <p>
              <center>
                <a data-align="left" data-role="button" data-click="app.show">Show</a>
              </center>
              <br />
              <center>
                <a data-align="left" data-role="button" data-click="app.hide">Hide</a>
              </center>
            </p>

        </div>
    </div> 
```

在 data-init="app.home" 函数中，您可以找到导航栏，然后是 leftElement 并引用它们，然后您可以控制它，例如：

```
var navbar = null;
var left = null;
global.app.home = function (e) {
  navbar = e.sender.header.find('div[data-role="navbar"]').data('kendoMobileNavBar');
    left = navbar.leftElement;
    console.log(left);

};

 global.app.show = function (e) {
  left.show();
};

 global.app.hide = function (e) {
  left.hide();
}; 
```

请在此处查看一个工作示例：http: [//jsbin.com/EpInoQOq/1/edit](http://jsbin.com/EpInoQOq/1/edit)
问候

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-25T10:58:46.147

我处理在不同视图上隐藏和显示后退按钮的方式是使用 2 种不同的布局。这对我的用例很有效，因为我只在 1 页上显示后退按钮：

```
 <!--Default Layout with Main Menu and no backbutton-->
        <div data-role="layout" data-id="layout">

            <!--Header-->
            <div data-role="header">
                <div data-role="navbar">
                    <span data-role="view-title"></span>
                </div>
            </div>

            <!--Footer-->
            <div data-role="footer">
                <div data-role="tabstrip">
....
                </div>
            </div>
        </div>

        <!--Layout with Back Button-->
        <div data-role="layout" data-id="layoutBackButton">

            <div data-role="header">
                <div data-role="navbar">
                    <a data-role="backbutton" data-align="left">
                        <!-- data-bind="isVisible: showBackButton" -->
                        <i class="fa fa-chevron-left fa-lg"></i>
                    </a>
                    <span data-role="view-title"></span>
                </div>
            </div>
        </div> 
```

我的远程视图使用后退按钮然后指定另一个布局：

```
<div         data-layout="layoutBackButton"
             data-role="view"
...> 
```

# powershell - Powershell - 导出非活动邮箱 Exchange 2010

> ID：14266247
> 
> 赞同：0
> 
> 时间：2013-01-10T19:59:26.307
> 
> 标签：powershell, export, exchange-server, exchange-server-2010

我正在寻找运行这样的脚本并导出到 CSV 并按上次使用邮箱的时间排序。基本上，我们正在尝试查找超过 60 天未使用的邮箱。加载列表后，我们将再次运行脚本，除了添加一些代码以将每个邮箱导出到 PST（我也不知道如何执行该部分）

邮箱是最近从 Exch 2007 迁移而来的。邮箱每天都会备份，因此访问时间不会起作用。

我正在查看类似下面的内容，但是当脚本在版本 14 上运行时，它无法从运行版本 8 的服务器上的邮箱中获取邮箱统计信息。这可能是因为我们有大量邮箱留在所有已终止用户的 Exchange 2007 服务器上。我想将这些包含在搜索结果中。

```
$xDays = 60 

Get-Mailbox -ResultSize Unlimited -RecipientTypeDetails UserMailbox | Foreach-Object { 

$si= Get-MailboxFolderStatistics $_ -IncludeOldestAndNewestItems -FolderScope SentItems 

if($si.NewestItemReceivedDate -AND (New-TimeSpan $si.NewestItemReceivedDate.ToLocalTime()).Days -ge $xDays) 
{ 
$_ 
} 

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:57:10.047

正如它所说，您可能需要将脚本与 2007 年和 2010 年分开运行。

在 2007 服务器上像这样运行它：

```
Get-Mailbox -ResultSize Unlimited -RecipientTypeDetails UserMailbox -Server "2007 Server" 
```

就像2010服务器上的这样：

```
Get-Mailbox -ResultSize Unlimited -RecipientTypeDetails UserMailbox -Server "2010 Server" 
```

# ruby - Padrino 在“rackup”命令后冻结

> ID：14266249
> 
> 赞同：0
> 
> 时间：2013-01-10T19:59:27.947
> 
> 标签：ruby, macos, terminal, padrino

我是一名前端开发人员，使用 Ruby/Padrino 作为一个新手。我的本地设置已开始冻结。我客户的后端开发人员更新了我的本地数据库/配置文件，它工作了一天，然后就没有了。

我连接到 localhost，导航到 git repo 文件夹，然后执行
$ bash
$ rackup

通常这会启动 Ruby，但现在什么也没有发生。它只是在“rackup”行下方保持空白。Ctrl-C 什么都不做，我无法回到 $ 提示符。

有没有人见过这个问题？开发人员不熟悉 Mac，所以他说它是“gremlins”，我的 Ruby 朋友也没有见过这个。

# android - PhoneGap App：jQuery getJSON 在获取具有相对 URL 的本地文件时出现 404 错误

> ID：14266253
> 
> 赞同：0
> 
> 时间：2013-01-10T19:59:38.563
> 
> 标签：android, jquery, cordova

我有一个 HTML/JavaScript 应用程序，我正在尝试通过[Phonegap Build 应用程序将其转换为使用 PhoneGap 的应用程序](http://build.phonegap.com)

通过浏览器一切正常，应用程序遇到的唯一问题是`getJSON`在尝试加载我的本地资源时调用返回 404 错误。

这是罪魁祸首：

```
$.getJSON( "./shapes/json/" + abbr + '.json', gotJSON(abbr) ); 
```

我已将每个域都列入白名单，以确保：

```
<access origin="*" /> 
```

这是phonegap环境不可能的事情吗？还是我做错了什么？

如果需要，我可以在其他地方托管文件并进行跨域 ajax 调用，但我宁愿将文件放在设备上。

这目前正在 Android 上发生，这是我目前唯一可以测试的系统。

**更新：**

我现在正在尝试：

```
 var xhrShapes = new XMLHttpRequest(), xhrSuccess = gotJSON(abbr);

    xhrShapes.open('GET', config.path + "/shapes/json/" + abbr + ".json");
    xhrShapes.onreadystatechange = function(e){
        if( this.readyState === 4 ){
            if( this.status === xhrSuccessCode ){
                xhrSuccess(JSON.parse(this.responseText));
            }
        }
    }
    xhrShapes.send(); 
```

`config.path`是“file:///android_asset/www”，我得到`0`了一个成功代码（这表明“file://”请求成功）。但是`xhrShapes.responseText`是空白的，一切都停止在调用`JSON.parse`. 我觉得我错过了一些简单的东西......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T17:11:14.347

问题与代码无关，而是文件名区分大小写......我的`abbr`变量是大写的，但文件名是小写的。 `$.getJSON`工作完美，现在我已经纠正了这个（虽然现在我的骄傲需要一些修理）。

# php - 将多个值从 javascript 函数发送到 PHP 页面

> ID：14266254
> 
> 赞同：0
> 
> 时间：2013-01-10T19:59:38.647
> 
> 标签：php, javascript, jquery

这是示例代码。

```
<form id="form1" name="form1" action="phpPage.php" method="POST">
  <!--5 diff values in form1 . . . -->
  <input id="b1" onclick="functionOne();">
</form>
<form id="form2" name="form2" action="phpPage.php" method="POST">
  <!-- 5 diff values in form2 . . . -->
  <input id="b2" onclick="functionTwo();">
</form> 
```

我最多有 8 个表格。

问题是当我单击按钮时`b5`，在执行了所有验证检查之后，我想要它，以便它从`form1`-发送所有值`form5`。我`functionFive()`通过 jQuery 收集了 JS 函数 (;) 中的值。如何将这些值发送到`phpPage.php`？

请记住，我们已经触发了`onclick`事件`b5`，因此，`functionFive`已调用 进行验证检查。如何将值从这里发送到 php 页面？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:03:47.803

答案是使用包含所有值的一种形式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:05:22.493

你试过ajax吗？

```
var formData = {
    firstName: 'Dennis',
    lastName: 'Martinez'    
};

$.ajax({
    type: 'post',
    url: 'SOMEFILE.php',
    data: formData,
    success: function(e) {
        alert('success!');
    },
    error: function(e) {
        alert('there was an error!');
    }
}); 
```

# javascript - 转至 Mobile Safari 后返回 iPad Webapp

> ID：14266257
> 
> 赞同：1
> 
> 时间：2013-01-10T19:59:54.480
> 
> 标签：javascript, html, ios, ipad, web-applications

我正在为 iPad 创建一个 RSS 阅读器 Web 应用程序。在我的应用程序中，有一个按钮可以在 Mobile Safari 中打开每篇文章的 URL（带`target="_blank"`方法）

但问题是，当用户从我的网络应用程序转到 Mobile Safari，然后关闭 Mobile Safari 后，iPad 会转到主页。但它应该回到我的网络应用程序。

我试图在我的网络应用程序中实现一个应用程序内浏览器`iframes`，但它存在太多问题。许多网站不允许用户在其中打开他们的网站，在实现*后退按钮*时`iframe`也存在一些问题，您可以在[此处](https://stackoverflow.com/questions/11602355/iframe-back-with-javascript-avoid-main-page-go-back)阅读问题。*`iframe`*

 *什么是我的目的的最佳方式？关闭 Mobile Safari 后有什么方法可以返回 Web 应用程序？如果没有，我该怎么办？是否可以解决应用内浏览器问题？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:03:59.067

如果您使用的是 phonegap（听起来像您），我建议您使用[InAppBrowser](http://docs.phonegap.com/en/2.3.0/cordova_inappbrowser_inappbrowser.md.html#InAppBrowser)或[ChildBrowser 插件](https://github.com/alunny/ChildBrowser/blob/master/README.md)*

# spring - JSF 和 Spring 安全集成

> ID：14266260
> 
> 赞同：0
> 
> 时间：2013-01-10T20:00:08.400
> 
> 标签：spring, jsf, spring-mvc, spring-security

> **可能重复：**
> [Spring Security Authentication 在我的配置中没有按预期工作](https://stackoverflow.com/questions/14259780/spring-security-authentication-is-not-working-as-expected-in-my-configuration)

我尝试集成 JSF 和 spring security 我花了将近一天但没有结果

使用 JSF、Spring MVC 和 Primfaces 开发了一个应用程序。我几乎完成了我的要求，最后我计划集成弹簧安全，但我不能，我在网上做了足够的搜索。我觉得这可能是相关框架中的错误。

如果你们中的任何人遇到相同的情况，请发布解决方案。我在这里发布我的方法

**第 1 步：** 创建 Login.jsp（自定义登录页面） **第 2 步：** 在我的 web.xml 中添加以下代码

```
<filter>
    <filter-name>springSecurityFilterChain</filter-name>
    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
</filter>

<filter-mapping>
    <filter-name>springSecurityFilterChain</filter-name>
    <url-pattern>/*</url-pattern>
    <dispatcher>FORWARD</dispatcher>
<dispatcher>REQUEST</dispatcher>
</filter-mapping> 
```

**第 3 步：**

创建 Springsecurity.xml

```
<sec:global-method-security
    secured-annotations="enabled" />
<sec:http auto-config="true" use-expressions="true"
    once-per-request="false">
    <sec:intercept-url pattern="pages/secured/**"
        access="ROLE_USER" />
    <sec:form-login login-page="/login.jsp"
        default-target-url="/pages/secured/products.xhtml"
        authentication-failure-url="/login.html?login_error=1" />
    <sec:logout logout-url="/logout" logout-success-url="/login.jsp" />
</sec:http>

<sec:authentication-manager alias="authenticationManager">
    <sec:authentication-provider>
        <sec:user-service>
            <sec:user name="vijay" authorities="ROLE_USER" password="vijay"/>
        </sec:user-service>
    </sec:authentication-provider>
</sec:authentication-manager> 
```

执行应用程序并将 login.jsp 作为第一页，因为我在 web.xml 中定义。在登录身份验证时，它会转发到 Products.xhtml，但我什至可以访问所有位于安全文件夹下的其余页面，而无需登录。

请提出更好的方法或其他替代方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:04:29.650

对于您的访问属性，请尝试一下。模式中缺少您的第一个斜线。

```
<sec:intercept-url pattern="/pages/secured/**"
    access="hasRole('ROLE_USER')" /> 
```

# php - 卷曲替代品

> ID：14266262
> 
> 赞同：0
> 
> 时间：2013-01-10T20:00:19.690
> 
> 标签：php, curl, file-get-contents

是否有 CURL 替代方案，以便我能够设置从服务器的响应中返回的 cookie。我还应该能够将该 cookie 进一步发送到 url ..我知道 CURL 可以做到这一点。但我需要一个替代方案方式。我可以使用吗？

```
stream_context_create() 
```

和 `flie_get_contents()` ..在我的情况下，我需要使用 HTTP POST 方法提交一些数据。如果数据正确，服务器将设置一个 cookie，我需要使用这个 cookie 来进一步访问服务器。没有 CURL 怎么办？ ?

# php - PHP 创建的日志在写入时被损坏

> ID：14266264
> 
> 赞同：0
> 
> 时间：2013-01-10T20:00:29.653
> 
> 标签：php, sql, sql-server, logging

我正在根据下面的 PHP 代码捕获网页查看器日志...

```
$viewerlog = "../SiteLogFiles/live-smoothstreaming-" . date('Ymd') . ".txt";
$fp = fopen($viewerlog,"a");
if ($fp) {
    fputs($fp,"-----------------------------------------------------------------------\r\n");
    fputs($fp,"Server Date:           $now\r\n");
    fputs($fp,"IP Address:            $ip\r\n");
    fputs($fp,"City:                  $city\r\n");
    fputs($fp,"State:                 $state\r\n");
    fputs($fp,"Country Name:          $countryname\r\n");
    fputs($fp,"Continent:             $continent\r\n");
    fputs($fp,"-----------------------------------------------------------------------\r\n");
    fclose($fp);
} 
```

它会产生这样的日志......

```
-----------------------------------------------------------------------
Server Date:           2013-01-06T05:32:06-06:00
IP Address:            157.55.32.61
City:                  Unknown
State:                 Unknown
Country Name:          United States
Continent:             North America
-----------------------------------------------------------------------
-----------------------------------------------------------------------
Server Date:           2013-01-06T06:02:40-06:00
IP Address:            157.55.32.187
City:                  Unknown
State:                 Unknown
Country Name:          United States
Continent:             North America
----------------------------------------------------------------------- 
```

但时不时地，日志会被损坏，看起来像这样......

```
-----------------------------------------------------------------------
Server Date:           2012-12-21T18:27:27-06:00
IP Address:            99.54.103.128
City:                  Columbus
State:                 Ohio
Country Name:          United States
Continent:             North America
-----------------------------------------------------------------------
-----------------------------------------------------------------------
Server Date:           2012-12-21T18:27:53-06:00
IP Address:            75.97.98.115
City:                  Palmerton
State:                 Pennsylvania
--------------------------------------Continent:             North America
Server Date:           2012-12-21T18:27:54-06:00
---------------------
IP Address:            70.76.36.232
City:                  Saskatoon
State:                 Saskatchewan
Country Name:          Canada
Continent:             North America
-----------------------------------------------------------------------
-----------------------------------------------------------------------
Server Date:           2012-12-21T18:28:04-06:00
IP Address:            173.17.240.190
City:                  Springfield
State:                 Missouri
Country Name:          United States
Continent:             North America
----------------------------------------------------------------------- 
```

值得注意的是，我使用[http://www.easyjquery.com](http://www.easyjquery.com)从 IP 地址获取位置信息。

因此，许多人建议使用 SQL 数据库进行日志记录，而不是纯文本日志。有了这些建议，我就能够建立上述 SQL 数据库。我能够在 1 秒内写入 7 条记录（尽可能快地按 F5），没有问题。

使用中的PHP代码如下...

```
try {
    $dbh = new PDO("sqlsrv:Server=localhost;Database=ViewerLogs", "", "");
    $dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    $stmt = $dbh->query("INSERT INTO dbo.LiveSmoothStreaming (DateTime, Ip, City, State, Country, Continent) VALUES('$now', '$ip', '$city', '$state', '$countryname', '$continent')");
    $stmt->setFetchMode(PDO::FETCH_ASSOC);
    $dbh = null;
}
catch(PDOException $e) {
    echo $e->getMessage();
} 
```

不过，有一个问题。我的纯文本日志似乎比 SQL 日志捕获了更多的记录。

纯文本日志正在生成...

```
Tue 5:58pm  68.55.34.32 Laurel      Maryland    United States   North America
Tue 5:58pm  70.88.57.62 Port Charlotte  Florida United States   North America
Tue 5:59pm  98.19.198.54    Eastview        Kentucky    United States   North America
Tue 5:59pm  71.3.202.110    Cape Coral      Florida United States   North America
Tue 5:59pm  173.218.32.154  Branson     Missouri    United States   North America
Tue 5:59pm  184.38.238.64   Unknown     Unknown United States   North America
Tue 5:59pm  67.239.18.161   Naples      Florida United States   North America 
```

并且 SQL 日志正在生成...

```
2013-02-05T17:58:45-06:00   68.55.34.32 Laurel      Maryland    United States   North America
2013-02-05T17:58:52-06:00   70.88.57.62 Port Charlotte  Florida     United States   North America
2013-02-05T17:59:06-06:00   71.3.202.110    Cape Coral  Florida     United States   North America
2013-02-05T17:59:23-06:00   67.239.18.161   Naples      Florida     United States   North America 
```

您可以看到，在短短几分钟内，就有了差异。在几个小时的过程中，差异可能达到数百个。

在这个特定的纯文本日志中没有损坏，所以我看不出它怎么可能是错误的。这将表明 SQL 日志存在问题。我查看了我的 PHP 错误日志中可能存在的问题，但没有发现任何明显的问题（我只是搜索了有问题的页面并查看了这些错误）。

关于为什么 SQL 不会捕获纯文本日志的记录，有什么想法吗？在我的代码中，SQL 日志记录直接出现在纯文本日志记录之后（也许将 SQL 放在纯文本之前会产生相反的结果？）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:50:59.213

据我所知，您可以使用文件锁定或系统日志。由于您似乎想让您的应用程序编写不间断的文本块，我认为锁定是可取的。

```
$lockwait = 2;       // seconds to wait for lock
$waittime = 250000;  // microseconds to wait between lock attempts
// 2s / 250000us = 8 attempts.
$myfile = '/path/to/file.log';

if( $fh = fopen($myfile, 'a') ) {
  $waitsum = 0;
  // attempt to get exclusive, non-blocking lock
  $locked = flock($fh, LOCK_EX | LOCK_NB); 
  while( !$locked && ($waitsum <= $lockwait) ) {
    $waitsum += $waittime/1000000; // microseconds to seconds
    usleep($waittime);
    $locked = flock($fh, LOCK_EX | LOCK_NB);
  }
  if( !$locked ) {
    echo "Could not lock $myfile for write within $lockwait seconds.";
  } else {
    // write out your data here
    flock($fh, LOCK_UN);  // ALWAYS unlock
  }
  fclose($fh);            // ALWAYS close your file handle
} else {
  echo "Could not open $myfile";
  exit 1;
} 
```

您还可以使用这种稍微复杂一些的算法来进行随机“退避”等待，类似于 TCP 和 CSMA/CD 用于避免拥塞的方法。

```
$max_wait   = 1000000; //  1 s

$min_interval = 10000; // 10 ms
$max_interval = 50000; // 50 ms

$cur_wait = $min_interval;
$tot_wait = 0;
$locked = flock($fh, LOCK_EX | LOCK_NB); 

while( !$locked && ($tot_wait <= $max_wait) ) {
  tot_wait += $cur_wait;
  usleep($cur_wait);
  cur_wait += rand($min_interval, $max_interval);
  $locked = flock($fh, LOCK_EX | LOCK_NB);
}
if( !$locked ) {
  echo "Could not lock $myfile for write within $lockwait seconds.";
} else {
  // write out your data here
  flock($fh, LOCK_UN);
}
fclose($fh); 
```

如果无法获得锁定，脚本会逐渐在锁定尝试之间等待越来越长的时间，直到`$max_wait`超过定义的时间。

在写完所有这些之后，我想你可能只想考虑将所有这些插入数据库，如果你需要一个日志文件，那么每天运行一次 cron 作业以一次性写出文件，并且可以选择为空桌子。

# solr - 多线程 solrj 查询偶尔出现不可预测的异常

> ID：14266265
> 
> 赞同：1
> 
> 时间：2013-01-10T20:00:30.397
> 
> 标签：solr, solrj

我有一个使用 solrj 4 的多线程应用程序。最多有 25 个线程。每个线程使用 HttpSolrServer 创建一个连接，并运行一个查询。大多数时候这工作得很好。但偶尔我会遇到以下异常：

```
Jan 10, 2013 9:29:07 AM org.apache.http.impl.client.DefaultRequestDirector     tryConnect
INFO: I/O exception (java.net.NoRouteToHostException) caught when connecting    to the target host: Cannot assign requested address
Jan 10, 2013 9:29:07 AM org.apache.http.impl.client.DefaultRequestDirector tryConnect
INFO: Retrying connect
Exception in thread "main" java.util.concurrent.ExecutionException: java.lang.NullPointerException
    at java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:252)
    at java.util.concurrent.FutureTask.get(FutureTask.java:111) 
```

如果失败，我编写了一些代码来重试查询：

```
 while(!querySuccess && queryAttempts<m_MaxQueryAttempts ){
             try{
                 queryAttempts++;
                 rsp = m_Server.query( query );
                 querySuccess = true;
             }catch(SolrServerException e){
                 querySuccess = false;
             }
         } 
```

一次或多次重试后，查询通常有效。但有时即使重试 100 次也会失败。无论哪种方式，我都想了解问题的原因是什么。为什么它有时会起作用？对 solr 的并发访问是否存在问题？除了这个过程，我只有另一个过程，它使用单个连接不断地写入索引。默认服务器设置如下 - 所以我不认为这是因为同时连接太多。

```
 INFO: Creating new http client, config:maxConnections=128&maxConnectionsPerHost=32&followRedirects=false 
```

任何有关如何诊断此问题的建议将不胜感激。

# asp.net - youtube 视频上传限制

> ID：14266269
> 
> 赞同：1
> 
> 时间：2013-01-10T20:00:49.797
> 
> 标签：asp.net, youtube, youtube-api

我开始使用 youtube api，但想知道有几件事：

1.  我需要将视频上传到 youtube 还是只能使用它的播放器？

2.  如果它确实需要我上传到 youtube，性能方面会更好吗？

3.  如果我确实上传到 youtube，我可以将视频设为私有，以便只能从我的网站查看它们，而不能通过 youtube 它自己访问吗？

4.  我对可以上传的视频数量或可以创建的播放列表数量有限制吗？

5.  我可以使用 api 获取视频缩略图吗？

抱歉，如果它看起来是随机的，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:10:00.537

1.  你必须上传它。

2.  假设客户分散在世界各地：是的，youtube 会比您自己的解决方案表现更好。如果客户都在您的建筑物内，在您的网络上，那么..也许。取决于您托管它的内容、同时存在的问题数量以及在此处输入的问题数量。

更重要的是，如果 YouTube 正在提供视频，那么您不必担心来自您的服务器的带宽，这在您需要的成本和带宽方面可能很重要。

3.  是的。有关“授权”请求的一些详细信息，请参阅[https://developers.google.com/youtube/2.0/reference 。](https://developers.google.com/youtube/2.0/reference)

4.  唯一的限制与视频的长度和大小有关。如果您需要超过 15 分钟或 2GB 的视频，则需要申请授权。 [http://support.google.com/youtube/bin/answer.py?hl=en&answer=71673](http://support.google.com/youtube/bin/answer.py?hl=en&answer=71673)

5.  请参阅[如何从 YouTube API 获取 YouTube 视频缩略图？](https://stackoverflow.com/questions/2068344/how-to-get-thumbnail-of-youtube-video-link-using-youtube-api)

# c# - 如何防止图形从面板 onPaint 中移除？

> ID：14266271
> 
> 赞同：0
> 
> 时间：2013-01-10T20:00:56.957
> 
> 标签：c#, graphics2d

我有一个 Canvas 类，它是面板继承的类，它覆盖了该`onPaint`方法。

我的程序如下所示：

![在此处输入图像描述](../Images/ebf65140c999730ffd30c5a4e78de266.png)

它工作得很好，但是当我最小化\调整画布大小时，

画布的“隐藏”部分正在删除。我注意到我必须重写 onPaint 方法。

但我不知道该怎么做才能“保持”平局。有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:11:07.437

您正在描述使用`CreateGraphics`. 不要使用`CreateGraphics`，而是使用 PaintEventArgs 参数中的图形对象，特别是`e.Graphics`.

# python - 复制时 Python 线程 I/O 错误

> ID：14266272
> 
> 赞同：0
> 
> 时间：2013-01-10T20:00:58.017
> 
> 标签：python, file-io, python-multithreading

让我提前感谢大家的帮助！仅供参考，我在 Windows 7-64 位中运行 Python 2.5（我知道已经过时，但我被迫使用这个版本）。

我有几个目录，每个目录都包含大量数据。我想减少将这些大目录从本地 HD 复制到网络驱动器所需的时间。为此，我有一个绝妙的想法，即使用单独的线程从 shutil 库中调用“移动”功能（请原谅，我不知道自己在做什么）。我遇到问题的地方是当一个线程试图移动一个目录时，它告诉我“[errno 13] Permission denied”。

这是我的问题的一般布局：

```
import shutil, threading
from Queue import Queue
def parentFunc():
    fileQ = Queue() #initialize a work queue
    lstDirsOld = ['C:\\LargeDirA','C:\\LargeDirB','C:\\LargeDirC','C:\\LargeDirD']
    lstDirsNew = ['H:\\LargeDirA','H:\\LargeDirB','H:\\LargeDirC','H:\\LargeDirD']

    for i in range(len(lstDirsOld)): #build the work queue
        fileQ.put(lstDirsOld[i],lstDirsNew[i])

    for i in range(len(lstDirsOld)): #attempt to copy files
        worker = Thread(target=childFunc,args=(fileQ,))
        worker.isDaemon = True
        worker.start()  #returns Errno 13

def childFunc(fileQ):
    while True:
        try:
            src,dst = fileQ.get()
            shutil.move(src,dst) #apparently this doesn't work in a thread
            fileQ.task_done()
        except Exception, e:
            print(str(e)) 
```

我尝试将移动命令移动到 parentFunc 并且效果很好。不过，我不愿将此称为解决方案，因为复制目录将花费大量时间。

感觉就像答案正盯着我的脸。由于我是工程师而不是程序员，因此我很难看到自己的错误，因此非常感谢任何指导。

# winapi - 如何重新初始化我的代码

> ID：14266278
> 
> 赞同：0
> 
> 时间：2013-01-10T20:01:23.493
> 
> 标签：winapi, dialog

嗨，我目前正在做一个项目，我们正在创建一个 UDP 服务器来与 KUKA 机器人通信。我们能够建立与机器人的连接并来回交换数据，但是当发生诸如机器人因电机过转矩而发生故障等事件时。因此，为了检测此故障，我们在代码中添加了超时，以便主对话框将关闭并重新打开，以便重新初始化所有变量，我们可以将连接设置为重新建立。

这是服务器代码：

```
#include "stdafx.h"
#include "HapticRobot.h"

#include "CMaths.h"
using namespace chai3d;

#include <winsock.h>
using namespace std;
#pragma comment(lib, "Ws2.lib")
#include <fstream>
#include <string>
#include <sstream>

DWORD WINAPI DoGravity(LPVOID lpParameter);

#define REFRESH_INTERVAL  0   // sec

const int kBufferSize = 1024;
int nTempHold;

extern HapticDevice hd;
extern HWND g_hWndHapticBox;
extern bool bRobotInMotion, bRobotConnectInit, bRobotConnected;
extern Handles hc;
bool err;
std::string stSend, stSendXML, stLine;
std::string stRobotStatus , stAppend;
TCHAR *chRobotStatus;
//variables for timeout
fd_set fds;
int n;
struct timeval tv;

//// Prototypes ////////////////////////////////////////////////////////

SOCKET SetUpListener(const char* pcAddress, int nPort);
bool EchoIncomingPackets(SOCKET sd);

//// DoWinsock /////////////////////////////////////////////////////////
// The module's driver function -- we just call other functions and
// interpret their results.

int DoWinsock(const char* pcAddress, int nPort)
{
    int nRetval = 0;

    ifstream inFile("HardDisk/ExternalData.xml");
    if (inFile.is_open())
    {
        while ( inFile.good() )
        {
            getline ( inFile, stLine);
            stSendXML.append(stLine);
        }
        inFile.close();
    }

    SendDlgItemMessage(g_hWndHapticBox, IDC_LIST_Server, LB_INSERTSTRING, 0, (LPARAM)L"Establishing the listener...");
    SOCKET ListeningSocket = SetUpListener(pcAddress, htons(nPort));
    SendDlgItemMessage(g_hWndHapticBox, IDC_LIST_Server, LB_INSERTSTRING, 0, (LPARAM)L"Waiting for connections...");
    bRobotConnectInit = true;
    SetDlgItemText(g_hWndHapticBox, IDC_STATIC_RobotStatus, _T("Waiting for robot"));
    while (1)
    {
        EchoIncomingPackets(ListeningSocket);
        bRobotConnected = false;
        bRobotConnectInit = true;

        SendDlgItemMessage(g_hWndHapticBox, IDC_LIST_Server, LB_INSERTSTRING, 0, (LPARAM)L"Acceptor restarting...");

    }
}

//// SetUpListener /////////////////////////////////////////////////////
// Sets up a listener on the given interface and port, returning the
// listening socket if successful; if not, returns INVALID_SOCKET.

SOCKET SetUpListener(const char* pcAddress, int nPort)
{
    u_long nInterfaceAddr = inet_addr(pcAddress);
    if (nInterfaceAddr != INADDR_NONE)
    {
        SOCKET sd = socket(AF_INET, SOCK_DGRAM, 0);

        sockaddr_in sinInterface;
        sinInterface.sin_family = AF_INET;
        sinInterface.sin_addr.s_addr = nInterfaceAddr;
        sinInterface.sin_port = nPort;
        if (bind(sd, (sockaddr*)&sinInterface, 
                sizeof(sockaddr_in)) != SOCKET_ERROR)
        {
            return sd;
        }

    }

    return INVALID_SOCKET;
}

//// EchoIncomingPackets ///////////////////////////////////////////////
// Bounces any incoming packets back to the client.  We return false
// on errors, or true if the client closed the socket normally.

bool EchoIncomingPackets(SOCKET sd)
{
    // Read data from client

    std::string stReceive;
    std::string stIPOC;

    std::wstring stTime;
    int nStartPos, nEndPos;
    char acReadBuffer[kBufferSize], acWriteBuffer[512];
    int nReadBytes;

    struct sockaddr_in clientAddr;
    int sockAddrSize = sizeof(struct sockaddr_in);

    //declarations for the low pass filter
    int CURRENT_VALUE = 2;
    double T = .004, w_co, OMEGA_co, f_co;

    hd.bFirstRunRobot = true;

    do
    {

    //This will be to timeout the socket connection
        FD_ZERO(&fds);
        FD_SET(sd, &fds);

        tv.tv_sec = 5;
        tv.tv_usec = 0;

        n = select (sd, &fds, NULL, NULL, &tv );
        if (n == 0)
        {

            PostMessage(g_hWndHapticBox,WM_CLOSE, 0, 0);
            Sleep(5000);

            PostMessage(g_hWndHapticBox, WM_INITDIALOG, 0, 0);
            Sleep(1000);
            //printf("Timeout..\n");
            //HapticBox(HWND, UINT, WPARAM, LPARAM);
            //return 0;
        }
        else if (n == -1)
        {
            printf("Error..\n");
            return 1;
        }
        //  end timeout

        nReadBytes = recvfrom(sd, acReadBuffer, sizeof(acReadBuffer), 0, (struct sockaddr*)&clientAddr, &sockAddrSize);

        //nReadBytes = recvfrom(sd, acReadBuffer, sizeof(acReadBuffer), MSG_PEEK, (struct sockaddr*)&clientAddr, &sockAddrSize);
        //if (nReadBytes == SOCKET_ERROR)
        //{
        //  SetDlgItemText(g_hWndHapticBox, IDC_STATIC_RobotStatus, _T("ERROR"));
        //}

        if (nReadBytes < 0 || nReadBytes == 0)
        {
            SetDlgItemText(g_hWndHapticBox, IDC_STATIC_RobotStatus, _T("ERROR 1"));
            return true;
        }

        if (nReadBytes > 0)
        {
            if (bRobotConnectInit)
            {
                bRobotConnectInit = false;
                bRobotConnected = true;
                SetDlgItemText(g_hWndHapticBox, IDC_STATIC_RobotStatus, _T("Connected to Robot"));
            }
        }

        stSend = stSendXML;
        stReceive = acReadBuffer;

        nStartPos = stReceive.find ("<IPOC>") + 6;
        nEndPos = stReceive.find ("</IPOC>");
        stIPOC = stReceive.substr (nStartPos, nEndPos - nStartPos);

        nStartPos = stSend.find ("<IPOC>") + 6;
        nEndPos = stSend.find ("</IPOC>");
        stSend.replace(nStartPos, nEndPos - nStartPos, stIPOC);

        //Raw sensor data
        nStartPos = stReceive.find ("RFx=") + 5;
        nEndPos = stReceive.find ("RFy=") - 2;
        hd.stRFx = stReceive.substr (nStartPos, nEndPos - nStartPos);
        hd.szRFx = hd.stRFx.c_str();
        hd.RFx = strtod(hd.szRFx, NULL);
        hd.RFx = hd.RFx * 0.22;

        nStartPos = stReceive.find ("RFy=") + 5;
        nEndPos = stReceive.find ("RFz=") - 2;
        hd.stRFy = stReceive.substr (nStartPos, nEndPos - nStartPos);
        hd.szRFy = hd.stRFy.c_str();
        hd.RFy = strtod(hd.szRFy, NULL);
        hd.RFy = hd.RFy * 0.22;

                **//...more XML stuff...//**

        //data the is to be sent to the robot
        if (hd.FirstTimePosition)
        {
            hd.RobotXStartPosition = hd.RobotXPosition;
            hd.RobotYStartPosition = hd.RobotYPosition;
            hd.RobotZStartPosition = hd.RobotZPosition;         
            hd.FirstTimePosition = false;
        }

        if(hd.LinearScale == 4)
        {
            f_co = 0.5;
        }
        else if (hd.LinearScale == 3)
        {
            f_co = 0.5;
        }
        else if (hd.LinearScale == 2)
        {
            f_co = 1;
        }
        else if (hd.LinearScale == 1)
        {
            f_co = 2;
        }
        else if (hd.LinearScale == 0.5)
        {
            f_co = 2;
        }
        else
        {
            f_co = 0.5;
        }

        if (hd.Fz < hd.MaxForcePos)
        {
            hd.ForceLimitPosZ = false;
        }
        if (hd.Fz > hd.MaxForceNeg)
        {
            hd.ForceLimitNegZ = false;
        }
        if (hd.Fz > hd.MaxForcePos || hd.ForceLimitPosZ)
        {
            if (!hd.ForceLimitPosZ)
            {
                hd.CurrentZtoRobotPosition = hd.ZtoRobot;
            }
            if (hd.CurrentZtoRobotPosition >= hd.ZtoRobot)
            {
                hd.NewZtoRobot = hd.PreviousZtoRobot;
                hd.ForceLimitPosZ = true;
            }
            else
            {
                hd.ForceLimitPosZ = false;
            }
        }

        if (hd.ForceLimitPosZ)
        {
            hd.ForceZtoRobot = hd.NewZtoRobot;
        }
        else
        {
            hd.ForceZtoRobot = hd.ZtoRobot;
        }

        w_co = f_co * C_TWO_PI;
        OMEGA_co = (2/T) * cTanRad((w_co * T) / 2);

        hd.raw_x[CURRENT_VALUE] = hd.XtoRobot;
        hd.raw_y[CURRENT_VALUE] = hd.YtoRobot;
        hd.raw_z[CURRENT_VALUE] = hd.ForceZtoRobot;

        hd.filtered_x[CURRENT_VALUE] = (pow(((OMEGA_co) / ((2 / T) + OMEGA_co)), 2)) * 
            ((hd.raw_x[CURRENT_VALUE]) + (2 * hd.raw_x[CURRENT_VALUE - 1] + hd.raw_x[CURRENT_VALUE - 2])) 
            - (((2 * (OMEGA_co - (2 / T))) / ((2 / T) + OMEGA_co)) * hd.filtered_x[CURRENT_VALUE - 1])
            - ((pow(((OMEGA_co - (2 / T)) / ((2 / T) + OMEGA_co)),2)) * hd.filtered_x[CURRENT_VALUE - 2]);

        **//more digital filter stuff//**    

        hd.raw_x[CURRENT_VALUE - 2] = hd.raw_x[CURRENT_VALUE - 1];
        hd.raw_y[CURRENT_VALUE - 2] = hd.raw_y[CURRENT_VALUE - 1];
        hd.raw_z[CURRENT_VALUE - 2] = hd.raw_z[CURRENT_VALUE - 1];

        hd.raw_x[CURRENT_VALUE - 1] = hd.raw_x[CURRENT_VALUE];
        hd.raw_y[CURRENT_VALUE - 1] = hd.raw_y[CURRENT_VALUE];
        hd.raw_z[CURRENT_VALUE - 1] = hd.raw_z[CURRENT_VALUE];

        hd.filtered_x[CURRENT_VALUE - 2] = hd.filtered_x[CURRENT_VALUE - 1];
        hd.filtered_y[CURRENT_VALUE - 2] = hd.filtered_y[CURRENT_VALUE - 1];
        hd.filtered_z[CURRENT_VALUE - 2] = hd.filtered_z[CURRENT_VALUE - 1];

        hd.filtered_x[CURRENT_VALUE - 1] = hd.filtered_x[CURRENT_VALUE];
        hd.filtered_y[CURRENT_VALUE - 1] = hd.filtered_y[CURRENT_VALUE];
        hd.filtered_z[CURRENT_VALUE - 1] = hd.filtered_z[CURRENT_VALUE];

        hd.stXtoRobot = dtostr(hd.filtered_x[CURRENT_VALUE]);
        nStartPos = stSend.find ("X=") + 3;
        stSend.replace(nStartPos, 6, hd.stXtoRobot);

        hd.stYtoRobot = dtostr(hd.filtered_y[CURRENT_VALUE]);
        nStartPos = stSend.find ("Y=") + 3;
        stSend.replace(nStartPos, 6, hd.stYtoRobot);

        hd.stZtoRobot = dtostr(hd.filtered_z[CURRENT_VALUE]);
        nStartPos = stSend.find ("Z=") + 3;
        stSend.replace(nStartPos, 6, hd.stZtoRobot);

        if (hd.ForceLimitPosZ)
        {
            hd.PreviousZtoRobot = hd.NewZtoRobot;
        }
        else
        {
            hd.PreviousZtoRobot = hd.ZtoRobot;
        }

        strcpy( static_cast<char*>( &acWriteBuffer[0] ), stSend.c_str() );

        if (nReadBytes > 0)
        {
            int nSentBytes = 0;
            int SendLength = strlen(acWriteBuffer);
            while (nSentBytes < SendLength)
            {
                int nTemp = sendto(sd, acWriteBuffer, SendLength, 0, (const sockaddr*)&clientAddr, sockAddrSize);
                nTempHold = nTemp;

                if (nTemp > 0)
                {
                    nSentBytes += nTemp;
                }
                else if (nTemp == SOCKET_ERROR)
                {
                    return false;
                }
                else
                {
                    // Client closed connection before we could reply to
                    // all the data it sent, so bomb out early.
                    SendDlgItemMessage(g_hWndHapticBox, IDC_LIST_Server, LB_INSERTSTRING, 0, (LPARAM)L"Peer unexpectedly dropped connection!");
                    return true;
                }
            }
        }
        else if (nReadBytes == SOCKET_ERROR)
        {
            return false;
        }
        hd.bFirstRunRobot = false;
    }while (nReadBytes != 0);

    SendDlgItemMessage(g_hWndHapticBox, IDC_LIST_Server, LB_INSERTSTRING, 0, (LPARAM)L"Connection closed by peer.");
    bRobotConnected = false;
    bRobotConnectInit = true;
    SetDlgItemText(g_hWndHapticBox, IDC_STATIC_RobotStatus, _T("Waiting for robot"));
    SetDlgItemText(g_hWndHapticBox, IDC_STATIC_RobotInMotion, _T("Robot not in motion"));

    return true;
    //}
} 
```

这是 GUI 的代码：

```
// HapticRobot.cpp : Defines the entry point for the application.
//

#include "stdafx.h"
#include "HapticRobot.h"
#include <sstream>
#include <string>
using namespace std;

#define MAX_LOADSTRING 100

// Global Variables:
HINSTANCE           g_hInst;            // current instance
HWND                g_hWndCommandBar;   // command bar handle
HWND                g_hWndHapticBox;    // haptic dialog handle

bool bRobotInMotion, bRobotConnectInit, bRobotConnected;
extern HapticDevice hd;
HDC hdc;
Handles hc;
DWORD WINAPI DoGravity(LPVOID lpParameter);
DWORD WINAPI DoConnectRobot(LPVOID lpParameter);

// Forward declarations of functions included in this code module:
ATOM                MyRegisterClass(HINSTANCE, LPTSTR);
BOOL                InitInstance(HINSTANCE, int);
LRESULT CALLBACK    WndProc(HWND, UINT, WPARAM, LPARAM);
INT_PTR CALLBACK    About(HWND, UINT, WPARAM, LPARAM);
INT_PTR CALLBACK    HapticBox(HWND, UINT, WPARAM, LPARAM);

int WINAPI WinMain(HINSTANCE hInstance,
                   HINSTANCE hPrevInstance,
                   LPTSTR    lpCmdLine,
                   int       nCmdShow)
{
    MSG msg;

    // Perform application initialization:
    if (!InitInstance(hInstance, nCmdShow)) 
    {
        return FALSE;
    }

    HACCEL hAccelTable;
    hAccelTable = LoadAccelerators(hInstance, MAKEINTRESOURCE(IDC_HAPTICROBOT));

    DialogBox(hInstance, (LPCTSTR)IDD_HAPTIC, NULL, HapticBox);

    // Main message loop:
    while (GetMessage(&msg, NULL, 0, 0)) 
    {
        if (!TranslateAccelerator(msg.hwnd, hAccelTable, &msg)) 
        {
            TranslateMessage(&msg);
            DispatchMessage(&msg);
        }
    }

    return (int) msg.wParam;
}

//
//  FUNCTION: MyRegisterClass()
//
//  PURPOSE: Registers the window class.
//
//  COMMENTS:
//
ATOM MyRegisterClass(HINSTANCE hInstance, LPTSTR szWindowClass)
{
    WNDCLASS wc;

    wc.style         = CS_HREDRAW | CS_VREDRAW;
    wc.lpfnWndProc   = WndProc;
    wc.cbClsExtra    = 0;
    wc.cbWndExtra    = 0;
    wc.hInstance     = hInstance;
    wc.hIcon         = LoadIcon(hInstance, MAKEINTRESOURCE(IDI_HAPTICROBOT));
    wc.hCursor       = 0;
    wc.hbrBackground = (HBRUSH) GetStockObject(WHITE_BRUSH);
    wc.lpszMenuName  = 0;
    wc.lpszClassName = szWindowClass;

    return RegisterClass(&wc);
}

//FUNCTION: InitInstance(HINSTANCE, int)

//PURPOSE: Saves instance handle and creates main window

//COMMENTS:

//     In this function, we save the instance handle in a global variable and
//     create and display the main program window.

BOOL InitInstance(HINSTANCE hInstance, int nCmdShow)
{
    HWND hWnd;
    TCHAR szTitle[MAX_LOADSTRING];          // title bar text
    TCHAR szWindowClass[MAX_LOADSTRING];    // main window class name

    g_hInst = hInstance; // Store instance handle in our global variable

    LoadString(hInstance, IDS_APP_TITLE, szTitle, MAX_LOADSTRING); 
    LoadString(hInstance, IDC_HAPTICROBOT, szWindowClass, MAX_LOADSTRING);

    if (!MyRegisterClass(hInstance, szWindowClass))
    {
        return FALSE;
    }

    hWnd = CreateWindow(szWindowClass, szTitle, WS_VISIBLE,
        CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, CW_USEDEFAULT, NULL, NULL, hInstance, NULL);

    if (!hWnd)
    {
        return FALSE;
    }

    ShowWindow(hWnd, nCmdShow);
    UpdateWindow(hWnd);

    if (g_hWndCommandBar)
    {
        CommandBar_Show(g_hWndCommandBar, TRUE);
    }

    return TRUE;
}

//
//  FUNCTION: WndProc(HWND, UINT, WPARAM, LPARAM)
//
//  PURPOSE:  Processes messages for the main window.
//
//  WM_COMMAND  - process the application menu
//  WM_PAINT    - Paint the main window
//  WM_DESTROY  - post a quit message and return
//
//
LRESULT CALLBACK WndProc(HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam)
{
    int wmId, wmEvent;
    PAINTSTRUCT ps;
    HDC hdc;

    switch (message) 
    {
        case WM_COMMAND:
            wmId    = LOWORD(wParam); 
            wmEvent = HIWORD(wParam); 
            // Parse the menu selections:
            switch (wmId)
            {
                case IDM_HELP_ABOUT:
                    DialogBox(g_hInst, (LPCTSTR)IDD_ABOUTBOX, hWnd, About);
                    break;
                case IDM_FILE_EXIT:
                    dhdClose ();
                    DestroyWindow(hWnd);
                    break;
                default:
                    return DefWindowProc(hWnd, message, wParam, lParam);
            }
            break;
        case WM_CREATE:
            g_hWndCommandBar = CommandBar_Create(g_hInst, hWnd, 1);
            CommandBar_InsertMenubar(g_hWndCommandBar, g_hInst, IDR_MENU, 0);
            CommandBar_AddAdornments(g_hWndCommandBar, 0, 0);
            break;
        case WM_PAINT:
            hdc = BeginPaint(hWnd, &ps);

            // TODO: Add any drawing code here...

            EndPaint(hWnd, &ps);
            break;
        case WM_DESTROY:
            dhdClose ();        
            CommandBar_Destroy(g_hWndCommandBar);
            PostQuitMessage(0);
            break;

        default:
            return DefWindowProc(hWnd, message, wParam, lParam);
    }
    return 0;
}

// Message handler for about box.
INT_PTR CALLBACK About(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)
{
    switch (message)
    {
        case WM_INITDIALOG:
            RECT rectChild, rectParent;
            int DlgWidth, DlgHeight;    // dialog width and height in pixel units
            int NewPosX, NewPosY;

            // trying to center the About dialog
            if (GetWindowRect(hDlg, &rectChild)) 
            {
                GetClientRect(GetParent(hDlg), &rectParent);
                DlgWidth    = rectChild.right - rectChild.left;
                DlgHeight   = rectChild.bottom - rectChild.top ;
                NewPosX     = (rectParent.right - rectParent.left - DlgWidth) / 2;
                NewPosY     = (rectParent.bottom - rectParent.top - DlgHeight) / 2;

                // if the About box is larger than the physical screen 
                if (NewPosX < 0) NewPosX = 0;
                if (NewPosY < 0) NewPosY = 0;
                SetWindowPos(hDlg, 0, NewPosX, NewPosY,
                    0, 0, SWP_NOZORDER | SWP_NOSIZE);
            }
            return (INT_PTR)TRUE;

        case WM_COMMAND:
            if ((LOWORD(wParam) == IDOK) || (LOWORD(wParam) == IDCANCEL))
            {
                EndDialog(hDlg, LOWORD(wParam));
                return TRUE;
            }
            break;

        case WM_CLOSE:
            EndDialog(hDlg, message);
            return TRUE;

    }
    return (INT_PTR)FALSE;
}

// Message handler for haptic box.
BOOL CALLBACK HapticBox(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)
{

    switch (message)
    {
        case WM_INITDIALOG:
            SetWindowPos(hDlg, 0, 130, 200,
                0, 0, SWP_NOZORDER | SWP_NOSIZE);
            hd.Done = 1;
            bRobotInMotion = false;
            bRobotConnectInit = false;
            g_hWndHapticBox = hDlg;
            hd.HapticScaleX = 100;
            hd.HapticScaleY = 100;
            hd.HapticScaleZ = 100;
            hd.MaxForcePos = 160;
            hd.MaxForceNeg = -160;
            hd.EnableForces = true;
            hd.ForceLimitPosX = false;
            hd.ForceLimitPosY = false;
            hd.ForceLimitPosZ = false;
            hd.ForceLimitNegX = false;
            hd.ForceLimitNegY = false;
            hd.ForceLimitNegZ = false;
            hd.filtered_x[0,1,2] = 0;       //low pass output for x
            hd.filtered_y[0,1,2] = 0;       //low pass output for y
            hd.filtered_z[0,1,2] = 0;       //low pass output for z
            hd.raw_x[0,1,2] = 0;            //raw haptic data for low pass x
            hd.raw_y[0,1,2] = 0;            //raw haptic data for low pass y
            hd.raw_z[0,1,2] = 0;            //raw haptic data for low pass z
            hc.Xmm = GetDlgItem(g_hWndHapticBox, IDC_STATIC_X);
            hc.Ymm = GetDlgItem(g_hWndHapticBox, IDC_STATIC_Y);
            hc.Zmm = GetDlgItem(g_hWndHapticBox, IDC_STATIC_Z);

            hc.XtoRobot = GetDlgItem(g_hWndHapticBox, IDC_STATIC_XtoRobot);
            hc.YtoRobot = GetDlgItem(g_hWndHapticBox, IDC_STATIC_YtoRobot);
            hc.ZtoRobot = GetDlgItem(g_hWndHapticBox, IDC_STATIC_ZtoRobot);

            hc.Fx = GetDlgItem(g_hWndHapticBox, IDC_STATIC_Fx);
            hc.Fy = GetDlgItem(g_hWndHapticBox, IDC_STATIC_Fy);
            hc.Fz = GetDlgItem(g_hWndHapticBox, IDC_STATIC_Fz);

            hc.rHz = GetDlgItem(g_hWndHapticBox, IDC_STATIC_Rate);

            hc.HapticStatus = GetDlgItem(g_hWndHapticBox, IDC_STATIC_HapticStatus);
            hc.RobotInMotion = GetDlgItem(g_hWndHapticBox, IDC_STATIC_RobotInMotion);
            hc.RobotStatus = GetDlgItem(g_hWndHapticBox, IDC_STATIC_RobotStatus);

///////////////////////////////////////////////////////////////////////////////////////
            hd.HapticConnected = false;
            if (hd.HapticConnected == false)
            {

                DWORD nThreadID;
                CreateThread(0, 0, DoConnectRobot, 0, 0, &nThreadID);
                Sleep(100);
                CreateThread(0, 0, DoGravity, 0, 0, &nThreadID);
                hd.HapticConnected = true;

            }

            return (INT_PTR)TRUE;

        case WM_CTLCOLORSTATIC:

            if(IDC_STATIC_HapticStatus == ::GetDlgCtrlID((HWND)lParam))
            {
                hdc = (HDC)wParam;
                if (hd.Done == 1)
                {
                    SetBkColor(hdc, RGB(255,0,0)); //red
                    return (BOOL)::CreateSolidBrush(RGB(255,0,0)); //red
                }
                else
                {
                    SetBkColor(hdc, RGB(0,255,0)); //green
                    return (BOOL)::CreateSolidBrush(RGB(0,255,0)); //green
                }
            }
            if(IDC_STATIC_RobotStatus == ::GetDlgCtrlID((HWND)lParam))
            {

                hdc = (HDC)wParam;
                if (bRobotConnectInit)
                {
                    SetBkColor(hdc, RGB(250, 255, 5)); //yellow
                    return (BOOL)::CreateSolidBrush(RGB(250, 255, 5));
                }
                else if (bRobotConnected)
                {
                    SetBkColor(hdc, RGB(0,255,0)); //green
                    return (BOOL)::CreateSolidBrush(RGB(0,255,0));
                }
                else
                {
                    SetBkColor(hdc, RGB(255,0,0)); //red
                    return (BOOL)::CreateSolidBrush(RGB(255,0,0));
                }
            }

            if(IDC_STATIC_RobotInMotion == ::GetDlgCtrlID((HWND)lParam))
            {

                hdc = (HDC)wParam;
                if (bRobotInMotion)
                {
                    SetBkColor(hdc, RGB(0,255,0)); //green
                    return (BOOL)::CreateSolidBrush(RGB(0,255,0));
                }
                else
                {
                    SetBkColor(hdc, RGB(255,0,0)); //red
                    return (BOOL)::CreateSolidBrush(RGB(255,0,0));
                }
            }

            break;

        case WM_CLOSE:
            hd.Done = 1;
            EndDialog(hDlg, message);
            return TRUE;

    }
    return (INT_PTR)FALSE;
} 
```

有更多与解决方案相关的代码，如果需要，我可以附加。我的想法被认为只是打电话给这个`WM_INITDIALOG`案例，这样基本上它与关闭程序并重新打开它是一样的。任何建议都会被采纳。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:11:56.703

Callign WM_INITDIALOG 绝对不会像你想象的那样做。除非您完全理解它们，否则不要发送随机的 Windows 消息。

鉴于您的设计，我的建议是让您的程序启动另一个自身实例并退出旧实例。查看MSDN 上的[CreateProcess](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682425%28v=vs.85%29.aspx)以了解有关如何启动另一个进程的详细信息。考虑到您已经拥有的东西，我认为这将是最可维护且易于编码的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:20:42.460

我建议像这样反复调用 DialogBox：

```
do
{
  DialogBox(hInstance, (LPCTSTR)IDD_HAPTIC, NULL, HapticBox);

} while (ReOpenDialog); 
```

`ReOpenDialog`您根据操作成功设置的全局在哪里（或者，为了避免全局，您可以使用 DialogBox 通过[EndDialog](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms645472%28v=vs.85%29.aspx)的对话框返回结果）。

此外，您不需要消息循环，因为`DialogBox`调用内部有自己的，因此创建了一个阻塞调用（这就是我上面的循环实际上可以工作的原因！）。

# objective-c - iPhone 5 在 autoresizingMask 上苦苦挣扎

> ID：14266283
> 
> 赞同：0
> 
> 时间：2013-01-10T20:01:47.803
> 
> 标签：objective-c, ios6

只是将我的应用程序迁移到 iphone 5 屏幕尺寸，我正在努力调整掩码大小。

我不明白什么时候尊重面具，什么时候不尊重。我制作了 2 个测试标签，具有相同的自动调整大小掩码选项：

```
self.label1.autoresizingMask = UIViewAutoresizingFlexibleTopMargin
self.label2.autoresizingMask = UIViewAutoresizingFlexibleTopMargin 
```

两个标签的框架都是以编程方式定义的。`label1`在等中设置`viewDidLoad`，`label2`在稍后调用的函数中。两个帧的 y 坐标都设置为 10。

```
self.label1.frame = CGRectMake(110, 10, 50, 30);
self.label2.frame = CGRectMake(60, 10, 50, 30); 
```

效果是，在 iphone 5 模拟器中，`label1`显示比`label2`. 对于`label1`（在 中设置的框架`viewDidLoad`，`autoresizingMask`尊重），因为`label2`不尊重掩码。

那么，当我将框架设置在外部时，为什么不考虑自动调整大小`viewDidLoad`？

# android - 如何从我的应用程序内部通过电子邮件发送 android 设备的日志文件？

> ID：14266289
> 
> 赞同：2
> 
> 时间：2013-01-10T20:02:20.150
> 
> 标签：android

作为错误报告，我想将设备和/或应用程序日志发送到电子邮件帐户。为此，我在我的视图中准备了一个按钮。有人可以帮我解决这个问题，我该如何检索日志文件？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:29:20.743

```
 String separator = System.getProperty("line.separator");
            try {
                Process process = Runtime.getRuntime().exec("logcat -d");
                BufferedReader bufferedReader = new BufferedReader(
                        new InputStreamReader(process.getInputStream()));

                String line;
                while ((line = bufferedReader.readLine()) != null) {
                    log.append(line);
                    log.append(separator);
                }
            } catch (Exception e) {

            } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-11-08T00:27:29.007

这是一个稍微改进的版本，改编自 Ramesh（谢谢）。主要区别是自己做缓冲。它很快。

```
 private void extractLogToFile()
  {
    // Make file name.
    String fullName = ...;

    // Extract to file.
    File file = new File (fullName);
    InputStreamReader reader = null;
    FileWriter writer = null;
    try
    {
      // get input stream
      String cmd = "logcat -d -v time";
      Process process = Runtime.getRuntime().exec(cmd);
      reader = new InputStreamReader (process.getInputStream());

      // write output stream
      writer = new FileWriter (file);
      char[] buffer = new char[10000];
      do 
      {
        int n = reader.read (buffer, 0, buffer.length);
        if (n == -1)
            break;
        writer.write (buffer, 0, n);
      } while (true);

      reader.close();
      writer.close();
    }
    catch (IOException e)
    {
      if (writer != null)
          try {
            writer.close();
        } catch (IOException e1) {
        }
      if (reader != null)
          try {
            reader.close();
        } catch (IOException e1) {
        }
      e.printStackTrace();
      return;
    }
  } 
```

# c - 从 windows xp 中的 addrinfo 结构获取 ipv6 地址

> ID：14266292
> 
> 赞同：1
> 
> 时间：2013-01-10T20:02:35.150
> 
> 标签：c, windows-xp, winsock, ipv6, getaddrinfo

如何从 windows xp 下的 addrinfo 结构中获取 ipv6 地址？除了 WSAAddressToString 之外还有其他可能性吗（有没有人成功使用过那个？）？

```
getaddrinfo(server_ip, port, &hints, &result)
addr = (struct sockaddr_in6*) rp->ai_addr;
WSAAddressToString((struct sockaddr*) rp, (DWORD) sizeof(*addr), 0, ipbuf, &iplen); //cant get it to work 
```

非常感谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:16:54.227

尝试：

`WSAAddressToString(rp->ai_addr, rp->ai_addrlen, NULL, ipbuf, &iplen);`

在您的示例中，您将 addrinfo 作为 sockaddr 传递。（我假设 rp 正在迭代结果或其他东西。）

# tfs - Team Foundation Build 无法构建

> ID：14266297
> 
> 赞同：0
> 
> 时间：2013-01-10T20:02:56.243
> 
> 标签：tfs, tfsbuild

我们为我们的解决方案构建了一个工作版本，但是当我们添加一个新项目时，它停止工作。构建“成功”运行，日志显示：*Run MSBuild for Project -> Built [my solution] for target(s) publish*（对所有项目都相同），但它实际上并没有构建任何东西。

问题似乎出在构建配置中。我的构建过程定义设置为为我的自定义配置（ForMSBuild | Any CPU）构建，但 TFB 解释该定义的方式有问题（我需要该自定义配置，因为我将一些 .dll 复制到指定文件夹以包含在发布过程，以便可用于 ClickOnce 安装）。
在某一时刻，只有添加到解决方案中的新 .dll 没有构建（即使它们在配置管理器中列出并选中了构建复选框）。所以我重新创建了我的自定义配置，确保我所有的 .dll 都检查为在（ForMSBuild | Any CPU）下构建，现在没有构建。我已经直接在 Visual Studio (2012) 中打开了构建机器上的源代码，并验证了我的自定义配置的设置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:16:37.900

编辑构建定义，在 Process 选项卡中单击 Solutions To Build 旁边的省略号，转到 Configurations 选项卡并确保将 TFS Build 设置为构建您想要的配置：

![TFS 构建配置](../Images/15b2510349c8de84327cd0cdd37476ab.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T22:28:14.990

事实证明，我实际上没有检查要构建的主要启动项目。真是愚蠢的错误，但我当然希望 MSBuild 没有吐出所有这些不正确的消息。

# php - 将 MySQL 函数传递给 Eloquent ORM 查询

> ID：14266298
> 
> 赞同：9
> 
> 时间：2013-01-10T20:02:56.700
> 
> 标签：php, database, laravel, eloquent

我正在尝试在 Eloquent ORM 中执行以下查询，但似乎无法执行 MySQL 函数 -

```
$post = Post::where('slug', '=', $slug)->where('YEAR(created_at)', '=', $year)->first(); 
```

我得到的异常如下 - 消息：

```
SQLSTATE[42S22]: Column not found: 1054 Unknown column 'YEAR(created_at)' in 'where clause'

SQL: SELECT * FROM `posts` WHERE `slug` = ? AND `YEAR(created_at)` = ? LIMIT 1

Bindings: array (
  0 => 'placeholder',
  1 => 2013,
) 
```

因此，基本上，它将`YEAR()`MySQL 函数封装为列。有没有办法在不使用原始查询的情况下做到这一点？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-06-13T12:36:06.510

为了防止 Eloquent ORM 用撇号包装第一个变量，您可以使用`DB:raw`如下函数：

```
$post = Post::where('slug', '=', $slug)
        ->where(DB::raw('YEAR(created_at)'), '=', $year)
        ->first(); 
```

你会得到查询：

```
SELECT * FROM `posts` WHERE `slug` = ? AND YEAR(created_at) = ? LIMIT 1 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-10T20:09:44.050

无论如何，您可能不想`YEAR()`在 WHERE 子句中使用该函数。这将阻止您在`created_at`列上使用任何索引。我建议你`LIKE`改用：

```
$post = Post::where('slug', '=', $slug)->where('created_at', 'LIKE', $year . '%')->first(); 
```

`query()`如果您需要在查询中使用不受支持的 MySQL 函数，您也可以只使用原始 SQL 查询（使用方法）。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2017-09-05T16:40:24.003

你有两种方法可以做到这一点，这取决于你的 laravel 版本

首先使用**Raw**方法传递函数，如下例所示

```
$post = Post::where('slug', $slug)
     ->where(DB::raw('YEAR(created_at)'), $year)
     ->first(); 
```

ِ您也可以在 (select,group,order) 方法中使用它，有关 Raw [Laravel Docs](https://laravel.com/docs/5.5/queries#raw-expressions)的更多信息，它从 v 4.2 开始

第二次使用**whereYear**方法

```
$post = Post::where('slug', $slug)
      ->whereYear('created_at', $year)
      ->first(); 
```

此方法从 V 5.3 开始以获取更多信息[阅读 Where 部分](https://laravel.com/docs/5.3/queries#where-clauses) ，您将找到所有日期方法（whereDate / whereMonth / whereDay / whereYear）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-03T03:13:56.923

我使用 Laravel 5.3

```
$post = Post::where('slug', '=', $slug)->whereYear('created_at', '=', $year)->first(); 
```

这家伙帮了我>> [https://stackoverflow.com/a/32843415/7752468](https://stackoverflow.com/a/32843415/7752468)

# windows - 使用 windows 内置插件（可能加上 TeraTerm 和 perl）来模拟 netcat 的原始连接模式

> ID：14266302
> 
> 赞同：0
> 
> 时间：2013-01-10T20:03:19.637
> 
> 标签：windows, perl, netcat

所以我试图让 Windows 像我们的 Linux 机器一样运行。

基本上，我们设置了一个服务器以在端口上运行特定程序。在 Linux 机器上，运行以下命令将显示程序的帮助输出：

```
echo "--help" | nc servername portnum 
```

是否可以在 Windows 中做类似的事情，只使用 Windows 7、TeraTerm 和 Perl 的内置功能（这将与可以在实验室中的多台机器上运行的代码一起使用，因此额外的软件不能容易安装）。

许多 Windows 防病毒程序将 NetCat 检测为恶意软件（后门代理），因此将其放入共享目录是行不通的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:17:18.353

编写 Perl 脚本来连接远程主机和端口并将其标准输入打印到套接字并不难。

```
#!/usr/bin/perl

use strict;
use warnings;

use IO::Socket;

my $host = shift @ARGV;
my $port = shift @ARGV;

my $remote = IO::Socket::INET->new(
                    Proto    => "tcp",
                    PeerAddr => $host,
                    PeerPort => $port,
                )
              or die "cannot connect to port $port at $host";
while (<>) { print $remote $_ } 
```

（无耻地改编自谷歌的“简单 perl 客户端”，[http://www.ccsf.edu/Pub/Perl/perlipc/A_Simple_Client.html](http://www.ccsf.edu/Pub/Perl/perlipc/A_Simple_Client.html)）

# jquery - 为具有多个选择框的页面压缩 jQuery 隐藏/显示脚本

> ID：14266307
> 
> 赞同：0
> 
> 时间：2013-01-10T20:03:46.293
> 
> 标签：jquery, show-hide, multiple-instances, minify

我正在构建一个页面，该页面将包含几个选择框，这些框将根据所选值显示特定链接。我可以很好地显示/隐藏所有内容，但我知道我正在努力地做事。我对 JS/jQuery 还是很陌生，所以我不确定如何将我的脚本压缩为一个函数（我确信这是可能的）。

### 工作的jQuery：

```
$('.trqVerSelect').change(function () {
  $('.trqVersions .links').hide();
  $('.ver' + $(this).val()).show();
}).change();

$('.mwmVerSelect').change(function () {
  $('.mwmVersions .links').hide();
  $('.ver' + $(this).val()).show();
}).change(); 
```

[这是一个 jsFiddle](http://jsfiddle.net/paGhk/)，表明上述方法有效。我不想要的是为页面上的每个选择框实例构建大量这些函数——其中将有 12 个左右。

我尝试了下面的代码，它有点工作，但每当你做一个新的选择时，它都会隐藏所有其他选择。我希望用户在不同的选择框中进行新选择时能够保留其他选择。

```
$('select').change(function () {
  $('.links').hide();
  $('.ver' + $(this).val()).show();
}).change(); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:08:31.357

这似乎有效，[http://jsfiddle.net/paGhk/1/](http://jsfiddle.net/paGhk/1/)

```
$('select').change(function () {
  $(this).parent().next().children().hide().filter(".ver" + $(this).val()).show();
}).change(); 
```

解释：

```
$('select').change(function () {
  $(this)  // <select />
    .parent() // <div />
    .next()  // <div />
    .children() // <p /><p />
    .hide() // hide them both
    .filter(".ver" + $(this).val()) // select the one with correct ver class
    .show(); // show it
}).change(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:27:37.057

无需更改您的 HTML 结构或使用额外的类（就像我在此答案的先前版本中所做的那样），您可以执行以下操作：

```
$('.component').each(function(){
  var $component = $(this);
  $component.find('select').on('change', function(){
    $component.find('.links').hide();
    $component.find('.ver' + $(this).val()).show();
  }).change();
}); 
```

工作演示：http: [//jsfiddle.net/Rykus0/paGhk/4/](http://jsfiddle.net/Rykus0/paGhk/4/)

# django - Django 循环遍历模板中的对象列表

> ID：14266308
> 
> 赞同：2
> 
> 时间：2013-01-10T20:03:46.453
> 
> 标签：django, list, templates, object, loops

我正在尝试将查询的结果存储在列表或类似列表中（尝试不同的替代方案），但我得到最远的一个是：

```
def index(request):
for post in blog_posts:
        comments_total.setdefault(post.id, []).append(comments.total(post.id))
return render_to_response('blog/index.html', {
'comments': comments_total}) 
```

在返回数据中我得到： {5L: [2], 6L: [1]}

我正在使用此代码访问：

```
{% if comments %}
{{comments}}<br />
{% for cid in comments %}
{% if cid == post.id %}
{{cid}} - {{comments.cid.0}}<br />
{{cid}} - {{comments.6.0}}
{% endif %}
{% endfor %}
{% endif %} 
```

它整体打印出来的是：

{5L: [2], 6L: [1]} 5 - 5 - 1

是否有替代方法可以获取所有评论，在这种情况下，博客，计算每篇文章的结果并将其返回到模板？

我想要做的是为博客的起始页获取一个计数器。“你对这篇文章有 (X) 条评论”之类的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T22:26:09.593

您可以以更有效的方式“显示每个帖子的评论数”

假设您有两个模型`Post`和`Comment`. 只需在模型中定义一个`related_name`到 post`ForeignKey`关系`Comment`：

```
class Comment(models.Model):
    post = models.ForeignKey(Post, related_name='comments')
    # other fields 
```

然后在模板中你可以这样做：

```
{% for post in posts %}
    {{post.comments.count}}
{% endfor %} 
```

# autocomplete - 自动完成字段，为服务器端可扩展性设计

> ID：14266309
> 
> 赞同：0
> 
> 时间：2013-01-10T20:03:46.893
> 
> 标签：autocomplete

在处理表单字段的自动完成功能时，用户键入的每个字符都会触发 api 调用以获取建议，您如何代理此调用以进行缩放？

*   由于跨域限制，直接来自 java 脚本是不可能的，并且不安全，因为这会暴露 api 密钥。
*   将其移至控制器或模型，会在服务器端产生大量查询，当活动用户群达到一定限制时，这会给它们带来沉重的负担。

这种功能的标准行业惯例是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T05:28:49.747

您需要在客户端和服务器上非常聪明。到处使用大量缓存以避免额外的工作。使用 CORS 或 JSONP。坦率地说，这是很多工作。不是说 Lucene/SOLR 不是非常支持自动完成的引擎。顺便说一句：看看 www.rockitsearch.com 。它具有所有基本功能的实现自动完成功能。您需要做的就是：在那里注册和导出您的数据。然后将您的小部件集成到您的网站上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:40:41.183

不确定“代理此呼叫”是什么意思，但总的来说：

1.  您可以使用 JSONP 进行跨域查询。但是您会在客户端支付性能损失。

2.  查询同一个域是可以的。由于主题非常笼统，因此没有单一的答案。您如何扩展取决于您的基础架构。如果应用程序设计为水平扩展，您只需向服务器池添加更多服务器即可扩展。使用 Amazon 或 Azure 云服务非常简单。优化数据库查询和索引以使数据库快速响应也很重要。如果用户群很大，您甚至可以拥有相同数据库的多个副本来帮助提高性能。

不要过早地担心优化，因为你可能永远也达不到这一点。如果你得到它是一个很好的问题，在这种情况下解决方案是微不足道的。

# arrays - VB6 CSV 搜索 visualbasic

> ID：14266311
> 
> 赞同：0
> 
> 时间：2013-01-10T20:03:54.393
> 
> 标签：arrays, csv, vb6, evaluate

我有一个 .csv 文件，它有 100 行和 8 列。每行看起来像下面的东西

```
0,0,0,0,0,0,0,5 

0,1,0,0,1,0,0,6 
```

我需要评估每个领域。如果字段 = 1（在第 1 行和第 7 行之间），我必须将该行的第 8 列值写入文本框，如果字段 = 0 则不为该行写入任何内容。

我对如何评估每个领域感到非常困惑。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T10:15:35.883

我将 ADO 与 Jet-Driver 一起使用。这非常简单，导入的结果是一个 ADO.Recordset，您可以轻松浏览它。

```
Dim cnCSV As ADODB.Connection
Set cnCSV = New ADODB.Connection
cnCSV.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;Data Source=" & Chr(34) & lFilePath & Chr(34) & ";Extended Properties=" & Chr(34) & "text;HDR=Yes;FMT=Delimited" & Chr(34) & ";"
cnCSV.Open

Dim p_ImportRst As ADODB.Recordset
Set p_ImportRst = New ADODB.Recordset
lstrSQL = "SELECT * FROM [" & lFileName & "]"
Set p_ImportRst = cnCSV.Execute(lstrSQL) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T06:15:02.347

使用“拆分”

“根据分隔符（例如逗号或空格）将字符串拆分为单独的元素，并将结果元素存储在从零开始的数组中”

[http://www.vb6.us/tutorials/vb-string-array-functions-split-join-filter](http://www.vb6.us/tutorials/vb-string-array-functions-split-join-filter)

创建一个可变大小的数组。使用 lbound 和 ubound 来获取它的大小，执行 for 循环并将数字相加。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-12T01:00:28.137

这是一种应该有效的方法。伪代码...

```
dim vData() as variant   
dim nHandle as integer
dim sTextLine as string 
nHandle = FreeFile
open "c:\filename.csv" for input as nHandle 

Do While Not EOF(nHandle)
    Line Input #nHandle, sTextLine '// Read line into variable.

    ' break up the line into multiple pieces
    vData = split(sTextLine, ",")

    ' your criteria here
    if vData(0) = 0 then ...
    if vData(1) = ...

Loop
Close #nHandle 
```

# ios - 点击集合查看单元格更改图像

> ID：14266312
> 
> 赞同：2
> 
> 时间：2013-01-10T20:03:55.030
> 
> 标签：ios, uitableview, uicollectionview

我有一个收集单元格，想在触摸时更改图像，然后再返回，我应该如何构造它？

突出显示（在下面效果很好）之后，我希望它在再次触摸时回到旧图像。谢谢你。在 viewWillDissapear 我想知道突出显示了哪些单元格。

```
-(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath{

    UIImage *backGround =[UIImage imageNamed:@"IconHighlight.png"];
    UIImageView *av = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, backGround.size.width, backGround.size.height)];
    av.backgroundColor = [UIColor clearColor];
    av.opaque = NO;
    av.image = backGround;

    [[collectionView cellForItemAtIndexPath:indexPath] setBackgroundView:av];
    [[collectionView cellForItemAtIndexPath:indexPath].backgroundView setTag:1];
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-12T05:06:45.613

创建 CustomCell - UICollectionViewCell 的子类。将init自定义为以下

```
//CustomCell.m
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        backgroundImageView.image = [UIImage imageNamed:@"background.png"];
        highlightImageView.image = [UIImage imageNamed:@"highlight.png"];
        self.backgroundView = backgroundImageView;
        _isHighlight = -1;
    }
    return self;
}

-(void)tapToChangeBackGround{

    self.isHighlight = -self.isHighlight;

    if (self.isHighlight==1) {
        self.backgroundView = highlightImageView;
    }
    else{
        self.backgroundView = backgroundImageView;
    }
}

//didSelect
-(void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath{
    CustomCell *cell = (CustomCell *)[collectionView cellForItemAtIndexPath:indexPath];
    [cell tapToChangeBackGround];
} 
```

# python - 前瞻性搜索 基于位置的搜索

> ID：14266314
> 
> 赞同：4
> 
> 时间：2013-01-10T20:03:58.403
> 
> 标签：python, google-app-engine

[搜索 API](https://developers.google.com/appengine/docs/python/search/)支持使用[Geopoint 类](https://developers.google.com/appengine/docs/python/search/geopointclass)进行基于位置的搜索，从而可以[使用距离约束和其他好东西](https://developers.google.com/appengine/docs/python/search/overview#Performing_Location-Based_Searches)进行搜索。

我还注意到 Search 和 Prospective Search API 具有共同的查询语法和共同的感觉。因此，如果这些地理搜索功能出现在预期搜索中，我不会感到惊讶

所以我的问题是：是否有某种方式可以通过 appengine API 或任何其他库在前瞻性搜索中提供类似的地理搜索功能？

干杯!

# asp.net-mvc - 如何在 CA SiteMinder 上的受保护领域中配置公共规则

> ID：14266316
> 
> 赞同：0
> 
> 时间：2013-01-10T20:04:13.427
> 
> 标签：asp.net-mvc, siteminder

我想将 SiteMinder 配置为允许对特定 URI 的公共访问（对于未经身份验证的用户）。

我创建了一个允许访问特定 URI 的规则，以及一个适用于所有用户和该规则的策略。默认情况下，该领域受到保护。当我尝试访问此 URI 时，SiteMinder 会阻止访问。

如何配置规则以允许对特定 URI 进行公共访问？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T02:18:45.903

对于此行为，您不需要 SiteMinder 规则。

使用 Web 代理配置对象的**IgnoreUrl**属性。

# java - 键盘挤压滚动视图

> ID：14266319
> 
> 赞同：1
> 
> 时间：2013-01-10T20:04:25.043
> 
> 标签：java, android, xml

我在 ScrollView 和 xml 上有点挣扎。

当我按下键盘时，我的屏幕如下所示：http: [//imgur.com/9Csmh](http://imgur.com/9Csmh)

但是，当我打开键盘时，我的屏幕如下所示：http: [//imgur.com/Y6nJB](http://imgur.com/Y6nJB)

如何阻止按钮与最后 2 个 EditText 重叠？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:44:02.083

在 Manifest.xml 你需要指定 android:configChanges="keyboardHidden|orientation|Keyboard"

# python - Python 时间增量

> ID：14266325
> 
> 赞同：0
> 
> 时间：2013-01-10T20:04:48.607
> 
> 标签：python, paramiko, timedelta

请让我知道我是否正确地执行了这部分。我试图抓取仅在过去 24 小时内修改的文件。但是，无论修改时间如何，我的输出都是目录中的所有文件：

```
yesterday = date.today() - timedelta(days=1)
dayToStr = yesterday.strftime('%Y%m%d')

file_list_attr = sftp.listdir_attr()
for file in file_list_attr:
  if  file.st_mtime <= dayToStr:
    print file 
```

输出

> > > -rw-r--r-- 1 4012 60 3404961 1 月 9 日 18:32 2_YEAR_912828UD0_20130109.dat -rw-r--r-- 1 4012 60 10206411 1 月 9 日 18:32 3_YEAR_912828dUG3_20130--r-r9。 - 1 4012 60 68311760 09 Jan 18:34 5_YEAR_912828UE8_20130109.dat -rw-r--r-- 1 4012 60 54215712 09 Jan 18:35 7_YEAR_912828UF5_20130109.dat -rw-r--r-- 1 4012 60 88014103 09 Jan 18 :37 10_YEAR_912828TY6_20130109.dat -rw-r--r-- 1 4012 60 53565072 09 Jan 18:38 30_YEAR_912810QY7_20130109.dat -rw-r--r-- 1 4012 60 8527412 04 Jan 18:31 2_YEAR_912828UD0_20130104.dat -rw- r--r-- 1 4012 60 21659138 1 月 4 日 18:31 3_YEAR_912828UC2_20130104.dat -rw-r--r-- 1 4012 60 91281894 1 月 4 日 18:34 5_YEAR_912828UE8_20130104。dat -rw-r--r-- 1 4012 60 80421507 1 月 4 日 18:36 7_YEAR_912828UF5_20130104.dat -rw-r--r-- 1 4012 60 108700356 1 月 4 日 18:38 10_YEAR_9012828TY6_r-201。 -- 1 4012 60 50204292 04 Jan 18:39 30_YEAR_912810QY7_20130104.dat -rw-r--r-- 1 4012 60 2319656 07 Jan 18:24 2_YEAR_912828UD0_20130107.dat -rw-r--r-- 1 4012 60 6978760 07 Jan 18:24 3_YEAR_912828UC2_20130107.dat -rw-r--r-- 1 4012 60 53579177 07 Jan 18:25 5_YEAR_912828UE8_20130107.dat -rw-r--r-- 1 4012 60 46069381 07 Jan 18:26 7_YEAR_912828UF5_20130107.dat -rw -r--r-- 1 4012 60 70802355 1 月 7 日 18:28 10_YEAR_912828TY6_20130107.dat -rw-r--r-- 1 4012 60 43050822 1 月 7 日 18:29 30_YEAR_912810QY7_2013017。dat -rw-r--r-- 1 4012 60 2713906 1 月 8 日 18:31 2_YEAR_912828UD0_20130108.dat -rw-r--r-- 1 4012 60 8889264 1 月 8 日 18:31 3_YEAR_912828UC2_201301-01 -- 1 4012 60 63857903 08 Jan 18:32 5_YEAR_912828UE8_20130108.dat -rw-r--r-- 1 4012 60 55544096 08 Jan 18:34 7_YEAR_912828UF5_20130108.dat -rw-r--r-- 1 4012 60 89750161 08 Jan 18:36 10_YEAR_912828TY6_20130108.dat -rw-r--r-- 1 4012 60 59233399 1 月 8 日 18:37 30_YEAR_912810QY7_20130108.dat34 7_YEAR_912828UF5_20130108.dat -rw-r--r-- 1 4012 60 89750161 08 Jan 18:36 10_YEAR_912828TY6_20130108.dat -rw-r--r-- 1 4012 60 59233399 08 Jan 18:37 30_YEAR_912810QY7_20130108.dat34 7_YEAR_912828UF5_20130108.dat -rw-r--r-- 1 4012 60 89750161 08 Jan 18:36 10_YEAR_912828TY6_20130108.dat -rw-r--r-- 1 4012 60 59233399 08 Jan 18:37 30_YEAR_912810QY7_20130108.dat

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:12:43.823

`file.st_mtime`是一个整数时间戳。 `dayToStr`是一个字符串。

在 Python2 中，`integers` **总是**比较 less`strings`的[原因](https://stackoverflow.com/q/3270680/190597)是`i`in 在 in`int`之前`s`按`str`字母顺序排列：

```
In [123]: 1234 < 'foobar'
Out[123]: True 
```

在 Python3 中，将 an`int`与 a进行比较`str`会引发 TypeError：

```
>>> 1234 < 'foobar'
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: unorderable types: int() < str() 
```

* * *

相反，比较 datetime 对象：

```
import datetime as DT
import os

yesterday = DT.datetime.now() - DT.timedelta(days=1)
# or, if you want 00:00 AM, yesterday:
# yesterday = DT.datetime.now().replace(hour = 0, minute = 0, second = 0, microsecond = 0) - DT.timedelta(days=1)

file_list_attr = sftp.listdir_attr()
for pfile in file_list_attr:
    if DT.datetime.fromtimestamp(pfile.st_mtime) > yesterday:
        print pfile 
```

* * *

参考：

*   [datetime.fromtimestamp](http://docs.python.org/2/library/datetime.html#datetime.date.fromtimestamp)：用于将时间戳转换为`DT.datetime`对象。
*   [datetime.replace](http://docs.python.org/2/library/datetime.html#datetime.datetime.replace)：建议将小时、分钟、秒（的`yesterday`）设置回零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:57:04.637

与“昨天”相比似乎失败了

```
for pfile in file_list_attr:
    print DT.datetime.fromtimestamp(pfile.st_mtime)

2013-01-09 18:32:06
2013-01-09 18:32:22
2013-01-09 18:34:07
2013-01-09 18:35:27
2013-01-09 18:37:38

for pfile in file_list_attr:
    print DT.datetime.fromtimestamp(pfile.st_mtime) > yesterday

Traceback (most recent call last):
  File "<pyshell#41>", line 2, in <module>
    print DT.datetime.fromtimestamp(pfile.st_mtime) > yesterday
TypeError: can't compare datetime.datetime to datetime.date 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-06T23:21:03.973

这是一个示例，说明如何：

1.  列出目录中的所有文件
2.  打印所有符合24h前修改条件的文件

    ```
     # Task: grab files ONLY modified in the past 24 hours

        import os
        import datetime

        myPath = "/users/george/documents/"

        # Adding all the files found in myFolder in a collection
        fileCollection = os.listdir(myPath)

        # Iterating through the files, printing their last modified date
        for i in fileCollection:
            # Getting the timestamp in a variable
            fileModTimeStamp = os.path.getmtime(myPath + str(i))
            fileModDateTime = datetime.datetime.fromtimestamp(fileModTimeStamp)

            # Calculating the time delta
            currentTime = datetime.datetime.now()
            timeElapsed =  currentTime - fileModDateTime

            # 24h dimedelta
            twentyFourHours = datetime.datetime(1900, 1, 2, 0, 0, 0, 0) -  datetime.datetime(1900, 1, 1, 0, 0, 0, 0)

            # Print the files that meet the condition
            if timeElapsed <= twentyFourHours:
                print "The File: " + str(i) + " Was Last Modified At: " + str(fileModDateTime) + " ,Which was about: " \
                  + str(timeElapsed) + " ago." 
    ```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-10T20:29:10.427

我不相信 os 模块会起作用，因为我正在使用 paramiko 到远程主机 SFTP 并对目录中的文件执行操作

```
for filename in file_list_attr:
    mtime = os.path.getmtime(filename)
    print mtime

Traceback (most recent call last):
  File "<pyshell#22>", line 2, in <module>
    mtime = os.path.getmtime(filename)
  File "U:\ActivPy\lib\genericpath.py", line 54, in getmtime
    return os.stat(filename).st_mtime
TypeError: coercing to Unicode: need string or buffer, SFTPAttributes found 
```

# javascript - 通知/挂钩文档/窗口更改

> ID：14266326
> 
> 赞同：0
> 
> 时间：2013-01-10T20:04:50.270
> 
> 标签：javascript, google-chrome-extension, firefox-addon, google-chrome-devtools, firefox-addon-sdk

我想编写一个浏览器扩展程序，当某些事件发生时会做一些事情，我想知道是否已经有这样的 API（Firefox 或 Chrome）。

我最感兴趣的是 DOM 更改和窗口更改。

让我们考虑这个例子：

```
<html>
<head>
<script type="text/javascript">
    function addContentToDocument(content){
        document.cookie = "debug=true"; //<--- Notify

        if(content != null){
            document.write(content); //<--- Notify
        };
    }
</script>
</head>

<body onload="addContentToDocument('Say cheese')">
<h3>My Content</h3>
</body>
</html> 
```

所以在这个简单的例子中，我会对 2 个事件感兴趣：document.cookie 更改和 document.write 方法调用。当这些事情发生时，我希望在我的分机中得到通知。不是这些语句是否存在于可用的 javascript 上下文中，而是它们是否实际正在执行。

我试图在 Firefox 扩展和 Chrome 扩展中搜索 API，但找不到任何有用的东西。

谢谢你。

**更新**：我感兴趣的其他方法是调用**eval()**方法和**localStorage**修改

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:09:32.743

当前的 Firefox（和带有`webkit`前缀的 Chrome）支持[`Mutation Observers`](https://developer.mozilla.org/en-US/docs/DOM/MutationObserver?redirectlocale=en-US&redirectslug=DOM%2FDOM_Mutation_Observers). 我不认为您可以使用它来捕获 cookie 更改，但您绝对可以捕获对 DOM 所做的更改（无论是否使用`document.write`）。

Mozilla 文档中的示例：

```
// select the target node
var target = document.querySelector('#some-id');

// create an observer instance
var observer = new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    console.log(mutation.type);
  });    
});

// configuration of the observer:
var config = { attributes: true, childList: true, characterData: true }

// pass in the target node, as well as the observer options
observer.observe(target, config);

// later, you can stop observing
observer.disconnect(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T03:33:12.427

如果您想监视在选项卡/窗口中打开的文档的更改，那么 MutationObservers 就是这样做的方法。如果你想监控纯 JS 中调用的方法，你需要查看 Spidermonkey 的 JSEngine apis，特别是 apis arou nd profiling & tracking：

[https://developer.mozilla.org/en-US/docs/SpiderMonkey/JSAPI_User_Guide#Tracing_and_Profiling](https://developer.mozilla.org/en-US/docs/SpiderMonkey/JSAPI_User_Guide#Tracing_and_Profiling)

# php - 将数组中的所有项目转换为变量

> ID：14266327
> 
> 赞同：0
> 
> 时间：2013-01-10T20:04:54.470
> 
> 标签：php, arrays

我需要将数组中的所有项目转换为变量，例如：

```
$item[0] = "apple=5";
$item[1] = "banana=7";
$item[2] = "orange=8"; 
```

我想把它转换成这个：

```
$apple=5;
$banana=7;
$orange=8; 
```

像正常变量一样。可能吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:11:37.013

您可以尝试加入数组并将字符串解析为变量

```
parse_str(implode('&',$item)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T20:07:36.673

看起来很傻，为什么不把它转换成关联数组呢？但如果你必须：

```
foreach($item as $x) {
  list($name, $val) = explode('=', $x, 2);
  $$name = $val;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:11:22.010

你可以这样做

```
$item[0] = "apple=5";
$item[1] = "banana=7";
$item[2] = "orange=8";

foreach($item as $row)
{
    $new    =   explode('=',$row);
    $array[$new[0]] =   $new[1];
}

extract($array);
echo $apple;
echo $banana;
echo $orange; 
```

# c# - 为什么 ASP.NET 编译器在每次构建中都重建所有二进制文件？

> ID：14266328
> 
> 赞同：11
> 
> 时间：2013-01-10T20:04:58.677
> 
> 标签：c#, asp.net, .net, aspnet-compiler

当我使用 aspnet_compiler 重新编译我的项目（asp.net、c#）时，即使没有进行任何代码更改，重建的二进制文件也会发生变化（与以前的构建相比）。

据我了解，这是由于构建每次构建时都会生成一个新的模块版本 ID（guid）（以区分构建），另一个类似的问题谈到了这一点：[我可以在构建时指定模块版本 ID（MVID）吗？ .net 程序集？](https://stackoverflow.com/questions/5598291/can-i-specify-the-module-version-id-mvid-when-building-a-net-assembly)

上面链接的问题似乎表明没有办法重建项目并让二进制文件与先前构建的相同未更改代码相匹配.. 好的，很好，我理解 - 但为什么要重建所有二进制文件？

我认为，根据文档（[http://msdn.microsoft.com/en-us/library/ms229863(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms229863(v=vs.80).aspx)），除非 -c 被指定为参数，否则 aspnet_compiler 应该只重建那些实际需要的二进制文件（由于更改的代码）。我是误会还是遗漏了什么？

我正在使用的 aspnet_compiler 参数：

```
aspnet_compiler -f -u -fixednames -nologo -v / -p .\myproject\ .\mybuild\ 
```

请注意，此问题仅发生在网站项目中，而不是 Web 应用程序项目（它们的编译方式不同）。即使您创建了一个没有功能的网站项目和页面，并且在构建之间以任何方式打开或更改它，也会出现此问题。

反编译生成的二进制文件显示没有差异。比较两个“相同”构建的二进制文件每次都会显示二进制文件的同一部分存在微小差异 - 我认为这可能与随机构建 guid 有关。我发现无法避免构建之间的这种变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T14:57:34.797

查看 Eric Lippert 的出色[回答](https://stackoverflow.com/a/1918663/50016)，了解 C# 编译器如何通过多次传递来编译源代码。尽管功能相同，但您的构建与前一个不同，我可能有很多原因。

*   编译器用 IL 等价物替换特殊语言功能，例如使用 block with
*   编译器对您的代码进行了许多优化，每次迭代可能会产生略有不同的输出。
*   编译器必须为匿名方法名称创建具体化名称，并且每次编译时它们都不同
*   还有更多你可以使用反汇编程序轻松解决的原因

查看这些反汇编程序并反编译您的库或可执行文件以获得更好的理解。
[http://ilspy.net/](http://ilspy.net/) , [http://www.telerik.com/products/decompiler.aspx](http://www.telerik.com/products/decompiler.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-20T04:00:31.630

我发现在许多情况下都使用 aspnet_compiler，尤其是在我的项目在同一解决方案中引用其他项目的情况下，会导致通常难以解释的完全重建。（尽管我调查过几次有“变化”，即使它们并没有真正影响任何事情，例如对空格、评论等的变化）

我在 Visual Studio 中也遇到了一些插件的问题，这些插件完成了从操作制表和其他空白、实际项目文件等所有工作。虽然这些变化对我们人类没有明显的变化，但编译器一看就知道了去“我看到了变化！[重建所有的东西！！！](http://cdn.memegenerator.net/instances/400x/35121831.jpg) ”

不确定我的回答是否有帮助，但我会禁用你的插件，运行编译器，然后再次运行编译器，看看会发生什么......

# r - 从 ACF 相关图中提取置信区间值

> ID：14266333
> 
> 赞同：9
> 
> 时间：2013-01-10T20:05:18.940
> 
> 标签：r, correlation

在 R 中，我们可以运行时间序列的 ACF 相关图，置信区间带将以浅蓝色绘制。但是当我拉取 ACF 对象的结构时，我找不到这些值。有谁知道如何提取置信区间带的值？

例如

```
List of 6
 $ acf   : num [1:27, 1, 1] 1 0.06453 -0.06354 0.00213 -0.01324 ...
 $ type  : chr "correlation"
 $ n.used: int 501
 $ lag   : num [1:27, 1, 1] 0 1 2 3 4 5 6 7 8 9 ...
 $ series: chr "tser[i:(i + 500)]"
 $ snames: NULL
 - attr(*, "class")= chr "acf" 
```

![在此处输入图像描述](../Images/96861ccf1d64ea645118ce7a14fade79.png)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T20:44:20.447

我查看了该函数，但看不到提取置信区间的简单方法。区域在`plot.acf`函数中计算。要查看此功能，请使用

```
getS3method("plot", "acf") 
```

在这个函数中，有一个变量`clim`，这就是你想要的。最简单的方法是复制`plot.acf`到`myplot.acf`，但返回`clim`值。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-08-17T15:40:02.817

我知道这个问题已经很老了，但是如果有人确实想要置信区间值，那么它只是置信水平的 z 值除以所用观察次数的 sqrt。在`plot.acf`函数中，这是在这里计算的：

```
clim0 <- if (with.ci) 
    qnorm((1 + ci)/2)/sqrt(x$n.used) 
```

其中`with.ci`是一个逻辑值，指示用户是否想要绘制置信区间，并且`ci`是所需的置信水平（例如 0.95、0.9 等...）

编辑：如果您假设滞后值是白噪声，这是置信区间，如果不是这种情况，您可以应用校正

```
clim <- clim0 * sqrt(cumsum(c(1, 2 * x$acf[-1, i, j]^2))) 
```

[您可以在此处](http://www.pstat.ucsb.edu/faculty/feldman/174-03/lectures/l12.pdf)阅读更多相关信息

# azure-storage - 如何从 CloudBlobDirectory.ListBlobs 获取对 BlockBlob 对象的引用？

> ID：14266341
> 
> 赞同：20
> 
> 时间：2013-01-10T20:05:45.423
> 
> 标签：azure-storage

我正在使用 Microsoft Azure .NET 客户端库与 Azure 云存储进行交互。我需要能够访问有关其元数据集合中每个 blob 的附加信息。我目前正在使用 CloudBlobDirectory.ListBlobs() 方法来获取我在 blob 名称中设计的目录结构的特定目录中的 blob 列表。ListBlobs() 方法返回 IListBlobItem 对象的列表。它们只有几个属性：Url 以及对父目录和父容器的引用。我需要获取实际 blob 对象的元数据。

我设想有一种方法可以将 IListBlobItem 转换为 BlockBlob 对象，或者使用 IListBlockItem 来获取对 BlockBlob 的引用，但似乎找不到这样做的方法。

我的问题是：有没有办法从这个方法中获取 BlockBlob 对象，还是我必须使用不同的方式来获取实际的 BlockBlob 对象？如果不同，那么您能否提出一种实现此目的的方法，同时还能够通过“目录”方案进行过滤？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-01-10T22:13:50.427

好的...我找到了一种方法来做到这一点，虽然它看起来有点笨拙和间接，但它确实实现了我认为应该可行的主要事情，即将 IListBlobItem 直接转换为 CloudBlockBlob 对象。

我正在做的是从 Directory 对象的 ListBlobs() 方法中获取列表，然后遍历列表中的每个项目并将项目转换为 CloudBlockBlob 对象，然后调用 FetchAttributes() 方法来检索属性（包括元数据） . 然后将一个新的“信息”对象添加到一个新的信息对象列表中。这是我正在使用的代码：

```
CloudBlobDirectory dir = container.GetDirectoryReference(dirPath);

var blobs = dir.ListBlobs(true);

foreach (IListBlobItem item in blobs)
{
    CloudBlockBlob blob = (CloudBlockBlob)item;
    blob.FetchAttributes();
    files.Add(new ImageInfo
    {
        FileUrl = item.Uri.ToString(),
        FileName = item.Uri.PathAndQuery.Replace(restaurantId.ToString().PadLeft(3, '0') + "/", ""),
        ImageName = blob.Metadata["Name"]
    });
} 
```

整个“Blob”概念似乎不必要地复杂，并且似乎没有实现我所认为的 Blob 包装器的主要功能之一。也就是说，一种通过允许对名称、目录、容器和元数据进行查询来扩展搜索功能的方法。我原以为您可以构建一个 linq 查询，其内容类似于：“返回 'images' 容器中所有 blob 的列表，这些 blob 位于 'natural/landscapes/' 目录路径中，元数据键为 '类别'，其值为'日落'”。似乎没有办法做到这一点，这对我来说似乎是一个错失的机会。那好吧。

如果我错了并且离基地很远，请告诉我。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-02-11T15:49:27.937

这种方法是为*Java*开发的，但我希望可以通过某种方式对其进行修改以适应任何其他受支持的语言。尽管您要求的功能尚未明确开发，但我想我找到了一种不同的（希望不那么笨重）从元素访问`CloudBlockBlob`数据的方法。`ListBlobItem`

例如，以下代码可用于删除特定目录中的每个 blob。

```
String blobUri;
CloudBlobClient blobClient = /* Obtain your blob client */

try{
     CloudBlobContainer container = /* Obtain your blob container */

     for (ListBlobItem blobItem : container.listBlobs(blobPrefix)) {

          if (blobItem instanceof CloudBlob) {
                blob = (CloudBlob) blobItem;
                if (blob.exists()){
                    System.out.println("Deleting blob " + blob.getName());
                    blob.delete();
                }
          }
     }
}catch (URISyntaxException | StorageException ex){
        Logger.getLogger(BlobOperations.class.getName()).log(Level.SEVERE, null, ex);
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-10-16T15:54:37.120

前面的答案很好。我只想指出两点：

1)**现在推荐使用 ASYNC 编程**，Azure SDK 也支持它。所以尝试使用它：

```
CloudBlobDirectory dir = container.GetDirectoryReference(dirPath);
var blobs = dir.ListBlobs(true);

foreach (IListBlobItem item in blobs)
{
    CloudBlockBlob blob = (CloudBlockBlob)item;
    await blob.FetchAttributesAsync(); //Use async calls...
} 
```

2)**在单独的调用中获取元数据效率不高。**该代码为每个 blob 对象发出 2 个 HTTP 请求。**ListBlobs() 方法也支持通过设置 BlobListingDetails 参数在一次调用中获取元数据**：

```
CloudBlobDirectory dir = container.GetDirectoryReference(dirPath);
var blobs = dir.ListBlobs(useFlatBlobListing: true, blobListingDetails: BlobListingDetails.Metadata); 
```

我建议使用第二个代码，这是可能的。因为它是获取元数据的最有效方式。

# vim - 如何在 Gnome 终端的不同模式下更改 VIM 光标形状

> ID：14266346
> 
> 赞同：11
> 
> 时间：2013-01-10T20:06:19.637
> 
> 标签：vim, gnome-terminal, text-cursor

我想根据我当前所处的模式更改 VIM *（不是 gVIM）的光标。我想：*

*   正常和可视模式 = 块光标
*   插入和命令模式 = I 光束光标

我尝试添加以下代码，`.vimrc`但它不起作用。

```
if has("autocmd")
  au InsertEnter * silent execute "!gconftool-2 --type string --set /apps/gnome-terminal/profiles/Default/cursor_shape ibeam"
  au InsertLeave * silent execute "!gconftool-2 --type string --set /apps/gnome-terminal/profiles/Default/cursor_shape block"
  au VimLeave * silent execute "!gconftool-2 --type string --set /apps/gnome-terminal/profiles/Default/cursor_shape ibeam"
endif 
```

[我从http://vim.wikia.com/wiki/Change_cursor_shape_in_different_modes](http://vim.wikia.com/wiki/Change_cursor_shape_in_different_modes)得到了那段代码，但它说它是用于 Gnome-Terminal（2.26 版），我有 Gnome-Terminal（3.60 版）。不确定这是否是它不起作用的原因。

**关于如何做到这一点的任何想法？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-06-17T12:50:53.903

我有 gnome-terminal 3.10.2，我通过以下步骤让它工作：

创建一个名为 gnome-terminal-cursor-shape.sh 的脚本：

```
#!/bin/sh
DEFAULTPROF=`dconf read /org/gnome/terminal/legacy/profiles:/default`
DEFAULTPROF=`echo "$DEFAULTPROF" | sed -e "s/^'/:/" -e "s/'$//"`
dconf write /org/gnome/terminal/legacy/profiles:/$DEFAULTPROF/cursor-shape "'$1'" 
```

并用 ibeam、块或下划线调用它以更改光标形状。

将脚本放在 /usr/bin 或 /usr/local/bin 中，并将以下行添加到您的 .vimrc 中：

```
if has("autocmd")
    au InsertEnter *
        \ if v:insertmode == 'i' |
        \   silent execute "!gnome-terminal-cursor-shape.sh ibeam" |
        \ elseif v:insertmode == 'r' |
        \   silent execute "!gnome-terminal-cursor-shape.sh underline" |
        \ endif
    au InsertLeave * silent execute "!gnome-terminal-cursor-shape.sh block"
    au VimLeave * silent execute "!gnome-terminal-cursor-shape.sh block"
endif 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-10T14:12:49.223

对我来说，gnidmoos 解决方案在将名为 gnome-terminal-cursor-shape.sh 的脚本脚本更改为：

```
#!/bin/sh
gconftool-2 --set "/apps/gnome-terminal/profiles/Default/cursor_shape" --type string "$1" 
```

（在 .vimrc 中使用相同的行）

附言。我正在运行 ubuntu 14.04，GNOME 终端 3.6.2

干杯!

# asp.net-mvc - 如何从 .NET 应用程序创建全文搜索索引或目录？

> ID：14266350
> 
> 赞同：4
> 
> 时间：2013-01-10T20:06:47.480
> 
> 标签：asp.net-mvc, sql-server-2008, full-text-search, orchardcms

我正在尝试使用具有多租户配置的 SQL Server 2008 R2 和 Orchard CMS 部署全文搜索解决方案。每个租户都有自己的数据库。我们正在使用自动数据迁移来管理数据库架构更改。我想使用迁移创建一个全文目录和索引。但是我收到以下错误：

`CREATE FULLTEXT CATALOG statement cannot be used inside a user transaction.`

我确实知道错误的原因，但我无法确定解决方法。我试图使用`System.Data.SqlClient.SqlConnection`应用程序内的类打开一个新的数据库连接，并以某种方式将其配置为不创建事务，但这并没有实现任何目标。

是否可以通过 .NET 提供程序创建全文索引/目录，而不是通过 SSMS 直接连接到数据库？

编辑：

我已经尝试使用 SMO 使用此代码：

```
var server = new Server(new ServerConnection(new SqlConnection(connectionString)));

var database = server.Databases[databaseName];

var fulltextCatalog = new FullTextCatalog(database, fullTextCatalogName);
fulltextCatalog.Create(); 
```

结果与相同的异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:42:52.490

您可以使用[SMO](http://msdn.microsoft.com/en-us/library/ms212724%28v=sql.100%29.aspx)[创建和管理全文索引](http://msdn.microsoft.com/en-us/library/ms219681%28v=sql.100%29.aspx)- 以及几乎任何其他 SQL Server 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:32:35.660

用户必须对数据库具有 CREATE FULLTEXT CATALOG 权限，或者是 db_owner 或 db_ddladmin 固定数据库角色的成员。

# mysql - MySQL 用波兰语符号插入

> ID：14266351
> 
> 赞同：0
> 
> 时间：2013-01-10T20:06:48.623
> 
> 标签：mysql, character-encoding, insert, collation

我有 MySQL db，它已将 character_set 设置为 utf-8，并且 collat​​ion=utf8_polish_ci。当我通过 MySQL Workbench 插入带有波兰语标志的记录时，一切似乎都很好。
但是当我通过我的 asp.net 站点插入记录时，波兰语标志会转换为普通标志，如 a、e、o。为什么会这样？有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:11:45.563

也许这个链接中的文化设置？

[ASP.NET 编码](http://msdn.microsoft.com/en-us/library/39d1w2xf%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:08:47.043

检查您的连接字符集（从 asp.net 连接到 MySQL 时）。有关设置连接字符集的示例，请参见[http://forums.asp.net/t/1619144.aspx/1 。](http://forums.asp.net/t/1619144.aspx/1)

# r - 如何估计伽马分布的形状和比例。具有特定的平均值和 95% 的分位数？

> ID：14266354
> 
> 赞同：4
> 
> 时间：2013-01-10T20:07:07.920
> 
> 标签：r, statistics, gamma-distribution

在给定特定平均值（或中位数）和特定分位数（95% 分位数）的情况下，在 R 中是否有任何方法可以计算伽马分布的比例和形状？

例如，我的**平均值 = 130**

和**95% 的分位数 = 300**

分布**偏移**为**80**

有没有办法获得满足这些标准的伽马的比例和形状？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T21:02:54.960

这是一种方法：

```
myfun <- function(shape) {
    scale <- 130/shape
    pgamma(300, shape, scale=scale) - 0.95
}

tmp <- uniroot( myfun, lower=2, upper=10 )

myshape <- tmp$root
myscale <- 130/tmp$root

qgamma(0.95, shape=myshape, scale=myscale)
integrate( function(x) x*dgamma(x,shape=myshape,scale=myscale), 
    lower=0, upper=Inf ) 
```

我不确定你所说的偏移量 80 是什么意思，如果这只是伽马变为非零的地方，那么从 130 和 300 中减去 80 并执行与上述相同的操作。

# excel - 宏循环遍历行直到空值，复制值并将这些结果保存到 CSV？

> ID：14266356
> 
> 赞同：0
> 
> 时间：2013-01-10T20:07:14.270
> 
> 标签：excel, vba

我想创建一个宏，它将遍历活动 Excel 工作表中的行。每次循环迭代都会复制 A、B 和 C 列的值。如果第一个单元格是空白的，我想结束循环，除非空单元格在第二行。然后我想继续循环。最终，在复制完所有数据后，我想将复制的数据写入 CSV 文件。这可能吗？

![Excel 工作表](../Images/824330fd1fbb782f4f565856a5df0a0a.png)

我尝试录制一个宏，但解决方案一点也不健壮，因为它不使用循环，而是硬编码`Range Selects`：

```
Sub Export_to_CSV()
'
' Export_to_CSV Macro
'

'
    Range("A1:C1,A3:C27").Select
    Range("A3").Activate
    Selection.Copy
    Workbooks.Add
    ActiveSheet.Paste
    Sheets("Sheet2").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("Sheet3").Select
    ActiveWindow.SelectedSheets.Delete
    ChDir "C:\CSV"
    ActiveWorkbook.SaveAs Filename:="C:\CSV\MacroCSV.csv", FileFormat:=xlCSV, _
        CreateBackup:=False
End Sub 
```

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:43:03.537

如果您的要求与您编写的**完全**一样，那么这应该可以工作。

```
Option Explicit

Sub Export_To_CSV()

Dim wkbMain as Workbook, wkbCopy as Workbook
Dim wksMain as Worksheet, wksCopy as WOrksheet

Set wkbMain = ThisWorkbook
Set wkbCopy = Workbooks.Add

Set wksMain = wkbMain.Sheets("mySheet")
Set wksCopy = wkbCopy.Sheets(1)

With wksMain
  .Range(.Range("A3"),.Range("C3").End(xlDown)).Copy wksCopy.Range("A1")
End With

With wkbCopy

    Application.DisplayAlerts = False

    Dim x as Integer
    For x = 2 to .Worksheets.Count
        .Sheets(x).Delete
    Next

    Application.DisplayAlerts = True

    .SaveAs Filename:="C:\CSV\MacroCSV.csv", FileFormat:=xlCSV, CreateBackup:=False

End With

End Sub 
```

# mysql - 如何找到 mysql 数据库的目录表示？

> ID：14266360
> 
> 赞同：1
> 
> 时间：2013-01-10T20:07:28.820
> 
> 标签：mysql, database, character-encoding

我试图找到与mysql相关的这个问题的答案：说一个数据库`hello-there`，那么它的文件夹表示是：`hello@002dthere` 正如mysql帮助所说：[http ://dev.mysql.com/doc/refman/5.5/en/identifier-mapping.html](http://dev.mysql.com/doc/refman/5.5/en/identifier-mapping.html)

```
All nonletter characters except underscore (_), as well as letters from alphabets
that do not have uppercase/lowercase mapping (such as Hebrew) are encoded using
hexadecimal representation using lowercase letters for hex digits a..f:

0x003F -> @003f
0xFFFF -> @ffff

The hexadecimal values correspond to character values in the ucs2 double-byte 
character set. 
```

有没有办法找到我在 mysql 客户端发出的相应文件夹名称，例如显示数据库；有人可能会争辩：分析数据库名称并将任何非字母数字转换为 ucs2，但这是性能杀手：

```
mysql> select hex('-');
+----------+
| hex('-') |
+----------+
| 2D       |
+----------+ 
```

谢谢...

# php - 我有一家 shopify 商店，我希望能够看到我的库存何时售罄？

> ID：14266363
> 
> 赞同：1
> 
> 时间：2013-01-10T20:07:32.643
> 
> 标签：php, javascript, html, e-commerce, shopify

我有一家在 shopify 中开发的商店，我希望能够在我网站后端区域的订单表格上看到某件商品何时售罄。

基本上，当有人购买我们缺货的产品时，我会收到一份订单表格，其中包含详细信息以及他们购买的产品的详细信息，但是我希望在此表格中通知我该商品缺货。

我已经完成了这段编码，但是它似乎不起作用？

```
<td class="item-product">
    <div class="cart">
      <a href="{{item.product.url }}">{{item.product.title}}</a>
      <a href="{{item/order.url }}">{{item.order.title}}</a>
      <br />
      <strong>Size :</strong> {{item.variant.title}}
      {% if item.variant.available == true %}
          {% if item.variant.inventory_quantity > 0 %}  
          {% else %}
              <p style="color:red;"> 
                  Item is currently being restocked and will take an extra
                  3-4 weeks to ship
              </p>
          {% endif %}
      {% endif %}   
    </div>
</td> 
```

谁能帮我？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-12T03:03:25.207

我想我可能对你有一个想法。

首先，我是这样理解您的问题的：当您的一种产品的库存水平低于某个阈值时，您需要某种自动通知。因此，如果您的 Green Steel Widgets 库存降至 10 以下，您想了解它，以便尽快补货。

如果我走在正确的轨道上，这就是我的想法。

1.  首先，打开 Shopify 后台。然后，打开“首选项”菜单，然后单击“电子邮件和通知”项。

2.  打开“新订单通知”模板（第一行，第二项）。查看 PLAIN TEXT 模板（打开此模板后页面上的第一个模板）。请注意，客户不会看到此电子邮件。只有你，所以请随意发挥创意！

3.  假设您尚未修改此模板，最后三行应如下所示：

    ```
    {% for line in line_items %}{{ line.quantity }}x {{line.title }}        (sku: {{ line.sku }})
    {% endfor %} 
    ```

    将这两行替换为以下三行

    ```
    {% for line in line_items %}{{ line.quantity }}x {{line.title }}        (sku: {{ line.sku }})
    {% if line.variant.inventory_management && line.variant.inventory_quantity < 10 %}****WARNING! SKU: {{line.sku}} HAS LOW INVENTORY****{% endif %}
    {% endfor %} 
    ```

所有这一切的结果将是一个纯文本的电子邮件通知，当您的物品库存降至 10 以下时，该通知类似于以下内容。

```
店老板，

Bob Biller 今天（1 月 11 日下午 6:51）向您下了一个新订单。

付款方法：
  贝宝

运输方式：
  通用运输

收件地址：
  史蒂夫托运人
    航运街 123 号
    肯塔基州希奇顿 K2P0S0
    美国
    555-555-船

1x 大锤 (sku: SKU2006-001)
****警告！SKU：SKU2006-001 库存不足****
1x 线切割机（货号：SKU2006-020）
****警告！SKU：SKU2006-020 库存不足****

```

这是一个非常简单的示例，但希望它可以为您提供一些关于如何使用订单通知电子邮件作为库存警报机制的想法。如果您启用此通知的 HTML 版本并在其中添加一些 Liquid 逻辑，您会得到很多爱好者。

希望这可以帮助！祝你好运！

* * *

# 更新 (2013-01-13)

* * *

在评论中，原始海报澄清说，他们希望“低库存警告”以某种方式显示在 Shopify 管理界面的订单详细信息页面中。我已经编辑了我的答案以显示一种方法。

## 添加低库存警告作为行项目自定义属性

在您的文件中的某处`cart.liquid`，您会发现为客户购物车中的每个行项目构建 HTML 的 for 循环。代码将如下所示：

```
{% for item in cart.items %} 
```

现在，在 for 循环中的某个地方，您*应该*能够找到带有 HTML`<input>`标记的行。将以下代码添加到该标记正下方的新行中。

```
{% assign post_sale_inventory_count = item.variant.inventory_quantity | minus: item.quantity %}

{% if item.variant.inventory_management == "shopify" and post_sale_inventory_count < 10 %}
    <input type="hidden" name="attributes[{{item.variant.id}}-ALERT]" value="INVENTORY LOW FOR SKU: {{item.variant.sku}}" />
{% endif %} 
```

这样做的目的是`<input>`为每个订单项创建一个隐藏字段，如果该订单按原样放置，其产品变型库存将低于 10。

如果客户实际下此订单，则 Shopify 管理员订单页面的备注部分应包含以下内容。

```
123456-警报：SKU 的库存不足：ADM9500-YELOW-LRG

654321-警报：SKU 的库存不足：FRSB965-XL-CS

```

* * *

## 更新 2 (2013-01-14)

* * *

我的示例代码出现了一些语法和结构错误。我已修复它们并将正确的代码添加到此答案中。我已经在一家测试店进行了测试，我确信它可以工作。请试一试，如果您有任何问题，请告诉我。

祝你好运！

# javascript - 如何使用滑块更改 mousedown/up 触发振荡器的音高并使用 Javascript 和 Web Audio API 在 mouseup 事件后保持状态

> ID：14266365
> 
> 赞同：0
> 
> 时间：2013-01-10T20:07:36.800
> 
> 标签：javascript, web-audio-api

代码中的注释应该是不言自明的。

```
<div id="pad2"></div>
<input id="oscPitch" type="range" min="5" max="500" step="1" value="50"/>
<p>Pitch</p>

<script>

context = new webkitAudioContext();         
var pad2 = document.getElementById("pad2");
pad2.onmousedown= function () {
oscillator = context.createOscillator(),  // Creates the oscillator 
oscillator.type = 2;                      // 4 oscillator types    // Pitch
oscillator.connect(context.destination);  // Connects it to output
oscillator.noteOn(0); 
document.getElementById('oscPitch').addEventListener('change', function() {
oscillator.frequency.value = this.value;
});  
};

// If you remove the mouse up event below and change the pitch slider it works fine. But I want to have the pitch slider retain it's state before & after the mouse up event. Itried storing the getElementId of the slider element to a variable and playing with it but I couldn't chisel it out.

pad2.onmouseup = function ()    {  
oscillator.disconnect(); 

};

</script> 
```

编辑。我对此有点接近：

```
<input id="oscPitch" type="range" min="5" max="500" step="1" value="90"/>
<p>Pitch</p>

<script>

context = new webkitAudioContext();         
var pad2 = document.getElementById("pad2");

var pitchState = document.getElementById('oscPitch').value;

pad2.onmousedown= function () {
oscillator = context.createOscillator(),  // Creates the oscillator 
oscillator.type = 2;  
oscillator.frequency.value = pitchState;                   
oscillator.connect(context.destination);  // Connects it to output
oscillator.noteOn(0); 

};

pad2.onmouseup = function ()    {  
oscillator.disconnect(); 

};

</script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:18:27.760

知道了。

```
<input id="oscPitch" type="range" min="5" max="500" step="1" value="90"/>
<p>Pitch</p>

<script>

context = new webkitAudioContext();         
var pad2 = document.getElementById("pad2");

pad2.onmousedown= function () {
var pitchState = document.getElementById('oscPitch').value;
oscillator = context.createOscillator(),  // Creates the oscillator 
oscillator.type = 2;  
oscillator.frequency.value = pitchState;                   
oscillator.connect(context.destination);  // Connects it to output
oscillator.noteOn(0); 

};

pad2.onmouseup = function ()    {  
oscillator.disconnect(); 

};

</script> 
```

# mongodb - 如何用 morphia 注释复合键上的索引

> ID：14266367
> 
> 赞同：3
> 
> 时间：2013-01-10T20:07:41.140
> 
> 标签：mongodb, morphia, mongodb-java

我正在使用 morphia github 版本 1.2.2。我知道如何在 morphia 实体的一个字段上注释索引，但是有没有办法在两个字段的组合上注释索引。例如，如果我想在字段 a 和 b 上有一个复合索引，那么下面的类的注释是什么。

```
@Entity
public class TestClass
{
    @Property("a")
    private int fieldA;
    @Property("b")
    private int fieldB;
    //how to annotate index of compound key fieldA and fieldB using morphia index annotation?
} 
```

提前致谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T22:46:54.867

```
@Entity
@Indexes(@Index(name = "aAndB", value = "a, b"))
public class TestClass
{
    @Property("a")
    private int fieldA;
    @Property("b")
    private int fieldB;
    //how to annotate index of compound key fieldA and fieldB using morphia index annotation?
} 
```

为索引命名是可选的。您还可以使复合索引唯一。

# sql - 判断一行数据是否已更改的简单方法是什么？

> ID：14266368
> 
> 赞同：1
> 
> 时间：2013-01-10T20:07:43.200
> 
> 标签：sql, sql-server, database, security

如果我有一行数据，例如：

```
1, 2, 3 
```

我可以创建一个校验和值，它是所有列的总和，1 + 2 + 3 = 6。我们可以将此值与第 4 列中的行一起存储：

```
1, 2, 3, 6 
```

然后我可以编写一个程序来检查列中的任何值是否意外更改，如果列的总和与校验和值不匹配。

现在，我想更进一步。假设我有一个值表，任何人都可以读/写访问，其中最后一列数据是前面所述的前列的总和。

```
1, 2, 3, 6 
```

假设有人想偷偷摸摸并更改第三列中的值

```
1, 2, 9, 6 
```

校验和很容易重现，所以鬼鬼祟祟的人只需将校验和值更改为 1 + 2 + 9 = 12，这样该行就不会被篡改。

```
1, 2, 9, 12 
```

现在我的问题是，我怎样才能制作一个更复杂的校验和值，这样一个鬼鬼祟祟的人就无法在不使校验和不再有效的情况下进行这种类型的更改？也许我可以创建一个黑盒 exe，给定行的前三个值可以给出一个更复杂的校验和，例如：

```
a^2 + b^2 + c^2 
```

但是，虽然这个逻辑对于狡猾的用户来说是未知的，但他/她仍然可以将这些值输入到黑盒 exe 中并得到一个有效的校验和。

关于如何确保表中的所有行都未被篡改的任何想法？我试图避免的方法是每次使用我正在创建的程序对其进行合法修改时保存表的副本。这是可能的，但似乎是一个非常不雅的解决方案。必须有更好的方法，对吧？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:10:04.117

使用基本数学你的校验和是无效的：

```
a^2 +b^2 +c^2  

a=0,b=0,c=2  = checksum 4
a=2,b=0,c=0  = checksum 4 
```

如果您想为用户提供一组“只读”数据，请考虑使用物化视图。物化视图将提前计算计算，即您的有效数据并将其提供给用户，而您的程序可以在后台进行修改。

此外，这就是特权存在的原因，如果您仅提供无法修改数据库的帐户（例如只读访问），则可以减轻有人篡改数据的问题。此外，您不能完全阻止恶意用户篡改数据，只能让他们跳过几个圈，希望他们暂时感到无聊/被阻止。

安全没有灵丹妙药，您可以做的是使用包含以下功能的深度防御思维：

> 广泛的日志记录、
> 职责划分、
> 工作轮换、
> 补丁管理、
> 日志审计（与日志记录一起使用，但实际上必须有人阅读它们）、
> 实施 HIPS 系统（主机入侵防御系统）、
> 拒绝与数据库的外部连接

该列表可以相当广泛。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:44:52.070

您似乎在问，“我怎样才能给一个程序一组不同的安全权限给运行它的用户？” 这样做的方法是确保程序在与用户不同的安全上下文中运行。执行此操作的方法因平台而异。

如果您有多台机器，那么运行客户端服务器架构会有所帮助。您通过服务器公开受控 API，它具有数据库的安全凭证。那么您的用户就不能提出任意请求。

如果您是客户端计算机的管理员，而用户不是，那么您可以让单独的进程执行类似的操作。例如，unix 中的守护进程。我认为 Windows 中的 DCOM 可以让你做这样的事情。

另一种方法是通过存储过程公开您的 API，并且只授予对这些的访问权限，而不是直接访问表。

控制对有限 API 的访问可能还不够。例如，考虑一个存储游戏中高分的表格。`ClaimHighScore`如果用户可以输入任意值，则只能通过 API 访问它并不重要。游戏中的解决方案通常很复杂。我听说的唯一可行的方法是根据给出初始游戏状态的种子值定义 API，然后是一组带有时间戳的输入。然后服务器必须基本上模拟游戏来验证分数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T22:20:15.687

用户不应拥有对表的无限制写访问权限。更好的是为常见的 CRUD 操作创建存储过程。这将让您控制他们可以修改哪些字段，并且如果您坚持可以更新`CRC()`校验和或其他验证。

这将是一个大项目，所以现在可能不实用 - 但这是应该做的事情。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T22:53:00.177

尽管您的问题是基于对数据库的恶意条目，但使用[**MOD11**](http://www.pgrocer.net/Cis51/mod11.html)可以找到不准确或放错位置的值。

以下 MySQL 语句和[**SQLfiddle**](http://sqlfiddle.com/#!2/8acad/4)说明了这一点

```
SELECT id, col1, col2, col3, col4, checknum,
9 - MOD(((col1*5)+(col2*4)+(col3*3)+(col4*2) ),9) 
AS Test FROM  `modtest` HAVING checknum =Test 
```

# perl - 使用文件附加程序的 Log4perl 奇怪的错误

> ID：14266370
> 
> 赞同：0
> 
> 时间：2013-01-10T20:07:57.850
> 
> 标签：perl, logging, log4perl, fileappender

我正在尝试向 Log4perl 记录器添加和删除一个简单的文件附加程序，但是会生成警告并且没有打印任何内容。这是我的代码：

```
use strict;
use warnings;
use Log::Log4perl qw(:easy);
Log::Log4perl->easy_init($DEBUG);
use Log::Log4perl::Appender::File;

my $app = Log::Log4perl::Appender::File->new(
    filename  => "C:/users/my name/Desktop/someFile.txt",
    mode      => 'clobber',
    utf8      => 1,
);
# print "appender name is " . $app->name();
my $logger = get_logger();
$logger->add_appender($app);
INFO('info');
$logger->remove_appender($app->name); 
```

文件“someFile.txt”已创建但为空。生成的警告是：

```
Odd number of elements in hash assignment at C:/strawberry/perl/site/lib/Log/Log4perl/Appender/File.pm line 223.
Use of uninitialized value in print at C:/strawberry/perl/site/lib/Log/Log4perl/Appender/File.pm line 245. 
```

带有时间戳的“信息”也会打印到命令行。谁能看到我犯了什么错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:30:32.903

你确定一个appender是你想要的吗？如果是这样，那么您不应该`Log::Log4perl::Appender::File`直接创建一个新对象 - 您创建一个`Log::Log4perl::Appender`对象并将您想要的 appender 类型的类作为第一个参数传递给构造函数。像这样：

```
my $app = Log::Log4perl::Appender->new(
    'Log::Log4perl::Appender::File',
    filename  => 'C:/users/my name/Desktop/someFile.txt',
    mode      => 'clobber',
    utf8      => 1,
); 
```

# mercurial - 没有 SSH 的共享主机上的 Mercurial

> ID：14266372
> 
> 赞同：0
> 
> 时间：2013-01-10T20:08:08.563
> 
> 标签：mercurial, hgsubversion

我试图让 mercurial 在没有 SSH 访问的共享主机上工作。

我查看了[https://www.mercurial-scm.org/wiki/PublishingRepositories](https://www.mercurial-scm.org/wiki/PublishingRepositories)并看到了将我的存储库发布到网络的不同方法，但由于某些依赖关系而无法使用任何方法。

例如，我查看了 hgweb，它说

“首先，您需要有一个可以访问 mercurial 包的 Python 安装。通过运行 python 并键入以下内容来验证这一点：

进口汞”

我以前没有使用过python，因此不确定在哪里运行“import mercurial”命令。我猜测是通过我无权访问的 ssh。

还遇到了 SCM-Manager，该快速指南只讨论了下载源代码并将内容提取到您的服务器，SCM 管理器依赖于 java，也不知道如何让它在 web 上工作。

hgweb、SCM-Manager 和 RhodeCode 中的哪一个可以在没有 ssh 访问的情况下进行设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:13:42.570

简短回答：**无**

但是您至少可以尝试，如果您运行 Java 应用程序服务器（Tomcat、GlassFish 等），将 SCM-manager 作为 Web 应用程序运行（*.war）

# node.js - 在执行其他函数之前返回的节点 js 函数

> ID：14266373
> 
> 赞同：0
> 
> 时间：2013-01-10T20:08:11.193
> 
> 标签：node.js, return

```
function getUsernameAssociatedWithToken (token) {

    console.log('\n\t\tgetUsernameAssociatedWithToken');
    console.log("\t\t"+token);
    var userReturn = "";

    queryAsync(returnVal);

    function queryAsync(callback){
        connection.query("SELECT * FROM users WHERE token = '"+token+"'", function (error, results, fields) {

            if (error) {
                console.log(error);
                 callback(null);
            }

            if (results.length  > 0) {

                userReturn = results[0].user;
                callback(userReturn);

            } else {

                callback(null);
            }

        });
    };

    function returnVal(str){

    userReturn = str;
    console.log('vaaaaal');
    console.log(userReturn);

    }
    return userReturn;

} 
```

在执行查询函数之前调用最后一个“return”（它不应该）。我将如何使用回调来做到这一点？

我试过这个，但这也失败了：

```
function getUsernameAssociatedWithToken (token) {

    console.log('\n\t\tgetUsernameAssociatedWithToken');
    console.log("\t\t"+token);
    var userReturn = "";

    function queryAsync(){
        connection.query("SELECT * FROM users WHERE token = '"+token+"'", function (error, results, fields) {

            if (error) {
                console.log(error);
                 return null;
            }

            if (results.length  > 0) {

                userReturn = results[0].user;
               return userReturn;

            } else {

                return null;
            }

        });
    };

return (queryAsync());

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:19:46.147

您不能直接从函数返回异步调用的结果，因为（如您所见）函数在异步调用完成之前返回。相反，您的函数必须支持一个回调参数，当异步调用完成时，它将调用该参数以将结果返回给调用者。

```
function getUsernameAssociatedWithToken (token, callback) {
    ...
    queryAsync(callback);
} 
```

# mysql - 相同的查询但有两个结果？

> ID：14266374
> 
> 赞同：1
> 
> 时间：2013-01-10T20:08:11.807
> 
> 标签：mysql

我有一个 mysql 查询，列出了标题、艺术家的数量

```
SELECT count(Key) AS Ocount, artist, title,domain, DATE_FORMAT(`FE`,'%m') AS eMonth
FROM gr 
WHERE domain = 'site.com'
GROUP BY title
ORDER BY eMonth,Ocount Desc 
```

第一个结果是

```
'195', 'akon', 'beautiful', 'site.com', '01'
'20', 'ludacris', 'intro', 'site.com', '01'
'11', 'don omar', 'taboo', 'site.com', '01' 
```

运行相同的查询

```
SELECT count(Key) AS Ocount, artist, title,domain, DATE_FORMAT(`FE`,'%m') AS eMonth
FROM gr 
WHERE domain = 'site.com'
AND artist = 'akon'
AND title = 'beautiful' 
```

结果

```
'100', 'akon', 'beautiful', 'site.com', '01' 
```

这怎么可能？无论我如何计算，它不应该给出相同的结果吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:21:42.027

如果你想要每个标题艺术家组合的计数，你会想要使用

```
GROUP BY artist, title 
```

这将`count(id)`表示该表中存在艺术家+标题组合的实例数。您可以在计算`WHERE`之前使用该子句过滤结果`COUNT()`。

您可以通过从一小部分数据开始并检查结果是否准确来检查结果`COUNT()`是否准确。

仅按艺术家分组将产生与该艺术家匹配的行数，无论标题如何。

# php - Str_replace 不工作

> ID：14266380
> 
> 赞同：0
> 
> 时间：2013-01-10T20:08:40.170
> 
> 标签：php, string, replace

我在数据库中有一个 PHP 片段，我通过查询获取，之后我在其上应用 str_replace 以替换特定区域。

```
str_replace("****",$res->id,$my_file); 
```

但它并没有改变字符串。我不知道如何调试场景

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:11:16.017

您需要将返回的字符串分配给您的变量。PHP 的所有`*_replace`函数都没有就地修改原始字符串。

```
$my_file = str_replace("****", $res->id, $my_file); 
```

# html - 如何确保我的绝对定位 div 足够高以符合我的粘性页脚？

> ID：14266381
> 
> 赞同：2
> 
> 时间：2013-01-10T20:08:39.967
> 
> 标签：html, css, css-position, sticky-footer

我的页面有主要内容、粘性页脚和绝对定位的右侧面板。我通常从不使用绝对定位，但在这种情况下，当浏览器窗口很薄时，我需要面板与主要内容重叠。目前它看起来是正确的，直到我将窗口垂直缩小得太远。当内容在分页符下方继续时，绝对定位的 div 不再与页脚相接。我怎样才能确保绝对定位的 div 总是足够长以满足页脚所以没有间隙？

这是HTML：

```
<body>
    <div id="abs"></div>
    <div class="wrapper">
        <p>Website content here.</p>
        <div class="push"></div>
    </div>
    <div class="footer">
    </div>
</body> 
```

和 CSS

```
* {
    margin: 0;
}
html, body {
    height: 100%;
}
.wrapper {
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -4em;
}
.footer, .push {
    height: 4em;
}   
.footer {
    background-color:#333;
    position:relative;
    z-index:40;
}   
#abs {
    position:absolute;
    right:0;
    top:0;
    z-index: 20;
    background-color:#579ECF;
    width:100px;
    min-height: 100%;
}
p {
    width:700px;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:14:49.287

你绝对定位`abs`在body标签中。由于我不会进入正文的原因是窗口的高度，而不是内容的高度。因此，当您将其设置为 100% 时，它仅与屏幕一样高。

而是将`abs`div 移动到主要内容 div 中，将主要内容设置为`relative`，并指定`top: 0`和`bottom: 0`伸展`abs`。

[http://jsfiddle.net/3jegZ/](http://jsfiddle.net/3jegZ/)

```
.wrapper {
    position: relative;
    min-height: 100%;
    height: auto !important;
    height: 100%;
    margin: 0 auto -4em;
}  
#abs {
    position:absolute;
    right:0;
    top:0;
    bottom:0;
    z-index: 20;
    background-color:#579ECF;
    width:100px;
} 
```

# visual-studio-2010 - 在 VS2010 中使用 MKL for rng 与 Intel TBB 进行并行仿真

> ID：14266384
> 
> 赞同：1
> 
> 时间：2013-01-10T20:08:48.010
> 
> 标签：visual-studio-2010, random, tbb, montecarlo

我需要在安装了 Intel TBB 和 MKL 且只有 1GB 内存的 VS2010 中使用 C++ 进行蒙特卡罗模拟来找到导数的默认概率。

令 S(t) 表示衍生品在时间 t 的价格。当前价格为 S(0) = 100。

为简单起见，导数定义为（实数导数更复杂）： 概率为 99% S(t+1) = S(t) * exp(X)，其中 X ~ N(mu=0, sigma =0.01) 导数以 1% 的概率下降到 S(t+1) = S(t) * 0.4

如果衍生品在 0 < t <=250 的某处低于 10，则会发生以下情况：ha 概率为 80%，S(t) 处的衍生品价格设置为 1.5 * S(t) 或概率为 10%我们将有一个默认值。

假设我需要对这个导数进行至少 1000 万次模拟并计算所有损失。那么我模拟的默认概率是#defaults / 10mn。序列代码不知何故看起来像：

```
for j = 1 to #simulation/{
    for t = 1 to 250{
        generate S(t+1)
        check if S(t+1) defaults
    }
} 
```

如何并行化代码？随机数生成的最佳策略是什么？我无法先验生成双精度类型的随机数，因为 10mn * 250 * 2（至少）= 500mn 随机数 * 8Byte = 4GB。

将模拟数量划分为 10 * 处理器数量的块是个好主意吗？

```
VSLStreamStatePtr stream[10*#processors];
for i = 1 to 10*#processor{
    vslNewStream( &stream[i], VSL_BRNG_MT2203+i, seed );
}

tbb_parallel_for i = 1 to 10*#processors{
    use stream[i]  for random number generation
    generate    10mn / (10*#processor) * 250     random numbers ~ N(0, 0.01) and store them in a vector.
    generate    10mn / (10*#processor) * 250     random numbers ~ Bernoulli(0.01) and store them in a vector.
    generate    10mn / (10*#processor) * 250     random numbers ~ Bernoulli(0.01) and store them in a vector.
    for j = 1 to #simulation/(10*#processors){
        use 
        for t = 1 to 250{
            generate S(t+1) using the vectors filled with random numbers
            check if S(t+1) defaults
        }
    }
} 
```

任何帮助将不胜感激......马特

# azure - 如何将 MeteorJS 应用程序部署到 Windows Azure？

> ID：14266386
> 
> 赞同：7
> 
> 时间：2013-01-10T20:08:51.393
> 
> 标签：azure, meteor

如何将生产 MeteorJS 应用程序部署到 Windows Azure？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-04-28T12:12:24.450

是的。见[http://www.meteorpedia.com/read/Deploying_to_a_PaaS](http://www.meteorpedia.com/read/Deploying_to_a_PaaS)

> 在大多数情况下，这就像使用“meteor bundle”、 [demeteorizer](http://blog.modulus.io/demeteorizer)一样简单，然后使用 PaaS 提供商的[CLI](http://azure.microsoft.com/en-us/documentation/articles/xplat-cli/) [部署工具](http://blog.amitapple.com/post/38417491924/azurewebsitecustomdeploymentpart1/)上传生成的文件。
> 
> Demeteorizer 通过创建更类似于标准外观的 Node.js 应用程序来包装和扩展 Meteor 的 bundle 命令，并带有用于依赖管理的 package.json 文件。

```
$ cd /my/meteor/app
$ demeteorizer -o /my/node/app
$ cd /my/node/app
$ npm install
$ export MONGO_URL='mongodb://user:password@host:port/databasename?autoReconnect=true&connectTimeout=60000'
$ export PORT=8080
$ forever start main.js 
```

[Forever](http://blog.nodejitsu.com/keep-a-nodejs-server-up-with-forever/)使您的应用程序在断开连接或崩溃后保持运行，[但除非您手动添加启动项，否则不会重新启动](https://stackoverflow.com/questions/13385029/automatically-start-forever-node-on-system-restart)。

使用[Meteor Up](https://github.com/arunoda/meteor-up#installation)代替整个部署[要容易得多。](https://gentlenode.com/journal/meteor-19-deploying-your-applications-in-a-snap-with-meteor-up-mup/41)或者可能[是 mups](https://www.npmjs.com/package/mups)，尽管它甚至没有更新的文档。

在 Azure Web 应用程序中运行 Meteor 应用程序：

```
Azure Web App 
Python 2.7
Websockets ON (optional)
WEBSITE_NODE_DEFAULT_VERSION 0.10.32 (default)
ROOT_URL http://webapp.azurewebsites.net
MONGO_URL mongodb://username:password@instance.mongolab.com:36648/dbname (For advanced apps. Request log should say if you need it.)

Dev Machine
Install Visual Studio Community 2015
Install Node 0.12.6
Install Meteor MSI

app> demeteorizer -o ..\app-dem
app-dem\programs\server\packages\webapp.js change .PORT line to "var localPort = process.env.PORT"
app-dem\package.json change "node": "0.10.36" to "node": "0.12.6"
app-dem> npm install 
app-dem> git init
app-dem> git add -A .
app-dem> git commit -m "version 1.0 demeteorized Meteor + tweaks"
app-dem> git remote add azure https://username@webapp-slot.scm.azurewebsites.net:443/webapp.git
app-dem> git config http.postBuffer 52428800
app-dem> git push azure master 
```

而不是`demeteorizer -o`，也许您可`meteor build`​​以在输出根目录中使用并创建一个 package.json ：

```
{
    "name": "App name",
    "version": "0.0.1",
    "main": "main.js",
    "scripts": {
        "start": "node main.js"
    },
    "engines": {
        "node": "0.12.6"
    }
} 
```

如果 bcrypt 无法编译，请确保使用更新的版本：

```
 "dependencies": {
        "bcrypt": "https://registry.npmjs.org/bcrypt/-/bcrypt-0.8.4.tgz"
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-08-07T17:50:13.367

在开始之前，请确保您已经安装了 32 位版本的 nodejs 并在您的 Windows 构建机器上运行了“npm -g install fiber”。azure 上的默认 nodejs 仅运行 32 位！

注意：如果您使用例如在 PhantomJS 上中继的可爬虫包，这将不起作用。PhantomJS 不能在 azure 上的 webapp 中执行？

1.  在您的项目“meteor build ..\buildOut”中并提取位于“..\buildOut”中的 .tar.gz 文件。
2.  在“..\buildOut\bundle”中放置/创建一个“package.json”，其中包含：

```
{
    "name": "AppName",
    "version": "0.0.1",
    "main": "main.js",
    "scripts": {
        "start": "node main.js"
    },
    "engines": {
        "node": "0.12.6"
    }
} 
```

注意：确保“名称”不包含空格，Azure 上的部署将失败。

3.  在您最喜欢的 shell 上，转到“..\buildOut\bundle\programs\server”并运行“npm install”。这将预先下载所有需求并构建它们。
4.  现在打开文件“..\buildOut\bundle\programs\server\packages\webapp.js”并搜索“process.env.PORT”。

它看起来像这样：

```
var localPort = parseInt(process.env.PORT) || 0; 
```

将此行更改为：

```
var localPort = process.env.PORT || 0; 
```

这是必需的，因此您的流星项目一旦在节点中运行就可以接受命名套接字。函数“parseInt”不会让字符串通过，命名套接字是位于 webapp 环境中的字符串。我这样做是有原因的，这里有一个警告！现在保存这个更改，我们几乎完成了......

5.  解决 bcrypt 问题：下载此文件并将其提取到某个位置：[https](https://registry.npmjs.org/bcrypt/-/bcrypt-0.8.4.tgz) ://registry.npmjs.org/bcrypt/-/bcrypt-0.8.4.tgz 提取它。

现在替换位于：“..\buildOut\bundle\programs\server\npm\npm-bcrypt\node_modules\bcrypt*”的文件

目录和文件位于某处：“.\bcrypt-0.8.4\package*”

现在进入目录“..\buildOut\bundle\programs\server\npm\npm-bcrypt\node_modules\bcrypt\”中的shell，并确保删除“node_modules”目录。如果 node_modules 目录没有被删除，npm 将不会出于某种原因构建包。

在外壳“npm install”上运行。

确保在门户中为您的 webapp 设置“环境”变量：“MONGO_URL”和“ROOT_URL”。

如果一切正常，您可以将您的应用程序部署到 web 应用程序部署槽上的 git 存储库。转到“..\buildOut\bundle”并将那里的文件提交到部署槽的存储库。这将在部署槽上进行部署并创建所需的 iis 配置文件。

现在稍等片刻，您的应用应该会在一段时间后触发...您的应用应该正在运行，您可以在 *.azuresites.net 上访问它

感谢这一切使这成为可能。

# javascript - 页面加载时执行的 JQuery 事件处理程序

> ID：14266388
> 
> 赞同：0
> 
> 时间：2013-01-10T20:09:02.663
> 
> 标签：javascript, jquery, html

我的页面上有一些 html，在我的脑海中我有`$("#someelement").click(alert("click"));`. #someelement 是否存在，当我出于某种原因加载页面时，警报会消失。但是，当我有`$("#someelement").click(function(){alert("click")});`. 这是为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:13:15.353

`alert("foo")`总是会立即提醒 foo，它不会返回可以作为事件处理程序传递的函数。您需要将一个函数传递给 jQuery 事件绑定方法。

```
$("#someelement").click(function(){
    alert("click");
}); 
```

此外，如果此代码在 中`<head></head>`，则需要将其包装在`$(document).ready()`.

```
$(document).ready(function(){
    $("#someelement").click(function(){
        alert("click");
    });
}); 
```

* * *

`alert`是在`window`对象上定义的方法，例如`window.alert`. 它需要一个字符串参数，并且它必须是窗口对象的成员。放置`("string")`在 之后`alert`，例如`alert("string")`将执行该功能，导致弹出窗口带有`"string"`。当您将`alert("string")`作为参数放置到函数时会发生同样的事情，当所述代码运行时会发生弹出窗口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:15:43.947

试试这个：

```
$(document).ready(function() {
  $("#someelement").click(function(){alert("click")});
}); 
```

这是一个工作[小提琴](http://jsfiddle.net/HwfZF/)

# javascript - 除非有活动，否则 x 分钟后关闭弹出窗口

> ID：14266389
> 
> 赞同：2
> 
> 时间：2013-01-10T20:09:06.103
> 
> 标签：javascript, jquery, flash, popup

我有一个链接，点击后会打开一个新窗口，使用：

```
var win = window.open(url,....); 
```

此窗口包含一个 Flash 游戏。

我想在 20 分钟不活动后关闭窗口。

我知道我可以使用以下方法创建超时：

```
var t = setTimeout("dosomething()", 5000) 
```

但是我如何才能确定弹出窗口上是否有活动？

**如果用户与 flash 交互，我还能通过 dom 事件获取此信息吗？**

我想避免他们在玩的时候关窗的情况:)

这是在基于 IE 的环境中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:22:26.627

如何为 、 和 事件添加监听事件`mousemove`并`keypress`在`click`每次事件发生时清除计时器。

```
var t = setTimeout(closeWindow, 5000);
$(document).on('mousemove keypress click', function(){
   clearTimeout(t);
   t = setTimeout(closeWindow, 5000); 
});

function closeWindow(){
   window.close();
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:16:53.117

```
theInterval = 0;    
function doSomething(){
    do something;
}

function ScheduleDoSomething(){
    theInterval = setInterval(function () {
        doSomething();}, timeToClose);
}

jQuery(document).keydown(function (e) {
    clearInterval(theInterval);scheduleDoSomething();
}); 
```

我希望这有帮助。

# mod-rewrite - ModRewrite - 如何为 SEO 配置 mod_rewrite 的 .htaccess

> ID：14266393
> 
> 赞同：1
> 
> 时间：2013-01-10T20:09:12.573
> 
> 标签：mod-rewrite, seo

我正在尝试对我的电子商务网站进行一些改进，以获得更好的搜索引擎优化。更重要的事情之一是将产品设置为不使用旧的：

/detail.php?pid=367

取而代之的是，我们设置了 8 个顶级类别，在 8 个顶级猫的每一个之下有 3 个子类别。

例如，其中一个类别看起来像这样L

/安全柜流体处理/流体桶车/

现在我想做的是在这些类别下为每个产品创建文件夹。如：

/安全柜流体处理/流体桶推车/Lubrigard 处理推车/

我的想法可能是最好的方法是在最后包含产品 ID，所以它是这样的：

/安全柜流体处理/流体桶车/Lubrigard-Handling-Cart/856

这有意义吗？在这种情况下，我会在 .htaccess 中放入什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:54:48.737

你可以有任何 URL 结构，只要模式是在 ID 中找到的，而不是在 URL 结构中，这是正常的方法。

在您的问题中，模式可能是 ID 是数字的事实，因此可以从任何包含它的 URL 中捕获它，而不管它的结构如何。例如：

`http://example.com/cat1/cat2/ID/cat3`或者

`http://example.com/cat2/ID/cat3/cat1`

对于在任何位置捕获数字字符串的规则没有区别，例如：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI}  /([\d]+)/? 
RewriteRule .*  detail.php?pid=%1  [L,QSA] 
```

它会将传入 URL 中的 ID 静默传递给脚本，如下所示：

`http://example.com/detail.php?pid=ID`

当然，URL 中的 ID 之前不能有任何其他数字字符串。

但是，如果您仍然希望将 ID 固定在 URL 中的最后一个位置，只需将上面的规则集替换为这个：

```
RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} .*/([0-9]+)/?$
RewriteRule .*  detail.php?pid=%1  [L,QSA] 
```

# c++ - 带有浮点参数的 C++ 模板

> ID：14266394
> 
> 赞同：3
> 
> 时间：2013-01-10T20:09:18.000
> 
> 标签：c++, templates

> **可能重复：**
> [C++：为什么我不能使用浮点值作为模板参数？](https://stackoverflow.com/questions/2183087/c-why-cant-i-use-float-value-as-a-template-parameter)

我有这堂课：

```
template<typename ValueType, ValueType DefaultValue>
class SomeClass
{
    public:
        SomeClass() : m_value(DefaultValue){}

        ValueType m_value;
}; 
```

我想像这样使用它：

```
SomeClass<int, 1> intObj; //ok
SomeClass<float, 1.f> floatObj; //error: 'float' : illegal type for non-type template parameter 'DefaultValue' 
```

你能解释一下为什么我在使用时会出现这个错误`float`吗？

我想使用类似的东西来表示 RGBA 颜色，并使用不同颜色表示的默认值初始化通道（例如白色）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:11:45.283

该语言不允许使用浮点类型作为非类型模板参数。有关广泛的讨论，请参阅[为什么我不能使用浮点值作为模板参数？](https://stackoverflow.com/questions/2183087/c-why-cant-i-use-float-value-as-a-template-parameter)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T20:12:07.293

§ 14.1/7 (C++11 N3485) 明确禁止这样做：

> 不应将非类型模板参数声明为具有浮点、类或 void 类型。[ 例子：

```
template<double d> class X; // error  
template<double* pd> class Y; // OK  
template<double& rd> class Z; // OK 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:11:37.693

不幸的是，C++ 不支持浮点非类型模板参数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:11:39.977

您会收到该错误，因为*非类型模板参数*不能是 type `float`。它们可能只是*整数*、*枚举*、*成员指针*或*地址*。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T20:12:54.157

这很简单：非类型模板参数必须是整数类型或指针类型的编译时常量，即 bool、枚举、指针、指向成员的指针、long、int、short、char。当前标准中不允许使用浮点参数。

# html - h:inputTextArea 自动滚动到正在编辑的行的底部

> ID：14266401
> 
> 赞同：0
> 
> 时间：2013-01-10T20:09:37.860
> 
> 标签：html, jsf

我已经定义了一个 inputTextArea 如下：

```
<s:div id="editor">
<h:inputTextarea id="mytext"   styleClass="editorTextInput" value="#     {algorithm.script}"/>
</s:div> 
```

内容比编辑器大，所以滚动条会自动出现。

问题（这可能是我不想要的功能）是每次按下键来编辑某些内容（更改单词/字符或添加单词/字符）时，都会自动触发滚动，以便该行已编辑是 inputTextArea 中的最后一个可见行。

我没有在 div 或 inputTextArea 上定义任何脚本或附加任何事件。

我试图附加什么都不做但也不起作用的事件

```
<s:div id="editor">
<h:inputTextarea id="mytext"   styleClass="editorTextInput" onkeydown="doNothing()" onkeypress="doNothing()" onkeyup="doNothing()"value="#     {algorithm.script}"/>
</s:div> 
```

谢谢

# facebook-insights - 内部推荐来源表中的“提醒”、“other_multiline”、“appcenter_request”是什么意思？

> ID：14266404
> 
> 赞同：0
> 
> 时间：2013-01-10T20:09:45.717
> 
> 标签：facebook-insights, referrals

我正在 Facebook 见解中分析我的应用程序的内部推荐来源表，但我不知道以下项目是什么：

1.  提醒
2.  other_multiline
3.  appcenter_request

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T22:23:18.667

1.  提醒 = 在动态消息右侧栏的顶部，我们将显示常用应用程序的提醒。这些出现在生日提醒、戳和其他通知附近。来自此处的点击将附加提醒 fb_source 参数。

2.  other_multiline = 当用户通过开放式图形多线故事进入您的应用程序时发现。目前，这个 fb_source 参数可以在时间线、股票代码和新闻源的故事中找到。

3.  appcenter_request = 当用户从 App Center 中单击请求时，我们将 fb_source 值设置为 appcenter_request。

来源[https://developers.facebook.com/docs/fb_source](https://developers.facebook.com/docs/fb_source)

# php - pg_connect 或 PDO

> ID：14266408
> 
> 赞同：3
> 
> 时间：2013-01-10T20:10:01.557
> 
> 标签：php, sql, postgresql

我的第一个 PHP 和 postgreSQL 项目，我在 MSSQL 和 ASP 方面有很好的经验。我使用 pg_connect 和 PDO 运行测试连接，一切正常，使用 3000 行结果集进行一些测试，我遇到 pg_connect 的速度至少比 PDO 快 20%。另一方面，我看到大多数人使用 PDO，为什么？在您看来，每种方法的优缺点是什么？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:15:06.057

如果您对面向对象编程感到满意，我会推荐 PDO。对于大多数具有合理数量的数据库交互的项目，您可能希望为您的 *_connect 函数使用包装类。PDO 消除了这种需求，因为您已经在使用对象。

此外，PDO 为准备好的语句提供了方便的方法，这是一种插入/更新数据的安全方法。

# math - 为什么机器学习不能识别素数？

> ID：14266409
> 
> 赞同：5
> 
> 时间：2013-01-10T20:10:02.213
> 
> 标签：math, machine-learning, primes

**编辑**：我将其移至 cstheory.stackexchange.com

我想要对输入的整数序列进行二元决策。对于序列中给定的 n，无论它是否为素数。不要使用 AKS，不要使用 Miller Rabin，不要使用试除法，甚至不要硬编码，因为最后一位数字必须是 1、3、7、9 并且必须与 1 或 5 一致模 6。

只使用机器学习。

我不确定，但我评估“普遍共识”是/将是机器学习技术（神经网络、SVM、二元分类器、聚类、贝叶斯推理等）将无法解决这个问题？

人们怎么想？

好的，其次，如果我们有一些带有一些有用信息的整数的向量表示（未知），是否存在任何主要的原则反对机器学习能够将 n 分类为素数或复合数，因为我们可以“选择正确的功能”可以这么说？

让我们忽略向量包含 n 的因式分解的简单情况。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T00:26:31.337

机器学习并不是万能的。机器学习，顾名思义，就是从数据中学习。问题是要学习一些东西，我们需要数据中的一种模式，我们可以教算法学习。

根据定义：素数是大于 1 的自然数，除了 1 和它自身之外没有正除数。

这里的基本困难是素数序列

2, 3, 5, 7, 11, 13, 17, 19, 23, . . .

行为“不可预测”或“随机”，我们没有第 n 个素数的（有用的）精确公式！

即使你尝试训练一个算法，你也会得到一些近似解决方案的东西。您无法选择足以预测解决方案的功能。

比方说，困难的方法是用这些特征训练你的模型：

*   任何以偶数结尾的数（2 除外）都不是质数。
*   所有数字相加等于 3、6、9 或其除数的任何数字都不是质数。
*   任何以 5 结尾的数字都不是质数。（5个除外）
*   任何具有相同数字的数字都不是质数。（除非以 1 结尾）

您最终会得到所有素数以 1、3、7 或 9 结尾，但并非所有素数都是素数。

因此，当我们想要一个精确的解决方案并且已经有一个精确的方法来计算它时，不需要找到一个算法来近似某些东西。

# time - 以下算法的 bigOh 或运行时间是多少

> ID：14266412
> 
> 赞同：1
> 
> 时间：2013-01-10T20:10:04.417
> 
> 标签：time, big-o, time-complexity

以下算法在 bigO 中的运行时间是多少？

```
for(int i=1;i<=n;i++){
    for(int j=i;j<=n;j++){
        for(int k=j; k<=n;k++){
            for(int l=k; l<=n;l++){

                ...

            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T20:12:51.610

这个算法似乎是n^4。当然，从理论角度来看（没有任何编译器考虑）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:13:27.397

N^4。小数部分不算。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-04-05T18:44:22.560

这种依赖循环集合的公式可以推断如下：

![在此处输入图像描述](../Images/5d66747f47818af5bd359a9168d1bff4.png)

其中**c**（常数）是最内层循环内的操作数，**n**是元素数，**r**是嵌套循环数。

在问题的情况下：

![在此处输入图像描述](../Images/c8b5f1a982d7a4999308c195d73a2c02.png)

![在此处输入图像描述](../Images/9d1468695e4e68270ae4569c5dcecbeb.png)

另一种有效但乏味的方法是使用 Sigma 表示法：

![在此处输入图像描述](../Images/417758a943819e1f26dba532fd1c726f.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T22:03:19.500

O(N^4) 是成本。

每个嵌套都是 N^ 所以本质上是 N * N * N * N = N^4

CS610，算法开发，新泽西理工学院。我的研究生课程实际上派上用场了。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-16T09:38:16.023

我的答案是 O(N^4)……因为有四个“for 循环”……而且很容易判断这个算法的运行时间……谢谢！

# jquery - jQuery 加载对话框 AJAX '完成' 捕获回显结果

> ID：14266414
> 
> 赞同：0
> 
> 时间：2013-01-10T20:10:09.530
> 
> 标签：jquery, ajax, load, jquery-callback

我有一个`load`用来加载对话框的页面。在该对话框中，我有 jQuery 将 ajax 请求发布到 PHP 脚本。这一切都很好。从 PHP 中，我回显出结果并尝试在`done`此加载的对话框的回调中捕获该结果 - 但它不起作用。它更新数据库，但我无法捕捉回声。这适用于我网站的其他地方，但我无法让它在这里工作。我认为这可能与这是来自“加载”对话框的事实有关？任何帮助，将不胜感激。

原始页面上的代码启动加载...

```
$('#edit_cats').click(function() {
   $('#overlay').show();
   $("#loader4").show().center();
   $('#dialogLoad').show().load('../../dialog/categories.php', {'site_user':'<?=$user_id?>','id':'<?=$blog['id']?>'});
}); 
```

加载对话框中的 AJAX 代码

```
$('.cat_input').bind('blur keyup', function(e) {
   if(e.type === 'keyup' && e.keyCode !== 10 && e.keyCode !== 13) return;
   $(this).hide();
   var cat_title = $(this).val();
   var cat_id = $('.cat_selected').attr('id');

   $.ajax({
      type: "POST",
      url: "../../system/process-cat-update.php",
      dataType: "json",
      data: { 'title':cat_title, 'cat_id':cat_id}
   }).done(function(data) {
      $('.cat_selected').find('.cat_title').html(data).show();
   });
}); 
```

PHP 代码

```
<?php 

include ('connect.php');
mysql_query("UPDATE blog SET category='".$_POST['title']."' WHERE id='".$_POST['cat_id']."' ");
echo $_POST['title'];

?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:17:41.070

您没有在响应中发送 json，因此`dataType: "json"`不正确，删除该`dataType`属性应该可以解决您的问题。此外，您没有对输入进行消毒，因此您可以接受 sql 注入。

# sqlite - 是否有任何较小的 SQLite 库支持读取数据库？

> ID：14266421
> 
> 赞同：1
> 
> 时间：2013-01-10T20:10:30.570
> 
> 标签：sqlite

我想构建一个小型应用程序（在 Windows 上），其中一个功能是读取 SQLite 数据库（SELECT 查询）。我只需要从表中选择一些列，不需要更新/插入/删除......

当然，SQLite是一个开源软件，那么我可以很容易地获得源代码。实际上我做到了，但它太大了，因为它支持完整的 API。我只需要一些 API：sqlite3_open、sqlite3_close、sqlite3_get_table、sqlite3_free_table。

我试图将源代码移植到更小的库，但是数据结构和 API 太复杂了……
如果你知道另一个库（更小更简单）或者有人以前做过可以帮助分享一些想法，请告诉我。

谢谢。

# sql - SQL 使用两个表进行查询

> ID：14266426
> 
> 赞同：0
> 
> 时间：2013-01-10T20:10:44.797
> 
> 标签：sql

我正在学习 SQL 一段时间，但我遇到了这个问题。

我为一家存储公司准备了两张桌子。在一张表中，用于整个公司的预订，包括预订编号、日期、产品编号、数量和储藏室。

在一张表中，我有存储设施名称和存储房间来定义房间属于哪个设施

我想在一个特定的存储设施中获得一种特定产品的数量总和

```
SELECT sum(Quantity) from Bookings where ProductNo=8888 and Storage.StorageFacility="Central" 
```

我是否必须对解决方案使用更复杂的查询？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:15:41.060

您的存储设施与该表位于不同的`BOOKINGS`表中（它们通过 相关`STORAGE_ROOM`）。所以你需要[加入](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)这些表：

```
select sum(Quantity)
  from bookings b 
  join storage_facility_details sfd 
    on b.storage_room = sfd.storage_room
 where sfd.storage_facility = 'x'
   and bookings.productno='8888' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:18:59.747

SQL 的语法在不同的数据库系统上可能略有不同。通常引号 ( `"`) 用于指代表格和类似的对象。使用单引号 ( `'`) 给出值。此外，您引用列的所有表都需要出现在`FROM`. 如果列`quantity`和`storagefacility`出现在两个表中，则需要完全质量名称。

此外，您需要在列上连接两个表，因此`productno`您的表中也必须存在`storage`。

```
SELECT sum(quantity) FROM bookings, storage
   WHERE (bookings.productno = storage.productno)
         AND
         (bookings.productno='8888' AND storage.storagefacility='Central'); 
```

# sql - GROUP BY 表达式（列的一部分）而不是整列

> ID：14266431
> 
> 赞同：0
> 
> 时间：2013-01-10T20:10:54.177
> 
> 标签：sql, sql-server

我正在创建一个查询：我需要获取每年的退货数量。

`ReturnDate`是每个成员的具体日期，即退货的时间。为了得到我正在使用的年份`LEFT(ReturnDate,4)`。

到目前为止一切似乎都还可以，但我需要显示年份、城市和该城市的完整回报数量的列表，例如：

```
YEAR       CITY        QUANTITY
2011       London      300
2011       Stockholm   40
2012       London      250 
```

现在，我没有得到：

```
YEAR       CITY        QUANTITY
2011       London      200
2011       London      100
2011       Stockholm   30
2011       Stockholm   10
2012       London      250 
```

到目前为止，这是我想出的：

```
 SELECT LEFT(ReturnDate,4) AS Year, City, COUNT(ReturnDate) AS Quantity 
 FROM Member
 GROUP BY ReturnDate, City 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:13:45.193

尝试：

```
GROUP BY LEFT(ReturnDate, 4), City 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:15:55.280

或者，您可以尝试使用`DATEPART`：

```
SELECT DATEPART(yyyy, ReturnDate) AS Year, City, COUNT(ReturnDate) AS Quantity 
FROM Member
GROUP BY DATEPART(yyyy, ReturnDate), City 
```

# jenkins - Jenkins security II - 拒绝匿名访问，但允许通过 CLI 访问

> ID：14266434
> 
> 赞同：2
> 
> 时间：2013-01-10T20:11:01.540
> 
> 标签：jenkins, continuous-integration

我之前问过如何让 Jenkins 在这里拒绝匿名读取访问：[Jenkins security - hide all screen unless user is logged in](https://stackoverflow.com/questions/14226681/jenkins-security-hide-all-screens-unless-user-is-logged-in)。该解决方案效果很好，除了它通过 CLI jar 破坏了对 Jenkins 的访问，尽管我们通过与用户关联的 SSH 密钥使用 CLI - 我想访问并不构成“身份验证”。有没有办法让 CLI 具有读取权限，但不让使用前端 UI 的用户？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-20T19:45:30.860

经过更多的实验，这看起来是一个彻底的 Jenkins 错误 - 授予匿名用户管理权限对于通过 cli jar（使用 SSH 密钥）或通过 HTTP（使用用户的 API 令牌）进行访问是必要的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T16:26:53.467

使用 CLI 时，您可以传递`-jnlpCredentials`或`-auth`参数。

通过尝试使用此错误发现它：
`java -jar slave.jar --help`

在您的情况下，您将使用`-auth`参数来指定`username:pass`

# php - 如何使用下面的示例正确设置布局

> ID：14266437
> 
> 赞同：2
> 
> 时间：2013-01-10T20:11:18.977
> 
> 标签：php, html

所以让我们说下面是每个问题的正确和错误答案：

```
Question Number: 1   Correct Answer(s) B     Incorrect Answers A C D
Question Number: 2   Correct Answer(s) A C   Incorrect Answers B D
Question Number: 3   Correct Answer(s) D     Incorrect Answers A B C 
```

下面显示了当前的布局和它的布局方式：

![在此处输入图像描述](../Images/a132343f47942f63adc6a98c0a242b3e.png)

当前输出的代码是这样的：

```
<table border='1' id='penaltytbl'>
<thead>
<tr>
<th class='questionth'>Question No.</th>
<th class='answerth'>Incorrect Answer</th></tr>
</thead>
<tbody>
<?php
$row_span = array_count_values($searchQuestionNo);
$prev_ques = '';
foreach($searchQuestionNo as $key=>$questionNo){

?>

<tr class="questiontd">
    <?php
    if($questionNo != $prev_ques){
    ?>
    <td class="questionnumtd q<?php echo$questionNo?>_qnum" rowspan="<?php echo$row_span[$questionNo]?>">
    <?php echo$questionNo?><input type="hidden" name="numQuestion" value="<?php echo$questionNo?>" />
    </td>
    <?php
    }  
    ?>
<td class="answertd"><?php echo implode(',', $incorrect_ans[$key]);?></td>
</tr>
<?php
$prev_ques = $questionNo;
}
?>
</tbody>
</table> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T04:01:18.727

要将您当前的表结构更改为所需的表结构，您需要修改 -
(1)`rowspan`在每个您的`<td class="questionnumtd">`和
(2) 您如何回显您`<td class="answertd">`的

最简单的是`<td class="answertd">`. 改变

```
 <td class="answertd"><?php echo implode(',', $incorrect_ans[$key]);?></td>
</tr> 
```

到

```
 <?php
    foreach($incorrect_ans[$key] as $answer){ ?>
            <td class="answertd"><?php echo$answer?></td>
           </tr>
    <?php
    } 
```

这`<td class="questionnumtd">` `rowspan`有点困难，因为在您当前的表结构和代码中，您显示`$incorrect_ans[$key]`问题 2 有 2 行。使用`foreach`下面的循环，它`$q_row_span[$i]`根据所有`$incorrect_ans[$key]`

```
$q_counter = 1;// counter for $row_span
$i = key($row_span);  // gets first question number
foreach ($incorrect_ans as $key => $val){
    if($q_counter == 1){
        $q_row_span[$i] = count($val);}
    else{
        $q_row_span[$i] += count($val);}
    if($q_counter >= $row_span[$i]){
        $q_counter = 1;
        $i++;}
    else{
        $q_counter++; }
} 
```

* * *

尝试 -

```
<table border='1' id='penaltytbl'>
<thead>
<tr>
<th class='questionth'>Question No.</th>
<th class='answerth'>Incorrect Answer</th></tr>
</thead>
<tbody>
<?php
$row_span = array_count_values($searchQuestionNo);
    $q_counter = 1;// counter for $row_span
    $i = key($row_span);  // gets first question number
    foreach ($incorrect_ans as $key => $val){
        if($q_counter == 1){
            $q_row_span[$i] = count($val);}
        else{
            $q_row_span[$i] += count($val);}
        if($q_counter >= $row_span[$i]){
            $q_counter = 1;
            $i++;}
        else{
            $q_counter++; }
    }
$prev_ques = '';
foreach($searchQuestionNo as $key=>$questionNo){

?>

<tr class="questiontd">
    <?php
    if($questionNo != $prev_ques){
    ?>
    <td class="questionnumtd q<?php echo$questionNo?>_qnum" rowspan="<?php echo$q_row_span[$questionNo]?>">
    <?php echo$questionNo?><input type="hidden" name="numQuestion" value="<?php echo$questionNo?>" />
    </td>
    <?php
    }  

    foreach($incorrect_ans[$key] as $answer){ ?>
    <td class="answertd"><?php echo$answer?></td>
</tr>
<?php
    }
$prev_ques = $questionNo;
}
?>
</tbody>
</table> 
```

请参阅显示您的原始结构的这个 phpfiddle，以及带有上面代码的新结构。[http://phpfiddle.org/main/code/z8e-74b](http://phpfiddle.org/main/code/z8e-74b)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T05:50:43.263

这正是您希望输出的样子

```
<?php
$incorrect_ans = array(
                   array('A','C','D'),
                   array('B','C','D'),
                   array('A','B','D'),
                   array('A','B','C'));

$searchQuestionNo = array(
                   1,
                   2,
                   2,
                   3);

$ques_ans = array();    //to store incorrect answers against ques no.

$q_occ_count = array_count_values($searchQuestionNo);
foreach($searchQuestionNo as $key => $questionNo)
{
    if ( ! array_key_exists($questionNo, $ques_ans))
    {
        if($q_occ_count[$questionNo] === 1) //if a ques has only one correct ans
        {
            $ques_ans[$questionNo] = $incorrect_ans[$key];  //store the array of incorrect ans against the ques no as key 
        }
        else //if a ques has more than 1 correct ans
        {
            //find the intersection of incorrect_ans arrays for this ques
            $q_keys = array_keys($searchQuestionNo, $questionNo);
            $q_incorrect_ans = $incorrect_ans[$q_keys[0]];
            foreach($q_keys as $q_key) {
                $q_incorrect_ans = array_intersect($q_incorrect_ans, $incorrect_ans[$q_key]);
            }       
            $ques_ans[$questionNo] = $q_incorrect_ans;  //store the array of incorrect ans against the ques no as key
        }
    }
}
var_dump($ques_ans);
?>
<table border='1' id='penaltytbl'>
<thead>
<tr>
<th class='questionth'>Question No.</th>
<th class='answerth'>Incorrect Answer</th></tr>
</thead>
<tbody>
<?php

foreach($ques_ans as $questionNo => $inc_ans)
{
    $q_row_span = count($inc_ans);
    ?>
    <tr class="questiontd">
        <td class="questionnumtd q<?php echo $questionNo?>_qnum" rowspan="<?php echo $q_row_span ?>">
                <?php echo $questionNo?><input type="hidden" name="numQuestion" value="<?php echo $questionNo?>" />
        </td>
        <?php

        foreach ($inc_ans as $ans)
        {
        ?>
            <td class="answertd"><?php echo $ans; ?></td>
        </tr>
        <?php
        }
}
?>
</tbody>
</table> 
```

**[演示](http://phpfiddle.org/main/code/7j1-we2)**

即使您有 3 个正确答案，上面的代码也有效

# java - java中的Httpclient，不使用任何第三方库

> ID：14266445
> 
> 赞同：0
> 
> 时间：2013-01-10T20:11:37.027
> 
> 标签：java, httpclient

我试图在我们不允许使用互联网的工作场所自动化一些事情（并非所有网站都允许使用）。

要求：我有一个表单，它有一个文本框和一个提交按钮，我必须在文本框中输入一些内容并提交表单。我需要解析 HTML 并获取特定文本的响应。页面是用 JSP 编写的

约束：我无权访问第三方库并且必须使用 Java 6。

请把我放在正确的方向。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:12:51.093

[HttpURLConnection](http://docs.oracle.com/javase/1.5.0/docs/api/java/net/HttpURLConnection.html)是 java 的默认设置。您可以考虑使用此 API。此 API 执行 Apache HTTPClient 的大部分功能。[这是有关如何使用 HTTPURLConnection](http://digiassn.blogspot.com/2008/10/java-simple-httpurlconnection-example.html)的简单示例。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:13:19.090

我会使用 Firefox 中的 tamperdata 之类的东西来捕获发送到服务器的 HTTP 请求，然后使用 HTTPUrlConnection（JDK 的一部分）重新创建该请求。

# php - 如何在 Drupal 7 中预填充字段集合字段？

> ID：14266447
> 
> 赞同：1
> 
> 时间：2013-01-10T20:11:40.077
> 
> 标签：php, drupal, drupal-7, drupal-field-collection

我有一个内容类型，可以包含无限的嵌入字段集合实例`field_foo`，每个集合包含两个字段：`field_foo_bar`和`field_foo_baz`。

`field_foo`我想修改此内容类型的节点创建表单，以使用现有节点上同一字段的值预填充。

默认情况下，节点创建表单具有：

```
FIELD FOO

FOO BAR [            ]
FOO BAZ [            ] 
```

...我想设置，例如：

```
FIELD FOO

FOO BAR [Bar value #1]
FOO BAZ [Baz value #1]

FOO BAR [Bar value #2]
FOO BAZ [Baz value #2] 
```

我怎样才能做到这一点？我觉得我错过了一些直截了当的东西。

我试图简单地克隆空字段集合`hook_form_alter()`并更改`field_foo_bar`和`field_foo_baz`值以适应，但它会导致添加/删除行和调整多个增量、权重等问题，这让我看起来像是在叫错树。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T16:18:11.497

hook_form_alter 是这样做的正确方法。如果出现其他问题，那是因为您没有正确填充字段，或者因为另一个模块也在您之后编辑字段。在前一种情况下，请查看[hook_node_insert](http://api.drupal.org/api/drupal/modules!node!node.api.php/function/hook_node_insert/7)中归档的格式。在后一种情况下，[更改](http://drupal.org/node/110238)模块的权重，使其最后触发并确保您的更改覆盖任何其他模块。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T04:27:37.453

由于字段集合实际上是实体，您是否可以使用 hook_entity_insert() 来检查要插入的实体是否是您的字段集合的实例，如果是，请设置值。

# android - Android 可视化工具行为

> ID：14266453
> 
> 赞同：1
> 
> 时间：2013-01-10T20:11:54.703
> 
> 标签：android, audio, visualizer, aubio

我正在尝试使用 C 库（Aubio）对从`MediaPlayer`Android 中播放的某些音乐执行节拍检测。为了捕获原始音频数据，我使用了 a [`Visualizer`](http://developer.android.com/reference/android/media/audiofx/Visualizer.html)，它定期将字节缓冲区发送到回调函数，回调函数又通过 JNI 将其发送到 C 库。

我得到不一致的结果（即几乎没有检测到节拍，并且唯一与音频不完全一致的节拍）。我已经检查了多次，虽然我不能完全排除我自己在做什么，但我想知道 Android 的`Visualizer`行为究竟如何，因为它在[文档](http://developer.android.com/reference/android/media/audiofx/Visualizer.html)中没有明确说明。

*   如果我使用 设置缓冲区大小`setCaptureSize`，这是否意味着捕获的缓冲区是在整个音频样本上进行平均的？例如，如果我将捕获大小除以 2，它是否仍代表相同的捕获*声音*，但在时间轴上的*精度*会降低 2 倍？
*   捕获率是一样的吗？例如，以一半的速率设置两倍的捕获大小是否会产生相同的数据？
*   捕获是连续的吗？换句话说，如果我处理一个捕获的时间太长，当我收到下一个捕获时，处理过程中播放的声音会被忽略吗？

感谢您的洞察力！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T18:23:15.873

确保回调函数获取整个音频信号，例如通过计算从其中出来的帧以及到达回调的帧。

`Visualizer`指出文档会有所帮助。

# r - data.table 中的“by”（分组依据）-我错过了什么？

> ID：14266454
> 
> 赞同：13
> 
> 时间：2013-01-10T20:11:55.907
> 
> 标签：r, data.table

我正在使用大 data.table 并使用 'by' 到 'group by' 3 个变量。

我的 data.table 是`d`并且有键“ma”（10 位整数，但我在下面缩短了它）。

但是设置`by="ma,year,month"`（对我来说这是更直观的 group by 语句）并没有给出我想要的。例如，ma = 284 有 2011 年 11 月的 3 个条目，或 ma= 672 有 2011 年 12 月的 2 个条目。

```
> d[,list(n=length(trx_num)),by=list(ma,year,month)]
      ma year month n
  1: 284 2011    12 3
  2: 284 2012     1 1
  3: 284 2011    11 5
  4: 284 2011    11 1
  5: 284 2011    11 2
 ---
5782971: 672 2012     7 1
5782972: 672 2011    12 1
5782973: 672 2012     2 1
5782974: 672 2011    12 1
5782975: 672 2012     1 1 
```

但是，颠倒“按”顺序会得到所需的结果。

```
> d[,list(n=length(trx_num)),by=list(month,year,ma)]
     month year ma  n
  1:    12 2011 284  3
  2:     1 2012 284  1
  3:    11 2011 284  8
  4:     5 2012 543  7
  5:     7 2012 543  3
 ---
1214686:     5 2012 672 28
1214687:     4 2012 672 13
1214688:    12 2011 672 11
1214689:     7 2012 672  9
1214690:     9 2012 672 11 
```

我在这里想念什么？提前致谢。

编辑：

给出错误结果的数据的 str()

```
> str(d)
Classes âdata.tableâ and 'data.frame':  14688135 obs. of  3 variables:
 $ ma   : num  3e+10 3e+10 3e+10 3e+10 3e+10 ...
 $ year : int  2011 2012 2011 2011 2011 2011 2011 2011 2011 2011 ...
 $ month: int  12 1 11 12 11 11 11 11 11 11 ...
 - attr(*, ".internal.selfref")=<externalptr>
 - attr(*, "sorted")= chr "ma" 
```

str() 的错误结果：

```
> str(d[,.N,by=list(ma,year,month)])
Classes âdata.tableâ and 'data.frame':  5782975 obs. of  4 variables:
 $ ma   : num  3e+10 3e+10 3e+10 3e+10 3e+10 ...
 $ year : int  2011 2012 2011 2011 2011 2012 2012 2012 2012 2012 ...
 $ month: int  12 1 11 11 11 5 7 6 9 8 ...
 $ N    : int  3 1 5 1 2 1 1 1 1 1 ...
 - attr(*, ".internal.selfref")=<externalptr> 
```

和正确结果的 str() ：

```
> str(d[,.N,by=list(month,year,ma)])
Classes âdata.tableâ and 'data.frame':  1214690 obs. of  4 variables:
 $ month: int  12 1 11 5 7 6 9 8 11 12 ...
 $ year : int  2011 2012 2011 2012 2012 2012 2012 2012 2011 2011 ...
 $ ma   : num  3e+10 3e+10 3e+10 3e+10 3e+10 ...
 $ N    : int  3 1 8 7 3 12 15 3 6 6 ...
 - attr(*, ".internal.selfref")=<externalptr> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-11T17:28:10.203

总结一下评论线索，该`ma`列是类型`numeric`和包含的值完全不同但非常接近，几乎在机器公差范围内但不完全。换句话说，这种情况：

```
 x < y < z
 (y-x) just less than machine tolerance so considered equal
 (z-y) just less than machine tolerance so considered equal
 (z-x) just over machine tolerance so considered not equal 
```

当这样的列与其他两列（即`by=`3 列）一起分组时，这 3 列的顺序（如果其中一列具有上述值）可以改变这些值是否被视为相等（并且在同一组中） .

解决方案是不要对此类数据使用类型`numeric`（`double`是另一个名称）。使用`integer`, 或在这种情况下整数大于 2^31 （导致强制`double`和精度损失，iiuc），`character`而不是。 `data.table`排序速度很快，`integer`并且`character`. `double`无论如何，它的排序还没有那么快。

我们将尝试添加一个新`warning`的`data.table`：

[FR#2469 添加新`tolerance.warning`选项以检测和发出`warning`任何`numeric`值是否接近但不完全在机器公差范围内](https://r-forge.r-project.org/tracker/index.php?func=detail&aid=2469&group_id=240&atid=978)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:47:42.637

我构建了一个小测试用例，在此对话框的某个时刻，我认为它表现出意外的行为，（但我正在读取错误的对象进行比较）：

```
d <-     structure(list(ma = c(284L, 284L, 284L, 284L, 284L, 284L, 284L, 
284L, 284L, 284L, 284L, 284L, 672L, 672L, 672L, 672L, 672L), 
    year = c(2011L, 2011L, 2011L, 2012L, 2011L, 2011L, 2011L, 
    2011L, 2011L, 2011L, 2011L, 2011L, 2012L, 2011L, 2012L, 2011L, 
    2012L), month = c(12L, 12L, 12L, 1L, 11L, 11L, 11L, 11L, 
    11L, 11L, 11L, 11L, 7L, 12L, 2L, 12L, 1L), trx_num = c(4L, 
    9L, 8L, 4L, 4L, 6L, 3L, 8L, 2L, 2L, 8L, 9L, 8L, 6L, 10L, 
    6L, 10L)), .Names = c("ma", "year", "month", "trx_num"), row.names = c(NA, 
-17L), class = c("data.table", "data.frame"), .internal.selfref = <pointer: 0x105afb0>, sorted = "ma") 
```

要构建它：

```
dat <- read.table(text=" ma year month n
 284 2011    12 3
 284 2012     1 1
 284 2011    11 5
 284 2011    11 1
 284 2011    11 2
 672 2012     7 1
 672 2011    12 1
 672 2012     2 1
 672 2011    12 1
 672 2012     1 1", header=TRUE)
require(data.table)
d <- data.table( data.frame(dat[rep(rownames(dat), times=dat$n), 1:3], trx_num=unlist(sapply(dat$n, sample, x=1:10)) ) )
setkey(d, ma)
d[,list(n=length(trx_num)),by=list(ma,year,month)]
d[,list(n=length(trx_num)),by=list(month,year,ma)] 
```

此时很明显 BlueMagister 的解决方案是正确的：

```
d[,.N, by=list(month,year,ma)]
d[,.N, by=list(ma,year,month)] # same result modulo row order 
```

# c# - DataGridView 数据绑定

> ID：14266457
> 
> 赞同：3
> 
> 时间：2013-01-10T20:12:06.093
> 
> 标签：c#, data-binding, datagridview, datagridviewcomboboxcell

我举一个简单的例子来解释我想要什么：

我定义了一个名为 的类`Student`，它有两个属性：*Name*和*Subjects*。

```
public class Student()
{
     public string Name;
     public List<string> Subjects;
} 
```

我创建了 Student 类的两个实例，例如：

```
List<string> jackSubjects = new List<string>();
jackSubjects.Add("Math");
jackSubjects.Add("Physics");
Student Jack = new Student("Jack", jackSubjects);
List<string> alanSubjects = new List<string>();
alanSubjects.Add("Accounting");
alanSubjects.Add("Science");
Student Alan = new Student("Alan", alanSubjects); 
```

然后我创建一个 List studentList：

```
List<Student> studentList = new List<Student>();
studentList.Add(Jack);
studentList.Add(Alan); 
```

我的问题是，有什么方法可以将它`studentList`与 a进行数据绑定`DataGridView`，如下所示：

```
dataGridView.DataSource = studentList; 
```

第一列是学生姓名，第二列是`combobox`显示学生所有科目的 a。

提前感谢您的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:27:51.370

像这样的东西会起作用：

1.  将 RowDataBound 事件添加到您的网格并创建一个模板列来保存主题的下拉列表：

    ```
    <asp:GridView ID="dataGridView" runat="server" AutoGenerateColumns="false" OnRowDataBound="dataGridView_RowDataBound">
       <Columns>
           <asp:BoundField DataField="Name" />
           <asp:TemplateField>
               <ItemTemplate>
                   <asp:DropDownList ID="subjects" runat="server" ></asp:DropDownList>
               </ItemTemplate>
           </asp:TemplateField>
       </Columns> 
    ```

2.  然后在后面的代码上处理 RowDataBound 事件，如下所示：

    ```
    protected void dataGridView_RowDataBound(object sender, GridViewRowEventArgs e)
    {
      if (e.Row.RowType == DataControlRowType.DataRow)
      {
        var ddl = (e.Row.FindControl("subjects") as DropDownList);
        ddl.DataSource = (e.Row.DataItem as Student).Subjects;
        ddl.DataBind();
      }
    } 
    ```

渲染： ![在此处输入图像描述](../Images/f3c2aaa0b69e27c0bc68861aa141629c.png)

顺便说一句，您的 Student 课程应如下所示：

```
public class Student
{
     public string Name {get;set;}
     public List<string> Subjects {get;set;}

     public Student(string name, List<string> subjects)
     {
         Name = name;
         Subjects = subjects;
     }
} 
```

# python - 加速运动检测代码opencv python numpy

> ID：14266459
> 
> 赞同：0
> 
> 时间：2013-01-10T20:12:20.950
> 
> 标签：python, optimization, opencv, numpy

我有这些

密码本.py

```
#http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.148.9778&rep=rep1&type=pdf

import numpy as np
import cv2

alpha = 5
beta = 0.95

Tdel = 80
Tadd = 140
Th= 80

mn,mx,f,l,p,q=0,1,2,3,4,5

class CodeBook():
    def __init__(self,h,w):
        self.h = h
        self.w = w
        self.M = np.empty((h, w), dtype=np.object)
        self.H = np.empty((h, w), dtype=np.object)
        filler = np.frompyfunc(lambda x: list(), 1, 1)
        filler(self.M,self.M)
        filler(self.H,self.H)
        self.t = 1

    def updatev(self,gray,cb):
        I,t = gray,self.t     
        if not cb:
            c = [max(0.0,I-alpha),min(255.0,I+alpha),1,t-1,t,t]
            cb.append(c)
        else:
            found = False
            for cm in cb:
                if(cm[mn]<=I<=cm[mx] and not found): 
                    cm[mn] = ((I-alpha)+(cm[f]*cm[mn]))/(cm[f]+1.0)    
                    cm[mx] = ((I+alpha)+(cm[f]*cm[mx]))/(cm[f]+1.0)
                    cm[f] += 1
                    #cm[l] = max(cm[l],t-cm[q])
                    cm[l] = 0
                    cm[q] = t
                    found = True
                else:
                    cm[l] = max(cm[l],10-cm[q]+cm[p]-1)
            if not found:
                c = [max(0.0,I-alpha),min(255.0,I+alpha),1,t-1,t,t]
                cb.append(c)                
        return cb
    def update(self,gray):       
        h,w,M = self.h,self.w,self.M
        updatev = np.vectorize(self.updatev,otypes=[np.object])
        self.M=updatev(gray,M)
        self.t += 1   
    def fgv(self,gray,cwm,cwh):
        I,t = gray,self.t
        pixval = 0
        found = False
        for cm in cwm:
            if(cm[mn]<=I<=cm[mx] and not found):
                cm[mn] = (1-beta)*(I-alpha) + (beta*cm[mn])
                cm[mx] = (1-beta)*(I+alpha) + (beta*cm[mx])
                cm[f] += 1
                #cm[l] = max(cm[l],t-cm[q])
                cm[l] = 0
                cm[q] = t
                found = True
            else:
                cm[l] += 1
                #cm[l]=max(cm[l],t-cm[q]+cm[p]-1)
        cwm[:] = [cw for cw in cwm if cw[l]<Tdel]  
        if found: return 0
        for cm in cwh:
            if(cm[mn]<=I<=cm[mx] and not found):
                cm[mn] = (1-beta)*(I-alpha) + (beta*cm[mn])
                cm[mx] = (1-beta)*(I+alpha) + (beta*cm[mx])
                cm[f] += 1
                #cm[l] = max(cm[l],t-cm[q])
                cm[l] = 0
                cm[q] = t
                found = True
            else:
                #cm[l]=max(cm[l],t-cm[q]+cm[p]-1)
                cm[l] += 1
        if not found:
            c = [max(0.0,I-alpha),min(255.0,I+alpha),1,0,t,t]
            cwh.append(c)
        cwh[:] = [cw for cw in cwh if cw[l]<Th]
        tomove = [cw for cw in cwh if cw[f]>Tadd]
        cwh[:] = [cw for cw in cwh if not cw in tomove]
        cwm.extend(tomove)
        return 255
    def fg(self,gray):  
        h,w,M,H = self.h,self.w,self.M,self.H
        fgv = np.vectorize(self.fgv,otypes=[np.uint8])
        fg = fgv(gray,M,H)
        self.t += 1
        return fg 
```

测试.py

```
import cv2
import sys
import numpy as np
import time
import cProfile
import pyximport; pyximport.install(reload_support=True,                                     
                                    setup_args={'script_args':["--compiler=mingw32"]})
import codebook
c = cv2.VideoCapture(0)
c.set(3,320)
c.set(4,240)
cv2.namedWindow('vid',0)
cv2.namedWindow('fg',0)
_,img = c.read()
img = cv2.resize(img,(160,120))
h,w = img.shape[:2]
cb = codebook.CodeBook(h,w)
N=0

def fillholes(gray):
    kernel = cv2.getStructuringElement(cv2.MORPH_ELLIPSE,(3,3))
    res = cv2.morphologyEx(gray,cv2.MORPH_OPEN,kernel)    

def run():
    while(1):
        global N
        _,img = c.read()
        img = cv2.resize(img,(160,120))
        gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)
        cv2.imshow('vid',gray)    
        if N < 10:        
            cb.update(gray)
        else:
            start = time.clock()
            fg = cb.fg(gray)
            print time.clock()-start
            element = cv2.getStructuringElement(cv2.MORPH_ELLIPSE,(2,2))
            fg= cv2.erode(fg,element)
            fillholes(fg)                
            cv2.imshow('fg',fg)
        N += 1
        if cv2.waitKey(5)==27:
            break
run()
cv2.destroyAllWindows()
c.release() 
```

代码卡在@ fgv。cython 可以加快速度。但它仍然运行缓慢。我正在考虑做这两个中的任何一个

*   让它并行运行
    *   多线程。我正在使用 epd 的 numpy 并将 MKL_NUM_THREADS 更改为 8。但它仍然绑定到单个内核。
    *   分发给工作进程数组切片
*   在cpp中重做一些/全部（哪个？我没有经验）部分虽然我真的很想避免这种情况

我已经尽可能地改变了 fgv。请让我知道接下来我应该看什么。多谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-24T06:47:04.757

固定的：

[是否可以将在 opencv 中实现的 ViBe 算法用于没有 GPU 的系统？](https://stackoverflow.com/questions/13818574/is-it-possible-to-use-vibe-algorithm-implemented-in-opencv-for-systema-without)

更多： http: [//www.changedetection.net/](http://www.changedetection.net/)

# c++ - 是否可以使用 dynamic_cast 进行模板类型检查？

> ID：14266460
> 
> 赞同：5
> 
> 时间：2013-01-10T20:12:24.067
> 
> 标签：c++

```
 template <class T> void checkObject(T genericObject)
    {
      MyClassA* a = dynamic_cast<MyClassA*>(genericObject);
      if (a != NULL)
      {
        //we know it is of type MyClassA
      }
      MyClassB* b = dynamic_cast<MyClassB*>(genericObject);
      if (b != NULL)
      {
        //we know it is of type MyClassB
      }
    } 
```

这样的事情可能吗？我们有一个模板类型但我们想知道它的实际类型？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T20:15:43.367

在模板世界中，您可能只想为每种类型专门化模板，而不是进行运行时检查，即

```
 template<typename T>
 void foo(T obj);

 template<>
 void foo<MyClassA>(MyClassA obj) {
 }

 template<>
 void foo<MyClassB>(MyClassB obj2) {
 } 
```

这将允许编译器通过推断您的参数在编译时生成正确的模板。

请注意**，这仅根据实例的 static type 解析**，即没有编译时知道您的变量是 a`MyClassC`继承自的变量`MyClassB`，因此应该使用泛型形式。所以这行不通：

```
 MyClassC* cinstance = new MyClassC();
  foo(cinstance); //compiler error, no specialization for MyClassC 
```

一般来说，这指向一个一般规则，即编译时和运行时多态性是非常不同的系统。模板在没有继承知识的情况下严格处理静态类型的领域。这可能会让来自 Java/C# 的人感到惊讶，因为它们在这两个功能之间具有更无缝的集成。

对于类功能的运行时专业化，您的选项是

1.  定义虚拟方法——可能不合适，这取决于这个功能是否真的应该是这个对象的一部分
2.  使用 dynamic_cast （你目前正在做的事情）——有点不受欢迎，但它可能是每个人都能得到的最直接的解决方案。
3.  [访问者模式](http://en.wikipedia.org/wiki/Visitor_pattern)——一种使用重载在运行时解析为正确类型的函数的设计模式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T20:24:21.663

这是可能的，但`MyClassA`必须`MyClassB` **至少有一个虚拟成员函数**才能`dynamic_cast`工作。我也相信你实际上想要 ( `T* genericObject`) 而不是`T genericObject`在你的函数签名中（否则它就没有什么意义了）。

基于模板专业化的解决方案对于***static* polymorphism**是可以的，但我相信问题是如何启用输入类型的***运行时*检测**。`MyClassA` *我想象这个模板被一个指针调用，该指针的*类型要么是`MyClassB`. **在这种情况下，模板专业化将无法**提供正确的答案。

无论如何，我有一种强烈的感觉，你正在尝试做错误的事情来实现你想要实现的目标（不管它是什么）。当你发布这类问题时，我建议你明确你想去哪里，你的**目标***是*什么；这可能只是*错误道路*上的障碍。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T20:16:17.740

是的，这是可能的。请注意，动态转换发生在运行时，模板在编译期间生成代码。因此，该函数仍将生成，但会在运行时对您描述的情况进行检查。

编辑：看看Doug T.'s answer以正确的方式做你想做的事。

# tableview - javaFX Tableview 数据不可见

> ID：14266461
> 
> 赞同：2
> 
> 时间：2013-01-10T20:12:27.783
> 
> 标签：tableview, javafx

我试图用数据填充 TableView。下一个代码在表中插入一个新行，但数据没有出现在表中。我试图为此找到解释但没有成功。

请帮忙。我不知道有什么问题。

在控制器.java

```
@FXML private TableView<TempTableData> tempTable;
@FXML private TableColumn<TempTableData,String> columnTime;
@FXML private TableColumn<TempTableData,Float> columnTempOne;
@FXML private TableColumn<TempTableData,Float> columnTempTwo;
@FXML private TableColumn<TempTableData,Float> columnTempThree;

@FXML protected void initialize() {

columnTime = new TableColumn<TempTableData,String>();
columnTime.setCellValueFactory(
    new PropertyValueFactory<TempTableData,String>("Time"));

columnTempOne = new TableColumn<TempTableData,Float>();
columnTempOne.setCellValueFactory(
    new PropertyValueFactory<TempTableData,Float>("Temp 1"));

columnTempTwo = new TableColumn<TempTableData,Float>();
columnTempTwo.setCellValueFactory(
    new PropertyValueFactory<TempTableData,Float>("Temp 2"));

columnTempThree = new TableColumn<TempTableData,Float>();
columnTempThree.setCellValueFactory(
    new PropertyValueFactory<TempTableData,Float>("Temp 3"));

tempDataList = FXCollections.observableArrayList();
tempDataList.add(new TempTableData("0",3.0f, 4f, 5f));
tempTable.setItems(tempDataList);
} 
```

临时表数据.java

公共类 TempTableData {

```
private final SimpleStringProperty time;
private final SimpleFloatProperty dataSensorOne;
private final SimpleFloatProperty dataSensorTwo;
private final SimpleFloatProperty dataSensorThree;

public TempTableData(String time, float dataSensorOne, float dataSensorTwo, float dataSensorThree){
    this.time = new SimpleStringProperty(time);
    this.dataSensorOne = new SimpleFloatProperty(dataSensorOne);
    this.dataSensorTwo = new SimpleFloatProperty(dataSensorTwo);
    this.dataSensorThree = new SimpleFloatProperty(dataSensorThree);
}
public String getTime() {
    return time.get();
}

public void setTime(String time) {
    this.time.set(time);
}

public float getDataSensorOne() {
    return dataSensorOne.get();
}

public void setDataSensorOne(float dataSensorOne) {
    this.dataSensorOne.set(dataSensorOne);
}

public float getDataSensorTwo() {
    return dataSensorTwo.get();
}

public void setDataSensorTwo(float dataSensorTwo) {
    this.dataSensorTwo.set(dataSensorTwo);
}

public float getDataSensorThree() {
    return dataSensorThree.get();
}

public void setDataSensorThree(float dataSensorThree) {
    this.dataSensorThree.set(dataSensorThree);
}

public String toString(){
    String string = String.format("[time: %s | dataSensorOne: %f |dataSensorTwo: %f |dataSensorThree: %f ]", 
            time.get(), dataSensorOne.get(), dataSensorTwo.get(), dataSensorThree.get());
    return string;
}
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:20:36.607

为什么要再次创建表格列？，因为他们已经使用 @FXML 注释（注入！）创建了。

从您的代码中删除列实例创建行，一切都会好起来的

```
// remove these lines
columnTime = new TableColumn<TempTableData,String>();
columnTempTwo = new TableColumn<TempTableData,Float>();
columnTempThree = new TableColumn<TempTableData,Float>(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-01T07:29:29.390

确保您的单元工厂值与相应的模型类值完全拼写。例如 private final .... SimpleStringProperty **time** ; 和新的……PropertyValueFactory(" **time** "));

# ipad - PDF 文件下载不适用于 iPad 特定浏览器

> ID：14266462
> 
> 赞同：1
> 
> 时间：2013-01-10T20:12:31.220
> 
> 标签：ipad, google-chrome, pdf, safari

在服务器端生成一个 PDF 文件并推送到客户端进行下载。虽然下载适用于 windows 上的所有浏览器，但在 IPAD 上失败。请指教。

规格：OS 6、Safari 6.1、Chrome 23.0.1271.100

请注意：在此应用程序中，pdf 不会下载到新的 url（无重定向）。

一般行为：iPad 浏览器（safari / chrome）不支持下载窗口，因此它应该打开 pdf 并提供在 pdf 兼容应用程序中查看的选项。目前还没有发生。

当我调试以下 servlet 操作代码以供下载时，pdf 文件已在服务器上成功生成，但 Ipad 上的浏览​​器不显示:-(

代码示例：

/** 设置响应头 **/

```
 response.setHeader("Content-Type", "application/pdf");
      response.setHeader("Content-Disposition", "attachment;filename=sample.pdf"); 
      response.setHeader("Connection", "close");
      response.setHeader("Cache-Control","cache");
      response.setHeader("Pragma","cache");
      response.setDateHeader ("Expires", dt.getTime() + 100000); 
```

/** 写入输出 **/

```
 InputStream stream = info.getInputStream(); 
      OutputStream os = response.getOutputStream();
      try {
            response.setContentType(contentType);
            copy(stream, response.getOutputStream());
      }
      finally {
      if (stream != null) {
         stream.close();
      }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-23T00:47:20.857

经过测试，上面粘贴的下载操作代码似乎工作正常，因为问题是特定于浏览器的。

Andriod Tablet - Firefox 浏览器将 pdf 下载到弹出窗口。iPad：Safari - FIX：强制内容在新标签页中打开，如下所示：

**window.open(print_url);**

其中 print_url 是 baseurl+action.do+additional_parameter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:27:26.293

要显示 pdf 而不是要求浏览器保存它，请使用“inline”而不是“attachment”。

```
response.setHeader("Content-Disposition", "inline;filename=sample.pdf"); 
```

此外，您设置了两次内容类型，一次在标题中，一次使用`setContentType()`. 我不确定这两个标题是否相互作用或相互抵消，所以不能肯定它是错误的来源，但似乎需要考虑改变。

# c - 了解子进程终止时的 SIGCHLD

> ID：14266485
> 
> 赞同：6
> 
> 时间：2013-01-10T20:13:47.550
> 
> 标签：c, linux

我无法理解以下程序的输出。我观察到子进程返回后，父进程在等待（）之前没有休眠 3 秒。如果 SIGCHLD 设置为默认处理程序，则它会休眠 3 秒，调用等待并按预期返回。这里到底发生了什么？

```
# include <unistd.h>
# include <sys/types.h>
# include <stdio.h>
# include <sys/wait.h>
# include <signal.h>

void handler(int sig) {
printf("Iam in handler ...\n");
}

main() {

int status;
pid_t pid;

struct sigaction act;
//act.sa_flags=SA_NOCLDSTOP;
act.sa_handler=handler;
sigaction(SIGCHLD,&act,NULL);

if(!fork()) {
printf("child process id is  %d\n",getpid());
 return 1;
}  

printf("xxx ...\n");
sleep(3);
pid = wait(&status);
printf("process terminated is %d\n",pid);

}

output::

xxx ...
child process id is  2445
Iam in handler ...
process terminated is 2445 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-10T20:23:15.790

来自[sleep() 的人](http://linux.die.net/man/3/sleep)：

> sleep() 使调用线程休眠，直到*秒*秒秒过去或没有被忽略的信号到达。

您的孩子终止会导致一个信号唤醒您。

来自的返回值`sleep()`：

> 如果请求的时间已经过去，则为零，或者如果调用被信号处理程序中断，则剩余的睡眠秒数。

如果您想帮助您“完成”睡眠，可以使用。

```
unsigned sleep_time = 3;
...
while((sleep_time = sleep(sleep_time)) > 0) {}
pid = wait(&status);
... 
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-01-10T20:15:49.980

当子进程死亡时，将`SIGCHLD`发送给父进程。在您的情况下，它会中断`sleep`并且看起来好像进程没有休眠。

问题的要点：`sleep`被信号中断时不会重新启动。

# android - 如何在 Eclipse 上启动 Android 源代码示例？

> ID：14266486
> 
> 赞同：-1
> 
> 时间：2013-01-10T20:13:49.877
> 
> 标签：android

我已经从 SDK 管理器下载了示例。现在，我想知道如何在 Eclipse 中启动它。

开始一个新项目时，我从现有代码中选择 Android 项目。我可以从哪里获得该代码的路径？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:17:25.683

在 Eclipse 中，New>Project...>Android>Android Sample Project 然后选择您已安装的平台，然后选择您要构建和测试的示例项目。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:22:46.557

它们位于您的 Android SDK 文件夹中。在我的机器上，完整路径是

C:\Program Files\Android\android-sdk-windows\samples\android-17\AccelerometerPlay

# javascript - 如何将带有选择和输入的 HTML 表转换为 json 并再次返回

> ID：14266488
> 
> 赞同：1
> 
> 时间：2013-01-10T20:14:02.823
> 
> 标签：javascript, jquery, html, json, asp.net-mvc-4

我有以下 html 表，其中包含行和列，每个行和列都包含一个带有文本的 td、一个选择和一个输入 [type='text']。每行还有一个最后一个 td 用于从表中删除行，与将表行保存为 json 无关，可以忽略。

```
 <table id="columnsTable" class="table white-table table-bordered table-hover table-striped">
    <thead>
        <tr>
            <th>Column</th>
            <th>Condition</th>
            <th>Value</th>
            <th></th>
        </tr>
    </thead>
    <tbody id="columnsTableBody">
        <tr id="StudentInfo.FirstName" class="StudentInfo.FirstName" name="StudentInfo.FirstName">
            <td>FirstName</td>
            <td>
                <select id="StudentInfo.FirstName-condition">
                    <option value="LIKE">CONTAINS</option>
                    <option value="=">EQUALS</option>
                    <option value="!=">NOT EQUAL</option>
                    <option value="&gt;">GREATER THAN</option>
                    <option value="&lt;">LESS THAN</option>
                    <option value="&gt;=">GREATER THAN OR EQUAL TO</option>
                    <option value="&lt;=">LESS THAN OR EQUAL TO</option>
                </select></td>
            <td>
                <input type="text" id="StudentInfo.FirstName-value" class="required" title="Value is required"></td>
            <td>
                <label>
                    <input type="checkbox" id="StudentInfo.FirstName-checkbox"></label></td>
        </tr>
        <tr id="StudentInfo.LastName" class="StudentInfo.LastName" name="StudentInfo.LastName">
            <td>LastName</td>
            <td>
                <select id="StudentInfo.LastName-condition">
                    <option value="LIKE">CONTAINS</option>
                    <option value="=">EQUALS</option>
                    <option value="!=">NOT EQUAL</option>
                    <option value="&gt;">GREATER THAN</option>
                    <option value="&lt;">LESS THAN</option>
                    <option value="&gt;=">GREATER THAN OR EQUAL TO</option>
                    <option value="&lt;=">LESS THAN OR EQUAL TO</option>
                </select></td>
            <td>
                <input type="text" id="StudentInfo.LastName-value" class="required" title="Value is required"></td>
            <td>
                <label>
                    <input type="checkbox" id="StudentInfo.LastName-checkbox"></label></td>
        </tr>
        <tr id="StudentInfo.CurrentCollege" class="StudentInfo.CurrentCollege" name="StudentInfo.CurrentCollege">
            <td>CurrentCollege</td>
            <td>
                <select id="StudentInfo.CurrentCollege-condition">
                    <option value="LIKE">CONTAINS</option>
                    <option value="=">EQUALS</option>
                    <option value="!=">NOT EQUAL</option>
                    <option value="&gt;">GREATER THAN</option>
                    <option value="&lt;">LESS THAN</option>
                    <option value="&gt;=">GREATER THAN OR EQUAL TO</option>
                    <option value="&lt;=">LESS THAN OR EQUAL TO</option>
                </select></td>
            <td>
                <input type="text" id="StudentInfo.CurrentCollege-value" class="required" title="Value is required"></td>
            <td>
                <label>
                    <input type="checkbox" id="StudentInfo.CurrentCollege-checkbox"></label></td>
        </tr>
        <tr id="StudentInfo.EmailAddress" class="StudentInfo.EmailAddress" name="StudentInfo.EmailAddress">
            <td>EmailAddress</td>
            <td>
                <select id="StudentInfo.EmailAddress-condition">
                    <option value="LIKE">CONTAINS</option>
                    <option value="=">EQUALS</option>
                    <option value="!=">NOT EQUAL</option>
                    <option value="&gt;">GREATER THAN</option>
                    <option value="&lt;">LESS THAN</option>
                    <option value="&gt;=">GREATER THAN OR EQUAL TO</option>
                    <option value="&lt;=">LESS THAN OR EQUAL TO</option>
                </select></td>
            <td>
                <input type="text" id="StudentInfo.EmailAddress-value" class="required" title="Value is required"></td>
            <td>
                <label>
                    <input type="checkbox" id="StudentInfo.EmailAddress-checkbox"></label></td>
        </tr>
        <tr id="StudentInfo.Status" class="StudentInfo.Status" name="StudentInfo.Status">
            <td>Status</td>
            <td>
                <select id="StudentInfo.Status-condition">
                    <option value="LIKE">CONTAINS</option>
                    <option value="=">EQUALS</option>
                    <option value="!=">NOT EQUAL</option>
                    <option value="&gt;">GREATER THAN</option>
                    <option value="&lt;">LESS THAN</option>
                    <option value="&gt;=">GREATER THAN OR EQUAL TO</option>
                    <option value="&lt;=">LESS THAN OR EQUAL TO</option>
                </select></td>
            <td>
                <input type="text" id="StudentInfo.Status-value" class="required" title="Value is required"></td>
            <td>
                <label>
                    <input type="checkbox" id="StudentInfo.Status-checkbox"></label></td>
        </tr>
    </tbody>
</table> 
```

如何将行保存为以下格式的 JSON？，以便我可以循环返回它以从 JSON 重新构建表行。

```
columns: {
    StudentInfo.FirstName: {
       condition: 'CONTAINS',
       value: 'Carl'
    }
    StudentInfo.LastName: {
        condition: 'EQUALS',
        value: 'W'
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:18:41.910

将其存储为数组的集合，您可以循环通过它来重建表格 html。这也将减少内存使用量。而且我认为您应该将其重命名为，`rows`而不是`columns`因为它们是表格的理想行。

```
rows: [
    ['FirstName',  'CONTAINS',  'Carl'],
    ['LastName',  'EQUALS',  'W'],
]; 
```

用法：

```
var $table = $('tableSelector');
$.each(rows, function(i, obj){
   //Now use obj which is again an array and create the required html
   $table.append(...);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:32:09.610

我认为这段代码会将您的值放入 JS 对象中。虽然我没有测试过

```
 var tbody = $("#columnsTable tbody");

var StudentInfo = {
    "FirstName" : {
        "title" : "FirstName", 
        "condition" : tbody.find("select[id='StudentInfo.FirstName-condition'] option:selected").val(), 
        "value" : tbody.find("input[id='StudentInfo.FirstName-value']").val(), 
        "checked" : (tbody.find("input[id='StudentInfo.FirstName-checkbox']:checked").length > 0)
    }, 
    "LastName" : {
        "title" : "LastName", 
        "condition" : tbody.find("select[id='StudentInfo.LastName-condition'] option:selected").val(), 
        "value" : tbody.find("input[id='StudentInfo.LastName-value']").val(), 
        "checked" : (tbody.find("input[id='StudentInfo.LastName-checkbox']:checked").length > 0)
    }, 
    "CurrentCollege" : {
        "title" : "CurrentCollege", 
        "condition" : tbody.find("select[id='StudentInfo.CurrentCollege-condition'] option:selected").val(), 
        "value" : tbody.find("input[id='StudentInfo.CurrentCollege-value']").val(), 
        "checked" : (tbody.find("input[id='StudentInfo.CurrentCollege-checkbox']:checked").length > 0)
    }, 
    "EmailAddress" : {
        "title" : "EmailAddress", 
        "condition" : tbody.find("select[id='StudentInfo.EmailAddress-condition'] option:selected").val(), 
        "value" : tbody.find("input[id='StudentInfo.EmailAddress-value']").val(), 
        "checked" : (tbody.find("input[id='StudentInfo.EmailAddress-checkbox']:checked").length > 0)
    }, 
    "Status" : {
        "title" : "Status", 
        "condition" : tbody.find("select[id='StudentInfo.Status-condition'] option:selected").val(), 
        "value" : tbody.find("input[id='StudentInfo.Status-value']").val(), 
        "checked" : (tbody.find("input[id='StudentInfo.Status-checkbox']:checked").length > 0)
    },
}; 
```

因为您在对象的 id 和类名中使用了句点，所以我认为 jQuery 会遇到问题。我在上面的代码中使用了一个选择器，它不应该对句点有任何问题。

**编辑**

修复了一些选择器

**编辑 2**

至于使用这个：`alert(StudentInfo.CurrentCollege.condition);`。

# asp.net-mvc - asp.net mvc - 临时数据值在视图中不可用

> ID：14266489
> 
> 赞同：1
> 
> 时间：2013-01-10T20:14:14.860
> 
> 标签：asp.net-mvc, asp.net-mvc-3, tempdata

在控制器中，我在控制器中设置`TempData`值，如下所示：

```
TempData["LinkControllerName"] = "Foos";
TempData["LinkActionName"] = "View"; 
```

当我尝试在视图中使用它们时，我发现它们始终为空。我可以使用调试器并看到它们被设置，然后在视图中看到它们为空。我很迷惑。

控制器动作实际上是一个子动作，视图是通过调用`PartialView()`父控制器来呈现的。没有重定向发生。谁能提出问题是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:16:45.473

这并不能直接回答问题，但您应该使用`ViewData`or`ViewBag`将额外的值从控制器传递给视图。

# ruby-on-rails - Rails：Has_many through、嵌套复选框和验证存在_of

> ID：14266490
> 
> 赞同：3
> 
> 时间：2013-01-10T20:14:14.773
> 
> 标签：ruby-on-rails, ruby, validation, nested-attributes

我敢肯定这是一个普遍的问题，但它让我很难过。

我在“Step”模型上有一个 has_many :through 表：

```
has_many :questions, :through => :question_step 
```

该 question_step 模型在 question_id 和 step_id 字段上有存在验证器：

```
validates_presence_of :question_id, :step_id 
```

还有一些复选框可以确定哪些问题属于哪个步骤

```
td= check_box_tag "step[question_ids][]", question.id, @step.question_ids.include?(question.id) 
```

现在，这工作得很好，除非我想向*新*步骤添加问题。因为 step_id 为空白，question_step 模型验证失败。如果我删除 question_step 模型中的 validate_presence_of :step_id 参数，它工作正常，但我确实*想*确保 step_id 在那里。

我确定这是一个常见问题。...有什么想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T01:40:05.453

您可以检查是否存在问题和步骤对象，而不是验证步骤和问题 ID 是否存在：

```
validates_presence_of :question, :step 
```

如果这不起作用，您应该考虑删除应用程序级别的验证并改为添加数据库约束，您只需在迁移中向列添加非空约束：

```
def up
  change_column question_steps, :question_id, :integer, :null => false
  change_column question_steps, :step_id,     :integer, :null => false
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-09T20:31:11.520

我有一个非常相似的问题。根据[这个问题](https://stackoverflow.com/questions/14140994/failing-validations-in-join-model-when-using-has-many-through)，出现了竞争条件。

在我的控制器的创建操作中，我决定首先使用排除关联参数的参数来创建没有关联的主模型。然后使用关联参数更新模型。

所以在你的情况下它可能是

```
def create
  @step = Step.create(create_params)
  @step.update_attributes(association_params) unless @step.errors.any?
  respond_to do |format|
    if @step.errors.empty?
      format.html #etc..
    else
      format.html#...etc..
    end
  end
end

private
def create_params
  perm_params = step_params
  perm_params.delete :question_ids
  perm_params
end
def association_params
  params.require(:step).permit(question_ids: [])
end
def step_params
  params.require(:step).permit(:name, :other_attributes, question_ids: [])
end 
```

这样您就不必将验证移动到您的数据库中。您仍将在更新方法中使用正常的 step_params。

params 方法可能会被干掉一点，我想知道为什么我需要为在 rails 3 中简单工作的东西而大惊小怪，但它现在对我有用。

# php - 带有 api 的资产 shopify 产品页面模板

> ID：14266491
> 
> 赞同：1
> 
> 时间：2013-01-10T20:14:18.313
> 
> 标签：php, api, shopify

我正在开发一个 shopify php 应用程序，它将在产品页面之前或之后添加一个 Facebook 喜欢按钮，供客户点击和喜欢商店产品。

现在我的问题是如何将代码推送到产品页面模板中，以及当用户卸载应用程序时，代码将从模板中删除

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:36:55.107

您需要为此使用[ScriptTag](http://api.shopify.com/scripttag.html) - 当用户安装您的应用程序时，将 ScriptTag 添加到他们的商店。它引用的脚本需要在您的服务器上/可访问，并且它必须处理设置类似按钮并检测它是否在产品页面上。卸载您的应用程序后，删除 ScriptTag。

# wcf - WCF serviceCertificate 似乎忽略了 storeName

> ID：14266492
> 
> 赞同：1
> 
> 时间：2013-01-10T20:14:33.020
> 
> 标签：wcf, wcf-security

我有以下内容：

```
findValue="10 21 80 7a ec d1 6a 61 9a 4b 44 d8 f4 f6 5d 87 bf 0e 4b fb" 
          x509FindType="FindByThumbprint"
          storeLocation="LocalMachine"
          storeName="TrustedPeople"/> 
```

我收到相关错误：

```
Cannot find the X.509 certificate using the following search criteria: StoreName 'My', StoreLocation 'LocalMachine', FindType 'FindByThumbprint', FindValue '10 21 80 7a ec d1 6a 61 9a 4b 44 d8 f4 f6 5d 87 bf 0e 4b fb'. 
```

为什么 WCF 会忽略 storeName 并搜索 My？

# vba - excel宏cells.find由于某种原因不会使用变量

> ID：14266494
> 
> 赞同：1
> 
> 时间：2013-01-10T20:14:34.653
> 
> 标签：vba, excel, clipboard

我将此代码作为excel宏。

```
 Dim MyData As DataObject
  Set MyData = New DataObject
  MyData.GetFromClipboard

  MsgBox MyData.GetText

  On Error GoTo NotFound
  Cells.Find(What:=MyData.GetText, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
  :=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
  False, SearchFormat:=False).Activate

  NotFound: 
```

**`MsgBox`正确写入值，但`What:=MyData.GetText`只是不起作用。为什么？或者，更重要的是，如何解决它？**

如果不清楚，我正在尝试找到下一个等于剪贴板中的值的值。我已经引用了 MSForms，所以这不是问题。

如果我将 MyData.GetText 分配给一个变量并使用该变量，同样的情况会发生，`MsgBox`有效，但`What:=myvariable`不会。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T21:00:30.713

不知道为什么会这样，但确实如此：

```
Sub test()
Dim MyData As DataObject
Dim rng As Excel.Range

Set MyData = New DataObject
MyData.GetFromClipboard
Set rng = ActiveSheet.Cells.Find(What:=MyData.GetText, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
                                 :=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
                                 False, SearchFormat:=False)

rng.Activate
End Sub 
```

# c# - 导航 QueryString 与 PhoneApplicationService.Current.State

> ID：14266495
> 
> 赞同：4
> 
> 时间：2013-01-10T20:14:37.210
> 
> 标签：c#, windows-phone-7, windows-phone-8

我正在为我的 Windows Phone 8 应用程序使用 NavigationContext.QueryString。例如，我在导航字符串和 OnNavigatedTo 中设置了一个类似 ItemId 的 URI 标识符，我解析 Id 并通过 linq 读取 Item。

```
 protected override void OnNavigatedTo(NavigationEventArgs e)
    {
        try
        {
            int itemId = int.Parse(NavigationContext.QueryString["itemId"]);

            _item = App.MainViewModel.GetItem(itemId);

            DataContext = _item;
        }
        catch (KeyNotFoundException ex)
        {
            Debug.WriteLine(ex.Message);
            throw;
        }
    } 
```

我找到了一个有趣的替代方案，想听听您的意见：

```
// in the calling page
PhoneApplicationService.Current.State["Item"] = App.MainViewModel.GetItem(123);

// in the destination page
Item item = PhoneApplicationService.Current.State["Item"] as Item; 
```

这真的是推荐的方式吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:25:42.087

来自[MSDN](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff707299%28v=vs.105%29.aspx)：

> PhoneApplicationService 类提供对应用程序生命周期各个方面的访问。这包括管理应用程序的空闲行为和管理应用程序变为活动或不活动时的状态。您可以这样使用它，但数据必须是可序列化的。

此[链接](https://stackoverflow.com/questions/4953491/passing-data-from-page-to-page)有其他共享数据的方式，但我不认为 state 是推荐的方式。它更多地用于墓碑目的。

# mysql - 为特定用户 ID 选择所有项目和任务

> ID：14266498
> 
> 赞同：0
> 
> 时间：2013-01-10T20:14:49.957
> 
> 标签：mysql, sql

当给定特定的用户 ID 时，我试图从我的数据库中选择所有项目和任务。

表格如下：

```
Users: UserID
Projects: ProjectID, UserID
Tasks: TaskID, ProjectID 
```

我已经尝试过嵌套查询、表连接等，但到目前为止我还不是 SQL 专家，我正在努力获得我需要的东西。我可以从特定的用户 ID 获取所有任务，但是在 ProjectID 上使用内部联接，这意味着它不会返回具有 0 个任务的项目，因为没有任务的项目没有任何可加入的内容。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:17:59.213

您需要用于[`LEFT JOIN`](http://www.codinghorror.com/blog/2007/10/a-visual-explanation-of-sql-joins.html)返回数据：

```
select *
from users u
left join projects p
    on u.userid = p.userid
left join tasks t
    on p.projectid = t.projectid
where u.userid = ? 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/af62f/1)

这将返回所有用户，无论他们在`projects`or`tasks`表中是否有记录。

# batch-file - 批处理文件查找重复文件并将它们放在单独的目录中

> ID：14266503
> 
> 赞同：1
> 
> 时间：2013-01-10T20:15:22.923
> 
> 标签：batch-file, dos

我在网络驱动器上有两个目录。X:\MAPS 和 X:\MAPS2 目录 1 和 2 有一堆文件。

我需要一个批处理文件：读取目录 1 中的每个文件并检查目录 2 中是否存在相同的文件，然后将此文件复制到不同的目录 X:\MAPS3 读取下一个文件，依此类推。最后，我最终得到了 X:\MAPS3，它只有来自 1 和 2 的重复文件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:41:29.030

```
for %%F in (X:\MAPS\*) do if exist "X:\MAPS2\%%~nxF" copy "%%~fF" "X:\MAPS3\%%~nxF" 
```

**评论的扩展答案**

```
for %%F in (X:\MAPS\*) do (
    if exist "X:\MAPS2\%%~nxF" copy "%%~fF" "X:\MAPS3\%%~nxF"
    if exist "X:\MAPS5\%%~nxF" copy "%%~fF" "X:\MAPS3\%%~nxF"
    if exist "X:\MAPS7\%%~nxF" copy "%%~fF" "X:\MAPS3\%%~nxF"
    if exist "X:\MAPS8\%%~nxF" copy "%%~fF" "X:\MAPS3\%%~nxF"
    if exist "X:\MAPS9\%%~nxF" copy "%%~fF" "X:\MAPS3\%%~nxF"
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:40:16.330

在批处理文件中：

```
cd /d X:\MAPS
for %%i in (*.*) do if exist "X:\MAPS2\%%1" copy "%%i" X:\MAPS3 
```

从命令提示符：

```
C:>cd /d X:\MAPS
X:\MAPS>for %i in (*.*) do if exist "X:\MAPS2\%i" copy "%i" X:\MAPS3 
```

# visual-studio - Visual Studio 中的增量项目保存

> ID：14266505
> 
> 赞同：0
> 
> 时间：2013-01-10T20:15:33.757
> 
> 标签：visual-studio, web, project, save

通常，当我开始一个网站项目并随着时间的推移在其上构建时，每次我想保存我的项目时，我都会保存它并保留一份包含所有项目文件的 .rar 文件中的保存副本，并保留很多增量保存 .rar 文件，我这样做是因为我可能会把事情搞砸，有时我不知道出了什么问题，所以我的网站项目的以前版本将帮助我回到正常的地方。

我不确定这是否是为此目的的最佳方法，我想知道是否有任何工具或扩展可以使它更容易，所以每次我保存我的项目时，该扩展或其他东西都会为我做，或者更好我不知道的方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:22:38.063

最好的方法是[版本控制](http://betterexplained.com/articles/a-visual-guide-to-version-control/)。例如，查看[svn](http://subversion.tigris.org/)或[git](http://git-scm.com/)，还有 VS 扩展，因此如果您想要的话，您可以在 IDE 中使用它们。

# youtube - 将幻灯片上传到 Youtube

> ID：14266510
> 
> 赞同：7
> 
> 时间：2013-01-10T20:15:46.787
> 
> 标签：youtube

如何使用他们的 API 将照片幻灯片上传到 Youtube？我在这里找不到它： [https ://developers.google.com/youtube/2.0/developers_guide_protocol_uploading_videos](https://developers.google.com/youtube/2.0/developers_guide_protocol_uploading_videos)

看起来只有用于常规视频上传的 API。

**更新：** 照片幻灯片是手动上传视频的第二个选项。在这里：[http ://www.youtube.com/my_videos_upload](http://www.youtube.com/my_videos_upload)

您可以附加多张照片，从预定义列表中添加音乐并修改视频设置，如标题、描述等。它将由 Youtube 内部转换为视频并发布。

# android - Android JSONParser、httpclient 和 cookie

> ID：14266517
> 
> 赞同：0
> 
> 时间：2013-01-10T20:16:13.760
> 
> 标签：android, cookies, httpclient

好的，所以我知道这已经被问过一百万次了，我已经阅读了大部分的帖子和答案，但这是漫长的一天，我的大脑被炸了，我就是无法让它工作......

我有一个 Android 应用程序，我正在修改它以使用 phpbb3 用户表登录，但我很难过，因为它需要启用 cookie 才能使登录工作。

这是我的应用程序中的当前 httpclient 代码，适用于我的旧的非 phpbb3 用户表：

```
// defaultHttpClient
DefaultHttpClient httpClient = new DefaultHttpClient();
HttpPost httpPost = new HttpPost(url);
httpPost.setEntity(new UrlEncodedFormEntity(params));

HttpResponse httpResponse = httpClient.execute(httpPost);
HttpEntity httpEntity = httpResponse.getEntity();
is = httpEntity.getContent(); 
```

我需要添加什么才能让它接受 cookie？必须能够从 API 8 开始工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:42:18.807

DefaultHttpClient 开箱即用地处理 cookie，您只需要重用相同的客户端，而不是为每个请求创建新的客户端。

# java - WebSphere 单点登录，Windows 域

> ID：14266520
> 
> 赞同：0
> 
> 时间：2013-01-10T20:16:24.097
> 
> 标签：java, apache-flex, single-sign-on, websphere-7

我们应该从哪里开始使用 Java Web 应用程序为单个 Windows (Active Directory) 域设置单点登录？

我所说的单点登录并不是指用户明确地登录到一个 Java 网站，然后在其他 Websphere 站点上保持登录状态。

我们正在寻找能够有效“检测”当前在客户端浏览器的 PC（Windows XP，即将成为 Windows 7）上登录的 Windows 用户，并将该用户的登录名提供给 Java WebSphere 应用程序的东西。

该软件是 Java/WebSphere，带有一个 Flex 前端，如果需要，我们可以将其放入 JSP 中。（目前它只是一个html页面，这是首选。GraniteDS用于远程处理。）

该服务器不是 Windows 服务器，因此不能选择 Waffle。到目前为止的研究似乎表明我们需要使用一种叫做 SPNEGO 的东西，但是我还没有找到关于 Java 开发人员在设置它时的角色的信息。

我会对服务器端（WebSphere）配置和要求以及所需的 Java 应用程序配置和代码感兴趣（即使通过 Google 也很难找到）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-22T15:50:55.960

Java 应用程序开发人员只需将 Web 应用程序配置为依赖来自容器（Websphere Application Server）的身份验证。

剩下的全部取决于容器的配置以提供正确的凭据等。WAS 管理员将为 SPNEGO/Kerboros 执行类似的操作：[http](http://www.redbooks.ibm.com/abstracts/sg247771.html) ://www.redbooks.ibm.com/abstracts/sg247771.html 。此外，浏览器配置需要将 Websphere 托管的站点添加到 Intranet 区域和安全机制中允许的域中。

一个更好的“黑客”可能是（未经测试）将 Websphere 放在 IIS 后面，如[http://www.iis.net/learn/extensions/url-rewrite-module/reverse-proxy-with-url-rewrite-v2 -and-application-request-routing](http://www.iis.net/learn/extensions/url-rewrite-module/reverse-proxy-with-url-rewrite-v2-and-application-request-routing)。

在所有情况下，您仍然需要弄清楚如何让 Flex 让浏览器进行 Windows NTLM 身份验证，或者让它自己这样做。祝你好运。

# javascript - 如何使用该数组中的值？分机 JS 4

> ID：14266521
> 
> 赞同：0
> 
> 时间：2013-01-10T20:16:24.183
> 
> 标签：javascript, extjs, extjs4

所以，当我输入时，`console.log(Test.globals.user)`我得到了这个：

```
[id: "1", first_name: "MyFirstName", last_name: "MyLastName"] 
```

如何获取名字和姓氏的值？我试过这个：

```
Test.globals.user.first_name //undefined
Test.globals.user[first_name] //error - no first_name variable provided
Test.globals.user["first_name"] //undefined 
```

谢谢你。:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:24:00.783

这样做的 Ext 方法是有一个单例类来保存全局的、应用程序范围的变量：

```
Ext.define('Test.globals', {
    singleton: true,

    user: {
        id: 1,
        first: 'Foo',
        last: 'Bar'
    }
});

Ext.onReady(function(){
    console.log(Test.globals.user.first);
}); 
```

非分机示例

```
var Test = {
    globals: {
        user: {
            first: 'Foo'
        }
    }    
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:08:40.907

你可以试试 Test.globals.user[1].first_name 吗？

# .htaccess - 强制更新内容，而不是来自缓存

> ID：14266523
> 
> 赞同：0
> 
> 时间：2013-01-10T20:16:29.107
> 
> 标签：.htaccess, caching, optimization, browser

我在 htaccess 中使用以下代码将我的网站置于维护状态并显示访问者 maintenance.html。

```
#Options +FollowSymlinks
#RewriteEngine on
#RewriteCond %{REQUEST_URI} !/maintenance.html$
#RewriteRule $ /maintenance.html [R=302,L] 
```

我的网站现在重新上线，但现在我看到所有那些在维护期间尝试访问我网站的浏览器，它们仍在获取 maintenance.html。

如果我清除浏览器缓存并且我有点理解它发生的原因，它会起作用。我认为浏览器缓存了重定向并且仍在执行此操作。

我怎样才能清除这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:20:20.030

您应该能够使用 mod_header 告诉浏览器不要缓存您的维护页面。

```
Header merge Cache-Control no-cache
Header merge Cache-Control no-store 
```

# ruby-on-rails - 关闭浏览器后保持会话活动。

> ID：14266530
> 
> 赞同：0
> 
> 时间：2013-01-10T20:16:52.157
> 
> 标签：ruby-on-rails, ruby, session, cookies

我该怎么做，在用户添加一些东西到购物车，并在重新打开 rails 后离开浏览器（关闭）恢复它的会话，用户可以购物更多......现在我有这样的

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :current_cart 
  private
    def current_cart
      Cart.find(session[:cart_id])
      @cart = Cart.find(session[:cart_id])
      rescue ActiveRecord::RecordNotFound
      cart = Cart.create
      session[:cart_id] = cart.id
      cart
    end

end 
```

并在下订单后销毁：

```
def destroy
    @cart = current_cart
    @cart.destroy
    session[:cart_id] = nil
    respond_to do |format|
      format.html { redirect_to session[:prev_url],
        :notice => I18n.t(:empty_card) }
      format.json { head :ok }
    end
  end 
```

但是我怎样才能告诉 RoR 让这个会话保持活跃呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:29:42.410

只需存储`cart_id`到 cookie 中而不是会话中，您就会实现您想要的。当您需要提取购物车信息时，请使用 cookie 中的 ID。

```
class ApplicationController < ActionController::Base
  protect_from_forgery

  before_filter :current_cart 
  private
    def current_cart
      Cart.find(cookies[:cart_id])
      @cart = Cart.find(cookies[:cart_id])
      rescue ActiveRecord::RecordNotFound
      cart = Cart.create
      cookies[:cart_id] = cart.id
      cart
    end

end 
```

希望能帮助到你。

# python - 如果周末在范围之间，Django过滤器

> ID：14266533
> 
> 赞同：-2
> 
> 时间：2013-01-10T20:17:11.753
> 
> 标签：python, django

我有以下型号：

```
class Destination_Deal(models.Model):
    name = models.CharField(_("Nombre"),max_length=200)
    duration = models.IntegerField(_(u"Días"))

class Departure_Date(models.Model):
    date_from= models.DateField(_('Desde'))    
    date_to= models.DateField(_('Hasta'))
    destination_deal = models.ForeignKey(Destination_Deal,verbose_name = _("Oferta de Destino")) 
```

我想筛选适合周末旅行的目的地优惠。这意味着：

出发日 = 周五或周六
返回日 = 周日。因此，如果出发日是星期五或星期六，则持续时间必须为 3 或 2。

**例子**

```
Destination_Deal
id  name        duration
1   Deal1       3
2   Deal2       5
3   Deal3       2
4   Deal4       7

Departure_Date
id  date_from   date_to     destination_deal_id
1   2012-11-05  2012-11-15  1
2   2012-11-01  2012-12-16  2
3   2013-01-21  2013-01-27  3
4   2013-01-14  2013-01-18  3
5   2013-01-04  2013-01-11  4 
```

**期望的结果**
**ID1：** 2012-11-09 是星期五，交易的持续时间是 3。所以在这种情况下，星期五、星期六和星期日符合有效的周末。

**ID3：** 2013-01-26 是星期六，交易的持续时间是 2。也是有效的。

**--编辑--**
好的，如果我不清楚，对不起。我需要根据上述周末规则过滤目的地交易。我想通过从模型（DateField）获取 date_from 到 python（datetime），迭代它直到 date_to 并使用 weekday() 函数来检查它是星期五还是星期六。

我知道 django weekday 功能，但它只能在特定日期（无范围）工作，所以我想知道这种情况是否有更简单的方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:16:11.740

```
where = '(deparure_date__date_from - deparure_date__date_to) > 4 || \
         DAYOFWEEK(deparure_date__date_from) IN (1, 6, 7) || \
         DAYOFWEEK(deparure_date__date_to) IN (1, 6, 7)'

Destination_Deal.objects.filter(duration__in=[1, 2, 3]) \
                        .extra(where=[where]) 
```

*   如果持续时间在 1、2、3
*   如果`date_from`和`date_to`> 4 的差异，那么肯定会有星期五、星期六或星期日。
*   或检查是否`date_from`是星期五、星期六或星期日
*   或者`date_to`是星期五、星期六或星期日

# c# - 在 gridview 中使用 HyperLinkField 进行 URL 导航

> ID：14266537
> 
> 赞同：6
> 
> 时间：2013-01-10T20:17:20.133
> 
> 标签：c#, asp.net, gridview, hyperlink

我正在使用 a `HyperLinkField`inside a `gridview`，并且我想链接到另一个*URL + 一个 ID。*

```
<div id="searchResults" runat="server">
    <asp:GridView ID="gvSearchResult" runat="server" AutoGenerateColumns = "false" 
    CaptionAlign="NotSet" CellPadding="5">
    <Columns>
        <asp:TemplateField HeaderText="Användare">
            <ItemTemplate>
                <%# Eval("UName")%>
                <br />
            </ItemTemplate>
        </asp:TemplateField>
        <asp:HyperLinkField DataNavigateUrlFields="UName" 
                            DataNavigateUrlFormatString='/MemberPages/profile.aspx?ID=<%# Eval("PID") %>'
                            DataTextField="UName" 
                            HeaderText="Besök sida" 
                            SortExpression="Name" 
                            ItemStyle-Width="100px"
                            ItemStyle-Wrap="true" />
    </Columns>
    </asp:GridView>
</div> 
```

`gridview`正在使用`datasource`和`databind`。它抱怨：

```
DataNavigateUrlFormatString="/MemberPages/profile.aspx?ID=<%# Eval("PID") %>" 
```

我不确定在哪里使用`<%# Eval("PID") %>`，我确定有 PID 之类的东西，我已经仔细检查过。

如果我正在使用`NavigateUrl="/MemberPages/profile.aspx?ID=<%# Eval("PID") %>"`，我也会得到同样的错误：

```
Literal content ('<asp:HyperLinkField DataNavigateUrlFields="UName" 
                               DataNavigateUrlFormatString="/MemberPages/profile.aspx?ID=') is not allowed within a 'System.Web.UI.WebControls.DataControlFieldCollection'. 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-10T20:35:11.073

如果需要在属性值内使用 "，请使用 ' 作为分隔符

```
Attribute='Some value with " symbol' 
```

如果需要在属性值内使用 '，请使用 "

```
Attribute="Some value with ' symbol" 
```

还要更改您的列定义

```
<asp:HyperLinkField DataNavigateUrlFields="PID" 
                    DataNavigateUrlFormatString="/MemberPages/profile.aspx?ID={0}"
                    DataTextField="UName" 
                    HeaderText="Besök sida" 
                    SortExpression="Name" 
                    ItemStyle-Width="100px"
                    ItemStyle-Wrap="true" /> 
```

在 DataNavigateUrlFormatString 属性中，您使用 DataNavigateUrlFields 中指定的数据列（格式类似于 String.Format 方法）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:29:37.987

我要做的第一件事是替换下面的行

DataNavigateUrlFormatString="/MemberPages/profile.aspx?ID=<%# Eval("PID") %>"

与下面的行

DataNavigateUrlFormatString='/MemberPages/profile.aspx?ID=<%# Eval("PID") %>'

注意我用单引号和开头和结尾替换了双引号。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-15T14:35:39.687

虽然接受的答案确实有效。对于我的情况，我需要使用不同的控件。此示例允许您将 Eval 与 URL 字符串一起使用。

```
<asp:LinkButton PostBackUrl='<%#"~/config.aspx?Id=" + Eval("Id") %>'  runat="server">Configuration</asp:LinkButton> 
```

# mysql - 有效地查找 SQL 中的下一个事件 - 包含所有列

> ID：14266542
> 
> 赞同：0
> 
> 时间：2013-01-10T20:17:46.987
> 
> 标签：mysql, sql, vertica

我找到了找到下一个事件日期的解决方案，但没有找到包含事件所有数据的解决方案。通过作弊，我可以完成它，但这仅适用于 mysql 并且在 vertica 中失败。

这是我要解决的问题：

我想显示所有事件 a 以及来自 a 之后且不是类型 a 的第一个事件 X 的数据。因此，这里是剪切和粘贴示例，因此您可以使用它来查看实际效果：

```
CREATE TABLE events (user_id int ,created_at int, event varchar(20));
INSERT INTO events values (0,0, 'a');
INSERT INTO events values (0,1, 'b');
INSERT INTO events values (0,2, 'c');
INSERT INTO events values (0,3, 'a');
INSERT INTO events values (0,4, 'c');
INSERT INTO events values (0,5, 'b');
INSERT INTO events values (0,6, 'a');
INSERT INTO events values (0,7, 'a');
INSERT INTO events values (0,8, 'd');

SELECT * FROM events;
+---------+------------+-------+
| user_id | created_at | event |
+---------+------------+-------+
|       0 |          0 | a     |
|       0 |          1 | b     |
|       0 |          2 | c     |
|       0 |          3 | a     |
|       0 |          4 | c     |
|       0 |          5 | b     |
|       0 |          6 | a     |
|       0 |          7 | a     |
|       0 |          8 | d     |
+---------+------------+-------+
9 rows in set (0.00 sec) 
```

这是我知道如何同时获得的结果，但我似乎也无法获得其中的事件信息：

```
SELECT user_id, MAX(purchased) AS purchased, spent 
FROM ( 
    SELECT
        e1.user_id AS user_id, e1.created_at AS purchased, 
        MIN(e2.created_at) AS spent
    FROM events e1, events e2
    WHERE
        e1.user_id = e2.user_id AND e1.created_at <= e2.created_at AND
        e1.Event = 'a' AND e2.Event != 'a'
    GROUP BY e1.user_id, e1.created_at
) e3 GROUP BY user_id, spent;

 user_id | purchased | spent 
---------+-----------+-------
       0 |         0 |     1
       0 |         3 |     4
       0 |         7 |     8 
```

现在，如果我也想要其中的事件类型，它不适用于上面的查询，因为您要么必须使用 group-by 中的 event 字段（不是我们想要的），要么使用聚合（不是我们想要的任何一个）。有趣的是，它在 mysql 中有效，但我认为这是作弊，因为我必须为此使用 vertica，所以它对我没有帮助：

```
SELECT user_id, MAX(purchased) as purchased, spent, event FROM (
    SELECT 
        e1.User_ID AS user_id, 
        e1.created_at AS purchased, 
        MIN(e2.created_at) AS spent, 
        e2.event AS event 
    FROM events e1, events e2 
    WHERE 
        e1.user_id = e2.user_id AND e1.created_at <= e2.created_at AND 
        e1.Event = 'a' AND e2.Event != 'a' 
    GROUP BY
        e1.user_id,e1.created_at
 ) e3 GROUP BY user_id, spent;

+---------+-----------+-------+-------+
| user_id | purchased | spent | event |
+---------+-----------+-------+-------+
|       0 |         0 |     1 | b     |
|       0 |         3 |     4 | c     |
|       0 |         7 |     8 | d     |
+---------+-----------+-------+-------+
3 rows in set (0.00 sec) 
```

对于 vertica，相同的查询会引发错误：错误 2640：列“e2.event”必须出现在 GROUP BY 子句中或用于聚合函数中

什么是让这两个事件与其所有列配对并且不作弊的优雅解决方案，以便在 vertica 或其他不允许作弊的数据库中执行时获得与上面所示相同的结果？在示例数据中，我只需要一个额外的列，即事件类型，但在现实世界中，它将是两列或三列。

请在回答之前使用发布的示例数据进行尝试:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:38:13.003

好的，虽然我不是 100% 确定我理解你想要做什么，但看看这是否行不通：

```
SELECT e3.user_id, MAX(e3.purchased) AS purchased, e3.spent, e.event
FROM ( 
    SELECT
        e1.user_id AS user_id, e1.created_at AS purchased, 
        MIN(e2.created_at) AS spent
    FROM events e1, events e2
    WHERE
        e1.user_id = e2.user_id AND e1.created_at <= e2.created_at AND
        e1.Event = 'a' AND e2.Event != 'a'
    GROUP BY e1.user_id, e1.created_at
) e3 
 JOIN events e on e3.user_id = e.user_id and e3.spent = e.created_at
GROUP BY e3.user_id, e3.spent, e.event 
```

本质上，我只是再次加入事件表，假设`user_id`并且`created_at`是您的主键。

这是[SQL Fiddle](http://sqlfiddle.com/#!3/48341/10)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:38:14.087

试试这个...

```
With    Cte As
(
        Select  Row_Number() Over (Partition By [user_id] Order By [created_at]) As row_num,
                [user_id],
                [created_at],
                [event]
        From    [events]
)
Select  c1.[user_id],
        c1.[created_at] As purchased,
        c2.[created_at] As spent,
        c2.[event]
From    Cte c1
Left    Join Cte c2
        On  c1.row_num = c2.row_num - 1
Where   c1.event = 'a'
And     c2.event <> 'a' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:45:55.817

我通常使用相关子查询进行“下一个”计算，然后连接回原始表。在这种情况下，我假设 , 唯一地定义了一行。

这是查询：

```
SELECT user_id, MAX(purchased) as purchased, spent, event
FROM (
    SELECT e.User_ID, e.created_at AS purchased, 
           MIN(enext.created_at) AS spent,
           min(enext.event) AS event 
    FROM (select e.*,
                 (select MIN(e2.created_at)
                  from event e2
                  where e2.user_id = e.user_id and e2.created_at > e.created_at and e2.event <> 'a'
                 ) nextcreatedat
          from events e
          where e.event = 'a'
         ) e left outer join
         events enext
         on e.user_id = enext.user_id and
            e.nextcreatedat = enext.create_at
    GROUP BY e.user_id, e.created_at
    ) e3
 GROUP BY user_id, spent; 
```

聚合`GROUP BY e.user_id, e.created_at`不是必需的，但我将其保留为与原始查询相似。

因为 Vertica 支持累积和，所以有一种方法可以更有效地执行此操作，但它在 MySQL 中不起作用。

# java - Java从文件中删除完整的行

> ID：14266546
> 
> 赞同：1
> 
> 时间：2013-01-10T20:17:57.770
> 
> 标签：java

> **可能重复：**
> [Java - 在文件中查找一行并删除](https://stackoverflow.com/questions/1377279/java-find-a-line-in-a-file-and-remove)

我正在尝试从文本文件中删除一整行，并且如果只有一行没有空格的完整文本行，我已经设法删除了该行。如果我在字符串之间有空格分隔符，则无法删除任何内容。代码如下：

```
import java.io.*;
import java.util.Scanner;

public class removebooks {
     // construct temporary file
    public static void main(String[]args)throws IOException {
    String title;

     Scanner titlerem= new Scanner (System.in);
     System.out.println("Enter Title to remove from file");
     title = titlerem.next ();

     // construct temporary file
     File inputFile = new File("books.txt");
     File tempFile = new File(inputFile + "temp.txt");

     BufferedReader br = new BufferedReader (new FileReader("books.txt"));
     PrintWriter Pwr = new PrintWriter(new FileWriter (tempFile));
     String line = null;

     //read from original, write to temporary and trim space, while title not found
     while((line = br.readLine()) !=null) {
         if(line.trim().equals(title)){
             continue;          }
         else{
             Pwr.println(line);
             Pwr.flush();

         }
     }
     // close readers and writers
     br.close();
     Pwr.close();
     titlerem.close();

     // delete book file before renaming temp
     inputFile.delete();

     // rename temp file back to books.txt
     if(tempFile.renameTo(inputFile)){
            System.out.println("Update succesful");
        }else{
            System.out.println("Update failed");
        }
    }
} 
```

文本文件名为 books.txt，其内容应如下所示：

```
bookone author1 subject1
booktwo author2 subject2
bookthree author3 subject3
bookfour author4 subject4 
```

谢谢您的任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:20:42.947

你为什么不使用

```
if(line.trim().startsWith(title)) 
```

代替

```
if(line.trim().equals(title)) 
```

因为[`equals()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#equals%28java.lang.Object%29)仅当两个字符串相等时才[`startsWith()`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#startsWith%28java.lang.String%29)为真，如果`line.trim()`以`title`;)开头，则为真

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:24:18.317

当您逐行阅读文件时。您可以使用以下

```
 if(line.contains(title)){
     // do something
  } 
```

在这种情况下，您将不受仅标题的限制。

[字符串 API](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:22:09.360

`br.readLine()`将变量的值设置`line`为“bookone author1 subject1”。

`Scanner.next()`由空格分隔。在检查文件中的行之前，您需要将所有对 Scanner.next() 的调用合并到一个字符串中，如果这是您的意图。

在您的情况下，如果您键入“bookone author1 subject1”，`title`则在您调用`Scanner.next()`.

# c++ - 在定义一个条件后总是使用一个类

> ID：14266550
> 
> 赞同：3
> 
> 时间：2013-01-10T20:18:13.187
> 
> 标签：c++, algorithm, logic

我有两个类，一个负责从数据库中获取数据（已经实现），另一个负责从文件中获取数据（现在正在实现）。这里的事情是我希望能够切换流式传输（数据库或文件）。检查是数据库还是文件的过程只需要一次。因此，对于类中的每个方法，我不想每次都检查调用该方法时应该使用什么。现在，我执行以下操作：

```
if(IsDataBaseStream())
    Database::execQuery("SELECT * from table");
else //is FileStream
    File::GetAllFrom("Table"); 
```

这很丑陋。我拒绝这样做。我考虑过回调，但这在不同的类之间不起作用。

有没有办法不浪费这样的处理器工作？

提前致谢

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-10T20:20:22.310

您应该使用[*策略设计模式*](http://en.wikipedia.org/wiki/Strategy_pattern)。为这两个类提供一个公共基础，并使用一个抽象方法获取数据，创建一个指向该基类的指针，然后在一次检查后为该指针分配一个基于文件或基于数据库的实现。

```
struct BaseStream {
    virtual void process();
};
struct FileStream : public BaseStream {
    virtual void process() {
        File::GetAllFrom("Table");
    }
};
struct DBStream : public BaseStream {
    virtual void process() {
        Database::execQuery("SELECT * from table");
    }
};
...
BaseStream *s;
if (IsDataBaseStream()) {
    s = new DBStream;
} else {
    s = new FileStream;
}
...
s -> process(); 
```

# c# - 每隔一定时间运行一次并执行控制台应用程序的 sql 作业

> ID：14266561
> 
> 赞同：2
> 
> 时间：2013-01-10T20:19:06.513
> 
> 标签：c#, console-application, sql-job

我正在尝试编写一个每 10 分钟运行一次的 SQL 作业，并执行我用 C# 编写的控制台应用程序。

如果有人可以提供帮助，那将非常有帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T21:04:37.823

你想要的是一个 SQL Server 代理作业，带有一个 CmdExec 步骤（可以执行 Windows 命令行）。这在这里解释：http: [//msdn.microsoft.com/en-us/library/ms190264.aspx](http://msdn.microsoft.com/en-us/library/ms190264.aspx)

如果安全是一个问题，可以通过使用 SQL 代理代理定义来保护它。这在这里解释：http: [//msdn.microsoft.com/en-us/library/ms189064 (SQL.105).aspx](http://msdn.microsoft.com/en-us/library/ms189064(SQL.105).aspx)

# arrays - 如何删除bash数组中的确切元素？

> ID：14266562
> 
> 赞同：7
> 
> 时间：2013-01-10T20:19:09.803
> 
> 标签：arrays, bash, unset

我试图从 bash 数组中删除任何一个关键字**的第一次出现**。

```
ARRAY=(foo bar and any number of keywords)
keywords=(red, rednet, rd3.0) 
```

我删除了这样的关键字：`ARRAY=( ${ARRAY[@]/"$keyword"/} )`然后如果“red”是第一个找到的关键字，它将从两个关键字中删除“ **red** ”并返回“foo bar net”而不是“foo bar rednet”。

编辑：这是示例，希望这可以使其更清楚。

```
for keyword in ${ARRAY[@]}; do
      if [ "$keyword" = "red" ] || [ "$keyword" = "rd3.0" ] || [ "$keyword" = "rednet" ]; then
           # HERE IS TROUBLE
           ARRAY=( ${ARRAY[@]/"$keyword"/} )
           echo "ARRAY is now ${ARRAY[@]}"
           break
      fi
 done 
```

如果`ARRAY=(red rednet rd3.0)`返回**net rd3.0** 而不是**rednet rd3.0**

如果我使用 unset，：`unset ${ARRAY["$keyword"]}`如果 rd3.0 在数组中，bash 会抱怨：从数组`:syntax error: invalid arithmetic operator (error token is ".0")` 中取消设置或删除完全匹配的安全方法是什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T22:09:39.950

使用`unset`数组值为 at 的命令`index`，如下所示：

```
#!/usr/bin/env bash
ARRAY=(foo bar any red alpha number of keywords rd3.0 and)
keywords=(red, rednet, rd3.0)

index=0
for keyword in ${ARRAY[@]}; do
      if [ "$keyword" = "red" ] || [ "$keyword" = "rd3.0" ] || [ "$keyword" = "rednet" ]; then
           # HERE IS TROUBLE
           # ARRAY=( ${ARRAY[@]/"$p"/} )
           unset ARRAY[$index]
           echo "ARRAY is now: ${ARRAY[@]}"
           break
      fi
      let index++
 done 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:52:44.787

首先：您应该在数组中的键周围使用引号。这避免了例如 rd3.0 的问题。

像那样：

```
ARRAY=("foo" "bar" "and" "any" "number" "of" "keywords")
keywords=("red", "rednet", "rd3.0") 
```

在我看来，您需要复制数组，然后使用 for 循环来过滤关键字。第一次成功过滤后退出for循环。之后将其复制回来，而不使用空数组元素。请参阅[此](http://www.thegeekstuff.com/2010/06/bash-array-tutorial/)简短示例（第 10 段）。

有关数组的更多信息：http: [//tldp.org/LDP/abs/html/arrays.html](http://tldp.org/LDP/abs/html/arrays.html)（您将需要的一切）

# javascript - 用于交换元素的 Javascript 与 CSS

> ID：14266563
> 
> 赞同：1
> 
> 时间：2013-01-10T20:19:11.027
> 
> 标签：javascript, css

我有一个相当长（约 100 个字段）的表单，其中包含在“快速”和“完整”引用之间切换的某些元素。这会将 75 个字段从隐藏切换为可见。目前，我通过一些简单的 jQuery 做到这一点：

```
jQuery('.full_quote').show();
jQuery('.quick_quote').hide(); 
```

我意识到这可以使用 CSS 为我完成工作以不同的方式完成：

```
## Javascript:
  jQuery('#quote_form').toggleClass("full_quote quick_quote");

## CSS:
  form.toggle-form.full_quote .quick_quote {display: none;}
  form.toggle-form.quick_quote .full_quote {display: none;} 
```

**所以大部分问题是：** 在考虑性能时使用哪个更好？

我最初的想法是，在 jQuery 中迭代结果的开销将比 CSS 花费更多的时间。但是，我没有办法对此进行测试，所以我很好奇社区的经验。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:41:05.873

与其定义新的自定义类，或者使用 jQuery[`show`](http://api.jquery.com/show)和[`hide`](http://api.jquery.com/hide)方法，我实际上建议使用第三种选择。

将[`[hidden]`](http://www.w3.org/html/wg/drafts/html/master/single-page.html#the-hidden-attribute)属性添加到需要隐藏的任何元素，并在需要显示时删除该属性：

[JS：]

```
$('.foo').attr('hidden', true); 
```

为确保跨浏览器支持此功能，您需要添加一些 CSS：

[CSS：]

```
[hidden] {
    display: none !important;
    visibility: hidden !important;
} 
```

[这也使您能够覆盖“隐藏”元素的样式，这对于调试很有用。](http://jsfiddle.net/sFsAG/)

当你想显示元素时，只需删除`[hidden]`属性：

[JS：]

```
$('.foo').attr('hidden', false); 
```

如果 jQuery 实现`show`并`hide`使用`[hidden]`，那就太好了，相反，开发人员在使用时需要小心，因为它会在添加样式内联时`show`覆盖任何样式表声明。`display``display`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:26:55.180

两者本质上是一样的。JQuery 在内部执行非常相似的相同逻辑。（请参阅[jquery 的显示/隐藏功能如何工作？](https://stackoverflow.com/questions/8970184/how-does-jquerys-show-hide-function-work)）。它不像你的 CSS apprach 根本不使用 javascript（在这种情况下，这将是更好的选择）

所以，

```
jQuery('.full_quote').show();
jQuery('.quick_quote').hide(); 
```

有道理（无论如何你都在使用 JQuery，为什么不使用它的所有功能）更具可读性，并且

# java - 令牌上的语法错误，应改为 variableDeclarator

> ID：14266565
> 
> 赞同：5
> 
> 时间：2013-01-10T20:19:15.980
> 
> 标签：java, android, syntax

```
SQLiteDatabase db = this.getWritableDatabase();
ContentValues cv = new ContentValues();
  cv.put(colDeptID, 1);
  cv.put(colDeptName, "Sales");
  db.insert(deptTable, colDeptID, cv);

  cv.put(colDeptID, 2);
  cv.put(colDeptName, "IT");
  db.insert(deptTable, colDeptID, cv);
                    db.close(); 
```

使用此代码，在放入每一行并收到此错误后，我在括号下得到一个红色下划线：令牌“（”上的语法错误，删除此令牌。

我还收到一条错误消息：令牌上的语法错误，应使用 variableDeclarator。有任何想法吗？我已经尝试了我所知道的一切，但都没有奏效。

编辑：我在“关闭”时也收到语法错误，此令牌后应有标识符

我从教程中复制并粘贴了这段代码，所有评论都说它有效，但我遇到了很多问题。感谢您的快速回复。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T21:46:57.983

只有声明，例如：

```
SQLiteDatabase db = this.getWritableDatabase();
ContentValues cv = new ContentValues(); 
```

可以直接在类声明中。非声明，例如：

```
 cv.put(colDeptID, 1);
  cv.put(colDeptName, "Sales");
  db.insert(deptTable, colDeptID, cv); 
```

必须在方法、构造函数、初始化程序块或静态初始化程序块内。在这种情况下，它们可能应该在构造函数或方法中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-22T19:45:00.030

通过变量声明器 ID，它意味着类似**int**或**string**的东西。示例：`int randomnum = 9`或类似的东西。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-04-06T07:44:30.347

Put the code inside a method and not directly inside the class.

Like

```
SomeRandomMethod(){
SQLiteDatabase db = this.getWritableDatabase();
ContentValues cv = new ContentValues();
  cv.put(colDeptID, 1);
  cv.put(colDeptName, "Sales");
  db.insert(deptTable, colDeptID, cv);

  cv.put(colDeptID, 2);
  cv.put(colDeptName, "IT");
  db.insert(deptTable, colDeptID, cv);
                    db.close();
} 
```

# javascript - 将 jsonp 转换为 json

> ID：14266570
> 
> 赞同：5
> 
> 时间：2013-01-10T20:19:40.477
> 
> 标签：javascript, json, jquery, jsonp

这是我的代码

```
$.ajax({
    type: "GET",
    url: "http://example.com?keyword=r&callback=jsonp",
    success: function (data) {
        alert(data);
    },
    dataType: "jsonp",
    error: function (xhr, errorType, exception) {
        var errorMessage = exception || xhr.statusText;
        alert("Excep:: " + exception + "Status:: " + xhr.statusText);
    }
}); 
```

好的，所以上面的代码工作正常，我得到一个 jsonp 的数据。现在我不知道如何将 jsonp 转换为 json。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:27:45.587

本文可能会给您一些额外的指导：[Basic example of using .ajax() with JSONP?](https://stackoverflow.com/questions/5943630/basic-example-of-using-ajax-with-jsonp)

您能否提供一个请求返回的数据结构的示例？

在您的特定情况下，您可能可以执行类似于以下的操作。让我知道结果如何：

```
// Create the function the JSON data will be passed to.
function myfunc(json) {
  alert(json);
}

$.ajax({
  type: "GET",
  url: "http://example.com?keyword=r&callback=jsonp",
  dataType: 'jsonp',
  jsonpCallback: 'myfunc', // the function to call
  jsonp: 'callback', // name of the var specifying the callback in the request
  error: function (xhr, errorType, exception) {
    var errorMessage = exception || xhr.statusText;
    alert("Excep:: " + exception + "Status:: " + xhr.statusText);
  }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T22:03:34.893

> 现在我不知道如何将 jsonp 转换为 json。

那是没有意义的。您想要的是一个可以使用的普通 javascript 对象，并且您已经拥有它 ( `data`)。

* * *

**JSONP**是一个脚本文件，其中使用对象文字调用函数。文字看起来像*JSON*，而函数（其名称是动态生成的）是*padding*。

**JSON**是一个文件/字符串，其中包含[*JavaScript Object Notation*](http://json.org/)中的数据，这是一种常见的序列化格式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:23:21.900

如果您收到来自 的警报`alert(data)`，则它已经被转换。你应该得到`[object Object]`which 应该告诉你你有一个 JavaScript 对象。现在您可以像访问任何其他 JavaScript 对象一样访问它的属性。

```
alert(data.foo); 
```

它也可能是一个数组，具体取决于返回的 json。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:23:36.967

你需要一个功能：

```
function jsonp(data){
    // do stuff with data here
} 
```

返回数据时自动调用该函数/

# java - 从sqlite android获取所有记录

> ID：14266575
> 
> 赞同：10
> 
> 时间：2013-01-10T20:19:52.267
> 
> 标签：java, android, sqlite

我正在创建一个数据库，我需要从数据库中读取所有记录，但是我的程序在这个语句中不断崩溃：

```
newWord= db.getAllRecords(); 
```

我认为 getAllRecords() 存在问题，因为 Eclipse 表示没有错误。

```
 public Cursor getAllRecords() {
 db = dBHelper.getWritableDatabase();//obtains the writable database
return db.query(DATABASE_TABLE, new String[] { KEY_ROWID,KEY_WORD}, null, null, null,      null, null);//the query used to obtain all records form the table

} 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-01-10T20:25:54.247

这是我从表格中获取所有内容的方法..

```
public ArrayList<MyObject> getAllElements() {

    ArrayList<MyObject> list = new ArrayList<MyObject>();

    // Select All Query
    String selectQuery = "SELECT  * FROM " + MY_TABLE;

    SQLiteDatabase db = this.getReadableDatabase();
    try {

        Cursor cursor = db.rawQuery(selectQuery, null);
        try {

            // looping through all rows and adding to list
            if (cursor.moveToFirst()) {
                do {
                    MyObject obj = new MyObject();
                    //only one column
                    obj.setId(cursor.getString(0));

                    //you could add additional columns here..

                    list.add(obj);
                } while (cursor.moveToNext());
            }

        } finally {
            try { cursor.close(); } catch (Exception ignore) {}
        }

    } finally {
         try { db.close(); } catch (Exception ignore) {}
    }

    return list;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-12-08T16:39:16.863

```
public void printTableData(String table_name){
    SQLiteDatabase db = getReadableDatabase();

    Cursor cur = db.rawQuery("SELECT * FROM " + table_name, null);

    if(cur.getCount() != 0){
        cur.moveToFirst();

        do{
            String row_values = "";

            for(int i = 0 ; i < cur.getColumnCount(); i++){
                row_values = row_values + " || " + cur.getString(i);
            }

            Log.d("LOG_TAG_HERE", row_values);

        }while (cur.moveToNext());
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-09-04T11:36:14.123

```
Initialize TABLE:
    private static String TABLE="your_table_name"; 
```

要获取所有记录的列表，请将以下方法写入您的数据库类：

```
public ArrayList<RecentStickerModel> getAllRecentRecords() {

    ArrayList<RecentStickerModel> listStickers = new ArrayList<>();

    SQLiteDatabase db = getWritableDatabase();

    String q = "SELECT name from sqlite_master WHERE type='table' AND name='" + TABLE + "'";
    Cursor cursorTable = db.rawQuery(q, null);

    if (cursorTable != null && cursorTable.moveToFirst()) {

        String tableName = cursorTable.getString(0);
        cursorTable.close();

        if (TABLE.equals(tableName)) {

            String query = "Select * from " + TABLE ;

            Cursor cursor = db.rawQuery(query, null);

            if (cursor != null && cursor.moveToFirst()) {

                Logger.e(TAG, "cursor size:" + cursor.getCount());

                int catNameCI = cursor.getColumnIndex(KEY_CAT_NAME);
                int imagePathCI = cursor.getColumnIndex(KEY_IMAGE_PATH);
                int lastStickerTimeCI = cursor.getColumnIndex(KEY_LAST_STICKER_TIME);

                do {

                    RecentStickerModel model = new RecentStickerModel();
                    model.setCatName(cursor.getString(catNameCI));
                    model.setImgStickerPath(cursor.getString(imagePathCI));
                    model.setLastStickerTime(cursor.getString(lastStickerTimeCI));

                    listStickers.add(model);
                } while (cursor.moveToNext());

                cursor.close();
            }
        }

        db.close();
    }

    return listStickers;
} 
```

然后在需要的地方调用以下方法：

```
arrayListRecent=stickersListDatabase.getAllRecentRecords(); 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-12-06T16:23:45.553

```
Cursor c = ourDatabase.rawQuery("SELECT * FROM table_name", null);
        if(c!=null){
            c.moveToFirst();
        }
        return c; 
```

# java - Jersey 提供一个空的 JSON

> ID：14266578
> 
> 赞同：1
> 
> 时间：2013-01-10T20:20:14.163
> 
> 标签：java, json, jersey

我正在为大学做一个项目，这让我很生气。我需要用 jersey 开发一个 web 服务，但每个请求都只向我发送这个空 JSON：

```
[{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{},{}] 
```

数据库查询是测试并交付内容。我只是不知道它可能是什么。

爪哇：

```
@Path("/getFachbereiche")
public class GetFachbereiche {
    @GET
    @Produces("application/json")
    public Fachbereich[] getFachbereiche() {
        List<Fachbereich>fList = new ArrayList<Fachbereich>();
        Connection conn = MySQLConnection.getInstance();
        if (conn != null) {
            try {
                // Anfrage-Statement erzeugen.
                Statement query;
                query = conn.createStatement();

                // Ergebnistabelle erzeugen und abholen.
                String sql = "SELECT * FROM Fachbereich";
                ResultSet result = query.executeQuery(sql);

                //Ergebniss zurückliefern
                while (result.next()) {
                    fList.add(new Fachbereich(result.getInt(1), result.getString(2)));
                }
            } catch(SQLException e) {
                e.printStackTrace();
            }
        }
        return fList.toArray(new Fachbereich[fList.size()]);
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T20:53:04.870

您来自 Fachbereich 的属性是私有的，默认情况下，私有属性未序列化。你有两个解决方案：

*   将 XmlElement 注释放在每个属性上，以便将其序列化

*   或者为每个属性定义一个公共 getter。

# objective-c - 将头文件和主文件链接到故事板 xcode

> ID：14266580
> 
> 赞同：1
> 
> 时间：2013-01-10T20:20:20.670
> 
> 标签：objective-c, xcode

我对 xcode 很陌生，对于我的一生，我无法弄清楚这一点。我正在向情节提要添加一个视图控制器，并且我正在尝试向该控制器添加一个选择器，我在我创建的头文件和主文件中有代码，但是如何将这些文件链接到情节提要中的视图控制器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:34:52.440

方法如下：

*   为您的代码创建自定义 UIViewController 子类，例如 MyViewController.h 和 MyViewController.m

*   在情节提要中拖出一个 ViewController

（我认为你已经完成了这两个步骤）

*   在 Identity Inspector（左侧实用程序面板的面板 3）中，在“自定义类”下，您应该在滚动列表中看到您的类。选择它。

然后，您将希望在情节提要中的选择器和代码之间建立链接....

# matlab - 在mathematica中带有颜色图的Matlab冲浪之类的情节？

> ID：14266581
> 
> 赞同：1
> 
> 时间：2013-01-10T20:20:21.543
> 
> 标签：matlab, wolfram-mathematica

我想向社区寻求帮助，以使用 Mathematica 中的颜色图创建类似 Matlab 的 3D 冲浪图。为了使问题更具体，假设我们在 3D 空间中有一组数字，并且为每个点分配了一些函数值 c：

```
{{x1,y1,z1,c1},{x2,y2,z2,c2},...,{xN,yN,zN,cN}} 
```

这些点位于 3D 表面上，例如球体。现在在 matlab 中，如果这些点被正确地表示为矩阵`X`, `Y`, `Z`，`C`我们可以简单地绘制这个表面

```
k = 5;
n = 2^k-1;
[x,y,z] = sphere(n);
c = magic(2^k);
surf(x,y,z,c);
colormap gray
axis equal 
```

这里重要的是可以通过颜色条读取绘图的函数值。

现在社区的问题是：

我们可以在 Mathematica 中制作这样的图吗（带有颜色条 - 这是重要的部分）？？？

我在网上搜索了一个没有运气的解决方案。我查看了 , 之类的东西`ListPlot3D`，但是对于这些函数`ListSurfacePlot3D`，`ListPointPlot3D`您只能传递一个没有相应点值的表面（除非有一些我不明白的东西）。

有谁知道解决方案，一种在 Wolfram Mathematica 中创建此类图的方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:33:57.920

您可以使用`ColorFunction`指定颜色函数：

```
ParametricPlot3D[{Sin[t] Cos[f], Sin[t] Sin[f], Cos[t]}, {t, 0, Pi}, {f, 0, 2 Pi} , 
 ColorFunction -> Function[{x, y, z, t, f}, RGBColor[z]]] 
```

![阴谋](../Images/a207e8088a4b59682945e6bbb2e35dfe.png)

另一种方法是使用纹理；我将使用您通过其他软件生成的数据。

```
{x, y, z, c} = Import["/tmp/sphere.mat"]; 
```

我们要应用的纹理是`c`（实际旋转了90度）

```
ArrayPlot[c] 
```

![质地](../Images/2d6413156c4b3aec913adce34c5e13be.png)

```
ParametricPlot3D[{Sin[t] Cos[f], Sin[t] Sin[f], Cos[t]}, {t, 0, Pi}, {f, 0, 2 Pi}, 
  PlotStyle -> Texture[ Rotate[ArrayPlot[c], Pi/2]], Lighting -> "Neutral"] 
```

![球体M](../Images/9447a662b1020454d132d31b0d03fb81.png)

# android - 在android中绘制箭头

> ID：14266584
> 
> 赞同：0
> 
> 时间：2013-01-10T20:20:26.727
> 
> 标签：android, android-layout, shapes

> **可能重复：**
> [如何绘制箭头（在 Android 中）？](https://stackoverflow.com/questions/6713757/how-do-i-draw-an-arrowhead-in-android)

我正在尝试在android中制作一个不错的布局布局，为此我想用一个箭头连接两个视图，看起来很像这样：

![一只忙碌的猫](../Images/87f0e4647828d9e950945a2ee361b909.png)

所以在箭头的开头应该有一个视图，在箭头的尖端也是如此。

实现这一目标的最佳方法是什么？最简单的只是使用图像吗？但是，例如，我无法更改 android 中箭头的颜色。我能以某种方式用形状做到这一点吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T20:52:02.027

您可以使用 Canvas，并创建自己的“箭头”视图，它不是太难，只需使用正确的坐标绘制线条，或创建一个路径。

扩展`View`类，并覆盖`onDraw(Canvas c)`，然后你应该画你的线条

```
Paint paint = new Paint(); 
```

……

```
public void onDraw(Canvas c){
            Path path = new Path();
            path.setFillType(Path.FillType.EVEN_ODD);
            path.moveTo(insideRectangleOffset, getHeight() - insideRectangleOffset);
            path.lineTo(getWidth() - insideRectangleOffset, insideRectangleOffset);
            path.lineTo(getWidth() - insideRectangleOffset, getHeight() - insideRectangleOffset);
            path.lineTo(insideRectangleOffset, getHeight() - insideRectangleOffset);
            path.close();

            c.drawPath(path, paint);
} 
```

根据需要替换坐标，我已经从我创建的视图中复制粘贴了代码

# javascript - Javascript 表单验证无法通过 LightCMS

> ID：14266592
> 
> 赞同：0
> 
> 时间：2013-01-10T20:20:57.657
> 
> 标签：javascript, forms, content-management-system

所以我正在粘贴一些来自 Salesforce 的表单代码。

这段代码要具体：（**从样式元素到表单末尾）** [https://gist.github.com/13ab0efd07c2c8cdb3e1](https://gist.github.com/13ab0efd07c2c8cdb3e1)

在未填写任何或所有字段的情况下单击提交时，我会收到表单验证检查，然后会弹出一条消息，其中包含我尚未填写的字段。

但是，当我将代码粘贴到我们的 LightCMS 模板中时，表单验证不起作用，只是重定向到感谢页面，好像一切正​​常。

他们使用 LightCMS。即使链接到外部 js 文件而不是嵌入 js，我仍然得到相同的结果。

我注意到它在前端的提交按钮上添加了一个“onclick”元素，但它只在 CMS 中而不是在基本的 HTML 页面上时才会这样做。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:35:40.073

我认为你应该添加这个

```
onsubmit=return formvalidator(Document.getElementByid(search-form)) 
```

在表单操作之前，因为它会在提交之前检查表单。如果检查失败，则不会发生该操作。

# c# - 创建和存储会话

> ID：14266593
> 
> 赞同：0
> 
> 时间：2013-01-10T20:21:00.297
> 
> 标签：c#, asp.net, session

我正在为我的网站上的用户登录创建一个会话。我可以初始化会话并很好地使用它的成员，但我还需要在我的会话类中使用一个方法来存储自己。我需要提供`HttpSessionState`作为输入参数，然后将其存储到一个对象中，例如：`Session["sessionName"]=this;`.

此外，当我想检索会话时，它还没有被创建，所以它必须是静态的。然后我需要返回我的会话类的一个新实例，其中填充了属性（用户名和公司 ID）`HttpSessionState`。

如何在我的课程中做到这一点？我上面描述的内容来自我所做的研究，它为我的问题提供了一个特定的解决方案，但是由于我是使用 session 的新手，所以我不太了解它。谢谢。

我的课程片段：

```
public class MySession : System.Web.UI.Page
    {
        private MySession()
        {
            Username    = Business.User.labelUsername;
            CompanyId   = Business.User.labelCompanyId;
        }

        public static MySession Current
        {
            get
            {
                try
                {
                    MySession session = (MySession)HttpContext.Current.Session["sessionName"];

                    if (session == null)
                    {
                        session = new MySession();
                        HttpContext.Current.Session["sessionName"]=session;
                    }
                    return session;
                }
                catch (NullReferenceException e)
                {
                    Debug.WriteLine("NullReferenceException:");
                    Debug.WriteLine(e);
                }
                return null;
            }
        }

        public string Username
        {
            get; set;
        }

        public string CompanyId
        {
            get; set;
        }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:32:11.543

您可以尝试使用序列化的“会话信息”对象：

```
[Serializable]
public class SessionInfo
{
    // Stuff to store in session
    public string Name { get; set; }
    public int Foo { get; set; }

    private SessionInfo()
    {
        // Constructor, set any defaults here
        Name = ""
        Foo = 10;
    }

    public static SessionInfo Current
    {
        get
        {
            // Try get session info from session
            var info = HttpContext.Current.Session["SessionInfo"] as SessionInfo;

            // Not found in session, so create and store new session info
            if (info == null)
            {
                info = new SessionInfo();
                HttpContext.Current.Session["SessionInfo"] = info;
            }

            return info;
        }
    }
} 
```

然后，您可以在您的应用程序中使用它，如下所示：

```
SessionInfo.Current.Name = "Something Here";
SessionInfo.Current.Foo = 100; 
```

序列化/反序列化都是在 SessionInfo 对象中完成的，您可以获得类型安全数据的好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:25:26.977

你问的是所谓的序列化和反序列化。

序列化是获取一个对象并将其转换为可以存储的格式，例如字符串。反序列化与该操作相反。

“快速”的方法是将`[Serializable]`属性添加到您的类中。但是，如果不知道该类的详细信息，就很难说它是否真的很容易序列化而不需要一点工作。

这是一个演练：http: [//msdn.microsoft.com/en-us/library/vstudio/et91as27.aspx](http://msdn.microsoft.com/en-us/library/vstudio/et91as27.aspx)

# java - 有关 Spring MVC 中 @RequestMapping 中的 producer 属性的一些信息

> ID：14266595
> 
> 赞同：3
> 
> 时间：2013-01-10T20:21:22.153
> 
> 标签：java, spring, spring-mvc, annotations

在 Spring MVC Showcase 示例中（可从 STS 仪表板下载）我有以下情况。

在我看来，我有以下链接：

```
 <li>
            <a id="responseCharsetProduce" class="textLink" href="<c:url value="/response/charset/produce" />">@ResponseBody (UTF-8 charset produced)</a>
        </li> 
```

此链接生成一个对 URL 的 HTTP 请求：**“/response/charset/produce”**

好的，这个 HTTP 请求由控制器类的以下方法处理（我的控制器类本身用 @RequestMapping(value="/response", method=RequestMethod.GET 注释，所以这个方法处理了这个请求）：

```
@RequestMapping(value="/charset/produce", produces="text/plain;charset=UTF-8")
public @ResponseBody String responseProducesConditionCharset() {
    return "\u3053\u3093\u306b\u3061\u306f\u4e16\u754c\uff01 (\"Hello world!\" in Japanese)";
} 
```

我的怀疑与@RequestMapping 注释中的**生产元素有关......**

在这里阅读：http: [//static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/bind/annotation/RequestMapping.html](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/web/bind/annotation/RequestMapping.html)

说：**String[] 产生映射请求的可生产媒体类型，缩小主映射。**所以它似乎只说该方法产生的媒体类型......在我的具体情况下，说控制器方法返回的媒体类型是文本值......

但是在其他地方阅读时，我发现生产属性不包括 HTTP 请求，其 Accepts 标头与指定的媒体类型不兼容...

那么......究竟是什么在@RequestMapping 中产生了属性？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:30:56.430

“produces”条件表示该方法将返回什么。如果客户端没有指定 Accept 标头，那么没有什么可以阻止该方法返回它所能返回的内容。

博客作者在下面的 url 中就您的问题发表了一些评论。

[http://spring.io/blog/2011/06/13/spring-3-1-m2-spring-mvc-enhancements](http://spring.io/blog/2011/06/13/spring-3-1-m2-spring-mvc-enhancements)

# android - 从 Android 光标流式传输行

> ID：14266596
> 
> 赞同：3
> 
> 时间：2013-01-10T20:21:22.213
> 
> 标签：android, sqlite, cursor

我有一个 SQLite 表（超过 100000 行），我希望它的行流式传输。

我愿意：

```
Cursor cursor = db.rawQuery("SELECT _id FROM hugetable", new String[] {}); 
```

问题在于，仅将第一行设为：

```
cursor.moveToFirst() 
```

似乎加载了整个表，速度很慢。

有没有办法在获取第一行时无需等待加载所有行就可以流式传输查询？

（就像我可以在 Android 之外使用普通的 C SQLite API 一样）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:50:11.473

Android`Cursor`旨在加载所有数据以进行缓存。

要解决此问题，您必须按步骤手动查询数据：

```
SELECT _id
FROM hugetable
ORDER BY _id
LIMIT 100;

SELECT _id
FROM hugetable
WHERE _id > last_id_from_previous_query
ORDER BY _id
LIMIT 100; 
```

# android - Android Fragment 未替换 onPostExecute AsyncTask

> ID：14266598
> 
> 赞同：0
> 
> 时间：2013-01-10T20:21:31.737
> 
> 标签：android, tabs, android-asynctask

我正在尝试从 asynctask 类中替换一个片段 onPostExecute 方法，但它不会替换任何东西。这是我的标签监听器类：

```
public class TabListener implements ActionBar.TabListener
{
    protected ParentActivity parent;
    public FragmentTransaction fragmentTransaction;
    public ItemData item = new ItemData();

    public TabListener(ParentActivity parent)
    {
        this.parent = parent;
    }

    @Override
    public void onTabSelected(Tab tab, FragmentTransaction ft) {

        this.fragmentTransaction = ft;

        if(this.parent.isNetworkAvailable())
        {
            //ft.replace(android.R.id.content, new LoadingFragment());

            if(tab.getPosition() == 0)
            {
                new HttpData().execute(ParentActivity.centroUri);

            }
            else
            {
                new HttpData().execute(ParentActivity.nvomxliUri);
            }
        }
        else
        {
            ft.replace(android.R.id.content, new NetworkFragment());
        }

    }

    @Override
    public void onTabUnselected(Tab tab, FragmentTransaction ft) {
        // TODO Auto-generated method stub

    }

    @Override
    public void onTabReselected(Tab tab, FragmentTransaction ft) {
        // TODO Auto-generated method stub

    }

    private class HttpData extends AsyncTask<String, Void, String> {

        @Override
        protected String doInBackground(String... urls) {
            Parser p = new Parser();
            p.run(urls[0], item);
            return "";
        }

        @Override
        protected void onPostExecute(String result) {
            fragmentTransaction.replace(android.R.id.content, new LaneFragment(item));
        }

    }
} 
```

我确认执行了 onPostExecute 方法并按预期检索了所需的数据。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:29:41.680

您是否尝试在 PostExecute 中创建新的片段事务？您正在使用 onTabSelected 发送给您的相同事务，但我认为该事务在该方法结束时已提交。

```
 FragmentTransaction fragmentTransaction = mFragmentMgr.beginTransaction();

    // Add fragment to the container ContentView 
    fragmentTransaction.replace(R.id.fragment, tag);

    fragmentTransaction.addToBackStack(null);

    // Commit transaction
    fragmentTransaction.commit(); 
```

# android - 登录表单问题

> ID：14266601
> 
> 赞同：-2
> 
> 时间：2013-01-10T20:21:49.397
> 
> 标签：android

我对android编程有疑问。我是这方面的新手，所以不要评判。

我建立了一个登录表单，当我尝试登录时，我进入了用户名文本框 java.lang.NullPointerException。这是代码：

```
import java.util.ArrayList;
import org.apache.http.NameValuePair;
import org.apache.http.message.BasicNameValuePair;
import android.app.Activity;
import android.os.Bundle;
import android.view.View; 
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;
import android.content.Context;
import android.content.Intent;

public class Login extends Activity {
EditText un,pw;
TextView error;
Button ok;
Button reg;
private static Context context;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_login);
    un=(EditText)findViewById(R.id.editText1);
    pw=(EditText)findViewById(R.id.editText2);
    ok=(Button)findViewById(R.id.button1);
    reg=(Button)findViewById(R.id.button2);
    ok.setOnClickListener(new View.OnClickListener() {

        public void onClick(View v) {

                            // TODO Auto-generated method stub

    ArrayList<NameValuePair> postParameters = new ArrayList<NameValuePair>();
    postParameters.add(new BasicNameValuePair("username", un.getText().toString()));

    postParameters.add(new BasicNameValuePair("password", pw.getText().toString()));

    String response = null;

    try {

    response = CustomHttpClient.executeHttpPost("<HTTP Request site>", postParameters);

    String res=response.toString();

    res= res.replaceAll("\\s+","");

    if(res.equals("1")) { 
        error.setText("Welcome to ...");
        Intent i = new Intent(context, Welcome.class);
        startActivity(i);
    }

    else

    error.setText("Sorry!! Incorrect Username or Password");

    } catch (Exception e) {

    un.setText(e.toString());

                    }
                }
            });
        }
    } 
```

我有什么问题或错误。请帮我。或者只是给我一些指示。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:24:30.683

记住也要初始化你的`error`TextView :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:24:31.653

您收到错误消息，因为您的 TextView`error`从未初始化。将以下行添加到您的`onCreate()`:

```
error=(TextView)findViewById(R.id.<textView_ID); 
```

# c++ - 错误 C2039：“uninitialized_fill”：不是“std”的成员

> ID：14266606
> 
> 赞同：-1
> 
> 时间：2013-01-10T20:22:11.137
> 
> 标签：c++

我还处于学习 C++ 的早期阶段，并且正在使用课程。用我自己的类重新创建向量的功能后，下一步是使用我的新 Vec 类创建我自己的字符串版本。我想我太新了，不知道所有这些#includes 是如何相互作用的，但是在搜索了许多类似的问题之后，似乎我只是在某个地方错过了一个。但这对我来说没有意义，因为我认为我在需要的地方包含了正确的标题。

**字符串**

```
#ifndef GUARD_Str_h
#define GUARD_Str_h

#include <algorithm>
#include <iterator>

#include "Vec.h"

class Str {
public:
    typedef Vec<char>::size_type size_type;

    Str() { }

    Str(size_type n, const char& val): data(n, val) { }

    Str(const char* cp) {
        std::copy(cp, (cp + std::strlen(cp)), std::back_inserter(data));
    }
private:
    Vec<char> data;
};

#endif 
```

**向量**

```
#ifndef GUARD_Vec_h
#define GUARD_Vec_h

#include <cstring>
#include <memory>
#include <algorithm>

template <class T> class Vec {
public:
    typedef T* iterator;
    typedef const T* const_iterator;
    typedef size_t size_type;
    typedef T value_type;
    typedef std::ptrdiff_t difference_type;
    typedef T& reference;
    typedef const T& const_reference;

    Vec() { create(); } //constructor
    explicit Vec(size_type n, const T& val = T()) { create(n, val); } //constructor
    Vec(const Vec& v) { create(v.begin(), v.end()); } //copy constructor
    ~Vec() { uncreate(); } //deconstructor

    size_type size() const { return (avail - data); }

    void push_back(const T&);

    T& operator[](size_type i) { return data[i]; }
    const T& operator[](size_type i) const { return data[i]; }

    Vec& operator=(const Vec&);

    iterator begin() { return data; }
    const_iterator begin() const { return data; }
    iterator end() { return avail; }
    const_iterator end() const { return avail; }
private:
    iterator data;  //first element in the Vec
    iterator avail; //one past the last element in the Vec
    iterator limit; //one past the last availible space in the Vec

    std::allocator<T> alloc;

    void create();
    void create(size_type, const T&);
    void create(const_iterator, const_iterator);

    void uncreate();

    void grow();
    void unchecked_append(const T&);
};

template <class T> Vec<T>& Vec<T>::operator=(const Vec& v)
{
    if (v != this) {
        uncreate();

        create(v.begin(), v.end());
    }
    return *this;
}

template <class T> void Vec<T>::push_back(const T& val)
{
    if (avail == limit)
        grow();
    unchecked_append(val);
}

template <class T> void Vec<T>::create()
{
    data = avail = limit = 0;
}

template <class T> void Vec<T>::create(size_type n, const T& val)
{
    data = alloc.allocate(n);
    limit = avail = (data + n);
    std::unintialized_fill(data, avail, val);
}

template <class T> void Vec<T>::create(const_iterator beg, const_iterator end)
{
    data = alloc.allocate(end - beg);
    limit = avail = std::uninitialized_copy(beg, end, data);
}

template <class T> void Vec<T>::uncreate()
{
    if (data) {
        iterator iter = avail;
        while (iter != data)
            alloc.destroy(--iter);

        alloc.deallocate(data, (limit - data));
    }
    data = avail = limit = 0;
}

template <class T> void Vec<T>::grow()
{
    size_type new_size = std::max((2 * (limit - data)), difference_type(1));

    iterator new_data = alloc.allocate(new_size);
    iterator new_avail = std::uninitialized_copy(data, limit, new_data);

    uncreate();

    data = new_data;
    avail = new_avail;
    limit = (data + new_size);
}

template <class T> void Vec<T>::unchecked_append(const T& val)
{
    alloc.construct(avail++, val);
}

#endif 
```

在我编写 Str 类之前，当我刚刚测试我的 Vec 类时，一切正常。我包含了 Vec.h 并且可以使用我的 Vec 代替向量。

现在有了我创建的这个新的 Str 类，我将在我的主源文件中包含 Str.h，当我编译时，它抱怨 std::uninitialized_copy 不是 std 的成员。我知道它是在**内存**标头中定义的，无论我将包含放在哪里，都无法弄清楚如何让它看到它。我确定我只是在类与#includes 交互的方式上做错了，但我是新手。如果有人可以提供帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T20:26:52.033

`std::unintialized_fill`不存在。你想在**t**之前`std::uninitialized_fill`加上**i**。

# git - 重置后Git repo不会收集垃圾--hard

> ID：14266615
> 
> 赞同：2
> 
> 时间：2013-01-10T20:22:43.583
> 
> 标签：git, bitbucket

我刚开始玩 Git，想知道一个具体案例：

我错误地进行了重提交，更糟糕的是，我将其推送到了远程服务器。

现在我试图让事情恢复到原来的样子，使用`git reset --hard v1.0`and `git push -f origin master`.

这样做之后看起来还不错，但是当我查看 repo 文件大小时，它仍然和我的错误提交一样大。即使我尝试**git gc**进行垃圾收集，我也没有成功。在这种情况下，如果我想故意进行破坏性更改，我应该怎么做？

任何提示表示赞赏！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:26:48.000

您可能已经更改了历史记录，但是您尚未清除的是 reflog。

如果您键入：

```
git reflog 
```

你会看到你的“大提交”仍然存在。默认情况下，如果无法访问所有条目，则保留 30 天，如果可访问，则保留 90 天（通过历史记录）。

例如，您可以尝试使用`git reflog --expire-unreachable=1.minute`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:27:11.347

您必须使您回绕的分支的 reflog 和 HEAD reflog 过期，然后 gc 可以收集现在无法访问的提交：

```
git reflog expire --expire=now HEAD <branches which contained said commit>
git gc 
```

reflog 是 Git 的安全机制，它跟踪以前的分支状态，因此在发出不正确的 git reset 命令或运行虚假的 rebase 时，您不会立即丢失数据，无论多么时髦。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T14:06:56.747

我重复了我在开始时说的步骤，制作了一个新的 repo 克隆，现在很好。感谢你们！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-10T20:31:39.470

最简单的解决方案是再次克隆存储库。但是，如果您的存储库很大，则可能需要很长时间。要删除文件而不再次克隆项目，您可以等待一段时间让 git 自动删除文件或使用以下命令强制删除：

```
git reflog expire --all --expire-unreachable=0
git repack -A -d
git prune 
```

# android - 关于发布提要，facebook 3.0 示例

> ID：14266620
> 
> 赞同：1
> 
> 时间：2013-01-10T20:22:56.600
> 
> 标签：android, facebook

所以我遵循了 facebook 开发网站中的教程页面，我有这个代码：

```
 import android.os.Bundle;
    import android.support.v4.app.FragmentActivity;
    import android.view.Menu;

        public class MainActivity extends FragmentActivity {

        private MainFragment mainFragment;

        @Override
        public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    if (savedInstanceState == null) {
        // Add the fragment on initial activity setup
        mainFragment = new MainFragment();
        getSupportFragmentManager().beginTransaction()
                .add(android.R.id.content, mainFragment).commit();
    } else {
        // Or set the fragment from restored state info
        mainFragment = (MainFragment) getSupportFragmentManager()
                .findFragmentById(android.R.id.content);
    }
    }

        @Override
    public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
    } 
```

## }

这是片段类

```
 import java.util.Arrays;
    import java.util.Collection;
    import java.util.List;

    import org.json.JSONException;
    import org.json.JSONObject;

    import android.content.Intent;
    import android.os.Bundle;
    import android.support.v4.app.Fragment;
    import android.util.Log;
    import android.view.LayoutInflater;
    import android.view.View;
    import android.view.ViewGroup;
    import android.widget.Button;
    import android.widget.Toast;

    import com.facebook.FacebookRequestError;
    import com.facebook.HttpMethod;
    import com.facebook.Request;
    import com.facebook.RequestAsyncTask;
    import com.facebook.Response;
    import com.facebook.Session;
    import com.facebook.SessionState;
    import com.facebook.UiLifecycleHelper;
    import com.facebook.widget.LoginButton;

    public class MainFragment extends Fragment {

    private static final List<String> PERMISSIONS = Arrays.asList("publish_actions");
    private static final String PENDING_PUBLISH_KEY = "pendingPublishReauthorization";
    private boolean pendingPublishReauthorization = false;
    private UiLifecycleHelper uiHelper;
    private Button shareButton;

        private Session.StatusCallback callback = new Session.StatusCallback() {
    @Override
    public void call(Session session, SessionState state,
            Exception exception) {
        onSessionStateChange(session, state, exception);
    }
    };
    protected String TAG;

    @Override
    public void onResume() {
    super.onResume();
    Session session = Session.getActiveSession();
    if (session != null && (session.isOpened() || session.isClosed())) {
        onSessionStateChange(session, session.getState(), null);
    }
    uiHelper.onResume();
    }

    @Override
    public void onActivityResult(int requestCode, int resultCode, Intent data) {
    super.onActivityResult(requestCode, resultCode, data);
    uiHelper.onActivityResult(requestCode, resultCode, data);
    }

        @Override
    public void onPause() {
    super.onPause();
    uiHelper.onPause();
    }

    @Override
    public void onDestroy() {
    super.onDestroy();
    uiHelper.onDestroy();
    }

        @Override
    public void onSaveInstanceState(Bundle outState) {
        super.onSaveInstanceState(outState);
        outState.putBoolean(PENDING_PUBLISH_KEY, pendingPublishReauthorization);
        uiHelper.onSaveInstanceState(outState);
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    uiHelper = new UiLifecycleHelper(getActivity(), callback);
    uiHelper.onCreate(savedInstanceState);
  } 

  @Override
  public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    View view = inflater.inflate(R.layout.activity_main, container, false);
    LoginButton authButton = (LoginButton) view.findViewById(R.id.authButton);
    shareButton = (Button) view.findViewById(R.id.shareButton);
    shareButton.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            publishStory();        
        }
    });
    authButton.setFragment(this);

    return view;
  }

  private void onSessionStateChange(Session session, SessionState state,Exception exception) {
    if (state.isOpened()) {
        shareButton.setVisibility(View.VISIBLE);
        if (pendingPublishReauthorization && 
                state.equals(SessionState.OPENED_TOKEN_UPDATED)) {
            pendingPublishReauthorization = false;
            publishStory();
        }

    } else if (state.isClosed()) {
        shareButton.setVisibility(View.INVISIBLE);
    }
}

private void publishStory() {
    Session session = Session.getActiveSession();
    Log.i(TAG,session.toString());
    if (session != null){

        // Check for publish permissions    
        List<String> permissions = session.getPermissions();
        if (!isSubsetOf(PERMISSIONS, permissions)) {
            pendingPublishReauthorization = true;
            Session.NewPermissionsRequest newPermissionsRequest = new Session
                    .NewPermissionsRequest(this, PERMISSIONS);
        session.requestNewPublishPermissions(newPermissionsRequest);
            return;
        }

        Bundle postParams = new Bundle();
        postParams.putString("name", "Facebook SDK for Android");
        postParams.putString("caption", "Build great social apps and get more installs.");
        postParams.putString("description", "The Facebook SDK for Android makes it easier and faster to develop Facebook integrated Android apps.");
        postParams.putString("link", "https://developers.facebook.com/android");
        postParams.putString("picture", "https://raw.github.com/fbsamples/ios-3.x-howtos/master/Images/iossdk_logo.png");

        Request.Callback callback= new Request.Callback() {
            public void onCompleted(Response response) {
                JSONObject graphResponse = response
                                           .getGraphObject()
                                           .getInnerJSONObject();
                String postId = null;
                try {
                    postId = graphResponse.getString("id");
                } catch (JSONException e) {
                    Log.i(TAG,
                        "JSON error "+ e.getMessage());
                }
                FacebookRequestError error = response.getError();
                if (error != null) {
                    Toast.makeText(getActivity()
                         .getApplicationContext(),
                         error.getErrorMessage(),
                         Toast.LENGTH_SHORT).show();
                    } else {
                        Toast.makeText(getActivity()
                             .getApplicationContext(), 
                             postId,
                             Toast.LENGTH_LONG).show();
                }
            }
        };

        Request request = new Request(session, "me/feed", postParams, 
                              HttpMethod.POST, callback);

        RequestAsyncTask task = new RequestAsyncTask(request);
        task.execute();
    }

}
private boolean isSubsetOf(Collection<String> subset, Collection<String> superset) {
    for (String string : subset) {
        if (!superset.contains(string)) {
            return false;
        }
    }
    return true;
} 
```

## }

所以我有所有代码在这两个页面中工作的意思 [https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/](https://developers.facebook.com/docs/howtos/androidsdk/3.0/login-with-facebook/) 和 [https://developers.facebook.com/docs /howtos/androidsdk/3.0/publish-to-feed/](https://developers.facebook.com/docs/howtos/androidsdk/3.0/publish-to-feed/)

出于某种原因，我可以登录，已经完成，但是现在当我单击共享时，它只会一直加载，直到我的 android 设备因为被冻结而要求我关闭应用程序，日志猫说 facebook.katana 没有响应，所以我该如何解决这个问题。与应用仪表板中的权限有关吗？或者有什么问题。我需要知道我是否做错了什么。在我重新开始并重新开始之前。

更新：将近 24 小时后，我终于在我的墙上收到了张贴的消息，所以这似乎是可行的，但 Facebook 有时似乎没有反应。

# c - 堆栈一遍又一遍地循环

> ID：14266630
> 
> 赞同：0
> 
> 时间：2013-01-10T20:23:42.530
> 
> 标签：c, stack

我被困在 C 中做堆栈。如果有人能帮助我，我将不胜感激。这是我的代码：

标题

```
typedef struct stackEl stackEl;
typedef struct Task Task;
struct stackEl{
     struct Task *zad;
     struct stackEl *last;
};

struct Task{
   int x;
   int y;
}; 
```

来源

```
void add(stackEl *main, Task *adding)
{
   stackEl tmp;
   tmp.last= main;
   tmp.zad = adding;
   *main=tmp;
} 
```

这个通过一个一个地指向彼此而不是将单个元素添加到堆栈来创建无限数量的元素。我不知道如何修复它。我试图这样做：

```
void add(stackEl *main, Task *adding )
{
   stackEl *tmp;
   tmp = (stackEl*)malloc(sizeof(stackEl));
   tmp->last= main;
   tmp->zad = adding;
   main=tmp;
} 
```

使用此方法元素被添加到堆栈顶部，但它不会修改主函数中的堆栈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:27:51.547

第二个版本更接近真相。您需要像您一样为添加到堆栈中的每个元素分配内存。仍然请注意，在第二个版本中，您只修改指针的本地副本，而不是实际更改此指针。您应该将指针传递给指针（即`StackE1**`），然后执行`*main = tmp`.

# c# - 如果删除了与事件关联的控件，是否会从内存中删除事件处理程序？

> ID：14266632
> 
> 赞同：2
> 
> 时间：2013-01-10T20:23:50.423
> 
> 标签：c#, wpf, event-handling, dynamic-usercontrols

在 WPF 中，我创建了一个为我动态创建按钮的控件。在某些情况下，按钮可能会更改并且需要重新创建。我目前正在使用以下内容：

```
public void GenerateButtons()
{
    WrapPanel_Main.Children.Clear();

    foreach (ActivatedItem thisItem in Controller.ItemList.Where(sl => sl.IsTypeCompatible(typeof(ActivatedItem))))
    {
        Button newButton = new Button() { Content = thisItem, ToolTip = thisItem.Desc, Width = 50, Height = 25 };
        newButton.Click += new System.Windows.RoutedEventHandler(this.DynamicButtonClick);
        WrapPanel_Main.Children.Add(newButton);
    }
} 
```

我想知道`WrapPanel_Main.Children.Clear();`我的代码部分是否足以从内存中删除按钮和事件，或者我是否让东西（如事件处理程序）漂浮在那里？

与往常一样，我也愿意接受有关改进上面显示的代码的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T21:05:40.463

简而言之，您无需担心这一点。

当您将事件处理程序附加到该事件处理程序未使按钮保持活动状态的按钮时，该按钮将使事件处理程序引用的任何内容保持活动状态。事件处理程序正在引用您的窗口，因此在按钮离开内存之前，您基本上无法从内存中清除窗口。由于按钮的寿命比窗口长并没有任何意义，因此不会发生这种情况。

换句话说，您需要注意的情况是事件处理程序中使用的项目的寿命需要比拥有该事件的类短。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T21:17:02.027

正如@Servy 提到的，它可能不需要分离这些处理程序，但如果你真的想要我能想到的唯一方法是使用`Reflection`.

这是一个基于您的问题的小示例（WrapPanel 中按钮的按钮单击事件）

```
public void RemoveButtonClickHandlers(UIElementCollection elements)
{
    foreach (var button in elements.OfType<Button>())
    {
        try
        {
            var handlers = typeof(UIElement).GetProperty("EventHandlersStore", BindingFlags.Instance | BindingFlags.NonPublic).GetValue(button, null);
            if (handlers != null)
            {
                var clickEvents = (RoutedEventHandlerInfo[])handlers.GetType()
                .GetMethod("GetRoutedEventHandlers", BindingFlags.Instance | BindingFlags.Public | BindingFlags.NonPublic)
                .Invoke(handlers, new object[] { ButtonBase.ClickEvent });
                foreach (var clickEvent in clickEvents)
                {
                    button.Click -= (RoutedEventHandler)clickEvent.Handler;
                }
            }
        }
        catch (Exception ex)
        {
            // :(
        }
    }
} 
```

用法：

```
RemoveButtonClickHandlers(WrapPanel_Main.Children);
WrapPanel_Main.Children.Clear(); 
```

# c# - WPF | 窗体主机 | 浏览器 | 上下文菜单

> ID：14266635
> 
> 赞同：0
> 
> 时间：2013-01-10T20:24:16.087
> 
> 标签：c#, wpf, windowsformshost

我正在尝试编写一个应用程序，用户可以在其中突出显示浏览器中的文本并通过上下文菜单标记内容。我有一个 WPF 应用程序，我将 WindowsFormHost 与 Windows 窗体 WebBrowser 一起使用，因此我可以有一个自定义上下文菜单。我的问题是我无法触发 Click 事件。

难道我做错了什么？

```
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitalizeComponent();            
        System.Windows.Forms.WebBrowser Browser = new System.Windows.Forms.WebBrowser();              
        Browser.IsWebBrowserContextMenuEnabled = false;
        System.Windows.Forms.ContextMenu BrowserContextMenu = new System.Windows.Forms.ContextMenu();       
        System.Windows.Forms.MenuItem MenuItem = new System.Windows.Forms.MenuItem();
        MenuItem.Text = "Take Action";             
        MenuItem.Click += new System.EventHandler(this.MenuItem_Click);
        BrowserContextMenu.MenuItems.Add(MenuItem);
        Browser.ContextMenu = BrowserContextMenu;
        WindowsFormsHost.Child(Browser);               
    }

    //THIS DOESN'T FIRE!?!?!?
    private void MenuItem_Click(object sender, EventArgs e)
    {
        MessageBox.Show("Click!");
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-30T17:16:51.367

将所有内容移至 Main_Loaded 并且可以正常工作

# python - 使用 eval() 函数，如何评估 python 中观察代码的表达式

> ID：14266642
> 
> 赞同：3
> 
> 时间：2013-01-10T20:24:41.507
> 
> 标签：python, eval

我正在使用 python 创建一个简单的调试器，并尝试在表达式成立时创建断点。我正在使用 eval 函数来评估该表达式。但它不起作用。

```
def traceit(frame, event, trace_arg):
    if event == 'line':
        if(eval('x == 5')):
             print 'stop here'

def fn():
    #the variable x is defined and used here

sys.settrace(traceit)
fn()
sys.settrace(None) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:29:07.277

您需要将字典作为参数传递给函数`locals`（以便它知道是什么！- 否则它只是在猜测，它会选择不是函数上下文的本地上下文）`globals``eval``x``fn`

`f_locals`您可以分别从和`f_globals`属性中的堆栈框架对象获取局部值和全局值。

我想你可能想要这样的东西：

```
eval('x == 5',frame.f_locals,frame.f_globals) 
```

作为旁注，您可能实际上不需要`eval`这种（静态）案例：

```
if frame.f_locals.get('x') == 5:
   print "stop here" 
```

* * *

这是一些“工作”代码（即它在正确的位置打印“停在这里”）：

```
import sys

def traceit(frame, event, trace_arg):
    if event == 'line':
        if 'x' in frame.f_locals or 'x' in frame.f_globals:
            if(eval('x == 5',frame.f_locals,frame.f_globals)):
                print 'stop here'
    return traceit

sentinel = object()
def trace_no_eval(frame, event, trace_arg):
    if event == 'line':
        value = frame.f_locals.get('x',frame.f_globals.get('x',sentinel))
        if value is not sentinel and value == 5:
            print 'stop here'
    return traceit

def fn():
    for x in range(10):
        print x

sys.settrace(traceit)
fn()
sys.settrace(trace_no_eval)
fn()
sys.settrace(None) 
```

正如你所说，这是一个作业，*请不要盲目复制*。花时间去理解它，真正理解发生了什么。

# jquery - jQuery提交带有多个数组的ajax

> ID：14266645
> 
> 赞同：1
> 
> 时间：2013-01-10T20:24:54.830
> 
> 标签：jquery, ajax, nested, associative-array, serializearray

您好我正在尝试在[Validate](https://github.com/jzaefferer/jquery-validation "证实")的 submitHandler 中使用 ajax 提交表单，同时使用美化多个选择的[Chosen](http://harvesthq.github.com/chosen/)库。以下作品：

```
submitHandler: function(form) {
    var     form = $(this.currentForm);

    var     data = {
        first_name    : form.find('#first_name').attr('value'),
        last_name     : form.find('#last_name').attr('value'),
        chosen_people : form.find('#chosen_people').val(),
    };

    $.ajax({
        type : "POST",
        url : "formhandler.php",
        data : data,
        success : function(response) {
            console.log(response);
        }
    });
} 
```

服务器响应：

```
array(
    ['first_name'] => 'John'
    ['last_name'] => 'Smith'
    ['chosen_people'] => array(
        [0] => 37
        [1] => 42
    )
) 
```

问题是我的表单很大并且经常更改，我不想继续枚举所有输入和选择元素。我只想说：

```
var     inputs = form.find('input').serializeArray();
var     selects = form.find('.chzn-select').val();
var     data = $.merge(inputs, selects );

... 
```

我已经尝试过手动输入的各种组合，例如：

```
for(var select in selects)
    selects[select] = {'name' : select, 'value' : selects[select]};

var     serializedSelects = {'name' : 'chosen_people', 'value' : selects };
var     data = $.merge(inputs, serializedSelects); 
```

但我只是无法让数组正确嵌套，以便服务器在其 post 变量中具有正确的数组结构。

问题的要点是，尽管 jQuery 为元素提供了 $.serializeArray()，但它没有提供类似 $.paramArray() 的东西来获取关联数组并将其转换为序列化数组。它只能输出序列化的字符串，很难进一步操作。我不想包含另一个 ajax 框架，所以希望有一个简单的解决方案。

PS 我正在使用 php5 和 jQuery 1.8.3。这是我到目前为止所发现的，也许我只是在尝试添加它之前弄乱了选择数组的格式：

[带有序列化和额外数据的 jQuery post()](https://stackoverflow.com/questions/6627936/jquery-post-with-serialize-and-extra-data)

[如何序列化 JavaScript 关联数组？](https://stackoverflow.com/questions/6438596/how-to-serialize-a-javascript-associative-array)

[Jquery.SerializeArray 如何添加更多参数呢？](https://stackoverflow.com/questions/13318999/jquery-serializearray-how-to-add-more-parameters-to-it)

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:45:51.673

你需要的是序列化你的主表单本身：

```
$('form').submit(function() {
  var data = $(this).serialize();
  e.preventDefault();
$.ajax({
    type : "POST",
    url : "formhandler.php",
    data : data,
    success : function(response) {
        console.log(response);
    }
});
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T23:54:36.420

我不确定为什么这对我来说如此痛苦，但我终于找到了如何为 ajax 格式化数组。数组被 urlencoded 的方式让我震惊。我不确定深度嵌套是否真的得到普遍支持。以下是 ajax 可以采用的各种版本的数组数据：

```
var     associativeData = {'first_name' : 'John', 'last_name' : 'Smith', 'chosen_people' : Array('37', '42')};
var     nameValueData = Array(
    {'name' : 'first_name', 'value' : 'John'},
    {'name' : 'last_name', 'value' : 'Smith'},
    {'name' : 'chosen_people[0]', 'value' : 37},
    {'name' : 'chosen_people[1]', 'value' : 42}
);
var     serializedData = "first_name=John&last_name=Smith&chosen_people[]=37&chosen_people[]=42" 
```

这对我来说是附加我自己的数组的方法。if(values) 行是可选的，但没有它， else 情况永远不会触发，因此如果未选择任何内容，您根本不会在服务器上获得 selected_people var：

```
var     data = form.find('input').serializeArray();
var     values = form.find('#chosen_people').val();
if(values)
for(var value in values)
    data.push({'name' : 'chosen_people[' + value + ']', 'value' : values[value]});
else
    data.push({'name' : 'chosen_people[]', 'value' : ''}); 
```

只是发布这个答案，希望它可以帮助某人。

# kendo-ui - 在未绑定到数据源的 KendoGrid 中创建列

> ID：14266647
> 
> 赞同：3
> 
> 时间：2013-01-10T20:25:06.487
> 
> 标签：kendo-ui

我正在使用 Kendo UI 将数据源绑定到 Kendo Grid。我正在尝试找到在*未*绑定到数据源的网格中创建列的最佳方法。

目前，我正在数据源中创建一个字段，并在从远程端点读取数据后使用一些 javascript 和 jQuery 设置该列的值。

数据源：

```
schema: {
    model: {
        fields: {
            blah: {},
            empty_column: {}
        }
    }
} 
```

网格：

```
columns: {
    field: "empty_column",
    width: 100,
    title: "Empty"
} 
```

Javascript：

```
datasource.data[item].set("empty_column", computed_value); 
```

为简洁起见编辑了所有代码，一切正常。

**我的问题**：有没有办法为这个未连接到远程端点的新空列设置 defaultValue？当我设置：

```
empty_column: {defaultValue: "None"} 
```

网格仍然显示“未定义”，我认为是因为它在读取操作中没有接收到该字段的任何数据。有没有办法在网格中设置默认值？我没见过这样的例子...

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T21:11:20.730

`defaultValue`在您创建记录时应用，而不是在将要显示的时候应用。

你可以做：

**选项 1：**`parse`在 其中使用[`schema.fields.fieldName`](http://docs.kendoui.com/api/framework/model#modeldefine)将是这样的。

```
model: {
    fields: {
        empty_column: {
            type        : "string",
            defaultValue: "none",
            parse       : function (data) {
                if (!data.empty_columns) {
                    data.empty_column = "none";
                }
                return data;
            }
        },
        blah        : { type: "number" }
    }
}, 
```

**选项 2：**用于[`schema.parse`](http://docs.kendoui.com/api/framework/datasource#schemaparse-function)添加额外的字段值。

```
 schema: {
                model: {
                    fields: {
                        empty_column: {type: "string", defaultValue: "none"},
                        blah        : { type: "number" }
                    }
                },
                parse: function (response) {
                    $.each(response, function (idx, item) {
                        if (!item.empty_column) {
                            item.empty_column = "none";
                        }
                    });
                    return response;
                }
            } 
```

当然，（对于这两个选项）如果您确实知道其中没有先前的值，则`empty_column`可以保存测试条件并仅保留分配。

# php - 如何使用表单在 symfony 2 中编辑用户权限？

> ID：14266648
> 
> 赞同：5
> 
> 时间：2013-01-10T20:25:07.173
> 
> 标签：php, symfony, symfony-2.1, fosuserbundle

我在 symfony 2 + FOSUserBundle 中创建新/编辑用户表单时遇到问题。我想让管理员从下拉列表或单选按钮列表中选择用户角色，但我似乎无法让它工作。我在这里找到了这个答案[How can I pass a full security roles list/hierarchy to a FormType class in Symfony2?](https://stackoverflow.com/questions/10517452/how-can-i-pass-a-full-security-roles-list-hierarchy-to-a-formtype-class-in-symfo) 这是我能找到的最相关的事情，但它不起作用。

这是当前的 UserType 表单。我想从容器中获取角色，但如果不引发错误，我似乎也无法让它工作。角色将正确填充下拉列表，但不会显示当前分配的角色，并且不允许更新信息，因为它期望它是一个数组`$entity->addRoles(array('ROLE_SUPER_ADMIN'));`，但它只是作为字符串提交。

```
namespace Wes\AdminBundle\Form;

use Symfony\Component\Form\AbstractType;
use Symfony\Component\Form\FormBuilderInterface;
use Symfony\Component\OptionsResolver\OptionsResolverInterface;

class UserType extends AbstractType
{
    private $roles;

    public function __construct($roles) {
        $this->roles = $roles;
    }

    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        $builder
            ->add('username')
            ->add('email')
            ->add('enabled')
            ->add('roles', 'choice', array(
               'choices' => $this->flattenArray($this->roles),
            ))
            ->add('firstName')
            ->add('lastName')
        ;
    }

    public function setDefaultOptions(OptionsResolverInterface $resolver)
    {
        $resolver->setDefaults(array(
            'data_class' => 'Wes\AdminBundle\Entity\User',
            'roles' => null,
            'userRole' => null,
        ));
    }

    public function getName()
    {
        return 'wes_adminbundle_usertype';
    }

    private function flattenArray(array $data)
    {
        $returnData = array();

        foreach($data as $key => $value)
        {
            $tempValue = str_replace("ROLE_", '', $key);
            $tempValue = ucwords(strtolower(str_replace("_", ' ', $tempValue)));
            $returnData[$key] = $tempValue;
        }
        return $returnData;
    }
} 
```

这是控制器。

```
public function editAction($id)
{
    $em = $this->getDoctrine()->getManager();

    $entity = $em->getRepository('WesAdminBundle:User')->find($id);
    if (!$entity) {
        throw $this->createNotFoundException('Unable to find User entity.');
    }

    $editForm = $this->createForm(new UserType($this->container->getParameter('security.role_hierarchy.roles')), $entity);
    $deleteForm = $this->createDeleteForm($id);

    return $this->render('WesAdminBundle:User:edit.html.twig', array(
        'entity'      => $entity,
        'edit_form'   => $editForm->createView(),
        'delete_form' => $deleteForm->createView(),
    ));
}

/**
 * Edits an existing User entity.
 *
 */
public function updateAction(Request $request, $id)
{
    $em = $this->getDoctrine()->getManager();

    $entity = $em->getRepository('WesAdminBundle:User')->find($id);

    if (!$entity) {
        throw $this->createNotFoundException('Unable to find User entity.');
    }

    $deleteForm = $this->createDeleteForm($id);
    $editForm = $this->createForm(new UserType($this->container->getParameter('security.role_hierarchy.roles')), $entity);
    $editForm->bind($request);

    if ($editForm->isValid()) {
        $em->persist($entity);
        $em->flush();

        return $this->redirect($this->generateUrl('wes_admin_user_edit', array('id' => $id)));
    }

    return $this->render('WesAdminBundle:User:edit.html.twig', array(
        'entity'      => $entity,
        'edit_form'   => $editForm->createView(),
        'delete_form' => $deleteForm->createView(),
    ));
} 
```

我已经为此奋斗了几天，我似乎无法让它正常工作。有什么想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T12:20:27.960

使用 FOSUserBundle 提供的 userManager 而不是自定义的持久化方法，因为角色数组在存储到数据库之前需要序列化。

```
$userManager = $this->container->get('fos_user.user_manager');
$user = $userManager->findUserBy(array('id' => $id));

$editForm = $this->createForm(new UserType($this->container->getParameter('security.role_hierarchy.roles')), $user);

if ($editForm->isValid()) {
    $userManager->updateUser($user);

    return $this->redirect($this->generateUrl('wes_admin_user_edit',
        array('id' => $id)));
} 
```

有关更多信息，请参阅[https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/user_manager.rst](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Resources/doc/user_manager.rst)（已编辑）。

# algorithm - 从两组匹配对的算法

> ID：14266649
> 
> 赞同：11
> 
> 时间：2013-01-10T20:25:17.423
> 
> 标签：algorithm, set

我有两组，每组都是一对数字的列表

```
Set1 =[(x1, y1), (x2, y2), ..., (xN, yN)]
Set2 =[(a1, b1), (a2, b2), ..., (aN, bN)] 
```

如果在 XY 平面上绘制，Set1 和 Set2 具有相同的基本形状，但是 set2 的数据点是 set1 的旋转/平移/缩放/噪声/倾斜版本。每组内的对的顺序是随机的。有没有一种有效的方法来确定 set1 中的哪些点对应于 set2 中的对应点？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T20:32:01.763

您正在寻找一系列算法，试图最小化两个点云之间的差异。这是一个相当难解决的问题，并且可以有多种解决方案（例如，如果给您两个立方体，则有许多可能的旋转有效）。

一种特别流行的方法是[ICP（迭代最近点）算法](http://en.wikipedia.org/wiki/Iterative_closest_point)，它从候选猜测开始并不断对其进行改进，直到达到某个正确性标准或时间到期。这可能是一个很好的起点。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:35:56.360

是的，假设只有旋转、缩放和平移可以做到这一点（除了“噪声”和“倾斜”部分，我不确定）。

一种方法：

1.  确定每组的质心（2D 平均值）。
2.  确定每组的最小二乘 (2D) 斜率。
3.  确定每组的 2D 方差。
4.  重新映射第一组，使用 Centroid Difference to Translate、Slope Difference to Rotate(*) 和 Variance Difference to Scale，这样两个集合现在具有相同的 Centroid、Slope 和 Variance。
5.  对两组进行排序，然后比较点的相等性/相似性。（或者，您可以在它们之间进行 RSM（均方根）差异作为“噪声”/差异的度量）。

（*-请注意，反射和/或对称性可能会导致旋转部分出现问题。）

# google-api-ruby-client - 尝试使用我的应用程序中的特定客户端登录

> ID：14266653
> 
> 赞同：0
> 
> 时间：2013-01-10T20:25:30.600
> 
> 标签：google-api-ruby-client

所以我正在使用 google-api-ruby-client 制作一个谷歌分析应用程序，我想每次都使用特定用户登录，而不是每次都重定向到 oauth。我的问题是：有没有办法将该客户端的登录名/密码插入到代码中，这样当我使用该应用程序时，我不必授权任何东西？

这是进行autentication的代码：

```
class TokenPair
    attr_accessor :id
    attr_accessor :refresh_token
    attr_accessor :access_token
    attr_accessor :issued_at

    def initialize
      @@id ||= 1
      self.id = @@id
      @@id += 1
    end

    def self.get(id)
      @@els ||= {}
      tp = @@els.fetch(id, TokenPair.new)
      @@els[tp.id] = tp
    end

    def update_token!(object)
      self.refresh_token = object.refresh_token
      self.access_token = object.access_token
      #self.expires_in = object.expires_in
      self.issued_at = object.issued_at
    end

    def to_hash
      {
          refresh_token: refresh_token,
          access_token: access_token,
          #    expires_in: expires_in,
          issued_at: issued_at ? Time.at(issued_at) : ''
      }
    end
  end

  def logout
    reset_session
    redirect_to root_url
  end

  def logged_in?

    if session["token_id"]
      redirect_to profile_path
    end

  end

  def login

    logged_in?

  end

  def self.params
    @@params
  end

  def update_token
    @client = Google::APIClient.new
    @client.authorization.client_id = '209273986197.apps.googleusercontent.com'
    @client.authorization.client_secret = '6sCG5ynCiz9Ej07pwIm653TU'
    @client.authorization.scope = 'https://www.googleapis.com/auth/analytics.readonly'
    @client.authorization.redirect_uri = callback_url
    @client.authorization.code = params[:code] if params[:code]
    logger.debug session.inspect
    if session[:token_id]
      # Load the access token here if it's available
      token_pair = TokenPair.get(session[:token_id])
      @client.authorization.update_token!(token_pair.to_hash)
    end
    if @client.authorization.refresh_token && @client.authorization.expired?
      @client.authorization.fetch_access_token!
    end
    @analytics = @client.discovered_api('analytics', 'v3')
    unless @client.authorization.access_token || request.path_info =~ /^\/oauth2/
      redirect_to authorize_path
    end
  end

  def authorize
    redirect_to @client.authorization.authorization_uri.to_s, :status => 303
  end

  def callback
    begin
      @client.authorization.fetch_access_token!
      # Persist the token here
      token_pair = TokenPair.get(session[:token_id])
  token_pair.update_token!(@client.authorization)
  session[:token_id] = token_pair.id
  redirect_to profile_url
rescue ArgumentError
  redirect_to root_url
end
end

def get_web_properties
result = @client.execute(
    api_method: @analytics.management.profiles.list,
    parameters: {accountId: "~all", webPropertyId: "~all"}
#parameters: {accountId: "582717"}
)
result.data
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-15T00:58:30.150

即使您的应用程序始终充当同一个用户，出于各种原因，OAuth 仍然是首选机制 - 更容易撤销访问，在妥协的情况下限制访问，不推荐使用客户端登录身份验证机制等。

默认情况下，客户端将请求离线访问，这使您可以无限期地刷新访问令牌，而不必每次都经过完整的 oauth 流程。您可以简单地对应用授权一次，保存刷新令牌，当它过期时，只需调用 fetch_access_token！再次。如果您使用的是最新版本的库，如果令牌过期，客户端将自动尝试刷新令牌，因此您需要注意的是刷新令牌的初始授权和存储。

# algorithm - 动态规划优化，凸包

> ID：14266656
> 
> 赞同：0
> 
> 时间：2013-01-10T20:25:41.937
> 
> 标签：algorithm, dynamic-programming, convex-hull

比赛中问了一个问题。我已经用动态编程及其复杂性解决了这个问题`O(n^2)`。但我正在寻找更有效的方法。我已经看到动态编程可以使用凸包进行优化。你有什么建议吗。谢谢指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-27T04:56:22.577

您可能指的是动态编程的凸包技巧： [http ://wcipeg.com/wiki/Convex_hull_trick](http://wcipeg.com/wiki/Convex_hull_trick)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T12:49:01.810

[凸包算法](http://en.wikipedia.org/wiki/Convex_hull_algorithms)中列出了几种不同复杂度的算法。

# flash - SoundCloud 小部件和 Flash wmode

> ID：14266657
> 
> 赞同：1
> 
> 时间：2013-01-10T20:25:43.817
> 
> 标签：flash, soundcloud, wmode

SoundCloud HTML5 小部件嵌入为`<iframe>`.，但如果浏览器不支持所需的 HTML5 组件，它将回退到使用 Flash。不幸的是，Flash 播放器上没有`wmode`设置属性，到目前为止，我一直无法获得回退来设置`wmode`或者`transparent`使用`opaque`代码

```
<iframe wmode="opaque" width="100%" height="166" scrolling="no" frameborder="no" 
    src="https://w.soundcloud.com/player/?
    url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F42072385%3Fsecret_token%3Ds-
    awcrN&amp;color=ff6600&amp;auto_play=false&amp;show_artwork=true&amp;wmode=opaque">
</iframe> 
```

使用 Vimeo 播放器时，`wmode`在父级上设置属性`<iframe>`会导致后备 Flash 使用 set `wmode`，在 YouTube URL 上设置 GET 参数会导致 Flash 播放器使用 set `wmode`。这些技术似乎都不适用于 SoundCloud。是否可以`wmode`在使用 SoundCloud HTML5 播放器时设置 Flash 后备，或者我应该自己编写功能检测来处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T10:17:21.260

你不能`wmode`在`<iframe>`标签上设置。flash fallback 不会用 flash 对象替换 iframe，但它只是使用 flash 作为音频渲染引擎。要获得透明的 iframe，请尝试`<iframe ... ALLOWTRANSPARENCY="true"></iframe>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T10:36:37.607

不幸的是，Flash 小部件目前不支持此选项。

# c++ - 如何使 cv::namedWindow 在 OpenCV2 中成为焦点？

> ID：14266659
> 
> 赞同：6
> 
> 时间：2013-01-10T20:25:46.217
> 
> 标签：c++, opencv

这是我的应用程序的简化版本：

```
Mat img = imread("./picture.png");
namedWindow("Picture", CV_WINDOW_AUTOSIZE);
imshow("Picture", img);
waitKey(0); 
```

当我执行编译后的应用程序（在 MacOS 10.8.2 和 OpenCV 2.4.3 上）时，窗口在终端窗口下方打开并且不在焦点上。所以，我必须先点击（或进入）它，然后可以按任意键`waitKey`来完成。

是否可以`cv::namedWindow`自动对焦？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T12:58:09.597

您可能可以枚举所有窗口并将它们的标题与您自己的窗口标题进行比较。我不确定如何在 MacOS 中执行此操作，但在 Windows 下，有一个 API 可以为您完成这项工作：EnumWindows()。

由于 OpenCV 2.x 仍然支持许多旧的 C 风格函数，您可能可以检查是否仍然包含 cvGetWindowHandle()。

# mongodb - 聚合框架 - 将 Unix 时间戳转换为 ISODate

> ID：14266667
> 
> 赞同：5
> 
> 时间：2013-01-10T20:26:43.993
> 
> 标签：mongodb, aggregation-framework

假设我有一个包含这样的对象的集合，其中 ts 属性包含一个 Unix 时间戳。

```
{ 
  "_id" : ObjectId("50ef1e0f1e816a74ad835a5a"), 
  "ts" : 1357851660 
} 
```

有没有办法使用聚合框架将 ts 字段转换为 ISODate，所以我可以使用日期运算符（$dayOfYear，$dayOfMonth，...）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-18T13:14:19.233

我能找到的所有信息和测试都表明这在 MongoDB 2.2.2 中是不可能的。不过，使用 Map/Reduce 实现起来相当容易。

将此标记为已回答，因为这似乎是目前可用的最佳答案，但如果向 MongoDB 添加新功能以支持这一点，或者如果有人提出了一个好的解决方法，我愿意在未来对此进行审查。

# javascript - Javascript 计算超过 99,000

> ID：14266668
> 
> 赞同：-3
> 
> 时间：2013-01-10T20:26:43.983
> 
> 标签：javascript

我有这个计算器根据销售额计算估计溢价。它工作正常，除了当我达到 99,000 以上时，它突然开始计算我为 24,999 及以下定义的恒定速率。有谁知道为什么会发生这种情况？这是代码。

```
function updatesurchargetotal() {
    document.rater.surchargetotal.value = (document.rater.subtotaltotal.value -0) * (document.rater.surcharge.value -0);
}
function updatepremium() {
    document.rater.premium.value = (document.rater.subtotaltotal.value -0) + (document.rater.surchargetotal.value -0);
}
function updatetax() {
    if (document.rater.state.value=="8" || document.rater.state.value=="29") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="32" || document.rater.state.value=="42") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="6") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="35" || document.rater.state.value=="36" || document.rater.state.value=="37" || document.rater.state.value=="47" || document.rater.state.value=="52" || document.rater.state.value=="56") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="13") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="50") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="18" || document.rater.state.value=="21" || document.rater.state.value=="24" || document.rater.state.value=="23" || document.rater.state.value=="22" || document.rater.state.value=="28" || document.rater.state.value=="34" || document.rater.state.value=="38" || document.rater.state.value=="39" || document.rater.state.value=="46" || document.rater.state.value=="55") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="30" || document.rater.state.value=="40") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="3") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="10") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="26" || document.rater.state.value=="31" || document.rater.state.value=="53") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="5" || document.rater.state.value=="15" || document.rater.state.value=="16" || document.rater.state.value=="49") {
    document.rater.tax.value = 0;
    }
    else if (document.rater.state.value=="27" || document.rater.state.value=="33" || document.rater.state.value=="45" || document.rater.state.value=="48") {
    document.rater.tax.value = 0;
    }
    else {
    document.rater.tax.value = 0;
    }
}
function updatetaxtotal() {
    document.rater.taxtotal.value = (document.rater.tax.value -0) * (document.rater.premium.value -0);
}
function updatetotal() {
    document.rater.total.value = Math.round(((document.rater.premium.value -0) + (document.rater.taxtotal.value -0) + 0) * 100)/100;
}

//SALES FUNCTIONS

function updatesalespremium() {
    if (document.rater.sales.value > "0" && document.rater.sales.value <= "24999") {
    document.rater.sales_premium.value = (525)
    ;
    }
    else if (document.rater.sales.value > "24999" && document.rater.sales.value <= "50000") {
    document.rater.sales_premium.value = (document.rater.sales.value / 1000)*25;
    }
    else if (document.rater.sales.value > "50000" && document.rater.sales.value <= "65000") {
    document.rater.sales_premium.value = (document.rater.sales.value / 1000)*25;
    }
    else if (document.rater.sales.value > "65000" && document.rater.sales.value <= "80000") {
    document.rater.sales_premium.value = (document.rater.sales.value / 1000)*25;
    }
    else if (document.rater.sales.value > "80000" && document.rater.sales.value <= "95000") {
    document.rater.sales_premium.value = (document.rater.sales.value / 1000)*25;
    }
    else if (document.rater.sales.value > "95000" && document.rater.sales.value <= "120000") {
    document.rater.sales_premium.value = (document.rater.sales.value / 1000)*25;
    }
    else {
    document.rater.sales_premium.value = (document.rater.sales.value / 1000)*25;
    }
}
function updatesalespremium2() {
    if (document.rater.sales_premium.value>=100) {
    document.rater.sales_premium2.value = document.rater.sales_premium.value;
    }
    else {
    document.rater.sales_premium2.value = 100;
    }
}
function updatesalestax() {
    document.rater.sales_tax.value = Math.round((document.rater.sales_state.value) * (document.rater.sales_premium2.value) * 100)/100;
}
function updatesalestotal() {
    document.rater.sales_total.value = Math.round((((document.rater.sales_premium2.value -0) + (document.rater.sales_tax.value -0)) + 650) * 100)/100;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:34:23.390

您正在比较字符串，就像它们是数字一样。当您比较字符串时，它们会按字母顺序进行比较。确实如此`"11111111" < "90"`，因为“1”的字母值小于“9”的字母值。

删除`"`数字周围的文字将导致其他值也转换为数字，并且数字规则将用于大小比较。

# asp.net - 在列表视图中列出文件夹名称和文件内容

> ID：14266673
> 
> 赞同：0
> 
> 时间：2013-01-10T20:26:58.030
> 
> 标签：asp.net

有没有办法在不使用 Sql 表的情况下在 asp.net listview 中列出子文件夹及其文件？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:10:06.397

假设您有一个名为的**列表视图**`ListView1`， 您可以使用以下内容来列出文件名：

```
static void ListFiles(string sDir)
   {
       try
       {
           foreach (string d in Directory.GetDirectories(sDir))
           {
               foreach (string f in Directory.GetFiles(d))
               {
                    string fileName = Path.GetFileNameWithoutExtension(f);
                    ListViewItem item = new ListViewItem(fileName);
                    item.Tag =  f; //could get folder name: DirectoryInfo(d).Name

                    ListView1.Items.Add(item);
               }
               ListFiles(d);
           }
       }
       catch (System.Exception ex)
       {
           // handle exceptions here!
       }
   } 
```

# c# - 我可以在不运行我的应用程序的情况下定期在 WP8 中运行后台任务吗？

> ID：14266675
> 
> 赞同：3
> 
> 时间：2013-01-10T20:27:04.807
> 
> 标签：c#, scheduled-tasks, windows-phone-8, background-process, azure-mobile-services

我想定期更新我的 WP8 应用程序的磁贴 - 不超过一两个小时。但是，我不希望我的应用程序必须运行才能执行此后台任务（将查询 WAMS 并根据返回的结果更新 WP8 应用程序的磁贴）。

这是可能的，还是做后台任务（我发现本教程关于如何创建一个： [http](http://thesociablegeek.com/windows-8/livetiles/modifying-live-tiles-in-a-background-process/) ://thesociablegeek.com/windows-8/livetiles/modifying-live-tiles-in-a-background-process/ ）需要托管它们的应用程序正在运行？

IOW，我基本上需要的类似于 Windows 服务，它由操作系统托管，而不是/我的特定应用程序。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:56:26.280

我建议您将磁贴更新逻辑编码为[定期任务](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.scheduler.periodictask%28v=vs.105%29.aspx) ，然后将其配置为在后台运行。这样，您不必维护您的应用程序在后台运行。

希望这可以帮助。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-11T08:25:40.270

下面是如何在 Windows Phone 7 或 8 中使用所谓的后台代理的指南： Windows Phone
[的后台代理](http://msdn.microsoft.com/en-us/library/windowsphone/develop/hh202942%28v=vs.105%29.aspx)
基本上你可以安排简单的任务每 30 分钟执行一次，即使主应用程序没有运行。这些任务有系统要求，例如 WP7 的内存上限限制为 6 MB，WP8 任务为 11 MB，每个任务的运行时间为 25 秒，以及可用的 API 有限。

# database-design - 设计：关系与。节点

> ID：14266677
> 
> 赞同：1
> 
> 时间：2013-01-10T20:27:15.513
> 
> 标签：database-design, nosql, neo4j

我是图形数据库的新手，对它承诺的范围和功能感到不知所措。在设计应用程序时，将我们的情感设计模式与实际性能设计保持一致是非常重要的。困扰我的问题之一是是否将某些信息作为关系属性或节点属性。这是用例。我们有通过传入关系“service_provider”相关的实体。起始节点成为结束节点的提供者。现在每个服务提供商都通过一些合同与他们的客户（或消费者）相关联。像服务频率、每次服务成本、不显示费用等。这些合同的细节可能因服务而异，但属性将始终存在。

所以现在我的问题是这些合约是否应该是一个不同的节点，可以连接到一对实体（服务提供者和消费者），或者它们应该是关系本身的一部分。

请注意，我的情感感觉是让它成为关系的一部分，这就是为什么我的描述可能会描绘出这样的画面。但是，情况不一定如此。我想听听您的意见，以便我可以总结我的方法。

如果您认为问题出现在错误的位置，请考虑建议更好的位置。

我已经参考了文档 [提升推荐结果@docs.neo4j.org](http://goo.gl/C7hSW) - 所有文档都表明，我提到的是一个可能的解决方案。但这里有一些问题——这些例子是关于关系属性的——它们并没有真正衡量这两种方法的优点和缺点

[相同的多个关系...... @ Stackoverflow](http://goo.gl/omVbf) - 不是同一个问题，但是，它与用例相关。

参考@bendaizer 的回复现在这里是一个性能问题。比较#1 和#4（部分）。假设合同是由服务提供者定义的（至少在大多数情况下），服务提供者可以连接到消费者的唯一方式是通过合同。所以我们有一个被合同包围的服务提供者，并且合同连接到消费者。当我尝试通过服务提供商查找消费者时......我必须做额外的合同跳跃。而根据#1，可以将相同的合同信息放入关系属性中。假设所有合同都是唯一的，预计哪一个表现更好？虽然这样做，但我不想失去回答类似问题的能力 [“服务提供商 X”的所有客户，每小时支付 50 美元 - 50 美元/小时是合同信息的一部分]

[另外，在 Google 论坛上查看相同的问题](http://goo.gl/tsoao)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T10:26:15.277

没有一般的经验法则来决定如何实现图表。你有不同的选择，我认为你必须坚持你认为最容易没有但也能给你带来良好表现的那个。

在您的情况下，我实际上看到了 4 个选项，并按我的偏好顺序对它们进行了排序：

*   您定义一个 service_provider 类型关系，并添加一个键/值属性 {contract : type of contract}。然后，您可以通过它们的属性对关系进行索引，这样您就可以从索引中检索合同以及相应的开始和结束节点。很简单，做的工作。

*   您可以定义合约类型的索引节点，并且每次将新提供者添加到某个节点时，您还会将该节点链接到合约类型。这当然意味着提供者是唯一的，否则您将无法区分哪个合同链接到客户端节点的哪个提供者。老实说，我不认为这是最好的解决方案，除非您想使用数据库进行显式模式识别和合同类型匹配（只有在您打算这样做时，我才建议您进行高级图挖掘）。

*   您可以为每个合同定义一个节点（而不是每个合同类型一个节点），您将拥有更多的节点。但是，如果您需要具有“egde over edge”类型的关系，这可能会很有用。这可能是用于个人分类目的的情况。如果您的节点可以有不同的提供者和不同类型的合同，并且合同可以单独附加到特定功能，这将非常有用。

*   您可以在节点之间定义两种关系，一种是 service_provider 类型，一种是合约类型。老实说，如果仅用于存储信息，我认为第一种方法会更好。但是这个也可以用于未来的模式匹配，即使在这种情况下我推荐第二个。

如您所见，这在很大程度上取决于您计划对图表执行的操作。希望这可以帮助 ！

# tridion - 如何检查当前组件是否正在结帐以及使用 tridion coreservices 结帐的用户详细信息

> ID：14266679
> 
> 赞同：3
> 
> 时间：2013-01-10T20:27:23.780
> 
> 标签：tridion, tridion-2011, tridion-core-services

我想编写一个小函数来检查传递的项目对象是否在 Tridion 中签出，如果是，那么它将返回“true”，并且我想使用 Tridion 2011 核心服务获取已签出项目的用户的详细信息。

我知道我们和我们的`TryCheckout`一样`Checkout`，`CoreServiceClient`但它只返回可识别对象。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-10T20:43:16.157

您需要查看项目上的 LockType。考虑做这样的事情

```
SessionAwareCoreService2010Client client = new SessionAwareCoreService2010Client();
ComponentData data = (ComponentData)client.Read("tcm:300-85609", new ReadOptions());
FullVersionInfo info = (FullVersionInfo)data.VersionInfo; 
```

完整版本信息包含您需要的所有信息（即 CheckOutUser 和 LockType）。LockType 是由 Tridion.ContentManager.Data.ContentManagement.LockType 定义的枚举，包括以下标志集：

*   **无**- 项目未锁定。
*   **CheckedOut** - 项目已签出。这可能意味着临时（编辑）锁定、永久锁定（由用户执行的显式签出）或工作流锁定。
*   **永久**- 项目永久签出，即使用显式签出操作。
*   **NewItem** - 该项目是一个新项目，即它已被创建，但尚未首次签入。
*   **InWorkflow** - 项目在工作流中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-12T07:39:14.693

下面是获取 ItemCheckedout 详细信息的示例代码，其中包含用户详细信息。

```
public static Dictionary<bool,string> ItemCheckedOutDetails(string ItemUri, CoreServiceClient client, ReadOptions readOpt, ItemType itemType)
{
    Dictionary<bool, string> itemDetails = null;
    FullVersionInfo itemInfo = null;
    if (itemType == ItemType.Component)
    {
        // reading the component data
        var itemData = (ComponentData)client.Read(ItemUri, readOpt);
        itemInfo = (FullVersionInfo)itemData.VersionInfo;
    }
    else if (itemType == ItemType.Page)
    {
        // reading the page data
        var itemData = (PageData)client.Read(ItemUri, readOpt);
        itemInfo = (FullVersionInfo)itemData.VersionInfo;
    }
    else if (itemType == ItemType.StructureGroup)
    {
        // reading the structuregroup data
        var itemData = (StructureGroupData)client.Read(ItemUri, readOpt);
        itemInfo = (FullVersionInfo)itemData.VersionInfo;
    }
    else if (itemType == ItemType.Publication)
    {
        // reading the Publication data
        var itemData = (PublicationData)client.Read(ItemUri, readOpt);
        itemInfo = (FullVersionInfo)itemData.VersionInfo;
    }
    else if (itemType == ItemType.ComponentTemplate)
    {
        // reading the component template data
        var itemData = (ComponentTemplateData)client.Read(ItemUri, readOpt);
        itemInfo = (FullVersionInfo)itemData.VersionInfo;
    }
    else if (itemType == ItemType.PageTemplate)
    {
        // reading the Page template data
        var itemData = (PageTemplateData)client.Read(ItemUri, readOpt);
        itemInfo = (FullVersionInfo)itemData.VersionInfo;
    }
    else if (itemType == ItemType.MultimediaType)
    {
        // reading the Multimedia Type data
        var itemData = (MultimediaTypeData)client.Read(ItemUri, readOpt);
        itemInfo = (FullVersionInfo)itemData.VersionInfo;
    }

    if (itemInfo != null)
    {
        if (itemInfo.LockType.Value == LockType.CheckedOut)
        {
            itemDetails.Add(true, itemInfo.CheckOutUser.Title);
        }
    }
    return itemDetails;
} 
```

# java - 使用 java 类创建基于 JSP 的应用程序（业务逻辑）

> ID：14266684
> 
> 赞同：1
> 
> 时间：2013-01-10T20:27:40.653
> 
> 标签：java, jsp, business-logic

我在 NetBeans 中开发了一个 Web 应用程序。目前它没有使用任何框架，只有一些 JSP 页面。我想添加一些业务逻辑，即处理一些数据并将其传递给输出的一些 Java 类。我了解，JSP 页面是视图层。其余的（模型和控制器）呢？

我是否必须使用可以处理此问题的框架（即，在没有框架的情况下，无法将 JSP 与基于 java 类的业务逻辑混合使用）？JSP 是否只用于编译成 servlet，必须由 JSP 之外的其他东西管理？我是新手，如果是微不足道的，请原谅我;）

PS 我知道我可以在 scriplet 标记中包含 Java 代码`<% ... %>`，但这不是我想要的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:29:42.097

*   您可以从 JSP调用[Java Servlet实现。](http://docs.oracle.com/javaee/6/api/javax/servlet/http/HttpServlet.html)（使用您的表单或 jsp:include 和 jsp:forward 标签）
*   您可能想要也可能不想使用 EJB。（[教程](http://docs.oracle.com/javaee/6/tutorial/doc/bnblr.html)）
*   尽管 Spring、Hibernate 和/或 Struts 可能有用，但框架不是强制性的。

如果您是第一次使用 servlet，我建议您仅从 Servlet 和[POJO](http://en.wikipedia.org/wiki/Plain_Old_Java_Object)开始。

这里有很多信息[http://docs.oracle.com/javaee/6/tutorial/doc/bnafd.html](http://docs.oracle.com/javaee/6/tutorial/doc/bnafd.html)

# magento - How to create cron for partial invoice of an order

> ID：14266692
> 
> 赞同：2
> 
> 时间：2013-01-10T20:28:41.397
> 
> 标签：magento, magento-1.7, invoice

I want to create partial invoice for downloadable product of an order based on release date of that product, I have got so many solutions to create partial invoice but it's create the invoice for all product, not for selected one.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T07:13:00.163

Here is the solution but don't forget to change condition according your requirement.

```
<?php

require_once '../app/Mage.php';
Mage::app('admin');

CapturePayment::createInvoice();

class CapturePayment {

    public static function createInvoice() {

        $orders = Mage::getModel('sales/order')->getCollection()
                        ->addFieldToFilter('status', array('processing'));

        foreach ($orders as $order) {
            $orderId = $order->getIncrementId();

            try {

                if (!$order->getId() || !$order->canInvoice()) {
                    echo 'Invoice is not allowed for order=>.' . $orderId . "\n";
                    continue;
                }
                $items = $order->getAllItems();
                $partial = false;
                $qtys = array();

                foreach ($items as $item) {
                    /* Check wheter we can create invoice for this item or not */
                    if (!CapturePayment::canInvoiceItem($item, array())) {
                        continue;
                    }
                    /* Get product id on the basis of order item id */
                    $productId = $item->getProductId();
                    /* If product is tablet then don't create invoice for the same */
                    /* Put your condition here for items you want to create the invoice e.g.*/
                    /* Load the product to get the release date */
                    $productDetails = Mage::getModel('catalog/product')->load($productId);

                    /* create your $qtys array here like */
                    $qtys['orderItemId'] = 'quantityOrdered'; 
                    /* NOTE: But if you don't want to craete invoice for any particular item then pass the '0' quantity for that item and set the value for $partial = true if some product remain in any order*/
                }
                /* Prepare the invoice to capture/create the invoice */
                $invoice = Mage::getModel('sales/service_order', $order)->prepareInvoice($qtys);

                if (!$invoice->getTotalQty()) {
                    continue;
                }

                $amount = $invoice->getGrandTotal();
                if ($partial) {
                    $amount = $invoice->getGrandTotal();
                    $invoice->register()->pay();
                    $invoice->getOrder()->setIsInProcess(true);
                    $history = $invoice->getOrder()->addStatusHistoryComment('Partial amount of $' . $amount . ' captured automatically.', false);
                    $history->setIsCustomerNotified(true);
                    $invoice->sendEmail(true, '');
                    $order->save();
                    Mage::getModel('core/resource_transaction')
                            ->addObject($invoice)
                            ->addObject($invoice->getOrder())
                            ->save();
                    $invoice->save();
                } else {
                    $invoice->setRequestedCaptureCase(Mage_Sales_Model_Order_Invoice::CAPTURE_ONLINE);
                    $invoice->register();
                    $invoice->getOrder()->setCustomerNoteNotify(true);
                    $invoice->getOrder()->setIsInProcess(false);
                    $invoice->getOrder()->setData('state', "complete");
                    $invoice->getOrder()->setStatus("complete");
                    $invoice->sendEmail(true, '');
                    $order->save();
                    Mage::getModel('core/resource_transaction')
                            ->addObject($invoice)
                            ->addObject($invoice->getOrder())
                            ->save();
                    $invoice->save();
                }
            } catch (Exception $e) {
                echo 'Exception in Order => ' . $orderId . '=>' . $e . "\n";
            }
        }
    }

    /* Check the invoice status for an item of an order */
    public static function canInvoiceItem($item, $qtys=array()) {
        if ($item->getLockedDoInvoice()) {
            return false;
        }
        if ($item->isDummy()) {
            if ($item->getHasChildren()) {
                foreach ($item->getChildrenItems() as $child) {
                    if (empty($qtys)) {
                        if ($child->getQtyToInvoice() > 0) {
                            return true;
                        }
                    } else {
                        if (isset($qtys[$child->getId()]) && $qtys[$child->getId()] > 0) {
                            return true;
                        }
                    }
                }
                return false;
            } else if ($item->getParentItem()) {
                $parent = $item->getParentItem();
                if (empty($qtys)) {
                    return $parent->getQtyToInvoice() > 0;
                } else {
                    return isset($qtys[$parent->getId()]) && $qtys[$parent->getId()] > 0;
                }
            }
        } else {
            return $item->getQtyToInvoice() > 0;
        }
    }

} 
```

# java - Java Android 非法参数异常

> ID：14266693
> 
> 赞同：0
> 
> 时间：2013-01-10T20:28:49.537
> 
> 标签：java, illegalargumentexception

我正在执行以下代码：

```
HttpClient httpclient = new DefaultHttpClient();

HttpResponse response = httpclient.execute(new HttpGet("(...)&avatarUrl={(...)}&socialId=1&sexo=m&username=")); 
```

我的问题是我`illegalArgumentException`从这个词中得到一个 at 字母 l `avatarUrl`，我不明白为什么。

我会非常感谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:39:08.010

除了代码中的`?`oder问题之外`&`，还有更简洁的方法来传递参数：

```
HttpClient httpclient = new DefaultHttpClient();
HttpGet request = new HttpGet(url);
BasicHttpParams params = new BasicHttpParams();

params.setParameter("avatarUrl","...")
      .setParameter("socialId","...")
      .setParameter("sexo","...")
      .setParameter("username","...");

request.setParams(params);

HttpResponse response = httpclient.execute(request); 
```

*（未经测试，但应该可以）*

**注意：由于一些误解，我对原始答案进行了大量编辑。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:33:36.020

查看[HttpGet 的源码](http://www.jarvana.com/jarvana/view/org/apache/httpcomponents/httpclient/4.0/httpclient-4.0-sources.jar!/org/apache/http/client/methods/HttpGet.java?format=ok)，这个异常意味着 URL 无效：

1.  第一个查询字符串参数应以`?`
2.  `{`并且`}`不是[URL 的有效字符](https://stackoverflow.com/questions/1856785/characters-allowed-in-a-url)，应转义

# reporting-services - 使用 SOAP 以编程方式在 ssrs 中创建文件夹

> ID：14266694
> 
> 赞同：1
> 
> 时间：2013-01-10T20:28:51.753
> 
> 标签：reporting-services

我正在使用 SSRS 2008r API 从 webform 应用程序创建和管理 SSRS。创建文件夹时，我看到可以在哪里添加文件夹名称以及指定可以成为文件夹一部分的其他元数据（自定义属性）。我的问题是如何通过 api 在目录数据库中填充其他字段。当我查看 CreateFolder 方法时，我可以在插入时添加的唯一属性是文件夹名称、路径和自定义属性：

```
rs.CreateFolder(folderName, "/", props); // foldername is a string passed in from the form 
```

不过此时我还想设置描述和隐藏值。

我将不胜感激有关如何完成的任何建议。我在 MSDN 中看到的每个示例都只显示了设置文件夹名称、路径和自定义属性。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T22:36:24.290

通过为每个项目初始化一个[Property](http://msdn.microsoft.com/en-us/library/reportservice2005.property%28v=sql.105%29.aspx)类来设置[项目属性](http://msdn.microsoft.com/en-us/library/ms152826.aspx)(`Description`和)。以前从未做过，但我猜它看起来像这样（假设 C#）：`Hidden`

```
...
// description property
Property description = new Property();
description.Name = "Description";
description.Value = "Your description here.";

// hidden property
Property hidden = new Property();
hidden.Name = "Hidden";
hidden.Value = "True"; // not sure on value here, may be True/False, Yes/No

// build properties array
props[0] = description;
props[1] = hidden;

// create folder
rs.CreateFolder(folderName, "/", props); // foldername is a string passed in from the form 
```

# mysql - 棘手的递归 MySQL 查询

> ID：14266697
> 
> 赞同：1
> 
> 时间：2013-01-10T20:29:01.167
> 
> 标签：mysql, sql

我有一个有 2 列的表，`usersID`它们的`siblingID`

找到给定用户的所有兄弟姐妹的最佳方法是什么？

问题很复杂。这是一个例子。

用户 1 有 5 个兄弟姐妹 (2,3,4,5,6)

桌子看起来像这样

```
userID|siblingID
1     | 2
1     | 3
6     | 5
5     | 3
3     | 1
4     | 6 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:46:25.317

ANSI SQL：

```
with recursive tree (userid, siblingid) as
(
   select userid, 
          siblingid
   from users
   where userId = 1
   union all 
   select c.userid,
          c.siblingid
   from users c
     join tree p on p.userid c.siblingId
)
select *
from tree; 
```

对于 Oracle 11.2 和 SQL Server - 他们显然没有仔细查看 ANSI 规范 - 您需要删除`recursive`关键字（根据标准这是强制性的）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T22:22:39.820

答案，即使使用不止一个 SQL 语句，也比我想象的要困难得多。

您的问题的简单答案是：创建一个包含所有兄弟关系的表。然后您可以将其查询为：

```
select siblingid
from @allsiblings sa
where sa.userid = 3 
```

一注。我使用 SQL Server 的语法，只是因为它恰好是最方便的数据库。我只使用 MySQL 中的功能，所以它应该很容易翻译。

如何创建表@AllSiblings？好吧，继续添加不存在的兄弟对，直到不再添加。我们通过自连接获得对。

这是代码（受前面的警告）：

```
declare @allsiblings table (userid integer, siblingid integer);

declare @siblings table (userId int, siblingID int);

-- Initialize the @siblings table    
insert into @siblings(userId, siblingID)
    select 1 as userID, 2 as siblingID union all
    select 1 as userID, 3 as siblingID union all
    select 6 as userID, 5 as siblingID union all
    select 5 as userID, 3 as siblingID union all
    select 3 as userID, 1 as siblingID union all
    select 4 as userID, 6 as siblingID;

-- Initialize all siblings.  Note that both pairs are going in here    
insert into @allsiblings(userid, siblingid)
    select userId, siblingid from @siblings union
    select siblingID, userid from @siblings

-- select * from @allsiblings

while (1=1)
begin
    -- Add in new siblings, that don't exist by doing a self-join to traverse the links
    insert into @allsiblings
        select distinct sa.userid, sa2.siblingid
        from @allsiblings sa join
             @allsiblings sa2
             on sa.siblingid = sa2.userid
        where not exists (select * from @allsiblings sa3 where sa3.userid = sa.userid and sa3.siblingid = sa2.siblingid)

    -- If nothing was added, we are done        
    if (@@ROWCOUNT = 0) break;

    select * from @allsiblings;
end; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:41:14.160

[http://sqlfiddle.com/#!4/0ef0c/5](http://sqlfiddle.com/#!4/0ef0c/5)是一个示例，其中有人必须获取某些条目的所有亲属。

对应的栈溢出问题在这里： [Hierarchical Query Needs to Pull Children,Parents and Siblings](https://stackoverflow.com/questions/13655400/hierarchical-query-needs-to-pull-children-parents-and-siblings)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:38:14.540

您可以使用循环和临时表来模拟递归。首先在临时表中插入起始节点。然后当临时表中有行时，获取第一行，将其从临时表中删除，并在其中插入他所有的兄弟姐妹......

# c# - 在 Windows Phone c# 应用程序中按名称搜索控件

> ID：14266699
> 
> 赞同：0
> 
> 时间：2013-01-10T20:29:06.693
> 
> 标签：c#, windows-phone-7

是否可以在 Windows Phone 应用程序中按名称搜索控件？我知道在用 c# 编写的普通桌面应用程序中是可能的：

```
string s = "label2";
            Control[] controls = this.Controls.Find(s, false);
            if (controls.Length > 0)
            {
                Label found = controls[0] as Label;
                if (found != null) found.Text = "new label2 text";
            } 
```

在 Windows Phone 应用程序中，“this.Controls”无法识别...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:57:11.927

使用[`FindName`](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.windows.frameworkelement.findname%28v=vs.105%29.aspx)：

```
var control = this.FindName(s);

if (control != null)
{
    // Whatever
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:57:59.770

是的，这是可能的——但在 Windows Phone 中，您的控件位于称为可视树的树状结构中。为了找到控件，您必须浏览此树。[我不久前写了一个名为Linq-to-VisualTree](http://www.scottlogic.co.uk/blog/colin/2010/03/linq-to-visual-tree/)的实用程序类，它简化了这个过程。

# ef-code-first - 查找关键成员的 DbContext 通用方法

> ID：14266708
> 
> 赞同：1
> 
> 时间：2013-01-10T20:29:33.517
> 
> 标签：ef-code-first, entity-framework-5

在类似的通用上下文中使用 CodeFirst() 时，有没有办法找到`Key Members`实体 ( ) ？`TEntity``DbContext``ObjectContext`

`ObjectContext` [我可以在这里](https://stackoverflow.com/questions/5273416/entity-framework-simple-generic-getbyid-but-has-differents-pk-name)看到它是如何完成的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-12T18:12:24.937

很抱歉造成混淆，似乎即使使用 Code First 方法，我们也可以使用对象上下文找到实体上的关键成员，如下所示：

```
var ObjectContext = ((IObjectContextAdapter)DbContext).ObjectContext;
var ObjectSet = ObjectContext .CreateObjectSet<TEntity>();
var EntitySet = ObjectSet.EntitySet;
var KeyMembers = EntitySet.ElementType.KeyMembers; 
```

# tfs - 设计和 Scrum

> ID：14266714
> 
> 赞同：-1
> 
> 时间：2013-01-10T20:29:50.257
> 
> 标签：tfs, agile, scrum, methodology

我编辑我的帖子更具体。

我希望开始使用 Scrum 方法，并且想知道设计和 Scrum 是如何共存的？

在“旧”世界中，我会为我的应用程序构建一个完整的设计，准确说明每个菜单应该在哪里，以及它应该包含多少个按钮。

通过如此精确，我帮助我的开发团队了解在哪里构建可重用组件（例如菜单 UI，将由子菜单继承），并为他们提供有关应用程序的“大图”。

**Scrum 是如何处理这个问题的？**

在 Scrum 中，我们通过 sprint 工作，对于开发人员来说，看到应用程序的“大图”似乎是个问题，因为没有“大图”，只有下一个 sprint。

非常感谢，迈克尔。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:37:58.700

无论您使用哪种方法，您都可以随时给出“大局”。简而言之，对于 scrum/agile，您必须记住目标是在每次迭代结束时创建一个工作软件。因此，您的故事之一不会是创建上层菜单，而是创建一个具有特定功能的上层菜单。想象一下，如果整个项目在任何迭代后停止，你应该有一个可用的应用程序，不管它有多么有限。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T21:00:06.590

在 200 字的 SO 帖子中无法有效地描述开发方法。如果您想了解这一点，请阅读其中一本书或参加其中一门课程。

而且，对于大多数开发方法，“高级计划”要么已经由非开发人员完成，要么“计划”被抛到一边，让开发人员在做他们一直在做的事情时假装遵循.

而“敏捷”最终就是这样——开发人员做他们一直在做的事情。只有使用“敏捷”，您才能承认这一点，而不是假装遵循一些宏大的（和虚构的）开发计划。

“Scrum”只是团队中开发人员之间的定期技术/计划会议，尽可能多地消除忙碌的工作。没有真正的蓝图或格式（尽管保持简短的一般规则是好的）。

没有魔法。

# unit-testing - 单元测试一个非常具体的功能

> ID：14266724
> 
> 赞同：1
> 
> 时间：2013-01-10T20:30:52.547
> 
> 标签：unit-testing, function, aggregation, vendor

为了确保这个问题对于常见问题解答中的标准足够具体，我只是问以下问题：哪些资源讨论了将单元测试应用于非常特定的功能的最常见方法，通常是依赖供应商数据的功能或其他非常具体的数据，例如合成数据对测试没有帮助？如果您对更多背景感兴趣，请阅读下文。

**背景：**

我在日常代码开发中经常编写单元测试，但我也尝试使我的代码尽可能抽象和可重用。在我加入的一个新项目中，在许多情况下，代码由非常具体的函数组成，这些函数旨在接受非常具体格式化的输入数据并将输出数据存储到数据库表中。大部分输入数据由供应商数据或其他内部数据组成，并通过调用供应商和内部 API 进行访问。

到目前为止，我唯一的想法是测试输入数据格式错误时遇到的各种故障。我肯定会写这个测试，但就测试而言，它对我们的团队来说毫无用处。更有用的测试应该检查这些数据操作的逻辑是否正确，这涉及根据输入数据检查输出数据的准确性。

不幸的是，我没有任何基准数据集可以明确知道输出应该是什么。其他人建议创建我自己的合成输入数据（如全 1 的矩阵或我可以预测输出应该是什么人为的东西）。不幸的是，该函数执行的操作是非常非线性的（通过加权百分位数对事物进行分类并获取每个百分位数分组的汇总统计信息）。任何基于完全人为的合成输入数据的测试对我们来说也不是很有用，而且格式化它然后写入一些合成输出数据库表并读取它以检查单元测试类型的时间成本使这样的测试毫无价值。

我知道单元测试应该只测试一种行为。我只是不确定如何分解一个函数，该函数执行诸如聚合加权百分位数分组中的复杂统计数据并将其归结为“只是一件事”进行测试的功能。

在此设置中使用了哪些标准？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:14:32.873

我用非常大的方法遇到了类似的问题。我的建议是使用依赖注入重构代码并遵守单一职责原则。然后根据其职责测试每个类。

# java - PortletURL 在弹出窗口中打开另一个 portlet

> ID：14266725
> 
> 赞同：6
> 
> 时间：2013-01-10T20:30:53.990
> 
> 标签：java, popup, liferay

我有一个钩子`create_account.jsp`。在这个jsp中，我有一个javascript代码，我尝试在iframe弹出窗口或Liferay的一些弹出窗口中打开一个portlet。

问题是：
如何给出portlet URL？
我怎样才能访问它？
在那个 portlet 中，我只想问一个是或否的问题，并根据用户的回答，重定向到其他页面。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-11T13:28:05.993

1.  要创建 URL，您可以使用`<portlet:renderURL>`或`<liferay-portlet:renderURL>`

    ```
    <liferay-portlet:renderURL
        var="testPopupURL"
        portletName="testPopup_WAR_testPopupportlet"
        windowState="<%=LiferayWindowState.POP_UP.toString() %>">
        <liferay-portlet:param name="paramToPopup" value="customParameterToThePortlet" />
    </liferay-portlet:renderURL> 
    ```

    **`portletName="testPopup_WAR_testPopupportlet"`**这是您要打开的 portlet 的 portletId。

    **`windowState="<%=LiferayWindowState.POP_UP.toString() %>"`**仅在弹出窗口中显示 portlet 很重要，否则它将打开带有导航和所有内容的完整 liferay 页面。

2.  您可以在 JSP 中编写的 javascript 使用上述 URL 并在其中打开弹出窗口和 portlet：

    ```
    // this is one of creating function
    function <portlet:namespace />showPopup(url) {

        var url = url;

        // this is one way of calling a pop-up in liferay
        // this way is specific to liferay
        Liferay.Util.openWindow(
                {
                    dialog: {
                        cache: false,
                        width:800,
                        modal: true
                    },
                    id: 'testPopupIdUnique',                
                    uri: url
                }
            );
        }

    // this is another way of creating a function in liferay
    Liferay.provide(
            window,
            '<portlet:namespace />showAUIPopUP',
            function(url) {
                var A = AUI();

                // this is another way of calling a iframe pop-up
                // this way is not specific to liferay
                popupDialog = new A.Dialog(
                    {
                        id: 'testPopupIdUnique',
                        centered: true,
                        draggable: true,
                        resizable: true,
                        width: 800,
                        stack: true
                    }
                ).plug(
                    A.Plugin.DialogIframe,
                    {
                        uri: url,
                        iframeCssClass: 'ogilvy-dialog-iframe'
                    }
                );

                popupDialog.render();
            },
        ['aui-dialog','aui-dialog-iframe']
    ); 
    ```

3.  您可以像这样简单地调用这些 javascript 函数：

    ```
    <a href="javascript: <portlet:namespace />showPopup('<%=testPopupURL%>')">
        Popup using Liferay open-window
    </a>

    <a href="javascript: <portlet:namespace />showAUIPopUP('<%=testPopupURL%>')">
        Pop-up using Alloy UI dialog
    </a> 
    ```

4.  `iframe`将在弹出窗口`<add-default-resource>true</add-default-resource>`中显示的 portlet应该具有`liferay-portlet.xml`：

    ```
    <portlet>
        <portlet-name>testPopup</portlet-name>
        <icon>/icon.png</icon>
        <instanceable>false</instanceable>
        <header-portlet-css>/css/main.css</header-portlet-css>
        <footer-portlet-javascript>/js/main.js</footer-portlet-javascript>
        <css-class-wrapper>testPopup-portlet</css-class-wrapper>
        <!-- This property is necessary otherwise you would see a "Access denied for portlet" message when you try to open this portlet dynamically -->
        <add-default-resource>true</add-default-resource>
    </portlet> 
    ```

5.  或者应该将属性设置`portlet.add.default.resource.check.whitelist`为`portal-ext.properties`：

    ```
    portlet.add.default.resource.check.whitelist=3,56_INSTANCE_0000,58,82,86,87,88,103,113,145,164,166,170,177,testPopup_WAR_testPopupportlet 
    ```

要查看此代码的运行情况，您可以从[该 liferay 论坛](https://www.liferay.com/community/forums/-/message_boards/message/19129386)下载 2 个 portlet 并参考说明。

希望这有助于更好地理解liferay。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-11T05:40:09.217

您可以使用 renderURL 标签。在 JSP 中，只需放置一个表单并使用您的 MVCPortlet 类制作您想要的treatemnet。

```
<portlet:renderURL var="myPopuURL"windowState="<%= LiferayWindowState.EXCLUSIVE.toString() %>">
    <portlet:param name="mvcPath" value="/myJspWithYesOrNo.jsp" />
</portlet:renderURL>

<script>
   my_function_to_open_popup_with_url('<%=myPopuURL%>');
</sricpt> 
```

请注意，Liferay 提供了一种使用 AUI 创建弹出窗口的方法： [http ://www.liferay.com/community/liferay-projects/alloy-ui/demo?title=community-liferay-projects-alloy-ui-demos-dialog](http://www.liferay.com/community/liferay-projects/alloy-ui/demo?title=community-liferay-projects-alloy-ui-demos-dialog)

# objective-c - 初始化后是否可以更改 UITabBarController 的色调颜色

> ID：14266728
> 
> 赞同：0
> 
> 时间：2013-01-10T20:31:15.697
> 
> 标签：objective-c, cocoa-touch, overriding, ibaction

我正在制作一个应用程序，我希望能够更改 UITabBarController 的色调颜色。我为 UITabBarController 创建了一个自定义类并将其分配给 IB 中的 UITabBar。它工作正常。这个类有一个 IBAction 可以改变它的颜色，称为 alterColor：

当应用程序首次启动时，一切都很好。但在那之后，我似乎无法从另一个班级运行那个动作。我有一个设置类，我尝试更改颜色。通过在设置类中执行以下操作，我得到了正确的实例。

。H

`@property (nonatomic, strong) TabBarController *tabController;`

.M

```
@implementation LogbookThirdViewController
@synthesize CarbsTextField;
@synthesize tabController; 
```

...

```
-(IBAction)colorRedPicked:(id)sender {
    NSString *writableDBPath = [[NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) objectAtIndex:0] stringByAppendingPathComponent:@"colorChoice.txt"];

    NSString *carbRatio = @"red";

    [carbRatio writeToFile:writableDBPath atomically:YES encoding:NSUTF16StringEncoding error:nil];

    NSString *readFile;
    readFile = [NSString stringWithContentsOfFile:writableDBPath encoding:NSUTF16StringEncoding error:nil];
    NSLog(@"Color = %@", readFile);
    readFile = nil;

    [tabController alterColor:tabController];  //This line should run the method.

} 
```

然而，什么也没有发生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:40:21.883

假设此 viewController 包含在您的 tabbarController 中，则不需要该属性。

UIViewController 上有一个现有的属性：

```
 @property(nonatomic, readonly, retain) UITabBarController *tabBarController 
```

（您不需要在代码中添加它，它在您创建 viewController 子类时继承的类中）

因此请参考 tabBarController：

```
self.tabBarController 
```

您*可能*需要将其类型转换为您的自定义控制器，以鼓励编译器允许您将颜色更改方法发送给它。但无论哪种方式，您都会将消息发送到正确的对象。

# django - Django sorl-thumbnail 显示来自 url 的图像

> ID：14266729
> 
> 赞同：2
> 
> 时间：2013-01-10T20:31:24.193
> 
> 标签：django, sorl-thumbnail

我在项目的几个部分中使用了 solr-thumbnail，但是这次我想显示来自 URL 的图像，我有这样的：

```
 {% load thumbnail %}
    {% thumbnail profile_picture_url "150x150" crop="center" as img %}
    <img src="{{ img }}">
    {% endthumbnail %} 
```

视图将值 profile_picture_url 作为“http://....image.jpg”传递。如果我只是使用，图像会正确显示：

```
<img src="{{ profile_picture_url }}"> 
```

我究竟做错了什么 ？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:41:34.707

SORL-Thumbnail 正在寻找图像对象，而不是 URL。传递它`profile_picture`而不是`profile_picture_url`然后调用标签的`url`属性`img`中的`src`属性。`img`

```
{% load thumbnail %}
{% thumbnail profile_picture "150x150" crop="center" as img %}
  <img src="{{ img.url }}">
{% endthumbnail %} 
```

# javascript - JS如何缓存一个变量

> ID：14266730
> 
> 赞同：61
> 
> 时间：2013-01-10T20:31:25.190
> 
> 标签：javascript, jquery, html

我想要做的是能够创建一个变量，给它一个值，关闭并重新打开窗口，并能够检索我在上次会话中设置的值。最简单的方法是什么？欢迎使用 JQuery 回答。

* * *

## 回答 #1

> 赞同：105
> 
> 时间：2013-01-10T20:32:30.403

为此使用[localStorage](https://developer.mozilla.org/en-US/docs/DOM/Storage)。它在会话中持续存在。

写作 ：

```
localStorage['myKey'] = 'somestring'; // only strings 
```

阅读 ：

```
var myVar = localStorage['myKey'] || 'defaultValue'; 
```

如果您需要存储复杂的结构，您可以将它们序列化为 JSON。例如 ：

阅读 ：

```
var stored = localStorage['myKey'];
if (stored) myVar = JSON.parse(stored);
else myVar = {a:'test', b: [1, 2, 3]}; 
```

写作 ：

```
localStorage['myKey'] = JSON.stringify(myVar); 
```

请注意，您可以使用多个密钥。它们都将被同一域上的所有页面检索。

除非您想与 IE7 兼容，否则您没有理由使用过时的小型 cookie。

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-01-10T20:36:59.713

你有三个选择：

1.  饼干：[https ://developer.mozilla.org/en-US/docs/DOM/document.cookie](https://developer.mozilla.org/en-US/docs/DOM/document.cookie)
2.  DOMStorage（sessionStorage 或 localStorage）：[https ://developer.mozilla.org/en-US/docs/DOM/Storage](https://developer.mozilla.org/en-US/docs/DOM/Storage)
3.  如果您的用户已登录，您可以将数据保存在服务器的数据库中，这些数据键入用户（或组）

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-10T20:37:34.347

如果您的要求允许，您可以创建一个 cookie。如果您选择采用 cookie 路由，则解决方案可能如下。使用 cookie 的好处是在用户关闭浏览器并重新打开后，如果 cookie 没有被删除，则该值将被保留。

**Cookie** **创建和存储 Cookie：* *

```
function setCookie(c_name,value,exdays)
{
var exdate=new Date();
exdate.setDate(exdate.getDate() + exdays);
var c_value=escape(value) + ((exdays==null) ? "" : "; expires="+exdate.toUTCString());
document.cookie=c_name + "=" + c_value;
} 
```

**返回指定cookie的函数：**

```
function getCookie(c_name)
{
var i,x,y,ARRcookies=document.cookie.split(";");
for (i=0;i<ARRcookies.length;i++)
{
  x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
  y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
  x=x.replace(/^\s+|\s+$/g,"");
  if (x==c_name)
    {
    return unescape(y);
    }
  }
} 
```

**如果设置了 cookie，则显示欢迎消息**

```
function checkCookie()
{
var username=getCookie("username");
  if (username!=null && username!="")
  {
  alert("Welcome again " + username);
  }
else 
  {
  username=prompt("Please enter your name:","");
  if (username!=null && username!="")
    {
    setCookie("username",username,365);
    }
  }
} 
```

上述解决方案是通过 cookie 保存价值。这是一种非常标准的方式，无需将值存储在服务器端。

**jQuery**

为会话存储设置一个值。

Javascript：

```
$.sessionStorage( 'foo', {data:'bar'} ); 
```

检索值：

```
$.sessionStorage( 'foo', {data:'bar'} );

$.sessionStorage( 'foo' );Results:
{data:'bar'} 
```

**本地存储** 现在让我们看看本地存储。例如，假设您有一组要保留的变量。您可以执行以下操作：

```
var names=[];
names[0]=prompt("New name?");
localStorage['names']=JSON.stringify(names);

//...
var storedNames=JSON.parse(localStorage['names']); 
```

**使用 ASP.NET 的服务器端示例**

添加到会话

```
Session["FirstName"] = FirstNameTextBox.Text;
Session["LastName"] = LastNameTextBox.Text; 
```

// 从会话状态中检索对象时，将其转换为 // 适当的类型。

```
ArrayList stockPicks = (ArrayList)Session["StockPicks"];

// Write the modified stock picks list back to session state.
Session["StockPicks"] = stockPicks; 
```

我希望这回答了你的问题。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-11T05:04:08.010

查看我的 js 库进行缓存： [https ://github.com/hoangnd25/cacheJS](https://github.com/hoangnd25/cacheJS)

我的博文： [使用 Javascript 缓存数据的新方法](http://hoangnd.me/blog/cache-your-data-with-javascript-using-cachejs)

## 特征：

*   方便地使用数组作为键来保存缓存
*   支持数组和本地存储
*   按上下文清除缓存（清除所有带有 authorId="abc" 的博客文章）
*   无依赖

## 基本用法：

**保存缓存：**

```
cacheJS.set({blogId:1,type:'view'},'<h1>Blog 1</h1>');
cacheJS.set({blogId:2,type:'view'},'<h1>Blog 2</h1>', null, {author:'hoangnd'});
cacheJS.set({blogId:3,type:'view'},'<h1>Blog 3</h1>', 3600, {author:'hoangnd',categoryId:2}); 
```

**检索缓存：**

```
cacheJS.get({blogId: 1,type: 'view'}); 
```

**刷新缓存**

```
cacheJS.removeByKey({blogId: 1,type: 'view'});
cacheJS.removeByKey({blogId: 2,type: 'view'});

cacheJS.removeByContext({author:'hoangnd'}); 
```

**切换供应商**

```
cacheJS.use('array');
cacheJS.use('array').set({blogId:1},'<h1>Blog 1</h1>')}; 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-01-25T12:55:06.747

我写了一个通用的`caching func()`，它可以很容易地缓存任何变量并且非常易读的格式。 **缓存功能：**

```
function calculateSomethingMaybe(args){
  return args;
}

function caching(fn){
  const cache = {};
  return function(){
    const string = arguments[0];
    if(!cache[string]){
      const result = fn.apply(this, arguments);
      cache[string] = result;
      return result;
    }
    return cache[string];
  }
}

const letsCache = caching(calculateSomethingMaybe);

console.log(letsCache('a book'), letsCache('a pen'), letsCache('a book')); 
```

# ocaml - ocaml 循环计数不使用参考计数？

> ID：14266731
> 
> 赞同：1
> 
> 时间：2013-01-10T20:31:27.920
> 
> 标签：ocaml

我正在使用`ref`计数来计算函数执行的次数，但是如果我想摆脱 ref 怎么办？我是ocaml的新手，请给我一些建议，这是我得到的：

```
let count =ref 0;;  
let rec addtive n=
if n<9 then count 
else(
     incr count;
     addtive(sum(digit(n)))
) ;;

# a 551515;;
- : int ref = {contents = 2} 
```

但我想变得像

```
-: int = 2 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T09:24:00.850

只需`!`在`then`子句中添加 a 即可从 中提取值`ref`：

```
let count =ref 0;;   
let rec addtive n= 
  if n<9 then !count
  else(
    incr count;
    addtive(sum(digit(n)))  
  ) ;; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:36:04.193

您应该将计数作为第二个参数传递（如果需要，定义一个辅助方法）：

```
let additive n =
  let rec helper n count =
    if n<9 then count
    else helper (sum (digit n)) (count + 1)
  in
  helper n 0 
```

# joomla - 如何在 Joomla 中制作电子邮件模板？

> ID：14266732
> 
> 赞同：0
> 
> 时间：2013-01-10T20:31:36.163
> 
> 标签：joomla

我想制作一个电子邮件模板以在 Joomla 后端使用。有可能吗？如何？我查看了 Joomla 文档并没有找到我的答案。我使用 Joomla 2.5.7。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:34:45.427

首先将您的 Joomla 版本升级到最新的 2.5.x 版本

至于电子邮件模板，您将需要安装一个允许此类功能的组件，例如 Newsletter 组件。我个人会推荐[JNews](http://extensions.joomla.org/extensions/content-sharing/newsletter/11585)，但是可以在以下链接中找到更多信息：

[http://extensions.joomla.org/extensions/content-sharing/newsletter](http://extensions.joomla.org/extensions/content-sharing/newsletter)

希望这可以帮助

# hadoop - Hadoop 控制输入数据的类似部分的拆分大小

> ID：14266735
> 
> 赞同：2
> 
> 时间：2013-01-10T20:31:39.530
> 
> 标签：hadoop

我有一种情况，我的输入数据如下所示。

```
AA1
AA2
AA3
AA4
BB1
BB2
BB3
CC1
CC2
CC3
CC4
CC5
CC6 
```

我想要做的是将数据拆分为 InputSplits，其中每个拆分涵盖以某些前导字母开头的字符串部分。例如，第一个输入拆分将是所有以“AA”开头的字符串，第二个拆分将是那些以“BB”开头的字符串，等等。

我想这样做是因为我的数据需要像这样放在一起才能使 reduce 阶段正确运行。

到目前为止，我一直在玩的是编写自己的类`InputFormat`和`RecordReader`类来执行此操作，但是我在一些示例（http://developer.yahoo.com/hadoop/tutorial/module5.html#fileformat）中看到了分裂当读者接触到它们时，它们就已经被创建了。我相信我遇到了拆分与字符串之间的边界不正确对齐的危险。

为了使这项工作充分发挥作用，我是否必须实现自己的`InputFormat` `getSplits`功能版本？如果我这样做，我是否会冒着以不利用机器局部性的方式将拆分分布在机器上的风险？最后，一般来说有没有更好的方法？

任何帮助表示赞赏。谢谢，

米

编辑 0

根据几位评论员的要求，我将提供更多信息。

我的程序的目标是比较属于组的字符串以找到这些字符串之间的重叠并记录哪些字符串一起共享该重叠。考虑以下示例。

```
AAAA
AAAB
AAAC
AAB
BAAA 
```

所有开头共享“A”的字符串都有一些它们之间共有的重叠。以“B”开头的显然不是。当谈到实际发现具体的重叠是什么并建立这些组时，如果我正在查看“AAAA”，我需要一直比较到“BAAA”，而不是进一步。我担心的是 InputSplits 会切碎我的数据，这样某些字符串就不会被比较，并且我会丢失/不完整的组。我希望使用 Map 步骤（或读取数据）将问题分成这些组，然后允许 Reduce 步骤计算组并返回结果。

我有数百万这样的字符串，在一台机器上需要一段时间。我在逻辑上实施了大量“技巧”来简化流程并使其快速运行。我希望 Hadoop 能够介入并提供帮助并使其更快。

Joe K - 回答你的问题，我不知道所有字符串之间的重叠程度。重叠可以不同，例如 AA1 可以重叠 2 个字符到 AA4，但如果存在 AB5，则只有 1 个字符会重叠。字符串的长度可能会有很大差异，因此在其他情况下可能会有很大的重叠。此外，检测究竟是什么重叠是我想在减少阶段做的事情。这就是我的全部目标。

我不知道 shuffle/sort 阶段是否会正确地将相邻的字符串分配给同一个 reducer，或者是否会有中断。不幸的是，我对这个过程的无知让我在这里绊倒了。

编辑 0 结束

# java - 在 Web 服务器上运行 Java EE 应用程序

> ID：14266736
> 
> 赞同：2
> 
> 时间：2013-01-10T20:31:41.150
> 
> 标签：java, jakarta-ee, hosting, hole-punching, nat-traversal

以下是一个在端口 15445 上侦听 SOCKET 的线程。每当向其发送数据报数据包时，它都会在其中添加一个字符串（来自 SERVER 的回复）后转发回发送者的地址。我希望这段代码在 Internet 上的某个地方运行，但我不知道从哪里开始。

是否可以？我可以在 Tomcat 服务器上运行此代码还是需要做一些不同的事情？

```
import java.io.*;
import java.net.*;

public class HelloWorld extends Thread {

    protected DatagramSocket socket = null;
    protected BufferedReader in = null;

    public HelloWorld() throws IOException {
        socket = new DatagramSocket(15445);
    }

    public void run() {

        while (true) {
            try {
                byte[] buf = new byte[256];
                DatagramPacket packet = new DatagramPacket(buf, buf.length);
                socket.receive(packet);

                InetAddress address = packet.getAddress();
                int port = packet.getPort();
                String s = "Reply from SERVER";
                byte[] b= s.getBytes();
                packet = new DatagramPacket(b, b.length, address, port);
                socket.send(packet);
            } catch (IOException e) {
                e.printStackTrace();    
            }
        }

    }

    public static void main(String[] args) throws IOException {
        new HelloWorld().start();
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:33:19.167

不，Tomcat 不是 Web 服务器。它是一个 servlet/JSP 引擎，恰好内置了一个 HTTP 服务器。

这看起来像带有 main 的 POJO。为什么不能将其作为服务运行？为什么你认为你需要一个网络服务器？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:39:46.593

使用 Jetty（回声服务器是 afaik 的教程之一）并将您的端口暴露给互联网。

如果您的代码工作正常，则通过您的路由器转发必要的端口，以便可以从 Internet 访问它。如果您正在寻找托管解决方案，**虚拟服务器**是一种廉价的开始方式。[http://www.superuser.com](http://www.superuser.com)是进行网络配置的地方。

# c - c中的递增指针

> ID：14266738
> 
> 赞同：0
> 
> 时间：2013-01-10T20:31:56.860
> 
> 标签：c

```
#include<stdio.h>

int main()
{
    int a=5,*b,*c;

    b=&a;
    c=b;

    *b++=*c++;

    printf(" %d %d %d\n",&a,b,c);
} 
```

这里如果a的地址是x，那么b和c的值都变成x+4。但是两个 ++ 运算符不应该将至少一个值增加 8

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:38:41.983

不，不要将指针的值与其指向的值*混淆*。

表达式的`*b++`意思是：检索b指向的值，*然后*增加b的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:45:00.540

您应该使用`%p`来格式化指针值，而不是`%d`.

您在这里所做的只是`a`通过指针将值设置为自身。请注意，两者`b`和`c`在递增后可能不会被取消引用（因为它们指向单个值，而不是数组）。

请注意，如果要增加实际值，则必须使用括号：

```
(*b)++; 
```

这将取消引用`b`并增加值。如果你在没有括号的情况下这样做，那么它将增加指针，然后取消引用原始值。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-10T20:52:26.333

请记住这一点

*b++ 这意味着 b 指向某个整数，并且整数值递增 1 而不是 2，因为它可能在您看来带有两个 + 符号。如果您想打印指针，您应该使用 %p 格式说明符那而不是使用int。

# image - 如何让我的 div 的背景处于固定位置？

> ID：14266740
> 
> 赞同：-1
> 
> 时间：2013-01-10T20:32:02.450
> 
> 标签：image, html, positioning, background-image

我正在为我的新网站编写代码，因为您可以在此 div 上向下滚动，所以我需要修复背景：

```
 <div id="main" style="background-image:url('bg5.png'); background-repeat: repeat; background-        size: 924px; width:924px; height: 526px;  float: right; z-index:-1; overflow-y:scroll;">
    </div> 
```

我需要尽快答复，请帮忙！谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:35:20.613

要将背景图像设置在固定位置，可以使用以下 CSS：

```
background-attachment:fixed; 
```

[您可以在http://www.w3schools.com/cssref/pr_background-attachment.asp](http://www.w3schools.com/cssref/pr_background-attachment.asp)`background-attachment`找到有关该物业的更多信息

# mysql - 如何返回按 COUNT(*) 降序排列的行？

> ID：14266741
> 
> 赞同：7
> 
> 时间：2013-01-10T20:32:04.150
> 
> 标签：mysql, sql, count, query-optimization

我有一个`foo`用这些字段调用的表：

```
- id

- type

- parentId 
```

我想选择一个父IDS列表，按照`COUNT(*)`它们在表中出现次数的降序排列。像这样的东西：

```
SELECT DISTINCT parentId FROM `foo` 
ORDER BY (COUNT(parentId) DESC where parentId = parentId) 
```

如何以最有效的方式完成这项工作，并在服务器上施加最少的负载？

表中可能有成千上万条记录，因此手动浏览每条记录是不可接受的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-01-10T20:34:21.113

只需应用一个`GROUP BY`子句，并假设您有一个 index 、`FOREIGN KEY`或`PRIMARY KEY`on `parentId`，性能应该会非常好。（`parentId`看起来很可能是 a `FORIEGN KEY`，所以一定要定义约束来强制索引）。

```
SELECT `parentId`
FROM `foo`
GROUP BY `parentId`
ORDER BY COUNT(*) DESC 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:36:34.630

> 如何以最有效的方式完成这项工作，并在服务器上施加最少的负载？

关键是**最有效的方法**。

肯定不是 Count()，但最有效的是......读取一个字段，您正在存储 Count 结果。您可以使用触发器或插入后更新它。

尤其是当

> 表中可能有成千上万条记录

# iphone - 如何将数组添加到 nsdictionary 中的键

> ID：14266744
> 
> 赞同：1
> 
> 时间：2013-01-10T20:32:10.443
> 
> 标签：iphone, ios, objective-c, nsdictionary

我想将数组添加到 nsdictionary 中的键。例如每个键是一个问题，每个问题都有多个答案。

问题1 = [答案1]，[答案2]，[答案3]；

问题2 = [答案1]，[答案2]，[答案3]；

使用下面的代码，我得到**No Visible @interface for NSDictionary 声明选择器'setObject:forKey:'**

```
//answers
_surveyAnswers1 = [[NSMutableDictionary alloc] init];
NSArray *myArrayAnswers1 = [NSArray arrayWithObjects:@"One",@"Two", nil];
NSArray *myArrayAnswers2 = [NSArray arrayWithObjects:@"Three",@"Four", nil];
[_surveyAnswers1 setObject:myArrayAnswers1 forKey:@"FirstKey"];
[_surveyAnswers1 setObject:myArrayAnswers2 forKey:@"SecondKey"]; 
```

将数组添加到 NSDictionary 中的键的正确方法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:34:12.800

`_surveyAnswers1`似乎被宣布为`NSDictionary`：

```
NSDictionary * _surveyAnswers1; 
```

您需要将其声明为`NSMutableDictionary`：

```
NSMutableDictionary * _surveyAnswers1; 
```

编译器根据声明的类型检查对象上可用的方法；`NSDictionary`没有 method `setObject:forKey:`，所以编译器会警告你（在 ARC 下，这是一个错误）。它可以在运行时工作，因为该对象*实际上是*一个`NSMutableDictionary`，但您仍然应该修复声明。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:39:45.523

尽管您将 _surveyAnswers1 实例化为 NSMutableDictionary，但它被声明为 NSDictionary 类型，因此在调用 setObject:forKey 时将 _surveyAnswers1 更改为 NSMutableDictionary 类型或将 _surveyAnswers1 转换为 NSMutableDictionary：

```
[((NSMutableDictionary *)_surveyAnswers1) setObject:myArrayAnswers1 forKey:@"FirstKey"];
[((NSMutableDictionary *)_surveyAnswers1) setObject:myArrayAnswers2 forKey:@"SecondKey"]; 
```

# javascript - Jquery Mobile 1.8.2：捕获滚动停止事件

> ID：14266746
> 
> 赞同：4
> 
> 时间：2013-01-10T20:32:16.840
> 
> 标签：javascript, jquery-mobile

当谈到 javascript 和 Jquery 时，我是一个（非常）初学者，所以请多多包涵。

我想做的是设置一个事件侦听器来检测滚动何时停止。我的理解是解决方案有两个部分：

1.  设置侦听器的语句。
2.  事件触发时调用的函数。

我正在使用使用 Jquery 1.8.2 的 MobiOne 开发环境

从 Jquery 文档中，我有这个语句来监听事件：

```
$('#m1-Equiv-eISOFrame').on('scrollstop',eFisoScroll); 
```

`'#m1-Equiv-eISOFrame'`是用户滚动的元素的名称。
`eFisoScroll`是事件触发时要调用的函数的名称。

我已将侦听代码放在环境预定义的文档就绪处理程序中，并将其他代码放在我的程序主体中，并且......它不起作用。（去搞清楚）

使用调试器（带断点）跟踪程序显示代码正在被解析，但滚动停止事件没有被捕获，显然我的处理函数永远不会执行。

那么，我做错了什么，或者我错过了哪些额外的事情是完成这项工作所必需的。

任何帮助表示赞赏，

谢谢

* * *

@Pow-lan，

是的，我确实尝试过这种修改，但它也不起作用。如果我使用您建议的格式将“scrollstop”替换为“click”；点击事件确实被困住了！

因此，代码和语句的位置是正确的，但 'scrollstop' 事件被忽略或由于某种未知原因未正确处理。啊啊啊啊。

因为我可以捕获单击事件，所以我在函数 eFisoScroll 中为 scrollstop 事件编写了捕获代码，只是为了查看代码放置是否是问题所在，但它也在那里失败了。

谜团越来越深……

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-20T01:06:22.560

```
jQuery('#listfavorites').bind('scrollstop',function(){
eFisoScroll();

}); 
```

# c# - 在对象列表中搜索任何和所有匹配项

> ID：14266753
> 
> 赞同：6
> 
> 时间：2013-01-10T20:32:39.847
> 
> 标签：c#, .net, linq

我有一个`List<T>`实例`User`，我需要搜索`User`.

这样做最有效的方法是什么？

这是我的`User`班级的定义：

```
public class User
{
    public String SamAccountName { get; set; }
    public String EmailAddress { get; set; }
    public String WorkPhone { get; set; }
    public String MobilePhone { get; set; }
    public String Office { get; set; }
} 
```

我需要搜索以查看“Tom”的值是否包含在任何字段中的任何字符串中，并返回一个`List<T>`仅包含与该条件匹配的实例的新值。

我想用 LINQ 做到这一点，但不知道怎么做。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T20:35:24.927

假设你有一个[`IEnumerable<User>`](http://msdn.microsoft.com/en-us/library/9eekhta0.aspx)，你可以这样做：

```
// Query for "Tom" being contained in any of the fields.
var query =
    from user in users
    where
        (user.SamAccountName != null && user.SamAccountName.Contains("Tom")) ||
        (user.EmailAddress != null && user.EmailAddress.Contains("Tom")) ||
        (user.WorkPhone != null && user.WorkPhone.Contains("Tom")) ||
        (user.MobilePhone != null && user.MobilePhone.Contains("Tom")) ||
        (user.Office != null && user.Office.Contains("Tom"))
    select user; 
```

`null`请注意，如果这些字段中的任何一个为空，则检查很重要，否则，当您在[类上调用该](http://msdn.microsoft.com/en-us/library/system.string.aspx)[`Contains`方法](http://msdn.microsoft.com/en-us/library/dy85x1sa.aspx)时，它将抛出 a ，因为没有字符串可以调用on。[`String`](http://msdn.microsoft.com/en-us/library/system.string.aspx)[`NullReferenceException`](http://msdn.microsoft.com/en-us/library/system.nullreferenceexception.aspx)`Contains`

该[`where`子句](http://msdn.microsoft.com/en-us/library/bb311043.aspx)只是映射到[类](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)上的[`Where`扩展方法](http://msdn.microsoft.com/en-us/library/bb534803.aspx)（确保有一个声明，以便编译器识别扩展方法）。[`Enumerable`](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.aspx)`using System.Linq;`

如果您觉得 null 检查过多和/或重复，您可以像这样缩减代码：

```
// Generate your predicate.
Func<string, bool> checkContainsTom = s => s != null && s.Contains("Tom");

// Query.
var query =
    from user in users
    where
        checkContainsTom(user.SamAccountName) ||
        checkContainsTom(user.EmailAddress) ||
        checkContainsTom(user.WorkPhone) ||
        checkContainsTom(user.MobilePhone) ||
        checkContainsTom(user.Office)
    select user; 
```

这稍微好一些，因为您正在封装冗余逻辑；如果逻辑发生变化，您只需在一处进行更改，它将应用于所有检查。如果需要，请随意用函数替换[lambda 表达式。](http://msdn.microsoft.com/en-us/library/bb397687.aspx)

如果要使用[延迟执行](http://msdn.microsoft.com/en-us/library/bb738633.aspx)`query`，则可以使用 a进行枚举。如果您需要在具体化列表中使用它（例如 a ），那么您只需调用类的[扩展方法](http://msdn.microsoft.com/en-us/library/bb342261.aspx)，如下所示：[`foreach`](http://msdn.microsoft.com/en-us/library/ttw7t8t6.aspx)[`List<User>`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)[`ToList`](http://msdn.microsoft.com/en-us/library/bb342261.aspx)`Enumerable`

```
 IList<User> materializedResults = query.ToList(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T21:22:27.397

在某个静态类中复制一种通用扩展方法：

```
 public static IEnumerable<T> WhereAtLeastOneProperty<T, PropertyType>(this IEnumerable<T> source, Predicate<PropertyType> predicate)
    {            
        var properties = typeof(T).GetProperties().Where(prop => prop.CanRead && prop.PropertyType == typeof(PropertyType)).ToArray();
        return source.Where(item => properties.Any(prop => PropertySatisfiesPredicate(predicate, item, prop)));
    }

    private static bool PropertySatisfiesPredicate<T, PropertyType>(Predicate<PropertyType> predicate, T item, System.Reflection.PropertyInfo prop)
    {
        try
        {
            return predicate((PropertyType)prop.GetValue(item));
        }
        catch
        {
            return false;
        }
    } 
```

然后你只需调用：

```
var usersList = new List<User>();
var filteredUsersList = usersList.WhereAtLeastOneProperty((string s) => s.Contains("Tom")).ToList(); 
```

或者使用其他一些更适合您需求的 lambda。例如

```
.WhereAtLeastOneProperty((string s) => s=="Tom") 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-01-10T20:34:16.547

它不漂亮，但它应该可以工作：

```
users.Where(u => u.SamAccountName.Contains("Tom") ||
                 u.EmaildAddress.Contains("Tom") ||
                 u.WorkPhone.Contains("Tom") ||
                 u.MobilePhone.Contains("Tom") ||
                 u.Office.Contains("Tom")); 
```

虽然，我不得不说，我不明白为什么你需要在电话号码中搜索字符串“Tom”。

# mysql - 数据库开发问题 MySQL

> ID：14266754
> 
> 赞同：0
> 
> 时间：2013-01-10T20:32:42.740
> 
> 标签：mysql, database

我需要各位专家提供有关数据库开发实践的帮助。我有几个关于 MySQL 数据库的问题：

1.  MySQL 有没有办法用 XML 语言开发数据库及其结构，然后转换为功能齐全的 MySQL 数据库？

2.  是否可以基于 MySQL 中的现有数据库从问题 1（见上文）生成 XML 源文件？

3.  据我所知，XML 不适合开发数据库结构。但是我们能说XML是一种表现层次结构的语言，而MySQL数据库也表现出层次结构，那么它实际上适合数据库开发吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:36:48.767

您当然可以在 MySQL 中存储 XML 数据。您还可以使用多种方法将分层 XML 数据转换为单独的关系数据库字段表示。

但是我想说，如果您只想使用完整的 XML 文档，您可能会考虑走 NoSQL 路线，它确实更适合这种类型的数据存储。您还可以将 JSON 视为存储格式，因为它更简洁（节省空间和传输宽度）并且更符合流行的 NoSQL 数据存储。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:46:28.183

1）是的，有一种方法，但如果你想要一个动态数据库结构，你应该查看 mongodb，它是在考虑到这一点的情况下开发的。此外，除非您需要 xml 的 rss 功能或类似功能，否则您可能需要考虑使用 json 作为文档格式。

2) json 和 mongodb 可以很好地协同工作，可以快速轻松地将文档进出数据库。从技术上讲，您也可以在 mysql 中执行此操作，但您可能会花费更多时间在 php 或 ruby​​ 中编写脚本以获得所需的格式。

3）您可以使用 xml 来展示您的数据库结构，因为它的结构松散，但我不确定其他人是否会直观地清楚。很难说，真的取决于你如何实现它以及你的数据库结构有多复杂。

# ios - 不起作用 UITableViewCell 的方法

> ID：14266757
> 
> 赞同：0
> 
> 时间：2013-01-10T20:32:50.040
> 
> 标签：ios, objective-c

当我做简单的 HelloWorld 应用程序时，我遇到了问题

```
[self.tableView insertRowsAtIndexPaths:@[indexPath]withRowAnimation:UITableViewRowAnimationAutomatic] 
```

，这种方法不起作用......我不知道为什么？帮助

代码：

```
- (void)viewDidLoad
{
int i = 0;
[super viewDidLoad];
    while (i < 10 ) {
        NSIndexPath *indexPath = [NSIndexPath indexPathForRow:0 inSection:0];
        [self.tableView insertRowsAtIndexPaths:@[indexPath]withRowAnimation:UITableViewRowAnimationAutomatic];
        i++;
    }
}
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return 1;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
   static NSString *CellIdentifier = @"Cell";
   UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
   cell.textLabel.text = @"HelloWorld";
   return cell;
} 
```

**应用程序应该创建 10 个带有标签 @"HelloWorld" 的单元格**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:38:01.617

你以错误的方式解决这个问题。如果你想要 10 个单元格，你不应该一次添加一个，你应该在 numberOfRowsInSection 中返回 10，例如：

```
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section {
    return 10;
} 
```

此外，单元格中不会显示任何内容，因为您在 cellForRowAtIndexPath 中的单元格上调用了 alloc/init。像这样修改您的代码：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }
    cell.textLabel.text = @"HelloWorld";
    return cell;
} 
```

# django - GAE SDK 1.7.4 中的 Django 表单 API

> ID：14266758
> 
> 赞同：1
> 
> 时间：2013-01-10T20:32:52.607
> 
> 标签：django, google-app-engine, django-forms

我[在 SDK 发行说明 1.7.3 下](http://code.google.com/p/googleappengine/wiki/SdkReleaseNotes#Version_1.7.3_-_October_23,_2012)阅读了 GAE 支持 Django 1.4。我知道 Django 模型不能在 GAE 中使用，因为我们有 Google 自己的模型。但是[Django 表单 API](https://docs.djangoproject.com/en/dev/ref/forms/api/)呢，尤其[是使用模板显示表单](https://docs.djangoproject.com/en/dev/topics/forms/#displaying-a-form-using-a-template)呢？可以在 SDK 1.7.4 中使用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T21:02:17.533

是的，当然您可以使用表单 API 并将其显示在模板中。但是你不能在 GAE 上使用普通的 Django 来自动从 db.Model 或 ndb.Model 构建一个模型表单。您必须使用普通表单，定义字段并将数据手动设置回模型实体。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-10T23:40:02.860

虽然您不能使用 django 模型表单，但 GAE 提供了一个表单库，可为基于 db.Model 的模型提供类似的功能。

[https://developers.google.com/appengine/articles/djangoforms](https://developers.google.com/appengine/articles/djangoforms)

我不确定ndb是否有等价物。

# makefile - 关于 Makefile 中的深层头文件

> ID：14266759
> 
> 赞同：0
> 
> 时间：2013-01-10T20:32:54.970
> 
> 标签：makefile

假设我有一个包含在许多源文件中的头文件，可能具有非常深的层次结构。在每个源对象的先决条件中列出这个通用头文件很无聊，不确定是否有优雅的解决方案。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:09:36.230

您可以使用`gcc -M`. 来自[TFM](http://gcc.gnu.org/onlinedocs/gcc/Preprocessor-Options.html#index-M-954)：

`-M Instead of outputting the result of preprocessing, output a rule suitable for make describing the dependencies of the main source file. The preprocessor outputs one make rule containing the object file name for that source file, a colon, and the names of all the included files, including those coming from -include or -imacros command line options.`

另请参阅[自动生成先决条件](http://www.gnu.org/software/make/manual/html_node/Automatic-Prerequisites.html)。

# javascript - 子节点多个javascript XML

> ID：14266760
> 
> 赞同：2
> 
> 时间：2013-01-10T20:32:56.593
> 
> 标签：javascript, xml, dom

尝试退出 XML 时无法选择孩子 - 在这种情况下，它是作者：

```
<book category="WEB">
<title lang="en">XQuery Kick Start</title>
<author>James McGovern</author>
<author>Per Bothner</author>
<author>Kurt Cagle</author>
<author>James Linn</author>
<author>Vaidyanathan Nagarajan</author>
<year>2003</year>
<price>49.99</price>
</book> 
```

我无法让 javascript 脚本显示我选择的作者。意思是如果我这样做。

```
txt=xmlDoc.getElementsByTagName("title")[2].childNodes[0].nodeValue;
document.write("<p>"+txt); 
```

我得到'詹姆斯麦戈文'。但

```
txt=xmlDoc.getElementsByTagName("title")[2].childNodes[1].nodeValue;
document.write("<p>"+txt); 
```

不会给我“Per Bothner”。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T15:11:12.110

虽然我也想知道您是如何获得结果的...该`childNodes`数组不仅包含元素，而且（除其他外）还包含文本节点，即行分隔符（CR/LF）。因此，您必须遍历数组检查每个条目的节点类型。更好的选择是使用 xpath 来选择有趣的元素，[这篇文章](https://developer.mozilla.org/en/docs/Introduction_to_using_XPath_in_JavaScript)应该可以帮助您入门。

具体来说，`/book/author`将按文档顺序准确选择`author`节点。

# performance - 向大型 Solr 核心添加大量文档时的性能注意事项是什么？

> ID：14266762
> 
> 赞同：1
> 
> 时间：2013-01-10T20:33:00.587
> 
> 标签：performance, solr

如果我有一个 Solr 核心，其中有六个小字段，其中加载了 1 亿个文档，那么添加一批 100 万个文档会在合理的时间内运行吗？1000万呢？合理地说，我考虑的是几个小时，而不是几天。我被告知这将需要很长时间才能运行。这真的是一个问题吗？有哪些已知的提高性能的策略？这些字段通常很小，即 5-50 个字符。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-11T18:23:34.567

除了其他答案中已经提到的提高性能的两个建议（第一次尝试，第二次尝试）：

1) 更新时减少日志记录：在 INFO 级别 SOLR 为每个文档附加一个条目。请参阅此处了解我们是如何做到的： http: [//dmitrykan.blogspot.fi/2011/01/solr-speed-up-batch-posting.html](http://dmitrykan.blogspot.fi/2011/01/solr-speed-up-batch-posting.html)有人报告说“速度提高了 3 倍”。

2) 将 solrconfig.xml 中的段数设置为非常大的索引，例如 10000。一旦批量索引完成，将参数值改回合理的低值，例如 10。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T21:41:11.647

这是一个非常“棘手”的问题，其答案因模式而异。

1.  您的 solr 安装有六个字段。但是，实际上有多少被编入索引？如果只索引一个字段，那么在索引 6 个字段的情况下，添加 100 万个文档将比添加 100 万个文档更快。
2.  我认为被索引的字段类型也很重要。“text_general”类型的字段在索引时被分解为标记，而“string”类型的字段则不是。“字符串”类型不被分析，而是作为一个完整的令牌存储。
3.  我有一些很长的字段被索引，添加 200 万个文档需要几分钟（尽管我的安装不包含 1 亿个文档）。因此，我认为将 1000 万条记录添加到您的安装中不需要几天的时间。
4.  我不确定这一点，但也许运行 solr 实例的 cpu 的配置也很重要。所以，你可能需要看看你的 cpu 和内存是否可以处理这么多的负载。

由您决定长期运行的数据帖子是否存在问题。如果您的应用程序是用户密集型的，那么我建议您遵循某种主从配置，以便在发布数据时用户不会受到高 cpu 使用率的影响。我知道的一些关于提高性能的策略是“分片”。

[http://carsabi.com/car-news/2012/03/23/step-by-step-solr-sharding/](http://carsabi.com/car-news/2012/03/23/step-by-step-solr-sharding/)

或者是否可以按某个字段划分记录并将这些不同的文档放在不同的服务器上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T14:58:52.367

1 亿条记录对于 Solr 来说是一个相当大的索引。但是在一台好机器上添加 1000 万条记录应该是几小时而不是几天。您可能会发现[以下电子邮件线程](http://lucene.472066.n3.nabble.com/DIH-fails-after-processing-roughly-10million-records-td4031508.html)很有趣，因为它包含深入的问题和一些关于调整 10M 记录索引过程的最终建议。

此外，您没有说是否“存储”字段以及索引它们。如果你这样做了，你可能还会期待[Solr 4.1 字段压缩](http://solr.pl/en/2012/11/19/solr-4-1-stored-fields-compression/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-15T04:44:09.190

影响索引性能的一个重要参数（就时间而言）是您定义**data-config.xml**文件的方式。

如果您的字段来自数据库中的**多个表**，您可以通过 2 种方式对其进行配置：

*   [实体中的实体](http://wiki.apache.org/solr/DataImportHandler#Full_Import_Example)
*   具有连接查询的单个实体

**第二种方法**在很大程度上比第一种方法快，因为对数据库发起的查询数量减少了。

# java - Java的大表

> ID：14266768
> 
> 赞同：0
> 
> 时间：2013-01-10T20:33:22.680
> 
> 标签：java, memory-management

我正在写这个需要从文件中读取大量数据并处理它们的工作。目前我只是将它们保存到 a`Set`但显然它不起作用，在运行了几分钟后，它吐出：

> “内存不足：java 堆”错误。

现在担心读取只是工作的开始，一旦我把所有的数据都放进去，我需要建表来处理它，如果我连所有的数据都读不出来，怎么建这个巨大的表呢？我最初的计划是使用 Google guava 的 Table 类，还有其他更好的选择吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:50:11.263

正如其他人所说，如果不了解更多细节，这很难回答。由于您正在考虑使用集合来保存所有这些数据，因此听起来您不能仅仅逐行处理它。“处理数据”可能需要表中的其他数据。

这意味着您需要某种文件支持的数据库。如果您无法访问普通的关系数据库来处理此问题，那么您可以考虑使用内存数据库，例如 H2 或 JavaDB/Derby。这些类型的数据库与您的应用程序在同一 VM 中运行，但如果您进行相应配置，它们可以使用持久存储来支持大型表。

***** 编辑*******

 **这是一些可以使用 H2 之类的代码应用的代码。（省略异常处理）

```
Connection connection = DriverManager.getConnection( "jdbc:h2:pruneDB");
Statement stmt = connection.createStatement();
stmt.execute("CREATE TABLE PERSON (USER_ID INT, ITEM_ID INT, BOOK_ID INT )");
stmt.close(); 
```

此时，创建一个循环来读取您的数据行并将它们插入数据库：

```
while( hasMoreRows() ) {
    ... read the three IDs you need into variables from your file ...

    int bookId = someValueFromTheTextRow;
    int userId = someOtherValueFromTheTextRow;
    int itemId = yetAnotherValueFromTheTextRow;

    // After this, just create a PreparedStatement object, bind your IDs to it, and perform an SQL 
    // insert into the DB table you created above
} 
```

跳出循环后，您现在可以使用标准 SQL 从该表中选择性地删除项目。**

# r - read.zoo 以日期和时间作为 R 中的索引

> ID：14266769
> 
> 赞同：2
> 
> 时间：2013-01-10T20:33:34.823
> 
> 标签：r, xts, zoo

我有以下文件

```
"Index" "time"  "open"  "high"  "low"   "close" "numEvents" "volume"
2013-01-09 14:30:00 "2013-01-09T14:30:00.000"   "110.8500"  "110.8500"  "110.8000"  "110.8000"  " 57"   "32059"
2013-01-09 14:31:00 "2013-01-09T14:31:00.000"   "110.7950"  "110.8140"  "110.7950"  "110.8140"  "  2"   " 1088"
2013-01-09 14:32:00 "2013-01-09T14:32:00.000"   "110.8290"  "110.8300"  "110.8290"  "110.8299"  "  5"   "  967"
2013-01-09 14:33:00 "2013-01-09T14:33:00.000"   "110.8268"  "110.8400"  "110.8268"  "110.8360"  "  8"   " 2834"
2013-01-09 14:34:00 "2013-01-09T14:34:00.000"   "110.8400"  "110.8400"  "110.8200"  "110.8200"  " 33"   " 6400" 
```

我想将此文件读入 R 中的 zoo（或 xts）对象。此文件是作为 xts 对象创建并使用保存的`write.zoo(as.zoo(xts_object), path, sep = "\t")`，现在我正在尝试使用`zoo_object <- read.zoo(path, sep = "\t", header=TRUE, format="%Y-%m-%d %H:%M:%S")`. 但是，我收到以下警告

```
Warning message:
In zoo(rval3, ix) :
  some methods for “zoo” objects do not work if the index entries in ‘order.by’ are not unique 
```

当我`zoo_object`在控制台中输入以显示其内容时，我得到：

```
 time                    open     high    low      close    numEvents volume
2013-01-09 2013-01-09T14:30:00.000 110.8500 110.850 110.8000 110.8000 57        32059 
2013-01-09 2013-01-09T14:31:00.000 110.7950 110.814 110.7950 110.8140  2         1088 
2013-01-09 2013-01-09T14:32:00.000 110.8290 110.830 110.8290 110.8299  5          967 
2013-01-09 2013-01-09T14:33:00.000 110.8268 110.840 110.8268 110.8360  8         2834 
2013-01-09 2013-01-09T14:34:00.000 110.8400 110.840 110.8200 110.8200 33         6400 
```

您可以在其中看到时间不包含在行索引中。我假设我可以将时间字段转换为索引并修复我的问题，但我也假设我在读取这个文件（或者可能是写入）时做错了，但是经过一整天的搜索，我不知道是什么。任何人都可以提供任何见解吗？

`dput(zoo_object)`读后

```
dput(zoo_object)
structure(c("2013-01-09T14:30:00.000", "2013-01-09T14:31:00.000", 
"2013-01-09T14:32:00.000", "2013-01-09T14:33:00.000", "2013-01-09T14:34:00.000", 
"110.8500", "110.7950", "110.8290", "110.8268", "110.8400", "110.850", 
"110.814", "110.830", "110.840", "110.840", "110.8000", "110.7950", 
"110.8290", "110.8268", "110.8200", "110.8000", "110.8140", "110.8299", 
"110.8360", "110.8200", "57", " 2", " 5", " 8", "33", "32059", 
" 1088", "  967", " 2834", " 6400"), .Dim = c(5L, 7L), .Dimnames = list(
    NULL, c("time", "open", "high", "low", "close", "numEvents", 
    "volume")), index = structure(c(15714, 15714, 15714, 15714, 
 15714), class = "Date"), class = "zoo") 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T21:11:31.633

（请注意，测试所需的对象是传递给 write.zoo 的对象，而不是最终对象。）

默认情况下（看起来）使用的日期时间函数`read.zoo`是`as.Date`，而我猜它会是`as.POSIXct`. 您可以通过以下方式强制执行所需的行为：

```
zoo_object <- read.zoo("~/test", index.column=2, sep = "\t", 
                        header=TRUE, format="%Y-%m-%dT%H:%M:%S", FUN=as.POSIXct) 
```

请注意，我稍微更改了您的格式，因为在编辑器中查看文本输出时，它似乎是一列，其中“T”作为日期和时间文本之间的分隔符。

# ember.js - 编写 LightboxView 会导致问题/集成 DOM 操作 jQuery-Plugins 使操作无法使用

> ID：14266771
> 
> 赞同：2
> 
> 时间：2013-01-10T20:33:37.980
> 
> 标签：ember.js, lightbox

**一般问题** 当尝试集成 DOM Manipulating 3rd Party 库时，可能会出现问题。在这种特殊情况下，一个 jQuery Lightbox 插件引起了问题。

**原始问题** 目前我正在尝试将以下 Lightboxplugin 集成到 Ember 视图中：[http ://codecanyon.net/item/jquery-lightbox-evolution/115655](http://codecanyon.net/item/jquery-lightbox-evolution/115655)

这是我当前的视图代码：

```
App.LightboxView = Ember.View.extend({
    templateName : 'whatever',
    isVisible : false,
    willInsertElement : function(){
        var that = this;
        $.lightbox(this.$(),{
            width   : 600,
            height  : 850,
            onOpen : function(){
                that.$().fadeIn(400);
                that.set("isVisible", true);
            },
        });
    },
}); 
```

这种方法工作得很好，因为它在将视图插入 DOM 的那一刻启动插件并且一切都显示得很好。Ember 似乎将 View 的结果 html 插入到 DOM 中，并且灯箱插件获取 DOM 元素并将其放置到灯箱工作所需的位置。但这就是问题的开始。在我看来，行动不再起作用。在我看来，我有一些 {{action}} 助手，但它们都不起作用（当我不使用灯箱时它们正在工作）。我认为这是因为插件对 DOM 进行了操作，但 Ember 希望成为唯一一个操作 DOM 的插件。

有人可以在这里提供一些指导吗？这是我第一次开发/使用灯箱，所以这可能会导致其他问题:-)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-13T16:21:37.113

这是我在 sly7_7 的帮助下找到的解决方案：

**是什么导致了问题？** 正如我的问题中所述，我编写了一个新视图，该视图应该在灯箱插件的帮助下显示为灯箱。这意味着由 EmberJS 插入的 DOMElement 帽子将被插件移动到 DOM 内部。问题是我的应用程序是这样声明的：

```
App = Ember.Application.create({
    rootElement : "#ember-application-root",
}); 
```

相应的 HTML 是：

```
<html>
   <body>
     <div id="ember-application-root" />
   </body>
</html> 
```

**应用程序的根只是指 DOM 的一部分。**Lightbox 插件在 DOM 的末尾插入了它的内容，这意味着**Ember 视图被拉到了 Ember 应用程序的 div 之外，因此失去了它的事件监听器**。

**解决方案：** 使 body 元素成为 Ember 应用程序的根。正如 sly7_7 在他的评论中概述的那样，这是 Ember 应用程序的默认情况。

```
App = Ember.Application.create({
    // rootElement : "#ember-application-root", - defaults to body now
}); 
```

# c++ - 如何在 Linux 中调用“cpuid”？

> ID：14266772
> 
> 赞同：9
> 
> 时间：2013-01-10T20:33:45.313
> 
> 标签：c++, assembly, gcc, x86, cpuid

在为 Windows 编写新代码时，我偶然发现`_cpuinfo()`了 Windows API。因为我主要处理 Linux 环境 (GCC)，所以我想访问 CPUInfo。

我尝试了以下方法：

```
#include <iostream>

int main()
{
  int a, b;

  for (a = 0; a < 5; a++)
  {
    __asm ( "mov %1, %%eax; "            // a into eax
          "cpuid;"
          "mov %%eax, %0;"             // eax into b
          :"=r"(b)                     // output
          :"r"(a)                      // input
          :"%eax","%ebx","%ecx","%edx" // clobbered register
         );
    std::cout << "The CPUID level " << a << " gives EAX= " << b << '\n';
  }

  return 0;
} 
```

这个使用程序集，但我不想重新发明轮子。有没有其他方法可以在不组装的情况下实现 CPUInfo？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-01-10T20:44:07.717

由于您正在使用 GCC 进行编译，因此您可以包含`cpuid.h`声明这些函数的哪个：

```
/* Return highest supported input value for cpuid instruction.  ext can
   be either 0x0 or 0x8000000 to return highest supported value for
   basic or extended cpuid information.  Function returns 0 if cpuid
   is not supported or whatever cpuid returns in eax register.  If sig
   pointer is non-null, then first four bytes of the signature
   (as found in ebx register) are returned in location pointed by sig.  */
unsigned int __get_cpuid_max (unsigned int __ext, unsigned int *__sig)

/* Return cpuid data for requested cpuid level, as found in returned
   eax, ebx, ecx and edx registers.  The function checks if cpuid is
   supported and returns 1 for valid cpuid information or 0 for
   unsupported cpuid level.  All pointers are required to be non-null.  */
int __get_cpuid (unsigned int __level,
    unsigned int *__eax, unsigned int *__ebx,
    unsigned int *__ecx, unsigned int *__edx) 
```

您不需要也不应该重新实现此功能。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-10T20:45:33.850

```
for (a =0; a < 5; ++a;) 
```

那里应该只有两个分号。你有三个。

这是基本的 C/C++ 语法；CPUID 是一个红鲱鱼。

# iphone - iOS iPhone 5 选择正确的故事板

> ID：14266776
> 
> 赞同：4
> 
> 时间：2013-01-10T20:34:04.030
> 
> 标签：iphone, ios, objective-c, cocoa-touch, storyboard

我正在尝试将两个故事板用于我的 iOS 项目，但我无法获取代码以切换到适当的故事板。相反，代码完全没有做任何事情。是我没有正确设置控制开关的设置吗？非 iPhone 5 设备的主故事板称为 MainStoryboard。iphone 5 合适的布局称为iphone5。我认为这可能是项目配置设置问题。（这在我的 appdelegate.m 文件中）。

```
-(void)initializeStoryBoardBasedOnScreenSize {

    if ([UIDevice currentDevice].userInterfaceIdiom == UIUserInterfaceIdiomPhone)
    {    // The iOS device = iPhone or iPod Touch

        CGSize iOSDeviceScreenSize = [[UIScreen mainScreen] bounds].size;

        if (iOSDeviceScreenSize.height == 480)
        {   // iPhone 3GS, 4, and 4S and iPod Touch 3rd and 4th generation: 3.5 inch screen (diagonally measured)

            // Instantiate a new storyboard object using the storyboard file named Storyboard_iPhone35
            UIStoryboard *iPhone35Storyboard = [UIStoryboard storyboardWithName:@"MainStoryboard" bundle:nil];

            // Instantiate the initial view controller object from the storyboard
            UIViewController *initialViewController = [iPhone35Storyboard instantiateInitialViewController];

            // Instantiate a UIWindow object and initialize it with the screen size of the iOS device
            self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

            // Set the initial view controller to be the root view controller of the window object
            self.window.rootViewController  = initialViewController;

            // Set the window object to be the key window and show it
            [self.window makeKeyAndVisible];
        }

        if (iOSDeviceScreenSize.height == 568)
        {   // iPhone 5 and iPod Touch 5th generation: 4 inch screen (diagonally measured)

            // Instantiate a new storyboard object using the storyboard file named Storyboard_iPhone4
            UIStoryboard *iPhone4Storyboard = [UIStoryboard storyboardWithName:@"iphone5" bundle:nil];

            // Instantiate the initial view controller object from the storyboard
            UIViewController *initialViewController = [iPhone4Storyboard instantiateInitialViewController];

            // Instantiate a UIWindow object and initialize it with the screen size of the iOS device
            self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];

            // Set the initial view controller to be the root view controller of the window object
            self.window.rootViewController  = initialViewController;

            // Set the window object to be the key window and show it
            [self.window makeKeyAndVisible];
        }

    } else if ([UIDevice currentDevice].userInterfaceIdiom == UIUserInterfaceIdiomPad)

    {   // The iOS device = iPad

        UISplitViewController *splitViewController = (UISplitViewController *)self.window.rootViewController;
        UINavigationController *navigationController = [splitViewController.viewControllers lastObject];
        splitViewController.delegate = (id)navigationController.topViewController;

    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-10T21:03:45.147

我建议只使用 1 个故事板来处理 iPhone 5 与 iPhone 3-4S 的屏幕尺寸。

当您的故事板打开时，底部有一个按钮，可以在两种尺寸之间切换——您可以实时查看事物的外观。

该按钮位于右下角 Zoom in % Zoom out 按钮的左侧，如下所示：

![在此处输入图像描述](../Images/9adfe07c5cc04e461a1f3eb99f390069.png)

要处理对象的框架和位置如何受屏幕尺寸变化的影响——您需要为视图中的每个对象设置自动调整大小的属性。您可以通过选择一个对象来执行此操作，然后在右侧 Inspector 面板中，选择 Size 检查器，如下所示：

![在此处输入图像描述](../Images/25cfe8d748279967566b62120e798761.png)

您看到 Autosizing 框中的那些红线了吗？与他们一起玩，看看他们将如何影响您的对象。内部的与大小有关（如果宽度或高度拉伸），外部的与位置有关。

我不确定您的应用程序布局，但根据经验，您可能不得不弄乱内部垂直线（高度将如何变化）和底线（您希望它保持在底部附近）。

你与每个人相处得越多，你就会越了解每个人的作用。

# android - 为什么 setImeOptions 不起作用？与 setTextSize 相同

> ID：14266782
> 
> 赞同：2
> 
> 时间：2013-01-10T20:34:24.997
> 
> 标签：android, textview, ime

我的代码：

```
TextView tv = new TextView(this);
final EditText newPositionName = new EditText(this);

newPositionName.setImeOptions(EditorInfo.IME_ACTION_SEARCH);
newPositionName.setBackgroundColor(Color.TRANSPARENT); 
```

我不明白为什么 setImeOptions 不起作用！setBackgroundColor 工作正常。与 setTextSize 相同。我有：

```
private Vector<TextView> ranking = new Vector<TextView>();
...
for(int i = 0; i < 5; i++){
    ranking.add(new TextView(this));
    ranking.lastElement().setTextSize(30);
} 
```

但文字大小不会改变。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-21T15:36:17.877

正如这里所指出的：[setImeOptions：为什么软键盘上不显示“完成”按钮？](https://stackoverflow.com/questions/13561808/setimeoptions-why-the-done-button-does-not-show-on-the-soft-keyboard) 调用`setSingleLine()`TextEdit 将启用该功能。

# c++ - OpenGL - 启用混合后纹理不可见

> ID：14266789
> 
> 赞同：0
> 
> 时间：2013-01-10T20:35:00.477
> 
> 标签：c++, opengl

当我尝试在对象上显示纹理时，它可以工作，但仅限于`GL_BLEND`禁用。当我启用混合时：

```
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); 
```

纹理不再可见。黑屏。我真的不知道发生了什么。对于 JPG 和带有 alpha 通道的 PNG，它也是一样的。

编辑（更多细节）：

好吧，很难粘贴代码（对象，到处都是巨大的对象），但它是这样的：

//初始化 - 我评论了其他所有内容

```
glEnable(GL_BLEND);
glBlendFunc(GL_SRC_ALPHA, GL_ONE_MINUS_SRC_ALPHA); 
```

//准备纹理

```
glEnable(GL_TEXTURE_2D);
glGenTextures(1, &texture_id);
glBindTexture(GL_TEXTURE_2D, texture_id);

int Mode = GL_BGR;

int nOfColors = image->format->BytesPerPixel;
if (nOfColors == 4) {
    if (image->format->Rmask == 0x000000ff)
        Mode = GL_RGBA;
    else
        Mode = GL_BGRA;
} else if (nOfColors == 3) {
    if (image->format->Rmask == 0x000000ff)
        Mode = GL_RGB;
    else
        Mode = GL_BGR;
}

// glTexEnvf( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_MODULATE );
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_S, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_WRAP_T, GL_CLAMP_TO_EDGE);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);
glTexParameteri(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);
//glTexEnvi(GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_DECAL);

glTexImage2D(GL_TEXTURE_2D, 0, nOfColors, image->w, image->h, 0, Mode, GL_UNSIGNED_BYTE, image->pixels);
glDisable(GL_TEXTURE_2D); 
```

//绘画

```
glColor4f(1.0f,1.0f,1.0f,1.0f);
glEnable(GL_TEXTURE_2D);
glBindTexture( GL_TEXTURE_2D, _i );

glBegin(GL_QUADS);
glTexCoord2f(0, 0);
glVertex2f(x, y);
glTexCoord2f(1, 0);
glVertex2f(x + width, y);
glTexCoord2f(1, 1);
glVertex2f(x + width, y + height);
glTexCoord2f(0, 1);
glVertex2f(x, y + height);
glEnd();

glBindTexture( GL_TEXTURE_2D, NULL );
glDisable(GL_TEXTURE_2D); 
```

编辑2

“黑屏”可能有点令人困惑 - 我的意思是什么都没有显示（我的背景是黑色的，但没关系） - 如果我关闭混合，我会在屏幕上获得很好的纹理 - 除了背景颜色之外什么都没有混合

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T22:24:23.943

您是否尝试调用 glTexEnvf？

```
glTexEnvf( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE); 
```

这是示例：[http ://unick-soft.ru/art/files/basicBlend.zip](http://unick-soft.ru/art/files/basicBlend.zip)

对于您的情况，您需要查看以下代码：

```
//draw texture
glPushMatrix();
glColor4f(1.0, 1.0, 0.0, 1.0);
texture.switchOffTexture();
Sphere.drawObject();  
glTranslatef(0.0, 0.0, 7.0);
glTexEnvf( GL_TEXTURE_ENV, GL_TEXTURE_ENV_MODE, GL_REPLACE );
texture.bindTexture();
glBegin(GL_POLYGON);
  glTexCoord2f(0.0, 0.0);
  glVertex3f(-1.0, -1.0, 0.0);  
  glTexCoord2f(1.0, 0.0);
  glVertex3f(1.0, -1.0, 0.0);
  glTexCoord2f(1.0, 1.0);
  glVertex3f(1.0, 1.0, 0.0);
  glTexCoord2f(0.0, 1.0);
  glVertex3f(-1.0, 1.0, 0.0);
glEnd();
glPopMatrix(); 
```

如果编译有问题，可以评论包括：#include < gl\glux.h >

按 1、2、3 选择混合类型。在案例 3 中，您将看到此结果[http://unick-soft.ru/art/img/blend/text_blend.png](http://unick-soft.ru/art/img/blend/text_blend.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T21:57:35.473

似乎您的 Alpha 通道全为 0 - 您确定您正在正确读取纹理（使用 Alpha 通道）吗？尝试手动填充它或检查它是否真的被您用来将文件读取为像素的任何软件填充。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T11:52:12.243

因此，在我将图像加载库更改为 DevIL 后，它终于开始工作了。以前的 alpha 通道似乎有问题。

感谢你的帮助

# css - 使用引导程序的响应式设计时，如何使用 CSS 使宽度变得灵活？

> ID：14266794
> 
> 赞同：0
> 
> 时间：2013-01-10T20:35:16.360
> 
> 标签：css

首先，我使用的是引导程序的响应式设计。
我希望这个气泡适合液体。但是如果它的宽度很窄，它就会突出。
我怎样才能解决这个问题？
它还必须适合任何宽度。
是否可以？

![收缩时，气泡伸出！](../Images/815aed55ab307e9f1bcb7ece28d701b5.png)

**演示** [http://jsfiddle.net/SAKWb/](http://jsfiddle.net/SAKWb/)

**HTML**

```
<div class="chat">

<table>
  <tbody>
     <tr>
               <th>Body</th>
     </tr>

    <tr id="comment_617">
            <td><div class="bubble me"><span class="text-error">01-10 03:29</span>：Person A<br>
            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
            <form action="/shop/walmart/posts/617" class="button_to" data-remote="true" method="post"><div><input name="_method" value="delete" type="hidden"><input data-confirm="Are you sure?" data-disable-with="deleting..." value="destroy" type="submit"><input name="authenticity_token" value="aoLKQnl4M2SWVlOrXGR+qIMLSeY5m1tKiC/PSnYQjmw=" type="hidden"></div></form>
            </div></td>
    </tr>

    <tr id="comment_615">
            <td><div class="bubble me"><span class="text-error">01-10 03:25</span>：Person A<br>
            bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb
            <form action="/shop/walmart/posts/615" class="button_to" data-remote="true" method="post"><div><input name="_method" value="delete" type="hidden"><input data-confirm="Are you sure?" data-disable-with="deleting..." value="destroy" type="submit"><input name="authenticity_token" value="aoLKQnl4M2SWVlOrXGR+qIMLSeY5m1tKiC/PSnYQjmw=" type="hidden"></div></form>
            </div></td>
    </tr>
</tbody>

 <div> 
```

**CSS**

```
.chat {
    width: 100%;
    min-width: 300px;
}

.bubble{
    background-color: #FFFFFF;
    border-radius: 5px;
    box-shadow: 0 0 6px #B2B2B2;
    display: inline-block;
    padding: 10px 18px;
    position: relative;
    vertical-align: top;
    word-break: break-all;
}

.bubble::before {
    background-color: #FFFFFF;
    content: "\00a0";
    display: block;
    height: 16px;
    position: absolute;
    top: 11px;
    transform:             rotate( 29deg ) skew( -35deg );
        -moz-transform:    rotate( 29deg ) skew( -35deg );
        -ms-transform:     rotate( 29deg ) skew( -35deg );
        -o-transform:      rotate( 29deg ) skew( -35deg );
        -webkit-transform: rotate( 29deg ) skew( -35deg );
    width:  20px;
}

.me {
    float: left;   
    margin: 5px 45px 5px 5px;
    min-width: 250px; 
    width: 100%;      
}

.me::before {
    box-shadow: -2px 2px 2px 0 rgba( 178, 178, 178, .4 );
    left: -9px;           
}

.you {
    float: left;    
    margin: 5px 10px 5px 5px;
    min-width: 250px;
    width: 100%;          
}

.you::before {
    box-shadow: 2px -2px 2px 0 rgba( 178, 178, 178, .4 );
    right: -9px;    
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:40:43.880

气泡的灰色背景有一类 `.hero-unit`- 填充将气泡推出灰色背景

```
.hero-unit {
padding: 15px;  /*This was 60px*/
...
} 
```

然后气泡的宽度需要从 100% 减少，因为有 15px 填充，所以改变这个

```
.me {
float: left;
margin: 5px 45px 5px 5px;
min-width: 250px;
width: 85%;  /*this line was 100%*/
} 
```

如果要保持 60px 的 padding 是可以的，但是宽度`.me`必须更小，相应调整

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:49:01.790

假设您不想摆脱将气泡推向右侧的填充，则使`.bubble`and`.chat`元素具有较小的百分比宽度以防止它们伸出。

但是，我假设您不希望该`.chat`区域始终处于 30%，那么为什么不使用媒体查询呢？

例子：

```
@media (min-width: 500px) {.chat{width:50%} .bubble{width:40%}
@media (min-width: 300px) {.chat{width:30%} .bubble{width:30%} 
```

显然这些不是您应该使用的实际数字，但是如果您使用这些数字，您应该能够使其在任何窗口大小下看起来都不错，而不会丢失您已经拥有的结构。

# objective-c - 如何替换 NSString 中的多个正则表达式匹配？

> ID：14266798
> 
> 赞同：0
> 
> 时间：2013-01-10T20:35:37.827
> 
> 标签：objective-c, regex, nsstring, nsrange

我想知道如何根据一些正则表达式（[AG]#？）替换 NSString 的特定字符。更具分析性，我有一个充满和弦和空格的 NSString，
例如“CAA# B”。

我想要的是根据我制作的字典更改这些和弦：
@“A”，@“A#”，
@“A#”，@“B”，
@“B”，@“C”，
@“C” 、@"C#"、
@"C#"、@"D"、
@"D"、@"D#"、
@"D#"、@"E"、
@"E"、@"F"、
@"F" , @"F#",
@"F#", @"G",
@"G", @"G#",

意思是
A -> A# 和 A#-> B。
我还想保留我的基本和弦之后存在的任何东西，意思是：
Am -> A#m。

我已经成功地扫描了字符串并用我想要的元素替换了新字符串中的元素，但是我不知道如何在保持初始字符串空间的同时做到这一点。

所以总结一下，基本上我希望这个：
“CAA# B”
变成这个：
“C# A# B C”

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:43:27.137

考虑到您将用不同的值替换源字符串中的所有项目，我真的完全看不到正则表达式的好处。您最好的选择可能是将字符串简单地解析为数组：

IE

```
NSArray *stringArray = [myString componentsSeparatedByString:@" "]; 
```

然后使用您选择的任何逻辑（即带有哈希表的枚举器）对数组中的每个值执行映射/替换。

最后将元素重新组合在一起：

```
NSString *joinedString = [mappedStringArray componentsJoinedByString:@" "]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T21:12:48.950

以下代码替换字典中的所有和弦，同时保留其他所有内容（以便根据要求将“Am”替换为“A#m”）：

```
NSDictionary *transposeDict = @{
    @"A": @"A#", @"A#": @"B", @"B": @"C", @"C": @"C#", @"C#": @"D",
    @"D": @"D#", @"D#": @"E", @"E": @"F", @"F": @"F#", @"F#": @"G",
    @"G": @"G#", @"G#": @"A"
};

NSString *melody = @" C A A# B   Am";
NSMutableString *transposedMelody = [melody mutableCopy];

NSRegularExpression *regex = [NSRegularExpression regularExpressionWithPattern:@"([A-G]#?)"
                                                                       options:0
                                                                         error:NULL];

NSArray *matches = [regex matchesInString:melody options:0 range:NSMakeRange(0, [melody length])];

for (NSTextCheckingResult *match in [matches reverseObjectEnumerator]) {
    NSString *oldChord = [melody substringWithRange:match.range];
    NSString *newChord = transposeDict[oldChord];
    if (newChord != nil)
        [transposedMelody replaceCharactersInRange:match.range withString:newChord];
}

NSLog(@"old: %@", melody);
NSLog(@"new: %@", transposedMelody); 
```

*输出：*

```
old:  C A A# B   Am
new:  C# A# B C   A#m 
```

该数组`matches`包含匹配子字符串的所有范围。然后以相反的顺序处理这些范围（从最后一个匹配到第一个匹配），以便改变字符串（这可能会改变长度）不会影响剩余范围的位置。

# coda - Coda 2 列宽限制/分隔符

> ID：14266800
> 
> 赞同：3
> 
> 时间：2013-01-10T20:35:48.307
> 
> 标签：coda

我希望能够使用 Coda 2 作为我的主要 IDE，但我的工作区有 80 个字符的行限制标准。有没有办法在 Coda 2 中添加限制或某种可见表示的 80 个字符限制？

# tomcat - Tomcat 服务器和蚂蚁

> ID：14266801
> 
> 赞同：0
> 
> 时间：2013-01-10T20:35:52.507
> 
> 标签：tomcat, ant

我在 build.xml 文件（自定义）中使用带有 tomcat 6 和 ant 1.8.1 的 windows 64 位，当我执行 clean 命令删除目录并且 war 文件没有任何反应时。我必须停止 tomcat 服务器手动删除文件，我可以从有效的蚂蚁部署，但我不能取消部署或从蚂蚁清理。

我最近安装了 windows 7 64bit 并重新安装了我的应用程序并配置了机器。但是我无法从 ant 取消部署应用程序。

我完全拥有了文件目录，并且 tomcat 用户拥有 manager-gui 权限。任何人都可以确定我可能需要做什么来取消部署应用程序。这在 32 位版本的 Windows 上运行良好。

当我尝试 ant 取消部署它的说法时：“C:\SpringWorkSpace\crimeTrack\build.xml:257: Unable to delete file C:\Users\Darin\apache-tomcat-6.0\webapps\crimeTrack\WEB-INF\classes\log4j 。特性”

**部署应用程序的代码：**

```
 <target name="deploy" depends="build" description="Deploy application">
        <copy todir="${deploy.path}/${name}" preservelastmodified="true">
            <fileset dir="${web.dir}">
                <include name="**/*.*"/>
            </fileset>
        </copy>
    </target>

    <target name="deploywar" depends="build" description="Deploy application as a WAR file">
        <war destfile="${name}.war"
             webxml="${web.dir}/WEB-INF/web.xml">
            <fileset dir="${web.dir}">
                <include name="**/*.*"/>
            </fileset>
        </war>
        <copy todir="${deploy.path}" preservelastmodified="true">
            <fileset dir=".">
                <include name="*.war"/>
            </fileset>
        </copy>
    </target> 
```

**要删除的代码：**

```
<target name="clean" description="Clean output directories">
            <delete>            
                <fileset dir="${build.dir}">
                    <include name="**/*.class"/>
                </fileset>
            </delete>
        </target>

        <target name="undeploy" description="Un-Deploy application">
            <delete>
                <fileset dir="${deploy.path}/${name}">
                    <include name="**/*.*"/>
                </fileset>
            </delete>
        </target> 
```

# facebook-graph-api - Facebook Graph API 有时会为地点返回不正确的纬度/经度。你如何纠正这些纬度/经度错误？

> ID：14266805
> 
> 赞同：1
> 
> 时间：2013-01-10T20:36:20.443
> 
> 标签：facebook-graph-api

这是一个 facebook 地方的示例，即使街道地址正确，纬度和经度也不正确。

[https://developers.facebook.com/tools/explorer/?method=GET&path=261035103969287](https://developers.facebook.com/tools/explorer/?method=GET&path=261035103969287)

返回的位置如下所示：

```
"location": {
  "street": "1299 18th Street", 
  "city": "San Francisco", 
  "state": "CA", 
  "country": "United States", 
  "zip": "94107", 
  "latitude": 37.748034283333, 
  "longitude": -122.39304696667
}, 
```

Facebook 有一个地点编辑器[https://www.facebook.com/places/editor](https://www.facebook.com/places/editor)但我不知道如何建议更新的纬度/经度。

# rest - 这是在 ServiceStack 上每次调用进行无状态身份验证的正确方法吗？

> ID：14266806
> 
> 赞同：3
> 
> 时间：2013-01-10T20:36:23.210
> 
> 标签：rest, authentication, session-state, servicestack

我有 REST 服务要求，其中一些调用需要身份验证，而有些则不需要。绝对不使用任何状态，因为调用都是相互独立的。我已经把一些似乎可行的东西放在一起，但这是不使用会话的正确方法吗？

[这个问题与我在此处](https://stackoverflow.com/questions/10799393/wcf-rest-basic-authentication-on-certain-methods)回答的 WCF 问题有点相关。

首先我注册了认证方法：

```
 Plugins.Add(new AuthFeature(() => new AuthUserSession(),
                                    new IAuthProvider[] {
                                        new CustomCredentialsAuthProvider(), //HTML Form post of UserName/Password credentials
                                    }
                        )); 
```

然后，我将各个调用（或服务或 DTO）赋予 Authenticate 属性：

```
[Authenticate]
public HelloResponse Post(Hello request)
{
    return new HelloResponse { Result = "Hello, " + request.Name  + " with POST & Auth"};
} 
```

我从进行身份验证的 BasicAuthProvider 类继承：

```
public class CustomCredentialsAuthProvider : BasicAuthProvider
{
    public override bool TryAuthenticate(IServiceBase authService, string userName, string password)
    {
        return userName == "dylan" && password == "abc123";
    }

    public override void OnAuthenticated(IServiceBase authService, IAuthSession session, IOAuthTokens tokens, Dictionary<string, string> authInfo)
    {
        session.IsAuthenticated = true;

        //Important: You need to save the session!
         authService.SaveSession(session, new TimeSpan(0,0,10)); 
    }
} 
```

如您所见，我确实保存了会话，但它在 10 秒后超时。这是我确信可以做得更好的部分。不过，它似乎工作得很好。

有没有更好的方法来做我想要完成的事情？由于这些服务的无会话性质，还有什么方法可以删除 Auth、AssignRoles 和 UnassignRoles 方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T03:43:04.440

如果您想继续使用[ServiceStack 的身份验证](http://github.com/ServiceStack/ServiceStack/wiki/Authentication-and-authorization)和[会话](https://github.com/ServiceStack/ServiceStack/wiki/Sessions)支持，您可以添加一个响应过滤器，在服务执行后清除用户会话，例如：

```
this.ResponseFilters.Add((req, res, dto) => req.RemoveSession()); 
```

基本上在每个请求执行后它都会清除会话，因此不存在它们经过身份验证的记录。

否则，您可以完全跳过使用 ServiceStack 的身份验证，只需通过[FilterAttributes的](https://github.com/ServiceStack/ServiceStack/wiki/Filter-attributes)[RequestFitlers](https://github.com/ServiceStack/ServiceStack/wiki/Request-and-response-filters)提供您自己的身份验证（这本质上是 SS Auth 在幕后所做的）。

# android - 来自 R.dimen 的值不正确

> ID：14266811
> 
> 赞同：2
> 
> 时间：2013-01-10T20:36:44.553
> 
> 标签：android, resources

我的 res/dimens.xml 中有一个维度资源设置，如下所示：

```
<dimen name="cornerRadius">40.0dp</dimen> 
```

但是，当我将它抓取到这样的浮动对象中时：

```
float cornerRadius = R.dimen.cornerRadius; 
```

并输出值，它`2.1309686E9`每次都给我。我将值从 40.0dp 更改为 15dp 并且它仍然输出`2.1309686E9`。

*我究竟做错了什么？*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-10T20:39:59.107

`R.dimen.cornerRadius`只是一个参考，而不是一个值。你应该`getResources().getDimension(R.dimen.cornerRadius)`改用

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:40:15.330

您得到的是 ID 而不是值，所以试试这个：

```
getResources().getDimension(R.dimen.cornerRadius) 
```

# java - 将 AsyncTasks 的结果放在一起

> ID：14266818
> 
> 赞同：2
> 
> 时间：2013-01-10T20:37:04.347
> 
> 标签：java, android, http, android-asynctask

例如，我有两个方法 method1() 和 method2()，现在它们每个都创建新的 AsyncTask 并开始在内部执行一些 http-query。每个任务都会返回对象列表（list1 和 list2），我需要等待所有对象并将这些列表合二为一才能返回。最好的方法是什么？

而且我真的不需要保持秩序，它可能是list2之后的list1。等待所有结果的最佳方法是什么以及我应该在哪里累积它们？如果我想保持秩序怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:40:53.467

如果没有看到你已经做了什么，很难提供太多帮助。但是我会创建一个成员`ArrayList`，或者使用第一个方法`LinkedHashMap`调用第一个成员`AsyncTask`并将这些结果放入列表中。`onPostExecute()`然后从您的第一个方法中调用第二个方法`AynscTask`并将这些结果添加到列表中。如果您需要更多帮助，请发布您已经开始的一些代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:55:40.947

根据[AsyncTask](https://developer.android.com/reference/android/os/AsyncTask.html)的描述，您有两个有趣的方法：

*   `doInBackground`
*   `onPostExecute`

第一个用于在后台线程中工作并返回**结果**，第二个在 UI 线程中以**result**作为参数调用。您可以将下载/计算的数据添加到`doInBackground`每个 AsyncTask 的列表中，这应该可以工作。

如果您想知道两个 AsyncTasks 是否都已完成，那么您必须有两个标志，在 UI 线程中设置和签入：设置`onPreExecute`，签入`onPostExecute`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:56:37.997

我建议您使用“线程”而不是 AsyncTask。例如：

```
new Thread(new Runnable(){

   list1 = getList1();

   new Thread(new Runnable(){

      list2 = getList2();
      //you have now list1 and list2, call your method here to do your stuff
   }).start();
}).start(); 
```

# svn - Jenkins 与自定义脚本

> ID：14266819
> 
> 赞同：4
> 
> 时间：2013-01-10T20:37:04.430
> 
> 标签：svn, deployment, jenkins

我目前面临如何部署 PHP 应用程序的两难境地。

这是我的设置的样子：

*   一个测试服务器，我也有我的 SVN 存储库。我有一个提交后脚本，它导出主干以在每次提交时自动将副本部署到测试服务器。
*   第二个生产服务器。

我说的部署显然是从第一台服务器到第二台。

我目前正在使用我编写的一个看起来很像这样的脚本：

```
#!/bin/bash

echo "Removing Old Export."
rm -rf /tmp/app_export

echo "SVN Export."
svn export -q -r HEAD "file:///var/www/svn/app/trunk" /tmp/app_export

echo "Changing permissions"
chown -R apache.apache /tmp/app_export

echo "*** Rsynching to app.com."
rsync -zai --progress --stats --ignore-times --checksum /tmp/app_export/ user@app.com:/var/www/html/app/ --exclude '*.log' 
```

但是每个人都说我应该使用 Jenkins（或类似的东西）来部署我的应用程序。这样做的好处是什么？

提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-11T00:24:08.500

Jenkins 旨在支持构建，但实际上它是一个通用的自动化框架

使用 Jenkins 的优点：

*   可以调用您现在使用的相同脚本来部署您的应用程序
*   可以将 Jenkins 作业设置为在有人提交源代码存储库时自动触发
*   部署的凭据可以仅限于 Jenkins。这样，部署要么自动触发，要么您可以设置用户授权规则来控制允许谁运行部署
*   Jenkins 充当中央仪表板，记录部署发生的时间。
*   可以添加一些在 Jenkins 中作为“构建后”操作运行的功能测试。
*   ..
*   ..

# jquery - 页面加载后第一次快速淡入

> ID：14266820
> 
> 赞同：1
> 
> 时间：2013-01-10T20:37:05.397
> 
> 标签：jquery, fadein

我使用 jquery 制作了一个工具提示。但是第一次（在页面正确加载之后），即使我应用了 500 持续时间的延迟（我想是毫秒？），工具提示也会毫无延迟地出现。为什么会这样？

```
<html>
<head>
    <script src="file://C:/Users/Admin/Desktop/jquery-1.8.3.min.js"></script>
    <script>
        $(document).ready(function(){
            $("input").focus(function(){
                $("#div").fadeIn(500).css("background-color","#B0B0B0");
            });
            $("input").blur(function(){
                $("#div").fadeOut(500).css("background-color","#B0B0B0");

            });
            $("input").keyup(function(){
                $("#div").html($("input").val());
            });
        });
    </script>
</head>
<body>
    <div style="width:150px">
        <input type="text" style="width:100%;border-radius:4px;border:1px solid #808080;padding:1%;font-family:calibri"/>
        <div id="div" style="color:#FFF;font-family:calibri;min-height:20px;border-radius:4px;padding:1%;word-wrap:break-word"></div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:43:21.593

你必须隐藏它`display:none`才能开始。

```
style="display:none"; 
```

然后，您可以通过动画将其带入视野。

```
<div id="div" style="display:none;color:#FFF;font-family:calibri;min-height:20px;border-radius:4px;padding:1%;word-wrap:break-word"></div> 
```

请参阅最好通过 Javascript 隐藏以进行渐进增强的[答案，但理论是相同的。](https://stackoverflow.com/a/14266940/1624960)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:43:36.697

因为你没有隐藏它并且它已经显示出来了。

在文档就绪函数中将此行添加到您的脚本中：

```
$("#div").hide(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T20:44:35.580

先把它藏起来。我建议使用这样的 JS

```
$("input").focus(function(){
    $("#div").hide()
    $("#div").fadeIn(500).css("background-color","#B0B0B0");
}); 
```

这样，如果用户禁用了 JS，他仍然会看到 div，只是没有淡入效果。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:51:19.723

将项目设置为不显示，然后在页面加载时为该项目创建一个 fadeIn(500)。

此外，您应该考虑清理您的 jquery。例子：

```
$(window).on('load',function(){
    var $div = $('#div');

    $('input').on({
        focus: function(){
            $div.fadeIn(500).css({backgroundColor:"#B0B0B0"});
        },
        blur: function(){
            $div.fadeOut(500).css({backgroundColor:"#B0B0B0"});
        },
        keyup: function(){
            $div.html($(this).val());
        },
        load: function(){
            $div.fadeIn(500);
        },
    });
}); 
```

未经测试，但这些方面的东西应该可以工作。

# c# - Visual Studio 2012 Express 对读取大文件有限制吗？

> ID：14266823
> 
> 赞同：1
> 
> 时间：2013-01-10T20:37:22.100
> 
> 标签：c#, visual-studio-2012

这是我读取文本文件的代码，该文件恰好大于 1GB，并且是用竖线分隔的：

```
namespace WindowsFormsApplication1
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        }

        string strFilePath = @"C:\Users\Me\Desktop\123.txt";

        private void button1_Click(object sender, EventArgs e)
        {
            var arrRawData = File.ReadLines(strFilePath).Select(line => line.Split('|')).ToArray();
        }
    }
} 
```

当我单击按钮时，我收到此错误：

> “在 mscorlib.dll 中发生 System.OutOfMemoryException”

我有 16GB 的 RAM ......我做错了什么？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T20:43:29.323

您的程序在 32 位模式下运行。这将永远不允许读取超过大约 650 兆字节的数据，大约是地址空间中可用的最大大小的空洞。

项目 + 属性，构建选项卡，取消选中“首选 32 位”选项。

请注意，在几乎所有解析文件数据的应用程序中，仍然不需要使用这么多内存。只需使用 StreamReader 类一次读取一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:40:01.317

视觉工作室没有限制。您可能有 16G，但您不能将其全部用于您的程序。尝试使用流或不同时读取整个文件，而是逐行读取...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-30T09:35:23.133

运行程序时出现错误：**“尝试运行项目时出错：无法启动程序。Windows Web 服务框架中出现无法识别的错误。**

解决方案是关闭防火墙。防火墙块：

```
Event: Traffic
IP Address/User: 0000:0000:0000:0000:0000:0000:0000:0001
Description: Microsoft Visual Studio 2012 (devenv.exe)
Path: C:\Program Files (x86)\Microsoft Visual Studio 11.0\Common7\IDE\devenv.exe

Message: Blocked Outgoing TCP - Source 0000:0000:0000:0000:0000:0000:0000:0001 :  (12276)  Destination 0000:0000:0000:0000:0000:0000:0000:0001 :  (12275) 
```

# php - 如何在 AJAX 中发送参数 POST 方法

> ID：14266824
> 
> 赞同：1
> 
> 时间：2013-01-10T20:37:23.020
> 
> 标签：php, ajax, post, get

在我的网站上，我在 php 中有组合框：

```
<script type="text/javascript">
function showUserVisits(reservationObjectId)
{
    //alert(reservationObjectId);
    if (reservationObjectId == "")
    {
        document.getElementById("txtHint").innerHTML="";
        return;
    }
    if (window.XMLHttpRequest)
    {// code for IE7+, Firefox, Chrome, Opera, Safari
        xmlhttp=new XMLHttpRequest();
    }
    else
    {// code for IE6, IE5
        xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
    }

    xmlhttp.onreadystatechange=function()
    {
        if (xmlhttp.readyState==4 && xmlhttp.status==200)
        {
            document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
        }
    }

    xmlhttp.open("GET","get_user.php?q=" +reservationObjectId,true);
    xmlhttp.send();
}       
</script> 
```

```
<form>
    <select name="users" onchange="showUserVisits(this.value)">
    <!-- <option value="">Select a person:</option> -->
    <option value="1">aaa1</option>
    <option value="2">aaa2</option>
    <option value="3">aaa3</option>
    <option value="4">aaa4</option>
    </select>
    </form> 
```

当用户更改组合框中的项目时，ajax 会调用方法 showUserVisits。而且我必须将 reservationObjectId 传递给 get_user.php 站点。它是如何完成的 GET 方法，我想通过 POST 方法传递这个参数，因为在 GET 方法中有人可以更改 id。我该怎么做 ？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:41:16.603

您在 中添加 key-val 对`.send()`，如下所示：

```
xmlhttp.open("POST","get_user.php",true);
xmlhttp.send("reservationId=" + reservationObjectId); 
```

要添加多个键值对，`&`请用作分隔符。

在您的服务器端脚本中，您将能够在`$_POST['reservationID']`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:42:18.623

更改此行：

```
xmlhttp.open("GET","get_user.php?q=" +reservationObjectId,true); 
```

对此：

```
xmlhttp.open("POST", url,true); 
```

请参阅此处了解更多信息：

[http://msdn.microsoft.com/en-us/library/windows/desktop/ms757849(v=vs.85).aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms757849(v=vs.85).aspx)

这里有些例子：

[http://www.openjs.com/articles/ajax_xmlhttp_using_post.php](http://www.openjs.com/articles/ajax_xmlhttp_using_post.php)

示例之一（来自上面的链接）：

```
var url = "get_data.php";
var params = "lorem=ipsum&name=binny";
http.open("POST", url, true);

//Send the proper header information along with the request
http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
http.setRequestHeader("Content-length", params.length);
http.setRequestHeader("Connection", "close");

http.onreadystatechange = function() {//Call a function when the state changes.
    if(http.readyState == 4 && http.status == 200) {
        alert(http.responseText);
    }
}
http.send(params); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T20:42:59.307

```
xmlhttp.open( "POST", 'get_user.php', true );
xmlhttp.send( "q="+reservationObjectId ); 
```

但请记住，帖子数据也可以编辑，所以在你的 php 文件中，检查值！

```
$q = (int) $_POST['q']; 
```

并确保 reservationID 属于用户

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-06-25T06:28:35.010

```
<script type="text/javascript">
function showUserVisits(reservationObjectId)
{
//alert(reservationObjectId);
if (reservationObjectId == "")
{
    document.getElementById("txtHint").innerHTML="";
    return;
}
if (window.XMLHttpRequest)
{// code for IE7+, Firefox, Chrome, Opera, Safari
    xmlhttp=new XMLHttpRequest();
}
else
{// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
}

xmlhttp.onreadystatechange=function()
{
    if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
        document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
}
xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");          // set header in case of post method
xmlhttp.open("POST","get_user.php",true); // set post method
xmlhttp.send("q="+reservationObjectId); // set data 
```

}

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T20:43:11.250

下面的代码显示了如何发帖，但是使用 POST 方法也可以更改 id

```
xmlhttp.open("POST","get_user.php",true);
xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
xmlhttp.send("q="+encodeURIComponent(reservationObjectId)); 
```

# javascript - 如何将 jquery ajax 调用转换为 WinJS.xhr 或 Win8 等价物

> ID：14266827
> 
> 赞同：1
> 
> 时间：2013-01-10T20:37:48.043
> 
> 标签：javascript, jquery, ajax, winjs

我有一个关于将 iOS/Android 应用程序移植到 Win8 的问题。我目前正在使用带有 ajax 调用的[http://srobbin.github.com/jquery-pageslide/](http://srobbin.github.com/jquery-pageslide/) pageslide 的修改版本来在侧面加载 menu.html 页面。AJAX 调用如下所示...

```
 $.ajax({
    url: $str,
    dataType: "text", 
    success: function(data) {         
        $("#menu").html(data);

    },
    error: function (xhr, ajaxOptions, thrownError) {
        alert(xhr.status);
        alert(thrownError);
      }
}); 
```

在Win8中，我收到此错误..

```
 Exception was thrown at line 8490, column 29 in ms-appx://664ace5f-4774-4928-bc94-ad4650a1ede1/js/jquery-1.8.2.js
0x80070005 - JavaScript runtime error: Access is denied. 
```

这是它在 jQuery 代码中中断的地方。

```
 if (s.username) {
                        xhr.open(s.type, s.url, s.async, s.username, s.password);
                    } else {
                        xhr.open(s.type, s.url, s.async); //<-------------------
                    } 
```

我做了一些研究，似乎 Windows 8 不允许本地 ajax 调用。如何将其转换为 WinJS.xhr 调用或可在 Win8 上运行的东西？

**编辑 - 第一次回答后。**

我要做的是转到$str（这是带有html 菜单的文件的url，即menu.html）并通过html 调用用它填充$('#menu')。我在 XHR 返回中放入什么以从 menu.html 中获取文本，然后在成功调用时我可以将其分配给文件。

我第一次搞乱 XHR/AJAX 所以请原谅任何无知。

**编辑#2**

我已重做 jquery 调用以使用 WinJS.xhr...，如下面的代码所示。

```
 WinJS.xhr({
        type: "GET",
        url: $str,
        responseType: "text",

    }).then(function(success){
        console.log(success);
    },
    function (error) {
        console.log(error);    
    }
    ); 
```

这仍然返回访问被拒绝异常。在这段基本的java代码上..

```
req.open(
                    options.type || "GET",
                    options.url,
                    // Promise based XHR does not support sync.
                    //
                    true,
                    options.user,
                    options.password
                ); 
```

此处记录了该异常。

```
SCRIPT5: Exception is about to be caught by JavaScript library code at line 2332, column 21 in ms-appx://microsoft.winjs.1.0/js/base.js
0x80070005 - JavaScript runtime error: Access is denied. 
```

如果文件名/路径 ($str) 更改为不正确的路径，则会出现 resource_not_found 错误，这是不言自明的。我不知道现在该尝试什么。有人有解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T11:43:50.813

你说你点击的 URL 是“本地的”。它是机器上的单独服务还是同一项目中的另一个文件？如果是前者，那么实际上它在您开发时仍然可以工作，但在生产中将被禁止。认证过程不允许应用程序向 localhost 发出请求。我怀疑是后者。在这种情况下，您绝对*应该*能够使用 xhr 请求它。在 Fragments and Pages 演示中查看我的 codeSHOW 项目（[链接）。](http://aka.ms/codeshowapp)另请参阅 WinJS.xhr 演示。

编辑 - 也只想包括答案。（伟大的应用程序！！）

这取代了 jquery 中的 $.ajax 调用。

```
 WinJS.xhr({
        url: '/menu.html',
        responseType: "document",

    }).then(function(xhr){

        var temp = xhr.response.childNodes[0].innerHTML;
        $('#menu').html(temp);
    }

    ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T20:45:55.147

使用 xhr 回调并返回您自己的 xhr。[http://api.jquery.com/jquery.ajax/](http://api.jquery.com/jquery.ajax/)

```
$.ajax({
    url: $str,
    xhr: function(){
        return yourDesiredXHRHere;
    },
    dataType: "text", 
    success: function(data) {         
        $("#menu").html(data);
    },
    error: function (xhr, ajaxOptions, thrownError) {
        alert(xhr.status);
        alert(thrownError);
    }
}); 
```

# ios - 类似于 Evernote iPad 应用的工具栏按钮

> ID：14266831
> 
> 赞同：1
> 
> 时间：2013-01-10T20:38:04.520
> 
> 标签：ios, ipad, uiwebview, ios6, uibutton

任何人都可以建议我如何在 UIWebView 键盘的工具栏中创建切换按钮，这与编辑笔记时 Evernote 应用程序的功能非常相似。我知道如何在该工具栏中添加按钮。我只想知道如何创建按钮看起来像那样。这可以使用简单的 UISwitch 来实现吗？

这正是我想要实现的。 ![UIWebView 键盘工具栏上的按钮](../Images/e0ab95162b5acfafe4a5aa432be76181.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:46:16.113

这可以通过`UIButton`. 要么在按钮上设置图像，要么`UIControlStateSelected`在 Interface Builder 中通过更改“选定状态配置”的图像来完成。然后，您可以通过更改按钮的`selected`属性来切换按钮状态。

前任：

```
[button setImage:[UIImage imageNamed:@"button_on"] forState:UIControlStateSelected];
button.selected = YES; 
```

# javascript - 历史 - 无法重新加载页面（单击相同的链接）

> ID：14266840
> 
> 赞同：1
> 
> 时间：2013-01-10T20:38:44.147
> 
> 标签：javascript, history.js

如何使用 History.js 重新加载页面（再次单击相同/活动页面/链接时）？

当您导航到`/home`菜单栏中，并且页面加载完成后，您`/home`再次单击该页面不会重新加载？

[https://github.com/browserstate/History.js/](https://github.com/browserstate/History.js/)

```
History.pushState(data, title, url); 
```

再次单击同一链接时，页面不会重新加载？实在想不通为什么？

也试过用`replaceState()`方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-11T12:14:25.700

```
var currentLocation = document.location.pathname + decodeURIComponent(document.location.search);
if (currentLocation == url) {
    console.log("Refresh");
    $(window).trigger('statechange');
} else {
    History.pushState(null, title, url);
} 
```

# javascript - 使用 JavaScript 在 radEditor 中发布内容

> ID：14266841
> 
> 赞同：-1
> 
> 时间：2013-01-10T20:38:55.330
> 
> 标签：javascript, telerik, radeditor

在打开模态编辑窗口时，我正在使用 JavaScript 在 radEditor 字段中发布 html 内容。

内容仅显示在 radEditor 的“HTML”选项卡中，在“设计”模式下为空白。

```
var radPrompt = $find("<%=tFieldsEdit_radPrompt.ClientID%>");
radPrompt.set_html(prompt); 
```

根据 Telerik 的说法，它应该具有“实时 HTML 视图 - 如果您在所见即所得或 HTML 窗口中进行更改，另一个将自动更新。”。

当模式编辑窗口加载时，tFieldsEdit_radPrompt 字段为空白，因为“设计”是默认模式。

我只有在切换到“HTML”标签时才能看到内容。当我切换回“设计”或“预览”时，它是空白的。

关于为什么它在“设计”和“预览”模式下为空白的任何线索？

谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T08:21:33.500

在模态编辑窗口中加载编辑器时是否出现 JavaScript 错误？

我的建议是看看这个演示是如何实现的，因为 set_html 方法在 RadWindow 对话框中加载编辑器时按预期工作：

[http://demos.telerik.com/aspnet-ajax/editor/examples/editorinradwindow/defaultcs.aspx](http://demos.telerik.com/aspnet-ajax/editor/examples/editorinradwindow/defaultcs.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-08T23:16:01.057

显然，此问题仅在 Firefox（当前版本 18.0.1）和模式窗口中发生。

我在 IE8 和 Safari 中查看它，内容在“设计”和“预览”模式下正确显示。

我没有使用 RadWindow 或 RichEditor。我正在使用标准的 RadEditor。

# ios - 自定义 UISearchbar

> ID：14266845
> 
> 赞同：0
> 
> 时间：2013-01-10T20:39:09.230
> 
> 标签：ios, uitableview, uiview, uisearchbar

是否可以自定义 UITableView 内的 UISearchBar，我想删除取消按钮并放置另外两个按钮而不是取消。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:51:38.433

UISearchBar 不是很可定制。你可以[在它的文档](https://stackoverflow.com/questions/12678620/can-i-use-two-xibs-with-one-viewcontroller-re-porting-to-iphone-5?rq=1)中看到你可以自定义的东西。您可以隐藏取消按钮，但不能添加自己的任意按钮。

您可能希望将其替换为 UITextField 和您自己的按钮，这将为您提供很大的灵活性，但需要更多的工作来重新实现 UISearchBar 的内置行为。

# c# - Task.WaitAll() - 无参数

> ID：14266847
> 
> 赞同：3
> 
> 时间：2013-01-10T20:39:16.983
> 
> 标签：c#, .net, task-parallel-library

使用 `System.Threading.Tasks.Task.WaitAll()`我可以看到我应该使用此方法的可用参数

可以在[这里](http://msdn.microsoft.com/en-us/library/system.threading.tasks.task.waitall.aspx)看到，但是在 Visual Studio 中编写时，我能够调用没有参数的方法：

```
Task.WaitAll(); 
```

并且它没有在 IDE 中显示为语法错误（对于缺少参数），您能否解释一下为什么使用这种特定方法可以做到这一点？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-10T20:41:49.613

该方法的完整定义是

```
public static void WaitAll(params Task[] tasks) 
```

该词`params`表示该方法接受可变数量的参数。0 参数也是明确允许的。

不用说该方法在以这种方式调用时没有任何作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T20:42:27.243

该方法已重载。[一种重载](http://msdn.microsoft.com/en-us/library/dd270695.aspx)的形式为：

```
public static void WaitAll(
    params Task[] tasks
) 
```

该`params`参数可以采用零个或多个参数。

# database - File Maker Pro - 维护多个邮件列表

> ID：14266848
> 
> 赞同：0
> 
> 时间：2013-01-10T20:39:27.277
> 
> 标签：database, schema, filemaker, mailing-list

很长一段时间以来，我一直在尝试将数十个单独的电子表格迁移到 File Maker 数据库中。

(1) 最好的实施方案是什么？

(2) （假设我们要使用多个表，这会阻止使用常规导入...）导入所有这些电子表格的最佳方法是什么？

例如，我的电子表格看起来像这样：

*   EventA1 参加者
*   EventA2 参加者
*   EventB1 参加者
*   EventB2 参加者
*   等等
*   不想收到邮件的人名单

而我们经常要发送到A1，或者A1+A2，或者A1+A2+B1+B2等等。

这是我到目前为止提出的架构，但我不能 100% 确定它是否合适。我最大的问题是我没有办法导入我的几十个电子表格，因为内置导入只适用于一个表。

![我的暂定模式](../Images/8e89c8dd10c5366edac057ad77086039.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T02:25:18.127

您是否偶然熟悉 PHP？[如果是这样，您可以编写一个脚本来使用FileMaker 的 PHP API](http://www.filemaker.com/support/technologies/php.html)导入所有数据（如果您正在运行 FileMaker 服务器）。这将允许您将所有数据相应地添加到 FileMaker 相关表中，并且会非常快速和简单的。

如果您不使用 FM Server 或者您不熟悉 PHP，那么您确实需要依赖基本导入。在这种情况下，我建议根据将要导入的表格将电子表格分成单独的文件。

例如，您可以为 Contacts 表创建 1 个电子表格，然后自行导入。然后，您将拥有另一个用于 Name 表的电子表格，其中包含 ContactID 作为一列。自行导入。

对所有电子表格/表格遵循相同的过程，您最终将获得与预期相关的 FM 中的所有数据。

如果这不是您的选择（或者您只想这样做），您可以编写一个 FileMaker 脚本来循环遍历电子表格中的所有记录，并根据需要将数据添加到表中。这与我提到的 PHP 脚本方法非常相似，但它会使用标准 FM 脚本技术直接在 FileMaker 中发生。

# php - 使用多个连接从表单更新数据库

> ID：14266851
> 
> 赞同：0
> 
> 时间：2013-01-10T20:39:39.583
> 
> 标签：php

我有一个组，组长正在更新组中的成员。角色 ID 为 11 的成员处于待处理状态，我想根据下拉列表中选择的选项更改他们的角色 ID。

这是表格：

```
<form action='updatePendingMembers.php' method='post' onsubmit='return checkForm()'>
    <?php
    $pendingMembers = "SELECT m.id, concat(fname, ' ', lname) as mName, email, m.rolesID FROM member m join member_to_groups on m.id = member_to_groups.memberID left join groups on member_to_groups.groupsID = groups.id WHERE m.rolesID = 11 AND groups.memberID = " . $_SESSION['siteMemberId'];
    $rsPendingMembers = mysql_query($pendingMembers);
    //if(!$rsPendingMembers)
        //echo 'the query is: ' . $pendingMembers . '<br/>and the error: ' . mysql_error();
    while($get_row = mysql_fetch_assoc($rsPendingMembers)){
    ?>
    <tr>
      <td colspan="3" class="Sub_Header">Pending Group members</td>
    </tr>
    <tr>
      <td colspan="3"><span class="Maintext"><?php echo $get_row['mName']?></span>
    <select name="rolesID" class="lowermenu" id="rolesID">
        <option value="12">Accept</option>
        <option value="11">Decline</option>
    </select>
      <a href="mailto:<?php echo $get_row['email']?>"><span class="lowermenu">send pending member message</span></a></td>
        </tr>
    <?php } ?>
    <td><span class="Sub_Header">
        <input name="update_pending_member_button" type="submit" id="update_pending_member_button" value="Update Member">
      </span></td>
      </form> 
```

这是到目前为止的 updatePendingMembers.php 文件：

```
<?php
session_start();
include("global.php");
$myQuery1 = "UPDATE member SET rolesID = " .  mysql_real_escape_string($_POST['rolesID']) WHERE id = ;
$rs1 = mysql_query($myQuery1);
?> 
```

如何将 id 设置为与被选中的成员以及该特定组中的成员相等？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:23:58.803

对表单元素使用类似数组的名称：

```
<select name="rolesID[<?php echo $get_row['id']; ?>]" class="lowermenu" id="rolesID">
    <option value="12">Accept</option>
    <option value="11">Decline</option>
</select> 
```

您的`$_POST`数据将如下所示：

```
$_POST['rolesID'] = array(
   '1' => '11',
   '2' => '12'
); 
```

您可以遍历它并更新每条记录：

```
foreach ($_POST['rolesID'] as $id => $role) {
    $id = (int)$id;
    $role = (int)$role;
    $sql = "UPDATE member SET roleID = {$role} WHERE id = {$id}";
} 
```

# wcf - 什么 130 秒超时正在杀死我的 WCF 流服务调用？

> ID：14266854
> 
> 赞同：17
> 
> 时间：2013-01-10T20:39:48.720
> 
> 标签：wcf, iis-7, .net-4.0, streaming, basichttpbinding

就在最近，我开始研究 WCF 流的一个棘手问题，如果客户端在两次发送到服务器之间等待的时间超过 130 秒，就会产生 CommunicationException。

这是完整的例外：

```
System.ServiceModel.CommunicationException was unhandled by user code
  HResult=-2146233087
  Message=The socket connection was aborted. This could be caused by an error processing your message or a receive timeout being exceeded by the remote host, or an underlying network resource issue. Local socket timeout was '23:59:59.9110000'.
  Source=mscorlib
  StackTrace:
    Server stack trace: 
       at System.ServiceModel.Channels.HttpOutput.WebRequestHttpOutput.WebRequestOutputStream.Write(Byte[] buffer, Int32 offset, Int32 count)
       at System.IO.BufferedStream.Write(Byte[] array, Int32 offset, Int32 count)
       at System.Xml.XmlStreamNodeWriter.FlushBuffer()
       at System.Xml.XmlStreamNodeWriter.GetBuffer(Int32 count, Int32& offset)
       at System.Xml.XmlUTF8NodeWriter.InternalWriteBase64Text(Byte[] buffer, Int32 offset, Int32 count)
       at System.Xml.XmlBaseWriter.WriteBase64(Byte[] buffer, Int32 offset, Int32 count)
       at System.Xml.XmlDictionaryWriter.WriteValue(IStreamProvider value)
       at System.ServiceModel.Dispatcher.StreamFormatter.Serialize(XmlDictionaryWriter writer, Object[] parameters, Object returnValue)
       at System.ServiceModel.Dispatcher.OperationFormatter.OperationFormatterMessage.OperationFormatterBodyWriter.OnWriteBodyContents(XmlDictionaryWriter writer)
       at System.ServiceModel.Channels.Message.OnWriteMessage(XmlDictionaryWriter writer)
       at System.ServiceModel.Channels.TextMessageEncoderFactory.TextMessageEncoder.WriteMessage(Message message, Stream stream)
       at System.ServiceModel.Channels.HttpOutput.WriteStreamedMessage(TimeSpan timeout)
       at System.ServiceModel.Channels.HttpOutput.Send(TimeSpan timeout)
       at System.ServiceModel.Channels.HttpChannelFactory`1.HttpRequestChannel.HttpChannelRequest.SendRequest(Message message, TimeSpan timeout)
       at System.ServiceModel.Channels.RequestChannel.Request(Message message, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannel.Call(String action, Boolean oneway, ProxyOperationRuntime operation, Object[] ins, Object[] outs, TimeSpan timeout)
       at System.ServiceModel.Channels.ServiceChannelProxy.InvokeService(IMethodCallMessage methodCall, ProxyOperationRuntime operation)
       at System.ServiceModel.Channels.ServiceChannelProxy.Invoke(IMessage message)
    Exception rethrown at [0]: 
       at System.Runtime.Remoting.Proxies.RealProxy.HandleReturnMessage(IMessage reqMsg, IMessage retMsg)
       at System.Runtime.Remoting.Proxies.RealProxy.PrivateInvoke(MessageData& msgData, Int32 type)
       at WcfService.IStreamingService.SendStream(MyStreamUpRequest request)
       at Client.Program.<Main>b__0() in c:\Users\jpierson\Documents\Visual Studio 2012\Projects\WcfStreamingTest\Client\Program.cs:line 44
       at System.Threading.Tasks.Task.Execute()
  InnerException: System.IO.IOException
       HResult=-2146232800
       Message=Unable to write data to the transport connection: An existing connection was forcibly closed by the remote host.
       Source=System
       StackTrace:
            at System.Net.Sockets.NetworkStream.MultipleWrite(BufferOffsetSize[] buffers)
            at System.Net.ConnectStream.InternalWrite(Boolean async, Byte[] buffer, Int32 offset, Int32 size, AsyncCallback callback, Object state)
            at System.Net.ConnectStream.Write(Byte[] buffer, Int32 offset, Int32 size)
            at System.ServiceModel.Channels.BytesReadPositionStream.Write(Byte[] buffer, Int32 offset, Int32 count)
            at System.ServiceModel.Channels.HttpOutput.WebRequestHttpOutput.WebRequestOutputStream.Write(Byte[] buffer, Int32 offset, Int32 count)
       InnerException: System.Net.Sockets.SocketException
            HResult=-2147467259
            Message=An existing connection was forcibly closed by the remote host
            Source=System
            ErrorCode=10054
            NativeErrorCode=10054
            StackTrace:
                 at System.Net.Sockets.Socket.MultipleSend(BufferOffsetSize[] buffers, SocketFlags socketFlags)
                 at System.Net.Sockets.NetworkStream.MultipleWrite(BufferOffsetSize[] buffers)
            InnerException: 
```

由于连接不活动，服务器似乎过早地关闭了连接。如果我改为向服务器发送一个脉冲，甚至一次一个字节，那么我永远不会得到这个异常，我可以继续无限期地传输数据。我构建了一个非常简单的示例应用程序来演示这一点，它使用带有 Streamed transferMode 的 basicHttpBinding，我从客户端上的自定义流实现中插入了一个人工延迟，延迟 130 秒。这模拟了类似于缓冲区运行不足的情况，在这种情况下，我在客户端的服务调用中提供的流没有足够快地将数据提供给 WCF 基础结构，无法满足某种似乎在 130 秒左右的无法识别的超时值标记。

使用 WCF 服务跟踪工具，我可以找到一个 HttpException，并显示一条消息：“客户端已断开连接，因为基础请求已完成。不再有可用的 HttpContext。”

从 IIS Express 跟踪日志文件中，我看到一个条目显示“由于线程退出或应用程序请求，I/O 操作已中止。(0x800703e3)”

我已将服务器和客户端超时配置为使用远超过 130 秒标记的值来排除它们。我已经在 IIS Express 中尝试了 idleTimeout 以及许多与 ASP.NET 相关的超时值，以便发现这个问题来自哪里，但到目前为止还没有运气。到目前为止，我能找到的最佳信息是开发人员[在 FireFox 问题跟踪器中的评论，该评论](https://bugzilla.mozilla.org/show_bug.cgi?id=491541#c7)描述了在 WCF 体系结构之外工作的类似问题。出于这个原因，我猜这个问题可能更具体地与 IIS7 或 Windows Server 相关。

服务器 Web.config 上的自定义绑定

```
<binding name="myHttpBindingConfiguration"
         closeTimeout="02:00:00"
         openTimeout="02:00:00"
         receiveTimeout="02:00:00"
         sendTimeout="02:00:00">
  <textMessageEncoding messageVersion="Soap11" />
  <httpTransport maxBufferSize="65536"                        
                 maxReceivedMessageSize="2147483647"
                 maxBufferPoolSize="2147483647"
                 transferMode="Streamed" />
</binding> 
```

代码中的客户端配置：

```
 var binding = new BasicHttpBinding();
    binding.MaxReceivedMessageSize = _maxReceivedMessageSize;
    binding.MaxBufferSize = 65536;
    binding.ReaderQuotas.MaxStringContentLength = int.MaxValue;
    binding.ReaderQuotas.MaxArrayLength = int.MaxValue;
    binding.TransferMode = TransferMode.Streamed;
    binding.ReceiveTimeout = TimeSpan.FromDays(1);
    binding.OpenTimeout = TimeSpan.FromDays(1);
    binding.SendTimeout = TimeSpan.FromDays(1);
    binding.CloseTimeout = TimeSpan.FromDays(1); 
```

为了响应 wals 的想法，尝试通过自行托管我的服务来查看我是否得到任何不同的结果，我想补充一点，我这样做了，发现我得到的结果与在 IIS 中托管时相同。这是什么意思？我的猜测是，这意味着问题出在 WCF 或 Windows 的底层网络基础结构中。我使用的是 Windows 7 64 位，我们通过运行各种客户端并在 Windows 2008 Server 上运行服务部分发现了这个问题。

## 2013-01-15 更新

一旦我意识到 WCF 在 Windows 7 上的自托管场景中使用 HTTP.sys，多亏了 DarkWanderer，我发现了一些新线索。这让我研究了我可以为 HTTP.sys 配置什么以及人们报告的问题类型对于 HTTP.sys，这听起来与我所经历的相似。这将我带到位于*C:\Windows\System32\LogFiles\HTTPERR\httperr1.log*的日志文件，该文件似乎记录了 HTTP.sys 的特定类型的 HTTP 问题。在此日志中，我每次运行测试时都会看到以下类型的日志条目。

> 2013-01-15 17:17:12 127.0.0.1 59111 127.0.0.1 52733 HTTP/1.1 POST /StreamingService.svc - - Timer_EntityBody -

因此，要找出哪些条件可能导致[Timer_EntityBody](http://support.microsoft.com/kb/820729#3)错误，以及 IIS7 或其他地方的哪些设置可能会影响何时以及是否发生该错误。

来自[官方 IIS 网站](http://www.iis.net/configreference/system.applicationhost/sites/sitedefaults/limits)：

> 在请求实体正文到达之前连接已过期。当明确请求具有实体主体时，HTTP API 会打开 Timer_EntityBody 计时器。最初，此计时器的限制设置为 connectionTimeout 值。每次在此请求上收到另一个数据指示时，HTTP API 都会重置计时器，以便为连接提供更多分钟，如 connectionTimeout 属性中指定的。

尝试按照上面的参考在 IIS Express 的 applicationhost.config 中建议修改 connectionTimeout 属性似乎没有任何区别。也许 IIS Express 会忽略此配置并在内部使用硬编码值？我自己尝试了一些东西，我发现添加了新的 netsh http 命令来显示和添加超时值，所以我想出了以下命令，但不幸的是，这样做似乎对这个错误也没有任何影响。

> netsh http 添加超时 timeouttype=IdleConnectionTimeout value=300

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-15T23:45:32.310

事实证明，这个问题是由 HTTP.sys 使用的[连接超时](http://www.iis.net/configreference/system.applicationhost/sites/sitedefaults/limits)值引起的，并且可以通过 IIS 管理器通过单个站点的高级设置来指定。默认情况下，此值配置为在 120 秒内未收到标头和正文时使连接超时。如果接收到来自正文的数据脉冲，则服务器在超时值内重新启动计时器（Timer_EntityBody），然后重置计时器以等待其他数据。

![IIS 中的连接超时设置](../Images/be3f602cd4e5bdb3ca642be14d229cdd.png)

这就像有关**Timer_EntityBody**和**connectionTimeout**[的文档](http://www.iis.net/configreference/system.applicationhost/sites/sitedefaults/limits)所指定的那样，但是很难确定，因为无论文档怎么说，IIS Express 似乎都忽略了*applicationhost.config中的限制元素中指定的 connectionTimeout 值。*为了确定这一点，我必须在我的开发机器上安装完整版本的 IIS，并在将我的网站托管在那里之后修改上面的设置。

 *****由于我们在 Windows 2008 上的 IIS 下托管实际服务，因此上述解决方案对我有用，但问题仍然是在您是自托管的情况下如何正确修改连接超时值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-15T09:50:00.357

从错误来看：

> 套接字连接被中止。这可能是由于处理您的消息时出错或远程主机超出接收超时，或者是潜在的网络资源问题造成的。本地套接字超时为“23:59:59.9110000”

看起来这是一个简单的 TCP 超时。

您可以通过将应用程序作为自托管运行来验证它，然后在控制台中运行此命令：

```
netstat -no |find "xxxxx" 
```

其中 xxxxx 是您的服务器进程的 PID。此命令将显示您的服务器已建立的连接并每秒刷新一次。

尝试与客户端连接，看看会发生什么。大约 100-120 秒后，您很可能会在连接上看到“CLOSE_WAIT”或“TIME_WAIT”——这意味着它由于超时而中止。

这可以通过将以下内容添加到您的配置来解决：

```
<httpTransport maxBufferSize="65536"                        
             maxReceivedMessageSize="2147483647"
             maxBufferPoolSize="2147483647"
             transferMode="Streamed"
             keepAliveEnabled="true" /> <!-- Here --> 
```

参数说明[here](http://msdn.microsoft.com/library/ms731364.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T21:03:59.487

可能是长镜头，但是...检查您的 IIS 应用程序池是否启用了 Ping。它在高级设置中，流程模型分组。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-08-27T15:48:28.057

试试这个，对我来说它解决了这个问题。问题是底层内核 http.sys 有它自己的超时，它会中断连接。

```
http://mmmreddy.wordpress.com/2013/07/11/wcf-use-of-http-transport-sharing-persistent-tcp-sessions/

netsh http add timeout timeouttype=idleconnectiontimeout value=120 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-10-10T21:12:27.277

你考虑[过 http://support.microsoft.com/kb/946086](http://support.microsoft.com/kb/946086)吗？

我在我的 ISAPI-Extensions 中观察到了这样的流中断。根据此支持说明关闭 IIS 7 中的缓冲后，一切正常。*****

# applescript - AppleScript 安装驱动器，完成后报告是否成功

> ID：14266855
> 
> 赞同：2
> 
> 时间：2013-01-10T20:39:49.830
> 
> 标签：applescript

我编写了一个脚本，在启动应用程序之前安装驱动器。但是，只有在驱动器安装成功时，该应用程序才应该启动。

我有正确的代码来安装驱动器并启动应用程序，但我需要在操作完成后检查安装是否成功。目前，该`if`语句似乎在`mount`.

```
# Get wireless network SSID
set SSID to do shell script "/System/Library/PrivateFrameworks/Apple80211.framework/Resources/airport -I | awk '/ SSID: / {print $2}'"

# Test if we are connected to the right network(s)
# We can test for multiple networks if you’re always on the move, like me!
# if SSID is "YOUR_SSID_ONE" or SSID is "YOUR_SSID_TWO" then
if SSID is "virginmedia7912273" or SSID is "virginmedia5097309" then
    tell application "Finder"
        # Mount your disk
        mount volume "afp://nas/iTunes/"
        # Check that the disk successfully mounted
        if exists disk "iTunes" then
            # If the disk successfully mounted, launch iTunes
            tell application "iTunes"
                # Launch launches, activate brings window to focus (?)
                launch
                activate
            end tell
        else
            # If the disk didn’t mount, throw an error.
            display dialog "Unable to connect to iTunes storage device."
        end if
    end tell
else
    # If we are not connected to the right network(s), throw an error.
    display dialog "You are not connected to your home network."
end if 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:03:34.683

您可以使用如下循环检查挂载是否成功：

```
repeat until name of every disk contains "iTunes"
   delay 1
end repeat 
```

您还可以添加条件以在一定次数的迭代后退出循环：

```
set i to 0
repeat until (name of every disk contains "iTunes" or i is greater than max_number_of_iteration)
   delay 1
   set i to i + 1
end repeat 
```

**编辑：**

必须修改脚本以与最新的 macOS 版本兼容：

```
tell application "System Events" to set diskNames to name of every disk 
set i to 0
set max_number_of_iteration to 5
repeat until (diskNames contains "iTunes" or i is greater than max_number_of_iteration)
    tell application "System Events" to set diskNames to name of every disk 
    delay 1
    set i to i + 1
end repeat 
```

感谢[步行者](https://stackoverflow.com/users/7711430/a-walker)的建议。

# ruby-on-rails - 在复选框集合中显示图像

> ID：14266858
> 
> 赞同：1
> 
> 时间：2013-01-10T20:39:59.603
> 
> 标签：ruby-on-rails, checkbox, best-in-place

我使用 best_in_place （这对我的问题并不重要）。

我想显示图像而不是复选框。

我的图像位于：`public/images`.

所以我尝试了：

```
<%= best_in_place task, :done,:classes => 'highlight_on_success', type: :checkbox, collection: [image_tag("/images/checkbox_yes.gif"), image_tag("/images/checkbox_no.png")] %> 
```

不幸的是，复选框的默认图像（应该是第一张图像）显示为`-`，当我按下它时，我看到了第二张图像。

我试图检查我的第一张图片是否有问题，所以我将代码更改为：

```
<%= best_in_place task, :done,:classes => 'highlight_on_success', type: :checkbox, collection: [image_tag("/images/checkbox_no.png"), image_tag("/images/checkbox_yes.gif")] %> 
```

但是默认图片（应该是第二张图片）显示为`-`，当我按下它时，我看到了第一张图片。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:48:24.257

此问题已在[最近的拉取请求](https://github.com/bernat/best_in_place/pull/210)中得到解决，因此请更新您的`best_in_place`版本以解决此问题。从[测试代码](https://github.com/guigs/best_in_place/commit/c668e6dc4db4cf071c4d833dfe6eda1cf245270b#L3R64)可以看出，您的语法应该没问题。

# algorithm - 具有最少作业要求的加权间隔调度

> ID：14266861
> 
> 赞同：1
> 
> 时间：2013-01-10T20:40:11.957
> 
> 标签：algorithm, scheduling, dynamic-programming, weighted

问题是我有经典的加权间隔调度问题，但有一个额外的要求。这个要求是，从给定的工作中，必须完成一些工作。

我已经用蛮力解决了它。但我需要更有效的解决方案。我用动态规划解决了经典的加权调度问题。但是有了这个约束，我不能。你有什么建议吗。谢谢指教。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-16T09:01:21.633

好吧，我看不出这个问题与经典的加权间隔调度有什么不同。如果“必须完成”的工作不重叠（如果它们是，那么你有一个定义不明确的问题 - 如何在两个重叠的“必须完成”的工作之间进行选择？），那么你只需要一种方法来使它们的相对权重站立其余的工作。

您可以在 O(n) 中遍历您的作业，并找到最大权重。然后对于“必须完成”的工作，您需要将最大值添加到他们的权重中。这将确保他们将被选中而不是任何其他工作，因为他们的相对权重肯定会高于非优先工作。

正如我所说，唯一的问题是“必须完成”的工作何时重叠。在这种情况下，您将以一些未选择的必须工作结束（因为您必须选择一个必须工作而不是另一个）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T08:50:36.660

只需在经典调度问题的基础上再增加一个维度

该维度给出了迄今为止已完成的工作数量

例如。

f[i][j] 表示在时间 i，完成了 j 个工作，最大利润是多少

f[i][j] 可以决定 f[job_end_time[k]][j+1] 给定 job_start_time[k]>=i

# python - 使用 Python 从字符串列表自动生成文档标题

> ID：14266865
> 
> 赞同：1
> 
> 时间：2013-01-10T20:40:16.003
> 
> 标签：python, list, title

我正在尝试根据频道组织新闻，即我需要使用list_a（如下）中的元素来命名我的txt文件，然后将同一频道的相应字符串写入同一文档。这些 txt 文件可以写入我当前的文件夹，对此没有任何麻烦

我目前关心的是如何有效地编写它。由于我不知道文档中会写入多少个字符串，因此当前文档需要保留，直到字符串用完并启动新文档。

下面是一个例子：

输入：2 个字符串列表：

```
list_a=['abc','abc','fox','abc',....]

list_b=['campus shooting', 'Congress sucks', 'debt ceiling','1% rich', ...] 
```

输出：2个文档，标题分别为“abc.txt”和“fox.txt”

在文档 abc.txt

```
campus shooting

congress sucks 
```

在文件 fox.txt

```
debt ceiling 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:44:41.140

您可以`zip()`在此处使用并以附加模式（`'a'`）打开文件：

```
In [44]: list_a=['abc','abc','fox','abc']
In [45]: list_b=['campus shooting', 'Congress sucks', 'debt ceiling','1% rich']

In [46]: for x,y in zip(list_a,list_b):
   ....:     with open(x+".txt" , "a") as f:
   ....:         f.write(y+'\n') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:55:27.570

为每个项目打开一个文件可能会很昂贵（不要猜测，将性能与避免它的此版本进行比较）：

```
from itertools import groupby
from operator import itemgetter

L = sorted(zip(list_a, list_b), key=itemgetter(0)) # sorted (a, b) pairs
for name, group in groupby(L, key=itemgetter(0)):
    with open(name + ".txt", "w") as file:
        for a, b in group:
            file.write(b + "\n") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T20:49:37.260

另一种只打开文件一次的方法：

```
from collections import defaultdict

list_a = ['abc', 'abc', 'fox', 'abc']
list_b = ['campus shooting', 'Congress sucks', 'debt ceiling','1% rich']

results = defaultdict(list)

for title, text in zip(list_a, list_b):
    results[title].append(text)

for title, result in results.iteritems():
    with open("%s.txt" % title , "w") as f:
        f.write('\n'.join(result)) 
```

# javascript - 缓存变量：localStorage 还是 cookie？

> ID：14266867
> 
> 赞同：0
> 
> 时间：2013-01-10T20:40:23.097
> 
> 标签：javascript, jquery, html

这是对[这个](https://stackoverflow.com/questions/14266730/js-how-to-cache-a-variable)问题的跟进，在那里我可以选择制作 cookie 和使用`localStorage`在多个会话中保留变量。谁能给我两者的优缺点，以及选择哪一个的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:43:45.923

我会选择**localStorage**。

**优点**

*   快速轻松地读取/写入您的数据
*   您的数据不会随着减少负载的每个请求一起传输到服务器
*   键值对时尚

**缺点**

*   **旧浏览器**不支持
***   每个域最多可存储**5 MB数据****

 **当涉及到 cookie 时，它​​们有时会很有用。购物车是一种场景，当您想要在用户关闭浏览器/会话后恢复购物车项目时，cookie 非常有用。但是，不要存储太多 cookie，因为它们会随着您发出的每个请求而传输到服务器（它也包括 AJAX 请求）。当/如果您的网站变得流行并且每小时/每天获得数千/数十万次点击时，这可能会导致严重的瓶颈。想想看。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:50:18.350

**其他人尚未提及的要点以粗体显示**：

*   每个页面请求都会将 Cookies 发送到服务器，而 localStorage 则不会。这意味着：
    *   当您只在客户端需要它时，没有不必要的数据传输
    *   但是当您需要服务器上的值时，需要在页面加载后使用额外的 XmlHttpRequest 进行传输
*   localStorage 的容量要大得多
*   **许多实现 localStorage 的浏览器没有禁用它的选项，或者这个选项比阻止 cookie 的选项隐藏得更好，**所以更少的用户禁用它（许多了解 cookie 的人甚至不知道这个功能的存在）。
*   在我看来，localStorage 有一个更容易使用的 API
*   **localStorage 没有 expire-header**（但是可以通过向数据添加额外的 expire-date 并手动处理来轻松模拟）

顺便说一句：**不要忘记 sessionStorage**。API 是相同的，在很多情况下它比持久化的 localStorage 更合适

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:44:56.453

我只想列出我想到的4点：

1.  localStorage 不会随每个请求一起旅行。它保持在 cient 方面（这很好，更精简的要求）
2.  比 Cookie 具有更大的大小限制（您可以存储更多）
3.  更容易获取/设置值的 API (IMO)
4.  存储在 localStorage 中的值不会传送到服务器。如果您需要了解存储在服务器端的值，请使用 cookie。

您决定什么最适合您的方案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:45:34.630

`localStorage`较新，部分 HTML5 和较旧的浏览器可能不支持它。它也只是客户端，这意味着除非某些客户端代码将其显式发送到服务器，否则您的服务器将永远不会看到它。该界面非常易于使用，而且速度非常快。

Cookie 受到普遍支持，并随着每个请求自动发送到服务器。但是客户端和服务器都可以访问 cookie 值，而无需额外的工作。在一些库的帮助下，管理来自 JavaScript 的 cookie 的界面非常迟钝。

如果该值只需要是本地的，并且不需要考虑旧的浏览器支持，请使用`localStorage`.**

# facebook - 我正在尝试在 facebook 开发人员页面的 App Domains 字段中输入我的域名，但我不断收到：站点 URL 不是有效的 URL

> ID：14266869
> 
> 赞同：1
> 
> 时间：2013-01-10T20:40:40.933
> 
> 标签：facebook

我的站点 url 是 podium.za.com，它一直给我错误：站点 URL 不是有效的 URL。这与 .za.com 有关吗？我一直试图让这个工作好几天了。

# jquery - $(document).ajaxComplete 不会在内容脚本内触发

> ID：14266872
> 
> 赞同：2
> 
> 时间：2013-01-10T20:40:49.867
> 
> 标签：jquery, google-chrome-extension

我正在开发 Google Chrome 扩展程序，以为我经常访问的网站提供一些额外的功能，如果 AJAX 请求成功，我会尝试让脚本再次运行。由于网站的性质，这是必要的。

继续：我想要做的是，简单地说，每当 AJAX 请求成功时触发一个函数。因此，我制作了以下内容并在相关网站上的控制台中运行它：

```
$(document).ajaxSuccess(function() {
   console.log('AJAX success');
}); 
```

然后我继续使用该网站，每次通过 AJAX 加载新内容时，我确实得到了它的确认，`.ajaxSuccess`到目前为止一切都很好。

然后，我开始着手将我所有的各种点点滴滴放在一起，使其成为一个合适的 Chrome 扩展程序。除了一件事，一切仍然有效：当该`.ajaxSuccess`位位于内容脚本中时（我已确保已正确执行等等）网站上的 AJAX 请求不再触发它。

我试图理解它，但我没有太多运气。我觉得这个扩展可能需要一些特殊的权限才能访问 AJAX 相关的东西，尽管我不知道那可能是什么。截至目前，扩展的权限如下：

```
"permissions": [
    "storage", "tabs", "http://website.com/*"
] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-11T22:21:00.070

我最终制定了一个有点不愉快的解决方法，类似于：

```
var DOMTimeout = null;
    $('.class').bind('DOMNodeInserted', function() {
        if(DOMTimeout)
            clearTimeout(DOMTimeout);

    DOMTimeout = setTimeout(function() { console.log('AJAX probably added something'); }, 150);
}); 
```

# java - Android 使用 onClickListener 启动活动？

> ID：14266875
> 
> 赞同：5
> 
> 时间：2013-01-10T20:41:05.203
> 
> 标签：java, android

我正在开发一个家庭更换应用程序。我正在尝试`OnClickListener`使用 Java 添加一个按钮，但我尝试的方式会产生错误：

> 未为类型 new View.OnClickListener(){} 定义方法 startActivity(Intent)

此代码在适配器内`MyPagerAdapter`。

这就是我正在尝试的：

```
 buttonItem.setOnClickListener(new View.OnClickListener() {
        @Override
        public void onClick(View v) {
            Intent intent = new Intent("com.android.contacts.ContactsApplication");
            startActivity(intent);
        }
    }); 
```

如何`OnClickListener`向打开另一个应用程序的按钮添加一个，例如`com.android.contacts.ContactApplication`？

* * *

编辑：这是完整的代码，我现在正在尝试：

```
public class MyPagerAdapter extends PagerAdapter {

    @Override
    public Object instantiateItem(View container, int position) {
        Context context = container.getContext();
        LinearLayout layout = new LinearLayout(context);
        SharedPreferences sharedPrefs = PreferenceManager.getDefaultSharedPreferences(context);
        TextView textItem = new TextView(context);
        Button buttonItem = new Button(context);
        buttonItem.setText("Aceptar");

        // This is what I'm trying, (crashes on click)
        buttonItem.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                Intent intent = new Intent("com.android.contacts.ContactsApplication");
               v.getContext().startActivity(intent); 
            }
        }); 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T20:43:24.477

```
 buttonItem.setOnClickListener(new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        Intent i = new Intent();
        i.setComponent(new ComponentName("com.android.contacts", "com.android.contacts.DialtactsContactsEntryActivity"));
        i.setAction("android.intent.action.MAIN");
        i.addCategory("android.intent.category.LAUNCHER");
        i.addCategory("android.intent.category.DEFAULT");
        v.getContext().startActivity(i);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-23T17:44:26.397

```
(findViewById(R.id.button)).setOnClickListener(new OnClickListener() {
    @Override
    public void onClick(View v) {
        startActivity(new Intent(v.getContext(), ACTIVITY.class));
    }
}); 
```

# node.js - 使用 socket.io 访问模型会导致主干视图中的命名空间错误

> ID：14266877
> 
> 赞同：0
> 
> 时间：2013-01-10T20:41:12.990
> 
> 标签：node.js, backbone.js, namespaces, socket.io

我有一个关于在主干视图中使用套接字的问题。

如何从套接字侦听器内部访问模型？我想做类似...

> window.SocketView = Backbone.View.extend({
> 
> ```
> initialize:function () {
> 
>      _.bindAll(this, 'render', 'updateModelFromServer'); 
> 
>     this.render();
> 
> },
> 
> render:function () {
>     $(this.el).html(this.template());
>     return this;
> },
> 
> events: {
> 
>     "click #chageGlobalState"       : "updateModelFromServer"
> },
> 
> updateModelFromServer: function() {
> 
>    socket.emit("globalState", 1);
> 
>    socket.on("updateState", function(data) {
> 
>         this.model.set("state", data);
>     });
> }); 
> ```
> 
> });

这会导致 socket.io 命名空间错误。在套接字和模型之间共享数据的最佳方式是什么？

我缺少一个简单的语法问题吗？

还是我需要深入研究并使用...

事件聚合器？Backbone.io绑定？木偶？节点？

这个项目是一个类似多媒体聊天的网络应用程序。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T20:46:45.253

看起来您正在尝试`this`在套接字回调中使用错误。

而不是这样做：

```
socket.on("updateState", function(data) {
    this.model.set("state", data);
}); 
```

尝试这样做：

```
socket.on("updateState", function(data) {
    this.model.set("state", data);
}.bind(this)); 
```

# maven - 我可以使用通配符在 maven 依赖插件的 unpack-dependencies 目标中包含/排除 groupID 吗？

> ID：14266879
> 
> 赞同：3
> 
> 时间：2013-01-10T20:41:15.223
> 
> 标签：maven, maven-dependency-plugin

我有一个项目，其中一些依赖项有一个辅助工件，我想在分发时收集和解包。通过使用**类型**和**分类器**参数，我能够找到这些次要工件，这很棒。

唯一的问题是传递依赖树非常大，并且大多数传递依赖没有这个辅助工件，所以构建需要永远寻找它永远找不到的东西。

我想将搜索限制为仅可能具有这些辅助工件的某些 groupID。似乎**includeGroupIds**参数不能接受通配符。

有什么方法可以在这里使用通配符过滤，还是我必须承担明确列出每个组的维护工作？

*这是我现在拥有的一个例子；请注意包含组的冗长且难以维护的列表：*

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-dependency-plugin</artifactId>
  <executions>
    <execution>
      <id>unpack-litescale</id>
      <phase>prepare-package</phase>
      <goals>
        <goal>unpack-dependencies</goal>
      </goals>
      <configuration>
        <outputDirectory>${project.build.directory}/${project.build.finalName}/WEB-INF/classes</outputDirectory>
        <classifier>litescale</classifier>
        <type>zip</type>
        <includeGroupIds>com.foo.group1,com.foo.group2,com.foo.group3,com.foo.group4,com.foo.group5,com.foo.group6</includeGroupIds>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

**这是我想要的一个例子：**

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-dependency-plugin</artifactId>
  <executions>
    <execution>
      <id>unpack-litescale</id>
      <phase>prepare-package</phase>
      <goals>
        <goal>unpack-dependencies</goal>
      </goals>
      <configuration>
        <outputDirectory>${project.build.directory}/${project.build.finalName}/WEB-INF/classes</outputDirectory>
        <classifier>litescale</classifier>
        <type>zip</type>
        <includeGroupIds>com.foo.*</includeGroupIds>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-01-31T11:49:01.043

似乎`includeGroupIds`包括所有以提供的值作为前缀的 groupId。即在您的示例中`<includeGroupIds>com.foo</includeGroupIds>`应该这样做：

```
<plugin>
  <groupId>org.apache.maven.plugins</groupId>
  <artifactId>maven-dependency-plugin</artifactId>
  <version>3.1.0</version>
  <executions>
    <execution>
      <id>unpack-litescale</id>
      <phase>prepare-package</phase>
      <goals>
        <goal>unpack-dependencies</goal>
      </goals>
      <configuration>
        <outputDirectory>${project.build.directory}/${project.build.finalName}/WEB-INF/classes</outputDirectory>
        <classifier>litescale</classifier>
        <type>zip</type>
        <includeGroupIds>com.foo</includeGroupIds>
      </configuration>
    </execution>
  </executions>
</plugin> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-30T20:43:48.297

以您建议的方式使用 Maven 是不可能的。Maven 的声明性意思是你需要预先知道你想要什么。通过编写可以做到这一点的特定插件，您可以在这里有点创意。另请查看[Maven 程序集插件](http://maven.apache.org/plugins/maven-assembly-plugin/examples/multimodule/module-binary-inclusion-simple.html "Maven 组装插件")。

# django - 如何在 Django Crispy Forms 中包含 HTML 标题标签？

> ID：14266887
> 
> 赞同：2
> 
> 时间：2013-01-10T20:41:36.047
> 
> 标签：django, django-crispy-forms

我有以下 HTML 段，我想将其翻译为 django 脆形式：

```
 <div class="span5">
        <h3 class='offset1'>Select images</h3>
        <div id='image-drop' class='dropzone span5 center'>
            <p>Drag and drop photos and video here</p>
            <p class='big'>+</p>
            <p>Or click to add using the file browser</p>
        </div>
    </div> 
```

我将如何包含标签和

标签？我试过这个：

```
 self.helper.layout = Layout(
        Div(css_class='span5',
            HTML("<h3 class='offset1'>Select Images</h3>"),
            Div(css_id='image-drop',
                css_class='dropzone span5 center',
                HTML("<p>Drag and drop photos and video here</p><p class='big'>+</p><p>Or click to add using the file browser</p>")
                )
            )
        ) 
```

但这给出了 SyntaxError: non-keyword arg after keyword arg --> 指向带有 HTML 字段的行。包括 HTML 在内的 Div 有什么问题吗？如何翻译给定的 HTML 片段？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T21:10:38.673

错误信息很清楚，不是吗？

因此，例如，您的内部块可能看起来像这样（[**args* 拳头，然后 ***kwargs*](https://stackoverflow.com/a/3394898/630877)）：

```
Div(
    HTML("<p>Drag and drop photos and video here</p><p class='big'>+</p><p>Or click to add using the file browser</p>"),
    css_id='image-drop',
    css_class='dropzone span5 center'
) 
```

# linux - ARM 上的 Linux“顶级”实用程序报告我们已验证错误的数字。为什么？

> ID：14266888
> 
> 赞同：4
> 
> 时间：2013-01-10T20:41:41.617
> 
> 标签：linux, performance, arm

我们有一个运行 Linux 2.6.32.20 的基于 ARM9 的嵌入式板。该设备是一个摄像机，其相关的捕获/压缩硬件将数据放入 ARM 内存中的输入 fifo，然后 ARM 从用户空间访问该输入FIFO。我们还有一个用于高级控制的编码器驱动程序。

应用程序级代码中的一个线程检查此用户空间 fifo，并在有数据时通过套接字将其发送出去。为了避免该线程需要轮询用户空间 fifo 以获取数据的开销，我们对驱动程序进行了非常简单的 read() 调用，实际上它只是挂起，直到 fifo 中有任何数据（没有真正“读取”到read() 调用中提供的缓冲区）。然后这个 read() 调用返回，线程继续从 fifo 读取数据，直到它为空，然后通过调用假的 read() 调用再次挂起。

该系统非常有效，通过在检测到丢帧之前可以传输多少网络流来衡量。但是我们已经确定，使用虚假的 read() 调用会导致 Linux“top”实用程序报告我们的应用程序使用大量 CPU。

我们已经构建了 2 个版本的应用程序 - 一个与上面一样运行，另一个相同，只是它从不调用假 read()，而是通过干预 usleep() 调用轮询 fifo。当我们查看“top”报告的 2 种情况下每个发送 5 个流的 CPU 使用率时，我们得到：

1) read() 版本：CPU 12%
2) usleep() 版本：CPU 4%

当然，现实中的轮询效率较低，如果我们忽略“top”所说的内容，而只是在我们看到丢帧之前测量两个版本可以同时传输多少网络流，那么上面的版本 1 获胜。

我们已经验证了上面的 read() 调用运行正常。如果某些错误导致 read() 调用立即返回，即使 fifo 中没有数据，那么线程最终将执行昂贵的连续轮询。但这种情况并非如此; read() 调用使线程每秒准确运行 30 次。

我们认为我们的玩具busybox版本的“top”可能采取了一些捷径——但这些结果并没有出现在top用来计算其显示数字的/proc//stat中的原始数字中。

这个问题一定是Linux内核本身如何收集/proc//stat中显示的数字的一些限制。

如果有人理解为什么会这样，请指出我正确的方向。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:26:38.767

我可以保证 top 没有骗你。如果它说您的进程正在使用 12% 的 CPU，那么它正在使用 12% 的 CPU。没有两种方法。

显然，调用 usleep 不会花费太多时间，因为它会导致进程在（至少）请求的时间内进入睡眠状态。这可能是每次调用睡眠的 100 个周期。Read 做的远不止这些，所以我并不惊讶它需要更多的 CPU 时间来做这件事——尤其是如果你做很多事情的话。

阅读将：

1.  检查您的句柄是否有效。
2.  检查您的缓冲区指针和长度是否有效。
3.  将长度从用户空间复制到内核空间。
4.  将读取的数据插入到合适的数据结构中。
5.  查找相关句柄以及向哪个驱动程序发出请求。
6.  向您的驱动程序发出读取请求。
7.  驱动程序使进程休眠[假设没有可用数据]。
8.  驱动程序唤醒进程[当有可用数据时]。
9.  将读取长度数据复制到用户空间。
10.  返回给调用者。

将其与睡眠进行比较：

1.  去睡觉。
2.  醒来。
3.  返回给用户。

当然，“去睡觉”不是一个简单的功能，唤醒也不是微不足道的。但它们是相同的操作，并且在睡眠期间，进程不使用 CPU。

您可以通过从 /dev/zero 读取并在两者之间休眠来轻松计算出读取的开销。`/dev/zero`是一个立即返回的设备，其缓冲区填充为零。

或者，您可以尝试使用类似的东西`oprofile`进行性能分析，看看时间花在了哪里。

但我很确定你`top`没有说谎。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-15T19:04:35.023

的确，“保证”这个词用在这里太强了。我目前正在使用 3.8 和 3.7 内核对 2 个不同的基于 ARM 的板进行性能测试，并且两者都在顶部报告奇怪的事情。一种是使用公司提供的库存内核，另一种是使用 Arch-Linux。我不相信这些内核以任何方式被“黑客入侵”。硬件似乎并不好。一个是报告每个进程的 CPU 使用率为 0%，即使顶部的总数显示 50% 空闲。另一个显示 dma 驱动程序相关的进程总是使用 100% 的 CPU。所以在我非常有限的经验中，top 一直是我认为的问题。

# facebook - Facebook YouTube 嵌入 og:meta 标签突然停止工作

> ID：14266889
> 
> 赞同：0
> 
> 时间：2013-01-10T20:41:45.160
> 
> 标签：facebook, facebook-graph-api, video, youtube, youtube-api

[仅供参考：在堆栈溢出上发布了另一个类似标题的问题，但问题完全不同]

不久前，我为用户嵌入了代码，以在 Facebook 上分享我网站页面上的 Youtube 视频。

直到最近一切正常，我什至没有更改代码。

在我的许多页面的 Facebook 调试工具中，它已经开始处理它们并出现解析错误。

这不是一致的错误消息。

如果您需要查看一些示例，请转到 Facebook 调试工具 (https://developers.facebook.com/tools/debug) 并将以下 URL 复制并粘贴到其中。

```
http://topcommercials.tv/ads/funny-commercial-1414.php
http://topcommercials.tv/ads/banned-commercial-1372.php 
```

在试图强迫 Facebook 缓存它之后，我终于在 Facebook 上分享了上述链接。

以下是不起作用的链接：

```
http://topcommercials.tv/ads/funny-commercial-1365.php
http://topcommercials.tv/ads/banned-commercial-1364.php 
```

上述 URL 中的代码与几天前的工作代码没有什么不同。

Facebook 确实返回 og:url 错误，但这不是问题。我已经获得了与错误共享的视频，并且我的网站过去常常自动生成内容以及错误。

我以前不需要这样做。有人可以毫无问题地在 Facebook 上分享视频

另一个可能有助于解决此问题的线索是，我有时会在显示的评论框中收到错误消息。

（警告：[http](http://topcommercials.tv/ads/banned-commercial-1364.php) ://topcommercials.tv/ads/banned-commercial-1364.php无法访问。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T23:53:17.327

Facebook 将从 og:url 元标记中列出的任何数据中提取。在第一个断开的链接上，og:url 被列为[http://topcommercials.tv/wallposts/fbwallpost/ads-1364.html](http://topcommercials.tv/wallposts/fbwallpost/ads-1364.html) - 这是一个 404。

修复 404，Facebook 应该会找到正确的数据！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T19:13:52.277

我刚刚和我的网络主机谈过了。他们说，由于名称服务器设置不正确，Facebook 难以与我的服务器 IP 建立稳定的连接。我正在努力解决这个问题。我会回复大家的！

# android - 我无法在 Galaxy Ace 上运行来自 Android SDK 的 OpenGL ES 2.0 示例

> ID：14266894
> 
> 赞同：1
> 
> 时间：2013-01-10T20:41:53.750
> 
> 标签：android, opengl-es, android-emulator

我希望你能告诉我这里有什么问题：

我从 Android SDK 上的 OpenGLES 开始，我已经完成了第一课并下载了示例代码，但是当我尝试在模拟器或我的 Galaxy Ace 中运行它时，它甚至没有启动，它说应用程序意外停止。我不知道为什么，到目前为止，这是我非常小的代码：

```
package com.jdpantojavalle.gles20_framework;

import android.app.Activity;
import android.content.Context;
import android.opengl.GLSurfaceView;
import android.os.Bundle;

public class GLES20_Framework extends Activity {

private GLSurfaceView mGLView;

/**
 * CODE FOR LAUNCHING A SIMPLE OPENGLES 2.0 APP
 */

@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);

    // Create a GLSurfaceView instance and set it as the content view for this activity
    mGLView = new mGLSurfaceView(this);
    setContentView(mGLView);
}

/*
 * ORIGINAL SOURCE CODE FOR USING A SIMPLE LAYOUT
 * 
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_gles20__framework);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the menu; this adds items to the action bar if it is present.
    getMenuInflater().inflate(R.menu.activity_gles20__framework, menu);
    return true;
}
*/

}

class mGLSurfaceView extends GLSurfaceView {

public mGLSurfaceView(Context context)
{
    super(context);

    // Set the renderer for drawing on the GLSurfaceView
    setRenderer(new mGLRenderer());

    // Create an OpenGLES 2.0 context
    setEGLContextClientVersion(2);

    // Render the view only when there is a change in the drawing data
    setRenderMode(GLSurfaceView.RENDERMODE_WHEN_DIRTY);
}
}

package com.jdpantojavalle.gles20_framework;

import java.nio.ByteBuffer;
import java.nio.ByteOrder;
import java.nio.FloatBuffer;

import javax.microedition.khronos.egl.EGLConfig;
import javax.microedition.khronos.opengles.GL10;

import android.opengl.GLES20;
import android.opengl.GLSurfaceView;

public class mGLRenderer implements GLSurfaceView.Renderer {

@Override
public void onSurfaceCreated(GL10 unused, EGLConfig config)
{
    // Set the background frame color
    GLES20.glClearColor(0.5f, 0.5f, 0.5f, 1.0f);
}

@Override
public void onDrawFrame(GL10 unused)
{
    // Redraw background color
    GLES20.glClear(GLES20.GL_COLOR_BUFFER_BIT);
}

@Override
public void onSurfaceChanged(GL10 unused, int width, int height)
{
    // Reset the GL viewport
    GLES20.glViewport(0, 0, width, height);
}

} 
```

我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.jdpantojavalle.gles20_framework"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="10"
    android:targetSdkVersion="10" />

<uses-feature
    android:glEsVersion="0x00020000" android:required="true"
/>

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.jdpantojavalle.gles20_framework.GLES20_Framework"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

我不知道应用程序停止的原因是什么。我认为这可能是因为我的设备上有 ChainFire3D 但在模拟器中？谢谢你的时间，我希望你能帮助我:)

# cognos - IBM Cognos 报告在连接到 TM1 时需要用户名

> ID：14266897
> 
> 赞同：0
> 
> 时间：2013-01-10T20:41:59.863
> 
> 标签：cognos

我们使用集成登录将 IBM Cognos 连接到 TM1，但是，在运行报表时，它会询问用户名和密码。如果我们**只输入用户名**，那么报告将运行良好。如果有其他情况，则报告将不会运行。

COGNOS 网站认出了我，因为 IBM Cognos 不需要登录提示，它会在屏幕顶部显示我的名字。

我怎样才能让它运行报告并使用集成登录而不要求我输入我的用户名？

Cognos 版本是 10.1.1，TM1 版本是 9.5.2

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-24T17:04:24.970

事实证明，集成登录并没有像我们想象的那样设置。我们现在已经将登录与活动目录集成在一起，现在 Cognos 不需要用户名来运行报告。

# c++ - 您可以在 Windows 7 上编写 Windows 95 代码吗？

> ID：14266898
> 
> 赞同：3
> 
> 时间：2013-01-10T20:42:06.017
> 
> 标签：c++, windows

windows 7 api与windows 95在创建窗口、对话框和按钮方面有什么区别吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-10T20:43:49.417

是也不是——大多数 Windows 95 的代码都应该在 Windows 7 上编译和运行，但 Windows 7 还添加了很多 Windows 95 中根本不存在的新“东西”。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T20:52:03.953

基本原理并没有太大变化，而且由于 Windows 在向后兼容性方面做得很好，您会发现对话框和按钮之类的东西几乎相同。

由于 Windows 95 多年来一直不受支持，因此您可能需要找到较旧的编译器和工具集的其他部分来构建正确的可执行文件。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T20:52:23.147

对于创建 Windows，不，如果您使用 SDK 编程。但是操作系统创建的元素的外观和感觉将遵循操作系统风格（Windows 95 和 7 中的 Windows 不同）。

# ios - 如何在 settings.bundle 中设置值？

> ID：14266902
> 
> 赞同：-1
> 
> 时间：2013-01-10T20:42:24.737
> 
> 标签：ios, objective-c

我有允许用户使用电子邮件和密码登录的应用程序，
现在我想在登录成功时在 settings.bundle 中注册用户信息，以便用户可以从设置中访问它并根据需要进行更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:43:03.277

No file in an app's resource bundle can be updated. All of those files are read-only.

Of course you can write values to `NSUserDefaults` which are used to load and save values seen by the user in the settings.

# mysql - 在 SQL 中组合非唯一值

> ID：14266905
> 
> 赞同：1
> 
> 时间：2013-01-10T20:42:29.683
> 
> 标签：mysql, sql

无法在这里找到具体的答案，如果我含糊不清，我很抱歉，因为我正在努力理解我在问什么。

我有一个名为 Data 的表，可以说它的列设置为：

```
Id | X 
```

该数据的样本将是：

```
Jon1 | a
Jon1 | a
Jon1 | d
Jon2 | b
Jon2 | c
Jon2 | d
Jon2 | c 
```

我正在尝试计算 ID 的 x 数。假设 X 有 4 个不同的可能值，我们会说 a,b,c,d,e。我想要做的是获得一个唯一 ID 的 a、b、c、d 总数。我想要的结果是：

```
Jon1 | 3
Jon2 | 4 
```

我知道这可能通过 COUNT 子查询实现，但我不确定在哪里将计数链接到某个 ID。这有意义吗？我有点难以思考。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:45:31.340

试过这个？

```
SELECT ID, COUNT(*) 
FROM TABLENAME 
GROUP BY ID 
```

这是[SQL Fiddle](http://sqlfiddle.com/#!2/52e8f/2)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:45:45.393

如果你不是在寻找`DISTINCT COUNT`那么这应该是你所需要的

```
SELECT Id, COUNT(X)
FROM tbl
GROUP BY Id 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-10T20:45:49.777

```
SELECT id , COUNT(x) as Total FROM mytable GROUP BY id 
```

# youtube-api - 各种视频标签问题（html5）

> ID：14266906
> 
> 赞同：0
> 
> 时间：2013-01-10T20:42:35.853
> 
> 标签：youtube-api, html5-video

如果我在 html5 中有视频标签，我可以响应 canplay 事件或 canplaythrough 事件。第一个告诉您视频何时可以播放，第二个告诉您它不仅可以播放，而且整个视频已加载到您的 PC 上。当您尝试将“当前时间”设置为接近视频结尾时，这会有所不同吗？即使在第二种情况下有延迟，它在这两种情况下都有效吗？另外：我读到 youtube 正在制作一个 html5播放视频的方式。这是否意味着他们使用 iframe，并使用一组类似于 videotag 命令的命令？或者这是否意味着他们真的在使用 HTML5 视频标签？谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T02:03:17.173

为了准确设置当前时间，HTML5 视频 API 不需要加载整个视频……它只需要知道视频的长度。因此，侦听任一事件都应该有效，但您也可以侦听稍早触发的loadedmetadata 事件。

Youtube 已经对真正的 html5 播放提供测试版支持已有一段时间了；你可以在这里选择加入他们的测试版：

[https://www.youtube.com/html5](https://www.youtube.com/html5)

作为开发人员，您还可以在嵌入 iframe 时强制播放 html5，方法是将 html5=1 附加到 iframe 的 src url 的查询字符串的末尾。但是，当不支持 HTML5（即 IE8 及以下）或视频有广告时，仍然会有 Flash 回退。

# clojure - 如何在 Clojure 中不是“必需”或“使用”的命名空间中搜索函数？

> ID：14266910
> 
> 赞同：1
> 
> 时间：2013-01-10T20:42:41.547
> 
> 标签：clojure, namespaces

如何在 Clojure 源文件中不是“必需”或“使用”的命名空间中搜索函数？基本上我想做的是有源文件：

```
main.clj,
a.clj,
b.clj,
c.clj 
```

`import`// a, b, or c in main.`require`所有编译在一起但不直接编译。`use`相反，我主要采用命令行参数，然后搜索正确的函数（甚至可能只是一个完全限定的符号）。

我看了看，`ns-publics`但它需要一个名称空间符号。我试图`bultitude`从 src/ 目录中获取所有命名空间，然后我取回了 lib.a、lib.b、lib.c、lib.main 等，但由于 main 不使用或不需要或以其他方式引用另一个使用 ns-publics 时出现错误。`No namespace lib.a found`根据[-ns源代码中的尝试](https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L3741)。

如何查看项目中包含但​​不直接被特定文件引用的代码的公共接口，甚至是引用的依赖项？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T23:19:58.443

这是一个简单的解决方法，在出现更好的解决方案之前可能会有所帮助。它返回文件中定义的所有公共符号的列表。让我们阅读文件并查找所有`def`性别。忽略私有的，即像`defn-`.

```
(let [file (with-in-str (str "(" (slurp filename) ")") (read))
      defs (filter #(.matches (str (first %)) "^def.*[^-]$") file)
      symbols (map second defs)]
  symbols) 
```

注意事项：

*   好吧，这简直太天真了。
*   它并没有摆脱所有私有定义。使用`^{:private true}`或未`^:private`过滤的定义。
*   可以使用宏生成定义。

最后一点尤其令人不安。检测使用宏生成的定义的唯一合理方法是使用阅读器评估文件，至少部分评估。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T10:08:47.423

解析不会起作用，因为 clojure 是非常动态的。

所以，这样的事情可能会奏效......

```
(load-file "file_with_stuff.clj")
(ns-publics (find-ns 'file-with-stuff))
(remove-ns 'file-with-stuff) 
```

如果你想动态地做所有事情，那么你可以使用 symbol 生成符号——应该仍然有效。删除 ns 是可选的。它不会造成任何伤害，但它确实会让你回到你开始的地方。

# android - 为什么日志收集器的市场链接不起作用？

> ID：14266911
> 
> 赞同：0
> 
> 时间：2013-01-10T20:42:47.063
> 
> 标签：android, android-emulator

我试图将 LogCollector 包含到我的应用程序中，并使用了这个站点的集成示例

[http://code.google.com/p/android-log-collector/source/browse/trunk/android-log-collector-usage/src/com/xtralogic/android/logcollector/usage/Main.java](http://code.google.com/p/android-log-collector/source/browse/trunk/android-log-collector-usage/src/com/xtralogic/android/logcollector/usage/Main.java)

但是当我尝试在我的应用程序中使用它时，它正确显示它没有安装

[http://pbrd.co/VVD1Bx](http://pbrd.co/VVD1Bx)

但是在尝试打开市场时它崩溃了，这是日志输出

```
 01-10 20:38:04.309: E/AndroidRuntime(3265): FATAL EXCEPTION: main
    01-10 20:38:04.309: E/AndroidRuntime(3265): android.content.ActivityNotFoundException: No Activity found to handle Intent { act=android.intent.action.VIEW dat=market://search?q=pname:com.xtralogic.android.logcollector flg=0x10000000 }
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1408)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1378)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at android.app.Activity.startActivityForResult(Activity.java:2817)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at android.app.Activity.startActivity(Activity.java:2923)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at de.srs.android.pdixuploader.activies.SettingsActivity$1.onClick(SettingsActivity.java:102)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at com.android.internal.app.AlertController$ButtonHandler.handleMessage(AlertController.java:158)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at android.os.Handler.dispatchMessage(Handler.java:99)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at android.os.Looper.loop(Looper.java:123)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at android.app.ActivityThread.main(ActivityThread.java:4627)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at java.lang.reflect.Method.invokeNative(Native Method)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at java.lang.reflect.Method.invoke(Method.java:521)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:868)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:626)
    01-10 20:38:04.309: E/AndroidRuntime(3265):     at dalvik.system.NativeStart.main(Native Method) 
```

这可能是什么原因？我正在模拟器上测试这个。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:44:17.667

这是因为它试图在 Google Play 上打开应用程序页面，而模拟器没有安装 Google Play。

因此，没有应用程序来处理`market://`URI 方案，导致`ActivityNotFoundException`.

您的链接可以在安装了 Google Play 的设备上找到。请记住，从 Android 4.2 开始，LogCollector 不再能够访问其他应用程序的日志（或任何其他日志记录应用程序，除非它在根设备上具有根权限）。

您可以使用以下方法检查设备是否安装了 Google Play：

```
public boolean hasGooglePlayInstalled() {
    Intent market = new Intent(Intent.ACTION_VIEW, Uri.parse("market://details?id=dummy"));
    PackageManager manager = mContext.getPackageManager();
    List<ResolveInfo> list = manager.queryIntentActivities(market, 0);

    if (list != null && list.size() > 0) {
        for (int i = 0; i < list.size(); i++) {
            if (list.get(i).activityInfo.packageName.startsWith("com.android.vending") == true) {
                return true;
            }
        }
     }
    return false;
} 
```

# json - 调用JSON服务的google图表工具示例代码

> ID：14266925
> 
> 赞同：0
> 
> 时间：2013-01-10T20:43:31.600
> 
> 标签：json, charts

有人可以通过调用 JSON API URL 向我发送可以创建交互式图表的正确代码吗？

示例：基于 url 中 JSON API 的图表

[http://api.geonames.org/citiesJSON?north=44.1&south=-9.9&east=-22.4&west=55.2&lang=de&username=demo](http://api.geonames.org/citiesJSON?north=44.1&south=-9.9&east=-22.4&west=55.2&lang=de&username=demo)

在谷歌网站上有一个示例[https://developers.google.com/chart/interactive/docs/php_example](https://developers.google.com/chart/interactive/docs/php_example)

但下面什么都没有显示（我用我的 URL 替换了原始 JSON PHP 文件位置）

```
<html>
  <head>
    <!--Load the AJAX API-->
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script type="text/javascript" src="jquery-1.6.2.min.js"></script>
    <script type="text/javascript">

    // Load the Visualization API and the piechart package.
    google.load('visualization', '1', {'packages':['corechart']});

    // Set a callback to run when the Google Visualization API is loaded.
    google.setOnLoadCallback(drawChart);

    function drawChart() {
      var jsonData = $.ajax({
          url: "http://api.geonames.org/citiesJSON?north=44.1&south=-9.9&east=-22.4&west=55.2&lang=de&username=demo ",
          dataType:"json",
          async: false
          }).responseText;

      // Create our data table out of JSON data loaded from server.
      var data = new google.visualization.DataTable(jsonData);

      // Instantiate and draw our chart, passing in some options.
      var chart = new google.visualization.PieChart(document.getElementById('chart_div'));
      chart.draw(data, {width: 400, height: 240});
    }

    </script>
  </head>

  <body>
    <!--Div that will hold the pie chart-->
    <div id="chart_div"></div>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T21:28:30.173

查看从您提供的 URL (http://api.geonames.org/citiesJSON?north=44.1&south=-9.9&east=-22.4&west=55.2&lang=de&username=demo) 返回的 JSON，它看起来不像'不符合[DataTable JSON 格式](https://developers.google.com/chart/interactive/docs/reference#dataparam)。

来自[https://developers.google.com/chart/interactive/docs/basic_preparing_data](https://developers.google.com/chart/interactive/docs/basic_preparing_data)：

> 所有图表都需要数据。Google Chart Tools 图表要求将数据包装在名为 google.visualization.DataTable 的 JavaScript 类中。此类在您之前加载的 Google 可视化库中定义。DataTable 是具有行和列的二维表，其中每一列都有一个数据类型、一个可选的 ID 和一个可选的标签。

如果您查看他们提供的示例 JSON 数据，您会发现它符合 DataTable 格式：

```
{
  "cols": [
        {"id":"","label":"Topping","pattern":"","type":"string"},
        {"id":"","label":"Slices","pattern":"","type":"number"}
      ],
  "rows": [
        {"c":[{"v":"Mushrooms","f":null},{"v":3,"f":null}]},
        {"c":[{"v":"Onions","f":null},{"v":1,"f":null}]},
        {"c":[{"v":"Olives","f":null},{"v":1,"f":null}]},
        {"c":[{"v":"Zucchini","f":null},{"v":1,"f":null}]},
        {"c":[{"v":"Pepperoni","f":null},{"v":2,"f":null}]}
      ]
} 
```

# .net - 将文件上传到共享保管箱文件夹

> ID：14266941
> 
> 赞同：0
> 
> 时间：2013-01-10T20:44:39.417
> 
> 标签：.net, dropbox, dropnet, sharpbox

我想从 ASP.NET MVC 2 中的 Web 应用程序将用户发送的文件上传到我的保管箱共享文件夹。可能吗？怎么做？我尝试使用 DropNet，但遇到了一些问题，它似乎没有达到我的目的.. 有什么建议吗？沙盒更好吗？

非常感谢，大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:47:17.983

一个简单有效的替代方法（如果您可以控制服务器）是让 Dropbox 客户端在服务器上运行。

然后，您只需将文件上传到文件系统上的保管箱文件夹，客户端将负责其余的工作，而无需任何第三方（或第四）方库。

# java - ArrayList 未正确读取

> ID：14266943
> 
> 赞同：0
> 
> 时间：2013-01-10T20:44:43.990
> 
> 标签：java

我有一个 ArrayList 并且我希望它读取并总计文件中的数字，但它只输出文件中的最后一个数字，它们都在不同的行等。

```
Here is my code, thanks in advance: 

import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;

public class ArrayListOfNumbers {
    public static void main(String[] args) throws FileNotFoundException {

        ArrayList<Integer> list = new ArrayList<Integer>();
        list.add(1);
        Scanner Scan = new Scanner (new File("numbers.txt"));

        int sumOf = 0;
        for(int i=0; i < list.size(); i++){
            sumOf = sumOf + list.get(i);
        }
        //while scanning add sum to ArrayList List
        while (Scan.hasNext())
        {
            sumOf = Scan.nextInt();
            list.add(sumOf);
        }
        //print the array list
        System.out.println(sumOf);
        Scan.close();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:47:07.343

在阅读数字之前，您正在总结列表中的数字。

所以像这样移动你的循环：

```
 //while scanning add sum to ArrayList List
    while (Scan.hasNext())
    {
        int number = Scan.nextInt();
        list.add(number);
    }
    int sumOf = 0;
    for(int i=0; i < list.size(); i++){
        sumOf = sumOf + list.get(i);
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:46:50.657

您打印`sumOf`的不是列表。当然，这是一个数字。

此外，您应该在对它们求和之前阅读这些数字。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:48:58.667

逐行阅读，适当命名变量。从文件中读取后，遍历列表并求和。

```
 while (scanner.hasNextLine()) {
    String line = scanner.nextLine();
    System.out.println(line);
 } 
```

# ruby-on-rails - 用于电子邮件确认和密码重置的 Rails 路由

> ID：14266945
> 
> 赞同：0
> 
> 时间：2013-01-10T20:44:47.530
> 
> 标签：ruby-on-rails, routes, password-recovery, email-confirmation

我需要一些用于在 Rails 中**确认电子邮件**和**重置密码**的路线，以便用户在他们收到的电子邮件中单击。

我查看了[Railscast #274 - 记住我并重置密码](http://railscasts.com/episodes/274-remember-me-reset-password?view=asciicast)，它为那个重置操作创建了一个单独的控制器。

想知道是否因为它们都是`User#email`相关的，所以它们可能不适合作为用户控制器本身的成员或集合操作？！？路线如：

`/user/reset/:token`&`/user/confirm/:token` *或* `/user/:id/reset/:token`&`/user/:id/confirm/:token` 似乎是合理的，但不确定如何创建它们以及路线助手会是什么样子？！？

或者也许它们都可以组合在一个控制器中？`verification/confirm/:token`& `/verification/reset/:token`?

无论如何，只是寻找想法来节省我的一些试验和错误。我不想要的是两个单独的控制器（一个用于电子邮件确认，另一个用于密码重置）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:54:21.457

这当然可以做到，但它不是 RESTful。这些资源（确认、重置）可以由专用控制器更好地处理，该控制器具有更简单、更不易碎的代码，因为它符合 REST 模式。一如既往的约定优于配置......如果您发现这不适用于您的特定情况，请务必按照您认为合适的方式进行。

# django - 带有 Amazon s3 的 Django Sorl 缩略图的错误 URL

> ID：14266950
> 
> 赞同：11
> 
> 时间：2013-01-10T20:45:04.147
> 
> 标签：django, amazon-s3, sorl-thumbnail

我在将 S3 用于媒体文件的 django 项目中使用 sorl 缩略图时遇到了一个非常奇怪的错误。我已按照此答案[https://stackoverflow.com/a/12848650/538191](https://stackoverflow.com/a/12848650/538191)中的说明完成了设置，实际上我的所有其他媒体文件都已正确生成。

但是对于通过 sorl 缩略图生成的图像，我得到一个这样的 url

[https://he-s3.s3.amazonaws.com/cache/6f/cb/6fcb83175cb63f754fba9facec5dda7f.jpg?Signature=tgDEXyRV3gl3QtK%2BvwliqAtWqpM%3D&Expires=1357853609&AWSAccessKeyId=AKIAJLE6MUHDYS3HN6YQ](https://he-s3.s3.amazonaws.com/cache/6f/cb/6fcb83175cb63f754fba9facec5dda7f.jpg?Signature=tgDEXyRV3gl3QtK%2BvwliqAtWqpM%3D&Expires=1357853609&AWSAccessKeyId=AKIAJLE6MUHDYS3HN6YQ)

这个问题很奇怪，因为它将 S3 存储路径附加到图像 url，但它没有在两者之间添加 /media/。如果你检查

[https://he-s3.s3.amazonaws.com/media/cache/6f/cb/6fcb83175cb63f754fba9facec5dda7f.jpg](https://he-s3.s3.amazonaws.com/media/cache/6f/cb/6fcb83175cb63f754fba9facec5dda7f.jpg)

该图像实际上存在于那里，但由于 url 生成错误，我得到一个损坏的图像。在设置文件中，我使用 s3boto 声明了 DEFAULT_FILE_STORAGE 并且它包含

```
S3_URL = 'http://he-s3.s3-website-ap-southeast-1.amazonaws.com'
MEDIA_URL = S3_URL + '/media/' 
```

我不明白为什么 sorl 缩略图图像中的路径不包含媒体。

任何帮助表示赞赏。

**更新**

问题不但没有得到解决，反而变得更加复杂。我所做的是我清除了缩略图中的 KVStore 并清除了所有数据库。我很高兴，因为我认为问题已经解决了，我现在得到了正确的 url。但后来我刷新了页面，我又得到了错误的 url。我不明白发生了什么，如果我清除缩略图数据库，它会显示一次正确的 url，然后再次显示错误的 url。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-08-04T18:25:25.597

我敢打赌你正在使用这样的东西：

```
MediaS3BotoStorage = lambda: S3BotoStorage(location='media') 
```

然而，这会导致 sorl-thumbnail 出现问题，因为它使用类名将存储类序列化到缓存中。稍后当它反序列化时，它实例化为没有位置参数的 S3BotoStorage()。这就是为什么它第一次对你有用，但后来又失败了。

您可以通过使用成熟的类而不是工厂来修复它：

```
class MediaS3BotoStorage(S3BotoStorage):
    location = 'media' 
```

希望有帮助！

# mysql - MySQL 语法错误值

> ID：14266956
> 
> 赞同：1
> 
> 时间：2013-01-10T20:45:34.413
> 
> 标签：mysql, insert

我不断收到此错误消息：

```
#1064 - You have an error in your SQL syntax; check the manual that corresponds 
to your MySQL server version for the right syntax to use near 
'`contact` VALUES (0, 'Chris', 'rember', 'chris@fox.com')' at line 1 
```

对于以下代码：

```
DROP TABLE IF EXISTS contact;

CREATE TABLE contact (
  contactID INT PRIMARY KEY,
  name VARCHAR (50),
  company VARCHAR (30),
  email VARCHAR (50)
);

INSERT INFO contact VALUES
  (0, 'Chris', 'rember', 'chris@fox.com');

SELECT * FROM contact; 
```

这是我的第一个数据库，所以我很困惑，我尝试在联系人周围放回刻度，但这似乎没有任何作用。

任何线索？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:49:24.533

你写的是“INFO”而不是“INTO”。它应该是：

```
INSERT INTO contact VALUES (0, 'Chris', 'rember', 'chris@fox.com'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-10T20:49:38.813

小的语法错误。

```
INSERT INFO contact VALUES
         ^ 
```

应该

```
INSERT INTO contact VALUES 
```

# php - 巨大的帖子状态表，从前 100 名中随机选择

> ID：14266963
> 
> 赞同：1
> 
> 时间：2013-01-10T20:46:03.490
> 
> 标签：php, mysql, select, random, schema

我有一张桌子，上面有类似状态的帖子。表列是：

```
ID        //which is unique incremental
Post_id   //liked post
user_id   //user who gave like or dislike
type      //"1","0" or "2" which stands for Liked, neutral or disliked. 
```

这是示例数据

```
+--------+---------+---------+------+
| id     | post_id | user_id | type |
+--------+---------+---------+------+
| 938300 |  347298 |     661 |    0 |
| 938299 |  346185 |       0 |    1 |
| 938298 |  347286 |    2645 |    0 |
| 938297 |  346924 |     374 |    1 |
| 938296 |  347261 |    1523 |    1 |
| 938295 |  347313 |    3233 |    1 |
| 938294 |  346323 |    1375 |    1 |
| 938293 |  347022 |    1779 |    1 |
| 938292 |  347278 |    2645 |    1 |
| 938291 |  347300 |     109 |    1 |
+--------+---------+---------+------+
10 rows in set (0.01 sec) 
```

但是这个查询运行完美，但是你们可以看到这个表中有数百个数据。我需要的是：

```
SELECT post_id, 
       count(post_id) 
FROM   'table'
WHERE  type = '1' 
GROUP  BY post_id 
ORDER  BY count(post_id) 
LIMIT  300; 
```

此查询选择最喜欢的 300 个帖子，php 代码从中随机选择一个。但是，此查询具有全表扫描，它会持续 5 秒以上。我怎样才能加快速度，或者我必须更改表格方案吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T21:36:25.217

您可能可以通过使用索引来获得一些加速。您的查询在计算方面是昂贵的，因此缓存可能是更好的答案。查看是否拥有这些索引中的一个或两个对您的表有帮助：

```
CREATE INDEX post_id_index ON `table` (post_id);
CREATE INDEX type_index ON `table` (type); 
```

如果没有，则使用以下命令删除它们：

```
DROP INDEX post_id_index ON `table`;
DROP INDEX type_index ON `table`; 
```

如果它们没有帮助，请确保放下它们，但请事先尝试几次以确保确定。如果缓存不适合您，另一种选择是保留另一个仅包含该结果的表。我认为这可能已经被建议了。我建议使用索引，因为创建它们非常容易。只需将每个作为完整的 SQL 命令运行，看看有问题的查询是否更快。以下是有关索引的更多信息：

[http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html](http://dev.mysql.com/doc/refman/5.0/en/mysql-indexes.html)

# java - 如何在游戏 Hangman 中使用 3D 阵列？

> ID：14266964
> 
> 赞同：0
> 
> 时间：2013-01-10T20:46:04.337
> 
> 标签：java, arrays, multidimensional-array

```
public static String[] getWords(int cat, int diff) {
    String topic[][][] = new String[3][3][3];
    switch (cat) {
        case 0:
            topic[0][0][0] = "Paris";
            topic[0][0][1] = "London";
            topic[0][0][2] = "Sydney";
            diff = 0;
            topic[0][1][0] = "Toronto";
            topic[0][1][1] = "Florida";
            topic[0][1][2] = "Frankfurt";
            diff = 1;
            topic[0][2][0] = "Barcelona";
            topic[0][2][1] = "Vancouver";
            topic[0][2][2] = "Zimbabwe";
            diff = 2;
        case 1:
            topic[1][0][0] = "Halo";
            topic[1][0][1] = "Fifa";
            topic[1][0][2] = "GTA";
            diff = 0;
            topic[1][1][0] = "Skyrim";
            topic[1][1][1] = "HITMAN";
            topic[1][1][2] = "Batman";
            diff = 1;
            topic[1][2][0] = "Minecraft";
            topic[1][2][1] = "Zombieville";
            topic[1][2][2] = "BoderLands";
            diff = 2;
        case 2:
            topic[2][0][0] = "Acura";
            topic[2][0][1] = "Audi";
            topic[2][0][2] = "Bmw";
            diff = 0;
            topic[2][1][0] = "Bentley";
            topic[2][1][1] = "Buggati";
            topic[2][1][2] = "Honda";
            diff = 1;
            topic[2][2][0] = "Lamborghini";
            topic[2][2][1] = "Rolls-Royce";
            topic[2][2][2] = "Mercedes";
            diff = 2;
    }
    return topic[cat][diff];
} 
```

这将是 3d 数组并有 3 个选项，其中包括级别难度和类别，我如何调用它并使用它，就好像人们选择这个......它将通过数组并选择这个我是将它放在一个方法中并在主方法中调用它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-10T20:54:28.360

所以你问如何使用你的阵列？最简单的方法是创建一个方法，该方法返回存储在适当类别和难度下的值

IE

```
public String[] getWords(int cat, int diff)
{
 return topic[cat][diff];
 } 
```

您可以调用该方法，然后从返回的数组中选择一个单词供玩家猜测。

更新：

我要冒昧地说你在编程方面还很新，而且你还不明白如何使用方法。[一些轻松的阅读可能会有所帮助。](http://docs.oracle.com/javase/tutorial/java/javaOO/methods.html)您在 main 方法之外定义方法并调用以检索给定玩家的单词。您传入两个整数，然后用于指定您想要访问的数组中的位置。

# vb.net - 如何将值插入（字符串，列表（字符串））字典的列表部分？

> ID：14266965
> 
> 赞同：4
> 
> 时间：2013-01-10T20:46:04.757
> 
> 标签：vb.net, list, dictionary, visual-studio-2012

我正在使用`dictionary(of string, list(of string))`VB 来存储从大型 .csv 文件中提取的一些文本数据。

dictionary.key 只是一个日期字符串，如“2012-12-12”，相应的列表值包含与该日期关联的所有文件。

使用 a`StreamReader`和 a `line.split`，我可以提取日期字符串并将其与字典进行比较。如果字典不包含该日期，我想将其作为新键插入，然后将文件名添加到该键的列表中。这将遍历整个文件，然后使用相同的字典继续浏览用户选择的每个文件。最终，每个日期我应该看到 4 或 5 个文件名，每个日期不允许有重复的文件名。

使用`dictionary.add`方法执行此操作的正确方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-10T20:56:19.530

像这样的东西？

```
Dim key as String = "asdf"
If Not dict.ContainsKey(key) Then
    dict.Add(key, New List(Of String)(New String() {"1", "2", "3"}))
    Dim values = dict(key)
    If not values.Contains("some value") Then
        values.Add("some value")
    End If
End If 
```

或类似的东西：

```
Dim key as String = "asdf"
If Not dict.ContainsKey(key) Then
    dict.Add(key, New List(Of String))
    dict(key).Add("1")
    dict(key).Add("2")
    ... and however many more values here ...
End If 
```

# forms - Symfony 未在树枝中显示错误

> ID：14266970
> 
> 赞同：0
> 
> 时间：2013-01-10T20:46:25.397
> 
> 标签：forms, error-handling, twig, symfony-2.1

我对 Symfony2 框架相当陌生，并且无法在 twig 中显示错误。约束是使用设置的`$form->createFormBuilder()->add()`

当我运行时`{{ form_errors(form) }}`没有任何显示并且我不确定我做错了什么。

```
public function massEmailAction(Request $request)
{
    $data['errors'] = '';
    $form = array('message'=>'test', 'single_email_val'=>'', 'send_to'=>'');
    $form = $this->createFormBuilder($form)
    ->add('message', 'textarea', array('attr'=>array('style'=>"width: 800px; height: 500px;")))
    ->add('single_email_val', 'text', array('label'=>'Single Email', 'required'=>false, 
                                                            'constraints'=>array(
                                                               new NotBlank(),
                                                               new Length(array('min' => 3)),

                                                    ),
                                            'invalid_message'=>'email not valid',
                                            'error_bubbling'=>true,
                                            ))
    ->add('send_to', 'choice', array('choices'=>array(''=>'Select',
                                                      'single_email'=>'Send to Single Email',
                                                      'mass_email'=>'Send to All'
                                                    ),
                                                    'required'=>false,

    ))
    ->getForm();

    $data['form'] = $form->createView();

    if($request->isMethod('POST'))
    {
        $emailConstraint = new NotBlank();
        $formData = $form->bind($this->getRequest());
        // Get form data
        $post = $formData->getData();
        echo $post['single_email_val'];

        if(!$form->isValid())
        {

            echo 'not valid';
            //print_r($this->getErrorMessages($form));
            print_r($this->getErrorMessages($form));
            $data['errors'] = $this->getErrorMessages($form);
            // print_r($form->getErrors());
            //echo $form->getErrorsAsString();
        }
        else
        {

        }

    }

    return $this->render('TmarketMarketingBundle:Default:massEmail.html.twig', $data);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T15:32:43.657

按此顺序尝试

```
**$data['form'] = $form->createView();**
return $this->render('TmarketMarketingBundle:Default:massEmail.html.twig', $data); 
```

您在绑定和验证数据之前获得表单视图

# android - android网格样式视图

> ID：14266973
> 
> 赞同：0
> 
> 时间：2013-01-10T20:46:31.420
> 
> 标签：android, android-layout

我需要在 Android 上制作一个电视指南样式的网格，但不知道如何去做。

它应该是一个列表，其中包含屏幕左侧的频道。顶部的标题应以 1 小时为增量分成时间段。数据应该是节目列表，并且应该允许您从左到右滚动以更改时间以及上下滚动以更改频道。

我在想原来的列表只是频道的下降。然后覆盖加载行，以便查询所选时隙范围内的通道。我不确定如何锁定滚动，以便所有行将同时朝同一方向滚动。

这样的事情甚至可能吗？是否有用于加载大型网格样式数据的小部件？

所有数据都将存储在 ContentProvider 中，以便于查询。

我只是在寻找一个好的起点。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-10T20:48:37.203

你看过[http://developer.android.com/guide/topics/ui/layout/gridview.html](http://developer.android.com/guide/topics/ui/layout/gridview.html) 这是否不足以满足你的需求？

此外，您需要记住，您描述的那种网格视图已获得 TVGuide 的专利，因此，如果这是您正在制作的商业产品，您将需要获得使用此类网格的权利，或者被他们起诉停止使用它。

# asp.net-mvc-4 - MVC 4 Ajax 表单发布操作始终发布第一次尝试发布的值

> ID：14266975
> 
> 赞同：0
> 
> 时间：2013-01-10T20:46:41.717
> 
> 标签：asp.net-mvc-4, jquery-dialog, asp.net-mvc-partialview, jquery-post

我正在尝试创建简单的 CRUD 应用程序。我有一个填充行的部分视图。在每一行中都有一个编辑链接，我正在打开一个 jquery 对话框。在这个对话框中，我加载了另一个局部视图来编辑相应的行。在确定按钮上，我发布表单（这是一个 ajax 表单）。

然后控制器返回另一个部分视图，该视图假设要替换原始列表（列表部分视图），因为我提供了 updateTargetId（这是呈现列表的 div。

在这里，我面临两个问题，

1.  这是我第一次发布表格（即第一次在会话中）。当我打开另一条记录进行编辑时，表单已正确加载，但当我发布它时，表单始终具有第一次尝试发布的记录的值。
2.  即使发布成功，列表也不会更新。我可以在提琴手中看到帖子响应。只有在我刷新浏览器后才会刷新列表。

我尝试清除 modelState 但不起作用。我已经尝试调试 jquery 代码，我发现当我这样做时 form.serialize 有旧值，所以控制器总是得到这些值。

我认为它在某处缓存表单。然后我通过添加关闭缓存

```
$.ajaxSetup({ cache: 'false' }); 
```

在 document.ready 中。那也行不通。

这是jQuery代码

```
this.bindOpenDialog = function () {
    $(".openDialog").click(function (e) {
        e.preventDefault();
        var height = $(this).attr("data-dialog-height");
        var width = $(this).attr("data-dialog-width");
        var data_postUrl = $(this).attr("data-postUrl");
        var data_returnUrl = $(this).attr("data-returnUrl");
        var data_updateTarget = $(this).attr("data-updateTarget");
        var data_form_id = $(this).attr("data-form-id");
        var callBack = $(this).attr("callBack");
        if (data_postUrl == '') {
            data_postUrl = this.href;
        }
        var div = $("<div></div>");
        div.addClass("ui-dialog")
        div.attr("id", $(this).attr("data-dialog-id"))
        var dialog = div.dialog({
            title: $(this).attr("data-dialog-title"),
            close: function () { $(this).remove() },
            height: height,
            width: width,
            modal: true,
            buttons: {
                'Save': function () {
                    var dialog = $(this);
                    var form = null;
                    if (data_form_id == '' || data_form_id == undefined) {
                        form = dialog.find('form').first();
                    }
                    else {
                        form = $("#" + data_form_id).first();
                    }

                    var req = $.post(data_postUrl, form.serialize(),
                        function (responseText, textStatus) {
                        }, "html");
                    req.success(function (data) {
                        if (callBack == '' || callBack == undefined) {
                            dialog.dialog('destroy');
                        }
                        else {
                            var cb = eval(callBack + "()");
                            dialog.dialog('destroy');
                        }
                    });
                    req.success(function (data) {
                        if (callBack == '' || callBack == undefined) {
                            thisDialog.dialog('destroy');
                        }
                        else {
                            var cb = eval(callBack + "()");
                            thisDialog.dialog('destroy');
                        }
                        //remove the form from the DOM.
                        //If I do not do this, it always posts the
                        // form which was posted for the first time.
                        $("#" + data_form_id).remove();
                    });
                    req.error(function (e) {
                        alert('error ' + e.toString())
                    });
                },
                'Cancel': function () {
                    var dialog = $(this);
                    dialog.dialog('destroy');
                }
            }

        });
        dialog.load(this.href);
    }
); 
```

有没有人已经面临这个问题？

我的另一项观察是 jQuery 没有更新目标。我还在 Ajax 表单上设置了 OnSuccess 事件，它不会触发。

* * *

我的另一项观察是 jQuery 没有更新目标。我还在 Ajax 表单上设置了 OnSuccess 事件，它不会触发。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-13T00:14:59.933

我不确定这是否是最好的方法，但是当我在 javascript 中销毁对话框后从 DOM 中删除表单时。我认为 jquery 没有杀死表单实例

现在我的 javascript 看起来像

```
req.success(
            function (data) {
                if (callBack == '' || callBack == undefined) {
                    thisDialog.dialog('destroy');
                }
                else {
                    var cb = eval(callBack + "()");
                    thisDialog.dialog('destroy');
                }
                //remove the form from the DOM.
                //If I do not do this, it always posts the form which was posted for the first time.
                $("#" + data_form_id).remove();
            }
        ); 
```

如果有更好的方法，有人可以建议吗？

问候， 马赫什

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-13T00:17:04.990

Mark 方法返回部分视图（用于编辑和列表）以使用属性进行编辑和重建解决方案：

```
[OutputCache(NoStore = true, Duration = 0, VaryByParam = "*")] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-15T11:20:03.353

好的，我想分享一个学习，我正在使用 Ajax.BeginForm。我在 jquery 对话框中打开这个表单。此对话框具有确定和取消按钮。在确定单击时，我正在发布我的 ajax 表单。这就是它不更新 div 的原因。II 使用提交按钮发布此表单，它可以工作。

所以学习是，如果您使用的是 Ajax.Begin 表单，那么您必须使用提交按钮发布表单，以便更新目标并在 OnComplete 事件上运行脚本。

如果您使用任何其他按钮提交表单，则无法利用此优势。在这种情况下，您需要通过 javascript 来完成。

希望这可以帮助某人。

（我将此标记为答案以引起对这篇文章的关注。）

# sql - sql动态where子句重复列过滤

> ID：14266977
> 
> 赞同：0
> 
> 时间：2013-01-10T20:46:44.990
> 
> 标签：sql, filtering

所以我一直在尝试研究一种方法，我可以拥有一个存储过程，它将对各种列执行动态搜索以过滤数据，但具有类似于 WHERE IN 的功能，即每列采用多个输入标准。

所以假设我有 3 列 FN、LN、DOB。我需要一个存储过程，它可以让我为三个变量的任意组合提供值，每列有多个值。

例如：未提供 FN IN ('ADAM', 'BRIAN') OR LN IN ('SMITH') OR DOB。

我试图遵循这个，

```
SELECT 
  FN,    
  LN
FROM TestData
WHERE 
  (CASE 
    WHEN @FN IS NULL THEN 'True'
    ELSE FN
  END) = (CASE 
           WHEN @FN IS NULL THEN 'True'
           ELSE @FN
         END)
  AND (CASE 
        WHEN @LN IS NULL THEN 'True'
        ELSE LN
       END) = (CASE 
                WHEN @LN IS NULL THEN 'True'
                ELSE @LN
               END)
  AND (CASE 
        WHEN @DOB IS NULL THEN '1/1/0001'
        ELSE DOB
       END) = (CASE 
                WHEN @DOB IS NULL THEN '1/1/0001'
                ELSE @DOB
              END) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-10T21:00:45.410

看来您正在使用 SQLServer（我的猜测基于`@`变量前缀），因此您可以传递一个类型的变量，而不是传递标量变量`TABLE`；`JOIN`因此，您可以在条件中实现所需的逻辑。例如，

```
CREATE TYPE MY_TABLE AS TABLE(FN varchar(20), LN varchar(20),DOB datetime2);
CREATE PROCEDURE foo (@tab1 MY_TABLE READONLY)
AS
BEGIN
  SELECT d.*
  FROM TestData d
  INNER JOIN (SELECT TOP 1 * FROM @tab1) a 
 ON (
  a.DOB IS NULL OR a.DOB = d.DOB) -- just for example, I'm not sure I got all 
  --your requirements
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T21:26:15.440

这是我得到的，它接受三个输入并返回输入值的列，并省略带有 Null 的列。这些评论用于测试输出，因为我没有您的表格。

```
Create  Proc TestProc (@LN Nvarchar(100), @FN Nvarchar(100), @DOB Nvarchar(100)) 
As
--      TestProc    '''Hello''', '''What'',''Hmmm''', Null

Declare @SQL Nvarchar(Max),
        @Columns Nvarchar(Max) = '',
        @OrCriteria Nvarchar(Max) = '';        

If      @LN Is Not Null
Begin
        Set     @Columns = @Columns + 'LN, ';
End;         

If      @FN Is Not Null
Begin
        Set     @Columns = @Columns + 'FN, ';
End;     

If      @DOB Is Not Null
Begin
        Set     @Columns = @Columns + 'DOB, ';
End;     

Select  @OrCriteria = Coalesce(@OrCriteria + ' Or ','') + varType + ' In (' + varVal + ')' 
From   (Select  'LN' As varType, @LN As varVal
        Union
        Select  'FN', @FN
        Union
        Select  'DOB', @DOB) As n

If      @Columns <> ''
Begin
        Set     @SQL = 'Select  ' + Left(RTrim(@Columns),Len(RTrim(@Columns))-1) + '
                        From    TestData 
                        Where   (' + @OrCriteria + ')';

        Select  @SQL
        --  Exec    sp_executeSQL @SQL;                     
End
Else
Begin
        Return;
End; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T14:26:25.330

这是一些通用的 Oracle 示例。这不会回答你的问题，但可能会给你一些想法：

```
-- Case in Where clause --
SELECT empno, ename, job
  FROM scott.emp
 WHERE (CASE WHEN job = 'MANAGER' THEN '1'  
             WHEN job = 'CLERK'   THEN '2' 
        ELSE '0'  END) IN (1, 2) 
 / 
```

更多示例： [https ://dba.stackexchange.com/questions/1170/oracle-sql-case-in-a-where-clause](https://dba.stackexchange.com/questions/1170/oracle-sql-case-in-a-where-clause)

# c++ - C ++：使用运算符的字典比较字符串

> ID：14266978
> 
> 赞同：2
> 
> 时间：2013-01-10T20:46:48.593
> 
> 标签：c++, string, lexicographic

据我了解，如果我使用小于 (<) 等运算符比较两个字符串，C++ 将按字典顺序比较它们。我想利用这个通过数组搜索并返回最小的字典值。因为我使用临时值来查找最小的值`string smallest`。

如您所见，我已经赋予它价值`z`。字典价值最高的字母/符号是什么？是否有任何已经定义的静态变量我可以在 C++ 中分配它？这样做的规范是什么？

```
string VectorPQueue::extractMin() {
    string smallest = "z";
    int *count = new int;
    if (elems.size() != 0) {
        for (int i = 0; i < elems.size(); i++)
        {
            if ((elems.get(i)) < smallest) {
                smallest = elems.get(i);
                *count = i;
            }
        }

    } else {
        ErrorException("ERROR: pqueue is empty.");
        return "";
    }

    elems.remove(*count);
    printElements();
    return smallest;
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-10T20:49:51.050

您可能想要使用该`std::min_element`算法，该算法将使用正常的小于运算符来检索指向范围内最小元素的迭代器。这完全消除了您自己编写此函数的需要。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-10T20:47:58.153

只需设置`smallest`为第一个字符串，然后从第二个开始搜索。

# php - 在 PHP 中，如何将包含各种字符的字符串转换为仅包含 AZ 和 0-9 个字符的字符串？

> ID：14266984
> 
> 赞同：0
> 
> 时间：2013-01-10T20:47:13.937
> 
> 标签：php, regex, string, replace

> **可能重复：**
> [如何将特殊字符替换为它们在 PHP 中所基于的字符？](https://stackoverflow.com/questions/1890854/how-to-replace-special-characters-with-the-ones-theyre-based-on-in-php)

我有一个看起来像这样的字符串：

```
ABCÇĆDEFGHÎIïJ123450086 
```

在 PHP 中，我怎样才能使它显示为：

```
ABCDEFGHIJ123450086 
```

无需手动替换每个不需要的字符。我可以为此使用某种正则表达式吗？如何？

我只想要 AZ 和 0-9，没有其他外来字符（如删除它们）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:50:31.533

使用字符类：

```
$string = preg_replace('/[^\w\d]/', '', $string); 
```

用空字符串替换所有出现的非 ( `[^]`) 字母 ( `\w`) 或数字 ( ) 字符。`\d`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:57:15.470

一个不错的功能：

```
/**
 * Strip accents
 *
 * @param string $str string to clean
 * @param string $encoding encoding type (example : utf-8, ISO-8859-1 ...)
 */
function strip_accents($str, $encoding='utf-8') {
    // transforme accents chars in entities
    $str = htmlentities($str, ENT_NOQUOTES, $encoding);

    // replace entities to have the first nice char
    // Example : "&ecute;" => "e", "&Ecute;" => "E", "Ã " => "a" ...
    $str = preg_replace('#&([A-za-z])(?:acute|grave|cedil|circ|orn|ring|slash|th|tilde|uml);#', '\1', $str);

    // Replace ligatures like : Œ, Æ ...
    // Example "Å“" => "oe"
    $str = preg_replace('#&([A-za-z]{2})(?:lig);#', '\1', $str);
    // Delete else
    $str = preg_replace('#&[^;]+;#', '', $str);

    return $str;
}

// Example
$texte = 'Ça va mon cœur adoré?';
echo suppr_accents($texte);
// Output : "Ca va mon coeur adore?" 
```

来源： http: [//www.infowebmaster.fr/tutoriel/php-enlever-accents](http://www.infowebmaster.fr/tutoriel/php-enlever-accents)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-10T20:50:22.817

假设您想删除它们，您可以使用 preg_replace 将所有不在 az、AZ 和 0-9 范围内的字符替换为 '';

否则使用另一个线程中给出的翻译技术。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:50:41.990

您始终可以使用正则表达式。

`preg_replace('/^[A-Za-z0-9]/', '', $some_str)`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-10T20:51:00.003

使用白名单：

```
$input = 'ABCÇĆDEFGHÎIïJ123450086';
$filtered = preg_replace("~[^a-zA-Z0-9]+~","", $input); 
```

# macos - bash 的浮点精度

> ID：14266987
> 
> 赞同：0
> 
> 时间：2013-01-10T20:47:20.593
> 
> 标签：macos, bash

我有：

```
DIFF=$(( ($END - $START) / 60 ))
echo "Build took $DIFF minutes" 
```

我 1:30 分钟的输出是：

```
Build took 1 minutes 
```

我如何在这里使用浮点数，以便我的输出为：

```
Build took 1.50 minutes 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:54:28.490

使用 bc 获得精度

例子：

```
kent$  echo "scale=2;(190-100)/60"|bc
1.50 
```

用您的变量替换硬编码的数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:56:30.023

我不认为 bash 支持浮点。您可以改用以下`bc`命令：

```
DIFF=$(bc <<< "scale=2; ($END - $START) / 60")
echo "Build took $DIFF minutes" 
```

# java - java中的相对频率

> ID：14266989
> 
> 赞同：2
> 
> 时间：2013-01-10T20:47:41.077
> 
> 标签：java, frequency

我想创建一个程序来帮助我进行统计，但是我从一开始就遇到了问题，而且我在计算具有随机数且只有一维的数组的相对频率时遇到了很大的麻烦。

例如生成这些数字：

> {3, 5, 5, 2, 4, 1, 3, 5, 4}

我希望程序告诉我`3`重复 2 次、`4`3 次和`5`5 次

我创建了一个类来对这些值进行排序以计算中位数，第一和第三四分位数，但我仍然不知道如何找到频率以计算其他值

谢谢你的时间

PS：不知道这是否会影响任何东西，但我正在使用**netbeans**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-10T20:51:30.077

你肯定在寻找这个：[收藏：频率](http://docs.oracle.com/javase/6/docs/api/java/util/Collections.html#frequency%28java.util.Collection,%20java.lang.Object%29)

如果您没有集合，请先将数组转换为列表：

```
Collections.frequency(Arrays.asList(yourArray), new Integer(3)) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T20:55:49.077

如果您的数字范围相对较小，则可能首选使用计数器数组。例如，如果您的随机数在区间内，`[1,5]`那么您可以使用大小为 5 的数组来存储和更新频率计数器：

```
int[] numbers = {3, 5, 5, 2, 4, 1, 3, 5, 4} ;
int[] frequencies = new int[5];

for(int n : numbers)
    frequencies[n-1]++; 
```

**输出数组**（`frequencies`）：

```
1 1 2 2 3 
```

**编辑：**

此方法可应用于所有范围。例如，假设您有范围内的数字`[500,505]`：

```
int[] frequencies = new int[6];

for(int n : numbers)
    frequencies[n-500]++; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-11T02:14:44.773

```
 int[] numbers = {100, 101, 102, 103, 5 , 4, 4 , 6} ;

    Map<Integer, Integer> m = new HashMap<Integer, Integer>();
    for(int num: numbers){
        if(m.containsKey(num)){
            m.put(num, m.get(num)+1);
        }else{
            m.put(num, 1);
        }   
    }
    for (Map.Entry<Integer, Integer> entry : m.entrySet()) {
        System.out.println("Key: " + entry.getKey() + " | Frequencey: " + entry.getValue());
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T20:55:36.130

编辑：您可以使用地图来存储频率，如下所示：

```
import java.util.HashMap;
import java.util.Map;

public class Frequency {
    public static void main(String[] args) {
        int[] nums = { 3, 5, 5, 2, 4, 1, 3, 5, 4 };
        int count = 1;
        // number,frequency type map.
        Map<Integer, Integer> frequencyMap = new HashMap<Integer, Integer>();
        for (int i = 0; i < nums.length; i++) {
            if (nums[i] != -1) {
                for (int j = i + 1; j < nums.length; j++) {
                    if (nums[j] != -1) {
                        if (nums[i] == nums[j]) {
                            // -1 is an indicator that this number is already counted.
                            // You should replace it such a number which is sure to be not coming in array.
                            nums[j] = -1;
                            count++;
                        }
                    }
                }
                frequencyMap.put(nums[i], count);
                count = 1;
            }
        }
        for (Map.Entry<Integer, Integer> entry : frequencyMap.entrySet()) {
            System.out.println(" Number :" + entry.getKey()
                    + " has frequence :" + entry.getValue());
        }
    }
} 
```

带输出：

```
 Number :1 has frequence :1
 Number :2 has frequence :1
 Number :3 has frequence :2
 Number :4 has frequence :2
 Number :5 has frequence :3 
```

# python - 检查用户是否输入了数字？

> ID：14266992
> 
> 赞同：0
> 
> 时间：2013-01-10T20:47:50.737
> 
> 标签：python, python-2.7

我做了一个简单的脚本来找到一个数字的平方根。用户输入一个数字，它会找到平方根并显示结果。我希望它检查输入是否为数字。如果它是一个数字，它将继续，否则它将显示一条消息并重置。

我尝试使用：

```
while num != int(x):
    print "That is not a valid number"
    return self.page() 
```

但这只会显示一个错误。有人可以帮我解决这个问题吗？

这是代码：

```
import math
import sys

class SqRoot(object):
    def __init__(self):
        super(SqRoot, self).__init__()

        self.page()

    def page(self):
        z = 'Enter a number to find its square root: '
        num = int(raw_input(z))
        sqroot = math.sqrt(num)
        print 'The square root of \'%s\' is \'%s\'' % (num, sqroot)
        choose = raw_input('To use again press Y, to quit Press N: ')
        if choose == 'Y' or choose == 'y':
            return self.page()
        elif choose == 'N' or choose == 'n':
            sys.exit(0)

print "SqRoot Finder v1.0"
print "Copyright(c) 2013 - Ahnaf Tahmid"
print "For non-commercial uses only."
print "--------------------------------"

def main():
    app = SqRoot()
    app()

if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-10T20:51:00.720

python 原则之一是[EAFP](http://docs.python.org/2/glossary.html)：

> 请求宽恕比请求许可更容易。这种常见的 Python 编码风格假设存在有效的键或属性，如果假设被证明是错误的，则捕获异常。

```
x = raw_input('Number?')
try:
    x = float(x)
except ValueError:
    print "This doesn't look like a number!" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-10T22:30:30.387

如果您不想使用请求宽恕方法，这里有一个简单的函数，它应该适用于任何有效的浮点数。

```
def isnumber(s):
    numberchars = ['0','1','2','3','4','5','6','7','8','9']
    dotcount=0
    for i in range(len(s)):
        if (i==0 and s[i]=='-'):
            pass
        elif s[i]=='.' and dotcount==0:
            dotcount+=1
        elif s[i] not in numberchars:
            return False
    return True 
```

注意：您可以通过将 numberchars 更改为：

```
numberchars = ['0','1','2','3','4','5','6','7','8','9','a','b','c','d','e','f'] 
```

# java - 如何处理跨多个 guice 私有模块的循环依赖？

> ID：14266995
> 
> 赞同：1
> 
> 时间：2013-01-10T20:48:02.367
> 
> 标签：java, guice, circular-dependency

我目前正在编写一些框架代码，为我们平台内的服务提供蓝图，以便服务实现者可以专注于服务特定逻辑而不是样板集成代码。依赖注入是通过 guice 完成的。

蓝图有 2 种类型的逻辑组件；

1.  1 个也是唯一一个将服务与外界集成的集成组件（消息中间件等）
2.  1-n 个业务逻辑组件

每个逻辑组件都依赖于集成组件。

集成组件依赖于*所有*逻辑组件。

由于这是框架代码，框架不知道任何具体细节，因此不可能静态声明依赖关系并形成依赖关系图。我想避免让服务实现者这样做，因为这意味着他们在重复自己（只是声明他们有 n 个业务逻辑模块意味着他们有这种循环依赖）。

**我的问题是，在不让**服务实现者编写样板代码的情况下，我可以采取哪些方法来完成这项工作？

请注意，此处不提供多重绑定，因为出于此问题范围之外的各种原因，每个业务逻辑组件都必须是 PrivateModule。

一个人为的例子来说明哪里

1.  业务逻辑 = ModuleA、ModuleB、ModuleC
2.  集成提供的依赖 = Wrapper
3.  集成对业务逻辑的依赖是通过每个逻辑模块向 Wrapper 添加一些东西来建模的

这个例子可以通过改变来工作

```
@Provides @Exposed @Named("result")
public String go(Container in) {
    return in.format();
} 
```

到

```
@Provides @Exposed @Named("result")
public String go(@Named("a") Container in, @Named("b") Container in2, @Named("c") Container in3) {
    return in.format();
} 
```

即通过实际创建循环依赖。

```
import com.google.inject.Exposed;
import com.google.inject.Guice;
import com.google.inject.Injector;
import com.google.inject.Key;
import com.google.inject.PrivateModule;
import com.google.inject.Provides;
import com.google.inject.Singleton;
import com.google.inject.name.Named;
import com.google.inject.name.Names;

import java.util.ArrayList;
import java.util.List;

public class GuiceCircularDependencyTest {

    public static void main(String[] args) {
        Injector in = Guice.createInjector(new Owner());
        String result = in.getInstance(Key.get(String.class, Names.named("result")));
        System.out.println("Result is: " + result);
    }

    public static class Owner extends PrivateModule {
        @Override
        protected void configure() {
            bind(Container.class).in(Singleton.class);
            install(new Integration());
            install(new ModuleA());
            install(new ModuleB());
            install(new ModuleC());
            expose(String.class).annotatedWith(Names.named("result"));
        }
    }

    public static class ModuleA extends PrivateModule {

        @Override
        protected void configure() {

        }

        @Provides @Exposed @Named("a")
        public Container go(Container in, Wrapper prefix) {
            in.add(prefix + "A");
            return in;
        }
    }

    public static class ModuleB extends PrivateModule {

        @Override
        protected void configure() {

        }

        @Provides @Exposed @Named("b")
        public Container go(Container in, Wrapper prefix) {
            in.add(prefix + "B");
            return in;
        }
    }

    public static class ModuleC extends PrivateModule {

        @Override
        protected void configure() {

        }

        @Provides @Exposed @Named("c")
        public Container go(Container in, Wrapper prefix) {
            in.add(prefix + "C");
            return in;
        }
    }

    public static class Integration extends PrivateModule {
        @Override
        protected void configure() {
            bind(Wrapper.class).toInstance(new Wrapper("Module"));
            expose(Wrapper.class);
        }

        @Provides @Exposed @Named("result")
        public String go(Container in) {
            return in.format();
        }
    }

    public static class Container {
        private List<String> strings = new ArrayList<>();

        public void add(String string) {
            strings.add(string);
        }

        public String format() {
            return strings.toString();
        }
    }

    public static class Wrapper {
        private final String prefix;

        public Wrapper(String prefix) {
            this.prefix = prefix;
        }

        @Override
        public String toString() {
            return prefix;
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T11:16:22.977

一种允许`Multibinder`在私有模块之间共享 a 的解决方法是将 a 包装`PrivateModule`在一个`AbstractModule`实现中，该实现只需`PrivateModule`安装`Multibinder`

```
import com.google.inject.AbstractModule;
import com.google.inject.Exposed;
import com.google.inject.Guice;
import com.google.inject.Injector;
import com.google.inject.Key;
import com.google.inject.PrivateModule;
import com.google.inject.Provides;
import com.google.inject.multibindings.Multibinder;
import com.google.inject.name.Named;
import com.google.inject.name.Names;

import java.util.Set;

public class GuiceCircularDependencyTest {

    public static void main(String[] args) {
        Injector in = Guice.createInjector(new Owner());
        String result = in.getInstance(Key.get(String.class, Names.named("result")));
        System.out.println("Result is: " + result);
    }

    public static class Owner extends PrivateModule {
        @Override
        protected void configure() {
            Multibinder<String> multi = Multibinder.newSetBinder(binder(), String.class);
            install(new Integration());
            install(new ModuleWrapper<>(new ModuleA(), multi));
            install(new ModuleWrapper<>(new ModuleB(), multi));
            install(new ModuleWrapper<>(new ModuleC(), multi));
            expose(String.class).annotatedWith(Names.named("result"));
        }
    }

    public static class ModuleWrapper<T> extends AbstractModule {
        private final WrappablePrivateModule<T> inner;
        private final Multibinder<T> multi;

        public ModuleWrapper(WrappablePrivateModule<T> inner,
                             Multibinder<T> multi) {
            this.inner = inner;
            this.multi = multi;
        }

        @Override
        protected void configure() {
            install(inner);
            multi.addBinding().to(inner.getExposedKey());
        }
    }

    public static abstract class WrappablePrivateModule<T> extends PrivateModule {

        @Override
        protected void configure() {

        }

        public abstract Key<T> getExposedKey();
    }

    public static class ModuleA extends WrappablePrivateModule<String> {

        private static final String SUFFIX = "A";

        @Override
        public Key<String> getExposedKey() {
            return Key.get(String.class, Names.named(SUFFIX));
        }

        @Provides @Exposed @Named(SUFFIX)
        public String expose(Wrapper prefix) {
            return prefix + SUFFIX;
        }
    }

    public static class ModuleB extends WrappablePrivateModule<String> {

        private static final String SUFFIX = "B";

        @Override
        public Key<String> getExposedKey() {
            return Key.get(String.class, Names.named(SUFFIX));
        }

        @Provides @Exposed @Named(SUFFIX)
        public String expose(Wrapper prefix) {
            return prefix + SUFFIX;
        }
    }

    public static class ModuleC extends WrappablePrivateModule<String> {

        private static final String SUFFIX = "C";

        @Override
        public Key<String> getExposedKey() {
            return Key.get(String.class, Names.named(SUFFIX));
        }

        @Provides @Exposed @Named(SUFFIX)
        public String expose(Wrapper prefix) {
            return prefix + SUFFIX;
        }
    }

    public static class Integration extends PrivateModule {
        @Override
        protected void configure() {
            bind(Wrapper.class).toInstance(new Wrapper("Module"));
            expose(Wrapper.class);
        }

        @Provides @Exposed @Named("result")
        public String go(Set<String> in) {
            return in.toString();
        }
    }

    public static class Wrapper {
        private final String prefix;

        public Wrapper(String prefix) {
            this.prefix = prefix;
        }

        @Override
        public String toString() {
            return prefix;
        }
    }
} 
```

# algorithm - 有效地生成链表的所有可能排列？

> ID：14266996
> 
> 赞同：4
> 
> 时间：2013-01-10T20:48:04.683
> 
> 标签：algorithm, data-structures, linked-list, complexity-theory, permutation

有许多算法可以生成给定值集的所有可能排列。通常，这些值表示为一个数组，它具有 O(1) 随机访问。

但是，假设要置换的元素表示为双向链表。在这种情况下，您无法在 O(1) 时间内随机访问列表中的元素，因此许多排列算法将经历不必要的减速。

是否有一种算法可以以尽可能少的时间和空间开销生成链表的所有可能排列？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:58:59.873

试着想想**你**是如何在一张纸上生成所有排列的。

你从最右边的数字开始，向左移动一个位置，直到你看到一个比它的邻居小的数字。然后将下一个值的数字放在那里，并在其后按升序排列所有剩余的数字。这样做，直到没有更多事情可做。稍微考虑一下，您可以根据它们的数量在线性时间内对数字进行排序。

据我所知，这实际上是用于下一个排列的典型算法。我看不出为什么这在数组上会比在列表上更快。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-10T21:33:02.267

您可能想研究[Steinhaus-Johnson-Trotter 算法](https://en.wikipedia.org/wiki/Steinhaus%E2%80%93Johnson%E2%80%93Trotter_algorithm)。它仅通过交换相邻元素来生成序列的所有排列；您可以在双向链表中在 O(1) 中执行的操作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-11T03:28:36.917

您应该将链表的数据读入一个数组，`O(n)`然后使用堆的排列 ( [http://www.geekviewpoint.com/java/numbers/permutation](http://www.geekviewpoint.com/java/numbers/permutation) ) 来查找所有排列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-10T21:50:33.470

您可以使用[Factoradic Permutation Algorithm](http://en.wikipedia.org/wiki/Factorial_number_system#Permutations)，并相应地重新排列节点指针以在不递归的情况下生成结果排列。

伪描述：

```
element_to_permute = list
temp_list = new empty list
for i = 1 in n! 
   indexes[] = factoradic(i)
   for j in indexes[]
      rearrange pointers of node `indexes[j]` of `element_to_permute` in `temp_list` 
```

# java - Matcher 在 Ubuntu 和 Windows 上给出不同的结果

> ID：14266998
> 
> 赞同：1
> 
> 时间：2013-01-10T20:48:06.987
> 
> 标签：java, regex, eclipse, nlp, stanford-nlp

我在 Ubuntu 和 Windows 上运行完全相同的 eclipse 项目，但得到不同的输出。

不均匀的行为发生在以下代码中：

```
String regex = "<token id=\"(.*)\">.*\n.*<word>(.*)</word>.*\n.*<lemma>(.*)</lemma>.*\n.*\n.*\n.*<POS>(.*)</POS>";
Pattern pattern = Pattern.compile(regex);
Matcher matcher = pattern.matcher(fileAsString);
while (matcher.find()) {
    ...
} 
```

(matcher.find()) 检查在 Windows 上返回 false，但在 Ubuntu 上返回 true（这是预期的行为）。

Eclipse Juno 和 jdk7 都在上面。

也许它与操作系统无关，但这是我在并行调试和检查两个环境中的项目属性后发现的唯一不同..

任何想法的差异？？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-10T20:51:41.867

您正在匹配`\n`，这是 Linux 的行结尾，但不是 Windows（`\r\n`Windows 需要）。类似的东西`\r?\n`可以解决您的特定问题。

也就是说，您永远不应该使用正则表达式解析任何类似 HTML 的内容（包括 XML）。您错过了 XML 的所有内容，尤其是它在手写“错误”方面的灵活性，例如不同的标签顺序、空格等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T20:50:53.850

这可能是行尾字符的差异。尝试将可选的 \r 添加到正则表达式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-10T20:51:12.803

很可能是因为行尾。默认情况下，点与行尾不匹配，您`\n`在正则表达式中明确查找。

尝试用 编译你的模式`Pattern.DOTALL`，或者把你所有的`\r?\n`地方都`\n`放在正则表达式中。